# StackOverflow 问答 000566000-000566999

# java - Java Swing 表大小

> ID：566004
> 
> 赞同：1
> 
> 时间：2009-02-19T16:06:48.887
> 
> 标签：java, swing, groovy

我在使用 JTables 时遇到问题。我正在向面板中添加两个表格，这些表格位于滚动窗格中，但是当应用程序出现时，表格总是占用比行数更多的空间，浪费了我的可用空间。

我正在使用 groovy 和 swingbuilder 创建表，代码如下：

```
scrollPane(){
    panel(layout: new MigLayout('wrap 3')) {
        //main title
        label(text: '<html><h1>blah</h1></html>',constraints: 'span 3') //title

        //tables
        def data = [[text: "ABC", combo: "abc"], [text: "DEF", combo: "def"]]
        def items = ['abc', 'def', 'ghi', 'jkl']
        def tableModelListener = { e -> println "${e.firstRow} ${e.column} ${e.type}" } as TableModelListener
        scrollPane(constraints: 'span 3' ) {
            table(id: 'serviceTable') {
                current.setFillsViewportHeight(false)
                tableModel(list: data) {
                    current.addTableModelListener(tableModelListener)
                    propertyColumn(header: 'Text', propertyName: 'text')
                    propertyColumn(header: 'Combo', propertyName: 'combo')
                }
            }
        }
        scrollPane(constraints: 'span 3' ) {
            table(id: 'groupsTable') {
                tableModel(list: data) {
                    current.addTableModelListener(tableModelListener)
                    propertyColumn(header: 'Text2', propertyName: 'text')
                    propertyColumn(header: 'Combo2', propertyName: 'combo')
                }
            }
        }
    }
} 
```

结果如下： [图片 http://img517.imageshack.us/img517/6508/15181501ym9.jpg](http://img517.imageshack.us/img517/6508/15181501ym9.jpg)

我想要的是根据行数制作表格高度，如果可能的话，我希望表格也占据整个宽度。我认为我的问题与父面板有关，但我找不到原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T06:41:09.100

是的，这是 JTables 的一个已知问题。默认情况下，无论实际内容如何，​​它都会显示 20 行。

如果你想改变，你必须使用如下代码：

```
static public void setTableHeight(JTable table, int rows)
{
    int width = table.getPreferredSize().width; 
    int height = rows * table.getRowHeight(); 
    table.setPreferredScrollableViewportSize(new Dimension(width, height));
} 
```

`setTableHeight(5);`如果您希望默认显示 5 行，则只需调用。

注意：这是 Java，您可能需要稍微调整一下以适应 Groovy。

这是我上个月[在我的博客中描述的（第 7 项）。](http://jfpoilpret.blogspot.com/2009/01/swing-ui-layout-best-practices.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T17:40:18.017

@jfpoilpret 是正确的，因为需要管理 preferredScrollableViewpoet 大小。常规方法是将其绑定到表的首选大小。因此，如果将其添加到外部 scrollPane 元素内部，它将自动跟踪大小：

```
[serviceTable, groupsTable].each { table ->
    bind(source:table, sourceProperty:'preferredSize', 
         target:table, targetProperty:'preferredScrollableViewportSize',
         converter: { ps -> 
             [ps.width + 100, 
              (table.rowCount > 20 ? 20: table.rowCount) * table.rowHeight]
         })
} 
```

我们还可以使用绑定做一些简洁的事情，比如添加一个转换器，将高度限制为 20 行（或任何您希望将其限制为的任何内容），这样当表格太长时我们仍然会得到滚动条。

# php - PHP 错误：无法加载动态库 (memcache.so)

> ID：566008
> 
> 赞同：0
> 
> 时间：2009-02-19T16:07:27.050
> 
> 标签：php, memcached

`error_log`在启动时显示以下行：

> *无法加载动态库 '/usr/lib/php/extensions/no-debug-non-zts-20060613/memcache.so' - (null) in Unknown on line 0*

该文件存在并且正确编译。PHP 版本是 5.2.6。谷歌搜索了几个小时后，我设法找到了几个类似的问题，但没有解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T15:41:49.903

事实证明，处理这个问题的最简单方法是通过 MacPorts 使用 memcache 将 PHP 更新到 5.2.8。现在一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-11T15:02:35.120

我也遇到了这个问题，为了解决这个问题，我必须安装 Ondrej 的 php PPA，然后进行 dist-upgrade 以获得最新版本的 memcache。

[https://launchpad.net/~ondrej/+archive/ubuntu/php](https://launchpad.net/%7Eondrej/+archive/ubuntu/php)

# sqlite - 仅转储 sqlite 数据库的一部分

> ID：566009
> 
> 赞同：3
> 
> 时间：2009-02-19T16:07:36.647
> 
> 标签：sqlite

是否可以只转储数据库的一部分？我有一个包含 250'000 个条目的数据库。我想创建第二个，其中包含十分之一的数据...

使用

```
select * from table where id % 10 = 0 
```

和设置

```
.output out.sql 
```

生成的文件没有以与使用时相同的方式编码的二进制数据

```
.dump

dump -> the binary data gets encoded as hex bytes
other way -> it gets encoded as some weird string 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T07:38:03.433

您可以直接编写一个新数据库，而不是转储到文件：

```
ATTACH DATABASE New.db AS new;
CREATE TABLE new.stuff AS (SELECT * FROM table WHERE id % 10 = 0); 
```

这应该`stuff`在`New.db`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T21:28:00.823

如果您知道所需的行范围，则可以使用选择偏移量和限制参数。

# c# - 在 WCF 中获取调用者的主机名

> ID：566011
> 
> 赞同：7
> 
> 时间：2009-02-19T16:07:47.147
> 
> 标签：c#, wcf, dns, wcf-security

我正在用 WCF 服务替换现有的 Web 服务，作为迁移的第一步，我将使用 BasicHttpBinding 公开一个端点，直到客户端在今年晚些时候升级。

计划是使用 Windows 服务托管新的 WCF 服务（该服务只会从 Intranet 中调用，因此不需要 HTTP），但同时公开 Basic HTTP 和 Net.TCP 端点，以便迁移可以在阶段。

但是，我在 WCF 服务中获取调用者的主机名时遇到了一些麻烦，查看它使用 Context.Request.UserHostName 获取主机名的当前 Web 服务代码。我已经设法获取调用者的用户名和 IP 地址，但是环境中所有相关的权限/安全服务都使用主机名而不是 IP，那么我有什么方法可以在我的服务中获取主机名吗？

PS 我已将安全模式设置为 TransportCredentialOnly，并将 clientCredentialType 设置为 Windows

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-19T17:10:33.900

由于您不是在 IIS 中托管，因此您不能使用[ASP.NET 兼容模式](http://msdn.microsoft.com/en-us/library/aa702682.aspx)来访问[`HttpContext`](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx)通常存在于 ASP.NET 进程中的内容。

相反，您可以使用[命名空间](http://msdn.microsoft.com/en-us/library/system.net.aspx)中[类](http://msdn.microsoft.com/en-us/library/b8hth2dy.aspx)的[`GetHostEntry`方法](http://msdn.microsoft.com/en-us/library/ms143998%28v=VS.100%29.aspx)来获取将包含您正在获取的 IP 地址的别名（DNS 名称）的[实例。](http://msdn.microsoft.com/en-us/library/system.net.iphostentry.aspx)[`Dns`](http://msdn.microsoft.com/en-us/library/b8hth2dy.aspx)[`System.Net`](http://msdn.microsoft.com/en-us/library/system.net.aspx)[`IPHostEntry`](http://msdn.microsoft.com/en-us/library/system.net.iphostentry.aspx)

# c - 为什么我的 C 代码运行缓慢？

> ID：566014
> 
> 赞同：2
> 
> 时间：2009-02-19T16:08:39.340
> 
> 标签：c, performance

我用 C 编写了一些代码，我很惊讶地发现它的执行时间比我预期的要长。我想知道哪些操作成本高昂以及如何摆脱它们。

我使用赋值语句、条件（嵌套）、循环、函数调用和回调。

对常见的 C 性能缺陷有哪些好的参考？

我可以使用一个好的分析器吗？

* * *

**谢谢你们**

感谢您的所有投入。你是绝对正确的：算法可以（极大地）减慢速度。尽管通过编码实践可以实现一点性能提升 - 我 100% 相信*只有错误的算法才能大大减慢速度*。

事实上：我正在研究 RB 树并按升序插入节点。它花费了大量时间（与 Binary Search Tree (Skewed) 一样糟糕）。在征求您的意见后，我检查了算法，我在平衡方面犯了错误，导致树倾斜（倾斜）。我纠正了它。

再次感谢您的建议。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-19T16:10:15.137

您的性能问题可能更多地与您实现的算法有关，而不是与您使用的操作有关。

发布代码可能很有用。告诉我们您正在尝试做的事情以及您正在使用的算法也会有所帮助。事实上，您的问题并没有为任何人提供足够的信息来为您提供有用的答案。

其他人推荐 gprof - 如果您有兴趣分析您的代码，我支持它。我以前也用过 VTune，很喜欢。但首先要确保您了解您的代码及其作用，并且您正在实施的算法在处理您希望它处理的数据大小时是高效的。

顺便说一句，使用 C 并不意味着您的代码会自动运行得更快。I/O 绑定代码通常不会看到性能改进。UI 繁重的代码可能不会从使用低级语言中受益。通常，C 是一种更好的实现语言，您需要低级别访问，与硬件或低级别操作系统服务交互时，或者如果您有非常具体和严格的性能要求，而高级垃圾收集语言很难满足这些要求. 或者如果你碰巧喜欢 C，但这显然是一个主观问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T01:05:57.540

这是一个老生常谈的话题。

分析是一种选择，但如果您有调试器，则有一些老式技术可以很好地工作：

*   如果不需要一整天，请单步执行代码。我保证你会得到一个很好的主意，如果它正在做任何它并不真正需要的事情。

*   如果这需要太长时间，只需给它足够的数据，或者让程序在顶层重复自己，以便它运行很长时间，至少几秒钟。在它运行时，手动中断它并记下它在做什么以及**为什么**。这样做几次。保证，您将获得与单步执行相同的洞察力。

不要做大多数人做的事。大多数人所做的是1）勇敢地谈论分析，然后2）猜测问题是什么并解决它。如果您四处寻找“快速操作”，那么您就错过了重点。在您通过上述调查之一证明它是什么之前，您永远不会解决正确的问题。

[在 WikiHow 上解释](http://www.wikihow.com/Optimize-Your-Program%27s-Performance)

[关于 SO 的一个很好的解释](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T16:23:46.980

不要浪费时间去寻找“昂贵”的操作。当然，除了库之外，C 语言中几乎没有。

相反，请尝试估计您执行代码的每个部分的次数。例如，假设您正在将文件的每一行与另一个文件的每一行进行比较。如果每个文件有大约百分之一的行，您将进行大约一万次比较。没什么好担心的...但是如果您从文件的开头选择每一行，您将阅读每一行一百万次。现在那不好了。你需要一些真正随机访问的方式来读取每一行......或者，更好的是，阅读散列

在“大 O”表示法中：完整的比较是`O(n x m)`，或大致`O(n^2)`如果`n`和`m`相似。但是顺序阅读是`O(n/2)`平均的，所以整个事情都是`O(n^3/2)`阅读加上`O(n^2)`比较。使用散列将是`aO(2n)+bO(2n)+cO(n^2)`，或者只是`O(n^2)`

优化算法，而不是代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T16:12:02.387

检查内存分配。和函数调用。如果您使用 gcc，请使用 -pg 选项使用分析信息对其进行编译并通过[gprof](http://www.cs.utah.edu/dept/old/texinfo/as/gprof.html#SEC1)运行它。VS Team System 版本自带 Profiler。所以，任君挑选。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-19T16:14:09.653

这是不可能的。您命名的所有元素都不是真的很慢，即使它们很慢，也不会自动意味着整个程序会因为它们而变慢。

你最好在启用分析的情况下运行你的代码，看看哪些部分是最昂贵的。（这取决于您的平台，您将如何实际操作）。

有关 MSVC 的信息，请参阅[这篇文章](https://stackoverflow.com/questions/61669/profiling-in-visual-studio-2008-pro)或[这篇关于 MSVS 下的分析](http://www.geekzone.co.nz/vs2008/6265)甚至[这个问题的博客条目，尤其是 AMD CodeAnalyst 答案](http://forums.indiegamer.com/showthread.php?t=4357)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T16:11:32.803

您可以访问 GNU 工具链吗？如果是这样，请查看“gprof”。这是一个探查器......非常适合发现瓶颈。

# vb.net - Visual Studio 2008 中的单元测试框架超时

> ID：566017
> 
> 赞同：1
> 
> 时间：2009-02-19T16:09:53.277
> 
> 标签：vb.net, visual-studio-2008, unit-testing

我正在为我帮助维护的大型 VB.Net 应用程序运行一些单元测试，并且遇到了测试超时的问题。

测试运行的设置使得整个测试运行没有超时限制，但每个单独测试的限制为 2 分钟。但是，有几个测试需要比这更长的时间才能运行，所以我们尝试将 timeout 属性添加到测试的声明中，即

```
<TestMethod(), Timeout(15 * 60 * 1000)> Public Sub DoSomething() 
```

15 分钟超时。但是，测试运行属性中设置的 2 分钟超时似乎优先，即使它说超时属性应该覆盖它。

有什么我想念的吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T03:20:41.897

将超时表达式替换为值，即 Timeout(900000)。

# c# - 使用 DAAB 3.5/4.0 的 DAL 设计

> ID：566018
> 
> 赞同：1
> 
> 时间：2009-02-19T16:10:07.820
> 
> 标签：c#, asp.net, daab, data-layers

我正在开发一个 .Net 3.5 Web 应用程序。它有各种模块，例如客户、订单等。我需要使用 Enterprise Library 4.0 设计数据访问层 (DAL)（使用数据访问应用程序块或 DAAB）连接到 SQL Server 2005。这是我打算如何去做：

• 有一个名为“IDataService”的接口。它将有“ExecuteReader()”、“ExecuteScalar()”、“ExecuteNonQuery()”、“AddParams”等成员......基本上，这个接口几乎看起来像达布。

• 有一个名为“DataService”的类，它实现了这个接口。这个类将充当DAAB 的包装器，每个方法都将在内部使用DAAB 中的相应方法。

• 拥有像客户、数据等这样的业务类（或数据容器），它们的属性将映射到数据库中相应的表属性。

• 每个模块都有 DAL 类，如 CustomerDataService、OrdersDataService 等。这些类中的每一个都有构造函数代码，我将在其中实例化 DataService 类，如下所示： IDataService dataService= new DataService() 此外，这些类中的每一个都有如下方法： GetCustomerDetails() AddCustomer() RemoveCustomer() UpdateOrder 等这些方法将在内部使用“dataService”对象对数据库 ExecuteReader、ExecuteNonQuery 等进行任何操作

• 每个模块都有一个映射器类，如“CustomerMapper”、“OrderMapper”等。这些类将数据源（例如 IDataReader）作为输入，并将数据填充到通用集合（List）中。并且这些映射器类将由相应的 Dataservice 类在内部调用，以将类型安全的集合返回给调用客户端。

• 有一个像DbHelper 这样的帮助类，它会执行诸如“处理DBNull 案例”、“存储存储过程名称”等任务。

• DataService 类将被BusinessLogic 层类依次使用……即CustomerBusiness、OrdersBusiness 等。

• 业务逻辑层将集合返回到表示层。

这种设计有意义吗？这种方法的优点/缺点是什么？我能想到这种方法的优点是所有 DataService 类将始终针对接口“IDataService”进行编程，而无需知道“DataService”类是如何在内部实现的。因此，将来，如果我删除 DAAB 并在我的内部使用另一个 API DataService 类，客户端代码无需更改。此外，我可以在我的 IDataService 接口中添加 DAAB 中不存在的任何方法....例如 BatchUpdate()...

如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-01T17:31:01.627

看起来你让它变得比它应该的复杂。也许一次迈出一步会有所帮助。

DAL：我没有看到在 DAAB 上使用包装器的好处。IMO，DAAB 已经是 DAL 包装器。Wrapper over wrapper 会适得其反。应该只有一个 DAL。这就是 DAL 的全部意义所在。

ORM：对于映射器类，也许您应该考虑使用实体框架或 NHibernate 来实现 ORM。当模式发展时，编写自己的 ORM 是乏味且难以维护的。

# php - 在 PHP 中将变量声明为“var $foo”或“$foo”的区别？

> ID：566023
> 
> 赞同：5
> 
> 时间：2009-02-19T16:11:26.297
> 
> 标签：php, variables

标题说明了一切。有什么不同？

```
var $foo;
$bar; 
```

这两个变量之间的主要区别是什么？

我注意到“var $foo”主要用于声明类属性，但为什么会这样呢？

提前感谢您的所有回答。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-19T16:18:09.397

在 PHP 4`var`中用于定义类中的变量。在 PHP 5 中它已被弃用，您必须使用`public`、`private`或`protected`代替。在类之外它不应该有任何影响（尽管您可能会在 PHP 5 中收到警告）。

# sql-server - SQL 2005 中的 Teradata 链接服务器

> ID：566028
> 
> 赞同：2
> 
> 时间：2009-02-19T16:12:17.973
> 
> 标签：sql-server, sql-server-2005, teradata, linked-server

我正在尝试使用 SQL Server 2005 中的链接服务器连接到 Teradata。当我尝试使用 SQL Server 使用 OPENQUERY 进行连接时，我收到以下错误：

消息 7399，级别 16，状态 1，第 1 行链接服务器“TERADATA”的 OLE DB 提供程序“TDOLEDB.1”报告错误。拒绝访问。

消息 7350，级别 16，状态 2，第 1 行无法从链接服务器“TERADATA”的 OLE DB 提供程序“TDOLEDB.1”获取列信息。

当我“测试连接”时测试成功，但是当我尝试在 SQL Server Management Studio 中查看目录默认表时，我得到了同样的错误。我在运行 SQL 服务器（它是一个开发框）的计算机上安装了 Visual Studio，我可以使用 OLE DB 驱动程序进行连接，我可以运行我的查询，并导航到目录默认表。让链接服务器与 Teradata 一起工作有什么技巧吗？非常感谢任何建议。

--CDW

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-14T13:47:09.900

希望这些会有所帮助：

[TeraData 论坛](http://www.teradataforum.com/)

[TERADATA ADVISORY GROUP 为业务对象和 TRADATA 客户制定最佳实践](http://www.businessobjects.com/pdf/partners/teradata_advisory_group.pdf)

[Teradata 部署的最佳实践](http://download.oracle.com/docs/cd/E12104_01/books/AnyInstAdm/AnyInstAdmPreInstall12.html)

[Teradata 开发者交流](http://developer.teradata.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-04T08:53:56.517

你可以试试...

[http://social.msdn.microsoft.com/Forums/en/sqldataaccess/thread/cbefb8c9-57e5-48d6-9c47-dc797bbf444b](http://social.msdn.microsoft.com/Forums/en/sqldataaccess/thread/cbefb8c9-57e5-48d6-9c47-dc797bbf444b)

Brian 说“在 SQL Server Management Studio 中将 TODLEDB.1 提供程序属性设置为“允许进程内”有助于克服此类问题。”

问候

zdba

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-15T23:00:40.720

您可以使用您连接的用户从 DBC.Tables 视图中进行选择吗？

```
SELECT * from DBC.TablesVX 
```

# c++ - 过滤 Eclipse 的 C++ 内容辅助

> ID：566037
> 
> 赞同：3
> 
> 时间：2009-02-19T16:13:35.390
> 
> 标签：c++, eclipse, content-assist

我将 Eclipse Ganymede（版本 3.4.1）与 C++ 项目一起使用。是否有某种方法可以过滤内容辅助列表以仅显示当前上下文中可用的方法和字段？
如果不是，为什么不呢？是否有过我想要访问对象中的私有字段等的情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T17:53:07.997

看起来不像。至少有[几个与此相关的](https://bugs.eclipse.org/bugs/show_bug.cgi?id=229057) [错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=172305)。你很幸运，它显示得太多了！它似乎对我没有任何帮助。

最新的 CDT（在编写 Helios 时，CDT 版本为 7.0.0.201006141710）修复了其中的第二个错误。然而，当我尝试它时，私有成员变量仍然出现在完成列表中，如下所示。

它似乎确实取决于类中变量声明的顺序。如果您在该`private`部分之前有该`public`部分，则私有变量将被正确过滤掉。虽然并不完美，但它肯定比在 Ganymede 中要好很多。

![Eclipse CDT 截图](https://i.imgur.com/feid1.png)

# iphone - UITextField 通过 Interface Builder 更改字体大小

> ID：566038
> 
> 赞同：6
> 
> 时间：2009-02-19T16:13:44.953
> 
> 标签：iphone, cocoa, cocoa-touch, interface-builder

我一直在尝试调整嵌入在 UITableViewCell 的 contentView 中的 UITextField 的字体大小。我正在使用 cmd+T 来调出字体菜单，并且在其中只使用默认字体 Helvetica 大小 18。每次我更改大小时，当我的 UITextField 显示时，它似乎根本没有任何区别。几乎就像我需要以编程方式进行任何更改一样。

有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T18:47:06.873

确保取消选中 UITextField 上的“调整为适合”选项。否则，如果您的文本比字段长，框架将自动缩小文本以使其适合。

# c++ - TerminateProcess(GetCurrentProcess,0) 的 Mac OS X 等效项；

> ID：566040
> 
> 赞同：2
> 
> 时间：2009-02-19T16:14:05.440
> 
> 标签：c++, macos, terminate

我正在寻找一种简单且无法捕获的方法来终止我的 C++ 应用程序的 Mac 端口。在我使用的 Windows 中

```
TerminateProcess(GetCurrentProcess, 0); 
```

我可以在 Mac OS X / XCode / GCC 上使用的等效命令是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T16:22:05.380

实际上，`_exit`如果您想要与`TerminateProcess`. `exit`语义与`ExitProcess`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T17:13:08.197

更接近[ProcessTerminate](http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx)将发送一个带有[kill的](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man2/kill.2.html)[SIGKILL](http://en.wikipedia.org/wiki/SIGKILL)，两者都会立即终止当前进程并且不能被捕获。这与[_exit相同](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man2/_exit.2.html)

```
kill(getpid(), SIGKILL); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T16:16:08.947

退出（0）；

* * *

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T16:48:15.560

请记住，如果您调用 exit() 或 TerminateProcess()，您将立即终止应用程序，即没有析构函数调用，也没有完成您可能期望完成的清理（当然，操作系统会清理它所能做的一切） .

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-28T21:26:03.487

实际上，exit() 和 _exit() 都涉及 CRT，这意味着仍然需要执行各种操作。（不确定atexit，我没有检查）

Windows 上的 TerminateProcess 位于操作系统级别，因此它回避了所有 CRT。如果你想在 Mac 上做同样的事情，你最好的办法是用 mach 函数弄脏你的手。在这种情况下：

```
#include <mach/mach.h>

... // lots of your code here

task_terminate(mach_task_self()); 
```

这几乎是你所能得到的。

# session - 会话变量的浏览器缓存不一致 - 任何解决方案？

> ID：566050
> 
> 赞同：1
> 
> 时间：2009-02-19T16:18:12.237
> 
> 标签：session, caching

为什么我的会话变量被丢弃在这里？

我使用提交按钮提交表单并创建值的会话变量以允许将它们带到其他页面。一切都好。如果我现在使用浏览器按钮在表单和表单处理程序之间来回移动（某些用户有时可能会这样做），Firefox 和 Opera 会调用会话变量并可以填充表单处理程序。IE 和 Safari 却没有。我能做些什么呢？

如果我今天早上早些时候没有在头文件中插入以下内容，Firefox 会证明这个问题：

```
header("Cache-Control: no-cache");
header("Expires: -1"); 
```

我读过第二个标题行 - `header("Expires: -1");`- 也应该是 IE 的修复，但似乎并非如此。IE8 / Safari 仍然显示问题。Opera 根本不需要这个。如果这是一个重新加载问题，我需要在标题中添加什么来强制 IE 和 Safari 重新加载？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T21:28:05.373

您的会话变量不会丢失。相反，发生的事情是，当返回时，没有一个浏览器会从您的服务器重新加载表单（使用会话变量填充的默认值）。然而，一些浏览器会很好，并记住自己的值是什么上次提交该特定表单时的最后一个表单字段，并为您填写。IE不会。

在任何情况下，最好通过 POST 提交表单，并且服务器通过**重定向**(HTTP 302) 到下一页来响应 POST，而不是直接呈现下一页。通过发出重定向，用户返回的任何尝试都会要求他/她确认他们是否真的希望再次重新提交表单，这可能比表单上没有一些预填充的值更大. 我在这里猜测您的真正意图是什么，但是如果您真的希望用户能够连续提交多个表单（重复任务），只需在重定向后在下一页上再次呈现表单。

# visual-studio - 你可以在 Visual Studio 停靠中禁用自动隐藏动画吗？

> ID：566051
> 
> 赞同：13
> 
> 时间：2009-02-19T16:18:13.547
> 
> 标签：visual-studio

当您将窗口停靠在 Visual Studio 的一侧时，它可以自动隐藏。当它这样做时，它会动画打开或关闭。是否可以禁用此动画，使其仅显示或隐藏到正确的大小？它在远程桌面上很慢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-19T16:23:05.010

工具->环境->常规->动画环境工具（复选框）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-19T16:23:25.030

1.  工具 > 选项

2.  环境 > 一般

3.  取消选中动画环境工具

# csv - 您可以将 CR/LF 编码为 CSV 文件吗？

> ID：566052
> 
> 赞同：83
> 
> 时间：2009-02-19T16:18:14.967
> 
> 标签：csv

以某种方式将 CR/LF 字符编码为 CSV 文件是否可能/合法？

（作为 CSV 标准的一部分？）

如果是这样，我应该如何编码 CR/LF？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-02-19T16:20:05.320

是的，您需要用引号括起来：

```
"some value
over two lines",some other value 
```

从[这个文件](https://datatracker.ietf.org/doc/html/rfc4180#page-2)，这是普遍接受的 CSV 标准：

> 包含换行符 (CRLF)、双引号和逗号的字段应该用双引号括起来

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-19T16:26:53.317

最常见的 csv 变体是与 excel 兼容的变体，只要字段用双引号括起来，就可以嵌入换行符。

```
foo,bar,"blah blah
more blah blah",baz 
```

或者

```
foo,bar,"blah blah
more blah blah" 
```

或者

```
"blah blah
more blah blah",baz 
```

都是有效的。此机制还允许嵌入逗号。

在没有嵌入新行（或逗号）的文本字段周围使用引号也可以。例如，如果文本本身包含双引号，则转义它的机制是将两个放在一起。

```
foo,bar,"this person said ""blah blah 
more blah blah""",baz 
```

编写正确处理此问题的 csv 阅读器可能会很棘手（尤其是在您依赖正则表达式的情况下）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-19T16:43:01.970

这里提到了 CSV 的标准。我有兴趣了解更多有关此的信息-我知道的唯一标准是

*   excel接受什么

*   RFC 位于[www.rfc-editor.org/rfc/rfc4180.txt](http://www.rfc-editor.org/rfc/rfc4180.txt)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T16:20:16.103

我不认为它是标准的一部分（如果有的话），但您可以使用标准的 C 样式转义，即编码 \r\n。

但是请记住，如果这样做，您还应该对转义字符进行编码——即解码后产生\。

# iphone - 如何在我的 iPhone 应用程序中包含字体？

> ID：566054
> 
> 赞同：7
> 
> 时间：2009-02-19T16:19:34.677
> 
> 标签：iphone, cocoa-touch

我已经看过这个帖子：

[我可以在 iPhone 应用程序中嵌入自定义字体吗？](https://stackoverflow.com/questions/360751/can-i-embed-a-custom-font-in-an-iphone-application)

这很有帮助，但我很想通过以下方式加载字体：

```
UIFont* font = [UIFont fontWithName:@"Harrowprint" size:20]; 
```

有人报告说这是可能的，但它对我不起作用。有人可以确认如何将自定义字体与 iphone 应用程序捆绑在一起吗？

此外，在上述帖子中，一个答案指出：字体的“名称”不一定是文件名。

如何确定 UIFont 可以识别的字体的“名称”？我可能没有使用正确的名称。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-19T19:31:11.280

您需要采取几个步骤：

1) 确保您有权分发字体。大多数字体——甚至是免费字体——都不允许您分发它们。将它们放在您的应用程序中很可能构成“分发”并且将被视为非法。

2) 将字体复制到应用程序中的资源文件夹中。确保它处于 Copy Files 构建阶段。

3）在plist文件中添加“应用程序提供的字体”键，并添加字体的完整文件名（包括扩展名）

4）通过放入临时代码行来获取字体的“名称”：

```
NSLog(@"%@",[UIFont familyNames]); 
```

构建并运行应用程序。这会将设备上所有字体的系列名称打印到控制台。找到与您的字体匹配的那个。

然后，您可以在方法中使用该字体名称`fontWithName:`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-11-10T16:24:04.107

To add onto August's answer above, you need to add a "Fonts provided by application" key to the plist file, and add the complete file name of the font (including extension). Then the font will appear in the family printout and you can use that name to set the font.

# sql - 递归 SQL CTE 和自定义排序顺序

> ID：566061
> 
> 赞同：9
> 
> 时间：2009-02-19T16:20:14.980
> 
> 标签：sql, linq, tsql, recursion, common-table-expression

图像您正在为线程化讨论板创建数据库模式。有没有一种有效的方法来为给定线程选择正确排序的列表？我编写的代码有效，但也没有按照我想要的方式排序。

假设您有以下数据：

```
身份证 | 父母ID
-----------------
1 | 无效的
2 | 1
3 | 2
4 | 1
5 | 3
```

所以结构应该是这样的：

```
1
|- 2
| |- 3
| | |- 5
|- 4
```

理想情况下，在代码中，我们希望结果集按以下顺序出现：**1、2、3、5、4**
**问题：**使用我编写的 CTE，它实际上返回为：**1、2、4、3、5**

我知道这很容易通过使用 LINQ 进行分组/排序，但我不愿意在内存中这样做。不过，这似乎是目前最好的解决方案......

这是我目前使用的 CTE：

```
with Replies as (   
    select c.CommentID, c.ParentCommentID 1 as Level
        from Comment c
        where ParentCommentID is null and CommentID = @ParentCommentID

    union all

    select c.CommentID, c.ParentCommentID, r.Level + 1 as Level
       from Comment c
       inner join Replies r on c.ParentCommentID = r.CommentID
)

select * from Replies 
```

任何帮助，将不胜感激; 谢谢！

* * *

我是 SQL 新手，之前没有听说过 hierarchyid 数据类型。[在从这个评论](https://stackoverflow.com/questions/202912/hierarchical-data-in-linq-options-and-performance/202929#202929)中阅读它之后，我决定我可能想要将它纳入我的设计中。今晚我将对此进行试验，如果成功，我会发布更多信息。

* * *

 **使用 dance2die 的建议**更新从我的示例数据返回的结果：**

```
身份证 | 家长 ID | 水平 | 密集等级
-------------------------------------
15 空 1 1
20 15 2 1
21 20 3 1
17 22 3 1
22 15 2 2
31 15 2 3
32 15 2 4
33 15 2 5
34 15 2 6
35 15 2 7
36 15 2 8
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-20T04:07:25.793

我相信你会**喜欢**这个的。我最近发现了[Dense_Rank()函数，根据](http://msdn.microsoft.com/en-us/library/ms173825.aspx)[MSDN](http://msdn.microsoft.com/en-us/library/ms173825.aspx)，该函数用于“在结果集的分区内排名”

查看下面的代码以及“CommentID”是如何排序的。

据我了解，您正在尝试按 ParentCommentID 对结果集进行分区。

注意“denserank”列。

```
with Replies (CommentID, ParentCommentID, Level) as 
(
        select  c.CommentID, c.ParentCommentID, 1 as Level
        from    Comment c
        where   ParentCommentID is null and CommentID = 1

        union all

        select  c.CommentID, c.ParentCommentID, r.Level + 1 as Level
        from    Comment c
                inner join Replies r on c.ParentCommentID = r.CommentID
)
select  *,
        denserank = dense_rank() over (partition by ParentCommentID order by CommentID)
from    Replies
order by denserank 
```

![替代文字](https://farm4.static.flickr.com/3413/3294556360_9f1cab0feb_o.png)

结果如下

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-06T21:31:33.863

您必须使用 hierarchyid（仅限 sql2008）或一堆字符串（或字节）连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T18:08:03.747

考虑在一个字段中存储整个层次结构（如果它发生变化，使用触发器来更新它）。

您示例中的该字段将具有： 1 1.2 1.2.3 1.2.5 1.4

那么你只需要对该字段进行排序，试试这个看看：

```
create table #temp (test varchar (10))
insert into #temp (test)
select '1'
union select '1.2'
union select '1.2.3'
union select '1.2.5'
union select '1.4'
select * from #temp order by test asc 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T16:46:22.933

嗯 - 我不确定你的结构是否最适合这个问题。在我的脑海中，无论如何我都无法在上面的查询中根据需要对数据进行排序。

我能想到的最好的方法是如果您有一个将您的评论联系在一起的父表（例如主题表）。如果你这样做了，你应该能够简单地将你的回复加入到那个上面（你显然需要包含正确的列），然后你可以按 topicID、Level 排序以获得你之后的排序顺序（或任何其他信息主题表代表了良好的排序价值）。

# apache-flex - 如何在 Flex 中克隆对象？

> ID：566066
> 
> 赞同：9
> 
> 时间：2009-02-19T16:20:47.540
> 
> 标签：apache-flex, flash, actionscript-3, clone, degrafa

我想克隆一个 Canvas 对象，该对象包含一个具有多个几何形状的 Degrafa Surface。

我尝试了天真的方法：

```
return ObjectUtil.copy(graph_area) as Canvas; 
```

导致错误：

```
TypeError: Error #1034: Type Coercion failed: cannot convert Object@63b1b51 to com.degrafa.geometry.Geometry.
TypeError: Error #1034: Type Coercion failed: cannot convert Object@63b1039 to com.degrafa.geometry.Geometry.
TypeError: Error #1009: Cannot access a property or method of a null object reference.
    at mx.core::Container/addChildAt()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Container.as:2196]
    at mx.core::Container/addChild()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Container.as:2140] ... 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-20T09:59:13.393

你想要的称为深拷贝，生成一个与原始信息相同的新实例。

我知道如何做到这一点的唯一方法是使用 ByteArray 如下：

```
private function clone(source:Object):*
{
    var buffer:ByteArray = new ByteArray();
    buffer.writeObject(source);
    buffer.position = 0;
    return buffer.readObject();
} 
```

AS3 真的缺少 Object.clone()...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-01-04T19:39:18.393

[对象工具](http://www.adobe.com/livedocs/flex/3/langref/mx/utils/ObjectUtil.html)

静态方法*ObjectUtil.copy()*是 AS3 的“Object.clone()”：

```
public static function copy(value:Object):Object 
```

> 复制指定的 Object 并返回对副本的引用。该副本是使用本机序列化技术制作的。这意味着在复制期间将尊重自定义序列化。
> 
> 此方法设计用于复制数据对象，例如集合的元素。它不适用于复制 UIComponent 对象，例如 TextInput 控件。如果要创建特定 UIComponent 对象的副本，可以创建组件的子类并实现 clone() 方法或其他方法来执行复制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T10:08:52.400

我发现自己在尝试更像这样的东西，唉，它似乎仍然没有复制 TextArea（又名 UI 对象）......

```
public function duplicateObject(sourceObject:*, targetObject:*):void {
    var buffer:ByteArray = new ByteArray();
    buffer.writeObject(sourceObject);
    buffer.position = 0;
    targetObject = buffer.readObject();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-17T02:30:07.387

我遇到了同样的问题（对于我创建的 NamedEntity 接口），在这里寻找答案，但只有调用 registerClassAlias 方法才能正常工作（我从[http://richapps.de/?p=34](http://richapps.de/?p=34)获取） . 就像这样：

```
public static function clone(namedEntity:NamedEntity):NamedEntity {
registerClassAlias('test',ReflectionUtil.classByObject(namedEntity));
var returnObject:NamedEntity = ObjectUtil.copy(namedEntity) as NamedEntity;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T08:49:24.820

我认为 ObjectUtil.copy 不适用于克隆画布。根据弹性文档：

Copy 此方法设计用于复制数据对象，例如集合的元素。它不适用于复制 UIComponent 对象，例如 TextInput 控件。如果要创建特定 UIComponent 对象的副本，可以创建组件的子类并实现 clone() 方法或其他方法来执行复制。

# c++ - 为 iPhone 应用程序解析 RSS/Atom 提要的最佳方法是什么？

> ID：566078
> 
> 赞同：15
> 
> 时间：2009-02-19T16:23:43.457
> 
> 标签：c++, iphone, c, objective-c

所以我知道，就解析直接 XML 而言，有几个选项可用：NSXMLParser、TouchCode 中的 TouchXML 等。这一切都很好，而且对我来说似乎工作得很好。

这里真正的问题是 RSS 提要（以及 Atom 提要）有许多小的变化，因此支持 Internet 上可用的提要的所有可能排列变得非常难以管理。我四处寻找可以为我处理所有这些低级细节的库，但结果却一无所获。

由于可以链接到 Objective-C 中的外部 C/C++ 库，我想知道是否有一个库最适合这项任务？肯定有人已经创建了这样的东西，只是很难从谷歌的数千个结果中找到“正确”的选项。

无论如何，在 iPhone 应用程序中解析 RSS/Atom 提要的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-05-15T19:49:52.197

[我刚刚发布了一个适用于 iPhone](http://github.com/mwaterfall/MWFeedParser)的开源RSS/Atom Parser ，希望它可能会有用。

我也很想听听你的想法！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T18:58:12.643

“最好”是相对的。走 SAX 路线并实现处理程序所需的最佳性能。我不知道有什么可用的开源代码（启动一个谷歌代码项目并将其发布给我们其他人使用！）

无论您做什么，尝试将整个 XML 文件加载到内存中并像 DOM 一样对其进行操作可能是一个非常糟糕的主意。您可能会收到比您在设备上处理能力要大得多的提要，从而导致频繁的内存警告和崩溃。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-31T02:13:17.710

我目前正在尝试正在开发的 MWFeedParser @Michael Waterfall。

很容易设置和使用（我是 iPhone 初学者）。

他使用 MWFeedParser 填充 UITableViewController 实现的示例代码也很有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-21T01:54:24.173

看看苹果的 XML 性能示例——它指向直接使用 libXML——以获得性能和更快的显示更新。如果您正在处理非常大的提要，这可能很重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-23T06:44:20.277

在 GitHub 上查看我的用于解析 Atom 提要的库 ( [BSAtomParser](https://github.com/bjornsallarp/BSAtomParser) )。它不关心验证提要，它尽最大努力返回有效的东西。解析器涵盖了大部分 RFC 4287，甚至扩展。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-05T11:34:33.983

这是我的解决方案：一个非常简单但功能强大的 RSS 解析库：[https ://github.com/H2CO3/RSSKit](https://github.com/H2CO3/RSSKit)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T03:44:39.110

你看过 TouchCode 了吗？我不认为它有一个 RSS 处理器，但它可能会给你一个开始。 [http://code.google.com/p/touchcode/](http://code.google.com/p/touchcode/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T14:33:05.323

我今天在 sourceforge 上遇到了[igasus](http://igagus.sourceforge.net/)项目。我没有使用它或真正检查过它，但也许它可能会有所帮助。

来自他们的网站： igagus 是 iPhone 的 Web 服务，它允许聚合 RSS 以 iPhone 友好的格式提供。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-20T17:10:57.863

实际上，我试图建议您在 TouchCode 讨论板上提问，因为我记得有人试图扩展它以支持 RSS。这可能是一个不错的起点。但是我被我的妻子催促了。

但我现在看到 TouchCode 没有讨论板。不过，我仍然会问作者，他可能知道这种努力的结果。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-01T15:08:27.687

[这](http://github.com/kballard/feedparser)对您来说可能是一个合理的起点。Atom 支持尚不存在，但您可以帮忙吗？

# php - 编码标准和行长

> ID：566082
> 
> 赞同：20
> 
> 时间：2009-02-19T16:24:33.180
> 
> 标签：php, coding-style

我见过的每个编码标准都对一行中的字符数有推荐或绝对限制。在此限制范围内有多种工作方式，但我没有看到这方面的任何具体指导。

显然，如果可能的话，不要写过长的行。

但如果这不切实际怎么办？长线应该如何处理？

这里有几个例子

```
if ($Stmt = $Mysqli->prepare("SELECT color, pattern, size,
                              manufacturer, mfgSku, storeLocation,
                              aisle, status
                              FROM tblItems WHERE ourSku = ?")) { 
```

或者

```
$flavors = array ('chocolate', 'strawberry', 'vanilla', 'cookie dough', 
                  'chocolate chip', 'mint chocolate chip', 'rocky road',
                  'peach', 'fudge brownie', 'coffee', 'mocha chip'); 
```

或者

```
$Stmt->bind_result( $this->_firstName,
                    $this->_lastName,
                    $this->_BillToAddress->address1,
                    $this->_BillToAddress->address2,
                    $this->_BillToAddress->city,
                    $this->_BillToAddress->state,
                    $this->_BillToAddress->zip,
                    $this->_BillToAddress->country,
                    $this->_email,
                    $this->_status,
                    $this->_primaryPhone,
                    $this->_mobilePhone ); 
```

在这些示例中的每一个中，冗长代码的缩进都是不同的。有没有更好或更“标准”的方式来做到这一点？额外的行是否应该始终以相同的方式缩进。或者这样可以吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-19T16:37:56.470

我个人的喜好如下；

```
$Stmt->bind_result(
    $this->_firstName,
    $this->_lastName,
    $this->_BillToAddress->address1,
    $this->_BillToAddress->address2,
    $this->_BillToAddress->city,
    $this->_BillToAddress->state,
    $this->_BillToAddress->zip,
    $this->_BillToAddress->国家，
    $this->_email,
    $this->_status,
    $this->_primaryPhone,
    $this->_mobilePhone
);

```

这样，右括号和分号与开始调用的缩进相同。并非所有语言都支持在方法调用的另一行上具有参数...

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-19T16:26:18.493

您可以在每个示例中看到一个模式 - 它们缩进到函数的第一个参数。这是一个很好的标准，因为它将数据从水平转换为垂直，并且列便于阅读。

对于其他行长问题，例如冗长的计算，首选方法是将其分解。计算儒略日或复活节是通过几个步骤完成的，而不是一个冗长的计算。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-19T16:28:17.207

上下文决定了你选择哪一个。最终，您正在编写供人类阅读的代码。如果以不同的方式缩进一段代码会使它更容易阅读，那么就这样做。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-19T16:46:09.593

在做大量 SQL 工作时，我发现自己逐渐适应的一种不寻常的缩进风格是：

```
INSERT INTO someTable
(
    id,
    name,
    age,
    address1,
    address2,
)
VALUES
(
    2,
    'Bob'
    25,
    '12 Fake Street',
    'The Moon'
) 
```

实际上，我发现它比长参数列表的任何其他布局更容易阅读。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-19T16:29:03.950

3号门。如果你不能在一行上做，就在每个项目上做一行，其他任何东西都会混淆第一行之后的项目，而且读起来很糟糕。一致的缩进也很重要。

Fwiw，我认为在大多数程序员应该拥有高分辨率双显示器的时代，这已经是老生常谈了。第一个例子看起来可能是一行很愉快。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-19T16:27:58.923

我不认为人们应该故意排长队，但是冒着冒犯许多人的风险，我建议线路长度真的不再那么重要了。

Vim 和 emacs 可以很好地处理长行，它们几乎安装在每个 Unix 机器上。在 Windows 上，您几乎总是在 GUI 文本编辑器中。我确实认为你的`$Stmt->bind_result`风格是最容易阅读的，但如果你只需要在一个语句中加载一堆大部分是静态的信息，我对 1000 个字符的行没有任何问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-19T16:29:49.367

这真的很主观，就像括号的位置和其他编码风格一样。主要的不是你选择哪种风格，而是你确实选择了一种风格，并且在整个项目中坚持下去。

就我个人而言，来自 Python 背景，我使用 79 的行长和

```
$flavors = array ('chocolate', 'strawberry', 'vanilla', 'cookie dough', 
                  'chocolate chip', 'mint chocolate chip', 'rocky road',
                  'peach', 'fudge brownie', 'coffee', 'mocha chip'); 
```

风格。

但正如我所说，在我看来，拥有一种风格比担心哪种风格更重要。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-19T16:32:10.673

在散文中，超过 80 行的行已被证明更难阅读。（请参阅 LaTeX Memoir 类[文档](http://tug.ctan.org/tex-archive/macros/latex/contrib/memoir/memman.pdf)的第 13 页。）*代码完成*（我的版本的第 18.5 节，第 425 页）还引用了 80 个字符的限制，附带此附带条件：

> 对于更大的屏幕、窄字体、激光打印机和横向模式，关于 80 个字符限制的论点并不像以前那样引人注目。单行 90 个字符长的行通常比为了避免溢出 80 列而分成两行的行更具可读性。用现代技术，偶尔超过80列可能没问题。

我会将您的第一个示例中的 SQL 与其余代码分开缩进：

```
if ($Stmt = $Mysqli->prepare(
            "SELECT color, pattern, size,
                    manufacturer, mfgSku, storeLocation,
                    aisle, status
             FROM tblItems 
             WHERE ourSku = ?")) { 
```

如果将第二个示例加载到配置文件或表中，它可能会更好。

第三个很好，但是您可以通过以下方式将其收紧：

```
$Stmt->bind_result( 
   $this->_firstName,
   $this->_lastName,
   $this->_BillToAddress->address1,
   $this->_BillToAddress->address2,
   $this->_BillToAddress->city,
   $this->_BillToAddress->state,
   $this->_BillToAddress->zip,
   $this->_BillToAddress->country,
   $this->_email,
   $this->_status,
   $this->_primaryPhone,
   $this->_mobilePhone 
); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-19T16:43:08.960

如果您要包装两个以上的项目，我更喜欢在第三个示例中为每个项目换行。如果每行只有一个项目，自动化源代码控制工具更容易合并其他人的编辑。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-19T17:23:04.750

遵循周围代码使用的标准。无论多么“好”，都不要创建自己的“标准”。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-19T16:27:25.597

我不知道任何标准，因为这很难说。对于我们这些在较大显示器上的人来说，我们可以在较小的显示器上查看比其他人更多的水平代码。我通常会在必要时尝试通过 .= (PHP) 顺序构建长字符串，并且正如您的代码所示，我根据特定行中存在的字符数将冗长的数组任意拆分到新行上。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-19T16:33:37.170

我不太介意选项 3（每行 1 项）。另外，就我个人而言，我总是使用自动换行，所以在一行上写代码根本不会打扰我。但是，在您的第二个示例中，如果启用了自动换行，那么对于确实使用自动换行的程序员来说，这可能看起来一团糟。也许我是一个不介意排长队的小团体。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-19T16:34:56.723

最佳实践通常源于行长限制本身背后的目的：

*   增加互操作性（程序员、编辑软件等之间）
*   提高可读性和理解力
*   增加乐趣和发展速度
*   增加收入和利润

因此，如果您的选择（例如对齐所有 stmt 参数）有助于您自己和团队中其他人的未来理解，那么它们是好的。

希望这会有所帮助；）-M

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-19T22:59:24.880

这里有一些有用的信息 [http://framework.zend.com/manual/en/coding-standard.coding-style.html](http://framework.zend.com/manual/en/coding-standard.coding-style.html)

# python - django视图的python代码

> ID：566083
> 
> 赞同：2
> 
> 时间：2009-02-19T16:24:39.357
> 
> 标签：python, django, syntax, many-to-many

模型：

```
class Pathology(models.Model):
    pathology = models.CharField(max_length=100)

class Publication(models.Model):
    pubtitle = models.TextField()

class Pathpubcombo(models.Model):
    pathology = models.ForeignKey(Pathology)
    publication = models.ForeignKey(Publication) 
```

1.  作为下拉菜单发送到 HTML 模板的病理列表

看法：

```
def search(request):
    pathology_list = Pathology.objects.select_related().order_by('pathology') 
```

2.  用户从下拉菜单中选择一个病理名称，并通过以下方式检索 id

看法：

```
def pathology(request):
    pathology_id = request.POST['pathology_id'] 
    p = get_object_or_404(Pathology, pk=pathology_id) 
```

我被困在哪里。我需要 python/django 语法来编写以下内容：

pathology_id 现在必须从表 Pathpubcombo（中间多线程表）中检索 publication_id。一旦获得了publication_id，就必须使用它来从发布表中检索所有属性，并将这些属性发送到另一个html模板以显示给用户。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T16:47:02.637

您应该使用此处描述的多对多关系：http: [//www.djangoproject.com/documentation/models/many_to_many/](http://www.djangoproject.com/documentation/models/many_to_many/)

像：

```
class Pathology(models.Model):
    pathology = models.CharField(max_length=100)
    publications = models.ManyToManyField(Publication)

class Publication(models.Model):
    pubtitle = models.TextField() 
```

然后

```
def pathology(request):
    pathology_id = request.POST['pathology_id'] 
    p = get_object_or_404(Pathology, pk=pathology_id)
    publications = p.publications.all()
    return render_to_response('my_template.html',
                              {'publications':publications},
                              context_instance=RequestContext(request)) 
```

希望这可行，尚未对其进行测试，但您明白了。

编辑：

如果无法重命名表并使用 django 的内置支持，您也可以使用 select_related()。

[http://docs.djangoproject.com/en/dev/ref/models/querysets/#id4](http://docs.djangoproject.com/en/dev/ref/models/querysets/#id4)

# visual-studio - Git 还是颠覆？

> ID：566087
> 
> 赞同：19
> 
> 时间：2009-02-19T16:25:32.390
> 
> 标签：visual-studio, svn, git

假设我正在家里使用 Visual Studio 开始一个新的 Web 项目，该版本控制系统，即。Git 或 Subversion 会更好用吗？哪一个的设置复杂度最低？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-19T16:31:06.177

由于这是您自己的个人游戏，我的问题很简单：您是否已经了解 Subversion 或 Git？

*   如果你知道 SVN - 使用 Git。
*   如果你知道 Git - 使用 SVN。

如果您也不知道 - 使用 SVN。这是一个更好的介绍。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-19T16:34:33.057

我会选择 Git。掌握基础知识并没有那么糟糕（现在有很多很好的资源，包括 learn.github.com），而且它会得到回报。而且我一直在 Vista 上使用它，没有任何问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-19T16:31:31.497

根据我的经验，Subversion 对 Windows 更友好，并且对独立开发人员也更直接有用。

另一种可能性是 Perforce，它对 Windows 不太友好，但功能齐全且相当易于使用，更不用说最多可免费供两个用户使用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-19T16:27:49.063

Git 是一个分布式源代码控制设置，由于您是唯一的用户，我无法想象您会从它的功能中受益匪浅。Subversion（在我看来）更容易设置，所以我建议你使用它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-19T16:45:32.477

如果你一个人工作并且想要某种易于使用的版本控制，那么使用 Subversion。它在 Windows 上运行良好，设置存储库是在空的[Tortoise SVN](http://tortoisesvn.net/downloads)中单击鼠标右键。[Ankh SVN](http://ankhsvn.open.collab.net/servlets/ProjectProcess?pageID=3794)提供了与 Visual Studio 的非常好的集成 - 只要您使用 VS 2005 或更新版本，几乎可以与 TFS 相提并论。

另一方面，Git 比 SVN 更有前途。我会在今年检查它，但第三方工具还没有达到标准。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-19T17:05:55.733

我会选择[Mercurial](http://www.selenic.com/mercurial/wiki/)。它应该类似于 Git（由于 Windows 问题，我永远无法运行它）并且在 Windows 中设置非常容易，并且非常适合“个人”版本控制系统。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-19T16:30:37.983

您决定使用哪一个在很大程度上取决于您现在和未来的需求。Git 有一个非常好的社区，它与[GitHub](http://www.github.com)建立了一个非常好的社区，非常适合共享代码和项目。SVN 的设置和使用非常简单，但在大型团队中，Git 凭借其分支和合并功能击败了它。如果您有多个人在同一个项目上工作，这是理想的选择，无论是在办公室环境中，还是在团队分散的 OSS 意义上。

如果您所需要的只是快速简单的设置和开始，以便您可以开始您的项目，那么 SVN 应该没问题。SVN 还集成到许多编辑器和 IDE 以及许多错误跟踪和持续集成系统中。

如果您计划或已经拥有一个团队，Git 的分支和合并设置值得一看。然而，Git，主要是由于还很年轻，没有那么多可用的支持

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-20T09:41:23.980

如果您想要 Visual Studio 集成，那是毫无疑问的。只有 Subversion 具有 Visual Studio 集成（[AnkhSVN](http://ankhsvn.net/)、[VisualSVN](http://www.visualsvn.com)和几个允许访问[TortoiseSVN](http://tortoisesvn.net/)的脚本）。

Subversion 有如此大量的工具为其编写的最重要的原因之一是它被设计为一个可供多个客户端使用的稳定库。

在 git 支持作为某种可重用库提供之前，Git 不太可能在 Visual Studio 中获得相同级别的集成。（有一个[libgit2](http://kerneltrap.org/mailarchive/git/2008/10/31/3880864)的计划可以使这成为现实）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-03T21:42:26.200

这个问题的一个很好的答案是最近由 Jack Repenning 在这里写的：

*   ***如果您对工作的单一、确定的主副本有令人信服的要求，请使用 Subversion。**你可以用 Git 做到这一点，只要没有失误。但是你不能用 Subversion 做任何其他事情（疏忽或没有），并且像 Sarbanes-Oxley 这样的“强制性要求”更喜欢保证而不是可能性。*

*   ***如果您计划维护同一产品的并行、大部分共享但永久有些不同的产品线，请使用 Git。**一个常见的例子：也许你有一个为每个客户定制的大型产品。自定义是永久性的，通常不会在代码行之间共享，但大多数代码对所有人都是通用的。Git 就是为这种情况而设计的（在 Git 术语中，对公共核心的本地自定义，以及偶尔的功能或错误修复贡献备份树）*

*   ***那些都不是？**任你选择，你应该可以使用任何一种工具。**

完整的博客文章在这里： http: [//blog.codesion.com/post/15692788883/subversion-or-git-decisions-decisions](http://blog.codesion.com/post/15692788883/subversion-or-git-decisions-decisions)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-22T15:52:04.760

阅读本文后，您可以发表自己的看法：[http ://whygitisbetterthanx.com](http://whygitisbetterthanx.com)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-19T16:49:39.977

让我来回答你的问题并问：

1.  Git 可以在 Windows 上运行吗？
2.  它有什么相当于乌龟的东西吗？（否则我看不出它在易用性方面如何与 SVN 竞争）

附带说明：如果它真的是一个人的家庭项目，你真的不需要任何源代码控制工具。只需将您的项目放在[DropBox](https://www.getdropbox.com/home)文件夹中即可完成（自动提交、无限修订、取消删除）。除非你真的认为你需要标签和分支之类的东西。但是对于个人家庭项目......是吗？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-02-24T08:10:58.333

Git.................................（这些点在那里是因为 SO 不接受 3 个字母的回答）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-22T18:17:06.127

使用 SVN，您必须设置服务器，在那里创建存储库，签出（空）存储库，添加文件，然后提交。

使用 Git，您只需要`git init`在项目的根目录中即可。然后，您可以根据需要添加和提交文件。

设置 Subversion 服务器并没有任何想法，因为您是唯一一个在源代码上工作的人。与许多人的想法相反，独立项目是分布式版本控制工具的完美搭配。以后扩展您的项目也很容易。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-02-24T08:04:11.793

根据我的经验，Subversion 更容易“理解”，但 Git 更快、更容易参与软件开发最佳实践。作为一名前 CVS 用户，当我开始使用 Subversion 时，它立即对我产生了影响。Git 进行了一些研究，我仍然需要不时参考手册，但我喜欢在必须维护发布过程时分支和合并代码是多么容易。

如果您已经熟悉 CVS 并且只需要一些东西来保存您的历史记录和差异，那么 Subversion 将更容易上手。如果您是版本控制的新手，那么总体趋势正在转向 DVCS，尤其是 Git，因此总体而言，您可能会从中获得更多收益。

我建议您查看托管提供商，这样您就不必担心设置 Subversion 服务器，或者您可以为 Git 数据提供备份位置。您可以通过 Google 搜索“[颠覆托管](http://www.google.com/search?q=subversion+hosting)”或“ [git 托管](http://www.google.com/search?q=git+hosting)”来查看该领域的主要提供商。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-02-19T16:48:36.590

如果您打算将您的项目放在 U 盘上，请使用 Subversion。Windows XP 在将大量小文件缓存在 USB 记忆棒上时真的非常非常糟糕。Git 为提交操作编写了许多小文件，这在 Windows 上需要很长时间。

[编辑] Windows XP 和 USB 记忆棒上的文件的问题是缓存（或缺少缓存）。*为防止数据丢失，XP 将始终将文件同步写入 USB 记忆棒（因此只有在*FS 报告所有块都已写入记忆棒后，任何写入才会恢复）。再加上 U 盘在处理小文件时速度很慢（初始化磨损级别管理有很多开销），这会导致任何类型的写入大量小文件的应用程序的性能非常差。

[EDIT2] 如果您将 SVN 结帐放在 U 盘上，您还会有很多小文件（尤其是在 .svn 目录中）。因此，这种情况下的解决方案是将 Subversion 存储库（“服务器”）放在 USB 驱动器上。存储库仅使用一堆大文件（如果您使用数据库选项而不是基于文件的选项：）`svnadmin create --fs-type bdb`。这避免了“许多小文件问题”。当前版本的 Git 无法实现相同的目标。

# java - Easymock：捕获的顺序重要吗？

> ID：566091
> 
> 赞同：6
> 
> 时间：2009-02-19T16:26:36.793
> 
> 标签：java, mocking, easymock

这似乎是一个关于 Easymock 的非常详细的问题，但我很难找到该库的支持站点/论坛/邮件列表。

`captures()`在使用似乎无序返回捕获的参数的方法时，我遇到了一个错误。

这是我正在测试的简化版本：

```
public class CaptureTest extends TestCase {

    // interface we will be mocking
    interface Processor {
            void process(String x);
    }

    // class that uses the interface above which will receive the mock
    class Component {

        private Processor processor;

        private String[] s = { "one", "two", "three", "four" };

        Component(Processor processor) {
            this.processor = processor;
        }

        public void doSomething() {
            for (int i = 0; i < s.length; i++) {
                processor.process(s[i]);
            }
        }
}

    public void testCapture() {

        //create the mock, wire it up    
        Processor mockProcessor = createMock(Processor.class);
        Component component = new Component(mockProcessor);

        //we're going to call the process method four times
        //with different arguments, and we want to capture 
        //the value passed to the mock so we can assert against it later    
        Capture<String> cap1 = new Capture<String>();
        Capture<String> cap2 = new Capture<String>();
        Capture<String> cap3 = new Capture<String>();
        Capture<String> cap4 = new Capture<String>();

        mockProcessor.process(and(isA(String.class), capture(cap1)));
        mockProcessor.process(and(isA(String.class), capture(cap2)));
        mockProcessor.process(and(isA(String.class), capture(cap3)));
        mockProcessor.process(and(isA(String.class), capture(cap4)));

        replay(mockProcessor);

        component.doSomething();

        //check what values were passed to the mock
        assertEquals("one", cap1.getValue());
        assertEquals("two", cap2.getValue());
        assertEquals("three", cap3.getValue());
        assertEquals("four", cap4.getValue());

        verify(mockProcessor);
    }

} 
```

（请注意，这只是一个简化的测试用例 - 我知道我可以指定我期望传递给我的模拟的参数的确切值，但在我的真实案例中，参数是具有少数字段的复杂对象，我想要捕获对象，这样我就可以只针对其中几个字段进行断言，而无需在我的测试用例中重新创建整个对象）。

当我运行测试时，它在以下位置失败：

> junit.framework.ComparisonFailure：预期：<[one]> 但为：<[four]>

这意味着 EasyMock 捕获的参数`cap1`不是对该方法的第一次调用，而是最后一次调用（因为值为`four`）。如果我反转`captures()`声明，即使用`cap4`第一个方法调用等，我会得到相同的结果。

这似乎可能是 EasyMock 中的一个错误 - 在不同调用中传递给同一方法的不同参数似乎没有被正确捕获。

有其他人使用`capture()`EasyMock 并遇到类似问题吗？您是否知道一种简单的解决方法，或者我可以捕获传递给我的模拟方法的参数的不同方法？

*更新 1*：固定代码示例以显示我正在使用`createMock`，而不是`createStrictMock`，但两者都出现相同的错误（尽管捕获的实际值发生了变化）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T14:09:26.130

我收到[了关于我提交给 Easymock sourceforge 站点的错误的答复](https://sourceforge.net/tracker/?func=detail&atid=567837&aid=2617107&group_id=82958)，开发人员已确认这确实是此版本 Easymock 的错误。

> 这确实是一个错误。即使已经完成捕获也已完成。当前的解决方法是实现您自己的捕获对象并覆盖 setValue 来执行此操作：

```
@Override
public void setValue(T value) {
  if(!hasCaptured()) {
    super.setValue(value);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T18:58:52.417

我在玩你的测试，无法解决。但是，我扩展了 Capture 类以查看值是否以不同的顺序设置（我怀疑 EasyMock 内部使用了带有从方法和参数生成的键的散列）我错了，方法是按正确的顺序设置的. 但是发生了一些非常奇怪的事情..似乎该算法做了某种分配模式..好吧，让我展示一下代码和奇怪的输出....顺便说一句，mock、niceMock和strictMock的变化没有任何区别..

```
class MyCapture extends Capture<String> {

    private String id;

    public MyCapture(String id) {
        super();
        System.out.printf("Constructor %s expecting %s\n", id, this.getClass().getName());
        this.id = id;
    }

    private static final long serialVersionUID = 1540983654657997692L;

    @Override
    public void setValue(String value) {
        System.out.printf("setting value %s expecting %s \n", value, id);
        super.setValue(value);
    }

    @Override
    public String getValue() {
        System.out
                .printf("getting value %s expecting %s \n", super.getValue(), id);
        return super.getValue();
    }
}

public void testCapture() {

    // create the mock, wire it up
    Processor mockProcessor = createStrictMock(Processor.class);
    Component component = new Component(mockProcessor);

    // we're going to call the process method four times
    // with different arguments, and we want to capture
    // the value passed to the mock so we can assert against it later
    Capture<String> cap1 = new MyCapture("A");
    Capture<String> cap2 = new MyCapture("B");
    Capture<String> cap3 = new MyCapture("C");
    Capture<String> cap4 = new MyCapture("D");

    mockProcessor.process(and(isA(String.class), capture(cap1)));
    mockProcessor.process(and(isA(String.class), capture(cap2)));
    mockProcessor.process(and(isA(String.class), capture(cap3)));
    mockProcessor.process(and(isA(String.class), capture(cap4)));
    replay(mockProcessor);

    component.doSomething();

    // check what values were passed to the mock
    assertEquals("A", cap1.getValue());
    assertEquals("B", cap2.getValue());
    assertEquals("C", cap3.getValue());
    assertEquals("D", cap4.getValue());

    verify(mockProcessor);
} 
```

}

*这是输出*

```
Constructor A expecting com.comp.core.dao.impl.CaptureTest$MyCapture
    Constructor B expecting com.comp.core.dao.impl.CaptureTest$MyCapture
    Constructor C expecting com.comp.core.dao.impl.CaptureTest$MyCapture
    Constructor D expecting com.comp.core.dao.impl.CaptureTest$MyCapture
    calling process A 
    setting value A expecting A 
    calling process B 
    setting value B expecting A <<Setting the wrong guy
    setting value B expecting A <<Setting the wrong guy
    setting value B expecting B <<Ops this is the right one..stop
    calling process C 
    setting value C expecting B <<Setting the wrong guy
    setting value C expecting B <<Setting the wrong guy
    setting value C expecting C <<Setting the wrong guy
    calling process D 
    setting value D expecting C <<Setting the wrong guy
    setting value D expecting C <<Setting the wrong guy
    setting value D expecting D <<Ops this is the right one..stop
    getting value B expecting A 
```

对不起，我不能帮助你更多。这可能确实是简单模拟中的一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T17:51:49.803

您也可以尝试使用 EasyMock.createNiceMock(...) 代替 EasyMock.createStrictMock(...) 或 EasyMock.createMock(...)。

虽然，我同意它看起来更像是 createMock 的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-29T02:56:30.307

我认为这是一个更适合基于状态的测试的问题。使用 JMockit，您可以像这样解决它：

```
import mockit.*;
import static mockit.Mockit.*;
import mockit.integration.junit3.*;

public class CaptureTest extends JMockitTestCase
{
   interface Processor { void process(String x); }

   class Component
   {
      private final Processor processor;
      private final String[] s = {"one", "two", "three", "four"};

      Component(Processor processor) { this.processor = processor; }

      public void doSomething()
      {
         for (String value : s) {
            processor.process(value);
         }
      }
   }

   @MockClass(realClass = Processor.class)
   static class MockProcessor
   {
      private final String[] expectedValues;
      private int i;

      MockProcessor(String... expectedValues) { this.expectedValues = expectedValues; }

      @Mock
      void process(String x)
      {
         assertEquals(expectedValues[i++], x);
      }
   }

   public void testCapture()
   {
      Processor mockProcessor = setUpMock(new MockProcessor("one", "two", "three", "four"));
      Component component = new Component(mockProcessor);

      component.doSomething();
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-20T18:27:06.823

简而言之，这对我有用：

```
MyClass myMock = EasyMock.createStrictMock(MyClass.class); 
```

...

```
EasyMock.checkOrder(myMock, true); // before the capture and verify, not sure if it matters 
```

...

```
Capture<MyArg> capturedArgs = new Capture<MyArg>();
expect(myMock.search(capture(capturedArgs))).andReturn(someRandomReturn); 
```

PS：我使用的是 EasyMock 3.0

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-19T16:30:27.670

而不是调用**EasyMock.createStrictMock(...)**只需调用**EasyMock.createMock(...)**。应该能解决你的问题。

# command-line - 如何识别 CVS 中存在哪些分支？

> ID：566093
> 
> 赞同：24
> 
> 时间：2009-02-19T16:27:10.057
> 
> 标签：command-line, scripting, cvs, branch

我有一个遗留的 CVS 存储库，应该迁移到 Perforce。

对于每个模块，我需要确定该模块中存在哪些分支。

我只想要一个分支名称列表，没有标签。出于脚本原因，它必须是命令行工具。

例如（假设有一个 cvs-list-branches.sh 脚本）：

```
$ ./cvs-list-branches.sh module1
HEAD
dev_foobar
Release_1_2
Release_1_3
$ 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-05-04T12:06:29.770

作为一个快速破解:) rlog 也是如此。

```
cvs log -h | awk -F"[.:]" '/^\t/&&$(NF-1)==0{print $1}' | sort -u 
```

根据[bdevay](https://stackoverflow.com/users/774222/bdevay)改进版本，隐藏不相关的输出并左对齐结果：

```
cvs log -h 2>&1 | awk -F"[.:]" '/^\t/&&$(NF-1)==0{print $1}' | awk '{print $1}' | sort -u 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-20T08:21:10.460

您可以简单地解析`cvs log -h`. 对于每个文件，都会有一个名为`Symbolic names :`. 那里列出的所有标签的修订号都包含一个零作为最后一位但一位数字是分支。例如：

```
$ cvs log -h

Rcs file : '/cvsroot/Module/File.pas,v'
Working file : 'File.pas'
Head revision : 1.1
Branch revision : 
Locks : strict
Access :
Symbolic names :
    1.1 : 'Release-1-0'
    1.1.2.4 : 'Release-1-1'
    1.1.0.2 : 'Maintenance-BRANCH'
Keyword substitution : 'kv'
Total revisions : 5
Selected revisions : 0
Description :

=============================================== 
```

在这个例子`Maintenance-BRANCH`中显然是一个分支，因为它的修订号被列为 1.1。**0** .2。这有时也称为*魔术*分支修订号。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-19T16:45:53.570

这也会调出标签，但标签和分支在 CVS 中基本相同。

```
$cvs.exe rlog -h -l -b module1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T11:08:32.493

我有一小部分“方便”的 korn shell 函数集合，其中一个函数获取给定文件的标签。我做了一个快速的尝试来调整它来做你想做的事。它只是对 (r) 日志输出进行一些 seding/greping 并列出具有“.0”的版本。在它们中（这表明它是一个分支标签）：

```
get_branch_tags()
{
    typeset FILE_PATH=$1

    TEMP_TAGS_INFO=/tmp/cvsinfo$$

    /usr/local/bin/cvs rlog $FILE_PATH 1>${TEMP_TAGS_INFO} 2>/dev/null

    TEMPTAGS=`sed -n '/symbolic names:/,/keyword substitution:/p' ${TEMP_TAGS_INFO} | grep "\.0\." | cut -d: -f1 | awk '{print $1}'`
    TAGS=`echo $TEMPTAGS | tr ' ' '/'`
    echo ${TAGS:-NONE}
    rm -Rf $TEMP_TAGS_INFO 2>/dev/null 1>&2
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T16:48:07.570

使用 Wincvs（Windows 的 GUI 客户端）这很简单，右键单击将为您提供文件具有的任何分支和标签。

通过 shell，您可以使用 cvs log -h -l 模块。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-25T13:09:48.907

检查存储库中创建和提交的第一个文件。在服务器中打开文件，该文件将列出所有标签和分支

# asp.net - 为什么 ASP.NET 会显示此错误？

> ID：566098
> 
> 赞同：0
> 
> 时间：2009-02-19T16:28:03.790
> 
> 标签：asp.net, iis, visual-studio-2005, localhost

我已经安装了 Visual Studio .NET 2005。但是当我尝试执行 asp.net 应用程序时，我收到以下错误：

> 无法打开 Web ' [http://localhost/adiii](http://localhost/adiii) '。无法在端口 80 上的“localhost”找到 Web 服务器。请检查以确保 Web 服务器名称有效并且您的代理设置设置正确。如果您确定一切都正确，则 Web 服务器可能暂时停止服务。

[单击此处查看我收到的错误的屏幕截图](http://www.flickr.com/photos/prashantvictory/3293240858/sizes/o/)

谁能告诉我这个问题的解决方案。我们知道 VS2005 中有嵌入式 Web 部署服务器，那么为什么它给我这个错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T16:38:17.660

看起来当您创建项目时，您选择了 HTTP 作为位置，而不是默认的文件系统。HTTP 意味着您有一个现有的 Web 服务器（不是 Visual Studio），您希望在该服务器上运行和测试您的项目（以及 Visual Studio 将尝试查找您的源代码的位置）。

创建一个项目并选择文件系统在您的硬盘上创建一个项目，该项目将使用 Visual Studio 的内部 Web 服务器运行（然后您可以在需要时将项目发布/部署到真实的 Web 服务器）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T16:41:54.150

您是否已明确定义内部 Web 服务器应在端口 80 上运行应用程序？

默认行为是它在随机端口上运行。如果您的设置正常，则可能是与您机器上的另一个 Web 服务器（Apache、IIS）的端口冲突。

有时即使是 Skype 也可以占用 80 端口并导致类似的问题。

**更新：**

现在我明白了 - 您正在使用网站项目，我们假设您正在使用 Web App 项目。

在这种情况下，过程略有不同：您在解决方案资源管理器中选择项目并打开属性窗格。在这里，您应该能够识别项目的两个属性：**端口号**和**使用动态端口**。我假设您的第一个属性设置为**80**，第二个属性设置为**false**。将第二个更改为**true**，您应该能够解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T16:50:27.407

您很有可能在 VS2003 中创建项目并将其升级到 VS2005。VS2003 使用 HTTP（例如 IIS 的本地安装），而 VS2005 项目使用内置服务器——很可能，升级后的项目仍在尝试使用不存在的本地 IIS。

**这样做：**右键单击您的项目，选择“属性”，然后导航到弹出窗口中的“Web”选项卡。您将看到一个屏幕，允许您选择要在哪个服务器上进行开发，然后确保选中“使用 Visual Studio 开发服务器”和“自动分配端口”旁边的按钮。

如果您需要，这是一个视觉参考：

[http://img24.imageshack.us/my.php?image=confignw0.png](http://img24.imageshack.us/my.php?image=confignw0.png)

你现在应该可以走了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T16:40:23.503

Visual Studio 确实有一个嵌入式 Web 服务器，但它从不在端口 80 上运行。您的 URL 清楚地指向端口 80。

最可能的问题是您的程序本身工作不正常，但没有代码我无能为力。

# mysql - 如何将填充的 mySQL 数据库从 dev 迁移到共享主机？

> ID：566104
> 
> 赞同：2
> 
> 时间：2009-02-19T16:29:26.747
> 
> 标签：mysql

标题几乎说明了一切，但要详细说明：如果我在本地开发机器上构建一个 mySQL 数据库，用数据填充它，然后想将数据库迁移到共享主机（在本例中为 Siteground），该怎么办我这样做的方式是保持结构和数据完整吗？

在这种情况下，我没有对数据库服务器的文件访问权限。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T16:30:21.943

使用**mysqldump** ( [doc](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html) ) 并将开发机器上的数据库 (mysqldump [databasename] 用于简单配置) 转储到转储 (*包含恢复模式和数据所需的 sql 语句的文件*)。现在使用提供的实用程序在您的共享主机上插入转储（通常您会从您的主机预安装**phpMyAdmin**，它可以导入转储）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T16:37:03.643

除了 theomega 做出的响应（即，对开发数据库进行转储，然后将转储插入到生产数据库中）之外，请注意，如果您有大量数据，您可能需要启用大型 SQL 插入语句。我建议您首先将文件 FTP 到主机，然后从文件中插入。每个主机都有自己的方法，但如果您可以使用 SSH 连接到远程服务器，则可能能够使用命令行运行插入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T16:46:57.770

除了 theomega：大多数 mysql 工具都有 sql 文件的转储/执行功能。
例如，如果您使用的是[navicat](http://www.navicat.com/)，您只需单击鼠标右键即可：

右键单击要导出的数据库，然后选择“dump sql file”。这将允许您将 .sql 文件保存在您选择的文件夹中的本地驱动器上。

然后，右键单击目标数据库并选择“执行批处理文件”。浏览到新创建的 .sql 文件，它将执行目标数据库中该文件中的所有 sql 命令。即，创建导出数据库的副本。

# perl - 如何跟踪远程文件？

> ID：566110
> 
> 赞同：46
> 
> 时间：2009-02-19T16:30:26.657
> 
> 标签：perl, scripting, ssh, tail, netcat

我正在尝试找到一种在远程主机上跟踪文件的好方法。这是在 Linux 机器的内部网络上。要求是：

1.  必须表现良好（没有额外的进程，或持续输出）

2.  不能要求某人的宠物 Perl 模块。

3.  可以通过 Perl 调用。

4.  如果可能，不需要在远程机器上自定义构建的脚本或实用程序（常规的 linux 实用程序很好）

我尝试过的解决方案一般都是这种

```
ssh remotemachine -f <some command> 
```

“一些命令”是：

```
tail -f logfile 
```

基本 tail 不起作用，因为远程进程在本地 ssh 进程死亡后继续将输出写入终端。

```
$socket = IO:Socket::INET->new(...);
$pid = fork();
if(!$pid)
{
  exec("ssh $host -f '<script which connects to socket and writes>'");
  exit;
}

$client = $socket->accept;
while(<$client>)
{
  print $_;
} 
```

这效果更好，因为在本地进程退出后没有输出到屏幕，但远程进程没有发现它的套接字已关闭并且它无限期地存在。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-02-19T17:05:16.103

你有没有尝试过

```
ssh -t remotemachine <some command> 
```

-t 来自 ssh 手册页的选项：

```
 -t      Force pseudo-tty allocation. This can be used to execute 
         arbitrary screen-based programs on a remote machine, which
         can be very useful, e.g. when implementing menu services.
         Multiple -t options force tty allocation, even if ssh has no local tty. 
```

代替

```
 -f      Requests ssh to go to background just before command execution.  
         This is useful if ssh is going to ask for passwords or passphrases, 
         but the user wants it in the background.
         This implies -n.  The recommended way to start X11 programs at a remote
         site is with something like ssh -f host xterm. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T16:38:33.683

一些想法：

*   您可以通过 NFS 或 CIFS 安装它，然后使用[File::Tail](http://search.cpan.org/perldoc?File::Tail)。
*   您可以使用 Perl 的 SSH 模块之一（有很多），结合`tail -f`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-20T22:44:20.597

不过，您只能尝试[Survlog](https://itunes.apple.com/us/app/survlog/id402370858?mt=12)它的 OS X。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T17:01:37.687

netcat 应该为你做这件事。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T10:16:30.683

您可以使用 bash 和 rsync 远程跟踪文件。以下脚本取自本教程：[Tail files remote using bash and rsync](http://sshadmincontrol.com/documentation/tail-files-remotely-using-bash-and-rsync)

```
#!/bin/bash
#Code Snippet from and copyright by sshadmincontrol.com
#You may use this code freely as long as you keep this notice.

PIDHOME=/a_place/to/store/flag/file
FILE=`echo ${0} | sed 's:.*/::'`
RUNFILEFLAG=${PIDHOME}/${FILE}.running

if [ -e $RUNFILEFLAG ]; then
   echo "Already running ${RUNFILEFLAG}"
   exit 1
else
   touch ${RUNFILEFLAG}
fi

hostname=$1 #host name to remotlely access
log_dir=$2  #log directory on the remotehost
log_file=$3 #remote log file name
username=$3 #username to use to access remote host
log_base=$4 #where to save the log locally

ORIGLOG="$log_base/$hostname/${log_file}.orig"
INTERLOG="$log_base/$hostname/${log_file}.inter"
FINALLOG="$log_base/$hostname/${log_file}.log"

rsync -q -e ssh $username@$hostname:$log_dir/$log_file ${ORIGLOG}
grep -Ev ".ico|.jpg|.gif|.png|.css" > ${INTERLOG}  

if [ ! -e $FINALLOG ]; then
   cp  ${INTERLOG} ${FINALLOG}
else
   LINE=`tail -1 ${FINALLOG}`
   grep -F "$LINE" -A 999999999 ${INTERLOG} \
      | grep -Fv "$LINE" >> ${FINALLOG}
fi

rm ${RUNFILEFLAG}
exit 0 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T16:57:34.900

rsync://[USER@]HOST[:PORT]/SRC... [DEST] | 尾巴 [目的地] ?

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T17:30:03.607

有人建议使用 nc (netcat)。此解决方案确实有效，但不如仅使用 ssh -t 理想。最大的问题是你必须在连接的两边都使用 nc 并且需要在本地机器上做一些端口发现来找到一个合适的端口来连接。下面是对上面代码使用netcat的改编：

```
$pid = fork();
if(!$pid)
{
  exec("ssh $host -f 'tail -f $filename |nc $localhost $port'");
  exit;
}

exec("nc -l -p $port"); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-19T16:33:48.730

有[File::Tail](http://search.cpan.org/dist/File-Tail/Tail.pm)。不知道有没有帮助？

# php - 自动邮件列表 - PHP

> ID：566119
> 
> 赞同：2
> 
> 时间：2009-02-19T16:32:48.273
> 
> 标签：php, email

我在我的网站上有一个应用程序，人们可以注册接收时事通讯，然后付费组中的某个人可以立即写信并发送给所有注册的人...

...这意味着我需要一种有效的方法来遍历我的订阅者数据库并使用 php 向他们邮寄电子邮件的副本。

显然，有 mail() 函数……我可以把它放在一个循环中……有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T16:33:55.987

PEAR 的[邮件队列](http://pear.php.net/package/Mail_Queue)？

> Mail_Queue 类将邮件放在一个临时容器中，等待送入 MTA（邮件传输代理），稍后通过 crontab 或其他方式发送它们（例如每隔几分钟发送一定数量的邮件）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T16:38:09.360

您可以使用 BCC 标头选项并发送一封电子邮件，其中包含所有订阅者的 Blind Carbon Copy 列表。因此，在循环中构建密件抄送字符串并使用 mail() 发送一封电子邮件

PHP手册中的片段......

```
// To send HTML mail, the Content-type header must be set
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Additional headers
$headers .= 'To: Mary <mary@example.com>, Kelly <kelly@example.com>' . "\r\n";
$headers .= 'From: Birthday Reminder <birthday@example.com>' . "\r\n";
$headers .= 'Cc: birthdayarchive@example.com' . "\r\n";
$headers .= 'Bcc: birthdaycheck@example.com' . "\r\n";

// Mail it
mail($to, $subject, $message, $headers); 
```

将“密件抄送：生日检查@example.com”替换为 $mySubscribersList

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T16:36:25.623

我建议找到一种循环方式，并记住你已经邮寄给谁，因为如果它变成一个大名单，你的脚本可能会结束，你必须重新加载它。

我曾经使用 AJAX 做过一次，这给了我一个很好的方法来跟踪我在发送过程中的位置。计算要邮寄的人数，将 id 放入数组中，有 javascript 循环并单独调用 php-mail-page ...

-edit- 您可以在 php 中有一个脚本，带有一个简单的 while 循环，但是您应该在数据库中添加一个检查，以查看邮件是否已经发送给一个人。如果脚本超出内存使用，只需重新加载页面，它只会发送给尚未收到的那些......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T16:55:05.657

按照@paulbm 的回答，为什么不在您的服务器上创建一个指向所有当前电子邮件地址的别名呢？一个简短的 procmail 脚本可以阻止除一个授权发件人以外的任何人使用别名。

这将使邮寄变得容易，并且使用新/更改的电子邮件地址重建列表也非常简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T16:34:38.470

如果您需要功能齐全的时事通讯和邮件列表管理器，请尝试使用 phplist（[主页）](http://www.phplist.org)

# c# - ASP.Net 将文档转换和合并为单个 PDF

> ID：566127
> 
> 赞同：3
> 
> 时间：2009-02-19T16:33:56.780
> 
> 标签：c#, asp.net, pdf, pdf-generation

我需要能够将各种文档转换并合并为一个 Pdf。

文档可以是不同的类型，例如 Word、Open Office、图像、文本、网页（通过 URL），而 PDF 通常由 2-3 个文档组成。

目前，我们正在使用 BCL Technologies easyPDF 和安装在服务器上的 Microsoft Office。这可以处理大多数文档，但我们还没有使用它来处理 Open Office 文档。

我们目前每天生产大约 100-1000 个这些 PDF。

我问这个问题的原因是性能是一个关键问题。PDF 是为用户即时生成的，因此我们目前获得的 30-60 秒的等待时间变得不可接受。

我们在最初上传文档时对文档进行了一些缓存，因此当用户请求 Pdf 时发生的主要任务是合并许多已经生成的 Pdf。

是否有其他人使用过任何其他工具，可以可靠地处理大多数常见的文档类型，最重要的是，速度很快？这么一说，我好像问了很多！

编辑：感谢所有伟大的建议，我会研究其中的一些并比较性能。

再加上这一切，钱并不是真正的对象。我们非常乐意为执行每项任务的不同应用程序付费，并研究各种硬件选项以尽可能多地分配负载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T17:38:39.700

合并多个 PDF 文档通常很简单（只要它们不需要在同一页面上合并） - 您可以将合并性能与 iTextSharp（iText 的 .NET 版本）之类的东西进行比较，以确保它不是瓶颈 - 否则从其他格式到 PDF 的转换可能是瓶颈。

在几乎所有情况下，用于将*X*转换为 PDF 的方法是针对软件 PDF 打印机执行应用程序打印命令，以创建临时 PDF 文件。

这表示：

*   打开和关闭目标应用程序（例如 Office）
*   文件必须通过打印服务

在您的情况下，您是在转换用户提交的任意文档，还是这些文档来自存储的文件库？如果它是库，您可以在将每个文件添加到库时（而不是在用户提出请求时）制作每个文件的 PDF 副本，然后仅合并 PDF 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T16:36:55.860

我们使用 ABC Pdf。我不知道它是否足以满足您的需求，但它似乎适合我们的使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T17:00:13.783

我有一个非常相似的问题，我们的文档已经以 PDF 格式存在，需要让用户看到它们全部组合在一起。我们购买了 PDF4NET 产品，我记得大约是 500 美元。它非常易于使用，并且提供了如何使用这些工具的精彩示例。

[O2 解决方案 - PDF4NET](http://www.o2sol.com/pdf4net/products.htm)

这是他们为合并提供的代码示例。第一行看起来只是输出文件，后两行允许将内容流式传输回用户。

```
 PDFFile.MergeFilesToDisk( "append.pdf", "unicode.pdf", "multicolumntextandimages.pdf" );
        PDFDocument doc =  PDFFile.MergeFilesToDoc( "append.pdf", "unicode.pdf", "multicolumntextandimages.pdf" );
        doc.SaveToStream( stream ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-19T21:28:57.887

您说您正在使用 Microsoft Office 打开这些文件，我想这是瓶颈，而不是实际的 PDF 创建。

是否可以将这些文档提炼成更易于访问的格式（html/xml/database），这样就不必每次需要创建 PDF 时都打开办公室？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-19T16:48:58.773

虽然我没有 PDF 转换建议，但我可以说这个问题听起来像是一个可以分布在多个节点上的问题。您是否发现 PDF 生成受 CPU 限制或是否存在其他限制因素？在花费太多精力重写 PDF 库界面之前，您可能想看看瓶颈是什么。

# asp.net - 在 ASP.NET 1.1 中使用 SSRS

> ID：566133
> 
> 赞同：2
> 
> 时间：2009-02-19T16:35:57.680
> 
> 标签：asp.net, reporting-services, asp.net-1.1

是否可以将 SSRS 用于 ASP.NET 1.1 应用程序中的报告？ASP.NET 1.1 是否有报表查看器控件？如果没有，是否有任何解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T16:42:18.630

解决此问题的一种方法是使用 Reporting Services 提供的查询字符串命令，并以 PDF 格式（或以任何其他可交付格式向最终用户提供）报告。

Reporting Services 本身需要 .NET 2.0 才能自行运行，因此没有实际的控制器可以在只有 .NET 1.1 的网站上实时显示报告

编辑：这是有关 URL 访问的 MSDN 信息。

[http://msdn.microsoft.com/en-us/library/ms153586.aspx](http://msdn.microsoft.com/en-us/library/ms153586.aspx)

[http://msdn.microsoft.com/en-us/library/ms153563.aspx](http://msdn.microsoft.com/en-us/library/ms153563.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T16:54:24.267

我使用过报表查看器控件，但大多数时候都没有发现它很有用。根据您要完成的任务，您可以通过 URL 直接访问报告。您甚至可以通过将参数传递给报告来做到这一点。

**例如...**
[http://reports.mycompany.com/reportserver?%2fMyCompany%2fProject+Folder%2fReportName&EndDate=2/21/2009&BeginDate=2/15/2009&rs%3aParameterLanguage=en-US&rc:parameters=true](http://reports.mycompany.com/reportserver?%2fMyCompany%2fProject+Folder%2fReportName&EndDate=2/21/2009&BeginDate=2/15/2009&rs%3aParameterLanguage=en-US&rc:parameters=true)

另一个可用选项是使用作为报告服务一部分的 Web 服务。然后，您可以以不同的格式（PDF、word、Excel...）呈现报告的字节并将其输出给用户以供下载。如果这是您正在查看的路线，我可以为您提供有关 Web 服务的更多信息...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T18:49:41.223

您可以从 asp.net 1.1 通过 Web 服务接口访问报表服务器。将 Web 引用添加到您的项目，然后调用报表服务器公开的各种 Web 方法，以其中一种可用格式呈现您的报表。例如，如果您以 HTML 格式呈现报表，您可以将 HTML 注入到 Literal 控件中以显示在您的网页上。在选择参数值、分页和导出方面，您没有获得报表查看器界面的优势，但应该可以创建一个模仿这些功能的页面。

# actionscript-3 - 如何将由运行时参数命名的属性添加到 actionscript 对象？

> ID：566137
> 
> 赞同：0
> 
> 时间：2009-02-19T16:37:16.173
> 
> 标签：actionscript-3, actionscript

我需要一个函数来获取两个相同长度的数组参数：属性名称（字符串）和属性值。

该函数应该创建一个具有属性的对象，例如，在调用之后

```
var obj:Object = makeObject({"prop1","prop2"},{1,2}); 
```

测试条件`(obj.prop1 == 1 && obj.prop2 == 2)`应该为真。

我被引导相信，如果你知道你的动作脚本，这应该很容易——也许这只是一个语法问题。

 **重新阅读我的问题后**添加的后期，看来这不是很容易理解。**
我的问题是根据运行时值命名属性，即使用字符串参数来引用属性名称。**

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T19:19:09.363

不确定我是否理解您的问题，但您可以使用 Object 文字创建 Object：

```
var item:Object = {prop1: 1, prop2: 2};

trace (item.prop1 == 1 && item.prop2 == 2) // true 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T21:33:49.937

An`Object`可以被视为带有键的字符串的映射（或关联数组） - 我相信这就是您想要做的。[您可以在Adob​​e 的文档](http://livedocs.adobe.com/flex/3/html/help.html?content=10_Lists_of_data_4.html)中阅读 Flex 中的关联数组。

```
private function makeObject( keys : Array, values : Array ) : Object
{
    var obj : Object = new Object();

    for( var i : int = 0; i < keys.length; ++i )
    {
        obj[ String(keys[i]) ] = values[i];
    }

    return obj;
} 
```

这将创建一个新`Object`的，其键等于第一个数组中的值，值等于第二个数组中的项。

# c# - 在 C# 中检测网络连接速度和带宽使用情况

> ID：566139
> 
> 赞同：43
> 
> 时间：2009-02-19T16:37:36.300
> 
> 标签：c#, networking, performance, bandwidth, detect

有没有办法检测 C# 中的网络速度和带宽使用情况？甚至欢迎指向开源组件的指针。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-19T16:54:17.013

尝试使用 System.Net.NetworkInformation 类。特别是，[`System.Net.NetworkInformation.IPv4InterfaceStatistics`](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ipv4interfacestatistics.aspx)应该有一些你正在寻找的信息。

具体来说，您可以检查该`bytesReceived`属性，等待给定的时间间隔，然后`bytesReceived`再次检查该属性以了解您的连接正在处理多少字节/秒。但是，要获得一个好的数字，您应该尝试从给定来源下载大量信息，然后检查；这样，您应该在进行测试时“最大化”连接，这应该会提供更多有用的数字。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-19T16:57:13.400

您应该能够从[IPGlobalStatistics](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ipglobalstatistics.aspx)类中计算出您需要的所有内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-07-19T16:13:20.147

如果只关心协商的速度，可以看一下 NetworkInterface.Speed 属性

[MSDN NetworkInterface.Speed](https://docs.microsoft.com/en-us/dotnet/api/system.net.networkinformation.networkinterface.speed?view=net-5.0)

# vb.net - *微妙* VB 函数和 Convert.To* 函数之间的区别？

> ID：566147
> 
> 赞同：10
> 
> 时间：2009-02-19T16:40:07.167
> 
> 标签：vb.net, function, type-conversion

在转换类型时，我发现自己同时使用了 VB 函数和 BCL Convert.To* 方法。
例如）

*   `Cstr()`对比`Convert.ToString()`
*   `CInt()`对比`Convert.ToInt32()`
*   `CDbl()`对比`Convert.ToInt64()`
*   ETC...

是否有任何**细微的**差异需要注意？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-19T16:46:30.810

[这在原则上之前](https://stackoverflow.com/questions/423820/integer-parse-vs-cint)已经介绍过，但是是有区别的：基本上 VB 助手会为你做额外的工作，让你通过泛型抛出异常的地方进行解析，一般但不是普遍的 VB 助手更快（尽管我不知道这是否显着）因为它们真的只是 IL 糖。调味。

* * *

编辑：[这家伙](http://www.panopticoncentral.net/archive/2004/06/07/1200.aspx)比我做得更好。

编辑 Redux：Joel Coehoorn 还推荐了[上述文章的前身](http://www.panopticoncentral.net/archive/2004/05/31/1100.aspx)，并且显然在某处有一些基准测试。

乔尔写道：

> 总结是 CInt() 是一个运算符，而 Convert.ToInt32() 是一个函数。CInt 介于 (int)x 之间；和 Convert.ToInt32(x);。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-17T15:45:07.277

我刚刚发现了另一个很大的不同，我认为这里值得一提——尽管是在 OP 之后几年！`CInt({Boolean expression})`当 时计算为 -1 `True`，而`Convert.ToInt<n>`计算为 1。

这可以抓住任何在数学评估中使用前者的人，例如：

```
For i As Integer = 0 To 1 - CInt(processThirdItem) 'Evaluates to -1 (1 - -1 = 2)
    'Do stuff...
Next 
```

因此，除非您将运算符从更改为 ，否则使用代替`Convert.ToInt32`将`CInt`不起作用。`-``+`

当然，.NET 的短路`If`功能现在提供了一种更好的方法来做到这一点：

```
For i As Integer = 0 to If(processThirdItem, 2, 1)
    'Do stuff...
Next 
```

# lotus-notes - 如何在 GetAllEntriesByKey 中使用数组中的日期？

> ID：566151
> 
> 赞同：0
> 
> 时间：2009-02-19T16:42:14.370
> 
> 标签：lotus-notes, lotus-domino, lotus, lotusscript

我试图通过传递一个数组来使用 GetAllEntriesByKey 中的当前日期。到目前为止的数组看起来像这样

```
Dim keyarray(2) As Variant  
keyarray(0) = "FF Thompson ADT"  
Set keyarray(1) = dateTime 
```

我想说这个

```
Set vc = view.GetAllEntriesByKey(keyarray, False) 
```

这是它工作时的样子。测试代理在电子邮件中打印出 csv。

FF 汤普森 ADT,2/3/2009,11:45:02 PM,0,6,0,,00:00:04,5400,4

我似乎无法通过当前运行的日期时间。我可以在声明中手动设置 dateTime 并且它可以工作。我认为这是因为它也试图打发时间，但我不知道。我尝试了三种方法，它说无效的键值类型。

```
Dim dateTime As New NotesDateTime("")
Call dateTime.LSLocalTime = Now
...
keyarray(1) = dateTime.Dateonly

Dim dateTime As New NotesDateTime("")
Call dateTime.SetNow
...
keyarray(1) = dateTime.Dateonly

Dim dateTime As New NotesDateTime("Today")
...
keyarray(1) = dateTime.Dateonly 
```

我不知道这是否有用，但我[在这里](http://www.ibm.com/developerworks/lotus/library/ls-The_Evaluate_statement/index.html)读到了 Evaluate 。

我最终要做的是 GetFirstEntry 用于“FF Thompson ADT”，因为最近一天的条目存在。我也在尝试在前一天做同样的事情。我正在尝试使用类似这样的方法总结最近一天处理的文件（数字 6）和最近一天的错误（null）。我需要对其进行调整，以便找到已处理的文件和条目错误，但我还没有到达那里，但应该能够做到。我也只是想找到提要的时间值的最新日期，即“FF Thompson ADT”。

```
Set entry = vc.GetFirstEntry
filesprocessed = 0
Dim errors, errortotal As Integer
errors = 0
errorstotal = 0
While Not entry Is Nothing
  rowval = 0
  errors = 0
  Forall colval In entry.ColumnValues
    If rowval > 0 Then
      errors = Cint(colval)
    Else
      rowval = Cint(colval)
    End If
  End Forall
  filesprocessed = filesprocessed + rowval
  errorstotal = errorstotal + errors
  Set entry = vc.GetNextEntry(entry)
Wend 
```

感谢您的任何帮助或建议。他们非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:05:17.727

我只对字符串数组使用了 GetAllEntriesByKey 方法。我从未尝试过混合类型。但是假设不同的类型对该方法有效，问题可能在于 Notes 中日期时间类型之间的差异。有一个核心 LS 日期时间类型，然后有一个 NotesDateTime 对象。我敢打赌，视图认为日期列由核心日期时间类型组成，因此当您传递 NotesDateTime 类型时它会失败。

但除了这个问题，我的建议是创建一个包含您要访问的列的视图，并将第一列（包含 FF Thompson ADT）的排序顺序设置为 asc，然后将带有日期的第二列设置为 desc。然后，您可以按您想要的顺序访问视图条目，最近的是第一个，最近的第二个是第二个，等等。

如果 GetAllEntriesByKey 方法偶然返回了无序的文档（我忘记了它是否保证顺序），我知道我在使用 NotesViewNavigator 类之前已经完成了这个。肯定有另一种方法可以做到这一点，而无需使用日期键调用 GetAllEntriesByKey。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T09:35:06.163

这是我找到的答案

```
Dim todaysdate As New NotesDateTime("Today")
Dim dateTime As New NotesDateTime(todaysdate.DateOnly)

Dim keyarray(1) As Variant keyarray(0) = feedname
Set keyarray(1) = dateTime 

Set vc = view.GetAllEntriesByKey(keyarray, False) 
```

# ruby - Ruby win32ole - 如何传递 VARIANT 参数？

> ID：566153
> 
> 赞同：2
> 
> 时间：2009-02-19T16:42:21.873
> 
> 标签：ruby, windows, automation, scheduled-tasks, win32ole

我正在尝试使用 Ruby 自动化 Windows 任务计划程序。

我在 Windows Vista 下使用 Ruby 1.8。

TaskFolder 对象的 RegisterTaskDefintion 方法采用两个 VARIANT 参数作为用户名和密码。任何将字符串传递给这些参数的尝试都会导致“method_missing”异常：

这不起作用：

```
rootFolder.RegisterTaskDefinition("Task", newTask, TASK_CREATE_OR_UPDATE, 'user', 'password', TASK_LOGON_PASSWORD,  nil) 
```

这有效：

```
rootFolder.RegisterTaskDefinition("Task", newTask, TASK_CREATE_OR_UPDATE, '', '', TASK_LOGON_NONE,  nil) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T16:50:20.697

只需创建一个 VARIANT？

```
WIN32OLE_VARIANT.new("Blah", VT_BSTR) 
```

# hardware - 容错（辐射）软核？

> ID：566158
> 
> 赞同：6
> 
> 时间：2009-02-19T16:43:13.220
> 
> 标签：hardware, fpga, fault-tolerance

是否有证书或某些权威机构可以决定软核是否具有容错性？

另一个问题。我已经看到 LEON3-FT 只有在 RTAX Actel FPGA 上实现时才具有辐射耐受性。是对的吗？

对不起，但我对此感到困惑，因为有人谈到空间应用的 LEON3-FT（容错），在哪里说耐辐射更正确？

而且，最后一个问题......是否有人知道另一个软核“耐辐射”（用于太空应用）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T14:43:48.440

Actel 不是容错的。它首先是抗辐射的。这是因为它的设计方式。

Xilinx 有一些关于辐射[链接文本](http://www.xilinx.com/esp/aero_def/radiation_effects.htm)的文档。

我做过卫星 FPGA 工作，不知道有任何认证机构。对一般问题的一些讨论在[链接文本](http://klabs.org/richcontent/fpga_content/pages/rad_data/xilinx_rad.htm)中。

容错设计将是一个开始。然而，由于在基于 SRAM 的设计（Xilinx、Altera、Lattice）中配置存储器可能会损坏，因此您也必须担心这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T19:33:10.257

[这可能很有用](http://alicedcs.web.cern.ch/alicedcs/ElectrCoord/RadTol-Aug04/RCU%20DCS%20and%20PHOS.pdf)。还有一个[演示文稿](http://hmuller.home.cern.ch/hmuller/documents/PHOS/subsite/talks/Dieter_alice_fee_wuhan_05_radiation.ppt)，总结了结果。这些是为 CERN 进行的测试。他们需要耐辐射的 ASIC 并测试了一些 FPGA。我认为他们并不专注于认证，他们只是测试他们可以多快重新配置有故障的 FPGA。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T11:43:43.537

当你说容错时，这意味着如果由于辐射离子撞击而发生故障，处理器将有能力纠正它的位。这是由于处理器架构的设计方式造成的。

这种容错 IP 可以与基于空间级 SRAM 的设备一起使用，并且性能仍然令人满意，但我认为由于 SRAM FPGA 特性必须进行故障校正，它会减慢处理器的速度。而如果您将上述 IP 与抗辐射 FPGA 一起使用，则软错误会少得多。

Radiation Hardened 和 Tolerant 之间的区别： Hardened 是没有误差达到一定的 rad 水平，而 Tolerant 会对一定量的辐射造成一定的误差

Actel 可以提供数据 upton 请求，但如果您在美国，则提供。ITAR 限制适用于所有太空级设备和

供应商可能会要求您披露有关您自己的信息，然后才能收到有关抗辐射/硬化设备的回复。

CERN 已使用 Actel 器件（FUSION 系列）来纠正 Xilinx 器件的配置。

# c# - 如何制作俄罗斯方块克隆？

> ID：566159
> 
> 赞同：14
> 
> 时间：2009-02-19T16:43:14.747
> 
> 标签：c#, data-structures, software-design

我正在编写 XNA C# 中的俄罗斯方块克隆，我不确定在高层次上处理游戏数据结构方面的最佳方法。

我对碰撞检测、旋转、动画等非常满意。我需要知道存储“掉落块”的最佳方法——即不再受玩家控制的块。

我认为每个 Tetromino 块都应该存储在它自己的类中，该类由一个 4x4 数组组成，以便块可以轻松旋转。然后问题是我如何将 tetromino 的最终位置存储到游戏网格中，然后将 tetromino 切割成单独的块（对于每个单元格），然后设置主游戏网格的相应位置来保存这些相同的块，然后消失一次 tetromino它已到达最终位置。也许我的方法有一些缺点。

我应该为可以存储的主游戏网格创建一个 10x20 矩阵吗？或者我应该使用堆栈或队列以某种方式存储丢弃的块。或者也许有一些更好的方法/数据结构来存储东西？

我确信我的方法会奏效，但我正在伸出手来看看是否有人知道更好的方法，或者我的方法是否足够好？

PS 不是作业，这将是我的作品集的一个项目。谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-19T16:51:15.070

一旦一个块是不动的，就没有什么可以将它与任何其他现在不动的块区分开来了。在这方面，我认为将整个网格存储为矩阵是最有意义的，其中每个正方形要么被填充，要么被填充（如果是块的颜色，则连同块的颜色一起）。

我觉得矩阵有很多优点。它将使碰撞检测变得简单（无需与多个对象进行比较，只需与矩阵上的位置进行比较）。将其存储为矩阵还可以更容易地确定何时创建了整行。最重要的是，当一条线消失时，您不必担心拼接不动的 Tetromino。当你这样做时，你可以一举将整个矩阵向下移动。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T16:50:47.657

这听起来像家庭作业，但我对俄罗斯方块的面向对象方法的看法是让每个单独的正方形都是一个对象，并且“块”（tetrominos）和网格本身都是相同正方形对象的集合。

块对象管理下落方块的旋转和位置，网格处理显示它们和销毁已完成的行。每个块都将具有与之关联的颜色或纹理，这些颜色或纹理将由它来自的原始块对象提供，但网格底部的方块将没有其他指示它们曾经是同一原始块的一部分。

详细地说，当您创建一个新的块对象时，它会在网格上创建一组具有相同颜色/纹理的 4 个正方形。网格管理它们的显示。所以当方块触到底部时，你就忘记了方块，方块仍然被网格引用。

旋转和放下是只有一个块需要处理的操作，并且只有一个它的四个正方形（尽管它需要能够查询网格以确保旋转可以适合）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T17:17:27.380

在我看来，实际上不让块看起来像自主块是许多俄罗斯方块克隆的一大失败。我特别努力确保[我的克隆](http://kentb.blogspot.com/2008/12/kentis.html)总是看起来正确，无论该块仍然“在游戏中”还是被丢弃。这意味着稍微超越简单的矩阵数据结构，并提出支持块部分之间“连接”概念的东西。

我有一个名为的类`BlockGrid`，它用作 a`Block`和`Board`. `BlockGrid`有一个抽象（C++ 中的纯虚拟）方法，称为`AreBlockPartsSameBlock`子类必须重写以确定两个不同的块部分是否属于同一个块。对于 中的实现，如果两个位置都有块部分`Block`，它会简单地返回。`true`对于 中的实现，如果两个位置包含相同的`Board`，则返回。`true``Block`

该类`BlockGrid`使用这些信息来“填充”渲染块中的​​细节，使它们看起来像块。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-19T16:53:57.883

使用数组将是处理俄罗斯方块的最简单方法。您在屏幕上看到的内容与内存中使用的结构之间存在直接关联。使用堆栈/队列将是一种过度杀伤和不必要的复杂。

您可以拥有 2 个下落块的副本。一个用于展示（Alpha），另一个用于移动（Beta）。

您将需要一个类似的结构

```
 class FallingBlock
{
  int pos_grid_x;
  int pos_grid_y;
  int blocks_alpha[4][4];
  int blocks_beta[4][4];

  function movedDown();
  function rotate(int direction();
  function checkCollision();
  function revertToAlpha();
  function copyToBeta()
}; 

```

_beta 数组将被移动或旋转，并针对电路板进行碰撞检查。如果有冲突，将其恢复为 _alpha，如果没有，则将 _beta 复制到 _alpha。

如果在movedDown() 上发生碰撞，方块的生命就结束了，_alpha 网格将不得不复制到游戏板上并删除 FallingBlock 对象。

董事会当然必须是另一种结构，例如：

```
 class Board
{
  int gameBoard[10][20];

  //some functions go here
} 

```

我用 int 来表示一个块，每个值（如 1、2、3）表示不同的纹理或颜色（0 表示一个空点）。

一旦块成为游戏板的一部分，它只需要显示纹理/颜色标识符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-19T17:11:19.940

实际上我几天前才这样做，除了在 WPF 而不是 XNA 中。这是我所做的：

编辑：似乎我对“阻止”的定义与其他人不同。我定义的块是构成 Tetromino 的 4 个单元之一，而实际的 Tetromino 本身就是一块。

将块作为具有 X、Y 坐标和颜色的结构。（后来我加了一个 bool IsSet 来表示它是在一个浮动块中还是在实际板上，但这只是因为我想在视觉上区分它们）

作为 Block 上的方法，我有 Left、Right、Down 和 Rotate(Block center)，它们返回一个新的移位块。这使我可以在不知道该块的形状或方向的情况下旋转或移动任何块。

我有一个通用的 Piece 对象，它包含它包含的所有块的列表以及作为中心的块的索引，它用作旋转中心。

然后我做了一个 PieceFactory 可以生产所有不同的碎片，并且不需要知道它是什么类型的碎片，我可以（并且确实）轻松添加由多于或少于 4 个块组成的碎片的变体，而无需创建任何新类

板由一个字典组成，它是当前板上的所有块，以及可配置的板的尺寸。您也可以使用矩阵，但使用字典我只需要遍历没有空格的块。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T10:16:58.527

我的解决方案（设计），用 Python 中的示例作为伪代码的良好替代品。

使用 20 x 10 的网格，四联骨牌会掉下来。

Tetromino 由具有坐标 (x,y) 和颜色属性的块组成。

所以，例如，T形四肢骨看起来像这样......

```
 . 4 5 6 7 8 .
  .
  19     # # #
  20       #
  . 
```

因此，T 形是坐标为 (5,19)、(6,19)、(7,19)、(6,20) 的块的集合。

移动形状只需对组中的所有坐标应用简单的变换即可。例如，要向下移动形状，将 (0,1)、左 (-1,0) 或右 (1,0) 添加到集合中构成形状的所有坐标中。

这也让您可以使用一些简单的三角函数将形状旋转 90 度。规则是，当相对于原点旋转 90 度时，(x,y) 等于 (-y,x)。

这是一个解释它的例子。从上方取T形，以（6,19）为中心块旋转。为简单起见，将其设为集合中的第一个坐标，因此...

```
 t_shape = [ [6,19], [5,19], [7,19], [6,20] ] 
```

然后，这是一个将坐标集合旋转 90 度的简单函数

```
def rotate( shape ):
    X=0      # for selecting the X and Y coords
    Y=1

    # get the middle block
    middle = shape[0]   

    # work out the coordinates of the other blocks relative to the
    # middle block
    rel = []
    for coords in shape:
        rel.append( [ coords[X]-middle[X], coords[Y]-middle[Y] ] )

    # now rotate 90-degrees; x,y = -y, x
    new_shape = []
    for coords in rel:
        new_shape.append( [ middle[X]-coords[Y], middle[Y]+coords[X] ] )

    return new_shape 
```

现在，如果您将此函数应用于我们的 T 形坐标集合...

```
 new_t_shape = rotate( t_shape )

    new_t_shape
    [[6, 19], [6, 18], [6, 20], [5, 19]] 
```

在坐标系中绘制它，它看起来像这样......

```
 . 4 5 6 7 8 .
  .
  18       #
  19     # #
  20       #
  . 
```

这对我来说是最难的一点，希望这对某人有所帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-19T16:49:31.973

请记住，以前的混淆 C 代码竞赛的获胜者用不到 512 字节的混淆 C 实现了一个非常好的俄罗斯方块游戏（适用于 BSD unix 上的 VT100 终端）：

```
long h[4];t(){h[3]-=h[3]/3000;setitimer(0,h,0);}c,d,l,v[]={(int)t,0,2},w,s,I,K
=0,i=276,j,k,q[276],Q[276],*n=q,*m,x=17,f[]={7,-13,-12,1,8,-11,-12,-1,9,-1,1,
12,3,-13,-12,-1,12,-1,11,1,15,-1,13,1,18,-1,1,2,0,-12,-1,11,1,-12,1,13,10,-12,
1,12,11,-12,-1,1,2,-12,-1,12,13,-12,12,13,14,-11,-1,1,4,-13,-12,12,16,-11,-12,
12,17,-13,1,-1,5,-12,12,11,6,-12,12,24};u(){for(i=11;++i<264;)if((k=q[i])-Q[i]
){Q[i]=k;if(i-++I||i%12<1)printf("\033[%d;%dH",(I=i)/12,i%12*2+28);printf(
"\033[%dm  "+(K-k?0:5),k);K=k;}Q[263]=c=getchar();}G(b){for(i=4;i--;)if(q[i?b+
n[i]:b])return 0;return 1;}g(b){for(i=4;i--;q[i?x+n[i]:x]=b);}main(C,V,a)char*
*V,*a;{h[3]=1000000/(l=C>1?atoi(V[1]):2);for(a=C>2?V[2]:"jkl pq";i;i--)*n++=i<
25||i%12<2?7:0;srand(getpid());system("stty cbreak -echo stop u");sigvec(14,v,
0);t();puts("\033[H\033[J");for(n=f+rand()%7*4;;g(7),u(),g(0)){if(c<0){if(G(x+
12))x+=12;else{g(7);++w;for(j=0;j<252;j=12*(j/12+1))for(;q[++j];)if(j%12==10){
for(;j%12;q[j--]=0);u();for(;--j;q[j+12]=q[j]);u();}n=f+rand()%7*4;G(x=17)||(c
=a[5]);}}if(c==*a)G(--x)||++x;if(c==a[1])n=f+4**(m=n),G(x)||(n=m);if(c==a[2])G
(++x)||--x;if(c==a[3])for(;G(x+12);++w)x+=12;if(c==a[4]||c==a[5]){s=sigblock(
8192);printf("\033[H\033[J\033[0m%d\n",w);if(c==a[5])break;for(j=264;j--;Q[j]=
0);while(getchar()-a[4]);puts("\033[H\033[J\033[7m");sigsetmask(s);}}d=popen(
"stty -cbreak echo stop \023;cat - HI|sort -rn|head -20>/tmp/$$;mv /tmp/$$ HI\
;cat HI","w");fprintf(d,"%4d on level %1d by %s\n",w,l,getlogin());pclose(d);} 
```

[http://www.ioccc.org/1989/tromp.hint](http://www.ioccc.org/1989/tromp.hint)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-19T16:51:25.037

我绝不是俄罗斯方块专家，但正如你所描述的，10x20 矩阵对我来说似乎是一个自然的选择。

当需要检查您是否完成了一条线并处理它时，它将变得非常容易。只需遍历 2d 数组，查看每个位置的布尔值，看看它们是否加起来为 10 个块位置。

但是，如果有一条完整的线路，您将需要进行一些手动清理。不得不把一切都放下。尽管归根结底，这并不是什么大不了的事。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-12T17:40:08.377

使用 Simon Peverett 逻辑，这是我在 c# 中得到的结果

```
public class Tetromino 
{
    // Block is composed of a Point called Position and the color
    public Block[] Blocks { get; protected internal set; }

    // Constructors, etc.

    // Rotate the tetromino by 90 degrees, clock-wise
    public void Rotate() 
    {
        Point middle = Blocks[0].Position;
        List<Point> rel = new List<Point>();
        foreach (Block b in Blocks)
            rel.Add(new Point(b.Position.x - middle.x, b.Position.y - middle.y));

        List<Block> shape = new List<Block>();
        foreach (Point p in rel)
            shape.Add(new Block(middle.x - p.y, middle.y + p.x));

        Blocks = shape.ToArray();
    }

    public void Translate(Point p)
    {
        // Block Translation: Position+= p; 
        foreach (Block b in Blocks)
            b.Translate(p);
    }
} 
```

**注意：**使用 XNA，`Point`结构可以交换为`Vector2D`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-10-20T21:10:13.453

在我的示例（Java）中 - 所有数字都有块列表 - 可以在需要时删除。同样在我的 Board 类中，我有一个数字列表和一个由用户控制的字段变量数字。当图形“着陆”时 - 它进入其他图形列表，并且用户可以控制新图形。这里有一个更好的解释：http: [//bordiani.wordpress.com/2014/10/20/tetris-in-java-part-i-overview/](http://bordiani.wordpress.com/2014/10/20/tetris-in-java-part-i-overview/)

# c# - 在 XDocument 中按名称查询任意深度的元素

> ID：566167
> 
> 赞同：151
> 
> 时间：2009-02-19T16:46:09.157
> 
> 标签：c#, .net, xml, linq, linq-to-xml

我有一个`XDocument`对象。我想使用 LINQ 在任何深度查询具有特定名称的元素。

当我使用 时`Descendants("element_name")`，我只得到当前级别的直接子元素。我正在 XPath 中寻找与“//element_name”等效的东西……我应该只使用`XPath`，还是有办法使用 LINQ 方法来实现？

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2009-02-19T16:48:20.160

后代应该工作得很好。这是一个例子：

```
using System;
using System.Xml.Linq;

class Test
{
    static void Main()
    {
        string xml = @"
<root>
  <child id='1'/>
  <child id='2'>
    <grandchild id='3' />
    <grandchild id='4' />
  </child>
</root>";
        XDocument doc = XDocument.Parse(xml);

        foreach (XElement element in doc.Descendants("grandchild"))
        {
            Console.WriteLine(element);
        }
    }
} 
```

结果：

> `<grandchild id="3" />`
> `<grandchild id="4" />`

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-06-23T15:07:19.523

指示命名空间的示例：

```
String TheDocumentContent =
@"
<TheNamespace:root xmlns:TheNamespace = 'http://www.w3.org/2001/XMLSchema' >
   <TheNamespace:GrandParent>
      <TheNamespace:Parent>
         <TheNamespace:Child theName = 'Fred'  />
         <TheNamespace:Child theName = 'Gabi'  />
         <TheNamespace:Child theName = 'George'/>
         <TheNamespace:Child theName = 'Grace' />
         <TheNamespace:Child theName = 'Sam'   />
      </TheNamespace:Parent>
   </TheNamespace:GrandParent>
</TheNamespace:root>
";

XDocument TheDocument = XDocument.Parse( TheDocumentContent );

//Example 1:
var TheElements1 =
from
    AnyElement
in
    TheDocument.Descendants( "{http://www.w3.org/2001/XMLSchema}Child" )
select
    AnyElement;

ResultsTxt.AppendText( TheElements1.Count().ToString() );

//Example 2:
var TheElements2 =
from
    AnyElement
in
    TheDocument.Descendants( "{http://www.w3.org/2001/XMLSchema}Child" )
where
    AnyElement.Attribute( "theName" ).Value.StartsWith( "G" )
select
    AnyElement;

foreach ( XElement CurrentElement in TheElements2 )
{
    ResultsTxt.AppendText( "\r\n" + CurrentElement.Attribute( "theName" ).Value );
} 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2013-01-21T12:14:51.627

你可以这样做：

```
xml.Descendants().Where(p => p.Name.LocalName == "Name of the node to find") 
```

哪里`xml`是`XDocument`。

请注意，该属性`Name`返回一个具有 a`LocalName`和 a的对象`Namespace`。这就是为什么`Name.LocalName`如果你想按名称比较，你必须使用。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-02-19T16:52:40.207

后代将完全满足您的需要，但请确保您已将命名空间名称与元素名称一起包含在内。如果省略它，您可能会得到一个空列表。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2012-05-03T11:27:11.073

有两种方法可以做到这一点，

1.  [LINQ 转 XML](https://en.wikipedia.org/wiki/Language_Integrated_Query#LINQ_to_XML_.28formerly_called_XLINQ.29)
2.  XPath

以下是使用这些方法的示例，

```
List<XElement> result = doc.Root.Element("emails").Elements("emailAddress").ToList(); 
```

如果使用 XPath，则需要对 IEnumerable 进行一些操作：

```
IEnumerable<XElement> mails = ((IEnumerable)doc.XPathEvaluate("/emails/emailAddress")).Cast<XElement>(); 
```

注意

```
var res = doc.XPathEvaluate("/emails/emailAddress"); 
```

结果要么是空指针，要么没有结果。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-02-08T14:52:00.703

我正在使用`XPathSelectElements`与方法相同的扩展`XmlDocument.SelectNodes`方法：

```
using System;
using System.Xml.Linq;
using System.Xml.XPath; // for XPathSelectElements

namespace testconsoleApp
{
    class Program
    {
        static void Main(string[] args)
        {
            XDocument xdoc = XDocument.Parse(
                @"<root>
                    <child>
                        <name>john</name>
                    </child>
                    <child>
                        <name>fred</name>
                    </child>
                    <child>
                        <name>mark</name>
                    </child>
                 </root>");

            foreach (var childElem in xdoc.XPathSelectElements("//child"))
            {
                string childName = childElem.Element("name").Value;
                Console.WriteLine(childName);
            }
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-02-10T12:11:10.800

在@Francisco Goldenstein 回答之后，我写了一个扩展方法

```
using System.Collections.Generic;
using System.Linq;
using System.Xml.Linq;

namespace Mediatel.Framework
{
    public static class XDocumentHelper
    {
        public static IEnumerable<XElement> DescendantElements(this XDocument xDocument, string nodeName)
        {
            return xDocument.Descendants().Where(p => p.Name.LocalName == nodeName);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-07-25T12:53:37.750

这是我基于 LINQ 和类的*Descendants*方法的解决方案的变体`XDocument`

```
using System;
using System.Linq;
using System.Xml.Linq;

class Test
{
    static void Main()
    {
        XDocument xml = XDocument.Parse(@"
        <root>
          <child id='1'/>
          <child id='2'>
            <subChild id='3'>
                <extChild id='5' />
                <extChild id='6' />
            </subChild>
            <subChild id='4'>
                <extChild id='7' />
            </subChild>
          </child>
        </root>");

        xml.Descendants().Where(p => p.Name.LocalName == "extChild")
                         .ToList()
                         .ForEach(e => Console.WriteLine(e));

        Console.ReadLine();
    }
} 
```

[结果：](https://i.stack.imgur.com/zvMEG.png)

[有关该`Desendants`方法的更多详细信息，请查看此处。](https://docs.microsoft.com/fr-fr/dotnet/api/system.xml.linq.xdocument?view=netframework-4.8)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-07-24T10:50:53.657

我们知道以上是真的。乔恩永远不会错；现实生活中的愿望可以走得更远。

```
<ota:OTA_AirAvailRQ
    xmlns:ota="http://www.opentravel.org/OTA/2003/05" EchoToken="740" Target=" Test" TimeStamp="2012-07-19T14:42:55.198Z" Version="1.1">
    <ota:OriginDestinationInformation>
        <ota:DepartureDateTime>2012-07-20T00:00:00Z</ota:DepartureDateTime>
    </ota:OriginDestinationInformation>
</ota:OTA_AirAvailRQ> 
```

例如，通常的问题是，我们如何才能在上面的 XML 文档中获取 EchoToken？或者如何使用 name 属性模糊元素。

1.  您可以通过使用命名空间和如下名称访问它们来找到它们

    ```
     doc.Descendants().Where(p => p.Name.LocalName == "OTA_AirAvailRQ").Attributes("EchoToken").FirstOrDefault().Value 
    ```

2.  您可以通过属性内容值找到它，[比如这个](https://stackoverflow.com/a/2678261/914284)。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2011-11-18T11:36:57.743

**（代码和说明适用于 C#，可能需要对其他语言稍作修改）**

如果您想从具有许多子节点的父节点读取数据，则此示例非常有效，例如查看以下 XML；

```
<?xml version="1.0" encoding="UTF-8"?> 
<emails>
    <emailAddress>jdoe@set.ca</emailAddress>
    <emailAddress>jsmith@hit.ca</emailAddress>
    <emailAddress>rgreen@set_ig.ca</emailAddress> 
</emails> 
```

现在使用下面的代码（请记住，XML 文件存储在资源中（有关资源的帮助，请参阅片段末尾的链接）您可以获取“电子邮件”标签中的每个电子邮件地址。

```
XDocument doc = XDocument.Parse(Properties.Resources.EmailAddresses);

var emailAddresses = (from emails in doc.Descendants("emailAddress")
                      select emails.Value);

foreach (var email in emailAddresses)
{
    //Comment out if using WPF or Windows Form project
    Console.WriteLine(email.ToString());

   //Remove comment if using WPF or Windows Form project
   //MessageBox.Show(email.ToString());
} 
```

## 结果

1.  jdoe@set.ca
2.  jsmith@hit.ca
3.  rgreen@set_ig.ca

**注意：对于控制台应用程序和 WPF 或 Windows 窗体，您必须添加“使用 System.Xml.Linq;” 在项目顶部使用指令，对于控制台，您还需要在添加使用指令之前添加对此命名空间的引用。同样对于控制台，“属性文件夹”下默认没有资源文件，因此您必须手动添加资源文件。下面的 MSDN 文章，详细解释了这一点。**

[添加和编辑资源](http://msdn.microsoft.com/en-us/library/7k989cfy%28v=vs.80%29.aspx)

[如何：添加或删除资源](http://msdn.microsoft.com/en-us/library/3bka19x4%28v=vs.80%29.aspx)

# c# - C# 中来自 SmartCard 的证书

> ID：566179
> 
> 赞同：5
> 
> 时间：2009-02-19T16:48:16.620
> 
> 标签：c#, certificate, smartcard

如何确保从我的智能卡访问证书而不是在 c# 中形成我的个人证书存储？以及如何让我的 RSACryptoProvider 使用我的智能卡证书私钥？

谢谢

沃利

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T10:59:35.160

有时，特别是如果您没有使用智能卡上的默认密钥容器名称（Microsoft 推荐），证书不会复制到本地证书存储区。解决方案是使用 crypto api 通过 KP_CERTIFICATE 访问密钥，从检索到的数据构造证书，并为其分配一个使用您自己的密钥容器名称构造的新 RSACryptoServiceProvider。

伪 C# 代码如下：

```
int reti = CryptoApi.CryptGetUserKey(_hprovider, keytype, ref userKey);

if (reti)
{
    reti =CryptoApi.CryptGetKeyParam(_userKey, KP_CERTIFICATE, ref  pbdata, ref pwddatalen, 0);
}

if (reti || pwddatalen>0)
{
    byte[] data = new byte[pwddatalen];
    ret  = CryptoApi.CryptGetKeyParam(_userKey, KP_CERTIFICATE, data, ref pwddatalen, 0);
    if (ret) 
    {
        X509Certificate2 c = new X509Certificate2(data);
        X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);
        store.Open(OpenFlags.ReadOnly);
        X509Certificate2Collection col = store.Certificates.Find(X509FindType.FindByThumbprint, c.Thumbprint, validonly);
        store.Close();

        if (col.Count != 1) 
        {
            //not found in store - CSP didn't copy it
            c.PrivateKey = PrivateKey(keytype);
            return c;
        }
        else
        {
            return col[0];
        }
    }
}

private RSACryptoServiceProvider PrivateKey (KeyType keytype)
{
    CspParameters csparms = new CspParameters();
    csparms.KeyContainerName = _containerName;
    csparms.ProviderName = _provider;
    csparms.ProviderType = 1;
    csparms.Flags = CspProviderFlags.UseMachineKeyStore | CspProviderFlags.UseExistingKey;
    csparms.KeyNumber = (int)keytype;

    return new RSACryptoServiceProvider(csparms);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T03:02:53.280

您需要通过您的加密服务提供商 (CSP) 获取您的智能卡。在 Windows（2000、XP 和 Vista）上，只要您将智能卡插入智能卡读卡器，其上的所有证书都会传播到您的个人证书存储中。您的私钥保留在您的智能卡上。这意味着如果您使用您的证书（例如对电子邮件进行数字签名），那么系统会提示您插入智能卡。如果您的智能卡需要 PIN，您将被要求输入。这样做的原因是应用程序可以在一个位置查找用户证书，即您的个人证书存储，因此不必仅仅为了处理智能卡上的证书而重写应用程序。

# php - 完整的邮件标题

> ID：566182
> 
> 赞同：25
> 
> 时间：2009-02-19T16:48:47.433
> 
> 标签：php, email

我需要一组邮件标头附加到我`mail()`在 PHP 中的函数。我发送带有 HTML 的电子邮件，有时像[Yahoo Mail](http://en.wikipedia.org/wiki/Yahoo!_Mail)这样的服务会阻止它们。因此，我需要确保我至少提供了正确的标题。

### 我的代码：

```
// To send HTML mail, the 'Content-type' header must be set
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Additional headers
$headers .= 'From: MyCompany <welcome@mycompany.com>' . "\r\n"; 
```

还有什么我应该补充的吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-09-18T10:51:10.687

```
 $headers  = "From: testsite <mail@testsite.com>\n";
    $headers .= "Cc: testsite <mail@testsite.com>\n"; 
    $headers .= "X-Sender: testsite <mail@testsite.com>\n";
    $headers .= 'X-Mailer: PHP/' . phpversion();
    $headers .= "X-Priority: 1\n"; // Urgent message!
    $headers .= "Return-Path: mail@testsite.com\n"; // Return path for errors
    $headers .= "MIME-Version: 1.0\r\n";
    $headers .= "Content-Type: text/html; charset=iso-8859-1\n"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T17:03:54.323

大多数 MUA 会插入很多额外的标头；但是，这是您可以期望的最低限度。

```
To: 
Subject:
Date: 
MIME-Version:
Content-type: 
```

如果您使用 HTML，那么您可能应该使用多部分消息——但这并不是绝对必要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T17:00:28.747

邮件真的来自“mycompany.com”吗？如果某些邮件服务并非真正来自邮件所说的[SMTP](http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol)服务器，那么我遇到了一些邮件服务阻塞的问题。

对我来说，解决这个问题的一种方法是将 from 设为 automail@mydomainnaim.com 并添加一个`reply-to`，作为使用我的系统发送邮件的人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T17:06:56.747

在定义发件人是否可能是垃圾邮件发送者时，许多服务会检查发件人的域是否看起来像拨号用户。

引用自维基百科：

> 一种电子邮件反垃圾邮件技术：检查 rDNS 中的域名以查看它们是否可能来自拨号用户、动态分配的地址或其他廉价的 Internet 服务。此类 IP 地址的所有者通常会为其分配通用 rDNS 名称，例如“1-2-3-4-dynamic-ip.example.com”。由于来自这些计算机的绝大多数（但绝不是全部）电子邮件都是垃圾邮件，因此许多垃圾邮件过滤器会拒绝使用此类 rDNS 名称的电子邮件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T14:38:12.703

下面的链接可能有一些用处，将强制标头定义为：

*   **日期：** 消息发起/写入的日期。

*   **发件人：** 对消息“负责”的人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-05T15:54:31.173

IMF 和 MIME 的 RFC 定义了最小的标头集，因此这是一个很好的起点。

对于 IMF，请看这里：[https ://www.rfc-editor.org/rfc/rfc5322#section-3.6](https://www.rfc-editor.org/rfc/rfc5322#section-3.6)

对于 MIME，请看这里：[https ://www.rfc-editor.org/rfc/rfc2045#section-3](https://www.rfc-editor.org/rfc/rfc2045#section-3)

# c# - 在 .NET 中将 int 转换为 byte[4]

> ID：566185
> 
> 赞同：4
> 
> 时间：2009-02-19T16:49:06.153
> 
> 标签：c#, .net

我想知道这里是否有人知道将整数转换为字节 [4] 的有效方法？我正在尝试将一个 int 写入 MemoryStream，而这个东西要我给它字节

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-19T16:50:46.563

[`BitConverter.GetBytes`](http://msdn.microsoft.com/en-us/library/de8fssa4.aspx)如果要将原始类型转换为其字节表示，则可以使用。请记住确保字节序对您的方案是正确的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-19T16:50:17.373

使用[BinaryWriter](http://msdn.microsoft.com/en-us/library/system.io.binarywriter.aspx)（用您的内存流构建）；它有一个采用 Int32 的 write 方法。

```
BinaryWriter bw = new BinaryWriter(someStream);
bw.Write(intValue);
bw.Write((Int32)1);
// ... 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-19T16:54:00.413

*   [`BinaryWriter`](http://msdn.microsoft.com/en-us/library/system.io.binarywriter.aspx)将是写入流的最简单的解决方案
*   [`BitConverter.GetBytes`](http://msdn.microsoft.com/en-us/library/de8fssa4.aspx)如果你真的想要一个数组是最合适的
*   我自己在[MiscUtil](http://pobox.com/~skeet/csharp/miscutil) (`EndianBitConverter`和`EndianBinaryWriter`) 中的版本让您可以更好地控制字节顺序，还允许您直接转换为现有数组。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-19T17:02:06.940

你也可以自己换班！虽然我会使用内置的方法，但我认为我会把它扔在那里取乐。

```
byte[] getBytesFromInt(int i){
    return new byte[]{
        (byte)i,
        (byte)(i >> 8),
        (byte)(i >> 16),
        (byte)(i >> 24)
    };
} 
```

当然，你必须担心字节序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-19T16:52:20.173

[`byte[] bytes = BitConverter.GetBytes(42);`](http://msdn.microsoft.com/en-us/library/de8fssa4.aspx)

# java - 带有复杂编辑器的 JTable

> ID：566186
> 
> 赞同：8
> 
> 时间：2009-02-19T16:49:11.163
> 
> 标签：java, user-interface, swing, editor, jtable

我有许多 JTable 的自定义编辑器，可以轻描淡写地说缺乏可用性，尤其是在使用键盘进行编辑方面。

造成这种情况的主要原因是我的编辑器总是在与此类似（尽管通常更复杂）的情况下创建：

```
@Override
public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected, int row, int column) {
  JPanel container = new JPanel();
  container.setLayout(new BorderLayout());
  container.add(field, BorderLayout.CENTER);
  field.setText((String) value);
  container.add(new JButton("..."), BorderLayout.EAST);
  return container;
} 
```

IE 一个面板，里面有多个组件。实际的文本编辑器是作为编辑器返回的组件的后代。因此，除了渲染问题，据我所知，JTable 正在关注该`getTableCellEditorComponent`方法返回的组件，因此当您按下一个突出显示单元格的键时，它会将焦点和按键传递给面板，认为这是编辑器。
无论如何我可以告诉JTable“真正的”编辑器是JTextfield吗？在正确的组件上添加 hacky`requestFocusInWindow`是不够的，因为按键不会被传递。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T19:12:52.493

如果我正确阅读了您的问题，您希望用户能够立即输入单元格，而无需先激活单元格编辑器，即，您希望激活单元格的任何击键成为输入文本字段的第一个字符。

我的第一次尝试是在 KeyboardFocusManager 的 focusOwner 属性上添加一个 propertyChangeListener，只是注意到焦点永远不会离开 JTable。你可能也遇到了。计划 B 的时间。

通过将 KeyListener 添加到记录实例字段中 keyPressed() 方法的最后一个 KeyEvent 的表中，我得到了“第一次按键”的工作。getTableCellEditorComponent() 方法从那里读取字符。如果用户要在第一个字符之后继续输入任何字符，我还需要你提到那个 hacky requestFocusInWindow() 调用。

对于我的示例应用程序，我创建了一个 JTable 的子类，它向自身添加了一个 KeyListener。让您的 CellEditor 实例实现 KeyListener 并将其添加到常规 JTable 是一个更好的主意，但我将把它留给您。

这是我修改后的代码片段：

```
@Override
public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected, int row, int column) {
    JPanel container = new JPanel();
    container.setLayout(new BorderLayout());
    container.add(field, BorderLayout.CENTER);

    // Will want to add an instanceof check as well as a check on Character.isLetterOrDigit(char).
    char keypressed = ((StickyKeypressTable)table).getLastKeyPressed();
    field.setText(String.valueOf(keypressed));

    container.add(new JButton("..."), BorderLayout.EAST);

    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            // This needs to be in an invokeLater() to work properly
            field.requestFocusInWindow();
        }
    });
    return container;
} 
```

就肮脏而言，这与 Vogon Poetry 位于某个地方，但它应该可以解决您的直接问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T20:16:18.660

我想我解决了。
说实话，我不知道是什么解决了这个问题，因为我使用的是自定义编辑器、自定义渲染器和其他东西......

当一个单元格突出显示并按“abc”时，屏幕上会显示 3 个字母（在本例中为单元格）。

```
grid.addKeyListener(new KeyAdapter() {
    public void keyTyped(KeyEvent ke) {
        int l = grid.getSelectedRow();
        int c = grid.getSelectedColumn();
        grid.editCellAt(l, c);
    }
}); 
```

嗯......我试过...... =）
（我不知道它是否相同，因为我的JTable使用JTextField和JComboBox作为编辑器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T08:07:17.917

我分两步修复了类似的东西

首先覆盖 JTable 中的 editCellAt 并在准备好编辑器后调用 requestFocus：

```
public boolean editCellAt( int row, int column, EventObject e )
{
  if ( cellEditor != null && !cellEditor.stopCellEditing() )
    {
    return false;
    }

  if ( row < 0 || row >= getRowCount() ||
      column < 0 || column >= getColumnCount() )
    {
    return false;
    }

  if ( !isCellEditable(row, column) )
    return false;

  TableCellEditor editor=getCellEditor(row, column);
  if ( editor != null && editor.isCellEditable(e) )
    {
    editorComp=prepareEditor(editor, row, column);
    if ( editorComp == null )
      {
      removeEditor();
      return false;
      }
    //aangepast
    Rectangle rect=getCellRect(row, column, false);
    if ( datamodel_.useAdaptedEditorRect() )
      rect=datamodel_.changeRectangle(rect, editorComp);
    editorComp.setBounds(rect);
    add(editorComp);
    editorComp.validate();

    setCellEditor(editor);
    setEditingRow(row);
    setEditingColumn(column);
    editor.addCellEditorListener(this);
    //NEXT LINE ADDED 
    editorComp.requestFocus();
    return true;
    }
  return false;
} 
```

然后从您的 JPanel 重载 requestFocus 并确保您的文本字段被放置为 editorComponent：

```
public class EditorPanel extends JPanel {
   JComponent editorComponent;

   public boolean isRequestFocusEnabled()
   {
     return true;
   }

   public void requestFocus()
   {
   editorComponent.requestFocus();
   }
} 
```

您可以随时获取 keyEvent 并自行设置：

```
AWTEvent event = EventQueue.getCurrentEvent();
if ( event instanceof KeyEvent )
  {
  char newSelection = ( (KeyEvent) event).getKeyChar();
  int keyCode = ( (KeyEvent) event ).getKeyCode();
  editorComponent.requestFocus();
  if ( editorComponent instanceof JTextField )
    {
    if ( ( newSelection >= (char) FIRST_ALLOWED_CHAR ) && ( newSelection != (char) LAST_ALLOWED_CHAR ) ) //comes from DefaultKeyTypedAction
       ( (JTextField) editorComponent ).setText(Character.toString(newSelection));
    if ( keyCode == KeyEvent.VK_BACK_SPACE || keyCode == KeyEvent.VK_DELETE )
      ( (JTextField) editorComponent ).setText("");          
    }
  }
else
  editorComponent.requestFocus(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T21:09:51.333

I had very similar problem. In my case I had complex `TableCellEditor` which consists of JSpinner and some other components. The problem was that when cell editor started I wanted to transfer focus to its internal component. I fixed this by calling `panel.transferFocusDownCycle()` but this in turn caused keyboard events to stop working - when my internal component had focus and I pressed key up, I was expecting that component will intercept this event and change its value. Instead table changed row focus to one above... I fixed this by adding `KeyListener` and dispatching all key events directly to the internal component.

This is wrapper class based on `JPanel` I wrote to make my life easier.

```
public class ContainerPanel extends JPanel implements KeyListener, FocusListener {

    private JComponent component = null;

    public ContainerPanel(JComponent component) {
        this.component = component;
        addKeyListener(this);
        addFocusListener(this);
        setFocusCycleRoot(true);
        setFocusTraversalPolicy(new ContainerOrderFocusTraversalPolicy());
        add(component);
    }

    @Override
    public void keyTyped(KeyEvent e) {
        component.dispatchEvent(e);
    }

    @Override
    public void keyPressed(KeyEvent e) {
        component.dispatchEvent(e);
    }

    @Override
    public void keyReleased(KeyEvent e) {
        component.dispatchEvent(e);
    }

    @Override
    public void focusGained(FocusEvent e) {
        component.transferFocusDownCycle();
    }

    @Override
    public void focusLost(FocusEvent e) {
    }
} 
```

# javascript - 使用 Javascript 更改 CSS 值

> ID：566203
> 
> 赞同：106
> 
> 时间：2009-02-19T16:53:19.753
> 
> 标签：javascript, html, css, ajax, dom

使用 javascript 设置内联 CSS 值很容易。如果我想改变宽度并且我有这样的html：

```
<div style="width: 10px"></div> 
```

我需要做的就是：

```
document.getElementById('id').style.width = value; 
```

它将更改内联样式表值。通常这不是问题，因为内联样式会覆盖样式表。例子：

```
<style>
   #tId {
      width: 50%;
   }
</style>

<div id="tId"></div> 
```

使用这个 Javascript：

```
document.getElementById('tId').style.width = "30%"; 
```

我得到以下信息：

```
<style>
   #tId {
      width: 50%;
   }
</style>

<div id="tId" style="width: 30%";></div> 
```

这是一个问题，因为我不仅不想更改内联值，如果我在设置之前查找宽度，当我有：

```
<div id="tId"></div> 
```

返回的值是 Null，所以如果我有 Javascript 需要知道某些东西的宽度来执行某些逻辑（我将宽度增加 1%，而不是特定值），当我期望字符串“50%”时返回 Null “真的不行。

所以我的问题是：我的 CSS 样式中的值不是内联的，我怎样才能获得这些值？给定 id，如何修改样式而不是内联值？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-02-19T18:00:33.110

好的，听起来您想更改全局 CSS，以便一次有效地更改特定样式的所有元素。我最近从[Shawn Olson 教程](http://www.shawnolson.net/a/503/altering-css-class-attributes-with-javascript.html)中学会了如何做到这一点。[你可以在这里](http://www.shawnolson.net/scripts/public_smo_scripts.js)直接参考他的代码。

这是摘要：

您可以通过检索[样式表](https://developer.mozilla.org/En/DOM/Stylesheet)`document.styleSheets`。这实际上将返回页面中所有样式表的数组，但您可以通过`document.styleSheets[styleIndex].href`属性判断您在哪个样式表上。找到要编辑的样式表后，您需要获取规则数组。这在 IE 中称为“规则”，在大多数其他浏览器中称为“cssRules”。判断您使用的[CSSRule](https://developer.mozilla.org/en/DOM/cssRule#CSSStyleRule)的方法是通过`selectorText`属性。工作代码如下所示：

```
var cssRuleCode = document.all ? 'rules' : 'cssRules'; //account for IE and FF
var rule = document.styleSheets[styleIndex][cssRuleCode][ruleIndex];
var selector = rule.selectorText;  //maybe '#tId'
var value = rule.value;            //both selectorText and value are settable. 
```

让我知道这对您有何作用，如果您发现任何错误，请发表评论。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-06-18T10:36:20.633

请！只要问 w3 ( [http://www.quirksmode.org/dom/w3c_css.html](http://www.quirksmode.org/dom/w3c_css.html) )！或者实际上，我花了五个小时……但就是这样！

```
function css(selector, property, value) {
    for (var i=0; i<document.styleSheets.length;i++) {//Loop through all styles
        //Try add rule
        try { document.styleSheets[i].insertRule(selector+ ' {'+property+':'+value+'}', document.styleSheets[i].cssRules.length);
        } catch(err) {try { document.styleSheets[i].addRule(selector, property+':'+value);} catch(err) {}}//IE
    }
} 
```

该功能非常易于使用..示例：

```
<div id="box" class="boxes" onclick="css('#box', 'color', 'red')">Click Me!</div>
Or:
<div class="boxes" onmouseover="css('.boxes', 'color', 'green')">Mouseover Me!</div>
Or:
<div class="boxes" onclick="css('body', 'border', '1px solid #3cc')">Click Me!</div> 
```

哦..

* * *

**编辑：**正如@user21820 在其答案中描述的那样，更改页面上的所有样式表可能有点不必要。以下脚本适用于 IE5.5 以及最新的 Google Chrome，并且仅添加了上述 css() 函数。

```
(function (scope) {
    // Create a new stylesheet in the bottom
    // of <head>, where the css rules will go
    var style = document.createElement('style');
    document.head.appendChild(style);
    var stylesheet = style.sheet;
    scope.css = function (selector, property, value) {
        // Append the rule (Major browsers)
        try { stylesheet.insertRule(selector+' {'+property+':'+value+'}', stylesheet.cssRules.length);
        } catch(err) {try { stylesheet.addRule(selector, property+':'+value); // (pre IE9)
        } catch(err) {console.log("Couldn't add style");}} // (alien browsers)
    }
})(window); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-11-12T23:11:45.887

收集答案中的代码，我编写了这个似乎在我的 FF 25 上运行良好的函数。

```
function CCSStylesheetRuleStyle(stylesheet, selectorText, style, value){
  /* returns the value of the element style of the rule in the stylesheet
  *  If no value is given, reads the value
  *  If value is given, the value is changed and returned
  *  If '' (empty string) is given, erases the value.
  *  The browser will apply the default one
  *
  * string stylesheet: part of the .css name to be recognized, e.g. 'default'
  * string selectorText: css selector, e.g. '#myId', '.myClass', 'thead td'
  * string style: camelCase element style, e.g. 'fontSize'
  * string value optionnal : the new value
  */
  var CCSstyle = undefined, rules;
  for(var m in document.styleSheets){
    if(document.styleSheets[m].href.indexOf(stylesheet) != -1){
     rules = document.styleSheets[m][document.all ? 'rules' : 'cssRules'];
     for(var n in rules){
       if(rules[n].selectorText == selectorText){
         CCSstyle = rules[n].style;
         break;
       }
     }
     break;
    }
  }
  if(value == undefined)
    return CCSstyle[style]
  else
    return CCSstyle[style] = value
} 
```

这是一种将值放入将在 JS 中使用的 css 中的方法，即使浏览器不理解也是如此。例如，滚动表中的 tbody 的 maxHeight。

称呼 ：

`CCSStylesheetRuleStyle('default', "#mydiv", "height");`

`CCSStylesheetRuleStyle('default', "#mydiv", "color", "#EEE");`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-12-05T04:59:39.947

我不知道为什么其他解决方案会遍历文档的整个样式表列表。这样做会在每个样式表中创建一个新条目，这是低效的。相反，我们可以简单地附加一个新样式表，然后在其中添加我们想要的 CSS 规则。

```
style=document.createElement('style');
document.head.appendChild(style);
stylesheet=style.sheet;
function css(selector,property,value)
{
    try{ stylesheet.insertRule(selector+' {'+property+':'+value+'}',stylesheet.cssRules.length); }
    catch(err){}
} 
```

请注意，我们甚至可以通过将“！important”添加到属性值来覆盖直接在元素上设置的内联样式，除非该属性已经存在更具体的“！important”样式声明。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-05-05T05:56:44.467

我没有足够的代表发表评论，所以我会格式化一个答案，但这只是对相关问题的演示。

似乎，当在样式表中定义元素样式时，它们对 getElementById("someElement").style 不可见

这段代码说明了这个问题...... [jsFiddle 下面的代码](http://jsfiddle.net/BentFX/DhvRJ)。

在测试 2 中，在第一次调用时，items left 的值是未定义的，因此，应该是一个简单的切换的东西被搞砸了。对于我的使用，我将内联定义我的重要样式值，但这似乎部分违背了样式表的目的。

这是页面代码...

```
<html>
  <head>
    <style type="text/css">
      #test2a{
        position: absolute;
        left: 0px;
        width: 50px;
        height: 50px;
        background-color: green;
        border: 4px solid black;
      }
      #test2b{
        position: absolute;
        left: 55px;
        width: 50px;
        height: 50px;
        background-color: yellow;
        margin: 4px;
      }
    </style>
  </head>
  <body>

  <!-- test1 -->
    Swap left positions function with styles defined inline.
    <a href="javascript:test1();">Test 1</a><br>
    <div class="container">
      <div id="test1a" style="position: absolute;left: 0px;width: 50px; height: 50px;background-color: green;border: 4px solid black;"></div>
      <div id="test1b" style="position: absolute;left: 55px;width: 50px; height: 50px;background-color: yellow;margin: 4px;"></div>
    </div>
    <script type="text/javascript">
     function test1(){
       var a = document.getElementById("test1a");
       var b = document.getElementById("test1b");
       alert(a.style.left + " - " + b.style.left);
       a.style.left = (a.style.left == "0px")? "55px" : "0px";
       b.style.left = (b.style.left == "0px")? "55px" : "0px";
     }
    </script>
  <!-- end test 1 -->

  <!-- test2 -->
    <div id="moveDownThePage" style="position: relative;top: 70px;">
    Identical function with styles defined in stylesheet.
    <a href="javascript:test2();">Test 2</a><br>
    <div class="container">
      <div id="test2a"></div>
      <div id="test2b"></div>
    </div>
    </div>
    <script type="text/javascript">
     function test2(){
       var a = document.getElementById("test2a");
       var b = document.getElementById("test2b");
       alert(a.style.left + " - " + b.style.left);
       a.style.left = (a.style.left == "0px")? "55px" : "0px";
       b.style.left = (b.style.left == "0px")? "55px" : "0px";
     }
    </script>
  <!-- end test 2 -->

  </body>
</html> 
```

我希望这有助于阐明这个问题。

跳过

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-19T22:18:03.683

您可以获得任何元素的“计算”样式。

IE 使用称为“currentStyle”的东西，Firefox（我假设其他“符合标准”的浏览器）使用“defaultView.getComputedStyle”。

您需要编写一个跨浏览器函数来执行此操作，或者使用良好的 Javascript 框架，如原型或 jQuery（在原型 javascript 文件中搜索“getStyle”，在 jquery javascript 文件中搜索“curCss”）。

也就是说，如果您需要高度或宽度，您可能应该使用 element.offsetHeight 和 element.offsetWidth。

> 返回的值是 Null，所以如果我有 Javascript 需要知道某物的宽度来执行某些逻辑（我将宽度增加 1%，而不是特定值）

请注意，如果您向相关元素添加内联样式，它可以充当“默认”值，并且在页面加载时可由 Javascript 读取，因为它是元素的内联样式属性：

```
<div style="width:50%">....</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T17:10:59.033

我从未见过任何实际用途，但您可能应该考虑使用[DOM 样式表](http://www.howtocreate.co.uk/tutorials/javascript/domstylesheets)。然而，老实说，我认为这是矫枉过正。

如果您只是想获取元素的宽度和高度，无论从何处应用尺寸，只需使用`element.offsetWidth`and `element.offsetHeight`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-09T15:09:49.057

[这个简单的 32 行 gist](https://gist.github.com/solendil/821ed660cf3e391daea5ca36d3b86148)可让您识别给定的样式表并非常轻松地更改其样式：

```
var styleSheet = StyleChanger("my_custom_identifier");
styleSheet.change("darkolivegreen", "blue"); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-12T05:41:11.997

也许试试这个：

```
function CCSStylesheetRuleStyle(stylesheet, selectorText, style, value){
  var CCSstyle = undefined, rules;
  for(var m in document.styleSheets){
    if(document.styleSheets[m].href.indexOf(stylesheet) != -1){
     rules = document.styleSheets[m][document.all ? 'rules' : 'cssRules'];
     for(var n in rules){
       if(rules[n].selectorText == selectorText){
         CCSstyle = rules[n].style;
         break;
       }
     }
     break;
    }
  }
  if(value == undefined)
    return CCSstyle[style]
  else
    return CCSstyle[style] = value
} 
```

# reporting-services - 在 SQL Server 2005 报告 .rdl 文件中使用 ASP.NET 服务器控件

> ID：566220
> 
> 赞同：1
> 
> 时间：2009-02-19T16:59:05.123
> 
> 标签：reporting-services, reportingservices-2005, servercontrols, rdl

如何在 SQL Server 2005 报告文件 (.rdl) 上嵌入 ASP.NET 服务器控件？

我正在使用设计视图来完成我的任务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T17:02:10.263

上次我检查你不能。您仅限于生成图像的代码，例如条形码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T17:27:44.337

不幸的是，你不能。SQL Reporting Services 可以生成多种格式的报告——HTML、PDF、XLS、CSV 等等。它与 ASP.NET 无关，只是您可以使用 ReportViewer Web 控件来发出以 HTML 格式呈现的报告。

根据您要完成的工作，您可以使用参数将信息从包含报表查看器的网页传递到报表中。

# wpf - 在 WPF 中创建通用窗口外观

> ID：566223
> 
> 赞同：5
> 
> 时间：2009-02-19T17:00:01.443
> 
> 标签：wpf

如何在 WPF 中创建通用窗口外观？我说的不仅仅是样式化窗口，我的意思是有一个包含边框、网格和其他一些东西的窗口。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T20:21:15.967

您可以为窗口创建一个 ControlTemplate。这是一个非常基本的示例，其中包含一些控件和触发器。您可以轻松添加更多元素以使其满足您的需求。

```
 <ControlTemplate x:Key="MyWindowTemplate" TargetType="{x:Type Window}">
      <Border x:Name="WindowBorder" Style="{DynamicResource WindowBorderStyle}">
         <Grid>
            <Border Margin="4,4,4,4" Padding="0,0,0,0" x:Name="MarginBorder">
               <AdornerDecorator>
                  <ContentPresenter/>
               </AdornerDecorator>
            </Border>
            <ResizeGrip Visibility="Collapsed" IsTabStop="false" HorizontalAlignment="Right" x:Name="WindowResizeGrip" 
                    VerticalAlignment="Bottom" />
         </Grid>
      </Border>
      <ControlTemplate.Triggers>
         <MultiTrigger>
            <MultiTrigger.Conditions>
               <Condition Property="ResizeMode" Value="CanResizeWithGrip"/>
               <Condition Property="WindowState" Value="Normal"/>
            </MultiTrigger.Conditions>
            <Setter Property="Visibility" TargetName="WindowResizeGrip" Value="Visible"/>
            <Setter Property="Margin" TargetName="MarginBorder" Value="4,4,4,20" />
         </MultiTrigger>
         <Trigger Property="WindowState" Value="Maximized">
            <Setter Property="CornerRadius" TargetName="WindowBorder" Value="0,0,0,0"/>
         </Trigger>
      </ControlTemplate.Triggers>
   </ControlTemplate> 
```

您可以通过设置 Window 的模板属性来使用此 ControlTemplate：

```
 Template="{StaticResource MyWindowTemplate}" 
```

您将希望将其与以下样式结合使用：

```
 <Style x:Key="MyWindowStyle" TargetType="{x:Type Window}">
      <Setter Property="AllowsTransparency" Value="False" />
      <Setter Property="WindowStyle" Value="SingleBorderWindow" />
      <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="ShowInTaskbar" Value="False" />
      <Setter Property="Template">
         <Setter.Value>
            <ControlTemplate TargetType="{x:Type Window}">
               <Border>
                  <AdornerDecorator>
                     <ContentPresenter/>
                  </AdornerDecorator>
               </Border>
            </ControlTemplate>
         </Setter.Value>
      </Setter>
   </Style> 
```

并像这样在 Window 上设置样式：

```
Style="{StaticResource MyWindowStyle}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T16:52:48.630

我最终做的是创建一个基类，在每个窗口中创建我想要的 UI 代码。这允许我为控件设置事件并在基类中订阅事件。如果有更好的方法，比如使用 xaml，我想知道。

```
public WindowBase()
{
    Initialized += WindowBase_Initialized;
}

private void WindowBase_Initialized( object sender, EventArgs e )
{
    Border border = new Border();
    border.SetResourceReference( Control.StyleProperty, "WindowBorder" );

    border.Child = new ContentPresenter { Content = this.Content};

    this.Content = border;
} 
```

# c++ - 如何用eclipse cdt编译windows基础程序（使用VIsual Studio编译器）

> ID：566225
> 
> 赞同：1
> 
> 时间：2009-02-19T17:00:16.407
> 
> 标签：c++, visual-studio, eclipse, eclipse-cdt

我想用 microsoft copmiler 在 eclipse cdt 中编译（如果可能的话调试）windows 程序。

最好支持eclipse工具链（在eclipse cdt中）

除了使用 mingw 的 make 和 Visual Studio Makefile 外，在 google 中找不到此解决方案是不可能的。

有没有人可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:53:52.560

您想使用[Wascana](http://wascana.sourceforge.net/)，这是一个针对 Windows 开发的 Eclipse/CDT 发行版。不幸的是，Windows 支持并不完整。因为它缺少适当的调试器。

# git - 从 StarTeam 中的“文件共享”范例迁移到像 GIT 这样的 DVCS？

> ID：566233
> 
> 赞同：1
> 
> 时间：2009-02-19T17:03:53.387
> 
> 标签：git, visual-sourcesafe, dvcs, starteam

StarTeam 在视图之间共享文件。基本上，StarTeam 中的视图可以共享来自其他视图的单个文件。然后它也可以分支文件。是否可以迁移 StarTeam 中彼此共享数百个文件的视图？有人有这方面的经验吗？假设唯一的解决方案是在 GIT 中将一个 StarTeam“视图”转换为一个存储库，那么是否有策略仍然允许在 GIT 中的多个存储库之间共享文件？

肖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T21:37:30.053

我不知道 StarTeam，但你所描述的听起来像是 Git 中的长期分支。

假设除了正在进行的开发之外，您还希望为某些专用硬件 A 和 B 提供独立版本：您可以为 A 版本和 B 版本保留单独的分支，并在`master`分支上开发共享文件。然后你只合并`master`到你的专业分支中，而不是从它们合并到`master`.

这通常比保留单独的存储库或子模块更简单，因为如果文件更改，Git 会跟踪树的树，而不是单个文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T17:24:54.863

[Git 用户手册](http://www.kernel.org/pub/software/scm/git/docs/user-manual.html#submodules)：

> Git 的子模块支持允许存储库作为子目录包含外部项目的签出。子模块保持自己的身份；子模块支持仅存储子模块存储库位置和提交 ID，因此克隆包含项目（“超级项目”）的其他开发人员可以轻松地克隆同一修订版的所有子模块。超级项目的部分签出是可能的：您可以告诉 Git 不克隆任何子模块、部分或全部子模块。

[git-submodule](http://git-scm.com/docs/git-submodule)命令初始化、更新或检查子模块。

# windows-mobile - 如何在windows mobile app上使.cab文件自删除

> ID：566235
> 
> 赞同：1
> 
> 时间：2009-02-19T17:04:24.247
> 
> 标签：windows-mobile, cab

我的第一个 Windows Mobile 应用程序已准备好部署（Windows Mobile 6）。我已经制作了我的 CABProject 并制作了一个可以成功安装的 .cab 文件。.cab 如何在安装后自行删除？我读到的一些东西似乎表明这应该是默认行为。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T18:03:41.517

[使用wceload](http://msdn.microsoft.com/en-us/library/ms933760.aspx)实用程序安装 Cab 文件。删除 cab 确实是默认行为。

有关更多高级功能，请参阅[CABInstallerSDK](http://www.opennetcf.com/Products/CABInstallerSDK/tabid/272/Default.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T18:17:57.830

正如 kgiannakakis 所说，使用 wceload 实用程序安装 CAB 文件，但是通过资源管理器或通过 actiesync install 运行 CAB 时发生的默认行为因设备而异。通常我看到智能手机设备默认删除 cab 文件。在 Pocket PC 上，我主要看到 CAB 没有被删除。

所以我要说的是，您不能保证 CAB 文件在安装后被删除，除非您安排您的代码调用“wceload”实用程序并因此可以控制它的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-12T20:00:27.053

kgiannakakis 是正确的，wceload 实用程序的默认行为是在安装后删除 cab 文件，但是 /nodelete 标志改变了这种行为。

你会发现： [HKEY_CLASSES_ROOT\cabfile\Shell\Open\Command] @="wceload.exe "%1" /nodelete"

在某些设备上，这将导致该设备上的默认行为不同。

# java - Java 5 中的动态编译选项

> ID：566239
> 
> 赞同：6
> 
> 时间：2009-02-19T17:05:22.517
> 
> 标签：java, compiler-construction, dynamic-compilation, janino

除了 Janino 之外，还有其他选项可用于在 v5 中即时编译和执行 Java 代码吗？我知道 v6 有 Compiler API，但我需要使用 v5 VM。

我基本上需要获取一个包含完整 Java 类的字符串，对其进行编译并将其加载到内存中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-19T18:51:12.500

你想要的是[Janino 之](http://www.janino.net/)类的东西。我们已经使用了多年。你给它（接近标准的）代码，它给你类，所以你可以使用它们。它实际上有很多不同的模式，并支持 1.5 语法糖和自动装箱等。

如果您调用 javac，您不仅必须为它所做的任何事情做好准备，您还必须处理将类放在正确的位置或制作额外的类加载器。

Janino 很容易。它应该正是您正在寻找的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T17:49:06.713

以编程方式调用 javac：

[http://www.juixe.com/techknow/index.php/2006/12/12/invoke-javac-at-runtime/](http://www.juixe.com/techknow/index.php/2006/12/12/invoke-javac-at-runtime/)

```
   com.sun.tools.javac.Main javac = new com.sun.tools.javac.Main();  

   字符串 [] 选项 = 新字符串 []
   {  
      “-classpath”，类路径，“-d”，outputDir，文件名  
   };

   javac.compile(选项);

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T17:31:51.863

所有的应用服务器都永远为 JSP 做这件事，所以显然这是可能的。结帐tomcat源代码可能吗？

# c# - 如何用 C# 绘制平滑的图像？

> ID：566245
> 
> 赞同：7
> 
> 时间：2009-02-19T17:08:13.490
> 
> 标签：c#, .net, winforms, picturebox, wmf

我正在尝试在 C# 表单上绘制图像（在 PictureBoxes 中以及使用 Graphics.DrawImage()），并且正在寻找一种将它们绘制**平滑**的方法。图像必须是支持透明度的格式，例如 PNG、GIF、SVG 和 WMF。C# 不支持开箱即用的 SVG 文件，而且我还没有找到一个好的第三方库可以使用（我找到了 SvgNet，但无法弄清楚）。

我需要绘制一个 WMF 文件，C# 可以通过 Image.FromFile() 函数完成该文件，但它没有抗锯齿。我想知道有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-11-21T05:18:14.380

先前的答案虽然是出于好意，但只是部分正确。

什么是正确的？PictureBox 不公开 InterpolationMode。

出了什么问题？

1) 虽然您可以轻松地从图片框、其父级或通过派生类中的覆盖在 Paint 事件中设置该属性。. . 无论哪种方式都有效，两者都一样容易。但是，除非设置 SmoothingMode，否则 InterpolationMode 将被忽略。如果将 SmoothingMode 设置为 SmoothingMode.AnitAlias，您将不会获得任何抗锯齿。

2) 当您明确表示有兴趣使用 PictureBox 的功能时使用面板是错误的方向。您将无法直接加载、保存或分配图像，而无需显式编码这些属性。. . *为什么要重新发明轮子？* 通过从 PictureBox 派生，您可以免费获得所有这些。

消息变得更好，因为我已经为您完成了**艰苦的工作**，而且我花费的时间比写此消息要少。

我提供了两个版本，它们都来自 PictureBox。*首先*是一个简单的示例，它始终使用可能的最佳质量渲染。这也是最慢的渲染。*第二个*是允许任何人通过派生类的属性设置各种渲染参数的类。一旦设置，这些将在 OnPaint 覆盖中使用。

```
public class HighQualitySmoothPictureBox : PictureBox
{
    protected override void OnPaint(PaintEventArgs pe)
    {
        // This is the only line needed for anti-aliasing to be turned on.
        pe.Graphics.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias;

        // the next two lines of code (not comments) are needed to get the highest 
        // possible quiality of anti-aliasing. Remove them if you want the image to render faster.
        pe.Graphics.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;
        pe.Graphics.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;
        // this line is needed for .net to draw the contents.
        base.OnPaint(pe);
    }
} 
```

...

```
public class ConfigurableQualityPictureBox : PictureBox
{
    // Note: the use of the "?" indicates the value type is "nullable."  
    // If the property is unset, it doesn't have a value, and therefore isn't 
    // used when the OnPaint method executes.
    System.Drawing.Drawing2D.SmoothingMode? smoothingMode;
    System.Drawing.Drawing2D.CompositingQuality? compositingQuality;
    System.Drawing.Drawing2D.InterpolationMode? interpolationMode;

    public System.Drawing.Drawing2D.SmoothingMode? SmoothingMode
    {
        get { return smoothingMode; }
        set { smoothingMode = value; }
    }

    public System.Drawing.Drawing2D.CompositingQuality? CompositingQuality
    {
        get { return compositingQuality; }
        set { compositingQuality = value; }
    }

    public System.Drawing.Drawing2D.InterpolationMode? InterpolationMode
    {
        get { return interpolationMode; }
        set { interpolationMode = value; }
    }

    protected override void OnPaint(PaintEventArgs pe)
    {
        if (smoothingMode.HasValue)
            pe.Graphics.SmoothingMode = smoothingMode.Value;
        if (compositingQuality.HasValue)
            pe.Graphics.CompositingQuality = compositingQuality.Value;
        if (interpolationMode.HasValue)
            pe.Graphics.InterpolationMode = interpolationMode.Value;

        // this line is needed for .net to draw the contents.
        base.OnPaint(pe);
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-19T17:21:22.610

将图像绘制到画布上时，您可以将插值模式更改为比最近邻更好的方式，以使调整大小的图像平滑：

```
Graphics g = ...
g.InterpolationMode = InterpolationMode.HighQualityBicubic;
g.DrawImage(...); 
```

您需要添加 System.Drawing.Drawing2D 以获取 InterpolationMode 枚举。

使用 PictureBox 将是一个问题 - 它不会公开 InterpolationMode 属性，因此您需要自己滚动或下载一个。

# unmanaged - 在混合 C++ .NET 应用程序中强调托管还是非托管？

> ID：566246
> 
> 赞同：4
> 
> 时间：2009-02-19T17:08:32.133
> 
> 标签：unmanaged, managed

我工作的应用程序是一个几乎完全用 Visual C++ 大约在 2003 年编写的 WinForms 应用程序。在我到达现场之前，由于 UI 构建框架而选择了 .NET，但绝大多数代码是在非托管领域开发的. 其中一部分是绝对必要的——我们对一些非常大的数据集进行一些实时图像处理，使用一些需要指向图像缓冲区的指针的英特尔图像处理库，我们确实*在*不到 1% 的情况下性能有那么重要吗？

该应用程序本身是一个大型可执行文件，通过将 UI 代码链接到几个静态库而形成，每个静态库都对应一个功能子系统——数据采集、图像处理等。自从我加入以来，我通过编写托管包装器将其中几个子系统拆分为 DLL，我们在其他应用程序中重用它们，但主应用程序仍然基本上由静态链接库组成。

我的同事和我在进一步发展应该强调非托管还是托管方面存在很大分歧。除了我提到的情况外，没有规定非托管代码的性能要求。我们坚定地致力于 .NET，因此跨平台不是问题。我认为除非另有规定，否则我们应该支持托管。

上个月，我的同事开发了一组管理子系统的类；他没有将它们实现为 ref 类并将一些事件添加到 .NET 接口，而是编写了几个 Observer 实现，使用 gcroot 来保存托管客户端的句柄，并允许自己留在非托管领域。这在我看来是错误的，只是因为为什么要写一些你可以免费拥有的东西？但我想知道我是否过于刻板。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-14T20:07:20.177

托管与非托管编程之禅：

良好的非托管代码将通过在内存管理错误与等效托管代码方面没有明显劣势来举例说明。

良好的托管代码将通过在性能上与等效的非托管代码相比没有明显的劣势来举例说明。

他们两个之间的互操作没有什么好处；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T04:13:18.967

没有单一的正确或错误答案，除了说你倾向于管理而你的同事倾向于非管理绝对是错误的。无论您选择哪种方式，您都需要达成一致，以免使某些代码托管和某些代码未托管的问题变得更糟。

您说“我们坚定地致力于 .NET”。这里的“我们”是谁？是你的公司还是你和你的同事？听起来您的同事对 .NET 不太投入。如果公司承诺而同事不承诺，那么需要有人向你的同事重申他是团队的一员，需要遵循公司的方向。

如果决定真的取决于你们两个，而你的同事不让步，那么你应该考虑默许。

我们也有一个大型托管/非托管应用程序，除非我们绝对必须这样做，否则我们永远不会考虑在非托管中做任何事情。应用程序的大部分是托管的。这样会好很多。但这是我的看法，不是事实。

# php - 无法使用 PHP exec 执行 PHP 脚本

> ID：566248
> 
> 赞同：16
> 
> 时间：2009-02-19T17:09:08.313
> 
> 标签：php, exec

我正在尝试使用 PHP exec 调用来调用一个需要几秒钟的脚本（第 3 方的 Web 服务）。经过一番挣扎，我将其简化为经典的 hello world 示例。调用脚本如下所示：

```
exec('/usr/bin/php /home/quote2bi/tmp/helloworld.php > /tmp/execoutput.txt 2>&1 &'); 
```

当我运行它时，输出`execoutput.txt`包含调用脚本页面的副本，这`hello world`与我预期的不同。

为什么我不能让这个 PHP 脚本使用 exec 来执行？请注意，当我将命令更改为类似`ls -l`时，输出是预期的目录列表。顺便说一句，以防万一，我将调用的脚本chmod到755 ...

**更新**- 我将 exec 调用移到调用脚本的末尾，至少现在我没有看到输出中执行的调用脚本。感谢海报，我将尝试其中一些想法。

帮助！

谢谢史蒂夫

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-05-19T17:49:18.283

我也遇到了这个问题，事实证明这是 php (#11430) 中的一个错误。修复方法是在 php 脚本中调用另一个 php 脚本时使用 php-cli。所以你仍然可以使用 exec 而不是使用 php 在浏览器中调用它时使用 php-cli ：

```
exec("php-cli  somescript.php"); 
```

这对我有用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-19T17:18:13.263

exec 正在做的是获取最右边的命令并将其附加到您的目的地。如果您的 php 脚本中有 shebang 行，则不需要包含 php 解释器的二进制指令。

如果您只想要脚本的输出，请尝试：

```
exec('/home/quote2bi/tmp/helloworld.php > /tmp/execoutput.txt 2>&1 &') 
```

但是，如果您不希望错误出现在文件中，则应在输出到文件之前重定向 STDERR。像这样：

```
exec('/home/quote2bi/tmp/helloworld.php 2> /dev/null > /tmp/execoutput.txt') 
```

以上应该只将“Hello World”输出到 execoutput。

**编辑：**

有趣的是你得到了这种行为。您说命令“ls”有效。尝试为此创建别名并将其转发到如下文件：

`alias pexec='php /home/quote2bi/tmp/helloworld.php'`

然后

```
exec('pexec > /tmp/execoutput.txt 2>&1 &') 
```

这似乎是 exec 处理输入的方式而不是 shell 本身的问题。

-约翰

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-19T20:59:11.880

问题在于 PHP 本身，它将脚本中的所有内容都视为 $argv。它不会将输出重定向到 /dev/null 的文件。

前段时间我遇到了同样的问题。我所做的是`runscript.php`在 /opt/php-bin 中创建一个，然后在这个脚本中运行它应该运行的内容。像这样的东西：

```
$script = $argv[1]
$params = implode(' ', array_slice($argv, 2));
$cmd    = "{$script} {$params} > /dev/null &";

$output = array();
$return = 0;
exec("php {$cmd}", $output, $return);

exit((int)$return); 
```

然后你调用它使用：

```
exec('/opt/php-bin/runscript.php /path/to/your/script.php arg1 arg2') 
```

这是我设法让它工作的唯一方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T02:04:20.300

为了避免 PHP 在这方面的问题，为什么不把它放在一个 shell 脚本中呢？然后 PHP 可以执行在内部处理所有重定向的 shell 脚本。

如果您需要动态更改内容，那么为什么不编写 shell 脚本然后执行它（当然，事后清理）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-02T18:12:14.790

如果您只是简单地运行 php 脚本，则执行整个代码的一种可能方法是使用 include()，它将运行 php 文件并输出任何结果。您不能将输出定向到文本文件，但如果您是 Hello World php 脚本，它应该出现在浏览器窗口中

```
<?php echo "Hello World!"; ?> 
```

然后它将在浏览器中吐出。所以你的第二个代码看起来像

```
<?php include("helloWorld.php");  echo " PHP ROCKS";?> 
```

产生一个看起来像的页面，

你好世界！PHP 岩石

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-07T06:21:50.750

这就像您从浏览器运行脚本一样运行。

这是在 linux 平台上进行项目时遇到的。

```
exec('wget http://<url to the php script>) 
```

希望这可以帮助！！

# sharepoint - 在 MOSS 发布站点中以高权限运行的方法

> ID：566254
> 
> 赞同：1
> 
> 时间：2009-02-19T17:10:34.790
> 
> 标签：sharepoint, sharepoint-2007, moss

**我想知道为什么下面列出的两种方法没有提供相同的安全调整。**

**预期结果：** 两种方法都可以完全访问*当前网站集中的所有内容*

**实际结果：** 使用方法 #1 时发生安全修整

*   方法#2 适用于从其他网站检索内容，但方法#1 不能。

*   这两种方法都可以在*匿名*模式下跨网络访问，并且都适用于*站点管理员*帐户。

*   不同之处在于*层次结构经理*、*审批者*和*编辑*。方法 #1 不提供跨网络的管理员访问权限。

**方法#1**

```
using (SystemOperation op = new SystemOperation())
{ 
    //Do an operation that requires retrieving across webs
}

public class SystemOperation : IDisposable
{
    private WindowsImpersonationContext ctx;

    public SystemOperation()
    {
        if (!WindowsIdentity.GetCurrent().IsSystem)
        {
            ctx = WindowsIdentity.Impersonate(System.IntPtr.Zero);
        }
    }

    public void Dispose()
    {
        this.Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool all)
    {
        if (ctx != null)
        {
            ctx.Undo();
        }
    }
} 
```

**方法#2：**

```
 Microsoft.Sharepoint.SPSecurity.RunWithElevatedPrivileges(delegate()
    {
        //Do an operation that requires retrieving across webs
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T15:39:14.917

RunWithElevatedPrivileges 提供两个独立的权限。首先是将用户的 Windows 身份提升到 AppPool 帐户，其次是将身份提升到 SharePoint\System 帐户，这是一个提供完全控制（在 SharePoint 意义上）的内置安全帐户。构建 SP 对象（如 SPSite）时使用内部 SharePoint 帐户。

因此，基本上这将取决于您如何构建代码以及何时实例化影响特权如何发挥作用的对象。

# sql - USPS ACS Keyline 校验位

> ID：566258
> 
> 赞同：0
> 
> 时间：2009-02-19T17:11:27.913
> 
> 标签：sql, usps, check-digit

我已经根据他们文档中的方法为美国邮政服务地址更改服务 Keyline 使用 SQL 实现了“MOD 10”校验位算法，但似乎我得到了错误的数字！我们的输入字符串中只有数字，使计算更容易一些。当我将我的结果与他们的测试应用程序的结果进行比较时，我得到了不同的数字。我不明白这是怎么回事？有人看到我的算法有什么问题吗？这一定是显而易见的……

该方法的文档可以在本文档的第 12-13 页找到： [http ://www.usps.com/cpim/ftp/pubs/pub8a.pdf](http://www.usps.com/cpim/ftp/pubs/pub8a.pdf)

示例应用程序可在以下位置找到： [http ://ribbs.usps.gov/acs/documents/tech_guides/KEYLINE.EXE](http://ribbs.usps.gov/acs/documents/tech_guides/KEYLINE.EXE)

**请注意：我根据论坛用户的帮助修复了以下代码。这样未来的读者将能够完整地使用代码。**

```
ALTER function [dbo].[udf_create_acs] (@MasterCustomerId varchar(26))
returns varchar(30)
as
begin
    --this implements the "mod 10" check digit calculation
    --for the US Postal Service ACS function, from "Publication 8A"
    --found at "http://www.usps.com/cpim/ftp/pubs/pub8a.pdf"
    declare @result varchar(30)
    declare @current_char int
    declare @char_positions_odd varchar(10)
    declare @char_positions_even varchar(10)
    declare @total_value int
    declare @check_digit varchar(1)

    --These strings represent the pre-calculated values of each character
    --Example: '7' in an odd position in the input becomes 14, which is 1+4=5
    -- so the '7' is in position 5 in the string - zero-indexed
    set @char_positions_odd = '0516273849'
    set @char_positions_even = '0123456789'
    set @total_value = 0
    set @current_char = 1

    --stepping through the string one character at a time
    while (@current_char <= len(@MasterCustomerId)) begin
        --this is the calculation for the character's weighted value
        if (@current_char % 2 = 0) begin
            --it is an even position, so just add the digit's value
            set @total_value = @total_value + convert(int, substring(@MasterCustomerId, @current_char, 1))
        end else begin
            --it is an odd position, so add the pre-calculated value for the digit
            set @total_value = @total_value + (charindex(substring(@MasterCustomerId, @current_char, 1), @char_positions_odd) - 1)
        end

        set @current_char = @current_char + 1
    end

    --find the check digit (character) using the formula in the USPS document
    set @check_digit = convert(varchar,(10 - (@total_value % 10)) % 10)

    set @result = '#' + @MasterCustomerId + '   ' + @check_digit + '#'

    return @result
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T17:48:00.300

当您使用基于集合的语言时，我不确定您为什么要搞乱整个字符串表示。

我可能会像下面那样做。我进行了四次测试，它们都成功了。您也可以轻松扩展它以处理字符，如果您真的想这样做，您甚至可以使表格永久化。

```
CREATE FUNCTION dbo.Get_Mod10
(
    @original_string    VARCHAR(26)
)
RETURNS VARCHAR(30)
AS
BEGIN
    DECLARE
        @value_mapping TABLE (original_char CHAR(1) NOT NULL, odd_value TINYINT NOT NULL, even_value TINYINT NOT NULL)

    INSERT INTO @value_mapping
    (
        original_char,
        odd_value,
        even_value
    )
    SELECT '0', 0, 0 UNION
    SELECT '1', 2, 1 UNION
    SELECT '2', 4, 2 UNION
    SELECT '3', 6, 3 UNION
    SELECT '4', 8, 4 UNION
    SELECT '5', 1, 5 UNION
    SELECT '6', 3, 6 UNION
    SELECT '7', 5, 7 UNION
    SELECT '8', 7, 8 UNION
    SELECT '9', 9, 9

    DECLARE
        @i              INT,
        @clean_string   VARCHAR(26),
        @len_string     TINYINT,
        @sum            SMALLINT

    SET @clean_string = REPLACE(@original_string, ' ', '')
    SET @len_string = LEN(@clean_string)
    SET @i = 1
    SET @sum = 0

    WHILE (@i <= @len_string)
    BEGIN
        SELECT
            @sum = @sum + CASE WHEN @i % 2 = 0 THEN even_value ELSE odd_value END
        FROM
            @value_mapping
        WHERE
            original_char = SUBSTRING(@clean_string, @i, 1)

        SET @i = @i + 1
    END

    RETURN (10 - (@sum % 10)) % 10
END
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T17:26:02.697

为什么我们有一个额外的模组：

转换（varchar，**10％** <<--？

文件说只需要从 10 中减去最后一位。我错过了什么吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T17:33:49.713

```
set @check_digit = convert(varchar, (10 - (@total_value % 10)) % 10) 
```

# visual-c++ - 如何以编程方式确定是否安装了 Visual C++ Runtime 8.0？

> ID：566259
> 
> 赞同：8
> 
> 时间：2009-02-19T17:11:38.677
> 
> 标签：visual-c++, installation, runtime, installshield, prerequisites

我有一个 InstallShield 安装，它使用依赖于 Visual C++ Runtime 8.0 sp1 的自定义操作。过去，我可以使用 Microsoft 提供的合并模块和 Visual Studio 来安装运行时。根据 Visual C++ Runtime 8.0 sp1 并行安装在 Vista 上的工作方式，在安装的提交顺序之前无法使用运行时。

这意味着我必须要么将我的自定义操作的执行移至提交序列（不受欢迎，因为如果出现问题，安装无法在此序列期间回滚），要么在安装之前使用 InstallShield 先决条件安装 Visual C++ 运行时.

我更愿意安装 Visual C++ Runtime 作为先决条件，但 InstallShield 不提供此先决条件，因此我必须自己编写。我能够弄清楚如何配置安装运行时的先决条件，但我不知道如何确定它是否已经安装。是否有我可以检查的注册表项或文件版本来确定这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-20T15:11:41.957

[我找到了描述检测Visual C++ Runtime 8.0](http://blogs.msdn.com/astebner/archive/2007/01/16/mailbag-how-to-detect-the-presence-of-the-vc-8-0-runtime-redistributable-package.aspx)和[Visual C++ Runtime 8.1](https://blogs.msdn.com/astebner/archive/2007/01/24/updated-vc-8-0-runtime-redistributable-packages-are-included-in-visual-studio-2005-sp1.aspx)的博客文章。基本上，您可以使用 MSI 自动化接口来查找每个运行时的产品代码。

您还可以查找**HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\[ProductCode]**其中 [ProductCode] 是您尝试检测的运行时的产品代码（例如 {7299052b-02a4-4627-81f2- 1818da5d550d} 是 x86 版本 8.0 sp1 运行时的产品代码）。

这些方法仅用于检测是否安装了运行时可再发行包；即使这些方法没有表明，也有可能安装运行时（例如，如果它是作为合并模块安装而不是使用可再发行组件），但在这种情况下安装可再发行软件包不会有任何损害.

# javascript - 可以使用画布标签在页面上的其他项目之上绘制吗？

> ID：566261
> 
> 赞同：4
> 
> 时间：2009-02-19T17:11:47.710
> 
> 标签：javascript, html, canvas

可以将 HTML 画布标签定位在页面上的其他 html 内容之上吗？例如，下面的 CSS 声明会让 canvas 标签做我期望的事情吗？

```
canvas.mycanvas {
  position: absolute;
  background: transparent;
  z-index: 10;
  top: 10px; left: 10px;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T17:21:35.233

那应该可以完美地工作。不过，无需将背景设置为“透明”。

覆盖画布是[这个小书签](http://www.westciv.com/mri/)的工作原理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T19:13:11.977

是的，这在支持画布的浏览器中工作得很好，而且在 IE6 和 IE7 中也同样工作，使用 exCanvas 项目将画布命令翻译成微软基于 XML 的矢量语言 VML。

在尝试跨浏览器覆盖画布元素时，我注意到的一件事是，您必须特别注意追加和随后访问任何画布子 DOM 节点的顺序。IE 需要先附加该项目，然后才能使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T17:24:21.133

你试过吗？它不工作吗？我会说画布标签将充当任何其他标签并适当地定位。如果你想用一种简单的方法在 Firefox 中测试它，请到这里[http://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_canvas](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_canvas)

# linux - ISP 到 ISP 的快速文件传输？

> ID：566262
> 
> 赞同：0
> 
> 时间：2009-02-19T17:11:52.157
> 
> 标签：linux, networking, sysadmin, data-transfer

Jeff Atwood 谈到了进行 ISP 到 ISP 的文件传输：

[http://friendfeed.com/e/63fb9e72-6cd5-a8ac-88dc-02ce720033f9/wow-just-did-an-isp-to-isp-file-transfer-650mb-in/](http://friendfeed.com/e/63fb9e72-6cd5-a8ac-88dc-02ce720033f9/wow-just-did-an-isp-to-isp-file-transfer-650mb-in/)

这是什么？我尝试用谷歌搜索它，但找不到任何东西。我们需要在两个数据中心之间传输大量数据，这听起来很有趣。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T17:17:21.233

他只是说他在大型互联网连接（OC-1 等）后面的 2 台服务器之间传输数据。特别是在 2 个数据中心之间，这些数据中心通常具有以 gbits 为单位的互联网连接。

我不认为他的意思是他正在使用某种特殊的连接。只需使用服务器提供的大带宽端口来传输数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-09T09:02:44.013

您应该考虑使用基于 UDT/UDP 的交付解决方案在几个位置之间转移数据。

[http://udt.sourceforge.net/](http://udt.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T17:25:01.743

[另请参阅他最近关于带宽经济学的](http://www.codinghorror.com/blog/archives/000783.html)博客文章。

它基本上意味着使用主要的互联网骨干网，而不是通过标准渠道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T17:33:13.330

如果服务器允许，FTP 可用于直接将数据从一台服务器传输到另一台服务器。它被称为代理 FTP 或第三方 FTP。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T22:31:48.627

[FXP](http://en.wikipedia.org/wiki/File_eXchange_Protocol)可能就是您的想法。这个想法是您的 FTP 客户端告诉“FTP 服务器 A”从“FTP 服务器 B”获取文件。理论上是个好主意，但它非常不安全，因此您永远找不到启用 FXP 的 ISP。

# java - 具有大量实体的 Ehcache / Hibernate 和 RMI 复制

> ID：566264
> 
> 赞同：8
> 
> 时间：2009-02-19T17:12:56.247
> 
> 标签：java, hibernate, replication, ehcache

我目前正在研究如何在 ehcache 中使用 RMI 分发选项。我已经正确配置了 ehcache.xml 并且复制似乎工作正常。但是我有两个问题：

-> ehcache/hibernate 似乎为每个实体创建 1 个缓存。这很好，但是当复制到位时，它会创建 1 个线程/缓存来复制。这是预期的行为吗？由于我们的域很大，它创建了大约 300 个线程，这在我看来真的很大

-> 另一个令人讨厌的后果是心跳消息似乎聚合了所有这些缓存名称。从我看到的消息应该适合 1500 字节，但它不适合，这导致我的日志中出现这条消息：心跳不工作。为复制配置更少的缓存。大小为 1747 但不应大于 1500。关于如何改变的任何想法？

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T09:17:27.227

我们已经有了一个 hack，我们拥有自己的 hibernate EhCacheProvider 的自定义副本，它覆盖 buildCache() 以创建我们自己的具有缩短名称（名称的哈希）的 Cache 对象。这达到了 1500 的限制。我们保留原始名称的哈希图和哈希名称以进行反向查找。

我们不久前就这样做了，并且一直在生产中使用它。

我们还查看了您的其他问题，以获得单个复制器线程。首先，我们复制了 RMICacheReplicatorFactory 并更改了 createCacheEventListener() 以返回我们通过将 replicationThread 字段设为静态然后对其进行必要修复来修改的 RMIAsynchronousCacheReplicator 副本。我们没有彻底测试它或将其投入生产，但正在再次查看它，这就是我找到这篇文章的方式:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T06:22:38.813

您是否考虑过将 JBossCache 作为 EHcache 的替代品？JBossCache 具有分布式事务，并且经过良好的高负载测试。它具有较低级别的复制机制，可以让您使用 UDP 或 TCP 多播/广播复制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T20:25:38.397

您是否考虑过 EHCache 而不是 Terracotta？看看[Terracotta Hibernate 集成](http://www.terracotta.org/web/display/orgsite/Hibernate+Integration)和[Terracotta EHCache 集成](http://terracotta.org/web/display/orgsite/EHCache+Integration)

重要的是，Terracotta 分布式 EHCache 是一致的 - 所有节点都具有相同的缓存视图。这对于我使用的其中一个应用程序非常重要。

看一看。它对我们来说就像一个魅力。

/RS

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T08:07:37.687

jms复制是一种选择吗？

（我一直在考虑将它与异步行为一起使用，它工作得很好。文档有误，所以我不得不检查源代码以查看正确配置它所需的实际属性。jms 的好处是，如果你有那个基础设施设置您无需配置任何防火墙等即可让它通过。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-06T19:32:08.140

顺便说一句，ehcache-core 的 Ehcache 1.7.1 版本已经解决了 1500 字节的限制。参见[EHC-424](https://jira.terracotta.org/jira/browse/EHC-424)。

# iphone - 在 iPhone 上检索当前本地时间？

> ID：566265
> 
> 赞同：32
> 
> 时间：2009-02-19T17:12:58.650
> 
> 标签：iphone, ios, objective-c, cocoa-touch

我正在寻找用户 iPhone 上的当前小时和分钟，以便在不显示状态栏的应用程序中显示。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-10-23T06:29:36.617

```
// get current date/time
NSDate *today = [NSDate date];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
// display in 12HR/24HR (i.e. 11:25PM or 23:25) format according to User Settings
[dateFormatter setTimeStyle:NSDateFormatterShortStyle];
NSString *currentTime = [dateFormatter stringFromDate:today];
[dateFormatter release];
NSLog(@"User's current time in their preference format:%@",currentTime); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-14T06:44:31.873

```
-(void)currentTime
{    
    //Get current time
    NSDate* now = [NSDate date];
    NSCalendar *gregorian = [[NSCalendar alloc] initWithCalendarIdentifier:NSCalendarIdentifierGregorian];
    NSDateComponents *dateComponents = [gregorian components:(NSCalendarUnitHour  | NSCalendarUnitMinute | NSCalendarUnitSecond) fromDate:now];
    NSInteger hour = [dateComponents hour];
    NSString *am_OR_pm=@"AM";

    if (hour>12)
    {
        hour=hour%12;

        am_OR_pm = @"PM";
    }

    NSInteger minute = [dateComponents minute];
    NSInteger second = [dateComponents second];
    [gregorian release];

    NSLog(@"Current Time  %@",[NSString stringWithFormat:@"%02ld:%02ld:%02ld %@", (long)hour, (long)minute, (long)second,am_OR_pm]);
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-06-29T03:23:47.490

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateStyle:NSDateFormatterMediumStyle];
[dateFormatter setTimeStyle:NSDateFormatterMediumStyle];
[dateFormatter setTimeZone:[NSTimeZone localTimeZone]];
NSString *currentTime = [dateFormatter stringFromDate:[NSDate date]]
[dateFormatter release]; dateFormatter = nil; 
```

我认为你应该试试这个。时区很重要。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-19T17:20:51.783

请参阅[此](https://stackoverflow.com/questions/358207/iphone-how-to-get-current-milliseconds)类似问题以获取答案。您必须将其更改为您的日期格式。

```
[[NSDate date] timeIntervalSince1970];
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-11-26T12:13:42.873

如果您要计算时间间隔，最好使用[CACurrentMediaTime](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreAnimation_functions/Reference/reference.html)

```
double currentTime = CACurrentMediaTime(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-23T17:20:34.873

更短的方法

```
NSDate * now = [NSDate date];
timeLabel.text = [NSDateFormatter localizedStringFromDate:now
                                                dateStyle:NSDateFormatterNoStyle
                                                timeStyle:NSDateFormatterShortStyle]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-05T09:51:04.520

## [CFAbsoluteTimeGetCurrent()](https://developer.apple.com/library/mac/documentation/CoreFoundation/Reference/CFTimeUtils/#//apple_ref/c/func/CFAbsoluteTimeGetCurrent)

> 绝对时间以相对于绝对参考日期 2001 年 1 月 1 日 00:00:00 GMT 的秒数为单位测量。正值表示参考日期之后的日期，负值表示参考日期之前的日期。例如，绝对时间 -32940326 相当于 1999 年 12 月 16 日 17:54:34。重复调用此函数并不能保证结果单调递增。由于与外部时间参考同步或由于用户明确更改时钟，系统时间可能会减少。

# css - 需要一点 CSS 建议

> ID：566267
> 
> 赞同：1
> 
> 时间：2009-02-19T17:13:58.793
> 
> 标签：css, internet-explorer, navigation, suckerfish

我为个人项目创建了一个修改版的吸盘鱼导航。它的外观和性能完全符合我的要求。但是，它在 IE 中完全降级。我昨天花了一整天的时间试图找到一个没有运气的解决方案。所以我想我会问一些比我自己更敏锐的头脑。我现在对任何事情都持开放态度。就目前而言，该页面是有效的 HTML 和 CSS。

提前致谢。

导航可以在这里找到：
[http ://rachalconsulting.com/assets/samples/](http://rachalconsulting.com/assets/samples/)

样式表在这里：
[http ://rachalconsulting.com/assets/samples/style.css](http://rachalconsulting.com/assets/samples/style.css)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T17:20:45.357

我遇到了同样的问题，结果证明是使用[csshover.htc 文件](http://www.tanfa.co.uk/css/examples/menu/tutorial-h.asp)。

# jquery - 无法使用变量设置 CSS - jquery

> ID：566271
> 
> 赞同：2
> 
> 时间：2009-02-19T17:16:46.723
> 
> 标签：jquery

我正在尝试使用从用户键入文本字段中检索的变量动态设置 css。

这是代码行：

```
$(get_elem_hierarchy()).css($(this).data('theCss').theProp, $(this).data('theCss').theVal); 
```

一切正常。css 属性和 css 值都正确跟踪到控制台，但无论出于何种原因，它都不会设置它。如果我硬编码它工作正常。

我也尝试在这些引号周围加上引号，但这也不起作用，所以这不是问题。

我错过了什么吗？我已经查看了所有内容，找不到任何与讨论这个问题很接近的东西，所以也许我以错误的方式解决这个问题。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-19T17:45:50.610

您使用 .data() 是否有特定原因？根据[jQuery](http://docs.jquery.com/Internals/jQuery.data)网站 -

> **jQuery.data（元素）**
> 
> **返回元素的唯一 ID。**
> 
> 通常这个函数只会在内部使用。您可能不会以这种方式使用 data() 方法。在使用其他 data() 功能时，它会在必要时自动调用。

我已经设置了[一个示例](http://jsbin.com/ezeke)，说明如何在 2 个输入框中键入 CSS 名称和值，然后将它们应用于 div，以验证您是否可以使用变量设置 CSS。

[**您可以在此处编辑和使用示例**](http://jsbin.com/ezeke/edit)。

如您所见，它使用 jQuery.val() 命令从每个文本框中获取文本并将每个文本分配给一个变量。这是你打算做的吗？

**编辑：**

[**此处修改示例**](http://jsbin.com/iyuwi)

它使用 textarea 进行输入并允许您指定多个 css 属性。这是因为 jQuery.css() 可以接受一个对象作为参数，所以我们根据 textarea 值构建一个具有属性及其各自值的对象，然后将该对象传递给 jQuery.css() 命令。只需在文本区域中指定属性，就像在 CSS 样式标签中一样，即

```
background-color: red; height: 500px; width: 300px; 
font-size: 20px; color: white; 
```

并且所有都将应用于`<div>`with`id="mydiv"`

jQuery代码在这里 -

```
$(function() {

    $('#mybutton').click(function(e) {

    var cssObject = {},
        cssName = null,
        cssValue = null;

    var cssAttributeString = $('#value').val();
    var cssAttributeArray = cssAttributeString.split(";");

    for (var i = 0 ; i < cssAttributeArray.length ; i++){
        cssName = $.trim(cssAttributeArray[i].substring(0,cssAttributeArray[i].indexOf(":")));
        cssValue = $.trim(cssAttributeArray[i].substring(cssAttributeArray[i].indexOf(":") + 1, cssAttributeArray[i].length)); 
        cssObject[cssName] = cssValue;    
    }

    $('#mydiv').css(cssObject);

    });

}); 
```

# java - 奇怪的 JUnit 日志记录行为

> ID：566275
> 
> 赞同：4
> 
> 时间：2009-02-19T17:17:42.077
> 
> 标签：java, logging, junit

我注意到在 JUnit 测试期间使用标准日志记录有一些奇怪的行为。JUnit 是否将标准输出重定向到不同的流？我怎样才能访问它？

这是一个简单的 JUnit 测试，演示了我所描述的行为。

```
@Test
public void logMessage() {
    // set up new logger with output directed to standard out
    Logger logger = Logger.getLogger("my.test.logger");
    logger.addHandler(new StreamHandler(System.out, new SimpleFormatter()));

    // log a warning message
    logger.warning("logger message"); // message 1

    // turn off parent handlers
    logger.setUseParentHandlers(false);

    // log a second warning message
    logger.warning("second logger message"); // message 2

    // print somehting to standard output
    System.out.println("standard output message");  //message 3
} 
```

请注意，我创建了一个新的记录器，它只是将其日志消息发送到标准输出 (System.out)。

这是 Junit 输出

```
Testsuite: com.my.FormatterTest
Feb 19, 2009 12:02:33 PM com.my.FormatterTest logMessage
WARNING: logger message
standard output message
Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.079 sec

------------- Standard Output ---------------
standard output message
------------- ---------------- ---------------
------------- Standard Error -----------------
Feb 19, 2009 12:02:33 PM com.my.FormatterTest logMessage
WARNING: logger message
------------- ---------------- ---------------
Feb 19, 2009 12:02:33 PM com.my.FormatterTest logMessage
WARNING: logger message
Feb 19, 2009 12:02:33 PM com.my.FormatterTest logMessage
WARNING: second logger message
test:
BUILD SUCCESSFUL (total time: 2 seconds) 
```

为什么***消息 1***或***消息 2***不显示在 JUnit 输出的***标准输出***部分中？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-19T17:38:32.133

正如您间接建议的那样，junit 测试运行程序在测试运行时将 stdout 和 stderr 重定向到单独的流。您的记录器通常在此重定向发生之前初始化，这意味着它使用常规 System.out/System.err 来记录到控制台。

通过查看 JunitTestRunner 类的源代码可以很容易地看到这一点。

**编辑：** 我看过一些源代码，因为你的问题让我很好奇。我不知道您使用的是哪个 TestRunner，答案可能就在那里；流重定向等不是 junit 框架的一部分，而是由 ant/eclipse/maven/idea 实现的。*看起来*你addHandler 没有任何效果 whatsovever ，所以我怀疑有什么东西正在拦截它（如果*所有*日志记录都是由父记录器完成的，你的输出将是合乎逻辑 的）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T18:02:21.530

[**krosenvold 的**评论](https://stackoverflow.com/questions/566275/weird-junit-logging-behavior/566364#566364)让我找到了正确的答案（谢谢！）。

似乎 stdout 实际上被重定向到另一个（JUnit）流。然而，真正的问题是，StreamHandler 的缓冲区直到 stdout 被重置为其原始输出流之后才被刷新*（*导致日志消息没有出现在 JUnit 的 stdout 输出中）。将代码更改为以下代码会产生正确的行为。

```
@Test
public void logMessage() {
    // set up new logger with output directed to standard out
    Logger logger = Logger.getLogger("my.test.logger");
    StreamHandler sh = new StreamHandler(System.out, new SimpleFormatter());
    logger.addHandler(sh);

    // log a warning message
    logger.warning("logger message"); // message 1

    // turn off parent handlers
    logger.setUseParentHandlers(false);

    // log a second warning message
    logger.warning("second logger message"); // message 2

    // print somehting to standard output
    System.out.println("standard output message");  //message 3

    // FLUSH THE STREAM HANDLER !!!
    sh.flush();
} 
```

产量

```
Testsuite: com.my.FormatterTest
Feb 20, 2009 12:58:17 PM com.my.FormatterTest logMessage
WARNING: logger message
standard output message
Feb 20, 2009 12:58:17 PM com.my.FormatterTest logMessage
WARNING: logger message
Feb 20, 2009 12:58:17 PM com.my.FormatterTest logMessage
WARNING: second logger message
Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.078 sec

------------- Standard Output ---------------
standard output message
Feb 20, 2009 12:58:17 PM com.my.FormatterTest logMessage
WARNING: logger message
Feb 20, 2009 12:58:17 PM com.my.FormatterTest logMessage
WARNING: second logger message
------------- ---------------- ---------------
------------- Standard Error -----------------
Feb 20, 2009 12:58:17 PM com.my.FormatterTest logMessage
WARNING: logger message
------------- ---------------- ---------------
test:
BUILD SUCCESSFUL (total time: 2 seconds)
time: 2 seconds) 
```

# http - 哪两个分隔符可以在 URL 锚点中使用？

> ID：566276
> 
> 赞同：9
> 
> 时间：2009-02-19T17:17:55.803
> 
> 标签：http, url, parsing, anchor

我在我的 URL 中使用锚点，允许人们在 Web 应用程序中为“活动页面”添加书签。我使用锚点是因为它们很容易适应 GWT 历史机制。

我现有的实现将导航和数据信息编码到锚点中，由“-”字符分隔。即创建像 #location-location-key-value-key-value 这样的锚点

除了负值（如 -1）会导致严重的解析问题之外，它确实有效，但现在我发现使用两个分隔符会更好。另外，给出负数问题，我想放弃使用'-'。

还有哪些其他字符在不会干扰 URL 或其 GET 参数的 URL 锚点中起作用？这些在未来会有多稳定？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-19T17:47:56.540

查看[RFC for URLs，第 3.5 节](https://www.rfc-editor.org/rfc/rfc3986#section-3.5)片段标识符（我相信您指的是）被定义为

```
片段 = *( pchar / "/" / "?" )

```

并来自[附录 A](https://www.rfc-editor.org/rfc/rfc3986#appendix-A)

```
pchar = unreserved / pct-encoded / sub-delims / ":" / "@"
未保留 = ALPHA / DIGIT / "-" / "." /“_”/“~”
子分隔符=“！” / "$" / "&" / "'" / "(" / ")"
                 /“*”/“+”/“,”/“;” /“=”

```

有趣的是，规范还说

“允许使用斜杠 ("/") 和问号 ("?") 字符来表示片段标识符内的数据。”

所以看起来真正的主播，比如

```
<a href="#name?a=1&b=2">
....
<a name="name?a=1&b=2"> 
```

应该是合法的，并且非常类似于普通的 URL 查询字符串。（快速检查验证这些至少在 chrome、firefox 和 ie 中确实可以正常工作）因为这有效，我假设你可以使用你的方法来拥有像这样的 URL

http://www.site.com/foo.html?real=1¶meters=2 **#fake=2¶meters=3**

没有问题（例如，片段中的“参数”变量不应干扰查询字符串中的变量）

您还可以在必要时使用百分比编码......并且在子分隔符中定义了许多其他可用的字符。

笔记：

同样来自规范：

“片段标识符组件由数字符号 (“#”) 字符的存在指示，并以 URI 结尾终止。”

所以 # 之后的所有内容都是片段标识符，不应干扰 GET 参数。

# .net - Silverlight 开发 - 本地开发时的服务 URL

> ID：566290
> 
> 赞同：1
> 
> 时间：2009-02-19T17:21:17.463
> 
> 标签：.net, silverlight

开发 Silverlight 应用程序（即 Silverlight 项目和 Web 应用程序在一个解决方案中）的正确模式或方法是什么？我的意思是，如果 localhost 端口号会不断变化，您如何添加服务参考？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-21T18:30:31.867

喜欢这个： [http ://forums.silverlight.net/forums/t/19021.aspx](http://forums.silverlight.net/forums/t/19021.aspx)

不要依赖在 ServiceReference.ClientConfig 中设置的 URL。在代码中设置您的 URL。将您的 WebService Calling 代码更改为以下内容：

```
 var webService = new YourWebService.YourWebServiceClient() // This is the default constructor, url will be read from the clientconfig file.

      Uri address = new Uri(Application.Current.Host.Source, "../YourService.svc"); // this url will work both in dev and after deploy.

      var webService = new YourWebService.YourWebServiceClient("YourServiceEndPointName", address.AbsolutePath); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T17:27:14.350

如果您在解决方案资源管理器中选择 Web 项目，则可以在“属性”工具窗口中更改一个属性，该属性将阻止端口更改。该属性称为[“使用动态端口”](http://msdn.microsoft.com/en-us/library/ms178109.aspx)，您希望将其设置为 false，以便端口保持静态。

您还可以在这些设置中指定端口号。

请注意，这不在项目的属性页中，而是在“属性”工具窗口中（这可能是它很难找到的原因——我自己花了一些时间来解决这个问题）。

### 更新

为了在部署和开发之间切换，我倾向于指定两个 SOAP 绑定，然后用于`#ifdef DEBUG`根据构建类型切换我的 SOAP 客户端的绑定。DEBUG 构建指向开发服务，RELEASE 构建指向部署的服务。

所以，我的 ClientConfig 是这样的：

```
<configuration>
  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="Soap_Debug" maxBufferSize="2147483647"
          maxReceivedMessageSize="2147483647">
          <security mode="None" />
        </binding>
        <binding name="Soap_Release" maxBufferSize="2147483647"
          maxReceivedMessageSize="2147483647">
          <security mode="None" />
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://www.mymadeupurl.com/myservices.asmx"
        binding="basicHttpBinding" bindingConfiguration="Soap_Release"
        contract="MyServices.MyServicesSoap" name="Soap_Release" />
      <endpoint address="http://localhost:1929/mydservices.asmx"
        binding="basicHttpBinding" bindingConfiguration="Soap_Debug"
        contract="MyServices.MyServicesSoap" name="Soap_Debug" />
    </client>
  </system.serviceModel>
</configuration> 
```

我像这样创建 SOAP 客户端的实例：

```
#if DEBUG
   // localhost hosts the web services in debug builds.
   soapClient = new MyServicesSoapClient("Soap_Debug");
#else
   // The web services are hosted in a different location for release builds.
   soapClient = new MyServicesSoapClient("Soap_Release");
#endif 
```

# sql-server - SSAS 和 SSRS 中的维度安全性

> ID：566296
> 
> 赞同：0
> 
> 时间：2009-02-19T17:21:58.713
> 
> 标签：sql-server, sql-server-2005, reporting-services, ssas, reportingservices-2005

我遇到了在 SSAS 中在维度级别实施安全性的问题。这就是我所做的 - 1\. 在 SSAS 中定义一个角色并在维度级别应用安全性（取消选中我不希望该角色访问的多维数据集维度并设置允许和拒绝集）。2\. 使用 Cube Browser 测试，运行良好。3.使用SSRS测试，没有变化，我仍然能够查询维度并得到我不想要的结果。

问题 - 是否可以将我在 Cube 级别定义的安全性传播到 SSRS？我愿意相信是的。

如果是，那么这就是我需要的 -

1.  用户将使用 Windows 身份登录到报告管理器（IIS 上的集成身份验证已打开 - 完成）
2.  捕获此身份以找出他们所属的 SSAS 角色 - 我想这将通过查询，似乎不会自动工作（如何做到这一点？）
3.  用户在 SSRS（应用于 SSAS 级别的基于角色的安全性）中此角色的限制范围内工作，即如果维度 X 对用户不可用，他/她应该无法查询它。（这个怎么做？）

我已经参考了很多博客，甚至找到了一个 - [http://www.sqlmag.com/Article/ArticleID/96763/sql_server_96763.html](http://www.sqlmag.com/Article/ArticleID/96763/sql_server_96763.html)

但是这个似乎有更多关于如何在 SSAS 中设置它的信息，而不是如何在 SSRS 中使用它。

任何研究过这种方法或对此有所了解的人请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T07:14:33.827

我认为您需要查看报表服务器上 SSRS 中的数据源，并确保将其设置为使用登录用户的 windows cred 身份验证后，这可能就是您要查找的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T21:41:36.187

您需要做的就是：

在 SSRS 报告的数据源中，指定在 SSAS 数据库中创建的角色名称，如下所示：

数据源=LOCALHOST；初始目录=XXXXX；角色=角色名称

谢谢萨米尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-21T18:34:28.683

我没有在 SSAS 中这样做，但我已经在引擎中完成了。Jeremiah Peschka 有一个[关于基于行的安全设置的博客](http://facility9.com/2009/02/04/row-based-security/)，如果您打算使用集成的 Windows 安全性来执行此操作，那么您可以使用 user_name() 函数来获取当前登录名。您将为每个维度使用一个查找表，其中每个维度行都有一行加上用户名。查询时，像这样加入维度安全表：

```
FROM dbo.Customers cs
INNER JOIN dbo.CustomersSecurity css ON cs.CustomerId = css.CustomerId AND css.UserName = User_Name() 
```

这样，您的加入将只返回用户可以看到的客户的记录。

缺点是如果您使用分区，引擎将无法构建一个好的执行计划，仅根据您的用户可以看到的内容从正确的分区中提取正确的记录。例如，如果您以只能查看佛罗里达州记录的用户身份登录，并且您的数据按州进行了分区，这无关紧要 - 引擎仍会扫描所有分区，因为它无法预测构建计划时的用户信息。

# vb.net - 在 VS2005 中强制重新加载引用的 .Net 组件

> ID：566297
> 
> 赞同：1
> 
> 时间：2009-02-19T17:21:59.943
> 
> 标签：vb.net, reference, reload

我们有一个 VB 项目，它加载对 .Net dll（我们也制作）的引用。这两个项目正在同时开发中。

当我们向引用的 dll 中添加新类时，主项目通常不会注意到这些变化。

也就是说，如果我们向 Foo dll 添加一个新的类 Bar，我们应该能够键入“Foo”。并在智能感知下拉列表中列出 Bar。它永远不存在。

删除引用然后重新添加它有时可以解决问题。有时我们可以手动输入 Bar 然后重建而不会出错。

在我看来，应该有某种方法告诉 Visual Studio 重新加载引用的项目，因为它已经改变了。实际上，我认为 VS 应该注意到更改本身，但如果做不到这一点，我们需要一种简单的方法来强制重新加载。

有什么建议么？

**编辑：**它是 VS2005，我们正在引用输出程序集（dll）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T18:38:23.480

我曾经遇到过这个问题。将两个项目放入一个解决方案中。在解决方案资源管理器中右键单击解决方案，然后设置构建顺序。使主项目依赖于 .DLL。现在，当您重新构建解决方案时，首先构建 .DLL，主项目将看到所有更改。

编辑：另外，将 .DLL 作为项目引用，而不是在选择引用时选择浏览。然后，主项目应立即识别更改，而无需重新构建。

# usability - 如何让客户相信他想要的东西是坏事？

> ID：566299
> 
> 赞同：15
> 
> 时间：2009-02-19T17:23:52.990
> 
> 标签：usability

例如，我们为其创建网站的客户提出以下要求：

*   所有链接都应在新窗口中打开
*   在每个页面上放置自定义“返回”按钮，同时有一个工作浏览器的等效项
*   使文本的某些部分闪烁等。

当然，我会告诉他们这是错误的，但是我可以从受人尊敬的来源那里找到一些不错的坏事清单吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-19T17:32:00.037

成为受人尊敬的来源。说真的：如果您的客户不愿意直接接受您的建议，请撰写说明用户界面设计好坏的文档并将其发布在您的网站上。你从中得到三样东西：

1.  你*会*更加了解设计不好和好的*原因*。必须仔细考虑将其组合成文档比许多人认为的更有帮助。

2.  如果这是公开发布的，您可能会收到有关您的想法的反馈。扔掉不好的建议，整合好的建议，你的手艺就会变得更好。

3.  你有这些讨论的来源，格式很漂亮，但你保留了你所有的个人品牌。如果你包含好的和坏的例子和演示，大多数人都会明白你为什么提倡你的想法。

编辑：就与客户互动的“降压停在这里”方面而言，epotter 已经死了。如果您的文档可以说明为什么从长远来看激怒用户会导致收入损失，那么您不太可能会遇到很多回击。另一方面，如果您的个人偏好包括无助于保留的 UI 设计*......*停止这样做。（我记得在 CSS 成熟之前“只有 CSS，没有表格”的设计师的日子：他们坚持将他们的设计强加给客户端，即使在某些浏览器中他们的渲染效果不佳。虽然一个原因令人钦佩，但你为*客户*不是原因。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-19T17:29:42.640

始终尝试向他们展示这将如何花费他们的钱。例如，如果他们要做一些惹恼用户的事情，他们的流量就会减少，从而导致收入减少。

无论好坏，美元总是最响亮的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-19T17:50:43.420

首先，不要告诉他们这是错误的。

他们可能会亲自处理。

相反，了解他们试图满足的需求，然后提出不包括不良行为的替代方案。模拟所有的选择，并指出每一个的好与坏。让他们选择。只要你有一个好的替代方案，并且充分指出了糟糕实现的错误，那么它们通常会出现在你的观点中。

换句话说，像设计师一样行事。当客户说“我想要红色背景上的绿色文字”时，您不会立即告诉他们世界上 10% 的男性无法阅读，您首先需要了解原因。“嗯，现在是圣诞节”，然后您可以建议其他主题，让网站在没有设计错误的情况下营造出节日气氛。只要您建议的模型比他们的更好，那么他们通常会默认。

**不是因为他们犯了错误，而是因为你看到了他们的*真正*需求并改进了他们的想法。**

但是，如果他们在那之后坚持不懈，那就去做吧——不要花时间试图让他们相信他们的设计意识是错误的，这是对资源的浪费。

*长期教育他们，但如果你需要一个小时来说服他们不要做出改变，那么你本可以花一个小时来改善与将你视为设计师而不是网络猴子的客户的关系。*

-亚当

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-19T17:33:25.873

我不得不在网络项目中扮演半销售角色，我必须强调让客户满意是多么重要。

尽管如此，我完全同意你的观点，你有义务以给他们想要的东西的名义说些什么。我总是发现最好的方法是从同意他们开始（至少在原则上）。你可以说，

> “我完全同意你的观点，这个文本对你的用户来说非常重要。我合作过的许多测试人员都非常喜欢使用这种字体/图形/颜色来标注关键文本。不幸的是，一些用户将闪烁的文本与广告和躲开它”

我发现这种方法让他们知道你

1.  了解他们想要什么
2.  欣赏他们的动机和建议
3.  只想帮忙

最后一句忠告，如果在轻推之后，他们不明白这一点，考虑做两个快速模型。（他们的想法和你的）。如果这不起作用，那么就给他们他们想要的东西。最后，他们支付了账单，如果他们真的想要一个丑陋的网站（假设你不能因为美观而拒绝业务），就给他们这个网站。

祝你好运，深呼吸！

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-19T17:34:06.263

多年来，Jakob Nielsen 的 Alertbox 一直是我宝贵的常识性可用性建议来源。这[是他](http://www.useit.com/alertbox/9612.html)在 1996 年写的一段话，今天仍然适用：

> BACK 功能是一个绝对必要的安全网，让用户有信心自由导航，因为他们知道他们总是可以回到坚实的基础。我们从对用户导航行为的一些最早的研究中知道，返回是 Web 浏览器中使用次数第二多的导航功能（在简单的“单击链接以跟随它”操作之后）。因此，打破 BACK 按钮不亚于可用性灾难。

[**以下是他在1999 年**](http://www.useit.com/alertbox/990530.html)[的十大网页设计错误中](http://www.useit.com/alertbox/990530.html)**的前两个：**

 **> **打破或减慢后退按钮**
> 
> Back 按钮是 Web 用户的生命线，也是使用次数第二多的导航功能（在跟随超文本链接之后）。用户很高兴地知道他们可以在 Web 上尝试任何东西，并且总是通过单击一两次返回来保存以将他们返回到熟悉的领域。
> 
> 当然，除了那些通过犯下以下设计罪之一来破坏的网站：
> 
> *   打开一个新的浏览器窗口（见错误 #2）
> *   使用立即重定向：每次用户单击“返回”时，浏览器都会返回一个页面，该页面会将用户转发到不希望的位置
> *   防止缓存，这样后退导航需要重新访问服务器；所有超文本导航都应该是亚秒级的，这对于回溯来说是双倍的
> 
> **打开新的浏览器窗口**
> 
> 打开新的浏览器窗口就像真空吸尘器销售人员通过清空客户地毯上的烟灰缸开始拜访。不要再用任何窗口污染我的屏幕，谢谢（特别是因为当前操作系统的窗口管理很糟糕）。如果我想要一个新窗口，我会自己打开它！
> 
> 设计师打开新的浏览器窗口的理论是让用户留在他们的网站上。但即使不考虑接管用户机器时隐含的用户敌意信息，该策略也会弄巧成拙，因为它禁用了返回按钮，这是用户返回先前站点的正常方式。用户通常不会注意到打开了一个新窗口，尤其是当他们使用小型显示器时，窗口最大化以填满屏幕。因此，试图返回原点的用户会被灰显的“后退”按钮弄糊涂。

这些不是疯狂的新奇想法，它们是基于艰苦研究的十年前的指导方针。你需要一个非常非常**非常**好的借口来重复十年前的错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-19T18:13:17.723

查找执行此操作的实际页面示例并显示它们。 [这是找到一些的好地方。](http://www.webpagesthatsuck.com/)

如果你向他们展示这些例子，而不是被他们的愚蠢和改变主意所吓倒，客户说，“是的！这正是我想要的！”，然后让他们签署一份保密合同，说他们永远不会告诉任何人设计了他们的网站。:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-19T17:30:41.643

你必须解释“为什么”。告诉他们某事“错误”是不够的（在这些情况下，与其说是“错误”，不如说是“坏主意”）

大多数人对逻辑和推理反应良好。如果您可以合理地论证为什么以某种方式做某事是一个坏主意，那么他们通常会屈服于您的经验和知识。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-19T17:32:31.643

useit.com 是可用性论证的绝佳资源

但你可能在浪费时间。要么按照他们的方式去做（“客户永远是对的”）要么走开——争论不太可能改善情况*，除非*你能证明不按照他们的方式做事可以获得巨大的金钱收益，考虑到你列出的问题，你可能无法做到这一点.

如果你的名字出现在网站上，我会礼貌地走开

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-19T17:33:51.927

向他们展示一些在[http://useit.com](http://useit.com)等网站上的文章，这些文章有一些实证研究，说明遵守网络标准实践如何提高可用性，从而提高用户满意度，从而提高利润。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-19T17:44:40.173

问他们追求什么结果。“在新窗口中打开所有链接”是解决方案的声明。解决方案是**你的**工作，客户的工作是陈述目标。

从这个开始：“哦，你想在新窗口中打开链接。告诉我更多关于你为什么想要那个 - 我想和你一起探索是否有其他方法可以获得相同的结果。”

也许继续这样说：“另外，我可能会指出你在新窗口中打开所有链接的*其他*后果——你可能没有考虑过的后果，也许你不喜欢这些后果。”

推荐阅读：[Dale Emery](http://dhemery.com/articles/resistance_as_a_resource/)关于抵抗的文章。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-19T17:30:20.317

在最简单的情况下，尝试以用户可以理解的方式解释它们中的每一个。
例如，闪烁文本是一种旧式的东西，并非所有浏览器都支持
不确定为什么“后退”可能是个问题。但是提出你的观点。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-19T17:33:17.293

如果您向用户展示他会“尊重”的非常知名网站的列表并指出他们不做 X 的方式，向用户证明他的设计是非传统的或错误的，这总是令人信服的。您的客户可能希望他的网站就像大玩家的网站*一样。*

如果他仍然坚持认为他的怪异设计有意义，你可以说：“是的，我同意这在理论上听起来是个好主意，但事实是用户根本不习惯 X，如果它也出现分歧，他们会离开你的网站与标准的做事方式大相径庭”。

IOW，当一切都失败时，使用恐惧。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-19T18:19:42.213

*你可以把马牵到水边，但你不能让它喝水。*

对于（任何类型的）客户，你能做的最好的就是告诉他们他们的选择，以及为什么他们不是最好的，然后离开。如果真的很糟糕，要求签字说明他们认为该设计可以接受。您想要“正确”还是想要让客户手中的东西有效？

如果它完全阻碍了一个可行的解决方案，那么（并且只有这样）你应该坚持原则，但要注意你的这些“立场”很少（如果有的话），所以要明智地使用它们。准备走开。

保罗。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-19T18:19:09.187

除非有一个令人信服的商业案例不要这样做（我不确定你的任何例子都是这种情况），否则如果客户坚持这样做！毕竟他们正在为此付出代价。如果你不这样做，他们总能找到其他人来做！

# iphone - iPhone - 一些声音文件无法播放

> ID：566301
> 
> 赞同：2
> 
> 时间：2009-02-19T17:24:15.407
> 
> 标签：iphone, audio

我有一个简短的 wav 文件列表。其中两个文件不能在模拟器或设备本身上播放。所有都是 1 秒长的 wav 文件。

这就是我播放文件的方式

```
SystemSoundID soundID;
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"sound1" ofType:@"wav"];

NSURL *fileUrl = [NSURL fileURLWithPath:filePath];
AudioServicesCreateSystemSoundID((CFURLRef)fileUrl, &soundID);
AudioServicesPlaySystemSound(soundID); 
```

有人可以告诉我可能是什么问题。谢谢。

PS 当我在 Finder 中查看文件时，未播放的文件将默认播放器显示为 QuickTime，如果有任何帮助，其他文件将默认播放器显示为 iTunes。

**Alan 建议的解决方案是使用 AIFF 文件。要将 wav 转换为 AIFF，请在 iTunes 中打开声音文件。在 iTunes 中，选择 Preferences->General->Import Settings->Import using AIFF Encoder。选择声音文件并在高级菜单选项中选择“创建 AIFF 版本”选项**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-20T00:03:51.607

iPhone 仅支持以下编解码器：

*   AMR（自适应多速率，一种语音编解码器）
*   iLBC（互联网低比特率编解码器，也是一种语音编解码器）
*   IMA/ADPCM（也称为 IMA-4）
*   线性PCM
*   µLaw 和 aLaw

您的 WAV 文件可能包含不同格式的音频，因此即使 iPhone 支持 WAV 文件，它也可能不支持您的特定 WAV 文件。

最好的选择通常是使用命令行程序“afconvert”将所有内容转换为 CAF 文件（这是 Apple 的默认格式）。例如：

```
afconvert sound1.wav sound1.caf 
```

可以通过运行列出全套转换选项：

```
afconvert -h 
```

这种转换对于大多数格式都是无损的。CAF 文件格式通常是在 iPhone 上使用的最快和最低开销的格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T17:35:51.523

看到这个问题 [Trying to play sound through iPhone Simulator](https://stackoverflow.com/questions/258006/trying-to-play-sound-through-iphone-simulator)

我在 .aiff 文件方面取得了更大的成功。

当文件传递给它时，最好知道AudioServicesCreateSystemSoundID 正在检查*什么。*

# jquery - 在 jQuery 中检测 Internet Explorer 6 或更低版本

> ID：566303
> 
> 赞同：45
> 
> 时间：2009-02-19T17:24:53.537
> 
> 标签：jquery, internet-explorer-6

我是 jquery 的新手，想知道：检测浏览器是否为 Internet Explorer 6 或更低版本的简单方法是什么？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-07-01T10:28:15.340

就这么简单：

```
if($.browser.msie && $.browser.version=="6.0") alert("Im the annoying IE6"); 
```

**更新**

请注意[$.browser](http://api.jquery.com/jQuery.browser/)[已从 jQuery 1.9](http://jquery.com/upgrade-guide/1.9/#jquery-browser-removed)中删除

如果您仍然需要在 jQuery 1.9（或其他已弃用的函数）中使用 $.browser，请尝试 jQuery-migrate ( [https://github.com/jquery/jquery-migrate/](https://github.com/jquery/jquery-migrate/) - [http://code.jquery.com/jquery -migrate-1.2.1.js](http://code.jquery.com/jquery-migrate-1.2.1.js) )

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-05-05T21:37:21.660

你也可以直接问IE。

```
<!--[if lte IE 6]>
<script type="text/javascript">
  var isRunningIE6OrBelow = true;
</script>
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-19T17:27:38.253

jQuery 检查功能，而不是“浏览器”。也就是说，您可以使用[**jQuery.support**](https://api.jquery.com/jQuery.support)方法来检测用户浏览器的功能。

不推荐使用的方法（不要使用）

*   $.browser
*   $.browser.version
*   $.boxModel

[https://api.jquery.com/jQuery.support](https://api.jquery.com/jQuery.support)将为您提供哪些浏览器支持哪些功能的摘要。获取这些数据，您将开发几个条件检查来确定正在使用的浏览器是否是您的目标浏览器。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-11-29T12:39:55.863

```
if ($.browser.msie && parseInt($.browser.version, 10) <= 6) {
  alert("I'm not dead yet!"); 
} 
```

- 更新

请不要[从 jQuery 1.9](http://jquery.com/upgrade-guide/1.9/#jquery-browser-removed)中删除[$.browser](http://api.jquery.com/jQuery.browser/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-05T21:24:25.403

检测 IE 的非常好的方法是：

```
if ('v'=='\v') {
   welcome to IE )) 
} 
```

不幸的是，它无法识别它的版本，但它并不总是必要的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-01-09T22:25:36.423

如果`ActiveXObject`存在`XMLHttpRequest`且不存在，则为 IE6：

```
/* IE6 Check */
(!!window.ActiveXObject && !window.XMLHttpRequest) ? true : false; 
```

在 IE7 中，它将是：

```
(!!window.ActiveXObject && !!window.XMLHttpRequest) ? true: false; 
```

**参考**

*   [JavaScriptKit：AJAX](http://www.javascriptkit.com/jsref/ajax.shtml)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-08-05T13:37:45.387

> 另外，另一个好处是，使用 JQuery，您不必担心版本。

但是，如果您使用 jquery 来修复 IE6 css 渲染错误，那将无济于事。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-01-19T11:53:26.387

我经常检查浏览器的版本。.support 方法很棒，但是当您需要在有覆盖时隐藏选择时，它并没有真正的帮助。没有“支持选择是窗口控件”。你只需要检查浏览器版本，所以我会说 .support 方法可能会出错，并在必要时使用 .browser 。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-10T11:38:21.627

只是为了让人们知道 $.browser.msie && /6.0/.test(navigator.userAgent) 不可靠，我来这个问题是为了寻找 JQuery bgiframe 问题的答案，它在我的机器上中断，因为我在我的 navigator.userAgent 字符串中有“Media Center PC 6.0”。我现在已经编辑了源代码以使用 $browser.version 测试。

JQuery 弃用这些浏览器测试是愚蠢的，因为它们可能很丑陋，但它们对于处理浏览器生态系统的丑陋状态是必要的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-13T07:02:39.320

我一直使用这个解决方案

[http://sinfinity.pl/blog/2012/02/12/detect-internet-explorer-and-browser-version-in-jquery/](http://sinfinity.pl/blog/2012/02/12/detect-internet-explorer-and-browser-version-in-jquery/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-19T17:28:17.083

[http://docs.jquery.com/Utilities/jQuery.browser.version](http://docs.jquery.com/Utilities/jQuery.browser.version)是如何

**已编辑：Douglas 的更正链接**

[http://api.jquery.com/jQuery.browser/#jQuery.browser.version](http://api.jquery.com/jQuery.browser/#jQuery.browser.version)

我的意思是，如果您使用的是旧版本而不是最新的 1.3...

另外，另一个好处是，使用 JQuery，您不必担心版本。JQuery 进行功能测试并为您处理所有这些问题。担心版本和平台很漂亮 1999

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-19T17:29:03.387

试试这个：

```
 jQuery.each(jQuery.browser, function(i, val) {
  $("<div>" + i + " : <span>" + val + "</span>")
            .appendTo(document.body);
}); 
```

如果您需要更多信息，请参阅：

[http://docs.jquery.com/Utilities/jQuery.browser](http://docs.jquery.com/Utilities/jQuery.browser)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-10-19T15:18:27.703

> “虽然 jQuery.browser 不太可能被删除，但应该尽一切努力使用 jQuery.support 和适当的功能检测。”

所以我说继续使用它。他们必须保持与仍然使用用户代理嗅探方法的脚本的向后兼容性。

# wpf - WPF Listview 与 Hashtable 绑定

> ID：566326
> 
> 赞同：0
> 
> 时间：2009-02-19T17:31:37.370
> 
> 标签：wpf, listview, binding

我已经用哈希表绑定了一个列表视图（网格），那么我怎样才能从那里获取项目呢？在使用哈希表之前，我刚刚做了`ListViewA.SelectedItems;`并且我正在获取源代码。

`foreach`当我使用两个循环时，Ir 失败：

`dlstTemplates`是我在 WPF 中的 ListView

```
foreach (var group in dlstTemplates.SelectedItems)
{
  foreach (var Template in group)
  {

  }
} 
```

> 错误 2 foreach 语句无法对“object”类型的变量进行操作，因为“object”不包含“GetEnumerator”的公共定义 D:\cs_InformeMedico\app\Template.xaml.cs 85 21 Demo.View

我在调试器上发现了这个：

```
-       dlstPlantillas.SelectedItems    Count = 1   System.Collections.IList {System.Windows.Controls.SelectedItemCollection}
-       [0] {System.Data.Linq.SqlClient.ObjectReaderCompiler.Group<string,Demo.View.Plantilla>} object {System.Data.Linq.SqlClient.ObjectReaderCompiler.Group<string,Demo.View.Plantilla>}
-       Non-Public members      
+       items   Count = 97  System.Collections.Generic.IEnumerable<Demo.View.Plantilla> {System.Collections.Generic.List<Demo.View.Plantilla>}
        key "101010112000"  string
        System.Linq.IGrouping<K,T>.Key  "101010112000"  string
-       Results View    Expanding the Results View will enumerate the IEnumerable   
+       [0] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [1] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [2] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [3] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [4] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [5] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [6] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [7] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [8] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [9] {Demo.View.Plantilla}   Demo.View.Plantilla
+       [10]    {Demo.View.Plantilla}   Demo.View.Plantilla
-       Raw View        
-       [System.Windows.Controls.SelectedItemCollection]    Count = 1   System.Windows.Controls.SelectedItemCollection
+       [0] {System.Data.Linq.SqlClient.ObjectReaderCompiler.Group<string,Demo.View.Plantilla>} object {System.Data.Linq.SqlClient.ObjectReaderCompiler.Group<string,Demo.View.Plantilla>}
+       Raw View        
        IsFixedSize false   bool
        IsReadOnly  false   bool 
```

所以当组是

```
{System.Data.Linq.SqlClient.ObjectReaderCompiler.Group<string,Demo.View.Plantilla>} object type 
```

抱歉，Plantilla = 模板，我将其转译为更多理解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T17:46:57.023

您似乎没有在第二个循环中使用集合。
也许你想要

```
foreach(var group in dlstTemplates.SelectedItems)
{
    foreach(var Template in groupCast.Templates)
    {
        //do stuff...
    }
} 
```

或类似的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T18:18:02.120

```
 foreach (var group in dlstPlantillas.SelectedItems)
            {
                IGrouping<string, Plantilla> groupCast = group as System.Linq.IGrouping<string, Plantilla>;
                if (null == groupCast) return;
                foreach (Plantilla item in groupCast)
                {
                    template.codigoestudio = item.codigoestudio;

                }
            } 
```

希望有所帮助...感谢 ZombieSheep 的灵感！

# c# - C# 动态类型语言

> ID：566327
> 
> 赞同：7
> 
> 时间：2009-02-19T17:31:41.003
> 
> 标签：c#, .net, programming-languages

随着 .NET 3.5 中的新功能（例如 var、Lambda、linq 等）以及更多即将推出的功能，我们可以得出结论，C# 不仅是静态类型语言，而且是**动态类型**语言？

为什么或者为什么不？

**编辑#1**

正如下面的许多海报所声称的那样，.net 4.0 将为该语言添加动态类型。这会减慢语言速度吗？

随着每个版本的发布，csharp 都会从不同的语言中获取一些东西。就 .Net1.1 而言，我们的祖先甚至不打算将其变成函数式语言......

**编辑#2**

我想你们中的许多人误解了这个问题；因为我指的是整个 C# 语言，包括即将发布的 4.0。因此，公平地说该语言是动态类型的......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-19T17:32:47.450

C# 不是动态类型的 - 在您提到的示例中，所有类型都是静态推断的。下*一个*版本的 C# 将包含一些动态特性，但可以使用 COM 和真正的动态语言。

[Edit #1] 是的，C# 的新动态特性会更慢，因为使用它的所有内容都需要后期绑定。但是，如果您使用它，它只会减慢您的应用程序 - 它不是对核心语言本身的更改。C# 4 将是一种静态类型语言，具有处理后期绑定类型的能力。

[Edit #2] No C# 4 不会是动态类型语言。C# 4 引入了一种新`dynamic`类型，它将替代类型成员的后期绑定来代替静态类型检查。动态功能仅适用于这些动态类型。C# 的底层类型系统没有改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T17:32:58.213

不，它仍然是静态类型的，var/lambda/linq 都使用编译器的推断，因此在编译时类型是已知的，动态/鸭子类型将随 c# 4.0

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T17:34:16.920

动态输入？！没有。从技术上讲，C# 是一种静态类型语言。它通过 .NET 运行时提供的 CLR 反射服务具有动态方法调度能力（从 v1.0 开始可用，与 .NET 3.5 特性无关，C# 3.0 特性仍然是静态类型的）。C# 4.0 将具有真正的动态类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T18:56:44.803

Commenters: Are you *that* sure that dynamic types can be so easily contained? I've got a feeling that their effects will spread.

# html - 最重要的可用性、可访问性和 SEO 指南是什么？

> ID：566332
> 
> 赞同：3
> 
> 时间：2009-02-19T17:32:32.067
> 
> 标签：html, css, seo, usability

谁能告诉我一些最重要的可用性、可访问性和 SEO 指南，在开发一个好的 Web2.0 网站时必须考虑这些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T17:43:39.640

[http://www.w3.org/WAI/](http://www.w3.org/WAI/)
[http://www.section508.gov/index.cfm?FuseAction=content&ID=12#Web](http://www.section508.gov/index.cfm?FuseAction=content&ID=12#Web)
[http://www.google.com/support/webmasters/bin/topic.py?topic=8522](http://www.google.com/support/webmasters/bin/topic.py?topic=8522)

不要太拘泥于“Web 2.0”这个流行词。可访问性标准已经存在了很长时间，并且是任何网站的重要组成部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T17:53:31.423

SEO 提示：重写您的动态 URL，以便即使实际 URL 也可能是动态的，它看起来是静态的。这允许蜘蛛完全索引您的网站。

在 Apache 上，您可以通过使用 mod_rewrite 来做到这一点，并且 IIS 有类似的技术。

例子：

代替

[http://yourdomain.com/cgi-bin/getproduct.pl?id=12345](http://yourdomain.com/cgi-bin/getproduct.pl?id=12345)

使用类似的东西

[http://yourdomain.com/products/12345](http://yourdomain.com/products/12345)

作为替代方案（或对您无法重写的动态 URL 的附加措施），您应该创建站点地图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T18:00:22.437

顺便说一句，[最近有一篇关于它](http://www.smashingmagazine.com/2009/02/18/9-common-usability-blunders/)的文章。

其他好的可用性文章：

*   [30 个需要注意的可用性问题](http://www.smashingmagazine.com/2007/10/09/30-usability-issues-to-be-aware-of/)
*   [Web 应用程序中良好 UI 设计的 12 种有用技术](http://www.smashingmagazine.com/2009/01/19/12-useful-techniques-for-good-user-interface-design-in-web-applications/)
*   [10 种有用的 Web 应用程序接口技术/](http://www.smashingmagazine.com/2009/01/12/10-useful-web-application-interface-techniques/)
*   [你应该知道的 10 个可用性噩梦](http://www.smashingmagazine.com/2007/09/27/10-usability-nightmares-you-should-be-aware-of/)

虽然我不喜欢文章标题的“恐怖”语气，但文章本身就是很好的做法。

# ruby-on-rails - 存储应用程序参数的最佳位置在哪里：数据库、文件、代码......？

> ID：566333
> 
> 赞同：3
> 
> 时间：2009-02-19T17:32:36.607
> 
> 标签：ruby-on-rails, database, architecture

我正在开发一个 Ruby on Rails 网站，我有一个“架构”问题：我的应用程序需要一些参数，我想知道在哪里存储它们。

具体来说，我的应用程序会收到一些请求，这些请求会被评估然后发送。因此，请求模型必须具有与这些处理相关的属性：**验证状态**和**发送状态**。例如，**验证状态**可以是“*接受*”、“*拒绝*”或“*等待*”。**发送状态**可以是“已*发送*”、“*等待*”、“*发送期间出错*”或类似的东西。我必须将这些状态代码参数存储在某处，但我不知道什么是最好的解决方案。

我可以为每个模型创建一个模型并将它们存储在数据库中（例如，有一个活动记录模型 ValidationStatus）但是：创建一个数据库/模型来存储这样的数据不是有点过分吗？

我也可以只在代码中使用它们而不“存储”它们，我可以将它们存储在 YAML 文件中......

所以，一个更简单的问题：您如何处理 RoR 中的应用程序参数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-19T17:44:50.220

有很多全局配置插件，其中大多数都围绕在某个时候加载 YAML 文件的想法。检查[这个页面](http://labs.reevoo.com/plugins/simple-config)，[这个插件](http://www.rubyinside.com/configatron-ruby-app-configuration-library-1130.html)，甚至这个[Railscast](http://railscasts.com/episodes/85)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T17:47:55.370

我把它们放在数据库中。我有很多这些，它们都是非常简单的字符串列表。这些表都是相同的 - id、name、description。

我为它们生成模型，而不是为每个模型创建一个实际的模型文件。在 app/models 我有一个名为 active_record_enums.rb 的文件，在你的情况下看起来像这样：

```
ACTIVE_RECORD_ENUMS = %w{
  ValidationStatus
  SendingStatus
}

ACTIVE_RECORD_ENUMS.each do |classname|
  eval "class #{classname} < ActiveRecord::Base; end"
  classname.constantsize.class_eval do 
    # Add useful methods - id_for(name) and value_for(id) are handy
  end
end 
```

该文件必须在某处的配置文件中被要求；除此之外，它非常简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-08T21:10:06.670

（已经看过上面提到的rails cast [第85集] - 它看起来比下面的'rails way'更多）

另一种方法是在 Rails 中现有的配置机制上进行构建。假设有两种类型的配置：

1.  开发/测试/生产环境通用的应用范围配置
2.  特定于环境 dev/test/prod 的配置

对于第一种情况，“RAILS_ROOT + '/config/environment.rb'”中的项目有效。只需看到名称是大写的，因此它们是 Ruby 常量。对此的一个变体是引用该 environment.rb 文件中的另一个文件...

```
require RAILS_ROOT + '/config/appConfigCommon.rb' 
```

并将相关的配置项放在该文件中。这具有能够独立于 Rails 引用的优点。

对于场景 2，可以采用类似的方法。将用于开发的项目放在“RAILS_ROOT + '/config/environments/development.rb'”或类似的东西中

```
require RAILS_ROOT + '/config/environments/appConfigDev.rb' 
```

并将环境特定的项目放在所需的文件中，确保它们以大写字母开头。并按照相同的模式进行测试/生产（如果需要，还可以使用其他模式）。

只需使用常量名称，即可在视图和控制器（不确定模型）中直接访问配置项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T17:48:39.083

我没有使用 Ruby，但我会告诉你，我开始（在 ASP.NET 中）在 Web.Config 文件中放置大量设置（类似于 YAML）。然而，随着时间的推移，系统发展到不同实例需要不同设置的地步。因此，几乎所有这些都迁移到了数据库中。所以...*如果*您要部署站点的多个实例，我强烈建议您将设置保存在数据库表中（我的只有一条记录，包含各种设置的字段）。如果我一开始就这样做，我会节省大量时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T07:25:54.157

我倾向于只`string`为每个列创建一个列，并`validates_inclusion_of`用来设置他们可以接受的内容。

```
class Request < ActiveRecord::Base
  validates_inclusion_of :validation_status, :in => ['accepted','rejected','waiting']
  validates_inclusion_of :sending_status, :in => ['sent','waiting','...']
end 
```

如果您需要在状态更改时发生一些事情（即发送电子邮件），请考虑使用[Acts As State Machine](http://github.com/rubyist/aasm/tree/master)插件来管理它。

# sql-server - 什么允许 Windows 身份验证用户名在两台服务器之间工作（流动）？

> ID：566350
> 
> 赞同：4
> 
> 时间：2009-02-19T17:35:13.940
> 
> 标签：sql-server, sql-server-2005, authentication, impersonation, windows-authentication

典型的 ISP 设置。一台服务器是 Web 服务器，另一台是 DB SQL 服务器。在两台机器上都创建了一个本地管理员帐户，比如说 XYZ。所以当我远程登录时，我要么是 WebServer\XYZ 要么是 DBServer\XYZ，这取决于我登录的位置。

现在，当我使用 Windows 身份验证登录到 DBServer 上的 SQL Server SSMS 并执行“S​​ELECT SUSER_NAME()”时，我得到了 DBServer\XYZ。这是有道理的，因为它表明了我使用这些凭据登录的事实。

现在，转到 WebServer。我以 WebServer\XYZ 身份远程登录。我已经在那里安装了 SQL 客户端组件。当我启动 SSMS，选择 DBServer，使用 Windows 身份验证登录并执行“S​​ELECT SUSER_NAME()”时，我以某种方式得到 DBSERVER\XYZ，而不是我认为应该是 WebServer\XYZ。

不知何故，来自 WebServer 的 XYZ 变成了来自 DBServer 的 XYZ。这是为什么？这是怎么发生的？当然，这不能只是因为名字碰巧是一样的吗？

我听说过受信任的域，但这两台机器都不是域控制器，所以我无权访问该信息。如果没有 GUI 工具，我如何判断它是否受信任？

我问这个问题的原因是因为，我试图在我的 XP 笔记本电脑上实现同样的东西（使用 Virtual PC），所以我可以模仿生产环境，但我没有任何运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T17:40:41.543

您`XYZ`的帐户似乎在两台机器上都有相同的密码，并且它们不是域的一部分。

`WebServer`仅`XYZ`作为用户名发送并成功回答所有密码挑战，因为密码确实匹配。

`DbServer`，当然，认为你是`DbServer/XYZ`，因为它不知道其他人。

当您尝试从另一台机器访问一台独立机器时，会发生完全相同的事情`SMB`。如果您的用户名和密码匹配，则您成功。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T19:35:00.257

机器之间的 NTLM 挑战比@Quassnoi 表示的要复杂一些，但它是相似的。这些机器很可能在同一个域或受信任的域中，但您使用的帐户是本地机器帐户，仅限于本地机器的安全访问管理。

模式为 machinename\userid 的本地 SAM 帐户是不可传播的。当您尝试使用该帐户对外部资源进行身份验证时，您会遇到一系列协商后的回退，如下所示：

1.  传递当前域/用户名/密码哈希令牌 - 它会失败，该帐户不受信任
2.  回退 - 恢复传递的用户 ID + 密码哈希
3.  回退 - 恢复为匿名凭据连接。

也可以通过配置禁用回退，防止匿名身份验证是很常见的。

正如@Quassnoi 在这种情况下指出的那样，您设法使用#2 后备登录。

要使帐户凭据能够传播，您需要满足以下条件：

1.  机器必须是相互之间至少具有单向信任的域的成员（它们不一定必须是同一域的成员）。
2.  使用域帐户 - 不是本地计算机帐户 - 看起来像域名\用户 ID。一种特殊情况是网络服务帐户，它在域场景中具有代理帐户 - domainname\machinename$。

你如何判断你的机器是否是域的成员？如果您对机器进行了交互式登录，那将非常容易。有几个策略

1.  系统控制面板将以交互方式显示工作组或域成员。（在开始菜单中右键单击计算机上的属性）
2.  在命令行中，`IPCONFIG /ALL`还将显示默认 DNS 前缀，该前缀通常与您的域名相同。

我怀疑您的 ISP 会创建一个域只是为了便于管理和监控他们的机器。他们是否允许您创建域帐户是一个不同的问题。

# c# - 运行什么 ORM：telerik Open Access VS Subsonic VS linq to sql VS Active Record

> ID：566354
> 
> 赞同：8
> 
> 时间：2009-02-19T17:35:49.450
> 
> 标签：c#, .net, orm, data-access-layer

我们正在研究使用 ORM，我想要一些意见/比较

我们对 ORM 的基本标准是：易于使用/配置（学习曲线短）、灵活、能够将其抽象出来、易于维护

这是我们正在查看的 ORM 以及我们的初步印象的列表

1.  开放存取——对于简单的东西来说似乎真的很容易，但似乎没有很大的灵活性，成本不是我们已经拥有的问题
2.  Ling to SQL - 使用和配置看起来非常简单，但缺少一些功能
3.  Active Record - NHibernate 变得简单
4.  SubSonic - 看起来功能非常丰富，但并没有真正玩过它

这是我们查看并排除的 ORM

1.  实体仍处于测试阶段
2.  NHibernate 有很长的学习曲线（我们没有 3 周的时间来学习它）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T16:45:24.303

我想说你应该看看 DataObjects.NET ( [http://www.x-tensive.com](http://www.x-tensive.com) )。它功能丰富且非常易于使用。但是，它确实将您与您的对象模型联系在一起，因为它根据您的对象模型的外观决定数据库结构应该是什么。话虽如此，如果您希望能够无视数据库的存在，那就太好了。我们已经使用它多年并取得了巨大的成功。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T18:06:10.300

我们目前使用的是 SubSonic (2.0.3)，它绝对是救命稻草。我不能强调它有多棒。但是，由于各种原因（可能是 NHibernate 或 Entity），我们现在正在考虑从它切换。这是我的优点和缺点：

优点：

*   设置和使用非常简单。
*   许多伟大而有用的工具和功能
*   使用“约定优于配置”的理念，所以很少配置。它“正常工作”。（只要你按照它想要的方式做事...... :)）

缺点：

*   您的数据库设计与您的域设计紧密耦合。在您的数据库中进行更改，您需要更改您的代码/域设计。
*   默认情况下，SubSonic 使用 ActiveRecord 模式进行所有数据访问，而不是 Repository 模式，这使得“抽象”变得更加困难。（虽然我相信在 v3.0 中你可以换掉默认的 ActiveRecord 模板来使用 Repository 模式）。
*   许多关于 SubSonic 未来的悲观谣言四处流传。但谣言就是这样：谣言。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T17:41:42.917

对于所有成对的便士，它可能值得：

如果您现在没有 3 周的时间来学习您选择的 ORM（无论您选择哪个），那么您可能必须在以后*找到*3 周的时间来学习它，因为它并不能完全按照您的想法映射。

如果您有一个中等复杂的模型，那么 ORM 就很重要。您最终需要知道您的 ORM 是如何工作的，以便您可以告诉它以您想要的方式映射事物。

当然，这是“了解你的工具”的另一种说法。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T17:46:08.863

大多数人都会对其中的一两个有一些经验，但很少有人会接触到所有这些。我建议对你最喜欢的每一个进行概念验证。设置好每一个，每个 ORM 工具花费的时间*不*超过*n*小时（*n* = 你认为合理的时间。）你不必实现你的整个对象模型，一个功能子集就可以了。

完成后，您将完成所有设置和一些使用。然后，您可以编写一个事后分析，团队可以决定哪个具有最佳的痛苦与特征比率。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-06T06:07:50.193

使用 T4 模板创建您自己的模板。Internet 上有几种已建立的模式，尤其是对于 T4 模板。了解 T4 还可以让您编写出可能具有比宏更大范围但比编写自定义应用程序来生成所需脚本的范围更小的项目。希望这可以帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T17:52:11.300

我非常同意 BryCoBat（赞成）。我还想补充一点，如果您已经拥有 Open Access，那么公司内部的某个地方很可能已经有人对它非常熟悉，包括您在自己的领域中查看的用于琐碎和非琐碎任务的代码示例。换句话说：使用你所知道的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-30T09:15:07.363

如果您不使用 Telerik 控件，则应该选择 LINQ to SQL 进行快速学习 - 网络上有大量不同的教程、视频、书籍。

# c# - 错误处理/记录策略

> ID：566358
> 
> 赞同：8
> 
> 时间：2009-02-19T17:36:43.240
> 
> 标签：c#, asp.net

你们能否分享有关基于 ASP.NET 3.5 Web 的应用程序的错误处理/记录策略的知识？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-07-03T17:09:22.937

[Log4net 日志记录：您发现什么有用？](https://stackoverflow.com/questions/782244/log4net-logging-what-have-you-found-to-be-useful/782693#782693)

[记录错误的最佳做法是什么？](https://stackoverflow.com/questions/296150/what-are-the-best-practices-to-log-an-error)

[记录最佳实践](https://stackoverflow.com/questions/576185/logging-best-practices)

[将什么写入日志文件？](https://stackoverflow.com/questions/779989/what-to-write-into-log-file)

[最先进的错误和异常处理策略应该包括哪些内容？](https://stackoverflow.com/questions/701596/what-should-be-included-in-the-state-of-the-art-error-and-exception-handling-stra)

[我应该在我的网络应用程序中登录哪些信息？](https://stackoverflow.com/questions/967970/what-information-should-i-be-logging-in-my-web-app)

日志记录是每个应用程序中非常关键的部分，因此做好它很重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-29T22:00:14.947

当错误发生时，您不应该尝试捕获它或将其直接记录在应用程序的代码中，除非它是您希望从中恢复的错误。例如，如果您有一个数据驱动的 Web 应用程序并且数据库处于脱机状态，那么您就无法从中恢复。但是，如果您正在发送一封电子邮件并且有两个电子邮件服务器并且第一个已关闭，则您可以使用第二个电子邮件服务器进行恢复。

我见过许多 ASP.NET 应用程序，其中开发人员使用`try...catch`块来“吞下”错误。实际上，`try...catch`只有在发生错误时有已知的恢复策略时才使用块（例如在我之前的示例中使用备用电子邮件服务器）。如果您的应用程序中有多个`try...catch`块，您可能做错了。

您希望避免过度使用`try...catch`块的原因是您希望错误记录和通知与您的应用程序正交。您不想在每个页面或组件中剪切和粘贴错误记录代码。相反，您希望添加一些机制，以便*自动*记录任何未处理的异常并*自动*通知开发人员。

好消息是这种错误记录和通知功能很容易实现。我的偏好是使用[ELMAH](http://code.google.com/p/elmah/)，一个免费的开源错误记录和通知系统。或者，您可以使用 ASP.NET 的内置错误记录系统[Health Monitoring](http://www.4guysfromrolla.com/articles/031407-1.aspx)。

有关 ELMAH 和健康监控的更多信息，以及有关自定义错误页面和设置所有内容的指导，请参阅我的文章[ASP.NET Web 应用程序的异常处理建议](http://www.4guysfromrolla.com/articles/081209-1.aspx)。

快乐编程！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T17:39:50.153

你应该考虑[log4net](http://logging.apache.org/log4net/index.html)。有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/98080/what-is-the-best-logging-solution-for-a-c-net-3-5-project/98791#98791)。

它非常强大、快速且易于使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-29T21:39:34.947

我将与 Java 无关，我将添加来自 OWASP 的文档 - 打开 Web 应用程序安全项目。我正在实施日志记录/错误处理策略，它非常有用。

*   [http://www.owasp.org/images/e/e0/OWASP_Logging_Guide.pdf](http://www.owasp.org/images/e/e0/OWASP_Logging_Guide.pdf)
*   [http://www.owasp.org/index.php/Category:OWASP_Logging_Project](http://www.owasp.org/index.php/Category:OWASP_Logging_Project)

另一个在 stackoverflow 上已经回答的好问题：*[记录错误的最佳实践是什么？](https://stackoverflow.com/questions/296150/what-are-the-best-practices-to-log-an-error)

# perl - 为什么我的数组切片上的 grep 会导致 Perl 中的堆栈溢出？

> ID：566362
> 
> 赞同：2
> 
> 时间：2009-02-19T17:37:44.677
> 
> 标签：perl, arrays

前几天，需要一次迭代数组的一个子集。最初，我通过拼接来做到这一点——在这种情况下，拆开阵列是没有问题的。它将一次返回 N 个元素，或者返回列表末尾的任何内容。一切顺利。

后来发现我需要这个数组。我没有使用拼接，而是切换到数组切片。繁荣！程序爆炸了，到处都是堆栈溢出。什么？为什么？如何？我玩弄了它，发现了几个可行的变体。这是演示此问题的测试脚本：

```
use strict;
use warnings;

my @array = qw(a b c d e f g h i j k l m n o p q r s t u v z x c v b a s d f g a s d f a se g);
my $numPerTest = 5;

my $index = 0;
print "Separating out the subset before grepping it, good.\n";
while ($index < @array)
{
   print "Iteration $index\n";
   my @subset =  @array[$index..($index+$numPerTest)];
   @subset = grep { defined $_ } @subset;
   $index += $numPerTest;
}

$index = 0;
print "Making a copy of the array before grepping works.\n";
while ($index < @array)
{
   print "Iteration $index\n";
   my @subset = grep { defined $_ } @{[ @array[$index..($index+$numPerTest)] ]};
   $index += $numPerTest;
}

$index = 0;
print "Grepping the array slice directly, explodey!\n";
while ($index < @array)
{
   print "Iteration $index\n";
   my @subset = grep { defined $_ } @array[$index..($index+$numPerTest)];
   $index += $numPerTest;
} 
```

（实际上，我只是想出了这个，但我想我还是把它贴出来。看看有没有其他人看到它。:)）

（另外，如果你没有看到它，[这](http://www.perlmonks.org/?node_id=710067)有另一种解释为什么会发生的方式。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-19T17:52:50.643

通过将切片用作左值，每次数组太短时都会放大数组。因此，它永远不会缺元素。

在前两个示例中，您仅将其用作右值，因此不会创建额外的元素。在第三个中，它是一个左值，因此创建了元素，以便`$_`可以分配给它。

这不是切片特有的行为：在正常的数组访问中，显示的行为完全相同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-19T17:59:54.903

我认为这段代码

```
@array[$index..($index+$numPerTest)] 
```

正在您的数组中创建空元素。然后当你测试

```
$index < @array 
```

你的@array 刚刚变大，你的索引永远不会大于你的@array 大小。

# css - HTML.Controls 上的 ASP.NET MVC CSS 类

> ID：566363
> 
> 赞同：4
> 
> 时间：2009-02-19T17:38:22.477
> 
> 标签：css, asp.net-mvc

我想我在这里遗漏了一些相对简单的东西，但我正在尝试找到一种将 CSS 类应用于我的视图中的控件的方法。我正在使用

`<%= Html.SubmitButton("Submit", "Edit Plot")%>`

这样做的风格方法。除了在这些元素周围放置 div 并应用样式外，是否有任何方法`CssClass`可以访问普通 .NET 中可用的属性？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-19T17:41:09.250

查看[http://blog.veggerby.dk/2008/11/19/aspnet-mvc-htmlhelper-methods-and-css-class/](http://blog.veggerby.dk/2008/11/19/aspnet-mvc-htmlhelper-methods-and-css-class/)，很简单：

```
<% = Html.TextBox("name", null, new{ @class = "required"})  %> 
```

# user-interface - UI 过去、现在、未来

> ID：566367
> 
> 赞同：3
> 
> 时间：2009-02-19T17:39:22.557
> 
> 标签：user-interface

我正在从程序员的角度就这个主题做一个简短的演讲。我正在考虑沿 3 个轴谈论 UI 设计：

1.  **接近**度：您编写的代码与 UI 的接近程度
2.  **交互性**：用户界面的灵活性和强大程度
3.  **复杂性**：构建用户界面的难度（技术/实现）

然后我将讨论以下 UI：

1.  命令行：

    > > 接近度高，复杂度高，交互性低

2.  VB / MFC / Windows 窗体

    > > 接近度低（处理大型 API/控件/UI 模型），中等交互性 - 您可以构建它，但接近度高（第 3 方库/控件），复杂性范围更大；简单的应用程序很容易构建。

3.  网络

    > > 接近度低（浏览器完成工作，不同的浏览器表现不同），交互性高（DOM / CSS / Javascript /浏览器），复杂性高（大量移动部件）

4.  Silverlight（可能是其他 RIA）

    > > 比 RAD/MFC/VB 风格的界面以及 Web 更接近，交互性高，复杂性低（例如，此环境中的动画与 OpenGL 等相比）

**问题**

1.  这三个轴有意义吗？我知道可以做出一些概括，例如权衡适用于每种环境的交互性和复杂性，但我看到了每种环境固有的优点和缺点。

2.  UI 中是否有另一个值得讨论的轴或特征？

3.  对我们如何发展的未来影响（RIA 成为主导，等等......）

4.  任何其他反馈 (+/-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T22:15:40.210

我认为您的方法的关键是了解您的受众，他们是其他开发人员，还是想更多了解开发过程的人？

我认为 UI 的绝对关键是可用性，其他一切（包括易于开发）都从属于它。可编程性通常是工具的结果，如果技术足够普及，那么工具就会出现，windows dev 曾经很糟糕，然后几年后每个人都是 VB 编码器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T17:43:08.610

我认为**便携性**也值得一提。很多时候，UI 组件会阻止应用程序移植到其他平台。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T17:43:38.563

对于交互性轴，我认为需要讨论可用性，因为灵活性和功能只有在它们使 UI 更可用时才有帮助。用户需要能够快速确定如何使用该软件，它应该是直观的。

# c# - Linq to Sql - 从 1:Many 中选择

> ID：566370
> 
> 赞同：0
> 
> 时间：2009-02-19T17:40:35.113
> 
> 标签：c#, asp.net, linq-to-sql

我是使用 Linq 的新手，刚刚开始了一个辅助项目来学习一些基础知识。我目前正在使用 Linq to Sql，我的所有数据库表关系都运行良好。目前我有一个客户表和一个项目表。每个客户可以有 1 个或多个项目。因此，正如您所期望的，在 Linq 施展魔法之后，每个 Client 对象都有一个 Project 对象的集合。

我正在使用下面的代码，它运行良好，但我认为有更好的方法。我需要向我的方法传递一个 ProjectID，然后从客户端中选择该项目：

```
 private void PopulateStatusView(int projectID)
    {
        MyDataContext db = new MyDataContext();

        var client = (from u in db.Clients
                      where u.id == Convert.ToInt32(Session["ClientID"])
                      select u).SingleOrDefault();

        if (client != null)
        {
            foreach (Project currentProject in client.Projects)
            {
                if (currentProject.id == projectID)
                {
                    // Project Selected Here
                    statusProjectName.Text = currentProject.name;
                }
            }
        }
        else
        {
             // Session Expired
        }
    } 
```

谁能让我知道是否有更好的解决方案，而不是遍历每个项目。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T17:44:10.920

获取具有特定项目 ID 的客户端：

```
var client = (from u in db.Clients
              where u.id == Convert.ToInt32(Session["ClientID"]) && 
                    u.Projects.Any(x=>x.id == projectID)
              select u).SingleOrDefault(); 
```

获取项目：

```
var project = (from u in db.Clients
              where u.id == Convert.ToInt32(Session["ClientID"]) && 
                    u.Projects.Any(x=>x.id == projectID)
              select u.Projects.Where(x=>x.id == projectID).Single()).SingleOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T17:45:36.973

尝试这样的事情：

```
clients.Projects.Where(
    p => p.id == projectID 
    && p.name == statusProjectName.Text); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T17:45:46.257

您可以将 foreach 查找替换为以下内容：

```
var project = client.Projects.Where(p=>p.id==projectID).SingleOrDefault();
if (project != null) statusProjectName.Text = project.name; 
```

# app-store - iPhone Web 应用程序和 iPhone 应用程序有什么区别？

> ID：566371
> 
> 赞同：7
> 
> 时间：2009-02-19T17:40:39.263
> 
> 标签：app-store, iphone

我问这个是因为我即将进入 iPhone 开发领域，并且我一直在这里专心关注与 iPhone 相关的问题。

这个问题： [在 iPhone 上检索当前本地时间？](https://stackoverflow.com/questions/566265/retrieving-current-local-time-on-iphone)

有一条评论询问“您是在创建 iphone 网络应用程序还是 iphone 应用程序”，我的问题是，是否有区别，如果有，那有什么区别。

如果“网络应用”只是一个 CSS 问题，或多或少是一个考虑到移动设备的传统网络应用，那么您是否需要 Mac 来开发这些应用？或者它可以在任何平台上开发并通过 Safari 访问。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-19T17:43:34.243

**Web 应用程序**可通过 Safari 访问，无需安装。你只是去一个有一个特殊的 iPhone 样式表的网站。

本**机应用程序**在设备上运行代码，并可通过应用商店安装。您可以访问 iPhone 使用的所有 UI 元素，并且可以执行 Mobile Safari 中无法实现的 3D 等操作。

您需要 Mac 来制作原生应用程序，但可以使用您选择的任何平台制作 Web 应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-16T15:56:50.573

中间有一些东西。例如，您可以使用 phonegap 创建一个基于 html、css、js 的 iphone 应用程序，该应用程序可从应用商店下载。您的应用程序甚至可以使用 javascript 中的一些 iphone 硬件 cmd。

# asp.net-mvc - JSON 请求中的 ASP.NET MVC URL

> ID：566374
> 
> 赞同：1
> 
> 时间：2009-02-19T17:41:16.393
> 
> 标签：asp.net-mvc, url-routing

> **警告：**问题指的是 ASP.net MVC 的 RC 版本。
> 问题在 ASP.net MVC 1.0 中得到解决

我有一个页面，它从我的控制器上的 Action 请求一些 JSON，然后用该数据填充一个表。在我的 JSON 响应中，我包含了一个包含一些字段的匿名对象。其中一个字段是另一个控制器/操作的 URL。我在我的控制器中使用 Url.Action 设置 URL。

问题是出现的链接无效（我猜是由于上下文）。例如，“托管”页面 URL 如下所示：

```
/Challenges/Detail/4/HEADLINE which is {controller}/{action}/{id}/{slug} 
```

我的 json 请求中的 URL 调用我的帐户控制器上的 Profile 操作。URL 应该是这样的：

```
/Profile/username 
```

然而，它作为

```
../Profile/username 
```

解决为

```
/Challenges/Detail/4/Profile/username 
```

如果可能的话，我想避免对任何链接进行硬编码。我在这里有什么选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T20:45:25.447

Craig Stuntz 昨天回答了这个问题，但他的回答消失了。他是对的，我需要安装 ASP.NET MVC RC Refresh

# javascript - 有没有办法在 iframe 的 designMode 中跟踪选择范围？

> ID：566376
> 
> 赞同：2
> 
> 时间：2009-02-19T17:42:03.463
> 
> 标签：javascript, html, dom, cross-browser

我已经对此进行了一段时间的试验，但没有得到任何效果——有没有办法在 iframe 的 designMode 中跟踪 mouseup 和选择，最好是在跨浏览器兼容模式下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:02:58.833

[这是我在这里](http://www.ozzu.com/programming-forum/wysiwyg-text-formating-t88886.html)找到的一小段代码，希望对您有所帮助：

```
function setRange(rte) {
    //function to store range of current selection
    var oRTE;
    if (document.all) {
        oRTE = frames[rte];
        var selection = oRTE.document.selection;
        if (selection != null) rng = selection.createRange();
    } else {
        oRTE = document.getElementById(rte).contentWindow;
        var selection = oRTE.getSelection();
        rng = selection.getRangeAt(selection.rangeCount - 1).cloneRange();
    }
    return rng;
} 
```

似乎您可以`selection`在文档对象上使用该属性，然后使用该`createRange()`方法。这`if-else`可能是为了跨浏览器支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T18:14:53.650

这是Quirksmode[的 Range 简介](http://www.quirksmode.org/dom/range_intro.html)。安全地跨浏览器获取文本选择的一个很好的概述。

# jsp - JSP/Servlets 触发 SQL 更新

> ID：566378
> 
> 赞同：0
> 
> 时间：2009-02-19T17:42:21.373
> 
> 标签：jsp, servlets, triggers, sql-update

我有一个小窗口，里面有一个 IRC 客户端，当用户登录到 jsp 页面时会打开它。我正在尝试找出一种在关闭弹出窗口后调用 SQL 更新语句的方法。

有人对我该如何做这件事有任何想法吗？

谢谢

〜凯尔G

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T19:13:43.397

一种可能的解决方案是让弹出窗口通过 AJAX 向服务器执行“心跳”请求，以指示它仍然处于打开状态。在服务器端，使用“最后更新”时间戳维护列出活动窗口的表。在服务器上每隔几秒定期检查一个线程（在应用程序启动时启动 servlet），并在 X 秒内未提供心跳的那些窗口上执行更新。

# handheld - 任天堂 DSi SDK：入门

> ID：566381
> 
> 赞同：8
> 
> 时间：2009-02-19T17:43:14.057
> 
> 标签：handheld, nintendo

有没有人有一个很好的起点来学习新任天堂 DSi 的开发？你需要什么样的硬件来开发和测试这样的东西？您可以使用标准 DS 为 DSi 开发吗？您需要使用什么语言？

[Bonus Question]：我还听说新的 DSi 将获得一个类似于 Apple 的 App Store - 开发者可以使用它来销售游戏吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-19T17:48:26.243

据我所知，获得 Nintendo DS/DSi 开发套件的唯一*合法*方法是直接从 Nintendo 获得——这需要你有很多钱，最好是与大型游戏发行商签订合同。除了 Xbox 360 和 XNA 框架之外，所有主要游戏机都是这种情况。我预计他们不会很快改变他们的商业模式。控制 SDK 可确保硬件制造商从为其控制台发布的任何游戏中分得利润。

如果您想了解 DS 编程是什么样的，可以使用一些“非官方”（阅读：破解和破坏许可协议）自制 DS 编程环境。在 Google 上搜索“DS Homebrew”可能会找到很多信息。

值得一提的是，大多数游戏机（包括 DS）的开发都是用 C 或 C++ 完成的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-20T06:59:48.593

如果你想现在就开始。拿一辆 DS 'homebrew' 购物车；M3、Acekard、Cyclowiz、R4 等

现在检查一下，Acekard ( [http://www.acekard.com/](http://www.acekard.com/) ) 已经有一张 DSi 兼容卡。我确信已经有其他人了。从技术上讲，Slot 1 墨盒的 DS 和 DSi 之间没有变化（完全兼容），所有额外功能都与相机、连接性和从 SD 卡运行的能力有关。

有关开发部分的更多信息，请查看以下论坛；[http://desmume.org](http://desmume.org) 他们也有（顾名思义）一个 DS 模拟器供下载。

奖励：根据过去的记录，任天堂为开发者开放 NDi 的机会微乎其微。我认为通过 WiiWare 在 Wii 上进行了讨论，但很长一段时间以来，该领域都没有什么新鲜事。仅从已知/成熟的公司发布。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T01:55:40.713

不久前我尝试在 DS 上进行开发。据我所知，DevKitPro 有一个你可以使用的 ARM 库。我主要使用 Func-C，但支持 C++。从技术上讲，我认为您可以在任何具有 ARM 架构编译器的东西上进行编程。

当 DSi 在加拿大推出时，我希望再次涉足它。更快的处理器、持久的存储和更多的内存应该会产生一些甜蜜的自制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-23T21:32:47.883

如果您只是想为了好玩而进行一点 DS 开发，那么 devkitPro 自制套件在这一点上相当复杂。这是一个手册的链接，它介绍了使用这个工具包编写一个简单的游戏：http: [//www.patater.com/manual](http://www.patater.com/manual)

可悲的是，如果你想获得官方工具包甚至成为 DSIware 开发人员，看起来你必须拥有一家成熟的游戏公司并咳出几千美元。 [http://www.nintendolife.com/forums/dsiware/info_on_dsi_ware_development](http://www.nintendolife.com/forums/dsiware/info_on_dsi_ware_development)

# c++ - msxml 删除 CDATA 部分中的换行符

> ID：566389
> 
> 赞同：4
> 
> 时间：2009-02-19T17:45:40.687
> 
> 标签：c++, xml, parsing, msxml

我有一个带有 CDATA 部分的简单 XML，例如：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<config>
    <input>
    <![CDATA[
line
another line
and another
    ]]>
    </input>
    ...
</config> 
```

我有使用 MSXML 解析 CDATA 部分的当前代码。

```
for (int i = 0, count = pChildNodes->Getlength(); i < count; ++i) {
    IXMLDOMNodePtr pNode = pChildNodes->Getitem(i);
    if (pNode->GetnodeType() != NODE_COMMENT && pNode->GetnodeType() != NODE_TEXT) {
        if (pNode->GetnodeType() == NODE_CDATA_SECTION) {
            IXMLDOMCDATASectionPtr pCData = pNode;
            _bstr_t a = pCData->Getdata();
            _variant_t b = pCData->GetnodeValue();
            _bstr_t c = pCData->Gettext();
            _bstr_t d = pCData->Getxml(); 
```

但没有一个`a`,`b`或保留 XML 中`c`的`d`换行符。这是输出：

```
lineanother lineand another 
```

当我创建文档时，我设置了保留空白标志：

```
m_pXmlDoc->put_preserveWhiteSpace(VARIANT_TRUE); 
```

考虑到换行符，您对如何获得 CDATA 部分的值有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-21T20:55:49.950

为什么不在将数据存储到 XML 文档中之前对数据进行 Base64 编码？那么你甚至不需要 CDATA 标签。检索时只需 Base 64 解码该值，原始数据将全部保留。

这个解决方案有两个缺点：

1.  存储的数据会稍大（以 Base 64 字节计）
2.  您显然会失去 XML 文件中的纯文本可读性（因为它将是 Base 64 编码的）

当然，积极的一面：不必担心 CDATA 问题，这有望超过对您的情况的负面影响。

url 编码、html 编码和添加斜线都是需要额外工作才能实现的替代方案，但保留一些可读性以及较小的尺寸。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T23:02:30.217

我不认为 CDATA 应该保留空格。它通常用于转义字符，例如 < 或 >。[http://www.javacommerce.com/displaypage.jsp?name=whitespa.sql&id=18238](http://www.javacommerce.com/displaypage.jsp?name=whitespa.sql&id=18238)这可能会有所帮助。

# javascript - 验证用 javascript 分隔的多个电子邮件逗号

> ID：566396
> 
> 赞同：8
> 
> 时间：2009-02-19T17:47:38.613
> 
> 标签：javascript, regex

我想验证一个字符串，它可以是一封电子邮件或多个用逗号分隔的电子邮件。

例如：

bill.gates@hotmail.com -> 真实
账单 -> 虚假
bill.gates@microsoft.com,steve.jobs@apple.com” -> 真实
bill.gates@microsoft.com,steve.jobs@apple.com, bob “-> 错误
bob,bill.gates@microsoft.com,steve.jobs@apple.com”-> 错误

我提出了下一个适用于测试用例的代码。

```
function validateEmail(field) {
    var regex=/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/i;
    return (regex.test(field)) ? true : false;
}

function validateMultipleEmailsCommaSeparated(value) {
    var result = value.split(",");
    for(var i = 0;i < result.length;i++)
    if(!validateEmail(result[i])) 
            return false;           
    return true;
} 
```

这是最快的方法吗？如果我想允许怎么办；和，作为分隔符？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-19T18:06:42.390

您不应将顶级域与`[A-Z]{2,4}`：

`.museum`或呢`.travel`？IDNA 域如`.xn--0zwm56d`or`.xn--11b5bs3a9aj6g`呢？

此外，拥有像`"John Doe"@example.org`.

在我看来，你应该在客户端检查的是地址是否包含一个`@`，并且它后面是否至少有一个`.`。在服务器端，您可以检查服务器是否存在（您甚至可能想尝试连接到适当的 SMTP 端口）或发送验证邮件。

其他一切都容易出错，因为检查有效电子邮件地址的实际正则表达式[看起来像这样](http://www.ex-parrot.com/~pdw/Mail-RFC822-Address.html)。

* * *

还有，这

```
return (regex.test(field)) ? true : false; 
```

是一个严重的 WTF -`test()`已经返回一个布尔值！

* * *

如果您想允许不同的分隔符，请使用正则表达式而不是字符串进行拆分，例如

```
value.split(/,|;/) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T17:50:02.437

使用`var result = value.split(",")`. 你最终得到一个数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-12T05:33:59.627

正则表达式：

```
((\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)*([,])*)* 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T18:27:17.717

一般来说，*无法*验证电子邮件地址。语法上有效的东西不一定会去任何地方，即使它确实会被阅读。

即便如此，涵盖所有可能的语法正确地址（根据适用的 RFC）需要一个极其复杂的正则表达式（参见第 1 版“掌握正则表达式”（Friedl，O'Reilly），用于 4724 或 6598 个字符版本，而这些可能不处理 IDN）。例如，撇号是本地部分的有效字符，您可以在电子邮件中进行评论。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-19T16:53:24.387

我会`$.trim(result[i])`在该`validateMultipleEmailsCommaSeparated`函数中添加一个，因为很多人会在逗号后添加空格。

当然，这是一个 jQuery 的事情，所以按照你的方式做同样的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-03T08:07:27.763

我使用了 validationEngine 和 underscore.js 来做到这一点：

```
function validateEmail(field, rules, i, options) {
if (!_.all(field.val().split(","), function(candidate) { return $.trim(candidate).match(options.allrules.email.regex); } ))
    return options.allrules.email.alertText;
} 
```

然后用以下内容装饰我的表单字段：

```
<input class="validate[required,funcCall[validateEmail]]" type="text" name="contact_email" id="contact_email" value=""  /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T17:49:15.543

如何将字符串拆分为一个数组并循环遍历它，一次只传递一个电子邮件地址？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-10T12:57:21.797

尝试这个

```
 function validateEmails(string) {
        var regex = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
        var result = string.replace(/\s/g, "").split(/,|;/);        
        for(var i = 0;i < result.length;i++) {
            if(!regex.test(result[i])) {
                return false;
            }
        }       
        return true;
    } 
```

接受逗号和分号作为分隔符，如果你只想要逗号作为分隔符，请更改它

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-09-11T05:57:27.113

将此用于 php preg_match_all()

```
$pattern = '/([\w+\._%-]+@[\w+\.-]+\.[\w+]{2,4}[^,;\s])/';
$text = 'abc@efg.com, efg, hij@emg.com, ak@efg asfbd@efg.com ab@sdfs.com abc+efg@pqr.com';
preg_match_all($pattern, $text, $match);
var_dump($match); 
```

```
array(2) {
  [0] =>
  array(5) {
    [0] =>
    string(11) "abc@efg.com"
    [1] =>
    string(11) "hij@emg.com"
    [2] =>
    string(13) "asfbd@efg.com"
    [3] =>
    string(11) "ab@sdfs.com"
    [4] =>
    string(15) "abc+efg@pqr.com"
  }
  [1] =>
  array(5) {
    [0] =>
    string(11) "abc@efg.com"
    [1] =>
    string(11) "hij@emg.com"
    [2] =>
    string(13) "asfbd@efg.com"
    [3] =>
    string(11) "ab@sdfs.com"
    [4] =>
    string(15) "abc+efg@pqr.com"
  }
}
```

# .net - 我可以保护我的 ASP.NET 应用程序免受反编译器的攻击吗？

> ID：566400
> 
> 赞同：2
> 
> 时间：2009-02-19T17:48:04.417
> 
> 标签：.net, asp.net, decompiling

2.  我也知道发布时可以预编译 ASP.NET
3.  我知道 .NET 应用程序被编译为 MSIL，可以通过 Red Gate 的 .NET Reflector 等工具轻松恢复为任何 .NET 语言。
4.  我想开发和交付一个 ASP.NET 站点，买方将在其中托管该站点，但无法访问代码。

有什么办法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-05T15:06:53.153

以我的经验，混淆代码的人不会产生值得麻烦的代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T17:55:00.490

告诉他们不要。你永远不会阻止一个坚定的逆向工程师，但如果它在合同中，你将有追索权反对从中获利的人。

混淆使调试变得更加困难，不仅对您，而且对您的客户（如果他们插入您的代码）也是如此。

避免它的另一个原因是倾向于包括“秘密”端口、加密密钥或握手。如果您的代码中有任何这些，您将需要找到一个非常不同的模型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T14:26:06.230

当您作为 dll 发布时，您可能会放心，您实际上并未将*.cs/ .vb 文件发布到网站上。*我认为这是最容易设置的路障。

我意识到您仍然可以从 DLL 中获取代码，但源文件本身不需要存在。

将您的 Web 项目转换为 Web 应用程序并构建它。输出将是一个 dll。将其与所有媒体文件（aspx、gif、png 等）一起推出，您的源应该对不勤奋的人隐藏。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-19T17:53:19.177

这被称为“混淆”。有商业产品可以做到这一点。它不会完全阻止反编译，但它会弄乱你程序的内部，以至于很难对它做出正面或反面。

请注意，在特殊情况下它也可能会破坏您的代码，因此您将不得不使用它的选项，直到您让它工作。

Dotfuscator 很受欢迎，Visual Studio 附带一个精简的免费社区版本（虽然不确定是哪个版本）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-11T21:24:42.040

只是一个想法，但可能不是你的情况：

如果可能的话，在您的应用程序的某个位置使用 Web 服务。分布式代码使得只有客户端逻辑可用于反编译。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-14T09:28:29.493

查看[Manco .NET 许可系统](http://www.mancosoftware.com/licensing/index.htm)。它提供了许可证保护、代码混淆和代码加密的功能。可以使用几种不同的方式来保护 ASP.NET 应用程序：使用来自 HTTP 请求的许可证密钥或域名称 (http://mancosoftware.blogspot.com/2010/10/protect-aspnet-application-using-name. html），例如。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T14:33:34.437

有一种方法可以使用 Visual Studio 项目模板预编译 ASP.NET 网站或项目中的所有 aspx/ascx 文件：

在 ScottGu 的博客上阅读此处：[VS 2008 Web 部署项目支持已发布](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)

编译部署项目会为您的所有 aspx/ascx 文件创建一个程序集。

如果你想*真正隐藏*（使不可读）你的源代码，你应该[使用专业的混淆器软件](https://stackoverflow.com/questions/337134/what-is-the-best-net-obfuscator-on-the-market)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-19T17:50:54.373

你可以看看混淆。 [Dotfuscator](http://www.preemptive.com/dotfuscator.html)是一个很好的起点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T14:27:44.933

你走在正确的轨道上。DLL 是一个很大的帮助，但它可以被反编译至少得到一些。

使用像 Dotfuscator 这样的混淆器是一个很好的额外步骤。 [此常见问题解答](http://www.preemptive.com/dotfuscator-faq.html)是了解混淆器的良好起点

关键是要确定你在做什么。如果您正在部署代码，则很难阻止某人调用代码中的方法。如果您只是想阻止他们获取实际来源，那会更容易，并且应该可以进行混淆。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-05T14:28:43.323

我总是选择将网站预编译成 DLL，而不是在线包含代码。这意味着匿名用户将无法访问您的代码。

但是，如果您担心对服务器具有管理员访问权限的人，他们可以将您的二进制文件反汇编成几乎可读的东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-05T14:56:40.333

也许我错了，但我不相信 IIS 会提供 bin 文件夹中的任何文件（它不适合我，我认为这是设计使然，就像你不能下载 web.config -它甚至不会列出目录内容）。如果这是正确的，那么我不相信黑客有办法首先获取 dll，除非他们可以获得对服务器的文件系统访问权限。

如果您遵循上面给出的关于编译成单个 dll 的建议，我认为您不需要混淆器（除非您担心具有文件系统访问权限的人，在这种情况下，我认为您还有其他问题！）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-05T15:08:21.450

你用的是哪个版本的VS？在 VS2005 SP1 中有一个新的项目类型叫做 Web 部署。右键单击解决方案资源管理器中的网站名称，您应该会看到一个选项“添加 Web 部署项目” - 这会向您的解决方案添加一个新项目，该项目将创建一个 DLL 并更改 aspx 页面以引用它。

当您构建解决方案时，它会在 Web 部署项目文件夹中创建具有单个 dll 的站点版本。将此复制到服务器，设置您的数据库和任何文件系统权限（例如上传等），然后您就离开了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-05T15:09:07.330

当您将项目发布为二进制文件时，编译器将在 bin 文件夹中创建 DLL，并且还会创建您拥有的所有页面，但不包含代码，只有一行表示它是一个标记文件。因此，当用户浏览您的网站时，他们将照常浏览页面。然后，您的页面将在服务器端指向 dll 中的正确代码

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-05T16:19:58.357

作为 DLL 发布后，不要忘记将它（以及其他服务器端文件，如`Web.config`）放在 IIS 不提供的路径中。

# mysql - Ruby On Rails 很慢...？

> ID：566401
> 
> 赞同：7
> 
> 时间：2009-02-19T17:48:24.417
> 
> 标签：mysql, ruby-on-rails, ruby, mongrel

我正在编写一个 Web 应用程序来监控家具厂的生产流程。它有数千个数据要处理。到目前为止，我在 Mongrel + MySQL 上运行 RoR，它真的很慢（某些视图需要 2-4 分钟）。当我查看 RoR 日志时，数据库查询似乎并不慢（0-10 毫秒）。

RoR 将数据库数据转换为对象时速度慢吗？杂种很慢吗？

**编辑**：第一件事：我在开发。环境。在生产环境中，最慢的视图需要 2 分钟（在一台好计算机上会降低到不到 1 分钟，我的是 5 岁）。借助 ruby​​-prof 和一些常识，我发现了哪些方法会降低应用程序的速度。问题是在大型数据集上循环调用单个 SQL 查询：

```
ofs = Ofkb.find_by_sql ["..some large SQL query..."]

for of in ofs # About 700-1000 elements
   ops = Operation.find(..the single query..)
   etc.
end 
```

以下是这些方法的 ruby​​-prof 结果：

```
 %self     total     self     wait    child    calls  name
 32.19     97.91    97.91     0.00     0.00       55  IO#gets (ruby_runtime:0}
 28.31     86.39    86.08     0.00     0.32    32128  Mysql#query (ruby_runtime:0}
  6.14     18.66    18.66     0.00     0.00    12432  IO#write (ruby_runtime:0}
  0.80      2.53     2.42     0.00     0.11    32122  Mysql::Result#each_hash (ruby_runtime:0} 
```

问题是：我无法真正避免那些单一的查询。我有数以千计的事件，我必须从中计算复杂的数据。现在我在那些没问题的方法上使用 memcached，除非你是第一个请求页面的人。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-20T09:38:56.577

我会同意其他所有人的观点。你必须配置文件。在您知道具体是什么导致缓慢之前，对您的代码做任何事情都是没有意义的。试图在不了解原因的情况下解决问题就像感觉不适并决定进行大量手术直到您感觉好些。首先诊断你的问题。它可能是网络设置之类的小东西，也可能是代码中的错误行。

分析的一些提示：

[如何分析您的 Rails 应用程序](http://cfis.savagexi.com/2007/07/10/how-to-profile-your-rails-application)

[性能测试 Rails 应用程序](http://guides.rubyonrails.org/performance_testing.html)

[At the Forge - 分析 Rails 应用程序](http://www.linuxjournal.com/article/10128)

一旦你找到了瓶颈，你就可以弄清楚该怎么做。

我推荐这些视频： [Railslab Scaling Rails](http://railslab.newrelic.com/scaling-rails)

现在根据教授结果修订：

好的。现在您可以看到您的问题是您正在使用基于循环通过另一个活动记录查询的结果的查询进行某种计算，我建议您考虑构建一个自定义 SQL 语句，结合您的初始选择条件和循环计算以获得你需要的东西。您绝对可以通过优化 SQL 来加快速度。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T18:01:48.927

每个视图访问执行了多少个 0-10 毫秒的查询？引用了数据模型的哪些部分？您是否正在使用 :include 来获得对关联的渴望加载？

Rails 和你做的一样慢。理解带来速度（通常！）

扩展上述内容，您是否有 has_many 关联，特别是，您的视图引用没有 ? 的“多”方`:include`？这会导致您`find(:all)`在主表上执行与详细信息的连接 - 如果您有大量详细记录并且正在单独处理所有这些记录，这可能会变得昂贵。

像这样的东西：

```
Master.find(:all, :include => :details) 
```

...可能有帮助。不过，仍然从稀疏的信息中猜测。

[这里](http://www.bestechvideos.com/2007/04/29/railscast-eager-loading)有一个关于这个主题的旧 Railscast

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-19T18:08:48.787

虽然 RnR[以速度](http://www.theregister.co.uk/2008/04/21/bray_ruby_rails/)慢着称，但这听起来太极端了，不能成为语言的简单问题。

您应该运行探查器来准确确定哪些函数很慢以及为什么。最常见的拖慢 Web 应用程序的是“ [n+1 问题](http://www.pbell.com/index.cfm/2006/9/17/Understanding-the-n1-query-problem)”。也就是说，当您的数据库中有 n 个数据项时，应用程序会对数据库进行 n 个单独的查询，而不是通过一个查询来获取它们。但是在您运行分析器之前，您无法**知道。**[ruby-prof](http://rubyforge.org/projects/ruby-prof/)是我用过的一种分析器。

**根据配置文件结果编辑：**

我坚信您***始终***可以删除查询循环。正如 Mike Woodhouse 所说，Rails 的做法是使用*[has_many](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)*或其他关联指定表之间的关系，然后让 rails 自动生成表连接，这是清晰、快速和“Rails 方式”。但是，如果您从裸 SQL 开始，或者如果关联在这种情况下不起作用，您可以简单地自己生成适当的连接。如果一切都失败了，您可以创建一个视图或非规范化表，其中包含以前通过循环找到的结果。事实上，您必须遍历生成的查询这一事实*可能*表明您的表设计本身存在一些缺陷。

综上所述，如果缓存查询结果对您来说足够好，那么请继续使用它。需要时进行优化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-19T17:56:59.117

这不正常。你有一些让你慢下来的逻辑。尝试注释掉您认为需要很长时间的代码片段，看看是否有帮助。如果是这样，那么您需要弄清楚如何优化该逻辑。

如果您在一个循环中迭代大量对象进行大量计算，那么它当然会很慢。

这些类型的问题可以在任何语言或框架中出现。虽然 Ruby 没有其他语言那么快，但在大多数情况下它已经足够快了。如果您需要不断地使用大型数据集进行计算，那么 Ruby 可能不适合您。考虑编写一个 Ruby C 扩展来处理你的性能消耗代码。但首先只是尝试诊断和重构。

最后，查看[RubyProf](http://ruby-prof.rubyforge.org/)看看它是否可以帮助您找到瓶颈。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-19T18:07:15.073

前两个答案很有帮助，尤其是使用性能监控工具。我使用[New Relic RPM](http://www.newrelic.com/features.html)，它在过去帮助了我很多。

但是，当您试图从 3 秒加速到 1 秒以下时，这些工具确实是最好的。

在任何正常情况下，一个视图渲染 2-4 分钟是绝对不正常的。

您能否向我们展示您的一些开发日志以找出瓶颈所在？

您是否将浏览器加载图像、javascript 或其他文件所需的时间计算在内？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T18:13:06.257

这么长的执行时间会让我怀疑网络问题 - 也许 DNS 查询在主 DNS 服务器上超时？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T20:18:53.600

您可以尝试使用 JRuby 或切换到 Ruby 1.9。
它们都应该会带来巨大的性能提升。
JRuby 的问题是使用 C 的 gem 无法编译/工作。jruby 的“gem”应用程序安装了 Java 等效项，但有些 gem 根本不起作用

Ruby 1.9 基本上会有同样的问题。语法发生了一些变化，但主要问题是大量的 gem 不再起作用。人们正在进行更新（在[http://isitruby19.com/](http://isitruby19.com/)查看进度）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T20:18:48.177

为什么不预先获取所有数据并让您的 for 循环在内存中本地找到它，而不是每次都查询数据库？对单个视图的 1000 次查询表明您的设计存在严重问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T11:19:15.640

关于这个主题有一些很好的屏幕截图[http://railslab.newrelic.com/scaling-rails](http://railslab.newrelic.com/scaling-rails)

像片段缓存和使用 :include （以避免 n+1）这样的事情会有所帮助。听起来您已经在使用 memcached，那么为什么不 curl url 来预取缓存呢？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-11-11T17:52:59.337

当我将服务器绑定到盒子 IP 地址而不是 0.0.0.0 时，这加快了我的速度。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-23T10:33:45.370

您可以在执行任何操作之前先对代码进行分析，但是，for 循环内部的查询是导致性能问题的一个非常常见的原因，乍一看这似乎是您的问题。[无论如何，您可能会在这里](https://github.com/ruby-prof/ruby-prof)找到一个实用的分析器：

正如在其他答案中已经说过的，如果两个模型都是相关的，您应该预先加载关联，这意味着指示 Active Record 执行连接查询：

```
#left outer join
ofkbs=Ofkb.includes(:operation).where(name: "banana") 
```

如果您不需要 ofkbs 而只需要操作，则可以执行内部连接

```
#inner join (discards the Ofkbs that do not have any operation)
operations=Operation.joins(:ofkb).where(ofkb:{name:"banana"}) 
```

此解决方案仅执行一个查询，并允许您随后遍历已经从数据库中收集的数据：

```
operations=ofkbs.map{|of| of.operations}.flatten

operations.each do |o|
  do_whatever_you_want_with_operation(o)
end 
```

如果查询非常复杂，您应该改用[arel](https://github.com/rails/arel)。

# php - 哎呀，表演结束了？

> ID：566411
> 
> 赞同：3
> 
> 时间：2009-02-19T17:50:43.157
> 
> 标签：php, oop

我正在研究用 php/mysql 编写的网站。当我第一次编写它时，它是在 html 等中嵌入大量 php 的意大利面条 - 很难维护。

我用 OOPS 用一个很好的模块化结构重写了整个东西，现在它更容易维护和扩展。

但是在使用[webwait](http://webwait.com/)和 siege 测试站点性能时，更新、结构更好的版本似乎比意大利面条代码版本运行和加载更慢。

加载时间相差近 1 秒 - 2.39 秒与 3.81 秒

除了 php 代码之外没有其他任何改变 - 不是 js，不是 css

那么这里的问题是什么？我应该恢复到旧代码吗？这发生在其他人身上吗？

编辑：

*   我已经使用 cachegrind 进行了一些分析，包括在内，我认为代码非常好。

*   我也知道问题不完全是 OOPS，而是更大的结构等，而且 OOP 根本不能保证更好的性能。

*   我也多次运行代码。

*   我已经将 cachegrind 与 kcachegrind 一起使用，包括在内，围攻（Rasmus lerdorf 在他的 drupalcon 2008 关于[“简单就是困难”的](http://szeged2008.drupalcon.org/program/sessions/rasmus-lerdorf-keynote-simple-hard)演讲中概述的大多数工具）

**我想知道的是其他人如何处理这个问题。**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-19T17:56:31.517

**“我应该恢复到旧代码吗？”**

如果我说 revert，你会说“看，我知道 OO 是一个失败的单元，没有人可以制作一个有效的 OO 应用程序”。那是错误的。

如果我说不要还原，你会说，“但它的速度慢得令人无法接受。”

那么，还剩下什么？

你必须写得**更好**。向前。重写您的 OO 以使其真正起作用。OO 不是“魔法”——它不能保证任何事情。有不好的 OO 程序和好的 OO 程序。在你的情况下，你显然有改进的余地。

因此，获取一些性能分析工具并找出时间都花在了哪里。

另外，不要“优化”——重写。

很有可能您正在进行某种占用大量时间的搜索。消除搜索。使用更好的容器和集合（哈希映射、集合等）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-19T17:54:59.833

分析代码。我不知道在 PHP 中是如何做到这一点的，但这是弄清楚发生了什么的唯一合理方法。

*有时*使代码更优雅会对性能产生不利影响，但通常不会达到那种程度。你需要弄清楚时间的去向，并修复那个位。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T17:56:16.307

```
There's a difference of nearly 1 second in loading time - 2.39s vs 3.81s 
```

这是 3.81-2.39 = 1.42s 的差异，超过较小值的 50%，所以在我看来这不是一个小数字。您是否多次运行测试，以便正确摊销初始编译/解释成本？您是否考虑过尝试引入计时器以查看比以前花费更多时间的地方？这些将是我的建议，因为您似乎已经引入了很多抽象并且现在看到了它的代价。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T18:00:04.013

尝试设置[Xdebug](http://www.xdebug.org/docs/profiler "Xdebug")，看看它能告诉你什么。其他人提到您应该使用分析器检查它。我同意，Xdebug 可以为您提供一个以及一些其他有用的功能。您选择的 IDE 甚至可以与 Xdebug 集成。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T15:41:36.960

我可以想到几点需要考虑：

*   这不是 OOP 与意大利面条代码的选择。还有其他范式可能与 OOP 一样可维护和结构化，但具有不同的性能特征。可以仅使用简单的过程语言特性来编写 OOP 代码（许多大型 C 框架使用非常 OOP-ey 的风格。）在某些情况下，功能性更强的风格也可能更简单。OOP 不是一个真正的范式。
*   有不同程度的 OOP。在大多数语言中，将数据建模为对象不会导致明显的性能差异（虽然我不知道 PHP 在这方面的表现如何，但我总是认为 PHP 是最糟糕的）。但是，虚函数、继承（尤其是多重继承）速度较慢，并且会增加通常可以避免的开销。您使用哪些 OOP 功能？是否有更简单的 OOP 设计可以完成这项工作，但对“慢”语言特性的依赖较少？

最重要的是，通常显然适用（您可以优化算法，启用缓存或预编译等等 - 但虽然这些可能有很大帮助，但它们并不特定于 OOP）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T18:00:51.720

需要考虑的一件事：您使用的是[APC](http://php.net/apc)还是其他 PHP 操作码缓存解决方案？如果没有，每次加载页面时，您的所有代码都会从头开始重新解释。这肯定会影响性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T18:01:17.727

OOP意味着大量的函数调用，而动态语言中的函数调用很慢。因此，将旧代码“翻译”成 OOP 版本会减慢它的速度。做一个完整的重写。

# java - 使用反射调用方法

> ID：566418
> 
> 赞同：4
> 
> 时间：2009-02-19T17:51:58.273
> 
> 标签：java, reflection

是否可以通过类的反射来调用方法？

```
class MyObject {
    ...   //some methods

    public void fce() {
        //call another method of this object via reflection?
    }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T17:57:23.610

绝对地：

```
import java.lang.reflect.*;

public class Test
{
    public static void main(String args[]) throws Exception
    {
        Test test = new Test();
        Method method = Test.class.getMethod("sayHello");
        method.invoke(test);
    }

    public void sayHello()
    {
        System.out.println("Hello!");
    }
} 
```

如果您有问题，请发布一个具体问题（最好用一个简短但完整的程序来演示该问题），我们会尝试解决它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T18:00:34.077

你可以..但是可能有更好的方法来做你所追求的（？）。要通过反射调用方法，您可以执行以下操作 -

```
class Test {

    public void foo() {
        // do something...
    }

    public void bar() {
        Method method = getClass.getMethod("foo");
        method.invoke(this);
    }
} 
```

如果您要调用的方法有参数，那么它会略有不同 - 除了要调用它的对象之外，您还需要将参数传递给调用方法，并且当您从 Class 获取方法时，您需要指定参数列表类型。即 String.class 等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T18:06:43.233

```
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

public class Main
{
    public static void main(final String[] argv)
    {
        final Main main;

        main = new Main();
        main.foo();
    }

    public void foo()
    {
        final Class clazz;
        final Method method;

        clazz = Main.class;

        try
        {
            method = clazz.getDeclaredMethod("bar", String.class);
            method.invoke(this, "foo");
        }
        catch(final NoSuchMethodException ex)
        {
            // handle it however you want
            ex.printStackTrace();
        }
        catch(final IllegalAccessException ex)
        {
            // handle it however you want
            ex.printStackTrace();
        }
        catch(final InvocationTargetException ex)
        {
            // handle it however you want
            ex.printStackTrace();
        }
    }

    private void bar(final String msg)
    {
        System.out.println("hello from: " + msg);
    }
} 
```

# string - 你将如何实现你的字符串类型？

> ID：566422
> 
> 赞同：5
> 
> 时间：2009-02-19T17:53:08.040
> 
> 标签：string

假设您正在从头开始设计和实现一种新语言，尽管您可以自由地从现有语言/实现中借鉴想法。

问题：如果程序员声明了一个字符串变量（假设是强类型），你会选择如何将这个变量存储在内存中？

有很多用例，但是您是否有在某些领域表现出色的特定模型？你的字符串是可变的吗？它是可变的，但只有一定的长度，而不是记忆的尽头？我可以动态设置长度，还是只能在编译时完成？访问“第 n 个”元素是否容易？字符串是否需要连续的内存扇区？它可以分解成更小的字符串吗？

程序员可能喜欢对你的字符串做一些需要考虑的事情：计算长度。添加到字符串。提取部分字符串（子字符串）。应用正则表达式。转换为不同的值（数字、布尔值等）

编辑：澄清我的意思。

如果用户声明以下内容：

```
var Name : string 
```

作为语言设计者，您将如何选择如何将其存储在 RAM 中？你的方法有什么优缺点等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T18:04:57.040

如果我从头开始编写一种语言，我希望同时定义可变和不可变字符串类型。不变性使字符串处理操作更快，但也产生了严重的限制，特别是在连接等方面。

不可变字符串，我将存储为以空字符结尾的 unicode 值数组。可变字符串，我将存储为 unicode 字符的链接列表，以便于重新洗牌、切片等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T19:28:57.040

我会避免使用 C 字符串。计算长度是 O(n)。共享子字符串几乎是不可能的。连续的内存需求会导致碎片。终结器的任何问题都会导致错误和安全漏洞。如果将其存储为 UCS-4，则会为 ASCII 字符串浪费大量空间（并失去 C 兼容性，这是 C 字符串的一个好处）；如果将其存储为 UTF-8，则索引为 O(n)。只有当您在裸 PDP-11 上编写 ASCII 库时，PDP-11 的 ASCIZ 类型才真正有意义。

比 PDP-11 更年轻的语言通常使用不同的结构：

*   Pascal 使用长度字段而不是终止符——它们的 strlen() 是 O(1)。
*   Forth 使用 (address, length) 双精度 - 它们的 strlen() 是 O(1)，而且它们可以轻松共享子字符串。
*   许多现代“托管”语言（如 Java）也单独存储长度。
*   在其他语言（如 Common Lisp）中，字符串只是向量的子类型（其元素是字符）。
*   Excel 团队使用 C，但实现了他们自己的 Pascal 字符串以提高性能。

我会使用[绳索之](http://en.wikipedia.org/wiki/Rope_(computer_science))类的东西。连接是恒定时间的。它们不需要连续的内存。子串共享很容易。在多线程环境中，所有操作都可以在不锁定的情况下执行。也许允许 UCS-4 和 ASCII 节点在常见情况下使存储更紧凑，和/或让它在内部自动使用更简单的结构来存储非常短的字符串。

如果您的内存少、字符串短、7 位字符、受信任的输入，并且您的 CPU 非常慢以至于值得您的程序员花时间非常小心，那么 ASCIZ 非常棒。在 Unicode、多线程、高效 GC、快速 CPU 和大（可能不受信任）输入的现代世界中，它不再是一个很好的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T18:06:48.617

我假设您的意思是好像您在设计一种语言？然后我想我会使用 C 的模型并将其存储为一块连续的内存，以空值终止。这对我来说似乎是最合乎逻辑的方式。

优点：如果您对 null 进行折扣，则不会浪费内存。

缺点：必须通过方法等计算字符串长度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-19T18:23:12.617

我将首先要求附加到字符串的编码。如果未在源代码中指定，则字符串文字将具有与源文件本身相同的编码。

当然，我偏向于 UTF-8，并且可能会安排标准库以该机制运行

另外，我会考虑使用比字节数组更智能的结构表示，因为谁想要使用缓冲区！

SGI 的模板库带有一个“绳索”抽象类型，可以很好地做到这一点。迭代器（但不是迭代）很昂贵，但作为交换，插入、删除、追加、子范围和比较都非常便宜。

Lua 编程指南中还有另一个很好的实现，它实现了“河内之塔”优化，非常适合从前到后迭代地构建字符串，这在读取大文件时经常这样做。

TCL 通过其文本字段小部件间接地做到了这一点。它甚至使注释文本通常很有用。唯一的缺点是这种设计对于没有面向行的分布的序列效果不佳。

使用不可变字符串的主要原因是动态或解释语言本身使用字符串。实际上，它使用原子，原子是任意的，但需要与字符串相互转换。Lisp 使用与字符串分开的符号常量明确地做到这一点。我喜欢这个，尽管我并不喜欢 lisp。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-19T18:14:43.993

我相信您在问如何实现字符串对象。

出于性能原因，您可能希望为字符串中的字符分配的内存作为单个块。这将加快对所有元素执行的操作 - 大小写更改、复制、长度计算、索引等。它还将更容易实现在字符串的开头或结尾工作的操作 - 修剪、子字符串等。

在某些操作中，像链表这样的数据结构会更容易实现，比如插入或删除字符/子字符串。然而，考虑到维护这种数据结构的内存开销与平均字符串长度的比率，成本超过了任何潜在的收益。

字符串是否应该是不可变的取决于两个考虑因素：

*   您是直接访问内存存储还是所有操作都封装在一个类中？
*   您的内存分配是由运行时管理还是您必须自己管理？

传统的 C++ 方法是让使用字符串对象的代码直接访问底层内存。这很有意义，因为无论如何内存都是由客户端代码分配和管理的，因此直接访问它可以提供最佳性能。缺点是任何改变字符串长度的操作通常会导致重新分配内存。有一些智能字符串类可以使用自己的内存管理器来处理这个问题，比如 ATL 的 CString。

C# 方法是将底层内存封装在对象中，并使字符串不可变。这允许内存由 CLR 管理，并且对象由适用于任何其他对象的相同规则进行垃圾收集。因此，性能损失很小，但简化使用的好处和提供相当复杂操作的稳定实现的能力超过了性能的成本。另外，附带的 StringBuilder 类提供了直接访问内存的一些优点，方法是预先分配更大的缓冲区并改变其中的实例，直到最终确定为 String 实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T18:13:27.007

我会反汇编 .NET String 类并从中构建。

# windows - 学习编写 Windows 驱动程序

> ID：566426
> 
> 赞同：10
> 
> 时间：2009-02-19T17:53:45.903
> 
> 标签：windows, resources, kernel, driver

对于学习编程驱动程序的资源，您会推荐什么。我正在通过编程 Microsoft Windows 驱动程序模型，但我想知道是否有任何示例与 vista 兼容。此外，到目前为止，这本书更多地是内核函数的参考。它们是一种资源，可以帮助初学者制作更中间的 wdm 驱动程序吗？我已经完成了基本的“hello world”驱动程序。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-19T18:08:52.420

我强烈建议从[KMDF](http://www.microsoft.com/whdc/driver/wdf/KMDF.mspx)开始。它比 WDM 更容易学习，但仍然需要您学习 Windows 内核开发的基础知识。此外，在[OsrOnline](http://www.osronline.com/)四人组中闲逛也是一种很好的学习方式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T18:19:35.693

没有真正回答你的问题，但是当你学习编写驱动程序时，不要忘记定期查看[Doron Holan 的博客](http://blogs.msdn.com/doronh)。他的工作是改进驱动程序开发过程，他讨论了驱动程序编程的许多常见陷阱和微妙之处。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T18:28:48.917

我正在阅读“使用 Windows 驱动程序基础开发驱动程序”一书 - 这似乎为新开发人员以合乎逻辑的顺序呈现事物，同时深入研究现实世界的解决方案，并提供有关如何处理它们的提示。 [来自亚马逊](https://rads.stackoverflow.com/amzn/click/com/0735623740)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-19T18:01:31.533

我从 DDK 附带的帮助文件中学习，并且（重要的是）从 DDK 附带的示例驱动程序（源代码）中学习：寻找相同类型驱动程序的示例驱动程序（例如网络驱动程序、视频驱动程序等）作为你感兴趣的那种。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-15T07:43:23.037

实际上，我搜索了一段时间以查找 WDK 文档中提到的示例代码（但未在此处链接）。当我发现它时，它实际上成为了一个很大的帮助。它甚至没有被隐藏，它就在我误认为是 Windows DDK 的 src 的“src”目录下面。（以防万一其他人正在搜索这些示例。）

好吧，还有来自[rootkit.com](http://www.rootkit.com/)的示例。最了解这些事情的往往是鬼鬼祟祟的人。

更新：我发现本[教程](http://www.codeproject.com/KB/system/driverdev.aspx)在 stackoverflow 的某处被引用。这是一个不错的缓慢且写得很好的介绍。（显然我目前正在搜索和学习自己，每天的改进是有意的。）

[链接到我的一个问题](https://stackoverflow.com/questions/1137540/connecting-windows-driver-to-userland-service)可能很有用，其中讨论了“与您的司机沟通”的主题。

# c# - 类型未知时如何创建动态客户端代理连接？

> ID：566432
> 
> 赞同：1
> 
> 时间：2009-02-19T17:55:06.463
> 
> 标签：c#, .net, wcf

我知道我可以执行以下代码来在 WCF 中动态创建客户端端点连接：

```
BasicHttpBinding basic = 
    new BasicHttpBinding(BasicHttpSecurityMode.TransportCredentialOnly); 

basic.Security.Transport.ClientCredentialType = 
    HttpClientCredentialType.Ntlm; 

EndpointAddress serviceAddress = 
    new EndpointAddress("http://whatever/service.svc"); 

YourServiceClient m_client = new YourServiceClient(basic, serviceAddress); 
```

问题是，在这种情况下，我需要知道“YourServiceClient”是什么。我想要做的是从数据库中获取类型“YourServiceClient”，并将其存储为对象。有谁知道我会怎么做这样的事情？我从数据库中检索到的对象中的“YourServiceClient”值在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T18:14:11.937

Nicholas Allen 在他的博客中介绍了类似的内容（我认为），从[第 1 部分开始](http://blogs.msdn.com/drnick/archive/2009/01/05/forwarding-service-part-1.aspx)

此外，IIRC 还可以接收原始 XML 消息，然后您可以自己处理这些消息，而不是使用特定于类型的代理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T18:20:46.330

你将无法做到这一点。基本上，您要求在运行时获取未知数，但在编译时绑定到已知类型。如果您尝试访问的服务具有某种共享接口，则根本无法做到这一点。

如果它们确实具有相同的接口（意思是，相同的方法集等），那么您可以使用此处的示例在运行时创建自己的通道工厂，并获取实现服务接口的代理：

[http://msdn.microsoft.com/en-us/library/ms734681.aspx](http://msdn.microsoft.com/en-us/library/ms734681.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-23T02:00:48.230

如果有能够在这里使用泛型（如果没有，那么你可能不得不使用一些反射，如果没有）那么这就是你所追求的吗？

```
public TContract GetService<TContract>(EndpointAddress address){
    var channelFactory = new ChannelFactory<TContract>(new NetTcpBinding(),address);
    return channelFactory.CreateChannel();
} 
```

# c# - HTTP POST 返回错误：417“预期失败”。

> ID：566437
> 
> 赞同：217
> 
> 时间：2009-02-19T17:57:16.027
> 
> 标签：c#, .net, http, http-post, webclient

当我尝试 POST 到 URL 时，会导致以下异常：

> 远程服务器返回错误：(417) 预期失败。

这是一个示例代码：

```
var client = new WebClient();

var postData = new NameValueCollection();
postData.Add("postParamName", "postParamValue");

byte[] responseBytes = client.UploadValues("http://...", postData);
string response = Encoding.UTF8.GetString(responseBytes); // (417) Expectation Failed. 
```

使用一`HttpWebRequest/HttpWebResponse`对或一个`HttpClient`并没有什么不同。

是什么导致了这个异常？

* * *

## 回答 #1

> 赞同：481
> 
> 时间：2009-02-19T19:45:45.263

System.Net.HttpWebRequest 向每个请求添加标头“HTTP 标头“期望：100-继续”，除非您通过[将此静态属性](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.expect100continue(VS.80).aspx)设置为 false 明确要求不要这样做：

```
System.Net.ServicePointManager.Expect100Continue = false; 
```

一些服务器在该标头上阻塞并发送回您看到的 417 错误。

试一试。

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2011-09-09T07:34:17.663

其他方式 -

将这些行添加到您的应用程序配置文件配置部分：

```
<system.net>
    <settings>
        <servicePointManager expect100Continue="false" />
    </settings>
</system.net> 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-06-06T14:14:36.543

`System.ServiceModel`在运行时，默认向导生成的 SOAP Web 服务代理（如果 WCF 堆栈也是这种情况，则不是 100%）也可能出现同样的情况和错误：

*   最终用户机器被配置（在 Internet 设置中）使用不理解 HTTP 1.1 的代理
*   客户端最终发送了 HTTP 1.0 代理不理解的内容（通常是`Expect`作为 HTTP`POST`或`PUT`请求的一部分的标头，因为标准协议约定分两部分发送请求，[如此处的备注中所述](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.expect100continue%28v=vs.110%29.aspx)）

... 产生 417。

如其他答案所述，如果您遇到的特定问题是`Expect`标头导致问题，则可以通过相对全局关闭两部分 PUT/POST 传输来解决该特定问题[`System.Net.ServicePointManager.Expect100Continue`](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.expect100continue%28v=vs.80%29.aspx)。

**然而，这并不能解决完整的潜在问题——堆栈可能仍在使用 HTTP 1.1 特定的东西，例如 KeepAlives 等（尽管在许多情况下，其他答案确实涵盖了主要情况。）**

然而，实际问题是自动生成的代码假定可以盲目地使用 HTTP 1.1 设施，因为每个人都理解这一点。要停止对特定 Web 服务代理的这种假设，可以通过创建一个派生的 Proxy 类来更改默认底层[`HttpWebRequest.ProtocolVersion`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.protocolversion.aspx)的默认值[1.1](http://msdn.microsoft.com/en-us/library/system.net.httpversion.version11.aspx)，该派生类将覆盖[，如本文所示](http://dotnetbyexample.blogspot.ie/2008/02/forcing-web-service-proxy-to-use.html)：-[`protected override WebRequest GetWebRequest(Uri uri)`](http://msdn.microsoft.com/en-us/library/s0yxc637.aspx)

```
public class MyNotAssumingHttp11ProxiesAndServersProxy : MyWS
{
    protected override WebRequest GetWebRequest(Uri uri)
    {
      HttpWebRequest request = (HttpWebRequest)base.GetWebRequest(uri);
      request.ProtocolVersion = HttpVersion.Version10;
      return request;
    }
} 
```

（`MyWS`添加 Web 引用向导向您吐出的代理在哪里。）

* * *

更新：这是我在生产中使用的一个 impl：

```
class ProxyFriendlyXXXWs : BasicHttpBinding_IXXX
{
    public ProxyFriendlyXXXWs( Uri destination )
    {
        Url = destination.ToString();
        this.IfProxiedUrlAddProxyOverriddenWithDefaultCredentials();
    }

    // Make it squirm through proxies that don't understand (or are misconfigured) to only understand HTTP 1.0 without yielding HTTP 417s
    protected override WebRequest GetWebRequest( Uri uri )
    {
        var request = (HttpWebRequest)base.GetWebRequest( uri );
        request.ProtocolVersion = HttpVersion.Version10;
        return request;
    }
}

static class SoapHttpClientProtocolRealWorldProxyTraversalExtensions
{
    // OOTB, .NET 1-4 do not submit credentials to proxies.
    // This avoids having to document how to 'just override a setting on your default proxy in your app.config' (or machine.config!)
    public static void IfProxiedUrlAddProxyOverriddenWithDefaultCredentials( this SoapHttpClientProtocol that )
    {
        Uri destination = new Uri( that.Url );
        Uri proxiedAddress = WebRequest.DefaultWebProxy.GetProxy( destination );
        if ( !destination.Equals( proxiedAddress ) )
            that.Proxy = new WebProxy( proxiedAddress ) { UseDefaultCredentials = true };
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-19T18:01:21.597

您尝试模拟的表单是否有两个字段，用户名和密码？

如果是这样，这一行：

```
 postData.Add("username", "password"); 
```

是不正确的。

你需要两行，比如：

```
 postData.Add("username", "Moose");
postData.Add("password", "NotMoosespasswordreally"); 
```

编辑：

好的，既然这不是问题，解决这个问题的一种方法是使用 Fiddler 或 Wireshark 之类的东西来观察从浏览器成功发送到 Web 服务器的内容，然后将其与从您的代码发送的内容进行比较。如果您要从 .Net 访问普通端口 80，Fiddler 仍将捕获此流量。

表单上可能还有一些其他隐藏字段，Web 服务器希望您不会发送。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-05-28T06:19:22.790

代理方面的解决方案，我在 SSL 握手过程中遇到了一些问题，我不得不强制我的代理服务器使用 HTTP/1.0 发送请求，通过在 httpd.conf 中设置这个参数来解决问题，`SetEnv force-proxy-request-1.0 1` `SetEnv proxy-nokeepalive 1`之后我遇到了 417 错误我的客户端应用程序使用 HTTP/1.1 并且代理被迫使用 HTTP/1.0，通过在代理端的 httpd.conf 中设置此参数解决了问题，`RequestHeader unset Expect early`无需在客户端更改任何内容，希望这会有所帮助.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-03-01T18:03:50.253

对于 Powershell 它是

```
[System.Net.ServicePointManager]::Expect100Continue = $false 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-07-11T12:45:17.120

如果您正在使用“ **HttpClient** ”，并且您不想使用全局配置来影响您可以使用的所有程序：

```
 HttpClientHandler httpClientHandler = new HttpClientHandler();
 httpClient.DefaultRequestHeaders.ExpectContinue = false; 
```

如果您使用的是“ **WebClient** ”，我认为您可以尝试通过调用以下方法来删除此标头：

```
 var client = new WebClient();
 client.Headers.Remove(HttpRequestHeader.Expect); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-21T07:51:39.567

在我的情况下，似乎只有当我的客户端计算机具有严格的防火墙策略时才会发生此错误，这会阻止我的程序与 Web 服务通信。

所以我能找到的唯一解决方案是捕捉错误并通知用户手动更改防火墙设置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-06T01:04:16.050

检查您的网络连接是否未重定向。

当我使用错误的 wifi 并且任何网络请求都重定向到公司登录页面时，我遇到了这个问题。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-03-24T22:58:47.833

web.config 方法适用于对 IntApp Web 服务启用规则的 InfoPath 表单服务调用。

```
 <system.net>
    <defaultProxy />
    <settings> <!-- 20130323 bchauvin -->
        <servicePointManager expect100Continue="false" />
    </settings>
  </system.net> 
```

# wordpress - Wordpress MU 主题和插件

> ID：566447
> 
> 赞同：2
> 
> 时间：2009-02-19T18:00:38.287
> 
> 标签：wordpress, plugins, themes, blogs

我在[Wordpress MU](http://codex.wordpress.org/WordPressMU)中设置了一些 X 数量的博客。我需要为每个博客安装主题。

如何为他们安装主题？如果我安装在主目录中，它将适用于所有博客，或者我需要像在传统 Wordpress 中那样分别为每个博客安装。

请让我知道插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T22:34:11.853

将它们放在`wp-content/themes`目录中。然后，您需要通过站点管理 > 主题在管理控制面板中启用它们。这允许系统中的任何博客使用它们。

`wp-content/mu-plugins`系统中的所有博客都会自动启用插件。用户无法关闭它们。

**如果**您允许用户在站点管理 > 选项 > 菜单中启用插件，`wp-content/plugins`则可以基于每个博客启用插件。

 **# firefox - 如何通过 XPI for FireFox 3 分发 XPCOM 组件？

> ID：566454
> 
> 赞同：0
> 
> 时间：2009-02-19T18:01:29.583
> 
> 标签：firefox, xpcom, xpi

我写了一个 XPCOM 组件和一个使用它的扩展。XPCOM 为其目的加载任意 DLL。

如何将 XPCOM 和 DLL 包含到 XPI 包中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T11:45:21.573

我能够通过 IExtensionManager 和 IInstallLocation 找到我的 DLL 的绝对路径，然后通过 LoadLibrary() 加载它。

1.  在 my.xpi/components/ 中将 DLL 放在 XPCOM 附近
2.  通过 IExtensionManager 和 IInstallLocation 找出扩展的路径
3.  加载库（）
4.  利润

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T10:38:18.977

XPI 基本上是一个 zip 文件，其中包括 DLL 等，请参阅 [https://developer.mozilla.org/En/Creating_XPI_Installer_Modules](https://developer.mozilla.org/En/Creating_XPI_Installer_Modules)

# compact-framework - 在 CF 2.0 上创建 cab 文件

> ID：566459
> 
> 赞同：0
> 
> 时间：2009-02-19T18:02:13.920
> 
> 标签：compact-framework, cab

如何？我需要哪些组件（平台构建器？）？

请尽可能清楚 - 我发现这个主题非常模糊，大多数人只是给你一个非常模糊的答案。

我正在使用 CF .net 2.0 运行 WInCE 5.0

最终我需要创建一个自我更新的应用程序，但我将从创建一个 cab 安装程序包开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:09:36.430

您可以在 Visual Studio 中使用适当的项目类型创建 cab 文件。在 Visual Studio 2005 中选择“其他项目类型”、“设置和部署”、“智能设备 CAB 项目”。

在 CAB 文件中，您可以包含可执行文件和资源文件。您可以指示应将这些文件复制到何处。您还可以添加注册表项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T18:59:38.220

这个链接实际上也帮助了我 [http://www.mobilepractices.com/2008/02/how-to-create-windows-mobile-smart.html](http://www.mobilepractices.com/2008/02/how-to-create-windows-mobile-smart.html)

关于如何在 Visual Studio 2008 中创建 cab 文件的精彩演练

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T01:06:19.650

您还可以查看 Mobile Packager [http://www.mobilepackager.com等商业软件](http://www.mobilepackager.com)

# iphone - 如何计算两个向量的平均方向

> ID：566460
> 
> 赞同：19
> 
> 时间：2009-02-19T18:02:19.503
> 
> 标签：iphone, math, vector

我正在编写一个基于 opengl 的 iphone 应用程序，并希望允许用户根据他们在屏幕上移动两根手指的方向来围绕视图进行翻译。对于一根手指，我知道我可以只计算从用户手指的起始位置到当前位置的向量，然后找到它的单位向量以获得方向，但我不知道如何为两个手指做到这一点手指，我不认为添加向量的分量并计算平均值会起作用，所以我几乎被卡住了。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-19T18:06:52.920

向量数学就像你想象的那样工作：

```
v3 = (v1 + v2)/2

// so:
v3.x = (v1.x + v2.x) / 2;
// same for Y and Z 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-20T20:44:53.573

通常，在进行图形编程时，出于速度原因，乘法比除法更好，所以我建议这样做：

v3 = (v1 + v2) * 0.5f；

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-19T18:14:33.557

如果您只对方向感兴趣，您应该添加它们并对结果向量进行归一化，

```
(v1 + v2)/abs(v1 + v2) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-19T18:12:24.307

简单的思想实验：对 x 和 y 方向的单位向量执行此操作。直观地，您可以想象“平均值”将是一个向上和向右 45 度角的单位向量。这正是发生的事情。思想实验表明，您需要按其大小对平均值进行归一化以获得单位向量。我建议你这样做。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-09-03T14:32:21.367

对不起，但这是错误的。在矢量世界中，平均分量意义上的“平均值”没有任何意义。想象一下 (-1 0) 和 (1 0) -> 平均值 = 0 0 ;-)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-19T18:07:06.040

将它们相加并除以二确实有效

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-03T15:08:52.983

它并不像看起来那么容易：您必须使用 slerp-interpolation 来找到单位球体上的半弧： [http](http://en.wikipedia.org/wiki/Slerp) ://en.wikipedia.org/wiki/Slerp 在此处深入：[http://www.essentialmath .com/index.htm](http://www.essentialmath.com/index.htm)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-09T19:13:51.847

为了直观地理解它，您可以将两个向量画下来。然后在两者的端点之间画一条线段。该段的中点是平均向量。这适用于任意数量的维度。

# .net - 使用 HTTPWebrequest (multipart/form-data) 上传文件

> ID：566462
> 
> 赞同：314
> 
> 时间：2009-02-19T18:03:01.440
> 
> 标签：.net, upload, httpwebrequest

是否有任何类、库或一些代码可以帮助我使用**HTTPWebrequest**上传文件？

**编辑2：**

我不想上传到 WebDAV 文件夹或类似的东西。我想模拟一个浏览器，就像您将您的头像上传到论坛或通过 Web 应用程序中的表单上传文件一样。上传到使用 multipart/form-data 的表单。

**编辑：**

WebClient 不能满足我的要求，所以我正在寻找**HTTPWebrequest**的解决方案。

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2010-06-08T11:39:08.080

采用上面的代码并进行修复，因为它会引发内部服务器错误 500。\r\n 定位错误和空格等存在一些问题。使用内存流应用重构，直接写入请求流。结果如下：

```
 public static void HttpUploadFile(string url, string file, string paramName, string contentType, NameValueCollection nvc) {
        log.Debug(string.Format("Uploading {0} to {1}", file, url));
        string boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x");
        byte[] boundarybytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "\r\n");

        HttpWebRequest wr = (HttpWebRequest)WebRequest.Create(url);
        wr.ContentType = "multipart/form-data; boundary=" + boundary;
        wr.Method = "POST";
        wr.KeepAlive = true;
        wr.Credentials = System.Net.CredentialCache.DefaultCredentials;

        Stream rs = wr.GetRequestStream();

        string formdataTemplate = "Content-Disposition: form-data; name=\"{0}\"\r\n\r\n{1}";
        foreach (string key in nvc.Keys)
        {
            rs.Write(boundarybytes, 0, boundarybytes.Length);
            string formitem = string.Format(formdataTemplate, key, nvc[key]);
            byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);
            rs.Write(formitembytes, 0, formitembytes.Length);
        }
        rs.Write(boundarybytes, 0, boundarybytes.Length);

        string headerTemplate = "Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\nContent-Type: {2}\r\n\r\n";
        string header = string.Format(headerTemplate, paramName, file, contentType);
        byte[] headerbytes = System.Text.Encoding.UTF8.GetBytes(header);
        rs.Write(headerbytes, 0, headerbytes.Length);

        FileStream fileStream = new FileStream(file, FileMode.Open, FileAccess.Read);
        byte[] buffer = new byte[4096];
        int bytesRead = 0;
        while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0) {
            rs.Write(buffer, 0, bytesRead);
        }
        fileStream.Close();

        byte[] trailer = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "--\r\n");
        rs.Write(trailer, 0, trailer.Length);
        rs.Close();

        WebResponse wresp = null;
        try {
            wresp = wr.GetResponse();
            Stream stream2 = wresp.GetResponseStream();
            StreamReader reader2 = new StreamReader(stream2);
            log.Debug(string.Format("File uploaded, server response is: {0}", reader2.ReadToEnd()));
        } catch(Exception ex) {
            log.Error("Error uploading file", ex);
            if(wresp != null) {
                wresp.Close();
                wresp = null;
            }
        } finally {
            wr = null;
        }
    } 
```

和示例用法：

```
 NameValueCollection nvc = new NameValueCollection();
    nvc.Add("id", "TTR");
    nvc.Add("btn-submit-photo", "Upload");
    HttpUploadFile("http://your.server.com/upload", 
         @"C:\test\test.jpg", "file", "image/jpeg", nvc); 
```

它可以扩展为处理多个文件，或者为每个文件多次调用它。但是，它适合您的需求。

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2009-02-19T22:11:13.060

我正在寻找这样的东西，发现于： [http](http://bytes.com/groups/net-c/268661-how-upload-file-via-c-code) ://bytes.com/groups/net-c/268661-how-upload-file-via-c-code （为了正确性而修改）：

```
public static string UploadFilesToRemoteUrl(string url, string[] files, NameValueCollection formFields = null)
{
    string boundary = "----------------------------" + DateTime.Now.Ticks.ToString("x");

    HttpWebRequest request = (HttpWebRequest) WebRequest.Create(url);
    request.ContentType = "multipart/form-data; boundary=" +
                            boundary;
    request.Method = "POST";
    request.KeepAlive = true;

    Stream memStream = new System.IO.MemoryStream();

    var boundarybytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" +
                                                            boundary + "\r\n");
    var endBoundaryBytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" +
                                                                boundary + "--");

    string formdataTemplate = "\r\n--" + boundary +
                                "\r\nContent-Disposition: form-data; name=\"{0}\";\r\n\r\n{1}";

    if (formFields != null)
    {
        foreach (string key in formFields.Keys)
        {
            string formitem = string.Format(formdataTemplate, key, formFields[key]);
            byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);
            memStream.Write(formitembytes, 0, formitembytes.Length);
        }
    }

    string headerTemplate =
        "Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\n" +
        "Content-Type: application/octet-stream\r\n\r\n";

    for (int i = 0; i < files.Length; i++)
    {
        memStream.Write(boundarybytes, 0, boundarybytes.Length);
        var header = string.Format(headerTemplate, "uplTheFile", files[i]);
        var headerbytes = System.Text.Encoding.UTF8.GetBytes(header);

        memStream.Write(headerbytes, 0, headerbytes.Length);

        using (var fileStream = new FileStream(files[i], FileMode.Open, FileAccess.Read))
        {
            var buffer = new byte[1024];
            var bytesRead = 0;
            while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
            {
                memStream.Write(buffer, 0, bytesRead);
            }
        }
    }

    memStream.Write(endBoundaryBytes, 0, endBoundaryBytes.Length);
    request.ContentLength = memStream.Length;

    using (Stream requestStream = request.GetRequestStream())
    {
        memStream.Position = 0;
        byte[] tempBuffer = new byte[memStream.Length];
        memStream.Read(tempBuffer, 0, tempBuffer.Length);
        memStream.Close();
        requestStream.Write(tempBuffer, 0, tempBuffer.Length);
    }

    using (var response = request.GetResponse())
    {
        Stream stream2 = response.GetResponseStream();
        StreamReader reader2 = new StreamReader(stream2);
        return reader2.ReadToEnd();
    }
} 
```

* * *

## 回答 #3

> 赞同：112
> 
> 时间：2013-06-04T18:40:38.840

更新：使用 .NET 4.5（或通过添加来自 NuGet 的[Microsoft.Net.Http](http://nuget.org/Packages/Microsoft.Net.Http "Microsoft.Net.Http")包的 .NET 4.0），无需外部代码、扩展和“低级”HTTP 操作即可实现。这是一个例子：

```
// Perform the equivalent of posting a form with a filename and two files, in HTML:
// <form action="{url}" method="post" enctype="multipart/form-data">
//     <input type="text" name="filename" />
//     <input type="file" name="file1" />
//     <input type="file" name="file2" />
// </form>
private async Task<System.IO.Stream> UploadAsync(string url, string filename, Stream fileStream, byte [] fileBytes)
{
    // Convert each of the three inputs into HttpContent objects

    HttpContent stringContent = new StringContent(filename);
    // examples of converting both Stream and byte [] to HttpContent objects
    // representing input type file
    HttpContent fileStreamContent = new StreamContent(fileStream);
    HttpContent bytesContent = new ByteArrayContent(fileBytes);

    // Submit the form using HttpClient and 
    // create form data as Multipart (enctype="multipart/form-data")

    using (var client = new HttpClient())
    using (var formData = new MultipartFormDataContent()) 
    {
        // Add the HttpContent objects to the form data

        // <input type="text" name="filename" />
        formData.Add(stringContent, "filename", "filename");
        // <input type="file" name="file1" />
        formData.Add(fileStreamContent, "file1", "file1");
        // <input type="file" name="file2" />
        formData.Add(bytesContent, "file2", "file2");

        // Invoke the request to the server

        // equivalent to pressing the submit button on
        // a form with attributes (action="{url}" method="post")
        var response = await client.PostAsync(url, formData);

        // ensure the request was a success
        if (!response.IsSuccessStatusCode)
        {
            return null;
        }
        return await response.Content.ReadAsStreamAsync();
    }
} 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-04-20T18:39:59.007

基于上面提供的代码，我添加了对多个文件的支持，并且还直接上传流而不需要本地文件。

要将文件上传到包含一些帖子参数的特定 url，请执行以下操作：

```
RequestHelper.PostMultipart(
    "http://www.myserver.com/upload.php", 
    new Dictionary<string, object>() {
        { "testparam", "my value" },
        { "file", new FormFile() { Name = "image.jpg", ContentType = "image/jpeg", FilePath = "c:\\temp\\myniceimage.jpg" } },
        { "other_file", new FormFile() { Name = "image2.jpg", ContentType = "image/jpeg", Stream = imageDataStream } },
    }); 
```

为了进一步增强这一点，可以从给定文件本身确定名称和 mime 类型。

```
public class FormFile 
{
    public string Name { get; set; }

    public string ContentType { get; set; }

    public string FilePath { get; set; }

    public Stream Stream { get; set; }
}

public class RequestHelper
{

    public static string PostMultipart(string url, Dictionary<string, object> parameters) {

        string boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x");
        byte[] boundaryBytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "\r\n");

        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
        request.ContentType = "multipart/form-data; boundary=" + boundary;
        request.Method = "POST";
        request.KeepAlive = true;
        request.Credentials = System.Net.CredentialCache.DefaultCredentials;

        if(parameters != null && parameters.Count > 0) {

            using(Stream requestStream = request.GetRequestStream()) {

                foreach(KeyValuePair<string, object> pair in parameters) {

                    requestStream.Write(boundaryBytes, 0, boundaryBytes.Length);
                    if(pair.Value is FormFile) {
                        FormFile file = pair.Value as FormFile;
                        string header = "Content-Disposition: form-data; name=\"" + pair.Key + "\"; filename=\"" + file.Name + "\"\r\nContent-Type: " + file.ContentType + "\r\n\r\n";
                        byte[] bytes = System.Text.Encoding.UTF8.GetBytes(header);
                        requestStream.Write(bytes, 0, bytes.Length);
                        byte[] buffer = new byte[32768];
                        int bytesRead;
                        if(file.Stream == null) {
                            // upload from file
                            using(FileStream fileStream = File.OpenRead(file.FilePath)) {
                                while((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
                                    requestStream.Write(buffer, 0, bytesRead);
                                fileStream.Close();
                            }
                        }
                        else {
                            // upload from given stream
                            while((bytesRead = file.Stream.Read(buffer, 0, buffer.Length)) != 0)
                                requestStream.Write(buffer, 0, bytesRead);
                        }
                    }
                    else {
                        string data = "Content-Disposition: form-data; name=\"" + pair.Key + "\"\r\n\r\n" + pair.Value;
                        byte[] bytes = System.Text.Encoding.UTF8.GetBytes(data);
                        requestStream.Write(bytes, 0, bytes.Length);
                    }
                }

                byte[] trailer = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "--\r\n");
                requestStream.Write(trailer, 0, trailer.Length);
                requestStream.Close();
            }
        }

        using(WebResponse response = request.GetResponse()) {
            using(Stream responseStream = response.GetResponseStream())
            using(StreamReader reader = new StreamReader(responseStream))
                return reader.ReadToEnd();
        }

    }
} 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-04-23T17:34:46.290

我的 ASP.NET 上传常见问题解答有一篇关于此的文章，带有示例代码：[使用 RFC 1867 POST 请求和 HttpWebRequest/WebClient 上传文件](https://web.archive.org/web/20151128202604/http://aspnetupload.com/Upload-File-POST-HttpWebRequest-WebClient-RFC-1867.aspx)。此代码不会将文件加载到内存中（与上面的代码相反），支持多个文件，并支持表单值、设置凭据和 cookie 等。

编辑：看起来 Axosoft 删除了该页面。多谢你们。

它仍然可以通过archive.org 访问。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-02-19T18:06:55.697

像这样的东西很接近：（未经测试的代码）

```
byte[] data; // data goes here.

HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
request.Credentials = userNetworkCredentials;
request.Method = "PUT";
request.ContentType = "application/octet-stream";
request.ContentLength = data.Length;
Stream stream = request.GetRequestStream();
stream.Write(data,0,data.Length);
stream.Close();
response = (HttpWebResponse)request.GetResponse();
StreamReader reader = new StreamReader(response.GetResponseStream());
temp = reader.ReadToEnd();
reader.Close(); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-19T18:05:40.330

我认为您正在寻找更像[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)的东西。

具体来说，[UploadFile()](http://msdn.microsoft.com/en-us/library/system.net.webclient.uploadfile(VS.80).aspx)。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-11-22T23:36:47.357

VB 示例（从另一篇文章中的 C# 示例转换而来）：

```
Private Sub HttpUploadFile( _
    ByVal uri As String, _
    ByVal filePath As String, _
    ByVal fileParameterName As String, _
    ByVal contentType As String, _
    ByVal otherParameters As Specialized.NameValueCollection)

    Dim boundary As String = "---------------------------" & DateTime.Now.Ticks.ToString("x")
    Dim newLine As String = System.Environment.NewLine
    Dim boundaryBytes As Byte() = Text.Encoding.ASCII.GetBytes(newLine & "--" & boundary & newLine)
    Dim request As Net.HttpWebRequest = Net.WebRequest.Create(uri)

    request.ContentType = "multipart/form-data; boundary=" & boundary
    request.Method = "POST"
    request.KeepAlive = True
    request.Credentials = Net.CredentialCache.DefaultCredentials

    Using requestStream As IO.Stream = request.GetRequestStream()

        Dim formDataTemplate As String = "Content-Disposition: form-data; name=""{0}""{1}{1}{2}"

        For Each key As String In otherParameters.Keys

            requestStream.Write(boundaryBytes, 0, boundaryBytes.Length)
            Dim formItem As String = String.Format(formDataTemplate, key, newLine, otherParameters(key))
            Dim formItemBytes As Byte() = Text.Encoding.UTF8.GetBytes(formItem)
            requestStream.Write(formItemBytes, 0, formItemBytes.Length)

        Next key

        requestStream.Write(boundaryBytes, 0, boundaryBytes.Length)

        Dim headerTemplate As String = "Content-Disposition: form-data; name=""{0}""; filename=""{1}""{2}Content-Type: {3}{2}{2}"
        Dim header As String = String.Format(headerTemplate, fileParameterName, filePath, newLine, contentType)
        Dim headerBytes As Byte() = Text.Encoding.UTF8.GetBytes(header)
        requestStream.Write(headerBytes, 0, headerBytes.Length)

        Using fileStream As New IO.FileStream(filePath, IO.FileMode.Open, IO.FileAccess.Read)

            Dim buffer(4096) As Byte
            Dim bytesRead As Int32 = fileStream.Read(buffer, 0, buffer.Length)

            Do While (bytesRead > 0)

                requestStream.Write(buffer, 0, bytesRead)
                bytesRead = fileStream.Read(buffer, 0, buffer.Length)

            Loop

        End Using

        Dim trailer As Byte() = Text.Encoding.ASCII.GetBytes(newLine & "--" + boundary + "--" & newLine)
        requestStream.Write(trailer, 0, trailer.Length)

    End Using

    Dim response As Net.WebResponse = Nothing

    Try

        response = request.GetResponse()

        Using responseStream As IO.Stream = response.GetResponseStream()

            Using responseReader As New IO.StreamReader(responseStream)

                Dim responseText = responseReader.ReadToEnd()
                Diagnostics.Debug.Write(responseText)

            End Using

        End Using

    Catch exception As Net.WebException

        response = exception.Response

        If (response IsNot Nothing) Then

            Using reader As New IO.StreamReader(response.GetResponseStream())

                Dim responseText = reader.ReadToEnd()
                Diagnostics.Debug.Write(responseText)

            End Using

            response.Close()

        End If

    Finally

        request = Nothing

    End Try

End Sub 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-01-10T04:05:09.943

接受上述内容并对其进行修改，以接受一些标头值和多个文件

```
 NameValueCollection headers = new NameValueCollection();
        headers.Add("Cookie", "name=value;");
        headers.Add("Referer", "http://google.com");
    NameValueCollection nvc = new NameValueCollection();
        nvc.Add("name", "value");

    HttpUploadFile(url, new string[] { "c:\\file1.txt", "c:\\file2.jpg" }, new string[] { "file", "image" }, new string[] { "application/octet-stream", "image/jpeg" }, nvc, headers); 
```

* * *

```
public static void HttpUploadFile(string url, string[] file, string[] paramName, string[] contentType, NameValueCollection nvc, NameValueCollection headerItems)
{
    //log.Debug(string.Format("Uploading {0} to {1}", file, url));
    string boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x");
    byte[] boundarybytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "\r\n");

    HttpWebRequest wr = (HttpWebRequest)WebRequest.Create(url);

    foreach (string key in headerItems.Keys)
    {
        if (key == "Referer")
        {
            wr.Referer = headerItems[key];
        }
        else
        {
            wr.Headers.Add(key, headerItems[key]);
        }
    }

    wr.ContentType = "multipart/form-data; boundary=" + boundary;
    wr.Method = "POST";
    wr.KeepAlive = true;
    wr.Credentials = System.Net.CredentialCache.DefaultCredentials;

    Stream rs = wr.GetRequestStream();

    string formdataTemplate = "Content-Disposition: form-data; name=\"{0}\"\r\n\r\n{1}";
    foreach (string key in nvc.Keys)
    {
        rs.Write(boundarybytes, 0, boundarybytes.Length);
        string formitem = string.Format(formdataTemplate, key, nvc[key]);
        byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);
        rs.Write(formitembytes, 0, formitembytes.Length);
    }
    rs.Write(boundarybytes, 0, boundarybytes.Length);

    string headerTemplate = "Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\nContent-Type: {2}\r\n\r\n";
    string header = "";

    for(int i =0; i<file.Count();i++)
    {
        header = string.Format(headerTemplate, paramName[i], System.IO.Path.GetFileName(file[i]), contentType[i]);
        byte[] headerbytes = System.Text.Encoding.UTF8.GetBytes(header);
        rs.Write(headerbytes, 0, headerbytes.Length);

        FileStream fileStream = new FileStream(file[i], FileMode.Open, FileAccess.Read);
        byte[] buffer = new byte[4096];
        int bytesRead = 0;
        while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
        {
            rs.Write(buffer, 0, bytesRead);
        }
        fileStream.Close();
        rs.Write(boundarybytes, 0, boundarybytes.Length);
    }
    rs.Close();

    WebResponse wresp = null;
    try
    {
        wresp = wr.GetResponse();
        Stream stream2 = wresp.GetResponseStream();
        StreamReader reader2 = new StreamReader(stream2);
        //log.Debug(string.Format("File uploaded, server response is: {0}", reader2.ReadToEnd()));
    }
    catch (Exception ex)
    {
        //log.Error("Error uploading file", ex);
            wresp.Close();
            wresp = null;
    }
    finally
    {
        wr = null;
    }
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-04-24T18:58:14.430

我最近不得不处理这个问题 - 另一种方法是使用 WebClient 是可继承的事实，并从那里更改底层 WebRequest：

[http://msdn.microsoft.com/en-us/library/system.net.webclient.getwebrequest(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient.getwebrequest(VS.80).aspx)

我更喜欢 C#，但如果你坚持使用 VB，结果将如下所示：

```
Public Class BigWebClient
    Inherits WebClient
    Protected Overrides Function GetWebRequest(ByVal address As System.Uri) As System.Net.WebRequest
        Dim x As WebRequest = MyBase.GetWebRequest(address)
        x.Timeout = 60 * 60 * 1000
        Return x
    End Function
End Class

'Use BigWebClient here instead of WebClient 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-01-16T11:31:39.857

我的一些评论还有另一个工作示例：

```
 List<MimePart> mimeParts = new List<MimePart>();

        try
        {
            foreach (string key in form.AllKeys)
            {
                StringMimePart part = new StringMimePart();

                part.Headers["Content-Disposition"] = "form-data; name=\"" + key + "\"";
                part.StringData = form[key];

                mimeParts.Add(part);
            }

            int nameIndex = 0;

            foreach (UploadFile file in files)
            {
                StreamMimePart part = new StreamMimePart();

                if (string.IsNullOrEmpty(file.FieldName))
                    file.FieldName = "file" + nameIndex++;

                part.Headers["Content-Disposition"] = "form-data; name=\"" + file.FieldName + "\"; filename=\"" + file.FileName + "\"";
                part.Headers["Content-Type"] = file.ContentType;

                part.SetStream(file.Data);

                mimeParts.Add(part);
            }

            string boundary = "----------" + DateTime.Now.Ticks.ToString("x");

            req.ContentType = "multipart/form-data; boundary=" + boundary;
            req.Method = "POST";

            long contentLength = 0;

            byte[] _footer = Encoding.UTF8.GetBytes("--" + boundary + "--\r\n");

            foreach (MimePart part in mimeParts)
            {
                contentLength += part.GenerateHeaderFooterData(boundary);
            }

            req.ContentLength = contentLength + _footer.Length;

            byte[] buffer = new byte[8192];
            byte[] afterFile = Encoding.UTF8.GetBytes("\r\n");
            int read;

            using (Stream s = req.GetRequestStream())
            {
                foreach (MimePart part in mimeParts)
                {
                    s.Write(part.Header, 0, part.Header.Length);

                    while ((read = part.Data.Read(buffer, 0, buffer.Length)) > 0)
                        s.Write(buffer, 0, read);

                    part.Data.Dispose();

                    s.Write(afterFile, 0, afterFile.Length);
                }

                s.Write(_footer, 0, _footer.Length);
            }

            return (HttpWebResponse)req.GetResponse();
        }
        catch
        {
            foreach (MimePart part in mimeParts)
                if (part.Data != null)
                    part.Data.Dispose();

            throw;
        } 
```

还有使用的例子：

```
 UploadFile[] files = new UploadFile[] 
            { 
                new UploadFile(@"C:\2.jpg","new_file","image/jpeg") //new_file is id of upload field
            };

            NameValueCollection form = new NameValueCollection();

            form["id_hidden_input"] = "value_hidden_inpu"; //there is additional param (hidden fields on page)

            HttpWebRequest req = (HttpWebRequest)WebRequest.Create(full URL of action);

            // set credentials/cookies etc. 
            req.CookieContainer = hrm.CookieContainer; //hrm is my class. i copied all cookies from last request to current (for auth)
            HttpWebResponse resp = HttpUploadHelper.Upload(req, files, form);

            using (Stream s = resp.GetResponseStream())
            using (StreamReader sr = new StreamReader(s))
            {
                string response = sr.ReadToEnd();
            }
             //profit! 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-03-27T12:19:08.137

我正在寻找文件上传并将一些参数添加到 VB.NET 中的 multipart/form-data 请求，而不是通过常规表单发布。感谢@JoshCodes 的回答，我得到了我正在寻找的方向。我正在发布我的解决方案，以帮助其他人找到一种方法来使用文件和参数执行帖子，与我尝试实现的 html 等效的是：html

```
<form action="your-api-endpoint" enctype="multipart/form-data" method="post"> 
<input type="hidden" name="action" value="api-method-name"/> 
<input type="hidden" name="apiKey" value="gs1xxxxxxxxxxxxxex"/> 
<input type="hidden" name="access" value="protected"/> 
<input type="hidden" name="name" value="test"/> 
<input type="hidden" name="title" value="test"/> 
<input type="hidden" name="signature" value="cf1d4xxxxxxxxcd5"/> 
<input type="file" name="file"/> 
<input type="submit" name="_upload" value="Upload"/> 
</form> 
```

由于我必须提供 apiKey 和签名（这是请求参数和 api 密钥连接字符串的计算校验和），我需要在服务器端进行。我需要在服务器端执行此操作的另一个原因是，可以通过指向服务器上已经存在的文件（提供路径）随时执行文件的发布，因此在表单期间不会手动选择文件post 因此表单数据文件将不包含文件流。否则我可以通过 ajax 回调计算校验和并使用 JQuery 通过 html post 提交文件。我使用的是 .net 4.0 版，在实际解决方案中无法升级到 4.5。所以我不得不使用 nuget cmd 安装 Microsoft.Net.Http

```
PM> install-package Microsoft.Net.Http

Private Function UploadFile(req As ApiRequest, filePath As String, fileName As String) As String
    Dim result = String.empty
    Try
        ''//Get file stream
        Dim paramFileStream As Stream = File.OpenRead(filePath)
        Dim fileStreamContent As HttpContent = New  StreamContent(paramFileStream)
        Using client = New HttpClient()
            Using formData = New MultipartFormDataContent()
                ''// This adds parameter name ("action")
                ''// parameter value (req.Action) to form data
                formData.Add(New StringContent(req.Action), "action")
                formData.Add(New StringContent(req.ApiKey), "apiKey")
                For Each param In req.Parameters
                    formData.Add(New StringContent(param.Value), param.Key)
                Next
                formData.Add(New StringContent(req.getRequestSignature.Qualifier), "signature")
                ''//This adds the file stream and file info to form data
                formData.Add(fileStreamContent, "file", fileName)
                ''//We are now sending the request
                Dim response = client.PostAsync(GetAPIEndpoint(), formData).Result
                ''//We are here reading the response
                Dim readR = New StreamReader(response.Content.ReadAsStreamAsync().Result, Encoding.UTF8)
                Dim respContent = readR.ReadToEnd()

                If Not response.IsSuccessStatusCode Then
                    result =  "Request Failed : Code = " & response.StatusCode & "Reason = " & response.ReasonPhrase & "Message = " & respContent
                End If
                result.Value = respContent
            End Using
        End Using
    Catch ex As Exception
        result = "An error occurred : " & ex.Message
    End Try

    Return result
End Function 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-04-26T06:15:54.933

修改了@CristianRomanescu 代码以使用内存流，接受文件作为字节数组，允许空 nvc，返回请求响应并使用 Authorization-header。使用 Web Api 2 测试了代码。

```
private string HttpUploadFile(string url, byte[] file, string fileName, string paramName, string contentType, NameValueCollection nvc, string authorizationHeader)
{
    string boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x");
    byte[] boundarybytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "\r\n");

    HttpWebRequest wr = (HttpWebRequest)WebRequest.Create(url);
    wr.ContentType = "multipart/form-data; boundary=" + boundary;
    wr.Method = "POST";
    wr.Headers.Add("Authorization", authorizationHeader);
    wr.KeepAlive = true;

    Stream rs = wr.GetRequestStream();

    string formdataTemplate = "Content-Disposition: form-data; name=\"{0}\"\r\n\r\n{1}";
    if (nvc != null)
    {
        foreach (string key in nvc.Keys)
        {
            rs.Write(boundarybytes, 0, boundarybytes.Length);
            string formitem = string.Format(formdataTemplate, key, nvc[key]);
            byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);
            rs.Write(formitembytes, 0, formitembytes.Length);
        }
    }

    rs.Write(boundarybytes, 0, boundarybytes.Length);

    string headerTemplate = "Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\nContent-Type: {2}\r\n\r\n";
    string header = string.Format(headerTemplate, paramName, fileName, contentType);
    byte[] headerbytes = System.Text.Encoding.UTF8.GetBytes(header);
    rs.Write(headerbytes, 0, headerbytes.Length);

    rs.Write(file, 0, file.Length);

    byte[] trailer = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "--\r\n");
    rs.Write(trailer, 0, trailer.Length);
    rs.Close();

    WebResponse wresp = null;
    try
    {
        wresp = wr.GetResponse();
        Stream stream2 = wresp.GetResponseStream();
        StreamReader reader2 = new StreamReader(stream2);
        var response = reader2.ReadToEnd();
        return response;
    }
    catch (Exception ex)
    {
        if (wresp != null)
        {
            wresp.Close();
            wresp = null;
        }
        return null;
    }
    finally
    {
        wr = null;
    }
} 
```

测试代码：

```
[HttpPost]
[Route("postformdata")]
public IHttpActionResult PostFormData()
{
    // Check if the request contains multipart/form-data.
    if (!Request.Content.IsMimeMultipartContent())
    {
        throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
    }

    var provider = new MultipartMemoryStreamProvider();

    try
    {
        // Read the form data.
        var result = Request.Content.ReadAsMultipartAsync(provider).Result;
        string response = "";
        // This illustrates how to get the file names.
        foreach (var file in provider.Contents)
        {
            var fileName = file.Headers.ContentDisposition.FileName.Trim('\"');
            var buffer =  file.ReadAsByteArrayAsync().Result;
            response = HttpUploadFile("https://localhost/api/v1/createfromfile", buffer, fileName, "file", "application/pdf", null, "AuthorizationKey");
        }
        return Ok(response);
    }
    catch (System.Exception e)
    {
        return InternalServerError();
    }
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-03-07T09:47:59.007

对我来说，以下作品（主要受以下所有答案的启发），我从 Elad 的答案开始并修改/简化事情以满足我的需要（删除不是文件表单输入，只有一个文件，......）。

希望它可以帮助某人:)

（PS：我知道异常处理没有实现，它假设它是在一个类中编写的，所以我可能需要一些集成工作......）

```
private void uploadFile()
    {
        Random rand = new Random();
        string boundary = "----boundary" + rand.Next().ToString();
        Stream data_stream;
        byte[] header = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "\r\nContent-Disposition: form-data; name=\"file_path\"; filename=\"" + System.IO.Path.GetFileName(this.file) + "\"\r\nContent-Type: application/octet-stream\r\n\r\n");
        byte[] trailer = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "--\r\n");

        // Do the request
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(MBF_URL);
        request.UserAgent = "My Toolbox";
        request.Method = "POST";
        request.KeepAlive = true;
        request.ContentType = "multipart/form-data; boundary=" + boundary;
        data_stream = request.GetRequestStream();
        data_stream.Write(header, 0, header.Length);
        byte[] file_bytes = System.IO.File.ReadAllBytes(this.file);
        data_stream.Write(file_bytes, 0, file_bytes.Length);
        data_stream.Write(trailer, 0, trailer.Length);
        data_stream.Close();

        // Read the response
        WebResponse response = request.GetResponse();
        data_stream = response.GetResponseStream();
        StreamReader reader = new StreamReader(data_stream);
        this.url = reader.ReadToEnd();

        if (this.url == "") { this.url = "No response :("; }

        reader.Close();
        data_stream.Close();
        response.Close();
    } 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-02-04T04:48:15.377

不确定这是否之前发布过，但我使用 WebClient 进行了此操作。我阅读了 WebClient 的文档。他们提出的一个关键点是

> 如果 BaseAddress 属性不是空字符串 ("") 并且 address 不包含绝对 URI，则 address 必须是与 BaseAddress 组合以形成所请求数据的绝对 URI 的相对 URI。如果 QueryString 属性不是空字符串，则将其附加到地址。

所以我所做的只是 wc.QueryString.Add("source", generatedImage) 添加不同的查询参数，并以某种方式将属性名称与我上传的图像匹配。希望能帮助到你

```
 public void postImageToFacebook(string generatedImage, string fbGraphUrl)
    {
        WebClient wc = new WebClient();
        byte[] bytes = System.IO.File.ReadAllBytes(generatedImage);

        wc.QueryString.Add("source", generatedImage);
        wc.QueryString.Add("message", "helloworld");

        wc.UploadFile(fbGraphUrl, generatedImage);

        wc.Dispose();

    } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-09-18T05:20:03.700

当进行多部分表单上传时，我使用 WebClient 编写了一个类。

[http://ferozedaud.blogspot.com/2010/03/multipart-form-upload-helper.html](http://ferozedaud.blogspot.com/2010/03/multipart-form-upload-helper.html)

```
/// 
/// MimePart
/// Abstract class for all MimeParts
/// 

abstract class MimePart
{
    public string Name { get; set; }

    public abstract string ContentDisposition { get; }

    public abstract string ContentType { get; }

    public abstract void CopyTo(Stream stream);

    public String Boundary
    {
        get;
        set;
    }
}

class NameValuePart : MimePart
{
    private NameValueCollection nameValues;

    public NameValuePart(NameValueCollection nameValues)
    {
        this.nameValues = nameValues;
    }

    public override void CopyTo(Stream stream)
    {
        string boundary = this.Boundary;
        StringBuilder sb = new StringBuilder();

        foreach (object element in this.nameValues.Keys)
        {
            sb.AppendFormat("--{0}", boundary);
            sb.Append("\r\n");
            sb.AppendFormat("Content-Disposition: form-data; name=\"{0}\";", element);
            sb.Append("\r\n");
            sb.Append("\r\n");
            sb.Append(this.nameValues[element.ToString()]);

            sb.Append("\r\n");

        }

        sb.AppendFormat("--{0}", boundary);
        sb.Append("\r\n");

        //Trace.WriteLine(sb.ToString());
        byte [] data = Encoding.ASCII.GetBytes(sb.ToString());
        stream.Write(data, 0, data.Length);
    }

    public override string ContentDisposition
    {
        get { return "form-data"; }
    }

    public override string ContentType
    {
        get { return String.Empty; }
    }
} 

class FilePart : MimePart

{

    private Stream input;

    private String contentType;

    public FilePart(Stream input, String name, String contentType)

    {

        this.input = input;

        this.contentType = contentType;

        this.Name = name;

    }

    public override void CopyTo(Stream stream)

    {

        StringBuilder sb = new StringBuilder();

        sb.AppendFormat("Content-Disposition: {0}", this.ContentDisposition);

        if (this.Name != null)

            sb.Append("; ").AppendFormat("name=\"{0}\"", this.Name);

        if (this.FileName != null)

            sb.Append("; ").AppendFormat("filename=\"{0}\"", this.FileName);

        sb.Append("\r\n");

        sb.AppendFormat(this.ContentType);

        sb.Append("\r\n");

        sb.Append("\r\n");

    // serialize the header data.

    byte[] buffer = Encoding.ASCII.GetBytes(sb.ToString());

    stream.Write(buffer, 0, buffer.Length);

    // send the stream.

    byte[] readBuffer = new byte[1024];

    int read = input.Read(readBuffer, 0, readBuffer.Length);

    while (read > 0)

    {

        stream.Write(readBuffer, 0, read);

        read = input.Read(readBuffer, 0, readBuffer.Length);

    }

    // write the terminating boundary

    sb.Length = 0;

    sb.Append("\r\n");

    sb.AppendFormat("--{0}", this.Boundary);

    sb.Append("\r\n");

    buffer = Encoding.ASCII.GetBytes(sb.ToString());

    stream.Write(buffer, 0, buffer.Length);

}

 public override string ContentDisposition
 {
      get { return "file"; }
 }

 public override string ContentType
 {
    get { 
       return String.Format("content-type: {0}", this.contentType); 
     }
 }

 public String FileName { get; set; }

}

    /// 
    /// Helper class that encapsulates all file uploads
    /// in a mime part.
    /// 

    class FilesCollection : MimePart
    {
        private List files;

        public FilesCollection()
        {
            this.files = new List();
            this.Boundary = MultipartHelper.GetBoundary();
        }

        public int Count
        {
            get { return this.files.Count; }
        }

        public override string ContentDisposition
        {
            get
            {
                return String.Format("form-data; name=\"{0}\"", this.Name);
            }
        }

        public override string ContentType
        {
            get { return String.Format("multipart/mixed; boundary={0}", this.Boundary); }
        }

        public override void CopyTo(Stream stream)
        {
            // serialize the headers
            StringBuilder sb = new StringBuilder(128);
            sb.Append("Content-Disposition: ").Append(this.ContentDisposition).Append("\r\n");
            sb.Append("Content-Type: ").Append(this.ContentType).Append("\r\n");
            sb.Append("\r\n");
            sb.AppendFormat("--{0}", this.Boundary).Append("\r\n");

            byte[] headerBytes = Encoding.ASCII.GetBytes(sb.ToString());
            stream.Write(headerBytes, 0, headerBytes.Length);
            foreach (FilePart part in files)
            {
                part.Boundary = this.Boundary;
                part.CopyTo(stream);
            }
        }

        public void Add(FilePart part)
        {
            this.files.Add(part);
        }
    }

/// 
/// Helper class to aid in uploading multipart
/// entities to HTTP web endpoints.
/// 

class MultipartHelper
{
    private static Random random = new Random(Environment.TickCount);

    private List formData = new List();
    private FilesCollection files = null;
    private MemoryStream bufferStream = new MemoryStream();
    private string boundary;

    public String Boundary { get { return boundary; } }

    public static String GetBoundary()
    {
        return Environment.TickCount.ToString("X");
    }

    public MultipartHelper()
    {
        this.boundary = MultipartHelper.GetBoundary();
    }

    public void Add(NameValuePart part)
    {
        this.formData.Add(part);
        part.Boundary = boundary;
    }

    public void Add(FilePart part)
    {
        if (files == null)
        {
            files = new FilesCollection();
        }
        this.files.Add(part);
    }

    public void Upload(WebClient client, string address, string method)
    {
        // set header
        client.Headers.Add(HttpRequestHeader.ContentType, "multipart/form-data; boundary=" + this.boundary);
        Trace.WriteLine("Content-Type: multipart/form-data; boundary=" + this.boundary + "\r\n");

        // first, serialize the form data
        foreach (NameValuePart part in this.formData)
        {
            part.CopyTo(bufferStream);
        }

        // serialize the files.
        this.files.CopyTo(bufferStream);

        if (this.files.Count > 0)
        {
            // add the terminating boundary.
            StringBuilder sb = new StringBuilder();
            sb.AppendFormat("--{0}", this.Boundary).Append("\r\n");
            byte [] buffer = Encoding.ASCII.GetBytes(sb.ToString());
            bufferStream.Write(buffer, 0, buffer.Length);
        }

        bufferStream.Seek(0, SeekOrigin.Begin);

        Trace.WriteLine(Encoding.ASCII.GetString(bufferStream.ToArray()));
        byte [] response = client.UploadData(address, method, bufferStream.ToArray());
        Trace.WriteLine("----- RESPONSE ------");
        Trace.WriteLine(Encoding.ASCII.GetString(response));
    }

    /// 
    /// Helper class that encapsulates all file uploads
    /// in a mime part.
    /// 

    class FilesCollection : MimePart
    {
        private List files;

        public FilesCollection()
        {
            this.files = new List();
            this.Boundary = MultipartHelper.GetBoundary();
        }

        public int Count
        {
            get { return this.files.Count; }
        }

        public override string ContentDisposition
        {
            get
            {
                return String.Format("form-data; name=\"{0}\"", this.Name);
            }
        }

        public override string ContentType
        {
            get { return String.Format("multipart/mixed; boundary={0}", this.Boundary); }
        }

        public override void CopyTo(Stream stream)
        {
            // serialize the headers
            StringBuilder sb = new StringBuilder(128);
            sb.Append("Content-Disposition: ").Append(this.ContentDisposition).Append("\r\n");
            sb.Append("Content-Type: ").Append(this.ContentType).Append("\r\n");
            sb.Append("\r\n");
            sb.AppendFormat("--{0}", this.Boundary).Append("\r\n");

            byte[] headerBytes = Encoding.ASCII.GetBytes(sb.ToString());
            stream.Write(headerBytes, 0, headerBytes.Length);
            foreach (FilePart part in files)
            {
                part.Boundary = this.Boundary;
                part.CopyTo(stream);
            }
        }

        public void Add(FilePart part)
        {
            this.files.Add(part);
        }
    }
}

class Program
{
    static void Main(string[] args)
    {
        Trace.Listeners.Add(new ConsoleTraceListener());
        try
        {
            using (StreamWriter sw = new StreamWriter("testfile.txt", false))
            {
                sw.Write("Hello there!");
            }

            using (Stream iniStream = File.OpenRead(@"c:\platform.ini"))
            using (Stream fileStream = File.OpenRead("testfile.txt"))
            using (WebClient client = new WebClient())
            {
                MultipartHelper helper = new MultipartHelper();

                NameValueCollection props = new NameValueCollection();
                props.Add("fname", "john");
                props.Add("id", "acme");
                helper.Add(new NameValuePart(props));

                FilePart filepart = new FilePart(fileStream, "pics1", "text/plain");
                filepart.FileName = "1.jpg";
                helper.Add(filepart);

                FilePart ini = new FilePart(iniStream, "pics2", "text/plain");
                ini.FileName = "inifile.ini";
                helper.Add(ini);

                helper.Upload(client, "http://localhost/form.aspx", "POST");
            }
        }
        catch (Exception e)
        {
            Trace.WriteLine(e);
        }
    }
} 
```

这适用于所有版本的 .NET 框架。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-06-07T11:02:04.860

我永远无法让示例正常工作，将其发送到服务器时总是收到 500 错误。

[但是我在这个网址](http://www.velocityreviews.com/forums/t63600-multipart-form-data-post.html)中遇到了一种非常优雅的方法

它易于扩展，并且显然可以与二进制文件以及 XML 一起使用。

你用类似的东西来称呼它

```
class Program
{
    public static string gsaFeedURL = "http://yourGSA.domain.com:19900/xmlfeed";

    static void Main()
    {
        try
        {
            postWebData();
        }
        catch (Exception ex)
        {
        }
    }

    // new one I made from C# web service
    public static void postWebData()
    {
        StringDictionary dictionary = new StringDictionary();
        UploadSpec uploadSpecs = new UploadSpec();
        UTF8Encoding encoding = new UTF8Encoding();
        byte[] bytes;
        Uri gsaURI = new Uri(gsaFeedURL);  // Create new URI to GSA feeder gate
        string sourceURL = @"C:\FeedFile.xml"; // Location of the XML feed file
        // Two parameters to send
        string feedtype = "full";
        string datasource = "test";            

        try
        {
            // Add the parameter values to the dictionary
            dictionary.Add("feedtype", feedtype);
            dictionary.Add("datasource", datasource);

            // Load the feed file created and get its bytes
            XmlDocument xml = new XmlDocument();
            xml.Load(sourceURL);
            bytes = Encoding.UTF8.GetBytes(xml.OuterXml);

            // Add data to upload specs
            uploadSpecs.Contents = bytes;
            uploadSpecs.FileName = sourceURL;
            uploadSpecs.FieldName = "data";

            // Post the data
            if ((int)HttpUpload.Upload(gsaURI, dictionary, uploadSpecs).StatusCode == 200)
            {
                Console.WriteLine("Successful.");
            }
            else
            {
                // GSA POST not successful
                Console.WriteLine("Failure.");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-09-08T10:17:23.180

查看 MyToolkit 库：

```
var request = new HttpPostRequest("http://www.server.com");
request.Data.Add("name", "value"); // POST data
request.Files.Add(new HttpPostFile("name", "file.jpg", "path/to/file.jpg")); 

await Http.PostAsync(request, OnRequestFinished); 
```

[http://mytoolkit.codeplex.com/wikipage?title=Http](http://mytoolkit.codeplex.com/wikipage?title=Http)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-02-14T09:20:02.000

客户端使用转换文件到`ToBase64String`，使用xml发布到服务器调用后，该服务器使用`File.WriteAllBytes(path,Convert.FromBase64String(dataFile_Client_sent))`。

好幸运！

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-04-01T09:13:25.730

此方法适用于同时上传多张图片

```
 var flagResult = new viewModel();
        string boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x");
        byte[] boundarybytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "\r\n");

        HttpWebRequest wr = (HttpWebRequest)WebRequest.Create(url);
        wr.ContentType = "multipart/form-data; boundary=" + boundary;
        wr.Method = method;
        wr.KeepAlive = true;
        wr.Credentials = System.Net.CredentialCache.DefaultCredentials;

        Stream rs = wr.GetRequestStream();

        string path = @filePath;
        System.IO.DirectoryInfo folderInfo = new DirectoryInfo(path);

        foreach (FileInfo file in folderInfo.GetFiles())
        {
            rs.Write(boundarybytes, 0, boundarybytes.Length);
            string headerTemplate = "Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\nContent-Type: {2}\r\n\r\n";
            string header = string.Format(headerTemplate, paramName, file, contentType);
            byte[] headerbytes = System.Text.Encoding.UTF8.GetBytes(header);
            rs.Write(headerbytes, 0, headerbytes.Length);

            FileStream fileStream = new FileStream(file.FullName, FileMode.Open, FileAccess.Read);
            byte[] buffer = new byte[4096];
            int bytesRead = 0;
            while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
            {
                rs.Write(buffer, 0, bytesRead);
            }
            fileStream.Close();
        }

        byte[] trailer = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "--\r\n");
        rs.Write(trailer, 0, trailer.Length);
        rs.Close();

        WebResponse wresp = null;
        try
        {
            wresp = wr.GetResponse();
            Stream stream2 = wresp.GetResponseStream();
            StreamReader reader2 = new StreamReader(stream2);
            var result = reader2.ReadToEnd();
            var cList = JsonConvert.DeserializeObject<HttpViewModel>(result);
            if (cList.message=="images uploaded!")
            {
                flagResult.success = true;
            }

        }
        catch (Exception ex)
        {
            //log.Error("Error uploading file", ex);
            if (wresp != null)
            {
                wresp.Close();
                wresp = null;
            }
        }
        finally
        {
            wr = null;
        }
        return flagResult;
    } 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2009-12-17T21:46:00.017

我意识到这可能真的很晚了，但我正在寻找相同的解决方案。我从 Microsoft 代表那里找到了以下回复

```
private void UploadFilesToRemoteUrl(string url, string[] files, string logpath, NameValueCollection nvc)
{

    long length = 0;
    string boundary = "----------------------------" +
    DateTime.Now.Ticks.ToString("x");

    HttpWebRequest httpWebRequest2 = (HttpWebRequest)WebRequest.Create(url);
    httpWebRequest2.ContentType = "multipart/form-data; boundary=" +
    boundary;
    httpWebRequest2.Method = "POST";
    httpWebRequest2.KeepAlive = true;
    httpWebRequest2.Credentials = System.Net.CredentialCache.DefaultCredentials;

    Stream memStream = new System.IO.MemoryStream();
    byte[] boundarybytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" + boundary + "\r\n");

    string formdataTemplate = "\r\n--" + boundary + "\r\nContent-Disposition: form-data; name=\"{0}\";\r\n\r\n{1}";

    foreach(string key in nvc.Keys)
    {
        string formitem = string.Format(formdataTemplate, key, nvc[key]);
        byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);
        memStream.Write(formitembytes, 0, formitembytes.Length);
    }

    memStream.Write(boundarybytes,0,boundarybytes.Length);

    string headerTemplate = "Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\n Content-Type: application/octet-stream\r\n\r\n";

    for(int i=0;i<files.Length;i++)
    {

        string header = string.Format(headerTemplate,"file"+i,files[i]);
        byte[] headerbytes = System.Text.Encoding.UTF8.GetBytes(header);
        memStream.Write(headerbytes,0,headerbytes.Length);

        FileStream fileStream = new FileStream(files[i], FileMode.Open,
        FileAccess.Read);
        byte[] buffer = new byte[1024];

        int bytesRead = 0;

        while ( (bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0 )
        {
            memStream.Write(buffer, 0, bytesRead);
        }

        memStream.Write(boundarybytes,0,boundarybytes.Length);

        fileStream.Close();
    }

    httpWebRequest2.ContentLength = memStream.Length;
    Stream requestStream = httpWebRequest2.GetRequestStream();

    memStream.Position = 0;
    byte[] tempBuffer = new byte[memStream.Length];
    memStream.Read(tempBuffer,0,tempBuffer.Length);
    memStream.Close();
    requestStream.Write(tempBuffer,0,tempBuffer.Length );
    requestStream.Close();

    WebResponse webResponse2 = httpWebRequest2.GetResponse();

    Stream stream2 = webResponse2.GetResponseStream();
    StreamReader reader2 = new StreamReader(stream2);

    webResponse2.Close();
    httpWebRequest2 = null;
    webResponse2 = null;

} 
```

# php - CodeIgniter 安装问题

> ID：566469
> 
> 赞同：0
> 
> 时间：2009-02-19T18:05:38.723
> 
> 标签：php, apache, codeigniter, frameworks, shared-hosting

我在让 CodeIgniter 使用我的共享主机帐户时遇到问题。URL 是[http://test.tallgreentree.com](http://test.tallgreentree.com)。它没有给我一个 .php 错误，但它显示了我在地址栏中键入的所有内容的 404 页面。

这是我的 config.php 文件的开头。

```
<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');

/*
|--------------------------------------------------------------------------
| Base Site URL
|--------------------------------------------------------------------------
|
| URL to your CodeIgniter root. Typically this will be your base URL,
| WITH a trailing slash:
|
|   http://example.com/
|
*/
$config['base_url'] = "http://test.tallgreentree.com/";

/*
|--------------------------------------------------------------------------
| Index File
|--------------------------------------------------------------------------
|
| Typically this will be your index.php file, unless you've renamed it to
| something else. If you are using mod_rewrite to remove the page set this
| variable so that it is blank.
|
*/
$config['index_page'] = "index.php";

/*
|--------------------------------------------------------------------------
| URI PROTOCOL
|--------------------------------------------------------------------------
|
| This item determines which server global should be used to retrieve the
| URI string.  The default setting of "AUTO" works for most servers.
| If your links do not seem to work, try one of the other delicious flavors:
|
| 'AUTO'            Default - auto detects
| 'PATH_INFO'       Uses the PATH_INFO
| 'QUERY_STRING'    Uses the QUERY_STRING
| 'REQUEST_URI'     Uses the REQUEST_URI
| 'ORIG_PATH_INFO'  Uses the ORIG_PATH_INFO
|
*/
$config['uri_protocol'] = "AUTO"; 
```

将 CodeIgniter 与子域一起使用时是否存在已知问题？这可能是什么原因造成的？我尝试了多种配置，但似乎没有什么对我有用。我应该向我的托管服务提供商检查哪些服务器设置？

感谢大家的时间和帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:51:32.627

改变

```
$config['uri_protocol'] = "AUTO"; 
```

到

```
$config['uri_protocol'] = "REQUEST_URI" 
```

看看能不能解决

另外，您的类控制器名称是否与文件名相同？

文件名 = test.php

```
class Test ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-23T18:10:47.497

我用“REQUEST_URI”得到了这个，但我只能点击我的主页。所有其他链接（到控制器）总是刷新到主页。它显示正确的 URL 但无论您单击哪个 URL 都会将您带到主页，这有点奇怪。

有任何想法吗？我确实有一个 .htaccess 文件，

RewriteBase 上的 RewriteEngine /testci RewriteCond %{REQUEST_URI} ^system.* RewriteRule ^(. *)$ /index.php/$1 [L] RewriteCond %{REQUEST_FILENAME} !-f RewriteCond %{REQUEST_FILENAME} !-d RewriteRule ^(.* ) $ index.php/$1 [L] RewriteCond $1 !^(index.php|images|captcha|css|js|robots.txt) addType text/css .css

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-22T06:58:01.277

在 config.php 文件中进行 2 处更改

第一个是：

```
 `$config['uri_protocol'] = "AUTO";` 
```

到

```
 `$config['uri_protocol'] = "REQUEST_URI"` 
```

第二个是：

```
 $config['index_page'] = 'index.php'; 
```

到

```
 $config['index_page'] = 'index.php?'; 
```

# gcc - gcov 符号在哪里？

> ID：566472
> 
> 赞同：62
> 
> 时间：2009-02-19T18:06:27.430
> 
> 标签：gcc, profile, gcov

我正在尝试使用 gcov 编译一个简单的应用程序并收到以下链接错误：

```
gcc AllTests.o CuTestTest.o CuTest.o -o TestTest
AllTests.o: In function `global constructors keyed to 0_RunAllTests':
/home/p7539c/cutest/AllTests.c:26: undefined reference to `__gcov_init'
AllTests.o:(.data+0x44): undefined reference to `__gcov_merge_add'
CuTestTest.o: In function `global constructors keyed to 0_TestCuStringNew':
/home/p7539c/cutest/CuTestTest.c:30: undefined reference to `__gcov_init'
CuTestTest.o:(.data+0x64): undefined reference to `__gcov_merge_add'
CuTest.o: In function `global constructors keyed to 0_CuStrAlloc':
/home/p7539c/cutest/CuTest.c:379: undefined reference to `__gcov_init'
CuTest.o:(.data+0x184): undefined reference to `__gcov_merge_add'
collect2: ld returned 1 exit status
make: *** [TestTest] Error 1 
```

我似乎无法找到丢失符号的位置。gcov 存在于运行 gcc 版本 4.1.2 的机器上

有任何想法吗？谢谢。

编辑时：

将 gcov 与由一个 .c 文件组成的应用程序一起使用时，一切似乎都运行良好。当我有多个 .c 文件（因此有多个 .o 文件）时，我遇到了上述问题。

编译步骤如下所示：

```
cc -fprofile-arcs -ftest-coverage -g   -c -o AllTests.o AllTests.c
cc -fprofile-arcs -ftest-coverage -g   -c -o CuTestTest.o CuTestTest.c
cc -fprofile-arcs -ftest-coverage -g   -c -o CuTest.o CuTest.c 
```

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-18T19:33:42.747

我刚刚花费了大量的时间来调试一个非常相似的错误。这是我学到的：

*   `-fprofile-arcs -ftest-coverage`编译时必须通过。
*   链接时必须通过`-fprofile-arcs`。
*   链接时仍然会出现奇怪的链接器错误。它们看起来像这样：

    `libname.a(objfile.o):(.ctors+0x0): undefined reference to 'global constructors keyed to long_name_of_file_and_function'`

这意味着 gconv 与您的编译器生成的构造函数之一（在我的情况下是复制构造函数）存在问题。检查错误消息中提到的函数，查看它复制构造的对象类型，并查看这些类中是否有任何类没有复制构造函数。添加一个，错误就会消失。

编辑：您是否优化也会影响这一点。如果您遇到问题，请尝试打开/关闭优化。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-19T21:38:37.960

您正在寻找的标志是[-lgcov 链接时](http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#index-coverage-495)。也就是说，改变：

```
gcc AllTests.o CuTestTest.o CuTest.o -o TestTest 
```

至

```
gcc -lgcov AllTests.o CuTestTest.o CuTest.o -o TestTest 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-03-18T13:34:35.713

编译和链接时，您应该只能`--coverage`在命令行上指定。

根据[`man gcc`](http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#index-coverage-536)：

> 该选项是`-fprofile-arcs` `-ftest-coverage`（编译时）和`-lgcov`（链接时）的同义词。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-11-03T13:36:17.410

我发现，[正如这里所建议](http://www.spinics.net/lists/gcchelp/msg29518.html)的那样，在构建包含使用 -fprofile-arcs -ftest-coverage 构建的.o 的共享库时，将 -lgcov 添加到构建行为我解决了这个问题。当然，将可执行文件与 -lgcov 链接起来。像这样构建共享库：

```
g++    -shared -o libMyLib.so src_a.o src_b.o src_c.o -lgcov 
```

可执行文件如下：

```
g++ -o myExec myMain.o -lMyLib -lgcov 
```

将 -lgov 添加到共享库（不仅仅是 exe）的构建中，为我解决了这个额外的错误：

```
hidden symbol `__gcov_merge_add' in /usr/lib/gcc/x86_64-redhat-linux/4.1.2/libgcov.a(_gcov_merge_add.o) is referenced by DSO
/usr/bin/ld: final link failed: Nonrepresentable section on output 
```

请注意 -lgcov 必须是最后一个链接库。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-19T19:57:11.203

我尝试了一个简单的测试文件，`gcc -ftest-coverage -fprofile-arcs test.c`没有像你描述的那样出现问题。

我怀疑如果`-ftest-coverage`链接时标志在那里，gcc 会引入 gcov 库。尝试在 gcc 命令行上传递该标志。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-08T21:29:56.607

也许很明显，在与非 gcc 链接器链接时会产生这个确切的错误消息。我们在与 ifort 链接时看到此错误（因为我们的代码同时包含 Fortran 和 C 模块）。切换到与 gcc 链接就成功了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-02-21T07:49:49.910

伟大的 Max Lybbert，基本上在使用 autoconf 的情况下添加 _LDADD = -lgcov ...

这将解决问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-19T21:18:37.877

所以我在 CFLAGS 中添加了 -shared，现在它似乎可以处理多个文件。当然，它在一个奇怪的地方取芯，所以我还不知道那是什么。

# database-design - 有很多责任的桌子的最佳方法

> ID：566484
> 
> 赞同：0
> 
> 时间：2009-02-19T18:09:07.990
> 
> 标签：database-design

我目前正在制作各种申请表的电子版。每个表单很可能都需要一些关于用户的特定数据。为了争论，这里有一个简化的版本。

```
      表格所需信息
 ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ ¯¯             
 里程申领 用户有租车吗？
 加班索赔合同类型（永久/临时）。薪水
 采购请求用户角色（主管、技术员）

```

我目前不知道这个系统上总共会有多少表格，或者他们可能需要关于用户的其他额外信息。但可以肯定的是，他们都需要标准的东西，比如姓名、电子邮件、工资单号码等。

你会采取什么方法来模拟这个？将其全部放入用户表或创建大量引用用户的表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:19:23.853

将其全部放入 users 表是不断增长的“[泥球](http://en.wikipedia.org/wiki/Big_ball_of_mud)”模式的秘诀。最终，您将拥有一个包含 300 个字段的表格 - 名字、姓氏、地址、工作地址、夏季地址、ownsaleasecar、likespizza ......

我会让他们都共享一个用户对象。用户会反映他们的共同点。如果他们使用不同类型的用户（例如，有些人拥有个人信息，而有些人是拥有完全不同数据集的员工），那么拥有用户和员工等可能是合理的。主要的一点是，我不会尝试将不同的类型硬塞到同一张桌子上。

编辑-另外一点是，将不同的数据类型混合在一起会使执行完整性变得不可能-假设您将“RentalCarUser”和“EmployeeUser”分组到同一个表中，并且您有用于RentalCarUsers的字段“DoesUserHaveLeaseCar”。那么，它将为空或对员工具有无意义的默认值，并且如果您确实想要强制每个租车用户都必须拥有该信息，那么您不能在数据库级别强制执行它（字段！= null) 因为您有其他用户不适用该值。添加触发器来为员工填写“NA”并没有帮助，因为您会得到一大堆带有“NA”的记录，并且您无法轻易判断这是正确的还是缺失的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T18:25:47.500

你有你的 3 张桌子。

> ```
> users_tbl
> ---------
> id
> name
> ...
> 
> form_tbl
> --------
> id
> name
> ...
> 
> formRequirement_tbl
> -------------------
> form_requirement_id
> form_id
> and/or Flag 
> ```

现在你得到了超级复杂的逻辑。

> ```
> bool CheckRequirements($formid, $userid)
> {
>     $arrayOfFormRequirementIds = goGetFormRequirementIds($formid);
>     $result = false;
>     foreach($requirementId,$andOrFlag in $arrayOfFormRequirementIds)
>     {
>        switch($requirementId)
>        {
>           case 1:
>                $sql = "Select 1 from leases where userid = $userid and active = 1";
>                $result |= executeSQLQueryScalar($sql);
>                if($andOrFlag == AND && !$result) 
>                     return false;
>                break;
>           ...
>         }
>      }
>   return $result;
> } 
> ```

现在是不是整个事情都被一个巨大的 switch 语句赶走了？ **是**的。但是通过这样做，您可以使关于用户可以填写哪些表单的逻辑变得极其复杂：

*   用户的电话号码不能为空
*   用户必须有有效的汽车租赁（这可能很难弄清楚）
*   用户必须在 20 到 50 岁之间，拥有有效的电子邮件，并且住在蒙大拿州，除非他超过 60 岁并且住在佛罗里达州

如果您只是存储列名来检查空值，您将无法执行复杂的逻辑。如果您将单个位存储在用户表中，例如“canFillOutMarriageForm”，则您必须等到更新这些的作业运行后，用户才能填写结婚表格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T18:29:02.707

我将使用用户名（如果强制执行唯一性）或用户 ID 作为引用所有相关信息的键，以模块化方式设计数据库。通过将信息模块化到多个表格中，您会做得更好并学到更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T18:32:32.547

看来您对数据库规范化并不熟悉，所以我建议您阅读一些有关这方面的教程。这里只是一个例子：[http://dev.mysql.com/tech-resources/articles/intro-to-normalization.html](http://dev.mysql.com/tech-resources/articles/intro-to-normalization.html)

您要从要求您在数据库中建模的纸质表格开始。表单上的每个字段都成为（非规范化）数据库中的一个字段。由于您要处理多个表单，因此您可能会有一些共同的字段。这是一个很好的线索，您应该将它们抽象到一个单独的表中。例如，听起来所有三个表单都将有一个地方供员工写他们的姓名以识别谁在填写表单，因此您需要一个 Employee 表。

从那里，只需按照 Internet 上的众多规范化教程之一进行操作即可。第三范式是大多数人所能达到的，但即使是第二范式也是改进。您可能经常会发现您的设计已经处于第一范式。

# html - 有没有办法在 CSS 中将值引用为“变量”？

> ID：566485
> 
> 赞同：4
> 
> 时间：2009-02-19T18:09:27.460
> 
> 标签：html, css, standards-compliance

我正在尝试为内部 webapp 正确编写 HTML 和 CSS。在技​​术上尽可能多地，我希望 HTML 标记定义页面的*内容*，并且完全独立于需要的布局。

显然不可能完美地做到这一点。每次我不得不添加一个额外的嵌套 div 以使布局工作的唯一目的时，我都会在里面死去一点。

我一直试图解决的最新问题是如何减少 .css 文件中重复文本的数量。主要是颜色。在我的整个应用程序中，我使用颜色来表示“干净”、“错误”、“警告”和“赦免”，到目前为止，几乎每个使用颜色的地方都需要明确定义它们。有时它们用于文本颜色，有时用于背景颜色，有时用于边框颜色。

**有没有办法为名称分配诸如颜色之类的值，然后在 CSS 属性中引用该名称？**

我知道继承在 CSS 中是如何工作的，并且我知道实现这一目标的一种方法是在我的许多元素上使用多个类名，然后我就可以`backgroundClean`成为各种对象使用的样式。但这需要让 HTML 了解更多仅与页面风格布局相关的数据，而不是与我提到的数据相关的数据，正如我所提到的，我想*避免*这种情况。

额外问题：**做这种事情的最佳实践是什么？**当 HTML+CSS 还没有准备好时，我试图让 HTML+CSS 表现得像 MVC 一样愚蠢吗？我知道这是 CSS 一直在发展的方向，但也许还没有。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-19T18:13:27.317

为什么是的，有新引入的[css 变量](http://disruptive-innovations.com/zoo/cssvariables/)可以做到这一点！

不幸的是……它还没有进入浏览器，所以你还不能使用它们。

要获得相同的行为，您需要使用某种服务器端语言将颜色动态输出到您的 CSS 文件中。（你也可以使用大量的 javascript，但这太可怕了）

所以在 PHP 中你可以这样做：

> ```
> styles.php---------------------
> <?php
> $warningColor = "#f00";
> ?>
> 
> .warning {
>      color: <?=$warningColor?>;
> }
> .error {
>      color: <?=$warningColor?>;
> }
> 
> index.html----------------------
> 
> <link rel="stylesheet" src="styles.php" /> 
> ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T18:15:41.933

没有任何当前的浏览器支持。[虽然如果你用SASS](http://haml.hamptoncatlin.com/docs/rdoc/classes/Sass.html)之类的东西预处理你的 CSS，那么你就可以做到这一点，甚至更多。SASS 改进 CSS 几乎是每一种方式。它使编写样式表变得更加容易和有趣。我永远不会回去写 vanilla CSS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T18:14:12.700

我不确定我是否完全理解你的问题，但你可能想考虑简单地为颜色分配一个特定的类。例如，如果“警告”的所有文本/div/等都是鲜红色，您可以在您的 css 中执行此操作：

```
.warning { color: #f00; } 
```

然后每当你有一个 div，即使它已经有额外的类，你只需添加这个，用空格分隔这些类：

```
<div class="message warning">Invalid username.</div> 
```

需要注意的一点是，为类使用颜色名称并不是一种好的做法，例如，您不应该定义一个名为“blue”的类。您应该尝试使用该颜色所代表的名称，以防您将来希望更改它。

编辑：您确实在问题中提到了这一点，但据我所知，这将是目前最好的方法，所以我只是想稍微扩展一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-29T04:52:20.970

I"ve just discovered this (mentioned on the StackExchange Podcast): [http://lesscss.org/](http://lesscss.org/)

It's javascript that lets you put variables (and other capabilities) in your CSS.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T18:16:13.290

我认为您完成此任务的最佳方法是从服务器端。让服务器处理你的 CSS，这样你就可以输出你想要的任何东西。

例如，如果您使用 C#，您将使用脚本块引用变量

```
width: <%= Width %> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T18:23:28.407

使用纯 HTML 和 CSS 无法做到这一点。

当要求实现类似效果时，您可以即时生成 CSS；但是，您必须非常小心地控制此类 CSS 的缓存，以在完全控制输出和最小化用户带宽使用之间找到平衡点。

您也可以使用 jQuery 或任何其他 JavaScript 框架来实现它，但这会给浏览器带来更多的工作量，如果不加限制地使用可能会使您的页面对用户没有响应。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T09:28:37.557

另一种可能的解决方案是为每种样式包含多个定义...

```
.error{ text-decoration: underline; font-weight: bolder}

.cancelled{ text-decoration: line-through; font-style: italic;}

.warning{font-weight: bold}

.comment{font-size: smaller; font-style: italic}
.
.
.

.error, .cancelled { color: red };

.warning, .comment {color: green}; 
```

这里的关键是你已经决定 error 和 cancelled 应该是彼此相同的颜色，而 warning 和 comment 应该是彼此相同的颜色。要使用的实际颜色与其他样式属性分开定义，如果需要颜色更新，则允许更改单个值。

我要给出的警告是，您的样式定义分为两个地方，因此有人可能会更新主要的样式以使用不同的颜色，然后花很长时间挠头才意识到为什么它没有效果- 即因为第二个定义覆盖它。

@Bob 和 Tom Ritter 提到的服务器端方法也值得考虑，但与我建议的方法一样，它容易受到缓存问题的影响。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-19T18:19:17.330

是的——它叫做 jQuery。使用 JavaScript 和一个好的 JavaScript 库（jQuery 非常好）并以这种方式操作你需要的东西。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-19T18:36:16.150

如果您不想或无权访问服务器端脚本，一种解决方法是在客户端上使用 Javascript。只需使用 document.write() 即可解决问题。唯一的问题是换行...

```
<script type="text/javascript">
<!--
var sColor = "#f0000";
var myCSS = ".red {" +
             "    color: " + sColor+
              "}" +
             ".error { " +
                  color: " + sColor +
             "}";

document.write(myCSS);
-->
</script> 
```

写或读（恕我直言）不太繁琐，维护起来也很简单......就个人而言，我更喜欢服务器端语言。这样你就可以完全控制正在发生的事情。或者至少多一点。;-)

# flash - 以编程方式在 Flash 中淡入消失点（当然）

> ID：566489
> 
> 赞同：0
> 
> 时间：2009-02-19T18:11:04.840
> 
> 标签：flash, transformation, scale9grid

[我正在尝试做一个像这样](http://www.freehandsource.com/_frames/_tips/_archive/tip_week103.html)消失的星球大战类型的事情，但是以编程方式。

他们所做的大部分工作都很容易编程（制作补间动画），但我也希望以编程方式生成基于文本的图形（例如，使用动态文本 obj 从文本生成）。

**问题，正如我所看到的**（但我当然愿意以其他方式看待它）**是：有没有办法从我的动态文本对象中获得一个斜边矩形？**[这里](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/DisplayObject.html#scale9Grid)提到的scale9grid不会这样做，我很确定。我想指定四个点来获得一个菱形（如果这就是它的名字）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T05:13:51.203

如果您正在为 flash player 10 编译（需要 CS4 或最近的 flex sdk），您可以在 3d 中旋转文本字段：

```
text.rotateX = -45; 
```

这还有一些问题，例如您需要使用字体嵌入，以及在字段中心获取消失点。

如果您是自虐狂，并且不介意一些垂直锯齿，那么在小于 10 的 Flash 播放器中使用位图执行此操作也是可能的。这个想法是使用 BitmapData.draw() 来绘制每条线，高度为 1 的剪切矩形和一个变换来进行透视分割。例如（弹性）：

```
class Main extends Sprite
{
    [Embed(systemFont="Arial", fontName="embedFont", mimeType="application/x-font")]
    var embedFont:Class;

    public function Main()
    {
        var text:TextField = new TextField();
        text.defaultTextFormat = new TextFormat("embedFont", 30);
        text.embedFonts = true;
        text.autoSize = TextFieldAutoSize.LEFT;
        text.text = "Hello, world\nHow nice\nto have\nmultiple\nlines!";
        var bmp:BitmapData = new BitmapData(150, 100);

        for (var i:int = 0; i != bmp.height; ++i) {
            var m:Matrix = new Matrix();
            // x-division, change 0.8, 0.2 to change scale increase, scale at top
            m.a = i*(0.8/bmp.height)+0.2;
            // horizontal center
            m.tx = bmp.width * (1-m.a) / 2;
            // y-division, and align text to bottom
            m.ty = (bmp.height-i)/m.a - bmp.height; 
            bmp.draw(text, m, null, null, new Rectangle(0, i, bmp.width, 1));
        }

        addChild(new Bitmap(bmp));
    }
} 
```

I haven't done the maths, so I don't know if that's physically accurate, but it should give you an idea.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T18:13:24.527

您可能会考虑将文本对象转换为图像，然后对图像执行此操作。

-亚当

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T21:32:42.187

在 Flash Player 9 和更早的版本中，您无法以简单的方式真正做到这一点。
Flash player 10 和 Flash CS4 引入了对 3D 转换的一些基本支持，但这些都非常简单，我想这种“极端”视角可能很难正确处理。但是我没有使用 CS4 创作工具，所以在那里可能更容易。

还有像[papervision](http://blog.papervision3d.org/)和[away3d](http://away3d.com/)这样的完整 3D 引擎，尽管它们有点矫枉过正。

我认为最好的方法是使用[DisplacementMapFilter](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/filters/DisplacementMapFilter.html)，我很难在网上找到任何好的例子，而且我自己从来没有真正做过，但我认为[文档中的例子](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/filters/DisplacementMapFilter.html#includeExamplesSummary)应该让你开始就好了。

如果您愿意，您*也*可以将所有像素绘制到位图并一个一个地处理它们，这可能是编码最有趣的事情，但它可能会很慢而且看起来不太好；）

# 3d - 与低端视频卡（没有像素着色器）一起使用的 3d 图形库？

> ID：566493
> 
> 赞同：1
> 
> 时间：2009-02-19T18:12:52.857
> 
> 标签：3d

想知道 3D 图形引擎中的选项，它们甚至可以在不支持像素着色器或专用视频内存的卡上工作。

例如，xna 示例不适用于我的笔记本（没有专用显存、共享显存（64MB）和像素着色器）

虽然，在这个非常笔记本的虚幻锦标赛（第一版）上运行流畅。

我知道 OpenGL 是一种选择，可以通过互操作在 C# 中使用。

开发在低端硬件上运行的 3d 应用程序是否有其他选择？

**更新 #1：**首选开发平台 - dotNet

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:18:29.483

DirectX 在支持低端硬件方面仍然相当不错。当然，如果您的硬件不支持像素着色器等高级功能，您将无法使用它们，但它可以在软件中模拟很多功能（包括硬件 T&L）。

如果您使用的是 C#，则需要查看 Managed DirectX。首先，MSDN 有一篇介绍该技术的[文章](http://msdn.microsoft.com/en-us/magazine/cc164112.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T18:18:03.650

[OpenGL-ES](http://www.khronos.org/opengles/)适用于低端卡/手机

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T18:18:51.357

您可以使用 openGL 或 DirectX。

DirectX 有一个托管库，您可以在 C# 中使用，也可以[使用 PInvoke 将窗口 id 从 C# 传递](http://blogs.microsoft.co.il/blogs/dhelper/archive/2008/11/24/how-to-render-managed-net-form-using-native-directx.aspx)到本机 C++ DirectX。

DirectX 和 OpenGL 都支持不支持像素着色器的旧显卡。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T18:23:52.743

[Pixomatic](http://www.radgametools.com/pixomain.htm)专门设计为 DX9 的软件替代品。但是，它不是免费的。

# notation - 计算机编程符号的艺术问题

> ID：566501
> 
> 赞同：13
> 
> 时间：2009-02-19T18:14:26.897
> 
> 标签：notation, taocp

我刚开始阅读 TAOCP 第 1 卷，但我无法理解其风格。

Knuth 提到了一种计算方法是四元组（Q，I，Omega，f）——但我无法理解这些方法中的每一个是什么。我理解他的第一个例子，但不明白他的第二个例子

我正在看第三版的第 8 页。

* * *

在本章的最后，有一个算法讨论了字符串集。

（我已经用一些更容易输入的变量替换了希腊变量——抱歉）

令 A 为有限的字母集，令 A* 为 A 上所有字符串的集合。想法是对计算状态进行编码，以便它们由 A* 的字符串表示

```
Q = (s,j) where s is in A* and j is an integer, 0 <= j <= N 
I = subset of Q with j = 0
Omega = subset with j = N
f = function below 
```

（注意 p & w 是字符串）如果和 s 是 A* 中的字符串，我们说 T 出现在 s 中，如果 s 对字符串 p 和 w 具有 pTw 的形式。

```
f(s,j) = (s,a j ) 如果 T j不在 s 中出现；
f(s,j) = (pY j w,b j ) 如果 p 是 s = pY j w的最短可能字符串
f(s,N) = (s,N)

```

我理解制作字符串集的概念，但不理解他在这里想说的**所有内容。**为什么我需要Q、I、Omega？f 真正向我解释了什么（为什么我需要 f 中的 3 个函数？）？

任何人都可以帮忙阐明一下吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-02-22T15:36:33.873

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-19T18:35:12.360

`Q`= 状态集（`(s, j)`表示`s`时间状态`j`）
`I`= 初始状态（因此要求`j == 0`）
`Omega`= 最终状态（因此要求`j == N`）
`f`= 转换函数

此外，没有命名三个函数`f`，而是`f`由三个方程分段定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T18:35:59.910

我不是 100% 确定，但看起来 Q 是 0 <= J <= N 的所有有序对 (s, j) 的集合。这将是您的域。它是给定一些 N 和字符串 s 的所有可能状态的集合。

I 是 Q 的子集，其中所有有序对都包含 J=0，或您的初始状态。Omega 是 Q 的子集，其中所有有序对都包含 J=N，或您的最终状态。

f 是域 Q 上的实际函数。

**编辑**

可以将函数定义视为一个函数，但根据给定的输入，情况会有所不同。想一想你会用一种语言编写的函数。前任：

```
tuple f(string s, int i)
{
    if (Tj not in s)
        (s, aj)
    else if ( p is shortest possible length such that s = pYjw)
        (pYjw,bj)
    else if ( i == N )
        (s, N)
} 
```

另一个例子是[斐波那契函数定义](http://en.wikipedia.org/wiki/Fibonacci_number)。看看这是怎么定义的？有道理？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-14T11:12:13.790

如果你能通过他在书中前面提到的 euclid 的 gcd 算法。这个想法是将每次迭代的开始标记为初始阶段，然后定义将在一次循环中出现的状态数（即 N）。现在你会记得，当 m 除以 n 的余数等于 0 时，我们接受了答案并停止了计算。即，我们正在搜索字符串 Yj 的特定出现。当计算到达循环中的 itz 最终阶段时，它必然会停止或重复。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-01T12:31:56.417

remember we are defining a 'computational method' and not an algorithm. what is a computational method naively?

> a "procedure" that has all characteristics of an algorithm except that it possibly lacks finiteness, may be called a computational method.

simply put Q is a computational method.

```
Q = {all possible states of computations, I, Ω}
I = {all possible inputs}
Ω = {all possible outputs}
f = computational rule 
```

f is a function from Q into itself.

```
f: Q  --->  Q
  [I]      [Ω] 
```

f should leave Ω [pointwise](https://en.wikipedia.org/wiki/Pointwise) fixed which means:

> f(q) = q, ∀ q ∈ Ω note it is not any different function but the same computationalrule just seperated to Ω</p>

Now a procedure will have a sequence. And obviously, a computational method must also have a sequence. Hence,

> Each input x in the set I defines a computational sequence x[0], x[1], x[2], ..., as follows: x[0] = x and x[k+1] = f(x[k]) for k ≥ 0.

How x[0] = x? Don't forget the input x is a sequence and so the initial input sequence would be x[0]. As we are dealing with a sequence, and when we are concerning about 'k' states, the order and the position of elements in the sequence matters. And so, the computational rule f is such that the position or more precise word 'state' of the k^(th) element would be k+1^(th) state. that way, we can seperately apply the function to each new state to get the state that follows.

if x[k+1] is not in Ω, then it makes no sense by definition of a function. Hence the wording of Knuth.

> The computational sequence is said to terminate in k steps if k is the smallest integer for which x[k] is in Ω and in this case, it is said to produce the output x[k] from x.

Thus this is the definition of a computational method. the computational rule is the algorithm.

# .net - 使用 StructureMap 配置配置文件

> ID：566506
> 
> 赞同：7
> 
> 时间：2009-02-19T18:16:02.277
> 
> 标签：.net, configuration, structuremap

**重要**；我*真的*在这里寻找[`StructureMap`](http://structuremap.sourceforge.net/Default.htm)答案。请不要说如何使用 Windsor、Spring、Unity 或任何[其他工具](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)来实现。

我正在玩`StructureMap`IoC - 基本上我的目标是拥有一个定义核心类型的“默认”配置文件，以及一些覆盖/扩展它的命名配置文件。我*认为*配置文件可以做到这一点，但我根本无法通过 xml 或代码 API 让它工作。特别是，如果我尝试为配置文件加载容器：

```
container = new Container();
container.SetDefaultsToProfile(profile); 
```

然后我得到“找不到请求的配置文件 {name}”，尽管我清楚地调用`CreateProfile`了初始化（使用该名称）。

我在吠叫错误的树吗？

（也发布到[用户组](http://groups.google.com/group/structuremap-users/browse_thread/thread/a0f67ba586eb3bcd?hl=en)）

* * *

我理想中想要的是能够定义*标准*（/默认）类型，然后对于一系列不同的命名配置，覆盖一些设置 - 即如果我有

*   全局：`IFoo`=> `Foo`，`IBar`=>`Bar`
*   configA：（没有变化）
*   配置B：`IFoo`=>`SpecialFoo`

我相信这可以映射到 2 个容器，使用命名配置文件加载。目的是，如果我向任一容器询问 an `IBar`，我会得到一个 `Bar`- 但 configA 返回一个`Foo`(for `IFoo`)，而 configB 返回一个 `SpecialFoo`.

有人可以告诉我如何配置它吗？xml 或代码都很好......我只是想让它工作。我需要的只是接口到具体类型的映射（没有特殊的配置/属性设置）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-25T18:45:30.997

诀窍是确保每个配置文件都至少作为其中定义的规则。如果您不指定规则 (configA)，它将不会创建/查看配置文件。

鉴于这些类：

```
public interface IFoo { string SayHello(); }
public class Foo : IFoo { public string SayHello() { return "Hello"; } }
public class SpecialFoo : IFoo { public string SayHello() { return "Hello Special"; } }

public interface IBar { }
public class Bar : IBar { }

public interface IDummy { }
public class Dummy : IDummy{ } 
```

您可以定义此注册表：

```
public class MyRegistry : Registry
{
    protected override void configure()
    {
        ForRequestedType<IBar>().TheDefault.Is.OfConcreteType<Bar>();
        ForRequestedType<IFoo>().TheDefault.Is.OfConcreteType<Foo>();
        CreateProfileNotEmpty("configA");
        CreateProfileNotEmpty("configB")
            .For<IFoo>().UseConcreteType<SpecialFoo>();
    }
    StructureMap.Configuration.DSL.Expressions.ProfileExpression CreateProfileNotEmpty(string profile)
    {
        return CreateProfile(profile)
            .For<IDummy>().UseConcreteType<Dummy>();
    }
} 
```

它将适用于这些测试：

```
[TestMethod]
public void TestMethod1()
{
    var container = new Container(new MyRegistry());
    Assert.IsNotNull(container.GetInstance<IBar>());
    Assert.AreEqual("Hello", container.GetInstance<IFoo>().SayHello());

    container.SetDefaultsToProfile("configB");
    Assert.IsNotNull(container.GetInstance<IBar>());
    Assert.AreEqual("Hello Special", container.GetInstance<IFoo>().SayHello());

    container.SetDefaultsToProfile("configA");
    Assert.IsNotNull(container.GetInstance<IBar>());
    Assert.AreEqual("Hello", container.GetInstance<IFoo>().SayHello());
} 
```

如果将 CreateProfileNotEmpty 替换为简单的 CreateProfile，它将在将默认设置为 configA 的行上失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-29T20:56:14.227

观看此视频，他展示了另一种执行“默认”配置文件并使用其他命名配置文件作为变体的方法。

[http://www.dimecasts.net/Casts/CastDetails/135](http://www.dimecasts.net/Casts/CastDetails/135)

# cakephp - 当 CakePHP Model::save() 不尝试插入时如何调试

> ID：566508
> 
> 赞同：22
> 
> 时间：2009-02-19T18:16:51.247
> 
> 标签：cakephp

我有时间从一个名为 ItemView 的模型中保存最简单的记录：

```
if($this->save($this->data)) {
  echo 'worked';
} else {
  echo 'failed';
} 
```

$this->data 在哪里：

```
Array
(
    [ItemView] => Array
        (
            [list_id] => 1
            [user_id] => 1
        )
) 
```

我的桌子是：

```
CREATE TABLE IF NOT EXISTS `item_views` (
  `id` int(11) NOT NULL auto_increment,
  `list_id` int(11) NOT NULL,
  `user_id` int(11) default NULL,
  `user_ip` int(10) unsigned default NULL,
  `created` datetime NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 ROW_FORMAT=FIXED AUTO_INCREMENT=1 ; 
```

在调试模式下查看查询转储，Cake 甚至没有尝试插入，所以我不知道如何调试。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-19T18:32:02.220

哇，浪费了我生命中两个悲惨的小时。

请记住，您`beforeSave()`必须返回`true`！

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-12-10T18:48:48.083

To debug Model->save() check the validation errors and the last sql query

```
$this->Model->save($data);

debug($this->Model->validationErrors); //show validationErrors

debug($this->Model->getDataSource()->getLog(false, false)); //show last sql query 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-03-07T12:13:15.657

In cakephp 3.x, you can debug during insert/update

```
if ($this->TableName->save($entity)) {
      // success 
} else {
// if not save, will show errors 
  debug($entity->errors());

} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-04-17T20:31:16.597

总是让我明白的是，如果我修改了实际的表（通常是通过向它添加属性），那么你必须刷新你的缓存。通常只需删除以下两个文件夹中的所有内容对我来说就可以了：

```
tmp > cache > models 
tmp > cache > persistent 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-30T18:35:47.940

您使用的控制器名称是什么？

Mismatching the name of controller and model also cause some errors. If you are using Posts controller then the `Post` model should be used. If you are using `Post` model inside other controller; say `BlogsController` then the `Post` model should be loaded like following:

```
 <?php
    class BlogsController extends AppController
    {
        public function index()
        {
            $this->loadModel("Post");    
            //Here I'm loading other model inside blogs controller
            if($this->request->is('post'))
            {
                $this->Post->save($this->request->data);
            }
        }
    }
    ?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-24T16:54:27.387

It may be, Validations returns false.. You can check like

```
$this->Model->save($this->data, false); 
```

Put false and check whether now data inserts, if it is then it is validation error

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-09-27T07:58:41.817

may be something like this

```
$this->Model->set($this->data);

$errors = $this->Model->validate();// or perhaps validationError(), please confirm

if(!$errors) {
   $this->Model->save();
}else{
   //show errors
   pr($errors);

} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-08-15T18:40:16.773

Same problem here. I wasted 2 hours of my life.

Solution: I forget to this:

```
array('post', 'put') 
```

# c# - C#：动态转换类型

> ID：566510
> 
> 赞同：6
> 
> 时间：2009-02-19T18:17:58.783
> 
> 标签：c#, dynamic-cast

我目前有这种类型的代码：

```
private void FillObject(Object MainObject, Foo Arg1, Bar Arg2)
{
    if (MainObject is SomeClassType1)
    {
        SomeClassType1 HelpObject = (SomeClassType1)MainObject;
        HelpObject.Property1 = Arg1;
        HelpObject.Property2 = Arg2;
    }
    else if (MainObject is SomeClassType2)
    {
        SomeClassType2 HelpObject = (SomeClassType2)MainObject;
        HelpObject.Property1 = Arg1;
        HelpObject.Property2 = Arg2;
    }
} 
```

假设 SomeClassType1 和 SomeClassType2 具有我想要分配的相同属性集（尽管它们在其他属性中可能不同），是否可以将 MainObject 动态转换为适当的类型，然后分配值，而无需复制代码？这就是我最终希望看到的：

```
private void FillObject(Object MainObject, Foo Arg1, Bar Arg2)
{
    Type DynamicType = null;

    if (MainObject is SomeClassType1)
    {
        DynamicType = typeof(SomeClassType1);
    }
    else if (MainObject is SomeClassType2)
    {
        DynamicType = typeof(SomeClassType2);
    }

    DynamicType HelpObject = (DynamicType)MainObject;
    HelpObject.Property1 = Arg1;
    HelpObject.Property2 = Arg2;
} 
```

显然 C# 抱怨找不到 DynamicType：

> 找不到类型或命名空间名称“DynamicType”（您是否缺少 using 指令或程序集引用？）

在 C# 2.0 中这样的事情可能吗？如果它比我当前的代码更混乱，那么我认为这样做没有任何意义，但我很想知道。谢谢！

编辑：澄清一下，我完全理解实现接口是最合适且可能正确的解决方案。也就是说，我更感兴趣的是如何在不实现接口的情况下做到这一点。感谢您的精彩回复！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-19T18:23:40.823

看起来您关心的两种类型都实现了相同的两个属性。在这种情况下，您要做的是为这些属性定义一个接口：

```
public interface IMyInterface
{
   public Foo Property1 {get; set;}
   public Bar Property2 {get;set;}
} 
```

然后，确保您的每个类都告诉编译器它们实现了该新接口。最后，使用带有类型参数的泛型方法，该类型参数受该接口约束：

```
private void FillObject<T>(T MainObject, Foo Arg1, Bar Arg2) 
    where T : IMyInterface
{
    MainObject.Property1 = Arg1;
    MainObject.Property2 = Arg2;
} 
```

请注意，即使使用额外的代码来声明接口，这些代码段仍然比您在问题中发布的任何一个代码段都要短，并且如果您关心的类型数量增加，则此代码更容易扩展。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-19T18:21:16.113

本质上，您在这里所做的是根据对象的类型编写一个 switch 语句。除了您的第一个示例（充其量是乏味的）之外，没有天生的好方法可以做到这一点。

我编写了一个用于切换类型的小框架，使语法更加简洁。它允许您编写如下代码。

```
TypeSwitch.Do(
    sender,
    TypeSwitch.Case<Button>(
        () => textBox1.Text = "Hit a Button"),
    TypeSwitch.Case<CheckBox>(
        x => textBox1.Text = "Checkbox is " + x.Checked),
    TypeSwitch.Default(
        () => textBox1.Text = "Not sure what is hovered over")); 
```

博文：http: [//blogs.msdn.com/jaredpar/archive/2008/05/16/switching-on-types.aspx](http://blogs.msdn.com/jaredpar/archive/2008/05/16/switching-on-types.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-19T18:22:45.270

您能否对 SomeClassType1、SomeClassType2 等进行更改？如果是，那么我建议您创建一个包含常用属性的接口，然后将类型转换为该接口`FillObject()`以设置属性。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SO566510
{
    interface IMyProperties
    {
        int Property1 { get; set; }
        int Property2 { get; set; }
    }

    class SomeClassType1 : IMyProperties
    {
        public int Property1 { get; set; }
        public int Property2 { get; set; }
    }

    class SomeClassType2 : IMyProperties
    {
        public int Property1 { get; set; }
        public int Property2 { get; set; }
    }
    class Program
    {
        static void Main(string[] args)
        {
            var obj1 = new SomeClassType1();
            var obj2 = new SomeClassType2();

            FillObject(obj1, 10, 20);
            FillObject(obj2, 30, 40);

        }

        private static void FillObject(IMyProperties objWithMyProperties
                                   , int arg1, int arg2)
        {
            objWithMyProperties.Property1 = arg1;
            objWithMyProperties.Property2 = arg2;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-19T18:22:31.977

```
private void FillObject(Object MainObject, Foo Arg1, Bar Arg2)
{
    Type t = MainObject.GetType();

    t.GetProperty("Property1").SetValue(MainObject, Arg1, null);
    t.GetProperty("Property2").SetValue(MainObject, Arg2, null);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-19T18:24:10.917

一些想法：

1.  让两种类型都继承自具有共同属性的同一类型
2.  让这两种类型实现具有共同属性的相同接口
3.  使用反射来设置属性而不是直接设置它们（这可能比它的价值更难看）
4.  使用新的[*动态*功能](http://blogs.msdn.com/samng/archive/2008/10/29/dynamic-in-c.aspx)，我没有尝试过，但看起来它可能会解决你的问题

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-19T18:21:20.857

而不是尝试投射，也许您可​​以尝试使用反射设置属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-31T20:35:41.427

我在 ASP.NET MVC 应用程序中使用反射动态转换对象。基本上我枚举一个类的属性，在数据存储中找到相应的值并动态转换该值并将其分配给对象实例。请参阅我的博客文章 [Dynamic Casting with .NET](http://www.codecapers.com/post/Dynamic-Casting-with-NET.aspx)

# asp.net - 为什么我的 Web 应用程序出现延迟？

> ID：566513
> 
> 赞同：4
> 
> 时间：2009-02-19T18:18:17.253
> 
> 标签：asp.net, iis, iis-6, delay

我们有一个 ASP.Net 应用程序，它在 IIS6 下表现异常。该应用程序本身是简单的 ASP.Net 2.0 Webforms 交易，没有什么太奇怪的事情发生（管道中有几个 HTTP 模块，但我不会认为那些奇怪的 :) ）。我不明白的是页面执行时间，或者更具体地说，是 ASP.Net 跟踪 (trace.axd) 报告的时间与客户端 (Fiddler) 观察到的时间之间的差异。当应用在开发者的盒子（WinXP、IIS5.1）上运行时，ASP.Net和Fiddler报告的时间非常接近：

```
页面执行时间：0.0919834
Fiddler 总序列时间：0.1560980
```

我可以理解花费 60 毫秒将 5KB 的数据从 IIS 传输到 Fiddler（两者都在同一台机器上运行，顺便说一句）。现在，当我们将代码移动到服务器（Win2k3、IIS6）时，画面发生了巨大的变化：

```
页面执行时间：0.1702014
Fiddler 总序列时间：0.5156283
```

这是同一页面，Fiddler 再次与代码在同一台机器上运行。为什么传送相同的 5KB 突然需要 350 毫秒？

PS。在两台机器上，结果都是通过通过实际机器的主机名访问 URL 获得的，例如[http://machinename/app/page.aspx](http://machinename/app/page.aspx)（与[http://localhost/app/page.aspx](http://localhost/app/page.aspx)相对）。

聚苯乙烯。配置方面，开发盒和服务器的设置尽可能接近——两者都使用完全相同的 web.config。两者都使用集成的身份验证访问数据库（sql server），因此，应用程序在域帐户下运行。该应用程序使用表单身份验证，并且不会模拟（即它始终在同一帐户下运行）。现在，它在 IIS5 上的工作方式与 IIS6 不同——在 IIS5 上，帐户在 machine.config 的标记中指定，而在 IIS6 上，它是 AppPool 设置。两种环境的设置似乎都很典型，我无法想象它会导致 350 毫秒的延迟......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T00:09:19.977

在花费了我们通过 MSDN 订阅获得的宝贵的少数支持事件之一之后，我终于知道了“所有这些时间都花在了哪里”问题的正确答案。简而言之，时间花在了我们管道中的 HTTP 模块上。ASP.Net trace.axd 报告的时间测量仅记录在 .aspx 页面本身所花费的时间，**不**包括模块。

确定这一点的一种简单方法（并查看每个模块完成其工作需要多长时间）是使用 ETW（Windows 事件跟踪）。这是[解释](http://blogs.msdn.com/sudeepg/archive/2009/02/25/capturing-and-analyzing-an-etw-trace-event-tracing-for-windows.aspx) （我强烈怀疑这篇文章是在他们查看了我们的案例之后写的:)）我可以添加到上面出色描述中的一件事是我使用[SvcTraceViewer](http://msdn.microsoft.com/en-us/library/ms732023.aspx)而不是 LogParser 来分析跟踪输出。

更新：上述方法也适用于 Windows Server 2008，只需确保您已 [安装 Tracing](http://learn.iis.net/page.aspx/266/troubleshooting-failed-requests-using-tracing-in-iis-70/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T18:24:00.277

在您调用的 URL 上执行跟踪路由并比较它们。我打赌开发机器你留在机器内部，但在生产机器上你要去外部，然后通过 IP 地址返回。

如果是这种情况，请尝试将其添加到您的主机文件（c:\windows\system32\drivers\etc\hosts

```
www.mysite.com    127.0.0.1 
```

这将确保您的请求不会冒险在机器之外发出请求。您应该看到响应时间开始彼此一致。

**更新**

鉴于新的更新。如果服务器负载不足，则在生产测试时这可能会导致差异，因为它正在积极尝试交付比仅尝试交付 1 的开发机器更多的请求。

或者可能是因为您正在测试两个不同版本的 IIS，XP 上的 5.1 和 2003 上的 6.0。除非两个环境运行相同的软件，否则真的无法解释差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:04:16.183

应用程序是否在两个盒子上以相同的发布配置运行？

编辑：请求管道在 IIS5 和 IIS6 之间发生了巨大变化，trace.axd 只会看到它的 ASP.NET 部分，而不是新的应用程序池和 HTTP.Sys 组件。

我想在 IIS6 上可以稍微调整配置，但您可能正在查看轻量级非生产网络服务器 (IIS5) 和具有单独应用程序池管理和更多抽象层的强大网络服务器的区别。

# windows - 用于从文件放置打印和存档的 Windows 实用程序

> ID：566524
> 
> 赞同：2
> 
> 时间：2009-02-19T18:19:55.990
> 
> 标签：windows, queue, printing

现在，我可以继续使用`FileSystemWatcher`etc 编写此代码，但在开始编码之前 - 我想知道是否有更好的选择可以重复使用（而不是重新发明）。

从我的网络服务器，我想将文件（要打印）作为队列放入网络共享中（排序不是很重要）。理想情况下，另一台机器上的 Windows 服务（或其他客户端）会选择该文件（格式为 tbc），将其打印到预先安排的打印队列中，然后存档该文件。

非常简单的场景 - 我只是不想重新发明它。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T18:44:45.300

试用[Batch & Print Pro](http://www.traction-software.co.uk/batchprint/)。它具有目录监控、打印调度等功能以及命令行选项。您可以将其作为服务运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T18:23:40.900

我似乎记得 BizTalk 服务器有某种文件删除活动。如果您可以挂钩处理传入“消息”的部分（由文件删除表示，并且我相信 BizTalk 允许挂钩到此过程），那么您应该能够在 BizTalk 中以您希望的任何方式处理它。

您还可以获得能够更好地隔离在文件上执行的活动的优势。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T18:25:06.547

你提到的只是它是如何完成的。至少我们是这样做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T18:44:27.997

您可以使用发送至，而不是插入式文件夹。

这是 2 行 VBS 解决方案：

1.  创建一个 VBScript 文件，该文件获取一个文件并存档并打印它。
    1.  存档很容易，只需执行命令行 zip 或其他操作。
    2.  打印更简​​单，在做vb的Exec的时候用“打印”动词
2.  在您机器上的 Send To 文件夹中创建所述 VBS 文件的快捷方式，并且 Bob 是您父亲的兄弟：现在您可以右键单击任何文件并将其发送到 Print/Archive。

我知道这不是您所要求的，但放置文件夹的方法对我来说似乎和这个一样好，所以我把它放在那里。:)

# arrays - 查找两个数组之间差异的算法

> ID：566539
> 
> 赞同：3
> 
> 时间：2009-02-19T18:23:13.117
> 
> 标签：arrays, c#-2.0

给定两个数组，是否有一种快速算法可以找到两个数组中所有不同的元素？例如，考虑两个 Keys 数组（如键盘键）结构。一个代表当前按下的按键，另一个代表上一个时间步长按下的按键。

```
Keys[] oldKeys = LastKeyboardState.GetPressedKeys();
Keys[] currKeys = CurrentKeyboardState.GetPressedKeys();

// the user just pressed these key(s) during the last timestep.
Keys[] diff = ... 
```

非常感谢您的建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-19T18:36:24.697

好吧，蛮力算法将是 m*n ，其中 m 和 n 是两个数组的大小。

如果您使用任何类型的树而不是线性数组，那么您的时间将下降到 m * log2(n)

算法是

```
foreach(key ok in oldkeys)
{
    if(!oldKeys.Contains(ok))
    {
        diff.add(ok);
    }
}
foreach(key nk in newkeys)
{
    if(!newKeys.Contains(nk))
    {
        diff.add(nk);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T18:26:16.827

试试这个

```
var diff = oldKeys.Except(currKeys); 
```

这需要 C# 3.0

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T18:35:43.933

跟进 JaredPar：这将只显示 oldKeys 中的键，而不显示 currKeys 中的键。因此，如果 A 在 currKeys 中但不在 oldKeys 中，它将不会出现在 diff 中。

> ```
> var diff = oldKeys.Union(currKeys).Except(currKeys.Intersect(oldKeys)) 
> ```

也会得到那些。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T18:27:19.743

两个位域，运行二进制 XOR。剩下的 1 就是你想要的。

# latex - 对齐文本中的标题参差不齐

> ID：566551
> 
> 赞同：3
> 
> 时间：2009-02-19T18:26:28.917
> 
> 标签：latex, pdflatex

我正在通过 pdflatex 创建一个带有 Latex 的 pdf 文件，并且希望有带有参差不齐的文本的标题，而文档的其余部分应该使用对齐的文本。

这给了我一个错误（！`LaTeX Error: Something's wrong--perhaps a missing \item`）：

```
\usepackage{ragged2e}

..

\flushleft
\chapter{Something}
\justifying 
```

而这个弄乱了垂直间距：

```
{\raggedright{\chapter{Something}}} 
```

这里有什么想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T18:37:43.870

使用 sectsty 包并使用`\chapterfont{\raggedright}`使所有章节标题左对齐。请参阅[sectsty 手册](http://tug.ctan.org/tex-archive/macros/latex/contrib/sectsty/sectsty.pdf)了解如何做更多有趣的事情。如果 sectsty 不够强大，可以使用[titlesec 。](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=titlesec)除此之外，您可以重新定义切片命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T18:34:45.993

`\chapter`,`\section`等等在标准类中可能有相当复杂的定义，有时会与以这种方式强制其格式化的尝试产生不良交互。

阅读标准类的描述，找出你可以使用哪些变量来影响标题的外观。

你最好的选择可能是在[CTAN](http://www.ctan.org/)[`memoir`](http://www.ctan.org/tex-archive/macros/latex/contrib/memoir/)上寻找一个支持你想要的开箱即用的替代类（也许）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T00:47:44.277

请注意，您在正确的轨道上加载`ragged2e`和使用`\RaggedRight`命令而不是 LaTeX 的默认 \raggedright。它有时会提供更好的输出，尽管它确实会连字；取决于您可能接受或不接受的标题设计。

无论哪种方式，请使用@sgm 的使用 titlesec 的答案。（它和 sectsty 一样易于使用，而且功能更强大……sectsty 仅适用于非常基本的重新定义，例如更改字体。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T01:07:46.180

大约三年前，我厌倦了各种各样的包裹在脚上互相射击，并且每个包裹都需要以自己特殊的方式进行调整，我把所有的东西都换成了[回忆录](http://www.ctan.org/tex-archive/macros/latex/contrib/memoir/)。

我从未回头。

# python - 我怎样才能使这个单行在 DOS 中工作？

> ID：566559
> 
> 赞同：5
> 
> 时间：2009-02-19T18:29:30.477
> 
> 标签：python, command-line

```
python -c "for x in range(1,10) print x" 
```

我喜欢带有-c 的python one liner，但是当需要缩进时它是有限的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-19T18:31:50.223

```
python -c "for x in range(1,10): print x" 
```

只需添加冒号。

要解决评论中的问题：

> 我怎样才能使这项工作呢？python -c "导入日历；打印 calendar.prcal(2009)；对于范围内的 x(1,10)：打印 x"

```
python -c "for x in range(1,10): x==1 and __import__('calendar').prcal(2009); print x;" 
```

正如你所看到的，它非常恶心。我们不能在循环之前导入。为了解决这个问题，我们检查 x 是否在循环的第一次迭代中，如果是，我们进行导入。

更多示例[在这里](https://web.archive.org/web/20071223101511/http://mail.python.org/pipermail/python-list/2003-April/199822.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T18:32:18.913

不是 python 脚本，但可能会有所帮助：

```
for /L %i in (1, 1, 10) do echo %i 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T18:33:36.540

```
python -c "for x in range(1,10): print x" 
```

记住“：”！！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T18:32:53.953

你不就是想要这个吗？

python -c “for x in range(1,10): print x”</p>

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-19T18:48:50.083

这是一个不需要在冒号后放置语句的解决方案，这被认为不是很高。

```
python2 -c "print '\n'.join([str(x) for x in range(1,10)])" 
```

有什么比列表推导更 Pythonic 的！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T19:04:24.360

```
python -c 'print "\n".join(map(str, range(1,10)))' 
```

但是“真正的”python 脚本有什么问题？（你知道，通过“python foo.py”启动的 foo.py）如果你真的喜欢单线，我建议 perl :)

# reporting-services - 将对象用作远程 SQL Server Reporting Services 报表的数据源

> ID：566561
> 
> 赞同：2
> 
> 时间：2009-02-19T18:31:23.733
> 
> 标签：reporting-services, ssrs-2008

是否可以将对象用作远程 SSRS 报告的数据源？我知道可以在应用程序中本地使用对象。我想将业务对象用作在 SSRS 服务器上运行的报告的数据源。过去，我创建了与业务对象返回相同信息的存储过程。这是多余的，因此希望找到更好的方法。

如果我将我的业务对象公开为 Web 服务，它会起作用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T18:57:00.607

根据我的经验，这不能用 SSRS 报告来完成，至少不容易和明智地做到这一点。您可以添加自定义程序集来增强您可以使用代码表达式执行的操作，但我怀疑您在尝试通过表达式将 SSRS 控件绑定到对象时会获得很多投资回报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T06:31:25.317

在将报告服务集成到更大的应用程序中时，我以不太理想的方式做了类似的事情。因为我需要针对具有相同架构的不同数据库运行报告，具体取决于它们来自的客户端数据库，所以我使用自定义身份验证提供程序让我的报告服务代码在第一次为该客户端请求时为该客户端用户部署一个新报告。（rdl 文件存储在我的客户端数据库中，并在登录时部署它们，并且我在第一次为该客户端部署时以编程方式更改数据源）。

这个解决方案很适合我的情况，但它相当复杂，可能不完全是你想要的。如果可以，[http://www.gotreportviewer.com/](http://www.gotreportviewer.com/)可能会满足您的需求。

# c# - 我的简单查询有什么问题？

> ID：566562
> 
> 赞同：0
> 
> 时间：2009-02-19T18:31:41.817
> 
> 标签：c#, linq-to-xml

我是 Linq to Xml 的新手。我有一个非常简单的 xml 文件，如下所示：

```
<Items>
    <Item>
       <Stuff>Strings</Stuff>
    </Item>
    <Item>
       <Stuff>Strings</Stuff>
    </Item>
</Items> 
```

我正在尝试像这样查询它：

```
XDocument doc = XDocument.Load(myStream)
from node in doc.Descendants(XName.Get("Item"))
    select new { Stuff = node.Element(XName.Get("Stuff")).Value } 
```

但是 doc.Descendents(XName.Get("Item")) 返回 null。我在这里的理解有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:39:20.950

您的代码实际上有效：

```
static void Main(string[] args)
{
    string xml = @"
                <Items>
                    <Item>
                        <Stuff>Strings</Stuff>
                    </Item>
                    <Item>
                        <Stuff>Strings</Stuff>
                    </Item>
                </Items>";

    using (StringReader myStream = new StringReader(xml))
    {
        XDocument doc = XDocument.Load(myStream);

        var query = from node in doc.Descendants(XName.Get("Item"))
                    select new { Stuff = 
                        node.Element(XName.Get("Stuff")).Value };

        foreach (var item in query)
        {
            Console.WriteLine("Stuff: {0}", item.Stuff);
        }
    } 
```

应该注意的是，如果元素没有使用命名空间限定，那么您实际上并不需要 XName：

```
static void Main(string[] args)
{
    string xml = @"
                <Items>
                    <Item>
                        <Stuff>Strings</Stuff>
                    </Item>
                    <Item>
                        <Stuff>Strings</Stuff>
                    </Item>
                </Items>";

    using (StringReader myStream = new StringReader(xml))
    {
        XDocument doc = XDocument.Load(myStream);

        var query = from node in doc.Descendants("Item")
                    select new { Stuff = node.Element("Stuff").Value };

        foreach (var item in query)
        {
            Console.WriteLine("Stuff: {0}", item.Stuff);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T18:37:30.080

尝试使用 doc.Root.Decendants("Item")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T18:37:49.813

有一个从 System.String 到 XName 的隐式转换，所以更常用的形式是

```
...doc.Descendants("Item") 
```

和

```
...node.Element("Stuff").Value 
```

除此之外，我建议 doc.Root.Descendants() 就像前面的答案一样。加载时，文档仍位于层次结构的“顶部”。我的印象是 Descendants() 是递归的，但谁知道呢，对吧？

# javascript - Math.round(num) vs num.toFixed(0) 和浏览器不一致

> ID：566564
> 
> 赞同：64
> 
> 时间：2009-02-19T18:31:57.260
> 
> 标签：javascript, cross-browser

考虑以下代码：

```
for (var i=0;i<3;i++){
   var num = i + 0.50;
   var output = num + " " + Math.round(num) + " " + num.toFixed(0);
   alert(output);
} 
```

在 Opera 9.63 中，我得到：

> 0.5 1 **0**
> 
> 1.5 2 2
> 
> 2.5 3 **2**

在 FF 3.03 中，我得到：

> 0.5 1 **1**
> 
> 1.5 2 2
> 
> 2.5 3 **3**

在 IE 7 中，我得到：

> 0.5 1 **0**
> 
> 1.5 2 2
> 
> 2.5 3 **3**

注意加粗的结果。为什么会出现这种不一致？这是否意味着`toFixed(0)`应该避免？将数字四舍五入到最接近的整数的正确方法是什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-19T18:44:34.190

编辑：要回答您的编辑，请使用`Math.round`. `Number`如果您更喜欢该语法，您还可以对对象进行原型设计，让它按照您的意愿行事。

```
Number.prototype.round = function() {
  return Math.round(this);
}
var num = 3.5;
alert(num.round()) 
```

我以前从未使用`Number.toFixed()`过（主要是因为大多数 JS 库都提供了一种[`toInt()`](http://mootools.net/docs/Native/Number#Number:toInt)方法），但是从您的结果来看，我会说使用`Math`方法（`round`, `floor`, `ceil`）会更加一致，那么`toFixed`如果您正在寻找跨浏览器一致性.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-12-04T16:51:25.173

要解决您的两个*原始*问题/问题：

## Math.round(num) 与 num.toFixed(0)

这里的问题在于错误地认为这些应该总是给出相同的结果。实际上，它们受不同规则的约束。例如，查看负数。因为[`Math.round`](http://www.ecma-international.org/ecma-262/5.1/#sec-15.8.2.15)使用[“四舍五入”](http://en.wikipedia.org/wiki/Rounding#Round_half_up)作为规则，您会看到即使`Math.round(-1.5)`评估为 ，也会评估为。`-1``Math.round(1.5)``2`

`Number.prototype.toFixed`，另一方面，根据[规范的第 6 步，使用基本上相当于](http://www.ecma-international.org/ecma-262/5.1/#sec-15.7.4.5)[“离零的一半”](http://en.wikipedia.org/wiki/Rounding#Round_half_away_from_zero)的规则，它基本上说将负数视为正数，然后在结尾。因此，并且是所有符合规范的浏览器中的真实陈述。请注意，这些值是字符串，而不是数字。进一步注意，由于运算符优先级，两者和都是（数字）。`(-1.5).toFixed(0) === "-2"``(1.5).toFixed(0) === "2"``-1.5.toFixed(0)``-(1.5).toFixed(0)``=== -2`

## 浏览器不一致

大多数现代浏览器——<strike>或者至少是你在撰写本文时可能期望支持的那些，**[除了](https://stackoverflow.com/a/19169968/357774)**IE——都应该正确地实现规范。（根据[Renee 的评论](https://stackoverflow.com/questions/566564/javascript-functions-math-roundnum-vs-num-tofixed0-and-browser-inconsistenci#comment2034745_566564)，`toFixed`您在 Opera 中指出的问题已得到修复，大概是因为他们开始使用与 Chrome 相同的 JS 引擎。）仍然值得重申的是，即使规范在所有浏览器中实现一致，定义的行为在规范中，特别是对于`toFixed`舍入，对于期望真正的数学准确性的“普通”JS 开发人员来说仍然有点不直观——参见[Javascript toFixed Not Rounding](https://stackoverflow.com/q/10015027)和这个在 V8 JS 引擎上提交的[“按预期工作”错误](https://bugs.chromium.org/p/v8/issues/detail?id=522)示例.

## 结论

简而言之，这是两个不同的函数，具有两种不同的返回类型和两组不同的舍入规则。

正如其他人所建议的那样，我还想说“使用适合您特定用例的任何功能”（特别注意注意 的特性`toFixed`，尤其是 IE 的错误实现）。~~正如其他人所提到~~~~的，我个人更倾向于推荐 , 的一些明确组合。`Math.round/ceil/floor`~~ *编辑：* ......虽然，在回过头来阅读你的说明之后，你的用例（四舍五入到整数）肯定需要恰当命名的`Math.round`函数。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-19T19:28:02.000

我认为 FF 使用 toFixed 做的事情是正确的，因为下面的第 10 步说“如果有两个这样的 n，请选择较大的 n。”

正如[格兰特瓦格纳](https://stackoverflow.com/users/9254/)所说：使用*Math.ceil(x)*或*Math.floor(x)*而不是*x.toFixed()*。

以下所有内容均来自[ECMAScript 语言规范](http://www.ecma-international.org/publications/standards/Ecma-262.htm)：

> ## 15.7.4.5`Number.prototype.toFixed (fractionDigits)`
> 
> 返回一个字符串，其中包含以定点表示法表示的`fractionDigits`数字，小数点后有数字。如果 `fractionDigits`未定义，`0`则假定为。具体来说，执行以下步骤：
> 
> 1.  让。`f`_ `ToInteger(fractionDigits)`（如果`fractionDigits`未定义，则此步骤产生值`0`）。
> 2.  如果`f < 0`或`f > 20`，则抛出`RangeError`异常。
> 3.  设为`x`这个数值。
> 4.  如果`x`是`NaN`，则返回字符串`"NaN"`。
> 5.  设为`s`空字符串。
> 6.  如果`x ≥ 0`，请转到步骤 9。
> 7.  让我们成为`"-"`。
> 8.  让`x = –x`.
> 9.  如果`x ≥ 10^21`，放开`m = ToString(x)`并转到第 20 步。
> 10.  让`n`是一个整数，其精确的数学值 `n ÷ 10^f – x`尽可能接近于零。如果有两个这样`n`的，选择较大的`n`。
> 11.  如果`n = 0`，让`m`是字符串`"0"`。否则，让`m`是由十进制表示的数字组成的字符串`n`（按顺序，没有前导零）。
> 12.  如果`f = 0`，则转到步骤 20。
> 13.  设`k`为 中的字符数`m`。
> 14.  如果`k > f`，请转到步骤 18。
> 15.  让是由出现的字符`z`组成的字符串。`f+1–k``'0'`
> 16.  让`m`是字符串`z`和的串联`m`。
> 17.  让`k = f + 1`.
> 18.  让`a`是 的第一个`k–f`字符`m`， 让`b`是 的其余`f`字符`m`。
> 19.  让`m`是三个字符串`a`、`"."`和的串联`b`。
> 20.  返回字符串`s`和的串联`m`。
> 
> 该方法的`length`属性`toFixed`是`1`。
> 
> 如果`toFixed`使用多个参数调用该方法，则行为未定义（参见第 15 节）。
> 
> 对于小于或大于`toFixed`的值，允许实现扩展 的行为。在这种情况下 ，不一定会抛出这样的值。`fractionDigits``0``20``toFixed``RangeError`
> 
> **注意**的输出`toFixed`可能比`toString`某些值更精确，因为`toString`只打印足够的有效数字来区分数字和相邻的数值。例如， `(1000000000000000128).toString()`返回`"1000000000000000100"`，而 `(1000000000000000128).toFixed(0)`返回`"1000000000000000128"`。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-01-24T04:09:59.877

**toFixed()**返回一个字符串值。来自 Javascript：权威指南

> 将数字转换为小数点后包含指定位数的字符串。

**Math.round()**返回一个整数。

显然， toFixed() 似乎更适合金钱，例如，

> '$' + 12.34253.toFixed(2) = '$12.34'

很遗憾**toFixed()**似乎没有正确舍入！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-19T18:44:40.900

而不是`toFixed(0)`使用`Math.ceil()`or `Math.floor()`，这取决于需要什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T18:44:51.773

如果您得到的答案不一致，那肯定是这样。

我只能猜测您使用 toFixed(0) 的目的是将十进制数转换为整数，此时我推荐 Math.floor()。[在这个问题](https://stackoverflow.com/questions/131406/what-is-the-best-method-to-convert-to-an-integer-in-javascript "这个问题")中有更多关于这样做的最佳方法的讨论。

# c++ - 检查 Internet Explorer 保护模式

> ID：566567
> 
> 赞同：2
> 
> 时间：2009-02-19T18:32:08.990
> 
> 标签：c++, winapi, windows-vista

我有几个问题： 1) 据我所知，IE 扩展中使用的函数 IEIsProtectedModeProcess 有没有办法以编程方式知道 Internet Explorer 是否在 IE 之外以保护模式运行？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T20:42:20.903

这是一个尝试解决的有趣问题。我提到了Microsoft Press[的为 Windows Vista 编写安全代码。](https://rads.stackoverflow.com/amzn/click/com/0735623937)

本质上，当 IE 处于保护模式时，它运行在“低”完整性级别。如果完整性级别大于低（例如中或高），则 IE 进程未在保护模式下运行。Vista 上进程的默认完整性级别为“中”。这里有一些代码可以让您在给定进程的 pid 或进程句柄的情况下获得进程的完整性级别。如果您有 IWebBrowser2，则可以使用[GetWindowThreadProcessId](http://msdn.microsoft.com/en-us/library/ms633522(VS.85).aspx)从 HWND 获取 pid 。

```
DWORD GetProcessIntegrityLevel(HANDLE hProcess,
                                 wchar_t __out_ecount_z(cbIl) *wszIl,
                                 size_t cbIl) 
{
    if (!wszIl) return 0xffffffff;
    memset(wszIl,0,cbIl);
    DWORD err = 0;
    try {
        HANDLE hToken = NULL;
        if (!OpenProcessToken(hProcess, TOKEN_QUERY, &hToken))
            throw GetLastError();

        DWORD cbBuf = 0;
        if (GetTokenInformation(hToken,TokenIntegrityLevel,NULL,0,&cbBuf) != 0)
            throw GetLastError();
        TOKEN_MANDATORY_LABEL * pTml =
            reinterpret_cast<TOKEN_MANDATORY_LABEL*> (new char[cbBuf]);
        if (pTml &&
            GetTokenInformation(
            hToken,
            TokenIntegrityLevel,
            pTml,
            cbBuf,
            &cbBuf)) {
                CloseHandle(hToken);
                hToken = NULL;
                DWORD ridIl = *GetSidSubAuthority(pTml->Label.Sid, 0);
                if (ridIl < SECURITY_MANDATORY_LOW_RID)
                    wcscpy_s(wszIl,cbIl,L"?");
                else if (ridIl >= SECURITY_MANDATORY_LOW_RID &&
                    ridIl < SECURITY_MANDATORY_MEDIUM_RID)
                    wcscpy_s(wszIl,cbIl,L"Low");
                else if (ridIl >= SECURITY_MANDATORY_MEDIUM_RID &&
                    ridIl < SECURITY_MANDATORY_HIGH_RID)
                    wcscpy_s(wszIl,cbIl,L"Medium");
                else if (ridIl >= SECURITY_MANDATORY_HIGH_RID &&
                    ridIl < SECURITY_MANDATORY_SYSTEM_RID)
                    wcscpy_s(wszIl,cbIl,L"High");
                else if (ridIl >= SECURITY_MANDATORY_SYSTEM_RID)
                    wcscpy_s(wszIl,cbIl,L"System");
                if (ridIl > SECURITY_MANDATORY_LOW_RID &&
                    ridIl != SECURITY_MANDATORY_MEDIUM_RID &&
                    ridIl != SECURITY_MANDATORY_HIGH_RID &&
                    ridIl != SECURITY_MANDATORY_SYSTEM_RID)
                    wcscat_s(wszIl,cbIl,L"+");
                delete [] reinterpret_cast<char*>(pTml);
                pTml = NULL;
        } else {
            throw GetLastError();
        }
    } catch(DWORD dwErr) {
        err = dwErr;
        wprintf(L"Error %d",GetLastError());
    } catch(std::bad_alloc e) {
        err = ERROR_OUTOFMEMORY;
        wprintf(L"Error %d",err);
    }
    return err;
}

DWORD GetProcessIntegrityLevel(long pid,
                               wchar_t __out_ecount_z(cbIl) *wszIl,
                               size_t cbIl) 
{
    HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);
    if (hProcess != NULL)
        return GetProcessIntegrityLevel(hProcess, wszIl, cbIl);
    else 
        return -1;
}

DWORD GetProcessIntegrityLevel(wchar_t __out_ecount_z(cbIl) *wszIl,
                               size_t cbIl) 
{
    HANDLE currentProcess = GetCurrentProcess();
    return GetProcessIntegrityLevel(currentProcess, wszIl, cbIl);
} 
```

# c# - 如何使用 c# 以编程方式将证书安装到本地机器存储中？

> ID：566570
> 
> 赞同：58
> 
> 时间：2009-02-19T18:32:42.813
> 
> 标签：c#, .net, wcf, certificate, makecert

我有一个通过 MakeCert 生成的证书。我想使用 PeerTrust 将此证书用于 WCF 消息安全性。如何使用 c# 或 .NET 以编程方式将证书安装到“受信任的人”本地计算机证书存储中？

我有一个 CER 文件，但也可以创建一个 PFX。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-19T20:42:28.997

我相信这是正确的：

```
using (X509Store store = new X509Store(StoreName.TrustedPeople, StoreLocation.LocalMachine)) 
{
   store.Open(OpenFlags.ReadWrite);
   store.Add(cert); //where cert is an X509Certificate object
} 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-09-10T22:15:07.717

以下对我有用：

```
private static void InstallCertificate(string cerFileName)
{
    X509Certificate2 certificate = new X509Certificate2(cerFileName);
    X509Store store = new X509Store(StoreName.TrustedPublisher, StoreLocation.LocalMachine);

    store.Open(OpenFlags.ReadWrite);
    store.Add(certificate);
    store.Close();
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-13T08:56:14.497

您可以将证书添加到“CurrentUser”（对我有用），而不是将证书安装到需要提升权限的 LocalMachine。

```
X509Store store = new X509Store(StoreName.TrustedPeople, StoreLocation.CurrentUser);
store.Open(OpenFlags.ReadWrite);
store.Add(cert); //where cert is an X509Certificate object
store.Close(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-07-05T16:37:35.910

我不得不使用 X509KeyStorageFlags。**持久键集**| X509KeyStorageFlags。**MachineKeySet**标志以解决稍后在尝试使用证书时发生的*“密钥集不存在”错误：*

```
X509Certificate2 certificate = new X509Certificate2(pfxPath, password, X509KeyStorageFlags.PersistKeySet | X509KeyStorageFlags.MachineKeySet);
using (X509Store store = new X509Store(StoreName.My, StoreLocation.LocalMachine))
{
     store.Open(OpenFlags.ReadWrite);
     store.Add(certificate);
     store.Close();
} 
```

感谢这篇文章：[证书存储中证书的私钥不可读](https://stackoverflow.com/questions/13231858/private-key-of-certificate-in-certificate-store-not-readable)

# python - 建立一个没有重叠的“完整”数字范围

> ID：566574
> 
> 赞同：0
> 
> 时间：2009-02-19T18:33:44.497
> 
> 标签：python, range, numbers, overlap

给定一系列数字，我需要构建一个完整的“数字范围”集。我从一个列表开始，例如：

```
ID   START  
*    0  
a    4  
b    70  
c    700  
d    701  
e    85 
```

*   其中“def”是默认范围&应该“填补”空白
*   “重叠”是起始数据中的值（70、700、701）

并需要以下结果：

```
ID  START  END  
*     0 - 39  
a     4 - 49  
*     5 - 69  
c   700 - 7009  
d   701 - 7019  
b   702 - 709  
*    71 - 849  
e    85 - 859  
*    86 - 9 
```

我想弄清楚的是是否有某种算法或设计模式来解决这个问题。我有一些想法，但我想我会先由“专家”来运行它。我正在使用 Python。

任何想法/方向将不胜感激。我有一些初步的想法：

*   建立一个“范围”列表，将开始和结束值填充到全长。所以默认是 0000 到 9999
*   构建动态构建的“拆分”列表
*   循环遍历“范围”列表，将每个值与拆分列表中的值进行比较。
*   如果发现重叠，请删除拆分列表中的值并添加新范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T19:05:03.313

```
import operator

ranges = {
    '4'  : 'a',
    '70' : 'b',
    '700': 'c',
    '701': 'd',
    '85' : 'e',
    '87' : 'a',
}

def id_for_value(value):
    possible = '*'
    for idvalue, id in sorted(ranges.iteritems()):
        if value.startswith(idvalue):
            possible = id
        elif idvalue > value:
            break
    return possible 
```

知道某个值的id就足够了。测试：

```
assert id_for_value('10') == '*'
assert id_for_value('499') == 'a'
assert id_for_value('703') == 'b'
assert id_for_value('7007') == 'c'
assert id_for_value('7017') == 'd'
assert id_for_value('76') == id_for_value('83') == '*'
assert id_for_value('857') == 'e'
assert id_for_value('8716') == 'a' 
```

如果你真的想要范围，你可以使用 itertools.groupby 来计算它：

```
def firstlast(iterator):
    """ Returns the first and last value of an iterator"""
    first = last = iterator.next()
    for value in iterator:
        last = value
    return first, last

maxlen = max(len(x) for x in ranges) + 1
test_range = ('%0*d' % (maxlen, i) for i in xrange(10 ** maxlen))
result = dict((firstlast(gr), id) 
              for id, gr in itertools.groupby(test_range, key=id_for_value)) 
```

给出：

```
{('0000', '3999'): '*',
 ('4000', '4999'): 'a',
 ('5000', '6999'): '*',
 ('7000', '7009'): 'c',
 ('7010', '7019'): 'd',
 ('7020', '7099'): 'b',
 ('7100', '8499'): '*',
 ('8500', '8599'): 'e',
 ('8600', '8699'): '*',
 ('8700', '8799'): 'a',
 ('8800', '9999'): '*'} 
```

# c# - 在不影响数据源的情况下更新数据集

> ID：566576
> 
> 赞同：0
> 
> 时间：2009-02-19T18:34:32.000
> 
> 标签：c#, winforms

我想在不影响基础数据库的情况下向我的数据集添加一个新列。该新列将从我的 WinForm 更新。如何在不影响数据库的情况下对数据集进行更改（添加列、进行更新等）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T18:42:27.423

它们根本不影响底层数据源。DataSet 是您从基础数据源查询的数据的内存表示形式。*对数据集中数据*的任何更改都不会持久化回数据库，直到您将其传递给数据适配器以更新数据。

数据适配器无法更改数据集*结构*（或多或少的列、列类型等）的结构，因此您不必担心结构的更改，除非您正在更改列或类型的名称，在这种情况下，数据适配器可能无法将数据映射回数据源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T18:41:28.250

只要您的数据集没有通过数据适配器或数据源直接链接到您的数据库，您就应该能够对数据集（或数据表）执行任何操作，然后仅在您希望使用上述数据适配器或数据源时提交更改。

# php - Zend Frame Work 中使用 mysql_unbuffered_query 是否支持？

> ID：566578
> 
> 赞同：3
> 
> 时间：2009-02-19T18:35:07.523
> 
> 标签：php, mysql, zend-framework

我需要运行一个查询来检索大量记录。
这意味着我不能使用 mysqli 的 ZF 包装器，它在底层使用 mysqli-store-result。那么，ZF 中是否有使用 mysqli mysqli-use-result[链接文本](http://us3.php.net/mysqli_use_result "（描述）")的包装器，它将返回一个 Iterator/record-set/resource 而不是所有结果都已加载到内存中的数组，或者我需要自己实施？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T18:52:59.177

首先，没有 Zend Framework 数据库适配器使用[ext/mysql](http://php.net/manual/en/book.mysql.php)。[ext/mysqli](http://php.net/manual/en/book.mysqli.php)和[ext/pdo_mysql](http://us3.php.net/manual/en/ref.pdo-mysql.php)有适配器。

在 MySQLi 适配器中，它总是调用[`mysqli_store_result()`](http://php.net/manual/en/mysqli.store-result.php)（参见 Zend/Db/Statement/Mysqli.php，第 250 行附近），这意味着它只支持**缓冲**查询结果。Zend 框架目前不支持任何选项来更改它，因此您可以尝试自己编辑该行代码以使用`mysqli_use_result()`.

**编辑：**在 PDO_MySQL 适配器中，默认是使用**缓冲**查询。

PHP 5.4.6 源代码，文件 ext/pdo_mysql/mysql_driver.c，第 590 行，在函数 pdo_mysql_handle_factory() 中：

```
H->buffered = H->emulate_prepare = 1; 
```

请注意，无论使用无缓冲查询，如果您调用`fetchAll()`数据库包装类，您将获取庞大结果集的所有行，并且可能超过 PHP 的内存限制。因此，您必须开始一个查询并编写一个循环来一次获取一行。

# java - JMX 线程卡在 ClientNotifForwarder

> ID：566582
> 
> 赞同：3
> 
> 时间：2009-02-19T18:35:50.033
> 
> 标签：java, multithreading, jmx

我们的应用程序连接到几个 jmx 代理（大约 50 个）以频繁地轮询 jmx 数据。一段时间后（大约一天），应用程序变得无响应。我们查看了线程转储并看到大量线程卡在 ClientNotifForwarder..

例如：

```
"ClientNotifForwarder-50" daemon prio=3 tid=0x09aa3800 nid=0x330 runnable [0xd3a90000..0xd3a90c70]
java.lang.Thread.State: RUNNABLE
    at java.net.SocketInputStream.socketRead0(Native Method)
    at java.net.SocketInputStream.read(SocketInputStream.java:129)
    at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)
    at java.io.BufferedInputStream.read(BufferedInputStream.java:237)
    - locked <0xe2538af0> (a java.io.BufferedInputStream)
    at java.io.DataInputStream.readByte(DataInputStream.java:248)
    at sun.rmi.transport.StreamRemoteCall.executeCall(StreamRemoteCall.java:195)
    at sun.rmi.server.UnicastRef.invoke(UnicastRef.java:142)
    at com.sun.jmx.remote.internal.PRef.invoke(Unknown Source)
    at javax.management.remote.rmi.RMIConnectionImpl_Stub.fetchNotifications(Unknown Source)
    at javax.management.remote.rmi.RMIConnector$RMINotifClient.fetchNotifs(RMIConnector.java:1291)
    at com.sun.jmx.remote.internal.ClientNotifForwarder$NotifFetcher.fetchNotifs(ClientNotifForwarder.java:503)
    at com.sun.jmx.remote.internal.ClientNotifForwarder$NotifFetcher.run(ClientNotifForwarder.java:395)
    at com.sun.jmx.remote.internal.ClientNotifForwarder$LinearExecutor$1.run(ClientNotifForwarder.java:83) 
```

感谢您在确定根本原因方面的任何帮助......

谢谢，拉贾

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T19:12:41.473

尝试从命令行设置连接和读取超时属性。

```
sun.net.client.defaultConnectTimeout
sun.net.client.defaultReadTimeout 
```

[http://docs.oracle.com/javase/6/docs/technotes/guides/net/properties.html](http://docs.oracle.com/javase/6/docs/technotes/guides/net/properties.html)

假设您有足够的重审机制。

# c++ - 如何找到 USER 44 PANIC 的原因？

> ID：566587
> 
> 赞同：2
> 
> 时间：2009-02-19T18:36:56.053
> 
> 标签：c++, debugging, symbian, panic

我们开发的产品之一是用 C++ 和 Symbian 为诺基亚手机开发的手机应用程序，不久前我们开始出现“随机”崩溃，并出现 USER 44 恐慌。

我对 symbian 环境还很陌生，所以我正在寻找工具和建议来帮助找到这个错误的根源。

我可以获得等效的“堆栈跟踪”吗？是否有通用的恐慌代码可以让我对此有所了解？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-19T22:16:00.443

来自[http://www.symbian.com/developer/techlib/v9.1docs/doc_source/reference/N10352/UserPanics.html](http://www.symbian.com/developer/techlib/v9.1docs/doc_source/reference/N10352/UserPanics.html)：

```
This panic is raised by the Free() and FreeZ() member functions of an RHeap.
It is caused when the cell being freed overlaps the next cell on the free
list (i.e. the first cell on the free list with an address higher than the
one being freed). 
```

这意味着，您使用无效指针调用 delete/delete[]（这反过来将调用 Free()/FreeZ()）。在 Carbide 下调试时，调试器应该在导致恐慌的行上中断，您应该能够看到无效的删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T13:49:20.177

正如[Kasprzol 指出的那样](https://stackoverflow.com/questions/566587/how-to-find-the-cause-for-a-user-44-panic/567479#567479)，单步调试器应该可以让您缩小到导致恐慌的行或例程集。您可能还想确保您没有尝试删除一个堆对象，该堆对象的所有权已转移到另一个堆对象（可能是通过没有明确记录这一事实的方法调用），该对象在显式删除之前已经删除了该对象. 我以前被后者咬过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:42:34.287

我的模糊理解是 USER 44 和 USER 45 恐慌都与堆问题有关。最常见的问题是双重删除。删除指针后，您是否将指针归零？你在删除它们之前检查 NULL 吗？你在哪里可以双重删除一些东西？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T09:54:32.433

最简单的调试选择可能是使用 Carbide 2.0，因为它功能齐全且免费提供。

# objective-c - Cocoa 中的双下划线是什么

> ID：566594
> 
> 赞同：6
> 
> 时间：2009-02-19T18:39:33.307
> 
> 标签：objective-c, cocoa, double-underscore

Objective-C 中的单个下划线显然是为 Apple 的“内部”使用而保留的（并且在 Apple 声明之前可用于私有实例变量）。但是他们为什么要在他们的 iPhone 的 SQLiteBooks 示例中使用*双下划线呢？*请参阅取自 MasterViewController.m 的此片段：

```
+ (EditingViewController *)editingViewController {
    // Instantiate the editing view controller if necessary.
    if (__editingViewController == nil) {
        __editingViewController = [[EditingViewController alloc] initWithNibName:@"EditingView" bundle:nil];
    }
    return __editingViewController;
} 
```

[在这个论坛](https://stackoverflow.com/questions/224397/why-do-people-use-double-underscore-so-much-in-c)上提到了双下划线的使用，因为它与 C 相关——它是为了“编译器的内部使用”。我想我不明白这在这种情况下如何适用。

我的应用程序中需要一个 ViewController，其行为与 SQLiteBooks 示例项目中的 ViewController 非常相似，但这个双下划线让我感到困惑。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-19T19:07:11.720

C 编译器和 Objective-C 编译器对带有前导下划线的变量名的处理与任何其他变量名都没有任何不同。单下划线或双前导下划线只是一种*约定*，有效地形成了一个命名空间，很像`NS`Cocoa 类中使用的前缀，如`NSString`.

查看 SQLiteBooks 代码，`MasterViewController.m`定义了这个静态全局变量：

```
// Manage the editing view controller from this class so it can be easily accessed from both the detail and add controllers.
static EditingViewController *__editingViewController = nil; 
```

所以我的猜测是 SQLiteBooks 的作者使用双前导下划线来表示全局变量。

C 编译器（以及扩展的 Objective-C）保留以两个下划线和一个大写字母开头的名称供编译器供应商使用，为它们提供一个保留的命名空间，用于用于实现标准库的全局变量和函数，或引入新的非-标准关键字，如`__block`.

虽然 SQLiteBooks 代码在技术上是有效的，但在我看来，它很容易与保留的命名空间混淆。如果您确实重用该代码，我建议重命名该变量（Xcode 有一个非常好的重命名重构，它会自动为您完成）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-19T23:42:47.600

对于编译器，下划线被视为任何字母字符。更一般地说，语言扩展或大型库通常使用下划线来避免与用户代码发生冲突。

使用下划线是有问题的，因为许多组试图用特定的下划线组合来保留每个名称。

Apple 传统上使用单个下划线前缀来表示私有实例变量（面向对象语言中的常见样式）。这被认为是暗示每个人都应该在他们的 ivars 前加上下划线，直到 Apple 指出如果 Apple 决定更改其标头而在您的代码中使用下划线可能会与 Cocoa 发生冲突，也许您不应该这样做。所以下划线前缀已经成为一种“不建议”的编码习惯。

在 C 和 C 派生语言中，任何前后带有双下划线的单词都是非标准语言扩展。查看 Apple 的扩展，例如 __attribute__

尾随下划线通常作为原始名称的编译器或调试器名称错位版本添加（尤其是当编译器是多通道时），并且通常避免使用，以便这些名称与原始名称保持明显不同。谷歌在他们的 Objective-C 本地实例变量后面加上下划线以避免与 Apple 的下划线冲突。

我的建议：不要使用下划线。您不应该使用与实例变量同名的局部变量（这只是令人困惑）。唯一潜在的冲突是在 setter 方法中的参数和相应的实例变量之间——你应该在参数前面加上一个小写的“a”、“new”（或类似的），因为这清楚地指出参数是传入的值但还不是“the”值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T18:43:07.577

这只是一个变量命名约定。它什么也没*做*。这是程序编写者提醒自己“这是一个私有变量”的一种方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T18:46:10.070

编译器/库供应商将某些前/后缀表示为“保留”的情况并不少见。这主要是为了避免类型/定义/继承变量之间的任何无意冲突。

您所指的帖子是关于定义的，而不是变量。许多编译器对其提供和依赖的定义使用双下划线。

至于为什么示例代码使用这种风格 - 原作者使用了他在日常工作中可能采用的相同编码风格，并且从未突出显示潜在的冲突。

您应该可以按原样保留代码示例，但如果它让您感到不舒服，那么您可以重命名变量。

# ms-access - 使用vbs自动查询访问db表并将其转换为excel

> ID：566596
> 
> 赞同：3
> 
> 时间：2009-02-19T18:41:14.287
> 
> 标签：ms-access, vbscript, ado

我有一个 Access 数据库。我想`Data_01`每天使用 VBScript 中的 ADO 自动查询表格并将结果导出到 Excel 电子表格。目前我在 ADO 方面的技能还很欠缺。

1.  我有一个日期时间列，我将从昨天和今天选择项目。在 GUI 查询中，标准将是`Between Date() And Date()-1`
2.  我有一`PartNumber`列我想选择一个特定的零件号。在 GUI 查询中，标准将是`Series 400`
3.  然后，我想根据项目 1\. 和 2 中的条件选择其他列。
4.  我也想获得列的标题行。

我目前将整个表导出到 Excel，然后使用 VBScript 选择我想要的列，然后删除所有不需要的数据，然后为我的最终输出文件自动调整列。这似乎是处理器和时间密集型的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T19:04:03.673

您是否尝试过 Excel 中用于导入数据的内置函数？我没有英文版的 Excel，所以我不会引导您使用它们，但我认为菜单名为“数据”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T20:02:16.767

这是一些示例 VBScript

```
Dim cn 
Dim rs

strFile = "C:\Docs\LTD.mdb"

strCon = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strFile & ";"

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

cn.Open strCon

strSQL = "SELECT * FROM tblTable " _
& "WHERE CrDate Between Now() And Date()-1 " _
& "AND OtherField='abc' " _
& "AND PartNumber=1 " _
& "ORDER BY CrDate, PartNumber"

rs.Open strSQL, cn

Set xl = CreateObject("Excel.Application")
Set xlBk = xl.Workbooks.Add

With xlbk.Worksheets(1)
    For i = 0 To rs.Fields.Count - 1
        .Cells(1, i + 1) = rs.Fields(i).Name
    Next

    .Cells(2, 1).CopyFromRecordset rs
    .Columns("B:B").NumberFormat = "m/d/yy h:mm"
End With

xl.Visible=True 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:14:20.773

我的第一反应是执行以下操作：

1.  在 MS Access 中创建一个查询对象，用于查找要导出的数据 [数据库窗口 -> 查询 -> 新建（现在使用 GUI 构建器）]
2.  创建将查询导出到 Excel 文件的宏。[我在这里](https://stackoverflow.com/questions/348428/exporting-crosstab-query-results-to-excel-from-within-ms-access/349856#349856)谈论更多。您也可以在 VBA 中执行此操作……许多人会说这更“纯粹”（我也有宏）；但无论什么漂浮你的船。
3.  设置一个 autoexec 宏（这将在 MS Access 打开时自动运行）运行您刚刚创建的导出宏，然后退出 MS Access（您可以在 Access 加载时按住 shift 键覆盖它）。最好还创建一个单独的 MS Access 文件来执行这些操作而不影响原始 MS Access 文件，只需创建指向原始文件的表链接即可。
4.  设置计划任务以每天打开一次 MS Access 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T21:14:25.657

如果您没有 Excel，您可以像这样使用 ADO 访问 xls

```
 Const adOpenStatic = 3
Const adLockOptimistic = 3
Const adCmdText = &H0001
Const strDB = "" 'Location of Database file
Const strXLS = "" 'Location of spreadsheet

Set objAccessConnection = CreateObject("ADODB.Connection")
objAccessConnection.Open "Provider=Microsoft.Jet.OLEDB.4.0;Persist Security Info=False;Data Source=" & strDB
Set objExcelConnection = CreateObject("ADODB.Connection")
objExcelConnection.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strXLS & ";Extended Properties=""Excel 8.0;HDR=Yes;"";"
Set objAccessRecordset = CreateObject("ADODB.Recordset")
Set objExcelRecordSet = CreateObject("ADODB.Recordset")

strAccessQuery = "SELECT * FROM Data_01 WHERE PartNumberColumn = 'Series 400' AND DateColumn BETWEEN #" & Date -1 & "# AND #" & Date & "#"
objAccessRecordset.Open strAccessQuery, objAccessConnection, adOpenStatic, adLockOptimistic

strTable = "Sheet1$"
objExcelRecordSet.Open "Select * FROM [" & strTable & "]", objExcelConnection, adOpenStatic, adLockOptimistic, adCmdText

Do Until objAccessRecordset.EOF
   objExcelRecordSet.AddNew
   For i = 0 To objAccessRecordSet.Fields.Count - 1
       objExcelRecordset.Fields(i).Value = objAccessRecordset.Fields(i).Value
   Next
   objExcelRecordSet.Update
   objAccessRecordset.MoveNext
Loop

objExcelRecordset.Close
Set objExcelRecordset = Nothing
objAccessRecordset.Close
Set objAccessRecordset = Nothing
objAccessConnection.Close
Set objAccessConnection = Nothing 
```

唯一需要注意的是确保电子表格中的列在第一行有标题，否则此脚本可能会失败。

编辑：
您还可以将记录集写入 .csv 文件。

```
 Const adClipString = 2
Const ForWriting = 2
Const ForAppending = 8
Const strDB = "C:\Test.mdb"
Const strCSV = "C:\Test.csv"

Set objAccessConnection = CreateObject("ADODB.Connection")
objAccessConnection.Open "Provider=Microsoft.Jet.OLEDB.4.0;Persist Security Info=False;Data Source=" & strDB

Set objAccessRecordset = CreateObject("ADODB.Recordset")

strAccessQuery = "SELECT * FROM Data_01 WHERE PartNumber = 'Series 400' AND TheDate BETWEEN #" & Date -1 & "# AND #" & Date & "#"
objAccessRecordset.Open strAccessQuery, objAccessConnection, adOpenStatic, adLockOptimistic

Set objCSV = CreateObject("Scripting.FileSystemObject").OpenTextFile(strCSV, ForAppending, True)
objCSV.Write objAccessRecordset.GetString(adClipString,,",",CRLF)

objCSV.Close
Set objCSV = Nothing
objAccessRecordset.Close
Set objAccessRecordset = Nothing
objAccessConnection.Close
Set objAccessConnection = Nothing 
```

Excel 将毫无问题地打开 .csv 文件。这种方法的缺点是 Excel 不能很好地保存 .csv 文件，但在 excel 中，csv 文件可以保存为 xls。

# sql - 动态/条件 SQL 连接？

> ID：566600
> 
> 赞同：3
> 
> 时间：2009-02-19T18:42:58.623
> 
> 标签：sql, sql-server, join

我在 MSSQL 表 (TableB) 中有数据，其中 [dbo].tableB.myColumn 在某个日期后更改格式...

我正在对该表进行简单的加入..

```
Select [dbo].tableB.theColumnINeed from [dbo].tableA 
left outer join [dbo].tableB on [dbo].tableA.myColumn = [dbo].tableB.myColumn 
```

但是，我需要根据表 A ([dbo].tableA.myDateColumn) 中的日期列使用不同的格式加入。

就像是...

```
Select [dbo].tableB.theColumnINeed from [dbo].tableA 
left outer join [dbo].tableB on [dbo].tableA.myColumn = 
    IF [dbo].tableA.myDateColumn > '1/1/2009'
        BEGIN
            FormatColumnOneWay([dbo].tableB.myColumn)
        END
    ELSE
        BEGIN
            FormatColumnAnotherWay([dbo].tableB.myColumn)
        END 
```

我想知道是否有办法做到这一点..或者我没有想到的更好的方法来解决这个问题..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-19T18:48:33.377

```
SELECT [dbo].tableB.theColumnINeed
FROM   [dbo].tableA 
LEFT OUTER JOIN [dbo].tableB
ON [dbo].tableA.myColumn = 
   CASE
    WHEN [dbo].tableA.myDateColumn <= '1/1/2009' THEN FormatColumnOneWay([dbo].tableB.myColumn)
    ELSE FormatColumnAnotherWay([dbo].tableB.myColumn)
   END 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T19:29:58.893

您可以考虑使用 UNION，而不是在 JOIN 中使用 CASE 语句，这将阻止使用索引的查询

```
SELECT [dbo].tableB.theColumnINeed 
FROM   [dbo].tableA 
    LEFT OUTER JOIN [dbo].tableB 
         ON [dbo].tableA.myDateColumn > '1/1/2009'
        AND [dbo].tableA.myColumn = FormatColumnOneWay([dbo].tableB.myColumn)
UNION ALL
SELECT [dbo].tableB.theColumnINeed 
FROM   [dbo].tableA 
    LEFT OUTER JOIN [dbo].tableB 
         ON [dbo].tableA.myDateColumn <= '1/1/2009'
        AND [dbo].tableA.myColumn = FormatColumnAnotherWay([dbo].tableB.myColumn) 
```

但如果 FormatColumnOneWay / FormatColumnAnotherWay 是函数或字段表达式，则可能会排除在 [myColumn] 上使用索引索引，尽管仍应使用 myDateColumn 上的任何索引

但是，它可能有助于理解 FormatColumnOneWay / FormatColumnAnotherWay 逻辑是什么，众所周知，这可以实现更好的优化

需要注意的几点：

UNION ALL 不会删除任何重复项（与 UNION 不同）。因为这两个子查询是互斥的，所以这没关系，并保存了 UNION 将执行的 SORT 步骤以使其能够删除重复项。

您不应该对字符串日期使用 '1/1/2009' 样式，您应该使用不带斜杠或连字符的 'yyyymmdd' 样式（您也可以使用带有参数的 CONVERT 来明确指示字符串在 d/m/ y 或 m/d/y 样式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T18:45:30.430

从`[dbo]`前缀来看，我相信您使用的是 SQL Server。虽然我没有太多经验，但您可以将两个字段都转换为特定的日期格式：

```
select * from tableA
  Left Outer join tableB
       On CONVERT(CHAR(8), tableA.myColumn, 112) = CONVERT(CHAR(8), tableB.myColumn, 112) 
```

使用适当的日期格式化函数，这同样适用于任何 DBMS。

我不了解 SQL Server，但在 Oracle 中，您可以为连接表达式创建索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T18:50:34.263

在 SQL Server 中，您将使用 CASE，例如：

```
SELECT * 
FROM TableA
INNER JOIN TableB on TableA.Column=
CASE WHEN TableA.RecordDate>'1/2/08'
       THEN FormatCoumn(TableB.Column) 
     ELSE FormatColumnOtherWat(TableB.Column)
END 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T18:50:56.387

您知道这对性能不利，因为您将无法使用索引，对吗？

您可以使用 CASE 语句 kludge 或...您可以去修复数据，以便您可以使用索引，它会快很多倍

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T18:51:39.927

好吧，您可以在联接之前使用子查询来正确格式化任一表中的数据。

```
SELECT
  newB.columnINeed
FROM
  tableA AS A
LEFT OUTER JOIN (
  SELECT
    columnINeed
  , CASE WHEN myColumn > '1/1/2009' THEN FormatColumnOneWay(myColumn)
    ELSE FormatColumnAnotherWay(myColumn)
    END AS myColumn
  FROM
    tableB
) AS NewB ON A.myColumn = B.myColumn 
```

如果性能很重要，您可以使用索引视图（基于子查询）而不是将子查询硬编码到整个查询中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T18:51:53.967

我同意`CASE`语法更适合阅读目的，尽管我不知道运行时间是否有任何显着差异。

真正要做的“正确”事情是重新做它并从头开始做正确的事情。您的日期应该存储在`datetime`列中，并且将 tableB 中的所有日期迁移到 datetime 列可能会有很多收获。你可以这样做，其中包括：

1.  添加一个虚拟列到`TableB`type `datetime`。
2.  运行从当前列获取日期值并将其放入日期时间列的查询。
3.  重命名和删除列以匹配以前的数据结构。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-19T18:52:08.913

好的，等一下。列的实际数据类型是什么？我猜它不是 DateTime，因为你并不能真正控制格式……它只是存储一个日期。它可以 CAST 或转换为 DateTime 吗？

所以你可能想要

```
left outer join tableb on tableA.myColumn = CAST(tableb.MyColumn as DateTime) 
```

这样你就不会匹配一个字符串，而是应该更可靠的实际日期。它也更简单，更易于阅读。真正的问题是为什么日期没有首先存储为 DateTime ......

# c++ - 如何在 C++ 中迭代地访问名称仅因数字不同而不同的变量？

> ID：566603
> 
> 赞同：4
> 
> 时间：2009-02-19T18:44:21.697
> 
> 标签：c++, variables, naming

我需要一种方法来帮助我，在循环中逐个访问名为“comboBox1”、“comboBox2”等的变量。我想更改如下代码：

```
//proceed comboBox1
//proceed comboBox2
//proceed comboBox3
//proceed comboBox4
//proceed comboBox5
//proceed comboBox6 
```

进入：

```
for (int i = 1; i < numberOfBoxes; i++) {
    //proceed comboBox(i)
} 
```

我试图找到像“eval”这样的东西，但谷歌没有给出任何匹配的东西。我还尝试使用运算符## 对名称进行预处理，但似乎无法将当前整数值放入宏中。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-19T18:47:53.423

最简单的解决方案是将它们全部放在一个数组和迭代器中：

```
// I've made up a type, but you get the idea.
std::vector<ComboBox *> combos;
combos.insert(comboBox1);
combos.insert(comboBox2);
combos.insert(comboBox3);
combos.insert(comboBox4);
combos.insert(comboBox5);
combos.insert(comboBox6); 
```

现在您可以迭代组合。主要问题是c++没有反射。所以你不能像在其他语言中那样在运行时生成字符串并获取对象或函数的地址。

编辑：我刚刚看到您正在使用 Qt。在这种情况下，您应该使用：

```
QList<T> qFindChildren ( const QObject * obj, const QString & name ); 
```

或者

```
QList<T> qFindChildren ( const QObject * obj, const QRegExp & regExp); 
```

这使您**可以根据运行时生成的名称获得一个列表**。例如：

```
QList<QComboBox *> combos = qFindChildren(ui, QRegExp("combo[0-9]+")); 
```

然后你可以迭代它！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T18:49:30.660

我知道如何做到这一点的唯一方法是在代码/动态和数组中创建它们。（不是通过向导）您并不是唯一一个发现 MFC（我认为）向导的缺点的人。

作为替代方案，如果您的资源在资源文件中是连续的（我再次假设类似 MFC 的实现），您可以遍历资源 ID 以获取资源。这假定它们具有连续的资源 ID。我最近用过这个方法。它工作得很好。不确定它是否是您正在寻找的或将与您的 GUI 一起使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T18:48:38.167

C++ 中没有任何方法可以在运行时按名称识别变量。与其使用名称为comboBox1、comboBox2 等的一组离散变量，不如创建一个可以迭代的ComboBox 数组？然后你的循环看起来像：

```
for (int i = 1; i < numberOfBoxes; i++) {
   doSomething(comboBoxes[i]);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-19T20:23:10.533

如果您喜欢预处理器技巧，请参阅 Boost.Preprocessor 库：

```
// Shamelessly copied from the Boost docs, and only slightly
// adapted. (and probably breaking it ;)
#include <boost/preprocessor/cat.hpp>
#include <boost/preprocessor/repetition/repeat_from_to.hpp>

#define DO_SOMETHING(z, n, text) BOOST_PP_CAT(text, n)->DoSomething();

BOOST_PP_REPEAT_FROM_TO(0, 3, DO_SOMETHING, comboBox) 
```

会扩展为：

```
comboBox0->DoSomething();
comboBox1->DoSomething();
comboBox2->DoSomething(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-19T18:56:42.387

我使用以下方法进行函数注册，但您可以尝试在您的情况下应用，希望它保证这种不尊重空格的 C 风格解决方法：

```
#define GET_COMBO_BOX(x,y) x ## y

for (int i = 1; i < numberOfBoxes; i++) 
  GET_COMBO_BOX(comboBox1,i); 
```

这显然不会做你想做的事，因为 i 在编译时确定并且宏在预处理时消耗，但它会让你知道如何预生成函数调用。

这是使用宏连接的更完整示例：

```
#include<iostream>
#include<string>

using namespace std;

template< class E > struct EnumNames
{
    static const char* const* names;
    static int names_size;
};

#define REGISTER_ENUM( e ) \
    const char* const* EnumNames< e >::names = e ## _names; \
    int EnumNames< e >::names_size = sizeof( e ## _names ) / sizeof( const char* );

enum ElementType { NEURON, SYNAPSE };
const char* const ElementType_names[] = { "N", "S" };
REGISTER_ENUM( ElementType )

enum TokenMainType { EP, IP, NT, AI };
const char* const TokenMainType_names[] = { "EP", "IP", "NT", "AI" };
REGISTER_ENUM( TokenMainType )

template<class E>
ostream& operator <<(ostream& os, const E& e) 
{
    if (e > EnumNames< E >::names_size) 
        cout << "Error" << endl;
    os << EnumNames< E >::names[e];
    return os;

}

template<class E>
istream& operator >>(istream& is, E& e) {
    std::string tmp_e_string;
    is >> tmp_e_string;
    for (int i = 0; i < EnumNames< E >::names_size; ++i) {
        if (tmp_e_string == EnumNames< E >::names[i])
        {
            e = E(i);
            return is;
        }

    }
    cerr << "Fehler: tmp_nntype_string: " << tmp_e_string << endl;
    return is;

}

int main (int argc, char **argv)
{
    ElementType test1(NEURON);
    cout<<string(EnumNames<ElementType>::names[test1])<<endl;

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-19T18:48:42.847

您需要将变量存储在数组中。

例如

```
mComboBoxes[MAX_COMBOBOXES]; 
```

// 初始化

```
for (int i = 0; i < numberOfBoxes; i++) {
    mComboBoxes[i];
} 
```

请注意，数组具有从零开始的索引。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-19T18:49:20.007

使用数组。这就是他们的目的。或容器。

```
T combobox_array[ N ]; // N comboboxes
for (int i = 0; i < N; ++i)
     process(combobox_array[ i ]); // note array indices are 0 to N-1 
```

或者，使用 STL

```
vector<T> ca(N);
for_each(ca.begin(), ca.end(), do_something); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-19T18:49:43.890

什么是“进行”？

您需要另一个级别的间接性。也许将指向组合框的指针存储在一个向量中，以后可以对其进行迭代。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-19T18:51:51.143

有没有理由你不能拥有组合框的数组/向量/列表？

```
std::vector<ComboBox> comboBoxes; 
```

还是更好地维护一个指向组合框的指针列表？

```
std::vector<ComboBox*> comboBoxPtrVec;
ComboBox* comboBox1 = new ComboBox();
ComboBox* comboBox2 = new ComboBox();
comboBoxPtrVec.push_back( comboBox1 );
comboBoxPtrVec.push_back( comboBox2 );

for (insigned int i = 0; i < comboBoxPtrVec.size(); ++i)
{
   // process comboBox
   comboBoxPtrVec[i]->DoSomething();
} 
```

# ruby-on-rails - 如何强制 gem 升级到 gem 1.3.1

> ID：566614
> 
> 赞同：10
> 
> 时间：2009-02-19T18:46:00.960
> 
> 标签：ruby-on-rails, ruby, rubygems

我正在尝试安装这样的 gem：

```
C:\InstantRails\rails_apps\foodmarksthespot>ruby script/plugin install git://github.com/lazyatom/engines.git 
```

返回此消息：

```
Rails requires RubyGems >= 1.3.1 (you have 1.2.0). Please `gem update --system` and try again. 
```

但是当我尝试使用更新时：

```
gem update --system 
```

它说：

```
Updating RubyGems
Nothing to update 
```

这是在窗户上。如何强制将系统升级到特定版本？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-19T18:58:40.433

[http://rubyforge.org/forum/forum.php?forum_id=28071](http://rubyforge.org/forum/forum.php?forum_id=28071)

从那里：

```
注意：RubyGems 1.1 和 1.2 在没有升级时会出现问题
安装了 ruby​​gems 更新。您将需要关注第二组更新
如果您看到“没有要更新的内容”，请说明。

如果您安装了旧版本的 RubyGems，那么您仍然可以
分两步进行：

$ gem install ruby​​gems-update (同样，可能需要管理员/root)
$ update_rubygems (...这里也是)

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-10T14:33:26.417

对于最近偶然发现这个问题的任何人：为了安装特定的旧版本的 RubyGems（可能像我一样维护旧版应用程序），我必须执行以下操作，因为之前的答案不起作用：

```
$ gem install -v 1.3.7 rubygems-update && \    
$ ruby `gem env gemdir`/gems/rubygems-update-1.3.7/setup.rb    

$ gem -v 
1.3.7 
```

如此处所述：http: [//www.chentianwen.net/wordpress/2011/05/24/how-to-update-rubygems-to-a-specific-version/](http://www.chentianwen.net/wordpress/2011/05/24/how-to-update-rubygems-to-a-specific-version/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-04T13:19:49.207

如果要安装特定版本，请尝试以下操作。

`$gem install -v=version_number package_name`

例如，在您的情况下，它应该是，

`$gem install -v=1.3.1 RubyGems`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T18:56:21.980

如果你`gem --version`在cmd中运行你会得到什么？听起来您在 cmd 中运行的 gem 可执行文件与 Rails 使用的不同。

# reporting-services - SSRS 神秘的额外页面

> ID：566618
> 
> 赞同：6
> 
> 时间：2009-02-19T18:47:00.163
> 
> 标签：reporting-services, subreport

我有两个设置为相同页面尺寸的报告——A4 纵向，页边距为 1 厘米。

当我单独运行报告并打印它们时，它们都按预期出现：适合页面的宽度限制。

但是，当我将一个报表作为子报表包含在另一个报表中，然后运行并打印“主”报表时，我开始遇到问题。即使两个报告都出现了，我在输出中每隔一页都会出现额外的空白页。

我确定我错过了一个简单的技巧 - 可能是两个报告的页面大小，但我无法弄清楚 - 任何指针？

我不介意更改子报表的设置，因为它永远不会在野外作为单独的 eport 运行，我只包括该步骤以证明它确实适合页面！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-22T17:17:47.830

可能有帮助的一件事是在主报告中将右边距设置为 0。我自己注意到了这一点，子报表正确显示在主报表中，并将其作为子报表添加到另一个主报表中会导致它插入额外的分页符。我同意 TheTXI，它非常令人沮丧，我希望他们有一个调试/检查模式，就像 firebug 对网页所做的那样。

编辑：您还应该检查您的字段以确保它们没有设置为自动扩展（意外）。右键，属性，设置`.CanGrow = False`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T18:49:00.350

您的页面大小或页边距可能存在突出部分，导致其溢出到空白页中。有时他们可能会很生气。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-18T11:36:55.640

尝试将报表的 ConsumeContainerWhitespace 属性设置为 true，以便在主报表中执行所有报表！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-19T19:09:34.133

请参阅[本文档](http://preview.tinyurl.com/5pxzeq)的第 12 页（.doc 下载）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-01-11T15:27:07.980

我意识到这是一个旧线程，但我最近遇到了这个问题，并发现了您最终可能会出现空白页的另一个原因 - 如果主报告中有任何空白，PDF 渲染器会创建一个空白页。

因此，如果您在上述措施中没有找到解决方案，请确保您的主报告没有空白。每个的大小似乎并不重要。重要的是您的子报表与主报表的大小相同，并且子报表从坐标 0,0 开始。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-10T22:13:35.427

我遇到了这个问题，我的报告每隔一页都是空白的。我尝试了所有我能找到的建议，但没有任何缓解。我减小了列宽，直到报告只占了一半，仍然有空白页，这也告诉我不是列宽导致了我的问题。

最后，通过将右边距设置为 0，问题就解决了。谢谢斯奈夫！这没有意义，但现在这并不重要！

# iphone - 用模糊加速？

> ID：566637
> 
> 赞同：1
> 
> 时间：2009-02-19T18:50:29.973
> 
> 标签：iphone, core-animation

有没有办法使用模糊之类的东西来加速动画？

我有一个循环，必须遍历它才能在我的 UI 中表示一个“增量”。当用户一次向前跳几个增量时，我想加快每个动画循环。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T21:29:26.577

iPhone SDK 没有 CoreImage 过滤器（在 Mac OS X 中正确的做法）。

您的其他选择是

*   使用核心动画层伪造它。
*   使用 OpenGL

这不是微不足道的，但在 CoreAnimation 的情况下，您可以尝试使用各种 alpha 值和/或彩色阴影设置图层的几个副本。半透明遮罩层也可以工作。根据您的内容和速度，您可能需要四处玩耍才能获得您正在寻找的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-28T03:05:02.353

如果您只想坚持使用 Quartz，您还可以考虑计算要移动的增量的数量，并执行一个包含所有增量的动画。

然后，将单个动画的持续时间设置为小于 x 单个动画如果“堆叠”端到端。

虽然这不会给你带来模糊，但如果单独执行，你可以很简单地将整体的持续时间调整为小于各个部分的总和。在这么小的规模上，这些技巧对用户来说往往是一样的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T16:46:58.923

您可以通过创建一个图层，将其 alpha 设置为 0.25（或您认为看起来不错的任何值），然后将您的图像复制到 3-5 个位置来获得“拖尾条纹”效果（选择一个看起来不错的值）隔开以使其看起来像运动模糊。

对于额外的花哨，有 3 个 CGLayers，在 0.25、0.5、0.75，加上原始图像，并让 CGLayers 3、2 和 1 落后，留下“痕迹”。

# c# - 将 WCF 与旧的复杂类型一起使用

> ID：566639
> 
> 赞同：1
> 
> 时间：2009-02-19T18:50:52.733
> 
> 标签：c#, wcf, serialization

我正在编写 WCF 服务来替换当前的 Web 服务，但我遇到了需要返回的旧复杂类型之一的问题。

不幸的是，我无法触及任何代码，但查看它们所有类都是可序列化的，并且当前的 Web 服务正在使用它没有问题。

每当我的客户端调用 WCF 服务时，它都会收到通信异常，当我打开 WCF 跟踪时，我发现了序列化错误：

*不应使用数据合同名称“ **ApplicationGroup**： http: [//schemas.datacontract.org/2004/07/Common.Permission](http://schemas.datacontract.org/2004/07/Common.Permission) ”键入“Common.Permission.ApplicationGroup” 。将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。*

我要返回的类型是 ApplicationPrincipal，但它似乎在子类型上失败了。以下是这些类的外观：

我要返回的类型：

```
[Serializable]
[TypeConverter(typeof(ExpandableObjectConverter))]
public class ApplicationPrincipal : 
    IPrincipal, ISupportInitialize, IDeserializationCallback, IFormattable
{
    private ApplicationIdentity m_identity;
    private ApplicationGroupCollection m_groups;
    private ConditionDictionary m_roleConditions; 
```

这是ApplicationGroupCollection：

```
[Serializable]
public class ApplicationGroupCollection : 
    IList, IEnumerable, IFormattable, ISupportInitialize, 
    IDeserializationCallback, ICloneable, ICustomTypeDescriptor
{
    /// <summary>
    /// Occurs when a value is being changed in the collection.
    /// </summary>
    [field:NonSerialized]
    public event CollectionChangeEventHandler CollectionChanging;

    /// <summary>
    /// Occurs when a value has been changed in the collection.
    /// </summary>
    [field:NonSerialized]
    public event CollectionChangeEventHandler CollectionChanged; 
```

最后，应用程序组：

```
[Serializable]
[TypeConverter(typeof(ExpandableObjectConverter))]
public class ApplicationGroup : 
    ICloneable, ISupportInitialize, IDeserializationCallback, IFormattable
{
    private int m_groupID;
    private string m_groupName;
    private string m_groupDesc;
    private ConditionDictionary m_roleConditions; 
```

关于为什么 WCF 无法序列化 ApplicationGroup 的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T18:53:12.390

尝试将这些添加到 DataContract 的顶部：

```
[KnownType(typeof(ApplicationGroupCollection))]
[KnownType(typeof(ApplicationGroup))] 
```

[编辑]未经测试，我无法告诉您这是否可以解决问题-我想知道 DataContractSerializer 是否能够序列化您的旧类型，因为 DataContractSerializer 要求类型“选择加入”具有类型和所有成员的属性需要序列化。

[编辑] 这是您看到的第二组错误的原因。如果您从服务返回自定义类型，则客户端需要拥有该类型的副本，以便它可以反序列化消息。这意味着您需要向客户端提供包含旧类型的程序集的副本，以供客户端引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T19:04:01.067

我认为安德鲁是正确的。

此外，请参阅Juval Lowy的“[编程 WCF 服务”的第 3 章。](http://oreilly.com/catalog/9780596521301/index.html)它包含有关 DataContracts 的大量信息，我很确定它完全涵盖了您在此处询问的内容。

# c# - 如何使用 C# 中的 MagickNet 将图像拼接在一起？

> ID：566647
> 
> 赞同：3
> 
> 时间：2009-02-19T18:51:43.063
> 
> 标签：c#, .net, image, imagemagick, magicknet

我想使用 MagickNet（jpg/bmp - 随便）将一些图像拼接在一起。

有没有人对此有一些很好的参考？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-20T13:05:07.783

来自 FreeImage.NET 的 sourceforge 项目论坛：

你好，

使用 FreeImage_Allocate 创建一个新的空（黑色）结果图像。加载要使用 FreeImage_Load 拼接的每个图像。使用 FreeImage_Paste 将加载的图像粘贴到结果图像中，其中参数 dst 是您分配的结果图像，参数 src 是加载的图像。粘贴图像后，使用 FreeImage_Unload 卸载图像，以防止您的应用程序泄漏内存。粘贴完所有图像后，使用 FreeImage_Save 保存结果图像。然后通过再次调用 FreeImage_Unload 来释放结果图像的内存。

注意：目前，使用 FreeImage_Paste 粘贴的图像不得超过目标图像的任何边。没有执行自动剪切，因此您必须确保参数 top 和 left 不小于 0（零）并且 left + 以及 top + 分别不大于目标图像的宽度或高度。

卡斯滕

# java - java.util.ArrayList

> ID：566655
> 
> 赞同：4
> 
> 时间：2009-02-19T18:53:54.573
> 
> 标签：java, collections, arraylist

这是java.util.Arrays.asList的实现：()

```
public static <T> List<T> asList(T... a) {
    return new ArrayList<T>(a);
} 
```

那怎么编译？我找不到接受像 T...och T[] 这样的参数的 ArrayList、AbstractList 或 AbstractCollection 的构造函数。

源代码来自：

```
java version "1.5.0_16"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_16-b06-284)
Java HotSpot(TM) Client VM (build 1.5.0_16-133, mixed mode, sharing 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-19T18:55:26.833

好的，我想我现在看到了混乱。

有问题的`ArrayList`类型是类中的嵌套类型`Arrays`- 它不是`java.util.ArrayList`.

# vim - 如何在 VIM 中阅读 RSS？

> ID：566656
> 
> 赞同：4
> 
> 时间：2009-02-19T18:54:10.657
> 
> 标签：vim, rss

想在 VIM 中阅读 RSS，但我还没有找到插件。

你们有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T22:25:00.347

[我刚刚在http://www.vim.org/scripts/script.php?script_id=2147](http://www.vim.org/scripts/script.php?script_id=2147)中使用 feedparser.py来获取 trac 服务器时间线视图。您需要在 vim 安装中安装它和 +python。尽管如果您是 ruby​​/perl 专家，您可能还可以尝试其他语言库。

一点 vim 脚本知识，你就在那里（查看上面的链接并窃取你需要的东西）。并且可以随意使用您自己的 vim 安装来做任何您该死的事 :)

编辑：而不是通过该代码进行挖掘...这是您的 vimrc 的精简版本，您可以扩展并使其更漂亮

```
fun MyFeed(feed)
split
enew
set buftype=nofile
python b = vim.current.buffer
python import re
python import feedparser;f = feedparser.parse(vim.eval('a:feed'))
python for i in f['items']: b.append('%s {{{1 %s' % (str(i.title), str(i.link)));
            \b.append(str(re.sub(r'<[^>]*?>', '',i.summary_detail.value)).split("\n"))
setlocal  textwidth=120
norm gggqGgg
set foldmethod=marker

endfun
com VimRssFeed call MyFeed("http://stackoverflow.com/feeds/question/566656")
com Slashdot call MyFeed("http://rss.slashdot.org/Slashdot/slashdot")
com MyStack call MyFeed("http://stackoverflow.com/feeds/user/59592") 
```

确保您已安装[http://www.feedparser.org/](http://www.feedparser.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T19:02:39.777

是否有特殊原因需要在 vim 中？有多种功能齐全的控制台 RSS 阅读器可用，例如[newsbeuter](http://www.newsbeuter.org/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T19:22:21.590

不要，它不是emacs。

也许可以尝试使用 feed2imap 或 rss2email 在您最喜欢的邮件客户端（例如 mutt）中阅读 rss 项目

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T19:30:58.313

你试过了吗：

```
:e http://whatever.com/feed_url 
```

在我的（Linux）系统上，这用于`links`将页面转储到临时文件并以只读方式将其读入 Vim。它不漂亮，但它是半可读的。见`:h g:netrw_http_cmd`。

但是，是的，这听起来更像是 Emacs 的东西。Vim 只是一个文本编辑器。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-01T08:04:10.220

有一个插件： http: [//danielchoi.com/software/vnews.html](http://danielchoi.com/software/vnews.html)

我自己还没有尝试过，但这似乎是我想要的。我同意其他人的观点，即 Vim 不是 Emacs。尽管如此，在我看来，让 Vim 更像一个具有编辑功能的操作系统会很酷。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-19T19:42:42.883

有一个用于 firefox 的插件 - [Vimperator](http://vimperator.org/trac/wiki/Vimperator)（由 gpojd 提供） - 它使您能够将 firefox 与 vim 快捷方式等一起使用。对界面进行了重大更改。

# java - 缓冲图像旋转

> ID：566670
> 
> 赞同：0
> 
> 时间：2009-02-19T18:58:08.423
> 
> 标签：java, image-manipulation

围绕渐变为 1 度的中心旋转缓冲图像的最佳方法是什么？

我知道有 AffineTransform，但这会导致剪切和奇怪的拉伸或应该是空白的黑点。

*编辑*我正在处理的图像大小是图标大小，因此通常为 24x24 到 48x48 像素

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T19:00:42.400

如此小角度的旋转质量会随着图像的大小而有很大的不同。你的图像有多大？

[OP编辑问题以指示图像大小后]

IMO 图像太小，无法进行任何有意义的旋转，而不是 90 度的倍数（假设它是一个正方形）。恐怕这需要由平面设计师手动完成，以获得最佳质量。

[另一种选择]

保留图像的高分辨率版本。将所有转换应用于此图像，然后按比例缩小以获得图标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T19:01:33.363

您是否尝试过设置图形上下文的抗锯齿？

```
g2d.setRenderingHint(
    RenderingHints.KEY_ANTIALIASING,
    RenderingHints.VALUE_ANTIALIAS_ON
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T14:39:41.683

作为一个快速而肮脏的修复，您是否考虑过以下方法：

*   通过将图像绘制到新的缓冲图像上，将图像放大 8 倍
*   旋转图像，通过仿射变换对其进行绘制
*   通过将其绘制到另一个新的缓冲图像上，再次缩小它

在缩减过程中，任何低级伪影都应该消失。这可能不是最快的选择，但它可以用最少的麻烦做你想做的事——更复杂的解决方案可能归结为在幕后做同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T13:45:56.837

以下是一些链接，这些链接解释了在将转换应用于图标时您可能希望如何进行。

**Java 2D 技巧：抗锯齿图像转换** [http://weblogs.java.net/blog/campbell/archive/2007/03/java_2d_tricker_1.html](http://weblogs.java.net/blog/campbell/archive/2007/03/java_2d_tricker_1.html)

**BufferedImage 中 Raster 或 DataBuffer 的子像素采样。** [http://forums.java.net/jive/thread.jspa?messageID=204921&tstart=0](http://forums.java.net/jive/thread.jspa?messageID=204921&tstart=0)

# apache-flex - 当 URL 中存在查询字符串时，SharedObject (Flex 3.2) 行为异常

> ID：566682
> 
> 赞同：1
> 
> 时间：2009-02-19T19:01:22.053
> 
> 标签：apache-flex, flex3, flexbuilder, query-string, shared-objects

**摘要：**下面详述的行为似乎表明，如果您在 www.someplace.com 上的应用程序通过 SharedObject 设置/检索数据，那么如果用户在 someplace.com 上点击您的应用程序，则会出现某种 .sol 冲突，然后在someplace.com?name=value。

任何人都可以证实或反驳这一点吗？

* * *

我正在开发一个为用户提供登录页面的 Flex Web 应用程序。当用户登录后，他/她会看到一个与“组”相关联的“房间”。

我们将最后访问的房间/组组合存储在 SharedObject 中 - 因此，当给定用户登录时，他们会被带到他们最近处于活动状态的房间。

这很好用，但我们也有一个自动登录系统，该系统涉及用户单击应用程序 url 的链接，并附有查询字符串。这些链接有两种类型。

1）查询字符串包括username、groupId、roomId

2) 查询字符串只包含用户名

因为我们工作速度很快，而且只有少数开发人员，所以自动登录系统是建立在 last-vist 系统上的。在自动登录过程中，会检查 url，如果在查询字符串中找到 groupId 和 roomId 值，则打开 SharedObject 并且最后访问组/房间 id 值被参数值覆盖。

这也可以正常工作，当应用程序遇到第二种类型的查询字符串（没有 groupId 和 roomId 参数）时，应用程序会像往常一样转到 SharedObject 以获取存储的房间和组 ID 值。这就是问题所在：

它返回的值是最后一个房间/组参数值是什么，而不是最后一次访问房间/组值是什么。

如果给定用户从未使用包含组和房间 ID 值的查询字符串访问应用程序，则应用程序会从 SharedObject 获取空值。

它需要一些挖掘，但看起来正在发生的是，如果 URL 中存在查询字符串，则第二组数据正在存储/预期在 SharedObject 中。

在文本编辑器中查看 .sol 文件时，我会看到更多未翻译的代码以及其他组和房间值，一旦我使用包含查询字符串的 URL 访问应用程序。

我在网上没有找到任何关于此的内容，但这可能只是由于缺乏必要的搜索技能。

有没有其他人遇到过类似的事情？或者你知道如何解决这个问题吗？

我已经尝试将 Security.exactSettings 设置为 false，我真的希望这会奏效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T22:14:35.777

要记住的一件事： - 它们是共享的 - 但有延迟。如果您获得共享对象并对其进行更改，则更改将在延迟后写入客户端 .sol。

另外，我注意到对于某些客户端（尤其是 Vista），在应用程序状态的早期访问 ShraedObjects 会引发异常。如果您稍后再试一次，通常会成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-18T06:21:50.787

听起来您在登录过程中正确地写入了共享对象，但是当用户在使用应用程序时更改房间/组时，没有正确地将房间/组写入共享对象。

这就是为什么如果他们从未使用房间/组参数进入应用程序的值将为空，以及为什么这些值不能反映登录过程后发生的变化。

此外，为了确保在写入值后将值保存到磁盘，您可以调用`mySharedObject.flush()`.

# .net - Silverlight、EDM/LINQ 和 WCF Web 服务 - 如何将集合传递给 Silverlight

> ID：566686
> 
> 赞同：3
> 
> 时间：2009-02-19T19:01:39.807
> 
> 标签：.net, wcf, silverlight, web-services, iqueryable

将答案（集合）传回 Silverlight 的正确方法是什么？

例如，如果我有一个位于 Northwind 示例数据库之上的服务应用程序，并且该服务有一个名为 GetEmployees() 的方法。传递回 Silverlight 的正确“东西”是什么？一个 IQueryable ？

然后考虑到 Silverlight 方面的 Async/Result 转换内容，我还应该转换什么？一个 IQueryable ？

**更新：**
是否允许远程客户端从服务中查看结构（实体）的 [AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)] 声明？我不知道有像 Silverlight-friendly-WCF 类这样的东西，所以这不是我开始的。一旦我在解决方案中添加了该属性，没有它我将不再使用该服务。所以我无法测试我之前看到的内容。*对AspNetCompatibilityRequirementsMode.Allowed*的作用有什么想法吗？

**更新 2：**
查看对 Terry Donaghe 的评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T21:33:53.620

您是否只是尝试传递基本类型的数组？除非您创建 DataContract，否则 WCF 不知道您的任何对象是什么。当您尝试传递 List WCF 时，实际上只是传递了一个数组，因为它旨在*尝试*互操作。

定义一个[DataContract](http://msdn.microsoft.com/en-us/library/ms733127.aspx)以包含有关员工（或其他）的信息。尽量保持相对简单。当您创建代理（可能使用 svcutil 或添加服务引用）时，VS2008 将在您的客户端自动神奇地定义 DataContracts，然后您可以像使用常规对象一样使用它们。

我更喜欢手动使用 WCF - 我创建自己的合同、实现和代理 dll。就反序列化和其他方面而言，这样做给了我很大的灵活性。有关更多信息，请参阅以下两个参考资料：

[WCF 手动方式，正确方式](http://www.devx.com/codemag/Article/39837)

[手动 WCF - 扩展](http://www.tadsharp.net/?p=9)

另外，请参阅 Juval Lowy 的 WCF 圣经第 3 章“编程 WCF 服务”。它充满了关于 DataContracts 的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T19:05:55.950

在使用常规 Web 服务时，您必须返回诸如 List the SOAP formatter 之类的集合，以了解如何处理它。但是，我没有使用过 WCF，所以我不知道这是否会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T20:13:24.657

只需返回一个列表。如果可以返回单个*T*，则可以返回 List< *T* >。

# c# - 在 WPF 按钮单击事件上使用 lambda 表达式时的奇怪行为

> ID：566687
> 
> 赞同：2
> 
> 时间：2009-02-19T19:01:54.767
> 
> 标签：c#, wpf, events, lambda

我的问题很难解释，所以我创建了一个示例来展示这里。

当显示以下示例中的 WPF 窗口时，将显示三个按钮，每个按钮都有不同的文本。

当单击这些按钮中的任何一个时，我假设它的文本应该显示在消息中，但是所有这些按钮都显示相同的消息，就好像它们都在使用最后一个按钮的事件处理程序一样。

```
public partial class Window1 : Window {
    public Window1() {
        InitializeComponent();
        var stackPanel = new StackPanel();
        this.Content = stackPanel;
        var n = new KeyValuePair<string, Action>[] { 
            new KeyValuePair<string, Action>("I", () => MessageBox.Show("I")), 
            new KeyValuePair<string, Action>("II", () => MessageBox.Show("II")), 
            new KeyValuePair<string, Action>("III", () => MessageBox.Show("III"))
        };
        foreach (var a in n) {
            Button b = new Button();
            b.Content = a.Key;
            b.Click += (x, y) => a.Value();
            stackPanel.Children.Add(b);
        }
    }
} 
```

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T19:12:41.183

这是因为在循环中编译器如何评估闭包：

```
foreach (var a in n) {
    Button b = new Button();
    b.Content = a.Key;
    b.Click += (x, y) => a.Value();
    stackPanel.Children.Add(b);
} 
```

编译器假定您将需要`a`闭包中的上下文，因为您正在使用`a.Value`，因此它正在创建一个使用 的值的 lambda 表达式`a`。但是，`a`它具有整个循环的范围，因此它只会分配给它的最后一个值。

为了解决这个问题，您需要复制`a`到循环内的一个变量，然后使用它：

```
foreach (var a in n) {
    Button b = new Button();
    b.Content = a.Key;

    // Assign a to another reference.
    var a2 = a;

    // Set click handler with new reference.
    b.Click += (x, y) => a2.Value();
    stackPanel.Children.Add(b);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T19:13:12.727

不直观吧？原因在于 lambda 表达式如何从表达式外部捕获变量。

当 for 循环最后一次运行时，变量`a`被设置为数组中的最后一个元素，`n`之后就再也不会被触及。但是，附加到事件处理程序的 lambda 表达式返回`a.Value()`，实际上尚未计算。结果，当它运行时，它将获得 的当前值`a`，此时它是最后一个元素。

在不使用一堆额外变量等的情况下按照您期望的方式进行这项工作的最简单方法可能会更改为如下所示：

```
var buttons = n.Select(a => {
    Button freshButton = new Button { Content = a.Key };
    freshButton.Click += (x, y) => a.Value();
    return freshButton;
});

foreach(var button in buttons)
    stackPanel.Children.Add(button); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:12:19.780

要解决此问题，请执行以下操作：

```
var value = a.Value();
b.Click += (x, y) => value; 
```

# windows - 窗口管理器在将窗口标记为无响应之前等待多长时间？

> ID：566691
> 
> 赞同：3
> 
> 时间：2009-02-19T19:03:36.560
> 
> 标签：windows, windows-vista, windows-xp, dwm

窗口在确定窗口无响应并显示无响应的 chrome 之前等待多长时间？仅根据轶事经验，我认为它在 XP 和 Vista 中是不同的，因为 Vista 中的 DWM 和 XP 中的 Explorer shell 处理它们的方式非常不同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T19:14:12.897

取自[MSDN 上的 Windows 错误报告](http://msdn.microsoft.com/en-us/library/bb513616(VS.85).aspx)

> 如果应用程序在 5 秒内未响应 Windows 消息并且用户尝试与应用程序交互，则该应用程序被视为无响应（或挂起）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T19:10:31.793

我隐约记得在应用程序停止从消息队列中获取消息后，在 Windows 将应用程序标记为无响应之前，我读到过大约 5 秒的等待。如果我再次找到那篇文章，我会尝试发布链接:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:06:44.293

它更多地基于消息队列中未完成项目的数量而不是时间间隔。

# java - 为什么我的 jscrollpane 会在 java swing 中导致奇怪的绘制调用？

> ID：566711
> 
> 赞同：6
> 
> 时间：2009-02-19T19:06:21.813
> 
> 标签：java, swing, graphics, jscrollpane

我有一个例程，可以在滚动窗格内绘制一个非常大的图形。在添加到滚动窗格之前它太大了，无法绘制 - 内存要求将是几场演出。

由于图表的大小，我在滚动窗格子项的绘制方法中渲染图表。效果很好，但是我注意到每次移动滚动条时，我的绘制例程都会被调用两次——一次是剪切矩形等于滚动到的未覆盖区域，第二次是剪切矩形等于视口的尺寸.

例如，如果我的视口是 245x195 并且我向下滚动 3 个像素，我的绘制例程将被调用，`g.getClipBounds()`设置如下：

```
java.awt.Rectangle[x=0,y=195,width=245,height=3]
java.awt.Rectangle[x=0,y=3,width=245,height=195] 
```

...因为我在绘制例程中渲染，这会导致闪烁（我尽可能快地进行计算，但我猜会有一点延迟）。问题：

1.  **有谁知道如何防止第二次油漆电话？**这是我在这里做的简单 JScrollPane 的东西 - 我有一个组件，我将它添加到滚动窗格，我将滚动窗格添加到父组件。即使在第一个图像滚动演示[@swing 教程](http://java.sun.com/docs/books/tutorial/uiswing/components/scrollpane.html)中，您也可以看到这种行为。

2.  如果#1 的答案是“不”：**任何人都可以想出一个好的方法来处理这个问题吗？**我应该绘制到某种图像缓冲区，跟踪最近的绘制调用并在可能的情况下复制图像吗？我无法想象这比重新渲染要快得多，但任何见解都值得赞赏:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T19:46:41.597

我在 .NET 世界中遇到过这个问题。双缓冲应该可以解决您的问题。

如果您直接渲染到屏幕上显示的表面上，则您无法控制“显示”实际发生的时间。通常发生的情况是：您开始渲染，尚未完成的图像显示在屏幕上，您完成渲染，然后最终显示在屏幕上。

如果您通过清除背景颜色来开始渲染逻辑，那么这将看起来像一个闪光。双缓冲可以防止这种情况发生，因为它总是从完成的渲染中显示。可能发生的最糟糕的情况是轻微的“撕裂”，但这仅在快速变化的动画中很明显。

即使您只想渲染巨大图像的一部分，您仍然可以使用此技术。只需将您需要的内容渲染到屏幕外表面（这是您想要的可见部分的大小）。然后当你完成后，一举将整个图像绘制到你的显示表面上。

# c# - c#线程和显示更新

> ID：566720
> 
> 赞同：1
> 
> 时间：2009-02-19T19:09:00.483
> 
> 标签：c#, winforms, multithreading

我有一个带有标签和图片框的 Windows 窗体。为了从 Web 服务中检索图像，我使用了一个线程。

用户单击按钮，首先必须显示标签，然后启动新线程以检索图像。这是代码：

```
private void menuItem1_Click(object sender, EventArgs e)

{

etiquetaCargando.Visible = true;

this.Invoke(new System.Threading.ThreadStart(RequestImage));

} 
```

问题是这样的：标签 etiquetaCargando 没有出现。

我在 Compact Framework 上编程。

这是怎么回事？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T19:17:37.230

问题尚不清楚，但是通过使用 Invoke，您违背了将图像请求放在单独的线程上的目的。（您可能会注意到在请求发生时您的界面变得无响应）

相反，最好创建一个新的线程对象，启动它，然后使用 Invoke 设置图像（在检索到图像之后），类似于

```
private void menuItem1_Click(object sender, EventArgs e)
{    
    etiquetaCargando.Visible = true;
    Thread reqThread =
        new Thread(new ThreadStart(RequestImage));
    reqThread.Start();
}

private void RequestImage()
{
    /* Get the image
    ...
    */
    Invoke(SetTheImage, new object[] { theImage });
} 
```

这假设您有一个 SetTheImage 方法，该方法实际上将完成在表单上显示图像的工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T19:18:47.273

你不应该这样称呼：

```
this.Invoke(new System.Threading.ThreadStart(RequestImage)); 
```

我假设您在这里陷入僵局，因为 Invoke 方法会将委托路由到 UI 线程，但您正在等待操作完成。

要让代码在另一个线程上执行，您可以这样做：

```
private void menuItem1_Click(object sender, EventArgs e)
{
    etiquetaCargando.Visible = true;

    Thread t = new Thread(RequestImage);

    t.Start();
} 
```

然后，在您的 RequestImage 方法中，您将调用 Invoke 方法，传递要在 UI 线程上执行的委托，在本例中，传递您下载的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T20:02:05.783

您可以执行以下操作：

```
private void menuItem1_Click(object sender, EventArgs e)
{
    etiquetaCargando.Visible = true;
    Thread t = new Thread(new ThreadStart(RequestImage));

    // NOTE THIS LINE
    // Without this, if your application is closed and the thread isn't,
    // it will leave your program in memory until it does
    t.IsBackground = true;

    this.Invoke(new System.Threading.ThreadStart(RequestImage));
}

private void RequestImage() 
{
    // Do the work here
    // let's assume img is the image you've got

    // Prepare a delegate to invoke
    MethodInvoker m = (MethodInvoker)delegate() {
         myImage.Image = img;
    };

    // Invoke it on the UI thread if needed, otherwise
    // do a straight invoke
    if (this.InvokeRequired)
        this.Invoke(m);
    else 
        m.Invoke();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T07:51:50.450

正如其他人所说，您正在反向使用调用。

我的建议在您的原始处理程序中是这样的：

```
ThreadPool.QueueUserWorkItem(RequestImage) 
```

然后使用 lambda 从 RequestImage 中调用：

```
RequestImage()
{
  ...
  ...

  Invoke(() => { myControl.BackgroundImage = img; myControl.Width = img; etc, etc });
} 
```

或类似的东西。

# jquery - 如何使浏览器窗口平滑地跟随动画元素？

> ID：566722
> 
> 赞同：2
> 
> 时间：2009-02-19T19:09:45.710
> 
> 标签：jquery, animation

在我正在编写的应用程序中，我想让浏览器窗口平滑地跟踪动画以移动和调整大小的 div。

我目前的解决方案是通过结合使用 $().offset() 和 window.scroll 定期更新滚动位置以“更接近” div。

它有效，但它非常不稳定。我认为这是因为动画和滚动不同步。

如何挂钩到 animate 函数以在每一步执行代码。它似乎不是手册中列出的选项。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T21:36:29.870

闪光

（开个玩笑……有点）

您正在尝试做的事情听起来像是真的在推动 DHTML 的极限。即使您确实让它在您的开发机器上运行，对于任何使用较弱计算机的用户来说，它都会失败（或至少不会顺利）。因此，如果您想在所有平台上获得一致流畅的动画跟随，请不要使用 DHTML；使用专为它设计的工具（如 Flash，或者如果您是 .net 用户，则可能是 Silverlight）。

然而，如果出于某种原因你还是想走 DHTML 路线（也许你所有的用户都有糟糕的 PC？），你真的需要解释你是如何制作动画的。我们无法读懂你的想法并神奇地知道你正在使用什么动画库，所以当你问“你如何挂钩到 animate 函数”时，你需要指定“那个”animate 函数实际上是什么。

****编辑****

一位评论者指出您可能正在使用 jQuery（因为您的标签选择）。在这种情况下，您可能想看看我今天早上偶然发现的这篇文章： [http ://www.smashingmagazine.com/2009/02/20/ask-sm-css-smooth-page-scrolling-divs-of- equal-height-dealing-with-ie-6/](http://www.smashingmagazine.com/2009/02/20/ask-sm-css-smooth-page-scrolling-divs-of-equal-height-dealing-with-ie-6/) 专门处理平滑滚动和 jQuery。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T10:15:12.840

我想你知道

```
jQuery(document).bind('scroll', function(){
 //animate your div
}); 
```

绑定，对吧？

# c# - 如何创建具有异步功能的类（类似于 SqlCommand 或 WebRequest）？

> ID：566732
> 
> 赞同：2
> 
> 时间：2009-02-19T19:13:27.220
> 
> 标签：c#, winforms, asynchronous, callback

我最近一直在阅读很多关于异步编程的内容，因为我需要创建一个多线程应用程序。

不幸的是，我似乎无法将我新获得的知识整合到一个有凝聚力和有用的单元中！

我希望有人能给我一些关于如何构建以下内容的指示：

*   我有一个类以指定的顺序执行许多不同（且耗时）的任务。

*   我想在我的 Winforms UI 线程中实例化这个类。例如：

    ```
    TaskRunner tr = new TaskRunner(); 
    ```

*   我希望能够调用 BeginAsync() 方法（就像您可以使用许多 .NET 内置对象一样）。例如：

    ```
    tr.BeginAsync(); 
    ```

*   当某些事件出现时（用于记录、完成等），我希望我的类回调到我的 UI 线程。

*   我希望能够取消我的课程的执行。例如：

    ```
    tr.CancelAsync(); 
    ```

我该如何构建该类的内部结构？我似乎找不到任何关于 SqlCommand 或 WebRequest 内部如何工作的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T19:23:09.153

对于此操作，您希望使用基于事件的异步模式（与 IAsyncResult 设计模式相对）。有关详细信息，请参阅 MSDN 文档中标题为“基于事件的异步模式概述”的部分，该部分位于：

[http://msdn.microsoft.com/en-us/library/wewwczdw.aspx](http://msdn.microsoft.com/en-us/library/wewwczdw.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T19:18:49.693

希望，这个例子会对你有所帮助。

```
public class MessagingServices
{
  public static IAsyncResult BeginReverseEcho (TcpClient client,
                                               AsyncCallback callback,
                                               object userState)
  {
    var re = new ReverseEcho(  );
    re.Begin (client, callback, userState);
    return re;
  }

  public static byte[] EndReverseEcho (IAsyncResult r)
  {
    return ((ReverseEcho)r).End(  );
  }
}

class ReverseEcho : IAsyncResult
{
  volatile TcpClient     _client;
  volatile NetworkStream _stream;
  volatile object        _userState;
  volatile AsyncCallback _callback;
  ManualResetEvent       _waitHandle = new ManualResetEvent (false);
  volatile int           _bytesRead = 0;
  byte[]                 _data = new byte [5000];
  volatile Exception     _exception;

  internal ReverseEcho(  ) { }

  // IAsyncResult members:

  public object AsyncState           { get { return _userState;  } }
  public WaitHandle AsyncWaitHandle  { get { return _waitHandle; } }
  public bool CompletedSynchronously { get { return false;       } }
  public bool IsCompleted
  {
   get { return _waitHandle.WaitOne (0, false); }
  }

  internal void Begin (TcpClient c, AsyncCallback callback, object state)
  {
    _client = c;
    _callback = callback;
    _userState = state;
    try
    {
      _stream = _client.GetStream(  );
      Read(  );
    }
    catch (Exception ex) { ProcessException (ex); }
  }

  internal byte[] End(  )     // Wait for completion + rethrow any error.
  {
    AsyncWaitHandle.WaitOne(  );
    AsyncWaitHandle.Close(  );
    if (_exception != null) throw _exception;
    return _data;
  }

  void Read(  )   // This is always called from an exception-handled method
  {
    _stream.BeginRead (_data, _bytesRead, _data.Length - _bytesRead,
                       ReadCallback, null);
  }

  void ReadCallback (IAsyncResult r)
  {
    try
    {
      int chunkSize = _stream.EndRead (r);
      _bytesRead += chunkSize;
      if (chunkSize > 0 && _bytesRead < _data.Length)
      {
        Read(  );       // More data to read!
        return;
      }
      Array.Reverse (_data);
      _stream.BeginWrite (_data, 0, _data.Length, WriteCallback, null);
    }
    catch (Exception ex) { ProcessException (ex); }
  }

  void WriteCallback (IAsyncResult r)
  {
    try { _stream.EndWrite (r); }
    catch (Exception ex) { ProcessException (ex); return; }
    Cleanup(  );
  }

  void ProcessException (Exception ex)
  {
    _exception = ex;   // This exception will get rethrown when
    Cleanup();         // the consumer calls the End(  ) method.
  }

  void Cleanup(  )
  {
    try
    {
      if (_stream != null) _stream.Close(  );
    }
    catch (Exception ex)
    {
      if (_exception != null) _exception = ex;
    }
    // Signal that we're done and fire the callback.
    _waitHandle.Set(  );
    if (_callback != null) _callback (this);
  }
} 
```

示例取自 Joseph Albahari 的 C# 3.0 in a Nutshell, 3rd Edition；本·阿尔巴哈里

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:31:05.257

您还应该考虑具有大量内置功能的[BackgroundWorker](http://msdn.microsoft.com/en-us/library/hybbz6ke.aspx)对象，用于执行时间密集型或幕后流程。

[本文](http://www.c-sharpcorner.com/UploadFile/LivMic/BGWorker07032007000515AM/BGWorker.aspx)有一个很好的教程，概述了整个过程，包括显示进度条。

# arcgis - 有谁知道如何使 Arc GIS Maps 渲染得更快？

> ID：566735
> 
> 赞同：2
> 
> 时间：2009-02-19T19:14:02.180
> 
> 标签：arcgis

我注意到 Arc Gis 地图的渲染速度非常慢。缩放时，渲染速度很慢。平移时，渲染速度很慢。有没有人有任何建议让地图渲染得更快，类似于谷歌地图和微软虚拟地球。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-18T20:47:42.950

动态地图渲染速度通常受两个因素支配：数据访问和标签布局。进行坐标投影和典型 2D 渲染的速度与从外部源（例如 shapefile 或数据库）读取数据的速度差不多。诀窍是您要加载多少数据来绘制地图？以及需要多长时间才能拿到？复杂的数据库查询可能会导致查询效率低下。查询未编入索引的数据会导致速度变慢。即使您快速找到数据，您也需要知道您正在加载多少数据。您的数据是否包含非常详细的加拿大所有岛屿的单个多部分多边形，但您只渲染怀俄明州的美加边界？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T20:49:50.480

您使用的是哪种产品？桌面 ArcGIS、ArcEngine、ArcGIS 服务器，还是什么？

并不是说它真的很重要。与其在这里提问，我认为您最好搜索[在线 ArcGIS 支持或在](http://support.esri.com/)[ArcGIS 论坛](http://support.esri.com/index.cfm?fa=forums.gateway)上提问。例如，ESRI 的[桌面 ArcGIS 性能提示](http://www.esri.com/news/podcasts/transcripts/performancetipsandtricks_arcgisdesktop.pdf)。据我所知，在这里闲逛的 ArcGIS 专家并不多。

对不起堆栈溢出 - 爱你！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T17:34:10.793

如果您访问 ArcGIS 论坛，您可能会找到答案，但如果其他人遇到此问题，我会在此处插话。

谷歌地图等服务速度快的主要原因是它们预渲染和缓存数据。因此，他们针对各种分辨率进行渲染并将其存储，因此当用户请求数据时，可以快速交付数据的栅格。

ArcMap 确实有一个使用地图缓存的选项，这应该可以加快重复访问视图的速度。有一个可以打开的地图缓存工具栏。ESRI 帮助通常可以很好地帮助您入门，因此只需搜索地图缓存即可。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T09:05:48.120

ArcMap 和 ArcGIS Server 都可以使用加速的缓存。在 ArcMap 的情况下，它可以用于各种数据源，缺点是它在使用非本地资源时会增加网络活动。在 ArcGIS Server 中，缓存是提供类似于 GE 的用户体验的最佳方式。

然后，所有服务器客户端（Web ADF、JavaScript、ArcGIS Explorer）都可以从预先计算的地图缓存中受益——缓存也可以从静态 Web 服务器传送。查看[resources.esri.com](http://resources.esri.com/arcgisserver/)，有完整的 AGS 帮助可用，在其中您可以找到[规划地图缓存](http://webhelp.esri.com/arcgisserver/9.3/dotNet/index.htm#planning_a_map_cache.htm)部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-17T00:05:58.460

地图缓存仅适用于静态地图，不适用于动态图层。动态层通常是瓶颈，绘制和渲染需要很长时间。例如，我有一个包含大约 2000 个位置的动态图层，在 ArcMap 中渲染大约需要 9 秒。在 java ADF、JSF 和 JS 中实现的 GUI 中渲染大约需要 15 秒。任何想法，如何提高动态层的性能？？？

谢谢，唐

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-31T01:15:53.197

是的，有几种方法可以让地图加载得更快。首先，您可以使用尽可能少的要素图层。这样，要加载的数据量会更少，因此加载时间也会更短。如果你是开发应用程序的程序员，我建议尽量减少服务器调用，因为加载故事图像可能很耗时。第三，如果您正在处理大量数据，我建议您查看 HTML5 中的本地存储。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-25T22:13:22.950

老问题，但我相信添加到 ArcGIS 10.0 的*底图图层*功能解决了这些问题。

静态栅格或要素可以添加到底图图层组中，并且在地图/布局视图更改时不会重新计算。它们将被锁定为设定的分辨率，因此在您放大时功能不会锐化。

[https://blogs.esri.com/esri/arcgis/2010/02/02/basemap-layers-new-at-arcgis-10/](https://blogs.esri.com/esri/arcgis/2010/02/02/basemap-layers-new-at-arcgis-10/)

# .net - 为什么 .NET app.config 加载规则与 win2k3 不同？

> ID：566740
> 
> 赞同：5
> 
> 时间：2009-02-19T19:14:58.823
> 
> 标签：.net, app-config

...对于其他平台还有其他警告吗？

我为 win forms 项目创建了一个 app.config，例如 Application.exe。

默认情况下，我希望在运行时我的应用程序会查找名为 Application.exe.config 的文件。

但似乎有例外，例如在 Windows Server 2003 环境中，应用程序将查找**Application.config**。

**在 Windows Server 2003 中搜索的配置文件的完整路径不同，这是为什么呢？**

这些 cosmic app.config 加载规则的定义在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-25T00:49:50.857

I don't have the details at hand, but I believe a service pack or point version of the .NET Framework allowed `ExeName.config` to be an option, and that is now still supported for backward compatibility, but more recent service packs have returned to defaulting to `ExeName.exe.config` for all systems.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T19:57:03.280

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms229689.aspx)：

> 应用程序配置文件的名称和位置取决于应用程序的主机，它可以是以下之一：
> 
> 可执行托管应用程序。
> 
> 由可执行主机托管的应用程序的配置文件与应用程序位于同一目录中。配置文件的名称是应用程序的名称，扩展名为 .config。例如，名为 myApp.exe 的应用程序可以与名为**myApp.exe.config**的配置文件相关联。

[并且](http://msdn.microsoft.com/en-us/library/8f6988ab(VS.80).aspx)

> 对于客户端可执行文件，应用程序配置文件与应用程序的可执行文件位于同一目录中，并且与带有 .config 扩展名的可执行文件具有相同的基本名称。例如，C:\Program Files\Myapp\Myapp.exe 的配置文件是 C:\Program Files\Myapp\Myapp.exe.config。

# c# - 你能设置 VS2008 在 try-catch 语句中出现错误吗？

> ID：566742
> 
> 赞同：12
> 
> 时间：2009-02-19T19:15:10.913
> 
> 标签：c#, vb.net, visual-studio, debugging, exception

我喜欢 VB6 的一件事是，无论您设置了何种错误处理，您都可以告诉开发环境中断所有错误。是否可以在 VS2008 中做同样的事情，以便调试器在任何错误上停止，即使它发生在 try-catch 语句中？

当您正在处理一个包含 500 条记录的文件并且其中一条记录失败时，这个问题尤其困难 - 谁知道是哪一条 - 您不想修改代码，以便在 for 循环之外初始化您的 for 计数器 -从长远来看，这是草率的。您只是希望调试器知道由于您放置在某处的某些设置而停止。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-19T19:17:32.330

是的，进入“调试”菜单，选择“异常...”，检查“公共语言运行时异常”的“抛出”

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-19T19:17:52.063

当然，按 Ctrl-Alt-E 调出异常窗口并勾选Common Language Runtime Exceptions 上的**Thrown复选框**

这将停止执行，打开引发异常的源代码，并通过消息窗口告诉您它是什么错误，并指向它引发的行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T21:33:07.810

我发现在工作中的项目调试期间每个人都在谈论的复选框。我打开它，突然间我把所有这些异常都抛出了！结果发现另一个团队的开发人员一直在使用 Try-Catch 作为掩码，以应对容易预防的情况（但懒得困住自己）。坏的！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-19T19:19:53.620

在 Visual Studio 中，您可以转到 Debug -> Exceptions... 并选中任何特定异常或您希望 VS 在生成时中断的一类异常的复选框。

有五类异常 - C++、公共语言运行时、托管调试助手、本机运行时检查和 Win32。大多数情况下，您对 CLR 感兴趣，但如果您正在执行 COM 互操作，您可能还需要其他一些。

# python - 如何在 Python 中获取 Linux 控制台窗口的宽度

> ID：566746
> 
> 赞同：307
> 
> 时间：2009-02-19T19:17:19.443
> 
> 标签：python, linux, console, terminal, width

python中有没有办法以编程方式确定控制台的宽度？我的意思是在一行中不换行的字符数，而不是窗口的像素宽度。

**编辑**

寻找适用于 Linux 的解决方案

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2013-01-20T07:25:34.203

不知道为什么它在模块`shutil`中，但它在 Python 3.3 中出现，[查询输出终端的大小](http://docs.python.org/3/library/shutil.html#querying-the-size-of-the-output-terminal)：

```
>>> import shutil
>>> shutil.get_terminal_size((80, 20))  # pass fallback
os.terminal_size(columns=87, lines=23)  # returns a named-tuple 
```

低级实现在 os 模块中。也适用于 Windows。

现在可用于 Python 3.2 及以下版本的反向移植：

*   [https://pypi.org/project/backports.shutil_get_terminal_size/](https://pypi.org/project/backports.shutil_get_terminal_size/)

* * *

## 回答 #2

> 赞同：276
> 
> 时间：2009-06-03T09:59:34.893

```
import os
rows, columns = os.popen('stty size', 'r').read().split() 
```

使用“stty size”命令，根据[python 邮件列表上的一个线程，该](http://mail.python.org/pipermail/python-list/2000-May/033312.html)命令在 linux 上是相当普遍的。它将“stty size”命令作为文件打开，从中“读取”，并使用简单的字符串拆分来分隔坐标。

与 os.environ["COLUMNS"] 值不同（尽管使用 bash 作为我的标准 shell，我无法访问该值），数据也将是最新的，而我相信 os.environ["COLUMNS"] value 仅在 python 解释器启动时有效（假设用户从那时起调整了窗口大小）。

（请参阅@GringoSuave 的回答，了解如何在 python 3.3+ 上执行此操作）

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2009-02-19T19:18:11.190

采用

```
import console
(width, height) = console.getTerminalSize()

print "Your terminal's width is: %d" % width 
```

**编辑**：哦，对不起。那不是python标准库，这是console.py的来源（我不知道它来自哪里）。

该模块似乎是这样工作的：它检查是否`termcap`可用，如果是。它使用它；如果不是，它会检查终端是否支持特殊`ioctl`调用并且它也不起作用，它会检查一些 shell 导出的环境变量。这可能仅适用于 UNIX。

```
def getTerminalSize():
    import os
    env = os.environ
    def ioctl_GWINSZ(fd):
        try:
            import fcntl, termios, struct, os
            cr = struct.unpack('hh', fcntl.ioctl(fd, termios.TIOCGWINSZ,
        '1234'))
        except:
            return
        return cr
    cr = ioctl_GWINSZ(0) or ioctl_GWINSZ(1) or ioctl_GWINSZ(2)
    if not cr:
        try:
            fd = os.open(os.ctermid(), os.O_RDONLY)
            cr = ioctl_GWINSZ(fd)
            os.close(fd)
        except:
            pass
    if not cr:
        cr = (env.get('LINES', 25), env.get('COLUMNS', 80))

        ### Use get(key[, default]) instead of a try/catch
        #try:
        #    cr = (env['LINES'], env['COLUMNS'])
        #except:
        #    cr = (25, 80)
    return int(cr[1]), int(cr[0]) 
```

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2010-06-09T22:36:38.127

上面的代码在我的 linux 上没有返回正确的结果，因为 winsize-struct 有 4 条无符号短裤，而不是 2 条有符号短裤：

```
def terminal_size():
    import fcntl, termios, struct
    h, w, hp, wp = struct.unpack('HHHH',
        fcntl.ioctl(0, termios.TIOCGWINSZ,
        struct.pack('HHHH', 0, 0, 0, 0)))
    return w, h 
```

hp 和 hp 应该包含像素宽度和高度，但不要。

* * *

## 回答 #5

> 赞同：48
> 
> 时间：2017-01-26T00:57:14.150

它是：

```
import os
columns, rows = os.get_terminal_size(0)
# or
import shutil
columns, rows = shutil.get_terminal_size() 
```

该`shutil`函数只是一个包装器，`os`它捕获一些错误并设置回退，但是它有一个巨大的警告 -**它在管道时会中断！**，这是一笔相当大的交易。
在管道使用时获得端子尺寸`os.get_terminal_size(0)`。

第一个参数`0`是一个参数，指示应该使用标准输入文件描述符而不是默认标准输出。我们想使用标准输入，因为标准输出在通过管道传输时会自行分离，在这种情况下会引发错误。

我试图弄清楚什么时候使用 stdout 而不是 stdin 参数才有意义，但不知道为什么它是这里的默认值。

* * *

## 回答 #6

> 赞同：39
> 
> 时间：2011-07-01T16:23:02.727

我四处搜索并在以下位置找到了适用于 Windows 的解决方案：

[http://code.activestate.com/recipes/440694-determine-size-of-console-window-on-windows/](http://code.activestate.com/recipes/440694-determine-size-of-console-window-on-windows/)

以及这里的 linux 解决方案。

所以这是一个适用于 linux、os x 和 windows/cygwin 的版本：

```
""" getTerminalSize()
 - get width and height of console
 - works on linux,os x,windows,cygwin(windows)
"""

__all__=['getTerminalSize']

def getTerminalSize():
   import platform
   current_os = platform.system()
   tuple_xy=None
   if current_os == 'Windows':
       tuple_xy = _getTerminalSize_windows()
       if tuple_xy is None:
          tuple_xy = _getTerminalSize_tput()
          # needed for window's python in cygwin's xterm!
   if current_os == 'Linux' or current_os == 'Darwin' or  current_os.startswith('CYGWIN'):
       tuple_xy = _getTerminalSize_linux()
   if tuple_xy is None:
       print "default"
       tuple_xy = (80, 25)      # default value
   return tuple_xy

def _getTerminalSize_windows():
    res=None
    try:
        from ctypes import windll, create_string_buffer

        # stdin handle is -10
        # stdout handle is -11
        # stderr handle is -12

        h = windll.kernel32.GetStdHandle(-12)
        csbi = create_string_buffer(22)
        res = windll.kernel32.GetConsoleScreenBufferInfo(h, csbi)
    except:
        return None
    if res:
        import struct
        (bufx, bufy, curx, cury, wattr,
         left, top, right, bottom, maxx, maxy) = struct.unpack("hhhhHhhhhhh", csbi.raw)
        sizex = right - left + 1
        sizey = bottom - top + 1
        return sizex, sizey
    else:
        return None

def _getTerminalSize_tput():
    # get terminal width
    # src: http://stackoverflow.com/questions/263890/how-do-i-find-the-width-height-of-a-terminal-window
    try:
       import subprocess
       proc=subprocess.Popen(["tput", "cols"],stdin=subprocess.PIPE,stdout=subprocess.PIPE)
       output=proc.communicate(input=None)
       cols=int(output[0])
       proc=subprocess.Popen(["tput", "lines"],stdin=subprocess.PIPE,stdout=subprocess.PIPE)
       output=proc.communicate(input=None)
       rows=int(output[0])
       return (cols,rows)
    except:
       return None

def _getTerminalSize_linux():
    def ioctl_GWINSZ(fd):
        try:
            import fcntl, termios, struct, os
            cr = struct.unpack('hh', fcntl.ioctl(fd, termios.TIOCGWINSZ,'1234'))
        except:
            return None
        return cr
    cr = ioctl_GWINSZ(0) or ioctl_GWINSZ(1) or ioctl_GWINSZ(2)
    if not cr:
        try:
            fd = os.open(os.ctermid(), os.O_RDONLY)
            cr = ioctl_GWINSZ(fd)
            os.close(fd)
        except:
            pass
    if not cr:
        try:
            cr = (env['LINES'], env['COLUMNS'])
        except:
            return None
    return int(cr[1]), int(cr[0])

if __name__ == "__main__":
    sizex,sizey=getTerminalSize()
    print  'width =',sizex,'height =',sizey 
```

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2014-04-27T23:24:31.590

从 Python 3.3 开始，它很简单： [https ://docs.python.org/3/library/os.html#querying-the-size-of-a-terminal](https://docs.python.org/3/library/os.html#querying-the-size-of-a-terminal)

```
>>> import os
>>> ts = os.get_terminal_size()
>>> ts.lines
24
>>> ts.columns
80 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-06-16T07:23:51.490

看起来该代码存在一些问题，Johannes：

*   `getTerminalSize`需要`import os`
*   什么是`env`？看起来像`os.environ`。

`lines`另外，为什么要`cols`在返回之前切换？如果`TIOCGWINSZ`和`stty`两者都说`lines`then `cols`，我说就这样吧。在我注意到不一致之前，这让我困惑了 10 分钟。

Sridhar，我在管道输出时没有收到该错误。我很确定它在 try-except 中被正确捕获。

帕斯卡，`"HHHH"`在我的机器上`"hh"`不起作用，但可以。我很难找到该功能的文档。看起来它依赖于平台。

乔赫姆，合并。

这是我的版本：

```
def getTerminalSize():
    """
    returns (lines:int, cols:int)
    """
    import os, struct
    def ioctl_GWINSZ(fd):
        import fcntl, termios
        return struct.unpack("hh", fcntl.ioctl(fd, termios.TIOCGWINSZ, "1234"))
    # try stdin, stdout, stderr
    for fd in (0, 1, 2):
        try:
            return ioctl_GWINSZ(fd)
        except:
            pass
    # try os.ctermid()
    try:
        fd = os.open(os.ctermid(), os.O_RDONLY)
        try:
            return ioctl_GWINSZ(fd)
        finally:
            os.close(fd)
    except:
        pass
    # try `stty size`
    try:
        return tuple(int(x) for x in os.popen("stty size", "r").read().split())
    except:
        pass
    # try environment variables
    try:
        return tuple(int(os.getenv(var)) for var in ("LINES", "COLUMNS"))
    except:
        pass
    # i give up. return default.
    return (25, 80) 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-05-31T22:26:04.610

如果调用此脚本时没有控制终端，这里的许多 Python 2 实现都会失败。你可以检查 sys.stdout.isatty() 来确定这是否真的是一个终端，但这会排除一堆情况，所以我相信确定终端大小的最 Pythonic 方法是使用内置的 curses 包。

```
import curses
w = curses.initscr()
height, width = w.getmaxyx() 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-09-08T18:36:32.630

我正在尝试从这里调用的解决方案`stty size`：

```
columns = int(subprocess.check_output(['stty', 'size']).split()[1]) 
```

但是，这对我来说失败了，因为我正在编写一个脚本，该脚本期望在标准输入上重定向输入，并且`stty`在这种情况下会抱怨“标准输入不是终端”。

我能够让它像这样工作：

```
with open('/dev/tty') as tty:
    height, width = subprocess.check_output(['stty', 'size'], stdin=tty).split() 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-12-23T12:00:41.190

试试**“祝福”**

我一直在寻找同样的东西。它非常易于使用，并提供了在终端中进行着色、造型和定位的工具。您需要的很简单：

```
from blessings import Terminal

t = Terminal()

w = t.width
h = t.height 
```

在 Linux 中像魅力一样工作。（我不确定 MacOSX 和 Windows）

[在此处](https://pypi.python.org/pypi/blessings/)下载和文档

或者您可以使用 pip 安装它：

```
pip install blessings 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-12-22T15:58:18.470

如果您使用的是 Python 3.3 或更高版本，我会推荐已推荐的内置`get_terminal_size()`版本。但是，如果您坚持使用旧版本并想要一种简单的跨平台方式来执行此操作，则可以使用[asciimatics](https://github.com/peterbrittain/asciimatics)。这个包支持回到 2.7 的 Python 版本，并使用与上面建议的选项类似的选项来获取当前的终端/控制台大小。

只需构造您的`Screen`类并使用该`dimensions`属性来获取高度和宽度。这已被证明可以在 Linux、OSX 和 Windows 上运行。

哦 - 在这里完全披露：我是作者，所以如果你在让它工作时遇到任何问题，请随时打开一个新问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-22T18:30:16.880

@rennual 的回答效果很好，但它有一个问题：`os.popen` [is now deprecated](https://docs.python.org/2/library/os.html#os.popen)。应该使用该`subprocess`模块，所以这是@rennual 代码的一个版本，它使用`subprocess`并直接回答问题（通过将列宽直接指定为`int`：

```
import subprocess

columns = int(subprocess.check_output(['stty', 'size']).split()[1]) 
```

在 OS X 10.9 上测试

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2011-04-19T03:33:30.757

这是一个应该兼容 Linux 和 Solaris 的版​​本。基于[madchine](https://stackoverflow.com/users/68595/madchine)的帖子和评论。需要子流程模块。

```
定义术语大小（）：
    导入 shlex，子流程，重新
    输出 = subprocess.check_output(shlex.split('/bin/stty -a'))
    m = re.search('rows\D+(?P\d+); columns\D+(?P\d+);', 输出)
    如果米：
        返回 m.group('rows'), m.group('columns')
    raise OSError('Bad response: %s' % (output))

```

```
>>> 术语大小（）
('40', '100')

```

# .net - 你调用的对象是空的

> ID：566761
> 
> 赞同：1
> 
> 时间：2009-02-19T19:20:58.487
> 
> 标签：.net, exception, httpwebrequest

我看到以下异常。

> System.NullReferenceException：对象引用未设置为对象的实例。在 System.Web.Util.StringUtil.memcpyimpl(Byte* src, Byte* dest, Int32 len) 在 System.Web.Util.StringUtil.UnsafeStringCopy(String src, Int32 srcIndex, Char[] dest, Int32 destIndex, Int32 len)在 System.Web.HttpWriter.Write(String s) 在 System.Web.HttpResponse.Write(String s)

我已经对我正在响应的上下文进行了以下检查。

```
return !(context == null || context.Response == null ||
    context.Response.OutputStream == null ||
    !context.Response.OutputStream.CanWrite); 
```

任何人都可以暗示可能导致这种情况的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T19:27:00.397

你确定那是错误所在吗？看起来异常是从 HttpResponse 的 Write 方法开始的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T20:20:45.577

我在使用异步处理程序和模块时遇到了这个错误。我的问题是我会`ThreadPool.QueueUserWorkItem`在`HttpHandler's EndProcessRequest`方法中使用，在工作项回调中我会尝试使用`HttpContext`. 问题是一旦`EndProcessRequest`返回给调用者（但工作项回调尚未被调用），`HttpContext`对象实例不再是“我的”并且 ASP.NET 已取得控制权并将其拆除。有关详细信息，请参阅[http://odetocode.com/articles/112.aspx](http://odetocode.com/articles/112.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:26:19.493

为什么还要麻烦所有这些检查？为什么不直接写入输出流并完成它呢？

另外，这个调用是在 ASP.NET 处理管道的哪个位置进行的？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T19:31:52.400

我认为你的错误在其他地方，但我建议更直接地写这个表达式，而不用否定：

```
return context != null && context.Response != null &&
    context.Response.OutputStream != null &&
    context.Response.OutputStream.CanWrite; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T19:33:52.553

如果您尝试将空对象实际写入缓冲区 IE，则可能会发生这种情况：

```
context.Response.OutputStream.Write(null, 0, 0); 
```

您也可以将其表示为...

```
return (context != null && context.Response != null &&
    context.Response.OutputStream != null &&
    context.Response.OutputStream.CanWrite); 
```

# ruby-on-rails - 应该：测试控制器过滤器

> ID：566763
> 
> 赞同：1
> 
> 时间：2009-02-19T19:22:55.660
> 
> 标签：ruby-on-rails, integration-testing, filter, shoulda

所以我决定调查一下 Rails 的测试状态。在阅读了这里关于 Rails 的测试文档如何残暴的一些公认答案后，我开始同意。到目前为止，我显然不在了解 Rails 测试的人群中——尽管我对框架非常了解，或者我是这么认为的。

我读过Shouda 是一个很好的插件，所以我正在使用它。我的第一个测试：“确保方法需要一个 ID 参数”......嗯，这是有道理的；我想确保我的控制器上的 before_filter :validate_id 确实有效。这是测试我的索引的 GET 是否按预期方式工作所需的 3 步中的第 1 步。失败！显然，测试环境的运行方式与正常的 Rails 堆栈不同：

```
...
lib/action_controller/base.rb:524:in `process_without_filters'
... 
```

当 ActionController::TestCase 使用 get {} 时，我到处检查几乎没有包含过滤器的信息。我在哪里可以加入“Rails 测试人员俱乐部”，这样我才能解决这个问题？

```
 context "GET :index requires id" do

    setup {      
      get :index
    }

    should_redirect_to('/') { }

  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T22:47:04.240

您确定失败与 before_filters 有什么关系吗？我认为不会。进一步查找堆栈以查找其他错误...我可以使用登录要求测试我的应用程序没有问题。

您断言该索引需要一个 id ......但在没有一个的情况下请求它。是因为没有id而抛出错误吗？也许你需要抓住它，或者用 assert_raises 测试故障模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T02:08:48.113

我同意安德鲁的观点，问题可能出在其他地方。我有很多功能测试可以与带有 before_filters 的控制器一起使用，并且从未遇到您指定的问题。

# html - 在您的网站上显示“升级浏览器”横幅的最佳 HTML 是什么？

> ID：566769
> 
> 赞同：0
> 
> 时间：2009-02-19T19:24:44.503
> 
> 标签：html

什么是最好的 HTML 放入您的网站，通知某些浏览器的用户他们应该升级到不同的浏览器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-19T19:36:37.167

据我所知，只有 IE 识别由以下人员完成的有条件和有针对性的评论：

```
<!--[if lte IE 6]>
<div id="upgrade"><span>Like a growing number across the Web, this site no longer supports Internet Explorer 6 and your viewing experience may be affected. We recommend that you download the latest stable release of <a href="http://www.microsoft.com/windows/downloads/ie/getitnow.mspx">Internet Explorer 7</a> free of charge by <a href="http://www.microsoft.com/windows/downloads/ie/getitnow.mspx">clicking here</a>.</span></div>
<![endif]--> 
```

见： http: [//msdn.microsoft.com/en-us/library/ms537512 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-16T20:35:19.950

```
<!--[if IE]><big><blink><marquee>Upgrade to $browser</marquee></blink></big><![endif]--> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T22:27:11.807

对我来说似乎是在浪费时间。

如果我错了，请纠正我，但我认为使用 IE6 的人正在使用它，因为：

1.  他们不允许更改它（公司计算机），因此他们不太可能安装另一个浏览器（而不是更新）。
2.  他们有无法更新的非法 Windows 版本。

据我了解，尤其是第一组仍然很大，所以如果您想针对这些人，您的网站也应该在 IE6 中运行。故事结局。

现在我意识到您并不是说您的网站不能在 IE6 上运行，而是烦人的消息只会让人们望而却步，尤其是如果这是他们无能为力的消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T19:48:25.167

坦率地说，这是用户的问题，而不是你的问题。实际上，许多用户并没有意识到这个问题。我个人会使用条件注释来通知 IE6 用户可以进行升级。您可以提供替代方案，但让用户自己决定哪个浏览器适合他们。

如果您不想继续支持旧浏览器，我不怪您。最多只支持每个流行浏览器的当前和以前的版本。归根结底，只要您的文本可读，您就已经履行了您的义务。

# excel - 将单击 VBA 函数分配给 Excel 用户窗体上动态创建的按钮

> ID：566770
> 
> 赞同：10
> 
> 时间：2009-02-19T19:24:51.180
> 
> 标签：excel, vba, event-handling, userform

我正在使用以下代码在 Excel 用户窗体上动态创建按钮：

```
With Me.CurrentFrame.Controls.Add("Forms.CommandButton.1")
    .Caption = "XYZ"
    .name = "AButton"
    .Font.Bold = True
    .ForeColor = &HFF&
    ... blah blah blah
End With 
```

我想指定一个函数在单击这些按钮时运行，但我找不到直接的方法来执行此操作，因为按钮本身没有属性。

有没有办法使用上述成语做到这一点？我应该以不同的方式处理这整个事情吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-31T19:20:30.937

在 Excel 表单中动态添加控件事件；您需要首先在类模块中添加事件。对于我的示例，我将添加一个名为 clsTEST 的类模块，其中包含一个事件 btn_click()

```
 '#### CLASS NAMED clsTEST
    Public WithEvents btn As MSForms.CommandButton
    Public frm As UserForm

    Dim iCount As Long

    Private Sub btn_Click()

    iCount = IIf(iCount < 1, 1, iCount + 1)
    btn.Caption = "Count " & Str(iCount)

End Sub
'### END CLASS 
```

正如您所看到的，唯一要做的就是将按钮上的标题设置为您单击它的次数。接下来，在表单代码中输入以下内容：

```
 Dim mColButtons As New Collection    '## SET A NEW COLLECTION

    Private Sub UserForm_Activate()
    '
    Dim btnEvent As clsTEST
    Dim ctl As MSForms.Control
    '
    Set ctl = Me.Controls.Add("Forms.CommandButton.1")
    '
    With ctl
    .Caption = "XYZ"
    .Name = "AButton"
    END With
    '
    Set btnEvent = new clsTEST   
    Set btnEvent.btn = ctl
    set btnEvent.frm = Me
    '
    mColButtons.add btnEvent
    'End Sub 
```

当您激活表单时，它将创建一个按钮。每次单击按钮时，标题都会更改。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-19T20:18:48.280

您需要为每个按钮动态创建代码/事件处理程序。

这需要做一些事情 - 见这里： http: [//navpadexcel.blogspot.com/2006/11/httpwwwcpearsoncomexcelvbehtm.html](http://www.cpearson.com/excel/vbe.aspx)

一个更好的方法可能是提前在表单上创建一堆按钮（你认为你需要多少）。同时创建事件处理程序代码。最初将它们全部隐藏。

然后，当您的表单打开时，您可以动态更改按钮标题，使其可见并四处移动。您最初创建的事件代码将按预期链接到激活的按钮。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-05T01:42:02.943

下面的代码应该可以工作

```
Dim NewButton As OLEObject
Dim CodeModule As Object

Set NewButton = ActiveSheet.OLEObjects.Add(ClassType:="Forms.CommandButton.1", _
    Link:=False, DisplayAsIcon:=False, Left:=52.5, Top:=Hght, _
    Width:=202.5, Height:=26.25)
NewButton.Object.Caption = "Click Me!"
Set CodeModule = ActiveWorkbook.VBProject.VBComponents.VBE.ActiveCodePane.CodeModule
CodeModule.InsertLines CodeModule.CreateEventProc("Click", NewButton.Name) + 1, vbTab & "MsgBox ""Hello world""" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-06T18:19:13.210

```
Sub Oval1_Click()
    file = ActiveWorkbook.Name
    Set Output = Workbooks.Add()
    ActiveWorkbook.SaveAs Filename:="Try.xls"        
    Sheets(1).Select        
    ActiveSheet.Buttons.Add(460, 10, 140, 30).Select
    ActiveSheet.Buttons.Text = "DATA"      
    ActiveSheet.Shapes("Button 1").Select
    Selection.OnAction = "Book1.xlsm!data_Click"
End Sub

Sub data_Click()      
    MsgBox "you have clicked me"       
    ActiveSheet.DrawingObjects.Delete        
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-09T18:59:28.433

我也一直在看这个。似乎您可以使用 onClick 属性运行宏：

```
Command1.OnClick = "Macro1" 
```

然后使用该名称创建一个运行所需功能的宏。这是我解决这个问题的方法，直到我找到更好的东西。

# c - CMake：添加构建目录以包含路径

> ID：566785
> 
> 赞同：10
> 
> 时间：2009-02-19T19:29:31.530
> 
> 标签：c, cmake

我正在寻找将构建目录（不同于我的源目录，一个 git 存储库）添加到 gcc 的包含路径的好方法，以便在汇编。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-19T19:44:55.657

我在寻找

```
include_directories (${CMAKE_BINARY_DIR}) 
```

在源外构建的情况下添加构建目录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-12-04T21:58:02.163

比所选答案更现代的方法是使用

```
set(CMAKE_INCLUDE_CURRENT_DIR ON) 
```

[CMAKE_INCLUDE_CURRENT_DIR](https://cmake.org/cmake/help/v3.11/variable/CMAKE_INCLUDE_CURRENT_DIR.html) - 自动将当前源和构建目录添加到包含路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T19:41:23.227

你在寻找这个 -I$(DIR) 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-31T18:21:15.907

还有`${CMAKE_CURRENT_BINARY_DIR}`一个解决当前活动的构建目录中的子目录。

如果您的源位于子目录中，例如，`src/`并且您想要包含从中生成的文件，`src/CMakeLists.txt`那么 using`${CMAKE_CURRENT_BINARY_DIR}`可能就是您要查找的内容。

# cocoa - 突出显示 NSToolbarItems

> ID：566793
> 
> 赞同：8
> 
> 时间：2009-02-19T19:31:05.350
> 
> 标签：cocoa, nstoolbar

我想突出显示选定的内容`NSToolbarItem`，例如在 Adium 中（见屏幕截图）。

[突出显示 http://a2.s3.p.quickshareit.com/files/screenshot_b28b67ba9411513d6.png](http://a2.s3.p.quickshareit.com/files/screenshot_b28b67ba9411513d6.png)

有没有简单的方法？如果没有，请告诉我困难的那个。=)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-19T19:52:22.977

要扩展 Chuck 的答案，您只需将控制器设为 NSToolBar 的委托并在其中实现 toolbarSelectableItemIdentifiers: 委托方法。例如，以下实现将让您在每个工具栏项上保留选择突出显示，但标记为“检查”的项除外：

```
- (NSArray *)toolbarSelectableItemIdentifiers:(NSToolbar *)toolbar
{
    NSMutableArray *allIdentifiers = [[NSMutableArray alloc] init];

    for (NSToolbarItem *toolbarItem in [toolbar items])
    {
        if (![[toolbarItem label] isEqualToString:@"Inspect"])
            [allIdentifiers addObject:[toolbarItem itemIdentifier]];
    }

    return [allIdentifiers autorelease];
} 
```

当我做这样的事情时，我将 allIdentifiers 数组缓存在一个实例变量中，这样我只需要做一次数组构造。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-07-07T06:39:27.453

如果您在 Interface Builder 中制作了工具栏，则可以单击各个 NSToolbarItems 并检查 Inspector 中的 Selectable 框以获取您想要的外观。无需代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-19T19:37:40.550

请参阅Cocoa 文档中的[可选工具栏项](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/Toolbars/Tasks/SelectableItems.html#//apple_ref/doc/uid/20002308-CJBGHHGG)。

# c# - C# begin*() 方法与服务器的线程池

> ID：566798
> 
> 赞同：5
> 
> 时间：2009-02-19T19:31:32.277
> 
> 标签：c#, networking, sockets

对于用 C# 制作可扩展的多用户服务器，这两种服务器中哪一种效率更高？您可以在此处查看使用 begin* 方法（如 beginaccept、beginsend）的异步服务器示例，并在[此处查看](http://www.java2s.com/Code/CSharp/Network/AsyncTcpServer.htm)[线](http://pastebin.com/m524c477e)​​程池实现。

我知道线程池是什么以及它是如何工作的，所以我非常了解该实现是如何工作的。但是异步服务器呢？这会为每个发送、接收和连接事件生成一个线程吗？与线程池相比，它的效率如何？

我所说的效率只是指速度和内存使用的一般平衡。

## 编辑：

有人建议我使用 begin() 方法，但是当它们产生一个新线程来处理发送、接收或连接事件时，它们不会产生开销吗？还是他们最终使用某种内部线程池？如果没有，有没有办法让它使用线程池，或者我应该滚动我自己的异步套接字服务器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T19:35:02.350

TcpServer 实现会更好，因为它将利用 I/O 完成端口来执行异步工作，而线程池实现通常必须烧一个线程来等待正在接受的连接。

一般来说，在文件、数据库、套接字（对它们具有底层非托管实现的事物）等事物上使用异步方法，因为它们将利用 I/O 完成端口进行工作，这通常比将代码移动到线程池。但是，它会增加代码的复杂性，因此您必须考虑到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T02:01:53.290

如果通过可扩展，您的意思是真正大量的连接，您还应该考虑使用线程池之外的许多其他方面。

1) 如果您使用的是 .NET3.5，请考虑使用 SocketAsyncEventArgs 而不是 BeginXXX/EndXXX。[MSDN Magazine](http://msdn.microsoft.com/en-us/magazine/cc163356.aspx)中描述了该方法。这些允许更有效地调度和处理底层异步 i/o。

2)[非常仔细地考虑您的内存使用情况](http://codebetter.com/blogs/gregyoung/archive/2007/06/18/async-sockets-and-buffer-management.aspx)。为异步 i/o 分配的 Byte[] 缓冲区被固定，迫使 GC 在压缩阶段绕过它们，这反过来可能导致碎片和负载不足的 OutOfMemoryExceptions。此外，您还考虑了异步 i/o 的较低级别的本机问题，例如非分页池中的可用内存。

一些可用的技术是为所有待处理的接收使用单个共享的零字节缓冲区，并为实际传输数据的 I/O 使用池缓冲区（来自未压缩的内存 - LOH 或本机堆）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T19:43:48.310

更好的方法可能是使用 Jeffery Richter 的[AsyncEnumerator](http://msdn.microsoft.com/en-us/magazine/cc546608.aspx)。它是[Wintellect PowerThreading 库](http://wintellect.com/PowerThreading.aspx)的一部分。您可以在第 9 频道[观看有关其工作原理的视频演示](http://channel9.msdn.com/posts/Charles/Jeffrey-Richter-and-his-AsyncEnumerator/)。

我在两个项目中使用它，它的好处是它允许您在许多请求之间共享线程池的有限资源，因此它不会为每个请求占用线程。你得到两全其美。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T02:34:51.743

关于您的编辑，开始/结束调用通常不会产生线程。这几乎就是它们存在的原因。它们允许您以最有效的方式启动预期异步运行的操作。对于套接字，为什么要产生一个线程？当套接字上发生某些事情时，操作系统会通知您，因此也不需要线程在监听中徘徊。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T19:38:26.103

我更喜欢线程池，因为它可以帮助我管理我在系统级别约束的线程数。

您需要澄清效率的含义：

1.  更少的内存
2.  速度
3.  响应时间/吞吐量

您需要使用

1.  使用该程序的平均用户数
2.  硬件

在进行设计选择之前，首先确定基本要求。

# apache-flex - Flex 数据绑定函数

> ID：566800
> 
> 赞同：1
> 
> 时间：2009-02-19T19:32:19.153
> 
> 标签：apache-flex, actionscript-3, data-binding

有谁知道如何以编程方式将属性绑定到不是 getter 的函数？IE：我有一个函数，它根据您传递的标识符返回翻译后的字符串。我如何在 AS3 而不是 MXML 中做到这一点？（原因是 - 我有一个基于 XML 呈现的动态布局，因此以编程方式创建和添加所有子项）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T11:13:51.203

如果要绑定函数的结果，则必须提及函数结果更改时将触发的事件类型（参见第 2 点）。

```
private var foo:int;

[Bindable(event="myCustomFunctionBinding")]
public function myFunction():String
{
    return "This is foo :" + foo;
} 
```

然后，当您希望所有元素更新绑定值时，您必须自己调度事件：

```
private function bar():void
{
    foo++;
    dispatchEvent(new Event("myCustomFunctionBinding"));
} 
```

在这种情况下，您可以像这样绑定：

```
<mx:TextArea text="{myClass.myFunction()}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T13:57:09.840

我不确定这是你要找的东西，但我用这种方式做了类似的事情：

假设您已经使用您的函数声明了一个标签：

```
<mx:Label text="{LocaleUtil.getMessage('label.description')}"/> 
```

该`getMessage`函数根据选定的区域设置读取 XML 文件。

如果用户更改了区域设置，您应该调用`executeChildBindings(true)`任何容器或整个应用程序：

```
this.parentApplication.executeChildBindings(true); 
```

这将迫使每个孩子`UIComponent`再次执行绑定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T02:44:32.623

您可以使用调用 setter 函数`BindingUtils.bindSetter()`。您可以使用它来调用 setter 函数，该函数调用您的翻译函数并将返回值设置到指定位置。不幸的是，您不能像使用`BindingUtils.bindProperty()`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T22:29:25.060

好吧，老实说，我自己设法解决了这个问题：

```
public function loadStringBinding(aIdentifier:String, aField:UIComponent, aProperty:String, aAddtlChars:String = null):Function 
{
    return function():void {
        var str:String;
        if(aAddtlChars)
        {
            str = aAddtlChars;
        }
        else
        {
            str = '';
        }
    if(_localePacks.get(currentLocale))
    {
        if(XML(_localePacks.get(currentLocale)).translatedString.(@identifier==aIdentifier).@translation.toString().length > 0)
        {
            aField[aProperty] =  XML(_localePacks.get(currentLocale)).translatedString.(@identifier==aIdentifier).@translation + str;
            return;
        }
        else
        {
            aField[aProperty] =  aIdentifier + str;
            return;
        }
    }
    else
    {
        //TODO: Replace with webservice call to get individual string
    }

    aField[aProperty] =  'No locale pack' + str; 
    return;
    }
} 
```

它的作用是返回它绑定到的函数，所以我可以将它传递给我希望属性绑定到的任何组件。它的实现如下：

```
_currentWatchers.addItem(BindingUtils.bindSetter(LocaleManager.instance().loadStringBinding('firstName, myCFormItem, 'label', '*'), LocaleManager.instance(), 'newLocale')); 
```

我敢肯定，这对于任何人来说都没有任何意义，因为其余代码不在这里，而且它有点涉及应用程序，但只知道解决方案是 bindSetter 函数将函数作为第一个参数，所以我创建了一个函数，该函数创建了一个执行我想要的绑定的函数。如果这对其他人有意义..太棒了！感谢任何做出贡献的人！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T01:24:31.140

由于函数是 actionscript3.0 中的对象，因此您可以向它们添加属性，就像添加任何其他对象一样，

```
var f : Function = function() : void{ 
   trace("Value of testProp: " + arguments.callee.testProp ); 
};
(f as Object).testProp = 'TESTING';
f(); 
```

*arguments.callee*与*this*关键字一样使用。*arguments.callee*持有对其内部使用的函数的引用。

我不确定这是否是您想要的，但这就是您将属性添加到函数的方式。

**对不起，我想我弄错了，您想向属性添加函数，而不是向函数添加属性。哦，无论如何，希望你喜欢这篇文章。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T19:38:25.197

您可以将函数绑定到属性更改时调度的任何事件。使用 addEventListener() 成员方法添加处理程序。[在此处](http://livedocs.adobe.com/flex/3/html/help.html?content=databinding_4.html)阅读 Flex 3.0 文档。

# x11 - 查找 X11 窗口尺寸？

> ID：566809
> 
> 赞同：8
> 
> 时间：2009-02-19T19:34:00.680
> 
> 标签：x11

今天看着我的 Firefox 窗口，我意识到我不知道任何相当简单的方法来找出它的宽度。我以 1920x1200 运行我的桌面，而 Firefox 几乎不超过该宽度的三分之二。这实际上是一个普遍有用的问题。

一些快速搜索并没有发现任何简单的工具可以为通用 X11 窗口执行此操作……类似于 Xkill 的东西会很好。我在 Gnome，如果有帮助的话。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-19T19:38:18.693

使用[xwininfo(1)](http://linuxreviews.org/man/xwininfo/)

# c# - StructureMap，扫描程序集和范围

> ID：566815
> 
> 赞同：3
> 
> 时间：2009-02-19T19:35:39.367
> 
> 标签：c#, .net, structuremap

扫描程序集时如何添加一些范围？Google 似乎对“structuremap scan cacheby”不太满意：/

```
ObjectFactory.Configure(registry =>
{
    registry.Scan(x =>
    {
        x.AssemblyContainingType(typeof(IRepository<>));
        x.With<DefaultConventionScanner>();
    });
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-07-13T16:19:52.837

这是使其与较新的 IRegistrationConvention API 一起使用的一种方法：

```
public class SingletonConvention : IRegistrationConvention
{
    #region IRegistrationConvention Members

    public void Process(Type type, Registry registry)
    {
        registry.For(type).Singleton();
    }

    #endregion
} 
```

它可以这样使用：

```
container.Configure(registry =>
{
    registry.Scan(x =>
    {
        x.AssemblyContainingType<Foo>();
        x.AddAllTypesOf<IFoo>();
        x.Convention<SingletonConvention>();
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-06T14:26:26.663

我解决这个问题的方法是构建一个自定义约定扫描器：

```
public class CustomScanner : ITypeScanner
{
    #region ITypeScanner Members

    public void Process(Type type, PluginGraph graph)
    {                                   
        graph.AddType(type);
        var family = graph.FindFamily(type);
        family.AddType(type);
        family.SetScopeTo(InstanceScope.Hybrid);
    }

    #endregion
} 
```

# python - PyDev 调试器不同于命令行 django runserver 命令

> ID：566819
> 
> 赞同：1
> 
> 时间：2009-02-19T19:36:57.773
> 
> 标签：python, django, eclipse, pydev

我正在尝试调试 django 视图的问题。当我在命令行上运行它时。我没有收到任何这些消息。但是，当我在 PyDev 调试器中运行它时，我会收到这些错误消息。我正在使用**--noreload**选项运行。

这些错误信息是什么意思？

为什么我在命令行上运行它时没有得到它们？

```
/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/threading.py:697: RuntimeWarning: tp_compare didn't return -1 or -2 for exception
  return _active[_get_ident()]
Exception exceptions.SystemError: 'error return without exception set' in <generator object at 0x786c10> ignored
Exception exceptions.SystemError: 'error return without exception set' in <generator object at 0x7904e0> ignored 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T21:13:20.680

我似乎记得在 PyDev 中调试过与 Django 测试服务器的自动重新加载机制相关的类似问题。您可以通过将 --noreload 传递给您的 runserver 命令来关闭重新加载。从那里你只需要训练自己在调试时进行代码更改后重新启动测试服务器。

**编辑**

自从我将 PyDev 与 Django 一起使用以来已经有一段时间了，但我确实记得有一些警告消息吐出到控制台，这并没有影响我的调试能力。在调试其他 Python 库时，有很多与该消息相关的留言板帖子，但我没有找到任何有解决方案的帖子。

我想这是良性的，只要您可以忽略它并仍然调试您的代码。我认为您不必担心这是您的应用程序代码的问题，而是 PyDev 或 Python 调试工具的深层问题。

# vb.net - 在 VS.NET 中将 VB6 数据报表迁移到 Crystal Report

> ID：566823
> 
> 赞同：3
> 
> 时间：2009-02-19T19:37:52.470
> 
> 标签：vb.net, vb6, crystal-reports, vb6-migration

我正在尝试通过 Visual Studio 中的迁移过程将 VB6 数据报表（.dsr 文件）转换为 Crystal Report。我已阅读有关从 Visual Studio 2005/2008 将数据报告添加到项目的文章，并将数据报告转换为水晶报告，但我没有成功。VB6数据环境也需要转换吗？有没有人能够成功地做到这一点，如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T03:56:58.887

Have you tried the steps outlined [here](http://www.dotnetmonster.com/Uwe/Forum.aspx/dotnet-vb-upgrade/613/VB6-Data-Reports-DSR-to-VB-NET-RPT-Files) (2nd to last post)?

# php - Zend Framework 'AjaxContent' & ResponseSegmentation problem

> ID：566831
> 
> 赞同：1
> 
> 时间：2009-02-19T19:39:26.897
> 
> 标签：php, ajax, zend-framework

I'm using jquery in Zend Framework, it's my first trial. I've already found out through [another question](https://stackoverflow.com/questions/565235/jquery-and-zend-framework-problem), that I can change the response by changing the context like so:

```
$ajaxContext = $this->_helper->getHelper('AjaxContext');
$ajaxContext->addActionContext('myaction', 'html');
$ajaxContext->initContext(); 
```

Now this has helped a lot but a new problem has shown:

My page consists of different responseSegments and when I responde to an Ajax request by changing the Context, my other ResponseSegments also 'think' they are sending Ajax but they're not. The front controller asks for a viewscript.ajax.phtml... which is wrong, it should be viewscript.phtml (exists).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T19:52:34.723

In the meantime I figured out how to solve this and because I think others will encounter the same problem in the future, I will answer my own question here:

In my ActionSetup.php (or bootstrap.php if the action setup is not separated) I needed to make sure that actions are only pushed to the action stack, if the request was no XmlHttpRequest.

The only thing that was missing was an if statement:

```
if (!$request->isXmlHttpRequest()) 
```

The whole thing looks like that:

```
/**
 * Front Controller plugin to set up the action stack.
 *
 */
class Project_Controller_Plugin_ActionSetup extends Zend_Controller_Plugin_Abstract
{
    public function dispatchLoopStartup(Zend_Controller_Request_Abstract $request)
    {
        if (!$request->isXmlHttpRequest())
        {
            $front = Zend_Controller_Front::getInstance();
            if (!$front->hasPlugin('Zend_Controller_Plugin_ActionStack'))
            {
                $actionStack = new Zend_Controller_Plugin_ActionStack();
                $front->registerPlugin($actionStack, 97);
            } else
            {
                $actionStack = $front->getPlugin('Zend_Controller_Plugin_ActionStack');
            }

            $menuAction = clone ($request);
            $menuAction->setActionName('menu')
            ->setControllerName('index');
            $actionStack->pushStack($menuAction);

            $userlogAction = clone ($request);
            $userlogAction->setActionName('userlog')
            ->setControllerName('index');
            $actionStack->pushStack($userlogAction);

           //etc.
        }
    }
} 
```

# c# - 如何在.net中获取进程的用户名或所有者

> ID：566835
> 
> 赞同：4
> 
> 时间：2009-02-19T19:40:32.853
> 
> 标签：c#, .net, process

如何在 C# 中找到给定进程的所有者？System.Diagnostics.Process 类似乎没有任何属性或方法可以让我获得这些信息。我认为它必须可用，因为它显示在“用户名”列下的 Windows 任务管理器中。

我的具体情况涉及查找作为“本地服务”运行的进程实例（例如 taskhost.exe）。我知道如何使用

```
Process.GetProcessesByName("taskhost") 
```

所以现在我只需要知道如何识别作为本地服务运行的那个。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-01-26T03:43:40.947

使用 WMI 检索[Win32_Process 类](http://msdn.microsoft.com/library/windows/desktop/aa394372.aspx)的实例，然后在每个实例上调用[GetOwner 方法](http://msdn.microsoft.com/library/windows/desktop/aa390460.aspx)以获取运行该进程的用户的域名和用户名。添加对[System.Management](http://msdn.microsoft.com/library/system.management.aspx)程序集的引用后，以下代码应该可以帮助您入门：

```
// The call to InvokeMethod below will fail if the Handle property is not retrieved
string[] propertiesToSelect = new[] { "Handle", "ProcessId" };
SelectQuery processQuery = new SelectQuery("Win32_Process", "Name = 'taskhost.exe'", propertiesToSelect);

using (ManagementObjectSearcher searcher = new ManagementObjectSearcher(processQuery))
using (ManagementObjectCollection processes = searcher.Get())
    foreach (ManagementObject process in processes)
    {
        object[] outParameters = new object[2];
        uint result = (uint) process.InvokeMethod("GetOwner", outParameters);

        if (result == 0)
        {
            string user = (string) outParameters[0];
            string domain = (string) outParameters[1];
            uint processId = (uint) process["ProcessId"];

            // Use process data...
        }
        else
        {
            // Handle GetOwner() failure...
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T19:47:30.533

您可以使用进程上的Handle 属性，并通过P/Invoke 层将其传递给GetSecurityInfo 以获取有关进程的安全信息。

这和这个问题一样：

[如何获取任意进程的 SID/会话？](https://stackoverflow.com/questions/559356/how-do-i-get-the-sid-session-of-an-arbitrary-process)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:48:24.963

可能想尝试[此链接上的代码](http://www.codeproject.com/KB/cs/processownersid.aspx)

谷歌搜索“C#获取进程所有者”的第一个结果

任务管理器很可能通过 C 使用 Win32 API 来执行此操作。上面的链接也概述了该过程。

# .net - Visual Studio 与 #Develop - 默认事件处理程序

> ID：566837
> 
> 赞同：4
> 
> 时间：2009-02-19T19:42:14.443
> 
> 标签：.net, vb.net, visual-studio, sharpdevelop

Visual Studio 和 SharpDevelop 不会都设置委托来以相同的方式处理事件。它们的设置方式有点不同。这使得很难在一个地方使用 VS 而在另一个地方（在同一个项目上）使用#Develop。

例如，在 VB 中，Visual Studio 执行以下操作：

```
Private Sub OK_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OK_Button.Click
    Me.DialogResult = System.Windows.Forms.DialogResult.OK
    Me.Close()
End Sub 
```

和 ...

```
Friend WithEvents OK_Button As System.Windows.Forms.Button 
```

以便声明控件，不仅具有不同的范围（这也可能是一个问题，但不是本文的主题），而且具有 withevents。然后通过handles 子句将事件处理程序分配给它。

在#Develop中，它是这样完成的......

```
Sub OK_ButtonClick(sender As Object, e As EventArgs)

End Sub 
```

和 ...

```
Private button1 As System.Windows.Forms.Button 
```

然后，在 InitializeComponent 方法中

```
AddHandler Me.button1.Click, AddressOf Me.OK_ButtonClick 
```

最烦人的事情是，即使它以一种方式完成，另一个 ide 也会重做它，有重复的声明，当然还有编译时错误。

有谁知道解决这个问题的方法，一些自定义默认处理程序的方法？即使它只是可以关闭它们的某种方式，所以它可以手动输入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-01T14:12:54.627

Sharpdevelop 是在 LGPL 许可下发布的，因此您可以随时获取源代码并进行任何您想要的更改。

对于您想要的更改，您可能需要更改或覆盖 VBNetDesignerGenerator 类中的 InsertComponentEvent 和 CreateEventHandler 方法。它在 FormsDesigner 项目中。

您可以在[此处](http://www.icsharpcode.net/OpenSource/SD/Download/)获取源代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T19:57:03.717

将它们从 .designer 中取出并在后面代码的构造函数中手动连接它们。.designer 由您使用的任何工具的设计者重新生成

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-03T02:14:27.740

虽然我通常不会同意那些说“这个项目是开源的，自己修改代码库”的人，但这是一个可能是有效答案的情况。

#develop 以它的方式做事的原因是因为它是 C# 如何添加事件处理程序的直接端口，例如，

```
AddHandler Me.button1.Click, AddressOf Me.OK_ButtonClick 
```

只是以下内容的直接翻译：

```
this.button1.Click += new EventHandler(OK_ButtonClick); 
```

如果您使用的是 C#，Visual Studio 和#Develop 都将以完全相同的方式在代码中处理事件创建。

显然，没有人关注#Develop 中常见的 Visual Basic 用例，正如我上面所说，这是您可能不得不自己调整代码，甚至可能回馈给#Develop 源代码的边缘案例之一对于这种特殊情况。

我相信使用#Develop for Visual Basic 的其他所有人都会对此表示赞赏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T01:59:04.563

这不会是最实用的建议，但我保证它会为您完成工作。

#Develop 是开源的。所以，理论上你可以将代码库修改为与 Visual Studio.net 相同的行为......我不确定这可能涉及到多少，但我想我会分享我的想法......

作为自己进行更改的替代方法，您可以联系核心团队将此作为功能请求。也许捐赠会有所帮助……其他人也可能对这种变化感兴趣。

问候，弗兰克 V。

# c++ - 通过几个函数发送任意数据

> ID：566846
> 
> 赞同：1
> 
> 时间：2009-02-19T19:45:18.540
> 
> 标签：c++, design-patterns

在制作一个遵循[状态设计模式](http://www.dofactory.com/Patterns/PatternState.aspx)的状态系统（到目前为止工作得很好）时，我现在想知道是否有一种方法可以将任意数据发送到这个系统。我在想这可能使用 Stimulus 类。

系统本身被组合成另一个可以响应刺激的对象，状态机和状态本身也可以有刺激，它们将通过函数调用从外层传递到内层。问题是刺激需要将任意数据带到这些不同的水平，我想不出一个简单的方法来把它拿出来。

我在想可能使用 a `dynamic_cast`，但我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T20:42:55.923

boost::any 可能对您有用，具体取决于您在做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T19:49:34.760

如果它真的是任意的，那么 dynamic_cast 是你最好的选择。如果您希望状态机的所有部分都在有限数量的数据方法上工作，那么让您传递给状态机的所有数据类都继承自描述这些方法的纯虚拟类会更优雅，然后通过该类进行所有传递。

# domain-driven-design - 我应该如何将对象添加到由聚合根维护的集合中

> ID：566854
> 
> 赞同：14
> 
> 时间：2009-02-19T19:47:58.037
> 
> 标签：domain-driven-design

假设我有一个 BlogPost 聚合根。它拥有一个 List `<Comment>`。
BlogPost AddComment 签名应该如何？是否可以使用：

```
公共无效添加评论（评论评论）
{
    评论。添加（评论）；
}

```

或者我应该避免在它之外创建对根的孩子的引用，并做这样的事情：

```
公共无效添加评论（字符串文本，字符串电子邮件）
{
    评论评论 = 新评论（文本，电子邮件）；
    评论。添加（评论）；
}

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T20:15:21.920

如果您认为 Comment 是 BlogPost 的集合，并且超出该范围没有意义，那么您应该使用第二个示例。

聚合根应该控制聚合的实例化方式，因此它们的构造函数在聚合根之外不可见。

另外，如果您想要 AggregateRoot-Aggregate 的真实关系，Comment 应该是 BlogPost 的子类。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-19T20:02:23.973

如果您相信 DDD，那么了解聚合根下的某个实体是非常好的，只要您不在聚合之外的某处存储 ID 或对它的引用。

我会选择-`blogPost.AddComment(new Comment(...))`版本。

# c# - C# SOAP Web 服务客户端 - 显示如何记录所有原始 SOAP 输入和输出的示例？

> ID：566855
> 
> 赞同：2
> 
> 时间：2009-02-19T19:48:02.890
> 
> 标签：c#, web-services, logging, soap

我正在寻找一个 C# 示例，展示如何访问远程 SOAP Web 服务，并记录（记录到文件，甚至只是记录到我可以做任何事情的字符串）所有完整的原始 SOAP 请求和完整的原始 SOAP 响应。

我在 StackOverflow 上发现了一些其他类似主题的帖子，但它们似乎引用了我的*桌面*应用程序没有的 web.config 文件。我认为这是因为他们以 Web 应用程序的形式使用 C# 查询远程 SOAP Web 服务。我的是一个桌面应用程序。

有接盘侠吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T20:32:10.700

您可以使用[SOAP 扩展](http://msdn.microsoft.com/en-us/library/esw638yk%28VS.71%29.aspx)将 SOAP 内容作为字符串获取，然后将其记录到任何地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T20:05:52.487

在上面的帖子中，应该是“app.config”和“web.config”，更好的 URL 是[http://msdn.microsoft.com/en-us/library/ms730064.aspx](http://msdn.microsoft.com/en-us/library/ms730064.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T19:58:17.647

有关 WCF 日志记录的信息，请参阅[此答案](https://stackoverflow.com/questions/493883/silverlight-wcf-problem-expecting-application-soapxml-received-text-xml/493931#493931)。您可以登录到文件，并且有一个特殊的查看器可以轻松阅读日志。

您的 Windows 配置文件名为 app.config 而不是 web.config，并位于 exe 文件旁边的 bin 文件夹中。在 Visual Studio 中有一个“顶级”AppConfig 文件，当您编译时 VS 会将其复制到 bin 文件夹中。您可能需要将 AppConfig 文件添加到您的项目中——它是 Add Item 对话框中的一种特殊文件类型。

+汤姆

# regex - 懒惰，贪婪，还是什么？寻找明确的正则表达式参考

> ID：566856
> 
> 赞同：2
> 
> 时间：2009-02-19T19:48:18.817
> 
> 标签：regex, regex-greedy

最近，在网上的某个地方`*`，我找到了一个正则表达式的参考，它描述了贪婪的“第三种方式”，与贪婪匹配`(.*)`和惰性`(.*?)`匹配都不同。

我现在尝试搜索 SO、谷歌搜索，甚至搜索我的浏览器历史记录，但无济于事。

谁能猜出我看到了什么？

* * *

澄清：它指的是对我来说是一个新构造（类似于`.*+`），我相信它甚至有一个名称（类似于，但可能不是，“被动贪婪”）。

* * *

`*`我很欣赏“网络上的某个地方”与“在巴别图书馆中”或“在曼德布罗集合中”一样有用，但请尝试提供帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T20:10:32.290

我认为您指的是“姿势”匹配。Java 在此页面上对其进行了描述：http: [//java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html](http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html)

> 占有量词，贪婪地尽可能多地匹配并且不会后退，即使这样做也会使整体匹配成功。

语法与您描述的相同 (.*+) 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T19:54:13.893

这也许？[http://www.regular-expressions.info/repeat.html](http://www.regular-expressions.info/repeat.html)

`An Alternative to Laziness`

`In this case, there is a better option than making the plus lazy. We can use a greedy plus and a negated character class: <[^>]+>.`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T20:32:00.157

有各种不同的正则表达式包。在 Perl、Java、PHP 和可能的其他语言中（或多或少）使用 PCRE（Perl 兼容的正则表达式）。[PCRE 手册页](http://www.pcre.org/pcre.txt)可能被视为权威参考。它描述了所有格量词（例如 *+ 和 ++），它们是原子团的简写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T19:51:30.450

好吧，不完全是参考，但仍然很好。 [掌握正则表达式](http://oreilly.com/catalog/9781565922570/)

还有一本来自 O'Reilly 的“参考”书，但我无法就此作证。刚刚第一次看到。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T20:12:47.887

我总是在我的多维数据集中保留一份这份[正则表达式备忘单的副本。](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T20:54:41.170

谢谢你们。恢复记忆的关键是“占有欲”，而不是“被动”。

以下是一些有用的参考资料：

*   [Perldoc](http://perldoc.perl.org/perlre.html#Regular-Expressions)，在“量词”小标题下
*   在[regular-expressions.info](http://www.regular-expressions.info/possessive.html)教程中

# c# - 代表：谓词 vs. 动作 vs. Func

> ID：566860
> 
> 赞同：147
> 
> 时间：2009-02-19T19:49:02.403
> 
> 标签：c#, delegates, predicate, func

有人可以为这三个最重要的代表提供一个很好的解释（希望有例子）：

*   谓词
*   行动
*   功能

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2009-02-19T21:22:43.643

*   `Predicate`: 本质上`Func<T, bool>`; 提出问题“指定的参数是否满足委托所代表的条件？” 用于 List.FindAll 之类的东西。

*   `Action`: 执行给定参数的动作。非常通用的用途。在 LINQ 中使用不多，因为它基本上意味着副作用。

*   `Func`：在 LINQ 中*广泛*使用，通常用于转换参数，例如通过将复杂结构投影到一个属性。

其他重要代表：

*   `EventHandler`/ `EventHandler<T>`: 在 WinForms 中使用

*   `Comparison<T>`: 类似`IComparer<T>`，但以委托形式。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2015-05-14T10:08:05.327

`Action`，`Func`都`Predicate`属于委托家族。

`Action`：动作可以接受 n 个输入参数，但它返回 void。

`Func`: Func 可以接受 n 个输入参数，但它总是返回所提供类型的结果。`Func<T1,T2,T3,TResult>`, 这里 T1,T2,T3 是输入参数，TResult 是它的输出。

`Predicate`: Predicate 也是 Func 的一种形式，但它总是返回 bool。简单来说，它是`Func<T,bool>`.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-01-04T23:02:38.220

除了乔恩的回答，还有

*   `Converter<TInput, TOutput>`: 本质上是`Func<TInput, TOutput>`，但有语义。由 List.ConvertAll 和 Array.ConvertAll 使用，但个人在其他任何地方都没有见过。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-05-28T08:54:36.797

关于参数的简单示例以及每种类型的返回值

此 Func 接受两个 int 参数并返回一个 int.Func 始终具有返回类型

```
 Func<int, int, int> sum = (a, b) => a + b;
 Console.WriteLine(sum(3, 5));//Print 8 
```

在这种情况下 func 没有参数但返回一个字符串

```
Func<string> print = () => "Hello world";
Console.WriteLine(print());//Print Hello world 
```

此操作接受两个 int 参数并返回 void

```
Action<int, int> displayInput = (x, y) => Console.WriteLine("First number is :" + x + " , Second number is "+ y);
displayInput(4, 6); //Print First number is :4 , Second number is :6 
```

此谓词采用一个参数并始终返回 bool。通常谓词始终返回 bool。

```
Predicate<int> isPositive = (x) => x > 0;
Console.WriteLine(isPositive(5));//Print True 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-03-29T11:52:34.353

MethodInvoker 是 WinForms 开发人员可以使用的一种；它不接受任何参数并且不返回任何结果。它早于 Action，并且在调用 UI 线程时仍然经常使用，因为 BeginInvoke() 等人接受无类型的委托；尽管 Action 也可以。

```
myForm.BeginInvoke((MethodInvoker)delegate
{
  MessageBox.Show("Hello, world...");
}); 
```

我也知道 ThreadStart 和 ParameterizedThreadStart；这些天大多数人都会再次替换 Action。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-03-11T19:09:02.680

Predicate、Func 和 Action 是 .NET 的内置委托实例。这些委托实例中的每一个都可以引用或指向具有特定签名的用户方法。

动作委托 - 动作委托实例可以指向接受参数并返回 void 的方法。

Func 委托 - Func 委托实例可以指向采用可变数量参数并返回某种类型的方法。

谓词 - 谓词类似于 func 委托实例，它们可以指向采用可变数量参数并返回 bool 类型的方法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-05-06T10:24:33.123

带有 lambda 的动作和函数：

```
person p = new person();
Action<int, int> mydel = p.add;       /*(int a, int b) => { Console.WriteLine(a + b); };*/
Func<string, string> mydel1 = p.conc; /*(string s) => { return "hello" + s; };*/
mydel(2, 3);
string s1=  mydel1(" Akhil");
Console.WriteLine(s1);
Console.ReadLine(); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-07-13T20:39:28.273

Func 对 LINQ 更友好，可以作为参数传入。（无积分）

谓词不能，必须再次包装。

```
Predicate<int> IsPositivePred = i => i > 0;
Func<int,bool> IsPositiveFunc = i => i > 0;

new []{2,-4}.Where(i=>IsPositivePred(i)); //Wrap again

new []{2,-4}.Where(IsPositivePred);  //Compile Error
new []{2,-4}.Where(IsPositiveFunc);  //Func as Parameter 
```

# c# - 转换从数据缓存中检索到的列表时出现问题

> ID：566863
> 
> 赞同：1
> 
> 时间：2009-02-19T19:49:31.670
> 
> 标签：c#, caching, casting, list

```
var listings = new List<FPListing>();

if (Cache["Listings"] == null)
{
    listings = GetFPListings(Industry);
    Cache["Listings"] = listings;
}
else
{
    listings = (List<FPListing>)Cache["Listings"];
} 
```

演员抛出这个异常

> 无法转换类型为“System.Collections.Generic.List `1[Listings+FPListing]' to type 'System.Collections.Generic.List`1 [Listings+FPListing]”的对象。

根据 GetType 是相同的类型。我还需要采取其他步骤来让演员工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-21T11:06:10.930

原因是缓存中的对象是使用不同版本的代码创建的，或者是从不同的 dll 副本加载的相同版本的代码。

为了防止错误停止代码，请使用 as 运算符来强制转换对象。如果转换失败，它仍然会从缓存中加载数据：

```
List<FPListing> listings = Cache["Listings"] as List<FPListing>;

if (listings == null) {
    listings = GetFPListings(Industry);
    Cache["Listings"] = listings;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T23:28:37.820

我相信原因是因为编译器无法推断您显式转换为的类型，即使编译器知道要在原始 var 语句中推断的类型。

请改用“as”键。

```
listings = Cache["Listings"] as List<FPListing>(); 
```

这也是更安全的强制转换方式，因为如果无法强制转换，它将返回 NULL（或 default(T)）——而不是抛出异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T22:30:25.113

我怀疑 GetFPListings() 正在返回 List 的不同衍生物，可能是 IList。编译器会将 var 解释为 IList，它会以这种方式缓存，不能直接转换为 List。

但是，这与您的例外情况不符。因此，如果您逐字复制异常，那么我不知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T19:55:50.990

你确定那是在犹豫的那条线吗？它可能会尝试在条件的 if 部分中的该赋值语句中进行强制转换。

如果您在谈论 HttpContext.Cache，那么您需要添加（Cache.Add()）或插入（Cache.Insert()）项目，而不是按索引存储它。

调用 "Cache["Listings"] = Listings" 正在尝试使用键 "listings" 检索对象

您也不必将其声明为新的。试试这个...

```
List<FPListing>() listings; 
```

# python - Python：我错过了什么吗？

> ID：566865
> 
> 赞同：16
> 
> 时间：2009-02-19T19:50:27.033
> 
> 标签：python

我正在学习 Python，同时实现构建脚本等。目前一切正常，脚本可以完成他们需要做的事情。但我一直觉得我错过了一些东西，比如“The Python Way”。我知道构建脚本和粘合脚本并不是真正最令人兴奋的开发工作，而且可能很难成为揭示 Python 真正力量的候选者，但我仍然希望有机会让我大开眼界。我主要使用 C# 进行开发，我发现我的 Python 代码在结构和风格上与我的许多 C# 代码非常相似。换句话说，我觉得我在用 C# 思考，但用 Python 编写。

我真的错过了什么吗？

（注意：我意识到这不是一个编程问题，而且它相当广泛，可能没有明确的答案，所以如果你必须让我忘记。）

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-19T19:58:43.573

我建议您阅读[Generators、Iterators](http://www.ibm.com/developerworks/library/l-pycon.html)以及[`itertools`](http://www.ibm.com/developerworks/linux/library/l-cpyiter.html)最重要的[List Comprehensions](http://docs.python.org/tutorial/datastructures.html)。

这些是任何 Pythonic 的支柱。对于其他一切，还有[PEP-8](http://www.python.org/dev/peps/pep-0008/)。

阅读这些概念并尝试在适当的地方使用它们。祝一切顺利！

PS：别忘了`import this`；）

**附录**：我还会在这里汇总其他人在此线程中给出的一些极好的建议：

*   [像 Pythonista 一样](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)阅读代码：惯用 Python （来自[David Grant](https://stackoverflow.com/users/26829/david-grant)）
*   [从Project Euler](http://projecteuler.net/)解决问题是个好主意（来自[Nick Fortescue](https://stackoverflow.com/users/5346/nick-fortescue)）
*   David Beazley（来自[André](https://stackoverflow.com/users/9683/andr233)）关于生成器和迭代器的[精彩演讲](http://www.dabeaz.com/generators/)
*   了解Scons （来自可敬[的](https://stackoverflow.com/users/10661/s-lott)[S.Lott](http://www.scons.org/)）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-19T19:52:31.320

不——这对于从其他类 C 语言迁移到 Python 的人来说很常见。我相信您正在寻找的是使您的代码更加[“Pythonic”](http://shalabh.infogami.com/Be_Pythonic2)的方法。好消息是你编写的 Python 越多，你的代码就会变得越 Pythonic。这是“我怎样才能更简单地做到这一点”态度的自然溢出。

另一个值得一看的地方是[The Zen of Python](http://www.python.org/dev/peps/pep-0020/)。这些对 Python 开发的态度也会在同样的方面对您有所帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-19T20:32:44.740

到目前为止，你已经得到了很好的建议。我只会添加[Dive Into Python](http://www.diveintopython.org/)。

编辑：截至 2011 年 10 月 4 日，[这项工作可以在这里找到](http://www.diveintopython.net/)。 [在这里深入了解 Python 3。](http://diveintopython3.ep.io/) “为什么”是：看[这里](http://en.wikipedia.org/wiki/Mark_Pilgrim_%28software_developer%29#.22Disappearance.22_from_the_Internet)，[这里](http://www.economist.com/blogs/babbage/2011/10/internet-culture)和[这里](http://meyerweb.com/eric/thoughts/2011/10/04/searching-for-mark-pilgrim/)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-19T21:23:28.850

当您开始使用 python 进行系统编程时，您绝对应该看看这个演讲：[http ://www.dabeaz.com/generators/](http://www.dabeaz.com/generators/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-19T20:14:11.220

最近我一直在通过解决 python[中的 Project Euler](http://projecteuler.net/)问题来学习/改进我的 python。这对我来说非常有效，因为：

1.  它既有趣又有竞争力，所以我有动力继续前进
2.  它迫使我以非常自然的方式使用 python 数据结构来获得所需的性能，因此教会了我很多关于列表、集合、字符串、迭代等的知识。
3.  大多数问题只需要不到一页代码即可解决，因此您有更多时间考虑以更优雅的方式打磨或重写
4.  Python 很容易处理大整数，所以感觉它是正确的语言

我会彻底推荐这个。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-19T20:37:59.053

你正在阅读你没有写过的 Python 吗？

这是 Python 2.6.1 发行版中删除 .pyc 和 .pyo 文件的脚本。

```
#!/usr/local/bin/python
"""Recursively zap all .pyc and .pyo files"""
import os
import sys

# set doit true to actually delete files
# set doit false to just print what would be deleted
doit = 1

def main():
    if not sys.argv[1:]:
        if os.name == 'mac':
            import EasyDialogs
            dir = EasyDialogs.AskFolder(message='Directory to zap pyc files in')
            if not dir:
                sys.exit(0)
            zappyc(dir)
        else:
            print 'Usage: zappyc dir ...'
            sys.exit(1)
    for dir in sys.argv[1:]:
        zappyc(dir)

def zappyc(dir):
    os.path.walk(dir, walker, None)

def walker(dummy, top, names):
    for name in names:
        if name[-4:] in ('.pyc', '.pyo'):
            path = os.path.join(top, name)
            print 'Zapping', path
            if doit:
                os.unlink(path)

if __name__ == '__main__':
    main() 
```

你能在其中找到多少 Python 习语？

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-11-05T12:33:02.227

像这样想：

*   如果你为小工作写了太多东西，那是错误的，这不是 pythonic。

您将编写的大多数 Python 代码都非常简单直接。通常你不需要为任何简单的事情做太多的工作。如果你写得太多，停下来想想是否有更好的方法。（这就是我在 Python 中学到很多东西的方式！）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-19T20:09:45.083

添加到 Andrew Hare 和 Baishampayan Ghose 的答案......

要学习任何语言的习语，必须阅读以该习语编写的代码。我仍在学习 Python 习语，但我已经用其他语言学习过。我可以阅读有关列表推导的内容，但是只有当您看到正在使用的此类东西并说“哇！太棒了！两行代码，它非常清晰！”时，灯泡才会真正亮起。所以去找一些你觉得有趣的pythonic代码，开始阅读并理解它。如果您在工作程序的上下文中查看所有内容，那么知识将更好地留在您的脑海中。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-19T20:34:13.350

另一个强大的资源：[像 Pythonista 一样的代码：Idiomatic Python](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-27T10:20:10.663

编写一些 Python 代码并将其发布在 SO 上以供审查和反馈它是否是 Pythonic。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-01-16T09:31:20.117

研究精心设计的 pythonic API / 框架。一些最好的存在于标准库之外。请注意他们允许您*不做的事情*。我最喜爱的：

*   [py.test](http://pytest.org)比 unittest（基于 JUnit）更 Pythonic。只需编写`test_foo()`函数而不是继承自`unittest.TestCase`. 只是做`assert x == y`而不是`self.assertEqual(x, y)`. 还有很多好东西...

    *   Doctest 也比 unittest 更 Pythonic。由于一些实际的烦恼，许多人放弃了它，但这个想法很棒。

    *   如果您深入测试，[模拟](http://pypi.python.org/pypi/mock)模块的操作 -> 断言方法比竞争库记录更 Pythonic -> 重放范式。

*   [requests](http://python-requests.org)是我见过的最干净的 API 之一，比 httplib + urllib + urllib2 好得多。

*   JSON 和 YAML[比 XML](http://dirtsimple.org/2004/12/python-is-not-java.html)更 Pythonic 。

    *   JSON-RPC 比 XMLRPC 或 SOAP 更*Pythonic*。

    *   [ElementTree](http://docs.python.org/2/library/xml.etree.elementtree.html#element-objects)比 DOM 更像是 Pythonic API。通过优化具有一个或多个标签的标签，它减少了 XML <-> 数据结构阻抗不匹配（但仍然可以通过hack`.text`往返混合内容）。`.tail`

*   [Scapy](http://www.secdev.org/projects/scapy/demo.html)是一个非常简洁的框架，用于发送和剖析网络数据包。

*   我相信[Storm](https://storm.canonical.com/Tutorial)是最 Pythonic 的对象关系映射。免责声明：我几乎没有使用 ORM 的经验。

*   heapq 是一个实现精美的模块。只需阅读代码。

*   itertools 非常强大。阅读文档中的所有示例。
    关于广泛使用它是pythonic还是奇怪的方言，意见不一：-)

阅读“Python 中的新功能”，至少对于您正在使用的最后一个版本。阅读一些 PEP。了解*为什么*这些变化是一种改进。

最后，确保充分利用交互式 Python。学习 API 的最佳方法是试用它们，看看会发生什么！多行编辑、完成和简单的 help() 访问是必备功能 - 查看 ipython（包括笔记本！）、dreampie、bpython。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-19T20:36:59.630

虽然构建脚本和线索脚本 [*原文如此*] 并不是最令人兴奋的开发工作，但它们完全是揭示 Python 真正力量的候选者。

首先，看看已经用 Python 编写的各种类似 make 的工具。

这个池塘里的大鱼是Scons：[http](http://www.scons.org/) ://www.scons.org/ 。了解这一点。

这篇博文讨论了替代方案[http://farmdev.com/thoughts/46/the-python-make-tool/](http://farmdev.com/thoughts/46/the-python-make-tool/)

“我仍然希望有机会让我大开眼界” 从 Google 开始：找到已经完成部分或全部工作的 Python 工具。代码更少，下载和阅读更多。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-06-23T13:30:35.467

除了这里其他人提到的生成器、迭代器、列表理解等东西之外，我想提出更多的概念，我认为这些概念肯定会为尝试以“pythonic”方式做事的人增加价值。这些是装饰器和元类。

对于装饰器，强烈推荐[这个](https://stackoverflow.com/a/1594484/1005500)stackoverflow 答案，对于元类，你可以通过[这个](https://stackoverflow.com/a/6581949/1005500).

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-20T10:57:24.097

我建议找一个个人的蟒蛇大师。向他们展示您的一些代码，并让他们查看/将其重写为惯用的 python。这样你就会开悟。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-20T21:28:17.870

要回显 TLHOLADAY，请阅读标准库。这就是“pythonic”的东西所在。如果您在那里感觉不好，请阅读 sqlachemy 或 django 或您选择的项目的源代码。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-05-31T18:54:03.660

`import this`

**如果您可以将您的代码放在Python 之禅**旁边并且感觉良好，那么您就成功了一半。还要**检查 this.py 模块**：有点讽刺。

The other half is learning about stuff like: **regular expressions**, **list comprehensions**, **generators**, **meta-classes**, **argument unpacking**, **decorators**, **list stepping**, **'with' statement**, **conditional assignment**, powerful built-ins like **enumerate()**, **map()**, **zip()**, **reduce()**, **any()** and **pow()**, and many others(check [Hidden features of Python](https://stackoverflow.com/questions/101268/hidden-features-of-python#116480) for more)

Along the way you can read other people's code and modify it.

Finnaly: Learn about **`finally`** and `import antigravity`

# visual-studio - 是否可以在 Web 部署项目中更新 WCF 服务引用

> ID：566867
> 
> 赞同：3
> 
> 时间：2009-02-19T19:50:53.867
> 
> 标签：visual-studio, web-services, msbuild, msbuild-task

我认为问题标题巧妙地总结了我所追求的。我有一个 Web 应用程序和一项服务，我希望构建脚本检查自上次构建以来服务是否已更新，如果是，请运行右键单击服务时可用的“更新服务参考”脚本.

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T20:02:32.723

我不确定，但我认为有一种方法可以通过 Visual Studio SDK 做到这一点。我记得，例如，您可以引用一个对象模型来显示“添加 Web 引用”对话框。毫无疑问，您也可以执行“更新 Web 参考”。然后应该可以创建一个 MSBUILD 任务来为您执行此操作。

您还应该考虑到那里可能已经有这样的任务。检查 Codeplex 和其他类似地方的 MSBUILD 任务的公共集合，其中一些可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T15:57:06.493

我们使用 PowerShell 脚本为我们运行 wsdl.exe 工具（或者在您的情况下为 svcutil.exe）。脚本运行到服务并提取新的 wsdl 并重新生成代理。你可以用去PS。唯一的技巧是正确获取命名空间，但 wsdl.exe 上有一个选项。

```
<Target Name="UpdateWebReferences">

<Exec WorkingDirectory="$(SolutionRoot)" 
      Command="$(PS) -Noninteractive -Command $(SolutionRoot)\tools\PowerShell\Compile-Wsdl.ps1 -ukf $(ConfigFilePath)" 
      Condition=" Exists('$(ConfigFilePath)') And Exists('$(SolutionRoot)\tools\PowerShell\Compile-Wsdl.ps1') " /> 
```

以上内容包含在您的团队建设中。powershell函数的内容如下：

```
$projectFile = [xml]( Get-Content $projectFilePath ) 

if ( $projectFile -and $WSDL_LANGUAGE -ne "VB")
{
    $ns = $projectFile.Project.PropertyGroup[ 0 ].RootNamespace
}
else
{
    $ns = $NAMESPACE_PREFIX
}

foreach( $webRefDir in Get-ChildItem $dir.FullName )
{
    $webRefName = $webRefDir.Name

    if ( [System.String]::IsNullOrEmpty( $ns ) )
    {
        $namespace = $webRefName
    }
    else
    {
        $namespace = $( "{0}.{1}" -f $ns, $webRefName )
    }

    Write-Host $( "Compiling Web Reference: {0} using Namespace: {1}..." -f $webRefName, $namespace )

    $outputPath = $( "{0}\{1}" -f $webRefDir.FullName,$REFERENCE_FILE )

    $xpath = "/configuration/appSettings/add[@key='{0}']" -f $webRefName

    if ( $URL_KEY_FILE )
    {
        $xml = [xml](Get-Content $URL_KEY_FILE)
        $url = $xml.SelectSingleNode( $xpath )

        if ( $url )
        {
            $urlOrPath = $url.Value
        }
        else
        {
            Write-Warning $( "Could not find key {0} in {1}..." -f $webRefName, $URL_KEY_FILE )
        }
    }
    else
    {
        $urlOrPath = $( Get-ChildItem $webRefDir.FullName -r -filter "*.wsdl" ).FullName
    }   

    if ( $urlOrPath )
    {
        wsdl /nologo /language:$WSDL_LANGUAGE /n:$namespace /o:$outputPath /urlkey:$webRefName $urlOrPath
    }

    Write-Host "....................................................."
} 
```

为此，您必须签入“Web References”文件夹。它遍历每个目录并创建正确的命名空间。脚本很长，但我愿意通过电子邮件发送。

# apache - Mod Rewrite：适用于所有 js 和 css 文件，除了

> ID：566872
> 
> 赞同：3
> 
> 时间：2009-02-19T19:51:32.417
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

我需要对所有 javascript 和 CSS 文件应用缩小操作，但我指出的文件除外。

我有适用于所有文件（css 和 js）的条件和规则：

```
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^(.*\.)(js|css)$ minify.php?q=$1$2 [L,NC] 
```

我需要添加条件说：

适用于所有除：jquery.js、prototype.js 等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-19T19:56:43.030

试试这个

```
RewriteCond %{REQUEST_FILENAME} !^.*jquery.js$
RewriteCond %{REQUEST_FILENAME} !^.*prototype.js$
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^(.*\.)(js|css)$ minify.php?q=$1$2 [L,NC] 
```

关键是使用“！”反转正则表达式 （感叹号）说文件名不是 jquery.js 也不是prototype.js 并且可以在硬盘上找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T19:57:36.757

您可以使用`RewriteCond`指定`RewriteRule`应在哪些条件下应用。因此，将这些行添加到您的`.htaccess`：

```
RewriteCond %{REQUEST_FILENAME} !jquery.js
RewriteCond %{REQUEST_FILENAME} !prototype.js 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T15:50:07.543

非常感谢你做的这些！近一个月来，我一直在寻找这个问题的答案。我的问题是如何将一些文件重写为 https 并将其余文件重写为 http，但我能够在上面进行修改以使其工作。这是我的一段代码。（我在网站上的真实 .htaccess 中有更多文件。）

```
#################################################################
# To only change certain files from http to https, the rest from 
# https to http. Absolute links are set up throughout the site, 
# but if a visitor for some reason edits the URL in the address
# bar, the URL will change back to the proper format.

Options +FollowSymLinks
RewriteEngine On
RewriteCond %{HTTP_HOST} ^alvingolf\.com$ [NC]
RewriteCond %{HTTPS} on
RewriteCond %{SERVER_PORT} ^443$ 
RewriteCond %{REQUEST_FILENAME} !^.*contact-us.html$
RewriteCond %{REQUEST_FILENAME} !^.*register-for-tournaments.html$
RewriteCond %{REQUEST_FILENAME} !^.*form.htm$ 
```

# java - 如何在 Eclipse 中为 SWT 和 JFace 获取 JavaDoc？

> ID：566877
> 
> 赞同：12
> 
> 时间：2009-02-19T19:52:41.743
> 
> 标签：java, eclipse, swt, javadoc, jface

我是 Eclipse 的新手，不知道如何在编辑时显示 SWT 和 JFace 的 JavaDocs。

我该怎么做呢？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-19T20:29:43.500

我假设您已经自己下载了 jar 并在您的项目中引用了它们。如果是这样，您可以右键单击项目资源管理器中的 jar（在“引用库”节点中），然后单击“属性”。出现的窗口中，您可以定义 jar 的 JavaDoc 和源代码（如果有的话）的位置。

您还可以通过单击 Project > Properties > Java Build Path > Libraries 并展开要添加 javadoc/source 的 jar 的节点来实现此目的。

另外值得一提的是，如果您使用 Maven ( [http://maven.apache.org/](http://maven.apache.org/) ) 来构建您的项目，它的依赖管理系统将负责为您查找源代码和 javadocs。但这完全是一个不同的话题。也可能值得一看 Ivy ( [http://ant.apache.org/ivy/](http://ant.apache.org/ivy/) ) - 类似的依赖管理系统，但可以在不将你的灵魂卖给 Maven 的情况下使用，我被告知。

* * *

您可能还意味着您实际上看不到 javadocs：Window > Show View > Other... > Java > JavaDoc。此视图将向您显示当前关注的任何内容的 javadoc。或者只需将鼠标悬停在一个方法上即可在弹出窗口中查看 javadoc。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T21:31:32.703

根据 ukulele 的建议，我能够右键单击 jar 并设置 javadoc 位置。在这种情况下，在线 javadoc 的位置是：

[http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/](http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/)

从 SWT 网站找到：

[http://www.eclipse.org/swt/docs.php](http://www.eclipse.org/swt/docs.php)

谢谢！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-21T18:52:48.183

如果您希望在 Eclipse 中安装所有内容（包括插件）的 JavaDoc，请安装“Eclipse SDK”。这个的更新站点是

```
download.eclipse.org/eclipse/updates/4.4 
```

（这是针对 eclipse juno 的。对于开普勒，使用版本号 4.3 而不是 4.4）
转到`Help > Install New Software...`并提供上述“使用”部分的 url。然后你应该选择“Eclipse SDK”并安装它。
安装并重新启动 eclipse 后，只要将鼠标悬停在特殊关键字上，所有文档都将在您的编辑器中可见。
相信我，这是最简单且 100% 正确的方法。

为了进一步澄清这会发生什么，它将为“org.eclipse.swt.gtk.linux.x86_64_3.102.1.v20140206-1358.jar”和“org.eclipse.swt_3.102.1.v20140206-1334”配置javadoc路径.jar”（或在 windows org.eclipse.swt.win32.win32.x86_643.xxxx.jar 中）并且在项目结构的插件依赖项中可见。所以要手动设置javadoc支持右键单击项目>构建路径>配置构建路径>在库选项卡>插件依赖项下选择与swt相关的.jar（对于windows org.eclipse.swt.win32.win32.x86_643.xxxx.jar对于 linux org.eclipse.swt.gtk.linux.x86_64_xxxxxxx.jar) 展开它并设置 javadoc 位置。对于 java doc 位置，您应该将 org.eclipse.platform.doc.isv_4.3.0.v20130606-0003.jar 的存档路径指定为“

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T20:15:24.933

如果您使用“插件项目”，默认情况下它们就在那里。该项目类型在“Eclipse for RCP/Plug-in Developers”或“Eclipse Classic”中可用。如果您有不同的版本，您应该能够在通过更新管理器安装“Eclipse SDK”功能后设置这样的项目（在 3.4 中的可用软件 -> Eclipse 项目更新下）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T22:43:09.163

我经常发现 eclipse.org 上的 javadoc 加载速度非常慢。javadocs 可能包含在您的 eclipse 安装中，因此可以在本地使用；尝试**Help->Help Contents**菜单并搜索“SWT”以查看您的安装是否属实。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-05T18:08:10.563

一种方法是将 SWT 源 jar（例如`org.eclipse.swt.gtk.linux.x86_64.source_3.7.0.v3735b.jar`）从`eclipse/plugins`目录附加到引用的库。您将能够查看源代码和 Javadoc。

可在[Eclipse 社区论坛上找到：标准小部件工具包 (SWT) » JavaDocs](http://www.eclipse.org/forums/index.php/m/557082/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-15T09:18:38.620

如果您正在使用 org.eclipse.jface.text 进行开发，还可以将 org.eclipse.jface.text jar 的 javadoc 位置编辑为：

[http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/)

# asp.net - 向 SCOM / WMI 公开 Web 服务信息

> ID：566880
> 
> 赞同：0
> 
> 时间：2009-02-19T19:53:08.123
> 
> 标签：asp.net, .net-2.0, monitoring

将信息从 ASP.NET Web 服务公开到 SCOM 或 WMI 的最佳方式是什么？我有兴趣基本上公开性能信息，以便可以监控服务：即。获取每小时处理的呼叫量、每天的总呼叫量等指标。

**编辑：**这必须在标准 ASP.NET 权限下运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T20:52:56.963

您需要编写一个 WMI 提供程序来向 WMI 公开信息 - [CodeProject 上有一个示例](http://www.codeproject.com/KB/system/WMIProviderExtensions.aspx)。另一种可能更简单的方法是公开一些自定义性能计数器，如[本文所述](http://www.ondotnet.com/pub/a/dotnet/2003/04/07/wmi.html?page=2)。

# java - 使用 JBoss 4.2.x，我如何在不取消部署现有数据源的情况下部署新数据源？

> ID：566892
> 
> 赞同：1
> 
> 时间：2009-02-19T19:57:21.593
> 
> 标签：java, deployment, jakarta-ee, jboss

我们的 EE 应用程序的配置管理要求我们不时地创建一个新的数据库连接数据源。我们现在通过修改 deploy/[dbtype]-ds.xml 文件，在这个文件中插入一个额外的连接定义来做到这一点。问题是，这样做会导致除了创建新连接之外，现有连接也被取消部署和重新部署。

从 JBoss 日志中：

```
12:52:13,096 INFO  [ConnectionFactoryBindingService] Unbound ConnectionManager 'jboss.jca:service=DataSourceBinding,name=dsmDS' from JNDI name 'java:dsmDS'
12:52:13,386 INFO  [ConnectionFactoryBindingService] Unbound ConnectionManager 'jboss.jca:service=DataSourceBinding,name=ecourierDS' from JNDI name 'java:ecourierDS'
12:52:20,321 INFO  [ConnectionFactoryBindingService] Bound ConnectionManager 'jboss.jca:service=DataSourceBinding,name=ecourierDS' to JNDI name 'java:ecourierDS'
12:52:20,671 INFO  [ConnectionFactoryBindingService] Bound ConnectionManager 'jboss.jca:service=DataSourceBinding,name=dsmDS' to JNDI name 'java:dsmDS'
12:52:26,512 INFO  [ConnectionFactoryBindingService] Bound ConnectionManager 'jboss.jca:service=DataSourceBinding,name=ecourier-core360aDS' to JNDI name 'java:ecourier-core360aDS' 
```

有没有一种方法可以部署新的数据源（或删除或修改现有的数据源）而无需取消绑定任何其他不受影响的数据源？

（编辑）有人建议我们只是将数据源添加到一个新文件中，但这不起作用，至少不是开箱即用；如果我在部署目录中命名的文件中添加 core360aDS 数据源，`core360aDS.xml`则会发出以下错误消息：

```
--- Packages waiting for a deployer ---
org.jboss.deployment.DeploymentInfo@3ccd9d83 { url=file:/home/rosec/testing/ecas/var/jboss/server/core41/deploy/core360aDS.xml }
  deployer: null
  status: null
  state: INIT_WAITING_DEPLOYER
  watch: file:/home/rosec/testing/ecas/var/jboss/server/core41/deploy/core360aDS.xml
  altDD: null
  lastDeployed: 1235079499893
  lastModified: 1235079499000
  mbeans:

--- Incompletely deployed packages ---
org.jboss.deployment.DeploymentInfo@3ccd9d83 { url=file:/home/rosec/testing/ecas/var/jboss/server/core41/deploy/core360aDS.xml }
  deployer: null
  status: null
  state: INIT_WAITING_DEPLOYER
  watch: file:/home/rosec/testing/ecas/var/jboss/server/core41/deploy/core360aDS.xml
  altDD: null
  lastDeployed: 1235079499893
  lastModified: 1235079499000
  mbeans: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T21:13:50.400

您可以将每个数据源存储在它们自己的文件中。这样，您可以避免取消部署您正在修改的文件中的其他数据源。您可以简单地在数据源名称之后命名数据源 xml 文件，从而轻松查找和编辑必要的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T22:47:22.850

正如上面 Shiny 和 New 先生所提到的，正确的方法是将数据源放在自己的文件中。诀窍是文件名必须符合`jbossjca-service.xml`部署文件中支持的后缀。

因此，为每个数据源创建一个名为*foo*`-ds.xml`的新文件。

# c# - 是否有一种直接的方法可以使用 iTextSharp 将一个 PDF 文档附加到另一个文档？

> ID：566899
> 
> 赞同：8
> 
> 时间：2009-02-19T20:00:46.753
> 
> 标签：c#, pdf, itextsharp

我在网上搜索了有关如何执行此操作的示例。我发现了一些似乎比他们需要的更多的参与。所以我的问题是，使用 iTextSharp，是否有一种相当简洁的方法可以将一个 PDF 文档附加到另一个文档？

最好这不会涉及第三个文件。只需打开第一个 PDF 文档，将第二个 PDF 文档附加到第一个 PDF 文档，然后将它们都关闭。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-03-03T20:03:42.353

我真的可能遗漏了一些东西，但我做了一些更简单的事情。我承认这个解决方案可能不会更新书签（就像迄今为止最好的答案一样），但它对我来说完美无缺。由于我将文档与可填写的表单合并，因此我使用了 PdfCopyFields 而不是 PdfCopy。

这是代码（我已经剥离了所有错误处理以使实际代码更加可见，如果您打算使用代码，请添加 try..finally 以关闭打开的资源）：

```
 void MergePdfStreams(List<Stream> Source, Stream Dest)
    {
        PdfCopyFields copy = new PdfCopyFields(Dest);

        foreach (Stream source in Source)
        {
            PdfReader reader = new PdfReader(source);
            copy.AddDocument(reader);
        }

        copy.Close();
    } 
```

您可以传递任何流，无论是 FileStream、MemoryStream（在从数据库读取 PDF 时很有用，不需要临时文件等）

示例用法：

```
 void TestMergePdfStreams()
    {
        List<Stream> sources = new List<Stream>()
        {
            new FileStream("template1.pdf", FileMode.Open),
            new FileStream("template2.pdf", FileMode.Open),
            new MemoryStream((byte[])someDataRow["PDF_COLUMN_NAME"])
        };

        MergePdfStreams(sources, new FileStream("MergedOutput.pdf", FileMode.Create));
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-20T14:28:36.350

好的，这不是直截了当的，但它可以工作并且速度惊人。（并且它使用第三个文件，没有打开和附加之类的东西。）我在文档/示例中“发现”了这一点。这是代码：

```
private void CombineMultiplePDFs( string[] fileNames, string outFile ) {
    int pageOffset = 0;
    ArrayList master = new ArrayList();
    int f = 0;

    Document document = null;
    PdfCopy writer = null;
    while ( f < fileNames.Length ) {
        // we create a reader for a certain document
        PdfReader reader = new PdfReader( fileNames[ f ] );
        reader.ConsolidateNamedDestinations();
        // we retrieve the total number of pages
        int n = reader.NumberOfPages;
        ArrayList bookmarks = SimpleBookmark.GetBookmark( reader );
        if ( bookmarks != null ) {
            if ( pageOffset != 0 ) {
                SimpleBookmark.ShiftPageNumbers( bookmarks, pageOffset, null );
            }
            master.AddRange( bookmarks );
        }
        pageOffset += n;

        if ( f == 0 ) {
            // step 1: creation of a document-object
            document = new Document( reader.GetPageSizeWithRotation( 1 ) );
            // step 2: we create a writer that listens to the document
            writer = new PdfCopy( document, new FileStream( outFile, FileMode.Create ) );
            // step 3: we open the document
            document.Open();
        }
        // step 4: we add content
        for ( int i = 0; i < n; ) {
            ++i;
            if ( writer != null ) {
                PdfImportedPage page = writer.GetImportedPage( reader, i );
                writer.AddPage( page );
            }
        }
        PRAcroForm form = reader.AcroForm;
        if ( form != null && writer != null ) {
            writer.CopyAcroForm( reader );
        }
        f++;
    }
    if ( master.Count > 0 && writer != null ) {
        writer.Outlines = master;
    }
    // step 5: we close the document
    if ( document != null ) {
        document.Close();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T22:34:48.980

是的。我在 iText 论坛上看到过一个名为 PdfManipulation 的课程。不过，使用该类将涉及第三个文件。

该类最初在 VB.Net 中。我从[vbforums.com 上的帖子](http://www.vbforums.com/showthread.php?t=490456)下载了它。显然，它没有合并文件功能，所以我根据该类中的代码编写了一个。

这是在没有 iTextSharp 的机器上编写的。这可能有错误。我什至不确定页码是基于 0 还是基于 1。但是试一试。

```
public static void MergePdfFiles(IEnumerable<string> files, string output) {
    iTextSharp.text.Document doc;
    iTextSharp.text.pdf.PdfCopy pdfCpy;

    doc = new iTextSharp.text.Document();
    pdfCpy = new iTextSharp.text.pdf.PdfCopy(doc, new System.IO.FileStream(output, System.IO.FileMode.Create));
    doc.Open();

    foreach (string file in files) {
        // initialize a reader
        iTextSharp.text.pdf.PdfReader reader = new iTextSharp.text.pdf.PdfReader(file);
        int pageCount = reader.NumberOfPages;

        // set page size for the documents
        doc.SetPageSize(reader.GetPageSizeWithRotation(1));

        for (int pageNum = 1; pageNum <= pageCount; pageNum++) {
            iTextSharp.text.pdf.PdfImportedPage page = pdfCpy.GetImportedPage(reader, pageNum);
            pdfCpy.AddPage(page);
        }

        reader.Close();
    }

    doc.Close();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T23:07:13.550

我不知道如何对 PDF 文件执行此操作，但对于 postscript，您只需连接文件即可。如果您安装了 pdf2ps 和 ps2pdf，下面将完成这项工作：

```
pdf2ps file1.pdf file1.ps
pdf2ps file2.pdf file2.ps
cat file1.ps file2.ps > combined.ps
ps2pdf combined.ps combined.pdf 
```

我不是 pdf2ps 或 ps2pdf 方面的专家。我只使用过 ps2pdf，当我这样做时，它会将文本保留为文本（我仍然可以从生成的 pdf 中选择和复制文本）。当我执行上述步骤（pdf->ps、combine、ps->pdf）时，我最终会得到一个像图像一样的 pdf。不知道为什么。

# .net - 在 ASP.Net MVC 视图中使用 OnLoad 事件的替代方法？

> ID：566902
> 
> 赞同：2
> 
> 时间：2009-02-19T20:01:32.947
> 
> 标签：.net, asp.net, asp.net-mvc, code-behind

我正在创建一个简单的测试应用程序，以便了解 ASP.Net MVC 如何处理我们每天处理的问题。我们使用来自 Developer's Express 的第 3 方控件，并且我们将继续使用它们。如果它们绝对不能在 ASP.Net MVC 中工作，那么我们将不会使用 ASP.Net MVC。

话虽如此，有人已经找到了一种让它发挥作用的方法。他只需要在后面的代码中放一些代码。他必须重写 OnLoad 事件，只需将 grid.DataSource = model 和 grid.DataBind() 放入，它就可以按预期工作。

在 ASP.Net MVC RC 中，消除了文件隐藏代码。我知道我可以把它们放回去......但是，由于人们通常说文件后面的代码是邪恶的，那么你还能如何做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-19T21:24:54.993

不创建代码隐藏文件的最简单方法是将其添加到 .aspx 页面的任何位置：

```
<script runat="server">
  private void Page_Load(object sender, System.EventArgs e)
  {
     //Initialize your control.
  }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T20:17:36.923

我（似乎记得我）看到过类似于直接在视图（.aspx）中做的事情：

```
<%
   grid.DataSource = Model;
   grid.DataBind();
%> 
```

为 Telerik 控件工作，建议的解决方案闻起来很像这样，所以也许这对你有用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T20:28:47.917

使用的任何控件`ViewState`都不起作用`ASP.NET MVC`-标准`System.Web.UI.WebControls.GridView`就是其中之一，但我不知道`grid`您正在使用的库中的控件。请注意，由于 和 之间的差异，任何需要的控件`ViewState`都无法正常运行。`MVC``WebForms`

* * *

澄清：如果不使用`GridView`'s`Viewstate`和`PostBack`功能，它当然也会在 an`ASP.NET MVC View`中起作用。但是，没有`OnLoad`要覆盖的事件，因为页面没有相同的生命周期，所以如果要使用这个控件，已经建议的解决方案可能是最好的。

```
<%
    grid.DataSource = Model;
    grid.DataBind();
%> 
```

还要确保在页面顶部有这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T21:38:15.263

[这是一个视频和可下载的示例项目，展示了如何在 MVC 项目中使用 Developer Express 控件。](http://community.devexpress.com/blogs/aspnet/archive/2009/02/17/video-case-study-devexpress-in-asp-net-mvc-framework.aspx)据说 Developer Express 对 MVC 的支持即将推出。目前，您必须解决有关事件处理和对视图状态的依赖的问题。但我最近听到的是他们确实打算支持 MVC。

# c# - 在 C# 中传递和存储指向不可变类型和字符串的指针

> ID：566908
> 
> 赞同：2
> 
> 时间：2009-02-19T20:01:55.083
> 
> 标签：c#, function, pointers, arguments, immutability

有没有办法在 C# 中存储指向不可变类型（如字符串）的指针？如何执行：Instance1.SomeFunction(out MyString);

，并在 Instance1 中存储指向 MyString 的指针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T22:30:53.263

使用此类作为指针（注意：未经测试的记事本代码，可能需要一些修复）：

```
public class Box<T> {
    public Box(T value) { this.Value = value; }

    public T Value { get; set; }

    public static implicit operator T(Box<T> box) {
        return box.Value;
    }
} 
```

例如，

```
public void Test() {
    Box<int> number = new Box<int>(10);
    Box<string> text = new Box<string>("PRINT \"Hello, world!\"");

    Console.Write(number);
    Console.Write("    ");
    Console.WriteLine(text);

    F1(number, text);

    Console.Write(number);
    Console.Write("    ");
    Console.WriteLine(text);
    Console.ReadKey();
}

void F1(Box<int> number, Box<string> text) {
    number.Value = 10;
    text.Value = "GOTO 10";
} 
```

应该输出

```
10    PRINT "Hello, world!"
20    GOTO 10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T23:00:05.160

关于提问者的回答，有什么问题：

```
class Program
{
    static void Main()
    {
        string str = "asdf";
        MakeNull(ref str);
        System.Diagnostics.Debug.Assert(str == null);
    }

    static void MakeNull(ref string s)
    {
        s = null;
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-28T10:31:08.850

好的，我找到了另一个部分解决我的问题的方法。如果您希望某些 ref/out-arguments 具有空值，则可以使用重载：

```
void Test()
{
    string ret1 = "", ret2 = "";
    SomeFunction(ref ret1, ref ret2);
    SomeFunction(null, ref ret2);
    SomeFunction(ref ret1, null);
    SomeFunction(null,null);
}

string null_string = "null";

void SomeFunction(ref string ret1,ref string ret2)
{
   if( ret1!=null_string )
       ret1 = "ret 1";
   if( ret2!=null_string )
       ret2 = "ret 2";
}

// Additional overloads, to support null ref arguments
void SomeFunction(string ret1,ref string ret2)
{
    Debug.Assert(ret1==null);
    SomeFunction(null_string,ret2);
}
void SomeFunction(ref string ret1,string ret2)
{
    Debug.Assert(ret2==null);
    SomeFunction(ret1,null_string);
}
void SomeFunction(string ret1,string ret2)
{
    Debug.Assert(ret1==null&&ret2==null);
    SomeFunction(null_string,null_string);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T20:04:02.287

我一直在与 C# 中的指针斗争一段时间，并且对缺乏选项感到惊讶。在 C# 中处理指针和指针参数时，您会遇到各种晦涩难懂的障碍：

*   您不能创建指向托管类型的本机指针，甚至不能创建指向字符串的指针
*   您不能保存不可变的输出/引用参数以供以后使用
*   你不能有可选/可为空的输出/引用参数，即使“null”是字符串类型的默认状态
*   你不能在 lambda 表达式中使用传递/引用参数

我最近发现的非常简洁的解决方案，而且这篇文章的原因是：

```
void Test()
{
  string ret = "";
  SomeFunction(a=>ret=a);
}

void SomeFunction(string_ptr str)
{
   str("setting string value");
}

delegate void string_ptr(string a); 
```

# open-source - 在哪里可以找到有助于科学的编程项目？

> ID：566915
> 
> 赞同：24
> 
> 时间：2009-02-19T20:02:58.433
> 
> 标签：open-source, scientific-computing

我想在业余时间从事一个编程项目，并想知道是否有一个项目可以以某种方式帮助科学界？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-19T20:18:41.603

当然，很多！我知道我不是第一个想到像[Numpy/Scipy](http://www.scipy.org)这样的数值计算库的人——其中的代码实际上相当成熟，但他们当然可以使用帮助文档。还有[GNU Octave](http://www.gnu.org/software/octave/)，它与 Numpy 做很多相同的事情，但不需要 Python。一个有很多工作要做的稍微相关的领域是计算机代数系统 (CAS)，它基本上是 Mathematica 的开源等价物；例如[Maxima](http://maxima.sourceforge.net/)，更多内容在[http://sage.math.washington.edu/home/wdj/sigsam/opensource_math.html](http://sage.math.washington.edu/home/wdj/sigsam/opensource_math.html)中列出。您还可以帮助使用可视化库，即创建 2D 和 3D 绘图和图形。对于 Scipy，最常用的绘图生成器是[Matplotlib](http://matplotlib.sourceforge.net/)， 例如。还有很多更专业的数据可视化工具，我相信您可以通过几次搜索找到它们。

我个人认为需要大量工作的一个领域是为上一段中提到的程序创建 GUI；Matlab 和 Mathematica 等商业程序相对于其开源等效程序的一大优势是易于使用的图形界面。对于可能不擅长命令行操作的科学家来说，拥有一个好的可用界面会非常有用，但如果要赶上开源项目，还有很*长*的路要走。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-19T20:06:07.853

[scipy](http://www.scipy.org/)和[numpy](http://www.scipy.org/more_about_SciPy)等项目主要由科学界贡献。我相信他们会感谢您认为您可以提供的任何帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-19T20:07:19.660

我知道[BOINC](http://boinc.berkeley.edu/)一直在寻求帮助

编辑：这是他们的编程帮助页面[http://boinc.berkeley.edu/trac/wiki/DevProjects](http://boinc.berkeley.edu/trac/wiki/DevProjects)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-19T20:57:30.683

[BioPerl](http://www.bioperl.org/)、[BioPython](http://www.biopython.org/)或[BioRuby](http://www.bioruby.org/)等 Bio* 项目当然也需要一些帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-19T20:05:05.903

[http://sourceforge.net/search/?type_of_search=soft&words=science](http://sourceforge.net/search/?type_of_search=soft&words=science)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-19T20:11:54.643

除了在线搜索开源项目之外，您还可以尝试联系您当地的大学，询问他们的研究人员（学生或教师）是否需要开发帮助。

如果您仍在寻找，请随时通过我的个人资料页面与我联系 - 我知道需要软件的硬件产品 - 它用于研究（化学和生物学）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-19T20:23:18.550

核广告粒子物理社区大量使用[ROOT](http://root.cern.ch/)，它是使用开源方法开发的。他们毫不费力地接受建议和补丁。主要工作是在 C++ 中，但也有对其他语言的绑定和支持。

我确信其他学科也有自己的特定领域工具。例如，我知道有开放的计算流体动力学和有限元系统。

看看四周。虽然领域知识会有所帮助，但大多数大型工具都需要在 RDBMS 访问、GUI、文档等日常工作方面的帮助......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-19T20:39:03.497

您可以通过阅读学术期刊的摘要来发现当前的科学问题。例如[生物信息学](http://bioinformatics.oxfordjournals.org/)杂志。

几个例子：

*   寻找一种更快/更有效的方法来组装大量的[短 DNA](http://en.wikipedia.org/wiki/List_of_sequence_alignment_software#Short-Read_Sequence_Alignment)读数：
*   寻找建立高效[社会科学网络的方法](http://blog.openwetware.org/scienceintheopen/2009/02/15/contributor-ids-an-attempt-to-aggregate-and-integrate/)
*   找到一种方法来比较[数千个人类基因组](http://www.1000genomes.org)
*   ……

你也可以在[Nature Network:Collaboration](http://network.nature.com/groups/nncollaborations/forum/topics)或[FriendFeed: The Life Sciences上提出你的帮助](http://friendfeed.com/rooms/the-life-scientists)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-25T16:38:45.233

化学中有许多令人兴奋的机会。有一个强大的开源社区，其中大部分是在 Blue Obelisk ( [http://www.blueobelisk.org](http://www.blueobelisk.org) ) 下组织的。在不需要以前的化学知识的可视化和算法方面做出了重大贡献，社区非常欢迎任何希望提供帮助的人。

有关已实现标准的示例，请查看 Jmol，它以 3D 形式可视化分子和其他化学（[http://www.jmol.org](http://www.jmol.org)）；

还有真正的机会在平台/语言之间进行移植。最常见的是 Java、Python、C++，我们一直在使用 C#。您也不必成为 ace 程序员 - 对数据标准、数据资源、教程、打包、安装程序、测试等的贡献都受到高度重视。

其中一些项目在 Sourceforge 上排名前 100-500 的项目中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-25T16:40:36.120

不要忘记，如果您发现一个项目有点过头了，或者您无法真正做出贡献，但您仍然喜欢它的想法，您可以随时捐赠！

# deployment - 如何以编程方式从 Windows Mobile 设备中删除应用程序？

> ID：566918
> 
> 赞同：1
> 
> 时间：2009-02-19T20:03:58.090
> 
> 标签：deployment, windows-mobile

我们最近更新了一个 Windows Mobile 应用程序，我想创建一个实用程序，它将：

1.  从设备中删除旧版本
2.  安装 .NET Compact Framework
3.  安装新应用

步骤 2 和 3 看起来很简单，但我不知道 1\. 可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T20:08:54.913

每次我尝试安装手机上已经存在的应用程序时，操作系统都会告诉您它将首先删除当前安装的版本（只要公司名称/应用程序名称保持不变）。

因此，通过执行#3，它应该自动执行#1。

这是在我的 WM 6.1 手机上。

# javascript - 如何将 JavaScript 字符串下载为文件

> ID：566922
> 
> 赞同：4
> 
> 时间：2009-02-19T20:05:11.317
> 
> 标签：javascript, ajax, file-io

应用程序通过 AJAX 从服务器请求 KML 数据。此数据存储在 javascript 变量中，并显示在 Google 地球插件中。

在 javascript 中，如何提供一个链接来下载存储在 javascript 变量（作为字符串）中的 KML 数据，而不需要向服务器发送请求？

此链接： http: [//forum.mootools.net/viewtopic.php?id=9728](http://forum.mootools.net/viewtopic.php?id=9728)

建议使用数据 URI，但这可能无法在足够多的浏览器上满足我的需要。可能最简单的只是返回服务器以再次获取数据以供下载，但好奇是否有人使用 javascript 完成了此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T20:19:22.897

简短的回答：你不能而且仍然是平台独立的。大多数浏览器只是不允许 javascript 操作文件系统。

也就是说，您可能能够摆脱一些非常特定于平台的黑客攻击。例如，IE 提供了 execCommand 函数，您可以使用它来调用 SaveAs。如果您在具有要保存的数据的 IFrame 中执行此操作，您可能会使其正常工作——但仅限于 IE。其他选项（再次，我将在此处针对 Microsoft）包括[此 Silverlight hack](http://pagebrooks.com/archive/2008/07/16/save-file-dialog-in-silverlight.aspx)或 ActiveX 控件。

我认为为了实现全平台兼容性，您只需要接受它并提供服务器端下载选项即可。

[编辑] 哎呀！我在寻找链接时没有做足够的尽职调查。事实证明，我链接到的 Silverlight hack 有一个服务器端组件。看起来你很SOL。

[[Edit2] 我在这里](http://www.quirksmode.org/dom/execCommand.html)找到了 execCommand 的浏览器兼容性的一个很好的总结。虽然它列出了“saveas”命令的问号，但也许这对你来说可能是一条好路。也许值得一试？

[Edit3] 好吧，我决定对我建议的方法进行概念验证，并且我在 IE 中得到了一些相当简单的工作。不幸的是，我在这个过程中证明了这种方法[不适用于 Firefox](https://developer.mozilla.org/en/Rich-Text_Editing_in_Mozilla#Executing_Commands)，并且似乎也不适用于 Chrome/Safari。所以它非常依赖于平台。但它有效！这是一个完整的工作页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Javascript File Saver</title>
    <script type="text/javascript">
      function PageLoad() {
        var fdoc = window.frames["Frame"].document;
        fdoc.body.appendChild(fdoc.createTextNode("foo,bar,baz"));
      }
      function Save() {
        var fdoc = window.frames["Frame"].document;
        fdoc.execCommand("SaveAs", true);
      }
    </script>
</head>
<body onload="PageLoad();">
<h2>Javascript File Saver</h2>
<iframe id="Frame" style="width: 400px;">Noframe</iframe><br />
<button onclick="Save();">Save</button>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T21:42:13.973

是的，恐怕您必须将其传回服务器。制作一个通用的“回声”脚本，吐出任何提供给它的参数。

至少您可以使用正确的 MIME 类型强制下载：

```
"content-disposition","attachment; filename=data.xml" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T12:41:03.417

你可能想看看这个：它叫做[Downloadify](https://github.com/dcneiner/Downloadify)。它混合使用 Javascript 和 Flash，并且可以以几乎任何格式保存字符串。试用[演示](http://pixelgraphics.us/downloadify/test.html)并亲眼看看！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-25T21:30:28.530

查看[http://regany.com/blog/2014/05/30/convert-a-string-to-a-download-file-in-javascript/](http://regany.com/blog/2014/05/30/convert-a-string-to-a-download-file-in-javascript/)

启用弹出窗口并使用以下代码：

```
var str = "the string you wan't to download";
window.open('data:text/plain,' + encodeURIComponent(str)); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-11-15T07:44:23.343

这会奏效！这个对我有用。

[在此处输入链接描述](https://ourcodeworld.com/articles/read/189/how-to-create-a-file-and-generate-a-download-with-javascript-in-the-browser-without-a-server)

```
`function download(filename, text) {
  var element = document.createElement('a');
  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
  element.setAttribute('download', filename);

  element.style.display = 'none';
  document.body.appendChild(element);

  element.click();

  document.body.removeChild(element);
}

// Start file download.
download('hello.txt','This is the content of my file ');

`
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-10T15:32:01.363

可能它会很有用（JSP 变体）：

```
 private void printSaveStringButton(String fileName, String content) throws Exception {
        //add new invisible container with write / save functions
        out.println("<iframe id=\"xmlContentId\" style=\"display:none;\"></iframe>");
        //save string in js variable
        String jScript = "\n" +
                "var SaveHelper = {\n" +
                "    content : null,\n" +
                "    saveContent : function(filename, text) {\n" +
                "        text=(SaveHelper.content!=null)?SaveHelper.content:text;\n" +
                "        var doc = document.getElementById('xmlContentId').contentWindow.document;\n" +
                "        doc.write(text);\n" +
                "        doc.execCommand(\"saveAs\",true,filename);\n" +
                "        doc.close();\n" +
                "    }\n" +
                "};\n" +
                "SaveHelper.content = '" + org.apache.commons.lang.StringEscapeUtils.escapeJavaScript(content) + "';\n";
        out.println("<script type=\"text/javascript\">" + jScript + "</script>");
        //add button that writes content into iframe container and show save dialog.
        out.println("<button type=\"button\" onclick=\"SaveHelper.saveContent('"+fileName+"' )\">Save as...</button>");
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-04T23:17:44.033

您可能可以使用 parseKml 函数来解析 javascript 变量中的 kml 数据，而不是尝试将其存储在文件中并从 javascript 修改它（由于安全原因，我认为这是不可能的）

[https://developers.google.com/earth/documentation/kml](https://developers.google.com/earth/documentation/kml)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-19T20:14:48.210

坦率地说，我认为这是不可能的。从来没有想过这可以在javascript中完成。

# c# - 根据字符串大小写对列表进行排序

> ID：566940
> 
> 赞同：3
> 
> 时间：2009-02-19T20:12:06.000
> 
> 标签：c#, sorting, list

如何按大小写顺序对列表进行排序，例如

*   smtp:user@domain.com
*   smtp:user@otherdomain.com
*   SMTP:user@anotherdomain.com

我想排序，以便大写记录在列表中排在第一位，例如 SMTP:user@anotherdomain.com。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-19T20:23:30.407

您可以使用 StringComparer.Ordinal 进行区分大小写的排序：

```
 List<string> l = new List<string>();
        l.Add("smtp:a");
        l.Add("smtp:c");
        l.Add("SMTP:b");

        l.Sort(StringComparer.Ordinal); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T20:58:44.440

我正在写另一个例子，而 t4rzsan 已经回答了=）我更喜欢 t4rzsan 的答案......无论如何，这是我正在写的答案。

```
//Like ob says, you could create your custom string comparer
public class MyStringComparer : IComparer<string>
{
    public int Compare(string x, string y)
    {
        // Return -1 if string x should be before string y
        // Return  1 if string x should be after string y
        // Return  0 if string x is the same string as y
    }
} 
```

使用您自己的字符串比较器的示例：

```
public class Program
{
    static void Main(string[] args)
    {
        List<string> MyList = new List<string>();

        MyList.Add("smtp:user@domain.com");
        MyList.Add("smtp:user@otherdomain.com");
        MyList.Add("SMTP:user@anotherdomain.com");

        MyList.Sort(new MyStringComparer());

        foreach (string s in MyList)
        {
            Console.WriteLine(s);
        }

        Console.ReadLine();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T20:15:12.420

大多数语言库都有一个内置的排序函数，可以指定比较函数。您可以自定义比较功能以根据您想要的任何标准进行排序。

在您的情况下，默认排序功能可能会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T20:21:03.563

您需要创建一个实现 IComparer 的自定义比较器类

# html - 三列布局，左右列有多个 div

> ID：566941
> 
> 赞同：1
> 
> 时间：2009-02-19T20:12:12.753
> 
> 标签：html, css

我有一些看起来像这样的 HTML：

```
<body>
    <div id="panel1" class="panel"> Panel 1 </div>
    <div id="panel2" class="panel"> Panel 2 </div>
    <div id="panel3" class="panel"> Panel 3 </div>
    <div id="panel4" class="panel"> Panel 4 </div>
    <div id="panel5" class="panel"> Panel 5 </div>
    <div id="panel6" class="panel"> Panel 6 </div>
    <div id="panel7" class="panel"> Panel 7 </div>
    <div id="contentheader"> Header </div>
    <div id="content"> Content </div>
</body> 
```

我想要的是一些面板（比如 1-4）浮动在左侧，其他面板（5-7）浮动在右侧，标题和内容介于两者之间，理想情况下不必换行包装器 div 中的左右面板。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-19T20:19:51.803

使用易于使用的 CSS 框架，例如[Blueprint CSS](http://www.blueprintcss.com/)、[The Golden Grid](http://code.google.com/p/the-golden-grid/)或[960](http://960.gs/)。他们为开发基于网格的网站（例如您正在开发的网站）提供了出色的跨平台支持。您根本不必担心细节问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T20:28:34.827

将#contentHeader 和#content 包装在一个div 中并像您的面板之一一样浮动它怎么样？您必须将其放在其中...（div1、2、3、4、内容、5、6、7）。

我会说，这取决于您对面板宽度和内容的了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T22:06:20.063

如果您知道面板的宽度（左、右、标题和内容）和标题的高度，您可以给标题和内容一个**{ position: absolute; }**并将其定位在面板之间。

如果您不知道内容的宽度，您可能会遇到一些 IE 问题...

（只是猜测，我没试过）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T22:12:05.073

答案完全取决于您是否希望中间列是固定宽度或流动的。

如果固定宽度，你的生活会轻松很多，你可以使用几种流行的 CSS 网格系统之一：[blueprint](http://www.blueprintcss.org/)、[yui](http://developer.yahoo.com/yui/grids/)、[960](http://960.gs/)等。

如果是流动的，您应该使用[alistpart.com 中概述的 3 列技术](http://www.alistapart.com/articles/holygrail)。

# windows - 适用于 Windows XP 和 2003 的 Windows 批处理选择命令

> ID：566944
> 
> 赞同：6
> 
> 时间：2009-02-19T20:13:06.870
> 
> 标签：windows, batch-file, cmd, windows-xp

有没有办法提示用户从可在 XP 和 Windows 2003 服务器上运行的 Windows 批处理脚本中输入输入（即：是/否）？似乎某些命令（即：选择）仅适用于一个操作系统而不适用于其他操作系统。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-19T20:16:38.533

使用带有 /P 开关的[SET命令。](http://www.computerhope.com/sethlp.htm)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-20T00:01:13.500

```
SET /P RESULT=Y or N?
ECHO %RESULT% 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-10T16:20:20.150

请注意，该`SET /P`命令不支持与该`CHOICE`命令相同的所有功能。即：

*   它不限制用户输入有效值
*   用户必须按回车
*   您必须检查大小写差异（例如“A”与“a”）
*   没有办法在一定时间后默认某个选择

由于这些原因，我仍然更喜欢使用`CHOICE`命令而不是`SET /P`命令。为此，您只需要在批处理文件中包含**CHOICE.COM 。***您可以通过MS-DOS 6.22 Supplemental Disk*从 Microsoft下载**CHOICE.COM**。这是链接：

 *[http://support.microsoft.com/kb/117600](http://support.microsoft.com/kb/117600)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-20T19:20:07.430

这基本上会模仿选择的作用，您需要将其作为子程序放在批处理文件中。我也更喜欢选择，但我需要可以在 Windows XP 上运行的便携式设备。

然后您可以修改它以接受其他“选择”，但是这将不区分大小写并重复提示，直到用户明确输入 Y、y、N 或 n。

```
:yesorno
set /p choice=%2
if /i NOT %choice% == n (
    if /i NOT %choice% == y goto yesorno
)
set "%~1=%choice%"
goto :eof 
```

然后，您将通过以下方式调用此子例程：

```
call :yesorno answer "Do you want to continue? [Y/n]: " 
```

到目前为止，它对我来说效果很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-06T07:23:28.443

例如你可以使用这个：

```
SET /P ANSWER=y OR n?
If "%answer%"=="y" goto yes
If "%answer%"=="n" goto no 
```

享受！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-09-14T11:07:32.547

Windows Millenium 的 CHOICE.COM 在 XP SP3 下对我来说可以正常工作。但是，我的语言是匈牙利语，但您可能会找到它的原始英文变体，例如搜索“windows millenium ebd”。

[http://s000.tinyupload.com/index.php?file_id=57468192666746678653](http://s000.tinyupload.com/index.php?file_id=57468192666746678653)

# php - 是否允许 PHP 修改当前文件夹中的 .htaccess 文件？

> ID：566950
> 
> 赞同：3
> 
> 时间：2009-02-19T20:14:43.497
> 
> 标签：php, apache, .htaccess, mod-rewrite, permissions

我有一个位于**共享主机**上的 PHP Web 应用程序。我的目标是在 PHP 页面运行时从 PHP 代码修改 .htaccess 文件。我需要那个 .htaccess 在其中插入几行 mod_rewrite 行。

问题是在 Windows+Apache 上我可以动态修改 .htaccess 文件，但是当我尝试以任何方式（复制或 fopen）访问此文件时，Linux 上的相同代码会报告问题：

`"failed to open stream: Permission denied"`

我已授予 .htaccess 文件 777 权限 - 仍然没有结果。是什么阻止我这样做？如何开发解决方法？

PS 我最初的目标是能够将新的 RewriteRule 添加到 .htaccess 中，它将新添加的 category_id 与新的 category_name 映射。

如果它不是共享主机，我会使用 RewriteMap 之类的东西（在主要的 Apache 配置中）并且能够访问地图文件。

这是我无法用 PHP+Apache 解决的第一个真正的限制，但我希望它也是可以绕过的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T20:19:19.823

这似乎是一个过于复杂的解决方案，仅具有一个通用的“加载类别”页面，该页面从 URL 获取类别名称并加载相应的 ID。

例如，如果 URL 是：

```
http://yoursite.com/category/programming 
```

我会将其重新映射为：

```
http://yoursite.com/category.php?name=programming 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-19T21:53:11.997

我想建议一些其他也有效的东西。与其为每个“特殊”网址编写规则，不如为所有人使用一个规则？

我发现使用 wordpress 使用的东西要容易得多：每个 url 都被重定向到索引。

您所要做的就是设置索引文件，读取加载的目录（可能使用 $_SERVER['URI_REQUEST']），然后处理它。

添加到 .htaccess 这个：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

多亏了那个块，您可以使用一个不受限制的系统。如果您想重命名您的类别 url，或者添加另一个特殊情况，它已经准备好了！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T20:36:16.280

您只需要一小组重写规则。按照乍得的建议做：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^/category/.*$ category.php [QSA] 
```

因此，无论何时有人导航到`/category/category_id`，请求都会被定向到，其中的URI`category.php`将被传递，您可以从中轻松获取类别 ID，并且您无需在每次添加时都编辑 .htaccess 文件一个类别。`/category/``$_SERVER['REQUEST_URI']`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-20T00:14:54.903

虽然我同意上述评论，但绝对可以做到。像 WordPress 这样的 PHP 应用程序正是根据设置页面上所做的更改来执行此操作的。它应该像写出文件一样简单，但是父目录需要具有 Web 服务器用户写入它的权限。

如果它对您不起作用，则诀窍是将父目录设置为 777 或 775，并将组设置为 Apache 运行的任何组（通常是“apache”或“www”或类似的东西）

亚当（对您的问题发表了评论）虽然非常正确，但您服务器上的其他一些安全层可能会阻止您这样做，这可能很好地表明您可能以错误的方式解决问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-19T20:25:52.850

我同意乍得·伯奇的观点。但是，如果您不能被劝阻，在您的情况下，我会首先寻找具有锁定权限的父目录。

仅供参考，重写 .htaccess 是一个坏主意的原因之一是在重写 .htaccess 时传入的任何请求*都*不会应用任何重定向。

# c# - .NET 上的双精度问题

> ID：566958
> 
> 赞同：17
> 
> 时间：2009-02-19T20:15:55.307
> 
> 标签：c#, .net, math, double

我有一个简单的 C# 函数：

```
public static double Floor(double value, double step)
{
    return Math.Floor(value / step) * step;
} 
```

计算大于或等于“值”的较大数字，即“步长”的倍数。但它缺乏精确度，如以下测试所示：

```
[TestMethod()]
public void FloorTest()
{
    int decimals = 6;
    double value = 5F;
    double step = 2F;
    double expected = 4F;
    double actual = Class.Floor(value, step);
    Assert.AreEqual(expected, actual);
    value = -11.5F;
    step = 1.1F;
    expected = -12.1F;
    actual = Class.Floor(value, step);
    Assert.AreEqual(Math.Round(expected, decimals),Math.Round(actual, decimals));
    Assert.AreEqual(expected, actual);
} 
```

第一个和第二个断言都可以，但第三个断言失败，因为结果只相等到小数点后 6 位。这是为什么？有什么办法可以纠正这个吗？

**更新**如果我调试测试，我发现这些值在小数点后第 8 位而不是第 6 位是相等的，可能是因为 Math.Round 引入了一些不精确性。

**注意**在我的测试代码中，我写了“F”后缀（显式浮点常量），我的意思是“D”（双精度），所以如果我改变它，我可以有更高的精度。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-07-03T11:37:37.530

我实际上有点希望他们没有为浮点数和双打实现 == 运算符。询问 double 或 float 是否等于任何其他值几乎总是错误的做法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-19T20:24:19.143

计算机上的浮点运算不是精确科学:)。

如果您想要精确到预定义的小数位数，请使用 Decimal 而不是 double 或接受较小的间隔。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-19T21:00:03.907

如果您想要精确，请使用 System.Decimal。如果您想要速度，请使用 System.Double（或 System.Float）。浮点数不是“无限精度”数，因此断言相等必须包含容差。只要您的数字具有合理数量的有效数字，就可以了。

*   如果您希望对非常大和非常小的数字进行数学运算，请不要使用浮点数或双精度数。
*   如果您需要无限精度，请不要使用浮点数或双精度数。
*   如果要聚合大量值，请不要使用 float 或 double （错误会自行加剧）。
*   如果您需要速度和大小，请使用 float 或 double。

有关精度如何影响数学运算结果的详细分析，请参阅[此答案（也是我的答案）。](https://stackoverflow.com/questions/803225/when-should-i-use-double-instead-of-decimal/803260#803260)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-19T20:31:22.217

如果您省略所有 F 后缀（即`-12.1`代替`-12.1F`），您将获得更多位数的相等性。您的常量（尤其是预期值）现在是浮动的，因为`F`. 如果您是故意这样做的，请解释一下。

但对于其余部分，我同意其他关于比较双精度或浮点值是否相等的答案，它只是不可靠。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-19T20:31:52.777

[http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)

> 例如，0.1 和 0.01（二进制）的不可表示性意味着尝试将 0.1 平方的结果既不是 0.01，也不是最接近它的可表示数。

如果您想要机器对数字系统的解释（二进制），请仅使用浮点数。你不能代表 10 美分。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-19T20:21:48.273

检查这个问题的答案：[检查浮点值是否等于 0 是否安全？](https://stackoverflow.com/questions/485175/c-net-is-it-safe-to-check-floating-point-values-for-equality-to-0)

真的，只需检查“在...的容差范围内”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-19T20:25:11.573

浮点数和双精度数无法准确存储所有数字。这是 IEEE 浮点系统的限制。为了获得忠实的精度，您需要使用更高级的数学库。

如果您不需要超过某个点的精度，那么十进制对您来说可能会更好。它具有比双精度更高的精度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-22T08:25:02.717

对于类似的问题，我最终使用了以下实现，这似乎在我的大部分测试用例中都成功了（最高 5 位精度）：

```
public static double roundValue(double rawValue, double valueTick)
{
    if (valueTick <= 0.0) return 0.0;

    Decimal val = new Decimal(rawValue);
    Decimal step = new Decimal(valueTick);
    Decimal modulo = Decimal.Round(Decimal.Divide(val,step));

    return Decimal.ToDouble(Decimal.Multiply(modulo, step));
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-12T01:50:13.607

有时结果比您对 strict:FP IEEE 754 所期望的更精确。那是因为硬件使用更多位进行计算。请参阅[C# 规范](http://msdn.microsoft.com/en-us/library/aa691146%28VS.71%29.aspx)和[本文](http://blogs.msdn.com/davidnotario/archive/2005/08/08/449092.aspx)

Java 有 strictfp 关键字，C++ 有编译器开关。我想念.NET 中的那个选项

# c# - 当 DataSource 不返回完整结果集时手动设置 GridView 的 PageCount？

> ID：566981
> 
> 赞同：11
> 
> 时间：2009-02-19T20:23:34.400
> 
> 标签：c#, asp.net-2.0

我试图弄清楚 ASP.NET 的`GridView`分页机制，以便我可以使用框架的本机功能，而不是我公司自制的手动分页例程，这需要大量工作才能实现。

`GridView`除了如何让的 PageCount 属性与我们的 Web 服务一起工作之外，我已经弄清楚了一切。目前，我们的 Web 服务返回总记录数，如下所示：

```
public object[] GetStuffMethod(int pageNum, int recordsPerPage, out int totalRecords) 
```

这适用于 GridView，但是我发现的文档说`GrideView`'`PageCount`属性是从 DataSource 中的总记录生成的。除了返回所有记录之外，真的没有办法根据其他东西设置 PageCount 吗？

我的数据源中可能有数以万计的记录，所以我宁愿不选择所有记录，只是为了使 GridView 的页数起作用。我可能会忽略 GridView 的页数并自行计算，但如果框架有办法做到这一点，我宁愿使用它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-19T20:29:16.730

您必须设置 AllowCustomPaging="true"。当数据绑定时：

```
mygrid.VirtualItemCount = totalRecords;
mygrid.DataSource = mysource;
mygrid.DataBind(); 
```

**更新 1：**以上仅适用于数据网格。不幸的是，使用 gridview 进行服务器端分页的唯一受支持的方法是实现对象数据源或实现自定义数据源。这是相关的 msdn 文档[http://msdn.microsoft.com/en-us/library/5aw1xfh3.aspx](http://msdn.microsoft.com/en-us/library/5aw1xfh3.aspx)。

**更新 2：**此方法现在适用于 .Net 4.5 的 GridView

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-19T20:35:45.517

我强烈建议您使用 ObjectDataSource 路线。

如果您不熟悉这种方法，这里是基础知识：

1) 不是在后面的代码中手动设置 grid.DataSource 属性，而是向页面添加一个额外的元素。您将网格的 DataSourceID 设置为 ObjectDataSource 的 id。

2）这是您获得真正控制的地方。您创建一个新类并为其提供两个函数“SelectRows()”和“GetCount()”。你可以把你的逻辑放在这两个函数中，并根据你的内心进行优化。如果您需要使用 Web 服务，请随意使用，但在此方法下，您可以调用 one 来返回行，而调用 other 来返回计数。

3) 使用 ObjectDataSource 的属性编辑器将其连接到您的类并启用分页。你都准备好了！

我强烈建议您查看[The Code Project 的使用 ObjectDataSource 和 GridView 的示例，](http://www.codeproject.com/KB/aspnet/PagingWithODS.aspx)因为这显然是支持您想要的内容的预期方式。

祝你好运！

# c# - 有没有办法可以从包含代码的字符串中动态定义谓词主体？

> ID：566984
> 
> 赞同：3
> 
> 时间：2009-02-19T20:24:56.300
> 
> 标签：c#, .net, lambda, extension-methods

这可能是一个愚蠢的问题，但在这里。就此而言，我希望能够从从数据库 VARCHAR 列或任何字符串解析的字符串动态构造谓词 < T >。例如，假设数据库中的列包含以下字符串：

```
return e.SomeStringProperty.Contains("foo"); 
```

这些代码/字符串值将存储在数据库中，知道通用“e”的可能属性是什么，并且知道它们必须返回一个布尔值。然后，在一个神奇、奇妙、奇幻的世界中，代码可以在不知道谓词是什么的情况下执行，例如：

```
string predicateCode = GetCodeFromDatabase();
var allItems = new List<SomeObject>{....};
var filteredItems = allItems.FindAll(delegate(SomeObject e) { predicateCode }); 
```

或 Lambda 化：

```
var filteredItems = allItems.FindAll(e => [predicateCode]); 
```

我知道它可能永远不会这么简单，但是有没有办法，也许使用 Reflection.Emit，从文本动态创建委托代码并将其提供给 FindAll < T > （或任何其他匿名/扩展）方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T20:35:27.700

查看 Dynamic Linq 项目，它完成了所有这些以及更多工作！

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

非常适合简单的东西，比如用户选择的 orderby 或 where 子句

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T20:59:07.247

C# 和 VB 编译器可从 .NET Framework 中获得：

[C# CodeDom 提供程序](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)

但请注意，这样您最终会得到一个单独的程序集（只有在单独的 AppDomain 中才能卸载它）。这种方法只有在您可以一次编译所有需要的谓词时才可行。否则会涉及太多开销。

System.Reflection.Emit 是一个很棒的 AP​​I，用于为 CLR 动态发出代码。但是，它使用起来有点麻烦，您必须学习 CIL。

LINQ 表达式树是一个易于使用的后端（编译为 CIL），但您必须编写自己的解析器。

我建议您看一下在 CLR（或 DLR）上运行的“动态语言”之一，例如[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)。如果您问我，这是实现此功能的最有效方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T20:50:57.090

可以使用[emit](http://www.devhood.com/Tutorials/tutorial_details.aspx?tutorial_id=238)，但您将构建自己的解析器。

**编辑**

我记得在 ScottGu 的 PDC 主题演讲中，他展示了一个使用 .net 框架的 CLI 版本的功能，该功能类似于 Ruby 的 eval，但我找不到可以证实这一点的 URL。我将其设为社区 wiki，以便任何拥有良好链接的人都可以添加它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-03T09:21:11.447

我退出了动态 linq，因为它在我想要搜索集合的方式上受到限制，除非你证明我错了。

我的过滤器需要是：在订单列表中，过滤列表，以便我只有在该订单的项目集合中的订单，一个名为“可口可乐”的项目。

所以这将导致一种方法：`orders.Findall(o => o.Items.Exists(i => i.Name == "coca cola"))`

在动态 linq 中，我没有找到任何方法来做到这一点，所以我从`CodeDomProvicer`. `Type`我使用包含我动态构建的方法的方法创建了一个新`FindAll`方法：

```
public static IList Filter(list, searchString)
{
   // this will by dynamically built code
   return orders.Findall(o => o.Items.Exists(i => i.Name == "coca cola"));
} 
```

当我尝试构建这个程序集时：

```
CompilerResults results = provider.CompileAssemblyFromSource(parameters, sb.ToString()); 
```

我收到错误：

```
Invalid expression term ">" 
```

为什么编译器不能编译谓词？

# virtualization - 分离服务器或虚拟化，哪个更高效？

> ID：566988
> 
> 赞同：2
> 
> 时间：2009-02-19T20:26:00.260
> 
> 标签：virtualization

我的公司正在托管几个独立但相关的中等受欢迎的网站。因此，需要生产数据库服务器、登台数据库服务器、生产网络服务器、登台网络服务器等。我的问题是，我们应该为我们的每个需求投资物理上独立的服务器，还是应该把这些钱放在一起投资更高端的服务器并虚拟化所有上述服务器？你们会选择哪条路线，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T20:32:06.990

这取决于很多事情，这里是主要考虑因素。

如果您有大量使用率低到中等的服务器，则虚拟化通常可以为您节省硬件、电源和占地面积方面的资金。然而，基于 VM 层本身的开销，存在一个临界点。老实说，您将不得不尝试在这方面找到合适的成本/性能平衡。我相信 VM 供应商会很乐意帮助您解决数学问题。

缺点是虚拟化会产生单点故障。如果该框出现故障，您的所有服务器都有停机时间。将它们分开可以大大降低所有东西一次潜水的可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T20:31:11.467

您当然希望开发服务器和生产服务器之间进行物理分离。您不必担心您在 dev 中所做的某些事情可能会导致托管生产的机器停机。而且，在开发过程中存在一些问题，它们确实需要物理机的硬重置或可笑的变通方法以避免硬重置。

至于生产网络服务器和生产数据库，通过在同一台机器上虚拟化它们并不会真正引入任何新的故障点，特别是如果您可以将站点的静态版本托管在另一台服务器上。对于任何具有中等复杂性的现代网站，数据库故障无论如何**都是**网站故障。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T21:01:20.550

根据我的经验，对于低使用率或中等使用率，VM 是可行的方法 - 如果您只使用一台非常强大的服务器，而不是在几台性能中等的服务器上，您可以节省资金、电力和空间，同时让应用程序更快，因为它正在运行在更快的硬件上。

虚拟机还有另一个很好的优势，如果服务器硬件出现故障，您可以在不同的物理硬件上加载相同的虚拟机并继续运行，就像什么都没发生一样（您确实有完整的备份，不是吗？），您可以复制实际的生产服务器并在开发机器上单独运行它以调试那些只出现在生产中的烦人的错误。

但是我会将开发（可能还有测试）服务器放在与生产不同的物理机器上，您需要确保无论您在开发中犯了什么愚蠢的错误，它都不会关闭生产服务器。

# nhibernate - NHibernate - 这是什么类型的关联？

> ID：566990
> 
> 赞同：1
> 
> 时间：2009-02-19T20:27:34.893
> 
> 标签：nhibernate, nhibernate-mapping

我在让 NH 持久化我的对象图时遇到了一些麻烦。

我有（类似的）这个：

```
/*Tables*/
TABLE Parent
  ParentID PK 
  LastEventID NULL

TABLE Event
  EventID PK
  ParentID FK NOT NULL 
```

* * *

```
//Model Classes

public class Parent
{
    public List<Event> Events;  //Inverse

    //Denormalized bit
    public Event LastEvent;  //not inverse

}

public class Event
{
    public Parent Parent;  //Makes the association up there Inverse
} 
```

我正在创建一个新的父级，创建一个新的事件，将新的事件添加到 Parent.Events 并将 Parent.LastEvent 设置为新的事件。

当我告诉 NH 保存父对象时，我收到一个关于需要首先保存的瞬态对象的错误。我假设它是因为 Parent 和 Event 之间的关联尚不清楚。

SQL 需要采用的方式是使用 null LastEvent 插入 Parent，然后插入 Event，然后更新 Parent.LastEvent。

那么我如何让 NH 做到这一点呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T21:27:53.693

如果没有看到您的映射模式，我将不得不猜测。

你在级联你的更新吗？从[参考](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/manipulatingdata.html#manipulatingdata-graphs "NHibernate 参考")：

> 要保存或更新关联对象图中的所有对象，您必须
> 
> *   Save()、SaveOrUpdate() 或 Update() 每个单独的对象或
> *   使用 cascade="all" 或 cascade="save-update" 映射关联对象。

假设您还没有这个，将 cascade="all" 或 cascade="save-update" 添加到标记为 inverse="true" 的一侧是否可以解决问题？

# asp.net - 间歇性问题加载类型

> ID：566991
> 
> 赞同：2
> 
> 时间：2009-02-19T20:27:57.107
> 
> 标签：asp.net, sharepoint, pageload

我有一个 SharePoint 网站，为了处理一些自定义 AJAX 请求，我添加了一些额外的页面。

时不时地，大约每周一次，我接到一个电话，说它不起作用。当我查看它时，我收到的错误是：

```
Could not load type 'My_Controls.Control_Name' . 
```

其中 My_Controls.Control_Name 是页面的名称。重新启动 IIS 可以解决问题并使其再次运行，但这显然是客户端非常关心的问题。

我已经尝试了我能想到的一切。过去我遇到这种情况时，通常设置编译批处理 =“false” 可以解决问题，但这次并没有解决问题。

显然，这是一个很难解决的问题，因为没有办法重现这个错误（它只是不时弹出），而一个简单的 IIS 重新启动就可以解决它。

有谁知道是什么可能导致这个或想法尝试修复它？

谢谢

# security - 使用主键/ID 字段作为 URL 中的标识符

> ID：566996
> 
> 赞同：11
> 
> 时间：2009-02-19T20:28:41.723
> 
> 标签：security, database-design, friendly-url

使用数据库主键作为 URL 标识符的优缺点是什么？例如，[http://localhost/post/view/13](http://localhost/post/view/13) - 13 是我的帖子表的主键。

像reddit这样的一些网站使用我认为不是主键但仍然是唯一的唯一ID来帮助识别链接：

```
http://www.reddit.com/r/funny/comments/7ynin/the_mystery_of_irelands_worst_driver/
```

只要 /7ynin/ 相同，您就可以将 URL 的最后一部分更改为您想要的任何内容。

* * *

Digg 似乎使用链接标题的 slug 来标识链接：

```
http://digg.com/space/Liquid_Water_Recently_Seen_on_Mars
```

* * *

如果我没记错的话，默认的 WordPress 安装使用 index.php?p=# 作为他们的 id，直到启用花哨的 url。

* * *

我可以理解为什么为了 SEO 的缘故，您可能希望获得信息量最大的 url，但我只是想看看使用主键是否存在安全风险，或者只是形式不佳。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-02T16:05:35.393

您总是希望向用户呈现一个漂亮的 URL，而不是一些讨厌的自动生成的 ID。但我认为您不应该将所说的“友好 url”作为主键。您仍然应该使用“经典”自动递增的数字 PK，并有第二列是唯一的“友好 url”。为什么？

1.  所有评论表、评级表，以及与您的内容表有关系的任何表都可以使用数字主键。这意味着更小的索引和更低的内存使用。
2.  有人会想要更改友好的网址。如果您有一个数字主键，则不必更新任何依赖表（或让数据库通过级联更新来完成）。
3.  将来，您可以将 URL 位抽象到另一个表中。然后，所述表可以存储发出重定向到主要“真实”URL映射的“遗留”URL映射。然后，当用户想要更改友好 URL 时，您不必破坏所有入站旧 URL。如果您的主键是“友好 URL”，则无法执行此操作。
4.  我仍然倾向于在我的所有 AJAX goo 中使用数字主键（例如，post_new_comment() javascript 函数将采用主键，而不是一些友好的 URL）。我唯一一次使用友好 URL 是在任何面向用户的 URL 结构中。
5.  至于安全？如果您的内容受访问控制，则无论它是主键还是某个友好 URL，您都必须检查访问权限。
6.  如果您允许通过主键访问内容，人们可能会尝试插入随机 ID。如果您不仅要求限制对内容的访问，而且拒绝所述内容存在，那是您的错误措辞的问题。这与登录失败是一样的——你没有说“找不到用户名”，而是说“用户名或密码错误”。插入随机值来查找内容对于您采用的任何方法都是一个问题，只是使用数字键可以尝试的值更少。

底线：友好的 URL？地狱是的。使用它们作为主键？一定不行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-19T20:38:59.987

正如您所说，将标题直接放在 URL 中的目的是 SEO。在 URL 中包含关键字对搜索引擎结果有重大影响。

但是，与您的示例相关的其他一些想法：

*   我不确定你为什么认为 reddit 字母数字键不是主键，没有什么可以强制主键为数字键。如果它是帖子的唯一标识符，则没有理由不将其用作主键（或至少是其中的一部分）。
*   Digg 实际上强制标题的唯一性（也许只是在特定类别中，我已经很多年没有去过 Digg，所以我不记得了）。我曾经经常看到这个重复的故事，其 URL 如下：

    ```
    http://digg.com/space/Liquid_Water_Recently_Seen_on_Mars_2 
    ```

    这意味着标题至少是主键的一部分，因为这是识别链接打算针对哪个故事的唯一方法。

正如 pantulis 所提到的，除了人们猜测/预测其他主键的能力之外，在 URL 中使用主键并没有任何重大的安全风险。但无论如何，您不应该依赖“没人会猜到这一点”作为安全措施。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T21:11:58.033

如果您*没有*在 URL/链接中包含主键，那么您必须制作某种临时合成键，然后，您必须在会话中为用户保存该键的映射。这会增加更多的状态/内存使用/破坏您的应用程序的东西。

如果该值真的很敏感，那么隐藏它*可能*是值得的。但是，隐藏密钥并不能真正使其安全，不是吗？在授予对项目的访问权限之前，您需要检查任何“控制器”（servlet、代码隐藏等）中的用户角色。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-19T20:34:28.730

它本质上不是安全风险，尽管它确实告诉外部实体有关您的系统的信息，这通常是避免的好习惯。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-23T18:48:10.333

Reddit 也使用数字 ID，但使用[Base 36](http://en.wikipedia.org/wiki/Base_36)进行转换，因此它显示为字符串。它就像十六进制数，实际上也是一个字符串。唯一的区别是基础。

Base 36 是“使用 ASCII 字符的最紧凑的不区分大小写的字母数字系统”，它易于编码和解码。为什么是36？AZ = 26 + 0-9 = 10。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-19T20:30:25.790

一个缺点：任何访问者都可以轻松尝试并猜测其他 ID，这可能不是您想要的。

# sql-server - 在 mssql 中只获取 DateTime 的 Date 部分

> ID：566998
> 
> 赞同：34
> 
> 时间：2009-02-19T20:29:04.593
> 
> 标签：sql-server, datetime

> **可能重复：**
> [仅从 SQL Server 中的 DateTime 列中选择分组中获取日期](https://stackoverflow.com/questions/542780/get-just-the-date-from-grouping-in-select-from-datetime-column-in-sql-server)

如何仅获取 DateTime 的 Date 部分？我正在寻找类似 year() 函数的东西，但要寻找整个日期。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-09-10T14:52:28.643

这也可能有帮助：

```
SELECT convert(varchar, getdate(), 100) -- mon dd yyyy hh:mmAM (or PM)
                                        -- Oct  2 2008 11:01AM
SELECT convert(varchar, getdate(), 101) -- mm/dd/yyyy - 10/02/2008                  
SELECT convert(varchar, getdate(), 102) -- yyyy.mm.dd – 2008.10.02           
SELECT convert(varchar, getdate(), 103) -- dd/mm/yyyy
SELECT convert(varchar, getdate(), 104) -- dd.mm.yyyy
SELECT convert(varchar, getdate(), 105) -- dd-mm-yyyy
SELECT convert(varchar, getdate(), 106) -- dd mon yyyy
SELECT convert(varchar, getdate(), 107) -- mon dd, yyyy
SELECT convert(varchar, getdate(), 108) --  hh:mm:ss
SELECT convert(varchar, getdate(), 109) -- mon dd yyyy hh:mm:ss:mmmAM (or PM)
                                        -- Oct  2 2008 11:02:44:013AM   
SELECT convert(varchar, getdate(), 110) -- mm-dd-yyyy
SELECT convert(varchar, getdate(), 111) -- yyyy/mm/dd
SELECT convert(varchar, getdate(), 112) -- yyyymmdd
SELECT convert(varchar, getdate(), 113) -- dd mon yyyy hh:mm:ss:mmm
                                        --  02 Oct 2008 11:02:07:577     
SELECT convert(varchar, getdate(), 114) -- hh:mm:ss:mmm(24h)
SELECT convert(varchar, getdate(), 120) -- yyyy-mm-dd hh:mm:ss(24h)
SELECT convert(varchar, getdate(), 121) --  yyyy-mm-dd hh:mm:ss.mmm
SELECT convert(varchar, getdate(), 126) -- yyyy-mm-ddThh:mm:ss.mmm
                                        --  2008-10-02T10:52:47.513
-- SQL create different date styles with t-sql string functions
SELECT replace(convert(varchar, getdate(), 111), '/', ' ') -- yyyy mm dd
SELECT convert(varchar(7), getdate(), 126)                 -- yyyy-mm
SELECT right(convert(varchar, getdate(), 106), 8)          -- mon yyyy 
```

[来源](https://anubhavg.wordpress.com/2009/06/11/how-to-format-datetime-date-in-sql-server-2005/)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-02-19T20:32:27.033

您想要的解决方案是这里提出的解决方案：

[https://stackoverflow.com/a/542802/50776](https://stackoverflow.com/a/542802/50776)

基本上，你这样做：

```
cast(floor(cast(@dateVariable as float)) as datetime) 
```

链接中有一个函数定义，它允许您整合功能并在任何地方调用它（而不必记住它）如果您愿意。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-19T20:37:46.417

另一个漂亮的方法是：

```
DATEADD(dd, 0, DATEDIFF(dd, 0, [YourDate])) 
```

它获取从 DAY 0 到 YourDate 的天数，并将其添加到 DAY 0 以再次设置基线。此方法（或其“衍生物”）可用于许多其他日期操作。

编辑 - 其他日期计算：

每月第一天：

```
DATEADD(mm, DATEDIFF(mm, 0, getdate()), 0) 
```

新年第一天：

```
DATEADD(yy, DATEDIFF(yy, 0, getdate()), 0) 
```

季度第一天：

```
DATEADD(qq, DATEDIFF(qq, 0, getdate()), 0) 
```

上个月的最后一天：

```
DATEADD(ms, -3, DATEADD(mm, DATEDIFF(mm, 0, getdate()), 0)) 
```

本月最后一天：

```
DATEADD(ms, -3, DATEADD(mm, DATEDIFF(m, 0, getdate()) + 1, 0)) 
```

当年的最后一天：

```
DATEADD(ms, -3, DATEADD(yy, DATEDIFF(yy, 0, getdate()) + 1, 0)) 
```

每月第一个星期一：

```
DATEADD(wk, DATEDIFF(wk, 0, DATEADD(dd, 6 - DATEPART(day, getdate()), getdate())), 0) 
```

编辑：没错，乔，它不会将它添加到第 0 天，它会将 0（天）添加到基本上只是将其转换回日期时间的天数。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-17T10:35:47.393

我们可以使用这个方法：

```
CONVERT(VARCHAR(10), GETDATE(), 120) 
```

最后一个参数将格式更改为仅以特定格式获取时间或日期。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-19T20:41:22.023

这可能不像单线那样光滑，但我用它来执行主要用于报告的日期操作：

```
DECLARE @Date datetime
SET @Date = GETDATE()

-- Set all time components to zero
SET @Date = DATEADD(ms, -DATEPART(ms, @Date), @Date) -- milliseconds = 0
SET @Date = DATEADD(ss, -DATEPART(ss, @Date), @Date) -- seconds = 0
SET @Date = DATEADD(mi, -DATEPART(mi, @Date), @Date) -- minutes = 0
SET @Date = DATEADD(hh, -DATEPART(hh, @Date), @Date) -- hours = 0

-- Extra manipulation for month and year
SET @Date = DATEADD(dd, -DATEPART(dd, @Date) + 1, @Date) -- day = 1
SET @Date = DATEADD(mm, -DATEPART(mm, @Date) + 1, @Date) -- month = 1 
```

我用它来获取用于报告和绩效指标等的每小时、每天、每月和每年的日期。*********