# StackOverflow 问答 000374000-000374999

# java - 无头 Eclipse 构建返回 ERRORLEVEL 13

> ID：374007
> 
> 赞同：4
> 
> 时间：2008-12-17T08:45:05.540
> 
> 标签：java, eclipse, build-process, headless

一切进展顺利。Nightly 构建运行了一个多月，没有出现任何问题。但是，突然从 Eclipse 调用功能构建器时，执行立即结束并显示消息。

错误级别 13

据我所知，我没有改变任何东西，因为这台电脑通常不会被触及。（它仅用于夜间构建）。

我用谷歌搜索了这个错误的含义，但无济于事。 [我找到了一个来自 IBM 的链接，该链接显示了一个捕获此错误的自定义 bat 文件，但给出的解释不是很有用。](http://www.ibm.com/developerworks/websphere/library/techarticles/0505_weisz/0505_weisz.html)

我的猜测是，这与工作空间有关，或者整个 Eclipse 安装已损坏。

你知道这个错误是什么意思吗？如何纠正？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T10:07:12.893

在阅读了错误代码的含义后，感谢 VonC 的回答，我明白了在哪里看。这个问题看起来要模糊得多。

我查看了 Eclipse 的配置文件夹（当出现问题时，日志要么写在那里，要么写在 .metadata 文件夹中），我发现了一个巨大的日志文件。在文件中我发现了以下错误：

```
application org.eclipse.sdk not found 
```

以及以下异常，后跟插件名称，多次：

```
java.util.zip.ZipException: Too many open files 
```

多个插件无法加载，导致一系列缺失的依赖项阻止 Eclipse 启动。我在网上搜索了这个异常，发现了以下来自 SUN 的错误描述，它说[Java 1.5.0 无法打开超过 2,100 个 zip 文件](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6423026)。

在我将 Eclipse 的 BABEL 项目翻译安装到构建计算机后一段时间，问题就开始了。这些是 900 多个片段，包含许多插件的翻译，每种语言一个。当我将它安装在现有的 eclipse 安装之上时，打开它们似乎不是问题......直到我清除了构建的工作区。然后 Eclipse 将不再启动。我超过了极限。我试图修复构建的第一件事就是再次......清除所有内容并没有帮助。

因为我只将这台计算机用于无头构建，所以我没有意识到问题出在 Eclipse 本身，我正在查看构建过程的内部。我只有在查看日志文件时才意识到。

安装 Java 1.6.0_11 后，我能够启动 Eclipse 并继续我的构建。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T09:15:52.560

它应该意味着“ ***ant*** **build failed** ”，意味着无头 ant 脚本在某些时候失败。

您应该检查是否可以捕获此脚本生成的日志/输出以分析此 ant 会话并查看 ant 脚本在什么时候失败。

* * *

如果它立即失败，通常是因为：

*   权利变更（写作权限），或
*   在环境变量修改中，或
*   在资源访问中（路径不可访问）。

您还必须检查计算机是否仍在其原始 Windows 域中，以及与运行 ant 脚本的帐户关联的权限（管理员？）是否仍然相同。

# sql-server - 浏览 SQL Reporting Services 时在 IE7 中出现登录对话框

> ID：374009
> 
> 赞同：1
> 
> 时间：2008-12-17T08:47:42.460
> 
> 标签：sql-server, iis, reporting-services, 64-bit

安装程序是 SQL2005 SP2，在 Win2003 64 位上本地安装了 Reporting Services。当用户在[http://server/reports](http://server/reports)上浏览报表管理器时，他们会为每个请求获得登录对话框，但前提是他们使用 IE7。在 FireFox 中一切正常。

该站点位于 IE 上的“本地 Intranet”区域。

它似乎是一个 NTLM，我已经测试过重新安装，更改服务帐户的权限，更改 SRS 目录的权限，没有工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-17T09:57:34.410

**解决方案！**

使用 adsutil.vbs 脚本将 IIS 上的 NTAuthenticationProviders 更改为“NTLM,Negotiate” *（在 \inetpub\adminscripts 中找到的脚本）*

跑

```
cscript adsutil.vbs set w3svc/1/root/NTAuthenticationProviders "NTLM,Negotiate" 
```

*（w3svc/1/是默认网站，把1改成正确的网站nr）*

验证设置运行

```
cscript adsutil.vbs get w3svc/1/root/NTAuthenticationProviders 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T04:12:05.567

用户可以将站点[http://server/reports](http://server/reports)添加到 Internet Explorer 中的受信任站点。

菜单：工具->Internet 选项选项卡：安全 单击受信任的站点图标 单击站点按钮 添加您的报告站点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T21:38:18.623

检查数据源的属性。很多时候问题是不正确的连接方法：

你用的是哪个？

```
Connect using: 
 Credentials supplied by the user running the report 
  Display the following text to prompt user for a user name and password: 

 Use as Windows credentials when connecting to the data source 

 Credentials stored securely in the report server 
  User name:    
Password:    The password is not valid. Please retype the password. 

 Use as Windows credentials when connecting to the data source 
 Impersonate the authenticated user after a connection has been made to the data  source 

 Windows integrated security 
 Credentials are not required 
```

# generics - 为什么泛型经常使用 T？

> ID：374014
> 
> 赞同：11
> 
> 时间：2008-12-17T08:53:08.893
> 
> 标签：generics, naming-conventions

在泛型中使用“T”有什么理由吗？它是某种缩写吗？据我所知，一切正常。例如

```
public G Say<G>(){ ... } 
```

甚至

```
public Hello Say<Hello>(){ ... } 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-17T09:02:36.550

T 代表**类型**。但这实际上只是一种传统，没有什么可以阻止您使用其他名称。例如，通用字典使用`<TKey, TValue>`.

还有一个[Microsoft 指南](http://msdn.microsoft.com/lv-lv/library/ms229040(en-us).aspx)，如果您有一个类型参数，建议使用字母**T** ，如果您有多个类型参数，则在描述性参数名称前加上**T。**这样做将在您的代码中提供更一致的感觉。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-17T08:56:17.827

T 代表类型，就像你说的一切正常。但是把 T 放在那个地方会提醒你这是泛型类型。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-17T08:58:25.170

它只是一个简写，就像 I 通常用于 .NET 中的接口，而在其他环境中，C 有时用于类（Delphi 使用它，IIRC）。

通常，“T”本身的意思是“在这个上下文中的单个类型参数”，如果你有多个类型参数，它们会得到一个 T 前缀，例如`Dictionary<TKey, TValue>`。当您阅读代码时，很明显它是类型参数而不是特定的具体类型。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T08:58:06.887

哦，我会认为 T 代表事物 :)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T10:03:36.833

也可能有一些传统，因为 C++ 模板大部分时间都使用 T，当用于泛型编程时，泛型在功能上与 C++ 的模板相似。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T10:14:04.533

如果你的泛型类型代表一些特殊的东西，你可以让它更精确。通常在它前面加上 T : `IRepository<TEntity>, SomeCollection<TItem, TComparer>`..

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T08:58:56.743

> *T 代表类型*

此外，E 也用于非常常见的元素。你是对的 G 也有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T12:50:13.880

我认为那是模板的 T，因为它首先出现在 C++ 中。

# asp.net - 为什么每次我在 VS 2008 中构建 Web 应用程序时，IIS 开发服务器都会重新编译我的所有 Web 应用程序？

> ID：374024
> 
> 赞同：1
> 
> 时间：2008-12-17T08:58:29.320
> 
> 标签：asp.net, compiler-construction, web-development-server

我们有一个 Web 应用程序项目（不是网站），直到我们将 batch="false" 添加到 web.config Web 开发服务器的那一天，我们正在编译所有 Web 应用程序而不是请求的页面。

```
<compilation debug="true" batch="false">
      <assemblies>
        ...
      </assemblies>
</compilation> 
```

这让我们更快。但我不知道发生了什么变化（我已经检查了存储库中的 foo.cproj 和 web.config ，比较了旧版本但没有发现任何东西会导致这种缓慢）。

我查看了 %temp%/Temporary ASP.NET Files；在我编译我的 Web 应用程序（不是重新编译，shift + f6）之后，我请求一个页面，我看到 Web 服务器从 %temp%/Temporary ASP.NET 文件中删除所有已编译的文件并重新创建。我不知道这是否正常，但在我看来，这是对所有 Web 应用程序的完全重新编译，这非常慢。（我通过进程资源管理器查看了 wevdev.wevserver.exe 它多次调用 csc.exe）

我怎样才能使编译更快？谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T14:19:59.463

32 位版本的 NET CLR 提供了一个名为“启用编辑并继续”的 ASP.NET 开发服务器选项。在 Visual Studio 中将其关闭。

此外，尝试在“x86”的构建中更改“任何 CPU”的构建。那应该使编译更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T21:19:25.653

我相信这是使用 Web 应用程序项目的一部分。每次构建应用程序时，都会重新编译整个站点。您应该看到，与“网站”不同，Web 应用程序全部编译为单个 dll（加上引用）。

您必须注意的另一件事是，任何时候您删除根 Web 应用程序文件夹下的文件/文件夹时，它也会强制重新编译，这对于临时文件来说可能是一个真正的痛苦。

从好的方面来说，一旦你完成了第一次编译，在未访问的页面上将不会有额外的等待编译时间。

# svn - Subversion：将更改从一个分支移动到另一个分支的最佳方式

> ID：374025
> 
> 赞同：2
> 
> 时间：2008-12-17T08:58:41.923
> 
> 标签：svn, branch

我有两个分支：X 和 Y。我想用 X (x1) 中的等效项替换 Y 的子目录 (y1)。

目前，我执行以下操作：将 x1 复制到 Y，删除 y1，将 x1 重命名（移动）到 y1：

```
a) svn copy https://path/to/branches/X/x1 https://path/to/branches/Y/
b) svn delete https://path/to/branches/Y/y1
c) svn move https://path/to/branches/Y/x1 https://path/to/branches/Y/y1 
```

我觉得挺丑的。。。

我怎样才能以更聪明的方式做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T09:16:25.727

如果你真的想替换目录，你可以通过两个操作来做到这一点：

```
svn delete https://path/to/branches/Y/y1
svn copy https://path/to/branches/X/x1 https://path/to/branches/Y/y1 
```

如果 Y/y1 确实已经是 X/y1 的旧副本，则不应一直替换它，而应合并自上次合并以来的所有更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T09:18:43.990

为什么不只是两个步骤：

```
a) svn delete https://path/to/branches/Y/y1
b) svn copy https://path/to/branches/X/x1 https://path/to/branches/Y/y1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-22T13:06:44.420

将分支 Y 检出到一个新的工作副本，然后把自己放在那里。

```
svn co https://path/to/branches/Y Y
cd Y 
```

合并将 Y/y1 转换为 X/x1 到 Y/y1 所需的更改

```
svn merge https://path/to/branches/Y/y1 https://path/to/branches/X/x1 y1 
```

提交这个

```
svn commit -m "Y/y1 now has the same contents as X/x1" 
```

如果 y1 的名称与 x1 不同（您的描述不清楚），请重命名：

```
svn mv y1 x1
svn commit -m "Y/y1 now named Y/x1" 
```

但是，您知道如果您的工作流程要求您像这样进行子树合并（或者更糟的是其他海报提倡的那种树手术），那么您可能做错了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-11T08:55:18.810

移动分支的简单方法：

```
svn mv url1 url2 -m "commit log msg" 
```

# html - 生成单文件 HTML 代码文档

> ID：374032
> 
> 赞同：12
> 
> 时间：2008-12-17T09:02:59.793
> 
> 标签：html, pdf, documentation, doxygen

如何使用 Doxygen 将 HTML 文档创建为单个非常长的文件？我想要类似 RTF 输出的东西，但作为 HTML。

原因：我需要将我的 API 作为单个可打印文档发布。可以加载到 Word 中、转换为 PDF 等的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T09:51:46.577

我认为您可以使用[HTMLDOC](https://www.msweet.org/htmldoc/index.html)将生成的 html 文件转换为单个 html 文件。（我自己没试过）

该[手册](https://www.msweet.org/htmldoc/htmldoc.html)包括以下示例，用于从两个源 html 文件生成 html：

```
htmldoc --book -f output.html file1.html file2.html 
```

但也有一个gui。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T09:31:22.920

我不认为有一个选项可以将输出生成为单个 HTML 文件，但如果您需要可编辑的输出格式，RTF 输出可能是合适的（我自己没有尝试过，所以我不知道这有多好）作品）。

如果你想要高质量的可打印输出，那么 Doxygen 可以输出 LaTeX 格式（`GENERATE_LATEX`在`YES`你的 doxygen 配置文件中设置）。然后可以将其转换为 PDF，尽管您需要安装 LaTeX 发行版，例如[MiKTeX](http://miktex.org/)。

# html - 如何在 Firefox 中更改禁用输入的字体颜色

> ID：374040
> 
> 赞同：6
> 
> 时间：2008-12-17T09:07:39.253
> 
> 标签：html, css, firefox

当我禁用输入元素时，文本采用字体颜色：`#000000`在 Firefox 中。这在 IE 中不会发生。请在 IE 和 Firefox 中查看以下页面。让我知道如何在 IE 中给它一个灰色的外观。
[测试](http://shivanand.in/tmp/test.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T09:32:28.643

不同的浏览器对禁用元素的样式不同。以下是如何在 Firefox 中控制禁用元素的样式。

```
[disabled] {
  color:#ff0000;
  background-color:#00ff00;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-17T13:53:29.363

重新启用它，更改颜色，再次禁用它。只需 0.001 秒。

# javascript - 在文本之间插入一个节点

> ID：374041
> 
> 赞同：10
> 
> 时间：2008-12-17T09:07:44.933
> 
> 标签：javascript, dom

我熟悉在给定参考节点之后或之前插入文本节点。但是，我想知道如何在给定节点的文本之间插入标签。例如，

```
Before insertion: <p>Lorem dolor</p>
After insertion: <p>Lorem <span>ipsum</span> dolor</p> 
```

跨度节点必须在另一个节点内的 N 个字符（我不需要用户的光标选择位置）之后插入。那可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-17T10:37:15.127

The proper way (using DOM-Core interfaces) would be:

```
var p = document.getElementById('myParagraph');
var text = p.childNodes[0];
var at = 5;

// create new span node with content
var span = document.createElement("span");
span.appendChild(document.createTextNode('ipsum'));

// Split the text node into two and add new span
p.insertBefore(span, text.splitText(at)); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-17T09:17:30.250

您需要将文本放入变量中，然后将其从 DOM 中删除。拆分它，然后插入第一部分，然后是 span 节点，然后是第二部分。

```
var p = document.getElementById('myParagraph');
var text = p.childNodes[0];

// Split the text
var len = 5
var text1 = text.nodeValue.substr(0, len);
var text2 = text.nodeValue.substr(len);

var span = document.createElement('span');
span.appendChild(document.createTextNode(' dolor'));

// Remove the existing text
p.removeChild(p.childNodes[0]);

// Put the new text in
p.appendChild(document.createTextNode(text1));
p.appendChild(span);
p.appendChild(document.createTextNode(text2)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T09:12:03.690

您可以检查节点`innerHTML`属性并对其进行修改。或者，您可以查看`childNodes`集合并在那里处理元素（删除旧文本节点并在其位置插入新节点）。

# java - 使用多模块 Maven 项目，是否可以使我的根（pom 打包）项目在 Eclipse 中可用？

> ID：374043
> 
> 赞同：4
> 
> 时间：2008-12-17T09:08:27.210
> 
> 标签：java, eclipse, maven-2, pom.xml

我们有一个相当大的 Maven2 项目组，其根 POM 文件列出了 10 多个模块和模块使用的许多属性（依赖版本号、插件配置、常见依赖项等）。一些模块，如根项目，是其他模块集的父级。

为了澄清，根项目和所说的父项目被设置为 pom 包装（而不是例如 jar）。

因为不同项目之间有很多依赖关系，所以我喜欢在根项目上使用 mvn eclipse:eclipse，这让我可以随时调试/单步执行任何项目。

但是，使用这种方法，根 POM 本身以及所有其他 pom 打包的项目在 Eclipse 中不可用。所以，如果我想编辑它们，我必须以其他方式打开它们。这变得有点麻烦。

所以，我的问题是：是否有可能以某种方式使 pom 打包的项目在 Eclipse 中可用？如果没有，你有什么技巧可以让我更轻松地处理这些项目吗？

作为记录，我目前使用的是 MyEclipse 7.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-06T06:34:16.230

我用 Galileo 和最新版本的 m2eclipse 再次尝试了这个。现在可以直接导入 Maven 项目（无需 mvn eclipse:eclipse），结果证明根 POM 也作为项目导入，这正是我想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T17:14:57.430

好。很多人通过使父 POM 成为兄弟项目并在根中具有简单的反应器 POM 来做到这一点。然而，这可能会导致网站生成和发布插件出现问题，因为两者都没有像人们希望的那样完全支持这种模式。

我们经常遇到的一个大问题是人们尝试使用 Subclipse 来检查主干，它会在根目录中添加一个 .project 文件，然后阻止导入该级别以下的项目。相反，我们必须到外面检查，然后导入项目。

我听说 Subversive 可能会更好地处理嵌套项目，这确实是这里的问题。除此之外，我在这里没有绝对的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T09:37:57.087

您可以尝试编写一个任务来手动为其目录中的每个 POM 项目创建 .project 文件。不确定具体细节，但您可以生成如下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
        <name>${project.name}</name>
        <comment></comment>
        <projects>
        </projects>
        <buildSpec>
        </buildSpec>
        <natures>
        </natures>
</projectDescription> 
```

在项目的根目录中，应该没问题。

我不确定这样做是否会阻止您将子项目导入 Eclipse（您可能知道 - 您需要先导入所有非 pom 项目，然后为其他项目创建“通用”项目，使用路径匹配mvn结构下的物理路径）。Eclipse 将阻止您在另一个项目中创建一个项目，因此如果它识别出项目层次结构中更高级别的任何内容，您将在过去被引导。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T09:47:49.110

我设法与有父母的 Maven 项目一起使用[codehaus eclipse 插件。](http://m2eclipse.codehaus.org/)该插件有一些缺陷，但总的来说它是维护的，你应该能够相处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-16T21:57:35.643

一般来说，我只需要 eclipse 中可用的父级来添加依赖项并利用 XML 格式。便宜又愉快的方法是创建资源项目并将父pom链接到其中。文件 -> 新建 -> 其他 -> 常规 -> 文件 -> 高级

如果您使用 2.8+ 版本的 eclipse 插件，您可以让它在您的每个子项目中为您生成链接，例如

```
<plugin>
    <artifactId>maven-eclipse-plugin</artifactId>
    <version>2.8-SNAPSHOT</version>
    <configuration>
        <linkedResources> 
            <linkedResource>
                <name>parent.xml</name> 
                <type>1</type>
                <location>${basedir}/${parent.relativePath}</location> 
            </linkedResource>
        </linkedResources> 
    </configuration>
  </plugin> 
```

尽管您目前需要从 subversion 中检查它并自己构建它，因为它似乎还没有从中央解决。

```
svn co http://svn.apache.org/repos/asf/maven/plugins/trunk/maven-eclipse-plugin/
cd maven-eclipse-plugin
mvn clean install 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-16T22:10:40.897

实际上，如果您不想依赖 m2eclipse，那么“正确”的做法是使用[平面项目布局](http://maven.apache.org/plugins/maven-eclipse-plugin/reactor.html#Flat_Project_Layout)（因为问题是 Eclipse 不支持嵌套项目）。

# c++ - 将类型转换为指向对象的 void 指针时未调用析构函数

> ID：374046
> 
> 赞同：3
> 
> 时间：2008-12-17T09:08:54.290
> 
> 标签：c++

样本

```
void func(void* data)
{
 CResource* resource = (CResource*)data;
 delete resource; // ~CResource never called.
 resource = NULL;
} 
```

请帮我弄清楚这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T09:26:37.670

*总结了可能无法调用 CResource 析构函数的原因，摘自其他答案：*

## 不完整类型

一个可能的原因是您只声明了 CResource 类型，未定义：

```
class CResource;

void func(void* data)
{
 CResource* resource = (CResource*)data;
 delete resource; // ~CResource never called.
 resource = NULL;
} 
```

这是一个未定义的行为（删除不完整的类型）。在这种情况下，编译器应该发出关于未调用析构函数的警告（Visual C++ 肯定会发出它）。如果是这种情况，请确保在要破坏它的地方定义了类型（包括必需的标头）。

## 空指针

如果 data 为 NULL，delete 什么都不做，也不调用任何析构函数。

## 类型不匹配

*如果 CResource 析构函数是虚拟的，并且存储在数据*指向的内存中的对象实际上是不同的类型，则会得到未定义的行为。通常会调用不同的析构函数（如果对象有另一个虚拟析构函数），在其他情况下程序可能会崩溃（如果对象没有虚拟析构函数）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T09:57:21.870

The only reason, why the destructor wouldn't be called, is if the data pointer is 0 (or NULL). That's how delete works - it checks if the pointer isn't 0, and if it isn't - it calls the necessary destructors and releases the memory.

As pointed out in the comment. There is another reason why it wouldn't get called. If data points to some other class (not CResource) object and both classes have virtual destructors, then the destructor of that other class will be called.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T13:07:29.287

析构函数是虚拟的吗？也许 data 根本不指向 CResource 对象，并且正在调用其他类的虚拟析构函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T13:26:28.437

```
class Aardvark
{
public:
    virtual ~Aardvark()
    {
        printf("Aardvark::~Aardvark\n");
    }
};

class CResource
{
public:
    virtual ~CResource()
    {
        printf("CResource::~CResource\n");
    }
};

void func(void* data)
{
    CResource* resource = (CResource*)data;
    delete resource; // ~CResource never called.
    resource = NULL;
}

int _tmain()
{
    void *data = new Aardvark();
    func( data );
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T09:20:26.250

调用析构函数。给我们完整的代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T09:30:36.867

你为什么说 dtor 没有被调用？可能是因为您在 dtor 中添加了 printf，但没有看到任何消息？

可能调用了另一个dotr？CResource 是继承的吗？你定义基类析构函数是虚拟的吗？

正如 rajKumar 指出的那样，请给我们完整的代码，我们会尽力帮助您。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T13:39:44.120

我假设 CResource 是某种超类，您可以通过通用指针轻松传输对象。

那么你的问题对于 C++ 新手来说是一个正常的问题，你应该阅读

[http://www.parashift.com/c++-faq-lite/virtual-functions.html#faq-20.7](http://www.parashift.com/c++-faq-lite/virtual-functions.html#faq-20.7)

此外，获取一份 Scott Meyer 的“Effective C++”的副本，因为它会向您介绍接下来几个月您将犯的许多错误。

# gtk - 如何在 GnomeCanvas 文本项中对齐文本

> ID：374051
> 
> 赞同：1
> 
> 时间：2008-12-17T09:15:55.960
> 
> 标签：gtk, canvas, gnome

我想要一个 GnomeCanvas 文本项，并根据它的内容（和内容语言）决定是向右还是向左对齐文本。我找到了一种通过更改*anchor*属性来做到这一点的方法，但是使用这种方法需要我自己管理锚位置（向右对齐时将其更改为文本边界框的右侧），而且似乎必须有更简单的方法。

编辑：我看到还有*justification*属性，它允许我将文本向右对齐。但是，我仍然需要根据语言设置锚点，而不是设置适用于任何语言的边界框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-16T08:25:53.307

它大约一个月没有另一个答案。我想我的第一个理解是正确的，画布没有其他方法。然后我的解决方案是将锚点更改为东方并相应地更改锚点。

# c# - 我应该为这个不寻常的帐户系统使用会员资格吗

> ID：374058
> 
> 赞同：1
> 
> 时间：2008-12-17T09:19:33.473
> 
> 标签：c#, asp.net-mvc, asp.net-membership

我的 asp.net mvc 站点需要某种授权，但它与通常的用户概念和成员身份不同。它将更多地用于首选项，然后实际用于身份验证。没有任何密码的帐户应该是可能的（并且最初将是唯一的类型），并且一个帐户也可以同时由多个用户使用。例如，根据用户组的不同，某个地区的所有用户都可能获得一个共享帐户。这是客户（营销部门）的决定，不予讨论。

某个登录页面（仅）在 URL 中使用一个用户 ID，该用户 ID 将加载一个帐户，该帐户又具有与其链接的一些首选项，可在整个站点的其余部分中使用。
如果用户没有从登陆页面开始或发送的 accountId 与系统中的记录不匹配，他/她将被分配具有默认偏好的默认帐户。

我正在考虑不要重新发明轮子（有人应该为此找到一个新的表达方式）并使用 asp.net 会员系统。但是整个系统基于每个用户所需的密码、电子邮件和单个会话，这些都是我无法提供的。因为情况有点不合常规，我认为自定义 MembershipProvider 等会到位。但它的要点似乎是从常规的 Membership 类继承。这些类的方法都需要我不需要的东西。

有什么建议么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T09:26:30.450

您可以使用标准的会员资格提供程序并使用内置的 .Validate() 方法发送用户名和密码，该密码是所有帐户的“标准”，无需身份验证。

有 2 个不同的用户控制 1 个用于“使用密码验证登录”和一个用于“无密码共享帐户”，每个都使用 Membership-login 但后者需要在成员的字段上设置一些“公共帐户 = True” / 1"

祝你好运，似乎是一个有趣的项目，看到结果会很酷；）

顺便说一句，您不需要共享会话，或者您可以将会话存储在数据库中并将会话映射到用户而不是 cookie，可能有效吗？

* * *

根据要求，我将详细说明不同的用户控件。简而言之，我将有 2 个控件，一个可能称为 GlobalLogin，一个称为 UserLogin，其中 GlobalLogin 显示一个只有用户名的表单，提交时这将触发一个函数，如我之前所述，该函数调用 Validate 方法会员提供者，具有预设密码。

作为反思，将所有“未使用密码登录”的用户视为匿名用户并以相同的方式对待他们，唯一不同的是他们可以访问特定于用户的区域。此控件还需要检查是否设置了数据库中的某个字段，例如“允许没有密码的全局使用帐户”字段，在这种情况下，位/布尔值必须为真才能接受此登录。

现在到另一部分，处理受密码保护的帐户的控件，这需要用户名和密码，并使用这些设置调用验证。现在，请记住，使用密码登录时，您可以更改密码，这不应该使用全局帐户来实现，因为那样您的全局密码将不起作用:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-17T16:54:29.763

在[http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)上有关于会员资格提供者的详细信息。基本上，您需要创建新的提供者，或从现有提供者派生，并重载 ValidateUser 方法以始终返回 true。

# c# - 使用 http 远程处理 C# 时吞吐量低

> ID：374059
> 
> 赞同：2
> 
> 时间：2008-12-17T09:20:02.677
> 
> 标签：c#, performance, proxy, remoting

我在 C# 中使用 http 远程处理在两个应用程序之间进行通信。早些时候，当我在一台机器/两台机器上运行这两个应用程序时，它非常慢。我们有一个代理服务器来连接到互联网。我们在 IE 中设置了“绕过本地地址的代理服务器”，现在当我在一台机器上运行这两个应用程序时，通信发生得非常快。（几乎乘以 10 倍）

但是如果我在不同的机器上运行每个应用程序，那么它仍然很慢，就像设置“绕过代理服务器......”之前的情况一样

任何见解都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T09:48:26.690

您要发送什么样的数据，以什么速率发送？您是否使用了大量对远程 ( `MarshalByRefObject`) 对象的调用？

实际上，通过远程处理很难完全控制数据。就个人而言，我会推荐一些基于消息的东西，例如 WCF。这使得系统之间的接口更加明确和可预测。

如果代理是一个关键点，您仍然可以通过 proxycfg.exe 绕过远程地址

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T06:58:19.000

正如担心的那样，没有很多远程调用。一次远程调用在不同机器上需要 10 秒，而在单台机器上只需要 350 毫秒。

当我运行 proxycfg.exe 时，它​​显示“直接访问（无代理服务器）”

# php - 完整的 AJAX 反馈

> ID：374061
> 
> 赞同：3
> 
> 时间：2008-12-17T09:20:32.160
> 
> 标签：php, jquery, ajax

我使用数据库记录管理构建 JQuery/JS/PHP/mySQL 应用程序，需要向用户提供关于 AJAX 调用的可靠和完整的反馈，修改后端数据库记录。恕我直言，问题在于`$.ajax` `success:`功能`error:`仅表明 AJAX 传输层成功，而不是整个过程。如果数据库修改失败怎么办？如何向用户提供完整的反馈？

我结束了

```
$.ajax({
   网址：“/动作/删除”，
   数据：“rowid="+rowid,
   完成：函数（xmlHttp）{
   if ( xmlHttp.responseText ) alert('成功 - 后端返回“成功”');
      else alert('失败 - 后端返回 NULL')
   }
});  

```

和 PHP 响应：

```
$success = deleteRecord( $_GET(rowid) );

如果（$成功）{
   打印“成功”；
} 别的 {
   打印空；
}
出口（）;

```

这个想法很简单——如果我设法从后端获得积极的反馈，那么整个操作就成功了，如果没有——用户不在乎问题发生在哪里。

提前感谢您，非常感谢您的反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T09:28:22.737

如果您使用一些 json 数据来响应请求，而不仅仅是一些要插入 DOM 的新 html，您可以在数据中放置您喜欢的任何类型的错误代码和消息。例如，如果您的回答类似于...

```
{ 
    errorstate: 0,
    errormsg: "All systems are go",
    displaytext: "stuff I want to display when all goes well"
} 
```

您的 javascript 代码可以检查这些数据并执行它认为需要的任何操作。它还允许您将更多的错误处理推送到您的服务器脚本中，这通常会更简单。

试试[http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback](http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T09:34:04.363

一种可能的解决方案是使用 HTTP 响应代码来表示失败，例如 200 OK，一切正常，以及 500 Internal Server Error on error，您可以在达到状态 4 时简单地检查一下。

在 PHP 中，我相信这是在发送任何其他数据之前通过 header("HTTP/1.0 200 Ok") 完成的。如果您担心在评估要设置的正确标头之前会错误发送数据，您可以打开输出缓冲。

您希望如何呈现数据当然取决于您，例如，您可以在 500 上只有 document.getElementById("myerrorbox").innerHTML = xmlHttp.responseText 或类似的，并在您的 php 中呈现部分 html 文档-程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T12:19:26.607

我将状态消息发送回客户端。连同错误标志。然后我的 JavaScript 代码显示它从服务器获得的消息，并根据错误标志为消息着色。我觉得这样很有效率。

# sql - 在 TSQL 中对重复的行进行分组

> ID：374079
> 
> 赞同：3
> 
> 时间：2008-12-17T09:34:03.553
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我在 SQL Server 2005 中有下表和数据：

```
create table LogEntries (
  ID int identity,
  LogEntry varchar(100)
)

insert into LogEntries values ('beans')
insert into LogEntries values ('beans')
insert into LogEntries values ('beans')
insert into LogEntries values ('cabbage')
insert into LogEntries values ('cabbage')
insert into LogEntries values ('beans')
insert into LogEntries values ('beans') 
```

我想对重复的 LogEntries 进行分组，以便得到以下结果：

```
LogEntry  EntryCount
beans     3
cabbage   2
beans     2 
```

除了使用游标之外，您能想到在 TSQL 中执行此操作的任何方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T10:52:41.227

我认为这会做到...虽然没有仔细检查

```
select 
    COUNT(*),subq.LogEntry 
from 
(
    select 
        ROW_NUMBER() OVER(ORDER BY id)-ROW_NUMBER() OVER(PARTITION BY logentry ORDER BY id) as t,*
    from 
        LogEntries
) subq 
group by 
    subq.t,subq.LogEntry 
order by 
    MIN(subq.ID) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T10:38:15.170

这是针对该问题的基于集合的解决方案。性能可能会很糟糕，但它有效:)

```
CREATE TABLE #LogEntries (
  ID INT IDENTITY,
  LogEntry VARCHAR(100)
)

INSERT INTO #LogEntries VALUES ('beans')
INSERT INTO #LogEntries VALUES ('beans')
INSERT INTO #LogEntries VALUES ('beans')
INSERT INTO #LogEntries VALUES ('cabbage')
INSERT INTO #LogEntries VALUES ('cabbage')
INSERT INTO #LogEntries VALUES ('carrots')
INSERT INTO #LogEntries VALUES ('beans')
INSERT INTO #LogEntries VALUES ('beans')
INSERT INTO #LogEntries VALUES ('carrots')

SELECT logentry, COUNT(*) FROM (
    SELECT logentry, 
    ISNULL((SELECT MAX(id) FROM #logentries l2 WHERE l1.logentry<>l2.logentry AND l2.id < l1.id), 0) AS id
    FROM #LogEntries l1
) AS a
GROUP BY logentry, id

DROP TABLE #logentries 
```

结果：

```
beans   3
cabbage 2
carrots 1
beans   2
carrots 1 
```

第一组 bean 需要 ISNULL()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T09:43:18.700

SQL 不完全是我的强项，但不会

```
SELECT LogEntry, COUNT(1) AS Counter FROM LogEntries GROUP BY LogEntry 
```

做吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T09:47:40.610

我不认为你可以用一个查询来做到这一点。为了在查询中提供计数，您需要使用 LogEntry 列进行分组。但是，这只会为您提供每个 LogEntry 的总计数，而不是您正在查找的序列中条目数的计数。我认为需要一个游标（或将整个数据集带到您的应用程序，并在那里使用逻辑来获得您想要的结果）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T09:48:26.333

除非我的大脑今天早上还没有启动

```
SELECT 
  LogEntry, COUNT(LogEntry) as EntryCount
FROM
  LogEntries
GROUP BY
  LogEntry 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-17T09:55:11.373

现在我已经足够仔细地研究了实际问题:-)

嗯，重新考虑，为什么不直接使用光标呢？性能并不总是比直接 SQL 差 - 其他人在查看代码时肯定很容易遵循代码。将它包装在存储的过程或函数中，您几乎可以在任何需要的地方使用它。

# visual-studio - Visual Studio 中的解决方案文件夹是什么？

> ID：374081
> 
> 赞同：59
> 
> 时间：2008-12-17T09:34:36.063
> 
> 标签：visual-studio, tfs, directory, solution

我有一个 Visual Studio 2008 解决方案，我想在解决方案中包含一个真正的文件夹，但不是在项目级别，而是在解决方案级别。

我注意到您可以右键单击解决方案并添加一个解决方案文件夹，但它以一些白色文件夹的形式出现，我对它应该是什么表示怀疑......

基本上在文件系统上我有 c:\mySolution\myFolder...

我希望将 myFolder 添加到解决方案中，以便项目也受源代码控制...

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-12-17T09:55:15.087

我也希望能够将物理文件夹添加到解决方案中，但不幸的是您不能在项目之外这样做。

我找到的最佳解决方案是添加一个与物理文件夹同名的解决方案文件夹（在您的示例中为 myFolder），然后将该物理文件夹中的文件添加到解决方案文件夹。

但是 Visual Studio 不维护解决方案文件夹和物理文件夹之间的映射，这意味着：

*   随后使用 Visual Studio 在解决方案文件夹中创建的新文件不会自动放置在物理子文件夹中（我认为默认情况下它们是在解决方案根文件夹中创建的）

*   添加到物理文件夹的文件不会自动显示在解决方案文件夹中，即使使用“显示所有文件”也是如此。

为了添加新文件，我总是在 Visual Studio 外部的物理文件夹中创建新文件，然后使用“添加/现有项”将其添加到解决方案文件夹中

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-17T09:53:40.363

我在历史上所做的是创建一个仅用于保存文件（DLL 等）的项目。

你也可以这样做。该项目可以命名为您尝试创建的任何文件夹。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-02-01T16:04:58.967

按照这个...

1.  从 Visual Studio 创建解决方案文件夹。
2.  右键单击解决方案文件夹以创建一个新项目。
3.  **更改默认位置路径以在新的物理文件夹名称后面添加反斜杠。**类似...C:\Project\Test\New Physical Folder
4.  单击确定按钮创建项目

然后新项目将被放入您的新项目中`New Physical Folder`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-17T09:52:47.540

您还可以在解决方案文件夹中添加独立文件，它们将受到源代码控制。但请注意，VS 倾向于将这些文件与解决方案文件放在同一个文件夹中——“解决方案文件夹”是虚拟的，与真实的文件系统文件夹不对应。要拥有一个真正的文件系统文件夹，我认为您必须自己创建结构，然后选择“添加现有项目”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-01-23T13:37:43.253

来自 MSDN：

> “如果您正在使用包含大量项目的解决方案，您可以使用解决方案文件夹将相关项目组织成组，然后对这些项目组执行操作。”

您不想要作曲家在解决方案文件夹中的意思。它使他们将大型解决方案组织成组。

对于您的问题，我认为这是您的安装项目收集这些文件的工作：安装说明、全局帮助等...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-17T09:53:31.410

您可以使用解决方案文件夹对解决方案中的文件进行分组，但解决方案文件夹并不代表磁盘上的文件夹，正如其徽标所暗示的那样。（它可以包含文件引用和项目引用。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-03-24T22:22:38.267

我首选的解决方案是添加一个共享项目，它就像一个文件夹，但带有一个特殊的图标。

[![Visual Studio 共享项目](https://i.stack.imgur.com/3ca8g.png)](https://i.stack.imgur.com/3ca8g.png)

# .net - 在 VB.net 中动态添加用户控件

> ID：374082
> 
> 赞同：4
> 
> 时间：2008-12-17T09:35:34.410
> 
> 标签：.net, vb.net, dynamic, user-controls, windows

我制作了一个自定义 UserControl i Vb.net（Windows 应用程序）。

如何将其动态添加到表单中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-17T09:47:46.943

UserControl 本质上只是另一个类。它继承自 Control，因此您可以使用控件执行各种操作，但除此之外它只是一个类。因此，要将用户控件动态添加到表单中，您需要执行以下操作：

1.  创建控件的新实例。像`Dim X As New MyControl()`
2.  将控件作为子对象添加到您想要的任何容器中。喜欢`Me.MyGreatTabPage.Controls.Add(X)`。您也可以直接将其添加到您的表单中，因为表单也是一个容器。
3.  设置容器内的控件位置。那将是设置`X.Location`和`X.Size`。

请记住，您创建的每个实例`New MyControl()`都是一个单独的 MyControl。不要犯重复创建新控件并以某种方式将它们放在一起的错误。创建并放置一次控件。将其分配给表单的成员变量，当您需要使用它时，请使用此变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T09:40:12.747

我认为您要查找的内容写为： this.Controls.Add(myControl) 在 C# 中。我敢肯定它在VB中也很相似？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T09:52:12.037

```
Form.Controls.Add(Page.LoadControl("SomeUserControl.ascx")) 
```

*然后是捕获事件*的困难部分，因为它需要重新加载每个请求。我通常使用 ViewState 标志来表示它已经加载，并检查该标志是否存在，看看我是否应该在 OnInit 中重新加载它

```
Dim newControl As UserControl = LoadControl("~/Controls/DRQ/Create/UCNewControl.ascx")
Me.panelHolder1.Controls.Add(newControl) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T14:20:17.557

这是添加两个或更多的方法：

```
Private _userControlList As New List(Of YourControl)

Private Sub AddingControlOnPanel()
    Dim index As Integer = _userControlList.Count + 1
    Dim userControl As New YourControl
    userControl.Location = New System.Drawing.Point(SomeLocation)
    userControl.Size = New System.Drawing.Size(SomeSize)
    userControl.Name = "userControl" + index.ToString
    userControl.Visible = False
    _userControlList.Add(userControl)
    UserControlsPanel.Controls.Add(userControl)
    userControl.Visible = True
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T10:32:59.037

```
 For i As Integer = 1 To 10
        Dim tb As New TextBox
        tb.Top = 26 * i
        tb.Left = 12
        tb.Text = "text box " & i.ToString()
        tb.Parent = Me
    Next 
```

# html - 谷歌分析是否对下载静态网页的时间产生重大影响？

> ID：374084
> 
> 赞同：18
> 
> 时间：2008-12-17T09:38:06.667
> 
> 标签：html, performance, static, google-analytics

我知道，只需将脚本添加到 html 文档的正文标记的末尾，Google 分析就可以对其进行处理。我的问题是，这可能会对性能（下载时间和服务器负载）产生很大影响吗？让我们假设 IIS 服务的静态页面为 100k。谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-17T09:44:05.327

[我的网站的外观或性能会受到谷歌分析的影响吗？](http://www.google.com/support/analytics/bin/answer.py?hl=en&answer=55621)

> 您对 Google Analytics 的使用不会影响您网站的外观——我们不会在您的网页上放置任何图像或文字。同样，您的网页性能不会受到影响，但添加跟踪代码后的第一个页面加载可能除外。第一次综合浏览会调用 Google 服务器上的 JavaScript，这可能需要比常规页面加载稍长的时间。 **后续浏览量将使用缓存数据，不会受到影响**。

需要注意的是，互联网上的许多网站在 Google 服务器上的同一位置使用相同的 Javascript，因此很少有新用户在没有本地缓存​​该文件的情况下访问您的网站。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-17T10:38:13.283

是的，它确实对性能有影响，请参阅[http://dotnetperls.com/Content/Google-Analytics-Speed.aspx](http://dotnetperls.com/Content/Google-Analytics-Speed.aspx) 。为了加快速度，建议您在本地下载 ga.js 文件并改为调用它，此处解释为[http://www.askapache.com/javascript/google-analytics-speed-tips.html](http://www.askapache.com/javascript/google-analytics-speed-tips.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-18T00:01:03.163

**编辑：谷歌发布了[Asynchronous Tracking](http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html)。我还没有尝试过，但我想它解决了下面列出的问题。**

我认为谷歌分析可以让网站变慢，因为它确实很高兴 ga.js 需要很长时间才能加载，这可能会导致一些问题：

*   如果您有一个触发的 JavaScript `window.onload`（包括旧式`<body onload="">`语法），那么在网页下载完成之前它不会触发。不过，使用类似[jQuery 的 ready 事件](http://docs.jquery.com/Events/ready#fn)可能会解决这个问题。

*   大多数浏览器在网页完全加载之前不会填写保存的用户名和密码。

*   普通用户不容易发现网页只是在等待分析脚本加载，因此即使页面基本上已经完成下载，他们也可能正在等待小下载动画完成。

*   您可以按照 niallbrowne 的建议下载 ga.js 并从您自己的 Web 服务器提供服务。但这应该是最后的手段，因为 ga.js 是跨网站缓存的，并且每周只会过期一次。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-17T09:40:46.473

是的。

我觉得浏览速度要好得多，因为我将谷歌分析添加到 addblock 过滤器。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-17T09:40:51.310

不。

如果你把它放在最后，它将最后加载，所以即使谷歌的服务器有点慢，你的访问者也不会注意到。

ga.js 是 9.58k，日志调用大约是 1.2k。js 将在第一次加载后被缓存（我猜甚至跨站点？）所以它的大小真的可以忽略不计。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-17T10:00:47.133

即使您将 Analytics 代码放在代码的底部，从用户的角度来看，直到底部的小蓝条消失后，网站才会加载。

这意味着您的网站会“感觉”更慢，这取决于（令人惊讶的）您的用户连接有多迟钝。对于拨号用户和从国外访问您的网站的用户（请求滞后是一个更高的问题），额外的请求肯定意味着网站的响应速度稍差。

但是，鉴于每张图片、每一个 javascript 文件和任何其他嵌入对象都是一个额外的请求，如果您已经在使用丰富的网站布局，那么没有理由不使用分析。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-17T10:33:27.973

GA 在慢速连接上肯定会减慢用户的体验。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T02:23:50.823

请记住，并非每个用户都有快速的美国连接。

如果您从美国以外的国家/地区连接速度较慢，则差异肯定是显而易见的。

运行速度较慢的计算机或非标准浏览器（即旧版本、手机等）的人都可能受到 javascript 执行时间的影响。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T02:43:24.723

有时我会在使用它的页面中遇到滞后。我可以将问题跟踪到 GA，因为它是唯一等待加载的脚本。我知道这不应该发生，但是对于某些页面请求，它会随机发生。这通常并不重要，因为整个页面已经加载，因此您可以开始阅读。但是对于使用 ajax 或通常在文档就绪事件上执行操作的页面来说，这会成为一个小问题。所以我将它添加到我的 adlock 过滤器中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-24T16:06:56.063

看看[竞争对手怎么说](http://www.woopra.com/blog/2009/02/04/is-google-analytics-slow-or-not/)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-17T09:43:01.413

就我个人而言，我真的看不出会有很大的不同，您的浏览器会在第一次请求后缓存它，然后在其他页面上使用它。

该脚本也在页面的最底部加载，因此其他所有内容都应该已经加载。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-17T09:52:31.347

关于服务器负载，脚本是从 Google 的服务器中提取的，而不是您的，因此不会对服务器端产生明显的影响。显然，您的页面都将比没有加载 JavaScript 的代码时稍大一些，但您永远不会注意到其中的差异。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-23T02:32:29.663

还要注意，我看到 GA 下载了一个带有哈希的小 GIF 文件......但我怀疑它的大小会对性能产生很大影响。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-22T15:20:32.670

如果您将代码添加到页面底部，那么它可能不会有太大的不同。

但是，如果您希望它没有任何区别，那么我会看看这个链接：

[http://lyncd.com/2009/03/better-google-analytics-javascript/](http://lyncd.com/2009/03/better-google-analytics-javascript/)

它描述了 Steve Souders 为完全避免任何类型的 I/O 阻塞而采取的方法。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-22T15:51:26.763

尽管下载和运行实际的 ga.js 速度很快，但我在整个欧洲注意到，在不同的连接/计算机/操作系统/浏览器上，最后一个字节之间存在主要滞后（从 0 到 30（**三十**）秒） HTTP 请求和 HTTP 响应的第一个字节。

这是可以理解的，因为 GA 非常受欢迎，但这是在 window.onload 触发之前发生的。因此，如果您的页面依赖于 JS 并且您的用户遇到了这种滞后，他们不会分析哪个组件负责 - 他们会假设您的网站非常慢。

解决方法是注册一个 window.onload 函数，该函数将添加 GA 脚本。示例（`window.onload=function()`为简单起见使用“”）：

```
window.onload = function() {
    var gaJsHost = (("https:" == document.location.protocol) 
                      ? "https://ssl." 
                      : "http://www.");
    var s = document.createElement('script');
    s.src = gaJsHost + "google-analytics.com/ga.js";
    s.type='text/javascript';
    var bodies = document.getElementsByTagName('body');
    if (bodies.length > 0) {
        bodies[0].appendChild(s);
    } else { // this should never happen, but sometimes does (curse you IE6!)
        document.appendChild(s);
    }

    // this says 100ms, but won't happen until ga.js is loaded
    window.setTimeout(function(){
        if (window['_gat']) {
            var pageTracker = _gat._getTracker("UA-xxxxxx-x");
            pageTracker._trackPageview();
        }
    },100);
} 
```

# jquery - jQuery - 寻找更好的选择器语法

> ID：374085
> 
> 赞同：0
> 
> 时间：2008-12-17T09:39:39.267
> 
> 标签：jquery, syntax, css-selectors

我的 HTML 代码大致如下所示：

```
<li id="someid-11">

<img src="..." alt="alt" />
<h2><a href="somelink"> sometext </a>
    <span><a class="editcontent" href="?action=editme">Edit</a></span>
</h2>
<div id="11" class="content">
 <!-- // content goes here -->
 <div class="bottom_of_entry"> </div>

</li> 
```

我正在使用 a.editcontent 来激活 div.content 上的就地编辑方法。我当前的选择器看起来像这样

```
jQuery('a.editcontent').bind('click', (function(){
    jQuery(this).parent('span').parent('h2').next('.content').trigger('edit');
} 
```

它有效，但它很丑。一定有更好的方法来做到这一点，对吧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T10:08:24.653

我认为使用一些元属性会是一个更好的解决方案。

```
<li id="someid-11">

<img src="..." alt="alt" />
<h2><a href="somelink"> sometext </a>
    <span><a rel="11" class="editcontent" href="?action=editme">Edit</a></span>
</h2>
<div id="11" class="content">
 <!-- // content goes here -->
 <div class="bottom_of_entry"> </div>

</li> 
```

（在链接中添加了 rel="11"）

然后在 JavaScript 中：

```
$( 'a.editcontent' ).click(function()
{   
    $( '#' + $(this).attr( 'rel' )).trigger( 'edit' );
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T09:57:58.140

将id存储在链接中，然后在你的hander上，通过id找到内容div，然后做你的触发器不是更好吗？这样你就不会被绑定到特定的层次结构。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T14:34:43.260

我推荐了 Sprintstar 解决方案。但如果你不喜欢它，使用这个：

```
$("a.editcontent").click(function(){
    $(this).parents("h2").next(".content").trigger("edit");
}); 
```

如果您有多个“h2”：

```
$("a.editcontent").click(function(){
    $(this).parents("h2:first").next(".content").trigger("edit");
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T09:51:38.307

您可能可以使用 xpath 一口气从 A 到 DIV？

编辑：显然 xpath 选择器在 jquery 中不再存在（感谢评论中的人指出这一点）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-17T13:33:21.637

意料之外：

```
$("a.editcontent").click(function(){
    $(this).parents("h2").slice(0, 1).next(".content").trigger("edit");
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T14:18:46.927

我同意 Sprintstart

```
var clickHandler = function (link) {
     $(link.data.action).trigger("edit");
}

$('a.editconent').bind('click', {action:'.content'}, clickHander); 
```

然后，您可以更加关注触发编辑事件的 jQuery 语句。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-07T06:30:44.807

我认为它很难阅读，因为您必须从一个元素上升到另一个元素。如果您从一个公共容器中引用两者，那么这些路径似乎更有意义。

```
var listitem11 = $("#someid-11");

listitem11.find('a.editcontent').bind('click'), (function(){
     listitem11.find('.content').trigger('edit');
} 
```

现在我怀疑你有多个列表项要处理，在这种情况下，你需要一个封闭的循环，而你以前不需要一个。我仍然认为这会让你领先。

# c# - 如何从 wsdl 中的 xs:documentation 标签生成注释？

> ID：374086
> 
> 赞同：1
> 
> 时间：2008-12-17T09:39:41.047
> 
> 标签：c#, documentation, wsdl

阿罗哈

我收到了一个不错的带有 xs: 文档标签的 wsdl，例如：

```
<xs:complexType name="Supplier">
  <xs:annotation>
    <xs:documentation>
      The supplier of the product
    </xs:documentation>
  </xs:annotation> 
```

有没有办法从中生成`///<summary>`标签？我正在使用视觉工作室 2008

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T14:24:49.067

试试微软[的 WSDL 工具](http://msdn.microsoft.com/en-us/library/7h3ystb6.aspx)，看看是否有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T15:39:13.803

我找到了包含此功能的工具[xsd2code 。](http://www.codeplex.com/Xsd2Code)

-Edoode

# java - 动作之间的Struts2参数

> ID：374099
> 
> 赞同：7
> 
> 时间：2008-12-17T09:45:41.330
> 
> 标签：java, jsp, struts2, parameters, action

我必须将一些参数从一个动作传递给另一个动作，例如跟踪一个事件。

最好的方法是什么？

我不会使用会话参数。谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T09:55:11.560

假设您在一个操作中处于服务器端并希望使用一些参数调用另一个操作。

您可以使用 s:action 标记来调用另一个操作，可能使用原始操作之外的附加/其他参数：

```
 <s:action name="myAction"  ignoreContextParams="true" executeResult="true">
        <s:param name="foo" value="bar"/>
    </s:action> 
```

您还可以使用带有参数的标准 struts-xml 结果类型：

```
<result name="success" type="redirect" >
      <param name="location">foo.jsp?foo=${bar}</param>
      <param name="parse">true</param>
      <param name="encode">true</param>
 </result> 
```

如果您想要客户端重定向，您必须使用适当的参数将 url 发送回客户端，并且可能使用一些 javascript 去那里。

```
 <s:url action="myAction" >
            <s:param name="foo" value="bar"/>
        </s:url> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-23T15:05:13.687

```
<td>
   <s:url id="url" action="Logging">
      <s:param name="m_userNameInAction"><s:property value="m_userNameInForm"/></s:param>
    </s:url>
    <s:a href="%{url}">English</s:a>
</td> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-10T21:05:41.840

在struts核心标签中使用url标签，示例如下：

```
 <s:url var="idurl" action="EditEnterprise">
                    <s:param name="enterpriseId">
                        <s:property value="enterpriseId" />
                    </s:param>
                </s:url> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-17T07:07:28.243

实际上，您要将一个动作参数值从一个动作传递到另一动作。

只需包含具有相同名称的 bean 变量。您将在操作（接收器操作）时收到哪个参数。

```
<action name="ForwardAction" class="...">
       <result name="success" type="chain">ReceiverAction</result>
</action> 
```

ForwardAction 参数将被转发到 ReceiverAction。你可以使用它。但在两个操作中包含相同的 bean 名称。

如果您要在接收操作方式中接收用户 ID，

这应该在两个动作中。

```
private int userid;

public void setUserid(int id){
     this.userid = userid;
}

public int getUserid(){
     return userid;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-17T03:56:58.320

实际上，可以在 struts2 中使用范围和 servletConfig 拦截器，以自动弹出操作上下文参数（请求/会话等）

# eclipse - 有什么方法可以让断点符号位于 Eclipse 垂直标尺的顶部？

> ID：374103
> 
> 赞同：1
> 
> 时间：2008-12-17T09:47:57.193
> 
> 标签：eclipse, settings, customization

问题是搜索结果重叠，很难看出我是否设置了断点。任何想法如何解决这个问题？我似乎找不到垂直标尺上显示符号的可自定义顺序。

[替代文字 http://www.imagepaste.com/img/02f37e8804b2ba32af5b13a692f47cb0.png](http://www.imagepaste.com/img/02f37e8804b2ba32af5b13a692f47cb0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T10:07:05.437

找到了解决方法：将断点的注释设置为包含“垂直条”。这将在断点所在行的左侧放置一条细垂直线。我猜已经够好了。

# wpf - Where is IsSynchronizedWithCurrentItem property (or equivalent) for a TreeView?

> ID：374109
> 
> 赞同：6
> 
> 时间：2008-12-17T09:50:51.070
> 
> 标签：wpf, data-binding

[Tell me it ain't so](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/7ab67d24-6afa-4be6-855e-e260845a47e2/).

I have a typical windows/file explorer like setup.

*   Left Side I have a TreeView all data bound showing nodes in a hierachy
*   Right Side I have a ListView showing Node.Properties

ListView has a IsSynchronizedWithCurrentItem property, which rocks. e.g. If I had another ListView showing a list of nodes and both listViews have this property set to true. Changing selection of node in NodesListView will update the PropertiesListView automatically.

Now I need the same thing with a NodesTreeView and a PropertiesListView... and seems like TreeView has no such property.

Is there a more 'the WPF way' kind of solution to this problem ? Or do I have to handle the NodeSelectionChanged event of the Tree and refresh the listView via code.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T09:18:48.560

一个非常简单的解决方案是将您的“详细信息”UI 元素绑定到 TreeView 的 SelectedValue 属性。例如，如果您的 TreeView 看起来像这样：

```
<TreeView Name="CategoryName" ItemsSource="{Binding Source={StaticResource A_Collection}, Path=RootItems}" /> 
```

然后，您可以使用以下方法绑定细节 UI 元素（如文本框）：

```
<TextBox Text="{Binding ElementName=CategoryTreeView, Path=SelectedValue.Name}"/> 
```

将导致文本框绑定到当前在 TreeView 中选择的项目的名称属性。

如果要将许多 UI 项绑定为所选 TreeView 项的详细信息，请考虑在包含所有详细信息控件（DockPanel / Grid / StackPanel 等）的元素上设置 DataContext。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T04:16:01.603

```
<ListView Name="listView1" 
    ItemsSource="{Binding Path=SelectedItem.Modules, 
                          ElementName=treeView1, Mode=OneWay}" 
    IsSynchronizedWithCurrentItem="True"> 
```

其中“ `.Modules`”是要显示的选定树视图项之外的子项的集合。不要担心`SelectedItemChanged`在树视图上连接“”事件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T14:34:17.613

为什么它没有实现该属性，我不知道，但我在下面有一个建议。

您上面的代码将起作用，但是，它不是 IsSynchronizedWithCurrentItem 属性的作用。任何 ItemsControl 都绑定到 ItemsSource 属性的 ICollectionView。要获得该 ICollectionView，我们可以调用 CollectionViewSource.GetDefaultCollectionView(object o)。根据对象 o 的类型，您将获得 ICollectionView 接口的不同具体实现。CollectionView 和 ListCollectionView 是我想到的两个具体类。

ICollectionView 接口包含一个名为 CurrentItem 的成员。IsSynchronizedWithCurrentItem 所做的是：每当在 ItemsControl 上单击一个项目时，它都会为集合视图设置 CurrentItem。ICollectionView 也有两个事件：CurrentItemChanging 和 CurrentItemChanged。当设置 IsSynchronizedWithCurrentItem 属性时，ItemsControl 将根据 ICollectionView 的 CurrentItem 更新 SelectedItem。说得通？

在主/详细 WPF 方案中，我们只是绑定到 ICollectionView 及其 CurrentItem（CurrentItem 语法类似于 {Binding Items/Name}，其中 Name 是集合的 CurrentItem 上的 Name 属性。

因此，尽管您的代码适用于您的目的，但它并没有起到该属性的作用。要执行该属性的操作，您需要执行以下操作：

1.  当一个项目被选中时，你需要弄清楚它属于哪个集合。我们如何做到这一点？我相信这就是 TreeView 没有实现它的原因。所选项目显示在 TreeViewItem 中。DataContext 是对象本身，但父集合是什么？我想要获得它，您可以将其缓存在某个哈希图中（很傻，但会起作用），或者您可以沿着逻辑树走并获取恰好是 ItemsControl 的 TreeViewItem 的父级。ItemsSource 属性将是您的集合。
2.  获取该集合的 ICollectionView。
3.  需要将该 ICollectionView 转换为 CollectionView （ICollectionView 不实现 CurrentItem 设置器）
4.  在 CollectionView 实例上调用 SetCurrent(.. , ..)

现在，任何绑定到 ICollectionView 的 CurrentItem 的东西都将被更新。

这比我预期的要长。让我知道是否需要进一步澄清。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T12:20:09.677

我对此的解决方案结果非常小..不知道它是否等同于 IsSynchronizedWithCurrentItem。ListView 按预期刷新。

```
// the XAML
<TreeView DockPanel.Dock="Left" x:Name="tvwNodes" ItemsSource="{Binding}" SelectedItemChanged="OnNewNodeSelected"/>
<ListView x:Name="lvwProperties" ItemsSource="{Binding Path=Properties}"

// the code-behind
private void OnNewNodeSelected(object sender, RoutedPropertyChangedEventArgs<object> e)
{
  lvwProperties.DataContext = tvwNodes.SelectedItem; // this returns the selected Node obj
} 
```

# ruby-on-rails - rails 中图片和 js/css 文件后的问号。为什么？

> ID：374127
> 
> 赞同：3
> 
> 时间：2008-12-17T09:57:41.073
> 
> 标签：ruby-on-rails

有谁知道为什么图像和css文件（查看html代码时）后面有问号（带数字）？我怎样才能关闭它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T10:27:00.700

从[Rails API 文档](http://api.rubyonrails.com/classes/ActionView/Helpers/AssetTagHelper.html)：

> 默认情况下，Rails 将使用该资产的时间戳附加所有资产路径。这允许您在很远的将来为资产设置缓存过期日期，但仍然可以通过简单地更新文件来立即使其无效（并因此更新时间戳，然后更新 URL，因为时间戳是其中的一部分） ，这反过来又破坏了缓存）。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T22:10:35.383

它是为了能够在客户端缓存文件，并且在发生更改时仍然确保客户端接收到最新版本。因此，每次文件修改都会产生一个新的时间戳，客户端将向服务器发出新请求以接收修改后的文件。

如果您不想使用（尽管我不明白为什么 - 这是一件好事），请不要使用 rails helpers 来包含 javascripts 或样式表。只需包含普通的 HTML 标签：链接和脚本。

# xml - Regex detect linebreak inside a XML node

> ID：374134
> 
> 赞同：1
> 
> 时间：2008-12-17T10:05:05.270
> 
> 标签：xml, regex

I'm having troubles with a regexp. I'm looking through a set of XML files, and trying to detect some text inside specific nodes that contain a line break.

Here is some sample data:

```
<item name='GenMsgText'><text>The signature will be discarded.</text></item>

<item name='GenMsgText'><text>The signature will be discarded.<break/>
Do you want to continue?</text></item> 
```

In that sample, I want to catch only the text in the second node. I've come up with the below solution that uses a second regexp, but I'd like to know if I can do the same thing using only one.

```
if ($content =~m{<item name='GenMsgText'>(<textlist>)?<text>(.*?)</text>}si)
  {
    $t = $2;
    if ($t =~m {\n}i)
    {
     print G $t."\n\n";
    }
} 
```

* * *

This is for a one-shot tool that isn't meant to be reused, so I'd like to avoid having to write any parsing code that's more than a few lines. Besides, the code above already works, I asked the question for personal knowledge more than for real use.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T13:03:32.180

正则表达式不是此任务的正确工具，它根本无法很好地处理嵌套结构。如果您有一个 DOM API 可供使用，则此 XPath 将找到正确的节点：

如果您正在寻找`<break/>`元素，如您的示例所示：

```
//item[@name='GenMsgText']/text[break] 
```

对于“真正的”换行符，为 CR (0xD) 或 LF (0xA)：

```
//item[@name='GenMsgText']/text[contains(., '&#xD;') or contains(., '&#xA;')] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T10:24:05.247

I should consider using some SAX parser for that. Regex is too fragile to handle xml input.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T13:56:45.113

The problem is that your s-mode `.*?` can match angle brackets as well as newlines. If the regex starts to match an element that can't match, there's nothing to stop it from continuing the match attempt in the next element. If you know there will never be angle brackets in the text, you can confine the match to a single element like this:

```
<item name='GenMsgText'><text>([^<>\n]*\n[^<>]*)</text></item> 
```

EDIT: It's important to note that the regexes offered by Max and Kibbee should *not* be applied in s-mode (/s, single-line, DOTALL...). That's what keeps them from matching beyond the end of the "item" element: in order to reach the next one they would have to match the line separators between the elements.

But even without the /s modifier, both regexes can fail if there are two elements without internal linefeeds on successive lines (i.e., with only one linefeed between them). For example, these two lines would be matched as one:

```
<item name='GenMsgText'><text>foo</text></item>
<item name='GenMsgText'><text>bar</text></item> 
```

On the other hand, what if there are more than two lines in text? The other regexes match exactly one linefeed, so they would fail. In my regex, I explicitly match the *first* linefeed to make sure there is one, but if there are any more linefeeds, they'll be matched by the second character class: `[^<>]*`

This kind of thing is why I tend to avoid using `.*` or `.*?`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T10:11:26.160

I'm not sure, but think this should work:

```
<item name='GenMsgText'>(<textlist>)?<text>(.*\n.*)</text> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T14:36:28.513

与 Alan 提到的相同，您可以使用惰性捕获在匹配结束文本语句之前仅捕获必要的内容

```
<item name='GenMsgText'><text>(.*?\n.*?)</text></item> 
```

但同样，正则表达式可能完全不适合这项工作，您应该使用适当的 XML 解析器。

# ms-access - Is there a small alternative editing tool for Access tables?

> ID：374135
> 
> 赞同：1
> 
> 时间：2008-12-17T10:05:45.160
> 
> 标签：ms-access

We have several legacy applications which use Access databases for storing data and/or configuration.

Sometimes we have to do small changes or corrections at our customers databases. (Adding an index, modifying a data row, ...) In many cases Access is available on the customers' workstations, but sometimes it's not.

Is there any small tool for doing small maintenance operations on Access databases which needs not to be installed? (i.e. can be started from a USB stick)

I know of Squirrel SQL, but I'm hoping for something more lightweight.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T11:01:33.830

当 Access 不可用时，我使用 VBScript 编辑和更新数据库。脚本可以很快编写，并且有许多现成的在线可用脚本，例如用于压缩数据库。

此示例链接一个表。

```
Dim adoCn
Dim adoCat
Dim adoTbl

strLinkFile = "C:\Docs\DB1.mdb"
strAccessFile = "C:\Docs\LTD.mdb"

'Create Link...'
Set cn = CreateObject("ADODB.Connection")
cn.Open "Provider=Microsoft.Jet.OLEDB.4.0;" & _
       "Data Source=" & strAccessFile & ";" & _
       "Persist Security Info=False"

Set adoCat = CreateObject("ADOX.Catalog")
Set adoCat.ActiveConnection = cn

Set adoTbl = CreateObject("ADOX.Table")

Set adoTbl.ParentCatalog = adoCat
adoTbl.Name = "LinkTable"

adoTbl.properties("Jet OLEDB:Link Datasource") = strLinkFile
adoTbl.properties("Jet OLEDB:Link Provider String") = "MS Access"
adoTbl.properties("Jet OLEDB:Remote Table Name") = "Table1"
adoTbl.properties("Jet OLEDB:Create Link") = True

'Append the table to the tables collection'
adoCat.Tables.Append adoTbl 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T10:27:44.193

MS Access uses ODBC so any DB tool on windows can be used.

The main problem with these tools is that many commercial ones use some kind of copy protection, for example a license key which is installed in the registry (for example, [AQT](http://querytool.com/)). So these won't do.

So OSS tools like Squirrel SQL are your best bet since they don't come with artifical restrictions and it's simple to install it (along with Java) on an USB stick:

1.  Just install Java somewhere
2.  Copy the directory on your USB stick
3.  Unpack Squirrel SQL on the USB stick
4.  Create a small .BAT file in the home of Squirrel SQL:

    set DIR=%~dp0
    %DIR%..\java\bin\javaw.exe -jar squirrel.jar

That's it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T11:49:46.137

就我个人而言，我会尽量避免这样做。你是在掩盖问题而不是解决它。

例如，如果一个索引值得添加到单个客户的数据库中，那么它可能值得添加到所有客户数据库中。否则同样的问题会在以后反复出现。我理解快速支持的必要性，但是在不同的工作站上拥有根本不同的数据库只会导致更多的问题向前发展，例如重新创建错误。

一旦他们学会了如何做到这一点以及应用程序是否留在他们的机器上，它还会增加一个潜在的用户“小提琴因素”（即“我想知道如果我改变这个值会发生什么？”）。

要么修改当前应用程序（旧版或非旧版）以在启动时添加适当的索引，要么创建一个单独的小型“修补程序”程序来添加索引并要求您的客户运行它。上面关于这些是使用 VBScript 编写的建议是完全合理的。关键是数据库更改是可重复的，并且您可以跟踪在何处进行了哪些更改。

如果数据本身需要修改，那么为什么这些数据一开始就写得不好呢？也许可以适当地修改应用程序，以便首先防止这种情况发生？这将避免其他数据库发生同样的问题。

# php - htmlspecialchars和json编码问题

> ID：374152
> 
> 赞同：2
> 
> 时间：2008-12-17T10:15:45.670
> 
> 标签：php, javascript, ajax

我正在尝试格式化一些错误的 html 以输出到弹出窗口中。html 存储在 mysql 数据库的字段中。

我一直在 php 中的行上执行 json_encode 和 htmlspecialchars，如下所示：

```
$html = htmlentities(json_encode($row2['ARTICLE_DESC'])); 
```

并调用我的 makewindows 函数，它只是将 html 作为参数并将其与document.write 一起使用，如下所示：

```
 <p><a href='#' onclick=\"makewindows('".$html."'); return false;\">Click for full description </a></p> 
```

这可以正常工作，因为生成了一些 html 代码，例如：

[http://www.nomorepasting.com/getpaste.php?pasteid=22823&seen=true&wrap=on&langoverride=html4strict](http://www.nomorepasting.com/getpaste.php?pasteid=22823&seen=true&wrap=on&langoverride=html4strict)

粘贴在那里，因为我不知道如何在 SO 中换行

问题是 htmlspecialchars 似乎没有剥离坏的 html 数据，因为没有创建弹出窗口。我收到的萤火虫错误是

参数列表后缺少 )

但是 html 不在我的控制范围内。

根据我的阅读，我正在采取正确的步骤。如果我遗漏了什么，那是什么？

我的完整制作窗口功能：

```
function makewindows(html){
child1 = window.open ("about:blank");
child1.document.write(html);
child1.document.close(); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T10:26:38.707

您不应该在函数调用中使用单引号。它应该如下所示：

```
<p><a href='#' onclick=\"makewindows(" . $html . "); return false;\">Click for full description </a></p> 
```

然后输出看起来像

```
<p><a href='#' onclick="makewindows(&quot;.....&quot;); return false;">Click for full description </a></p> 
```

哪个是对的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T10:27:53.773

试试下面的方法：

```
$html = htmlentities(json_encode($row2['ARTICLE_DESC']),ENT_QUOTES); 
```

我认为默认情况下不会转义单引号。不过，我建议您在打开窗口之前将 html 保存在 JavaScript 变量中。

# c# - 在打开之前检查文件是否已被使用（网络驱动器，C#）

> ID：374155
> 
> 赞同：2
> 
> 时间：2008-12-17T10:18:48.127
> 
> 标签：c#, file, readonly

.Net 中是否有任何方法可以在打开文件（在本地网络驱动器上）之前检查是否已在使用中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T10:22:57.480

您应该尝试访问它，如果它失败了，您要么没有所需的权限（您可以使用 GetAccessControl 检查），要么它被另一个进程锁定。

但是我认为没有任何可靠的措施可以区分锁定和权限失败（因为您可能能够读取文件，但无法检查权限）。甚至 Windows 的错误消息都说您没有权限，或者它正在被另一个进程使用。

您可以使用 WMI`CIM_DataFile`类来查询`InUseCount`指定的数据文件。

如果您正在寻找与`lsof`Linux 中的实用程序等效的程序，要找出给定**本地**进程的所有打开文件，您可以尝试`Win32_Process`通过命名空间使用 WMI 类`System.Management`。您可以发出 WMI 查询来查找所有本地进程正在使用的所有打开文件中的文件名，看看它是否存在。或者，您可以 P/Invoke 并`NtQuerySystemInformation`直接使用 API 来完成相同的任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T11:33:38.023

这会做。MSDN 中提到的 FileShare.None ：

> 无：拒绝共享当前文件。任何打开文件的请求（通过这个进程或另一个进程）都会失败，直到文件被关闭。

```
File.Open(name, FileMode.Open, FileAccess.Read, FileShare.None); 
```

编辑：请记住包装在 Try/Catch 块中，并且使用 FileShare.None 实际上意味着您要以独占方式打开文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T11:34:39.847

```
bool CanReadAndWrite(string path)
{
    var perm = new System.Security.Permissions.FileIOPermission(
         System.Security.Permissions.FileIOPermissionAccess.Write |
         System.Security.Permissions.FileIOPermissionAccess.Read,
         path);
    try
    {
         perm.Demand();
         return true;
    }
    catch 
    {
         return false;
    }
} 
```

检查您是否可以读取和写入文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T10:25:02.017

使用 System.IO.File.OpenWrite(path)。将它包围在一个 try/catch 块中，如果它已经打开以便在其他地方写入，您将收到 System.UnauthorizedAccessException。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T10:32:59.380

以下语法将有所帮助：

FileStream s2 = new FileStream(name, FileMode.Open, FileAccess.Read, FileShare.Read);

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T12:18:58.370

通常，您应该始终避免依赖文件可访问性检查。原因是它可能是，然后它可能会在您访问它之前更改几个周期。

相反，只需尝试打开它，看看是否有任何错误。

# sql-server - 有没有办法优化下面给出的查询

> ID：374156
> 
> 赞同：-1
> 
> 时间：2008-12-17T10:20:04.943
> 
> 标签：sql-server

我有以下查询，我需要该查询根据 Someothertable 中存在的过滤条件从 SomeTable 中获取数据。如果 SomeOtherTable 中没有任何内容，查询应该返回 SomeTable 中的所有数据

SQL 服务器 2005

SomeOtherTable 没有任何索引或任何约束所有字段都是 char(50)

以下查询可以很好地满足我的要求，但是当我有很多参数时会导致性能问题。

由于客户的一些要求，我们必须将所有 Where 子句数据保留在 SomeOtherTable 中。取决于 subid 数据将与 SomeTable 中的列之一连接。

例如查询可以是

```
SELECT
    *
FROM
    SomeTable
WHERE
    1=1 
AND
(
SomeTable.ID in (SELECT DISTINCT ID FROM SomeOtherTable  WHERE Name = 'ABC' and subid = 'EF')
OR
0=(SELECT Count(1) FROM SomeOtherTable WHERE spName = 'ABC' and subid = 'EF')
)

AND 
    (
    SomeTable.date =(SELECT date FROM SomeOtherTable  WHERE Name = 'ABC' and subid = 'Date')
    OR
    0=(SELECT Count(1) FROM SomeOtherTable WHERE spName = 'ABC' and subid = 'Date')
    ) 
```

编辑 - - - - - - - - - - - - - - - - - - - - - - -

我想我可能需要详细解释我的问题：

我们开发了一个用于调用参数化水晶报表的 ASP.net 应用程序，水晶报表的参数不使用默认水晶报表方法传递。

在 ASP.net 应用程序中，我们创建了用于将参数传递给报表的向导，这些参数不直接由水晶报表使用，而是由嵌入在水晶报表中的查询或水晶报表中使用的存储过程使用.

这是使用表 (SomeOtherTable) 来实现的，该表在报表运行后保存参数数据，之后删除数据，因此我们可以假设 SomeOtherTable 在任何给定时间点最多有 2 到 3 行。

因此，如果我们查看上面的查询，查询的初始部分可以假设为报告查询，并且 where 子句用于从 SomeOtherTable 表中获取用户输入。

所以我认为创建索引等没有用（可能是我错了）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T04:20:11.067

> SomeOtherTable 没有任何索引或任何约束所有字段都是 char(50)

嗯，有你的问题。如果您像这样创建查询，您无法对这样的查询执行任何操作来提高其性能。

*   您需要在所有表上指定适当的主键或其他候选键。也就是说，表上至少需要一个唯一索引。您可以通过将一个或多个字段指定为 PK 来做到这一点，或者您可以添加一个 UNIQUE 约束或索引。

*   您需要正确定义字段。该字段是否存储整数？那么，INT 字段可能只是比 CHAR(50) 更好的选择。

您不能“优化”基于不健全架构的查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T10:31:34.373

尝试：

```
SELECT
    *
FROM
    SomeTable
LEFT JOIN SomeOtherTable ON SomeTable.ID=SomeOtherTable.ID AND Name = 'ABC'
WHERE
    1=1 
AND
(
SomeOtherTable.ID IS NOT NULL
OR
0=(SELECT Count(1) FROM SomeOtherTable WHERE spName = 'ABC')
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T10:36:16.207

还在每个表名后加上“with (nolock)”以提高性能

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T10:37:38.760

以下内容可能会加快您的速度

```
选择 *
来自 SomeTable
在哪里
   SomeTable.ID 在
        （从 SomeOtherTable 中选择 DISTINCT ID，其中 Name = 'ABC'）
联盟
选择 *
来自 SomeTable
在哪里
   不存在（从 SomeOtherTable 中选择 spName，其中 spName = 'ABC'）

```

UNION 将有效地将其拆分为两个可以单独优化的更简单的查询（很大程度上取决于 DBMS、表大小等是否真的会提高性能——但它总是值得一试）。

“EXISTS”关键字比“SELECT COUNT(1)”更有效，因为它会在遇到第一行时立即返回 true。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-17T10:41:43.260

或者先检查该值是否存在于 db 中并且您可以删除查询中的 distinct 关键字，这里没用。

if EXISTS (Select spName From SomeOtherTable Where spName = 'ABC') begin SELECT * FROM SomeTable WHERE SomeTable.ID in (SELECT ID FROM SomeOtherTable Where Name = 'ABC') end else begin SELECT * FROM SomeTable end

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T10:42:19.110

阿罗哈

尝试

```
select t.* from SomeTable t
    left outer join SomeOtherTable o
        on t.id = o.id
where (not exists (select id from SomeOtherTable where spname = 'adbc')
OR spname = 'adbc') 
```

-Edoode

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T13:00:17.007

将 where 部分中的所有 select 语句更改为内部 jons。OR 条件应该是 union all-ed。还要确保你的索引是好的。

有时，为您可以加入的临时结果提供一个中间表是值得的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-19T03:53:21.180

我将坚持我原来的查询。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-19T04:05:24.277

在我看来，您的查询中不需要“1 = 1 AND”。1=1 将始终评估为真，让软件评估下一部分......为什么不跳过 1=1 并评估多汁的部分？

# dll - 在 Linux 中使用 Windows DLL

> ID：374157
> 
> 赞同：24
> 
> 时间：2008-12-17T10:20:53.850
> 
> 标签：dll, linux, api

我们需要与第 3 方应用程序交互，但该应用程序背后的公司并未公开消息协议，并且仅提供 Windows DLL 来进行交互。

我们的应用程序是基于 Linux 的，因此我无法直接与 DLL 通信。我找不到任何现有的解决方案，所以我正在考虑在 Linux 和 Windows 之间编写基于套接字的桥接器，但是我确信这不是一个独特的问题，以前应该有人这样做过。

您是否知道任何允许从 Linux 上的 C 应用程序调用 Windows DDL 函数的解决方案？它可以使用 Wine 或单独的 Windows PC - 没关系。

提前谢谢了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2017-12-06T10:34:00.677

我编写了一个小的 Python 模块，用于在 Linux 上从 Python 调用 Windows DLL。它基于常规 Linux/Unix Python 进程和基于 Wine 的 Python 进程之间的 IPC。因为我自己在太多不同的用例/场景中都需要它，所以我将它设计为“通用”[`ctypes`模块](https://docs.python.org/3/library/ctypes.html)的替代品，它在后台自动完成大部分所需的管道。

示例：假设您在 Linux 上使用 Python，您安装了 Wine，并且想要调用`msvcrt.dll`（Microsoft C 运行时库）。您可以执行以下操作：

```
import zugbruecke as ctypes
dll_pow = ctypes.cdll.msvcrt.pow
dll_pow.argtypes = (ctypes.c_double, ctypes.c_double)
dll_pow.restype = ctypes.c_double
print('You should expect "1024.0" to show up here: "%.1f".' % dll_pow(2.0, 10.0)) 
```

[源代码 (LGPL)](https://github.com/pleiszenburg/zugbruecke)、[PyPI 包](https://pypi.python.org/pypi/zugbruecke)和[文档](http://zugbruecke.readthedocs.io/)。

它的边缘仍然有点粗糙（即 alpha 和不安全），但它确实可以处理大多数类型的参数（包括指针）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-17T11:01:52.410

任何解决方案都需要在“类 Windows”环境中运行的 DLL 和您的 linux 应用程序之间建立一个基于 TCP/IP 的“远程处理”层。

您需要编写一个简单的 PC 应用程序来公开 DLL 函数，可以使用自制协议，也可以使用 XML-RPC、SOAP 或 JSON 协议。RemObjects [SDK](http://www.remobjectssdk.com)可能会对您有所帮助 - 但可能有点矫枉过正。

我会坚持使用“真实”或虚拟化的 PC。如果您使用 Wine，DLL 开发人员不太可能提供任何支持。

MONO 也不太可能有任何帮助，因为您的 DLL 可能不是 .NET 程序集。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-18T15:22:53.973

有时，选择小型供应商而不是大型供应商会更好，因为您的业务规模会给您带来更大的权重。我们当然在 AV 引擎供应商那里发现了这一点。

如果您对他们足够重要，他们应该提供文档化的、受支持的协议、库的 Linux 构建或库的源代码。

否则，您将不得不像其他人所指出的那样使用 RPC 在循环中运行 Windows 机器，这可能非常不方便，特别是如果您的基础架构的其余部分都运行 Linux。

供应商是否支持在 Windows VM 中使用他们的库？如果性能不重要，您也许可以这样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-06-19T11:58:33.617

这是一个常见的问题。幸运的是，它现在有一个解决方案。认识由 Tavis Ormandy 开发的 LoadLibrary：

[https://github.com/taviso/loadlibrary](https://github.com/taviso/loadlibrary)

[我第一次在Michael Larabel 的一篇关于 Phoronix 的文章中](https://www.phoronix.com/scan.php?page=news_item&px=LoadLibrary-DLLs-On-Linux)偶然发现了 LoadLibrary ：

> 一位 Google 研究人员一直在开发“LoadLibrary”，作为一种能够加载 Windows 动态链接库 (DLL) 的方法，而这些动态链接库 (DLL) 又可以被原生 Linux 代码使用。
> 
> LoadLibrary 不是 Wine 等的替代品，但旨在允许加载 Windows DLL 库，然后可以通过本机 Linux 代码访问，而不是尝试在 Linux 上运行 Windows 程序等，而只是加载库。
> 
> 该项目由专注于漏洞研究的知名 Google 员工 Tavis Ormandy 开发。他基于旧的 ndiswrapper 代码开发了一个定制的 PE/COFF 加载器，该项目是关于允许 Windows 网络驱动程序在 Linux 上运行的项目。LoadLibrary 将处理重定位和导入，并提供受 dlopen 启发的 API。在这个阶段，LoadLibrary 似乎与自包含的 Windows 库配合得很好，Tavis 正在使用该项目部分地在 Linux 上对 Windows 库进行模糊测试。
> 
> Tavis 指出，*“Windows 上的分布式、可扩展的模糊测试可能具有挑战性且效率低下。对于端点安全产品尤其如此，这些产品使用跨内核和用户空间的复杂互连组件。这通常需要启动整个虚拟化 Windows 环境来进行模糊测试它们或收集覆盖率数据。这在 Linux 上不是什么问题，而且我发现将 Windows 防病毒产品的组件移植到 Linux 通常是可能的。这使我能够在最小的容器中运行我正在测试的代码，而几乎不需要开销，并轻松扩大测试规模。”*
> 
> [有关通过GitHub](https://github.com/taviso/loadlibrary)在 Linux 上加载 Windows DLL 的 LoadLibrary 的更多详细信息 ，他还演示了将 Windows Defender 库移植到 Linux。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T10:33:48.847

自己调用 DLL 的函数当然只是冰山一角。如果 DLL 调用 Win32 怎么办，那么你会有一个相当大的链接问题。我想 Wine 可以帮助你，但不确定他们是否提供了解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T10:55:26.573

IMO，最好的选择是使用套接字。我以前做过这个，它就像一个魅力。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-10-26T01:18:13.073

另一种方法是使用`objdump -d`反汇编 DLL，然后重新编译/重新组装它。不要期望能够重新编译未经编辑的代码。您可能会得到纯粹的、纯粹的垃圾，或充满 Windows 调用的代码，或两者兼而有之。寻找个别功能。函数通常由一系列`push`指令分隔并以指令结束`ret`。

# objective-c - Cocoa one row table view or a horizontal list view

> ID：374159
> 
> 赞同：2
> 
> 时间：2008-12-17T10:21:53.037
> 
> 标签：objective-c, cocoa

Is it posible to use table view to show just one row of a big amount of elements? What I'm looking for is for some kind of horizontal list, like we have in XCode preferences or Aperture image list.

It would behave just like a one columnt table view, but instead of showing the elements vertically, it should be horizontally.

Can you point me to where should I start from?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T18:49:41.577

如果你对 Leopard-only 没问题，新的 NSCollectionView 支持水平显示。只需在 Interface Builder 中将集合视图的行数设置为 1；它甚至会为您处理水平滚动条。[IconCollection](http://developer.apple.com/samplecode/IconCollection/index.html)示例代码提供了其工作原理的简单演示。它的绑定与表格视图的工作方式类似，除了行和列之外，每个表示的对象都有一个显示它的“项目”（NSCollectionViewItem 类型的对象），并且这些项目将被布置在网格中。上面的示例代码演示了如何在 Interface Builder 中设置这些“项目”，这绝对是最简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T16:31:41.963

使用表格视图？不。如果我正确理解你想要什么，过去我已经为这种类型的控件创建了自己的 NSView 子类。定义一个类似于 NSTableView 的数据源协议，在你的 NSView 的 drawRect 方法中，从左到右依次绘制元素。您可以在控件中跟踪分页，也可以将其放在滚动视图中，并在项目数量发生变化时自行调整大小。

通常这类事情一开始很简单，一旦你开始处理缓存、分页、选择、鼠标和键盘输入等等，就会变得有点复杂。我的建议是，从尽可能简单的开始，然后一个一个地添加新功能，只有在你完成了上一个任务之后。

# ruby - 导入一个巨大的 csv 数据文件并使用标题访问使用 Ruby 的列

> ID：374163
> 
> 赞同：1
> 
> 时间：2008-12-17T10:23:26.123
> 
> 标签：ruby, csv, fastercsv

我需要导入一个巨大的 csv 数据文件（6880 列），并且我需要能够使用列标题来访问它。

最好的方法是什么？

速度并不重要。清晰度是。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-17T10:28:44.910

[FasterCSV](https://rubygems.org/gems/fastercsv)（也[可作为 Ruby 1.9 标准库中的 CSV 使用](https://stackoverflow.com/questions/5011395/what-is-ruby-1-9-standard-csv-library)）应该能够做到这一点。您可以使用列标题来访问行的数据：

```
require 'fastercsv'
FasterCSV.foreach(csv_file, {:headers => true, :return_headers => false, :header_converters => :symbol, :converters => :all} ) do |row|
    puts row[:some_column_header] # Would be "Some Column Header" in the csv file.
end 
```

# javascript - What web UI toolkit do you use within your Rails application?

> ID：374166
> 
> 赞同：2
> 
> 时间：2008-12-17T10:24:23.827
> 
> 标签：javascript, ruby-on-rails, user-interface, toolkit

I'm looking for a Web UI toolkit for a Rails-based application. I have an experience with YUI but not in a Rails context. I have many questions I wish you could help me to answer.

1.  Do you use a web UI toolkit like `YUI`, `ExtJS` or `JxLib` within your Rails application ?
2.  Which UI toolkit is the most Rails-friendly ? Since most are not based on Prototype, is the co-existence of Prototype and another Javascript library (`MooTools`, `JQuery`, ...) easy and safe ?
3.  Do you mix usual 'traditional' Rails view development (`rhtml`, `rjs`) with a UI toolkit-based development ? In the same application ? In the same view ?
4.  Do you use a Rails plugin or do you code `plain Javascript` ?

Thanks all for your answers.

Laurent

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T11:55:14.643

[如果您不想使用 Prototype，则无需使用](http://www.loudthinking.com/posts/32-myth-3-rails-forces-you-to-use-prototype)- 例如，JQuery 在 Rails 社区中非常流行。不过，如果我同时运行 JQuery 和 Prototype，我会担心潜在的难以解决的冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T10:54:15.437

1.  我们现在正在使用 Ext 和 Rails 构建一个相当大的应用程序。[你可以在这里](https://stackoverflow.com/questions/182571/the-dangers-of-using-extjs-on-a-big-project-with-ror)看到一些关于它的讨论。

2.  AFAIK 很容易将 JQuery 与其他 js 库一起使用（其他 js 库也可能是这种情况）。但是，我强烈建议您一次只使用一个库，以保持清晰。

3.  我们实际上正在构建两个应用程序——服务器端 Rails 应用程序来处理数据并通过 JSON API 公开它们，以及使用此 API 的客户端 Ext 应用程序。为了生成客户端应用程序，我们通过 ERB 解析 Javascript 源代码，以便我们可以使用一些帮助程序来构建它。

4.  我们使用带有一些自定义助手的纯 Javascript。

希望能帮助到你。

# asp.net-mvc - 从 asp.net mvc 项目中的慢速文件删除文件

> ID：374179
> 
> 赞同：0
> 
> 时间：2008-12-17T10:31:51.830
> 
> 标签：asp.net-mvc

当我从 asp.net mvc 项目（不在 svn 或任何源代码控制提供程序中的项目）中删除任何文件时，UI 最多需要 60 秒才能再次响应。CPU 使用率跃升至 80/90%。有没有其他人经历过这种情况并知道任何修复或解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T19:55:20.663

您的意思是从 Visual Studio 解决方案中删除文件吗？如果是这样，解决方法是清空 Windows 回收站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T10:37:07.700

如果您正在谈论正在运行的网站试图删除文件，那么请在单独的线程中删除文件。

如果您正在谈论删除源文件，那么几年前我就遇到过这个问题。我不记得修复是什么，但我认为它不在最新的 Visual Studio 中（如果你在做 MVC，你可能正在使用它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T07:53:19.110

是的，我有类似的问题。只需清空您的回收站，它就会再次开始快速删除文件。

高温高压

# svn - SVN Update problem in Eclipse

> ID：374198
> 
> 赞同：3
> 
> 时间：2008-12-17T10:43:31.183
> 
> 标签：svn, eclipse-plugin

I have been using SVN with Eclipse for ages without problems. But suddenly, one project is not working properly, even though others are fine.

When I try to update I get this:

![alt text](https://i32.photobucket.com/albums/d22/d000hg/SVNissue.png)

In the Eclipse log I see: U

> nsupported working copy format svn: This client is too old to work with working copy 'C:\Work\xxxxxxxxxxxx\client'; please get a newer Subversion client

Any ideas? I can't see how to update the SVN plugin even if it is too old...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T10:47:51.797

At some point, someone ran a SVN comment on your sandbox using a client that uses a newer fromat than your plugin (probably a Subversion 1.5 client where you had previously been using 1.4).

If you don't update your client/plugin, you can checkout your sandbox again using your preferred client/plugin, or use the change-svn-wc-format.py script, as detailed in the Subversion 1.5 release notes, under [Working Copy and Repository Format Changes](http://subversion.tigris.org/svn_1.5_releasenotes.html#wc-and-repos-format-change).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T17:01:49.750

Subversion 客户端在接触到您的工作副本时会自动升级它。正如 Blair 所说，有些东西触动了您的工作副本，可能是一个 1.5 客户端。

您需要将所有不同的 Subversion 客户端 - CollabNet（命令行）、TortoiseSVN、Subclipse、Subversive 等 - 都保留在同一个次要版本（1.4 与 1.5）上，否则您将继续遇到此问题。

Blair 有一个很好的修复策略，但最简单的方法是重新检查工作副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T10:46:59.677

You can try to set SVN plugin (subclipse?) to use svnkit instead of native client.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T10:45:50.803

If subversion is not included in your SVN plugin, then you need to upgrade your svn client itself. Have you checked whether the server you're connecting with has not been updated?

# delphi - Finding available LPT (parallel) ports and addresses in Delphi

> ID：374200
> 
> 赞同：4
> 
> 时间：2008-12-17T10:45:20.010
> 
> 标签：delphi, port, parallel-processing, pci-bus, lpt

I am doing direct I/O on a parallel port which is fine and necessary for speed. I would like to enumerate the available ports to offer the user a choice of ports at setup time rather than a tedious trawl through device manager to read the address manually. Does anyone know a means of doing this please? Many thanks, Brian

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T13:55:08.160

According to [this Microsoft article](http://msdn.microsoft.com/en-us/library/aa506006.aspx), for Win2K and newer, you can find details of parallel-connected devices in the registry at HKLM\SYSTEM\CurrentControlSet\Enum\LPTENUM.

# linux - 做自己的或现成的论坛软件更好吗？

> ID：374203
> 
> 赞同：8
> 
> 时间：2008-12-17T10:45:53.127
> 
> 标签：linux, apache, forum

作为囊性纤维化支持组织广泛工作的一部分，他们还希望建立一个网站，我决定在 Linux 上运行 Apache（主要是因为它的安全性和低成本）。除了（相当）静态内容之外，他们还想要一个人们可以讨论病情问题的论坛——它将附属于连锁医院，因此那里会有很多对网络知之甚少的医务人员。

我可以处理所有特定的编码和 Apache 设置，因为我以前做过，但我对人们对我是否应该推出自己的论坛软件或获取一些现成的东西的意见感兴趣。我没有**任何**使用论坛软件的经验，但我可以在一个月左右的时间内生成自己的（最初是错误的，我敢肯定）。

它需要注册和登录才能发表评论（但访客访问只是为了阅读），我希望它“漂亮”（对不起，我记得该死的客户提供了类似模糊的要求规格:-) 但不一定是无限的- 可配置皮肤/主题/等。

如果有人有一些令人信服的理由（以及可以提供我需要的特定产品的经验），我很想听听他们的消息。或者，是否有人在编写自己的论坛软件时遇到过任何“陷阱”？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T10:50:15.427

**自己滚动的**优势：****

 ***   非标准的定制系统意味着您将不太容易受到“标准”攻击（例如：PunBB 中的漏洞），因为坏人往往只会在广泛部署的系统上进行漏洞搜索（他们的投资回报更高） )
*   绝对控制您的系统的工作方式和外观
*   你会学到很多

**缺点：**

*   你会重复别人已经解决的错误
*   启动和运行需要更长的时间
*   从长远来看，它将需要更多的维护（因为您必须自己修复错误并添加功能）。
*   你不能“利用社区”——如果你选择一个具有插件系统的现成论坛，那么你的自定义论坛软件将无法使用一大堆社区插件。

维基百科上有[一个巨大的论坛软件列表](http://en.wikipedia.org/wiki/Internet_forum_software)——其中很可能有适合您需要的东西，您可以快速启动并运行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T10:55:32.577

恕我直言，“不要构建你能买到的东西”的古老格言适用于此（好吧，web 2.0 版本显然是“不要构建你可以下载的东西”）。浏览一下可用的论坛软件，选择一个满足您 99% 需求的软件，然后对其进行调整以完成其余的工作。

如果您仍然想构建自己的论坛软件，这可能是一个很酷的副项目，但如果您的工作是让论坛启动并运行，那么去下载一个 - 不要试图混淆做酷的愿望东西和日常工作，除非日常工作只是做很酷的事情。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T14:05:39.573

互联网上保存最完好的秘密之一是[Ilia Alshanetsky的名为](http://ilia.ws/)[FUDforum](http://en.wikipedia.org/wiki/FUDforum)的小宝石。

> 是的，正是 Ilia 编写了 xDebug 的原始分析器代码，改进了 MMcache 中的缓存，修复了 libmcrypt 中的几个安全漏洞，并且是 PHP*语言*从 4.3.3 到 4.3.6+ 的发布经理。正如我在波士顿的朋友所说，他是**个邪恶的聪明人**。

正因为如此，FUDforum 比您的 Web 应用程序的任何其他部分都强大、**快得离谱**且更安全。它带有一个简洁的安装脚本，它具有您需要的所有功能。

另外，它不是像 phpBB 或 vBulletin 那样引人注目的目标，这意味着您不必担心垃圾邮件机器人不断地敲门。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-16T23:20:55.963

之前写过自己的论坛软件...

这似乎是一个简单的问题，但是当你进入它时，你会发现有很多小事情你想做的更好，而且需要很多时间。我的很酷，而且我确实得到了报酬，但如果我再做一次（这也发生了），我会使用可定制的预制解决方案，并把所有的空闲时间都花在做一些有成效的事情上。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T10:55:25.357

论坛软件往往具有相当复杂的最低要求。无论您做什么，您都可能需要做一些事情：

*   论坛/线程/帖子层次结构；
*   用户系统；
*   安全系统（例如用户/管理员类和对用户的各种限制）；
*   收集统计数据；
*   BBCodes 或其他一些最小化的标记语言（绝不允许用户使用完整的 HTML）；
*   文件上传和头像；
*   禁令和其他处罚；
*   验证码；
*   等等

现成的论坛系统提供了开箱即用的功能以及更多功能。设置也很容易。为什么要自己重来？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T10:49:10.873

我的回答是：不要重新发明轮子，那里有很多论坛软件。如果您只需要，我更喜欢[RForum 。](http://rforum.andreas-s.net/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-17T10:51:42.040

我会说，不要浪费你的时间。[phpBB 3](http://www.phpbb.com/)是相当稳定、可用且功能丰富的论坛。我们在工作中使用它（用于我们的内部讨论），我真的没有什么不好说的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-17T11:55:52.643

我同意上面的大多数海报，既然你想要一些看起来相当标准的东西，为什么要重新发明已经存在的东西呢？像任何开发一样，创建论坛软件可能比看起来要困难得多！现有软件中会出现你甚至没有考虑过的问题。

值得补充的是，如果您确实需要任何特定的附加功能，您始终可以在现有解决方案之上构建它，如果您有源代码（无论是开源代码还是商业代码），这尤其容易。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-17T12:00:53.990

从您正在构建的网站的声音来看，论坛有可能成为一个非常有用和可见的资源，由于许多产品的质量，最好使用已经存在的东西那里和他们周围的富裕社区。

我认为 vBulletin 虽然是付费产品，但可以满足您的需求，并为您提供建立社区的良好基础。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T14:16:10.910

[vanilla](http://getvanilla.com/)非常简单且易于配置，也许可以找到一个易于扩展的系统而不是自己构建所有东西

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-19T23:14:27.963

**准备就绪，直到您需要一些真正独特的功能，这些功能可以与它将为您带来的金钱挂钩。**

# c# - 一段时间后，GC 包含大量固定对象

> ID：374215
> 
> 赞同：4
> 
> 时间：2008-12-17T10:52:41.367
> 
> 标签：c#, memory, com, compact-framework, garbage-collection

在不断实例化一个 com-wrapper 然后让 GC 收集它（不是强制）时，我有一个奇怪的现象。

我正在 WinCE x86 上的 .net cf 上对此进行测试。使用 .net Compact 框架远程监控器监控性能。使用平台构建器工具包中的 Windows CE 远程性能监视器跟踪本机内存。

在前 1000 个创建的实例中， perfmon 中的每个计数器似乎都正常：

*   GC 堆上升和下降，但平均值保持不变
*   固定对象为 0
*   本机内存保持相同的平均值
*   ...

但是，在这 1000 个（大约）之后，固定对象计数器会上升，并且永远不会再下降。但是，内存使用量保持不变。

我不知道从这些信息中得出什么结论...这是计数器中的错误，这是我的软件中的错误吗？

[编辑]

我确实注意到，一旦 GC 稳定后使用的总字节数与压缩器计数器未移动的对象一样，固定对象计数器开始上升。

[计数器图形 http://files.stormenet.be/gc_pinnedobj.jpg](http://files.stormenet.be/gc_pinnedobj.jpg)

[/编辑]

这是涉及的代码：

```
 private void pButton6_Click(object sender, EventArgs e) {
        if (_running) {
            _running = false;
            return;
        }
        _loopcount = 0;
        _running = true;

        Thread d = new Thread(new ThreadStart(LoopRun));
        d.Start();
    }

    private void LoopRun() {
        while (_running) {
            CreateInstances();
            _loopcount++;
            RefreshLabel();
        }
    }

    void CreateInstances() {
        List<Ppb.Drawing.Image> list = new List<Ppb.Drawing.Image>();
        for (int i = 0; i < 10; i++) {
            Ppb.Drawing.Image g = resourcesObj.someBitmap;
            list.Add(g);
        }

    } 
```

Image 对象包含一个 AlphaImage：

```
 public sealed class AlphaImage : IDisposable {
    IImage _image;
    Size _size;
    IntPtr _bufferPtr;

    public static AlphaImage CreateFromBuffer(byte[] buffer, long size) {
        AlphaImage instance = new AlphaImage();
        IImage img;
        instance._bufferPtr = Marshal.AllocHGlobal((int)size);
        Marshal.Copy(buffer, 0, instance._bufferPtr, (int)size);
        GetIImagingFactory().CreateImageFromBuffer(instance._bufferPtr, (uint)size, BufferDisposalFlag.BufferDisposalFlagGlobalFree, out img);
        instance.SetImage(img);
        return instance;
    }

    void SetImage(IImage image) {
        _image = image;
        ImageInfo imgInfo;
        _image.GetImageInfo(out imgInfo);
        _size = new Size((int)imgInfo.Width, (int)imgInfo.Height);
    }

    ~AlphaImage() {
        Dispose();
    }

    #region IDisposable Members

    public void Dispose() {
        Marshal.FinalReleaseComObject(_image);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T10:59:57.703

好吧，您的代码中存在一个错误，即您创建了很多 IDisposable 实例并且从不对它们调用 Dispose。我希望终结者最终会发挥作用，但它们不应该真的是必需的。在您的生产代码中，您是否适当地处理了所有内容 - 如果没有，是否有一些原因您不能？

如果您在 AlphaImage 终结器中添加了一些日志记录（检测 AppDomain 卸载和应用程序关闭并且在这些情况下不记录！）它是否显示终结器被调用？

编辑：一个潜在的问题可能*不会对*您造成困扰，但无论如何可能值得修复 - 如果对 CreateImageFromBuffer 的调用由于某种原因失败，您仍然拥有 AllocHGlobal 创建的内存，并且当前将被泄露。我怀疑这不是问题，否则它会爆炸得更壮观，但值得思考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T12:19:57.417

我怀疑这是 RPM 中的错误。我们在这里没有对 Ppb.Drawing 的任何见解。我看到潜在问题的地方是 GetIimagingFactory 调用。它有什么作用？它可能只是一个单例吸气剂，但这是我要追逐的东西。

我还看到了一个 AllochHGlobal，但我没有看到该分配被释放。现在，这就是我要关注的地方。

# c++ - 将 C++ 头文件转换为 Python

> ID：374217
> 
> 赞同：8
> 
> 时间：2008-12-17T10:53:00.070
> 
> 标签：c++, python, data-structures, enums, header

我有一个包含#define 语句、枚举和结构的 C++ 标头。我尝试使用 Python 中包含的 h2py.py 脚本无济于事（除了给我转换的#defines）。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T17:06:54.403

我不知道 h2py，但你可能想看看 'ctypes' 和 'ctypeslib'。ctypes 包含在 python 2.5+ 中，旨在创建与 c-structs 的二进制兼容性。

如果你添加 ctypeslib，你会得到一个名为 codegen 的子工具，它有一个“h2xml.py”脚本和一个“xml2py.py”，它们的组合将自动从 C++ 生成你正在寻找的 python 代码标题。

ctypeslib：[http ://pypi.python.org/pypi/ctypeslib/0.5.4a](http://pypi.python.org/pypi/ctypeslib/0.5.4a)

h2xml.py 将需要另一个名为 gccxml 的工具：[http ://www.gccxml.org/HTML/Index.html](http://www.gccxml.org/HTML/Index.html)

最好检查（通过 CVS）最新版本的 gccxml 并自己构建它（实际上做起来比说的容易）。预打包的版本是旧的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T13:39:54.430

刚刚找到[pycparser](https://pypi.org/project/pycparser/)。可能有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T16:18:18.650

据我所知，h2py.py 不打算转换除#define 宏以外的任何东西。我确实遇到了[cppheaderparser](http://sourceforge.net/projects/cppheaderparser/)，这可能值得一看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T16:19:19.477

您从哪里得到 h2py 与结构或枚举有任何关系的想法？

从源头

```
# Read #define's and translate to Python code.
# Handle #include statements.
# Handle #define macros with one argument. 
```

'enum' 和 'struct' 这两个词永远不会出现在模块中。

# crystal-reports - Crystal Reports 公式：获取小数和非小数部分

> ID：374226
> 
> 赞同：3
> 
> 时间：2008-12-17T10:57:20.640
> 
> 标签：crystal-reports

例如，我的值为 103.33，我想将 100 放入一个变量，将 33 放入另一个变量。我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T11:47:50.553

创建两个公式字段，例如整体部分和小数部分。

Wholepart 的公式是 trunc({yourfieldnamehere})，decimalpart 的公式是 {yourfieldnamehere} - trunc({yourfieldnamehere})

您在小数部分中获得的值将是小数部分；如果您知道它始终是 2 位小数，请乘以 100。如果它是可变的，您可以进行快速字符串转换，计算数字并乘以 10 的适当幂。

汉普克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T11:51:10.907

使用 trunc 得到整数部分，然后减去得到小数部分。通过 ToText 将小数部分转换为文本，然后在 "." 后面取 Split 函数。从小数部分

或者

使用 ToText 并使用 Split 函数来获取“。”之后和之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-19T02:22:51.770

您还可以使用“余数”功能查找小数点后的数字。例如，REMAINDER ({FIELD NAME},1) 应该给你 0.33

# crystal-reports - Crystal Reports：将空格附加到字符串

> ID：374229
> 
> 赞同：2
> 
> 时间：2008-12-17T11:00:22.990
> 
> 标签：crystal-reports

我的报告中有一个字段需要长度为 40。如果字符串不是那个长度，我需要附加一些空格。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T11:30:41.680

尝试一些类似的东西

if length({yourfieldname here}) < 40 then {yourfieldnamehere} + space(40 - length({yourfieldnamehere})) 否则 {yourfieldnamehere}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T14:46:48.843

将 40 个空格附加到变量并获取结果字符串的前 40 个字符。

就像是

```
mid( (yourfield + space(40)), 1, 40) 
```

应该管用。

# css - 让 unitpngfix 工作

> ID：374238
> 
> 赞同：1
> 
> 时间：2008-12-17T11:04:47.130
> 
> 标签：css, internet-explorer, png

我正在尝试让 unitpngfix 工作，但我似乎无法让 png 显示在 IE6 中。

这是我的代码：

```
<html>
  <head>
    <style type="text/css">
      #boxouter {
        width: 12em;
        height: 12em;
        background: url(gradient.gif) #ffdf00 bottom repeat-x;
        position: relative;
        }
      #boxinnerbr {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 16px;
        height: 16px;
        background: url(corner.png);
        }      
    </style>
    <!--[if lt IE 7]>
            <script type="text/javascript" src="unitpngfix.js"></script>
    <![endif]-->
  </head>

  <body>
    <div id="boxouter">
      <div id="boxinnerbr"></div>
    </div>
  </body>
</html> 
```

我在正确的位置有 clear.gif 并正确链接等，所以我无法理解为什么它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T11:41:50.457

我也遇到了 unitpngfix 的一些问题，我真的不喜欢使用 [if lt IE 7] 和在 html 中嵌入样式。我发现[这个](http://jquery.andreaseberhard.de/pngFix/)jQuery 插件非常不显眼，并且适用于 IE6 中的 PNG 图像和 css 背景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T15:14:01.760

不是您问题的直接答案，但您可能想查看[DD_belatedPNG](http://www.dillerdesign.com/experiment/DD_belatedPNG/)。在我看来，这是最好的 PNG 修复程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T13:09:11.513

两件事 1\. 你没有 clear.gif 文件或 2\. 如果你有它打开 unitpngfix.js 文件并检查第一行中设置的路径是否正确

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-12-26T23:12:12.830

尝试

```
background-image: url(corner.png); 
```

# python - 如何使用 cElementTree 检索父节点？

> ID：374245
> 
> 赞同：9
> 
> 时间：2008-12-17T11:11:33.903
> 
> 标签：python, celementtree

对于 xml

```
<grandparent>
  <parent1>
     <child>data1</child>
  </parent1>
  <parent2>
     <child>data2</child>
  </parent2>
</grandparent> 
```

我需要包含父元组的列表，xml 中每个父级的数据。

有没有办法使用 cElementTree 做到这一点？我可以为孩子、数据做这件事，但不幸的是孩子在所有值上都是相同的，因此它没有多大用处。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T13:46:40.533

看来您可以使用 ElementTree 1.3 版（检查[http://effbot.org/zone/element-xpath.htm](http://effbot.org/zone/element-xpath.htm)）从子级访问父级，通过使用 xpath 命令，如 `child.find('../parent')`. 但我认为 python 附带 1.2 版或其他版本。

您还应该检查与 etree 兼容并具有完整 Xpath 支持的 lxml [http://lxml.de/](http://lxml.de/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-21T15:39:38.090

```
parent_map = dict((c, p) for p in tree.getiterator() for c in p)
parent_map[el].remove(el) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-05T19:20:56.740

这种语法似乎适用于 cElementTree

```
ET.fromstring("<c><a><b></b></a></c>").find('.//b/..') 
```

不去基父，并在路径中使用双斜杠然后单斜杠。
（会作为评论发布到上述线程，但似乎我没有特权）

# c# - 在不影响现有客户端的情况下扩展 WebService - 从查询返回派生类型

> ID：374253
> 
> 赞同：1
> 
> 时间：2008-12-17T11:16:29.213
> 
> 标签：c#, .net, wcf

如果我有网络服务方法，例如

```
 [WebMethod]
    [XmlInclude(typeof(SportsCar)), XmlInclude(typeof(FamilyCar))]
    public Car[] GetCars()
    {
        Car[] cars = new Car[2];
        cars[0] = new FamilyCar();
        cars[1] = new SportsCar();
        return cars;
    } 
```

如果我想向我的服务添加新的汽车类型，我必须向 Web 方法添加一个新的 XmlInclude 属性。不幸的是，客户端（AFAIK）现在需要更新他们的 Web 服务引用、重建和重新部署。否则他们会得到一个 XML 文档生成错误。

有什么策略可以解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T13:09:24.913

如果您的客户还不能理解不同的汽车，也许最可靠的选择是将其视为封闭，并添加一个单独的方法：

```
[...attributes...]
public Car[] GetCars2() 
```

即只有新`GetCars2`方法的调用者才能看到`SportsCar`结果。将这一点发挥到极致，您可以拥有一个 v2 端点，并保持原始 v1 不变。然后，您可以随时将客户端迁移到新的 API。

# vb.net - 每个文件是否有推荐的代码行数？

> ID：374262
> 
> 赞同：8
> 
> 时间：2008-12-17T11:23:04.347
> 
> 标签：vb.net, visual-studio

我有一个类文件，其中包含某个 Web 应用程序所需的所有类。目前我在第 7269 行，它包含许多类。我并不特别担心，但我开始注意到在处理此文件时 Visual Studio 响应较慢。我在想这可能是由于文件的大小和每次按下回车键后 Visual Studio 的重新编译造成的。

有没有人对每个文件的每个文件的类的行数有任何建议，或者关于如何/为什么将类移动到单独的文件中的指导方针？

我发现这是关于 Java 的，但我特别关注 VB 和 Visual Studio 2005

[Java 类中允许的最大代码行数？](https://stackoverflow.com/questions/107855/is-there-any-no-of-lines-code-limit-for-a-java-class)

谢谢

编辑文件中有大约 50 多个类，有些很小，有些很大！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-17T11:28:16.863

埃加德。

几乎每个人都强烈建议将类包含在每个类的文件中。

线条不是很直接相关，但它可能表明您正在创建一个过于复杂的上帝类并且需要分解逻辑。单元测试驱动的开发在正确完成时会强制执行此操作。

**编辑（注意到“为什么？”）：**

从您要问的事实来看，这应该很明显:)

几个（有很多原因）：

*   很难在大文件中可视化实际的代码布局

*   大多数 IDE 默认设置为一次显示多个文件，但不是同一文件的多个视图

*   对单个文件的源代码控制可能是个问题：“您能签入 {godfile} 以便我可以处理该项目吗？”

*   将代码分段到命名空间/包/分支是一个问题

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-17T11:33:57.383

每个文件一个顶级类型是常规的 -​​ 虽然嵌套类型是可以的，但不要过火。有一些例外——如果我需要声明多个委托，我通常会将它们全部放在一个文件中（例如 C# 的 Delegates.cs）——这很有意义，因为基本上每个委托类型只包含一个方法签名。有些人对枚举也这样做，尽管我不喜欢这样做。

这使您的代码更易于导航、更快地编译，并更轻松地显示源代码控制中的更改。

除此之外——我开始担心一个类是否有超过 1000 行代码而没有一个*很好*的理由。可能有很好的理由，但你至少应该看看这个类是否有太多的责任。之前我已经看到了涵盖足够功能的类以值得拥有自己的*命名空间*（有适当数量的小类提供所需的功能）......

从这个问题中不清楚你的任何一个单独的类是否有那么大，但是将这些类分成“每个文件一个”至少应该有助于开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T17:53:49.347

每个文件一个类。我尽量不让每个文件超过 200 行（不包括注释），但它确实发生了。

重构，重构，重构！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T11:35:54.353

1类，1个文件，anakata是绝对正确的。

在某些情况下，您可能会考虑使用分部类将它们拆分到不同的文件中。

只有一个非常大的文件......在团队中工作一定是一场噩梦，你们是怎么做到的？我猜没有源代码控制，您需要进行的每项更改都必须将其复制到项目的部署副本中。

那是一场等待发生的灾难。想象一下，如果一个文件被损坏了？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T12:08:19.670

如果 ASP.NET 页面有点复杂或太大，Visual Studio 2008 会出现一些性能问题。幸运的是，这个问题有一个官方的修复程序。由于 Visual Studio 2008 变得更快，安装此修补程序确实对我有很大帮助，所以我建议尝试一下：

[https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=10826](https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=10826)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T17:58:18.607

像这里的几乎每个人一样，我建议你每个文件 1 个类。我总是试图保持清晰和分离概念，它自然倾向于低于 600 行代码。

我正在按命名空间进行单元测试，我的文件超过了 3k-4k 的代码。现在，我已将它们拆分为多个文件。如果您有 ReSharper 之类的插件（ReSharper 超过 2k 行会减慢 VS），维护起来会更容易，而且速度会更快。

# c++ - 将应用程序从 Solaris 移植到 Linux

> ID：374263
> 
> 赞同：5
> 
> 时间：2008-12-17T11:23:16.530
> 
> 标签：c++, linux, solaris, porting

我将承担将相当大的 C++ 网络应用程序代码库从 Solaris 移植到 Linux 平台的任务。该代码还使用 ACE 等第三方库。最初编写的应用程序没有计划在将来进行可能的移植。

我想就如何完成这项任务获得一些建议和建议。最好的方法是什么。

-帕布。小号

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-17T11:49:47.227

ACE 是一个优势，因为它是多平台的。您必须检查字体大小的使用位置和方式。如果使用了 ACE_* 基本类型，那么您会遇到连胜，因为它们是可移植的，否则我将首先将 Solaris 版本更改为使用多平台数据类型和元素（使用 ACE 工具，因为您已经有了它）。

如果您使用任何 Solaris 唯一的外部库，则必须在 linux 中找到一个等效的库并编写一个包装器，以便应用程序的其余部分不需要知道正在使用什么实现。

之后，只需一个代码库就可以直接迁移到 linux。您应该完全编译和测试它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T11:53:51.180

**“没有可移植的应用程序，只有被移植的应用程序”**

如果可以的话，首先在两个平台上使用相同的工具。IE 如果 Solaris 版本没有更改为使用 GCC 和 GNU make 等，我建议您先更改它并让 Solaris 构建工作。您会发现您将首先修复编译器问题，而不是在尝试移植应用程序的同时尝试在 Linux 上修复它们。

其次，确保您可以在每个平台上以相同的版本获得所有相同的库。我认为您可以获得适用于 Linux 的 ACE。确保该版本的库可以在 Solaris 上运行。这将限制兼容性问题。

一旦你做到了，那么真正的工作就开始了。

You will need to compile each source file one at a time and find the functions that are not available in Linux. First look for a replacement that is available in both OSs. If there is no simple replacement then create two libraries one for Solaris and one for Linux. Create wrapper classes or functions to abstract the incompatibilities away.

If this sounds like a lot of work - it is.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-24T17:44:43.133

I'm in agreement with what David Allan Finch wrote. Take the port one step at a time. In addition:

Are you coming from Solaris/SPARC or Solaris x86? If it's x86, you'll have no endian issues, but if it's SPARC, you'll need to examine your code to make sure that there are no byte-order (endian) issues.

Is the Solaris code 32-bit or 64-bit? Certainly keep the address space the same initially.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T11:51:50.483

列出您当前的外部依赖项是什么。找出在 Linux 上可用的这些。对于那些不是，你必须找到一个替代品。如果对这些外部依赖项的引用没有在函数或对象后面抽象出来，请重构代码，使其如此。然后替换依赖关系，这样就可以用替换实现抽象函数。

# c# - 使用 Linq to Entities 的“包含（）”解决方法？

> ID：374267
> 
> 赞同：87
> 
> 时间：2008-12-17T11:24:20.400
> 
> 标签：c#, linq, entity-framework, .net-3.5, linq-to-entities

我正在尝试使用 Silverlight ADO.Net 数据服务客户端 api（以及因此 Linq To Entities）创建一个查询，该查询在 where 子句中使用 id 列表。有谁知道不支持包含的解决方法？

我想做这样的事情：

```
List<long?> txnIds = new List<long?>();
// Fill list 

var q = from t in svc.OpenTransaction
        where txnIds.Contains(t.OpenTransactionId)
        select t; 
```

* * *

试过这个：

```
var q = from t in svc.OpenTransaction
where txnIds.Any<long>(tt => tt == t.OpenTransactionId)
select t; 
```

但是得到“不支持方法'Any'”。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-07-01T15:29:11.053

**更新：** EF ≥ 4[`Contains`](http://msdn.microsoft.com/en-us/library/bb352880.aspx "Enumerable.Contains<T>")直接支持 (Checkout [`Any`](http://msdn.microsoft.com/en-us/library/bb534972.aspx "可枚举的.Any<T>"))，因此您不需要任何解决方法。

```
public static IQueryable<TEntity> WhereIn<TEntity, TValue>
  (
    this ObjectQuery<TEntity> query,
    Expression<Func<TEntity, TValue>> selector,
    IEnumerable<TValue> collection
  )
{
  if (selector == null) throw new ArgumentNullException("selector");
  if (collection == null) throw new ArgumentNullException("collection");
  if (!collection.Any()) 
    return query.Where(t => false);

  ParameterExpression p = selector.Parameters.Single();

  IEnumerable<Expression> equals = collection.Select(value =>
     (Expression)Expression.Equal(selector.Body,
          Expression.Constant(value, typeof(TValue))));

  Expression body = equals.Aggregate((accumulate, equal) =>
      Expression.Or(accumulate, equal));

  return query.Where(Expression.Lambda<Func<TEntity, bool>>(body, p));
}

//Optional - to allow static collection:
public static IQueryable<TEntity> WhereIn<TEntity, TValue>
  (
    this ObjectQuery<TEntity> query,
    Expression<Func<TEntity, TValue>> selector,
    params TValue[] collection
  )
{
  return WhereIn(query, selector, (IEnumerable<TValue>)collection);
} 
```

用法：

```
public static void Main()
{
  using (MyObjectContext context = new MyObjectContext())
  {
    //Using method 1 - collection provided as collection
    var contacts1 =
      context.Contacts.WhereIn(c => c.Name, GetContactNames());

    //Using method 2 - collection provided statically
    var contacts2 = context.Contacts.WhereIn(c => c.Name,
      "Contact1",
      "Contact2",
      "Contact3",
      "Contact4"
      );
  }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-01T06:03:57.707

您可以手动编写一些 e-sql 代码（注意关键字“it”）：

```
return CurrentDataSource.Product.Where("it.ID IN {4,5,6}"); 
```

这是我用来从集合 YMMV 生成一些 e-sql 的代码：

```
string[] ids = orders.Select(x=>x.ProductID.ToString()).ToArray();
return CurrentDataSource.Products.Where("it.ID IN {" + string.Join(",", ids) + "}"); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-17T14:31:22.347

来自[MSDN](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/095745fe-dcf0-4142-b684-b7e4a1ab59f0/)：

```
static Expression<Func<TElement, bool>> BuildContainsExpression<TElement, TValue>(
    Expression<Func<TElement, TValue>> valueSelector, IEnumerable<TValue> values)
{
    if (null == valueSelector) { throw new ArgumentNullException("valueSelector"); }
    if (null == values) { throw new ArgumentNullException("values"); }
    ParameterExpression p = valueSelector.Parameters.Single();

    // p => valueSelector(p) == values[0] || valueSelector(p) == ...
    if (!values.Any())
    {
        return e => false;
    }

    var equals = values.Select(
             value => (Expression)Expression.Equal(valueSelector.Body, Expression.Constant(value, typeof(TValue))));

    var body = equals.Aggregate<Expression>((accumulate, equal) => Expression.Or(accumulate, equal));

    return Expression.Lambda<Func<TElement, bool>>(body, p);
} 
```

查询变为：

```
var query2 = context.Entities.Where(BuildContainsExpression<Entity, int>(e => e.ID, ids)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T11:41:59.130

我不确定 Silverligth，但在 linq to objects 中，我总是使用 any() 进行这些查询。

```
var q = from t in svc.OpenTranaction
        where txnIds.Any(t.OpenTransactionId)
        select t; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-23T09:28:12.907

为了完成记录，这是我最后使用的代码（为清楚起见省略了错误检查）......

```
// How the function is called
var q = (from t in svc.OpenTransaction.Expand("Currency,LineItem")
         select t)
         .Where(BuildContainsExpression<OpenTransaction, long>(tt => tt.OpenTransactionId, txnIds));

 // The function to build the contains expression
   static System.Linq.Expressions.Expression<Func<TElement, bool>> BuildContainsExpression<TElement, TValue>(
                System.Linq.Expressions.Expression<Func<TElement, TValue>> valueSelector, 
                IEnumerable<TValue> values)
        {
            if (null == valueSelector) { throw new ArgumentNullException("valueSelector"); }
            if (null == values) { throw new ArgumentNullException("values"); }
            System.Linq.Expressions.ParameterExpression p = valueSelector.Parameters.Single();

            // p => valueSelector(p) == values[0] || valueSelector(p) == ...
            if (!values.Any())
            {
                return e => false;
            }

            var equals = values.Select(value => (System.Linq.Expressions.Expression)System.Linq.Expressions.Expression.Equal(valueSelector.Body, System.Linq.Expressions.Expression.Constant(value, typeof(TValue))));
            var body = equals.Aggregate<System.Linq.Expressions.Expression>((accumulate, equal) => System.Linq.Expressions.Expression.Or(accumulate, equal));
            return System.Linq.Expressions.Expression.Lambda<Func<TElement, bool>>(body, p);
        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-24T22:44:00.627

这是一个示例，我演示了如何使用 DataServiceContext 编写基于集合的查询：http: [//blogs.msdn.com/phaniraj/archive/2008/07/17/set-based-operations-in-ado-net-data -services.aspx](http://blogs.msdn.com/phaniraj/archive/2008/07/17/set-based-operations-in-ado-net-data-services.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-23T14:39:32.347

非常感谢。WhereIn 扩展方法对我来说已经足够了。我对其进行了分析，并为数据库生成了与 e-sql 相同的 SQL 命令。

```
public Estado[] GetSomeOtherMore(int[] values)
{
    var result = _context.Estados.WhereIn(args => args.Id, values) ;
    return result.ToArray();
} 
```

生成了这个：

```
SELECT 
[Extent1].[intIdFRLEstado] AS [intIdFRLEstado], 
[Extent1].[varDescripcion] AS [varDescripcion]
FROM [dbo].[PVN_FRLEstados] AS [Extent1]
WHERE (2 = [Extent1].[intIdFRLEstado]) OR (4 = [Extent1].[intIdFRLEstado]) OR (8 = [Extent1].[intIdFRLEstado]) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-26T08:31:51.883

我认为 LINQ 中的加入可以是一种解决方法。

我还没有测试过代码。希望能帮助到你。干杯。:-)

```
List<long?> txnIds = new List<long?>();
// Fill list 

var q = from t in svc.OpenTransaction
        join tID in txtIds on t equals tID
        select t; 
```

加入 LINQ：

[http://weblogs.asp.net/salimfayad/archive/2008/07/09/linq-to-entities-join-queries.aspx](http://weblogs.asp.net/salimfayad/archive/2008/07/09/linq-to-entities-join-queries.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-30T04:51:05.513

抱歉新用户，我会评论实际答案，但似乎我还不能这样做？

无论如何，关于 BuildContainsExpression() 示例代码的答案，请注意，如果您在数据库实体（即不是内存中的对象）上使用该方法并且您使用的是 IQueryable，那么它实际上必须转到数据库因为它基本上做了很多 SQL“或”条件来检查“where in”子句（用 SQL Profiler 运行它来查看）。

这可能意味着，如果您正在使用多个 BuildContainsExpression() 优化 IQueryable，它不会将其转换为一个 SQL 语句，该语句最终会按照您的预期运行。

我们的解决方法是使用多个 LINQ 连接将其保持在一个 SQL 调用中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-11T07:38:29.740

除了选择的答案。

替换为`Expression.Or`与`Expression.OrElse`Nhibernate 一起使用并修复`Unable to cast object of type 'NHibernate.Hql.Ast.HqlBitwiseOr' to type 'NHibernate.Hql.Ast.HqlBooleanExpression'`异常。

# web-services - 如何从 Exchange 收件箱返回用户的未读邮件计数？

> ID：374268
> 
> 赞同：2
> 
> 时间：2008-12-17T11:24:21.227
> 
> 标签：web-services, exchange-server, portal, outlook-web-app

我正在为我们公司编写一个小的内部 SharePoint 门户。我认为创建一个显示用户未读邮件计数的 Web 部件以及可能的今天日历任务列表将是一个“速赢”。但是，我一直在寻找与 OWA Web 服务相关的信息，但我认为没有简单的方法可以做到这一点。

我是不是很傻，你能打个简单的电话吗？如果不是，我的第一步是为了实现我想要的？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T12:18:53.300

几个月前，我使用 CDO 库和 C# .NET Windows Service 完成了这项工作。示例代码是这样的

```
 MAPI.Folder inboxFolder = Inbox;
            MAPI.Messages messages = (Messages) inboxFolder.Messages;
            MAPI.MessageFilter filter = (MessageFilter) messages.Filter;
            filter.Unread = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T21:12:25.260

如果他们使用 Exchange 2007，您可以使用 Exchange Web 服务来查询收件箱。

这是 MSDN 中的参考资料。FindFolder 操作将返回文件夹的未读计数。 [http://msdn.microsoft.com/en-us/library/bb204119.aspx](http://msdn.microsoft.com/en-us/library/bb204119.aspx)

Visual Studio 可以为您生成代理类以帮助您入门：http: [//msdn.microsoft.com/en-us/library/bb408522.aspx](http://msdn.microsoft.com/en-us/library/bb408522.aspx)

# java - 如何将不同的 Java-Bean 结构相互映射

> ID：374302
> 
> 赞同：6
> 
> 时间：2008-12-17T11:43:49.157
> 
> 标签：java, mapping, javabeans

在我们的项目中，我们必须将一个嵌套的 bean 结构映射到另一个。（这些实际上是 JAXB 映射的 XML 文档的 Java 表示，例如，表示传入的订单文档。）这必须映射到另一个系统的完全不同的订单文档结构。

有哪些选项可以做到这一点？我更喜欢满足以下要求的东西：

1.  当未定义一个字段的映射时，映射应该提醒我
2.  映射应该有一些默认值，例如将相同名称的字段映射到另一个字段，并为例如 int 到 String 提供标准映射，反之亦然。
3.  映射应该是双向的。
4.  在定义映射时应该能够使用代码完成。

一个有前途的框架是[Dozer](http://dozer.sourceforge.net/)，但它不满足 1 和 4。与[JBeanMapper](http://jbeanmapper.sourceforge.net/)相同。只需用 Java 编程就可以满足 4 个要求，但没有其他要求；使用 XSLT 可能满足 2，但仅此而已。你有更好的想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-06-24T05:54:04.110

[ModelMapper](http://modelmapper.org)是一个满足您所有条件的库。它提供了一个映射 API，该 API 使用实际代码来映射属性——因此您可以完成代码。它提供验证以确保映射所有目标属性。此外，它还提供了一些您甚至不知道自己想要的东西，例如智能地图 :)

查看 ModelMapper 主页了解更多信息：

[http://modelmapper.org](http://modelmapper.org)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-07T19:04:08.353

另一种选择是[MapStruct](http://mapstruct.org/)，它在构建时生成映射代码，从而产生在运行时不需要任何依赖项的类型安全映射（免责声明：我是 MapStruct 的作者）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T11:58:07.180

当我们遇到这个问题时，我们最终在一个实用程序类中使用 Java 进行字段映射。这是一个真正的麻烦，尤其是当您必须映射到几个不同的 Web 服务并且必须为每个服务编写映射时（其中一些是命名属性的简单 2D 映射，而不是对象的层次结构，*cries*）。

但是，通过这种方式，您确实有能力分析映射目标的要求以获得最佳质量映射，在未设置数据的情况下设置默认值，等等。您可以在需要的映射器中抛出自定义“UndefinedMappingException”。而且由于不是一个使用反射和/或复杂的 XML 映射配置文件的蓬松库，它的速度更快。

即，这是主张“用Java 编写”的帖子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T12:07:58.830

[我用commons-beanutils](http://commons.apache.org/beanutils/)解决了一个类似的问题。

我的最终目标是一个大的 Java 文件，它将构建数据结构，映射器为我创建了该文件。这样，我可以从程序运行时创建的快照创建测试数据。

映射器允许定义用于对对象进行排序的键、用于在 Java 文件中生成对象名称的字段，并且我使用了一个以“class:field”作为键的映射。该值是一个实现简单“映射”接口的对象（一种方法：toJava(Object instance, String field, Object value)）。

我的主要问题是编译 2MB+ Java 文件 :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-18T21:35:12.297

Transmorph、EZMorph、Dozer、OTOM 是其中的一些，您可以查看 Bean 到 Bean 映射。我过去使用过 Dozer，感觉多年来它已经变得相当稳定。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-02T09:16:43.967

看看 GeDA，它使用字节码在运行时创建映射类，这使得它非常快[http://genericdtoassembler.org/](http://genericdtoassembler.org/)。它将涵盖第 1-3 点。关于第 4 点，我想这是一个 IDE 的东西，所以我认为除非它有 IDE 插件，否则我认为你不会找到任何可以促进这一点的库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-06T11:31:28.780

如果您正在映射具有许多略有不同变体的数据结构，有一个有趣的解决方案可能会对您有所帮助。例如，如果您正在为不同的业务案例和产品变体建模业务订单结构，并且不同的变体需要相同属性的不同组合，例如地址、帐户 ID、产品的配置信息等。

因此，您有许多结构相似的 bean，它们包含许多属性的不同子集。如果您不想为每个单独的变体编写代码，则可以引入一个 Java 接口，该接口具有这些 bean 中出现的所有属性，并使用[java.lang.reflect.Proxy](http://download.oracle.com/javase/6/docs/api/java/lang/reflect/Proxy.html)为要映射的 bean 构造代理实例, 如果在实际 bean 上调用不存在的 setter，则实际 bean 没有的 getter 返回 null / 抛出异常。从某种意义上说，您将接口注入到那些方法比 bean 本身更多的 bean 中。

# c++ - TiXmlElement* 的 Getter 和 setter 包装器

> ID：374303
> 
> 赞同：1
> 
> 时间：2008-12-17T11:44:11.280
> 
> 标签：c++, tinyxml

我正在重写一个项目，以便它使用 getter 和 setter 来引用 TiXmlElement *'s 但是，我很快遇到了似乎与调试模式有关的问题：

摘自我班的标题：

```
TiXmlElement *_rootElement;
TiXmlElement *_dialogsElement;
TiXmlElement *_dialogElement;
TiXmlDocument _document;
void setDocument (TiXmlDocument doc) { this->_document = doc; }
void setRootElement (TiXmlElement * element) { this->_rootElement = element; }
void setDialogsElement (TiXmlElement * element) { this->_dialogsElement = element; }

TiXmlDocument getDocument () { return this->_document; }
TiXmlElement* getRootElement () { return this->_rootElement; }
TiXmlElement* getDialogsElement () { return this->_dialogsElement; } 
```

类构造函数的摘录：

```
DCXML::DCXML(const char *dialogMark,const char *dialogName,TiXmlDocument doc) {
...
this->setDocument(doc);
this->setRootElement(this->getDocument().FirstChildElement("dcxml"));
this->setDialogsElement(this->getRootElement()->FirstChildElement("dialogs")); 
```

实例化类的摘录：

```
TiXmlDocument doc(input.gettok(2,"\"").to_chr());
bool dcxmlFile = doc.LoadFile();
...
DCXML *dcxml = new DCXML(input.gettok(2).to_chr(),input.gettok(3).to_chr(),doc); 
```

现在是奇怪的部分。这工作直到

```
this->setDialogsElement(this->getRootElement()->FirstChildElement("dialogs")); 
```

在构造函数中。

->FirstChildElement("dialogs") 在调试模式下在 VS2008 中抛出“CXX0039: Error: symbol is ambiguous”错误。

奇怪的部分是 IntelliSense 采用了 FirstChildElement 方法，并且编译器不会抛出任何错误。

更奇怪的是，在发布模式下，它只是默默地无法获取对话框元素。

我做错了什么？或者，如果您已经成功地为 TiXmlElement* 实现了 getter setter 包装器，请告诉我该怎么做！

完整参考这里是 XML 文件的摘录：

```
<?xml version="1.0" encoding="utf-8"?>
<dcxml>
    <dialogs>
        <dialog 
            name="mediaplayer" 
            center="" 
            w="300" 
            h="400" 
            caption="Mamp 4.0 BETA" 
            border="btmnzy">
        </dialog>
    </dialogs>
</dcxml> 
```

反馈将不胜感激，因为我处于死胡同:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T12:04:16.183

确保

```
TiXmlDocument getDocument () { return this->_document; } 
```

不会深度复制其包含的 TiXmlElement。否则你返回一个临时的，在构造函数中使用它来设置根节点，然后它已经被破坏了。我没有查看它的 API，但请注意这些陷阱。

模棱两可的调用的原因是：

`FirstChildElement`采用一个参数有三种重载：

```
const TiXmlElement *    FirstChildElement (const char *value) const // :1
const TiXmlElement *    FirstChildElement (const std::string &_value) const // :2
TiXmlElement       *    FirstChildElement (const std::string &_value) // :3 
```

`TiXmlElement&`您通过（使用`TiXmlElement*`指针）访问 TiXmlElement 。但是采用 a 的版本`const char*`有一个隐含的对象参数`TiXmlElement const&`. 也就是说，需要进行资格转换才能使调用正常工作。对于采用 的其他版本`std::string const&`，也需要进行转换：

```
<implied obj param> <implicit obj param>    <arg1>         <param1>
TiXmlElement&        TiXmlElement const&    char const*    char const*         // :1
TiXmlElement&        TiXmlElement const&    char const*    std::string const&  // :2
TiXmlElement&        TiXmlElement&          char const*    std::string const&  // :3 
```

第一次和第三次过载之间存在歧义。一个简单的解决方法是

```
this->setDialogsElement(
    this->getRootElement()->FirstChildElement(std::string("dialogs"))); 
```

相反，它将调用最后一个版本。另一个修复是 const_cast：

```
this->setDialogsElement(
    const_cast<TiXmlElement const*>(this->getRootElement())->
        FirstChildElement("dialogs")); 
```

这将调用第一个版本。至于为什么它只发生在 DEBUG... 我记得 TiXML 有一个选项可以禁用 STL 的使用。也许在发布模式下你禁用了它（因此过载`std::string`），但在调试模式下你忘记了？

# delphi - 如何让 Delphi 2009 默认在第二个监视器中打开我的应用程序？

> ID：374304
> 
> 赞同：8
> 
> 时间：2008-12-17T11:46:15.300
> 
> 标签：delphi, delphi-2009, multiple-monitors

调试时，我总是希望 Delphi 在第二个监视器中打开我的应用程序，但它总是在第一个监视器中打开，我知道我可以在关闭之前保存应用程序放置，但我希望它在调试模式下始终在第二个监视器中打开。

有没有办法配置delphi 2009来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T11:51:02.123

Delphi没有他的功能。

我所做的是将代码添加到主窗体的 OnCreate 处理程序，如果 Delphi-Debugger 连接到应用程序，则将窗体移动到第二个监视器。

```
 if (DebugHook <> 0) and (Screen.MonitorCount > 1) then
    Left := Screen.Monitors[1].Left; 
```

# javascript - JavaScript/ CSS/ 图像参考路径

> ID：374305
> 
> 赞同：10
> 
> 时间：2008-12-17T11:46:43.910
> 
> 标签：javascript, css

我想知道是否有人喜欢在他们的网站中引用图像/ css 或 javascript 文件？

我问的原因是如果客户想要托管我们在虚拟目录下编写的站点，该站点通常必须更改它的文件引用 - 甚至可以更改为 CSS 文件中的 url（...图像路径），因为我们通常开发站点，就好像它是一个根应用程序一样 - 有时客户不知道他们将在哪里托管它，直到交付日期的前一天！

使用 ASP.NET，我们可以通过在使用 runat 服务器组件时使用“~”引用项目或在使用 ASP.NET MVC 时使用 Url.Content 方法来解决表单中的问题......

那么，是否有任何好的解决方案可以保持文件引用的通用性，或者我们是否每次都必须更改文件引用？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-17T11:51:56.600

**CSS 中的图像**（如 background-url）**总是相对于 css 文件引用。**

例子：

```
/img/a.gif
/css/c.css 
```

要从`a.gif`css 文件中引用，您必须始终像这样引用它`../img/a.gif`，与页面所在的位置或如何重写它无关

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-02T15:11:50.010

我喜欢将所有样式图像保存在样式表位置的子目录中，例如：

站点->样式->Common.css
站点->样式->图像->背景.png

通过这种方式，您可以缓解 CSS 中的“向上”目录令人困惑或需要轻松移动 CSS 的问题，因为它完全包含在单个目录中。

坦率地说，在拥有大量媒体的大型网站中，将风格图像和内容图像混合在一起可能会有点混乱。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-17T11:52:55.427

您仍然可以在“向上”导航中使用相对地址：

例如：`/styles/main.css`_`/images/bg.png`

```
background-image: url('../images/bg.png'); 
```

或`/path/to/this/page.html`为`/index.html`

```
<a href="../../../index.html">Home</a> 
```

它可能不是最吸引人的，但它应该有效。

# linux - 为什么您选择的论坛软件特别适合您？

> ID：374306
> 
> 赞同：1
> 
> 时间：2008-12-17T11:47:08.310
> 
> 标签：linux, apache, forum

作为另一个涉及编程的问题的一部分（我向你保证），有人建议我问一个社区 wiki 问题，为什么你选择的论坛软件对你来说是“最好的”。

我正在考虑提供论坛软件，作为为医疗支持小组量身定制的网络服务器和网络应用程序安装的一部分，我希望了解您接触过的任何论坛软件的所有优缺点。

它必须与 Linux 和 Apache 一起运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T11:55:54.673

[PHPBB](http://www.phpbb.com/)怎么样？非常容易设置和配置，并且可以从以前的 pbpbb 版本自动导入（比如从 v2 到 v3）

PHPBB 3 也有一个非常好的验证码系统，与 v2 不同。在 phpbb2 中，注册时使用验证码，我们每天有大约 600 个机器人自动注册。

当我们升级到 v3 时，我们没有机器人，我们仍然没有注册机器人（新论坛大约在 2 个月前部署，还没有机器人）......显然，他们改进了验证码图像。

我强烈推荐它。

顺便说一句，它是开源的，用 PHP 编写（呃！）。它还拥有一个广泛的社区，有大量可下载的主题和样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:08:49.197

Invision 电源板。

尤其是因为我设法继承了终身许可证：D

话虽如此，我发现它在使用和管理方面都是最直观的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T11:54:25.207

[JForum](http://jforum.net) - 易于使用、可维护且易于与其他 web 应用程序集成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T14:57:15.943

我的第一个建议是 Invision Power Board。我已经试用了一些开源软件，例如 PHPBB 和 SimpleMachines，它们运行良好，但由于它们没有商业支持，如果遇到它们，您可能无法快速解决任何电路板问题。我喜欢 IPB 的主要特点之一是其灵活的用户权限系统。很难描述，但基本上是基于权限掩码。您可以创建使用单个或多个掩码的组，并且每个成员可以属于单个或多个组。如果这还不够，您还可以指定每个人可以使用的权限掩码。当然，如果您不需要这种灵活性，您可以只使用默认情况下存在的基本组。IBP 虽然不是免费的，而且对于某些人来说可能被认为相当昂贵。

那时我获得了终身和永久许可证，当时他们拥有保证终身更新和支持的许可证。物有所值。

我可以推荐的另一个解决方案是 EllisLabs 的 ExpressionEngine。EE 是一种可扩展的内容管理，您可以以相当实惠的价格获得附加模块。这些官方插件之一是论坛模块。使用一个论坛许可证，您就可以创建多个论坛实例。您将能够使用主要 CMS 部分设置您的主站点，并围绕它建立您的论坛，如果您愿意，他们可以共享登录名/会员资格。我强烈推荐的另一个系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-20T22:35:36.123

我最喜欢的是[punbb](http://punbb.informer.com/)，主要是因为它轻量级且易于上手。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-24T11:19:15.267

我最喜欢的是简单机器论坛。易于设置、有用的社区和易于修改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-08T18:30:26.040

[FoFou](http://blog.kowalczyk.info/software/fofou/index.html)是我最喜欢的论坛软件，因为它使人们可以*轻松*发布问题和答案。

访问者不必在发表评论之前注册、填写一系列偏好并检查他们的电子邮件。FoFou 不会让他们做任何事情。**For** rums **For** You **u**专为托管开源软件的网站而设计，因此重点是鼓励可能只访问一两次的用户提交反馈并回答彼此的问题。FoFou 提供了一个漂亮的论坛的所有功能，没有令人困惑的花里胡哨。

FoFou 是开源的，易于设置并使用 Google 的 App 引擎，因此您可以自己托管或使用 Google 的免费云托管。

[从他们的宣言](http://blog.kowalczyk.info/software/fofou/manifesto.html)中了解更多信息。

# svn - SVN 错误 - 不是工作副本

> ID：374313
> 
> 赞同：222
> 
> 时间：2008-12-17T11:51:40.110
> 
> 标签：svn

最近我们的 svn 服务器发生了变化，我们做了一个 svn 切换。

由于工作副本有大量未版本化的资源，工作副本被锁定，我们开始为 svn 下的所有文件夹逐个文件夹切换，效果非常好。

但是在存储库的最顶层，当我尝试更新文件时，我得到*svn: Working copy '.' 锁定*错误和清理也无济于事。当我进行清理时，我会收到这样的错误 - *svn: 'content' is not a working copy directory*

新鲜结帐根本不是一种选择。还有其他方法可以清理和释放锁并完全切换吗？

**编辑：** JesperE 回答的最后一段

> 如果在执行递归“svn cleanup”时得到“不是工作副本”，我的猜测是你有一个应该是工作副本的目录（即顶层的 .svn 目录是这样说的），但它缺少它的自己的 .svn 目录。在这种情况下，您可以尝试仅删除/移动该目录，然后进行本地更新

似乎是存储库中问题的解决方案。我已经确定了这些文件夹并单独对这些特定文件夹进行了新的检查，哇，锁定在随后的清理中被释放！非常感谢杰斯珀！

但是，我仍然无法弄清楚现在看起来像这样的 svn 开关错误，

> svn：'svn://repourl/reponame/foldername' 的存储库有 uuid 'm/reponame'，但 WC 有 'b5b39681-0ff6-784b-ad26-2846b9ea8e7d'

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2008-12-17T11:59:04.120

如果您在执行递归时得到“不是工作副本”，`svn cleanup`我的猜测是您有一个应该是工作副本的`.svn`目录（即顶层目录是这样说的），但它缺少自己的`.svn`目录。在这种情况下，您可以尝试仅删除/移动该目录，然后进行本地更新（即`rm -rf content; svn checkout content`）。

如果出现`not a working copy`错误，则意味着 Subversion 无法`.svn`在其中找到合适的目录。检查是否有`.svn`目录`contents`

如果可能的话，理想的解决方案是重新结帐。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-06-01T21:16:27.260

我`svn: 'papers' is not a working copy directory`以不同的方式遇到了类似的情况（），所以我想我会发布我的战斗故事（简化）：

```
$ svn add papers
svn: Can't create directory 'papers/.svn': Permission denied 
```

哎呀！修复权限...然后：

```
$ svn add papers
svn: warning: 'papers' is already under version control
$ svn st
~     papers
$ svn cleanup
svn: 'papers' is not a working copy directory 
```

甚至移开`papers`并运行`svn up`（这对 OP 有效）并没有解决它。这是我所做的：

```
$ mv papers papers_
$ svn cleanup
$ svn revert papers
Reverted 'papers'
$ mv papers_/ papers
$ svn add papers 
```

那行得通。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-01-20T15:11:41.877

我解决了

1.  复制受影响文件夹的备份
2.  SVN 还原受影响的文件夹
3.  从备份中将文件粘贴回来

就我而言，问题是由于删除了 .svn 文件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-08T09:50:19.837

也许您只是复制了文件夹树并尝试添加最低的一个。

```
SVN
|_
  |
  subfolder1
       |
       subfolder2   (here you get an error) 
```

在这种情况下，您必须在上层提交目录。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-17T13:21:49.867

解决方法：重命名不是“工作副本”的目录再次签出/更新/恢复此目录将文件从重命名的目录移动到新的提交更改

原因：您对 .svn 目录下的某些文件进行了一些更改，这会破坏“工作副本”

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-12-28T02:40:24.877

如果你在一个新目录中创建了一个文件，而不是 'svn add newdir/newfile' 使用 'svn add newdir' 因为你需要添加目录。默认情况下会添加目录中的所有文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-01T13:08:05.637

我刚得到“不是工作副本”，对我来说原因是 Unix 上的 Automouter。只需一个新的“cd /path/to/work/directory”就可以了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-06T16:20:08.283

同样，我需要更新一个“contrib”文件夹：

1.  将旧文件夹移出，
2.  复制了新的
3.  将 .svn 文件夹复制到每个（在我的情况下只有三个）新文件夹中。

我也是我的情况，问题是由于删除了 .svn 文件夹。

解决了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-05T13:52:51.123

我尝试将 .svn 文件夹从子文件夹粘贴到根文件夹。有用！！！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-05T10:14:17.260

这就是我所做的：

1.  将中继重命名为中继_
2.  创建一个新的文件夹trunk
3.  检出几个文件后重新检出并中断该过程
4.  将文件从trunk_移动到trunk
5.  做svn清理
6.  做svn更新。这将更新文件的状态，然后您的所有文件都将被版本化。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-05-20T07:36:28.283

我在svn diff操作中也遇到了这个问题，是文件路径不正确造成的，要加上`'./'`指明当前文件目录。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-09-08T09:53:48.240

尝试从大型 svn 项目中检查部分源时遇到相同的错误

```
svn co --depth empty svn://tug.org/texlive/trunk/Build
cd Build
svn update --set-depth infinity --parents ./source/texk/web2c 
```

这里**--parents**是成功的关键

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-17T12:22:09.143

> svn：'svn://repourl/reponame/foldername' 的存储库有 uuid 'm/reponame'，但 WC 有 'b5b39681-0ff6-784b-ad26-2846b9ea8e7d'

每个 subversion repo 都有一个唯一的标识符 (uuid)。Subversion 使用它来确保 repo 在执行切换等操作时实际上是相同的。您可能应该将服务器上的 uuid 更改为与以前相同。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-17T12:27:00.287

会不会是工作副本格式不匹配？它在 svn 1.4 和 1.5 之间发生了变化，更新的工具会自动转换格式，但旧的工具不再适用于转换后的副本。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-17T12:57:36.653

您必须从项目中删除了一个 SVN - 基础文件（它们是只读文件）。因此，您会收到此错误。

再次签出一个新项目，使用“Winmerge”将旧 SVN 项目的更改（如果有）与新项目合并，并在最新签出时提交更改。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-28T09:29:10.170

@JesperE[提到](https://stackoverflow.com/questions/374313/svn-error-not-a-working-copy/374382#374382)您需要更改 uuid。以下内容应该可以帮助您实现这一目标。

在 SVN 1.5+ 上，您可以执行 svnadmin setuuid；然后您可以使用 svnlook uuid 检查它是否已正确设置。在早期版本的 SVN 上，这是一个更难的过程。请参阅[http://chestofbooks.com/computers/revision-control/subversion-svn/Managing-Repository-UUIDs-Reposadmin-Maint-Uuids.html](http://chestofbooks.com/computers/revision-control/subversion-svn/Managing-Repository-UUIDs-Reposadmin-Maint-Uuids.html)

此外，“m/reponame”的 UUID 看起来很可疑。我相信它应该是一个十六进制格式的数字，就像工作副本的一样，所以也许这个动作会全面改善:-)

[我最初评论了[@JesperE 的答案](https://stackoverflow.com/questions/374313/svn-error-not-a-working-copy/374382#374382)，但创建了这个答案是为了让它对人们更明显，对谷歌更有帮助。我已经删除了我的评论。]

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-06-04T09:16:02.617

有同样的问题，原来我们在同一台机器上安装了 Slik 1.6.2 和 Tortoise。Tortoise 已更新（并已更新工作副本）但 Slik 没有，因此 Tortoise 工作正常，但命令行失败：

> svn：'。' 不是工作副本目录

删除 Tortoise 和 Slik，然后重新安装 Tortoise 并启用命令行工具为我解决了这个问题。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-07-16T09:44:52.113

对于 mac：- 从服务器端结帐，然后将打开一个新窗口以从本地计算机中选择目录，而不是将所有代码放在选定的文件夹中，然后打开 svn 本地端并添加并提交项目

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-11-17T07:31:09.127

今天早上我发现了同样的问题**`/FILE_NAME/ is not a working copy`**，我花了两个多小时来解决它。经过长时间的 RND 和谷歌，我找到了一些解决方案，那就是`CHECKOUT`.

1.  `CHECKOUT`从`SUBVERSION`本地作为新项目。
2.  更改 java 文件中的一些代码并提交项目。
3.  这对我有用。

希望对您有所帮助。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-06-25T11:28:22.393

最近我在使用其他开发者的 Mac 我遇到了同样的情况，问题是；首先我需要输入 get repo path to terminal 但我没有，它会显示您的用户名和密码是什么。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-10-08T15:44:12.117

我刚刚遇到了 .svn 目录位于另一台机器上的 nfs 服务器上的情况，并且 nfs 客户端没有运行文件锁定服务 ( `lockd`)。

```
svn: E155007: '/mnt/svnworkdir' is not a working copy 
```

`lockd`一旦在 nfs 客户端主机上启动，这种情况就消失了。

似乎 subversion 在锁定文件时遇到问题时可能会提供更好的错误消息。这是颠覆 1.10.0

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-09-17T08:23:56.677

我从同一个项目进行了新的结帐到不同的位置，然后从中复制了 .svn 文件夹并替换为我的旧 .svn 文件夹。之后调用 svn update 函数，一切都正确同步到最新状态。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-11-26T15:43:47.057

我有这个确切的错误。我注意到我在错误的目录中。一旦我恢复到 SVN Trunk 目录，问题就解决了。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2022-02-07T17:40:07.237

我在我的代码上执行 mvn release:prepare 时看到了这个错误。就我而言，我已经将项目从 SVN 迁移到 Github，并从 Github 克隆了源代码。但是在我的 pom.xml 文件中，我错过了将 SCM 位置从 SVN URL 更新到 Github URL，这导致工作目录之间的不匹配。

将 URL 更正到 Github 位置帮助我解决了这个问题。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2016-08-08T11:04:03.953

删除本地计算机中存在的 .svn 文件夹。按 windows 图标并输入 .svn，删除整个文件夹。它对我有用。

# c# - 将双精度数舍入到 x 有效数字

> ID：374316
> 
> 赞同：77
> 
> 时间：2008-12-17T11:52:09.173
> 
> 标签：c#, math, rounding, significant-digits

如果我有一个 double (234.004223) 等，我想在 C# 中将其四舍五入为 x 有效数字。

到目前为止，我只能找到四舍五入到 x 位小数的方法，但是如果数字中有任何 0，这只会删除精度。

例如，0.086 到小数点后一位变成 0.1，但我希望它保持在 0.08。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-12-17T13:01:38.423

该框架没有内置函数来四舍五入（或截断，如您的示例）到多个有效数字。但是，您可以做到这一点的一种方法是缩放您的数字，以便您的第一个有效数字正好在小数点之后，四舍五入（或截断），然后缩小。以下代码应该可以解决问题：

```
static double RoundToSignificantDigits(this double d, int digits){
    if(d == 0)
        return 0;

    double scale = Math.Pow(10, Math.Floor(Math.Log10(Math.Abs(d))) + 1);
    return scale * Math.Round(d / scale, digits);
} 
```

如果，如在您的示例中，您真的想要截断，那么您想要：

```
static double TruncateToSignificantDigits(this double d, int digits){
    if(d == 0)
        return 0;

    double scale = Math.Pow(10, Math.Floor(Math.Log10(Math.Abs(d))) + 1 - digits);
    return scale * Math.Truncate(d / scale);
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-12-17T22:56:12.483

我已经使用 pDaddy 的 sigfig 函数几个月了，发现其中有一个错误。您不能取负数的对数，因此如果 d 为负数，则结果为 NaN。

以下更正了该错误：

```
public static double SetSigFigs(double d, int digits)
{   
    if(d == 0)
        return 0;

    decimal scale = (decimal)Math.Pow(10, Math.Floor(Math.Log10(Math.Abs(d))) + 1);

    return (double) (scale * Math.Round((decimal)d / scale, digits));
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-12-17T12:27:18.320

在我看来，您根本不想四舍五入到 x 位小数 - 您想要四舍五入到 x 个有效数字。因此，在您的示例中，您希望将 0.086 舍入到一位有效数字，而不是一位小数位。

现在，由于双精度数的存储方式，使用双精度数并舍入到一些有效数字开始是有问题的。例如，您可以将 0.12 舍入到*接近*0.1 的值，但 0.1 不能完全表示为双精度数。你确定你实际上不应该使用小数吗？或者，这实际上是出于展示目的吗？如果是出于显示目的，我怀疑您实际上应该将双精度直接转换为具有相关有效位数的字符串。

如果你能回答这些问题，我可以试着想出一些合适的代码。听起来很糟糕，通过将数字转换为“完整”字符串然后找到第一个有效数字（然后采取适当的舍入操作）将数字转换为字符串作为字符串可能是最好的方法.

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-11-06T23:03:27.833

如果是出于显示目的（正如您在对 Jon Skeet 的回答的评论中所述），您应该使用 Gn [format specifier](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx#GFormatString)。其中*n*是有效位数 - 正是您所追求的。

如果您需要 3 个有效数字，这是使用示例（打印输出在每行的注释中）：

```
 Console.WriteLine(1.2345e-10.ToString("G3"));//1.23E-10
    Console.WriteLine(1.2345e-5.ToString("G3")); //1.23E-05
    Console.WriteLine(1.2345e-4.ToString("G3")); //0.000123
    Console.WriteLine(1.2345e-3.ToString("G3")); //0.00123
    Console.WriteLine(1.2345e-2.ToString("G3")); //0.0123
    Console.WriteLine(1.2345e-1.ToString("G3")); //0.123
    Console.WriteLine(1.2345e2.ToString("G3"));  //123
    Console.WriteLine(1.2345e3.ToString("G3"));  //1.23E+03
    Console.WriteLine(1.2345e4.ToString("G3"));  //1.23E+04
    Console.WriteLine(1.2345e5.ToString("G3"));  //1.23E+05
    Console.WriteLine(1.2345e10.ToString("G3")); //1.23E+10 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2011-09-07T13:12:57.760

我在 P Daddy 和 Eric 的方法中发现了两个错误。例如，这解决了 Andrew Hancox 在本问答中提出的精度误差。圆形方向也有问题。具有两个有效数字的 1050 不是 1000.0，而是 1100.0。使用 MidpointRounding.AwayFromZero 固定舍入。

```
static void Main(string[] args) {
  double x = RoundToSignificantDigits(1050, 2); // Old = 1000.0, New = 1100.0
  double y = RoundToSignificantDigits(5084611353.0, 4); // Old = 5084999999.999999, New = 5085000000.0
  double z = RoundToSignificantDigits(50.846, 4); // Old = 50.849999999999994, New =  50.85
}

static double RoundToSignificantDigits(double d, int digits) {
  if (d == 0.0) {
    return 0.0;
  }
  else {
    double leftSideNumbers = Math.Floor(Math.Log10(Math.Abs(d))) + 1;
    double scale = Math.Pow(10, leftSideNumbers);
    double result = scale * Math.Round(d / scale, digits, MidpointRounding.AwayFromZero);

    // Clean possible precision error.
    if ((int)leftSideNumbers >= digits) {
      return Math.Round(result, 0, MidpointRounding.AwayFromZero);
    }
    else {
      return Math.Round(result, digits - (int)leftSideNumbers, MidpointRounding.AwayFromZero);
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-08-20T09:48:55.613

正如 Jon Skeet 所提到的：在文本域中更好地处理这个问题。通常：出于显示目的，不要尝试舍入/更改浮点值，它永远不会 100% 有效。显示是次要问题，您应该处理任何特殊的格式要求，例如使用字符串。

我几年前实施的下面的解决方案已被证明非常可靠。它已经过彻底的测试，并且性能也很好。执行时间比 P Daddy / Eric 的解决方案长约 5 倍。

下面在代码中给出了输入 + 输出的示例。

```
using System;
using System.Text;

namespace KZ.SigDig
{
    public static class SignificantDigits
    {
        public static string DecimalSeparator;

        static SignificantDigits()
        {
            System.Globalization.CultureInfo ci = System.Threading.Thread.CurrentThread.CurrentCulture;
            DecimalSeparator = ci.NumberFormat.NumberDecimalSeparator;
        }

        /// <summary>
        /// Format a double to a given number of significant digits.
        /// </summary>
        /// <example>
        /// 0.086 -> "0.09" (digits = 1)
        /// 0.00030908 -> "0.00031" (digits = 2)
        /// 1239451.0 -> "1240000" (digits = 3)
        /// 5084611353.0 -> "5085000000" (digits = 4)
        /// 0.00000000000000000846113537656557 -> "0.00000000000000000846114" (digits = 6)
        /// 50.8437 -> "50.84" (digits = 4)
        /// 50.846 -> "50.85" (digits = 4)
        /// 990.0 -> "1000" (digits = 1)
        /// -5488.0 -> "-5000" (digits = 1)
        /// -990.0 -> "-1000" (digits = 1)
        /// 0.0000789 -> "0.000079" (digits = 2)
        /// </example>
        public static string Format(double number, int digits, bool showTrailingZeros = true, bool alwaysShowDecimalSeparator = false)
        {
            if (Double.IsNaN(number) ||
                Double.IsInfinity(number))
            {
                return number.ToString();
            }

            string sSign = "";
            string sBefore = "0"; // Before the decimal separator
            string sAfter = ""; // After the decimal separator

            if (number != 0d)
            {
                if (digits < 1)
                {
                    throw new ArgumentException("The digits parameter must be greater than zero.");
                }

                if (number < 0d)
                {
                    sSign = "-";
                    number = Math.Abs(number);
                }

                // Use scientific formatting as an intermediate step
                string sFormatString = "{0:" + new String('#', digits) + "E0}";
                string sScientific = String.Format(sFormatString, number);

                string sSignificand = sScientific.Substring(0, digits);
                int exponent = Int32.Parse(sScientific.Substring(digits + 1));
                // (the significand now already contains the requested number of digits with no decimal separator in it)

                StringBuilder sFractionalBreakup = new StringBuilder(sSignificand);

                if (!showTrailingZeros)
                {
                    while (sFractionalBreakup[sFractionalBreakup.Length - 1] == '0')
                    {
                        sFractionalBreakup.Length--;
                        exponent++;
                    }
                }

                // Place decimal separator (insert zeros if necessary)

                int separatorPosition = 0;

                if ((sFractionalBreakup.Length + exponent) < 1)
                {
                    sFractionalBreakup.Insert(0, "0", 1 - sFractionalBreakup.Length - exponent);
                    separatorPosition = 1;
                }
                else if (exponent > 0)
                {
                    sFractionalBreakup.Append('0', exponent);
                    separatorPosition = sFractionalBreakup.Length;
                }
                else
                {
                    separatorPosition = sFractionalBreakup.Length + exponent;
                }

                sBefore = sFractionalBreakup.ToString();

                if (separatorPosition < sBefore.Length)
                {
                    sAfter = sBefore.Substring(separatorPosition);
                    sBefore = sBefore.Remove(separatorPosition);
                }
            }

            string sReturnValue = sSign + sBefore;

            if (sAfter == "")
            {
                if (alwaysShowDecimalSeparator)
                {
                    sReturnValue += DecimalSeparator + "0";
                }
            }
            else
            {
                sReturnValue += DecimalSeparator + sAfter;
            }

            return sReturnValue;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-12-14T03:00:25.380

双打上的 Math.Round() 是有缺陷的（请参阅其[文档](http://msdn.microsoft.com/en-us/library/f5898377.aspx)中的调用者注释）。将舍入数字乘以其十进制指数的后续步骤将在尾随数字中引入进一步的浮点错误。像@Rowanto 那样使用另一个 Round() 不会可靠地提供帮助，并且会遇到其他问题。但是，如果您愿意使用小数，那么 Math.Round() 是可靠的，就像乘以和除以 10 的幂一样：

```
static ClassName()
{
    powersOf10 = new decimal[28 + 1 + 28];
    powersOf10[28] = 1;
    decimal pup = 1, pdown = 1;
    for (int i = 1; i < 29; i++) {
        pup *= 10;
        powersOf10[i + 28] = pup;
        pdown /= 10;
        powersOf10[28 - i] = pdown;
    }
}

/// <summary>Powers of 10 indexed by power+28\.  These are all the powers
/// of 10 that can be represented using decimal.</summary>
static decimal[] powersOf10;

static double RoundToSignificantDigits(double v, int digits)
{
    if (v == 0.0 || Double.IsNaN(v) || Double.IsInfinity(v)) {
        return v;
    } else {
        int decimal_exponent = (int)Math.Floor(Math.Log10(Math.Abs(v))) + 1;
        if (decimal_exponent < -28 + digits || decimal_exponent > 28 - digits) {
            // Decimals won't help outside their range of representation.
            // Insert flawed Double solutions here if you like.
            return v;
        } else {
            decimal d = (decimal)v;
            decimal scale = powersOf10[decimal_exponent + 28];
            return (double)(scale * Math.Round(d / scale, digits, MidpointRounding.AwayFromZero));
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-05-28T20:35:11.190

我同意[乔恩评估](https://stackoverflow.com/a/374394/402749)的精神：

> 听起来很糟糕，通过将数字转换为“完整”字符串然后找到第一个有效数字（然后采取适当的舍入操作）将数字转换为字符串作为字符串可能是最好的方法.

**为了近似**和**非性能关键的**计算目的，我需要有效数字舍入，并且通过“G”格式的格式解析往返就足够了：

```
public static double RoundToSignificantDigits(this double value, int numberOfSignificantDigits)
{
    return double.Parse(value.ToString("G" + numberOfSignificantDigits));
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-17T12:09:19.903

这个问题与您要问的问题类似：

[在 C# 中使用有效数字格式化数字](https://stackoverflow.com/questions/158172/formatting-numbers-with-significant-figures-in-c#158942)

因此，您可以执行以下操作：

```
double Input2 = 234.004223;
string Result2 = Math.Floor(Input2) + Convert.ToDouble(String.Format("{0:G1}", Input2 - Math.Floor(Input2))).ToString("R6"); 
```

四舍五入到 1 位有效数字。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-18T05:02:02.417

令`inputNumber`为需要`significantDigitsRequired`在小数点后进行转换的输入，`significantDigitsResult`则为下面伪代码的答案。

```
integerPortion = Math.truncate(**inputNumber**)

decimalPortion = myNumber-IntegerPortion

if( decimalPortion <> 0 )
{

 significantDigitsStartFrom = Math.Ceil(-log10(decimalPortion))

 scaleRequiredForTruncation= Math.Pow(10,significantDigitsStartFrom-1+**significantDigitsRequired**)

**siginficantDigitsResult** = integerPortion + ( Math.Truncate (decimalPortion*scaleRequiredForTruncation))/scaleRequiredForTruncation

}
else
{

  **siginficantDigitsResult** = integerPortion

} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-09-17T04:40:00.063

正如@Oliver Bock 所指出的那样，双打上的 Math.Round() 是有缺陷的（请参阅其[文档](http://msdn.microsoft.com/en-us/library/f5898377.aspx)中的调用者注释）。将舍入数字乘以其十进制指数的后续步骤将在尾随数字中引入进一步的浮点错误。通常，任何乘以或除以 10 的幂都会得到不精确的结果，因为浮点通常以二进制而不是十进制表示。

使用以下函数将避免尾随数字中的浮点错误：

```
static double RoundToSignificantDigits(double d, int digits)
{
    if (d == 0.0 || Double.IsNaN(d) || Double.IsInfinity(d))
    {
        return d;
    }
    // Compute shift of the decimal point.
    int shift = digits - 1 - (int)Math.Floor(Math.Log10(Math.Abs(d)));

    // Return if rounding to the same or higher precision.
    int decimalPlaces = 0;
    for (long pow = 1; Math.Floor(d * pow) != (d * pow); pow *= 10) decimalPlaces++;
    if (shift >= decimalPlaces)
        return d;

    // Round to sf-1 fractional digits of normalized mantissa x.dddd
    double scale = Math.Pow(10, Math.Abs(shift));
    return shift > 0 ?
           Math.Round(d * scale, MidpointRounding.AwayFromZero) / scale :
           Math.Round(d / scale, MidpointRounding.AwayFromZero) * scale;
} 
```

但是，如果您愿意使用小数，那么 Math.Round() 是可靠的，就像乘以和除以 10 的幂一样：

```
static double RoundToSignificantDigits(double d, int digits)
{
    if (d == 0.0 || Double.IsNaN(d) || Double.IsInfinity(d))
    {
        return d;
    }
    decimal scale = (decimal)Math.Pow(10, Math.Floor(Math.Log10(Math.Abs(d))) + 1);
    return (double)(scale * Math.Round((decimal)d / scale, digits, MidpointRounding.AwayFromZero));
}

Console.WriteLine("{0:G17}", RoundToSignificantDigits(5.015 * 100, 15)); // 501.5 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-10-30T08:35:26.607

对我来说，这个工作得很好，也适用于负数：

```
public static double RoundToSignificantDigits(double number, int digits)
{
    int sign = Math.Sign(number);

    if (sign < 0)
        number *= -1;

    if (number == 0)
        return 0;

    double scale = Math.Pow(10, Math.Floor(Math.Log10(Math.Abs(number))) + 1);
    return sign * scale * Math.Round(number / scale, digits);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-12-08T20:16:34.540

我的解决方案在某些情况下可能会有所帮助，我用它来显示幅度差异很大的加密货币价格 - 它总是给我指定数量的有效数字，但与 ToString("G[number of digits]") 不同，它不显示科学记数法中的小值（不知道用 ToString() 避免这种情况的方法，如果有，请告诉我！）

```
 const int MIN_SIG_FIGS = 6; //will be one more for < 0
    int numZeros = (int)Math.Floor(Math.Log10(Math.Abs(price))); //get number of zeros before first digit, will be negative for price > 0
    int decPlaces = numZeros < MIN_SIG_FIGS
                  ? MIN_SIG_FIGS - numZeros < 0 
                        ? 0 
                        : MIN_SIG_FIGS - numZeros 
                  : 0; //dec. places: set to MIN_SIG_FIGS + number of zeros, unless numZeros greater than sig figs then no decimal places
    return price.ToString($"F{decPlaces}"); 
```

* * *

## 回答 #14

> 赞同：-6
> 
> 时间：2011-05-02T19:22:52.443

我已经做了：

```
int integer1 = Math.Round(double you want to round, 
    significant figures you want to round to) 
```

* * *

## 回答 #15

> 赞同：-7
> 
> 时间：2012-03-17T14:43:24.043

这是我在 C++ 中所做的

```
/*
    I had this same problem I was writing a design sheet and
    the standard values were rounded. So not to give my
    values an advantage in a later comparison I need the
    number rounded, so I wrote this bit of code.

    It will round any double to a given number of significant
    figures. But I have a limited range written into the
    subroutine. This is to save time as my numbers were not
    very large or very small. But you can easily change that
    to the full double range, but it will take more time.

    Ross Mckinstray
    rmckinstray01@gmail.com
*/

#include <iostream>
#include <fstream>
#include <string>
#include <math.h>
#include <cmath>
#include <iomanip>

#using namespace std;

double round_off(double input, int places) {
    double roundA;
    double range = pow(10, 10); // This limits the range of the rounder to 10/10^10 - 10*10^10 if you want more change range;
    for (double j = 10/range; j< 10*range;) {
        if (input >= j && input < j*10){
            double figures = pow(10, places)/10;
            roundA = roundf(input/(j/figures))*(j/figures);
        }
        j = j*10;
    }
    cout << "\n in sub after loop";
    if (input <= 10/(10*10) && input >= 10*10) {
        roundA = input;
        cout << "\nDID NOT ROUND change range";
    }
    return roundA;
}

int main() {
    double number, sig_fig;

    do {
        cout << "\nEnter number ";
        cin >> number;
        cout << "\nEnter sig_fig ";
        cin >> sig_fig;
        double output = round_off(number, sig_fig);

        cout << setprecision(10);
        cout << "\n I= " << number;
        cout << "\n r= " <<output;
        cout << "\nEnter 0 as number to exit loop";
    }
    while (number != 0);

    return 0;
} 
```

希望我没有改变任何格式化它。

# python - python中unicode字符串的转换

> ID：374318
> 
> 赞同：4
> 
> 时间：2008-12-17T11:52:51.683
> 
> 标签：python, string, unicode, unsigned, signed

我需要将 Python 中的 unicode 字符串转换为其他类型，例如无符号和有符号 int 8 位、无符号和有符号 int 16 位、无符号和有符号 int 32 位、无符号和有符号 int 64 位、双精度、浮点数、字符串、无符号和有符号8 位，无符号和有符号 16 位，无符号和有符号 32 位，无符号和有符号 64 位。

我需要你们的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T11:58:56.973

用于[`int()`](http://docs.python.org/library/functions.html#int)将字符串转换为整数。Python 没有不同的固定宽度整数，所以你只会得到一种类型的东西。

然后使用[`struct`](http://docs.python.org/library/struct.html)将整数打包成固定宽度：

```
res = struct.pack("=B",i) ## uint8_t
res = struct.pack("=b",i) ## int8_t

res = struct.pack("=H",i) ## uint16_t
res = struct.pack("=h",i) ## int16_t

res = struct.pack("=I",i) ## uint32_t
res = struct.pack("=i",i) ## int32_t

res = struct.pack("=Q",i) ## uint64_t
res = struct.pack("=q",i) ## int64_t

res = struct.pack("=f",i) ## float
res = struct.pack("=d",i) ## double 
```

`struct`生成一个包含二进制数字的字节串。

编辑：从评论看来，您只想将字符串（十进制数字）转换为整数。只是使用`int()`它，但是你不会得到指定类型的所有复杂的溢出/下溢语义。您无法在 python 中重现它，至少在不编写大量代码的情况下无法重现。

我认为，如果您需要更多帮助，则必须更准确地了解您想要实现的目标。

# php - 专业并跟上

> ID：374322
> 
> 赞同：1
> 
> 时间：2008-12-17T11:54:24.190
> 
> 标签：php, c++, .net

最近可能在 SO 播客或 Joel 中提到的一件事是，当您开始时，在业务上取得成功的最佳方式是开始专业化并只专注于一件事。

如果你说你是万事通；你只是另一个千斤顶！如果你说你是专家——我认为 joels 的例子是某种类型的水龙头——那么即使你认为你刚刚移除了大部分市场；您实际上增加了在特定标记中获得业务的几率，因为您将在其他标记中脱颖而出；某个地方的某个人会想要你的东西，而不是你只是说你什么都做。

所以无论如何，我的问题是；我想专攻某件事。我从事 C/C++ 已经有很长时间了，但从来没有真正将自己定位为 win32、mfc、directx、wxWidgets、qt、boost、sdl、allegro 等。我已经尝试了所有方法，并且在每种方法中都做了不同的事情；我也开始着手实际为 linux（现在是 osx）写作，而不是仅仅使用它，所以我的机会进一步增加。

我的观点是，我知道的越多，我就越不可能停滞不前。如果我知道其中的每一点，我就可以在任何地方找到一份工作，然后在需要时学习更多。

在过去的几年里，我还学习了 .NET，然后是 PHP/LAMP；两者我都觉得很舒服，但我想在我心里我仍然是一个 C++ 人（尽管我认为我在 PHP 中学到的商业知识比我在 C++ 中学到的更多）。

我感觉的另一个问题是，世界正在变得高度基于 Web，而 C++ 等技术的使用越来越少（忽略 Google 的新工具 - 不记得名称），而 flash 和 flex 等其他东西正在变得越来越多受欢迎的。我确实同意我们用来查看网络的工具是用 C++ 编写的，但就市场份额而言，我认为所有的基础都已经涵盖了。

我想知道人们如何决定最终选择什么挂钩以及为什么；这是出于商业原因（即它赚更多的钱）还是出于自私的原因（即我觉得用 C++ 编写与 PHP 相对的东西是完整的）。

也许我问错了问题；也许我应该专注于特定产品而不是语言即服务；没想到...

干杯，克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T12:27:22.470

我猜大多数人在职业生涯开始时会选择一个理由（兴趣、金钱）朝着特定的方向前进，其余的大部分都是偶然的。

我仍然努力保持对与我当前和迫在眉睫的职责（以及我的朋友和同事的职责，以便我能够理解我们的对话）相关的技术的广泛了解。但我专注于那些在我的特定领域中保持“领先地位”所必需的，或者与我无关但对我感兴趣的那些，而且我还通过渗透涉足了其他一些领域。

您注意到“世界正变得高度基于 Web，而 C++ 等技术的使用越来越少。” 因此，您可以“随波逐流”并追逐新的工具和方法，或者您可以在创造它们的领域找到一个利基市场。我选择后者是因为，虽然职位可能更少，但我发现它们在智力和经济上都更具挑战性和回报。哦，竞争少了！

随着您职业生涯的发展，您会发现许多技术非常相似，并且有很多重叠之处。一旦您掌握了基础知识，了解任何特定平台或语言就变得不那么重要了，而更重要的是了解导致有效、强大、高质量产品的技术和流程。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T13:12:35.033

我自己也曾走上这条路，目前拥有并经营着一家小型软件公司，我会说您专注于特定市场是正确的，因为您将能够在同一市场领域胜过多面手。请注意，我建议专注于给定领域而不是给定技术，因为技术变化很快，而领域知识往往会持续更长时间。

这还取决于您是打算作为承包商或 FTE 在别人的业务中工作，还是单干并建立自己的软件公司。在后一种情况下，您和您的合作伙伴之间需要一套技能，包括分析、开发、测试、销售、营销和财务。因此，一旦您拥有足够的开发技能来满足您的需求，您可能希望专注于快速提升免费技能。例如，在过去的几年里，我投入了大量时间学习有效的测试自动化技术，而不是新的开发工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T12:25:58.293

对于刚开始从事这项业务的人来说，专业化可能是有意义的，因为他们需要一些东西来竞争。

对于更有经验的开发人员，我同意 The Pragmatic Programmer 一书的建议，即作为一名专业开发人员，您应该始终尝试将更多有用的工具添加到您的工具箱中。例如，他们建议定期学习新的编程语言等。

如果你这样做了，你显然不会在所有这些领域都成为黑带，但你会开阔眼界，学会从不同的角度看待问题，这对 imo 非常有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T13:11:11.120

作为一个既要雇用各种开发人员又要与他们一起工作的人，我认为你需要广度和深度。你需要了解广泛的技术和平台，以表明你很灵活，可以根据需要学习新技能，并且有兴趣拓宽你的知识。你还需要一两个领域知识渊博，以证明你有能力成为专家。

我更愿意雇用具有一系列技能但不一定是我需要的确切技能的人，而不是完全匹配但无法学习任何新东西的人。发展中为数不多的确定性之一是，我们今天所做的任何事情都与 5 年后我们所做的事情不同。

至于 C++，我们正在大量使用它来开发基于代理的高度分布式模拟。想想数以亿计的代理，它们紧密耦合在几千台机器上。对于这个利基市场，我们还没有发现任何能胜过 C++ 的东西。

# vba - 在 Visual Basic (VBA) 中传递对象引用

> ID：374324
> 
> 赞同：5
> 
> 时间：2008-12-17T11:54:25.627
> 
> 标签：vba, excel

如何将表单的`TextBox`对象传递给 a 方法？

以下代码发出异常。

```
Private Sub DoSmthWithTextBox(ByRef txtBox as TextBox)
    txtBox.BackColor = vbRed
End Sub

Private Sub TextBox1_Change()
    DoSmthWithTextBox Me.TextBox1
End Sub 
```

`DoSmthWithTextBox Me.TextBox1`传递`String`from`TextBox1`而不是对象引用时会出现问题。

如何将`TextBox`对象传递给`DoSmthWithTextBox`方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-17T11:59:54.850

为 Excel 重写：

```
Private Sub DoSmthWithTextBox(txtBox As MSForms.TextBox)
    txtBox.BackColor = vbRed
End Sub 
```

据我所知，这是因为 Excel 有一个对象文本框是一个形状，而用户窗体使用 ActiveX 控件文本框，因此您需要显式引用 MSForms 库。

# ruby - 如何从Ruby中的文件路径获取不带扩展名的文件名

> ID：374326
> 
> 赞同：240
> 
> 时间：2008-12-17T11:55:24.627
> 
> 标签：ruby

如何从 Ruby 中的文件路径中获取文件名？

例如，如果我有一条路径`"C:\projects\blah.dll"`并且我只想要“blah”。

`LastIndexOf`Ruby中有方法吗？

* * *

## 回答 #1

> 赞同：599
> 
> 时间：2008-12-17T12:01:35.067

尝试[`File.basename`](http://ruby-doc.org/core-1.8.7/classes/File.html#M000803)

> 返回 file_name 中给定的文件名的最后一个组成部分，无论本地文件系统上使用的分隔符如何，都必须使用正斜杠 (``/'') 形成。如果给定后缀并出现在 file_name 的末尾，则将其删除。
> 
> ```
> File.basename("/home/gumby/work/ruby.rb")          #=> "ruby.rb"
> File.basename("/home/gumby/work/ruby.rb", ".rb")   #=> "ruby" 
> ```

在你的情况下：

```
File.basename("C:\\projects\\blah.dll", ".dll")  #=> "blah" 
```

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2008-12-17T12:27:16.403

```
require 'pathname'

Pathname.new('/opt/local/bin/ruby').basename
# => #<Pathname:ruby> 
```

我很久没有成为 Windows 用户了，但是 Pathname rdoc 说它在 Windows 上没有目录名称分隔符的问题。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2008-12-17T12:34:54.873

如果扩展名未知（它需要 / 分隔符）：

```
irb(main):024:0> f = 'C:\foobar\blah.txt'.gsub("\\","/")
=> "C:/foobar/blah.txt"
irb(main):027:0> File.basename(f,File.extname(f))
=> "blah" 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2014-08-27T03:17:47.037

[Jonathan Lonowski](https://stackoverflow.com/a/374345/2767755)完美地回答了，但是这里没有提到任何答案。代替[`File::extname`](http://www.ruby-doc.org/core-2.1.2/File.html#method-c-extname)，您可以直接使用 a`'.*'`来获取文件名。

```
File.basename("C:\\projects\\blah.dll", ".*") # => "C:\\projects\\blah" 
```

但是，如果您想获取*任何特定扩展文件*的基本文件名，则需要使用`File::extname`，否则不需要。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2016-11-28T14:12:41.210

试试这个代码

采用[`extname`](http://apidock.com/ruby/File/extname/class)

```
 File.basename("a/b/d/test.rb", File.extname("a/b/d/test.rb")) #=> "test" 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-12-17T12:04:42.003

Jonathon 的答案更好，但让您知道`somelist[-1]`是可用的`LastIndexOf`符号之一。

正如 krusty.ar 所提到`somelist.last`的，显然也是如此。

```
irb(main):003:0* f = 'C:\\path\\file.txt'
irb(main):007:0> f.split('\\')
=> ["C:", "path", "file.txt"]
irb(main):008:0> f.split('\\')[-1]
=> "file.txt" 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-17T12:04:06.200

请注意，双引号字符串会转义 \'s。

```
'C:\projects\blah.dll'.split('\\').last 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-06-08T10:55:44.277

我个人更喜欢`Pathname`与`.*`

```
path = Pathname.new('/home/motine/myname.dll')
path.basename('.*') # => "myname" 
```

`basename`实际上返回一个`Pathname`实例。如果你想强制一个字符串，你可以调用`to_s`它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-06T08:04:55.080

如果您可以访问 ENV 变量，`scan`结合这个小正则表达式（查找最后一个单词，一个点，然后是字符串的最后一个单词）会将文件名放入“文件名”：

```
filename = ENV['SCRIPT_NAME'].scan(/\w+\.\w+$/) 
```

显然，您可以`scan`在包含文件名的任何路径名上使用和正则表达式，这`__FILE__`是显而易见的选择：

```
__FILE__.scan(/\w+\.\w+$/) 
```

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2011-09-14T13:28:32.527

您可以使用以下命令获取当前脚本的目录路径：

```
File.dirname __FILE__ 
```

# c# - 使用 C# 设置文件夹权限 - 将 CreateObject("Wscript.Shell") 从 vb 转换为 C#

> ID：374330
> 
> 赞同：1
> 
> 时间：2008-12-17T11:56:41.440
> 
> 标签：c#, vb.net

我想知道如何将此 vb 脚本转换为 C#

```
Dim strFolder As String
Dim objShell As Object

strFolder = "C:\zz"

Set objShell = CreateObject("Wscript.Shell")

objShell.Run "%COMSPEC% /c Echo Y| cacls " & _
                 strFolder & _
                 " /t /c /g everyone:F ", 2, True 
```

我要做的是在用户 C:\ 驱动器上新创建的文件夹上将权限设置为“所有人”。

我正在使用 Visual Studio，.Net 1.1

谢谢。伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T13:06:00.163

不幸的是，升级是不可能的——我在一家大公司工作，所以意味着要更新大量的人——这将是一项任务……

但是 - 创建一个流程有效！

```
System.Diagnostics.Process meProc = System.Diagnostics.Process.Start ("cmd.exe", " /c echo y| cacls C:\\zzz /t /c /g everyone:F"); 
```

谢谢你们俩的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T12:36:15.713

不能升级到新版本吗？.NET 2.0 在[System.Security.AccessControl](http://msdn.microsoft.com/en-us/library/system.security.accesscontrol.aspx)命名空间中引入了类来处理这个问题。如果真的不可能并且您只有这个命令要执行，您可能需要创建一个[进程](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)并执行其中的`cacls`命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T12:40:05.067

这也是使用“Microsoft.Win32.Security”库...

我没有 SecuredObject

```
SecuredObject sec = new SecuredObject("C:\\", SecuredObjectType.FileObject); 
```

# .net - 如何在实体框架中实现从实体到自身的多对多关联？

> ID：374331
> 
> 赞同：2
> 
> 时间：2008-12-17T11:57:40.627
> 
> 标签：.net, entity-framework, many-to-many

我有一个实体，它公开了一组相同类型的孩子。实体本身可以是另一个实例的孩子——实际上是与自身的多对多关系。在数据库中，我有一个包含两列的链接器表 - parentId 和 childId - 两者都引用了我的实体表中的 Id 列。Entity Framework 正确识别出它与自身是多对多关系但抛出错误：

> 从第 249、300 行开始的映射片段中的问题：具有可能不同键的两个实体被映射到同一行。确保这两个映射片段将 AssociationSet 的两端映射到对应的列

有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-21T14:22:22.873

我将在新的 EF 模型中建立多对多关系并从中生成数据库。然后将它创建的结构与您的数据库模型进行比较。这应该提供一些线索。

# java - 是否有静态类型和可变长度的 Java 数组/列表

> ID：374339
> 
> 赞同：1
> 
> 时间：2008-12-17T11:59:30.640
> 
> 标签：java, arrays, list

这将非常方便，因为类型转换很快就会变得无聊。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-17T12:02:01.507

如果你使用泛型（java 5），你可以避免所有的转换

```
 List<String> myList = new ArrayList<String>();
 myList.add(" a test");
 String temp = myList.get(0); 
```

除非我在你的问题中遗漏了一些应该涵盖这两种需求的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T12:03:59.850

我不明白，这有什么难的：

```
List<Foo> fooList = new ArrayList<Foo>(); 
```

我想你可以定义一个类：

```
public class FooList extends ArrayList<Foo> {
    ...
} 
```

如果你想避免尖括号...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T13:18:22.487

如果通过“可变长度”表示大小会随时间变化，那么您可能需要 LinkedList 而不是 ArrayList：

```
print("List<Foo> fooList = new LinkedList<Foo>();"); 
```

这样你在添加一堆元素时可以获得更好的性能。

# wcf - 在工作组模式下将新消息发布到专用队列时，WCF 服务从不通知

> ID：374341
> 
> 赞同：1
> 
> 时间：2008-12-17T11:59:48.190
> 
> 标签：wcf, msmq

我正在使用 WCF (C#) 在工作组模式下在 Windows Server 2003 下从私有 MSMQ 队列发送/接收消息。

客户端 WCF/服务 WCF 和 MSMQ 在同一台计算机上。

有一个客户端将消息发送到私有队列，效果很好。有一个服务从同一个私有队列接收消息，但该服务似乎永远不会被 MSMQ 调用。（没有错误发生）

消息在队列中堆积，但没有任何内容被拉出。在另一台计算机（域模式而不是工作组模式）上，消息被完美地发送和接收。

导致 MSMQ 从不调用我的服务的工作组模式有什么问题？

之后，我编写了一个 C# 测试，总是在同一台计算机上，但这次我创建了 MessageQueue 并以这种方式订阅 ReceiveCompleted 事件：

```
MessageQueue MQueue = new MessageQueue(".\\private$\\nameofmyqueue");
MQueue.MessageReadPropertyFilter.SetAll();
MQueue.ReceiveCompleted += MessageEventHandler;
Message Msg = MQueue.Receive(); 
```

现在有新消息时，我会从 MSMQ 队列接收事件。

我认为我的服务配置（WFC 配置）或命名空间保留存在问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-19T10:43:36.267

我发现我的麻烦在哪里。事实上，我使用了一个调用 SQL Server 2005 过程的事务处理服务。

为了在 SQL 2005 中使用事务绑定，过程的执行被支撑在事务范围内。

如果抛出异常但未捕获，则 DTC 用于回滚过程。我的问题是我的服务器上未激活 DTC/远程客户端连接。

因此，要么您应该激活 DTC/远程客户端连接，要么您不使用事务范围。

如果要使用**DTC**和远程客户端连接，**必须先激活远程客户**端连接，因为激活 DTC 和远程客户端连接**会导致服务器重启**。

# java - 防御性编程的编辑器模板

> ID：374348
> 
> 赞同：8
> 
> 时间：2008-12-17T12:03:21.957
> 
> 标签：java, eclipse, templates, defensive-programming

最近我处理了关于暴露内部状态的 FindBugs 警告，即当返回对数组的引用而不是返回数组的副本时。我创建了一些模板以使转换该代码更容易。

您创建了哪一个来支持防御性编程并希望与 SO 人群分享？

到目前为止我创建的模板（作为示例）：

创建数组的副本以从方法返回：

```
final ${type}[] ${result} = new ${type}[ ${array}.length ];
System.arraycopy( ${array} , 0 , ${result} , 0 , ${array}.length ); 
```

克隆一个对象：

```
(${o}!= null?(${type})${o}.clone():null) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T12:42:12.660

我喜欢将“更安全”的 equals() 定义作为模板：

```
 /**
 * Implement equals based on ${cursor}. <br />
 * See {@link #compareTo(Object) compareTo}
 * @see java.lang.Object#equals(java.lang.Object)
 */
public boolean equals(final Object anObject)
{
    boolean res = false;
    if(anObject == null) { return false; }
    if(anObject == this) { return true; }
    if(anObject.getClass() == this.getClass())
    {
        res = this.compareTo(anObject) == 0;
    }
    return res;
} 
```

为了确保始终避免**Eq: equals 方法覆盖超类中的 equals 并且可能不是对称的**( `EQ_OVERRIDING_EQUALS_NOT_SYMMETRIC`)，其中：

> 此类定义了一个 equals 方法，该方法覆盖了超类中的 equals 方法。两种equals方法方法都使用instanceof来判断两个对象是否相等。
> 
> 这充满了危险，因为 equals 方法是对称的（换句话说，`a.equals(b) == b.equals(a)`）很重要。
> 如果`B`是 的子类型`A`, 和`A`的 equals 方法检查参数是否为`instanceof A`, 而 B 的 equals 方法检查参数是否为`instanceof B`, 很可能这些方法定义的等价关系不是对称的。

* * *

这仅适用于实现的类`Comparable`并允许：

*   equals 的实现总是相同的；
*   所有比较逻辑仅位于一个位置（`compareTo()`函数）；
*   遵守`Comparable#compareTo()`要求确保这一点的 javadoc `(x.compareTo(y)==0) == (x.equals(y))`（强烈推荐，但并非严格要求）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T12:33:49.277

不是模板，但我使用`array.clone()`而不是`System.arraycopy()`. 这有什么问题吗？

编辑：我在实现装饰器时使用的模板，特别是对于具有许多方法的接口：

```
wrapped.${enclosing_method}(${enclosing_method_arguments}) 
```

它通过将调用委托给包装实例来生成当前方法的实现，从而防止复制/粘贴错误。

# c# - 用于编组结构数组的辅助函数（带指针）

> ID：374386
> 
> 赞同：1
> 
> 时间：2008-12-17T12:25:29.917
> 
> 标签：c#, arrays, pinvoke, marshalling, intptr

这似乎是最常见的 C# 互操作问题，但似乎很难找到有效的解决方案。

我需要在 C# 中分配一个矩阵数据结构数组，将其传递给一个 C DLL，该 C DLL 填充数据并将其返回给调用者进行处理。

基于网络上的各种页面，我似乎已经设法将数据和内存从 C# 获取到 C++ 中，但似乎没有返回......

代码如下。

在此先感谢您的帮助

* * *

我有一个 C++ 结构如下

```
typedef struct tagTMatrix
{
   int   Id;
   int   NumColumns;
   int   NumRows;
   double*  aData;
} TMatrix; 
```

我在 C# 中声明为

```
[StructLayout(LayoutKind.Sequential)]
unsafe public struct TMatrix
{
public Int32 id;
public Int32 NumCols;
public Int32 NumRows;
public Int32 NumPlanes;
public IntPtr aData;
};

[DllImport("kernel32.dll")]
internal static extern IntPtr LoadLibrary(String dllname);
[DllImport("kernel32.dll")]
internal static extern IntPtr GetProcAddress(IntPtr hModule, String 
procname);

unsafe internal delegate void FillMatrices(IntPtr mats, long num);

[DllImport("kernel32.dll", EntryPoint = "RtlMoveMemory")] // Saw this 
mentioned somewhere
static extern void CopyMemory(IntPtr dest, IntPtr[] src, int cb);

unsafe private void butTest_Click(object sender, EventArgs e)
{
    IntPtr library = LoadLibrary("TestDLL.dll");
    IntPtr procaddr = GetProcAddress(library, "FillMatrices");
    FillMatrices fm = 
(FillMatrices)Marshal.GetDelegateForFunctionPointer(procaddr, 
typeof(FillMatrices));
    TMatrix[] mats = new TMatrix[2];
    mats[0]=new TMatrix();
    mats[1]=new TMatrix();
    mats[0].id=1;
    mats[0].NumCols=2;mats[0].NumRows=1;mats[0].NumPlanes=0;
    mats[0].aData = Marshal.AllocHGlobal(sizeof(double) * 2);
    double [] array=new double[2];
    array[0]=12.5;array[1]=2.3;
    fixed (double* a = array)
{
IntPtr intPtr = new IntPtr((void*)a);
mats[1].aData = Marshal.AllocHGlobal(sizeof(double) * 2);
//mats[1].aData = 13;
mats[1].aData = intPtr;
mats[1].id = 2;
mats[1].NumCols = 1; mats[1].NumRows = 2; mats[1].NumPlanes = 0;
}
IntPtr[] ptrs = new IntPtr[2];
int total=0;
for (int i = 0; i < ptrs.Length; i++)
{
total = total + sizeof(IntPtr) * (4 + mats[i].NumCols * mats[i].NumRows);
ptrs[i] = 
Marshal.AllocHGlobal(sizeof(IntPtr)*(4+mats[i].NumCols*mats[i].NumRows));
}
Marshal.StructureToPtr(mats[0], ptrs[0], false);
Marshal.StructureToPtr(mats[1], ptrs[1], false);
//_list.test_list =
IntPtr pointer=Marshal.AllocHGlobal(total);
CopyMemory(pointer, ptrs, 2 * IntPtr.Size);
//TMatrix m1=new TMatrix();
//mats[0].aData = 10;// new double[20];
//TMatrix m2 = new TMatrix();
// mats[1].aData = 20;// new double[9];
//Marshal.StructureToPtr(m2, p1, false);
//mats.Add(m2);
//Marshal.StructureToPtr(mats, p1, false);
//IntPtr p2=Marshal.AllocHGlobal(270);
//Marshal.StructureToPtr(mats.ToArray(),p2,false);
fm(pointer,2);
// Now I want to get back this data ???
}

// C++ function
extern "C" void FillMatrices(TMatrix** mats, int matcount)
{
 FILE* fp=fopen("C:\\mats.txt","w+");
 fprintf(fp,"Number of matrices = %d\n",matcount);
 fflush(fp);
 for(int i=0;i<matcount;++i)
 {
  TMatrix* m=mats[i];
  fprintf(fp,"id = %d rows %d cols %d \n",m->Id,m->NumRows,m->NumColumns);
  fflush(fp);

  for(int j=0;j<m->NumRows;++j)
  {
   fprintf(fp,"%d ",j);
   fflush(fp);
   for(int k=0;k<m->NumColumns;++k)
   {
    fprintf(fp,"%f ", m->aData[k*m->NumRows+j]);
    // modify the data - it should be available back in C#
    m->aData[k*m->NumRows+j]=k;
    fflush(fp);
   }
   fprintf(fp,"\n");
   fflush(fp);
  }
  fprintf(fp,"--------------------------\n");

  fflush(fp);
 }
 fclose(fp);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T11:13:02.837

这是我的初始代码的修改版本，适用于矩阵数组：

```
typedef struct Matrix
{
    int rowsCount;
    int colsCount;
    int* data;
} TMatrix;

extern "C" __declspec(dllexport) void InitializeMatrix(TMatrix** matrices, int count) 
{
    srand(time(NULL));
    printf("<unmanaged>\n");
    for(int i = 0; i < count; i++)
    {
        TMatrix* m = matrices[i];
        printf("rows %d cols %d\n", m->rowsCount, m->colsCount);

        for(int j = 0; j < m->rowsCount; j++)
        {
            for(int k = 0; k < m->colsCount; k++)
            {
                printf("%d ", m->data[k * m->rowsCount + j]);
                // modify the data - it should be available back in C#
                m->data[k * m->rowsCount + j] = rand() % 10;
            }
            printf("\n");
        }
    }
    printf("</unmanaged>\n\n");
} 
```

和托管部分：

```
[StructLayout(LayoutKind.Sequential)]
struct Matrix
{
    public int RowsCount;
    public int ColsCount;
    public IntPtr Data;
}

class Program
{
    [DllImport("TestLib.dll")]
    private static extern void InitializeMatrix(IntPtr ptr, int count);

    static void Main(string[] args)
    {
        const int count = 3;

        // Allocate memory
        IntPtr ptr = Marshal.AllocHGlobal(count * Marshal.SizeOf(typeof(IntPtr)));
        IntPtr[] matrices = new IntPtr[count];
        for (int i = 0; i < count; i++)
        {
            Matrix matrix = new Matrix();
            // Give some size to the matrix
            matrix.RowsCount = 4;
            matrix.ColsCount = 3;
            int size = matrix.RowsCount * matrix.ColsCount;
            int[] data = new int[size];
            matrix.Data = Marshal.AllocHGlobal(size * Marshal.SizeOf(typeof(int)));
            Marshal.Copy(data, 0, matrix.Data, size);

            matrices[i] = Marshal.AllocHGlobal(Marshal.SizeOf(typeof(Matrix)));
            Marshal.StructureToPtr(matrix, matrices[i], true);
        }
        Marshal.Copy(matrices, 0, ptr, count);

        // Call unmanaged routine
        InitializeMatrix(ptr, count);

        Console.WriteLine("<managed>");
        // Read data back
        Marshal.Copy(ptr, matrices, 0, count);
        for (int i = 0; i < count; i++)
        {
            Matrix m = (Matrix)Marshal.PtrToStructure(matrices[i], typeof(Matrix));
            int size = m.RowsCount * m.ColsCount;
            int[] data = new int[size];
            Marshal.Copy(m.Data, data, 0, size);

            // Pretty-print the matrix
            Console.WriteLine("rows: {0} cols: {1}", m.RowsCount, m.ColsCount);
            for (int j = 0; j < m.RowsCount; j++)
            {
                for (int k = 0; k < m.ColsCount; k++)
                {
                    Console.Write("{0} ", data[k * m.RowsCount + j]);
                }
                Console.WriteLine();
            }
        }
        Console.WriteLine("</managed>");

        // Clean the whole mess (try...finally block omitted for clarity)
        for (int i = 0; i < count; i++)
        {
            Matrix m = (Matrix)Marshal.PtrToStructure(matrices[i], typeof(Matrix));
            Marshal.FreeHGlobal(m.Data);
            Marshal.FreeHGlobal(matrices[i]);
        }
        Marshal.FreeHGlobal(ptr);
    }
} 
```

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T04:20:43.420

这是我用来在 C# 客户端应用程序上编组 C++ 网络结构的几种方法：

```
 public static T Get<T>(byte[] msg, int offset)
    {

        T[] t = new T[] { default(T) };
        int len = Marshal.SizeOf(typeof(T));
        GCHandle th = GCHandle.Alloc(t, GCHandleType.Pinned);
        GCHandle mh = GCHandle.Alloc(msg, GCHandleType.Pinned);
        try
        {
            unsafe
            {
                byte* pb = (byte*)mh.AddrOfPinnedObject();
                byte* srcptr = pb + offset;
                byte* dest = ((byte*)th.AddrOfPinnedObject());
                for (int i = 0; i < len; i++)
                {
                    dest[i] = srcptr[i];
                }
            }
        }
        finally
        {
            mh.Free();
            th.Free();
        }

        return t[0];
    }

    public static string GetString(byte[] msg, int offset, int length)
    {
        StringBuilder retVal = new StringBuilder(length);
        unsafe
        {
            fixed (byte* pb = msg)
            {
                byte* pc = (byte*)(pb + offset);
                for (int x = 0; x < length; x++)
                {
                    if (pc[x] == 0) break;
                    retVal.Append((char)pc[x]);
                }
            }
        }
        return retVal.ToString(0, retVal.Length);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T21:20:41.210

这是我在一个旧项目中的做法，在该项目中，我必须将整数矩阵传递给 C 例程，该例程将用值填充它，然后我必须取回托管代码中的值。

我在非托管代码中有一个例程，它将用一些值填充整数矩阵：

```
#include "stdafx.h"
#include "TestLib.h"
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

extern "C" __declspec(dllexport) void InitializeMatrix(int** matrix, int rows, int cols) 
{
    srand(time(NULL));
    printf("rows: %d\ncols: %d\n", rows, cols);
    for (int i = 0; i < rows; i++) 
    {
        for (int j = 0; j < cols; j++)
        {
            matrix[i][j] = rand() % 10;
        }
    }
} 
```

然后在托管代码中我做了一些事情：

```
class Program
{
    [DllImport(@"TestLib.dll")]
    private static extern void InitializeMatrix(IntPtr ptr, int rows, int cols);

    static void Main(string[] args)
    {
        const int rowsCount = 3;
        const int colsCount = 4;

        // Allocate memory for the matrix: (rowsCount * sizeof(IntPtr)) * (colsCount * sizeof(int))
        IntPtr ptr = AllocateMatrix(rowsCount, colsCount);
        try
        {
            // Call unmanaged routine to fill the allocated memory with data
            InitializeMatrix(ptr, rowsCount, colsCount);

            // Marshal back data
            int[][] matrix = GetMatrixFromPointer(ptr, rowsCount, colsCount);

            // Pretty-print the matrix
            for (int i = 0; i < rowsCount; i++)
            {
                for (int j = 0; j < colsCount; j++)
                {
                    Console.Write("{0} ", matrix[i][j]);
                }
                Console.WriteLine();
            }
        }
        finally
        {
            // Release allocated memory
            FreeMatrix(ptr, rowsCount, colsCount);
        }
    }

    private static IntPtr AllocateMatrix(int rowsCount, int colsCount)
    {
        IntPtr ptr = Marshal.AllocHGlobal(rowsCount * Marshal.SizeOf(typeof(IntPtr)));
        IntPtr[] rows = new IntPtr[rowsCount];
        for (int i = 0; i < rowsCount; i++)
        {
            int[] cols = new int[colsCount];
            rows[i] = Marshal.AllocHGlobal(colsCount * Marshal.SizeOf(typeof(int)));
            Marshal.Copy(cols, 0, rows[i], colsCount);
        }
        Marshal.Copy(rows, 0, ptr, rows.Length);
        return ptr;
    }

    private static int[][] GetMatrixFromPointer(IntPtr ptr, int rowsCount, int colsCount)
    {
        int[][] result = new int[rowsCount][];
        IntPtr[] rows = new IntPtr[rowsCount];
        Marshal.Copy(ptr, rows, 0, rowsCount);
        for (int i = 0; i < rowsCount; i++)
        {
            int[] cols = new int[colsCount];
            Marshal.Copy(rows[i], cols, 0, colsCount);
            result[i] = cols;
        }
        return result;
    }

    private static void FreeMatrix(IntPtr ptr, int rowsCount, int colsCount)
    {
        IntPtr[] rows = new IntPtr[rowsCount];
        Marshal.Copy(ptr, rows, 0, rowsCount);
        for (int i = 0; i < rowsCount; i++)
        {
            Marshal.FreeHGlobal(rows[i]);
        }
        Marshal.FreeHGlobal(ptr);
    }
} 
```

P/Invoke 是一个 PITA。我强烈建议您尽可能避免它，并且在不可能的情况下尝试以最小化编组数据的方式组织您的函数。

# .net - .NET 的开源 zip 库？

> ID：374396
> 
> 赞同：26
> 
> 时间：2008-12-17T12:28:59.050
> 
> 标签：.net, open-source, zip

有谁知道一个好的.NET 开源压缩库？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-12-17T12:31:27.220

[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)

关于内部gzip实现的评论和其他帖子，**它们是*不*一样的！**GZip 不会创建归档所需的标头；它仅对“压缩”一个文件或流有用。

正确的 zip 存档包含一个标题，其中列出了所有压缩文件以及它们在压缩数据中的位置，因此您需要制作标题的东西。这意味着 SharpZipLib，是众多商业版本之一，或者使用带有 .NET 绑定的外部软件，如 7zip。

只是偶然有人想说：“但我一直`.gz`在 Linux 中看到文件！” - 它们只是单个文件，`.tar.gz`也不例外 - tar 是存档文件。那`.gz`就是压缩的存档。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-04T03:27:15.687

情侣评论。

1.  不要使用 J# 运行时。J# 已被 Microsoft 停止使用。未来的支持值得怀疑。此外，当您想要的只是 ZIP 支持时，整个 J# 运行时是一个大难题。
2.  System.IO.Compression 中的 GzipStream 是自 .NET 2.0 以来的 .NET 基类库的一部分，它为[IETF RFC-1952](http://www.ietf.org/rfc1952.txt)压缩提供了流接口。压缩是可以的，虽然压缩比不是最优的，它会显着扩展之前压缩过的数据。此[错误已报告给 Microsoft，但显然已关闭](https://docs.microsoft.com/en-us/collaborate/connect-redirect)。还有一个 DeflateStream 类似，但适用于[RFC 1951](http://www.ietf.org/rfc1951.txt)。有一个常见的误解是 GZipStream 会压缩文件。不对。 **这两个都没有压缩文件。**
3.  有 System.IO.Packaging.ZipPackage。它可以工作，但主要用于打包 MS Office 2007（.docx、.xslx 和 .pptx）文件。它对于 zip 文件很笨拙，并且不支持很多 ZIP 功能，例如加密。
4.  如果您想以灵活的方式在 .NET 中创建和读取 zip 文件，目前您需要一个第三方库。

[**DotNetZip**](https://archive.codeplex.com/?p=dotnetzip)是一个很好的第 3 方选项。免费、开源、积极维护、使用简单、体积小、功能集好。它作为单个程序集交付 - 它是完全托管的代码。适用于 Compact Framework 以及常规 .NET Framework。先决条件是 .NET 2.0。

DotNetZip 还包括一个 ZLIB 库，其中包含 {Zlib,GZip,Deflate}Stream 等类。它们与 .NET 的内置类相当，但它们包括设置压缩级别的能力，并且在更高级别上，它们比内置类更有效地压缩。ZlibStream 执行[RFC 1950](http://www.ietf.org/rfc1950.txt)压缩。

DotNetZip 支持 ZIP64、密码、AES 加密、流、SFX 和 Unicode。每个使用它的人都说它比 SharpZipLib 使用起来简单得多。有一个很好的帮助文件 (.chm) 和很多代码示例。

[![DNZ CHM](https://i.stack.imgur.com/neX5h.png)](https://i.stack.imgur.com/neX5h.png)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-17T14:58:21.980

DotNet Zip 库 (Ionic.Zip.dll) 非常易于使用。我觉得它比 SharpZip 更容易实现。

[http://www.codeplex.com/DotNetZip](http://www.codeplex.com/DotNetZip)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-17T12:31:51.043

尝试签出[7-zip](http://www.7-zip.org/)。它是开源的，也是我最喜欢的 zip 程序。非常kewl。也利用了多核。

.NET SDK 可[在此处](http://www.7-zip.org/sdk.html)获得。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-17T12:46:06.363

**** 但是伙计们 .NET 已经支持开源 zip....****

[http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx)

这与 GZIP 库兼容。我用它来压缩 C# 数据并在 C++ 应用程序中跨网络解压缩。工作正常。

托尼

# c# - 事件订阅者是否按订阅顺序调用？

> ID：374398
> 
> 赞同：28
> 
> 时间：2008-12-17T12:29:10.643
> 
> 标签：c#, .net, events, .net-2.0, c#-2.0

假设按订阅顺序调用事件订阅者是否安全？
例子：

```
void One(object sender, EventArgs e) {}
void Two(object sender, EventArgs e) {}

event EventHandler foo;

foo += One;
foo += Two; 
```

触发事件时是否总是在 Two() 之前调用 One()？

编辑：
你当然不应该依赖它，我只是在想。这个想法是，多播委托类似于命令模式。所以我只是想知道。通常，您会使用一个保持命令顺序的集合，以便您可以执行撤消/重做/任何操作。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-12-17T12:41:02.880

鉴于该实现，是的，它们将始终按该顺序调用。

如果事件实际上使用了一些奇怪而美妙的方式来处理订阅，它可以做不同的事情——但“正常”的实现会做正确的事情。

需要明确的是，订阅事件处理程序只是意味着调用事件的适当“添加”部分。如果事件通过执行以下操作来处理此问题：

```
myHandler += value; 
```

被翻译成

```
myHandler = Delegate.Combine(myHandler, value); 
```

和[Delegate.Combine](http://msdn.microsoft.com/en-us/library/30cyx32c.aspx)保证排序。但是，如果您有这样的事件：

```
private LinkedList<EventHandler> eventHandlers = new LinkedList<EventHandler>;

public event EventHandler Foo
{
    add
    {
        eventHandlers.AddFirst(value);
    }
    remove
    {
        // do stuff here too
    }
} 
```

然后通过执行以下操作触发事件：

```
foreach (EventHandler handler in eventHandlers)
{
    handler(this, EventArgs.Empty);
} 
```

然后处理程序将以相反的顺序被调用。

**摘要**：对于所有理智的事件，您可以依赖排序。理论上，事件可以做他们喜欢做的事，但我从未见过*没有*保持适当顺序的事件。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-17T13:41:38.610

密切注意 Jon Skeet 给出的警告 - “鉴于该实施......”。换句话说，进行最轻微的更改（多线程、其他处理程序等），您就有可能失去执行顺序不变性。

*不要**依赖**事件排序*。所有事件分派在逻辑上应该是独立的，就好像它们是并行发生的一样。事件是逻辑上独立的动作。

我会更进一步，并断言如果您必须承担事件触发的顺序，那么您有一个严重的设计缺陷和/或滥用事件。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-17T13:02:56.003

即使以正确的顺序调用它们，我也会尽量不编写依赖于先前委托已被解雇以使其正常运行的代码。

如果 Two() 依赖于 One() 正在做的事情，那么要么附加一个以正确顺序调用这两个方法的委托，要么让 Two() 在必要时调用 One()。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T15:03:26.853

快速的回答是“这不关你的事”:)

事件本质上是异步的。这意味着您不是在等待事件被触发或期望它在给定时间发生。它们只是发生，然后你采取行动。想知道“何时”或试图弄清楚“如何”将打破这种本性。

也许在这种情况下，您不需要基于事件的方法来完成工作？

Jon Skeet 所说的在技术上对于当前的实现是正确的，但在 c#8.5 或 VBasic 15.0 中可能不会。依赖实施细节总是弊大于利。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-27T16:16:12.937

一般来说，事件订阅者的行为应该彼此独立。无论是按订阅顺序、反向订阅顺序还是以看似随机的顺序（每次引发事件时任意变化）调用它们都应该没有区别。订阅者不应该关心在他们之前或之后执行的其他订阅者。

然而，在某些情况下，事件可能会在这种排序很重要的上下文中使用。事件处理程序可能会被传递一个可变对象，并有望利用先前处理程序对该对象的突变。在这种情况下，如果事件的有意义的操作需要它们以特定的顺序执行，并且已经遵守了对订阅者的任何书面要求，那么人们应该期望事件将按照给定的顺序执行。

# c++ - 为什么我们实际上需要 C++ 中的 Private 或 Protected 继承？

> ID：374399
> 
> 赞同：67
> 
> 时间：2008-12-17T12:29:42.560
> 
> 标签：c++, inheritance, private, protected, c++-faq

在 C++ 中，我想不出我想从基类继承私有/受保护的情况：

```
class Base;
class Derived1 : private Base;
class Derived2 : protected Base; 
```

真的有用吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-17T12:40:08.810

当您想要访问基类的某些成员但又不想在类接口中公开它们时，它很有用。私有继承也可以看作是某种组合：[C++ faq-lite](http://www.parashift.com/c++-faq-lite/private-inheritance.html)给出了下面的例子来说明这个语句

```
class Engine {
 public:
   Engine(int numCylinders);
   void start();                 // Starts this Engine
};

class Car {
  public:
    Car() : e_(8) { }             // Initializes this Car with 8 cylinders
    void start() { e_.start(); }  // Start this Car by starting its Engine
  private:
    Engine e_;                    // Car has-a Engine
}; 
```

为了获得相同的语义，您还可以编写 car 类，如下所示：

```
class Car : private Engine {    // Car has-a Engine
 public:
   Car() : Engine(8) { }         // Initializes this Car with 8 cylinders
   using Engine::start;          // Start this Car by starting its Engine
}; 
```

但是，这种做法有几个缺点：

*   你的意图不太清楚
*   它可能导致滥用多重继承
*   它破坏了 Engine 类的封装，因为您可以访问其受保护的成员
*   您可以覆盖 Engine 虚拟方法，如果您的目标是简单的组合，这是您不想要的

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-12-17T12:36:30.067

私有在很多情况下都很有用。其中只有一项是政策：

[部分类模板专业化是这个设计问题的答案吗？](https://stackoverflow.com/questions/356294/is-partial-class-template-specialization-the-answer-to-this-design-problem#356576).

另一个有用的场合是禁止复制和分配：

```
struct noncopyable {
    private:
    noncopyable(noncopyable const&);
    noncopyable & operator=(noncopyable const&);
};

class my_noncopyable_type : noncopyable {
    // ...
}; 
```

因为我们不希望用户拥有指向`noncopyable*`我们对象的类型指针，所以我们私下派生。这不仅适用于不可复制的类，也适用于许多其他此类（策略是最常见的）。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-12-17T14:21:14.300

公共继承模型 IS-A。
非公共继承模型 IS-IMPLEMENTED-IN-TERMS-OF。
遏制模型HAS-A，相当于IS-IMPLEMENTED-IN-TERMS-OF。

[萨特的话题](http://www.gotw.ca/publications/mill06.htm)。他解释了当你选择非公共继承而不是包含实现细节时。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-17T16:01:34.380

例如，当您想重用实现而不是类的接口并覆盖其虚函数时。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-18T14:50:13.633

私有继承主要用于错误的原因。正如前面的回答中所指出的，人们将它用于 IS-IMPLEMENTED-IN-TERMS-OF，但根据我的经验，保留副本而不是从类继承总是更干净。另一个较早的答案，关于 CBigArray 的答案，提供了这种反模式的完美示例。

我意识到，由于过度使用“受保护”，has-a 可能会不起作用，但修复损坏的类比打破一个新的类更好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T16:03:51.630

我曾在某一时刻同时使用私有继承和受保护继承。

当您希望某些东西具有基类的行为，然后能够覆盖该功能，但您不希望全世界都知道并使用它时，私有继承很有用。您仍然可以通过让函数返回该接口来使用私有派生类的接口。当您可以让事物注册自己以侦听回调时，它也很有用，因为它们可以使用私有接口注册自己。

当您有一个从另一个类派生有用功能但您只希望其派生类能够使用它的基类时，受保护的继承特别有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-22T03:15:29.983

> 当您处理与 is-a 不相关的两个类时，私有继承很可能是一种合法的设计策略，其中一个类要么需要访问另一个的受保护成员，要么需要重新定义其一个或多个虚函数。

来自 Scott Meyers Effective C++ 3rd Edition page in 191。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-17T16:08:19.217

我曾经将这些数据结构实现为类：

*   链表
*   泛型数组（抽象）
*   简单数组（从泛型数组继承）
*   大数组（从泛型数组继承）

大数组的接口让它看起来像一个数组，然而，它实际上是一个固定大小的简单数组的链表。所以我这样声明：

```
template <typename T>
class CBigArray : public IArray, private CLnkList {
    // ... 
```

# java - 中文/日文机器是否支持 char*？

> ID：374405
> 
> 赞同：0
> 
> 时间：2008-12-17T12:31:40.403
> 
> 标签：java, string, winapi, dll, internationalization

我正在尝试使用 Java 和 JNI 创建一个用于身份验证的 DLL。

为了创建 DLL，我创建了一个 Win32 应用程序，其字符集和运行时库信息分别是多字节字符串和多线程 (/MT)。

我已经使用有效和无效的用户凭据在 WinXP 上测试了 DLL。两者都工作正常。

我需要知道相同的 DLL 是否也可以在中文/日文环境中工作。

谁能帮我解决这个问题？

提前致谢。

问候

杰根KS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T03:23:02.587

马丁写的是真的：

> 如果您只将字符串视为 blob，它应该可以正常工作。当您开始“逐个字符”（即逐个字节）访问它们时，如果您假设 C 字符是一个完整的字符，事情可能会出错。同样，如果您假设可以将中间的字符串拆分为两个子字符串，则可能会出错等。

但比这更糟糕。在日文或中文系统上运行只会使您的代码**更有可能**遇到多字节（非 ASCII）文本。即使在美国英语系统（最简单的情况）上运行，您的代码也完全有可能遇到多字节（非 ASCII）文本。不要假设用户界面中默认使用的字符串是您可能遇到的限制。

另请注意，将您的项目转换为“Unicode”（微软称它为）不会有帮助，因为微软选择的 Unicode 编码是 UTF-16，它有类似的问题（不太常见）。（在 UTF-16 中，要注意的术语是“代理对”。）

文本处理很难。一起去购物吧！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T12:59:52.373

如果您只将字符串视为 blob，它应该可以正常工作。当您开始“逐个字符”（即逐个字节）访问它们时，如果您假设 C 字符是一个完整的字符，事情可能会出错。同样，如果您假设可以将中间的字符串拆分为两个子字符串，则可能会出错等。

另外，一个问题是如何将 Java 字符串转换为这样的多字节字符串；这样做有正确和错误的方法。

# c++ - 是否有 Windows 复合文件的开源替代方案？

> ID：374417
> 
> 赞同：3
> 
> 时间：2008-12-17T12:37:23.777
> 
> 标签：c++, windows, open-source, containers, compound-file

我正在尝试将几个文件保存到一个容器文件中。这些文件可以稍后修改，这意味着容器可能必须扩大。用户应该只将此容器视为文件系统中的单个文件。该应用程序是用 C++ 编写并在 Windows 上运行，但文件也应该可以移植到其他平台。

容器格式的要求是：
1.*大小*：允许大于 4GB 的文件。
2.*可移植性*：在其他平台上打开容器文件应该是可行的。
3.*性能*：更改容器内的文件时，只有代表该特定文件的“块”可以更改。特别是，可能不会完全重写该文件。
4.*结构*：它应该提供一个目录结构，允许建立文件和目录的层次结构。

省略要求 1.) 和 2.) 复合文件（如 Word 和 Excel 使用的）非常适合。

当然，可以设计一个满足所有要求的 API，但我想知道是否已经有一些开源解决方案可以解决这个问题？

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-07T15:50:28.017

如果您使用 C++ 构建应用程序，您正在寻找的 HDF5 文件格式是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T12:51:02.610

谷歌搜索“便携式结构化存储”产生：[极](http://pole.berlios.de/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T12:40:29.013

一些存档格式（zip、bzip2）可能会完成这项工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T12:43:29.630

为了扩展 JF Sebastian 的答案，`tar`由于它不压缩，可能是一种更好的格式。它实际上只是一个容器。

不过，我不确定这些存档格式中的任何一种是如何可编辑的。玩一下[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)并找出答案，我猜 =)

# image - 在 Web 应用程序中保护图像媒体

> ID：374418
> 
> 赞同：6
> 
> 时间：2008-12-17T12:38:07.597
> 
> 标签：image, web-applications, media, protection

我们正在维护一个大型 Web 应用程序中的图像媒体数据库。高分辨率 jpg 文件很大（> 15MB），不得以任何方式下载。现在我们需要向客户端提供对图像细节（裁剪）的访问（如放大功能）。客户应该看到图像的缩小版本，并且能够选择要在全比例模式下查看的区域 (100%)。

如何以最高效的方式（流量和 CPU 方面）实现这一点？只要高分辨率图像文件仍然受到保护，我们愿意接受任何解决方案。该应用程序是在 c# 和 .net framework 3.5 中开发的。

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T12:43:37.133

您需要做的第一件事是在将图像上传到服务器之前对其进行压缩和加水印。然后将这些呈现给用户。这将占用最少的 CPU 资源，因为它们的图像将是静态的。

然后，我个人会将图像裁剪为全尺寸版本，并将它们与压缩后的图像放在一起。通过这种方式，客户可以查看完整图像（尽管已压缩和加水印）以及完整高分辨率版本的小样本。

您可能希望避免即时图像处理，除非您的客户端数量较少且服务器非常强大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T12:44:00.737

我会向浏览器提供图像的低分辨率版本，并有一个客户端裁剪 ui，然后将请求发送回服务器，服务器将裁剪选择并以高分辨率发送回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T12:55:02.323

就像我对我父亲说的那样（不明白互联网是如何运作的），如果你可以在网页上看到它，你可以保存它，这只是如何做的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T13:01:59.983

您可能会喜欢 Deep Zoom 的 ajax 版本 - 请参阅 Dragon：

[http://livelabs.com/seadragon-ajax/gallery/](http://livelabs.com/seadragon-ajax/gallery/)

向用户呈现图像的低分辨率版本；然后他们可以放大他们喜欢的任何部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T14:38:58.803

首先，我会预渲染所有全尺寸图像的水印版本，并将它们保存为压缩文件格式，以及预渲染的低分辨率版本。

我会为浏览提供低分辨率图像。然后水印高分辨率图像供用户设置裁剪。

在确认时，我将拥有第二个专用图像处理服务器，它裁剪非水印图像，将裁剪后的图像传递给网络服务器，然后将其发送给客户端。

话虽如此，仍然有可能创建一个客户端脚本，将裁剪的部分进行裁剪并将它们拼接在一起以创建无水印图像的全尺寸副本。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-17T13:53:34.653

> 不得以任何方式提供下载。

不符合：

> 客户应该看到图像的缩小版本，并且能够选择要在全比例模式下查看的区域 (100%)。

...在您允许以全分辨率查看图像的所有区域时，可以将整个图像拼接在一起。因此，您可以有效地（如果非常不便）使全尺寸图像可用。

但是，这些都不能帮助您实现目标。

我这样做的方法是提供一个 72dpi 水印副本，用于选择要下载的图像区域。如果屏幕空间是一个问题，您可以将其缩放到原始的 %。让用户选择左上角和右下角坐标。然后使用 imagemagick 之类的东西从原始文件中复制该区域以提供给用户。

如果您需要节省资源，您可以让用户从预定义的网格中下载，因此第一次选择网格坐标 14:11 时，image_1411_crop.jpg 被写入文件系统，下次选择该坐标时，文件已存在。

**编辑：**阅读您对其他答案的一些评论......

无论您采用何种方式生成和服务器端缓存，您都将使用相同数量的带宽和流量。300dpi jpeg 是 300dpi jpeg，无论它是刚刚生成还是位于文件系统上。

您必须确定是否需要节省 CPU 或磁盘空间。如果你有一百万个图像并且只有 40 个用户，你可以承受 CPU 的冲击。如果您有 40 张图片和一百万用户，请选择 HDD。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-12-17T12:41:56.687

我会使用[S3](http://aws.amazon.com/resources/)进行存储。创建两个存储桶（公共受保护），一旦您授权用户下载它们，就提供受保护存储桶图像的 url。S3 Urls 可以通过到期日期变得平静。

对于 15Mb 的图像，您可能会意识到您需要提前预生成缩放/裁剪的版本。

除了原始文件，我会在所有文件上使用某种水印。（如谷歌地图）

[编辑：为缩放添加了深度缩放]

查看 Silverlight **[Deep Zoom](http://msdn.microsoft.com/en-us/library/cc645050(VS.95).aspx)**以管理裁剪和缩放（[演示](http://www.vertigo.com/deepzoom.aspx)）。他们甚至有一个[实用程序](http://www.microsoft.com/downloads/details.aspx?familyid=457b17b7-52bf-4bda-87a3-fa8a4673f8bf&displaylang=en)来生成所有裁剪的图像。

# asp.net - 配置根目录内部 ASP.NET 服务器

> ID：374420
> 
> 赞同：1
> 
> 时间：2008-12-17T12:39:07.737
> 
> 标签：asp.net, visual-studio-2008

我的 ASP.NET 总是这样从内部服务器开始： [http://localhost:50793/Website/](http://localhost:50793/Website/)

我使用指向[http://localhost:50793/fckeditor 的 FckEditor](http://localhost:50793/fckeditor)

如何配置将我的文件夹“网站”作为根服务器的服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-17T12:43:38.007

在解决方案资源管理器中单击网站项目，然后在属性窗口中编辑“虚拟路径”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T14:01:12.827

当涉及到任何“Microsoft 管理”时，TechNet 通常是最好的查看位置。这个[ASP.net 管理员指南](http://technet.microsoft.com/en-us/library/cc787030.aspx)可能是一个很好的起点。

# php - 将 utf8 字符转换为 iso-88591 并返回 PHP

> ID：374425
> 
> 赞同：47
> 
> 时间：2008-12-17T12:40:49.573
> 
> 标签：php, encoding, utf-8, iso-8859-1

我的一些脚本使用不同的编码，当我尝试组合它们时，这已经成为一个问题。

但是我无法更改他们使用的编码，而是想更改脚本 A 的结果的编码，并将其用作脚本 B 中的参数。

那么：有什么简单的方法可以在 PHP 中将字符串从 UTF-8 更改为 ISO-88591？我看过 utf_encode 和 _decode，但它们并没有做我想要的。为什么不存在任何“utf2iso()”函数或类似函数？

我不认为我有不能用 ISO 格式编写的字符，所以这不应该是一个大问题。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2008-12-17T12:58:19.773

看看[`iconv()`](http://php.net/function.iconv)或[`mb_convert_encoding()`](http://php.net/function.mb-convert-encoding)。顺便说一句：为什么不[`utf8_encode()`](http://php.net/function.utf8-encode)为[`utf8_decode()`](http://php.net/function.utf8-decode)你工作？

> **utf8_decode** — 将使用 UTF-8 编码的 ISO-8859-1 字符的字符串转换为单字节 ISO-8859-1
> 
> **utf8_encode** — 将 ISO-8859-1 字符串编码为 UTF-8

所以本质上

```
$utf8 = 'ÄÖÜ'; // file must be UTF-8 encoded
$iso88591_1 = utf8_decode($utf8);
$iso88591_2 = iconv('UTF-8', 'ISO-8859-1', $utf8);
$iso88591_2 = mb_convert_encoding($utf8, 'ISO-8859-1', 'UTF-8');

$iso88591 = 'ÄÖÜ'; // file must be ISO-8859-1 encoded
$utf8_1 = utf8_encode($iso88591);
$utf8_2 = iconv('ISO-8859-1', 'UTF-8', $iso88591);
$utf8_2 = mb_convert_encoding($iso88591, 'UTF-8', 'ISO-8859-1'); 
```

所有人都应该这样做——`utf8_en/decode()`不需要特殊扩展，`mb_convert_encoding()`需要 ext/mbstring 和`iconv()`需要 ext/iconv。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T13:02:49.420

首先，不要使用不同的编码。它会导致混乱，而 UTF-8 绝对是你应该在任何地方使用的那个。

您的输入可能不是 ISO-8859-1，而是其他内容（ISO-8859-15、Windows-1252）。要从这些转换，请使用[iconv](http://php.net/manual/function.iconv.php)或[`mb_convert_encoding`](http://php.net/function.mb-convert-encoding).

尽管如此，`utf8_encode`并且`utf8_decode`应该适用于 ISO-8859-1。如果您可以将链接发布到转换失败或产生意外结果的文件或[uuencoded](http://php.net/manual/function.convert-uuencode.php)或[base64示例字符串，那就太好了。](http://php.net/manual/function.base64-encode.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-21T08:34:19.053

使用起来要好得多

$value = mb_convert_encode($value,'HTML-ENTITIES','UTF-8');

特别是当您使用 AJAX 调用提交“ISO-8859-1”字符时。它适用于中文、日文、捷克文、德文和更多语言。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-14T16:33:32.423

使用`html_entity_decode()`和`htmlentities()`。

```
$html = html_entity_decode(htmlentities($html, ENT_QUOTES, 'UTF-8'), ENT_QUOTES , 'ISO-8859-1'); 
```

`htmlentities()``UTF8`将您的输入`html_entity_decode()`格式化为`ISO-8859-1`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-24T13:30:32.317

将 head 中的元标记设置为

```
 <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /> 
```

使用链接[http://www.i18nqa.com/debug/utf8-debug.html](http://www.i18nqa.com/debug/utf8-debug.html)替换您想要的符号字符。

然后使用 str_replace 之类的

```
 $find = array('â€œ', 'â€™', 'â€¦', 'â€”', 'â€“', 'â€˜', 'Ã©', 'Â', 'â€¢', 'Ëœ', 'â€'); // en dash
                        $replace = array('“', '’', '…', '—', '–', '‘', 'é', '', '•', '˜', '”');
$content = str_replace($find, $replace, $content); 
```

它是我使用和帮助很多的方法。谢谢！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T12:56:21.523

您需要使用[iconv](http://www.php.net/iconv)包，特别是它的 iconv 功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-13T18:43:09.827

我用了：

```
function utf8_to_html ($data) {
    return preg_replace(
        array (
            '/ä/',
            '/ö/',
            '/ü/',
            '/é/',
            '/à/',
            '/è/'
        ),
        array (
            '&auml;',
            '&ouml;',
            '&uuml;',
            '&eacute;',
            '&agrave;',
            '&egrave;'
        ),
        $data 
    );
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-31T17:37:00.453

我使用这个功能：

```
function formatcell($data, $num, $fill=" ") {
    $data = trim($data);
    $data=str_replace(chr(13),' ',$data);
    $data=str_replace(chr(10),' ',$data);
    // translate UTF8 to English characters
    $data = iconv('UTF-8', 'ASCII//TRANSLIT', $data);
    $data = preg_replace("/[\'\"\^\~\`]/i", '', $data);

    // fill it up with spaces
    for ($i = strlen($data); $i < $num; $i++) {
        $data .= $fill;
    }
    // limit string to num characters
   $data = substr($data, 0, $num);

    return $data;
}

echo formatcell("YES UTF8 String Zürich", 25, 'x'); //YES UTF8 String ZÃ¼richxxx
echo formatcell("NON UTF8 String Zurich", 25, 'x'); //NON UTF8 String Zurichxxx 
```

[在我的博客http://www.unexpectedit.com/php/php-handling-non-english-characters-utf8](http://www.unexpectedit.com/php/php-handling-non-english-characters-utf8)中查看我的函数

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-30T22:21:46.970

就我而言，在上传名称包含这些字符的文件后，它们甚至在 Filezilla 中都不可见！在 Cpanel 文件管理器中，它们显示为 ? （黑色背景下）。这种组合使它在浏览器上正确显示（HTML 文档是西方编码的）：

```
$dspFileName = utf8_decode(htmlspecialchars(iconv(mb_internal_encoding(), 'utf-8', basename($thisFile['path']))) ); 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2012-12-07T12:53:55.303

```
function parseUtf8ToIso88591(&$string){
     if(!is_null($string)){
            $iso88591_1 = utf8_decode($string);
            $iso88591_2 = iconv('UTF-8', 'ISO-8859-1', $string);
            $string = mb_convert_encoding($string, 'ISO-8859-1', 'UTF-8');       
     }
} 
```

# objective-c - 如何获取 Mac OS X 上的默认临时目录？

> ID：374431
> 
> 赞同：23
> 
> 时间：2008-12-17T12:42:54.267
> 
> 标签：objective-c, macos, cocoa, test-data, temporary-directory

我想为一些单元测试创​​建一些数据目录，并且我希望这些目录位于用户的默认临时目录中。

我想我可以在 /tmp 下创建一个子目录，但我不想假设有人如何设置自己的机器。

我计划即时编写测试数据，这就是为什么我想把它放到一个临时目录中。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-17T14:07:03.877

不要使用`tmpnam()`或`tempnam()`。它们是不安全的（有关详细信息，请参见[手册页](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/tempnam.3.html)）。不要假设`/tmp`。[`NSTemporaryDirectory()`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html)与 结合使用[`mkdtemp()`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/mkdtemp.3.html)。 `NSTemporaryDirectory()`会给你一个更好的使用目录，但是它可以返回`nil`. 我使用了类似这样的代码：

```
NSString * tempDir = NSTemporaryDirectory();
if (tempDir == nil)
    tempDir = @"/tmp";

NSString * template = [tempDir stringByAppendingPathComponent: @"temp.XXXXXX"];
NSLog(@"Template: %@", template);
const char * fsTemplate = [template fileSystemRepresentation];
NSMutableData * bufferData = [NSMutableData dataWithBytes: fsTemplate
                                                   length: strlen(fsTemplate)+1];
char * buffer = [bufferData mutableBytes];
NSLog(@"FS Template: %s", buffer);
char * result = mkdtemp(buffer);
NSString * temporaryDirectory = [[NSFileManager defaultManager]
        stringWithFileSystemRepresentation: buffer
                                    length: strlen(buffer)]; 
```

您现在可以在`temporaryDirectory`. 删除`NSLogs`生产代码。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-03-21T22:17:34.540

回顾那里的这个问题和 NSTemporaryDirectory() 的文档，如果您使用的是 10.6 或更高版本，那么建议您使用 NSFileManager 中的[URLForDirectory:inDomain:appropriateForURL:create:error:](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSFileManager/URLForDirectory:inDomain:appropriateForURL:create:error:)方法，以获得更灵活的创建目录的方法.

它返回一个 URL 而不是字符串路径，这是我们推荐使用的另一件事。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-17T18:35:27.487

在 Objective-C 中，您可以使用 NSTemporaryDirectory()。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-17T12:47:46.080

使用[tempnam()、tmpnam() 或 tmpfile()](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man3/tempnam.3.html)函数。

# bash - 如果数字并不总是相同，如何在多个文件中增加一个数字？

> ID：374438
> 
> 赞同：4
> 
> 时间：2008-12-17T12:45:59.063
> 
> 标签：bash, search, scripting, replace, sed

我有几个包含这一行的文件

```
Release: X 
```

我想在所有文件中增加 X 。

如果 X 在文件之间是恒定的，我可以有一个 bash 脚本循环文件并执行 ($1 包含以前的版本号，$2 是新版本号，即 $1 + 1) ：

```
sed 's/Release: '$1'/Release: '$2'/' <$file >$file.new 
```

现在，如果文件之间的版本号不同，我该怎么办？

用 sed 可以吗？

我应该使用其他工具吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-17T12:55:17.953

使用`awk`- 它是完全正确的工具：

```
awk '/Release: [0-9]+/ { printf "Release: %d\n", $2+1 }' < $file > $file.new 
```

翻译：

*   搜索包含“Release:”后跟一位或多位数字的行。
*   打印“Release:”，后跟一个数字和一个换行符。数字是输入行中的第二个单词（数字）加 1。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-17T13:51:37.153

这个 perl one-liner 将与 awk 脚本执行相同的操作，但不会破坏文件的其余部分或包含版本的其余行。

```
 perl -pe "$_=~s/Release: (\d+)/'Release: '. ($1+1)/e;" < file > file.new 
```

# asp.net-mvc - 如何从视图中呈现不同控制器的操作？

> ID：374440
> 
> 赞同：2
> 
> 时间：2008-12-17T12:47:28.420
> 
> 标签：asp.net-mvc

我知道在一个视图中我可以使用 Html.RenderPartial 从同一个控制器渲染一个动作。但是，我需要在不同的控制器下渲染动作的输出。做这个的最好方式是什么？我宁愿直接在视图中执行此操作，而不是在控制器中执行此操作并将输出保存到 ViewData 变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T12:54:33.820

最好的办法是使用`Html.RenderAction`需要对“期货”程序集的引用，`Microsoft.Web.Mvc`其中[有一个关于如何获取它的问题](https://stackoverflow.com/questions/334408/where-to-get-microsoftwebmvcdll)。

您还需要在 web.config 中添加命名空间，以便在您的视图中使用它：

```
<add namespace="Microsoft.Web.Mvc"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T15:42:31.470

我会看看史蒂夫桑德森在[这里找到的“部分请求”的实现](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/)

# powershell - 如何使用 powershell 在 IIS 5.0 中创建应用程序？

> ID：374443
> 
> 赞同：0
> 
> 时间：2008-12-17T12:48:50.960
> 
> 标签：powershell, iis-5

我已经弄清楚了如何与 IIS 6.0 交互，但我在网上找不到任何关于如何与 IIS 5.0 对话的信息——如果真的有可能的话？

我想编写一个脚本来创建一个临时应用程序，所以我可以在那里复制一些 ASP.NET 文件，构建它们，然后删除临时应用程序。

如果需要，我很乐意改为调用第三方 VBScript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T12:52:26.010

在 ASP.NET 下载中曾经有一些安装程序可以在 IIS 5.0 中设置项目。我认为这是旧的 ASP.NET 论坛软件。我知道这不是你问题的答案。

如果我是一个赌徒，我会说他们可能创建了一个使用 VBScripts 的批处理文件。因为我记得弹出一个黑色窗口来编译和部署。

就 PowerShell 而言，我认为没有任何与 IIS 5 集成的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T12:57:24.877

[我可以在 IIS 5 中自动创建 .NET Web 应用程序/虚拟目录吗？](https://stackoverflow.com/questions/371207/can-i-automate-creating-a-net-web-application-virtual-directory-in-iis-5#371264)

# sql-server-2005 - MARS（多个活动结果集）的缺点？

> ID：374444
> 
> 赞同：92
> 
> 时间：2008-12-17T12:49:04.627
> 
> 标签：sql-server-2005, sql-server-mars

有谁知道 MARS（多个活动结果集）的任何缺点？有谁知道为什么应该避免使用 MARS，例如游标比 MARS 更有用的情况。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-09T00:49:25.490

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T13:15:27.087

*   与一次连接一个连接相比，它需要稍微多一点的服务器资源。
*   您必须运行 SQL Server 2005 或更高版本。所以这在遗留（ack！）环境中可能是一个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T13:05:14.890

取决于什么？没有真正的缺点。

他们不支持事务保存点。但我不认为这是一个缺点。

# java - 我应该用 Erlang 编写自己的闪存服务器还是使用 Red5？

> ID：374445
> 
> 赞同：2
> 
> 时间：2008-12-17T12:49:21.850
> 
> 标签：java, flash, erlang, red5, online-game

我是一名学生，即将开始我的考试项目，我将负责针对 Flash 播放器的在线游戏的服务器实现。我很难决定是应该用 Erlang 编写自己的轻量级服务器还是使用开源 Red5。

我的经验是，Java 开发人员倾向于过度复杂化使 API 难以使用的事情，这对 Red5 来说是真的吗？它在同步游戏带来的繁重负载下表现如何？

也许我自己的 Erlang 服务器会更容易在多台机器上使用和分发？

所以问题是我应该编写自己的 Erlang 闪存服务器还是使用现有的 Red5？

编辑：我想我需要决定我的目标是什么：只是建立一个在线游戏或学习如何从头开始实现多用户服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T13:01:59.797

我认为您需要自己估算实现自己的轻量级服务器的工作量。通常，自己的需求很小且很具体，实现满足它们的服务器是可行的方法。

还可以查看 Blaze DS（Java 闪存服务器）和 Juggernaut（Ruby 闪存服务器）。我认为也许主宰的目标是特定用途，超出你的范围，但我不确定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T13:52:30.270

如果你对 Java 编程没问题，我会说使用 Red5 - 实现你自己的服务器可能感觉微不足道，但我猜你可能会发现它有比你现在想的更多的东西。

然而，如果你想用 erlang 编程并认为开发自己的服务器会很有趣，那就去吧！

这也取决于您项目的目标——您是否必须证明您可以进行在线游戏（选择 Red5），或者您是否必须证明您可以编写分布式多用户游戏服务器？（去你自己用 Erlang 编程的项目）

顺便说一句：我正在将[http://www.smartfoxserver.com/](http://www.smartfoxserver.com/)用于我当前的一个项目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T14:14:33.130

为什么要重新发明轮子？单独的 AMF 是一个复杂的实现，只需查看文档以了解整数编码等基本内容......如果您不需要流功能并且 AMF 就是您想要的，您也可以使用 PyAMF (Python) 或AMFPHP。此外，您可能会根据游戏最终的运行方式来评分，而不是根据您重新实现 AMF 的聪明程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-31T08:56:44.600

如果您访问[http://www.stripclubcity.com/](http://www.stripclubcity.com/)或更具体地说是[http://www.stripclubcity.com/new-jersey-strip-clubs](http://www.stripclubcity.com/new-jersey-strip-clubs)，他们正在使用 Red5 流式传输他们的摄像头。我想我读到使用 Red5 比编写自己的 AMF 容易得多……为什么要重新发明轮子？

# delphi - WideString 是否与 Delphi 2009 中的 String 相同

> ID：374446
> 
> 赞同：13
> 
> 时间：2008-12-17T12:49:37.713
> 
> 标签：delphi, unicode, delphi-2009

我在 2009 年重新编译一些在不同点使用宽字符串的应用程序时遇到了一些奇怪的行为。

在 Delphi 2009 应用程序中 Widestring 与 String 相同吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-17T12:55:11.323

不，它们不相同。

`WideString`只是 ActiveX/COM`BSTR`类型的包装器。在 ActiveX/COM 中处理字符串时需要它。

`String`在 Delphi 2009 及更高版本中是 . 的别名`UnicodeString`，它可以包含 Unicode 字符，`BSTR`就像`WideString`. `WideString`由 COM 内存管理器分配，不计入引用。 `UnicodeString`由 RTL 内存管理器分配，并且是引用计数的，就像`AnsiString`is。

您应该`(Unicode)String`尽可能使用，并且仅`WideString`用于 COM 互操作，或处理`WideString`用于 Unicode 支持的遗留库。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-17T12:56:06.000

似乎答案就[在这里](http://www.micro-isv.asia/2008/08/get-ready-for-delphi-2009-and-unicode/)：

> Delphi 2009 中最显着的变化是“string”类型现在是 UnicodeString 而不是 AnsiString 的别名。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-17T20:48:36.267

另一件需要注意的重要事情是性能差异。

在 Marco Cantu 的白皮书中（在 moodforaday 的回答中提到）说：

> “WideString 过去（现在仍然）没有引用计数，并且在性能和灵活性方面极差（例如，它使用 Windows 全局内存分配器而不是本机 FastMM4）。”

我见过的几乎所有 Delphi 2009 升级指南都建议您将所有 WideStrings 转换为字符串。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T20:20:52.657

请参阅 Marco Cantu 的这篇论文，其中概述了 Delphi 2009 中字符串（即 UnicodeString）的工作原理：

“白皮书：Delphi 和 Unicode”

[http://dn.codegear.com/article/38980](http://dn.codegear.com/article/38980)

基本上，这就是罗迪所说的，但需要 27 页才能详细说明。

# delphi - 如何使用在设计时接受其他控件的子面板创建自定义控件？

> ID：374451
> 
> 赞同：6
> 
> 时间：2008-12-17T12:52:29.627
> 
> 标签：delphi, custom-component

我写了一个自定义控件，它有几个子面板。我希望这些子面板能够接受在设计时放置在它们上面的任何附加控件。

不幸的是，在设计时删除的任何控件最终都会出现在我的自定义控件上，而不是面板上。如果我尝试删除标签，这尤其显示：标签的蓝点已显示，但标题未显示，如果我取消选择标签，则根本不再可见。

简化代码（只有一个子面板）：

```
type
  TMyContainer = class(TPanel)
    p_SubPanel: TPanel;
  public
    constructor Create(_Owner: TComponent); override;
  end;

  constructor TMyContainer.Create(_Owner: TComponent);
  begin
    inherited;
    p_SubPanel := TPanel.Create(Self);
    p_SubPanel.Parent := Self;
    p_SubPanel.Align := alClient;
  end; 
```

我在这里做错了什么？

（以防万一：我使用的是 Delphi 2007。）

[编辑]

我现在以不同的方式解决了它。该组件不再包含面板，而是指外部面板。这使得它实际上更加灵活，但不利的一面是它不再那么直观易用。

我仍然想知道如何完成我最初描述的内容。是不是有一个开源组件可以做到这一点，所以我可以研究源代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T01:15:24.187

这是一个很好的问题。您可以通过将 csAcceptControls 添加到控件的 ControlStyle 属性来允许您的自定义 TWinControl 在设计时将其他控件拖放到其上。

```
constructor TMyContainer.Create(AOwner: TComponent);
begin
  inherited;
  ControlStyle := ControlStyle + [csAcceptControls];
end; 
```

但是在尝试解决这个问题时，我未能成功地将控件拖放到自定义控件中的子面板上。将 csAcceptControls 添加到子面板的 ControlStyle 是不够的。我得到的 cloest 是一个 hack，可以说服子面板它的设计是这样的：

```
type
  TGiveMeProtected_Component = class(TComponent);

procedure TMyContainer.Create(AOwner: TComponent);
begin
  FSubPanel := TPanel.Create(Self);
  TGiveMeProtected_Component(FSubPanel).SetDesigning(True, True);
end; 
```

使用该代码，您现在可以将控件拖放到子面板上，但这意味着您也可以选择子面板，更改它的属性，甚至删除您绝对不想要的它。对不起，我无法想出答案，我仍然很想知道你是否解决了这个问题。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:33:43.080

我无法从细节中看出，但是您是否将标签的父级设置为您的子面板？如果在设计时，您可能需要在主组件（例如面板所在的容器）中编写代码，以确定哪个子面板正在接受该组件并将标签父属性设置为该子面板。

我很确定当从另一个组件中添加或删除组件时会调用通知方法，这应该可以帮助您跟踪需要放置代码的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-27T13:48:15.807

我这样做了，但最终用常规面板替换了控件，这些面板将在需要时显示/隐藏。

我的控件不是从 TPanel 下降，而是从 TCustomControl 下降。我不认为我可以让它从 TPanel 下降，但不记得问题是什么。

**容器控制：**

```
TPageControl = class(TCustomControl)
private
  PageList:TObjectList;  // To hold references to all sub-pages for easy access.
end;

constructor TPageControl.Create(AOwner: TComponent);
begin
  inherited;
  ControlStyle := ControlStyle + [csAcceptsControls];
  PageList := TObjectList.Create;
  PageList.OwnsObjects := false;
end;

destructor TVstPageControl.Destroy;
begin
  PageList.Free;
  inherited;
end;

procedure TPageControl.NewPage;
var
  Page:TPage;
begin
  Page := TPage.Create(Self.Owner);
  Page.Parent := Self;
  Page.Align := alClient;

  PageList.Add(Page);
end;

procedure TPageControl.DeletePage(Index:integer);
var
  Page:TPage;
begin
  Page := PageList[Index] as TPage;
  Page.Free;
  PageList.Delete(Index);
end; 
```

**页面/子面板控件：**

```
TVstPage = class(TCustomControl)
public
  constructor Create(AOwner: TComponent); override;
end;

constructor TPage.Create(AOwner: TComponent);
begin
  inherited;
  ControlStyle := ControlStyle + [csAcceptsControls];
end; 
```

# language-agnostic - 为什么要使用基于消息的系统？

> ID：374464
> 
> 赞同：16
> 
> 时间：2008-12-17T12:59:34.450
> 
> 标签：language-agnostic, messages, servicebus

使用基于消息的系统的动机是什么？

我看到了很多关于[NServiceBus](http://www.nservicebus.com/)和[Mass Transit](http://code.google.com/p/masstransit/)等服务总线的信息，我想知道底层方法的好处是什么。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-17T13:31:47.083

使用基于消息的系统有很多优点。

1.  消息在应用程序之间形成定义明确的技术中立接口。
2.  启用应用程序的松散耦合。
3.  性能、调整和扩展的许多选项：
    *   在不同的硬件上部署请求者和服务进程
    *   多个请求者共享单个服务器
    *   多个请求者共享多个服务器
4.  各种消息传递中间件独立于您的应用程序实现常见的消息传递模式。
    *   请求/回复
    *   Fire and Forget 离线更新
    *   发布/订阅
5.  许多中间件产品处理消息转换（例如 SWIFT 到 SWIFTXML）。
6.  许多中间件产品可以将单个大请求分解为几个较小的请求。
7.  它们几乎都支持多个平台。

顺便说一句，该领域的两个市场领导者是 IBM 及其 Websphere MQ 和相关产品，以及 TIBCO 及其企业服务总线。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-17T13:39:38.237

基于消息的架构在时间和空间上将消息的生产者和消费者分离。这有很多好处：

*   生产者和消费者可以在不同的机器上运行
*   生产者和消费者可以在不同的时间运行。
*   生产者和消费者可以运行在不同的硬件/软件平台上（他们只需要了解相同的消息协议）
*   协调多个生产者/消费者很容易（例如，对于需要多台机器的计算密集型作业，正如 Dave Markle 所描述的）
*   当服务暂时不可用时具有更高的稳定性（例如，在处理订单时，使用消息系统可以帮助避免“丢弃”订单）

当您进行 RPC 风格的通信时（即在等待服务响应时阻塞），您将失去大部分这些好处

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-17T13:12:43.800

一个用例是当您拥有一个可以处理给定项目的资源池以及需要以可扩展方式分发的工作列表时。

我曾经有一个项目，我必须将大型机与许多 3270 屏幕刮板（都很慢）进行集成。我一次最多可以在一个盒子上打开 10 个这样的进程。我有数千个帐户要进行屏幕抓取和更新，所以我将工作放在一个队列中，我的机器（我有大约 3 个）刚刚从消息队列 (MSMQ) 中提取工作项并进行屏幕抓取，就是这样。我可以轻松地启动一台新机器，或者在不中断工作流程的情况下停用旧机器，这很好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T13:43:00.837

好处实际上在于解耦应用程序的各个部分。设置总线并添加应用程序后，您可以通过添加新的部分轻松扩展您的应用程序，您可以保证不会影响其他部分。随着时间的推移，它是一种持续添加到系统的非常好的方法。

例如。我们有一个这样的系统，每个命令都是作为整个 GUI 的一部分实现的，如果我们想添加新功能或修改现有功能，我们只需编写一个新部分并将其添加到系统中。当它被调用时，它不依赖于其余部分。这意味着我们可以非常轻松地扩展我们的应用程序。此外，我们在网络上的节点之间传递了一条消息 - 当一台计算机中的某些内容发生更改时，会向所有其他计算机发送一条消息，以便他们可以更新自己。对于不同的事件，我们有一百种不同的消息，因此我们可以通过添加一个对适当消息作出反应的新服务来扩展系统。

消息传递架构通常具有与 Web 服务相同的功能，您可以调用离散服务，可以轻松添加新服务。

不要认为消息传递架构需要花哨（而且昂贵！）的中间件产品，Windows 运行在消息传递架构上 - 每个传递给窗口的 WM_* 消息都是.. 一个消息，我认为这是最好的架构示例 - 系统的任何部分都不需要了解任何其他部分，您可以无限扩展它，因为您可以在任何对话框等上处理任意数量的控件等。

消息传递是一个很棒的架构，虽然它可能比将应用程序紧密耦合在一起要慢，但这并不是现在不使用它的理由，特别是如果你已经在使用脚本或 .net 应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T13:13:58.540

我帮助为使用 C# 和 Remoting 的系统开发了一个，客户端（服务或 GUI）可以发送包含一些自定义数据的消息，并且接收者会在下次连接时或立即接收它）。然后他们可以处理该消息（在负载平衡服务的情况下通过获取它的所有权）。它还用于在长时间运行的进程完成时更新 GUI。

消息传递系统本身具有处理每条消息的可配置管道，以下是我们开发的一些管道的一些示例：

*   存储（创建/保存消息到数据库）
*   路由（确定需要发送消息的位置）
*   安全性（如果允许客户端接收它，则计算出来）
*   删除（确定是否需要从系统中删除消息，这意味着需要通知客户端并将消息从缓存中删除并在数据库中标记）。
*   TakeOwnership（确保一次只有一个客户端可以修改消息的状态，因为只有拥有的消息可以更改）

因此，在回答您的问题时，消息系统是发送有关您何时不知道或不关心客户是谁的信息的绝妙方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T13:42:47.593

面向消息的系统通常适用于某些类型的集成问题。其他替代方案是拥有一个共享数据存储（可能基于文件或数据库）供应用程序进行通信或通过 RPC 集成应用程序。

与这些集成模式相比，消息传递的优势在于您不会将两个应用程序耦合到相同的数据存储模式，并且您不会将应用程序绑定到点对点 RPC 集成场景（涉及的应用程序越多，这种场景就越复杂）。

还有异步通信（如电子邮件与在线聊天）以及消息路由和转换可能性的好处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-14T21:09:45.080

有一个主要问题，那就是可靠性。在分布式系统中，同步调用可能会失败，下游系统会过载。然后，所有下游系统都需要调整为来自上游的负载，这是不切实际的。消息系统可以处理峰值。更好的是除了消息系统之外还使用负载均衡器。虽然下游应用程序正在自动扩展（这可能需要几分钟），但消息传递系统可以负责可靠地存储峰值。此外，消息传递系统和可靠地执行 pub-sub。想象一下，如果有数以千计的交易即将发送给数百名交易者……使用 pub-sub 轻松完成。所以有效的词是可靠性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-21T15:19:44.467

我建议看看这篇博文。它展示了端到端的工作流程，并解释了我们如何以编程方式集成消息传递平台。

[https://eduwebmonster.com/implementing-message-based-communication-in-modern-application-architecture/](https://eduwebmonster.com/implementing-message-based-communication-in-modern-application-architecture/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-22T19:29:37.020

基于消息的系统可以为您业务的整个数字方面奠定基础。如今，拥有无缝集成的数字解决方案对于收集、存储和分析数据至关重要，并且在涉及业务流程时，您的数据可以帮助您做出最明智的决策，这一点至关重要。本质上，基于消息的服务是一种 API（应用程序编程接口）形式，可以将请求以消息的形式从一个应用程序发送到另一个应用程序。使用基于消息的系统意味着您的所有数字解决方案都可以轻松连接，并且它们将相互可靠地通信。

请求可以发送到系统内的任何端点，一旦验证，它们可以同时通过多个路径发送。与一次只能使用一个路径的传统请求/响应模型相比，这大大加快了流程。借助 TIBCO 消息传递等服务，您可以跨多种 API 进行通信，支持移动和 IoT 设备，根据需要扩展消息传递服务，并简化应用程序开发和采用。当然，该平台还提供了一个安全的消息传递环境，因此您可以放心，您的数据只会在您自己的应用程序之间共享，用于您指定的目的。

# java - 在 Java 中使用 Postgres 内存不足

> ID：374478
> 
> 赞同：2
> 
> 时间：2008-12-17T13:04:00.917
> 
> 标签：java, postgresql, memory

好吧，我们有一个运行在 JBoss 上的 Web 应用程序，当尝试在 postgres 数据库的多个表中插入大量行时，我们遇到了“OutOfMemory”错误。这是此错误的完整环境：
* JBoss 4.3.x GA
* Java 1.6.0
* Hibernate 3.0
* postgreSQL-8.3（驱动程序）
关于实际代码工作环境：
* 关于这一点的重要部分是我们正在解析大量的 xml 文档，每个文档都是从特定的 URL 单独下载的（1 个 URL = 1 个 XML）。我们通过使用 EJB 将生成的 URL 分发到队列中来实现这一点，然后 MDB 池使用流连接并生成文档（请注意，由于 XML 文档的大小，我们实际上不得不增加堆栈内存，而且我们正在坚持必须在一个流中获取所有文档），一旦生成文档，它就会进入另一个队列，另一个 MDB 池在该队列中侦听。
这些 MDB 解析文档，将信息存储在几个实体（至少 5 个）中，然后持久保存在数据库中（请注意，事务管理设置为*“BEAN”*并在每个 MDB 工作期间开始并提交）。按顺序处理 URL 不是一种选择，因为要处理的 URL 数量很大，大约需要 2 个月左右......哈哈

麻烦的是......我们解析和存储大约 200 个 URL 并开始出现 postgreSQL 的内存不足错误。有任何想法吗？？

提前致谢！！

另外：知道这个错误之前没有出现（我之前确实解析了数千个 XML）可能很有用，只生成文档并将其中的一些解析为一些实体似乎并没有带来麻烦。当我们开始将越来越多的文档解析为其对应的实体时，麻烦就开始了。（就像一个具有“特征”列表的实体[从同一 xml 解析的其他实体]）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T13:18:59.340

听起来您将所有 200 个文档的所有 bean 都保存在内存中。

与其将所有数据一直保存在 RAM 中，不如尝试尽快将其删除。

因此，当您完成读取某个 bean 的数据时，将其持久化然后忘记它（将对象引用设置为 null），除了可能需要创建引用的键。

如果您无法做到这一点，请使用分析器确保在解析文档后不保留对文档的引用。通常，将整个文档保存在数据库中后，您不需要将其保存在任何地方。如果这是一个问题，请创建一个带有引用的表，它允许您在文档之间链接，并将该表中的键保存在内存中（而不是整个文档）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T13:23:44.293

简短的回答是需要更多信息。我建议使用[JProfiler 之](http://www.ej-technologies.com/products/jprofiler/overview.html)类的工具来帮助了解消耗内存的位置。

根据您描述的设计：为什么使用两个池？如果您只有一个 URL 池，那么工作线程可以从该池中提取，解析 URL 并创建实体 bean，将它们保存到数据库中。

不清楚为什么需要中间 XML 步骤，这听起来可能是高内存消耗的来源。

# python - 作为单元测试部分示例的 python 真实项目在哪里？

> ID：374480
> 
> 赞同：6
> 
> 时间：2008-12-17T13:05:08.277
> 
> 标签：python, unit-testing

我正在寻找一个 python 项目作为示例来复制单元测试部分的设计。

该项目应具有以下功能：

1.  它的代码几乎是完全单元测试的
2.  代码分布在许多包中，还有不止一层包
3.  所有测试都可以用一个命令运行，例如`python test.py`

我需要项目应该对包含的所有代码使用相同的测试约定。我看到了整个 python 项目，但是各种包都用不同的约定进行了测试。例如 setuptools 包使用 unittest 库的临时改编，而其他包则没有。

我需要该项目不使用临时或高度定制的测试框架，因为我想在我的项目中重用它的测试架构。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T13:23:52.047

也许[鼻子](http://code.google.com/p/python-nose/)本身？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-20T03:43:25.563

[Django](http://www.djangoproject.com/)是一个干净的项目，具有很好的单元测试范围。

[看看](http://docs.djangoproject.com/en/dev/topics/testing/#topics-testing)他们如何建议您测试自己的项目。

[看看](http://code.djangoproject.com/browser/django/trunk/tests)框架本身的单元测试代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T13:27:04.893

好吧，您的规范直接指向了一个有点著名的开源项目[Python 库](http://svn.python.org/view/python/trunk/Lib/)。查看[python/trunk/Lib/test/regrtest.py](http://svn.python.org/view/python/trunk/Lib/test/regrtest.py?rev=63042&view=markup)，它将在[测试目录](http://svn.python.org/view/python/trunk/Lib/test/)中找到所有名称为“test_*”的模块，并运行它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T13:33:06.723

首先，阅读[unittest](http://www.python.org/doc/2.5.2/lib/module-unittest.html)。该文档包含示例。

其次，由于您想要包（而不是模块），因此列表更短。Python 2.5 发行版中有 15 个包。随机选择一个。这是一个可能符合您的某些标准的子集。

*   bsddb：7 个模块 - 许多测试 - test_all.py

*   ctypes：4个模块-测试-runtests.py

*   distutils：许多模块 - 测试 - test_dist.py

*   电子邮件：许多模块 - 测试 - test_email.py

*   sqlite3 - 2 个模块 - 测试 - （不清楚是否有整体测试，我看腻了）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-08T04:49:19.647

你可以查看python的源码。其中大部分是用python编写的。特别是单元测试模块。

<rant>python 模块组织和单元测试尤其是一种魔法。它让我想起了 perl（每个基本事物的奇怪、未记录的解决方法——unittest 手册甚至从未显示如何导入外部模块）和 java（限制性目录和命名约定）</rant>

查看[unittest 模块](https://hg.python.org/unittest2)的单元测试设置。（没有源浏览，你必须到`hg clone`那个网址）

这是用于启动单元测试的 setup.py 部分，除了那里的所有其他内容：

```
# above here, juggle paths
from setuptools import setup
params['entry_points'] = {
    'console_scripts': [
        'unit2 = unittest2.__main__:main_',
    ],
}

params['test_suite'] = 'unittest2.collector'

setup(**params) 
```

甚至他们所做的一切仍然不足以简单地运行`setup.py test`。您将了解到大多数团队已经放弃了您的要求，只需在项目中添加一个 test_run.py 或类似的东西。我知道我参与的所有项目。

再看看上面的鼻子答案，这是一个很好的答案，尽管有一些 2、3、2to3 支持热潮，但它们的 setup.py 非常干净。这是一个旨在使单元测试（和一般测试）更容易和更方便的项目。好吧，即使他们`selftest.py`在项目根目录中也有一个脚本来尝试启动测试。

# javascript - 在 Opera 中使用 JavaScript “添加到收藏夹”

> ID：374487
> 
> 赞同：4
> 
> 时间：2008-12-17T13:10:22.150
> 
> 标签：javascript, opera

如何在 Opera 中进行这项工作？我为 Opera 找到了这段代码，但它对我不起作用：

```
 function AddToFavorites(title, url) {

    if (window.sidebar) { // Mozilla Firefox Bookmark
        window.sidebar.addPanel(title, url,"");
        return false;
    } 
    else if( window.external ) { // IE Favorite
        window.external.AddFavorite( url, title); 
        return false;
    }
    else if(window.opera && window.print) { // Opera Hotlist
                var elem = document.createElement('a');
                elem.setAttribute('href',url);
                elem.setAttribute('title',title);
                elem.setAttribute('rel','sidebar');
                elem.click();
                return false;
    }
 } 
```

Dragonfly 错误控制台是静默的，没有发生错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T23:13:42.573

*如果*你坚持，那就不要动态生成冗余链接：

```
 <a href="http://real.url.example.com" title="Bookmark me, pleaeease!" 
    rel="sidebar"
    onclick="return !addToFav(this.href,this.title)"> 
```

但是请不要这样做。

作为 Opera 用户，我会很感激没有推动这种时尚——如果我选择的话，我可以轻松地将标签拖放到书签栏/面板/快速。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T20:00:22.633

***Opera 强制执行相同的用户事件要求***以允许添加书签，因此您的代码将无法工作，因为用户从未点击过您刚刚创建的链接。

你需要更多这样的东西：

```
function AddToFavorites(obj, title, url){
  if(window.sidebar){
    // Mozilla Firefox Bookmark
    window.sidebar.addPanel(title, url,"");
    return false;
  } else if(window.external){
    // IE Favorite
    window.external.AddFavorite( url, title);
    return false;
  } else if(window.opera && window.print){
    //Opera Hotlist
    obj.setAttribute('href',url);
    obj.setAttribute('title',title);
    obj.setAttribute('rel','sidebar');
    obj.click();
    return false;
  }
} 
```

打电话给

```
<a href="#" onclick="AddToFavorites(this, 'your title', 'your url');">Bookmark This Page</a> 
```

（随意制作更不显眼，我只是想表明用户事件的要求）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-06T06:29:07.557

在 Opera 10 中获取“添加到收藏夹”链接工作的方法是动态添加**rel**属性到链接

```
$('#add_to_favs').attr('rel','sidebar'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T14:44:48.683

以下代码适用于 Opera 8.54。它不适用于 9.27 或 9.63（我仅有的两个可用于测试的其他版本）。在 9.27 和 9.63 中，它只是将您导航到 Yahoo!：

```
var url = 'http://www.yahoo.com/';
var title = 'Yahoo!';
var elem = document.createElement('a');
elem.setAttribute('href', url);
elem.setAttribute('title', title);
elem.setAttribute('rel', 'sidebar');
elem.click(); 
```

我*怀疑*他们删除了在没有用户启动的情况下添加书签/收藏夹的功能。由于您已经可以强制浏览器导航到新的 URL `window.location`，因此这可能不被视为 DoS 漏洞。

如果用户单击链接，以下工作正常：

```
var url = 'http://www.yahoo.com/';
var title = 'Yahoo!';
var elem = document.createElement('a');
elem.setAttribute('href', url);
elem.setAttribute('title', title);
elem.setAttribute('rel', 'sidebar');
elem.appendChild(document.createTextNode('Add Bookmark'));
document.getElementsByTagName('body')[0].appendChild(elem); 
```

此外，`window.external.AddFavorite(url, title);`不再允许在 Internet Explorer 8 Beta 2 中添加非用户发起的收藏夹。但是，如果您将其作为`onclick`链接事件包含，它可以正常工作：

```
<a href="http://www.yahoo.com/" title="Yahoo!" onclick="window.external.AddFavorite(this.href, this.title);return false;">Add to Favorites</a> 
```

Firefox 2.0.0.18 和 3.0.4 目前都支持非用户发起的书签添加，但看到他们在未来的版本中删除它我不会感到惊讶。

我认为，在不点击链接或采取明确行动的情况下，试图强迫网站访问者添加收藏夹/书签被认为是一种糟糕的形式，而且有点粗鲁。仅仅访问一个网站并不足以迫使这些访问者为其添加收藏夹/书签。

# c# - 允许用户在 TextBox 中插入 TAB 但不允许换行

> ID：374493
> 
> 赞同：2
> 
> 时间：2008-12-17T13:12:25.093
> 
> 标签：c#, .net, textbox, tabs

我想要一个接受 TAB 键的 TextBox（并相应地将 TAB、ASCII 0x09、\t 放入文本框中），而不是跳转到下一个控件。TextBox 有一个属性 AcceptsTab，我已将其设置为 true，但这并没有给出所需的结果。事实证明，AcceptsTab 属性仅在 Multiline 设置为 true 时才有效。但是我想要一个不接受换行符的单行文本框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T15:16:09.963

这就是你要做的。创建您自己的继承自 TextBox 的类。在构造函数中，将 multiline 设置为 true，并将 AcceptsTab 设置为 true。然后，覆盖 WndProc 并使用以下代码：

```
 protected override void WndProc(ref Message m)
        {
            if (m.Msg == (int)0x102 && m.WParam.ToInt32() == 13)
            {
                return;
            }

            base.WndProc(ref m);
        } 
```

这将阻止输入键被接受，因此不会创建新行。哈基？是的，但它会工作..

编辑：我将解释这段代码的作用。当发生某些事情时，每个窗口窗体和控件都会收到一条窗口消息，例如绘画、按键等……在这种情况下，我正在寻找一条 WM_CHAR 消息（即 0x102），它是告诉 TextBox 哪个消息键被按下。如果这是消息，并且 WParam == 13，那么这意味着 Enter 被按下，在这种情况下，返回，什么都不做。否则，按预期恢复。说得通？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T13:20:50.973

将多行选择为 true 并将行大小设置为 1。您将获得所需的结果。

# c# - 添加额外的列以填充datagridview C#中的空间

> ID：374496
> 
> 赞同：0
> 
> 时间：2008-12-17T13:13:09.307
> 
> 标签：c#, .net, winforms, datagridview

我有一个将 DataTable 绑定到的 datagridview。我想要做的是添加一个额外的列，它将填补 windows 窗体中的剩余空白。目前我只有 3 列，所以所有列的宽度只有窗口窗体大小的一半左右。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T13:39:05.417

将 DataTable 数据绑定到 DataGridView 后，将所需列的 AutoSizeMode 设置为 Fill。

```
 DataTable dt = new DataTable("Table1");
        dt.Columns.Add("A");
        dt.Columns.Add("B");
        dt.Columns.Add("C");
        dt.Rows.Add(1, 2, 3);
        this.dataGridView1.DataSource = dt;
        this.dataGridView1.Columns[dataGridView1.Columns.Count - 1].AutoSizeMode = DataGridViewAutoSizeColumnMode.Fill; 
```

您可能还希望将 DataGridView 设置为 Anchor 到窗体的右侧和底部（以及左侧和顶部），以便 DGV 在调整窗体大小时变得更大。（或将 Dock 设置为 Fill）。

# curl - 使用 cURL 和批处理线迭代

> ID：374497
> 
> 赞同：0
> 
> 时间：2008-12-17T13:13:53.267
> 
> 标签：curl

我有一个文件夹，里面装满了我需要使用 cURL 发布到 web 服务的文件，但我不确定批处理文件中的整个变量和迭代。

我知道 curl 的语法应该是

```
c:\curl\bin\curl -X POST -F File=@[filename] -F "title=[title]" -F "notes=[notes]" "http://xxx/AddScannedImage?debtref=[filename]" 
```

但是变量中的 % 符号似乎在 URL 编码中被吞噬了

有任何想法吗？

TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T13:17:41.277

您应该尝试使用`-g`aka `--globoff`cURL 选项。

默认行为是：

> 您可以通过在大括号内编写部分集来指定多个 URL 或部分 URL，如下所示：
> 
> ```
> http://site.{one,two,three}.com 
> ```
> 
> 或者您可以使用 [] 获取字母数字系列的序列，如下所示：
> 
> ```
> ftp://ftp.numericals.com/file[1-100].txt
> ftp://ftp.numericals.com/file[001-100].txt    (with leading zeros)
> ftp://ftp.letters.com/file[a-z].txt 
> ```
> 
> 目前不支持序列的嵌套，但您可以使用多个相邻的序列：
> 
> ```
> http://any.org/archive[1996-1999]/vol[1-4]/part{a,b,c}.html 
> ```
> 
> 您可以在命令行上指定任意数量的 URL。它们将按指定顺序按顺序获取。
> 
> 从 curl 7.15.1 开始，您还可以为范围指定步数计数器，以便您可以获得每 N 个数字或字母：
> 
> ```
> http://www.numericals.com/file[1-100:10].txt
> http://www.letters.com/file[a-z:2].txt 
> ```

你甚至可以这样做：

```
 curl -T "img[1-1000].png" ftp://ftp.picturemania.com/upload/ 
```

但在你的情况下，你真的不想要那样，所以你应该使用`-g`标志告诉它根本不要做 globbing。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-30T15:32:49.247

百分号 ( `%`) 是 Windows/DOS 批处理文件中的特殊字符。在命令行上，您可以使用单个`%`. 在批处理文件中，使用两个。

例如，如果您的 URL 包含一个编码为 的空格`%20`，那么您需要`%%20`.

# wpf - 使用嵌入式 WPF 用户控件本地化 WinForms 应用程序

> ID：374518
> 
> 赞同：1
> 
> 时间：2008-12-17T13:25:51.823
> 
> 标签：wpf, winforms, localization, baml, locbaml

我要本地化的应用程序是一个 WinForms 应用程序，它具有一些托管的 WPF 用户控件（托管在 ElementHost WinForms 控件中的 WPF 用户控件）。

我使用[resx](http://msdn.microsoft.com/en-us/library/y99d1cd3.aspx)文件来本地化 WinForms，VS2008 管理得很好。

当我尝试使用[LocBaml](http://msdn.microsoft.com/en-us/library/ms788718.aspx)方法来本地化 WPF 部件时，问题就开始了。

以下是发生的情况：当我构建解决方案时，Visual Studio 会自动为我生成附属程序集，但仅针对 resx 文件中的 WinForms 资源。然后，当我使用 LocBaml 命令行工具时，它会为我生成附属程序集，但仅针对 xaml 文件中的 WPF 资源。

我还没有弄清楚如何将两个生成的 DLL（WPF 和 WinForms）合并到一个附属程序集中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T04:32:10.967

Blech ... WPF 团队似乎确实在他们的本地化解决方案中留下了一些不足之处。好吧，对于它的价值，这就是我一直在做的事情（公平地说，我实际上是从CodeProject 上的[Jecho Jekov](http://www.codeproject.com/KB/WPF/WPF_Localization.aspx)那里借用了这个想法）：

首先，您需要创建（或借用）一个 Localization MarkupExtension 类。Jecho 称他为 LocExtension，我称我为 i18nExtension 无缘无故，只是觉得它比 Loc 更具描述性。这个标记扩展将做的是在你的资源文件中查找给定的资源键。如果您希望所有资源都位于 Properties/Resources.resx 文件中，那么这是一个非常简单且易于编写的类。

你最终得到的是在你的 xaml 中是这样的：

```
<UserControl ... >
    ...
    <TextBox Text="{i18n HelloWorld}"/>
    ...
</UserControl> 
```

如果您想像 WinForms 设计器允许的那样为每个 UserControl/Window 拥有单独的 resx 文件，那么您必须在 MarkupExtension 中获得更多创意，以便它可以找出它的上下文。

最终，您最终会在每种文化中获得一个卫星组件，这似乎是您所追求的。想到的一个警告是，我不确定这如何处理即时的文化/语言变化。至少，需要重新加载窗口/控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-09T15:34:03.023

为了在 WinForms 嵌入的 WPF 用户控件中[发布方法dustyburwell](https://stackoverflow.com/a/637370/383129)，您需要在 WinForms 表单构造函数调用 InitializeComponent() 之后将区域性设置为 usercontrol，然后更新值。

1.  声明 WinForms 表单。
2.  添加 ElementHost (elementHost1)。
3.  在 elementHost1 (userControl1) 中添加您的 WPF UserControl。
4.  打开表单的代码。编写以下代码：

```
 public Form1()
    {
        InitializeComponent();

        WpfLocalization.LocalizationScope.SetCulture(userControl1, System.Threading.Thread.CurrentThread.CurrentCulture);
        WpfLocalization.LocalizationScope.SetUICulture(userControl1, System.Threading.Thread.CurrentThread.CurrentCulture);
        WpfLocalization.LocalizationManager.UpdateValues();
    } 
```

每当 CurrentCulture 更改时，必须为每个嵌入 WinForms 的 WPF 用户控件调用这 3 行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T18:48:47.223

**如何将多组资源合并到一个卫星程序集中**

正确的方法是使用[AL.exe](http://msdn.microsoft.com/en-us/library/c405shex%28v=vs.80%29.aspx)（程序集链接器工具）将 windows 窗体 .resources 文件和 LocBaml 生成的 .resources 嵌入到单个附属程序集中（替换默认情况下仅包含 WinForms 资源的原始构建）。

构建混合应用程序的步骤是：

1.  构建您的解决方案（生成仅限 WinForms 的 .resource 文件和附属 dll）。
2.  使用 locBaml 工具生成 XAML .resource 文件
3.  使用 AL.exe 将两组 .resource 文件链接到新的混合卫星 dll 并替换步骤 1 中的原始文件。重建项目需要重复步骤 2 和 3 以重新合并 xaml 资源，因此您可能希望自动化通过将其添加为构建步骤或目标。

**示例用法：**

```
Al.exe /out:MyApp.resources.dll /culture:es-ES /embed:MyApp.Form1.es-ES.resources /embed:MyAppWpf.g.es-ES.resources 
```

更多信息（本地化混合应用程序）[http://msdn.microsoft.com/en-us/library/ms754231.aspx](http://msdn.microsoft.com/en-us/library/ms754231.aspx)

# c# - 将字符串或 NULL 插入 SQL Server 数据库时出现问题

> ID：374522
> 
> 赞同：7
> 
> 时间：2008-12-17T13:27:27.483
> 
> 标签：c#, sql, sql-server

我无法想出允许将字符串或 NULL 传递给数据库的正确语法。这是我的代码：

```
string insertString = String.Format(
    @"INSERT INTO upload_history (field1, field2, field3) 
    VALUES ('{0}', '{1}', '{2}')",
    varField1, varField2, varField3); 
```

我在变量占位符周围使用了单引号，以便数据库可以正确接受字符串值。但是，如果传递了 NULL，它最终会作为字符串“NULL”进入数据库。

有没有办法可以将单引号从 InsertCommand 字符串中删除，并有条件地将单引号添加到我的变量中？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-17T13:30:05.887

不要连接字符串 ( `string.Format`) - 使用参数 (`@p1`等) - 然后你可以将`DBNull.Value`null 传递给 SQL Server

```
SqlCommand cmd = new SqlCommand();
cmd.CommandText = @"INSERT INTO upload_history (field1, field2, field3) 
   VALUES (@p1, @p2, @p3)";
cmd.Parameters.AddWithValue("@p1", (object)someVar ?? DBNull.Value);
//... 
```

这也可以保护您免受 SQL 注入

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-17T13:32:26.693

使用 String.Format 集中字符串可能会带来很大的安全风险（SQL 注入），如果要插入 ' 字符也会有问题。

解决方案：

```
cmd.CommandText = "INSERT INTO upload_history (field1, field2, field3) " +
    "VALUES (@p1, @p2, @p3)";
cmd.Parameters.AddWithValue("@p1", varField1);
cmd.Parameters.AddWithValue("@p2", varField2);
cmd.Parameters.AddWithValue("@p3", varField3);
cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T13:51:42.067

本着回答问题的精神，并充分意识到重构代码以参数化查询是正确的解决方案，您可以编写一个返回单引号字符串或不带引号的 NULL 字符串值的函数，然后从查询字符串中删除单引号。

```
string insertString = String.Format(    @"INSERT INTO upload_history (field1, field2, field3)     VALUES ({0}, {1}, {2})",    ToStringorNull(varField1), ToStringorNull(varField2), ToStringorNull(varField3)); 
```

如果您使用的是 VS 2008，您甚至可以将其实现为扩展方法。

```
string insertString = String.Format(    @"INSERT INTO upload_history (field1, field2, field3)     VALUES ({0}, {1}, {2})",    varField1.ToStringorNull, varField2.ToStringorNull, varField3.ToStringorNull); 
```

我将把创建 ToStringorNull 函数留给你 - 这并不难 :-)

# java - 什么是开源 Java 游戏的好例子？

> ID：374523
> 
> 赞同：20
> 
> 时间：2008-12-17T13:29:15.543
> 
> 标签：java, open-source

对于自己的项目，一个好的起点是查看同一领域问题的其他代码。那么，您会推荐哪些开源 Java 游戏来查看源代码？哪个游戏最有助于学习一些创建游戏的技术，尤其是在 Java 环境中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-17T14:29:45.110

[![](https://i.stack.imgur.com/qUCs7.jpg)](https://i.stack.imgur.com/qUCs7.jpg)
[（来源：[freecol.org](http://www.freecol.org/images/welcome2.jpg)）]

[FreeCol](http://www.freecol.org/) - 基于 Sid Meier 的[殖民](http://en.wikipedia.org/wiki/Colonization_(computer_game))。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T13:32:23.697

这并不能直接回答您的问题，但如果您决定尝试用 JavaFX 编写游戏，[JavaFX](http://www.javafx.com/)网站有[一堆示例代码](http://www.javafx.com/samples/)，包括几个游戏（截至目前的写作）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T13:47:08.520

您可以查看[Jake 2](http://bytonic.de/html/jake2.html)，它是用 Java 重新实现的 Quake 2 引擎。对于 3D 游戏来说，这可能是一个很好的起点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-17T13:47:15.540

我想知道[http://sourceforge.net/projects/creepsmash/](http://sourceforge.net/projects/creepsmash/)是否是一个不错的选择。它是由一组计算机科学专业的学生为了模拟一个“真实的”商业风格的项目而建造的。因此，他们使用了诸如版本控制、构建工具和单元测试之类的东西。可能是一个更好的项目，可以从中学习，因为这就是它的目的。然而，这个游戏相当有趣，很多人玩它是为了好玩。不过，不确定它的文档中有多少是英文的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T13:37:44.420

如果您指定了您想要构建的游戏类型 - 游戏类型以及您想要 2d 还是 3d，这将有所帮助。

但要回答您的问题：查看轻量级 Java 游戏库 ( [http://lwjgl.org/](http://lwjgl.org/) ) 在他们的网站上有一个项目列表，其中一些是开源的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-17T13:46:51.813

[Frozen Bubble 移植到 Java](http://glenn.sanson.free.fr/v2/?select=fb:download&lang=en&menu=1)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-17T14:16:05.590

你可能比使用[Wyvern 做的](http://www.cabochon.com/)更糟。还有一个额外的好处是，您从主要来自史蒂夫·耶格（[Steve Yegge](http://steve-yegge.blogspot.com/) ）的想法开始。

# .net - Access 2007 - “无法更新；当前已锁定”

> ID：374531
> 
> 赞同：1
> 
> 时间：2008-12-17T13:32:57.410
> 
> 标签：.net, ms-access, oledb

首先很抱歉我的英语不好，但我会尽力而为。

现在我正在编写一个使用 Access 2007 作为数据存储的 .net 应用程序。

简而言之：我有两个线程。一个线程将带有事务的行插入到表中。另一个线程以恒定的时间间隔更新许多行。

**线程 1**

```
Database db = _loggingDatabase;

using (DbConnection conn = db.CreateConnection())
{
    conn.Open();
    DbTransaction txn = conn.BeginTransaction();
try
{
    string qryInsert = "Insert this";
    DbCommand cmdIns = db.GetSqlStringCommand(qryInsert);
    db.ExecuteNonQuery(cmdIns, txn);
    txn.Commit();
}
catch (Exception ex)
{
    txn.Rollback();
    throw ex;
}
finally
{
    conn.Close();
} 
```

**线程 2**

```
 Database db = _loggingDatabase;

    using (DbConnection conn = db.CreateConnection())
    {
        conn.Open();
        DbTransaction txn = conn.BeginTransaction();
    try
    {
        string qryUpdate = "Update that";
        DbCommand cmdUpdt = db.GetSqlStringCommand(qryUpdate);
        db.ExecuteNonQuery(cmdUpdt, txn);
        txn.Commit();
    }
    catch (Exception ex)
    {
        txn.Rollback();
        throw ex;
    }
    finally
    {
        conn.Close();
    } 
```

如果我触发插入许多记录，我会得到一个 System.Data.OleDb.OleDbException，上面写着：“无法更新；当前锁定”。我试图将连接字符串更改为

```
connectionString="Provider=Microsoft.ACE.OLEDB.12.0; Data Source=datastore.accdb; Jet OLEDB:Database Locking Mode=1;" 
```

对我的应用程序行为没有影响。我决定使用这些事务来避免混乱的插入和更新。

有解决方法吗？我究竟做错了什么？我可以将我的事务插入到某种事务队列到 Access 中吗？为什么 Access 不自行执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T02:32:42.233

斯特凡·格鲁伯问：

> 我可以将我的事务插入到某种事务队列到 Access 中吗？为什么 Access 不自行执行此操作？

我认为您无法理解 Jet 数据库引擎。首先，澄清一下：MS 可能在其 ODBC 和 OLEDB 连接字符串中使用“MS Access”作为名称，但在这种情况下您根本没有使用 Access——只是 Access 的默认数据库引擎 Jet。

Jet 不是服务器数据库引擎。也就是说，在客户端和存储数据的 MDB 文件之间没有服务器进程。MDB 文件的所有“用户”都通过文件系统访问它。为了管理多用户访问，有一个锁定文件（LDB 文件）来跟踪哪些表/记录被锁定以及哪些类型的锁定。Jet 检查该 LDB 文件以确定它可以做什么和不能做什么。

现在，因为没有服务器级别的进程来管理与磁盘数据的所有交互，所以不可能对访问 MDB 文件的请求进行任何编组。你的应用程序必须自己做。

如果这不令人满意，那么您使用了错误的数据存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T13:50:52.833

Not sure if this will help but this article may help explain how to handle the fact that the "Microsoft Jet database engine has a read cache and lazy writes":

[How To Implement Multiuser Custom Counters in Jet](http://support.microsoft.com/kb/240317/en-us)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T13:40:24.977

在这种情况下使用 MARS（多个活动结果集）。在网上搜索如何实现 MARS。

# asp.net - 如何在 ASP.NET 中返回 XML

> ID：374535
> 
> 赞同：1
> 
> 时间：2008-12-17T13:33:21.667
> 
> 标签：asp.net, xml, ajax, architecture, service

这是一个非常基本的问题。我只是在学习 ASP.NET (C#)。我以前做过经典的 ASP 和 PHP。

对于这个项目，我手头有**ASP.NET 2.0**。

我有一个带有[jqGrid](http://www.trirand.com/blog/) Datagrid 的 Web 表单，我想通过 AJAX 提供 XML 数据。不过，jqGrid 不是这里的问题。“问题”是我应该采取的生成 XML 的方法。

我如何在 ASP.NET 中做到这一点？

*   我是否要创建一个新的 Web 表单来生成该数据？
*   我是否使用新的 Web 服务（它不会返回我需要的 XML，对吗？）？
*   我是否以某种方式在显示表格的现有 Web 表单中放置了一个函数？如果是这样，怎么做？

做出决定后：如何输出 XML？我不想使用 ASP.NET 的任何 XML 组件，因为它只是简单的 XML，一个记录一个接一个。使用 System.Xml 的开销太大，在此无法证明是合理的。

```
<?xml version='1.0' encoding='utf-8'?>
<rows>
<page>1</page>
<total>25</total>
<records>3</records>
  <row id='1'>
    <cell>Row 1, Column 1</cell>
    <cell>Row 1, Column 2</cell>
    <cell>Row 1, Column 3</cell>
  </row>
  <row id='2'>
    <cell>Row 2, Column 1</cell>
    <cell>Row 2, Column 2</cell>
    <cell>Row 2, Column 3</cell>
  </row>
  <row id='3'>
    <cell>Row 3, Column 1</cell>
    <cell>Row 3, Column 2</cell>
    <cell>Row 3, Column 3</cell>
  </row>
</rows> 
```

根据我以前使用其他脚本语言的经验，我只想打印出 XML 标记流 (Response.Write)。如果我在 ASP.NET 中这样做，我会下地狱吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-17T13:38:54.183

使用 System.Xml（或 System.Xml.Linq）比手动编码 Response.Write 并确保引用所需的所有内容、整理编码等方面的开销更少。为什么要重新发明轮子？

创建一个新的 ashx 而不是 aspx 页面，创建适当的 XmlDocument/XDocument 并将其写入响应，并适当地设置内容类型。

有关创建 RSS 提要的示例，请参阅[本文。](http://www.aspcode.net/Creating-an-ASHX-handler-in-ASPNET.aspx)这与我在我的网站上从数据库生成 RSS 所做的类型相同 - 使用 LINQ to XML 这会在单个（当然很大，但可读）语句中创建整个文档。那么这只是设置内容类型和调用的情况`context.Response.Write(doc)`。非常简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-17T14:15:53.953

在 ashx 中使用完整的 XmlDocument/Linq 的另一种解决方案是使用 XmlWriter，这是在将 xml 手工制作为字符串和使用 dom 之间的中间解决方案。

就像是：

```
StringBuilder query = new StringBuilder();

using (XmlWriter xmlWriter = XmlWriter.Create(query))
{
    xmlWriter.WriteStartElement("rows");
    xmlWriter.WriteElementString("page", "1");

    foreach(...)
    {

        xmlWriter.WriteStartElement("rows");
        xmlWriter.WriteAttributeString("row", "1");

        foreach(...)
        {
            xmlWriter.WriteElementString("cell", "Row 1, Column 1");
        }

        xmlWriter.WriteEndElement();            
    }

    xmlWriter.WriteEndElement();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T15:41:18.647

嗯，我想分发两个“已接受的答案”。;)

Jon Skeet 回答了我问题的第一部分：

> 创建一个新的 ashx 而不是 aspx 页面

所以我创建了一个我正在寻找的通用处理程序。

Matthew Pelser 回答了我问题的第二部分：

> 使用 XmlWriter，这是手工将 xml 制作为字符串和使用 dom 之间的中间解决方案。

所以我使用了 XmlWriter，这正是我正在寻找的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-27T10:26:06.607

test.ashx 的工作示例：

```
<%@ WebHandler Class="XMLHandler" %>
Imports System.Xml

Public Class XMLHandler : Implements IHttpHandler
  Public Sub ProcessRequest(ByVal context as HttpContext) Implements IHttpHandler.ProcessRequest
    context.Response.ContentType = "text/xml"
    Dim input as string = context.Request.Params("input")
    Dim settings as new XmlWriterSettings()
    settings.Indent = false

    Using xml as XmlWriter = XmlWriter.Create(context.Response.Output, settings)
      xml.WriteStartDocument
      xml.WriteStartElement("wsis")
        xml.WriteAttributeString("id","p4")
        xml.WriteElementString("user_id", "test")
      xml.WriteEndElement()
      xml.WriteEndDocument()
    End Using    
  End Sub

  Public ReadOnly Property IsReusable() as Boolean Implements IHttpHandler.IsReusable
    Get
      Return True
    End Get
  End Property
End Class 
```

# php - Ajax 超链接

> ID：374540
> 
> 赞同：0
> 
> 时间：2008-12-17T13:38:35.807
> 
> 标签：php, ajax, hyperlink

我在为超链接提供 Ajax 功能时遇到问题。我有文件`Link.html`和`GetCustomerdata.php`. HTML的主要功能是将数据发送到`getCutomerData.php`flash并显示为“成功”。

而且我不想要超链接，

```
<a href="#" 
```

相反，我需要它：

```
<a href=GetCustomer.php?id=<format> 
```

是否可以清除？

### 链接.HTML

```
<html>
    <head>
        <title>Customer Account Information</title>
        <script type="text/javascript">
            var url = "GetCustomerData.php?id="; // The server-side script
            function handleHttpResponse() {
                if (http.readyState == 4) {
                    if(http.status==200) {
                        var results=http.responseText;
                        document.getElementById('divCustomerInfo').innerHTML = results;
                    }
                }
            }

            function requestCustomerInfo() {
                var sId =10;
                document.getElementById("txtCustomerId").value;
                http.open("GET", url + escape(sId), true);
                http.onreadystatechange = handleHttpResponse;
                http.send(null);
            }

            function getHTTPObject() {
                var xmlhttp;

                if(window.XMLHttpRequest){
                    xmlhttp = new XMLHttpRequest();
                }
                else
                    if (window.ActiveXObject){
                        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
                        if (!xmlhttp){
                            xmlhttp=new ActiveXObject("Msxml2.XMLHTTP");
                        }
                    }
                return xmlhttp;
            }

            var http = getHTTPObject();
        </script>
    </head>

    <body>
        <a href="getCustomerData.php?id=10&onclick="requestCustomerInfo();return false;">Show Me</a>
        <div id="divCustomerInfo"></div>
    </body>
</html> 
```

...

而我的 PHP 文件只是闪烁成功消息：

### 获取客户数据.php

```
<?php
    echo "Success"
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T13:53:04.280

您将锚点 onclick 事件放置在 href 属性内。onclick 应该写成一个单独的属性：

```
...
<a href="getCustomerData.php?id=10" onclick="requestCustomerInfo();return false;">Show Me</a> 
```

为了防止链接重定向页面，需要停止点击事件执行链接默认动作。在您的函数调用中：

```
function requestCustomerInfo(event) {
    if (!event) var event = window.event;
    event.preventDefault();
    ...
} 
```

# c# - 如何创建一个新的 windows 窗体，并将它与一个已经存在的线程相关联？

> ID：374553
> 
> 赞同：2
> 
> 时间：2008-12-17T13:43:03.457
> 
> 标签：c#, .net, winforms, multithreading, architecture

我正在尝试用 C# 编写一个聊天客户端，但遇到了问题。

它的工作原理是客户端每 1 秒轮询一次服务器以查看是否有任何新的操作要采取（例如在频道中显示一条消息，或其他）。轮询是在它自己的线程中完成的。

现在，我希望轮询线程在收到通道打开操作时打开一个新的 MDI 表单（意味着用户已进入一个新通道）。问题是，新表单应该在 MAIN 程序线程上运行，而不是在工作线程上运行。

所以基本上我在问，我如何创建一个新的 windows 窗体，并将它与一个已经存在的线程相关联？（而不是创建它的线程）。

另外，如果您知道更好的方法来做到这一点，请告诉我。我喜欢改进我的程序架构！

谢谢大家

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T13:47:04.540

[使用Control.Invoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invoke.aspx)或[Control.BeginInvoke](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)使轮询线程回调到主窗体，并在回调中创建窗体。

我假设您已经在使用 Invoke/BeginInvoke 来更新 UI - 这只是另一种 UI 操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T13:49:10.667

您应该从主窗口调用该函数：

```
 void MyWorkerThread() {
        while (Connected) {
            Thread.Sleep(1000);
            if (NewMessage) {
                ShowNewForm();
            }
        }
    }

    void ShowNewForm() {
        if (this.InvokeRequired) { // this refers to the current form
            this.Invoke(new Action(ShowNewForm));  // this line invokes the same function on the same thread as the current form
            return;
        }
        Form myMdiForm = new Form();
        myMdiForm.Show();
    } 
```

# c# - 将文件写入响应后关闭弹出窗口

> ID：374555
> 
> 赞同：3
> 
> 时间：2008-12-17T13:43:13.487
> 
> 标签：c#, asp.net, response

在我的代码中，我使用 JavaScript 来触发`window.open()`ASPX 页面上的事件。`Page_Load()`如果出现此页面，我将输出一个文件：

```
Response.Clear();
Response.ClearContent();
Response.ClearHeaders();
Response.Charset = "";
Response.ContentType = "application/octet-stream";
Response.AddHeader("Content-Disposition", "attachment;filename=\"" + filename + "\";");
outputStream.WriteTo(Response.OutputStream);
outputStream.Flush();
outputStream.Close();
Response.Flush();
Response.Close(); 
```

之后我想关闭这个弹出窗口。但是因为我改变了我的响应类型，我不能`window.close()`在 JavaScript 中执行。它只会附加到提供给用户的文件中。这个线程是我发现解决我的问题的最合适的来源：

[导出到excel后关闭窗口](http://forums.asp.net/t/1186371.aspx?PageIndex=1)

但是给定的答案对我没有帮助，所以我基本上被卡住了。我不想告诉用户手动关闭窗口。你知道如何实现我的目标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T17:23:14.440

您可以从 AJAX 页面上传文件。您需要做的是在后面的代码中将控件的 ID 添加到需要回发的更新面板回发触发器中。如果控件在同一页面上，则不会有任何问题。

但是，如果您使用具有按钮的用户控件或需要回发的其他 web 控件，则必须通过 USer 控件的公共属性公开此控件的 ID，并让包含页面检索此 ID 并将其添加为回发触发器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T21:09:07.417

你错过了重点。要关闭弹出窗口，您必须使用脚本管理器来执行此操作，因为您正在`Upload`从`UpdatePanel`. 所以像这样注册脚本：

```
ScriptManager.RegisterStartupScript(UpdatePanelObject, UpdatePanelObject.GetType(), "scripname","your  script here", true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T06:17:06.813

我过去使用的一个选项是通过一些 javascript 将下载请求发送到隐藏的 iframe 而不是弹出窗口：

```
var Utils = Utils || {};
Utils.download = function(url) {
    var iframe = $("<iframe/>").hide().appendTo("body").load(function() {
        iframe.remove();
    }).attr("src", url);
}; 
```

这样您就不必担心任何可见的弹出窗口。唯一的缺点是，如果文件下载失败，用户根本不会得到任何提示（而在您的情况下，他们仍然会弹出带有完整错误消息的窗口）。要解决此问题，而不是返回文件，而是返回一个包含一些 javascript 的页面，该页面会在加载时触发某种警报以通知用户错误。

另请注意，从内存中，`iframe.remove()`iframe 的加载调用在所有（任何？）浏览器中都不起作用，但归根结底，这并不重要，因为在最坏的情况下，你只是得到一个一堆空的 iframe 附加到 dom 的末尾，它们不应该引起任何问题（如果有问题，你总是可以继续重复使用相同的 iframe，而不是创建新的 iframe）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-09T21:23:25.220

我建议你通过一个简单的方法来下载文件

```
<a href="/path/to/your/page.aspx" target="_blank">Download</a> 
```

这将在不同的窗口中调用您的页面，下载将开始，页面应自动关闭。

# ms-access - 将访问表导出到 Excel

> ID：374556
> 
> 赞同：0
> 
> 时间：2008-12-17T13:43:29.790
> 
> 标签：ms-access, vba, export

我正在尝试使用以下代码将表从访问导出到 excel

我得到错误对象最后不支持属性或方法

```
 Set objexcel = New Excel.Application
   objexcel.Visible = True

   If Dir("C:\reports\Data_Analysis1.xls") = "" Then
   objexcel.Workbooks.Add
   Set wbexcel = objexcel.ActiveWorkbook
   Set objSht = wbexcel.Worksheets("Sheet1")
   Else
   Set wbexcel = objexcel.Workbooks.Open("C:\Documents and Settings\TAYYAPP\Desktop\test folder\reports\ERROR REPORT4.xls")
   Set objSht = wbexcel.Worksheets("Sheet1")
   End If

   objSht.Activate

   objexcel.DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, "UTYP_Anzahl", "C:\Reports\Data_Analysis1.xls", True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T13:53:24.280

“DoCmd.TransferSpreadsheet”中的 DoCmd 是 MS Access 命令，而不是 excel 命令。我认为这是你的问题。

如果此 VBA 在 MS Access 中运行，则只需将其称为

```
DoCmd.TransferSpreadsheet 
```

不是

```
objexcel.DoCmd.TransferSpreadsheet 
```

此外，如果您正在这样做，则无需使用 Execl Automation 手动创建 excel 文件，Access 将为您完成。

抱歉，如果我误解了您在做什么，但我认为您需要的只是 TransferSpreadSheet 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T11:14:17.453

此[答案](https://stackoverflow.com/questions/358603/access-table-data-to-excel#362325)适用于 Excel 对象并且可能会有所帮助，因为它允许您自动格式化 Excel 文件。

# c# - 是否有任何将异常转换为 HTML (C#) 的好的 OSS 实例？

> ID：374558
> 
> 赞同：1
> 
> 时间：2008-12-17T13:44:22.410
> 
> 标签：c#, asp.net, exception, formatting, enterprise-library

使用 EntLib 4.1 并希望 Exception 块发送包含错误信息的电子邮件。这一切都很好，但开箱即用，我可以使用 Text 或 Xml 格式化程序。我会喜欢一个 Html 表示，它会带来其他信息，例如浏览器、http 标头等。几年前我写了一个，但不再有源代码，我在谷歌上的点击量不足，所以我想我会问 SO 社区和看看是否有人知道在互联网的一系列管子中漂浮着什么东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T15:20:17.473

ELMAH 有可能成为您的答案吗？[http://code.google.com/p/elmah/](http://code.google.com/p/elmah/)

# c# - 如何能够选择屏幕的一部分？

> ID：374560
> 
> 赞同：0
> 
> 时间：2008-12-17T13:44:39.350
> 
> 标签：c#, .net

在某些屏幕捕获软件中，当您按下某个键时，客户端可能会选择屏幕的一部分。如何在我用 framework 2.0 .Net 编写的软件中实现它？

这是我想做的图片：http: [//img341.imageshack.us/img341/3782/portionpb9.png](http://img341.imageshack.us/img341/3782/portionpb9.png)你看，我可以选择屏幕的一部分。我怎样才能做到这一点？

我不想知道如何截取屏幕截图......任何一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T15:08:37.670

我知道这可能不是一个您可以轻松复制和粘贴的解决方案，但这个 C# 中的开源项目确实具有您的应用程序想要的行为：http: [//www.codeplex.com/cropper](http://www.codeplex.com/cropper)

您也许可以将他们的一段代码放入您的应用程序中。这是来自代码 plex 的图像：

[替代文本 http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=cropper&DownloadId=8026](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=cropper&DownloadId=8026)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T13:48:14.493

这是一个捕获屏幕的[教程](http://www.codeguru.com/csharp/csharp/cs_graphics/screencaptures/article.php/c6139)。您可以仅复制所选屏幕的一部分，也可以尝试更改代码以仅捕获该部分。

# delphi - TDBGrid onSelect

> ID：374561
> 
> 赞同：1
> 
> 时间：2008-12-17T13:45:06.853
> 
> 标签：delphi, tdbgrid

我想自定义 TDBGrid：

1) 添加 onSelect/onUnselect 事件 - 例如有利于显示所选项目的数量。

2）在鼠标左键单击时删除选择项。我继承了 TDBGrid 并重写了 MouseDown，但是无法移动或调整列的大小:(

那么，该怎么做呢？

D2009

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:05:41.127

这为我完成了工作：

```
implementation

{$R *.dfm}

type
  THackDBGrid = class(TDBGrid);
//for info on why we must do this, see:
//http://delphi.about.com/od/oopindelphi/l/aa082603a.htm

var
  LastValidRow: integer;

procedure TForm1.DataSource1DataChange(Sender: TObject; Field: TField);
begin
  //assign this to the TDBGrid.DataSource.DataSet.OnDataChange Event
  if 0 <> HiWord(GetKeyState(VK_LBUTTON)) then begin
    THackDBGrid(DBGrid1).Row := LastValidRow;
  end
  else begin
    LastValidRow := THackDBGrid(DBGrid1).Row;
    inherited;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:02:26.450

您需要检查 Selected 属性中的更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T16:46:07.817

> 我认为您可能需要确保允许继承的 Mousedown 运行，以便执行标准的移动和调整大小行为。

但是继承的 MouseDown 在鼠标左键上进行选择，我只想在鼠标右键上选择/取消选择（例如在 TotalComander 中选择/取消选择）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T14:57:30.140

我认为您可能需要确保允许继承的 Mousedown 运行，以便执行标准的移动和调整大小行为。

# apache-flex - 您如何在 Flex 应用程序中进行身份验证？

> ID：374563
> 
> 赞同：4
> 
> 时间：2008-12-17T13:46:13.013
> 
> 标签：apache-flex, authentication

您是在您的 Flex 应用程序中构建所有登录、帐户创建、密码恢复等，还是将所有这些都保存在网页中，仅在成功登录时重定向到 .swf？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-15T21:14:11.843

我们这样做的方式是

**1) Flex 前端通过远程对象与网络服务器上的 Java Facade 对话。**

爪哇：

```
public class AdminServer {
  //injected into contr..
  private final LdapService ldapService;

  public UserDisplay authenticate(String username, String password) {
    return ldapService.authenticate(username,password);
  }
} 
```

**2）ldap认证和异常处理**

然后 java 通过委托方法（省略）调用 ldap 服务器，UserDisplay 对象被填充并始终返回，其状态表示成功/失败/异常，以及用户的身份验证级别。您可以按照自己喜欢的方式执行此操作。

**3）然后我们将 AdminServer 公开为 spring/config 中的 flex 目标，如下所示：**

重要的是，**destination="adminServer"**（下）与 spring 配置（上）中的 bean id 匹配。

**4）在弹性代码中：** ..

**5) 使用 AMFSecureChannel** 为防止密码从 flex->java 以明文形式发送，您还需要在 flex 配置文件中使用 AMFSecure 通道，将其设置为默认值。

**6) 使用 Ldap 证书和密钥库来保护通信 java->ldap**

java 的东西应该有用于加密的 ldap 证书，在我们的例子中，这意味着在服务器（Tomcat）上配置一个密钥库（参见 java keytool）文件，并在 ORDER 中导入以下内容：

1.  根信任的顶级证书
2.  签署我们的密钥对的证书
3.  我们生成的密钥对，我们发送给 (2) 进行签名。

如果您不遵守此顺序，您将不会导入您的公钥/私钥

**7) 密钥库文件的位置**

该文件被放入 ~/.keystore 以自动被 tomcat 拾取。您的服务器可能不同。

**8) 使用 webserver 安全端口** 最后，我们必须在 server.xml 配置中取消注释 tomcat https 以允许安全通道在端口 8443 上工作。

然后我们可以输入： [https ://www.oursite.com:8443/ourcontext/login.html](https://www.oursite.com:8443/ourcontext/login.html)

并始终获得安全的通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T17:44:09.790

我即将完成一个具有 Drupal 后端的中型 flex 应用程序。我使用 RemotObjects 通过 AMFPHP 与 drupal 进行所有登录和验证例程。我重定向到 HTML 的唯一目的是实际的新用户注册。然而，事先知道 Drupal、Flex 和 AMFPHP 一起玩得非常好，肯定会让决定变得更容易！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T18:08:07.917

我们在一个非常复杂的应用程序中在 Flex 中完成这一切，没有理由转向 HTML。由于如果您使用 AMF，Flex 会与后端对话（无状态）HTTP，因此无论如何您都需要 Flex 中的会话支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-24T20:52:21.243

我们使用 HTML/JavaScript 制作登录页面并使用 AJAX 服务调用。在用户成功通过身份验证之前，我们从不接触我们的 Flex .swf 代码。这个页面也是我们验证 Flash 播放器是否存在以及是否有足够的版本来运行我们的 Flex 代码的地方。

在服务器端，我们使用 Tomcat、BlazeDS 和 Spring-Framework。我们有 Spring 控制器，可以将任何尝试的未经身份验证的访问（BlazeDS 远程调用等）转移到登录页面。我们使用 Spring 安全性来管理身份验证和用户角色权限（这曾经被称为 Acegi 安全性，但它已合并到 Spring 保护伞下）。

我们曾经尝试在 Flex 中创建一个登录页面，但由于一些奇怪的焦点错误而放弃了。我们无法将焦点始终可靠地放在登录凭据编辑字段中。论坛显示，首次访问 Flex 表单时存在已知焦点问题。

对于用户登录体验，我们绝对希望确保焦点表现良好。第一印象是持久的印象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T18:34:24.460

在 flash 中通过 http（普通网络服务器）与服务器通信非常容易。如果您不与服务器进行大量的数据交换，AMF 可能会过大，而 JSON、XML 或您自己的格式就足够了。

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLLoader.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLLoader.html)

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLRequest.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/URLRequest.html)

编辑：我的意思不是说闪光，而不是弯曲。

# unit-testing - NUnit [TearDown] 失败——什么进程正在访问我的文件？

> ID：374567
> 
> 赞同：19
> 
> 时间：2008-12-17T13:46:55.010
> 
> 标签：unit-testing, sqlite, nunit, ioexception

**最终编辑：**我找到了问题的解决方案（在问题的底部）。

我有一个让我很伤心的 Nunit 问题。**编辑：**实际上它看起来更像是一个 SQLite 问题，但我还不是 100% 确定。

我的 TestFixture 有一个设置，它生成一个随机文件名，在我的每个测试中用作 SQLite 数据库。

```
[Setup]
public void Setup()
{
    // "filename" is a private field in my TestFixture class
    filename = ...; // generate random filename
} 
```

我的每个测试都在访问数据库的每个方法中使用此构造：

```
[Test]
public void TestMethod()
{
    using (var connection = Connect())
    {
        // do database activity using connection

        // I've tried including this line but it doesn't help
        // and is strictly unnecessary:
        connection.Close();
    }
}

private DbConnection Connect()
{
    var connection = DbProviderFactories.GetFactory("System.Data.SQLite").CreateConnection();
    connection.ConnectionString = "Data Source=" + filename;
    connection.Open();
    return connection;
} 
```

因此，`Connect()`所有方法都使用一种辅助方法。我假设`using() { }`构造`Dispose()`在结束时调用连接`TestMethod()`并释放与 SQLite 数据库文件的连接。

我遇到的问题在于我的 [TearDown] 方法：

```
 [TearDown]
    public void Cleanup()
    {
        File.Delete(filename); // throws an IOException!
    } 
```

每次测试我都会遇到一个异常：

```
System.IO.IOException: The process cannot access the file 'testdatabase2008-12-17_1030-04.614065.sqlite' because it is being used by another process. 
```

所有的测试在到达 [TearDown] 时都失败了，所以我最终得到了一个充满临时数据库文件的目录（每个测试一个，每个都有不同的名称）和一大堆失败的测试。

什么进程正在访问该文件？我不明白第二个进程如何访问该文件。在`connection`我尝试删除文件时，它已完全超出范围并已被 Dispose()d，因此它不能与 SQLite 相关。它可以？

请注意，如果我运行所有测试或仅运行一个测试，我会得到相同的结果。

**更新：**所以我也尝试了我的 DbCommand 对象的 Dispose()ing，因为我没有这样做（我假设 Dispose()ing DbConnection 的所有其他 ADO.NET 提供程序也 Dispose()s 该连接上的任何命令.) 所以现在它们看起来像：

```
[Test]
public void TestMethod()
{
    using (var connection = Connect())
    {
        using (var command = connection.CreateCommand())
        {
        // do database activity using connection

        }
    }
} 
```

它没有任何区别—— File.Delete() 行仍然抛出一个 IOException。:-(

如果我删除 [TearDown] 中的那一行，那么我的所有测试都会通过，但我会留下一大堆临时数据库文件。

**另一个更新：** 这很好用：

```
var filename = "testfile.sqlite";
using (var connection = BbProviderFactories.GetFactory("System.Data.SQLite").CreateConnection())
{
    connection.ConnectionString = "Data Source=" + filename;
    connection.Open();
    var createCommand = connection.CreateCommand();
    createCommand.CommandText =
        "CREATE TABLE foo (id integer not null primary key autoincrement, bar text not null);";
    createCommand.ExecuteNonQuery();
    var insertCommand = connection.CreateCommand();
    insertCommand.CommandText = "INSERT INTO foo (bar) VALUES (@bar)";
    insertCommand.Parameters.Add(insertCommand.CreateParameter());
    insertCommand.Parameters[0].ParameterName = "@bar";
    insertCommand.Parameters[0].Value = "quux";
    insertCommand.ExecuteNonQuery();
}
File.Delete(filename); 
```

我不明白！

**更新：**找到解决方案：

```
 [TearDown]
    public void Cleanup()
    {
        GC.Collect();
        File.Delete(filename);
    } 
```

我通过调试器运行单元测试，当`[TearDown]`方法启动时，肯定不再有对 SQLite DbConnection 的引用。但是，强制 GC 必须清理它们。SQLite 中一定有一个错误。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T11:58:07.170

感谢您在底部发布的答案。我为完全相同的案例挖掘了几个小时

```
GC.Collect ();
GC.WaitForPendingFinalizers (); 
```

成功了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T13:54:54.010

try calling Close on the dbconnection

make sure the sqllite process is terminated

you can see what process has your file locked with the Unlocker (free) utility

this may be a ['known' issue with SqlLite](http://sqlite.phxsoftware.com/forums/p/909/4164.aspx); the forum banter suggests closing the connection and disposing the command, and suggests that this will be fixed in a future version (since this behavior is not consistent with other ADO providers)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-25T11:50:00.207

我知道这个答案迟了一年多，但对于任何将来阅读的人......

我遇到了与您类似的问题 - 由于 SQLite 数据库文件保持打开状态，尝试在测试之间删除测试数据库失败。我将代码中的问题追溯到未明确关闭的 SQLiteDataReader 对象。

```
SQLiteDataReader dr = cmd_.ExecuteReader();
while (dr.Read())
{
    // use the DataReader results
}
dr.Close();  //  <-- necessary for database resources to be released 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-21T19:14:04.107

调用静态方法

SqliteConnection.ClearAllPools()

在此调用之后，数据库文件被解锁，您可以在 [TearDown] 中删除该文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T14:07:45.077

Tear down is executed after each test.

> This attribute is used inside a TestFixture to provide a common set of functions that are performed after each test method is run.

You should try to delete them all with **TestFixtureTearDown**:

```
 [TestFixtureTearDown]
    public void finish()
    {
        //Delete all file
    } 
```

Maybe one test is using the file that you try to delete in an other test. *<-- [Stewart] As I stated in the question, it happens when I run only one test, so this isn't possible.*

*Update* You do not give enough information about what you are doing. Have you try to clean up all the Test file with only 1 test in your test file and try it? *[Stewart] Yes.* If it works *[Stewart] (it doesn't)* then it's that you have multiple test problem (they access each other). You need to **cut down the problem to find the source**. Then, come back here we will help you. for the moment it's only guessing that we can give you. *[Stewart] I have already done these cut-downs of the problem that you suggest, you'll find that they're in my original question!*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T15:36:54.413

你有杀毒软件运行吗？一些 AV 产品在看到文件被关闭时会扫描文件。如果 AV 软件在您删除它时仍然打开文件，您会看到这个问题。您可以在稍作延迟后重试删除。

我也看到搜索索引器会发生这种情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T15:50:02.687

第一步是找出谁在持有相关文件的句柄。

[获取Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)的副本运行它。按 Ctrl+F 并输入文件名。它会向您显示访问它的进程列表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-02T09:04:25.340

Thanks for pointing this out!

The problem is not related to SQLite, but rather to memory management in general. After your test has run, the objects pointing to files have no scope anymore, but they still exist in memory.

Hence, there's still references to the files and you can't delete / move them.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-17T16:58:11.427

你用什么来打开你的数据库？您是否使用[此处](http://sqlite.phxsoftware.com/)的 ADO 2.0 连接器。如果有一个使用它的应用程序，我可以与它进行多个连接（关闭/打开）。如果你不使用这个连接器，你可以试一试。你的方法 Connect() 返回什么？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-17T14:52:48.963

我需要查看您的文件名创建逻辑，但您可能正在打开文件来创建它，但在创建后没有关闭它。我认为如果您使用 System.IO.Path.GetTempFileName() 它只会创建文件并在文件关闭的情况下返回文件的名称。如果您正在生成自己的随机名称并使用 File.Open，则需要确保之后将其关闭。

另一方面，我衷心建议采用模拟策略来抽象出数据库，而不是在单元测试中从实际数据库中读取/写入。单元测试的重点是它们应该非常快，而文件 I/O 会真正减慢这些速度。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-17T16:44:43.573

文件是否可能正在关闭（即 SQLLite 不会立即释放它）？

您可以尝试将数据库关闭在延迟循环中（每次尝试之间可能有一秒钟），并且仅在循环中的几次（5 次左右）迭代后抛出异常。

# apache - Apache Web 服务器重定向发布请求

> ID：374571
> 
> 赞同：0
> 
> 时间：2008-12-17T13:47:24.820
> 
> 标签：apache, tomcat, mod-rewrite

我在 4 个端口上配置了 apache（使用虚拟主机作为一些使用 HTTPS 的端口），目的是将发布请求重定向到在其他机器上的 TOMCAT 实例中运行的不同 servlet。调用是从`httpclient`(java client) 进行的。当我运行客户端时，它会抛出错误 301 错误：永久移动。需要有关如何解决此问题的提示/提示/帮助。

如果有人能给我一个例子，那就太好了。我的虚拟主机（带有重定向）看起来像这样

```
<VirtualHost _default_:3334>
  RewriteEngine On
  RewriteRule ^/$ https://192.168.100.23:38443/Lang/Englangservices/Alapbhet_service
<\VirtualHost> 
```

* * *

我现在可以让 mod 代理与 mod rewrite 一起工作，现在我没有收到 302 错误，但由于它总是发生在新手身上，这是另一个问题。

HTTP POST 请求不起作用。当我发出 post 请求时，代理在继续查找 index.htm 时失败。

我的 httpd.conf 片段

```
<VirtualHost *:3331>
  ServerName localhost:3331
  ProxyPass / http://192.168.100.23:38443/Lang/Englangservices/Alapbhet_service
  ProxyPassReverse / http://192.168.100.23:38443/Lang/Englangservices/Alapbhet_service
  RewriteEngine on
  RewriteRule ^/$ http://localhost:3331/
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T19:32:44.327

除了已经给定的 mod_proxy 之外，另一个选项是 mod_jk。（对不起空格，否则格式混乱）

两者都是 apache 扩展，允许 apache 消费请求，透明地将其转发给 tomcat，等待响应，然后将结果发回。

恕我直言 mod_jk 有几个优点

*   Tomcat 自动获取服务的主机名、协议和端口（使用 mod_proxy，您必须配置它在连接器中代理的事实，请参阅选项[proxyName 和 proxyPort](http://tomcat.apache.org/tomcat-6.0-doc/config/http.html)
*   mod_jk 提供负载平衡 - 如果你需要这个
*   apache 在为此任务（ajp13）设计的协议中与 tomcat 对话。使用 mod_proxy 他们谈论 http，它的开销略高（披露：我自己从未测量过它，只是模仿它）

你最终使用什么完全是你的选择——这两个选项之间没有*太大*的区别。（如果是的话，有人纠正我）

配置如下（未经测试的伪代码。*请*阅读文档，请了解您的工作......）

```
# somewhere in httpd.conf, above the virtual hosts
JkWorkersFile /etc/apache2/workers.properties
JkLogFile     /var/log/apache/mod_jk.log
JkLogLevel    error

# your existing part with virtual hosts
<VirtualHost ...>
   ....
   JkMount /Lang/* tomcat1
   JkMount /Lang   tomcat1  # if you need the directory itself also to be forwarded
   ....
</VirtualHost>

# the workers.properties file described above
# 'tomcat1' is the reference used above as argument to JkMount
workers.list=tomcat1
worker.tomcat1.port=8009
worker.tomcat1.host=localhost
worker.tomcat1.type=ajp13
worker.tomcat1.lbfactor=1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T13:57:11.870

如果您真的想重定向，301 听起来像是适当的响应，但也许您真的想代理请求以便客户端不知道重定向？在这种情况下，看看使用[mod_proxy](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html)作为反向代理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T14:06:48.527

您在 java 中的 httpclient 需要正确处理 301 答案。如果没有，它就坏了。如果您不想或不能，那么使用Paul 所指出的[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html) / [mod_proxy](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)来“透明地”重定向是要走的路。看[这里](http://httpd.apache.org/docs/2.2/rewrite/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T09:28:54.683

使用 JK 和 mod rewrite 实现了这一点。问题在于两种方式的 SSL，我将端口配置为与 443 (SSL) 端口一起运行。

IE

注意：如果打算重写虚拟主机中的 URL，则必须为每个虚拟主机重新加载 JK 挂载。

我的 URL 重写看起来像这样

RewriteCond %{SERVER_PORT} 4342 RewriteRule上的RewriteEngine
^/$ /Lang/Englangservices/Alapbhet_service [L,PT]

感谢大家的投入。

# python - 需要在 Python 中创建帮助变量

> ID：374572
> 
> 赞同：0
> 
> 时间：2008-12-17T13:47:51.560
> 
> 标签：python, variables

我想将变量创建为`a1`, `a2`, `a3`... `a10`。为此，我使用了 for 循环。随着循环中的变量递增，我需要创建一个如上所述的变量。

谁能给我一个想法？

在创建时，我还需要能够为它们分配值。

那就是我遇到语法错误的地方。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-17T13:50:42.757

通常，我们使用一个列表，而不是一堆单独的变量。

```
a = 10*[0]
a[0], a[1], a[2], a[9] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-17T14:11:45.053

按照 S.Lott 所说，如果您真的需要唯一名称并且项目的顺序并不重要，您也可以使用 dict：

```
data = {}
for i in range(0, 10):
  data['a%d' % i] = i

>>>data
{'a1': 1, 'a0': 0, 'a3': 3, 'a2': 2, 'a5': 5, 'a4': 4, 'a7': 7, 'a6': 6, 'a9': 9, 'a8': 8} 
```

我要补充一点，像您想要的那样自动创建变量是非常危险的，因为您可能会覆盖可能已经存在的变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T14:59:54.440

`globals()`返回变量的全局字典：

```
for i in range(1,6):
    globals()["a%i" % i] = i

print a1, a2, a3, a4, a5      # -> 1 2 3 4 5 
```

但坦率地说：我永远不会这样做，自动污染命名空间是有害的。我宁愿使用列表或字典。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-17T13:59:16.343

您可以使用 exec 函数：

```
for i in range(0,10):
   exec("a%d=%d" % (i,i)) 
```

不是很pythonic的做事方式。

# jsp - 字符编码 JSP - 在 JSP 中显示错误，但在 URL 中不显示：“á » Ã¡ é » Ã©”

> ID：374573
> 
> 赞同：13
> 
> 时间：2008-12-17T13:48:00.967
> 
> 标签：jsp, tomcat, encoding, utf-8, jboss

我在 JBoss 应用程序服务器上运行 JSP 中的这个 Web 应用程序。我正在使用[Servlet 来获取友好的 url](https://stackoverflow.com/questions/359147/mask-urls-in-jsp)。我正在通过我的 JSP 和 Servlet 发送搜索参数。我正在使用带有文本框的表单，Servlet

第一个 Servlet 用于`request.getParameter()`获取文本，并将其发送到另一个 Servlet `response.sendRedirect`（将 URL 屏蔽为“友好”的东西）。这个最终的 Servlet 用于`request.getRequestDispatcher().forward()`以“丑陋”的方式将参数发送到 JSP `searchResults.jsp?searchParameters=Parameters`：.

现在，当显示搜索结果页面时，URL 会显示带有“友好 url”的正确搜索词。示例：`http://site.com/search/My-Search-Query`即使使用特殊字符，例如：`http://site.com/search/Busqué-tildes-y-eñies`. 但是当我尝试在我的 JSP 中使用该搜索词时，特殊字符无法正确显示。

整个系统使用i18n，到目前为止我们没有遇到特殊字符的问题。但是当信息通过表单发送时（比如从 index.jsp 到 searchResults.jsp），特殊字符不会正确显示：

`á - Ã¡`
`é - Ã©`
`í - Ã`
`ó - Ã³`
`ú - Ãº`
`ñ - Ã±`

整个代码库应该是 UTF-8，但显然我在传递参数时遗漏了一些东西。正如我所说，它们正确显示在 URL 中，但不在 JSP 中。

我正在考虑`Ã¡`手动转换它们，但我想有一种更好的方法可以正确地使用正确的编码。此外，以后可能会有我现在可能不知道的新字符（法语、西班牙语等）

以防万一，我会让你知道我在每个 JSP 上都有这些行：

`<?xml version="1.0" encoding="UTF-8" ?>`
`<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>`

**编辑**

感谢您的回答。我尝试了几件事，但没有解决问题。

这是我所做的：

*   我添加了一个 ServletRequestListener，它将会话的字符编码设置为 UTF-8，并为每个 Http 请求添加了一个过滤器，其作用相同。

*   正如我所说，JSP 中的所有内容都使用 UTF-8 编码（请参阅相关标题）。

*   我将 Servlet 的字符编码打印到控制台，默认情况下为空，将它们设置为 UTF-8，就像 @kgiannakakis 和 @saua 说的那样。

这些操作都不能解决问题。我想知道这是否还有其他问题...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-20T19:17:12.350

尝试在 {jboss.server}/deploy/jboss-web.deployer/server.xml 中设置 URIEncoding。

前任：

```
<Connector port="8080" address="${jboss.bind.address}"    
     maxThreads="250" maxHttpHeaderSize="8192"
     emptySessionPath="true" protocol="HTTP/1.1"
     enableLookups="false" redirectPort="8443" acceptCount="100"
     connectionTimeout="20000" disableUploadTimeout="true" URIEncoding="UTF-8" /> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-17T14:08:35.667

Just a wild guess. Try this inside your JSP/Servlet:

```
if(request.getCharacterEncoding() == null) {
   request.setCharacterEncoding("UTF-8");
} 
```

You need to be sure that the correct encoding is passed to your servlet.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-09-20T08:31:46.143

response.setCharacterEncoding("UTF-8");

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T14:15:32.597

The problem is that the information sent by the browser hasn't got a well-defined encoding and there's no way in HTTP to specify it.

Luckily most browsers will use the encoding of the page that contains the form. So if you use UTF-8 in all your pages, then most browsers will send all data in UTF-8 encoding as well (and your examples show that that's exactly how it is sent).

Unfortunately the most common Java application servers don't really handle the case (can't blame them, it's mostly guesswork anyway).

You can tell your application server to treat any input as UTF-8, by calling

```
request.setCharacterEncoding("UTF-8"); 
```

Based on your coding style and the frameworks you use, it might be to late when the control flow reaches your code, so it might be possible to do that in a `javax.servlet.Filter`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-18T11:17:27.930

检查您的 tomcat 配置中的连接器设置。您可以设置一个选项 (URIEncoding) 以将 URI 视为 UTF-8。默认情况下，它们被视为 ISO-8859-1。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-12T23:14:18.023

我们遇到了类似的问题。当所有的 JSP 都使用 UTF-8 BOM 保存时，这个问题就解决了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-17T14:02:18.207

First off, I have no idea *how* to solve this, since I don't know much about Java and JSP.

Having said that: the characters on the right-hand side of your table are the UTF-8 encoding of the left-hand side. That is, somewhere in your code, you're interpreting bytes as Latin-1 (or whatever your default encoding is), where they actually represent UTF-8 encoded characters...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-17T14:09:19.240

I think the problem might be that the browser does not specify the form post to be utf-8\. There is a lot to read about form posts and encodings on the web, multiple web frameworks provide character encoding filters to 'fix' this issue, maybe just like your idea for a fix was - see for example [http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/filter/CharacterEncodingFilter.html](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/filter/CharacterEncodingFilter.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-15T07:57:33.087

你使用 RequestDumper 吗？如果它是在 deploy/jboss-web.deployer/server.xml 中配置的，那么尝试删除它然后测试你的编码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-16T19:15:17.157

需要配置三层。根据您的描述，听起来您的问题在于数据库配置。

1.  **浏览器显示和表单提交**

JSP

```
<%@page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8"%> 
```

HTML

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

2.  **网络服务器处理**

JSP

```
<%
  request.setCharacterEncoding("UTF-8");
  String name = request.getParameter("NAME");
%> 
```

Servlet 中的相同类型的事物。[请参阅此答案](https://stackoverflow.com/a/27990314/1594449)中的 JBoss 特定解决方案以及完整的服务器独立解决方案。

3.  **数据库设置**

您可能会丢失数据库级别的字符信息。检查以确保您的数据库编码也是 UTF-8，而不是 ASCII。

有关此主题的完整讨论，请参阅 Java 文章[Character Conversions from Browser to Database](http://www.oracle.com/technetwork/articles/javase/httpcharset-142283.html)。

# java - How to append the contents of a list at the end of the other list?

> ID：374586
> 
> 赞同：20
> 
> 时间：2008-12-17T13:51:42.300
> 
> 标签：java, list, collections

How do I append the contents of one list at the end of another list?

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-17T13:53:49.193

[`List.addAll()`](http://java.sun.com/javase/6/docs/api/java/util/List.html#addAll(java.util.Collection))

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-02-24T12:40:22.230

listA.addAll(listB)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-06T04:59:37.987

```
List finalist = a + b 
```

Example:

```
List a = [1,4]
List b = [2,3]
List c = a+b 
```

Result:

```
c = [1, 4, 2, 3] 
```

# excel - 如何在客户端计算机上创建多选项卡 Excel 工作簿？

> ID：374597
> 
> 赞同：0
> 
> 时间：2008-12-17T13:56:28.907
> 
> 标签：excel

我在数据预览页面上有一系列选项卡式网格。我现在需要将每个网格中的数据导入 Excel 工作簿中自己的工作表中。

我怎么能这样做？

顺便说一句，这是在 Mac 或 PC 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T14:00:40.677

这是.net C#

```
Response.Clear();
Response.Buffer = true;
Response.AddHeader("content-disposition:", "attachment;filename=filename.xls");
Response.Charset = "";
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.ContentType = "application/vnd.ms-excel";
this.EnableViewState = false;
System.IO.StringWriter oStringWriter = new System.IO.StringWriter();
System.Web.UI.HtmlTextWriter oHtmlTextWriter = new  System.Web.UI.HtmlTextWriter(oStringWriter);
this.ClearControls(Grid);
Grid.RenderControl(oHtmlTextWriter); 
```

如果要在单个工作簿中创建多个工作表，则必须使用 dll。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T14:07:30.880

我过去以两种方式做到了这一点：

1.  使用 Excel 自动化，并使用服务器上的 Excel API 创建多个工作表。（不推荐，但它确实有效。）

2.  创建您在 Excel 中保存等效电子表格并按照 Samiksha 的建议上传时看到的 XML。

    通常我在 Excel 中创建一个模板，保存为 XML，然后根据我要显示的数据更改它的内容。

# xsd - 如何从具有常见包含的 xsd 生成多个类？

> ID：374600
> 
> 赞同：2
> 
> 时间：2008-12-17T13:57:09.170
> 
> 标签：xsd, code-generation, include

阿罗哈

我收到了一些不错的 xsd 文件，我想将它们转换为类（使用 xsd.exe）所有 xsd 都具有相同的包含，如下所示：

```
<xs:include schemaLocation="kstypes.xsd" />
<xs:include schemaLocation="ksparams.xsd" /> 
```

当我为每个 xsd 生成一个类时，这些文件中声明的类型对于每个原始 xsd 都是重复的。有什么简单的方法可以 1) 只生成包含的 xsd 中的类型一次和 2) 确保所有其他类都使用这些类型？

-Edoode

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T14:26:23.353

查看文档，似乎“最好”的方法（不是一种简单的方法！）是在第二个和后续文件上使用 /element: *elementname*命令行开关来指定您希望为其生成类的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-23T03:40:00.303

尝试此处概述的方法：http: [//blog.hosca.com/blog/fpmlgen/](http://blog.hosca.com/blog/fpmlgen/)

# java - 需要 SWT 通知动画框（又名烤面包机）

> ID：374605
> 
> 赞同：2
> 
> 时间：2008-12-17T13:59:32.973
> 
> 标签：java, user-interface, swt, desktop, desktop-application

在Java项目（SWT桌面应用程序）中，我想通过动画通知框通知用户事件（实际上，它不需要动画）。类似于 MSN 或任何其他 IM 客户端。

Swing有[JToaster](http://jtoaster.sourceforge.net/)，但我想知道是否没有其他基于 SWT 的实现。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-01-09T16:23:52.507

如果您想创建基于 SWT 的系统通知，这是开始的最佳资源：

[http://hexapixel.com/2009/06/30/creating-a-notification-popup-widget](http://hexapixel.com/2009/06/30/creating-a-notification-popup-widget)

作者创建了真正的系统通知，这些通知可以堆叠并很好地淡出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T14:06:12.507

Eclipse的[MyLyn](http://www.eclipse.org/mylyn)插件就是这样做的。由于它是开源的，也许您可​​以查看 MyLyn 代码以了解它是如何完成的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T16:29:42.247

检查[来自 Novocode 的 BallonWindow](http://www.novocode.com/swt/)，它的功能与您的需求类似，无需深入研究开源项目。它不是动画的，但它确实将通知显示为具有不规则背景的单独窗口。

我有一篇[博客文章](http://www.jroller.com/ortegon/entry/custom_tooltip_using_eclipse_3)解释了它的用法。

# linker - 为了在 C++ Builder 2009 中成功链接 C++ Builder 6 项目而没有未解决的对 CodeGuard 事物的外部引用，我应该怎么做？

> ID：374606
> 
> 赞同：1
> 
> 时间：2008-12-17T13:59:38.650
> 
> 标签：linker, c++builder, c++builder-2009, codeguard

这是我所做的：

1.  我在 C++ Builder 2009 中打开了一个 C++ Builder 6 - 项目。
2.  将其自动转换为 C++ Builder 2009 项目。
3.  告诉它（*C++ Builder 2009*）构建一切。

这是*它*所做的：

1.  成功编译一切。
2.  未能完成 ILINK32，退出

    ```
    "Error: Unresolved external '_CG_DESC' referenced from MyProjectsFirstFile.obj". 
    ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-18T21:06:51.207

它看起来像 Code Guard 错误。尝试删除所有对象 (.obj) 文件并重建整个项目。

如果这仍然不起作用，则关闭 C++Builder 6 中的 Code Guard 选项并尝试再次导入项目。

您可能还想尝试[CodeGear/Embarcadero 论坛](https://forums.codegear.com/category.jspa?categoryID=8)。

参考： [https ://forums.codegear.com/thread.jspa?messageID=52470&tstart=0](https://forums.codegear.com/thread.jspa?messageID=52470&tstart=0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-07T21:19:45.237

永远不要让 IDE 从旧版本自动升级项目。它永远无法正常工作。相反，请始终新建一个新项目，并根据需要将现有源文件添加到其中。

# ruby - 如何有条件地从 Ruby 中的二维数组中删除整个列？

> ID：374618
> 
> 赞同：1
> 
> 时间：2008-12-17T14:06:31.990
> 
> 标签：ruby, csv

我有几个包含数千列的大型 csv 文件，我需要导入这些文件，然后删除基于列内容的整个列。有没有一种简单的方法可以在 Ruby 中处理这个问题？

我可以转置数据，然后只删除行，但我想知道是否有一种在语法上更含糖的方式来做这件事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T14:09:07.413

您需要迭代行并使用`Array#slice!`.

就像是：

```
my_array.each do |row|
  row.slice!(3) if <insert condition>
end 
```

应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T16:42:37.743

由于您需要将 csv 中的所有列分配给数据库中的列，因此您只需忽略 csv 中不需要的列。[这篇](http://satishonrails.wordpress.com/2007/07/18/how-to-import-csv-file-in-rails/)博文有一个很好的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T19:24:25.873

在黑暗中拍摄，但如果标准足够简单，并且您可以以某种方式对数据进行采样以查看需要删除哪些列，也许您可​​以首先跳过导入列，如果可能的话，这应该更快而不是切片，这是另一种方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T20:24:19.350

我最终使用转置，然后使用 reverse_each 从底行切片开始工作！在需要删除的行上。谢谢您的帮助。

# python - 我怎样才能找到一个集合的所有子集，正好有 n 个元素？

> ID：374626
> 
> 赞同：80
> 
> 时间：2008-12-17T14:09:18.973
> 
> 标签：python

我正在用 Python 编写一个程序，我意识到我需要解决的一个问题需要我，给定一个`S`包含`n`元素 (|S|=n) 的集合，在某个顺序的所有可能子集上测试一个函数`m`（即使用*m*元素的数量）。要使用答案产生部分解，然后再使用下一个命令 m=m+1 重试，直到 m=n。

我正在编写以下形式的解决方案：

```
def findsubsets(S, m):
    subsets = set([])
    ...
    return subsets 
```

但是知道 Python 我希望解决方案已经存在。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2008-12-17T14:15:07.777

如果您有 Python 2.6 或更高版本， [itertools.combinations是您的朋友。](http://docs.python.org/library/itertools.html#itertools.combinations)否则，请检查链接以获取等效功能的实现。

```
import itertools
def findsubsets(S,m):
    return set(itertools.combinations(S, m)) 
```

S：要为其查找子集的集合
m：子集中的元素数

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2013-06-04T10:41:13.173

使用规范函数从[itertools 配方](https://docs.python.org/library/itertools.html#recipes)页面获取[powerset ：](http://en.wikipedia.org/wiki/Power_set)

```
from itertools import chain, combinations

def powerset(iterable):
    """
    powerset([1,2,3]) --> () (1,) (2,) (3,) (1,2) (1,3) (2,3) (1,2,3)
    """
    xs = list(iterable)
    # note we return an iterator rather than a list
    return chain.from_iterable(combinations(xs,n) for n in range(len(xs)+1)) 
```

像这样使用：

```
>>> list(powerset("abc"))
[(), ('a',), ('b',), ('c',), ('a', 'b'), ('a', 'c'), ('b', 'c'), ('a', 'b', 'c')]

>>> list(powerset(set([1,2,3])))
[(), (1,), (2,), (3,), (1, 2), (1, 3), (2, 3), (1, 2, 3)] 
```

如果需要，可以映射到集合，以便可以使用联合、交集等...：

```
>>> map(set, powerset(set([1,2,3])))
[set([]), set([1]), set([2]), set([3]), set([1, 2]), set([1, 3]), set([2, 3]), set([1, 2, 3])]

>>> reduce(lambda x,y: x.union(y), map(set, powerset(set([1,2,3]))))
set([1, 2, 3]) 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-01-11T19:16:23.330

这是一个函数，它为您提供整数 [0..n] 的所有子集，而不仅仅是给定长度的子集：

```
from itertools import combinations, chain

def allsubsets(n):
    return list(chain(*[combinations(range(n), ni) for ni in range(n+1)])) 
```

所以例如

```
>>> allsubsets(3)
[(), (0,), (1,), (2,), (0, 1), (0, 2), (1, 2), (0, 1, 2)] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-02-21T16:57:36.477

Here is one neat way with easy to understand algorithm.

```
import copy

nums = [2,3,4,5]
subsets = [[]]

for n in nums:
    prev = copy.deepcopy(subsets)
    [k.append(n) for k in subsets]
    subsets.extend(prev)

print(subsets) 
print(len(subsets))

# [[2, 3, 4, 5], [3, 4, 5], [2, 4, 5], [4, 5], [2, 3, 5], [3, 5], [2, 5], [5], 
# [2, 3, 4], [3, 4], [2, 4], [4], [2, 3], [3], [2], []]

# 16 (2^len(nums)) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-16T02:10:51.600

这是一些伪代码 - 您可以通过在执行过程中存储每个调用的值以及在递归调用检查调用值是否已经存在之前来减少相同的递归调用。

以下算法将具有除空集之外的所有子集。

```
list * subsets(string s, list * v) {

    if(s.length() == 1) {
        list.add(s);    
        return v;
    }
    else
    {
        list * temp = subsets(s[1 to length-1], v);
        int length = temp->size();

        for(int i=0;i<length;i++) {
            temp.add(s[0]+temp[i]);
        }

        list.add(s[0]);
        return temp;
    }
} 
```

因此，例如，如果 s = "123" 则输出为：

```
1
2
3
12
13
23
123 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-04-22T14:14:51.163

**不使用`itertools`**：

In Python 3 you can use `yield from` to add a subset generator method to buit-in `set` class:

```
class SetWithSubset(set):
    def subsets(self):
        s1 = []
        s2 = list(self)

        def recfunc(i=0):            
            if i == len(s2):
                yield frozenset(s1)
            else:                
                yield from recfunc(i + 1)
                s1.append(s2[ i ])
                yield from recfunc(i + 1)
                s1.pop()

        yield from recfunc() 
```

For example below snippet works as expected:

```
x = SetWithSubset({1,2,3,5,6})
{2,3} in x.subsets()            # True
set() in x.subsets()            # True
x in x.subsets()                # True
x|{7} in x.subsets()            # False
set([5,3]) in x.subsets()       # True - better alternative: set([5,3]) < x
len(x.subsets())                # 32 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-28T05:50:21.380

`$ python -c "import itertools; a=[2,3,5,7,11]; print sum([list(itertools.combinations(a, i)) for i in range(len(a)+1)], [])" [(), (2,), (3,), (5,), (7,), (11,), (2, 3), (2, 5), (2, 7), (2, 11), (3, 5), (3, 7), (3, 11), (5, 7), (5, 11), (7, 11), (2, 3, 5), (2, 3, 7), (2, 3, 11), (2, 5, 7), (2, 5, 11), (2, 7, 11), (3, 5, 7), (3, 5, 11), (3, 7, 11), (5, 7, 11), (2, 3, 5, 7), (2, 3, 5, 11), (2, 3, 7, 11), (2, 5, 7, 11), (3, 5, 7, 11), (2, 3, 5, 7, 11)]`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-17T09:37:51.790

```
>>>Set = ["A", "B","C","D"]
>>>n = 2
>>>Subsets=[[i for i,s in zip(Set, status) if int(s)  ] for status in [(format(bit,'b').zfill(len(Set))) for bit in range(2**len(Set))] if sum(map(int,status)) == n]
>>>Subsets
[['C', 'D'], ['B', 'D'], ['B', 'C'], ['A', 'D'], ['A', 'C'], ['A', 'B']] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-11T16:34:31.037

Another solution using recursion:

```
def subsets(nums: List[int]) -> List[List[int]]:
    n = len(nums)
    output = [[]]

    for num in nums:
        output += [curr + [num] for curr in output]

    return output 
```

Starting from empty subset in output list. At each step we take a new integer into consideration and generates new subsets from the existing ones.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-21T13:40:39.653

Here is an implementation using simple recursion from first principles. Base case: if there are no elements then return the empty set. Recursive case: choose an element and return all subsets of the other elements with and without the chosen element added.

```
def _all_subsets(s):
    seq = list(s)
    if not seq:
        yield set([])
    else:
        choice = set([seq[0]])
        others = seq[1:]
        for without_choice in _all_subsets(others):
            yield without_choice
            yield choice | without_choice

def all_subsets(iterable):
    s = set(iterable)
    for x in _all_subsets(s):
        yield x 
```

# configuration - 库中未附加 ASP.NET 配置

> ID：374628
> 
> 赞同：0
> 
> 时间：2008-12-17T14:09:28.710
> 
> 标签：configuration, web-config, asp.net-2.0

我正在开发一个包含两个项目的解决方案：一个 ASP.NET Web 应用程序和一个自定义 Web 控件库。自定义控件库用于 asp.net 应用程序。编译解决方案时，自定义web控件库的app.config文件没有和dll一起传到ASP.NET应用程序bin文件夹下？我怎样才能做到这一点？从该配置文件中读取的正确类是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T14:31:50.660

当您从 Web 应用程序的上下文运行库时，所使用的 .config 文件仅基于该上下文。因此，您拥有的设置必须在 web.config 中用于 Web 使用，在 app.config 中用于独立/表单使用。

我过去使用的一种解决方案是编写自己的逻辑，将嵌入式设置文件从库中导出到工作目录，并始终直接从工作目录路径引用该文件。这意味着您可以在任何上下文中使用库设置，但要确保设置的单一联系人可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T14:42:48.407

**System.Configuration.ConfigurationManager.AppSettings**是您访问的 NameValueCollection。

还值得一提的是 machine.config 在配置方面可以有发言权，无论好坏。

常见问题解答[在这里](http://forums.asp.net/p/1117776/1736929.aspx)。

# .net - Script.Net vs Nemerle

> ID：374635
> 
> 赞同：1
> 
> 时间：2008-12-17T14:11:26.067
> 
> 标签：.net, scripting, dynamic-languages, static-typing, nemerle

我正在研究将脚本整合到我的应用程序中。然后我碰到了[Script.Net](http://www.protsyk.com/scriptdotnet/)和[Nemerle](http://nemerle.org/Main_Page)。我知道它们有不同的语法，Nemerle 支持宏但不支持 Script.Net。但我想更多地了解它们在功能、用法和灵活性方面的差异。你会推荐哪一个，为什么？

谢谢。

抱歉，我没有注意到 Nemerle 本身就是一种语言。描述似乎是一种脚本语言。感谢和抱歉造成的混乱

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T14:20:21.370

Nemerle 是一种静态类型语言，在 nemerle 网站上找不到脚本这个词。

如果我要向应用程序添加脚本，我会考虑使用 IronPython。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-19T20:36:53.350

您好，我是 Nemerle 的开发人员之一。您可以查看我的帖子，了解如何使用 nemerle 运行动态代码。[不要等待 C# 5](http://reverseblade.blogspot.com/2009/02/dont-wait-for-c-5-use-nemerle.html) 虽然 nemerle 是一种静态类型语言。如果您的最终目标是编写脚本，它不适合

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T14:38:49.210

你的意思不是特定领域的语言吗？我会考虑用 boo 创建你自己的 DSL。[关于它的预订链接](http://www.manning.com/rahien/rahien_meapch1.pdf)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-26T15:46:32.103

如果您想将脚本引擎嵌入到您的 .net 中，它可能取决于您或您的用户想要使用的语言：

Javascript：Script.NET、Jint

蟒蛇：铁蟒

类 Python：嘘

红宝石：铁红宝石

C#：CS 脚本

方案：IronScheme

如果您想获得 .NET 和 Java 编程语言的完整列表（其中一些您可以用来将脚本支持嵌入到您的应用程序中），您可以访问我的博客，我在这里讨论了或多或少的 20 种语言：）

[http://carlosqt.blogspot.com/p/programming-languages.html](http://carlosqt.blogspot.com/p/programming-languages.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T14:33:58.707

您可能需要考虑除您发布的 2 之外的其他选择。到目前为止，我为 .Net 找到的最好的是：[CSScript](http://www.csscript.net/)。我需要一些时间来习惯安装它，但是一旦安装它，它就可以很好地工作，而且你使用 C# 编写脚本，所以不需要 2 种语言。

# html - Help Me Solve Font Sizing Issue

> ID：374642
> 
> 赞同：2
> 
> 时间：2008-12-17T14:14:37.637
> 
> 标签：html, css, fonts, rendering

There's been this ongoing display issue my team has been having with the font size rendering larger than it should within the product. We've been having a heck of time pinpointing what it is.

Here's a screenshot of a before and after shot: [http://quickbase.intuit.com/images/font-issue.gif](http://quickbase.intuit.com/images/font-issue.gif)

Notice that in the before, it looks like the browser zoom has been zoomed in - but it hasn't. The only cure is to refresh the page and it goes away.

Other things you should know: - We've tried comparing the source of the html/css when the bug happens and when it doesn't. They're the same. - It happens in FF and Safari. (I rarely use IE so I can't confirm it happens there). - It's intermittent. You have to click around a lot and load a bunch of pages before it happens it again. - Firebug is showing all of the elements on the page as loading fully (no partial content)

Any ideas on what it could be?

Thanks,

JM

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T15:10:54.513

过去，我在 quickbase（和其他应用程序）上遇到过同样的问题。我总是把它归结为一些没有加载的外部资源（css或javascript）。我对此充满信心，因为我知道它发生的其中一个应用程序并不复杂。

* * *

更多信息：

我注意到您的 body 类是动态创建的，其中一种样式是“stdBody”。我怀疑你脚本的那部分在某个地方搞砸了。也许某处的服务器缓存？当我进入并杀死 70% 的字体大小时，我得到了你的造型前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T14:19:03.290

Run some validator on your code, perhaps there's some error in the HTML code or in a script that enlarges the font.

# javascript - 如何捕获 form.submit 的响应

> ID：374644
> 
> 赞同：153
> 
> 时间：2008-12-17T14:15:01.850
> 
> 标签：javascript, forms, dom-events, form-submit

我有以下代码：

```
<script type="text/javascript">
        function SubmitForm()
        {

            form1.submit();
        }

        function ShowResponse()
        {

        }
</script>
.
.
.
<div>
    <a href="#" onclick="SubmitForm();">Click</a>
</div> 
```

我想捕获的 html 响应`form1.submit`？我该怎么做呢？我可以向 form1.submit 方法注册任何回调函数吗？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2008-12-17T14:25:03.093

您将无法使用纯 javascript 轻松做到这一点。当您发布表单时，表单输入被发送到服务器并刷新您的页面 - 数据在服务器端处理。也就是说，该`submit()`函数实际上并没有返回任何内容，它只是将表单数据发送到服务器。

如果您真的想在 Javascript 中获得响应（无需刷新页面），那么您将需要使用 AJAX，而当您开始谈论使用 AJAX 时，您将*需要*使用库。[jQuery](http://www.jquery.com)是迄今为止最受欢迎的，也是我个人的最爱。有一个很棒的 jQuery 插件，叫做[Form](http://malsup.com/jquery/form/)，它会完全按照你想要的那样做。

下面是你如何使用 jQuery 和那个插件：

```
$('#myForm')
    .ajaxForm({
        url : 'myscript.php', // or whatever
        dataType : 'json',
        success : function (response) {
            alert("The server says: " + response);
        }
    })
; 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2008-12-17T14:27:33.790

Ajax 的替代方法是将一个不可见的对象设置为表单的目标，并在其处理程序中`<iframe>`读取该对象的内容。但是，当有 Ajax 时，为什么还要麻烦呢？`<iframe>``onload`

**注意：**我只是想提一下这个替代方案，因为一些答案声称没有 Ajax 就**不可能**实现这一点。

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2017-12-06T13:19:48.223

非 jQuery vanilla Javascript 方式，摘自 12me21 的评论：

```
var xhr = new XMLHttpRequest();
xhr.open("POST", "/your/url/name.php"); 
xhr.onload = function(event){ 
    alert("Success, server responded with: " + event.target.response); // raw response
}; 
// or onerror, onabort
var formData = new FormData(document.getElementById("myForm")); 
xhr.send(formData); 
```

For`POST`的默认内容类型是“application/x-www-form-urlencoded”，它与我们在上述代码段中发送的内容相匹配。如果您想发送“其他东西”或以某种方式对其进行调整，请参阅[此处](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest)了解一些细节。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2018-08-07T15:08:40.477

未来的互联网搜索者：

对于新浏览器（截至 2018 年：Chrome、Firefox、Safari、Opera、Edge 和大多数移动浏览器，但不包括 IE），**`fetch`是一个标准 API，可简化异步网络调用**（我们过去需要`XMLHttpRequest`或 jQuery 的`$.ajax`）。

这是一个传统的形式：

```
<form id="myFormId" action="/api/process/form" method="post">
    <!-- form fields here -->
    <button type="submit">SubmitAction</button>
</form> 
```

如果将上面的表单交给您（或者您创建它是因为它是语义 html），那么您可以将`fetch`代码包装在事件侦听器中，如下所示：

```
document.forms['myFormId'].addEventListener('submit', (event) => {
    event.preventDefault();
    // TODO do something here to show user that form is being submitted
    fetch(event.target.action, {
        method: 'POST',
        body: new URLSearchParams(new FormData(event.target)) // event.target is the form
    }).then((resp) => {
        return resp.json(); // or resp.text() or whatever the server sends
    }).then((body) => {
        // TODO handle body
    }).catch((error) => {
        // TODO handle error
    });
}); 
```

（或者，如果像原始海报一样，您想在没有提交事件的情况下手动调用它，只需将`fetch`代码放在那里并传递对`form`元素的引用而不是使用`event.target`.）

文件：

获取： [https ://developer.mozilla.org/en-US/docs/Web/API/Fetch_API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)

其他： [https](https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Sending_forms_through_JavaScript) ://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Sending_forms_through_JavaScript 2018 年的那个页面还没有提到 fetch。但它提到 target="myIFrame" 技巧已被弃用。它还有一个用于“提交”事件的 form.addEventListener 示例。

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2014-03-21T19:24:56.470

我正在这样做并且它的工作原理。

```
$('#form').submit(function(){
    $.ajax({
      url: $('#form').attr('action'),
      type: 'POST',
      data : $('#form').serialize(),
      success: function(){
        console.log('form submitted.');
      }
    });
    return false;
}); 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-12-17T14:20:14.147

我不确定您是否了解 submit() 的作用...

当您这样做时`form1.submit();`，表单信息将发送到网络服务器。

WebServer 将做它应该做的任何事情，并将一个全新的网页返回给客户端（通常是相同的页面，但有一些改变）。

因此，您无法“捕捉” form.submit() 操作的返回。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-17T14:20:49.963

没有回调。这就像跟随一个链接。

如果要捕获服务器响应，请使用 AJAX 或将其发布到 iframe 并获取 iframe`onload()`事件之后出现的内容。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-05-11T20:42:53.503

您可以`event.preventDefault()`在提交按钮的单击处理程序中确保`submit`不会触发 HTML 表单默认事件（这会导致页面刷新）。

另一种选择是使用更骇人听闻的表单标记：它的使用`<form>`阻碍`type="submit"`了此处所需的行为；因为这些最终会导致点击事件刷新页面。

如果您仍想使用`<form>`，并且不想编写自定义点击处理程序，则可以使用 jQuery 的方法，该方法通过公开、等`ajax`的承诺方法为您抽象出整个问题。`success``error`

* * *

回顾一下，您可以通过以下任一方式解决您的问题：

• 通过使用防止处理函数中的默认行为`event.preventDefault()`

• 使用没有默认行为的元素（例如`<form>`）

• 使用 jQuery`ajax`

* * *

（我刚刚注意到这个问题来自 2008 年，不知道为什么它会出现在我的提要中；无论如何，希望这是一个明确的答案）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-04-29T07:43:52.910

```
 $.ajax({
        url: "/users/login/",    //give your url here
        type: 'POST',
        dataType: "json",
        data: logindata,
        success: function ( data ){
        //  alert(data);    do your stuff
        },
        error: function ( data ){
        //  alert(data);    do your stuff
        }
    }); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-07-20T07:04:18.213

这是我解决这个问题的代码：

```
<form id="formoid" action="./demoText.php" title="" method="post">
    <div>
        <label class="title">First Name</label>
        <input type="text" id="name" name="name" >
    </div>
    <div>
        <input type="submit" id="submitButton"  name="submitButton" value="Submit">
    </div>
</form>

<script type='text/javascript'>
/* attach a submit handler to the form */
$("#formoid").submit(function(event) {

  /* stop form from submitting normally */
  event.preventDefault();

  /* get the action attribute from the <form action=""> element */
  var $form = $( this ), url = $form.attr( 'action' );

  /* Send the data using post with element id name and name2*/
  var posting = $.post( url, { name: $('#name').val()} );

  /* Alerts the results */
  posting.done(function( data ) {
    alert('success');
  });
});
</script> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-10-07T15:29:48.563

如果您想使用 Chrome 捕获 AJAX 请求的输出，您可以按照以下简单步骤操作：

1.  打开程序员工具箱
2.  转到控制台并在其中的任何位置
3.  在出现的菜单中，单击“启用 XMXHTTPRequest 日志记录”
4.  每次您发出 AJAX 请求时，都会在您的控制台中显示以“XHR 完成加载：http://......”开头的消息。
5.  单击出现的链接，将带来“资源选项卡”，您可以在其中看到响应的标题和内容！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-09-08T21:58:28.657

基于@rajesh_kw（[https://stackoverflow.com/a/22567796/4946681](https://stackoverflow.com/a/22567796/4946681)）的答案，我处理表单发布错误和成功：

```
 $('#formName').on('submit', function(event) {
        event.preventDefault(); // or return false, your choice
        $.ajax({
            url: $(this).attr('action'),
            type: 'post',
            data: $(this).serialize(),
            success: function(data, textStatus, jqXHR) {
                // if success, HTML response is expected, so replace current
                if(textStatus === 'success') {
                    // https://stackoverflow.com/a/1236378/4946681
                    var newDoc = document.open('text/html', 'replace');
                    newDoc.write(data);
                    newDoc.close();
                }
            }
        }).fail(function(jqXHR, textStatus, errorThrown) {
            if(jqXHR.status == 0 || jqXHR == 302) {
                alert('Your session has ended due to inactivity after 10 minutes.\nPlease refresh this page, or close this window and log back in to system.');
            } else {
                alert('Unknown error returned while saving' + (typeof errorThrown == 'string' && errorThrown.trim().length > 0 ? ':\n' + errorThrown : ''));
            }
        });
    }); 
```

我利用`this`以便我的逻辑可重用，我希望 HTML 成功返回，所以我渲染它并替换当前页面，在我的情况下，如果会话超时，我希望重定向到登录页面，所以我拦截该重定向以保留页面的状态。

现在用户可以通过另一个选项卡登录并再次尝试提交。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-07-26T04:07:51.243

我有以下代码使用 ajax 和多部分表单数据完全运行

```
function getUserDetail()
{
    var firstName = document.getElementById("firstName").value;
    var lastName = document.getElementById("lastName").value;
    var username = document.getElementById("username").value;
    var email = document.getElementById("email").value;
    var phoneNumber = document.getElementById("phoneNumber").value;
    var gender =$("#userForm input[type='radio']:checked").val();
    //var gender2 = document.getElementById("gender2").value;
    //alert("fn"+firstName+lastName+username+email);
    var roleIndex = document.getElementById("role");
    var role = roleIndex.options[roleIndex.selectedIndex].value;
    var jobTitleIndex = document.getElementById("jobTitle");
    var jobTitle = jobTitleIndex.options[jobTitleIndex.selectedIndex].value;
    var shiftIdIndex = document.getElementById("shiftId");
    var shiftId = shiftIdIndex.options[shiftIdIndex.selectedIndex].value;

    var addressLine1 = document.getElementById("addressLine1").value;
    var addressLine2 = document.getElementById("addressLine2").value;
    var streetRoad = document.getElementById("streetRoad").value;

    var countryIndex = document.getElementById("country");
    var country = countryIndex.options[countryIndex.selectedIndex].value;

    var stateIndex = document.getElementById("state");
    var state = stateIndex.options[stateIndex.selectedIndex].value;

    var cityIndex = document.getElementById("city");
    var city = cityIndex.options[cityIndex.selectedIndex].value;

    var pincode = document.getElementById("pincode").value;

    var branchIndex = document.getElementById("branch");
    var branch = branchIndex.options[branchIndex.selectedIndex].value;

    var language = document.getElementById("language").value;
    var profilePicture = document.getElementById("profilePicture").value;
    //alert(profilePicture);
    var addDocument = document.getElementById("addDocument").value;

    var shiftIdIndex = document.getElementById("shiftId");
    var shiftId = shiftIdIndex.options[shiftIdIndex.selectedIndex].value;

    var data = new FormData();
    data.append('firstName', firstName);
    data.append('lastName', lastName);
    data.append('username', username);
    data.append('email', email);
    data.append('phoneNumber', phoneNumber);
    data.append('role', role);
    data.append('jobTitle', jobTitle);
    data.append('gender', gender);
    data.append('shiftId', shiftId);
    data.append('lastName', lastName);
    data.append('addressLine1', addressLine1);
    data.append('addressLine2', addressLine2);
    data.append('streetRoad', streetRoad);
    data.append('country', country);
    data.append('state', state);
    data.append('city', city);
    data.append('pincode', pincode);
    data.append('branch', branch);
    data.append('language', language);
    data.append('profilePicture', $('#profilePicture')[0].files[0]);
     for (var i = 0; i < $('#document')[0].files.length; i++) {
            data.append('document[]', $('#document')[0].files[i]);
        }

    $.ajax({
        //url : '${pageContext.request.contextPath}/user/save-user',
        type: "POST",
        Accept: "application/json",
        async: true,
        contentType:false,
        processData: false,
        data: data,
        cache: false,

        success : function(data) {      
            reset();
            $(".alert alert-success alert-div").text("New User Created Successfully!");
         },
       error :function(data, textStatus, xhr){
           $(".alert alert-danger alert-div").text("new User Not Create!");
        }

    });

//

} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-17T14:19:19.437

您需要使用 AJAX。提交表单通常会导致浏览器加载一个新页面。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-17T14:24:09.693

您可以使用 javascript 和 AJAX 技术来做到这一点。看看 jquery 和这个[表单插件](http://malsup.com/jquery/form/)。您只需要包含两个 js 文件即可为 form.submit 注册一个回调。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-10-12T05:52:03.650

您可以使用[jQuery](https://jquery.com/)和[`ajax()`](http://api.jquery.com/jquery.ajax/)方法完成此操作：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script language="javascript" type="text/javascript">
function submitform() {
      $.ajax({
        headers: { 
          'Accept': 'application/json',
          'Content-Type': 'application/json' 
        },
        type: "POST",
        url : "/hello.hello",
        dataType : "json",
        data : JSON.stringify({"hello_name": "hello"}),
        error: function () {
          alert('loading Ajax failure');
        },
    	onFailure: function () {
          alert('Ajax Failure');
    	},
    	statusCode: {
          404: function() {
          alert("missing info");
          }   
    	},
        success : function (response) {
          alert("The server says: " + JSON.stringify(response));
        }
      })
      .done(function( data ) {
        $("#result").text(data['hello']);
      });
};</script>
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-12-07T12:30:12.780

```
 $(document).ready(function() {
    $('form').submit(function(event) {
        event.preventDefault();
        $.ajax({
            url : "<wiki:action path='/your struts action'/>",//path of url where u want to submit form
            type : "POST",
            data : $(this).serialize(),
            success : function(data) {
                var treeMenuFrame = parent.frames['wikiMenu'];
                if (treeMenuFrame) {
                    treeMenuFrame.location.href = treeMenuFrame.location.href;
                }
                var contentFrame = parent.frames['wikiContent'];
                contentFrame.document.open();
                contentFrame.document.write(data);
                contentFrame.document.close();
            }
        });
    });
}); 
```

首先`$(document).ready(function())`在此使用中使用`('formid').submit(function(event))`，然后在调用ajax表单提交后阻止默认操作`$.ajax({, , , , });`

它将接受您可以根据您的要求选择的参数，然后调用一个函数

```
success:function(data) {
    // do whatever you want my example to put response html on div 
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-06-14T15:33:47.373

首先我们需要 serializeObject();

```
$.fn.serializeObject = function () {
    var o = {};
    var a = this.serializeArray();
    $.each(a, function () {
        if (o[this.name]) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
}; 
```

然后你发表一个基本的帖子并得到回应

```
$.post("/Education/StudentSave", $("#frmNewStudent").serializeObject(), function (data) {
if(data){
//do true 
}
else
{
//do false
}

}); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-11-01T16:02:48.613

您可以使用[jQuery.post()](https://api.jquery.com/jquery.post/)并从服务器返回结构良好的 JSON 答案。它还允许您直接在服务器上验证/清理您的数据，这是一种很好的做法，因为它比在客户端上执行此操作更安全（甚至更容易）。

例如，如果您需要将带有用户数据的 html 表单发布到服务器（到 saveprofilechanges.php）以进行简单注册：

一、客户端部分：

Ia HTML 部分：

```
<form id="user_profile_form">
  <label for="first_name"><input type="text" name="first_name" id="first_name" required />First name</label>
  <label for="family_name"><input type="text" name="family_name" id="family_name" required />Family name</label>
  <label for="email"><input type="email" name="email" id="email" required />Email</label> 
  <input type="submit" value="Save changes" id="submit" />
</form> 
```

Ib 脚本部分：

```
$(function () {
    $("#user_profile_form").submit(function(event) {
      event.preventDefault();
      var postData = {
        first_name: $('#first_name').val(),
        family_name: $('#family_name').val(),
        email: $('#email').val()
      };
      $.post("/saveprofilechanges.php", postData,
        function(data) {
          var json = jQuery.parseJSON(data);
          if (json.ExceptionMessage != undefined) {
            alert(json.ExceptionMessage); // the exception from the server
            $('#' + json.Field).focus(); // focus the specific field to fill in
          }
          if (json.SuccessMessage != undefined) {
            alert(json.SuccessMessage); // the success message from server
          }
       });
    });
}); 
```

二、服务器部分（saveprofilechanges.php）：

```
$data = $_POST;
if (!empty($data) && is_array($data)) {
    // Some data validation:
    if (empty($data['first_name']) || !preg_match("/^[a-zA-Z]*$/", $data['first_name'])) {
       echo json_encode(array(
         'ExceptionMessage' => "First name missing or incorrect (only letters and spaces allowed).",
         'Field' => 'first_name' // Form field to focus in client form
       ));
       return FALSE;
    }
    if (empty($data['family_name']) || !preg_match("/^[a-zA-Z ]*$/", $data['family_name'])) {
       echo json_encode(array(
         'ExceptionMessage' => "Family name missing or incorrect (only letters and spaces allowed).",
         'Field' => 'family_name' // Form field to focus in client form
       ));
       return FALSE;
    }
    if (empty($data['email']) || !filter_var($data['email'], FILTER_VALIDATE_EMAIL)) {
       echo json_encode(array(
         'ExceptionMessage' => "Email missing or incorrectly formatted. Please enter it again.",
         'Field' => 'email' // Form field to focus in client form
       ));
       return FALSE;
    }
    // more actions..
    // more actions..
    try {
       // Some save to database or other action..:
       $this->User->update($data, array('username=?' => $username));
       echo json_encode(array(
         'SuccessMessage' => "Data saved!"
       ));
       return TRUE;
    } catch (Exception $e) {
       echo json_encode(array(
         'ExceptionMessage' => $e->getMessage()
       ));
       return FALSE;
    }
} 
```

* * *

## 回答 #20

> 赞同：-6
> 
> 时间：2015-07-11T17:56:02.143

你可以在没有 ajax 的情况下做到这一点。

在下面写下你的喜欢。

.. .. ..

然后在“action.php”中

然后在 frmLogin.submit();

读取变量 $submit_return..

$submit_return 包含返回值。

祝你好运。

# c# - 如何检查一个对象是否可以为空？

> ID：374651
> 
> 赞同：223
> 
> 时间：2008-12-17T14:17:16.010
> 
> 标签：c#, .net, nullable

如何检查给定对象是否可以为空，换句话说，如何实现以下方法...

```
bool IsNullableValueType(object o)
{
    ...
} 
```

我正在寻找可为空的*值类型。*我没有想到引用类型。

```
//Note: This is just a sample. The code has been simplified 
//to fit in a post.

public class BoolContainer
{
    bool? myBool = true;
}

var bc = new BoolContainer();

const BindingFlags bindingFlags = BindingFlags.Public
                        | BindingFlags.NonPublic
                        | BindingFlags.Instance
                        ;

object obj;
object o = (object)bc;

foreach (var fieldInfo in o.GetType().GetFields(bindingFlags))
{
    obj = (object)fieldInfo.GetValue(o);
} 
```

`obj`现在引用类型为`bool`( `System.Boolean`) 的对象，其值等于`true`。我真正想要的是一个类型的对象`Nullable<bool>`

所以现在作为一种解决方法，我决定检查 o 是否可以为空，并在 obj 周围创建一个可以为空的包装器。

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2008-12-17T14:20:52.930

有两种类型的可空 -`Nullable<T>`和引用类型。

乔恩纠正了我，如果装箱很难输入，但你可以使用泛型： - 那么下面怎么样。这实际上是在测试 type `T`，但`obj`纯粹将参数用于泛型类型推断（以便于调用） - 不过，如果没有`obj`参数，它的工作方式几乎相同。

```
static bool IsNullable<T>(T obj)
{
    if (obj == null) return true; // obvious
    Type type = typeof(T);
    if (!type.IsValueType) return true; // ref-type
    if (Nullable.GetUnderlyingType(type) != null) return true; // Nullable<T>
    return false; // value-type
} 
```

但是，如果您已经将值装箱到对象变量中，这将不会那么好。

微软文档：[https ://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/nullable-types/how-to-identify-a-nullable-type](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/nullable-types/how-to-identify-a-nullable-type)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2010-11-09T08:50:55.600

使用方法重载有一个非常简单的解决方案

[http://deanchalk.com/is-it-nullable/](http://deanchalk.com/is-it-nullable/)

摘抄：

```
public static class ValueTypeHelper
{
    public static bool IsNullable<T>(T t) { return false; }
    public static bool IsNullable<T>(T? t) where T : struct { return true; }
} 
```

然后

```
static void Main(string[] args)
{
    int a = 123;
    int? b = null;
    object c = new object();
    object d = null;
    int? e = 456;
    var f = (int?)789;
    bool result1 = ValueTypeHelper.IsNullable(a); // false
    bool result2 = ValueTypeHelper.IsNullable(b); // true
    bool result3 = ValueTypeHelper.IsNullable(c); // false
    bool result4 = ValueTypeHelper.IsNullable(d); // false
    bool result5 = ValueTypeHelper.IsNullable(e); // true
    bool result6 = ValueTypeHelper.IsNullable(f); // true 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2014-04-30T20:52:20.030

这对我有用，看起来很简单：

```
static bool IsNullable<T>(T obj)
{
    return default(T) == null;
} 
```

对于值类型：

```
static bool IsNullableValueType<T>(T obj)
{
    return default(T) == null && typeof(T).BaseType != null && "ValueType".Equals(typeof(T).BaseType.Name);
} 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2011-01-03T11:58:03.667

“如何检查类型是否可以为空？”的问题 实际上是“如何检查一个类型是否是`Nullable<>`？”，可以概括为“如何检查一个类型是否是某个泛型类型的构造类型？”，因此它不仅回答了“是`Nullable<int>`一个`Nullable<>`？”的问题，还有“是`List<int>`一个`List<>`？”。

大多数提供的解决方案都使用该`Nullable.GetUnderlyingType()`方法，这显然只适用于`Nullable<>`. 我没有看到适用于任何泛型类型的通用反射解决方案，因此我决定在此处添加它以供后代使用，即使这个问题很久以前就已经得到解答。

要检查一个类型是否是`Nullable<>`使用反射的某种形式，首先必须将构造的泛型类型`Nullable<int>`转换为泛型类型定义，例如`Nullable<>`. 您可以通过使用类的`GetGenericTypeDefinition()`方法来做到这一点`Type`。然后，您可以将结果类型与`Nullable<>`：

```
Type typeToTest = typeof(Nullable<int>);
bool isNullable = typeToTest.GetGenericTypeDefinition() == typeof(Nullable<>);
// isNullable == true 
```

这同样适用于任何泛型类型：

```
Type typeToTest = typeof(List<int>);
bool isList = typeToTest.GetGenericTypeDefinition() == typeof(List<>);
// isList == true 
```

几种类型可能看起来相同，但不同数量的类型参数意味着它是完全不同的类型。

```
Type typeToTest = typeof(Action<DateTime, float>);
bool isAction1 = typeToTest.GetGenericTypeDefinition() == typeof(Action<>);
bool isAction2 = typeToTest.GetGenericTypeDefinition() == typeof(Action<,>);
bool isAction3 = typeToTest.GetGenericTypeDefinition() == typeof(Action<,,>);
// isAction1 == false
// isAction2 == true
// isAction3 == false 
```

由于`Type`每个类型都会实例化对象一次，因此您可以检查它们之间的引用相等性。因此，如果要检查两个对象是否具有相同的泛型类型定义，可以编写：

```
var listOfInts = new List<int>();
var listOfStrings = new List<string>();

bool areSameGenericType =
    listOfInts.GetType().GetGenericTypeDefinition() ==
    listOfStrings.GetType().GetGenericTypeDefinition();
// areSameGenericType == true 
```

如果您想检查一个对象是否可以为空，而不是 a `Type`，那么您可以将上述技术与 Marc Gravell 的解决方案一起使用来创建一个相当简单的方法：

```
static bool IsNullable<T>(T obj)
{
    if (!typeof(T).IsGenericType)
        return false;

    return typeof(T).GetGenericTypeDefinition() == typeof(Nullable<>);
} 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-12-17T14:21:45.110

好吧，你可以使用：

```
return !(o is ValueType); 
```

...但是对象本身不能为空或其他 -*类型*是。你打算如何使用它？

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-03-15T02:10:23.990

我能想到的最简单的方法是：

```
public bool IsNullable(object obj)
{
    Type t = obj.GetType();
    return t.IsGenericType 
        && t.GetGenericTypeDefinition() == typeof(Nullable<>);
} 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2011-10-14T00:27:32.057

这里有两个问题：1）测试一个Type是否可以为空；2) 测试一个对象是否代表一个可为空的类型。

对于问题 1（测试类型），这是我在自己的系统中使用的解决方案：[TypeIsNullable-check solution](https://stackoverflow.com/questions/108104/how-do-i-convert-a-system-type-to-its-nullable-version/7759487#7759487)

对于问题 2（测试对象），Dean Chalk 的上述解决方案适用于值类型，但不适用于引用类型，因为使用 <T> 重载总是返回 false。由于引用类型本质上可以为空，因此测试引用类型应始终返回 true。有关这些语义的解释，请参阅下面的注释 [关于“可空性”]。因此，这是我对 Dean 方法的修改：

```
 public static bool IsObjectNullable<T>(T obj)
    {
        // If the parameter-Type is a reference type, or if the parameter is null, then the object is always nullable
        if (!typeof(T).IsValueType || obj == null)
            return true;

        // Since the object passed is a ValueType, and it is not null, it cannot be a nullable object
        return false; 
    }

    public static bool IsObjectNullable<T>(T? obj) where T : struct
    {
        // Always return true, since the object-type passed is guaranteed by the compiler to always be nullable
        return true;
    } 
```

这是我对上述解决方案的客户端测试代码的修改：

```
 int a = 123;
    int? b = null;
    object c = new object();
    object d = null;
    int? e = 456;
    var f = (int?)789;
    string g = "something";

    bool isnullable = IsObjectNullable(a); // false 
    isnullable = IsObjectNullable(b); // true 
    isnullable = IsObjectNullable(c); // true 
    isnullable = IsObjectNullable(d); // true 
    isnullable = IsObjectNullable(e); // true 
    isnullable = IsObjectNullable(f); // true 
    isnullable = IsObjectNullable(g); // true 
```

我在 IsObjectNullable<T>(T t) 中修改 Dean 的方法的原因是他的原始方法对于引用类型总是返回 false。由于像 IsObjectNullable 这样的方法应该能够处理引用类型的值，并且由于所有引用类型本质上都是可以为空的，因此如果传递了引用类型或 null，则该方法应该始终返回 true。

上述两种方法可以替换为以下单一方法并实现相同的输出：

```
 public static bool IsObjectNullable<T>(T obj)
    {
        Type argType = typeof(T);
        if (!argType.IsValueType || obj == null)
            return true;
        return argType.IsGenericType && argType.GetGenericTypeDefinition() == typeof(Nullable<>);
    } 
```

但是，最后一种单一方法方法的问题在于，使用 Nullable<T> 参数时性能会受到影响。当在 IsObjectNullable 调用中使用 Nullable<T> 类型参数时，执行此单个方法的最后一行所需的处理器时间比允许编译器选择前面显示的第二个方法重载所需的处理器时间要多得多。因此，最佳解决方案是使用此处说明的两种方法。

警告：此方法仅在使用原始对象引用或精确副本调用时才能可靠地工作，如示例中所示。但是，如果一个可为空的对象被装箱到另一个类型（例如对象等）而不是保持其原始的 Nullable<> 形式，则此方法将无法可靠地工作。如果调用此方法的代码未使用原始的、未装箱的对象引用或精确副本，则无法使用此方法可靠地确定对象的可空性。

在大多数编码场景中，要确定可空性必须依赖于测试原始对象的类型，而不是其引用（例如，代码必须有权访问对象的原始类型才能确定可空性）。在这些更常见的情况下，IsTypeNullable（参见链接）是确定可空性的可靠方法。

PS - 关于“可空性”

我应该重复我在另一篇文章中关于可空性的声明，该声明直接适用于正确解决该主题。也就是说，我认为这里讨论的重点不应该是如何检查一个对象是否是一个泛型的 Nullable 类型，而是是否可以将 null 值赋给该类型的对象。换句话说，我认为我们应该确定一个对象类型是否可以为空，而不是它是否可以为空。区别在于语义，即确定可空性的实际原因，这通常是最重要的。

在使用对象的类型在运行时可能未知的系统中（Web 服务、远程调用、数据库、提要等），一个常见的要求是确定是否可以将空值分配给对象，或者对象是否可能包含一个空值。对不可为空的类型执行此类操作可能会产生错误，通常是异常，这在性能和编码要求方面都非常昂贵。为了采取主动避免此类问题的首选方法，有必要确定任意类型的对象是否能够包含空值；即，它是否通常是“可空的”。

在非常实际和典型的意义上，.NET 术语中的可空性并不一定意味着对象的类型是可空的形式。事实上，在很多情况下，对象都有引用类型，可以包含空值，因此都是可以为空的；这些都没有 Nullable 类型。因此，在大多数情况下，出于实际目的，应针对可空性的一般概念进行测试，而不是可空性的依赖于实现的概念。因此，我们不应仅仅关注 .NET Nullable 类型，而是将我们对其要求和行为的理解融入到关注可空性的一般实用概念的过程中。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2016-12-22T11:00:36.493

我想出的最简单的解决方案是实现微软的解决方案（[如何：识别可空类型（C# 编程指南）](https://msdn.microsoft.com/en-us/library/ms366789.aspx?f=255&MSPPError=-2147217396)）作为扩展方法：

```
public static bool IsNullable(this Type type)
{
    return Nullable.GetUnderlyingType(type) != null;
} 
```

然后可以这样调用：

```
bool isNullable = typeof(int).IsNullable(); 
```

这似乎也是一种合乎逻辑的访问方式，`IsNullable()`因为它适合该类的所有其他`IsXxxx()`方法`Type`。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-12-17T16:10:04.033

请注意，在装箱可空类型（`Nullable<int>`或 int？例如）时：

```
int? nullValue = null;
object boxedNullValue = (object)nullValue;
Debug.Assert(boxedNullValue == null);

int? value = 10;
object boxedValue = (object)value;
Debug.Assert( boxedValue.GetType() == typeof(int)) 
```

它变成了一个真正的引用类型，所以你失去了它可以为空的事实。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-07-04T15:32:15.463

也许有点离题，但仍然有一些有趣的信息。`Nullable.GetUnderlyingType() != null`如果类型可以为空，我发现很多人习惯于标识。这显然有效，但微软建议以下`type.IsGenericType && type.GetGenericTypeDefinition() == typeof(Nullable<>)`（见[http://msdn.microsoft.com/en-us/library/ms366789.aspx](http://msdn.microsoft.com/en-us/library/ms366789.aspx)）。

我从性能的角度来看这个。下面的测试（一百万次尝试）的结论是，当一个类型可以为空时，Microsoft 选项提供了最佳性能。

*Nullable.GetUnderlyingType()：* **1335 毫秒**（慢 3 倍）

*GetGenericTypeDefinition() == typeof(Nullable<>):* **500ms**

我知道我们谈论的是一小段时间，但每个人都喜欢调整毫秒:-)！因此，如果您的老板希望您减少几毫秒，那么这就是您的救星...

```
/// <summary>Method for testing the performance of several options to determine if a type is     nullable</summary>
[TestMethod]
public void IdentityNullablePerformanceTest()
{
    int attempts = 1000000;

    Type nullableType = typeof(Nullable<int>);

    Stopwatch stopwatch = new Stopwatch();
    stopwatch.Start();
    for (int attemptIndex = 0; attemptIndex < attempts; attemptIndex++)
    {
        Assert.IsTrue(Nullable.GetUnderlyingType(nullableType) != null, "Expected to be a nullable"); 
    }

    Console.WriteLine("Nullable.GetUnderlyingType(): {0} ms", stopwatch.ElapsedMilliseconds);

    stopwatch.Restart();

    for (int attemptIndex = 0; attemptIndex < attempts; attemptIndex++)
   {
       Assert.IsTrue(nullableType.IsGenericType && nullableType.GetGenericTypeDefinition() == typeof(Nullable<>), "Expected to be a nullable");
   }

   Console.WriteLine("GetGenericTypeDefinition() == typeof(Nullable<>): {0} ms", stopwatch.ElapsedMilliseconds);
   stopwatch.Stop();
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-01-21T20:43:31.470

我认为使用微软建议的测试的`IsGenericType`那些很好，但是在代码中`GetUnderlyingType`，微软使用了一个额外的测试来确保你没有通过泛型类型定义`Nullable<>`：

```
 public static bool IsNullableType(this Type nullableType) =>
    // instantiated generic type only                
    nullableType.IsGenericType &&
    !nullableType.IsGenericTypeDefinition &&
    Object.ReferenceEquals(nullableType.GetGenericTypeDefinition(), typeof(Nullable<>)); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-10T20:05:22.583

这个版本：

*   缓存结果更快，
*   不需要不必要的变量，例如 Method(T obj)
*   不复杂:),
*   只是静态泛型类，具有一次性计算字段

：

```
public static class IsNullable<T>
{
    private static readonly Type type = typeof(T);
    private static readonly bool is_nullable = type.IsGenericType && type.GetGenericTypeDefinition() == typeof(Nullable<>);
    public static bool Result { get { return is_nullable; } }
}

bool is_nullable = IsNullable<int?>.Result; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-08-25T06:27:47.337

这就是我想出的，因为其他一切似乎都失败了——至少在*PLC 上——可移植类库*/.NET *Core* with >= C# 6

**解决方案：**为任何类型扩展静态方法，`T`并`Nullable<T>`使用与底层类型匹配的静态扩展方法将被调用并优先于通用`T`扩展方法这一事实。

对于`T`：

```
public static partial class ObjectExtension
{
    public static bool IsNullable<T>(this T self)
    {
        return false;
    }
} 
```

并且对于`Nullable<T>`

```
public static partial class NullableExtension
{
    public static bool IsNullable<T>(this Nullable<T> self) where T : struct
    {
        return true;
    }
} 
```

使用反射和`type.IsGenericType`... 不适用于我当前的 .NET 运行时集。[MSDN 文档](https://msdn.microsoft.com/en-us/library/ms366789.aspx)也没有帮助。

`if (type.IsGenericType && type.GetGenericTypeDefinition() == typeof(Nullable<>)) {…}`

部分原因是 .NET Core 中的反射 API 发生了相当大的变化。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-08-18T03:31:24.587

一个简单的方法来做到这一点：

```
 public static bool IsNullable(this Type type)
    {
        if (type.IsValueType) return Activator.CreateInstance(type) == null;

        return true;
    } 
```

这些是我的单元测试，都通过了

```
 IsNullable_String_ShouldReturn_True
    IsNullable_Boolean_ShouldReturn_False
    IsNullable_Enum_ShouldReturn_Fasle
    IsNullable_Nullable_ShouldReturn_True
    IsNullable_Class_ShouldReturn_True
    IsNullable_Decimal_ShouldReturn_False
    IsNullable_Byte_ShouldReturn_False
    IsNullable_KeyValuePair_ShouldReturn_False 
```

实际的单元测试

```
 [TestMethod]
    public void IsNullable_String_ShouldReturn_True()
    {
        var typ = typeof(string);
        var result = typ.IsNullable();
        Assert.IsTrue(result);
    }

    [TestMethod]
    public void IsNullable_Boolean_ShouldReturn_False()
    {
        var typ = typeof(bool);
        var result = typ.IsNullable();
        Assert.IsFalse(result);
    }

    [TestMethod]
    public void IsNullable_Enum_ShouldReturn_Fasle()
    {
        var typ = typeof(System.GenericUriParserOptions);
        var result = typ.IsNullable();
        Assert.IsFalse(result);
    }

    [TestMethod]
    public void IsNullable_Nullable_ShouldReturn_True()
    {
        var typ = typeof(Nullable<bool>);
        var result = typ.IsNullable();
        Assert.IsTrue(result);
    }

    [TestMethod]
    public void IsNullable_Class_ShouldReturn_True()
    {
        var typ = typeof(TestPerson);
        var result = typ.IsNullable();
        Assert.IsTrue(result);
    }

    [TestMethod]
    public void IsNullable_Decimal_ShouldReturn_False()
    {
        var typ = typeof(decimal);
        var result = typ.IsNullable();
        Assert.IsFalse(result);
    }

    [TestMethod]
    public void IsNullable_Byte_ShouldReturn_False()
    {
        var typ = typeof(byte);
        var result = typ.IsNullable();
        Assert.IsFalse(result);
    }

    [TestMethod]
    public void IsNullable_KeyValuePair_ShouldReturn_False()
    {
        var typ = typeof(KeyValuePair<string, string>);
        var result = typ.IsNullable();
        Assert.IsFalse(result);
    } 
```

# sql - Tool to convert MS-Access Database to SQL script

> ID：374659
> 
> 赞同：3
> 
> 时间：2008-12-17T14:20:18.467
> 
> 标签：sql, ms-access

Our Software Package uses MS-Access Database, this database has been modified many times, so, it's a bit complicated to just see the files (relationship between tables are small hell), anyway,

Is there a way or program to convert this mdb file to SQL Script (Any sort of SQL Script will do it for now).

Thanks,

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T14:25:06.103

Have you looked at the [SQL Server Migration for Microsoft Access](http://www.microsoft.com/sqlserver/2005/en/us/migration-access.aspx)?

If you convert a copy to SQL Server, you may be able to get a better feel for the database.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T21:34:02.347

你可以看看[数据库比较器](http://www.clevercomponents.com/products/dbcomparer/dbcomparer.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T14:54:23.110

[SubSonic](http://subsonicproject.com/)具有将数据库的设计及其数据转储到 SQL 中的选项。过去我发现它非常方便地将我的测试数据库备份到源代码控制。

下载并安装 SubSonic 2.1 版。

您可以完全从命令行运行生成脚本，但我个人发现使用 App.Config 文件更容易，以便能够更轻松地处理配置选项。设置一个 .Net 项目，并将 App.Config 文件设置为适当的设置。可在此处找到有关 App.Config 的文档：http: [//subsonicproject.com/configuration/config-options/](http://subsonicproject.com/configuration/config-options/)

这是我的一个旧项目的示例：

```
 <?xml version="1.0" encoding="utf-8" \>
<configuration>
    <configSections>
        <section name="SubSonicService" 
            type="SubSonic.SubSonicSection, SubSonic" 
            requirePermission="false"/>
    </configSections>

    <connectionStrings>
        <clear />
        <add name="subTest" 
            connectionString="Data Source=MYCOMP\MICROSOFTSMLBIZ\,56183;Database=someDB;User ID=someId;Password=somePasswrd!"
            providerName="System.Data.SqlClient" />
    </connectionStrings>

    <SubSonicService defaultProvider="subTest">
        <providers>
            <clear/>
            <add name="subTest" 
                type="SubSonic.sqlDataProvider, SubSonic" 
                connectionStringName="subTest"
                generatedNamespace="TerraCognita.Project.Services.DAL"
                includeTableList="^Bug$, ^Person$, ^Groups$, ^Project$, ^TimeInterval$"/>
        </providers>
    </SubSonicService>
</configuration> 
```

使用适合您的数据库的连接字符串，以及（我相信）适合 Access 数据库的提供程序。（您也可以在命令行中指定大多数参数，但我个人觉得使用配置文件更直接。）

打开命令提示符，当前文件夹应该是 App.Config 所在的文件夹。以下是您需要的命令：

[安装文件夹]\SubCommander\sonic.exe [命令] /out [输出文件名]

其中 [Command] 可以是脚本模式或脚本数据。（还有其他命令，但这是您感兴趣的两个命令。帮助也是一个选项。

# c++ - 在 Excel XLOPER 中通过 char* 返回日文字符

> ID：374670
> 
> 赞同：2
> 
> 时间：2008-12-17T14:22:26.780
> 
> 标签：c++, excel, xll

我正在从数据源中检索日文字符，我想在 XLOPER 中将此数据返回到 Excel。我使用的是日文版的 Excel 2003（因此是 XLOPERs 而不是 XLOPER12s）。

```
wchar_t* pszW = OLE2W(bstrResult); //I have the data I am trying to copy in a CComBSTR

ULONG ulSize = ::WideCharToMultiByte( CP_THREAD_ACP, 0, pszW, -1, NULL, 0, NULL, NULL );                        

if ( ulSize )
{   
   char* tmp = new char[ulSize + 1];
   tmp[ulSize]='\0';
   ::WideCharToMultiByte( CP_THREAD_ACP, 0, pszW, -1, LPSTR( tmp ), ulSize, NULL, NULL );
   pszReturn = tmp;     
}
wchar_t* pwszOut = new wchar_t[bstrResult.Length () + 1];

//now turn it back to test that that the correct code page was used. For debugging purposes only!
::MultiByteToWideChar (CP_THREAD_ACP,0, LPSTR(pszReturn),-1,pwszOut,bstrResult.Length () + 1);

//pwszOut and bstrResult look the same in the debugger              
delete [] pwszOut; 
```

参数 pszReturn 分配给 XLOPER。我遇到的问题是“アフリカの女王”在Excel中显示为“ƒAƒtƒŠƒJ,Ì—‰¤”。

手动将代码页设置为 932 会产生与 CP_THREAD_ACP 相同的结果，所以我认为那部分是正确的。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T16:08:36.050

***用户错误！***

上面的代码很好。问题是 Excel 使用了错误的代码页。我没有在控制面板中将非 unicode 程序的语言设置为日语。

该代码现在也适用于英文版的 Excel。

就这样度过了一天半的美好时光……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T14:38:10.007

char* 是一个字节序列，使用当前字符集进行解释。准确地说，那是进行解释的一方使用的字符集。在这种情况下，Execl 正在接收*应*使用代码页 932 解释的字符集，但 Excel 正在使用另一个代码页。

解决方案，一如既往是 Unicode，在 XLOPER12 代表的 Excel 中

# ant - Ant 是否提供绕过依赖的方法？

> ID：374673
> 
> 赞同：15
> 
> 时间：2008-12-17T14:23:26.060
> 
> 标签：ant, build

build.xml 有一个*测试*和一个*构建*目标。测试目标显然取决于*构建**目标*。

如何只运行测试目标，**暂时**跳过编译，而不修改 build.xml 文件？

我问是因为编译太长，并且由持续集成服务器保持最新；我正在追查单元测试的问题。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-17T14:30:16.013

使用`unless`属性。

```
<target name="test" unless="dont.run.tests"> 
```

如果您不想运行“测试”，只需

> 蚂蚁 -Ddont.run.tests=true

如果您希望测试运行，它应该是未定义的。Ant 只是检查它是否已被定义。此外，还有一个`if`属性可以相反。

这是[一篇](http://ideoplex.com/id/136/conditional-execution-in-ant)关于两者的文章。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-17T14:30:29.663

不，您不能在不修改构建文件的情况下跳过它。

这是我在项目中为解决此问题所做的工作。对于每个公共目标，我将创建一个在其前面带有“do-”的私有目标。私有目标没有依赖关系，公共目标具有“do-”目标作为依赖关系。

例如：

```
<target name="compile" depends="init, do-compile" description="Compiles all of the source code" />

<target name="do-compile">
        <javac destdir="${classes.dir}" debug="true" encoding="ISO-8859-1">
            <src refid="src.path" />
            <include name="*.java" />
            <classpath refid="external.libraries.classpath" />
        </javac>
</target> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T14:26:10.890

就我个人而言，我发现 Ant 中的依赖项不仅仅是帮助。我通常设置两组目标 - 真正*做事情*的目标（没有依赖关系），然后是*只有*依赖关系的目标。这样，您可以轻松运行单个目标，还可以轻松运行整个套件等。在我看来，这符合*实际*（而不是意识形态）用途。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T14:28:31.930

如果代码没有改变，一个写得很好的构建目标不需要重新构建任何东西。因此，测试目标依赖于它这一事实在很大程度上应该是无关紧要的。如果您连续两次运行构建目标并且它第二次尝试重建某些东西，您可能需要调查它为什么这样做。

避免执行目标的简单方法是将目标的“除非”属性设置为某个属性的名称。如果您在运行 Ant 时在命令行上设置此属性，它将绕过该目标。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T14:27:45.583

只是暂时“删除”依赖关系？`如果代码已经构建，你的所有文件都应该可用，不是吗？- 哎呀，刚刚看到您无法更改文件，嗯，您为什么不先在本地运行相同的作业？

# ruby - 寻找一个简单的 ruby 模板解决方案

> ID：374684
> 
> 赞同：3
> 
> 时间：2008-12-17T14:26:44.757
> 
> 标签：ruby, cgi, template-engine

我正在寻找一个简单的ruby 模板解决方案，即可以让我编写类似php 或jsp 的模板（带有嵌入代码标签的html），但是在ruby 中。jsp对我没有好处，因为大多数托管服务（我在dreamhost上）在他们的默认包上不支持它，而且设置起来有点麻烦。php 很容易启动和运行，但我讨厌它的语法，我想念 ruby​​ 的所有优点。

erb 似乎接近我正在寻找的东西，但我如何设置服务器（htaccess 文件等）来服务它？

PS请不要推荐Ruby On Rails。这对我正在做的事情来说是一个巨大的矫枉过正。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T14:41:26.523

[您可以在此处](http://wiki.railsplayground.com/railsplayground/show/How+To+Use+RHTML+without+rails)找到有关如何设置所有服务器内容以使用 eruby 提供 html 的非常简洁的教程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T14:39:18.790

[ERB](http://ruby-doc.org/core/classes/ERB.html)作为其核心的一部分内置于该语言中。如果您不知道它是什么，它是 Ruby 附带的 Ruby on Rails 背后的模板引擎。（所以不要把它归咎于 Rails。）它足够强大，可以满足您的*任何*目的。

我自己使用 ERB 制作了一个脚本，该脚本采用 RSS 提要并将文章输出到 html 文件中。所以不要抱怨它是重量级的……因为下载文章并通过 XML 解析器解析它们比输出 html 慢。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T16:33:40.977

如果您的网络服务器有机架，您应该查看[wave](http://rubywaves.com)。这是一个最小的框架，可以让您以最小的开销进行 erb 或 erubis 模板化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-22T09:26:03.920

我会推荐带有 erb 或 haml 的 Sinatra.rb。对于托管的小型网站，您可以免费使用 heroku。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T14:54:49.240

要在第一个答案中添加一些内容，如果您对 ERB 有性能问题，那么您可以尝试[Erubis](http://www.kuwata-lab.com/erubis/)。它是一个非常快速且兼容的 ERB 版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T19:51:16.240

好的我明白了。谢谢。

ERB 是我要走的路。Dreamhost 的配置脚本在[这里](http://wiki.dreamhost.com/ERB)，如果您有兴趣：

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T04:13:38.893

ERB 是显而易见的选择，但我也越来越喜欢 Haml & Sass。它们非常简洁。

如果您正在寻找一个微框架，Sinatra 非常简单易用，并且支持多种模板语言，包括 ERB 和 Haml。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-05T02:59:03.373

使用模板引擎需要您在外部文件中编写 HTML 代码，如果您担心引入框架是否过大，那么 erb 也是如此。它不能作为程序执行的一部分工作，但您需要针对您的 erb 文件运行它。您可能想查看我开发的[dom gem 。](https://rubygems.org/gems/dom)使用这个 gem，您可以直接在 Ruby 脚本中生成 HTML 字符串，如下所示：

```
require "dom"
["foo".dom(:span, class: "bold"), "bar"].dom(:div).dom(:body).dom(:html)
# => "<html><body><div><span class=\"bold\">foo</span>bar</div></body></html>" 
```

# linux - 为什么“echo foo | read a ; echo $a”没有按预期工作？

> ID：374687
> 
> 赞同：8
> 
> 时间：2008-12-17T14:27:33.773
> 
> 标签：linux, unix, shell

我可以在 FreeBSD、GNU/Linux 和 Solaris 下使用各种 shell 来复制这个问题。这让我头疼了一个多小时，所以我决定在这里发布这个问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-17T14:31:10.427

由于管道，`read`在其自己的子外壳中执行。

```
echo foo | while read a; do echo $a; done 
```

会做你所期望的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-17T14:37:19.637

选择：

```
echo foo | (read a ; echo $a) 
```

编辑：

如果您需要在子shell 之外使用 $a，则必须反转命令：

```
read a < <(echo foo); echo $a 
```

这样读取在当前进程中执行

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T14:41:25.260

我不认为这个已经给出：

```
a=`echo foo`
echo $a 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-17T15:19:39.550

仅供参考；在 ksh 中，它按预期工作；另请参阅[http://kornshell.com/doc/faq.html](http://kornshell.com/doc/faq.html)，第 III 部分（shell 编程问题），Q13：

```
Q13\.    What is $bar after, echo foo | read bar?
A13\.    The is foo.  ksh runs the last component of a pipeline
        in the current process.  Some shells run it as a subshell
        as if you had invoked it as  echo foo | (read bar). 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-27T04:20:40.647

该| 是一个**进程间通信**操作符。因此，隐含地，必须创建一个子流程来解析和评估其一侧或另一侧的表达式。Bash 和较旧的 Bourne shell 在操作符的右侧创建一个子进程（从管道读取），这意味着在那里设置的任何变量都只在范围内，直到该进程退出（在此代码示例中位于分号处。

zsh 和更新版本的 Korn shell（至少从 '93 开始，但甚至可能追溯到*ksh* '88）将在管道的另一侧创建子进程（写入其中）。因此，它们将按照这个问题的作者想要的方式工作。（当然，“正如预期的那样”是高度主观的。理解管道的性质应该导致人们期望它以特定于实现的方式表现）。

我不知道 Posix 或 Spec 1170 或 SuS 或任何其他已发布的标准中是否有任何具体规定需要一种或另一种语义。然而，在实践中，很明显你不能依赖于行为；尽管您可以在脚本中轻松测试它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T15:00:13.037

我想出了一个解决方案，它不会在子shell 中隐藏变量值，并且也可以处理多个值。

```
set `echo foo bar`
A=$1
B=$2 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-17T14:37:47.887

根据 Kernighan 和 Pike 的*The Unix Programming Environment* (p. 159) “没有一个 shell 内置命令（与控制流原语相反，如 for）可以用 > 和 < 重定向”，并且“这可能被描述为作为外壳中的错误”。这似乎解释了a）为什么代码喜欢

```
ls *.c |
while read file
do
   echo $a
done 
```

总是毫无问题地工作，并且b）从文件重定向工作的不一致。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-12-17T14:37:35.813

读取期望在新行上输入

```
一边读一边读；回声 $a; 完毕
富
酒吧
^D

```

或多或少是你想要的

# svn - 每次“svn 更新”到父工作副本时，svn:external 子目录是否会与其 HEAD 修订同步？

> ID：374690
> 
> 赞同：1
> 
> 时间：2008-12-17T14:28:09.247
> 
> 标签：svn

在[Subversion 手册的这个页面上](http://svnbook.red-bean.com/en/1.0/ch07s03.html)，它说“当您提交对 svn:externals 属性的更改时，Subversion 将在您下次运行 svn update 时将签出的项目与更改的外部定义同步。同样的事情会发生在其他人更新他们的工作副本并接收您对外部定义的更改。”

如果您没有为外部指定修订号，我假设使用 HEAD 修订。那么，每次对父工作副本运行“svn update”时，由外部属性管理的子目录是否会更新到其 HEAD 修订版？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T14:30:28.680

是的，它也会更新，这是这里的主要目的:)

# c# - c# and xml-rpc.net: mismatch exception

> ID：374705
> 
> 赞同：0
> 
> 时间：2008-12-17T14:31:25.043
> 
> 标签：c#, exception

I'm using xml-rpc.net to access an e-commerce site (php) from an c# application. The code:

```
String[] fooResourcesReturn = FoobarProxy.resources(fooLoginReturn); 
```

returns the following XmlRpcTypeMismatchException:

```
response contains struct value where string expected (as type String) [response : array mapped to type String[] : element 0] 
```

The problem is that the method resources returns an array but I cannot figure out its type. I've used string[] but obviously that's not correct. Here's the def for resources:

```
 [XmlRpcMethod("resources")]
    String[] resources(String sessionId); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T19:14:58.307

你想通了吗？#1 你想让你的结构与响应相匹配。如果您使用类似的结构

```
public struct ResourcesResult{
   public string[] resources;
} 
```

`resources`假设返回有一个用`string`值调用的数组元素，它应该可以工作。

如果您已解决，请告诉我。我们可以多聊几句。

# sql - SQL JOIN：表标识符的技术名称

> ID：374709
> 
> 赞同：2
> 
> 时间：2008-12-17T14:33:21.517
> 
> 标签：sql, nomenclature

当我使用 A.column name, B.Column name where A = Table A and B = Table B 时，A.Column 名称的技术名称是什么？它是前缀、标识符还是其他什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-17T14:34:55.507

我一直看到它被称为别名。

编辑： [是的！](http://www.w3schools.com/SQL/sql_alias.asp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T14:47:26.650

他们也称其为“相关名称”

[http://publib.boulder.ibm.com/iseries/v5r1/ic2924/index.htm?info/db2/rbafzmstc2cornm.htm](http://publib.boulder.ibm.com/iseries/v5r1/ic2924/index.htm?info/db2/rbafzmstc2cornm.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T16:48:11.510

从我的“SQL-99 Complete，真的”副本中：

> A `<Correlation name>`（或别名）标识范围在某个表上的变量；也就是说，一个变量，其唯一允许的值是给定表的行。

所以“别名”或“相关名称”都是可以接受的。尽管“别名”也用于选择列表中定义的列别名，但如果您使用该术语，您应该清楚您的意思。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T15:20:00.547

我认为`correlation`name 正确地是 a 中使用的别名`correlated subquery`。在下面的查询中**E2**是`correlation`名称。

```
SELECT  EMPNO, LASTNAME, WORKDEPT, EDLEVEL
FROM    EMPLOYEE
WHERE   EDLEVEL >
        (SELECT AVG(E2.EDLEVEL)
        FROM    EMPLOYEE **E2**
        WHERE   E2.WORKDEPT = WORKDEPT
        ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T14:51:29.043

我认为正确的名称是 table-alias

# c++ - 在调试器中运行时 VC++ 6.0 访问冲突

> ID：374715
> 
> 赞同：1
> 
> 时间：2008-12-17T14:35:23.850
> 
> 标签：c++, debugging, visual-c++-6, access-violation

我正在尝试为一个 4 岁的 VC++ 6.0 程序添加增强功能。调试版本从命令行运行，但不在调试器中：它因 printf() 内部的访问冲突而崩溃。如果我跳过 printf，那么它会在 malloc() 中崩溃（从 fopen() 中调用），我不能跳过它。

这意味着我不能在调试器中运行，必须依靠旧的 printf 语句来查看发生了什么。这显然使它变得更加困难。

知道为什么 printf() 和 malloc() 在 VC++ 调试器下运行时会失败吗？我不擅长这种低级的东西！

这是访问冲突后的调用堆栈：

```
_heap_alloc_dbg(unsigned int 24, int 2, const char * 0x0046b3d8 `string', int 225) line 394 + 8 bytes
_nh_malloc_dbg(unsigned int 24, int 0, int 2, const char * 0x0046b3d8 `string', int 225) line 242 + 21 bytes
_malloc_dbg(unsigned int 24, int 2, const char * 0x0046b3d8 `string', int 225) line 163 + 27 bytes
_lock(int 2) line 225 + 19 bytes
_getstream() line 55 + 7 bytes
_fsopen(const char * 0x00468000 `string', const char * 0x00466280 `string', int 64) line 61 + 5 bytes
fopen(const char * 0x00468000 `string', const char * 0x00466280 `string') line 104 + 15 bytes
open_new_log(const char * 0x00468000 `string') line 66 + 14 bytes
log_open(const char * 0x00468000 `string', int 0) line 106 + 9 bytes
Xlog_open(const char * 0x00468000 `string', int 0) line 51 + 13 bytes
service_start(unsigned long 1, char * * 0x009a0e50) line 3152 + 12 bytes
service_init2(char * 0x00471fcc char * NTPROGRAM, char * 0x004723c4 char * NTSERVICE, char * 0x00466540 `string', unsigned long 1, char * * 0x009a0e50) line 508 + 13 bytes
service_init(char * 0x00471fcc char * NTPROGRAM, char * 0x004723c4 char * NTSERVICE, unsigned long 2, char * * 0x009a0e50) line 548
main(unsigned long 2, char * * 0x009a0e50) line 3131
mainCRTStartup() line 206 + 25 bytes
KERNEL32! 7c817067() 
```

这是失败的操作之前的调试反汇编：

```
0041EA7E   jmp         _heap_alloc_dbg+2B3h (0041eb23)
0041EA83   mov         edx,dword ptr [_lTotalAlloc (004b4294)]
0041EA89   add         edx,dword ptr [nSize]
0041EA8C   mov         dword ptr [_lTotalAlloc (004b4294)],edx
0041EA92   mov         eax,[_lCurAlloc (004b429c)]
0041EA97   add         eax,dword ptr [nSize]
0041EA9A   mov         [_lCurAlloc (004b429c)],eax
0041EA9F   mov         ecx,dword ptr [_lCurAlloc (004b429c)]
0041EAA5   cmp         ecx,dword ptr [_lMaxAlloc (004b42a0)]
0041EAAB   jbe         _heap_alloc_dbg+249h (0041eab9)
0041EAAD   mov         edx,dword ptr [_lCurAlloc (004b429c)]
0041EAB3   mov         dword ptr [_lMaxAlloc (004b42a0)],edx
0041EAB9   cmp         dword ptr [_pFirstBlock (004b4298)],0
0041EAC0   je          _heap_alloc_dbg+25Fh (0041eacf)
0041EAC2   mov         eax,[_pFirstBlock (004b4298)]
0041EAC7   mov         ecx,dword ptr [pHead]
0041EACA   mov         dword ptr [eax+4],ecx 
```

这是我们调用 fopen() 并在 malloc() 中失败的源代码

```
FILE *open_new_log( const char *logfile )
{
    FILE *fp;
    int retry = 0;

    while( ( fp = fopen( logfile, "w" ) ) == NULL && ++retry < 300 )
        Sleep( 1000 );

    return( fp );
} 
```

我得到的错误是

```
Unhandled exception inPISCOOP.exe: 0xC00000005: Access Violation 
```

问候，

--- 阿利斯泰尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T15:05:16.817

从调试器运行时，使用不同的堆；这称为*调试堆*。这与在调试器外部使用的堆具有不同的行为，并且可以帮助您捕获此类问题。

请注意，Win32“调试堆”不同于 VC++“调试堆”；但是，两者都旨在做或多或少相同的事情。请参阅[这篇文章](http://msdn.microsoft.com/en-us/library/cc266414.aspx)，它描述了在调试器下运行应用程序时的行为差异。

在这种情况下，您可能在调用此函数之前损坏了堆，方法是注销堆块的末尾或开头。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T15:34:47.973

您可以使用[`_CrtSetDbgFlag()`](http://msdn.microsoft.com/en-us/library/5at7yxcs(VS.71).aspx)来启用一堆有用的堆调试技术。还有许多其他可用的[CRT 调试功能](http://msdn.microsoft.com/en-us/library/1666sb98(VS.71).aspx)可以帮助您找出问题所在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-17T16:26:56.840

最简单的方法（假设您的应用程序没有过多地使用内存）是启用整页堆检查（这将在提供分配的内存页之后放置所谓的保护页，这反过来又会查明确切的放置在发生损坏的代码中）。

鉴于您有方便的[Windows 调试工具](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)，请运行以下 gflags 命令来配置整页堆：

`gflags[.exe] /p /enable yourapp.exe /full`

***请注意，您应该单独**提供可执行文件名称（即没有路径前缀！）* 然后只需在调试器下运行它 - 它会在第一次尝试破坏堆时中断。这里的区别在于，堆损坏主要是延迟缺陷，当（可能）有效的堆操作生效时，这些缺陷会在以后表现出来。

另请注意：

`gflags[.exe] /p /enable yourapp.exe /full /backwards`

将在您分配之前另外放置一个保护页。

单独使用 /p 开关运行将显示当前有效的堆页面选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T15:05:25.833

您可能有一个堆损坏错误。您的应用程序可能在`open_new_log()`调用之前损坏了堆。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-17T15:37:14.867

我怀疑 jmattias 是对的。问题的根本原因可能不在崩溃的地方。

很多事情都可能导致堆损坏。

*   写入已分配内存块的末尾（或开头）。
*   释放指针两次，或释放未分配的指针。
*   多线程您的程序并与单线程（非线程安全）RTL 链接。
*   从一个堆分配内存并在另一个堆上释放它。
*   等等，等等，

由于您使用的是 Visual C++，因此您可以使用调试堆的 _CrtSetDbgFlag() 功能来打开错误检查。您可以将其设置为在每次调用 malloc 或 free 时检查堆的完整性。这将运行非常缓慢，但它应该确定错误所在的位置。

在编译器文档中搜索 _CrtSetDbgFlag。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T18:12:04.303

我怀疑存在一个使用与应用程序的其余部分不同版本的 C++ 运行时编译的 DLL。这通常会导致“地址 XXX 的内存不能被‘读取’/‘写入’”违规。

# .net - 未复制到输出目录的引用的依赖关系

> ID：374727
> 
> 赞同：18
> 
> 时间：2008-12-17T14:39:05.013
> 
> 标签：.net, visual-studio, reference, dependencies

我有一个 CommonUtils 库，我已经内置到一个 dll 中，我从我的几个项目中引用了它。CommonUtils 依赖于在构建 CommonUtils.dll 时设置为文件引用和 copy-local=true 的 log4net.dll。log4net.dll 和 CommonUtils.dll 不在 GAC 中。

在 MyWorkingProject 中一切正常，我只有一个对 CommonUtils.dll 的文件引用 - log4net.dll 显示在输出目录中（因为它是 CommonUtils.dll 的依赖项，但未从 MyWorkingProject 引用）。但是，如果我创建一个新项目来添加一些单元测试：MyWorkingProjectTest 和项目引用 MyWorkingProject，然后在此处再次文件引用 CommonUtils.dll（我想使用一些 CommonUtils）然后在构建 log4net.dll 时，它是两个项目的依赖项参考和文件参考也不会被复制到输出目录。

谁能澄清这里发生了什么？编译器是否不知道它应该抓取哪个 log4net.dll 文件？我在这里做错了什么吗？我应该以其他方式执行此操作以显式复制 log4net.dll 吗？我必须明确引用 log4net 是否有意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T18:42:55.910

这是设计使然。您需要考虑自动继承引用会导致的影响。虽然您可以从逻辑上看到引用应该是什么，但编译器没有这样的描述。从理论上讲，如果它遍历整个依赖关系树，您最终可以复制框架和操作系统的很大一部分。

这绝对是一种痛苦，我同意并理解你的沮丧，但我认为微软无法找到一种合乎逻辑的方式来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:51:34.493

我相信如果您不在项目中添加 log4net 作为参考，它将不会被复制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T00:21:14.573

当我过去遇到类似情况时，我在 Visual Studio 中收到编译器警告，告诉我需要添加对依赖库的引用。

你编译的时候有收到这样的警告吗？如果是这样，请遵循它给出的建议，您应该会发现 Log4net 已复制到您的输出目录。

# c# - What is a good way to find a specific value in an XML document using C#?

> ID：374734
> 
> 赞同：6
> 
> 时间：2008-12-17T14:42:08.847
> 
> 标签：c#, xml, xpath, searching-xml

I'm calling a WebService exposed by Oracle that accepts an input of an ItemID and returns to me the corresponding Item Number. I want to grab the Item Number that has been returned out of the XML contained in the response.

The XML looks like this:

```
<env:Envelope
  xmlns:env="http://schemas.xmlsoap.org/soap/envelope/"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:ns0="http://dev1/MyWebService1.wsdl">
 <env:Header>
  <wsse:Security
    xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"
    xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"
    xmlns:env="http://schemas.xmlsoap.org/soap/envelope/"
    env:mustUnderstand="1"/>
 </env:Header>
 <env:Body>
  <ns0:getItemNbrByItemIdResponseElement>
   <ns0:result>1010603</ns0:result>
  </ns0:getItemNbrByItemIdResponseElement>
 </env:Body>
</env:Envelope> 
```

I'm interested in grabbing only the `<ns0:result>1010603</ns0:result>` particularly only the 1010603.

I haven't done a lot of work parsing XML using C# and I'm playing around with a few different methods so far. What is the recommended way to do this?

I'm on VS2008 (so XPath is available etc.)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-17T14:46:49.570

I'd personally use LINQ to XML, because I find that easier to deal with than XPath, particularly when namespaces are involved. You'd do something like:

```
XNamespace ns0 = "http://dev1/MyWebService1.wsdl";

String result = doc.Descendants(ns0 + "result").First().Value; 
```

Note that `doc` here is expected to be an [`XDocument`](http://msdn.microsoft.com/en-us/library/bb345449.aspx), *not* an [`XmlDocument`](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx). (My guess is that this is why it wasn't showing up for you.)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-17T14:54:09.010

fwiw you can cheat the namespace issue with an xpath like this: `//*[local-name()='result']`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T14:52:40.960

If you don't want to go for Linq you could use XPathDocument to retrieve the value:

```
XPathDocument xmldoc = new XPathDocument(@"C:\tmp\sample.xml");
XPathNavigator nav = xmldoc.CreateNavigator();

XmlNamespaceManager nsMgr = new XmlNamespaceManager(nav.NameTable);
nsMgr.AddNamespace("ns0", "http://dev1/MyWebService1.wsdl");

XPathNavigator result = nav.SelectSingleNode("//ns0:result", nsMgr);
System.Diagnostics.Debug.WriteLine(result.Value); 
```

XPathDocument has a lower memory footprint and is most likely faster in your scenario than XmlDocument. XmlDocument builds up a complete object model of your XML document in memory whereas XPathDocument does not do that.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T14:51:55.707

Off the top of my head, the following should work:

```
XmlDocument doc = new XmlDocument();
doc.PreserveWhitespace = true;

XmlNamespaceManager mgr = GetNamespace(doc);
doc.LoadXml(xmltext);

XmlNode nd = doc.DocumentElement.SelectSingleNode("//ns0:result", mgr); 
```

The namespace code looks like this:

```
private XmlNamespaceManager GetNamespace(XmlDocument document)
{
    XmlNamespaceManager mgr = new XmlNamespaceManager(document.NameTable);
    mgr.AddNamespace("ns0", "http://dev1/MyWebService1.wsdl");
    return mgr;
} 
```

You need to use the namespace manager because the XML document has namespaces associated with it, and XPath uses this in query resolution.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-17T16:42:24.330

To solve this, I used Jon Skeet's answer. Here's the code that I had to implement to make this work (for anyone else's future benefit).

```
XmlDocument xmlDoc = new XmlDocument();

XNamespace ns0 = "http://dev1/MyWebService1.wsdl";

xmlDoc.Load(request.GetResponse().GetResponseStream());

XDocument xDoc = XDocument.Load(new XmlNodeReader(xmlDoc));                          

String result = xDoc.Descendants(ns0 + "result").First().Value; 
```

This of course assumes I'm getting my response back from an HttpWebRequest named **request**.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T15:30:38.653

There are very good and complete answers to this question.

I'd add **just out of curiosity, that an extremely simple XPath expression does the job** in this particular case:

    **`normalize-space(/)`**

This is easily done in C# using something like the two lines below:

```
 XPathNavigator navigator = document.CreateNavigator();

        string res = (string)navigator.Evaluate("normalize-space(/)"); 
```

With the good optimization of the .NET XPath engine, its evaluation may even be efficient.

# .net - 如何在 .NET 中打印到空打印机？

> ID：374740
> 
> 赞同：3
> 
> 时间：2008-12-17T14:43:40.760
> 
> 标签：.net, printing

我需要为打印文档的方法编写单元测试。有没有一种简单的方法可以将输出发送到 /dev/null 的 Windows 等效项？我猜让我们的构建服务器在每次签入时打印一个文档会很快变得昂贵。;)

理想情况下，这适用于我们的构建服务器（没有默认打印机）和我们的开发机器（有），所以我不想更改默认打印机。

感谢所有精彩的答案，无疑将跟随这个迷人的问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-17T15:20:32.340

我通过创建一个打印到 NUL 设备的 Windows 打印机来做到这一点。这非常简单，尽管 Windows 版本之间的细节有所不同：只需创建本地打印机并将 NUL 指定为本地端口，将“Generic”指定为制造商，将“Generic / Text Only”指定为打印机型号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T14:50:48.390

您应该使用模拟框架来模拟 print 方法，以便它永远不会实际执行。

查看 TypeMock 或 RhinoMocks 以了解可以帮助您执行此操作的内容。

这是使用 TypeMock 的样子：

```
Mock mock = MockManager.Mock<PrintManager>();
mock.ExpectCall("Print"); 
```

然后，您将执行测试中调用此方法的代码。然后，这将拦截打印调用，文档不会发送到打印机，但您仍然可以在打印时对业务逻辑进行单元测试。

# .net - 为什么不升级到最新的 .NET 框架？

> ID：374741
> 
> 赞同：15
> 
> 时间：2008-12-17T14:44:26.017
> 
> 标签：.net, .net-3.5, .net-2.0, .net-1.1

我看到很多人将 .NET 2.0 甚至 1.1 作为他们项目的要求。在我自己的工作场所，也有很多人对升级到最新最好的 .NET 框架持怀疑态度。

作为一名程序员，当您知道使用较新的框架可以更轻松地完成这项工作时，我觉得使用较旧的框架非常令人沮丧。我通常安装 beta 版本并使用它们，因此我很快熟悉它们，并在此过程中忘记了旧的做事方式，因此当你有使用旧版本的限制时，重新学习你试图忘记的东西是很痛苦的。

在旧版本应该兼容的情况下仍然坚持使用旧版本的原因是什么？如何说服人们升级？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-17T18:59:21.680

首先，了解企业升级缓慢的原因。

对于大多数公司而言，计算机系统并不是战略优势。它们是必要的服务功能。

由于它们是必要的，因此破坏它们可能会非常昂贵。由于它们不是战略优势，因此能够稍微更快地发展并不是一个很大的优势。

您提议一家公司花费资源来不断升级到最新版本，以获得可能但不确定且不是主要的收益，并且可能会出现很多损坏。对于大多数公司来说，这不是一场胜利。在它们出现一段时间后采用它们会更安全。他们错过了一些上行空间，但避免了灾难性下行的机会。

如果您愿意，可以继续建议升级到最新最好的版本，但是以商业（而不是技术）方式进行升级会更有效。尝试从数量上找出它将使您更有效的程度，以及公司可以节省多少。（他们不会关注你编造的人物，可能会关注某个知名人士编造的人物，并且更有可能相信一项研究支持的东西。）承认不利因素，并说明可能的成本是多少将是，并找到限制下行空间的方法。对捏造任何事情要非常小心，因为决策者拒绝这种事情的经验比你提出它的经验要多得多。

不要提及喜欢最新产品的开发人员，否则你会被认为是希望公司为新玩具买单的人，并失去很多可信度。

有时你可以得到你想要的东西，但知道如何要求它会有所帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-17T15:02:26.777

未提及的一个原因是 3.5 框架不能安装在 Windows XP 之前的 Windows 版本上。

> 支持的操作系统：Windows Server 2003；视窗服务器 2008；视窗Vista；视窗

[链接文本](http://www.microsoft.com/downloads/details.aspx?FamilyId=333325FD-AE52-4E35-B531-508D977D32A6&displaylang=en)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T14:56:47.770

在新项目中跳入新框架更容易。

在现有项目中，利用新功能需要一定的工作量。在许多情况下，这些只对程序员有益。当你在一个只做维护的项目上工作时，你有时只需要耸耸肩说，这在版本 x 中会少得多的代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T15:17:31.393

我已经将 1.1 项目迁移到 2.0 和 3.5 以及从 2.0 到 3.5。

从我的经验中我可以看出，我从 2.0 迁移到 3.5 完全没有问题。但是，我在从 1.1 到 2.0 或 3.5 的项目中遇到了一些错误，因此我必须建议人们在迁移 1.1 项目时要格外小心。

如果你在 2.0 中工作，我说去吧。您会发现这些项目在运行中速度更快，并且您可以使用 LINQ :)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-17T15:22:41.913

对我来说，这纯粹是为了钱——2.0 正在为公司工作，所以他们看不到升级的动力。

我想这并不少见。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-17T14:54:51.207

请求该软件的人可能不一定知道该框架的最新版本是什么。

我看到的大多数客户都不是技术人员，只是要求他们想要的功能。

有些人特别要求 .NET 1.1/2.0，我们能够告诉他们，如果我们使用 3.5，开发成本将会降低，因为它更容易使用并且很容易让他们切换。

有些人可能担心与他们已经拥有的东西整合。如果他们已有的东西是在 .NET 1.1 中构建的，他们可能希望坚持使用它以保持一切一致。

至于你自己的工作场所，我会说要负责并进行演示，展示它有多么不同，一旦你学会了如何使用它是多么容易。关于如何在 .NET 3.5 和 VS2008 中使用新的动态数据内容，有一个很棒的屏幕截图。我公司有不少人看到最新版本的VS后安装了它。我会尝试看看是否可以找到它的链接。

[http://blogs.msdn.com/davideb/archive/2007/12/12/dynamic-data-screencast-is-now-available.aspx](http://blogs.msdn.com/davidebb/archive/2007/12/12/dynamic-data-screencast-is-now-available.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-17T14:55:37.617

Scott Hanselman 有一篇关于 3.5 SP1 不兼容性的文章：

[http://www.hanselman.com/blog/UpdateOnNETFramework35SP1AndWindowsUpdate.aspx](http://www.hanselman.com/blog/UpdateOnNETFramework35SP1AndWindowsUpdate.aspx)

尽管这只适用于一小部分错误，但底线是：一个新框架需要非常彻底的测试，而不是 5 分钟的任务，因为虽然它是 99.99% 的兼容，但 0.01% 的不兼容是真正晦涩难懂和很难找到。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-17T15:27:23.433

我已经在这里发布了一些非常相似的内容：**[对于这个项目来说，C# 2.0 到 C# 3.0 的转换值得吗？](https://stackoverflow.com/questions/170584/c-20-to-c-30-worth-it)**，并且大多数人说它是兼容的，但由于项目已经在进行中，因此不值得切换。

如果您真的想在框架上添加新内容，则切换是合理的，否则您将需要免费更新 Visual Studio 的所有许可证，并且可能需要更改项目中的一些小东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-17T14:50:17.190

因为它们“应该”兼容并不意味着它们是兼容的。版本之间总是存在重大变化。

此外，大多数 QA 程序规定代码的更改需要重新测试该代码。更改框架将需要对代码进行完整的测试，并且需要更多的工时。

最新的！= 最棒的。问问任何不得不处理 Vista 的人。

## 编辑

关于Vista...放松，这是一个例子！有多少在 Vista 上不适用而在 XP 上很好用的东西呢？在使用 Windows 2000 后，我很难转换到 XP - 还记得 98 有多糟糕吗？在那之后我不想离开我的“安全毯”。这不是一个bash，真的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-17T15:05:55.507

2.0 相对稳定，而且相当普遍。1.1 较旧，这意味着它可能存在错误，并且它们的解决方法是众所周知的。我会很惊讶地发现一台没有安装 2.0 的 Windows 机器。这些因素可能会产生影响。

另外，考虑到人们可能在旧版本的框架出现之前就已经开始开发他们的产品了。在很多情况下，如果您的应用程序是 .NET 2.0 应用程序，您可能不需要 3.x 框架中的任何内容。Visual Studio 2008 可以针对 2.0 框架，因此没有真正迫切需要“升级”这些应用程序。当更改没有任何好处时，验证一切是否正常工作并不值得 QA 工作。

最后，还有神话。人们喜欢相信他们的朋友，不管他们是否无知。根据您的要求，.NET Framework 3.5 的下载大小为 50 MB、100 MB、200 MB 或 1.82 TB。似乎人们选择了对手头的情况来说似乎很可怕的最大数字。这些人类似于宣扬这种被称为“互联网”的新发明的危险的人，它可能使我们所有人暴露在犯罪分子和危险之下。 [您可以以 28 MB 的大小下载该框架。](http://www.hanselman.com/blog/SmallestDotNetOnTheSizeOfTheNETFramework.aspx)听起来粗糙？现在你可以花 1 美元买到这么多的 USB 驱动器，而且我下载的 PDF 文件更重。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-17T14:49:08.240

主要问题是您的应用程序需要特定版本的 .NET 框架；对于可能必须下载 100 MB 或更大的安装程序的最终用户来说，这并不是那么有趣。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-17T15:07:09.917

对于可以在其业务线桌面上安装哪些软件，我们的许多客户都有严格的政策。它们甚至没有配置为在发布时接收 MS 自动更新，但只会应用由他们自己的 IT 管理员推出的某些更新（这些桌面中的大多数都没有互联网连接）。

对于像这样的客户，我们不能只发布依赖 .Net 3.5 的新版本软件。由于这些政策，我们将在 2.0 上再使用 18 个月（至少），直到我们现有的客户认为 .net 3.5 不是邪恶的并且不会破坏他们的任何业务线软件。. . 到那时 4.0 将被打破，我将不得不坐下来对这个时髦的“新”linq 东西感到满意，而其他所有人都可以玩酷的新 4.0 功能*叹息*

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-17T15:34:24.763

我认为很多人忘记了没有升级框架实际上有很多成本。

1.  有时你必须升级。您的操作系统或其他程序将不受支持。因此，更多的是不时进行小升级或稍后进行大升级的问题。

2.  大多数程序员（我认为）都想玩最新的玩具并学习新技术以保持动力。

3.  您将能够更快地创建程序，这当然会再次降低您的产品和项目的价格，以便在竞争中保持领先，您希望处于优势地位。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-17T18:12:13.477

如果您仍在开发中并且尚未发布您的软件，则可以切换到较新的 fx 版本（对于 java 运行时也是如此）。但是，如果您已经发布了部署更新，那就更难了。在这种情况下，使用旧的 fx 会容易得多。

# silverlight-2.0 - 我必须具备哪些条件才能开始免费学习 Silverlight 2？

> ID：374744
> 
> 赞同：1
> 
> 时间：2008-12-17T14:45:12.943
> 
> 标签：silverlight-2.0

我需要安装什么才能开始学习 Silverlight 2？我知道如何构建 Web 应用程序和使用 c#，但我对 Silverlight 的经验很少。当它第一次出现时，我使用了一点，并决定等到更多的 .net 集成发生。过去我使用过 Visual Studio 2005 Pro。对于我的应用程序，但现在摆脱了 2008 Express，所以我没有完整版本。

我看到了这个问题：

[Silverlight 开发入门](https://stackoverflow.com/questions/60620/getting-started-with-silverlight-development)

但它是从九月开始的。我想知道是否有任何改变。

我想问题应该是：我应该安装哪些免费应用程序来学习和在生产 Silverlight 2 中使用？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T14:57:01.717

请参阅[Silverlight 2 已发布：新控件、工具、公告！](http://timheuer.com/blog/archive/2008/10/14/silverlight-2-released-officially.aspx)：

> 安装 Silverlight 工具的要求是​​您必须安装 Visual Studio 2008 SP1。如果您是 Visual Web Developer Express 用户，这些工具也适合您！您仍然必须拥有 VWD Express 的 SP1，但您可以安装这些工具来开发 Silverlight 应用程序。因此，您可以**使用 Visual Web Developer Express 2008 SP1 和 Silverlight 工具获得 Silverlight 的免费开发工具环境！**

以下是[适用于 Visual Studio 2008 SP1 的 Microsoft® Silverlight™ 工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=c22d6a7b-546f-4407-8ef6-d60c8ee221ed&displaylang=en)。

我不认为[Blend](http://www.microsoft.com/expression/try-it/Default.aspx?filter=blend)是免费的，但您可以手动编写所有 XAML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T14:52:55.220

你可能也想看看这个：

[良好的学习资源-silverlight-2-开发](https://stackoverflow.com/questions/203466/good-resource-for-learning-silverlight-2-development)

# sql - 在 O(1) 中计算 SQL 表中的行数

> ID：374746
> 
> 赞同：9
> 
> 时间：2008-12-17T14:45:48.683
> 
> 标签：sql, performance, count

我了解计算 SQL 表中行数的最佳方法是 count(*)（或等效的 count(PrimaryKey)）。

1.  这是 O(1) 吗？
2.  如果不是，为什么不呢？

为什么不直接实现一个计数器并为这个特定的查询返回它呢？是因为这个查询不是一个常见的用例吗？

如果答案因 SQL 引擎而异，我想听听不同之处 - 但无论如何，我对生产 SQL 引擎中的实际实现感兴趣。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-17T15:10:11.270

在*某些*RDBM 中，这是 O(1)（最值得注意的是 MySQL），将 AFAIK 放在通常不被接受并被认为是“丑陋的性能黑客”。原因是，如果您有事务（每个真正的 RDBM 都应该有），那么表中的总行数可能等于也可能不等于*您可以从当前事务中看到*的总数。这就是为什么服务器需要检查哪些行对您的事务实际可见，使其 O(n) 比 O(1) 更多。

如果您想优化获取行数的过程并对近似结果感到满意，大多数 RDBM 都有特殊的“信息”表，其中包含有关表的信息，包括大致的行数（同样，它不是*确切的*由于事务的行数）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-17T15:09:54.297

不，这不是一个常见的用例。我见过的大多数行数都涉及到一些 where 子句。

未实现的主要原因是行计数器将成为多用户环境中争用的原因。每次插入或删除一行时，计数器都需要更新有效地锁定每个插入/删除的整个表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T15:35:56.180

基于索引或表的 COUNT(*) 的性能实际上取决于段大小。你可以有一个只有一行的 1GB 表，但 Oracle 可能仍然需要扫描整个分配的空间。如果不改变高水位线，再插入一百万行可能根本不会影响性能。索引以类似的方式工作，其中不同的删除模式可能会在索引结构中留下不同数量的可用空间，并导致索引扫描提供比 O(N) 更好或更差的性能。

因此，理论上它是 O(N)。在实践中，存在可能导致它非常不同的实施问题。

例如，在某些情况下，Oracle 数据仓库的性能可能优于 O(N)。特别是优化器可以扫描位图索引，位图索引的大小与表的大小只有微弱的关系，这与 b 树索引不同。这是因为压缩方法使索引大小取决于表的大小、唯一值的数量、整个表中值的分布以及我相信的历史加载模式。因此，将表中的行数增加一倍可能只会将索引的大小增加 10%。

在存在物化视图的情况下，您还可能通过读取汇总表得到 O(1)（触发器是一种不安全的做法）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-19T17:10:28.650

在 MS SQL 服务器中，对表执行 Count(*) 总是执行索引扫描（在主键上）或表扫描（都不好）。对于大型表，这可能需要一段时间。

相反，有一个很酷的技巧可以几乎立即显示当前的记录数（当您右键单击表格并选择属性时，Microsoft 使用的相同）：

```
--SQL 2005 or 2008
select sum (spart.rows)
from sys.partitions spart
where spart.object_id = object_id('YourTable')
and spart.index_id < 2

--SQL 2000
select max(ROWS) from sysindexes
where id = object_id('Resolve_Audit') 
```

根据 SQL 更新索引统计信息的频率，这个数字可能会略有偏差，但如果您需要一个大概的数字，而不是一个确切的数字，那么这些方法非常有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T22:48:18.303

这不是固定时间，因为在事务引擎中需要检查当前事务中存在多少行，这通常涉及全表扫描。

优化没有 where 子句的 COUNT(*) 对数据库来说并不是一个特别有用的优化，它会以牺牲其他东西为代价；大表的用户很少进行这样的查询，如果存在 WHERE 子句，它根本无济于事。

MySQL 中的 MyISAM 通过存储确切的行数来“欺骗”，但它只能这样做，因为它没有 MVCC，因此不需要担心行在哪些事务中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T14:59:27.330

对于 Oracle，它通常为 O(N)，除非查询结果在缓存中，因为它本质上必须迭代所有块，或者迭代索引以计算它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-17T15:12:56.660

通常是 O(N)。

如果需要对此类查询的 O(1) 响应，您可以使用以下方法轻松完成它：

*   对查询进行计数的索引视图。
*   在另一个表中手动存储计数并使用触发器更新行计数：

例子：

```
CREATE TABLE CountingTable ( Count int )

INSERT CountingTable VALUES(0)

CREATE TRIGGER Counter ON Table FOR INSERT, UPDATE, DELETE AS
BEGIN
   DECLARE @added int, @Removed int
   SET @added = SELECT COUNT(*) FROM inserted
   SET @removed = SELECT COUNT(*) FROM deleted
   UPDATE CountingTable SET Count = Count + @added - @removed
END 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-17T15:03:35.043

数据库可以存储表中的行数并响应 O(1) `select count(*) From MyTable`

但是，真的，这对他们有什么好处呢？任何变化（比如`select count(*) from MyTable where Category = 5`）都需要全表扫描（或索引扫描）并且是 O(N)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-17T15:11:53.137

SQL Server 中有一个（不准确的）快捷方式，您可以在其中查看特定对象的元数据 sys.partitions 中的计数，例如表上的索引。

该操作是 O(1)，但只是一个估计。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-18T01:32:00.763

使用 Informix，在没有 LBAC（基于标签的访问控制）等复杂因素的情况下，`SELECT COUNT(*) FROM SomeTable`则为 O(1)；它从它维护的控制信息中提取信息。如果有 WHERE 子句或 LBAC，或者表是视图或许多其他因素中的任何一个，那么它不再是 O(1)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-18T09:34:08.437

在 PostgreSQL 上显然是 O(N)：

```
=> explain select count(*) from tests;
                         QUERY PLAN                              
---------------------------------------------------------------------
Aggregate  (cost=37457.88..37457.89 rows=1 width=0)
  ->  Seq Scan on tests  (cost=0.00..33598.30 rows=1543830 width=0)
(2 rows) 
```

（Seq Scan 意味着它必须扫描整个表）

# security - 创建 SQL 代理作业需要哪些 SQL 2000 权限？

> ID：374748
> 
> 赞同：-1
> 
> 时间：2008-12-17T14:46:21.130
> 
> 标签：security, sql-server-2000, sql-server-agent

自从我查看 SQL Server 2000 上的 SQL 作业以来已经有很长时间了。

在 SQL 2005 上，如果我想允许用户创建作业等，我将必要的登录添加到 msdb 并分配角色 SQLAgentUserRole、SQLAgentReaderRole 或 SQLAgentOperatorsRole 角色之一。那里没问题。

也许有人可以帮我回忆一下在 SQL 2000 上创建工作所需的权利/角色，因为我很尴尬地说我已经完全忘记了，而且 SQL 2000 在线书籍也不是很清楚。

如果用户是 SQL 2000 数据库中的 dbo，是否会自动授予创建 sql 代理作业的权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T15:52:35.897

事实上，每个用户都可以创建一个新的 SQL Server 代理作业。

您可以控制的是他们对您的数据库对象的权利。我刚刚尝试过，一个完全没有权限的用户（所有数据库上的denydatareader和denydatawriter）仍然可以创建一个新的SQL Server代理作业，但他不能在其中做任何事情。

希望这可以帮助！

# graphics - 了解颜色

> ID：374749
> 
> 赞同：9
> 
> 时间：2008-12-17T14:46:46.997
> 
> 标签：graphics, user-interface, colors, graphic-design

请指向要阅读的理论/材料，以了解颜色以及如何构成良好的颜色组合。请注意，我对说“Web 应用程序的颜色组合”等不感兴趣。更多的是说“颜色和人类”。

免费阅读的材料是我正在寻找的。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T15:15:03.600

除了链接之外，我还想发布我选择令人愉悦的颜色的方式：

1.  *永远不要*使用纯色。即使您想要纯色，也不要！例如，如果您想要强烈的亮绿色，请不要使用 00ff00。改用 10e013 之类的东西。

2.  如果您有自己喜欢的一种颜色，并且想要另一种适合第一次打开图形程序的颜色。转到颜色选择器，输入您的颜色，然后切换到 HSV 模式。然后调整色相、饱和度或亮度之一。不要修改两个或所有参数，只修改一个。这样可以确保您选择的颜色在感知上与您开始使用的颜色相关。

3.  如果您不知道从什么颜色开始，请从网上获取经典的绘画杰作。稍微模糊一下，然后从中挑选一些漂亮的颜色。如果您使用一些常识，很难不以这种方式结束令人愉悦的颜色。

举个例子：我刚刚选择了这些颜色：

![替代文字](https://torus.untergrund.net/misc/colors.png)

从这幅画：

[http://www.cs.nthu.edu.tw/~sheu/Images/Monet.jpg](http://www.cs.nthu.edu.tw/~sheu/Images/Monet.jpg)

我知道 - 这不是你所要求的，但我很难学会这些技巧。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T14:49:25.680

请参阅[颜色方案生成器](http://www.wellstyled.com/tools/colorscheme2/index-en.html)、[颜色向导](http://www.colorsontheweb.com/colorwizard.asp)、[颜色组合](http://www.colorcombos.com/)。他们都有一些理论或理由。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T15:06:04.787

颜色和人类是一个非常复杂的话题。科学家们并不完全了解我们人类如何感知颜色。（另见[http://en.wikipedia.org/wiki/Psychophysics](http://en.wikipedia.org/wiki/Psychophysics)）

那里有很多好书，但我使用了一些免费资源：

[http://en.wikipedia.org/wiki/Color](http://en.wikipedia.org/wiki/Color)

[http://en.wikipedia.org/wiki/Color_vision](http://en.wikipedia.org/wiki/Color_vision)

[http://handprint.com/HP/WCL/wcolor.html](http://handprint.com/HP/WCL/wcolor.html)

[http://www.efg2.com/Lab/Library/Color/](http://www.efg2.com/Lab/Library/Color/)

[http://www.cis.rit.edu/fairchild/](http://www.cis.rit.edu/fairchild/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T14:50:52.260

这里有一些理论：

[http://www.worqx.com/color/index.htm](http://www.worqx.com/color/index.htm)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T09:57:07.703

Colin Ware 的信息可视化：

[![信息可视化，Colin Ware](https://i.stack.imgur.com/MPkuG.jpg)](https://rads.stackoverflow.com/amzn/click/com/1558608192)

包含的不仅仅是色彩理论。但它是了解人类感知的一些基础知识以及如何确保您的设计运行良好的重要学术资源。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-05T10:04:46.830

Robin Williams 的“非设计师设计书”是任何需要准备出版材料（包括软件 UI）的人的必读之书，其中包括关于颜色的一章：

[http://www.amazon.com/Non-Designers-Design-Book-3rd-Designers/dp/0321534042/ref=sr_1_1?ie=UTF8&s=books&qid=1233828208&sr=1-1](https://rads.stackoverflow.com/amzn/click/com/0321534042)

# threadpool - 自定义线程池中的 IOCP

> ID：374756
> 
> 赞同：1
> 
> 时间：2008-12-17T14:48:20.563
> 
> 标签：threadpool, iocp

我目前正在互联网上搜索自定义线程池实现。我找到了一个使用 IOCP 的实现。我想知道使用它们有什么好处？他们是否提供工作窃取或类似的东西，我真的可以找到答案......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T06:19:23.033

IOCP = "IO 完成端口"。它是内置在 Windows 操作系统中的内核对象，可为您提供管理多线程异步 IO 的智能方法。

用非常简单（而且有点过于简单）的术语，你告诉 IOCP 你想要完成的 IO 工作。它将异步执行它们并维护每个作业结果的队列。您告诉 IOCP 工作的电话会立即返回（在 IO 发生时它不会阻塞）。您将返回一个概念上类似于 .NET IAsyncResult 的对象......如果您选择阻止，它可以让您阻止，或者您可以提供回调，或者您可以定期轮询以查看作业是否完成。

在执行这些工作时，IOCP 使用线程池。线程池尝试将线程数限制为处理器数量或更少（这是可配置的，但意图和默认设置是将其限制为处理器数量）。但是，IOCP 规定，有时这些线程上的任务可能会阻塞。Asycn IO 任务不会阻塞，但您可能已经为其提供了其他类型的任务。因此，您可以给 IOCP 另一个数字……这是高于“通常最大值”的线程数，由于其他线程之一被阻塞，IOCP 被允许上升到该数值。目标是使实际执行某事（即未阻塞）的线程达到“通常最大值”。如果发生这种情况，那么 IOCP 将在一段时间内使用比通常的最大值更多的线程，

这是一个简短的总结，只是概念性的，正如我所说，在某些方面过于简化了。但它应该给你一个大致的想法。Jeffrey Richter 关于 Windows 操作系统的书籍详细介绍了这一点（但这些书籍现在已绝版）。你会发现这些书被使用过，而且它们的使用成本实际上比原来的要高。我认为“Advanced Windows”是您想要的标题，但该书的更新版本可能具有不同的标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-25T19:43:24.660

将 IOCP 用于线程池的最大好处是，它监视其线程，如果一个线程由于某种原因（包括页面错误、阻塞调用等）阻塞超过 100 毫秒，它会重新启动另一个由于达到并发限制而正在等待的线程。我不知道内部实现，但我不认为它使用工作窃取队列。

# django - 是否有计划通过 IIS 正式支持 Django？

> ID：374760
> 
> 赞同：20
> 
> 时间：2008-12-17T14:49:36.663
> 
> 标签：django, iis

我说得对，因为过去与我交谈过的每个人都说在 IIS 上运行 Django 是一种黑客行为。我让它工作了一些，但它从来没有做得很好，而且确实感觉像一个黑客。我喜欢 python，但不得不放弃它，因为我永远无法让 Django 与 IIS 一起工作，而 Django 是我在生产 Web 应用程序中使用 Python 的借口。但它太乱了，我不能凭良心把它卖给小组。所以，我想为什么要与之抗争，坚持使用 asp.net、IIS、推出自己的或使用 MS 的框架。只是想知道是否有任何改变。顺便说一句，不敲asp.net。我只是想使用 Python。

谢谢你。

编辑 - 是否有任何新计划正式支持 IIS？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-18T11:22:20.870

Django 是基于 WSGI 的框架，因此只要 IIS 得到正确的 WSGI 处理，在这种环境下运行 Django 应该没有问题。任何连接 WSGI 和 IIS 的东西都可以。

快速谷歌搜索揭示[了 Google Code 上的一些项目](http://code.google.com/p/isapi-wsgi/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-12-10T09:13:37.273

看看 Helicon Zoo — 用于运行 Python/Django 应用程序的本地快速 IIS 7 模块。

关于它的好文章：[在 Windows 上运行 Django](http://www.helicontech.com/articles/running-django-on-windows-with-performance-tests/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T06:23:53.773

通过 WSGI 与 IIS 直接集成还有另一种（更快的）替代方案：[PyISAPIe](http://pyisapie.sourceforge.net)。

isapi-wsgi 基于 Python 中包含的相对过时的 ISAPI 模块，与 IIS6/7 的设计不匹配。FastCGI 是进程外的，需要到 IIS 的 IPC 连接。基本 CGI 意味着为*每个*请求重新加载 Python。

此外，PyISAPIe 为那些更喜欢性能而不是兼容性的人提供了一个较低级别的接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T09:36:16.847

我正在四处寻找有关同一主题的一些信息。我在 codeplex 上找到了一个项目，Jeff Hardy 在 .net - NWSGI 上实现了 WSGI 接口。他的博客上也有一些关于专门运行 DJANGO 和 IronPython 的条目。

博客：http: [//jdhardy.blogspot.com/search/label/Django](http://jdhardy.blogspot.com/search/label/Django)

NWSGI 项目：[http ://nwsgi.codeplex.com/](http://nwsgi.codeplex.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-28T23:56:51.913

我知道这不是您要寻找的答案，但希望它可以帮助其他人！

> 我在我的博客上发布了一个[关于 Windows 2008 的 Django 教程/howto](http://nick-bolton-uk.blogspot.com/2009/08/django-works-windows-server-2008.html)，您可能会发现它很有帮助。

在尝试使用 PyISAPIe 在 IIS7 上运行 Django 几个小时后，我放弃了，因为我在访问该站点的 URL 时收到了这个（难以诊断）错误代码：

```
PyISAPIe
0x8007007e 
```

显然，PHP ISAP 也会发生这种情况（这显然表明缺少 DLL 依赖项），因此它可能与我在 PyISAPIe 中遇到的问题相同。此外，当我尝试使用安装程序进行安装时，我收到了一些关于缺少 DLL 的错误，所以这听起来很合乎逻辑。

无论如何，我只想说，看起来 Django+IIS 并没有那么流行，所以支持似乎不是很好......

服务器有一个额外的 IP 地址，所以现在我将在 IIS7 旁边运行 Apache，因为服务器上运行了一些 .Net 应用程序。

**旁注：**要同时运行 IIS7 和 Apache，您需要告诉 IIS7[只绑定到一个 IP 地址](https://serverfault.com/questions/35650/setting-up-iis7-and-tomcat-on-single-machine-with-multiple-ip/35653#35653)。

**更新：**刚刚让 Django 在 Windows Server 2008 上工作！它与现有的 IIS7 安装（仅绑定到一个 IP）一起在 Apache 上运行，并且似乎工作得很好......而且，我推荐这条路线，而不是试图让 IIS7 与 Django 配合得很好 -相信我，你会过得更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T22:22:43.767

您应该可以使用 MS 开发的 FastCGI isapi。它适用于 6，但在 7 上有更好的集成。免责声明：我没有在 Django 上尝试过。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T18:37:06.790

除了 Microsoft 创建的产品和语言之外，通常不提供“官方”支持。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-22T09:43:51.560

至于“官方”位......由于 Django 1.0（和更新的版本）完全符合 WSGI，如果 WSGI 有时会成为唯一的“官方”部署方法，我不会感到惊讶。由于 mod_python 已被弃用（不再开发）并且 FastCGI 真正由 FCGI-to-WSGI 网关提供服务，这似乎是合理的预测。

# c++ - 在 C++ 中将 MBCS 流转换为 UTF-8，反之亦然

> ID：374761
> 
> 赞同：2
> 
> 时间：2008-12-17T14:49:38.533
> 
> 标签：c++, encoding, utf-8, mbcs

我正在使用 Visual C++ (VS2005) 并以多字节字符集 (MBCS) 编译项目。但是，程序需要通过 XMLRPC 与 webapp（utf-8 格式）进行通信。所以我在想也许我可以在内部使用 MBCS 并将字符串转换为 utf-8，然后再将它们发送到 xmlrpc 模块并在从 webapi 接收后将它们转换回 MBCS。

我想知道在 VC++ 中转换 MBCS 和 UTF-8 的最佳方式是什么？

谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T15:52:53.367

调用[MultiByteToWideChar](http://msdn.microsoft.com/en-us/library/ms776413(VS.85).aspx)将您的字符串转换为 unicode，然后调用[WideCharToMultiByte](http://msdn.microsoft.com/en-us/library/ms776420(VS.85).aspx)将 unicode 转换为 UTF-8。把过程倒过来走另一条路，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T15:49:20.270

你可以试试[wcstombs](http://msdn.microsoft.com/en-us/library/5d7tc9zw(VS.80).aspx) / [mbstowcs](http://msdn.microsoft.com/en-us/library/k1f9b8cy(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T16:25:10.043

您还可以使用 CT2A 并将 CP_UTF8 作为代码页传递，例如：

```
CT2A pszUTF8(_T("My DBCS string"), CP_UTF8);
// pszUTF8.m_psz contains the UTF8 string. 
```

再次返回：

```
CA2T pszT(_T("My UTF8 string"), CP_UTF8);
// pszT.m_psz contains the TCHAR string. 
```

# ms-access - 访问：根据查询将字段导出到 Excel

> ID：374762
> 
> 赞同：1
> 
> 时间：2008-12-17T14:49:40.797
> 
> 标签：ms-access

我希望根据查询表将一些文件从 MS Access 导出到 Excel 中。

就像这样查询将是

```
select * from table where field = 0 
```

我想循环查询直到字段为 9，并且我想将每个结果保存为不同的名称，例如 field1、field2

这将如何修改？

```
strqry = "select * from table where field = 1"
DoCmd.TransferSpreadsheet acExport, _
                            acSpreadsheetTypeExcel9, _
                            "strqry", _
                            "C:\Reports\Data_Analysis1.xls", _
                            True 
```

另外我如何将第一张工作表命名为 field1 并在下一个循环 field2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T15:17:01.507

所以你真正想要的是这样的

```
dim i as integer

for i = 1 to 9 
    strqry = "select * from table where field = "  & i
    DoCmd.TransferSpreadsheet acExport, _
                              acSpreadsheetTypeExcel9, _
                              strqry, _
                              "filename.xls", _
                              True, _
                              "sheetname_" & i
next i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T09:25:26.037

我终于以这种方式完成了

```
For i = 1 To 9
    CurrentDb.QueryDefs("MyQuery").SQL = "Select * from table Where field = " & i
    DoCmd.TransferSpreadsheet acExport, _
                                acSpreadsheetTypeExcel9, _
                                "MyQuery", _
                                "C:\Reports\Data_Analysis.xls", _
                                True, _
                                "Field_" & i
Next i 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T15:09:22.050

在 TransferSpreadsheet 命令的“范围”字段中指定工作表名称。

```
DoCmd.TransferSpreadsheet acExport, _
                            acSpreadsheetTypeExcel9, _
                            "tablename", _
                            "filename.xls", _
                            True, _
                            "sheetname" 
```

# python - 我应该在 Python 方法名称中使用 get_/set_ 前缀吗？

> ID：374763
> 
> 赞同：18
> 
> 时间：2008-12-17T14:49:54.337
> 
> 标签：python, coding-style

在 Python 中，使用属性而不是 Java 风格的 getter、setter。所以很少有人在类的公共接口中看到 get... 或 set.. 方法。

但在某些情况下，如果某个属性不合适，则最终可能仍会使用行为类似于 getter 或 setter 的方法。现在我的问题是：这些方法名称应该以`get_`/开头`set_`吗？或者这是因为它的含义通常很明显（并且仍然可以使用文档字符串来澄清非显而易见的情况），所以这是一种非pythonic vebosity？

这可能是个人品味的问题，但我会对大多数人对此的看法感兴趣？作为 API 用户，您更喜欢什么？

示例：假设我们有一个代表多个城市的对象。一个人可能有一种方法`get_city_by_postalcode(postalcode)`，或者一个人可以使用较短的名称`city_by_postalcode`。我倾向于后者。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-17T16:01:57.123

[您将永远不会失去通过使用描述符](http://users.rcn.com/python/download/Descriptor.htm)使您的属性表现得像 getter/setter 的机会。如果要将属性更改为只读，也可以将其替换为与该属性同名的 getter 方法，并使用@property 进行装饰。因此，我的建议是避免使用 getter/setter，除非您正在处理的项目已经使用它们，因为您以后总是可以改变主意并使属性成为只读、只写或其他任何内容，而无需修改类的接口。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-17T15:16:03.550

我认为越短越好，所以我倾向于选择后者。但重要的是要与您的项目保持一致：不要混合使用两种方法。如果您跳入别人的项目，请保留其他开发人员最初选择的内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-17T16:35:53.797

如果它可用作属性（获取或设置一个值，没有其他参数，我通常会这样做：

```
class Foo(object):

    def _get_x(self):
        pass

    def _set_x(self, value):
        pass

    x = property(_get_x, _set_x) 
```

如果 getter/setter 比这更复杂，我会使用 get_x 和 set_x：

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T15:17:01.770

我已经看到它是双向的。来自 Objective-C 背景，`foo()/set_foo()`如果我不能使用属性，我通常会这样做（尽管我尽可能尝试使用属性）。不过，这并不重要，*只要您始终如一*。

（当然，在您的示例中，我根本不会调用该方法`get_city_by_postalcode()`；我可能会`translate_postalcode`使用名称中使用更好动作动词的类似方法。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T19:05:50.827

如果我必须使用 getter/setter，我喜欢这样：

假设你有一个变量 self._x。然后 x() 会返回 self._x 的值，setX(x) 会设置 self._x 的值

# python - 如何在 Python 中测试 file.read() 错误？

> ID：374768
> 
> 赞同：4
> 
> 时间：2008-12-17T14:51:23.507
> 
> 标签：python, file-io, error-handling

我有以下代码（改编自[Dive Into Python](http://diveintopython.net/file_handling/file_objects.html#d0e14928)中给出的示例），它将文件的全部内容读入缓冲区。

```
buffer = ""

try:
    file = open(postFileName, 'rU')
    try:
        # Read the entire POST log file into a buffer
        buffer += file.read()
    finally:
        file.close()
except IOError:
    buffer += "The POST file could not be opened." 
```

这段代码让我困扰的是没有 except 块的内部 try/finally 块。我需要一个 except 块吗？调用成功后可以调用`read()`失败`open()`吗？我知道 try-except-finally 现在是统一的，所以添加一个，至少在语法上，不是问题。

如果我添加一个 except 块，它将在什么条件下执行，以及如何编写测试以确保它在这些条件下运行？

此外，如果我*不需要*except 块，那么为什么我需要内部 try/finally 块呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-17T15:29:27.940

我发现 finally 块经常被过度使用。文件关闭（以及一些其他类似的模式）非常重要，Python 3.0 将有一个**with**语句，只是为了以稍微不那么晦涩的方式覆盖这个基础。

*   最后我需要一个例外吗？

    这触及了这个特定示例的令人困惑的性质，以及他们添加**with**语句的原因。

    **finally**会“无论如何”进行清理。异常或无异常，**finally**总是被执行。

*   调用 open() 成功后调用 read() 会失败吗？

    所有操作系统调用、所有 I/O 调用（几乎所有）都可能引发异常。在打开之后和阅读之前，各种不好的事情都可能发生。

*   如果我添加一个**except**块，它将在什么条件下执行？

    阅读文件。在打开和读取之间可能会发生许多愚蠢的 I/O 错误。此外，请阅读内置异常。 [https://docs.python.org/2/library/exceptions.html](https://docs.python.org/2/library/exceptions.html)

*   如何编写测试以确保它在这些条件下运行？

    您将需要一个模拟文件对象。该对象将响应`open`但在每个.`IOError``OSError``read`

*   如果我不需要 except 块，那么为什么我需要内部 try/finally 块呢？

    清理。无论引发什么异常，**finally**都会执行。

试试这个。看看它做了什么。

```
try:
 raise OSError("hi mom")
finally:
 print "Hmmm" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T15:31:43.380

我不同意其他提到统一 try / except / finally 块的答案。这会改变行为，因为如果打开失败，您不希望 finally 块尝试关闭文件。拆分块在这里是正确的（尽管使用新的 " `with open(filename,'rU') as f`" 语法可能会更好）。

read() 可能会失败是有原因的。例如，数据可能太大而无法放入内存，或者用户可能已使用 control-C 发出中断信号。这些情况不会被 IOError 捕获，而是由调用者处理（或不处理），调用者可能想要根据应用程序的性质做不同的事情。但是，代码仍然有义务清理文件，即使它没有处理错误，因此 finally 没有例外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T15:05:38.283

使用最新版本的 Python，您不需要嵌套 try-except 和 try-finally。try-except-finally 已经统一：

```
try:
  non_existing_var
except:
  print 'error'
finally:
  print 'finished' 
```

# c# - 链式中频结构

> ID：374770
> 
> 赞同：7
> 
> 时间：2008-12-17T14:51:41.120
> 
> 标签：c#, java

想象一下这种情况，我有一个需要检查属性的对象。但是，该对象当前可以具有空值。

如何在一个“if”条件下检查这两个条件？

目前，我必须做这样的事情：

```
if (myObject != null)
{
    if (myObject.Id != pId)
    {
        myObject.Id = pId;
        myObject.Order = pOrder;
    }
} 
```

我想要这样的东西：

```
if (myObject != null && myObject.Id != pId) 
```

只有当第一个条件为真时，我才想评估第二个条件。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-12-17T14:53:34.860

```
if (myObject != null && myObject.Id != pId)
{
   myObject.Id = pId;
   myObject.Order = pOrder;
} 
```

`&&`是一个短路逻辑测试 - 如果左侧为真，它只评估右侧。对比`a & b`，它总是计算两边（当与整数类型而不是 一起使用时`bool`，会按位“与”）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-17T15:08:55.843

应该强调的是，语言标准（C、C++、Java 和 C#）**绝对保证**了 if() 中 && 的短路评估。*从 K&R 的“ C 编程语言*”第一版开始就是这样。

您不必担心“我的编译器是否实现了这个？”。如果确实*如此*。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-17T14:54:17.900

```
if (myObject != null && myObject.Id != pId)
{
//bla
} 
```

这是安全的，因为操作符 && 被延迟评估，这意味着如果 LHS 为假，则永远不会评估 RHS

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T14:56:23.137

此代码将首先检查 myObject 是否不为空，如果为真则检查下一个条件，如果不为真则不检查下一个条件并且不执行代码。

```
if (myObject != null && myObject.Id != pId)
{
  myObject.Id = pId;
  myObject.Order = pOrder;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-17T15:00:26.203

你有很多关于如何做的好答案。我只是想就如何不这样做提出警告。 **不要将 id=pid 的单个测试包装在 try-catch 块中。** 这是浪费的，并且会涉及引入异常检查来捕获非异常情况。这是一个糟糕的主意，我什至不打算用一个例子来说明它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T14:55:25.510

```
if (myObject != null && myObject.Id != pId)
{
     myObject.Id = pId;
     myObject.Order = pOrder;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-17T15:25:03.347

```
if(!(myObject == null || myObject.Id == pId))
{
   myObject.Id = pId;
   myObject.Order = pOrder;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-17T15:48:09.790

我认为在 VB.net 中，您可以使用`AndAlso`关键字来替代这种行为。所以像……</p>

```
if myObject IsNot Nothing AndAlso myObject.Id <> pId Then
    myObject.Id = pId
    myObject.Order = pOrder
End If 
```

做的事情和我想的完全一样，但它可以作为替代方案！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-17T20:48:51.787

因为我认为这可能对其他人在未来查看这个问题有所帮助。如前所述，使用 && 提供了您想要的功能。但是，还应该注意，您担心无论第一次评估的结果如何都会评估双方的功能可以通过使用 & 而不是 && 来获得。所以：

```
//DO NOT USE THIS CODE
//this will throw an exception if myObject is null
//because myOject.Id != pId will still be evaluated
if(myObject != null & myObject.Id != pId)
{   
   myObject.Id = pId;
   myObject.Order = pOrder;
} 
```

同样，对于此示例，您不需要此代码。我只是想将它添加到对话中，因为在某些情况下（尽管我从未找到过）这是您想要的功能，例如：

```
//always run both methods
if(MethodA() & MethodB())
{   
   //do stuff only when both methods return true
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-12T10:42:42.197

您可以使用`&`来评估两个条件，但如果您只想在第一个元素为真时测试第二个条件，您可以使用`&&`. 后者称为 AND 运算符的“短路”版本。

```
if (myObject != null && myObject.Id != pId) 
```

如果`myObject`是`null`您无法测试`myObject.Id`，因为`myObject`是`null`并且您无法访问`null`对象的属性。

```
阿巴&&b
______________________
真的 真的 真的
真假假
假 真 假
假 假 假
```

# php - 滚动和打包 PHP 脚本

> ID：374779
> 
> 赞同：1
> 
> 时间：2008-12-17T14:54:06.467
> 
> 标签：php, optimization

我只是在阅读[这个线程](https://stackoverflow.com/questions/186338/why-is-requireonce-so-bad-to-use)`include_once`，其中使用和`require_once`正在辩论的利弊。从那个讨论（特别是[Ambush Commander 的回答](https://stackoverflow.com/questions/186338/why-is-requireonce-so-bad-to-use#194979)）中，我已经消除了这样一个事实（？），即 PHP 中的任何类型的包含本质上都是昂贵的，因为它需要处理器将新文件解析为 OP 代码等等。

这让我开始思考。

我编写了一个小脚本，它将许多 Javascript 文件“滚动”到一个文件中（将所有内容附加到另一个文件中），以便可以[打包](http://dean.edwards.name/packer/)它以减少 HTTP 请求和整体带宽使用。

通常对于我的 PHP 应用程序，我有一个包含在每一页上的“includes.php”文件，然后包含我需要的所有类和其他库。（我知道这可能不是最好的做法，但它确实有效`__autoload`——PHP5 的特性在任何情况下都让它变得更好）。

**我应该对我的 PHP 文件应用相同的“滚动”技术吗？**

我知道关于过早优化是邪恶的说法，但是让我们把这个问题当作理论上的问题，好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T10:36:24.030

Windows 上的 Apache/PHP 存在一个问题，导致应用程序在加载甚至接触太多文件时非常慢（加载大约 50-100 个文件的页面可能仅在文件业务上花费几秒钟）。包含/要求和使用文件（fopen、file_get_contents 等）都会出现此问题。因此，如果您（或更可能是其他任何人，由于这篇文章的年代久远）将在 apache/windows 上运行您的应用程序，那么减少加载文件的数量对您来说是绝对必要的。将更多的 PHP 类合并到一个文件中（一个自动化脚本会很有用，我还没有找到），或者小心不要触及应用程序中任何不需要的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:12:27.583

正如您所说：“过早的优化......”。再说一次，如果您担心性能，请使用 APC 之类的操作码缓存，这会使这个问题几乎消失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T15:39:57.357

这在一定程度上取决于解析几个小文件或解析一个大文件是否需要更多工作。如果您根据需要需要文件（并不是说您一定*应该*那样做），那么对于某些执行路径，与将所有代码滚动到解析器拥有的一个大 PHP 文件相比，可能需要的编译量要少得多对是否需要进行编码。

与这个问题保持一致的是，这不仅仅是在 PHP 运行时内部的专业知识，而是在大声思考——这听起来好像根本没有任何现实世界的好处。如果您的 PHP 遇到严重的减速，如果使用 require_once 成为瓶颈，我会感到非常惊讶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T15:46:48.107

这不是您直接问题的答案，只是关于您的“js包装”。

如果您不理会您的 javascript 文件并允许它们单独包含在 HTML 源中，浏览器将缓存这些文件。然后在浏览器请求相同的 javascript 文件时的后续请求中，您的服务器将返回 304 未修改的标头，并且浏览器将使用缓存的版本。但是，如果您在每次请求时将 javascript 文件“打包”在一起，浏览器将在每次页面加载时重新下载文件。

# javascript - 跨域 Javascript 书签

> ID：374786
> 
> 赞同：2
> 
> 时间：2008-12-17T14:54:50.100
> 
> 标签：javascript, jquery, cross-domain

我已经在这工作了好几天了，包括这里在内的搜索还没有给我任何解决方案。

我正在创建一个与 POST API 交互的 Bookmarklet。除了最重要的部分外，我已经完成了大部分工作；将数据从 iframe（我知道很糟糕！如果有人知道更好的解决方案，请告诉我）发送到我域上的 javascript（与 API 相同的域，因此与 API 的通信没有问题）。

从用户单击书签的页面中，我需要将以下数据获取到 iFrame 中包含的 javascript。

```
 var title = pageData[0].title;
    var address = pageData[0].address;
    var lastmodified = pageData[0].lastmodified;
    var referralurl = pageData[0].referralurl; 
```

我首先通过将这些数据解析为 JSON 并通过 iFrame 的 name="" 属性发送它来修复它，但在大约 20% 的网页上实现了这一点。我被拒绝访问；这也不是一个非常漂亮的方法。

有谁知道我如何解决这个问题。我不希望使用重定向的 POSTS，我希望这一切都是 AJAX 并且尽可能不引人注目。还值得注意的是，我使用了 jQuery 库。

非常感谢，

冰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-05T13:36:52.103

你应该看看[easyXDM](http://easyxdm.net)，它很容易使用。查看[http://consumer.easyxdm.net/current/example/methods.html上的示例之一](http://consumer.easyxdm.net/current/example/methods.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T23:01:36.063

如果我正确理解您的问题，您可能会通过研究使用 Script Tag 代理取得一些成功。这是在 jquery 和 extjs 等 javascript 框架中执行跨域 AJAX 的标准方法。

请参阅[Jquery AJAX 文档](http://docs.jquery.com/Ajax/jQuery.ajax)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T17:51:05.237

经过大量工作，我找到了一个使用 JSONP 的解决方案，它启用了跨域 Javascript。Codeigniter 框架非常棘手，因为沿 URL 传递数据需要大量编码并确保您没有非法字符。此外，我仍在寻找它的安全性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T17:22:14.280

如果您需要将数据传递给 iframe，而 iframe 实际上包含另一个页面，但另一个页面在同一个域上（我知道很多假设）。

然后手册页代码可以这样做：

```
DATA_FOR_IFRAME = ({'whatever': 'stuff'}); 
```

那么iframe所包含的页面上的代码就可以做到这一点：

```
window.parent.DATA_FOR_IFRAME; 
```

获取数据:)

# .net - 装箱/拆箱和可空？

> ID：374790
> 
> 赞同：8
> 
> 时间：2008-12-17T14:56:04.183
> 
> 标签：.net, nullable

我知道装箱和拆箱是关于铸造（真实类型到对象......对象到真实类型）。但我不明白 MSDN 对 Nullable 的看法。这是我不明白的文字：

> 当一个可为空的类型被装箱时，公共语言运行库会自动装箱 Nullable 对象的基础值，而不是 Nullable 对象本身。也就是说，如果 HasValue 属性为 true，则 Value 属性的内容被装箱。当可空类型的基础值被拆箱时，公共语言运行库会创建一个新的可空结构，该结构已初始化为基础值。[来源](http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx)

当您将对象更改为真实类型时，可以为空的真实类型变量将是对象的类型？我不明白？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-17T14:59:14.020

它的意思是，如果你这样做：

```
int? x = 5;
object y = x; // Boxing 
```

你最终得到一个盒装的`int`，而不是盒装的`Nullable<int>`。同样，如果您这样做：

```
int? x = null; // Same as new Nullable<int>() - HasValue = false;
object y = x; // Boxing 
```

然后 y 最终成为空引用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-17T15:00:05.580

这意味着如果你这样做：

```
int? i = 5;
object o = i; 
```

它是一个装箱的“int”（5），而不是“int？” (5)。如果 x 为 null (!HasValue)，则 o 将为 null，而不是围绕空“int？”的框。

然后当你拆箱时：

```
i = (int?)o; 
```

如果 o 为 null，则 i 变为空的“int？”；否则，将 5 拆箱并用于创建“新 int？（5）”。

基本上，您不应该（除了作弊）能够`nullable<T>`直接获得盒装 - 只有盒装`T`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-17T15:08:15.080

如果 a`Nullable<T>`是`null`，它将被装箱为空引用，并且不会表现为带有 的装箱值类型`HasValue = true`。

事实上，为了实现这个特性，需要 CLR 本质上支持`Nullable<T>`类型并区别对待它。开发人员无法编写自己的类型，就像`Nullable<T>`.

值得注意的是，这是 .NET 2.0 后期的功能之一。在早期的测试版中，`Nullable<T>`表现得就像一个正常的结构。在最终版本中，它被更改为 box to null 引用。这种变化对 SQL Server CLR 团队来说特别重要，他们不得不为此改变一些基本的东西。

# drupal - 是否有理由知道您在视图列表页面上？

> ID：374791
> 
> 赞同：1
> 
> 时间：2008-12-17T14:56:09.877
> 
> 标签：drupal, drupal-views, drupal-5

我不得不将我的页面标题移动到我的节点中以满足客户的需求，但我现在无法在我的视图列表的页面视图上显示标题。我必须在编辑、管理和跟踪页面上显示标题的论点是：

```
<?php if ($title && ((arg(2) == 'track') || (arg(2) == 'edit') || 
  (arg(0) == 'admin'))): ?>
    <h1 class="title"><?php echo $title; ?></h1>
<?php endif; ?> 
```

我想知道是否有一个通用参数来包含所有视图列表页面，或者相反，只排除所有节点页面（注意：我使用的是 CCK，所以有很多内容类型）？

* * *

寻找其他可能性...

我知道我可以为我的内容类型创建不同的页面模板，但是我可以为我的所有 CCK 内容类型创建一个不同的页面模板吗？

这是我通过 template.php 获得添加单个内容类型模板的能力的代码：

```
function _phptemplate_variables($hook, $vars) {
  switch ($hook) {
    case 'page':  
      if ($vars['node'] && arg(2) != 'edit') {
        $vars['template_files'][] = 'page-'. $vars['node']->type;
      }
      break;
  }
  return $vars;
} 
```

干杯
史蒂夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T17:43:18.527

好的 - 我找到了自己的解决方案，不需要创建 20 多个页面模板。对于上面的示例，我在`!node->type`查询中添加了条件，因为视图不提供节点类型，然后通过站点确保在需要的页面视图级别禁用标题。

```
<?php if ($title && ((arg(2) == 'track') || (arg(2) == 'edit') 
  || (arg(0) == 'admin') || !$node->type)): ?>
    <h1 class="title"><?php echo $title; ?></h1>
<?php endif; ?> 
```

感谢收听 :-)
史蒂夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-17T08:12:58.707

如果其他人正在研究一些类似的问题，另一种在 node.tpl 文件中提供参数的方法将适用于通过视图（模块）显示节点时使用：

如果 ($page == 0)

对于单个节点的“常规”显示，随后的任何内容都将被忽略。这在 page.tpl 上不起作用，因此如果需要为通过 Views 生成的所有页面重新添加标题，可以将其添加到 views-view.tpl.php 文件中并添加到主题中。或者可以为某些类型的视图添加其他更具体的视图 tpl 文件。

# eclipse - 颠覆性：无法在标签文件夹中提交文件

> ID：374797
> 
> 赞同：10
> 
> 时间：2008-12-17T14:57:17.270
> 
> 标签：eclipse, svn, zend-studio, subversive

我正在使用 Zend Studio 6.1 for Eclipse，它与 Subversive 插件捆绑在一起。

我的回购布局是：

```
/trunk/
/branches/
/tags/ 
```

我的应用程序代码在：

```
/trunk/application 
```

我正在尝试在以下位置添加一些视图模板：

```
/trunk/application/views/tags/index.tpl 
```

但是 Subversive 不允许我提交该文件夹中的任何文件。它给我的信息是：

> “您要修改存储库上的标签。要继续吗？”

所以我说“不”。似乎将我的“标签”文件夹与 SVN 的标签概念混淆了。

我无法重命名文件夹，因为我使用的框架在控制器和视图之间强制执行严格的命名约定。我有一个 tagsController，所以我的视图必须在 /views/tags

我可以将控制器重命名为“标签”以外的名称，但这很糟糕，因为标签是标签，而不是 schmag ;)

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-17T15:00:28.823

对这个警告说“是”实际上很好。

版本控制的常见布局是有 3 个根文件夹：

> ```
> /trunk
> /tags
> /branches 
> ```

一旦发布了主干版本，主干的当前内容将被复制到标签中的文件夹（例如“2008 年 4 月版本 1.3”或其他内容）中。一般而言，不应修改此文件夹，因为它代表特定时间点的特定构建，因此如果您尝试更改其中的文件，Subversion 会警告您。

但是，在您的情况下，您有一个恰好被称为“标签”的文件夹，其中包含主干代码，而不是标记代码，因此对此警告说“是”并继续提交是完全正确的。

有关更多信息，请阅读 SVN 书籍，尤其是[标签](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.tags.html)和[推荐的存储库布局](http://svnbook.red-bean.com/en/1.5/svn.tour.importing.html#svn.tour.importing.layout)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:02:09.803

也许改变另一个插件？“标签”和“分支”在 svn 中是完全一样的，只是我们作为用户的逻辑视图使它们不同。您应该能够——即使 IMO 不是一个好主意——在这里提交。

这是我对 svn BTW 的抱怨之一，分支和标签是不同的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T17:03:34.270

Subversion 只是试图警告你，你可能不小心提交了一个标签——即一个标记版本的代码——在正常使用中你永远不会这样做。

在你的情况下，我相信你刚刚有一个名为 tags 的文件夹，你正在处理 taglib 类型的东西。您可能想将其称为不同的名称以防止出现警告，但在您的情况下听起来像是虚假的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T15:07:08.577

**主干**通常应该代表您的应用程序的当前工作副本，分支**用于**支持在应用程序的先前版本上工作（例如他们对 Firefox 所做的那样，当最后一个版本在trunk.**标签**仅用于标记应用程序的特定版本，这可以方便地检查代码在特定版本中的情况。

你为什么要更改标记的文件？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-31T20:16:47.427

我终于让它工作了。我只能假设这是 Zend Studio for Eclipse 的 Subversive 插件中的一个错误。

如果我尝试通过右键单击“PHP Explorer”中的文件来提交，它会失败。如果我通过“团队 -> 与存储库同步”“覆盖并提交”，它工作正常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T19:02:15.703

有关弹出警告的原因的详细说明，请参阅[此帖子](http://blog.codecentric.de/en/2009/03/subclipse-tagcommit/):-)

# .net - 如何获取任何版本的 Windows 的特定驱动器图标？

> ID：374799
> 
> 赞同：1
> 
> 时间：2008-12-17T14:58:20.000
> 
> 标签：.net, windows, winforms, icons

在 .NET WinForms 应用程序中，如何获取客户端可能运行的任何版本的 Windows 的特定驱动器图标（例如 C:\）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T15:06:26.847

我不知道它是否会起作用，但你可以试试[这个](http://www.codeguru.com/csharp/csharp/cs_misc/icons/article.php/c4261)，指向驱动器根。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T08:40:16.960

[SHGetFileInfo](http://msdn.microsoft.com/en-us/library/bb762179(VS.85).aspx)是操作系统公开文件系统中对象信息的方式。您如何从 .NET WinForms 应用程序调用它？那里我帮不了你。

# iis - IE6中的服务器证书

> ID：374817
> 
> 赞同：0
> 
> 时间：2008-12-17T15:04:33.793
> 
> 标签：iis, internet-explorer-6, certificate

我们有一个使用 Thawte 证书的电子商务网站，我们在 10 月份更新了我们的证书。如果您从 IE6 访问 https 页面，您会收到证书已过期的警告，如果您查看过期日期，它实际上是旧证书。现在，从 IE7 访问页面时根本不会发生这种情况。

当使用 IE6 从任何计算机访问页面时会发生这种情况，因此证书不可能在本地缓存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-17T17:08:09.830

是您的证书已过期，还是上游的 Thawte 证书？我的第一个猜测是具有 IE6 的计算机具有较旧的受信任证书列表，而对于 IE7，已下载了一个新的受信任证书列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T15:35:21.030

这是我们的证书已过期，但是我发现了问题。向 IE6 用户发送了一些仅用于跟踪脚本的代码，该代码从我们域下的不同子域下载了图像。此子域的证书尚未更新。不容易追踪，但一旦找到它，它就像 d'oh！

# svn - 如何在 CruiseControl.net 中配置 svn Task 以检测 subversion 外部变化

> ID：374818
> 
> 赞同：4
> 
> 时间：2008-12-17T15:04:38.707
> 
> 标签：svn, cruisecontrol.net

我在 subversion 中有一个 .net 项目，它与 Cruisecontrol.net 持续集成。

我使用 Svn 源代码控制 CCNET 任务。

.net 项目库目录，其中包含一组配置为 subversion 外部的可重用组件。

ProjectA\libraries {可重用组件目录} ProjectA\libraries\component1 ProjectA\libraries\component2 ProjectA\libraries\component3

projectA\Src { 源代码目录}

当 subversion 外部更改时，不会触发构建，因为它没有检测到外部文件夹中发生的更改。

当配置的组件作为外部组件发生更改时，如何使 subversion ccnet 任务立即构建。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-17T15:24:42.193

在 CruiseControl.NET 1.4 中，subversion 源代码控制块有一些新标志，其中之一是 CheckExternals 在您的配置中将其设置为 true，并且您的外部文件中的任何修改都应该触发构建。

```
<checkExternals>True</checkExternals>
<checkExternalsRecursive>True</checkExternalsRecursive> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T15:09:52.237

我只是设置了一个轮询间隔来检查 mod - 使用 ccnet.config 中的触发器节点它是一个间隔触发器。我还使用 IfModificationExists 属性（这是默认值）告诉它仅在修改存在（svn 源已更改）时才构建

如果您愿意，您可以将该间隔设置得非常低，但我不确定有一种方法可以将通知从 ccnet 接收到的 SVN 中推送出去。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T17:59:20.587

感谢亚历克斯的回答。

我们还开始使用不适用于 CCNET 1.4 版本的相对外部 URL，

它在尝试获取修改列表时失败。

我还可以看到此 CheckExternals 代码的另一个问题。

（即）当从不同的 svn 存储库配置外部时。

并且只更改了外部库，那么历史命令也会失败。

# perl - 如何在 Perl Moose OOP 中动态调用对象？

> ID：374824
> 
> 赞同：3
> 
> 时间：2008-12-17T15:06:10.247
> 
> 标签：perl, moose

这是经典的对象模型：

```
 class ViewBase
 {
  void DoSomethingForView() { } //May be virtual
 }

 class View1 : ViewBase //(derived class from ViewBase)
 {
    void DoSomethingForView() { }
    void DoSomethingForView1Special() { }
 }

 class View2: ViewBase //(another derived class from ViewBase)
 {
    void DoSomethingForView2Special() { }
 }

 class Application
 {
    void Print() { }
    void DoSomething() { }

     //Do some magic to create a view object (View1 or View2) and return

    //Something which I don't know to describe. Its like dynamically 
    //returning object of View1 or View2 at runtime
  } 
```

我想将其转换为 Perl Moose 类模型。

以便，

我将调用视图方法，例如

```
void Main()
{

  App = new Application();

  App->View1->DoSomethingForView(); 
  App->View1->DoSomethingForView1Special();
  App->View2->DoSomethingForView(); 
  App->View2->DoSomethingForView2Special(); 
```

}

我不知道要调用哪个视图。但在运行时，必须创建 View1/View2 实例并调用 DoSomethingForView()。

上面的代码并不完全是 Perl。如何在 Perl 中翻译和实现这一点。

Application 对象应该有 View 对象，但我们在编译时不知道视图的类型。我们有一个测试应用程序，在 Perl 中开发。

您可以想象 Application 是一个 GUI 应用程序，而 View 是您在应用程序窗口中看到的内容。用户可以选择任何视图。

我对我的英语感到抱歉。如果我需要提供更多文字，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T22:20:38.593

因此，这为您提供了 Perl 中大致等效的语法。但是，它并不能帮助您解决一些相互矛盾的标准。

请注意以下事项：

*   class ABC {...} 被 perl 语法包 ABC 替代；
*   大写的驼峰式方法名称被转换为正确的“蛇形”perl。
*   App 已转为 sigil-ed $App

这已经针对 Moose v62、Perl 5.10 进行了测试。最后一行的第二个将失败，因为`do_something_for_view`不是由`View2`类实现的。正如您所调用的`view1`或`view2`具体而言，我没有看到您似乎表示的应用程序是多态性。

```
package ViewBase;

sub do_something_for_view { 
    Carp::croak "ViewBase::do_something_for_view is ABSTRACT!"; 
}

package View1;
use Moose;
extends 'ViewBase';

sub do_something_for_view { print "Doing something for View1.\n"; }
sub do_something_for_view1_special { print "Doing something SPECIAL for View1.\n"; }

package View2;
use Moose;
extends 'ViewBase';

sub do_something_for_view2_special() { print "Doing something SPECIAL for View2.\n"; }

package Application;
use Moose;

has view1 => ( 
      is      => 'rw'       # read/write
    , isa     => 'View1'
    , lazy    => 1
    , default => sub { View1->new(); } 
    );

has view2 => ( 
      is      => 'rw'       # read/write
    , isa     => 'View2'
    , lazy    => 1
    , default => sub { View2->new(); } 
    );

sub print {}
sub do_something {}

#void Main()
#{

package main;

  #App = new Application();
my $App = Application->new();

  #App->View1->DoSomethingForView(); 
$App->view1->do_something_for_view();
  #App->View1->DoSomethingForView1Special();
$App->view1->do_something_for_view1_special();
  #App->View2->DoSomethingForView(); 
$App->view2->do_something_for_view();
  #App->View2->DoSomethingForView2Special();
$App->view2->do_something_for_view2_special();

#} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-13T13:27:50.833

如果您使用[MooseX::Declare](http://search.cpan.org/perldoc?MooseX::Declare)，您可能可以将语法简化为与您最初编写的内容非常相似的内容，例如，您的声明将变成：

```
use MooseX::Declare;
 class ViewBase {
  method DoSomethingForView() { } #May be virtual
 }

 class View1 extends ViewBase {
    method DoSomethingForView() { }
    method DoSomethingForView1Special() { }
 }

 class View2 extends ViewBase {
    method DoSomethingForView2Special() { }
 }

 class Application {
    method Print() { }
    method DoSomething() { }

     #Do some magic to create a view object (View1 or View2) and return

    #Something which I don't know to describe. Its like dynamically 
    #returning object of View1 or View2 at runtime
  } 
```

# c++ - (QT/kdelib) 如何知道KTerminalInterface 中一个命令的结束？

> ID：374832
> 
> 赞同：1
> 
> 时间：2008-12-17T15:08:50.227
> 
> 标签：c++, qt, kde, kparts

我的 qt/kdelib 应用程序中有一个 KTerminalInterface（来自 kparts），我在其中运行一个命令。

问题是：我怎么知道程序是否被终止？我需要知道它，因为最后我必须重置一些变量。

有没有人有类似的问题？！​​？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T11:31:43.673

一旦通过 KDE 4 中的 TerminalInterface 启动，就不可能与进程通信，因为 KonsolePart（它实现了 TerminalInterface）不再具有 processExited() 或 receivedData() 信号。在 KDE 4 中，KonsolePart 用于交互式终端会话，而不是供您的应用程序使用。

在 KDE 4 中，使用[KProcess](http://api.kde.org/4.x-api/kdelibs-apidocs/kdecore/html/classKProcess.html)从您的应用程序中生成一个外部命令，与它通信，并检测它何时终止。请参阅其 API 的[QProcess](http://doc.trolltech.com/4.4/qprocess.html)部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T01:57:40.120

您也许可以使用[os.waitpid](http://docs.python.org/library/os.html#os.waitpid) (-1) 等待子进程（如果您不能拥有主要的一个块，则使用另一个线程）。

# java - 如何在网络服务器模式下启动 derby 并仍然获得嵌入式连接？

> ID：374833
> 
> 赞同：6
> 
> 时间：2008-12-17T15:08:50.320
> 
> 标签：java, derby

我只想知道如何在网络服务器模式下启动 derby 并且仍然能够获得嵌入式连接？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-25T16:49:07.370

您需要以“嵌入式服务器模式”启动 Derby。如果您已经在嵌入式模式下使用 Derby，则可以通过在类路径中提供必要的文件，然后在启动应用程序时指定一些命令行参数来启用它。

首先确保以下 jar 在您的应用程序的运行时类路径中。

```
 derby.jar derbynet.jar 
```

然后将以下命令行选项添加到用于启动应用程序的 Java 命令中。如果类文件丢失，这些选项将无效。

```
 -Dderby.drda.startNetworkServer=true 
    -Dderby.drda.portNumber=8011 
```

我在 Tomcat 托管的 servlet 中运行 Derby，因此我将这些选项添加到 catalina.bat 文件中。

启动您的应用程序并检查打开的网络套接字列表。

```
 netstat -an | find "8011" 
```

您现在应该看到 Derby 正在侦听 8011 上的连接。现在可以使用 Derby 的客户端驱动程序 (derbyclient.jar) 连接到数据库。[http://docs.oracle.com/javadb/10.3.3.0/adminguide/radminembeddedserverex.html](http://docs.oracle.com/javadb/10.3.3.0/adminguide/radminembeddedserverex.html)上的说明很好地涵盖了这部分。

有人暗示不鼓励在这种模式下运行 Derby。我不相信会是这样。您的应用程序将继续使用嵌入式驱动程序访问数据库，而其他软件现在可以使用客户端驱动程序进行访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T15:22:26.190

[嵌入式服务器模式](http://publib.boulder.ibm.com/infocenter/cscv/v10r1/index.jsp?topic=/com.ibm.cloudscape.doc/radminembeddedserverex.html)听起来像您所要求的。它允许您在启动嵌入式数据库时启动网络服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-17T23:04:46.767

您想在网络服务器模式下启动 derby 并获取嵌入式驱动程序，这听起来很矛盾。即使这可能是可能的，也绝对不鼓励这样做。您应该决定是要使用 DRDA 在网络模式下使用 Apache Derby，还是作为嵌入式驱动程序使用 Apache Derby，并坚持这个决定。

在这里您可以找到有关如何使用网络驱动程序的教程：http: [//db.apache.org/derby/papers/DerbyTut/ns_intro.html](http://db.apache.org/derby/papers/DerbyTut/ns_intro.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-04T04:37:51.810

如果我错了，有人纠正我，两者都将在单独的端口上运行。因此，您可以使用正确的 connectionName 连接到所需的连接名称，对吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-28T09:07:49.797

@pawelocue: Sorry, but this is wrong. Using the embedded server mode is perfectly alright and sometimes very useful. It is definitely not discouraged.

# coldfusion - 如何根据 ColdFusion 中的推荐重定向

> ID：374841
> 
> 赞同：1
> 
> 时间：2008-12-17T15:12:17.693
> 
> 标签：coldfusion

我有一个需要更改的coldfusion 网站。对这种环境一无所知或经验（我知道 ASP.NET）。我需要做的就是根据页面的引用值（URL）编写一个条件，并在某些情况下重定向到另一个页面。谁能给我一个执行此操作的语法示例？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T15:45:09.593

所有其他示例都可以使用...此外，如果您希望根据来自外部站点的推荐进行重定向，您可能需要检查 CGI.HTTP_REFERER。查看 CGI 范围以了解其他几个选项。

```
<cfif reFindNoCase('[myRegex]',cgi.http_referer)>
    <cflocation url="my_new_url">
</cfif> 
```

...我的示例使用正则表达式搜索 (`reFind()`或`reFindNoCase()`) 来检查引用 URL ...但您也可以根据您要查找的内容将其`/`作为带有分隔符 (使用) 的列表进行检查。`listContainsNoCase()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T15:40:59.193

假设您所基于的 URL 变量称为 goOn ( [http://yoursite.com?goOn=yes](http://yoursite.com?goOn=yes) )，那么以下代码将起作用：

```
<cfif structKeyExists(url, "goOn") AND url.goOn eq "yes">
    <cflocation url="the_new_url" addtoken="false">
</cfif> 
```

cflocation 之后什么都不会发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T15:28:27.737

有一段时间没有进行冷融合，但是：

```
<cfif some_condition_based_on_your_url>
  <cflocation url="http://where_your_referrals_go">
</cfif>
<!--- continue processing for non-redirects ---> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T15:33:59.100

ColdFusion 中有一个 CGI 变量范围，用于保存有关传入请求的信息。尝试以下操作：

```
<cfif CGI.SCRIPT_NAME EQ 'index.cfm'>
    <cflocation url="where you want it to redirect" />
</cfif> 
```

要查看 CGI 范围内的其他可用内容，请查看以下内容：http: [//livedocs.adobe.com/coldfusion/8/htmldocs/Expressions_8.html#2679705](http://livedocs.adobe.com/coldfusion/8/htmldocs/Expressions_8.html#2679705)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-15T18:12:08.330

动态版本。

```
<cfif isdefined("somecondition")>
    <cfset urlDestination = "someurl">
<cfelseif isdefined("somecondition")>
    <cfset urlDestination = "someurl">
.
.
.
<cfelse>
    <cfset urlDestination = "someurl">
</cfif>

<cflocation url = urlDestination> 
```

# php - 使 PHP 脚本超时，这样它们就不会杀死我的服务器

> ID：374843
> 
> 赞同：0
> 
> 时间：2008-12-17T15:12:34.383
> 
> 标签：php, lighttpd

**原因可能是我的磁盘空间不足，导致一切工作异常。无论如何我都会留下这个问题，以防其他人有类似的问题。**

我有一些 PHP 脚本已经挂了很长时间，但显然它们并没有真正使用太多 CPU 时间，因为它们不会被杀死。他们仍然使 lighttpd 无法生成更多 PHP 进程，因为它们的最大数量已经生成。

我知道 set_time_limit 可以用作函数或放入 php.ini 以控制脚本可以运行的最大 CPU 时间。我想要的是限制我的网络服务器（lighttpd）运行的所有 PHP 脚本，而不是 CPU 时间，而是时钟时间。

万一这很重要，这是我的 lighttpd 配置文件中的 PHP 部分。

```
fastcgi.server = (".php" => ((
 "bin-path" => "/opt/local/bin/php5-cgi",
 "socket" => "/tmp/php.socket" + var.PID,
 "min-procs" => 16,
 "max-procs" => 16,
 "idle-timeout" => 15,
))) 
```

这是我来自 lighttpd 的服务器状态。您可以看到 PHP 运行的时间比我预想的要长得多，并导致服务器阻塞。奇怪的是，PHP procs 似乎也比我的 max-procs 多。

```
legend
. = connect, C = close, E = hard error
r = read, R = read-POST, W = write, h = handle-request
q = request-start,  Q = request-end
s = response-start, S = response-end
388 connections
hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
hhhrhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
hhhhhhhhhhhhhrhhhhhhhhhhhhhhhhhhhhhhhhrhhhhhhhhhhh
hhhhrhhhhhhhhhhrhrhhhrrhrhhhhhrhhhrhhhhhhrhhhrrrhr
rrhrrrhrhhhhrrhrrhhrrhrrhrrrrrrrrrrrrh

Connections
Client IP:  Read:   Written:    State:  Time:   Host:   URI:    File:
204.16.33.51    0/0 0/0 handle-req  1361    ... (a PHP script)
204.16.33.46    0/0 0/0 handle-req  1420    ... (another PHP script)
... gazillion lines removed ... 
```

任何可以帮助我设置我不必经常照看的配置的想法将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T15:33:29.397

我不确定你可以在 lighttpd 中做到这一点。但是，您可以设置一个“微调器”脚本来定期检查挂起的进程并终止它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:40:36.480

您最好编辑 php.ini 文件并在那里设置权限。

```
;;;;;;;;;;;;;;;;;;;
; Resource Limits ;
;;;;;;;;;;;;;;;;;;;

max_execution_time = 30     ; Maximum execution time of each script, in seconds
max_input_time = 60 ; Maximum amount of time each script may spend parsing request data
memory_limit = 32M      ; Maximum amount of memory a script may consume (8MB) 
```

# sql - 如何仅选择表中的最新条目？

> ID：374846
> 
> 赞同：0
> 
> 时间：2008-12-17T15:14:12.667
> 
> 标签：sql, sql-server

我有一个 3 表 SQLServer 数据库。

```
Project
ProjectID
ProjectName

Thing
ThingID
ThingName

ProjectThingLink
ProjectID
ThingID
CreatedDate 
```

当事物归属于项目时，项目将被放入 ProjectThingLink 表中。事物可以在项目之间移动。CreatedDate 也用于了解上次移动的项目。

我正在尝试创建一个列表，其中列出了事物当前与之链接的所有项目，但我的大脑正在失败。

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T15:19:14.433

```
select p.projectName, t.ThingName
from projects p
join projectThingLink l on l.projectId = p.projectId
join thing t on t.thingId = l.thingId
where l.createdDate =
( select max(l2.createdDate)
  from projectThingLink l2
  where l2.thingId = l.thingId
); 
```

注意：评论后更正

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-17T15:51:17.270

这几乎总是会给你比子查询方法更好的性能。您基本上是在寻找没有任何其他行的行，而不是寻找日期最大的行：

```
SELECT
     P.ProjectID,
     P.ProjectName,
     T.ThingID,
     T.ThingName
FROM
     dbo.Projects P
INNER JOIN dbo.ProjectThingLinks PTL1 ON
     PTL1.ProjectID = P.ProjectID
LEFT OUTER JOIN dbo.ProjectThingLinks PTL2 ON
     PTL2.ProjectID = ThingID = PTL1.ThingID AND
     PTL2.CreatedDate > PTL1.CreatedDate
INNER JOIN dbo.Things T ON
     T.ThingID = PTL1.ThingID
WHERE
     PTL2.ThingID IS NULL 
```

一旦您决定了处理具有相同 CreatedDate 值的两行的业务规则，您可能需要调整查询。

此外，作为旁注，名为“事物”的表通常是您的数据库设计存在问题的好兆头。表格应该代表不同的现实生活实体。这种普遍性通常会导致将来出现问题。如果这些是资源，那么它们可能会共享某些属性，而不仅仅是名称。也许您的情况是一个非常特殊的情况，但很可能不是。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T15:30:59.247

试试这个：

```
select p.ProjectID, p.Name, t.ThingID, t.ThingName, l.CreatedDate 
from Project p
inner join (
    select ProjectID, max(CreatedDate) as CreatedDate
    from ProjectThingLink
    group by ProjectID
) lm on p.ProjectID = l.ProjectID
inner join ProjectThingLink l on lm.ProjectID = l.ProjectID and lm.CreatedDate = l.CreatedDate
inner joing Thing t on l.ThingID = t.ThingID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T15:20:45.693

你可以简单地做

```
SELECT Project.projectId, Project.ProjectName, ThingName
FROM Project  INNER JOIN ProjectThingLink
 ON Project.ProjectID = ProjectThingLink.ProjectID INNER JOIN
                     Thing ON ProjectThingLink.ThingID = Thing.ThingID 
```

Will 将获得每个项目的列表，其中包含与它相关的所有内容，如下所示：

1 | 项目1 | 某物

1 | 项目1 | 这东西

2 | 项目2 | 那个东西

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T15:25:47.760

```
select * from project
inner join (select projectid,
                   max(createdate) as maxdate 
            from projectThingLink 
            group by projectid) as a
on projectid = a.projectid  and createDate = a.maxDate 
```

# wpf - 当数据更改时，如何阻止列表框中的展开器折叠？

> ID：374855
> 
> 赞同：0
> 
> 时间：2008-12-17T15:15:55.907
> 
> 标签：wpf, listbox, expander

我有一个带有项目列表框的屏幕。项目模板包含一个扩展器控件，其中一些数据位于标题中，一些数据位于扩展器的内容部分。

ListBox ItemTemplate 的数据模板与此类似：

```
<DataTemplate x:Key="MyTypeTemplate" DataType="{x:Type MyType}">
  <Expander DataContext="{Binding}">
    <Expander.Header>
      <Canvas>
        <TextBox Text="{Binding MyProperty}"/>
      </Canvas>
    </Expander.Header>
    <Canvas>
      <TextBox Text={Binding MyDetailedProperty}"/>
    </Canvas>
  </Expander>
</DataTemplate> 
```

每当这些属性更改时，无论是“MyProperty”还是“MyDetailedProperty”更改，扩展器控件都会折叠。我相信这与在数据更改时重新创建 Expander 项目有关。

作为附加数据项，绑定到列表框的列表实现了 IBindingList，因为它来自为 .NET 2.0 创建的库。由于时间限制，我无法使用 ObservableCollection 重新创建列表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-19T16:39:20.397

我最终将我的模型对象包装在一个视图对象中，该对象添加了一个 IsExpandable 属性，我可以将其绑定到 Expanded IsExpanded 属性，然后公开数据。

这不是通用解决方案，但它解决了我的直接问题。我看到的尚未探索的可能问题是附加的 PropertyChanged 和 ListChanged 事件是否会导致我的 UI 对象出现内存泄漏问题，但在我的情况下，每个对象应该只创建一次。

此外，不支持集合更改中添加和删除之外的事件，但在我的情况下，我没有触发任何其他事件，因此我可以安全地忽略它们。

```
public class ExpandableItem<T> : INotifyPropertyChanged 
    where T: INotifyPropertyChanged
{
    private bool m_isExpanded;
    private readonly T m_data;

    public ExpandableItem(T data)
    {
        m_data = data;

        m_data.PropertyChanged += 
          delegate 
          { 
            PropertyChanged(this, new PropertyChangedEventArgs("Data")); 
          };
    }

    public bool IsExpanded
    {
        get { return m_isExpanded; }
        set
        {
            if (value != m_isExpanded)
            {
                m_isExpanded = value;
                PropertyChanged(this, new PropertyChangedEventArgs("IsExpanded"));
            }
        }
    }

    public T Data
    {
        get
        {
            return m_data;
        }

    }

    public event PropertyChangedEventHandler PropertyChanged = delegate { };
} 

public class ExpandableList<TObject,TList> :
  ObservableCollection<ExpandableItem<TObject>>
  where TList : ObservableCollection<TObject>
  where TObject : INotifyPropertyChanged
{
    readonly TList m_list;

    public ExpandableList(TList list) 
        : base(list.Select(obj=>new ExpandableItem<TObject>(obj)))
    {
        list.CollectionChanged += OnListChanged;
        m_list = list;
    }

    public TList Data { get { return m_list; } }

    private void OnListChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        if (e.Action == NotifyCollectionChangedAction.Add)
        {
            Insert(e.NewStartingIndex, e.NewItems[0]);
        }
        if (e.Action == NotifyCollectionChangedAction.Remove)
        {
            RemoveAt(e.OldStartingIndex);
        }
    }
} 
```

# java - 如何在 JSP 中遍历 Hashtable

> ID：374865
> 
> 赞同：1
> 
> 时间：2008-12-17T15:17:53.843
> 
> 标签：java, jsp, hashtable

我正在用 JAVA 做一个 stuf，因为它工作正常.. 现在我需要它在使用 JSP 的浏览器中显示，以下是我的代码..

```
Hashtable<String, Hashtable<String, Integer>> hash =
            categoryCountManager.getFunctionWithSubFunctionCount(1L);

        setCategoryDetails(categoryCountManager.getFunctionWithSubFunctionCount(1L));

        //count.setFunction()
        System.out.println("Hash Size==>"+hash.size());  

        Set<String> functions = hash.keySet();

        for(String fun : functions){
            System.out.println("***************************");                      
            System.out.println(fun);
            System.out.println("***************************");
            Hashtable<String, Integer> obj = hash.get(fun);

            Vector<String> v = new Vector<String>(obj.keySet());
            Collections.sort(v);

            for(String str : v){                            
                System.out.println("#"+str+"-"+obj.get(str));
                }

            } 
```

任何建议高度赞赏..

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-17T15:24:59.570

```
for (Entry<String, Hashtable<String, Integer>> functionEntry : hash.entrySet()) {
    System.out.println("***************************");                      
    System.out.println(fun);
    System.out.println("***************************");
    for (Entry<String, Integer> subfunction : functionEntry.getValue().entrySet()) {
        System.out.println("#" + subfunction.getKey() + "-" + subfunction.getValue());
    }
} 
```

但是，这不会对您的子功能进行排序。

# rest - 我可以更改浏览器发送的 HTTP 请求的标头吗？

> ID：374885
> 
> 赞同：79
> 
> 时间：2008-12-17T15:25:49.380
> 
> 标签：rest, browser, http-headers

我正在研究一种宁静的设计，并希望尽可能多地使用 HTTP 方法 ( `POST`, `GET`, ...) 和 HTTP 标头。我已经发现浏览器不支持 HTTP`PUT`方法`DELETE`。

现在我正在寻找相同资源的不同表示，并希望通过更改`Accept`请求的标头来做到这一点。根据此`Accept`标头，服务器可以为同一资源提供不同的视图。

问题是我没有找到告诉浏览器更改此标头的方法。

该`<a..>`标签有一个[type 属性](http://www.w3.org/TR/html401/struct/links.html#adef-type-A)，可以有一个 mime 类型，看起来是一个不错的候选者，但标题仍然是浏览器的默认值（在 Firefox 中，它可以`about:config`使用`network.http.accept.default`键进行更改）。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-29T17:24:28.163

我部分不同意 Milan 将请求的表示嵌入 URI 的建议。

如果可能的话，URI 应该**只**用于寻址资源而**不是**隧道 HTTP 方法/动词。最终，如果仅创建 (POST) 或更新 (PUT) 无法达到目的，则可以将特定的业务操作（编辑、锁定等）嵌入 URI：

```
发布 http://shonzilla.com/orders/08/165；编辑

```

在请求 URI 中的特定表示的情况下，您将需要破坏您的 URI 设计，最终使其变得更丑陋，在同一个地方（即 URI）混合两个不同的 REST 概念，并使其更难在服务器端通用处理请求。米兰的建议和许多人都在做同样的事情，包括。Flickr，正是这个。

相反，更 RESTful 的方法是**使用单独的位置来编码首选表示**，方法是使用`Accept`HTTP 标头进行内容协商，其中客户端告诉服务器它可以处理/处理哪些内容类型，服务器尝试满足客户端的请求。这种方法是[HTTP 1.1 标准](http://www.w3.org/Protocols/rfc2616/rfc2616-sec12.html)的一部分，软件兼容并受 Web 浏览器支持。

比较一下：

```
获取 /orders/08/165.xml HTTP/1.1
或者
获取 /orders/08/165&format=xml HTTP/1.1

```

对此：

```
GET /orders/08/165 HTTP/1.1
接受：application/xml

```

在网络浏览器中，您可以使用对象`setRequestHeader`方法请求任何内容类型`XMLHttpRequest`。例如：

```
函数 getOrder(year, yearlyOrderId, contentType) {
 var client = new XMLHttpRequest();
 client.open("GET", "/order/" + year + "/" + yearlyOrderId);
 client.setRequestHeader("接受", contentType);
 client.send(orderDetails);
}

```

总而言之：地址，即资源的 URI 应该独立于其表示，`XMLHttpRequest.setRequestHeader`方法允许您使用`Accept`HTTP 标头请求任何表示。

干杯!
松兹拉

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-09-11T16:01:35.133

我正在寻找完全相同的事情（RESTful Web 服务），我偶然发现了这个 firefox 插件，它可以让您修改请求的接受标头（实际上是任何请求标头）。它完美地工作。

[https://addons.mozilla.org/en-US/firefox/addon/967/](https://addons.mozilla.org/en-US/firefox/addon/967/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-17T15:44:45.007

我认为不可能以您尝试的方式进行。

通常通过在资源名称中添加扩展名来指示接受的数据格式。所以，如果你有类似的资源

```
/resources/resource 
```

并`GET /resources/resource`返回它的 HTML 表示，以表明您想要它的 XML 表示，您可以使用以下模式：

```
/resources/resource.xml 
```

那么，您必须在服务器端执行公认的内容类型确定魔法。

或者按照 James 的建议使用 Javascript。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-07-25T12:22:23.130

[谷歌浏览器的ModHeader](https://mod-header.appspot.com/)扩展，也是一个不错的选择。您可以只设置所需的标题，然后在浏览器中输入 URL，当您点击 url 时，它将自动从扩展中获取标题。唯一的问题是，它会为您将点击的每个 URL 发送标头，因此您必须在使用后禁用或删除它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T15:36:47.160

使用一些javascript！

```
xmlhttp=新的 XMLHttpRequest();
xmlhttp.open('PUT',http://www.mydomain.org/documents/standards/browsers/supportlist)
xmlhttp.send("页面内容放在这里");

```

# java - Spring、Hibernate 和 JPA：在 entitymanager 上调用 persist 似乎并没有提交到数据库

> ID：374886
> 
> 赞同：19
> 
> 时间：2008-12-17T15:26:29.583
> 
> 标签：java, hibernate, spring, jpa, persistence

我正在尝试使用 Hibernate 和 JPA 设置 Spring，但是在尝试持久化对象时，似乎没有将任何内容添加到数据库中。

我正在使用以下内容：

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="url" value="${jdbc.url}"/>
    <property name="driverClassName" value="${jdbc.driverClassName}"/>
    <property name="username" value="${jdbc.username}"/>
    <property name="password" value="${jdbc.password}"/>
</bean>

<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="persistenceUnitName" value="BankingWeb" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="generateDdl" value="true" />
            <property name="showSql" value="true" />
            <property name="databasePlatform" value="${hibernate.dialect}" />
        </bean>
    </property>
</bean>

<tx:annotation-driven/>

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory"/>
</bean>

<bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" />

<bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor"/>

<bean name="accountManager" class="ssel.banking.dao.jpa.AccountManager" />
<bean name="userManager" class="ssel.banking.dao.jpa.UserManager" /> 
```

在 AccountManager 中，我正在做：

```
@Repository
public class AccountManager implements IAccountManager {

    @PersistenceContext private EntityManager em;

    /* -- 8< -- Query methods omitted -- 8< -- */

    public Account storeAccount(Account ac) {
    ac = em.merge(ac);
        em.persist(ac);
        return ac;
    }
} 
```

ac 来自哪里：

```
 Account ac = new Account();
    ac.setId(mostRecent.getId()+1);
    ac.setUser(user);
    ac.setName(accName);
    ac.setDate(new Date());
    ac.setValue(0);
    ac = accountManager.storeAccount(ac);
    return ac; 
```

有没有人可以指出我做错了什么？持久调用返回而不抛出异常。如果之后我这样做`em.contains(ac)`，这将返回 true。

如果有人需要，以下是 Account 的定义方式：

```
@SuppressWarnings("serial")
@Entity
@NamedQueries({
        @NamedQuery(name = "Account.AllAccounts", query = "SELECT a FROM Account a"),
        @NamedQuery(name = "Account.Accounts4User", query = "SELECT a FROM Account a WHERE user=:user"), 
        @NamedQuery(name = "Account.Account4Name", query = "SELECT a FROM Account a WHERE name=:name"),
        @NamedQuery(name = "Account.MaxId", query = "SELECT MAX(a.id) FROM Account a"),
        @NamedQuery(name = "Account.Account4Id", query = "SELECT a FROM Account a WHERE id=:id"),
    })
public class Account extends AbstractNamedDomain {
    @Temporal(TemporalType.DATE)
    @Column(name = "xdate")
    private Date date;

    private double value;

    @ManyToOne(cascade={CascadeType.PERSIST, CascadeType.MERGE})
    @JoinColumn(name="userid")
    private User user;

    public User getUser() {
        return user;
    }

    public void setUser(User user) {
        this.user = user;
    }

    @OneToMany(cascade={CascadeType.PERSIST, CascadeType.MERGE}, fetch=FetchType.EAGER)
    @OrderBy("date")
    private List<AccountActivity> accountActivity = new ArrayList<AccountActivity>();

    public List<AccountActivity> getAccountActivity() {
        return accountActivity;
    }

    public void setAccountActivity(List<AccountActivity> accountActivity) {
        this.accountActivity = accountActivity;
    }

    public Date getDate() {
        return date;
    }

    public void setDate(Date date) {
        this.date = date;
    }

    public double getValue() {
        return value;
    }

    public void setValue(double value) {
        this.value = value;
    }

    public void addAccountActivity(AccountActivity activity) {
        // Make sure ordering is maintained, JPA only does this on loading
        int i = 0;
        while (i < getAccountActivity().size()) {
            if (getAccountActivity().get(i).getDate().compareTo(activity.getDate()) <= 0)
                break;
            i++;
        }
        getAccountActivity().add(i, activity);
    }
}

@MappedSuperclass public abstract class AbstractNamedDomain extends AbstractDomain {

    private String name;

    public AbstractNamedDomain() {

    }

    public AbstractNamedDomain(String name) {

        this.name = name;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}

@MappedSuperclass public abstract class AbstractDomain implements Serializable {

    @Id @GeneratedValue
    private long id = NEW_ID;

    public static long NEW_ID = -1;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id; 
    }

    public boolean isNew() {

        return id==NEW_ID;
    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-17T15:56:19.117

多亏了 eric 和 Juan Manuel 的回答，我才发现交易没有提交。

将 @Transactional 添加到 storeAccount 方法就可以了！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-01T23:43:12.230

我实际上遇到了另一种可能发生这种情况的方式。

在注入的 EntityManager 中，如果您像这样指定 persistence.xml，则不会发生更新：

`<persistence-unit name="primary" transaction-type="RESOURCE_LOCAL">`

您需要删除事务类型属性并使用默认值 JTA。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T15:34:19.927

可能您使事务保持活动状态，并且在其他运行支持活动事务的方法结束之前它不会调用“提交”（所有“投票”用于提交，没有“投票”用于回滚。）

如果您确定要保留的实体没问题，您可以这样做：

```
@TransactionManagement(TransactionManagementType.BEAN)
public class AccountManager implements IAccountManager { ..} 
```

并管理您的实体持久性添加：

```
@Resource
private SessionContext sessionContext;

public Account storeAccount(Account ac) {
    sessionContext.getUserTransaction().begin();
    ac = em.merge(ac);
    em.persist(ac);
    sessionContext.getUserTransaction().commit();
    return ac;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T03:31:07.663

您不需要显式调用persist 方法。合并操作将在提交时将更改写入数据库。

# visual-studio-2008 - 无法正确重新添加服务参考

> ID：374890
> 
> 赞同：0
> 
> 时间：2008-12-17T15:27:57.957
> 
> 标签：visual-studio-2008, wcf, service-reference

我已经在服务器上启动并运行了 WCF 服务。我们有一个代理类，我们向其中添加所有服务引用，我尝试在那里添加我的服务引用。但是，它并没有公开所有方法，特别是接口，允许我创建它的实例（这是 VS 2008）。但是，当我创建一个新项目并添加服务引用时，它会正确添加所有接口。

关于如何强制原始项目正确重新添加项目的任何想法？内存中有没有被清除的东西？我试过删除引用、重建、关闭和重新打开项目，但它仍然以同样的方式出现。

我也尝试过删除该项目并重新创建它，但也没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T15:07:30.623

问题已解决。事实证明，如果您不将所有必要的引用添加到项目中，那么需要它们的引用将不会出现。原来我们需要添加 System.Drawing 作为参考，然后解决方案添加得很好。我希望 MS 对此有一些反馈，但是如果将来有人遇到类似的事情，请记住，您需要添加所有引用...

# closures - 闭包和柯里化的区别和可能的相似之处是什么？

> ID：374897
> 
> 赞同：8
> 
> 时间：2008-12-17T15:29:34.757
> 
> 标签：closures, currying

我已经阅读了一些关于闭包和柯里化的帖子，但我觉得我没有找到答案。那么闭包和柯里化的区别和相似之处是什么？谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T16:05:11.330

*柯里化*首先是一个数学概念。只是观察到，对于任何*n*元函数*f: S [0] ×...S [n] → R ，您可以使用**n-1 个*参数定义一个新函数*fprime*（刚刚发现一个降价错误！），其中第一个参数被替换由一个常数。所以，如果你有一个函数，你可以定义一个新函数为 *`add(a,b)``add1(b)`*

 *`add1(b) ::= add(1, b)`

...阅读“::=”为“被定义为”。

*闭包*更像是一个编程概念。（当然，编程中的一切都是一个数学概念，但是闭包因为编程而变得有趣。）当你构造一个闭包时，你绑定了一个或多个变量；您正在创建一段代码，其中包含一些与之相关的变量。

关系是您可以使用闭包来实现柯里化：您可以`add1`通过创建一个第一个参数绑定到 1 的闭包来构建上面的函数。

# java - IntelliJ IDEA 可以为同一个项目的文件打开多个编辑器窗口吗？

> ID：374900
> 
> 赞同：18
> 
> 时间：2008-12-17T15:30:24.160
> 
> 标签：java, ide, intellij-idea

我可以水平或垂直拆分编辑器窗格，但似乎无法在两个单独的物理窗口中查看代码。我知道 Idea 可以在单独的窗口中打开多个**项目**，但我希望能够对**单个**项目中的两个文件执行此操作。

一个答案建议取消固定选项卡，但我无法完成这项工作（如果这很重要，我在 Mac OSX 上。）

这似乎是当今多头工作站世界的一个基本特征。在迁移到 IDE 之前，我经常使用旧的 Emacs 进行此操作。是否有一些我不知道的技巧来实现这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-12-16T02:58:09.197

现在这在 IDEA X 中是可能的。希望您仍然是 IDEA 用户并且可以利用这一点:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-22T12:36:30.637

不幸的是，没有办法（从 IDEA 8.0.1 开始）做你所要求的。正如您所指出的，您可以拆分编辑器窗格，但每个 IDEA 项目始终只有一个编辑器。

更新：截至 IDEA 10（目前最新的是 10.5），答案是肯定的，你可以 :-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-19T02:19:51.003

我通过在 vi 中打开一个源文件，在第二个头监视器上解决这个限制。然后在 Idea（实际上是 Pycharm）中工作主文件。

更新：即使使用 pycharm 内置的功能，我仍然使用 vi。效果更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-22T21:33:27.787

根据@9000 的评论，编辑器选项卡可以通过将选项卡拖动到 IDEA 之外变成一个新窗口。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-01-19T16:31:14.200

是的 - 使用[IDEA X](http://www.jetbrains.com/idea/training/demos/detachable_tabs/index.html)，终于可以打开多个编辑器窗口。

# sugarcrm - SugarCRM：如何在“将潜在客户转换为联系人”表单上填写“名字”和“称呼”必填字段？

> ID：374906
> 
> 赞同：3
> 
> 时间：2008-12-17T15:32:11.630
> 
> 标签：sugarcrm

我们使用 SugarCRM 的定制安装，我需要更改“将潜在客户转换为联系人”表单。在表单上，​​只有“姓氏”被标记为必填，但如果用户没有输入称呼或名字，Sugar 将在插入时抛出 SQL 错误（因为称呼和名字是联系人的必填字段）。

我尝试将此行添加到“modules/Contacts/metadata/editviewdefs.php”和“modules/Contacts/metadata/quickcreatedefs.php”：

```
array (
'name' => 'first_name',
'displayParams'=>array('required'=>true),
) 
```

我正在尝试其他修改，但我在网上找不到关于这个确切问题的任何内容。我将用我的发现更新这个问题。谢谢！

更新：在“modules/Contacts/field_arrays.php”中的“required_fields”数组中添加了“first_name”和“salutation”，但没有帮助。

更新：这是在 SugarCRM 5.1 上。这项工作是在升级到 5.1 期间进行的。

更新：将以下行添加到“modules/Contacts/vardefs.php”的“email_and_name1”数组中，但没有帮助。

```
'required' => 'true', 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T08:14:04.137

以上对我不起作用。我正在使用 5.2.0。

对我有用的是编辑 custom/modules/{modulename}/metadata/editviewdefs.php 并添加：

'name' => 'first_name', 'displayParams' => 数组 ('required' => true, ),

然后快速修复/重建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T19:26:20.380

我似乎找到了解决方案。我在“custom/Extension/modules/Contacts/Ext/Vardefs”中创建了一个名为“custom.php”的升级文件。该文件的内容如下：

```
<?php
$dictionary['Contact']['fields']['salutation']['required'] = true;
$dictionary['Contact']['fields']['first_name']['required'] = true;
?> 
```

在我做了“快速修复和重建”之后，现在需要称呼和名字。这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-17T08:21:29.223

为什么不在潜在客户中设置拳头名称和称呼必填字段？然后您可以直接在 Studio 中将字段修改为“必填”，而不必担心升级安全性。

# frameworks - 直观地处理表单的 Web 框架？

> ID：374907
> 
> 赞同：0
> 
> 时间：2008-12-17T15:32:27.357
> 
> 标签：frameworks, web-frameworks

将启动一个 Web 应用程序，它必须**为数据输入提供许多不同的 HTML 表单**，所以我想知道是否有一个 Web 框架可以巧妙地做到这一点。通常，当您有表单时，您有许多考虑因素，如导航、验证等，到目前为止我所看到的框架并没有非常有效地处理这些因素。

有人从表格中消除痛苦吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T15:37:59.340

你试过看[Grails](http://grails.org/)吗？它可以获取您的域类并将它们动态地构建到 Web 表单中并应用服务器端验证。默认的脚手架提供导航、分页、验证和其他各种非常好的功能！

这是一个[很好的教程](http://www.ibm.com/developerworks/java/library/j-grails01158/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T15:35:47.317

试试 Qcodo.com，它是用 PHP 编写的（但完全是 OOP）。它使用漂亮的表单模板系统管理两个数据库层。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T15:37:38.750

我认为 Ruby on Rails 中的表单处理得非常巧妙。在.Net 中也是如此。后者在让您重用数据库逻辑来验证数据方面走得很远，并且还可以“自动”处理 XSS 和 XSRF 等安全问题。

# installation - 调试导致重新启动的 Installshield 挂起文件重命名操作

> ID：374918
> 
> 赞同：0
> 
> 时间：2008-12-17T15:35:03.997
> 
> 标签：installation, windows-installer, installshield

从已经存在的 installscript 11.5 安装程序开始，我们创建了一个更新安装程序（差异安装程序）。

鉴于：

*   V1（软件第一版）
*   V2（软件第二版）
*   V2P（V1 和 V2 之间的差异安装程序

如果我安装 V1 并卸载它，则无需重新启动

如果我安装 V2 并卸载它，则不需要重新启动

如果我安装 V1、V2P 然后卸载它，我要求重新启动！

我检查了不同的注册表和磁盘监控工具，似乎 V1 + V2P 的组合等于 V2。

给定另一个工具，“pendingfilerenameoperations”似乎会强制重启。我认为这是由于我的差异安装程序造成的。

有谁知道可能是什么原因，或者至少，如何找到它？

**编辑**：我知道重新启动的原因（挂起的文件重命名操作）并且我知道那里的文件，但我想找到解释为什么 installshield 写这些挂起的文件重命名操作。

**编辑 2**：我发现这是 InstallShield，它将其运行时的所有文件都置于挂起的文件重命名操作中。这可能会导致意外错误……有人知道如何解决吗？

任何帮助将不胜感激，

问候，

网卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T15:46:15.707

您是否尝试过从 Sysinternals/Microsoft 运行 PendMoves？根据文档，它应该列出被移动或删除的特定文件。我假设这也适用于文件重命名

[http://technet.microsoft.com/en-us/sysinternals/bb897556.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897556.aspx)

编辑：如果您知道哪些文件需要重命名，您可以尝试运行 Process Explorer（也来自 Sysinternals）并搜索文件句柄以查找对相关文件的引用。它们可能被锁定了 - 安装程序从未关闭，或者应用程序/服务正在后台运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T19:27:59.970

您是否在卸载时创建了日志文件以查看正在执行的文件重命名操作？我强烈建议对这个问题使用详细日志记录。

# sharepoint - 我应该将解决方案和功能保持在 1-1 的比例吗？

> ID：374919
> 
> 赞同：4
> 
> 时间：2008-12-17T15:35:29.347
> 
> 标签：sharepoint, deployment, sharepoint-upgrade

我有一个包含多个 EventReceiver 和工作流的复杂共享点部署。

我还对现有列表进行了架构更改，添加了新的元数据列并更改了现有列。

我应该将单个功能、事件接收器或工作流打包到单个解决方案中，还是应该将多个功能放在单个解决方案中，因为它们都可以协同工作？

我问的一个主要原因是未来的代码升级。如果功能是分开的，那么升级一部分代码将不需要重新部署解决方案中的所有功能。这是我应该担心的事情，还是“stsadmin -o upgradesolution”可以解决升级具有许多功能的解决方案的任何问题？

让我知道这对任何 SharePoint 专家是否有意义。

谢谢你，
基思

**更新：** 查看引用的网站[drax](https://stackoverflow.com/questions/374919/should-i-keep-solutions-and-features-in-a-1-1-ratio#375278)，我发现了这个参考网站：http: [//msdn.microsoft.com/en-us/library/aa543659.aspx](http://msdn.microsoft.com/en-us/library/aa543659.aspx)

该声明似乎对解决方案中的升级功能造成了很大的障碍：

> 解决方案升级只能用于替换文件。您可以在解决方案升级中添加新文件并删除旧版本的文件，但您不能安装功能或使用功能事件处理程序来运行功能安装和激活代码。解决方案升级不支持以下操作。
> 
> *   在新版本的解决方案中删除旧功能。
>     
>     
> *   在解决方案升级中添加新功能。
>     
>     
> *   在新版本的解决方案中更新或更改现有功能的接收器组件。
>     
>     
> *   在新版本的解决方案中添加或更改功能元素（Element.xml 文件）。
>     
>     
> *   在新版本的解决方案中添加或更改功能属性。
>     
>     
> *   在新版本的解决方案中更改旧功能的 ID 或范围。
>     
>     
> *   在新版本的解决方案中删除功能元素（Element.xml 文件）。
>     
>     
> *   在新版本的解决方案中删除功能属性。

那么...您可以通过解决方案升级做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T17:09:49.513

我建议**不要**将所有内容拆分为多个解决方案。维护这很快就会变成噩梦。尝试以与 sharepoint 的 12 文件夹相同的方式构建您的项目，该项目应该用于创建 WSP。然后你可以使用[WSP builder](http://www.codeplex.com/wspbuilder)，最后的稳定版本带来了很多有用的东西。

我也没有注意到重新部署解决方案有任何问题。根据[这篇](http://msdn.microsoft.com/en-us/library/aa544500.aspx)文章和我的经验，WSP 的部署负责版本之间的同步。因此，如果您要添加一些新功能，它们将出现，如果您删除/更改功能，它们将被相应地修改。

**编辑：**

所以我对 MOSS 更新主题做了一些快速研究。根据 MS 的说法，有两种更新解决方案的方法：

1.  就地更新
2.  增量更新

基本上，就地更新是标准的更新方式。[这意味着您依赖于本](http://msdn.microsoft.com/en-us/library/aa544500.aspx)文档（与之前发布的相同文档）中描述的内置功能。这个解决方案的问题在于它缺少很多功能（版本控制、更改特性的 ID，......）。

增量更新（这可能是 MS 的称呼）不依赖于内置解决方案。这意味着每个人都可以自己实现它:(。更好的是我真的找不到这种方法的任何指导方针。我想你想采用的方法是增量更新的例子（将项目拆分为许多独立的解决方案）。

另请注意，MS 不正式支持增量更新。

所以我真的不知道我应该给你什么建议。单个 WSP 比它们中的大多数更易于维护，如果您只进行一些小的更改，更新也可以完美地工作。但是，如果您需要进行一些更大的结构性改变，问题就会开始显现。

我可能会拭目以待，看看是否有更多 MOSS 专业知识的人可以就这个话题发表意见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T16:03:18.573

基本上（出于您提到的原因），您应该像 .Net 程序集一样考虑解决方案 - 可以与其他代码分开部署的原子代码单元。使用 upgradesolution 将导致重新部署所有包含的功能 - 如果没有任何更改，那么使用该功能的站点应该没有任何更改。但是，如果这让您感到紧张，请考虑将其分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-22T08:35:36.147

如果您只是更新程序集并保持配置文件完好无损，UpgradeSolution 非常方便。

除非您指定 -local，否则 upgradesolution 将在您的基础架构中执行完整的 iisreset。当您计划执行升级的正确时间时，这确实值得注意。

# sql-server - 如何跟踪 T-SQL 事务？

> ID：374921
> 
> 赞同：1
> 
> 时间：2008-12-17T15:35:39.893
> 
> 标签：sql-server, tsql, transactions

是否有任何程序可以让您跟踪 sql 事务直至结束？例如，假设我继承了一个带有数据字典的相当复杂的 sql 数据库。数据字典非常好，但不如 SQL Doc 好。我查看了 Red Gate 的 Dependency Tracker，虽然它在将事物组合在一起（触发器、存储过程、表、视图等）方面做得非常好，但它仍然无法通过它的各种跟踪跟踪事务.

我想要的是允许我输入交易并基于我的数据库中的所有内容的软件，以可视方式将其树化，让我看到交易期间发生的事情。这有意义还是我需要详细说明？

**编辑详细：** 虽然下面的答案非常好，但这并不是我想要的。sql数据库的前端是用PowerBuilder构建的。我可以在前端数据输入期间使用 SqlSpy，这有助于跟踪事务，但它全是 t-sql，而且你可以想象，大量的输出。我正在寻找可以做同样事情的东西，但是如果我愿意的话，它可以在视觉上展示出细节的能力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T15:38:40.900

SQL Profiler 将允许您跟踪事务，并准确查看正在发生的事情。它非常灵活，只允许您显示您感兴趣的事件，但它不会以我认为您要询问的树格式显示。

探查器作为 SQL Server 客户端工具的一部分安装（连同企业管理器和查询分析器）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T17:55:55.577

如果在 Visual Studio 中打开连接，则可以在调试模式下运行存储过程和查询。即，您可以使用智能感知逐步遍历查询并查看变量中的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T15:42:54.183

我想如果这种方式是可行的。您可以设置测试环境并运行事务。提交事务后，将测试环境中的数据库与生产数据库进行比较。

您可以使用一些工具进行此比较。像 OpenDBDiff 一样，或者您可以通过谷歌搜索寻找其他工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T15:46:36.813

我还没有[使用它](http://www.dbazine.com/sql/sql-articles/larsen9)，它似乎可以满足您的要求：将 IDE 样式的调试工具应用于 T-SQL 语句。我很想看看它是如何工作的。

# sql - 更新时间戳列

> ID：374924
> 
> 赞同：2
> 
> 时间：2008-12-17T15:36:10.750
> 
> 标签：sql, oracle

我需要相同数量的列中的所有时间戳。我想写一个sql语句，如：

update sometable set timecol = timecol + <4 个月>；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T15:42:37.023

```
update sometable set timecol = add_months(timecol,4); 
```

查看[文档](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions004.htm#SQLRF00603)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:44:22.387

```
update sometable set timecol = timecol + interval '4' month; 
```

奇怪的是，我在任何地方的 Oracle 文档中都找不到它，但它适用于我的 Oracle XE 安装。它与 PostgreSQL 的做法非常接近，我相信它是 SQL 标准之一的一部分。

# c# - 通过正则表达式验证文件类型

> ID：374930
> 
> 赞同：92
> 
> 时间：2008-12-17T15:37:50.747
> 
> 标签：c#, asp.net, .net, regex

我有一个 .NET 网络表单，它有一个与正则表达式验证器相关联的文件上传控件。此验证器需要验证只允许上传某些文件类型（jpg、gif、doc、pdf）

当前执行此操作的正则表达式是：

```
 ^(([a-zA-Z]:)|(\\{2}\w+)\$?)(\\(\w[\w].*))(.jpg|.JPG|.gif|.GIF|.doc|.DOC|.pdf|.PDF)$ 

```

然而，这似乎不起作用......谁能给我一点reg ex帮助？

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2008-12-17T15:44:36.253

在我看来，您的正则表达式似乎有点太复杂了。另外，请记住点是一个特殊字符，意思是“任何字符”。以下正则表达式应该可以工作（注意转义点）：

```
^.*\.(jpg|JPG|gif|GIF|doc|DOC|pdf|PDF)$ 
```

您可以使用[Expresso 之](http://www.ultrapico.com/Expresso.htm)类的工具来测试您的正则表达式。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-01-28T15:33:55.000

```
^.+\.(?:(?:[dD][oO][cC][xX]?)|(?:[pP][dD][fF]))$ 
```

将接受文件名至少为一个字符的 .doc、.docx、.pdf 文件：

```
^           = beginning of string
.+          = at least one character (any character)
\.          = dot ('.')
(?:pattern) = match the pattern without storing the match)
[dD]        = any character in the set ('d' or 'D')
[xX]?       = any character in the set or none 
              ('x' may be missing so 'doc' or 'docx' are both accepted)
|           = either the previous or the next pattern
$           = end of matched string 
```

警告！如果不将整个扩展链包含在 (?:) 中，像 .docpdf 这样的扩展就会通过。

[您可以在http://www.regextester.com/](http://www.regextester.com/ "regextester")测试正则表达式

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-12-17T15:51:00.687

您是否只是想验证该文件是否具有给定的扩展名？您可以通过以下方式简化您尝试执行的操作：

```
(.*?)\.(jpg|gif|doc|pdf)$ 
```

然后，当您调用 IsMatch() 时，请确保传递 RegexOptions.IgnoreCase 作为您的第二个参数。没有理由必须列出套管的变化。

**编辑：正如 Dario 提到的，这不适用于 RegularExpressionValidator，因为它不支持大小写选项。**

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-18T00:09:04.287

您可以将不区分大小写嵌入到正则表达式中，如下所示：

```
\.(?i:)(?:jpg|gif|doc|pdf)$ 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-17T15:55:16.203

您的正则表达式似乎同时验证了文件名和扩展名。那是你需要的吗？我假设它只是扩展并且会使用这样的正则表达式：

```
\.(jpg|gif|doc|pdf)$ 
```

并将匹配设置为不区分大小写。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-11-09T11:34:42.020

您可以将此模板用于每种文件类型：

```
ValidationExpression="^.+\.(([pP][dD][fF])|([jJ][pP][gG])|([pP][nN][gG])))$" 
```

例如：您可以`[rR][aA][rR]`为 Rar 文件类型等添加 ( ) ...

# .net - .net 开源和运行平台选择

> ID：374934
> 
> 赞同：1
> 
> 时间：2008-12-17T15:39:13.147
> 
> 标签：.net, windows, linux, open-source

我们被要求为一个大项目研究一个完全开源的解决方案，他们希望项目尽可能接近 100% 开源，主要是因为它是一个社区项目，未来可能很少有资金可用，除了用于运行主机。使用操作系统软件可以节省许可成本，因为服务器将由现有的 IT 系统团队在内部进行管理。

供应商之一提议将 .net 作为系统的组成部分，这很好，我知道 .net 应用程序完全可以在 GPL 等开源许可下发布。

但是，由于我不是 .net 开发人员，所以当谈到 .net 的驱动力时，我有点困惑。它是否必须是 Windows 服务器，这当然会导致更高的服务器成本并与 MS 产品绑定，或者是否可以在 Linux 等开源服务器上运行 .net 应用程序？

请不要把它变成 MS 与 Linux 的争论和好处或使用其中之一。我们只是想确保我们在使用 .net 以及它的开源程度方面有充分的了解。我希望能睁开眼睛。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T15:41:45.980

“真”.NET 仅在 Windows 上运行。但是，只要不存在任何兼容性问题， [Mono 项目允许为 .NET 编写的应用程序在 Linux（和其他平台）上运行。](http://www.mono-project.com/Main_Page)Mono 有一个[兼容性检查器](http://www.mono-project.com/MoMA)，可以帮助您粗略地查看您可能遇到的问题，但我自己没有任何经验。还有一个[Portability Guidelines](http://www.mono-project.com/Guidelines:Application_Portability)页面，您可能会发现它非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:47:21.803

我想您会发现，在非 Microsoft 环境中，开源社区和选择的剪切量要大得多。虽然您可以使用 Mono 在 Linux 上运行 .Net，但您可能只是添加了另一层不必要的复杂性。

此外，一定要评估选择开源解决方案的真实成本。可能没有社区来支持您选择的软件，从长远来看，您最终可能会在维护上花费尽可能多的时间/金钱，因为您本来可以节省很多时间/金钱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T16:37:07.037

正如其他人已经知道的那样，有 Mono，但考虑到它的不成熟，它不仅是一个额外的复杂程度，而且是一个额外的风险级别。此外，提供 .NET 解决方案的供应商极不可能希望在 Apaches + Mono 上支持他们的应用程序。

所以要么选择 OSS（Apache + PHP/Perl/Python/Ruby 等），要么选择 IIS + .NET。选择 .NET 解决方案绝对没有错，如果它是最适合这项工作的应用程序，但不要试图将本质上为一个平台设计的应用程序套用到另一个平台上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T15:59:37.550

除了之前的一些答案；其他一些 Mono 细节：

*   目前，面向 .NET 2.0 和 3.5 的[编译器不是默认编译器](http://mono-project.com/Languages)。对我来说，这表明了一个不成熟的平台。如果您正在开始一个新项目，那么能够可靠地使用 .NET 框架必须提供的所有功能是一个巨大的优势。恕我直言，如果您需要将 .NET 框架推向极限/边缘情况，Mono 不会将其带到桌面上。*   Mono 由 Novell 赞助，它确实谈到了它作为一个平台的潜在寿命。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T16:49:11.647

该供应商在开源操作系统上是否有使用单声道的真实经验？或者只是在 Windows 上使用 .net？你的系统人呢？您可能不想强迫他们接受他们不积极支持的新事物

你听起来不太了解许可证。GPL 不能与其他一些很好地结合。请为此咨询专业人士。

# c# - 为什么 BitConverter 返回 Bytes 以及如何获取这些位？

> ID：374940
> 
> 赞同：0
> 
> 时间：2008-12-17T15:40:50.770
> 
> 标签：c#, bit-manipulation, bit-masks

作为输入，我得到一个 int（好吧，实际上是一个我应该转换为 int 的字符串）。
此 int 应转换为位。
对于每个具有 1 的位位置，我应该得到该位置。
在我的数据库中，我想要所有具有 int 值字段的记录，该字段将此位置作为值。
我目前有以下幼稚的代码，它应该询问我的实体（持有 databaseValue）是否与位置匹配，但显然不能正常工作：

```
Byte[] bits = BitConverter.GetBytes(theDatabaseValue);
return bits[position].equals(1); 
```

首先，我有一个字节数组，因为显然没有位类型。我应该使用 Boolean[] 吗？那么，我该如何填充这个数组呢？最后，如果前面的语句得到解决，我应该只返回 bits[position]

我觉得这应该以某种方式用位掩码解决，但我不知道从哪里开始..

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T15:44:31.887

我怀疑[BitArray](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)是你所追求的。或者，自己使用位掩码并不难：

```
for (int i=0; i < 32; i++)
{
    if ((value & (1 << i)) != 0)
    {
        Console.WriteLine("Bit {0} was set!", i);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-17T16:00:28.063

你的感觉是对的。这应该用位掩码解决。BitConverter 不返回位（它怎么可能？“位”不是实际的数据类型），它将原始字节转换为 CLR 数据类型。每当您想从某些东西中提取位时，您应该考虑位掩码。

如果要检查是否设置了某个位置的位，请使用 & 运算符。仅当两个位都设置时，按位 & 才为真。例如，如果您有两个字节 109 和 33，则 & 的结果将是

```
  0110 1101
& 0010 0001
------------
  0010 0001
```

如果您只想查看是否在 int 中设置了某个位，您可以使用一个仅包含您要检查的位的数字（即 1、2、4、8、16、32 等）并检查如果结果不为零。

```
List<int> BitPositions(uint input) {
    List<int> result = new List<int>();
    uint mask = 1;
    int position = 0;
    do {
        if (input & mask != 0) {
            result.Add(position);
        }
        mask <<= 1;
        position++;
    } while (mask != 0);

    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T15:46:23.473

不要使用布尔值。尽管 boolean 只有两个值，但它实际上像 int 一样使用 32 位存储。

编辑：实际上，以数组形式布尔值将被打包成字节，而不是 4 个字节。

# c# - 跟进：如何在没有 Linq 的情况下从列表中获取一些对象？

> ID：374943
> 
> 赞同：-2
> 
> 时间：2008-12-17T15:41:30.550
> 
> 标签：c#, .net, performance, algorithm, generics

我对[这个问题有疑问](https://stackoverflow.com/questions/372812/how-do-get-some-of-the-object-from-a-list-without-linq)。我在那里发布了回复，但由于它已被标记为已回答，我认为我不会在那里收到对我的帖子的回复。

> 我正在运行 C# 框架 2.0，我想从列表中获取一些数据？该列表是一个列表<>。如果不对 List<> 的每个元素进行循环和手动比较，我该如何做到这一点？

看起来答案只是比较列表中每个元素的更优雅的方式。鉴于不能保证在搜索之前对列表进行排序，原始帖子中提供的任何方法是否确保它们正在查看原始列表的较小子集？

编辑：要注意的一件事是我不想在这里做任何事情。我只是想知道另一个问题中提供的解决方案是否真正符合 OP 的要求，即遍历整个列表。一般来说，要搜索一个未排序的列表（至少在给定数据结构的情况下不需要），您必须搜索整个列表。但是，**其他线程上的任何解决方案是否具有底层优化以防止搜索整个列表？**

编辑：我真的没有得到任何有用的答案，但我会相信至少证实了我的常识信念的答案。如果我注意到一个更好的新答案，我会改变我的投票。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T01:06:18.837

如果您的要求是在任意集合中快速查找内容，那么列表可能不是该工作的最佳数据结构。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T01:03:08.780

您可能想查看[.Net 2.0 的 LINQ 支持](http://weblogs.asp.net/fmarguerie/archive/2007/09/05/linq-support-on-net-2-0.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T01:20:46.420

已在您提到的线程中解释过，您可以在没有 LINQ 的情况下从列表中获取一些对象。

```
 list = list.FindAll(yourFilterCriteria); 
```

对象 yourFilterCriteria 是一个**谓词**，可以与对象中的所有属性或函数进行比较，因此它非常可定制。

```
 Predicate<SimpleObject> yourFilterCriteria = delegate(SimpleObject simpleObject)
    {
        return simpleObject.FirstName.Contains("Skeet") && simpleObject.Age < 30;
    }; 
```

此示例向您展示，您可以在不循环 manullay 的情况下搜索列表，您将获得所有名字为 Skeet 且年龄在 30 岁以下的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T15:53:41.370

如果您只查找第一个匹配项，则 Find 方法将完成这项工作。它不会遍历整个列表，而是返回对象的第一次出现。但是，如果你想找到所有这些，如果没有排序，你希望如何只搜索数据的一个子集？

# iis - “URL 重写”/使用 .net 3.0 和 IIS 6.0 进行路由

> ID：374946
> 
> 赞同：2
> 
> 时间：2008-12-17T15:42:02.470
> 
> 标签：iis, iis-6

我想知道对于我想让用户输入的情况最好的方法是什么

[http://myserver/something/20](http://myserver/something/20)

并被重定向（301 或 302）到

[http://someotherserver/applications/something/modules/default.aspx?id=20](http://someotherserver/applications/something/modules/default.aspx?id=20)

对于 .net 3.5 和 IIS 7，我找到了一些解决方案，但不幸的是，我在 Windows 2003 上坚持使用 .net 3.0 和 IIS 6.0，如果可能的话，我不想在服务器上安装任何东西。我可以更改虚拟目录的设置，如果我必须更改整个站点。

HTTPModules 和 web.config 仅是 ASP.net 如果我没有完全弄错，那么这将无济于事，因为 /20 默认情况下不会发送到 ASP.net？

谁能给我一些提示，我可以设置这样的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T16:29:11.157

在不将 301 重定向直接放入 IIS 管理器的情况下，我看到的唯一方法是使用通配符映射

[关联](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T16:31:45.130

您可以寻求 ASP 的帮助。

在您的 something 文件夹中创建一个 404.asp 文件，其内容为：-

```
<%

Dim id : id = CLng(Mid(Request.QueryString, InStrRev(Request.QueryString, "/")+1))
Response.Redirect "http://someotherserver/applications/something/modules/default.aspx?   id=" & id

%> 
```

在 IIS 管理器中的某物文件夹的自定义错误中调整为 URL 和 /something/404.asp

请注意，传递给 404 客户错误页面的查询字符串值如下所示：-

404; [http://myserver:80/something/20](http://myserver:80/something/20)

**编辑：** D'oh 或者您可以使用 404.ashx 自定义错误页面，然后使用更熟悉的 .NET 代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-17T16:36:01.643

将扩展名映射到与应用程序配置中虚拟目录的文件映射`.*`相同的 DLL 。`.aspx`然后在 web.config 的 httpHandlers 部分中，将 URL 映射到类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T21:27:06.960

1.  在 IIS 中，右键单击**Virtual Directory**，选择**Properties**。
2.  在**目录**选项卡下，单击**配置...**按钮。
3.  在**Mappings**选项卡下，在**Wildcard application maps** (order of implementation) 下：单击**Insert...**按钮。
4.  浏览并选择**C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll**，未选中验证文件是否存在。
5.  **将**aspnet_isapi.dll 上移到列表顶部。
6.  单击**确定，确定**，然后尝试。如果您没有看到它工作，请尝试回收应用程序池。

我们的情况是 .Net Routing 在我们的开发 PC 上运行，但在带有 IIS 6 和 Windows 2003 的测试和生产服务器上却没有。这解决了我们的问题。

# php - PHP5 和 Microsoft Live Search 2.0

> ID：374952
> 
> 赞同：0
> 
> 时间：2008-12-17T15:43:43.353
> 
> 标签：php, soap, livesearch

我正在尝试使用 Live Search 2.0，但即使是一个简单的示例似乎也不起作用。微软只有 1.1 的示例代码，他们没有提供该版本的 AppID。

这是我正在尝试的：

```
<?php
$server = new SoapClient('http://soap.search.msn.com/webservices.asmx?wsdl');

class Search {
    public $Request;
}

class SearchRequest {
    public $AppID;
    public $Query;
    public $CultureInfo;
    public $SafeSearch;
    public $Flags;
    public $Location;
    public $Requests;
}

class SourceRequest {
    public $Source;
    public $Offset;
    public $Count;
    public $FileType;
    public $SortBy;
    public $ResultFields;
    public $SearchTagFilters;
}

$searchRequest = new SourceRequest();
$searchRequest->Source = 'Web';
$searchRequest->Offset = 0;
$searchRequest->Count = 5;
$searchRequest->ResultFields = 'All SearchTagsArray';

$request = new SearchRequest();
$request->AppID = '...';
$request->Query = 'Bill Gates';
$request->CultureInfo = 'en-US';
$request->SafeSearch = 'Off';
$request->Flags = '';
$request->Requests = array($searchRequest);

$search = new Search();
$search->Request = $request;

$server->Search($search);
?> 
```

AppID 在代码中正确指定：我刚刚从这里删除了它。我收到以下错误：

```
Array ( [0] => SearchResponse Search(Search $parameters) )
Fatal error: Uncaught SoapFault exception: [soapenv:Client] Client Error in /Users/thardas/Sites/vt9/widgets/ms_livesearch.php:41
Stack trace:
#0 [internal function]: SoapClient->__call('Search', Array)
#1 /Users/thardas/Sites/vt9/widgets/ms_livesearch.php(41): SoapClient->Search(Object(SearchRequest))
#2 /Users/thardas/Sites/vt9/index.php(23): include('/Users/thardas/...')
#3 {main} thrown in /Users/thardas/Sites/vt9/widgets/ms_livesearch.php on line 41 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-22T02:23:53.930

您可以从使用 2.0.0 的适当的 soap api url 开始。现在是“ [http://api.search.live.net/search.wsdl?AppID=YourAppId](http://api.search.live.net/search.wsdl?AppID=YourAppId) ”取自（[http://msdn.microsoft.com/en-us/library/dd250965.aspx](http://msdn.microsoft.com/en-us/library/dd250965.aspx)）

您还可以将新的 JSON api 与 php 一起使用。

```
$appid = 'Your app id';
$searchitem = 'PHP Manual';
    $request = 'http://api.search.live.net/json.aspx?Appid=' . $appid . '&sources=web&query=' . urlencode( $searchitem);
    $response  = file_get_contents($request);
    $jsonobj  = json_decode($response);
    foreach($jsonobj->SearchResponse->Web->Results as $value)
    {
    //$value->Url
    //$value->Title
    //$value->Description
    } 
```

最后还有一个 xml api，你也可以查看 msdn 链接，它的获取方式与 json 基本相同，你只需要以不同的方式对其进行解码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T05:15:50.380

API 2.0 的示例代码在 MSDN 上，但我们还没有完整的 PHP 代码示例。第一个代码示例（与您已经得到的答案中的那个非常相似）包含在[Live Search Developer Blog 上的博客文章中](http://dev.live.com/blogs/livesearch/archive/2009/01/05/444.aspx)

您可能知道目前PHP 5.2.6 中的[SOAP 存在一些问题](http://bugs.php.net/bug.php?id=43069)- Live Search 服务似乎在 1.1 和 2.0 中都受到了它的影响。最简单的解决方法是使用另一个接口（JSON 或 XML）

# sql-server - SQL Server 代理：如何“睡觉”？

> ID：374960
> 
> 赞同：0
> 
> 时间：2008-12-17T15:45:45.473
> 
> 标签：sql-server, scripting, vbscript, sql-server-agent, wsh

在 SQL Server Agent 2005 中计划任务的脚本步骤中，我需要触发在不同服务器上运行的 web 脚本。我正在这样做：

```
Dim ie 
Set ie = CreateObject( "InternetExplorer.Application" )

ie.navigate "...to my dreamscript"

' Wait till IE is ready
Do While ie.Busy
    (1)
Loop

ie.Quit
set ie = Nothing 
```

在 (1) 我想“睡觉”（例如 WScript.sleep(..)），但 WScript 在此环境中不可用。还有另一种方法可以“睡”一会儿吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T17:01:34.430

如果您只是想让 SQL SErver 代理任务等待一段时间，请使用带有脚本的 T-SQL 任务

WAITFOR DELAY '01:00:00' -- 等待一个小时

并将时间更改为您想要等待的持续时间。

HTH安迪

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:51:28.800

您可以编写控制台应用程序并在 SQL 代理作业中执行控制台应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T16:59:38.663

您可以使用“操作系统 (CmdExec)”类型的 SQL Server 代理任务来执行 wscript。这需要启用 xp_cmdshell，并且出于安全考虑，它通常被禁用（默认情况下）。但是，它确实允许您启动在命令提示符下运行的程序，例如 wscript。

您可以将代码移动到 SQLCLR 中，您可以在其中使用 C# 或 VB.Net 编写存储过程。VB.Net SQLCLR 代码与您原来的 wscript 非常相似。

# java - 如何使 Java 可以使用任意字体文件？

> ID：374964
> 
> 赞同：3
> 
> 时间：2008-12-17T15:46:22.727
> 
> 标签：java, fonts

我正在使用第三方库，它通过 GraphicsEnvironment: getAllFonts() 调用访问字体。这包括属于 JRE 和操作系统的字体注册表中的字体。

但是在连接到我们服务器的客户端机器上，我可能无法将字体安装到这些位置中的任何一个。那么我怎样才能使其他字体可用于 JRE 以便此调用能够接收它们呢？有没有办法扩展它的搜索路径？

我可以使用 Font.createFont() 调用从任意文件访问字体。但是它仍然没有出现在 GraphicsEnvironment.getAllFonts() 中。有没有一种方法可以将该字体传递给它将其添加到可用字体列表中？我正在阅读有从系统属性访问字体的调用，但我仍然不理解，我认为这只是将我设置的字体属性转换为可用列表中的字体名称。

* * *

asalamon 提供了正确的答案，但我被困在不支持它的早期版本的 Java 上，至少要等到明年。因此，仍然非常欢迎更多答案！我可能会尝试使用反射来破解我们正在使用的库并将字体直接插入其缓存中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T16:44:37.897

使用[GraphicsEnvironment.registerFont](http://java.sun.com/javase/6/docs/api/java/awt/GraphicsEnvironment.html#registerFont(java.awt.Font))。（对于 JDK 1.6）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:53:38.343

尝试[Font.createFont()](http://java.sun.com/javase/6/docs/api/java/awt/Font.html)并捆绑您要使用的字体。

# sql - 哪个更好： Distinct 或 Group By

> ID：374973
> 
> 赞同：14
> 
> 时间：2008-12-17T15:47:55.327
> 
> 标签：sql, sql-server

哪个更有效率？

```
SELECT  theField
FROM    theTable
GROUP BY theField 
```

或者

```
SELECT  DISTINCT theField
FROM    theTable 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-17T16:35:03.423

在您的示例中，两个查询将生成相同的执行计划，因此它们的性能将相同。

但是，他们都有自己的目的。为了使您的代码更易于理解，您应该使用 distinct 来**消除重复的行**，并使用 group by 来**应用聚合运算符**（sum、count、max、...）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-17T15:54:42.380

没关系，它会导致相同的执行计划。（至少对于这些查询）。这类问题很容易解决，通过启用查询分析器或 SSMS 来显示执行计划，也许还可以在运行查询后显示服务器跟踪统计信息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-17T15:54:41.897

在大多数情况下，DISTINCT 和 GROUP BY 生成相同的计划，并且它们的性能通常相同

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-17T15:54:09.293

您可以检查执行计划以查找此语句的总成本。在不同的场景下，答案可能会有所不同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-17T16:00:02.853

嗯...就我在运行类似查询的执行计划中看到的而言，它们是相同的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-14T16:01:48.657

在 MySQL 中，如果 theField 没有被索引，DISTINCT 似乎比 GROUP BY 快一点。DISTINCT 仅**消除重复行**，但 GROUP BY 似乎另外对它们进行**排序**。

# sql-server - SSRS 中的自定义定时订阅计划

> ID：374982
> 
> 赞同：4
> 
> 时间：2008-12-17T15:50:22.513
> 
> 标签：sql-server, reporting-services

我看到，在 SQL Server Reporting Services 2005 报告管理器中，可以为特定时间安排报告（即每个工作日的特定时间）。

我想要的是更多的控制——即每个工作日，但仅限于一年中的某些日期之间——例如，从圣诞节前 6 周开始每天获取销售数据，并在圣诞节后 1 周结束。有一张表，上面有日期。如何在 SQL Server Reporting Services 2005 中进行设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T02:23:53.967

如果您有企业版，则可以创建数据驱动订阅，从而生成报告收件人和参数表，然后将报告订阅指向该表。您可以完全控制表格的填充方式，因此您可以确保它仅在您希望报告发布的日期填充（订阅将每天运行，但如果表格为空，则不会发布到任何人）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T16:02:58.650

您可以按照您在 SSRS 中的要求进行操作。

在计划详细信息表单的底部，您可以指定订阅的开始日期和结束日期。

但是，您需要每年更新这些日期，但您可以为此设置一个 SSIS 作业。您需要更新 Reporting Services 数据库中“Schedule”表中的“StartDate”和“EndDate”列（默认名称为“ReportServer”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T18:02:31.920

1.  我认为没有办法自定义报表管理器界面来显示自定义计划，因为其中有一部分是由 SSIS 管理的。

2.  是的，您可以删除某些用户的订阅功能。您可以在 SSMS 中执行此操作，当连接到您的报表服务器时，在 Security | 角色部分。管理订阅功能的权限名为：“管理个人订阅”。通过删除它，您的最终用户将无法创建或更新他们的订阅计划。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-01T04:39:27.300

创建一个调用程序的数据驱动订阅，该程序将确定正确的日期（比如说，每月的第一个工作日）。每天运行计划，它将触发仅在特定日期返回的程序。

# xaml - Expression Blend 会让我免于学习 xaml 吗？

> ID：374990
> 
> 赞同：3
> 
> 时间：2008-12-17T15:51:49.343
> 
> 标签：xaml, silverlight-2.0, expression-blend

我不介意学习 xaml，而且我确信我需要熟悉一些，但是当我第一次尝试使用 javascript 的 Silverlight 1 时，它看起来像是一个巨大的开销。我决定等到工具成熟并添加 asp.net。好吧，asp.net 已经添加了 Silverlight 2.0，现在我想看看使用它。但是，对我来说，xaml 看起来每个小步骤仍然需要大量工作。我对 Flash 的体验在图形方面似乎要简单得多（从来没有那么喜欢 ActionScript。） Blend 500 美元会解决我的大部分 xaml 问题吗？我可以将 Visual Studio Express 与完整版的 Microsoft Expression Blend 一起使用吗？

我需要 Microsoft Expression Studio 2 吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T16:00:03.197

正如专业的 Web 开发人员不能依靠 Dreamweaver 的拖放操作来避免学习 HTML，您应该爬上 XAML 学习曲线。

然而，Blend 仍然会有所帮助——正如许多人通过拖放和研究生成的 HTML 代码来启动 HTML 曲线一样。我使用 Silverlight 1.1 进行了一些原型设计，Blend 极大地帮助了我对 XAML 的理解。有一个“真正的”项目可以工作是有帮助的，即使它是一个概念证明。专注于 Canvas 和其他元素之间的包含范式，您将很快掌握它。我不会太担心 MPATH 的东西，请依赖该工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T16:00:00.233

Microsoft Expression Blend 会为您处理大量 XAML，并帮助您创建动画和设置触发器（XAML 触发器）。我讨厌必须通过手动编码的 XAML 来完成所有这些工作。我没有将 Blend 与 Visual Studio Express 一起使用，但我相信它会正常工作。Microsoft Expression Blend 2 使用 sln 文件打开一个项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T16:05:00.567

Expression Blend 对数据绑定没有帮助。VS2010 承诺在其 WPF 设计器中进行数据绑定，但如果您不能等到那时，请学习一些 XAML。

将 XAML 视为使用 WPF/Silverlight 时要学习的许多新的 .NET 3.5 内容之一。我从 APress推荐[C# 2008 中的 Pro WPF](http://www.apress.com/book/view/1590599551)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T16:13:31.267

Expression Blend 让您能够绘制形状、路径、联合或差异形状、创建动画（类似于 Flash 补间）、连接简单的触发器（如鼠标悬停播放动画）。无需深入研究 XAML。

# c - 不使用 popen() 或 system() 按名称查找进程的 PID

> ID：374997
> 
> 赞同：5
> 
> 时间：2008-12-17T15:53:09.140
> 
> 标签：c, unix, signals, kill, pid

我有一个进程名称，我必须`kill()`向该进程发送一个信号，但我需要它的 PID 来调用`kill()`. 我只想使用：

```
popen("pidof process_name"); 
```

作为最后一件事。有没有其他方法可以找出进程的PID？我能想到的一种方法是向该进程发送一个套接字请求并询问它的 PID。

另一种方法对于我正在编写的简单代码来说有点太复杂了：做[pidof 命令的源代码](http://www.koders.com/c/fid80C38C715E43CB80C4E15CB469AE652F16FFB551.aspx?s=pidof#L3)实际上正在做的事情（它使用函数调用`find_pid_by_name()`，但它做了很多事情）。

如果没有简单的解决方案，我必须这样做：

```
system("pkill <process_name>"); 
```

并检查其返回码。但是 pkill 在所有 Linux 机器上都可以使用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-17T16:29:32.793

你提到你正在使用linux。这不是最干净的解决方案，但您可以浏览 /proc 中的每个条目，并根据您要查找的内容检查 cmdline 中的进程名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T16:04:48.617

使用 sysctl -[示例代码](http://programming-in-linux.blogspot.com/2008/03/get-process-id-by-name-in-c.html)

编辑 - 它在 Linux 中可用，[请参见此处](http://www.linuxjournal.com/article/2365)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T15:37:39.110

Procfs 读取非常便宜，许多人认为迭代 /proc 就像迭代 / 一样，实际上根本不是这样。

通过跳过任何低于 1000 的条目来节省一些时间，检查内核线程是没有意义的。所以，基本上……在 opendir() 之后，如果 strtoint() 认为该条目是一个 int ，并且该 int 大于或等于 1000，则只需读取 /proc/%d/stat。

尽量避免只解决“exe”链接的冲动，因为这不会告诉你将接收信号的进程的状态。例如，如果目标处于状态“D”（磁盘睡眠），您会想知道，如果 D 状态是常年的，信号将不会立即传递，或者可能永远不会传递。

在大多数系统上，需要检查 70 到 120 个进程，您通常会在到达终点之前找到目标方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T04:20:29.160

您提到，“我能想到的一种方法是向该进程发送一个套接字请求并询问它的 PID。” 听起来您要杀​​死的进程是您编写的程序。

如果是这种情况，规范的做法是在程序运行时将 pid 存储在一个文件中（通常在 /var/run 下，如果您可以访问它），并在程序退出时删除该文件。这样，检测程序是否正在运行就像

```
if kill -0 $(cat /var/run/myprog.pid 2>/dev/null) 2>/dev/null; then
    echo Running!
else
    rm -f /var/run/myprog.pid
    echo "Not running."
end 
```

仔细研究上述代码的所有含义可能会教你很多关于 PID 文件如何工作的知识。或者你可以要求更详细的解释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T16:17:59.387

这对我来说似乎很好。

不过，您可能希望提供该进程的完整路径，以免杀死具有相似名称的进程。

这样做的主要优点是您可以指定要发送的信号。

```
system("killall -s 9 process_name"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T14:43:03.430

为什么不将 fcntl 与 F_GETOWN 一起使用？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-05T08:25:58.277

要完成@GregRogers 的答案，您只需要检查 pidof 的实现

*   [https://gitlab.com/procps-ng/procps/blob/master/pidof.c#L147](https://gitlab.com/procps-ng/procps/blob/master/pidof.c#L147)
*   [https://gitlab.com/procps-ng/procps/blob/master/proc/readproc.h#L288](https://gitlab.com/procps-ng/procps/blob/master/proc/readproc.h#L288)
*   [https://gitlab.com/procps-ng/procps/blob/master/proc/readproc.c#L932](https://gitlab.com/procps-ng/procps/blob/master/proc/readproc.c#L932)

如您所见，它仅搜索 /proc 目录。***