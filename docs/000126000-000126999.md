# StackOverflow 问答 000126000-000126999

# hp-ux - 哪些进程正在使用 unix 上的哪些端口？

> ID：126002
> 
> 赞同：34
> 
> 时间：2008-09-24T08:20:29.663
> 
> 标签：hp-ux

我需要找出哪些端口连接到 Unix 机器（HP Itanium）上的哪些进程。不幸的是，`lsof`没有安装，我没有办法安装它。

有谁知道另一种方法？一个相当长的谷歌搜索没有出现任何东西。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-24T08:21:40.970

[netstat -l](http://www.faqs.org/docs/linux_network/x-087-2-iface.netstat.html)（假设它带有那个版本的 UNIX）

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-24T08:26:51.333

给定（几乎）unix上的所有内容都是一个文件，并且 lsof 列出打开的文件......

Linux：`netstat -putan or lsof | grep TCP`

操作系统：`lsof | grep TCP`

其他Unixen：`lsof`方式...

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-24T08:31:36.127

```
netstat -pln 
```

编辑：仅限 linux，在其他 UNIX 上 netstat 可能不支持所有这些选项。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-25T20:37:04.377

假设这是 HP-UX？[Ptools](http://h21007.www2.hp.com/portal/download/files/unprot/STK/HPUX_STK/impacts/i983.html)怎么样- 你安装了那些吗？如果是这样，您可以使用“pfiles”来查找应用程序正在使用的端口：

> *pfiles 打印有关进程的所有打开文件描述符的信息。如果文件描述符对应于一个文件，则 pfiles 打印 fstat(2) 和 fcntl(2) 信息。*
> 
> *如果文件描述符对应一个套接字，则 pfiles 打印套接字相关信息，例如套接字类型、套接字系列和协议系列。*
> 
> *在 AF_INET 和 AF_INET6 系列套接字的情况下，还会打印有关对等主机的信息。*

对于 f in $(ps -ex | awk '{print $1}'); 回声 $f; pfiles $f | grep 端口号；完毕

将 PORTNUM 切换为端口号。:) 可能是子 pid，但可以让您足够接近以识别问题应用程序。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-24T08:43:41.747

```
netstat -ln | awk '/^(tcp|udp)/ { split($4, a, /:/); print $1, a[2]}' | sort -u 
```

为您提供活动的 tcp/udp 端口​​。然后，您可以使用带有`fuser -n tcp`or的端口`fuser -n udp`，以 root 身份，并假设它`fuser`是 GNU fuser 或具有类似选项。

如果您需要更多帮助，请告诉我。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T08:24:27.487

尝试`pfiles PID`显示一个进程的所有打开文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-17T10:05:37.753

哪个进程在 unix 中使用端口；

## 1\. netstat -Aan | grep 端口

> 根> netstat -Aan | grep 3872
> 
> 输出> f1000e000bb5c3b8 tcp 0 0 *.3872 *。* 听

## 2\. rmsock f1000e000bb5c3b8 tcpcb

> 输出> 套接字 0xf1000e000bb5c008 由进程 13959354 (java) 持有。

## 3.ps -ef | grep 13959354

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-01-31T14:29:49.503

我使用这个命令：

```
netstat -tulpn | grep LISTEN 
```

您可以有一个干净的输出，显示正在侦听的进程 ID 和端口

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-12T05:19:58.357

如果您想知道**所有侦听端口及其详细信息**：本地地址、外部地址和状态以及进程 ID (PID)。您可以在 linux 中使用以下命令。

```
 netstat -tulpn 
```

# php - 如何将 PHP 脚本转义到外部编辑器并在之后返回？

> ID：126005
> 
> 赞同：6
> 
> 时间：2008-09-24T08:21:51.563
> 
> 标签：php, shell, command-line, user-input

具体来说，我有一个 PHP 命令行脚本，在某个时候需要用户输入。我希望能够执行外部编辑器（例如 vi），并在恢复脚本之前等待编辑器完成执行。

我的基本想法是使用临时文件进行编辑，然后检索文件的内容。类似于以下内容：

```
$filename = '/tmp/script_' . time() . '.tmp';

get_user_input ($filename);

$input = file_get_contents ($filename);
unlink ($filename); 
```

我怀疑这在 PHP 命令行脚本中是不可能的，但是我希望有某种 shell 脚本技巧可以用来实现相同的效果。

关于如何在其他脚本语言中实现这一点的建议也非常受欢迎。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-24T21:19:33.753

您可以将编辑器的输出重定向到终端：

```
system("vim > `tty`"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T08:30:48.093

我刚刚尝试过，它在 Windows 中运行良好，因此您可以在 Linux 上使用 vi 或任何您想要的应用程序进行复制。

关键是`exec()`在记事本（在这种情况下）运行时挂起 php 进程。

```
<?php

exec('notepad c:\test'); 
echo file_get_contents('c:\test');

?>

$ php -r test.php 
```

编辑：正如您的尝试和 bstark 指出的那样，我的记事本测试会启动一个新窗口，所以一切都很好，但是任何在控制台模式下运行的编辑器都会失败，因为它没有可以附加的终端。

话虽如此，我在一个 Linux 机器上尝试过`exec('nano test'); echo file_get_contents('test');`，它并没有像 vi 那样失败，它只是运行而不显示任何东西。我可以输入一些东西，按“ctrl-X, y”关闭并保存文件，然后 php 脚本继续显示我写的内容。无论如何..我找到了正确的解决方案，所以新的答案进来了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T08:29:55.023

```
system('vi'); 
```

[http://www.php.net/system](http://www.php.net/system)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T10:56:35.670

我不知道是否可以将 vi 连接到正在运行 php 的终端，但快速简便的解决方案是不要在同一终端上使用屏幕编辑器。

您可以使用诸如 ed 之类的行编辑器（您可能不希望这样做）或打开一个新窗口，例如 system("xterm -e vi")（将 xterm 替换为您的终端应用程序的名称）。

编辑添加：在 perl 中，system("vi") 可以正常工作，因为 perl 不做 php 做的那种花哨的流水线/缓冲。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T11:41:41.567

所以看起来你写文件的想法让我们在有一个简单的解决方案时尝试疯狂的事情:)

```
<?php

$out = fopen('php://stdout', 'w+');
$in = fopen('php://stdin', 'r+');

fwrite($out, "foo?\n");
$var = fread($in, 1024);
echo strtoupper($var); 
```

fread() 调用将挂起 php 进程，直到它接收到某些内容（我认为是 1024 字节或行尾），从而产生：

```
$ php test.php
foo?
bar <= my input
BAR 
```

# javascript - 使用 AJAX XMLHttpRequest 监控 Rails 应用程序上的服务器端进程

> ID：126011
> 
> 赞同：0
> 
> 时间：2008-09-24T08:23:52.790
> 
> 标签：javascript, ruby-on-rails, ajax, xmlhttprequest

我在网页中使用以下内容，但在处理时无法从服务器获得响应

```
<script type="text/javascript">
<!--
   function updateProgress() {
      //alert('Hello');
      new Ajax.Request('/fmfiles/progress_monitor', {
         parameters: 'authenticity_token=' + encodeURIComponent(AUTH_TOKEN),
         onSuccess: function(response) {
            alert(response.responseText);
            fillProgress('progressBar',response.responseText);
         }
      });
   }
//-->
</script>

<% form_for( :fmfile, :url => '/fmfiles', :html => { :method => :post, :name => 'Form_Import', :enctype => 'multipart/form-data' } ) do |f| %>
...
<%= f.file_field :document, :accept => 'text/xml', :name => 'fmfile_document' %>
<%= submit_tag 'Import', :onClick => "setInterval('updateProgress()', 2000);" %> 
```

fmfiles_controller.rb 中的“create”方法然后愉快地处理文件并获得正确的结果（根据表单上的提交按钮）。如果我取消注释 '//alert('Hello')' 行，我会收到一个对话框，每 2 秒显示一次 Hello ... 正如预期的那样。

但是，服务器永远不会在“文件”中记录对“progress_monitor”方法的任何调用，甚至不会记录失败的尝试。

如果我点击链接

```
<a href="#" onclick="updateProgress();">Run</a> 
```

它调用服务器，得到响应并显示对话框，所以我假设路由、语法和命名都可以。

我真的不知道为什么这不起作用。是因为同一个控制器中的 2 个方法是通过 URL 调用的吗？

我在 OS X 10.5.5 的开发环境中使用 Rails 2.1.0 并使用 Safari 3.1.2

（注意这是从另一个[问题](https://stackoverflow.com/questions/120201/updating-server-side-progress-on-rails-application)开始的，但我认为它有足够的不同值得提出自己的问题。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T12:12:53.567

如果您没有在日志文件中看到调用“progress_monitor”的消息，则可能永远不会发送请求。

试试这个：

1.  尝试使用完整的 URL 而不是 Ajax.Request 的相对 URL。我在使用 Ajax.Request 的某些浏览器上遇到了相对 URL 的问题。

2.  启用 Firebug 或 IE 开发工具栏。您应该能够查看对 progress_monitor 的调用是否有效。如果存在 java 脚本错误，那么您将使用这些工具清楚地看到错误。

# sql - 查看存储过程创建的临时表

> ID：126012
> 
> 赞同：6
> 
> 时间：2008-09-24T08:24:00.687
> 
> 标签：sql, sql-server, stored-procedures

我在SQL 2005中有一个存储过程。存储过程实际上是在SP开始时创建临时表并在最后删除它。我现在在 VS 2005 中调试 SP。在 SP 之间，我想知道临时表中的内容。任何人都可以帮助在运行时查看临时表的内容。

谢谢维诺德

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-24T08:31:59.527

临时表有几种，我想你可以使用SP使用后没有删除的表。只要确保你没有调用同一个 SP 两次，否则你会在尝试创建现有表时出错。或者在看到它的内容后直接删除临时表。因此，不要使用表变量 ( `@table`)，只需使用`#table`or`##table`

* * *

从[http://arplis.com/temporary-tables-in-microsoft-sql-server/](http://arplis.com/temporary-tables-in-microsoft-sql-server/)：

## 本地临时表

*   本地临时表以单个数字符号 (#) 作为其名称的第一个字符，例如 (#table_name)。
*   本地临时表仅在当前会话中可见，或者您可以说它们仅对用户的当前连接可见。当用户断开与 Microsoft SQL Server 实例的连接时，它们将被删除。

## 全局临时表

*   全局临时表前缀以双数字符号 (##) 作为其名称的第一个字符，如 (##table_name)。
*   全局临时表对所有会话可见，或者您可以说它们在创建后对任何用户可见。
*   当所有引用该表的用户与 Microsoft SQL Server 断开连接时，它们将被删除。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-24T08:25:20.807

编辑存储过程以在运行时从临时表中临时选择 *（可能到另一个表或文件中，或者只是到输出窗格中）..？

然后，您可以稍后将其更改回来。如果您不能弄乱原始程序，请复制并编辑副本。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-04-20T14:40:25.457

我构建了一些存储过程，允许您查询在另一个会话中创建的临时表的内容。

请参阅github 上的[sp_select](https://github.com/FilipDeVos/sp_select)项目。

`exec sp_select 'tempdb..#temp'`无论从哪个会话运行，都可以显示表格的内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-01-03T22:27:22.667

底线：默认的 Visual Studio Microsoft 调试器与正在执行和调试的 SQL 代码不在同一个会话中。

因此，您只能通过将 #temp 表切换到全局 ##temp 表或永久表或您最喜欢跨会话工作的任何技术来查看它们。

注意：这与普通语言调试器非常不同......我怀疑微软故意保持这种方式......几十年前我见过第三方 SQL 调试器工具没有这个问题。

调试器不能与您的 SQL 代码在同一个会话中没有充分的技术原因，因此允许您检查所有生成的结构，包括 #temp 表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T08:42:21.657

这对我有帮助。

```
SELECT * FROM #Name

USE [TEMPDB]
GO

SELECT * FROM syscolumns 
   WHERE id = ( SELECT id FROM sysobjects WHERE [Name] LIKE '#Name%') 
```

这给出了所有临时表的详细信息

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T09:00:08.943

要扩展先前将数据放入永久表的建议，您可以尝试以下操作：

```
-- Get rid of the table if it already exists
if object_id('TempData') is not null
  drop table TempData

select * into TempData from #TempTable 
```

# windows - 如何编写检查 OpenGL 支持的安装程序？

> ID：126028
> 
> 赞同：6
> 
> 时间：2008-09-24T08:29:02.560
> 
> 标签：windows, opengl, windows-installer

我们有一个使用 OpenGL 的 3D 查看器，但我们的客户有时会抱怨它“不工作”。我们怀疑这些问题大多源于他们试图在商务笔记本电脑上使用现代 3D 实时游戏。

**我们如何在我们使用的 windows msi 安装程序中检查对 openGL 的支持？**

附带说明一下，如果您能回答“支持 OpenGL 的显卡列表？”，那也太好了。奇怪的是谷歌在这里没有帮助..

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-24T11:17:37.070

取决于客户所说的“不工作”是什么意思。它可能是以下之一：

1.  它根本不安装/启动，因为缺少一些 OpenGL 支持。
2.  它启动，但进一步崩溃。
3.  它启动，不会崩溃，但渲染已损坏。
4.  它启动并正确渲染所有内容，但性能非常糟糕。

所有 Windows 版本（自 95 起）都内置了 OpenGL 支持。因此不太可能导致上述情况 1)，除非您的应用程序*需要*更高的 OpenGL 版本。

但是，默认的 OpenGL 实现是带有*软件渲染*的 OpenGL 1.1 。如果用户没有手动安装支持 OpenGL 的驱动程序（从 NVIDIA/AMD/Intel 站点下载的任何驱动程序都将具有 OpenGL），他们将默认使用这种缓慢且旧的实现。这很可能导致上述情况 3) 和 4)。

即使 OpenGL 可用，在 Windows 上，OpenGL 驱动程序也不是很健壮，说得客气一点。驱动程序中的各种错误很可能导致情况 2)，在这种情况下，执行有效的操作会导致驱动程序崩溃。

这是一个 C++/WinAPI 代码片段，它创建一个虚拟 OpenGL 上下文并检索信息（GL 版本、显卡名称、扩展名等）：

```
// setup minimal required GL
HWND wnd = CreateWindow(
    "STATIC",
    "GL",
    WS_OVERLAPPEDWINDOW | WS_CLIPSIBLINGS | WS_CLIPCHILDREN,
    0, 0, 16, 16,
    NULL, NULL,
    AfxGetInstanceHandle(), NULL );
HDC dc = GetDC( wnd );

PIXELFORMATDESCRIPTOR pfd = {
    sizeof(PIXELFORMATDESCRIPTOR), 1,
    PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL,
    PFD_TYPE_RGBA, 32,
    0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0,
    16, 0,
    0, PFD_MAIN_PLANE, 0, 0, 0, 0
};

int fmt = ChoosePixelFormat( dc, &pfd );
SetPixelFormat( dc, fmt, &pfd );

HGLRC rc = wglCreateContext( dc );
wglMakeCurrent( dc, rc );

// get information
const char* vendor = (const char*)glGetString(GL_VENDOR);
const char* renderer = (const char*)glGetString(GL_RENDERER);
const char* extensions = (const char*)glGetString(GL_EXTENSIONS);
const char* version = (const char*)glGetString(GL_VERSION);

// DO SOMETHING WITH THOSE STRINGS HERE!

// cleanup
wglDeleteContext( rc );
ReleaseDC( wnd, dc );
DestroyWindow( wnd ); 
```

您可以以某种方式将该代码插入您的安装程序或应用程序，并至少检查 GL 版本是否为 1.1；这将检测“未安装驱动程序”的情况。要解决实际的 OpenGL 驱动程序错误，您必须找出并解决它们。很多工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T08:49:39.063

自 Windows NT 或 Win95 以来，OpenGL 是 Windows 的一部分。您不太可能找到未预装 OpenGL 的 Windows 系统（例如 Windows 3.1）

但是，您的应用程序可能需要更新版本的 OpenGL，而不是非常旧的 Windows 版本附带的默认 OpenGL 1.1。你可以从你的程序中检查。我不知道如何从 msi 中找到它。

请注意，OpenGL 是通过图形驱动程序更新的，而不是通过安装服务包等。

关于启用 OpenGL 的显卡：所有显卡都有 OpenGL。即使客户使用石器时代的 ISA ET4000 显卡，他也至少拥有通过软件渲染的 OpenGL 1.1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T05:52:44.057

Windows 附带对 OpenGL 1.1 的支持（正如其他人在此处指出的那样）。因此，您的用户面临的问题是由于 1.1 之后添加到 OpenGL 的扩展。如果您使用的是 GLEW 库，则很容易以编程方式检查对您正在使用的所有扩展的支持。以下是检查遮挡查询支持的方法：

```
if (GLEW_OK != glewInit())
{
    // GLEW failed!
    exit(1);
}

// Check if required extensions are supported
if (!GLEW_ARB_occlusion_query)
    cout << "Occlusion query not supported" << endl; 
```

有关使用 GLEW 的更多信息，请参见[此处](https://stackoverflow.com/questions/17370/using-glew-to-use-opengl-extensions-under-windows)。

# c - 在编译时检查堆栈使用情况

> ID：126036
> 
> 赞同：31
> 
> 时间：2008-09-24T08:30:33.167
> 
> 标签：c, compiler-construction, callstack

有没有办法在 C 编译时知道并输出函数所需的堆栈大小？这是我想知道的：

让我们采取一些功能：

```
void foo(int a) {
    char c[5];
    char * s;
    //do something
    return;
} 
```

编译此函数时，我想知道调用它时会消耗多少堆栈空间。这对于检测隐藏大缓冲区的结构的堆栈声明可能很有用。

我正在寻找可以打印这样的东西：

文件 foo.c : 函数 foo 堆栈使用是`n`字节

有没有办法不查看生成的程序集来知道这一点？或者可以为编译器设置的限制？

更新：我不是试图避免给定进程的运行时堆栈溢出，我正在寻找一种在运行前查找的方法，如果编译器确定的函数堆栈使用情况可用作编译过程的输出。

让我们换一种说法：是否有可能知道函数本地所有对象的大小？我猜编译器优化不会是我的朋友，因为一些变量会消失，但一个更好的限制是好的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T08:59:27.627

Linux 内核代码在 x86 上的 4K 堆栈上运行。因此他们关心。他们用来检查的是他们编写的 perl 脚本，您可以在最近的内核 tarball 中找到它作为 scripts/checkstack.pl（2.6.25 有它）。它在 objdump 的输出上运行，使用文档在初始注释中。

我想我很久以前就已经将它用于用户空间二进制文件了，如果你知道一点 perl 编程，如果它坏了，很容易修复它。

无论如何，它基本上所做的就是自动查看 GCC 的输出。内核黑客编写了这样一个工具的事实意味着没有静态的方式来使用 GCC（或者它可能是最近添加的，但我对此表示怀疑）。

顺便说一句，使用 mingw 项目中的 objdump 和 ActivePerl，或者使用 Cygwin，您应该能够在 Windows 以及使用其他编译器获得的二进制文件上执行此操作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-24T10:58:06.273

StackAnlyser 似乎检查了可执行代码本身以及一些调试信息。[这个回复](https://stackoverflow.com/questions/126036/checking-stack-usage-at-compile-time#126439)所描述的是我正在寻找的东西，堆栈分析器对我来说看起来有点矫枉过正。

类似于 ADA 存在的东西就可以了。从 gnat 手册中查看此手册页：

22.2 静态栈使用分析

使用 -fstack-usage 编译的单元将生成一个额外的文件，该文件指定每个函数使用的最大堆栈量。该文件与目标对象文件具有相同的基本名称，扩展名为 .su。该文件的每一行由三个字段组成：

```
* The name of the function.
* A number of bytes.
* One or more qualifiers: static, dynamic, bounded. 
```

第二个字段对应于函数帧的已知部分的大小。

限定符 static 意味着函数帧大小是纯静态的。这通常意味着所有局部变量都具有静态大小。在这种情况下，第二个字段是函数堆栈利用率的可靠度量。

限定符动态意味着函数帧大小不是静态的。它主要发生在某些局部变量具有动态大小时。当这个限定符单独出现时，第二个字段不是函数堆栈分析的可靠度量。当它有界时，意味着第二个字段是函数堆栈利用率的可靠最大值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-24T10:44:15.560

我不明白为什么静态代码分析不能为此提供足够好的数字。

在任何给定函数中查找所有局部变量是微不足道的，并且每个变量的大小可以通过 C 标准（对于内置类型）或通过计算它（对于结构和联合等复杂类型）来找到。

当然，不能保证答案是 100% 准确的，因为编译器可以进行各种优化，例如填充、将变量放入寄存器或完全删除不必要的变量。但它给出的任何答案至少应该是一个很好的估计。

我做了一个快速的谷歌搜索，发现[了 StackAnalyzer](http://www.absint.com/stackanalyzer/)，但我猜其他静态代码分析工具也有类似的功能。

如果您想要一个 100% 准确的数字，那么您必须查看编译器的输出或在运行时检查它（就像 Ralph 在[他的回复](https://stackoverflow.com/questions/126036/checking-stack-usage-at-compile-time#126246)中建议的那样）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T08:34:48.663

只有编译器才会真正知道，因为它是把你所有的东西放在一起的人。您必须查看生成的程序集并查看序言中保留了多少空间，但这并不能真正说明`alloca`在运行时执行它们的操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T11:03:48.647

假设您在嵌入式平台上，您可能会发现您的工具链在这方面有所作为。良好的商业嵌入式编译器（例如 Arm/Keil 编译器）通常会生成堆栈使用报告。

当然，中断和递归通常有点超出它们的范围，但是如果有人在堆栈上的某个地方使用数兆字节的缓冲区犯了一些可怕的错误，它会给你一个粗略的想法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T11:39:20.637

不完全是“编译时间”，但我会将此作为构建后步骤：

*   让链接器为您创建一个映射文件
*   对于map文件中的每个函数，读取可执行文件的对应部分，并分析函数序言。

这类似于 StackAnalyzer 所做的，但要简单得多。我认为分析可执行文件或反汇编是获得编译器输出的最简单方法。虽然编译器在内部知道这些东西，但恐怕您无法从中获得它（您可能会要求编译器供应商实现该功能，或者如果使用开源编译器，您可以自己做或让别人做为你）。

要实现这一点，您需要：

*   能够解析地图文件
*   理解可执行文件的格式
*   知道函数序言的样子并能够“解码”它

这将是多么容易或困难取决于您的目标平台。（嵌入式？哪个 CPU 架构？什么编译器？）

所有这些都可以在 x86/Win32 中完成，但如果您从未做过类似的事情并且必须从头开始创建所有这些，则可能需要几天时间才能完成并让某些东西正常工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T09:43:05.597

一般不会。理论计算机科学中的停止问题表明，您甚至无法预测通用程序是否会在给定输入上停止。计算用于程序运行的堆栈通常会更加复杂。所以不行。也许在特殊情况下。

假设您有一个递归函数，其递归级别取决于可以是任意长度的输入，而您已经不走运了。

# delphi - Delphi 2009 + Unicode + 字符大小

> ID：126044
> 
> 赞同：6
> 
> 时间：2008-09-24T08:33:07.527
> 
> 标签：delphi, unicode, delphi-2009

我刚拿到 Delphi 2009，之前读过一些关于由于切换到 Unicode 字符串而可能需要修改的文章。大多数情况下，提到 sizeof(char) 不再保证为 1。但是为什么这对于字符串操作会很有趣呢？

例如，如果我使用 AnsiString:='Test' 并对 String （现在是 unicode）执行相同的操作，那么我得到 Length() = 4 这两种情况都是正确的。在没有对其进行测试的情况下，我确信所有其他字符串操作函数的行为方式都相同，并在内部决定参数是 unicode 字符串还是其他任何东西。

如果我进行字符串操作，为什么我会对 char 的实际大小感兴趣？（当然，如果我使用字符串作为字符串而不存储任何其他数据）

谢谢你的帮助！霍尔格

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T16:20:03.350

使用 Unicode *SizeOf(SomeChar) <> Length(SomeChar)*。本质上，**字符串**的长度小于其**char**大小的总和。只要您不假设*SizeOf(Char) = 1*或*SizeOf(SomeString[x]) = 1*（因为现在两者都是**FALSE**）或尝试将**byte**与**char**互换，那么您应该没有任何麻烦. 任何你在做一些创造性的事情的地方**Byte** s 到**Char** s 或**String** s 中，那么你将需要使用**AnsiString**。

（无论长度如何，SizeOf(SomeString) 仍然是 4，因为它本质上是一个具有一些编译器魔法的指针。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T12:26:00.777

人们经常在旧的 Delphi 代码中隐式地从字符转换为字节，而没有真正考虑过。例如，写入流时。当您将字符串写入流时，您必须指定写入的字节数，但人们通常会传递字符数。有关另一个示例，请参见[Chris Bensen 的这篇文章。](http://chrisbensen.blogspot.com/2007/11/unicode-sizeof-is-different-than-length.html)

人们经常进行这种隐式转换和旧代码的另一种方法是使用“字符串”来存储二进制数据。在这种情况下，他们实际上需要字节，但数据类型需要字符。D2009 有[一个更好的类型](http://chrisbensen.blogspot.com/2008/01/unicode-sizeofchar-and-sizeofbyte.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T08:48:57.270

我没有尝试过 Delphi 2009，但正在使用 fpc，它也在缓慢地切换到 unicode。我 95% 确信以下所有内容也适用于 Delphi 2009

在 fpc 中（当支持 unicode 时），像 'length' 这样的函数会考虑到代码页。因此，它将返回字符串的长度，因为“人类”会看到它。如果有 - 例如 - 两个中文字符，它们都占用 unicode 中的两个字节内存，则长度将返回 2，因为字符串中有两个字符。但该字符串将占用 4 个字节的内存。（+引用计数和前导#0的内存，但除此之外）

你不能再做的是：

```
var p : pchar;
begin
  p := s[1];
  for i := 0 to length(string)-1 do
    begin
    write(p);
    inc(p);
    end;      
end; 
```

因为这段代码——在两个汉字的例子中——写错了两个字符。即作为第一个“真实”字符一部分的两个字节。

简而言之：Length() 不再返回为字符串分配的字节数，而是返回字符数。（在切换到 unicode 之前，这两个值是相等的）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T08:43:32.057

字符的实际大小无关紧要，除非您在字节级别进行操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T08:45:49.323

> （当然，如果我使用字符串作为字符串而不存储任何其他数据）

这是关键点，您不会将字符串用于其他目的，但有些人会这样做。他们像数组一样使用字符串，所以他们（包括我在内）需要检查所有这些用途以确保没有任何东西被破坏......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T13:11:35.253

不要忘记，有时这种转换并不是真正需要的。例如，将 GUID 存储在记录中。guid 只能包含十六进制字符加上 - 和括号......使它们占用两倍的空间会对现有代码产生相当大的影响。当然，简单的解决方案是将它们更改为 AnsiString，并在对它们进行任何字符串操作时处理编译器警告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-28T06:38:34.180

如果您进行 Windows API 调用，这可能是一个问题。或者，如果您有使用**inc**或**dec** of **str[0]**来更改其长度的遗留代码。

# asp.net - 如何在 Web App 和 Windows 窗体应用程序之间进行交互

> ID：126048
> 
> 赞同：5
> 
> 时间：2008-09-24T08:34:57.647
> 
> 标签：asp.net, winforms, web-applications

我有一个问题，Web 应用程序需要（在用户通过 Javascript 交互之后）
   1）打开 Windows 窗体应用程序
   2）向应用程序发送参数（例如 ID）

相应地，Windows 窗体应用程序应该能够
   1）将参数发送回 Web 应用程序（更新 URL 是可以的）
   2）在新的浏览器中打开 Web 应用程序，如果它不存在
如果打开了许多浏览器窗口，这很重要正确的更新。

Windows 窗体应用程序在 ASP.NET 中
浏览器是 IE6+
应用程序是受特定组织内部控制的，因此这不是启动自定义应用程序的问题。

问题 A）这可能吗？
问题 B) 如何从 Web 应用程序向打开的 Windows 窗体应用程序发送参数？
问题 C) 如果更新 Web App，我如何确保目标浏览器正确？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T08:44:32.773

你要求的是可能的，但似乎很尴尬。

出于安全考虑，您不能尝试从网页调用应用程序。但是，您可以创建一个与特定类型文件关联的桌面应用程序，然后在网页上使用 content-type 以确保在打开具有此类型的 URL 时调用您的应用程序。它类似于 MS Office 处理 .doc 或 .xls 文档或媒体播放器打开 .mp3 或 .wmv 文件的方式。

第二部分（从您的应用程序打开特定网页）更容易。您应该知道网页的地址，使用您想要的参数创建一个 URL 字符串并在默认浏览器中打开它（有很多关于如何做到这一点的示例，下面是一个示例）。

```
System.Diagnostics.Process.Start("http://example.com?key=value"); 
```

如果您想在已经打开的浏览器中更新页面或使用您选择的浏览器（即始终使用 IE6 而不是 Opera 或 Chrome），那么您必须做一些功课，但这仍然很容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T22:31:19.970

[PokeIn](http://pokein.com)库将您的桌面应用程序实时/每个用户连接到您的 Web 应用程序。此外，由于其反向 ajax 状态管理，您可以将两个应用程序视为一个应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T08:53:53.030

查看 [http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx](http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx)

在您的网页中使用 VBScript，您可以调用打开的 Windows 窗体应用程序并向其发送密钥。

这仅适用于 IE，您需要调整安全设置以允许 ActiveX。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T15:44:23.653

查看“注册协议”（例如[此处](http://kb.mozillazine.org/Register_protocol)和[此处](http://en.wikipedia.org/wiki/Protocol_(computing))）。我知道 Skype 这样做是为了从网页拨打电话。但可能需要在 win 应用程序中进行一些更改以拦截来自 url 的参数。
我还没有尝试过，但它应该是可能的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T22:59:24.957

虽然这可能不完全适合您的应用程序，但使用 Web 服务和表单呢？

此外，您可以传递参数以确保打开 IE6，而不是 Firefox。

```
System.Diagnostics.Process.Start("c:\ie6\ie6.exe http://www.example.com/mypage"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T12:35:28.197

好的，所以我实际上找到了 web -> winform 部分的线索。

以下代码是从一个将参数发送到 winform 应用程序的 Web 应用程序交给我的。我认为这个解决方案有一些安全因素在起作用（例如允许在网页中运行 VBScript（和 ActiveX？）。不过这对我来说没问题。

编码：

`<script type="text/vbscript" language="vbscript">
<!--
Function OpenWinformApp(chSocialSecurityNumber)
Dim oWinformAppWebStart
Set oWinformAppWebStart = CreateObject("WinformAppWebStart.CWinformAppWebStart")
oWinformAppWebStart.OpenPersonForm CStr(chSocialSecurityNumber)
End Function
-->
</script>`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T08:41:35.527

不，我不认为这是可能的。
想想病毒/木马/间谍软件。如果可以从单纯的 HTML 页面启动应用程序，那么安装恶意软件将非常容易。
浏览器旨在防止您这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T08:42:18.067

您可以使用 clickonce 来部署和启动表单应用程序 - 这应该负责将参数发送到应用程序。

# java - 避免在 Eclipse 关闭后重新发布 Web 应用程序

> ID：126063
> 
> 赞同：1
> 
> 时间：2008-09-24T08:43:47.220
> 
> 标签：java, eclipse, web-applications, eclipse-3.2

我将我的 Web 应用程序部署在 Tomcat5.5 上，并将它与 eclipse 3.2 集成使用。每次关闭 eclipse 并重新启动它时，即使它没有被修改，我也需要重新发布应用程序。

有没有办法避免这个或我错过的任何步骤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T06:10:40.257

转到 Preferences->Server->Launching 。删除选项“启动服务器时自动发布”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T19:20:46.527

我认为 adij.wordpress.com 正确地确定了这一点。如果您发现在开发应用程序时要花费大量时间等待 Tomcat 重新启动，请考虑改用 Jetty。它将在 Tomcat 的一小部分时间内重新启动，并提供了一个功能齐全的替代方案，非常适合敏捷开发。

我们使用带有多个 EAR 文件的 Glassfish（基于 Tomcat），它的开发速度很慢，因此每个 EAR 项目都包含一个 Jetty 启动器，该启动器只是为开发人员当时正在处理的单个 WAR 启动。如果您使用 IntelliJ，这可以自动进行，以便在单击浏览器并刷新页面所需的时间内，应用程序任何层的更改都可以立即反映到当前运行的应用程序中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T15:36:00.663

由于这是一个相当古老的问题，并且仍然没有得到答复，我想用这个答案扩大范围：

我认为您有理由想要取消我不知道的应用程序的重新发布（除了对正在完成的不必要工作的厌恶）

我唯一能猜到的是它需要大量的时间。对我来说，出版时间从来都不是问题，但如果它们适合你，你可能会考虑

*   增加内存（如果交换虚拟内存会减慢重新发布的速度） - 例如购买新 RAM
*   优化项目中的依赖关系，例如，如果有大量依赖项目，则预先打包依赖项目，或者如果只有一个大型项目，则创建子项目并依赖它们。（假设这些因素中的任何一个都会减慢重新发布的速度。我没有测量过）
*   使用 Tomcat6 或 glassfish 有帮助吗？

可能不是发布是您的问题，而是启动时间。通过非常严格地控制，您可能会获得很多收益，例如在 Web 应用程序启动后按需启动服务。我知道有几个应用程序在启动期间会做一些繁重的工作（在它们接受第一个连接之前，并且在它们将控制权传递给下一个可能执行相同操作的应用程序启动之前）。我恨他们。通常这样的服务会得到很多脏话，最后是他们自己的网络/应用程序服务器。必须重新启动其中一个应用程序至少不会使所有其他应用程序（及其用户）受到影响，这些应用程序在编写时考虑到了良好的启动时间。

如果您的问题仍然存在并且您仍在寻找解决方案，请发表评论。你的重新发布时间是什么时候？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T11:03:12.893

eclipse 3.3 或 3.4 或更高版本的 WTP 对您而言是否具有相同的行为方式？

# asp.net - 您将如何通过电子邮件实现数据库更新？

> ID：126068
> 
> 赞同：3
> 
> 时间：2008-09-24T08:44:54.457
> 
> 标签：asp.net, database, email

我正在建立一个公共网站，它有自己的域名和 pop/smtp 邮件服务。我正在考虑让用户选择通过电子邮件更新他们的数据——类似于 Flickr 或 Blogger 中的功能，您可以将帖子通过电子邮件发送到一个特殊的电子邮件地址。然后处理电子邮件数据并将其存储在网站的基础数据库中。

我正在使用 ASP.NET 和 SQL Server 并使用共享托管服务。有什么想法可以实现这一点，或者甚至可以使用共享主机吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T08:49:11.203

对于初学者，您需要拥有允许您创建包罗万象的邮箱的主机。

其次，您需要一个好的 POP3 或 IMAP 库，它不包含在 .NET 堆栈中的 AFAIK。

然后，您将编写一个命令行应用程序或一个定期检查邮箱、提取消息、根据“收件人”地址（每个用户都是唯一的）在数据库中插入内容的服务，然后从邮箱中删除电子邮件。

这是可行的，听起来很有趣。在开始之前，请确保您拥有所需的一切！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T10:20:56.287

如果数据有些“关键”，或者至少中等重要，请不要使用他们的用户名作为“更改数据地址”。示例：您可能想创建一个类似的地址`username@domain.com`，但`username-randomnumer@domain.com`如果访问网页，则使用您给他们随机数的地方。这样人们就不能仅仅通过知道他们的用户名来更新其他人的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T08:47:05.980

电子邮件可以轻易伪造。如果您可以在您的应用程序中处理 PGP / SMime 证书，我只会这样做。

除此之外，我认为没有理由不这样做！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T08:51:13.193

使用 dotnet popclient 读取传入的电子邮件，根据您的期望解析它们并将数据插入数据库。

有关简单的 popclient 实现，请参见 codeproject 网站，您必须自己决定电子邮件内容，例如仅数据、sql 语句的有效负载等

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T08:53:23.063

您还可以根据发件人地址识别用户。这就是[Tripit](http://www.tripit.com/)（可能还有其他人）的做法。这只需要您的一个电子邮件地址。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T05:23:38.343

我做了类似的事情，使用[Lumisoft 的 IMAP 客户端](http://www.lumisoft.ee/lsWWW/Download/Downloads/Net/)并在我的应用程序中安排一个任务，每隔 x 分钟检查一次配置的邮件地址是否有更新。对于调度，我推荐[quartz.net](http://quartznet.sourceforge.net/)。没有启动外部进程或任何东西。

# perl - 解码 UTF8 电子邮件标头

> ID：126070
> 
> 赞同：25
> 
> 时间：2008-09-24T08:45:35.703
> 
> 标签：perl, email, utf-8, header

我有一个表单的电子邮件主题：

```
=?utf-8?B?T3.....?= 
```

电子邮件的正文是 utf-8 base64 编码的 - 并且解码得很好。我目前正在使用 Perl 的 Email::MIME 模块来解码电子邮件。

=?utf-8 分隔符的含义是什么？如何从该字符串中提取信息？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-09-24T08:51:41.087

[`encoded-word`](http://en.wikipedia.org/wiki/MIME#Encoded-Word)令牌（根据RFC [2047](http://www.faqs.org/rfcs/rfc2047.html)）可以出现在某些标头的值中。它们被解析如下：

```
=?<charset>?<encoding>?<data>?= 
```

在这种情况下，字符集是 UTF-8，编码是`B`base64（另一个选项是`Q`Quoted Printable）。

要读取它，首先解码 base64，然后将其视为 UTF-8 字符。

另请阅读各种 Internet 邮件 RFC 以获取更多详细信息，主要是[RFC 2047](http://www.faqs.org/rfcs/rfc2047.html)。

由于您使用的是 Perl，因此[Encode::MIME::Header](https://metacpan.org/pod/Encode::MIME::Header)可能有用：

> 概要
> 
> ```
> use Encode qw/encode decode/;
> $utf8   = decode('MIME-Header', $header);
> $header = encode('MIME-Header', $utf8); 
> ```
> 
> 抽象的
> 
> 这个模块实现了 RFC 2047 Mime Header Encoding。有 3 个变体编码名称；MIME-标头、MIME-B 和 MIME-Q。区别如下所述
> 
> ```
>  decode()          encode()  
> MIME-Header   Both B and Q      =?UTF-8?B?....?=  
> MIME-B        B only; Q croaks  =?UTF-8?B?....?=  
> MIME-Q        Q only; B croaks  =?UTF-8?Q?....?= 
> ```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-24T08:57:18.453

我认为 Encode 模块使用编码处理它`MIME-Header`，所以试试这个：

```
use Encode qw(decode);
my $decoded = decode("MIME-Header", $encoded); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T08:55:50.203

查看[RFC2047](http://www.faqs.org/rfcs/rfc2047.html)。'B' 表示最后两个 '?' 之间的部分是 base64 编码的。'utf-8' 自然意味着解码后的数据应该被解释为 UTF-8。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-21T02:07:15.890

[MIME-tools 中的 MIME::Words](https://metacpan.org/pod/MIME::Words)也适用于此。我遇到了 Encode 的一些问题，发现 MIME::Words 在 Encode 没有的某些字符串上成功。

```
use MIME::Words qw(:all);
$decoded = decode_mimewords(
    'To: =?ISO-8859-1?Q?Keld_J=F8rn_Simonsen?= <keld@dkuug.dk>',
); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T08:55:55.430

这是标头字符集标签的标准扩展，在[RFC2047](http://www.rfc-archive.org/getrfc.php?rfc=2047)中指定。

# java - 模块化网络应用

> ID：126073
> 
> 赞同：31
> 
> 时间：2008-09-24T08:46:05.233
> 
> 标签：java, web-applications, jsf, modularity

我最近一直在研究[OSGi](http://www.osgi.org/Main/HomePage)，并认为它对于模块化 Java 应用程序来说是一个非常好的主意。

但是，我想知道 OSGi 将如何在 Web 应用程序中工作，您不仅需要担心代码——还有 HTML、图像、CSS 之类的东西。

在工作中，我们正在构建一个具有多个“选项卡”的应用程序，每个选项卡都是应用程序的一部分。我认为这可以从采用 OSGi 方法中真正受益——但是我真的不确定处理所有常用 Web 应用程序资源的最佳方法是什么。

我不确定它是否有任何区别，但我们正在使用 JSF 和[IceFaces](http://www.icefaces.org)（这增加了另一层问题，因为您有导航规则，并且您必须在 web.xml 中指定所有面孔配置文件...... doh！ )

编辑：根据[这个线程](http://forums.sun.com/thread.jspa?messageID=3339002)，可以从 JAR 文件中加载 faces-config.xml 文件 - 所以实际上可以在不修改 web.xml 的情况下包含多个 faces-config.xml 文件，前提是您将其拆分为 JAR 文件。

任何建议将不胜感激 ：-）

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-24T09:47:43.137

您认为这里有协同作用是非常正确的，我们有一个模块化的 Web 应用程序，其中应用程序本身由独立组件（OSGi 包）自动组装，其中每个包都贡献自己的页面、资源、css 和可选的 javascript。

我们不使用 JSF（此处为 Spring MVC），因此我无法评论该框架在 OSGi 上下文中增加的复杂性。

大多数框架或方法仍然坚持“旧”的思维方式：一个 WAR 文件代表您的 webapp，然后是许多 OSGi 包和服务，但几乎没有人关心 GUI 本身的模块化。

## 设计的先决条件

使用 OSGi，首先要解决的问题是：您的部署场景是什么？谁是主容器？我的意思是，您可以在 OSGi 运行时上部署您的应用程序，并将其基础设施用于一切。或者，您可以在传统的应用服务器中嵌入 OSGi 运行时，然后您将需要重用一些基础设施，特别是您想使用 AppServer 的 servlet 引擎。

我们的设计目前基于 OSGi 作为容器，我们使用 OSGi 提供的 HTTPService 作为我们的 servlet 容器。我们正在研究在外部 servlet 容器和 OSGi HTTPService 之间提供某种透明的桥梁，但这项工作正在进行中。

## Spring MVC + OSGi 模块化 webapp 的架构草图

因此，我们的目标不仅仅是通过 OSGi 为 Web 应用程序提供服务，还要将 OSGi 的组件模型应用于 Web UI 本身，使其可组合、可重用和动态。

这些是系统中的组件：

*   1 个中央包，负责将 Spring MVC 与 OSGi 桥接，特别是它使用[Bernd Kolb](http://thegoodthebadtheugly.wordpress.com/2007/05/20/springosgi/)的代码允许您将 Spring DispatcherServlet 与 OSGi 注册为 servlet。
*   1 个自定义 URL 映射器，它被注入 DispatcherServlet 并提供传入 HTTP 请求到正确控制器的映射。
*   1 个基于 Sitemesh 的中央装饰器 JSP，它定义了站点的全局布局，以及我们希望作为默认值提供的中央 CSS 和 Javascript 库。
*   每个想要为我们的 Web UI 贡献页面的包都必须发布 1 个或多个控制器作为 OSGi 服务，并确保向OSGi HTTPService**注册自己的 servlet 和自己的资源（CSS、JSP、图像等）**。注册是通过 HTTPService 完成的，关键方法是：

    httpService.registerResources() 和 httpService.registerServlet()

当一个 web ui 贡献包激活并发布它的控制器时，它们会被我们的中央 web ui 包自动拾取，并且前面提到的自定义 URL 映射器收集这些控制器服务并保持到控制器实例的 URL 的最新映射。

然后，当某个 URL 的 HTTP 请求进入时，它会找到关联的控制器并在那里分派请求。

控制器执行它的业务，然后返回任何应该呈现的数据**和**视图的名称（在我们的例子中是一个 JSP）。这个 JSP 位于 Controller 的 bundle 中，并且可以被中央 web ui bundle 访问和呈现，因为我们已经使用 HTTPService 注册了资源位置。然后，我们的中央视图解析器将此 JSP 与我们的中央 Sitemesh 装饰器合并，并将生成的 HTML 输出给客户端。

知道这是相当高的水平，但如果不提供完整的实现，很难完全解释。

我们的关键学习点是查看[Bernd Kolb 对](http://thegoodthebadtheugly.wordpress.com/2007/05/20/springosgi/)他的示例 JPetstore 转换为 OSGi 所做的工作，并使用该信息来设计我们自己的架构。

恕我直言，目前有太多的炒作和专注于让 OSGi 以某种方式嵌入到传统的基于 Java EE 的应用程序中，而很少考虑实际利用 OSGi 惯用语及其出色的组件模型来真正允许组件化 Web 应用程序的设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T20:51:50.060

查看[SpringSource dm Server](http://www.springsource.org/dmserver) - 一个完全根据 OSGi 构建并支持模块化 Web 应用程序的应用程序服务器。它提供免费、开源和商业版本。

您可以从部署标准 WAR 文件开始，然后逐渐将您的应用程序分解为 OSGi 模块，或 OSGi 中的“捆绑包”。正如您对 SpringSource 所期望的那样，该服务器对 Spring 框架和相关的 Spring 组合产品具有出色的支持。

免责声明：我在这个产品上工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T13:10:55.907

请注意 Spring DM 服务器[许可](http://www.springsource.com/products/dmserver/licensingfaq)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T11:56:39.113

我们一直在使用带有 OSGi 的[Restlet](http://www.restlet.org/)，通过嵌入式 Http 服务取得了良好的效果（实际上它是 Jetty，但也可以使用 tomcat）。

Restlet 有零到最小的 XML 配置需求，我们所做的任何配置都在 BundleActivator 中（注册新服务）。

在构建页面时，我们只是处理相关的服务实现以生成输出，装饰器样式。插入的新包将在下次呈现时添加新的页面装饰/小部件。

REST 为我们提供了干净且有意义的 URL，相同数据的多种表示形式，并且似乎是一个可扩展的隐喻（动词很少，名词很多）。

对我们来说，一个额外的功能是对缓存的广泛支持，特别是 ETag。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-05T12:22:58.393

SpringSource 似乎正在开发一个有趣的模块化 Web 框架，该框架构建在 OSGi 之上，称为**SpringSource Slices**。更多信息可以在以下博客文章中找到：

*   [使用 SpringSource 切片的模块化 Web 应用程序](http://blog.springsource.com/2009/06/22/modular-web-applications-with-springsource-slices/)
*   [使用 SpringSource Slices 的可插拔样式](http://blog.springsource.com/2009/07/10/pluggable-styling-with-springsource-slices/)
*   [切片菜单栏截屏](http://blog.springsource.com/2009/08/07/slices-menu-bar-screencast/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T22:31:51.180

看看说唱！[http://www.eclipse.org/rap/](http://www.eclipse.org/rap/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T10:06:39.673

看看[http://www.ztemplates.org](http://www.ztemplates.org)，它简单易学。这个允许您将所有相关的模板、javascript 和 css 放入一个 jar 中并透明地使用它。意味着您甚至不必关心在使用提供的组件时在页面中声明所需的 javascript，因为框架会为您完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T11:01:37.887

一组有趣的帖子。我有一个基于每个客户定制的 Web 应用程序。每个客户都会获得一组核心组件和附加组件，具体取决于他们注册的内容。对于每个版本，我们必须根据客户“组装”正确的服务集并应用正确的菜单配置（我们使用 struts 菜单），这至少可以说是乏味的。基本上它的代码库相同，但我们只是自定义导航以显示或隐藏某些页面。这显然不理想，我们想利用 OSGi 来组件化服务。虽然我可以看到这是如何为服务 API 完成的，并且有点理解 CSS 和 java 脚本和控制器（我们使用 Spring MVC）等资源如何也可以捆绑在一起，但您将如何处理“横切” 页面导航和一般工作流程等问题，尤其是在您想要动态部署新服务并需要向该服务添加导航的情况下。还可能存在其他“跨领域”问题，例如跨越其他服务的服务。谢谢，德克兰。

# c# - 如何获取类型成员的源文件名和行号？

> ID：126094
> 
> 赞同：22
> 
> 时间：2008-09-24T08:54:46.260
> 
> 标签：c#, reflection

考虑到调试数据文件可用 (PDB) 并使用**System.Reflection**或其他类似框架，例如**Mono.Cecil**），如何以编程方式检索源文件名和类型或类型成员所在的行号宣布。

例如，假设您已将此文件编译为程序集：

*C:\MyProject\Foo.cs*

```
1:    public class Foo
2:    {
3:       public string SayHello()
4:       {
5:           return "Hello";
6:       }
7:    } 
```

如何执行以下操作：

```
MethodInfo methodInfo = typeof(Foo).GetMethod("SayHello");
string sourceFileName = methodInfo.GetSourceFile(); // ?? Does not exist!
int sourceLineNumber = methodInfo.GetLineNumber(); // ?? Does not exist! 
```

sourceFileName 将包含“C:\MyProject\Foo.cs”并且 sourceLineNumber 等于 3。

*更新：`System.Diagnostics.StackFrame`确实能够获得该信息，但仅限于当前执行的调用堆栈范围内。这意味着必须首先调用该方法。我想获得相同的信息，但不调用类型成员。*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-30T08:59:32.163

最新方法：

```
private static void Log(string text,
                        [CallerFilePath] string file = "",
                        [CallerMemberName] string member = "",
                        [CallerLineNumber] int line = 0)
{
    Console.WriteLine("{0}_{1}({2}): {3}", Path.GetFileName(file), member, line, text);
} 
```

在运行时填充参数（标有特殊属性）的新`Framework API`功能，请参阅[我对这个 SO 问题的回答](https://stackoverflow.com/questions/6369184/print-the-source-filename-and-linenumber-in-c-sharp/16295702#16295702)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-17T19:10:30.083

使用上面解释的方法之一，在属性的构造函数中，您可以提供可能具有属性的所有内容的源位置 - 例如类。请参见以下属性类：

```
sealed class ProvideSourceLocation : Attribute
    {
        public readonly string File;
        public readonly string Member;
        public readonly int Line;
        public ProvideSourceLocation
            (
            [CallerFilePath] string file = "",
            [CallerMemberName] string member = "",
            [CallerLineNumber] int line = 0)
        {
            File = file;
            Member = member;
            Line = line;
        }

        public override string ToString() { return File + "(" + Line + "):" + Member; }
    }

[ProvideSourceLocation]
class Test
{
   ...
} 
```

例如，您可以编写：

```
Console.WriteLine(typeof(Test).GetCustomAttribute<ProvideSourceLocation>(true)); 
```

输出将是：

```
a:\develop\HWClassLibrary.cs\src\Tester\Program.cs(65): 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-24T09:06:08.493

您可能会通过这些链接找到一些帮助：

[在不部署 PDB 文件的情况下获取文件和行号](http://www.busycode.com/news/index.php/article/news-about-adobe-flex/2008-09-09/1570.html) 也发现了以下[帖子](http://bytes.com/forum/thread348765.html)

“嗨，马克，

以下将为您提供代码的行号（在源文件中）：

```
Dim CurrentStack As System.Diagnostics.StackTrace
MsgBox (CurrentStack.GetFrame(0).GetFileLineNumber) 
```

如果您有兴趣，您可以了解您所在的例程以及所有调用者。

```
Public Function MeAndMyCaller As String
    Dim CurrentStack As New System.Diagnostics.StackTrace
    Dim Myself As String = CurrentStack.GetFrame(0).GetMethod.Name
    Dim MyCaller As String = CurrentStack.GetFrame(1).GetMethod.Name
    Return "In " & Myself & vbCrLf & "Called by " & MyCaller
End Function 
```

如果您想要一个通用的错误例程，这可能非常方便，因为它可以获得调用者的名称（这将是发生错误的地方）。

问候，Fergus MVP [Windows 开始按钮，关机对话框]"

# javascript - 如何有效地计算 JavaScript 中对象的键/属性的数量

> ID：126100
> 
> 赞同：1822
> 
> 时间：2008-09-24T08:56:21.263
> 
> 标签：javascript, performance, properties, count, key

计算对象的键/属性数量的最快方法是什么？是否可以在不迭代对象的情况下做到这一点？即，不做：

```
var count = 0;
for (k in myobj) if (myobj.hasOwnProperty(k)) ++count; 
```

（Firefox 确实提供了一个神奇的`__count__`属性，但它在版本 4 左右被删除了。）

* * *

## 回答 #1

> 赞同：2925
> 
> 时间：2011-02-03T17:47:20.957

要在任何*[ES5](https://en.wikipedia.org/wiki/ECMAScript#5th_Edition)兼容的环境*中执行此操作，例如[Node.js](http://nodejs.org)、Chrome、[Internet Explorer 9+](https://en.wikipedia.org/wiki/Internet_Explorer_9)、Firefox 4+ 或 Safari 5+：

```
Object.keys(obj).length 
```

*   [浏览器兼容性](http://kangax.github.com/es5-compat-table/)
*   [Object.keys 文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)（包括一个可以添加到非 ES5 浏览器的方法）

* * *

## 回答 #2

> 赞同：160
> 
> 时间：2011-04-15T10:48:18.177

您可以使用以下代码：

```
if (!Object.keys) {
    Object.keys = function (obj) {
        var keys = [],
            k;
        for (k in obj) {
            if (Object.prototype.hasOwnProperty.call(obj, k)) {
                keys.push(k);
            }
        }
        return keys;
    };
} 
```

然后你也可以在旧浏览器中使用它：

```
var len = Object.keys(obj).length; 
```

* * *

## 回答 #3

> 赞同：140
> 
> 时间：2011-05-16T15:24:17.140

如果您使用的是[Underscore.js](http://underscorejs.org/) ，您可以使用[_.size](http://underscorejs.org/#size)（[感谢 douwe](https://stackoverflow.com/questions/126100/how-to-efficiently-count-the-number-of-keys-properties-of-an-object-in-javascrip#comment7517359_6019605)）：

```
_.size(obj) 
```

或者，您也可以使用[_.keys](http://underscorejs.org/#keys)，这对某些人来说可能更清楚：

```
_.keys(obj).length 
```

我强烈推荐 Underscore.js。这是一个紧凑的库，可以做很多基本的事情。只要有可能，它们就会匹配[ECMAScript 5](https://en.wikipedia.org/wiki/ECMAScript#5th_Edition)并遵循本机实现。

否则我支持[Avi Flax 的回答](https://stackoverflow.com/questions/126100/how-to-efficiently-count-the-number-of-keys-properties-of-an-object-in-javascrip/4889658#4889658)。我对其进行了编辑以添加指向[MDC](https://en.wikipedia.org/wiki/MDN_Web_Docs)文档的链接，其中包括可以添加到非 ECMAScript 5 浏览器的 keys() 方法。

* * *

## 回答 #4

> 赞同：92
> 
> 时间：2013-05-26T21:39:23.713

标准的对象实现（[ES5.1 对象内部属性和方法](http://www.ecma-international.org/ecma-262/5.1/#sec-8.6.2)）不需要 an`Object`来跟踪其键/属性的数量，因此不应该有标准的方法来确定 an 的大小`Object`而不显式或隐式地迭代其键。

所以这里是最常用的替代方案：

### 1\. ECMAScript 的 Object.keys()

`Object.keys(obj).length;`通过*内部*迭代键来计算临时数组并返回其长度。

*   **优点**- 可读和干净的语法。如果本机支持不可用，则不需要任何库或自定义代码，除非 shim
*   **缺点**- 由于创建数组而导致的内存开销。

### 2\. 基于库的解决方案

本主题其他地方的许多基于库的示例在其库的上下文中都是有用的习语。然而，从性能的角度来看，与完美的无库代码相比，没有任何好处，因为所有这些库方法实际上都封装了 for 循环或 ES5 `Object.keys`（本机或填充）。

### 3.优化for循环

由于函数调用开销，这种 for 循环中最**慢的部分**通常是调用。`.hasOwnProperty()`因此，当我只想要 JSON 对象的条目数时，`.hasOwnProperty()`如果我知道没有代码没有也不会扩展，我就跳过调用 `Object.prototype`。

否则，您的代码可以通过制作`k`本地 ( `var k`) 并使用前缀增量运算符 ( `++count`) 而不是后缀来略微优化。

```
var count = 0;
for (var k in myobj) if (myobj.hasOwnProperty(k)) ++count; 
```

另一个想法依赖于缓存`hasOwnProperty`方法：

```
var hasOwn = Object.prototype.hasOwnProperty;
var count = 0;
for (var k in myobj) if (hasOwn.call(myobj, k)) ++count; 
```

在给定的环境中这是否更快是基准测试的问题。无论如何，可以预期的性能增益非常有限。

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2019-10-21T18:57:32.113

以下是三种方法的一些性能测试；

[https://jsperf.com/get-the-number-of-keys-in-an-object](https://jsperf.com/get-the-number-of-keys-in-an-object)

## Object.keys().length

**每秒 20,735**次操作

它非常简单且兼容，运行速度快*但*成本高，因为它创建了一个新的键数组，然后被丢弃。

```
return Object.keys(objectToRead).length; 
```

## 循环遍历键

**每秒 15,734**次操作

```
let size=0;
for(let k in objectToRead) {
  size++
}
return size; 
```

它稍微慢一些，但与内存使用量相差甚远，因此如果您有兴趣针对移动设备或其他小型机器进行优化，它可能会更好。

## 使用地图而不是对象

**每秒 953,839,338**次操作

```
return mapToRead.size; 
```

基本上，Map 会跟踪它自己的大小，所以我们只返回一个数字字段。它比任何其他方法都快得多。如果您可以控制对象，请将它们转换为地图。

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2008-09-24T09:11:22.273

如果您实际上遇到了性能问题，我建议您使用一个函数包装向对象添加/删除属性的调用，该函数还增加/减少适当命名的（大小？）属性。

您只需要计算一次属性的初始数量并从那里继续。如果没有实际的性能问题，请不要打扰。只需将那段代码包装在一个函数中`getNumberOfProperties(object)`并完成它。

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2018-01-19T09:04:01.127

如上一个答案中所回答：`Object.keys(obj).length`

但是：由于我们现在在 ES6 中有一个真正的[Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)类，我[建议](https://stackoverflow.com/questions/32600157/maps-vs-objects-in-es6-when-to-use)使用它而不是使用对象的属性。

```
const map = new Map();
map.set("key", "value");
map.size; // THE fastest way 
```

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2013-01-17T11:15:44.757

正如[Avi Flax 所说](https://stackoverflow.com/questions/126100/how-to-efficiently-count-the-number-of-keys-properties-of-an-object-in-javascrip/4889658#4889658)，

```
Object.keys(obj).length 
```

将为您的对象上的所有可枚举属性做这个技巧，但也包括不可枚举的属性，您可以改用`Object.getOwnPropertyNames`. 区别如下：

```
var myObject = new Object();

Object.defineProperty(myObject, "nonEnumerableProp", {
  enumerable: false
});
Object.defineProperty(myObject, "enumerableProp", {
  enumerable: true
});

console.log(Object.getOwnPropertyNames(myObject).length); //outputs 2
console.log(Object.keys(myObject).length); //outputs 1

console.log(myObject.hasOwnProperty("nonEnumerableProp")); //outputs true
console.log(myObject.hasOwnProperty("enumerableProp")); //outputs true

console.log("nonEnumerableProp" in myObject); //outputs true
console.log("enumerableProp" in myObject); //outputs true 
```

如此[处所述](http://kangax.github.com/es5-compat-table/)，它具有与`Object.keys`.

但是，在大多数情况下，您可能不想在这些类型的操作中包含不可枚举，但知道它们的区别总是好的；）

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2014-03-30T01:11:04.663

要迭代[Avi Flax 的 answer](https://stackoverflow.com/questions/126100/how-to-efficiently-count-the-number-of-keys-properties-of-an-object-in-javascrip/4889658#4889658)，*Object.keys(obj).length*对于没有与之关联的函数的对象是正确的。

例子：

```
obj = {"lol": "what", owo: "pfft"};
Object.keys(obj).length; // should be 2 
```

相对

```
arr = [];
obj = {"lol": "what", owo: "pfft"};
obj.omg = function(){
    _.each(obj, function(a){
        arr.push(a);
    });
};
Object.keys(obj).length; // should be 3 because it looks like this
/* obj === {"lol": "what", owo: "pfft", omg: function(){_.each(obj, function(a){arr.push(a);});}} */ 
```

避免这种情况的步骤：

1.  不要将函数放在要计算其中键数的对象中

2.  使用单独的对象或专门为函数创建一个新对象（如果您想计算文件中有多少个函数`Object.keys(obj).length`）

另外，是的，我在示例中使用了Node.js 中的`_`or [Underscore.js](https://en.wikipedia.org/wiki/Underscore.js)模块。

可以在[此处](http://underscorejs.org/)找到文档及其在 GitHub 上的来源和各种其他信息。

最后是 lodash 实现[https://lodash.com/docs#size](https://lodash.com/docs#size)

`_.size(obj)`

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2008-09-24T09:13:13.343

我不知道有什么方法可以做到这一点。但是，为了将迭代保持在最低限度，您可以尝试检查是否存在，`__count__`如果它不存在（即不是 Firefox），那么您可以遍历该对象并定义它以供以后使用，例如：

```
if (myobj.__count__ === undefined) {
  myobj.__count__ = ...
} 
```

这样，任何支持的浏览器`__count__`都会使用它，并且只会对那些不支持的浏览器进行迭代。如果计数发生变化而您无法执行此操作，则始终可以将其设为函数：

```
if (myobj.__count__ === undefined) {
  myobj.__count__ = function() { return ... }
  myobj.__count__.toString = function() { return this(); }
} 
```

这样，任何时候你引用 myobj. `__count__`该函数将触发并重新计算。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2015-08-21T03:37:26.703

从*[Object.defineProperty()](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty)*：

> Object.defineProperty(obj, prop, 描述符)

您可以将其添加到所有对象中：

```
Object.defineProperty(Object.prototype, "length", {
    enumerable: false,
    get: function() {
        return Object.keys(this).length;
    }
}); 
```

或单个对象：

```
var myObj = {};
Object.defineProperty(myObj, "length", {
    enumerable: false,
    get: function() {
        return Object.keys(this).length;
    }
}); 
```

例子：

```
var myObj = {};
myObj.name  = "John Doe";
myObj.email = "leaked@example.com";
myObj.length; // Output: 2 
```

以这种方式添加，它不会显示在*for..in*循环中：

```
for(var i in myObj) {
    console.log(i + ": " + myObj[i]);
} 
```

输出：

```
name: John Doe
email: leaked@example.com 
```

注意：它不适用于[Internet Explorer 9](https://en.wikipedia.org/wiki/Internet_Explorer_9)之前的浏览器。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2012-01-04T09:04:06.883

对于那些在项目中包含 Underscore.js 的人，您可以执行以下操作：

```
_({a:'', b:''}).size() // => 2 
```

或功能风格：

```
_.size({a:'', b:''}) // => 2 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2011-06-28T10:04:16.987

我解决这个问题的方法是构建我自己的基本列表实现，该列表记录对象中存储了多少项目。这很简单。像这样的东西：

```
function BasicList()
{
   var items = {};
   this.count = 0;

   this.add = function(index, item)
   {
      items[index] = item;
      this.count++;
   }

   this.remove = function (index)
   {
      delete items[index];
      this.count--;
   }

   this.get = function(index)
   {
      if (undefined === index)
        return items;
      else
        return items[index];
   }
} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-04-12T07:40:14.127

对于那些在他们的项目中有[Ext JS](https://en.wikipedia.org/wiki/Ext_JS) 4 的人，你可以这样做：

```
Ext.Object.getSize(myobj); 
```

这样做的好处是它适用于所有与 Ext JS 兼容的浏览器（包括[Internet Explorer 6](https://en.wikipedia.org/wiki/Internet_Explorer_6) - [Internet Explorer 8](https://en.wikipedia.org/wiki/Internet_Explorer_8)）。但是，与其他建议的解决方案一样，我相信运行时间并不比 O(n) 好。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-02-28T07:09:18.347

**您可以使用：**

```
Object.keys(objectName).length; 
```

和

```
Object.values(objectName).length; 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2022-01-30T12:35:42.830

这适用于数组和对象

```
function count(obj){
        return Object.keys(obj).length
     } 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-06-22T05:21:07.110

OP 没有指定对象是否是 nodeList。如果是，那么您可以直接在其上使用**长度**方法。例子：

```
buttons = document.querySelectorAll('[id=button)) {
console.log('Found ' + buttons.length + ' on the screen'); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-09-02T01:32:01.147

如果先前答案中的 jQuery 不起作用，请尝试

```
$(Object.Item).length 
```

* * *

## 回答 #19

> 赞同：-3
> 
> 时间：2008-09-24T09:05:38.777

我认为这是不可能的（至少在不使用一些内部组件的情况下是不可能的）。我不认为你会通过优化这个获得太多收益。

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2018-04-14T12:51:03.220

我尝试使其可用于所有对象，如下所示：

```
Object.defineProperty(Object.prototype,
                      "length",
                      {
                          get() {
                              if (!Object.keys) {
                                  Object.keys = function (obj) {
                                      var keys = [],k;
                                      for (k in obj) {
                                          if (Object.prototype.hasOwnProperty.call(obj, k)) {
                                              keys.push(k);
                                          }
                                      }
                                      return keys;
                                  };
                              }
                              return Object.keys(this).length;
                      },});

console.log({"Name":"Joe", "Age":26}.length) // Returns 2 
```

# api - EPiServer 开发

> ID：126102
> 
> 赞同：10
> 
> 时间：2008-09-24T08:57:17.627
> 
> 标签：api, sdk, episerver

除了 Episerver.com

使用 EPiServer 开发的人还使用哪些其他网站作为开发资源！？一直在使用 coderesort.com，但我发现它缺少如何做事的例子。

非常感谢，

Ĵ

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-11-22T19:42:37.463

我用于 EPiServer 开发的一般资源：

1.  [EPiServer World](http://world.episerver.com/)：官方开发者社区网站。包括博客和官方文档。
2.  [Joel Abrahamsson 博客](http://joelabrahamsson.com/episerver/)：EPiServer 社区中最受欢迎的 EPi-dev。
3.  [Ted Gustaf 博客](http://tedgustaf.com/blog/)：社区中的另一个知名人士。
4.  [Epinova 博客](http://www.epinova.no/blog/tags/episerver/)：EPiServer 大合作伙伴的博客。
5.  [Mathias Kunto 博客](https://blog.mathiaskunto.com/)：又一个 EPiServer 开发博客。
6.  [Fredrik Haglund 的博客](http://blog.fredrikhaglund.se/)：流行的 EPiServer 开发博客（但已过时）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T11:48:01.530

关于 CodeResort 上缺少的示例，您是否注册并登录？它在 Trac 上运行，这意味着所有模块（提交到托管的 Subversion 存储库）都可以使用完整的源代码，直接浏览。里面有很多代码！

见[https://www.coderesort.com/p/epicode/browser](https://www.coderesort.com/p/epicode/browser)

/史蒂夫

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T21:13:52.477

另一个好地方是[http://labs.episerver.com/](http://labs.episerver.com/)，它将大部分 EPiServer 博客聚集在一个地方。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-08-06T20:24:18.890

您可以在这里找到超过 150 多个 EpiServer 教程：[JonDJones 博客](http://jondjones.com/blog/episerver/)

我的 github 上还有很多 EpiServer 代码，包括几个示例站点：[JonDJones Github](https://github.com/jondjones?tab=repositories)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-25T01:17:41.450

如果您还没有看过[EPiServer World](http://world.episerver.com/)，那么它是一个查看的好地方——尤其是那里的博客。大多数 EPiServer 的东西通常可以在 EPiServer 开发人员博客上找到，例如这个~~[EPiGirl](http://epinz.blogspot.com/)~~（现已删除，但还有*其他*）。

希望这可以帮助，

克里斯

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-29T03:56:07.723

[您总是尝试“秘密”定制的 google 搜索，它在http://labs.episerver.com/google](http://labs.episerver.com/google)上搜索 episerver 博客、论坛和 sdk

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-25T11:59:02.313

哦，忘了，我们还有一个相当活跃的 IRC 频道。

有关 EPiServer Labs 博客的更多信息：

[http://labs.episerver.com/en/Blogs/Steve-Celius/Dates/112266/6/Join-us-on-IRC/](http://labs.episerver.com/en/Blogs/Steve-Celius/Dates/112266/6/Join-us-on-IRC/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-08T09:48:33.767

还有[http://epiwiki.se/](http://epiwiki.se/)但我不知道 Google 搜索找不到任何公共 EPi 资源。谷歌还将从 EPi 世界论坛为您提供良好的结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-05T23:44:58.920

我已经看了很多编辑/管理界面的源代码，它非常有帮助。在您最喜欢的反编译器或 Visual Studio 中的对象资源管理器中浏览库。

# erlang - Mnesia 写入失败

> ID：126109
> 
> 赞同：4
> 
> 时间：2008-09-24T08:59:01.710
> 
> 标签：erlang, mnesia

我定义了一个名为`log`. 我想用 name 创建一个 mnesia 表`log_table`。当我尝试将记录写入表时，`bad_type`出现如下错误：

```
(node1@kitt)4> mnesia:create_table(log_table, [{ram_copies, [node()]}, 
                                               {attributes, record_info(fields, log)}]).
{atomic,ok}

(node1@kitt)5> mnesia:dirty_write(log_table, #log{id="hebelek"}).
** exception exit: {aborted,{bad_type,#log{id = "hebelek"}}}
in function  mnesia:abort/1 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-24T12:51:38.343

默认情况下，假设记录名称与表名称相同。

要解决此问题，您应该只命名您的表格`log`或在表格选项中附加`{record_name, log}`选项（正如您在修复中所做的那样）。

让你的记录和表命名相同通常是一个好习惯，它使代码更易于阅读和调试。然后，您也可以`mnesia:write/1`仅将您的记录用作唯一参数的函数。然后，Mnesia 通过查看名称来确定将记录放入哪个表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T09:35:03.620

我已经找到了。当我将`mnesia:create_table`呼叫更改为此

```
mnesia:create_table(log_table, [{ram_copies, [node()]},
                                {record_name, log},
                                {attributes, record_info(fields, log)}]). 
```

一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T09:24:12.740

您对日志记录的定义如何？如果您从头开始创建一个新表（即首先删除 Mnesia@ 目录），您会得到同样的错误吗？

# java - 在 Borland Starteam server 8 中计算客户端-服务器时间差

> ID：126114
> 
> 赞同：1
> 
> 时间：2008-09-24T09:00:46.370
> 
> 标签：java, time, starteam

**问题**。我需要一种通过 Starteam Java SDK 8.0 查找 Starteam 服务器时间的方法。服务器版本为 8.0.172，因此该方法`Server.getCurrentTime()`不可用，因为它仅在服务器版本 9.0 中添加。

**动机**。我的应用程序需要在特定日期使用视图。因此，如果客户端（运行应用程序的位置）和服务器之间的系统时间存在一些差异，那么获得的视图是不准确的。在最坏的情况下，客户端请求的日期是服务器的未来日期，因此操作会导致异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T14:57:23.780

经过一番调查，我没有找到比使用临时物品更清洁的解决方案。我的应用程序请求项目的创建时间并将其与本地时间进行比较。这是我用来获取服务器时间的方法：

```
public Date getCurrentServerTime() {
    Folder rootFolder = project.getDefaultView().getRootFolder();

    Topic newItem = (Topic) Item.createItem(project.getTypeNames().TOPIC, rootFolder);
    newItem.update();
    newItem.remove();
    newItem.update();
    return newItem.getCreatedTime().createDate();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T19:23:14.610

如果您的 StarTeam 服务器位于 Windows 机器上并且您的代码将在 Windows 机器上执行，您可以执行**NET time**命令来获取该机器上的时间，然后将其与本地时间进行比较。

```
net time \\my_starteam_server_machine_name 
```

应该返回：

```
"Current time at \\my_starteam_server_machine_name is 10/28/2008 2:19 PM"

"The command completed successfully." 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T22:32:50.797

我们需要想出一种方法来查找与 CodeCollab 一起使用的服务器时间。这是一个（较长的）C# 代码示例，说明如何在不创建临时文件的情况下执行此操作。分辨率为 1 秒。

```
 static void Main(string[] args)
    {
        // ServerTime replacement for pre-2006 StarTeam servers.
        // Picks a date in the future.
        // Gets a view, sets the configuration to the date, and tries to get a property from the root folder.
        // If it cannot retrieve the property, the date is too far in the future.  Roll back the date to an earlier time.

        DateTime StartTime = DateTime.Now;

        Server s = new Server("serverAddress", 49201);
        s.LogOn("User", "Password");

        // Getting a view - doesn't matter which, as long as it is not deleted.
        Project p = s.Projects[0];
        View v = p.AccessibleViews[0]; // AccessibleViews saves checking permissions.

        // Timestep to use when searching.  One hour is fairly quick for resolution.
        TimeSpan deltaTime = new TimeSpan(1, 0, 0);
        deltaTime = new TimeSpan(24 * 365, 0, 0);

        // Invalid calls return faster - start a ways in the future.
        TimeSpan offset = new TimeSpan(24, 0, 0);

        // Times before the view was created are invalid.
        DateTime minTime = v.CreatedTime;
        DateTime localTime = DateTime.Now;

        if (localTime < minTime)
        {
            System.Console.WriteLine("Current time is older than view creation time: " + minTime);

            // If the dates are so dissimilar that the current date is before the creation date,
            // it is probably a good idea to use a bigger delta.
            deltaTime = new TimeSpan(24 * 365, 0, 0);

            // Set the offset to the minimum time and work up from there.
            offset = minTime - localTime;
        }

        // Storage for calculated date.
        DateTime testTime;

        // Larger divisors converge quicker, but might take longer depending on offset.
        const float stepDivisor = 10.0f;

        bool foundValid = false;

        while (true)
        {
            localTime = DateTime.Now;

            testTime = localTime.Add(offset);

            ViewConfiguration vc = ViewConfiguration.CreateFromTime(testTime);

            View tempView = new View(v, vc);

            System.Console.Write("Testing " + testTime + " (Offset " + (int)offset.TotalSeconds + ") (Delta " + deltaTime.TotalSeconds + "): ");

            // Unfortunately, there is no isValid operation.  Attempting to
            // read a property from an invalid date configuration will
            // throw an exception.
            // An alternate to this would be proferred.
            bool valid = true;
            try
            {
                string testname = tempView.RootFolder.Name;
            }
            catch (ServerException)
            {
                System.Console.WriteLine(" InValid");
                valid = false;
            }

            if (valid)
            {
                System.Console.WriteLine(" Valid");

                // If the last check was invalid, the current check is valid, and 
                // If the change is this small, the time is very close to the server time.
                if (foundValid == false && deltaTime.TotalSeconds <= 1)
                {
                    break;
                }

                foundValid = true;
                offset = offset.Add(deltaTime);
            }
            else
            {
                offset = offset.Subtract(deltaTime);

                // Once a valid time is found, start reducing the timestep.
                if (foundValid)
                {
                    foundValid = false;
                    deltaTime = new TimeSpan(0,0,Math.Max((int)(deltaTime.TotalSeconds / stepDivisor), 1));
                }
            }

        }

        System.Console.WriteLine("Run time: " + (DateTime.Now - StartTime).TotalSeconds + " seconds.");
        System.Console.WriteLine("The local time is " + localTime);
        System.Console.WriteLine("The server time is " + testTime);
        System.Console.WriteLine("The server time is offset from the local time by " + offset.TotalSeconds + " seconds.");
    } 
```

输出：

```
Testing 4/9/2009 3:05:40 PM (Offset 86400) (Delta 31536000):  InValid
Testing 4/9/2008 3:05:40 PM (Offset -31449600) (Delta 31536000):  Valid
...
Testing 4/8/2009 10:05:41 PM (Offset 25200) (Delta 3):  InValid
Testing 4/8/2009 10:05:38 PM (Offset 25197) (Delta 1):  Valid
Run time: 9.0933426 seconds.
The local time is 4/8/2009 3:05:41 PM
The server time is 4/8/2009 10:05:38 PM
The server time is offset from the local time by 25197 seconds. 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-24T11:06:45.943

`<stab_in_the_dark>` 我不熟悉该 SDK，但如果服务器位于已知时区，则查看 API 为什么不创建一个 OLEDate 对象，其日期将是客户端的时间，根据服务器的时区适当滚动？ `</stab_in_the_dark>`

# java - 来自 Java 的 Linux 命令

> ID：126116
> 
> 赞同：6
> 
> 时间：2008-09-24T09:01:40.783
> 
> 标签：java, linux

可以用java执行linux命令吗？我正在尝试创建一个 web servlet 以允许 ftp 用户在没有 ssh 登录访问的情况下更改他们的密码。我想执行下一个命令：

```
# adduser -s /sbin/nologin clientA -d /home/mainclient/clientA
# passwd clientA
# cd /home/mainclient; chgrp -R mainclient clientA
# cd /home/mainclient/clientA; chmod 770 . 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-24T09:04:12.680

看看[这个](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ProcessBuilder.html)。

但是，做你所说的事情超出了规范，我不会推荐它。为了让它工作，你要么以 root 身份运行你的应用服务器，要么使用其他一些机制来给正在运行应用服务器的用户作为执行这些特权命令的权限。某处的一个小错误，你就被“拥有”了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-24T09:05:04.237

采用：

```
Runtime.getRuntim().exec("Command"); 
```

其中 Command 是您要执行的命令字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T10:34:17.673

If you invoke those commands from Java, make sure to pack multiple commands to a single shell-script. This will make invocation much easier.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T09:05:56.887

java [RunTime](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html)对象具有在单独进程中运行命令的 exec 方法

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T09:07:55.633

看看[java.lang.Runtime](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html#exec(java.lang.String))

# winforms - 使用 DataGridView 和可能的多线程时出现奇怪的异常

> ID：126123
> 
> 赞同：0
> 
> 时间：2008-09-24T09:04:15.517
> 
> 标签：winforms, multithreading

我跟着谷歌到这个 MSDN 论坛[主题](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3905448&SiteID=1)。

最后一个答案是，我 qoute ：“使用线程？不要”

有人知道四处走走吗？

据我所知，我打得很好。我正在使用 BeginInvoke 来填充 UI 线程内的数据源。

更多细节 ：

我有一个后台线程，它使用 LINQ to SQL 对 Sql Compact 版本数据库进行查询。

之后，我调用将使用 BeginInvoke 更新 DataSource 的方法：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T09:38:56.247

如果您这样做，那么使用后台工作组件并在其报告进度事件中使用已返回的数据填充您的网格。

# java - Java POI可以将图像写入word文档吗？

> ID：126128
> 
> 赞同：2
> 
> 时间：2008-09-24T09:05:48.527
> 
> 标签：java, ms-word, apache-poi

有谁知道这是否可能？并有任何示例代码吗？或者任何其他可以做到这一点的java API？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T14:06:44.510

正如其他人所说，POI 不会让您做任何真正花哨的事情——而且它不支持 Office 2007+ 格式。将 MS Word 视为通过 COM 提供此类功能的组件很可能是这里的最佳方法（除非您在非 Windows 操作系统上运行，或者不能保证 Word 将安装在计算机上）。

如果您确实走 COM 路线，我建议您查看[JACOB 项目](http://sourceforge.net/projects/jacob-project/)。您确实需要稍微熟悉 COM（它的学习曲线非常陡峭），但是该库运行良好，并且比尝试使用 JNI 包装器在本机代码中完成它更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T09:54:08.207

Office 2007 格式基于 XML，因此可以使用 XML 工具编写。但是有[这个库](http://www.aspose.com/documentation/file-format-components/aspose.words-for-.net-and-java/index.html)声称能够编写 DocX 格式的 word 文档。

唯一的其他选择是使用 Java-COM 桥并使用 COM 来操作单词。不过，这可能不是一个好主意——我建议找到一种更简单的方法。

例如，Word 可以轻松读取 RTF 文档，您可以在 Java 中生成 .rtf 文档。您不必使用 Microsoft Word 格式！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T02:20:31.317

如果你使用 docx，你可以试试 docx4j。

请参阅[AddImage 示例](http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/samples/AddImage.java)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-26T07:03:16.553

一定：

看看这个：[http ://code.google.com/p/java2word](http://code.google.com/p/java2word)

Word 2004+ 是基于 XML 的。上述框架获取图像，转换为 Base64 表示并将其添加到 XML。当您打开 Word 文档时，就会出现您的图像。

像这样简单：

```
 IDocument myDoc = new Document2004();   
    myDoc.getBody().addEle("path/myImage.png")); 
```

Java2Word 是一种使用明显的 Java 代码生成 Word Docs 的 API。J2W 负责幕后的所有实现和 XML 生成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T13:47:15.647

JasperReports 使用此 API 替代 POI，因为它支持图像：
[JExcelAPI](http://sourceforge.net/projects/jexcelapi/)

我还没有尝试过，也不知道它有多好/坏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T10:09:50.027

POI 的 HWPF 可以提取 MS Word 文档的文本并执行简单的修改（基本上是删除和插入文本）。AFAIK 它不能做更多的事情。另请记住，HWPF 仅适用于较旧的 MS Word (97) 格式，而不适用于最新格式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T09:47:59.360

据可以从[项目网站](http://poi.apache.org/)收集到：没有。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T11:35:17.667

不知道开箱即用的Java是否可以直接做到这一点。但我读过一个组件，它几乎可以在没有 Word 的情况下自动生成 Word 文档方面做任何事情。[假设的话](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx "假设的话")

# javascript - 用于渲染 HTML 和 javascript 的 Python 库

> ID：126131
> 
> 赞同：18
> 
> 时间：2008-09-24T09:05:57.823
> 
> 标签：javascript, python, html

是否有任何 python 模块用于使用 javascript 呈现 HTML 页面并取回 DOM 对象？

我想解析一个使用 javascript 生成几乎所有内容的页面。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T09:42:52.150

这里最大的复杂性是在浏览器之外模拟完整的浏览器环境。您可以使用独立的 javascript 解释器（如 Rhino 和 SpiderMonkey）来运行 javascript 代码，但它们不提供完整的浏览器式环境来完整呈现网页。

如果我需要解决这样的问题，我会首先查看 javascript 是如何呈现页面的，它很可能是通过 AJAX 获取数据并使用它来呈现页面。然后我可以使用 simplejson 和 httplib2 等 python 库来直接获取数据并使用它，从而无需访问 DOM 对象。但是，这只是一种可能的情况，我不知道您要解决的确切问题。

其他选项包括 Łukasz 提到的 selenium、某种 webkit 嵌入式疯狂、某种 IE win32 脚本疯狂，或者最后，基于 pyxpcom 的解决方案（增加了疯狂）。所有这些都有一个缺点，即需要一个完全运行的 web 浏览器才能运行 python，这可能不是一个选项，具体取决于您的环境。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T10:11:15.733

您可能可以使用[python-webkit](http://code.google.com/p/pywebkitgtk/)。需要一个正在运行的 glib 和 GTK，但这可能比在没有 glib 的情况下包装 webkit 的部分问题要小。

我不知道它是否能满足您的所有需求，但我想您应该尝试一下。

# java - 如何在 Java 中处理多个流？

> ID：126138
> 
> 赞同：5
> 
> 时间：2008-09-24T09:07:41.000
> 
> 标签：java, process, io

我正在尝试运行一个进程并对其输入、输出和错误流进行处理。显而易见的方法是使用类似的东西`select()`，但我在 Java 中能找到的唯一方法是`Selector.select()`，它需要一个`Channel`. 似乎不可能`Channel`从`InputStream`or `OutputStream`(`FileStream`有一个 `getChannel()`方法但在这里没有帮助)

所以，我写了一些代码来轮询所有的流：

```
while( !out_eof || !err_eof )
{
    while( out_str.available() )
    {
        if( (bytes = out_str.read(buf)) != -1 )
        {
            // Do something with output stream
        }
        else
            out_eof = true;
    }
    while( err_str.available() )
    {
        if( (bytes = err_str.read(buf)) != -1 )
        {
            // Do something with error stream
        }
        else
            err_eof = true;
    }
    sleep(100);
} 
```

这有效，但它永远不会终止。当其中一个流到达文件末尾时，`available()`返回零，因此`read()`不会被调用，并且我们永远不会得到表示 EOF 的 -1 返回。

一种解决方案是检测 EOF 的非阻塞方式。我在任何地方的文档中都看不到。或者有没有更好的方法来做我想做的事？

我在这里看到了这个问题： [链接文本](https://stackoverflow.com/questions/60302/starting-a-process-with-inherited-stdinstdoutstderr-in-java-6#60578 "在 Java 中继承 stdin/stdout/stderr 的进程") ，虽然它并不完全符合我的要求，但我可能会使用这个想法，为每个流生成单独的线程，以解决我现在遇到的特定问题。但这肯定不是唯一的方法吗？当然必须有一种方法可以从多个流中读取而不为每个流使用一个线程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T10:16:41.193

正如您所说，[此答案中概述](https://stackoverflow.com/questions/60302/starting-a-process-with-inherited-stdinstdoutstderr-in-java-6#60578)的解决方案是从流程中读取标准输出和标准错误的传统方式。一个线程每流是要走的路，即使它有点烦人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T10:37:01.630

您确实必须为要监视的每个流生成一个线程。如果您的用例允许将相关进程的 stdout 和 stderr 结合起来，则您只需要一个线程，否则需要两个线程。

我花了相当长的时间在我们的一个项目中把它弄好当 java 应用程序的用户取消操作时。

我创建了一个相当简单的类来封装其 run() 方法看起来像这样的监视部分：

```
public void run() {
    BufferedReader tStreamReader = null;
    try {
        while (externalCommand == null && !shouldHalt) {
            logger.warning("ExtProcMonitor("
                           + (watchStdErr ? "err" : "out")
                           + ") Sleeping until external command is found");
            Thread.sleep(500);
        }
        if (externalCommand == null) {
            return;
        }
        tStreamReader =
                new BufferedReader(new InputStreamReader(watchStdErr ? externalCommand.getErrorStream()
                        : externalCommand.getInputStream()));
        String tLine;
        while ((tLine = tStreamReader.readLine()) != null) {
            logger.severe(tLine);
            if (filter != null) {
                if (filter.matches(tLine)) {
                    informFilterListeners(tLine);
                    return;
                }
            }
        }
    } catch (IOException e) {
        logger.logExceptionMessage(e, "IOException stderr");
    } catch (InterruptedException e) {
        logger.logExceptionMessage(e, "InterruptedException waiting for external process");
    } finally {
        if (tStreamReader != null) {
            try {
                tStreamReader.close();
            } catch (IOException e) {
                // ignore
            }
        }
    }
} 
```

在调用方，它看起来像这样：

```
 Thread tExtMonitorThread = new Thread(new Runnable() {

        public void run() {
            try {
                while (externalCommand == null) {
                    getLogger().warning("Monitor: Sleeping until external command is found");
                    Thread.sleep(500);
                    if (isStopRequested()) {
                        getLogger()
                                .warning("Terminating external process on user request");
                        if (externalCommand != null) {
                            externalCommand.destroy();
                        }
                        return;
                    }
                }
                int tReturnCode = externalCommand.waitFor();
                getLogger().warning("External command exited with code " + tReturnCode);
            } catch (InterruptedException e) {
                getLogger().logExceptionMessage(e, "Interrupted while waiting for external command to exit");
            }
        }
    }, "ExtCommandWaiter");

    ExternalProcessOutputHandlerThread tExtErrThread =
            new ExternalProcessOutputHandlerThread("ExtCommandStdErr", getLogger(), true);
    ExternalProcessOutputHandlerThread tExtOutThread =
            new ExternalProcessOutputHandlerThread("ExtCommandStdOut", getLogger(), true);
    tExtMonitorThread.start();
    tExtOutThread.start();
    tExtErrThread.start();
    tExtErrThread.setFilter(new FilterFunctor() {

        public boolean matches(Object o) {
            String tLine = (String)o;
            return tLine.indexOf("Error") > -1;
        }
    });

    FilterListener tListener = new FilterListener() {
        private boolean abortFlag = false;

        public boolean shouldAbort() {
            return abortFlag;
        }

        public void matched(String aLine) {
            abortFlag = abortFlag || (aLine.indexOf("Error") > -1);
        }

    };

    tExtErrThread.addFilterListener(tListener);
    externalCommand = new ProcessBuilder(aCommand).start();
    tExtErrThread.setProcess(externalCommand);
    try {
        tExtMonitorThread.join();
        tExtErrThread.join();
        tExtOutThread.join();
    } catch (InterruptedException e) {
        // when this happens try to bring the external process down 
        getLogger().severe("Aborted because auf InterruptedException.");
        getLogger().severe("Killing external command...");
        externalCommand.destroy();
        getLogger().severe("External command killed.");
        externalCommand = null;
        return -42;
    }
    int tRetVal = tListener.shouldAbort() ? -44 : externalCommand.exitValue();

    externalCommand = null;
    try {
        getLogger().warning("command exit code: " + tRetVal);
    } catch (IllegalThreadStateException ex) {
        getLogger().warning("command exit code: unknown");
    }
    return tRetVal; 
```

不幸的是，我不需要一个独立的可运行示例，但这可能会有所帮助。如果我必须再做一次，我会再看一下使用 Thread.interrupt() 方法而不是自制的停止标志（注意声明它是易变的！），但我将其留到另一次。:)

# linux - 你如何知道 Ubuntu 上安装了哪个版本的 GTK+？

> ID：126141
> 
> 赞同：89
> 
> 时间：2008-09-24T09:08:05.027
> 
> 标签：linux, ubuntu, gtk, gnome

我需要确定 Ubuntu 上安装了哪个版本的 GTK+

男人似乎没有帮助

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-09-24T09:26:40.533

[该建议](https://stackoverflow.com/a/126145/)将告诉您安装了 2.0 的哪个次要版本。不同的主要版本将具有不同的包名称，因为它们可以在系统上共存（以支持使用旧版本构建的应用程序）。

即使对于通常只会让您在系统上拥有一个版本的开发文件，您也可以在同一系统上拥有 gtk 1.x 版本和 gtk 2.0 版本（包含文件位于名为 gtk-1.2 或gtk-2.0)。

所以简而言之，“系统上有什么版本的 GTK”没有一个简单的答案。但...

尝试类似：

```
dpkg -l libgtk* | grep -e '^i' | grep -e 'libgtk-*[0-9]' 
```

列出系统上的所有 libgtk 包，包括 -dev 包。`dpkg -l`将列出 dpkg 知道的所有软件包，包括当前未安装的软件包，因此我使用 grep 仅列出已安装的软件包（行以 i 开头）。

或者，如果它是您感兴趣的标头等版本，可能会更好，请使用 pkg-config：

```
pkg-config --modversion gtk+ 
```

将告诉您安装了哪个版本的 GTK 1.x 开发文件，以及

```
pkg-config --modversion gtk+-2.0 
```

会告诉你 GTK 2.0 的版本。旧的 1.x 版本也有自己的 gtk-config 程序来做同样的事情。同样，对于 GTK+ 3：

```
pkg-config --modversion gtk+-3.0 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-10-27T08:48:37.287

**获取 GTK3 版本：**

```
dpkg -s libgtk-3-0|grep '^Version' 
```

或者只是版本号

```
dpkg -s libgtk-3-0|grep '^Version' | cut -d' ' -f2- 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-09-24T09:09:47.033

你可以使用这个命令：

```
$ dpkg -s libgtk2.0-0|grep '^Version' 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2020-09-13T05:57:47.760

这并不难。

只需从终端检查您的 gtk+ 工具包实用程序版本：

```
gtk-launch --version 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-05-06T15:33:14.860

您也可以只编译以下程序并在您的机器上运行它。

```
#include <gtk/gtk.h>
#include <glib/gprintf.h>

int main(int argc, char *argv[])
{
    /* Initialize GTK */
    gtk_init (&argc, &argv);

    g_printf("%d.%d.%d\n", gtk_major_version, gtk_minor_version, gtk_micro_version);
    return(0);
} 
```

编译（假设上面的源文件名为version.c）：

```
gcc version.c -o version `pkg-config --cflags --libs gtk+-2.0` 
```

当你运行它时，你会得到一些输出。在我的旧嵌入式设备上，我得到以下信息：

```
[root@n00E04B3730DF n2]# ./version 
2.10.4
[root@n00E04B3730DF n2]# 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-01-10T00:00:07.323

尝试，

```
apt-cache policy libgtk2.0-0 libgtk-3-0 
```

或者，

```
dpkg -l libgtk2.0-0 libgtk-3-0 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-06T13:21:02.983

您也可以只打开 synaptic 并搜索 libgtk，它会准确显示您安装了哪个 lib。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-24T10:28:45.800

我认为独立于分布的方式是：

`gtk-config --version`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-08-25T22:43:20.663

尝试：

```
 dpkg-query -W libgtk-3-bin 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-12-05T17:07:45.010

这将获得 GTK+ 2 和 GTK+ 3 的 GTK+ 库版本。

```
dpkg -l | egrep "libgtk(2.0-0|-3-0)" 
```

由于主要版本是可并行安装的，因此您的系统上可能同时拥有这两个版本，这就是我的情况，所以上面的命令在我的 Ubuntu Trusty 系统上返回：

```
ii  libgtk-3-0:amd64                                      3.10.8-0ubuntu1.6                                   amd64        GTK+ graphical user interface library
ii  libgtk2.0-0:amd64                                     2.24.23-0ubuntu1.4                                  amd64        GTK+ graphical user interface library 
```

这意味着我安装了 GTK+ 2.24.23 和 3.10.8。

如果您想要的是开发文件的版本，`pkg-config --modversion gtk+-3.0`例如使用 GTK+ 3。要将其扩展到 GTK+ 的不同主要版本，使用一些 sed 魔法，这给出：

```
pkg-config --list-all | sed -ne 's/\(gtk+-[0-9]*.0\).*/\1/p' | xargs pkg-config --modversion 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-26T07:59:25.753

为了使答案比 Ubuntu（我有 Redhat）更通用：

gtk 通常安装在 /usr 下，但也可能安装在其他位置。这应该在环境变量中可见。检查与

```
env | grep gtk 
```

然后尝试查找您的 gtk 文件的存储位置。例如，使用`locate`和 grep。

```
locate gtk | grep /usr/lib 
```

就这样，我找到`/usr/lib64/gtk-2.0`了，里面有子目录`2.10.0`，里面有很多.so库文件。我的结论是我有 gtk+ 2.10 版。这和 Redhat: 上的 rpm 命令比较一致`rpm -qa | grep gtk2`，所以我认为我的结论是正确的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-08-26T05:16:10.370

因为`apt-cache policy`将列出所有可用的匹配项，即使未安装，我建议使用此命令来获取系统上安装的 GTK 相关软件包的更易于管理的候选清单：

```
apt list --installed libgtk* 
```

# .net - Enterprise Library HashProvider 中的盐是什么？（SaltEnabled 键）

> ID：126148
> 
> 赞同：3
> 
> 时间：2008-09-24T09:11:10.150
> 
> 标签：.net, enterprise-library, hash, salt

当我们设置 SaltEnabled 时，Microsoft Enterprise Library 的 HashProvider 中如何生成 salt？

新机器是随机的吗？这是一个神奇的数字吗？

（我知道什么是盐，问题是企业库 HashProvider 中的盐的实际值是多少）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T17:23:14.367

编辑：

有关示例实现，请参阅 Microsoft.Practices.EnterpriseLibrary.Security.Cryptography.HashAlgorithmProvider。散列步骤是：

1.  如果 SaltEnabled，使用 RNGCryptoServiceProvider 生成盐长度的随机字节。
2.  将盐附加到明文中。
3.  散列加盐的明文。
4.  然后（这是重要的一步），再次将 salt 附加到**hash**。

要与散列文本进行比较，您必须使用：

```
public bool CompareHash(byte[] plaintext, byte[] hashedtext) 
```

与重新散列和比较。如果你重新散列，会生成一个新的随机盐，你就迷路了。

CompareHash 执行以下操作：

1.  从散列文本中提取非散列盐。请记住，它是在上面的步骤 4 中附加的。
2.  使用该盐计算明文的哈希值。
3.  将新哈希与 hashedtext 减去 salt 进行比较。如果它们相同 - 真，否则为假。

原来的：

“如果在 HashProvider 上启用了 salt，则提供程序将生成一个随机的字节序列，并将其添加到散列中。如果您将散列值与未散列值进行比较，盐将从散列值中提取并用于在比较之前散列未散列的值。”

和

“至于解码为哈希值。这是做不到的。创建哈希后，应该无法将其反转为原始值。但是，您可以做的是通过将未哈希值与哈希值进行比较它通过相同的算法并比较输出。”

来自[http://www.codeplex.com/entlib/Thread/View.aspx?ThreadId=10284](http://www.codeplex.com/entlib/Thread/View.aspx?ThreadId=10284)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-05T23:19:49.110

有点题外话：

这种盐用于防止彩虹攻击。彩虹攻击是一种尝试根据预先计算的哈希值的非常大（详尽/通常为几千兆字节）字典来找出计算该哈希值的字符串是什么的一种尝试。

[“叔叔”杰夫](http://www.codinghorror.com/blog)有[一篇关于此的博客文章](http://www.codinghorror.com/blog/archives/000949.html)。

此外，您可以查找 Wikipedia ：

[http://en.wikipedia.org/wiki/Rainbow_table](http://en.wikipedia.org/wiki/Rainbow_table)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-15T20:18:48.173

所以我想我晚了几年，但我的理解是每次创建哈希时都会创建一个新的随机盐值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-02T10:56:02.950

我回答了关于企业库及其用于散列的盐值的类似问题。

你可以在这里查看：[https ://stackoverflow.com/a/27247012/869376](https://stackoverflow.com/a/27247012/869376)

亮点：

1.  salt 是一个随机生成的 16 字节数组。
2.  它是通过命名空间`CryptographyUtility.GetRandomBytes(16);`中的方法生成的`Microsoft.Practices.EnterpriseLibrary.Security.Cryptography`。这最终调用了一个名为的 C 库方法`[DllImport("QCall", CharSet = CharSet.Unicode)] private static extern void GetBytes(SafeProvHandle hProv, byte[] randomBytes, int count);`
3.  Base64 编码字符串的前 16 个字节是用于散列原始值的盐

# asp.net - 在 ASP.Net 页面上给出问题的文本框

> ID：126154
> 
> 赞同：0
> 
> 时间：2008-09-24T09:11:57.620
> 
> 标签：asp.net

我正在设计一个添加/编辑用户的页面 - 我使用了一个转发器控件和一个表格来显示用户。在用户视图中，表格行的各个列具有显示记录值的标签，当用户单击编辑按钮时，标签被隐藏并显示文本框供用户编辑值 - 问题是 - 一旦文本框可见，表格大小增加 - 行高和单元格大小变大。有没有办法显示文本框，使它们与标签的大小相同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T10:02:56.047

处理表格，问题是：您的标签可以跨越多个文本行（即：您可以有长文本）吗？如果是，您可能会以任何方式遇到布局问题。如果没有，一个简单的方法可以是创建一个 CSS 类：

```
 .CellContent { display:block; width: ...; height: ...; } 
```

使用您喜欢的单元格宽度/高度。只要保持你的身高有点“大”。

将类分配给您的标签和文本框，并且在切换控件时不应更改宽度/高度（感谢 display:block 属性）。

同样，如果您有长文本，您仍然会遇到问题，并且可能需要使用多行。在这种情况下，我建议忽略高度问题：只需将宽度设置为一致，并始终显示 3-4 行文本框进行编辑。如果用户准备好输入长文本，他们不会因为看到行高变化而烦恼。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T09:43:57.577

我会使用 JS+CSS ......不过，你必须为这个弄脏你的手。Visual Studio 不会对您有太大帮助。

这是我的做法：

1.  获取客户端`<td>`宽度和客户端高度。
2.  *将*' 的宽度和高度设置为`<td>`这些 px 值（因此它们不再是相对的）
3.  交换输入的文本
4.  在您的 CSS 中，确保输入没有填充/边距/边框并设置宽度：100%、行高：1em 和高度：1em

切换回来时，请确保取消设置`<td>`宽度和高度，以便它们返回自动值。

你需要稍微调整一下。我敢肯定，您将不得不使用上的填充，`<td>`并且可能设置溢出：隐藏，但您应该能够做您想做的事情。

# c# - C# 数组 XML 序列化

> ID：126155
> 
> 赞同：29
> 
> 时间：2008-09-24T09:12:20.053
> 
> 标签：c#, xml, serialization

我发现 C# 的 XML 序列化存在问题。串行器的输出在普通 Win32 和 WinCE 之间不一致（但令人惊讶的是 WinCE 具有 IMO 校正器输出）。Win32 只是忽略 Class2`XmlRoot("c2")`属性。

有谁知道如何在 Win32 上获得类似 WinCE 的输出（因为我不希望 XML 标记具有序列化类的类名）。

测试代码：

```
using System;
using System.Xml.Serialization;
using System.IO;

namespace ConsoleTest
{
    [Serializable]
    [XmlRoot("c1")]
    public class Class1
    {
        [XmlArray("items")]
        public Class2[] Items;
    }

    [Serializable]
    [XmlRoot("c2")]
    public class Class2
    {
        [XmlAttribute("name")]
        public string Name;
    }

    class SerTest
    {
        public void Execute()
        {
            XmlSerializer ser = new XmlSerializer(typeof (Class1));

            Class1 test = new Class1 {Items = new [] {new Class2 {Name = "Some Name"}, new Class2 {Name = "Another Name"}}};

            using (TextWriter writer = new StreamWriter("test.xml"))
            {
                ser.Serialize(writer, test);
            }
        }
    }
} 
```

预期的 XML（WinCE 生成这个）：

```
<?xml version="1.0" encoding="utf-8"?>
<c1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <items>
    <c2 name="Some Name" />
    <c2 name="Another Name" />
  </items>
</c1> 
```

Win32 XML（似乎是错误的版本）：

```
<?xml version="1.0" encoding="utf-8"?>
<c1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <items>
    <Class2 name="Some Name" />
    <Class2 name="Another Name" />
  </items>
</c1> 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-24T09:29:18.470

试试 [XmlArrayItem("c2")]

```
[XmlRoot("c1")]
public class Class1
{
    [XmlArray("items")]
    [XmlArrayItem("c2")] 
    public Class2[] Items;
} 
```

或 [XmlType("c2")]

```
[XmlType("c2")]
public class Class2
{
    [XmlAttribute("name")]
    public string Name;
} 
```

# php - PHP 中 Db 抽象的职责从哪里开始和结束？

> ID：126161
> 
> 赞同：2
> 
> 时间：2008-09-24T09:13:44.187
> 
> 标签：php, sql, mysql, database

在`PHP`中，布置职责的最佳做法是`Db Abstraction Layer`什么？

在性能方面是`OOP`个好主意吗？多少应该是通用目标代码，多少应该是非常具体的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T11:11:08.413

已经有一些很好的解决方案。DAL 不是一件简单的事情，尤其是因为涉及到如此多的安全问题。我建议检查[PDO](http://www.php.net/manual/en/class.pdo.php)和[MySQLi](http://www.php.net/manual/en/class.mysqli.php)。即使您为其中一个编写包装类，也将以一种健壮且安全的方式为您完成繁重的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T11:12:18.737

在我编写的大多数应用程序中，通常有两种不同类型的数据访问。一种是用于事务操作：从数据存储中检索特定对象，修改它们并将它们保存回来。我发现一个可靠的 ORM 是这里的最佳解决方案。不要尝试自己编写（尽管它可能很有趣。）

另一种常见的数据访问类型是用于报告。ORM 在这里并不是最好的解决方案，这就是为什么我通常使用使用自定义 SQL 查询的方案。普通的 ol' PDO 在这里效果很好。您可以仅为该报告创建一个特殊的值对象，并让 PDO 查询将值提取到对象中。报告需要快速，而使用 ORM 层构建它们通常太慢且太麻烦。

# c# - 如何将接口实现委托给C#中的其他类

> ID：126164
> 
> 赞同：10
> 
> 时间：2008-09-24T09:14:16.883
> 
> 标签：c#, interface

假设以下类：

```
public class MyEnum: IEnumerator
{
    private List<SomeObject> _myList = new List<SomeObject>();
...
} 
```

有必要在 MyEnum 中实现 IEnumerator 方法。但是是否可以将 IEnumerator 的实现直接“委托”或重定向到 _myList 而无需实现 IEnumerator 方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T09:27:31.920

**方法一：** 继续使用封装，将调用转发到List实现。

```
class SomeObject
{
}

class MyEnum : IEnumerable<SomeObject>
{
    private List<SomeObject> _myList = new List<SomeObject>();

    public void Add(SomeObject o)
    {
        _myList.Add(o);
    }

    public IEnumerator<SomeObject> GetEnumerator()
    {
        return _myList.GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
}

class Program
{
    static void Main(string[] args)
    {
        MyEnum a = new MyEnum();
        a.Add(new SomeObject());

        foreach (SomeObject o in a)
        {
            Console.WriteLine(o.GetType().ToString());
        }

        Console.ReadLine();
    }
} 
```

**方法 2：** 从 List 实现继承您可以免费获得该行为。

```
class SomeObject
{
}

class MyEnum : List<SomeObject>
{
}

class Program
{
    static void Main(string[] args)
    {
        MyEnum a = new MyEnum();
        a.Add(new SomeObject());

        foreach (SomeObject o in a)
        {
            Console.WriteLine(o.GetType().ToString());
        }

        Console.ReadLine();
    }
} 
```

**方法 1**允许更好的沙盒，因为在没有 MyEnum 知识的情况下不会在 List 中调用任何方法。为了最少的努力，**方法 2**是首选。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T09:25:54.017

你可以这样做：

```
public class MyEnum : IEnumerator {
    private List<SomeObject> _myList = new List<SomeObject>();
    public IEnumerator GetEnumerator() { return this._myList.GetEnumerator(); }
} 
```

原因很简单。您的类可以包含多个作为集合的字段，因此编译器/环境无法知道应该使用哪个字段来实现“IEnumerator”。

**EIDT：**我同意@pb - 你应该实现 IEnumerator<SomeObject> 接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T09:27:38.893

除了使用 pb 的方法之外，这是不可能的，原因很简单：接口方法需要传递一个`this`指针作为第一个参数。当你调用`GetEnumerator`你的对象时，这个指针就是你的对象。但是，为了使调用在嵌套列表上工作，指针必须是对该列表的引用，而不是您的类。

因此，您必须明确地将方法委托给另一个对象。

（顺便说一句，另一个回复中的建议是正确的：使用`IEnumerator<T>`，*而不是* `IEnumerable`！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T09:27:26.117

如果要以调用者无法修改集合的方式返回集合，则可能需要将 List 包装到 ReadOnlyCollection<> 并返回 ReadOnlyCollection<> 的 IEnumerable<>。

这样您就可以确保您的收藏不会被更改。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-24T09:18:24.987

除非你从 List<T> 派生。

```
public class MyEnum : List<SomeObject>, IEnumerable<SomeObject>{} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-24T09:54:23.463

谢谢大家的意见和解释。最终，我将您对以下问题的一些答案结合在一起：

```
 class MyEnum : IEnumerable<SomeObject>
{
    private List<SomeObject> _myList = new List<SomeObject>();
    public IEnumerator<SomeObject> GetEnumerator()
    {
        // Create a read-only copy of the list.
        ReadOnlyCollection<CustomDevice> items = new ReadOnlyCollection<CustomDevice>(_myList);
        return items.GetEnumerator();
    }
} 
```

该解决方案是为了确保调用代码无法修改列表，并且每个枚举器在各个方面都独立于其他枚举器（例如，使用排序）。再次感谢。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-06-07T20:42:08.063

请注意，多亏了[鸭子类型](https://blogs.msdn.microsoft.com/kcwalina/2007/07/18/duck-notation/)，您可以`foreach`在任何具有`GetEnumerator`方法的对象上使用 - 对象类型不需要实际实现`IEnumerable`。

所以如果你这样做：

```
class SomeObject
{
}

 class MyEnum
 {
    private List<SomeObject> _myList = new List<SomeObject>();

    public IEnumerator<SomeObject> GetEnumerator()
    {
        return _myList.GetEnumerator();
    }
 } 
```

然后这工作得很好：

```
MyEnum objects = new MyEnum();
// ... add some objects
foreach (SomeObject obj in objects)
{
    Console.WriteLine(obj.ToString());
} 
```

# .net - ASP.NET - 上传大文件时如何显示错误页面（超出最大请求长度）？

> ID：126167
> 
> 赞同：12
> 
> 时间：2008-09-24T09:15:28.317
> 
> 标签：.net, asp.net, file-upload, maxrequestlength, application-onerror

应用程序能够在 OnError 中记录错误，但我们无法进行任何重定向或向用户显示有意义的内容。有任何想法吗？我知道我们可以在 web.config 中设置 maxRequestLength，但是无论如何用户可以超过这个限制并且需要显示一些正常的错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T10:21:38.670

正如您所说，您可以在 web.config 中设置 maxRequestLength（覆盖您 machine.config 的默认 4MB），如果超出此限制，您通常会收到 HTTP 401.1 错误。

为了在应用程序级别处理通用 HTTP 错误，您可以在 system.web 部分的 web.config 中设置 CustomError 部分：

```
<system.web>
   <customErrors mode=On defaultRedirect=yourCustomErrorPage.aspx />
</system.web> 
```

每次显示错误时，用户都会被重定向到您的自定义错误页面。

如果您想为每个错误提供一个专门的页面，您可以执行以下操作：

```
<system.web>    
   <customErrors mode="On" defaultRedirect="yourCustomErrorPage.aspx">
     <error statusCode="404" redirect="PageNotFound.aspx" />
   </customErrors>
</system.web> 
```

等等。

或者，您可以从 IIS 编辑虚拟目录属性的 CustomErrors 选项卡，以指向您选择的错误处理页面。

上述内容似乎不适用于 401.x 错误 - 这篇代码项目文章解释了一个似乎非常相似的问题的解决方法：[重定向到自定义 401 页面](http://www.codeproject.com/KB/aspnet/Custon401Page.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T10:03:04.863

不幸的是，您可能需要 IIS7 并使用自定义处理程序来捕获它，因为 IIS6 永远不会到达它可以看到文件大小的阶段。它只有在上传完成或出现错误时才能知道大小。

这是 ASP.NET 中的一个已知问题。另一种（蹩脚的）替代方案是在请求的早期处理这个问题，并且可能使用基于 Flash 的上传器。**约翰链接到以下链接中的几个**。

**更新**： Jon Galloway 似乎已经[深入研究了这个问题](http://weblogs.asp.net/jgalloway/archive/2008/01/08/large-file-uploads-in-asp-net.aspx)，似乎 RIA 上传器是唯一明智的选择，因为 IIS 似乎总是不得不吞下文件然后告诉你它太大了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:58:57.003

谢尔盖，

根据 JohnIdol 的回答，您需要为*413*状态码设置自定义错误页面。例如：

```
 <customErrors mode="On" defaultRedirect="~/Errors/Error.aspx">
                    <error statusCode="413" redirect="~/Errors/UploadError.aspx"/>
    </customErrors> 
```

我知道是因为我必须在客户项目中解决同样的问题，而这对我来说是有效的解决方案。不幸的是，这是我找到的唯一解决方案……无法在代码中捕捉到这个特殊问题；例如，按照 snomag 的建议检查发布文件的长度，或者在 global.asax 中发现错误。和你一样，在想出一个可行的解决方案之前，我也尝试过这些其他方法。（实际上，当我解决我的问题时，我最终在网络上的某个地方找到了这个）。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T09:57:26.717

您应该能够在 Global.asax - OnError() 处理程序中捕获错误。但不幸的是，您的初始请求将完成，您将无法向用户呈现带有一些错误通知的相同上传页面。

您最多可以做的是在 OnError() 处理程序中显示一个带有简单重定向子句的友好错误页面，并在该页面上具有一些反向链接或类似功能，以将用户返回到他第一次触发错误的页面地方。

更新：

我最近必须对文件上传进行精确检查，我想出的是[SWFUpload](http://swfupload.org/)库，它完全符合我的要求，并且还有很多附加功能。我将它与 Steve Sanderson 提供的 jquery 包装器一起使用。更多细节可以在[这里](http://blog.codeville.net/2008/11/24/jquery-ajax-uploader-plugin-with-progress-bar/)找到。

关键是，闪存能够在客户端检测文件大小并在遇到这种情况时做出正确反应。我认为这正是你所需要的。

此外，如果您想在客户端未安装 flash 的情况下优雅地降级为原生上传 button0，您可以实施 flash 检测检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-25T20:42:31.737

处理大型上传的最佳方法是使用实​​现 HttpModule 的解决方案，该解决方案会将文件分成块。任何预先推出的解决方案都应该允许您限制文件大小。很多其他人已经在此页面上发布了指向这些内容的链接，所以我不会打扰。但是，如果您不想为此烦恼，您*可以*在应用程序的 Global.asax Application_Error 事件中处理此问题。如果您的应用程序是 .NET 4.0，请在其中粘贴以下代码块：

```
 if (ex.InnerException != null && ex.InnerException.GetType() == typeof(HttpException) && ((HttpException)ex.InnerException).WebEventCode == System.Web.Management.WebEventCodes.RuntimeErrorPostTooLarge)
    {
        //Handle and redirect here, you can use Server.ClearError() and Response.Redirect("FileTooBig.aspx") or whatever you choose
    } 
```

来源：http: [//justinyue.wordpress.com/2010/10/29/handle-the-maximum-request-length-exceeded-error-for-asyncfileupload-control/](http://justinyue.wordpress.com/2010/10/29/handle-the-maximum-request-length-exceeded-error-for-asyncfileupload-control/)

如果您在较早的框架上运行，请尝试此处的代码（它在 VB 中，但很容易翻译）：[http ://www.webdeveloper.com/forum/showthread.php?t=52132](http://www.webdeveloper.com/forum/showthread.php?t=52132)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-24T09:27:38.160

您可以检查张贴文件的长度 (FileUpload.PostedFile.ContentLength)，看看它是否低于限制，并在必要时简单地显示一条友好的错误消息。

# mysql - 是否索引 < 或 > MySQL 查询？

> ID：126179
> 
> 赞同：10
> 
> 时间：2008-09-24T09:21:54.947
> 
> 标签：mysql, optimization, indexing

如果我有类似的查询，

```
DELETE FROM table WHERE datetime_field < '2008-01-01 00:00:00' 
```

`datetime_field`列索引有帮助吗？即索引仅在使用相等（或不等）测试时有用，还是在进行有序比较时也有用？

> （在不重新创建表的情况下更好地执行此查询的建议也可以！）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-24T09:33:08.600

也许。一般来说，如果有这样的索引，如果查询上没有“更好”的索引，它将对该索引使用范围扫描。但是，如果优化器认为范围最终会太大（即包括超过 1/3 的行），它可能根本不会使用索引，因为表扫描可能会快点。

使用 EXPLAIN（在 SELECT 上；您不能 EXPLAIN 删除）来确定其在特定情况下的决定。这可能取决于

*   表中有多少行
*   您指定的范围是多少
*   WHERE 子句中还指定了什么。如果有另一个“看起来更好”的索引，它不会使用一个索引的范围扫描。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T10:51:07.790

来自[MySQL 参考手册](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)：

> B 树索引可用于使用 =、>、>=、<、<= 或 BETWEEN 运算符的表达式中的列比较。

对于大量行，通过树索引查找行比通过表扫描查找行要快得多。但正如其他答案所指出的，请使用`EXPLAIN`找出 MySQL 的决定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T09:25:46.653

日期时间字段上的索引肯定有助于基于日期范围的搜索。我们一直在我们的数据库中使用它们，如果没有索引，查询速度非常慢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T09:23:40.557

确实如此，请检查 DESCRIBE SELECT FROM 表...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-26T11:02:10.983

[除非你在 mysql http://bugs.mysql.com/bug.php?id=58190](http://bugs.mysql.com/bug.php?id=58190)中没有这个错误

# c# - 是否可以在 IE 中“自动填充”字段？

> ID：126182
> 
> 赞同：2
> 
> 时间：2008-09-24T09:23:00.293
> 
> 标签：c#, internet-explorer

我工作的公司希望使用“托管付款方式”向我们的客户收费。出现了一个问题，关于我们如何使用来自我们其他系统之一的信息自动填充“付款表格”。我们无法控制软管的付款方式，我们必须使用 IE。这可能吗？如果是这样，如何做到这一点？

如果有什么不清楚的，请告诉我...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T09:34:49.393

假设您实际上是将远程表单的内容嵌入到框架/iframe 中，您应该能够使用一些 javascript 来设置字段的值 - field.value = "xxxx"。

该解决方案当然取决于保持不变的表单 - 对远程表单的任何更改都需要您更新脚本。

如果您在付款完成后“移交”到远程站点（重定向）该帖子返回到您的站点，那么除非远程站点提供 API / 一种传递请求参数的方式，否则您将无法使用运气，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T09:32:24.607

除非您的支付网关允许您在一组 API 中传递数据（很多都可以！），否则您需要控制（和负责）您的支付表单。

我说责任是因为您必须向您的商家帐户提供商证明一切都是安全的。这也可能会产生一些安全测试费用。

因此，请先咨询您的商家网关。许多系统都有办法从您的站点接受数据，他们的技术支持将能够立即给您一个直接的答案。否则，您必须将其切换，以便您自己处理所有数据，这只是为了让事情变得更容易，IMO 不值得。

# sql-server - SQL Server 和 Oracle，在可扩展性方面哪个更好？

> ID：126188
> 
> 赞同：10
> 
> 时间：2008-09-24T09:24:34.503
> 
> 标签：sql-server, database, oracle

MS SQL Server 和 Oracle，哪一个在可扩展性方面更好？
例如，如果数据大小达到 500 TB 等。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-24T09:48:08.393

Oracle 和 SQL Server 都是共享磁盘数据库，因此它们受到磁盘带宽的限制，无法进行表扫描大量数据的查询。[Teradata](http://www.teradata.com/enterprise-data-warehouse)、[Netezza](http://www.netezza.com/products/dwa.aspx)或[DB/2 Parallel Edition](http://www-01.ibm.com/software/data/db2/9/edition-enterprise.html)等产品是[“无共享”](http://en.wikipedia.org/wiki/Shared_nothing_architecture)架构，其中数据库在各个节点上存储水平分区。这种类型的架构提供了最佳的并行查询性能，因为每个节点上的本地磁盘不受 SAN 上的中心瓶颈的限制。

共享磁盘系统（例如 Oracle [Real Application Clusters](http://www.oracle.com/database/rac_home.html)或[Clustered SQL Server](http://www.sql-server-performance.com/articles/clustering/clustering_intro_p1.aspx)安装仍然需要共享[SAN](http://en.wikipedia.org/wiki/Storage_area_network)，这限制了流传输的带宽。在 VLDB 上，这会严重限制可能实现的表扫描性能。大多数数据仓库查询跨大数据块运行表或范围扫描。如果查询将命中超过百分之几的行，则单个表扫描通常是最佳查询计划。

节点上的多个本地直连磁盘阵列可提供更多磁盘带宽。

话虽如此，我知道一家 Oracle DW 商店（一家主要的欧洲电信公司）拥有一个基于 Oracle 的数据仓库，每天加载 600 GB，因此共享磁盘架构似乎没有施加无法克服的限制。

MS-SQL 和 Oracle 之间存在一些差异。恕我直言，Oracle 比 SQL Server 具有更好的 VLDB 支持，原因如下：

*   Oracle 原生支持[位图索引](http://en.wikipedia.org/wiki/Bitmap_index)，这是一种适合高速数据仓库查询的索引结构。它们本质上是为 I/O 折衷的 CPU，因为它们是运行长度编码的并且使用相对较少的空间。另一方面，微软声称[Index Intersection](http://www.databasejournal.com/features/mssql/article.php/1438821)并没有明显变慢。

*   Oracle 具有比 SQL Server 更好的表分区功能。IIRC SQL Server 2005 中的表分区只能在单个列上完成。

*   Oracle 可以在比 SQL Server 稍大的硬件上运行，尽管可以在一些[相当](http://www.sun.com/servers/index.jsp?cat=Sun%20Fire%20High-End%20Servers&tab=3) [大](http://www-03.ibm.com/systems/p/hardware/highend/595/index.html) [的](http://h20341.www2.hp.com/integrity/cache/342254-0-0-0-121.html)[系统](http://www.sun.com/servers/x64/x4600/) [上](http://h10010.www1.hp.com/wwpc/us/en/en/WF04a/15351-15351-3328412-241644-3328423.html) [运行](http://www.unisys.com/products/enterprise__servers/high_d_end__servers/index.htm)SQL Server。

*   [Oracle 对物化视图](http://en.wikipedia.org/wiki/Materialized_view)和[查询重写](http://www.oracle.com/technology/oramag/oracle/03-sep/o53business.html)有更成熟的支持，以优化关系查询。SQL2005 确实有一些查询重写功能，但它的文档记录很差，我还没有看到它在生产系统中使用过。但是，Microsoft 会建议您使用[Analysis Services](http://msdn.microsoft.com/en-us/library/ms175609(SQL.90).aspx)，它实际上支持无共享配置。

除非您拥有真正符合圣经的数据量并在 Oracle 和无共享架构（如 Teradata）之间进行选择，否则您可能会发现 Oracle 和 SQL Server 之间几乎没有实际差异。特别是自从引入 SQL2005 以来，SQL Server 中的分区工具被认为已经足够好，并且有[大量](http://www.intelalliance.com/microsoft/assets/Allscripts%20-%20SQL%20Server%202005%20Case%20Study%2008-22-07.pdf)已在其上成功实现的[多 TB系统](http://ieeexplore.ieee.org/Xplore/login.jsp?url=/iel5/10435/33129/01559994.pdf?isnumber=33129&prod=CNF&arnumber=1559994&arSt=+42&ared=+42&arAuthor=+Cai%2C+Y.D.%3B++Aydt%2C+R.%3B++Brunner%2C+R.J.)[示例](http://joesack.com/WordPress/?p=22#more-22)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-17T23:10:20.247

当您谈论 500TB 时，即 (a) 大而 (b) 专业。我会去一家有合适专家的咨询公司，看看现有的技能组合、与现有技术堆栈的集成、预期的使用、备份/恢复/DR 要求......

简而言之，这不是我根据 stackoverflow 的意见进入的那种项目。无意冒犯，但要考虑的因素太多了，其中很多都是商业机密。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-24T09:39:25.277

Oracle 或 MSSQL 是否会更好地扩展/执行是问题 #15。无论您运行的是 Oracle、MSSQL、Informix 还是其他任何东西，数据模型都是第一个成功或失败的项目。数据模型结构，什么样的应用程序，它如何访问数据库等，您的开发人员非常了解哪个平台可以针对大型系统等是您应该问自己的第一个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-24T19:28:05.207

我不得不同意那些说设计更重要的人。

我使用过许多不同风格的超快和超慢数据库（绝对最糟糕的是 Oracle 数据库，但这不是 Oracle 的错）。数据库的设计以及如何决定对它进行索引、分区和查询与可伸缩性的关系远大于产品来自 MSSQL Server 还是 Oracle。

我认为您可能更容易找到更多具有 TB 级数据库经验的 Oracle dbas（运行大型数据库是一门专业，就像了解特定的 SQL 风格一样），但这可能取决于您所在的地区。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-24T10:06:04.713

我曾在 Oracle 上担任 DBA（尽管几年前），现在我广泛使用 MSSQL，尽管不是正式的 DBA。我的建议是，在绝大多数情况下，两者都将满足您所能提供的一切，并且您的性能问题将更多地取决于数据库设计和部署，而不是产品的基本特征，在这两种情况下都是绝对和完全的可靠（MSSQL 是 MS 在许多人看来是最好的产品，所以不要让对 MS 的通常看法蒙蔽了你）。

我自己我会倾向于 MSSQL，除非您的系统将非常大并且真正的企业级（大量用户，多个 9 的正常运行时间等）仅仅是因为根据我的经验，Oracle 往往需要比 MSSQL 更高级别的 DBA 知识和维护充分利用它。Oracle 也往往更昂贵，无论是初始部署成本还是为其雇用 DBA 的成本。OTOH，如果您正在研究企业系统，那么 Oracle 将具有优势，尤其是因为如果您负担得起，他们的支持是首屈一指的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T09:27:36.960

oracle 人会告诉你 oracle 更好，sql server 人会告诉你 sql server 更好。我说它们的规模几乎相同。使用你更了解的东西。你在 oracle 和 sql server 上都有这么大的数据库

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-21T21:58:43.870

当您达到 OBSCENE 数据库大小时（超过 1TB 确实足够大，而 500TB 非常庞大），那么操作支持必须在要求列表中占据非常高的位置。有了这么多数据，您就不会纠结于一分钱一分货的系统规格。

你将如何备份这么大的系统？升级操作系统并修补数据库？可扩展性和可靠性值得关注吗？

我有 Oracle 和 MS SQL 的经验，对于真正非常大的系统（用户、数据或重要性），Oracle 更适合运营支持和数据管理。

每个人都试图备份和恢复一个 1TB+ 的 SQL Server 数据库，该数据库在多个实例上的多个数据库中拆分，事务日志文件被每个数据库到处吐出并试图保持所有同步？祝你好运。

使用 Oracle，您拥有一个数据库（所以我不同意“不共享”的方法更好），其中包含一组重做日志（1）和一组存档日志（2），您只需添加额外的硬件节点而无需更改（即重新分区）您的应用程序和数据。

(1) 重做日志当然是镜像的。(2) 归档日志当然存储在多个位置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T09:34:42.310

它还取决于您的应用程序的用途。如果它只使用很少更新的插入，那么我认为 MSSQL 在性能方面会更具可扩展性和更好。但是，如果有很多更新，那么 Oracle 会更好地扩展

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T11:24:20.627

我非常怀疑您是否会得到对该特定问题的客观答案，直到您遇到在两个平台上实现了相同数据库（模式、数据等）的任何人。

然而，考虑到您可以找到数百万对这两个数据库感到满意的用户，我敢说这两个数据库都可以很好地扩展（我已经看到了一个 300 TB 的快速 Sql 2005 实现，它似乎响应迅速)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2011-06-09T04:23:53.917

Oracle 就像一台高质量的手动胶片相机，需要最好的摄影师才能拍出最好的照片，而 MS SQL 就像一台自动数码相机。在过去，当然，所有的专业摄影师都会使用胶片相机，现在想想有多少专业摄影师使用自动数码相机。

# .net - .NET Compact Framework 能否获得在单元格中包含多行文本的网格？

> ID：126196
> 
> 赞同：3
> 
> 时间：2008-09-24T09:27:20.003
> 
> 标签：.net, windows-mobile, compact-framework, mobile

是否可以使用 .NET Compact 框架在网格单元格中显示多行文本？我们需要创建一个中间列包含地址的网格。我们希望在多行中显示这一点，并（可能）对最后一行应用一些格式。

例如
123 Anywhere Street
Birmingham
B1 2DU
**电话：** 0123 555555

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T09:31:03.113

您必须在网格上覆盖“OnPaint”方法，或者使用另一个网格（我认为 SourceGrid 是与 CF 兼容的早期版本之一）。

.NET Framework 具有传统的不太好的网格控件 :(。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:37:09.937

看看 Ilya Tumanov[在 DataGrid 中自定义格式数据的示例](http://blogs.msdn.com/netcfteam/archive/2006/04/25/583542.aspx)。他对其中的细胞进行了定制绘画。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2008-09-24T09:56:09.043

将 DataGridView 控件中的 AutoSizeRowsMo​​de 属性设置为 DisplayedCells 。

此处的附加信息：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.autosizerowsmode.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.autosizerowsmode.aspx)

# database - 数据库中一致且全面的地址存储的最佳实践

> ID：126207
> 
> 赞同：26
> 
> 时间：2008-09-24T09:29:53.943
> 
> 标签：database, standards, modeling

是否有任何最佳实践（甚至标准）可以在数据库中以一致和全面的方式存储地址？

具体来说，我认为现阶段地址存储有两种情况：

*   您只需要将地址与人、建筑物或任何物品相关联（最常见的情况）。那么一个带有文本列（address1、address2、zip、city）的平面表可能就足够了。这不是我感兴趣的情况。
*   您想对您的地址进行统计：特定街道、城市或...中有多少物品然后您想避免任何类型的拼写错误，并确保一致性。我的问题是关于这种特定情况下的最佳实践：建模一致地址数据库的最佳方法是什么？

一个国家特定的设计/解决方案将是一个很好的开始。

**回答**：这个问题似乎还没有完美的答案，但是：

*   正如 Hank所[建议的，](https://stackoverflow.com/questions/126207/best-practices-for-consistent-and-comprehensive-address-storage-in-a-database#126219) [xAL](http://www.oasis-open.org/committees/ciq/ciq.html#6)是最接近出现的全球标准的东西。不过，这似乎有点矫枉过正，我不确定很多人会想在他们的数据库中实现它......
*   要开始自己的设计（针对特定国家/地区），[Dave](https://stackoverflow.com/questions/126207/best-practices-for-consistent-and-comprehensive-address-storage-in-a-database#126860)到[万国邮政联盟](http://www.upu.int/post_code/en/postal_addressing_systems_member_countries.shtml)(UPU) 网站的链接是一个很好的起点。
*   至于法国，地址有一个规范（非官方，但事实上的标准），上面有[AFNOR XP Z10-011](http://www.boutique.afnor.org/NEL5DetailNormeEnLigne.aspx?&nivCtx=NELZNELZ1A10A101A107&ts=1843530&CLE_ART=FA047725)（仅限法语）这个可爱的名字，并且必须付费。[万国邮联](http://www.upu.int/post_code/en/postal_addressing_systems_member_countries.shtml)对法国的描述基于此规范。
*   我碰巧找到了瑞典的等效规范：[SS 613401](http://www.sis.se/DesktopDefault.aspx?tabName=@DocType_1&Doc_ID=34763)。
*   在欧洲层面，已经做出了一些努力，形成了标准 EN 14142-1。它可通过[CEN 国家成员](http://www.cen.eu/cenorm/members/national+members/members.asp)获得。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-05T22:54:29.870

我自己也一直在思考这个问题。到目前为止，这是我的松散想法，我想知道其他人的想法。

谷歌和雅虎的地理编码服务都使用 xAL（及其包含个人姓名的姐妹 XNAL），这给了它一定的权重。但是由于可以在 xAL 中以许多不同的方式描述相同的地址——有些方式比其他方式更具体——所以我看不出 xAL 本身是如何成为数据存储的可接受格式。但是，可以使用其中的一些字段名称，但实际上，在我公司运送到的 16 个国家/地区中，唯一可以使用的基本格式如下：

```
 enum address-fields 
{
    name,
    company-name,
    street-lines[], // up to 4 free-type street lines
    county/sublocality,
    city/town/district,
    state/province/region/territory,
    postal-code,
    country
} 

```

这很容易映射到单个数据库表中，只允许在大多数列上使用 NULL。这似乎是亚马逊和许多组织实际存储地址数据的方式。所以剩下的问题是我应该如何在程序员和任何 GUI 代码都可以轻松使用的对象模型中对此进行建模。我们是否有一个基`Address`类型以及每种地址类型的子类，例如`AmericanAddress`、`CanadianAddress`、`GermanAddress`等等？这些地址类型中的每一个都知道如何格式化自己，并且可以选择了解一些关于字段验证的信息。

它们还可以返回有关每个字段的某种类型的元数据，例如以下伪代码数据结构：

```
 structure address-field-metadata 
{
    field-number,     // corresponds to the enumeration above
    field-index,      // the order in which the field is usually displayed
    field-name,       // a "localized" name; US == "State", CA == "Province", etc
    is-applicable,    // whether or not the field is even looked at / valid
    is-required,      // whether or not the field is required
    validation-regex, // an optional regex to apply against the field
    allowed-values[]  // an optional array of specific values the field can be set to
} 

```

事实上，我们可以采用稍微不那么面向对象的方法，让`Address`对象避开 .NET 属性并使用`AddressStrategy`来确定格式和验证规则，而不是为每个国家/地区创建单独的地址对象：

```
 object address
{
    set-field(field-number, field-value),
    address-strategy
}

object address-strategy
{
    validate-field(field-number, field-value),
    cleanse-address(address),
    format-address(address, formatting-options)
} 

```

设置字段时，该`Address`对象将在其内部`AddressStrategy`对象上调用适当的方法。

使用`SetField()`方法方法而不是使用 getter 和 setter 的属性的原因是，代码更容易以通用方式实际设置这些字段，而无需诉诸反射或 switch 语句。

你可以想象这个过程是这样的：

1.  GUI 代码调用工厂方法或类似方法来创建基于国家/地区的地址。（因此，国家下拉菜单是客户选择的第一件事，或者根据文化信息或 IP 地址为他们预先选择了一个很好的猜测。）
2.  GUI 调用`address.GetMetadata()`或类似方法并接收`AddressFieldMetadata`如上所述的结构列表。它可以使用此元数据来确定要显示的字段（忽略那些`is-applicable`设置为`false`的字段），标记这些字段的内容（使用`field-name`成员），以特定顺序显示这些字段，并对该数据执行粗略的演示级别验证（使用`is-required`、`validation-regex`和`allowed-values`成员）。
3.  GUI使用（对应于上面的枚举）及其给定值调用该`address.SetField()`方法。`field-number`然后，`Address`对象或其策略可以对这些字段执行一些高级地址验证，调用地址清理器等。

如果我们想让`Address`对象本身在创建后表现得像一个不可变对象，则上述内容可能会略有不同。（我可能会尝试这样做，因为`Address`对象实际上更像是一种数据结构，并且可能永远不会有任何与自身相关的真实行为。）

这有什么意义吗？我是否偏离 OOP 路径太远了？对我来说，这代表了在如此抽象以至于实现几乎不可能 (xAL) 与严格偏向美国之间的一种相当明智的折衷。

* * *

**2 年后更新：**我最终得到了一个与此类似的系统，并在[我已停刊的博客上](https://web.archive.org/web/20140322045505/http://nicholas.piasecki.name/blog/2010/11/inside-skiviez-mailing-addresses/)写了一篇关于它的文章。

我觉得这个解决方案是遗留数据和关系数据存储之间的正确平衡，至少对于电子商务世界来说是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T09:34:34.510

`Address`正如您所建议的，我将使用一个表格，并将其基于[xAL](http://www.oasis-open.org/committees/ciq/ciq.html#6)跟踪的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T09:34:59.190

在英国[，皇家邮政有一种名为 PAF的产品](http://www.royalmail.com/portal/rm/jump2?mediaId=400085&catId=400084)

这为每个地址提供了一个唯一的密钥——不过，有一些障碍可以跳过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T09:44:31.787

如果您想要一致性，我基本上会看到 2 个选择：

1.  数据清理
2.  基本数据表查找

广告 1\. 我使用 SAS 系统，SAS Institute 提供了一个数据清理工具 - 这基本上会对您的数据进行一些检查和验证，并建议将“Abram Lincoln Road”和“Abraham Lincoln Road”合并到同一个街道。我还认为它利用了包含城市邮政编码匹配等的国家数据库。

广告2。您建立了一个多项选择列表（即基本数据），并且添加新条目的人从您的基本数据中的现有条目中进行选择。在您的事实表中，您存储街道名称的键而不是街道名称本身。如果您检测到拼写错误，您只需在基本数据中更正它，所有实例都会通过键关系更正。

请注意，这些选项并不相互排斥，您可以同时使用这两种方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T10:57:44.200

在美国，我建议选择国家地址变更供应商，并根据他们返回的内容对数据库进行建模。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T12:33:14.127

有关如何构建地址的权威通常是邮政服务，因此首先我将检查邮政服务在您经营的主要市场中使用的数据元素。

有关国际邮政地址格式的非常具体和详细的​​信息，请参见万国邮政联盟的网站：[http ://www.upu.int/post_code/en/postal_addressing_systems_member_countries.shtml](http://www.upu.int/post_code/en/postal_addressing_systems_member_countries.shtml)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-06T12:15:07.140

“xAl 是最接近出现的全球标准的东西。不过，这似乎有点过头了，我不确定很多人会想在他们的数据库中实现它......”

这不是一个相关的论点。如果系统需要“全面和一致”（即全球范围内），则实施地址不是一项简单的任务。实施这样的标准确实很耗时，但要满足规定的要求仍然是强制性的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T09:33:38.287

标准化您的数据库模式，您将拥有正确一致性的完美结构。这就是为什么： [http ://weblogs.sqlteam.com/mladenp/archive/2008/09/17/Normalization-for-databases-is-like-Dependency-Injection-for-code.aspx](http://weblogs.sqlteam.com/mladenp/archive/2008/09/17/Normalization-for-databases-is-like-Dependency-Injection-for-code.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T10:17:24.220

我之前问过一些非常相似的问题：[动态联系信息数据/设计模式：这是否可行？](https://stackoverflow.com/questions/80876/dynamic-contact-information-datadesing-pattern-is-this-in-any-way-feasible).

简短的回答：在数据库中存储地址或任何类型的联系信息很复杂。上面的可扩展地址语言 (xAL) 链接有一些有趣的信息，这些信息最接近我遇到的标准/最佳实践......

# functional-programming - 现实世界中的清洁编程语言？

> ID：126210
> 
> 赞同：11
> 
> 时间：2008-09-24T09:31:29.133
> 
> 标签：functional-programming, clean-language

[是否有任何用Clean](http://clean.cs.ru.nl/)编程语言编写的真实世界应用程序？无论是开源的还是专有的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T09:47:16.087

这不是一个直接的答案，但是当我上次检查时（我发现该语言非常有趣），我没有找到任何适合现实世界的东西。

我自己的理想主义者总是想尝试新的语言，在我的列表中非常热门（除了前面提到的非常酷的清洁语言）目前（随机顺序）[IO](http://www.iolanguage.com/)、[Fan](http://www.fandev.org/)和[Scala](http://www.scala-lang.org/) ...

但与此同时，我会拿出我的实用主义并检查[Tiobe 指数](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)。我知道你可以讨论它，但仍然：它告诉我从现在起一年后我可以使用什么以及我可能无法使用什么......

没有双关语的意思！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-11-21T23:11:40.447

我将 Clean 与 iTasks 库一起使用，以围绕工作流程轻松构建网站。

但我想 Clean 的另一个问题是缺乏文档和示例：“The Clean book”是几年前的事了，除了他们发表的论文之外，许多新功能都没有得到记录。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-24T09:37:53.237

[http://clean.cs.ru.nl/Projects](http://clean.cs.ru.nl/Projects)页面看起来并不乐观 :) 它看起来只是另一个研究项目，迄今为止还没有实际使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-17T09:18:51.583

由于我在大学的一位教授参与了 Clean 的创建，因此他创建了一个真实世界的应用程序并不令人震惊。我们大学的排班程序完全是在 Clean 中创建的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-12T08:45:40.623

Clean IDE 和 Clean 编译器是用 Clean 编写的。( [http://wiki.clean.cs.ru.nl/Download_Clean](http://wiki.clean.cs.ru.nl/Download_Clean) )

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-23T18:21:12.333

[Cloogle](https://cloogle.org)是 Clean 库、语法等的搜索引擎（如 Haskell 的 Hoogle）是用 Clean 编写的。它的来源是 Radboud 大学的 GitLab 实例（[网络前端](https://gitlab.science.ru.nl/cloogle/cloogle-org)；[引擎](https://gitlab.science.ru.nl/cloogle/Cloogle)）。

# .net - 问题：.NET 代码从同一个磁盘上的一个目录而不是另一个目录运行

> ID：126228
> 
> 赞同：3
> 
> 时间：2008-09-24T09:37:33.847
> 
> 标签：.net, crash, directory, citrix

我们的应用程序是一个混合的 Win32 非托管应用程序和一个 .NET 2.0 托管应用程序。Win32 部分是主要的可执行文件，它有时会加载和托管 .NET 2.0 运行时并加载一些托管模块以打开新的 winforms 窗口。

我们遇到了一些 CASPOL 类型的问题，但今天我们遇到了一个非常奇怪的问题，我希望有人能给我一些指示或想法，或者基本上只是任何真正的东西，这会引发一些有助于帮助的事情我们解决这个问题。

在通过 citrix 访问的服务器上，如果应用程序文件位于当前登录用户（服务器/域管理员）桌面上的目录中，则程序运行良好。.NET 窗口按预期打开。

但是，如果我们将目录移动到同一个磁盘的根目录，这是服务器中的一个物理磁盘（因此没有 SAN 映射或任何会触发 CASPOL 命令的东西，据*我所知*）*并保持其他一切相同，相同的用户，相同的配置等*，当我们尝试调用 .NET 窗口时，应用程序会静默崩溃。它通过消失的方式崩溃，这表明它可能类似于堆栈溢出。我们正在考虑将日志记录添加到应用程序的某些部分，以便能够弄清楚发生了什么以及发生在哪里，但我也在这里发布了这个问题。

到目前为止，我们已经验证了 CASPOL 访问列表中没有异常，NGEN 缓存中也没有异常（我在想，如果服务器所有者曾经使用过它，我想可能是之前损坏的图像），并且在GAC（我们不将 GAC 用于程序集）。

总结：

*   如果程序从 U:\Documents and Settings\USERNAME\Desktop\directory 运行，它可以工作
*   如果从 U:\directory 运行，则不会
*   U：是服务器中的物理磁盘
*   NGEN 或 GAC 缓存中没有明显的异常
*   安装了正确的 .NET 运行时，安装了我们应用程序的正确文件（如果从桌面位置运行，确实可以正常工作）

有任何可能有帮助的人吗？

**编辑：**问题[在这里用不同/其他信息重新询问](https://stackoverflow.com/questions/239622/application-crashing-when-talking-to-oracle-unless-executable-path-contains-spa)，并“解决”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T11:29:40.940

前段时间我也遇到过这样的问题。拉了很多头发后，我发现了问题。

使用 Process.Start() 或任何此类调用时要非常小心，因为根据您启动它的方式，它可以使用各种文件夹作为工作环境（当前路径、系统环境等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T09:42:42.773

我的第一个尝试是从 MS-Sysinternals 运行进程监视器，并查看这两种情况下调用/结果的不同之处。也许这会给你一些提示（同一个调用的不同结果，问题运行中的一些错误不是好的......）

您可以从 MS 下载进程监视器： [http ://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T09:49:41.603

我的第一个想法是，您需要确保在程序中没有为引用程序集、文件等定义相对/绝对路径，这些路径会在您移动应用程序根目录时造成麻烦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T10:02:44.787

是否可能与用户特权有关？[从LUA Buglight](http://blogs.msdn.com/aaron_margosis/archive/2008/06/13/lua-buglight-2-0-preview.aspx)运行它来检查。即使它不直接相关，该工具也可能会提供一些有用的提示。

# .net - WPF 中 UI 虚拟化的资源和指南

> ID：126230
> 
> 赞同：13
> 
> 时间：2008-09-24T09:38:35.887
> 
> 标签：.net, wpf, performance, user-interface, ui-virtualization

UI 虚拟化是一个尴尬的术语，它描述了 WPF UI 控件，这些控件按需加载和处置子元素（基于它们的可见性）以减少内存占用。ListBox 和 ListView 默认使用一个名为 VirtualizingStackPanel 的类来实现更高的性能。

我发现[这个控件](http://blogs.msdn.com/jgoldb/archive/2008/03/08/performant-virtualized-wpf-canvas.aspx)非常有用，它是一个虚拟画布，它生成一个可滚动的 Canvas 对象，该对象使用四叉树管理其子级。它产生了一些很好的结果，并且可以很容易地根据您的需要进行调整。

是否有任何其他指南或示例 wpf 控件来处理此问题？也许通用的处理其他语言和工具包中gui对象的动态内存分配？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-24T12:46:12.397

Dan Crevier 有一个关于构建[VirtualisingTilePanel](http://blogs.msdn.com/dancre/archive/tags/VirtualizingTilePanel/default.aspx)的小教程。

Ben Constable 写了一篇关于 IScrollInfo 的教程，它是虚拟化的重要组成部分：[第 1](http://blogs.msdn.com/bencon/archive/2006/01/05/509991.aspx)部分、[第 2](http://blogs.msdn.com/bencon/archive/2006/01/06/510355.aspx)部分、[第 3 部分](http://blogs.msdn.com/bencon/archive/2006/01/07/510530.aspx)和[第 4 部分](http://blogs.msdn.com/bencon/archive/2006/12/09/iscrollinfo-tutorial-part-iv.aspx)。

# validation - 单元测试数据？

> ID：126236
> 
> 赞同：1
> 
> 时间：2008-09-24T09:39:29.770
> 
> 标签：validation, unit-testing, test-data, data-scrubbing

我们的软件管理来自各种来源的大量数据馈送：实时复制的数据库、自动通过 FTP 传输的文件、数据库存储过程的计划运行以缓存来自链接服务器的数据快照以及许多其他获取数据的方法。

我们需要验证和验证这些数据：

*   甚至发生了进口
*   数据是否合理（空值、行数等）
*   数据是否与其他值一致（也许我们有多个类似数据的来源）
*   是不是数据没了，导入需要手动提示

在很多方面，这就像单元测试：有很多类型的检查要做，只需在列表中添加一个新的检查，然后重新运行每一类测试以响应特定事件。已经有很好的 GUI 用于运行测试，甚至可以安排它们。

这是一个好方法吗？是否有更好的、类似通用的数据验证模式？

我们是一家 .NET 商店，Windows 工作流 (WF) 会是更好更灵活的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T11:30:51.127

单元测试与您需要做的事情不同。它更像是集成测试或验收测试。但这无关紧要。

您的系统对验证进入系统的数据有很高的要求。数据通过各种方式进入系统，我认为它需要以不同的方式进行验证。

工作流有利于设计和控制易于更改或需要人工干预的业务流程（逻辑）。当涉及到验证的主题时，它是不可知的。但是，将您的验证过程托管为工作流可能是一个好主意，因为工作流被设计为灵活、寿命长并且能够进行人工干预。在工作流状态机框架中托管您的验证过程将允许您在运行时为不同类型的数据导入定义验证策略。

您需要设计一个验证框架，其逻辑严重依赖于组合而不是继承。分解将数据导入系统并验证为原子步骤的所有不同方式。按职责对这些步骤进行分组，并使用实现对象执行每个步骤所需的最少、最少的属性和方法创建接口。创建由这些不同接口组成的基类。从这个框架中，您可以混合和匹配适合特定导入或验证步骤的实现。

最后一件事。工作流被序列化为 xaml 以进行长期存储。您的类也应该是 xaml 可序列化的，以使从活动到存储库的转换尽可能顺利和简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T09:56:23.163

测试这些数据的有效性似乎是合理的。您可能会或可能不会将其称为单元测试，这是您的选择。我不会。使用您认为最适合这项工作的工具 - 我不知道您所说的 WF（WebForms？）是什么意思。

通过**自动测试您获得的最大好处。**无论是自动的并为您工作的，都是好的。

# ruby-on-rails - 需要建议：子菜单的 Rails 视图结构？

> ID：126238
> 
> 赞同：4
> 
> 时间：2008-09-24T09:40:40.487
> 
> 标签：ruby-on-rails, ruby

想象一下，在您的应用程序中有两个 RESTful 控制器（UsersController、OffersController）和一个 PagesController（用于静态内容，例如 index、about 等）。

您定义了以下路线：

```
map.with_options :controller => 'pages' do |pages|
  pages.root :action => 'index'     # static home page
  pages.about :action => 'about'    # static about page
  # maybe more static pages...
end
map.resources :users    # RESTful UsersController
map.resources :posts    # RESTful PostsController 
```

您的应用程序布局如下所示：

```
<html>
  <head>
    <title>Demo Application</title>
  </head>
  <body>
    <ul id="menu">
       <li>
         <%= link_to 'Home', root_path %>
       </li>
       <li>
         <%= link_to 'Offers', offers_path %>
         <ul id="submenu>
           <li><%= link_to 'Search', 'path/to/search' %></li>
           <li>maybe more links...</li>
         </ul>
       </li>
       <li>
         <%= link_to 'About', about_path %>
       </li>
       <li>
         <%= link_to 'Admin', users_path %>
         <ul id="submenu">
           <li><%= link_to 'New User', new_user_path %></li>
           <li><%= link_to 'New Offer', new_offer_path %></li>
           <li>maybe more links</li>
         </ul>
       </li>
    </li>
    <%= yield %>
  </body>
</html> 
```

布局的问题是我希望`#submenu`在任何时候都只看到一个。所有其他子菜单都可以完全跳过（根本不需要渲染）。

以 Admin 菜单为例：该菜单应该对应用程序中的所有 RESTful 路径都有效，除了`offers_path`. 活动表示子菜单可见。

我能想到的唯一解决方案是构建一个非常复杂的 if 条件并且这很糟糕（编写和维护真的很复杂）。我正在寻找一个优雅的解决方案？

我希望有人理解我的问题 - 如果有不清楚的地方，只需评论问题，我将更详细地解释它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T14:47:05.193

您可以使用的一件事是 yield 和 content_for，与菜单的一些部分一起使用。例如，您可以将菜单的每个部分放在一个部分中，然后将您的布局修改为：

```
<%= yield(:menu) %> 
```

然后，您可以在视图中指定 content_for 并将所需的任何部分放入菜单中。如果未指定，则不会渲染。

```
<% content_for(:menu) do %>
   <%= render :partial => 'layouts/menu' %>
   <%= render :partial => 'layouts/search_menu' %>
    etc...
 <% end %> 
```

如果您在大多数页面中使用许多相同的菜单，如果没有找到 yield(:menu)，请在布局中指定默认值。

```
<%= yield(:menu) || render :partial => 'layouts/menu_default' %> 
```

为您节省大量打字。:) 我发现这是一种非常干净的处理方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:30:11.967

通常，我会抽象出菜单功能，以便我有一个辅助方法来呈现管理菜单。这样，就可以在帮助器中投入尽可能多的逻辑，而不会混淆视图逻辑。

所以，你的助手看起来像（原谅 ruby​​/rails 伪代码，我已经过了一两个月了）：

```
def render_admin_menu()
  if !current_path.contains('offer')
    render :partial => 'shared/admin_menu'
  end
end 
```

# asp.net - 如何将相对 URL 转换为完整 URL？

> ID：126242
> 
> 赞同：67
> 
> 时间：2008-09-24T09:41:35.320
> 
> 标签：asp.net

这可能用一个例子更容易解释。我正在尝试找到一种将相对 URL（例如“/Foo.aspx”或“~/Foo.aspx”）转换为完整 URL（例如[http://localhost/Foo.aspx](http://localhost/Foo.aspx) ）的方法。这样，当我部署到测试或阶段时，站点运行的域不同，我将得到[http://test/Foo.aspx](http://test/Foo.aspx)和[http://stage/Foo.aspx](http://stage/Foo.aspx)。

有任何想法吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-09-24T09:46:35.027

玩这个（[从这里](http://web.archive.org/web/20130730034405/http://www.aspdotnetfaq.com/Faq/how-to-convert-relative-url-to-absolute-url-in-asp-net-page.aspx)修改）

```
public string ConvertRelativeUrlToAbsoluteUrl(string relativeUrl) {
    return string.Format("http{0}://{1}{2}",
        (Request.IsSecureConnection) ? "s" : "", 
        Request.Url.Host,
        Page.ResolveUrl(relativeUrl)
    );
} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-01-26T15:29:13.743

这个已经被打死了，但我想我会发布我自己的解决方案，我认为它比许多其他答案更干净。

```
public static string AbsoluteAction(this UrlHelper url, string actionName, string controllerName, object routeValues)
{
    return url.Action(actionName, controllerName, routeValues, url.RequestContext.HttpContext.Request.Url.Scheme);
}

public static string AbsoluteContent(this UrlHelper url, string path)
{
    Uri uri = new Uri(path, UriKind.RelativeOrAbsolute);

    //If the URI is not already absolute, rebuild it based on the current request.
    if (!uri.IsAbsoluteUri)
    {
        Uri requestUrl = url.RequestContext.HttpContext.Request.Url;
        UriBuilder builder = new UriBuilder(requestUrl.Scheme, requestUrl.Host, requestUrl.Port);

        builder.Path = VirtualPathUtility.ToAbsolute(path);
        uri = builder.Uri;
    }

    return uri.ToString();
} 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2011-09-15T08:01:45.820

您只需要使用创建一个新的 URI `page.request.url`，然后获取`AbsoluteUri`它：

```
New System.Uri(Page.Request.Url, "Foo.aspx").AbsoluteUri 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-05-07T12:42:06.683

这是我的辅助功能

```
public string GetFullUrl(string relativeUrl) {
    string root = Request.Url.GetLeftPart(UriPartial.Authority);
    return root + Page.ResolveUrl("~/" + relativeUrl) ;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-21T14:06:57.250

我想我会使用`Uri`类和一些扩展魔法来分享我在 ASP.NET MVC 中执行此操作的方法。

```
public static class UrlHelperExtensions
{
    public static string AbsolutePath(this UrlHelper urlHelper, 
                                      string relativePath)
    {
        return new Uri(urlHelper.RequestContext.HttpContext.Request.Url,
                       relativePath).ToString();
    }
} 
```

然后，您可以使用以下命令输出绝对路径：

```
// gives absolute path, e.g. https://example.com/customers
Url.AbsolutePath(Url.Action("Index", "Customers")); 
```

嵌套的方法调用看起来有点难看，所以我更喜欢`UrlHelper`用常见的操作方法进一步扩展，这样我就可以做到：

```
// gives absolute path, e.g. https://example.com/customers
Url.AbsoluteAction("Index", "Customers"); 
```

或者

```
Url.AbsoluteAction("Details", "Customers", new{id = 123}); 
```

完整的扩展类如下：

```
public static class UrlHelperExtensions
{
    public static string AbsolutePath(this UrlHelper urlHelper, 
                                      string relativePath)
    {
        return new Uri(urlHelper.RequestContext.HttpContext.Request.Url,
                       relativePath).ToString();
    }

    public static string AbsoluteAction(this UrlHelper urlHelper, 
                                        string actionName, 
                                        string controllerName)
    {
        return AbsolutePath(urlHelper, 
                            urlHelper.Action(actionName, controllerName));
    }

    public static string AbsoluteAction(this UrlHelper urlHelper, 
                                        string actionName, 
                                        string controllerName, 
                                        object routeValues)
    {
        return AbsolutePath(urlHelper, 
                            urlHelper.Action(actionName, 
                                             controllerName, routeValues));
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T09:47:39.283

使用 .NET Uri 类来组合您的相对路径和主机名。
[http://msdn.microsoft.com/en-us/library/system.uri.aspx](http://msdn.microsoft.com/en-us/library/system.uri.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-10T16:40:35.643

这是我为进行转换而创建的辅助函数。

```
//"~/SomeFolder/SomePage.aspx"
public static string GetFullURL(string relativePath)
{
   string sRelative=Page.ResolveUrl(relativePath);
   string sAbsolute=Request.Url.AbsoluteUri.Replace(Request.Url.PathAndQuery,sRelative);
   return sAbsolute;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-17T14:07:09.850

简单地：

```
url = new Uri(baseUri, url); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-19T05:33:39.093

在 ASP.NET MVC 中，您可以使用采用or参数的[`HtmlHelper`](http://msdn.microsoft.com/en-us/library/dd492619%28v=vs.108%29.aspx)or的重载。当这些参数中的任何一个不为空时，帮助程序生成一个绝对 URL。这是我正在使用的扩展方法：[`UrlHelper`](http://msdn.microsoft.com/en-us/library/system.web.mvc.urlhelper%28v=vs.108%29.aspx)`protocol``host`

```
public static MvcHtmlString ActionLinkAbsolute<TViewModel>(
    this HtmlHelper<TViewModel> html, 
    string linkText, 
    string actionName, 
    string controllerName, 
    object routeValues = null,
    object htmlAttributes = null)
{
    var request = html.ViewContext.HttpContext.Request;
    var url = new UriBuilder(request.Url);
    return html.ActionLink(linkText, actionName, controllerName, url.Scheme, url.Host, null, routeValues, htmlAttributes);
} 
```

并从 Razor 视图中使用它，例如：

```
 @Html.ActionLinkAbsolute("Click here", "Action", "Controller", new { id = Model.Id }) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-09T17:34:16.203

古老的问题，但我想我会回答它，因为许多答案都不完整。

```
public static string ResolveFullUrl(this System.Web.UI.Page page, string relativeUrl)
{
    if (string.IsNullOrEmpty(relativeUrl))
        return relativeUrl;

    if (relativeUrl.StartsWith("/"))
        relativeUrl = relativeUrl.Insert(0, "~");
    if (!relativeUrl.StartsWith("~/"))
        relativeUrl = relativeUrl.Insert(0, "~/");

    return $"{page.Request.Url.Scheme}{Uri.SchemeDelimiter}{page.Request.Url.Authority}{VirtualPathUtility.ToAbsolute(relativeUrl)}";
} 
```

这可以作为 off Page 的扩展，就像 Web 表单的 ResolveUrl 和 ResolveClientUrl 一样。如果您想或需要在非网络表单环境中使用它，请随意将其转换为 HttpResponse 扩展。它可以正确处理标准和非标准端口上的 http 和 https，以及是否存在用户名/密码组件。它也不使用任何硬编码字符串（即：//）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-06-17T14:30:17.743

这是一种方法。这不关心字符串是相对的还是绝对的，但您必须提供一个 baseUri 供它使用。

```
 /// <summary>
    /// This function turns arbitrary strings containing a 
    /// URI into an appropriate absolute URI.  
    /// </summary>
    /// <param name="input">A relative or absolute URI (as a string)</param>
    /// <param name="baseUri">The base URI to use if the input parameter is relative.</param>
    /// <returns>An absolute URI</returns>
    public static Uri MakeFullUri(string input, Uri baseUri)
    {
        var tmp = new Uri(input, UriKind.RelativeOrAbsolute);
        //if it's absolute, return that
        if (tmp.IsAbsoluteUri)
        {
            return tmp;
        }
        // build relative on top of the base one instead
        return new Uri(baseUri, tmp);
    } 
```

在 ASP.NET 上下文中，您可以这样做：

```
Uri baseUri = new Uri("http://yahoo.com/folder");
Uri newUri = MakeFullUri("/some/path?abcd=123", baseUri);
//
//newUri will contain http://yahoo.com/some/path?abcd=123
//
Uri newUri2 = MakeFullUri("some/path?abcd=123", baseUri);
//
//newUri2 will contain http://yahoo.com/folder/some/path?abcd=123
//
Uri newUri3 = MakeFullUri("http://google.com", baseUri);
//
//newUri3 will contain http://google.com, and baseUri is not used at all.
// 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-22T04:31:59.630

从其他答案修改为使用本地主机和其他端口...我使用前。电子邮件链接。您可以从应用程序的任何部分调用，不仅在页面或用户控件中，我将其放在 Global 中，因为不需要传递 HttpContext.Current.Request 作为参数

```
 /// <summary>
            ///  Return full URL from virtual relative path like ~/dir/subir/file.html
            ///  usefull in ex. external links
            /// </summary>
            /// <param name="rootVirtualPath"></param>
            /// <returns></returns>
            public static string GetAbsoluteFullURLFromRootVirtualPath(string rootVirtualPath)
            {

                return string.Format("http{0}://{1}{2}{3}",
                    (HttpContext.Current.Request.IsSecureConnection) ? "s" : ""
                    , HttpContext.Current.Request.Url.Host
                    , (HttpContext.Current.Request.Url.IsDefaultPort) ? "" : ":" + HttpContext.Current.Request.Url.Port
                    , VirtualPathUtility.ToAbsolute(rootVirtualPath)
                    );

            } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-02-29T15:41:59.563

在 ASP.NET MVC 中，可以使用`Url.Content(relativePath)`转换为绝对 Url

# java - 反对 Java Webstart？

> ID：126260
> 
> 赞同：20
> 
> 时间：2008-09-24T09:47:20.297
> 
> 标签：java, java-web-start

自从 Adob​​e AIR 发布以来，我想知道为什么 Java Web Start 过去没有获得更多关注，因为对我来说它似乎非常相似，但是 web start 可用的时间要长得多。

主要是因为 Sun 的营销不佳，还是除了需要安装正确的 JVM 之外还有更多的技术问题？您在使用 Web Start 时有过不好的经历吗？如果是，是哪个？在使用 Web Start 分发应用程序时，您有什么建议？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-24T10:03:58.853

在我的公司，我们使用 Java Web Start 来部署 Eclipse RCP 应用程序。设置起来很痛苦，但是一旦到位就可以很好地工作。所以我能提出的唯一建议就是从小处着手，掌握其中的窍门。首先部署一个简单的应用程序。尝试部署一个在没有 JWS 经验的情况下已经制作的完整产品会很快变得复杂。

此外，学习如何将参数传递给 JWS 应用程序对于调试非常宝贵。设置环境变量 JAVAWS_VM_ARGS 允许为 Java 虚拟机设置任意属性。就我而言：

-Xdebug -Xnoagent -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=4144

当您需要在启动期间检查问题时很有帮助（suspend=y）

我认为接受 Java Web Start 的主要问题是它的设置相对困难。此外，不知何故存在这种不和谐：当您拥有桌面应用程序时，人们希望他们可以双击安装程序。当您拥有一个 Web 应用程序时，人们希望他们可以直接从浏览器中使用它。Java Web Start 不在这里也不在那里...

不过，它广泛用于内部网。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-24T17:48:28.457

我在一家银行的内部网工作了 5 年，我的部门已经开发和分发了很多 Java Web Start 应用程序，这些应用程序在世界各地都在使用，我认为 Java Web Start 拥有最好的桌面应用程序（易于开发，丰富的用户界面、客户端机器的处理能力）和互联网应用程序（易于部署和升级）。

我真的很喜欢 Java Web Start

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-24T13:53:25.497

我曾经在 JWS 做过一个项目，运行起来很痛苦。更糟糕的是，我什至没有处理整个互联网，它只是一个小型应用程序，只有我办公室里的几个人会使用。在配置服务器和帮助他们在客户端机器上设置应用程序时，我不止一次地厌恶地举起双手。

我认为 AIR 现在变得越来越流行（尽管我永远不知道它会走多远），因为它拥有人们真正想要使用的应用程序（命名你最喜欢的 JWS 应用程序......继续，我在等待），比如[twhirl](http://www.twhirl.org/)。我仍然不是 AIR 工作方式的忠实拥护者，但它比 JWS 好得多。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-09T00:31:40.093

以下是[mindprob](http://mindprod.com/jgloss/javawebstart.html#BAD)的列表：

*   Java Web Start 应用程序启动速度非常慢。监视器为自己和每个应用程序加载一个新的 JVM。应用程序总是在网络上检查更新、下载和处理一个全新的 JNLP 文件，而不仅仅是检查其日期。但是，如果检查新版本需要 80 秒左右，这意味着您可能遇到了代理服务器问题。启动 javaws.exe 并单击编辑⇒首选项⇒网络设置⇒直接。您不希望 JWS 尝试使用 Google Accelerator 代理。还要检查 IE，单击工具 ⇒ Internet 选项 ⇒ 连接 ⇒ LAN 设置，并确保一切都如您所愿。
*   更新的下载时间与原始应用程序的下载时间差不多。几乎没有任何巧妙的方法可以使更新变得紧凑。
*   它需要在 ISP 上运行的自定义代码才能正确提供 jardiff 文件或使用即将到来的 pack200 超压缩。
*   自首次发布以来，它并没有太大变化。它可能是另一个孤立的产品。这是不应该的。然而，Sun 在一年左右的时间里发布了一个新的 beta 1.2，并且它已被集成到 JRE 中，所以我们将看看它是否会再次升温。他们忽略了一些主要问题，例如证书 OK 隐藏在启动屏幕后面，并且每个 jar 单独要求 ok。即使它是孤儿，也不会发生什么可怕的事情。除非您编写未签名的 JWS 应用程序并使用 JWS 沙箱，否则您的 JWS 应用程序将独立运行。
*   它需要在 ISP 和客户端浏览器中对 JNLP MIME 类型进行特殊配置。这些都不在开发商的直接控制之下。
*   如果您有紧急更新，则不能在应用再次运行之前强制安装它。
*   它需要一个严格的方案来分配客户端机器上的硬盘空间，该方案具有以下属性：
    *   分配的目录名称必须避免与其他供应商的名称冲突。它们应该包含应用程序的主包名称。
    *   名称必须对最终用户有意义。当他需要使用桌面工具查找文件时，它们应该是他可以记住、查找和键入的内容。
    *   该方案必须为每个用户和每个应用程序文件提供一个位置。
    *   一个程序应该可以在任何平台上运行而无需修改来处理查找它的文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-13T06:47:17.947

Java Web Start 是启动更大的 Java 应用程序的正确方法，因为它允许轻松更新和安装/下载应用程序，并允许比 Java 小程序更好的 UI/UX。

*但是*，使用具有默认设置的通用浏览器从网页启动 Java Web Start 应用程序存在一些障碍：

1.  Sun/Oracle 未能创建有效的浏览器集成。有关 Google Chrome / Chromium 的示例，请参见[http://crbug.com/10877](http://crbug.com/10877)。基本上，Java 插件无法实现所需的 NPAPI 东西来让 Firefox 和 Chrome 可靠地将 MIME 类型转发`application/x-java-jnlp-file`到`javaws`/`javaws.exe`二进制文件。

2.  Sun/Oracle 未能为 Java Web Start`.jnlp`文件获得真正注册的 MIME 类型。`application/x-`前缀在技术上意味着草稿或私有。

3.  当 Java Web Start 处理应用程序下载和启动时，Sun/Oracle 未能使用 URL 方案而不是 MIME 类型。例如，如果不使用诸如`https://example.com/app/launch.jnlp`Java Web Start 之类的 URL 来启动，`javaws://example.com/app/launch.jnlp`事情会运行得更顺畅。这是因为在这种情况下，Web 浏览器甚至不需要加载`.jnlp`文件，它只需将完整的 URL 传递给方案处理程序（这将是`javaws`二进制文件）。

注意重复的部分（“ *Sun/Oracle failed ...* ”），您不再需要想知道为什么 Java Web Start 从来没有得到太多关注。最大的缺失部分是获得一个网页链接，以**可靠地**启动`javaws`带有给定文件的二进制`.jnlp`文件。这在技术上*应该*很容易（只需在`javaws`安装二进制文件时注册一个新的 URL 方案），但 Sun/Oracle 未能做到这一点。我个人认为整个混乱是由于试图弄乱 MIME 类型而不是简单地使用新的 URL 方案造成的。甚至 MIME 类型的东西也做得很糟糕，因为大声哭泣。

If you still want to use Java Web Start, simply prepare good documentation for correctly configuring the browser to workaround the mess left by Sun/Oracle. The good part is that it's only needs to be done once and it will work for any site that uses Java Web start. The bad part is that usually the browser has never been configured to do the right thing with `.jnlp` files and *you* get the blame for using "hard to use technology" because users do not want to configure their browsers just to use your application. Did I mention that it was Sun/Oracle that failed to configure the browser automatically?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-04T10:14:09.443

我的经验：
我在 2006 年使用它，用于银行的 Intranet 应用程序。

第一次下载很好，但是当要推送新版本时，jar文件的缓存不起作用，所以新文件没有推送到客户端。

花了一个星期试图解决这个问题，但没有成功。

# sql - 关系数据库中的键值对

> ID：126271
> 
> 赞同：77
> 
> 时间：2008-09-24T09:50:19.353
> 
> 标签：sql, database

有人有在数据库中存储键值对的经验吗？

我一直在使用这种类型的表：

```
CREATE TABLE key_value_pairs ( 
    itemid           varchar(32) NOT NULL,
    itemkey         varchar(32) NOT NULL,
    itemvalue       varchar(32) NOT NULL,
    CONSTRAINT ct_primarykey PRIMARY KEY(itemid,itemkey)
) 
```

然后例如可能存在以下行：

```
 itemid            itemkey        itemvalue    
 ----------------  -------------  ------------ 
 123               Colour         Red            
 123               Size           Medium             
 123               Fabric         Cotton 
```

这种方案的问题是提取数据所需的 SQL 语法非常复杂。只创建一系列键/值列会更好吗？

```
CREATE TABLE key_value_pairs ( 
    itemid            varchar(32) NOT NULL,
    itemkey1        varchar(32) NOT NULL,
    itemvalue1      varchar(32) NOT NULL,
    itemkey2        varchar(32) NOT NULL,
    itemvalue2      varchar(32) NOT NULL,
 . . .etc . . .
) 
```

这将更容易和更快地查询，但缺乏第一种方法的可扩展性。有什么建议吗？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2008-09-24T13:37:54.753

在你继续你的方法之前，我谦卑地建议你退后一步，考虑一下你是否真的想将这些数据存储在“键值对”表中。我不知道您的应用程序，但我的经验表明，每次我完成您正在做的事情时，以后我希望我创建了一个颜色表、一个织物表和一个尺寸表。

考虑参照完整性约束，如果您采用键值对方法，数据库无法告诉您何时尝试将颜色 id 存储在大小字段中

考虑一下加入具有 10 个值的表与可能具有跨多个域的数千个值的通用值的性能优势。Key Value 的索引真的有用吗？

通常做你正在做的事情背后的原因是因为域需要是“用户可定义的”。如果是这种情况，那么即使我也不会推动您即时创建表（尽管这是一种可行的方法）。

但是，如果您的理由是因为您认为它比多个表更容易管理，或者因为您正在设想一个适用于所有域的维护用户界面，那么在继续之前停下来认真思考一下。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-24T10:29:58.807

还有另一种解决方案介于两者之间。您可以为键和值使用 xml 类型的列。因此，您保留 itemid 字段，然后有一个 xml 字段，其中包含为某些键值对定义的 xml，例如`<items> <item key="colour" value="red"/><item key="xxx" value="blah"/></items>` 然后当您从数据库中提取数据时，您可以以多种不同的方式处理 xml。根据你的使用情况。这是一个可扩展的解决方案。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-09-24T12:11:18.500

在大多数情况下，您会使用第一种方法，这是因为您还没有真正坐下来思考您的模型。“嗯，我们还不知道钥匙会是什么”。一般来说，这是非常糟糕的设计。它会比实际将键作为列要慢，它们应该是。

我也会质疑为什么你的 id 是 varchar。

在极少数情况下您确实必须实现键/值表，第一个解决方案很好，但是，我通常希望将键放在单独的表中，这样您就不会将 varchars 存储为键/中的键值表。

例如，

```
CREATE TABLE valid_keys ( 
    id            NUMBER(10) NOT NULL,
    description   varchar(32) NOT NULL,
    CONSTRAINT pk_valid_keys PRIMARY KEY(id)
);

CREATE TABLE item_values ( 
    item_id NUMBER(10) NOT NULL,
    key_id  NUMBER(10) NOT NULL,
    item_value VARCHAR2(32) NOT NULL,
    CONSTRAINT pk_item_values PRIMARY KEY(item_id),
    CONSTRAINT fk_item_values_iv FOREIGN KEY (key_id) REFERENCES valid_keys (id)
); 
```

然后，您甚至可以发疯并在键中添加“类型”，从而允许进行一些类型检查。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-10-12T18:57:45.657

我曾经在数据库中使用键值对来创建电子表格（用于数据输入），出纳员将在其中总结他在收银机上工作的活动。每个 k/v 对代表一个命名单元格，用户在其中输入货币金额。这种方法的主要原因是电子表格很容易发生变化。定期添加新产品和服务（因此出现了新细胞）。此外，在某些情况下不需要某些单元格，并且可以丢弃某些单元格。

我编写的应用程序是对一个应用程序的重写，该应用程序确实将柜员表分成单独的部分，每个部分表示在不同的表格中。这里的问题是，随着产品和服务的添加，需要对模式进行修改。与所有设计选择一样，与另一个方向相比，采用某个方向也有利有弊。我的重新设计确实执行得更慢并且更快地消耗了磁盘空间。但是，它非常灵活，可以在几分钟内添加新产品和服务。然而，唯一值得注意的问题是磁盘消耗。我记得没有其他头痛。

如前所述，我通常考虑使用键值对方法的原因是当用户（可能是企业所有者）想要创建自己的类型时，该类型具有特定于用户的属性集。在这种情况下，我做出了以下决定。

如果不需要通过这些属性检索数据，或者一旦检索到一大块数据就可以将搜索推迟到应用程序，我建议将所有属性存储在单个文本字段中（使用 JSON、YAML、XML 等）。 ）。如果强烈需要通过这些属性检索数据，它就会变得混乱。

您可以创建单个“属性”表（id、item_id、key、value、data_type、sort_value），其中排序列将实际值转换为字符串可排序表示。（例如日期：“2010-12-25 12:00:00”，数字：“0000000001”）或者您可以按数据类型（例如 string_attributes、date_attributes、number_attributes）创建单独的属性表。在这两种方法的众多优点和缺点中：第一种更简单，第二种更快。两者都会导致您编写丑陋、复杂的查询。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-24T09:56:06.190

根据经验，我发现某些键将被更广泛地使用或更频繁地查询。然后，我们通常会稍微去规范化设计，以将特定字段包含在主“项目”表中。

例如。如果每个项目都有一个颜色，您可以将颜色列添加到您的项目表中。Fabric 和 Size 的使用频率可能较低，并且可以在键值对表中单独保存。您甚至可以保留键值对表中的颜色，但复制项目表中的数据以获得性能优势。

显然，这取决于数据以及您需要键值对的灵活性。它还可能导致您的属性数据的位置不一致。但是，反规范化确实极大地简化了查询并提高了它们的性能。

我通常只会在性能出现问题时才考虑去规范化，而不仅仅是为了简化查询。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-09-22T10:20:49.863

PostgreSQL 8.4 支持 hstore 数据类型，用于在单个 PostgreSQL 数据字段中存储（键、值）对集。有关其使用信息，请参阅[http://www.postgresql.org/docs/8.4/static/hstore.html](http://www.postgresql.org/docs/8.4/static/hstore.html)。虽然这是一个非常古老的问题，但考虑传递此信息，认为它可能对某人有所帮助。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-27T16:48:33.947

我认为设计此类表格的最佳方法如下：

*   将经常使用的字段作为数据库中的列。
*   提供一个 Misc 列，其中包含一个字典（在 JSON/XML/其他字符串格式中），它将包含作为键值对的字段。

要点：

*   在大多数情况下，您可以编写普通的 SQL 查询来查询 SQL。
*   您可以对键值对执行全文搜索。MySQL 有一个全文搜索引擎，否则您可以使用速度较慢的“like”查询。虽然全文搜索很糟糕，但我们假设此类查询较少，因此不会导致太多问题。
*   如果您的键值对是简单的布尔标志，则此技术与为键设置单独的列具有相同的功能。对键值对的任何更复杂的操作都应该在数据库之外完成。
*   查看一段时间内的查询频率将告诉您哪些键值对需要在列中转换。
*   这种技术还可以很容易地对数据库强制进行完整性约束。
*   它为开发人员重构他们的模式和代码提供了一条更自然的途径。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-24T10:24:50.240

我不明白为什么提取数据的 SQL 对于您的第一个设计来说应该很复杂。当然要获得一个项目的所有值，你只需这样做：

```
SELECT itemkey,itemvalue FROM key_value_pairs WHERE itemid='123'; 
```

或者，如果您只想要该项目的一个特定键：

```
SELECT itemvalue FROM key_value_pairs WHERE itemid='123' AND itemkey='Fabric'; 
```

第一个设计还使您可以灵活地随时轻松添加新键。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-24T09:53:52.060

第一种方法还可以。您可以创建一个提取所需数据的 UDF，然后调用它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-24T10:01:08.190

如果您只有很少的可能键，那么我会将它们存储为列。但是，如果可能的密钥集很大，那么您的第一种方法很好（第二种方法是不可能的）。

还是每个项目只能有有限数量的键，但键可能来自一个大集合？

您还可以考虑使用对象关系映射器来简化查询。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-24T10:01:43.820

第一种方法在您提到的成本下更加灵活。

正如您所展示的，第二种方法永远不可行。相反，您会这样做（根据您的第一个示例）

```
create table item_config (item_id int, colour varchar, size varchar, fabric varchar) 
```

当然，这仅在数据量已知且变化不大时才有效。

作为一般规则，任何需要更改表的 DDL 以进行正常工作的应用程序都应该三思而后行。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-24T10:53:22.247

只要仍然可以满足业务需求，违反规范化规则就可以了。有`key_1, value_1, key_2, value_2, ... key_n, value_n`可能没问题，直到你需要的时候`key_n+1, value_n+1`。

我的解决方案是共享属性的数据表和唯一属性的 XML。这意味着我同时使用两者。如果所有东西（或大多数东西）都有大小，那么大小就是表中的一列。如果只有对象 A 具有属性 Z，则 Z 存储为 XML，类似于 Peter Marshall 已经给出的答案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-24T09:57:15.500

第二个表严重去规范化。我会坚持第一种方法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-24T10:22:26.407

只要给定类型的项目的键/值经常更改，我认为您正在做正确的事情。
如果它们是相当静态的，那么简单地使项目表更宽更有意义。

我们使用类似（但更复杂）的方法，围绕键/值有很多逻辑，以及每个键允许的值类型的表。
这允许我们将项目定义为键的另一个实例，并且我们的中央表将任意键类型映射到其他任意键类型。它可以迅速将你的大脑打结，但是一旦你编写并封装了处理这一切的逻辑，你就有很大的灵活性。

如果需要，我可以写更多关于我们做什么的细节。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-24T10:28:30.683

如果键是动态的，或者有很多键，则使用您拥有的映射表作为第一个示例。此外，这是最通用的解决方案，随着您添加更多键，它在未来的扩展性最好，很容易编写 SQL 来获取数据，并且数据库将能够比您想象的更好地优化查询（也就是说，我不会过早地优化这个案例，除非它被证明是后来测试的瓶颈，在这种情况下，你可以考虑下面的两个选项）。

如果键是已知的集合，并且它们中的数量不多（<10，也许<5），那么我认为将它们作为项目上的值列没有问题。

如果有中等数量的已知固定键（10 - 30），那么可能有另一个表来保存 item_details。

但是，我认为不需要使用您的第二个示例结构，它看起来很麻烦。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-25T03:34:15.397

如果你走 KVP 表的路线，我不得不说我自己根本不喜欢这种技术，因为它确实很难查询，那么你应该考虑使用适当的技术将单个项目 id 的值聚集在一起适用于您使用的任何平台。

RDBMS 倾向于分散行以避免插入时的块争用，如果您有 8 行要检索，您很容易发现自己访问了表的 8 个块来读取它们。在 Oracle 上，您最好考虑使用散列集群来存储这些内容，这将极大地提高访问给定项目 ID 值的性能。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-28T08:04:36.733

您的示例不是使用键值对的一个很好的示例。一个更好的例子是在计费应用程序中使用诸如费用表、客户表和 Customer_Fee 表之类的东西。费用表将由以下字段组成：fee_id、fee_name、fee_description Customer_Fee 表将由以下字段组成：customer_id、fee_id、fee_value

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-03-06T23:34:23.967

时代变了。现在，除了关系数据库之外，您还可以使用其他数据库类型。NOSQL 选项现在包括列存储、文档存储、图形和多模型（参见：[http](http://en.wikipedia.org/wiki/NoSQL) ://en.wikipedia.org/wiki/NoSQL ）。

对于 Key-Value 数据库，您的选择包括（但不限于）CouchDb、Redis 和 MongoDB。

# sharepoint - 通过 Web 服务设置 Sharepoint 站点主题？

> ID：126274
> 
> 赞同：2
> 
> 时间：2008-09-24T09:52:11.143
> 
> 标签：sharepoint

是否可以通过 Web 服务更改 Sharepoint 2007 站点主题？我知道它可以通过带有（我认为）SPWeb.ApplyTheme 的对象模型来完成，但是除了 Webs.asmx 中的 CustomizeCss 之外，我在可用的 Web 服务中没有看到任何东西，这似乎并不是我所需要的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T10:10:01.740

这是开箱即用的。但是，您可以编写自己的自定义 SharePoint Web 服务来向您公开此功能。可以在此处找到有关如何在 SharePoint 中制作自己的自定义 Web 服务的演练：

[http://msdn.microsoft.com/en-us/library/ms464040.aspx](http://msdn.microsoft.com/en-us/library/ms464040.aspx)

另一种方法是创建您自己的主题设置器并通过请求调用它。这方面的一个例子可以在这里找到：

[http://www.sharepoint-tips.com/2006/03/automatically-applying-theme-to-site.html](http://www.sharepoint-tips.com/2006/03/automatically-applying-theme-to-site.html)

# c - 将某些东西同时作为 C 标识符和字符串？

> ID：126277
> 
> 赞同：16
> 
> 时间：2008-09-24T09:52:32.267
> 
> 标签：c, c-preprocessor, preprocessor-directive

假设您要生成匹配的标识符和字符串列表

```
enum
{
NAME_ONE,
NAME_TWO,
NAME_THREE
};

myFunction(NAME_ONE, "NAME_ONE");
myFunction(NAME_TWO, "NAME_TWO");
myFunction(NAME_THREE, "NAME_THREE"); 
```

..无需重复，无需自动生成代码，使用 C/C++ 宏

**初步猜测：**

您可以添加一个 #include 文件，其中包含

```
myDefine(NAME_ONE)
myDefine(NAME_TWO)
myDefine(NAME_THREE) 
```

然后像这样使用它两次：

```
#define myDefine(a) a,
enum {
#include "definitions"
}
#undef myDefine

#define myDefine(a) myFunc(a, "a");
#include "definitions"
#undef myDefine 
```

但是#define 不允许您将参数放在字符串中？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-24T09:55:18.203

对于您的第二个#define，您需要使用 # 预处理器运算符，如下所示：

```
#define myDefine(a) myFunc(a, #a); 
```

这会将参数转换为字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T11:04:33.827

这是声明名称列表的好方法：

```
#define FOR_ALL_FUNCTIONS(F)\
  F(NameOne)\
  F(NameTwo)\
  F(NameThree)\

#define DECLARE_FUNCTION(N)\
    void N();

#define IMPLEMENT_FUNCTION(N)\
    void N(){}

FOR_ALL_FUNCTIONS(DECLARE_FUNCTION);
FOR_ALL_FUNCTIONS(IMPLEMENT_FUNCTION); 
```

这样，此名称列表可以重复使用多次。我已经用它来制作新语言功能的原型，尽管从未最终使用它们。因此，如果不出意外，它们是在自己的发明中找到死胡同的好方法。我想知道是不是因为他们说：“宏不好”...... :)

# c++ - C99 stdint.h 头文件和 MS Visual Studio

> ID：126279
> 
> 赞同：116
> 
> 时间：2008-09-24T09:53:01.890
> 
> 标签：c++, c, visual-studio, c99

令我惊讶的是，我刚刚发现 MS Visual Studio 2003 及更高版本中缺少 C99 stdint.h。我敢肯定他们有他们的理由，但有人知道我在哪里可以下载副本吗？如果没有此标头，我就没有有用类型的定义，例如 uint32_t 等。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-09-24T09:54:09.377

事实证明，您可以从以下位置下载此标头的 MS 版本：

[https://github.com/mattn/gntp-send/blob/master/include/msinttypes/stdint.h](https://github.com/mattn/gntp-send/blob/master/include/msinttypes/stdint.h)

可以在这里找到便携式的：

[http://www.azillionmonkeys.com/qed/pstdint.h](http://www.azillionmonkeys.com/qed/pstdint.h)

感谢[Software Rambling](http://stephendoyle.blogspot.com/2008/03/c-tr1-stdinth-still-missing-from-visual.html)的博客。

*注意：*[Michael Burr](https://stackoverflow.com/users/12711/michael-burr)在评论中提到的标头的公共领域版本，可以在[此处](https://web.archive.org/web/20101104120614/http://snipplr.com/view/18199/stdinth/)找到存档副本。可以在[libusb_aah 的 Android 源代码树中](https://android.googlesource.com/platform/external/libusb_aah/+/master/msvc/stdint.h)找到更新版本。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-09-24T13:37:10.213

只需自己定义它们。

```
#ifdef _MSC_VER

typedef __int32 int32_t;
typedef unsigned __int32 uint32_t;
typedef __int64 int64_t;
typedef unsigned __int64 uint64_t;

#else
#include <stdint.h>
#endif 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2010-04-13T08:26:21.023

更新：**Visual Studio 2010**和**Visual C++ 2010 Express**都有`stdint.h`. 它可以在`C:\Program Files\Microsoft Visual Studio 10.0\VC\include`

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-09-24T11:53:21.417

Visual Studio 2003 - 2008 (Visual C++ 7.1 - 9) 不声称与 C99 兼容。（感谢 rdentato 的评论。）

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-24T13:56:48.343

Boost 包含 cstdint.hpp 头文件，其中包含您正在寻找的类型：http: [//www.boost.org/doc/libs/1_36_0/boost/cstdint.hpp](http://www.boost.org/doc/libs/1_36_0/boost/cstdint.hpp)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-24T16:04:11.233

微软不支持 C99，也没有宣布任何计划。我相信他们打算跟踪 C++ 标准，但认为 C 实际上已经过时，除了作为 C++ 的子集。

Visual Studio 2003 及更高版本中的新项目默认设置了“编译为 C++ 代码 (/TP)”选项，因此任何 .c 文件都将编译为 C++。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-25T21:51:50.017

另一种便携式解决方案：

POSH：便携式开源线束

“POSH 是一种简单、可移植、易于使用、易于集成、灵活、开源的‘线束’，旨在使编写跨平台库和应用程序的创建和移植过程显着减少繁琐。”

[http://poshlib.hookatooka.com/poshlib/trac.cgi](http://poshlib.hookatooka.com/poshlib/trac.cgi)

正如书中描述和使用的那样：编写可移植代码：为多平台开发软件的介绍 作者：Brian Hook [http://books.google.ca/books?id=4VOKcEAPPO0C](http://books.google.ca/books?id=4VOKcEAPPO0C)

-杰森

# sharepoint - 有没有人能够使用 NTLM 和 SQUID 作为反向代理来获取 SharePoint？

> ID：126288
> 
> 赞同：0
> 
> 时间：2008-09-24T09:54:26.317
> 
> 标签：sharepoint, ntlm, squid

1.  我们有一个 SQUID 反向代理和一个 MOSS 2007 门户。所有站点都使用 NTLM。
2.  我们不能让它与 SQUID 作为反向代理一起工作。

任何想法从哪里开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T09:56:47.047

您可以切换到 Kerberos 而不是 NTLM 吗？

您遇到了“双跳问题”，即 NTLM 身份验证无法遍历代理或服务器。

这在此位置进行了概述：http: [//blogs.msdn.com/knowledgecast/archive/2007/01/31/the-double-hop-problem.aspx](http://blogs.msdn.com/knowledgecast/archive/2007/01/31/the-double-hop-problem.aspx)

在这里： http: [//support.microsoft.com/default.aspx ?scid=kb;en-us;329986](http://support.microsoft.com/default.aspx?scid=kb;en-us;329986)

> 双跳问题 双跳问题是当 ASPX 页面尝试使用位于不同于 IIS 服务器的服务器上的资源时。在我们的例子中，第一个“跳跃”是从 Web 浏览器客户端到 IIS ASPX 页面；第二跳是到AD。AD 需要一个主令牌。因此，IIS 服务器必须知道客户端的密码才能将主令牌传递给 AD。如果 IIS 服务器具有辅助令牌，则使用 NTAUTHORITY\ANONYMOUS 帐户凭据。此帐户不是域帐户，对 AD 的访问权限非常有限。
> 
> 例如，当浏览器客户端使用 NTLM 身份验证对 IIS ASPX 页面进行身份验证时，就会发生使用辅助令牌的双跳。在此示例中，由于使用 NTLM，IIS 服务器具有密码的散列版本。如果 IIS 转而将凭据传递给 AD，则 IIS 正在传递散列密码。AD 无法验证密码，而是使用 NTAUTHORITY\ANONYMOUS LOGON 进行身份验证。
> 
> 另一方面，如果您的浏览器客户端通过使用基本身份验证对 IIS ASPX 页面进行身份验证，则 IIS 服务器拥有客户端密码，并且可以制作主令牌以传递给 AD。AD 可以验证密码并作为域用户进行身份验证。有关详细信息，请单击以下文章编号以查看 Microsoft 知识库中的文章：264921 ( [http://support.microsoft.com/kb/264921/](http://support.microsoft.com/kb/264921/) ) IIS 如何对浏览器客户端进行身份验证

如果切换到 Kerberos 不是一种选择，您是否调查过 Squid NTLM 项目？ [http://devel.squid-cache.org/ntlm/](http://devel.squid-cache.org/ntlm/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-22T09:52:44.830

您可以使用 HAProxy 进行负载平衡

# c++ - 自动铸造还原

> ID：126297
> 
> 赞同：0
> 
> 时间：2008-09-24T09:56:18.403
> 
> 标签：c++, casting

在我[搞砸了我之前的帖子的描述之后，我](https://stackoverflow.com/questions/121922/automatic-casts)坐下来试图表达我的确切意图。

我有一个名为 P 的类，它执行一些不同的目的。我也有 PW，它在 P 上执行一些不同的目的。PW 没有成员变量，只有成员函数。

根据此描述，您会假设代码将如下所示：

```
class P
{
public:
    void a( );
};

class PW
{
public:
    PW( const P& p ) : p( p ) { }
    void b( );
    P& p;
};

class C
{
public:
    P GetP( ) const { return p; }   
private:
    P p;
};

// ...
    PW& p = c.GetP( ); // valid
// ... 
```

然而，这带来了一个问题。我不能到处调用没有间接的 P 函数。

```
// ...
    p->p->a( )
// ... 
```

**我想做的是调用 p->a( ) 并让它自动确定我想调用 P 的成员函数。**

还有一个名为*a*的 PW 成员并不能真正扩展 - 如果我向 P 添加（或删除）另一个函数会怎么样 - 这将需要添加（或删除）到 PW。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T10:46:39.220

您可以尝试覆盖 operator* 和 operator-> 以返回对嵌入式 p 的访问。这样的事情可能会奏效：

```
class P
{
  public:
    void a( ) { std::cout << "a" << std::endl; }
};

class PW
{
  public:
    PW(P& p) : p(p) { }

    void b( ) { std::cout << "b" << std::endl; }

    P & operator*()  { return p;  }
    P * operator->() { return &p; }

  private:
    P & p;
};

class C
{
  public:
    P & getP() { return p; }

  private:
    P p;
};

int main()
{
  C c;
  PW pw(c.getP());

  (*pw).a();
  pw->a();
  pw.b();

  return EXIT_SUCCESS;
} 
```

此代码打印

```
a
a
b 
```

但是，这种方法可能会使用户感到困惑，因为 operator* 和 operator-> 的语义变得有点混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T10:05:26.743

如果你让 P 成为 PW 的超类，就像你在上一个问题中所做的那样，你可以调用 p->a() 并且它会直接指向 P 类。看起来你已经考虑过并拒绝了这一点，从这个判断问题。如果是这样，您是否愿意详细说明为什么这对您不起作用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T15:00:50.887

我觉得你需要思考一下PW和P之间存在什么样的关系。

它是一种关系吗？PW 的实例是 P 的实例吗？那么从 P 继承 PW 是有意义的。

是有关系吗？然后你应该坚持包含，并忍受语法上的不便。

顺便说一句，在类的公共接口中公开对成员变量的非常量引用通常不是一个好主意。

# apache-flex - 当 Flex 应用程序无法以指定的帧速率运行时会发生什么？

> ID：126316
> 
> 赞同：2
> 
> 时间：2008-09-24T10:04:58.633
> 
> 标签：apache-flex, flash, actionscript-3, performance

在我们的应用程序（游戏）中，在某些情况下它的运行速度不够快。显然我们想加快它的速度，但与此同时，当这种情况发生时，它会导致很多问题（或者如果它没有导致这些问题，那么两者是相关的）。与我们自己的功能最不相关的是内置的 Alert.show() 方法停止工作。通常会出现全屏透明框，但不会出现实际弹出窗口。我相信这归结于 Flex 将所有可用周期都分配给其他任务......但事实证明很难进行分析调查，所以我很高兴听到另一种解释。

需要澄清的是，Flex 的核心部分根本无法在这种情况下工作。我已经逐步完成了代码，例如在屏幕上添加了一个新元素，一切都发生了，并且在主显示画布上调用了 addChild() 方法......但随后该元素没有出现。如果我们随后禁用更新循环，该元素会突然出现。

因此，无论 Flex 是否应该运行完全相同的代码，它以某种方式阻塞都是一种奇怪的方式。正如我所说，即使是 Flex Alert.show() 方法也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T03:01:39.483

所有 Flash 内容都是逐帧执行的——Flash 执行一帧的代码，然后更新屏幕，然后等待下一帧更新。

当 Flash 无法跟上指定的帧速率时，所发生的只是在帧更新之间等待，而不是在帧更新之间等待，Flash 会尽可能快地完成它们，而不会在两者之间等待。所以唯一可见的区别是帧更新发生的频率较低。从来没有出于性能原因跳过代码、删除事件或跳过屏幕重绘的情况（除非您发现了新的错误）。

所以最有可能的罪魁祸首是，要么你的代码有一个非常依赖时间的问题（例如，期望两个计时器在同一帧上触发的代码），要么是其他一些被误诊的问题。（例如，可能有一个错误导致减速，而不是减速导致你的错误。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T11:46:36.393

我不太确定 Flex 是否有它自己的一些额外的性能处理。但是对于纯动作脚本来说，唯一会发生的事情是帧率会慢到爬行，一切都会正常发生，只是更慢。如果您堆叠大量透明或蒙版对象，您可能会遇到一些奇怪的行为，但这应该更明显。

而且我想告诉你用 Flex 制作游戏并不是一个好主意（只是因为框架的性能开销）有点晚了；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T12:34:11.787

我喜欢在 FLEX 3 (actionscript3) 中制作游戏，与 Flash CS3 相比，它实际上是非常方便的解决方案：良好的调试环境，没有麻烦。当然这取决于游戏风格哪个更好，如果你需要大量的图形你可能更喜欢 Flash，但是 Flex 允许你使用外部图像、组件等。注意我这里不是在谈论 Flex XML 项目。

回答您的性能问题：您可以使用例如旧的 MacOSX 机器来查看在非常慢的机器上会发生什么，一些解决方案是： - 当机器旧时移动对象超过 x++ y++ 像素 - 减少对象

你可以用计时器检测机器有多慢..

# svn - 撤消 Subversion 中的特定修订

> ID：126320
> 
> 赞同：33
> 
> 时间：2008-09-24T10:05:23.390
> 
> 标签：svn, undo, cherry-pick

假设我在存储库文件夹中有一组提交......

```
123 (250 new files, 137 changed files, 14 deleted files)
122 (150 changed files)
121 (renamed folder)
120 (90 changed files)
119 (115 changed files, 14 deleted files, 12 added files)
118 (113 changed files)
117 (10 changed files) 
```

我想获得一份工作副本，其中包括从修订版 117 开始的所有更改，但不包括修订版 118 和 120 的更改。

编辑：为了使问题更清楚，我想撤消在 118 和 120 中所做的更改，同时保留所有其他更改。该文件夹包含数百个子文件夹中的数千个文件。

实现这一目标的最佳方法是什么？

**感谢 Bruno 和 Bert，**答案是命令（在这种情况下，用于在执行完全合并后删除 120）****

 **```
svn merge -c -120 . 
```

请注意，必须使用前导减号指定修订号。“-120”不是“120”

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-24T10:34:52.727

要撤消修订 118 和 120：

```
svn up -r HEAD       # get latest revision
svn merge -c -120 .  # undo revision 120
svn merge -c -118 .  # undo revision 118
svn commit           # after solving problems (if any) 
```

另请参阅[撤消更改](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html#svn.branchmerge.basicmerging.undo)中的说明。

注意参数中的减号`-c -120`。从Subversion 1.4 开始支持`-c`(or `--change`) 开关，旧版本可以使用`-r 120:119`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-27T06:41:58.990

如果你使用 TortoiseSVN，一个用于 Subversion 的 Windows 客户端，还有一种更直接的方法。您只需单击以查看更新工作副本中的日志，选择要撤消的修订，右键单击，然后选择“从这些修订中恢复更改”。

这是一项安全的操作，因为更改仅应用于您的工作区。您仍然必须提交修改您的存储库。

It is one of the best features of TortoiseSVN. I've always been a command line guy, but Tortoise changed my mind.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-24T10:14:14.197

我想您可以从修订版 117 创建一个分支，然后合并除 118 和 120 之外的所有内容。

```
svn copy -r 117 source destination 
```

然后检查这个分支并从那里做`svnmerge.py merge -r119,120-123`

**编辑：**这不会撤消分支/主干中的修订。改为使用`svn merge`。

# .net - 在 Visual Studio 中指定非 .NET 依赖项

> ID：126331
> 
> 赞同：8
> 
> 时间：2008-09-24T10:09:09.933
> 
> 标签：.net, visual-studio, dll, dependencies

我正在使用 P/Invoke 从我的项目中调用非 .NET dll，这意味着 .dll 必须始终存在于 .exe 的目录中。

有没有办法告诉Visual Studio这个依赖，这样编译时会自动将.dll复制到输出目录，并在setup中自动包含.dll？还是我必须手动执行此操作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T10:13:39.393

您可以简单地将 .DLL 添加到您的项目中。

选择该文件的`Properties`窗格并设置`Build Action`为`Content`和`Copy to Output Directory`。`Copy if newer`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-24T10:18:05.810

您可以将此文件复制/链接到项目，并在属性窗口中将“构建操作”设置为“无”，将“复制到输出目录”设置为“如果较新则复制”或“始终复制”。

或者您可以使用“预构建事件”和“构建后事件”，您可以在其中指定任何批处理脚本。

我更喜欢第二种选择，因为这种方式比第一种更灵活。

您还可以修改 MSBuild 文件并添加复制文件的任务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-04T00:20:49.680

我认为仅将 .DLL 添加到项目中的一个问题是，您可能需要不同版本的 DLL 来进行调试和发布构建。您认为您可以将 DLL 的调试版本和发布版本都添加到文件中，并根据配置排除不合适的版本，但我找不到这样做的方法。我正在使用 Visual Studio 2010。我很肯定这在过去与 VS6 一起工作。

# ruby-on-rails - Rails 中确定两个（或多个）给定 URL（作为字符串或哈希选项）是否相等的最佳方法是什么？

> ID：126332
> 
> 赞同：7
> 
> 时间：2008-09-24T10:09:30.510
> 
> 标签：ruby-on-rails, ruby, url, routes

我想要一个名为 same_url 的方法？如果传入的 URL 相等，则返回 true。传入的 URL 可能是参数选项哈希或字符串。

```
same_url?({:controller => :foo, :action => :bar}, "http://www.example.com/foo/bar") # => true 
```

Rails 框架助手[current_page?](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#M001607) 似乎是一个很好的起点，但我想传入任意数量的 URL。

作为额外的奖励如果可以传入要从比较中排除的参数散列会很好。所以方法调用可能如下所示：

```
same_url?(projects_path(:page => 2), "projects?page=3", :excluding => :page) # => true 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T12:25:41.400

这是方法（将其放入 /lib 并在 environment.rb 中需要它）：

```
def same_page?(a, b, params_to_exclude = {})
  if a.respond_to?(:except) && b.respond_to?(:except)
    url_for(a.except(params_to_exclude)) == url_for(b.except(params_to_exclude))
  else
    url_for(a) == url_for(b)
  end
end 
```

**如果您在 Rails pre-2.0.1 上**，您还需要将`except`帮助方法添加到 Hash：

```
class Hash
  # Usage { :a => 1, :b => 2, :c => 3}.except(:a) -> { :b => 2, :c => 3}
  def except(*keys)
    self.reject { |k,v|
      keys.include? k.to_sym
    }
  end
end 
```

Rails 的更高版本（嗯，ActiveSupport）`except`已经包含（来源：[Brian Guthrie](https://stackoverflow.com/users/77859/brian-guthrie)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T11:55:31.083

这是你追求的那种东西吗？

```
def same_url?(one, two)
  url_for(one) == url_for(two)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T23:48:21.753

```
def all_urls_same_as_current? *params_for_urls
  params_for_urls.map do |a_url_hash| 
    url_for a_url_hash.except(*exclude_keys)
  end.all? do |a_url_str|
    a_url_str == request.request_uri
  end
end 
```

其中：

*   `params_for_urls`是 url 参数的哈希数组（每个数组条目都是构建 url 的参数）
*   `exclude_keys`是您要忽略的键的符号数组
*   `request.request_uri`可能不完全是你应该使用的，见下文。

* * *

然后，在实现版本时，您需要考虑各种事情：

*   你想比较完整的 uri 与域、端口和所有，还是只是路径？
*   如果只是路径，您是否仍要比较在问号之后传递的参数还是仅比较构成实际路径路径的参数？

# xml - 对于 2.4MB 的 XML 文件，您会推荐哪个 Ruby XML 库？

> ID：126337
> 
> 赞同：16
> 
> 时间：2008-09-24T10:10:25.813
> 
> 标签：xml, ruby

我有一个 2.4 MB 的 XML 文件，它是从 Microsoft Project 导出的（嘿，我是这里的受害者！），我被要求从中提取某些细节以进行重新演示。忽略请求的智能或其他方面，从 Ruby 的角度来看，我应该首先尝试哪个库？

我知道以下内容（排名不分先后）：

*   [REXML](http://www.germane-software.com/software/rexml/)
*   [Chilkat Ruby XML 库](http://www.chilkatsoft.com/ruby-xml.asp)
*   [杏花XML](http://code.whytheluckystiff.net/hpricot/wiki/HpricotXML)
*   [库XML](http://libxml.rubyforge.org/)

我更喜欢打包为 Ruby gem 的东西，我怀疑 Chilkat 库不是。

性能不是一个主要问题——我不认为这个东西需要每天运行一次以上（每周一次更有可能）。我对与 XML 相关的任何东西一样容易使用的东西更感兴趣。

编辑：我尝试了宝石化的：

hpricot 是最简单的。例如，要提取此 XML 中 SaveVersion 标记的内容（保存在名为“test.xml”的文件中）

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Project xmlns="http://schemas.microsoft.com/project">
    <SaveVersion>12</SaveVersion>
</Project> 
```

需要这样的东西：

```
doc = Hpricot.XML(open('test.xml'))
version = (doc/:Project/:SaveVersion).first.inner_html 
```

hpricot 似乎相对不关心命名空间，在这个例子中这很好：只有一个，但可能是复杂文档的问题。由于 hpricot 也很慢，我宁愿想象这将是一个可以自行解决的问题。

libxml-ruby 速度快了一个数量级，可以理解命名空间（我花了好几个小时才弄清楚这一点），并且完全更接近 XML 金属 - XPath 查询和所有其他东西都在那里。如果像我一样只在极端胁迫的情况下打开 XML 文档，这未必是件好事。帮助器模块主要有助于提供如何有效处理默认命名空间的示例。这大致就是我最终得到的结果（我并没有以任何方式断言它的美丽、正确性或其他价值，这就是我现在所处的位置）：

```
xml_parser = XML::Parser.new
xml_parser.string = File.read(path)
doc = xml_parser.parse
@root = doc.root
@scopes = { :in_node => '', :in_root => '/', :in_doc => '//' }
@ns_prefix = 'p'
@ns = "#{@ns_prefix}:#{@root.namespace[0].href}"
version = @root.find_first(xpath_qry("Project/SaveVersion", :in_root), @ns).content.to_i

def xpath_qry(tags, scope = :in_node)
  "#{@scopes[scope]}" + tags.split(/\//).collect{ |tag| "#{@ns_prefix}:#{tag}"}.join('/')
end 
```

我仍在争论利弊：libxml 是因为它更加严格，hpricot 是因为 _why 代码的纯粹风格。

稍后再编辑：我发现了HappyMapper（'gem install happymapper'），如果仍处于早期阶段，它是非常有前途的。它是声明性的并且大部分都有效，尽管我发现了一些我还没有修复的边缘情况。它可以让你做这样的事情，解析我的谷歌阅读器 OPML：

```
module OPML
  class Outline
    include HappyMapper
    tag 'outline'
    attribute :title, String
    attribute :text, String
    attribute :type, String
    attribute :xmlUrl, String
    attribute :htmlUrl, String
    has_many :outlines, Outline
  end
end

xml_string = File.read("google-reader-subscriptions.xml")

sections = OPML::Outline.parse(xml_string) 
```

我已经喜欢它了，尽管它还不完美。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-18T11:40:51.600

Nokogiri 使用干净的 Rubyish API 包装 libxml2 和 libxslt，该 API 支持命名空间、XPath 和 CSS3 查询。也快。 [http://nokogiri.org/](http://nokogiri.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-28T21:05:31.247

[Hpricot](http://code.whytheluckystiff.net/hpricot/wiki/HpricotBasics)可能是最适合您的工具——它易于使用并且可以毫无问题地处理 2mg 文件。

Speedwise libxml 应该是最好的。几个月前，我为 python 使用了 libxml2 绑定（那时 rb-libxml 已经过时了）。流接口对我来说效果最好（Ruby gem 中的 LibXML::XML::Reader）。它允许在下载文件的同时处理文件，比 SAX 更加用户友好，并且允许我在一分钟多一点的时间内将来自 Internet 的 30mb xml 文件中的数据加载到 MySQL 数据库中。

# http - 重定向到同一个 URL 是否安全？

> ID：126345
> 
> 赞同：12
> 
> 时间：2008-09-24T10:12:05.387
> 
> 标签：http, browser, compatibility

我有形式的 URL `http://domain/image/⟨uuid⟩/42x42/some_name.png`。Web 服务器 (nginx) 配置为查找文件`/some/path/image/⟨uuid⟩/thumbnail_42x42.png`，如果文件不存在，则将 URL 发送到后端（Django 通过 mod_wsgi），然后生成缩略图。然后后端发出 302 重定向到客户端请求的完全相同的 URL，其想法是在第二次请求时服务器会注意到缩略图文件并直接发送它。

问题是，这适用于所有浏览器吗？到目前为止，测试显示没有问题，但我可以确定所有用户代理都会按预期解释吗？

*更新：*让我澄清一下意图。目前这工作如下：

1.  客户端请求图像的缩略图。
2.  服务器看到文件不存在，所以将请求转发到后端。
3.  后端创建缩略图并返回 302。
4.  后端释放所有资源，让服务器将新生成的文件共享给当前和后续客户端。

让后端服务于新创建的图像更糟糕，原因有两个：

1.  必须创建两种提供相同数据的方式；
2.  服务器在提供静态内容方面要好得多。如果客户端的链接非常慢怎么办？后端不是特别快，内存效率也不是特别高，在给客户端喂食的同时将其保存在内存中可能是一种浪费。

所以我让后端工作的时间最短。

*更新²：*我非常感谢有大量浏览器经验的人的一些 RFC 参考或意见。所有这些肯定的答案都令人愉快，但它们看起来有些毫无根据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T10:14:01.340

如果没有，客户端就坏了。大多数客户端将遵循重定向循环，直到达到最大值。所以是的，在您的后端由于任何原因不生成缩略图之前应该没问题。

您可以改为将 URL 更改为[http://domain/djangoapp/generate_thumbnail](http://domain/djangoapp/generate_thumbnail)，这将返回缩略图和正确的内容类型等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T11:00:45.037

是的，可以重定向到与以前相同的 URI。

# sql-server - 如何保护 MS SSAS 2005 以通过 Internet 进行 HTTP 远程访问？

> ID：126350
> 
> 赞同：4
> 
> 时间：2008-09-24T10:13:16.210
> 
> 标签：sql-server, ssas

我们正在构建一个托管应用程序，该应用程序使用 MS SQL Server Analysis Services 2005 进行一些报告，特别是 OLAP 多维数据集浏览。由于它旨在供非常大型的全球组织使用，因此安全性很重要。

微软浏览 OLAP 多维数据集的首选客户端工具似乎是 Excel 2007，整个基础架构都围绕 Windows 集成身份验证。但是，我们正在尝试构建面向 Internet 的 Web 应用程序，并且不想为每个用户创建 Windows 帐户。

似乎也没有很多不错的基于 AJAXy Web 的 OLAP 多维数据集浏览工具（快速、拖放维度、支持动作、跨浏览器等）。顺便说一句，我们目前正在使用[Dundas OLAP Grid](http://www.dundas.com/Products/Chart/NET/OLAP/index.aspx)但也考虑[过 RadarCube](http://www.radar-soft.com/products/radaraspnet_MSAS.aspx)和其他更昂贵的商业解决方案，并且仍在考虑采用[CellSetGrid](http://www.sqlserveranalysisservices.com/cellsetgrid/cellsetgridintro.htm)并进一步开发它 - 如果您知道任何其他廉价/开放的解决方案，请告诉我！

因此，我们计划提供两种访问多维数据集数据的模式：

1.  通过我们自己的 Web 应用程序，使用这些第 3 方基于 Web 的 OLAP 浏览工具之一。
2.  通过 msmdpump.dll 数据泵通过 HTTPS 从 Excel 直接访问，适用于当 Web 版本太慢/笨拙或用户需要更强大的分析时。

对于 Web 应用程序访问，与 SSAS 数据源的连接发生在 Web 服务器上，因此我们可以愉快地在连接字符串上传递一个 CustomData 项，该项指示正在连接的用户。由于我们可能拥有太多的权限组合来为其创建单独的 SSAS 角色，因此我们实现了**动态维度安全性**，该安全性使用“多维数据集用户”维度与连接字符串中的 CustomData 项并限制各种其他维度成员的允许集相应地（通过与包含“权限映射”的度量组的其他多对多维度关系）

参见 Mosha 关于 Dimension Security： [http ://www.sqljunkies.com/WebLog/mosha/archive/2004/12/16/5605.aspx](http://www.sqljunkies.com/WebLog/mosha/archive/2004/12/16/5605.aspx)

到目前为止，这一切似乎都运行良好。

对于来自 Excel 的“直接连接”，我们为 HTTP 访问设置了数据泵（请参阅[MS Technet 文章](http://www.microsoft.com/technet/prodtechnol/sql/2005/httpasws.mspx)），但启用了匿名访问，再次依赖连接字符串来控制访问，因为我们没有 Windows 帐户。但是，在这种情况下，连接字符串由用户控制（我们从 Web 应用程序推送一个 .odc 文件，但好奇的用户可以查看和更改它），因此我们不能依赖用户良好并保留 CustomData =grunt@corp.org 从更改为 CustomData=superuser@corp.org。事实证明，这也会导致与角色相同的问题，因为如果您**不**使用 Windows 集成身份验证，这些也会在连接字符串中指定。

因此，问题归结为：有没有一种方法可以在没有 Windows 帐户的情况下在 IIS 中获得基本身份验证，从而可以与 SSAS 数据泵一起使用，让 SSAS 知道哪个用户正在连接，以便动态维度安全性可以能成功使用吗？

（这是我在 StackOverflow 上的第一个问题，可能是我问过的最复杂的问题：让我知道我没有很好地解释自己的地方，我会尝试澄清）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T12:15:10.507

基本身份验证将与本地用户帐户（非域）一起使用，如果本地帐户存在于不同的机器上，甚至支持直通身份验证，但是您应该强制使用 SSL，因为基本身份验证以明文形式发送密码。

您可以在带有附加组件的 IIS 中使用具有基本身份验证的非 Windows 帐户，例如[http://www.codeplex.com/CustomBasicAuth](http://www.codeplex.com/CustomBasicAuth)，但 SSAS 仍然需要知道该用户是谁，并且据我所知 SSAS 仅使用Windows 身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T10:51:57.443

对于 SSAS 的（相对）便宜的瘦客户端前端，请查看[RSInteract](http://www.rsinteract.com/about/index.html)。对于奖励积分，它还将消耗 SSRS 报告和报告模型。

任何使用维度安全性的尝试都需要 SSAS 了解用户并拥有他们的访问权限。我看不出有任何方法可以绕过维护用户权限。

# python - 使用 TurboGears 的 Facebook 应用示例——pyFacebook

> ID：126356
> 
> 赞同：2
> 
> 时间：2008-09-24T10:14:07.473
> 
> 标签：python, facebook, turbogears

我有一个想要通过 Facebook 运行的 TurboGears 应用程序，并且正在寻找一个使用 pyFacebook 或 minifb.py 的示例 TurboGears 项目。pyFacebook 是以 Django 为中心的，我大概可以弄清楚，但这毕竟是懒惰的网络。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T10:31:00.957

为什么 pyFacebook 以 django 为中心？看起来它在所有类型的 WSGI 应用程序或 Python 应用程序中都能正常工作。无需使用 Django。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T22:32:28.587

pyFacebook 以 Django 为中心，因为它包含一个 Django 示例。我并不打算讨厌，而只是在寻找使用 pyFacebook 的 TurboGears 示例。

# python - 尝试安装 psycopg2 时“找不到 -lpq”

> ID：126364
> 
> 赞同：1
> 
> 时间：2008-09-24T10:16:00.230
> 
> 标签：python, postgresql, trac

**简介**：我正在尝试将我们的 Trac SQLite 迁移到 PostgreSQL 后端，为此我需要 psycopg2。点击 www.initd.org 上令人尴尬的咆哮后，我下载了最新版本并尝试运行`setup.py install`. 这没有用，告诉我我需要mingw。所以我下载并安装了mingw。

**问题**：我现在在运行时收到以下错误`setup.py build_ext --compiler=mingw32 install`：

```
running build_ext
building 'psycopg2._psycopg' extension
writing build\temp.win32-2.4\Release\psycopg\_psycopg.def
C:\mingw\bin\gcc.exe -mno-cygwin -shared -s build\temp.win32-2.4\Release\psycopg
\psycopgmodule.o build\temp.win32-2.4\Release\psycopg\pqpath.o build\temp.win32-
2.4\Release\psycopg\typecast.o build\temp.win32-2.4\Release\psycopg\microprotoco
ls.o build\temp.win32-2.4\Release\psycopg\microprotocols_proto.o build\temp.win3
2-2.4\Release\psycopg\connection_type.o build\temp.win32-2.4\Release\psycopg\con
nection_int.o build\temp.win32-2.4\Release\psycopg\cursor_type.o build\temp.win3
2-2.4\Release\psycopg\cursor_int.o build\temp.win32-2.4\Release\psycopg\lobject_
type.o build\temp.win32-2.4\Release\psycopg\lobject_int.o build\temp.win32-2.4\R
elease\psycopg\adapter_qstring.o build\temp.win32-2.4\Release\psycopg\adapter_pb
oolean.o build\temp.win32-2.4\Release\psycopg\adapter_binary.o build\temp.win32-
2.4\Release\psycopg\adapter_asis.o build\temp.win32-2.4\Release\psycopg\adapter_
list.o build\temp.win32-2.4\Release\psycopg\adapter_datetime.o build\temp.win32-
2.4\Release\psycopg\_psycopg.def -LC:\Python24\libs -LC:\Python24\PCBuild -Lc:/P
ROGRA~1/POSTGR~1/8.3/lib -lpython24 -lmsvcr71 -lpq -lmsvcr71 -lws2_32 -ladvapi32
 -o build\lib.win32-2.4\psycopg2\_psycopg.pyd
C:\mingw\bin\..\lib\gcc\mingw32\3.4.5\..\..\..\..\mingw32\bin\ld.exe: cannot fin
d -lpq
collect2: ld returned 1 exit status
error: command 'gcc' failed with exit status 1 
```

**我试过**的 - 我注意到 -L 选项中的正斜杠，所以我在 setup.cfg 的 library_dirs 选项中手动输入了我的 PostgreSQL lib 目录，但无济于事（然后调用有一个带反斜杠的 -L 选项，但错误信息保持不变）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T10:59:27.770

您是否尝试过Windows 的 psycopg2[二进制构建？](http://www.stickpeople.com/projects/python/win-psycopg/)如果这适用于您的 python，那么它可以减少手动构建的需要。

我看到随机的人在各种列表上提出这个问题，似乎一个建议是手动构建 postgresql 来解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T11:00:28.033

在 Windows 上编译扩展可能很棘手。但是有可用的预编译库：http: [//www.stickpeople.com/projects/python/win-psycopg/](http://www.stickpeople.com/projects/python/win-psycopg/)

# c# - 在 c# 中控制对内部集合的访问 - 需要模式

> ID：126367
> 
> 赞同：5
> 
> 时间：2008-09-24T10:16:49.243
> 
> 标签：c#, design-patterns, collections, data-access

这有点难以解释，我希望我的英语足够：

我有一个“A”类，它应该维护一个“B”类对象的列表（如私有列表）。“A”类的消费者应该能够将项目添加到列表中。将项目添加到列表后，消费者应该不能再次修改它们，更不用说他不能对列表本身进行调整（添加或删除项目）。但他应该能够枚举列表中的项目并获取它们的值。有它的模式吗？你会怎么做？

如果问题不够清楚，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T10:34:54.270

为了防止编辑列表或其项目，您必须使它们成为[不可变](http://en.wikipedia.org/wiki/Immutable_object)的，这意味着您必须在每次请求时返回元素的新实例。

请参阅 Eric Lippert 的优秀系列“C# 中的不变性”：http: [//blogs.msdn.com/ericlippert/archive/tags/Immutability/C_2300_/default.aspx](http://blogs.msdn.com/ericlippert/archive/tags/Immutability/C_2300_/default.aspx)（您必须向下滚动一点）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T13:07:09.273

正如许多这些答案所示，有很多方法可以使集合本身不可变。

保持集合的成员不可变需要更多的努力。一种可能性是使用外观/代理（对不起，不够简洁）：

```
class B
{
    public B(int data) 
    { 
        this.data = data; 
    }

    public int data
    {
        get { return privateData; }
        set { privateData = value; }
    }

    private int privateData;
}

class ProxyB
{
    public ProxyB(B b)   
    { 
        actual = b; 
    }

    public int data
    {
        get { return actual.data; }
    }

    private B actual;
}

class A : IEnumerable<ProxyB>
{
    private List<B> bList = new List<B>();

    class ProxyEnumerator : IEnumerator<ProxyB>
    {
        private IEnumerator<B> b_enum;

        public ProxyEnumerator(IEnumerator<B> benum)
        {
            b_enum = benum;
        }

        public bool MoveNext()
        {
            return b_enum.MoveNext();
        }

        public ProxyB Current
        {
            get { return new ProxyB(b_enum.Current); }
        }

        Object IEnumerator.Current
        {
            get { return this.Current; }
        }

        public void Reset()
        {
            b_enum.Reset();
        }

        public void Dispose()
        {
            b_enum.Dispose();
        }
    }

    public void AddB(B b) { bList.Add(b); }

    public IEnumerator<ProxyB> GetEnumerator()
    {
        return new ProxyEnumerator(bList.GetEnumerator());
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
} 
```

此解决方案的缺点是调用者将遍历 ProxyB 对象的集合，而不是他们添加的 B 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T10:20:06.240

**编辑：**添加了对版本上下文的支持。调用者只能在版本上下文中添加元素。您还可以强制在实例的生命周期内只能创建一个版本上下文。

* * *

使用封装，您可以定义任何一组策略来访问内部私有成员。以下示例是您要求的基本实现：

```
namespace ConsoleApplication2
{
    using System;
    using System.Collections.Generic;
    using System.Collections;

    class B
    {
    }

    interface IEditable
    {
        void StartEdit();
        void StopEdit();
    }

    class EditContext<T> : IDisposable where T : IEditable
    {
        private T parent;

        public EditContext(T parent)
        {
            parent.StartEdit();
            this.parent = parent;
        }

        public void Dispose()
        {
            this.parent.StopEdit();
        }
    }

    class A : IEnumerable<B>, IEditable
    {
        private List<B> _myList = new List<B>();
        private bool editable;

        public void Add(B o)
        {
            if (!editable)
            {
                throw new NotSupportedException();
            }
            _myList.Add(o);
        }

        public EditContext<A> ForEdition()
        {
            return new EditContext<A>(this);
        }

        public IEnumerator<B> GetEnumerator()
        {
            return _myList.GetEnumerator();
        }

        IEnumerator IEnumerable.GetEnumerator()
        {
            return this.GetEnumerator();
        }

        public void StartEdit()
        {
            this.editable = true;
        }

        public void StopEdit()
        {
            this.editable = false;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            A a = new A();
            using (EditContext<A> edit = a.ForEdition())
            {
                a.Add(new B());
                a.Add(new B());
            }

            foreach (B o in a)
            {
                Console.WriteLine(o.GetType().ToString());
            }

            a.Add(new B());

            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T10:32:04.263

您基本上希望避免放弃对 B 类项目的引用。这就是为什么你应该做一个项目的副本。

我认为这可以通过 List 对象的 ToArray() 方法解决。如果要防止更改，则需要创建列表的深层副本。

一般来说：在大多数情况下，为了强制执行良好的行为而进行复制是不值得的，尤其是当您还写信给消费者时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T10:38:34.527

```
public class MyList<T> : IEnumerable<T>{

    public MyList(IEnumerable<T> source){
        data.AddRange(source);
    }

    public IEnumerator<T> GetEnumerator(){
        return data.Enumerator();
    }

    private List<T> data = new List<T>();
} 
```

缺点是消费者可以修改它从 Enumerator 获得的项目，解决方案是对私有 List<T> 进行深度复制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T10:40:55.363

不清楚您是否还需要 B 实例本身在添加到列表后是不可变的。您可以在这里通过使用 B 的只读接口来玩一个技巧，并且只通过列表公开这些。

```
internal class B : IB
{
    private string someData;

    public string SomeData
    {
        get { return someData; }
        set { someData = value; }
    }
}

public interface IB
{
    string SomeData { get; }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T10:48:50.947

如果不再允许编辑，我能想到的最简单的方法是返回基础集合的[只读版本。](http://msdn.microsoft.com/en-us/library/e78dcd75.aspx)

```
public IList ListOfB
{
    get 
    {
        if (_readOnlyMode) 
            return listOfB.AsReadOnly(); // also use ArrayList.ReadOnly(listOfB);
        else
            return listOfB;
    }
} 
```

但就个人而言，我不会向客户端公开底层列表，而只是提供添加、删除和枚举 B 实例的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T11:11:14.510

哇，对于一个简单的问题，这里有一些过于复杂的答案。

拥有私人`List<T>`

有一个`public void AddItem(T item)`方法——每当你决定让它停止工作时，让它停止工作。你可以抛出一个异常，或者你可以让它静默失败。就看你那边的情况了。

有一个`public T[] GetItems()`方法`return _theList.ToArray()`

# scrum - 在 Scrum 中，细节在哪里？

> ID：126369
> 
> 赞同：5
> 
> 时间：2008-09-24T10:17:34.577
> 
> 标签：scrum

我们现在在几个项目中使用 Scrum 并取得了不同程度的成功，我现在有一个与文档相关的查询。

在 Scrum 中，您显然有产品待办事项（“应用程序从调出用户正在使用的最后一个文档开始。”）和 sprint 任务待办事项（“实施忘记密码屏幕”）。但是，在我看到的所有示例中，这两个项目在细节方面都相当高水平（被设计成贴合便利贴）。

那么，细节在哪里呢？假设客户对库存管理屏幕有一些非常具体的要求，或者有一个复杂的 API 需要在后端集成，这是在哪里记录的，如何以及谁捕获这些信息？它是否与积压工作分开，但以即时或其他方式填充？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T10:31:31.657

[冲刺积压](http://en.wikipedia.org/wiki/Scrum_(development)#Sprint_backlog)

> sprint backlog 是一份非常详细的文档，其中包含有关团队将如何为即将到来的 sprint 实施需求的信息。任务被分解为小时，没有任务超过 16 小时。如果一项任务超过 16 小时，则应进一步细分。sprint backlog 上的任务永远不会被分配，而是由团队成员根据需要注册。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T10:35:16.970

详细信息可以放在可供整个团队使用的 wiki 中，并且可以由整个团队进行编辑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-12T23:22:44.937

不确定这是否像听起来那么简单。我们也看到了细节部分的挑战。假设我们正在开发一个需要捕获简单联系信息的故事，例如 CRM 系统。我现在有来自 PO 的故事，我们通过了 sprint 计划会议并了解了符合我们速度的前 5 个故事。然而，捕捉对话的所有细节总是很困难，例如屏幕需要如何布局，屏幕上需要有哪些 20 多个字段，其中一些字段是否可以从其他表中查找信息/视图等。谁捕获这些细节，应该是 PO 还是开发人员，以及存储这些细节的最佳实践是什么。我们现在正在尝试使用 wiki 来解决这个问题，

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-24T10:29:09.933

我的理解是，诸如此类的特定要求由产品负责人处理。他们将在 Sprint 计划 2 期间与客户联络，并根据需要根据特定要求更新任务 - 因此产品负责人是 Sprint 计划 2 会议的可选参与者。这为您提供了 Just-in-Time 和 Sprint Planning 2 详细信息的混合体。任何在您开始执行任务时不满意的事情都会成为障碍，并且应该由产品负责人在每日例会中处理。

由于在使用 Scrum 时开发是敏捷的，因此您不应该发现太多及时获取需求的问题。

# javascript - 如何通过动态内容生成实现不显眼的 javascript？

> ID：126373
> 
> 赞同：7
> 
> 时间：2008-09-24T10:19:01.313
> 
> 标签：javascript, jquery

我编写了很多动态生成的内容（在 PHP 下开发），我使用 jQuery 为我的项目增加了额外的灵活性和功能。

问题是很难以不显眼的方式添加 JavaScript。这是一个例子：

您必须生成随机数量的`div`元素，每个元素都触发了不同的功能`onClick`。我可以使用元素`onclick`上的属性`div`来调用带有参数的 JS 函数，但这只是一个糟糕的解决方案。此外，我可以在我的 PHP 循环中生成一些 jQuery 代码以及每个 div `for`，但是这也不会完全不引人注目。

那么在这种情况下有什么解决方案呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T10:30:18.883

您需要向 div 添加一些内容来定义它们具有的行为类型，然后使用 jQuery 选择这些 div 并添加行为。一种选择是使用 class 属性，尽管可以说这应该用于表示而不是行为。另一种选择是 rel 属性，但我通常发现您还想为每种行为指定不同的 CSS，因此在这种情况下类可能没问题。

因此，例如，假设您想要奇偶行为：

```
<div class="odd">...</div>
<div class="even">...</div>
<div class="odd">...</div>
<div class="even">...</div> 
```

然后在 jQuery 中：

```
$(document).load(function() {
$('.odd').click(function(el) {
// do stuff
});
$('.even').click(function(el) {
// dostuff
});
}); 
```

jQuery 有一个非常强大的选择器引擎，可以基于任何基于 CSS 的选择器进行查找，并且还支持一些 XPath 和它自己的选择器。认识他们！[http://docs.jquery.com/Selectors](http://docs.jquery.com/Selectors)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T11:30:34.277

我建议你使用这个叫做“[事件委托](http://icant.co.uk/sandbox/eventdelegation/)”的东西。这就是它的工作原理。

所以，如果你想更新一个区域，比如一个 div，并且你想不显眼地处理事件，你可以将一个事件处理程序附加到 div 本身。使用您喜欢的任何框架来执行此操作。事件附件可以随时发生，无论您是否更新了 div。

附加到此 div 的事件处理程序将接收事件对象作为其参数之一。使用此事件对象，您可以确定是哪个元素触发了该事件。您可以多次更新 div：由 div 的子级生成的事件将冒泡到 div 中，您可以在其中捕获和处理它们。

如果您正在考虑将多个处理程序附加到 div 内的许多元素，这也证明是一个巨大的性能优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T10:52:42.810

我建议忽略 W3C 标准，并在需要附加处理程序的元素上写出 HTML 属性：

*注意：这**不会**破坏页面的渲染！*

```
<ul>
    <li handler="doAlertOne"></li>
    <li handler="doAlertTwo"></li>
    <li handler="doAlertThree"></li>
</ul> 
```

声明几个函数：

```
function doAlertOne() { }
function doAlertTwo() { }
function doAlertThree() { } 
```

然后像这样使用jQuery：

```
$("ul li").each(function ()
{
    switch($(this).attr("handler"))
    {
        case "doAlertOne":
            doAlertOne();
            break;

        case ... etc.
    }
}); 
```

务实。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T10:32:42.810

从您的问题中很难判断，但也许您可以使用不同的 jQuery 选择器来设置不同的点击行为？例如，假设您有以下内容：

```
<div class="section-1">
    <div></div>
</div>
<div class="section-2">
    <div></div>
</div> 
```

也许您可以在 jQuery 中执行以下操作：

```
$('.section-1 div').onclick(...one set of functionality...);
$('.section-2 div').onclick(...another set of functionality...); 
```

基本上，根据上下文决定需要发生什么。您还可以选择所有 div 并测试某些父元素或子元素以确定它们获得的功能。

我必须更多地了解您的具体情况才能提供更有针对性的建议，但也许这会让您入门。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T10:56:42.283

我对 JQuery 不是很了解，但我知道 DOJO 工具包确实使高度不显眼的 Javascript 成为可能。

看看这里的例子：http: [//dojocampus.org/explorer/#Dojo_Query_Adding%20Events](http://dojocampus.org/explorer/#Dojo_Query_Adding%20Events)

该演示动态地将事件添加到基于类的纯 html 表中。

另一个例子是行为特征，在这里描述：http: [//dojocampus.org/content/2008/03/26/cleaning-your-markup-with-dojobehavior/](http://dojocampus.org/content/2008/03/26/cleaning-your-markup-with-dojobehavior/)

# algorithm - 最多 255 个字符的字符串的非冲突哈希算法

> ID：126381
> 
> 赞同：1
> 
> 时间：2008-09-24T10:23:43.767
> 
> 标签：algorithm, hash

我正在寻找一种哈希算法，以创建尽可能接近字符串的唯一哈希（max len = 255），从而产生一个长整数（DWORD）。

我意识到26^255 >> 2^32，但也知道英语单词的数量远少于2^32。

我需要“散列”的字符串主要是单个单词或使用两个或三个单词的简单构造。

* * *

**答案**：

[FNV 变体](http://isthe.com/chongo/tech/comp/fnv/)之一应满足您的要求。它们速度很快，并且产生相当均匀分布的输出。[（由Arachnid](https://stackoverflow.com/users/12030/arachnid)回答）

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T10:26:38.783

有关此问题的先前迭代（和答案），请参见[此处](https://stackoverflow.com/questions/114085/what-is-a-performant-string-hashing-function-that-results-in-a-32-bit-integer-w#114102)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T10:27:39.967

一种技术是使用众所周知的散列算法（例如，MD5 或 SHA-1）并仅使用结果的前 32 位。

请注意，哈希冲突的风险增加得比您预期的要快。有关这方面的信息，请阅读[生日悖论](http://en.wikipedia.org/wiki/Birthday_paradox)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T10:28:26.267

Ronny Pfannschmidt 昨天用常见的英语单词做了一个测试，他在 Python 字符串哈希函数中测试的 10000 个单词没有遇到任何冲突。我自己没有测试过，但是那个算法非常简单快速，而且似乎针对常用词进行了优化。

这里的实现：

```
static long
string_hash(PyStringObject *a)
{
    register Py_ssize_t len;
    register unsigned char *p;
    register long x;

    if (a->ob_shash != -1)
        return a->ob_shash;
    len = Py_SIZE(a);
    p = (unsigned char *) a->ob_sval;
    x = *p << 7;
    while (--len >= 0)
        x = (1000003*x) ^ *p++;
    x ^= Py_SIZE(a);
    if (x == -1)
        x = -2;
    a->ob_shash = x;
    return x;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T10:32:34.790

H(key) = [GetHash(key) + 1 + (((GetHash(key) >> 5) + 1) % (hashsize – 1))] % hashsize

[MSDN 关于 HashCodes 的文章](http://msdn.microsoft.com/en-us/library/ms379571.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T10:33:20.420

Java 的 String.hash() 可以在[这里](http://www.docjar.com/html/api/java/lang/String.java.html)轻松查看，它的算法是

```
s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1] 
```

# reporting-services - 在 Reporting Services 2005 中定义小行高

> ID：126382
> 
> 赞同：3
> 
> 时间：2008-09-24T10:24:07.730
> 
> 标签：reporting-services, report

我想在 Reporting Services 报告中指定一个大约 3pt 的小行高。虽然报表在预览器中看起来不错，但一旦部署，行高将重置为标准行高。

我已经调整了“CanGrow”和“CanShrink”设置以及填充、lineHeight、字体大小等...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T12:58:01.993

我发现解决此问题的一种方法是在行的每一列中放置一个下划线。

问题实际上在于输出空白行的方式。如果您查看输出报告的来源，您将看到您尝试保持简短的行将输出如下：

```
<TR style="HEIGHT:1.06mm">
<TD class="a19">&nbsp;</TD>
<TD class="a20">&nbsp;</TD>
<TD class="a21">&nbsp;</TD>
</TR> 
```

那些空格 ( `&nbsp;`) 是导致高度不正确的原因。如果您要删除那些空格，它将正确输出。

通过在行的每一列中放置一个下划线字符，它会删除通常会输出的空格，然后您的行高会更准确。您可能希望更改每列文本的颜色以匹配您的行背景颜色，这样下划线将永远不可见。

# apache-flex - 在 Flex 中实现定时器循环是不是一个坏主意？

> ID：126385
> 
> 赞同：3
> 
> 时间：2008-09-24T10:26:44.227
> 
> 标签：apache-flex, actionscript-3, performance

在我们的游戏项目中，我们确实有一个计时器循环设置为每秒触发大约 20 次（与应用程序帧速率相同）。我们用它来移动一些精灵。我想知道这是否会导致问题，我们应该使用 EnterFrame 事件处理程序来进行更新？我的印象是，让计时器循环运行得比应用程序帧速率快可能会导致问题……是这样吗？

作为更新，尝试在 EnterFrame 上执行此操作会导致非常奇怪的问题。不是每 75 毫秒一帧，而是突然跳到 25 毫秒。请注意，不仅仅是我们的计算*声称*帧速率不同，动画突然加速到了疯狂的速度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T14:05:11.473

我会选择 Enter 帧，在某些特殊情况下，有两个“循环”可能很有用，一个用于逻辑，一个用于视觉，但对于大多数游戏，我坚持使用 Enter 帧事件侦听器。有一个单独的计时器来移动你的东西有点不必要，因为将它设置为除帧率之外的任何东西都会使运动变得生涩或不可见（因为没有重绘帧）。

但是要考虑的一件事是将您的逻辑与帧速率解耦，这最容易通过使用 getTimer（在 as2 和 as3 中都可用）来计算自上一帧以来已过期的时间并相应地调整运动或其他方式来完成。

计时器并不比进入帧事件更可靠，flash 将尝试跟上您设置的任何速率，但如果您正在执行繁重的处理或复杂的图形，它会减慢计时器和帧速率。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-25T02:47:32.217

下面简要介绍了 Flash 如何处理帧速率以及您看到内容播放速度更快的原因。

在最深层次上，Flash 运行的任何宿主应用程序（通常是浏览器）都会每隔一段时间轮询 Flash。该间隔在一个浏览器中可能是每 10 毫秒，在另一个浏览器中可能是 50 毫秒。每次轮询发生时，Flash 都会执行以下操作：

*   自上次帧更新以来是否经过了 (1000/framerate) 毫秒？
    *   如果不是：什么都不做并返回
    *   如果是：执行帧更新：
        *   将所有（播放）时间线推进一帧
        *   调度所有事件（包括一个`ENTER_FRAME`事件
        *   使用未决事件执行所有帧脚本和事件处理程序
        *   绘制屏幕更新
        *   返回

但是，某些类型的外部事件（例如按键、鼠标事件和计时器事件）与上述过程异步处理。因此，如果您有一个在按下某个键时触发的事件处理程序，则该处理程序中的代码可能会在帧更新之间执行多次。`updateAfterEvent()`除非您使用该方法（在 AS2 中为全局，在 AS3 中附加到事件），否则屏幕仍将在每帧更新时仅重绘一次。

请注意，这些事件的异步行为不会影响帧更新的时间。即使您使用计时器事件，例如每秒重绘屏幕 50 次，帧动画仍然会以发布的帧速率发生，并且如果脚本动画由 enterFrame 事件驱动（而不是计时器）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T14:32:41.203

使用输入帧事件的好处是您的处理将与渲染同步降级，并且您将在代码块完成后立即获得屏幕更新。

任何一种方法都不能保证在特定的时间间隔内发生。因此，您的事件处理程序应该确定自上次执行以来已经过去了多长时间，并据此做出决定，而不是纯粹运行多少次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-25T00:21:24.080

我建议使用 TweenLite ( [http://blog.greensock.com/tweenliteas3/](http://blog.greensock.com/tweenliteas3/) ) 之类的轻量级类，大约 3kb，或者如果您需要更多功率，您可以使用 TweenMax，我相信它是 11kb。这里有很多优点。首先，这个“引擎”已经过彻底的测试和基准测试，并且是众所周知的为少数甚至很多东西制作动画的最资源友好的方式之一。我看过一个基准测试，在 AS3 中，1,500 个精灵正在使用 TweenLite 进行动画处理，它拥有强大的 20 fps，而像 Tweener 这样的竞争对手则会陷入 9 fps [http://blog.greensock.com/tweening-speed-测试/](http://blog.greensock.com/tweening-speed-test/)。下一个优点是易于使用，我将在下面演示。

```
//确保您有一个指向包含以下内容的文件夹的类路径。
导入 gs.TweenLite；
导入 gs.easing。*；

var ball_mc:MovieClip = new MovieClip();
var g:Graphics = ball_mc.graphics;
g.beginFill(0xFF0000,1);
g.drawCircle(0,0,10);
g.endFill();

//现在我们动画ball_mc
//示例：TweenLite.to(displayObjectName, totalTweeningTime, {someProperty:someValue,anotherProperty:anotherValue,onComplete:aFunctionCalledWhenComplete});
TweenLite.to(ball_mc, 1,{x:400,alpha:0.5});

```

因此，这需要 ball_mc 并将其从 x 轴上的当前位置移动到 400，并且在同一 Tween 期间，它将 alpha 从其当前值减少或增加到 0.5。

导入所需的类后，真的只需要 1 行代码就可以为每个对象设置动画，非常棒。我们也可以影响轻松度，我相信默认情况下是 Expo.easeOut(Strong easeOut)。如果您希望它反弹或具有弹性，只需向对象添加如下属性即可获得此类效果。

```
TweenLite.to(ball_mc, 1,{x:400,alpha:0.5,ease:Bounce.easeOut});
TweenLite.to(ball_mc, 1,{x:400,alpha:0.5,ease:Elastic.easeOut});

```

缓动全部来自 gs.easing.* 导入，我相信这是通过 TweenLite 使用的 Penner 的缓动方程。

最后，我们无需管理诸如 Timer 之类的轮询（开环），并且我们拥有非常易读的代码，可以轻松修改或删除。

还需要注意的是，TweenLite 和 TweenMax 提供的功能远远超过我在此处展示的内容，可以肯定地说，我在每个项目中都使用这两个类中的一个。动画是自定义的，它们附加了功能（onComplete：functionCall），而且它们是最佳的和资源友好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T11:47:17.733

我认为 timerEvent 和 Enter Frame 都是不错的选择，我在游戏中都使用过它们。（您是指定时器循环中的 timerEvent 吗？）

PS：请注意，在慢速机器中，计时器可能刷新不够快，因此您可能需要调整代码以使游戏在慢速机器中“更快”运行。

# sql-server - SQL Server 2005 数值精度损失

> ID：126401
> 
> 赞同：5
> 
> 时间：2008-09-24T10:31:37.993
> 
> 标签：sql-server, floating-point, type-conversion, casting, floating-accuracy

调试一些与金融相关的 SQL 代码发现了 numeric(24,8) 数学精度的奇怪问题。

在您的 MSSQL 上运行以下查询，您将得到 A + B * C 表达式结果为 0.123457

选择 A、B、C、A + B * C FROM ( SELECT CAST(0.12345678 AS NUMERIC(24,8)) AS A, CAST(0 AS NUMERIC(24,8)) AS B, CAST(500 AS NUMERIC(24) ,8)) 作为 C) T

所以我们丢失了 2 个重要符号。尝试以不同的方式解决此问题，我将中间乘法结果（为零！）转换为数字（24,8）可以正常工作。

最后有一个解决方案。但是我仍然有一个问题 - 为什么 MSSQL 会以这种方式运行，以及在我的示例中实际发生了哪些类型转换？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-24T10:54:31.947

正如浮点类型的加法不准确一样，如果超过精度，十进制类型的乘法可能不准确（或导致不准确）。请参阅[数据类型转换](http://msdn.microsoft.com/en-us/library/ms191530%28SQL.90%29.aspx#_decimal)以及[小数和数字](http://msdn.microsoft.com/en-us/library/ms187746%28SQL.90%29.aspx)。

`NUMERIC(24,8)`由于您将and相乘`NUMERIC(24,8)`，并且 SQL Server 只会检查类型而不是内容，因此当它无法保存所有 48 位精度（最大为 38 ）。将其中两个结合起来，您将得到 32 个非十进制数字，这样您就只有 6 个十进制数字 (38 - 32)。

因此原始查询

```
SELECT A, B, C, A + B * C
FROM ( SELECT CAST(0.12345678 AS NUMERIC(24,8)) AS A,
  CAST(0 AS NUMERIC(24,8)) AS B,
  CAST(500 AS NUMERIC(24,8)) AS C ) T 
```

减少到

```
SELECT A, B, C, A + D
FROM ( SELECT CAST(0.12345678 AS NUMERIC(24,8)) AS A,
  CAST(0 AS NUMERIC(24,8)) AS B,
  CAST(500 AS NUMERIC(24,8)) AS C,
  CAST(0 AS NUMERIC(38,6)) AS D ) T 
```

同样，在`NUMERIC(24,8)`和之间`NUMERIC(38,6)`，SQL Server 将尝试保存潜在的 32 位非小数，因此`A + D`减少到

```
SELECT CAST(0.12345678 AS NUMERIC(38,6)) 
```

`0.123457`四舍五入后给你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T12:02:14.873

[按照eed3si9n](https://stackoverflow.com/questions/126401/sql-server-2005-numeric-precision-loss#126473)指出的逻辑以及您在问题中所说的话，似乎进行数学运算时最好的方法是将它们提取到一个函数中，并在每次运算后指定精度，

在这种情况下，函数可能类似于：

```
create function dbo.myMath(@a as numeric(24,8), @b as numeric(24,8), @c as numeric(24,8))
returns  numeric(24,8)
as
begin 
    declare @d as numeric(24,8)
    set @d = @b* @c
    return @a + @d
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-04T09:43:21.743

尽管它在[Precision、Scale 和 Length (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms190476%28v=sql.110%29.aspx)上说了什么。我相信它也会将 6 的最小“比例”（小数位数）应用于结果 NUMERIC 类型的乘法，就像它对除法等所做的一样。

# mysql - 在 MySQL 管理员中更改数据库文件位置？

> ID：126406
> 
> 赞同：15
> 
> 时间：2008-09-24T10:32:45.947
> 
> 标签：mysql

我想将 MySQL 管理员的数据库文件位置更改为我计算机的另一个驱动器。（我运行 Windows XP SP2 和 MySQL Administrator 1.2.8。）

--在启动变量下-->通用参数-->我`Data directory:`是从 `C:/Program Files/MySQL/MySQL Server 5.0/data`改为的`D:/.....`，但是我停止服务重启后，出现如下错误：

```
Could not re-connect to the MySQL Server.
Server could not be started.

Fatal error: Can't open and lock privilege tables: Table 'mysql.host' doesn't exist 
```

有没有其他人有这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-24T10:36:42.940

通常它是这样工作的：

1.  关闭 MySQL
2.  更改MySQL 配置中的`[mysqld]`and变量`[mysqld_safe]` `datadir`
3.  更改`basedir`同一部分中的变量。
4.  移动位置
5.  重启 MySQL

如果这不起作用，我不知道。在 linux 上，您也可以尝试将套接字移动到新位置，但这不应该影响 windows。或者，您可以在 *nix 上使用我猜大多数人的符号链接。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-19T20:55:17.780

在 Windows 中

1.  导航`C:\Program Files\MySQL\MySQL Server 5.4\`并定位`my.ini`文件
2.  找到 SERVER SECTION 并转到大约第 76 行并将**datadir**行修改为您希望存储 MySQL 应用程序数据的位置
3.  现在导航到`C:\Documents and Settings\All Users\Application Data\MySQL\MySQL Server 5.4\data\`mysql 文件夹并将其复制并粘贴到您的新位置。
4.  *在控制面板 > 管理工具 > 服务*中重新启动 MySQL 服务器

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T10:36:55.733

您还必须手动修改mysql的配置（通常是my.conf）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T10:40:44.537

MySQL Administrator 不能用于这样的任务。它只是一个查看 MySQL 服务器的工具，尽管它的名字。许多 MySQL 教程和手册 IIRC 中都描述了重定位数据。但基本上它只是在服务器关闭时将数据移动到新位置，然后更正服务器配置文件中的路径。之后，您应该能够重新启动服务器并将 MySQL Administrator 连接到它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T18:13:37.280

确保在 Windows 资源管理器选项的安全选项卡中授予网络服务完全权限。如果服务器无法对选定的文件夹进行读/写等操作，则服务将不会启动，或者会尝试启动并立即关闭。

# design-patterns - 消除代码切换的方法

> ID：126409
> 
> 赞同：187
> 
> 时间：2008-09-24T10:34:13.947
> 
> 标签：design-patterns

有什么方法可以消除代码中switch的使用？

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2008-09-24T10:49:24.877

Switch 语句本身不是反模式，但是如果您正在编写面向对象的代码，则应该考虑使用[多态性](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)而不是使用 switch 语句是否可以更好地解决使用 switch 的问题。

使用多态性，这：

```
foreach (var animal in zoo) {
    switch (typeof(animal)) {
        case "dog":
            echo animal.bark();
            break;

        case "cat":
            echo animal.meow();
            break;
    }
} 
```

变成这样：

```
foreach (var animal in zoo) {
    echo animal.speak();
} 
```

* * *

## 回答 #2

> 赞同：258
> 
> 时间：2008-09-24T10:54:41.307

请参阅[Switch 语句 Smell](http://c2.com/cgi/wiki?SwitchStatementsSmell)：

> 通常，类似的 switch 语句分散在整个程序中。如果您在一个开关中添加或删除一个子句，您通常还需要查找并修复其他的子句。

[重构](https://rads.stackoverflow.com/amzn/click/com/0201485672)和[重构到模式](https://rads.stackoverflow.com/amzn/click/com/0321213351)都有解决这个问题的方法。

如果您的（伪）代码如下所示：

```
class RequestHandler {

    public void handleRequest(int action) {
        switch(action) {
            case LOGIN:
                doLogin();
                break;
            case LOGOUT:
                doLogout();
                break;
            case QUERY:
               doQuery();
               break;
        }
    }
} 
```

该代码违反了[开放封闭原则](http://en.wikipedia.org/wiki/Open/closed_principle)，并且对于出现的每一种新类型的操作代码都是脆弱的。为了解决这个问题，您可以引入一个“命令”对象：

```
interface Command {
    public void execute();
}

class LoginCommand implements Command {
    public void execute() {
        // do what doLogin() used to do
    }
}

class RequestHandler {
    private Map<Integer, Command> commandMap; // injected in, or obtained from a factory
    public void handleRequest(int action) {
        Command command = commandMap.get(action);
        command.execute();
    }
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2008-09-24T10:49:09.697

switch 是一种模式，无论是用 switch 语句、if else 链、查找表、oop 多态性、模式匹配还是其他东西来实现。

您想消除“ **switch 语句**”或“ **switch 模式**”的使用吗？只有在可以使用另一种模式/算法的情况下，第一个可以消除，第二个可以消除，而且大多数情况下这是不可能的，或者不是更好的方法。

如果您想从代码中消除**switch 语句**，首先要问的问题是消除 switch 语句并使用其他技术*在哪里有意义。*不幸的是，这个问题的答案是特定领域的。

请记住，编译器可以对 switch 语句进行各种优化。因此，例如，如果您想有效地进行消息处理，那么 switch 语句几乎就是要走的路。但另一方面，基于 switch 语句运行业务规则可能不是最好的方法，应该重新设计应用程序。

以下是 switch 语句的一些替代方法：

*   [查找表](http://en.wikipedia.org/wiki/Lookup_table)
*   [多态性](http://en.wikipedia.org/wiki/Type_polymorphism)
*   [模式匹配](http://en.wikipedia.org/wiki/Pattern_matching)（特别用于函数式编程、C++ 模板）

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-09-24T10:41:58.887

Switch 本身并没有那么糟糕，但是如果您的方法中有很多“switch”或“if/else”对象，这可能表明您的设计有点“程序化”并且您的对象只是价值桶。将逻辑移至您的对象，在您的对象上调用方法并让它们决定如何响应。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-09-24T10:36:05.080

我认为最好的方法是使用好的地图。使用字典，您几乎可以将任何输入映射到其他值/对象/函数。

你的代码看起来像这样（伪）：

```
void InitMap(){
    Map[key1] = Object/Action;
    Map[key2] = Object/Action;
}

Object/Action DoStuff(Object key){
    return Map[key];
} 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-09-24T10:35:56.780

每个人都喜欢巨大`if else`的积木。很容易阅读！不过，我很好奇您为什么要删除 switch 语句。如果你需要一个 switch 语句，你可能需要一个 switch 语句。不过说真的，我想说这取决于代码在做什么。如果开关所做的只是调用函数（比如说），您可以传递函数指针。这是否是一个*更好*的解决方案是值得商榷的。

我认为语言在这里也是一个重要因素。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-24T10:51:20.440

我认为您正在寻找的是策略模式。

这可以通过多种方式实现，在此问题的其他答案中已提到，例如：

*   值映射 -> 函数
*   多态性。（对象的子类型将决定它如何处理特定进程）。
*   一流的功能。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-24T10:45:38.833

“switch”只是一种语言结构，所有语言结构都可以被认为是完成工作的工具。与真正的工具一样，有些工具比另一项更适合一项任务（您不会使用大锤来放置图片挂钩）。重要的部分是如何定义“完成工作”。它是否需要可维护、是否需要快速、是否需要扩展、是否需要可扩展等等。

在编程过程中的每一点，通常都有一系列可以使用的结构和模式：开关、if-else-if 序列、虚函数、跳转表、带有函数指针的映射等等。有了经验，程序员会本能地知道在特定情况下使用正确的工具。

必须假设任何维护或审查代码的人至少与原作者一样熟练，以便可以安全地使用任何构造。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-24T11:24:06.027

`switch`如果您发现自己在语句中添加新状态或新行为，则可以很好地替换语句：

```
诠释状态；

字符串 getString() {
   开关（状态）{
     case 0 : // 状态 0 的行为
           返回“零”；
     case 1 : // 状态 1 的行为
           返回“一”；
   }
   抛出新的 IllegalStateException();
}

双 getDouble() {

   开关（this.state）{
     case 0 : // 状态 0 的行为
           返回0d；
     case 1 : // 状态 1 的行为
           返回 1d；
   }
   抛出新的 IllegalStateException();
}

```

添加新行为需要复制`switch`，而添加新状态意味着`case`在*每个* `switch`语句中添加另一个。

在 Java 中，您只能切换数量非常有限的基本类型，它们的值在运行时就知道。这本身就带来了一个问题：状态被表示为幻数或字符。

[模式匹配](http://en.wikipedia.org/wiki/Conditional_statement)`if - else`，并且可以使用多个块，尽管在添加新行为和新状态时确实存在相同的问题。

其他人提出的“多态”解决方案是[状态模式](http://www.vincehuston.org/dp/state.html)的一个实例：

用自己的类替换每个状态。每个行为在类上都有自己的方法：

```
IState 状态；

字符串 getString() {
   返回 state.getString();
}

双 getDouble() {
   返回 state.getDouble();
}

```

每次添加新状态时，都必须添加`IState`接口的新实现。在一个`switch`世界中，您将向`case`每个`switch`.

每次添加新行为时，都需要向`IState`接口和每个实现添加新方法。这与以前的负担相同，但现在编译器将检查您是否在每个预先存在的状态上实现了新行为。

其他人已经说过，这可能太重了，所以当然有一个点你可以从一个移动到另一个。就个人而言，我第二次编写 switch 是我重构的地方。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-24T10:36:11.193

如果别的

我驳斥了 switch 本质上是坏的前提。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-24T10:36:42.083

好吧，首先，我不知道使用 switch 是一种反模式。

其次，switch 总是可以替换为 if / else if 语句。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-24T10:38:23.733

你为什么想要？在一个好的编译器的手中，一个 switch 语句可以比 if/else 块更有效（并且更容易阅读），并且只有最大的 switch 如果它们被任何类型替换，它们可能会被加速间接查找数据结构。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-24T10:45:50.517

如果开关是用来区分各种对象的，那么您可能会缺少一些类来精确描述这些对象，或者一些虚拟方法......

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-24T11:04:43.030

对于 C++

如果您指的是 AbstractFactory，我认为*registerCreatorFunc(..)*方法通常比需要为每个需要的“新”语句添加案例要好。然后让所有类创建并注册一个可以用宏轻松实现的*creatorFunction(..) （如果我敢说的话）。*我相信这是许多框架所做的常用方法。我第一次在 ET++ 中看到它，我认为许多需要 DECL 和 IMPL 宏的框架都使用它。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-24T12:05:46.113

在像 C 这样的过程语言中，switch 将比任何替代方案都好。

在面向对象的语言中，几乎总是有其他替代方案可以更好地利用对象结构，特别是多态性。

当应用程序中的多个位置出现多个非常相似的 switch 块时，就会出现 switch 语句的问题，并且需要添加对新值的支持。开发人员忘记将新值的支持添加到分散在应用程序周围的一个开关块中是很常见的。

使用多态性，新类将替换新值，并且添加新行为作为添加新类的一部分。然后，这些切换点的行为要么从超类继承，要么被重写以提供新的行为，要么在超方法是抽象的时候实现以避免编译器错误。

在没有明显的多态性发生的情况下，非常值得实现[Strategy 模式](http://today.java.net/pub/a/today/2004/10/29/patterns.html)。

但是，如果您的替代方案是一个大的 IF ... THEN ... ELSE 块，那就忘了它。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-24T15:37:56.773

函数指针是替换大块 switch 语句的一种方法，它们在您可以通过名称捕获函数并用它们制作东西的语言中特别好。

当然，你不应该在你的代码中强制使用 switch 语句，而且你总是有可能做错了，这会导致愚蠢的冗余代码片段。（这有时是不可避免的，但是好的语言应该可以让你在保持干净的同时消除冗余。）

这是一个很好的分而治之的例子：

假设您有某种翻译。

```
switch(*IP) {
    case OPCODE_ADD:
        ...
        break;
    case OPCODE_NOT_ZERO:
        ...
        break;
    case OPCODE_JUMP:
        ...
        break;
    default:
        fixme(*IP);
} 
```

相反，你可以使用这个：

```
opcode_table[*IP](*IP, vm);

... // in somewhere else:
void opcode_add(byte_opcode op, Vm* vm) { ... };
void opcode_not_zero(byte_opcode op, Vm* vm) { ... };
void opcode_jump(byte_opcode op, Vm* vm) { ... };
void opcode_default(byte_opcode op, Vm* vm) { /* fixme */ };

OpcodeFuncPtr opcode_table[256] = {
    ...
    opcode_add,
    opcode_not_zero,
    opcode_jump,
    opcode_default,
    opcode_default,
    ... // etc.
}; 
```

请注意，我不知道如何删除 C 中 opcode_table 的冗余。也许我应该对此提出疑问。:)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-07-01T08:15:18.120

在使用关联数组的 JavaScript 中
**：**

```
function getItemPricing(customer, item) {
    switch (customer.type) {
        // VIPs are awesome. Give them 50% off.
        case 'VIP':
            return item.price * item.quantity * 0.50;

            // Preferred customers are no VIPs, but they still get 25% off.
        case 'Preferred':
            return item.price * item.quantity * 0.75;

            // No discount for other customers.
        case 'Regular':
        case
        default:
            return item.price * item.quantity;
    }
} 
```

**变成这样：**

```
function getItemPricing(customer, item) {
var pricing = {
    'VIP': function(item) {
        return item.price * item.quantity * 0.50;
    },
    'Preferred': function(item) {
        if (item.price <= 100.0)
            return item.price * item.quantity * 0.75;

        // Else
        return item.price * item.quantity;
    },
    'Regular': function(item) {
        return item.price * item.quantity;
    }
};

    if (pricing[customer.type])
        return pricing[customer.type](item);
    else
        return pricing.Regular(item);
} 
```

[礼貌](http://encosia.com/first-class-functions-as-an-alternative-to-javascripts-switch-statement/)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-24T10:37:51.550

最明显的、与语言无关的答案是使用一系列“如果”。

如果您使用的语言具有函数指针 (C) 或具有第一类值 (Lua) 的函数，则可以使用（指向）函数的数组（或列表）获得类似于“开关”的结果。

如果您想要更好的答案，您应该更具体地了解语言。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-24T10:49:12.583

Switch 语句通常可以被良好的 OO 设计所取代。

例如，您有一个 Account 类，并使用 switch 语句根据帐户类型执行不同的计算。

我建议这应该被一些账户类所取代，代表不同类型的账户，并且都实现了一个账户接口。

然后切换变得不必要，因为您可以将所有类型的帐户视为相同，并且由于多态性，将为帐户类型运行适当的计算。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-24T10:56:07.247

看你为什么要换！

许多解释器使用“计算的 goto”而不是 switch 语句来执行操作码。

我想念 C/C++ 开关的是 Pascal 'in' 和范围。我也希望我可以打开字符串。但是，这些对于编译器来说虽然微不足道，但在使用结构和迭代器等完成时却是一项艰巨的工作。所以，相反，如果只有 C 的 switch() 更灵活，我希望我可以用 switch 替换很多东西！

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-24T12:16:28.863

使用没有内置 switch 语句的语言。想到 Perl 5。

说真的，你为什么要避免它？如果你有充分的理由避免它，那为什么不干脆避免呢？

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-11-25T18:11:13.610

Switch 不是一个好方法，因为它破坏了 Open Close Principal。我就是这样做的。

```
public class Animal
{
       public abstract void Speak();
}

public class Dog : Animal
{
   public virtual void Speak()
   {
       Console.WriteLine("Hao Hao");
   }
}

public class Cat : Animal
{
   public virtual void Speak()
   {
       Console.WriteLine("Meauuuu");
   }
} 
```

以下是如何使用它（获取您的代码）：

```
foreach (var animal in zoo) 
{
    echo animal.speak();
} 
```

基本上我们正在做的是将责任委托给子类，而不是让父母决定如何处理孩子。

您可能还想阅读“Liskov Substitution Principle”。

* * *

## 回答 #23

> 赞同：-14
> 
> 时间：2008-09-24T10:53:11.187

对 if/else 的另一票。我不是 case 或 switch 语句的忠实粉丝，因为有些人不使用它们。如果使用 case 或 switch，代码的可读性会降低。也许对您来说可读性并不低，但对于那些从未需要使用该命令的人来说。

对象工厂也是如此。

if/else 块是每个人都会得到的简单构造。您可以采取一些措施来确保不会造成问题。

首先 - 不要尝试多次缩进 if 语句。如果你发现自己在缩进，那么你做错了。

```
 if a = 1 then 
     do something else 
     if a = 2 then 
         do something else
     else 
         if a = 3 then 
             do the last thing
         endif
     endif 
  endif 
```

真的很糟糕 - 改为这样做。

```
if a = 1 then 
   do something
endif 
if a = 2 then 
   do something else
endif 
if a = 3 then 
   do something more
endif 
```

该死的优化。它对您的代码速度没有太大影响。

其次，只要有足够的中断语句散布在特定的代码块中，我不反对打破 If 块，使其显而易见

```
procedure processA(a:int)
    if a = 1 then 
       do something
       procedure_return
    endif 
    if a = 2 then 
       do something else
       procedure_return
    endif 
    if a = 3 then 
       do something more
       procedure_return
    endif 
end_procedure 
```

**编辑**：在 Switch 上以及为什么我认为这很难理解：

这是 switch 语句的示例...

```
private void doLog(LogLevel logLevel, String msg) {
   String prefix;
   switch (logLevel) {
     case INFO:
       prefix = "INFO";
       break;
     case WARN:
       prefix = "WARN";
       break;
     case ERROR:
       prefix = "ERROR";
       break;
     default:
       throw new RuntimeException("Oops, forgot to add stuff on new enum constant");
   }
   System.out.println(String.format("%s: %s", prefix, msg));
 } 
```

对我来说，这里的问题是应用在类似 C 的语言中的正常控制结构已被完全破坏。有一个一般规则，如果你想在一个控制结构中放置多行代码，你可以使用大括号或开始/结束语句。

例如

```
for i from 1 to 1000 {statement1; statement2}
if something=false then {statement1; statement2}
while isOKtoLoop {statement1; statement2} 
```

对我来说（如果我错了，你可以纠正我），Case 声明将这条规则抛到了窗外。有条件执行的代码块没有放在开始/结束结构内。正因为如此，我相信 Case 在概念上的差异足以不被使用。

希望能回答你的问题。

# oracle - Oracle Coherence 稳定吗？

> ID：126421
> 
> 赞同：7
> 
> 时间：2008-09-24T10:36:54.140
> 
> 标签：oracle, distributed-caching, oracle-coherence

有人用过[Oracle Coherence](http://www.oracle.com/technetwork/middleware/coherence/overview/index.html)吗？在路演中看起来很有希望。

我担心的是它是否足够稳定和强大以实施关键任务金融解决方案。

如果您对它的性能、稳健性和易于维护提供任何反馈，我将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-10-23T06:38:18.343

我曾在两家大型投资银行使用 Oracle Coherence 的第一手经验，可以说它绝对稳定。然而，与任何复杂的软件一样，它并非没有怪癖。

**编辑：** Doh，刚刚意识到这个问题已经有一年多了。那好吧...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-24T12:45:08.707

数百家公司正在生产 Coherence。许多公司是大型金融机构和大型消费者网站。例如，[hotwire.com](http://www.hotwire.com/)使用 Coherence。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T16:38:46.253

与任何技术一样，Coherence 能够满足您对性能和稳健性的需求。如果您了解该技术并正确实施它，那么可以。

我已经使用了几个月了。到目前为止，它在生产中表现良好。我们还没有进入维护部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-17T13:04:29.350

Oracle Coherence 是一个成熟的产品，但您需要确保您拥有来自 Oracle 的最新补丁。可从 Oracle 网站下载的单点版本有许多已在补丁版本中修复的错误。

至于开发和维护，学习曲线比文档建议的要陡峭一些。我推荐 Oracle 培训课程（或 Alek Seovic 的书）。

# postgresql - Is it possible to change the natural order of columns in Postgres?

> ID：126430
> 
> 赞同：33
> 
> 时间：2008-09-24T10:39:12.170
> 
> 标签：postgresql

Is it possible to change the natural order of columns in Postgres 8.1?

I know that you shouldn't rely on column order - it's not *essential* to what I am doing - I only need it to make some auto-generated stuff come out in a way that is more pleasing, so that the field order matches all the way from pgadmin through the back end and out to the front end.

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-18T03:06:10.273

You can actually just straight up change the column order, but I'd hardly recommend it, and you should be very careful if you decide to do it.

eg.

```
# CREATE TABLE test (a int, b int, c int);
# INSERT INTO test VALUES (1,2,3);
# SELECT * FROM test;
 a | b | c 
---+---+---
 1 | 2 | 3
(1 row)

```

Now for the tricky bit, you need to connect to your database using the postgres user so you can modify the system tables.

```
# SELECT relname, relfilenode FROM pg_class WHERE relname='test';
 relname | relfilenode 
---------+-------------
 test_t  |       27666
(1 row)

# SELECT attrelid, attname, attnum FROM pg_attribute WHERE attrelid=27666;
 attrelid | attname  | attnum 
----------+----------+--------
    27666 | tableoid |     -7
    27666 | cmax     |     -6
    27666 | xmax     |     -5
    27666 | cmin     |     -4
    27666 | xmin     |     -3
    27666 | ctid     |     -1
    27666 | b        |      1
    27666 | a        |      2
    27666 | c        |      3
(9 rows)

```

attnum is a unique column, so you need to use a temporary value when you're modifying the column numbers as such:

```
# UPDATE pg_attribute SET attnum=4 WHERE attname='a' AND attrelid=27666;
UPDATE 1
# UPDATE pg_attribute SET attnum=1 WHERE attname='b' AND attrelid=27666;
UPDATE 1
# UPDATE pg_attribute SET attnum=2 WHERE attname='a' AND attrelid=27666;
UPDATE 1

# SELECT * FROM test;
 b | a | c 
---+---+---
 1 | 2 | 3
(1 row)

```

Again, because this is playing around with database system tables, use extreme caution if you feel you really need to do this.

This is working as of postgres 8.3, with prior versions, your milage may vary.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-24T14:25:10.397

If your database is not very big and you can afford some downtime then you can:

1.  Disable write access to the database
    *this is essential as otherwise any changes after starting the next point will be lost*
2.  `pg_dump --create --column-inserts databasename > databasename.pgdump.sql`
3.  Edit apropriate `CREATE TABLE` statement in databasename.pgdump.sql
    *If the file is too big for your editor just split it using `split` command, edit, then assemble back using `cat`*
4.  `drop database databasename`
    *You do have a recent backup, just in case, do you?*
5.  `psql --single-transaction -f databasename.pgdump.sql`
    *If you don't use `--single-transaction` it will be very slow*

If you use so called large objects make sure they are included in the dump. I'm not sure if they are by default in 8.1.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-09-16T01:02:03.467

I have asked that question in pgsql-admin in 2007\. Tom Lane himself declared it practically unfeasible to change the order in the catalogs.

*   [http://archives.postgresql.org/pgsql-admin/2007-06/msg00037.php](https://archives.postgresql.org/pgsql-admin/2007-06/msg00037.php)

Clarification: this applies for users with the present tools. Does not mean, it could not be implemented. IMO, it should be.
Still true for Postgres 12.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T12:14:45.153

You cannot change the order of columns in-place with postgres. However you can solve your problem with a view. For the purposes of your reporting query, it will look just like a table. Something like:

```
create view my_view as select * from my_table order by some_col; 
```

**If your data must remain in-place you'll have to juggle**

You can use a view to create a new table with the reordered columns like this:

```
-- foo is the table you want to re-order columns in
drop table foo;
CREATE TABLE foo ( moo integer, bar character varying(10), baz date ); 
insert into foo (moo, bar, baz) values (34, 'yadz', now()); 
insert into foo (moo, bar, baz) values (12, 'blerp', now()); 
select * from foo; 
    ┌─────┬───────┬────────────┐ 
    │ moo │  bar  │    baz     │ 
    ├─────┼───────┼────────────┤ 
    │  34 │ yadz  │ 2021-04-07 │ 
    │  12 │ blerp │ 2021-04-07 │ 
    └─────┴───────┴────────────┘ 
-- Define your reordered columns here, don't forget one, 
-- or it'll be missing from the replacement.
drop view if exists my_view; 
create view my_view as ( select moo, baz, bar from foo );  
select * from my_view; 
DROP TABLE IF EXISTS foo2; 
--foo2 is your replacement table that has columns ordered correctly
create table foo2 as select * from my_view; 
select * from foo2;
--finally drop the view and the original table and rename
DROP VIEW my_view; 
DROP TABLE foo; 
ALTER TABLE foo2 RENAME TO foo; 
select * from foo;
    ┌─────┬────────────┬───────┐ 
    │ moo │    baz     │  bar  │ 
    ├─────┼────────────┼───────┤ 
    │  34 │ 2021-04-07 │ yadz  │ 
    │  12 │ 2021-04-07 │ blerp │ 
    └─────┴────────────┴───────┘ 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-02-01T23:48:24.507

I'm wanting the same. Yes, order isn't essential for my use-case, but it just rubs me the wrong way :)

What I'm doing to resolve it is as follows.

**This method will ensure you KEEP any existing data,**

1.  Create a new version of the table using the ordering I want, using a temporary name.
2.  Insert all data into that new table from the existing one.
3.  Drop the old table.
4.  Rename the new table to the "proper name" from "temporary name".
5.  Re-add any indexes you previously had.
6.  Reset ID sequence for primary key increments.

**Current table order:**

```
id, name, email 
```

**1\. Create a new version of the table using the ordering I want, using a temporary name.**

In this example, I want `email` to be before `name`.

```
CREATE TABLE mytable_tmp
(
  id SERIAL PRIMARY KEY,
  email text,
  name text
); 
```

**2\. Insert all data into that new table from the existing one.**

```
INSERT INTO mytable_tmp   --- << new tmp table
(
  id
, email
, name
)
SELECT
  id
, email
, name
FROM mytable;  --- << this is the existing table 
```

**3\. Drop the old table.**

```
DROP TABLE mytable; 
```

**4\. Rename the new table to the "proper name" from "temporary name".**

```
ALTER TABLE mytable_tmp RENAME TO mytable; 
```

**5\. Re-add any indexes you previously had.**

```
CREATE INDEX ... 
```

**6\. Reset ID sequence for primary key increments.**

```
SELECT setval('public.mytable_id_seq', max(id)) FROM mytable; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-30T21:28:45.157

You can get the column ordering that you want by creating a new table and selecting columns of the old table in the order that you want them to present:

```
CREATE TABLE test_new AS SELECT b, c, a FROM test;
SELECT * from test_new;
 b | c | a 
---+---+---
 2 | 3 | 1
(1 row) 
```

Note that this copies data only, not modifiers, constraints, indexes, etc..

Once the new table is modified the way you want, drop the original and alter the name of the new one:

```
BEGIN;
DROP TABLE test;
ALTER TABLE test_new RENAME TO test;
COMMIT; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T10:40:12.870

Unfortunately, no, it's not. Column order is entirely up to Postgres.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T10:42:47.637

**Specifying the column order in the query is the only reliable (and sane) way**. That said, you can usually get a different ordering by altering the table as shown in the example below as the columns are usually (not guaranteed to be) returned in the order they were added to the table.

```
postgres=# create table a(a int, b int, c int);
CREATE TABLE
postgres=# insert into a values (1,2,3);
INSERT 0 1
postgres=# select * from a;
 a | b | c
---+---+---
 1 | 2 | 3
(1 row)

postgres=# alter table a add column a2 int;
ALTER TABLE
postgres=# select * from a;
 a | b | c | a2
---+---+---+----
 1 | 2 | 3 |
(1 row)

postgres=# update a set a2 = a;
UPDATE 1
postgres=# alter table a drop column a;
ALTER TABLE
postgres=# alter table a rename column a2 to a;
ALTER TABLE
postgres=# select * from a;
 b | c | a
---+---+---
 2 | 3 | 1
(1 row)

postgres=# 
```

# ms-access - MS Access 报告中的不同奇数/偶数页

> ID：126431
> 
> 赞同：0
> 
> 时间：2008-09-24T10:39:44.680
> 
> 标签：ms-access, pagination, ms-access-2007

对于 MS Access (2007) 中的报告，我需要将某些列的数据放在所有奇数页上，而将其他列放在所有偶数页上。它用于将双面卡片文件打印到纸上。

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T14:47:53.553

好吧，您可以在“On Format”事件中检查“Page”是奇数还是偶数，并且根据您所在的页面，制造商列是否可见。但是，这样做会容易得多：

放入几个部分并在它们之间放入一个新页面。然后，只需确保您不会因为每张卡片的行数过多而溢出页面。

或者

使报表足够宽以强制打开第二页，然后将这些列放在第二页上（即第一页的背面）。我记得访问的打印顺序是左上右下，所以页面设置如下：

```
A B  
C D 
```

会这样打印：

```
A
B
C
D 
```

如果必须在两个连续页面上显示同一记录中的数据，这是我会选择的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T11:15:02.367

你的问题太笼统了。我建议您在所有页面中都有所有列，然后在页眉部分（甚至在详细信息部分）“格式”中添加一些代码，以根据页码更改详细信息文本框的 .Visible 属性。

我认为您需要在页眉或页脚中使用“= [Page]”作为源数据的文本框才能知道正确的页码。不过，我的 Access 报告知识可能已经严重过时了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-26T17:53:18.107

您也可以使用一对查询，将第一个打印到 A 面，将第二个打印到 B 面，也许？

# css - 有什么方法可以删除活动表单中提交按钮周围的 IE 黑色边框？

> ID：126445
> 
> 赞同：40
> 
> 时间：2008-09-24T10:46:10.390
> 
> 标签：css, internet-explorer

我正在实现一个使用自定义样式提交按钮的设计。它们是非常简单的浅灰色按钮，外边框稍暗：

```
input.button {
    background: #eee;
    border: 1px solid #ccc;
} 
```

这在 Firefox、Safari 和 Opera 中看起来恰到好处。问题出在 Internet Explorer 6 和 7 上。

由于表单是页面上的第一个表单，因此它被视为主表单 - 因此从一开始就处于活动状态。活动表单中的第一个提交按钮在 IE 中收到一个纯黑色边框，以将其标记为主要操作。

如果我关闭边框，那么 IE 中的黑色额外边框也会消失。我正在寻找一种方法来保持我的正常边界，但删除轮廓。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-24T11:07:14.117

好吧，这在这里有效：

```
<html>
    <head>
        <style type="text/css">
            span.button {
                background: #eee;
                border: 1px solid #ccc;
            }

            span.button input {
                background:none;
                border:0;
                margin:0;
                padding:0;
            }   
        </style>
    </head>
    <body>
        <span class="button"><input type="button" name="..." value="Button"/></span>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-24T13:04:31.800

如果您不想为输入/按钮添加包装器，请尝试执行此操作。由于这是无效的 CSS，因此仅适用于 IE。具有其他浏览器的边框，但使用过滤器：IE 的色度...

```
<!--[if IE]>
<style type="text/css">
input {
filter:chroma(color=#000000);
border:none;
}
</style>
<![endif]--> 
```

为我工作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-07-29T18:25:12.747

我知道我迟到了将近 2 年，但我找到了另一个解决方案（至少对于 IE7）。

如果您在表单中的任何其他提交按钮*之前*`input type="submit"`添加另一个到您的表单，问题就会消失。现在你只需要隐藏这个新的黑色边框吸收按钮。

 *这对我有用（溢出需要是“自动”）：

```
<input type="submit" value="" style="height:0;overflow:auto;position:absolute;left:-9999px;" /> 
```

注意：我使用的是 HTML5 文档类型 ( `<!doctype html>`)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-28T00:14:34.577

我在另一个论坛上找到了适合我的答案。它删除了 ie6 和 ie7 中不需要的黑色边框。你们中的一些人/很多人可能没有在表单标签中定位您的 input="submit"。不要忽视这一点。在尝试了其他所有方法后，它对我***有用***。

如果您使用的是提交按钮，请确保它位于表单中，而不仅仅是字段集：

```
<form><fieldset><input type="submit"></fieldset></form> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-08T17:27:34.907

我能够将 David Murdoch 的建议与一些 JQuery 结合起来，以便将修复程序自动应用于页面上的所有 'input:submit' 元素：

```
// Test for IE7.
if ($.browser.msie && parseInt($.browser.version, 10) == 7) {
            $('<input type="submit" value="" style="height:0;overflow:auto;position:absolute;left:-9999px;" />')
.insertBefore("input:submit");
        } 
```

您可以将其包含在母版页或等效页面中，以便将其应用于您网站中的所有页面。

它有效，但它确实感觉有点不对劲，不知何故。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-28T20:41:57.657

我正在建立@nickmorss 的使用过滤器的示例，该示例并没有真正适合我的情况……使用辉光过滤器对我来说效果更好。

```
<!--[if IE]>
<style type="text/css">
    input[type="submit"], input[type="button"], button
    {
        border: none !important;
        filter: progid:DXImageTransform.Microsoft.glow(color=#d0d0d0,strength=1);
        height: 24px; /* I had to adjust the height from the original value */
    }
</style>
<![endif]--> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T10:54:33.913

对，这是一个让你权衡的丑陋解决方案......将按钮粘贴在 a 中`<span>`，核对按钮的边框并将边框改为跨度。

IE 对表单元素的边距有点不确定，因此这可能无法精确工作。也许给跨度与按钮相同的背景可能会在这方面有所帮助。

```
span.button {
    background: #eee;
    border: 1px solid #ccc;
}

span.button input {
    background: #eee;
    border:0;
} 
```

和

```
<span class="button"><input type="button" name="..." value="Button"/></span> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T10:56:21.927

我找到的最佳解决方案是将边框移动到包装元素，如下所示：

```
<div class='submit_button'><input type="submit" class="button"></div> 
```

使用这个 CSS：

```
.submit_button         { width: 150px; border: 1px solid #ccc; }
.submit_button .button { width: 150px; border: none; } 
```

此解决方案的主要问题是按钮现在是块元素，并且需要固定宽度。我们可以使用 inline-block，除了 Firefox2 不支持它。

欢迎任何更好的解决方案。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-20T07:37:02.057

我认为 filter:chroma(color=#000000); 正如之前提到的那样是最好的，因为您可以在某些课程中申请。否则，如果您当然正在使用课程，您将不得不在您拥有的每个按钮上应用一个额外的标签。

.buttonStyle { filter:chroma(color=#000000); 背景-颜色：#E5813C 纯色；BORDER-BOTTOM：#cccccc 1px 实心；左边框：#cccccc 1px 实心；右边界：#cccccc 1px 实心；边框顶部：#cccccc 1px 实心；颜色：#FF9900; 字体系列：Verdana、Arial、Helvetica、sans-serif；字体大小：10px；字重：粗体；文字装饰：无；} 这为我做到了！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-11-06T01:00:42.843

我遇到了这个问题，并用按钮周围的 div 解决了它，将其显示为一个块，并手动定位它。IE 和 FF 中按钮的边距太不可预测了，他们都没有办法感到高兴。我的提交按钮必须与输入完美对齐，因此如果不将项目定位为块，它就无法工作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-02-15T10:29:25.220

这将起作用：

```
input[type=button]
{
       filter:chroma(color=#000000);
} 
```

这甚至适用于`button`标签，最终您可以安全地使用`background-image`css 属性。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-10-10T21:46:52.377

这个问题的正确答案是：

```
outline: none; 
```

...据我所知，适用于 IE 和 Chrome。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-24T10:55:23.473

一个骇人听闻的解决方案可能是使用这样的标记：

```
<button><span>Go</span></button> 
```

并将您的边框样式应用于 span 元素。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-01-11T15:52:22.203

添加 *border:none 这将删除 IE6 和 IE7 的边框，但保留其他浏览器的边框

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-02-05T21:52:40.040

使用推拉门技术，`spans`在内部使用两个`button`。并消除`button`IE 覆盖中的任何格式。

```
<button><span class="open">Search<span class="close"></span></span></button> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-11-15T01:54:06.097

我（还）不能发表评论，所以我必须以这种方式添加我的评论。我认为大卫默多克先生的建议对 Opera 来说是最好的（[这里](https://stackoverflow.com/questions/126445/any-way-to-remove-ies-black-border-around-submit-button-in-active-forms/3365781#3365781)）。天哪，顺便说一句，他有一个多么可爱的女孩。

我已经在 Opera 中尝试过他的方法，并且以这种方式基本上成功地将输入标签加倍：

```
<input type="submit" value="Go" style="display:none;" id="WorkaroundForOperaInputFocusBorderBug" />
<input type="submit" value="Go" /> 
```

这样第一个元素被隐藏，但它捕获了 Opera 将显示焦点提供给第二个输入元素。爱它！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-01-05T11:09:10.160

至少在 IE7 中，您可以设置无法删除的边框样式（将其设置为无）。因此，将边框的颜色设置为与背景应该相同的颜色。

```
.submitbutton { 
background-color: #fff;
border: #fff dotted 1px; 
} 
```

如果你的背景是白色的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-12-23T10:58:41.243

对我来说，下面的代码确实有效。

```
<!--[if IE]>
    <style type="text/css">
    input[type=submit],input[type=reset],input[type=button]
        {
            filter:chroma(color=#000000);
            color:#010101;
        }
    </style>
<![endif]--> 
```

从`@Mark's` [答案](https://stackoverflow.com/a/9428298/769678)中得到它并仅为 IE 加载它。

# debugging - 运行时调用堆栈

> ID：126450
> 
> 赞同：6
> 
> 时间：2008-09-24T10:48:03.100
> 
> 标签：debugging, visual-c++, callstack

我想在本机 C++ 应用程序中在运行时访问调用堆栈。我没有使用 IDE。如何显示调用堆栈？

更新：我有一个从整个应用程序的许多点调用的函数。它在极少数情况下崩溃。我正在寻找一种方法来获取呼叫者的姓名并将其记录下来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T10:57:02.127

看看[StackWalk64](http://msdn.microsoft.com/en-us/library/ms680650(VS.85).aspx)。

如果您习惯于在 .NET 上执行此操作，那么您会大吃一惊。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:20:03.910

我相信[这个](https://stackoverflow.com/questions/105659/how-can-one-grab-a-stack-trace-in-c#105741)页面有你正在寻找的答案。您说的是 Visual C，所以我假设您的意思是 windows。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T20:19:40.163

您应该考虑设置[未处理的异常过滤器](http://msdn.microsoft.com/en-us/library/ms680634.aspx)并在其中编写一个小型转储文件。它并不是那么复杂，并且有[据可查](http://www.debuginfo.com/articles/effminidumps.html)。只需坚持在未处理的异常过滤器中执行的最少操作（如果您有创意， 请阅读[所有可能出错的内容）。](http://www.nynaeve.net/?p=128)

但为了安全起见（您的未处理异常过滤器可能会无意中被覆盖），您可以将代码放在 __try/__except 块中并从过滤器函数中编写小型转储（注意，您不能有需要自动展开的对象）带有 __try/__except 块的函数，如果有，请考虑将它们放入单独的函数中）：

> 长 __stdcall myfilter(EXCEPTION_POINTERS *pexcept_info)
> {
>     mycreateminidump(pexcept_info);
>     返回 EXCEPTION_EXECUTE_HANDLER；
> }
> void myfunc()
> {
> __try{
>     //你的逻辑在这里
> } __except(myfilter(GetExceptionInformation())) {
>     // 异常处理
> }
> }

然后，您可以使用您选择的调试器检查转储文件。Visual Studio 和 Windows 调试工具包中的调试器都可以处理小型转储。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T10:31:17.487

如果你想获得崩溃的调用堆栈，你真正想做的是[事后调试](http://www.codeproject.com/KB/debug/postmortemdebug_standalone1.aspx)。如果您想在应用程序运行时检查它的调用堆栈，这是[SysInternals Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)可以提供的众多功能之一。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T10:59:26.583

如果您没有积极调试，您可以“崩溃”应用程序以生成小型转储（这可以非侵入性地完成并让应用程序继续运行）。IIRC DrWatson 会让你这样做，如果不是来自 MS 支持的 userdump。

然后，您可以将转储加载到 windbg 并在那里查看调用堆栈 + 变量等。您将需要应用程序的符号来理解跟踪。

如果您正在寻找更简单的运行时代码样式跟踪，我建议您在每个方法上实例化一个简单的类，构造函数使用 OutputDebugString 写入方法名称。使用 WinDebug 在程序运行时查看跟踪。（在您的类中放置某种形式的控制，即使它只是一个全局变量或注册表值，或全局 Atom，以便您可以随意打开或关闭跟踪）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T20:39:35.903

> 它在极少数情况下崩溃。我正在寻找一种方法来获取呼叫者的姓名并将其记录下来。

你说它崩溃是什么意思？访问冲突？除以零？究竟是什么？它是否与内核模式组件交互？

打开appverifier。那应该消除很多东西。

创建这个：

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\FileName.exe

在该键下，创建一个新的字符串名称：调试器值：c:\pathtowindbg\windbg.exe -gG -xe av

如果您使用 WOW 运行 32 位代码，则需要在 wow3264 节点下执行此操作。

# c++ - 重定向exe批处理文件的输出

> ID：126452
> 
> 赞同：1
> 
> 时间：2008-09-24T10:48:56.780
> 
> 标签：c++, visual-c++, batch-file

我想执行某个批处理文件并将其控制台输出重定向到 Visual C++ 中的文本控件，或者在显示日志/回声的同时重定向控制台输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T10:59:11.157

基本上，您必须让运行进程写入管道，并读取该管道的输出。

[编辑] 我知道 SciTE 是如何做到这一点的（您可以查看源代码：win32/SciTEWin.cxx，ExecuteOne 函数），我搜索了一种更通用的方法，发现[如何使用](http://support.microsoft.com/?scid=kb%3Ben-us%3B190351&x=15&y=14 "如何使用重定向的标准句柄生成控制台进程")Microsoft 本身的重定向标准句柄生成控制台进程.
例如，如果您搜索*CreatePipe PeekNamedPipe CreateProcess*关键字，您可能会找到其他示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T13:35:51.560

另一种选择是使用[Boost.Process](http://highscore.de/boost/process/) *（Boost.Process 还不是官方的 Boost C++ 库。必须单独下载和安装）*。

示例“ [Child.4 - 使用异步 I/O 从子进程读取](http://highscore.de/boost/process/process/tutorials.html#process.tutorials.read_from_child)”显示了如何将子进程的输出重定向到 C++ 流（然后访问内容）。

示例“ [Child.4 - 使用异步 I/O 从子级读取](http://www.highscore.de/boost/process/process/tutorials.html#process.tutorials.async_io)”展示了如何将 Boost.Process 与[Boost.Asio](http://www.boost.org/doc/libs/1_36_0/doc/html/boost_asio.html)一起使用来访问子级异步 I/ *O*。

这种方法的优点是，Boost.Process 支持 Windows API 和 POSIX API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T12:05:06.987

如果优雅不是优先事项，那么一个非常简单的解决方案可能是将输出重定向到文件，然后读入文件内容。

# deployment - 如何使用 WiX 3.0 部署注册表项和值？

> ID：126465
> 
> 赞同：3
> 
> 时间：2008-09-24T10:52:52.730
> 
> 标签：deployment, wix, windows-installer

如果我想创建注册表项

> HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application\MyApp

带有字符串值

> 事件消息文件：C:\Path\To\File.dll

如何在我的[WiX](http://en.wikipedia.org/wiki/WiX) 3.0 WXS 文件中定义它？非常感谢 XML 应该是什么样子的示例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T23:09:03.440

您似乎想创建一个事件日志源。如果是这种情况，您应该查看 util 扩展中的[<EventSource>](http://wix.sourceforge.net/manual-wix3/util_xsd_eventsource.htm)元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T11:20:57.187

看看[这个页面](http://wix.mindcapers.com/wiki/RegistryValue_Element)。一个例子是：

```
<registry action="write" 
 root"HKLM" key="SYSTEM\CurrentControlSet\Services\Eventlog\Application\MyApp"
 type="string" value="EventMessageFile : C:\Path\To\File.dll" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T13:02:16.537

我和这个一起去了：

```
<Component Id="EventLogRegKeys" Guid="{my guid}">
    <RegistryKey Id="Registry_EventLog" Root="HKLM" Key="SYSTEM\CurrentControlSet\Services\Eventlog\Application\MyApp" Action="create">
        <RegistryValue Id="Registry_EventLog_EventSourceDll" Action="write" KeyPath="yes" Name="EventMessageFile" Type="string" Value="C:\Path\To\File.dll" />
    </RegistryKey>  
</Component> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T15:58:59.110

最好使用文件引用语法来引用 File.dll，以确保使用它安装到的实际路径。使用`[#filekey]`，其中`filekey`是描述文件`Id`的`File`元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T11:16:00.007

在 DirectoryRef --> Directory... 下使用以下内容

<组件 ID="RegisterAddReferencesTab32" Guid="D9D01248-8F19-45FC-B807-093CD6765A60">

  <RegistryValue Action="write" Id="RegInstallDir32" Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application\MyApp" Root="HKLM" Type="string" Value="C:\Path\To\File .dll" />

</组件>

# visual-studio-2008 - 如何停止右键单击死锁 Visual Studio 2008

> ID：126472
> 
> 赞同：11
> 
> 时间：2008-09-24T10:54:16.127
> 
> 标签：visual-studio-2008, crash, deadlock

我在使用 Visual Studio 2008 时遇到了一个非常严重的问题。有时，当我在调试时右键单击（用于转到定义、设置下一条语句等），Visual Studio 只会死锁并进入无响应模式。

有没有人有同样的问题？有谁知道如何解决它？

**编辑：**我正在使用带有几个热修复程序的 SP1。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-05T16:04:13.753

**问题：**
签名的应用程序/dll 在 Vista 中加载缓慢。Visual Studio IDE“挂起”在离线/非 Internet 连接的工作站上。如果没有 Internet 连接，证书吊销检查会超时并导致应用程序挂起。当调试/单步调试代码时，会根据需要加载 dll，这是尝试撤销检查并且 VS IDE 变得无响应的时候。

**这会影响什么：**
这会影响所有已签名的应用程序/dll，这也是 Microsoft Word/Excel 需要很长时间才能打开一个简单文档的原因。使用证书的 Office 应用程序、SQL Management Studio、Visual Studio、Web 应用程序。

**修复：**
禁用发布者证书吊销检查

通过 IE：

1.  转到 IE 7 中的 Internet 选项
2.  然后转到安全选项卡，向下滚动
3.  取消选中“检查发布者的证书吊销”复选框
4.  点击确定

通过注册表：

1.  打开注册表
2.  浏览到以下项：HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\WinTrust\Trust Providers\Software Publishing

3.  要禁用检查：将 State 键的值更改为 146944 Decimal 或 0x00023e00 Hexadecimal
    要重新启用检查：将 State 键的值更改为 146432 Decimal 或 0x00023c00 Hexadecimal

**替代修复：**
禁用 Visual Studio 托管进程：

1.  在 Visual Studio 中打开一个项目。
2.  在项目菜单上，单击属性。
3.  单击调试选项卡。
4.  清除启用 Visual Studio 托管进程复选框。

注意：备用修复会导致某些调试功能丢失。

背景：
[Microsoft Connect 报告](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=343014)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-28T11:09:41.153

自从我移至 Windows7 后，我不再出现此问题。如果您不幸仍然坚持使用 Windows Vista，我确实发现它仅在等待构建智能感知数据库时才挂在右键单击上（有关其进度，请参见左下角）。我唯一的“修复”是等待智能感知停止构建，然后右键单击。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T11:08:14.520

前几天我写了一段代码，一个非常疯狂的模板，如果我将鼠标放在模板化的代码上，最新的 VisualStudio 就会挂起。这是超现实的:)

无论如何，您可能会遇到这样的问题，您可能想删除您的智能感知数据库并重试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T11:30:31.330

[尝试在安全模式下](http://msdn.microsoft.com/en-us/library/xee0c8y7(VS.80).aspx)启动 Visual Studio以排除安装的任何扩展的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-30T17:27:20.833

在调试多线程应用程序时，有时我会在遇到断点时挂起。当我试图通过右键单击代码中的变量来查看变量时，有时 VS 会挂起（沙漏）。

我用谷歌搜索了一个提示，解释说，当 VS 中断时，它会评估本地变量和监视窗格中的所有变量，以便显示它们。但是在线程应用程序中，如果代码在评估值时（例如在属性获取器中）锁定，这可能会导致死锁。

通过在我休息之前关闭本地窗格，我避免了挂起。

我没有很好地解释这一点。我再次尝试谷歌搜索以找到原始提示，但没有成功。

*可能是*这样的：[为什么 Visual Studio 在调试时会停止？](https://stackoverflow.com/questions/317678/why-does-visual-studio-stall-while-debugging/317807#317807).

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-09-06T15:18:44.920

退出 Visual Studio 并删除项目的 .ncb 文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T11:04:16.527

不，但这听起来像一个错误。将其报告给 MS，他们会给您说明如何获得调试设置，然后向他们发送信息以进行调试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T11:04:49.287

马克，你申请SP1了吗？

我没有遇到您的确切问题，但是在调试模式下（或退出调试模式时）锁定 15 秒确实有问题。我在某处发现了一篇博客文章，其中提出了一些可能的修复方法。

其中之一是进入 IE 7 并打开工具-> Internet 选项-> 高级选项卡-> 安全部分并取消选中“检查发布者的证书吊销”和“检查服务器证书吊销”（或至少第一个）。一旦我这样做了，我的锁定困境就结束了。

诚然，我的开发箱不在互联网上，所以无论如何我并不关心 IE 中的大多数设置。不知道这对您是否有帮助，但它确实解决了我与 VS 2008 的问题。

祝一切顺利！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-16T21:53:40.370

我发现在调试多线程应用程序时，Visual Studio (VC9) 会定期锁定。我通常必须重新启动才能恢复系统。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-18T17:53:15.830

对我来说，我发现 VS 试图打开一个在我之前进行远程调试时已过期的 IP。在 Tools-->Options-->Debugging--->Symbols 下检查您的调试设置 确保那里没有错误的路径。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-08-29T15:43:00.980

不是我知道的解决方案，而是将我的 VC 项目从 VC2008 移动到 VC2010（Intellisense 已被禁用）的理由。尽管 3 小时内没有明确点击保存，但恢复工作正常。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-26T17:42:52.043

以下对我有用：

> 删除关联项目的 .ncd 和 .suo 文件。

[来源](http://social.msdn.microsoft.com/Forums/hu-HU/vcgeneral/thread/611c7f62-85f1-4294-9dc3-4dca29fe33da)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-09-24T11:14:51.447

啊，另一个重要的节目停止者可能是“ActiveDirectory”。如果这发生在您的工作中并且他们使用“ActiveDirectory”，则可能会发生这种情况。这里有人声称这是谷歌工具栏的一个错误，但我没有确凿的证据表明谷歌是否对此负责。

# flash - Flash Player 9 中的 SWD 文件

> ID：126510
> 
> 赞同：0
> 
> 时间：2008-09-24T11:04:30.737
> 
> 标签：flash

是否有人对 Flash 9 中的 SWD 文件有任何指示，为什么 Flash Player 有时想要下载它们，如何制作，如何使用它们？我自己还没有设法挖掘任何有用的东西。

*更新*

我大致知道 Flash8 中使用的 swd 文件是什么，[甚至还有制作它们的方法](http://livedocs.adobe.com/flex/15/flex_docs_en/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flex_Documentation&file=00000838.htm)，但 Flash 9 乍一看似乎不需要它，但有时还是会尝试使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-25T03:12:47.507

使用 Adob​​e 的调试工具调试内容需要 SWD 文件。您可以通过使用 shift-control-enter 从 Flash 创作中发布来看到这一点。

只有调试工具才能看到 SWF 内部，才需要 SWD 本身。完成调试后，您可以将其丢弃，除非您打算进行远程调试，否则无需将其上传到服务器。

Docs:
[调试本地文件](http://livedocs.adobe.com/flash/9.0/UsingFlash/help.html?content=WS3e7c64e37a1d85e1e229110db38dec34-7fc0.html)
[调试远程文件](http://livedocs.adobe.com/flash/9.0/UsingFlash/help.html?content=WSE9184681-3417-4849-B487-8D6C2F8CC688.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T11:09:24.890

> SWD 文件与 SWF 文件类似，不同之处在于它们包含调试器和 Flash 调试播放器监视的特定于调试的信息。

来自：关于 SWD 文件

上面的引用来自 Flex 文档，但也适用于“普通”Flash。

# php - PHP 和 MS 访问：SELECT 查询返回的记录数

> ID：126513
> 
> 赞同：3
> 
> 时间：2008-09-24T11:04:46.023
> 
> 标签：php, database, ms-access

我正在运行以下`PHP`代码来与 MS Access 数据库进行交互。

```
$odbc_con = new COM("ADODB.Connection");
$constr = "DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=" . $db_path . ";";
$odbc_con -> open($constr);

$rs_select = $odbc_con -> execute ("SELECT * FROM Main"); 
```

`($rs_select -> RecordCount)`尽管查询返回非零记录，但使用会给出 -1。

(a) 可能是什么原因？(b) 有什么出路吗？

我也尝试过使用`count($rs_select -> GetRows())`. 这满足了需求，但看起来效率低下，因为它将首先将所有记录复制到一个数组中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T11:32:53.773

ODBC 可能还不知道记录数。在这种情况下，可以转到最后一条记录，然后记录计数才会反映真实的记录数。这也可能不是很有效，因为它将从查询中加载所有记录。

正如奥利所说，使用`SELECT COUNT(*)`会给你结果。我认为使用 2 个查询仍然比使用我的第一种方法更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T21:43:40.777

根据您定义的记录集类型，ADODB 对返回的记录计数有自己的规则。看：

[MS 知识库文章 194973](http://support.microsoft.com/kb/194973)

[W3C 学校文章](http://www.w3schools.com/ADO/prop_rs_recordcount.asp)

在上面的示例中，PHP COM() 对象用于实例化 ADODB，这是一个用于通用数据库访问的 COM 接口。根据[PHP 文档](http://us3.php.net/manual/en/class.com.php)，生成的对象引用是重载的，因此您可以使用与本机 ADODB 对象相同的属性/方法。这意味着您需要使用 ADODB 方法将记录集类型设置为能够提供准确记录计数的类型（如果您必须拥有它）。正如其他人所提到的，另一种方法是使用第二个查询来获取 SELECT 语句返回的记录的 COUNT()。这更容易，但在特定环境中可能不合适。

我不是 ADO 专家，因此无法为您提供设置记录集类型的确切命令，但从上面引用的文章中，很明显您需要静态或键集游标。在我看来，设置 CursorType 的正确方法是在打开记录集的命令中使用参数。[这篇关于 CursorType 属性的 W3C Schools 文章](http://www.w3schools.com/ADO/prop_rs_cursortype.asp)为该命令提供了适当的参数。

希望这些信息能以一种或另一种方式帮助原始发帖人完成他的任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T11:14:25.050

Access 没有自己的 COUNT 运算符吗？例如：

```
$rs_select = $odbc_con -> execute ("SELECT COUNT(*) FROM Main"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T18:21:29.047

基本上，Access 在需要之前不会向您显示整个记录集（无论如何，对于大部分用户体验来说，这种方式更快） - 特别是对于较大的记录集。

要获得准确的计数，您必须遍历整个记录集。在 VBA 中，我通常使用 foo.MoveLast 和 foo.MoveFirst 的二重奏来做到这一点——我不知道 php 的等价物是什么。它很贵，但听起来你无论如何都要处理整个记录集，我想这没关系。

（附带说明，如果您在 VBA 中操作书签，则同样的遍历也是必要的，因为如果您克隆记录集并且在将书签复制回表单的记录集之前不遍历它，您可能会得到一些疯狂的结果）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-25T16:26:10.923

如果您使用的是动态游标类型的连接，那么它实际上可能会发生变化。当您浏览记录页面时，有人可能会从该数据库中删除记录。为避免这种情况，请使用静态类型的快照游标。我有这个书签，它会很好地解释它。这总是让我着迷，书签总是提醒我为什么。

[http://support.microsoft.com/kb/194973](http://support.microsoft.com/kb/194973)

# routes - 可轻松访问路由数据的 GIS/制图解决方案

> ID：126520
> 
> 赞同：2
> 
> 时间：2008-09-24T11:08:01.167
> 
> 标签：routes, mapping, gis, esri, arcgis-js-api

我正在寻找一个 GIS/Mapping 工具，它可以让我在 ASP.NET Web 应用程序中轻松地从服务器端访问路线信息（特别是行程时间和距离）。

据我所知，谷歌和雅虎地图在客户端用 javascript 做所有事情，但都不提供仅检索路线信息的服务。我对免费和付费产品都感兴趣。此外，如果您有产品经验，我想听听您的想法（API 的复杂性、运行时性能、喜欢、不喜欢等）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T14:37:52.173

ESRI 的 ArcGIS Server 和 ArcWeb 服务提供点对点路由。您可以完全控制创建数据（如果需要）、更改数据、自定义参数，甚至添加动态成本分析。服务器对于 JUST 路由来说可能有点重，因为它是一个完整的映射和分析服务器系统。ArcWeb 是一种在线服务，您可以在其中购买您想要的服务。

另一个选择是 Oracle Spatial。他们有一些内置的网络/路由功能来进行点对点路由。我个人一直无法让它工作，但我听说过它可以工作，但具有 Oracle 的正常复杂性（即不是 DIY 工作）。

MapQuest 还拥有一套全面的 API（比 Google 或 Yahoo 恕我直言好得多），可以在没有地图的情况下进行路由。不确定他们的许可/成本是多少，以及他们与 Google/Yahoo 相比如何用于非个人用途。

（请注意：许多“免费”服务要求您为非个人使用支付许可费......他们可能会忽略您，直到您的流量高到足以让他们注意到，所以要小心）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T11:26:48.203

我们已经成功地使用 Map24 ( [http://developer.navteq.com/site/global/zones/ms/index.jsp](http://developer.navteq.com/site/global/zones/ms/index.jsp) ) 的网络服务来做一些 GIS-y 类型的事情。他们有一个用于路由的网络服务（[http://developer.navteq.com/site/global/zones/ms/map24webservices/map24routingservice.jsp](http://developer.navteq.com/site/global/zones/ms/map24webservices/map24routingservice.jsp)），我去年快速玩过。

他们的 API 有一些学习曲线，但是一旦你通过了它，他们的东西就会非常强大并且性能非常好。

菲尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T18:23:39.137

Arc Web 服务正在消失，现在正在成为 ArcGIS Online。

这意味着一个全新的更新 sdk 用于为网站开发 arc web 应用程序。

如果您需要一个真正先进的路由系统，一家名为 routesmart 的公司为客户端服务器应用程序和现在使用 ArcGIS 9.x 的 Web 应用程序提供基于 dll 的路由求解器解决方案

所有 ESRI api 都很复杂。你必须刚开始使用它，当你获得它的经验时，你会感觉更舒服。

由于 ESRI 在 GIS 功能的某些方面的垄断程度有所缩小，因此看看谷歌和其他公司开发什么来为 GIS 世界创造一些体面的竞争将会很有趣。在那之前，所有包含 GIS 的解决方案都不会灵活或易于使用且价格昂贵。

我对 ESRI 产品的一个主要抱怨是相当空灵的，但这似乎是我在他们所有产品线中都经历过的一个反复出现的主题。

你做一个 code\db\whatever 更新和测试。它不起作用。你不做任何改变就再试一次，它仍然不起作用，但如果你再试一次，它突然就起作用了。就像 ESRI 在对点发布、mxd、sde 数据或 python 代码进行任何更改以开始按预期执行之前，先将所有内容编码为失败 2 次。如果您曾经使用过他们的产品，这可能看起来很奇怪，因为您亲身体验过。这可能与我缺乏了解有关，但我所有的 GIS 朋友都倾向于同意我的观点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-11T15:47:01.340

正如我在一条评论中提到的，我们在[Oracle Spatial NDM](http://docs.oracle.com/cd/E11882_01/appdev.112/e11831/sdo_net_concepts.htm#TOPOL700)方面拥有非常好的经验。这是一个[非常方便的教程](http://www.oracle.com/technetwork/indexes/samplecode/ndm-graph-1947612.html)。

我知道的另一个选择是[pgRouting](http://pgrouting.org/)。

另请参阅[GIS Stackexchange](https://gis.stackexchange.com/questions/210/alternatives-to-pgrouting)上的这篇文章。

# java - Java：Eclipse - 差异跟踪

> ID：126521
> 
> 赞同：3
> 
> 时间：2008-09-24T11:08:07.310
> 
> 标签：java, eclipse, diff, trace, callstack

我有一个带有 JUnit 测试的项目的两个版本。查看文件的差异并没有明显的原因，但是测试通过了一个项目，但没有通过另一个项目。

一段时间以来，我一直想知道是否有一个程序可以在运行时记录整个程序的跟踪并将其保存到文件中。这对于这个确切的例子来说真的很方便，我想通过两个测试进行跟踪，然后我想把它们放在一起。

任何人都可以向我指出可能能够做到这一点的程序的方向，或者我可以区分两个程序的流程的方式吗？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T11:12:47.207

我会为此使用方面。例如，查看 AspectJ，很容易设计一条规则（切入点）“对于我的 Java 代码中调用的所有方法，记录方法名称”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T11:15:56.450

如果我正确理解您的问题，这可能会部分实现您的目标。

[http://www.lambdacs.com/debugger/debugger.html](http://www.lambdacs.com/debugger/debugger.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T12:07:12.240

Eclipse [TPTP 项目](http://www.eclipse.org/tptp/)有一个跟踪引擎，您可能会发现它很有用。

# python - 在 Python 中使用索引迭代列表

> ID：126524
> 
> 赞同：210
> 
> 时间：2008-09-24T11:08:52.053
> 
> 标签：python, list

我可以发誓我已经看到了接受一个列表的函数（或方法），就像这样`[3, 7, 19]`并将它变成可迭代的元组列表，就像这样：`[(0,3), (1,7), (2,19)]`使用它而不是：

```
for i in range(len(name_of_list)):
    name_of_list[i] = something 
```

但我不记得名字和谷歌搜索“迭代列表”一无所获。

* * *

## 回答 #1

> 赞同：375
> 
> 时间：2008-09-24T11:11:41.173

```
>>> a = [3,4,5,6]
>>> for i, val in enumerate(a):
...     print i, val
...
0 3
1 4
2 5
3 6
>>> 
```

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2008-09-24T11:12:14.540

是的，这就是[`enumerate`](http://docs.python.org/library/functions.html#enumerate)功能！或者更重要的是，您需要执行以下操作：

```
list(enumerate([3,7,19]))

[(0, 3), (1, 7), (2, 19)] 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-24T14:10:58.417

这是另一个使用该`zip`功能的方法。

```
>>> a = [3, 7, 19]
>>> zip(range(len(a)), a)
[(0, 3), (1, 7), (2, 19)] 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-09-13T02:01:14.407

这是使用地图功能的解决方案：

```
>>> a = [3, 7, 19]
>>> map(lambda x: (x, a[x]), range(len(a)))
[(0, 3), (1, 7), (2, 19)] 
```

以及使用列表推导的解决方案：

```
>>> a = [3,7,19]
>>> [(x, a[x]) for x in range(len(a))]
[(0, 3), (1, 7), (2, 19)] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-04-12T10:55:14.307

python`enumerate`函数将满足您的要求

```
result = list(enumerate([1,3,7,12]))
print result 
```

**输出**

```
[(0, 1), (1, 3), (2, 7),(3,12)] 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-02-16T10:12:11.950

如果您有多个列表，则可以结合使用`enumerate`和`zip`：

```
list1 = [1, 2, 3, 4, 5]
list2 = [10, 20, 30, 40, 50]
list3 = [100, 200, 300, 400, 500]
for i, (l1, l2, l3) in enumerate(zip(list1, list2, list3)):
    print(i, l1, l2, l3) 
```

输出：

```
0 1 10 100
1 2 20 200
2 3 30 300
3 4 40 400
4 5 50 500 
```

请注意，括号后是必需的`i`。否则你会得到错误：`ValueError: need more than 2 values to unpack`

# vb.net - Microsoft Office .NET 插件的单元测试

> ID：126526
> 
> 赞同：6
> 
> 时间：2008-09-24T11:09:22.253
> 
> 标签：vb.net, ms-office, add-in

有没有人对 Office 托管应用程序加载项进行单元测试有任何建议？我正在使用 NUnit，但我在使用 MSTest 时遇到了同样的问题。

问题是在 Office 应用程序（在我的例子中是 Word）中加载了一个 .NET 程序集，我需要一个对 .NET 程序集实例的引用。我不能只实例化该对象，因为它不会有 Word 的实例来做事。

现在，我可以使用 Application.COMAddIns("Name of addin").Object 接口来获取引用，但这会得到一个通过 RequestComAddInAutomationService 返回的 COM 对象。到目前为止，我的解决方案是让该对象为我想要测试的真实 .NET 对象中的每个方法都有代理方法（全部在条件编译下设置，因此它们在发布的版本中消失）。

COM 对象（一个 VB.NET 类）实际上具有对真实加载项实例的引用，但我尝试将其返回给 NUnit，但我得到了一个不错的 p/Invoke 错误：

System.Runtime.Remoting.RemotingException ：此远程代理没有通道接收器，这意味着服务器没有注册的服务器通道正在侦听，或者此应用程序没有合适的客户端通道与服务器通信。在 System.Runtime.Remoting.Proxies.RemotingProxy.InternalInvoke(IMethodCallMessage reqMcmMsg, Boolean useDispatchMessage, Int32 callType) 在 System.Runtime.Remoting.Proxies.RemotingProxy.Invoke(IMessage reqMsg) 在 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke (MessageData&msgData, Int32 类型)

我尝试使主加载项 COM 可见并且错误更改：

System.InvalidOperationException ：由于对象的当前状态，操作无效。在 System.RuntimeType.ForwardCallToInvokeMember（字符串成员名称、BindingFlags 标志、对象目标、Int32 [] aWrapperTypes、MessageData 和 msgData）

虽然我有一个变通办法，但它很混乱，并且将大量测试代码放在真实项目而不是测试项目中——这并不是 NUnit 真正的工作方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T11:32:37.697

这就是我解决它的方法。

1.  我的加载项中的几乎所有内容都从 UI 中按钮的 Click 方法运行。我已将所有这些 Click 方法更改为仅包含一个简单的无参数调用。

2.  然后，我创建了一个名为 EntryPoint 的新文件（部分类），其中包含许多非常短的 Friend Sub，每个通常都是对参数化工作函数的一两次调用，因此所有 Click 方法都只调用到该文件中。因此，例如，有一个函数可以打开一个标准文档并将“另存为”调用到我们的 DMS 中。该函数接受打开哪个文档的参数，我们使用了几十个标准文档。

所以我有

```
Private Sub btnMemo_Click(ByVal Ctrl As Microsoft.Office.Core.CommandBarButton, ByRef CancelDefault As Boolean) Handles btnMemo.Click
    DocMemo()
End Sub 
```

在 ThisAddin 然后

```
Friend Sub DocMemo()
    OpenDocByNumber("Prec", 8862, 1)
End Sub 
```

在我的新入口点文件中。

3.  我添加了一个新的 AddInUtilities 文件，该文件具有

    公共接口 IAddInUtilities

`#If DEBUG Then`

```
Sub DocMemo() 
```

`#End If`

```
End Interface

Public Class AddInUtilities
    Implements IAddInUtilities
    Private Addin as ThisAddIn 
```

`#If DEBUG Then`

```
Public Sub DocMemo() Implements IAddInUtilities.DocMemo
    Addin.DocMemo()
End Sub 
```

`#End If`

```
 Friend Sub New(ByRef theAddin as ThisAddIn)
     Addin=theAddin
 End Sub
 End Class 
```

4.  我转到 ThisAddIn 文件并添加

    私有实用程序作为 AddInUtilities

    Protected Overrides Function RequestComAddInAutomationService() As Object If utility is Nothing Then utility = New AddInUtilities(Me) End If Return utility End Function

现在可以使用 NUnit 在 EntryPoints 中测试 DocMemo() 函数，如下所示：

```
<TestFixture()> Public Class Numbering

Private appWord As Word.Application
Private objMacros As Object

<TestFixtureSetUp()> Public Sub LaunchWord()
    appWord = New Word.Application
    appWord.Visible = True

    Dim AddIn As COMAddIn = Nothing
    Dim AddInUtilities As IAddInUtilities
    For Each tempAddin As COMAddIn In appWord.COMAddIns
        If tempAddin.Description = "CobbettsMacrosVsto" Then
            AddIn = tempAddin
        End If
    Next
    AddInUtilities = AddIn.Object
    objMacros = AddInUtilities.TestObject

End Sub

<Test()> Public Sub DocMemo()

    objMacros.DocMemo()
End Sub

<TestFixtureTearDown()> Public Sub TearDown()
    appWord.Quit(False)
End Sub

End Class 
```

唯一不能进行单元测试的是实际的 Click 事件，因为您以不同的方式调用 EntryPoints，即通过 RequestComAddInAutomationService 接口而不是通过事件处理程序。

但它有效！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T11:19:14.243

考虑使用各种模拟框架[NMock](http://www.nmock.org/)、[RhinoMocks](http://ayende.com/projects/rhino-mocks.aspx)等来伪造 Office 在您的测试中的行为。

# safari - 我怎样才能得到 在 Safari 中工作？

> ID：126528
> 
> 赞同：1
> 
> 时间：2008-09-24T11:10:12.300
> 
> 标签：safari, aspmenu

在 safari 浏览器上，标准的 <asp:Menu> 根本不能很好地呈现。如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T14:53:40.843

感谢您的建议，它使我进入了以下解决方案；

我创建了一个名为“safari.browser”的文件并将其放在 App_Browsers 目录中。该文件的内容如下所示；

```
<browsers>
    <browser refID="safari1plus">
        <controlAdapters>
            <adapter controlType="System.Web.UI.WebControls.Menu" adapterType="" />
        </controlAdapters>
    </browser>
</browsers> 
```

据我了解，这告诉 ASP.NET 不要使用它通常用来呈现控件内容的适配器，而是使用上层呈现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:00:40.790

您可以使用 ControlAdapters 来更改服务器控件的呈现。

这是一个例子： [http ://www.pluralsight.com/community/blogs/fritz/archive/2007/03/27/46598.aspx](http://www.pluralsight.com/community/blogs/fritz/archive/2007/03/27/46598.aspx)

不过，在我看来，放弃菜单控件而使用纯 css 控件（在许多站点上可用）可能是相同的工作量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T13:30:20.713

Oooof - 希望这将是在 web.config 中添加具有适当值或类似值的 browserCaps 项的简单案例......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-10T17:34:34.763

我为这个问题找到的最好和最简单的解决方案是在你的 page_load 事件中包含这段代码。

```
if (Request.UserAgent.IndexOf("AppleWebKit") > 0)
    Request.Browser.Adapters.Clear(); 
```

# ide - VS2003/05 经常搞砸显示 - 有什么已知的解决方法吗？

> ID：126546
> 
> 赞同：2
> 
> 时间：2008-09-24T11:15:19.417
> 
> 标签：ide, visual-studio-2005, windows-vista, visual-studio-2003

在 Vista 下运行 VS2003/05 会使前者在至少 50% 的时间里搞砸显示 - 你开始调试，VS 启动，你看到窗口/停靠窗格搞砸了，没有刷新，等等......我已经联系过了微软对此，但他们没有太大帮助，我想知道是否有人知道任何修复？

我在 Vista 下关闭了视觉样式运行 VS，因此当您尝试执行“在文件中查找”时它不会挂起。

已安装所有最新更新/服务包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T11:21:52.817

对于 Visual Studio 2005，安装 [Microsoft® Visual Studio® 2005 Service Pack 1](http://www.microsoft.com/downloads/details.aspx?FamilyID=BB4A75AB-E2D4-4C96-B39D-37BAF6B5B1DC&displaylang=en)

和 [适用于 Windows Vista 的 Visual Studio 2005 Service Pack 1 更新](http://www.microsoft.com/downloads/details.aspx?FamilyID=90E2942D-3AD1-4873-A2EE-4ACC0AACE5B6&displaylang=en)

查看[Windows Vista 问题列表中的 Visual Studio .NET 2003](http://msdn.microsoft.com/en-us/vs2005/bb188244.aspx)并查看是否在其中找到了一些东西。

看看这是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-29T08:28:54.337

我在 Vista 上使用 Visual Studio 2005 Express 做了很多工作，但从未见过任何显示问题。

Vista 对视频驱动程序的质量非常敏感 - 您是否尝试过更新您的驱动程序？

# winforms - 自定义绘制 Windows 窗体滚动条？

> ID：126555
> 
> 赞同：4
> 
> 时间：2008-09-24T11:18:07.817
> 
> 标签：winforms, scrollbar, skinning

我知道如何自定义绘制独立的 Windows 窗体 ScrollBar，因为在 codeproject.com 之类的地方有很多示例。但是，您如何自定义绘制不是您自己创建的控件中的滚动条？例如，面板可以显示滚动条，但我如何确保它显示的滚动条是自定义绘制的？

或者这可能是不可能的，我需要创建自己的面板版本，以便他们使用我自己的自定义绘图滚动条？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T13:37:41.337

您最常看到的滚动条，包括那些内置在大多数 winforms 控件中的滚动条，都是由 Windows 呈现的，并且没有办法覆盖它们在 WinForms 中的外观，除非实现完全接管通用滚动条控件的呈现和行为的完全自定义的解决方案. 有一些商业软件包声称可以做到这一点（google winforms skinning）。

# css - 为什么 Firefox 2 显示的字体大于 CSS 中指定的字体？

> ID：126557
> 
> 赞同：2
> 
> 时间：2008-09-24T11:18:47.473
> 
> 标签：css, firefox, font-size

我有一个网页，其中 Firefox 2 显示某些字体，非常具体的元素，比我在 CSS 中指定的要大。

当我`td`用 Firebug 查看受影响的元素（据我所知主要是元素）时，我看到它`font-size`是从`body`（11px，所以它不是相对大小）继承的。任何地方都没有样式覆盖这个`font-size`。当我切换*显示计算样式*选项时，`font-size`它显示为 16 像素，这是 Firefox 的默认值。

似乎`td`没有`font-size`正确继承。显然，我可以指定一个更具体的 CSS 选择器来定位`td`（实际上可以），但我找不到任何记录在案的 Firefox 没有`font-size`正确继承的行为。它只发生在几个表中，但彼此完全无关。

有谁知道我是否忽略了某些东西，或者这是 Firefox 中的渲染问题？Internet Explorer（我知道，不是标准合规性的最佳参考）不会在表格中放大字体大小。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T11:40:19.683

这是一个众所周知的烦恼：TABLEs 和 TDs 将继承除 font-size 之外的所有字体样式，至少在 XHTML 中是这样。要“修复”此问题，请同时为 TABLE 或 TD 元素设置字体大小。

所以澄清一下，这不是 Firefox 特有的。你在其他浏览器中测试过吗？

# windows-installer - 如何替换 msi 安装程序中的文件？

> ID：126562
> 
> 赞同：29
> 
> 时间：2008-09-24T11:19:40.060
> 
> 标签：windows-installer

我想替换 msi 中的单个文件。怎么做？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2011-02-24T11:19:06.627

使用[msi2xml](http://msi2xml.sourceforge.net/)。

1.  此命令提取 MSI 文件：

    msi2xml -c OutputDir TestMSI.MSI

2.  打开**OutputDir**并修改文件。

3.  要重建 MSI 运行：

    xml2msi.exe -m TestMSI.xml

您需要 -m 来忽略修改 MSI 文件时失败的“MD5 校验和测试”。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-24T11:31:47.443

您需要使用[**MsiDB.exe**](http://msdn.microsoft.com/en-us/library/aa370083(VS.85).aspx)（随[Windows Installer SDK](https://www.softpedia.com/get/Programming/SDK-DDK/Windows-Installer-SDK.shtml)提供）从您的 msi 中提取 CAB 文件流。**使用 -x 选项从命令行**运行它并指定 cab 文件的名称 - 这在 msi 数据库的 Media 表中列出。

或者，如果您将 VSI 选项中的“打包文件为：”选项指定为“压缩在机柜文件中”，则可以跳过此部分，以便在构建时将 cab 文件排除在 msi 之外（它将在同一目录中创建作为微星）。

提取后，您可以更改 cab 文件夹中的指定文件 - 它的名称已被破坏，因此您需要找出文件表中文件的 msi 名称，然后将新文件重命名为该文件。

完成后，您可以使用**MsiDB 实用程序使用 -a 选项将**其弹出。

在使用 -a 添加之前，您需要使用**msidb -k**从 MSI中[删除 cab](http://community.installshield.com/showthread.php?t=182791)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-09T13:21:56.493

试试 InstEd - [http://www.instedit.com/](http://www.instedit.com/)上的安装程序编辑器。它有 30 天的试用期，对我有用。您将文件解压缩到一个文件夹，编辑、重建 cab，然后保存 MSI。除了文件的编辑之外，一切都在 GUI 中完成。

不是一个很棒的程序，但我花了 30 美元才能够在 MSI 中快速编辑文件。

除了支付和使用该应用程序外，我不以任何方式为 InstEd 或相关机构工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T04:24:38.763

替换 MSI 中文件的非常简单的示例代码。这不会将新文件/CAB 流式传输回 MSI，但需要 CAB 与 MSI 位于同一目录中才能成功安装。我敢肯定，您可以通过更多的努力来更改代码以将 CAB 流式传输回来。

```
Const MSI_SOURCE = "application.msi"
Const FILE_REPLACE = "config.xml"

Dim filesys, installer, database, view
Dim objFile, size, result, objCab

Set filesys=CreateObject("Scripting.FileSystemObject")
Set installer = CreateObject("WindowsInstaller.Installer")
Set database = installer.OpenDatabase (MSI_SOURCE, 1)

Set objFile = filesys.GetFile(FILE_REPLACE)
size = objFile.Size

Set objCab = CreateObject("MakeCab.MakeCab.1")
objCab.CreateCab "config.cab", False, False, False
objCab.AddFile FILE_REPLACE, filesys.GetFileName(FILE_REPLACE)
objCab.CloseCab

Set view = database.OpenView ("SELECT LastSequence FROM Media WHERE DiskId = 1")
view.Execute

Set result = view.Fetch
seq = result.StringData(1) + 1 ' Sequence for new configuration file

Set view = database.OpenView ("INSERT INTO Media (DiskId, LastSequence, Cabinet) VALUES ('2', '" & seq & "', 'config.cab')")
view.Execute

Set view = database.OpenView ("UPDATE File SET FileSize = " & size & ", Sequence = " & seq & " WHERE File = '" & LCase(FILE_REPLACE) & "'")
view.Execute 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-10T11:32:47.610

此代码仅在 1 个文件上进行了测试，其中名称与被替换的文件完全相同。

但它应该使用 DTF（来自 WIX）在 C# 中实现 Christopher Painters 的答案

```
/**
 * this is a bastard class, as it is not really a part of building an installer package, 
 * however, we need to be able to modify a prebuild package, and add user specific files, post build, to save memory on server, and have a fast execution time.
 * 
 * \author Henrik Dalsager
 */

//I'm using everything...
using System;
using System.IO;
using System.Linq;
using System.Text;
using System.Collections;
using System.Collections.Generic;
using System.Diagnostics.CodeAnalysis;
using System.Globalization;
using System.Text.RegularExpressions;
using Microsoft.Deployment.Compression.Cab;
using Microsoft.Deployment.WindowsInstaller;
using Microsoft.Deployment.WindowsInstaller.Package;

namespace MSIFileManipulator
{
/**
 * \brief updates an existing MSI, I.E. add new files
 * 
 */
class updateMSI
{
    //everything revolves around this package..
    InstallPackage pkg = null;

    //the destruction should close connection with the database, just in case we forgot..
    ~updateMSI()
    {
        if (pkg != null)
        {
            try
            {
                pkg.Close();
            }
            catch (Exception ex)
            {
                //rollback?

                //do nothing.. we just don't want to break anything if database was already closed, but not dereffered.
            }
        }
    }

    /**
     * \brief compresses a list of files, in a workdir, to a cabinet file, in the same workdir.
     * \param workdir path to the workdir
     * \param filesToArchive a list of filenames, of the files to include in the cabinet file.
     * \return filename of the created cab file
     */
    public string createCabinetFileForMSI(string workdir, List<string> filesToArchive)
    {
        //create temporary cabinet file at this path:
        string GUID = Guid.NewGuid().ToString();
        string cabFile = GUID + ".cab";
        string cabFilePath = Path.Combine(workdir, cabFile);

        //create a instance of Microsoft.Deployment.Compression.Cab.CabInfo
        //which provides file-based operations on the cabinet file
        CabInfo cab = new CabInfo(cabFilePath);

        //create a list with files and add them to a cab file
        //now an argument, but previously this was used as test:
        //List<string> filesToArchive = new List<string>() { @"C:\file1", @"C:\file2" };
        cab.PackFiles(workdir, filesToArchive, filesToArchive);

        //we will ned the path for this file, when adding it to an msi..
        return cabFile;
    }

    /**
     * \brief embeds a cabinet file into an MSI into the "stream" table, and adds it as a new media in the media table
     *  This does not install the files on a clients computer, if he runs the installer,
     *  as none of the files in the cabinet, is defined in the MSI File Table (that informs msiexec where to place mentioned files.)
     *  It simply allows cabinet files to piggypack within a package, so that they may be extracted again at clients computer.
     *  
     * \param pathToCabFile full absolute path to the cabinet file
     * \return media number of the new cabinet file wihtin the MSI
     */
    public int insertCabFileAsNewMediaInMSI(string cabFilePath, int numberOfFilesInCabinet = -1)
    {
        if (pkg == null)
        {
            throw new Exception("Cannot insert cabinet file into non-existing MSI package. Please Supply a path to the MSI package");
        }

        int numberOfFilesToAdd = numberOfFilesInCabinet;
        if (numberOfFilesInCabinet < 0)
        {
            CabInfo cab = new CabInfo(cabFilePath);
            numberOfFilesToAdd = cab.GetFiles().Count;
        }

        //create a cab file record as a stream (embeddable into an MSI)
        Record cabRec = new Record(1);
        cabRec.SetStream(1, cabFilePath);

        /*The Media table describes the set of disks that make up the source media for the installation.
          we want to add one, after all the others
          DiskId - Determines the sort order for the table. This number must be equal to or greater than 1,
          for out new cab file, it must be > than the existing ones...
        */
        //the baby SQL service in the MSI does not support "ORDER BY `` DESC" but does support order by..
        IList<int> mediaIDs = pkg.ExecuteIntegerQuery("SELECT `DiskId` FROM `Media` ORDER BY `DiskId`");
        int lastIndex = mediaIDs.Count - 1;
        int DiskId = mediaIDs.ElementAt(lastIndex) + 1;

        //wix name conventions of embedded cab files is "#cab" + DiskId + ".cab"
        string mediaCabinet = "cab" + DiskId.ToString() + ".cab";

        //The _Streams table lists embedded OLE data streams.
        //This is a temporary table, created only when referenced by a SQL statement.
        string query = "INSERT INTO `_Streams` (`Name`, `Data`) VALUES ('" + mediaCabinet + "', ?)";
        pkg.Execute(query, cabRec);
        Console.WriteLine(query);

        /*LastSequence - File sequence number for the last file for this new media.
          The numbers in the LastSequence column specify which of the files in the File table
          are found on a particular source disk.

          Each source disk contains all files with sequence numbers (as shown in the Sequence column of the File table)
          less than or equal to the value in the LastSequence column, and greater than the LastSequence value of the previous disk
          (or greater than 0, for the first entry in the Media table).
          This number must be non-negative; the maximum limit is 32767 files.
          /MSDN
         */
        IList<int> sequences = pkg.ExecuteIntegerQuery("SELECT `LastSequence` FROM `Media` ORDER BY `LastSequence`");
        lastIndex = sequences.Count - 1;
        int LastSequence = sequences.ElementAt(lastIndex) + numberOfFilesToAdd;

        query = "INSERT INTO `Media` (`DiskId`, `LastSequence`, `Cabinet`) VALUES (" + DiskId.ToString() + "," + LastSequence.ToString() + ",'#" + mediaCabinet + "')";
        Console.WriteLine(query);
        pkg.Execute(query);

        return DiskId;

    }

    /**
     * \brief embeds a cabinet file into an MSI into the "stream" table, and adds it as a new media in the media table
     *  This does not install the files on a clients computer, if he runs the installer,
     *  as none of the files in the cabinet, is defined in the MSI File Table (that informs msiexec where to place mentioned files.)
     *  It simply allows cabinet files to piggypack within a package, so that they may be extracted again at clients computer.
     *  
     * \param pathToCabFile full absolute path to the cabinet file
     * \param pathToMSIFile full absolute path to the msi file
     * \return media number of the new cabinet file wihtin the MSI
     */
    public int insertCabFileAsNewMediaInMSI(string cabFilePath, string pathToMSIFile, int numberOfFilesInCabinet = -1)
    {
        //open the MSI package for editing
        pkg = new InstallPackage(pathToMSIFile, DatabaseOpenMode.Direct); //have also tried direct, while database was corrupted when writing.
        return insertCabFileAsNewMediaInMSI(cabFilePath, numberOfFilesInCabinet);
    }

    /**
     * \brief overloaded method, that embeds a cabinet file into an MSI into the "stream" table, and adds it as a new media in the media table
     *  This does not install the files on a clients computer, if he runs the installer,
     *  as none of the files in the cabinet, is defined in the MSI File Table (that informs msiexec where to place mentioned files.)
     *  It simply allows cabinet files to piggypack within a package, so that they may be extracted again at clients computer.
     *
     * \param workdir absolute path to the cabinet files location
     * \param cabFile is the filename of the cabinet file
     * \param pathToMSIFile full absolute path to the msi file
     * \return media number of the new cabinet file wihtin the MSI
     */
    public int insertCabFileAsNewMediaInMSI(string workdir, string cabFile, string pathToMSIFile, int numberOfFilesInCabinet = -1)
    {
        string absPathToCabFile = Path.Combine(workdir, cabFile);
        string absPathToMSIFile = Path.Combine(workdir, pathToMSIFile);
        return insertCabFileAsNewMediaInMSI(absPathToCabFile, absPathToMSIFile, numberOfFilesInCabinet);
    }

    /**
     * \brief reconfigures the MSI, so that a file pointer is "replaced" by a file pointer to another cabinets version of said file...
     * The original file will not be removed from the MSI, but simply orphaned (no component refers to it). It will not be installed, but will remain in the package.
     * 
     * \param OriginalFileName (this is the files target name at the clients computer after installation. It is our only way to locate the file in the file table. If two or more files have the same target name, we cannot reorient the pointer to that file!)
     * \param FileNameInCabinet (In case you did not have the excact same filename for the new file, as the original file, you can specify the name of the file, as it is known in the cabinet, here.)
     * \param DiskIdOfCabinetFile - Very important information. This is the Id of the new cabinet file, it is the only way to know where the new source data is within the MSI cabinet stream. This function extracts the data it needs from there, like sequence numbers
     */
    public void PointAPreviouslyConfiguredComponentsFileToBeFetchedFromAnotherCabinet(string OriginalFileName, string FileNameInCabinet, string newFileSizeInBytes, int DiskIdOfCabinetFile)
    {
        //retrieve the range of sequence numbers for this cabinet file. 
        string query = "SELECT `DiskId` FROM `Media` ORDER BY `LastSequence`";
        Console.WriteLine(query);
        IList<int> medias = pkg.ExecuteIntegerQuery("SELECT `DiskId` FROM `Media` ORDER BY `LastSequence`");

        query = "SELECT `LastSequence` FROM `Media` ORDER BY `LastSequence`";
        Console.WriteLine(query); 
        IList<int> mediaLastSequences = pkg.ExecuteIntegerQuery("SELECT `LastSequence` FROM `Media` ORDER BY `LastSequence`");

        if(medias.Count != mediaLastSequences.Count)
        {
            throw new Exception("there is something wrong with the Media Table, There is a different number of DiskId and LastSequence rows");
        }

        if(medias.Count <= 0)
        {
            throw new Exception("there is something wrong with the Media Table, There are no rows with medias available..");
        }

        int FirstSequence = -1;
        int LastSequence = -1;
        int lastIndex = medias.Count - 1;

        for (int index = lastIndex; index >= 0; index--)
        {
            int rowLastSequence = mediaLastSequences.ElementAt(index);
            int rowDiskId = medias.ElementAt(index);

            if (rowDiskId == DiskIdOfCabinetFile)
            {
                LastSequence = rowLastSequence;
                if (index < lastIndex)
                {
                    //the next cabinet files last sequence number + 1,  is this ones first..
                    FirstSequence = mediaLastSequences.ElementAt(index + 1) + 1;
                    break;
                }
                else
                {
                    //all files from the first, to this last sequence number, are found in this cabinet
                    FirstSequence = mediaLastSequences.ElementAt(lastIndex);
                    break;
                }
            }
        }

        //now we will look in the file table to get a vacant sequence number in the new cabinet (if available - first run will return empty, and thus default to FirstSequence)
        int Sequence = FirstSequence;
        query = "SELECT `Sequence` FROM `File` WHERE `Sequence` >= " + FirstSequence.ToString() + " AND `Sequence` <= " + LastSequence.ToString() + " ORDER BY `Sequence`";
        Console.WriteLine(query);

        IList<int> SequencesInRange = pkg.ExecuteIntegerQuery(query);
        for (int index = 0; index < SequencesInRange.Count; index++)
        {
            if (FirstSequence + index != SequencesInRange.ElementAt(index))
            {
                Sequence = FirstSequence + index;
                break;
            }
        }

        //now we set this in the file table, to re-point this file to the new media..
        //File.FileName = FileNameInCabinet;
        //File.FileSize = newFileSizeInBytes;
        //File.Sequence = sequence;
        query = "UPDATE `File` SET `File`.`FileName`='" + FileNameInCabinet + "' WHERE `File`='" + OriginalFileName + "'";
        Console.WriteLine(query);
        pkg.Execute(query);
        query = "UPDATE `File` SET `File`.`FileSize`=" + newFileSizeInBytes + " WHERE `File`='" + OriginalFileName + "'";
        Console.WriteLine(query);
        pkg.Execute(query);
        query = "UPDATE `File` SET `File`.`Sequence`=" + Sequence.ToString() + " WHERE `File`='" + OriginalFileName + "'";
        Console.WriteLine(query);
        pkg.Execute(query);
    }        
}
} 
```

示范用法：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace MSIFileManipulator
{
class Program
{
    static void Main(string[] args)
    {
        string workdir = @"C:\Users\Me\MyDevFolder\tests";
        string msiFile = "replace_test_copy.msi";
        string fileName = "REPLACE_THIS_IMAGE.png";

        List<string> filesToInclude = new List<string>();
        System.IO.FileInfo fileInfo = new System.IO.FileInfo(System.IO.Path.Combine(workdir, fileName));
        if (fileInfo.Exists)
        {
            Console.WriteLine("now adding: " + fileName + " to cabinet");
            filesToInclude.Add(fileName);

            updateMSI myMSI = new updateMSI();
            string cabfileName = myMSI.createCabinetFileForMSI(workdir, filesToInclude);
            Console.WriteLine("cabinet file saved as: " + cabfileName);

            int diskID = myMSI.insertCabFileAsNewMediaInMSI(workdir, cabfileName, msiFile);
            Console.WriteLine("new media added with disk ID: " + diskID.ToString());
            myMSI.PointAPreviouslyConfiguredComponentsFileToBeFetchedFromAnotherCabinet(fileName, fileName, fileInfo.Length.ToString(), diskID);
            Console.WriteLine("Done");

        }
        else
        {
            Console.WriteLine("Could not locate the replacement file:" + fileName);
        }
        Console.WriteLine("press any key to exit");
        Console.ReadKey();
    }
}
} 
```

我知道我的测试在它自己之后没有清理..

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-24T22:03:51.197

最简单的方法是重新打包 MSI：

1.  在 Wise for Windows Installer 中打开 MSI 文件。选择一个选项以提取文件。
2.  在磁盘上找到文件并替换它。
3.  构建微星。

这些步骤也应该适用于 InstallShield。

# flash - 如何为 Flash 进行自动化 UI 测试

> ID：126573
> 
> 赞同：4
> 
> 时间：2008-09-24T11:23:38.727
> 
> 标签：flash, actionscript

我有一个我想为其编写自动化 UI 测试的 actionscript 2 应用程序。例如，我想模拟鼠标单击按钮并验证电影剪辑是否显示在正确的位置和正确的颜色...基本上，UI 测试。什么是可用的最佳工具或所需的方法是什么？在 JavaScript 中有一个 selenium 框架做得很好。有没有类似的flash工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T13:17:39.373

我知道这是一个老问题，但这可能对将来的参考有用。有一个比较新的项目

[ActionScript 的自动化 UI 测试器](https://sourceforge.net/adobe/genie/wiki/Home/)

它的安装非常简单，并在用户指南中逐步描述。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-04T13:07:00.533

使用 Adob​​e 精灵（ActionScript 的 UI 测试器） [http://sourceforge.net/adobe/genie/discussion/general/](http://sourceforge.net/adobe/genie/discussion/general/)

但我不认为 AS1 或 AS2 会起作用。它仅适用于 AS3。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-28T20:59:03.993

另一种方法是使用任何 HTML/JS 自动测试工具并为您的 Flash 应用程序提供 JS api - 至少，您始终可以公开诸如“通过 id 定位 smth”、“通过 id 单击 smth”、“在 smth 中输入一些文本”之类的功能通过 id' 或其他。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-01T14:17:47.010

试试[http://SauceLabs.com](http://SauceLabs.com) - 他们有一个 Flash 和 Flex 测试工具

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T11:34:17.717

这可能有用

[Flash UI 测试](http://osflash.org/autotestflash)

# sql-server-2005 - 在 SSRS 报告中显示 Tiff 文件

> ID：126584
> 
> 赞同：2
> 
> 时间：2008-09-24T11:28:44.017
> 
> 标签：sql-server-2005, reporting-services, tiff

我需要能够将扫描的 tiff 图像嵌入到一些 SSRS 报告中。

当我在 VS2005 中设计报告并添加图像控件时，tiff 图像显示完美，但是当我构建它时。我收到警告：

`Warning 2 [rsInvalidMIMEType] The value of the MIMEType property for the image ‘image1’ is “image/tiff”, which is not a valid MIMEType. c:\SSRSStuff\TestReport.rdl 0 0`

而不是图像，我得到了小红色 x。

有没有人克服这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T01:19:07.140

假设您通过 IIS 传递图像文件，请使用 ASP.NET 页面将图像格式和 mime 类型更改为您*可以*使用的内容。

```
Response.ContentType = "image/png";
Response.Clear();
using (Bitmap bmp = new Bitmap(tifFilepath))
  bmp.Save(Response.OutputStream, ImageFormat.Png);
Response.End(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-27T13:14:35.867

我一直在寻找有关如何在 SSRS 报告中显示 TIFF 图像的解决方案，但我找不到任何解决方案，而且由于 SSRS 不支持 TIFF，我认为将 TIFF 转换为支持的格式之一就可以了。它确实做到了。我不知道那里是否有类似的实现，但我只是发布，以便其他人也可以从中受益。请注意，这仅适用于您将 TIFF 图像保存在数据库中的情况。

```
Public Shared Function ToImage(ByVal imageBytes As Byte()) As Byte()
    Dim ms As System.IO.MemoryStream = New System.IO.MemoryStream(imageBytes)
    Dim os As System.IO.MemoryStream = New System.IO.MemoryStream()
    Dim img As System.Drawing.Image = System.Drawing.Image.FromStream(ms)

    img.Save(os, System.Drawing.Imaging.ImageFormat.Jpeg)

    Return os.ToArray()
End Function 
```

以下是代码的使用方法： 1\. 在 Report Properties 中，选择 Referenceeneces，单击 add 并浏览 System.Drawing，Version=2.0.0.0 2\. 选择 Code Property，复制粘贴上面的函数 3\. 单击 Ok 4\. Drop工具箱 4.1 中的图像控件。右键单击图像并选择图像属性 4.2。将图像源设置为数据库 4.3。在使用此字段中，单击表达式并粘贴下面的代码 =Code.ToImage(Fields!FormImage.Value)
4.4。将适当的 Mime 设置为 Jpeg

问候， 富尔伯特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T12:02:23.710

谢谢[彼得](https://stackoverflow.com/users/19931/peter-wone)，您的代码没有编译，但这个想法是合理的。

这是我的尝试，对我有用。

```
protected void Page_Load(object sender, EventArgs e)
{
    Response.ContentType = "image/jpeg";
    Response.Clear();        
    Bitmap bmp = new Bitmap(tifFileLocation);
    bmp.Save(Response.OutputStream, ImageFormat.Jpeg);
    Response.End();

} 
```

# sql-server - 如何仅使用 MDF 文件附加 MSSQL 2000 数据库

> ID：126587
> 
> 赞同：6
> 
> 时间：2008-09-24T11:29:24.903
> 
> 标签：sql-server, database, recovery

我有一台旧服务器，上面有一个已失效的 SQL 2000 评估版本（从 2006 年开始），还有两个数据库。

由于某些未知原因，LDF 日志文件丢失。估计删了。

我有用于该服务器上曾经存在的数据库的 mdf 文件（在一种情况下还有一个 ndf 文件），我正试图让它们在我坐的另一个 SQL 2000 机器上启动并运行。

`sp_attach_db`抱怨日志文件丢失，并且不会附加数据库。试图通过使用来自同名数据库的日志文件来欺骗它的尝试失败了。`sp_attach_single_file_db`也不会工作。mdf 文件显然没有被完全分离。

如何获得附加和可读的数据库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T11:38:28.067

我找到了这个答案，它适用于我的 SQL 2000 机器：

**如何使用非干净分离的 MDF 文件附加数据库。**

**步骤 1：**创建一个同名的新数据库，并在新服务器上使用与旧数据库相同的文件。

**第 2 步：**停止 SQL 服务器，并将您的 mdf 文件（以及您拥有的任何 ndf 文件）移动到您刚刚创建的新文件的顶部。删除任何日志文件。

**第 3 步：**启动 SQL 并运行它以将数据库置于紧急模式。

```
sp_configure 'allow updates', 1
go
reconfigure with override
GO
update sysdatabases set status = 32768 where name = 'TestDB'
go
sp_configure 'allow updates', 0
go
reconfigure with override
GO 
```

**第四步：**重启SQL Server，观察DB成功进入紧急模式。

**第 5 步：**运行此未记录的 dbcc 选项以重建日志文件（在正确的位置）

```
DBCC REBUILD_LOG(TestDB,'D:\SQL_Log\TestDB_Log.LDF') 
```

**第 6 步：**您可能需要重置状态。即使你不这样做，这样做也不会造成任何伤害。

```
exec sp_resetstatus TestDB 
```

**第 7 步：**停止并启动 SQL 以查看新恢复的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T11:39:09.560

在企业管理器中，右键单击服务器并选择附加数据库。选择 MDF 文件并单击确定。然后它会询问您是否要创建新的日志文件。说是。

# c# - 在客户端机器上安装字体

> ID：126594
> 
> 赞同：7
> 
> 时间：2008-09-24T11:30:33.513
> 
> 标签：c#, visual-studio-2008, installation, fonts

我正在使用 Visual Studio 2008 和 C# 客户端应用程序的内置安装工具。如何使用此安装程序在客户端计算机上安装字体（如果它不存在）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-24T11:41:26.513

在 VS2005（所以我也假设是 2008 年）中，右键单击目标机器上的文件系统，添加特殊文件夹 -> 字体文件夹，然后将字体文件放在那里。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-24T21:09:44.037

对我来说，蒂莫西·卡特的答案基本正确：

“右键单击目标机器上的文件系统，添加特殊文件夹 -> 字体文件夹，然后将字体文件放在那里。”

但这还不够。字体实际上并没有作为系统字体安装。

要安装字体，我必须访问每个字体文件的属性并将 Register=vsdrfDoNoRegister 更改为 Register=vsdrfFont。之后我生成的安装文件也会安装字体！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T11:32:44.320

看看这篇文章。

[http://www.atakala.com/Browser/Item.aspx?user_id=amos&dict_id=83](http://www.atakala.com/Browser/Item.aspx?user_id=amos&dict_id=83)

最重要的调用是**AddFontResource** Win32 API 调用，尽管必须遵守所描述的操作顺序，以便您在系统中设置有效的字体。

[http://msdn.microsoft.com/en-us/library/ms534231(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms534231(VS.85).aspx)

> AddFontResource 函数将指定文件中的字体资源添加到系统字体表中。该字体随后可用于任何应用程序的文本输出。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-11-28T15:58:10.103

我正在使用 InnoSetup 来交付我的 VS 应用程序。它允许您将字体从系统安装到客户端系统。

我从未在 Windows 7 或 Vista 中进行过测试（可能您会遇到一些权限问题）。

请记住，并非所有字体都可以自由分发。

# web-services - 从顶级网络邮件服务导入联系人

> ID：126599
> 
> 赞同：3
> 
> 时间：2008-09-24T11:32:02.247
> 
> 标签：web-services, import-contacts

是否有人熟悉可以从 Gmail、Yahoo 邮件、AOL、Hotmail 和其他著名的网络邮件服务导入联系人的服务或开源脚本？（不是plaxo，IE7有问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T16:56:23.667

If it's just a one off operation. Linkedn can, but I'm not sure if you could do anything useful afterwards with the list.

# windows-xp - 未连接到网络时访问 Windows 管理员共享

> ID：126601
> 
> 赞同：0
> 
> 时间：2008-09-24T11:32:17.283
> 
> 标签：windows-xp

我发现当没有网络连接时，我无法访问 XP64 机器上的管理员共享。尝试浏览`\\localhost\c$`失败（尽管显然浏览`c:`有效）。

问题的原因是我们的应用程序的 NANT 构建脚本使用这种格式将文件从一个本地目录复制到另一个目录，当我尝试在火车上使用我的笔记本电脑时它失败了（如果我拔下电源也会出现同样的问题从我的桌面和构建的网络电缆）。整个构建只使用本地资源，因此应该可以在没有网络连接的情况下使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T11:34:33.877

您可以安装一个环回适配器来欺骗计算机，使其认为它在网络上。[http://support.microsoft.com/kb/839013](http://support.microsoft.com/kb/839013)

# process - 什么是“喷泉开发模式”？

> ID：126607
> 
> 赞同：5
> 
> 时间：2008-09-24T11:33:36.563
> 
> 标签：process, sdlc

它[在 Wikipedia 的系统开发生命周期页面上](http://en.wikipedia.org/wiki/Systems_Development_Life_Cycle)被提及：

> 为了管理这一点，已经创建了许多系统开发生命周期 (SDLC) 模型：瀑布模型、喷泉模型、螺旋模型、构建和修复模型、快速原型制作、增量模型以及同步和稳定模型。

我在谷歌上找到了一些东西，但我觉得它们很模糊，他们只是没有点击我。也许这里有人的解释可能更清楚。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-02-25T14:13:25.123

**喷泉**：站成一圈，向空中扔一些图案和关键词，看看它们落在哪里。只捡起落在圆圈内的那些。重复直到取消。

**瀑布**：把每个人都拉上船，然后大喊“杰罗尼莫！” 在穿越尼亚加拉瀑布时。拿起破碎的碎片，然后冲洗并重复。确保详细记录每个人应该坐在船的哪个部分，他们应该抓住什么，大喊大叫，以及他们应该降落的确切位置。有关其他说明，请参阅表格 3684-B。

**螺旋式**：选择一名团队成员，让其他人将他们转成圆圈，直到头晕目眩。

**构建和修复**：只需将它靠在墙上，看看有什么粘着。如果有东西脱落，请添加一些胶带。用过的口香糖也可以。任何不会卡住的部分，扔掉。

**快速原型**设计：完全按照客户的要求去做。重复直到他们弄清楚他们想要什么。

**增量**：仅构建您想要的部分，并且仅在您想要做的时候。另一种版本是只构建他们尖叫声最大的部分，并且只有当他们实际上站在你的办公桌前等待它时。

**同步和稳定**：像螺旋一样，除了一次只有一个人旋转倒霉的团队成员。轮到他们时，停止旋转片刻。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T11:47:31.773

瀑布是一种强制控制并避免并行的模型；在开始任务之前，必须满足任务的每个要求。Fountain 说，在满足所有要求之前，可以开始一项新任务，因为并非所有要求在任务开始时都是必需的。

想想这个：超级马里奥游戏，

瀑布：首先，设计一切，然后完成硬件（硬件团队），然后创建一些测试精灵，然后编码引擎，然后创建艺术品，然后是音乐并完成。

源泉：在硬件团队完成工作的同时，艺术作品开始概念性工作，编码开始对现有硬件进行一些原型设计。当艺术家和硬件完成后，编码人员将这些整合到他们的代码中并继续直到完成游戏......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T11:50:05.043

据我了解，它们基本上包含相同的步骤，但喷泉方法更具迭代性，较少关注初始设计，而更多地关注分析。

你基本上是通过事情来解决的。看看需要发生什么，然后改进它。看看需要发生什么。改进它。

它更敏捷，但以项目稳定性为代价。瀑布对于大型项目来说要好得多。

# .net - .NET windows 应用程序可以压缩成单个 .exe 吗？

> ID：126611
> 
> 赞同：33
> 
> 时间：2008-09-24T11:34:02.960
> 
> 标签：.net, windows

我对 .NET 桌面应用程序（使用[Visual Studio 2005](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2005)）不太熟悉。是否可以让整个应用程序从单个 .exe 文件运行？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-24T11:35:11.723

是的，您可以使用[ILMerge](https://github.com/dotnet/ILMerge)工具。它也可用作[NuGet 包](https://www.nuget.org/packages/ilmerge)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-09-14T01:39:37.487

今天，在 2015 年，您可以为此使用[Costura.Fody](https://github.com/Fody/Costura)。使用它相当于将 NuGet 包添加到您的项目并重新编译。我不确定它是否适用于问题中的 Visual Studio 2005，但也不是 2008 年。我已经在我的一些项目中使用过它并且效果很好。

[Fody](https://github.com/Fody/Fody)是一个免费和开源的通用[Code Weaver 。](https://en.wikipedia.org/wiki/Aspect-oriented_programming)它允许对已编译的 .NET 代码进行后处理以增强其功能的基本思想。例如，可以将日志记录添加到每个方法调用等。在我们的例子中，它将依赖的 DLL 文件打包到程序集资源中，以便它们可以在程序运行时加载，就好像它们是独立的依赖项一样。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-24T12:27:02.863

**是的。在 .NET 中，您可以将整个应用程序封装为单个 EXE 文件。** 只需确保您的解决方案中只有一个 Windows 应用程序项目（除了设置之外没有其他项目）。

由您的 .NET 项目创建的 EXE 文件不会是独立的可执行文件，但**它所拥有的唯一依赖项将是 .NET 运行时**（除非您添加对其他 DLL 程序集的引用）。如果您使用 .NET 2.0（我推荐），运行时会预装在较新的 PC 上，并且在较旧的机器上设置起来非常简单快捷（安装程序大约 23 MB）。

如果您的应用确实需要引用其他程序集（如数据访问 DLL 或 .NET 类库 DLL 项目），您可以使用此处其他海报引用的工具之一将您的 EXE 和所有引用的 DLL 合并到一个 EXE 文件中. 然而，**传统的做法是简单地将 EXE 文件与任何依赖的 DLL 一起部署为单独的文件**。在 .NET 中，相关 DLL 的部署非常简单：只需将它们与客户端计算机上的 EXE 文件放在同一个文件夹中，就完成了。

**将您的应用程序（无论是一个文件还是多个文件）部署为单文件安装程序**（setup.EXE 或 setup.MSI）是一种很好的做法。.NET 附带部署项目模板，可以相当轻松地为您创建安装程序。

稍微偏离主题：您可以使用 NGEN 将 .NET 应用程序编译为本机 EXE，但它仍然依赖于 .NET 运行时。本机编译的优点是有些东西可以预编译，但我从未见过这样的微小性能提升值得费心的情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T11:35:14.797

[有一个名为.NET Reactor](http://www.eziriz.com/)的第三方工具可以为您执行此操作。我没有使用过这个工具，所以不确定它的效果如何。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-24T11:55:38.257

我使用[.NETZ](http://madebits.com/netz/) .NET 开源可执行打包程序将 EXE 和 DLL 文件打包成单个 EXE 文件。下面是一个命令行示例，说明如何将 DLL 文件打包到一个文件中：

```
netz -s application.exe foo.dll bar.dll 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-04-09T18:24:59.137

现在是 2021 年，对此的支持得到了突飞猛进的改善。

如果您已经跳转到 .NET 5（它支持 Windows 窗体！），您可以制作一个甚至嵌入本机二进制文件的单个文件 exe。您必须从命令行运行发布命令，但它会生成一个带有任何配置或内容文件的单个 exe。dotnet sdk 不需要存在于目标机器上。

```
dotnet.exe publish YourProject.csproj -f net5.0 -o package/win-x64 -c Release -r win-x64 /p:PublishTrimmed=true /p:TrimMode=Link /p:PublishSingleFile=true /p:IncludeNativeLibrariesForSelfExtract=true 
```

几点注意事项：

*   `PublishTrimmed`可以设置为`false`在大量反射使用的情况下消除代码删除。
*   `TrimMode`可以设置为`copyused`或`link`。更多详细信息：[https](https://docs.microsoft.com/en-us/dotnet/core/deploying/trim-self-contained) ://docs.microsoft.com/en-us/dotnet/core/deploying/trim-self-contained 。
*   `-f`参数指定框架版本，即net5.0等。
*   参数是配置，`-c`通常是`Release`.
*   参数是要构建的`-r`运行时，可以是`win-x86`，`win-x64`和`linux-x64`。ARM 也可能有一些选项。
*   `-o`参数是输出文件夹。

完整参考：[https ://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-publish](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-publish)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-11-17T00:25:43.777

[Jeffrey Richter在他的](http://www.wintellect.com/cs/blogs/jeffreyr/)[书中摘录](http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx)中写道，可以注册一个带有[应用程序域的](http://en.wikipedia.org/wiki/Application_Domain)ResolveAssembly 事件的回调方法，以使[CLR](http://en.wikipedia.org/wiki/Common_Language_Runtime)在程序初始化期间能够找到第三方程序集和 DLL 文件：

```
AppDomain.CurrentDomain.AssemblyResolve += (sender, 
  args) => {
    String resourceName = "AssemblyLoadingAndReflection." +
    new AssemblyName(args.Name).Name + ".dll";
    using (var stream =       
      Assembly.GetExecutingAssembly().GetManifestResourceStream(resourceName)){
        Byte[] assemblyData = new Byte[stream.Length];
        stream.Read(assemblyData, 0, assemblyData.Length);
        return Assembly.Load(assemblyData);
      }
   }; 
```

*免责声明*：我自己没有使用过这个。据我了解，客户端仍然需要安装 .NET 框架。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T11:48:12.660

如前所述，您可以使用[ILMerge](http://research.microsoft.com/~mbarnett/ILMerge.aspx)。

[但是，如果您使用免费的 Phoenix 保护器](http://www.ntcore.com/phoenix.php)，它可能会更容易，它也可以保护您的代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-01-26T20:34:30.363

您可以尝试[NBox](https://github.com/elw00d/nbox)实用程序。

⎎

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-07-03T09:59:03.513

我自己正在使用[.netshrink](http://www.pelock.com/products/netshrink)，它完全符合您的需要。它将主程序集和额外程序集（DLL 文件）打包到一个可执行映像中。

我已经使用它一年了，而且我不会回到 ILMerge（它总是在某个时候崩溃......）。

![.netshrink 来自产品页面的主窗口](https://i.stack.imgur.com/FcQfa.png)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-15T11:46:08.647

[如果程序集只有托管代码， ILMerge](http://www.microsoft.com/en-us/download/details.aspx?id=17630)可以将程序集组合成一个程序集。您可以使用命令行应用程序，或添加对 EXE 文件的引用并以编程方式合并。对于 GUI 版本，有[Eazfuscator](http://www.foss.kharkov.ua/g1/projects/eazfuscator/dotnet/Default.aspx#downloads)和[.Netz](http://madebits.com/netz/)，两者都是免费的。付费应用程序包括[BoxedApp](http://boxedapp.com/)和[SmartAssembly](http://www.red-gate.com/products/dotnet-development/smartassembly/)。

如果您必须将程序集与非托管代码合并，我建议您使用[SmartAssembly](http://www.red-gate.com/products/dotnet-development/smartassembly/)。我从来没有遇到过[SmartAssembly](http://www.red-gate.com/products/dotnet-development/smartassembly/)的问题，但其他所有问题都是如此。在这里，它可以将所需的依赖项作为资源嵌入到您的主 EXE 文件中。

您可以手动完成所有这些操作，无需担心程序集是托管还是混合模式，方法是将 DLL 文件嵌入您的资源中，然后依赖 AppDomain 的 Assembly `ResolveHandler`。这是采用最坏情况的一站式解决方案，即使用非托管代码的程序集。

```
class Program
{
    [STAThread]
    static void Main()
    {
        AppDomain.CurrentDomain.AssemblyResolve += (sender, args) =>
        {
            string assemblyName = new AssemblyName(args.Name).Name;
            if (assemblyName.EndsWith(".resources"))
                return null;

            string dllName = assemblyName + ".dll";
            string dllFullPath = Path.Combine(GetMyApplicationSpecificPath(), dllName);

            using (Stream s = Assembly.GetEntryAssembly().GetManifestResourceStream(typeof(Program).Namespace + ".Resources." + dllName))
            {
                byte[] data = new byte[stream.Length];
                s.Read(data, 0, data.Length);

                // Or just byte[] data = new BinaryReader(s).ReadBytes((int)s.Length);

                File.WriteAllBytes(dllFullPath, data);
            }

            return Assembly.LoadFrom(dllFullPath);
        };
    }
} 
```

`Program`类名在哪里。这里的关键是将字节写入文件并从其位置加载。为了避免先有鸡还是先有蛋的问题，您必须确保在访问程序集之前声明处理程序，并且您不会在加载（程序集解析）中访问程序集成员（或实例化任何必须处理程序集的东西）部分。还要注意确保`GetMyApplicationSpecificPath()`不是任何临时目录，因为临时文件可能会被其他程序或您自己尝试删除（不是在您的程序访问 DLL 文件时它会被删除，但至少这是一个麻烦。AppData 是一个很好的位置）。另请注意，您必须每次都写入字节；您不能仅仅因为 DLL 文件已经驻留在该位置而从该位置加载。

对于托管的 DLL 文件，您不需要写入字节，而是直接从 DLL 文件的位置加载，或者只读取字节并从内存中加载程序集。像这样左右：

```
using (Stream s = Assembly.GetEntryAssembly().GetManifestResourceStream(typeof(Program).Namespace + ".Resources." + dllName))
{
    byte[] data = new byte[stream.Length];
    s.Read(data, 0, data.Length);
    return Assembly.Load(data);
}

// Or just

return Assembly.LoadFrom(dllFullPath); // If location is known. 
```

如果程序集完全不受管理，您可以查看[此链接](https://stackoverflow.com/questions/666799/embedding-unmanaged-dll-into-a-managed-c-sharp-dll)或[此](http://bsmadhu.wordpress.com/2012/03/19/embedding-c-libraryexe-inside-net-assembly/)链接以了解如何加载此类 DLL 文件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-29T08:35:40.713

是的，您可以将 dotnet windows 应用程序压缩为单个 .exe 文件。

只是你必须遵循以下过程：

1.  右键单击您的项目转到管理 NuGet 包。
2.  安装 Costura.Fody
3.  清理 bin 文件夹内的 Debug 文件夹（删除所有文件和文件夹）。
4.  运行项目。
5.  转到调试文件夹，然后转到 app.publish 文件夹，您将在此处获得一个 exe 文件。

# java - 将 JS 函数传递给小程序作为事件侦听器

> ID：126631
> 
> 赞同：4
> 
> 时间：2008-09-24T11:38:17.160
> 
> 标签：java, javascript, events, applet

是否可以将函数/回调从 javascript 传递到 java 小程序？

例如，我有一个带有按钮的小程序，当按下它时它将调用传递的 js 回调

```
function onCommand() {
  alert('Button pressed from applet');
}
applet.onCommand(onCommand); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T11:57:11.733

[我倾向于使用从本页](http://www.rgagnon.com/javadetails/java-0172.html)底部的反射示例中派生的东西，因为这样您就不需要干预您的类路径来编译它

然后我只是在小程序和 javascript 之间传递 JSON 字符串

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T11:42:08.773

您可以使用[JSObject](http://java.sun.com/j2se/1.5.0/docs/guide/plugin/developer_guide/java_js.html)从 Java 回调到 javascript。

从该页面：

```
import netscape.javascript.*;
import java.applet.*;
import java.awt.*;
class MyApplet extends Applet {
     public void init() {
         JSObject win = JSObject.getWindow(this);
         JSObject doc = (JSObject) win.getMember("document");
         JSObject loc = (JSObject) doc.getMember("location");

         String s = (String) loc.getMember("href");  // document.location.href
         win.call("f", null);                      // Call f() in HTML page
     }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T12:25:58.403

附言。要使用 JSObject，您可能需要将“MAYSCRIPT”标记包含到 applet html 标记中。

# .net - .Net Menustrip 背景颜色范围

> ID：126635
> 
> 赞同：0
> 
> 时间：2008-09-24T11:38:40.030
> 
> 标签：.net, user-interface, controls

我需要在 MenuStrip 的右侧放置一个控件。MenuStrip 的颜色从左侧的 BackColor 逐渐变为右侧的白色，理想情况下，我希望通过与菜单条在该侧具有相同的 backColor 来使我的小控件融入其中。有谁知道这种颜色是如何计算的？

最坏的情况，你能推荐一个用于从屏幕上采样颜色的小应用程序吗？

[更新] 如果菜单条可以调整大小，采样不是有用的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T11:46:06.470

工具条渲染器在传递给[ToolStripProfessionalRenderer](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripprofessionalrenderer.aspx)构造函数的[ProfessionalColorTable](http://msdn.microsoft.com/en-us/library/system.windows.forms.professionalcolortable.aspx)中定义的两种颜色之间绘制渐变。它使用[MenuStripGradientBegin](http://msdn.microsoft.com/en-us/library/system.windows.forms.professionalcolortable.menustripgradientbegin.aspx)和[MenuStripGradientEnd](http://msdn.microsoft.com/en-us/library/system.windows.forms.professionalcolortable.menustripgradientend.aspx)值。

因此，您需要恢复这两个值，然后将背景适当地绘制为线性渐变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T11:43:53.497

我使用 Paint.Net 对颜色进行采样：制作整个屏幕或窗口的屏幕转储，然后使用 Paint.Net 对颜色进行采样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T11:47:00.807

ToolStrip 的背景（即MenuStrip、StatusStrip 等...）不是硬编码的。查找“ToolStripRender”类和派生类“ToolStripSystemRenderer”和“ToolStripProfessionalRender”。他们有几种方法来绘制 ToolStrip 的一部分。

# oracle - 甲骨文数据差异

> ID：126652
> 
> 赞同：0
> 
> 时间：2008-09-24T11:42:42.407
> 
> 标签：oracle

(Oracle) 我必须返回过去 12 个月的所有记录。如何在 PL/SQL 中做到这一点？

编辑：对不起，我忘了解释，我确实有一列数据类型

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T12:14:05.953

在 PL/SQL 中执行此操作与在 SQL 中执行此操作几乎是同义词。

```
SELECT *
FROM   table
WHERE  date_column >= ADD_MONTHS(TRUNC(SYSDATE),-12) 
```

您可能想摆弄 TRUNC 语句以获得您想要的范围 - 我使用了与 TRUNC(SYSDATE,'D') 相同的 TRUNC(SYSDATE) - 即。删除 sysdate 的时间部分。例如，如果当前是 8 月 12 日，但您想要 2 月 1 日而不是 2 月 12 日的值，则使用：

```
SELECT *
FROM   table
WHERE  date_column >= ADD_MONTHS(TRUNC(SYSDATE,'MM'),-12) 
```

另外，请参阅文档以处理具有不同天数的月份：http: [//download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions004.htm#SQLRF00603](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions004.htm#SQLRF00603)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T12:00:28.573

```
SELECT *
FROM   table
WHERE  date_column > ADD_MONTHS(SYSDATE, -12) 
```

不确定我是否应该对早期的帖子进行降级...只是想提供帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-24T11:52:52.507

```
SELECT *
FROM   table
WHERE  date_column > SYSDATE - 365 
```

# lisp - 你对 Lisp 的最大误解是什么？

> ID：126653
> 
> 赞同：11
> 
> 时间：2008-09-24T11:42:53.843
> 
> 标签：lisp, scheme, common-lisp

**请一一**回复。

如果您解释为什么它不正确，请尽量避免一般性陈述并提供特定示例。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-24T21:16:13.200

所有的括号都使代码不可读。大约两周后，使用一个不错的文本编辑器，你就不再注意到它们了。

[ETA - 刚刚找到了长期 lisper 肯尼·蒂尔顿的一句话：“括号？什么括号？自从我开始 Lisp 编程的第一个月以来，我没有注意到任何括号。我想问那些抱怨 Lisp 中括号的人，如果他们是被报纸上所有单词之间的空格所困扰......"]

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-24T12:19:19.667

我最喜欢的误解：它是一种“函数式语言”，不鼓励迭代或 OOP 或任何你能说出的编程风格。

没有什么比真相更遥远。

首先，根据说话者的意思，“Lisp”根本不是一种语言，而是一个语系。这个家族有几个或多或少知名且广为人知的成员：[Scheme](http://www.readscheme.org/)、[Common Lisp](http://www.cliki.net/index)、[Emacs-Lisp](http://www.gnu.org/software/emacs/)和[AutoLisp](http://en.wikipedia.org/wiki/AutoLISP)是传统的；如今，还有[Nu](http://programming.nu/)、[newLISP](http://www.newlisp.org/)（实际上更像是“oldLISP”而不是现代的，但无论如何）、[Arc](http://www.paulgraham.com/arc.html)和[Clojure](http://clojure.org/)。

诚然，Schemers 似乎更喜欢函数式风格并且不鼓励迭代而支持递归。然而，据我所知，Schemers 实际上在 Lisp 世界中是少数，至少在考虑将 Lisp 作为编程工具而不是研究或研究对象的实际用途时。

我对 AutoLisp 或除了 Scheme 和 Common Lisp 之外的所有其他 Lisp 方言知之甚少，但我所知道的是，Common Lisp 绝对不是一种避免命令式甚至面向对象编程的单一范式语言。事实上，Common Lisp 具有我所知道的最强大的基于类的对象系统，它结合了开箱即用的面向方面编程之类的东西。

在我看来，Lisp 实际上是最鼓励在新方向上进行实验的语言家族，并且最容易整合从一开始就不受支持的编程范式。这包括命令式编程。Common Lisp 甚至有 GOTO！

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-24T12:10:56.223

Lisp 是一种解释型语言，因此它真的很慢。

查看 Common Lisp Hyper Spec 中的函数[disassemble](http://clhs.lisp.se/Body/f_disass.htm)。

一个名为[SBCL](http://www.sbcl.org/platform-table.html)的 Common Lisp 实现带有适用于许多平台的高效本机编译器后端。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-24T12:09:28.117

那是为了人工智能

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-09-25T11:04:50.790

许多人认为 lisp 是一种**面向列表的语言**（不管这意味着什么）。

即使在 lisper 中，人们也普遍认为，关于 lisp 的一个伟大和最重要的事情是 cons 单元和可以使用它们构建的单链表（sexp's）。相信 lisp 的人不理解使 lisp 成为比其他主流语言更高效的语言的真正原因（这只是我的主观意见！），并且不理解 lisp 几乎可以是它的样子，如果没有游戏中的缺点细胞。

随机选择一些对 lisp 很重要的东西，并且在**没有 sexp 的情况下很容易做到**：

*   [REPL](http://en.wikipedia.org/wiki/REPL)
*   运行时可用的编译器
*   [动态类型](http://en.wikipedia.org/wiki/Dynamic_typing#Dynamic_typing)
*   句法抽象（宏）
*   [关闭](http://en.wikipedia.org/wiki/Closure_(computer_science))
*   易于编辑的简单语法（并由大脑“解析”）

一些解释：

简而言之，动态类型意味着**不是位置有类型，而是运行时值**。如果您事先不了解所有需求，并且您的应用程序随着项目的发展而不断变化，这将是一个重要的帮助。根据我的经验，到目前为止，大多数情况都是如此——只有当静态类型出现在图片中时，才会遇到更多的障碍。

可能很多人会争辩说，cons 单元和 sexp 对灵活的宏观系统至关重要。关键是一个简单的语法和一个易于操作的数据结构，它被解析成。sexp 语法和列表一起是一个很好的候选，但还有很多其他的。

我对括号很满意，但我对另一部分不满意，即使用 cons'd 列表来表示程序代码，因为它有一个重要的缺陷：你不能在不干扰数据的情况下用随机的东西注释它那已经用它来表示了。例如，我不能用它在两天前由 Joe 编辑的事实来注释这样一个表示程序代码的 cons'd 列表，而不会将这种形式变成 lisp 编译器的废话。随着您的 DSL 变得越来越复杂，并且随着您的宏变成将您的 DSL 编译为 lisp 的小型编译器，这些注释变得越来越重要。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-09-24T21:04:32.667

我不知道有一个最喜欢的误解......但是我经常看到程序员谈论“LISP”以及他们为什么不喜欢它/它不合适/它是学术性的/它永远不会适用于项目 X。会很好，除了当他们说“LISP”时，他们的意思是“Scheme”，他们真正的意思是“Scheme 的一个子集”，他们真正的意思是“5 年前那个 AI 或语言课程中记住一半的 Scheme 子集，他们不喜欢”。

从这个方向来看，对 Lisp(s) 似乎有相当多的非理性偏见。理性的偏见完全是另外一回事。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-24T12:25:28.623

我最喜欢的 lisp 误解：CL 真的意味着 CthuLhu！

笑话不谈；到目前为止，关于各种 lisp 方言的最普遍的误解是，s 表达式语法依赖于括号会*损害*可读性，而实际上正是这种特性*有助于*使 lisp 代码比大多数其他编程语言。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-24T12:19:14.300

我没有“最喜欢的”误解，因为大多数误解，不仅是关于 Lisp，只是令人烦恼。但是当我阅读 Lisp 的历史（特别是 Lisp 的历史和 Lisp 的演变）时，我对 Lisp 有一个误解，这让我[非常](http://www-formal.stanford.edu/jmc/history/lisp/lisp.html)[震惊](http://www.dreamsongs.com/Files/HOPL2-Uncut.pdf)。

众所周知，Lisp 是一种慢速解释语言，但实际上*它在拥有第一个工作解释器后不到一年就拥有了一个编译器*，我认为，下面的历史是一长串针对优化的工作，导致*一些 Lisp 实现在数量上击败了 Fortran*！

神话的最可能来源是，许多人只是从有关 Scheme 的 CS 课程中了解 Lisp，他们在那里为自己编写了一个解释器。可能他们中的许多人讨厌这门课程，因为它教给他们关于可计算性或递归的美丽但复杂的概念，然后他们将课程的问题与 Lisp 的问题同化。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-25T08:08:55.003

Lisp 中的一切都是一个列表，没有其他高效的复杂数据结构。

不对。在 Common Lisp 中有类、结构、哈希表、多维数组、可变字符串等。每一个都被有效地实现。例如，SBCL 编译器为数组访问发出优化的内联本机代码。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-24T12:08:49.333

“宇宙是用 Lisp 写的”。但[显然不是](http://xkcd.com/224/)。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-24T13:57:28.357

Lisp 没有 IDE，所以你必须使用记事本，不断地计算所有多余的括号。

事实上，有不少。对于 Common Lisp，最好在 windows 和 linux 下都使用 Emacs 和[SLIME 。](http://common-lisp.net/project/slime/)它提供了一个 Listener（用于评估）、一个 Inspector（用于查看结果）、一个 Debugger（带步进）、一个高度可定制的 Editor（这毕竟是 Emacs）。SLIME 支持 10 种不同的实现。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-27T15:19:35.633

That it is a programming language. Today Lisp is a family of programming languages including [Common Lisp](http://en.wikipedia.org/wiki/Common_Lisp) and [Scheme](http://en.wikipedia.org/wiki/Scheme_programming_language), which are standards with various implementations each, and also [Clojure](http://clojure.org), [Arc](http://www.paulgraham.com/arc.html) and [many others](http://en.wikipedia.org/wiki/Lisp_programming_language).

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-24T12:50:51.667

Lisp 不能提供独立的可执行文件。

[使用 SBCL，您可以通过简单的函数](http://www.sbcl.org/manual/Saving-a-Core-Image.html)调用将 lisp VM 的当前状态保存到单个可执行文件中。当您启动此可执行文件时，它将从原始状态开始并调用您在保存时提供的函数或 lambda。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-31T03:35:51.533

“CLOS”是一种编程语言，*而*Lisp 是一种解释性的、仅功能的语言。真的，我是从 CS 教授那里听说的。而且我认为在这些编程语言概念书中有一些误导性的图表表明了这一点。

当今大学和大学的 CS 教师（尤其是年轻教师）接受过 Java、C 和 C++ 的教育，他们可能在一门名为“编程语言的比较研究”或“编程范式”的课程中学习了 Scheme 或 Common Lisp，这是可能是由不喜欢任何 Lisp 语言的人教的，教他们函数、列表、符号和高阶函数。时期。然后他们最终教他们学到的东西：

*   Lisp 是*一种*编程语言
*   Lisp 被解释
*   Lisp 很慢
*   Lisp 是一种人工智能语言（我上次查看 Robert Sebesta 的书时，它仍然声称——但有一个新版本，所以他可能已经修复了这个问题）
*   Lisp 不支持 OO (!!!)
*   Lisp 是一种函数式语言（与最低限度地支持任何其他范式相反）
*   在 Lisp 中没有数据类型
*   Lisp 除了列表之外没有数据结构（因此对数字运算没有用处）
*   “不再使用 Lisp，仅在本课程中使用，因为它是最重要的函数式语言”

我什至看到一位非常聪明的教授在 Common Lisp 中给出了一个矩阵乘法的例子——当然，将矩阵表示为列表！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-09T01:52:18.253

因为人们使用 Lisp 解决难题，所以语言本身一定很困难。

[递归很难](http://steve.yegge.googlepages.com/ten-great-books)。[函数的定点很难](http://www.joelonsoftware.com/articles/ThePerilsofJavaSchools.html)。但是它们几乎没有涵盖[计算机程序的结构和解释的](http://mitpress.mit.edu/sicp/full-text/book/book.html)第 1 章。这并不是因为 Scheme 很难——实际上是因为它很简单，剩下的就是困难的事情！

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2008-09-24T12:10:35.647

人们将括号归咎于lisp。我想让他们说如果没有它们，他们将如何实现面向列表数组的语言......

* * *

## 回答 #17

> 赞同：-5
> 
> 时间：2008-09-24T12:07:52.520

任何足够先进的应用都无法与线路噪声区分开来。

# java - Alias 方法的开源实现

> ID：126656
> 
> 赞同：0
> 
> 时间：2008-09-24T11:45:01.513
> 
> 标签：java, statistics, random, probability

我现在正在做一个项目，为了代码重用，我去寻找一个可以对项目执行一些概率接受/拒绝的库：

即有三个人（a，bc），每个人都有一个概率P{i}得到一个物品，其中p{a}表示a的概率。这些概率是在运行时计算的，不能硬编码。

我想要做的是生成一个随机数（对于一个项目），并根据他们获得该项目的概率来计算谁获得了该项目。此处概述的别名方法（[http://books.google.com/books?pg=PA133&dq=alias+method+walker&ei=D4ORR8ncFYuWtgOslpVE&sig=TjETHBUa4odbGJmjyF4daF1AKF4&id=ERSSDBDcYOIC&output=html](http://books.google.com/books?pg=PA133&dq=alias+method+walker&ei=D4ORR8ncFYuWtgOslpVE&sig=TjEThBUa4odbGJmjyF4daF1AKF4&id=ERSSDBDcYOIC&output=html)）解释了如何，但我想看看是否有现成的实现，所以我不必写出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T13:30:47.657

这样的事情会做吗？将所有 p{i} 放入数组中，函数将向获取该项目的人返回一个索引。在 O(n) 中执行。

```
public int selectPerson(float[] probabilies, Random r) {
    float t = r.nextFloat();
    float p = 0.0f;

    for (int i = 0; i < probabilies.length; i++) {
        p += probabilies[i];
        if (t < p) {
            return i;
        }
    }

    // We should not end up here if probabilities are normalized properly (sum up to one)
    return probabilies.length - 1;      
} 
```

编辑：我还没有真正测试过这个。我的观点是您描述的功能不是很复杂（如果我理解您的意思正确的话），您不需要下载库来解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T07:19:44.210

这是一个 Ruby 实现：[https ://github.com/cantino/walker_method](https://github.com/cantino/walker_method)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-25T13:10:42.407

我刚刚测试了上面的方法 - 它并不完美，但我想就我的目的而言，它应该足够了。（常规代码，粘贴到单元测试中......）

```
 void test() {
        for (int i = 0; i < 10; i++) {
            once()
        }
    }
    private def once() {
        def double[] probs = [1 / 11, 2 / 11, 3 / 11, 1 / 11, 2 / 11, 2 / 11]
        def int[] whoCounts = new int[probs.length]
        def Random r = new Random()
        def int who
        int TIMES = 1000000
        for (int i = 0; i < TIMES; i++) {
            who = selectPerson(probs, r.nextDouble())
            whoCounts[who]++
        }
        for (int j = 0; j < probs.length; j++) {
            System.out.printf(" %10f ", (probs[j] - (whoCounts[j] / TIMES)))
        }
        println ""
    }
    public int selectPerson(double[] probabilies, double r) {
        double t = r
        double p = 0.0f;
        for (int i = 0; i < probabilies.length; i++) {
            p += probabilies[i];
            if (t < p) {
                return i;
            }
        }
        return probabilies.length - 1;
    }

outputs: the difference betweenn the probability, and the actual count/total 
obtained over ten 1,000,000 runs:
  -0.000009    0.000027    0.000149   -0.000125    0.000371   -0.000414 
  -0.000212   -0.000346   -0.000396    0.000013    0.000808    0.000132 
   0.000326    0.000231   -0.000113    0.000040   -0.000071   -0.000414 
   0.000236    0.000390   -0.000733   -0.000368    0.000086    0.000388 
  -0.000202   -0.000473   -0.000250    0.000101   -0.000140    0.000963 
   0.000076    0.000487   -0.000106   -0.000044    0.000095   -0.000509 
   0.000295    0.000117   -0.000545   -0.000112   -0.000062    0.000306 
  -0.000584    0.000651    0.000191    0.000280   -0.000358   -0.000181 
  -0.000334   -0.000043    0.000484   -0.000156    0.000420   -0.000372 
```

# algorithm - 什么是几何算法的好来源？

> ID：126658
> 
> 赞同：24
> 
> 时间：2008-09-24T11:45:20.593
> 
> 标签：algorithm, geometry, computational-geometry

我正在寻找几何算法的任何好的资源；

像两条线交叉等简单的东西很容易（而且很容易找到），但我想找到一些算法来解决更棘手的事情，例如找到通过将给定多边形扩展一定量而形成的形状; 具有弯曲侧面等的形状的快速算法。

有什么好的建议吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T11:48:31.817

[计算几何算法库](http://www.cgal.org/)很不错。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-26T15:51:01.363

我喜欢[Dave Eberly 的网站](http://www.geometrictools.com/)，尤其是他的一些 PDF。

对于曲面，这里有一[本很好的免费教科书](http://tom.cs.byu.edu/~557/)，涵盖贝塞尔曲面、nurbs 和细分曲面。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-09T15:02:40.187

[Mark de Berg、Otfried Cheong、Marc van Kreveld 和 Mark Overmars 合着的“计算几何：算法和应用”](http://en.wikipedia.org/wiki/Special:BookSources/978-3-540-77973-5)是一本出色的计算几何入门教科书。尽管四位作者中只有三位名叫马克或马克，但它被称为“四马克书”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-24T11:48:39.803

这方面的权威资料书是罗杰斯和亚当斯*的计算机图形学数学元素*

[http://www.nar-associates.com/nar-publishing/mecg2nd.htm](http://www.nar-associates.com/nar-publishing/mecg2nd.htm)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T11:21:39.433

[c 中的计算几何](http://books.google.com/books?id=gsv7HALW2jYC&printsec=frontcover&dq=computational+geometry+in+c&sig=ACfU3U2rN16it8Bl_GmU5cdML4fqqYp99w)是一本很棒的书，我从中学到了很多

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-12T09:33:38.147

最后，我确实找到了我想要的东西： Christer Ericson[的实时碰撞检测](http://realtimecollisiondetection.net/)。这太棒了，我强烈推荐。不是在弯曲的侧面等方面，但对于如何正确地实际编程几何命中测试等的基本内容，它似乎很难被击败。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-30T23:52:04.260

Paul Bourke 是一个很好的灵感来源。
[http://paulbourke.net/](http://paulbourke.net/)

直奔他的几何资料： http: [//paulbourke.net/geometry/index.html](http://paulbourke.net/geometry/index.html)

You might want to wander around on his site a bit, there's tons of nice stuff !

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-25T03:05:43.093

我从Hearn 和 Baker的通用[计算机图形学 C 版本中得到了很好的使用。](https://rads.stackoverflow.com/amzn/click/com/0135309247)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T15:12:55.143

如果您对真正复杂的东西感兴趣，请尝试在[http://citeseer.ist.psu.edu/](http://citeseer.ist.psu.edu/)上搜索它，这是一个科学数字图书馆，计算几何在那里得到了很好的介绍。在 3D 中实现阴影时，我经常使用它。

# java - 为什么 maven 2 会尝试下载我已经拥有的依赖项？

> ID：126667
> 
> 赞同：6
> 
> 时间：2008-09-24T11:47:15.580
> 
> 标签：java, maven-2

当我启动“mvn install”命令时，maven 有时会尝试下载它已经下载的依赖项。这是 SNAPSHOT 所期望的，但为什么 maven 对其他 JAR 这样做呢？

我知道我可以通过“-o”标志来避免这种行为，但我只是想知道原因是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-24T11:49:01.083

我会寻找没有指定版本号的依赖项。Maven 将定期检查以确保它拥有这些工件的最新版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T03:56:01.653

这可能不是您所看到的，但过去我不得不手动将工件安装到我的本地存储库中，如果您忘记包含 -Dgenerate.pom=true 选项，那么 repo 中将没有 pom artifact 和 Maven 将前往中央（以及您配置的任何其他远程存储库）尝试在每次构建时下载该 pom。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T05:13:48.703

当我们讨论这个主题时，我遇到了 Maven 2.0.x 中的一个主要错误。在离线模式下，maven 仍然会尝试下载最新的快照，当它找不到你的快照仓库时，它会导致构建失败。想象一下，当这种情况发生在客户现场时，您只需要做一个小改动（但我离题了），会产生怎样的欢笑。

这是错误： http: [//jira.codehaus.org/browse/MNG-2433](http://jira.codehaus.org/browse/MNG-2433) 这是一种解决方法：http: [//mail-archives.apache.org/mod_mbox/maven-users/200601.mbox/%3C117228810601130559l7e79a5e2k@mail。 gmail.com%3E](http://mail-archives.apache.org/mod_mbox/maven-users/200601.mbox/%3C117228810601130559l7e79a5e2k@mail.gmail.com%3E)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-15T19:34:06.427

-o 标志仍然对我不起作用，但这确实：

```
find ~/.m2/repository -name '_maven*' | xargs rm
find ~/.m2/repository -name '*lastUpdated' | xargs rm 
```

这将删除本地存储库中的所有 .lastUpdated 和 _maven.repositories 文件。我遇到了这个问题，因为我们有一个无法访问的公司 Nexus 存储库，我需要做一些工作。使用 Eclipse 的 Maven 集成可能也促成了这一点。

# vb.net - 无法在 VB.NET 中关闭 OledbDataReader 到 Sybase 数据库

> ID：126678
> 
> 赞同：1
> 
> 时间：2008-09-24T11:51:20.810
> 
> 标签：vb.net, sybase, data-access

从 OledbDataReader 对象读取数据后，我似乎无法关闭它。这是相关代码 -

```
Dim conSyBase As New OleDb.OleDbConnection("Provider=Sybase.ASEOLEDBProvider.2;Server Name=xx.xx.xx.xx;Server Port Address=5000;Initial Catalog=xxxxxxxxxx;User ID=xxxxxxxx;Password=xxxxxxxxx;")

conSyBase.Open()

Dim cmdSyBase As New OleDb.OleDbCommand("MySQLStatement", conSyBase)
Dim drSyBase As OleDb.OleDbDataReader = cmdSyBase.ExecuteReader

Try

    While drSyBase.Read
     /*Do some stuff with the data here */

    End While

Catch ex As Exception

    NotifyError(ex, "Read failed.")

End Try

drSyBase.Close() /* CODE HANGS HERE */
conSyBase.Close()
drSyBase.Dispose()
cmdSyBase.Dispose()
conSyBase.Dispose() 
```

控制台应用程序只是挂在我试图关闭阅读器的地方。打开和关闭连接不是问题，因此有人对可能导致此问题的原因有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T13:04:17.627

我找到了答案！

前

```
drSyBase.Close() 
```

需要调用Command对象的cancel方法

```
cmdSyBase.Cancel() 
```

我相信这可能特定于 Sybase 数据库

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T12:20:46.747

这是一个长镜头，但请尝试将您的 .Close() 和 .Dispose() 行移动到 Try 的 finally 块中。像这样：

```
 Dim conSyBase As New OleDb.OleDbConnection("Provider=Sybase.ASEOLEDBProvider.2;Server Name=xx.xx.xx.xx;Server Port Address=5000;Initial Catalog=xxxxxxxxxx;User ID=xxxxxxxx;Password=xxxxxxxxx;")
conSyBase.Open()
Dim cmdSyBase As New OleDb.OleDbCommand("MySQLStatement", conSyBase)
Dim drSyBase As OleDb.OleDbDataReader = cmdSyBase.ExecuteReader
Try
  While drSyBase.Read
   /*Do some stuff with the data here */
  End While
Catch ex As Exception 
  NotifyError(ex, "Read failed.")
Finally
  drSyBase.Close() 
  conSyBase.Close()
  drSyBase.Dispose()
  cmdSyBase.Dispose()
  conSyBase.Dispose()
End Try 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T13:09:31.530

自从我使用 VB.NET 以来已经有一段时间了，但在 C# 中处理这个问题的最安全方法是使用“ **using** ”语句。

这就像一个**隐式的 try-catch**，它确保在“使用”结束时关闭/取消和处置所有资源。

```
using (OleDb.OleDbConnection connection = new OleDb.OleDbConnection(connectionString)) 
{
    DoDataAccessStuff();
} // Your resource(s) are killed, disposed and all that 
```

**更新：**[在 VB.NET 2.0 中](http://www.pluralsight.com/community/blogs/fritz/archive/2005/04/28/7834.aspx)找到了关于 Using 语句的链接，希望对您有所帮助。

```
Using conSyBase As New OleDb.OleDbConnection("Provider=Sybase.ASEOLEDBProvider.2;Server Name=xx.xx.xx.xx;Server Port Address=5000;Initial Catalog=xxxxxxxxxx;User ID=xxxxxxxx;Password=xxxxxxxxx;"), _
     cmdSyBase As New OleDb.OleDbCommand("MySQLStatement", conSyBase) 

    conSyBase.Open()
    Dim drSyBase As OleDb.OleDbDataReader = cmdSyBase.ExecuteReader

    Try
        While drSyBase.Read()

            '...'

        End While
    Catch ex As Exception
        NotifyError(ex, "Read failed.")
    End Try

    cmdSyBase.Cancel()
End Using 
```

# c# - 计算图像中唯一颜色数量的算法

> ID：126680
> 
> 赞同：7
> 
> 时间：2008-09-24T11:51:53.807
> 
> 标签：c#, algorithm, image-processing

寻找一个速度足够快且记忆犹新的。该图像是 24bpp System.Drawing.Bitmap。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-24T11:57:11.953

如果您需要一个确切的数字，那么您将不得不遍历所有像素。由于颜色的稀疏性，可能将颜色和计数存储在哈希中是最好的方法。

在散列中使用 Color.ToArgb() 而不是颜色对象可能也是一个好主意。

此外，如果速度是一个主要问题，您不想使用 GetPixel(x, y) 之类的函数——而是尝试一次处理块（一次行）。如果可以，请获取指向图像内存开头的指针并使其不安全。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-24T12:00:23.130

以前从未实现过这样的东西，但正如我所见，这是一个原始的实现：

对于 24 位图像，图像可能具有的最大颜色数是（2^24，图像的像素数）的最小值。

您只需要记录一种特定的颜色是否被计数，而不是它被计数了多少次。这意味着您需要 1 位来记录是否计算每种颜色。那是2MB的内存。遍历像素，在 2MB 颜色集图中设置相关位。最后遍历颜色集映射，计算设置位（如果幸运的话，您将有一个 POPCNT 指令来帮助完成此操作）。

对于较小的图像和当然较低的颜色深度，您最好保留一个颜色表并计算图像中的每种颜色。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-24T16:03:23.653

这里的大多数人都提出了可能会很快的解决方案（实际上，仅使用 2 MB 的解决方案在内存使用方面可能是可以接受的并且非常快；带有哈希的解决方案可能更快，但它肯定会使用超过 2 MB 的记忆）。编程总是在内存使用和 CPU 时间之间进行权衡。如果您愿意“浪费”更多内存，您通常可以更快地获得结果，或者您可以通过“浪费”更多计算时间来更慢地获得结果，但这通常可以为您节省大量内存。

这是迄今为止没有人提出的一种解决方案。它可能是内存消耗最少的那个（您可以对其进行优化，因此它几乎不会使用比将图像保存在内存中所需的更多内存，但是，图像将被更改，尽管您可能必须先复制它）。我怀疑它能否在速度上击败散列或位掩码解决方案，如果内存是您最关心的问题，那就太有趣了。

1.  按颜色对图像中的像素进行排序。您可以轻松地将每个像素转换为 32 位数字，并且可以将 32 位数字相互比较，一个数字小于另一个数字，大于或等于。如果使用快速排序，则排序不需要额外的存储空间，除了额外的堆栈空间。如果您使用 Shellsort，则根本不需要额外的内存（尽管 Shellsort 会比 Quicksort 慢得多）。

    int num = (RED << 16) + (GREEN << 8) + 蓝色；

2.  一旦你像这样对像素进行了排序（这意味着你在图像中重新排列了它们），所有相同颜色的像素总是彼此相邻。因此，您只需对图像进行一次迭代，即可查看颜色变化的频率。例如，您将像素的当前颜色存储在 (0, 0) 并使用值 1 初始化一个计数器。下一步是转到 (0, 1)。如果是和之前一样的颜色，什么都不做，继续下一个像素（0, 2）。但是，如果不相同，则将计数器加一并记住该像素的颜色以供下一次迭代。

3.  一旦您查看了最后一个像素（并且可能再次增加计数器，如果它与倒数第二个像素不同），计数器将包含唯一颜色的数量。

无论解决方案如何，在任何情况下都必须至少迭代所有像素一次，因此它不会影响此解决方案比其他解决方案更慢或更快。该算法的速度取决于您可以多快按颜色对图像的像素进行排序。

正如我所说，当速度是你的主要音乐会时，这个算法很容易被击败（这里的其他解决方案可能都更快），但我怀疑当内存使用是你的主要关注点时它可以被击败，因为除了计数器之外，还有足够的存储空间来存储一种颜色和图像本身的存储空间，如果您选择的排序算法需要，它只需要额外的内存。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T12:01:47.760

```
var cnt = new HashSet<System.Drawing.Color>();

foreach (Color pixel in image)
    cnt.Add(pixel);

Console.WriteLine("The image has {0} distinct colours.", cnt.Count); 
```

/ EDIT：正如Lou所说，由于实现的方式，使用而`.GetArgb()`不是`Color`值本身可能会稍微快一些。`Color``GetHashCode`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-24T16:06:26.953

这里的大多数其他实现都会很慢。为了快速，您需要直接扫描线访问和某种稀疏矩阵来存储颜色数据。

首先我将描述 32bpp 的情况，它要容易得多：

*   HashSet：颜色的稀疏矩阵
*   ImageData：使用 [BitmapData](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.scan0.aspx)对象直接访问底层内存
*   PixelAccess：使用 int* 将内存引用为可以迭代的整数

对于每次迭代，只需对该整数执行 hashset.add 即可。最后看看 HashSet 中有多少个键，这就是颜色的总数。需要注意的是，调整 HashSet 的大小确实很痛苦（O(n)，其中 n 是集合中的项目数），因此您可能希望从构造一个合理大小的 HashSet 开始，可能类似于 imageHeight*imageWidth/ 4会很好。

在 24bpp 的情况下，PixelAccess 需要是一个字节*，并且您需要为每种颜色迭代 3 个字节才能构造一个 int。对于 3 组中的每个字节，首先向左移动 8 位（一个字节）并将其添加到整数。你现在有一个由 32 位 int 表示的 24bpp 颜色，其余的都是一样的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T12:28:35.683

您没有准确定义独特的颜色。如果您实际上是指真正唯一的代码值（而不是在视觉上相同），那么唯一确切的解决方案是使用其他答案中描述的技术之一实际计算它们。

如果您正在寻找*视觉上相似*的颜色，这确实很快会归结为调色板映射问题，您正在寻找 256 种最佳独特颜色来最接近地表示原始全动态颜色范围图像。对于大多数图像来说，当 256 种颜色选择得当时，一张从 24 位和多达 1600 万种不同颜色开始缩小的图像可以映射到只有 256 种独特颜色的图像，这真是令人惊讶。这些正确的 256 种颜色（对于本示例）的最佳选择已被证明是 NP 完全的，但也有一些实用的解决方案可以非常接近。搜索一个名叫万世杰的人的论文和基于他的工作的东西。

如果您正在寻找图像中代码值颜色数量的近似值，我会使用无损压缩方案来压缩图像。压缩率将直接与图像中唯一代码值的数量相关。您甚至不必保留压缩输出，只需沿途累积字节数并丢弃实际输出数据即可。使用一组示例图像作为参考，您可以在图像中的压缩比和不同代码值的数量之间建立一个查找表。同样，这最后一种技术虽然相当快，但肯定是一个近似值，但它应该具有相当好的相关性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T11:59:42.897

在现代显卡之前，当大多数机器以 256 调色板模式运行时，这是一个相当有趣的领域。处理能力和内存的限制只强加了一种可能对您有用的约束——因此搜索处理调色板的算法可能会发现一些有用的东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T12:00:12.570

这取决于您要分析的图像类型。对于 24 位图像，您最多需要 2MB 内存（因为在最坏的情况下您必须处理每种颜色）。为此，最好使用位图（您有一个 2 MB 的位图，其中每个位对应于一种颜色）。对于可以在 O(#pixels) 中实现的高颜色计数的图片，这将是一个很好的解决方案。对于 16 位图像，使用此技术的位图只需要 8 kB。

但是，如果您的图片颜色不多，则最好使用其他颜色。但是你需要某种检查来指示你应该使用哪种算法......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-24T12:12:37.267

图像中唯一颜色的最大数量等于像素数，因此从过程一开始就可以预测。使用 Konrad 提出的 HashSet 方法似乎是一个合理的解决方案，因为散列的大小不应大于像素数，而使用 JeeBee 建议的位图方法需要 512 MB 的 32 位图像（如果有 Alpha 通道，并且确定这有助于颜色的唯一性）

但是，HashSet 方法的性能可能比“每颜色位”方法的性能差 - 您可能想同时尝试这两种方法并使用许多不同的图像进行一些基准测试

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-31T15:27:15.627

现代流行的[颜色量化](http://en.wikipedia.org/wiki/Color_quantization)实现使用[八叉树](http://en.wikipedia.org/wiki/Octree)数据结构。注意维基百科页面，内容非常好。八叉树的优点是内存有限，因此您可以对整个图像进行采样并决定您的调色板，而无需太多额外的内存。一旦您理解了这个概念，请点击[1996 年 Dobb 博士的期刊文章源代码](http://ftp://66.77.27.238/sourcecode/ddj/1996/9601.zip)的链接。

由于这是一个 C# 问题，请参阅 2003 年 5 月的 MSDN 文章[Optimizing Color Quantization for ASP.NET Images](http://msdn.microsoft.com/en-us/library/aa479306.aspx)，其中包括一些源代码。

# boot - 如何保留低内存（操作系统前）？

> ID：126689
> 
> 赞同：3
> 
> 时间：2008-09-24T11:54:02.553
> 
> 标签：boot, bios, bda

**背景：**在我的操作系统启动之前，我需要保留低于 0xA0000 的内存量。为此，我更改了[0040:0013](http://bioscentral.com/misc/bda.htm)（或 0x413）字，这是 KiB 中可用的低内存量。

但是，Windows 和其他操作系统使用[E820h/INT15h](http://www.uruk.org/orig-grub/mem64mb.html)来查询内存布局，并且某些 BIOS:es 不会反映 E820h/INT15h BIOS 功能的 0x413 更改。因此，如果需要，我还必须挂钩 E820h 功能。

**问题：**在操作系统之前是否有另一种（更可靠的）方法来保留低内存？或任何其他改变 E820h/INT15h 结果的方法，而不是挂钩 INT15h（也许通过戳 EBDA？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T12:03:28.880

我不这么认为，但如果你不做引导加载程序，你可以对操作系统进行半虚拟化。您可以查看 Xen 虚拟机管理程序。

# architecture - SOA 服务发现 (UDDI) 在实践中是如何工作的？

> ID：126700
> 
> 赞同：8
> 
> 时间：2008-09-24T11:59:13.227
> 
> 标签：architecture, soa, uddi

我只是在阅读 SOA 和服务注册中心/UDDI 经常被提及。听起来不错，但在现实中如何使用？

*   注册表是否旨在将逻辑服务与其物理实现（端口、url 等）分离？
*   注册表是否旨在供寻找有趣服务的人浏览？
*   将应用程序硬连接到它使用的服务会是“错误的”吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-24T16:50:46.363

我发现它在理论上比实际有用更有用。它不经常实施和不经常使用。实际上，DNS 为网络上资源的定位提供了充分的抽象工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T12:27:25.763

服务注册中心存储和发布有关所有可用服务的信息，主要是它们的接口描述和它们当前的 URI（ip、端口等）。这样，应用程序可以简单地向注册表请求所需的服务，并获得合适的服务实现的详细信息，并可以连接。

UDDI 不是为您的服务获取注册中心的唯一方法。但请记住，UDDI 仅适用于 Web 服务，因此它仅在您的 SOA 仅包含 Web 服务时才有用。

1) 正确。

2）不，它并不是真的适合人眼。当然，有浏览目录的工具，但它们主要用于查看注册表是否获得了您需要的服务等。真正的使用直接发生在您的应用程序/服务和注册表之间。

3）这取决于你想要完成什么。如果您想构建 SOA，它认为这是“错误的”，因为这与 SOA 的松散耦合范式相矛盾。如果这是您唯一的服务，唯一使用它的应用程序，并且该服务可能不会更改它的 URI，那么硬接线肯定没有问题 - 但是可能不需要分离该服务:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T09:10:23.523

如何使用多播来发现服务？喜欢使用 jgroups 或 SLP？所有服务将相互发现并将他们需要的服务注入代理。然后在实际的传输实现上构建抽象。（例如休息、肥皂、rmi）

# time - 我期望来自以太网同一子网上的第 0 层 NTP 服务器的时间有多准确？

> ID：126710
> 
> 赞同：4
> 
> 时间：2008-09-24T12:00:59.617
> 
> 标签：time, gps, time-precision, ntpd, gps-time

我有一个应用程序，它依赖 gpsd 和 ntpd 来准确设置 linux 机器上的系统时间。

gpsd 输入 NMEA + PPS

该应用程序在网络上每秒运行约 25MB，我认为系统上的负载以某种方式导致时间抖动。（加载的 PCI express 总线导致不规则的中断延迟）

我有另一台完全没有加载的机器，我可以设置它来读取 GPS 并充当已加载机器的 NTP 服务器。（加载的机器将开始启动 1 ???）

**我期望来自以太网同一子网上的第 0 层 NTP 服务器的时间有多准确？**

我希望这不是太离题，我相信有时其他人会很高兴答案记录在这里。;-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T14:05:09.990

我能找到的关于[NTP accuracy](https://web.archive.org/web/20100414014404/http://www.netcordia.com/community/blogs/terrys_blog/archive/2008/01/07/ntp-accuracy.aspx)的最佳信息，似乎在 LAN 设置中指向 1-2 ms：

> NTP v4 与内核模块支持它，能够比 1ms 精度好得多，可能和 1ns 一样好。根据 [Dave Mills] 文章，NTP v3 在 LAN 中精确到 1-2 毫秒，在 WAN 网络中精确到 10 毫秒。[http://www.cis.udel.edu/~mills/ntp.html](http://www.cis.udel.edu/~mills/ntp.html)
> 
> 其他文章建议使用准确的时间源，例如 GPS 时间源，NTP 精确到 50us，但 Linux 内核支持上的链接说几毫秒的精度是可能的。 [http://www.atomic-clock.galleon.eu.com/support/ntp-time-server-accuracy.html](http://www.atomic-clock.galleon.eu.com/support/ntp-time-server-accuracy.html)
> 
> 另一篇文章说它依赖于网络延迟的可预测性（即低抖动网络）。 [http://www.postel.org/pipermail/end2end-interest/2003-April/002925.html](http://www.postel.org/pipermail/end2end-interest/2003-April/002925.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T14:15:59.857

在这种情况下，NTP 通常被认为适用于小个位数毫秒。

在它运行了几天之后，实际时钟中应该不会有太多的抖动，因为 ntpd 实现了一堆非常长的时间常数过滤。

但是，您并没有真正说出您是如何测量时间的，并且您使用的任何机制都可能与（如果不超过）底层同步一样紧张。

如果您确实有一个繁忙的网络和具有真正深度缓冲的网卡，那么这可能无济于事，因为数据包到达和中断服务之间的抖动会更大。您的以太网交换越花哨，它的时序也就越差——在这方面，老式集线器比交换机好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T15:24:21.193

所讨论的 NTP 服务器的层级与时钟/服务器的准确性无关。这纯粹是指距您所在的“参考时钟”的距离。

更重要的是，关于 NTP 准确性（当然，关于时间）是服务器之间的网络延迟、正在使用的服务器类型以及潜在的服务器负载。根据您使用的 NTP 服务器，他们会记录其时间的准确性。每个服务器软件都使用各种算法来根据网络延迟和服务器负载计算时间，这取决于这些算法的准确性。

例如，MS NTP 服务器声明它将在 2 秒内准确。OpenNTPd 已声明他们不会为您提供服务器可能的准确性。在某些情况下，第 3 层服务器可能比第 2 层服务器更准确，等等。

# http - 如何让 Wget 处理 HTTP 100-Continue 响应？

> ID：126711
> 
> 赞同：1
> 
> 时间：2008-09-24T12:01:25.717
> 
> 标签：http, wget

我正在尝试使用[Wget](http://www.gnu.org/software/wget/)将 HTML（包含在文件中）发布到 URL，如下所示：

```
wget -O- --debug
     --header=Content-Type:text/html
     --post-file=index.html
     http://localhost/www/encoder.ashx 
```

HTML 发布到的 URL 是使用 ASP.NET 实现的 Web 应用程序端点。服务器回复[100（继续）](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.1.1)响应，Wget 只是停止在其轨道上，而不是继续接下来*应该*遵循的*真正*响应。

 ***是否可以以某种方式告诉 Wget 处理 100（继续）响应，或者这是该工具的一些众所周知的限制？**

笔记：

*   我注意到 Wget 从不发送`Expect: 100-Continue`标头，因此从技术上讲，服务器不应发出 100（继续）响应。

    **更新：** 根据 [RFC 2616（超文本传输​​协议 -- HTTP/1.1）的](http://www.w3.org/Protocols/rfc2616/rfc2616.html)[第 8.2.3 节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.2.3)，看起来这是可能的：

    > 如果请求消息不包含具有“100-继续”期望的 Expect 请求头字段，则源服务器不应发送 100（继续）响应，并且如果此类请求来自HTTP/1.0（或更早版本）客户端。此规则有一个例外：为了与 RFC 2068 兼容，*服务器可以发送 100（继续）状态以响应 HTTP/1.1 PUT 或 POST 请求，该请求不包含带有“100-继续”的期待。*此异常的目的是最大限度地减少与未声明的等待 100（继续）状态相关的任何客户端处理延迟，仅适用于 HTTP/1.1 请求，不适用于具有任何其他 HTTP 版本值的请求。

*   [cURL](http://curl.haxx.se/)对这样的事务没有任何问题。它发送一个`Expect: 100-Continue`标头并继续对真实的 100（继续）响应。

有关更多信息，以下是来自上面显示的调用的事务的完整调试跟踪：

```
Setting --post-file (postfile) to index.html
Setting --header (header) to Content-Type:text/html
DEBUG output created by Wget 1.10 on Windows.

--13:29:17--  http://localhost/www/encoder.ashx
           => `-'
Resolving localhost... seconds 0.00, 127.0.0.1
Caching localhost => 127.0.0.1
Connecting to localhost|127.0.0.1|:80... seconds 0.00, connected.
Created socket 296.
Releasing 0x01621a10 (new refcount 1).

---request begin---
POST /www/encoder.ashx HTTP/1.0
User-Agent: Wget/1.10
Accept: */*
Host: localhost
Connection: Keep-Alive
Content-Type: text/html
Content-Length: 30984

---request end---
[writing POST file index.html ... done]
HTTP request sent, awaiting response...
---response begin---
HTTP/1.1 100 Continue
Server: ASP.NET Development Server/9.0.0.0
Date: Wed, 24 Sep 2008 11:29:17 GMT
Content-Length: 0

---response end---
100 Continue
Closed fd 296
13:29:17 ERROR 100: Continue. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T20:47:47.217

我查看了适用于 Windows 的 wget 的源代码，据我所知，当 wget 无法正确解析响应时，调试输出来自一般错误条件。看起来这只是 wget 的一个限制，因此您可能必须使用 curl 或其他一些方法来避免遇到此问题。

# silverlight - Silverlight 2 中的不可变样式

> ID：126716
> 
> 赞同：2
> 
> 时间：2008-09-24T12:02:39.020
> 
> 标签：silverlight, xaml, coding-style

有人在 Silverlight 2 中找到了绕过不可变样式的好模式吗？

我的意思是，有没有人可以解决这样一个事实，即一旦设置了元素的样式，就无法以编程方式切换它，即这里的第二行将引发灾难性的失败异常：

this.TestButton.Style = (Style)Application.Current.Resources["Fred"];
this.TestButton.Style = (Style)Application.Current.Resources["Barney"];

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T18:57:43.533

这是不可能的。我见过的最好的解决方法来自 Microsoft 的 Nikhil Kothari：

[http://www.nikhilk.net/Silverlight-Themes.aspx](http://www.nikhilk.net/Silverlight-Themes.aspx)

无论如何，在 App.xaml 中集中定义样式有一个主要缺点，即当您从其他用户控件引用这些样式时，它会破坏所有设计器支持。我没用过，但 Nikhil 的主题引擎看起来很有前途，而且我有一种有趣的感觉，他的许多想法最终都会成为 silverlight 产品。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T09:15:01.917

这个问题在 Silverlight 3 中消失了，因为它的样式是可变的 - 耶！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T16:45:38.670

我不知道这是否有帮助，但我相信您可以在运行时多次更改控件的模板。也许这将是一个潜在的解决方法。

# vba - 是否可以在 VB6/VBA 中发送和存储类型引用？

> ID：126718
> 
> 赞同：1
> 
> 时间：2008-09-24T12:03:47.147
> 
> 标签：vba

我正在开发一个 VB6 应用程序，我想发送一个类型作为参考并将其存储在另一种形式中。这可能吗？

发送没问题，我就用`ByRef`关键字：

```
public Sub SetStopToEdit(ByRef currentStop As StopType) 
```

但是当我尝试使用 Set 存储`currentStop`在接收模块中时，运行程序时出现“需要对象”错误：

```
Private stopToEdit As StopTypeModule.StopType
' ... Lots of code
Set stopToEdit = currentStop 
```

`StopType`**在模块（不是类模块**）中定义如下：

```
Public Type StopType
    MachineName As String
    StartDate As Date
    StartTime As String
    Duration As Double
End Type 
```

是否可以存储发送的引用或者我必须`StopType`变成一个类？

仅设置局部变量即可：

```
stopToEdit = currentStop 
```

`stopToEdit`稍后更改时，更改在发送到的变量中不可见`SetStopToEdit`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T12:22:00.940

您需要将其重构为一个类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:12:29.247

什么是停止类型？它是如何定义的？类型是 VB6-Record 的东西吗？如果是这样（并且如果可能的话），您应该将它重新定义为一个类 - 并且只使用它们，否则您将遇到 Collections 问题。

尝试删除`Set`关键字 - 字符串、整数和数字，但如果我没记错的话，记录也不是*Set*，它们是*Let*，但这在分配中是隐含的：

```
stopToEdit = currentStop 
```

**编辑**：如果您想更改传入的（ByRef）记录，请为元素副本执行手动元素，而不是重新分配整个内容 - 这应该可以解决问题。

同时：**不要**！ByRef（遗憾的是在 VB 中是默认设置）不是很酷（套用我儿子的话）。尝试设计你的函数，这样它们就不会改变传入的参数 - 这就是你有一个返回值......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T12:03:32.227

这里的混淆是 StopType 不是像对象那样的引用，而是更像是内置类型，例如 LONG。当你这样做时：

stopToEdit = currentStop

您只是获取 currentStop 的副本。如果您随后更改 stopToEdit，则需要将其复制回来：

currentStop = stopToEdit

这样，该值将从 Sub 传回。

# oracle - 如何避免存储凭据以使用 JDBC 连接到 Oracle？

> ID：126720
> 
> 赞同：28
> 
> 时间：2008-09-24T12:05:22.773
> 
> 标签：oracle, jdbc, credentials

是否可以在配置文件（或任何其他标准可读位置）中不提供用户名/密码信息的情况下设置与 Oracle 的 JDBC 连接？

通常，应用程序有一个配置文件，其中包含连接到数据库的设置参数。一些 DBA 对用户名和密码在配置文件中以明文形式存在这一事实存在疑问。

我认为这对于 Oracle 和 JDBC 是不可能的，但我需要一些确认......

一种可能的折衷方案是在配置文件中加密密码并在建立连接之前对其进行解密。当然，解密密钥不应该在同一个配置文件中。这只会解决未经授权的用户意外打开配置文件的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-27T10:42:38.477

您可能想尝试 Kerberos，它可以使用操作系统用户的凭据并将操作系统用户添加到外部标识的数据库中。确保您使用的是 Kerberos，而不是使用旧方法，因为旧方法存在严重的安全问题。

对于 Kerberos 支持，您需要高级安全选项和最新的 JDBC 驱动程序，可能是 11g 版本。在尝试让它在 Java 中工作之前，请在 Sql*Plus 中使用“/”作为用户名和空密码进行尝试。“从双重选择用户”应该给你用户@域。您可能还会发现，在 Kerberos 配置方面，使用瘦驱动程序或 OCI 驱动程序之间存在根本区别。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-24T12:24:46.237

您绝对不希望能够在没有凭据的情况下连接到数据库，因为这会使数据库容易受到攻击。

这是一个普遍的问题，我如何存储访问外部系统所需的凭据？WebLogic 有一个凭证映射器来解决这个问题，其中凭证（加密的）存储在嵌入式 LDAP 中。许多 Oracle 产品使用将凭证存储在 Oracle 钱包中的凭证存储设施。

在问题中，您提供了答案。存储密码加密并在需要时解密。显然，您必须使用对称加密算法（例如 3DES）才能解密它。确保对称密钥不是可以猜到的。

诀窍是保存加密/解密所需的对称密钥。您可以将其放在通过操作系统保护的文件中，也可以将其保存在代码中，但是您需要确保代码的安全。如果您使用能够生成相同密钥并且算法相当安全的技术，您也可以生成密钥。

如果您可以确保代码安全，那么您显然也可以将密码保存在代码中。但是，您希望能够在不更改代码的情况下更改凭据的灵活性。

您也可以向此解决方案添加更多层。您可以加密配置文件（使用不同的密钥）以及其中的密码，使黑客发现 2 个密钥。还有其他使用 PKI 的更安全的方法，但它们很难设置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T13:02:14.073

我建议您查看代理身份验证。这在[Oracle® Database Security Guide](http://download.oracle.com/docs/cd/B19306_01/network.102/b14266/apdvprxy.htm#i1010326)以及[Oracle® Database JDBC Developer's Guide and Reference](http://download.oracle.com/docs/cd/B19306_01/java.102/b14355/proxya.htm#CHDHHAAD)中有记录。本质上，这允许您做的是在数据库中拥有一个仅具有连接权限的用户。用户真实数据库帐户被配置为能够以代理用户身份连接。通过 JDBC 连接的应用程序然后存储代理用户名和密码，并在连接时提供这些凭据，并在连接字符串中加上真实数据库用户的用户名。Oracle 以代理用户身份连接，然后模仿真实数据库用户，继承真实用户的数据库权限。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T21:50:37.580

所有`J2EE`容器（**JBOSS**、**Tomcat**、**BEA**）都有连接池。`1/100`^(他们将打开许多连接，使它们保持活动状态，并将在从头)开始创建连接所需的时间内将它们提供给您。

此外，它们还具有很酷的功能，`JBOSS`例如，所有连接信息都存储在外部文件中。如果您更改连接信息，即从*测试*数据库切换到*生产*数据库，您的应用程序将动态地从新池中获取连接

好消息是你不需要运行一个完整的`J2EE`容器来使用连接池。外部资源允许密码以明文或伪加密形式存储。

有关使用 Tomcat 的内置连接池的指南，请参阅 apache commons-dbcp：

*   [http://vigilbose.blogspot.com/2009/03/apache-commons-dbcp-and-tomcat-jdbc.html](http://vigilbose.blogspot.com/2009/03/apache-commons-dbcp-and-tomcat-jdbc.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T12:12:27.157

由于除了与 Oracle 交谈的 Java 和 JDBC 之外，我对您的环境并不完全清楚，因此我将对此发表看法。

如果您谈论的是 Java EE 应用程序，您应该能够在应用程序服务器上设置连接池和数据源，然后您的应用程序与在该级别处理连接的连接池进行通信。

连接池和数据源保存并保护凭证。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T12:12:58.530

据我所知，jdbc 连接用户名/密码需要存储为纯文本。限制这种可能风险的一种方法是限制用户的权限，以便只能使用给定的应用程序数据库并且只能来自预定义的主机。IMO，这将极大地限制攻击者：他只能使用来自原始应用程序所在同一主机的 un/pw 并且只能攻击原始应用程序的数据库。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T12:13:53.533

过去一直想知道这一点。

该解决方案当然包括在服务器和网络级别具有适当的网络安全性，以真正减少可以访问系统的人数，并且拥有数据库凭据仅授予对具有最低权限的数据库帐户的访问权限应用程序运行所必需的。

就“不必费心寻找密钥或密码”而言，对属性文件进行加密可能足以让攻击者进入下一个受感染的服务器。但是，我不会依赖“我的邻居不那么安全，所以请从他那里偷走”安全！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T12:39:43.237

有两种关键方法，它们都对系统的设计产生重大影响，因此在不进行重大重写的情况下从一种方法转移到另一种是不容易的。在选择之前，您需要了解您公司的安全治理策略是什么。

1) 每个用户都有通过应用程序携带的凭据，用于应用程序正在使用的服务；在您的情况下，Oracle 数据库使用这些用户凭据连接到数据库。缺点是每个用户都需要每个安全服务的凭据。这是一种合理的安全方法，但也需要大量额外的工作来提供和维护用户凭据。您的数据库管理员将需要主动管理用户凭据，这可能与您公司的安全治理策略背道而驰。

2) 应用程序数据库凭证存储在安全目录服务中，例如安全 LDAP。应用程序使用用户的凭据访问目录服务。目录服务为正在访问的服务返回适当的凭据。

在这两种情况下，应将数据库凭据限制为仅执行适当的操作。凭证应反映业务流程的要求，例如；它们允许从定义的视图/表中选择、插入到其他视图中，但不能创建、更新或删除表。在第二种方法中，为每个主要业务流程使用单独的凭据，例如订单处理、会计、人力资源等。

但是请记住，安全性就像洋葱层，如果有人剥离了这些层来访问应用程序，那么他们就可以访问数据库连接池配置文件。他们可能会特洛伊木马应用程序来捕获用户的凭据。这就是良好的安全治理策略的用武之地。

安全治理是一个复杂的问题，需要高级管理层的承诺，因为如果您需要为您的实时平台提供这种级别的安全性，则需要付出代价。您需要将开发职责与部署、操作和用户权限管理分开。您可能还需要有安全审计员，他们拥有查看更改的完全访问权限，但无法更改配置。它远非简单，而且是高薪的专业。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T12:18:11.590

您可以尝试 Oracle 的代理身份验证，其中 JDBC 客户端使用证书对数据库服务器信任的已知中间层组件/服务（代理）进行身份验证。不过我从来没有尝试过，所以我不知道这是否容易做到。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-24T12:09:17.413

您可以将凭据存储在任何地方，包括作为程序中的硬连线字符串或作为 Windows 注册表中的条目。但是，如果您使用非标准的东西，则由您来检索它们；我不知道有任何非纯文本的预卷解决方案。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-04-25T18:27:22.293

除了已经提到的解决方案（Kerberos 身份验证，使用代理身份验证）之外，还有 2 个其他解决方案都可以与 JDBC 瘦驱动程序一起使用：

1.  将密码存储在 SSO 钱包中：可以使用钱包来存储用户的密码。如果您使用 SSO 钱包，则钱包本身没有密码。SSO 钱包通常用于 SSL 的上下文中，但它们也可用于仅存储密码。
2.  将 SSL 与用户身份验证一起使用：使用通过专有名称 (DN) 进行外部身份验证的用户配置 SSL。此用户没有密码。只要您使用具有此 DN 的证书连接 SSL，您就可以使用此用户创建会话。

# algorithm - 囚徒困境算法

> ID：126737
> 
> 赞同：7
> 
> 时间：2008-09-24T12:11:36.097
> 
> 标签：algorithm, performance, game-theory

看完《黑暗骑士》后，我对囚徒困境的概念非常着迷。*必须*有一种算法可以在特定情况下最大化自己的收益。

对于那些发现这个外国的人：[http ://en.wikipedia.org/wiki/Prisoner%27s_dilemma](http://en.wikipedia.org/wiki/Prisoner%27s_dilemma)

非常非常有趣的东西。

编辑：问题是，*如果*有的话，囚徒困境最有效的算法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-24T12:26:36.000

由于只有一种选择，并且在没有任何可变输入的情况下，您的算法要么是：

```
cooperate = true; 
```

...或者...

```
cooperate = false 
```

为迭代囚徒困境寻找策略更有趣，这是很多人都做过的事情。例如[http://www.iterated-prisoners-dilemma.info/](http://www.iterated-prisoners-dilemma.info/)

即使那样，它也不是“可解决的”，因为其他玩家是不可预测的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-24T12:22:19.537

维基百科页面似乎给出了所有答案......对于一次性囚徒困境，每个囚犯（不是两个囚犯）的最佳解决方案是背叛。

对于迭代囚徒困境，最好在第一次尝试时保持沉默，然后在最后一次执行其他囚徒所做的任何事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T12:17:48.783

困境的全部意义在于最佳解决方案（两名囚犯都保持安静）是危险的，因为部分问题不在你的掌控之中。所以，选择次优的解决方案似乎可以最大化你的收益，但它仍然是次优的

当部分问题是未知的时，我看不出算法如何提供解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-24T12:27:34.233

我推荐阅读[Axelrod 的《合作的演变》](https://rads.stackoverflow.com/amzn/click/com/0465005640)。这是针对迭代囚徒困境的竞争策略的计算机实验。上次听说的时候，针锋相对的策略先出来了。它可能已经改变了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-24T18:26:51.360

对于一次性版本的游戏，最好的策略总是背叛，因为没有报复的机会。

迭代版本变得更有趣，因为玩家可以回应对手之前的选择。

如果我们事先确切知道会有多少轮，那么合乎逻辑的“最佳”策略仍然是总是背叛。这是因为在最后一回合背叛总是有意义的，因为没有报复的机会。当然，我们理性的对手会知道这一点，而且总是在最后一回合背叛。这让我们在倒数第二回合叛逃是明智的，因为无论如何在最后一回合都没有合作的机会。按照这个逻辑得出它的自然结论，我们应该每时每刻都背叛。

当总轮数未知时，事情变得更加有趣。一个好的游戏策略应该尝试预测对手会做什么。我研究了使用[进化算法](http://en.wikipedia.org/wiki/Evolutionary_algorithm)和简单的机器学习与对手建模来为我的硕士学位生成游戏策略。如果你*真的*有兴趣，可以阅读[我的论文](http://www.dandyer.co.uk/thesis.pdf)。

正如 Yuval 推荐的那样，最好的起点可能是[Axelrod 的开创性著作](https://rads.stackoverflow.com/amzn/click/com/0465005640)。如果你*真的*对这些东西很感兴趣，有一个[20 周年的后续活动](https://rads.stackoverflow.com/amzn/click/com/9812706976)，其中包括其他研究人员最近关于 IPD（迭代囚徒困境）的许多工作。

另外，我彻底推荐了威廉庞斯通的[囚徒困境](https://rads.stackoverflow.com/amzn/click/com/038541580X)，这是约翰冯诺依曼的部分传记和博弈论的部分介绍。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T12:24:13.557

好吧，据我了解，模式识别也是其中的重要组成部分。找出其他囚犯的习惯——他保持安静的频率以及他何时发情。您还必须将其与您自己的选择进行交叉引用，以确定您做了什么让他以某种方式做出反应。

我认为它比维基解释的要复杂一些。这不仅仅是囚犯在最后一次做的事情，而且在那之前的所有事情上都一直延伸到无穷大。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T12:21:55.060

是啊。[这让我想起了这篇关于软件开发中的囚徒困境的](http://www.spectacle.org/995/sw.html)旧文章

对于算法 PD 竞赛，请看[这里](http://www.prisoners-dilemma.com/)

[这](http://www.wired.com/culture/lifestyle/news/2004/10/65317)也不错

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T12:23:50.140

没有，因为你不能断然预测第二个囚犯的行为。

有各种各样的“解决方案”可以对第二个囚犯的行为做出基本但非常严格的假设，但他们对不受约束的问题几乎没有什么可说的（这就是使它成为如此令人信服的困境的原因）。

我的两分钱，鉴于您不能依赖第二个囚犯的行为，归根结底是：您是乐观主义者，还是愤世嫉俗者？两个囚犯是要粘在一起（盗贼中的荣誉），还是他们会一有机会就互相指责以挽救自己的喉咙……？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T12:24:18.080

此外，在迭代的囚徒博弈中，最优策略将根据游戏中的其他策略而有所不同。

在系列赛中对抗一个总是背叛总是背叛的球员是最好的策略。在与可能会合作的玩家对抗时，采取报复但偶尔原谅的策略可能是最好的。

我应该补充一点，这仅适用于长度未知的游戏。任何已知长度的游戏都与单轮游戏相同。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-24T12:26:20.697

尝试为囚徒困境找到最佳解决方案就像尝试为 Ro-Sham-Bo（石头剪刀布）找到一个最佳解决方案。您能做的最好的事情就是模拟您的对手并尝试利用模式。

在博弈论和计算机科学的早期，约翰·冯·诺依曼和兰德公司花费了大量的头骨汗水试图提出一个解决囚徒困境的最佳算法，但没有成功，iirc 最终在数学上证明没有最优解。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-24T13:00:34.483

囚徒困境的全部意义在于，你的最佳策略是背叛另一个囚徒。O(1)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-24T18:32:27.867

从数学上讲，其他帖子回答了这个问题，但实际上，可能还有其他选择。无论这些选择多么荒谬，它们都会带来额外的结果可能性，并且可能会增加个人收益的机会。例如，在蝙蝠侠的情况下，它会破坏情节，但他本可以杀死小丑——从而破坏小丑对结果的任何额外影响。通过让小丑活着，蝙蝠侠不知不觉地让小丑获得了他唯一需要的“胜利”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T19:54:10.643

当您退后一步并考虑整个锦标赛时，游戏会变得更加有趣。例如，几年前，一个来自英国的团队赢得了 PD 锦标赛，该团队提交了多个参赛作品。其中一个是“主人”，另一个是“奴隶”。他们都将从播放特定的动作序列开始，这将使主人和奴隶能够相互识别。一旦识别出主节点将背叛，从节点将在其余的迭代中合作。因此，主人赢得了比赛，但牺牲了奴隶。

该策略具有经济意义，因为第一名有金钱奖励，但进入成本很低。

更一般地说，在为 TD 锦标赛编写程序时，您需要着眼于大局：

1.  奖品如何颁发？
2.  你能和其他参赛者合谋吗？
3.  what are the costs of entry? penalties?

Otherwise, yes, the dominant strategy is to defect in the one-shot PD. Axelrod, as others mentioned, showed that tit-for-tat was robust in a series of tournaments, but in these tournaments nobody thought about conspiring with other contestants.

# python - 如何移动在设备上下文 python 中绘制的对象

> ID：126738
> 
> 赞同：-1
> 
> 时间：2008-09-24T12:12:04.740
> 
> 标签：python, animation

我已经使用 python 在设备上下文中绘制了一个图像，我想平滑地移动它/垂直或水平动画。

我应该使用什么算法？我在哪里可以获得有关 python 中此类任务的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T12:15:05.607

一旦在设备上下文中绘制了一个对象，它就会停留在那里。如果要移动它，则需要重新绘制它。

您可以保持固定的背景，并且仅在每次移动时重绘可移动元素。基本上就是这样完成的。

要将对象平稳地移动到一条线上，您必须执行以下操作（我没有准备好程序，所以只能给您一个想法）：

*   选择开始和结束位置：点 A(x1, y1) 和 B(x2, y2)
*   选择对象应在多长时间内将位置从 A 更改为 B（例如 10 秒）。
*   使用设置为特定时间间隔的计时器（比如 2 秒）
*   计算对象应在每个计时器间隔内更改的增量 X 和 Y。在这种情况下 dx = (x2-x1)*2/10 和 dy = (y2-y1)*2/10
*   在计时器回调中，使用 dx 和 dy 增加当前对象位置并重绘图像

那将是算法。

我建议你也看看[PyGame](http://www.pygame.org/)。也许你可以使用它，它也有一些教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T13:45:34.813

`(x1, y1)`要在起始坐标和目标坐标之间平滑移动对象`(x2,y2)`，您首先需要问自己，对象需要多*长时间*才能到达目的地。假设您希望对象以`t`时间单位（可能是秒、小时等）到达那里。一旦确定了这一点，就可以轻松地计算每单位时间的位移：

```
dx = (x2-x1)/t
dy = (y2-y1)/t 
```

现在您只需在每单位时间添加`(dx,dy)`到对象的位置 ( `(x,y)`, 初始`(x1,y1)`)，并在对象到达目的地的某个阈值距离内时停止。这是为了解释除法错误会累积的事实，所以如果你做了一个相等检查，比如：

```
(x,y)==(x2,y2) 
```

这不太可能是真的。

请注意，上述方法为您提供恒定速度、直线运动。您可能希望改用某种稍微复杂一点的公式，让对象看起来像是加速、保持巡航速度，然后减速。以下公式可能会很有用：

```
v(t) = u(t) + t*a(t)
x(t) = v(t) + t*v(t) 
```

这只是[欧拉的方法](http://en.wikipedia.org/wiki/Eulers_Method)，应该足以用于动画目的。

# c# - 有哪些好的工具可用于为 .net 应用程序创建在线帮助？

> ID：126744
> 
> 赞同：0
> 
> 时间：2008-09-24T12:13:10.040
> 
> 标签：c#, winforms, chm

我有一个 winforms 应用程序，该应用程序目前附带一个用于上下文相关帮助文档（不是 API 文档）的 chm 文件，该文件是使用 MS HTML Help Workshop 创建的。

我想转向在线文档（不必随产品一起提供，可以轻松更新等）。这类事情推荐使用哪些工具，它们的优缺点是什么？

我希望能够做到以下几点：

*   在我的网络服务器上托管帮助文件
*   提供上下文相关的帮助
*   有合理的导航/目录寻求帮助
*   为应用程序的不同主要版本托管不同版本的帮助
*   轻松编辑帮助。像 wiki 这样的东西会很好，最好有好的所见即所得编辑器。
*   从帮助文件轻松创建 PDF 手册
*   不必为工具支付（很多）

我想我可以通过 HTML Help Workshop 和一些工作来完成大部分工作，但如果有更好的工具，我想知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T12:16:16.743

大多数商业帮助系统都可以选择将帮助生成为一组 HTML 页面，然后可以将其上传到网站。Certinaly [HelpStudio](http://www.innovasys.com/products/hs3/overview.aspx)是我自己使用的。您也可以试用[Doc-2-Help](http://www.doctohelp.com/SuperProducts/DocToHelp/)，它也是帮助市场的主要参与者。

# c++ - 编译随机失败：“无法打开程序数据库”

> ID：126751
> 
> 赞同：38
> 
> 时间：2008-09-24T12:15:11.377
> 
> 标签：c++, visual-studio, visual-studio-2005, compiler-errors, nightly-build

在使用 Visual Studio 2005（版本 8.0.50727.762）进行长时间编译期间，有时在某些项目的多个文件中会出现以下错误：

```
fatal error C1033: cannot open program database 'v:\temp\apprtctest\win32\release\vc80.pdb' 
```

（提到的文件要么在项目的临时目录中，`vc80.pdb`要么`vc80.idb`在项目的临时目录中。）

同一项目的下一次构建成功。没有其他可以访问相同文件的 Visual Studio 打开。

这是一个严重的问题，因为它使夜间编译变得不可能。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-24T13:25:25.343

我们在我的网站上也看到了很多。[根据我们的设置，来自 Peter Kaufmann 的解释](http://graphics.ethz.ch/~peterkau/coding.php)似乎是最合理的：

**在 Visual Studio 2005 中构建解决方案时，您会收到诸如致命错误 C1033：无法打开程序数据库“xxx\debug\vc80.pdb”之类的错误。但是，当第二次运行构建时，它通常会成功。**

原因：解决方案中的两个项目可能会将它们的输出写入同一目录（例如，'xxx\debug'）。如果工具 - 选项、项目和解决方案 - Bild 和 Run 中的最大并行项目构建数设置设置为大于 1 的值，这意味着两个编译器线程可能会尝试同时访问相同的文件，从而产生一个文件共享冲突。解决方案：检查您的项目设置并确保没有两个项目使用相同的目录来存储输出、目标或任何类型的中间文件。或者将最大并行项目构建数设置为 1 以快速解决问题。我在使用 CLAPACK 库附带的 VS 项目文件时遇到了这个问题。更新： Tortoise SVN 有可能访问“vc80.pdb”，即使文件不受版本控制，这也可能导致上述错误（感谢 Liana 报告此问题）。但是，我无法确认这一点，因为在确保所有项目都使用不同的输出目录后，我无法重现该问题。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-24T13:26:11.067

可能是防病毒软件或类似程序在写入时接触了 pdb 文件 - 在这种情况下，防病毒软件最有可能是可疑的。恐怕我只能根据我过去在我们商店设置夜间构建的经验给你一些一般性的指导。其中一些可能听起来微不足道，但为了完整起见，我将它们包括在内。

*   首先也是最重要的：确保你从一张白纸开始。也就是说，在开始 nightly 之前强制删除构建的输出目录。
*   如果您的夜间机器上有防病毒、反间谍软件或其他此类程序，请考虑将其删除。如果这不是一个选项，请将您的 obj 文件夹添加到程序的排除列表中。
*   （可选）考虑使用 VCBuild 或 MSBuild 等工具作为夜间活动的一部分。如果您在多核机器上，我认为使用 MSBuild 会更好。我们将 IncrediBuild 用于 nightlies，将 MSBuild 用于发布，从未遇到您描述的问题。

如果没有其他工作，您可以在构建开始几个小时后安排一个看门狗脚本并检查其状态；如果构建失败，看门狗应该重新启动它。这是一个丑陋的黑客，但总比没有好。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-08-18T08:01:41.773

将调试信息切换为 C7 格式，而不是使用 PDB。

`Project Options -> C/C++ -> General -> Debug Information Format`并将其设置为`C7`。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-25T10:57:19.777

这通常发生在您之前的调试尝试没有完全杀死调试器时。在任务管理器中查找名为 vcjit 的进程，将其杀死并重试。最坏的选择重新启动 Visual Studio，这应该可以解决您的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-23T12:33:57.860

我今天遇到了这个问题，结果证明是导致它的 pdb 路径中的非 ansi 字符。

我通过 vmware 使用 Windows，我的项目位于共享位置：\vmware-host\Shared Folders\project

当我将它移到 \Users\julian\project 时，它解决了这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-05T01:51:44.187

尝试右键单击VS的可执行文件....和属性->兼容性->勾选“以兼容模式运行此程序：”关闭........

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-21T16:02:53.917

在处理我位于 Dropbox 文件夹中的项目时，我遇到了类似的问题。我发现当系统托盘中的 Dropbox 图标上出现“同步”小图标时，它会抛出此错误，因为 Dropbox 正在访问文件以将它们上传到他们的服务器。当我等到 Dropbox 完成同步后再构建时，它每次都能正常工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-09T17:31:47.963

我刚刚遇到了这个问题。Visual Studio 抱怨无法打开`vc100.pdb`。我查找了该文件的打开文件句柄`procexp`，发现该进程`mspdbsrv`有一个打开的文件句柄。杀死这个过程解决了这个问题，我能够编译。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T22:53:23.140

你在使用 LinqToSql 吗？也许它类似于我在这个问题中偶尔会遇到的奇怪错误：[是什么导致 Visual Studio 无法正确加载程序集？](https://stackoverflow.com/questions/28839/what-causes-visual-studio-to-fail-to-load-an-assembly-incorrectly)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-30T08:04:09.207

我将中间目录从：

```
%TEMP%\$(ProjectName)\$(Platform)\$(Configuration)\ 
```

到

```
C:\temp\$(ProjectName)\$(Platform)\$(Configuration)\ 
```

现在可以了。不知道为什么。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-04-29T05:31:39.897

我有同样的问题 `C1033: cannot open program database`，

**设想**

我有两个 dll 的**parent.dll**和**child.dll**。我刚刚将 child.dll 项目附加到 Visual Studio 调试器中，同时我试图构建 parent.dll 项目，产生错误 `C1033: cannot open program database`

**解决方案**

停止调试并终止调试器附带的进程。重建项目

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-03-24T21:59:05.867

如果我`Ctrl`+`Break`取消构建（vs2015），这种情况一直发生在我身上。有一些进程没有正确关闭。我进行了狂暴的“结束任务” ms/vs 相关进程（查找重复项），我的构建再次工作。重新启动可能也会起作用。就像迁移到 gnu binutils 一样。

令人讨厌的解锁工具不会报告任何锁定文件的进程，Windows 不允许我删除它，`.pdb`但我可以重命名它。我的猜测是在构建期间两个进程同时跳入。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-04T00:02:41.653

就我而言，问题出在 Google Drive：我忘记了该项目位于同步文件夹下，而 G Drive 可能锁定了该文件。暂停同步没有帮助，因为无论如何都会抛出错误。

将项目文件夹移动到 Google Drive 未同步的另一个位置解决了我的问题。

顺便提一下，一开始我以为是我的防病毒软件，因为当使用`procexp`它检查文件时，显示该文件已被我的一个防病毒程序使用。从我的防病毒扫描中排除文件夹项目对我没有帮助。

# recursion - 递归函数的例子

> ID：126756
> 
> 赞同：35
> 
> 时间：2008-09-24T12:16:32.467
> 
> 标签：recursion

任何人都可以建议说明递归函数的编程示例吗？有常见的老马，如***斐波那契系列***和***河内塔***，但除它们之外的任何东西都会很有趣。

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-09-24T12:20:54.080

[此插图](http://everything2.com/index.pl?node_id=477013)是英文的，而不是实际的编程语言，但对于以非技术方式解释该过程很有用：

```
一个孩子睡不着，所以她妈妈讲了一个小青蛙的故事，
  谁睡不着，所以青蛙的妈妈讲了一个小熊的故事，
     谁睡不着，所以熊妈妈讲了一个小黄鼠狼的故事
       ……谁睡着了。
     ……小熊睡着了；
  ……小青蛙睡着了；
……孩子睡着了。

```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-09-24T20:44:23.057

为了[理解](http://en.wikipedia.org/wiki/Recursion) [递归](https://stackoverflow.com/questions/126756/examples-of-recursive-function)，首先必须理解[递归](https://stackoverflow.com/questions/126756/examples-of-recursive-functions#129853)。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-02-27T11:21:46.437

递归的经验法则是，“使用递归，当且仅当在每次迭代中您的任务分成**两个或更多**类似的任务”。

所以斐波那契不是递归应用的好例子，而河内是一个很好的例子。

因此，大多数递归的好例子都是不同讨论中的树遍历。

例如：图遍历 - 访问过的节点永远不会被再次访问的要求有效地使图成为树（树是没有简单循环的连接图）

分治算法（快速排序、合并排序）——“分”之后的部分构成子节点，“征服”构成从父节点到子节点的边。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-09-24T13:42:32.387

测试一个字符串是否为回文怎么样？

```
bool isPalindrome(char* s, int len)
{
  if(len < 2)
    return TRUE;
  else
    return s[0] == s[len-1] && isPalindrome(&s[1], len-2);
} 
```

当然，您可以使用循环更有效地做到这一点。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-09-24T12:19:38.170

编写[递归下降解析器](http://en.wikipedia.org/wiki/Recursive_descent_parser)！

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-09-24T13:36:49.840

在数学世界中，有[阿克曼函数](http://en.wikipedia.org/wiki/Ackermann_function)：

```
Ackermann(m, n)
{
  if(m==0)
    return n+1;
  else if(m>0 && n==0)
    return Ackermann(m-1, 1);
  else if(m>0 && n>0)
    return Ackermann(m-1, Ackermann(m, n-1));
  else
    throw exception; //not defined for negative m or n
} 
```

它总是终止，但即使对于非常小的输入，它也会产生非常大的结果。例如，Ackermann(4, 2) 返回 2 ^(65536) − 3。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-09-24T12:23:41.140

另一对“通常的嫌疑人”是[Quicksort](http://en.wikipedia.org/wiki/Quicksort)和 MergeSort

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-24T12:57:55.097

解释器[设计模式](http://en.wikipedia.org/wiki/Interpreter_pattern)是一个很好的例子，因为很多人没有发现递归。维基百科文章中列出的示例代码很好地说明了如何应用它。但是，仍然实现解释器模式的更基本的方法是`ToString`嵌套列表的函数：

```
class List {
    public List(params object[] items) {
        foreach (object o in items)
            this.Add(o);
    }

    // Most of the implementation omitted …
    public override string ToString() {
        var ret = new StringBuilder();
        ret.Append("( ");
        foreach (object o in this) {
            ret.Append(o);
            ret.Append(" ");
        }
        ret.Append(")");
        return ret.ToString();
    }
}

var lst = new List(1, 2, new List(3, 4), new List(new List(5), 6), 7);
Console.WriteLine(lst);
// yields:
// ( 1 2 ( 3 4 ) ( ( 5 ) 6 ) 7 ) 
```

（是的，我知道如果你期望一个函数被调用，那么在上面的代码中发现解释器模式并不容易`Eval`……但实际上，解释器模式并没有告诉我们函数被调用的内容，甚至没有明确地告诉我们函数的作用和 GoF 书将上述内容列为所述模式的示例。）

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-24T13:50:36.907

在我看来，递归是很好的知识，但是大多数可以使用递归的解决方案也可以使用迭代来完成，而且迭代的效率要高得多。

这里说的是在嵌套树（例如 ASP.NET 或 Winforms）中查找控件的递归方式：

```
public Control FindControl(Control startControl, string id)
{
      if (startControl.Id == id)
           return startControl

      if (startControl.Children.Count > 0)
      {
           foreach (Control c in startControl.Children)
           {
                return FindControl(c, id);
           }
      }
      return null;
} 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2010-05-04T13:17:48.283

这是来自文件系统世界的一个实用示例。此实用程序递归地计算指定目录下的文件。（我不记得为什么，但实际上我很久以前就需要这样的东西......）

```
public static int countFiles(File f) {
    if (f.isFile()){
        return 1;
    }

    // Count children & recurse into subdirs:
    int count = 0;
    File[] files = f.listFiles();
    for (File fileOrDir : files) {
        count += countFiles(fileOrDir);
    }
    return count;
} 
```

（请注意，在 Java 中，[`File`](http://java.sun.com/javase/6/docs/api/java/io/File.html)实例可以表示普通文件或目录。此实用程序将目录排除在计数之外。）

一个常见的现实世界示例`FileUtils.deleteDirectory()`来自[Commons IO](http://commons.apache.org/io/)库；请参阅[API 文档](http://commons.apache.org/io/api-1.4/org/apache/commons/io/FileUtils.html#deleteDirectory%28java.io.File%29)和[源代码](http://svn.apache.org/viewvc/commons/proper/io/trunk/src/java/org/apache/commons/io/FileUtils.java?view=markup)。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-02-03T13:49:13.043

一个真实的例子是“物料清单成本”问题。

假设我们有一家制造最终产品的制造公司。每个产品都可以通过其部件列表和组装这些部件所需的时间来描述。例如，我们用外壳、电机、卡盘、开关和电线制造手持电钻，只需 5 分钟。

给定每分钟的标准人工成本，制造我们每件产品的成本是多少？

哦，顺便说一句，有些零件（例如电源线）是购买的，所以我们直接知道它们的成本。

但实际上我们自己制造了一些零件。我们用一个外壳、一个定子、一个转子、一个轴和轴承制造了一个电机，这需要 15 分钟。

我们用冲压件和线材制造定子和转子，...

因此，确定成品的成本实际上相当于遍历代表我们流程中所有整体到零件列表关系的树。用递归算法很好地表达了这一点。它当然也可以迭代地完成，但核心思想与自己做的簿记混在一起，所以不清楚发生了什么。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-24T12:49:04.870

我知道的最毛茸茸的例子是 Knuth's [Man or Boy Test](http://en.wikipedia.org/wiki/Man_or_boy_test)。除了递归之外，它还使用嵌套函数定义（闭包）、函数引用和常量/函数二元论（按名称调用）的 Algol 特性。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-03T14:38:23.297

正如其他人已经说过的那样，许多规范递归示例都是学术性的。

我过去遇到的一些实际用途是：

1 - 导航树结构，例如文件系统或注册表

2 - 操作可能包含其他容器控件（如 Panels 或 GroupBoxes）的容器控件

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-24T12:18:28.563

我个人最喜欢的是[二分搜索](http://en.wikipedia.org/wiki/Binary_search)

编辑：另外，树遍历。例如，遍历文件夹文件结构。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-24T12:20:05.937

Guido van Rossum 的《[实现图》在 Python 中有一些递归函数来查找图中两个节点之间的路径。](http://www.python.org/doc/essays/graphs/)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-24T12:20:54.330

我最喜欢的排序，[合并排序](http://en.wikipedia.org/wiki/Merge_sort)

（最喜欢的，因为我能记住算法*，而且*在性能方面还不错）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-24T12:18:55.393

*   阶乘
*   深入遍历树（在文件系统、游戏空间或任何其他情况下）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-24T12:22:40.080

反转字符串怎么样？

```
void rev(string s) {
  if (!s.empty()) {
    rev(s[1..s.length]);
  }
  print(s[0]);
} 
```

理解这一点有助于理解递归。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-24T12:25:14.413

[处理列表](http://htdp.org/2003-09-26/Book/curriculum-Z-H-27.html#node_idx_1494)的任何东西怎么样，例如：

*   地图（和andmap，ormap）
*   折叠（折叠，折叠）
*   筛选
*   ETC...

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-02T21:22:21.330

曾几何时，不久前，小学生使用 Logo 和 Turtle Graphics 学习递归。[http://en.wikipedia.org/wiki/Turtle_graphics](http://en.wikipedia.org/wiki/Turtle_graphics)

递归也非常适合通过详尽的试验来解决难题。有一种叫做“填充”（Google it）的谜题，你会得到一个像填字游戏一样的网格，还有单词，但没有线索，没有编号的方块。我曾经为一个谜题发布者编写了一个使用递归的程序来解决谜题，以确保已知的解决方案是唯一的。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-03T14:33:02.763

递归函数非常适合处理[递归定义的数据类型](http://en.wikipedia.org/wiki/Recursive_type)：

*   自然数为零或另一个自然数的后继
*   列表是空列表或前面有元素的另一个列表
*   树是具有一些数据和零个或多个其他子树的节点

等等。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2008-09-24T16:19:33.757

将电子表格列索引转换为列名。

这比听起来更棘手，因为电子表格列不能正确处理“0”数字。例如，如果在从 Z 递增到 AA 时将 AZ 作为数字，这就像从 9 到 11 或从 9 到 00 而不是 10（取决于 A 是 1 还是 0）。即使是[Microsoft 支持示例](http://support.microsoft.com/kb/833402)，对于高于 AAA 的任何内容都出错了！

递归解决方案之所以有效，是因为您可以在那些新数字边界上进行递归。此实现在 VB.Net 中，并将第一列 ('A') 视为索引 1。

```
Function ColumnName(ByVal index As Integer) As String
    Static chars() As Char = {"A"c, "B"c, "C"c, "D"c, "E"c, "F"c, "G"c, "H"c, "I"c, "J"c, "K"c, "L"c, "M"c, "N"c, "O"c, "P"c, "Q"c, "R"c, "S"c, "T"c, "U"c, "V"c, "W"c, "X"c, "Y"c, "Z"c}

    index -= 1 'adjust index so it matches 0-indexed array rather than 1-indexed column'

    Dim quotient As Integer = index \ 26 'normal / operator rounds. \ does integer division'
    If quotient > 0 Then
        Return ColumnName(quotient) & chars(index Mod 26)
    Else
        Return chars(index Mod 26)
    End If
End Function 
```

# java - Qt Jambi：QAbstractListModel 未在 QListView 中显示

> ID：126759
> 
> 赞同：1
> 
> 时间：2008-09-24T12:17:12.963
> 
> 标签：java, qt, qt-jambi, qabstractlistmodel

我已经在 Qt Jambi 4.4 中创建了`QAbstractListModel`该类的实现，并且发现使用带有 a 的模型`QListView`不会显示任何内容，但是使用带有 a 的模型可以`QTableView`正确显示数据。

以下是我的实现`QAbstractListModel`：

```
public class FooListModel extends QAbstractListModel
{
    private List<Foo> _data = new Vector<Foo>();

    public FooListModel(List<Foo> data)
    {
        if (data == null)
        {
            return;
        }

        for (Foo foo : data)
        {
            _data.add(Foo);
        }

        reset();
    }

    public Object data(QModelIndex index, int role)
    {
        if (index.row() < 0 || index.row() >= _data.size())
        {
            return new QVariant();
        }

        Foo foo = _data.get(index.row());

        if (foo == null)
        {
            return new QVariant();
        }

        return foo;
    }

    public int rowCount(QModelIndex parent)
    {
        return _data.size();
    }
} 
```

这是我设置模型的方式：

```
Foo foo = new Foo();
foo.setName("Foo!");

List<Foo> data = new Vector<Foo>();
data.add(foo);

FooListModel fooListModel = new FooListModel(data);
ui.fooListView.setModel(fooListModel);
ui.fooTableView.setModel(fooListModel); 
```

谁能看到我做错了什么？我想这是我的实现的问题，因为正如每个人所说，选择并没有坏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T23:40:33.227

我在占碑没有经验，但是您不应该从方法 data() 返回 QVariant 而不是返回 Foo 吗？我不清楚视图如何知道如何将 Foo 转换为字符串以进行显示。

此外，我是否有机会向您出售更易于使用的 QStandardModel 和 QStandardModelItem，而不是艰难地推出完全定制的产品？如果你只拥有一个视图，你可以完全避免整个 MVC 模式，而只使用非常非常容易使用的 QListWidget。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-04T22:43:13.390

您的模型的 data() 实现有两个问题：

*   它无法为不同的项目数据角色提供不同的值。您当前的实现为所有角色返回相同的值，并且某些视图可能会出现问题。

*   Jambi 中的 QVariant 与常规 Qt 中的不同。当你没有什么可以返回的时候，
    就返回`null`。

更好的实现是：

```
public Object data(QModelIndex index, int role) {
    if (index.row() < 0 || index.row() >= _data.size())
        return null;

    if (role != Qt.ItemDataRole.DisplayRole)
        return null;

    return _data.get(index.row());
} 
```

# html - 如何强制网络浏览器不缓存图像

> ID：126772
> 
> 赞同：136
> 
> 时间：2008-09-24T12:19:18.187
> 
> 标签：html, image, caching, browser-cache, image-caching

## 背景

我正在为两个公益网站编写和使用一个非常简单的基于 CGI (Perl) 的内容管理工具。它为网站管理员提供了用于填写字段（日期、地点、标题、描述、链接等）并保存的事件的 HTML 表单。在该表单上，我允许管理员上传与该事件相关的图像。在显示表单的 HTML 页面上，我还显示了上传图片的预览（HTML img 标记）。

## 问题

当管理员想要更改图片时，就会出现问题。他只需点击“浏览”按钮，选择一张新图片，然后按确定。这很好用。

上传图片后，我的后端 CGI 会处理上传并正确重新加载表单。

问题是显示的图像**没有**刷新。即使数据库拥有正确的图像，旧图像仍会显示。我已将其范围缩小到图像被缓存在网络浏览器中的事实。如果管理员在 Firefox/Explorer/Safari 中点击 RELOAD 按钮，一切都会正常刷新，新图像就会出现。

## 我的解决方案 - 不工作

我试图通过编写一个日期很远的 HTTP Expires 指令来控制缓存。

```
Expires: Mon, 15 Sep 2003 1:00:00 GMT 
```

请记住，我在管理方面，我并不关心页面是否需要更长的时间来加载，因为它们总是过期的。

但是，这也不起作用。

## 笔记

上传图像时，其文件名不会保存在数据库中。它被重命名为**Image.jpg**（在使用它时简单地说明一下）。用新图像替换现有图像时，名称也不会改变。只是图像文件的内容发生了变化。

网络服务器由托管服务/ISP 提供。它使用 Apache。

## 问题

有没有办法强制网络浏览器不缓存此页面的内容，甚至不缓存图像？

我正在处理使用数据库实际“保存文件名”的选项。这样，如果图片改变了，IMG标签的src也会改变。但是，这需要整个站点进行大量更改，如果我有更好的解决方案，我宁愿不这样做。此外，如果上传的新图像具有相同的名称，这仍然不起作用（例如图像经过了一些照片处理并重新上传）。

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2008-09-24T12:27:06.420

Armin Ronacher 的想法是正确的。问题是随机字符串可能会发生冲突。我会使用：

```
<img src="picture.jpg?1222259157.415" alt=""> 
```

其中“1222259157.415”是服务器上的当前时间。
通过 Javascript`performance.now()`或 Python生成时间`time.time()`

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-09-24T12:20:36.000

简单修复：将随机查询字符串附加到图像：

```
<img src="foo.cgi?random=323527528432525.24234" alt=""> 
```

HTTP RFC 所说的：

```
Cache-Control: no-cache 
```

但这并没有那么好:)

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-09-17T04:04:44.613

我使用[PHP的文件修改时间函数](http://php.net/filemtime)，例如：

```
echo <img  src='Images/image.png?" . filemtime('Images/image.png') . "'  />"; 
```

如果您更改图像，则使用新图像而不是缓存的图像，因为具有不同的修改时间戳。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-09-10T01:33:46.040

我会使用：

```
<img src="picture.jpg?20130910043254"> 
```

其中“20130910043254”是文件的修改时间。

> 上传图像时，其文件名不会保存在数据库中。它被重命名为 Image.jpg（在使用它时简单地说明一下）。用新图像替换现有图像时，名称也不会改变。只是图像文件的内容发生了变化。

我认为有两种简单的解决方案：1）首先想到的那些（直截了当的解决方案，因为它们很容易提出），2）您在考虑之后最终得出的那些（因为它们很容易采用）。显然，如果您选择重新考虑，您将不会总是受益。但我相信第二种选择被低估了。想想为什么`php`这么受欢迎；）

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-12-30T17:32:19.330

使用**Class="NO-CACHE"**

示例 html：

```
<div>
    <img class="NO-CACHE" src="images/img1.jpg" />
    <img class="NO-CACHE" src="images/imgLogo.jpg" />
</div> 
```

jQuery：

```
 $(document).ready(function ()
    {           
        $('.NO-CACHE').attr('src',function () { return $(this).attr('src') + "?a=" + Math.random() });
    }); 
```

javascript:

```
var nods = document.getElementsByClassName('NO-CACHE');
for (var i = 0; i < nods.length; i++)
{
    nods[i].attributes['src'].value += "?a=" + Math.random();
} 
```

结果：src="images/img1.jpg" **=>** src="images/img1.jpg?a=0.08749723793963926"

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-24T12:48:51.203

您可以编写一个代理脚本来提供图像——不过这需要更多的工作。像这样的东西：

HTML：

```
<img src="image.php?img=imageFile.jpg&some-random-number-262376" /> 
```

脚本：

```
// PHP
if( isset( $_GET['img'] ) && is_file( IMG_PATH . $_GET['img'] ) ) {

  // read contents
  $f = open( IMG_PATH . $_GET['img'] );
  $img = $f.read();
  $f.close();

  // no-cache headers - complete set
  // these copied from [php.net/header][1], tested myself - works
  header("Expires: Sat, 26 Jul 1997 05:00:00 GMT"); // Some time in the past
  header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT"); 
  header("Cache-Control: no-store, no-cache, must-revalidate"); 
  header("Cache-Control: post-check=0, pre-check=0", false); 
  header("Pragma: no-cache"); 

  // image related headers
  header('Accept-Ranges: bytes');
  header('Content-Length: '.strlen( $img )); // How many bytes we're going to send
  header('Content-Type: image/jpeg'); // or image/png etc

  // actual image
  echo $img;
  exit();
} 
```

实际上，图像 src 中的无缓存标头或随机数应该就足够了，但是因为我们想要防弹..

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-11-19T02:39:40.513

我检查了网络上的所有答案，最好的答案似乎是：（实际上不是）

```
<img src="image.png?cache=none"> 
```

首先。

但是，如果您添加**cache=none**参数（这是静态“无”字），它不会影响任何东西，浏览器仍然从缓存加载。

这个问题的解决方案是：

```
<img src="image.png?nocache=<?php echo time(); ?>"> 
```

您基本上添加了unix时间戳以使参数动态且没有缓存，它起作用了。

但是，我的问题有点不同：我正在加载动态生成的 php 图表图像，并使用 $_GET 参数控制页面。我希望在 URL GET 参数保持不变时从缓存中读取图像，并且在 GET 参数更改时不缓存。

为了解决这个问题，我需要散列 $_GET 但因为它是数组，所以这里是解决方案：

```
$chart_hash = md5(implode('-', $_GET));
echo "<img src='/images/mychart.png?hash=$chart_hash'>"; 
```

**编辑**：

尽管上述解决方案工作得很好，但有时您希望在文件更改之前提供缓存版本。（使用上述解决方案，它会完全禁用该图像的缓存）因此，要从浏览器提供缓存图像，直到图像文件使用发生变化：

```
echo "<img src='/images/mychart.png?hash=" . filemtime('mychart.png') . "'>"; 
```

> filemtime() 获取文件修改时间。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-03-31T16:40:05.427

我是一名新的编码员，但这是我想出的，以阻止浏览器缓存并保留我的网络摄像头视图：

```
<meta Http-Equiv="Cache" content="no-cache">
<meta Http-Equiv="Pragma-Control" content="no-cache">
<meta Http-Equiv="Cache-directive" Content="no-cache">
<meta Http-Equiv="Pragma-directive" Content="no-cache">
<meta Http-Equiv="Cache-Control" Content="no-cache">
<meta Http-Equiv="Pragma" Content="no-cache">
<meta Http-Equiv="Expires" Content="0">
<meta Http-Equiv="Pragma-directive: no-cache">
<meta Http-Equiv="Cache-directive: no-cache"> 
```

不确定什么适用于什么浏览器，但它确实适用于某些浏览器：IE：在刷新网页和重新访问网站时工作（不刷新）。CHROME：仅在刷新网页时有效（即使在重新访问之后）。SAFARI 和 iPad：不起作用，我必须清除历史记录和网络数据。

对 SAFARI/iPad 有什么想法吗？

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-25T02:09:45.007

> 上传图像时，其文件名不会保存在数据库中。它被重命名为 Image.jpg（在使用它时简单地说明一下）。

改变这个，你就解决了你的问题。我使用时间戳，就像上面提出的解决方案一样：**Image-<timestamp>.jpg**

据推测，通过为图像保留相同的文件名而避免的任何问题都可以克服，但你没有说它们是什么。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-03-15T21:30:17.953

您的问题是，尽管有`Expires:`标题，但您的浏览器正在重新使用更新之前的图像内存副本，而不是检查其缓存。

我在管理后端为类似商店的网站上传产品图片时遇到了非常相似的情况，就我而言，我认为最好的选择是使用 javascript 来强制刷新图片，而不使用其他人的任何 URL 修改技术这里已经提到了。相反，我将图像 URL 放入隐藏的 IFRAME，`location.reload(true)`在 IFRAME 的窗口中调用，然后在页面上替换我的图像。这会强制刷新图像，不仅在我所在的页面上，而且在我访问的任何后续页面上 - 客户端或服务器都不必记住任何 URL 查询字符串或片段标识符参数。

我在[这里](https://stackoverflow.com/a/22429796/999120 "我的回答：在相同的 url 上用新的图像刷新图像")的答案中发布了一些代码来执行此操作。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-11-25T11:50:53.317

从我的角度来看，禁用图像缓存是一个坏主意。完全没有。

这里的根本问题是 - 如何在服务器端更新图像时强制浏览器更新图像。

同样，从我个人的角度来看，最好的解决方案是禁用对图像的直接访问。而是通过服务器端过滤器/servlet/其他类似工具/服务访问图像。

在我的情况下，它是一个休息服务，它返回图像并附加 ETag 作为响应。该服务保留所有文件的哈希，如果文件更改，则更新哈希。它在所有现代浏览器中都能完美运行。是的，实施它需要时间，但这是值得的。

唯一的例外 - 是网站图标。由于某些原因，它不起作用。我无法强制浏览器从服务器端更新其缓存。ETags、Cache Control、Expires、Pragma headers，没有任何帮助。

在这种情况下，似乎在 url 中添加一些随机/版本参数是唯一的解决方案。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-01-10T15:28:55.530

添加时间戳`<img src="picture.jpg?t=<?php echo time();?>">`

总是会在最后给你的文件一个随机数并停止缓存

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-24T12:24:02.933

由于您和客户端之间可能存在行为不良的透明代理，因此完全保证图像不会被缓存的唯一方法是给它们一个唯一的 uri，例如将时间戳标记为查询字符串或作为小路。

如果该时间戳对应于图像的最后更新时间，那么您可以在需要时缓存并在正确的时间提供新图像。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-02-21T15:32:19.887

我假设原始问题与存储有一些文本信息的图像有关。因此，如果您在生成 src=... url 时可以访问文本上下文，请考虑存储/使用图像字节的 CRC32，而不是无意义的随机或时间戳。然后，如果显示有大量图像的页面，则只会重新加载更新的图像。最终，如果 CRC 存储是不可能的，它可以在运行时计算并附加到 url。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-10-17T16:28:07.200

理想情况下，您应该为每个网页添加一个按钮/键绑定/菜单，并带有同步内容的选项。

为此，您将跟踪可能需要同步的资源，并使用 xhr 使用动态查询字符串探测图像，或者在运行时使用 src 使用动态查询字符串创建图像。然后使用广播机制通知正在使用该资源的网页的所有组件更新以使用附加到其 url 的动态查询字符串的资源。

一个天真的示例如下所示：

通常，图像会显示并缓存，但如果用户按下按钮，则会向资源发送一个 xhr 请求，并附加一个时间查询字符串；由于可以假设每次按下的时间都不同，因此它将确保浏览器将绕过缓存，因为它无法判断资源是基于查询在服务器端动态生成的，还是静态的忽略查询的资源。

结果是您可以避免让所有用户一直用资源请求轰炸您，但同时，允许用户在怀疑资源不同步时更新其资源的机制。

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="mobile-web-app-capable" content="yes" />        
    <title>Resource Synchronization Test</title>
    <script>
function sync() {
    var xhr = new XMLHttpRequest;
    xhr.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {            
            var images = document.getElementsByClassName("depends-on-resource");

            for (var i = 0; i < images.length; ++i) {
                var image = images[i];
                if (image.getAttribute('data-resource-name') == 'resource.bmp') {
                    image.src = 'resource.bmp?i=' + new Date().getTime();                
                }
            }
        }
    }
    xhr.open('GET', 'resource.bmp', true);
    xhr.send();
}
    </script>
  </head>
  <body>
    <img class="depends-on-resource" data-resource-name="resource.bmp" src="resource.bmp"></img>
    <button onclick="sync()">sync</button>
  </body>
</html> 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-02-18T09:35:43.810

您必须使用唯一的文件名。像这样

```
<img src="cars.png?1287361287" alt=""> 
```

但是这种技术意味着高服务器使用率和带宽浪费。相反，您应该使用版本号或日期。例子：

```
<img src="cars.png?2020-02-18" alt=""> 
```

但是您希望它永远不会从缓存中提供图像。为此，**如果页面不使用页面缓存**，则可以使用 PHP 或服务器端。

```
<img src="cars.png?<?php echo time();?>" alt=""> 
```

但是，它仍然没有效果。原因：浏览器缓存...最后但最有效的方法是 Native JAVASCRIPT。这个简单的代码**查找所有**具有“NO-CACHE”类的图像，并使图像几乎是唯一的。把它放在脚本标签之间。

```
var items = document.querySelectorAll("img.NO-CACHE");
for (var i = items.length; i--;) {
    var img = items[i];
    img.src = img.src + '?' + Date.now();
} 
```

用法

```
<img class="NO-CACHE" src="https://upload.wikimedia.org/wikipedia/commons/6/6a/JavaScript-logo.png" alt=""> 
```

结果像这样

```
https://example.com/image.png?1582018163634 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-02-02T11:06:58.577

所有答案都是有效的，因为它工作正常。但是这样一来，浏览器也会在每次使用不同的 URL 加载该图像时在缓存中创建另一个文件。因此，不要通过向 URL 添加一些查询参数来更改 URL。我认为我们应该更新浏览器缓存。

```
caches.open('YOUR_CACHE_NAME').then(cache => {
  const url = 'URL_OF_IMAGE_TO_UPDATE'
  fetch(url).then(res => {
    cache.put(url, res.clone())
  })
}) 
```

`cache.put`用新的响应更新缓存。

更多信息：[https ://developer.mozilla.org/en-US/docs/Web/API/Cache/put](https://developer.mozilla.org/en-US/docs/Web/API/Cache/put)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2019-12-30T14:28:55.253

我制作了一个 PHP 脚本，它会自动在所有图像和链接上附加时间戳。你只需要在你的页面中包含这个脚本。享受！

[http://alv90.altervista.org/how-to-force-the-browser-not-to-cache-images/](http://alv90.altervista.org/how-to-force-the-browser-not-to-cache-images/)

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2021-05-03T11:19:56.527

最好的解决方案是在源 href 的末尾提供当前时间，例如 `<img src="www.abc.com/123.png?t=current_time">`

这将消除引用已经缓存图像的机会。要获取最近的时间，可以使用`performance.now()`jQuery 或 javascript 中的函数。

# c# - C# 中的 C++ 联合

> ID：126781
> 
> 赞同：82
> 
> 时间：2008-09-24T12:20:32.800
> 
> 标签：c#, c++, unions

我正在将一个用 C++ 编写的库翻译成 C#，并且关键字“union”存在一次。在一个结构中。

将它翻译成 C# 的正确方法是什么？它有什么作用？它看起来像这样；

```
struct Foo {
    float bar;

    union {
        int killroy;
        float fubar;
    } as;
} 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-09-24T12:24:41.107

您可以为此使用显式字段布局：

```
[StructLayout(LayoutKind.Explicit)] 
public struct SampleUnion
{
    [FieldOffset(0)] public float bar;
    [FieldOffset(4)] public int killroy;
    [FieldOffset(4)] public float fubar;
} 
```

未经测试。这个想法是两个变量在你的结构中具有相同的位置。当然，您只能使用其中之一。

[结构教程](http://msdn.microsoft.com/en-us/library/aa288471(VS.71).aspx)中有关联合的更多信息

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-24T15:37:33.013

如果不了解它的使用方式，您将无法真正决定如何处理它。如果它只是用来节省空间，那么你可以忽略它而只使用一个结构。

然而，这通常不是使用联合的原因。使用它们有两个常见的原因。一种是提供两种或多种方式来访问相同的数据。例如，int 和 4 字节数组的联合是分离 32 位整数字节的一种（多种）方法。

另一种是结构中的数据来自外部源，例如网络数据包。通常，包含联合的结构的一个元素是一个 ID，它告诉您联合的哪种风格有效。

在这两种情况下，您都不能盲目地忽略联合并将其转换为两个（或更多）字段不重合的结构。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-24T12:25:03.337

在 C/C++ 中，联合用于覆盖同一内存位置中的不同成员，所以如果你有一个 int 和一个 float 的联合，它们都使用相同的 4 字节内存来存储，显然写入一个会破坏另一个（因为int 和 float 有不同的位布局）。

在 .Net 中，Microsoft 选择了更安全的选择，并且没有包含此功能。

编辑：除了互操作

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-21T10:47:51.417

如果您使用 将`union`其中一种类型的字节映射到另一种类型，则可以在 C# 中使用`BitConverter`。

```
float fubar = 125f; 
int killroy = BitConverter.ToInt32(BitConverter.GetBytes(fubar), 0); 
```

或者;

```
int killroy = 125;
float fubar = BitConverter.ToSingle(BitConverter.GetBytes(killroy), 0); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T12:34:54.920

就个人而言，我会一起忽略 UNION 并将 Killroy 和 Fubar 实现为单独的字段

```
public struct Foo
{
    float bar;
    int Kilroy;
    float Fubar;
} 
```

使用 UNION 可以节省 32 位由 int 分配的内存......这些天不会制造或破坏应用程序。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2018-06-29T08:49:51.633

```
public class Foo
{
    public float bar;
    public int killroy;

    public float fubar
    {
        get{ return (float)killroy;}
        set{ killroy = (int)value;}
    }
} 
```

# python - 检查所有导入的 python 模块中的代码更改

> ID：126787
> 
> 赞同：2
> 
> 时间：2008-09-24T12:21:02.957
> 
> 标签：python

几乎每个 Python Web 框架都有一个简单的服务器，它运行一个 wsgi 应用程序，并在每次更改源时自动重新加载导入的模块。我知道我可以查看代码并了解它是如何完成的，但这可能需要一些时间，我只是出于好奇而询问。有谁知道这是如何实现的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T12:28:50.253

作为一种重新加载机制（werkzeug 中的机制）的作者，我可以告诉你它不起作用。如果监视器线程注意到文件系统上的一个模块发生了变化，所有重新加载器所做的就是分叉一次并重新启动子进程。

内联`reload()`不起作用，因为对重新加载模块的引用没有更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:34:47.570

reload() 不起作用。“重载”通常是通过分叉来实现的。

实现“真正的” reload() 非常困难，即使是最认真的尝试，[twisted.python.rebuild](http://twistedmatrix.com/documents/current/api/twisted.python.rebuild.html)也不完美。

# f# - 如果您已经了解 LISP，为什么还要学习 F#？

> ID：126790
> 
> 赞同：7
> 
> 时间：2008-09-24T12:22:03.623
> 
> 标签：f#, functional-programming, lisp

当您已经熟悉 LISP 时，学习 F# 的附加值是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-24T19:41:23.130

*   [静态类型](http://research.microsoft.com/fsharp/manual/quicktour.aspx#QuickTourTypes)（带类型推断）
*   [代数数据类型](http://research.microsoft.com/fsharp/manual/quicktour.aspx#QuickTourDiscriminatedUnions)
*   [模式匹配](http://research.microsoft.com/fsharp/manual/quicktour.aspx#QuickTourPatterns)
*   与活动模式[匹配的可扩展模式。](http://blogs.msdn.com/dsyme/archive/2007/04/07/draft-paper-on-f-active-patterns.aspx)
*   柯里化（语法很好）
*   [一元编程](http://blogs.msdn.com/dsyme/archive/2007/10/11/introducing-f-asynchronous-workflows.aspx)，称为“工作流”，提供了一种很好的异步编程方式。

其中很多是编程语言世界中相对较新的发展。这是您将在 F# 中看到而在 Lisp 中不会看到的东西，尤其是 Common Lisp，因为 F# 标准仍在开发中。结果，你会发现有很多东西要学。当然，像 ADT、模式匹配、monad 和柯里化这样的东西可以在 Lisp 中构建为一个库，但是学习如何在方便内置的语言中使用它们会更好。

学习 F# 以供实际使用的最大优势在于它与 .NET 的集成。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T16:45:55.267

将 Lisp 直接与 F# 进行比较并不公平，因为最终只要有足够的时间，您就可以用任何一种语言编写相同的应用程序。

但是，**您应该学习 F#，原因与 C# 或 Java 开发人员应该学习它的原因相同——因为它允许在 .NET 平台上进行函数式编程**。我对 Lisp 不是 100% 熟悉，但我认为它与 OCaml 有一些相同的问题，因为没有一流的库支持。你如何在 Lisp 中进行数据库访问？那么高性能显卡呢？

如果您想了解有关“为什么使用 .NET”的更多信息，请查看这个[SO 问题](https://stackoverflow.com/questions/3999/why-use-net#4015)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-25T21:28:37.860

如果您了解 F# 和 Lisp，您会发现这是一个相当奇怪的问题。

正如其他人指出的那样，Lisp 是**动态类型**的。更重要的是，Lisp 的独特之处在于它是谐音的：**Lisp 代码是一种基本的 Lisp 数据类型**（列表）。宏系统通过让您编写**在编译时执行并修改其他代码的代码来**利用这一点。

F# 没有这样的东西 - 它是一种静态类型语言，它借鉴了 ML 和 Haskell 的许多想法，并在 .NET 上运行

你的问题类似于“如果我知道如何使用叉子，为什么我需要学习使用勺子？”

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-24T12:28:35.417

鉴于 LISP 是动态类型的，而 F# 是静态类型的，我觉得这样的比较很奇怪。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-24T12:29:19.627

如果我从 Lisp 切换到 F#，那完全是因为我手头有一项任务，该任务极大地受益于一些仅限 .NET 的库。

但我没有，所以我不是。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-19T04:17:40.513

钱。F# 代码已经比 Lisp 代码更有价值，并且随着 F# 的广泛采用，这种差距将迅速扩大。

换句话说，与使用 Lisp 相比，使用 F# 获得稳定收入的机会要大得多。

干杯，乔恩·哈罗普。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-25T21:19:53.183

与大多数 Lisp 方言相比，F# 是一种非常不同的语言。所以 F# 为您提供了一个非常不同的编程角度——一个您不会从 Lisp 中学到的角度。大多数 Lisp 方言最适合用于符号软件的增量式交互式开发。同时，大多数 Lisp 方言不是函数式编程语言，而更像是多范式语言——不同的方言对支持 FPL 功能的重视程度不同（无副作用、不可变数据结构、代数数据类型……）。因此，大多数 Lisp 方言要么缺乏静态类型，要么不太重视它。

所以，如果你知道一些 Lisp 方言，那么学习 F# 会很有意义。只是不要认为你的 Lisp 知识大部分适用于 F#，因为 F# 是一种非常不同的语言。就像使用 C 或 Java 的命令式编程在学习 Lisp 时需要忘记一些想法一样，在使用 F# 时也需要忘记 Lisp 习惯（无类型、副作用、宏......）。F# 也由 Microsoft 驱动并利用 .net 框架。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-25T21:34:03.010

F# 的好处是 .NET 开发（通常）被非常广泛地采用、易于获得并且更大众市场。

如果您想编写 F# 代码，您可以获得 Visual Studio，许多开发人员已经拥有它……而不是让 LISP 环境启动并运行。

此外，现有的 .NET 开发人员更倾向于关注 F# 而不是 LISP，如果这对您来说意味着什么的话。

（这来自一位 .NET 开发人员，他在大学期间编写并喜爱 LISP）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-24T19:56:08.960

我不确定你会不会？如果您觉得 F# 有趣，那将是一个原因。如果您的工作需要它，那将是一个原因。如果您认为它会使您更有效率或为您当前的知识带来附加值，那将是一个原因。

但是，如果您不觉得 F# 有趣，您的工作不需要它，并且您认为它不会提高您的工作效率或为您带来附加值，那么您为什么会这样做呢？

另一方面，如果问题是 F# 为 lisp 提供了什么，那么应该考虑类型推断、模式匹配以及与 .NET 框架的其余部分的集成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-01-12T20:17:55.197

我知道这个帖子很旧，但自从我偶然发现这个帖子后，我只想评论一下我的原因。我学习 F# 只是为了获得专业机会，因为 .NET 在主导我所在领域的一类公司中占有重要地位。功能范式在更多以定量和数据为导向的公司中的使用越来越多，我想成为这一趋势的先行者之一。目前不存在与 .NET 库完全安全集成的强大功能语言。我实际上试图从 Lisp 代码中移植一些 .NET，这真的很痛苦，因为 FFI 只支持 C 原语，而 .NET 互操作性需要一个“接口”结构，即使我知道如何在 C 中做到这一点，它确实是一个巨大的痛。这将是真的，真的，如果 Lisp 在它的下一个标准中加倍努力，并且需要一个 c++ 类（包括带有 vtables 的虚函数），以及它的 FFI 中的 C# 样式接口类型，那就太好了。甚至还可以引入 Java 接口样式类型。这将实现与 .NET 库的完全互操作性，并使 Lisp 作为一种大规模语言成为强有力的竞争者。然而话虽如此，来自 Lisp 背景使得学习 F# 变得相当容易。而且我喜欢 F# 如何付出额外的努力来提供您通常会看到的定量类型工作的类型。我相信 F# 是在考虑数学工作的情况下创建的，并且它本身比 Lisp 更有价值。这将实现与 .NET 库的完全互操作性，并使 Lisp 作为一种大规模语言成为强有力的竞争者。然而话虽如此，来自 Lisp 背景使得学习 F# 变得相当容易。而且我喜欢 F# 如何付出额外的努力来提供您通常会看到的定量类型工作的类型。我相信 F# 是在考虑数学工作的情况下创建的，并且它本身比 Lisp 更有价值。这将实现与 .NET 库的完全互操作性，并使 Lisp 作为一种大规模语言成为强有力的竞争者。然而话虽如此，来自 Lisp 背景使得学习 F# 变得相当容易。而且我喜欢 F# 如何付出额外的努力来提供您通常会看到的定量类型工作的类型。我相信 F# 是在考虑数学工作的情况下创建的，并且它本身比 Lisp 更有价值。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-03-16T02:22:11.867

看待这个（原始问题）的一种方法是将语言（以及相关的工具和平台）与直接任务相匹配。如果该任务需要绝大多数 .NET 代码，并且在一种语言中比另一种语言需要更少的鞋拔来完成任务，那么选择阻力最小的路径 (F#)。如果您不需要 .NET 功能，并且您对使用 LISP 感到很自在，并且无需弯腰摆脱它，请继续使用它。

与比较锤子和扳手并没有太大区别。选择最适合工作的工具。试图选择一个客观上“最好”的工具是无稽之谈。无论如何，在 20 年内，所有当前“热门”的语言都可能已经过时了。

# sql - 找到两个连续的行

> ID：126794
> 
> 赞同：5
> 
> 时间：2008-09-24T12:22:53.607
> 
> 标签：sql, sql-server, database

我正在尝试编写一个查询，该查询将从 Bill 表中拉回 Estimated 标志为 true 的最近两行。问题是这些必须是连续的账单。

简而言之，如果在最后两个账单周期估计了账单，我需要在另一个表中输入一行。

如果可能的话，我想在没有游标的情况下执行此操作，因为我正在处理大量数据并且必须经常运行。

**编辑**

表上有一个 AUTOINCREMENT(1,1) 列。在不放弃太多表结构的情况下，表本质上是这样的结构：

```
 CREATE TABLE Bills (
  BillId INT AUTOINCREMENT(1,1,) PRIMARY KEY,
  Estimated BIT NOT NULL,
  InvoiceDate DATETIME NOT NULL
) 
```

因此，您可能会得到一组结果，例如：

```
BillId AccountId 估计发票日期
-------------------- -------------------- --------- - ----------------------
1111196 1234567 1 2008-09-03 00:00:00.000
1111195 1234567 0 2008-08-06 00:00:00.000
1111194 1234567 0 2008-07-03 00:00:00.000
1111193 1234567 0 2008-06-04 00:00:00.000
1111192 1234567 1 2008-05-05 00:00:00.000
1111191 1234567 0 2008-04-04 00:00:00.000
1111190 1234567 1 2008-03-05 00:00:00.000
1111189 1234567 0 2008-02-05 00:00:00.000
1111188 1234567 1 2008-01-07 00:00:00.000
1111187 1234567 1 2007-12-04 00:00:00.000
1111186 1234567 0 2007-11-01 00:00:00.000
1111185 1234567 0 2007-10-01 00:00:00.000
1111184 1234567 1 2007-08-30 00:00:00.000
1111183 1234567 0 2007-08-01 00:00:00.000
1111182 1234567 1 2007-07-02 00:00:00.000
1111181 1234567 0 2007-06-01 00:00:00.000
1111180 1234567 1 2007-05-02 00:00:00.000
1111179 1234567 0 2007-03-30 00:00:00.000
1111178 1234567 1 2007-03-02 00:00:00.000
1111177 1234567 0 2007-02-01 00:00:00.000
1111176 1234567 1 2007-01-03 00:00:00.000
1111175 1234567 0 2006-11-29 00:00:00.000

```

在这种情况下，只有记录 1111188 和 1111187 是连续的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-24T12:29:35.807

假设行具有顺序 ID，您可能正在寻找类似这样的内容：

```
select top 1 * 
from 
Bills b1
inner join Bills b2 on b1.id = b2.id - 1
where
b1.IsEstimate = 1 and b2.IsEstimate = 1
order by
b1.BillDate desc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T12:26:55.517

```
select top 2 * 
from bills
where estimated = 1 
order by billdate desc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T12:25:26.970

您应该能够对估计 = true 进行降序排序查询并选择前 2 个。我不是最擅长 SQL，所以我无法给出确切的语言结构

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T12:26:29.387

您是否有“报表编号”列，例如，如果 Q12008 是特定客户的报表 28，那么 Q22008 的账单将为 29，Q32008 的账单将为 30（假设按季度计费）。然后，您可以检查报表编号是否相邻，而不必进行日期操作。

# java - Java：无效的密钥库格式错误

> ID：126798
> 
> 赞同：4
> 
> 时间：2008-09-24T12:23:19.283
> 
> 标签：java, keystore

有谁知道如何解决这个java错误？

```
java.io.IOException: Invalid keystore format 
```

当我尝试从控制面板中的 Java 选项访问证书存储时，我得到了它。它阻止我加载需要提升权限的小程序。

[错误图像](http://img72.imageshack.us/my.php?image=javaerrorxq7.jpg)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T13:01:58.457

我能够通过修改目录中的trusted.certs 文件来重现该错误

`C:\Documents and Settings\CDay\Application Data\Sun\Java\Deployment\security`.

删除文件解决了问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T12:37:53.433

不要在组织名称和单位中包含特殊字符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T12:44:31.667

似乎是缺少证书或格式无效。您是否已经使用 keytool 生成了证书？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-11T20:43:36.127

对我来说，这意味着我尝试导入的密钥文件无效（实际上是 404 页面，不是有效的密钥）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-02T14:33:11.020

对于找不到“文档和设置”（无论可能是什么原因）的你们，这里是可以找到trusted.certs 的另一条路径：

```
C:\Users\<username>\AppData\LocalLow\Sun\Java\Deployment\security 
```

希望这可以帮助！

# c++ - 有没有办法确定是否发生异常？

> ID：126800
> 
> 赞同：1
> 
> 时间：2008-09-24T12:23:43.137
> 
> 标签：c++, exception, exception-handling, destructor

在析构函数中，有没有办法确定当前是否正在处理异常？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-24T12:29:34.760

您可以使用 std::uncaught_exception()，但它可能不会像您认为的那样做：有关更多信息，请参阅[GoTW#47](http://www.gotw.ca/gotw/047.htm "GoTW#47")。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T14:53:05.070

正如 Luc 所说，您可以使用 std::uncaught_exception()。但你为什么想知道？在任何情况下，[析构函数都不应该抛出异常](http://www.parashift.com/c++-faq-lite/exceptions.html#faq-17.3)！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T12:57:07.020

您可以使用[Boost 测试库](http://www.boost.org/doc/libs/1_31_0/libs/test/doc/index.html)。看这里的一个小例子：

```
struct my_exception1
{
    explicit    my_exception1( int res_code ) : m_res_code( res_code ) {}
    int         m_res_code;
};

struct my_exception2
{
    explicit    my_exception2( int res_code ) : m_res_code( res_code ) {}
    int         m_res_code;
};

class dangerous_call {
public:
    dangerous_call( int argc ) : m_argc( argc ) {}
    int operator()()
    {
        if( m_argc < 2 )
            throw my_exception1( 23 );
        if( m_argc > 3 )
            throw my_exception2( 45 );
        else if( m_argc > 2 )
            throw "too many args";

        return 1;
    }

private:
    int     m_argc;
};

void translate_my_exception1( my_exception1 const& ex )
{
    std::cout << "Caught my_exception1(" << ex.m_res_code << ")"<< std::endl;
}

void translate_my_exception2( my_exception2 const& ex )
{
    std::cout << "Caught my_exception2(" << ex.m_res_code << ")"<< std::endl;
}

int 
cpp_main( int argc , char *[] )
{ 
    ::boost::execution_monitor ex_mon;
    ex_mon.register_exception_translator<my_exception1>(
        &translate_my_exception1);
    ex_mon.register_exception_translator<my_exception2>(
        &translate_my_exception2);
    try{
     // ex_mon.detect_memory_leak( true);
      ex_mon.execute( ::boost::unit_test::callback0<int>( 
          dangerous_call( argc ) ) );
    }   
    catch ( boost::execution_exception const& ex ) {
        std::cout << "Caught exception: " << ex.what() << std::endl;
    }
    return 0;
} 
```

您必须深入研究文档。这是一个非常强大的库来测试你的软件！无论如何，在 Boost 的帮助下，您可以在功能测试的任何地方捕获任何类型的异常！

# ruby-on-rails - Ruby on Rails - 为什么要使用测试？

> ID：126801
> 
> 赞同：14
> 
> 时间：2008-09-24T12:23:45.600
> 
> 标签：ruby-on-rails, ruby, testing

我对 Ruby on Rails 中的各种测试设备的用途感到困惑。我已经使用这个框架大约 6 个月了，但我从来没有理解它的测试部分。我使用过的唯一测试是 Java 中的 JUnit3，而且只是简短的。

我读过的所有内容都只是显示测试验证。Rails 中的验证不应该正常工作吗？它似乎更像是测试框架而不是测试你的代码。为什么需要测试验证？

此外，测试似乎对代码中的任何更改都非常脆弱。因此，如果您更改模型中的任何内容，则必须更改测试和夹具以匹配。这不违反 DRY 原则吗？

第三，编写测试代码似乎需要很多时间。这正常吗？刷新我的浏览器并查看它是否有效不是更快吗？我已经必须使用我的应用程序来查看它是否正确流动并确保我的 CSS 没有爆炸。为什么手动测试不够？

我以前问过这些问题，但我得到的只是“自动化测试是自动化的”。我很聪明，可以弄清楚自动化任务的优势。我的问题是，与收益相比，编写测试的成本似乎高得离谱。也就是说，欢迎任何详细的回复，因为我可能错过了一两个好处。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-25T00:01:35.720

> Rails 中的验证不应该正常工作吗？它似乎更像是测试框架而不是测试你的代码。为什么需要测试验证？

Rails 中的验证确实有效——事实上，Rails 代码库中有单元测试来确保它。当您测试模型的验证时，您正在测试验证的细节：长度、接受的值等。您要确保代码按预期编写。一些验证是简单的助手，您可能会选择不测试它们，因为“没有人可以搞砸`validates_numericality_of`电话”。真的吗？每个开发人员是否总是记得首先编写它？每个开发人员都不会意外删除错误复制粘贴上的一行吗？在我个人看来，你不需要为 Rails 的验证助手测试每一个最后的值组合，但你需要一行来测试它是否存在并传递了正确的值，

此外，其他验证更复杂，需要大量自定义代码——它们可能需要更彻底的测试。

> 此外，测试似乎对代码中的任何更改都非常脆弱。因此，如果您更改模型中的任何内容，则必须更改测试和夹具以匹配。这不违反 DRY 原则吗？

我不相信它违反了 DRY。他们正在交流（这就是编程，交流）两个非常不同的东西。测试表明代码*应该*做一些事情。代码说明了它*实际上*做了什么。当这些东西之间存在脱节时，测试非常重要。

显然，测试代码和应用程​​序代码密切相关。我认为它们是硬币的两个面。你不会想要没有背面的正面，或者没有正面的背面。好的测试代码强化了好的应用程序代码，反之亦然。两者一起用于理解您要解决的整个问题。编写**良好的测试代码就是文档——它显示了应用程序代码应该如何使用。**

> 第三，编写测试代码似乎需要很多时间。这正常吗？刷新我的浏览器并查看它是否有效不是更快吗？我已经必须使用我的应用程序来查看它是否正确流动并确保我的 CSS 没有爆炸。为什么手动测试不够？

你只参与过非常小的项目，对于这些项目，测试可以说是足够的。但是，当您与多个开发人员、数千或数万行代码、与 Web 服务的集成点、第三方库、多个数据库、数月的开发和需求更改等一起工作时，还有很多其他的因素在起作用。手动测试是不够的。在任何真正复杂的项目中，一个地方的变化往往会在其他地方产生无法预料的结果。适当的架构有助于缓解这个问题，但自动化测试也有助于（并帮助确定可以改进架构的点），因为它可以识别一个地方的更改何时会破坏另一个地方。

> 我的问题是，与收益相比，编写测试的成本似乎高得离谱。也就是说，欢迎任何详细的回复，因为我可能错过了一两个好处。

我将列出更多的好处。

如果您首先进行测试（测试驱动开发），您的代码可能会更好。我还没有遇到一个程序员，他给了它一个可靠的镜头，但事实并非如此。测试首先迫使您思考问题并实际*设计*您的解决方案，而不是破解它。此外，它迫使您充分了解问题域，如果您必须破解它，您知道您的代码在您定义的限制内工作。

如果你有完整的测试覆盖率，你可以毫无风险地重构。如果软件问题非常复杂（同样，持续数月的实际项目往往很复杂），那么您可能希望简化以前编写的代码。因此，您可以编写新代码来替换旧代码，如果它通过了所有测试，那么您就完成了。它与旧代码在测试方面所做的完全一样。对于计划使用敏捷开发方法的项目，重构是绝对必要的。总是需要做出改变。

综上所述，自动化测试，尤其是测试驱动开发，基本上是一种管理软件开发复杂性的方法。如果您的项目不是很复杂，那么成本可能会超过收益（尽管我对此表示怀疑）。然而，现实世界的项目往往非常复杂，测试和 TDD 的结果不言自明：它们有效。

（如果你好奇，我发现 Dan North 关于行为驱动开发的文章对理解测试中的许多价值很有帮助：http: [//dannorth.net/introducing-bdd](http://dannorth.net/introducing-bdd)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T12:57:33.383

测试应该验证您的应用程序逻辑。就个人而言，我认为我最重要的测试是我在 Selenium 中运行的测试。他们检查浏览器中显示的内容是否真的是我期望看到的。但是，如果这就是我所拥有的，那么我会发现很难调试 - 它也有助于进行较低级别的测试，并且集成、功能和单元测试都是有用的工具。单元测试让您检查模型的行为方式是否符合您的预期（这意味着每个方法，而不仅仅是验证）。Validatins 肯定会起作用，但前提是你把它们做对了。如果您弄错了它们，它们将正常工作，但不会按您预期的方式工作。写几行测试比以后调试要快。

一个简单的例子，比如[http://wiseheartdesign.com/2006/01/16/testing-rails-validations](http://wiseheartdesign.com/2006/01/16/testing-rails-validations)只是检查单元测试中的验证。[http://www.oreillynet.com/pub/a/ruby/2007/06/07/rails-testing-not-just-for-the-paranoid.html?page=1](http://www.oreillynet.com/pub/a/ruby/2007/06/07/rails-testing-not-just-for-the-paranoid.html?page=1)上的 O'Reilly 文章有点更完整（虽然仍然相当基本）。

自动化测试在回归测试中特别有用，您可以更改某些内容并运行一组测试以检查您没有破坏其他任何内容。

测试是一种重复形式，但它们并不违反 DRY，因为它们以不同的方式表达事物。测试说“我做了 X，所以 Y 应该发生”。代码说“X 发生了，所以现在我需要做 Z，这恰好导致 Y 发生”。即测试激发原因并检查结果，而代码响应原因并影响某些内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T16:47:44.443

Rails 生成器创建的许多测试教程和示例测试*都*非常蹩脚，恕我直言，这可能会给人一种错误的印象，即您应该测试一些愚蠢的东西，比如内置的 Rails 方法等。

因为 Rails 有它自己的测试套件，所以你编写或运行只测试内置 Rails 功能的测试是没有意义的。您的测试应该练习*您正在*编写的代码！:-)

至于运行测试与仅在浏览器中刷新相比的相对优点。您的应用程序越大，必须手动运行大量场景和边缘情况以确保您的应用程序中没有任何内容，这就越痛苦坏了。最终，您将在每次更改后停止测试整个应用程序，并开始“现场测试”您*认为*应该受到影响的区域。不可避免地，您会发现几个月前可以正常工作的东西现在完全损坏了，您无法确定它何时损坏或哪些更改损坏了它。在那之后发生了足够多的时间......你会开始重视自动化测试...... :-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T12:30:51.980

我并没有真正使用过 Rails，但我认为这些自动化测试作为冒烟测试会很有用，以确保您刚刚所做的事情不会破坏您上周所做的事情。随着项目的发展，这将变得越来越重要。

此外，在编写代码之前编写测试（使用测试驱动开发模型）将帮助您更好更快地编写代码，因为测试迫使您全面思考问题。它还将帮助您知道在哪里将复杂的方法分解为可以单独测试的较小方法。

你是对的，编写和维护测试需要很多时间。有时比代码本身更多时间。但是，由于上述原因，它可以节省您修复错误和重构的时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T05:34:55.497

例如：我在一个超过 25000 行的项目上工作（是的，在 rails 1.2 中），上周一有人告诉我，如果用户将“leave_date”属性设置为过去，我是否可以让用户从除管理员列表之外的每个列表中消失。

您可以重写每个列表操作 (50+) 以放置

@users.reject！{|u| Date.today > u.leave_date}

或者你可以覆盖“find”方法（DRY;-），但只有当你有测试（在所有找到用户的东西上！）你会知道你没有通过覆盖 User#find 来破坏任何东西！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T06:12:57.637

> 我读过的所有内容都只是显示测试验证。Rails 中的验证不应该正常工作吗？它似乎更像是测试框架而不是测试你的代码。为什么需要测试验证？

有一个很好的 Railscast 展示了一种[测试控制器](http://railscasts.com/episodes/71-testing-controllers-with-rspec)的方法。

# git - 在开始使用 Git 之前，我应该了解什么？

> ID：126804
> 
> 赞同：9
> 
> 时间：2008-09-24T12:24:12.480
> 
> 标签：git, version-control

我使用“传统”版本控制系统来维护过去项目的源代码存储库。我正在与一个分布式团队开始一个新项目，我可以看到使用分布式系统的优势。鉴于我了解 SourceSafe、CVS 和 Subversion；你对 Git 新手有什么建议？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-24T12:26:00.230

[Git - SVN Crash Course](http://git.or.cz/course/svn.html)是一本很好的入门读物。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-28T05:22:16.303

In my own experience moving from Subversion to Git, the most important thing is not what you need to learn, but what you need to *unlearn*. Distributed Version Control is *very* different from Centralized Version Control. CVC is a subset of DVC, so you can just do CVC in a DVC tool, but it will be more complicated than with a CVC tool.

Try to unlearn CVC, and get in the DVC mindset. If you just end up doing CVC in a DVC tool, you will merely be frustrated by all the added complexity and you will not realize what that added complexity is buying you in terms of flexibility.

All DVC tools have *great* and very powerful support for branching and merging. Use it. All the history is available at your fingertips. Use it. (For example: never comment out code, just delete it. You can always get it back, even on an airplane with no internet connection.)

One very important aspect of Git: all other tools have a more or less defined workflow. Git doesn't. Git is a DVCS workflow construction kit. This makes it sometimes hard to know what to do: you have to design and implement your own workflow (hint: use lots of shell scripts). I use Git for more than a year now, and I still haven't completely figured out my workflow yet.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T13:44:12.770

做[教程](http://www.kernel.org/pub/software/scm/git/docs/gittutorial.html)

然后玩弄它。在开始使用主代码库之前，先做一个小玩具项目来感受一下。

我经常使用 gitk 来查看补丁并跟踪代码从提交到提交是如何变化的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T12:53:55.763

*在提交文件之前，必须每次*都将它们添加到 Git 暂存区。为了使这更容易，有一个`-a`选项可以添加所有跟踪的文件，如`git commit -a`.

此外，当您这样做时`git diff`，它只会显示您的工作副本与暂存区域中的内容之间的区别。如果您已将更改的文件添加到暂存区域，`git diff`即使您可能有未提交的更改，也可能不会报告任何内容。用`git status`来看肯定的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-24T18:52:23.793

我在我的公司尝试了 git。我们使用 CVS 并希望转向更好的 VC 工具。我们选择 git 作为文件版本控制的最佳工具（Linus on GIT）。它的性能是最好的，对于深入了解版本控制的开发人员来说，它是一个非常好的工具，但对于在后台使用版本控制并且不想学习如何使用的普通开发人员来说，这是一场噩梦。几个小时（他们确实需要学习很多东西）

此外，它与现有 IDE 的集成距离完整还很遥远。对于普通开发人员来说，整体可用性是相当大的问题。

在与 4 名开发人员进行试点之后，我们切换到了 Subversion，因为它是最简单但不是那么优越的工具。

Subversion MultiSite 也有商业解决方案（我们还没有尝试，但很快就会尝试） - [WANDisco](http://www.wandisco.com/)

# design-patterns - 抛出异常时尝试不同方法的模式

> ID：126829
> 
> 赞同：3
> 
> 时间：2008-09-24T12:27:02.660
> 
> 标签：design-patterns, exception, exception-handling

这是一个暴露我缺乏经验的问题：我有一个方法**DoSomething()**如果它不能干净地完成它，它会抛出异常。如果失败了，我会多次尝试不太准确的方法**DoSomethingApproximately() ，希望它能找到足够好的解决方案；**如果这也失败了，我最后打电话给**DoSomethingInaccurateButGuaranteedToWork()**。这三个都是属于这个对象的方法。

两个问题：首先，这种（诚然丑陋的）模式是否可以接受，还是有更优雅的方式？

其次，考虑到它可能引发异常，跟踪我调用**DoSomethingApproximately()**多少次的最佳方法是什么？我目前在对象中保留一个变量 iNoOfAttempts，并嵌套 try 块......这太可怕了，我很惭愧。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T12:37:21.747

你不应该使用异常来控制你的应用程序。

在您的情况下，我会将这三个方法组合成一个方法，并让它返回成功的特定方法，可能使用枚举或类似的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T12:33:09.027

返回错误代码而不是抛出异常。

如果这些方法失败的方式确实引发了异常，请在同一个方法中捕获它们并采取适当的措施，例如增加计数器并返回错误代码。

```
 bool result = DoSomething();
   while (!result && tries < MAX_TRIES) {
       result = DoSomethingApproximately(); //This will increment tries
       if (tries > THRESHOLD) {
           result = DoSomethingThatAlwaysWorks();
       }
   } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T12:48:33.687

怎么样（伪代码）：

```
try{ return doSomething(); }
catch(ExpectedException) { ...not much here probably...}

for(i = 0 to RETRIES){
try{ return doSomethingApproximately; }
catch(ExpectedException) { ...not much here probably...}
}

doSomethingGuaranteed(); 
```

附录：

我强烈建议您不要使用特殊的返回值，因为这意味着该函数的每个用户都必须知道某些返回值是特殊的。根据函数的范围，返回可以正常处理的范围的普通部分可能是明智的，例如空集合。当然，这可能无法区分失败和“正确”答案是空集合（在此示例中）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T13:20:54.183

将整个函数指针放在结构路径中。为了增加趣味，我将使用队列和一些 LINQ。

```
Queue<Action> actions = new Queue<Action>(new Action[] {
   obj.DoSomething,
   obj.DoSomethingApproximately,
   obj.DoSomethingApproximately,
   obj.DoSomethingApproximately,
   obj.DoSomethingApproximately,
   obj.DoSomethingGuaranteed
});

actions.First(a => {
   try {
      a();
      return true;
   } catch (Exception) {
      return false;
   }
}); 
```

# sql-server - 如何解决“尝试为文件附加自动命名数据库...”SQL错误？

> ID：126837
> 
> 赞同：3
> 
> 时间：2008-09-24T12:28:00.410
> 
> 标签：sql-server, linq-to-sql

我有一个用于集成测试项目的本地 .mdf SQL 数据库文件。在我创建项目、数据库等的初始机器上一切正常，但是当我尝试在另一台机器上运行项目时，我得到以下信息：

*System.Data.SqlClient.SqlException : 与服务器建立连接成功，但在登录过程中出现错误。（提供者：共享内存提供者，错误：0 - 管道的另一端没有进程。）*

我想，在我调查这个问题的同时，我也会问这里的社区，看看是否有人已经克服了这个问题。

当我实例化新的数据上下文时会发生异常。我正在使用 LINQ-to-SQL。

```
m_TransLogDataContext = new TransLogDataContext (); 
```

让我知道是否需要任何其他信息。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T13:00:26.760

我将回答我自己的问题，因为我有解决方案。

我依赖自动连接字符串，该字符串将“AttachDbFilename”属性设置为在原始机器上很好但在新机器上不存在的位置。

我将不得不动态构建连接字符串，因为我希望它直接脱离源代码控制而无需手动调整。

很容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-17T16:40:48.410

那是因为您的应用程序对数据库有多个设置，请尝试通过搜索您的连接名称来在您的解决方案中“查找全部”

我正在使用“ **EnergyRetailSystemConnectionString** ”或者您可以按您的数据库名称搜索

# vim - 如何在 vim 中设置 UI 语言？

> ID：126853
> 
> 赞同：108
> 
> 时间：2008-09-24T12:30:32.120
> 
> 标签：vim, user-interface

我在 reddit 上看到了[这个](http://www.gnegg.ch/2008/09/automatic-language-detection/)，它让我想起了我对 vim 的一个抱怨：​​它以*德语*显示 UI 。该死的，维姆！我想要*English*，但由于我的操作系统是用德语设置的（我们办公室的标准），我猜 vim 实际上是在试图提供帮助。

我必须执行什么魔法才能让 vim 切换 UI 语言？我在各种场合尝试过谷歌搜索，但似乎找不到答案（不，谷歌，你是我的朋友 *pat*，*pat*，但我已经知道如何更改语法突出显示，谢谢！） ...

**编辑：**使用下面所有好的提示，我最终将它添加到我的顶部`.vimrc`（在 Windows 7 上运行 Vim 7.2）

```
set langmenu=en_US.UTF-8    " sets the language of the menu (gvim)
language en                 " sets the language of the messages / ui (vim) 
```

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2010-05-18T20:38:01.537

作为参考，在 Windows (7) 中，我刚刚删除了目录`C:\Program Files (x86)\Vim\vim72\lang`. 这使它回退到 en_US。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2011-08-06T15:24:13.947

在 _vimrc 中试试这个。它适用于我的win7。

```
set langmenu=en_US
let $LANG = 'en_US'
source $VIMRUNTIME/delmenu.vim
source $VIMRUNTIME/menu.vim 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-09-24T14:32:20.567

正如 Ken 所说，您**[需要`:language`command](http://vimdoc.sourceforge.net/htmldoc/mlang.html#:language)**。

请注意，将它放在您的`.vimrc`或`.gvimrc`不会帮助您使用 gvim 中的菜单，因为它们的定义在启动时加载一次，很早就加载了，以后不会再重新读取。所以你确实需要在你的环境中设置`LC_ALL`（或更具体地说`LC_MESSAGES`），或者在非 Unixoid 系统（例如 Windows）上，你可以传递`--cmd`开关（它首先执行给定的命令，而不是`-c`选项）：

```
gvim --cmd "lang en_US" 
```

正如我所提到的，您不需要使用`LC_ALL`，它将强制切换计算环境的各个方面。你可以做更多微妙的事情。F.ex.，我自己的语言环境设置如下所示：

```
LANG=en_US.utf8
LC_CTYPE=de_DE.utf8
LC_COLLATE=C 
```

这意味着我得到了一个主要是英语的系统，但具有德语的字母语义，除了默认的排序顺序是 ASCIIbetical（即按代码点排序，而不是根据语言约定）。您可以使用不同的变体；查看[`man 7 locale`](http://man.cx/locale%287%29)更多。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-12-02T08:33:35.363

将这行代码放在我的 _vimrc 文件的顶部节省了我的时间：

```
set langmenu=en_US.UTF-8 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-01-07T14:31:26.737

这适用于更改 vim 的菜单语言

```
set langmenu=en_US.UTF-8  [or just set langmenu=en for short] 
```

但

```
language en 
```

给了我一个错误，说它无法将 en 设置为一种语言，但这条线完成了这项工作

```
:let $LANG = 'en' 
```

后者来自[Vim 的文档](http://vimdoc.sourceforge.net/htmldoc/mlang.html#:language)。我在 _vimrc 文件的开头添加了这两行。我使用的是 Windows 7 64 计算机。

PS：此行更改语言和菜单语言

```
language messages en 
```

在 .vimrc 文件中（或 _vimrc 文件，如果你在 Windows 中）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-03-23T10:12:51.603

Ubuntu 10.10 + VIM 7.2 改进。下面的代码更改控制台 vim 的语言。将它添加到您的 vim.rc 顶部

```
if has('unix')
    language messages C
else
    language messages en
endif 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-24T12:33:31.833

:帮助语言

:语言 fr_FR.ISO_8859-1

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-11-22T12:49:03.257

.vimrc 文件开头的这两行将完成这项工作：

```
let $LANG = 'en'
set langmenu=none 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-07-01T03:38:57.790

在 Windows 8 中将其添加到 _vimrc 对我有用：

```
set langmenu=en_US
let $LANG = 'en_US' 
```

（请注意，_vimrc 与我的 vim74 目录位于同一目录中，即 vim 在启动时读取的 _vimrc 文件）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-24T12:32:17.297

使用更改的语言环境启动 vim：

```
LC_ALL=en_GB.utf-8 vim 
```

或者在您的 bashrc/profile 中默认导出该变量。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-12-11T18:01:38.753

**Windows 上的两个 Vim 安装**

直到我意识到我已经安装了 2 个 Vim 之前，这里的任何东西都没有帮助我。

1.  Git Bash 通过 MinGW (Cygwin, mintty)
2.  在 Windows 上的 Program Files 中单独安装

* * *

下一个[命令](https://stackoverflow.com/questions/15651286/where-is-vimrc-or-vim-profile-for-githubs-mingw32-shell-on-a-windows-machine/15651421#15651421)将过滤您所有观看的**vimrc** -files 及其位置。

```
vim --version | grep vimrc 
```

*   _vimrc (Windows & CMD)
*   .vimrc (Git 的 Bash)
*   vimrc（两者都有不同的位置）

* * *

**1：Windows 和 CMD 上的 Vim**

只有重命名（删除）**lang**文件夹对我有帮助。

你可以在这里找到它`C:\Program Files (x86)\Vim\vim80\lang`

我尝试了这里列出的所有配置设置，但都没有用。

**2.1：通过 MinGW、Cygwin、mintty 进行 Git Bash**

对于 Git Bash，我`language messages en_US`在顶部添加了`C:\Program Files\Git\etc\vimrc`

当然，如果你喜欢删除**lang**文件夹，你可以在这里找到

*   `C:\Program Files\Git\usr\share\vim\vim80\lang`
*   `C:\Users\User_name_xxx\AppData\Local\Programs\Git\usr\share\vim\vim80\lang`对于本地用户安装。

**2.2：仅调整 Git 的 Bash（MinGW64、Cygwin、mintty）**

最后，对于 Windows 上的 Bash，我选择跳过使用**vimrc的操作**

我打开`C:\Program Files\Git\etc\bash.bashrc` 并添加了以下行

`LANG='en_US'`

或者

`LANG=C`

尽量不要使用`en_US.UTF-8`，因为它会强制一些 bash 命令产生奇怪的字符。例如在`find 'xxx_yyy_zzz_aaa.bbbddd'`一个不存在的文件中。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-02-16T19:33:45.093

我不知道为什么以上所有答案都不适合我。我不断收到有关不存在的语言环境的错误。也许这是Windows的事情。无论如何，我的解决方案是将它添加到我的 vimrc 中： let $LANG = 'en'

啊，我说得太早了。gVim 的菜单仍然是日文的，但介绍屏幕是英文的。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-01-13T07:50:07.287

试试把这个添加到你的 _vimrc 中：</p>

```
let $LANG='en_US' 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-02-15T12:48:34.520

有类似的问题，但上述解决方案都没有工作： [https ://superuser.com/questions/552504/vim-ui-language-issue/552523](https://superuser.com/questions/552504/vim-ui-language-issue/552523)

我已经通过删除所有 vim 数据包并[从源](ftp://ftp.vim.org/pub/vim/unix/vim-7.3.tar.bz2)构建 vim 来解决它。

希望它会帮助某人。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-10T11:23:20.567

# 如果您在 Windows 上并且不想被打扰发出命令

## 防止 GUI 加载本地化文件

只需转到`Program Files\Vim\vim80\lang`并在所有看起来与您的语言环境有关的文件前面加上一个下划线作为前缀。

## 防止 VIM 本身加载本地化文件

在与上述相同的文件夹中，使用您的国家/地区代码命名的文件夹以下划线作为前缀。

*注意*：Windows 10 可能会通过发出 UAC 警告来请求管理员权限。

**顺便一提**

同样的技术可以应用于许多移植到 Windows 上的 Unix/Linux 工具，以及通常可以轻松访问本地化文件的所有软件包。如果您重命名它们以防止应用程序找到它们，则备用语言很可能是英语。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2020-10-15T09:07:01.823

我只是在安装 gvim 时禁用了本地语言支持（因此使其成为自定义安装）。

[![](https://i.stack.imgur.com/NUkbN.png)](https://i.stack.imgur.com/NUkbN.png)

在 Windows 7 下使用 gvim82.exe 测试成功。

# sql - 计算用户平均体重

> ID：126855
> 
> 赞同：1
> 
> 时间：2008-09-24T12:31:17.720
> 
> 标签：sql, sql-server

我有两个表，Users 和 DoctorVisit

用户 - 用户 ID - 名称

DoctorsVisit - 用户 ID - 体重 - 日期

doctorVisit 表包含特定用户对医生进行的所有访问。每次访问都会记录用户的体重。

查询：总结所有用户的体重，使用最后一次就诊的数字。（然后除以用户数得到平均权重）

注意：有些用户可能根本没有看过医生，而有些用户可能已经看过很多次了。

我需要所有用户的平均体重，但使用最新的体重。

**更新**

我想要所有用户的平均体重。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T12:47:05.920

如果我正确理解您的问题，您应该能够从以下 SQL 语句中获得基于他们上次访问的所有用户的平均权重。我们使用子查询来获取最后一次访问作为过滤器。

```
SELECT avg(uv.weight) FROM (SELECT weight FROM uservisit uv INNER JOIN
(SELECT userid, MAX(dateVisited) DateVisited FROM uservisit GROUP BY userid) us 
ON us.UserID = uv.UserId and us.DateVisited = uv.DateVisited 
```

我应该指出，这确实假设有一个唯一的 UserID 可用于确定唯一性。此外，如果 DateVisited 不包含时间而只包含日期，则同一天访问两次的患者可能会扭曲数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T17:59:40.630

这是我对解决方案的尝试：

```
select
    avg(a.Weight) as AverageWeight
from
    DoctorsVisit as a
innner join
    (select 
        UserID,
        max (Date) as LatestDate
     from
        DoctorsVisit
     group by
        UserID) as b
     on a.UserID = b.UserID and a.Date = b.LatestDate; 
```

请注意，根本不使用 User 表。

这个平均值完全忽略了根本没有就诊的用户，或者他们最近一次就诊时体重被记录为 NULL 的用户。如果任何用户在同一日期进行了多次访问，并且最近的日期是用户多次受到影响的日期之一，则此平均值会出现偏差。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T16:36:56.677

如果您使用的是 SQL Server 2005，则不需要 GROUP BY 上的子查询。
您可以使用新的 ROW_NUMBER 和 PARTION BY 功能。

```
SELECT AVG(a.weight)  FROM
(select
    ROW_NUMBER() OVER(PARTITION BY dv.UserId ORDER BY Date desc) as ID,
    dv.weight     
from 
    DoctorsVisit dv) a   
WHERE a.Id = 1 
```

正如其他人所提到的，这是所有访问过医生的用户的平均体重。如果你想要所有用户的平均体重，那么任何不去看医生的人都会给出一个误导性的平均值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T12:41:35.527

如果他们访问过，这应该会为您提供每位用户的平均体重：

```
select user.name, temp.AvgWeight
from user left outer join (select userid, avg(weight)
            from doctorsvisit
            group by userid) temp
    on user.userid = temp.userid 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T12:44:18.577

编写一个查询来为每个用户选择最近的权重（QueryA），并使用该查询作为查询的内部选择来选择平均值（QueryB），例如，

```
SELECT AVG(weight) FROM (QueryA) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T12:50:53.617

我认为你的规格有错误。

如果除以所有用户，您的平均值将太低。每个没有就诊的用户倾向于将平均值拖向零。我不相信那是你想要的。

我懒得想出一个实际的查询，但这将是其中之一，您在基表和查询之间使用自联接，该查询将提取所有相关的 ID、访问日期对从基表。唯一需要用户表的就是名称。

我想，几周前我们在这里遇到了同样问题的样本。“相同的问题”是指我们想要一个组代表的属性，但我们想要的属性不包含在 group by 子句中的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T12:50:55.707

我认为这会起作用，尽管我可能是错的：

使用内部选择以确保您有最近的访问，然后使用**AVG**。这个例子中的**User**表是多余的：因为那里没有体重数据，而且你不关心用户名，所以检查它对你没有任何好处。

```
SELECT AVG(dv.Weight) 
FROM DoctorsVisit dv
WHERE dv.Date = (
      SELECT MAX(Date)
        FROM DoctorsVisit innerdv
       WHERE innerdv.UserID = dv.UserID
  ) 
```

# object - 使用自定义对象作为 Microsoft 报告 (.rdlc) 的源

> ID：126863
> 
> 赞同：2
> 
> 时间：2008-09-24T12:33:36.887
> 
> 标签：object, reporting, rdlc

在某些情况下，我更喜欢使用自定义对象而不是强类型数据集和数据行。但是，似乎 Microsoft Reporting（包含在 VS2005 中）需要强类型数据集。

有没有办法使用我的自定义对象来设计和填充报告？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-01T12:38:41.393

我找到了答案。是的，这是可能的。您只需在 Visual Studio 中添加一个自定义对象作为数据源。

[http://www.gotreportviewer.com/objectdatasources/index.html](http://www.gotreportviewer.com/objectdatasources/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T00:36:55.440

我永远无法从我的项目中选择我自己的报告数据设置中的一个 POCO 作为报告的模型 -[演练](http://msdn.microsoft.com/en-us/library/ms251692.aspx)中提到的所谓的“全局”选项不存在。所以我最终不得不编辑 XML 来定义类型和模拟数据源（在我的项目中实际上并不存在）。

我将类型的数据分配给`Aies.Core.Model.Invoice.MemberInvoice`代码中的报告

```
reportViewer.LocalReport.DataSources.Add(new ReportDataSource("MemberInvoice", new[] { invoice1 })); 
```

自定义定义是：

```
 <DataSources>
    <DataSource Name="MemberInvoice">
      <ConnectionProperties>
        <DataProvider>System.Data.DataSet</DataProvider>
        <ConnectString>/* Local Connection */</ConnectString>
      </ConnectionProperties>
      <rd:DataSourceID>3fe04def-105a-4e9b-99db-630c1f8bb2c9</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="MemberInvoice">
      <Fields>
        <Field Name="MemberId">
          <DataField>MemberId</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="DateOfIssue">
          <DataField>DateOfIssue</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="DateDue">
          <DataField>DateDue</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="Amount">
          <DataField>Amount</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>MemberInvoice</DataSourceName>
        <CommandText>/* Local Query */</CommandText>
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>Aies.Core.Model.Invoice</rd:DataSetName>
        <rd:TableName>MemberInvoiceData</rd:TableName>
        <rd:ObjectDataSourceSelectMethod>GetInvoices</rd:ObjectDataSourceSelectMethod>
        <rd:ObjectDataSourceSelectMethodSignature>System.Collections.Generic.IEnumerable`1[Aies.Core.Model.Invoice.MemberInvoice] GetInvoices()</rd:ObjectDataSourceSelectMethodSignature>
        <rd:ObjectDataSourceType>Aies.Core.Model.Invoice.MemberInvoiceData, Aies.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</rd:ObjectDataSourceType>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T14:51:37.180

我相信您可以设置 SSRS 以从或多或少的任意对象中读取数据值。 [此链接](http://msdn.microsoft.com/en-us/library/microsoft.reportingservices.dataprocessing.idatareaderfieldproperties_members(SQL.90).aspx)描述了 API 中的 IDataReaderFieldProperties 对象（IIRC）允许您指定要调用的 getter 方法以获取值。

# c# - 从本机 win32 应用程序调用 C# COM 程序集时，如何调试它？

> ID：126868
> 
> 赞同：8
> 
> 时间：2008-09-24T12:35:20.283
> 
> 标签：c#, .net, windows, delphi, com

我正在开发一个 C# 程序集，该程序集将通过 COM 从 Delphi 7（iow，本机 win32，而不是 .net）应用程序中调用。

到目前为止，它似乎奏效了。我已经导出了一个 TLB 文件，将它导入到我的 Delphi 项目中，我可以创建我的 C# 对象并调用它的函数。

太好了，但很快我**真的**想在 C# 代码运行时使用 Visual Studio 来调试它。设置断点，单步执行代码，所有这些。

我尝试在创建 COM 对象后中断 Delphi 代码，然后寻找 VS 附加到的进程，但我找不到。

有没有办法设置 VS2008 来做到这一点？我更希望能够按 f5 并让 VS 启动 Delphi 可执行文件，等待调用 C# 代码，然后将自身附加到它。但我想我可以手动附加到一个进程。

只是请不要告诉我我必须使用 MessageBox.Show 等。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-24T12:47:12.237

在 VS2008 项目属性页面的 Debug 选项卡上，有一个选项可以设置不同的 Start Action。

当您按 F5 时，这可用于运行外部程序（例如您的 Delphi 应用程序）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-24T12:40:42.457

将以下内容放在您要调试的方法中：

```
#if DEBUG
    if (!System.Diagnostics.Debugger.IsAttached)
        Debugger.Launch();
#endif 
```

当您想要调试时，构建一个调试版本并在您的应用程序中使用它。当此代码运行时，会弹出一个对话框，询问您是否要附加调试器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T12:44:06.737

您可以附加到本机应用程序并正常查看断点、查看堆栈、监视等。您需要在创建 COM 对象后附加。

我在创建对象时放置了一个 Afx MsgBox 以停止应用程序的流程，然后附加调试器。

# oop - 查找和可能更改方法的最佳设计

> ID：126870
> 
> 赞同：0
> 
> 时间：2008-09-24T12:35:37.977
> 
> 标签：oop

我正在设计一个存储（缓存）一组数据的类。我想查找一个值，如果该类包含该值，则使用它并修改该类的属性。我关心公共界面的设计。
以下是该类的使用方式：

```
ClassItem *pClassItem = myClass.Lookup(value);
如果（pClassItem）
{ // 项目在类中找到，所以修改并使用它
  pClassItem->SetAttribute(something);
  ... // 使用 myClass
}
别的
{ // 值在类中不存在，所以添加它
  myClass.Add(value, something);
}

```

但是我不想将 ClassItem 暴露给这个客户端（ClassItem 是 MyClass 的一个实现细节）。为了解决这个问题，可以考虑以下几点：

```
bool found = myClass.Lookup(value);
如果（找到）
{ // 项目在类中找到，所以修改并使用它
  myClass.ModifyAttribute(value, something);
  ... // 使用 myClass
}
别的
{ // 值在类中不存在，所以添加它
  myClass.Add(value, something);
}

```

然而，这是低效的，因为 Modify 将不得不再次进行查找。这将建议使用 lookupAndModify 类型的方法：

```
bool found = myClass.LookupAndModify(value, something);
如果（找到）
{ // 项目在类中找到
  ... // 使用 myClass
}
别的
{ // 值在类中不存在，所以添加它
  myClass.Add(value, something);
}

```

但是将 LookupAndModify 滚动到一种方法中似乎是非常糟糕的设计。它也仅在找到值时进行修改，因此名称不仅麻烦而且还具有误导性。

还有其他更好的设计可以解决这个问题吗？任何设计模式（我无法通过谷歌找到任何东西）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T05:45:46.603

实际上`std::set<>::insert()`正是这样做的。如果值存在，则返回指向现有项的迭代器。否则，返回进行插入的迭代器。

无论如何，您很可能正在使用类似的数据结构进行快速查找，因此干净的公共接口（调用站点）将是：

```
myClass.SetAttribute(value, something) 
```

它总是做正确的事。MyClass 处理内部管道，客户不必担心该值是否存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:55:59.797

这假设您在 Modify 和 Add 情况下都将 value 设置为相同的“某物”：

```
if (!myClass.AddIfNotExists(value, something)) {
   // use myClass
} 
```

除此以外：

```
if (myClass.TryModify(value, something)) {
   // use myClass
} else {
   myClass.Add(value, otherSomething);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T15:26:04.070

两件事情。

第一个解决方案很接近。

但是，不要返回`ClassItem *`。返回一个“不透明对象”。对客户端不透明（无意义）但可由 myClass 实例使用的整数索引或其他哈希码。

然后查找返回一个索引，修改可以随后使用。

```
void *index = myClass.lookup( value );
if( index ) {
    myClass.modify( index, value );
}
else {
    myClass.add( value );
} 
```

在编写“原始”查找、修改和添加之后，然后编写围绕这些原始构建的您自己的复合操作。

编写一个 LookupAndModify、TryModify、AddIfNotExists 和其他从您的低级部分构建的方法。

# .net - 如何禁用更新 Windows 窗体中的窗体？

> ID：126876
> 
> 赞同：15
> 
> 时间：2008-09-24T12:37:33.103
> 
> 标签：.net, winforms

在复杂的更新过程中，我可能更喜欢一次显示所有更改。我知道有一种方法可以让我做到这一点，但它是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-24T12:44:25.113

我认为 this.SuspendLayout() & ResumeLayout() 应该这样做

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-24T12:57:14.600

我没有找到`SuspendLayout()`并`ResumeLayout()`做你要求的。 `LockWindowsUpdate()` [moobaa提到](https://stackoverflow.com/a/126914/7444103)的伎俩。但是， `LockWindowUpdate`一次仅适用于一个窗口。

你也可以试试这个：

```
using System;
using System.Windows.Forms;
using Microsoft.Win32;
using System.Runtime.InteropServices;

public partial class Form1 : Form
{
    [DllImport("user32.dll")]
    public static extern int SendMessage(IntPtr hWnd, Int32 wMsg, bool wParam, Int32 lParam);
    private const int WM_SETREDRAW = 11; 

    public Form1()
    {
      InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
      SendMessage(this.Handle, WM_SETREDRAW, false, 0);

      // Do your thingies here
      SendMessage(this.Handle, WM_SETREDRAW, true, 0);

      this.Refresh();
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-24T12:48:12.750

您可以使用旧的[Win32](http://en.wikipedia.org/wiki/Windows_API) [LockWindowUpdate](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145034(v=vs.85).aspx)功能：

```
[DllImport("user32.dll")]
private static extern long LockWindowUpdate(long Handle);

try {
    // Lock Window...
    LockWindowUpdate(frm.Handle);
    // Perform your painting / updates...
} 
finally {
    // Release the lock...
    LockWindowUpdate(0);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T12:45:29.293

大多数复杂的第三方 Windows 窗体组件都有`BeginUpdate`和`EndUpdate`方法或类似的方法，执行一批更新*然后*绘制控件。在表单级别，没有这样的事情，但您可能会对启用[Double buffering](https://stackoverflow.com/questions/64272/how-to-eliminate-flicker-in-windowsforms-custom-control-when-scrolling)感兴趣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T12:46:44.283

您可以在更新属性时在表单或控件中使用 SuspendLayout 和 ResumeLayout 方法。如果要将数据绑定到控件，则可以使用 BeginUpdate 和 EndUpdate 方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T12:46:54.237

如果更新涉及控件和布局的更改，则 SuspendLayout 将有助于提高性能： [MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.suspendlayout.aspx)

# java - 如何使 gwt-ext 窗口在其内容调整大小时不调整大小？

> ID：126881
> 
> 赞同：1
> 
> 时间：2008-09-24T12:39:01.680
> 
> 标签：java, gwt, gwt-ext

我在[Window](http://gwt-ext.com/docs/2.0.4/com/gwtext/client/widgets/Window.html)`setHeight(600)`上运行过，这就是它的初始大小。我也已经完成了。`setAutoScroll(true)`

当窗口的内容调整大小时，窗口本身也会调整大小。我想要的是窗口保持固定大小，当内容变大时，添加滚动条。如果我手动调整窗口大小，我可以得到这个，然后让内容增长或缩小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-28T21:43:30.017

您是否检查过 GWT 提供的功能 - [`setAutoHeights(false)`](http://gwt-ext.com/docs/2.0.4/com/gwtext/client/widgets/BoxComponent.html#setAutoHeight%28boolean%29)？

# sql-server - 数据比较

> ID：126885
> 
> 赞同：5
> 
> 时间：2008-09-24T12:40:17.823
> 
> 标签：sql-server, textmatching

我们有一个 SQL Server 表，其中包含公司名称、地址和联系人姓名（等等）。

我们会定期收到来自外部来源的数据文件，这些文件需要我们与此表进行匹配。不幸的是，数据略有不同，因为它来自完全不同的系统。例如，我们有“123 E. Main St.”。我们收到“123 East Main Street”。另一个例子，我们有“Acme, LLC”，文件包含“Acme Inc.”。另一个是，我们有“Ed Smith”，他们有“Edward Smith”

我们有一个遗留系统，它利用一些相当复杂和 CPU 密集型的方法来处理这些匹配。有些涉及纯 SQL，有些涉及 Access 数据库中的 VBA 代码。当前系统好但不完善，繁琐难维护

这里的管理层希望扩大其用途。将继承系统支持的开发人员希望将其替换为需要更少维护的更敏捷的解决方案。

是否有一种普遍接受的方式来处理这种数据匹配？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T12:44:55.677

这是我为几乎相同的堆栈编写的内容（我们需要标准化硬件的制造商名称，并且存在各种变体）。虽然这是客户端（确切地说是 VB.Net）——并使用 Levenshtein 距离算法（为获得更好的结果而修改）：

```
 Public Shared Function FindMostSimilarString(ByVal toFind As String, ByVal ParamArray stringList() As String) As String
        Dim bestMatch As String = ""
        Dim bestDistance As Integer = 1000 'Almost anything should be better than that!

        For Each matchCandidate As String In stringList
            Dim candidateDistance As Integer = LevenshteinDistance(toFind, matchCandidate)
            If candidateDistance < bestDistance Then
                bestMatch = matchCandidate
                bestDistance = candidateDistance
            End If
        Next

        Return bestMatch
    End Function

    'This will be used to determine how similar strings are.  Modified from the link below...
    'Fxn from: http://ca0v.terapad.com/index.cfm?fa=contentNews.newsDetails&newsID=37030&from=list
    Public Shared Function LevenshteinDistance(ByVal s As String, ByVal t As String) As Integer
        Dim sLength As Integer = s.Length ' length of s
        Dim tLength As Integer = t.Length ' length of t
        Dim lvCost As Integer ' cost
        Dim lvDistance As Integer = 0
        Dim zeroCostCount As Integer = 0

        Try
            ' Step 1
            If tLength = 0 Then
                Return sLength
            ElseIf sLength = 0 Then
                Return tLength
            End If

            Dim lvMatrixSize As Integer = (1 + sLength) * (1 + tLength)
            Dim poBuffer() As Integer = New Integer(0 To lvMatrixSize - 1) {}

            ' fill first row
            For lvIndex As Integer = 0 To sLength
                poBuffer(lvIndex) = lvIndex
            Next

            'fill first column
            For lvIndex As Integer = 1 To tLength
                poBuffer(lvIndex * (sLength + 1)) = lvIndex
            Next

            For lvRowIndex As Integer = 0 To sLength - 1
                Dim s_i As Char = s(lvRowIndex)
                For lvColIndex As Integer = 0 To tLength - 1
                    If s_i = t(lvColIndex) Then
                        lvCost = 0
                        zeroCostCount += 1
                    Else
                        lvCost = 1
                    End If
                    ' Step 6
                    Dim lvTopLeftIndex As Integer = lvColIndex * (sLength + 1) + lvRowIndex
                    Dim lvTopLeft As Integer = poBuffer(lvTopLeftIndex)
                    Dim lvTop As Integer = poBuffer(lvTopLeftIndex + 1)
                    Dim lvLeft As Integer = poBuffer(lvTopLeftIndex + (sLength + 1))
                    lvDistance = Math.Min(lvTopLeft + lvCost, Math.Min(lvLeft, lvTop) + 1)
                    poBuffer(lvTopLeftIndex + sLength + 2) = lvDistance
                Next
            Next
        Catch ex As ThreadAbortException
            Err.Clear()
        Catch ex As Exception
            WriteDebugMessage(Application.StartupPath , [Assembly].GetExecutingAssembly().GetName.Name.ToString, MethodBase.GetCurrentMethod.Name, Err)
        End Try

        Return lvDistance - zeroCostCount
    End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T12:49:18.363

SSIS（在 Sql 2005+ Enterprise 中）具有[Fuzzy Lookup](http://msdn.microsoft.com/en-us/library/ms137786.aspx)，专为此类数据清理问题而设计。

除此之外，我只知道特定领域的解决方案——例如[地址清理](http://www.usps.com/ncsc/addressmgmt/amsapi.htm)或通用[字符串匹配技术](http://en.wikipedia.org/wiki/Damerau-Levenshtein_distance)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T12:54:11.597

有许多供应商提供产品来进行这种模式匹配。我会做一些研究，**找到一个好的、有声望的产品，然后废弃国产系统**。

正如您所说，您的产品只是好的，这对于企业来说是一种足够普遍的需求，我敢肯定那里有不止一种优秀的产品。即使许可证花费几千美元，它仍然比支付一堆开发人员在内部工作要便宜。

此外，“复杂”、“CPU 密集型”、“VBA 代码”和“Access 数据库”这些短语同时出现在系统描述中，这也是寻找优秀第三方工具的另一个原因。

编辑：.NET 也有可能有一个内置组件来做这种事情，在这种情况下，您不必为此付费。.NET 提供的工具时常让我感到惊讶。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T13:51:31.007

Access 并没有真正的工具。在理想的世界中，我会选择 SSIS 解决方案并使用模糊查找。但是，如果您当前正在使用 Access，那么您的办公室购买 SQL Server 企业版的机会对我来说似乎很低。如果您受困于当前环境，则可以尝试蛮力方法。

从标准化的地址清理开始。选择 Street、raod 等的标准缩写，并编写代码以更改这些标准地址的所有正常变化。用一个空格替换任何两个空格的实例，修剪所有数据并删除所有非字母数字字符。如您所见，这是一项艰巨的任务。

至于公司名称，也许您可​​以尝试匹配名称的前 5 个字符和地址或电话。您还可以创建一个包含已知变体的表以及它们在您的数据库中与您的数据库相关的内容，以用于清理未来的文件。因此，如果您使用 id 100 is Acme, Inc. 进行记录，您可能会有这样的表格：

idfield 名称

100 Acme, Inc.

100 Acme, Inc

100 Acme, Incorporated

100 Acme, LLC

100 顶点

如果您每次找到并修复重复项（使其成为去重复过程的一部分）并且如果您每次都能够匹配的第一部分都进行条目，那么这将开始很小但随着时间的推移而建立现有公司的名称和地址。

我还会查看 Torial 发布的那个功能，看看它是否有帮助。

所有这些都是痛苦和耗时的，但随着时间的推移，随着您发现新的变体并将它们添加到代码或列表中，它们会变得更好。如果您决定标准化您的地址数据，请确保首先清理生产数据，然后对工作表进行任何导入并清理它，然后尝试匹配生产数据并插入新记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-12T14:01:03.720

有很多方法可以解决这个问题，但可能并不明显。最好的办法是找到唯一标识符，您可以使用这些标识符在字段之外匹配拼写错误等。

一些想法

1.  显而易见的，社会安全号码，驾驶执照等
2.  电子邮件地址
3.  清理后的电话号码（R删除标点符号等）

就供应商而言，我刚刚回答了一个类似的问题，并粘贴在下面。

每个主要供应商都有自己的解决方案。Oracle、IBM、SAS Dataflux 等都声称在这类问题上做得最好。

独立验证评估：

澳大利亚科廷大学数据链接中心进行了一项研究，模拟了 440 万条记录的匹配。确定提供商的准确性（找到的匹配数与可用的匹配数。错误匹配数）

[DataMatch Enterprise，](http://www.dataladder.com/Products_DataMatch_Enterprise.html)最高精度 (>95%)，非常快速，低成本

[IBM Quality Stage](http://www-03.ibm.com/software/products/us/en/ibminfoqual/)，高精度 (>90%)，非常快，高成本 (>$100K)

SAS 数据通量，中等准确度 (>85%)，快速，高成本 (>100K) 这是我们能找到的最好的独立评估，非常彻底。

# .net - Visual Studio 2005 - 同时重构多个属性？

> ID：126894
> 
> 赞同：2
> 
> 时间：2008-09-24T12:42:50.190
> 
> 标签：.net, visual-studio, refactoring

我每次都使用右键>重构>封装字段来获取我的访问器。问题是当我创建新类时，我可以拥有超过 10 个属性，并且每个访问器都需要 1 对 1 的时间。有没有更快的方法来创建它们？

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T13:21:38.583

如果您创建一个新类，您可以使用代码片段来创建封装的字段，而不是先创建字段然后再封装它。在 C# 中，快捷方式是 prop 和 propg（用于私有集）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:50:29.797

看起来工作室内置的重构一次只支持一个字段，用于封装字段重构。重构专业版！( [http://www.devexpress.com/Products/Visual_Studio_Add-in/Refactoring/](http://www.devexpress.com/Products/Visual_Studio_Add-in/Refactoring/) ) 或 Resharper ( [http://www.jetbrains.com/resharper/index.html](http://www.jetbrains.com/resharper/index.html) ) 都支持封装多个字段。

您可能会花哨并组合一个允许您选择多个字段然后封装每个字段的宏，但 VS 宏不是我的蜡球。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T03:42:33.120

在 C# 3.0 中，新的属性语法使您无需声明字段并实现访问器。它们的语法如下：

```
public string Name { get; private set; } 
```

另外，我想指出，对于内部成员，琐碎的属性对内部字段的价值很小，因为您可以控制调用者和实现 - 您可以在未来切换到一个属性，而无需大量工作。

即使对于公共成员来说，认为您可以仅通过将公共数据字段添加到属性中来保证您的代码的未来发展也是短视的。至少，您应该在构造函数（使用工厂）和接口（使用接口）周围添加间接。它还需要深入思考您的 API 的使用者将如何期望您在多个版本上工作。在我看来，这真的很难，而且只有当你是 API 供应商时才值得这样做。

在我的代码中，我使用属性的主要原因是因为许多使用反射的工具只查看属性而不是字段。我认为这是一个错误，但这就是工具的工作方式。

# svn - git-svn 合并和提交细节

> ID：126896
> 
> 赞同：5
> 
> 时间：2008-09-24T12:43:12.263
> 
> 标签：svn, git, merge

我们正在使用 git-svn 来管理 SVN 存储库的分支。我们面临以下问题：用户 X 在分支中多次提交后，用户 Y 想使用 git-svn 将分支中的更改合并到主干。我们看到的问题是所有单个合并操作的提交消息看起来好像是由用户 Y 进行的，而分支中的实际更改是由用户 X 进行的。

有没有办法向 git-svn 表明在合并时，使用原始提交消息/作者进行给定的更改，而不是进行合并的人？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-24T13:48:49.767

git-svn 手册页建议您*不要使用 merge*。""建议你运行 git-svn fetch and rebase (not pull or merge)""。话虽如此，你可以做你喜欢的:-)

这里有2个问题。首先是 svn 只存储*commiter*，而不是像 git 那样存储补丁的作者。所以当 Y 提交合并到主干时，svn 只记录她的名字，即使补丁是由 X 编写的。这是 git 的一个*惊人*的特性，非常简单但对开源项目至关重要，因为将更改归因于作者可以避免法律问题在路上。

其次，git 似乎没有使用相对较新的 svn merge 功能。这可能是暂时的事情，因为 git 正在积极开发中，并且一直在添加新功能。但目前，它不使用它们。

我刚刚尝试过使用 git 1.6.0.2，与使用 svn merge 执行相同操作相比，它“丢失”了信息。在 svn 1.5 中，向日志记录和注释方法添加了一个新功能，因此主干上的 svn log -g 将输出如下内容进行合并：

```
------------------------------------------------------------------------
r5 | Y | 2008-09-24 15:17:12 +0200 (Wed, 24 Sep 2008) | 1 line

Merged release-1.0 into trunk
------------------------------------------------------------------------
r4 | X | 2008-09-24 15:16:13 +0200 (Wed, 24 Sep 2008) | 1 line
Merged via: r5

Return 1
------------------------------------------------------------------------
r3 | X | 2008-09-24 15:15:48 +0200 (Wed, 24 Sep 2008) | 2 lines
Merged via: r5

Create a branch 
```

在这里，Y 提交 r5，它将分支上 X 的更改合并到主干中。日志的格式并没有那么好，但它在 svn blame -g 上得到了它自己：

```
 2          Y int main()
       2          Y {
G      4          X   return 1;
       2          Y } 
```

这里假设 Y 只提交到主干，我们可以看到一行被 X（在分支上）编辑并合并。

所以，如果你使用的是 svn 1.5.2，你现在可能最好与真正的 svn 客户端合并。虽然你会在 git 中丢失合并信息，但它通常足够聪明，不会抱怨。

更新：我刚刚用 git 1.7.1 试过这个，看看在此期间是否有任何进展。坏消息是 git 中的 merge 仍然不会填充 svn:mergeinfo 值，因此如果 Subversion 存储库是规范源（它可能是），则不会设置 svn:mergeinfo 并且您将丢失合并信息`git merge`。`git svn dcommit`好消息是它`git svn clone`确实会读取 svn:mergeinfo 属性以构建更好的合并历史记录，因此如果您`svn merge`正确使用（它需要合并完整的分支），那么 git clone 对 git 用户来说看起来是正确的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T14:11:10.413

您可以使用嫁接来教 git 有关未在相关提交对象中表示的合并。

```
echo "$merge_sha1 $parent1_sha1 $parent2_sha1" >> .git/info/grafts 
```

查找此信息很容易：只要找到有问题的合并提交，您就知道`$merge_sha1`并且`$parent1_sha1`已经知道了。按照惯例，此类提交的提交消息将包含第二个父提交的 SVN 修订号，您只需将其转换为相应的提交 ID：

```
git svn find-rev r$revnum $branch 
```

Presto，您拥有创建移植物所需的全部 3 条信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-20T18:27:48.230

尝试对 git-svn 使用 --add-author-from 和 --use-log-author 选项。

# sqlite - PostgreSQL 中的 SQLite 日期时间函数的等价物是什么？

> ID：126897
> 
> 赞同：1
> 
> 时间：2008-09-24T12:43:15.290
> 
> 标签：sqlite, postgresql

这个问题是不言自明的。我正在寻找与[SQLite datetime function](http://www.sqlite.org/cvstrac/wiki?p=DateAndTimeFunctions)等效的 PostgreSQL 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T12:49:10.190

```
postgres=# select to_char(now(),'YYYY-mm-dd HH:MM:ss');
       to_char
---------------------
 2008-09-24 02:09:20
(1 row)

postgres=# select to_char(now(),'YYYY-mm-dd HH24:MM:ss');
       to_char
---------------------
 2008-09-24 14:09:20
(1 row) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T12:53:32.410

我认为这就是您正在寻找的内容：

时间戳 [ (p) ] [ 不带时区 ] 或时间戳 [ (p) ] 带时区

否则看看@ [http://www.postgresql.org/docs/8.1/interactive/datatype-datetime.html](http://www.postgresql.org/docs/8.1/interactive/datatype-datetime.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T13:15:41.420

好的，感谢您的回答，他们帮助我指出了正确的方向。我实际上正在寻找的是[to_timestamp](http://www.postgresql.org/docs/8.2/static/functions-formatting.html)。

# codebase - 混合两种或多种语言（如 Java 和 C++）时组织源代码库

> ID：126898
> 
> 赞同：13
> 
> 时间：2008-09-24T12:43:16.257
> 
> 标签：codebase, polyglot

几天前，我不得不将 C++ 文件引入 Java 项目时遇到了一个问题。它首先需要测量 Java 进程的 CPU 使用率，然后决定采用 JNI 调用用 C 编写的本机库（Unix 机器上的共享库）。问题是找到一个合适的位置将 C 文件放在仅包含 Java 文件的源存储库（顺便说一下 Clearcase）中。

我想到了几个替代方案：

(a) 创建一个单独的目录，用于将 C 文件（具体来说，一个 .h 文件和一个 .c 文件）放在源代码库的顶部，例如：

/vobs/myproduct/javasrc /vobs/myproduct/cppsrc

我不喜欢这样，因为我只有两个 C 文件，而且像这样在语言级别拆分源代码库似乎很奇怪。如果项目的大部分内容或多或少都是用 C++ 和 Java 编写的，这可能没问题。

(b) 将 C 文件放入使用它的 Java 包中。

我在 /vobs/myproduct/com/mycompany/myproduct/util/ 中有调用 Java 类，C 文件也放在那里。

我也不喜欢这个，因为我认为 C 文件不属于 Java 包。

以前有没有人解决过这样的问题？一般来说，在组织混合两种或多种语言的代码库时，应该遵循什么好的策略？

更新：我没有任何计划在我的项目中使用任何 C 或 C++，也许是一些 Jython，但你永远不知道我的客户何时需要一个只能通过使用 C 来解决或最好通过使用 C 来解决的功能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T13:00:52.517

*“我不喜欢这样，因为我只有两个 C 文件，而且像这样在语言级别拆分源代码库似乎很奇怪”*

为什么看起来很奇怪？考虑这个项目：

```
  项目1\src\java
  项目1\src\cpp
  项目 1\src\python

```

或者，如果您决定将内容拆分为模块：

```
  项目1\模块1\src\java
  项目1\模块1\src\cpp
  项目1\模块2\src\java
  项目1\模块2\src\python

```

我想这是个人品味的问题，但上面的结构相当普遍，我认为一旦你习惯了它就会很好地工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T13:09:36.410

Web 应用程序的默认 Maven 生成布局是`src/main/java`、`src/test/java`、`src/main/resources`和`src/test/resources`。我会假设它也会默认添加`src/main/cpp`和`src/test/cpp`。这对我来说似乎是一个足够体面的约定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T13:14:37.053

将它们保存在单独的文件夹中是个好主意。它比在 Java 包中搜索 C 文件更容易找到，并且它还允许将来添加更多 C 代码，而无需稍后移动它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T12:49:28.770

就我个人而言，我会将两者分开，甚至可能分成他们自己独立的项目，但那是当它们都是独立的东西时，就像你不会将两个不同的概念放在同一个类中一样。当他们都触及同一个概念领域时，它会变得更加模糊。当然，在构建代码时总是存在问题，例如是否可以将其放入结构 b) 中而无需执行各种技巧来编译它？您是否打算在项目中使用更多 C，在这种情况下，如果您遵循相同的模式，C 文件将遍布您的项目......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T13:08:35.947

就个人而言，对于拆分语言解决方案，我会将它们保存在单独的项目或文件夹中。

看待问题的一种方法是像对待任何其他第三方 API 一样对待 C 类。在您的 java 代码中接口出依赖项（即避免直接调用）以避免紧密耦合并将 C 源代码保存在与 java.xml 分开的项目/文件夹中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T13:09:01.700

让我们使用不同的术语。有一种产品不是项目。该产品由 Java 工作区和 C/C++ 工作区组成，每个工作区都可以从不同的 IDE 加载。最终，如果您使用同一个 IDE，则将只有一个工作区。每个工作区由几个项目组成。每个项目都有自己的文件夹结构（src、bin、res 等）。所以如果它只有一个工作区，那么最好在里面至少有一个Java和一个C/C++项目，每个项目都有不同的编译/运行/调试/输出/...设置。

所以，我会使用：

```
Product/Workspace(1)/JavaProject1/src 
Product/Workspace(1)/JavaProject2/src 
Product/Workspace(1 or 2)/CPPproject1/src 
Product/Workspace(1 or 2)/CPPproject2/src ... 
```

这样，您最终可以为每个项目使用一个相同的文件夹结构，这更加一致。基本上，这只是又一层抽象——将产品划分为不同的相关项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T13:30:44.473

在这种情况下，有问题的文件不仅是一种不同的语言，而且还作为一个单独的程序运行，通过定义的接口进行交互。这意味着源文件可以被视为一个单独的项目，因此可以保存在其他地方。

在一个代码库中混合 C# 和 ASP.NET（例如）的 .NET 项目中，情况有所不同。在这种情况下，人们如何组织他们的代码？

# php - 将 PHP 对象缓存到文件的方法？

> ID：126917
> 
> 赞同：26
> 
> 时间：2008-09-24T12:48:37.320
> 
> 标签：php, caching

在 ASPNET 中，我开始喜欢应用程序和缓存存储。他们太棒了。对于没有经验的人，您可以将数据逻辑对象放入其中，嘿-presto，您只需查询数据库一次即可获取一些数据。

迄今为止最好的 ASPNET 功能之一，IMO。

我已经放弃了 Linux 的 Windows，因此放弃了 webdev 的 PHP、Python 和 Ruby。我最常使用 PHP，因为我开发了几个开源项目，都使用 PHP。

不用说，我已经探索了 PHP 在缓存数据对象方面必须提供的功能。到目前为止，我玩过：

1.  序列化到文件（一个非常缓慢/昂贵的过程）
2.  将数据作为 JSON/XML/plaintext/etc 写入文件（读取操作更慢）
3.  将数据作为纯 PHP 写入文件（读取速度最快，但写入操作相当复杂）

我现在应该强调的是，我正在寻找一种不依赖第三方应用程序（例如 memcached）的解决方案，因为这些应用程序安装在各种场景中，其中大多数没有安装权限（例如：a便宜的共享主机帐户）。

所以回到我现在正在做的事情，**坚持文件安全吗？** `Rule 1`在生产服务器安全性一直禁用文件写入，但我真的看不到任何方式 PHP*可以*缓存，如果它不能写。是否有任何提示和/或技巧来提高安全性？

**还有另一种我忘记的持久化文件方法吗？**

**在“有限”环境中是否有更好的缓存方法？**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-24T13:00:03.470

序列化是相当安全且常用的。但是，还有另一种选择，那就是缓存到内存。查看[memcached](http://pecl.php.net/package/memcache)和[APC](http://www.php.net/manual/en/book.apc.php)，它们都是免费且高性能的。[这篇](http://blog.digitalstruct.com/2008/02/27/php-performance-series-caching-techniques/)关于 PHP 中不同缓存技术的文章可能也很有趣。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-24T13:37:05.377

### 回复：还有另一种我忘记的持久化文件方法吗？

它的实用性有限，但如果您有一个特别强大的数据库查询，您可以将序列化对象写回索引数据库表。您仍然会有数据库查询的开销，但它会是一个简单的选择，而不是强大的查询。

### 回复：坚持到文件安全吗？和便宜的共享主机帐户）

可悲的事实是廉价的共享主机并不安全。您对有权访问您服务器的 100,500 或 1000 名其他人的信任程度如何？出于历史和（具有讽刺意味的）安全原因，共享托管环境让 PHP/Apache 作为非特权用户运行（PHP 作为 Apache 模块运行）。这里的安全理由是，如果面向世界的 apache 进程受到威胁，则利用者只能访问无法处理重要系统文件的非特权帐户。

不好的部分是，这意味着每当您使用 PHP 写入文件时，该文件的所有者都是同一个非特权 Apache 用户。对于系统上的每个用户都是如此，这意味着任何人都可以读取和写入文件。上述场景中的理论黑客也可以访问这些文件。

PHP 中还有一个长期的不良做法，即为目录和文件授予 777 的目录权限，以使非特权 apache 用户能够写出文件，然后将目录或文件保持在该状态。这使系统上的**任何人都**具有读/写访问权限。

最后，你可能认为默默无闻可以拯救你。“他们不可能知道我的秘密缓存文件在哪里”，但你错了。共享主机将用户设置在同一个组中，大多数默认文件掩码将授予您的组用户对您创建的文件的读取权限。有时通过 SSH 连接到您的共享主机帐户，向上导航一个目录，您通常可以开始浏览系统上的其他用户文件。这可以用来嗅出可写文件。

解决方案并不漂亮。一些主机会提供 CGI Wrapper，让您可以将 PHP 作为 CGI 运行。这里的好处是 PHP 将作为脚本的所有者运行，这意味着它将作为您而不是非特权用户运行。避免了问题！新问题！传统的 CGI 在二月份就像糖蜜一样缓慢。

有 FastCGI，但 FastCGI 很挑剔，需要不断调整。没有多少共享主机提供它。如果你找到了，那么他们很可能会启用 APC，甚至可能会为 memcached 提供一种机制。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-01T07:12:57.827

我有一个类似的问题，因此写了一个解决方案，一个用 PHP 编写的内存缓存。它只需要 PHP 构建来支持套接字。除此之外，它是一个纯 php 解决方案，应该在共享主机上运行良好。

[http://code.google.com/p/php-object-cache/](http://code.google.com/p/php-object-cache/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-24T13:24:22.553

如果我必须能够写，我总是做的是确保我不会在任何有 PHP 代码的地方写。通常我的目录结构看起来像这样（它在项目之间有所不同，但这是一般的想法）：

```
project/
  app/
  html/
    index.php
    data/
  cache/ 
```

`app`Web 服务器不可写（最好是 index.php）。 `cache`是可写的，用于缓存解析的模板和对象等内容。`data`可能是可写的，这取决于需要。也就是说，如果用户上传数据，它就会进入数据。

指向 Web 服务器，`project/html`并使用任何方便的方法设置`index.php`为脚本，以便为项目中的每个页面运行。您可以在 Apache 中使用 mod_rewrite，或者内容协商（我的偏好，但通常不可能），或者您喜欢的任何其他方法。

您所有的真实代码都存在于 中`app`，Web 服务器无法直接访问该代码，但应将其添加到 PHP 路径中。

这对我的几个项目来说效果很好。例如，我什至能够让维基媒体使用这种结构的修改版本。

哦...我会使用 serialize()/unserialize() 来进行缓存，尽管生成 PHP 代码具有一定的吸引力。我所知道的所有模板引擎都会生成要执行的 PHP 代码，从而使后解析非常快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T13:14:13.343

如果您有权访问数据库查询缓存（即 MySQL），您可以序列化您的对象并将它们存储在数据库中。数据库将负责将查询结果保存在内存中，这样应该会非常快。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-05T04:16:19.520

您没有说明-为什么-您要尝试缓存对象。您是在尝试加速缓慢的数据库查询、解决昂贵的对象实例化、避免重复生成复杂页面、维护应用程序状态，还是只是在漫长的冬天强制存储对象？

鉴于大多数低成本共享主机的严重限制，最佳解决方案将取决于您要完成的工作。寻求最低限度的共享托管意味着您必须接受您不会使用最好的工具。这些数字很难量化，但在托管成本、网站性能和开发人员时间（即快速、便宜或容易）之间存在权衡。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T12:55:01.783

理论上可以在会话中存储对象。这可能会让您摆脱文件写入禁用问题。此外，您可以将会话存储在 mysql 内存支持的表中以加快查询速度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T13:02:37.350

某些托管位置可能已编译 APC。这将允许您将对象存储在内存中。

# c# - 从 IE BHO 打开时，如何确保对话框是模态的？

> ID：126925
> 
> 赞同：1
> 
> 时间：2008-09-24T12:50:31.683
> 
> 标签：c#, internet-explorer, bho

我有一个用 c# 编写的 Internet Explorer Browser Helper Object (BHO)，在不同的地方我打开表单作为模式对话框。有时这行得通，但在某些情况下却行不通。我目前可以复制的情况是 IE 正在运行 javascript 以打开其他子窗口......我想它在某个地方有点混乱......

问题是当我打电话时：

```
(new MyForm(someParam)).ShowDialog(); 
```

该表单不是模态的，因此我可以单击 IE 窗口并获得焦点。由于 IE 正在运行我的代码，因此它不会刷新，因此对用户来说，IE 似乎处于挂起状态。

有没有办法确保表单以模态方式打开，即表单不可能隐藏在 IE 窗口后面。

（我使用的是 IE7。）

[注意：这是一个与这篇文章](https://stackoverflow.com/questions/73000/modal-dialogs-in-ie-gets-hidden-behind-ie-if-user-clicks-on-ie-pane)类似的问题，尽管它使用的是 java。我想解决方案是正确传递 IE 窗口的 IWin32Window ，所以我正在调查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-26T13:37:35.430

这是 Ryan/Rory 的 WindowWrapper 代码的更简洁版本：

```
internal class WindowWrapper : IWin32Window
{
    public IntPtr Handle { get; private set; }
    public WindowWrapper(IntPtr hwnd) { Handle = hwnd; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T12:57:49.730

我不是打算回答我自己的问题，但是...

如果您将正确的 IWin32Window 传递给 ShowDialog() 方法，它似乎可以正常工作。诀窍是如何得到这个。我是这样做的，其中“siteObject”是传递给 BHO 的 SetSite() 方法的对象：

```
IWebBrowser2 browser = siteObject as IWebBrowser2;
if (browser != null) hwnd = new IntPtr(browser.HWND);
(new MyForm(someParam)).ShowDialog(new WindowWrapper(hwnd));

...

// Wrapper class so that we can return an IWin32Window given a hwnd
public class WindowWrapper : System.Windows.Forms.IWin32Window
{
    public WindowWrapper(IntPtr handle)
    {
        _hwnd = handle;
    }

    public IntPtr Handle
    {
        get { return _hwnd; }
    }

    private IntPtr _hwnd;
} 
```

感谢[Ryan](http://ryanfarley.com/blog/archive/2004/03/23/465.aspx)的 WindowWrapper 类，虽然我希望有一个内置的方法来做到这一点？

更新：这不适用于具有保护模式的 IE8，因为它访问的 HWND 超出了应有的范围。相反，您必须使用当前选项卡的 HWND（或其他解决方案？），例如，请参阅本文中[的 .net 示例以获取该](http://social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/df0fe7f2-0153-47d9-b18f-266d57ab7909)方法。

# c# - 如何使 C# .NET CF 程序的 AssemblyInfo 版本传播到资源管理器属性窗口？

> ID：126926
> 
> 赞同：4
> 
> 时间：2008-09-24T12:50:41.137
> 
> 标签：c#, .net, compact-framework, versioning

似乎如果您编译 Visual Studio 解决方案并在您的 AssemblyInfo.cs 文件中有一个版本号，它应该传播到 Windows 资源管理器属性对话框。这样，某人只需右键单击 *.exe 并单击“属性”即可查看版本#。Visual Studio 中是否有特殊设置可以实现这一点？

[示例图片 http://content.screencast.com/users/Pincas/folders/Jing/media/40442efd-6d74-4d8a-8e77-c1e725e6c150/2008-09-24_0849.png](http://content.screencast.com/users/Pincas/folders/Jing/media/40442efd-6d74-4d8a-8e77-c1e725e6c150/2008-09-24_0849.png)

编辑：我应该提到，这特别适用于不支持 AssemblyFileVersion的 .NET **Compact Framework 2.0。**所有的希望都失去了吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-07T14:49:40.993

请注意，*AssemblyFileVersion属性在 .NET* **Compact Framework**下不可用！

有关解决方法，请参阅Daniel Mooth 的[这篇文章。](http://www.danielmoth.com/Blog/2004/11/assemblyfileversion-on-cf.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-04T17:52:16.500

**注意：此答案用于访问 .NET CF 3.5 应用程序中的 AssemblyInfo 属性。它不会传播到 Windows 资源管理器内的可执行文件的“属性”（但可用于写入文件、控制台或显示在应用程序中）**

我知道这是一个非常古老的问题，但这是我使用 Reflection 和 Linq 找到的解决方案来获取“AssemblyInformationalVersion”（较新的 Visual Studio 项目中的产品版本）。

首先，我将其添加到 AssemblyInfo.cs 中（将字符串替换为您想要使用的任何内容）：

```
[assembly: AssemblyInformationalVersion("1.0.0.0 Alpha")] 
```

然后，您可以使用此方法提取属性（我将其放在 AssemblyInfo.cs 文件中的静态类中）。方法 get 是所有 Assembly 属性的数组，然后选择与属性名称匹配的第一个结果（并将其转换为正确的类型）。然后可以访问 InformationalVersion 字符串。

```
//using System.Reflection;
//using System.Linq;
public static string AssemblyInformationalVersion
{
    get
    {
        AssemblyInformationalVersionAttribute informationalVersion = (AssemblyInformationalVersionAttribute) 
            (AssemblyInformationalVersionAttribute.GetCustomAttributes(Assembly.GetExecutingAssembly())).Where( 
                at => at.GetType().Name == "AssemblyInformationalVersionAttribute").First();

        return informationalVersion.InformationalVersion;
    }
} 
```

要获得我使用的正常“AssemblyVersion”属性：

```
//using System.Reflection;
public static string AssemblyVersion
{
    get
    {
        return Assembly.GetExecutingAssembly().GetName().Version.ToString();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T12:56:00.127

[AssemblyFileVersion 属性](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyfileversionattribute(VS.71).aspx)有帮助吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T12:56:28.533

您需要添加另一个属性：

```
[assembly: AssemblyFileVersion("1.0.114.0")]
```

请注意，您仍然需要一个 AssemblyVerison 来正确识别 .NET 运行时的程序集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T12:57:59.980

版本号确实会传播到属性对话框中的“版本”选项卡，但不会传播到摘要。不幸的是，VS 不会自动填充文件的摘要信息，因为该信息是附加到文件本身的元数据。但是，您可以使用 Microsoft 提供的免费 DSO OleDocument 属性阅读器自行访问和操作摘要信息。

您可以从以下网址获取该库： http: [//www.microsoft.com/downloads/details.aspx?FamilyId= 9BA6FAC6-520B-4A0A-878A-53EC8300C4C2&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=9BA6FAC6-520B-4A0A-878A-53EC8300C4C2&displaylang=en)

有关其使用的更多信息，请访问： http: [//www.developerfusion.co.uk/show/5093/](http://www.developerfusion.co.uk/show/5093/)

**编辑**：正如上面 pb 和 Nigel Hawkins 所说，您*可以*使用 AssemblyFileVersion 属性获取要传播的属性，例如：

```
[assembly: AssemblyFileVersion("1.0.114.0")] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T19:48:54.423

在我的项目中，我们使用 FileVersion = YYYY.MM.DD.BUILD（例如 2008.9.24.1），但 ProductVersion 应该是 major.minor.revision.BUILD。我们使用 AssemblyInformationalVersion 来解决这个问题。

AssemblyVersion="MAJ.MIN.REV.1" --> 由 .NET 使用

AssemblyInformationalVersion="MAJ.MIN.REV.XXX" --> 用于资源管理器的 ProductVersion

AssemblyFileVersion="YYYY.MM.DD.XXX" --> 用于资源管理器的 FileVersion

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T12:58:59.197

我不确定 RevisionNumber 是否是要查找的正确字段。

尝试资源管理器，右键单击 -> 版本选项卡，然后查看那里的 AssemblyVersion 字段。

# c# - Log4Net/C# - 禁用默认日志记录

> ID：126939
> 
> 赞同：7
> 
> 时间：2008-09-24T12:54:16.697
> 
> 标签：c#, log4net

我在 C# 项目中使用 log4net，在生产环境中，我想禁用所有日志记录，但是当发生一些致命错误时，它应该将所有以前的 512 消息记录到一个文件中。我已经成功配置了它，它是工作正常。当发生一些致命错误时，它将消息记录到文件中。

但是当我从 Visual Studio 运行它时，我可以看到所有日志消息都写入了输出窗口，无论它是否是致命的。（当我从 Windows 资源管理器运行时，我看不到这些消息 - 我的应用程序是一个 WinForm exe，并且没有控制台窗口来查看输出）

有什么方法可以禁用此日志记录？我只需要我的日志文件，当发生一些致命错误时也是如此。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <log4net debug="false">

        <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
            <file value="log.txt" />
            <appendToFile value="true" />
            <rollingStyle value="Size" />
            <maxSizeRollBackups value="10" />
            <maximumFileSize value="1MB" />
            <staticLogFileName value="true" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
            </layout>
        </appender>

        <appender name="BufferingForwardingAppender" type="log4net.Appender.BufferingForwardingAppender" >
            <bufferSize value="512" />
            <lossy value="true" />
            <evaluator type="log4net.Core.LevelEvaluator">
                <threshold value="FATAL"/>
            </evaluator>
            <appender-ref ref="RollingFileAppender" />
        </appender> 

        <root>
            <level value="DEBUG" />
            <appender-ref ref="BufferingForwardingAppender" />          
        </root>
    </log4net>
</configuration> 
```

这就是我在 Windows 窗体的静态初始化程序中配置它的方式。

```
static Window1()
    {
      Stream vStream = typeof(Window1).Assembly.GetManifestResourceStream("TestLogNet.log4net.config");
      XmlConfigurator.Configure(vStream);
      BasicConfigurator.Configure();
    } 
```

我在 WinForm 的构造函数中初始化了记录器对象

```
logger = LogManager.GetLogger(typeof(Window1)); 
```

[语言 - C#、.NET Framework - 3.5、Visual Studio 2008、log4net 1.2.10、项目类型 - WinForms]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-24T13:14:39.393

删除[BasicConfigurator.Configure()](http://logging.apache.org/log4net/release/sdk/log4net.Config.BasicConfigurator.Configure_overload_1.html)行。这就是该行所做的——添加一个指向 Console.Out 的 ConsoleAppender。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T13:12:47.200

如果应用程序在发布模式下编译，您是否仍会在 Visual Studio 中看到这些消息？无论如何，log4net 都可能使用 Debug.Write 来显示错误。如果是这种情况，那么这些消息不应出现在发布模式中。

# user-interface - 自定义安装程序操作期间的 UI

> ID：126946
> 
> 赞同：1
> 
> 时间：2008-09-24T12:56:14.010
> 
> 标签：user-interface, installation, custom-action

在自定义安装程序操作期间显示 UI 的正确方法是什么？

我希望我的 UI 在安装对话框中是模态的，或者，我想要一种在安装程序日志中显示自定义操作的文本/进度的方法。

安装程序是 VS2005 安装项目，自定义操作是 C# 安装程序派生类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T07:25:12.800

显示任何类型的非标准 UI 都需要更改 UI 处理程序对象。这不是微不足道的，实现取决于您用于创作 MSI 的工具包：我不确定 VS 设置项目是否可行。

但是，通过自定义操作显示简单的状态/进度消息并记录到 MSI 日志并不太难，至少不使用[Windows Installer XML (WiX) 工具集](http://sourceforge.net/projects/wix/)，这是我自己用于此目的的工具集。

使用 WiX 编写自定义操作时，您可以通过 Microsoft.Deployment.WindowsInstaller.Session 对象访问活动安装程序会话，该对象具有“日志”（如果启用日志记录，则将消息写入日志）和“消息”（执行任何已启用的日志记录操作并将执行推迟到与引擎关联的 UI 处理程序对象）功能，以及许多其他好东西。

如果您当前已经在 C# 中创建自定义操作，您可能能够在当前环境中找到类似的东西（我从未使用过 VS.net 安装程序项目，所以我不确定它们是如何工作的——实际上，我很惊讶这些允许您创建托管的自定义操作...）。否则，我绝对建议您研究 WiX 以获取自定义操作：这些操作适用于任何 MSI 创作环境，并且非常灵活。

# c++ - 有没有好的轻量级多平台 C++ 定时器队列？

> ID：126966
> 
> 赞同：3
> 
> 时间：2008-09-24T12:58:48.857
> 
> 标签：c++, queue, timer

我正在寻找的是一个简单的计时器队列，可能带有外部计时源和轮询方法（这样它将是多平台的）。每个排队的消息都可以是一个对象，它实现了一个带有`virtual onTimer()`成员函数的简单接口。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T13:39:07.120

`Boost::ASIO`包含一个异步定时器实现。这可能对你有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T13:18:48.900

CodeProject 中有一篇很好的文章，[这里](http://www.codeproject.com/KB/system/timers_intro.aspx)描述了 Windows 中可用的各种计时器，并有标题为“队列计时器”和“制作自己的计时器”的章节。

对于平台独立性，您必须为成`#ifdef -- #endif`对内的不同平台进行实现。我看不出比这更丑的了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T13:43:47.360

它不符合您的所有标准，但是... 我写了一系列关于 Windows 定时器队列的博客文章，该队列是根据外部时间提供程序实现的，并且由线程轮询或驱动。该系列附带源代码和测试，其目的是演示对相当复杂的代码的测试。无论如何，如果没有人提出更合适的方案，您也许可以利用一些代码或想法。

文章从这里开始：[http://www.lenholgate.com/archives/000306.html](http://www.lenholgate.com/archives/000306.html)

# documentation - 对操作系统中使用的“系统调用”机制有很好的描述吗？

> ID：126976
> 
> 赞同：0
> 
> 时间：2008-09-24T13:01:02.437
> 
> 标签：documentation, operating-system, kernel

我正在寻找**系统调用**机制的良好入门或技术描述，操作系统使用该机制从用户空间转换到内核以调用诸如“打开”、“读取”、“写入”等函数......

[除了维基百科](http://en.wikipedia.org/wiki/System_call)条目之外还有其他内容吗？欢迎使用网站、pdf、书籍、源代码 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T13:40:17.540

确切的方法取决于处理器架构以及它定义的转换到内核模式的操作。一种方法，也是 x86 上的传统方法，是使用软件中断。事实证明，这对于一般情况来说并不是很快，所以后来，英特尔补充道`SYSCALL`，AMD 补充道`SYSENTER`。Windows XP 及更高版本在启动时为平台选择适当的系统调用技术。

您可以选择为特定功能使用特定的软件中断号，但通常处理器没有足够的中断来覆盖所有系统功能，因此有必要使其中一个寄存器包含所需的功能号。如果你无论如何都这样做，那么只使用一个系统调用函数并不是什么难事。

Windows CE 6.0 之前的版本使用并行进程虚拟地址模型，该模型实际上允许进程直接相互调用。设置页面保护，以便在完成此操作时发生访问冲突错误：内核获得控制权，修复进程地址空间（将被调用进程移动到插槽 0），修复基于插槽 0 的参数指向到调用进程，并返回到用户模式。因为返回地址在另一个进程中，所以当函数调用返回时，会发生相反的过程。不幸的是，这个模型只允许每个进程使用非常小的虚拟地址空间 (32MB) 和少量的进程 (32)，因此 Windows CE 6.0 恢复为更传统的系统调用模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T13:04:01.650

对于源代码，有很多开源内核可供研究。

至于书籍，[Robert Love 的](https://rads.stackoverflow.com/amzn/click/com/0672327201)关于 Linux 内核的书内容丰富。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T13:25:17.467

你可能想看看 minix 内核。它是开源的，设计简单，在很多 Uni-level OS 课程中使用。在 /usr/src/kernel/proc.c 中进行挖掘，尤其是 sys_call 函数和周边功能。请记住，minix 是一个微内核，因此有些事情可能与您习惯的略有不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T13:35:00.860

如果您想购买一本对 *nix 编程非常有用的书。我会推荐 Stevens 和 Rago 的“UNIX 环境中的高级编程”。它有深入的解释和代码示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T16:46:22.340

有关 Linux 中系统调用的详细说明，请查看[Linux 设备驱动](http://lwn.net/Kernel/LDD3/)程序中的示例设备驱动程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-08T02:37:40.730

它依赖于体系结构，并且需要了解计算机体系结构。Tanenbaum 的“结构化计算机组织”很好地总结了系统调用的基础知识。有关更多信息，请阅读任何有关操作系统设计的教科书。

# orm - ORM：手写模式还是自动生成的？

> ID：126978
> 
> 赞同：5
> 
> 时间：2008-09-24T13:01:29.770
> 
> 标签：orm, schema, rdbms

我应该为使用高级语言（如 Python、Ruby）开发的项目使用手写模式，还是应该让我的 ORM 解决方案自动生成它？最终，我需要在不破坏所有数据的情况下进行迁移。可以绑定到特定的 RDBMS，但如果可以以某种方式支持约束和过程等功能，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T22:35:25.950

我从不使用 ORM 生成的模式。

我发现 ORM 生成模式的方式通常与我希望数据库的结构完全不一致。另外，我知道这是微不足道的，命名方案通常很差。

数据库结构有其自身的约束，我发现 ORM 自动生成工具通常不会充分考虑这些约束。如果您以后想要在您的数据库上运行报告（并且您会这样做），那么拥有良好的数据库结构和设计非常重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T21:08:59.977

请参阅[此 Coding Horror 文章](https://blog.codinghorror.com/get-your-database-under-version-control/)和链接以讨论您最终需要进行的迁移。现在就计划吧。

另见[关于数据库演变的 Martin Fowler](http://martinfowler.com/articles/evodb.html)；我特别推荐测试数据生成是数据库设置的一部分的概念。这个想法可能有点不成熟，因为在不同的环境中，开发与 QA 与生产中的不同问题没有明确的描述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T13:20:21.237

让 ORM 生成它想要的模式。然后你总是可以改变太慢或你想要不同的东西。但它可以让您快速开始并有一些工作，而且 ORM 人员通常知道他们在生成模式时会做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T14:44:43.917

让你的 ORM 解决方案生成它，但不要盲目使用它；通读它并进行完整性检查。

# xml - 用于非 Web 开发应用程序的 XML 与文本

> ID：126979
> 
> 赞同：1
> 
> 时间：2008-09-24T13:01:47.040
> 
> 标签：xml, regex, text

我做了很多系统编程，其中我的应用程序无法用于通过网络进行通信或通过浏览器查看。但是，管理层一直在推动使用 XML。例如，如果我想保留时间日志，我可以使用这样的文本文件：

命令日期时间项目
在 2008/09/23 08:00:00 PROJ1
更改 2008/09/23 09:00:00 PROJ2
出 2008/09/23 12:00:00 PROJ2
在 2008/09/23 01:00： 00 PROJ3
出 2008/09/23 05:00:00 PROJ3

XML 看起来像这样：

`<timelog>` `<timecommand cmd=in date=2008/09/23 time=8:00:00 proj=PROJ1/>`
...
`<timecommand cmd=out date=2008/09/23 time=5:00:00 proj=PROJ3/>`
`</timelog>`

我看到的文本版本的一些初始优势是它易于阅读和使用正则表达式解析。在这种情况下使用 XML 有什么好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T13:05:27.437

我想到了几个好处：

*   更容易解析到其他应用程序中
*   文件内容一目了然更容易理解
*   更容易将数据拉入管理仪表板
*   让管理为您带来快乐，少痛苦

在我看来，缺点是：

*   意味着更改现有代码，可能是不必要的
*   性能可能会略有下降，具体取决于您构建文档的方式与构建当前文档的方式相比
*   为了 XML 的缘故，它是 XML，这太愚蠢了

最后，引用一句讽刺的话：*XML 就像暴力。如果它不能解决你的问题，那是你使用的不够多*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T14:00:01.737

使用基于文本的数据格式绝对没有错。几十年来，它一直是事实上的标准。大型大型机金融系统今天*仍在*使用它。好处是它的生产微不足道，消费微不足道，而且非常轻巧。那么日志文件呢？您是否知道任何*不*以分隔文本格式（Web、应用程序、数据库服务器）生成其日志文件的生产平台？

纯文本文件的缺点是，如果格式发生变化，那么您必须对生产者端和消费者端都进行修改以支持格式更改。当然，如果只是一个人消费结果，那么你只需要改变生产者。

XML 的美妙之处在于数据的解析不仅独立于数据，而且独立于数据的格式。从逻辑上讲，您将数据和数据格式都传递给它，然后就可以了！一切正常。这并不是那么简单，但这就是前提。您可以更改数据的格式，您的生产者和消费者只需进行微不足道的更改（如果有的话）。

XML 的丑陋之处在于它可能是一个巨大的性能狗（SOAP 任何人？）和非常重的重量。你肯定会为它的可扩展性付出代价。在某些情况下，它绝对是给定问题域的优化技术解决方案，而在其他情况下则不是。

因此，如果它是人类可以阅读的简单日志，请将其保留为平面文件。如果它是一个简单的应用程序与另一个应用程序通信，*并且*通信不会随着时间的推移而发生巨大变化，那么平面文件肯定会更快更轻地实现，但 XML 不是一个糟糕的选择。如果多个应用程序需要使用您提供的数据，或者通信更改量会很大，那么请使用 XML。如果您这样做，界面的维护将随着时间的推移更容易维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T13:08:09.783

在这种情况下，XML 的主要特点是可以验证和控制 XML。在文本版本中，您将如何以编程方式验证文件格式是否正确？XML 旨在创建结构化的有效文档，由此产生的好处是格式受到严格控制且结构可靠。维护从 XML 节点读取的代码也将比维护一系列用于读取文本文件的正则表达式更容易且布局更合理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T13:12:36.060

如果您使用 XML，那么在某些方面，数据会更“便携”。在大多数环境中，您基本上都可以使用数据解析器，因此编写一个分析数据的工具可能会更容易。此外，如果它是 XML，那么您可以编写一个 XSLT 将其转换为各种其他格式，使其更易于阅读。

也就是说，如果您改用 XML，即使是像您提供的示例这样的简单格式，您的日志文件也会变得更大。

除了 XML 之外，您还可以使用一些选项。Jeff 的[Angle Bracket Tax](http://www.codinghorror.com/blog/archives/001114.html)博客文章谈到了这一点。

实际上，您应该做的是找出这些日志将如何使用，然后确定哪种格式可以使这些用法最容易实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T13:06:14.750

使用 regex 和 xml 和 xsl 很容易解析它。

说实话，除非您将数据发送到另一个系统，否则使用 XML 并没有真正的“优势”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T13:08:15.183

XML 是一种元格式，这意味着它可以更轻松地为数据定义格式。这使得多个程序（包括不同公司的程序）更容易以相同格式读取和写入数据。它特别适合作为复杂、分层数据的描述。

在您上面概述的示例中，数据看起来是固定格式的独立记录，没有结构或层次结构 - 在这种情况下，我看不出使用 XML 的优势。但是，该示例可能不具代表性 - 您的其他文件可能包含更多结构化数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T13:13:28.150

那是一个持续的日志文件吗？

您将如何编写来创建有效文档？还是您要读入，添加新条目，然后每次都写出来？

日志文件是您只需附加到结构良好的纯文本行的完美候选者。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T13:14:44.107

在大多数情况下（并非总是如此），XML 使理解数据变得更容易，因为突然之间，您的资产周围有了元数据，描述了您面前的内容（人类可读）。

XML 也非常易于访问。我的意思是——既然你提到了它——你不想在 XML 上使用正则表达式。有像[XPATH](http://en.wikipedia.org/wiki/XPath)（XML 路径语言）这样的工具可以让查询 XML 变得有趣。当您可以使用 XPATH 之类的东西轻松地遍历 XML 时，无需抽出其他人无法阅读的内容。

在某些情况下，XML 会做相反的事情（在可读性方面），有时 XML 也是开销。当您在系统之间交换数据时，它并不总是最好的选择（例如，看看像[JSON](http://www.json.org/index.html)这样非常轻量级的东西）。而且这种交换也不需要在网络上。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T13:14:51.687

虽然将 XML 用于数据文件意味着您的数据可以自我描述并且可能组织得更好，但最终结果通常是比以前大得多的数据文件。

问问自己，这些文件是用来做什么的？他们要改变吗？如果是这样，谁在支付，谁为它做预算？

在某些情况下我喜欢 XML，而在其他情况下我讨厌它！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-24T13:21:34.043

在像您所说的系统批处理编程的情况下，xml 的一个主要特性是它几乎在所有地方都受支持。因此，您今天使用 xml 编写了一个程序来处理一些数据，而在 10 年后，当您需要彻底检查该程序并希望使用完全不同的平台时，您的 xml 数据仍然会得到很好的支持。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-24T13:30:58.483

如果您使用 .NET（尤其是带有 LINQ to XML 的 .NET 3.5）进行开发，那么与仅使用纯文本文件相比，您将编写更少的代码来读取/写入 XML。另外，XML 只是让任何下线的人都可以更轻松地阅读文件并准确了解其中的内容和用途。而且，不用担心 XML 占用更多的磁盘空间，磁盘空间很便宜。

# c# - XBAP 中的键盘快捷键

> ID：126980
> 
> 赞同：4
> 
> 时间：2008-09-24T13:01:53.357
> 
> 标签：c#, wpf, browser, keyboard-shortcuts, xbap

我想在我的 WPF XBAP 应用程序中支持键盘快捷键，例如`Ctrl`+`O`表示“打开”等。如何禁用浏览器的内置键盘快捷键并将其替换为我自己的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-29T14:26:42.993

如果您不顾一切地这样做，那么您可以尝试添加一个 windows 挂钩并拦截您感兴趣的击键。

我们必须这样做以防止 IE 帮助打开（愿上帝怜悯我的灵魂）。

请参阅：http: [//msdn.microsoft.com/en-us/library/system.windows.interop.hwndsource.addhook (VS.85).aspx](http://msdn.microsoft.com/en-us/library/system.windows.interop.hwndsource.addhook(VS.85).aspx)

这里有一些代码（从我们的 app.xaml.vb 中提取）可能会有所帮助（对不起，VB）：

```
Private Shared m_handle As IntPtr
Private Shared m_hook As Interop.HwndSourceHook
Private Shared m_hookCreated As Boolean = False

'Call on application start
Public Shared Sub SetWindowHook(ByVal visualSource As Visual)
    'Add in a Win32 hook to stop the browser app from loading
    If Not m_hookCreated Then
        m_handle = DirectCast(PresentationSource.FromVisual(visualSource), Interop.HwndSource).Handle
        m_hook = New Interop.HwndSourceHook(AddressOf WindowProc)
        Interop.HwndSource.FromHwnd(m_handle).AddHook(m_hook)
        m_hookCreated = True
    End If
End Sub

'Call on application exit
Public Shared Sub RemoveWindowHook()
   'Remove the win32 hook
    If m_hookCreated AndAlso Not m_hook Is Nothing Then
        If Not Interop.HwndSource.FromHwnd(m_handle) Is Nothing Then
            Interop.HwndSource.FromHwnd(m_handle).RemoveHook(m_hook)
        End If
        m_hook = Nothing
        m_handle = IntPtr.Zero
    End If
End Sub

'Intercept key presses
Private Shared Function WindowProc(ByVal hwnd As System.IntPtr, ByVal msg As Integer, ByVal wParam As System.IntPtr, ByVal lParam As System.IntPtr, ByRef handled As Boolean) As System.IntPtr
    'Stop the OS from handling help
    If msg = WM_HELP Then
        handled = True
    End If
    Return IntPtr.Zero
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T15:48:29.493

您不能禁用浏览器的内置键处理。覆盖浏览器自己的快捷键不是您作为浏览器内容的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T21:23:53.400

不是答案，而是评论。在 XBAP 中禁用退格键行为会很好，没有什么比在不在元素中时按退格键更烦人的了，浏览器会将您导航到上一个网页。

# nhibernate - Spring.net + Nhibernate 集成测试在不应该通过时通过

> ID：126987
> 
> 赞同：0
> 
> 时间：2008-09-24T13:02:37.443
> 
> 标签：nhibernate, integration-testing, spring.net

我正在使用 Spring.net 和 NHiberante (HibernateTemplate) 来实现我的 DAO。

我还有一些从“AbstractTransactionalDbProviderSpringContextTests”扩展而来的集成测试。

DI 工作正常，所有测试都通过了，但有时**即使不应该**通过，它们也会通过。

例如，如果我的 hbm.xml 文件有这样的错误：

`<class name="Confluence.Domain.User" table="THIS TABLE DOES NOT EXIST">`

测试失败，但如果错误是这样的：

`<many-to-many class="Confluence.Domain.User" column="THIS COLUMN DOES NOT EXIST"/>`

测试通过默默地隐藏错误。

我正在使用 SetComplete() 对其进行测试并检查数据库的更改，但我认为这种测试的整个想法不是这样做。

谁能告诉我如何解决这个问题？

非常感谢你！

@Ben：如果我必须实际执行 SQL 脚本来查看它们是否有效，那么使用这种 Spring 测试有什么好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T19:50:18.663

在测试基于 NH 的 DAO 时，您应该刷新会话，以便使用新信息更新数据库，但仍像以前一样回滚。此处解释了如何执行此操作 - [http://forum.springframework.net/showthread.php?t=5246](http://forum.springframework.net/showthread.php?t=5246) 我已将此添加到参考文档中。希望这可以帮助。

干杯，马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T13:09:18.270

如果您的映射中有语法错误，那么 NHibernate 将在 config.BuildSessionFactory() 上失败

但是对于拼写错误/不存在的数据库对象，NHibernate 知道的唯一方法是实际运行查询......所以您可能会使用一些集成测试来测试单个实体上的插入/选择，以确保它有效。

不确定这与 Spring.NET 有什么关系。

# java - 如何在 j2me 手机中读取控制台输出？System.out.println() 去哪儿了？

> ID：126999
> 
> 赞同：3
> 
> 时间：2008-09-24T13:05:14.767
> 
> 标签：java, mobile, java-me, system.out

为手机编写 j2me 应用程序时，`System.out.println()`如果使用模拟器，则使用控制台上的打印。但是，当代码部署在手机上时，控制台输出到哪里去了？

如果无法在未连接的手机中看到这一点，如果手机仍然连接到部署的 PC [通过 USB]，有没有办法看到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-30T17:47:01.610

在 Symbian 手机（诺基亚、索尼爱立信、摩托罗拉、三星、松下、西门子，检查 Series60、Series80、Series90 或 UIQ 平台）上，您可以检索 System.out 和 System.err。最重要的是，您也可以检索 Throwable.printStackTrace()。

Symbian OS 的早期版本带有一个名为 Redirector 的本地工具。它最终也可供第三方 MIDlet 开发人员使用。现在可能很难找到它，但可以使用插入 Java 虚拟机使用的 C 标准库的 Symbian 实现的 C++ 代码重新开发。

较新版本的 Symbian OS 带有一个额外的 GCF 协议，它允许通过简单地使用检索 System.out、System.err 和 Throwable.printStackTrace()

`javax.microedition.io.Connector.openDataInputStream("redirect://");`

在从 Sun Ltd cldc-hi 虚拟机过渡到 IBM J9 虚拟机期间，您可能需要在某些版本的 Series60 上使用“redirect://test”。

在启动要记录其输出的 MIDlet 之前，需要打开连接，因此您需要在单独的 MIDlet 中打开它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T13:19:41.007

我在 j2me 日志记录中找到[了这个问题的答案。](https://stackoverflow.com/questions/120618/logging-in-j2me)如果没有其他方法，也许可以尝试一下。不过，一种简单的访问方式`System.out.println()`会很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-25T00:17:51.710

感谢您对 QuickRecipesOnSymbian 的回复。

在以下文章中，您可以找到相应的 J2ME MIDlet 以在 Symbian 手机上显示标准错误/输出：

[http://wiki.forum.nokia.com/index.php/How_to_get_System.out_output_from_a_MIDlet_and_save_it_to_a_file_in_S60_devices](http://wiki.forum.nokia.com/index.php/How_to_get_System.out_output_from_a_MIDlet_and_save_it_to_a_file_in_S60_devices)

该解决方案也适用于三星 i8910。（由于我是这个网站的新手，我不能发布多个链接，所以你需要在文章末尾找到包含源代码和 jar 的 zip。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T11:00:37.700

简单的答案是：你看不到它们。它确实在某处打印（因为如果您有大量打印件，大量手机会减慢速度）但是，在大多数手机上，无法访问它。

有些设备会显示控制台输出，例如 Sony Ericssons，如果系留并运行设备上的调试程序，它会显示所有内容。您可以通过搜索各种制造商的开发人员网站（如果存在）来找出哪些可以，哪些不可以。

最好的办法是编写一个附加到程序中的 StringBuffer 的小方法。然后映射一个按键，它将在屏幕上显示 StringBuffer 的内容。它对于搜索那些令人讨厌的设备问题非常宝贵。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-05T04:04:22.920

您还应该确保不要在生产代码中包含 println。

我看到一些手机在执行此操作时实际上存在内存泄漏（例如 Sprint 上的 Sanyo 8400。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T16:04:32.043

我能提供的唯一意见是，这在每个平台上都会有很大不同。我主要使用 BlackBerry 和 System.err 进入设备事件日志，但我不知道 System.out 去哪里。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T15:25:10.397

例如，BlackBerry J2ME 设备可以连接到计算机，调试器可以连接到该设备。在实际设备上运行程序后，您的`System.out`OutputStream 将转到调试器控制台。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-13T17:27:44.230

登录设备始终是 J2ME 的一个问题，因为它没有标准实现。我可以给你打电话给[GEAR](http://www.digitalapes.net/en/applications/gear/)。它是一个 J2ME 图形框架，它还实现了一个“设备内”调试控制台，您可以在其中打印行并在屏幕上显示它们。*****