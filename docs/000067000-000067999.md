# StackOverflow 问答 000067000-000067999

# graphics - 用于图形应用程序的快速、像素精度的 2D 绘图 API？

> ID：67000
> 
> 赞同：5
> 
> 时间：2008-09-15T21:10:09.447
> 
> 标签：graphics, drawing, 2d

我想创建一个跨平台的绘图程序。编写我的应用程序的一个要求是我在画布上具有像素级精度。例如，我想编写自己的画线算法，而不是依赖别人。我不想要任何形式的抗锯齿（同样，需要像素级控制。）我希望屏幕上的用户交互快速且响应迅速（取决于我编写快速算法的能力。）

理想情况下，我想用 Python 或 Java 作为第二选择来编写它。必须能够轻松地使最终的应用程序跨平台。如有必要，我将提交给不同操作系统上的不同 API，只要我可以围绕它们编写一个抽象层。有任何想法吗？

*附录：我需要在屏幕上*绘图的能力。绘制到我已经弄清楚的文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T21:43:51.503

本周，我整理了一些幻灯片和演示代码，用于使用库 pyglet 从 python 中使用 OpenGL 进行 2d 图形。这是一个有代表性的帖子：[Pyglet 第 2 周，更好的顶点吞吐量](https://www.tartley.com/posts/pyglet-week-2-better-vertex-throughput/)（或[使用相同基本思想的 3D 东西](https://www.tartley.com/posts/flying-high-hobbyist-opengl-from-python/)）

它非常快（相对而言，对于 python）我已经设法让大约 1,000 个独立定位和定向的对象在屏幕上移动，每个对象有大约 50 个顶点。

它非常便携，我在这个环境中编写的所有代码都可以在 windows、Linux 和 mac（甚至像 Pypy 这样的晦涩环境）上运行，而我无需考虑它。

其中一些帖子很旧，它们之间的链接断开了。您应该能够[使用“图形”标签](https://www.tartley.com/categories/graphics/)找到所有相关帖子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T21:38:45.290

Python的[Pyglet](http://www.pyglet.org/)库可能适合您的需要。它允许您使用 OpenGL，一个跨平台的图形 API。您可以禁用抗锯齿并将屏幕区域捕获到缓冲区或文件中。此外，您可以使用它的事件处理、资源加载和图像处理系统。您可能还可以将其与 PIL（Python 图像库）以及流行的跨平台矢量图形库 Cairo 相关联。

我提到 Pyglet 而不是纯 PyOpenGL，因为 Pyglet 透明地处理了很多丑陋的 OpenGL 东西，而您无需付出任何努力。

我和一个朋友目前正在使用 Pyglet 开发一个绘图程序。有一些怪癖——例如，OpenGL 在 OS X 上总是双缓冲，所以我们必须绘制两次，一次用于当前帧，另一次用于另一帧，因为每当显示刷新时它们都会翻转。[您可以在这个 subversion 存储库](http://cwru-hackers.googlecode.com/svn/splatterboard/)中查看我们当前的进展。（主干中的 Splatterboard.py 是您要运行的文件。）如果您不打算使用 svn，我很乐意通过电子邮件向您发送最新源代码的 .zip。如果您调查它，请随意窃取代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T05:14:48.690

如果语言选择打开，则使用 Haxe 创建的 Flash 文件可能会有一个位置。Haxe 是免费的，并且是一种完整的动态编程语言。然后是相关的 Neko，一个可以在 Mac、Windows 和 Linux 上运行的虚拟机（如 Java、Ruby、Parrot...）。在某些方面作为 Flash 的一种新改进形式，它自然可以绘制东西。 [http://haxe.org/](http://haxe.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T21:21:17.610

如果您想使用 C++，QT 的 Canvas 和 QPainter 非常适合这项工作。它是跨平台的。

QT 有一个 python 绑定，但我从未使用过它。

至于Java，使用SWT，画布的像素级操作有些困难和缓慢，所以我不推荐它。另一方面，Swing 的 Canvas 非常好并且反应灵敏。我从未使用过 AWT 选项，但您可能不想去那里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T21:59:56.923

我会推荐[wxPython](http://www.wxpython.org/)

它非常漂亮地跨平台，您可以获得每像素控制，如果您改变主意，您可以将它与 pyglet 或 agg 等库一起使用。

您可以在文档和演示下载中找到一些有用的示例来说明您正在尝试做的事情。

# algorithm - 什么是确定传入金额是否可以从一组数字中加法构建的好算法？

> ID：67004
> 
> 赞同：0
> 
> 时间：2008-09-15T21:10:26.327
> 
> 标签：algorithm

> **可能重复：**
> [从大小为 n 的列表中查找哪些数字总和到另一个数字的算法](https://stackoverflow.com/questions/83547/algorithm-to-find-which-numbers-from-a-list-of-size-n-sum-to-another-number)

什么是确定传入金额是否可以从一组数字中加法构建的好算法？就我而言，我正在确定是否可以通过将一组钞票（例如 5 美元、10 美元和 20 美元钞票）的某种组合相加来满足某个货币金额（例如 40 美元）。这是一个简单的示例，但该算法需要适用于钞票集可能随时间变化（由于钞票用完）或由于钞票面额因货币而异的一般情况。该问题适用于机场的外汇柜员。

所以 50 美元可以用一组（20 美元和 30 美元）来满足，但不能用一组（20 美元和 40 美元）来满足。

此外。如果金额无法用可用的钞票面额支付，您如何确定可以满足的最接近的高于和低于的金额？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T21:12:56.227

您正在寻找硬币找零问题：

*   [http://en.wikipedia.org/wiki/Coin_problem](http://en.wikipedia.org/wiki/Coin_problem)

*   [http://www.egr.unlv.edu/~jjtse/CS477/DP%20Coin%20Change.html](http://www.egr.unlv.edu/~jjtse/CS477/DP%20Coin%20Change.html)

*   [http://www.algorithmist.com/index.php/Coin_Change](http://www.algorithmist.com/index.php/Coin_Change)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T21:18:12.173

这似乎与子集和问题密切相关，通常是 NP-Complete。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T15:33:49.107

你知道 - 你现在两次问了同样的问题。

[什么是一个好的非递归算法来决定是否可以从一组数字中加法构建传入的数量？](https://stackoverflow.com/questions/64723/what-is-a-good-non-recursive-algorithm-for-deciding-whether-a-passed-in-amount)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T21:13:00.047

从最大的账单开始，然后向下工作。对于每种面额，从这些钞票中数量最多的开始，然后向下计算。您可能需要较少的大面额，因为您需要多个较小的面额才能达到正面价值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T21:19:53.730

总和 = 100 张
钞票 = (40,30,20,10)

40 的数量 = 100 / 40 = 2 余数 = 100 % 40 = 20

30 的数量 = 20 / 30 = 0 余数 = 20 % 30 = 20

20 的数量 = 20 / 20 = 1 余数 = 20 % 20 = 0

只要余数 = 0，您就可以停止。

如果你的账单用完了，那么你就无法弥补，需要进入第二部分，即你能走多远。这是一个可以用线性代数方法解决的最小化问题（我对此有点生疏）

# google-maps - 谷歌地图交通信息

> ID：67009
> 
> 赞同：2
> 
> 时间：2008-09-15T21:10:36.760
> 
> 标签：google-maps

某些地区的谷歌地图可以提供交通信息，显示阻塞的道路等。我想知道是否有任何代码示例演示如何为我自己的地区提供交通信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T21:18:38.897

“Google Maps Hacks”对此有一个hack，[“Hack 30\. Stay Out of Traffic Jams”](http://safari.oreilly.com/0596101619/googlemapshks-CHP-4-SECT-3)。

[您还可以从 John Resig 的“交通状况数据”](http://ejohn.org/blog/traffic-conditions-data/)文章中了解如何获取美国交通信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T22:34:52.690

对于您自己的数据，您需要实现[自定义图块叠加](http://code.google.com/apis/maps/documentation/overlays.html#Tile_Overlays)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T21:16:45.903

谷歌对他们使用什么来源获取流量数据一无所知。您可以直接联系他们，看看他们是否想为您实现某些东西，但我的猜测是，如果他们真的想要您的数据，他们只会将您推荐给他们的提供商。

请记住，交通数据不仅适用于大都市地区，但谷歌没有使用它的原因有很多——其中一个重要原因是，在有交通图块的区域中，用于交通叠加的整个图块集都有每15分钟左右重新生成一次。它只是无法扩展。

因此，即使您设法将数据放入他们的流程中，它也可能不会被渲染。

-亚当

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T11:58:56.737

我发现 googl 有一个名为 GTrafficOverlay 的类，它基于扩展 GOverlay 类。现在，越来越清楚我正在寻找 GTrafficOverlay 的开放实现

# c++ - 在 Linux 中将 boost-python 与 C++ 一起使用

> ID：67015
> 
> 赞同：3
> 
> 时间：2008-09-15T21:11:30.050
> 
> 标签：c++, boost-python

我的开发商店已经组装了一个相当有用的基于 Python 的测试套件，我们想用它来测试一些基于 Linux 的 C++ 代码。我们已经得到了他们与 Boost 一起发布的测试项目来编译（在目录中输入“bjam”并且它可以工作），但是我们的实际项目存在问题。

从源代码（v1.35.0）构建boost库和bjam，当我运行bjam时，我在bin/gcc-4.1.2/debug目录中得到一个.so。我运行 python 和“import”，我得到： ImportError: `libboost_python-gcc41-d-1_35.so.1.35.0`: cannot open shared object file: No such file or directory

查看库目录，我有以下内容： `libboost_python-gcc41-mt-1_35.so` `libboost_python-gcc41-mt-1_35.so.1.35.0` `libboost_python-gcc41-mt.so`

显然我需要 -d 而不是 -mt 库，或者指向 -mt 库而不是 -d，但我不知道如何让我的 Jamroot 文件做到这一点。

当我安装 Debian Etch 的库版本时，我得到“/usr/include 中没有 Jamfile” - 并且有一个 debian 错误说他们遗漏了系统级 jamfile。

我更有希望让它从源头工作，所以如果有人有任何解决图书馆问题的建议，我想听听他们的意见。

对答案 1 的回应：感谢您的提示。那么，你知道我将如何让它使用 MT 库吗？这似乎是 bjam 或我正在使用的 Jamfile 的问题，我认为我处于调试模式，即使我找不到任何标志。虽然我知道如何在对 GCC 的调用中包含特定库，但我看不到从 Boost 端配置它的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T21:42:30.773

如果您还想构建 boost 库的调试变体，则必须使用选项调用 bjam `--build-type=complete`。

在 Debian 上，您可以在 python2.x-dbg 包中获得调试 Python 解释器。如果您想使用系统 Boost，则 Boost 库的调试版本位于 libboost1.xy-dbg 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T14:27:47.750

找到了解决方案！Boost 默认构建一个调试版本。键入“bjam release”构建发布配置。（据我所知，这没有在任何文档中列出。）请注意，这与将构建类型更改为发布不同，因为这不会构建发布配置。按照 Torsten 的建议进行“完整”构建也不会阻止它仅构建调试版本。

还值得注意的是，-d 库位于`<boost-version>`/bin.v2/libs/python/build/ `<gcc version>`/debug/ 中，而发布库位于`<gcc-version>`/release 中，并且未安装到顶级“libs”目录中。

感谢其他建议！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T21:33:38.283

重要的一点：-d 当然意味着调试，并且应该只链接到项目的调试版本，**并且只能与 python 的调试版本一起使用（或不，见下文）**。如果您尝试将调试库链接到非调试版本，或者尝试将调试 pyd 导入非调试 python，则会发生不好的事情。

mt 表示多线程，与 d 正交。您可能想为您的项目使用 mt non-d。

恐怕我不知道如何告诉 gcc 要链接什么（我一直在使用 Visual Studio）。要尝试的一件事：

```
man gcc 
```

某个地方应该告诉您如何在链接器上强制使用特定的库。

编辑：实际上，您可以将项目的调试版本导入 python 的非调试版本。无论您在哪里包含 python.h，都应包含 boost/python/detail/wrap_python.hpp。

# bazaar - 如何导出子文件夹的 Bazaar 历史

> ID：67021
> 
> 赞同：4
> 
> 时间：2008-09-15T21:12:17.820
> 
> 标签：bazaar

我正在编写一个框架以及一个使用该框架的项目。该项目是一个 Bazaar 存储库，框架位于项目下方的子文件夹中。

我想为框架提供一个自己的 Bazaar 存储库。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-26T11:18:26.910

您使用拆分命令：

```
bzr split sub_folder 
```

这会在子文件夹中创建一个独立的树，您现在可以单独导出和处理它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T20:54:50.340

使用快速导入插件（[http://bazaar-vcs.org/BzrFastImport](http://bazaar-vcs.org/BzrFastImport)）：

1) 将所有历史记录导出到流中：

```
bzr fast-export BRANCH > full-history.fi 
```

2）过滤历史以产生新的流：

```
bzr fast-import-filter -i subfolder full-history.fi > subfolder.fi 
```

3）仅使用子文件夹重新创建新分支：

```
bzr init-repo .
bzr fast-import subfolder.fi 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T21:24:45.853

据我所知，没有办法通过集市轻松做到这一点。一种可能性是获取原始项目，将其分支，然后删除与框架无关的所有内容。然后，您可以将子目录中的文件移动到主目录。这是一件苦差事，但可以保留历史。

你最终会得到类似的东西：

```
branch project:
.. other files.. 
framework/a.file
framework/b.file
framework/c.file

branch framework: 
a.file
b.file
c.file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T17:51:01.220

据我所知，Bazaar 还不支持“嵌套”分支。Git 支持“子模块”，其行为类似于 Subversion 外部。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-09T04:36:45.310

我曾尝试使用 bzr split 来执行此操作，但是，这并不符合我的预期。

*   生成的分支仍然包含所有原始目录中所有文件的历史记录，并且完全签出会检索所有文件。看来 split 所做的唯一事情是将存储库转换为丰富的根存储库，以便这个特定的树只能属于某个子目录，但存储库仍然包含所有其他目录，其他签出仍然可以检索整个树。

我在上面 jamuraa 的答案中使用了该方法，这对我来说要好得多，因为我不必纠结于转换为新的存储库类型。这也意味着从该存储库进行完整的签出/分支只会重新创建我想要的文件。

但是，它仍然有一个缺点，即存储库存储了所有这些“已删除”文件的历史记录，这意味着它占用了不必要的空间（如果您不希望人们能够看到，这可能是一个隐私问题这些“其他”目录的旧版本）。

因此，将不胜感激更多关于将 Bazaar 分支切割到其子目录之一同时永久删除其他所有内容的历史的建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-09T21:23:17.067

做一个

```
bzr init .
bzr add .
bzr commit 
```

在框架目录中。

然后您可以分支并合并到该目录。

更高层的集市会忽略该目录，直到您加入。

Bazaar 明白当你做类似的事情时

```
bzr branch . mycopy
bzr branch . myothercopy 
```

当前目录 .bzr 不会跟踪这些子目录的更改。

它使您免于寻找放置分支的地方。

# google-maps - 谷歌地图以当地语言提供方向

> ID：67029
> 
> 赞同：1
> 
> 时间：2008-09-15T21:13:04.523
> 
> 标签：google-maps

我注意到当我使用谷歌浏览器时，谷歌地图以我的本地语言（匈牙利语）提供方向，但当我从 IE 使用它时，它会提供英语方向。

我想知道 chrome 是如何解决这个问题的，以及如何编写始终以用户语言返回方向的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T21:18:56.977

`HTTP`requests` 包含一个**Accept-Language 标头**，该标头是根据您在大多数操作系统/浏览器组合上的区域设置偏好设置的。Google 会结合使用您使用的本地域（例如“google.it”、“google.hu”）以及您通过主页中的“首选项”链接设置的任何首选项来为您的网页分配语言。

很可能 IE 向 Google 地图歪曲了您的语言环境，而 Chrome 已经正确猜到了。您可以通过在控制面板中更改您的国家设置来更改 IE 的区域设置，而 Chrome 的区域设置可以在（扳手菜单）> 首选项中更改。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-15T21:14:49.357

我可能会走得很远，但我认为假设谷歌正在使用齿轮是相当安全的。

# javascript - jQuery 与其他 JavaScript 库相比有哪些优势？

> ID：67045
> 
> 赞同：19
> 
> 时间：2008-09-15T21:15:48.887
> 
> 标签：javascript, jquery, mootools, yui, prototypejs

我试图说服那些在我目前的组织中制定标准的人，我们应该使用 jQuery 而不是 Prototype 和/或 YUI。我可以用哪些令人信服的优势来说服他们？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-15T21:20:11.107

jQuery 的 3 个主要优点是：

*   与其他 javascript 框架相比，它的重量很轻
*   它有广泛的[插件](http://plugins.jquery.com/)可用于各种特定需求
*   设计人员更容易学习 jQuery，因为它使用熟悉的 CSS 语法。jQuery 是 [面向设计师的 Javascript](http://www.sitepoint.com/article/jquery-javascipt-designers/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-15T21:43:44.233

我会说我使用 JQuery 的主要原因是：

*   大型开发社区和许多插件。
*   它在微软的雷达上，他们正在添加一些插件支持和调试功能。
*   非常好的第 3 方库文档。
*   轻的。
*   链接功能非常强大。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-16T14:14:49.793

这是您能找到的最深思熟虑的语言——它几乎是直观的。

想要元素的宽度？

```
$('#something').width(); 
```

想要抓取一个元素，隐藏它，改变它的背景颜色并淡入淡出？

```
$('#something').hide().css('background', 'red').fadeIn(); 
```

IE 的表条带化怎么样（假设`hover`定义了类）？

```
$('table tr').hover(function() {
  $(this).addClass('hover');
}); 
```

像这样快速、无脑的工作确实有助于销售 jQuery。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-16T20:23:27.287

这是比上面提供的更新的速度测试。上次我运行它时，dojo 是最快的，其次是 jQuery、Mootools、Prototype，最后是 YUI。请注意，我在 Firefox 3 中运行它，不同浏览器的速度不同，因此请自行测试。

[流畅的速度测试](http://mootools.net/slickspeed/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-15T21:26:15.867

在我看来，曾短暂尝试过 Prototype，然后又尝试并爱上了 jQuery：jQuery API 感觉更加干净且经过深思熟虑。jQuery 的创建者/架构师 John Resig 非常了解他的东西，并且在 jQuery 的设计以及他参与的各种其他令人印象深刻的 JavaScript 项目中都体现了这一点。

查询和可链接性的整个概念非常适合 DOM 操作，这似乎是人们使用 JS 库的主要目的。在线文档很棒。性能似乎也非常好。鉴于它的功能，整个库适合一个相对较小的包。插件架构也非常适合可扩展性。

老实说，我还没有尝试过 YUI，所以我不能对此发表太多评论。我确实知道它总体上是一个相当庞大的库，尽管您可以选择仅下载/使用它的特定模块。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-15T21:43:43.420

1.  它非常小，尤其是在缩小时，并且在核心库中提供了很多功能。

2.  它也很容易扩展，并且有一个活跃的社区。

3.  最后，它非常容易学习；一旦掌握了核心概念，您就可以立即开始编写复杂的解决方案。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-15T21:51:11.453

一个赞成的论点是这样的：

流行性+可扩展性

1) 如果有人需要用 JavaScript 做 X，那可能是用 jQuery 做的
2) 如果做了很多，可能有一个插件，如果不是原生支持的话

如果它**真的很**独特，那么有很多人会在 SO 或其他地方回答您的问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-15T21:19:52.683

jQuery 的一个优势是开发了大量插件的大型社区。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-07-29T00:44:52.923

您可以点击[此链接](http://www.codedigest.com/Articles/jQuery/273_Introduction_to_jQuery_in_ASPNet_and_10_Advantages_to_Choose_jQuery.aspx)了解更多关于 jQuery、为什么要使用它以及它的优点是什么。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-11-28T12:50:53.087

出色地...

首先你应该考虑一下为什么你认为 jQuery 很好，但你不知道用什么论据来说服别人。也许你应该先说服自己。;)

无论如何，jQuery 只是另一个框架。你应该使用它最擅长的。如果您打算将它仅用于基本的 DOM 处理，请忘记它！学习如何正确使用js，你会没事的！

考虑这个 HTML：

```
<body>
<div style="width: 400px; height: 400px; background-color: red">
<div style="width: 400px; height: 400px; background-color: red">
</div>

<script type="text/javascript">

function test1 (){
document.body.innerHTML = ""

var div = document.createElement("div");

document.body.appendChild(div);

$(div).width("400px").height("400px").css("background-color", "red");
}    

function test2 (){
document.body.innerHTML = ""

var div = document.createElement("div");

document.body.appendChild(div);

$(div).width("400px");
$(div).height("400px");
$(div).css("background-color", "red");
}

function test3 (){
document.body.innerHTML = ""

var div = document.createElement("div");

document.body.appendChild(div);

div.style.width = "400px";
div.style.height= "400px";
div.style.backgroundColor = "red";
}

function test4 (){
    document.body.innerHTML = ""

    var div = document.createElement("div");

    document.body.appendChild(div);

    div.setAttribute("style", "width: 400px; height: 400px; background-color: red");
}

</script>
</body> 
```

将其放入带有 jquery 的 hml 文件中`<head>`

然后，打开 firebug 并运行以下代码：console.profile(); 测试1（）；控制台.profileEnd();

```
console.profile();
test2();
console.profileEnd();

console.profile();
test3();
console.profileEnd();

console.profile();
test4();
console.profileEnd(); 
```

看看你自己的结果！

但是，如果您想对 DOM 进行一些复杂的操作，这需要您进行多次循环或找出 DOM 上的元素是否符合某些条件，您可以考虑使用 jQuery，因为它会为您实现此过程。

无论如何，请记住，没有什么比使用您在代码中保留的引用来控制 DOM 更好的了。它的速度更快，对其他人来说更具可读性。谷歌“js 最佳实践”。

我将 jQuery 用于复杂的事情，这将花费我太长时间来实现，并且最终会得到类似于 jQuery 代码的东西。在这种情况下，使用它是有意义的！

玩得开心！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-04-12T15:37:22.293

根据经验，每个人都有自己的优势和劣势，因为它们在您的应用程序中扮演着非常具体的角色。做出全球决定可能不是最合适的方法。制定手头的具体任务并分析性能、膨胀、经验等，然后做出具体的决定/建议。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-15T21:36:31.037

也许你不应该？这完全取决于您正在构建的应用程序类型。如果您正在构建 GUI 密集型应用程序，例如 Yahoo! 邮件，那么也许你应该考虑在 jquery 上使用 YUI 或 Mootools。就我个人而言，我是 jQuery 的忠实粉丝，但它绝对是为原本大部分是静态的 UI 添加一点交互的最佳选择。另一方面，如果这是您将使用它的目的，那么 jquery 会简单得多，语法更好，并且有很大的动力。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-15T21:23:31.193

我是一个原型人，但我用过一点 jQuery。老实说，两者之间没有太多可以用作“卖点”的地方。另一方面，YUI 相当臃肿。我永远不会在任何商业级应用程序上使用它。

我发现[这个页面](http://www.barneyb.com/barneyblog/2008/05/07/prototype-and-jquery/)讨论了这个确切的主题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-16T00:55:25.787

Jquery 已经存在了几年，所以就像其他人所说的那样，它有一个深厚的社区、大量的插件和良好的支持。对我来说把它放在一边的是它很容易学习。

见[http://visualjquery.com/1.1.2.html](http://visualjquery.com/1.1.2.html)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-15T22:13:46.593

它有一套很好的插件，编码风格不显眼，这意味着它不太难替换。Ruby on Rails 助手也有一个很好的替代品，称为 jRails。

在性能方面，它们都非常接近：[http](http://www.kenzomedia.com/speedtest/) : //www.kenzomedia.com/speedtest/ 但是，MooTools、dojo、ext 和 Prototype 在我的环境中都运行得更快。

**我的问题是 - 你为什么要使用它？只是因为你更了解它吗？**

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-30T23:41:25.103

我已经使用 jQuery 几个月了，发现它是一种愉快的体验。该框架清晰简洁，它具有出色的插件架构并且得到很好的支持，但是框架是非常个人化的东西，您可能应该尝试一些通常不会花费很长时间来找到最适合您的框架。

不确定这对您是否重要，但 Microsoft 最近宣布在 VS 2008 的下一次更新中支持 jQuery[这是博客文章](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)。

[您可以听到 jQuery 背后的人 John Resig 在最近的Boagworld 播客](http://boagworld.com/podcast/135/)中谈论它和其他各种框架。它可能会帮助您下定决心，这是一个非常平衡的部分。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-15T21:48:04.863

为什么不创建一个快速比较？

执行一项任务，例如“查找所有包含 foo 类图像的 div 或表格，并为每个 div 附加一个点击事件，使它们扩大 50%。” 或者与您正在做的事情更相关的事情。

然后使用 jQuery、Prototype 等对其进行编码并进行比较。哪个更短？更容易阅读？跑得更快？[（您可以在此处](http://mootools.net/slickspeed)找到速度比较。）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-30T19:31:55.450

如果您试图从商业角度说服人们，微软最近决定将 jQuery 与 Visual Studio 一起发布可能有助于建立一些额外的可信度。再说一次，这可能会损害您的事业，具体取决于他们对 Microsoft 的看法。

# language-agnostic - 进行网络抓取的最佳图书馆

> ID：67056
> 
> 赞同：12
> 
> 时间：2008-09-15T21:16:58.277
> 
> 标签：language-agnostic, class-library, web-crawler

我想从不同的网页获取数据，例如餐厅地址或给定位置的不同事件的日期等。我可以用来从一组给定的站点中提取这些数据的最佳库是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-15T21:30:23.720

.net 程序员的 HTML 敏捷包非常棒。它将网页转换成可以使用 XPath 查询的 XML 文档。

```
HtmlDocument doc = new HtmlDocument();
doc.Load("file.htm");
foreach(HtmlNode link in doc.DocumentElement.SelectNodes("//a@href")
{
HtmlAttribute att = link"href";
att.Value = FixLink(att);
}
doc.Save("file.htm"); 
```

你可以在这里找到它。 [http://www.codeplex.com/htmlagilitypack](http://www.codeplex.com/htmlagilitypack)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-15T21:41:48.777

如果使用 python，请查看 Beautiful Soup ( [http://crummy.com/software/BeautifulSoup](http://crummy.com/software/BeautifulSoup) )。

一个功能非常强大的库，让抓取变得轻而易举。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T21:28:17.670

我认为这里的一般答案是使用任何语言 + http 库 + html/xpath 解析器。我发现使用 ruby​​ + hpricot 提供了一个很好的干净解决方案：

```
require 'rubygems'
require 'hpricot'
require 'open-uri'

sites = %w(http://www.google.com http://www.stackoverflow.com)

sites.each do |site|
  doc = Hpricot(open(site))

  # iterate over each div in the document (or use xpath to grab whatever you want)
  (doc/"div").each do |div|
    # do something with divs here
  end
end 
```

有关 Hpricot 的更多信息，请参阅[http://code.whytheluckystiff.net/hpricot/](http://code.whytheluckystiff.net/hpricot/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T21:32:38.847

我个人喜欢用于这类任务的[WWW::Mechanize Perl 模块。](http://search.cpan.org/perldoc?WWW::Mechanize)它为您提供了一个以典型 Web 浏览器为模型的对象（即您可以跟踪链接、填写表格或通过调用其上的方法来使用“后退按钮”）。

对于实际内容的提取，您可以将其连接到[HTML::TreeBuilder](http://search.cpan.org/perldoc?HTML::TreeBuilder)以将您当前正在访问的网站转换为[HTML::Element](http://search.cpan.org/perldoc?HTML::Element)对象树，并提取您想要的数据（`look_down()`方法`HTML::Element`特别是有用）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-07T19:14:50.797

我认为 watir 或 selenium 是最好的选择。大多数其他提到的库实际上是 HTML 解析器，这不是你想要的......你正在抓取，如果网站的所有者希望你获取他的数据，他会转储他的数据库或网站洪流并避免所有http请求和昂贵的流量。

基本上，您需要解析 HTML，但更重要的是自动化浏览器。这可以移动鼠标并单击，基本上是在模仿用户。您需要使用屏幕捕获程序来获取验证码并将它们发送到 decaptcha.com（以几分之一的成本解决它们）以规避这种情况。忘记通过解析html而不在浏览器中呈现它'应该看到'来保存该验证码文件。您是屏幕抓取，而不是 httprequestscraping。

watir 结合 autoitx（用于移动鼠标并在字段中输入键 -> 有时这是设置正确的 javascript 事件所必需的）和用于验证码的简单屏幕捕获实用程序为我做了这个伎俩。这样你会最成功，编写一个很棒的 html 解析器来发现站点的所有者已经将一些文本变成了图形是毫无用处的。（有问题？不，只需获取一个 OCR 库并输入 jpeg，将返回文本）。此外，我很少看到他们走那么远，尽管在中文网站上，图形中有很多文字。

Xpath 一直在拯救我的一天，它是一种很棒的领域特定语言（恕我直言，我可能错了），您可以访问页面中的任何标签，尽管有时您需要对其进行调整。

我确实错过了“反向模板”（selenium 的机器人框架有这个）。Perl 在 CPAN 模块 Template::Extract 中有这个，非常方便。

html 解析或 DOM 的创建，我会留给浏览器，是的，它不会那么快，但它会一直工作。

假装是用户代理的库也没有用，现在网站受到保护以防被抓取，并且通常需要在真实屏幕上呈现网站以超越验证码，而且还需要触发 javascript 事件以显示信息等.

Watir 如果你喜欢 Ruby，我会说 Selenium。“人类模拟器”（或俄罗斯的 Web 模拟器）确实是为这种抓取而设计的，但话又说回来，它是来自一家毫不掩饰其意图的公司的俄罗斯产品。

i also think that one of these weeks Wiley has a new book out on scraping, that should be interesting. Good luck...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T10:09:13.553

我个人觉得[http://github.com/shuber/curl/tree/master](http://github.com/shuber/curl/tree/master)和[http://simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)非常适合在我的 PHP 爬取/抓取项目中使用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T21:22:49.167

Perl [WWW::Mechanize](http://search.cpan.org/~petdance/WWW-Mechanize-1.34/lib/WWW/Mechanize.pm)库非常适合完成与网站交互以访问您需要的实际页面的笨拙工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T21:24:55.417

我会使用 LWP（Perl 的 Libwww）。这是一个很好的小指南： [http ://www.perl.com/pub/a/2002/08/20/perlandlwp.html](http://www.perl.com/pub/a/2002/08/20/perlandlwp.html)

WWW::Scraper 在这里有文档：http: [//cpan.uwinnipeg.ca/htdocs/Scraper/WWW/Scraper.html](http://cpan.uwinnipeg.ca/htdocs/Scraper/WWW/Scraper.html) 它可以作为一个有用的基础，你可能想要创建适合你的餐厅采矿的自己的模块需要。

LWP 将为您提供一个基本的爬虫供您构建。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T21:43:26.730

有很多答案推荐 Perl Mechanize，但我认为 Ruby Mechanize（与 Perl 的版本非常相似）更好。它在句法上以更简洁的方式处理诸如表单之类的事情。此外，还有一些前端运行在Ruby Mechanize*之上，这让事情变得更加容易。*

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T21:20:09.423

你想使用什么语言？

使用 awk 卷曲可能就是您所需要的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T21:22:30.523

您可以使用[tidy](http://tidy.sourceforge.net/)将其转换为 XHTML，然后使用您选择的语言可用的任何 XML 处理工具。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T21:22:58.340

我推荐[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)。它不是最快的，但在大多数解析器窒息的 (X)HTML 页面的非格式方面表现得非常好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-05T23:56:03.833

有人说什么。

使用任何语言。

只要你有一个好的解析器库和 http 库，你就设置好了。

树的东西比较慢，然后只使用一个好的解析库。

# c# - 约定问题：什么时候使用 Getter/Setter 函数而不是使用属性

> ID：67063
> 
> 赞同：14
> 
> 时间：2008-09-15T21:18:22.360
> 
> 标签：c#

让我感到震惊的是，在尝试操作类中的字段时应该使用 C# 中的属性。但是当涉及到复杂的计算或数据库时，我们应该使用 getter/setter。

它是否正确？

你什么时候在属性上使用 s/getter？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-15T21:34:26.330

[.NET 设计指南在“属性与方法](http://msdn.microsoft.com/en-us/library/bzwdh01d(VS.71).aspx#cpconpropertyusageguidelinesanchor1)”部分中提供了该问题的一些答案。

基本上，属性与字段具有相同的语义。你不应该让属性抛出异常，属性不应该有副作用，顺序不重要，并且属性应该相对快速地返回。如果这些事情都可能发生，最好使用一种方法。该指南还建议使用返回数组的方法。

在决定是否使用属性或方法时，如果我将其视为一个字段会有所帮助。我考虑了属性的行为并问自己，“如果这是类中的一个字段，如果它的行为方式如此，我会感到惊讶吗？” 例如，考虑[TcpClient.GetStream 方法](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.getstream.aspx)。它可以根据是否建立连接抛出几个异常，并且在尝试获取流之前配置 TcpClient 非常重要。因此，它是一个 Get 方法而不是一个属性。

如果您仔细查看设计指南，您会发现这通常*不是*偏好问题。在某些情况下使用方法而不是属性是有充分理由的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T21:19:54.103

如果您的语言支持属性，只需使用属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T21:22:56.013

使用属性。MS 的框架设计指南书中的一个有趣的注释是，如果您有一个属性并且需要为更复杂的 set/get 添加额外的方法，那么您应该消除该属性并只使用 get/set 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T21:20:57.110

这都是个人喜好。当它被编译时，无论哪种方式，它都是 getter/setter 函数。

我个人在设置和检索成员值时使用属性而没有任何副作用。如果检索/保存值有副作用，那么我使用一个函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T21:30:04.203

我想说总是问自己哪个更有意义。方法往往被理解为要执行的动作，通常用这样的措辞来表达—— `open()`、、、。属性往往被理解为更高级的字段/变量—— , , .`flush()``parse()``DisplayName``AutoSize``DataSource`

在我注意到的自定义控件开发中，这往往会出现很多问题。由于它有可能被许多其他没有编写它的人使用，而且您可能不会问，因此最好采用合乎逻辑且不会让您的开发人员感到惊讶的设计。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T21:33:16.597

当一个值是只写的或一次设置多个值（显然）时，我倾向于使用设置器。我的直觉和你一样，是使用 getter 和 setter 作为进程可能长时间运行、产生线程或执行其他一些重要工作的信号。此外，如果 setter 在类中具有不明显的先决条件，我可能会使用 getter 或 setter，因为人们很少阅读有关属性的文档，并且属性应该始终可以访问。但即使在这些情况下，如果它可能使调用代码更好地阅读，我也可能会使用一个属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T21:33:19.437

忘记 Getter 和 Setter 方法。只需使用属性。

值得一提的是，Properties 最终在程序集中作为 Setter 和/或 Getter 方法结束。只需一点元数据，Setter 和/或 Getter 就变成了一个属性。所以实际上，properties = setter/getter 方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T21:41:32.927

属性应该很快，因为它们有一定的承诺。它们对于数据绑定也是必需的。

而且它们应该**没有副作用**。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-23T16:07:56.667

微软的回答很好，但我会为读写属性添加更多规则（微软有时会违反这些规则，顺便说一句，造成很多混乱）：（1）属性设置器通常不应该影响对象的可观察属性，而不是被认为是正在设置其属性的对象的一部分；(2) 将一个属性设置为一个值，然后另一个值应该使任何受影响的对象处于相同的（可观察的）状态，就像简单地将其设置为第二个值一样；(3) 将属性设置为其 getter 返回的值应该没有可观察到的效果；(4) 通常，设置一个属性不应导致任何其他读写属性发生变化，尽管它可能会更改其他只读属性（请注意，大多数违反此规则的行为都会违反 #2 和/或 #3，但即使这些规则不会被违反，这样的设计仍然显得可疑）。使对象在设计器中可用可能需要为其提供一些不遵循这些规则的属性，但是不遵循这些语义的运行时更改应该由 setter 方法完成。

In many cases, it may be appropriate to have a read-only property and a separate "Set" method (that would be my preference, for example, for a control's "Parent" property). In other cases, it may be useful to have several related ReadOnly properties that are affected by one read/write property (e.g. it may be useful to have a read-only property that indicates whether a control and all its parents are visible, but such functionality should not be included in a read-write Visible property).

# version-control - 如何实际使用源代码控制系统？

> ID：67069
> 
> 赞同：15
> 
> 时间：2008-09-15T21:19:03.620
> 
> 标签：version-control

所以我知道你们中的大多数人都对我不满意，因为我目前没有使用任何源代码控制。我想，我真的想，现在我已经花了一些时间阅读这里的问题/答案。我是一个业余程序员，除了修补外，我真的什么都不做，但我已经被咬了好几次了，没有手边的“时间机器”……

我仍然必须决定我将使用哪种产品，但这与这个问题无关。

我真的在为源代码控制下的文件流而苦苦挣扎，以至于我什至不确定如何明智地提出这个问题。

目前我有一个目录层次结构，我的所有 PHP 文件都位于 Linux 环境中。我在那里编辑它们，然后可以在我的浏览器上点击刷新，看看会发生什么。

据我了解，我的文件现在位于不同的位置。当我想编辑时，我会检查它并编辑掉。但是我的 F5 的替代品是什么？我该如何测试它？我必须重新签入，然后按 F5 吗？我承认在我的工作中有很多尝试和错误。我怀疑我会厌倦快速签入和签出，因为我倾向于进行频繁的小改动。我必须错过一些东西，对吧？

任何人都可以带我了解所有事物的存在以及我如何测试，同时保持手边拥有“时间机器”的目标吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-15T21:20:21.730

Eric Sink 有很多关于源代码控制基础[的文章。](http://www.ericsink.com/scm/source_control.html)他的公司 (Sourcegear) 制作了一个名为 Vault 的源代码控制工具，但操作方法通常与系统无关。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T21:23:54.017

1.  不要在生产环境中编辑您的代码。
2.  使用适当的服务 (apache w/mod_php) 创建一个开发环境。
3.  开发环境中的应用程序目录是您工作的地方。
4.  将您当前的生产应用程序放在那里。
5.  将此目录提交到源代码管理工具。（现在您已经使用您的应用程序填充了源代码控制）
6.  在您的新开发环境中进行更改，当您想查看/测试您所做的更改时按 F5。
7.  合并/提交您对源代码控制的更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T21:23:06.373

实际上，您的文件虽然存储在源存储库中（硬盘驱动器上的另一个位置或其他地方的硬盘驱动器），但也可以存在于您的本地计算机上，就像它们现在存在的位置一样。

因此，如果您使用 VSS（不确定 SVN、CVS 等），所有未检出的文件都将被标记为“只读”。因此，您仍然可以通过点击“F5”来运行您的网站，它将重新加载它们当前所在的文件。如果您签出并正在编辑它，它将变为非只读，您可以更改它。

无论如何，您正在运行的 Web 服务器将加载具有相同效果的只读/可写文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T22:02:18.120

以下是您在 CVS 或 Subversion 等非集中式源代码控制系统中使用的一般工作流程： 首先，您将当前项目导入所谓的存储库，即所有文件的版本化存储。注意只导入手动生成的文件（源文件、数据文件、makefile、项目文件）。生成的文件（目标文件、可执行文件、生成的文档）不应放入存储库。

然后你必须检查你的工作副本。顾名思义，您将在这里进行所有本地编辑、编译以及将测试服务器指向的位置。它基本上是你以前工作的地方的替代品。每个项目只需要执行一次这些步骤（当然，您可以检查多个工作副本。）

这是基本的工作周期：首先，您将存储库中所做的所有更改检出到本地工作副本中。在团队中工作时，这会带来其他团队成员自您上次签出以来所做的任何更改。然后你做你的工作。当您完成一组工作后，您应该再次检查当前版本并解决由于其他团队成员的更改而可能发生的冲突。（在纪律严明的团队中，这通常不是问题。）测试，当一切按预期工作时，您提交（签入）您的更改。然后您可以继续工作，一旦您再次完成，请签出、解决冲突并再次签入。请注意，您应该只提交经过测试和工作的更改。你多久入住是一个品味问题，但是一般规则说您应该在一天结束时至少提交一次更改。就个人而言，我提交更改的频率要高得多，基本上是每当我进行了一组通过所有测试的相关更改时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T21:20:52.900

您仍然拥有硬盘上的所有文件，为 F5 做好准备！

不同之处在于您可以将文件“检查点”到存储库中。你的日常生活完全不需要改变。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T21:21:38.450

您可以对您当前工作的同一目录执行“签出”，这样就不必更改。基本上你的工作目录不需要改变。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T21:22:02.710

这是一个非常开放的问题，因为您如何使用 SCM 在很大程度上取决于您选择的 SCM。像 git 这样的分布式 SCM 与像 Subversion 这样的集中式 SCM 的工作方式非常不同。

svn 对于“新用户”来说更容易消化，但 git 可以更强大一些并改善您的工作流程。Subversion 也有非常棒的文档和工具支持（比如 trac），还有一本你应该阅读的在线书籍：

[http://svnbook.red-bean.com/](http://svnbook.red-bean.com/)

它将涵盖源代码控制管理的基础知识，无论您最终选择哪种 SCM，都会以某种方式帮助您，因此我建议您略读前几章。

编辑：顺便说一下，让我指出*为什么*人们对你不满意：SCM 不仅仅是“代码的备份”。拥有“时间机器”与 SCM 完全不同。使用 SCM，您可以返回您的更改历史记录，查看您实际更改的内容，以及您在使用 blob 代码时永远无法获得的内容*。*我敢肯定你不止一次问过自己：“这段代码是怎么来的？” 或“我以为我修复了那个错误”——如果你这样做了，那就是你需要 SCM 的原因。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T21:26:54.180

您没有“必须”以剧烈的方式改变您的工作流程。你可以，在某些情况下你应该这样做，但这不是版本控制规定的。

您只需像往常一样使用这些文件。只有在版本控制下，一旦您达到某种“完成”或至少“工作”状态（解决了问题跟踪器中的问题、完成了某种方法、调整了某些东西等），您就可以签入。

如果您有多个开发人员在处理您的代码库，请务必定期更新，以便您始终使用最新（合并）版本的代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-16T00:55:56.347

我会推荐分布式版本控制系统（mercurial、git、bazaar、darcs）而不是集中式版本控制系统（cvs、svn）。它们更容易设置和使用。

试试 mercurial（这是我用来理解版本控制如何工作的 VCS），然后如果你愿意，你甚至可以迁移到 git。

Mercurial 的主页上有一个非常好的介绍性教程：[Understanding Mercurial](http://www.selenic.com/mercurial/wiki/index.cgi/UnderstandingMercurial)。这将向您介绍 VCS 的基本概念以及工作原理。这真的很棒。之后，我建议您继续阅读 Mercurial 教程：[Mercurial 教程页面](http://www.selenic.com/mercurial/wiki/index.cgi/Tutorial)，它将教您如何实际使用 Mercurial。最后，你有一本免费的电子书，它是关于如何使用 Mercurial 的非常好的参考：[Distributed Revision Control with Mercurial](http://hgbook.red-bean.com/)

如果您感觉更有冒险精神并想立即开始使用 Git，那么这本免费的电子书是一个很好的起点：[Git Magic](http://www-cs-students.stanford.edu/~blynn/gitmagic/)（非常容易阅读）

**最后**，无论您选择哪种 VCS 工具，您最终会做的事情如下：

1.  有一个您不手动编辑的存储库，它仅适用于 VCS
2.  有一个工作目录，您可以在其中像往常一样进行更改。
3.  更改您喜欢的内容，按 F5 多次按您的意愿。当你喜欢你所做的并认为你想以当时的方式保存项目时（就像你在 Word 中写东西时所做的那样），然后你可以提交你的更改到存储库。
4.  如果您需要回到项目中的某个状态，您现在可以这样做。

差不多就是这样。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-16T00:06:30.817

好问题。使用源代码控制，您仍然可以执行“F5”刷新过程。但是在每次编辑（或一些小的编辑）之后，您都需要检查您的代码，以便备份一份副本。

根据源代码控制系统，您不必每次都明确签出文件。只需编辑文件即可查看。我写[了一个源代码控制的视觉指南](http://betterexplained.com/articles/a-visual-guide-to-version-control/)，许多人在了解基础知识时发现它很有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T21:36:20.820

这都是非常主观的，具体取决于您决定使用的源代码控制解决方案。您肯定会想要研究的一个是 Subversion。

您提到您正在做 PHP，但您是在 Linux 环境还是 Windows 中做呢？这并不是很重要，但我在 PHP 环境中工作时通常做的是拥有一个生产分支和一个开发分支。这允许我配置一个 cron 作业（Windows 中的计划任务），以便从生产服务器的生产就绪分支自动拉取，同时从我的开发服务器的开发分支拉取。

一旦你决定了一个工具，你真的应该花一些时间来学习它是如何工作的。例如，签入和签出的概念并不适用于所有源代码控制解决方案。无论哪种方式，我都强烈建议您选择一个允许分支的。 [本文介绍](http://www.infoq.com/articles/agile-version-control)了一个很好的（在我看来）在生产环境中遵循的源代码控制模型。

当然，我声明这一切多年来都没有“修补”过。我从事职业发展已经有一段时间了，我的技术可能对你这个职位的人来说太过分了。然而，并不是说这有什么问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T21:22:10.323

如果您使用的是 Subversion，您只需检出*一次*文件。然后，每当您进行重大更改（或要去吃午饭或其他什么）时，您都将它们*提交*给服务器。这样，您可以通过按 F5 来保留旧的工作流程，但每次*提交*时，您都会在 SVN 存储库中保存所有文件当前状态的副本。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-15T21:22:37.403

根据源代码控制系统，“结帐”可能意味着不同的东西。在 SVN 世界中，它只是意味着从存储库中检索（可能是更新，可能是新文件）最新副本。在源代码安全的世界中，这通常意味着更新现有文件*并将其锁定。* 下面的文字使用了 SVN 的含义：

使用 PHP，您要做的是将整个项目/站点签出到测试 apache 站点上的工作文件夹。您应该设置存储库，这样只需一次签出就可以发生这种情况，包括任何必要的子文件夹。您签出您的项目以设置*一次*。

现在您可以进行更改并按 F5 正常刷新。当您对支持特定修复或功能的一组更改感到满意时，您可以作为一个单元*提交*（当然，带有适当的评论）。这会将最新版本放入存储库中。

一次签出/提交一个文件会很麻烦。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-15T21:23:18.837

取决于您使用的源代码控制系统。例如，对于 subversion 和 cvs，您的文件可以驻留在远程位置，但您总是在本地检查您自己的副本。此本地副本（通常称为`working copy`）只是文件系统上的常规文件，其中包含一些元数据，可让您将更改上传回服务器。

如果您使用的是 Subversion，这里有一个[很好的教程](http://www.germane-software.com/~ser/R_n_R/subversion.html)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-15T23:21:37.633

听起来您在询问如何使用源代码管理来管理版本。

以下是一些并非特定于网站的一般指导：

*   使用本地副本进行更改
*   在签入之前编译（如果适用）并测试您的更改
*   尽可能频繁地运行自动化构建和测试（至少每天）
*   版本化您的日常构建（有某种方式指定与特定构建和测试运行相对应的确切代码位）
*   如果可能，对主要版本使用单独的分支（或有一个开发和一个发布分支）
*   必要时，稳定您的代码库（定义一组测试，以便通过所有这些测试意味着您对产品的质量有足够的信心来发布它，然后朝着 0 测试失败的方向前进，即禁止任何签入到发布分支除了对未决问题的修复）
*   当您的构建具有您想要的功能并通过了所有必要的测试时，请部署它。

如果你有一个小团队、一个稳定的产品、一个快速构建和高效、高质量的测试，那么整个过程可能是 100% 自动化的，并且可以在几分钟内完成。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-15T21:34:16.283

源代码控制系统通常是您的文件及其历史记录的存储位置，并且通常与您当前正在处理的文件分开。这在一定程度上取决于版本控制系统的类型，但假设您使用的是类似 CVS 的东西（例如 subversion），那么您的所有文件都将存在于两个（或更多）位置。您在本地目录中有文件，即所谓的“工作副本”和存储库中的一个，它可以位于另一个本地文件夹或另一台机器上，通常通过网络访问。通常，在第一次将文件导入存储库后，您可以在继续处理它们的工作文件夹下检出它们。我假设这将是您的 PHP 文件现在所在的文件夹。

现在，当您签出副本并进行了一些要“保存”的重要更改时会发生什么？您只需将工作副本中的这些更改提交到版本控制系统。现在您有了更改的历史记录。如果您在任何时候希望返回到您提交这些更改的版本，那么您可以简单地将您的工作副本恢复到较旧的修订版（您一次提交的更改集的名称）。

请注意，这都是 CVS/SVN 特有的，因为 GIT 的工作方式会略有不同。我建议从 subversion 开始，并阅读非常优秀的[SVN Book](http://svnbook.red-bean.com/)的前几章来帮助您入门。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-15T23:00:36.997

我只想补充一点，我认为最容易设置和使用的系统是[Mercurial](http://www.selenic.com/mercurial/wiki/)。如果您单独工作而不是在团队中工作，您只需在正常工作文件夹中初始化它，然后从那里继续。正常流程是使用您喜欢的编辑器编辑任何文件，然后进行签入（提交）。我没有尝试过 GIT，但我认为它非常相似。单调有点难上手。这些都是分布式源代码控制系统。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-16T00:27:42.030

我推荐[Subversion](http://svnbook.red-bean.com/)。设置一个存储库并使用它实际上是相当简单的，即使从命令行也是如此。这是怎么回事：

# 如果你还没有设置你的 repo (repository)

### **1)**确保你的服务器上安装了 Subversion

```
$ which svn
/usr/bin/svn 
```

*这*是一个工具，可以告诉您通往另一个工具的路径。如果它什么也没返回，则该工具未安装在您的系统上

### **1b）**如果没有，得到它

```
$ apt-get install subversion 
```

*apt-get*是一种将其他工具安装到您的系统上的工具

如果这不是 apt 中颠覆的正确名称，试试这个

```
$ apt-cache search subversion 
```

或这个

```
$ apt-cache search svn 
```

找到正确的包名并使用*apt-get install packagename安装它*

### **2）**在您的服务器上创建一个新的存储库

```
$ cd /path/to/directory/of/repositories
$ svnadmin create my_repository 
```

*svnadmin create reponame*在当前工作目录 ( *pwd* )中创建一个名为*reponame的新存储库*

您已正式完成创建存储库

# 如果您有现有的存储库，或者已完成设置

### **1)**确保按照上述说明在本地计算机上安装了 Subversion

### **2)**将存储库签出到本地计算机

```
$ cd /repos/on/your/local/machine
$ svn co svn+ssh://www.myserver.com/path/to/directory/of/repositories/my_repository 
```

*svn co*是用于签出存储库的命令

### **3）**创建您的初始目录结构（可选）

```
$ cd /repos/on/your/local/machine
$ cd my_repository
$ svn mkdir branches
$ svn mkdir tags
$ svn mkdir trunk
$ svn commit -m "Initial structure" 
```

*svn mkdir*运行一个常规的*mkdir*并在当前工作目录中使用您在键入*svn mkdir*后提供的名称创建一个目录，然后将其添加到存储库中。

*svn commit -m ""*将您的更改发送到存储库并更新它。无论您在*-m*之后的引号中放置什么，都是此提交的注释（让它计数！）。

您的代码的“工作副本”将放在*主干*目录中。*分支*用于在主干之外处理单个项目；*分支*中的每个目录都是不同子项目的*主干*副本。*标签*用于更多版本。我建议只专注于*主干*一段时间并习惯 Subversion。

# 使用您的回购协议

### **1）**将代码添加到您的存储库

```
$ cd /repos/on/your/local/machine
$ svn add my_new_file.ext
$ svn add some/new/directory
$ svn add some/directory/*
$ svn add some/directory/*.ext 
```

倒数第二行添加了该目录中的每个文件。最后一行添加扩展名为 .ext 的每个文件。

### **2）**检查存储库的状态

```
$ cd /repos/on/your/local/machine
$ svn status 
```

这将告诉您是否有任何新文件、更新文件以及有冲突的文件（您的本地版本与服务器上的版本之间的差异）等。

### **3）**更新您的存储库的本地副本

```
$ cd /repos/on/your/local/machine
$ svn up 
```

更新会从您还没有的服务器中提取任何新更改

*svn up*确实关心你所在的目录。如果你想更新整个存储库，请确保你在存储库的根目录中（主干上方）

* * *

这就是你开始真正需要知道的一切。有关更多信息，我建议您查看[Subversion Book](http://svnbook.red-bean.com/)。

# windows - Windows 上最好的 epoll/kqueue/select 等效项是什么？

> ID：67082
> 
> 赞同：42
> 
> 时间：2008-09-15T21:20:26.287
> 
> 标签：windows, io, notifications, epoll

什么是 Windows 最好的 I/O 事件通知工具？

最好的意思是……

1.  对输入文件描述符的数量没有限制
2.  适用于所有文件描述符（磁盘文件，套接字，...）
3.  提供多种通知方式（边沿触发、限位触发）

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-15T22:23:39.067

在 Windows 中，异步操作是由文件操作完成的，而不是由描述符完成的。有几种方法可以等待文件操作异步完成。

例如，如果您想知道网络套接字上的数据何时可用，请在套接字上发出异步读取请求，当它完成时，数据可用并被检索。

在 Win32 中，异步操作使用该[`OVERLAPPED`](http://msdn.microsoft.com/en-us/library/ms684342(VS.85).aspx)结构来包含有关未完成 IO 操作的状态。

1.  将文件与[IO 完成端口](http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx)关联并分派异步 IO 请求。当一个操作完成时，它会将完成消息放在队列中，您的工作线程可以等待并在它们到达时检索。您还可以将用户定义的消息放入队列中。完成端口可以使用多少个文​​件或排队的消息没有限制
2.  使用事件调度每个 IO 操作。与操作关联的事件将在完成时发出信号（满足等待）。用于[`WaitForMultipleObjects`](http://msdn.microsoft.com/en-us/library/ms687025(VS.85).aspx)一次等待所有事件。这样做的缺点是只能`MAXIMUM_WAIT_OBJECTS`一次等待对象 (64)。您还可以同时等待其他类型的事件（进程/线程终止、互斥体、事件、信号量）
3.  使用[线程池](http://msdn.microsoft.com/en-us/library/ms686760(VS.85).aspx)。线程池可以接受无限数量的对象和文件操作来等待并在每个完成时执行[用户定义的函数。](http://msdn.microsoft.com/en-us/library/ms684124(VS.85).aspx)
4.  使用`[ReadFileEx](http://msdn.microsoft.com/en-us/library/aa365468(VS.85).aspx)`和将[异步过程调用](http://msdn.microsoft.com/en-us/library/ms681951(VS.85).aspx)[`WriteFileEx`](http://msdn.microsoft.com/en-us/library/aa365748(VS.85).aspx)(APC)排队到调用线程和（或）用于在每个操作完成时接收通知消息。该方法类似于 IO 完成端口，但仅适用于一个线程。 [`SleepEx`](http://msdn.microsoft.com/en-us/library/ms686307(VS.85).aspx)`WaitFor{Single|Multiple}ObjectsEx``Alertable TRUE`

Windows NT 内核在内部不区分套接字、磁盘文件、管道等文件操作：所有这些选项都适用于所有文件类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-16T10:26:42.527

**库夫**

`libuv`为 Unix 和 Windows 提供事件 I/O，并支持套接字、文件和管道。它是 Node.js 的平台层。

更多细节在： http: [//nikhilm.github.io/uvbook/introduction.html](http://nikhilm.github.io/uvbook/introduction.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T22:13:33.227

据我所知，目前还没有。我和一个朋友正在开发一个开源的 Windows epoll 实现（下面的链接），但我们遇到了问题，弄清楚如何使它与 Linux 实现一样。

目前的障碍：

*   在 Linux 中，文件描述符和套接字描述符是可以互换的，但在 Windows 中却不是。两者都必须与 epoll 实现兼容。
*   在 Windows 中，获取内核事件非常棘手……这就是 epoll 在 Linux 中的工作方式。我们猜测使用我们的跨平台 epoll 库的程序在 Windows 中的运行速度会明显比 Linux 慢。

随着项目的进展，我会尝试回来更新这篇文章。

[http://sourceforge.net/projects/cpoll](http://sourceforge.net/projects/cpoll)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T10:30:40.527

select() 函数是 POSIX 并且可在包括“winsock.h”或“winsock2.h”在内的 Windows 上使用。

# mysql - 如何快速重命名 MySQL 数据库（更改架构名称）？

> ID：67093
> 
> 赞同：1076
> 
> 时间：2008-09-15T21:22:00.090
> 
> 标签：mysql, database, innodb, rename

[MySQL 的MySQL](http://web.archive.org/web/20160504181056/https://dev.mysql.com/doc/refman/5.1/en/rename-database.html)手册涵盖了这一点。

通常我只是转储数据库并用新名称重新导入它。对于非常大的数据库，这不是一个选项。显然`RENAME {DATABASE | SCHEMA} db_name TO new_db_name;` [做坏事，只存在于少数几个版本中，总体上是个坏主意](http://web.archive.org/web/20160504181056/https://dev.mysql.com/doc/refman/5.1/en/rename-database.html)。

这需要与[InnoDB一起使用，它存储的东西与](http://en.wikipedia.org/wiki/InnoDB)[MyISAM](http://en.wikipedia.org/wiki/MyISAM)非常不同。

* * *

## 回答 #1

> 赞同：947
> 
> 时间：2010-02-19T18:17:41.447

对于**InnoDB**，以下似乎可行：创建新的空数据库，然后将每个表依次重命名为新数据库：

```
RENAME TABLE old_db.table TO new_db.table; 
```

之后您将需要调整权限。

对于 shell 中的脚本，您可以使用以下任一方法：

```
mysql -u username -ppassword old_db -sNe 'show tables' | while read table; \ 
    do mysql -u username -ppassword -sNe "rename table old_db.$table to new_db.$table"; done 
```

或者

```
for table in `mysql -u root -ppassword -s -N -e "use old_db;show tables from old_db;"`; do mysql -u root -ppassword -s -N -e "use old_db;rename table old_db.$table to new_db.$table;"; done; 
```

* * *

笔记：

*   `-p`选项和密码之间没有空格。如果您的数据库没有密码，请删除该`-u username -ppassword`部分。
*   如果某个表有触发器，则无法使用上述方法将其移动到另一个数据库（将导致`Trigger in wrong schema`错误）。如果是这种情况，请使用传统方式克隆数据库，然后删除旧数据库：

    `mysqldump old_db | mysql new_db`

*   如果你有存储过程，你可以在之后复制它们：

    `mysqldump -R old_db | mysql new_db`

* * *

## 回答 #2

> 赞同：476
> 
> 时间：2009-07-02T07:34:44.087

使用这几个简单的命令：

```
mysqldump -u username -p -v olddatabase > olddbdump.sql
mysqladmin -u username -p create newdatabase
mysql -u username -p newdatabase < olddbdump.sql 
```

或者按照@Pablo Marin-Garcia 的建议来减少 I/O：

```
mysqladmin -u username -p create newdatabase
mysqldump -u username -v olddatabase -p | mysql -u username -p -D newdatabase 
```

* * *

## 回答 #3

> 赞同：227
> 
> 时间：2012-01-15T19:46:03.360

我认为解决方案更简单，并且是一些开发人员建议的。phpMyAdmin 对此有一个操作。

从 phpMyAdmin 中，选择您要选择的数据库。在选项卡中有一个称为操作，转到重命名部分。就这样。

正如许多人建议的那样，它确实使用新名称创建了一个新数据库，将旧数据库的所有表转储到新数据库中并删除旧数据库。

![在此处输入图像描述](https://i.stack.imgur.com/WuMcs.jpg)

* * *

## 回答 #4

> 赞同：119
> 
> 时间：2011-11-26T03:35:05.717

您可以使用 SQL 生成 SQL 脚本，以将源数据库中的每个表传输到目标数据库。

您必须在运行从该命令生成的脚本之前创建目标数据库。

您可以使用这两个脚本中的任何一个（我最初建议使用前者，并且有人“改进”了我的答案以使用`GROUP_CONCAT`. 自行选择，但我更喜欢原始脚本）：

```
SELECT CONCAT('RENAME TABLE $1.', table_name, ' TO $2.', table_name, '; ')
FROM information_schema.TABLES 
WHERE table_schema='$1'; 
```

或者

```
SELECT GROUP_CONCAT('RENAME TABLE $1.', table_name, ' TO $2.', table_name SEPARATOR '; ')
FROM information_schema.TABLES 
WHERE table_schema='$1'; 
```

（$1 和 $2 分别是源和目标）

这将生成一个您必须运行的 SQL 命令。

请注意，`GROUP_CONCAT`具有大量表的数据库可能会超出默认长度限制。`SET SESSION group_concat_max_len = 100000000;`您可以通过运行（或其他一些较大的数字）来更改该限制。

* * *

## 回答 #5

> 赞同：63
> 
> 时间：2012-08-10T20:43:45.390

模拟 MySQL 中缺少的`RENAME DATABASE`命令：

1.  创建一个新数据库

2.  使用以下命令创建重命名查询：

    ```
     SELECT CONCAT('RENAME TABLE ',table_schema,'.`',table_name,
         '` TO ','new_schema.`',table_name,'`;')
     FROM information_schema.TABLES
     WHERE table_schema LIKE 'old_schema'; 
    ```

3.  运行该输出

4.  删除旧数据库

它取自*[Emulating The Missing RENAME DATABASE Command in MySQL](http://blog.shlomoid.com/2010/02/emulating-missing-rename-database.html)*。

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2013-02-07T06:54:29.630

你可以使用这个 shell 脚本：

参考：[*如何重命名 MySQL 数据库？*](https://serverfault.com/questions/195221/how-to-rename-a-mysql-database)

```
#!/bin/bash
set -e # terminate execution on command failure

mysqlconn="mysql -u root -proot"
olddb=$1
newdb=$2
$mysqlconn -e "CREATE DATABASE $newdb"
params=$($mysqlconn -N -e "SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES \
                           WHERE table_schema='$olddb'")
for name in $params; do
      $mysqlconn -e "RENAME TABLE $olddb.$name to $newdb.$name";
done;
$mysqlconn -e "DROP DATABASE $olddb" 
```

它正在工作：

```
$ sh rename_database.sh oldname newname 
```

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2008-09-15T21:28:12.787

三个选项：

1.  创建新数据库，关闭服务器，将文件从一个数据库文件夹移动到另一个，然后重新启动服务器。请注意，这仅在您的所有表都是 MyISAM 时才有效。

2.  创建新数据库，使用 CREATE TABLE ... LIKE 语句，然后使用 INSERT ... SELECT * FROM 语句。

3.  使用 mysqldump 并重新加载该文件。

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2008-09-15T21:30:07.697

### 简单的方法

切换到数据库目录：

```
cd /var/lib/mysql/ 
```

关闭 MySQL... 这很重要！

```
/etc/init.d/mysql stop 
```

好的，这种方式不适用于 InnoDB 或 BDB-Databases。

重命名数据库：

```
mv old-name new-name 
```

...或桌子...

```
cd database/

mv old-name.frm new-name.frm

mv old-name.MYD new-name.MYD

mv old-name.MYI new-name.MYI 
```

重启 MySQL

```
/etc/init.d/mysql start 
```

完毕...

好的，这种方式不适用于 InnoDB 或 BDB 数据库。在这种情况下，您必须转储数据库并重新导入它。

* * *

## 回答 #9

> 赞同：21
> 
> 时间：2016-01-14T16:42:06.323

**进行完整**重命名的最简单的万无一失的方法*（包括在最后删除旧数据库，因此它是重命名而不是副本）*：

```
mysqladmin -uroot -pmypassword create newdbname
mysqldump -uroot -pmypassword --routines olddbname | mysql -uroot -pmypassword newdbname
mysqladmin -uroot -pmypassword drop olddbname 
```

**脚步：**

1.  将这些行复制到记事本中。
2.  将所有对“olddbname”、“newdbname”、“mypassword”（+ 可选“root”）的引用替换为等效项。
3.  在命令行上一一执行（提示时输入“y”）。

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2010-05-07T13:15:27.437

我最近才遇到一种非常好的方法，可以与 MyISAM 和 InnoDB 一起使用，而且速度非常快：

```
RENAME TABLE old_db.table TO new_db.table; 
```

我不记得我在哪里读到的，但功劳归于其他人，而不是我。

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2018-01-19T08:27:42.513

脚步 ：

1.  点击[http://localhost/phpmyadmin/](http://localhost/phpmyadmin/)
2.  选择您的数据库
3.  单击操作选项卡
4.  将有一个选项卡作为“将数据库重命名为”。添加新名称并检查调整权限。
5.  点击前往。

[![在此处输入图像描述](https://i.stack.imgur.com/0atGZ.jpg)](https://i.stack.imgur.com/0atGZ.jpg)

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2010-10-28T15:01:12.227

这就是我使用的：

```
$ mysqldump -u root -p olddb >~/olddb.sql
$ mysql -u root -p
mysql> create database newdb;
mysql> use newdb
mysql> source ~/olddb.sql
mysql> drop database olddb; 
```

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2014-01-29T11:14:37.917

那么有2种方法：

**方法 1：**重命名数据库模式的一种众所周知的方法是使用 Mysqldump 转储模式并将其恢复到另一个模式中，然后删除旧模式（如果需要）。

从壳牌

```
 mysqldump emp > emp.out
 mysql -e "CREATE DATABASE employees;"
 mysql employees < emp.out 
 mysql -e "DROP DATABASE emp;" 
```

上述方法虽然简单，但是费时费空间。如果架构超过**100GB 怎么办？**有一些方法可以将上述命令连接在一起以节省空间，但这不会节省时间。

为了纠正这种情况，还有另一种快速重命名模式的方法，但是，在执行此操作时必须小心。

**方法 2：** MySQL 有一个很好的重命名表的特性，甚至可以跨不同的模式工作。此重命名操作是原子操作，在重命名表时没有其他人可以访问该表。这需要很短的时间才能完成，因为更改表的名称或其架构只是元数据更改。这是进行重命名的程序方法：

创建具有所需名称的新数据库模式。使用 MySQL 的“RENAME TABLE”命令将表从旧模式重命名为新模式。删除旧的数据库模式。 `If there are views, triggers, functions, stored procedures in the schema, those will need to be recreated too`. 如果表上存在触发器，MySQL 的“重命名表”将失败。为了解决这个问题，我们可以做以下事情：

**1）** `Dump the triggers, events and stored routines in a separate file.`这使用-E，-R标志（除了-t -d转储触发器）到mysqldump命令完成。一旦触发器被转储，我们需要将它们从模式中删除，以便 RENAME TABLE 命令起作用。

```
 $ mysqldump <old_schema_name> -d -t -R -E > stored_routines_triggers_events.out 
```

**2)**生成仅包含“BASE”表的列表。这些可以使用对`information_schema.TABLES`表的查询来找到。

```
 mysql> select TABLE_NAME from information_schema.tables where 
    table_schema='<old_schema_name>' and TABLE_TYPE='BASE TABLE'; 
```

**3)**将视图转储到输出文件中。可以使用对同一个`information_schema.TABLES`表的查询来找到视图。

```
mysql> select TABLE_NAME from information_schema.tables where 
   table_schema='<old_schema_name>' and TABLE_TYPE='VIEW';
 $ mysqldump <database> <view1> <view2> … > views.out 
```

**4)**删除 old_schema 中当前表上的触发器。

```
mysql> DROP TRIGGER <trigger_name>;
... 
```

**5)**重命名步骤#2 中找到的所有“基本”表后，恢复上述转储文件。

```
mysql> RENAME TABLE <old_schema>.table_name TO <new_schema>.table_name;
...
$ mysql <new_schema> < views.out
$ mysql <new_schema> < stored_routines_triggers_events.out 
```

上述方法的复杂性：我们可能需要为用户更新 GRANTS，以便它们匹配正确的 schema_name。这些可以通过对 mysql.columns_priv、mysql.procs_priv、mysql.tables_priv、mysql.db 表的简单更新来修复，将 old_schema 名称更新为 new_schema 并调用“刷新权限；”。尽管“方法 2”似乎比“方法 1”复杂一些，但这是完全可以编写脚本的。一个简单的 bash 脚本以正确的顺序执行上述步骤，可以帮助您在下次重命名数据库模式时节省空间和时间。

Percona Remote DBA 团队编写了一个名为“rename_db”的脚本，其工作方式如下：

```
[root@dba~]# /tmp/rename_db
rename_db <server> <database> <new_database> 
```

为了演示此脚本的使用，使用了示例模式“emp”，创建了测试触发器，并在该模式上存储了例程。将尝试使用脚本重命名数据库模式，这需要几秒钟才能完成，而不是耗时的转储/恢复方法。

```
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| emp                |
| mysql              |
| performance_schema |
| test               |
+--------------------+

[root@dba ~]# time /tmp/rename_db localhost emp emp_test
create database emp_test DEFAULT CHARACTER SET latin1
drop trigger salary_trigger
rename table emp.__emp_new to emp_test.__emp_new
rename table emp._emp_new to emp_test._emp_new
rename table emp.departments to emp_test.departments
rename table emp.dept to emp_test.dept
rename table emp.dept_emp to emp_test.dept_emp
rename table emp.dept_manager to emp_test.dept_manager
rename table emp.emp to emp_test.emp
rename table emp.employees to emp_test.employees
rename table emp.salaries_temp to emp_test.salaries_temp
rename table emp.titles to emp_test.titles
loading views
loading triggers, routines and events
Dropping database emp

real    0m0.643s
user    0m0.053s
sys     0m0.131s

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| emp_test           |
| mysql              |
| performance_schema |
| test               |
+--------------------+ 
```

正如您在上面的输出中看到的那样，数据库模式“emp”在不到一秒的时间内被重命名为“emp_test”。最后，这是上面用于“方法 2”的 Percona 脚本。

```
#!/bin/bash
# Copyright 2013 Percona LLC and/or its affiliates
set -e
if [ -z "$3" ]; then
    echo "rename_db <server> <database> <new_database>"
    exit 1
fi
db_exists=`mysql -h $1 -e "show databases like '$3'" -sss`
if [ -n "$db_exists" ]; then
    echo "ERROR: New database already exists $3"
    exit 1
fi
TIMESTAMP=`date +%s`
character_set=`mysql -h $1 -e "show create database $2\G" -sss | grep ^Create | awk -F'CHARACTER SET ' '{print $2}' | awk '{print $1}'`
TABLES=`mysql -h $1 -e "select TABLE_NAME from information_schema.tables where table_schema='$2' and TABLE_TYPE='BASE TABLE'" -sss`
STATUS=$?
if [ "$STATUS" != 0 ] || [ -z "$TABLES" ]; then
    echo "Error retrieving tables from $2"
    exit 1
fi
echo "create database $3 DEFAULT CHARACTER SET $character_set"
mysql -h $1 -e "create database $3 DEFAULT CHARACTER SET $character_set"
TRIGGERS=`mysql -h $1 $2 -e "show triggers\G" | grep Trigger: | awk '{print $2}'`
VIEWS=`mysql -h $1 -e "select TABLE_NAME from information_schema.tables where table_schema='$2' and TABLE_TYPE='VIEW'" -sss`
if [ -n "$VIEWS" ]; then
    mysqldump -h $1 $2 $VIEWS > /tmp/${2}_views${TIMESTAMP}.dump
fi
mysqldump -h $1 $2 -d -t -R -E > /tmp/${2}_triggers${TIMESTAMP}.dump
for TRIGGER in $TRIGGERS; do
    echo "drop trigger $TRIGGER"
    mysql -h $1 $2 -e "drop trigger $TRIGGER"
done
for TABLE in $TABLES; do
    echo "rename table $2.$TABLE to $3.$TABLE"
    mysql -h $1 $2 -e "SET FOREIGN_KEY_CHECKS=0; rename table $2.$TABLE to $3.$TABLE"
done
if [ -n "$VIEWS" ]; then
    echo "loading views"
    mysql -h $1 $3 < /tmp/${2}_views${TIMESTAMP}.dump
fi
echo "loading triggers, routines and events"
mysql -h $1 $3 < /tmp/${2}_triggers${TIMESTAMP}.dump
TABLES=`mysql -h $1 -e "select TABLE_NAME from information_schema.tables where table_schema='$2' and TABLE_TYPE='BASE TABLE'" -sss`
if [ -z "$TABLES" ]; then
    echo "Dropping database $2"
    mysql -h $1 $2 -e "drop database $2"
fi
if [ `mysql -h $1 -e "select count(*) from mysql.columns_priv where db='$2'" -sss` -gt 0 ]; then
    COLUMNS_PRIV="    UPDATE mysql.columns_priv set db='$3' WHERE db='$2';"
fi
if [ `mysql -h $1 -e "select count(*) from mysql.procs_priv where db='$2'" -sss` -gt 0 ]; then
    PROCS_PRIV="    UPDATE mysql.procs_priv set db='$3' WHERE db='$2';"
fi
if [ `mysql -h $1 -e "select count(*) from mysql.tables_priv where db='$2'" -sss` -gt 0 ]; then
    TABLES_PRIV="    UPDATE mysql.tables_priv set db='$3' WHERE db='$2';"
fi
if [ `mysql -h $1 -e "select count(*) from mysql.db where db='$2'" -sss` -gt 0 ]; then
    DB_PRIV="    UPDATE mysql.db set db='$3' WHERE db='$2';"
fi
if [ -n "$COLUMNS_PRIV" ] || [ -n "$PROCS_PRIV" ] || [ -n "$TABLES_PRIV" ] || [ -n "$DB_PRIV" ]; then
    echo "IF YOU WANT TO RENAME the GRANTS YOU NEED TO RUN ALL OUTPUT BELOW:"
    if [ -n "$COLUMNS_PRIV" ]; then echo "$COLUMNS_PRIV"; fi
    if [ -n "$PROCS_PRIV" ]; then echo "$PROCS_PRIV"; fi
    if [ -n "$TABLES_PRIV" ]; then echo "$TABLES_PRIV"; fi
    if [ -n "$DB_PRIV" ]; then echo "$DB_PRIV"; fi
    echo "    flush privileges;"
fi 
```

* * *

## 回答 #14

> 赞同：14
> 
> 时间：2008-09-15T21:26:07.550

MySQL 目前不支持通过其命令界面重命名数据库，但如果您可以访问 MySQL 存储其数据库的目录，则可以重命名数据库。对于默认 MySQL 安装，这通常位于 MySQL 安装目录下的 Data 目录中。在 Data 目录下找到要重命名的数据库的名称并重命名。但是，重命名目录可能会导致一些权限问题。意识到。

**注意：**您必须先停止 MySQL，然后才能重命名数据库

我建议创建一个新数据库（使用您想要的名称）并将您需要的数据从旧数据库导出/导入到新数据库。很简单。

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2008-09-15T21:24:15.230

当您在 PHPMyAdmin 中重命名数据库时，它会创建一个转储，然后删除并使用新名称重新创建数据库。

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2012-11-30T01:06:26.287

对于 Mac 用户，Sequel Pro 在数据库菜单中有一个重命名数据库选项。 [http://www.sequelpro.com/](http://www.sequelpro.com/)

* * *

## 回答 #17

> 赞同：12
> 
> 时间：2017-02-09T00:01:06.303

由于以下两个原因之一，这里的大多数答案都是错误的：

1.  您不能只使用 RENAME TABLE，因为可能存在视图和触发器。如果有触发器，则 RENAME TABLE 失败
2.  如果您想“快速”（按照问题中的要求）重命名大型数据库，则不能使用 mysqldump

Percona 有一篇关于如何做好这件事的博文： [https ://www.percona.com/blog/2013/12/24/renaming-database-schema-mysql/](https://www.percona.com/blog/2013/12/24/renaming-database-schema-mysql/)

和由 Simon R Jones 发布（制作？）的脚本，该脚本执行该帖子中的建议。我修复了在脚本中发现的错误。你可以在这里看到它：

[https://gist.github.com/ryantm/76944318b0473ff25993ef2a7186213d](https://gist.github.com/ryantm/76944318b0473ff25993ef2a7186213d)

这是它的副本：

```
#!/bin/bash
# Copyright 2013 Percona LLC and/or its affiliates
# @see https://www.percona.com/blog/2013/12/24/renaming-database-schema-mysql/
set -e
if [ -z "$3" ]; then
    echo "rename_db <server> <database> <new_database>"
    exit 1
fi
db_exists=`mysql -h $1 -e "show databases like '$3'" -sss`
if [ -n "$db_exists" ]; then
    echo "ERROR: New database already exists $3"
    exit 1
fi
TIMESTAMP=`date +%s`
character_set=`mysql -h $1 -e "SELECT default_character_set_name FROM information_schema.SCHEMATA WHERE schema_name = '$2'" -sss`
TABLES=`mysql -h $1 -e "select TABLE_NAME from information_schema.tables where table_schema='$2' and TABLE_TYPE='BASE TABLE'" -sss`
STATUS=$?
if [ "$STATUS" != 0 ] || [ -z "$TABLES" ]; then
    echo "Error retrieving tables from $2"
    exit 1
fi
echo "create database $3 DEFAULT CHARACTER SET $character_set"
mysql -h $1 -e "create database $3 DEFAULT CHARACTER SET $character_set"
TRIGGERS=`mysql -h $1 $2 -e "show triggers\G" | grep Trigger: | awk '{print $2}'`
VIEWS=`mysql -h $1 -e "select TABLE_NAME from information_schema.tables where table_schema='$2' and TABLE_TYPE='VIEW'" -sss`
if [ -n "$VIEWS" ]; then
    mysqldump -h $1 $2 $VIEWS > /tmp/${2}_views${TIMESTAMP}.dump
fi
mysqldump -h $1 $2 -d -t -R -E > /tmp/${2}_triggers${TIMESTAMP}.dump
for TRIGGER in $TRIGGERS; do
    echo "drop trigger $TRIGGER"
    mysql -h $1 $2 -e "drop trigger $TRIGGER"
done
for TABLE in $TABLES; do
    echo "rename table $2.$TABLE to $3.$TABLE"
    mysql -h $1 $2 -e "SET FOREIGN_KEY_CHECKS=0; rename table $2.$TABLE to $3.$TABLE"
done
if [ -n "$VIEWS" ]; then
    echo "loading views"
    mysql -h $1 $3 < /tmp/${2}_views${TIMESTAMP}.dump
fi
echo "loading triggers, routines and events"
mysql -h $1 $3 < /tmp/${2}_triggers${TIMESTAMP}.dump
TABLES=`mysql -h $1 -e "select TABLE_NAME from information_schema.tables where table_schema='$2' and TABLE_TYPE='BASE TABLE'" -sss`
if [ -z "$TABLES" ]; then
    echo "Dropping database $2"
    mysql -h $1 $2 -e "drop database $2"
fi
if [ `mysql -h $1 -e "select count(*) from mysql.columns_priv where db='$2'" -sss` -gt 0 ]; then
    COLUMNS_PRIV="    UPDATE mysql.columns_priv set db='$3' WHERE db='$2';"
fi
if [ `mysql -h $1 -e "select count(*) from mysql.procs_priv where db='$2'" -sss` -gt 0 ]; then
    PROCS_PRIV="    UPDATE mysql.procs_priv set db='$3' WHERE db='$2';"
fi
if [ `mysql -h $1 -e "select count(*) from mysql.tables_priv where db='$2'" -sss` -gt 0 ]; then
    TABLES_PRIV="    UPDATE mysql.tables_priv set db='$3' WHERE db='$2';"
fi
if [ `mysql -h $1 -e "select count(*) from mysql.db where db='$2'" -sss` -gt 0 ]; then
    DB_PRIV="    UPDATE mysql.db set db='$3' WHERE db='$2';"
fi
if [ -n "$COLUMNS_PRIV" ] || [ -n "$PROCS_PRIV" ] || [ -n "$TABLES_PRIV" ] || [ -n "$DB_PRIV" ]; then
    echo "IF YOU WANT TO RENAME the GRANTS YOU NEED TO RUN ALL OUTPUT BELOW:"
    if [ -n "$COLUMNS_PRIV" ]; then echo "$COLUMNS_PRIV"; fi
    if [ -n "$PROCS_PRIV" ]; then echo "$PROCS_PRIV"; fi
    if [ -n "$TABLES_PRIV" ]; then echo "$TABLES_PRIV"; fi
    if [ -n "$DB_PRIV" ]; then echo "$DB_PRIV"; fi
    echo "    flush privileges;"
fi 
```

将其保存到一个名为的文件`rename_db`中并使脚本可执行，`chmod +x rename_db`然后像使用它一样使用它`./rename_db localhost old_db new_db`

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2017-09-21T15:22:17.803

似乎没有人提到这一点，但这是另一种方式：

```
create database NewDatabaseName like OldDatabaseName; 
```

然后为每个表做：

```
create NewDatabaseName.tablename like OldDatabaseName.tablename;
insert into NewDataBaseName.tablename select * from OldDatabaseName.tablename; 
```

那么，如果你愿意，

```
drop database OldDatabaseName; 
```

这种方法的优势在于在几乎为零的网络流量的服务器上进行整个传输，因此它比转储/恢复要快得多。

如果您确实有存储过程/视图/等，您可能也希望传输它们。

* * *

## 回答 #19

> 赞同：10
> 
> 时间：2017-10-04T06:51:40.533

对于 mac 用户，您可以使用`Sequel Pro`（免费），它只提供重命名数据库的选项。虽然它不会删除旧数据库。

打开相关数据库后，只需单击：`Database`-->`Rename database...`

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2010-05-19T17:16:59.373

可以将一个数据库中的所有表重命名为另一个数据库下，而无需进行完全转储和恢复。

```
删除过程如果存在 mysql.rename_db;
分隔符 ||
创建过程 mysql.rename_db（在 old_db VARCHAR（100），在 new_db VARCHAR（100））
开始
SELECT CONCAT('CREATE DATABASE', new_db, ';') `# 创建新数据库`;
SELECT CONCAT('RENAME TABLE `', old_db, '`.`', table_name, '` TO `', new_db, '`.`', table_name, '`;') `# alter table` FROM information_schema.tables WHERE table_schema = old_db;
SELECT CONCAT('DROP DATABASE `', old_db, '`;') `# 删除旧数据库`;
结束||
分隔符；

$ time mysql -uroot -e "调用 mysql.rename_db('db1', 'db2');" | mysql -uroot

```

但是，目标数据库中的任何触发器都不会满意。您需要先删除它们，然后在重命名后重新创建它们。

```
mysql -uroot -e "调用 mysql.rename_db('test', 'blah2');" | mysql -uroot
第 4 行的 ERROR 1435 (HY000)：在错误的架构中触发

```

* * *

## 回答 #21

> 赞同：8
> 
> 时间：2008-12-12T10:27:41.293

这是我编写的一个批处理文件，用于从命令行自动执行它，但它适用于 Windows/MS-DOS。

语法是 rename_mysqldb 数据库 newdatabase -u [user] -p[password]

```
:: ***************************************************************************
:: FILE: RENAME_MYSQLDB.BAT
:: ***************************************************************************
:: DESCRIPTION
:: This is a Windows /MS-DOS batch file that automates renaming a MySQL database 
:: by using MySQLDump, MySQLAdmin, and MySQL to perform the required tasks.
:: The MySQL\bin folder needs to be in your environment path or the working directory.
::
:: WARNING: The script will delete the original database, but only if it successfully
:: created the new copy. However, read the disclaimer below before using.
::
:: DISCLAIMER
:: This script is provided without any express or implied warranties whatsoever.
:: The user must assume the risk of using the script.
::
:: You are free to use, modify, and distribute this script without exception.
:: ***************************************************************************

:INITIALIZE
@ECHO OFF
IF [%2]==[] GOTO HELP
IF [%3]==[] (SET RDB_ARGS=--user=root) ELSE (SET RDB_ARGS=%3 %4 %5 %6 %7 %8 %9)
SET RDB_OLDDB=%1
SET RDB_NEWDB=%2
SET RDB_DUMPFILE=%RDB_OLDDB%_dump.sql
GOTO START

:START
SET RDB_STEP=1
ECHO Dumping "%RDB_OLDDB%"...
mysqldump %RDB_ARGS% %RDB_OLDDB% > %RDB_DUMPFILE%
IF %ERRORLEVEL% NEQ 0 GOTO ERROR_ABORT
SET RDB_STEP=2
ECHO Creating database "%RDB_NEWDB%"...
mysqladmin %RDB_ARGS% create %RDB_NEWDB%
IF %ERRORLEVEL% NEQ 0 GOTO ERROR_ABORT
SET RDB_STEP=3
ECHO Loading dump into "%RDB_NEWDB%"...
mysql %RDB_ARGS% %RDB_NEWDB% < %RDB_DUMPFILE%
IF %ERRORLEVEL% NEQ 0 GOTO ERROR_ABORT
SET RDB_STEP=4
ECHO Dropping database "%RDB_OLDDB%"...
mysqladmin %RDB_ARGS% drop %RDB_OLDDB% --force
IF %ERRORLEVEL% NEQ 0 GOTO ERROR_ABORT
SET RDB_STEP=5
ECHO Deleting dump...
DEL %RDB_DUMPFILE%
IF %ERRORLEVEL% NEQ 0 GOTO ERROR_ABORT
ECHO Renamed database "%RDB_OLDDB%" to "%RDB_NEWDB%".
GOTO END

:ERROR_ABORT
IF %RDB_STEP% GEQ 3 mysqladmin %RDB_ARGS% drop %NEWDB% --force
IF %RDB_STEP% GEQ 1 IF EXIST %RDB_DUMPFILE% DEL %RDB_DUMPFILE%
ECHO Unable to rename database "%RDB_OLDDB%" to "%RDB_NEWDB%".
GOTO END

:HELP
ECHO Renames a MySQL database.
ECHO Usage: %0 database new_database [OPTIONS]
ECHO Options: Any valid options shared by MySQL, MySQLAdmin and MySQLDump.
ECHO          --user=root is used if no options are specified.
GOTO END    

:END
SET RDB_OLDDB=
SET RDB_NEWDB=
SET RDB_ARGS=
SET RDB_DUMP=
SET RDB_STEP= 
```

* * *

## 回答 #22

> 赞同：8
> 
> 时间：2012-03-15T14:05:13.083

为方便起见，下面是一个小 shellscript，它必须使用两个参数执行：db-name 和 new db-name。

如果您不使用主目录中的 .my.cnf 文件，您可能需要将登录参数添加到 mysql 行。请在执行此脚本之前进行备份。

* * *

```
#!/usr/bin/env bash

mysql -e "CREATE DATABASE $2 DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;"
for i in $(mysql -Ns $1 -e "show tables");do
    echo "$1.$i -> $2.$i"
    mysql -e "rename TABLE $1.$i to $2.$i"
done
mysql -e "DROP DATABASE $1" 
```

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2013-02-07T07:02:35.620

最简单的方法是使用 HeidiSQL 软件。它是免费和开源的。它可以在 Windows 和任何带有[Wine](http://en.wikipedia.org/wiki/Wine_%28software%29)的 Linux 上运行（在 Linux、BSD、Solaris 和 Mac OS X 上运行 Windows 应用程序）。

要下载 HeidiSQL，[请访问 http://www.heidisql.com/download.php](http://www.heidisql.com/download.php)。

要下载 Wine，[请访问 http://www.winehq.org/](http://www.winehq.org/)。

要在 HeidiSQL 中重命名数据库，只需右键单击数据库名称并选择“编辑”。然后输入一个新名称并按“确定”。

就是这么简单。

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2010-04-18T09:51:26.960

我[提出了一个关于服务器故障的问题，](https://serverfault.com/questions/126509/how-to-proxy-to-different-named-databases-on-the-same-server-using-mysql-proxy)试图在使用 MySQL 代理恢复非常大的数据库时绕过停机时间。我没有取得任何成功，但我最终意识到我想要的是重命名数据库功能，因为由于我们数据库的大小，转储/导入不是一个选项。

MySQL 内置了一个 RENAME TABLE 功能，所以我最终编写了一个简单的 Python 脚本来为我完成这项工作。我已经[将它发布在 GitHub 上](http://github.com/cclark/Rename-MySQL-DB)，以防它对其他人有用。

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2011-05-17T18:24:19.407

TodoInTX 的存储过程并不适合我。这是我的尝试：

```
-- 存储过程rename_db：重命名数据库我的表复制方式。
-- 注意事项：
-- 将破坏与“新”数据库名称同名的任何现有数据库。
-- 只复制表格；存储过程和其他数据库对象不会被复制。
-- 托默奥特曼 (taltman@ai.sri.com)

分隔符 //
如果存在则删除程序 rename_db;
创建过程 rename_db（在 old_db VARCHAR（100）中，在 new_db VARCHAR（100）中）
开始
    声明 current_table VARCHAR(100);
    声明完成 INT DEFAULT 0;
    DECLARE old_tables CURSOR FOR select table_name from information_schema.tables where table_schema = old_db;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

    SET @output = CONCAT('DROP SCHEMA IF EXISTS ', new_db, ';');
    从@output准备stmt；
    执行语句；

    SET @output = CONCAT('CREATE SCHEMA IF NOT EXISTS', new_db, ';');
    从@output准备stmt；
    执行语句；

    打开旧表；
    重复
        FETCH old_tables INTO current_table;
        如果没有完成 那么
        SET @output = CONCAT('alter table', old_db, '.', current_table, 'rename', new_db, '.', current_table, ';');
        从@output准备stmt；
        执行语句；

        万一;
    直到完成 END REPEAT；

    关闭旧表；

结尾//
分隔符；

```

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2012-08-16T02:04:49.880

[`ALTER DATABASE`](http://dev.mysql.com/doc/refman/5.1/en/alter-database.html)是 MySQL 提出的解决此问题的方法，`RENAME DATABASE`已被删除。

从*[13.1.32 重命名数据库语法](http://dev.mysql.com/doc/refman/5.1/en/rename-database.html)*：

```
RENAME {DATABASE | SCHEMA} db_name TO new_db_name; 
```

这个语句是在 MySQL 5.1.7 中添加的，但在 MySQL 5.1.23 中发现它是危险的并被删除。

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2008-10-03T04:17:56.557

在 MySQL Administrator 中执行以下操作：

1.  在目录下，创建一个新的数据库模式。
2.  转到备份并创建旧模式的备份。
3.  执行备份。
4.  转到还原并打开在步骤 3 中创建的文件。
5.  在 Target Schema 下选择“Another Schema”，然后选择新的数据库模式。
6.  开始还原。
7.  验证新架构，如果看起来不错，则删除旧架构。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2012-03-19T00:54:47.747

这是一个单行 Bash 片段，用于将所有表从一个模式移动到另一个模式：

```
history -d $((HISTCMD-1)) && mysql -udb_user -p'db_password' -Dold_schema -ABNnqre'SHOW TABLES;' | sed -e's/.*/RENAME TABLE old_schema.`&` TO new_schema.`&`;/' | mysql -udb_user -p'db_password' -Dnew_schema 
```

开始时的历史命令只是确保不将包含密码的 MySQL 命令保存到 shell 历史记录中。

确保`db_user`对旧架构具有读/写/删除权限，并在新架构上具有读/写/创建权限。

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2013-08-21T06:17:20.893

在**phpmyadmin**中，您可以轻松地重命名数据库

```
select database 

  goto operations tab

  in that rename Database to :

  type your new database name and click go 
```

要求删除旧表并重新加载表数据在两者中单击确定

您的数据库已重命名

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2014-08-11T19:00:59.730

如果您有许多表要移动，这是生成重命名 sql 脚本的快速方法。

```
SELECT DISTINCT CONCAT('RENAME TABLE ', t.table_schema,'.', t.table_name, ' TO ',     
t.table_schema, "_archive", '.', t.table_name, ';' ) as Rename_SQL 
FROM information_schema.tables t
WHERE table_schema='your_db_name' ; 
```

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2017-07-26T01:03:31.117

我是这样做的：备份您现有的数据库。它会给你一个 db.zip.tmp 然后在命令提示符下写下

> "C:\Program Files (x86)\MySQL\MySQL Server 5.6\bin\mysql.exe" -h localhost -u root -p[密码] [新数据库名称] < "C:\Backups\db.zip.tmp "

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2020-12-10T12:55:52.923

你不能这样做是有原因的。（尽管尝试了所有答案）

*   基本答案在许多情况下都有效，而在其他情况下会导致数据损坏。
*   需要根据对数据库的启发式分析来选择策略。
*   **这就是实现此功能的原因，[然后将其删除](https://stackoverflow.com/questions/12190000/rename-mysql-database/21429268#comment21558791_12190318)。**[[文档](http://dev.mysql.com/doc/refman/5.1/en/rename-database.html)]

您需要转储该数据库*中的所有对象类型*，创建新命名的对象类型，然后导入转储。如果这是一个实时系统，您需要将其删除。如果不能，则需要设置从该数据库到新数据库的复制。

*如果您想查看可以执行此操作的命令，[@satishD 有详细信息](https://stackoverflow.com/a/21429268/263858)，其中传达了一些挑战，您需要围绕这些挑战构建与目标数据库匹配的策略。*

* * *

## 回答 #33

> 赞同：3
> 
> 时间：2011-07-12T15:30:43.283

如果您使用的是[phpMyAdmin](http://en.wikipedia.org/wiki/PhpMyAdmin)，您可以在选择要重命名的数据库后转到“操作”选项卡。然后转到最后一部分“将数据库复制到”（或类似内容），命名，然后选择下面的选项。在这种情况下，我猜你必须选择“结构和数据”和“复制前创建数据库”复选框，最后按下该部分中的“开始”按钮。

顺便说一句，我在西班牙语中使用 phpMyAdmin，所以我不确定这些部分的英文名称是什么。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2010-10-12T18:30:29.140

这适用于所有数据库，并通过使用[maatkit mysql 工具包重命名每个表来工作](http://www.maatkit.org/)

使用 mk-find 打印和重命名每个表。[手册页](http://www.maatkit.org/doc/mk-find.html)有更多选项和示例

```
mk-find --dblike OLD_DATABASE --print --exec "RENAME TABLE %D.%N TO NEW_DATABASE.%N" 
```

如果您安装了 maatkit（[这很容易](http://www.maatkit.org/download)），那么这是最简单的方法。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2011-10-06T12:59:05.060

这是我为在 Windows 上重命名数据库而编写的批处理脚本：

```
@echo off
set olddb=olddbname
set newdb=newdbname
SET count=1
SET act=mysql -uroot -e "select table_name from information_schema.tables where table_schema='%olddb%'"
mysql -uroot -e "create database %newdb%"
echo %act%
 FOR /f "tokens=*" %%G IN ('%act%') DO (
  REM echo %count%:%%G
  echo mysql -uroot -e "RENAME TABLE %olddb%.%%G to %newdb%.%%G"
  mysql -uroot -e "RENAME TABLE %olddb%.%%G to %newdb%.%%G"
  set /a count+=1
 )
mysql -uroot -e "drop database %olddb%" 
```

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2012-09-06T12:45:02.687

你可以通过两种方式做到这一点。

1.  将表 old_db.table_name 重命名为 new_db.table_name；
2.  转到操作-> 在那里您可以看到表格选项选项卡。您可以在那里编辑表名。

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2013-01-11T22:33:05.577

TodoInTx 的解决方案和 user757945 的改编解决方案都不适用于 MySQL 5.5.16，所以这是我的改编版本：

```
DELIMITER //
DROP PROCEDURE IF EXISTS `rename_database`;
CREATE PROCEDURE `rename_database` (IN `old_name` VARCHAR(20), IN `new_name` VARCHAR(20))
BEGIN
  DECLARE `current_table_name` VARCHAR(20);
  DECLARE `done` INT DEFAULT 0;
  DECLARE `table_name_cursor` CURSOR FOR SELECT `table_name` FROM `information_schema`.`tables` WHERE (`table_schema` = `old_name`);
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET `done` = 1;

  SET @sql_string = CONCAT('CREATE DATABASE IF NOT EXISTS `', `new_name` , '`;');
  PREPARE `statement` FROM @sql_string;
  EXECUTE `statement`;
  DEALLOCATE PREPARE `statement`;

  OPEN `table_name_cursor`;
  REPEAT
    FETCH `table_name_cursor` INTO `current_table_name`;
    IF NOT `done` THEN

      SET @sql_string = CONCAT('RENAME TABLE `', `old_name`, '`.`', `current_table_name`, '` TO `', `new_name`, '`.`', `current_table_name`, '`;');
      PREPARE `statement` FROM @sql_string;
      EXECUTE `statement`;
      DEALLOCATE PREPARE `statement`;

    END IF;
  UNTIL `done` END REPEAT;
  CLOSE `table_name_cursor`;

  SET @sql_string =  CONCAT('DROP DATABASE `', `old_name`, '`;');
  PREPARE `statement` FROM @sql_string;
  EXECUTE `statement`;
  DEALLOCATE PREPARE `statement`;
END//
DELIMITER ; 
```

希望它对处于我这种情况的人有所帮助！注意：`@sql_string`将在之后的会话中徘徊。如果不使用它，我无法编写此函数。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2013-09-11T05:24:23.600

我使用以下方法重命名数据库

1.  使用 mysqldump 或任何 DB 工具（例如 heidiSQL、mysql 管理员等）备份文件

2.  在一些文本编辑器中打开备份（例如backupfile.sql）文件。

3.  搜索并替换数据库名称并保存文件。

4.恢复编辑好的sql文件

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2015-08-21T12:48:48.440

如果您使用分层视图（视图从其他视图中提取数据），从 mysqldump 导入原始输出可能不起作用，因为 mysqldump 不关心视图的正确顺序。正因为如此，我[编写了脚本](https://github.com/gadelat/mysqldump-view-reorder.git)来重新排序视图以即时纠正顺序。

它看起来像这样：

```
#!/usr/bin/env perl

use List::MoreUtils 'first_index'; #apt package liblist-moreutils-perl
use strict;
use warnings;

my $views_sql;

while (<>) {
    $views_sql .= $_ if $views_sql or index($_, 'Final view structure') != -1;
    print $_ if !$views_sql;
}

my @views_regex_result = ($views_sql =~ /(\-\- Final view structure.+?\n\-\-\n\n.+?\n\n)/msg);
my @views = (join("", @views_regex_result) =~ /\-\- Final view structure for view `(.+?)`/g);
my $new_views_section = "";
while (@views) {
    foreach my $view (@views_regex_result) {
        my $view_body = ($view =~ /\/\*.+?VIEW .+ AS (select .+)\*\/;/g )[0];
        my $found = 0;
        foreach my $view (@views) {
            if ($view_body =~ /(from|join)[ \(]+`$view`/) {
                $found = $view;
                last;
            }
        }
        if (!$found) {
            print $view;
            my $name_of_view_which_was_not_found = ($view =~ /\-\- Final view structure for view `(.+?)`/g)[0];
            my $index = first_index { $_ eq $name_of_view_which_was_not_found } @views;
            if ($index != -1) {
                splice(@views, $index, 1);
                splice(@views_regex_result, $index, 1);
            }
        }
    }
} 
```

用法：
`mysqldump -u username -v olddatabase -p | ./mysqldump_view_reorder.pl | mysql -u username -p -D newdatabase`

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2017-07-03T15:38:45.800

如果您从具有多个数据库的转储文件开始，您可以对转储执行 sed：

```
sed -i -- "s|old_name_database1|new_name_database1|g" my_dump.sql
sed -i -- "s|old_name_database2|new_name_database2|g" my_dump.sql
... 
```

然后导入您的转储。只要确保不会有名称冲突。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2013-08-02T13:20:43.453

你们会为此向我开枪，而且很可能这不会每次都有效，当然，这违反所有逻辑等等等等……但我刚刚尝试的是……停止 MySQL 引擎，登录以root身份并简单地在文件系统级别重命名数据库......

我在 OSX 上，只是将情况从 bedbf 更改为 BEDBF。令我惊讶的是它起作用了......

我不会在生产数据库上推荐它。我只是尝试将其作为实验...

祝你好运:-)

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2014-04-20T16:25:26.277

我发布了这个[如何使用 MySQL 更改数据库名称？](https://stackoverflow.com/questions/19806065/how-to-change-database-name-using-mysql/23183723#23183723)今天经过几天的挠头和拉头发。解决方案非常简单，将模式导出到 .sql 文件并打开文件并在顶部的 sql CREAT TABLE 部分更改数据库/模式名称。如果将多个模式保存到文件中，则存在三个或更多实例，并且可能不在页面顶部。以这种方式编辑整个数据库是可能的，但我希望在大型数据库中，跟踪表属性或索引的所有实例可能会非常痛苦。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2014-09-02T11:52:35.980

I）。您无法直接更改现有数据库的名称，但您可以通过以下步骤实现您的目标：- 1）。创建新数据库。2）。使用新数据库。3）。创建表 table_name(select * from olddb.table_name);

通过上述操作，您可以从 olddb 表中复制数据并将其插入 newdb 表中。给表的名称相同。

二）。将表 old_db.table_name 重命名为 new_db.table_name；

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2020-07-16T05:02:05.557

```
UPDATE `db`SET Db = 'new_db_name' where Db = 'old_db_name'; 
```

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2022-01-20T10:51:42.363

我可以给出的最快和最简单的解决方案是......在 MySql Workbench 中右键单击您的架构 -> 单击创建架构 -> 输入该架构的名称。

用旧名称删除旧模式。

你准备好摇滚了......

注意:: 仅出于本地目的，请执行此操作。不要尝试生产数据库表。架构已创建，但其中没有数据。所以要小心。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2022-01-28T16:33:44.647

如果您更喜欢 GUI 工具并且碰巧安装了 MySQL Workbench，您可以使用内置的[迁移向导](https://www.mysql.com/products/workbench/migrate/)

* * *

## 回答 #47

> 赞同：-2
> 
> 时间：2016-05-22T21:33:12.927

这里已经有很多非常好的答案，但我没有看到 PHP 版本。这会在大约一秒钟内复制一个 800M 的数据库。

```
$oldDbName = "oldDBName";
$newDbName = "newDBName";
$oldDB     = new mysqli("localhost", "user", "pass", $oldDbName);
if($oldDB->connect_errno){
    echo "Failed to connect to MySQL: (" . $oldDB->connect_errno . ") " . $oldDB->connect_error;
    exit;
}
$newDBQuery = "CREATE DATABASE IF NOT EXISTS {$newDbName}";
$oldDB->query($newDBQuery);
$newDB = new mysqli("localhost", "user", "pass");
if($newDB->connect_errno){
    echo "Failed to connect to MySQL: (" . $newDB->connect_errno . ") " . $newDB->connect_error;
    exit;
}

$tableQuery  = "SHOW TABLES";
$tableResult = $oldDB->query($tableQuery);
$renameQuery = "RENAME TABLE\n";
while($table = $tableResult->fetch_array()){
    $tableName = $table["Tables_in_{$oldDbName}"];
    $renameQuery .= "{$oldDbName}.{$tableName} TO {$newDbName}.{$tableName},";
}
$renameQuery = substr($renameQuery, 0, strlen($renameQuery) - 1);
$newDB->query($renameQuery); 
```

* * *

## 回答 #48

> 赞同：-3
> 
> 时间：2010-06-30T17:58:16.783

实际上，最简单的答案是导出旧数据库，然后将其导入您创建的新数据库以替换旧数据库。当然，您应该使用[phpMyAdmin](http://en.wikipedia.org/wiki/PhpMyAdmin)或命令行来执行此操作。

**重命名和 Jerry 操纵数据库是一个坏主意！不要做。**（除非你是“黑客型”，在黑暗中坐在妈妈的地下室里，白天睡觉吃披萨。）

你最终会遇到比你想要的更多的问题和工作。

所以，

1.  创建一个 new_database 并以正确的方式命名。
2.  转到您的 phpMyAdmin 并打开您要导出的数据库。
3.  导出它（检查选项，但您应该可以使用默认值。
4.  你会得到一个类似或类似的文件。
5.  此文件的扩展名为 .sql

    -- phpMyAdmin SQL 转储 -- 版本 3.2.4

    ## -- [http://www.phpmyadmin.net](http://www.phpmyadmin.net)

    -- 主机：localhost -- 生成时间：2010 年 6 月 30 日下午 12:17 -- 服务器版本：5.0.90 -- PHP 版本：5.2.6

    SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";

    /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */; /* !40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */; /* !40101 设置@OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */; /* !40101 设置名称 utf8 */;

    --

    ## -- 数据库：`mydatab_online`

    * * *

    --

    ## -- 表的表结构`user`

    如果不存在则创建表`user`（ `timestamp`int(15) NOT NULL default '0', `ip`varchar(40) NOT NULL default '', `file`varchar(100) NOT NULL default '', PRIMARY KEY ( `timestamp`), KEY `ip`( `ip`), KEY `file`( `file`) ）引擎=MyISAM 默认字符集=latin1；

    --

    ## -- 为表转储数据`user`

    插入`user`( `timestamp`, `ip`, `file`) 值 (1277911052, '999.236.177.116', ''), (1277911194, '999.236.177.116', '');

这将是您的 .sql 文件。您刚刚导出的那个。

在您的硬盘上找到它；通常它在`/temp`. 选择具有正确名称的空数据库（您阅读本文的原因）。说：进口 - 去

通过将程序输入到通常是 configuration.php 文件中，将程序连接到正确的数据库。刷新服务器（两者都。为什么？因为我是 UNIX **oldtimer**，我说过。现在，您应该状态良好。如果您有任何其他问题，请在网络上访问我。

* * *

## 回答 #49

> 赞同：-3
> 
> 时间：2012-01-05T10:04:26.880

最简单的是，打开**MYSQL >> 选择**要更改其名称的数据库**>> 单击“操作”**，然后**将新名称放入“将数据库重命名为：”字段**，然后单击**“开始”**按钮

简单的！

* * *

## 回答 #50

> 赞同：-4
> 
> 时间：2010-10-04T09:01:30.310

如果您使用的是[phpMyAdmin](http://en.wikipedia.org/wiki/PhpMyAdmin)，那么您只需转到`mysql`xamp 中的文件夹，关闭 phpMyAdmin 并将刚才看到的文件夹重命名为您的数据库名称，然后重新启动您的 phpMyAdmin。您可以看到该数据库已重命名。

* * *

## 回答 #51

> 赞同：-4
> 
> 时间：2018-07-16T18:59:26.780

简单的方法

```
ALTER DATABASE `oldName` MODIFY NAME = `newName`; 
```

或者你可以使用[在线 sql 生成器](https://wtools.io/generate-sql-rename-database)

# .net - 提高 NHibernate 性能的最佳方法是什么？

> ID：67103
> 
> 赞同：61
> 
> 时间：2008-09-15T21:22:52.957
> 
> 标签：.net, performance, nhibernate, orm, data-access-layer

我有一个使用 NHibernate 作为其 ORM 的应用程序，有时由于它如何访问数据而遇到性能问题。可以做哪些事情来提高 NHibernate 的性能？（请限制每个答案推荐一个）

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-15T22:03:11.330

使用 NHibernate 可能遇到的第一个也是最严重的性能问题是，如果您正在为您创建的每个会话创建一个新的会话工厂。每次应用程序执行只应创建一个会话工厂实例，并且所有会话都应由该工厂创建。

按照这些思路，只要有意义，您就应该继续使用相同的会话。这将因应用程序而异，但对于大多数 Web 应用程序，建议每个请求一个会话。如果您经常丢弃会话，则不会获得缓存的好处。智能地使用会话缓存可以将具有线性（或更差）查询数的例程更改为常数，而无需做太多工作。

同样重要的是，您要确保延迟加载对象引用。如果不是，即使是最简单的查询也可以加载整个对象图。只有某些理由不这样做，但最好从延迟加载开始并根据需要切换回来。

这给我们带来了渴望获取，与延迟加载相反。在遍历对象层次结构或遍历集合时，很容易忘记您正在执行多少查询，并且最终会得到指数数量的查询。可以使用 FETCH JOIN 在每个查询的基础上完成 Eager fetching。在极少数情况下，例如如果有一对特定的表您总是获取连接，请考虑关闭该关系的延迟加载。

与往常一样，SQL Profiler 是查找运行缓慢或重复执行的查询的好方法。在我的上一份工作中，我们有一个开发功能，可以计算每个页面请求的查询。一个例程的大量查询是您的例程不能很好地与 NHibernate 一起工作的最明显的指标。如果每个例程或请求的查询数量看起来不错，那么您可能需要进行数据库调优；确保您有足够的内存来在缓存中存储执行计划和数据，正确索引您的数据等。

我们遇到的一个棘手的小问题是 SetParameterList()。该函数允许您轻松地将参数列表传递给查询。NHibernate 通过为传入的每个项目创建一个参数来实现这一点。这导致每个参数数量的不同查询计划。我们的执行计划几乎总是从缓存中释放出来。此外，许多参数会显着减慢查询速度。我们对 NHibernate 进行了自定义修改，以将项目作为分隔列表发送到单个参数中。该列表在 SQL Server 中由表值函数分隔，我们的 hack 自动插入到查询的 IN 子句中。根据您的应用，可能还有其他类似的地雷。SQL Profiler 是找到它们的最佳方式。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-26T23:27:29.157

NHibernate 的 SessionFactory 是一项昂贵的操作，因此一个好的策略是创建一个 Singleton 以确保内存中只有一个 SessionFactory 实例：

```
 public class NHibernateSessionManager
    {
        private readonly ISessionFactory _sessionFactory;

        public static readonly NHibernateSessionManager Instance = new NHibernateSessionManager();

        private NHibernateSessionManager()
        {
            if (_sessionFactory == null)
            {
                System.Diagnostics.Debug.WriteLine("Factory was null - creating one");
                _sessionFactory = (new Configuration().Configure().BuildSessionFactory());
            }
        }

        public ISession GetSession()
        {
            return _sessionFactory.OpenSession();
        }

        public void Initialize()
        {
            ISession disposeMe = Instance.GetSession();
        }
    } 
```

然后在您的 Global.Asax Application_Startup 中，您可以对其进行初始化：

```
protected void Application_Start()
{
    NHibernateSessionManager.Instance.Initialize();
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-02T20:03:11.263

通过识别何时从延迟加载切换到针对执行缓慢的查询的急切获取，避免和/或最小化[Select N + 1 问题。](http://ayende.com/Blog/archive/2008/12/01/solving-the-select-n1-problem.aspx)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-02T19:00:44.350

没有推荐，但可以帮助您的工具：NH Prof ( [http://nhprof.com/](http://nhprof.com/) ) 似乎很有希望，它可以评估您对 ORM 框架的使用。它可以是您调整 NHibernate 的一个很好的起点。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-15T21:40:33.787

如果没有关于您所看到的性能问题类型的任何细节，我只能提供一个概括：根据我的经验，大多数数据库查询性能问题是由于缺乏适当的索引而引起的。因此，我对第一个操作的建议是检查您的查询计划是否有非索引查询。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-19T01:02:45.587

NHibernate 开箱即用地生成相当快的 SQL。我已经使用它一年了，还没有用它编写裸 SQL。我所有的性能问题都来自[规范化](http://www.codinghorror.com/blog/archives/001152.html)和缺乏索引。

最简单的解决方法是检查查询的执行计划并创建适当的索引，尤其是在外键列上。如果您使用的是 Microsoft SQL Server，“Database Engine Tuning Advisor”会对此有很大帮助。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-11-07T20:34:16.197

仅“每个答案一个建议”？然后我会去这个：

避免连接重复（AKA 笛卡尔积）由于两个或多个平行于多个关联的连接；请改用 Exists-subqueries、MultiQueries 或 FetchMode “subselect”。

摘自：[Hibernate Performance Tuning Tips](http://arnosoftwaredev.blogspot.com/2011/01/hibernate-performance-tips.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T22:37:47.150

如果您还没有（适当地）使用延迟加载，请开始。当您不需要它们时获取集合是浪费一切。

[提高性能一章](http://nhibernate.info/doc/nhibernate-reference/performance.html)描述了这种方法和其他提高性能的方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-23T08:52:51.123

分析是第一步——即使是简单的定时单元测试——找出可以在哪里获得最大收益

对于集合，请考虑设置批处理大小以减少发出的选择语句的数量 -有关详细信息，请参阅[提高性能部分](http://nhibernate.info/doc/nhibernate-reference/performance.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-23T21:24:28.133

我只能将我的答案限制在一个选项上？在这种情况下，我会选择您实现 NHibernate 的二级缓存机制。

这样，对于映射文件中的每个对象，您都可以定义缓存策略。二级缓存会将已检索到的对象保存在内存中，因此不会再次往返数据库。这是一个巨大的性能助推器。

您的目标是定义应用程序不断访问的对象。其中包括一般设置等。

有很多关于 nhibernate 二级缓存以及如何实现它的信息。

祝你好运 ：）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-09T14:58:53.267

缓存、缓存、缓存——您是否正确使用了第一级缓存[过早关闭会话，或使用 StatelessSession 绕过第一级缓存]？您是否需要为不经常更改的值设置一个简单的二级缓存？您可以缓存查询结果集以加快不经常更改的查询吗？

[还有配置——你可以将项目设置为不可变的吗？您能否重组查询以仅返回您需要的信息并将它们转换为原始实体？蝙蝠侠能在谜语人到达大坝之前阻止他吗？……哦，对不起，走神了。]

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-12T21:51:16.487

lotoffreetime 说的。

阅读文档的第 19 章“提高性能”。
NHibernate： http: [//nhibernate.info/doc/nhibernate-reference/performance.html](http://nhibernate.info/doc/nhibernate-reference/performance.html)
休眠：[http ://docs.jboss.org/hibernate/core/3.3/reference/en/html/performance.html](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/performance.html)

使用 SQL Profiler（或您正在使用的数据库的等效工具）查找长时间运行的查询。使用适当的索引优化这些查询。

对于在应用程序的几乎每个页面上使用的数据库调用，使用 CreateMultiQuery 从单个数据库查询返回多个结果集。

当然，缓存。页面/控件的 OutputCache 指令。NHibernate 缓存数据。

# asp.net - Asp.net 和 Windows Workflow 是很好的结合吗？

> ID：67104
> 
> 赞同：2
> 
> 时间：2008-09-15T21:22:54.203
> 
> 标签：asp.net, workflow

我正在实现一个非常简单的状态机订单处理应用程序。这是一个有一些曲折的电子商务应用程序。应用程序的用户不会自己编辑工作流。

微软声称 asp.net 和 Windows Workflow 是可以结合的。安装和维护 asp.net 和 Windows Workflow 的组合有多难？我会将工作流状态保留在 sql-server 中。

我更容易滚动自己的状态机代码还是 Windows Workflow 是适合这项工作的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T22:09:47.180

Asp.net 和 WF 相处得很好，而且 WF 不会增加太多的维护开销。

这是否适合您的设计很大程度上取决于您的需求。如果您有很多事件驱动的操作，那么 WF 可能是值得的，否则滚动您自己的跟踪的开销可能会减少系统的复杂性。

WF 相当容易使用，所以我建议制作一个原型并进行试验。

另外，在我看来，根据您的要求，我怀疑 WF 是否适合您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T21:31:20.627

这取决于您的需求。状态机有多复杂？您希望状态机在哪里（例如模型与数据库）？WWF 提供了一个基于事件的状态机，如果您的状态机嵌入到模型中就足够了。

就我个人而言，我已经实现了一个电子商务框架和其他基于工作流的网站，并且我一直从实现基于数据库的状态机中获得很多乐趣。一直工作顺利。

另一方面，我的一些同事更喜欢 WWF。

在任何情况下，它都可以与 ASP.NET 完美配合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T21:28:37.793

如果您的状态机非常简单，那么我会说您应该自己动手。您可以更好地控制一切。您可以按照自己的方式处理持久性，而不必担心他们是如何做到的。

WF 看起来确实很酷，但我认为它的强大之处可能在于它很容易与 CRM 和 Sharepoint 等框架联系起来。如果你打算在你的应用程序中使用这些，那么我肯定会考虑使用 WF。

全面披露：我绝对不是WF专家。

# mysql - 加快 mysql 转储和导入

> ID：67117
> 
> 赞同：50
> 
> 时间：2008-09-15T21:23:51.160
> 
> 标签：mysql, backup, restore

是否有任何记录在案的技术可以加快 mySQL 转储和导入？

这将包括 my.cnf 设置、使用 ramdisk 等。

仅寻找记录在案的技术，最好使用显示潜在加速的基准。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-16T14:24:16.013

1.  *获取高性能 MySQL*的副本。很棒的书。
2.  转储中的扩展插入
3.  用--tab格式转储，这样你就可以使用mysqlimport，它比mysql < dumpfile更快
4.  使用多个线程导入，每个表一个。
5.  如果可能，请使用不同的数据库引擎。导入像 innodb 这样的大量事务引擎非常慢。插入像 MyISAM 这样的非事务引擎要快得多。
6.  查看 Maakit 工具包中的表格比较脚本，看看您是否可以更新表格而不是转储它们并导入它们。但是您可能正在谈论备份/恢复。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-16T22:21:55.443

[http://www.maatkit.org/](http://www.maatkit.org/)有一个 mk-parallel-dump 和 mk-parallel-restore

> 如果您一直希望使用多线程 mysqldump，请不要再希望了。该工具并行转储 MySQL 表。它是一个更智能的 mysqldump，既可以作为 mysqldump 的包装器（具有合理的默认行为），也可以作为 SELECT INTO OUTFILE 的包装器。它专为处理非常大数据量的高性能应用程序而设计，在这些应用程序中，速度非常重要。它利用多个 CPU 和磁盘来更快地转储数据。

mysqldump 中还有各种潜在的选项，例如在导入转储时不创建索引 - 而是在完成时批量进行。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-16T14:40:50.200

如果您要导入 InnoDB，您可以做的最有效的事情就是将

```
innodb_flush_log_at_trx_commit = 2 
```

在您的`my.cnf`, 导入运行时临时。`1`如果你需要酸，你可以把它放回去。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-04-19T09:15:37.047

我想你的问题也取决于瓶颈在哪里：

*   如果您的网络是瓶颈，您还可以查看`-C`/`--compress`标志`mysqldump`。
*   如果您的计算机内存不足（即开始交换），您应该购买更多内存。

另外，请查看`--quick`标志`mysqldump`（`--disable-keys`如果您使用的是 MyIsam）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-15T21:36:25.233

在转储中使用扩展插入应该会使导入更快。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-16T14:32:22.233

关闭外键检查并打开自动提交。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-19T09:16:57.433

`mysqlhotcopy`如果您只有 MyIsam 表，也可能是您的替代方案。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2011-08-18T22:55:35.197

使用索引但不要太多，激活查询缓存，对大数据库使用 sphinx，这里有一些很好的提示[http://www.keedeo.com/media/1857/26-astuces-pour-accelerer-vos-requetes-mysql](http://www.keedeo.com/media/1857/26-astuces-pour-accelerer-vos-requetes-mysql) (法语）

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-01-07T03:02:51.503

另一种选择是[http://www.mydumper.org](http://www.mydumper.org) - 多线程 mysql 备份/恢复，它比 mysqldump 快 3 到 10 倍，并且可以处理 MyISAM 和 InnoDB 以及 Drizzle [http://vbtechsupport.com/1695/](http://vbtechsupport.com/1695/)

# automation - cURL 有什么用？

> ID：67125
> 
> 赞同：7
> 
> 时间：2008-09-15T21:24:40.707
> 
> 标签：automation, curl

您使用[cURL](http://curl.haxx.se/)的最佳用途是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T21:30:22.690

我们在 C 应用程序中几乎所有 HTTP 客户端访问都使用 libcurl。对于命令行使用，我从来没有任何理由放弃 wget。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T20:32:19.077

I used it the Asterisk dialplan. You can Curl Servlets so your dialplan reacts to your website and ultimately java objects.

Also use it in bash scripts where the strip can "ask" a webpage for values. Curl its great!

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T20:33:35.703

[Twittering](http://www.sakana.fr/blog/2007/03/18/scripting-twitter-with-curl/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T21:25:36.913

我的大多数电子商务插件都使用 CURL 通过 SSH 将 CC 信息发布给提供商。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T21:32:31.357

请注意，Windows 上的 vanilla cURL（无论如何我上次检查）习惯于使用非常危险的调用 TerminateThread() 来处理停滞的连接，这可能会在线程持有重要的关键部分并死锁时终止你的程序的其余部分。[在 Windows 上，使用c-ares](http://daniel.haxx.se/projects/c-ares/)构建 cURL以避免这种情况。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-12T15:05:11.533

我将它用作 RESTful Web 服务的临时测试工具。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-20T15:08:16.953

cURL 和 wget 类似，都可以用于从命令行下载 url。相对于 cURL，wget 具有递归下载的能力。因此 wget 对下载文件很有用，而 cURL 除了下载文件之外还可以做各种技巧。cURL 对于 MacOS 也很有用，因为 wget 不附带它。

如果你想用 cookie 测试一个网站，cURL 很好。

```
curl --cookie "name=value" http://www.example.com 
```

..或一般测试网站和 RESTful API。测试 GET 请求：

```
curl http://example.com?param1=value1&param2=value2 
```

POST 请求可以通过使用 --data 或 -d 传递参数来完成

```
curl -d "param1=value1&param2=value2" http://example.com 
```

`-X PUT`如果我们添加或，PUT 和 DELETE 请求的工作方式相似`-x DELETE`。

它甚至适用于 BasicAuth / .htaccess 保护背后的网站

```
curl -d "param1=value1&param2=value2" http://example.com --user name:passwd 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T21:32:39.470

我已经将它连接到一个调度程序，以便对一个旧的 ASP 网站进行 HTTP 发布。这是一个第 3 方门户网站，当网站闲置一段时间时，需要很长时间才能加载。由于我无法访问源代码并且公司不再存在，这是一个快速而肮脏的解决方案，使网站运行了相当长的一段时间。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T21:33:23.837

[curl 可以轻松地从http://whatismyip.com/automation/n09230945.asp](http://whatismyip.com/automation/n09230945.asp)获取公共 IP 信息并在命令行上显示给您。我还使用它来测试某些系统上的表单 POST 数据，而无需在网页上输入内容。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T21:46:29.657

我使用 cURL 在无法访问 cron 的 Web 应用程序上自动执行任务。我在我有权访问的机器上设置了一个 cron 任务，该任务点击 URL 以运行计划的作业。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-16T23:03:27.480

我使用 curl 从同一个脚本连接到多个 API 并检索信息。我还使用 CURL 将信息发布到多个表单处理器。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-11-30T18:22:31.397

一个 FASTCGI 代理，在任何带有样式表 PI 的 xml 上运行 LibXSLT。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-15T21:28:18.140

从一些 cURL 文档中：

> curl 提供了大量有用的技巧，如代理支持、用户身份验证、FTP 上传、HTTP 发布、SSL 连接、cookie、文件传输恢复等。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-03-03T22:40:25.287

[我们在KATO](http://kato.sourceforge.net/)中经常使用 cURL 。

*   自动将有趣的内容提交到[美味](http://kato.svn.sourceforge.net/viewvc/kato/htdocs/feedDeliciousAgent.php?revision=16&view=markup)的社交书签网站
*   用有趣的内容更新[twitter 提要](http://kato.svn.sourceforge.net/viewvc/kato/htdocs/feedTweeterAgent.php?revision=16&view=markup)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-09-10T10:39:14.123

您可以使用 CURL 发布到 facebook、获取气象信息、获取 ip 信息、登录 twitter 和推特、在 google 上查找图像……执行所有您需要 CURL 和正则表达式从页面中提取代码的事情. 我写了一个 php 类，它使用 curl 来做很多这样的事情，你可以在这里找到它： [http ://www.barattalo.it/mini-bots-php-class/](http://www.barattalo.it/mini-bots-php-class/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-10T12:32:03.183

我用它来开发登录到站点并执行自动化操作的程序，例如远程向某个站点添加评论等。

但它还有**更多**用途。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-10T12:38:26.937

使用 PHP，我使用 cURL 为流行的基于 Web 的策略游戏创建机器人，并远程解析网页以获取有用信息。

对于与网页相关的大多数操作，它是一个非常有用的库，我也计划在我未来的 C 项目中使用它。

# wpf - WPF 应用程序的数据库功能：SQLite、SQL CE 还是其他？

> ID：67127
> 
> 赞同：33
> 
> 时间：2008-09-15T21:24:50.893
> 
> 标签：wpf, sqlite, sql-server-ce

我想扩展具有数据库功能的 WPF 应用程序。您会建议使用哪种数据库引擎，为什么？SQLite，SQL CE，其他？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-15T21:56:29.787

根据使用的应用程序，**我建议使用 SQL Lite**，因为它不需要您安装任何其他软件（SQL CE 或 Express 等通常需要单独安装）。

这篇文章底部的提供者链接中列出了 SQL Lite 最重要的好处：

> SQLite 是一个小型 C 库，它实现了一个自包含、可嵌入、零配置的 SQL 数据库引擎。特点包括：
> 
> *   零配置 - 无需设置或管理。
> *   实现大部分 SQL92。（不支持的功能）
> *   完整的数据库存储在单个磁盘文件中。
> *   数据库文件可以在不同字节顺序的机器之间自由共享。
> *   支持大小高达 2 TB（2^41 字节）的数据库。
> *   代码占用空间小：少于 30K 行 C 代码，少于 250KB 代码空间（i486 上的 gcc）
> *   对于大多数常见操作，比流行的客户端/服务器数据库引擎更快。
> *   简单易用的 API。
> *   自包含：没有外部依赖。
> *   来源在公共领域。用于任何目的。

由于您使用的是 WPF，我可以假设您至少使用的是 .NET 3.0。然后，我建议使用 .NET 3.5 SP1（与 .NET 3.5 大小相同，但包含一系列性能改进），其中包括 LINQ。

但是，在使用 SQLite 时，您可能希望使用以下应该提供 LINQ 支持的 SQLite 提供程序：[SQLite 数据库引擎的开源 ADO.NET 提供程序](http://sqlite.phxsoftware.com/)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-17T04:58:17.520

我将 SQL Compact Edition 与我的 WPF 应用程序一起使用，我对自己的决定感到满意。一切正常（因为 WPF 和 SQLCE 都是 MS，它们可以很好地协同工作），并且运行时的安装足够小且足够流畅，可以满足我的需要。我通过 Visual Studio 创建和修改了数据库。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-16T18:51:06.480

只是抛出一个不同的意见，我们去年一直在使用 SQL Compact Edition，并且总体上很满意。配置很简单，它的行为与常规的 MS SQL 数据库非常相似。缺少一些东西，比如触发器和存储过程，但是 SQL 3.5 CE 几乎拥有我们需要的所有其他东西。要安装大约 2Mb 的 .dll。它提供数据库加密、事务，并支持 VS 的类型化数据集设计器（3.1 有一些问题，但 CE 3.5 很棒！）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-08T17:15:47.510

SQL CE DLL 可以打包到您自己的应用程序中，无需单独安装。但是 MS 提供了一个默认的安装包，如果你不想了解 setup ...等。

更重要的是，SQL CE 支持私有部署。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T22:13:05.957

SQLite 是一个非常好的产品，虽然我怀念 PostgreSQL 的功能。还有其他的，尤其是非 SQL 的数据库，你可以考虑，比如 Berkeley DB。

/艾伦

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T21:58:15.820

我同意 SQLite 是要走的路。Subsonic 2.1 现在也包括 SQLite 支持。

# sql-server - 在 MS SQL Server 2005 中使用 Rails 2.x

> ID：67141
> 
> 赞同：8
> 
> 时间：2008-09-15T21:26:02.480
> 
> 标签：sql-server, ruby-on-rails, odbc

这里有没有人有使用 Rails 2.x 的 MS SQL Server 2005 的积极经验？

我们的开发人员使用 Mac OS X，我们的产品在 Linux 上运行。由于遗留原因，我们应该使用 MS SQL Server 2005。

我们正在使用 ruby​​-odbc 并且遇到了各种问题，太令人沮丧了，无法在此处列出。我觉得我们做错了什么。

我说的是不妥协的用法，即迁移等。

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T03:24:44.510

你考虑过使用 JRuby 吗？Microsoft 有一个[用于 SQL Server 的 JDBC 驱动程序](http://msdn.microsoft.com/en-us/data/aa937724.aspx)，可以在 UNIX 变体上运行（它是纯 Java AFAIK）。我今天能够获得使用 JRuby 和 Rails 2.1 的 2.0 技术预览。我还没有尝试过迁移，但到目前为止，驱动程序似乎运行良好。

这是如何使其工作的粗略草图：

1.  确保已安装 Java 6
2.  [使用JRuby 网站](http://www.jruby.org/)上的说明安装 JRuby
3.  `jruby -S gem install rails`使用 gem ( )安装 Rails
4.  [下载微软SQL Server JDBC驱动](http://msdn.microsoft.com/en-us/data/aa937724.aspx)的UNIX包（2.0版）
5.  解压 Microsoft 的 SQL Server 驱动程序
6.  找到sqljdbc4.jar，复制到JRuby的lib目录下
7.  `jruby -S gem install activerecord-jdbcmssql-adapter`
8.  创建一个 Rails 项目 ( `jruby -S rails hello`)
9.  在 database.yml 中放置正确的设置（示例如下）
10.  你都准备好了！尝试运行`jruby script/console`并创建模型。

```
    发展：
      主机：本地主机
      适配器：jdbc
      用户名：sa
      密码：kitte
      驱动程序：com.microsoft.sqlserver.jdbc.SQLServerDriver
      网址：jdbc:sqlserver://localhost;databaseName=mydb
      超时：5000

```

注意：我不确定您是否可以将 Windows 身份验证与 JDBC 驱动程序一起使用。您可能需要使用 SQL Server 身份验证。

祝你好运！

本

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T05:01:07.090

您是否考虑过在 Windows 上运行 rails 而不是在 Linux 上运行生产服务器？我目前正在使用 SQL Server 开发一个应用程序，直到知道它似乎运行良好。

这些是从运行在 Windows 上的 Rails 2.0 应用程序访问 SQL Server 数据库的步骤。

Rails 2 中默认不包含 SQL Server 适配器。需要使用以下命令下载并安装它。

```
gem install activerecord-sqlserver-adapter
--source=http://gems.rubyonrails.org 
```

下载最新版本的 ruby​​-dbi 从

[http://rubyforge.org/projects/ruby-dbi/](http://rubyforge.org/projects/ruby-dbi/)

然后从 ruby​​-dbi\lib\dbd\ADO.rb 中提取文件

到 C:\ruby\lib\ruby\site_ruby\1.8\DBD\ADO\ADO.rb。

警告，文件夹 ADO 不存在，所以你必须提前创建它。

无法使用 --database 选项为 SQL Server 预配置 Rails，只需像往常一样创建应用程序，然后修改应用程序文件夹中的 config\database.yml，如下所示：

```
development:
adapter: sqlserver
database: your_database_name
host: your_sqlserver_host
username: your_sqlserver_user
password: your_sqlserver_password 
```

运行 rake db:migrate 以检查您的安装。如果一切正常，您应该不会收到任何错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T23:36:01.357

我强烈建议您权衡从遗留数据库迁移。你可能很快就会发现自己陷入了一个痛苦的世界。根据经验，Rails 和遗留模式也不能很好地结合在一起。

恐怕我认为这个问题没有“好的解决方案”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T08:44:50.997

> 我们的开发人员使用 Mac OS X，我们的产品在 Linux 上运行。由于遗留原因，我们应该使用 MS SQL Server 2005。

我们在 Ubuntu 8.04 上进行开发，但我们的生产服务器正在运行 Linux (Centos)，我们也在使用 SqlServer 2005。

根据我们的经验，最初的设置和配置是相当痛苦的——花了几周的时间才让所有东西都能很好地融合在一起。但是，现在一切都变得平淡无奇，我发现 SqlServer 运行良好。

我们使用 FreeTDS ODBC 驱动程序，一旦配置就可以了。

不要在 Windows 上运行 Rails 应用程序——你是在自找麻烦。这对开发来说很好，但仅此而已。Rails 在 Windows 平台上不能很好地扩展。

希望有帮助。

# wpf - 如何在 WPF 应用程序中托管 Flash 内容并使用透明度？

> ID：67151
> 
> 赞同：2
> 
> 时间：2008-09-15T21:26:33.400
> 
> 标签：wpf, flash

如何在 WPF 表单中托管 Flash 内容并在我的 WPF 窗口上仍然使用透明度/alpha？承载 WinForms flash 控件不允许这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T17:00:41.423

除非您用来显示 Flash 内容的控件是内置在 WPF 中的，否则您将遇到这些“空域”问题。从 Win32 到 WinForms 的每一种显示技术都在“底层”使用 HWND，但 WPF 使用 DirectX。然而，Windows 中的窗口管理器仍然只理解 HWND，因此 WPF 应用程序有一个基于 HWND 的顶级窗口，并且在该窗口下的所有内容都在 DirectX 中完成（实际上，上下文菜单和工具提示等内容也有顶级 HWND） . [Adam Nathan 在本文](http://www.ddj.com/windows/197003872?pgno=1)中对 WPF 互操作进行了很好的描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T23:23:47.080

虽然我没有这样做，但您可能可以使用 WPF 3.5 sp1 中的 WebBrowser 控件将您的 Flash 内容包装在 WPF 中。我不确定透明度会如何受到影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T21:30:10.350

您可以使用 Expression 将 Flash 内容转换为 XAML 吗？我相信那里或旁边有工具可以做到这一点。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-03-16T09:18:21.720

只是一直在努力解决如何通过显示 Flash 的能力上传和使 WPF 透明的问题，因为如果您在 MainWindow 上启用“允许透明度”，一旦应用程序运行，Flash 将不会显示。

**1)**我使用 WebBrowser Control 播放 Flash(.swf) 文件。它们在我的电脑上，但是它可以从互联网或任何你托管它们的地方播放。不要忘记命名您的 WebBrowser 控件以在 C# 中访问它。

```
 private void Window_Loaded(object sender, RoutedEventArgs e)
 {   
    MyHelper.ExtendFrame(this, new Thickness(-1));    
    this.MyBrowser.Navigate(@"C:\Happy\Download\flash\PlayWithMEGame.swf");         
 } 
```

**2）**现在透明度。我已在 WPF 中将“假”设置为“允许透明度”并将“窗口样式”设置为“无”。之后，我使用了来自[HERE](https://stackoverflow.com/questions/4253665/wpf-window-transparency-while-hosting-a-flash-activex-component?rq=1)和[HERE](http://blogs.msdn.com/b/adam_nathan/archive/2006/05/04/589686.aspx)的信息并创建了以下代码，该代码产生了在 MainWindow 上允许透明并同时运行 Flash 的预期效果，这是我的代码：

```
public class MyHelper
{
    public static bool ExtendFrame(Window window, Thickness margin)
    {
        IntPtr hwnd = new WindowInteropHelper(window).Handle;
        window.Background = Brushes.Transparent;
        HwndSource.FromHwnd(hwnd).CompositionTarget.BackgroundColor = Colors.Transparent;
        MARGINS margins = new MARGINS(margin);
        DwmExtendFrameIntoClientArea(hwnd, ref margins);
        return true;
    }
    [DllImport("dwmapi.dll", PreserveSig = false)]
    static extern void DwmExtendFrameIntoClientArea(IntPtr hwnd, ref MARGINS margins);
}

 struct MARGINS
    {
        public MARGINS(Thickness t)
        {
            Left = (int)t.Left;
            Right = (int)t.Right;
            Top = (int)t.Top;
            Bottom = (int)t.Bottom;
        }
        public int Left;
        public int Right;
        public int Top;
        public int Bottom;
    } 
```

并从 Window_Loaded() + 调用它，您需要“低于”行才能使“DllImport”工作。

```
using System.Runtime.InteropServices;
using System.Windows.Interop; 
```

# cocoa - 如果我没有在创建它们的线程上显式访问它们，那么操作我在线程之外创建的对象是否安全？

> ID：67154
> 
> 赞同：3
> 
> 时间：2008-09-15T21:27:03.273
> 
> 标签：cocoa, multithreading, macos, core-data

我正在开发一个可可软件，为了在大量数据导入（核心数据）期间保持 GUI 响应，我需要在主线程之外运行导入。

如果我在线程运行时没有显式访问这些对象，**即使**我在主线程中创建它们而不使用锁，访问这些对象是否安全。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T00:27:08.787

使用 Core Data，您应该有一个单独的托管对象上下文用于您的导入线程，连接到相同的协调器和持久存储。您不能简单地将在主线程使用的上下文中创建的对象扔到另一个线程中并期望它们工作。此外，您不能为此进行自己的锁定；您必须至少锁定对象所在的托管对象上下文，视情况而定。但是，如果这些对象被您的视图绑定到控件，则没有“钩子”可以添加上下文的锁定。

没有免费的午餐。

[Ben Trumbull在 2004 年末 webobjects-dev list 上的这篇精彩文章](http://lists.apple.com/archives/webobjects-dev/2004/Dec/msg00255.html "Re: 锁定问题")中解释了您需要使用单独上下文的一些原因，以及为什么“仅阅读”不像您想象的那么简单或安全。（整个线程都很棒。）他正在讨论 Enterprise Objects Framework 和 WebObjects，但他的建议也完全适用于 Core Data。只需在他的消息内容中将“EC”替换为“NSManagedObjectContext”，将“EOF”替换为“Core Data”即可。

Core Data 中线程间共享数据问题的解决方案，就像之前的 Enterprise Objects Framework 一样，是“不要”。如果您进一步考虑过，并且确实确实必须在线程之间共享数据，那么解决方案是将独立的对象图保存在线程隔离的上下文中，并使用来自一个上下文的保存通知中的信息来告诉其他上下文要重新获取的内容。 [`-[NSManagedObjectContext refreshObject:mergeChanges:]`](http://developer.apple.com/documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/Reference/Reference.html#//apple_ref/occ/instm/NSManagedObjectContext/refreshObject:mergeChanges: "-[NSManagedObjectContext refreshObject:mergeChanges:]")专为支持此用途而设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T23:36:28.813

我相信这对于由 CoreData NSManagedObjectContext 管理的 NSManagedObjects（或子类）是不安全的**。**一般来说，CoreData 可能会对托管对象的状态做很多棘手的事情，包括在单独的线程中触发与这些对象相关的错误。特别是，`[NSManagedObject initWithEntity:insertIntoManagedObjectContext:]`（从 OS X 10.5 开始，NSManagedObjects 的指定初始化程序）不保证返回的对象可以安全地传递给其他线程。

[在 Apple 的开发网站](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreData/Articles/cdMultiThreading.html)上对使用多线程的 CoreData 进行了详细记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T21:31:23.123

使用锁的全部意义在于确保两个线程不会尝试访问同一个资源。如果您可以通过其他机制保证这一点，那就去吧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T21:34:34.207

即使它是安全的，但在不同步对这些字段的访问的情况下使用线程之间的共享数据并不是最佳实践。哪个线程创建了对象并不重要，但如果有多个执行行（线程/进程）同时访问该对象，则可能导致数据不一致。

如果您绝对确定只有一个线程会访问该对象，那么不同步访问是安全的。即便如此，我宁愿现在就在我的代码中进行同步，而不是等到稍后应用程序中的更改使第二个线程共享相同的数据而不用担心同步访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T21:39:24.710

是的，它是安全的。一种非常常见的模式是创建一个对象，然后将其添加到队列或其他集合中。第二个“消费者”线程从队列中获取项目并对其进行处理。在这里，您需要同步队列，但不需要同步添加到队列中的对象。

只同步所有内容并希望获得最好的结果并不是一个好主意。您需要非常仔细地考虑您的设计以及哪些线程可以作用于您的对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T21:40:55.770

是的，您可以这样做，这将是安全的

...直到第二个程序员出现并且不理解您所做的相同假设。第二个（或第三个、第四个、第五个……）程序员可能会以非安全的方式（在创建者线程中）开始使用对象。造成的问题可能非常微妙且难以追踪。仅出于这个原因，并且因为在多个线程中使用这个对象非常诱人，我会让对象线程安全。

澄清一下，（感谢那些留下评论的人）：

“线程安全”是指以编程方式设计一种方案来避免线程问题。我不一定是指围绕您的对象设计一个锁定方案。您可以在您的语言中找到一种方法，使在创建者线程中使用该对象成为非法（或非常困难）。例如，在创建者线程中将范围限制为创建对象的代码块。创建后，将对象传递给用户线程，确保创建者线程不再引用它。

例如，在 C++ 中

```
void CreateObject()
{
    Object* sharedObj = new Object();
    PassObjectToUsingThread( sharedObj); // this function would be system dependent
} 
```

然后在您的创建线程中，您在创建对象后不再有权访问该对象，责任将传递给使用线程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T21:45:59.547

需要考虑的两件事是：

*   您必须能够保证对象在其他线程可用之前已完全创建和初始化。
*   必须有某种机制让主 (GUI) 线程检测到数据已加载并且一切正常。为了线程安全，这将不可避免地涉及某种锁定。

# 64-bit - AxAcroPDF - Vista64 类未注册错误

> ID：67167
> 
> 赞同：8
> 
> 时间：2008-09-15T21:28:18.123
> 
> 标签：64-bit, activex, adobe, axacropdf

我们有一个用 C# 编写的 WinForms 应用程序，它使用 AxAcroPDFLib.AxAcroPDF 组件来加载和打印 PDF 文件。在 Windows XP 中一直工作没有任何问题。我已将我的开发环境移至 Vista 64 位，现在应用程序将无法运行（在 Vista 64 上），除非我删除 AxAcroPDF 组件。应用程序运行时出现以下错误：

“System.Runtime.InteropServices.COMException：未注册类（来自 HRESULT 的异常：0x80040154 (REGDB_E_CLASSNOTREG)）。”

我在 Adob​​e 论坛上被告知错误的原因是他们没有 64 位版本的 AxAcroPDF ActiveX 控件。

有没有办法解决这个问题？例如，我可以自己将 32 位 ActiveX 控件转换为 64 位控件吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-16T06:39:31.200

您不能自己将 Adob​​e 的 ActiveX 控件转换为 64 位，但您可以通过将平台目标设置为 x86 来强制您的应用程序以 32 位模式运行。

有关您的 Visual Studio 版本的说明，请参阅[使用 Microsoft Visual Studio 2005 时的问题第 1.44 节](http://msdn.microsoft.com/en-gb/vstudio/aa718685.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T17:38:36.020

.Net 框架 1.1 始终以 32 位 CPU 为目标，而 .Net 框架 2.0 及更高版本可以根据 Visual Studio IDE 的“平台目标”选项更改的程序清单的处理器架构属性以 32 位或 64 位为目标。使用默认选项“任何 CPU”，IL 代码根据平台编译，但如果平台是 64 位，对 AxAcroPDF 32 位组件的 COM 调用当然会失败。只需重建 EXE 以仅针对 32 位平台。这适用于 Vista 64 位中的 WOW64 模拟器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T06:43:36.243

使用 DLL 隔离，适用于每个 32 位 COM+ 应用程序。查看更多信息：http: [//support.microsoft.com/kb/281335](http://support.microsoft.com/kb/281335)

使用此解决方案，您可以将 32 位 COM+ 应用程序隔离到一个单独的 32 位进程中。

64 位应用程序在以下位置搜索已安装的 COM+ 对象：HKLM\Software\Classes，但 32 位应用程序使用 HKLM\Software\WOW6432\Classes

# c++ - 查找由智能指针引起的内存泄漏

> ID：67174
> 
> 赞同：19
> 
> 时间：2008-09-15T21:29:02.427
> 
> 标签：c++, pointers, memory-leaks, smart-pointers

有人知道发现智能指针引起的内存泄漏的“技术”吗？我目前正在开发一个用**C++**编写的大型项目，该项目大量使用带有引用计数的智能指针。显然，我们有一些由智能指针引起的内存泄漏，它们仍然在代码中的某处被引用，因此它们的内存不会被释放。很难找到带有“不必要”引用的代码行，这会导致相应的对象不被释放（尽管它不再使用）。

我在网上找到了一些建议，建议收集引用计数器的递增/递减操作的调用堆栈。这给了我一个很好的提示，哪段代码导致引用计数器增加或减少。

但我需要的是某种算法，将相应的“增加/减少调用堆栈”组合在一起。删除这对调用堆栈后，我希望（至少）剩下一个“增加调用堆栈”，它向我展示了带有“不必要”引用的代码段，导致相应的对象未被释放。现在修复泄漏没什么大不了的！

但是有人对进行分组的“算法”有想法吗？

开发在**Windows XP**下进行。

（我希望有人理解，我试图解释的......）

编辑：我说的是循环引用引起的泄漏。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-17T00:09:19.523

请注意，**引用计数智能指针**的泄漏源之一是具有**循环依赖**关系的指针。例如，A 有一个指向 B 的智能指针，B 有一个指向 A 的智能指针。A 和 B 都不会被销毁。你必须找到，然后打破依赖关系。

如果可能，请使用 boost 智能指针，并将 shared_ptr 用于应该是数据所有者的指针，将 weak_ptr 用于不应该调用 delete 的指针。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-15T21:45:53.120

我这样做的方法很简单： - 在每个 AddRef() 记录调用堆栈上， - 匹配的 Release() 将其删除。这样，在程序结束时，我只剩下 AddRefs() 而没有处理 Releases。无需配对，

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-16T14:27:52.290

如果您可以确定性地重现泄漏，我经常使用的一种简单技术是按构造顺序对所有智能指针进行编号（在构造函数中使用静态计数器），并将此 ID 与泄漏一起报告。然后再次运行程序，并在构造具有相同 ID 的智能指针时触发 DebugBreak()。

您还应该考虑这个很棒的工具： http: [//www.codeproject.com/KB/applications/visualleakdetector.aspx](http://www.codeproject.com/KB/applications/visualleakdetector.aspx "视觉检漏仪")

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-16T14:45:50.437

我所做的是用一个带有**FUNCTION**和**LINE**参数的类来包装智能指针。每次调用构造函数时增加该函数和行的计数，每次调用析构函数时减少计数。然后，编写一个转储函数/行/计数信息的函数。这会告诉您所有引用的创建位置

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-09T21:44:00.097

要检测引用周期，您需要拥有所有引用计数对象的图表。这样的图并不容易构建，但可以做到。

创建一个全局`set<CRefCounted*>`对象来注册活的引用计数对象。如果您有通用的 AddRef() 实现，这会更容易 - 只需`this`在对象的引用计数从 0 变为 1 时添加指向集合的指针。类似地，在 Release() 中，当引用计数从 1 变为 0 时从集合中删除对象。

接下来，提供一些方法来从每个`CRefCounted*`. 它可能是一个`virtual set<CRefCounted*> CRefCounted::get_children()`或任何适合你的东西。现在你有一种方法来遍历图表。

最后，[在有向图中实现您最喜欢的循环检测](http://coding.derkeiler.com/Archive/General/comp.theory/2004-02/0462.html)算法。启动程序，创建一些循环并运行循环检测器。享受！:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-15T21:53:14.240

我为解决这个问题所做的是覆盖**malloc/new**和**free/delete**运算符，以便它们尽可能多地在数据结构中跟踪您正在执行的操作。

例如，在覆盖**malloc/new**时，您可以创建调用方地址、请求的字节数、返回的分配指针值和序列 ID 的记录，这样您的所有记录都可以排序（我不知道您是否处理线程，但您也需要考虑到这一点）。

在编写**释放/删除**例程时，我还跟踪调用者的地址和指针信息。然后我向后查看列表并尝试使用指针作为键来匹配**malloc/new对应项。**如果我没有找到它，请举起红旗。

如果您负担得起，您可以在数据中嵌入序列 ID，以绝对确定谁以及何时进行了分配调用。这里的关键是尽可能地唯一标识每个交易对。

然后你将有第三个例程显示你的内存分配/释放历史，以及调用每个事务的函数。（这可以通过从链接器中解析符号映射来完成）。您将随时知道您将分配多少内存以及是谁分配的。

如果您没有足够的资源来执行这些事务（我的典型案例是 8 位微控制器），您可以通过串行或 TCP 链接将相同的信息输出到具有足够资源的另一台机器。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-16T02:21:22.380

既然您说您使用的是 Windows，那么您也许可以利用 Microsoft 的用户模式转储堆实用程序[UMDH](http://msdn.microsoft.com/en-us/library/ff560206.aspx)，该实用程序与[Debugging Tools for Windows](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)一起提供。UMDH 制作应用程序内存使用情况的快照，记录每次分配使用的堆栈，并让您比较多个快照以查看对分配器的哪些调用“泄漏”了内存。它还使用 dbghelp.dll 将堆栈跟踪转换为符号。

还有另一个名为“LeakDiag”的 Microsoft 工具，它支持比 UMDH 更多的内存分配器，但它有点难找，而且似乎没有得到积极维护。如果我没记错的话，最新版本至少有五年历史了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-16T07:24:41.387

这不是找到泄漏的问题。在智能指针的情况下，它很可能会指向一些通用的地方，比如 CreateObject()，它被调用了数千次。这是一个确定代码中的哪个位置没有在引用计数的对象上调用 Release() 的问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T21:37:04.607

如果我是你，我会记录日志并编写一个快速脚本来执行以下操作（我的是 Ruby）：

```
def allocation?(line)
  # determine if this line is a log line indicating allocation/deallocation
end

def unique_stack(line)
  # return a string that is equal for pairs of allocation/deallocation
end

allocations = []
file = File.new "the-log.log"
file.each_line { |line|
  # custom function to determine if line is an alloc/dealloc
  if allocation? line
    # custom function to get unique stack trace where the return value
    # is the same for a alloc and dealloc
    allocations[allocations.length] = unique_stack line
  end
}

allocations.sort!

# go through and remove pairs of allocations that equal,
# ideally 1 will be remaining....
index = 0

while index < allocations.size - 1
  if allocations[index] == allocations[index + 1]
    allocations.delete_at index
  else
    index = index + 1
  end
end

allocations.each { |line|
  puts line
} 
```

这基本上通过日志并捕获每个分配/解除分配并为每对存储一个唯一值，然后对其进行排序并删除匹配的对，看看还剩下什么。

更新：抱歉所有中间编辑（我在完成之前不小心发布了）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-15T22:26:24.817

对于 Windows，请查看：

[MFC 内存泄漏检测](http://msdn.microsoft.com/en-us/library/c99kz476(VS.80).aspx)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-16T09:21:51.217

我是[Google 的 Heapchecker 的忠实粉丝](http://goog-perftools.sourceforge.net/doc/heap_checker.html)——它不会捕获所有泄漏，但它会捕获大部分泄漏。（**提示**：将其链接到您的所有单元测试中。）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-21T11:51:22.417

第一步可能是知道什么类正在泄漏。一旦知道了，就可以知道是谁在增加引用： 1\. 在由 shared_ptr 包裹的类的构造函数上下断点。2\. 在 shared_ptr 增加引用计数时使用调试器介入：查看变量 pn->pi_->use_count_ 通过评估表达式获取该变量的地址（类似于：&this->pn->pi_.use_count_），您将获得一个地址 3\. 在 Visual Studio 调试器中，转到 Debug->New Breakpoint->New Data Breakpoint... 输入变量的地址 4\. 运行程序。每当代码中的某个点增加和减少引用计数器时，您的程序都会停止。然后你需要检查它们是否匹配。

# python - 插入大量数据时出现 mod_python/MySQL 错误：“OperationalError: (2006, 'MySQL server has gone away')”

> ID：67180
> 
> 赞同：0
> 
> 时间：2008-09-15T21:29:26.827
> 
> 标签：python, mysql, xampp, mysql-error-2006

当使用大量数据进行 INSERT 时，即：

```
INSERT INTO table (mediumtext_field) VALUES ('...lots of text here: about 2MB worth...') 
```

MySQL 回归

> "OperationalError: (2006, 'MySQL server has gone away')"

这是在启动脚本后一分钟内发生的，因此这不是超时问题。此外，`mediumtext_field`应该能够保存约 16MB 的数据，所以这应该不是问题。

任何想法是什么导致了错误或如何解决它？

正在使用的一些相关库：`mod_python 3.3.1`，`MySQL 5.0.51`（在 Windows XP SP3 上，通过 xampp，详情如下）

**ApacheFriends XAMPP（基础包）1.6.5版**

*   阿帕奇 2.2.6
*   MySQL 5.0.51
*   phpMyAdmin 2.11.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T14:34:30.420

检查 my.cnf 文件中的 max_packet 设置。这决定了您可以在单个语句中发送到 mysql 服务器的最大数据量。超过此值会导致该错误。

# java - 在 Windows XP 下运行的 Java 线程模型规范是否随处可用？

> ID：67183
> 
> 赞同：0
> 
> 时间：2008-09-15T21:29:45.983
> 
> 标签：java, multithreading, documentation

有各种文档描述了 Solaris/Linux 上的线程，但现在没有描述 Windows 实现。我对此有过浓厚的兴趣，如此重要的事情（似乎）没有记录在案似乎很奇怪。

线程在不同的操作系统上是不一样的——“一次编写，随处运行”对于线程来说是不正确的。

请参阅[http://java.sun.com/docs/hotspot/threads/threads.html](http://java.sun.com/docs/hotspot/threads/threads.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-01T08:28:38.340

为了最直接地回答您的问题，JVM 规范故意未定义有关如何实现线程的精确语义。

FWIW，Sebastion 的声明“Java 的公开线程模型在每个平台上都是相同的，并在 Java 规范中定义。对于 Java 应用程序，即使是线程，底层操作系统也应该是完全透明的”，这是不准确的。

我发现 Windows 和 Linux 下的线程在使用等待/通知的线程饥饿方面存在显着的经验差异。当许多线程争夺一个锁时， Linux*更*容易出现饥饿 - 以至于我必须在 Windows 中加载比 Linux 多 3*个数量级的*线程才能导致饥饿。对于竞争激烈的锁，带有 fair 修饰符的 Java 并发锁变得至关重要。

为了说明数字，我在 Linux 下遇到了一个问题，一个锁被 31 个线程严重竞争，而在 Windows 下，相同的代码需要 10,000 个（是的，即 10,000*个*）线程才能开始演示饥饿问题。

更糟糕的是，Linux 下出现了 3 种不同的线程模型，每一种都有不同的特性。

大多数情况下，线程在我的经验中是透明的，但争用问题值得仔细考虑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T02:30:16.587

这实际上取决于特定的 JVM 实现。我假设您想知道 Sun 的 Windows JVM，我可以肯定地告诉您，Sun JVM 将 Java 线程映射到 OS 线程。

您可以尝试从 Java 代码中生成几个线程，打开任务管理器并查看发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T23:14:24.717

有问题的文档讨论了 Solaris 线程模型以及 VM 如何映射到它。这与Linux无关。此外，该文档仅讨论性能。无论您选择什么，程序的整体行为都不应改变。

Java 公开的线程模型在每个平台上都是相同的，并在 Java 规范中定义。对于 Java 应用程序，即使对于线程，底层操作系统也应该是完全透明的。

但是，如果您必须知道... Sun JVM 将其线程 1:1 映射到 Windows 线程。它不使用多种工艺或纤维。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-15T23:22:56.553

该文档更多地是关于 Solaris 线程而不是 Java 线程模型。所有 JVM 都会调用它们所针对的操作系统的本机线程 API，因此一个操作系统线程总是有一个 Java 线程。文档中的图表显示，直到线程在操作系统空间中才发生更改。对于 Windows 特定文档，每个操作系统都可以以不同方式处理线程，这是一个很好的起点：[MSDN About Processes and Threads](http://msdn.microsoft.com/en-us/library/ms681917(VS.85).aspx)。

很长一段时间以来，*nix 的各种风格都使用进程而不是实际线程来实现它们的线程，似乎那些特定的调整参数可以简化向 Solaris 中更新的线程模型的过渡。这使得旧模型和那些 JVM 选项过时了。

有关 HotSpot JVM 的 JVM 选项列表，您可以查看：[HotSpot VM Options](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)。其中很多对于调整长时间运行的应用程序很有用，但如果您不了解它们在做什么，您也可能会遇到麻烦。还要记住，JVM 的每个实现都可以有一组不同的选项，您在 IBM 的 VM 或 BEA 上找不到其中一些选项。

# c# - VB转C#的工具推荐

> ID：67200
> 
> 赞同：3
> 
> 时间：2008-09-15T21:31:13.297
> 
> 标签：c#, vb.net, visual-studio-2008

我们有一个包含超过 500,000 行 VB.NET 的项目，我们需要将其转换为 C#。根据经验，对使用的工具有什么建议吗？我们正在使用 Visual Studio 2008，我们的目标是 3.5 。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-15T21:53:39.450

我同意评论。您有 500,000 行经过验证的真实 VB.NET 代码。你到底为什么要浪费时间改变它？没有人说你不能用 C# 编写所有新组件。

我会考虑不要担心工具，而是真正地问自己，为什么要这样做？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T21:43:00.320

前一段时间做过这个评估。你会发现很多“免费”的解决方案在边缘情况下很糟糕。这个商业产品[http://www.tangiblesoftwaresolutions.com](http://www.tangiblesoftwaresolutions.com)绝不是完美的；但是，这是我们当时在进行真正的转换测试时能找到的最好的。注意：我只是作为客户发言。如果有人找到了在实际使用中产生比这更好的转换的解决方案，请告诉我。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-15T21:32:59.827

Reflector 会反编译 IL 并为您生成 C#，这会很粗糙，但是一个不错的开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T21:36:24.377

Reflector 曾经有一个插件，它创建了一个完整的 Visual Studio 解决方案。但是，我不知道它是否仍然可用或工作，现在 Red Gate 已经接管了 Reflector。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T21:37:23.093

[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)有一个内置的转换器 IIRC。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T21:35:07.280

我已经使用[这个网站](http://labs.developerfusion.co.uk/convert/vb-to-csharp.aspx)一段时间了，我的一些较小的转换。它已经相当可靠了。

根据该站点，他们的转换器基于内置转换器的[开源 IDE](http://www.icsharpcode.net/OpenSource/SD/Features.aspx)，因此您也可以尝试“源站点”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T22:39:58.670

Telerik 的转换器运行良好。

[http://converter.telerik.com/](http://converter.telerik.com/)
[http://converter.telerik.com/batch.aspx](http://converter.telerik.com/batch.aspx)

# javascript - 使用 jQuery 或其他库的 Apple Cover-flow 效果？

> ID：67207
> 
> 赞同：58
> 
> 时间：2008-09-15T21:32:17.957
> 
> 标签：javascript, jquery, client-side-scripting

有谁知道如何使用 JavaScript 滚动一堆图像来实现覆盖流效果。我不是在谈论 3D 旋转*iTunes*封面艺术，而是当您在文档文件夹中按下空格键时发生的效果，允许您以*灯箱*方式预览它们。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2010-01-13T11:25:25.087

[http://www.jacksasylum.eu/ContentFlow/](http://www.jacksasylum.eu/ContentFlow/)

*   是我发现的最好的。一个真正的'CoverFlow'，高度可配置，跨浏览器，非常流畅的动作，具有reelections并支持滚轮+键盘控制。- 必须是您想要的！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-15T22:52:12.617

不确定您是在谈论 Coverflow（滚动图像）还是 Quicklook（在灯箱中预览文件），请尝试编辑您的问题。

下面是一些 JS Coverflow 的实现：

*   [MooFlow - MooTools 的 Coverflow](http://www.outcut.de/MooFlow/example-ajax.html)
*   [JS 概念验证中的 Coverflow](http://radnan.public.iastate.edu/coverflow/)
*   [Coverflow 使用 JS 和 CSS 转换（仅限 Webkit）](http://paulbakaus.com/?p=6&language=en)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-12-19T23:08:19.953

我认为这就是你想要的[http://addyosmani.com/blog/jqueryuicoverflow/](http://addyosmani.com/blog/jqueryuicoverflow/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-04-01T22:06:37.993

我尝试使用 Jack's Asylum 封面流程，但它不会让我轻松删除并重新添加整个封面流程。我最终找到了[http://finnrudolph.de/ImageFlow](http://finnrudolph.de/ImageFlow)，它不仅更可靠，更容易连接，使用更少的标记，并且在翻阅图像时不会抖动。这是迄今为止我发现的最好的，我已经在这个页面上尝试了几个。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-14T18:25:55.817

在 [http://www.jqueryfordesigners.com/slider-gallery/](http://www.jqueryfordesigners.com/slider-gallery/)上有一个 Apple 风格的 Gallery Slider，它使用 jQuery 和 UI。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-15T20:22:50.127

[jCoverflip](http://www.jcoverflip.com)刚刚发布并且非常可定制。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-08-14T18:44:15.477

这是你想要的？

“[使用 jQuery 创建类似 Apple Itunes 的横幅旋转器/幻灯片](http://youhack.me/2011/08/11/create-an-itunes-like-banner-rotatorslideshow-with-jquery/)”是一篇解释如何使用 jQuery 制作此类效果的文章。

您还可以查看 [现场演示](http://youhack.me/demo/Apple%20itunes%20banner%20rotator/index.html)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-01-27T17:10:36.830

colorbox 有如此惊人的功能......喜欢它。也喜欢这个[http://www.webappers.com/2008/03/05/galleria-simple-but-nice-jquery-image-gallery/](http://www.webappers.com/2008/03/05/galleria-simple-but-nice-jquery-image-gallery/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T21:40:58.297

在这里尝试 Jquery 界面元素 - [http://interface.eyecon.ro/docs/carousel](http://interface.eyecon.ro/docs/carousel)

这是一个示例。 [http://interface.eyecon.ro/demos/carousel.html](http://interface.eyecon.ro/demos/carousel.html)

几个月前，我四处寻找一个 Jquery 图像轮播，但没有找到一个好的，所以我放弃了。这是我能找到的最好的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-25T20:37:05.830

只是为了让大家知道，xFlow！已经完成了一些重要的工作，并且得到了很大的改进。

获取更多信息和最新版本，请访问[http://xflow.pwhitrow.com 。](http://xflow.pwhitrow.com)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-11-27T21:20:41.310

我目前正在研究这个并计划将它作为一个 jQuery-ui 插件发布。

-> [http://coulisse.luvdasun.com/](http://coulisse.luvdasun.com/)

如果您有兴趣以及希望在这样的插件中看到什么，请告诉我。

克

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-01-19T19:31:30.823

查看 momoflow：[http](http://flow.momolog.info) : //flow.momolog.info 真正的封面流效果，在 Webkit（Safari 和 Chrome）和 Opera 上表现出色，在 Firefox 上也可以。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-01-19T21:21:31.603

> 当您在文档文件夹中按空格键时发生的效果，允许您以灯箱方式预览它们

看起来需要一个经典的灯箱插件。这是我最喜欢的 jQuery 灯箱插件：[http](http://colorpowered.com/colorbox/) ://colorpowered.com/colorbox/ 。它很容易定制等。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-12-16T02:48:21.790

这个看起来很有希望，并且比其他示例更接近实际的 Apple 覆盖流效果：

[blarnee.com/projects/cflow](http://www.blarnee.com/projects/cflow/)

# visual-studio-2008 - 如何自定义 Visual Studio 2008 中的复制/粘贴行为？

> ID：67209
> 
> 赞同：10
> 
> 时间：2008-09-15T21:32:35.790
> 
> 标签：visual-studio-2008, copy-paste

如何自定义 Visual Studio 2008 中的复制/粘贴行为？

例如，我创建一个新`<div id="MyDiv"></div>`文件，然后将其复制并粘贴到同一个文件中。

VisualStudio 粘贴`<div id="Div1"></div>`而不是我复制的原始文本。

当我试图复制一组我想复制/粘贴多次并且只更改一部分 id 的相关 div 时，这更加令人沮丧。

是否可以调整设置以更改复制/粘贴行为？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-15T21:49:57.040

进入工具 > 选项 > 文本编辑器 > HTML > 杂项并取消选中“在源视图中粘贴时的自动 ID 元素”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-17T12:22:30.780

在 Visual Studio 2019 中，新位置是
`Tools > Text Editor > ASP.NET Web Forms`
Check `Format HTML on paste`。
因此，现在可以有效地复制顺序 ID 代码。

# vba - 使用 Excel PrintOut 方法时如何防止打印对话框

> ID：67219
> 
> 赞同：6
> 
> 时间：2008-09-15T21:33:26.240
> 
> 标签：vba, excel, printing, printdialog

当我使用 PrintOut 方法将工作表对象打印到打印机时，即使我设置了 DisplayAlerts = False，也会显示“打印”对话框（显示文件名、目标打印机、打印的页面和取消按钮）。下面的代码在 Excel 宏中工作，但如果我在 VB 或 VB.Net 应用程序中使用此代码（使用 Excel 对象所需的参考更改），也会发生同样的事情。

```
Public Sub TestPrint()
Dim vSheet As Worksheet

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    Set vSheet = ActiveSheet
    vSheet.PrintOut Preview:=False

    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

End Sub 
```

编辑：下面的答案更清楚地说明了这一点（它可能是 Windows 对话框而不是 Excel 对话框），但没有回答我的问题。有谁知道如何防止它被显示？

编辑：谢谢你的额外研究，凯文。看起来很像这就是我所需要的。只是不确定我想盲目地接受这样的 API 代码。是否还有其他人对这些 API 调用有任何了解，并且他们正在做作者声称的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:17:38.587

如果您不想显示打印对话框，则只需进行如下宏测试；它不会显示任何打印对话框，并且会检测到默认打印机并立即打印。

```
sub  test()

 activesheet.printout preview:= false

end sub 
```

运行此宏，它将打印当前活动的工作表而不显示打印对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T06:09:57.370

当您说“打印”对话框时，我假设您的意思是“现在正在打印 xxx”对话框而不是标准打印对话框（选择打印机、份数等）。以您上面的示例并尝试一下，这就是我看到的行为-“正在打印...”短暂显示然后自动关闭。

您尝试控制的内容可能与 Excel 无关，而是与 Windows 级别的行为相关联。如果它是可控的，您需要 a) 禁用它，b) 执行打印，c) 重新启用。如果您的代码失败，则存在无法为其他应用程序重新启用的风险。

编辑：试试这个解决方案：[How do you prevent printing dialog when using Excel PrintOut method](http://www.mrexcel.com/archive2/11900/13336.htm)。它似乎准确地描述了你所追求的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T14:17:52.660

Kevin Haines 链接的文章中的 API 调用隐藏了打印对话框，如下所示：

1.  获取打印对话窗口的句柄。
2.  向窗口发送消息，告诉它不要重绘
3.  使窗口无效，这会强制重绘永远不会发生
4.  告诉 Windows 重新绘制窗口，这会导致它消失。

说得委婉些，过于简单化了。

API 调用是安全的，但如果您的应用程序失败，您可能需要确保将打印对话框的屏幕更新设置为 True。

# python - 为什么我的 pyglet 顶点列表和批处理在 Windows 上会很慢？

> ID：67223
> 
> 赞同：0
> 
> 时间：2008-09-15T21:33:41.260
> 
> 标签：python, opengl, pyglet

我正在使用库 pyglet 在 python 中编写 opengl 代码。当我使用 pyglet.graphics.vertex_list 或 pyglet.graphics.batch 对象在屏幕上绘制时，与普通的旧 pyglet.graphics.draw() 或 glVertex() 调用相比，它们非常慢（~0.1 fps），这大约是相同几何图形的 40fps。在 Linux 中，vertex_list 的速度与 glVertex 大致相同，这令人失望，而批处理方法的速度大约是后者的两倍，这比我希望的要好一些，但收益并不多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T16:09:19.857

不要忘记用'python -O myscript.py'调用你的pyglet脚本，'-O'标志可以产生巨大的性能差异。

[请参阅此处](https://pyglet.readthedocs.io/en/pyglet-1.3-maintenance/programming_guide/gl.html?highlight=performance#error-checking)和[此处](https://pyglet.readthedocs.io/en/pyglet-1.3-maintenance/programming_guide/options.html?highlight=debug_gl)的pyglet 文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T23:24:55.300

我个人不知道，但我注意到您尚未[在 pyglet 邮件列表中](http://groups.google.com/group/pyglet-users)发布有关此内容的信息。更多 Pyglet 用户以及主要开发人员阅读该列表。

# sql-server - 如何使用 TSQL 确定授予哪些角色对特定存储过程的执行权限？

> ID：67244
> 
> 赞同：3
> 
> 时间：2008-09-15T21:36:30.427
> 
> 标签：sql-server, tsql, stored-procedures

如何使用 TSQL 确定授予哪些角色对特定存储过程的执行权限？我可以使用系统存储过程或系统视图吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T07:30:12.590

在 7.0 或 2000 中，您可以修改和使用以下代码：

```
SELECT convert(varchar(100),
        'GRANT ' +
        CASE         WHEN actadd & 32 = 32 THEN 'EXECUTE'
                ELSE
                        CASE WHEN actadd & 1 = 1   THEN 'SELECT' + CASE WHEN actadd & (8|2|16) > 0  THEN ', ' ELSE '' END ELSE '' END +
                        CASE WHEN actadd & 8 = 8   THEN 'INSERT' + CASE WHEN actadd & (2|16) > 0  THEN ', ' ELSE '' END ELSE '' END +
                        CASE WHEN actadd & 2 = 2   THEN 'UPDATE' + CASE WHEN actadd & (16) > 0  THEN ', ' ELSE '' END ELSE '' END +
                        CASE WHEN actadd & 16 = 16 THEN 'DELETE' ELSE '' END
        END + ' ON [' + o.name + '] TO [' + u.name + ']') AS '--Permissions--'
FROM syspermissions p
INNER JOIN sysusers u ON u.uid = p.grantee
INNER JOIN sysobjects o ON p.id = o.id
WHERE o.type <> 'S'
AND o.name NOT LIKE 'dt%'
--AND o.name = '<specific procedure/table>'
--AND u.name = '<specific user>'
ORDER BY u.name, o.name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T21:56:52.640

你可以尝试这样的事情。请注意，我相信 3 是执行。

```
SELECT
grantee_principal.name AS [Grantee],
CASE grantee_principal.type WHEN 'R' THEN 3 WHEN 'A' THEN 4 ELSE 2 END - CASE 'database' WHEN  'database' THEN 0 ELSE 2 END AS [GranteeType]
FROM
sys.all_objects AS sp
INNER JOIN sys.database_permissions AS prmssn ON prmssn.major_id=sp.object_id AND prmssn.minor_id=0 AND prmssn.class=1
INNER JOIN sys.database_principals AS grantee_principal ON grantee_principal.principal_id = prmssn.grantee_principal_id
WHERE
(sp.type = N'P' OR sp.type = N'RF' OR sp.type='PC')and(sp.name=N'myProcedure' and SCHEMA_N 
```

我通过简单地使用 SQL Profiler 查看过程的权限来获得该示例。我希望这会有所帮助。

# c++ - 如何在标准 C++ 中递归地遍历每个文件/目录？

> ID：67273
> 
> 赞同：145
> 
> 时间：2008-09-15T21:41:00.963
> 
> 标签：c++, filesystems

如何在标准 C++ 中递归地遍历每个文件/目录？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-09-15T21:44:42.700

在标准 C++ 中，技术上没有办法做到这一点，因为标准 C++ 没有目录的概念。如果你想稍微扩展你的网络，你可能想看看使用[Boost.FileSystem](http://www.boost.org/doc/libs/1_36_0/libs/filesystem/doc/index.htm)。这已被接受以包含在 TR2 中，因此这为您提供了使您的实现尽可能接近标准的最佳机会。

一个例子，直接取自网站：

```
bool find_file( const path & dir_path,         // in this directory,
                const std::string & file_name, // search for this name,
                path & path_found )            // placing path here if found
{
  if ( !exists( dir_path ) ) return false;
  directory_iterator end_itr; // default construction yields past-the-end
  for ( directory_iterator itr( dir_path );
        itr != end_itr;
        ++itr )
  {
    if ( is_directory(itr->status()) )
    {
      if ( find_file( itr->path(), file_name, path_found ) ) return true;
    }
    else if ( itr->leaf() == file_name ) // see below
    {
      path_found = itr->path();
      return true;
    }
  }
  return false;
} 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2015-10-01T13:55:00.373

从 C++17 开始，[`<filesystem>`](https://en.cppreference.com/w/cpp/filesystem/recursive_directory_iterator)标头和范围- `for`，您可以简单地执行以下操作：

```
#include <filesystem>

using recursive_directory_iterator = std::filesystem::recursive_directory_iterator;
...
for (const auto& dirEntry : recursive_directory_iterator(myPath))
     std::cout << dirEntry << std::endl; 
```

从 C++17 开始，`std::filesystem`它是标准库的一部分，可以在`<filesystem>`标头中找到（不再是“实验性的”）。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2008-09-15T21:47:50.260

如果使用 Win32 API，您可以使用**FindFirstFile**和**FindNextFile**函数。

[http://msdn.microsoft.com/en-us/library/aa365200(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365200(VS.85).aspx)

对于目录的递归遍历，您必须检查每个**WIN32_FIND_DATA.dwFileAttributes**以检查**FILE_ATTRIBUTE_DIRECTORY**位是否已设置。如果设置了该位，那么您可以使用该目录递归调用该函数。或者，您可以使用堆栈来提供与递归调用相同的效果，但避免非常长的路径树的堆栈溢出。

```
#include <windows.h>
#include <string>
#include <vector>
#include <stack>
#include <iostream>

using namespace std;

bool ListFiles(wstring path, wstring mask, vector<wstring>& files) {
    HANDLE hFind = INVALID_HANDLE_VALUE;
    WIN32_FIND_DATA ffd;
    wstring spec;
    stack<wstring> directories;

    directories.push(path);
    files.clear();

    while (!directories.empty()) {
        path = directories.top();
        spec = path + L"\\" + mask;
        directories.pop();

        hFind = FindFirstFile(spec.c_str(), &ffd);
        if (hFind == INVALID_HANDLE_VALUE)  {
            return false;
        } 

        do {
            if (wcscmp(ffd.cFileName, L".") != 0 && 
                wcscmp(ffd.cFileName, L"..") != 0) {
                if (ffd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY) {
                    directories.push(path + L"\\" + ffd.cFileName);
                }
                else {
                    files.push_back(path + L"\\" + ffd.cFileName);
                }
            }
        } while (FindNextFile(hFind, &ffd) != 0);

        if (GetLastError() != ERROR_NO_MORE_FILES) {
            FindClose(hFind);
            return false;
        }

        FindClose(hFind);
        hFind = INVALID_HANDLE_VALUE;
    }

    return true;
}

int main(int argc, char* argv[])
{
    vector<wstring> files;

    if (ListFiles(L"F:\\cvsrepos", L"*", files)) {
        for (vector<wstring>::iterator it = files.begin(); 
             it != files.end(); 
             ++it) {
            wcout << it->c_str() << endl;
        }
    }
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2013-10-18T15:11:32.743

[您可以使用新的基于C++11](https://en.wikipedia.org/wiki/C++11)范围`for`和[Boost](http://en.wikipedia.org/wiki/Boost_%28C++_libraries%29)使其更简单：

```
#include <boost/filesystem.hpp>

using namespace boost::filesystem;    
struct recursive_directory_range
{
    typedef recursive_directory_iterator iterator;
    recursive_directory_range(path p) : p_(p) {}

    iterator begin() { return recursive_directory_iterator(p_); }
    iterator end() { return recursive_directory_iterator(); }

    path p_;
};

for (auto it : recursive_directory_range(dir_path))
{
    std::cout << it << std::endl;
} 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2012-09-02T23:15:00.170

一个快速的解决方案是使用 C 的[Dirent.h](http://en.wikipedia.org/wiki/Dirent.h)库。

来自维基百科的工作代码片段：

```
#include <stdio.h>
#include <dirent.h>

int listdir(const char *path) {
    struct dirent *entry;
    DIR *dp;

    dp = opendir(path);
    if (dp == NULL) {
        perror("opendir: Path does not exist or could not be read.");
        return -1;
    }

    while ((entry = readdir(dp)))
        puts(entry->d_name);

    closedir(dp);
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-09-24T11:11:31.850

除了上面提到的 boost::filesystem 之外，您可能还需要检查[wxWidgets::wxDir](http://docs.wxwidgets.org/2.8/wx_wxdir.html)和[Qt::QDir](http://qt.nokia.com/doc/4.5/qdir.html)。

wxWidgets 和 Qt 都是开源的、跨平台的 C++ 框架。

`wxDir`提供了一种灵活的方式来递归地使用`Traverse()`或更简单的`GetAllFiles()`函数遍历文件。您也可以使用`GetFirst()`和`GetNext()`函数实现遍历（我假设 Traverse() 和 GetAllFiles() 是最终使用 GetFirst() 和 GetNext() 函数的包装器）。

`QDir`提供对目录结构及其内容的访问。有几种方法可以使用 QDir 遍历目录。您可以使用使用 QDirIterator::Subdirectories 标志实例化的 QDirIterator 遍历目录内容（包括子目录）。另一种方法是使用 QDir 的 GetEntryList() 函数并实现递归遍历。

下面是示例代码（取自[这里](http://www.digitalfanatics.org/projects/qt_tutorial/chapter08.html)# 示例 8-5），展示了如何遍历所有子目录。

```
#include <qapplication.h>
#include <qdir.h>
#include <iostream>

int main( int argc, char **argv )
{
    QApplication a( argc, argv );
    QDir currentDir = QDir::current();

    currentDir.setFilter( QDir::Dirs );
    QStringList entries = currentDir.entryList();
    for( QStringList::ConstIterator entry=entries.begin(); entry!=entries.end(); ++entry) 
    {
         std::cout << *entry << std::endl;
    }
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-05-05T14:52:23.810

Boost::filesystem 提供了 recursive_directory_iterator，这对于这个任务来说相当方便：

```
#include "boost/filesystem.hpp"
#include <iostream>

using namespace boost::filesystem;

recursive_directory_iterator end;
for (recursive_directory_iterator it("./"); it != end; ++it) {
    std::cout << *it << std::endl;                                    
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2020-05-28T05:43:44.760

您可以使用`std::filesystem::recursive_directory_iterator`. 但请注意，这包括符号（软）链接。如果你想避免它们，你可以使用`is_symlink`. 示例用法：

```
size_t directory_size(const std::filesystem::path& directory)
{
    size_t size{ 0 };
    for (const auto& entry : std::filesystem::recursive_directory_iterator(directory))
    {
        if (entry.is_regular_file() && !entry.is_symlink())
        {
            size += entry.file_size();
        }
    }
    return size;
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-11-13T20:06:01.403

您可以在[POSIX系统上使用](http://en.wikipedia.org/wiki/POSIX)[`ftw(3)`或`nftw(3)`](http://linux.die.net/man/3/ftw)遍历 C 或 C++ 中的文件系统层次结构。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-03-17T20:54:17.947

最好使用 boost 或 c++14 的实验性文件系统的东西。**如果**您正在解析内部目录（即在程序关闭后用于您的程序存储数据），则制作一个包含文件内容索引的索引文件。顺便说一句，您将来可能需要使用 boost，所以如果您没有安装它，请安装它！其次，您可以使用条件编译，例如：

```
#ifdef WINDOWS //define WINDOWS in your code to compile for windows
#endif 
```

每个案例的代码取自[https://stackoverflow.com/a/67336/7077165](https://stackoverflow.com/a/67336/7077165)

```
#ifdef POSIX //unix, linux, etc.
#include <stdio.h>
#include <dirent.h>

int listdir(const char *path) {
    struct dirent *entry;
    DIR *dp;

    dp = opendir(path);
    if (dp == NULL) {
        perror("opendir: Path does not exist or could not be read.");
        return -1;
    }

    while ((entry = readdir(dp)))
        puts(entry->d_name);

    closedir(dp);
    return 0;
}
#endif
#ifdef WINDOWS
#include <windows.h>
#include <string>
#include <vector>
#include <stack>
#include <iostream>

using namespace std;

bool ListFiles(wstring path, wstring mask, vector<wstring>& files) {
    HANDLE hFind = INVALID_HANDLE_VALUE;
    WIN32_FIND_DATA ffd;
    wstring spec;
    stack<wstring> directories;

    directories.push(path);
    files.clear();

    while (!directories.empty()) {
        path = directories.top();
        spec = path + L"\\" + mask;
        directories.pop();

        hFind = FindFirstFile(spec.c_str(), &ffd);
        if (hFind == INVALID_HANDLE_VALUE)  {
            return false;
        } 

        do {
            if (wcscmp(ffd.cFileName, L".") != 0 && 
                wcscmp(ffd.cFileName, L"..") != 0) {
                if (ffd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY) {
                    directories.push(path + L"\\" + ffd.cFileName);
                }
                else {
                    files.push_back(path + L"\\" + ffd.cFileName);
                }
            }
        } while (FindNextFile(hFind, &ffd) != 0);

        if (GetLastError() != ERROR_NO_MORE_FILES) {
            FindClose(hFind);
            return false;
        }

        FindClose(hFind);
        hFind = INVALID_HANDLE_VALUE;
    }

    return true;
}
#endif
//so on and so forth. 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2019-05-30T10:38:17.013

我们在 2019 年。我们有[文件系统](https://en.cppreference.com/w/cpp/filesystem)标准库`C++`。它`Filesystem library`提供了对文件系统及其组件（例如路径、常规文件和目录）执行操作的工具。

如果您正在考虑可移植性问题，则[此链接](https://en.cppreference.com/w/cpp/filesystem)上有一个重要说明。它说：

> 如果实现无法访问分层文件系统，或者如果它不提供必要的功能，则文件系统库设施可能不可用。如果底层文件系统不支持某些功能（例如 FAT 文件系统缺少符号链接并禁止多个硬链接），则它们可能不可用。在这些情况下，必须报告错误。

文件系统库最初开发为`boost.filesystem`，作为技术规范 ISO/IEC TS 18822:2015 发布，最终从 C++17 合并到 ISO C++。boost 实现目前在比 C++17 库更多的编译器和平台上可用。

**@adi-shavit 在 std::experimental 中回答了这个问题，他在 2017 年更新了这个答案。我想提供有关该库的更多详细信息并显示更详细的示例。**

[std::filesystem::recursive_directory_iterator](https://en.cppreference.com/w/cpp/filesystem/recursive_directory_iterator)是一个`LegacyInputIterator`迭代目录的 directory_entry 元素，并递归地迭代所有子目录的条目。迭代顺序是未指定的，除了每个目录条目只被访问一次。

如果您不想递归迭代子目录的条目，则应使用[directory_iterator 。](https://en.cppreference.com/w/cpp/filesystem/directory_iterator)

两个迭代器都返回一个[directory_entry](https://en.cppreference.com/w/cpp/filesystem/directory_entry)对象。`directory_entry`具有各种有用的成员函数，如, ,`is_regular_file`等`is_directory`。该成员函数返回[std::filesystem::path](https://en.cppreference.com/w/cpp/filesystem/path)的对象，可用于获取, , .`is_socket``is_symlink``path()``file extension``filename``root name`

考虑下面的例子。我一直在使用`Ubuntu`并在终端上编译它

**g++ example.cpp --std=c++17 -lstdc++fs -Wall**

```
#include <iostream>
#include <string>
#include <filesystem>

void listFiles(std::string path)
{
    for (auto& dirEntry: std::filesystem::recursive_directory_iterator(path)) {
        if (!dirEntry.is_regular_file()) {
            std::cout << "Directory: " << dirEntry.path() << std::endl;
            continue;
        }
        std::filesystem::path file = dirEntry.path();
        std::cout << "Filename: " << file.filename() << " extension: " << file.extension() << std::endl;

    }
}

int main()
{
    listFiles("./");
    return 0;
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-09-15T21:48:21.833

你没有。C++ 标准没有目录的概念。将字符串转换为文件句柄取决于实现。该字符串的内容及其映射的内容取决于操作系统。请记住，C++ 可用于编写该操作系统，因此它可以在尚未定义询问如何迭代目录的级别上使用（因为您正在编写目录管理代码）。

查看您的操作系统 API 文档以了解如何执行此操作。如果您需要便携，则必须为各种操作系统提供一堆[#ifdef](https://en.wikipedia.org/wiki/C_preprocessor#Conditional_compilation)。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-15T21:42:41.863

您需要为文件系统遍历调用特定于操作系统的函数，例如`open()`和`readdir()`. C 标准没有指定任何与文件系统相关的函数。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-15T21:47:25.207

你没有。标准 C++ 不暴露目录的概念。具体来说，它没有提供任何方法来列出目录中的所有文件。

一个可怕的 hack 是使用 system() 调用并解析结果。最合理的解决方案是使用某种跨平台库，例如[Qt](https://en.wikipedia.org/wiki/Qt_%28software%29)甚至[POSIX](http://en.wikipedia.org/wiki/POSIX)。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-10-20T10:56:25.730

在 C++17 上，您可以通过以下方式：

```
#include <filesystem>
#include <iostream>
#include <vector>
namespace fs = std::filesystem;

int main()
{
    std::ios_base::sync_with_stdio(false);
    for (const auto &entry : fs::recursive_directory_iterator(".")) {
        if (entry.path().extension() == ".png") {
            std::cout << entry.path().string() << std::endl;

        }
    }
    return 0;
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-05-17T15:34:41.383

如果您使用的是 Windows，则可以将 FindFirstFile 与 FindNextFile API 一起使用。您可以使用 FindFileData.dwFileAttributes 检查给定路径是文件还是目录。如果它是一个目录，您可以递归地重复该算法。

在这里，我整理了一些代码，列出了 Windows 机器上的所有文件。

[http://dreams-soft.com/projects/traverse-directory](http://dreams-soft.com/projects/traverse-directory)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-21T02:25:59.917

文件树遍历`ftw`是一种递归方式，可以将整个目录树挂在路径中。更多细节在[这里](https://linux.die.net/man/3/ftw)。

注意：您也可以使用`fts`它可以跳过隐藏文件，如`.`or`..`或`.bashrc`

```
#include <ftw.h>
#include <stdio.h>
#include <sys/stat.h>
#include <string.h>

int list(const char *name, const struct stat *status, int type)
{
     if (type == FTW_NS)
     {
         return 0;
     }

     if (type == FTW_F)
     {
         printf("0%3o\t%s\n", status->st_mode&0777, name);
     }

     if (type == FTW_D && strcmp(".", name) != 0)
     {
         printf("0%3o\t%s/\n", status->st_mode&0777, name);
     }
     return 0;
}

int main(int argc, char *argv[])
{
     if(argc == 1)
     {
         ftw(".", list, 1);
     }
     else
     {
         ftw(argv[1], list, 1);
     }

     return 0;
} 
```

输出如下所示：

```
0755    ./Shivaji/
0644    ./Shivaji/20200516_204454.png
0644    ./Shivaji/20200527_160408.png
0644    ./Shivaji/20200527_160352.png
0644    ./Shivaji/20200520_174754.png
0644    ./Shivaji/20200520_180103.png
0755    ./Saif/
0644    ./Saif/Snapchat-1751229005.jpg
0644    ./Saif/Snapchat-1356123194.jpg
0644    ./Saif/Snapchat-613911286.jpg
0644    ./Saif/Snapchat-107742096.jpg
0755    ./Milind/
0644    ./Milind/IMG_1828.JPG
0644    ./Milind/IMG_1839.JPG
0644    ./Milind/IMG_1825.JPG
0644    ./Milind/IMG_1831.JPG
0644    ./Milind/IMG_1840.JPG 
```

假设您要匹配文件名（例如：搜索所有`*.jpg, *.jpeg, *.png`文件。）以满足特定需求，请使用`fnmatch`.

```
 #include <ftw.h>
 #include <stdio.h>
 #include <sys/stat.h>
 #include <iostream>
 #include <fnmatch.h>

 static const char *filters[] = {
     "*.jpg", "*.jpeg", "*.png"
 };

 int list(const char *name, const struct stat *status, int type)
 {
     if (type == FTW_NS)
     {
         return 0;
     }

     if (type == FTW_F)
     {
         int i;
         for (i = 0; i < sizeof(filters) / sizeof(filters[0]); i++) {
             /* if the filename matches the filter, */
             if (fnmatch(filters[i], name, FNM_CASEFOLD) == 0) {
                 printf("0%3o\t%s\n", status->st_mode&0777, name);
                 break;
             }
         }
     }

     if (type == FTW_D && strcmp(".", name) != 0)
     {
         //printf("0%3o\t%s/\n", status->st_mode&0777, name);
     }
     return 0;
 }

 int main(int argc, char *argv[])
 {
     if(argc == 1)
     {
         ftw(".", list, 1);
     }
     else
     {
         ftw(argv[1], list, 1);
     }

     return 0;
 } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-12-01T12:47:13.583

使用 C++11 for Windows 和 Linux(with `experimental/filesystem`) 递归获取所有文件名的答案：
对于 Windows：

```
#include <io.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <windows.h>
void getFiles_w(string path, vector<string>& files) {
    intptr_t hFile = 0; 
    struct _finddata_t fileinfo;  
    string p; 
    if ((hFile = _findfirst(p.assign(path).append("\\*").c_str(), &fileinfo)) != -1) {
        do {
            if ((fileinfo.attrib & _A_SUBDIR)) {
                if (strcmp(fileinfo.name, ".") != 0 && strcmp(fileinfo.name, "..") != 0)
                    getFiles(p.assign(path).append("/").append(fileinfo.name), files);
            }
            else {
                files.push_back(p.assign(path).append("/").append(fileinfo.name));
            }
        } while (_findnext(hFile, &fileinfo) == 0);
    }
} 
```

对于 Linux：

```
#include <experimental/filesystem>
bool getFiles(std::experimental::filesystem::path path, vector<string>& filenames) {
    namespace stdfs = std::experimental::filesystem;
    // http://en.cppreference.com/w/cpp/experimental/fs/directory_iterator
    const stdfs::directory_iterator end{} ;

    for (stdfs::directory_iterator iter{path}; iter != end ; ++iter) {
        // http://en.cppreference.com/w/cpp/experimental/fs/is_regular_file 
        if (!stdfs::is_regular_file(*iter)) { // comment out if all names (names of directories tc.) are required 
            if (getFiles(iter->path(), filenames)) 
                return true;
        }
        else {
            filenames.push_back(iter->path().string()) ;
            cout << iter->path().string() << endl;  
        }
    }
    return false;
} 
```

请记住在 Linux 中`-lstdc++fs`编译时链接。`g++`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-03-18T09:08:39.250

员工 Visual C++ 和 WIN API：

```
bool Parser::queryDIR(string dir_name) {
    vector<string> sameLayerFiles;
    bool ret = false;
    string dir = "";
    //employee wide char
    dir = dir_name  + "\\*.*";;
    //employee WIN File API
    WIN32_FIND_DATA  fd;
    WIN32_FIND_DATA  fd_dir;
    HANDLE hFind = ::FindFirstFile(getWC(dir.c_str()), &fd);
    HANDLE hFind_dir = ::FindFirstFile(getWC(dir.c_str()), &fd_dir);
    string str_subdir;
    string str_tmp;
    //recursive call for diving into sub-directories
    do {
        if ((fd_dir.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY) ) {
            //ignore trival file node
            while(true) {
                FindNextFile(hFind_dir, &fd_dir);
                str_tmp = wc2str(fd_dir.cFileName);
                if (str_tmp.compare(".") && str_tmp.compare("..")){
                    break;
                }
            }
            if ((fd_dir.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY) ) {
                str_subdir = wc2str(fd_dir.cFileName);
                ret = queryDIR(dir_name + "\\" + str_subdir);
            }
        }
    } while(::FindNextFile(hFind_dir, &fd_dir));

    //iterate same layer files
    do { 
        if (!(fd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)) {
            str_tmp = wc2str(fd.cFileName);
            string fname = dir_name + "\\" + str_tmp;
            sameLayerFiles.push_back(fname);
        }
    } while(::FindNextFile(hFind, &fd));    

    for (std::vector<string>::iterator it=sameLayerFiles.begin(); it!=sameLayerFiles.end(); it++) {
        std::cout << "iterated file:" << *it << "..." << std::endl;
        //Doing something with every file here
    }
    return true;   
} 
```

希望我的代码可以帮助:)

[您可以在My GitHub 上](https://github.com/MouChiaHung/Grep)查看更多详细信息和程序屏幕截图

# java - 从 ZipInputStream 读取到 ByteArrayOutputStream

> ID：67275
> 
> 赞同：20
> 
> 时间：2008-09-15T21:41:21.460
> 
> 标签：java, zipinputstream, zipoutputstream

我正在尝试从 a 读取单个文件`java.util.zip.ZipInputStream`，并将其复制到 a`java.io.ByteArrayOutputStream`中（这样我就可以创建 a`java.io.ByteArrayInputStream`并将其交给最终关闭流的 3rd 方库，我不希望我`ZipInputStream`被关闭） .

我可能在这里遗漏了一些基本的东西，但我从来没有在这里进入 while 循环：

```
ByteArrayOutputStream streamBuilder = new ByteArrayOutputStream();
int bytesRead;
byte[] tempBuffer = new byte[8192*2];
try {
    while ((bytesRead = zipStream.read(tempBuffer)) != -1) {
        streamBuilder.write(tempBuffer, 0, bytesRead);
    }
} catch (IOException e) {
    // ...
} 
```

我错过了什么可以让我复制流？

**编辑：**

我之前应该提到这`ZipInputStream`不是来自文件，所以我认为我不能使用`ZipFile`. 它来自通过 servlet 上传的文件。

另外，我已经在访问这段代码之前调用`getNextEntry()`过。`ZipInputStream`如果我不尝试将文件复制到另一个`InputStream`（通过`OutputStream`上面提到的），而只是传递`ZipInputStream`给我的第 3 方库，库将关闭流，我不能再做任何事情，比如处理剩余的文件流。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-16T04:54:35.400

您的循环看起来有效 - 以下代码（仅靠它自己）返回什么？

```
zipStream.read(tempBuffer) 
```

如果它返回 -1，那么 zipStream 在你得到它之前就关闭了，所有的赌注都被关闭了。是时候使用您的调试器并确保传递给您的内容实际上是有效的。

当您调用 getNextEntry() 时，它是否返回一个值，条目中的数据是否有意义（即 getCompressedSize() 是否返回一个有效值）？如果您只是在阅读没有嵌入预读 zip 条目的 Zip 文件，那么 ZipInputStream 将不适合您。

关于 Zip 格式的一些有用的花絮：

嵌入在 zip 文件中的每个文件都有一个标题。此标头可以包含有用的信息（例如流的压缩长度、文件中的偏移量、CRC） - 或者它可以包含一些魔术值，基本上说“信息不在流标头中，您必须检查邮编后序”。

然后，每个 zip 文件都有一个附加到文件末尾的表，其中包含所有 zip 条目以及真实数据。最后的表格是强制性的，其中的值必须是正确的。相反，不必提供嵌入在流中的值。

如果您使用 ZipFile，它会读取 zip 末尾的表格。如果您使用 ZipInputStream，我怀疑 getNextEntry() 会尝试使用嵌入在流中的条目。如果未指定这些值，则 ZipInputStream 不知道流可能有多长。膨胀算法是自终止的（实际上你不需要知道输出流的未压缩长度来完全恢复输出），但是这个阅读器的 Java 版本可能不能很好地处理这种情况。

我会说让 servlet 返回 ZipInputStream 是相当不寻常的（如果要接收压缩内容，接收 inflatorInputStream 更为常见。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-15T22:47:11.380

您可能尝试过阅读`FileInputStream`这样的内容：

```
ZipInputStream in = new ZipInputStream(new FileInputStream(...));
```

这**不起作用**，因为 zip 存档可以包含多个文件，并且您需要指定要读取的文件。

您可以使用[java.util.zip.ZipFile](https://docs.oracle.com/javase/8/docs/api/java/util/zip/ZipFile.html)和库，例如[来自 Apache Commons IO 的 IOUtils](https://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/IOUtils.html)或[来自 Guava](https://google.github.io/guava/releases/21.0/api/docs/com/google/common/io/ByteStreams.html)的 ByteStreams 来帮助您复制流。

例子：

```
ByteArrayOutputStream out = new ByteArrayOutputStream();
try (ZipFile zipFile = new ZipFile("foo.zip")) {
    ZipEntry zipEntry = zipFile.getEntry("fileInTheZip.txt");

    try (InputStream in = zipFile.getInputStream(zipEntry)) {
        IOUtils.copy(in, out);
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T21:56:02.283

我会使用来自 commons io 项目的[IOUtils 。](http://commons.apache.org/io/api-release/org/apache/commons/io/IOUtils.html)

```
IOUtils.copy(zipStream, byteArrayOutputStream); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-03T18:44:01.020

你错过了电话

ZipEntry 条目 = (ZipEntry) zipStream.getNextEntry();

定位第一个条目的第一个解压缩字节。

```
 ByteArrayOutputStream streamBuilder = new ByteArrayOutputStream();
 int bytesRead;
 byte[] tempBuffer = new byte[8192*2];
 ZipEntry entry = (ZipEntry) zipStream.getNextEntry();
 try {
     while ( (bytesRead = zipStream.read(tempBuffer)) != -1 ){
        streamBuilder.write(tempBuffer, 0, bytesRead);
     }
 } catch (IOException e) {
      ...
 } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-16T03:31:48.343

您可以在忽略 close() 的 ZipInputStream 周围实现自己的包装器，并将其交给第三方库。

```
thirdPartyLib.handleZipData(new CloseIgnoringInputStream(zipStream));

class CloseIgnoringInputStream extends InputStream
{
    private ZipInputStream stream;

    public CloseIgnoringInputStream(ZipInputStream inStream)
    {
        stream = inStream;
    }

    public int read() throws IOException {
        return stream.read();
    }

    public void close()
    {
        //ignore
    }

    public void reallyClose() throws IOException
    {
        stream.close();
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T00:19:01.020

我会在 ZipInputStream 上调用 getNextEntry() ，直到它位于您想要的条目处（使用 ZipEntry.getName() 等）。调用 getNextEntry() 会将“光标”前进到它返回的条目的开头。然后，使用 ZipEntry.getSize() 来确定您应该使用 zipInputStream.read() 读取多少字节。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T21:53:13.553

目前尚不清楚您是如何获得 zipStream 的。当你像这样得到它时它应该可以工作：

```
 zipStream = zipFile.getInputStream(zipEntry) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T22:56:16.260

t 不清楚您是如何获得 zipStream 的。当你像这样得到它时它应该可以工作：

```
 zipStream = zipFile.getInputStream(zipEntry) 
```

如果您从 ZipFile 获取 ZipInputStream，您可以为 3d 派对库获取一个流，让它使用它，然后使用之前的代码获取另一个输入流。

请记住，输入流是一个游标。如果您有整个数据（如 ZipFile），您可以在其上请求 N 个光标。

一种不同的情况是，如果您只有一个“GZip”输入流，只有一个压缩字节流。在这种情况下，您的 ByteArrayOutputStream 缓冲区是有意义的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-19T11:49:11.417

请尝试以下代码

```
private static byte[] getZipArchiveContent(File zipName) throws WorkflowServiceBusinessException {

  BufferedInputStream buffer = null;
  FileInputStream fileStream = null;
  ByteArrayOutputStream byteOut = null;
  byte data[] = new byte[BUFFER];

  try {
   try {
    fileStream = new FileInputStream(zipName);
    buffer = new BufferedInputStream(fileStream);
    byteOut = new ByteArrayOutputStream();

    int count;
    while((count = buffer.read(data, 0, BUFFER)) != -1) {
     byteOut.write(data, 0, count);
    }
   } catch(Exception e) {
    throw new WorkflowServiceBusinessException(e.getMessage(), e);
   } finally {
    if(null != fileStream) {
     fileStream.close();
    }
    if(null != buffer) {
     buffer.close();
    }
    if(null != byteOut) {
     byteOut.close();
    }
   }
  } catch(Exception e) {
   throw new WorkflowServiceBusinessException(e.getMessage(), e);
  }
  return byteOut.toByteArray();

 } 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-15T21:51:43.357

检查输入流是否位于乞求中。

否则，作为实现：我认为您在阅读时不需要写入结果流，除非您在另一个线程中处理这个确切的流。

只需创建一个字节数组，读取输入流，然后创建输出流。

# unit-testing - 单元测试值得努力吗？

> ID：67299
> 
> 赞同：572
> 
> 时间：2008-09-15T21:44:00.410
> 
> 标签：unit-testing

我正在努力将单元测试集成到我所在团队的开发过程中，并且有一些怀疑论者。有什么好方法可以让团队中持怀疑态度的开发人员相信单元测试的价值？在我的具体情况下，我们将在添加功能或修复错误时添加单元测试。不幸的是，我们的代码库不适合简单的测试。

* * *

## 回答 #1

> 赞同：722
> 
> 时间：2008-09-15T22:06:22.743

我们办公室每天都有这样的交流：

> “伙计，我只是喜欢单元测试，我刚刚能够对某些工作的方式进行大量更改，然后能够通过再次运行测试来确认我没有破坏任何东西......”

细节每天都在变化，但情绪不会。单元测试和测试驱动开发 (TDD) 有很多隐藏的和个人的好处，也有很多显而易见的好处，除非他们自己做，否则你无法真正向他们解释。

但是，忽略这一点，这是我的尝试！

1.  单元测试允许您快速对代码进行重大更改。你知道它现在可以工作了，因为你已经运行了测试，当你做出你需要做的改变时，你需要让测试再次工作。这可以节省几个小时。

2.  TDD 帮助您了解何时停止编码。您的测试让您确信您现在已经完成了足够多的工作，并且可以停止调整并继续下一步。

3.  测试和代码协同工作以实现更好的代码。您的代码可能不好/有问题。你的测试可能是坏的/错误的。在 TDD 中，您寄希望于坏/错误的可能性**都**较低。通常是需要修复的测试，但这仍然是一个很好的结果。

4.  TDD 有助于编码便秘。当面临一项庞大而艰巨的工作时，编写测试将使您快速前进。

5.  单元测试可以帮助你真正理解你正在处理的代码的设计。您无需编写代码来做某事，而是首先概述您使代码受到的所有条件以及您期望从中得到什么输出。

6.  单元测试给你即时的视觉反馈，当我们完成后，我们都喜欢那些绿灯的感觉。这是非常令人满意的。在中断后从中断的地方重新开始也容易得多，因为你可以看到你到达的地方——下一个需要修复的红灯。

7.  与流行的看法相反，单元测试并不意味着编写两倍的代码，或者编写更慢的代码。一旦掌握了窍门，它就会比没有测试的编码更快、更健壮。测试代码本身通常是相对微不足道的，不会给你正在做的事情增加很大的开销。这是你只有在做的时候才会相信的：）

8.  我认为是 Fowler 说的：“经常运行的不完美测试比从未编写过的完美测试要好得多”。我将此解释为允许我在我认为它们最有用的地方编写测试，即使我的其余代码覆盖范围非常不完整。

9.  好的单元测试可以帮助记录和定义应该做什么

10.  单元测试有助于代码重用。将您的代码**和**测试迁移到您的新项目。调整代码直到测试再次运行。

我参与的很多工作都不能很好地进行单元测试（Web 应用程序用户交互等），但即便如此，我们都在这家商店中被测试感染，当我们完成测试时最开心。我不能高度推荐这种方法。

* * *

## 回答 #2

> 赞同：420
> 
> 时间：2008-09-16T03:53:18.493

**单元测试很像去健身房。** 你知道这对你有好处，所有的论点都有道理，所以你开始锻炼。有一个最初的匆忙，这很好，但几天后你开始怀疑这是否值得麻烦。你每天要花一个小时换衣服，在仓鼠轮上奔跑，但除了腿和手臂酸痛之外，你不确定自己是否真的得到了什么。

然后，大概一两周后，就在疼痛消失的时候，一个大截止日期开始临近。你需要在醒着的每个小时都努力完成“有用的”工作，所以你要减少无关的事情，比如去健身房。你养成了习惯，当大截止日期结束时，你又回到了原点。如果你设法回到健身房，你会感觉和第一次去时一样酸痛。

你做一些阅读，看看你是否做错了什么。你开始对所有赞美锻炼美德的健康快乐的人产生一点非理性的怨恨。你意识到你们没有很多共同点。他们不必开车 15 分钟就可以去健身房；他们的大楼里有一个。他们不必与任何人争论锻炼的好处；这只是每个人都会做和接受的重要事情。当大截止日期临近时，他们不会被告知锻炼是不必要的，就像你的老板会要求你停止进食一样。

**因此，为了回答您的问题，单元测试通常值得付出努力，但每个人所需的努力程度并不相同。** 如果您在一家*实际上并不*重视代码质量的公司处理意大利面条式代码库，则单元测试可能需要付出巨大的努力。（很多经理会歌颂单元测试，但这并不意味着他们会在重要的时候坚持下去。）

如果您尝试将单元测试引入您的工作，但没有看到您所期望的所有阳光和彩虹，请不要责怪自己。您可能需要找到一份新工作才能真正让单元测试为您工作。

* * *

## 回答 #3

> 赞同：136
> 
> 时间：2008-09-15T21:48:06.827

说服的最佳方法...找到一个错误，为它编写一个单元测试，修复错误。

该特定错误不太可能再次出现，您可以通过测试证明这一点。

如果你做到这一点，其他人会很快赶上。

* * *

## 回答 #4

> 赞同：69
> 
> 时间：2008-09-16T07:02:52.470

> 会说话的核桃问道：
> 
> > 有什么好方法可以让团队中持怀疑态度的开发人员相信单元测试的价值？

这里的每个人都会突然想出很多为什么单元测试是好的原因。然而，我发现说服某人某事的最佳方式通常是*倾听*他们的论点并逐点解决。如果你倾听并帮助他们表达他们的担忧，你可以解决每一个问题，并可能将它们转化为你的观点（或者至少让他们没有立足之地）。*谁知道？也许他们会说服你为什么单元测试不适合你的情况。*不太可能，但可能。也许如果你发表他们反对单元测试的论点，我们可以帮助确定反对论点。

倾听和理解争论的双方很重要。如果您尝试过分热心地采用单元测试而不考虑人们的担忧，那么您最终会引发一场宗教战争（并且可能真的毫无价值的单元测试）。如果您慢慢采用它并开始将其应用到您会以最少的成本获得最大收益的地方，您可能能够展示单元测试的价值并有更好的机会说服人们。我意识到这并不像听起来那么容易——它通常需要一些时间和仔细的指标来制定一个令人信服的论点。

单元测试和其他任何工具一样，都是一种工具，并且应该以收益（捕获错误）超过成本（编写它们的努力）的方式应用。如果/在没有意义的情况下不要使用它们，并记住它们只是您工具库的一部分（例如检查、断言、代码分析器、形式方法等）。我告诉我的开发人员是这样的：

1.  他们可以跳过为方法编写测试，如果他们有充分的理由说明为什么不需要（例如太简单不值得或太难不值得）以及如何验证该方法（例如检查、断言、形式化方法、交互/集成测试）。他们需要考虑到一些验证，如检查和形式证明是在某个时间点完成的，然后每次生产代码更改时都需要重复，而单元测试和断言可以用作回归测试（编写一次，之后重复执行） ）。有时我同意他们的观点，但更多时候我会争论一个方法是否真的太简单或太难进行单元测试。

    *   如果开发人员认为一个方法似乎太简单而不会失败，那么花 60 秒时间为它编写一个简单的 5 行单元测试难道不值得吗？这 5 行代码将在接下来的一年或更长时间内每晚运行（你每晚都进行构建，对吗？），即使只是碰巧遇到可能需要 15 分钟或更长时间才能识别的问题，这也是值得的和调试。此外，编写简单的单元测试会增加单元测试的数量，这使开发人员看起来不错。

    *   另一方面，如果开发人员认为一个方法似乎太难以进行单元测试（不值得付出大量的努力），那么这可能是一个很好的迹象，表明该方法需要被分割或重构以测试简单的部分。通常，这些方法依赖于不寻常的资源，如单例、当前时间或外部资源（如数据库结果集）。这些方法通常需要重构为获取资源的方法（例如调用getTime()）和以资源为参数的方法（例如以时间戳为参数）。我让他们跳过测试检索资源的方法，而是为现在将资源作为参数的方法编写单元测试。通常，这会使编写单元测试更加简单，因此值得编写。

2.  开发人员需要在其单元测试的全面性上划清界限。在开发后期，每当我们发现一个错误时，他们应该确定是否更全面的单元测试会发现问题。如果是这样并且如果此类错误反复出现，他们需要将“路线”移到将来编写更全面的单元测试（从添加或扩展当前错误的单元测试开始）。他们需要找到正确的平衡点。

重要的是要意识到单元测试不是灵丹妙药，并且存在过多的单元测试之类的东西*。*在我的工作场所，每当我们吸取教训时，我不可避免地会听到“我们需要编写更多的单元测试”。管理层点头表示同意，因为“单元测试”==“好”已经被他们击中了。

但是，我们需要了解“更多单元测试”的影响。开发人员每周只能编写约 N 行代码，您需要弄清楚该代码中单元测试代码与生产代码的百分比。一个松散的工作场所可能有 10% 的代码作为单元测试，90% 的代码作为生产代码，导致产品具有很多（尽管非常错误）特性（想想 MS Word）。另一方面，拥有 90% 的单元测试和 10% 的生产代码的严格商店将拥有具有极少特性的坚如磐石的产品（想想“vi”）。您可能永远不会听到有关后者产品崩溃的报告，但这可能与产品销售不佳有关，与代码质量有关。

更糟糕的是，也许软件开发中唯一可以确定的是“变化是不可避免的”。假设严格车间（90% 的单元测试/10% 的生产代码）创建的产品恰好具有 2 个功能（假设 5% 的生产代码 == 1 个功能）。如果客户出现并更改其中一项功能，那么该更改会破坏 50% 的代码（45% 的单元测试和 5% 的生产代码）。宽松的车间（10% 的单元测试/90% 的生产代码）有一个产品有 18 个特性，但没有一个能很好地工作。他们的客户完全修改了对 4 个功能的要求。尽管变化是原来的 4 倍，但只有一半的代码库被丢弃（~25% = ~4.4% 单元测试 + 20% 的生产代码）。

我的观点是你必须传达你理解单元测试太少和太多之间的平衡——本质上你已经考虑了问题的两个方面。如果你能说服你的同行和/或你的管理层，你就会获得可信度，也许更有机会赢得他们的支持。

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2009-07-08T11:19:57.627

我曾多次玩过单元测试，但鉴于我的情况，我仍然相信这是值得的。

我开发网站，其中大部分逻辑涉及在数据库中创建、检索或更新数据。当我试图“模拟”数据库以进行单元测试时，它变得非常混乱，似乎有点毫无意义。

当我围绕业务逻辑编写单元测试时，从长远来看，它从来没有真正帮助过我。因为我主要是独自处理项目，所以我倾向于直观地知道哪些代码区域可能会受到我正在处理的事情的影响，并且我会手动测试这些区域。我想尽快为我的客户提供解决方案，而单元测试通常看起来是在浪费时间。我列出手动测试并亲自完成它们，边走边打勾。

我可以看到，当一组开发人员在一个项目上工作并相互更新代码时，这可能是有益的，但即便如此，我认为如果开发人员素质很高，良好的沟通和编写良好的代码通常就足够了.

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2008-09-15T21:46:25.473

单元测试的一大优点是它们可以作为您的代码行为方式的文档。好的测试有点像参考实现，团队成员可以查看它们以了解如何将他们的代码与您的代码集成。

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2008-09-15T22:15:30.287

单元测试非常值得初始投资。自从几年前开始使用单元测试以来，我发现了一些真正的好处：

*   **回归测试**消除了对代码更改的恐惧（没有什么比每次更改时看到代码工作或爆炸的温暖光芒）
*   **其他团队成员的可执行代码示例**（以及六个月后的您自己..）
*   ***无情*的重构**——这是令人难以置信的回报，试试吧！

代码片段可以极大地帮助减少创建测试的开销。创建能够在几秒钟内创建类大纲和关联的单元测试夹具的片段并不难。

* * *

## 回答 #8

> 赞同：25
> 
> 时间：2008-09-15T23:32:32.427

你应该尽可能少地测试！

意思是，您应该编写足够的单元测试来揭示意图。这经常被掩盖。单元测试会让你付出代价。如果您进行更改并且必须更改测试，那么您将变得不那么敏捷。保持单元测试简短而甜蜜。然后他们有很多价值。

我经常看到很多测试永远不会失败，又大又笨，而且没有提供很多价值，它们最终只会拖慢你的速度。

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2009-02-10T00:21:56.377

我在其他任何答案中都没有看到这一点，但我注意到的一件事是**我可以调试得更快**。您无需通过正确的步骤顺序深入了解您的应用程序来获取您修复的代码，只是发现您犯了一个布尔错误并且需要再次执行所有操作。通过单元测试，您可以直接进入正在调试的代码。

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2009-08-19T15:12:26.787

[我有一点我在上面看不到]

“每个人都进行单元测试，他们不一定意识到 - 事实”

想一想，您编写了一个函数来解析字符串并删除换行符。作为新手开发人员，您可以通过在 Main() 中实现它从命令行运行一些案例，或者您将可视化前端与按钮组合在一起，将您的函数绑定到几个文本框和一个按钮，然后查看发生什么了。

那是单元测试——基本的和糟糕的组合，但是你在少数情况下测试了一段代码。

你写一些更复杂的东西。当您通过（单元测试）抛出一些案例并且您调试代码和跟踪时，它会抛出错误。您在经历时会查看价值观并决定它们是对还是错。这在某种程度上是单元测试。

这里的单元测试实际上是采用这种行为，将其形式化为结构化模式并保存它，以便您可以轻松地重新运行这些测试。如果您编写一个“正确的”单元测试用例而不是手动测试，它会花费相同的时间，或者可能会随着您的经验而减少，并且您可以一次又一次地重复它

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2008-09-16T01:32:10.550

多年来，我一直试图说服人们他们需要为他们的代码编写单元测试。无论他们是先编写测试（如在 TDD 中）还是在编写功能后，我总是试图向他们解释对代码进行单元测试的所有好处。几乎没有人不同意我的观点。你不能不同意显而易见的事情，任何聪明的人都会看到单元测试和 TDD 的好处。

单元测试的问题在于它需要改变行为，而且很难改变人们的行为。用文字，你会得到很多人的认同，但你不会看到他们做事的方式有很多变化。

你必须通过做来说服人们。你的个人成功将比你可能拥有的所有论点吸引更多的人。如果他们看到你不只是在谈论单元测试或 TDD，而是在做你所宣扬的事情，并且你成功了，人们会试图模仿你。

您还应该担任领导角色，因为没有人第一次就正确地编写单元测试，因此您可能需要指导他们如何去做，向他们展示方法以及可供他们使用的工具。在他们编写第一个测试时帮助他们，审查他们自己编写的测试，并向他们展示您通过自己的经验学到的技巧、习语和模式。一段时间后，他们会开始自己看到好处，他们会改变自己的行为，将单元测试或 TDD 合并到他们的工具箱中。

改变不会在一夜之间发生，但只要有一点耐心，你就可以实现你的目标。

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2008-09-15T21:50:11.377

经常被忽略的测试驱动开发的主要部分是编写可测试的代码。起初这似乎是某种妥协，但您会发现可测试代码最终也是模块化、可维护和可读的。如果您仍然需要说服他人的帮助[，这](http://www.masukomi.org/talks/unit_testing_talk_2/index.xul?data=slide_data.txt#page1)是一个关于单元测试优势的简单介绍。

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2008-09-15T21:59:01.387

如果您现有的代码库不适合进行单元测试，并且它已经投入生产，那么您可能会通过尝试重构所有代码以使其可进行单元测试来解决比您解决的问题更多的问题。

您最好还是努力改进集成测试。有很多代码在没有单元测试的情况下编写起来更简单，如果 QA 可以根据需求文档验证功能，那么你就完成了。装运它。

在我看来，这方面的经典示例是嵌入在链接到 GridView 的 ASPX 页面中的 SqlDataReader。代码都在 ASPX 文件中。SQL 在存储过程中。你单元测试什么？如果页面做了它应该做的事情，你真的应该把它重新设计成几个层，这样你就有了自动化的东西吗？

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2008-09-15T21:59:03.167

关于单元测试的最好的事情之一是你的代码在你做的时候会变得更容易测试。在没有测试的情况下创建的预先存在的代码总是一个挑战，因为因为它们不是要进行单元测试的，所以在类之间存在高度耦合、类内难以配置的对象的情况并不少见 - 就像一封电子邮件发送服务参考 - 等等。但不要让这让你失望！当您开始编写单元测试时，您会发现您的整体代码设计会变得更好，并且您测试的越多，您就越有信心对其进行更多更改，而不必担心破坏您的应用程序或引入错误.

对代码进行单元测试有几个原因，但随着时间的推移，您会发​​现在测试上节省的时间是最好的理由之一。在我刚刚交付的一个系统中，我坚持进行自动化单元测试，尽管有人声称我在测试上花费的时间比手动测试系统要多得多。完成所有单元测试后，我在不到 10 分钟的时间内运行了 400 多个测试用例，每次我必须对代码做一点小改动时，我只需要 10 次就可以确保代码仍然可以正常工作且没有错误分钟。您能想象手动运行这 400 多个测试用例所花费的时间吗？

当谈到自动化测试时——无论是单元测试还是验收测试——每个人都认为编写你可以手动执行的代码是一种浪费，有时这是真的——如果你打算只运行一次测试。自动化测试最好的部分是你可以毫不费力地多次运行它们，而在第二次或第三次运行之后，你所*浪费*的时间和精力就已经得到了回报。

最后一条建议是不仅要对您的代码进行单元测试，而且要先开始进行测试（有关更多信息，请参阅[TDD](http://en.wikipedia.org/wiki/Test-driven_development)和[BDD](http://en.wikipedia.org/wiki/Behavior_driven_development)）

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2008-09-15T21:59:34.630

在重构或重写一段代码时，单元测试也特别有用。如果你有很好的单元测试覆盖率，你可以自信地重构。如果没有单元测试，通常很难确保您没有破坏任何东西。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2008-09-15T22:27:34.830

简而言之 - 是的。他们值得每一盎司的努力......在一定程度上。最终，测试仍然是代码，并且与典型的代码增长非常相似，您的测试最终将需要重构以保持可维护性和可持续性。有一吨的GOTCHAS！当谈到单元测试时，但是 man oh man oh man，什么都没有，我的意思是没有什么比一组丰富的单元测试更能让开发人员更自信地进行更改。

我现在正在做一个项目……它有点 TDD，我们将大部分业务规则封装为测试……我们现在有大约 500 个左右的单元测试。在过去的迭代中，我不得不修改我们的数据源以及我们的桌面应用程序与该数据源的接口方式。花了我几天的时间，我一直在运行单元测试，看看我破坏了什么并修复了它。做出改变; 构建并运行您的测试；修复你破坏的东西。洗涤，冲洗，必要时重复。传统上需要几天的质量保证和大量的压力，而不是短暂而愉快的体验。

提前做好准备，付出一点额外的努力，然后当你必须开始使用核心特性/功能时，它会付出 10 倍的代价。

我买了这本书——它是 xUnit 测试知识的圣经——这可能是我书架上被引用最多的书之一，我每天都在查阅它： [link text](https://rads.stackoverflow.com/amzn/click/com/0131495054 "xUnit 测试模式")

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2008-09-16T05:11:35.980

有时，我自己或我的一位同事会花费几个小时来找出稍微晦涩的错误，一旦找到错误的原因，90% 的代码都没有经过单元测试。单元测试不存在，因为开发人员正在偷工减料以节省时间，但随后失去了这个和更多的调试。

花少量时间编写单元测试可以节省未来数小时的调试时间。

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2009-07-20T15:39:01.580

我是一名维护工程师，负责一个文档记录不佳、糟糕且庞大的代码库。我希望编写代码的人已经为它编写了单元测试。
每次我进行更改并更新生产代码时，我都害怕我可能会因为没有考虑某些条件而引入错误。
如果他们编写测试，对代码库进行更改会更容易和更快。（同时代码库将处于更好的状态）..

我认为单元测试在编写必须持续多年并由原始编码人员以外的人使用/修改/发展的 API 或框架时证明是非常有用的。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2008-09-15T21:59:49.450

单元测试绝对值得付出努力。不幸的是，您选择了一个困难的（但不幸的是常见的）场景来实现它。

您将从单元测试中获得的最大好处是从头开始使用它 - 在一些精选的小型项目中，我很幸运地在实现我的类之前编写了单元测试（接口已经完成了观点）。通过适当的单元测试，您将发现并修复类中的错误，而它们仍处于起步阶段，而不是靠近复杂系统的任何地方，它们无疑将在未来集成到其中。

如果您的软件完全是面向对象的，那么您应该能够在类级别添加单元测试而无需太多努力。如果你没有那么幸运，你仍然应该尽可能地尝试结合单元测试。确保当您添加新功能时，新的部分定义明确，界面清晰，您会发现单元测试让您的生活变得更加轻松。

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2008-09-16T00:55:06.380

当您说“我们的代码库不适合轻松测试”时，这是代码异味的第一个迹象。编写单元测试意味着您通常会以不同的方式编写代码，以使代码更具可测试性。在我看来，这是一件好事，因为多年来我在编写必须为其编写测试的代码时所看到的，它迫使我提出更好的设计。

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2010-05-21T00:25:32.710

我不知道。很多地方不做单元测试，但是代码质量不错。微软做单元测试，但比尔盖茨在他的演讲中给出了一个蓝屏。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2010-10-01T15:28:04.143

我写了一篇关于这个主题的非常大的博客文章。我发现单靠单元测试是不值得的工作，并且通常在截止日期临近时被削减。

与其从“test-after”验证的角度讨论单元测试，我们应该着眼于在实施之前着手编写规范/测试/想法时发现的真正价值。

这个简单的想法改变了我编写软件的方式，我不会回到“旧”的方式。

[测试优先开发如何改变了我的生活](http://toranbillups.com/blog/archive/2010/04/22/How-test-first-development-changed-my-life/)

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-09-15T23:46:59.553

是的 - 单元测试绝对值得付出努力，但你应该知道它不是灵丹妙药。单元测试是一项工作，您必须努力使测试保持更新并随着代码更改而保持相关性，但所提供的价值值得您付出努力。不受惩罚地重构的能力是一个巨大的好处，因为您始终可以验证功能通过在任何更改代码后运行测试。诀窍是不要过于关注您正在测试的工作单元或您如何构建测试需求以及单元测试何时真的是功能测试等。人们会为这些东西争论几个小时最后，现实情况是，您在编写代码时进行的任何测试都比不这样做要好。另一个公理是关于质量而不是数量 - 我见过 1000' 的代码库 s 的测试基本上没有意义，因为其余的测试并没有真正测试任何有用的东西或特定领域的任何东西，比如特定领域的业务规则等。我还看到了代码覆盖率为 30% 的代码库，但这些测试是相关的、有意义的并且非常棒，因为它们测试了编写代码的核心功能并表达了代码的使用方式。

在探索新框架或代码库时，我最喜欢的技巧之一是为 'it' 编写单元测试以发现事情是如何工作的。这是了解更多新事物而不是阅读干文档的好方法:)

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2008-09-16T00:41:45.367

我最近在我的工作场所经历了完全相同的经历，发现他们中的大多数人都知道理论上的好处，但必须专门向他们推销这些好处，所以这是我（成功地）使用的几点：

*   它们在执行负面测试时节省时间，您可以在其中处理意外输入（空指针、越界值等），因为您可以在一个进程中完成所有这些操作。
*   他们在编译时提供有关更改标准的即时反馈。
*   它们对于测试在正常运行时可能不会公开的内部数据表示很有用。

还有那个大...

*   你可能不需要单元测试，但是当其他人进来并在没有完全理解的情况下修改代码时，它可能会发现他们可能犯的很多愚蠢的错误。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2009-07-20T16:02:35.497

几年前我发现了 TDD，并从那时起使用它编写了我所有的宠物项目。我估计 TDD 一个项目所花费的时间与牛仔一起完成它所花费的时间大致相同，但是我对最终产品的信心越来越大，以至于我不禁有一种成就感。

我还觉得它改进了我的设计风格（更加面向界面，以防我需要一起模拟事物），正如顶部的绿色帖子所写，它有助于“编码便秘”：当你不知道什么时写下，或者你面前有一项艰巨的任务，你可以写小。

最后，我发现到目前为止，TDD 最有用的应用是在调试中，这仅仅是因为您已经开发了一个询问框架，您可以使用该框架促使项目以可重复的方式产生错误。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2011-10-01T08:42:28.827

还没有人提到的一件事是让所有开发人员承诺实际运行和更新任何现有的自动化测试。您返回并发现由于新开发而损坏的自动化测试会失去很多价值，并使自动化测试非常痛苦。由于开发人员已经手动测试了代码，因此大多数测试不会指示错误，因此更新它们所花费的时间只是浪费。

说服怀疑者不要破坏其他人在单元测试中所做的工作对于从测试中获得价值更为重要，并且可能更容易。

每次从存储库更新时，花费数小时更新由于新功能而损坏的测试既不高效也不有趣。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2008-09-15T21:51:26.587

如果您使用 NUnit，一个简单但有效的演示是在它们前面运行 NUnit 自己的测试套件。看到一个真正的测试套件给一个代码库一个锻炼值一千字......

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2008-09-15T21:59:47.970

单元测试对任何开发人员都无法想象的项目有很大帮助。它们允许您在签入之前运行单元测试套件并发现您是否破坏了某些东西。这大大减少了*在*等待其他人修复他们签入的错误时不得不坐下来玩弄拇指的情况，或者为了完成一些工作而恢复他们的更改的麻烦。它在重构方面也非常有价值，因此您可以确定重构后的代码通过了原始代码所做的所有测试。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2008-09-15T23:37:47.283

使用单元测试套件，您可以对代码进行更改，同时保持其余功能不变。这是一个很大的优势。完成新功能的编码后，您是否使用单元测试套件和回归测试套件。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2010-10-01T00:10:44.993

关于单元测试要记住的一件事是它对开发人员来说是一种安慰。

相反，功能测试是针对用户的：每当您添加功能测试时，您就是在测试用户将看到的东西。添加单元测试时，您只是让开发人员的生活更轻松。在这方面，这有点奢侈。

当您必须在编写单元或功能测试之间做出选择时，请记住这种二分法。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2010-11-17T17:09:46.747

根据我的经验，单元测试和集成测试是复杂软件环境中的“必备”。

为了说服团队中的开发人员编写单元测试，您可能需要考虑将单元测试回归分析集成到您的开发环境中（例如，在您的日常构建过程中）。

一旦开发人员知道如果单元测试失败，他们就不必花费太多时间来调试它来发现问题，他们就会更愿意编写它们。

这是一个提供此类功能的工具：

[单元测试回归分析工具](http://www.wisetester.com/)

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2011-02-25T12:08:47.210

我同意与大多数人相反的观点： [不编写单元测试也没关系，](http://blogs.msdn.com/b/cashto/archive/2009/03/31/it-s-ok-not-to-write-unit-tests.aspx) 尤其是原型繁重的编程（例如 AI）很难与单元测试结合起来。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2008-09-15T21:47:35.783

单元测试的重点是使测试变得容易。它是自动化的。“进行测试”，你就完成了。如果您面临的问题之一是难以测试代码，那么这就是使用单元测试的最佳理由。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2008-09-15T21:53:54.240

当您手动测试软件时，您通常会使用一小组测试/操作。最终，您将自动变形您的输入数据或操作，以便您在已知问题周围导航。单元测试应该在那里提醒你事情不能正常工作。

我建议在代码之前编写测试，添加新的测试/数据以发展主代码的功能！

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2008-09-15T21:54:44.550

作为一名物理专业的学生，​​我非常渴望真正*证明*我的代码可以按预期工作。您可以在逻辑上证明这一点，随着实现变得更加复杂，难度会急剧增加，或者您可以通过良好的测试做出（尽可能接近）功能的经验证明。

如果您不提供功能的逻辑证明，则必须进行测试。唯一的选择是说“我认为代码有效......”

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2008-09-15T22:09:48.680

单元测试的好处之一是可预测性。

在单元测试之前，我可以非常准确地预测编写代码需要多长时间，但不能预测我需要多少时间来调试它。

这些天，因为我可以计划我要写什么测试，我知道编码需要多长时间，并且在编码结束时，系统已经调试好了！这为开发过程带来了可预测性，消除了很多压力，但仍然保留了所有的快乐！！。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2008-09-20T04:47:09.757

使您测试的第一件事与单元测试无关。我主要在 Perl 中工作，所以这些是特定于 Perl 的示例，但您可以适应。

*   每个模块是否正确加载和编译？在 Perl 中，这是为代码库中的每个 Foo.pm 创建一个 Foo.t 的问题：

    ```
    use_ok( 'Foo' ); 
    ```

*   所有 POD（Plain Ol' Documentation）的格式是否正确？使用 Test::Pod 验证所有文件中所有 POD 格式的有效性。

你可能不认为这些是大事，其实也不是，但我可以保证你会抓到一些麻烦。当这些测试每小时运行一次，并且它捕捉到某人的过早提交时，你会让人说“嘿，这太酷了”。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2010-09-30T18:21:30.330

就在今天，我不得不更改一个之前已经为其编写过单元测试的类。
测试本身写得很好，并且包含了我从未想过的测试场景。
幸运的是，所有测试都通过了，我的更改很快得到验证，并充满信心地投入到测试环境中。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2010-12-20T07:50:47.327

@George Stocker “不幸的是，我们的代码库不适合简单的测试。”。每个人都同意单元测试有好处，但听起来这个代码库的成本很高。如果成本大于收益，那么他们为什么要热衷于它呢？听你的同事的话；也许对他们来说，单元测试的感知痛苦大于单元测试的感知价值。

具体来说，尝试尽快获得价值，而不是一些感觉良好的“xUnit 是绿色”的价值，而是用户和维护者重视的干净代码。也许您必须为一次迭代强制执行单元测试，然后讨论是否值得付出努力。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2008-09-15T21:50:08.587

你想说服谁？工程师还是经理？如果你想说服你的工程师同事，我认为你最好的办法是迎合他们制作高质量软件的愿望。有许多研究表明它可以发现错误，如果他们关心做得好，这对他们来说应该足够了。

如果您试图说服管理层，您很可能必须进行某种成本/收益推理，即未检测到的缺陷的成本大于编写测试的成本。一定要包括无形成本，例如失去客户信心等。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-06-18T10:41:42.870

单元测试可帮助您发布具有更少错误的软件，同时降低总体开发成本。您可以点击链接阅读更多关于[单元测试的好处](http://www.typemock.com/benefits_of_unit_testing_with_typemock.php)

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2010-09-30T18:27:07.157

这是非常以.Net 为中心的，但是有人尝试过**Pex**吗？

在我尝试之前我非常怀疑 - 哇，多么好的表现。*在我想“在我了解它实际上对我有什么*好处之前，我不会被这个概念说服”。我只跑了一次就改变主意并说“我*不在乎*你怎么知道那里有致命异常的风险，但*现在*我知道我必须处理它”

也许这种行为的唯一缺点是它会标记*所有内容*并给您六个月的积压。但是，如果你有代码债务，你总是有代码债务，你只是不知道而已。告诉 PM 可能存在 20 万个故障点，而在您意识到几十万个故障点之前是一个令人讨厌的前景，这意味着首先解释这个概念至关重要*。*

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2012-01-16T09:19:30.420

单元测试是高质量代码最常用的方法之一。它对更稳定、独立和文档化的代码的贡献已得到充分证明。单元测试代码被视为存储库的一个组成部分并被处理，因此需要开发和维护。但是，开发人员经常会遇到这样一种情况，即在单元测试中投入的资源不如预期的那样富有成效。在理想的世界中，我们编写的每个方法都会有一系列测试来覆盖它的代码并验证它的正确性。但是，通常由于时间限制，我们要么跳过一些测试，要么编写质量差的测试。在这样的现实中，在牢记在单元测试开发和维护上投入的资源数量的同时，人们必须问自己，考虑到可用的时间，哪些代码最值得测试？从现有的测试中，哪些测试实际上值得保留和维护？看[这里](http://developer4life.blogspot.com/2012/01/effective-unit-testing-not-all-code-is.html)

* * *

## 回答 #44

> 赞同：-9
> 
> 时间：2009-02-10T00:59:53.633

单元测试适用于 QA 人员或您的经理，而不适用于您；所以这绝对不值得。

您应该专注于编写正确的代码（无论它是什么意思），而不是测试用例。让其他人担心这些。

# .net - 为什么 BackColor 不适用于 .NET 中的 TabControls？

> ID：67300
> 
> 赞同：0
> 
> 时间：2008-09-15T21:44:05.450
> 
> 标签：.net, controls, tabcontrol

如果您将 .NET 中的标准选项卡控件用于选项卡页并尝试稍微更改外观，那么您可以更改选项卡页的背景颜色，但不能更改选项卡控件。该属性可用，您可以设置它但它没有效果。如果您更改页面的背景颜色而不是选项卡控件的背景颜色，它看起来......嗯，非常难看。

我知道微软不希望它被设置。[MSDN](http://msdn.microsoft.com/en/library/w4sc610z(VS.80).aspx) : '*此属性支持 .NET Framework 基础结构，不打算直接从您的代码中使用。该成员对该控件没有意义。*' 仅用于支持 .NET 基础结构的颜色的控件属性？...难以置信。

多年来，我希望微软会改变它，但他们没有。我创建了自己的 TabControl 类，它覆盖了paint 方法来解决这个问题。但这真的是最好的解决方案吗？

这个控件不支持 BackColor 的原因是什么？你有什么解决方案来解决这个问题？有没有比覆盖绘画方法更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T10:49:52.640

Rajesh 博客中的解决方案非常有用，但它只为控件的选项卡部分着色。就我而言，我在不同颜色的背景上有一个 tabcontrol。选项卡本身是灰色的，这不是问题，但选项卡右侧的区域显示为灰色条带。

要将此颜色更改为背景颜色，您需要将以下代码添加到 DrawItem 方法（如 Rajesh 的解决方案中所述）。我正在使用 VB.Net：

```
...

Dim r As Rectangle = tabControl1.GetTabRect(tabControl1.TabPages.Count-1)
Dim rf As RectangleF = New RectangleF(r.X + r.Width, r.Y - 5, tabControl1.Width - (r.X + r.Width), r.Height + 5)
Dim b As Brush = New SolidBrush(Color.White)
e.Graphics.FillRectangle(b, rf)

... 
```

基本上，您需要将由最后一个选项卡的右侧组成的矩形放到选项卡控件的右侧，然后将其填充为所需的颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T22:47:05.367

选项卡的背景颜色似乎由操作系统的显示属性控制。特别是在外观选项卡下，Windows 和按钮属性 (Windows XP)。当设置为 Windows 经典样式时，选项卡永远不会改变颜色。当设置为 Windows XP 样式时，它至少会在选中时从灰色变为白色。所以无法控制背景颜色是一个功能！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T04:59:52.980

谢谢，劳拉。你帮助我走上了正轨。我已经找到了 Oskar 提供的链接，但最后没有为地带做任何事情。

最后，我不得不进行相当多的更改，因为我需要表单上的背景图像来渗透，或者如果父级是没有背景图像的东西，背景色。我还需要图标来显示它们是否存在。我对我的[TabControl BackColor 修复帖子](http://blog.villainousmind.com/2009/04/fix-backcolor-for-tabcontrol-in-net.html)中的所有代码进行了完整的记录。

# visual-studio-2008 - 从 VSS 中拯救我们

> ID：67339
> 
> 赞同：2
> 
> 时间：2008-09-15T21:48:18.620
> 
> 标签：visual-studio-2008, version-control, visual-sourcesafe

我是一个 1-2 人的团队，到目前为止，我一直在使用 VSS，原因有两个：1）公司在几个月前开始使用 VSS 时就在使用它，2）它对 Visual Studio 很友好。

不用说，我非常想升级到一个不太过时的源代码控制系统。但是，我不想放弃对 Visual Studio 的友好性，我希望能够将现有代码库迁移到更好的源代码控制系统。

我无法想象我是唯一处于这种情况的人。有没有人有一个他们不介意分享的成功故事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T21:50:22.377

如果您可以付费，[Source Gear Vault](http://www.sourcegear.com/)旨在成为替代品。

如果你付不起钱，带有 AnkhSVN 的 Subversion 效果很好，但有点不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T16:05:23.780

我们使用的是 Subversion 1.5，TortoiseSVN，对于 Visual Studio 集成，我们使用的是[PushOk 的 SVN 插件](http://www.pushok.com/soft_svn.php)。该插件不是免费的，但价格实惠且可靠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T21:54:30.027

大约 7 个月前，我们从 SourceGear 对 Vault 进行了另一次投票，我们从 VSS 转移到了 Vault。

这是一个非常简单的举措，我们在 Vault 方面拥有非常好的体验。

我们所需要的一点点支持是及时和乐于助人的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T21:50:20.020

考虑 Subversion ( [http://subversion.tigris.org/](http://subversion.tigris.org/) ) 和 Tortoise shell 扩展 ( [http://tortoisesvn.tigris.org/](http://tortoisesvn.tigris.org/) )。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T21:51:05.730

如果您需要便宜或免费的解决方案，我建议您研究 Subversion 或 GIT。有一些第三方插件，例如 Visual Svn for Subversion，可以让您在 Visual Studio 中使用。如果您想要一些离家近的东西 (VSS)，请尝试 Microsoft 的 Team System 或 SourceGear 的 Source Vault。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T21:52:34.070

[免费的 Visual SVN Server](http://www.visualsvn.com/)的轻松安装是无与伦比的，VisualSVN 插件非常物有所值。我自掏腰包支付了那部分费用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T21:54:14.817

对于一两个用户，[perforce](http://www.perforce.com)也是免费的。但是，一旦您需要两个以上的用户，您就必须开始为此付费。他们还有一个 SCC 插件，允许集成到 Visual Studio（以及支持该接口的任何其他程序）中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T21:55:45.797

我们非常轻松地从 VSS 迁移到 SVN。TortoiseSVN，在 Win32 环境下，与 Explorer 集成得很好。

设置您的服务器。我会推荐安装了 Ubuntu Server 的镜像 raid 设置。一旦你运行了这个，设置 apache 和 svn 来托管来自 raid 的存储库。对于像您这样的小型团队，您可以将一台旧 PC 与几个用于 RAID 驱动器的备用 IDE 端口组合在一起。如今，高容量 IDE 驱动器相当实惠。

突袭方法：[https ://wiki.ubuntu.com/Raid](https://wiki.ubuntu.com/Raid)

Svn 方法：[https ://help.ubuntu.com/8.04/serverguide/C/subversion.html](https://help.ubuntu.com/8.04/serverguide/C/subversion.html)

我估计要花一天时间来设置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-15T21:59:26.020

最困难的部分是保持您的变更历史完好无损。几年前我不得不这样做。在这个过程中有*很多尝试和错误。*

我不知道迁移工具是否变得更好。谷歌“sourcesafe svn 迁移”。一旦你完成了那部分，剩下的就很容易了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-16T11:34:47.310

如果您目前熟悉 VSS，但想要更多功能，您可能应该看看 Vi [sual Studio Team System](http://msdn.microsoft.com/en-us/vsts2008/default.aspx)。[它确实需要服务器，但您可以从 MS 获得一个“Action Pack”，其中包括您从合作伙伴中心](https://partner.microsoft.com/US/program/managemembership/40013779)获得的“Team Foundation Server Workgroup Edition”所需的所有许可证。

有了这个，您将获得错误、风险和问题跟踪以及许多其他功能 :)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T11:50:21.547

我们正在使用带有 TortoiseSVN 和 VisualSVN 的 Subversion。效果很好。如果您只想在内部网络上工作，则不需要 VisualSVN。只需[将 Subversion 服务器安装为 Windows 服务](http://svn.collab.net/repos/svn/trunk/notes/windows-service.txt)。

关于保留旧修订历史的问题。

保留 VSS 数据库可能很有意义。仅仅因为您不想继续使用 VSS 并不意味着您必须完全摆脱它。

因此，如果很难找到一条简单的迁移路径，为什么不保留 VSS 数据库作为历史参考，然后将所有新开发迁移到 Subversion。

# sql-server - SQL 2000 等效于 SQLAgentReaderRole

> ID：67347
> 
> 赞同：1
> 
> 时间：2008-09-15T21:49:28.180
> 
> 标签：sql-server, sql-server-agent

我有很多开发人员问我是否运行了某些 SQL 作业，我想给他们访问权限，让他们自行检查，而不给他们`sysadmin`权限。我知道在`SQL 2005`，你可以授予他们`SQLAgentReaderRole`，但我正在寻找解决方案`SQL 2000`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T22:14:22.740

很确定没有一个开箱即用的。这个线程似乎相当不错......他们讨论了创建一个角色然后进一步锁定它。您也可以创建一个小程序（甚至是sp？）将工作结果作为摘要通过电子邮件发送，或者在每个工作中添加一个完成事件以通过电子邮件发送电子邮件组。

[http://sqlforums.windowsitpro.com/web/forum/messageview.aspx?catid=60&threadid=43021&enterthread=y](http://sqlforums.windowsitpro.com/web/forum/messageview.aspx?catid=60&threadid=43021&enterthread=y)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-24T14:59:46.097

看起来我们这些仍在使用 2000 的人有一些希望 -

“为了在 SQL Server 2000 中完成此操作，DBA 必须将用户添加到 MSDB 数据库中的 TargetServersRole 角色。在 SQL Server 2000 上的 Service Pack 3 之前，必须将用户添加到 sysadmin 组，以便有机会查看系统管理员组拥有的作业。”

引用自[http://www.sql-server-performance.com/faq/sqlagent_scheduled_jobs_p1.aspx](http://www.sql-server-performance.com/faq/sqlagent_scheduled_jobs_p1.aspx)通过[http://social.msdn.microsoft.com/Forums/en/sqlsmoanddmo/thread/8a05fe47-50c7-4b95-b631- 8f7d69d31dae](http://social.msdn.microsoft.com/Forums/en/sqlsmoanddmo/thread/8a05fe47-50c7-4b95-b631-8f7d69d31dae)

# internet-explorer - 可怕的 iframe 水平滚动条不能在 IE 中删除？

> ID：67354
> 
> 赞同：19
> 
> 时间：2008-09-15T21:49:59.163
> 
> 标签：internet-explorer, iframe

我有一个 iframe。内容比我设置的宽度宽，所以 iframe 有一个水平滚动条。我无法增加 iframe 的宽度，所以我只想删除滚动条。我尝试将滚动属性设置为“否”，但这会杀死两个滚动条，我想要垂直滚动条。我尝试将 overflow-x 设置为“隐藏”，这会杀死 ff 中的水平滚动条，但不会在 IE 中。为我难过。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-23T06:32:11.183

```
scrolling="yes"  horizontalscrolling="no" verticalscrolling="yes" 
```

把它放在你的 iFrame 标签中。

您无需费心尝试在 CSS 中对其进行格式化。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-15T22:18:30.157

滚动条不是 的属性`<iframe>`，它是它包含的页面的属性。尝试放置内页`overflow-x: hidden`的元素。`<html>`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-15T22:17:36.990

您可以尝试将 iframe 放入 div 中，然后使用 div 进行滚动。您可以毫无问题地控制 IE 中 div 的滚动，IE 只有 iframe 滚动确实存在问题。这是一个可以解决问题的快速示例。

```
<html>
    <head>
        <title>iframe test</title>

        <style>         
        #aTest { 
            width: 120px;
            height: 50px;
            padding: 0;
            border: inset 1px #000;
            overflow: auto;
        }

        #aTest iframe {
            width: 100px;
            height: 1000px;
            border: none;
        }
        </style>
    </head>
    <body>
        <div id="aTest">
            <iframe src="whatever.html" scrolling="no" frameborder="0"></iframe>
        </div>
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T00:52:59.363

```
<iframe style="overflow:hidden;" src="about:blank"/> 
```

应该在IE中工作。IE6 在支持overflow-x 和overflow-y 时存在问题。

还有一点需要注意的是，只有在 camelCase 中设置了“frameborder”属性时，才能移除 IE 在 iframe 上的边框。

```
<iframe frameBorder="0" style="overflow:hidden;" src="about:blank"/> 
```

如果您可以使用 CSS 正确设置它的样式会很好，但它在 IE 中不起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-29T22:53:49.047

所有这些解决方案都对我不起作用或不令人满意。使用可滚动的 DIV，您可以使水平滚动条消失，但那时您将始终拥有垂直滚动条。

因此，对于我可以确保控制所有 iframe 的固定高度的网站，以下解决方案非常有效。它只是用 DIV 隐藏水平滚动条 :)

```
 <!-- This DIV is a special hack to hide the horizontal scrollbar in IE iframes -->
<!--[if IE]>
<div id="ieIframeHorScrollbarHider" style="position:absolute; width: 768px; height: 20px; top: 850px; left: 376px; background-color: black; display: none;">
</div>
<![endif]-->
<script type="text/javascript">
  if (document.getElementById("idOfIframe") != null && document.getElementById("ieIframeHorScrollbarHider") != null)
  {
    document.getElementById("ieIframeHorScrollbarHider").style.display = "block";
  }
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-09T19:39:35.173

您还可以尝试将 iframe 中包含的页面正文的宽度设置为 99%。

# c# - 用于修复 .NET 应用程序以解决 SQL Server 超时问题并缩短执行时间的清单

> ID：67366
> 
> 赞同：12
> 
> 时间：2008-09-15T21:51:34.650
> 
> 标签：c#, .net, sql-server, vb.net, timeout

用于改进 .NET 代码和 SQL Server 之间执行时间的清单。从基本到奇怪的解决方案的任何东西都值得赞赏。

**代码：**

[通过avgbody](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#67438)更改命令和连接中的默认超时。

使用存储过程调用而不是[avgbody](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#67438)的内联 sql 语句。

使用[Jay Shepherd](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#67387)的活动监视器查找阻塞/锁定。

**SQL 服务器：**

[注意AlexCuse](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#68183)在存储过程中的参数嗅探。

[谨防Martin Clarke](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#67660)的动态增长数据库。

使用 Profiler 查找[BradO 耗时超过](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#67598)100 毫秒的任何查询/存储过程。

[通过avgbody](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#67438)增加事务超时。

[通过avgbody](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#67438)将动态存储过程转换为静态存储过程。

[查看Jay Shepherd](https://stackoverflow.com/questions/67366/a-checklist-for-fixing-net-apps-to-sql-server-timeout-problems-and-improve-exec#67387)的服务器有多忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T21:59:40.327

在过去，我的一些解决方案是：

1.  修复 sql 命令的默认超时设置：

    将 myCommand 调暗为新 SqlCommand("[dbo].[spSetUserPreferences]", myConnection)

    myCommand.CommandType = CommandType.StoredProcedure

    **myCommand.CommandTimeout = 120**

2.  增加连接超时字符串：

    Data Source=mydatabase;Initial Catalog=Match;Persist Security Info=True;User ID=User;Password=password; **连接超时=120**

3.  在 sql-server 2005 中增加事务超时

    在管理工作室的工具 > 选项 > 设计器中增加“事务超时时间：”即使“覆盖表设计器更新的连接字符串超时值”选中/取消选中。

4.  将动态存储过程转换为静态存储过程

5.  使代码调用存储过程，而不是在代码中编写内联 sql 语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T21:56:43.670

对于响应时间长的抱怨，一个奇怪的“解决方案”是有一个更有趣的进度条。意思是，根据用户的感觉工作。一个示例是 Windows Vista 等待图标。那个快速旋转的圆圈给人的感觉是事情进展得更快。谷歌在 Android 上使用了同样的技巧（至少我见过的版本）。

但是，我建议先尝试解决技术问题，然后仅在您别无选择时才研究人类行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T00:18:10.040

你在使用存储过程吗？如果是这样，您应该注意参数嗅探。在某些情况下，这可能会导致一些非常长时间运行的查询。一些阅读：

[http://blogs.msdn.com/queryoptteam/archive/2006/03/31/565991.aspx](http://blogs.msdn.com/queryoptteam/archive/2006/03/31/565991.aspx)

[http://blogs.msdn.com/khen1234/archive/2005/06/02/424228.aspx](http://blogs.msdn.com/khen1234/archive/2005/06/02/424228.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T21:53:20.013

首先也是最重要的 - 检查正在运行的实际查询。我在通过我的程序进行设置时使用 SQL Server Profiler，并尽可能检查我的所有查询是否使用正确的连接和引用键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T21:59:49.093

运行 Profiler 以测量查询的执行时间。
检查应用程序日志记录是否存在任何死锁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T21:53:59.230

几个快速的...

*   检查服务器的处理器使用情况，看看它是否太忙了
*   使用活动监视器查找阻塞/锁定
*   网络问题/性能

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T22:25:09.047

我也喜欢使用[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms181091.aspx)。我喜欢在工作日中间的 15-30 分钟的时间里，在他们的数据库服务器上的客户端站点上设置跟踪，并记录所有持续时间 > 100 毫秒的查询/存储过程。无论如何，这就是我对“长期运行”查询的标准。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T22:35:20.130

一种适用于 SQL Server 2000 的奇怪方法，今天可能仍然适用：

确保您没有尝试在生产中动态增长数据库。有一点是，分配额外空间和正常负载运行所需的时间会导致查询超时（以及增长！）

# release-management - How do you update a live, busy web site in the politest way possible?

> ID：67368
> 
> 赞同：17
> 
> 时间：2008-09-15T21:51:56.227
> 
> 标签：release-management, high-availability

When you roll out changes to a live web site, how do you go about checking that the *live* system is working correctly? Which tools do you use? Who does it? Do you block access to the site for the testing period? What amount of downtime is acceptable?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-15T21:55:17.870

I tend to do all of my testing in another environment (not the live one!). This allows me to push the updates to the live site knowing that the code should be working ok, and I just do sanity testing on the live data - make sure I didn't forget a file somewhere, or had something weird go wrong.

So proper testing in a testing or staging environment, then just trivial sanity checking. No need for downtime.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-15T22:34:22.350

Lots of good advice already.

As people have mentioned, if you don't have single point involved, it's simple to just phase in changes by upgrading an app server at a time. But that's rarely the case, so let's ignore that and focus on the difficult bits.

Usually there is a db in there which is common to everything else. So that means downtime for the whole system. *How do you minimize that?*

**Automation**. Script the entire deployment procedure. This (especially) includes any database schema changes. This (especially) includes any data migration you need between versions of the schema.

**Quality control**. Make sure there are tests. Automated acceptance tests (what the user sees and expects from a business logic / experience perspective). Consider having test accounts in the production system which you can script to test readonly activities. If you don't interact with other external systems, consider doing write activities too. You may need to filter out test account activity in certain parts of the system, especially if they deal with money and accounting. Bean counters get upset, for good reasons, when the beans don't match up.

**Rehearse**. Deploy in a staging environment which is as identical as possible to production. Do this with production data volumes, and production data. You need to feel how long an alter table takes. And you need to check that an alter table works both structurally, and with all foreign keys in the actual data.

If you have massive data volumes, schema changes will take time. Maybe more time than you can afford to be down. One solution is to use **phased data migrations**, so that the schema change is populated with "recent" or "current" (let's say one or three months old) data during the downtime, and the data for the remaining five years can trickle in after you are online again. To the end user things look ok, but some features can't be accessed for another couple of hours/days/whatever.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T22:00:32.057

At work, we spend a period of time with the code frozen in the test environment. Then after a few weeks of notice, we take the site down at midnight Friday night, work through the night deploying and validating, and put it up Saturday late morning. Traffic statistics showed us this was the best time frame to do it.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T21:58:09.643

If you have a set of load-balanced servers, you will be able to take one by one offline separately and update it. No downtime for the users!

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-10-10T17:32:02.863

At the last place where I worked, QA would perform testing in the QA Environment. Any major problems would be fixed, tested, and verified before rolling out.

After the build has been certified by QA, the production support team pushed the code to the Staging environment where the client looks at the site and verifies that everything is as desired.

The actual production rollout occurs during off hours (after 9 p.m. if it is an emergency night push, or from 5 a.m. - 8 a.m. if it is a normally scheduled rollout).

The site is hosted on multiple servers, which are load balanced using an F5 Load Balancer:

*   A couple of the servers are removed from production,
*   code is installed, and
*   a cursory check is performed on the servers before putting the servers back in the pool.

This is repeated until all of the servers are upgraded to the latest code and allows the site to remain up the whole time.

This process is ideal, but there are cases when the database needs to be upgraded as well. If this is the case, then there are two options, depending on if the new database will break the site or not.

If the new database is incompatible with the existing front end, you have no real choice but to have a window of time where the site is down.

But if the new database is compatible with the existing front end, you can still push the code out without any actual downtime, but this requires there to be two production database servers.

*   All traffic is routed to the second DB and the first DB server is pulled.
*   The first DB is upgraded and after verification is complete, put back in production.
*   All traffic is routed to the first DB and second DB is pulled.
*   The second DB is upgraded and after verification is complete, put back in production.
*   The next step is to perform the partial upgrades as described above.

So to summarize:

*   **When you roll out changes to a live web site, how do you go about checking that the live system is working correctly?** In the best case, this is done incrementally.

*   **Which tools do you use?** Manual checks to verify code is installed correctly along with some basic automated tests, using any automation tool. We used Selenium IDE.

*   **Who does it?** DBA performs DB upgrades, Tech Support/System Admins push/pull the servers and installs the code, and QA or Production support performs the Manual Tests and/or runs the Automated tests.

*   **Do you block access to the site for the testing period?** If possible, this should be avoided at all costs, especially, as Gilles mentioned earlier, if it is a paid site.

*   **What amount of downtime is acceptable?** Downtime should be restricted to times when users would be least likely to use the site, and should be done in less than 3 hours time.
    **Note:** 3 hours is very generous. After practice and rehearsing, like jplindstrom mentioned, the team will have the whole process down and can get in and out in sometimes less than an hour.

Hope this helps!

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-15T22:02:44.017

Have a cute, disarming image and/or backup page. Some sites implement simple javascript games to keep you busy while waiting for the update.

Eg, fail whale.

-Adam

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T21:59:10.357

Some of that depends on if you're updating a database as well. In the past, if the DB was being updated we downed the site for a planned (and published) maintenance period - usually something really off hours where impact was minimal. If the update doesn't involve the DB then, in a load balanced environment, we'd take 1 box out of the mix, deploy & test. If that was successful, it went into the mix and the other box (assuming 2 boxes) was brought out and updated/tested.

Note: We're NOT testing the code, just that the deployment went smoothly so down time any way was minimal. As has been mentioned, the code should have already passed testing in another environment.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T22:03:46.027

IMHO long downtimes (hours) are acceptable for a free site. If you educate your users enough they'll understand that it's a necessity. Maybe give them something to play with until the website goes back up (eg. flash game, webcam live feed showing the dev team at work, etc). For a website that people pay to access, a lot of people are going to waste your time with complaints if you feed them regular downtime. I'd avoid downtime like the plague and roll out updates really slowly and carefully if I were running a service that charges users.

In my current setup I have a secondary website connected to the same database and cache as the live copy to test my changes.

I also have several "page watcher" scripts running on cron jobs that use regular expressions to check that the website is rendering key pages properly.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T22:04:51.017

The answer is that "it depends". First of all, on the kind of environment you are releasing into. Is it "hello, world" type of website on a shared host somewhere, or a google.com with half a mil servers? Is there typically one user per day, or more like couple million? Are you publishing HTML/CSS/JPG, or is there a big hairy backend with SQL servers, middle tier servers, distributed caches, etc?

In general -- if you can afford to have separate environments for development, QA, staging, and production -- do have those. If you have the resources -- create the ecosystem so that you can build the complete installable package with 1 (one) click. And make sure that **the same** binary install can be successfully installed in DEV/QA/STAGE/PROD with another single click... There's tons of stuff written on this subject, and you need to be more specific with your question to get a reasonable answer

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T22:00:12.400

Run your main server on a port other than 80\. Stick a lightweight server (e.g. nginx) in front of it on port 80\. When you update your site, start another instance on a new port. Test. When you are satisfied that it has been deployed correctly, edit your proxy config file, and restart it. In nginx's case, this results in zero downtime or failed requests, and can also provide performance improvements over the more typical Apache-only hosting option.

Of course, this is no substitute for a proper staging server, it is merely a 'polite' way of performing the handover with limited resources.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T22:17:17.430

To test everything as well as possible on a separate dev site before going live, I use Selenium (a web page tester) to run through all the navigable parts of the site, fill dummy values into forms, check that those values appear in the right places as a result, etc.

It's powerful enough to check a lot of javascript or dynamic stuff too.

Then a quick run-through with Selenium again after upgrading the live site verifies that the update worked and that there are no missing links or database errors.

It's saved me a few times by catching subtle errors that I would have missed just manually flicking through.

Also, if you put the live site behind some sort of "reverse proxy" or load balancer (if it's big), that makes it easy to switch back to the previous version if there are problems.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T22:21:28.590

The only way to make it transparent to your users is to put it behind a load balanced proxy. You take one server down while you update another server. Then when you done updating you put the one you updated online and take the other one down. That's how we do it.

If you have any sort of 'beta" build, don't roll it out on the live server. If you have a 'live, busy site' chances are people are going to pound on it and break something.

This is a typical high availbility setup, to maintain high availability you'll need 3 servers minimum. 2 live ones and 1 testing server. Plus any oter extra servers if you want to have a dedicated DB or something.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-01-09T11:31:49.310

Create a host class and deploy your live site on that host class. By host class I mean a set of hosts where load balancing is setup and its easy to add and remove hosts from the class.

When you are done with the beta testing and ready for production, no need to take your site down, just remove some host from production host class, add them in new host class and deploy your latest code there and test properly. Once you are sure that everything is working fine move all your host gradually to the new one and point new host class as production host class. Or you can use the same you were using initially, whole idea behind this activity is to make sure that your are testing your deployment on the production boxes, where your site will be running after deployment, because deploy issues are scary and hard to debug.

# c# - Dynamically Create a generic type for template

> ID：67370
> 
> 赞同：15
> 
> 时间：2008-09-15T21:52:15.553
> 
> 标签：c#, generics

I'm programming WCF using the ChannelFactory which expects a type in order to call the CreateChannel method. For example:

```
IProxy proxy = ChannelFactory<IProxy>.CreateChannel(...); 
```

In my case I'm doing routing so I don't know what type my channel factory will be using. I can parse a message header to determine the type but I hit a brick wall there because even if I have an instance of Type I can't pass that where ChannelFactory expects a generic type.

Another way of restating this problem in very simple terms would be that I'm attempting to do something like this:

```
string listtype = Console.ReadLine(); // say "System.Int32"
Type t = Type.GetType( listtype);
List<t> myIntegers = new List<>(); // does not compile, expects a "type"
List<typeof(t)> myIntegers = new List<typeof(t)>(); // interesting - type must resolve at compile time? 
```

Is there an approach to this I can leverage within C#?

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-15T22:10:28.023

What you are looking for is MakeGenericType

```
string elementTypeName = Console.ReadLine();
Type elementType = Type.GetType(elementTypeName);
Type[] types = new Type[] { elementType };

Type listType = typeof(List<>);
Type genericType = listType.MakeGenericType(types);
IProxy  proxy = (IProxy)Activator.CreateInstance(genericType); 
```

So what you are doing is getting the type-definition of the generic "template" class, then building a specialization of the type using your runtime-driving types.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-15T22:59:29.340

You should look at this post from Ayende: [WCF, Mocking and IoC: Oh MY!](http://www.ayende.com/Blog/archive/2007/02/10/WCF-Mocking-and-IoC-Oh-MY.aspx). Somewhere near the bottom is a method called GetCreationDelegate which should help. It basically does this:

```
string typeName = ...;
Type proxyType = Type.GetType(typeName);

Type type = typeof (ChannelFactory<>).MakeGenericType(proxyType);

object target = Activator.CreateInstance(type);

MethodInfo methodInfo = type.GetMethod("CreateChannel", new Type[] {});

return methodInfo.Invoke(target, new object[0]); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T22:28:14.983

Here's a question: Do you *really* need to create a channel with the exact contract type in your specific case?

Since you're doing routing, there's a very good chance you could simply deal with the generic channel shapes. For example, if you're routing a one-way only message, then you could create a channel to send the message out like this:

```
ChannelFactory<IOutputChannel> factory = new ChannelFactory<IOutputChannel>(binding, endpoint);
IOutputChannel channel = factory.CreateChannel();
...
channel.SendMessage(myRawMessage); 
```

If you needed to send to a two-way service, just use IRequestChannel instead.

If you're doing routing, it is, in general, a lot easier to just deal with generic channel shapes (with a generic catch-all service contract to the outside) and just make sure the message you're sending has all the right headers and properties.

# visual-studio - 为什么没有 Team Foundation Server 速成版？

> ID：67407
> 
> 赞同：20
> 
> 时间：2008-09-15T21:56:23.563
> 
> 标签：visual-studio, tfs, version-control

为什么没有 Team Foundation Server 速成版？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-08T13:12:15.550

将近 3 年和 16 个答案之后，[**TFS Express**](http://www.visualstudio.com/en-us/products/visual-studio-express-vs)现在已成为事实。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-15T22:10:03.187

Express Editions 是专门为没有访问权限的个人设计的，或者更直接地说，他们买不起 Visual Studio 的完整版本，但希望在 .NET Framework 中进行开发。

另一方面，Team Foundation Server 专为拥有多个成员的软件开发团队的*公司而设计。*公司（或初创公司）从来都不是 Express 产品的目标。

您仍然可以通过将开源产品与它们结合使用来利用 Express 版本和协作工具，例如，使用 Subversion 进行源代码控制，使用 Cruise Control 进行持续集成等。它们将为您提供您需要的大部分内容，并且仍然允许您在团队环境中使用 Express 版本。

但是，我不确定在团队环境中专门使用 Express 版本是否违反其 EULA。希望不是：P

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-02-24T12:20:05.470

Visual Studio 2012 推出了 TFS 的 Express 版本：

[http://blogs.msdn.com/b/bharry/archive/2012/02/23/coming-soon-tfs-express.aspx](http://blogs.msdn.com/b/bharry/archive/2012/02/23/coming-soon-tfs-express.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T22:05:26.600

因为微软[将 TFS 定位](http://www.ericsink.com/entries/vsts_pricing.html)为与[ClearCase](http://en.wikipedia.org/wiki/Clearcase)等软件竞争，所以发布免费版本会破坏这种定位。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-16T17:17:11.837

如果您正在寻找 TFS 提供的源代码控制和错误跟踪功能，那么如果您想要一些开源的东西，有许多免费产品可以为您做到这一点，例如 CVS 或 Subversion。TFS 旨在供非常大的团队使用，解决您在非常大的团队中遇到的各种问题 - 仅将其用于源代码控制完全是矫枉过正。

我更喜欢 Sourcegear 的产品（它们对单个开发人员免费） -如果您只是在寻找源代码控制，则为[Vault](http://www.sourcegear.com/vault/index.html) ，如果您想要源代码控制以及错误和工作项跟踪，则为[Vault Professional](http://www.sourcegear.com/vaultpro/index.html) （以前称为“Fortress”），其中涵盖TFS 的大部分功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-15T22:13:53.317

嗯，这是一个有趣的问题，但真正的问题是这种东西的使用场景是什么？

特别是，我认为 TFS 非常注重支持开发*团队*。（无论它是否做得好，这是另一回事）。当然，个人开发人员可以从 TFS 中的源代码控制工具之类的东西中受益，但尚不清楚单个开发人员将如何利用 TFS 中的许多功能。

而且，对于纯源代码控制，市场上已经有很好的替代品（我的看法）

此外，有趣的是，TFS 有一些实质性的硬件、软件和环境要求，我不确定这些要求是否能让单个人轻松托管；除非他可以腾出一台机器来运行它（有些人这样做；我觉得这是浪费一台好机器，我自己:)）。

对于小型团队，已经有 TFS WorkGroup Edition，我想它与 MS 将要接近 TFS express 一样接近。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T22:04:08.117

个人不应该使用 TFS？这就像说源代码控制仅适用于团体而不是个人。

如果他们有 TFS 的速成版，那么他们可能会让更多的人使用它并为他们的公司付费使用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-16T14:08:53.490

我想你可以说有一个 Express 版本！[代码复合体](http://codeplex.com)！就像 Visual Studio 的速成版有一定的限制一样，你可以免费使用 Codeplex，但你必须开发开源。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T05:20:56.840

TFS 工作组版不是在某种程度上填补了这个“快递”的角色吗？与 800 磅重的大猩猩相比，5 个用户或更少，价格非常“快捷”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-01-24T11:39:59.283

IBM 有一个与 TFS、Rational Team Concert 类似的产品，并且它对少数用户是免费的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-05-10T13:51:49.707

最后，Team Foundation Server 的 Express 版本也可用。[在这里](http://www.microsoft.com/visualstudio/11/en-us/products/express)查看。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T22:04:27.397

不，根据记忆，基于 Team Foundation 的任何东西的成本都比专业版本高出几倍。这就是微软真正赚钱的地方。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-15T22:31:00.517

最直接的答案是 TFS 并没有很好地缩小规模以使其值得。TFS 主要针对中型、大型和大型开发团队，它不适合非常小的团队。

此外，在小范围内，已经有相当高质量的免费或廉价的源代码控制系统可用，因此 MS 在该领域投入精力竞争没有多大意义。

如果您需要源代码控制，我建议您使用带有[VisualSVN 插件的](http://www.visualsvn.com/)SVN ，每个人都这样做，而且便宜。

这样看，Visual Studio 2008 Standard 是一个 250 美元的产品。例如，Visual C# 2008 Express 中存在多少这种功能？至少相当于25美元的价值？最有可能的。至少10美元很容易。VSTS 2008 Team Foundation Server 是一个 2500 美元的产品。如果他们为制作 TFS Express 版本进行了相同数量的功能缩减，那么它的价值将是 250 美元，这对于免费赠送来说有点多。更重要的是，TFS 的很多价值在于它的可扩展性和核心功能集，几乎不可能将其剥离以创建一个简化的、更便宜的产品。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-03-31T14:45:05.927

我认为微软没有 TFS 的 SQL Server Express 版本的原因是因为 TFS 包括 SSAS。我怀疑是否会有 SSAS 的“快速”版本。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-02-29T20:20:03.583

以下是下载 TFS Express Edition Beta 的链接：http: [//www.microsoft.com/visualstudio/11/en-us/downloads#tfs-express](http://www.microsoft.com/visualstudio/11/en-us/downloads#tfs-express)

# linux - 为什么 sed 会因国际字符而失败以及如何解决？

> ID：67410
> 
> 赞同：15
> 
> 时间：2008-09-15T21:56:26.650
> 
> 标签：linux, internationalization, sed, character

`GNU sed version 4.1.5`国际字符似乎失败了。这是我的输入文件：

```
Gras Och Stenar Trad - From Moja to Minneapolis DVD [G2007DVD] 7812 | X
<br>
Gras Och Stenar Trad - From Möja to Minneapolis DVD [G2007DVD] 7812 | Y 
```

（注意第二行中的变音符号。）

当我这样做时

```
sed 's/.*| //' < in 
```

我希望只看到`X`and `Y`，因为我已要求将所有字符删除到`'|'`and 之外的空间。相反，我得到：

```
X<br>
Gras Och Stenar Trad - From M? Y 
```

我知道我可以使用 tr 删除国际字符。首先，但有没有办法只使用 sed？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-15T22:18:29.733

我认为如果文件的输入编码与您环境的首选编码不同，则会发生错误。

示例：`in`是 UTF-8

```
$ LANG=de_DE.UTF-8 sed 's/.*| //' < in
X
Y
$ LANG=de_DE.iso88591 sed 's/.*| //' < in
X 
Y 
```

UTF-8 可以安全地解释为 ISO-8859-1，你会得到奇怪的字符，但除此之外一切都很好。

示例：`in`是 ISO-8859-1

```
$ LANG=de_DE.UTF-8 sed 's/.*| //' < in
X
Gras Och Stenar Trad - From MöY
$ LANG=de_DE.iso88591 sed 's/.*| //' < in
X 
Y 
```

ISO-8859-1 不能解释为 UTF-8，解码输入文件失败。奇怪的匹配可能是由于 sed 试图恢复而不是完全失败。

答案基于 Debian Lenny/Sid 和 sed 4.1.5。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-15T22:02:40.567

`sed`对于非 ASCII 文本的设置不是很好。但是，您可以使用（几乎）相同的代码`perl`并获得所需的结果：

```
perl -pe 's/.*\| //' x 
```

# verilog - 将层次结构传递到 Verilog 模块

> ID：67418
> 
> 赞同：7
> 
> 时间：2008-09-15T21:57:04.480
> 
> 标签：verilog

我有一个“观察者”模块，它目前在其中使用全局层次结构。我需要用第二个全局层次结构实例化这个的第二个实例。

目前：

```
module watcher;
wire sig = `HIER.sig;
wire bar = `HIER.foo.bar;
...
endmodule

watcher w; // instantiation 
```

期望：

```
module watcher(input base_hier);
wire sig = base_hier.sig;
wire bar = base_hier.foo.bar;
...
endmodule

watcher w1(`HIER1); // instantiation
watcher w2(`HIER2); // second instantiation, except with a different hierarchy 
```

我最好的想法是使用 vpp（Verilog 预处理器）蛮力生成两个几乎相同的模块（每个层次结构一个），但有没有更优雅的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-16T00:56:11.680

我的偏好是在您的测试平台中有一个模块（或少量模块），其中包含所有探针但没有其他功能。测试台中需要探针的所有其他模块然后连接到该“探针模块”。如果您愿意，请优先使用 SystemVerilog 接口而不是原始电线。这绕过了您的问题，因为没有观察者需要全局层次结构，并且您的测试平台总体上将更容易维护。见得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter "得墨忒耳法则")。

或者......（但这会将层次结构放入您的实例中......）

```
module watcher(sig, bar);
  input sig;
  input bar;
...
endmodule

watcher w1(`HIER1.sig, `HIER1.foo.bar); // instantiation
watcher w2(`HIER2.sig, `HIER2.foo.bar); // second instantiation, except with a different hierarchy 
```

随后，您还可以：

```
`define WATCHER_INST(NAME, HIER) watcher NAME(HIER.sig, HIER.foo.sig)

`WATCHER_INST(w1, `HIER1);
`WATCHER_INST(w2, `HIER2); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T19:32:44.730

您可以使用 SystemVerilog`bind`关键字将模块绑定到需要它的每个层次结构中吗？（这要求您使用 SystemVerilog，并拥有模拟器许可证。）

使用 bind 就像以正常方式实例化一个模块，只是您提供了一个层次结构的路径，模块被“远程”实例化到该层次结构中：

```
bind top.my.hier my_module instance_name(.*);
bind top.my_other.hier my_module instance_name(.*); 
```

更好的是：假设您绑定到的每个层次结构都是同一模块的单独实例。然后：

```
bind remote_module my_module instance_name(.*); 
```

这会将您的模块绑定到目标的**每个实例**中，无论它在设计中的哪个位置。如果您的模块是验证检查器，这将非常强大。

# php - 预订应用程序的数据库设计，例如酒店

> ID：67421
> 
> 赞同：3
> 
> 时间：2008-09-15T21:57:30.673
> 
> 标签：php, mysql

我已经建立了一个，但我确信它是错误的。

我有一张用于客户详细信息的表格，还有一张包含每个入住日期的表格（即一周的假期将有七条记录）。

有没有更好的办法？

我用 MySQL 编写 PHP 代码

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T22:00:04.117

[干得好](http://www.databaseanswers.org/data_models/hotels/hotel_reservations_popkin.htm)

我在这个页面上找到了它： [免费数据库模型列表](http://www.webmastersbydesign.com/2008/08/04/library-of-over-500-free-database-models/)。

**警告**：目前（2011 年 11 月），Google 报告该网站包含恶意软件：[http://safebrowsing.clients.google.com/safebrowsing/diagnostic?client=Firefox&hl=en-US&site=http://www.databaseanswers。 org/data_models/hotels/hotel_reservations_popkin.htm](http://safebrowsing.clients.google.com/safebrowsing/diagnostic?client=Firefox&hl=en-US&site=http://www.databaseanswers.org/data_models/hotels/hotel_reservations_popkin.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T10:55:17.963

我在旅游业工作，曾参与过许多不同的 PMS。我设计的最后一个方法是每晚每位客人排一排，这是我遇到的最好的方法。在行业中，每晚住宿都有特定的信息。例如，您需要在预订时知道每晚住宿的价格。客人也可以在入住期间移动房间。

在性能方面，在 MySQL 中进行等号查找比范围查找更快，因此 startdate/enddate 方法会更慢。要查找一系列日期，请执行“日期在（*日期*）中的位置”。

我使用的架构大致是：

```
Bookings (id, main-guest-id, arrivaltime, departime,...)

BookingGuests (id, guest-id)

BookingGuestNights (date, room, rate) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T19:29:46.170

哇，谢谢大家的回答。

我对架构进行了长时间的思考，并在尝试另一种方式并且难以转换为 html 之后采用了记录 = 夜间方法。

我使用带有内置日历类的 CodeIgniter 来显示预订信息。通过这种方式检查是否有可用的日期更容易（至少在尝试之后），所以我选择了它。但我确信这不是最好的方法，这就是我问这个问题的原因。

也感谢数据库答案链接。

最好的，

梅

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T22:02:41.067

你需要问自己一些问题：

*   您是否有理由需要记录入住的每一天？
*   你能不能只为住宿准备一张桌子，并有一个到达日期和入住天数或出发日期？
*   是否有与一位客户的住宿相关的特定数据位每天都不同？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T00:59:03.327

有些事情可能会破坏你的模型。这些可能不是问题，但您应该咨询您的客户，看看它们是否可能发生。

*   少于 1 天的住宿（例如，在一些商务酒店中，短暂的中午住宿很常见）
*   延迟退房/提前入住。如果您只是测量夜晚，而不是日期/时间，您可能会发现很难安排这些，或者看到潜在的冲突。我们的一位客户想要四个小时的间隔，而不是总是上午 10 点到下午 2 点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T21:59:49.687

那有什么问题？记录客户停留的每个日期允许我认为是相当标准的报告，例如能够显示任何给定日期的预订房间数量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T22:02:38.337

答案在很大程度上取决于您的要求......但我希望只需要存储他们逗留的开始和停止日期的记录。如果您更多地解释您的问题，我们可以为您提供更多详细信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T22:02:43.330

我认为，每天一个元组有点矫枉过正。“停留”表上的几列就足够了。

```
stay.check_in_time_scheduled
stay.check_in_time_actual
stay.check_out_time_scheduled
stay.check_out_time_actual 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T00:41:31.763

您正在用查询简单性（可能还有性能）来权衡数据库大小

您当前的模型提供了简单的查询，因为它很容易查询客人数量、晚上 n 房间 X 的空缺等等，但数据库大小会迅速增加。

移动到开始/停止或开始/数晚模型会产生一些......有时有趣的查询:)

所以很多选择与你的 SQL 技能水平有关：)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T22:03:42.780

是否需要为一个人停留的每一天创建记录？只有当每一天都很重要时才需要，否则有一个 Customer/Guest 表来包含客户详细信息，一个 Booking 表来包含客人的预订。预订表将包含房间、开始日期、结束日期、客人（或客人）等。

如果您需要记录其他内容，例如支付的活动或膳食，请根据需要将这些内容添加到其他表格中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T22:07:14.723

减少每次停留的条目数量的一种可能方法是存储时间范围，例如开始日期和结束日期。我需要知道您针对数据运行的操作以提供更具体的建议。

一般来说，如果您需要检查有多少客户在给定日期停留，您可以使用存储过程来执行此操作。

对于某些特定操作，您的设计可能很好。即使是这种情况，我仍然会持有一个“访问”表，将客户与独特的住宿联系起来，以及一个“访问天数”表，我将在其中解决每个客户的逗留时间。

阿萨夫。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-16T01:13:12.467

我不关心图中的模式。比较难看。

**架构摘要**

**表：访问**

访问表包含在酒店住宿的每一晚的一行。

注：访问包含

*   ix访问
*   ix客户
*   dt
*   s注

**表：客户**

*   ix客户
*   名字
*   s姓

**表：留下**

停留表包括描述整个访问的一行。每次更新访问时都会更新。

*   ixStay
*   dt到达
*   dt离开
*   s注

**笔记**

Web 应用程序包含两件事：SELECT 操作和 CRUD 操作。大多数网络应用程序都是 99% 的 SELECT 和 1% 的 CRUD。规范化往往比 SELECT 更有助于 CRUD。您可能会看到我的架构并感到恐慌，但它很快。您将不得不为任何 CRUD 活动做少量额外的工作，但您的 SELECTS 会快得多，因为您的所有 SELECTS 都可以命中 Stay 表。

我喜欢 Jeff Atwood 的说法：“规范化直到它受伤，反规范化直到它起作用”

对于忙碌的酒店经理使用的网站来说，它的运行情况与运行速度一样重要。

# c++ - 动态排序的 STL 容器

> ID：67426
> 
> 赞同：11
> 
> 时间：2008-09-15T21:58:37.643
> 
> 标签：c++, stl, containers

我对 STL 相当陌生，所以我想知道是否有任何可动态排序的容器？目前，我目前的想法是将向量与各种排序算法结合使用，但我不确定是否有更合适的选择，因为将条目插入排序向量的（大概）线性复杂性。

为了“动态地”澄清，我正在寻找一个可以在运行时修改排序顺序的容器 - 例如按升序对其进行排序，然后按降序重新排序。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-15T22:01:17.153

你会想看看 std::map

```
std::map<keyType, valueType> 
```

地图根据为 keyType 提供的 < 运算符进行排序。

或者

```
std::set<valueType> 
```

也按模板参数的 < 运算符排序，但不允许重复元素。

有

```
std::multiset<valueType> 
```

它与 std::set 做同样的事情，但允许相同的元素。

我强烈推荐 Josuttis 的“C++ 标准库”以获取更多信息。它是对 std 库最全面的概述，非常易读，并且充满了晦涩和不那么晦涩的信息。

此外，正如 17 of 26 所述，Meyers 的 Effective Stl 值得一读。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-15T22:42:39.863

如果您知道要对单个值进行升序和降序排序，那么 set 是您的朋友。当您想在相反方向“排序”时使用反向迭代器。

如果您的对象很复杂，并且您将根据对象中的成员字段以多种不同的方式进行排序，那么使用向量和排序可能会更好。尝试一次完成所有插入，然后调用一次排序。如果这不可行，那么对于大型对象集合，deque 可能是比向量更好的选择。

我认为，如果您对*这种*级别的优化感兴趣，您最好使用实际数据来分析您的代码。（这可能是这里任何人都可以给出的最好建议：如果您只在蓝月亮中执行一次，那么在每次插入之后调用 sort 可能并不重要。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-16T00:15:03.840

听起来您想要一个[多索引容器](http://www.boost.org/doc/libs/1_36_0/libs/multi_index/doc/index.html)。这允许您创建一个容器并告诉该容器您可能想要遍历其中的项目的各种方式。然后容器保留多个项目列表，并且这些列表在每次插入/删除时更新。

如果您真的想对容器重新排序，您可以[`std::sort`](http://www.sgi.com/tech/stl/sort.html)在任何`std::deque`、`std::vector`甚至是简单的 C 样式数组上调用该函数。该函数采用可选的第三个参数来确定如何对内容进行排序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T22:39:38.403

`stl`没有提供这样的容器。您可以定义自己的，由 a`set/multiset`或 a支持，但是每次排序函数通过调用（for a ）或创建新集合（for ）`vector`更改时，您都必须重新排序。`sort``vector``set/multiset`

如果您只想从递增排序顺序更改为递减排序顺序，您可以通过调用`rbegin()`and`rend()`而不是`begin()`and来在容器上使用反向迭代器`end()`。两者`vector`和`set/multiset`都是可逆容器，因此这对任何一个都适用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T21:59:40.280

`std::set`基本上是一个排序的容器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T22:11:00.470

您绝对应该使用集合/地图。就像 hazzen 所说，你得到 O(log n) 插入/查找。你不会用排序的向量得到这个；您可以使用二进制搜索获得 O(log n) 查找，但插入是 O(n)，因为插入（或删除）一个项目可能会导致向量中的所有现有项目都被移动。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T22:21:29.370

没那么简单。根据我的经验，插入/删除的使用频率低于查找。排序向量的优点是它占用更少的内存并且对缓存更友好。如果碰巧有与 STL 地图兼容的版本（就像我之前链接的那个），那么很容易来回切换并为每种情况使用最佳容器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T22:28:11.647

理论上，关联容器（set、multiset、map、multimap）应该是您的最佳解决方案。

在实践中，它取决于您放入的元素的平均数量。对于少于 100 个元素，向量可能是最好的解决方案，因为： - 避免连续分配 - 释放 - 由于数据局部性而缓存友好 这些优势可能仍然会胜过连续排序。显然，它还取决于您必须执行多少次插入删除。您要进行每帧插入/删除吗？

更一般地说：您是在谈论性能关键型应用程序吗？

切记不要过早优化...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T23:39:27.123

答案总是视情况而定。

`set`并且`multiset`适用于保持项目排序，但通常针对一组平衡的添加、删除和获取进行优化。如果您有男子气概的查找操作，那么 sorted`vector`可能更合适，然后用于`lower_bound`查找元素。

此外，您在运行时以不同顺序使用的第二个要求实际上意味着`set`并且`multiset`不合适，因为谓词不能在运行时修改。

因此，我会推荐一个排序的向量。但是请记住将相同的谓词`lower_bound`传递给您传递给前一个排序的谓词，因为如果您传递了错误的谓词，结果将是未定义的并且很可能是错误的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-10-04T19:35:04.513

Set 和 multiset 使用底层的二叉树；您可以定义 <= 运算符供您自己使用。这些容器保持自己排序，因此如果您要切换排序参数，可能不是最佳选择。如果您要使用很多方法，则向量和列表可能是最好的；一般来说，列表有它自己的排序（通常是合并排序），你可以在向量上使用 stl 二进制搜索算法。如果插入占主导地位，则列表优于向量。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T22:01:42.067

STL 映射和集合都是排序容器。

我支持 Doug T 的书籍推荐 - Josuttis STL 书籍是我所见过的最好的学习和参考书。

[《 Effective STL](https://rads.stackoverflow.com/amzn/click/com/0201749629)》也是一本学习STL内部细节以及你应该做什么和不应该做什么的好书。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T22:05:26.553

[对于“STL 兼容”排序向量，请参见Loki](http://loki-lib.sourceforge.net/)中的 A. Alexandrescu 的 AssocVector 。

# python - 在 Django 中提供动态生成的 ZIP 档案

> ID：67454
> 
> 赞同：67
> 
> 时间：2008-09-15T22:00:31.540
> 
> 标签：python, django

如何在 Django 中为用户提供动态生成的 ZIP 存档？

我正在创建一个站点，用户可以在其中选择可用书籍的任意组合并将它们下载为 ZIP 存档。我担心为每个请求生成这样的档案会减慢我的服务器速度。我还听说 Django 目前没有很好的解决方案来提供动态生成的文件。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-09-16T13:30:56.950

解决方法如下。

使用 Python 模块[zipfile](https://docs.python.org/3/library/zipfile.html)创建 zip 存档，但作为文件指定[StringIO](https://docs.python.org/3/library/io.html#io.StringIO)对象（ZipFile 构造函数需要类似文件的对象）。添加要压缩的文件。然后在您的 Django 应用程序中返回 StringIO 对象的内容，并将`HttpResponse`mimetype 设置为`application/x-zip-compressed`（或至少`application/octet-stream`）。如果你愿意，你可以设置`content-disposition`标题，但这不应该是真正需要的。

但请注意，在每个请求上创建 zip 存档是个坏主意，这可能会杀死您的服务器（如果存档很大，则不计算超时）。性能方面的方法是将生成的输出缓存在文件系统中的某处，并仅在源文件发生更改时重新生成它。更好的主意是提前准备档案（例如，通过 cron 作业）并让您的 Web 服务器像往常一样为它们提供服务。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-10-18T09:32:10.023

这是执行此操作的 Django 视图：

```
import os
import zipfile
import StringIO

from django.http import HttpResponse

def getfiles(request):
    # Files (local path) to put in the .zip
    # FIXME: Change this (get paths from DB etc)
    filenames = ["/tmp/file1.txt", "/tmp/file2.txt"]

    # Folder name in ZIP archive which contains the above files
    # E.g [thearchive.zip]/somefiles/file2.txt
    # FIXME: Set this to something better
    zip_subdir = "somefiles"
    zip_filename = "%s.zip" % zip_subdir

    # Open StringIO to grab in-memory ZIP contents
    s = StringIO.StringIO()

    # The zip compressor
    zf = zipfile.ZipFile(s, "w")

    for fpath in filenames:
        # Calculate path for file in zip
        fdir, fname = os.path.split(fpath)
        zip_path = os.path.join(zip_subdir, fname)

        # Add file, at correct path
        zf.write(fpath, zip_path)

    # Must close zip for all contents to be written
    zf.close()

    # Grab ZIP file from in-memory, make response with correct MIME-type
    resp = HttpResponse(s.getvalue(), mimetype = "application/x-zip-compressed")
    # ..and correct content-disposition
    resp['Content-Disposition'] = 'attachment; filename=%s' % zip_filename

    return resp 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2018-03-11T12:32:41.990

这里的许多答案建议使用 a`StringIO`或`BytesIO`缓冲区。然而，这不是必需的，因为`HttpResponse`它已经是一个类似文件的对象：

```
response = HttpResponse(content_type='application/zip')
zip_file = zipfile.ZipFile(response, 'w')
for filename in filenames:
    zip_file.write(filename)
response['Content-Disposition'] = 'attachment; filename={}'.format(zipfile_name)
return response 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-08-02T13:56:38.903

我使用**了 Django 2.0**和**Python 3.6**。

```
import zipfile
import os
from io import BytesIO

def download_zip_file(request):
    filelist = ["path/to/file-11.txt", "path/to/file-22.txt"]

    byte_data = BytesIO()
    zip_file = zipfile.ZipFile(byte_data, "w")

    for file in filelist:
        filename = os.path.basename(os.path.normpath(file))
        zip_file.write(file, filename)
    zip_file.close()

    response = HttpResponse(byte_data.getvalue(), content_type='application/zip')
    response['Content-Disposition'] = 'attachment; filename=files.zip'

    # Print list files in zip_file
    zip_file.printdir()

    return response 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-10-17T00:10:09.437

对于 python3，我使用**io.ByteIO**，因为不推荐使用**StringIO**来实现这一点。希望能帮助到你。

```
import io

def my_downloadable_zip(request):
    zip_io = io.BytesIO()
    with zipfile.ZipFile(zip_io, mode='w', compression=zipfile.ZIP_DEFLATED) as backup_zip:
        backup_zip.write('file_name_loc_to_zip') # u can also make use of list of filename location
                                                 # and do some iteration over it
     response = HttpResponse(zip_io.getvalue(), content_type='application/x-zip-compressed')
     response['Content-Disposition'] = 'attachment; filename=%s' % 'your_zipfilename' + ".zip"
     response['Content-Length'] = zip_io.tell()
     return response 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-15T22:09:50.130

Django 不直接处理动态内容（特别是 Zip 文件）的生成。这项工作将由 Python 的标准库完成。[您可以在此处](https://docs.python.org/2/library/zipfile.html#zipfile-objects)查看如何在 Python 中动态创建 Zip 文件。

如果您担心它会减慢您的服务器，如果您希望有许多相同的请求，您可以缓存这些请求。你可以使用 Django 的[缓存框架](http://docs.djangoproject.com/en/dev/topics/cache/#topics-cache)来帮助你。

总的来说，压缩文件可能是 CPU 密集型的，但 Django 不应该比另一个 Python Web 框架慢。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-10-30T16:24:34.923

无耻插件：您可以将[django-zipview](https://github.com/thibault/django-zipview)用于相同目的。

之后`pip install django-zipview`：

```
from zipview.views import BaseZipView

from reviews import Review

class CommentsArchiveView(BaseZipView):
    """Download at once all comments for a review."""

    def get_files(self):
        document_key = self.kwargs.get('document_key')
        reviews = Review.objects \
            .filter(document__document_key=document_key) \
            .exclude(comments__isnull=True)

        return [review.comments.file for review in reviews if review.comments.name] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-16T15:31:39.267

我建议使用单独的模型来存储这些临时 zip 文件。您可以即时创建 zip，使用文件字段保存到模型，最后将 url 发送给用户。

好处：

*   使用 django 媒体机制提供静态 zip 文件（如通常的上传）。
*   能够通过定期执行 cron 脚本（可以使用 zip 文件模型中的日期字段）来清理过时的 zip 文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-11-14T03:57:25.697

已经对这个主题做出了很多贡献，但是自从我第一次研究这个问题时遇到了这个线程，我想我会添加我自己的两分钱。

集成您自己的 zip 创建可能不如 Web 服务器级解决方案强大和优化。同时，我们使用的是 Nginx，它没有开箱即用的模块。

但是，您可以使用 mod_zip 模块编译 Nginx（请参阅[此处](https://hub.docker.com/r/yspreen/nginx)以获取具有最新稳定 Nginx 版本的 docker 映像，以及使其小于默认 Nginx 映像的 alpine 基础）。这增加了 zip 流功能。

然后 Django 只需要提供一个要压缩的文件列表，就完成了！为这个文件列表响应使用一个库更可重用，而 django-zip-stream 提供了这一点。

遗憾的是，它从来没有真正对我有用，所以我开始了一个带有修复和改进的[分支。](https://github.com/y-spreen/django-zip-stream)

您可以在几行中使用它：

```
def download_view(request, name=""):
    from django_zip_stream.responses import FolderZipResponse
    path = settings.STATIC_ROOT
    path = os.path.join(path, name)

    return FolderZipResponse(path) 
```

您需要一种方法让 Nginx 为您要归档的所有文件提供服务，但仅此而已。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-15T22:03:03.593

你不能只写一个“压缩服务器”的链接或诸如此类的东西吗？为什么 zip 存档本身需要从 Django 提供？一个 90 年代的 CGI 脚本生成一个 zip 并将其发送到标准输出是这里真正需要的，至少据我所知。

# c# - 如何使用 C# 在具有透明背景的窗口中显示网页？

> ID：67457
> 
> 赞同：0
> 
> 时间：2008-09-15T22:00:43.037
> 
> 标签：c#, .net, winforms, webbrowser-control, transparency

如何在透明窗口中显示网页并使网页的白色部分也透明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T22:04:37.770

如果您使用的是浏览器控件，则其中可能有一个属性可以将背景颜色更改为透明或使用 Alpha 通道分层。我不完全确定这会有多有效，但值得一试。

要考虑的另一件事是为您尝试查看的网页 HTML 创建一个小型解析器，然后您可以修改样式表或更改背景颜色。但是，我不确定您是否可以使页面透明。这一切都在我的脑海中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T22:34:52.097

BackColor 属性有一个 alpha 属性，它与 opacity 相同。如果是纯 html，则应该有 opacity 属性或样式。

# user-interface - 设计规则系统的良好参考/提示？

> ID：67475
> 
> 赞同：6
> 
> 时间：2008-09-15T22:02:54.653
> 
> 标签：user-interface, filtering, dsl, rules

我经常需要实现某种用户可编辑的规则系统——需求通常不同，以至于同一个系统不能直接适用，所以我经常遇到同样的问题——我如何设计一个规则系统那

1.  是可维护的
2.  恰当地平衡表现力和易用性
3.  很容易扩展（如果/当我得到（2）错误时）。

我认为规则系统/DSL 非常有价值，但我对自己正确设计它们的能力感到不舒服。

您必须提供哪些参考/提示可以帮助简化此操作？
由于我遇到的问题的性质，现有语言通常不适用。（例如，您*不需要*普通计算机用户学习 python 来编写电子邮件过滤器。）类似地，规则*语言*，如[JESS](http://herzberg.ca.sandia.gov/)，只是部分解决方案，因为需要构建一些（更简单的）用户界面- 规则语言的顶部，以便非程序员可以使用它。该界面总是涉及删除某些功能，或者使这些功能更难使用，并且该[过程](http://herzberg.ca.sandia.gov/)会带来与上述相同的问题。

*编辑：*澄清一下，问题是关于*设计*规则引擎，我不是在寻找预先构建的规则引擎。如果您建议使用规则引擎，请解释它如何解决有关做出良好设计决策的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T10:37:37.683

我们有这个工具的供应商的内部演示： [http ://www.rulearts.com/rulexpress.php](http://www.rulearts.com/rulexpress.php)

作为一家公司，我们在规则引擎（例如 Cleverpath Aion）方面拥有丰富的经验，但主要是面向开发人员的工具。这个工具（rulexpress）非常面向商务人士。它不是规则引擎。但它可以输出 xml 中的所有数据（所以基本上是您喜欢的任何格式），然后我们会考虑将其作为真正规则引擎的输入，例如 Windows Workflow Foundation（不是更大/更好的规则引擎之一，但是仍然）。

该工具本身看起来相当不错，这是我在任何面向开发人员的工具中从未见过的一些东西。

还有一些围绕 WF 构建的规则管理工具，如果这是您选择的规则引擎，请查看 InRule。

* * *

在澄清原始问题后进行编辑：虽然我很久以前就涉足过这个（在 javacc 中编写了一点语言），但我现在认为这是一个糟糕的时间投资。我上面的评论是本着同样的精神：采用一个简单的规则引擎，一个简单的（商业）UI，使业务用户易于维护，并且只花时间将两者结合在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T22:04:55.883

我们很幸运：http: [//msdn.microsoft.com/en-us/library/bb472424.aspx](http://msdn.microsoft.com/en-us/library/bb472424.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T10:01:25.227

First of all, normally it is not advised to let end-users define the rules. That's because they do not have development background and could simply write "code" that goes into infinite loop or does other weird things.

So either the system has to protect against that kind of behavior (thus, making it more complex), accept such possibility, or disallow end-users to do this.

If you are working with .NET then it is hideously easy to create your own DSL by extending the Boo compiler (i.e. with Rhino.DSL you can have simple DSL with one class).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T22:05:20.390

要考虑的 Ruby 实现是 Ruleby ( [http://ruleby.org/wiki/Ruleby](http://ruleby.org/wiki/Ruleby) )

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T22:07:55.860

我发现的一件事是能够将规则定义为表达式树使得实现变得如此简单。正如您正确提到的，项目之间的需求是如此不同，以至于您每次都必须重新实现。表达式树与访问者模式之类的东西相结合，构成了一个易于扩展的非常（没有双关语）表达性框架。而且您可以轻松地将一个非常动态的 GUI 放在满足您需求的那方面的表达式树之上。

希望这听起来不像我说的一切看起来都像我的锤子上的钉子，因为事实并非如此......只是根据我的经验，这已经派上用场不止一次了:-)

# c# - 按照简单模式初始化一个包含 N 个数字的数组的最简单方法是什么？

> ID：67492
> 
> 赞同：4
> 
> 时间：2008-09-15T22:04:53.183
> 
> 标签：c#

假设从 9 开始可以被 3 整除的前 N ​​个整数。

我确信有一些使用 lambdas 的单行解决方案，我只是对语言的那个领域还不够了解。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T22:41:35.590

使用 Linq：

```
int[] numbers =
    Enumerable.Range(9,10000)
    .Where(x => x % 3 == 0)
    .Take(20)
    .ToArray(); 
```

如果您需要，也可以使用 Plinq 轻松并行化：

```
int[] numbers =
    Enumerable.Range(9,10000)
    .AsParallel()             //added this line
    .Where(x => x % 3 == 0)
    .Take(20)
    .ToArray(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T23:51:14.677

只是为了与众不同（并避免使用 where 语句），您还可以这样做：

```
var numbers = Enumerable.Range(0, n).Select(i => i * 3 + 9); 
```

**更新**这还具有不会用完数字的好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T22:38:55.240

```
const int __N = 100;
const int __start = 9;
const int __divisibleBy = 3;

var array = Enumerable.Range(__start, __N * __divisibleBy).Where(x => x % __divisibleBy == 0).Take(__N).ToArray(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T22:47:29.977

```
int n = 10; // Take first 10 that meet criteria
int[] ia = Enumerable
              .Range(0,999)
              .Where(a => a % 3 == 0 && a.ToString()[0] == '9')
              .Take(n)
              .ToArray(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T23:28:20.253

我想看看这个解决方案如何与上述 Linq 解决方案叠加。`(q % m)`这里的技巧是使用起始集合`s`是`(s + (s % m) + m*n)`（其中 n 表示集合中的第 n 个值）这一事实来修改谓词。在我们的例子`s=q`中。

此解决方案的唯一问题是它具有使您的实现依赖于您选择的特定模式的副作用（并非所有模式都有合适的谓词）。但它有以下*优点*：

1.  总是在恰好 n 次迭代中运行
2.  永远不会像上面提出的解决方案那样失败（对有限的`Range`）。

此外，无论您选择哪种模式，您总是需要修改谓词，因此您不妨使其在数学上高效：

```
static int[] givemeN(int n)
{
    const int baseVal = 9;
    const int modVal = 3;

    int i = 0;
    return Array.ConvertAll<int, int>(
        new int[n],
        new Converter<int, int>(
            x => baseVal + (baseVal % modVal) + 
                ((i++) * modVal)
        ));
} 
```

编辑：我只想说明如何使用此方法`delegate`来改进代码重用：

```
static int[] givemeN(int n, Func<int, int> func)
{
    int i = 0;
    return Array.ConvertAll<int, int>(new int[n], new Converter<int, int>(a => func(i++)));
} 
```

您可以将它与`givemeN(5, i => 9 + 3 * i)`. 再次注意我修改了谓词，但您也可以使用最简单的模式来做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T22:14:46.653

我不能说这有什么好处，我不是 C# 专家，我只是把它搞砸了，但我认为这可能是使用`yield`.

```
internal IEnumerable Answer(N)
{
  int n=0;
  int i=9;
  while (true)
  {
    if (i % 3 == 0)
    {
      n++;
      yield return i;
    }

    if (n>=N) return;
    i++;
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T22:16:56.320

您必须遍历 0 或 1 到 N 并手动添加它们。或者，您可以只创建函数 f(int n)，然后在该函数中，将结果缓存在会话或全局哈希表或字典中。

伪代码，其中 ht 是全局 Hashtable 或 Dictionary （强烈推荐后者，因为它是强类型的。

```
public int f(int n)
{
  if(ht[n].containsValue)
    return ht[n];
  else
  {
    //do calculation
    ht[n] = result;
    return result;
   }
} 
```

只是一个旁注。如果你一直在做这种类型的函数式编程，你可能想看看 F#，甚至可能是 Iron Ruby 或 Python。

# asp.net - ASP.NET 2.0：皮肤文件仅在放置在根主题文件夹时才有效？

> ID：67499
> 
> 赞同：3
> 
> 时间：2008-09-15T22:06:22.277
> 
> 标签：asp.net, themes

我发现皮肤文件只有放在 App_Themes 文件夹中的根主题文件夹中才能工作。

例如，如果您在 App_Themes 文件夹中有 2 个主题，则不能将另一个子文件夹添加到主题文件夹并在该子文件夹中放置单独的皮肤文件。

这不是一个很大的限制，但它会给你更多的灵活性来进一步定制一个应用程序。

任何人都可以阐明为什么会像在 2.0 中那样发生这种行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T12:02:13.903

你的皮肤文件应该有扩展名 .skin 吗？我总是称它们为 theme.skin 并给它们与文件夹相同的名称。例如在主题 col2 中，文件夹是

App_Themes\col2 并包含 css 和 col2.skin

[微软](http://msdn.microsoft.com/en-us/library/ms247256(VS.80).aspx)是您最好的参考：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T12:16:57.987

ASP.Net 中的主题不提供从“子主题”中选择的能力。

但是，您可以在皮肤文件中设置 SkinID。例如，在您的 .skin 中：

```
<asp:DataList runat="server" SkinID="DataListColor" Width="100%">
  <ItemStyle BackColor="Blue" ForeColor="Red" />
</asp:DataList>

<asp:DataList runat="server" SkinID="DataListSmall" Width="50%">
</asp:DataList> 
```

然后，当您想要调用其中一个时，您只需指定您想要的数据列表的 SkinID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-15T18:31:36.207

改变这种行为的唯一方法是通过**VirtualPathProvider** - 类似于：http: [//www.neovolve.com/page/ASPNet-Virtual-Theme-Provider-10.aspx](http://www.neovolve.com/page/ASPNet-Virtual-Theme-Provider-10.aspx)

# keyboard - 用于自定义基于 Dvorak 的编程布局的最佳键盘

> ID：67512
> 
> 赞同：20
> 
> 时间：2008-09-15T22:08:07.280
> 
> 标签：keyboard, dvorak

我正在考虑切换到基于 Dvorak 的键盘布局，但一种针对编程（主要是）Java 和 python（例如[DDvorak](http://www.siteuri.ro/dvorak/DDvorak.aspx)、[Programmer Dvorak](http://www.kaufmann.no/roland/dvorak/)等）进行了优化。什么样的键盘最适合这样的工作？我会考虑自然键盘或直接键盘。

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-15T22:33:58.357

我*强烈*建议您不要学习针对任何一种编程语言（甚至其中的一类）进行了高度优化的布局。更改语言比键布局要容易得多，而且您很难找到在您需要使用的任何随机计算机上调整布局。

[也就是说，我已经在Kinesis Contoured 键盘](http://www.kinesis-ergo.com/contoured.htm)上使用了 dvorak 多年（现在大概是 7-8 年），而且效果非常好。kinesis 是可编程的，可以在 qwerty/dvorak 之间切换，并且您可以根据需要重新映射键（因此您可以很容易地尝试 ddvorak 或程序员 dvorak，如果需要，无需更改软件）。

轮廓键盘还迫使您更“正确”地触摸打字，因为您不能用错误的手轻松地触碰键盘。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-16T23:23:18.620

[类型矩阵](http://www.typematrix.com/)

[![替代文字](https://i.stack.imgur.com/MZPlt.jpg)](https://i.stack.imgur.com/MZPlt.jpg)
[（来源：[typematrix.com](http://www.typematrix.com/images/skins/blank_keyb_dvorak_skin_640x275.jpg)）]

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-18T06:03:55.620

纯香草德沃夏克是最好的恕我直言。是的，它确实将 3 或 4 个键（例如 {}: 等）移开，但是您很快就会在新位置上习惯它们，并且在一段时间后它根本没有任何可能性。

回报来自能够使用任何随机的电脑 - 将键盘布局轻弹到标准 dvorak（几乎在所有电脑上，与大多数晦涩的程序员布局不同），然后你就走了。如果您习惯了非标准的 dvorak 布局，并且被迫在带有 qwerty 标签的键盘上使用正常的 dvorak 布局，我怀疑您会遇到大量的退格（和诅咒词）。

我只使用 dvorak 几年，但我无法想象使用其他任何东西进行编程。（特别是使用 vim，dvorak 布局似乎最终在更方便的位置有很多键 =）

哦，如上所述 - 如果您正在考虑更改 RSI 问题的布局，kinesis 轮廓键盘是您的最佳选择。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-11-30T07:04:03.133

我认为[ErgoDox](http://ergodox.org/ "ergodox.org")可能是最好的选择。您过去必须订购组件并自己构建，但现在您可以购买组装好的。这是完成后的样子：

![ErgoDox](https://i.stack.imgur.com/q8Frs.jpg)

我认为 ErgoDox 是最好的选择。显然[DataHand](http://www.datahand.com/)也支持 Dvorak，但我认为它的学习曲线会非常陡峭：

![数据手](https://i.stack.imgur.com/l9u26.jpg)

总的来说，ErgoDox 的组件通常运行大约 250 美元，尽管它的制造成本肯定低于此。我认为 DataHand 的价格约为 800 美元。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T01:09:35.907

任何“普通”键盘都应该非常适合 dvorak，包括简单的符合人体工程学的（分成两半）键盘。一些更深奥的分体式人体工程学键盘，虽然分体不均，但可能会导致 dvorak 加权手指使用的方式出现问题。

如果您要学习 dvorak，我个人会避免使用普通的 dvorak，因为它会将编程中常用的标点符号（如括号、括号、大括号等）移到离手太远的地方：有许多“程序员 dvorak”那里的实现为这种“监督”调整了 dvorak。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T19:34:49.250

我开始这篇文章是为了回复[汤姆的帖子](https://stackoverflow.com/questions/67512/best-keyboard-for-custom-dvorak-based-programming-layout/67544#67544)，但它有点长。

我在切换到 Dvorak 布局的同时学会了触摸打字，发现使用 qwerty 键盘有很大帮助。它阻止了我低头看键盘的冲动。如果您要触摸类型并学习触摸类型比更改为 dvorak 更重要，则没有理由需要标签。

现在我正在使用[Programmers Dvorak](http://www.kaufmann.no/roland/dvorak/index.html)布局，我对它进行了轻微修改，发现它比 qwerty 更容易。

我最近发现了 Developer's Dvorak，但认为这对我来说太不同了，在仍然能够使用普通 dvorak 的同时学习。它改变了元音的位置和大约一半的其他键。

如果您计划使用与标准相去甚远的自定义键盘布局，那么最好有类似[便携式键盘布局](http://pkl.sourceforge.net/)的东西，您可以将其放入便携式驱动器以在任何 [windows] 计算机上使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T22:13:19.823

您使用自然键盘还是直接键盘？键盘偏好可能非常个人化，但许多高端键盘都有专门针对按键位置（倾斜和曲率）安装的按键，这意味着对于 Dvorak，您需要忽略标签，移动按键并消除该优势，或者使用[空白 das 键盘](http://www.daskeyboard.com/)之类的东西

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-18T11:34:42.280

我的键盘界兄弟。我想我在键盘编程方面找到了圣杯。看看保留键盘布局的键盘。我有一个自定义的 Dvorak 键盘布局，不是专门用于编程，主要用于论文写作。虽然我经常编程。这在其大脑中保留了可编程宏。它有 24 个功能按钮。而且它有机械开关（如果它有樱桃蓝色或弯曲那将是完美的，它目前运动阿尔卑斯山，一点也不坏）。它基于著名的 Northgate 万能键。

CVT Avanat 斯特拉 [http://www.theregister.co.uk/2005/11/07/avant_keyboard_review/](http://www.theregister.co.uk/2005/11/07/avant_keyboard_review/)

另一方面，使用 IBM Workstation 你可以便宜 150 美元，其传奇的屈曲弹簧设计是打字员的圣杯。它的 24 多个功能按钮应该很有用。再加上它的复古美感是任何极客都会喜欢的东西。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-19T04:23:36.543

虽然通过软件切换键盘格式很容易解决，但拥有像 Typematrix 这样的键盘会有很大帮助。我已经使用 Typematrix 2030 4 年了，拥有 2 个板。一种用于工作，另一种用于家庭使用。我现在可以使用任何我想要的键盘，但 typematrix 绝对更舒适、更及时。如果您还不知道如何打字，这款键盘附带的软件将帮助您学习德沃夏克语。

# apache-flex - Flex：如何为 TabNavigator 组件添加选项卡关闭按钮

> ID：67516
> 
> 赞同：7
> 
> 时间：2008-09-15T22:08:43.347
> 
> 标签：apache-flex, actionscript-3

我想要一个`TabNavigator`组件，其中包含一些选项卡的关闭按钮。我怎么做？
似乎该`TabNavigator`组件不允许（或我找不到）这种形式的可扩展性。帮助。谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-15T23:51:26.500

您应该看一下[FlexLib](http://code.google.com/p/flexlib/)项目中的 SuperTabNavigator 组件：

*   [SuperTabNavigator 示例](http://flexlib.googlecode.com/svn/trunk/examples/SuperTabNavigator_Sample.swf)
*   [SuperTabNavigator 文档](http://flexlib.googlecode.com/svn/trunk/docs/flexlib/containers/SuperTabNavigator.html)
*   [FlexLib 组件列表](http://code.google.com/p/flexlib/wiki/ComponentList)

如果您不希望所有选项卡都有关闭按钮（我从问题中了解到您没有），看起来您可以使用[setClosePolicyForTab()](http://flexlib.googlecode.com/svn/trunk/docs/flexlib/containers/SuperTabNavigator.html#setClosePolicyForTab())方法来指定您希望拥有哪些选项卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-09T04:53:25.927

基于 Spark 的组件

[**flexwiz** spark-tabs-with-close-button](http://blog.flexwiz.net/spark-tabs-with-close-button/)

# windows - Windows 和 gvim 中的多个选项卡

> ID：67518
> 
> 赞同：9
> 
> 时间：2008-09-15T22:09:39.520
> 
> 标签：windows, vim, tabs

我正在尝试获取`Edit with Vim`上下文菜单以在先前打开的 Gvim 实例（如果有）的新选项卡中打开文件。

目前，使用`Regedit`我已经修改了这个键：

```
\HKEY-LOCAL-MACHINE\SOFTWARE\Vim\Gvim\path = "C:\Programs\Vim\vim72\gvim.exe" -p --remote-tab-silent "%*" 
```

注册表项类型是`REG_SZ`.

这几乎可以工作......目前它在新选项卡中打开文件，但它也打开另一个选项卡（这是活动选项卡），该选项卡被标记`\W\S\--literal`并且文件似乎正在尝试打开以下文件。

```
C:\Windows\System32\--literal 
```

我认为问题出在`"%*"`- 我尝试将其更改为，`"%1"`但如果我这样做，我会得到一个名为`%1`.

**受影响的版本**

*   Vim 7.2 版（在 7.1 上的行为相同）
*   Windows Vista 家庭高级版

谢谢你的帮助。

大卫。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-16T06:54:38.120

尝试将其设置为： "C:\Programs\Vim \vim72\gvim.exe" -p --remote-tab-silent "%1" "%*"

见：[http ://www.vim.org/tips/tip.php?tip_id=1314](http://www.vim.org/tips/tip.php?tip_id=1314)

编辑：正如 Thomas 所指出的，vim.org 提示移至：http: [//vim.wikia.com/](http://vim.wikia.com/)

见：http: [//vim.wikia.com/wiki/Add_open-in-tabs_context_menu_for_Windows](http://vim.wikia.com/wiki/Add_open-in-tabs_context_menu_for_Windows)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T23:10:57.027

我找到了答案…… cream 的链接给了我一些额外的搜索区域。

来自[http://genotrance.wordpress.com/2008/02/04/my-vim-customization/](http://genotrance.wordpress.com/2008/02/04/my-vim-customization/)有一个 vim.reg 注册表文件，其中包含以下内容

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\*\shell\Edit with Vim]
@=""

[HKEY_CLASSES_ROOT\*\shell\Edit with Vim\command]
@="\"C:\\Programs\\vim\\vim72\\gvim.exe\" -p --remote-tab-silent \"%1\" \"%*\""

[HKEY_CLASSES_ROOT\Applications\gvim.exe\shell\open\command]
@="\"C:\\Programs\\vim\\vim72\\gvim.exe\" -p --remote-tab-silent \"%1\" \"%*\"" 
```

这给了我想要的行为。

所以我猜我最初编辑 HKEY_LOCAL_MACHINE 的计划是错误的。

也很高兴知道“%1”和“%*”到底是什么意思/指的。

现在...我应该编辑我原来的问题，以表明我是从错误的注册表区域开始的吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-12T22:25:46.997

你走在正确的轨道上：

```
HKEY-LOCAL-MACHINE\SOFTWARE\Vim\Gvim\path = "C:\Programs\Vim \vim72\gvim.exe" -p 
```

足够了......它的工作原理！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T09:10:17.250

我会推荐尝试[奶油](http://cream.sourceforge.net/index.html)。

Cream 是一组位于 gVim 之上的脚本和附加组件。Cream 不会改变 gVim 的外观，但会改变它的行为方式。

其中一种行为是选项卡式文档界面。[此处](http://cream.sourceforge.net/featurelist.html)列出了其他行为。下载页面在[这里](http://cream.sourceforge.net/download.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-18T10:29:56.917

使用您的`_vimrc`. 添加以下行：
`autocmd BufReadPost * tab ball`
来自[http://www.vim.org/scripts/script.php?script_id=1720](http://www.vim.org/scripts/script.php?script_id=1720)

# flash - 如何将网络摄像头录制到 flv 并流畅播放

> ID：67536
> 
> 赞同：2
> 
> 时间：2008-09-15T22:11:32.077
> 
> 标签：flash, webcam, red5

我希望我的网站使用网络摄像头记录 flvs。这些 flv 需要流畅播放，以便之后我可以使用它们，例如将它们转码为 avis。

我尝试了许多不同的服务器来处理 flv 录制。例如，生成的 flv 在 Wimpy FLV 播放器中可以正常播放，只是进度指示器的移动不顺畅或不规律。这表明有问题，如果我尝试使用“ffmpeg -i input.flv output.avi”（带或不带帧速率选项“-r 15”）对它们进行转码，我不会得到正确的 avi。

这是我尝试过的以及遇到的问题：

1.  使用[red5](http://osflash.org/red5)（v 0.6.3 和 0.7.0，在 OS X 10.5.4 和 Ubuntu 8.04 上）和它包含的 publisher.html 示例。这是[生成的 flv](http://www.marc-andre.ca/posts/blog/webcam/test-red5-publisher.flv)。指标非常迅速地跳向终点。

2.  仍在使用 red5，但发布“实时”并在几秒钟后开始录制。我使用[了这些示例文件](http://sziebert.net/posts/server-side-stream-recording-with-red5/)。这是[生成的 flv](http://www.marc-andre.ca/posts/blog/webcam/test-red5-live-sziebert.flv)。指标还是跳的很快，用这个方法一点声音都没有……

3.  使用[Wowza Media Server Pro](http://www.wowzamedia.com/products.html)（v 1.5.3，在我的 Mac 上）。进度指示器不会跳到最后，但它在一开始就移动得更快。这足以使使用 ffmpeg 转换为其他格式会使视觉与音频不正确同步。只是为了确保我尝试了[它附带的录像机，](http://www.marc-andre.ca/posts/blog/webcam/test-wowza.flv)以及使用 red5 的 publisher.html（[结果相同](http://www.marc-andre.ca/posts/blog/webcam/test-wowza-publisher.flv)）。

4.  [通过在www.influxis.com](http://www.influxis.com)上托管的帐户使用 Flash Media Server 3 。我得到了另一种进展模式。进度指示器在开始时有点跳跃，然后变得有规律。这是[一个例子](http://www.marc-andre.ca/posts/blog/webcam/test-influxis.flv)。

我知道可以录制“完美”的 flv，因为 facebook 的视频应用程序可以做到这一点（使用 red5？）事实上，查看 facebook 视频的 HTML 源并获取 http URL 以下载他们制作的 flv 很容易。在 Wimpy 中播放时，进度指示器很流畅，使用“ffmpeg -i facebook.flv -r 15 facebook.avi”进行转码会产生良好的 avi。这是[一个例子](http://www.marc-andre.ca/posts/blog/webcam/test-facebook.flv)。

那么，我能否设法获得具有恒定帧率的好 flv？

PS：服务器必须可以安装在 Linux 上，或者可以在价格合理的托管服务提供商处获得。

编辑：正如所指出的，也许问题不在于帧率，而在于其他问题。我对视频不了解，也不知道如何检查我提供的示例以进行检查；也许有人可以对此有所了解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-20T16:36:52.703

查看您在[richflv](http://www.richapps.de/?p=66)（非常方便的flv 编辑工具）中的red5 示例flv，我们可以看到您有常规关键帧，但未设置持续时间元数据。

facebook 示例 flv 几乎没有任何关键帧（这意味着您无法在其中很好地“搜索”），但是元数据持续时间是正确的。

我会研究 flvtool2 和 flvtool++（对于长文件来说，这是一种内存效率更高的替代方案）以插入正确的元数据后捕获。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T22:16:41.767

您的问题可能不在于帧速率，而在于关键帧和标记。

# c++ - Windows 上最好的免费 C++ 分析器是什么？

> ID：67554
> 
> 赞同：233
> 
> 时间：2008-09-15T22:15:11.363
> 
> 标签：c++, windows, profile

我正在寻找探查器以找到我的 C++ 代码中的瓶颈。我想找到一个免费的、非侵入式的、好的分析工具。我是一名游戏开发人员，我在 Xbox 360 上使用 PIX，发现它非常好，但它不是免费的。我知道 Intel [VTune](https://en.wikipedia.org/wiki/VTune)，但它也不是免费的。

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2008-09-15T22:18:51.870

[CodeXL](https://gpuopen.com/archived/legacy-codexl/)现在已经取代 End Of Line'd [AMD Code Analyst](https://web.archive.org/web/20120607044224/http://developer.amd.com/tools/CodeAnalyst/Pages/default.aspx)，两者都是免费的，但不如 VTune 先进。

还有[Sleepy](http://www.codersnotes.com/sleepy/)，它非常简单，但在很多情况下都能胜任。

注意：**上述所有三个工具几年以来都没有维护过。**

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2010-06-07T14:38:03.363

[Very Sleepy](http://www.codersnotes.com/sleepy/)是一个适用于 Windows 系统的 C/C++ CPU 分析器（免费）。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-11-01T15:43:51.180

Proffy 很酷： [http ://pauldoo.com/proffy/](http://pauldoo.com/proffy/)

免责声明：我写了这个。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-01-24T05:50:02.910

有一个用于 MS VC 7.1 及更高版本的检测（功能精确）分析器，称为 MicroProfiler。[您可以在此处 (x64)](http://visualstudiogallery.msdn.microsoft.com/133d5764-b32b-4ec9-8ee8-5546eca64584)或[此处 (x86)](http://visualstudiogallery.msdn.microsoft.com/800cc437-8cb9-463f-9382-26bedff7cdf0)获取它。它**不需要**对您的代码进行任何修改或添加，并且能够**实时**显示调用者和被调用者的函数统计信息，而无需关闭应用程序/停止分析过程。

它与 VisualStudio 集成，因此您可以轻松地启用/禁用项目的分析。也可以将它安装在干净的机器上，它只需要将符号信息与正在分析的可执行文件一起定位。

当来自非常困之类的采样分析器的统计近似值不够时，此工具很有用。

粗略的比较表明，它优于 AQTime（当它在检测、函数级运行中调用时）。以下程序（完全优化，内联禁用）使用微分析器实时显示结果的运行速度比 AQTime 仅收集统计数据快三倍：

```
void f()
{
    srand(time(0));

    vector<double> v(300000);

    generate_n(v.begin(), v.size(), &random);
    sort(v.begin(), v.end());
    sort(v.rbegin(), v.rend());
    sort(v.begin(), v.end());
    sort(v.rbegin(), v.rend());
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-19T17:25:59.997

Microsoft 拥有[Windows 性能工具包](https://docs.microsoft.com/en-us/windows-hardware/test/wpt/)。

它确实需要 Windows Vista、[Windows Server 2008](http://en.wikipedia.org/wiki/Windows_Server_2008)或 Windows 7。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-09-14T14:30:36.857

另一个分析器是[Shiny](http://sourceforge.net/projects/shinyprofiler/)。

​​​​​</p>

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-05-01T01:15:57.667

我强烈推荐[Windows Performance Toolkit (WPT)](https://msdn.microsoft.com/en-us/library/hh162945.aspx)或**XPERF**

命令行 xperf 命令行工具记录可使用 GUI xperfview 工具分析的 Windows 事件跟踪 (ETW) 日志。

事实证明，使用[stacktrace 命令行参数对我的公司来说是一个非常宝贵的工具，因为它可以分析和解决瓶颈问题。](http://blogs.msdn.com/b/pigscanfly/archive/2009/08/06/stack-walking-in-xperf.aspx)最引人注目的事情之一是 WPT 可以安装在任何环境中，甚至可以安装在古老的**Windows XP**上。

在**Windows 8 上，Windows 性能分析器**将 xperf 提升到一个更高的水平。

ETW 日志中提供的硬数字和统计数据在细节上是无与伦比的，除了 Visual Studio Profiler (2010/2012)，它也很棒，但不是免费的 AFAIK。

**如果您从未使用过 xperf ...您不知道自己缺少什么**

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-16T04:47:45.680

我使用 AQTime，它是我用过的最好的分析工具之一。它不是免费的，但您可以获得 30 天的试用期，因此如果您计划只优化和分析一个项目并且 30 天对您来说就足够了，那么我建议您使用此应用程序。（[http://www.automatedqa.com/downloads/aqtime/index.asp](https://smartbear.com/product/aqtime-pro/overview/)）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-01-06T16:34:01.967

请尝试我的分析器，称为 cRunWatch。它只有两个文件，因此很容易与您的项目集成，并且只需要添加一行来检测一段代码。

[http://ravenspoint.wordpress.com/2010/06/16/timing/](http://ravenspoint.wordpress.com/2010/06/16/timing/)

需要 Boost 库。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-10-31T09:10:25.137

我使用了[Luke Stackwalker](http://lukestackwalker.sourceforge.net/)，它为我的 Visual Studio 项目完成了这项工作。

其他有趣的项目是：

*   [普罗菲](http://www.pauldoo.com/proffy)
*   [戴宁斯特](http://www.dyninst.org/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T03:24:31.730

我多年来一直使用“TrueTime - Compuware DevPartner 套件的一部分。有一个 [免费版本]（您可以尝试 Compuware DevPartner 性能分析社区版。）。）可用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-28T02:11:20.610

我使用 VSPerfMon，它是 StandAlone Visual Studio Profiler。我编写了一个 GUI 工具来帮助我运行它并查看结果。

[http://code.google.com/p/vsptree/](http://code.google.com/p/vsptree/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-11-12T11:10:07.757

您可以使用 EmbeddedProfiler，它对 Linux 和 Windwos 都是免费的。

探查器是侵入性的（按功能），但它不需要任何代码修改。只需添加一个特定的编译器标志（-finstrument-functios 用于 gcc/MinGW 或 /GH 用于 MSVC）并链接分析器的库。它可以为您提供完整的调用树或只是一个功能列表。它有自己的分析器 GUI。

# flash - 为预加载器获取多个文件大小

> ID：67556
> 
> 赞同：1
> 
> 时间：2008-09-15T22:15:49.850
> 
> 标签：flash, actionscript-3

好的，目前我让我的 SWF 访问一个 php 文件，该文件将查找我指定给它的所有文件，将它们的大小加在一起，并将它们的组合大小作为一个数字返回。然后，我将此数字与 ProgressEvent 侦听器一起使用，以确定网站特定部分的当前文件下载百分比。

很简单吧？那么现在使用该 PHP 文件是不可能的，我正在尝试在 SWF 中执行所有操作，而不是让它通过外部脚本来获取我需要的数字。

在我开始将文件加载到闪存之前，有什么好方法可以获取文件的大小吗？我真的需要预加载器是 0 到 100% 的预加载器，所以我需要在它实际开始之前要下载的总字节数。

我的一个想法是通过保存文件 URL 的数组，开始加载它们，getTotalBytes 而不显示任何加载，在第一个滴答时终止加载，将所有这些总字节数相加，然后开始实际的下载过程。这种方法看起来很丑陋，而且会浪费大量时间，因为每次用户在网站上点击预加载器时，可能需要一两秒钟来浏览所有文件，找到它们的总数，然后真正开始下载。

有没有更好的解决方案来解决这个问题，而无需离开闪存来获取这些文件的大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T22:32:50.947

您可以向服务器发出 HTTP HEAD 请求以获取文件。这将返回标题信息（包括文件大小），但不返回实际文件。然后，您可以发出 GET 请求来加载文件。

[http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)

（查看第 9.4 节 HEAD）

我可能会做的是一个两层进度条（带有 2 个进度条）。一个显示整体进度（0 到 100%），一个显示每个文件的进度（每个文件都下载时）。

这样，只要您知道要加载的文件数量，就可以完成总进度，而无需先访问服务器来获取文件大小。

迈克室

网格@adobe.com

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T00:06:25.140

Mike Chamber 的想法会对您有所帮助，但它仍然比使用服务器端的东西要慢，因为无论如何您都必须为每个文件发出请求。这与您自己所说的基本相同，但是当您明确要求标题时，它会稍微快一些。使用 Socket 执行请求：

```
var 套接字：套接字 = 新套接字（）；
socket.addEventListener(Event.CONNECT, connectHandler);
socket.addEventListener(ProgressEvent.SOCKET_DATA, dataHandler);
socket.connect("yourserver.com", 80);

函数connectHandler（事件：事件）：无效{
    var headers : String = "HEAD yourfilename.ext http/1.1\r\n";
    headers += "主机：yourserver.com\r\n";
    标题 += "\r\n\r\n";
    socket.writeUTFBytes（标头）；
    socket.flush();
}

函数数据处理程序（事件：ProgressEvent）：无效{
    跟踪（“接收到的标头\n”）；
    跟踪（socket.readUTF（socket.bytesAvailable））；
}

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T02:42:44.857

如果绝对有必要控制文件的加载方式，那么我相信 Mike Chambers 提出 HTTP HEAD 请求的建议是可行的方法。

但是，除非有充分的理由不这样做，否则我会立即开始加载所有文件并从每个文件的 getBytesTotal 方法中获取文件大小。由于 Flash 从浏览器获取其网络堆栈，实际同时加载的文件数量将符合（用户可定义的）浏览器设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T08:28:06.167

以下仅用于示例目的。在实际情况下，我不会使用 Timer，我将有一个数组或 XML 对象来使用 for 循环进行迭代，不管它工作得很好，基本上一旦你到达循环的结尾（例如 if(i == (length - 1 )) 既然我们有了总数，就让它调用开始实际预加载的功能。现在我们再次遍历数组或 XML 对象，但这一次我们只在每个资产加载后才这样做，而不是在 for 循环中. 然后这个异步方法可以坐在那里比较它已经加载了多少数据，然后除以之前找到的总数，得到你的百分比。

```
var totalBytes:Number = 0;

var loader:Loader = new Loader();
var request:URLRequest = new URLRequest();
request.url = 'badfish.jpg';

var timer:Timer = new Timer(200);
timer.addEventListener(TimerEvent.TIMER, onTimer);

函数 onTimer(e:TimerEvent)
{
    loader.load（请求）；
    loader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgress);
}
函数 onProgress(e:ProgressEvent):void
{
    totalBytes+=e.bytesTotal；
    跟踪（e.bytesTotal，totalBytes）；
    loader.contentLoaderInfo.removeEventListener(ProgressEvent.PROGRESS, onProgress);
}

计时器.start();

```

# database - 如何在没有性能和可扩展性问题的情况下审核数据库活动？

> ID：67557
> 
> 赞同：6
> 
> 时间：2008-09-15T22:15:59.257
> 
> 标签：database, performance, oracle, audit

我需要审核所有数据库活动，无论它来自应用程序还是通过其他方式发出某些 sql 的人。所以审计必须在数据库级别进行。有问题的数据库是Oracle。我考虑通过触发器以及 Oracle 提供的称为细粒度审计的东西来实现它。在这两种情况下，我们都打开了对特定表和特定列的审计。然而，我们发现当我们使用这两种方法时，性能真的很糟糕。

由于围绕数据隐私的规定，审计是绝对必须的，我想知道在不显着性能下降的情况下，最好的方法是什么。如果有人在这方面有 Oracle 的特定经验，那将会很有帮助，但如果不仅仅是围绕数据库活动审计的一般实践也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T22:28:57.697

我不确定这对于生产系统是否足够成熟，但我在使用网络流量嗅探器监控数据库流量方面取得了很大成功。

将应用程序和数据库之间的原始数据发送到另一台机器并在那里对其进行解码和分析。

我使用 PostgreSQL，解码流量并将其转换为可以记录的数据库操作流相对简单。我想它可以在任何记录了数据包格式的数据库上工作。

要点是它没有给数据库本身带来额外的负担。

此外，它是被动监控，它记录了所有活动，但无法阻止任何操作，因此可能不是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-10T06:46:44.610

没有必要“自己动手”。只需打开审核：

1.  设置数据库参数 AUDIT_TRAIL = DB。
2.  启动实例。
3.  使用 SQLPlus 登录。
4.  输入语句

    ```
    全部审核；
    ```

    这将为许多关键的 DDL 操作启用审计，但 DML 和其他一些 DDL 语句仍未审计。
5.  要启用对这些其他活动的审核，请尝试以下语句：

    ```
    审计变更表；-- DDL 审计
    审计选择表、更新表、插入表、删除表；-- DML 审计
    ```

注意：所有“as sysdba”活动总是被 O/S 审计。在 Windows 中，这意味着 Windows 事件日志。在 UNIX 中，这通常是 $ORACLE_HOME/rdbms/audit。

查看数据库 SQL 参考的[Oracle 10g R2 审计章节](http://download-east.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_4007.htm)。

可以在 SYS.DBA_AUDIT_TRAIL 视图中查看数据库审计跟踪。

需要指出的是，Oracle 内部审计从定义上讲是高性能的。它的设计正是如此，很难想象还有什么可以与它相媲美的性能。此外，Oracle 审计具有高度“细粒度”的控制。你可以得到你想要的一样精确。最后，可以将 SYS.AUD$ 表及其索引移至单独的表空间，以防止填满 SYSTEM 表空间。

亲切的问候，作品

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-12T15:28:08.883

如果您想在目标系统上记录更改记录的副本，您可以使用 Golden Gate Software 执行此操作，并且不会在源端资源消耗方面产生太多影响。此外，您无需对源数据库进行任何更改即可实施此解决方案。

Golden Gate 为引用您感兴趣的表列表的事务抓取重做日志。这些更改被写入“跟踪文件”，并且可以应用于同一数据库上的不同模式，或发送到目标系统并应用那里（非常适合减少源系统上的负载）。

将跟踪文件获取到目标系统后，您可以进行一些配置调整，您可以设置一个选项来执行审计，如果需要，您可以调用 2 个 Golden Gate 函数来获取有关交易的信息：

1) 设置 INSERTALLRECORDS Replication 参数，为对源表进行的每个更改操作在目标表中插入一条新记录。请注意，这会占用大量空间，但如果您需要全面审计，这可能是意料之中的。

2) 如果您的记录中还没有 CHANGED_BY_USERID 和 CHANGED_DATE，您可以使用目标端的 Golden Gate 函数来获取当前交易的此信息。查看 GG 参考指南中的以下函数： GGHEADER("USERID") GGHEADER("TIMESTAMP")

所以不，它不是免费的（需要通过 Oracle 获得许可），并且需要一些努力才能启动，但可能比实施和维护自己滚动的自定义解决方案要少得多的努力/成本，并且您还可以获得传送数据的额外好处到远程系统，这样您就可以保证对源数据库的影响最小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-29T05:48:07.563

如果您使用的是 oracle，那么有一个称为 CDC（捕获数据更改）的功能，它是针对审计类型需求的更高效的解决方案。

# eclipse - 如何修复 EclipseME (MTJ) 中的“损坏”调试器？

> ID：67559
> 
> 赞同：1
> 
> 时间：2008-09-15T22:16:39.927
> 
> 标签：eclipse, debugging, java-me, mtj, eclipseme

如何在[EclipseME](http://www.eclipseme.org/)（现在的 Mobile Tools Java）中修复损坏的调试器，一个无法启动的调试器？

（这个问题有答案，很快会从另一个问题转移）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T05:49:42.893

对我来说，EclipseME 最烦人的问题是“损坏的”调试器，它无法启动。这在 docs 中有介绍，但是当我第一次安装 EclipseME 时，我花了大约一个小时才找到这个技巧，一年后我回到 JavaME 开发又花了一个小时，所以我决定在这里也分享这个知识。

如果调试器无法启动，

1.  在 Eclipse“首选项”菜单中打开“Java > Debug”部分，并取消选中“Suspend execution on uncaught exceptions”和“Suspend execution on compiler errors”和
2.  将对话框底部附近的“调试器超时”增加到至少 15000 毫秒（文档说；事实上，对这个值进行二进制搜索可以找到适合您情况的最佳延迟）。

之后，Eclipse 应该能够连接到 KVM 并运行带有调试器的 midlet。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T02:29:57.070

大多数调试器只是具有命令行界面的插件；尝试从命令行运行调试器，看看它是否有效。如果是，则检查插件配置；您可能需要重新安装插件。

警告：我没有使用过 EclipseME，但在 Eclipse for Ubuntu 中的 Gnu C 调试器也有类似的问题。

# language-agnostic - 流畅的界面是否违反了得墨忒耳定律？

> ID：67561
> 
> 赞同：62
> 
> 时间：2008-09-15T22:16:52.420
> 
> 标签：language-agnostic, oop, api-design

关于[得墨忒耳法则的](http://c2.com/cgi/wiki?LawOfDemeter)维基[百科文章](http://en.wikipedia.org/wiki/Law_Of_Demeter)说：

> 该法可以简单地表述为“仅使用一个点”。

然而，[流畅界面的](http://en.wikipedia.org/wiki/Fluent_interface)[简单示例](http://weblogs.asp.net/jgalloway/archive/2006/12/06/a-simple-example-of-a-fluent-interface.aspx)可能如下所示：

```
static void Main(string[] args)
{
   new ZRLabs.Yael.Pipeline("cat.jpg")
        .Rotate(90)
        .Watermark("Monkey")
        .RoundCorners(100, Color.Bisque)
        .Save("test.png");
} 
```

那么这是否合二为一呢？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-09-15T22:26:51.650

好吧，法律的简短定义将其缩短太多了。真正的“法律”（实际上是关于良好 API 设计的建议）基本上是说：只访问您自己创建的对象，或者作为参数传递给您的对象。不要通过其他对象间接访问对象。流畅接口的方法通常返回对象本身，因此如果您再次使用该对象，它们不会违反法律。其他方法为您创建对象，因此也没有违规。

另请注意，“法律”只是“经典”API 的最佳实践建议。流畅的接口是一种完全不同的 API 设计方法，不能用得墨忒耳定律来评估。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-15T22:28:00.163

不必要。“只用一个点”是对得墨忒耳法则的不准确总结。

当每个点代表不同对象的结果时，得墨忒耳法则不鼓励使用多个点，例如：

*   第一个点是从 ObjectA 调用的方法，返回一个 ObjectB 类型的对象
*   下一个点是只在 ObjectB 中可用的方法，返回一个 ObjectC 类型的对象
*   下一个点是仅在 ObjectC 中可用的属性
*   无止境

但是，至少在我看来，如果每个点的返回对象仍然与原始调用者的类型相同，则不会违反得墨忒耳法则：

```
var List<SomeObj> list = new List<SomeObj>();
//initialize data here
return list.FindAll( i => i == someValue ).Sort( i1, i2 => i2 > i1).ToArray(); 
```

在上面的示例中，FindAll() 和 Sort() 都返回与原始列表相同类型的对象。没有违反得墨忒耳法则：该列表只与它的直系朋友交谈。

话虽如此，*并非所有*流畅的接口都违反得墨忒耳法则，只要它们返回与其调用者相同的类型。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-15T22:31:51.107

得墨忒耳定律的精神是，给定一个对象引用或类，你应该避免访问一个多于一个子属性或方法的类的属性，因为这会使这两个类紧密耦合，这可能是无意的，并且可能导致可维护性问题。

流利的接口是一个可接受的例外，因为它们至少是紧密耦合的，因为所有属性和方法都是迷你语言的术语，它们组合在一起形成功能性句子**。**

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-15T22:23:36.447

是的，尽管您必须对这种情况采取一些务实的态度。我总是将得墨忒耳法则作为指导而不是规则。

当然，您可能希望避免以下情况：

```
CurrentCustomer.Orders[0].Manufacturer.Address.Email(text); 
```

也许替换为：

```
CurrentCustomer.Orders[0].EmailManufacturer(text); 
```

随着我们中越来越多的人使用通常将整个域呈现为对象图的 ORM，为特定对象定义可接受的“范围”可能是一个想法。也许我们应该利用得墨忒耳定律来建议您不应该将整个图形映射为可到达的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-11-24T16:52:01.617

1）它根本不违反它。

代码相当于

```
var a = new ZRLabs.Yael.Pipeline("cat.jpg");
a = a.Rotate(90);
a = a.Watermark("Monkey");
a = a.RoundCorners(100, Color.Bisque);
a = a.Save("test.png"); 
```

2) 正如 Good Ol' Phil Haack 所说：[得墨忒耳定律不是点数练习](http://haacked.com/archive/2009/07/14/law-of-demeter-dot-counting.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-20T09:57:56.597

你的例子没有问题。毕竟，您正在旋转、添加水印等……总是相同的图像。我相信您一直在与 Pipeline 对象交谈，因此只要您的代码仅依赖于 Pipeline 的类，您就不会违反 LoD。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-20T00:58:46.050

从本质上讲，一个对象不应该暴露它的内部（数据），而是暴露函数来操作内部。

考虑到这一点，Fluent API 要求对象使用其数据处理某事，而不是询问其数据。

这并不违反任何得墨忒耳法则。

# css - 为什么固定元素会减慢 Firefox 中的滚动速度？

> ID：67588
> 
> 赞同：8
> 
> 时间：2008-09-15T22:22:01.317
> 
> 标签：css, firefox, css-position

为什么`position: fixed`应用了 CSS 的元素会导致 Firefox 在滚动它们所在的页面时占用 100% 的 CPU？有什么解决方法吗？

我在一些网站上注意到了这种行为，例如 StackOverflow 页面顶部的通知栏。我正在使用 Linux 以防万一。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T22:27:08.327

这是[错误 #201307](https://bugzilla.mozilla.org/show_bug.cgi?id=201307)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T22:30:42.233

这是[bugzilla中报告的错误](https://bugzilla.mozilla.org/show_bug.cgi?id=201307)

显然，一种解决方法（有成功的混合报告..）是[禁用平滑滚动](http://ubuntuforums.org/showpost.php?s=6a1b84b5381937fac2f478508203098e&p=3675924&postcount=6)

> 只需在“编辑”>“首选项”>“高级”中禁用平滑滚动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T22:39:03.663

如前所述，这是错误[#201307](https://bugzilla.mozilla.org/show_bug.cgi?id=201307)。解决方法是禁用平滑滚动：

编辑 -> 首选项 -> 高级 -> 常规选项卡 -> 取消选中“使用平滑​​滚动”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T22:29:55.340

这个网站有一个固定的元素“第一次在 Stack Overflow？查看常见问题解答！”，它在 Firefox 中非常慢。不过在 Opera 和 Chrome 上效果更好。FF3、Windows XP、ATI。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T22:31:31.887

它会占用 CPU，因为浏览器必须在每次滚动更改时重新绘制整个视口，而不仅仅是新的可见区域

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T22:26:32.257

你确定这里有直接链接吗？您是否创建了带有固定元素的静态 HTML 页面来验证您的理论？考虑到这些 CSS 属性的使用范围有多广，我想现在其他人会注意到它，无论您运行的是什么浏览器/操作系统。

# javascript - 查找页面中每个链接的坐标

> ID：67612
> 
> 赞同：2
> 
> 时间：2008-09-15T22:27:39.620
> 
> 标签：javascript, web, hyperlink, location

在 Javascript 中：如何找到网页中每个链接的坐标（x、y、高度、宽度）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T22:31:54.303

使用 jQuery，它很简单：

```
$("a").each(function() {
    var link = $(this);
    var top = link.offset().top;
    var left = link.offset().left;
    var width = link.offset.width();
    var height = link.offset.height();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T23:59:02.067

没有jQuery：

```
var links = document.getElementsByTagName("a");
for(var i in links) {
    var link = links[i];
    console.log(link.offsetWidth, link.offsetHeight);
} 
```

尝试使用此页面获取 x 和 y 值：http: [//blogs.korzh.com/progtips/2008/05/28/absolute-coordinates-of-dom-element-within-document.html](http://blogs.korzh.com/progtips/2008/05/28/absolute-coordinates-of-dom-element-within-document.html)

但是，如果您尝试添加图像或类似的东西，我建议使用 a:after css 选择器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-26T18:24:03.163

纯 JavaScript：

```
function getAllChildren (node, tag) {
  return [].slice.call(node.getElementsByTagName(tag));
}
function offset(element){
  var rect = element.getBoundingClientRect();
  var docEl = doc.documentElement;
  return {
    left: rect.left + window.pageXOffset - docEl.clientLeft,
    top: rect.top + window.pageYOffset - docEl.clientTop,
    width: element.offsetWidth,
    height: element.offsetHeight
  };
}

var links = getAllChildren(document.body, 'a');
links.forEach(function(link){
  var offset_node = offset(node);
  console.info(offset_node);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T22:37:40.670

使用 jQuery：

```
$j('a').each( findOffset );

function findOffset()
{
    alert
    ( 'x=' + $j(this).offset().left
    + ' y=' + $j(this).offset().top
    + ' width=' + $j(this).width()
    + ' height=' + $j(this).height()
    );
} 
```

# asp.net - 如何通过 AJAX 调用方法而不导致页面呈现？

> ID：67621
> 
> 赞同：0
> 
> 时间：2008-09-15T22:28:36.480
> 
> 标签：asp.net, ajax, asp.net-ajax

我正在使用 ASP.net。

我正在尝试为我正在使用的页面调用基类中存在的方法。我想通过 Javascript 调用此方法，并且不需要由 ASP.net 处理任何渲染。

实现这一目标的最简单方法是什么。

我查看了由于某种原因无法正常工作的 PageMethods，并发现很多其他人在使用它们时遇到了麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T22:31:28.330

这取决于该方法所依赖的内容，但假设它是一个静态方法或者它不依赖于页面生命周期来工作，您可以公开一个 Web 服务端点并使用您想要使用的任何 Javascript 调用机制来访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T00:51:10.100

您使用什么库来进行 Ajax 调用？如果您使用的是 JQuery，那么您可以创建静态方法并在您的页面上调用它们。如果您需要进一步的帮助，请告诉我！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T23:12:42.333

正如 Thunder3 建议的那样，公开一个 Web 服务。完成此操作后，您可以使用 ScriptManager（或 ScriptManagerProxy）注册 Web 服务，这将导致生成 JavaScript 包装器。这个包装器为您提供了一个很好的调用接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T23:21:17.763

[为了扩展@Azam](https://stackoverflow.com/users/3797/azamsharp)提出的观点，如果您不想在页面上呈现 html，则可以将返回类型设置为其他类型，例如 xml，并像我在下面的代码中那样执行 response.write。在 GET 期间，我想发回 html，但在 POST 期间，我通过网络发回一些 XML。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Response.Cache.SetCacheability(HttpCacheability.NoCache)
        If Request.HttpMethod = "GET" Then
            'do some work and return the rendered html
        ElseIf Request.HttpMethod = "POST" Then
            'do some work and return xml
            Response.ContentType = "text/xml"
            Response.Write("<data></data>")
            Response.End()
        Else
            Response.StatusCode = 404
            Response.End()
        End If
    End Sub 
```

# actionscript-3 - 是否有我可以遵循的指南将我的程序操作脚本 3 转换为 OOP？

> ID：67627
> 
> 赞同：0
> 
> 时间：2008-09-15T22:30:12.857
> 
> 标签：actionscript-3

我想将我的电影剪辑更改为 AS3 中的动作脚本类。是否有我需要做的事情的标准清单以确保课程有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T22:34:30.540

查看这些资源：

Grant Skinners 介绍性 AS3 研讨会幻灯片[http://gskinner.com/talks/as3workshop/](http://gskinner.com/talks/as3workshop/)

Lee Brimelow：学习 ActionScript 3 的 6 个理由[http://www.adobe.com/devnet/actionscript/articles/six_reasons_as3.html](http://www.adobe.com/devnet/actionscript/articles/six_reasons_as3.html)

Colin Moock：基本 ActionScript 3（被认为是 ActionScript 开发人员的“圣经”）：[http ://www.amazon.com/Essential-ActionScript-3-0/dp/0596526946](https://rads.stackoverflow.com/amzn/click/com/0596526946)

迈克室

网格@adobe.com

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-12T18:47:40.500

You probably wanna check out [Refactoring](https://stackoverflow.com/questions/tagged/refactoring) as well.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T08:54:45.447

不要忘记这篇用于从 AS2 过渡到 AS3 的优秀 devnet 文章：

[http://www.adobe.com/devnet/actionscript/articles/actionscript_tips.html](http://www.adobe.com/devnet/actionscript/articles/actionscript_tips.html)

# wpf - 用于 WPF 的 Deepzoom

> ID：67628
> 
> 赞同：10
> 
> 时间：2008-09-15T22:30:19.597
> 
> 标签：wpf, silverlight, deepzoom

Silverlight 的 MultiScaleImage（又名 DeepZoom）的 WPF 是否有任何端口？Microsoft 是否为 WPF 制定了路线图？

我想从 WinForms 转移到 WPF 并需要像 DeepZoom 这样的东西，使用 Silverlight 不是一个选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T23:17:47.843

目前没有港口。然而，DeepZoom 是基于“万维望远镜”和“微软照片合成器”中的技术，因此它们运行的​​是桌面版本的技术。我想可以肯定的是，微软很快就会发布 WPF 的多比例图像控件。如果您只想要“平移和缩放”，而不关心高分辨率图像的有效分解，您当然可以在 WPF 中实现相同的效果。这篇文章是[关于如何进行缩放和平移的一个示例](http://blogs.windowsclient.net/joeyw/archive/2008/08/05/pan-and-zoom-deepzoom-style-in-wpf.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T13:08:45.033

可悲的消息（或“谣言”？）......在这个[WPF4 中要跟踪的功能列表中](http://blogs.msdn.com/jaimer/archive/2009/05/27/wpf-4-and-net-framework-4-beta-1-list-of-features-totrack.aspx)，Jaime 说

“注意：在 PDC，我们说 DeepZoom 将在 WPF4 中。不幸的是，该功能已被削减。我们只是无法将其挤入日程安排。有解决方法：您可以使用 Web 浏览器控件或使用[Silverlight 托管 API](http://msdn.microsoft.com/en-us/library/cc296246(VS.95).aspx)。”

我想如果你勇敢的话，那些[托管 API](http://msdn.microsoft.com/en-us/library/cc296246(VS.95).aspx)可能会很有用 - 但我猜只是将 Silverlight 对象放在 WPF WebBrowser 控件中会更简单......

# .net - 什么是 Visual Studio 2008 中的“仅客户端框架子集”？

> ID：67629
> 
> 赞同：10
> 
> 时间：2008-09-15T22:30:41.170
> 
> 标签：.net, visual-studio-2008, .net-client-profile

Visual Studio 2008 中的“仅客户端框架子集”有什么作用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-15T22:33:28.497

你的意思是[客户资料](http://weblogs.asp.net/scottgu/archive/2008/05/12/visual-studio-2008-and-net-framework-3-5-service-pack-1-beta.aspx)？

*.NET Framework 客户端配置文件设置仅包含 .NET Framework 中通常用于客户端应用程序方案的程序集和文件。例如：它包括 Windows 窗体、WPF 和 WCF。它不包括 ASP.NET 以及主要用于服务器方案的那些库和组件。我们预计此安装包大小约为 26MB，下载和安装速度比完整的 .NET Framework 安装包快得多。*

# python - 如何在给定完整路径的情况下导入模块？

> ID：67631
> 
> 赞同：1504
> 
> 时间：2008-09-15T22:30:55.493
> 
> 标签：python, configuration, python-import, python-module

给定完整路径，如何加载 Python 模块？

请注意，该文件可以位于文件系统中的任何位置，因为它是一个配置选项。

* * *

## 回答 #1

> 赞同：1566
> 
> 时间：2008-09-15T22:41:16.887

对于 Python 3.5+ 使用：

```
import importlib.util
spec = importlib.util.spec_from_file_location("module.name", "/path/to/file.py")
foo = importlib.util.module_from_spec(spec)
spec.loader.exec_module(foo)
foo.MyClass() 
```

对于 Python 3.3 和 3.4，请使用：

```
from importlib.machinery import SourceFileLoader

foo = SourceFileLoader("module.name", "/path/to/file.py").load_module()
foo.MyClass() 
```

（尽管这在 Python 3.4 中已被弃用。）

对于 Python 2 使用：

```
import imp

foo = imp.load_source('module.name', '/path/to/file.py')
foo.MyClass() 
```

对于已编译的 Python 文件和 DLL，有等效的便利函数。

另请参阅[http://bugs.python.org/issue21436](http://bugs.python.org/issue21436)。

* * *

## 回答 #2

> 赞同：514
> 
> 时间：2008-09-24T19:36:16.357

向 sys.path 添加路径（而不是使用 imp）的优点是它简化了从单个包中导入多个模块时的操作。例如：

```
import sys
# the mock-0.3.1 dir contains testcase.py, testutils.py & mock.py
sys.path.append('/foo/bar/mock-0.3.1')

from testcase import TestCase
from testutils import RunTests
from mock import Mock, sentinel, patch 
```

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2018-11-15T02:30:11.100

要导入您的模块，您需要将其目录临时或永久添加到环境变量中。

# 暂时地

```
import sys
sys.path.append("/path/to/my/modules/")
import my_module 
```

# 永久

将以下行添加到`.bashrc`Linux 中的（或替代）文件并`source ~/.bashrc`在终端中执行（或替代）：

```
export PYTHONPATH="${PYTHONPATH}:/path/to/my/modules/" 
```

信用/来源：[saarrrr](https://stackoverflow.com/users/2312075/saarrrr)，[另一个 Stack Exchange 问题](https://stackoverflow.com/a/3402176/7428659)

* * *

## 回答 #4

> 赞同：86
> 
> 时间：2018-05-17T15:23:41.610

如果您的顶级模块不是文件，而是使用 __init__.py 打包为目录，那么接受的解决方案几乎可以工作，但并不完全。在 Python 3.5+ 中需要以下代码（注意添加的以 'sys.modules' 开头的行）：

```
MODULE_PATH = "/path/to/your/module/__init__.py"
MODULE_NAME = "mymodule"
import importlib
import sys
spec = importlib.util.spec_from_file_location(MODULE_NAME, MODULE_PATH)
module = importlib.util.module_from_spec(spec)
sys.modules[spec.name] = module 
spec.loader.exec_module(module) 
```

如果没有这一行，当执行 exec_module 时，它​​会尝试将顶级 __init__.py 中的相对导入绑定到顶级模块名称——在本例中为“mymodule”。但是“mymodule”尚未加载，因此您将收到错误“SystemError：未加载父模块'mymodule'，无法执行相对导入”。所以你需要在加载之前绑定名称。这样做的原因是相对导入系统的基本不变量：“保持不变的是，如果你有 sys.modules['spam'] 和 sys.modules['spam.foo'] （就像你在上面的导入之后一样)，后者必须作为前者的 foo 属性出现” [，如此处所述](https://docs.python.org/3/reference/import.html#submodules)。

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2016-05-20T06:52:17.230

听起来您不想专门导入配置文件（它有很多副作用和额外的复杂性）。您只想运行它，并能够访问生成的命名空间。[标准库以runpy.run_path](https://docs.python.org/3/library/runpy.html#runpy.run_path)的形式专门为此提供了一个 API ：

```
from runpy import run_path
settings = run_path("/path/to/file.py") 
```

该接口在 Python 2.7 和 Python 3.2+ 中可用。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2008-09-15T22:44:50.980

您也可以这样做，将配置文件所在的目录添加到 Python 加载路径中，然后进行正常导入，假设您事先知道文件的名称，在本例中为“config”。

凌乱，但它的工作原理。

```
configfile = '~/config.py'

import os
import sys

sys.path.append(os.path.dirname(os.path.expanduser(configfile)))

import config 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2008-09-15T22:41:24.127

您可以使用

```
load_source(module_name, path_to_file) 
```

[imp 模块](https://docs.python.org/library/imp.html)中的方法。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2008-09-15T22:46:35.877

你的意思是加载还是导入？

您可以操作`sys.path`列表指定模块的路径，然后导入您的模块。例如，给定一个模块：

```
/foo/bar.py 
```

你可以这样做：

```
import sys
sys.path[0:0] = ['/foo'] # Puts the /foo directory at the start of your path
import bar 
```

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2016-06-03T10:04:52.653

这是一些适用于所有 Python 版本的代码，从 2.7-3.5 甚至可能还有其他版本。

```
config_file = "/tmp/config.py"
with open(config_file) as f:
    code = compile(f.read(), config_file, 'exec')
    exec(code, globals(), locals()) 
```

我测试了它。它可能很难看，但到目前为止，它是唯一适用于所有版本的。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2017-04-25T05:45:26.947

我提出了[@SebastianRittau 的精彩答案](https://stackoverflow.com/a/67692/2988730)的略微修改版本（我认为对于 Python > 3.4），这将允许您加载具有任何扩展名的文件作为模块使用[`spec_from_loader`](https://docs.python.org/3/library/importlib.html#importlib.util.spec_from_loader)而不是[`spec_from_file_location`](https://docs.python.org/3/library/importlib.html#importlib.util.spec_from_file_location)：

```
from importlib.util import spec_from_loader, module_from_spec
from importlib.machinery import SourceFileLoader 

spec = spec_from_loader("module.name", SourceFileLoader("module.name", "/path/to/file.py"))
mod = module_from_spec(spec)
spec.loader.exec_module(mod) 
```

显式编码路径的优点[`SourceFileLoader`](https://docs.python.org/3/library/importlib.html#importlib.machinery.SourceFileLoader)是[机器](https://docs.python.org/3/library/importlib.html#module-importlib.machinery)不会尝试从扩展名中找出文件的类型。这意味着您可以`.txt`使用此方法加载类似文件的内容，但如果`spec_from_file_location`不指定加载程序，您将无法执行此操作，因为`.txt`不在[`importlib.machinery.SOURCE_SUFFIXES`](https://docs.python.org/3/library/importlib.html#importlib.machinery.SOURCE_SUFFIXES).

我已经基于此放置了一个实现，[@SamGrondahl 对](https://stackoverflow.com/a/50395128/2988730)我的实用程序库[haggis](https://haggis.readthedocs.io/en/stable/)的有用修改。该函数被调用[`haggis.load.load_module`](https://haggis.readthedocs.io/en/latest/api.html#haggis.load.load_module)。它添加了一些巧妙的技巧，例如在加载模块命名空间时将变量注入模块命名空间的能力。

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2008-09-16T01:43:04.407

您可以使用`__import__`and执行此操作`chdir`：

```
def import_file(full_path_to_module):
    try:
        import os
        module_dir, module_file = os.path.split(full_path_to_module)
        module_name, module_ext = os.path.splitext(module_file)
        save_cwd = os.getcwd()
        os.chdir(module_dir)
        module_obj = __import__(module_name)
        module_obj.__file__ = full_path_to_module
        globals()[module_name] = module_obj
        os.chdir(save_cwd)
    except Exception as e:
        raise ImportError(e)
    return module_obj

import_file('/home/somebody/somemodule.py') 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2019-11-21T11:40:47.617

如果我们在同一个项目中有脚本，但在不同的目录方式，我们可以通过以下方法解决这个问题。

在这种情况`utils.py`下`src/main/util/`

```
import sys
sys.path.append('./')

import src.main.util.utils
#or
from src.main.util.utils import json_converter # json_converter is example method 
```

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2008-09-15T22:37:24.447

相信你可以使用[`imp.find_module()`](https://docs.python.org/2/library/imp.html#imp.find_module)and[`imp.load_module()`](https://docs.python.org/2/library/imp.html#imp.load_module)来加载指定的模块。您需要将模块名称从路径中拆分出来，即如果您想加载`/home/mypath/mymodule.py`，您需要执行以下操作：

```
imp.find_module('mymodule', '/home/mypath/') 
```

...但这应该可以完成工作。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2014-09-13T19:57:28.967

您可以使用`pkgutil`模块（特别是[`walk_packages`](https://docs.python.org/3/library/pkgutil.html#pkgutil.walk_packages)方法）来获取当前目录中的包列表。从那里使用`importlib`机器导入您想要的模块是微不足道的：

```
import pkgutil
import importlib

packages = pkgutil.walk_packages(path='.')
for importer, name, is_package in packages:
    mod = importlib.import_module(name)
    # do whatever you want with module now, it's been imported! 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2018-12-06T12:41:40.203

创建 Python 模块*test.py*：

```
import sys
sys.path.append("<project-path>/lib/")
from tes1 import Client1
from tes2 import Client2
import tes3 
```

创建 Python 模块*test_check.py*：

```
from test import Client1
from test import Client2
from test import test3 
```

我们可以从模块中导入导入的模块。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2019-11-19T21:59:43.190

有一个专门用于此的[软件包：](https://pypi.org/project/thesmuggler/)

```
from thesmuggler import smuggle

# À la `import weapons`
weapons = smuggle('weapons.py')

# À la `from contraband import drugs, alcohol`
drugs, alcohol = smuggle('drugs', 'alcohol', source='contraband.py')

# À la `from contraband import drugs as dope, alcohol as booze`
dope, booze = smuggle('drugs', 'alcohol', source='contraband.py') 
```

它在 Python 版本（也包括 Jython 和 PyPy）上进行了测试，但根据项目的大小，它可能会有点矫枉过正。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2015-04-12T12:22:56.293

Python 3.4 的这个领域似乎理解起来极其曲折！然而，在开始使用 Chris Calloway 的代码进行一些黑客攻击后，我设法得到了一些工作。这是基本功能。

```
def import_module_from_file(full_path_to_module):
    """
    Import a module given the full path/filename of the .py file

    Python 3.4

    """

    module = None

    try:

        # Get module name and path from full path
        module_dir, module_file = os.path.split(full_path_to_module)
        module_name, module_ext = os.path.splitext(module_file)

        # Get module "spec" from filename
        spec = importlib.util.spec_from_file_location(module_name,full_path_to_module)

        module = spec.loader.load_module()

    except Exception as ec:
        # Simple error printing
        # Insert "sophisticated" stuff here
        print(ec)

    finally:
        return module 
```

这似乎使用了 Python 3.4 中未弃用的模块。我不假装理解为什么，但它似乎在程序中起作用。我发现 Chris 的解决方案在命令行上有效，但在程序内部无效。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2011-06-08T19:41:29.240

我做了一个`imp`适合你的包。我称之为它`import_file`，这就是它的使用方式：

```
>>>from import_file import import_file
>>>mylib = import_file('c:\\mylib.py')
>>>another = import_file('relative_subdir/another.py') 
```

你可以在：

[http://pypi.python.org/pypi/import_file](http://pypi.python.org/pypi/import_file)

或

[http://code.google.com/p/import-file/](http://code.google.com/p/import-file/)

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2015-06-02T19:57:46.677

我并不是说它更好，但为了完整起见，我想推荐这个[`exec`](https://docs.python.org/3/library/functions.html#exec)函数，它在 Python 2 和 Python 3 中都可用。

`exec`允许您在作为字典提供的全局范围或内部范围内执行任意代码。

例如，如果您有一个存储在`"/path/to/module`" 中的模块带有 function `foo()`，您可以通过执行以下操作来运行它：

```
module = dict()
with open("/path/to/module") as f:
    exec(f.read(), module)
module['foo']() 
```

这使得动态加载代码更加明确，并赋予您一些额外的能力，例如提供自定义内置函数的能力。

如果通过属性而不是键访问对您来说很重要，您可以为全局变量设计一个自定义 dict 类，以提供此类访问权限，例如：

```
class MyModuleClass(dict):
    def __getattr__(self, name):
        return self.__getitem__(name) 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2015-10-02T11:14:13.360

要从给定文件名导入模块，您可以临时扩展路径，并在 finally 块[引用中恢复系统路径：](http://effbot.org/zone/import-string.htm)

```
filename = "directory/module.py"

directory, module_name = os.path.split(filename)
module_name = os.path.splitext(module_name)[0]

path = list(sys.path)
sys.path.insert(0, directory)
try:
    module = __import__(module_name)
finally:
    sys.path[:] = path # restore 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2018-05-24T12:07:37.577

`importlib`一个使用包而不是包的简单解决方案`imp`（针对 Python 2.7 进行了测试，尽管它也适用于 Python 3）：

```
import importlib

dirname, basename = os.path.split(pyfilepath) # pyfilepath: '/my/path/mymodule.py'
sys.path.append(dirname) # only directories should be added to PYTHONPATH
module_name = os.path.splitext(basename)[0] # '/my/path/mymodule.py' --> 'mymodule'
module = importlib.import_module(module_name) # name space of defined module (otherwise we would literally look for "module_name") 
```

现在您可以直接使用导入模块的命名空间，如下所示：

```
a = module.myvar
b = module.myfunc(a) 
```

这个解决方案的优点是**我们甚至不需要知道我们想要导入的模块的实际名称，就**可以在我们的代码中使用它。这很有用，例如在模块路径是可配置参数的情况下。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2021-07-13T11:04:10.620

添加到[Sebastian Rittau](https://stackoverflow.com/questions/67631/how-to-import-a-module-given-the-full-path/67692#67692)的答案：至少对于[CPython](https://en.wikipedia.org/wiki/CPython)，有[pydoc](https://docs.python.org/3/library/pydoc.html)，虽然没有正式声明，但导入文件就是它的作用：

```
from pydoc import importfile
module = importfile('/path/to/module.py') 
```

**PS。**为了完整起见，在撰写本文时引用了当前的实现：[pydoc.py](https://github.com/python/cpython/blob/9c3eaf88dc5d5bed80cc45936de06b7b3162bc6d/Lib/pydoc.py#L392)，我很高兴地说，在[xkcd 1987的脉络中，它没有使用](https://xkcd.com/1987/)[issue 21436](https://bugs.python.org/issue21436)中提到的任何实现——在至少，不是逐字逐句。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-09-15T22:43:20.953

**在运行时导入包模块（Python 配方）**

[http://code.activestate.com/recipes/223972/](http://code.activestate.com/recipes/223972/)

```
###################
##                #
## classloader.py #
##                #
###################

import sys, types

def _get_mod(modulePath):
    try:
        aMod = sys.modules[modulePath]
        if not isinstance(aMod, types.ModuleType):
            raise KeyError
    except KeyError:
        # The last [''] is very important!
        aMod = __import__(modulePath, globals(), locals(), [''])
        sys.modules[modulePath] = aMod
    return aMod

def _get_func(fullFuncName):
    """Retrieve a function object from a full dotted-package name."""

    # Parse out the path, module, and function
    lastDot = fullFuncName.rfind(u".")
    funcName = fullFuncName[lastDot + 1:]
    modPath = fullFuncName[:lastDot]

    aMod = _get_mod(modPath)
    aFunc = getattr(aMod, funcName)

    # Assert that the function is a *callable* attribute.
    assert callable(aFunc), u"%s is not callable." % fullFuncName

    # Return a reference to the function itself,
    # not the results of the function.
    return aFunc

def _get_class(fullClassName, parentClass=None):
    """Load a module and retrieve a class (NOT an instance).

    If the parentClass is supplied, className must be of parentClass
    or a subclass of parentClass (or None is returned).
    """
    aClass = _get_func(fullClassName)

    # Assert that the class is a subclass of parentClass.
    if parentClass is not None:
        if not issubclass(aClass, parentClass):
            raise TypeError(u"%s is not a subclass of %s" %
                            (fullClassName, parentClass))

    # Return a reference to the class itself, not an instantiated object.
    return aClass

######################
##       Usage      ##
######################

class StorageManager: pass
class StorageManagerMySQL(StorageManager): pass

def storage_object(aFullClassName, allOptions={}):
    aStoreClass = _get_class(aFullClassName, StorageManager)
    return aStoreClass(allOptions) 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2012-01-04T02:17:21.483

这应该工作

```
path = os.path.join('./path/to/folder/with/py/files', '*.py')
for infile in glob.glob(path):
    basename = os.path.basename(infile)
    basename_without_extension = basename[:-3]

    # http://docs.python.org/library/imp.html?highlight=imp#module-imp
    imp.load_source(basename_without_extension, infile) 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2014-11-18T13:06:35.153

在 Linux 中，在 Python 脚本所在的目录中添加符号链接是可行的。

IE：

```
ln -s /absolute/path/to/module/module.py /absolute/path/to/script/module.py 
```

如果`/absolute/path/to/script/module.pyc`您更改`/absolute/path/to/module/module.py`.

然后在文件*mypythonscript.py*中包含以下内容：

```
from module import * 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2018-01-10T15:58:46.327

这将允许在 3.4 中导入已编译的 (pyd) Python 模块：

```
import sys
import importlib.machinery

def load_module(name, filename):
    # If the Loader finds the module name in this list it will use
    # module_name.__file__ instead so we need to delete it here
    if name in sys.modules:
        del sys.modules[name]
    loader = importlib.machinery.ExtensionFileLoader(name, filename)
    module = loader.load_module()
    locals()[name] = module
    globals()[name] = module

load_module('something', r'C:\Path\To\something.pyd')
something.do_something() 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2018-01-26T04:52:15.063

一种非常简单的方法：假设您想要导入具有相对路径的文件 ../../MyLibs/pyfunc.py

```
libPath = '../../MyLibs'
import sys
if not libPath in sys.path: sys.path.append(libPath)
import pyfunc as pf 
```

但是，如果您没有守卫就成功了，那么您最终可以走很长的路。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2019-09-08T15:48:09.550

我基于`importlib`模块编写了自己的全局和可移植导入函数，用于：

*   能够将两个模块作为子模块导入，并将模块的内容导入父模块（如果没有父模块，则导入全局）。
*   能够导入文件名中带有句点字符的模块。
*   能够导入具有任何扩展名的模块。
*   能够为子模块使用独立名称，而不是默认情况下不带扩展名的文件名。
*   能够基于先前导入的模块定义导入顺序，而不是依赖于`sys.path`或依赖于任何搜索路径存储。

示例目录结构：

```
<root>
 |
 +- test.py
 |
 +- testlib.py
 |
 +- /std1
 |   |
 |   +- testlib.std1.py
 |
 +- /std2
 |   |
 |   +- testlib.std2.py
 |
 +- /std3
     |
     +- testlib.std3.py 
```

包含依赖和顺序：

```
test.py
  -> testlib.py
    -> testlib.std1.py
      -> testlib.std2.py
    -> testlib.std3.py 
```

执行：

最新更改存储：[https ://sourceforge.net/p/tacklelib/tacklelib/HEAD/tree/trunk/python/tacklelib/tacklelib.py](https://sourceforge.net/p/tacklelib/tacklelib/HEAD/tree/trunk/python/tacklelib/tacklelib.py)

**测试.py**：

```
import os, sys, inspect, copy

SOURCE_FILE = os.path.abspath(inspect.getsourcefile(lambda:0)).replace('\\','/')
SOURCE_DIR = os.path.dirname(SOURCE_FILE)

print("test::SOURCE_FILE: ", SOURCE_FILE)

# portable import to the global space
sys.path.append(TACKLELIB_ROOT) # TACKLELIB_ROOT - path to the library directory
import tacklelib as tkl

tkl.tkl_init(tkl)

# cleanup
del tkl # must be instead of `tkl = None`, otherwise the variable would be still persist
sys.path.pop()

tkl_import_module(SOURCE_DIR, 'testlib.py')

print(globals().keys())

testlib.base_test()
testlib.testlib_std1.std1_test()
testlib.testlib_std1.testlib_std2.std2_test()
#testlib.testlib.std3.std3_test()                             # does not reachable directly ...
getattr(globals()['testlib'], 'testlib.std3').std3_test()     # ... but reachable through the `globals` + `getattr`

tkl_import_module(SOURCE_DIR, 'testlib.py', '.')

print(globals().keys())

base_test()
testlib_std1.std1_test()
testlib_std1.testlib_std2.std2_test()
#testlib.std3.std3_test()                                     # does not reachable directly ...
globals()['testlib.std3'].std3_test()                         # ... but reachable through the `globals` + `getattr` 
```

**测试库.py**：

```
# optional for 3.4.x and higher
#import os, inspect
#
#SOURCE_FILE = os.path.abspath(inspect.getsourcefile(lambda:0)).replace('\\','/')
#SOURCE_DIR = os.path.dirname(SOURCE_FILE)

print("1 testlib::SOURCE_FILE: ", SOURCE_FILE)

tkl_import_module(SOURCE_DIR + '/std1', 'testlib.std1.py', 'testlib_std1')

# SOURCE_DIR is restored here
print("2 testlib::SOURCE_FILE: ", SOURCE_FILE)

tkl_import_module(SOURCE_DIR + '/std3', 'testlib.std3.py')

print("3 testlib::SOURCE_FILE: ", SOURCE_FILE)

def base_test():
  print('base_test') 
```

**testlib.std1.py**：

```
# optional for 3.4.x and higher
#import os, inspect
#
#SOURCE_FILE = os.path.abspath(inspect.getsourcefile(lambda:0)).replace('\\','/')
#SOURCE_DIR = os.path.dirname(SOURCE_FILE)

print("testlib.std1::SOURCE_FILE: ", SOURCE_FILE)

tkl_import_module(SOURCE_DIR + '/../std2', 'testlib.std2.py', 'testlib_std2')

def std1_test():
  print('std1_test') 
```

**testlib.std2.py**：

```
# optional for 3.4.x and higher
#import os, inspect
#
#SOURCE_FILE = os.path.abspath(inspect.getsourcefile(lambda:0)).replace('\\','/')
#SOURCE_DIR = os.path.dirname(SOURCE_FILE)

print("testlib.std2::SOURCE_FILE: ", SOURCE_FILE)

def std2_test():
  print('std2_test') 
```

**testlib.std3.py**：

```
# optional for 3.4.x and higher
#import os, inspect
#
#SOURCE_FILE = os.path.abspath(inspect.getsourcefile(lambda:0)).replace('\\','/')
#SOURCE_DIR = os.path.dirname(SOURCE_FILE)

print("testlib.std3::SOURCE_FILE: ", SOURCE_FILE)

def std3_test():
  print('std3_test') 
```

**输出**（`3.7.4`）：

```
test::SOURCE_FILE:  <root>/test01/test.py
import : <root>/test01/testlib.py as testlib -> []
1 testlib::SOURCE_FILE:  <root>/test01/testlib.py
import : <root>/test01/std1/testlib.std1.py as testlib_std1 -> ['testlib']
import : <root>/test01/std1/../std2/testlib.std2.py as testlib_std2 -> ['testlib', 'testlib_std1']
testlib.std2::SOURCE_FILE:  <root>/test01/std1/../std2/testlib.std2.py
2 testlib::SOURCE_FILE:  <root>/test01/testlib.py
import : <root>/test01/std3/testlib.std3.py as testlib.std3 -> ['testlib']
testlib.std3::SOURCE_FILE:  <root>/test01/std3/testlib.std3.py
3 testlib::SOURCE_FILE:  <root>/test01/testlib.py
dict_keys(['__name__', '__doc__', '__package__', '__loader__', '__spec__', '__annotations__', '__builtins__', '__file__', '__cached__', 'os', 'sys', 'inspect', 'copy', 'SOURCE_FILE', 'SOURCE_DIR', 'TackleGlobalImportModuleState', 'tkl_membercopy', 'tkl_merge_module', 'tkl_get_parent_imported_module_state', 'tkl_declare_global', 'tkl_import_module', 'TackleSourceModuleState', 'tkl_source_module', 'TackleLocalImportModuleState', 'testlib'])
base_test
std1_test
std2_test
std3_test
import : <root>/test01/testlib.py as . -> []
1 testlib::SOURCE_FILE:  <root>/test01/testlib.py
import : <root>/test01/std1/testlib.std1.py as testlib_std1 -> ['testlib']
import : <root>/test01/std1/../std2/testlib.std2.py as testlib_std2 -> ['testlib', 'testlib_std1']
testlib.std2::SOURCE_FILE:  <root>/test01/std1/../std2/testlib.std2.py
2 testlib::SOURCE_FILE:  <root>/test01/testlib.py
import : <root>/test01/std3/testlib.std3.py as testlib.std3 -> ['testlib']
testlib.std3::SOURCE_FILE:  <root>/test01/std3/testlib.std3.py
3 testlib::SOURCE_FILE:  <root>/test01/testlib.py
dict_keys(['__name__', '__doc__', '__package__', '__loader__', '__spec__', '__annotations__', '__builtins__', '__file__', '__cached__', 'os', 'sys', 'inspect', 'copy', 'SOURCE_FILE', 'SOURCE_DIR', 'TackleGlobalImportModuleState', 'tkl_membercopy', 'tkl_merge_module', 'tkl_get_parent_imported_module_state', 'tkl_declare_global', 'tkl_import_module', 'TackleSourceModuleState', 'tkl_source_module', 'TackleLocalImportModuleState', 'testlib', 'testlib_std1', 'testlib.std3', 'base_test'])
base_test
std1_test
std2_test
std3_test 
```

在 Python`3.7.4`中测试`3.2.5`，，，`2.7.16`

**优点**：

*   可以将两个模块作为子模块导入，也可以将模块的内容导入父模块（如果没有父模块，则导入全局）。
*   可以导入文件名中带有句点的模块。
*   可以从任何扩展模块导入任何扩展模块。
*   可以为子模块使用独立名称，而不是默认情况下不带扩展名的文件名（例如`testlib.std.py`as `testlib`、`testlib.blabla.py`as`testlib_blabla`等）。
*   不依赖于`sys.path`任何搜索路径存储。
*   不需要保存/恢复全局变量`SOURCE_FILE`，例如`SOURCE_DIR`调用`tkl_import_module`.
*   [for`3.4.x`及更高版本] 可以在嵌套`tkl_import_module`调用中混合模块名称空间（例如：`named->local->named`或`local->named->local`等）。
*   [for`3.4.x`及更高版本] 可以自动将全局变量/函数/类从声明的地方导出到通过`tkl_import_module`（通过`tkl_declare_global`函数）导入的所有子模块。

**缺点**：

*   [for`3.3.x`及以下] 要求`tkl_import_module`在所有调用的模块中声明`tkl_import_module`（代码重复）

**更新 1,2**（仅适用于`3.4.x`及更高版本）：

在 Python 3.4 及更高版本中，您可以通过在顶级模块中声明来绕过`tkl_import_module`在每个模块中声明的要求，并且该函数将在一次调用中将自身注入所有子模块（这是一种自我部署导入）。`tkl_import_module`

**更新 3**：

添加`tkl_source_module`了类似于 bash`source`的功能，并在导入时支持执行保护（通过模块合并而不是导入来实现）。

**更新 4**：

添加`tkl_declare_global`了将模块全局变量自动导出到模块全局变量不可见的所有子模块的功能，因为它不是子模块的一部分。

**更新 5**：

所有函数都移到了土库库中，请参见上面的链接。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2020-08-09T23:20:27.320

这是我仅使用 pathlib 的两个实用程序函数。它从路径推断模块名称。

默认情况下，它会递归地从文件夹中加载所有 Python 文件，并将**init** .py 替换为父文件夹名称。但是您也可以提供一个路径和/或一个全局对象来选择一些特定的文件。

```
from pathlib import Path
from importlib.util import spec_from_file_location, module_from_spec
from typing import Optional

def get_module_from_path(path: Path, relative_to: Optional[Path] = None):
    if not relative_to:
        relative_to = Path.cwd()

    abs_path = path.absolute()
    relative_path = abs_path.relative_to(relative_to.absolute())
    if relative_path.name == "__init__.py":
        relative_path = relative_path.parent
    module_name = ".".join(relative_path.with_suffix("").parts)
    mod = module_from_spec(spec_from_file_location(module_name, path))
    return mod

def get_modules_from_folder(folder: Optional[Path] = None, glob_str: str = "*/**/*.py"):
    if not folder:
        folder = Path(".")

    mod_list = []
    for file_path in sorted(folder.glob(glob_str)):
        mod_list.append(get_module_from_path(file_path))

    return mod_list 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2021-02-13T01:06:29.487

这是一种加载文件的方法，类似于 C 等。

```
from importlib.machinery import SourceFileLoader
import os

def LOAD(MODULE_PATH):
    if (MODULE_PATH[0] == "/"):
        FULL_PATH = MODULE_PATH;
    else:
        DIR_PATH = os.path.dirname (os.path.realpath (__file__))
        FULL_PATH = os.path.normpath (DIR_PATH + "/" + MODULE_PATH)

    return SourceFileLoader (FULL_PATH, FULL_PATH).load_module () 
```

实现方式：

```
Y = LOAD("../Z.py")
A = LOAD("./A.py")
D = LOAD("./C/D.py")
A_ = LOAD("/IMPORTS/A.py")

Y.DEF();
A.DEF();
D.DEF();
A_.DEF(); 
```

每个文件如下所示：

```
def DEF():
    print("A"); 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2021-03-05T20:18:28.810

我发现这是一个简单的答案：

```
module = dict()

code = """
import json

def testhi() :
    return json.dumps({"key" : "value"}, indent = 4 )
"""

exec(code, module)
x = module['testhi']()
print(x) 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-09-08T15:29:30.133

这个答案是对[Sebastian Rittau](https://stackoverflow.com/questions/67631/how-to-import-a-module-given-the-full-path/67692#67692)对评论的回答的补充：“但是如果你没有模块名称怎么办？” 这是获取给定文件名的可能 Python 模块名称的一种快速而肮脏的方法——它只是向上爬，直到找到一个没有`__init__.py`文件的目录，然后将其转回文件名。对于 Python 3.4+（使用 pathlib），这是有道理的，因为 Python 2 人们可以使用“imp”或其他方式进行相对导入：

```
import pathlib

def likely_python_module(filename):
    '''
    Given a filename or Path, return the "likely" python module name.  That is, iterate
    the parent directories until it doesn't contain an __init__.py file.

    :rtype: str
    '''
    p = pathlib.Path(filename).resolve()
    paths = []
    if p.name != '__init__.py':
        paths.append(p.stem)
    while True:
        p = p.parent
        if not p:
            break
        if not p.is_dir():
            break

        inits = [f for f in p.iterdir() if f.name == '__init__.py']
        if not inits:
            break

        paths.append(p.stem)

    return '.'.join(reversed(paths)) 
```

当然有改进的可能性，并且可选`__init__.py`文件可能需要进行其他更改，但如果您有`__init__.py`一般情况，这可以解决问题。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2022-01-21T07:32:52.640

您可以使用 pydoc 中的 importfile

```
from pydoc import importfile
module = importfile('/full/path/to/module/module.py')
name = module.myclass() # myclass is a class inside your python file 
```

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2014-11-25T12:58:47.950

我认为最好的方法是来自官方文档（[29.1\. imp — Access the import internals](https://docs.python.org/3.2/library/imp.html#examples)）：

```
import imp
import sys

def __import__(name, globals=None, locals=None, fromlist=None):
    # Fast path: see if the module has already been imported.
    try:
        return sys.modules[name]
    except KeyError:
        pass

    # If any of the following calls raises an exception,
    # there's a problem we can't handle -- let the caller handle it.

    fp, pathname, description = imp.find_module(name)

    try:
        return imp.load_module(name, fp, pathname, description)
    finally:
        # Since we may exit via an exception, close fp explicitly.
        if fp:
            fp.close() 
```

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2021-09-22T15:09:07.407

特殊之处在于使用 Exec() 导入具有绝对路径的模块：（exec 接受代码字符串或代码对象。而 eval 接受表达式。）

```
PYMODULE = 'C:\maXbox\mX47464\maxbox4\examples\histogram15.py';
Execstring(LoadStringJ(PYMODULE)); 
```

然后使用 eval() 获取值或对象：

```
println('get module data: '+evalStr('pyplot.hist(x)')); 
```

使用 exec 加载模块就像使用通配符命名空间导入：

```
Execstring('sys.path.append(r'+'"'+PYMODULEPATH+'")');
Execstring('from histogram import *'); 
```

# objective-c - 除了 Xcode，还有没有用于 Objective-C 的功能齐全的 IDE？

> ID：67640
> 
> 赞同：12
> 
> 时间：2008-09-15T22:31:47.550
> 
> 标签：objective-c, debugging, ide

我知道并拥有 Xcode，但我想知道是否还有其他支持 Objective-C 的完整开发环境？我不是在寻找带有 vim 或 emacs 的解决方案，也不是像 BBEdit 这样支持语法高亮的编辑器，而是一个完整的 IDE：

*   代码完成
*   汇编
*   调试
*   重构

跨平台、支持 vi 键绑定和支持其他语言的加分项。

### 笔记：

我已经更新并接受了下面的答案，因为 Jetbrains 已经发布了他们新的 Objective-C IDE *AppCode的 Early Access。*由于这是一个相当受欢迎的问题，我认为值得更新信息。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-04-20T15:15:29.110

我最近了解到，我最喜欢的 IDE (Idea) 的[Jetbrains](http://www.jetbrains.com/)可能支持 Objective-C（虽然目前尚不清楚它对 iPhone/iPad 开发有多大作用）。有关此问题的早期讨论，请参见[此处](http://www.jetbrains.net/devnet/thread/282271?tstart=0)的线程。

在过去的一两年里，他们开始在其旗舰 IDE 和专用 IDE（用于 Ruby、Python、PHP）中添加额外的语言支持。我想这只是过程中的另一个步骤。对于一个人来说，我希望有除 XCode 之外的另一种选择，而且我想不出我更喜欢的选择。

这显然是目前的vaporware，但我认为这是值得关注的事情。

现在这是一款真正的产品，尽管仍处于抢先体验阶段。有关此新产品的博客，请参见[此处](http://blog.jetbrains.com/objc/)，该博客将为您提供检查 EAP 的指南。

更新：[AppCode](http://www.jetbrains.com/objc/)现已发布，为使用 Xcode 进行 Objective-C 和 iPhone/iPad/Mac 开发提供了一个真正的替代方案。它仍然依赖 Interface Builder 进行 GUI 组件的布局和布线，并使用 iOS 模拟器，但所有编码，包括大量重构、智能模板和静态分析，都可以通过 App Code 获得。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T22:40:00.323

[Textmate](http://macromates.com/)是一个类似于 BBEdit 的编辑器，**但**它能够运行诸如编译、调试、重构之类的命令（尽管它会通过 XCode 执行此操作）。它还具有代码完成功能。

此外，您可以为 Textmate 编写自己的命令，然后运行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-22T12:38:30.680

几个月来，我一直在寻找这样的东西，它不能在 mac 上运行。不幸的是，我认为由于 Objective-C 语言的相对晦涩难懂，没有人会费心为它制作如此全功能的 IDE。到目前为止，我们只有 Xcode。

使用 JBuilder，我爱上了自动完成功能，并在我键入时在屏幕上显示功能“提示”。我是那种比实际语法更能记住“想法”的人，并且真正受益于知道我输入的代码是正确的，而不必在编译时一分钟后发现。然后必须尝试弄清楚我是否只是拼错了一些东西，或者我是否真的因为对正确使用语言的误解而犯了概念错误。代码完成和提示总是为我节省时间。

我知道有些人可能会看不起这一点，并说如果您知道自己在做什么，则该功能是不必要的，但我从未声称自己比其他任何人都好。

我可能不得不放弃并尝试让 OS X 在我的 PC 上运行。这丝毫不打扰我，只是重新启动以来回切换到 Windows。我尝试在 VMWare 下虚拟化运行它，但 XCode 一直在崩溃 :( 这提醒我我要去 google 'leopard vmware' 看看在这方面是否取得了任何进展。

用 Objective C 设计一个完整的代码完成系统的另一个问题是语法有点宽容，我不知道确切的技术术语（强类型？）很难准确地说出什么样的对象属于某个参数和任何对象都可以发送任何消息，无论它是否实现该功能。所以你可以拼错一个函数名，但这并不一定意味着你犯了一个语法错误......也许你的意思是调用那个 OTHER 名字的函数，如果你的对象没有实现这个函数，你只是不想做任何事情.

这就是我**真正**希望在 Objective-C 中看到的，是一个 IDE，一旦它注意到您正在向对象发送消息，它就会显示该对象**已知**可以接受的方法和函数定义列表，并引导您完成填写参数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T19:58:20.123

如果您想为 Mac（或 iPhone）进行开发，我认为坚持使用 Xcode 而不是寻找另一个 IDE 会浪费更少的时间。

Apple 付出了很多努力来杀死该领域的任何竞争对手，以确保任何想要为 Mac 平台开发的开发人员都使用 Xcode，并且只使用 Xcode。

它可能不是最好的 IDE，但它运行良好，而且它是 Apple 的 IDE 开发人员正在使用的。它以某种方式完成了它的工作。框架和文档很好地集成在一起。

我经常使用 TextMate 和 SubEthaEdit，但它们不是您上面描述的完整 IDE。

最好的祝福。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-08T05:59:40.147

简短的回答是：不。有数以千计的 IDE，但 Xcode 是唯一一个你可以认真命名的 IDE。我建议你看看 GNUStep 的尝试（以 Projectcenter、Gorm 的形式），然后你可以想象事情的状态。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-29T20:51:35.623

查看 JetBrains 的名为“App Code”的新 IDE。它仍处于早期访问计划中，但即使存在早期访问错误，它也比**xcode** 4 更好。我一直将它用于商业 iPhone 和 iPad 开发。

[http://www.jetbrains.com/objc/](http://www.jetbrains.com/objc/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-10T18:44:14.633

我想支持 Troy 的回答，并注意 JetBrains 的 AppCode 处于抢先体验阶段，因此您可以免费试用。它有他们其他产品熟悉的 UI，是的，它支持 vi！到目前为止，情况非常好。我遇到了一些问题，以及一些不太正确的 vi-isms，但它仍然比使用 Xcode 更好。我在 AppCode 中使用语法完成进行文本编辑，但切换回 XCode 以进入 GUI 构建器，这在 Xcode 中实际上相当不错。

如果你是像我这样的老家伙，那是无价的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T22:35:54.000

我相信 KDevelop 是唯一支持 Obj-C 的完整 IDE，但我什至不确定它对它的支持程度，因为我自己从未使用过它。值得一试，也许。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T21:26:40.560

找到了另一个，虽然听起来不太理想：

[ActiveDeveloper](http://www.interactive-technology.com/) - 似乎没有积极的支持（最后一次更新是在 2006 年）。仅限 Mac。

KDevelop 听起来它只支持 Objective-C 语法，并且只能通过它的 C 支持。无论如何，我要检查一下。

Textmate 有几个 Objective-C 的截屏视频（[这里](http://macromates.com/screencast/objective-c_part_1.mov)和[这里](http://macromates.com/screencast/objective_c_part_2.mov)）。它仅适用于 Mac，但其他方面看起来还不错。从截屏视频中很难看出集成支持有多强大，因为它似乎只有很多脚本来处理代码。另外，我不知道它是真正的代码完成还是只是扩展片段。

所以看起来没有什么东西可以击中一切。我可能会在 Mac 上完成我的大部分开发工作，所以我想我会用 XCode 试用 TextMate，看看它是否比直接的 XCode 更好。我将快速浏览一下KDevelop。

谢谢。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-11-15T23:41:27.777

支持 Objective-C 的程序员文本编辑器有少数，但我喜欢 Editra，主要是因为我也在 Windows\Nix 上编写 Python，它有很棒的功能。Editra 在所有平台上运行良好，并且有一个不错的插件，如果您需要，它支持 Mercurial、GIT 和 Subversion。另一件好事，它是用 Python 编写的。[伊德拉之家](http://editra.org/)

# mp3 - 如何将使用 Red5 / FMS 录制的 FLV 文件转换为 MP3？

> ID：67647
> 
> 赞同：1
> 
> 时间：2008-09-15T22:32:53.443
> 
> 标签：mp3, flv

我正在寻找一种方法来提取 FLV 文件的音频部分。

我正在从用户的麦克风录制，音频是使用[Nellymoser Asao Codec 编码](http://en.wikipedia.org/wiki/Nellymoser_Asao_Codec)的。这是默认编解码器，无法更改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-16T19:56:56.633

[ffMpeg](http://ffmpeg.mplayerhq.hu/)是要走的路！它适用于我的 SVN Rev 14277。

我使用的命令是：`ffmpeg -i source.flv -nv -f mp3 destination.mp3`

**问题**：

如果您收到此错误消息：`Unsupported audio codec (n)`，请检查**音频标签**部分中的[FLV 规范。](https://www.adobe.com/content/dam/Adobe/en/devnet/flv/pdfs/video_file_format_spec_v10.pdf)

 **ffMpeg 可以解码 n=6 (Nellymoser)。
但是对于 n=4（Nellymoser 8-kHz 单声道）和 n=5（Nellymoser 16-kHz 单声道）它不起作用。

要解决此问题，请在录制流时**使用默认麦克风速率**，否则 ffMpeg 无法对其进行解码。

希望这可以帮助 ！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T22:42:19.070

这不是一个确切的答案，但我在调查 FLV 文件以满足业务需求时所做的一些相关说明。

大多数 FLV 音频以 MP3 格式编码，这意味着您可以直接从 FLV 容器中提取它。如果 FLV 是由某人从他们的麦克风录音创建的，则音频将使用专有 (IIRC) 的 Nellymoser Asao 编解码器进行编码。

我会检查[libavcodec](http://ffmpeg.mplayerhq.hu/)，它本机处理 FLV/MP3/Nellymoser，并且应该让您获得音频。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T07:05:57.517

我目前正在为此使用 FFmpeg 版本 SVN-r12665，没有任何问题（控制台版本，没有任何包装库）。在非控制台 .NET 环境中使用控制台应用程序有一些注意事项，但这一切都相当简单。直接使用 libavcodec DLL 要麻烦得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T03:06:12.773

我打算推荐这个： [http](http://code.google.com/hosting/takenDown?project=nelly2pcm&notice=7281) ://code.google.com/hosting/takenDown?project=nelly2pcm¬ice=7281 。

但是已经被下架了。很高兴我先得到一份副本:-)

# .net - LINQ to SQL IsDiscriminator 列不能继承吗？

> ID：67659
> 
> 赞同：2
> 
> 时间：2008-09-15T22:35:15.607
> 
> 标签：.net, asp.net, linq, linq-to-sql, inheritance

我正在设计我的数据库和 LINQ To SQL ASP.NET Web 应用程序。

想象一下，我有两种类型的页面：普通页面和根页面。有些页面是根。有些页面不是。

我有一个 Page 数据库表和一个 RootPage 数据库表：

```
 Page
      ----
   PK PageId
      HtmlTitle
      PageHeading
      MetaDescription
      IsRoot

      RootPage
      --------
FK PK PageId
      FavIcon
      StyleSheet
      MasterPage 
```

我认为如果在我的 DBML 文件中设置 IsRoot 列的 IsDiscriminator 属性，那么我的 RootPage 类将继承 Page 类。

我希望能够在我的代码中这样工作：

```
MyDataContext db = new MyDataContext();

var roots = from p in db.Pages
            where p is RootPage
            select (RootPage)p; 
```

或者像这样：

```
RootPage r = new RootPage();
r.HtmlTitle = "Foo";
r.FavIcon = "bar.ico";
...
db.Pages.Add(r);
db.SubmitChanges(); 
```

LINQ to SQL IsDiscriminator 列可以为空还是假？这行得通吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T23:02:39.380

这里的问题是您试图在两个表 RootPage 和 Page 之间拆分您的类。

不幸的是，LINQ to SQL 只支持单表继承，所以这不起作用。

您需要将两个表定义合并在一起，并使特定于 RootPage 的字段可以为空。例如

```
 Page
   ----
PK PageId
   HtmlTitle
   PageHeading
   MetaDescription
   IsRoot
   FavIcon (Nullable)
   StyleSheet (Nullable)
   MasterPage (Nullable) 
```

然后将 IsRoot 设置为鉴别器，并将 Page 类标记为默认类型，并将 RootPage 标记为鉴别器值“True”的类。

如果您不介意只读内容，另一种方法是创建一个将两个表连接在一起的视图并以此为基础创建类。

第三种选择可能是考虑组合，例如将 RootPage 表重命名为 Root 并在 RootPage 和 Root 之间创建关联。这意味着您的 RootPage 类不会拥有所有这些属性，而是只会公开它们实际所在的 Root 属性。

# html - IE7 CSS 滚动 div 错误

> ID：67665
> 
> 赞同：51
> 
> 时间：2008-09-15T22:36:00.737
> 
> 标签：html, css, internet-explorer-7

我最近遇到了一个 IE7 唯一的错误，我想我会分享，所以当我 6 个月后来到这个网站想弄清楚同样的事情时，我手头就有了。

我相信重新创建此错误的最简单方法是在具有声明的 doctype 的页面中使用以下 html（它在“quirks mode”/no-doctype 下正常工作）：

```
<div style="overflow: auto; height: 150px;">
    <div style="position: relative;">[...]</div>
</div> 
```

在IE7中，外层div是固定大小的，内层div是相对定位的，包含的内容较多（假设内层div会导致溢出）。在所有其他浏览器中，这似乎按预期工作。

截屏： ![错误截图](https://i.stack.imgur.com/98kiZ.png)

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2008-09-15T22:36:28.770

最简单的解决方法是添加`position: relative;`到外部 div。这将使 IE7 按预期工作。

（参见：[http](http://rowanw.com/bugs/overflow_relative.htm) ://rowanw.com/bugs/overflow_relative.htm ）。

**编辑：** [waybackmachine.org 上断开链接的缓存版本](http://web.archive.org/web/20110515020527/http://rowanw.com/bugs/overflow_relative.htm)

# sql - 使用 sqlplus 或 rman 进行 oracle 10g 测试的备份/恢复数据库

> ID：67666
> 
> 赞同：8
> 
> 时间：2008-09-15T22:36:02.720
> 
> 标签：sql, oracle, backup, oracle10g, rman

将 Oracle 10g 与我们的测试服务器一起使用是最有效/最简单的备份和恢复数据库到静态点的方法，假设您总是希望在创建备份后返回给定点。

示例用例如下

1.  安装和配置所有软件
2.  修改数据到基础测试点
3.  以某种方式进行备份（这是问题的一部分，如何做到这一点）
4.  做测试
5.  返回第3步状态（恢复到备份点，这是问题的另一半）

**理想情况下，这将通过 sqlplus 或 rman 或其他一些可编写脚本的方法来完成。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-16T07:25:47.093

您无需在基准时间进行备份。只需启用闪回数据库，创建保证还原点，运行测试并闪回到之前创建的还原点。

这样做的步骤是：

1.  以挂载模式启动实例。

    启动力安装；

2.  创建还原点。

    创建还原点 before_test 保证闪回数据库；

3.  打开数据库。

    更改数据库打开；

4.  运行你的测试。
5.  关闭并挂载实例。

    立即关机；启动挂载；

6.  闪回还原点。

    闪回数据库到还原点 before_test；

7.  打开数据库。

    更改数据库打开；

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T22:41:25.013

您可以使用 Oracle 中称为[Flashback](http://www.oracle.com/technology/deploy/availability/htdocs/Flashback_Overview.htm)的功能，该功能允许您创建一个还原点，您可以在完成测试后轻松跳回该还原点。

引自网站，

> 闪回数据库就像您的数据库的“倒带按钮”。它提供数据库时间点恢复，而无需首先恢复数据库的备份。当您消除从磁带恢复数据库备份所需的时间时，数据库时间点恢复速度很快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T11:05:07.223

根据我的经验，导入/导出可能是要走的路。导出创建数据库的逻辑快照，因此您不会发现它对大型数据库或严格的性能要求有用。然而，它非常适合制作快照以及不能在许多机器上使用的东西。

我在 Rails 项目中使用它来获取产品快照，我们可以在开发人员之间交换以进行集成测试，并且我们在 rake 脚本中完成了这项工作。我们编写了一个小的 sqlplus 脚本，它破坏了数据库，然后在顶部导入了转储文件。

您可能想要查看的一些文章： [OraFAQ Cheatsheet](http://www.orafaq.com/wiki/Import_Export_FAQ) [Oracle Wiki](http://wiki.oracle.com/page/Oracle+export+and+import+?t=anon)

Oracle 显然不再喜欢 imp/exp 支持[数据泵](http://www.oracle-base.com/articles/10g/OracleDataPump10g.php)，当我们使用数据泵时，我们需要我们无法拥有的东西（即我们无法在共享环境中获得的 SYSDBA 权限）。所以看看，但如果数据泵不是你的包，不要灰心，旧的 imp/exp 仍然存在 :)

我不能为这种事情推荐 RMAN，因为 RMAN 需要进行大量设置并且需要在数据库中进行配置（它也有自己的目录数据库用于备份，这在众所周知的裸机还原中很痛苦）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T22:44:57.953

如果您使用支持写时复制快照的文件系统，您可以将数据库设置为您想要的状态。然后关闭一切并拍摄文件系统快照。然后进行测试，当您准备好重新开始时，您可以回滚快照。假设您有一个支持快照的文件系统，这可能比其他选项更简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T11:41:42.470

@Michael Ridley 解决方案完全可以编写脚本，并且可以与任何版本的 oracle 一起使用。

这正是我所做的，我有一个每周运行的脚本

1.  回滚文件系统
2.  应用生产归档日志
3.  拍摄新的“Pre-Data-Masking”FS 快照
4.  重置日志
5.  应用“预生产”数据屏蔽。
6.  拍摄新的“Post-Data-Masking”快照（允许回滚以发布屏蔽数据）
7.  打开数据库

这使我们能够将我们的开发数据库保持在我们的生产数据库附近。

为此，我使用 ZFS。

此方法也可用于您的应用程序，甚至您的整个“环境”（例如，您可以使用单个（脚本）命令“回滚”整个环境。

但是，如果您运行的是 10g，那么您可能首先要研究的是 Flashback，因为它内置在数据库中。

# .net - 如何将代码片段（vb/c#/.net/sql）保存到 sql server

> ID：67669
> 
> 赞同：1
> 
> 时间：2008-09-15T22:36:49.457
> 
> 标签：.net, code-snippets

我想创建一个代码/知识库，我可以在其中保存我的 vb.net/c#.net/sqlserver 代码片段以供以后使用。

我尝试在我的页面指令中将 ValidateRequest 属性设置为 false，并使用 HttpUtility.HtmlEncode (c#.net) 对值进行编码，但仍然出现错误。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T22:41:07.293

HttpUtility.HtmlEncode 将发生得太晚，假设您收到来自客户端的代码回发异常。您可以在客户端上运行一些 javascript 来对服务器 Postback 进行预编码。

请参阅以下链接以获取快速示例：[比较 escape()、encodeURI() 和 encodeURIComponent()](http://xkr.us/articles/javascript/encode-compare/)

# c# - DataSet.Select 和 DateTime

> ID：67676
> 
> 赞同：1
> 
> 时间：2008-09-15T22:38:26.550
> 
> 标签：c#, .net, dataset

如何使用 .NET DataSet.Select 方法搜索与 DateTime 匹配的记录？我应该使用什么格式来输入我的日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T22:41:44.657

最好的方法是 dd MMM yyyy（即 2008 年 9 月 15 日）。这意味着对于不同的本地人来说，不可能弄错。

```
ds.select(DBDate = '15 Sep 2008') 
```

您也可以使用 DateFormat 函数转换为长日期格式，这也可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T22:53:34.160

我对 SQL Select 使用以下内容：

```
 public string BuildSQL()
    {
        // Format: CAST('2000-05-08 12:35:29' AS datetime)
        StringBuilder sb = new StringBuilder("CAST('");

        sb.Append(_dateTime.ToString("yyyy-MM-dd HH:mm:ss"));
        sb.Append("' AS datetime)");

        return sb.ToString();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T05:00:39.647

要获得完全匹配，您可以使用[**往返日期/时间模式**](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)。例如

```
dataTable.Select(String.Format("DateCreated='{0}'",_dateCreated.ToString("O"))); 
```

# javascript - 如何使用 Javascript 在浏览器中通过 XY 坐标进行定位？

> ID：67682
> 
> 赞同：4
> 
> 时间：2008-09-15T22:39:36.453
> 
> 标签：javascript, jquery, dom

我正在努力做到这一点，因此当用户向下滚动页面，单击链接，做他们需要做的任何事情，然后返回带有链接的页面时，它们位于相同的（xy）位置他们以前的浏览器。我怎么做？

我是 DOM 新手，所以我不太了解如何执行此操作。

目标浏览器：IE6/7/8、Firefox 2/3、Opera、Safari

补充：我正在使用一个叫JQuery的程序来帮助我学习

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T15:51:08.893

要获取用户单击页面的 xy 位置，请使用以下 jQuery 代码：

```
<html>
    <head>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript">
            jQuery(document).ready(function(){
                $("#special").click(function(e){
                    $('#status2').html(e.pageX +', '+ e.pageY);
                }); 
            });
        </script>
    </head>
    <body>
        <h2 id="status2">
            0, 0
        </h2>
        <div style="width: 100px; height: 100px; background:#ccc;" id="special">
            Click me anywhere!
        </div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T02:00:45.783

通常，如果您离开然后返回，浏览器将保留页面视口（在您最喜欢的新闻网站上的任何页面上尝试）。唯一的例外可能是您调整缓存设置以每次重新下载和重新呈现页面。

不这样做（也就是说，不将您的页面设置为从不缓存）可能是解决问题的最简单、最不突兀的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T22:47:05.407

试试[这个](http://www.codelifter.com/main/javascript/capturemouseposition1.)或[这个](http://snipplr.com/view/3032/get-mouse-position-from-quirksmodeorg/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T22:50:32.170

据我回忆，获取视口位置的代码因浏览器而异，因此使用某种框架会更容易，例如，[Prototype](http://prototypejs.org/api/document/viewport)有一个函数 document.viewport.getScrollOffsets （我相信它就是你追求）。

但是，获取坐标只是其中的一部分，另一部分将在以后对它们进行处理。在这种情况下，您可以将事件侦听器添加到 window.unload 事件，当该事件触发时，将位置保存在 cookie 中，然后当用户再次打开页面时，检查该 cookie 是否存在并相应地滚动。

尽管如果您关心的只是让用户通过浏览器的“后退”按钮返回到他所在的位置，那么大多数浏览器不是已经自动执行此操作了吗？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-15T22:41:57.587

你可以使用 offsetLeft 和 offsetTop

# linux - 如何加入网络摄像头 FLV

> ID：67685
> 
> 赞同：8
> 
> 时间：2008-09-15T22:39:47.827
> 
> 标签：linux, flash, ffmpeg, webcam, mencoder

我希望我的网站加入一些 FLV 文件中的网络摄像头记录（比如这个）。这需要在 Linux 上完成，无需用户输入。我该怎么做呢？为简单起见，我将使用相同的 flv 作为两个输入，希望得到一个连续两次播放相同内容的 flv。

这应该很容易，对吧？[ffmpeg FAQ](http://ffmpeg.mplayerhq.hu/faq.html#SEC31)中甚至还有完整的代码示例。

好吧，管道似乎给我带来了问题（在我运行 Leopard 的 mac 和 Ubuntu 8.04 上），所以让我们保持简单并使用普通文件。另外，如果我不指定 15 fps 的速率，视觉部分会播放[得非常快](http://www.marc-andre.ca/posts/blog/webcam/output-norate.flv)。示例脚本因此变为：

```
ffmpeg -i input.flv -vn -f u16le -acodec pcm_s16le -ac 2 -ar 44100 \
  - > temp.a < /dev/null
ffmpeg -i input.flv -an -f yuv4mpegpipe - > temp.v < /dev/null
cat temp.v temp.v > all.v
cat temp.a temp.a > all.a
ffmpeg -f u16le -acodec pcm_s16le -ac 2 -ar 44100 -i all.a \
  -f yuv4mpegpipe -i all.v -sameq -y output.flv 
```

好吧，使用它可以处理音频，但我只能在第一次获得视频。这似乎是我作为 input.flv 抛出的任何 flv 的情况，包括 red5 附带的电影预告片。

a) 为什么示例脚本没有像宣传的那样工作，特别是为什么我没有得到我期望的所有视频？

b) 为什么我必须指定帧率，而 Wimpy 播放器可以以正确的速度播放 flv？

我发现加入两个 flv 的唯一方法是使用 mencoder。问题是，mencoder 似乎没有加入 flvs：

```
mencoder input.flv input.flv -o output.flv -of lavf -oac copy \
-ovc lavc -lavcopts vcodec=flv 
```

我得到一个浮点异常......

```
MEncoder 1.0rc2-4.0.1 (C) 2000-2007 MPlayer Team
CPU: Intel(R) Xeon(R) CPU 5150 @ 2.66GHz (Family: 6, Model: 15, Stepping: 6)
CPUflags: Type: 6 MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 1
Compiled for x86 CPU with extensions: MMX MMX2 SSE SSE2

success: format: 0 data: 0x0 - 0x45b2f
libavformat file format detected.
[flv @ 0x697160]Unsupported audio codec (6)
[flv @ 0x697160]Could not find codec parameters (Audio: 0x0006, 22050 Hz, mono)
[lavf] Video stream found, -vid 0
[lavf] Audio stream found, -aid 1
VIDEO: [FLV1] 240x180 0bpp 1000.000 fps 0.0 kbps ( 0.0 kbyte/s)
[V] filefmt:44 fourcc:0x31564C46 size:240x180 fps:1000.00 ftime:=0.0010
** MUXER_LAVF *****************************************************************
REMEMBER: MEncoder's libavformat muxing is presently broken and can generate
INCORRECT files in the presence of B frames. Moreover, due to bugs MPlayer
will play these INCORRECT files as if nothing were wrong!
*******************************************************************************
OK, exit
Opening video filter: [expand osd=1]
Expand: -1 x -1, -1 ; -1, osd: 1, aspect: 0.000000, round: 1
==========================================================================
Opening video decoder: [ffmpeg] FFmpeg's libavcodec codec family
Selected video codec: [ffflv] vfm: ffmpeg (FFmpeg Flash video)
==========================================================================
audiocodec: framecopy (format=6 chans=1 rate=22050 bits=16 B/s=0 sample-0)
VDec: vo config request - 240 x 180 (preferred colorspace: Planar YV12)
VDec: using Planar YV12 as output csp (no 0)
Movie-Aspect is undefined - no prescaling applied.
videocodec: libavcodec (240x180 fourcc=31564c46 [FLV1])
VIDEO CODEC ID: 22
AUDIO CODEC ID: 10007, TAG: 0
Writing header...
[NULL @ 0x67d110]codec not compatible with flv
Floating point exception 
```

c) mencoder 有没有办法正确解码和编码 flvs？

所以目前我发现加入flvs的唯一方法，就是使用ffmpeg在flv和avi之间来回切换，使用mencoder加入avis：

```
ffmpeg -i input.flv -vcodec rawvideo -acodec pcm_s16le -r 15 file.avi
mencoder -o output.avi -oac copy -ovc copy -noskip file.avi file.avi
ffmpeg -i output.avi output.flv 
```

d) 必须有更好的方法来实现这一点……哪一个？

e) 但是，由于帧率的问题，只有具有恒定帧率的 flvs（就像我通过[facebook](http://ffmpeg.mplayerhq.hu/faq.html#SEC31)录制的那样）才能正确转换为 avis，但这对于我似乎正在录制的 flvs 不起作用（像[这样一个](http://www.marc-andre.ca/posts/blog/webcam/test-wowza.flv)或[这个](http://www.marc-andre.ca/posts/blog/webcam/test-red5-publisher.flv)）。有没有办法为这些flvs做到这一点？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T22:23:52.107

我认为用 Ruby 重写它会是一个很好的学习练习。

它是。

六个月后，三颗宝石后，[这是发布的产品](http://github.com/marcandre/flvedit)。

我仍然会做一些工作，但它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T10:21:09.093

您将在这里遇到一个非常微妙的问题，因为大多数视频和音频格式（尤其是在普通容器中）使用“全局标题”，这意味着在文件的开头它们有一个指定压缩信息（如宽度、高度等）的标题) 对于整个文件。连接两个流显然会失败，因为它现在将有两个标头而不是一个，并且复用器可能不喜欢这样。转换为 AVI 可能正在解决您的问题，因为 mencoder 具有连接 AVI 的代码 - 该代码正确处理标题问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T04:45:37.867

在将我的问题发布在 mencoder 的邮件列表上后，尝试了其他事情，我求助于编写自己的工具！我从开始`flvtool`挖掘代码并编写了大约 40 行代码之后，它工作正常，质量没有损失（因为没有转码）。

我会尽快发布，有兴趣的可以联系我。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-09-20T07:32:13.200

不知道这是否真的有效，但尝试使用这个命令：

```
cat yourVideos/*.flv >> big.flv 
```

这可能会损坏元信息，因此在执行该命令后使用“flvtool”（您可以通过 google 找到它的 ruby​​ 脚本）来修复它。

# git - 如何在 Git 中克隆所有远程分支

> ID：67699
> 
> 赞同：4516
> 
> 时间：2008-09-15T22:42:07.430
> 
> 标签：git, git-branch, git-clone, remote-branch

我有一个`master`和一个`development`分支，都推送到了[GitHub](http://en.wikipedia.org/wiki/GitHub)。我已经`clone`d、`pull`ed 和ed，但除了分支`fetch`之外，我仍然无法得到任何东西。`master`

我确定我遗漏了一些明显的东西，但是我已经阅读了手册，但我一点也不高兴。

* * *

## 回答 #1

> 赞同：4942
> 
> 时间：2008-09-16T13:28:22.230

首先，克隆一个远程[Git](http://en.wikipedia.org/wiki/Git_%28software%29)存储库并[cd](http://en.wikipedia.org/wiki/Cd_%28command%29)进入它：

```
$ git clone git://example.com/myproject
$ cd myproject 
```

接下来，查看存储库中的本地分支：

```
$ git branch
* master 
```

但是您的存储库中还隐藏着其他分支！`-a`您可以使用标志看到这些：

```
$ git branch -a
* master
  remotes/origin/HEAD
  remotes/origin/master
  remotes/origin/v1.0-stable
  remotes/origin/experimental 
```

如果你只是想快速浏览一下上游分支，可以直接查看：

```
$ git checkout origin/experimental 
```

但是，如果您想在该分支上工作，则需要创建一个本地跟踪分支，该分支通过以下方式自动完成：

```
$ git checkout experimental 
```

你会看到

```
Branch experimental set up to track remote branch experimental from origin.
Switched to a new branch 'experimental' 
```

在这里，“新分支”只是意味着从索引中获取分支并在本地为您创建。正如*上*一行告诉您的那样，正在设置分支以跟踪远程分支，这通常意味着 origin/branch_name 分支。

现在，如果您查看本地分支机构，您会看到：

```
$ git branch
* experimental
  master 
```

实际上，您可以使用`git remote`.

```
$ git remote add win32 git://example.com/users/joe/myproject-win32-port
$ git branch -a
* master
  remotes/origin/HEAD
  remotes/origin/master
  remotes/origin/v1.0-stable
  remotes/origin/experimental
  remotes/win32/master
  remotes/win32/new-widgets 
```

在这一点上，事情变得非常疯狂，所以运行`gitk`看看发生了什么：

```
$ gitk --all & 
```

* * *

## 回答 #2

> 赞同：900
> 
> 时间：2011-01-13T16:42:40.067

如果您有许多要一次获取的远程分支，请执行以下操作：

```
git pull --all 
```

现在您可以根据需要签出任何分支，而无需访问远程存储库。

* * *

**注意：**这不会创建任何未签出分支的工作副本，这就是问题所在。为此，请参阅

*   [大鱼的回答](https://stackoverflow.com/questions/67699/how-to-clone-all-remote-branches-in-git/4754797#4754797)
*   [戴夫的回答](https://stackoverflow.com/questions/67699/how-to-clone-all-remote-branches-in-git/7216269#7216269)

* * *

## 回答 #3

> 赞同：517
> 
> 时间：2011-01-21T02:18:36.200

这个[Bash](http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29)脚本帮助了我：

```
#!/bin/bash
for branch in $(git branch --all | grep '^\s*remotes' | egrep --invert-match '(:?HEAD|master)$'); do
    git branch --track "${branch##*/}" "$branch"
done 
```

它将为所有远程分支创建跟踪分支，除了 master（您可能从原始克隆命令中获得）。我想你可能还需要做一个

```
git fetch --all
git pull --all 
```

为了确定。

> **一个衬里**：`git branch -a | grep -v HEAD | perl -ne 'chomp($_); s|^\*?\s*||; if (m|(.+)/(.+)| && not $d{$2}) {print qq(git branch --track $2 $1/$2\n)} else {$d{$_}=1}' | csh -xfs`
> 像往常一样：在复制 rm -rf Universe 之前测试您的设置，因为我们知道它
> 
> *单线的积分归用户 cfi*

* * *

## 回答 #4

> 赞同：437
> 
> 时间：2011-08-27T17:49:44.263

使用该`--mirror`选项似乎可以`remote`正确复制跟踪分支。但是，它将存储库设置为裸存储库，因此您必须在之后将其转回普通存储库。

```
git clone --mirror path/to/original path/to/dest/.git
cd path/to/dest
git config --bool core.bare false
git checkout anybranch 
```

^(参考：[Git 常见问题解答：如何克隆包含所有远程跟踪分支的存储库？](https://git.wiki.kernel.org/index.php/Git_FAQ#How_do_I_clone_a_repository_with_all_remotely_tracked_branches.3F))

* * *

## 回答 #5

> 赞同：244
> 
> 时间：2012-05-12T12:11:54.240

您可以轻松切换到分支，而无需使用花哨的“git checkout -b somebranch origin/somebranch”语法。你可以做：

```
git checkout somebranch 
```

Git 会自动做正确的事：

```
$ git checkout somebranch
Branch somebranch set up to track remote branch somebranch from origin.
Switched to a new branch 'somebranch' 
```

Git 将检查同名的分支是否存在于一个远程分支中，如果存在，它会以与您明确指定它是远程分支相同的方式跟踪它。从 Git 1.8.2.1 的 git-checkout 手册页：

> 如果 <branch> 未找到，但在一个远程（称为 <remote>）中确实存在一个具有匹配名称的跟踪分支，则视为等效于
> 
> ```
> $ git checkout -b <branch> --track <remote>/<branch> 
> ```

* * *

## 回答 #6

> 赞同：101
> 
> 时间：2009-07-27T06:10:37.503

关于，

> git checkout -b 实验起源/实验

使用

```
git checkout -t origin/experimental 
```

或者更冗长，但更容易记住

```
git checkout --track origin/experimental 
```

在跟踪远程存储库方面可能会更好。

* * *

## 回答 #7

> 赞同：82
> 
> 时间：2008-09-15T22:52:51.197

您正在执行的 fetch 应该获取所有远程分支，但不会为它们创建本地分支。如果您使用[gitk](https://git-scm.com/docs/gitk)，您应该看到描述为“remotes/origin/dev”或类似内容的远程分支。

要基于远程分支创建本地分支，请执行以下操作：

```
git checkout -b dev refs/remotes/origin/dev 
```

应该返回如下内容：

```
Branch dev set up to track remote branch refs/remotes/origin/dev. Switched to a new branch "dev" 
```

现在，当您在*dev*分支上时，“git pull”会将您的本地*dev更新到与远程**dev*分支相同的点。请注意，它将获取所有分支，但只会将您所在的分支拉到树的顶部。

* * *

## 回答 #8

> 赞同：72
> 
> 时间：2013-05-15T11:02:27.247

使用别名。虽然没有任何原生 Git 单行代码，但您可以将自己定义为

```
git config --global alias.clone-branches '! git branch -a | sed -n "/\/HEAD /d; /\/master$/d; /remotes/p;" | xargs -L1 git checkout -t' 
```

然后将其用作

```
git clone-branches 
```

* * *

## 回答 #9

> 赞同：66
> 
> 时间：2012-11-26T23:42:29.080

这是执行此操作的最佳方法：

```
mkdir repo
cd repo
git clone --bare path/to/repo.git .git
git config --unset core.bare
git reset --hard 
```

此时，您拥有远程存储库及其所有分支的完整副本（使用 验证`git branch`）。如果您的远程存储库有自己的远程，您可以使用`--mirror`而不是。`--bare`

* * *

## 回答 #10

> 赞同：64
> 
> 时间：2008-09-15T22:47:00.603

当您执行“git clone git://location”时，将获取所有分支和标签。

为了在特定的远程分支上工作，假设它是源远程：

```
git checkout -b branch origin/branchname 
```

* * *

## 回答 #11

> 赞同：58
> 
> 时间：2014-03-05T13:47:03.530

## 为什么你只看到“大师”

`git clone`下载所有远程分支，但仍将它们视为“远程”，即使文件位于您的新存储库中。有一个例外，即克隆过程从名为“master”的远程分支创建一个名为“master”的本地分支。默认情况下，`git branch`只显示本地分支，这就是你只看到“master”的原因。

`git branch -a`显示所有分支，*包括远程分支*。

* * *

## 如何获得当地分支机构

如果你真的想在一个分支上工作，你可能需要它的“本地”版本。要简单地从远程分支创建本地分支*（不检查它们并因此更改工作目录的内容）*，您可以这样做：

```
git branch branchone origin/branchone
git branch branchtwo origin/branchtwo
git branch branchthree origin/branchthree 
```

在此示例中，`branchone`是您基于`origin/branchone`;创建的本地分支的名称。如果你想创建不同名称的本地分支，你可以这样做：

```
git branch localbranchname origin/branchone 
```

创建本地分支后，您可以看到它`git branch`（请记住，您不需要`-a`查看本地分支）。

* * *

## 回答 #12

> 赞同：50
> 
> 时间：2013-12-26T10:19:21.353

这并不太复杂。非常简单直接的步骤如下；

`git fetch origin`：这会将所有远程分支带到您的本地。

`git branch -a`：这将显示所有远程分支。

`git checkout --track origin/<branch you want to checkout>`

通过以下命令验证您是否在所需的分支中；

```
git branch 
```

输出将是这样的；

```
*your current branch
some branch2
some branch3 
```

注意表示当前分支的 * 符号。

* * *

## 回答 #13

> 赞同：39
> 
> 时间：2011-05-31T11:40:02.647

只需这样做：

```
$ git clone git://example.com/myproject

$ cd myproject

$ git checkout branchxyz
Branch branchxyz set up to track remote branch branchxyz from origin.
Switched to a new branch 'branchxyz'

$ git pull
Already up-to-date.

$ git branch
* branchxyz
  master

$ git branch -a
* branchxyz
  master
  remotes/origin/HEAD -> origin/master
  remotes/origin/branchxyz
  remotes/origin/branch123 
```

你看，'git clone git://example.com/myprojectt' 获取所有东西，甚至是分支，你只需要检查它们，然后你的本地分支就会被创建。

* * *

## 回答 #14

> 赞同：31
> 
> 时间：2014-11-19T15:43:04.407

您只需要使用“git clone”来获取所有分支。

```
git clone <your_http_url> 
```

即使您只看到主分支，您也可以使用“git branch -a”查看所有分支。

```
git branch -a 
```

你可以切换到你已经拥有的任何分支。

```
git checkout <your_branch_name> 
```

不用担心“git clone”之后就不需要连接远程仓库了。“git branch -a”和“git checkout <your_branch_name>”可以在没有网络连接的情况下成功运行。所以证明当你做“git clone”时，它已经从远程仓库复制了所有的分支。之后，您不需要远程存储库。您的本地已经拥有所有分支机构的代码。

* * *

## 回答 #15

> 赞同：27
> 
> 时间：2008-09-15T22:46:08.450

A`git clone`应该复制整个存储库。尝试克隆它，然后运行`git branch -a`​​. 它应该列出所有分支。如果您想切换到分支“foo”而不是“master”，请使用`git checkout foo`.

* * *

## 回答 #16

> 赞同：21
> 
> 时间：2015-12-06T20:08:41.227

我在这里看到的所有答案都是有效的，但是有一种更简洁的方法来克隆存储库并一次提取所有分支。

当你克隆一个存储库时，实际上是下载了所有分支的信息，但分支是隐藏的。用命令

```
git branch -a 
```

您可以显示存储库的所有分支，并使用命令

```
git checkout -b branchname origin/branchname 
```

然后，您可以一次手动“下载”它们。

* * *

但是，当您想要克隆具有大量分支的存储库时，相对于我将要展示的一种更清洁、更快捷的方式而言，前面的答案中说明的所有方式都是冗长而乏味的，尽管它有点复杂。您需要三个步骤来完成此操作：

### 1\. 第一步

*在您的机器上创建一个新的空文件夹并从存储库中克隆.git*文件夹的镜像副本：

```
cd ~/Desktop && mkdir my_repo_folder && cd my_repo_folder
git clone --mirror https://github.com/planetoftheweb/responsivebootstrap.git .git 
```

文件夹 my_repo_folder 中的本地存储库仍然是空的，现在只有一个隐藏的*.git*文件夹，您可以从终端使用“ls -alt”命令查看。

### 2\. 第二步

通过将 Git 配置的布尔值“bare”切换为 false，将此存储库从空（裸）存储库切换到常规存储库：

```
git config --bool core.bare false 
```

### 3\. 第三步

抓取当前文件夹中的所有内容并在本地计算机上创建所有分支，从而使其成为一个正常的存储库。

```
git reset --hard 
```

所以现在你可以输入命令“git branch”，你可以看到所有的分支都被下载了。

这是您可以一次克隆包含所有分支的 Git 存储库的快速方法，但您不想以这种方式对每个项目都执行此操作。

* * *

## 回答 #17

> 赞同：20
> 
> 时间：2019-09-25T15:03:25.773

### 自包含的存储库

如果您正在寻找*包含*所有远程分支和提交日志***的独立克隆或备份***，请使用：

 *```
git clone http://user@repo.url 
```

```
git pull --all 
```

接受的答案`git branch -a`仅***显示***远程分支。如果您尝试访问`checkout`分支，除非您仍然可以通过***网络访问***原始服务器，否则您将无法访问。

**信用：** [Gabe Kopley](https://stackoverflow.com/a/4682612/2305748)建议使用`git pull --all`.

**注意：**
当然，如果您不再具有对**`remote/origin`**服务器的网络访问权限，**`remote/origin branches`**则不会有任何更新反映在您的存储库克隆中。他们的修订将反映您执行上述两个存储库克隆命令的日期和时间的提交。

使用 `git checkout remote/origin/` 以通常的方式检查 *local* 分支 使用 `git branch -a` 显示保存在 `clone` 存储库中的远程分支。

*要使用一个命令将所有克隆*分支检出到*本地分支*，请使用以下 bash 命令之一：

```
$ for i in $(git branch -a |grep 'remotes' | awk -F/ '{print $3}' \ 
| grep -v 'HEAD ->');do git checkout -b $i --track origin/$i; done 
```

或者

如果你的仓库有嵌套分支，那么这个命令也会考虑到这一点：

```
for i in $(git branch -a |grep 'remotes' |grep -v 'HEAD ->');do \
basename ${i##\./} | xargs -I {} git checkout -b {} --track origin/{}; done 
```

如果您再次重新获得对原始存储库服务器的网络访问权并以通常的方式执行命令，上述命令将`checkout`本地分支到您的本地 git 存储库，命名与 相同并将其*`remote/origin/<branchname>`*设置为服务器`--track`上远程分支的更改.*`remote/origin`*`git pull`

* * *

## 回答 #18

> 赞同：19
> 
> 时间：2008-09-20T13:53:58.913

使用我的工具[git_remote_branch](http://programblings.com/2008/08/06/time-to-git-collaborating-with-git_remote_branch/) ( *grb* )。你需要在你的机器上安装[Ruby ）。](https://en.wikipedia.org/wiki/Ruby_%28programming_language%29)它是专门为使远程分支操作变得非常容易而构建的。

每次它代表您执行操作时，都会在控制台上以红色打印。随着时间的推移，它们最终会进入你的大脑:-)

如果您不希望 grb 代表您运行命令，只需使用“解释”功能。这些命令将打印到您的控制台而不是为您执行。

最后，所有命令都有别名，以便于记忆。

请注意，这是[alpha 软件](http://programblings.com/2008/08/06/time-to-git-collaborating-with-git_remote_branch/)；-)

这是运行 grb help 时的帮助：

```
git_remote_branch 版本 0.2.6

  用法：

  grb create branch_name [origin_server]

  grb 发布分支名称 [origin_server]

  grb 重命名 branch_name [origin_server]

  grb 删除分支名称 [origin_server]

  grb 跟踪分支名称 [origin_server]

  笔记：
  - 如果未指定 origin_server，则假定名称为“origin”
    （git的默认值）
  - 重命名功能重命名当前分支

  解释元命令：您还可以在任何命令前面加上
关键字“解释”。而不是执行命令， git_remote_branch
将简单地输出您需要运行以完成的命令列表
那个目标。

  例子：
    grb 解释创建
    grb 解释创建 my_branch github

  所有命令也有别名：
  创造：创造，新的
  删除：删除，销毁，杀死，删除，rm
  发布：发布，远程化
  重命名：重命名，rn，mv，移动
  跟踪：跟踪，跟随，抓取，获取

```

* * *

## 回答 #19

> 赞同：15
> 
> 时间：2017-02-23T23:55:10.470

从本地 repo 克隆不适用于 git clone 和 git fetch：许多分支/标签将保持未获取状态。

获取包含所有分支和标签的克隆。

```
git clone --mirror git://example.com/myproject myproject-local-bare-repo.git 
```

要获得包含所有分支和标签的克隆，但也包含工作副本：

```
git clone --mirror git://example.com/myproject myproject/.git
cd myproject
git config --unset core.bare
git config receive.denyCurrentBranch updateInstead
git checkout master 
```

* * *

## 回答 #20

> 赞同：13
> 
> 时间：2015-02-19T21:33:08.743

查看问题的答案之一，我注意到可以缩短它：

```
for branch in  `git branch -r | grep -v 'HEAD\|master'`; do
    git branch --track ${branch##*/} $branch;
done 
```

但请注意，如果远程分支之一被命名，例如*admin_master*，它将不会被下载！

* * *

## 回答 #21

> 赞同：13
> 
> 时间：2016-12-11T02:20:42.023

```
#!/bin/bash
for branch in `git branch -a | grep remotes | grep -v HEAD | grep -v master `; do
   git branch --track ${branch#remotes/origin/} $branch
done 
```

这些代码会将所有远程分支代码拉到本地存储库。

* * *

## 回答 #22

> 赞同：13
> 
> 时间：2017-07-22T18:29:55.713

**好的，**当你克隆你的仓库时，你有所有的分支......

如果你只是这样做`git branch`，它们有点隐藏......

因此，如果您想查看所有分支名称，只需添加`--all`如下标志：

`git branch --all`或者`git branch -a`

如果您只是结帐到分行，您将获得所需的一切。

但是如果你克隆后别人创建的分支呢？

在这种情况下，只需执行以下操作：

`git fetch`

并再次检查所有分支......

如果您想同时提取和结帐，您可以执行以下操作：

`git fetch && git checkout your_branch_name`

还为您创建了下面的图像以简化我所说的：

[![git branch --all 获取所有分支](https://i.stack.imgur.com/gn2pi.png)](https://i.stack.imgur.com/gn2pi.png)

* * *

## 回答 #23

> 赞同：10
> 
> 时间：2013-12-20T06:38:02.740

对于复制粘贴到命令行：

```
git checkout master ; remote=origin ; for brname in `git branch -r | grep $remote | grep -v master | grep -v HEAD | awk '{gsub(/^[^\/]+\//,"",$1); print $1}'`; do git branch -D $brname ; git checkout -b $brname $remote/$brname ; done ; git checkout master 
```

为了提高可读性：

```
git checkout master ;
remote=origin ;
for brname in `
    git branch -r | grep $remote | grep -v master | grep -v HEAD
    | awk '{gsub(/^[^\/]+\//,"",$1); print $1}'
`; do
    git branch -D $brname ;
    git checkout -b $brname $remote/$brname ;
done ;
git checkout master 
```

* * *

这会：

1.  签出master（这样我们就可以删除我们所在的分支）
2.  **选择远程**结帐（将其更改为您拥有的任何远程）
3.  **循环遍历**除 master 和 HEAD 之外的所有远程分支 0.**删除**本地分支（以便我们可以签出强制更新的分支） 0.从远程**签出分支**
4.  检查大师（为了它）

*它基于[VonC](https://stackoverflow.com/users/6309/vonc)的[答案](https://stackoverflow.com/a/6300386/1998046)。*

* * *

## 回答 #24

> 赞同：10
> 
> 时间：2015-01-23T17:51:19.670

这些答案都没有削减它，除了[用户没有人在正确的轨道上](https://stackoverflow.com/questions/67699/how-to-clone-all-remote-branches-in-git/16563327#16563327)。

我在将存储库从一台服务器/系统移动到另一台服务器/系统时遇到了麻烦。当我克隆存储库时，它只为master创建了一个本地分支，所以当我推送到新的远程时，只推送了master分支。

所以我发现这两种方法*非常*有用。

**方法一：**

```
git clone --mirror OLD_REPO_URL
cd new-cloned-project
mkdir .git
mv * .git
git config --local --bool core.bare false
git reset --hard HEAD
git remote add newrepo NEW_REPO_URL
git push --all newrepo
git push --tags newrepo 
```

**方法二：**

```
git config --global alias.clone-branches '! git branch -a | sed -n "/\/HEAD /d; /\/master$/d; /remotes/p;" | xargs -L1 git checkout -t'
git clone OLD_REPO_URL
cd new-cloned-project
git clone-branches
git remote add newrepo NEW_REPO_URL
git push --all newrepo
git push --tags newrepo 
```

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2016-06-19T10:54:23.777

我编写了这些小的**PowerShell**函数，以便能够检出我所有的 Git 分支，这些分支位于远程源端。

```
Function git-GetAllRemoteBranches {
     iex "git branch -r"                       <# get all remote branches #> `
     | % { $_ -Match "origin\/(?'name'\S+)" }  <# select only names of the branches #> `
     | % { Out-Null; $matches['name'] }        <# write does names #>
}

Function git-CheckoutAllBranches {
    git-GetAllRemoteBranches `
        | % { iex "git checkout $_" }          <# execute ' git checkout <branch>' #>
} 
```

更多 Git 功能可以在[我的 Git 设置存储库](https://github.com/aburok/mysettings/blob/master/PowerShell/config/git-alias.ps1)中找到。

* * *

## 回答 #26

> 赞同：10
> 
> 时间：2018-05-25T17:34:43.130

`git clone --mirror`在原始仓库中对此非常有效。

```
git clone --mirror /path/to/original.git
git remote set-url origin /path/to/new-repo.git
git push -u origin 
```

* * *

## 回答 #27

> 赞同：10
> 
> 时间：2019-06-20T14:05:41.617

这是一个使用 awk 的答案。如果在新的 repo 上使用此方法就足够了。

```
git branch -r | awk -F/ '{ system("git checkout " $NF) }' 
```

现有的分支将被简单地检出，或声明为已经存在，但可以添加过滤器以避免冲突。

也可以对其进行修改，以便调用显式`git checkout -b <branch> -t <remote>/<branch>`命令。

这个答案遵循[Nikos C.](https://stackoverflow.com/users/856199/nikos-c)的[想法](https://stackoverflow.com/a/10563611/445221)。

* * *

或者，我们可以指定远程分支。这是基于[murphytalk](https://stackoverflow.com/users/144330/murphytalk)的[回答](https://stackoverflow.com/a/1186645/445221)。

```
git branch -r | awk '{ system("git checkout -t " $NF) }' 
```

它会在冲突中引发致命的错误消息，但我认为它们是无害的。

* * *

这两个命令都可以有别名。

使用[nobody](https://stackoverflow.com/users/2383918/nobody)的[答案](https://stackoverflow.com/a/16563327/445221)作为参考，我们可以使用以下命令来创建别名：

```
git config --global alias.clone-branches '! git branch -r | awk -F/ "{ system(\"git checkout \" \$NF) }"'
git config --global alias.clone-branches '! git branch -r | awk "{ system(\"git checkout -t \" \$NF) }"' 
```

我个人会使用`track-all`or `track-all-branches`。

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2010-12-10T23:12:39.360

我需要做同样的事情。这是我的[Ruby](http://en.wikipedia.org/wiki/Ruby_%28programming_language%29)脚本。

```
#!/usr/bin/env ruby

local = []
remote = {}

# Prepare
%x[git reset --hard HEAD]
%x[git checkout master] # Makes sure that * is on master.
%x[git branch -a].each_line do |line|
  line.strip!
  if /origin\//.match(line)
     remote[line.gsub(/origin\//, '')] = line
   else
     local << line
   end
end
# Update 
remote.each_pair do |loc, rem|
  next if local.include?(loc)
  %x[git checkout --track -b #{loc} #{rem}]
end
%x[git fetch] 
```

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2015-09-10T12:04:08.903

这是另一个为所有远程分支创建本地分支的简短单行命令：

```
(git branch -r | sed -n '/->/!s#^  origin/##p' && echo master) | xargs -L1 git checkout 
```

如果已经创建了跟踪本地分支，它也可以正常工作。您可以在第一次`git clone`或以后的任何时间调用它。

如果克隆后不需要`master`签出分支，请使用

```
git branch -r | sed -n '/->/!s#^  origin/##p'| xargs -L1 git checkout 
```

* * *

## 回答 #30

> 赞同：7
> 
> 时间：2016-03-11T20:01:06.573

# 使用你能记住的命令

我正在使用 Bitbucket，这是 Atlassian 的存储库托管服务。所以我尝试遵循他们的文档。这对我来说非常有效。使用以下简单而简短的命令，您可以签出您的远程分支。

首先克隆您的存储库，然后更改为目标文件夹。最后但并非最不重要的一点是获取和结帐：

```
git clone <repo> <destination_folder>
cd <destination_folder>
git fetch && git checkout <branch> 
```

就是这样。这里有一个更真实的例子：

```
git clone https://username@bitbucket.org/team/repository.git project_folder
cd project_folder
git fetch && git checkout develop 
```

您将在文档中找到有关命令的详细信息： [Clone Command](https://www.atlassian.com/git/tutorials/setting-up-a-repository/git-clone)、[Fetch Command](https://www.atlassian.com/git/tutorials/syncing/git-fetch)、[Checkout Command](https://www.atlassian.com/git/tutorials/undoing-changes/git-checkout/)

* * *

## 回答 #31

> 赞同：7
> 
> 时间：2016-03-31T00:48:48.600

Git 通常（如果未指定）从一个或多个其他存储库中获取所有分支和/或标签（参考，请参阅：）`git ls-refs`以及完成其历史所需的对象。换句话说，它获取已经下载的对象可以访问的对象。请参阅：[真正做什么](https://stackoverflow.com/a/36243207/55075)[？`git fetch`](https://stackoverflow.com/a/36243207/55075)

有时您可能有没有直接连接到当前分支/标签的分支/标签，因此`git pull --all`/`git fetch --all`在这种情况下无济于事，但您可以通过以下方式列出它们：

```
git ls-remote -h -t origin 
```

并通过知道参考名称手动获取它们。

因此，要**全部获取它们**，请尝试：

```
git fetch origin --depth=10000 $(git ls-remote -h -t origin) 
```

^(`--depth=10000`如果您已浅化存储库，该参数可能会有所帮助。)

然后再次检查所有分支：

```
git branch -avv 
```

* * *

如果上述方法没有帮助，您需要手动将丢失的分支添加到跟踪列表中（因为它们以某种方式丢失了）：

```
$ git remote -v show origin

...
  Remote branches:
    master      tracked 
```

`git remote set-branches`喜欢：

```
git remote set-branches --add origin missing_branch 
```

所以它可能会出现在`remotes/origin`fetch 之后：

```
$ git remote -v show origin

...
  Remote branches:
    missing_branch new (next fetch will store in remotes/origin)
$ git fetch
From github.com:Foo/Bar
 * [new branch]      missing_branch -> origin/missing_branch 
```

* * *

### 故障排除

如果您仍然无法获得除 master 分支以外的任何内容，请检查以下内容：

*   仔细检查您的遥控器 ( `git remote -v`)，例如
    *   验证`git config branch.master.remote`是`origin`.
    *   检查是否`origin`通过以下方式指向正确的 URL：（`git remote show origin`参见[这篇文章](https://stackoverflow.com/q/5243231/55075)）。

* * *

## 回答 #32

> 赞同：7
> 
> 时间：2017-04-21T20:14:17.437

截至 2017 年初，[此评论中](https://stackoverflow.com/questions/67699/how-to-clone-all-remote-branches-in-git#comment2170694_72156)的答案有效：

`git fetch <origin-name> <branch-name>`为你带来树枝。虽然这不会一次拉出所有分支，但您可以单独执行每个分支。

* * *

## 回答 #33

> 赞同：7
> 
> 时间：2021-09-04T12:23:30.463

我正在从 Udemy 课程[Elegant Automation Frameworks with Python and Pytest](https://www.udemy.com/course/elegant-automation-frameworks-with-python-and-pytest/)中克隆一个存储库，以便以后可以**离线**查看。我尝试下载 zip，但这仅适用于当前分支，所以这是我的 2 美分。

我在 Windows 上工作，显然，我使用了[Windows Subsystem for Linux](https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux)中的 Ubuntu shell 。克隆后，这是我的分支：

```
$ git clone https://github.com/BrandonBlair/elegantframeworks.git

$ git branch -a

* master
  remotes/origin/HEAD -> origin/master
  remotes/origin/config_recipe
  remotes/origin/functionaltests
  remotes/origin/master
  remotes/origin/parallel
  remotes/origin/parametrize
  remotes/origin/parametrize_data_excel
  remotes/origin/unittesting
  remotes/origin/unittesting1 
```

然后——在撞了几`git checkout`堵砖墙之后——最终对我有用的是：

```
$ for b in `git branch -a | cut -c18- | cut -d\  -f1`; do git checkout $b; git stash; done 
```

在此之后，这是我的分支：

```
$ git branch -a

  config_recipe
  functionaltests
  master
  parallel
  parametrize
  parametrize_data_excel
  unittesting
* unittesting1
  remotes/origin/HEAD -> origin/master
  remotes/origin/config_recipe
  remotes/origin/functionaltests
  remotes/origin/master
  remotes/origin/parallel
  remotes/origin/parametrize
  remotes/origin/parametrize_data_excel
  remotes/origin/unittesting
  remotes/origin/unittesting1 
```

我的是物理的，删除初始 `remotes/origin/`，然后过滤空间分隔符。可以说，我本可以`grep`完成`HEAD`并完成一个`cut`，但我将把它留给评论。

请注意，您当前的分支现在是列表中的最后一个。如果你不知道为什么会这样，那么你就处于困境中。随心所欲`git checkout`。

* * *

## 回答 #34

> 赞同：4
> 
> 时间：2018-12-08T15:34:05.143

此变体将克隆一个远程存储库，其中包含本地可用的所有分支，而无需逐个签出每个分支。不需要花哨的脚本。

创建一个与您希望克隆的 repo 同名的文件夹，然后 cd 进入，例如：

```
mkdir somerepo
cd somerepo 
```

现在执行这些命令，但使用实际的 repo 用户名/reponame

```
git clone --bare git@github.com:someuser/somerepo.git .git
git config --bool core.bare false
git reset --hard
git branch 
```

瞧！你那里有所有的分支机构！

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2012-09-12T14:01:44.170

我认为这可以解决问题：

```
mkdir YourRepo
cd YourRepo
git init --bare .git                       # create a bare repo
git remote add origin REMOTE_URL           # add a remote
git fetch origin refs/heads/*:refs/heads/* # fetch heads
git fetch origin refs/tags/*:refs/tags/*   # fetch tags
git init                                   # reinit work tree
git checkout master                        # checkout a branch 
```

到目前为止，这对我有用。

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2013-07-14T01:30:10.477

我试图找出如何拉下我在本地删除的远程分支。Origin 不是我的，我不想经历重新克隆所有东西的麻烦。

这对我有用：

假设您需要在本地重新创建分支：

```
git checkout -b recreated-branch-name
git branch -a (to list remote branches)
git rebase remotes/remote-origin/recreated-branch-name 
```

因此，如果我从*gituser/master*分叉到*sjp*，然后将其分支到*sjp/mynewbranch*，它将如下所示：

```
$ git checkout -b mynewbranch

$ git branch -a
  master
  remotes/sjp/master
  remotes/sjp/mynewbranch

$ git fetch (habit to always do before)

$ git rebase remotes/sjp/mynewbranch 
```

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2020-07-28T13:05:32.250

该解决方案对我有用，可以将存储库“复制”到另一个存储库：

```
git merge path/to/source.git --mirror
cd source.git
git remote remove origin
git remote add origin path/to/target.git
git push origin --all
git push origin --tags 
```

在目标存储库上，我可以看到与原始存储库相同的分支和标签。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2020-07-23T19:36:03.410

### 在这里，我给你写了一个很好的函数来让它容易重复

```
gitCloneAllBranches() { # clone all git branches at once easily and cd in
  # clone as "bare repo"
  git clone --mirror $1
  # rename without .git extension
  with_extension=$(basename $1)
  without_extension=$(echo $with_extension | sed 's/.git//')
  mv $with_extension $without_extension
  cd $without_extension
  # change from "bare repository" to not
  git config --bool core.bare false
  # check if still bare repository if so
  if [[ $(git rev-parse --is-bare-repository) == false ]]; then
    echo "ready to go"
  else
    echo "WARNING: STILL BARE GIT REPOSITORY"
  fi
  # EXAMPLES:
  # gitCloneAllBranches https://github.com/something/something.git
} 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2020-09-19T16:17:45.580

每当我需要关闭所有分支时，我都会这样做。来自 Linkedin Learning的**Ray Villalobos**学分。尝试克隆所有分支，包括提交：

```
mkdir -p -- newproject_folder
cd newproject_folder
git clone --mirror https://github.com/USER_NAME/RepositoryName.git .git
git config --bool core.bare false
git reset --hard 
```

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2021-07-29T20:19:28.153

要创建存储在 git 主机 (github/bitbucket/etc) 中的所有分支+refs+tags+etc 的“完整”备份，请运行：

```
mkdir -p -- myapp-mirror
cd myapp-mirror
git clone --mirror https://git.myco.com/group/myapp.git .git
git config --bool core.bare false
git config --bool core.logAllRefUpdates true
git reset --hard # restore working directory 
```

这是根据我从其他答案中学到的所有内容编译而成的。

然后，您可以使用此本地 repo 镜像转换到不同的 SCM 系统/git 主机，或者您可以将其保留为备份。它作为搜索工具也很有用，因为大多数 git 主机只搜索每个 repo 的“主”分支上的代码，如果你`git log -S"specialVar"`，你会看到所有分支上的所有代码。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2020-01-22T15:55:09.033

[对于使用Visual Studio Code](https://en.wikipedia.org/wiki/Visual_Studio_Code)的开发人员来说，一个更好的替代解决方案是使用[Git Shadow Extension](https://marketplace.visualstudio.com/items?itemName=ioedeveloper.git-shadow)。

此 Visual Studio Code 扩展允许克隆存储库内容和目录，可以按分支名称或提交哈希进行过滤。这样，分支或提交可以用作新项目的样板/模板。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2020-07-19T07:35:27.337

这是改编自先前答案的跨平台**PowerShell 7函数。**

```
function Invoke-GitCloneAll($url) {
    $repo = $url.Split('/')[-1].Replace('.git', '')
    $repo_d = Join-Path $pwd $repo
    if (Test-Path $repo_d) {
        Write-Error "fatal: destination path '$repo_d' already exists and is not an empty directory." -ErrorAction Continue
    } else {
        Write-Host "`nCloning all branches of $repo..."
        git -c fetch.prune=false clone $url -q --progress &&
        git -c fetch.prune=false --git-dir="$(Join-Path $repo_d '.git')" --work-tree="$repo_d" pull --all
        Write-Host "" #newline
    }
} 
```

**注意：** `-c fetch.prune=false`使其包含通常会被排除的陈旧分支。如果您对它不感兴趣，请删除它。

* * *

*您可以通过从函数中删除来使其与 PowerShell 5.1（Windows 10 中的默认值）一起使用，但这会使它即使在前一个命令失败时也会`&&`尝试。`git pull`所以，我强烈建议只使用跨平台的 PowerShell，它总是让你烦恼。*

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2021-07-13T08:58:46.813

对远程存储库进行裸克隆，将内容保存到 .git 目录

```
git clone --bare remote-repo-url.git localdirname/.git 
```

（使用 git clone --bare 或 git init --bare 创建的裸 git 存储库是一个存储库，它没有工作目录，您不能在那里创建或修改文件。）

将目录更改为本地目录

```
cd localdirname 
```

使您的 git 存储库可修改

```
git config --bool core.bare false 
```

恢复你的工作目录

```
git reset --hard 
```

列出所有分支

```
git branch -al 
```

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2019-10-03T11:21:57.697

# 所有分店

从 Git 项目下载所有分支的脚本

## 安装：

```
sudo git clone https://github.com/marceloviana/allBranches.git && sudo cp -rfv allBranches/allBranches.sh /usr/bin/allBranches && sudo chmod +x /usr/bin/allBranches && sudo rm -rf allBranches 
```

准备好！现在只需调用命令 (allBranches) 并告诉 Git 项目目录您要下载所有分支

**采用**

示例 1：

```
~$ allBranches /var/www/myproject1/ 
```

示例 2：

```
~$ allBranches /var/www/myproject2/ 
```

示例 3（如果已经在项目目录中）：

```
~$ allBranches ./ 
```

或者

```
~$ allBranches . 
```

查看结果：

```
git branch 
```

### 参考：

存储库 allBranches GitHub： [https ://github.com/marceloviana/allBranches](https://github.com/marceloviana/allBranches)

* * *

## 回答 #45

> 赞同：-2
> 
> 时间：2018-08-18T14:08:26.490

如果你使用 Bitbucket，你可以使用**import Repository**。这将导入所有 Git 历史记录（所有分支和提交）。

# linq-to-sql - LinqToSql 和全文搜索 - 可以吗？

> ID：67706
> 
> 赞同：5
> 
> 时间：2008-09-15T22:43:53.510
> 
> 标签：linq-to-sql, full-text-search

有没有人想出一种`FREETEXT() CONTAINS()`使用标准 LinqToSql 查询语法对任意数量的任意关键字执行全文搜索 () 的好方法？

我显然希望避免使用存储过程或生成动态 SQL 调用。

显然，我可以将搜索字符串输入到使用 FREETEXT() 或 CONTAINS() 的 SPROC 的参数中，但我希望在搜索和构建查询方面更具创造性，例如：

“意大利辣香肠披萨”和汉堡，而不是“苹果派”。

我知道这很疯狂 - 但是能够直接从 LinqToSql 执行此操作不是很好吗？任何有关如何实现这一目标的提示将不胜感激。

更新：我想我可能会在[这里](http://tomasp.net/blog/linq-expand-update.aspx)做一些事情......

另外：我回滚了对我的问题标题所做的更改，因为它实际上改变了我所问的含义。我*知道*LinqToSql 不支持全文搜索——如果我想知道的话，我会问这个问题。取而代之的是——我更新了我的标题，以安抚那些喜欢编辑、触发手指的群众。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T02:05:21.650

我已经设法通过使用表值函数来封装全文搜索组件来解决这个问题，然后在我的 LINQ 表达式中引用它来保持延迟执行的好处：

```
string q = query.Query;
IQueryable<Story> stories = ActiveStories
                        .Join(tvf_SearchStories(q), o => o.StoryId, i => i.StoryId, (o,i) => o)
                        .Where (s => (query.CategoryIds.Contains(s.CategoryId)) &&
                                    /* time frame filter */
                                (s.PostedOn >= (query.Start ?? SqlDateTime.MinValue.Value)) &&
                                (s.PostedOn <= (query.End ?? SqlDateTime.MaxValue.Value))); 
```

这里的 'tvf_SearchStories' 是内部使用全文搜索的表值函数

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-15T22:51:15.960

不幸的是 LINQ to SQL 不支持全文搜索。

我认为有很多产品可以：Lucene.NET、NHibernate Search。NHibernate 的 LINQ 与 NHibernate 搜索相结合可能会提供该功能，但两者仍处于测试阶段。

# javascript - 如何使用书签在任何网站的页面中显示表单（如 Google Reader 中的 Note）？

> ID：67713
> 
> 赞同：2
> 
> 时间：2008-09-15T22:46:21.413
> 
> 标签：javascript, client-side, bookmarklet, browser

在 Google 阅读器中，您可以使用小书签“记下”您正在访问的页面。当您按下小书签时，当前页面顶部会显示一个小的 Google 表单。在表单中您可以输入描述等。当您按下提交时，表单在不离开页面的情况下自行提交，然后表单消失。总而言之，非常流畅的体验。

我显然试图看看它是如何完成的，但最有趣的部分被缩小且不可读。所以...

关于如何实现这样的东西（在浏览器端）的任何想法？有哪些问题？现有的博客文章描述了这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T00:06:00.380

奥帕霍说得对。但是，我将向您介绍我为我们的网站 ( [www.iminta.com](http://www.iminta.com) ) 设计的书签框架。

小书签本身的内容如下：

```
javascript:void((function(){
    var e=document.createElement('script');
    e.setAttribute('type','text/javascript');
    e.setAttribute('src','http://www.iminta.com/javascripts/new_bookmarklet.js?noCache='+new%20Date().getTime());
    document.body.appendChild(e)
})()) 
```

这只是将一个新脚本注入到包含此文件的文档中：

[http://www.iminta.com/javascripts/new_bookmarklet.js](http://www.iminta.com/javascripts/new_bookmarklet.js)

重要的是要注意，小书签会创建一个 iframe，定位它，并向文档添加事件，以允许用户执行诸如点击转义（关闭窗口）或滚动（使其保持可见）之类的操作。它还隐藏了不能很好地使用 z 定位的元素（例如，闪光灯）。最后，它有助于与 iframe 中运行的 javascript 进行通信。这样，您可以在 iframe 中有一个关闭按钮，告诉父文档删除 iframe。这种跨域的东西有点hacky，但这是唯一的方法（我见过）这样做。

不是为了装腔作势；如果您不擅长 JavaScript，请准备好奋斗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T23:20:59.523

在它非常基本的级别上，它将`createElement`用于创建要插入到页面中的元素，`appendChild`或者`insertBefore`将它们插入到页面中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T23:26:15.797

您可以使用一个简单的书签添加一个 <script> 标记，该标记加载一个外部 JavaScript 文件，该文件可以将必要的元素推送到 DOM 并向用户呈现一个模式窗口。该表单通过 AJAX 请求提交，在服务器端进行处理，并返回成功或用户需要更正的错误列表。

所以小书签看起来像：

*javascript:code-to-add-script-tag-and-init-the-script;*

外部脚本将包括：

*   向 DOM 添加元素的能力
*   能够将该元素的 innerHTML 更新为您要为用户显示的标记
*   AJAX 表单处理的处理

窗口效果可以通过CSS定位来实现。

至于这个特定任务的完整资源，你很幸运能找到任何东西。但是看看更小的、单独的部分，你会发现大量的资源。查看有关模式窗口、向 DOM 添加元素和 AJAX 处理的信息。

# algorithm - 有没有一种算法可以提取英文文本的有意义的标签

> ID：67725
> 
> 赞同：8
> 
> 时间：2008-09-15T22:48:30.723
> 
> 标签：algorithm, tags, semantics

我想从任何大小的英文文本中提取减少的“有意义”标签集合（最多 10 个）。

[http://tagcrowd.com/](http://tagcrowd.com/)很有趣，但算法似乎很基本（只是字数统计）

有没有其他现有的算法可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T23:06:12.397

有用于此的现有 Web 服务。~~二~~三个例子：

*   [雅虎的词条提取 API](http://developer.yahoo.com/search/content/V1/termExtraction.html)
*   外用剂
*   [OpenCalais](http://www.opencalais.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T22:54:46.840

当您减去人为因素（标记）时，剩下的就是频率。“忽略常见的英语单词”是次佳过滤器，因为它处理的是排除而不是包含。我测试了几个网站，它非常准确。确实没有其他方法可以得出“意义”，这就是语义网如今受到如此多关注的原因。这是一种用 HTML 来暗示意义的方式……当然，它也有人类的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T23:03:17.257

在文本分类中，这个问题被称为降维。关于这个主题的文献中有许多有用的算法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T23:03:32.527

基本上，这是一个文本分类问题/文档分类问题。如果您可以访问许多已标记的文档，则可以分析哪些（内容）词触发了哪些标记，然后使用此信息来标记新文档。

如果您不想使用机器学习方法并且仍然有文档集合，那么您可以使用[tf.idf](http://en.wikipedia.org/wiki/Tf-idf)之类的指标来过滤掉有趣的单词。

更进一步，如果同义词的频率较高，您可以使用[Wordnet查找同义词并用同义词替换单词。](http://wordnet.princeton.edu/)

[Manning & Schütze](http://nlp.stanford.edu/fsnlp/)包含更多关于文本分类的介绍。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T12:52:23.613

您想要对文本进行[语义分析](http://en.wikipedia.org/wiki/Semantic_analysis)。

词频分析是进行语义分析的最简单方法之一。不幸的是（显然）这是最不准确的。可以通过使用特殊词典（例如同义词或单词形式）、带有常用词的“停止列表”、其他文本（查找那些“常用”词并排除它们）来改进它...

至于**其他算法**，它们可以基于：

*   句法分析（比如试图在一个句子中找到主要的主语和/或动词）
*   格式分析（分析标题、粗体文本、斜体......如果适用）
*   参考分析（例如，如果文本是在互联网上，那么一个参考可以用几个词来描述它......被一些搜索引擎使用）

但是......你应该明白，这些算法仅仅是语义分析的启发式算法，而不是实现目标的严格算法。自第一台计算机出现以来，语义分析问题是人工智能/机器学习研究的主要问题之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T23:02:59.830

也许“词频 - 逆文档频率” [TF-IDF](http://en.wikipedia.org/wiki/Tf-idf)会很有用......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-03T20:58:30.920

您可以分两步使用它：

1 - 尝试主题建模算法：

*   潜在狄利克雷分配
*   潜在词嵌入

2 - 之后您可以选择每个主题中最具代表性的单词作为标签

# php - 适用于 Vista 的最佳 PHP 编辑器

> ID：67729
> 
> 赞同：19
> 
> 时间：2008-09-15T22:49:56.087
> 
> 标签：php, windows, windows-vista, editor

回答我的问题时要考虑的几点：

1.  我是 PHP 新手，来自 Windows / .NET 背景
2.  我的 PHP 开发环境由 Vista x64 / IIS7 和 FastCGI / PHP5 组成
3.  我需要一些轻量级的东西
4.  以下功能会很好
    *   语法高亮和着色
    *   代码格式化
    *   自动完成

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-15T22:52:41.040

当我在 Windows 上工作时，我总是喜欢[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)。它非常轻量级，但也没有很多您在 .NET 领域可能习惯使用的 IDE 级功能。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-15T22:52:49.853

带[PDT的](http://www.eclipse.org/pdt/)[Eclipse](http://www.eclipse.org/)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-16T15:06:05.600

PHP ED 是迄今为止我发现的最好的。我已经尝试了几乎所有的东西。这是最好的 php 编辑器。我喜欢 linux...但由于 PHP ED，我一直在 windows 上。

[http://www.nusphere.com/products/phped.htm](http://www.nusphere.com/products/phped.htm) [http://www.nusphere.com/products/tour.htm](http://www.nusphere.com/products/tour.htm)

它很快！而且它的功能非常齐全。

它有：

**自动代码完成，内置数据库客户端，内置 ssh（命令行提示符），sftp，ftp 等支持。（安装驱动器）、远程和本地调试器、代码浏览器、框架识别、多种语言的广泛语言颜色编码选项、html 表单构建器、代码格式化。名单还在继续。**

放下 PHPED 是顶级的 php 编辑器。

这个编辑器也有很好的论坛支持。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-15T22:58:17.080

对于您的环境，我强烈建议您使用 Aptana Studio。 [更多信息在这里。](http://www.aptana.com/studio/)

[评论就在这里。](http://blog.adambard.com/2008/02/04/aptana-development-environment/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-12-02T13:08:06.040

对我来说，它必须是[Netbeans](http://netbeans.org/)。它具有您可能需要的所有 IDE 功能，并且具有在 Mac/PC 和 Linux 上运行的额外好处，因此您可以在任何平台上使用它。它的强大功能包括对单元测试、调试和 mysql 的内置支持（[***更多信息在这里***](http://netbeans.org/features/php/)）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-16T01:02:08.203

[！](http://www.vim.org/download.php#pc) _

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-15T22:59:32.100

[我以EditPad Pro](http://www.editpadpro.com "编辑板临")发誓。它具有语法着色和代码格式的轻量级，但它不包括自动完成（我个人无论如何都不使用）。它也有一个惊人的搜索功能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-16T00:25:32.533

*   [jEdit](http://www.jedit.org)是一个很棒的编辑器，但您需要安装一些插件才能达到最佳效果。

    *   它有很好的语法突出显示（尤其是使用 Editor Scheme 插件）
    *   它通过 FTP 插件具有*出色*的远程文件编辑支持
    *   它有我用过的最容易使用的 Diff 工具
    *   它是基于 java 的，资源有点重，但它是跨平台的。
    *   （我安装的插件有：BufferList、CtagsSidekick（连同[ctags](http://ctags.sourceforge.net/)）、Editor Scheme、FTP（远程编辑 FTW！）、JDiff、JTidy、PHPParser、Sessions、SideKick、TaskList、XML 和 XML Indenter。）
*   我最近开始使用[Komodo Edit](http://activestate.com/Products/komodo_ide/komodo_edit.mhtml)（[Komodo IDE](http://activestate.com/Products/komodo_ide/index.mhtml)的免费版本），我真的很喜欢它。

    *   它是完全跨平台的（因为它基于 XUL）。
    *   它有很好的语法高亮和错误纠正。
    *   它具有非常好的代码完成和浏览功能。
    *   能够指定一个 URL 来预览您当前的文件也很好，该 URL 不一定是文件本身的路径 - 因此您可以编辑一个类文件并使用测试工具很容易地预览它。
    *   如果我刚开始，这将是我的建议。
*   很多人喜欢带有[PDT的](http://www.eclipse.org/pdt/)[Eclipse](http://www.eclipse.org/)，但我从未真正使用过它。可能值得一试，但显然它相对资源匮乏。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-16T00:54:25.070

我同意 Sam：带有 PDT 的 Eclipse 是您想要的最佳选择：

*   语法高亮和着色
*   代码格式化
*   自动完成

这是有关如何安装和使用这些功能的分步教程。我已经将它安装在我的 Vista 笔记本电脑上，并且运行良好：

[使用 XAMPP Lite 安装带有 Eclipse PDT、Apache 2.2、PHP 5、MySQL 5 和 phpMyAdmin 的 PHP 开发环境](http://www.tanguay.info/web/tutorial.php?idCode=phpDevelopmentQuick)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-16T04:17:14.583

我一直使用 Zend Studio，没有它我就活不下去。断点和追踪很神奇。如果您有复杂的代码，只需逐行执行，检查值和逻辑是否符合预期。人们如何使用记事本之类的仅编辑程序开发大型应用程序？

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-16T15:07:45.893

我是 Zend Studio 的忠实粉丝……它是为 PHP 设计的，没有 IDE 功能我就活不下去。替代方案是 ActiveState 的[Komodo IDE](http://www.activestate.com/Products/komodo_ide/index.mhtml)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-21T05:08:59.823

[Zeus](http://www.zeusedit.com)支持**PHP**语言（即语法高亮、代码折叠、智能缩进、自动完成等）。

它还具有许多类似 IDE 的功能，包括项目/工作区管理、集成源代码控制、类浏览等。

[![替代文字](https://i.stack.imgur.com/JC21k.jpg)](https://i.stack.imgur.com/JC21k.jpg)
[（来源：[zeusedit.com](http://www.zeusedit.com/images/_lookmain.jpg)）]

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-12-25T23:41:50.400

IDE: NetBeans for PHP [PHP, HTML, CSS - Auto-completion, Insert Getters/Setters] 你在 Eclipse 中没有这个（我试过 Eclipse 和 Zend Studio - NB 更好一英里）

编辑器：记事本++

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-15T22:54:13.300

Dreamweaver 可以完成您列出的所有操作，但不是很轻量级。我喜欢它，因为它能够为我编写大量简单的 HTML 和 CSS。它还内置了关于 javascript、html、php 等的文档。我肯定会建议检查一下。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-15T22:58:13.523

[EditPlus](http://www.editplus.com/download.html)非常轻量级，并且满足您的所有标准，除了自动完成。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-15T23:03:11.140

我喜欢 VS.PHP，因为我喜欢在 Visual Studio 中工作。

它的价格为 99 美元，但对于我的目的来说似乎工作得很好。

[http://www.jcxsoftware.com/vs.php](http://www.jcxsoftware.com/vs.php)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-15T23:04:16.270

我第二次使用 Notepad++，它轻巧、快速且运行良好。当您在选项中启用单词完成时，它在编码时提供了很好的支持（也有多种语言的功能完成文件）。还要看看插件。

或者，使用成熟的 IDE。这些值得一看：

*   Zend Studio for Eclipse
*   带 PDT 的 Eclipse
*   网豆6.5

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-09-16T00:43:19.853

[在我开始主要使用 C# 进行开发之前，我使用Notepad++](http://notepad-plus.sourceforge.net/)进行了相当多的 PHP 开发。它的优点是：

*   轻的。
*   自由。
*   突出显示同一文档中选定文本的其他实例。
*   各种各样的可用插件。
*   定期发布。
*   在文件中查找。
*   功能完成。
*   显然与 PHP 开发无关。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-16T00:55:16.597

[UEStudio](http://www.ultraedit.com)对我来说是不可或缺的——它是我的主要杀手级应用程序，阻止我全职切换到 Ubuntu。在我以前的工作中使用过 eclipse，我发现它有点消耗资源，而且界面很糟糕（我经常会同时打开 20-30 多个文件，并且选项卡界面不能很好地工作，对我来说至少）。

严格来说，UES 不是*PHP* IDE（您不会获得集成调试），但它符合您的所有要求。

唯一的缺点是它不是免费的。他们的网站有 45 天的免费试用期（无需注册或其他任何东西），这绝对足以让您知道它是否适合您。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-16T01:06:55.447

我很喜欢使用 PhpED，主要是因为我刚开始学习 PHP，并且让调试器单步调试我的代码并教我我做错了什么真的很有帮助。但它并不是特别轻量级，我想在得到我的印章之后，我会更多地转向文本编辑器解决方案。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-21T12:28:07.677

Visual Studio 结合 VS.Php 是终极工具；）

它甚至支持使用 IIS 进行调试，并且通过了 MS 认证。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-22T15:48:12.617

Vim Vim Vim Vim Vim VIM！
虽然我刚刚开始尝试使用 PDT 的 Eclipse，但它看起来相当不错。除此之外，不幸的是，我从来没有找到一个 100% 满足我需求的编辑器 :( 我一定很挑剔。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-12-02T12:00:05.930

Windows 上的 gVim！

但我并没有超出基本的编辑/搜索使用范围。想深入了解 Vim...

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-15T23:06:15.033

[Delphi for PHP](http://www.codegear.com/products/delphi/php)是一个很好的 PHP 编辑器。然而，它不在轻量级免费类别中。它具有您的所有功能以及可视化的所见即所得页面设计器。

查看[功能列表](http://www.codegear.com/products/delphi/php/features/)，它非常令人印象深刻。很多屏幕截图。如果您来自丰富的 .NET 开发背景，那么您将非常熟悉。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-15T23:55:43.090

PHP Designer 非常可靠。我发现它比 Eclipse 更轻量，内置了对 TortoiseSVN、PHPDocumenter 和其他一些实用程序的支持。它不是免费的，但价格合理——我认为是 60 美元。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-16T04:33:10.443

轻量级不是：Dreamweaver、Aptana、Netbeans、Eclipse

这真的取决于你在做什么，如果你不使用 OOP 那么你不需要一个完整的 IDE ......与调试等一样......

轻量级、调试、语法着色等......我会尝试[PHP Editor 2008](http://www.mpsoftware.dk/)

我以前用过它并喜欢它……但总是回到程序员记事本或我的新朋友[e-TextEditor](http://www.e-texteditor.com/)，它是 Mac 上 Textmate 的副本。

由于您还是 PHP 新手，因此您无法分辨其中一半之间的区别....：/

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-16T04:35:23.150

E 文本编辑器

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-09-16T14:36:54.280

我使用 UltraEdit、EditPlus、Notepad++ 和 Notepad2。都是轻量级的。我认为 UltraEdit 确实可以完成代码......我不太确定，因为我不使用它。

[UltraEdit](http://www.ultraedit.com/products/ultraedit.html)是我的主要编辑器。

[EditPlus](http://www.editplus.com/)曾经是我的主要编辑器（当 UltraEdit 的正则表达式支持无法正常工作时，我保留它以进行正则表达式搜索/替换）。

[Notepad2](http://www.flos-freeware.ch/notepad2.html)我与大多数代码文件类型（php、js、css 等）相关联，以便在 Windows 资源管理器中浏览文件时进行快速编辑。

[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)我用于快速编辑，类似于我使用 Notepad2 的方式，但如果我需要从同一个项目中打开多个文件，我会切换到 Notepad++。是的，如果我要这样做的话，我可能应该在 UltraEdit 中打开它们，但出于某种原因我没有这样做。

就像我的工作方式一样。我猜我很奇怪？

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-09-16T15:17:06.573

我目前在 windows 项目上处理几个 PHP 并且我主要使用[Notepad++](http://notepad-plus.sourceforge.net/)，而 windows 的编辑器领域充满了竞争（其中许多非常好）我发现 notepad++ 快速加载时间和快速的任何单词自动完成显着加快我的开发时间。我要提到的唯一缺点是调试工作，这取决于您计划如何调试，您可能希望研究设置 PDT，但是对于文件工作，很难击败 npp。

**功能概要**

*   自动完成您键入的任何单词
*   自动文本扩展/片段以预设关键字（可自定义，例如：键入“if”它写“if {;} then {;}”），并在代码段内使用自定义光标导航。
*   与其他一些编辑器相比，代码在更多级别上崩溃
*   功能工具提示辅助（您可以添加自定义 API）
*   浏览项目文件的类似资源管理器的功能
    *   如果您使用 tortoiseSvn 或类似的 GUI 工具，您可以从这里使用它们。
*   优秀的宏/外部工具支持
*   代码格式化、对齐、验证（一些通过外部工具）功能
*   可便携使用（来自 USB 记忆棒、外置硬盘等）

（其中许多功能来自插件，默认安装）

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-09-16T15:22:32.317

*   WeBuilder/快速 PHP： http: [//www.blumentals.net/](http://www.blumentals.net/)
*   phpCoder：[http ://www.tsware.net/phpcoder.php](http://www.tsware.net/phpcoder.php)
*   科莫多：[http ://www.activestate.com](http://www.activestate.com)

WeBuilder/Rapid PHP 似乎很好地满足了您的要求，甚至支持一些基本的调试。

我尝试过，但没有广泛使用，phpCoder - 它非常好。我没有购买的唯一原因是因为我已经拥有了 WeBuilder。

最后，我使用了 Komodo IDE，它非常出色，但我不确定它是否可以称为轻量级。他们还提供免费的开源版本 - Komodo Edit - 它不包括调试，但我相信符合您列出的要求。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-09-16T17:06:12.800

我最近尝试[了 phpDesigner 2008](http://www.mpsoftware.dk/phpdesigner.php)，这似乎是一个不错的 IDE。但是，我使用它的时间还不够长，无法做出公正的判决。

**编辑：**罢工，我已经放弃了。搜索不起作用，自动完成和错误检测令人讨厌，并且它有一些窗口焦点错误让我发疯。我正在切换到[NuSphere PhpED](http://www.nusphere.com/products/phped.htm)。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-09-22T15:39:50.420

我使用 TextPad 来编辑所有内容。它不是专门针对 PHP 的，但可以针对任何语言进行定制。语法模板适用于您听说过的每种语言，还有 200 种您在他们的网站[http://textpad.com上没有的语言](http://textpad.com/ "文本板主页")

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-09-22T15:43:16.467

考虑到您没有说编辑器必须是免费的，我推荐 Komodo IDE。这是一个付费产品，但哇，太棒了。它们的调试支持与 Visual Studio 相当；它比*Zend* Studio 快得多。代码完成引擎非常强大。

我还发现他们的开发人员反应特别灵敏——我提交了许多小功能请求，你瞧，他们出现在 vNext 中。他们甚至可以让您在他们的网站上实时查看您的请求状态。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-09-22T15:44:54.387

我使用[Geany](http://www.geany.org)。它加载非常快（即时）并且对 PHP 有很好的支持，并且可以在同一个文件中混合 PHP、HTML、JavaScript 和 CSS。If 具有所有 PHP 函数的自动完成功能，并且还检测类和函数以便于导航。在 PHP 开发中很重要的一件事是，它可以告诉您第一次使用变量的位置（如果您有大文件或大函数）。

它还检测有效和无效的 CSS 并自动完成 HTML。例如，如果您键入 TABLE 标记，它会生成模板 TR 和 TD 内容。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-09-22T16:06:45.643

我支持 Mike B 的建议，主要针对来自 tsware.net 的 TSW [phpCoder](http://www.tsware.net/phpcoder.php)。几个月前我购买了该应用程序，以及“TSW SiteSync”（网站同步软件，与 phpCoder 配合使用），我已经对这个编辑器上瘾了。我会为调试和 PHP Tidy 功能单独购买它，但还有更多。试一试，价格还算公道。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-12-15T10:04:55.897

我使用 Intype，在搜索了几天并尝试了几十个之后，我发现它是最简单的，也是迄今为止我最喜欢的，它就像 Textmate，但对于 Windows，我在 Vista 上使用它[http://intype.info/home/index.php](http://intype.info/home/index.php)

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-03-10T09:34:39.340

我建议新的免费 PHP IDE - [Codelobster PHP 版](http://www.codelobster.com)

它还有 Drupal、Joomla、WordPress 和 Smarty 插件。

问候，斯塔斯。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2009-03-10T09:49:34.077

我的建议：

**WeBuilder**，**PHP设计师**。

两者都支持 UTF，这很重要。调试非常业余，AFAIK 他们不支持远程调试。

但是，如果您需要真正的 PRO IDE，请选择***Komodo IDE***。它还支持 Perl、Python 和 RoR。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2009-03-10T14:49:14.980

[我是E-TextEditor](http://e-texteditor.com/)的忠实粉丝。它没有自动完成功能，但捆绑包、片段和多选功能因其简单和轻量级而令人惊叹。

它适用于 TextMate 的任何捆绑包，并且很容易编写自己的包。

查看主页上的截屏视频。它看起来比我说的更令人印象深刻。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-03-10T15:02:15.637

[一个真正](http://www.gnu.org/software/emacs/)的编辑器非常好地执行 PHP。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-09-06T23:04:25.917

您应该检查基于 Eclipse 的开发环境的 Aptana Studio。还支持 javascript、ajax、ruby on rails、python 开发，如果您比较其他 php 编辑器，它具有流畅的用户界面。我使用了大部分（komodo、eclipse pdt、php 设计器...）但是aptana studio是最适合我的。你可以看[这里](http://aptana.com/)

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-12-02T13:09:40.403

我使用[Zend Studio](http://www.zend.com/products/studio/)，对此我很满意。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2009-12-25T23:17:33.677

我一直在使用 Programmer's Notepad 2。对此我没什么好说的，我从未真正尝试过其他任何基于 Web 的编程。它适合我的简单需求，所以我只是将它添加到列表中。

# c# - 在 C# 程序集中执行 JavaScript

> ID：67734
> 
> 赞同：20
> 
> 时间：2008-09-15T22:50:40.390
> 
> 标签：c#, .net, javascript, unit-testing, codedom

我想从 C# 程序集中执行 JavaScript 代码，并将 JavaScript 代码的结果返回给调用 C# 代码。

定义我不想做的事情更容易：

*   我不想从我的代码后面调用网页上的 JavaScript 函数。

*   我不想加载 WebBrowser 控件。

*   我不想让 JavaScript 对服务器执行 AJAX 调用。

我想做的是用 JavaScript 编写单元测试，然后单元测试输出 JSON，即使是纯文本也可以。然后我想要一个通用的 C# 类/可执行文件，它可以加载包含 JS 的文件，运行 JS 单元测试，废弃/加载结果，并在构建后任务期间返回带有详细信息的通过/失败。

我认为使用旧的 ActiveX ScriptControl 是可能的，但似乎应该有一种 .NET 方式来做到这一点，而无需使用 SilverLight、DLR 或任何其他尚未发布的东西。有人有想法么？

更新：[来自布拉德艾布拉姆斯的博客](http://blogs.msdn.com/brada/articles/239857.aspx)

```
namespace Microsoft.JScript.Vsa
{
    [Obsolete("There is no replacement for this feature. " +
              "Please see the ICodeCompiler documentation for additional help. " +
              "http://go.microsoft.com/fwlink/?linkid=14202")] 
```

澄清：我们对使用 JSUnit 框架用 JavaScript 编写的 JavaScript 函数进行了单元测试。现在，在我们的构建过程中，我们必须手动加载一个网页并单击一个按钮，以确保所有 JavaScript 单元测试都通过。我希望能够在我们的自动化 C# 单元测试运行时在构建后过程中执行测试，并在 C# 单元测试旁边报告成功/失败，并将它们用作是否构建的指标被打破。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-15T22:59:54.033

代码应该是非常自我解释的，所以我将发布它。

```
<add assembly="Microsoft.Vsa, Version=8.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/></assemblies> 
```

* * *

```
using Microsoft.JScript;

public class MyClass {

    public static Microsoft.JScript.Vsa.VsaEngine Engine = Microsoft.JScript.Vsa.VsaEngine.CreateEngine();

    public static object EvaluateScript(string script)
    {
        object Result = null;
        try
        {
            Result = Microsoft.JScript.Eval.JScriptEvaluate(JScript, Engine);
        }
        catch (Exception ex)
        {
            return ex.Message;
        }

        return Result;
    }

    public void MyMethod() {
        string myscript = ...;
        object myresult = EvaluateScript(myscript);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T22:53:52.147

您可以使用 Microsoft Javascript 引擎[从 C# 评估 JavaScript 代码](http://www.west-wind.com/WebLog/posts/10688.aspx)

更新：这在 VS 2008 中已过时

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T03:44:17.673

您可以使用 JSUnit 服务器从 Nant 内部运行 JSUnit，它是用 java 编写的，没有 Nant 任务，但您可以从命令提示符运行它，结果记录为 XML，您可以将它们与您的构建报告集成过程。这不是 Nunit 结果的一部分，而是额外的报告。如果其中任何一个测试失败，我们就会使构建失败。我们正在使用 CC.Net 来做这件事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T22:56:28.083

使用[JSUnit](https://github.com/pivotal/jsunit)编写测试，然后使用[WatiN](http://watin.sourceforge.net/) 测试包装器通过 C# 运行它们，根据 JSUnit 结果通过或失败，会不会更简单？

虽然这确实是一个额外的步骤。

我相信我在某处读到过，即将发布的 MBUnit 或 WatiN 版本将内置处理 JSUnit 测试装置的功能。如果我能记得我在哪里读到的……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T22:56:57.990

我现在不知道有任何特定于 .NET 的方式来执行此操作……嗯，仍然有 JScript.NET，但这可能与您需要执行的任何 JS 都不兼容 :)

显然，未来将是 DLR 的 .NET JScript 实现……总有一天（希望如此）。

所以这可能会留下运行旧的 ActiveX JScript 引擎，这当然可以从 .NET 中执行（我过去曾这样做过，尽管它有点丑陋！）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T23:22:41.513

如果您不在浏览器的上下文中执行代码，为什么需要用 Javascript 编写测试？很难理解你在这里想要完成的事情的大局。

# .net - 传递复杂类型的 WCF 问题

> ID：67736
> 
> 赞同：1
> 
> 时间：2008-09-15T22:51:04.913
> 
> 标签：.net, wcf, wsdl

我有一个服务合同，它定义了一个带有 System.Object 类型参数的方法（WSDL 中的 xs:anyType）。我希望能够在此参数中传递简单类型和复杂类型。简单类型可以正常工作，但是当我尝试传递在我的 WSDL 中定义的复杂类型时，我收到此错误：

元素“ [http://tempuri.org/:value](http://tempuri.org/:value) ”包含“ [http://schemas.datacontract.org/2004/07/MyNamespace:MyClass](http://schemas.datacontract.org/2004/07/MyNamespace:MyClass) ”数据合同的数据。反序列化器不知道映射到该合约的任何类型。将与“MyClass”对应的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将其添加到传递给 DataContractSerializer 的已知类型列表中。

将它添加为已知类型并没有帮助，因为它已经在我的 WSDL 中。如何通过“xs:anyType”参数传递复杂类型的对象？

更多信息：

我相信这在使用 NetDataContract 时有效，但我不能使用它，因为我的客户是 Silverlight。

我已经看到对显式扩展 xs:anyType 的复杂类型的引用，但我不知道如何让 WCF 生成一个可以做到这一点的 WSDL，我也不知道它是否会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T07:30:34.150

NetDataContract 有效，因为 NetDataContractSerializer 包含类型信息。

KnownType 属性指示 DataContractSerializer 如何反序列化消息。作为实现特定的，这是超出公共合同定义的信息，不属于 WSDL。

您将永远无法传递任何旧数据类型，因为反序列化器需要识别适当的类型并创建一个实例。

您可能能够在运行时派生已知类型，而不是将它们硬编码在 DataContract 中。[在这里](http://electroholic.com/?p=5)查看示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T08:59:39.577

我希望这会有所帮助。我看到我的一位同事使用此代码发送复杂的数据类型，对我来说这很简单。这与 basicHttpBinding 一起使用，并且与 MOSS BDC 以及使用基本绑定的其他应用程序配合得很好。

1.  基于泛型类创建数据契约
2.  在需要发送信息时使用数据合约

    [DataContract(Namespace = " [http://Service.DataContracts](http://Service.DataContracts) ", Name = "ServiceDataContractBase")] 公共类 ServiceDataContract {

    ```
    public ServiceDataContract() { }

    public ServiceDataContract(TValueType Value)
    {
        this.m_objValue = Value;
    }

    private TValueType m_objValue;

    [DataMember(IsRequired = true, Name = "Value", Order = 1)]
    public TValueType Value
    {
        get { return m_objValue; }
        set { m_objValue = value; }
    } 
    ```

    }

在返回复杂数据类型的 WCF 函数中任何需要的地方使用此数据协定。例如：

```
public ServiceDataContract<string[]> GetStrings()
{
    string[] temp = new string[10];
    return new ServiceDataContract<string[]>(temp);
} 
```

更新：ServiceDataContract 是通用类使用 TValueType。由于 HTML 的呈现有问题，它没有出现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T23:58:03.793

I have solved this problem by using the ServiceKnownType attribute. I simply add my complex type as a service known type on my service contract, and the error goes away. I'm not sure why this didn't work last time I tried it.

It doesn't appear to affect the WSDL in any way, so I suspect that the serialized stream must have some difference that informs the deserializer that the object can be deserialized using my type.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T07:47:02.893

尝试使用数据协定代理来映射不受支持的对象，即点网特定或不可互操作的类型。见[MSDN](http://msdn.microsoft.com/en-us/library/ms733064.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T15:33:34.350

~~我尝试添加 ServiceKnownType 属性，指定我尝试传递的类型，但我仍然得到相同的错误。~~我还尝试将 KnownType 属性添加到我的数据合同中（这似乎很愚蠢，因为它与数据合同的类型相同）。如果在编译时添加它们没有帮助，我猜想在运行时添加它们也无济于事。

如果我要扩展另一种复杂类型，在我看来，我想将 KnownType 属性添加到该基本类型。但由于我的基本类型是 Object，我看不到任何方法可以做到这一点。

至于代理，在我看来，它们用于包装没有定义合同的类型。但是，就我而言，我确实定义了合同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T17:11:28.083

For now I have worked around this by creating a new data contract type that can wrap either another data contract type or a simple type. Instead of passing type Object, now I pass this wrapper class. This works OK, but I'd still like to know if there is a solution to the original issue.

# perl - Solaris 上的 Perl Sys::Syslog

> ID：67760
> 
> 赞同：0
> 
> 时间：2008-09-15T22:54:56.683
> 
> 标签：perl, solaris, syslog

有没有人让[Sys::Syslog](http://perldoc.perl.org/Sys/Syslog.html)在 Solaris 上工作？（我在 SPARC 上的 SunOS 5.10 上的 Perl v5.8.4 上运行 Sys::Syslog 0.05）。这对我不起作用：

```
openlog "myprog", "pid", "user" or die;
syslog "crit", "%s", "Test from $0" or die;
closelog() or warn "Can't close: $!";
system "tail /var/adm/messages"; 
```

无论我做什么，closelog 都会返回一个错误，并且不会在任何地方记录任何内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T00:07:27.383

默认情况下，Sys::Syslog 将尝试使用以下套接字类型之一进行连接：

```
[ 'tcp', 'udp', 'unix', 'stream' ] 
```

但是，在 Solaris 上，您需要使用 inet 套接字。称呼：

```
setlogsock('inet', $hostname); 
```

事情应该开始工作了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T09:36:07.693

一般来说，您可以通过查看 CPAN 测试者矩阵来回答“模块 $x 是否在平台 $y 上工作”的问题，[就像这里一样](http://bbbike.radzeit.de/~slaven/cpantestersmatrix.cgi?dist=Sys-Syslog+0.26)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T09:28:43.687

setlogsock('inet') 并没有为我做这件事（它寻找主机“syslog”），但从 CPAN 构建和安装 Sys::Syslog 做到了。Solaris 10 附带的 Sys::Syslog 很古老。

# c# - NetworkStream.Write 立即返回 - 我如何知道它何时完成发送数据？

> ID：67761
> 
> 赞同：10
> 
> 时间：2008-09-15T22:54:58.540
> 
> 标签：c#, network-programming

尽管有文档，但 NetworkStream.Write 似乎并没有等到数据发送完毕。相反，它会等到数据被复制到缓冲区然后返回。该缓冲区在后台传输。

这是我目前拥有的代码。无论我使用 ns.Write 还是 ns.BeginWrite 都没有关系 - 两者都会立即返回。EndWrite 也立即返回（这是有道理的，因为它正在写入发送缓冲区，而不是写入网络）。

```
 bool done;
    void SendData(TcpClient tcp, byte[] data)
    {
        NetworkStream ns = tcp.GetStream();
        done = false;
        ns.BeginWrite(bytWriteBuffer, 0, data.Length, myWriteCallBack, ns);
        while (done == false) Thread.Sleep(10);
    }

    public void myWriteCallBack(IAsyncResult ar)
    {
        NetworkStream ns = (NetworkStream)ar.AsyncState;
        ns.EndWrite(ar);
        done = true;
    } 
```

如何判断数据何时实际发送到客户端？

我想在发送我的数据后等待 10 秒（例如）等待来自服务器的响应，否则我会假设有问题。如果发送我的数据需要 15 秒，那么它将始终超时，因为我只能从 NetworkStream.Write 返回时开始计数 - 这是在发送数据之前。我想从数据离开我的网卡开始计算 10 秒。

数据量和发送时间可能会有所不同 - 发送可能需要 1 秒，发送可能需要 10 秒，发送可能需要一分钟。服务器在收到数据后确实会发送响应（它是一个 smtp 服务器），但是如果我的数据格式错误并且响应永远不会到来，我不想永远等待，这就是为什么我需要知道我是否' m 等待发送数据，或者等待服务器响应。

我可能想向用户显示状态 - 我想显示“正在向服务器发送数据”和“等待来自服务器的响应” - 我该怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-17T03:32:07.133

我不是 C# 程序员，但你问这个问题的方式有点误导。对于“接收”的任何有用定义，了解何时“接收”您的数据的唯一方法是在您的协议中有一个特定的确认消息，表明数据已被完全处理。

确切地说，数据不会“离开”您的网卡。考虑您的程序与网络的关系的最佳方式是：

> 你的程序 -> 很多令人困惑的东西 -> 对等程序

可能在“很多令人困惑的东西”中的东西列表：

*   CLR
*   操作系统内核
*   虚拟化网络接口
*   一个开关
*   软件防火墙
*   硬件防火墙
*   执行网络地址转换的路由器
*   对等端的路由器执行网络地址转换

因此，如果您在托管在不同操作系统下的虚拟机上，该虚拟机具有控制虚拟机网络行为的软件防火墙 - 数据何时“真正”离开您的网卡？即使在最好的情况下，这些组件中的许多也可能会丢弃一个数据包，您的网卡将需要重新传输该数据包。第一次（不成功）尝试时，它是否“离开”了您的网卡？大多数网络 API 会说不，直到另一端发送 TCP 确认才“发送”。

也就是说，[NetworkStream.Write 的文档](http://msdn.microsoft.com/en-us/library/system.net.sockets.networkstream.write.aspx)似乎表明它至少在启动“发送”操作之前不会返回：

> 在发送请求的字节数或抛出 SocketException 之前，Write 方法会一直阻塞。

当然，由于我上面给出的原因，“被发送”有点模糊。也有可能数据将由您的程序“真正”发送并由对等程序接收，但对等方将崩溃或以其他方式不实际处理数据。因此，您应该执行 a`Write`后跟`Read`一条消息，该消息仅在您的对等方实际处理了该消息时才会发出。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T23:30:29.280

TCP 是一个“可靠”的协议，这意味着如果没有套接字错误，数据将在另一端接收。我已经看到无数次尝试使用更高级别的应用程序确认来猜测 TCP，但恕我直言，这通常是在浪费时间和带宽。

通常，您描述的问题是通过正常的客户端/服务器设计来处理的，其最简单的形式是这样的......

客户端向服务器发送请求，并在套接字上进行阻塞读取以等待某种响应。如果 TCP 连接出现问题，则读取将中止。客户端还应该使用超时来检测服务器的任何非网络相关问题。如果请求失败或超时，则客户端可以重试、报告错误等。

一旦服务器处理了请求并发送了响应，它通常不再关心发生了什么——即使套接字在事务期间消失了——因为它取决于客户端来启动任何进一步的交互。就个人而言，我觉得成为服务员很舒服。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T23:07:18.260

如果我不得不猜测，一旦将缓冲区交给 Windows Socket，NetworkStream 就会认为数据已经发送。所以，我不确定有没有办法通过 TcpClient 完成你想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T23:04:26.147

一般来说，我建议无论如何发送客户的确认。这样您就可以 100% 确定数据已被接收并正确接收。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T00:15:27.003

我想不出 NetworkStream.Write 不会尽快将数据发送到服务器的情况。除非出现大规模的网络拥塞或断开连接，否则它应该会在合理的时间内到达另一端。您是否有可能遇到协议问题？例如，对于 HTTP，请求标头必须以空行结束，并且服务器不会发送任何响应，直到发生响应 - 使用的协议是否具有类似的消息结束特性？

这里有一些比原始版本更简洁的代码，删除了委托、字段和 Thread.Sleep。它在功能上执行完全相同的方式。

```
void SendData(TcpClient tcp, byte[] data) {
    NetworkStream ns = tcp.GetStream();
    // BUG?: should bytWriteBuffer == data?
    IAsyncResult r = ns.BeginWrite(bytWriteBuffer, 0, data.Length, null, null);
    r.AsyncWaitHandle.WaitOne();
    ns.EndWrite(r);
} 
```

看起来问题在我写上面的时候被修改了。.WaitOne() 可能会帮助您解决超时问题。它可以传递一个超时参数。这是一个懒惰的等待——在结果完成或超时到期之前，不会再次调度线程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T05:55:17.657

我试图理解 .NET NetworkStream 设计者的意图，他们必须以这种方式进行设计。写入后，要发送的数据不再由 .NET 处理。因此，Write 立即返回是合理的（并且数据很快就会从 NIC 发送出去）。

所以在你的应用程序设计中，你应该遵循这个模式，而不是试图让它按照你的方式工作。例如，在从 NetworkStream 接收任何数据之前使用较长的超时时间可以补偿您的命令离开 NIC 之前所消耗的时间。

总之，在源文件中硬编码超时值是不好的做法。如果超时值可以在运行时配置，那么一切都应该正常工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T22:57:12.217

如何使用 Flush() 方法。

```
ns.Flush() 
```

这应该确保在继续之前写入数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T22:25:00.723

Bellow .net 是使用 TCP 的 Windows 套接字。TCP 使用 ACK 数据包通知发送方数据已成功传输。因此，发送者机器知道何时传输了数据，但没有办法（我知道）在 .net 中获取该信息。

编辑：只是一个想法，从未尝试过：Write() 仅在套接字缓冲区已满时阻塞。因此，如果我们将缓冲区大小（SendBufferSize）降低到一个非常低的值（8？1？0？）我们可能会得到我们想要的:)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-15T23:11:38.717

也许尝试设置 `tcp.NoDelay = true`

# templates - 我在哪里可以找到示例燃尽/计划游戏模板？

> ID：67780
> 
> 赞同：2
> 
> 时间：2008-09-15T22:58:52.273
> 
> 标签：templates, project-management, project-planning

我想和我所在的团队一起尝试燃尽和计划游戏。我团队中的人对实现它很感兴趣，但是我确信之前有人做过，并且已经吸取了一些我们希望不必重复的教训。有谁知道可用于燃尽或规划游戏活动的示例 Excel（或其他工具）模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T23:10:03.370

[这篇 MSDN 博客文章](http://blogs.msdn.com/progressive_development/archive/2008/02/19/motley-says-what-are-we-burning-down-your-house-scrum-part-v.aspx)对结合使用燃尽图和累积流程图进行了很好的评论，它更加充实了图表。在文章底部的资源链接中，有一个[指向 Microsoft Scrum 工具包](http://go.microsoft.com/fwlink/?LinkId=98602&clcid=0x409)的链接，该工具包具有预构建的 excel 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-24T13:27:54.307

是的，我在其他地方回答了这个问题，但我们使用工具只是为了生成燃尽图。喜欢这个：[http ://www.burndown-charts.com](http://www.burndown-charts.com)

剩下的，一个真正的董事会，一些便利贴和善意会创造奇迹。

对于该工具，他们还[管理团队](http://www.burndown-charts.com/teams/dreamteam)并允许以只读方式查看图表，以便您可以将其展示给您的经理：D。

# sql-server - SQL Server 2005 是否可以扩展到大量数据库？

> ID：67788
> 
> 赞同：1
> 
> 时间：2008-09-15T23:00:47.417
> 
> 标签：sql-server, sql-server-2005

如果我将 3-400 个数据库添加到单个 SQL Server 实例，我会遇到大量数据库引入的扩展问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T23:04:37.457

这是最好回答的问题之一：您为什么首先尝试这样做？这些数据库的并发性是什么？当您可以使用规范化表来执行相同的功能时，您是否正在生成数据库？

也就是说，是的，MSSQL 2005 将在每次安装时处理该级别的数据库。这将或多或少是您对数据库所做的事情，这将严重阻碍您的性能（传入连接、CPU 使用率等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T23:05:54.877

根据 SO podcast #11 中的 Joel Spolsky 的说法，您将在 2005 年之前的任何版本中使用，但据说这在 SQL Server 2005 中已修复。

[您可以在此处](https://stackoverflow.fogbugz.com/default.asp?W12621)查看播客的成绩单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T23:10:05.960

我在 2005 年从未尝试过这个。但是我曾经工作过的一家公司在 7.0 上尝试过这个，结果惨遭失败。有了 2000 个，事情变得更好了，但跨数据库查询仍然非常缓慢，并且占用了太多系统资源。我只能想象 2005 年情况会再次好转。

您是跨数据库查询还是将它们托管在同一台服务器上？如果您要跨数据库查询，我认为您需要重新审视您的数据架构并找到其他方法来分离数据。如果这只是一个托管问题，您可以随时尝试并在达到容量时将数据库移至其他服务器。

对不起，我在这里没有明确的答案。

# c - 有没有办法将结构类型传递给 ac 函数

> ID：67790
> 
> 赞同：3
> 
> 时间：2008-09-15T23:01:10.973
> 
> 标签：c

我有一些具有多个功能非常相似的代码，可以根据结构中一个字段的内容在列表中查找一个项目。函数之间的唯一区别是发生查找的结构的类型。如果我可以传入类型，我可以删除所有代码重复。

我还注意到这些函数中也发生了一些互斥锁，所以我想我可能会不理会它们......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-15T23:09:28.630

如果您确保该字段被放置在每个此类结构中的相同位置，您可以简单地转换一个指针以获取该字段。这种技术用于许多低级系统库，例如 BSD 套接字。

```
struct person {
  int index;
};

struct clown {
  int index;
  char *hat;
};

/* we're not going to define a firetruck here */
struct firetruck;

struct fireman {
  int index;
  struct firetruck *truck;
};

int getindexof(struct person *who)
{
  return who->index;
}

int main(int argc, char *argv[])
{
  struct fireman sam;
  /* somehow sam gets initialised */
  sam.index = 5;

  int index = getindexof((struct person *) &sam);
  printf("Sam's index is %d\n", index);

  return 0;
} 
```

这样做会失去类型安全性，但这是一种有价值的技术。

[我现在已经实际测试了上面的代码并修复了各种小错误。有了编译器就容易多了。]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T23:07:18.057

由于结构只不过是预定义的内存块，因此您可以这样做。您可以将 void * 传递给结构，并传递一个整数或其他东西来定义类型。

从那里开始，*最安全*的做法是在访问数据之前将 void * 重铸为适当类型的指针。

您需要非常非常小心，因为当您转换为 void * 时会失去类型安全性，并且在执行此类操作时可能会遇到难以调试的运行时错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:07:02.130

如果您测试的 ID 字段是所有结构共享的公共初始字段序列的一部分，那么使用联合可以保证访问将起作用：

```
#include <stdio.h>

typedef struct
{
    int id;
    int junk1;
} Foo;

typedef struct
{
    int id;
    long junk2;
} Bar;

typedef union
{
    struct
    {
        int id;
    } common;

    Foo foo;
    Bar bar;
} U;

int matches(const U *candidate, int wanted)
{
    return candidate->common.id == wanted;
}

int main(void)
{
    Foo f = { 23, 0 };
    Bar b = { 42, 0 };

    U fu;
    U bu;

    fu.foo = f;
    bu.bar = b;

    puts(matches(&fu, 23) ? "true" : "false");
    puts(matches(&bu, 42) ? "true" : "false");

    return 0;
} 
```

如果您不走运，并且该字段出现在各种结构中的不同偏移量处，您可以将偏移量参数添加到您的函数中。然后，offsetof 和一个包装宏模拟 OP 的要求——在调用站点传递结构的类型：

```
#include <stddef.h>
#include <stdio.h>

typedef struct
{
    int id;
    int junk1;
} Foo;

typedef struct
{
    int junk2;
    int id;
} Bar;

int matches(const void* candidate, size_t idOffset, int wanted)
{
    return *(int*)((const unsigned char*)candidate + idOffset) == wanted;
}

#define MATCHES(type, candidate, wanted) matches(candidate, offsetof(type, id), wanted)

int main(void)
{
    Foo f = { 23, 0 };
    Bar b = { 0, 42 };
    puts(MATCHES(Foo, &f, 23) ? "true" : "false");
    puts(MATCHES(Bar, &b, 42) ? "true" : "false");

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T08:25:47.987

我认为您应该查看 C 标准函数 qsort() 和 bsearch() 以获得灵感。这些是对数组进行排序和在预排序数组中搜索数据的通用代码。它们适用于任何类型的数据结构 - 但您将指针传递给进行比较的辅助函数。辅助函数知道结构的细节，因此可以正确进行比较。

事实上，由于您想要进行搜索，因此您可能只需要 bsearch()，但如果您正在动态构建数据结构，您可能会决定需要与排序列表不同的结构。（您可以使用排序列表——与堆相比，它只会减慢速度。但是，您需要一个通用的 heap_search() 函数和一个 heap_insert() 函数才能正确完成这项工作，并且此类函数在 C 中未标准化。在网上搜索显示此类函数存在 - 不是那个名称；只是不要尝试“c heap search”，因为它假定您的意思是“廉价搜索”并且您会得到大量垃圾！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T23:21:50.160

您可以使用参数化宏来执行此操作，但大多数编码策略会对此不满意。

```
 #include 
#define getfield(s, name) ((s).name)

typedef struct{
  int x;
}Bob;

typedef struct{
  int y;
}Fred;

int main(int argc, char**argv){
    Bob b;
    b.x=6;

    Fred f;
    f.y=7;

    printf("%d, %d\n", getfield(b, x), getfield(f, y));
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T23:42:36.910

简短的回答：没有。但是，您可以为此创建自己的方法，即提供有关如何创建此类结构的规范。但是，这通常不是必需的，也不值得付出努力；只是通过引用。( `callFuncWithInputThenOutput(input, &struct.output);`)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T23:05:52.460

一种方法是将类型字段作为结构的第一个字节。您的接收函数查看此字节，然后根据它发现的内容将指针转换为正确的类型。另一种方法是将类型信息作为单独的参数传递给需要它的每个函数。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-15T23:09:07.210

我对 c 有点生疏，但尝试使用 void* 指针作为函数参数中的变量类型。然后将结构的地址传递给函数，然后按照您的方式使用它。

```
void foo(void* obj);

void main()
{
  struct bla obj;
  ...
  foo(&obj);
  ...
}

void foo(void* obj)
{
  printf(obj -> x, "%s")
} 
```

# regex - 多行 C# 正则表达式在空行后匹配

> ID：67798
> 
> 赞同：5
> 
> 时间：2008-09-15T23:03:18.143
> 
> 标签：regex

我正在寻找一个多行正则表达式，它将匹配空行之后的出现。例如，给定下面的示例电子邮件，我想匹配“发件人：亚历克斯”。 `^From:\s*(.*)$`可以匹配任何 From 行，但我希望它仅限于正文中的行（第一个空白行之后的任何内容）。

```
收到：从服务器
日期：今天
致：特德
来自：詹姆斯
主题：[转发：嗨]

供参考

-  - - 转发消息  -  - -
致：詹姆斯
来自：亚历克斯
主题：你好

聚会！

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T23:09:32.780

我不确定 C# 正则表达式的语法，但你应该有一种方法可以锚定到字符串的开头（而不是行的开头，例如 ^）。在我的示例中，我将其称为“\A”：

```
\A.*?\r?\n\r?\n.*?^From:\s*([^\r\n]+)$ 
```

确保打开多行匹配选项，但它有效，以制作“。” 匹配\n

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T23:09:17.787

为此类工作编写复杂的正则表达式是 IMO 的一个坏主意。最好结合几个简单的查询。例如，首先搜索“\r\n\r\n”以找到正文的开头，然后在正文上运行简单的正则表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T23:12:57.497

这是使用后视断言。第 1 组将为您提供“发件人”行，第 2 组将为您提供实际值（在您的示例中为“Alex”）。

```
(?<=\n\n).*(From:\s*(.*?))$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T23:50:04.227

```
\s{2,}.+?(.+?From:\s(?<Sender>.+?)\s)+? 
```

`\s{2,}`匹配至少两个空格字符，这意味着您的第一个 From: James 不会命中。然后只需寻找下一个“From：”并从那里开始捕获。

将此与`RegexOptions.SingleLine`and一起使用`RegexOptions.ExplicitCapture`，这意味着外部组不会命中。

# java - 如何使用 Eclipse 调试 JSP Tomcat 服务？

> ID：67810
> 
> 赞同：8
> 
> 时间：2008-09-15T23:05:53.303
> 
> 标签：java, eclipse, tomcat, debugging

我想使用 Eclipse IDE 调试器调试我单独运行的 JSP/Struts/Tomcat/Hibernate 应用程序堆栈。如何设置 java JVM 和 eclipse 以便我可以设置断点、监视变量值并查看当前正在执行的代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T23:18:23.880

我只是用谷歌搜索了它。:)

[http://bugs.sakaiproject.org/confluence/display/BOOT/Setting+Up+Tomcat+For+Remote+Debugging](http://bugs.sakaiproject.org/confluence/display/BOOT/Setting+Up+Tomcat+For+Remote+Debugging)

更多关于谷歌。

有效地设置您的 JPDA 设置： set JPDA_ADDRESS=8000 set JPDA_TRANSPORT=dt_socket bin/catalina.bat jpda start

然后，在 Eclipse 中，运行->调试配置...->远程应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T23:27:07.713

按着这些次序：

1.  将以下参数添加到`java`用于启动 Tomcat 的命令中（在 Windows 上，我认为这是在 TOMCAT\bin\catalina.bat 中）

    -Xdebug -Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=n

2.  在 Eclipse 中，创建一个“远程 Java 应用程序”调试配置并将端口设置为 8787，将主机设置为运行 Tomcat 的机器的名称（或 IP 地址）。如果 Tomcat 与 Eclipse 在同一台机器上运行，请使用“localhost”。

3.  在调试配置的“源”选项卡中，添加要调试的任何项目

4.  启动Tomcat

5.  启动您在步骤 2 中创建的调试配置

6.  Eclipse 现在应该在您在步骤 3 中添加的项目中设置的任何断点处停止。

## 笔记：

*   如果由于某种原因您不能使用 8787，您可以将端口更改为任何其他可用端口
*   如果您希望 Tomcat 等待远程调试器启动，请在上面的命令中使用 'suspend=n' 来 'suspend=y'

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T00:45:38.647

你可以按照他们的建议去做，或者使用这个 Eclipse 插件，这使得配置 Tomcat 变得更容易：[Eclipse Tomcat Plugin](http://www.eclipsetotale.com/tomcatPlugin.html)

通过此插件启动 tomcat 时，默认情况下以调试模式启动，如果您希望它不允许 Eclipse 连接远程调试器，则必须显式禁用调试模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T19:49:54.553

对于 Windows 上的 Tomcat 5.5：

编辑 bin/startup.bat

找到显示如下的行：

```
调用“%EXECUTABLE%”开始 %CMD_LINE_ARGS%
```

用这些行替换它：

```
设置 JPDA_ADDRESS=8000
设置 JPDA_TRANSPORT=dt_socket
调用 "%EXECUTABLE%" jpda 开始 %CMD_LINE_ARGS%
```

# php - 如何在 php 中免费获取 apache 子节点的数量

> ID：67819
> 
> 赞同：3
> 
> 时间：2008-09-15T23:06:45.670
> 
> 标签：php, apache

在 php 中，如何获取当前可用的 apache 子项的数量
（`status = SERVER_READY`在 apache 记分板中）？

我真的希望有一种简单的方法可以在我缺少的 php 中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T23:08:08.180

您可以执行`ps aux | grep httpd`or的 shell 命令`ps aux | grep apache`并计算输出中的行数。

```
exec('ps aux | grep apache', $output);
$processes = count($output); 
```

我不确定状态列中的哪个状态表明它已准备好接受连接，但您可以对其进行过滤以获得就绪进程的计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T23:39:22.253

如果您有权访问 Apache 服务器状态页面，请尝试使用 ?auto 标志：

[http://yourserver/server-status?auto](http://yourserver/server-status?auto)

输出是状态页的机器可读版本。我*相信*您正在寻找“IdleWorkers”。这里有一些简单的 PHP5 代码可以帮助您入门。在现实生活中，您可能希望使用 cURL 或套接字连接来启动超时，以防服务器离线。

```
<?php

$status = file('http://yourserver/server-status?auto');
foreach ($status as $line) {
  if (substr($line, 0, 10) == 'IdleWorkers') {
    $idle_workers = trim(substr($line, 12));
    print $idle_workers;
    break;
  }
}

?> 
```

# .net - 可扩展性的最佳数据访问范式是什么？

> ID：67831
> 
> 赞同：10
> 
> 时间：2008-09-15T23:07:46.933
> 
> 标签：.net, asp.net, linq, entity-framework, ado.net

微软提供了许多不同的数据访问选项。哪一个最适合可扩展的应用程序？

**林克**

我们应该使用 Linq 吗？这当然看起来很容易，但如果你知道你的 SQL 确实有帮助。另外我听说您不能使用 Linq 在 ASP.NET 中运行异步查询。因此我想知道它是否真的可扩展？有没有使用 Linq 的非常大的网站（stackoverflow 可能除外）。

**实体框架**

不要听到太多关于实体框架的喧嚣。似乎更接近我熟悉的对象模型。

**阿斯托利亚/动态数据**

我们应该将数据作为服务公开吗？

我很困惑，那是在我进入其他 ORM 产品（如 NHibernate）之前。有什么更好的想法或智慧吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-16T04:06:34.280

我会推荐 NHibernate 或实体框架。对于大型站点，我会使用 ADO.NET 数据服务。我不会用 LINQ to SQL 做任何大的事情。我认为 Stack Overflow 最终可能会出现一些有趣的规模问题，即 2 层而不是 3 层，并且随着数据库的物理方面的变化以及这些变化在整个代码中的影响，它们在重构时也会遇到一些麻烦。只是一个想法。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-15T23:10:56.440

我认为 ADO.Net Data Services（以前称为 Astoria）可以发挥巨大的作用。它非常适合 Web 的 REST 风格架构。

由于网络是可扩展的，我猜任何遵循其架构的东西也是可扩展的。另外，您可能需要留意 SQL Server 数据服务。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T23:14:01.537

如果您谈论的是关系数据库，那么我的投票是将您的所有数据操作封装在存储过程中，而不管您如何从其他层访问它们。

如果您禁用对数据库的所有读/写访问，除了通过存储过程，您可以将数据模型隐藏在定义良好的合同后面。数据模型可以自由更改，因此存储过程仍然尊重它们的输入和输出。

这使 DBA 可以完全自由地调整您的应用程序并使其可扩展。当 SQL 由数据库外部的工具生成时，这是一项非常非常困难的任务。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T04:34:47.637

这些天来，锁定存储过程似乎是一种正在减弱的思维方式，至少这是我目前的观察。这种思维方式确实适用于 ORM 世界，因为它们通常更有效地直接对抗表，但任何值得他们盐分的 ORM 也将允许使用 procs——有时你别无选择。

关于 EF 有很多意见，不管别人怎么说，好或坏，它是 V1 产品，根据经验，MS 需要大约 3 转才能让它正确，等待下一个转至少。

似乎这个领域最大的参与者是 NHibernate，社区对此有很多支持。语言特性 Linq 在进入 NHibernate 堆栈方面应该不会太远。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T23:11:30.637

使用任何对你有用的东西。如果您已经拥有一个相当规范化的数据库（即，主键和外键的良好定义），这些都是最容易设置的。但是，如果您有不容易规范化的数据，实体框架比 LINQ to SQL 更灵活，但配置起来确实需要更多的工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T23:13:27.620

我们一直在集群环境中试验 LINQ，它似乎在单个机器和整个集群上都可以很好地扩展。在您提供的 3 个选项中，我会说 LINQ 是更好的选择，尽管每个选项的目标受众略有不同，因此您应该在决定访问范式之前定义您将对数据执行的操作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-16T00:17:00.043

我会建议linq。它在我们的网站上可以很好地扩展，并且使用起来非常简单。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-16T00:25:21.397

使用带有 LINQ 的存储过程......但不要让存储过程变成数据访问层！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-09T07:50:55.153

这篇文章来自 2008 年，当时云还没有真正起飞。似乎需要更新答案。我将仅提供一些链接和概述。我相信这个网站上有更多关于这个主题的最新帖子，如果我找到它们，我会在这里添加链接。

谈到数据可扩展性和事务处理可扩展性，2017 年我们需要谈论云和云服务提供商。

我认为目前排名前三的云提供商是：

*   [亚马逊网络服务 (AWS)](https://aws.amazon.com/pricing/)
*   [谷歌的云平台（GCP）](https://cloud.google.com/pricing/)
*   [微软天青](https://azure.microsoft.com/en-us/pricing/)

**成本**

使用云服务的一大好处是没有前期成本、没有终止费，而且您只需为使用的内容付费。（引用 Mr.Alba 2016 年的文章“ [AWS、Google Cloud 和 Azure 的并列比较](https://www.sitepoint.com/a-side-by-side-comparison-of-aws-google-cloud-and-azure/)”）

我们自己使用 AWS。我们只在安装并运行虚拟机时付费，因此它是一种廉价的启动方式。通常，服务提供商按分钟或按小时收费，但您可以保证在整个时间内都拥有它。

一种更便宜的方式是尽力而为的现货定价。Spot 价格代表您必须出价以保证单个 Spot 请求得到满足的价格。当您的出价高于 Spot 价格时，Amazon EC2 会启动您的 Spot 实例，而当 Spot 价格高于您的出价时，Amazon EC2 会终止您的 Spot 实例。[（此处](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-spot-instances-history.html)无耻引用亚马逊的用户指南）

[*A Side-by-Side Comparison of AWS、Google Cloud 和 Azure*](https://www.sitepoint.com/a-side-by-side-comparison-of-aws-google-cloud-and-azure/)[是一篇很好的文章，对这三个可用的](https://www.sitepoint.com/a-side-by-side-comparison-of-aws-google-cloud-and-azure/)服务提供商进行了并排比较。

有关云服务的更多学术观点，请阅读 Yu、Wang、Ren 和 Lou的 2010 年论文“[*在云计算中实现安全、可扩展和细粒度的数据访问控制*” ，在](http://ieeexplore.ieee.org/document/5462174/)[此处](http://ieeexplore.ieee.org/document/5462174/)提供的 INFOCOM 2010 论文集中，但您可以需要成为 IEEE 成员才能访问它。虽然它有些过时，但它非常出色，您可以将其用作起点。

云中的扩展一直在爆炸式增长，直到最近，扩展是通过启动新的虚拟机来完成的，这需要几秒钟，但使用容器可以在几毫秒内启动新实例。有关这方面的更多信息，请在[此处](https://www.docker.com/what-docker)查看 Docker 和 Docker 容器。

对于这个答案只是一堆获取更多信息的链接，我深表歉意，但我认为这个问题的答案应该有更新。我希望这能激发人们提供更多第一手资料。如果您已经发布了一些相关信息，请考虑提供指向您自己帖子的链接。谢谢！

# vba - 在 VBA 中删除文件

> ID：67835
> 
> 赞同：130
> 
> 时间：2008-09-15T23:08:36.447
> 
> 标签：vba, file-io, delete-file, file-exists

使用 VBA，我该如何：

1.  测试文件是否存在，如果存在，
2.  删除它？

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2008-09-15T23:12:17.560

1.)[在这里](http://www.tek-tips.com/faqs.cfm?fid=1936)检查。基本上这样做：

```
Function FileExists(ByVal FileToTest As String) As Boolean
   FileExists = (Dir(FileToTest) <> "")
End Function 
```

我将留给您找出所需的各种错误处理，但这些是我正在考虑的错误处理内容：

*   检查传递的空字符串。
*   检查文件名/路径中包含非法字符的字符串

2.) 如何删除文件。看看[这个。](http://word.mvps.org/faqs/macrosvba/DeleteFiles.htm) 基本上使用 Kill 命令，但您需要允许文件是只读的。这里有一个功能：

```
Sub DeleteFile(ByVal FileToDelete As String)
   If FileExists(FileToDelete) Then 'See above          
      ' First remove readonly attribute, if set
      SetAttr FileToDelete, vbNormal          
      ' Then delete the file
      Kill FileToDelete
   End If
End Sub 
```

同样，我将把错误处理留给你，这些都是我要考虑的事情：

*   对于目录和文件，这应该表现不同吗？用户是否必须明确表明他们要删除目录？

*   您是否希望代码自动重置只读属性，或者是否应该向用户提供某种指示已设置只读属性？

* * *

编辑：将此答案标记为社区 wiki，以便任何人都可以在需要时对其进行修改。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-09-16T11:03:40.580

我完全同意Brettski答案的另一种编码方式可能是

```
With New FileSystemObject
    If .FileExists(yourFilePath) Then
        .DeleteFile yourFilepath
    End If
End With 
```

效果相同，但变量声明更少（嗯，根本没有）。

FileSystemObject 是一个非常有用的工具，非常值得使用。除此之外，对于文本文件的写入，它实际上有时会比传统的替代方案更快，这可能会让一些人感到惊讶。（至少根据我的经验，YMMV）。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-15T23:34:22.953

我可能会为此大发雷霆，但如果你只是要删除它，那么测试存在的意义何在？我的一个主要烦恼是一个应用程序抛出一个错误对话框，例如“无法删除文件，它不存在！”

```
On Error Resume Next
aFile = "c:\file_to_delete.txt"
Kill aFile
On Error Goto 0
return Len(Dir$(aFile)) > 0 ' Make sure it actually got deleted. 
```

如果文件首先不存在，则任务完成！

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-15T23:12:09.917

以下可用于测试文件是否存在，然后将其删除。

```
Dim aFile As String
aFile = "c:\file_to_delete.txt"
If Len(Dir$(aFile)) > 0 Then
     Kill aFile
End If 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-15T23:11:17.703

在 VB 中，它通常`Dir`会找到文件的目录。如果它不为空，则它存在，然后用于`Kill`删除文件。

```
test = Dir(Filename)
If Not test = "" Then
    Kill (Filename)
End If 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-15T23:40:20.660

**设置对 Scripting.Runtime 库的引用**，然后使用 FileSystemObject：

```
Dim fso as New FileSystemObject, aFile as File

if (fso.FileExists("PathToFile")) then
    aFile = fso.GetFile("PathToFile")
    aFile.Delete
End if 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-10-02T17:09:17.557

这里有一个提示：您是重新使用文件名，还是计划做一些需要立即删除的事情？

不？

您可以让 VBA使用 VBA.Shell从命令提示符*异步触发命令 DEL "C:\TEMP\scratchpad.txt" /F：*

壳牌“DEL”&chr(34)&strPath&chr(34)&“/F”，vbHide

请注意文件名周围的双引号（ASCII 字符 34）：我假设您有一个网络路径，或者一个包含空格的长文件名。

如果它是一个大文件，或者它的网络连接速度很慢，那么一劳永逸是要走的路。当然，您永远无法看到这是否有效。但是您立即恢复您的 VBA，有时这比等待网络更好。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-15T23:12:37.060

您可以设置对 Scripting.Runtime 库的引用，然后使用 FileSystemObject。它有一个 DeleteFile 方法和一个 FileExists 方法。

[请参阅此处](http://msdn.microsoft.com/en-us/library/aa164509(office.10).aspx)的 MSDN 文章。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-15T09:38:07.213

对我有用的第一个解决方案的较短版本：

```
Sub DeleteFile(ByVal FileToDelete As String)
   If (Dir(FileToDelete) <> "") Then
      ' First remove readonly attribute, if set
      SetAttr FileToDelete, vbNormal
      ' Then delete the file
      Kill FileToDelete
   End If
End Sub 
```

# xml - 即使在转义字符后也无法让 xslt 输出 (&)

> ID：67859
> 
> 赞同：20
> 
> 时间：2008-09-15T23:12:11.743
> 
> 标签：xml, xslt, escaping, invalid-characters

我正在尝试创建一个由`&`符号分隔的变量赋值查询字符串（例如：）`"var1=x&var2=y&..."`。我计划将此字符串传递到嵌入式闪存文件中。

我无法让`&`符号显示在 XSLT 中。如果我只是`&`在其周围没有任何标签的情况下键入，则呈现 XSLT 文档时会出现问题。如果我`&amp;`在其周围没有任何标签键入，则文档的输出`&amp;`没有变化。如果我输入`<xsl:value-of select="&" />`或`<xsl:value-of select="&amp;" />`我也会收到错误。这可能吗？注意：我也尝试过`&amp;amp;`，但没有成功。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-26T22:48:59.317

您可以`disable-output-escaping`与一个`CDATA`部分组合。尝试这个：

```
<xsl:text disable-output-escaping="yes"><![CDATA[&]]></xsl:text> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-10-13T03:29:02.430

> 我正在尝试创建一个由`&`符号分隔的变量赋值查询字符串（例如：）`"var1=x&var2=y&..."`。我计划将此字符串传递到嵌入式闪存文件中。
> 
> 我无法让`&`符号显示在 XSLT 中。

**这是一个可运行的、简短且完整的演示如何生成这样的 URL：**

```
<xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:variable name="vX" select="'x'"/>
 <xsl:variable name="vY" select="'y'"/>
 <xsl:variable name="vZ" select="'z'"/>

  <xsl:template match="/">
    <xsl:value-of select=
"concat('http://www.myUrl.com/?vA=a&amp;vX=', $vX, '&amp;vY=', $vY, '&amp;vZ=', $vZ)"/>
  </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于任何源 XML 文档（忽略）时**：

```
<t/> 
```

**产生了想要的正确结果：**

```
http://www.myUrl.com/?vA=a&vX=x&vY=y&vZ=z 
```

至于问题中提出的其他问题：

> 如果我`&amp;`在其周围没有任何标签键入，则文档的输出`&amp;`没有变化。

上面的说法根本不正确......只需运行上面的转换并查看结果。

**真正发生了什么**：

您看到的结果是绝对正确的，但是您的输出方法是`html`or `xml`（的默认值`method=`），因此 XSLT 处理器的序列化程序必须将正确的结果 - 字符串`http://www.myUrl.com/?vA=a&vX=x&vY=y&vZ=z` - 表示为 a 中的文本节点（的一部分）格式良好的 XML 文档或 HTML 树中。

根据在格式良好的 XML 文档中的定义，文字 & 符号必须通过字符引用进行转义，例如内置的`&amp;`or `&#38;`, 或`&#x26;`

**请记住**：表示为 XML 文本节点（部分）或 HTML 树中的字符串在表示为文本时可能看起来不像相同的字符串。然而，这是同一字符串的两种不同表示形式。

**为了更好地理解这个简单的事实，请执行以下操作**：

取上述变换，替换`xsl:output`声明：

```
 <xsl:output method="text"/> 
```

有了这个：

```
 <xsl:output method="xml"/> 
```

此外，将输出包含在单个 XML 元素中。您也可以尝试对 & 符号使用不同的转义符。转换现在可能如下所示：

```
<xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" method="xml"/>

 <xsl:variable name="vX" select="'x'"/>
 <xsl:variable name="vY" select="'y'"/>
 <xsl:variable name="vZ" select="'z'"/>

  <xsl:template match="/">
        <t>
            <xsl:value-of select=
 "concat('http://www.myUrl.com/?vA=a&amp;vX=', $vX, '&#38;vY=', $vY, '&#x26;vZ=', $vZ)"/>
        </t>
  </xsl:template>
</xsl:stylesheet> 
```

**结果是**：

```
<t>http://www.myUrl.com/?vA=a&amp;vX=x&amp;vY=y&amp;vZ=z</t> 
```

您将使用 output method 获得相同的结果`html`。

**问题**：

输出的 URL 是否与第一次转换中的输出不同（甚至“损坏”）？

**答案**：

不，在这两种情况下都输出了相同的字符串——但是在每种情况下都使用了不同的字符串**表示形式**。

**问题**：

`disable-output-escaping="yes"`为了输出想要的 URL，我必须使用 DOE ( ) 属性吗？

**答案**：

不，如第一次转换所示。

**问题**：

是否建议使用 DOE ( `disable-output-escaping="yes"`) 属性来输出所需的 URL？

**答案**：

不，在 XSLT 中使用 DOE 是一种不好的做法，通常表明程序员没有很好地掌握 XSLT 处理模型。此外，DOE 只是 XSLT 1.0 的一个可选功能，您的 XSLT 处理器可能没有实现 DOE，或者即使它实现了，您也可能在使用另一个 XSLT 处理器运行相同的转换时遇到问题。

**问题**

> 我来自一个与我悬赏的问题不同的问题。我的问题：我尝试生成这个 onclick 方法：
> 
> ```
>  <input type="submit" 
> onClick="return confirm('are you sure?') && confirm('seriously?');" /> 
> ```
> 
> 我能做的是：我可以将确认放在一个函数中......但它让我烦恼的是我不能在一个属性内制作 & ！这个问题的解决就是我认为的问题的解决。

**回答**

实际上，您可以`&&`在属性内的 JavaScript 表达式中指定布尔运算，将其表示为`&amp;&amp;`

**这是一个完整的示例**，每个人都可以运行，就像我在三个浏览器上所做的那样：Chrome、Firefox 41.1.01 和 IE11：

**HTML**：

```
<!DOCTYPE html> 

    <html> 
      <head> 
        <link rel="stylesheet" href="style.css"> 
        <script src="script.js"></script> 
      </head> 
      <body> 
        <h1>Hello Plunker!</h1> 
        <input type="submit" 
onClick="alert(confirm('are you sure?') &amp;&amp; confirm('seriously?'));" /> 
      </body> 
    </html> 
```

**JavaScript** (script.js):

```
function confirm(message) { 
  alert(message); 
  return message === 'are you sure?'; 

} 
```

**运行此程序时，您将首先收到此警报：**

[![在此处输入图像描述](https://i.stack.imgur.com/OvZms.png)](https://i.stack.imgur.com/OvZms.png)

然后，单击`OK`按钮后，您将收到第二个警报：

[![在此处输入图像描述](https://i.stack.imgur.com/oWoUQ.png)](https://i.stack.imgur.com/oWoUQ.png)

单击后，`OK`您将最终获得产生`&&`操作结果的警报：

[![在此处输入图像描述](https://i.stack.imgur.com/gJBal.png)](https://i.stack.imgur.com/gJBal.png)

您可以通过改变传递给`confirm()`函数的参数的值来使用此代码，并且您将验证生成的结果是使用`&&`运算符的结果。

例如，如果您将`<input>`元素更改为：

```
<input type="submit" 
onClick="alert(confirm('really sure?') &amp;&amp; confirm('seriously?'));" /> 
```

您将首先收到此警报：

[![在此处输入图像描述](https://i.stack.imgur.com/qRt3W.png)](https://i.stack.imgur.com/qRt3W.png)

而当你点击 时`OK`，你会立即得到`&&`运行的最终结果：

[![在此处输入图像描述](https://i.stack.imgur.com/9kpym.png)](https://i.stack.imgur.com/9kpym.png)

第二个警报被跳过，因为操作的第一个操作数`&&`was`false`并且 JavaScript 正在缩短`&&`第一个操作数 is的位置`false`。

**总结一下**：

在`&&`XSLT 生成的 HTML 文档中，通过将`&&`操作数指定为`&amp;&amp;`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-15T23:27:43.763

您是用 HTML 还是 XHTML 表示 URI？例如`<tag attr="http://foo.bar/?key=value&amp;key2=value2&amp;..."/>` ，如果是这样，" `&amp;`" 是在属性值中表示 & 符号的正确方法，即使它看起来与您想要的文字 URI 不同。`&amp;`浏览器将在加载“”和任何其他字符实体引用或将它们传递给 Flash 之前对其进行解码。要嵌入文字，`&`直接在 HTML 或 XHTML 中单独使用“”是不正确的。

我个人还建议学习更多有关 XML 的知识，以便以更清晰的方式思考这些事情。例如，尝试更多地使用 W3C DOM（不仅仅是简单的 Javascript）；即使您不是日常使用它，学习 DOM 也帮助我正确地思考 XML 的树形结构以及如何正确地思考属性和元素的编码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-15T23:15:04.980

`disable-output-escaping="yes"`在您的`value-of`标签中使用

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-15T23:26:13.457

如果您在某个其他标记（如“embed”）的属性中创建一个查询字符串作为较大 URL 的一部分，那么您实际上*希望*将 & 转义为 &。虽然所有浏览器都会弄清楚您的意思并做正确的事，但如果您要将生成的文档传递给验证器，它将在属性值中标记未转义的 &。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-16T11:14:23.847

如果您尝试生成 XML 文件作为输出，您将需要生成`&amp;`（因为`&`它本身是无效的 XML）。如果您只是生成一个字符串，那么您应该将样式表的输出模式设置为`text`通过包含以下内容作为`xsl:stylesheet`

```
<xsl:output method="text"/> 
```

这将防止样式表逃逸并且`<xsl:value-of select="'&amp;'" />`应该生成`&`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-08T00:24:42.503

如果您的转换正在发出 XML 文档，则不应禁用输出转义。您*希望*在输出中对标记字符进行转义，以免发出格式错误的 XML。您用来处理输出的 XML 对象（例如 DOM）将为您取消转义文本。

如果您使用字符串操作而不是 XML 对象来处理输出，那么您就会遇到问题。但问题不在于您的 XSLT，而在于使用字符串操作来处理 XML 的决定，这几乎总是一个糟糕的决定。

如果您的转换正在发出 HTML 或文本（并且您已在`<xsl:output>`元素上设置了输出类型，对吗？），情况就不同了。然后它适合`disable-output-escaping='yes'`在您的`<xsl:value-of>`元素上使用。

但在任何情况下，您都需要对 XSLT 文本节点中的标记字符进行转义，除非您已将文本包装在 CDATA 部分中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-03T09:40:44.913

禁用输出转义将完成这项工作......因为此属性仅支持文本，您也可以操作模板，例如：

```
 <xsl:variable name="replaced">

    <xsl:call-template name='app'>
      <xsl:with-param name='name'/>       
    </xsl:call-template>
  </xsl:variable>

<xsl:value-of select="$replaced" disable-output-escaping="yes"/> 
```

---> 将模板调用包装在一个变量中并使用 disable-output-escaping="yes"..

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-16T10:14:52.320

只需将 & 替换为

```
<![CDATA[&]]> 
```

在数据中。例如：数据 XML

```
<title>Empire <![CDATA[&]]> Burlesque</title> 
```

XSLT 标记：

```
<xsl:value-of select="title" /> 
```

输出：帝国与滑稽剧

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T19:51:04.423

您应该注意，您可以在节点或字符串/文本的值中使用禁用输出转义，例如：

```
<xsl:value-of select="/node/here" disable-output-escaping="yes" /> 
```

或者

```
<xsl:value-of select="'&amp;'" disable-output-escaping="yes" />
<xsl:text disable-output-escaping="yes">Texas A&amp;M</xsl:text> 
```

*注意 xsl:value-of 中的单引号。*

但是，您不能对属性使用禁用输出转义。我知道这完全搞砸了，但是这就是 XSLT 1.0 中的情况。所以以下将**不起作用**：

```
<xsl:value-of select="/node/here/@ttribute" disable-output-escaping="yes" /> 
```

因为在细则中是报价：

> 因此，禁用用于生成注释、处理指令或 **属性节点**的字符串值的or 元素的输出转义是***错误***的；`<xsl:value-of />``<xsl:text />`

 ***强调我的。*

取自：[http ://www.w3.org/TR/xslt#disable-output-escaping](http://www.w3.org/TR/xslt#disable-output-escaping)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T23:18:52.757

使用`disable-output-escaping`属性（布尔值）可能是完成此任务的最简单方法。请注意，您不仅可以使用它，还可以使用它`<xsl:value-of/>`，`<xsl:text>`这可能更干净，具体取决于您的具体情况。

这是规范的相关部分：http: [//www.w3.org/TR/xslt#disable-output-escaping](http://www.w3.org/TR/xslt#disable-output-escaping)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-25T08:34:57.030

org.apache.xalan.xslt.Process，版本 2.7.2 输出到上面提到的“这是一个可运行的、简短且完整的演示如何生成这样的 URL”：

```
<?xml version="1.0" encoding="UTF-8"?>http://www.myUrl.com/?vA=a&amp;vX=x&amp;vY=y&amp;vZ=z11522 
```

XML 声明被一个附加的 抑制`omit-xml-declaration="yes"`，但是输出`method="text"`转义与号是不合理的。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2008-09-15T23:18:03.727

尝试：<xsl:value-of select="&" 禁用输出转义=“是”/>

很抱歉，如果格式混乱。

# cocoa - 学习可可的好方法？

> ID：67875
> 
> 赞同：21
> 
> 时间：2008-09-15T23:15:00.707
> 
> 标签：cocoa

我很想学习 Cocoa，它似乎是 Mac OS X 上最好的系统语言。

你能推荐一些有用的学习语言的方法吗？书籍、网站、示例项目甚至课程？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-15T23:20:01.070

Andy Matuschak 有一篇很棒的[博客文章](http://andymatuschak.org/articles/2007/09/09/getting-started-with-cocoa-a-friendlier-approach/)，它引导您完成几个很好的 Cocoa 教程，解释您为什么要阅读每个教程。

[Cocoa Dev Central](http://www.cocoadevcentral.com/)有大量的教程。

对于书籍，我与 Dave 和 Phillip Bowden[的 Aaron Hillegass 的 Cocoa Programming for Mac OS X 相呼应](https://rads.stackoverflow.com/amzn/click/com/0321503619)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-15T23:19:42.800

Mac OS X 的 Cocoa 编程，作者 Aaron Hillegass。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-15T23:45:45.203

1.  阅读并遵循[成为 Xcoder](http://www.cocoalab.com/?q=becomeanxcoder)教程。
2.  阅读[Mac OS X 的 Cocoa Programming](https://rads.stackoverflow.com/amzn/click/com/B00139XSRO)并输入所有代码。
3.  如果您想观看编程是如何完成的，而不仅仅是阅读它，您也可以观看[CocoaCast 。](http://www.cocoacast.com/)
4.  苹果开发者网站中的 Cocoa 文档也是一个很好的资源。按照自己的方式学习 Cocoa 和 Objective-C 概念指南并制作示例。
5.  最后，只需练习并应用您在自己的应用程序中阅读/看到的内容。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-15T23:27:17.603

[Cocoa Programming for Mac OS X](https://rads.stackoverflow.com/amzn/click/com/0321503619)是一本很棒的书，它涵盖了 Objective-C 和许多组成 Cocoa 的框架。我认识的大多数 Cocoa 程序员（包括我自己）都是从这本书中学到的。第三版是最近发布的，所以它是最新的。祝你好运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T23:30:14.320

请务必查看[http://www.cocoalab.com/?q=becomeanxcoder](http://www.cocoalab.com/?q=becomeanxcoder "成为 Xcoder")。它从编程的基础知识到学习 Cocoa、Xcode 等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T23:57:07.407

[Big Nerd Ranch](http://www.bignerdranch.com/classes/cocoa.shtml)绝对值得上的课程……非常值得！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T23:32:27.047

买一本书，打开 XCode，然后*编写*. 说真的，写作是学习 Cocoa*的最佳方式。*另外，我推荐[Cocoa Programming for Mac OS X](https://rads.stackoverflow.com/amzn/click/com/0321213149)！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T23:49:14.853

我最近一直在自己学习 Cocoa，发现 Apple 自己的[Cocoa 资源](http://developer.apple.com/cocoa/)非常有用。

例如，我在[Adium 源代码](http://trac.adiumx.com/wiki/GettingAdiumSource)中花费了相当多的时间。Adium 是一个相对较大的项目，所以我经常能够找到我感兴趣的任何概念的示例。

CocoaDev [wiki](http://www.cocoadev.com/)也非常有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-04-28T08:13:46.977

我读过的关于 Cocoa 的最好的书之一是Richard Wentk的[Cocoa (Developer Reference)](https://rads.stackoverflow.com/amzn/click/com/0470495898)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-22T23:04:54.590

我遇到的最好的书是来自 Apress 的书，在这种情况下是：Beginning iPhone 4 Development。对我来说比 O'Reilly 的那些要清楚得多

# c# - 在父应用程序和虚拟目录之间传递数据

> ID：67879
> 
> 赞同：0
> 
> 时间：2008-09-15T23:16:10.627
> 
> 标签：c#, asp.net, iis

我有一个在虚拟目录中作为子应用程序运行的应用程序。

我想从父应用程序传递一个值，但我相信 Session 是每个应用程序的键控，并且不起作用。

更复杂的是，父应用程序是 WebForms，而子应用程序是 NVelocity MVC。

有谁知道允许我在虚拟应用程序之间使用某种会话类型功能的技巧？

编辑：网络服务并不是我真正想到的，我需要做的就是将登录的用户用户名传递给子应用程序。此外，如果在父节点上调用 web 服务，我不会得到相同的会话，所以我不知道是什么用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T23:24:18.517

听起来像网络服务是要走的路。您可以执行以下操作：

*   让 WebForms 应用程序在其数据库中创建一些数据，并使用与之关联的某种键。
*   将该 URL 中的密钥传递给 NVelocity MVC 应用程序。
*   允许 NVMVC 应用程序使用传递的密钥在 WebForms 应用程序上调用 Web 服务（REST、XML-RPC、SOAP 等）。

这将解决您可能遇到的任何类型的会话键控或 cookie 域问题，并允许您传递一些结构良好的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T23:28:44.043

你可以做一个服务器端的 HTTP 请求，它在 C# 中看起来像这样：

```
HttpWebRequest req = (HttpWebRequest)WebRequest.Create("/ASPSession.ASP?SessionVar=" + SessionVarName);
req.Headers.Add("Cookie: " + SessionCookieName + "=" + SessionCookieValue);

HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
Stream receiveStream = resp.GetResponseStream();

System.Text.Encoding encode = System.Text.Encoding.GetEncoding("utf-8");

StreamReader readStream = new StreamReader(receiveStream, encode);

string response = readStream.ReadToEnd();

resp.Close();
readStream.Close();
return response; 
```

在 ASP 方面，我只是验证请求仅来自 localhost，以防止 XSS 式攻击，然后响应只是 Session 变量的值。

查找 cookie 很容易，会话 cookie 都有相似的名称，所以只需检查 cookie 集合，直到找到合适的 cookie。请注意，这仅在 cookie 在整个域上有效时才有效，而不仅仅是在您所在的子文件夹上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-06T01:51:03.173

为什么不能简单地将其作为加密查询字符串传递？

子应用程序可以解密、验证它，并且 bob 是你的叔叔。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-12T14:32:49.420

在您的页面上使用经典的 asp 表单使用 post 传递，在子应用程序中使用 request.form 获取

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T15:20:01.917

将您需要共享的数据存储在两个应用程序都可以查询的地方，并使用两个应用程序都知道的密钥。

如果您不想要 Web 服务，可以使用数据库。

# ruby - 在红宝石中散列网址的最佳方法是什么？

> ID：67890
> 
> 赞同：16
> 
> 时间：2008-09-15T23:18:36.453
> 
> 标签：ruby

我正在编写一个指向外部链接的网络应用程序。我希望为我可以在 URL 中使用的每个文档创建一个非顺序的、不可猜测的 id。我做了一件显而易见的事情：将 url 视为字符串并在其上使用 str#crypt，但这似乎会阻塞任何非字母数字字符，例如斜杠、点和下划线。

有关解决此问题的最佳方法的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-15T23:49:00.033

根据您希望字符串的长度，您可以使用几种替代方法：

```
require 'digest'
Digest.hexencode('http://foo-bar.com/yay/?foo=bar&a=22')
# "687474703a2f2f666f6f2d6261722e636f6d2f7961792f3f666f6f3d62617226613d3232"

require 'digest/md5'
Digest::MD5.hexdigest('http://foo-bar.com/yay/?foo=bar&a=22')
# "43facc5eb5ce09fd41a6b55dba3fe2fe"

require 'digest/sha1'
Digest::SHA1.hexdigest('http://foo-bar.com/yay/?foo=bar&a=22')
# "2aba83b05dc9c2d9db7e5d34e69787d0a5e28fc5"

require 'digest/sha2'
Digest::SHA2.hexdigest('http://foo-bar.com/yay/?foo=bar&a=22')
# "e78f3d17c1c0f8d8c4f6bd91f175287516ecf78a4027d627ebcacfca822574b2" 
```

请注意，这不是不可猜测的，您可能必须将其与其他一些（秘密但静态的）数据结合起来对字符串进行加盐：

```
salt = 'foobar'
Digest::SHA1.hexdigest(salt + 'http://foo-bar.com/yay/?foo=bar&a=22')
# "dbf43aff5e808ae471aa1893c6ec992088219bbb" 
```

现在，为不知道原始内容且无法访问您的源的人生成此哈希变得更加困难。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T02:38:13.340

我还建议查看摘要命名空间中的不同算法。为了更难猜测，而不是（或除了）使用秘密密码进行加盐，您还可以使用精确的时间转储：

```
require 'digest/md5'
def hash_url(url)
  Digest::MD5.hexdigest("#{Time.now.to_f}--#{url}")
end 
```

由于任何散列算法的结果都不能保证是唯一的，因此在假设您的散列可用之前，请不要忘记根据先前生成的散列检查结果的唯一性。Time.now 的使用使得重试实现起来很简单，因为您只需要调用直到生成唯一的哈希。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T23:21:34.823

使用Ruby 标准库中的[Digest::MD5](http://ruby-doc.org/stdlib/libdoc/digest/rdoc/index.html)：

```
Digest::MD5.hexdigest(my_url) 
```

# c++ - 为什么我们需要 extern "C"{ #include 在 C++ 中？

> ID：67894
> 
> 赞同：141
> 
> 时间：2008-09-15T23:19:52.583
> 
> 标签：c++, linkage, name-mangling, extern-c

为什么我们需要使用：

```
extern "C" {
#include <foo.h>
} 
```

**具体来说：**

*   我们应该什么时候使用它？

*   在需要我们使用它的编译器/链接器级别发生了什么？

*   这在编译/链接方面如何解决需要我们使用它的问题？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2008-09-15T23:27:38.867

C 和 C++ 表面上相似，但各自编译成一组非常不同的代码。当您在 C++ 编译器中包含头文件时，编译器需要 C++ 代码。但是，如果它是 C 头文件，则编译器期望头文件中包含的数据被编译成某种格式——C++ 'ABI' 或“应用程序二进制接口”，因此链接器会阻塞。这比将 C++ 数据传递给需要 C 数据的函数更可取。

（要深入了解细节，C++ 的 ABI 通常会“破坏”它们的函数/方法的名称，因此`printf()`在不将原型标记为 C 函数的情况下调用，C++ 实际上会生成代码调用`_Zprintf`，最后加上额外的废话。 )

所以：`extern "C" {...}`在包含 ac 标头时使用——就这么简单。否则，您将在编译的代码中出现不匹配，并且链接器会阻塞。然而，对于大多数头文件，您甚至不需要，`extern`因为大多数系统 C 头文件已经说明了它们可能包含在 C++ 代码中并且已经包含在`extern "C"`它们的代码中的事实。

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2008-09-15T23:38:54.987

extern "C" 确定生成的目标文件中的符号应如何命名。如果函数声明时没有 extern "C"，则目标文件中的符号名称将使用 C++ 名称修饰。这是一个例子。

给定 test.C 像这样：

```
void foo() { } 
```

在目标文件中编译和列出符号给出：

```
$ g++ -c test.C
$ nm test.o
0000000000000000 T _Z3foov
                 U __gxx_personality_v0 
```

foo 函数实际上称为“_Z3foov”。此字符串包含返回类型和参数的类型信息等。如果您改为这样编写 test.C ：

```
extern "C" {
    void foo() { }
} 
```

然后编译并查看符号：

```
$ g++ -c test.C
$ nm test.o
                 U __gxx_personality_v0
0000000000000000 T foo 
```

你得到C链接。目标文件中“foo”函数的名称只是“foo”，它没有来自名称修饰的所有花哨的类型信息。

如果附带的代码是使用 C 编译器编译的，但您尝试从 C++ 调用它，则通常在 extern "C" {} 中包含一个标头。当你这样做时，你告诉编译器头文件中的所有声明都将使用 C 链接。当您链接代码时，您的 .o 文件将包含对“foo”的引用，而不是“_Z3fooblah”，它希望与您链接的库中的任何内容相匹配。

大多数现代库都会在此类标头周围设置保护措施，以便使用正确的链接声明符号。例如，在许多标准标题中，您会发现：

```
#ifdef __cplusplus
extern "C" {
#endif

... declarations ...

#ifdef __cplusplus
}
#endif 
```

这确保当 C++ 代码包含标头时，目标文件中的符号与 C 库中的符号匹配。如果 C 标头很旧并且还没有这些保护，则您只需要在 C 标头周围放置 extern "C" {}。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-09-15T23:27:51.597

在 C++ 中，您可以拥有共享名称的不同实体。例如，这里是一个全名为*foo*的函数列表：

*   `A::foo()`
*   `B::foo()`
*   `C::foo(int)`
*   `C::foo(std::string)`

为了区分它们，C++ 编译器将在称为名称修饰或装饰的过程中为每个创建唯一名称。C 编译器不这样做。此外，每个 C++ 编译器执行此操作的方式可能不同。

extern "C" 告诉 C++ 编译器不要对大括号内的代码执行任何名称修改。这允许您从 C++ 中调用 C 函数。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-09-15T23:24:32.370

它与不同编译器执行名称修饰的方式有关。C++ 编译器将以与 C 编译器完全不同的方式破坏从头文件导出的符号名称，因此当您尝试链接时，您会收到一个链接器错误，提示缺少符号。

为了解决这个问题，我们告诉 C++ 编译器以“C”模式运行，因此它以与 C 编译器相同的方式执行名称修改。这样做后，链接器错误就得到了修复。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-15T23:28:54.543

C 和 C++ 对符号名称有不同的规则。符号是链接器如何知道在编译器生成的一个目标文件中对函数“openBankAccount”的调用是对您在另一个目标文件中调用的那个函数的引用编译器。这使您可以使用多个源文件制作程序，这在处理大型项目时是一种解脱。

在 C 中，规则非常简单，符号都在一个名称空间中。所以整数“socks”存储为“socks”，函数count_socks存储为“count_socks”。

使用这个简单的符号命名规则为 C 和其他语言（如 C）构建了链接器。所以链接器中的符号只是简单的字符串。

但是在 C++ 中，该语言允许您拥有名称空间、多态性以及与这样一个简单规则相冲突的各种其他事物。所有六个名为“add”的多态函数都需要有不同的符号，否则其他目标文件将使用错误的符号。这是通过“修改”（这是一个技术术语）符号名称来完成的。

将 C++ 代码链接到 C 库或代码时，您需要 extern "C" 用 C 编写的任何内容，例如 C 库的头文件，以告诉您的 C++ 编译器这些符号名称不会被破坏，而其余的您的 C++ 代码当然必须被破坏，否则它将无法工作。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-09-15T23:29:41.343

> 我们应该什么时候使用它？

当您将 C 库链接到 C++ 目标文件时

> 在需要我们使用它的编译器/链接器级别发生了什么？

C 和 C++ 使用不同的符号命名方案。这告诉链接器在给定库中链接时使用 C 的方案。

> 这在编译/链接方面如何解决需要我们使用它的问题？

使用 C 命名方案允许您引用 C 样式的符号。否则，链接器将尝试不起作用的 C++ 样式符号。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-15T23:25:34.893

C++ 编译器创建符号名称的方式与 C 编译器不同。因此，如果您尝试调用驻留在 C 文件中并编译为 C 代码的函数，您需要告诉 C++ 编译器它尝试解析的符号名称与默认值不同；否则链接步骤将失败。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-15T23:39:06.967

任何时候你都应该使用 extern "C"，只要你包含一个定义函数的头文件，这个函数驻留在由 C 编译器编译的文件中，用于 C++ 文件。（许多标准 C 库可能会在其头文件中包含此检查，以使开发人员更简单）

例如，如果您有一个包含 3 个文件 util.c、util.h 和 main.cpp 的项目，并且 .c 和 .cpp 文件都是使用 C++ 编译器（g++、cc 等）编译的，那么它不是t 确实需要，甚至可能导致链接器错误。如果您的构建过程对 util.c 使用常规 C 编译器，那么在包含 util.h 时您将需要使用 extern "C"。

正在发生的事情是 C++ 在其名称中对函数的参数进行了编码。这就是函数重载的工作原理。C 函数往往会在名称的开头添加下划线（“_”）。如果函数的实际名称是 _DoSomething() 或只是 DoSomething()，则不使用 extern "C" 链接器将寻找名为 DoSomething@@int@float() 的函数。

使用 extern "C" 通过告诉 C++ 编译器它应该寻找一个遵循 C 命名约定而不是 C++ 的函数来解决上述问题。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-15T23:30:25.567

该`extern "C" {}`构造指示编译器不要对大括号内声明的名称执行修改。通常，C++ 编译器会“增强”函数名称，以便它们对有关参数和返回值的类型信息进行编码；这被称为*重名*。该`extern "C"`构造可防止损坏。

它通常在 C++ 代码需要调用 C 语言库时使用。当将 C++ 函数（例如来自 DLL）暴露给 C 客户端时，也可以使用它。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-15T23:25:09.217

这用于解决名称修改问题。extern C 表示这些函数在“平面”C 风格的 API 中。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-05-14T19:00:33.790

**反编译`g++`生成的二进制文件以查看发生了什么**

要了解为什么`extern`是必要的，最好的办法是通过示例详细了解目标文件中发生的事情：

主文件

```
void f() {}
void g();

extern "C" {
    void ef() {}
    void eg();
}

/* Prevent g and eg from being optimized away. */
void h() { g(); eg(); } 
```

使用 GCC 4.8 Linux [ELF](https://stackoverflow.com/questions/26294034/how-to-make-an-executable-elf-file-in-linux-using-a-hex-editor/30648229#30648229)输出编译：

```
g++ -c main.cpp 
```

反编译符号表：

```
readelf -s main.o 
```

输出包含：

```
Num:    Value          Size Type    Bind   Vis      Ndx Name
  8: 0000000000000000     6 FUNC    GLOBAL DEFAULT    1 _Z1fv
  9: 0000000000000006     6 FUNC    GLOBAL DEFAULT    1 ef
 10: 000000000000000c    16 FUNC    GLOBAL DEFAULT    1 _Z1hv
 11: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND _Z1gv
 12: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND eg 
```

**解释**

我们看到：

*   `ef`并`eg`存储在与代码中同名的符号中

*   其他符号被破坏。让我们解开它们：

    ```
    $ c++filt _Z1fv
    f()
    $ c++filt _Z1hv
    h()
    $ c++filt _Z1gv
    g() 
    ```

结论：以下两种符号类型*均未*损坏：

*   定义
*   已声明但未定义 ( `Ndx = UND`)，在链接或运行时从另一个目标文件提供

`extern "C"`因此，调用时您将需要两者：

*   C 来自 C++：告诉`g++`期望由生成的未损坏符号`gcc`
*   来自 C 的 C++：告诉`g++`生成未损坏的符号以`gcc`供使用

**在外部 C 中不起作用的东西**

很明显，任何需要名称修改的 C++ 功能都无法在内部工作`extern C`：

```
extern "C" {
    // Overloading.
    // error: declaration of C function ‘void f(int)’ conflicts with
    void f();
    void f(int i);

    // Templates.
    // error: template with C linkage
    template <class C> void f(C i) { }
} 
```

**来自 C++ 示例的最小可运行 C**

为了完整起见和新手，另请参阅：[如何在 C++ 项目中使用 C 源文件？](https://stackoverflow.com/questions/13694605/how-to-use-c-source-files-in-a-c-project/51912672#51912672)

从 C++ 调用 C 非常简单：每个 C 函数只有一个可能的未损坏符号，因此不需要额外的工作。

主文件

```
#include <cassert>

#include "c.h"

int main() {
    assert(f() == 1);
} 
```

ch

```
#ifndef C_H
#define C_H

/* This ifdef allows the header to be used from both C and C++. */
#ifdef __cplusplus
extern "C" {
#endif
int f();
#ifdef __cplusplus
}
#endif

#endif 
```

抄送

```
#include "c.h"

int f(void) { return 1; } 
```

跑：

```
g++ -c -o main.o -std=c++98 main.cpp
gcc -c -o c.o -std=c89 c.c
g++ -o main.out main.o c.o
./main.out 
```

没有`extern "C"`链接失败：

```
main.cpp:6: undefined reference to `f()' 
```

因为`g++`期望找到一个 mangled `f`，它`gcc`没有产生。

[GitHub 上的示例](https://github.com/cirosantilli/cpp-cheat/tree/bf5f48628d0b01ba6a3fcea6f1162b28539654c9/c-from-cpp)。

**C 示例中的最小可运行 C++**

从中调用 C++ 有点困难：我们必须手动创建要公开的每个函数的非损坏版本。

在这里，我们说明了如何将 C++ 函数重载暴露给 C。

主程序

```
#include <assert.h>

#include "cpp.h"

int main(void) {
    assert(f_int(1) == 2);
    assert(f_float(1.0) == 3);
    return 0;
} 
```

cpp.h

```
#ifndef CPP_H
#define CPP_H

#ifdef __cplusplus
// C cannot see these overloaded prototypes, or else it would get confused.
int f(int i);
int f(float i);
extern "C" {
#endif
int f_int(int i);
int f_float(float i);
#ifdef __cplusplus
}
#endif

#endif 
```

cpp.cpp

```
#include "cpp.h"

int f(int i) {
    return i + 1;
}

int f(float i) {
    return i + 2;
}

int f_int(int i) {
    return f(i);
}

int f_float(float i) {
    return f(i);
} 
```

跑：

```
gcc -c -o main.o -std=c89 -Wextra main.c
g++ -c -o cpp.o -std=c++98 cpp.cpp
g++ -o main.out main.o cpp.o
./main.out 
```

没有`extern "C"`它失败：

```
main.c:6: undefined reference to `f_int'
main.c:7: undefined reference to `f_float' 
```

因为生成了无法找到的`g++`损坏符号。`gcc`

[GitHub 上的示例](https://github.com/cirosantilli/cpp-cheat/tree/bf5f48628d0b01ba6a3fcea6f1162b28539654c9/cpp-from-c)。

在 Ubuntu 18.04 中测试。

# vb.net - vb.net 中的 lambda 表达式

> ID：67916
> 
> 赞同：5
> 
> 时间：2008-09-15T23:24:17.940
> 
> 标签：vb.net, linq

我有一些东西让我非常疯狂......

```
 Public Function GetAccountGroups() As IList(Of AccountGroup)
        Dim raw_account_groups As IList(Of AccountGroup)
        raw_account_groups = _repository.GetAccountGroups().ToList()
        Dim parents = (From ag In raw_account_groups _
                      Where ag.parent_id = 0 _
                      Select ag).ToList()

        parents(0).sub_account_groups = (From sag In raw_account_groups _
                               Where sag.parent_id = 0 _
                                Select sag).ToList()

        Dim sql_func As Func(Of AccountGroup, List(Of AccountGroup)) = Function(p) _
                                                                      (From sag In raw_account_groups _
                                                                       Where sag.parent_id = p.id _
                                                                       Select sag).ToList()

        parents.ForEach(Function(p) p.sub_account_groups = sql_func(p))

        Return parents
    End Function 
```

该行`parents.ForEach(Function(p) p.sub_account_groups = sql_func(p))`有此错误...

> 未为类型“System.Collections.Generic.IList(Of st.data.AccountGroup)”和“System.Collections.Generic.List(Of st.data.AccountGroup)”定义运算符“=”。

但我真的看不出它与 Rob Connery 的这段代码有什么不同

```
public IList<Category> GetCategories() {
    IList<Category> rawCategories = _repository.GetCategories().ToList();                 
    var parents = (from c in rawCategories 
        where c.ParentID == 0
        select c).ToList();
     parents.ForEach(p =>
    {
        p.SubCategories = (from subs in rawCategories
        where subs.ParentID == p.ID
        select subs).ToList();
    });

    return parents; 
} 
```

编译完美......我做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T13:00:06.853

VB.Net 中的 Lambda 必须返回一个值，因此您的等号 ('=') 被解释为比较（以便 lambda 返回一个布尔值），而不是赋值。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-21T13:06:00.023

根据您的代码，此处接受的答案可能是错误的。chyne 给出了正确的线索：VB 中的 lambdas 总是有返回值（与 C# 不同），但在下一个版本中引入了语句 lambdas。

同时，您根本无法在 VB 中使用此代码。改用常规循环：

```
For Each p In parents
    p.sub_account_groups = sql_func(p)
Next 
```

VB 的下一个版本（从昨天开始作为 Beta 版提供）将允许编写以下代码：

```
parents.ForEach(Sub (p) p.sub_account_groups = sql_func(p)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T02:09:44.750

自从迁移到 C# 3.0 后，我就没有使用过 VB.NET，但这似乎是一个类型推断问题。这个错误有点奇怪，因为 List 实现了 IList，所以分配应该可以工作。您可以为 lambda 说“p.ID = 123”，一切似乎都有效。

对于其他有兴趣研究它的人，您可以将以下代码粘贴到新的 VB.NET 控制台项目中以演示此问题：

```
Module Module1
    Sub Main()
    End Sub
End Module

Class AccountGroup
    Public parent_id As Integer
    Public id As Integer
    Public sub_account_groups As List(Of AccountGroup)
End Class
Class AccountRepository
    Private _repository As AccountRepository

    Public Function GetAccountGroups() As IList(Of AccountGroup)
        Dim raw_account_groups As IList(Of AccountGroup)
        raw_account_groups = _repository.GetAccountGroups().ToList()
        Dim parents = (From ag In raw_account_groups _
                       Where ag.parent_id = 0 _
                       Select ag).ToList()
        parents(0).sub_account_groups = (From sag In raw_account_groups _
                                         Where sag.parent_id = 0 _
                                         Select sag).ToList()

        Dim sql_func As Func(Of AccountGroup, List(Of AccountGroup)) = Function(p) _
                                                                            (From sag In raw_account_groups _
                                                                             Where sag.parent_id = p.id _
                                                                             Select sag).ToList()

        parents.ForEach(Function(p) p.sub_account_groups = sql_func(p))
        Return parents
    End Function
 End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T11:22:01.497

我猜`ag.parent_id = 0`应该在哪里`ag.parent_id == 0`？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-23T17:58:59.487

使用 Sub 作为赋值运算符：

```
parents.ForEach(Sub(p) p.sub_account_groups = sql_func(p)) 
```

# c# - 将数据从一个 DataTable 复制到另一个

> ID：67929
> 
> 赞同：5
> 
> 时间：2008-09-15T23:27:30.520
> 
> 标签：c#, ado.net

将几千行数据从一个 DataTable 传输到另一个 DataTable 的最快方法是什么？很高兴看到一些示例代码片段。

编辑：我需要解释一下。复制行有一个过滤条件。因此，普通的 Copy() 将不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-15T23:39:22.083

您不能复制整个表格，您需要复制一行。来自[http://support.microsoft.com/kb/308909](http://support.microsoft.com/kb/308909)（如果您点击链接，则为示例代码）

《如何在DataTables之间复制DataRows 在使用ImportRow方法之前，必须确保目标表与源表结构一致。本示例使用DataTable类的Clone方法复制DataTable的结构，包括所有DataTable模式、关系和约束。

此示例使用 Microsoft SQL Server Northwind 数据库中包含的 Products 表。前五行从 Products 表复制到另一个在内存中创建的表中。”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T23:29:41.437

[DataTable.Copy](http://msdn.microsoft.com/en-us/library/system.data.datatable.copy.aspx)有什么问题？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T23:47:57.477

将行复制到表中会向我抛出一些标志。我以前见过人们尝试过这个，在每种情况下，他们真正想要的是[System.Data.DataView](https://docs.microsoft.com/en-us/dotnet/api/system.data.datatable.copy)。您确实应该检查[RowFilter](https://docs.microsoft.com/en-us/dotnet/api/system.data.dataview.rowfilter)属性是否会执行您需要它执行的操作。

# c# - 如何在 C# 中导入原始 RSS 提要？

> ID：67937
> 
> 赞同：2
> 
> 时间：2008-09-15T23:28:56.943
> 
> 标签：c#, xml, wcf, rss, import

有谁知道将原始 XML RSS 提要导入 C# 的简单方法？我正在寻找一种将 XML 作为字符串获取的简单方法，以便我可以使用正则表达式对其进行解析。

谢谢，-格雷格

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-15T23:44:50.870

这应该足以让你继续......

```
using System.Net 

WebClient wc = new WebClient();

Stream st = wc.OpenRead(“http://example.com/feed.rss”);

using (StreamReader sr = new StreamReader(st)) {
   string rss = sr.ReadToEnd();
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-15T23:32:38.323

如果您使用的是 .NET 3.5，那么您现在可以获得对联合提要（RSS 和 ATOM）的内置支持。查看这篇[MSDN 杂志文章以获得很好的介绍](http://msdn.microsoft.com/en-us/magazine/cc135976.aspx)。

如果您真的想使用正则表达式解析字符串（并且解析 XML 不是正则表达式的用途），获取内容的最简单方法是使用 WebClient 类。它有一个可以直接使用的下载字符串。只需给它您的提要的 URL。查看此[链接以获取有关如何使用它的示例](http://www.daveamenta.com/2008-05/c-webclient-usage/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T07:16:49.790

你想达到什么目的？

我发现[System.ServiceModel.Syndication](https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.syndication.syndicationfeed)类在处理提要时非常有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T23:51:19.357

我会将提要加载到 XmlDocument 中并使用 XPATH 而不是正则表达式，如下所示：

```
XmlDocument doc = new XmlDocument();

HttpWebRequest request = WebRequest.Create(feedUrl) as HttpWebRequest;

using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
{
    StreamReader reader = new StreamReader(response.GetResponseStream());
    doc.Load(reader);

    <parse with XPATH>
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T23:31:02.463

XmlDocument（位于 System.Xml 中，如果没有为您添加，则需要添加对 dll 的引用）是用于将 xml 导入 C# 的内容。此时，只需调用以字符串格式提供内部 Xml 的 InnerXml 属性，然后使用正则表达式进行解析。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T23:31:02.603

您可能想看看这个： http: [//www.codeproject.com/KB/cs/rssframework.aspx](http://www.codeproject.com/KB/cs/rssframework.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T23:40:28.570

获取 RSS 提要作为请求字符串的最佳方法是使用 System.Net.HttpWebRequest 类。设置 HttpWebRequest 的参数（URL 等）后，调用 HttpWebRequest.GetResponse() 方法。从那里，您可以使用 WebResponse.GetResponseStream() 获取流。然后，您可以将该流包装在 System.IO.StreamReader 中，并调用 StreamReader.ReadToEnd()。瞧。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-26T13:45:24.067

The RSS is just xml and can be streamed to disk easily. Go with Darrel's example - it's all you'll need.

# c# - .NET XML 序列化问题？

> ID：67959
> 
> 赞同：121
> 
> 时间：2008-09-15T23:35:14.853
> 
> 标签：c#, xml-serialization

在进行 C# XML 序列化时，我遇到了一些我认为我会分享的问题：

*   您不能序列化只读项目（如 KeyValuePairs）
*   您不能序列化通用字典。相反，试试这个包装类（来自[http://weblogs.asp.net/pwelter34/archive/2006/05/03/444961.aspx](http://weblogs.asp.net/pwelter34/archive/2006/05/03/444961.aspx)）：

* * *

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Xml.Serialization;

[XmlRoot("dictionary")]
public class SerializableDictionary<TKey, TValue> : Dictionary<TKey, TValue>, IXmlSerializable
{      
    public System.Xml.Schema.XmlSchema GetSchema()
    {
        return null;
    }

    public void ReadXml(System.Xml.XmlReader reader)
    {
        XmlSerializer keySerializer = new XmlSerializer(typeof(TKey));
        XmlSerializer valueSerializer = new XmlSerializer(typeof(TValue));

        bool wasEmpty = reader.IsEmptyElement;
        reader.Read();

        if (wasEmpty)
            return;

        while (reader.NodeType != System.Xml.XmlNodeType.EndElement)
        {
            reader.ReadStartElement("item");

            reader.ReadStartElement("key");
            TKey key = (TKey)keySerializer.Deserialize(reader);
            reader.ReadEndElement();

            reader.ReadStartElement("value");
            TValue value = (TValue)valueSerializer.Deserialize(reader);
            reader.ReadEndElement();

            this.Add(key, value);

            reader.ReadEndElement();
            reader.MoveToContent();
        }
        reader.ReadEndElement();
    }

    public void WriteXml(System.Xml.XmlWriter writer)
    {
        XmlSerializer keySerializer = new XmlSerializer(typeof(TKey));
        XmlSerializer valueSerializer = new XmlSerializer(typeof(TValue));

        foreach (TKey key in this.Keys)
        {
            writer.WriteStartElement("item");

            writer.WriteStartElement("key");
            keySerializer.Serialize(writer, key);
            writer.WriteEndElement();

            writer.WriteStartElement("value");
            TValue value = this[key];
            valueSerializer.Serialize(writer, value);
            writer.WriteEndElement();

            writer.WriteEndElement();
        }
    }
} 
```

还有其他 XML 序列化问题吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-18T21:52:50.893

另一个大问题：当通过网页 (ASP.NET) 输出 XML 时，您不想包含[Unicode Byte-Order Mark](http://en.wikipedia.org/wiki/UTF-8#Byte_order_mark)。当然，使用或不使用 BOM 的方式几乎相同：

### 坏（包括 BOM）：

```
XmlTextWriter wr = new XmlTextWriter(stream, new System.Text.Encoding.UTF8); 
```

### 好的：

```
XmlTextWriter  wr = new XmlTextWriter(stream, new System.Text.UTF8Encoding(false)) 
```

您可以显式传递 false 以指示您不需要 BOM。`Encoding.UTF8`注意和之间的明显区别`UTF8Encoding`。

开头的三个额外 BOM 字节是 (0xEFBBBF) 或 (239 187 191)。

参考：[http ://chrislaco.com/blog/troubleshooting-common-problems-with-the-xmlserializer/](http://chrislaco.com/blog/troubleshooting-common-problems-with-the-xmlserializer/)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-16T00:25:16.840

我还不能发表评论，所以我将对 Dr8k 的帖子发表评论并进行另一次观察。公开为公共 getter/setter 属性的私有变量，并通过这些属性进行序列化/反序列化。我们一直在我以前的工作中这样做。

不过要注意的一件事是，如果您在这些属性中有任何逻辑，那么逻辑就会运行，所以有时，序列化的顺序实际上很重要。成员按它们在代码中的顺序*隐式*排序，但不能保证，尤其是当您继承另一个对象时。明确订购它们是一种痛苦。

过去我被这件事烧死了。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-05T21:50:57.847

从内存流序列化为 XML 字符串时，请务必使用 MemoryStream#ToArray() 而不是 MemoryStream#GetBuffer() 否则您将得到无法正确反序列化的垃圾字符（因为分配了额外的缓冲区）。

[http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer(VS.80).aspx)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-08-02T12:00:36.770

如果序列化程序遇到具有接口作为其类型的成员/属性，它将不会序列化。例如，以下内容不会序列化为 XML：

```
public class ValuePair
{
    public ICompareable Value1 { get; set; }
    public ICompareable Value2 { get; set; }
} 
```

虽然这将序列化：

```
public class ValuePair
{
    public object Value1 { get; set; }
    public object Value2 { get; set; }
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-16T01:16:08.013

`IEnumerables<T>`通过 yield return 生成的是不可序列化的。这是因为编译器生成了一个单独的类来实现 yield return，并且该类没有被标记为可序列化。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-29T23:21:39.387

您不能序列化只读属性。即使您从未打算使用反序列化将 XML 转换为对象，您也必须有一个 getter 和一个 setter。

出于同样的原因，您不能序列化返回接口的属性：反序列化器不知道要实例化哪个具体类。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-15T23:46:11.770

哦，这是一个很好的选择：由于 XML 序列化代码是生成并放置在单独的 DLL 中的，因此当您的代码中出现破坏序列化程序的错误时，您不会收到任何有意义的错误。就像“无法找到 s3d3fsdf.dll”之类的东西。好的。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-02-16T08:26:20.887

无法序列化没有无参数构造函数的对象（只是被那个构造函数咬了）。

出于某种原因，从以下属性中，Value 被序列化，但不是 FullName：

```
 public string FullName { get; set; }
    public double Value { get; set; } 
```

我从来没有弄清楚为什么，我只是将 Value 更改为 internal ...

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-12-24T17:02:51.393

还有一点需要注意：如果您使用“默认”XML 序列化，则不能序列化私有/受保护的类成员。

但是您可以在您的类中指定实现 IXmlSerializable 的自定义 XML 序列化逻辑，并序列化您需要/想要的任何私有字段。

[http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-03-18T17:24:00.547

If you try to serialize an array, `List<T>`, or `IEnumerable<T>` which contains instances of *subclasses* of `T`, you need to use the [XmlArrayItemAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayitemattribute%28VS.71%29.aspx) to list all the subtypes being used. Otherwise you will get an unhelpful `System.InvalidOperationException` at runtime when you serialize.

Here is part of a full example from [the documentation](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayitemattribute%28VS.71%29.aspx)

```
public class Group
{  
   /* The XmlArrayItemAttribute allows the XmlSerializer to insert both the base 
      type (Employee) and derived type (Manager) into serialized arrays. */

   [XmlArrayItem(typeof(Manager)), XmlArrayItem(typeof(Employee))]
   public Employee[] Employees; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-16T03:05:23.493

如果您的 XML 序列化生成的程序集与尝试使用它的代码不在同一个加载上下文中，您将遇到可怕的错误，例如：

```
System.InvalidOperationException: There was an error generating the XML document.
---System.InvalidCastException: Unable to cast object
of type 'MyNamespace.Settings' to type 'MyNamespace.Settings'. at
Microsoft.Xml.Serialization.GeneratedAssembly.
  XmlSerializationWriterSettings.Write3_Settings(Object o) 
```

对我来说，造成这种情况的原因是使用[LoadFrom 上下文](http://msdn.microsoft.com/en-us/library/1009fa28(VS.80).aspx#remarksToggle "Assembly.LoadFrom 方法")加载的插件，它与使用 Load 上下文相比有很多缺点。跟踪那个很有趣。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-12-19T10:09:16.930

您可能会在序列化 Color 和/或 Font 类型的对象时遇到问题。

以下是对我有帮助的建议：

[http://www.codeproject.com/KB/XML/xmlsettings.aspx](http://www.codeproject.com/KB/XML/xmlsettings.aspx)

[http://www.codeproject.com/KB/cs/GenericXmlSerializition.aspx](http://www.codeproject.com/KB/cs/GenericXmlSerializition.aspx)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2011-06-15T14:03:07.837

请参阅“[高级 XML 模式定义语言属性绑定支持](http://msdn.microsoft.com/en-us/library/bb885287.aspx)”以了解有关 XML 序列化程序支持的内容的详细信息，以及有关支持的 XSD 功能的方式的详细信息。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-15T23:42:50.327

私有变量/属性在 XML 序列化的默认机制中没有序列化，而是在二进制序列化中。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-08-29T21:18:27.670

标有该`Obsolete`属性的属性未序列化。我没有测试过`Deprecated`属性，但我认为它会以相同的方式运行。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-26T11:22:23.877

如果您的 XSD 使用替换组，那么您可能无法自动（反）序列化它。您需要编写自己的序列化程序来处理这种情况。

例如。

```
<xs:complexType name="MessageType" abstract="true">
    <xs:attributeGroup ref="commonMessageAttributes"/>
</xs:complexType>

<xs:element name="Message" type="MessageType"/>

<xs:element name="Envelope">
    <xs:complexType mixed="false">
        <xs:complexContent mixed="false">
            <xs:element ref="Message" minOccurs="0" maxOccurs="unbounded"/>
        </xs:complexContent>
    </xs:complexType>
</xs:element>

<xs:element name="ExampleMessageA" substitutionGroup="Message">
    <xs:complexType mixed="false">
        <xs:complexContent mixed="false">
                <xs:attribute name="messageCode"/>
        </xs:complexContent>
    </xs:complexType>
</xs:element>

<xs:element name="ExampleMessageB" substitutionGroup="Message">
    <xs:complexType mixed="false">
        <xs:complexContent mixed="false">
                <xs:attribute name="messageCode"/>
        </xs:complexContent>
    </xs:complexType>
</xs:element> 
```

在此示例中，信封可以包含消息。但是，.NET 的默认序列化程序不区分 Message、ExampleMessageA 和 ExampleMessageB。它只会在基本 Message 类之间进行序列化。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-26T11:28:03.300

在没有显式序列化的情况下小心序列化类型，它可能会在 .Net 构建它们时导致延迟。我最近[在序列化 RSAParameters 时](https://stackoverflow.com/questions/12135/filenotfoundexception-for-mscorlibxmlserializersdll-which-doesnt-exist)发现了这一点。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-26T10:55:54.453

我无法真正解释这一点，但我发现这不会连载：

```
[XmlElement("item")]
public myClass[] item
{
    get { return this.privateList.ToArray(); }
} 
```

但这将：

```
[XmlElement("item")]
public List<myClass> item
{
    get { return this.privateList; }
} 
```

还值得注意的是，如果您要序列化到 memstream，您可能希望在使用它之前寻求 0。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-15T23:55:28.627

> 私有变量/属性不是在 XML 序列化中序列化，而是在二进制序列化中。

如果您通过公共属性公开私有成员，我相信这也会让您受益 - 私有成员不会被序列化，因此公共成员都引用空值。

# java - 如何在 Spring 中注册自定义类型转换器？

> ID：67980
> 
> 赞同：5
> 
> 时间：2008-09-15T23:38:35.207
> 
> 标签：java, spring

我需要通过 http 请求参数传递一个 UUID 实例。Spring 需要注册一个自定义类型转换器（来自 String）。我如何注册一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T04:07:28.630

I have an MVC controller with RequestMapping annotations. One method has a parameter of type UUID. Thanks toolkit, after reading about [WebDataBinder](http://static.springframework.org/spring/docs/2.5.5/reference/mvc.html#mvc-ann-webdatabinder), I figured that I need a method like this in my controller:

```
@InitBinder
public void initBinder(WebDataBinder binder) {
    binder.registerCustomEditor(UUID.class, new UUIDEditor());
} 
```

UUIDEditor simply extends PropertyEditorSupport and overrides getAsText() and setAsText().

Worked for me nicely.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-16T01:11:30.927

请在此处查看弹簧参考手册的第 5 章：[5.4.2.1。注册额外的自定义 PropertyEditor](http://static.springframework.org/spring/docs/2.5.x/reference/validation.html#beans-beans-conversion-customeditor-registration)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-12T15:02:22.607

扩展上一个示例。

控制器类

```
@Controller
@RequestMapping("/showuuid.html")
public class ShowUUIDController
{

  @InitBinder
  public void initBinder(WebDataBinder binder)
  {
    binder.registerCustomEditor(UUID.class, new UUIDEditor());
  }

  public String showuuidHandler (@RequestParam("id") UUID id, Model model)
  {
    model.addAttribute ("id", id) ;
    return "showuuid" ;
  }
} 
```

财产拆迁者

```
class UUIDEditor extends java.beans.PropertyEditorSupport
{

  @Override
  public String getAsText ()
  {
    UUID u = (UUID) getValue () ;
    return u.toString () ;
  }

  @Override
  public void setAsText (String s)
  {
    setValue (UUID.fromString (s)) ;
  }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T23:50:48.483

不知道你在问什么？

Spring 带有一个[CustomEditorConfigurer](http://static.springframework.org/spring/docs/2.5.5/api/org/springframework/beans/factory/config/CustomEditorConfigurer.html)来提供自定义 String <-> Object 转换器。

要使用它，只需将 CustomEditorConfigurer 作为 bean 添加到您的配置中，然后添加自定义转换器。但是，这些转换器通常在将配置文件中的字符串属性转换为真实对象时使用。

如果您使用的是 Spring MVC，请查看[注释 MVC部分](http://static.springframework.org/spring/docs/2.5.5/reference/mvc.html#mvc-annotation)

具体来说，看看**@RequestParam**和**@ModelAttribute**注释？

希望这可以帮助？*****