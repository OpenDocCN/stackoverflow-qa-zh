# StackOverflow 问答 12414000-12414999

# linux - /var/www/html 的权限

> ID：12414009
> 
> 赞同：40
> 
> 时间：2012-09-13T20:07:48.663
> 
> 标签：linux, apache, permissions, sftp

我有一个带有 GoDaddy 的虚拟 CentOS 服务器，但在设置`/var/www/html`.

不允许用户登录`root`，甚至不能将自己添加到`root`组中，所以这是我自己画的角落：

*   我使用以下命令更改了它的所有者（我使用了 中的用户：组`httpd.conf`）：

    ```
    chown -R apache:apache /var/www/html 
    ```

*   我将自己的用户添加到`apache`组中：

    ```
    usermod -a -G apache myuser 
    ```

*   我更改了权限：

    ```
    chmod 777 /var/www/html -R 
    ```

这是让我的 SFTP 帐户能够创建、更改*和*删除`/var/www/html`. 777！（SFTP 帐户使用与 ssh 帐户相同的凭据，这意味着它们在所有意图和目的上都是相同的，对吗？）

我显然是 Linux 服务器管理员的新手，但这似乎非常不安全。有没有更好的方法来完成这一切？

**注意**我计划在此处放置的网站将允许文件上传、cron 作业等，所以我猜这也会使必要的权限复杂化。那是对的吗？

**使用 775更新**似乎不起作用；我可以上传/覆盖文件，但是当我尝试删除它们时，FileZilla 给了我这个错误：

> rm /var/www/html/index.php：权限被拒绝

我不知道为什么，但改回 777 “修复”了这个。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-13T20:12:08.527

只要您以 myuser 身份登录，您就需要`775`。`/var/www/html`中间的`7`八进制（用于“组”acl）确保组具有读/写/执行权限。只要您属于拥有这些文件的组，“myuser”就应该能够写入它们。但是，您可能需要为文档根目录中的所有文件授予组权限：

```
chmod -R g+w /var/www/html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T20:25:02.050

关于在 apache 网站托管目录上设置 777 权限，我刚刚处于类似的位置。经过一些修补后，似乎将文件夹的组所有权更改为“apache”组允许基于用户组访问文件夹。

1）确保文件夹的组所有权设置为组apache used/generates for use。（检查 /etc/groups，我的是 Ubuntu 上的 www-data）

2) 将文件夹权限设置为 774 以阻止“每个人”拥有任何更改访问权限，但允许所需的所有者和组权限。

3）将您的用户帐户添加到对该文件夹具有权限的组（我的是 www-data）。

* * *

## 回答 #3

> 赞同：-31
> 
> 时间：2014-09-13T15:15:54.327

以 root 用户身份登录：

```
sudo su

password: 
```

然后去 var/www 做你想做的事

# c - 编译器优化不编译常量？

> ID：12414012
> 
> 赞同：2
> 
> 时间：2012-09-13T20:08:07.857
> 
> 标签：c, gcc, arm, ld

我在我的代码中将以下字符串声明为常量。目的是提供一种在编译输出中存储简单元数据的粗略而简单的方法。

```
const char myString1[] ="abc123\0";
const char myString2[] = {'a','b','c','1','2','3','\0'}; 
```

当我使用十六进制编辑器检查输出时，我看到了其他字符串常量，但没有出现“abc123”。这使我相信启用的优化会导致无法编译这些行，因为它们从未在程序中被引用。

有没有办法在代码中强制编译，或者用另一种方式（在代码中）将此元数据放入二进制文件中？我不想对二进制后编译进行任何操作，目标是使其尽可能简单。

**编译器标志**

`-O2 -g -Wall -c -fmessage-length=0 -fno-builtin -ffunction-sections -mcpu=cortex-m3 -mthumb`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:20:16.030

我认为您正在寻找以下`used`属性：

> '使用'
> 
> > 附加到变量的此属性意味着即使看起来未引用该变量，也必须发出该变量。
> > 
> > 当应用于 C++ 类模板的静态数据成员时，该属性还意味着如果类本身被实例化，则该成员将被实例化。

像这样应用

```
__attribute__((used))
const char myString1[] ="abc123\0";
__attribute__((used))
const char myString2[] = {'a','b','c','1','2','3','\0'}; 
```

鉴于您发布的编译器标志，它几乎可以肯定是链接器。该`-ffunction-sections`标志将每个定义放入目标文件中自己的部分。这允许链接器轻松确定未引用数据项或函数并将其从最终二进制文件中省略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:10:47.203

使用 binutils`strings`命令查看这些字符串是否存在于您的二进制文件中。

如果它们已被优化，您可以在声明它们时尝试使用`volatile`限定符。请注意，如果即使使用`volatile`限定符也不使用它们，某些编译器仍然可以优化它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T22:25:37.893

我想出了一个使用属性并涉及修改链接脚本的解决方案。

首先，我定义了一个名为“.metadata”的自定义部分。

```
__attribute__ ((section(".metadata"))) 
```

然后，在`SECTIONS`.ld 脚本的块中，我添加了一个即使不使用`KEEP(*(.metadata))`它也会强制链接器包含`.metadata`

```
.text :
{
    KEEP(*(.isr_vector))
    KEEP(*(.metadata))
    *(.text*)
    *(.rodata*)

} > MFlash32 
```

**笔记**

我发现`__attribute__`关键字必须与变量位于同一行，否则它实际上不会出现在二进制文件中，尽管 .metadata 部分确实出现在内存映射中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T21:05:25.287

如果你在文件范围内有这些变量，编译器*必须*提供字符串，因为他不知道它们是否会被不同的编译单元使用。因此，放置这些变量的任何“.o”文件都必须包含该字符串。

现在，一个聪明的链接器可以决定最终二进制文件不需要这些常量。（不过，我从未观察到。）如果您的平台是这种情况，您应该在“假设”路径上使用变量，实际上程序永远不会采用该变量。就像是

```
int main(int argc, char*argv[]){
  switch (argv[0][0]) {
    case 1: return myString1[argv[0][1]];
    case 2: return myString2[argv[0][1]];
  }
  ...
} 
```

# c# - Silverlight 5 通过 ssl 连接到 WCF 服务

> ID：12414015
> 
> 赞同：2
> 
> 时间：2012-09-13T20:08:33.053
> 
> 标签：c#, silverlight, windows-services, wcf-client

我正在开发一个 Silverlight 5 项目，并且正在构建一个通过 SSL 连接到 WCF 服务的应用程序。当我通过 HTTP 连接时，这似乎在浏览器和浏览器外都有效。现在我已经实现了 SSL，它只适用于浏览器。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T16:13:21.403

如果没有任何其他详细信息，很难猜测出了什么问题，但我最好的猜测是您使用的证书不受 Windows 信任，而受浏览器信任。您是否使用了一些您导入浏览器的自签名证书？如果你是，你也应该导入到 Windows 证书存储中。

在浏览器中运行时，Silverlight 将通过浏览器执行所有 http(s) 调用，因此将由浏览器决定证书是否受信任。在浏览器之外，使用内置的 http 堆栈，而后者又使用 Windows 的 CA 列表。

您可以通过将这些行添加到 App.xaml.cs 中的 Application_Startup() 来强制 Silverlight 使用某个 http 堆栈：

```
 WebRequest.RegisterPrefix("http://", System.Net.Browser.WebRequestCreator.BrowserHttp);
 WebRequest.RegisterPrefix("https://", System.Net.Browser.WebRequestCreator.BrowserHttp); 
```

这将使您的应用程序在运行 Out of Browser 时使用 IE 堆栈。即使在浏览器中运行，您也可以执行相反的操作并使用内置的 http 堆栈：

```
 WebRequest.RegisterPrefix("http://", System.Net.Browser.WebRequestCreator.ClientHttp);
 WebRequest.RegisterPrefix("https://", System.Net.Browser.WebRequestCreator.ClientHttp); 
```

# html - CSS line-height 属性大于 font-size 属性

> ID：12414018
> 
> 赞同：2
> 
> 时间：2012-09-13T20:08:40.837
> 
> 标签：html, styles, css, text-size

我有一个非常烦人的问题，我想将图像的顶部与文本对齐，但字母实际上略低于行高。

我用经典电影创建了简单的示例来说明下面的问题。

HTML：

```
<img src="http://cf2.imgobject.com/t/p/w92/wcI3VMHw2TqtPVIkS4wpmxBJzWB.jpg" />
<p>Big</p>
<p>Admin</p> 
```

CSS：

```
p, h4{
    font-size:1em;
    line-height:1em;
    vertical-align:top;
    margin:0;
    padding:0;
    font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
}

img{
    float:left;
    width:46px;
} 
```

输出（在 Chrome 中）：

![](../Images/8f6eadfdf00e51d104096cbd31f17f9f.png)

正如您所看到的，当行高与图像顶部对齐时，文本本身不是。我已经尝试了所有垂直对齐选项，但没有修复。

为什么行高大于字体大小，即使它们都设置为相同的尺寸？如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T20:42:59.160

这通常与排版有关，而不是 CSS。有许多垂直指南会影响字体设计。我假设您希望[上限高度](http://en.wikipedia.org/wiki/Cap_height)与图像顶部相匹配。

我在这里将您的示例添加到 jsfiddle：http: [//jsfiddle.net/ahXpH/1/](http://jsfiddle.net/ahXpH/1/)并复制了它。如果放大，您可以看到“Big”中的“i”实际上比 B 高，而“g”超出了段落本身的范围。检查 Chrome 中的元素会发现`line-height`and`font-size`匹配。

为了解决这个问题，您必须调整`margin-top`并在视觉上对齐它。对于我的 jsfiddle 版本，这恰好`margin-top: -8px;`是`font-family: "Trebuchet MS"`and `font-size:48px`。( [http://jsfiddle.net/ahXpH/4/](http://jsfiddle.net/ahXpH/4/) ) 但是，如果您删除“Trebuchet MS”并使用 Arial 的后备前端，您会看到它不再排列并且现在是图像上方的一个像素。

最终，我不确定是否有纯 CSS 解决方案。硬编码该值仅适用于一种字体，甚至可能因浏览器而异。

# php-extension - 如何在 Phalcon PHP 内部设置一个新类？

> ID：12414019
> 
> 赞同：3
> 
> 时间：2012-09-13T20:08:40.667
> 
> 标签：php-extension, phalcon

我决定通过制作一个简单的验证器来深入了解 Phalcon 的内部结构。我几乎一字不差地遵循了其他验证器的定义。这就是我在 phalcon.c 和 phalcon.h 中的内容：

```
phalcon.c:
zend_class_entry *phalcon_mvc_model_validator_stringlength_ce;
...
PHALCON_REGISTER_CLASS_EX(Phalcon\\Mvc\\Model\\Validator, StringLength, mvc_model_validator_stringlength, "phalcon\\mvc\\model\\validator", phalcon_mvc_model_validator_stringlength_method_entry, 0);

phalcon.h:
extern zend_class_entry *phalcon_mvc_model_validator_stringlength_ce;
...
ZEND_BEGIN_ARG_INFO_EX(arginfo_phalcon_mvc_model_validator_stringlength_validate, 0, 0, 1)
    ZEND_ARG_INFO(0, record)
ZEND_END_ARG_INFO()
...
PHALCON_INIT_FUNCS(phalcon_mvc_model_validator_stringlength_method_entry){
    PHP_ME(Phalcon_Mvc_Model_Validator_StringLength, validate, arginfo_phalcon_mvc_model_validator_stringlength_validate, ZEND_ACC_PUBLIC)
    PHP_FE_END
}; 
```

在运行时，我收到以下警告：

```
PHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib/php5/20090626/phalcon.so' - /usr/lib/php5/20090626/phalcon.so: undefined symbol: zim_Phalcon_Mvc_Model_Validator_StringLength_validate in Unknown on line 0 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:14:36.207

还需要将方法（函数）原型添加到 phalcon.h：

[https://github.com/phalcon/cphalcon/blob/master/dev/phalcon.h#L391](https://github.com/phalcon/cphalcon/blob/master/dev/phalcon.h#L391)

将您的 .c 文件添加到 config.m4（如果您在 Unix/Linux 平台上）：

[https://github.com/phalcon/cphalcon/blob/master/dev/config.m4#L5](https://github.com/phalcon/cphalcon/blob/master/dev/config.m4#L5)

之后，需要进行完整的重新编译：

```
phpize --clean
export CFLAGS="-g -O2 -fno-delete-null-pointer-checks"
phpize
./configure --enable-phalcon
make
sudo make install 
```

# asp.net - 使用 XPath 显示 XML

> ID：12414020
> 
> 赞同：0
> 
> 时间：2012-09-13T20:08:44.613
> 
> 标签：asp.net, xml, xpath

我刚开始使用 XML，我有一个表单，用户在其中添加一些信息，并保存到 XML 中，这是执行此操作的代码，它工作正常：

```
 <%@ Page Language="C#" AutoEventWireup="true"CodeBehind="DatosFinancieros.aspx.cs"
Inherits="Tablero.DatosFinancieros" %>

    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<%@ Import Namespace="System.Xml" %>
<script runat="server">
protected void btnSave_Click(object sender, EventArgs e)
{
    string xmlPath = MapPath("Datos/DatosFinancieros.xml");
    XmlDocument doc = new XmlDocument();
    //Check if the file already exists or not
    if (System.IO.File.Exists(xmlPath))
    {
        doc.Load(xmlPath);
        XmlNode DatosNodo = CreateDatosNodo(doc);
        //Get reference to the Datos node and append the Datos node to it
        XmlNode DatosFinancierosNodo = doc.SelectSingleNode("DatosFinancieros");
        DatosFinancierosNodo.AppendChild(DatosNodo);
        lblResult.Text = "El documento ha sido actualizado";
    }
    else
    {            
        XmlNode declarationNode = doc.CreateXmlDeclaration("1.0", "", "");
        doc.AppendChild(declarationNode);
        XmlNode comment = doc.CreateComment("Este archivo representa un fragmento de lo almacenado");
        doc.AppendChild(comment);            
        XmlNode DatosFinancierosNodo = doc.CreateElement("DatosFinancieros");
        XmlNode DatosNodo = CreateDatosNodo(doc);                        
        //Append the datos node to the DatosFinancieros node            
        DatosFinancierosNodo.AppendChild(DatosNodo);
        //Append the DatosFinancieros node to the document
        doc.AppendChild(DatosFinancierosNodo);
        lblResult.Text = "El documento ha sido creado";
    }
    doc.Save(xmlPath);
}
XmlNode CreateDatosNodo(XmlDocument doc)
{
XmlNode datosNodo = doc.CreateElement("Datos");
// Add Neta Mensual attribute to the Datos Node
XmlAttribute NetaMensualAttribute = doc.CreateAttribute("NetaMensual");
NetaMensualAttribute.Value = txtNetaMensual.Text;
datosNodo.Attributes.Append(NetaMensualAttribute);

XmlAttribute NetaAcumuladoAttribute = doc.CreateAttribute("NetaAcumulado");
NetaAcumuladoAttribute.Value = txtNetaAcumulado.Text;
datosNodo.Attributes.Append(NetaAcumuladoAttribute);

XmlAttribute MensualAttribute = doc.CreateAttribute("Mensual");
MensualAttribute.Value = txtMensual.Text;
datosNodo.Attributes.Append(MensualAttribute);

XmlAttribute AcumuladoAttribute = doc.CreateAttribute("Acumulado");
AcumuladoAttribute.Value = txtAcumulado.Text;
datosNodo.Attributes.Append(AcumuladoAttribute);

XmlAttribute LiquidezAttribute = doc.CreateAttribute("Liquidez");
LiquidezAttribute.Value = txtLiquidez.Text;
datosNodo.Attributes.Append(LiquidezAttribute);

XmlAttribute AccionMensualAttribute = doc.CreateAttribute("AccionMensual");
AccionMensualAttribute.Value = TextAccionMensual.Text;
datosNodo.Attributes.Append(AccionMensualAttribute);

XmlAttribute AccionAcumuladaAttribute = doc.CreateAttribute("AccionAcumulada");
AccionAcumuladaAttribute.Value = TextAccionAcumulada.Text;
datosNodo.Attributes.Append(AccionAcumuladaAttribute);

return datosNodo;
}

</script>
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title></title>
</head>
<body>
<form id="form1" runat="server">
<div>
    <table>
        <tr>
            <td colspan="2" style="width: 200px; height: 40px">
                <b style="font-size: x-large">Datos Financieros</b>
            </td>
        </tr>
        <tr>
            <td colspan="2" style="width: 174px; height: 40px">
                <b>Utilidad Neta/Capital</b>
            </td>
        </tr>
        <tr>
            <td style="width: 101px; height: 44px">
                Mensual:
            </td>
            <td style="width: 204px; height: 44px">
                <asp:TextBox ID="txtNetaMensual" runat="server" Width="201px"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td style="width: 101px; height: 44px">
                Acumulado:
            </td>
            <td style="width: 204px; height: 44px">
                <asp:TextBox ID="txtNetaAcumulado" runat="server" Width="201px"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td colspan="2" style="width: 174px; height: 40px">
                <b>Utilidad Neta/Ventas</b>
            </td>
        </tr>
        <tr>
            <td style="width: 101px; height: 41px">
                Mensual:
            </td>
            <td style="width: 204px; height: 41px">
                <asp:TextBox ID="txtMensual" runat="server" Width="201px"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td style="width: 101px; height: 41px">
                Acumulado:
            </td>
            <td style="width: 204px; height: 41px">
                <asp:TextBox ID="txtAcumulado" runat="server" Width="201px"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td style="width: 101px; height: 41px">
                Liquidez:
            </td>
            <td style="width: 204px; height: 41px">
                <asp:TextBox ID="txtLiquidez" runat="server" Width="201px"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td colspan="2" style="width: 174px; height: 40px">
                <b>Acción</b>
            </td>
        </tr>
        <tr>
            <td style="width: 101px; height: 41px">
                Mensual:
            </td>
            <td style="width: 204px; height: 41px">
                <asp:TextBox ID="TextAccionMensual" runat="server" Width="201px"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td style="width: 101px; height: 41px">
                Acumulada:
            </td>
            <td style="width: 204px; height: 41px">
                <asp:TextBox ID="TextAccionAcumulada" runat="server" Width="201px"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td colspan="2" style="width: 101px; height: 41px">
                <asp:Button Text="Guardar" runat="server" ID="btnSave" Width="95px" OnClick="btnSave_Click" />
            </td>
        </tr>
        <tr>
            <td colspan="2" style="width: 101px; height: 41px">
                <asp:Label Text="Guardar" runat="server" ID="lblResult" Width="295px" />
            </td>
        </tr>
    </table>
</div>
</form>
</body>
    </html> 
```

现在，我想在这个表单上显示该信息，我已经制作了这个，正在运行。没有给我任何错误，但没有显示任何内容，只是空白屏幕：

```
 <body>
<form id="form1" runat="server">
<div>
    <asp:XmlDataSource ID="XmlDataSource1" runat="server" XPath="datos" DataFile="Datos/DatosFinancieros.xml" />
    <asp:FormView ID="FormView1" runat="server" DataSourceID="XmlDataSource1">
        <ItemTemplate>
            <hr />
            <asp:Repeater ID="Repeater1" runat="server" DataSource='<%# XPathSelect("datos") %>'>
                <ItemTemplate>
                    Neto Mensual:
                    <%# XPath("NetaMensual") %>
                    <br />
                    Neta Acumulado:
                    <%# XPath("NetaAcumulado") %>
                    <br />
                    <hr />
                </ItemTemplate>
            </asp:Repeater>
        </ItemTemplate>
    </asp:FormView>
</div>
</form> 
```

任何人都知道我做错了什么，所以信息不显示？？？很抱歉，这篇文章很长，但为了更好地了解我在做什么！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:20:41.557

查看屏幕的源代码并查看 XML 是否出现。

如果确实出现了，那么问题在于 HTML 是 XML 的一种变体，浏览器将任何带有 XML 样式标签的东西解释为标记而不是信息。

您需要在 <%# %> 标记内对您的 XML 进行 HTML 编码。

```
<%# Server.HtmlEncode(XPath(xyz)) %> 
```

# linux - linux内核如何强制枚举PCI-e总线？

> ID：12414024
> 
> 赞同：24
> 
> 时间：2012-09-13T20:08:49.587
> 
> 标签：linux, configure, fpga, pci-e

Linux 内核 2.6

我有一个通过 GPIO 加载的 fpga，连接到运行 linux 的开发板。fpga 将通过 pci-express 总线发送和接收数据。但是，这是在启动时枚举的，因此没有发现任何链接（因为 fpga 未在启动时加载）。

如何在 linux 中强制重新枚举 pci-e 总线？是否有一个简单的命令或者我必须进行内核更改？我需要热插拔 pcie 设备的能力。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-14T11:38:01.410

以 root 身份尝试以下命令：

```
echo "1" > /sys/bus/pci/rescan 
```

有关更多信息，请参阅此链接：http: [//www.kernel.org/doc/Documentation/ABI/testing/sysfs-bus-pci](http://www.kernel.org/doc/Documentation/ABI/testing/sysfs-bus-pci)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-14T10:38:03.773

我想知道你在什么平台上：在 x86 系统上工作的解决方法（又名 hack）是让 BIOS 在任何总线、设备、FPGA 通常登陆的功能上基本上静态配置 PCI 设备，然后操作系统将枚举设备并为其保留 PCI 空间（即使该设备实际上并不存在）。然后在您的设备驱动程序中，您将不得不做一些额外的事情，例如在对 fpga 进行编程后手动设置 BAR 和 int 行。当然，这需要修改 BIOS，如果您与 BIOS 供应商合作，您可以与他们签订合同为您进行此更改，如果您不与 BIOS 供应商合作，那么这将更加困难......另外请记住我在 x86 上开发 VxWorks，我们有一个 AMI 为我们的主板定制 BIOS……

如果您没有 BIOS，则考虑在引导加载程序中对其进行编程，您已经具备从磁盘读取的能力，并且添加 GPIO 功能可能并不太难（假设您使用的是 jtag 和 GPIO？），在事实上，取决于您使用的引导加载程序，它可能已经能够执行 GPIO？

修改内核以执行此操作的问题是，您必须在 PCI 枚举之前找到可以读取位文件的最佳位置...如果例如磁盘设备驱动程序在 PCI 之后初始化，那么显然您必须做一些对内核进行彻底更改只是为了在 PCI 枚举之前读取位文件，这可能会导致其他烦人的问题......

您可能已经发现了另一个选项，它实际上只适用于开发时间：启动系统，对 fpga 板进行编程，然后进行重置（无需重新启动，例如：sudo reboot now），FPGA 应该保留它的配置，linux应该枚举它......

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-03T21:38:09.530

打开计算机后，BIOS 会枚举 PCI 总线并尝试满足所有 IO 空间和内存映射 IO (MMIO) 请求。它最初设置这些 BAR，当操作系统加载这些 BAR 时，操作系统可以在它认为合适的情况下更改这些 BAR，同时 PCI 总线驱动程序再次枚举总线。系统的超级用户甚至可以`setpci`在 BIOS 已经尝试配置它们并且操作系统已经加载之后运行命令来更改这些 BAR（如果操作不当，可能会导致驱动程序失败和其他一些坏事）。

*在 BIOS 未为相关卡分配任何*资源的情况下，我不得不这样做，因为请求的区域需要 64 位地址，而 BIOS 仅使用 32 位地址分配操作。我能够在事后进行并将这些地址（最初由 BIOS 分配）更改为我认为合适的任何地址，插入内核模块，我的驱动程序将映射并使用这些新分配的地址用于卡，而无需知道区别。

热插拔 PCI-Express 卡存在的问题是，如果没有主板/背板上需要存在的特定热插拔控制器，插槽本身的电源就无法打开/关闭。如果没有这些热插拔控制器来关闭插槽的电源，则在物理插入和/或移除卡（如果仍然存在电源）时，可能会导致微小引脚之间的短路。然而，热插拔事件可以由任一端（主机**或**端点设备）发起。情况似乎并非如此，但是如果您的 FPGA 已经与根复合体建立了链接，则可能的解决方案是生成热插拔中断以导致操作系统中的总线重新扫描。

但是有一个主要问题——如果您的卡实际上没有获得到根联合体的链接，它将无法生成任何热插拔事件；似乎是这样。启动后，FPGA 应该切换 PCIe 总线上的**PRESENT**线，告诉操作系统有一张卡可以被枚举。一旦检测到，操作系统应该尝试建立到卡的链接并将内存区域分配给设备。在操作系统枚举卡后，您将能够针对它加载驱动程序并在`lspci`. 您说您使用的是内核 2.6，它确实支持热插拔和动态资源分配，因此只要您的 FPGA 也支持切换 PRESENT PCIe 线的能力，这种方法就应该有效。

# javascript - 在phoneap + jquery问题中滑动图像

> ID：12414027
> 
> 赞同：0
> 
> 时间：2012-09-13T20:09:17.993
> 
> 标签：javascript, android, jquery, cordova

我正在使用 javacsript 和 jquery 构建一个 phonegap 应用程序。我编写了这段代码来滑动图像。

```
$('#fullscreen').swipeleft(function () {
        //Show next image
        showNext();
        alert('Left');
 });

function showNext() {
$("#fullscreen").attr('src', "images/next.png");
} 
```

但是当我滑动时，图像没有改变，并且出现错误“09-13 14:49:21.188: W/webview(20238): Miss a drag as we are waiting for WebCore's response for touch down.”

在浏览了一些论坛后，我添加了以下代码。

```
var fullScr = document.getElementById("fullscreen");
    fullScr.addEventListener( "touchstart", function(e){ onStart(e); }, false );
    function onStart ( touchEvent ) {
      if( navigator.userAgent.match(/Android/i) ) {
        touchEvent.preventDefault();
      }
} 
```

但它仍然不起作用。虽然当我将屏幕方向从纵向更改为横向时，图像会发生变化。当我改变方向时会发生什么？我怎样才能让它以相同的方向（纵向/横向）工作？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T05:32:16.673

好吧，它对我有用：S...我使用了 Cordova 1.5.0 版并在 Android 模拟器 4.0.3 上运行该应用程序。你能试试下面的例子吗？

HTML 内容：

```
<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">

        <!--  BASIC INCLUDES - TO BE MODIFIED ACCORDING TO YOUR CONVENIENCE -->

        <link rel="stylesheet" href="./css/jquery.structure-1.1.0.min.css" />
        <link rel="stylesheet" href="./css/jquery.mobile-1.1.0.min.css" />

        <script type="text/javascript" charset="utf-8" src="cordova-1.5.0.js"></script>
        <script type="text/javascript" src="./js/jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="./js/jquery.mobile-1.1.0.min.js"></script>

        <!--  END - BASIC INCLUDES -->

        <script type="text/javascript" charset="utf-8">

        $(function() {
            $('#fullscreen').swipeleft(function () {
                //Show next image
                showNext();
            });

            function showNext() {
                $("#fullscreen").attr('src', "./images/next.png");
            }
        });

        </script>
    </head>

    <body>
        <div data-role="page">
            <div data-role="content">
                <img id="fullscreen" src="./images/previous.png"></img>
            </div>
    </div>
    </body>
</html> 
```

* * *

**注意：请确保以下事项：**

*   修改代码的“基本包含”的来源以方便您（jQuery / jQuery Mobile 的 CSS / JS 文件的来源）

*   如果您的版本不是 1.5.0，请更改科尔多瓦版本的来源

* * *

希望这对你也有用。不管怎样，让我知道你的结果。

# .net - .NET 性能测试影响（非 WEB）

> ID：12414035
> 
> 赞同：2
> 
> 时间：2012-09-13T20:09:44.563
> 
> 标签：.net, performance, testing, automated-tests

.NET 中是否有任何用于持续性能测试的工具/技术？理想情况下，我想找到一个工具，它可以像 Test Impact 对正确性所做的那样处理性能：记住以前的最佳结果，当我更改受影响的代码时发出通知，然后将新的测试运行与前一个进行比较. 我知道即使在相同的代码上，执行时间也可能因运行而异，但我想这个问题可以通过一些测试重复和置信区间来解决。例如，如果之前的最佳执行时间是 t1，而新的测试执行时间是 t2，那么：

如果 t1*0.9 <= t2 <= t1*1.1，测试为绿色（通过）

如果 t1*0.9 > t2，测试为蓝色（改进）

如果 t1*1.1 < t2，测试为红色（失败）

我希望我能很好地解释我的想法，那么有没有类似的工具？是的，我试图先用谷歌搜索它，但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:46:44.670

我们在我的项目上做了几件事。我们使用像 QFTest 这样的工具来记录鼠标和键的移动，然后“运行”程序来测试软件。我们创建执行一个程序（如单元测试）的 bat 文件，该程序执行“设置”，创建一个起点，然后贯穿我们所有的业务逻辑。我们将结果保存到日志文件或数据库表中进行比较。我们还创建存储过程，通过做同样的事情来测试软件的数据库端；模仿登录，插入，触发规则，保存结果。我们还在 IDE 中进行单元测试。因此，在 Visual Studio 中，您设置所有单元测试（包括设置和拆除）并运行它们，将结果保存到文件或数据库中。

简而言之，单元测试是你的朋友，你有很多方法来设置它们并记录你的结果。 [Nunit](http://www.nunit.org/)是一个很好的起点以及[测试驱动开发](https://en.wikipedia.org/wiki/Test-driven_development)

# msbuild - NuGet pack 和 msbuild - 如何将引用程序集打包到另一个位置？

> ID：12414039
> 
> 赞同：7
> 
> 时间：2012-09-13T20:09:50.447
> 
> 标签：msbuild, nuget

我第一次使用 NuGet 包，使用 .csproj 文件中的 AfterBuild 目标。

```
<Target Name="AfterBuild">
  <!-- package with NuGet -->
  <Exec WorkingDirectory="$(BaseDir)" Command="$(NuGetExePath) pack -Verbose -OutputDirectory $(OutDir) -Symbols -Prop Configuration=$(Configuration)" />
</Target> 
```

这在使用 msbuild（“msbuild MyProj.csproj”）构建项目本身时工作正常。NuGet 能够在 projectdir/bin/Release 或 projectdir/bin/Debug 中找到已编译的程序集。

但是，该项目是解决方案中的众多项目之一，并且有一个专门用于构建整个解决方案的构建文件。目录树是这样的：

```
- project root
  - build
  - src
    - MyProj
      - MyProj.csproj
      - MyProj.nuspec
    - AnotherProj
      - AnotherProj.csproj
      - AnotherProj.nuspec
  - project.proj (msbuild file) 
```

此 msbuild 文件将覆盖 Visual Studio 生成的输出路径。

```
<PropertyGroup>
  <CodeFolder>$(MSBuildProjectDirectory)\src</CodeFolder>
  <CodeOutputFolder>$(MSBuildProjectDirectory)\build\$(Configuration)</CodeOutputFolder>
</PropertyGroup>

<Target Name="Build" DependsOnTargets="CleanSolution">
  <Message Text="============= Building Solution =============" />
  <Message Text="$(OutputPath)" />
  <Message Text="$(BuildTargets)" />
  <MsBuild Projects="$(CodeFolder)\$(SolutionName)" 
           Targets="$(BuildTargets)"
                 Properties="Configuration=$(Configuration);RunCodeAnalysis=$(RunCodeAnalysis);OutDir=$(OutputPath);" />
</Target> 
```

现在构建将程序集重定向到构建目录，当我运行包时，NuGet 找不到它们。如何让 NuGet 在构建目录中找到程序集？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-17T20:13:43.483

为 NuGet 提供一个 TargetPath 属性，用于查找程序集的位置。

```
<Target Name="AfterBuild" Condition="'$(Configuration)' == 'Release' ">
  <!-- package with NuGet -->
  <Exec WorkingDirectory="$(BaseDir)" Command="$(NuGetExePath) pack -OutputDirectory $(OutDir) -Symbols -Prop Configuration=$(Configuration);TargetPath=$(OutDir)$(AssemblyName)$(TargetExt)" />
</Target> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T05:43:49.007

尝试在 *.nuspec 文件中定义文件部分，在 VS 属性中将复制`Copy to Output Directory`属性设置为`Copy always`或为它们设置。`Copy if newer`之后，您编译的所有文件和 nuspecs 都将位于`$(OutputPath)`. 然后将 AfterBuild 更改为：

```
<Target Name="AfterBuild">
  <PropertyGroup>
    <NuspecPath>$([System.IO.Path]::Combine($(OutputPath), "$(ProjectName).nuspec"))</NuspecPath>
  </PropertyGroup>
  <!-- package with NuGet -->
  <Exec WorkingDirectory="$(BaseDir)" Command="$(NuGetExePath) pack $(NuspecPath) -Verbose -OutputDirectory $(OutDir) -Symbols -Prop Configuration=$(Configuration)" />
</Target> 
```

# matlab - MATLAB 的一个函数 = 一个文件的最初原因是什么，为什么仍然如此？

> ID：12414041
> 
> 赞同：4
> 
> 时间：2012-09-13T20:10:26.687
> 
> 标签：matlab

*MATLAB的一个（主）*函数=一个文件的最初原因是什么，经过这么多年的发展，为什么仍然如此？

与它的缺点相比，这种方法的优点是什么（人们在函数和脚本中放置了太多东西，而它们显然应该分开......导致代码清晰度下降）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:24:18.157

我不认为有什么优势。但是您可以将任意数量的函数放在一个文件中。例如：

```
classdef UTILS
    methods (Static)
        function help
            % prints help for all functions
            disp(char(methods(mfilename, '-full')));
        end
        function func_01()
        end
        function func_02()
        end
        % ...more functions
    end
end 
```

我觉得很整洁。

```
>> UTILS.help
obj UTILS     
Static func_01
Static func_02
Static help 

>> UTILS.func_01() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T21:15:09.887

Matlab 为每个文件加载一个类/函数的模式似乎与 Java 在这方面的选择相匹配。我敢打赌，在 1980 年代引入解析器时，还有其他技术原因可以加速解析器。Java 选择了这个模式来阻止非常大的文件，里面塞满了所有东西，这一直是我见过的使用单文件类语义的任何语言的主要论据。

然而，强制每个文件语义一个类并不能阻止巨型文件[——KPIB](http://www.mathworks.com/matlabcentral/fileexchange/12051-kpib-kenny-purpose-interface-bus)是一个复杂的、非常长的函数/类文件的完美示例（尽管是一个非常有用的 maga 文件）。因此，一个类文件系统是一种试图让用户了解代码抽象的方法，而不是一种功能上有用的机制。

Matlab 的一个函数/类文件系统的一个积极结果是，快速浏览项目目录很容易知道哪些函数可用。此外，许多名称必须具有足够的描述性以将它们与其他文件区分开来，因此作为一种次要形式的文档命名存在副作用。

最后，我不认为有强烈的论据支持或反对一个文件类，因为从一个文件类到另一个文件类通常只是一个小的语义变化（除非你的代码处于非常无组织的状态......在这种情况下你应该羞于修复它）。

**编辑！**

我修正了对 Matlab 采用 Java 的一个类文件系统的错误引用——经过更多研究后，似乎两个开发人员都独立采用了这种风格（或者更确切地说，没有指定另一种语言影响了他们的决定）。尤其如此，因为 Matlab 直到 2000 年才捆绑 Java。

# jquery - jquery ajax表单通过java servlet提交

> ID：12414042
> 
> 赞同：0
> 
> 时间：2012-09-13T20:10:34.060
> 
> 标签：jquery, ajax, forms, jsp, accordion

我正在尝试通过 Ajax/Jquery 提交表单并在手风琴步骤过程中从 Servlet 获得响应，但是对于我的一生，我无法弄清楚这一点。我有自己的表格，我有自己的手风琴，但是当我把这两者放在一起时，它就不起作用了。

这是我把它放在一起的代码：

```
$(document).ready(function(){

$('label.form-field-label-required').append('&nbsp;<strong>*</strong>');

// accordion functions
var accordion = $("#accordion").accordion({
      event: false,
      autoheight: true,
      animated: "slide",
});
var current = 0; 

$.validator.addMethod("pageRequired", function(value, element) {
    var $element = $(element)
    function match(index) {
        return current == index && $(element).parents("#accordion").length;
    }
    if (match(0) || match(1) || match(2)) {
        return !this.optional(element);
    }
    return "dependency-mismatch";
}, $.validator.messages.required)

var v = $("#cmaForm").validate({
    submitHandler: function() { 
         $.ajax({
                    type:"post",
                    url:"ActionServlet",
                    data:"name="+name+"&sex="+gender,
                    success: function(response){

                    // Change only the header of the file.
                    $("h1").text(response);
                    },
                }); 
                            if (v2.form()) {
                        accordion.accordion("activate", 1);
                        current = 1;
                    }
                }
        }); 
```

表格代码：

```
 <h4><a href="#">Employee Personal Information</a></h4>
    <div>
            <form name="cmaForm" id="cmaForm" action="" method="post">
<h1 style="text-align:center">Hello Guest</h1>
      <p>Please fill out your name and gender: <br></br>
  Name: <input type="text" name="name" id="name"/><br/>
  <input type="radio" name="sex" value="male"/> Male.<br/>
  <input type="radio" name="sex" value="female"/> Female. </p>
      <p>
         <input name="formNext1" type="submit" class="open1 nextbutton" value="Next" alt="Next" title="Next" />
      </p>
    </form> 
```

应该发生的是，成功后，H1 文本应更改以反映输入数据，然后第一个手风琴关闭，第二个手风琴打开。到目前为止，所发生的只是页面刷新，然后它会显示在地址栏中：

```
http://localhost/test/index.htm?name=bnhjhj&sex=female# 
```

但没有其他事情发生。

我只包含了第一个手风琴代码来限制屏幕上的代码数量。如果你需要其余的，我可以发布它。

提前致谢。

服务代码

```
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.Servlet;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class ActionServlet extends HttpServlet implements Servlet
{

    private static final long serialVersionUID = 1L;

    /**
     * 
     */
    public ActionServlet()
    {
        super();
    }

    /**
     * 
     */
    protected void doGet(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException
    {
        doPost(req, res);
    }

       public void doPost (HttpServletRequest request, HttpServletResponse response) 
               throws ServletException, IOException {
                    String name= request.getParameter("name");
                    String gender= request.getParameter("sex");
                    PrintWriter out= response.getWriter();
                        if(gender.equals("male")){
                            out.print("Hello Mr "+ name +" your request was sent successfully.");
                            }
                            else{
                            out.print("Hello Miss "+ name +" your request was sent successfully.");
                        }
                }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:13:28.457

在调用 jQuery ajax() 的地方，将 data 属性更改为 JSON 而不是字符串。例子

```
$.ajax({ ..., data: { "name": name, "gender": gender }}); 
```

# python - 将每个列表值映射到其相应的百分位数

> ID：12414043
> 
> 赞同：38
> 
> 时间：2012-09-13T20:10:37.137
> 
> 标签：python, numpy, scipy, median, percentile

我想创建一个函数，它将（排序的）列表作为其参数，并输出一个包含每个元素对应百分位数的列表。

例如，`fn([1,2,3,4,17])`返回`[0.0, 0.25, 0.50, 0.75, 1.00]`.

任何人都可以请：

1.  帮我更正下面的代码？或者
2.  提供比我的代码更好的替代方法来将列表中的值映射到相应的百分位数？

我当前的代码：

```
def median(mylist):
    length = len(mylist)
    if not length % 2:
        return (mylist[length / 2] + mylist[length / 2 - 1]) / 2.0
    return mylist[length / 2]

###############################################################################
# PERCENTILE FUNCTION
###############################################################################

def percentile(x):
    """
    Find the correspoding percentile of each value relative to a list of values.
    where x is the list of values
    Input list should already be sorted!
    """

    # sort the input list
    # list_sorted = x.sort()

    # count the number of elements in the list
    list_elementCount = len(x)

    #obtain set of values from list

    listFromSetFromList = list(set(x))

    # count the number of unique elements in the list
    list_uniqueElementCount = len(set(x))

    # define extreme quantiles
    percentileZero    = min(x)
    percentileHundred = max(x)

    # define median quantile
    mdn = median(x) 

    # create empty list to hold percentiles
    x_percentile = [0.00] * list_elementCount 

    # initialize unique count
    uCount = 0

    for i in range(list_elementCount):
        if x[i] == percentileZero:
            x_percentile[i] = 0.00
        elif x[i] == percentileHundred:
            x_percentile[i] = 1.00
        elif x[i] == mdn:
            x_percentile[i] = 0.50 
        else:
            subList_elementCount = 0
            for j in range(i):
                if x[j] < x[i]:
                    subList_elementCount = subList_elementCount + 1 
            x_percentile[i] = float(subList_elementCount / list_elementCount)
            #x_percentile[i] = float(len(x[x > listFromSetFromList[uCount]]) / list_elementCount)
            if i == 0:
                continue
            else:
                if x[i] == x[i-1]:
                    continue
                else:
                    uCount = uCount + 1
    return x_percentile 
```

目前，如果我提交`percentile([1,2,3,4,17])`，`[0.0, 0.0, 0.5, 0.0, 1.0]`则返回列表。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2015-02-18T06:08:44.607

我认为您的示例输入/输出与计算百分位数的典型方法不对应。如果您将百分位数计算为“数据点的比例严格小于该值”，则最大值应为 0.8（因为 5 个值中有 4 个小于最大值）。如果将其计算为“小于或等于该值的数据点的百分比”，则底部值应为 0.2（因为 5 个值中的 1 个等于最小值）。因此百分位数将是`[0, 0.2, 0.4, 0.6, 0.8]`或`[0.2, 0.4, 0.6, 0.8, 1]`。您的定义似乎是“数据点的数量严格小于这个值，被认为是不等于这个值的数据点数量的比例”，但根据我的经验，这不是一个常见的定义（例如参见[wikipedia](https://en.wikipedia.org/wiki/Percentile)） .

使用典型的百分位数定义，数据点的百分位数等于其排名除以数据点的数量。（例如，请参阅Stats SE 上的[这个问题](https://stats.stackexchange.com/questions/11924/computing-percentile-rank-in-r)，询问如何在 R 中做同样的事情。）如何计算百分位数的差异相当于如何计算排名的差异（例如，如何对绑定值进行排名）。该`scipy.stats.percentileofscore`函数提供了四种计算百分位数的方法：

```
>>> x = [1, 1, 2, 2, 17]
>>> [stats.percentileofscore(x, a, 'rank') for a in x]
[30.0, 30.0, 70.0, 70.0, 100.0]
>>> [stats.percentileofscore(x, a, 'weak') for a in x]
[40.0, 40.0, 80.0, 80.0, 100.0]
>>> [stats.percentileofscore(x, a, 'strict') for a in x]
[0.0, 0.0, 40.0, 40.0, 80.0]
>>> [stats.percentileofscore(x, a, 'mean') for a in x]
[20.0, 20.0, 60.0, 60.0, 90.0] 
```

（我使用了一个包含关系的数据集来说明在这种情况下会发生什么。）

“排名”方法为并列组分配的排名等于他们将覆盖的排名的平均值（即，获得第二名的三路并列获得排名 3，因为它“占据”排名 2、3 和 4）。“弱”方法根据小于或等于给定点的数据点的比例分配百分位数；“严格”是相同的，但计算点的比例严格小于给定点。“均值”法是后两者的平均值。

正如 Kevin H. Lin 所指出`percentileofscore`的，循环调用效率低下，因为它必须在每次传递时重新计算等级。但是，这些百分位数计算可以使用 提供的不同排名方法轻松复制[`scipy.stats.rankdata`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.mstats.rankdata.html)，让您一次计算所有百分位数：

```
>>> from scipy import stats
>>> stats.rankdata(x, "average")/len(x)
array([ 0.3,  0.3,  0.7,  0.7,  1\. ])
>>> stats.rankdata(x, 'max')/len(x)
array([ 0.4,  0.4,  0.8,  0.8,  1\. ])
>>> (stats.rankdata(x, 'min')-1)/len(x)
array([ 0\. ,  0\. ,  0.4,  0.4,  0.8]) 
```

在最后一种情况下，将排名向下调整 1 以使它们从 0 而不是 1 开始。（我省略了“平均值”，但可以通过对后两种方法的结果进行平均来轻松获得。）

我做了一些计时。对于您的示例中的小数据， using`rankdata`比 Kevin H. Lin 的解决方案要慢一些（可能是由于 scipy 在将事物转换为 numpy 数组时产生的开销），但比`percentileofscore`在 reptilicus 的回答中调用循环要快：

```
In [11]: %timeit [stats.percentileofscore(x, i) for i in x]
1000 loops, best of 3: 414 µs per loop

In [12]: %timeit list_to_percentiles(x)
100000 loops, best of 3: 11.1 µs per loop

In [13]: %timeit stats.rankdata(x, "average")/len(x)
10000 loops, best of 3: 39.3 µs per loop 
```

但是，对于大型数据集，numpy 的性能优势生效并且使用`rankdata`速度比 Kevin 的快 10 倍`list_to_percentiles`：

```
In [18]: x = np.random.randint(0, 10000, 1000)

In [19]: %timeit [stats.percentileofscore(x, i) for i in x]
1 loops, best of 3: 437 ms per loop

In [20]: %timeit list_to_percentiles(x)
100 loops, best of 3: 1.08 ms per loop

In [21]: %timeit stats.rankdata(x, "average")/len(x)
10000 loops, best of 3: 102 µs per loop 
```

这种优势只会在越来越大的数据集上变得更加明显。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-09-13T20:42:07.030

我想你想要[scipy.stats.percentileofscore](http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.percentileofscore.html#scipy.stats.percentileofscore)

例子：

```
percentileofscore([1, 2, 3, 4], 3)
75.0
percentiles = [percentileofscore(data, i) for i in data] 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-12-16T04:39:14.687

就复杂性而言，我认为 reptilicus 的答案并不是最优的。它需要 O(n^2) 时间。

这是一个需要 O(n log n) 时间的解决方案。

```
def list_to_percentiles(numbers):
    pairs = zip(numbers, range(len(numbers)))
    pairs.sort(key=lambda p: p[0])
    result = [0 for i in range(len(numbers))]
    for rank in xrange(len(numbers)):
        original_index = pairs[rank][1]
        result[original_index] = rank * 100.0 / (len(numbers)-1)
    return result 
```

我不确定，但我认为这是您可以获得的最佳时间复杂度。我认为它是最佳的粗略原因是因为所有百分位数的信息本质上等同于排序列表的信息，并且您无法比 O(n log n) 更好地进行排序。

编辑：根据您对“百分位数”的定义，这可能并不总是给出正确的结果。有关更多解释和使用 scipy/numpy 的更好解决方案，请参阅 BrenBarn 的答案。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-05-01T15:35:10.123

### 纯 numpy 版本的 Kevin 解决方案

正如凯文所说，最佳解决方案在 O(n log(n)) 时间内起作用。这是他的代码的快速版本`numpy`，它的工作时间几乎与`stats.rankdata`：

```
percentiles = numpy.argsort(numpy.argsort(array)) * 100\. / (len(array) - 1) 
```

PS。这是我最喜欢的技巧之一`numpy`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-13T20:45:19.730

这可能看起来过于简单了，但这个呢：

```
def percentile(x):
    pc = float(1)/(len(x)-1)
    return ["%.2f"%(n*pc) for n, i in enumerate(x)] 
```

编辑：

```
def percentile(x):
    unique = set(x)
    mapping = {}
    pc = float(1)/(len(unique)-1)
    for n, i in enumerate(unique):
        mapping[i] = "%.2f"%(n*pc)
    return [mapping.get(el) for el in x] 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-05-03T19:40:38.163

我尝试了 Scipy 的百分位数，但结果对于我的一项任务来说非常慢。所以，简单地以这种方式实现它。如果需要弱排名，可以修改。

```
 def assign_pct(X):
    mp = {}
    X_tmp = np.sort(X)
    pct = []
    cnt = 0
    for v in X_tmp:
        if v in mp:
            continue
        else:
            mp[v] = cnt
            cnt+=1
    for v in X:
        pct.append(mp[v]/cnt)
    return pct 
```

调用函数

```
assign_pct([23,4,1,43,1,6]) 
```

函数输出

```
[0.75, 0.25, 0.0, 1.0, 0.0, 0.5] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-13T20:31:40.447

如果我理解正确，那么您要做的就是定义该元素在数组中表示的百分位数，即该元素之前的数组有多少。如 [1, 2, 3, 4, 5] 应为 [0.0, 0.25, 0.5, 0.75, 1.0]

我相信这样的代码就足够了：

```
def percentileListEdited(List):
    uniqueList = list(set(List))
    increase = 1.0/(len(uniqueList)-1)
    newList = {}
    for index, value in enumerate(uniqueList):
        newList[index] = 0.0 + increase * index
    return [newList[val] for val in List] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-04T11:17:14.867

对我来说，最好的解决方案是`QuantileTransformer`在`sklearn.preprocessing`.

```
from sklearn.preprocessing import QuantileTransformer
fn = lambda input_list : QuantileTransformer(100).fit_transform(np.array(input_list).reshape([-1,1])).ravel().tolist()
input_raw = [1, 2, 3, 4, 17]
output_perc = fn( input_raw )

print "Input=", input_raw
print "Output=", np.round(output_perc,2) 
```

这是输出

```
Input= [1, 2, 3, 4, 17]
Output= [ 0\.    0.25  0.5   0.75  1\.  ] 
```

注意：此功能有两个显着特点：

1.  输入的原始数据不一定是排序的。
2.  输入原始数据不一定是单列。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-07T20:39:05.200

此版本还允许传递用于排名的确切百分位数：

```
def what_pctl_number_of(x, a, pctls=np.arange(1, 101)):
    return np.argmax(np.sign(np.append(np.percentile(x, pctls), np.inf) - a)) 
```

因此，可以找出提供的百分位数的百分位数数值是多少：

```
_x = np.random.randn(100, 1)
what_pctl_number_of(_x, 1.6, [25, 50, 75, 100]) 
```

输出：

```
3 
```

所以它达到 75 ~ 100 范围

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-04-03T19:37:14.320

对于一个**纯 python 函数**来计算给定项目的**百分位**分数，与总体分布（分数列表）相比，我从`scipy`源代码中提取了这个并删除了对 numpy 的所有引用：

```
def percentileofscore(a, score, kind='rank'):    
    n = len(a)
    if n == 0:
        return 100.0
    left = len([item for item in a if item < score])
    right = len([item for item in a if item <= score])
    if kind == 'rank':
        pct = (right + left + (1 if right > left else 0)) * 50.0/n
        return pct
    elif kind == 'strict':
        return left / n * 100
    elif kind == 'weak':
        return right / n * 100
    elif kind == 'mean':
        pct = (left + right) / n * 50
        return pct
    else:
        raise ValueError("kind can only be 'rank', 'strict', 'weak' or 'mean'") 
```

来源：[https ://github.com/scipy/scipy/blob/v1.2.1/scipy/stats/stats.py#L1744-L1835](https://github.com/scipy/scipy/blob/v1.2.1/scipy/stats/stats.py#L1744-L1835)

鉴于计算百分位数比人们想象的要复杂，但比完整的 scipy/numpy/scikit 包要简单得多，这是轻量级部署的最佳选择。原始代码只过滤非零值更好，但除此之外，数学是相同的。可选参数控制它如何处理介于其他两个值之间的值。

对于这个用例，可以使用 map() 函数为列表中的每个项目调用此函数。

# r - 多个数据框和列的交叉表

> ID：12414051
> 
> 赞同：0
> 
> 时间：2012-09-13T20:11:25.373
> 
> 标签：r, function, functional-programming

我正在计算跨多个切片的大量数据帧与单个响应变量的汇总统计信息。我目前通过将 DF 列表传递给函数来做到这一点。但是我的函数必须单独指定列（即切片）。这大大加快了我的进程；但是，我认为必须有一种更有效的方法来通过 apply() 系列函数来做到这一点。我希望这里有人可以帮助我。

这是我的代码：

```
table1 <- function(x) {
  dl2 <- list()
  for (i in 1:length(x)) {
    z <- x[[i]]
    t.sliceA     <- addmargins(table(list(z$sliceA, z$Growing)))
    t.sliceB     <- addmargins(table(list(z$sliceB, z$Growing)))
    t.sliceC     <- addmargins(table(list(z$sliceC, z$Growing)))
    t.sliceD     <- addmargins(table(list(z$sliceD, z$Growing)))
    ...
    t.sliceAA    <- addmargins(table(list(z$sliceAA, z$Growing)))
    table.list <- list(t.sliceA, t.sliceB, t.sliceC, ... , t.sliceAA)
    names(table.list) <- c("t.sliceA", "t.sliceB", ... , "t.sliceAA")
    dl2[[i]] <- table.list
  }
  assign("dl",dl2, envir=.GlobalEnv)
}
# run the function
dl <- c(DF1, DF2, ..., DF.n)
table1(dl) 
```

我认为必须有一种更有效的方法来通过 lapply() 执行此操作，我只需要指定所需的列。我会替换线条的东西

```
t.sliceA <- [blah]
...
t.sliceAA <- [blah] 
```

有类似的东西：

```
apply(z[,c(1:4,10:12,15)],2, function(x) addmargins(table(list(x,z$Growing)))) 
```

您可以提供的任何帮助都会非常有帮助。谢谢！

**更新：可重现** 的示例@Chase 如果做得不好，我深表歉意。这是我第一次使用 github。

[https://gist.github.com/3719220](https://gist.github.com/3719220)

这是代码：

```
# load the example datasets
a.small <- dget("df1.txt")
l.small <- dget(df2.txt)

# working function that I'd like to simplify
table1 <- function(x) {
  dl2 <- list()
  for (i in 1:length(x)) {
    z <- x[[i]]
    t.tenure     <- addmargins(table(list(z$Tenure.Group, z$Growing)))
    t.optfile    <- addmargins(table(list(z$opt.file, z$Growing)))
    t.checking   <- addmargins(table(list(z$checking, z$Growing)))
    t.full      <- addmargins(table(list(z$add.full, z$Growing)))
    t.optdm      <- addmargins(table(list(z$opt.dm, z$Growing)))
    t.up         <- addmargins(table(list(z$add.up, z$Growing)))
    t.off        <- addmargins(table(list(z$offmode, z$Growing)))
    table.list <- list(t.tenure, t.optfile, t.checking, t.full, t.optdm, t.up, t.off)
    names(table.list) <- c("t.tenure", "t.optfile", "t.checking", "t.full", "t.optdm", "t.up", "t.off")
    dl2[[i]] <- table.list
  }
  assign("dl",dl2, envir=.GlobalEnv)
}
# create a DF list to send to the function
dl <- list(a.small, l.small)
table1(dl) # run the function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T00:10:06.000

据我所见，这可以通过几个`lapply`语句轻松完成

如果我们定义我们的函数来创建一个带有边距的表格

```
tabulate_df <- function(DF, .what, .with) {
  table.add.margins <- function(...) addmargins(table(...))
  lapply(DF[.what], table.add.margins, DF[[.with]])
} 
```

然后

```
# the columns we want to cross tabulate with `Growing`
table_names <- setdiff(names(df1), 'Growing')
df_list <- setNames(list(df1,df2), c('df1','df2'))

lapply(df_list, tabulate_df, .what = table_names, .with = 'Growing') 
```

# linux - 文件 $ 的多个结尾在单个文件中

> ID：12414053
> 
> 赞同：0
> 
> 时间：2012-09-13T20:11:32.000
> 
> 标签：linux, bash, command-line

我将一些枚举值从 Windows 中的 IntelliJ IDE 复制到记事本，将文件保存在共享驱动器中，然后在 linux 框中打开它。当我`cat -A`对文件进行操作时，它显示如下：

```
A,B,C,^M$
D,E,F,^M$
G,H,I,^M$ 
```

在四处搜索后，我发现 ^M 是回车符， $ 表示文件的最后一行。我只是对这个文件如何能够有多个 $ 感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:13:34.160

在`man cat`我的 GNU 盒子上：

```
 -A, --show-all
          equivalent to -vET 
```

（剪断）

```
 -E, --show-ends
          display $ at end of each line 
```

因此，有多个`$`s，因为有多行，每行都有一个结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:14:19.683

`$`是行标记的结尾`cat -A`，而不是文件的结尾。

这表明该文件具有 Windows 样式的换行符（回车后跟换行符）而不是 Unix 样式的（仅换行符）。

（您可以使用程序`dos2unix`或将文本文件从一种格式转换为另一种格式`unix2dos`。）

# sql-server-2008 - sql server 2008 - ORDER BY 子句中的非整数常量

> ID：12414055
> 
> 赞同：0
> 
> 时间：2012-09-13T20:11:39.987
> 
> 标签：sql-server-2008, sql-order-by, constants, upgrade

升级顾问说

> `ORDER BY`“在 90 或更高版本的兼容模式下，子句中不允许使用非整数常量”。

但是，当我尝试下面的语句时`SQL Server 2008`，它工作得很好。所以，我的问题是 - 非整数常量到底是什么？

```
select 
    POS_NO
    ,EMP_NO
    ,ORG_NAME
    ,EMP_LAST_NAME + ', ' + EMP_FIRST_NAME AS "Name" 
FROM 
    dbo.MyEmpTable 
ORDER BY
    "Name" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-26T05:25:30.513

以下是`MSDN`关于字符常量必须说的，在某种意义上`non-integer constant`

> 字符串常量用单引号括起来，包括字母数字字符（az、AZ 和 0-9）和特殊字符，例如感叹号 (!)、at 符号 (@) 和数字符号 (#)。字符串常量被分配了当前数据库的默认排序规则，除非使用 COLLATE 子句来指定排序规则。用户键入的字符串通过计算机的代码页进行评估，并在需要时转换为数据库默认代码页。

1）非整数常量是......不是整数的常量。

示例： `'string1'`表示一个字符串常量

`0x01`表示一个 varbinary 常数

`{ts '2015-02-26 06:00:00'}`表示日期时间常数

`1.23`表示数字常量

2）所以单引号用于定义字符串常量/字符串常量**，但**SQL Server 也允许使用单引号也用作列标识符分隔符：

```
SELECT ... expression AS 'Column1'
FROM ... 
```

在这种情况下，很明显这`'Column1'`是一个列标识符**，但**在 ORDER BY 中使用时：`ORDER BY 'Column1'` 它会产生混淆，因为 SQL Server 不知道它是表示字符串文字（字符串常量）还是表示列标识符/列名。

3) SQL Server 允许在 ORDER BY 中使用整数常量`SELECT ColA, ColB, ColC FROM ... ORDER BY 2`。在这种情况下`2`是 column 的索引`ColB`。此外，如果你想排序`ColB`，`ColC`你可以使用`ORDER BY 2, 3`. 使用列的索引被认为是不好的做法。

4）在这种情况下，我会使用

```
ORDER BY EMP_LAST_NAME + ', ' + EMP_FIRST_NAME 
```

# java - 如何检测图像的黄色程度

> ID：12414056
> 
> 赞同：1
> 
> 时间：2012-09-13T20:11:45.157
> 
> 标签：java, android

我想忽略所有其他颜色。我只想计算白色和黄色之间的颜色（亮黄色，浅黄色......一直到白色）。然后对某个图像的黄色程度进行评级。那可能吗？

我一直在玩，`Bitmap.getPixel()`但我不知道如何忽略其他颜色。

![在此处输入图像描述](../Images/9e8477469d7b0107d8849830172e5c4c.png)

在此示例中，图像 1 将是一个选择，因为它在亮黄色和白色之间具有更多颜色。

我怎样才能只检测到淡黄色？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T20:19:17.923

好吧，我会专注于像素的色调。使用此代码：

```
// get HSV values for the pixel's colour
float[] pixelColorHsv = new float[3];
Color.colorToHSV(Bitmap.getPixel(x,y), pixelColorHsv); 
```

什么是黄色可能取决于您，但范围可能在 72 到 49 之间（您可以使用[此工具](http://www.colblindor.com/color-name-hue/)来了解一下），然后您可以量化它在此范围内的位置或亮度和饱和度的高低。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:22:11.900

该`Bitmap.getPixel(int x, int y)`方法返回一个`Color`具有该像素 RGB 值的对象。黄色是红色和绿色的组合，所以纯黄色 RGB 三元组应该是 (255, 255, 0)，对吧？如果变暗，则降低红色和绿色值。如果你变得更亮，你会提高蓝色值。因此，基本上，您需要找到一种方法来检测任何给定像素的 RGB 值与 (255, 255, 0) 的“接近”程度，然后为整个图像累积这些接近值。对第二张图像执行相同的操作，然后比较 2 个结果。

# c# - 旧版 CD-ROM 驱动程序或程序作为真正的 CD/DVD 驱动器的传递

> ID：12414059
> 
> 赞同：2
> 
> 时间：2012-09-13T20:12:02.147
> 
> 标签：c#, api, cd-rom

我有一个从磁盘读取/翻录 CD/音乐数据的旧程序。它是一个自定义程序，可以读取音轨数据并将其转换为 wma/wpa/wav 格式。然后，用户输入如何获得许可，程序将数据和音乐文件摄取到我们的 LAN。

问题是该程序仅适用于少数 CD-ROM 驱动器。我想知道是否有一个程序或某种方法可以使程序通过驱动程序或虚拟驱动器指向通用驱动器，并实际上让它读取更高级的 CD/DVD 驱动器？

这是一个粗略的图表。[通用 cd-rom 虚拟驱动器] -> [映射到]-> [任何数量、品牌、模式或 cd/dvd 驱动器]

这样，我的程序将始终看到相同的通用 CD-ROM 驱动器，并且我可以将它安装在具有任何类型 CD/DVD 驱动器的任何 PC 上。

这是否可能无需对程序进行重写？我真的在寻找快速修复。

该程序是用 C# Visual Studio 2008 编写的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T11:29:04.463

经过大量测试后，我最终使用了 Windows 7 的 XP 模式。这给了我一个快速通用的 CD-ROM，并用螺栓固定在任何 CD/DVD 驱动器上。我知道这在技术上不是编程修复，但它在某种程度上解决了我的问题。它至少会为我争取一些时间，直到我能够得到并修复实际的代码。如果/当我找到一个时，我会发布最终修复。

# jquery - jQuery元素ID更改导致错误

> ID：12414061
> 
> 赞同：4
> 
> 时间：2012-09-13T20:12:06.623
> 
> 标签：jquery, html

我有 4 个带有 ids `#registrieren`、`#story`和的 div`#faq`以及`#mediadaten`这个 jQuery 脚本：

```
var menu='';
$(function()
{
    $('#registrieren').attr('id', 'menuAktiv');
    menu='registrieren';

    $('#registrieren').click(function()
    {
        if(menu != 'registrieren')
        {
            $('#menuAktiv').attr('id', menu);
            $('#registrieren').attr('id', 'menuAktiv');
            menu='registrieren';
        }
        alert(menu);
    });
    $('#story').click(function()
    {
    if(menu!='story')
    {
        $('#menuAktiv').attr('id', menu);
        $('#story').attr('id', 'menuAktiv');
        menu='story';
        }
        alert(menu);
    });
    $('#faq').click(function()
    {
        if(menu != 'faq')
        {
            $('#menuAktiv').attr('id', menu);
            $('#faq').attr('id', 'menuAktiv');
            menu='faq';
        }
        alert(menu);
    });
    $('#mediadaten').click(function()
    {
        if(menu != 'mediadaten')
        {
            $('#menuAktiv').attr('id', menu);
            $('#mediadaten').attr('id', 'menuAktiv');
            menu='mediadaten';
        }
        alert(menu);
    });
}); 
```

现在，当我单击 时`#story`，`#faq`或者`#mediadaten`我无法将 id 更改`#registrieren`回`#menuAktiv`.

当我在开始时更改这些元素的另一个元素 id 时，也会发生同样的问题。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:15:37.693

您应该使用类而不是 id 来表示哪个 div 处于活动状态。

[http://api.jquery.com/addClass](http://api.jquery.com/addClass)

[http://api.jquery.com/toggleClass](http://api.jquery.com/toggleClass)

[http://api.jquery.com/removeClass](http://api.jquery.com/removeClass)

然后使用 $('.classname') 来选择它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T20:16:36.830

而不是更改 id 来`menuAktiv`尝试使用类。

```
$(function()
{
    $('#registrieren').addClass('menuAktiv');

    // attach a click to all items
    $('#registrieren,#story,#faq,#mediadaten').click(function()
    {
        if ($(this).is(".menuAktiv"))
            return false;

        // remove current active menu class
        $('.menuAktiv').removeClass('menuAktiv');

        // set active class to clicked item
        $(this).addClass('menuAktiv');
    });
});​ 
```

如果我看到您的标记，这可能会更加优化

* * *

**工作示例：http: [//jsfiddle.net/hunter/XMu9n/](http://jsfiddle.net/hunter/XMu9n/)**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T20:17:48.083

从您的代码看来，您正在尝试使用`id=menuAktiv`.

然后，您可以使用`class=menuAktiv`.

***代码：***

```
$('#registrieren').addClass('menuAktiv'); // initially set active 
                                               // class to registrieren 
```

然后单击任何一个更改该类。例如：

```
$('#registrieren, #store, #faq, #mediadaten').click( function() {
  $('.menuAktiv').removeClass('menuAktiv'); // remove active class
  $(this).addClass('menuAktiv'); // add active class to clicked item
}); 
```

* * *

### 更多的

如果你为此创建一个通用函数会更好。例如：

```
function changeActiveElement(el) {
   $('.menuAktiv').removeClass('menuAktiv'); // remove active class
   $(el).addClass('menuAktiv'); // add active class to clicked item
} 
```

现在从点击处理程序调用这个函数，如下所示：

```
$('#registrieren, #store, #faq, #mediadaten').click( function() {
   changeActiveElement(this);
}); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-13T20:19:47.630

问题来自前几行。

```
 $('#registrieren').attr('id', 'menuAktiv');
menu='registrieren';

$('#registrieren').click(function()
{
    if(menu != 'registrieren')
    {
        $('#menuAktiv').attr('id', menu);
        $('#registrieren').attr('id', 'menuAktiv');
        menu='registrieren';
    }
    alert(menu);
}); 
```

在第三行中，$('#registrieren') 没有指向任何内容。$('#registrieren') 在 dom 中搜索 id="registrieren" 的元素。好吧，由于您已将该元素的 id 更改为其他内容，因此 $('#registrieren') 不会给您任何信息。

为了使其工作（虽然不一定是执行代码尝试执行的最佳方法），并证明我刚才描述的事情确实正在发生，您可以做的是将对该元素的引用保存在变量中（pre -改变）。然后在将来您想要定位该元素的任何时候都可以使用它。

```
var registrieren = $('#registrieren');

registrieren.attr('id', 'menuAktiv');

registrieren.click(function() {
//etc
}); 
```

至于使用类而不是 id 来“更改状态”，是的，这可能是一个更好的主意 - 无需继续保存对以前 id 的引用。

# c# - C#复选框标题没有重载匹配委托

> ID：12414072
> 
> 赞同：1
> 
> 时间：2012-09-13T20:13:10.423
> 
> 标签：c#, asp.net, gridview, checkbox

我正在尝试使用[http://www.codeproject.com/Articles/20165/CheckBox-Header-Column-For-DataGridView](http://www.codeproject.com/Articles/20165/CheckBox-Header-Column-For-DataGridView)中的代码，以便将 CheckBox 列添加到 DataGridView 并让标题复选框起作用，以便我可以点击它来检查所有项目。

当我尝试遵循该示例时，我遇到了一个问题“'cbHeader_OnCheckBoxClicked' 没有重载匹配委托'Solution.CheckBoxClickedHandler'

这似乎是我试图提出的一个案例

```
 cbHeader.OnCheckBoxClicked +=
            new CheckBoxClickedHandler(cbHeader_OnCheckBoxClicked); 
```

在错误的地方（我在加载数据网格时正在这样做）。

```
 private void LoadDataGrid()
    {

        //initialize the checkbox column
        DataGridViewCheckBoxColumn colCB = new DataGridViewCheckBoxColumn();
        DatagridViewCheckBoxHeaderCell cbHeader = new DatagridViewCheckBoxHeaderCell();
        colCB.HeaderCell = cbHeader;
        int colCount = dataGridView1.Columns.Count;
        //if we have no columns then add the one with checkboxes
        if (colCount == 0)
        {
            dataGridView1.Columns.Add(colCB);

        }
        cbHeader.OnCheckBoxClicked +=
            new CheckBoxClickedHandler(cbHeader_OnCheckBoxClicked);

        //Add the data adapter stuff here
    } 
```

有什么想法我在这里出错了吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:17:55.503

您需要在您的类中使用此签名定义一个函数：

```
 private void cbHeader_OnCheckBoxClicked(bool b)
    {
        throw new NotImplementedException();
    } 
```

# css - CSS背景图像y在容器中重复

> ID：12414075
> 
> 赞同：2
> 
> 时间：2012-09-13T20:13:17.703
> 
> 标签：css, containers

因此，我试图设置一个带有背景图像的容器，当容器 div 中的其他 div 元素足够长时，该背景图像会重复。当包含的 div 很短时，它希望不会重复。

但是，我无法让图像重复 - 我认为我编写#container 的方式有些问题。

这是我刚才的HTML...

```
<body>
  <div id=container>
    <div id=textblock>
      <div id=maintext>
        <p>text here</p>
      </div>
    </div>
  </div>
</body> 
```

这是CSS...

```
body {
    background-color: #888;
    background-position: top;
    height:100%;
    margin:0;
    padding:0;
}

#container {
    background-position: relative;
    width: 960px;
    min-height: 720px;
    margin-left: auto;
    margin-right: auto;
    font-family: Antelope H;
    font-size: 1.5em;
    color: #c60;
    background:url(images/containerback-01.png) repeat-y;
    background-color: #fc6;
} 
```

这是现在[的网站](http://www.deborahmcarthur.com/what/classes)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:21:49.233

这需要一个clearfix！容器元素只知道与未浮动的子元素一样高。[将此](http://www.yuiblog.com/blog/2010/09/27/clearfix-reloaded-overflowhidden-demystified/)添加到您的 css 文件中：

```
.clearfix:before,
.clearfix:after {
    content: ".";    
    display: block;    
    height: 0;    
    overflow: hidden;   
}
.clearfix:after {clear: both;}
.clearfix {zoom: 1;} /* IE < 8 */ 
```

并更改您的容器 div 以打开`<div id="container" class="clearfix">`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T20:17:48.653

这不是 CSS 问题。

只需放置一个

```
<br clear="all" /> 
```

在你之后

```
<div id="mainText"></div> 
```

每当您使用浮动时，您都必须使用清除

# java - 使用 Eclipse 从 java 中读取环境变量

> ID：12414077
> 
> 赞同：4
> 
> 时间：2012-09-13T20:13:18.357
> 
> 标签：java, eclipse, macos, environment-variables

在我搜索的所有地方，它都说您可以通过使用获取环境变量`System.getenv(str).`

它不适合我。这就是我正在做的事情：操作系统：Mac OS x 10.7 Java 1.6.x

如果我`export abc=/hello/`在终端中执行 then `echo $abc`，它会给我变量。如果我关闭终端，重新打开它并执行`echo $abc`，它就消失了。为了克服这个问题，我编辑了我的`.bash_profile`文件并插入了`export abc=/hello/`. 关闭终端，执行`echo $abc`，它可以工作。所以我明白 env 变量现在是永久的。

现在，如果在我的 java 控制台应用程序中，我 print `System.getenv("abc")`，它会返回`null`. 我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T20:18:03.403

您需要将其放入`export`您的原因`.bash_profile`是在 shell 中设置环境变量仅保留该 shell 中的变量，并且 - 因为您使用过`export`- 该 shell 的*子*级，或者换句话说，该 shell 启动的其他程序。

如果您从 Eclipse 运行 java 代码，并从设置了环境变量的 shell 启动 Eclipse，那么您的程序应该会看到添加的环境变量。要从 shell 启动 Eclipse，您需要使用 OS X`open`命令：

```
$ open /Applications/eclipse/Eclipse.app 
```

*或者，您可以在*Eclipse 项目中设置环境变量，如果您没有从具有适当环境的 shell 启动 Eclipse，则需要这样做。在*Run Configurations*对话框中，查找名为*Environment*的选项卡。在这里，您将找到一个用于添加将传递给您的程序的环境变量的表格。

最好将环境变量添加到运行配置中，因为这样它们将始终可用于您的项目。您的代码实际上并不关心环境变量的来源，将它们添加到项目中更简单，并且在不同平台上的工作方式相同。

当然，当您在 Eclipse*之外*运行程序时，您需要确保在您运行的 shell 中存在相同的环境变量`java`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T20:18:54.993

Eclipse 不使用系统的环境变量，除非直接从 shell 启动（通常通过单击其图标来启动它）。在这种情况下，您必须在程序运行配置的环境选项卡中显式设置所需的环境变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-07T09:11:03.203

我也遇到了同样的问题，我是这样解决的。

*   打开终端

*   cd 到 eclipse.app 所在的文件夹 例如`cd /Users/Shared/eclipse/jee-2020-09`

*   类型`open Eclipse.app/`

*   Eclipse 现在将打开，并且还能够访问系统环境变量。

使用代码检查它：

```
System.getenv().forEach((k, v) -> {
    System.out.println("ENV : " + k + ":" + v);
}); 
```

# spring - Spring Security 配置和 web.xml 映射

> ID：12414083
> 
> 赞同：1
> 
> 时间：2012-09-13T20:13:46.247
> 
> 标签：spring, jakarta-ee, spring-security

我是 Spring Security 的新手，并试图弄清楚 Spring-Security 模块的确切流程，

请建议正确的流程。

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    id="WebApp_ID" version="2.5">
    <display-name>OnlineTestProject</display-name>

    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>
            org.springframework.web.filter.DelegatingFilterProxy
        </filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/security/applicationContext-security.xml
            /WEB-INF/db/applicationContext.xml
        </param-value>
    </context-param>

    <listener>
        <listener-class>
            org.springframework.web.context.ContextLoaderListener
        </listener-class>
    </listener>

    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>
            org.springframework.web.servlet.DispatcherServlet
        </servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>jsp/index.jsp</welcome-file>
    </welcome-file-list>

</web-app> 
```

applicationContext-security.xml

```
<http use-expressions="true">
    <form-login login-page="/jsp/login.jsp" default-target-url="/jsp/index.jsp"
        authentication-failure-url="/jsp/login.jsp?login_error=1"
        always-use-default-target="true" />

    <intercept-url pattern="/jsp/login.jsp" access="permitAll" />

    <logout logout-url="/j_spring_security_logout"
        invalidate-session="true" />

    <remember-me />

    <session-management invalid-session-url="/jsp/login.jsp?loggedout=true">
        <concurrency-control max-sessions="1"
            error-if-maximum-exceeded="false" />
    </session-management>

    <anonymous enabled='false'/>
</http> 
```

我所知道的是，当应用程序发出请求时，它将进入欢迎文件列表以在我的情况下打开 jsp/login.jsp，因此它将直接打开 jsp/login.jsp 页面，但我们保持安全, 所以它会进入 applicationContext-security.xml 并检查 jsp/login.jsp 是否需要过滤等等....然后在哪里

```
<form-login login-page="/jsp/login.jsp" default-target-url="/jsp/index.jsp"
            authentication-failure-url="/jsp/login.jsp?login_error=1"
            always-use-default-target="true" /> 
```

将出现在图片中，据我所知，它应该转到“/jsp/login.jsp”页面进行登录，如果凭据成功，那么它应该转到/jsp/index.jsp，但它正在打开/jsp/ index.jsp 页面第一....

有人可以指导我正确的流程。

谢谢

# c# - 如何使用另一个 TreeView 对象的节点构建 TreeView 对象？

> ID：12414088
> 
> 赞同：-4
> 
> 时间：2012-09-13T20:14:04.370
> 
> 标签：c#, winforms, treeview, treenode

我有`treeView1`，我需要在创建`treeview2`时使用treeView1 的节点`treeNode.Text == myString`。所以我必须遍历treeView1的所有节点，如果是`treeNode.Text == myString`，那么我应该把这个节点添加到`treeView2`，如果这个节点的任何一个子节点有这个属性（`treeNode.Text == myString`），那么我也应该把这个节点添加到`treeView2`，即使`.Text != myString`。换句话说，`treeView2`object 是一个过滤后的 treeView1 对象。

有人可以给我一个想法如何实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:17:39.167

你应该对 TreeViews 使用递归方法，所以试试这个工作正常：

```
 ...

        foreach (TreeNode item in treeView1.Nodes)//in case you have multiple rootnodes
            treeView2.Nodes.Add((TreeNode)item.Clone());//clone all treeview1 nodes into treeview2

        foreach (TreeNode node in treeView2.Nodes)//in case you have multiple rootnodes
            AmISelected(node, "momo");//filter all nodes recursively

 ... 
```

和

```
private bool AmISelected(TreeNode root, string myString)
    {
        bool bfound = false;
        if (root.Text == myString)
            bfound = true;// I do have myString

        for (int i = root.Nodes.Count - 1; i >= 0; i--)
            if (AmISelected(root.Nodes[i], myString))
                bfound = true;// I've a child who have myString

        if (!bfound) //if i don't have myString neither any of my children
            if (root.Parent == null) // is it a root node
                treeView2.Nodes.Remove(root);
            else
                root.Parent.Nodes.Remove(root);

        return bfound;

    } 
```

![在此处输入图像描述](../Images/35da554e78e3089186e0eaf67e6e103b.png)

# jquery - jQuery 1.8.1 在 IE7 中出错

> ID：12414090
> 
> 赞同：1
> 
> 时间：2012-09-13T20:14:16.460
> 
> 标签：jquery, internet-explorer-7

在使用 jQuery 1.8.1 的 IE7 中，我不断收到以下错误：

```
Line: 4230
Error: Failed 
```

这是 jQuery 库中的那一行：

```
 "TAG": function( nodeName ) {
        if ( nodeName === "*" ) {
            return function() { return true; };
        }
        nodeName = nodeName.replace( rbackslash, "" ).toLowerCase();

        return function( elem ) {
            return elem && elem.nodeName && elem.nodeName.toLowerCase() === nodeName;
        }; // Line 4130

    }, 
```

这让我难倒了 2 天......还有其他人遇到这个问题吗？

# objective-c - APNs 提供的 Device Token 的格式在我的应用程序中是否突然发生了变化？

> ID：12414093
> 
> 赞同：4
> 
> 时间：2012-09-13T20:14:28.227
> 
> 标签：objective-c, ios, ios5, apple-push-notifications, devicetoken

不知道为什么......但我以前的功能推送通知注册回调正在返回一个奇怪的设备令牌。任何人都可以帮助理解它吗？据我所知，我没有更改有关此过程的任何代码。

以下代码：

```
- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)devToken
{
    NSLog(@"device token: %@", [devToken description]);
} 
```

给我这个输出：

```
device token: [32]: 8d 21:! 30:0 c3 ec 69:i f4 <--REDACTED--> 24:$ d5 26:& 64:d fb 27:' 79:y fc dc 10 ae 77:w b0 21:! 5b:[ 
```

有人认识这种格式或知道发生了什么吗？

**更新**`[devToken description]`奇怪的是，如果我提取它后面的每个和字符，似乎我的设备令牌实际上包含在`:`其中。我猜这`[32]:`只是字符串长度的一个指标。尽管如此，我仍然找不到任何理由。

**改写的问题：**`[NSData description]`输出格式是否改变了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T21:55:22.070

您不应该依赖 NSData 的描述方法（实际上是 NSObject 的描述方法）来从每个 iOS 版本到下一个版本提供相同的结果。Apple 可以更改此描述输出的内容。

设备令牌实际上是 NSData 格式的 HEX。您需要转换 NSData。您可以使用以下内容：

```
- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken
    {

        [[NSUserDefaults standardUserDefaults] setObject:[deviceToken stringWithHexBytes] forKey:@"DeviceToken"];
    } 
```

stringWithHexBytes 方法是 NSData 上的一个类别，如下所示：

**NSData+Hex.h**

```
 @interface NSData (Hex)

- (NSString *) stringWithHexBytes; 

@end 
```

**NSData+Hex.m**

```
 #import "NSData+Hex.h"

@implementation NSData (Hex)

- (NSString*) stringWithHexBytes 
{
    NSMutableString *stringBuffer = [NSMutableString stringWithCapacity:([self length] * 2)];
    const unsigned char *dataBuffer = [self bytes];

    for (int i = 0; i < [self length]; ++i)
    {
        [stringBuffer appendFormat:@"%02X", (unsigned long)dataBuffer[ i ]];
    }

    return [[stringBuffer retain] autorelease];
}

@end 
```

# eclipse - 如何在 Eclipse 产品中启用软件更新？

> ID：12414096
> 
> 赞同：4
> 
> 时间：2012-09-13T20:14:44.243
> 
> 标签：eclipse, product, p2

在我的 Eclipse 项目中，我定义了一个简单的插件（捆绑包）、一个包含该插件的功能部件和一个包含该功能部件的产品。

当我导出产品时（通过产品编辑器的“Eclipse 产品导出向导”），它会构建产品。我可以启动产品，一切正常（插件就在那里，做它应该做的事情）。

唯一的问题是该产品的用户无法使用软件更新菜单（帮助 -> 软件更新）安装附加的 Eclipse 功能。软件更新子菜单（“查找并安装...”和“管理配置...”）显示为灰色。

我们应该向产品添加哪些插件和/或功能，以便产品可以使用“软件更新”菜单接受附加功能？

我试图添加一堆 org.eclipse.equinox.p2.* 插件，但它仍然无法正常工作。

```
 <plugin id="org.eclipse.equinox.p2.artifact.repository"/>
  <plugin id="org.eclipse.equinox.p2.console"/>
  <plugin id="org.eclipse.equinox.p2.core"/>
  <plugin id="org.eclipse.equinox.p2.director"/>
  <plugin id="org.eclipse.equinox.p2.director.app"/>
  <plugin id="org.eclipse.equinox.p2.directorywatcher"/>
  <plugin id="org.eclipse.equinox.p2.discovery"/>
  <plugin id="org.eclipse.equinox.p2.discovery.compatibility"/>
  <plugin id="org.eclipse.equinox.p2.engine"/>
  <plugin id="org.eclipse.equinox.p2.extensionlocation"/>
  <plugin id="org.eclipse.equinox.p2.garbagecollector"/>
  <plugin id="org.eclipse.equinox.p2.jarprocessor"/>
  <plugin id="org.eclipse.equinox.p2.metadata"/>
  <plugin id="org.eclipse.equinox.p2.metadata.repository"/>
  <plugin id="org.eclipse.equinox.p2.operations"/>
  <plugin id="org.eclipse.equinox.p2.publisher"/>
  <plugin id="org.eclipse.equinox.p2.publisher.eclipse"/>
  <plugin id="org.eclipse.equinox.p2.ql"/>
  <plugin id="org.eclipse.equinox.p2.reconciler.dropins"/>
  <plugin id="org.eclipse.equinox.p2.repository"/>
  <plugin id="org.eclipse.equinox.p2.repository.tools"/>
  <plugin id="org.eclipse.equinox.p2.touchpoint.eclipse"/>
  <plugin id="org.eclipse.equinox.p2.touchpoint.natives"/>
  <plugin id="org.eclipse.equinox.p2.transport.ecf"/>
  <plugin id="org.eclipse.equinox.p2.ui"/>
  <plugin id="org.eclipse.equinox.p2.ui.discovery"/>
  <plugin id="org.eclipse.equinox.p2.ui.importexport"/>
  <plugin id="org.eclipse.equinox.p2.updatechecker"/>
  <plugin id="org.eclipse.equinox.p2.updatesite"/> 
```

是否有人确切知道需要做什么（如果可能，在产品定义级别）才能使“软件更新”菜单正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T06:50:23.360

菜单条目“**安装新软件**”由插件提供**`org.eclipse.equinox.p2.ui.sdk`**。您应该包含它以在您的 RCP 中显示该菜单条目。

如果您的 RCP 是基于功能的，我认为您应该只包含 p2 相关功能以简化流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T07:04:40.877

我不知道所需 p2 捆绑包的完整列表，但您可以通过以下方式轻松生成它：使用新向导创建*e4 > e4 Application Project*。这会生成一个产品文件，其中包含 p2 可更新产品所需的所有捆绑软件。

如果您有基于功能的产品，那么这些功能`org.eclipse.rcp`还`org.eclipse.e4.rcp`应该为您提供可更新的产品

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-20T08:17:46.497

我也面临同样的问题，并通过以下步骤解决；

在产品配置文件中，

```
.product file --> In Configuration Tab

Specify custom start levels for the following plug-ins,
    org.eclipse.equinox.ds start level 2, auto start true 
    org.eclipse.equinox.simpleconfigurator start level 1, auto start true
    org.eclipse.equinox.common start level 2, auto start true
    org.eclipse.core.runtime start level 4, auto start true 
```

# sql - 如何使用 SQL Server 的 OUTPUT 子句进行更新

> ID：12414104
> 
> 赞同：7
> 
> 时间：2012-09-13T20:15:28.913
> 
> 标签：sql, sql-server-2008

```
DECLARE @t2 AS TABLE(id INT)  

INSERT INTO dbo.EntityMaster
        (EntityType)
OUTPUT INSERTED.EntityId INTO @t2
SELECT 'G' FROM #tmp 
```

`#tmp`是一个临时表，其中包含从 xml 加载的数据。我需要为`EntityId`包含在`#tmp`. 可以通过首先将记录插入`EntityMaster`表中然后将此实体ID 插入`#tmp`每条记录来完成。

`@t2`我需要更新`#tmp`每条记录，而不是将记录插入。

有什么可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T13:18:35.040

尝试这样的事情，你仍然必须使用临时表，但它读起来还不错，它可以完成工作。

```
创建表#tmp
(
    tmpID INT IDENTITY(1,1) 主键集群，
    xmlData VARCHAR(255),
    EntityId INT
)
声明@t2 表
(
    tmpID INT,
    EntityId INT
)

合并 dbo.EntityMaster 作为 EM
使用
(
    选择 tmpID，
        xml数据，
        实体 ID
    来自#tmp
) 作为 X
    ON EM.EntityId = X.EntityId
当不匹配时
    插入（实体类型）
    值（X.xmlData）
输出 X.tmpID、INSERTED.EntityId
INTO @t2 (tmpID, EntityId);

更新 T
SET EntityId = T2.EntityId
来自@t2 T2
内连接#tmp T
    ON T2.tmpID = T.tmpID

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:53:11.577

这在将 XML 记录插入`#tmp`表的 SQL 中更容易实现。

考虑下`@recs`表，可以将其视为从 XML 生成的一组记录：

```
declare @recs table (val varchar(255))
insert into @recs values ('this'), ('is'), ('a'), ('test') 
```

您可以像这样轻松地将递增整数添加到每条记录：

```
select row_number() over (order by (select 1)) as id, val from @recs 
```

结果如下所示：

```
id  val
1   this
2   is
3   a
4   test 
```

您可以`row_number() over (order by (select1))`在插入记录的同时生成所需的 id`#tmp`吗？

# android - IntelliJ 是否将“测试文件”与 APK 中的应用程序一起打包

> ID：12414106
> 
> 赞同：3
> 
> 时间：2012-09-13T20:15:43.543
> 
> 标签：android, unit-testing, intellij-idea, apk, robolectric

我正在尝试使用 Robolectric 在 IntelliJ Idea（这是一个很棒的 IDE）中为 Android 应用程序编写单元测试。[我已经在此博客](http://blog.chariotsolutions.com/2012/08/integrating-robolectric-with-intellij.html#comment-form)中建议的同一应用程序中创建了单元测试。

现在我的问题是 IntelliJ IDE 是否也将测试类与最终 APK 中的应用程序类一起打包？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T08:06:00.867

Android Facet 有相应的设置：

![在 APK 中包含测试代码和资源](../Images/df74067749d0b13e9d3a968aafa047a4.png)

# asp.net-mvc - 如何在 AreaRegistration 中使用 ninject

> ID：12414109
> 
> 赞同：3
> 
> 时间：2012-09-13T20:15:48.380
> 
> 标签：asp.net-mvc, ninject, areas

我的 mvc3 项目中有一个“帐户”区域。

它有一个 AreaRegistration 类来限制仅注册用户的可见性，如下所示：

```
public class AccountAreaRegistration : AreaRegistration
{
    public override string AreaName
    {
        get
        {
            return "Account";
        }
    }

    public override void RegisterArea(AreaRegistrationContext context)
    {
        context.MapRoute(
            "Account_default",
            "{account}/{controller}/{action}/{id}",
            new {controller = "Dashboard", action = "Index", id = UrlParameter.Optional },
            new {account = new MustBeRegisteredAccount(DEPENDENCIES)},
            new string[] {"Continuum.Web.Areas.Account.Controllers"}
        );
    }
} 
```

那么如何设置 ninject 以解决 DEPENDENCIES / 创建 MustBeRegisteredAccount 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:22:33.803

我首先尝试使用构造函数注入（即，看看 MVC 是否在内部也使用注册`DependencyResolver`来创建`AreaRegistration`类的实例（还没有发现任何一种方法或另一种方法是否应该有效，但有一种非常快速的方法可以凭经验找出： D)。

如果做不到这一点，使用 a`DependencyResolver.GetService<MustBeRegisteredAccount>()`是MVC领域中的[服务定位器（反模式）解决方法。](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)（Ninject.MVC3 扩展故意不公开全局内核实例，因为这只会鼓励无偿使用）。

请参阅[http://bradwilson.typepad.com/blog/2010/10/service-location-pt5-idependencyresolver.html](http://bradwilson.typepad.com/blog/2010/10/service-location-pt5-idependencyresolver.html)

# c++ - 提高性能的 C++ 内联方法

> ID：12414110
> 
> 赞同：6
> 
> 时间：2012-09-13T20:15:55.433
> 
> 标签：c++, performance, inline

很久以前有人告诉我，通过使用关键字***inline***并在头文件中写入主体来制作通常被内联调用的简短函数/方法。这是为了优化代码，这样实际的函数调用就不会产生开销。

今天看起来怎么样？现代编译器（在这种情况下为 Visual Studio 2010）是否会自动内联这些短函数，还是自己仍然“有必要”这样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T20:26:05.927

`inline`一直是对编译器的**提示**，而如今，编译器在这方面大部分是自己做出决定的（请参阅 参考资料`register`）。

为了内联扩展函数，编译器必须看到该函数的定义。对于只在一个翻译单元中定义和使用的函数，这没问题：在使用之前将定义放在某个地方，编译器将决定是否内联该函数。

对于在多个翻译单元中使用的函数，为了让编译器看到函数的定义，定义必须放在头文件中。当您这样做时，您需要标记该函数`inline`以告诉编译器和链接器该函数有多个定义是可以的。（好吧，我想你可以制作这个函数`static`，但是你最终可能会浪费多个副本的空间）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T20:25:38.077

启用警告[C4710](http://msdn.microsoft.com/en-us/library/yd3056cz%28v=vs.80%29.aspx)，如果您定义为内联的函数没有被编译器内联，这将警告您。

启用警告[C4711](http://msdn.microsoft.com/en-us/library/k402bt7y%28v=vs.80%29.aspx)，如果编译器内联未指定用于内联的函数，这将警告您。

这两个警告的组合将使您更好地了解编译器实际上对您的代码做了什么，以及是否值得手动指定内联函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T20:24:35.660

一般来说，`inline`现在更多地使用关键字来允许您在头文件中定义函数时“违反”一个定义规则，而不是给编译器关于内联的提示。许多编译器非常擅长决定何时内联函数，只要函数体在调用点可见。

当然，如果您仅在非内联源文件中定义函数，编译器将能够将其内联在该源文件中，但不能在任何其他翻译单元中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-14T10:32:37.317

在以下情况下，编译器可以进行内联：

1.  您将函数标记为`inline`和

    1.  它在当前翻译单元或包含在其中的文件中定义；
    2.  编译器认为值得这样做。根据[MSDN](http://msdn.microsoft.com/en-us/library/z8y1yy88.aspx)

        > 该`inline`关键字告诉编译器内联扩展是*首选*。
        > 编译器将内联扩展选项和关键字视为建议。

2.  您使用了`__forceinline`关键字（或`__ attribute __((always_inline))`在 gcc 中）。这将使编译器跳过一些检查并为您进行内联。

    > 关键字覆盖了成本/收益分析，`__forceinline`而是依赖于程序员的判断。

3.  如果您通过将标志传递给编译器或链接器来打开[链接时代码生成](http://msdn.microsoft.com/ru-ru/library/xbf3tbeh%28v=vs.80%29.aspx)， Microsoft 编译器也可以执行*跨模块内联*。进行这样的优化非常聪明：尝试检查使用.`/GL``/LTCG``/LTCG`

请注意，如果您的函数是，则永远不会发生内联：

*   递归的；
*   通过指向它的指针调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T20:24:14.567

简而言之，是的，编译器将决定您的函数是否变为`inline`. 你可以检查这个问题：

[编译器是否决定何时内联我的函数（在 C++ 中）？](https://stackoverflow.com/questions/1204975/does-the-compiler-decide-when-to-inline-my-functions-in-c)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-13T20:21:13.193

是的，现代编译器将（取决于各种配置选项）自动选择内联函数，即使它们位于源文件（而不是头文件）中。使用 inline 指令可以给出提示。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-13T20:23:33.740

除了你的主要观点（在代码中放置多少内联指令对今天的编译器有用），请记住内联函数只是对编译器的提示，不一定被编译为内联。

# asp.net-mvc - 如果找到动作名称，则调用动作，如果没有调用 MVC 路由中的默认动作

> ID：12414116
> 
> 赞同：2
> 
> 时间：2012-09-13T20:16:23.727
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

这是我目前的路线

```
routes.MapRoute(
            "Default",                                              // Route name
            "{action}/{id}",                                        // URL with parameters
            new { controller = "MarketingSite", action = "index", id = "" }  // Parameter defaults
        ); 
```

所以每当我访问 domain.com/test

这将调用名为 MarketingSite 的控制器中的测试操作。

我想要实现的是当我访问 domain.com/load-from-db 并且由于我没有名为 load-from-db 的操作，我想将请求定向到特定操作和 load-from-db成为该动作的参数。在该操作中，我将根据参数从数据库中读取一些内容，然后返回一个视图。如果我指定一个存在的动作，那么它只会调用那个动作。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:59:04.203

首先注意 - 路由引擎将按照您列出的顺序应用路由，检查每个路由，如果无法匹配则继续。您当前将“默认”路由设置作为包罗万象的内容 - 如果找不到控制器，则使用“MarketingSite”，如果没有操作，则使用“索引”。如果我理解您的问题，您根本不需要“索引”操作，您想调用另一个操作，并将查询传递给该操作。

你可以试试：

```
//Look for a matching action        
routes.MapRoute(
                    "MatchAction", // Route name
                    "{action}/{id}",
                     new { controller = "MarketingSite", id = UrlParameter.Optional}                                    
                );

//With a single segment, pass that to a specific action as a parameter.
routes.MapRoute(
                    "load-from-db",  // Route name
                    "{load-from-db}", // URL with parameters
                    new { controller = "MarketingSite", action = "MyAction"}
                );

//With no segments (ex. domain.com/) use the Index on MarketingSite as default.
routes.MapRoute(
                    "Default", // Route name
                    "", // URL with parameters
                    new { controller = "MarketingSite", action = "Index"}
                ); 
```

**但是**，这些路由可能无法完全满足您的要求 - 在 MVC 中映射您的路由可能有点棘手。您应该检查这[一点](http://www.dotnetcurry.com/ShowArticle.aspx?ID=814)，并相应地设计您的路线。

希望有帮助，克里斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T23:45:40.253

覆盖控制器`HandleUnknownAction`上的方法`MarketingSite`：

```
protected override void HandleUnknownAction(string actionName) {
   // TODO: check for actionName in database
} 
```

# php - php剥离标签？

> ID：12414121
> 
> 赞同：2
> 
> 时间：2012-09-13T20:16:27.040
> 
> 标签：php, forms, math

我只是对此感到好奇，想看看它是如何工作的。

```
$number = "3/4";
echo $number; 
```

我得到 3/4 作为字符串

```
$number = 3/4;
echo $number; 
```

我得到 0.75 因为它在做数学

我很想知道是否有办法从第一个中去除“/”，并将“/”之前的数字除以“/”之后的数字，这样它就会变成 0.75 而不是 3/ 4.

我为希望他们以十进制形式输入数字的人构建表单的原因。但是，如果有人输入 3/4，我将抛出一个错误，要求他们以十进制形式输入并给他们十进制数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:20:32.730

一个简单的函数如下所示，如果需要，您也可以在其中抛出更多错误处理。

```
function makeDecimal($string)
{
   $parts = explode('/',$string);
   if(count($parts) != 2)
    //throw error here
   return intval($parts[0]) / intval($parts[1]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:20:14.633

您可以`explode()`使用“/”作为分隔符的表达式，然后对数字进行数学运算。

```
<?php
    $number = "3/4";
    $num = explode("/", $number);
    $a = $num[0];
    $b = $num[1];

    $result = ((float)$a) / ((float)$b);
    echo $result;
?> 
```

希望这可以帮助

# android - 已发布的应用程序..无法弄清楚如何找到它

> ID：12414129
> 
> 赞同：1
> 
> 时间：2012-09-13T20:16:51.907
> 
> 标签：android, publishing, locate

> **可能重复：**
> [在 Google Play 上发布应用](https://stackoverflow.com/questions/9809682/publishing-an-app-on-google-play)

我发布了我的第一个应用程序。我不知道如何找到它。这是清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" android:windowSoftInputMode="adjustPan"
 package="com.wecarepeople.hopeapp" android:versionName="1.0" android:versionCode="1">   
  <supports-screens
        android:largeScreens="true"
        android:normalScreens="true"
        android:smallScreens="true"
        android:xlargeScreens="true"
        android:resizeable="true"
        android:anyDensity="true"
        />
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.RECEIVE_SMS" />
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.RECORD_VIDEO"/>
<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_CONTACTS" />   
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />   
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.BROADCAST_STICKY" />

<application android:icon="@drawable/icon" android:label="@string/app_name"
    android:debuggable="false">
    <activity android:name=".DefaultActivity" android:label="@string/app_name" 
              android:configChanges="orientation|keyboardHidden">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

<uses-sdk android:minSdkVersion="5" /> 
```

我*假设*一切看起来：

[https://play.google.com/store/apps/details?id=com.wecarepeople.hopeapp](https://play.google.com/store/apps/details?id=com.wecarepeople.hopeapp)

应该把应用程序带给我……但事实并非如此。这意味着也许我搞砸了。这是可能的，我有时会经常搞砸……*但*我有大约 400 人希望在下周的活动中看到这个应用程序的直播……这意味着我不能指望自己弄清楚。

*帮助？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:19:32.270

你可能没有搞砸。出版不是即时的，尽管它给你的印象是即时的。等待几个小时后，我的应用程序出现在他们的网址上。

如果它在您的 Google Play 控制台中的状态为“已发布”，只需过几个小时再回来查看，它就会出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T20:19:01.153

你是多久前发表的？根据我的经验，这可能需要几个小时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T20:23:40.853

也许应用程序没有发布。检查开发人员面板并确保它有一个绿色复选标记并显示“已发布”

此外，发布的应用程序或更改通常需要几个小时才能显示在商店中。如果它已发布但没有出现，那么您所要做的就是等待。

# php - 通过 AJAX 获得奇怪的结果

> ID：12414133
> 
> 赞同：0
> 
> 时间：2012-09-13T20:17:22.320
> 
> 标签：php, javascript, jquery, ajax, database

相关：[通过Javascript / PHP查询数据库](https://stackoverflow.com/questions/12395471/query-database-through-javascript-php)

这个问题与我上面的问题有关。我将 PHP 脚本修复为我的答案之一中提到的脚本；我尝试使用`$.getJSON`无济于事。所以我坚持使用从服务器获取响应的原始方法：

```
function getDatabaseRows()
{           
    var xmlHttp = new XMLHttpRequest();

    xmlHttp.onreadystatechange = function()
    {
        if(xmlHttp.readyState == 4)
        {
          alert(xmlHttp.responseText);
        }
    }

    xmlHttp.open("POST", "myDomain.com/subDirectory/getRowCounts.php", true);
    xmlHttp.send(null);
} 
```

当警报运行时，它就像一个文本文件一样，并获取我的 PHP 脚本的全部内容。它不运行脚本，它只是从服务器上获取它的文本副本。我的脚本（在前面的问题中链接）是：

```
$rowCounts = array();

$dbhost = 'host';
$dbuser = 'host';
$dbpass = 'host';
$dbase  = 'host';

$fields = array(
    'MaxTID' => array('tab' => 'TransData',      'col' => 'TID'),
    'MaxSID' => array('tab' => 'FullData',       'col' => 'SID'),
    'MaxFID' => array('tab' => 'SalamanderData', 'col' => 'FID'),
    'MaxOID' => array('tab' => 'OthersData',     'col' => 'OID')
  );

$con = mysql_connect($dbhost, $dbuser, $dbpass) or die('Error connecting to mysql');
mysql_select_db($dbase, $con) or die(mysql_error());

foreach ($fields as $id => $info) {
  $sql = "SELECT MAX({$info['col']}) FROM {$info['tab']}";
  $result = mysql_query($sql, $con);
  if (!$result) die('Could not query:' . mysql_error());
  $rowCounts[$id] = mysql_result($result, 0);
    }

echo json_encode($rowCounts);

mysql_close($con); 
```

关于为什么我的 AJAX 脚本会在服务器上返回 PHP 脚本的文本副本的任何线索；而不是我正在寻找的 JSON 结果？

编辑：

将我的浏览器指向 PHP 脚本会返回：

`{"MaxTID":"1","MaxFID":null,"MaxSID":"3","MaxOID":"1"}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:24:16.057

$.getJSON 是 jQuery，所以你需要将它包含在你的页面中：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script>
$.getJSON('http://myDomain.com/subDirectory/getRowCounts.php', function(response) {
    console.log(response);
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:28:40.900

Javascript 将拉下 http 服务器提供的任何内容。因此，如果 http 服务器未正确配置为处理您的服务器端脚本 IE php，那么您将获取文件的内容，而不是运行 php 脚本时处理的 html 输出。请联系您的服务器管理员进行修复，并确认您在文件上使用的是 .php 扩展名，而不是 .txt。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T20:46:27.983

找到了解决方案。

问题出在我正在研究一个`network share drive`......它也恰好生活在`web server`.

因此，每当我去测试脚本时，它都会像这样获取我的文件：

`file:////mySubDomain.myDomain.com/getRowCounts.php`...考虑到服务器没有提供服务，这显然行不通。

`file:////`通过更改为修复`http://`

# c - 选择函数行为 - 多客户端测验

> ID：12414138
> 
> 赞同：0
> 
> 时间：2012-09-13T20:17:48.333
> 
> 标签：c, sockets, networking, network-programming, application-layer

我必须构建一个测验应用程序。

**申请详情：**
1\. 每个客户必须先注册到服务器才能参加测验。服务器将询问每个用户的用户名并为每个用户生成临时 ID。
2\. 注册成功的客户端，成功连接到服务器的客户端会从服务器获取问题。
3\. 客户将给予答复。
4\. 服务器将收到来自不同客户端的带有时间戳的应答，并计算每个客户端的时间差，称为Δt。

```
 Define such as:  
    ∆t = (Time Question sent - Time answer received) - RTT  
    Where RTT is Round Trip Time 
```

1.  服务器将选择 Δt 最小的客户端，并回复客户端将获得的任何分数，剩下的将不会获得任何分数。
2.  发送问题后，服务器将等待一个特定的时间段（T）的回答。如果客户端在“T”时间段内没有回复，服务器将跳过该问题并转到下一个问题。

**我的服务器代码中主循环的伪代码**

```
A. A main while loop which runs once for each question.  
B. Inside this first I am accepting login for 10 seconds.  
       Here I am assigning user Id and all other initialization stuff.  
C. Then using `select` to check which are available for writing.
       To available connections I am checking `RTT` and then sending question to each user.
D. Then I am waiting for some time to get answers.
       Here I am using `select` to determine where the answer is available to read.
E. Then I am repeating steps C. and D. 
```

**问题**：
当我只连接到一个客户端时，我的代码对于任何数量的问题都可以正常工作。
但是，当我使用相同的客户端代码在多个客户端上测试此代码时：

*   每个人都可以登录。
*   将第一个问题发送给每个人都可以正常工作。
*   **然后在等待答案时，我只收到了一位客户的答复。每个客户端都显示已发送答案。对于第二个客户端，第二个`select`函数不会返回可读数据可用性。**

*为什么对于多客户端我的代码不起作用。（据我说，错误是在某个地方得到答案）。*

***我的代码***：
*从变量名可以很容易地理解发送的数据包的结构。*

**服务器.c**：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <error.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <netdb.h>
#include <arpa/inet.h>
#include <sys/wait.h>
#include <signal.h>
#include <time.h>

#define PORT "3490" //the port user will be connecting to
#define BACKLOG 10  //how many pending connection queue will hold
#define maxUser 10
#define LOGIN_OK "OK"
#define LOGIN_WrongPassword "NP"
#define LOGIN_WrongUsername "NU"
#define MAX_USERS 10
#define MAX_ANSWER_TIME 10
#define LOGIN_WAIT 10
#define TOTAL_QUES "3"

int users[MAX_USERS][3] = {};  //index is userID, 0 is no user

void sigchld_handler(int s)
{
    while(waitpid(-1, NULL, WNOHANG) > 0);
}

//get sockaddr, IPv4 or IPv6

int timer;
void alarm_handler(int s) {
    timer = 0;
}

wrongRecv(ssize_t recvd, ssize_t expctd)
{

    if(recvd != expctd)
    {
        printf("Recvd(%zd) bytes not equal to expected(%zd) bytes\n",recvd,expctd);
        //getchar();
    }
}

//void nextQues(char* quesMsg, char* ques, char* optA, char* optB, char* optC, char* optD)
int nextQues(char* quesMsg, int QID)
{
    char ques[40], optA[10], optB[10], optC[10], optD[10], quesId[5];

    sprintf(quesId,"%d",QID);
    strncpy(ques, "This is the question?",22);
    strncpy(optA, "OptionA", 7);    strncpy(optB, "OptionB", 7);    strncpy(optC, "OptionC", 7);    strncpy(optD, "OptionD", 7);
    strncpy(quesMsg,quesId,5);
    strncpy(quesMsg + 05,ques,40);
    strncpy(quesMsg + 45,optA,10);
    strncpy(quesMsg + 55,optB,10);
    strncpy(quesMsg + 65,optC,10);
    strncpy(quesMsg + 75,optD,10);

    return 0;
}

//void answerCheck(char* ques, char* optA, char* optB, char* optC, char* optD, char* usrResponse, int rtt, int timeTaken)
void answerCheck(int fd, char usrResponse[6], int rtt, int timeTaken)
{
    int responseTime, i;
    char actualAnswer[1];
    char quesId[5];
    printf("fd(%d) quesid(%s) response(%c) rtt(%d) timeTaken(%d)\n", fd, usrResponse, usrResponse[5], rtt, timeTaken );
    strncpy(quesId, usrResponse, 5);
    actualAnswer[0] = 'B';//we have quesId we can find actual answer on basis of it

    if(actualAnswer[0] == usrResponse[5])
    {
        //printf("%s\n","+++++" );
        responseTime = timeTaken - rtt;
        //printf("Response Time(%d)\n",responseTime);

        //save it with user id

        //finding userid
        for(i = 0; i < MAX_USERS; i++) {
            if(users[i][1] == fd) {
                users[i][2] = responseTime;//saving it
                //printf("%d\n",i );
            }
        }
    }
}

int compareAnswer() {
    int i, min = 2 * MAX_ANSWER_TIME, userIndex;
    for(i = 0; i < MAX_USERS; i++) {
        if(users[i][2] < min) {
            min = users[i][2];
            userIndex = i;
        }
    }
    //Increasing Score
    users[userIndex][0]++;

    //returning fd
    return users[userIndex][1];
}

void users_deleteFd(int fd) {
    int i;
    for (i = 0; i < MAX_USERS; ++i)
    {
        if(users[i][1] == fd) {
            users[i][1] =0;
            return;
        }
    }
}

int rtt_check(int new_fd)
{
    ssize_t send_ret, recv_ret;
    char rtt_check[1];
    time_t rtt1, rtt2;

    rtt1 = time(NULL);
    send_ret = send(new_fd, "r", 1, 0);
    if(send_ret == 0)
    {
        return -2;
    }
    wrongRecv(send_ret, 1);
    //printf("%s\n","Between two phase of rttCheck" );
    recv_ret = recv(new_fd, rtt_check, 1,0);
    rtt2 = time(NULL);
    if(recv_ret == 0)
    {
        return -2;
    }
    wrongRecv(recv_ret,1);
    //printf("diff(%d)\n",(int) difftime(rtt2,rtt1));

    return  (int) difftime(rtt2,rtt1);
}

int login(char user[], char pass[])
{
    //for user
    static int Id = 0; //when have function getUserID, make it not static and also remove Id++;
    if(!strcmp(user,"abhishek") && !strcmp(pass,"abhishek")) {
        //Id = getUserID(user);
        return ++Id;
    }else if(!strcmp(user,"abhishek")){
        return 0; //wrong password
    }
    return -1; //wrong username
}

int totalQues;

int login_setup(int new_fd)
{
    //login inititalizations
    char login_det[16];
    char username[9],password[9], login_statMsg[7], totalQuesMsg[5] = TOTAL_QUES;
    totalQues = atoi(totalQuesMsg);
    //for user
    int userId;

    //for wrongRecv
    ssize_t send_ret,recv_ret;

    //getting username and password
    recv_ret = recv(new_fd,login_det,16,0);
    if(recv_ret == 0)
    {
        return -2;
    }
    wrongRecv(recv_ret,16);

    //extracting username nad password
    strncpy(username,login_det,8);  
    strncpy(password,login_det+8,8);
    username[8]='\0'; password[8]='\0';
    //printf("username(%s) and password(%s)\n",username,password);

    if( (userId = login(username,password)) > 0) {
        //printf("%d\n",userId);

        //sending status
        strncpy(login_statMsg, LOGIN_OK, 2);
        strncpy(login_statMsg + 2, totalQuesMsg , 5);
        send_ret = send(new_fd, login_statMsg,7,0);
        if(send_ret == 0)
        {
            return -2;
        }
        wrongRecv(send_ret,7);

        //TODO error checking then handling if error

        //users[userId][0] = 0; //score
        users[userId][1] = new_fd; //file descriptor associated with this user
        //users[userId][2] = 0; //answer time
        return 1;
    }
    else if(userId == -1) { //wrong username
        strncpy(login_statMsg, LOGIN_WrongUsername, 2);
        strncpy(login_statMsg + 2, totalQuesMsg , 5);
        send_ret = send(new_fd, login_statMsg,7,0);
        if(send_ret == 0)
        {
            return -2;
        }
        wrongRecv(send_ret,7);
        return 0;
    }
    else{
        strncpy(login_statMsg, LOGIN_WrongPassword, 2);
        strncpy(login_statMsg + 2, totalQuesMsg , 5);
        send_ret = send(new_fd, login_statMsg,7,0);
        if(send_ret == 0)
        {
            return -2;
        }
        wrongRecv(send_ret,7);      
        return 0;
    }
    //TODO erorr handling of above two case
    //TODO make login a loop
}

void *get_in_addr(struct sockaddr *sa)
{
    if (sa->sa_family == AF_INET) {
        return &(((struct sockaddr_in*)sa)->sin_addr);
    }

    return &(((struct sockaddr_in6*)sa)->sin6_addr);
}

int main(void)
{
    int listen_fd, new_fd; // listen on sock_fd, new connection on new_fd
    struct addrinfo hints, *servinfo, *p;
    struct sockaddr_storage their_addr;//connection's address info
    socklen_t sin_size;
    int yes=1;
    char s[INET6_ADDRSTRLEN];
    int rv;

    memset(&hints, 0, sizeof hints);
    hints.ai_family = AF_UNSPEC;//IPv4 or IPv6
    hints.ai_socktype = SOCK_STREAM;
    hints.ai_flags = AI_PASSIVE; // use my IP

    if((rv = getaddrinfo(NULL,PORT, &hints, &servinfo)) != 0){ //getting which IPv server supports
        fprintf(stderr, "getaddrinfo: %s\n",gai_strerror(rv));
        return 1;
    }

    //loop through all the result and bind to the first we can
    for(p = servinfo; p != NULL; p  = p->ai_next){
        if((listen_fd = socket(p->ai_family, p->ai_socktype, p->ai_protocol)) == -1){
            perror("server : socket");
            continue;
        }

        if(setsockopt(listen_fd, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(int)) == -1){
            perror("set sockopt");
            exit(1);
        }

        if(bind(listen_fd, p->ai_addr, p->ai_addrlen) == -1){
            close(listen_fd);
            perror("server: bind");
            continue;
        }

        break;
    }

    if(p == NULL) {
        fprintf(stderr, "server:failed to bind\n");
        return 2;
    }

    freeaddrinfo(servinfo);//all done with this structure

    if(listen(listen_fd, BACKLOG) == -1){
        perror("listen");
        exit(1);
    }
    //printf("listen_fd(%d)\n",listen_fd );

//  sa.sa_handler = sigchld_handler; // reap all dead processes
//  sigemptyset(&sa.sa_mask);
//  sa.sa_flags = SA_RESTART;
//  if(sigaction(SIGCHLD, &sa, NULL) == -1){
//      perror("sigaction");
//      exit(1);
//  }

    printf("server waiting for connections.....\n");

    fd_set master; //master file descriptor list
    fd_set read_fds; //temp file descriptor list for select()
    int fdmax;
    FD_ZERO(&master); //clear the master and temp sets
    FD_ZERO(&read_fds);

    FD_SET(listen_fd, &master);

    //keep track of the bigge file descriptor
    fdmax = listen_fd; // so far it is this one

    ssize_t recv_ret, send_ret;

    //for login
    int loginStatus;
    struct sigaction sa;
    sa.sa_handler = alarm_handler;
    sigemptyset(&sa.sa_mask);
    //sa.sa_flags = SA_RESTART;
    if(sigaction(SIGALRM, &sa, NULL) == -1){
        perror("sigaction");
        exit(1);
    }

    //login while
    alarm(LOGIN_WAIT);//accepting login only for 10 seconds
    timer = 1;
    printf("\n-----------------------------Waiting for users to login for %d seconds.-----------------------------\n",LOGIN_WAIT);
    while(timer) {
        sin_size = sizeof their_addr;
        new_fd = accept(listen_fd, (struct sockaddr *)&their_addr, &sin_size);
        if(new_fd == -1){
            //perror("accept");
            break;// this break is very important , as we are using alarm(Signals) and accept is a blocking function
                    //If accept is in blocked sate and our signal comes then accept will exit returning error. So
                    //if error then we have to break else next satements will run on falsy values.
                    //In reality we dont need this as I alredy set the SA_RESTART flag in sigaction which means
                    //after returning from the signal handler restart the activity on which you are previously
                    //instead of starting execution from next line.
        }else {

            inet_ntop(their_addr.ss_family, get_in_addr((struct sockaddr *)&their_addr), s, sizeof s);
            printf("server : got connection from %s\n", s);

            //LOGIN     //need to call login function via thread because this 
                            //may stop the function if user doesnot respond
            loginStatus = login_setup(new_fd);

            //adding to select checkup
            if(loginStatus) {
                printf("User Loginned Succesfully\n");
            }
        }
    }
    printf("-----------------------------Login Closed. Now starting the QUIZ.-----------------------------\n");

    //for randome seek
    srand(time(NULL));

    //for main loop counter
    int i, win_fd;

    //for questions
    int QID = 0;
    int maxQues_Len = 40, maxOpt_len = 10, maxQuesId_len = 5;//including '\0' this time
    char quesMsg[80], answer[6];//score doesnot include \0
    //char ques[40], optA[10], optB[10], optC[10], optD[10];

    //for time calculation of each answer
    ssize_t time_ques, time_ans;

    //getting all avialable participants
    fdmax = 0;
    FD_ZERO(&master);
    for(i = 0; i < MAX_USERS; i++) {
        if( (new_fd = users[i][1]) != 0){
            FD_SET(new_fd, &master);
            if(new_fd > fdmax)
                fdmax = new_fd;
            //printf("%d\n",new_fd);
        }
    }

    int current_rtt;
    //while for main quiz
    while(totalQues--) {

        //checking who are ready for witing
        if(select(fdmax+1, NULL, &master, NULL, NULL) == -1){//here select will return withh all the descriptors which are 
                                                                //ready to write , all others have to miss this question
            perror("select");
            exit(1);
        }

        //setting which question to send
        QID++;

        //for sending questions to all
        for(i = 0; i <= fdmax; i++) {
            if(FD_ISSET(i, &master)) {
                //rtt check
                current_rtt = rtt_check(i);
                if(current_rtt == -2) {//connection closed
                    FD_CLR(i, &master);
                    users_deleteFd(i);
                    continue;
                }
                //setting question
                //nextQues(quesMsg, ques, optA, optB, optC, optD);
                nextQues(quesMsg, QID);
                printf("Sending Question QID(%s) fd(%d)\n",quesMsg,i);
                //send a question
                time_ques = time(NULL);
                send_ret = send(i, quesMsg, maxQues_Len + 4 * maxOpt_len + maxQuesId_len, 0);
                if(send_ret == 0) {//connection closed
                    FD_CLR(i, &master);
                    users_deleteFd(i);
                    continue;
                }
                wrongRecv(send_ret, maxQues_Len + 4 * maxOpt_len + maxQuesId_len);  
            }
        }

        //ASSUMING Question is send ot all the users at same time       
        //receiving and waiting for answers
        alarm(MAX_ANSWER_TIME);
        timer = 1;
        FD_ZERO(&read_fds);
        read_fds = master;
        // unsigned int qq = read_fds.fd_count;
        // for (int ii = 0; ii < qq; ++ii)
        // {
        //  printf("%d\n",read_fds.fd_array[i] );
        // }
        while(timer) {
            //printf("HURRAY\n");
            if(select(fdmax+1, &read_fds, NULL, NULL, NULL) <=0){
                perror("select");
                //exit(4);
                break;//break is important. Explained above
            }

            for(i = 0; i <= fdmax; i++) {
                //printf("Recving answer I(%d)\n",i);
                if(FD_ISSET(i, &read_fds)) {
                    //receiving answer
                    //TODO if we get answer to wrong ques
                    printf("Recving answer I(%d) fdmax (%d)\n",i,fdmax);
                    recv_ret = recv(i,answer,6,0);
                    time_ans = time(NULL);
                    wrongRecv(recv_ret,6);
                    printf("%s\n",answer );
                    if(recv_ret == 0)//connection closed
                    {
                        FD_CLR(i, &read_fds);
                        FD_CLR(i, &master);
                        users_deleteFd(i);
                        continue;
                    }else if(recv_ret > 0){
                        if(QID == atoi(answer)) { //we have received the answer to this question so remove the user from wait answer loop
                            FD_CLR(i, &read_fds);
                            //printf("%s i(%d)\n","#######",i );
                            answerCheck(i ,answer, current_rtt, (int) difftime(time_ans,time_ques));
                            //printf("Answer(%c)\n",answer[0]);
                        }
                        else{//we have recvd something unexpectable so ignore for NOW

                        }
                    }

                    //time_t cccc = time(NULL);
                    //printf("%s I(%d)\n",ctime(&cccc),i);
                }
            }
        }
        //comparing answers
        win_fd = compareAnswer();
        //sending score
    }
    return 0;
} 
```

**客户端.c**：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <netdb.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <sys/socket.h>
#include <arpa/inet.h>

#define PORT "3490" //the port client will be connecting to

#define MAXDATASIZE 100 // max number of bytes we can get at once

//get sockaddr ,IPv4 or IPv6:
void *get_in_addr(struct sockaddr *sa)
{
    if(sa->sa_family ==AF_INET) {
        return &(((struct sockaddr_in*)sa)->sin_addr);
    }

    return &(((struct sockaddr_in6*)sa)->sin6_addr);
}

wrongRecv(ssize_t recvd, ssize_t expctd)
{

    if(recvd != expctd)
    {
        printf("Recvd(%zd) bytes not equal to expected(%zd) bytes\n",recvd,expctd);
        getchar();
    }
}

void rtt_check(int sockfd)
{
    ssize_t send_ret, recv_ret;
    char rtt_check[1];
    recv_ret = recv(sockfd, rtt_check, 1,0);
    wrongRecv(recv_ret,1);
    sleep(1);//to check
    send_ret = send(sockfd, "r", 1, 0);
    wrongRecv(send_ret, 1);

    return;
}

int main(int argc, char *argv[])
{
    int sockfd, numbytes;
    char buf[MAXDATASIZE];
    struct addrinfo hints, *servinfo, *p;
    int rv;
    char s[INET6_ADDRSTRLEN];

    if(argc != 2) {
        fprintf(stderr,"usage: client hostname\n");
        exit(1);
    }

    memset(&hints, 0, sizeof hints);
    hints.ai_family = AF_UNSPEC;
    hints.ai_socktype = SOCK_STREAM;

    if((rv = getaddrinfo(argv[1], PORT, &hints, &servinfo)) != 0) {
        fprintf(stderr,"getaddrinfo: %s\n",gai_strerror(rv));
        return 1;
    }

    //lopp through all the results and connect to the first we can
    for(p = servinfo; p != NULL; p = p->ai_next) {
        if((sockfd = socket(p->ai_family, p->ai_socktype, p->ai_protocol)) == -1){
            perror("client: socket");
            continue;
        }

        if(connect(sockfd, p->ai_addr, p->ai_addrlen) == -1){
            close(sockfd);
            perror("client: connect");
            continue;
        }

        break;
    }

    if(p ==NULL) {
        fprintf(stderr,"client: failed to connect\n");
        return 2;
    }

    inet_ntop(p->ai_family, get_in_addr((struct sockaddr *)p->ai_addr), s, sizeof s);
    printf("client : connecting to %s\n", s);

    freeaddrinfo(servinfo); // all done with this structure
    char login_det[17] = "abhishekabhishek";
    char login_retMsg[7], login_stat[3], totalQuesMsg[5];
    int totalQues;

    //sending login details
    ssize_t send_ret,recv_ret;
    send_ret = send(sockfd, login_det,16,0);
    wrongRecv(send_ret,16);

    //receiving login status
    recv_ret = recv(sockfd,login_retMsg,7,0);
    wrongRecv(recv_ret,7);

    strncpy(login_stat, login_retMsg, 2);
    login_stat[2] = '\0';
    printf("Login Status(%s)\n",login_stat);
    strncpy(totalQuesMsg, login_retMsg + 2, 5);
    totalQues = atoi(totalQuesMsg);
    printf("totalQues(%d)\n",totalQues);

    if(!strcmp(login_stat,"OK")) {  //login ok
        char quesId[5];
        int maxQues_Len = 40, maxOpt_len = 10, maxQuesId_len = 5;//including '\0' this time
        char quesMsg[80], scoreMsg[1];//score doesnot include \0
        char ques[40], optA[10], optB[10], optC[10], optD[10];
        char answer[6];

        while(totalQues--) {
            //checking rtt
            rtt_check(sockfd);
            //receving question
            recv_ret = recv(sockfd, quesMsg,  maxQues_Len + 4 * maxOpt_len + maxQuesId_len ,0);
            wrongRecv(recv_ret,  maxQues_Len + 4 * maxOpt_len + maxQuesId_len);
            strncpy(quesId,quesMsg,5);
            strncpy(ques, quesMsg + 05, 40);
            strncpy(optA, quesMsg + 45, 10);
            strncpy(optB, quesMsg + 55, 10);
            strncpy(optC, quesMsg + 65, 10);
            strncpy(optD, quesMsg + 75, 10);
            printf("QUESID(%s) Question(%s), A(%s) , B(%s) , C(%s) , D(%s)\n", quesId, ques, optA, optB, optC, optD);

            //choose answer
            scoreMsg[0] = 'B';

            strncpy(answer,quesId, 5);
            answer[5] = scoreMsg[0];
            sleep(5);

            //sending answer
            send_ret = send(sockfd, answer,6,0);
            wrongRecv(send_ret,6);
            printf("%s\n","Answer Message Sent" );

            // if((numbytes = recv(sockfd, buf, MAXDATASIZE-1, 0)) == -1) {
            //  perror("recv");
            //  exit(1);
            // }

            // buf[numbytes] = '\0';

            // printf("client: received '%s'\n",buf);
        }
    } 
    //TODO wrong login
    close(sockfd);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:40:31.370

问题是答案获取循环中的调用`select`正在修改`read_fds`为仅保存第一个要响应的客户端的文件描述符。`read_fds`由于您在再次调用之前没有重置`select`，因此它不会识别其他客户端的响应。

# php - SQL Like 只接受“上下文”

> ID：12414143
> 
> 赞同：0
> 
> 时间：2012-09-13T20:17:58.160
> 
> 标签：php, mysql, sql, codeigniter

嗨，我的数据库查询有问题。

```
$q = $this->db->query("SELECT * FROM (`knihy`) 
                      WHERE `stav` = 1 
                      AND (Autor1 LIKE '$vyraz' 
                      OR Autor2 LIKE '$vyraz' 
                      OR Autor3 LIKE '$vyraz' 
                      OR Autor4 LIKE '$vyraz') 
                      ORDER BY `id` desc LIMIT $limit OFFSET $offset "); 
```

问题是，当我搜索“lorem”时，我的表中有例如 Autor1 行内容：“lorem ipsum”什么都找不到。但是，如果我正在搜索 lorem ipsum，将会找到那些字段。请问哪里有问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T20:19:40.627

您没有为 LIKE 使用正确的语法：

```
Autor1 LIKE '$vyraz' 
```

应该：

```
Autor1 LIKE '%$vyraz%' 
```

没有通配符，您只是在进行完全匹配。

# jquery - 防止双击缩略图以确保内容不会通过 AJAX 加载两次

> ID：12414147
> 
> 赞同：2
> 
> 时间：2012-09-13T20:18:26.680
> 
> 标签：jquery, ajax, click, bind, unbind

我有一个 jquery 函数，当我点击帖子缩略图时，它会加载帖子内容，效果很好。但是如果我点击两次，内容就会被加载两次。

我在某处读到需要取消绑定单击并在内容完成加载后将其绑定回来。这是我的尝试。

现在似乎`event.preventDefault();`get deactivate 或某些东西，因为它在第二次点击时加载了完整的页面（而不是 AJAX 内容）。

```
$("a.ajaxed").on("click",function(event) {
    event.preventDefault();
    var self = this,
   // ...; other variables
    $(self).unbind("click"); // code line added 1of2
    $("#streamwrapper").fadeOut(1000, function(){
        $.ajax({
            type: "POST",
            dataType: "JSON",
            url: ajax_object.ajaxurl,
            data: ({
                action : "get_all_images",
                post_id: postid
                }),
            success:function(data){
                $("#board").append(postdiv);
                $("#post-container").append(data);
                postdiv.fadeIn(1000);
                $(self).bind("click"); // code line added 2of2
            },
            error:function(data){
                console.log(data);
            }
        });
    });
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:23:33.927

我总是做的是使用`$(this).data`. 该函数首先检查是否设置了此标志，如果是则返回，否则设置标志并在成功时将其清除。以下应该做你想要的：

```
$("a.ajaxed").on("click",function(event) {
   // ...; other variables

   var self = this; // needed for $(self).removeData below

   if ($(self).data('executing')) // if we're executing, return
       return;

    $(self).data('executing', true); // set executing flag

    $("#streamwrapper").fadeOut(1000, function(){
        $.ajax({
            type: "POST",
            dataType: "JSON",
            url: ajax_object.ajaxurl,
            data: ({
                action : "get_all_images",
                post_id: postid
                }),
            success:function(data){
                $("#board").append(postdiv);
                $("#post-container").append(data);
                postdiv.fadeIn(1000);

                $(self).removeData('executing'); // clear the executing flag
            },
            error:function(data){
                console.log(data);
            }
        });
    });
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:22:08.533

您实际上可以尝试使用 beforeSend 和 complete 事件来绑定和取消绑定事件。这样可以确保按钮在发送 Ajax 后立即没有事件。

```
var clickEvent = 
    $("a.ajaxed").on("click",function(event) {
    var self = this,

    $("#streamwrapper").fadeOut(1000, function(){
        $.ajax({
            type: "POST",
            dataType: "JSON",
            url: ajax_object.ajaxurl,
            data: ({
                action : "get_all_images",
                post_id: postid
                }),
            success:function(data){
                $("#board").append(postdiv);
                $("#post-container").append(data);
                postdiv.fadeIn(1000);
            },
            error:function(data){
                console.log(data);
            },
            beforeSend: function() {
            $(self).unbind("click"); // code line added 1of2
            }, 
            complete: function() {
                clickEvent();
            }
        });
    });
    return false;
}); 
```

# google-app-engine - Google App Engine 中的查询/数据存储问题 - Go API

> ID：12414148
> 
> 赞同：1
> 
> 时间：2012-09-13T20:18:30.700
> 
> 标签：google-app-engine, google-cloud-datastore, go

我正在使用 Go API 使用 Google App Engine，尽管我已经尝试了一切，但我无法让[查询](https://developers.google.com/appengine/docs/go/datastore/reference#Query)返回数据存储区中的数据。我可以看到[Put()](https://developers.google.com/appengine/docs/go/datastore/reference#Put)可以按预期工作，并且通过检查可用的管理控制台可以列出/访问实体`dev_appserver.py`

我存储的结构是这样定义的：

```
type TweetData struct {
    Id int64 `datastore:",noindex" json:"id"`
    Text string `datastore:",noindex" json:"text"`
    Screen_name string `json:"screen_name"`
} 
```

我的查询电话是这样的：

```
func getDatastoreTweets(c appengine.Context, twitterUser string) []*TweetData {
    q := datastore.NewQuery("TweetData").Filter("Screen_name =", twitterUser).Order("-Id").Limit(10)

    var oldTweets []*TweetData
    if _, err := q.GetAll(c, &oldTweets); err != nil {
        fmt.Printf("Getall had non-nil error! %v\n", err)
    }   

    return oldTweets
} 
```

对于这个查询，`err`永远不会是非零，但总是返回 0 个结果，即使控制台告诉我有很多结果。在 SDK 提供的留言簿示例之后，我也尝试过没有[过滤器](https://developers.google.com/appengine/docs/go/datastore/reference#Query.Filter)调用，但无济于事。

如果是键的问题（如果我理解正确，不太可能，因为我正在查询一个属性），调用`Put`如下：

```
// tweetData passed in via parameter...
key := datastore.NewIncompleteKey(c, "TweetData", nil)
_, err := datastore.Put(c, key, &tweetData) 
```

任何帮助将不胜感激，谢谢！^_^

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T15:43:26.350

查询要求按 排序`Id desc`，而索引字段未编入索引，您应该：

*   将 TweetData 注释重写为索引 Id 字段：

`Id int64 `json:"id"``

*   删除查询的 Order 子句：

`q := datastore.NewQuery("TweetData").Filter("Screen_name =", twitterUser).Limit(10)`

# jquery - jQuery width() 方法性能

> ID：12414150
> 
> 赞同：2
> 
> 时间：2012-09-13T20:18:51.540
> 
> 标签：jquery, performance

我是一个 jQuery 菜鸟，试图追踪我们在使用大表时遇到的性能问题。我们有一个自制的表格小部件，除其他外，它将列宽设置为标题宽度或行宽的最大值。

对于 10 行 x 500 列的表格，这可能需要将近 40 秒（！），考虑到表格可以在一秒钟内呈现出来，这似乎太长了。

这是整个功能：

```
 var dataTable = this._div.find('.data-table');
  var headerTable = this._div.find('.data-header-table');
  if (dataTable.length === 0 || headerTable.length === 0) {
    return;
  }
  dataTable = dataTable[0];
  headerTable = headerTable[0];

  if (dataTable.rows.length === 0) {
    return;
  }

  var dataTr = dataTable.rows[0];
  var headerTr = headerTable.rows[headerTable.rows.length - 1];

  var marginColumnWidths =
    $(dataTr.cells[0]).outerWidth(true) +
    $(dataTr.cells[1]).outerWidth(true) +
    $(dataTr.cells[2]).outerWidth(true) -
    DOM.getHPaddings($(headerTr.cells[0])) + 1;

  $(headerTable)
    .find('> tbody > tr > td:first-child')
    .width('1%')
    .children()
      .first()
      .width(marginColumnWidths);

  for (var i = 1; i < headerTr.cells.length; i++) {
    var headerTd = $(headerTr.cells[i]);
    var dataTd = $(dataTr.cells[i + 2]);
    var commonWidth = Math.max(
      Math.min(headerTd.width(), 100),
      dataTd.width()
    );
    headerTd.width('1%').find('> div').width(commonWidth);
    dataTd.children().first().width(commonWidth);
  } 
```

如果我更换

```
 var commonWidth = Math.max(
      Math.min(headerTd.width(), 100),
      dataTd.width()
    ); 
```

有一个常数

```
 var commonWidth = 100; 
```

执行时间从 38 秒下降到不到一秒，这表明问题在于读取/计算当前宽度而不是设置新宽度。从我所做的分析/采样来看，jQuery 似乎花费了过多的时间来处理 CSS 计算。

谁能推荐一种更有效的方法来做到这一点？

编辑：

我已经尝试了 css("width") 和 outerWidth() ，但性能没有任何显着变化。我们使用的是 jQuery 1.7.2，但升级到 1.8.1 并没有显着改变性能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-13T20:24:23.413

使用`.css("width")`而不是`.width()`，对`.width()`方法进行了更改，使其执行速度变慢。阅读此内容以获取更多信息：[http ://blog.jquery.com/2012/08/16/jquery-1-8-box-sizing-width-csswidth-and-outerwidth/](http://blog.jquery.com/2012/08/16/jquery-1-8-box-sizing-width-csswidth-and-outerwidth/)

```
var commonWidth = Math.max(
  Math.min(parseFloat(headerTd.css("width")), 100),
  dataTd.width()
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T20:44:30.517

据我所知 -`.width()`正在采用实际宽度（并不总是在 css 中设置）并得到它 - 浏览器必须计算它（强制页面重绘和宽度计算本身）。现在，您正在设置宽度，浏览器需要重绘所有内容。它可能会稍有延迟，但在下一步中您将再次获取宽度 - 浏览器必须重绘页面以获得真正的宽度。首先计算宽度，然后 - 在另一个循环中，设置计算值。我认为这应该有帮助

**编辑**：

[与Kelvin B](https://stackoverflow.com/users/400654/kevin-b)方法相比，对此进行了测试。差异不显着。看起来最好的是使用 css("width") 时。这是测试：嗯。测试了这个。与我建议的方法相比。看来差别不大。这里是测试： [宽度一循环](http://jsperf.com/width-test)，[CSS宽度一循环](http://jsperf.com/width-test-2)，[CSS二循环](http://jsperf.com/width-test-3)，[宽度二循环](http://jsperf.com/width-test-4)。结果 - 几乎没有区别。最慢的 - “宽度一个循环”。最快的 - 其中之一`css`。对我来说时不时地不同。

**注意：**四个不同的测试，因为看起来 js perf 不会清除测试用例之间的 html 状态。

不知道在你的情况下可以做什么，但我觉得奇怪的是 `.width('1%')`你正在使用。对我来说，您似乎不需要它，所以也许您可以尝试将其删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-29T23:16:42.453

如果您在非常大的表格的表格单元格（或标题）上执行 .width（以及 .css("width")），则隐藏元素需要花费大量时间！！！，并且对于可见元素非常快。原因是，如果元素是隐藏的，浏览器会很好而且高效，如果元素是可见的，浏览器并没有做出任何努力来找出宽度*是多少。*但是，对于隐藏元素，jQuery 的 .width 显然会返回宽度（如果它是可见的），而不是仅仅返回零（它是隐藏的）。对于大表，这意味着浏览器必须再次呈现整个表。如果表真的很大，它可能需要一秒钟。如果你对多个隐藏的列（只是测量它们的宽度）这样做，你的页面就会变得毫无用处。

所以除非你真的需要知道，否则不要测量隐藏元素的宽度。

相关链接，重复我刚才所说的（以及更多）：[这里](https://github.com/jquery/jquery/issues/2108)

# comments - wordpress 在 comment_template() 之前插入内容

> ID：12414154
> 
> 赞同：0
> 
> 时间：2012-09-13T20:19:03.287
> 
> 标签：comments, wordpress

我正在尝试将内容注入到 comment_template() 中，类似于使用 comment_form() 的方式。

例如：

```
<?php
$args = array("comment_notes_before" => myrp_api_ratings_form_table(null, true));
comment_form($args);
?> 
```

这将使 myrp_api_ratings_form_table 函数返回的内容出现在评论表单之前，而不是在提交按钮之后。

有没有办法做类似的事情，但使用 comment_template() 函数？我试着看一下手抄本，但没有运气。此外，是否有任何好的链接可以进一步修改 comment_template() 的输出？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:55:21.717

comment_template 上有很多可用的操作和过滤器，您可以使用它们来修改模板，或者只是构建自己的模板。以下是所有可用过滤器和操作的列表：http: [//codex.wordpress.org/Plugin_API/Filter_Reference#Comment.2C_Trackback.2C_and_Ping_Filters](http://codex.wordpress.org/Plugin_API/Filter_Reference#Comment.2C_Trackback.2C_and_Ping_Filters)

编辑：

这只会更改每个评论的数据。如果你想改变真实模板的显示和结构，我想你必须创建自己的模板。但这并不像听起来那么难，法典中有一个很好的指南，里面有一些很好的例子：[http ://codex.wordpress.org/Function_Reference/wp_list_comments](http://codex.wordpress.org/Function_Reference/wp_list_comments)

# mongodb - Mongodb 日期延迟 1 小时

> ID：12414158
> 
> 赞同：4
> 
> 时间：2012-09-13T20:19:17.987
> 
> 标签：mongodb

我在 ubuntu 服务器上运行 mongodb。服务器时间是

```
root# date
Thu Sep 13 21:15:58 BST 2012 
```

但是当我运行以下命令时，我得到了不同的结果

```
root# mongo
MongoDB shell version: 2.2.0
connecting to: test
> new Date()
ISODate("2012-09-13T20:15:58.670Z") 
```

正好相差一小时。`updated_on`当我使用 php更新文档字段时`MongoDate()`，该字段的值仍然是 1 小时。

[编辑] 实际上我刚刚检查了我的 php 错误日志，日志文件中的时间也是 1 小时

```
[13-Sep-2012 20:11:14 UTC] Log Message (Time should be 21:11:14) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T20:21:28.607

蒙哥告诉你

```
2012-09-13T20:15:58.670Z 
```

Z = 祖鲁时间/零偏移量/UTC。您还可以将 TZ 中的时间表示为 2012-09-13T20:15:58.670+00:00，顺便说[一下 ISO8601 标准](http://en.wikipedia.org/wiki/ISO_8601#Time_zone_designators)中的定义。

BST 是 UTC+1。因此，它们是相同的时间，但在不同的时区。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-16T14:07:18.810

您可以通过使用方法显示 DateTime 来解决此问题`ToLocalTime`。

MVC C# 示例：`@Model.StartDate.ToLocalTime()`

这是由于 MongoDB 以 BST 格式存储日期时间的方式。因此，夏令时或服务器的时区会对返回给应用程序的实际日期时间产生影响。这个简单的代码将能够像往常一样格式化`ToString("dd MMMM yyyy hh:mm tt")`或根据您的要求使用任何其他格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-11T10:30:47.460

在这里，您需要了解时钟时间设置中的一个概念，称为[夏令时。](https://en.wikipedia.org/wiki/Daylight_saving_time)在世界上的一些国家，时钟提前 1 小时或更多小时以使日光多 1 小时。IST 和 GST 之间的时间差是 5.30 小时，但新德里和伦敦时间之间的实际时间差是 6.30 小时。有关设置和使用服务器时间的信息，请参阅[4GuysFromRolla](http://www.4guysfromrolla.com/articles/081507-1.aspx)的这篇文章。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2021-02-09T11:20:09.070

在 Windows 上更改您的时区。控制面板 -> 日期和时间 -> 更改时区 -> (UTC) 协调世界时。然后改变你的时间

# objective-c - 在objective c中同时添加google Plus api和youTube api

> ID：12414161
> 
> 赞同：0
> 
> 时间：2012-09-13T20:19:40.000
> 
> 标签：objective-c, youtube-api, xcode4.3

我正在做一个项目，我必须为 iOS 添加 google plus 和 youtube api。我面临的问题是它在链接时会出现一些重复错误：

重复符号 _kCharsToForceEscape

它显示冗余的文件是：GDataUtilities.o 和 GTLUtilities.o

任何形式的帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T12:45:16.030

我遇到了同样的问题，您不能删除 Gdata 实用程序或 GLT 实用程序，因为它们在 GDATA 和 GLT 中几乎在每种情况下都会被调用。有一种解决方法可以转到 gdata 实用程序，然后转到 #pragma mark string encoding 查找这行代码的部分：

```
const CFStringRef kCharsToForceEscape = CFSTR("!*'();:@&=+$,/?%#[]"); 
```

注释掉这个。

然后将这部分注释掉：

```
 //CFStringRef escapedStr;
  //escapedStr = CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault,
  //                                                     originalString,
  //                                                     leaveUnescaped,
  //                                                     kCharsToForceEscape,
  //                                                     kCFStringEncodingUTF8);
 // if (escapedStr) {
 //   resultStr = [(id)CFMakeCollectable(escapedStr) autorelease];
 // } 
```

如果将在那里两次，请确保您将两者都注释掉。

然后运行应用程序。

它对我有用我似乎有 youtube 工作，它似乎编译 google plus API OK。

# class - 在 VBA 中使用自定义数据类型

> ID：12414168
> 
> 赞同：46
> 
> 时间：2012-09-13T20:20:09.017
> 
> 标签：class, vba, types, excel

我正在尝试在 VBA for Excel 中创建自定义数据类型。我们称这种数据类型为“卡车”。每辆卡车都有以下属性：

```
NumberOfAxles (this is an integer)
AxleWeights (this is an array of doubles)
AxleSpacings (this is an array of doubles) 
```

我可以创建许多数据类型“卡车”（卡车（1）、卡车（2）...等）的实例，并将上面列出的属性读/写到该实例吗？

例子：

```
Truck(1).NumberOfAxles = 2
Truck(1).AxleWeights(1) = 15.0
Truck(1).AxleWeights(2) = 30.0
Truck(1).AxleSpacings(1) = 8.0

Truck(2).NumberOfAxles = 3
Truck(2).AxleWeights(1) = 8.0
Truck(2).AxleWeights(2) = 10.0
Truck(2).AxleWeights(3) = 12.0
Truck(2).AxleSpacings(1) = 20.0
Truck(2).AxleSpacings(2) = 4.0 
```

等等。上面的语法很可能是错误的，我只是想展示我需要提出的结构。

我正在尝试将数据写入数据结构并根据需要调用它，例如

```
Truck(i).NumberOfAxles
Truck(i).AxleWeights(j)
Truck(i).AxleSpacings(j) 
```

非常感谢你！

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-09-13T20:52:44.217

你当然可以：

```
Option Explicit

'***** User defined type
Public Type MyType
     MyInt As Integer
     MyString As String
     MyDoubleArr(2) As Double
End Type

'***** Testing MyType as single variable
Public Sub MyFirstSub()
    Dim MyVar As MyType

    MyVar.MyInt = 2
    MyVar.MyString = "cool"
    MyVar.MyDoubleArr(0) = 1
    MyVar.MyDoubleArr(1) = 2
    MyVar.MyDoubleArr(2) = 3

    Debug.Print "MyVar: " & MyVar.MyInt & " " & MyVar.MyString & " " & MyVar.MyDoubleArr(0) & " " & MyVar.MyDoubleArr(1) & " " & MyVar.MyDoubleArr(2)
End Sub

'***** Testing MyType as an array
Public Sub MySecondSub()
    Dim MyArr(2) As MyType
    Dim i As Integer

    MyArr(0).MyInt = 31
    MyArr(0).MyString = "VBA"
    MyArr(0).MyDoubleArr(0) = 1
    MyArr(0).MyDoubleArr(1) = 2
    MyArr(0).MyDoubleArr(2) = 3
    MyArr(1).MyInt = 32
    MyArr(1).MyString = "is"
    MyArr(1).MyDoubleArr(0) = 11
    MyArr(1).MyDoubleArr(1) = 22
    MyArr(1).MyDoubleArr(2) = 33
    MyArr(2).MyInt = 33
    MyArr(2).MyString = "cool"
    MyArr(2).MyDoubleArr(0) = 111
    MyArr(2).MyDoubleArr(1) = 222
    MyArr(2).MyDoubleArr(2) = 333

    For i = LBound(MyArr) To UBound(MyArr)
        Debug.Print "MyArr: " & MyArr(i).MyString & " " & MyArr(i).MyInt & " " & MyArr(i).MyDoubleArr(0) & " " & MyArr(i).MyDoubleArr(1) & " " & MyArr(i).MyDoubleArr(2)
    Next
End Sub 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-09-13T21:25:51.940

看起来您想将 Truck 定义为`Class`具有 NumberOfAxles、AxleWeights 和 AxleSpacings 属性的卡车。

这可以在**CLASS MODULE**中定义（这里命名为**clsTrucks**）

```
Option Explicit

Private tID As String
Private tNumberOfAxles As Double
Private tAxleSpacings As Double

Public Property Get truckID() As String
    truckID = tID
End Property

Public Property Let truckID(value As String)
    tID = value
End Property

Public Property Get truckNumberOfAxles() As Double
    truckNumberOfAxles = tNumberOfAxles
End Property

Public Property Let truckNumberOfAxles(value As Double)
    tNumberOfAxles = value
End Property

Public Property Get truckAxleSpacings() As Double
    truckAxleSpacings = tAxleSpacings
End Property

Public Property Let truckAxleSpacings(value As Double)
    tAxleSpacings = value
End Property 
```

然后在**MODULE**中，以下定义了一辆新卡车及其属性，并将其添加到卡车集合中，然后检索该集合。

```
Option Explicit

Public TruckCollection As New Collection

Sub DefineNewTruck()
Dim tempTruck As clsTrucks
Dim i As Long

    'Add 5 trucks
    For i = 1 To 5
        Set tempTruck = New clsTrucks
        'Random data
        tempTruck.truckID = "Truck" & i
        tempTruck.truckAxleSpacings = 13.5 + i
        tempTruck.truckNumberOfAxles = 20.5 + i

        'tempTruck.truckID is the collection key
        TruckCollection.Add tempTruck, tempTruck.truckID
    Next i

    'retrieve 5 trucks
    For i = 1 To 5
        'retrieve by collection index
        Debug.Print TruckCollection(i).truckAxleSpacings
        'retrieve by key
        Debug.Print TruckCollection("Truck" & i).truckAxleSpacings

    Next i

End Sub 
```

有几种方法可以做到这一点，因此它实际上取决于您打算如何使用数据来确定类/集合是最佳设置还是数组/字典等。

# selenium - 在 WebDriver 中选择元素

> ID：12414174
> 
> 赞同：0
> 
> 时间：2012-09-13T20:20:47.720
> 
> 标签：selenium, webdriver, selenium-webdriver

如何仅选择`Published DateTime webelement并单击它？

我的 HTML 代码

```
<tr>
<th scope="col">
...........
</th>
<th scope="col">
...........
</th>
<th scope="col">
...........
</th>
<th scope="col">
...........
</th>
........
<th scope="col">
<a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$AddControl1$gv','Sort$PublishDateTime')">Published DateTime</a>
</th>
</tr> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T07:24:06.517

试试这个：

```
driver.FindElement(By.LinkText("Published DateTime")).Click(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:58:15.817

```
String cssSelector= "tr>th[scope='col']>a:contains('Published DateTime')" 
```

第一种方式：

```
driver.findElement(By.css(cssSelector)).click() 
```

第二种方式（使用js）：

```
public void jsClick(String css){
JavascriptExecutor js = (JavascriptExecutor) driver;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append("var x = $(\'"+css+"\');");
        stringBuilder.append("x.click();");
        js.executeScript(stringBuilder.toString());
}
jsClick(cssSelector) 
```

希望这对你有用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T07:45:03.643

如果要验证文本，可以使用以下方法： - 如上所述定位元素：

```
String cssSelector= "tr>th[scope='col']>a:contains('Published DateTime')" 
```

**第一种获取验证文本的方法：**

```
String txt=driver.findElement(By.cssSelector(cssSelector)).getText().trim();
//validating 
Assert.assertTrue(txt.equals("blablabla")); 
```

**获取验证文本的第二种方法：**

```
publiv String getTextByJs(String css){
 JavascriptExecutor js = (JavascriptExecutor) driver;
        StringBuilder stringBuilder = new StringBuilder();

stringBuilder.append("var x = $(\""+css+"\");");
        stringBuilder.append("return x.text().toString();")       ;

       String res= (String) js.executeScript(stringBuilder.toString());
}
String txt=getTextByJs(cssSelector);
Assert.assertTrue(txt.equals("blablabla")); 
```

请享用）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-18T00:39:35.920

`driver.FindElement(By.LinkText("Published DateTime")).Click();`是正确答案。此外，如果您使用的是 javascript-selenium-webdriver。建议您使用[https://npmjs.org/package/webdriver-helper](https://npmjs.org/package/webdriver-helper)以获得更友好的 api。

`driver.link(':contains("Published DateTime")').click()`可以帮助你。

# android - Android - 如果存在，则按缓存名称对调用进行排序（在 sqlite 中使用 ifnull）

> ID：12414175
> 
> 赞同：0
> 
> 时间：2012-09-13T20:21:00.203
> 
> 标签：android, sqlite, android-contentprovider, calllog, ifnull

我想按缓存名称对通话记录进行排序。缓存的名称可以为空。因此，在缓存名称为空的情况下，我希望获得别名的电话号码。

在 sqlite 中，有 ifnull() 函数。 [ifnull 详细信息](http://www.sqlite.org/lang_corefunc.html)

我尝试：

```
String[] projections = new String[] { Calls._ID, Calls.NUMBER, Calls.DATE, Calls.TYPE, Calls.DURATION, "ifnull("+Calls.CACHED_NAME+","+Calls.NUMBER+") as display_name" };

Cursor cursor_call = ctx.getContentResolver().query(URI_CALL_LOGS,
                    projections,
                    null,
                    null,
                    null); 
```

但是我在使用 ifnull 时出错，我没有找到这个函数的样本。

java.lang.IllegalArgumentException：无效列 ifnull(name,number) as display_name

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:02:53.270

由于您创建查询的方式，括号之类的内容会自动转义以防止 SQL 注入攻击。

在您可以直接访问原始数据库（而不是通过 contentProvider）的情况下，您可以使用[SQLiteDatabase.rawQuery](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html)，如下所示：

myDB.rawquery("select * from a, b where a.id=b.someid", null);

但在这种情况下，您似乎想要访问联系人应用程序的 call_log 数据库，您只能通过提供的 ContentResolver 来完成。由于它被有意设计为只允许您将值而不是 SQL 命令作为变量发送，因此 ifnull(...) 不起作用，当您从中提取数据时，您需要使用逻辑在名称和数字之间进行选择光标。

# asp.net - gridview 固定页眉和固定页脚

> ID：12414177
> 
> 赞同：0
> 
> 时间：2012-09-13T20:21:08.360
> 
> 标签：asp.net, gridview

我在互联网上搜索了一个固定的 asp.net gridview 的页眉和页脚实现。在某些浏览器中，所有这些似乎都不起作用。看起来我可能需要购买 Telerik 或 devexpress gridview 控件集才能满足此要求。我疯了吗？谢谢达摩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T20:39:56.223

一种可能的解决方案：在具有溢出的 div 标记中创建一个 gridview：隐藏和固定高度（这将使其滚动），然后在顶部放置一个单行表，在底部放置另一个表，给出页眉和页脚。

那么明显的问题是列不会对齐。为了解决这个问题，尝试为页眉、页脚和网格视图中的所有列提供固定列宽，除了最后一个，它应该扩展以填充剩余的内容。

说了这么多，要排队真是一件痛苦的事！

[您可以在我的博客中看到](http://www.wiseowl.co.uk/blog/s301/format-gridview.htm)滚动的 gridview 位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:04:06.100

Devexpress 控件非常好，因为您还可以轻松使用页眉和页脚模板。

根据我们的要求定制它真的很容易。

自过去 8 个月以来，我一直在使用 devexpress，其外观和性能给我留下了深刻的印象。

# java - Java 小程序在浏览器中出现错误

> ID：12414189
> 
> 赞同：1
> 
> 时间：2012-09-13T20:21:48.140
> 
> 标签：java, applet

我一直在阅读 Laura Lemay 的《Teach Yourself Java in 21 days》一书。我猜这本书有点老了，是在 Java 早期写的。它描述了关于制作小程序的内容，如下所示。

```
import java.awt.Graphics;
import java.awt.Font;
import java.awt.Color;

public class HelloAgainApplet extends java.applet.Applet {

    Font f = new Font("TimesRoman", Font.BOLD, 36);

    public void paint(Graphics g) {
        g.setFont(f);
        g.setColor(Color.red);
        g.drawString("Hello again!", 5, 50);
    }
} 
```

这个小程序覆盖了paint()，这是上一节中描述的主要方法之一。因为小程序实际上并没有做太多事情（它所做的只是在屏幕上打印几个单词），并且实际上没有什么要初始化的，所以不需要 start() 或 stop() 或 init( ） 方法。

HTML如下：

```
<HTML>
<HEAD>
<TITLE>Another Applet</TITLE>
</HEAD>
<BODY>
<P>My second Java applet says:
<APPLET CODE="HelloAgainApplet.class" WIDTH=200 HEIGHT=50>
</APPLET>
</BODY>
</HTML> 
```

我已经做了同样的练习，但是我的浏览器给出了如下错误。这是为什么？

![在此处输入图像描述](../Images/53081f0dfc152f236cd058d028a0d288.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:38:31.343

1）将您的html和类文件放在同一个文件夹中。

2) 您的 html 文件应如下所示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Another Applet</title>
</head>
<body>
<p>My second Java applet says:
    <applet code="HelloAgainApplet.class" width=200 height=50>
    </applet>
</body>
</html> 
```

那应该可以解决问题。

# jquery - 在 jQuery 动画中向前跳跃？

> ID：12414191
> 
> 赞同：4
> 
> 时间：2012-09-13T20:21:58.017
> 
> 标签：jquery

有没有办法及时向前/向后跳转 jQuery 动画？

例如，如果我将元素上的动画设置为 10 秒，我可以跳到“5 秒”进入该动画吗？优选地，这可以用百分比来设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:49:16.823

您可以停止当前动画，将动画对象的状态设置在其初始状态和最终状态之间的中间，然后将新动画开始到原始最终状态，但设置为一半时间。

这将跳转到动画的中间位置，然后从那里继续前进。

这是一个工作示例：http: [//jsfiddle.net/jfriend00/FjqKW/](http://jsfiddle.net/jfriend00/FjqKW/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:28:42.447

[http://api.jquery.com/queue/](http://api.jquery.com/queue/)

您可以尝试在动画中设置队列或

如果你能提供一个例子，你肯定会收到一个很好的提示；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:32:26.807

这应该有你想要的一切，但百分比功能：

演示：http: [//jsfiddle.net/SO_AMK/MHV5k/](http://jsfiddle.net/SO_AMK/MHV5k/)

jQuery：

```
var time = 10000; // Animation speed in ms
var opacity = 0; // Final desired opacity

function jumpAnimate(setOpacityTo, newOpacity, speed){  // I created a function to simplify things
    $("#fade").css("opacity", setOpacityTo).animate({
        "opacity": newOpacity
    }, {
        duration: speed // I used speed instead of time because time is already a global variable
    });
}

$("#jump").click(function(){
    var goTo = $("#jump-to").val(); // Get value from the text input

    var setOpacity = (1 / time) * (time - goTo); /* The opacity that the element should be set at, i.e. the actual jump
    Math is as follows: initial opacity / the speed of the original animation in ms * the time minus the desired animation stop in ms (basically the remaining time past the desired point) */

    $("#fade").stop(); // Stop the original animation after the math is finished so that we have minimal delay

    jumpAnimate(setOpacity, opacity, time - goTo); // Start a new animation
});

jumpAnimate(1, opacity, time);​ // Start the initial animation 
```

# java - 实时处理 MIDI 音符

> ID：12414193
> 
> 赞同：1
> 
> 时间：2012-09-13T20:22:00.870
> 
> 标签：java, midi

基本上，我想在音序器实时播放时获取并显示 midi 音符（音轨、音符和八度音阶）的数据。

我希望能够将其添加到以下代码中：

```
Sequencer sequencer = MidiSystem.getSequencer();
sequencer.setSequence(MidiSystem.getSequence(song));
sequencer.open();
sequencer.start();
while(true) {
    if(sequencer.isRunning()) {
        try {
            Thread.sleep(1000); // Check every second
        } catch(InterruptedException ignore) {
            break;
        }
    } else {
        break;
    }
} 
```

但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:39:43.680

将 ControllerEventListener 添加到 Sequencer。它将为您节省主动等待，并提供您需要显示的所有信息。

```
ControllerEventListener controllerEventListener = new ControllerEventListener() {
   public void controlChange(ShortMessage event) {
      // TODO convert the event into a readable/desired output
      System.out.println(event);
   }
};

Sequencer sequencer = MidiSystem.getSequencer();
int[] controllersOfInterest = { 1, 2, 4 };
sequencer.addControllerEventListener(controllerEventListener, controllersOfInterest); 
```

也看看这个[页面](http://docs.oracle.com/javase/tutorial/sound/MIDI-seq-adv.html)。

# apache - xampp 1.8.1 不显示文件夹中带有 .htaccess 的网站

> ID：12414201
> 
> 赞同：2
> 
> 时间：2012-09-13T20:22:27.283
> 
> 标签：apache, .htaccess, xampp, localhost

我使用**xampp 1.7.7**和 *"Apache/2.2.11 (Win32) DAV/2 mod_ssl/2.2.11 OpenSSL/0.9.8i PHP/5.2.9 Server at localhost Port 80"*，一切正常。我想使用*“Apache/2.4.2 (Win32) OpenSSL/1.0.1c PHP/5.4.4 Server at localhost Port 80”从 xampp 1.7.7 迁移到***xampp 1.8.1**，我使用带有**mod_rewrite.so的****.htaccess**文件模块和 xampp 1.7.7 一切正常，但是当我在目录结构中切换到 1.8.1 时，**我没有看到其中包含 .htaccess 文件的文件夹，当我尝试通过直接链接访问这些文件夹时，****它会引发错误500**。*****`http://localhost` **`http://localhost/example`*******

 *****`LoadModule rewrite_module modules/mod_rewrite.so`未引用。

我的操作系统是 Windows 7。

我究竟做错了什么？*****

# wordpress - Wordpress 页面层次结构

> ID：12414202
> 
> 赞同：0
> 
> 时间：2012-09-13T20:22:31.447
> 
> 标签：wordpress

我在开发中的网站上有以下页面：

[http://telamon.com.s137737.gridserver.com/media/press/](http://telamon.com.s137737.gridserver.com/media/press/)

我想在循环之外做一些事情，所以我根据我对 WP 页面层次结构（[http://codex.wordpress.org/Template_Hierarchy](http://codex.wordpress.org/Template_Hierarchy)）的理解创建了 page-press.php。它不工作。我也重置了永久链接。这不是我第一次在这里遇到问题，我刚刚创建了一个模板，但这应该可以工作，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:48:29.553

是的，层次结构确实应该像那样工作，但要使其工作，您需要满足以下条件：

1.  它需要处于单身的心情
2.  该页面需要是静态页面
3.  您不能在页面上应用任何其他自定义模板
4.  页面的 slug 需要“按下”

如果所有这些都是真的，那么它应该可以工作。如果没有，请检查以下内容，找到`id`页面并创建一个`page-$ID.php`并检查它是否有效。看看你是否最终进入了`page.php`模板文件，或者你是否最终`index.php`尝试`var_dump`在一些变量上使用`is_single()`等等。

编辑：

`Single mood`是当页面由它自己列出时，而不是在列表中。
`Static page`意味着这不是帖子，也不是像存档这样的列表视图或类似的东西，
`Custom template`当您创建一个页面作为特定的“页面模板”可供选择时，当您编辑页面时（右下）。
`Slug`和你的title不一样，你的id也不一样。这很可能是您的标题的 url 友好变体。

# javascript - 主干.js 无法呈现视图

> ID：12414203
> 
> 赞同：2
> 
> 时间：2012-09-13T20:22:32.103
> 
> 标签：javascript, backbone.js, underscore.js

下面我有我的一个模块的代码。这是一种意大利面条式的代码，但我想要完成的只是拥有一个模型、一个集合，并渲染一个视图（使用下划线模板），将集合中的数据连接到视图。我失败得很惨。我遇到的问题是，尝试在那里运行最后一次调用 testfeed.render() 告诉我 render 不是一个函数，但它已明确定义。我能够获取该数据并似乎将其从 api 添加到集合中。我在这里做错了什么？

```
 // Create a new module.
  var Tagfeed = app.module();

  // Default model.
  Tagfeed.Model = Backbone.Model.extend({
    defaults : {
        name : '',
        image : ''
    },
    initialize : function(){
        console.log('tagfeed model is initialized');
        this.on("change", function(){
            console.log("An attribute has been changed");
        });
    }
  });

  var feedCollection = Backbone.Collection.extend({
    model: Tagfeed.Model,
    initialize : function () {
        console.log('feedcollection is initialized');
    },
    fetch: function () {
        var thisCollection = this;
        Api_get('/api/test', function(data){

            $.each(data.data, function(){
                thisCollection.add(this);
            });
            return thisCollection;
        })
    }
  });

  var test = new Tagfeed.Model({name:'test'});

  var newFeedCollection = new feedCollection();

  newFeedCollection.fetch();

  console.log(newFeedCollection.at(0));

  var testfeed = Backbone.View.extend({
    el: $('#main'),
    collection : newFeedCollection,
    render: function( event ){
        var compiled_template = _.template( $("#tag-template").html() );
        this.$el.html( compiled_template(this.model.toJSON()) );
        return this; //recommended as this enables calls to be chained.
    }
  });

  testfeed.render(); 
```

编辑*******来自@mu 的更新代码是简短的建议

```
 // Create a new module.
  var Tagfeed = app.module();

  // Default model.
  var tagModel = Backbone.Model.extend({
    defaults : {
        name : '',
        image : '',
        pins : 0,
        repins : 0,
        impressions : 0
    },
    initialize : function(){
        console.log('tagfeed model is initialized');
        this.on("change", function(){
            console.log("An attribute has been changed");
        });
    }
  });

  var feedCollection = Backbone.Collection.extend({
    model: tagModel,
    initialize : function () {
        console.log('feedcollection is initialized');
    },
    fetch: function () {
        var thisCollection = this;

        Api_get('/reporting/adlift/pin_details', function(data){

            thisCollection.add(data.data);

            return data.data;
        })
    }
  });

  var test = new tagModel({name:'test'});

  var newFeedCollection = new feedCollection();

  newFeedCollection.fetch();

  console.log(newFeedCollection.at(0));

  var TestFeed = Backbone.View.extend({
    el: $('#main'),
    render: function( event ){
        console.log('here');
        var compiled_template = _.template( $("#tag-template").html(), this.collection.toJSON());
        this.el.html( compiled_template );
        return this; //recommended as this enables calls to be chained.
    },
    initialize: function() {
        console.log('initialize view');
        this.collection.on('reset', this.render, this);
    }
  });

  //Tagfeed.testfeed.prototype.render();

  var testfeed = new TestFeed({ collection: newFeedCollection });

  testfeed.render(); 
```

现在当我运行 testfeed.render() 时，我没有看到任何错误，也没有在渲染函数中看到 console.log。想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T21:04:16.717

你的问题就在这里：

```
var testfeed = Backbone.View.extend({ /*...*/ });
testfeed.render(); 
```

这使您`testfeed`的视图成为“类”，您必须先创建一个新实例，`new`然后才能渲染它：

```
var TestFeed = Backbone.View.extend({ /*...*/ });
var testfeed = new TestFeed();
testfeed.render(); 
```

您也在“类”中执行此操作：

```
collection : newFeedCollection 
```

这将附加`newFeedCollection`到该视图的每个实例，这可能会导致一些令人惊讶的行为。将集合放入视图的常用方法是将其传递给构造函数：

```
var TestFeed = Backbone.View.extend({ /* As usual but not collection in here... */ });
var testfeed = new TestFeed({ collection: newFeedCollection });
testfeed.render(); 
```

[视图构造函数](http://backbonejs.org/#Collection-constructor)会自动将视图设置为您`this.collection`在构建视图时传递的集合。

要考虑的另一件事是：

```
newFeedCollection.fetch(); 
```

通常是一个 AJAX 调用，因此当您尝试渲染它时，您的集合中可能没有任何内容。我会做两件事来解决这个问题：

1.  您的视图`render`应该能够处理空集合。这主要取决于您的模板足够聪明，以便在集合为空时变得明智。
2.  绑定`render`到视图中的集合`"reset"`事件`initialize`：

    ```
    initialize: function() {
        this.collection.on('reset', this.render, this);
    } 
    ```

您将遇到的另一个问题是您的视图`render`正在尝试渲染`this.model`：

```
this.$el.html( compiled_template(this.model.toJSON()) ); 
```

当您的视图基于集合时；您想将其更改为：

```
this.$el.html(compiled_template({ tags: this.collection.toJSON() })); 
```

您需要`tags`在那里，以便模板在查看集合数据时具有可参考的名称。

此外，您应该能够替换它：

```
$.each(data.data, function(){
    thisCollection.add(this);
}); 
```

就这样：

```
thisCollection.add(data.data); 
```

无需逐个添加它们，[`Collection#add`](http://backbonejs.org/#Collection-add)对一系列模型非常满意。

这是一个演示（希望）一切都整理好了：

> [http://jsfiddle.net/ambiguous/WXddy/](http://jsfiddle.net/ambiguous/WXddy/)

我不得不伪造`fetch`内部结构，但其他一切都应该在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:59:51.573

`testfeed`不是一个实例——它是一个构造函数。

```
var instance = new testfeed(); 
instance.render(); 
```

可能会起作用（您`el`在视图**定义**期间定义的内容 - 使其成为原型属性，IIRC）。

# sql - 反向分区

> ID：12414206
> 
> 赞同：3
> 
> 时间：2012-09-13T20:23:07.220
> 
> 标签：sql, sql-server-2008

所以我正在处理这样的表格：

```
Sku ProductCode Product Id
01     11011         null
02     11021         null
03     11021         null
04     11011         null
05     11031         null
06     11041         null 
```

我想像这样更新产品ID：

```
Sku ProductCode Product Id
01     11011         01
02     11021         02
03     11021         02
04     11011         01
05     11031         03
06     11041         04 
```

我正在使用这个查询：

```
with upd  
as  
(  
SELECT *, ROW_NUMBER() OVER (PARTITION BY [Product Code] ORDER BY [Product Code]) AS rnk  
FROM temp  
)  
UPDATE upd  
SET ProductId = rnk 
```

基本上我只想计算它是否不同。任何不使用任何功能或过程的想法？连续语句很好，更多的列也很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T20:25:30.807

您想使用 dense_rank() 函数而不是 row_number()：

```
with upd  as  
     (SELECT *,
             dense_rank() OVER (ORDER BY [Product Code]) AS rnk  
      FROM temp  
     )  
UPDATE upd  
    SET ProductId = rnk 
```

# maven - 使用不同的 Java 版本编译 Maven 模块

> ID：12414209
> 
> 赞同：32
> 
> 时间：2012-09-13T20:23:30.947
> 
> 标签：maven

我的 maven 项目有几个模块：服务器、Web 等。

我想在 Java 6 上构建除了我的服务器模块之外的所有模块。对于服务器模块，我想用 Java 7 编译它。

下面是我的 pom.xml，但我认为如果我将其修改为 1.7，那么我的所有模块都将使用 Java 7 进行编译。此外，maven 是否使用 JAVA_HOME 环境变量来确定要使用的 Java 版本？

```
 <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
                        <version>2.3.2</version>
        <configuration>
            <source>1.6</source>
            <target>1.6</target>
            <memmax>2048m</memmax>
        </configuration>
    </plugin> 
```

**编辑**另外，以下输出是否

> 行家——版本

表明maven正在用1.7编译我的java代码？

```
vagrant@dev:~/bin/apache-tomcat-7.0.29/bin$ mvn --version
Apache Maven 3.0.4 (r1232337; 2012-01-17 08:44:56+0000)
Maven home: /home/vagrant/bin/apache-maven-3.0.4
Java version: 1.7.0_07, vendor: Oracle Corporation
Java home: /home/vagrant/bin/jdk1.7.0_07/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "3.2.0-23-generic", arch: "amd64", family: "unix" 
```

谢谢，凯文

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-14T07:04:41.877

有许多黑客可以使用与运行 Maven 不同的 JDK 版本来编译源代码，例如，您可以使用类似

```
<project>
  [...]
  <build>
    [...]
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.5.1</version>
        <configuration>
          <executable><!-- path-to-javac --></executable>
        </configuration>
      </plugin>
    </plugins>
    [...]
  </build>
  [...] 
</project> 
```

这种方法的问题是您现在已经将 JDK 的路径硬编码到您的 POM 中。一切都可以在*您的机器*上正常工作，但是当您因为 HDD 故障而必须重建机器时，或者当您想在另一台机器上构建时，您将被卡住，因为路径很可能不匹配。

处理此问题的正确*最佳实践*方法是通过[Toolchains](http://maven.apache.org/guides/mini/guide-using-toolchains.html)。这将看到您创建一个`~/.m2/toolchains.xml`文件，该文件描述系统中每个不同工具链的位置。然后可以通过 Maven Toolchains Plugin 应用 JDK 的版本，例如

```
<plugins>
 ...
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-toolchains-plugin</artifactId>
    <version>1.0</version>
    <executions> 
      <execution>
        <phase>validate</phase>
        <goals>
          <goal>toolchain</goal>
        </goals>
      </execution>
    </executions>
    <configuration>
      <toolchains>
        <jdk>
          <version>1.6</version>
        </jdk>
      </toolchains>
    </configuration>
  </plugin>
  ...
</plugins> 
```

接下来的事情是你并不像你想象的那样经常需要这个。例如，通过使用`source`and`target`值，您可以为您所针对的 JRE 生成正确的字节码......您将遇到的唯一问题是使用 JRE 1.7 中的新方法......这就是[Mojo 的 Animal Sniffer Plugin](http://www.mojohaus.org/animal-sniffer/animal-sniffer-maven-plugin/)进来了。Animal Sniffer 可用于确保您只使用您所针对的 JRE 的方法。社区的普遍共识是使用`source`和`target`Maven Compiler Plugin 配置中的配置选项以及 Mojo 的 Animal Sniffer 的使用几乎消除了 Compiler 端对工具链的需求......在 Surefire 端仍然需要工具链......我有我需要更新编译器插件和工具链插件来处理一些边缘情况，但实际上你不会遇到这些边缘情况;-)

只是为了确保您的原始问题得到完全回答（因为上面回答了您想问的问题 - 而不是您问的问题）

目前您正在使用 JDK 1.7 进行编译，*但是*根据您使用的 Maven 编译器插件的版本，您可能正在使用其中一个进行编译，`<source>1.4</source><target>1.4</target>`或者`<source>1.5</source><target>1.5</target>`除非您更改了`pom.xml`. 这将决定您可以使用哪些语言功能，而不是哪些类......因此您将生成适用于 JRE 1.7 的代码，并且*前提是您没有使用自 1.4/1.5 以来引入的任何新类/方法*（例如`String.isEmpty()`）也应该在 JRE 1.4/1.5 上工作......确定它是否适用于这样一个旧 JVM 的唯一方法是：在旧 JVM 上运行它或使用 Animal Sniffer。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-09-28T07:43:20.563

## Maven 工具链

要使用多个 Java 版本，您需要使用[Maven Toolchains](https://maven.apache.org/guides/mini/guide-using-toolchains.html)，这需要您`toolchains.xml`在 Maven 文件夹中创建一个文件`~/.m2`，其中包含您机器上安装的所有 Java 版本：

```
<toolchains>
  <toolchain>
    <type>jdk</type>
    <provides>
      <id>Java13</id>
      <version>13</version>
    </provides>
    <configuration>
      <jdkHome>${env.JAVA_HOME_13}</jdkHome>
    </configuration>
  </toolchain>
  <toolchain>
    <type>jdk</type>
    <provides>
      <id>Java9</id>
      <version>9</version>
    </provides>
    <configuration>
      <jdkHome>${env.JAVA_HOME_9}</jdkHome>
    </configuration>
  </toolchain>
  <toolchain>
    <type>jdk</type>
    <provides>
      <id>Java8</id>
      <version>8</version>
    </provides>
    <configuration>
      <jdkHome>${env.JAVA_HOME_8}</jdkHome>
    </configuration>
  </toolchain>
  <toolchain>
    <type>jdk</type>
    <provides>
      <id>Java7</id>
      <version>7</version>
    </provides>
    <configuration>
      <jdkHome>${env.JAVA_HOME_7}</jdkHome>
    </configuration>
  </toolchain>
  <toolchain>
    <type>jdk</type>
    <provides>
      <id>Java6</id>
      <version>6</version>
    </provides>
    <configuration>
      <jdkHome>${env.JAVA_HOME_6}</jdkHome>
    </configuration>
  </toolchain>
</toolchains> 
```

, `JAVA_HOME_13`, `JAVA_HOME_9`, `JAVA_HOME_8`,环境变量被配置`JAVA_HOME_7`为`JAVA_HOME_6`引用相关 Java 版本的安装路径。

## FlexyPool 父 pom.xml 配置文件

[FlexyPool](https://github.com/vladmihalcea/flexy-pool)项目的父`pom.xml`Maven 配置文件定义了全局 Java 版本设置

```
<properties>
    <jdk.version>8</jdk.version>
    ...
</properties> 
```

现在，我们需要指示编译器和测试插件都使用配置的 java 版本。

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-toolchains-plugin</artifactId>
            <version>1.1</version>
            <executions>
                <execution>
                    <goals>
                        <goal>toolchain</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <toolchains>
                    <jdk>
                        <version>${jdk.version}</version>
                    </jdk>
                </toolchains>
            </configuration>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>${maven-compiler-plugin.version}</version>
            <configuration>
                <source>${jdk.version}</source>
                <target>${jdk.version}</target>
                <showDeprecation>true</showDeprecation>
                <showWarnings>true</showWarnings>
            </configuration>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>${maven-surefire-plugin.version}</version>
        </plugin>
    </plugins>
</build> 
```

## FlexyPool 子 Maven 模块 pom.xml 使用不同的 Java 版本

需要不同 Java 版本的`flexy-pool-core-java9`子 Maven 模块只需要覆盖默认的`jdk.version`Maven 属性：

```
<properties>
    <jdk.version>9</jdk.version>
</properties> 
```

就是这样，我们现在可以使用自己的最小可行 Java 版本构建每个模块。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T21:14:15.837

在您的顶级 pom 上使用 JDK6 的设置，它将被所有模块继承，并使用所需的不同配置为您的服务器 pom 覆盖它。

至于JDK的路径，可以指定，看这里：[http ://maven.apache.org/plugins/maven-compiler-plugin/examples/compile-using-different-jdk.html](http://maven.apache.org/plugins/maven-compiler-plugin/examples/compile-using-different-jdk.html)

# iphone - Iphone 应用程序和 cookie

> ID：12414210
> 
> 赞同：0
> 
> 时间：2012-09-13T20:23:32.557
> 
> 标签：iphone, http, cookies, proxy

是否可以强制所有 iphone 应用在所有 http 请求中使用相同的 cookie？
示例：我想在所有 http 请求中发送我的电子邮件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:42:26.890

不，不以任何受支持的方式。请参阅[NSHTTPCookieStorage](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSHTTPCookieStorage_Class/Reference/Reference.html)。

> iOS 注意： Cookie 不会在 iOS 中的应用程序之间共享。

你实际上想用这个来完成什么？

# java - 网络库兼容 C 和 Java

> ID：12414217
> 
> 赞同：4
> 
> 时间：2012-09-13T20:23:48.733
> 
> 标签：java, android, c++, networking, enet

我打算开发一款具有多人功能的安卓小游戏。我已经使用 eNet 库在 C++ 中制作了一个服务器框架，我想使用这个框架来制作服务器。

那么，有没有像 eNet 这样兼容 Java 和 C++ 的网络库呢？我知道存在 jEnet（但是 Java-enet-wrapper 非常过时（https://github.com/csm/java-enet-wrapper），它还不成熟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-05T04:01:05.470

查看[https://github.com/julienr/libenet-android](https://github.com/julienr/libenet-android)。

在您的情况下，ENet 比 UDT 更可取，因为 UDT 可能是处理器密集型的，并且游戏服务至少希望有很多连接。不同之处在于 UDT 的拥塞控制实现对 CPU 的需求相对较高。UDT 非常棒，但它更多地设计用于长距离的大型、高带宽传输，而不是游戏中所需的小型、高延迟交易。

另请注意，主流拥塞控制算法不适用于小型事务。它们通过监控事务中每个数据包的 RTT 和/或监控事务中的数据包丢失率来工作，当每个事务平均只有 1 - 2 个数据包时，这是没有实际意义的。拥塞控制协议的额外要求将影响延迟，即使如果传输保持较小，拥塞控制本身也不太可能参与。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T21:32:34.993

你可以试试UDT：[http ://udt.sourceforge.net/](http://udt.sourceforge.net/)

我以前曾成功地使用它在 Java 和 C++ 进程之间进行通信。

# vb.net - Linq to Entities 将一个实体转换为相似的实体

> ID：12414218
> 
> 赞同：0
> 
> 时间：2012-09-13T20:23:51.370
> 
> 标签：vb.net, linq, entities

我有一个实体模型，其中包含`Person`和的实体`LogPerson`。它们是相同的，只是`LogPerson`有 2 个附加字段 ( `LogPersonID`, `CreateDate`)。如何**将**a`LogPerson`转换为 a`Person`以便跟随我的 Linq 代码的 VB.NET 代码不必尝试使用这两种可能的类型？

例如：

```
dim p as person
If useLog then
   p = From a In LogPerson Where ID = x
Else
   p = From a In Person Where ID = x
End If

textbox1.text = p.firstname 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:24:30.167

```
I am WRITING THE SOLUTION IN C#....

person p;
if(uselog)
{
var per = from pobj in LogPerson
          where pobj.ID= x
          select new person{
          firstname = pobj.firstname,
          lastname = pobj.lastname,
          };
}else
{
var per = from pobj in Person
    where pobj.ID= x
    select new person{
    firstname = pobj.firstname,
    lastname = pobj.lastname,
    };
}
p = per.first();
}

textbox1.text = p.firstname 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T16:05:25.387

没有任何开箱即用的方法。没有第三方工具/库的最简单方法是使用该[`Select`方法](http://msdn.microsoft.com/en-us/library/bb548891.aspx)并手动映射属性，如下所示：

```
IEnumerable<Person> people = ...;

IEnumerable<LogPerson> logPeople = people.Select(p => new LogPerson { 
    Name = p.Name,
    Age = p.Age,
    ...
}); 
```

当然，这很乏味，所以如果你有大量的字段或许多地方你必须执行这种操作，你可能想研究一个自动映射库，比如[AutoMapper](https://github.com/AutoMapper/AutoMapper)。

# selenium - 为什么我在使用 PHPUnit + Selenium Server 时没有收到错误消息？

> ID：12414227
> 
> 赞同：0
> 
> 时间：2012-09-13T20:24:28.157
> 
> 标签：selenium, phpunit, selenium-rc

为什么我使用 PHPUnit + Selenium Server 使用不存在的电子邮件和密码登录时没有收到错误消息？这是 PHPUnit 脚本。

```
public function testUserNotExists() {
    $this->open('https://dev.example.com/login');
    $this->type("id=email", "1d0ntex1s7@live.com");
    $this->type("id=password", "1d0n73x1s7");
    $this->click("name=login_user");

} 
```

当我运行它时，它不会显示错误

终端：Sebastian Bergmann 的 phpunit ExampleTest.php PHPUnit 3.6.12。

电子...

时间：29 秒，内存：4.75Mb

有 1 个错误：

1) ExampleTest::testTitle

方法 assertTitleEquals 未定义。

失败！测试：4，断言：1，错误：1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T13:54:14.507

您必须编写[断言](https://phpunit.de/manual/current/en/selenium.html#selenium.seleniumtestcase.tables.assertions)才能获得一些失败。Selenium 不知道在发送某种表格后应该（或不应该）发生什么。

# html - 如何将 PSD 模板切片为 html/css？

> ID：12414228
> 
> 赞同：0
> 
> 时间：2012-09-13T20:24:33.437
> 
> 标签：html, css, templates, psd

我正在将 PSD 模板编码为 html/css。该文件由大约 50 个图层组成，我已使用 Photoshop 脚本将其导出为 PNG。我是这样开始的：

```
<div id="container_1">
  <div id="container_2">
    <div id="containter_3">
       etc
    </div>
  </div>
</div> 
```

每一层都是模板大小，具有透明背景。起初我对这种方法很满意，因为它工作得很好，让我不用担心定位太多，但现在 div 的数量非常庞大，代码开始对我来说看起来很奇怪，更不用说页面加载速度非常慢现在。这一定是一个非常愚蠢的问题，但是我应该在从 PSD 导出图像后裁剪图像吗？甚至可以将多个图层组合在一起，而不是将它们一个接一个地放在页面上（有几个图层可以在带有文本的块周围创建装饰性边框）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:30:41.240

你可以试试这个教程：http: [//net.tutsplus.com/articles/news/slice-and-dice-that-psd/](http://net.tutsplus.com/articles/news/slice-and-dice-that-psd/)

# xml - 是否有类似于 local-name 的 local-path 函数？

> ID：12414233
> 
> 赞同：1
> 
> 时间：2012-09-13T20:24:52.773
> 
> 标签：xml, tsql

在之前的 SO 帖子中：[XML 数据类型方法“值”的参数 1 必须是字符串文字](https://stackoverflow.com/questions/12397722/the-argument-1-of-the-xml-data-type-method-value-must-be-a-string-literal)我没有找到解决方案，但如果有人能回答这个问题，我可以解决之前的问题。

问题：如何以检索给定节点名称的方式检索给定节点的完整路径？

```
declare @x xml; set @x='<ROOT><a>111</a></ROOT>'
SELECT @x.value('local-name((/ROOT/a)[1])', 'varchar(256)') 
```

以上将返回'a'。我如何返回'/ROOT/a'？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T23:25:56.383

目前（从 SQL Server 2008 起）没有解决这个问题的方法，仅仅是因为 SQL 引擎不支持整个 XQuery 语言。根据规范，有些函数可用于获取祖先，并使用 FLWOR 可以构建路径，但尚未实现祖先函数。可悲的是。

但是，至于让我开始的问题（请参阅我原来的 SO 帖子） - 找到了一个可接受的解决方案

# android - “隐藏”已安装的安卓应用

> ID：12414234
> 
> 赞同：4
> 
> 时间：2012-09-13T20:24:58.110
> 
> 标签：android, installation, apk

有没有办法“隐藏”已安装的 android 应用程序，使其不显示在应用程序 > 已安装/已下载/在 SD 卡上

或者有没有办法限制其他应用程序访问您的应用程序？

我试图否定 APKInstaller 访问“查看”我的应用程序，以防止它允许 APKInstaller“管理”选项下的“导出”功能允许我的应用程序导出到 .apk

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:31:33.920

> 有没有办法“隐藏”已安装的 android 应用程序，使其不显示在应用程序 > 已安装/已下载/在 SD 卡上

只有通过构建您自己的自定义 ROM。

> 或者有没有办法限制其他应用程序访问您的应用程序？

这取决于“访问”的性质。

> 我试图否定 APKInstaller 对我的访问“查看”我的应用程序，以防止它允许 APKInstaller“管理”选项下的“导出”功能，该选项允许我的应用程序导出到 .apk

不，抱歉，大多数 APK 文件都是全球可读的。

# asp.net - 获取 URL 中的嵌套查询参数

> ID：12414243
> 
> 赞同：2
> 
> 时间：2012-09-13T20:25:45.740
> 
> 标签：asp.net, url, c#-4.0, query-string

我有一个 URL，它有一个查询参数，该参数本身包含一个带有其他参数的查询字符串。例如：

[https://discovery.com/disco.ashx?entityId=www.test.com&return=https://myidp.com/?param1=myvalue](https://discovery.com/disco.ashx?entityId=www.test.com&return=https://myidp.com/?param1=myvalue)

如何获取嵌套 param1 的值？

我已经尝试过这样的事情，但它不起作用：

```
var returnParam = context.Request.QueryString["return"];

var test = HttpUtility.ParseQueryString(returnParam);

var value = test["param1"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:33:23.340

你可以试试这个 -`var u = new Uri(returnParam); var newparams = u.Query;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T04:51:11.950

`HttpUtility.ParseQueryString`只需要查询字符串作为输入。使用从 url 中提取查询字符串`Uri`，然后将其传递给`HttpUtility.ParseQueryString`

```
var uri = new Uri(Request.QueryString["return"]);
var queryParams = HttpUtility.ParseQueryString(uri.Query);
var value = queryParams["param1"]; 
```

# django - 从模型表单集中动态删除表单 django

> ID：12414248
> 
> 赞同：7
> 
> 时间：2012-09-13T20:26:07.203
> 
> 标签：django, django-models, django-forms

我有一个网页，用户可以在其中动态添加和删除表单到 django 表单集。

我已阅读[Dynamically added a form to a Django formset with Ajax](https://stackoverflow.com/questions/501719/dynamically-adding-a-form-to-a-django-formset-with-ajax)，基于此我可以将表单动态添加到 formset 中。现在我想动态删除表单集。我看过[Django 中的动态删除内联表单集](https://stackoverflow.com/questions/2357059/dynamically-delete-inline-formsets-in-django)

我想要这样做的方式是当用户单击删除时，我有一个 ajax 函数可以从数据库中删除表单实例记录。当我的 ajax 函数返回时，我保持相同的 total_form_count 和 initial_form_count 并且只是隐藏表单 html，这样即使删除的记录也会在我的 POST 中提交。

最初，表单集将其表单元素呈现为：

```
#form0
<input id="id_formprefix-0-id" type ="hidden "value="something" name="formprefix-0-id">
<input id="id_formprefix-0-field" value="something" type="text" name="formprefix-0-field">
#form1
<input id="id_formprefix-1-id" type ="hidden "value="something" name="formprefix-1-id">
<input id="id_formprefix-1-field" value="something" type="text" name="formprefix-1-field">
#form2
<input id="id_formprefix-2-id" type ="hidden "value="something" name="formprefix-2-id">
<input id="id_formprefix-2-field" value="something" type="text" name="formprefix-2-field"> 
```

现在假设我使用ajax动态删除表单0，在我的记录被删除后，我不更改表单计数，所以total_form_count和initial_form_count是3。

（如果我在这种情况下将 total_form_count 和 initial_form_count 减少到 2，当我使用 POST 数据在我的视图中填充表单集时，预计它会被排序为 form0 和 form1。但在我的情况下，有效表单是 form1 和 form2）

现在在我看来，我正在做类似以下的事情来保存我的表格。

```
myformset = modelformset_factory(ObjectElement,form=Object_Form, extra=0, can_delete=True)
for form in myformset.forms:
    print(form.instance.id) #this does not print id of deleted record, but of the first existing record in the database.
    print(form.instance.attribute)# this prints the correct element, which was submitted by POST even for a deleted record.
    try: 
      objectInstance = ObjectElement.objects.get(id = form.instance.id)
      objectInstance.save()
    except ObjectElement.DoesNotExist:
      print("Do not save as the record has already been deleted") 
```

当我保存我的表单集而不删除任何记录时，保存工作正常并`form.instance.id`打印正确。但是，如果我使用 ajax 删除表单实例，然后尝试保存我的表单集，则已 `print(form.instance.id)`删除记录的似乎打印数据库中的第一个可用 id，而不是通过邮寄提交的 id。（由于记录被删除，id 不存在于数据库中，但它应该打印通过 POST 提交给它的内容吗？）

如果我在没有 try/catch 循环的情况下执行此操作，我会通过 form.errors 收到以下错误：

```
<ul class="errorlist"><li>id<ul class="errorlist"><li>Select a valid choice. That choice is not one of the available choices.</li></ul></li></ul> 
```

这似乎表明它不接受正确的表单 ID 从提交的帖子中删除记录。

任何人都知道我在这里缺少什么？或者更好的方法来做到这一点。

我们如何从表单集中动态删除表单，因为表单的顺序似乎应该是连续的..

提前致谢！！任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T15:55:44.277

对于那些偶然发现这个问题的人来说，这可能是一个可能的解决方案，我可以从表单集中动态删除我的表单，如下所示。

所以初始表单 html 看起来像

```
#form0
<input id="id_formprefix-0-id" type ="hidden "value="something" name="formprefix-0-id">
<input id="id_formprefix-0-field" value="something" type="text" name="formprefix-0-field">
#form1
<input id="id_formprefix-1-id" type ="hidden "value="something" name="formprefix-1-id">
<input id="id_formprefix-1-field" value="something" type="text" name="formprefix-1-field">
#form2
<input id="id_formprefix-2-id" type ="hidden "value="something" name="formprefix-2-id">
<input id="id_formprefix-2-field" value="something" type="text" name="formprefix-2-field"> 
```

现在假设我使用 ajax 从我的数据库中删除了 form0 和 form1 记录。当我提交表单时，表单集不会验证，因为它希望表单是有序的，而我在数据库中只剩下表单 2（我删除了前两个）。如问题中所述，带有“选择有效选择”的表单集错误。

因此，在我动态删除表单后，当我的 ajax 返回时，我不会更改`total_form_count`( [https://docs.djangoproject.com/en/1.4/topics/forms/formsets/#understanding-the-managementform](https://docs.djangoproject.com/en/1.4/topics/forms/formsets/#understanding-the-managementform) ) 但标记在我的 html 中删除的表单，然后隐藏表单。现在当使用 POST 提交表单集时，它也会提交已删除的表单，但标记为已删除（[https://docs.djangoproject.com/en/1.4/topics/forms/formsets/#can-delete](https://docs.djangoproject.com/en/1.4/topics/forms/formsets/#can-delete)）

现在在视图中，我先把已经删除的表单过滤掉，只对还剩下的表单进行处理，如下

```
marked_for_delete = formset.deleted_forms
    for form in formset.forms:
        #Filtering out the deleted records, as the formset will not validate, for deleted records
        # if we use form.instance.id or form.initial['id'] below it does not work. 
        #for some reason it returns the id of the first available record in the data base. 
        #form['id'].value(), gives us the id of the deleted element we are looking for
        if form['id'].value() not in [deleted_record['id'].value() for deleted_record in marked_for_delete]:    
            if form.is_valid():
                pass
                # save the form
            else:
                pass
                # error message 
```

# emacs - 使用 defcustom 创建可自定义的值时，如何验证用户的条目？

> ID：12414250
> 
> 赞同：5
> 
> 时间：2012-09-13T20:26:16.630
> 
> 标签：emacs, elisp

我正在编写一个正在演变成一个包的 elisp 文件，因此我将它的一些变量转换为`defcustom`语句并记录它们。其中一些`defcustom`变量是相关的，我想验证通过自定义系统输入的值以确保关系成立。

这是我所拥有的一个例子：

```
(defcustom widget-canonical-names '("my_widget" . "widget_assembly 8911_j4")
  "Documentation"
  :type '(alist :key-type (string :tag "Widget's short name")
                :value-type (string :tag "Full widget name"))
  :risky nil
  :group 'widgets)
(defcustom widget-colors '("my_widget" . "brown")
  "Documentation"
  :type '(alist :key-type (string :tag "Widget's short name")
                :value-type (color :tag "color of the widget"))
  :risky nil
  :group 'widgets)
(defcustom widget-paths '("my_widget" . "~/widgets")
  "Documentation"
  :type '(alist :key-type (string :tag "Widget's short name")
                :value-type (directory :tag "support files for widget"))
  :risky nil
  :group 'widgets) 
```

所以有小部件，它们有各种设置，我需要能够通过只知道小部件的短名称来访问小部件的任意设置。我想制作某种验证功能（不幸的是，谷歌搜索“emacs defcustom validate”没有帮助）这样如果用户在列表中输入`widget-paths`或`widget-colors`不在`widget-canonical-names`列表中的小部件名称，他们会得到一个“你确定吗？” 警告并注意输入不匹配的名称。我可以将这样的验证功能附加到我`defcustom`的 s 上吗？如果是这样，它的语法是什么？

当然，理想的做法是让用户输入一次短名称，但我无法从“复合类型”elisp 文档中弄清楚如何做到这一点。因此，对我的问题的更好回答将告诉我如何安排一个`defcustom`设置类似于此 Python dict 的数据结构的 a：

```
customized_widgets = {
    "my_widget": { "canonical_name": "widget_assembly 8911_j4",
                   "widget_color": "brown",
                   "widget_path": "~/widgets",
                 },
    "another_widget": { "canonical_name" : "widget_obsolete 11.0",
                        "widget_color": "blue",
                        "widget_path": "~/blue_widgets",
                      },
     } 
```

那么：我怎样才能获得我想要的行为，根据将用于访问它们的数据对设置进行分组，或者验证功能在用户可能输入不一致的数据时警告用户？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T00:42:49.480

这将定义与该 Python 结构最接近的 Emacs 等效项，其中 dict 表示为 alist，内部 dict 的固定键表示为符号。

```
(defcustom my-customized-widgets ()
  "My widget customization alist"
  :type '(alist
          :tag "Widgets"
          :key-type (string :tag "Short name")
          :value-type
          (set
           :format "%v"
           :entry-format "%b %v"
           (cons :format "%v"
                 (const :format "" widget-canonical-name)
                 (string :tag "CName"))
           (cons :format "%v"
                 (const :format "" widget-color)
                 (color :tag "Color"))
           (cons :format "%v"
                 (const :format "" widget-path)
                 (directory :tag " Path"))))
  :group 'widgets) 
```

# arrays - Excel Max 来自数据子集 MAX IF IF

> ID：12414251
> 
> 赞同：1
> 
> 时间：2012-09-13T20:26:19.917
> 
> 标签：arrays, excel, if-statement, max

我有一组数据如下：

![在此处输入图像描述](../Images/fbcdab2689a82770ba1536eb0377abba.png)

在“最新”列中，我想打印 MAX(StepNumber) 的“最新”，其中每个 ManufacuringOrderId 的 tracked =“是”。我可以尝试在 SQL 中执行此操作，但也想看看是否可以使用数组公式来执行此操作。因此，如果这行得通，第 9 行会说“最新”，而从底部向上的第 4 行和第 5 行也会说“最新”。

我尝试了该公式`{=MAX(IF(A:A=[@ManufacturingOrderId],F:F))}`返回每个的最大步骤编号`ManufacturingOrderId`，并且该公式`{=MAX(IF([@Tracked]="Yes",IF(A:A=[@ManufacturingOrderId],F:F)))}`将返回每个制造 ID 的最大步骤编号，该制造 ID 具有跟踪的流程步骤。

但是，我无法找到一种方法来确定为每个制造订单 ID 跟踪流程步骤的最大步骤编号。对于制造订单 ID 5601774，步骤编号为 160，对于 MOID 5624276，步骤编号为 150。

帮助和感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:38:39.753

如果我正确理解了这个问题，那么您应该能够在 MAX. 然后只需检查该号码是否与当前号码匹配，`StepNumber`如果匹配则说“最新”。

```
{=IF(MAX(IF(AND(A:A=[@ManufacturingOrderId], [@Tracked]="Yes"),F:F)) = [@StepNumber], "Latest", "")} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T22:25:04.130

当 Tracked 为“是”时，您可以使用此数组公式获取每个 OrderId 的最大步数

`=MAX(IF([ManufacturingOrderId]=[@ManufacturingOrderId],IF([Tracked]="Yes",[StepNumber])))`

....所以要在正确的行中获得“最新”，您需要检查不仅 Stepnumber = 该值，而且该行中是否存在“是”，即

`=IF(AND([@StepNumber]=MAX(IF([ManufacturingOrderId]=[@ManufacturingOrderId],IF([Tracked]="Yes",[StepNumber]))),[@Tracked]="Yes"),"Latest","")`

用 CTRL+SHIFT+ENTER 确认

**修订：**这个版本应该更有效 - 使用两个`IF`s，而不是`AND`意味着`MAX(IF`公式的长部分只需要对行进行评估`[Tracked]="Yes"`

`=IF([@Tracked]="Yes",IF([@StepNumber]=MAX(IF([ManufacturingOrderId]=[@ManufacturingOrderId],IF([Tracked]="Yes",[StepNumber]))),"Latest",""),"")`

[注意AND这里用于检查2个单一结果条件，不在数组部分内]

# windows-runtime - 将 Web API 调用映射到本地类

> ID：12414254
> 
> 赞同：0
> 
> 时间：2012-09-13T20:26:44.707
> 
> 标签：windows-runtime, .net-4.5, asp.net-web-api

我正在使用我的 ASP.NET Web API 服务。当我使用经典 Web 服务时，Visual Studio 会为我生成映射类。是否有一些库或方法可以自动将 HTTP Web API 调用映射到我的类？我正在使用 WinRT 应用程序，但我想将来将此逻辑移动到便携式库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T22:42:38.197

您很可能正在使用从 WebAPI URI 返回的类。您可以在 WinRT 应用程序上使用这些相同的类。您需要反序列化对对象的 HTTP 调用的结果。如果您的 WebAPI 项目返回默认 JSON 格式，那么您可以使用 JSON.Net 反序列化

# php - 如何找出字符串中的某个单词是否大于 PHP 中的 50 个字符？

> ID：12414258
> 
> 赞同：0
> 
> 时间：2012-09-13T20:27:03.957
> 
> 标签：php

如何在 PHP 中做这样的事情？我喜欢这个论坛唯一的 C# 解决方案[如何检查字符串是否包含超过 50 个字符的单词？](https://stackoverflow.com/questions/5760070/how-to-check-if-a-string-contains-a-word-longer-than-50-characters)

例如我有一个字符串：

```
$string_to_check = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa rrrr fe we we hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhererererereerdfsdfsdfsdfsdfsdfsdfsdfsdfsdfttttfsd hhghhhhhhhhhhhhhhhhhh fd s hoefjsd k
bla bla bla"; 
```

而且我想创建一个 if 条件，所以当字符串包含一个长度为 50 个或更多字符的单词时，返回 false；否则返回真；

任何如何解决这个问题的建议表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T20:30:10.733

试试这个功能：

```
function not_long_word($sentence, $length = 50) {
    $words = explode(' ', $string);
    foreach ($words as $key => $value) {
      if (strlen($value) > $length) return false;
    }
    return true;
} 
```

用法：

```
$text = "word wooooooooooooooooooooooooooooooooooooooooooooooooooooooooooord";
if (not_long_word($text)) {
    echo "there no word longer than 50!";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-12T11:07:35.423

```
$str = "a word in-this-string-contains-fifty-or-more-ch ";

if(preg_match('/\S{50,}/',$str)) 
{ 
   echo 'String contains a word of more than 50 characters'; 
} 
else 
{ 
   echo 'String does not contains a word of more than 50 characters'; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T20:31:26.230

它应该是这样的：

```
if(strlen($string_to_check) < 50 )
{
 ...
}
else {
...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T20:31:57.347

首先，将其拆分成单独的单词（假设空格是分隔符），然后找出是否有任何单词超过 50 个字符：

```
$array = explode(" ",$string);
foreach ($array as $word) { 
  if (strlen($word) > 50) {
    echo "{$word}\n"
  }
} 
```

如果分隔符可能有多个空格/制表符，那么您可以选择正则表达式：

```
$array = preg_split('[\t\s]+', $string); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T21:28:28.863

对此进行了测试，效果很好。

```
check_word_length( $string_to_check );

function check_word_length( $string_to_check ){
    foreach ( explode(' ', $string_to_check )  as $word) {
        if ( strlen($word) > 50 ) return false;
    }
    return true;
} 
```

# c# - 将静态类属性绑定到文本框

> ID：12414259
> 
> 赞同：1
> 
> 时间：2012-09-13T20:27:04.800
> 
> 标签：c#, wpf, data-binding, static

我想将 a 绑定`textbox`到静态类的属性。我希望这是双向绑定。我的静态类是这样的（修剪）：

```
public static class ocrVar
{
    static ocrVar()
    {  
        MeterNumber = new Element();
    }
} 
```

Element 类看起来像这样（修剪）：

```
public class Element
    {

        public List<string> Value { get; set; }

        public Element()
            : this(new List<string>())
        {
        }
        public Element(List<string> value)
        {
        Value = value;
        }
    } 
```

如果我想获取 a`TextBox`并将其绑定到 ocrVar.MeterNumber.Value[0]，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:40:49.730

由于它是**静态**类，并且您想要执行**双向绑定**，因此您已经提供了路径并提供了一个非静态类作为技巧并使用绑定

在你的情况下，将是

```
<Window.Resources>
    <local:ocrVar x:Key="ocrVarManager"/>
</Window.Resources>

<TextBox Text="{Binding Source={StaticResource ocrVarManager}, Path=MeterNumber.Value[0]}"/> 
```

你可以参考[绑定到静态属性](https://stackoverflow.com/questions/936304/binding-to-static-property)

# asp.net-mvc-3 - EF 4.1 / SQL Server CE 4.0 没有本地 SQL Server Express

> ID：12414263
> 
> 赞同：1
> 
> 时间：2012-09-13T20:27:37.873
> 
> 标签：asp.net-mvc-3, entity-framework, entity-framework-4.1, sql-server-ce

我有一个 MVC3 项目，它首先使用 EF 4.1 数据库和 SQL Server CE 数据库。在我安装了 SQL Server Express 的开发盒上，一切正常。但是，当部署到未安装 SQL Server Express（或任何 SQL Server 实例）的另一台服务器时，连接失败是可以理解的。是否可以在没有本地 SQL Server 实例的机器上将 EF 4.1 与 SQL Server CE 数据库一起使用？

即使我尝试引用远程 SQL 实例，我也会收到错误

> *键“attachdbfilename”的值无效*

以下是连接字符串的样子：

```
 <add name="AlertsEntities" connectionString="metadata=res://*/Models.AlertsModel.csdl|res://*/Models.AlertsModel.ssdl|res://*/Models.AlertsModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.\SQLEXPRESS;attachdbfilename=|DataDirectory|\Alerts.mdf;integrated security=True;connect timeout=30;user instance=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T19:26:18.943

只是为了更新我们如何解决这个问题，我们最终只是将 SQL express 安装在与使用 SqlCE 的应用程序相同的服务器上。我接受这个答案只是因为另一个人根本没有真正回答这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:31:24.987

实际上，我不久前就在博客上写过。[http://enterpriseyness.com/2011/11/deploying-an-asp-net-web-application-with-sql-ce-4-entity-framework-without-installation/](http://enterpriseyness.com/2011/11/deploying-an-asp-net-web-application-with-sql-ce-4-entity-framework-without-installation/)

如果您在 web 项目上单击鼠标右键，您将看到一个“添加可部署依赖项”菜单项。另外，不要忘记将 SQL CE 提供程序工厂添加到您的 Web.config。

![添加可部署的依赖项](../Images/48d0bc3328c3f6ed03c159bd2241209e.png)

# c - 如何在 vxworks 6.7 中为内核前调试设置 wdb？

> ID：12414267
> 
> 赞同：0
> 
> 时间：2012-09-13T20:28:13.677
> 
> 标签：c, assembly, kernel, vxworks

我是 RTOS 世界的新手，正在开发 vxworks 6.7 的 eval 版本。我不知道如何为我的引导加载程序打开 wdb 调试，它在加载我的网络驱动程序时遇到问题。我希望有人可以帮助我快速提示。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:38:44.337

您是否通过串行连接进行调试？如果没有，则可能无法调试网络问题。wdb 在 eclipse 中的主机上运行，​​并通过串行或以太网连接到设备（目标）。无论如何，您在构建引导加载程序时通过项目打开 wdb 支持。

# mercurial - 当 Mercurial 中存在未完成的本地更改时，撤消对单个文件的早期更改

> ID：12414270
> 
> 赞同：0
> 
> 时间：2012-09-13T20:28:24.410
> 
> 标签：mercurial

每隔一段时间，当我进行本地更改时，我会意识到我想撤消对特定文件的先前修订中所做的更改，而我正处于一组更改的中间。例如：

*   r1000 - 更改文件 A 和 B
*   ... - 任意数量的中间更改
*   工作副本：几个文件的未完成更改

在这一点上，我意识到我想完全撤消对 r1000 中文件 A 的更改，作为我正在处理的更改的一部分。

如果我没有任何本地更改，我可以使用`hg backout`. 我试过使用`hg revert -r "1000^" A`，但我收到一条消息，说 A 不受父变更集 1000 的影响。

那么，作为我当前更改的一部分，从先前更改集中的单个文件恢复更改的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:28:24.410

所以当我写这篇文章时，我遇到了命令`--reverse`上的标志。`hg diff`将这个想法与`hg import`问题中的示例结合起来会给出如下命令：

```
hg diff -c 1000 -I A --reverse | hg import --no-commit --force - 
```

这会为单个目标文件创建 r1000 中更改的反向补丁，然后将其传递到`hg import`当前工作目录而不提交。

# javascript - 为什么当 for 循环为 3 时 JavaScript 总是提示 4？

> ID：12414271
> 
> 赞同：2
> 
> 时间：2012-09-13T20:28:26.607
> 
> 标签：javascript, for-loop

为什么这个 JavaScript 在 for 循环为 3 时总是提示 4？

```
// alert
function reOrderLayers(layerToaAlter) {
alert(layerToaAlter);
}

// prepare
var laCount;
for (laCount = 1; laCount <= 3; laCount++) {
    var la = document.getElementById("layerChanger"+laCount);
    la.addEventListener("click", function () { reOrderLayers(laCount) });
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:33:46.560

当循环完成意味着`i`is `>3`，要在函数调用中保留特定数字，请使用闭包：

```
 la.addEventListener("click", (function(count) { return function () { reOrderLayers(count) } })(laCount)  ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T20:31:24.250

for 循环一直持续到`laCount == 4`（最后一次执行循环时，值为 3，然后递增到 4，因此循环测试失败）。因此，for 循环后的值为 4。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T20:30:40.370

因为当你点击元素时；for 循环已经完成，laCount 的当前值为 4；

您应该为每个 layerChanger 创建一个上下文来保存 laCount：

```
function reOrderLayers(layerToaAlter) {
   alert(layerToaAlter);
}
function context(la, laCount){

         la.addEventListener("click", function () { reOrderLayers(laCount) });
  }

// prepare
var laCount, la;
for (laCount = 1; laCount <= 3; laCount++) {
    la = document.getElementById("layerChanger"+laCount);
    context(la, laCount);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T20:32:21.287

您没有`reOrderLayers`立即在循环中调用，而是构造了一个函数文字。文字将有一个闭包，它指的`laCount`是环境中的变量，当点击事件最终被触发时，该变量将为 4。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T20:31:44.560

因为：

```
var c = 0;
for(c = 1; c <= 3; c++) {};
alert(c); // alerts 4. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-13T20:32:18.267

在前 3 次迭代中，`for`循环进入主体并执行您内部的代码。一旦你进行了第 4 次迭代，`lacount`就会增加并且条件失败，这样你就不会再次进入循环。

如果出于某种原因需要`lacount`，`3`您可以尝试将初始 for 循环条件设置为`i < 3`.

# codeigniter - 在代码点火器中获取“调用非对象上的成员函数函数（）”错误

> ID：12414276
> 
> 赞同：0
> 
> 时间：2012-09-13T20:28:44.083
> 
> 标签：codeigniter, php

我对 CodeIgniter 很陌生，不是 OOP 方面的专家，所以请多多包涵。

这是我的模型中的功能：

```
function get_company(int $user_id, $fields = '*'){
    $r = $this->db->query("SELECT $fields FROM ".$this->db->dbprefix('companies')." WHERE user_id=?", $user_id)->row();
    return $r;        
}
function get_profile($user_id, $fields = '*'){
    $r = $this->db->query("SELECT $fields FROM ".$this->db->dbprefix('users_profiles')." WHERE user_id=?", $user_id)->row();
    return $r;        
} 
```

这是在我的控制器中调用该模型：

```
function index(){ 
    $this->load->model('profiles_m');
    $profile = $this->profiles_m->get_profile($this->access->getUid());
    $company = $this->profile_m->get_company($this->access->getUid());      

    $vars = array(
            'profile'=>$profile, 
            'company'=>$company,        
        );

    $this->_getTemplate()->build('account', $vars);
} 
```

在我看来：

```
$company = array(
        'name'     => 'company',
        'id'          => 'company',
        'value'       => "$company->name",
        'class'       => 'styl_f validate[required] text-input input-xlarge',
        'placeholder' => "$company->name"
);

echo $company['value'] 
```

我得到的错误是：`Call to a member function get_company() on a non-object in C:\..\application\modules\accounts\controllers\accounts.php` 我的印象是我收到了这些错误，因为我通过 get_company() 传递了一个非对象，但让我感到困惑的是 get_profile() 没有出现这个错误；我的模型中的 get_profile() 函数与我的 get_company() 函数非常相似。是什么导致了这个错误？我怎样才能摆脱它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:33:33.143

问题出在您的控制器中：

```
function index(){ 
    $this->load->model('profiles_m');
    $profile = $this->profiles_m->get_profile($this->access->getUid());
    $company = $this->profile_m->get_company($this->access->getUid()); // Right here

    $vars = array(
            'profile'=>$profile, 
            'company'=>$company,        
        );

    $this->_getTemplate()->build('account', $vars);
} 
```

$profile 变量`$this->profiles_m`用作对象，但 $company 缺少对象中的字母 's'。

试试这条线：

```
 $company = $this->profiles_m->get_company($this->access->getUid()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:33:23.447

您有一个错字，该行应为：

```
$company = $this->profiles_m->get_company($this->access->getUid()); 
```

注意“profiles_m”而不是“profile_m”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T20:34:59.597

```
 $company = $this->profile_m->get_company($this->access->getUid()); 
```

将“profile_m”替换为“profiles_m”

# windows - 尝试通过 Fitnesse 运行 Watir 测试时出错

> ID：12414277
> 
> 赞同：0
> 
> 时间：2012-09-13T20:28:51.773
> 
> 标签：windows, testing, selenium, watir, fitnesse

我最近一直在尝试运行以下教程： [http ://raveendran.wordpress.com/2010/10/20/watir-integration-with-fitnesse/](http://raveendran.wordpress.com/2010/10/20/watir-integration-with-fitnesse/)

但是，当我尝试在 Fitnesse 中运行测试时，它只是坚持“运行测试”而不做任何事情。我试图替换一些语法、格式等，但我得到了相同的结果。有谁知道如何成功实施本教程？

非常感谢您提供的任何帮助。马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:52:08.777

我记得是这样做的。很难正确设置。我记不太清了，但在[Faucets](http://faucets.rubyforge.org/)有一个固定装置对我有帮助。祝你好运。

# java - REST lib 为 Java REST API 提供了什么

> ID：12414283
> 
> 赞同：1
> 
> 时间：2012-09-13T20:29:16.840
> 
> 标签：java, rest, jersey

有一个实现 REST（某种）的 Web 服务，

*   为某些实体发出客户端请求
*   服务器填充模型（使用 JAXB 创建）
*   转换为 Xml 并返回
*   客户端将 Xml 读入相同的 JAXB 模型

这工作正常，但我不使用任何 REST 库。我是否错过了，我看不出它们可以隐藏什么复杂性，因为发送/接收请求和转换到/从 JAXB 的代码已经非常简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:40:41.543

对于您的基本用例，您可能不会从使用 JAX-RS ( [http://en.wikipedia.org/wiki/Java_API_for_RESTful_Web_Services](http://en.wikipedia.org/wiki/Java_API_for_RESTful_Web_Services) ) 中受益，它是 REST 的 Java 标准。

但是，正如您通过链接看到的那样，有一些有用的注释，可能会让您以后的生活更轻松。例如，如果您也开始在 xml 旁边返回纯文本，基于请求标头，那将变得非常容易配置（使用 @Produces）。当您想要支持多种类型的请求有效负载（@Consumes）时也是如此。

检查[http://docs.oracle.com/javaee/6/tutorial/doc/gkknj.html](http://docs.oracle.com/javaee/6/tutorial/doc/gkknj.html)以获得好的教程。

简而言之，JAX-RS 在请求标头、参数等方面提供了许多有用的功能，否则这些功能将难以实现。但是，许多应用程序不需要这种“完整的细粒度 REST”支持，因此仅使用 JAXB 可能就足以满足您的需求。

# java - Comparator 可以比较两个不同类型的对象吗？

> ID：12414288
> 
> 赞同：7
> 
> 时间：2012-09-13T20:29:31.740
> 
> 标签：java, comparator

我有两个类 Person 和 Employee 的对象。两个类都有共同的属性年龄。而且我已经将这两个类的几个对象添加到 Arraylist 中，现在我想要两个写一个 Comparator 并将其传递给 Collections 类的 sort 方法。并希望根据年龄对列表进行排序。我尝试这样做只是为了更清楚地了解 Java 中 Comparable 和 Comparator 的使用。

编辑：我问这个问题的原因是我不清楚 Comparator 和 Comparable。我在某处读到如果 Class 实现 Comparable 那么它不能与其他类的对象进行比较（因为 Class cast 异常）。

现在，如果我在 Employee 和 Person 中创建关系，则无需实现 Comparator（除非我想根据这些类的名称或其他公共属性进行排序）。

再一次，我问了这个问题是为了更清楚地了解 Comparator 和 Comparable。

到目前为止，我能够理解的是，如果我想对多个参数进行排序，那么我应该实现 Comparator 并将其传递给 Collections.srot()。

或者，如果我无法控制正在排序的对象的类，那么我应该实现比较器的自定义排序。（如果我错了或者我遗漏了什么，请纠正我）

**编辑**

我想现在我理解了 Comparable 和 Comparator 的使用。为了确保我得到正确的概念，我的理解是：如果我想比较不同类的两个对象（并且没有关系），那么我应该使用原始比较器并覆盖比较方法。有人会实施 Comparator 而不是 Comparable 的另一个原因是在排序方面具有灵活性。而我从自然排序中所理解的，是 Class 在 CompareTo 方法中实现的逻辑。

希望我对所有这些观点都是正确的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T20:35:10.657

您可以定义一个名为 Ageable 的接口，Employee 和 Person 可以实现该接口。您也可以定义一个具有相同效果的抽象类（Employee 和 Person 将从抽象类继承）。请注意，出于这个原因，您也可以使用普通类，您可以做任何您需要的事情。

此外，如果没有理由说 Employee 不是 Person（例如机器人在办公室工作），那么 Employee 可以从 Person 继承。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T20:34:59.647

我会让 Employee 成为 Person 的子类。（假设你所有的员工都是人）那么你可以创建一个`Comparator<Person>`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T20:34:13.320

您应该创建一个接口`AgeProvider`：

```
public interface AgeProvider {
    int getAge();
} 
```

两者都`Person`应该`Employee`实施`AgeProvider`。现在您可以实现一个比较 2 的 Comparator `AgeProvider`。

# ios - Info.plist 及其变量，如 ${APPNAME}

> ID：12414290
> 
> 赞同：9
> 
> 时间：2012-09-13T20:29:39.377
> 
> 标签：ios, plist

我正在为我的 iOS 应用程序准备 Info.plist。我想仔细设置每个选项。但是，有一些奇怪的变量，如 ${REGION}、${APPNAME}、${EXTRA_ICONS} 等。我猜它们是通过 Xcode 设置的？

我不希望 Xcode 弄乱这些值。我可以简单地设置它们吗？例如，对于 ${REGION} 插入“en”。对于 CFBundleDisplayName – <strong>什么都没有，因为文档说：

> 如果你不打算本地化你的包，不要在你的 Info.plist 文件中包含这个键。包含此键不会影响包名称的显示，但会导致搜索此键的本地化版本时的性能损失。

等等。我可以简单地做到这一点吗？为“CFBundleExecutable”插入什么？我想我必须知道 Xcode 生成了什么？

这是一个可怕的设计，因为有两个值来源：plist 本身，以及 Xcode 中的一些愚蠢的元 plist。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T20:36:12.467

由于您的项目的“扩展 Info.plist 文件中的构建设置”（）构建设置，您的`Info.plist`文件由 Xcode 处理。`INFOPLIST_EXPAND_BUILD_SETTINGS`

这通常是一个很棒的功能，因为它避免了根据您的构建设置和配置而拥有不同的 Info.plist，并避免您在多个位置修改设置。但如果您真的不想要它，只需在项目或目标的 Build Settings 中关闭此设置即可。

* * *

我建议您仍然保持此设置，以便在您的构建设置中选择的值将在您的 Info.plist 中报告，如果您需要更改应用程序名称等内容，请直接在构建设置中进行更改。这样，您将保持构建设置和 Info.plist 文件之间的一致性，而不是冒着配置不一致的风险。

一个很好的例子是您在自己的问题中自己写的：文件的`CFBundleExecutable`条目`Info.plist`。此条目通常必须包含您的包中的可执行文件的名称（以便 iOS 知道要在您的 .ipa 包中启动哪个可执行文件）。

此值通常取决于您的构建设置，通常是`EXECUTABLE_NAME`构建设置。如果您曾经更改生成的可执行文件的名称（在项目或目标的构建设置中）并且确实在 Info.plist 中为该值放置了一些常量字符串，您显然需要将此`CFBundleExecutable`键更改为Xcode 生成的可执行文件。如果您将`${EXECUTABLE_NAME}`其用作此键的值（并在项目设置中保持对 Info.plist 的处理处于打开状态），Xcode 将为您替换它，确保 Info.plist 与您的构建设置和名称一致它生成的可执行文件。

*我看不到通过 Xcode 禁用 Info.plist 文件的此处理阶段的任何优势；您应该利用它并继续使用`${xxx}`构建变量，以便在编译时动态地将它们替换为实际值 Xcode，从而确保一致性并避免错误。*

# iis-7 - 动态子域的 IIS7 通配符映射

> ID：12414291
> 
> 赞同：0
> 
> 时间：2012-09-13T20:29:53.673
> 
> 标签：iis-7, dns, wildcard-subdomain

我在 IIS 中有这个设置： 1- 默认网站 2- Site1: binding test.example.com:10.10.10.10:80

我想让 *.test.example.com 指向 Site1，所以如果我去 test1.test.example.com 我会在 Site1 上看到应用程序，请注意我在 DNS 中有多个 A 记录：test.example .com 10.10.10.10 *.test.example.com 10.10.10.10

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:33:48.810

这个问题可能更适合服务器故障。长话短说，这在 IIS 中是不可能的。在 IIS 论坛中查看[此帖子。](http://forums.iis.net/p/1095760/2029983.aspx)

# css - 自定义滚动条不适用于 Firefox

> ID：12414296
> 
> 赞同：0
> 
> 时间：2012-09-13T20:30:17.470
> 
> 标签：css, firefox, webkit, scrollbar, customization

我创建了一个网站。我自定义了主垂直滚动条。

它适用于 Google Chrome 和 Safari，但不适用于 Mozilla Firefox。

你有什么想法来解决这个问题吗？

CSS 代码

```
::-webkit-scrollbar {                                   
    width: 10px;
    height: 6px;
    background: #FFF url(images/bg-blog-repeat.png) 0 0 repeat;
}

::-webkit-scrollbar-thumb {                             
    border: solid 0 transparent;
    border-right-width: 4px;
    -webkit-border-radius: 5px;
    -webkit-border-top-right-radius: 9px 5px;
    -webkit-border-bottom-right-radius: 9px 5px;
    -webkit-box-shadow: inset 0 0 0 1px rgb(79,79,79), inset 0 0 0 6px rgb(102,102,102);
}
::-webkit-scrollbar-thumb:hover {                       
    -webkit-box-shadow: inset 0 0 0 1px rgb(90,90,90), inset 0 0 0 6px rgb(110,110,110);
}
::-webkit-scrollbar-thumb:horizontal {                  
    border-right-width: 0;
    border-bottom-width: 2px;
    -webkit-border-top-right-radius: 5px;
    -webkit-border-bottom-right-radius: 5px 9px;
    -webkit-border-bottom-left-radius: 5px 9px;
}
::-webkit-scrollbar-corner {                            
    background: #FFF url(images/bg-blog-repeat.png) 0 0 no-repeat;
}

body ::-webkit-scrollbar {
    background: transparent none;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-13T20:42:36.533

对于以 -webkit- 开头的每一行，写另一个完全一样的，将 -webkit- 替换为 -moz-

# ruby-on-rails - 如何分析“未定义方法`attribute_method_matcher'”错误的来源？

> ID：12414297
> 
> 赞同：0
> 
> 时间：2012-09-13T20:30:20.740
> 
> 标签：ruby-on-rails, ruby

在 Rails 控制器中创建新类时出现错误。

我怎么能理解这里发生了什么？谢谢

```
Error:
NoMethodError in MystudentsController#new

undefined method `attribute_method_matcher' for nil:NilClass  
Rails.root: E:/Nam 4 HK 1/TT CNPM/workspace/lab2

app/controllers/mystudents_controller.rb:27:in `new'
app/controllers/mystudents_controller.rb:27:in `new' 
```

这是`mystudent_controller.rb`文件中的新功能：

```
def new    
  @mystudent = Mystudent.new
  respond_to do |format|
    format.html # new.html.erb
    format.xml  { render :xml => @mystudents }
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T18:06:14.167

我相信您在表中的列名之一是保留字。
为学生、班级或类似的东西寻找典型的东西......
这通常会触发这个 - ` **attribute_method_matcher** '

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-16T18:10:07.037

你那里有一个错字。`@mystudents`需要`@mystudent`。

您收到此错误消息是因为变量`@mystudents`[sic] 从未被分配，因此为 nil。

# c++ - 在 C++ 中重载复制构造函数

> ID：12414298
> 
> 赞同：0
> 
> 时间：2012-09-13T20:30:26.967
> 
> 标签：c++

我想知道复制构造函数的概念，这个概念很清楚。谁能告诉我如何在 C++ 中重载复制构造函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:34:35.097

复制构造函数是一个简单的构造函数，它引用另一个相同类型的实例。它必须具有以下签名之一：

```
 MyClass( const MyClass& other );
 MyClass( MyClass& other );
 MyClass( volatile const MyClass& other );
 MyClass( volatile MyClass& other ); 
```

如果你愿意，你可以实现所有这四个，尽管我不认为采用非常量引用的复制构造函数有多大意义。

# excel - 在 vbscript 中使用 createobject 打开带有宏的 Excel

> ID：12414300
> 
> 赞同：0
> 
> 时间：2012-09-13T20:30:33.817
> 
> 标签：excel, vbscript, vba

我在personal.xls 中编写了一些宏，以便在我打开任何excel 文件时可以使用它们

但是，当我使用 vbscript - CreateObject("Excel.Application") 打开一个 excel 文件时，personal.xls 中编写的宏不可用

知道当我使用代码打开 excel 时如何获取这些宏。

谢谢，什里坎特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:42:58.473

我找到了答案。我应该打开personal.xls，然后打开所需的文件。这样，personal.xls 中的宏就可以使用了。

```
 Set PRSNL = XL.Workbooks.Open("Path to Personal.xls")
  XL.Visible = True    
  Set WKB = XL.Workbooks.open(Path to required file) 
```

# javascript - 通过 jQuery 获取 div 的值

> ID：12414304
> 
> 赞同：2
> 
> 时间：2012-09-13T20:31:02.787
> 
> 标签：javascript, jquery, innerhtml

我有 2 个不断更新的跨度，其中包含坐标。这些跨度是从其他人编写的对更改非常敏感的单独 js 文件更新的。

我可以很好地看到跨度并且它们正在更新坐标也很好，但是我需要通过链接将它们作为变量传递。例如，我在页面上有一个链接`some.php?var1=[value of constantly updating div1]&var2=[value of constantly updating div2]`，我需要用户能够单击该链接。

我需要这个链接，当单击时，获取跨度的值并将其提交给页面处理程序（`some.php`在这种情况下），或者只是不断地从跨度更新。我试图获得跨度的 innerHTML 值，但它似乎并没有工作，虽然不断更新它们....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:34:13.233

使用 .text() 函数从跨度 onClick 中获取文本值 - [http://api.jquery.com/text/](http://api.jquery.com/text/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:43:10.357

假设您的`<span>`元素有 ID：

```
<span id="var1">(constantly updating)</span>
<span id="var2">(constantly updating)</span> 
```

然后只需构建一个占位符链接：

```
<a href="#" id="link">click me!</a> 
```

下面的 jQuery 应该可以解决问题：

```
$(document).ready(function() {
    $('#link').click(function() {
        window.location = 'some.php?var1=' + 
            $('#var1').text() + '&var2=' + $('#var2').text();
    });
}); 
```

您可能还需要考虑对元素的值使用[encodeURIComponent()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent)`<span>`以确保它们正确传递，除非您始终确定值的格式是 URI 安全的。

# extjs - 如何在 ExtJs 中创建 ImageMap？

> ID：12414306
> 
> 赞同：0
> 
> 时间：2012-09-13T20:31:10.697
> 
> 标签：extjs, extjs3

我正在 ExtJS 3.4 中创建一个登录页面。它有一个图像，我想创建一个图像映射，因此当用户单击图像时，它会转到外部站点。

这是代码：

```
var headerImage = new Ext.BoxComponent(
    { autoEl:
        { 
            tag: 'img',
            src: AVRMS.ROOT_CONTEXT + "/ssl/images/LoginHeader.png"
        } });

    var loginButton = {
        xtype: 'compositefield',
        id: 'cmpLogin',
        combineErrors: false,
        height: 50,
        items: [
                {
                    xtype: 'displayfield',
                    value: ''
                },
            {
            xtype: 'button',
            text: 'Login',
            listeners: {
                click: function () {
                    loginUser();
                }
            }
        }]
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T13:31:58.963

这是我最终使用的：

```
var imageMap = "<map name='imgMap'><area shape='rect' coords='23,185,233,241' href='http://www.ohio.gov' /><area shape='circle' coords='670,201,50' href='" + manageAccount + "' /></map>";
var imageUrl = "<img src='" + AVRMS.ROOT_CONTEXT + "/ssl/images/LoginHeader.png" + "' usemap='#imgMap' />";

var headerImage = new Ext.Panel(
    { items: [
        {
            html: imageMap + imageUrl
        }]
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T08:10:42.807

我做了类似的事情，我使用了这个 ExtJS 库：[http](http://code.google.com/p/imgmap/) ://code.google.com/p/imgmap/ 。你可以找到非常好的和有用的例子。享受！

# php - 基本的 PHP 需求/目录结构

> ID：12414316
> 
> 赞同：0
> 
> 时间：2012-09-13T20:31:37.853
> 
> 标签：php

当前结构：

```
htdocs
  mums
    demo.php
    login.php
    mums
      classes
        mums.class.php
      includes
        global.inc.php
        config.inc.php 
```

我想在 config.inc.php 中保留 mysql 数据库信息和包含 mums 文件夹（内部文件夹）的文件夹的位置。例子：

```
// CONFIG
$mumsConfig['dbName'] = 'mums';
$mumsConfig['dbUser'] = 'root';
$mumsConfig['dbPass'] = 'pass';
$mumsConfig['dbHost'] = 'localhost';
$mumsConfig['folder'] = 'mums';
// END CONFIG 
```

我想将配置文件包含在任何需要它的 class.php 文件以及每个需要它的页面的 global.inc.php 文件中。问题是我将库的位置 ($mumsConfig['folder']) 存储在配置文件中，所以在我知道之前我不能包含 config.inc.php 文件，它在文件本身中......

我真的不知道如何设置一个非常简单的配置文件。仅供参考，这一切都留在局域网上，因此无需担心安全性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:51:25.027

由于两个包含文件都在同一个目录中，即在包含下。你可以`require('config.inc.php')`在 global.inc.php 中做

# sql - 关于 SQL 连接语句

> ID：12414320
> 
> 赞同：1
> 
> 时间：2012-09-13T20:31:44.643
> 
> 标签：sql

我有三个 SQL 表：TableA、TableB 和 TableC

TableA 是主键表，外键在TableB 和TableC 中（即TableA 分别连接到TableB 和TableC）。

例子：

```
TableA: tableA_id
TableB: tableB_id, tableA_id
TableC: tableC_id, tableA_id 
```

我想从tableA返回记录，它与tableB中的记录匹配（内连接），但返回的记录不在tableC中。这可以用一条 SQL 语句来完成吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:33:56.587

```
select a.x, b.y
from tablea a
inner join tableb b on a.x = b.x
where not exists (select null 
                  from tablec c 
                  where a.x = c.x) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:34:17.323

认为这是一种方法 - 与 b 匹配的 a 中的所有内容，但与 c 不匹配...

```
select a.*
  from TableA
  join TableB
    on TableA.tablea_id=TableB.tablea_id
  left outer join TableC
    on TableA.tablea_id=tableC.Tablea_id
 where Tablec.tablea_id is null 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T20:37:20.210

您需要为表 C 添加另一个连接，特别是[左外连接](http://en.wikipedia.org/wiki/Join_%28SQL%29#Left_outer_join)，然后过滤行`where Tablec.tablea_id is null`

# asp.net - HttpContext.Current.User.Identity.Name 在同一网站的所有应用程序中共享：这不是不安全吗？

> ID：12414321
> 
> 赞同：2
> 
> 时间：2012-09-13T20:31:55.357
> 
> 标签：asp.net, authentication, forms-authentication

我很惊讶：我在同一个网站下创建了 2 个独立的应用程序（假设为 2 个不同的客户）。我在每个 web.config 中都有单独的登录名/密码列表，但我可以将第一个应用程序的 HttpContext.Current.User.Identity.Name 放入第二个应用程序！

会话变量在 2 之间不共享，但对于 HttpContext.Current.User.Identity.Name 来说这仍然很不安全吗？这意味着客户端 2 将能够访问客户端 1 用户浏览客户端 2 应用程序，而无需验证客户端 2 网站。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T00:45:37.260

如果您在每个应用程序的 web.config 中的 machinekey 元素中使用不同的解密密钥，它将确保用户在不重新登录的情况下无法在应用程序之间导航。

以下示例来自[MSDN](http://msdn.microsoft.com/en-us/library/eb0zx8fc%28v=vs.100%29.aspx)：

```
<machineKey
  validationKey="C50B3C89CB21F4F1422FF158A5B42D0E8DB8CB5CDA1742572A487D9401E3400267682B202B746511891C1BAF47F8D25C07F6C39A104696DB51F17C529AD3CABE" 
  decryptionKey="8A9BE8FD67AF6979E7D20198CFEA50DD3D3799C77AF2B72F" 
  validation="SHA1" /> 
```

您也许还可以使用 IsolateApps 修饰符而不是生成键，但我发现专门将键设置在您希望它们共享的级别可以让您更好地控制该过程。您可以在线找到各种工具来生成这些密钥，或者您可以根据 Microsoft 的加密类自行开发。

请注意，在 IIS 结构中较高级别的 web.config 中设置的密钥会自动“下坡”流向子应用程序，除非您在其 web.config 中专门覆盖它。你的情况可能就是这样。

# vb.net - VB.net 价格计算

> ID：12414323
> 
> 赞同：-1
> 
> 时间：2012-09-13T20:32:01.020
> 
> 标签：vb.net

我正在制作一个显示订单总价的应用程序。它根据订购的商品数量以及客户是批发商还是零售商来决定价格。

它使用的计算：

如果批发商，1-4 件 = 每件 10 美元。

5 件以上物品 = 每件 9 美元（如果是批发商）。

1-3 件 = 每件 15 美元（如果是零售商）。

4-8 件 = 每件 14 美元（如果是零售商）。

9+ 件 = 每件 12 美元（如果是零售商）。我被困在计算上，对如何去做感到困惑。

GUI是完整的，这是我目前所拥有的：

图形用户界面图片：http: [//i.imgur.com/P2tDz.png](http://i.imgur.com/P2tDz.png)

```
Dim quantity As Decimal
Dim price As Decimal
Dim wholesaler As Integer
Dim retailer As Integer

Integer.TryParse(txtUnits.Text, price)

chkRetailer.Text = retailer
chkWholesale.Text = wholesaler

If wholesaler Then
    If Quantity <= 4 Then
        Price = 10
    Else
        Price = 9
    End If
ElseIf retailer Then
    If Quantity <= 3 Then
        Price = 15
    ElseIf Quantity <= 8 Then
        Price = 14
    Else
        Price = 12
    End If
End If

lblTotPrice.Text = price * quantity

lblTotPrice.Text = price.ToString("C0") 
```

这是我感到困惑的计算，我相信我的显示和声明是正确的。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:45:39.263

[使用Case 语句](http://msdn.microsoft.com/en-us/library/cy37t14y%28v=vs.80%29.aspx)会更清楚 （提供的链接的 VB 示例非常有帮助）

首先使用一个`IF`声明来确定您是否是批发商，并确定两个案例声明中的哪一个分配有效价格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:36:29.693

如果按如下方式嵌套 if 循环会更简单。（我在这里使用伪代码。）

```
If Wholesaler Then
  If Quantity <= 4 Then
    Price = 10
  Else
    Price = 9
  EndIf
ElseIf Retailer Then
  If Quantity <= 3 Then
    Price = 15
  ElseIf Quantity <= 8 Then
    Price = 14
  Else
    Price = 12
  EndIf
End If

TotalCost = Price * Quantity 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T01:02:24.993

这里有很多错误。

该语句从 txtUnits 获取输入并将其分配给 price。

```
Integer.TryParse(txtUnits.Text, price) 
```

这两行除了将 0 分配给复选框的 text 属性外什么也没做。

```
chkRetailer.Text = retailer
chkWholesale.Text = wholesaler 
```

这些语句将始终评估为 False，因为它们将始终等于 0。永远不会分配价格。

```
If wholesaler Then
  'never reaches here
ElseIf retailer Then
  'or here
End If 
```

您正在对标签进行两项分配。这个

```
lblTotPrice.Text = price * quantity 
```

没用，因为它立即被替换为

```
lblTotPrice.Text = price.ToString("C0") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T13:14:52.577

我认为你是对的，但是你将价格 * 数量分配给 lblTotPrice，然后分配价格。最后两行试试这个

```
Dim subTotal as integer
subtotal = price * quantity 
lblTotPrice.Text = subtotal.ToString("C0") 
```

您还可以做一些其他可能会有所帮助的事情，例如使用 Select Case 语句在代码中会更好地工作，但我认为这是您的主要问题。

# iphone - ios - 如何禁用页脚的拉和推

> ID：12414324
> 
> 赞同：0
> 
> 时间：2012-09-13T20:32:00.703
> 
> 标签：iphone, objective-c, ios, footer, sections

这个问题被抛来抛去，没有答案。是的，我们可以“隐藏” viewForFooterInSection 没问题：

在 CustomFooterView.m 中

{

self.hidden = YES;

}

这使页脚不可见，就像使 [UIColor clearColor] 可以工作一样。因此，视图在滚动时仍会推动单元格和标题。

无论是否有单元格，我们都希望在部分之间留出空间。并且只有标题相互推开。动态大小的页脚是要走的路吗？更好的方法？可以禁用页脚的推/拉吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:55:39.933

我不知道这是否符合您的需求，但是如果您去掉页脚并更改页眉的高度以增加额外的空间怎么办？

```
 -(CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section{
        CGFloat height;
        switch(section)
        {
            //Keep the first section normal
            case 0:
            {
                height = 44.0;//Normal Height
                break;
            }
            default:{
                height = 88.0;//Extra Space above
            }

        }
        return height;
    } 
```

# regex - 为特定目录设置 Apache DefaultIndex

> ID：12414326
> 
> 赞同：0
> 
> 时间：2012-09-13T20:32:03.410
> 
> 标签：regex, apache, mod-rewrite

在我工作的网站上，有一个包含以下文件的目录：

abc.com/parts/df/df001/df001.html

df 数字序列中大约有 800 个。我希望能够使用这样的链接：

abc.com/parts/df/df001/

我知道您可以使用 defaultIndex 将默认页面设置为 index.html 以外的其他内容，但是您可以为特定目录执行此操作吗，例如 /parts/df 的所有子目录映射到同名的 HTML 文件子文件夹？

或者，更好的是，我想使用这样的 URL：

abc.com/parts/df001（即使文件位于 abc.com/parts/df/df001/df001.html）

我认为这可能与 mod_rewrite 和正则表达式有关，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T22:01:50.720

查看[Apache HTTPD 文档](http://httpd.apache.org/docs/2.4/en/mod/mod_dir.html#directoryindex)- 您要查找的指令称为**DirectoryIndex**。您可以定义的上下文`server config, virtual host, directory, .htaccess`- 但同时您（从文档中）了解到该指令不支持任何类型的正则表达式。因此 mod_rewrite 是你需要的。

关于正则表达式 - 我会说你可以这样使用：

```
RewriteRule ^parts/df/df(\d+)/$ parts/df/df$1/df$1.html [L,R=301] 
```

放置在 parts/df（或任何上层文件夹）或 vhost 配置中的 .htaccess 中。有关详细信息，请参阅[文档](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)。

# c# - Linq Lambda group by 获取最大值

> ID：12414333
> 
> 赞同：1
> 
> 时间：2012-09-13T20:32:19.250
> 
> 标签：c#, linq

我喜欢获取 ID 为 9 的最大样本数

```
 var samplecount = dbContext.ChemDetails
                      .GroupBy(a => a.Id == 9)
                      .Select(a => a.Max(w => w.Sample_Num))
                      .FirstOrDefault(); 
```

我从上面得到的是最大值，而不是 Id == 9。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:34:59.840

你只需要一个`Where`子句，然后取最大值：

```
var maxNumber = dbContext.Where(a => a.Id == 9).Max(a => a.Sample_Num); 
```

如果您想获得每个 的最大值`Id`，那么您应该使用`GroupBy`.

```
Dictionary<int,int> MaxLookup = dbContext.ChemDetails
    .GroupBy(a => a.Id)
    .ToDictionary(g => g.Key, g => g.Max(item => item.Sample_Num));
int maxForId9 = 0;
if (MaxLookup.ContainsKey(9)) maxForId9 = MaxLookup[9]; 
```

# javascript - 不同浏览器中的空白字符正则表达式行为

> ID：12414335
> 
> 赞同：1
> 
> 时间：2012-09-13T20:32:25.357
> 
> 标签：javascript, regex, internet-explorer-7

在这个[小提琴](http://jsfiddle.net/lukiano/FBQ9w/)中，我有以下 javascript 语句：

```
document.write("one two three".split(/\S+/).length);​ 
```

它在 Firefox 和 Chrome 中打印**4**，也在 IE9 中。但在 IE7 中它会打印**2**。

我正在寻找一种在浏览器之间以一致的行为按空格分割的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:35:10.147

使用小写的 s，像这样

```
document.write("one two three".split(/\s+/).length); 
```

这样结果将是 3，这就是您想要的答案。

# node.js - nodejs 模块有警告信息

> ID：12414336
> 
> 赞同：0
> 
> 时间：2012-09-13T20:32:31.903
> 
> 标签：node.js

有没有办法可以使我包含的模块引起的警告消息静音？

我喜欢这个模块，但是每次我调用它们的函数时，控制台都会输出：

```
"Utf8String" type is deprecated, use "CString" instead 
```

我正在制作一个控制台应用程序，因此更愿意隐藏此消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:20:32.717

您收到的警告消息实际上来自节点而不是模块。但是，该模块会导致警告，因为它调用了以前版本的节点中使用的 api。

我认为无论如何都不会告诉节点隐藏记录到控制台的警告消息。

如果您真的决定摆脱这些警告，您可以进入模块的源代码并进行查找和替换。

```
"Utf8String" to "CString" 
```

我对另一个模块做了完全相同的事情，我也无法忍受这些消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T09:39:41.277

在这种情况下，我需要的模块需要一个模块，该模块具有自定义代码，该代码既使用`Utf8String`又触发了错误。

```
// alias Utf8String
var utfstringwarned = false
Object.defineProperty(types, 'Utf8String', {
    enumerable: false
  , configurable: true
  , get: function () {
      if (!utfstringwarned) {
        utfstringwarned = true
        console.error('"Utf8String" type is deprecated, use "CString" instead')
      }
      return types.CString
    }
}) 
```

并在历史上写到

```
0.0.20 / 2012-06-27
===================

 - rename the `Utf8String` type to `CString` (#5)
 - make `Utf8String` an alias to `CString` and deprecated
 - more work on docs (not yet ready) 
```

因此，作为临时解决方案，我可能会注释掉错误消息，或者作为更永久的解决方案，选择不同的模块。

# c# - 为什么域用户会在授予“所有人”的读写权限的情况下获得 UnauthorizedAccessException？

> ID：12414340
> 
> 赞同：4
> 
> 时间：2012-09-13T20:32:57.070
> 
> 标签：c#, active-directory, windows-server-2008, network-share, unauthorizedaccessexcepti

我们的应用程序允许用户在 \\foo\bar$ 的共享中读写文件。**管理员在“共享权限**”和“**安全**”选项卡上授予“所有人”读写权限。当域用户尝试写入该共享时，我们的应用程序会记录以下内容：

```
TYPE: System.UnauthorizedAccessException
MSG: Access to the path '\\foo\bar$\00074458_00076402.tif' is denied.
SOURCE: mscorlib

SITE: WinIOError
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.File.InternalCopy(String sourceFileName, String destFileName, Boolean overwrite)
   at     Ceoimage.Basecamp.DocumentServers.DirectAccessServer._TryCommitQueueFile(IDocQueueFile file)
   at Ceoimage.Basecamp.DocumentServers.DirectAccessServer.SendQueuedFiles(Int32 queueId, Int32 userId, IDocQueueFile[] queueFiles)
   at Ceoimage.Basecamp.ScanDocuments.DataModule.CommitDocumentToQueue(QueuedDocumentModelWithCollections queuedDocument, IDocQueueFile[] files) 
```

我没有域账户，所以无法测试这个用户的有效权限，但是“Everyone”是否扩展到域用户？如果“Everyone”被视为本地主体，域用户是否必须向服务器进行身份验证，除了 Active Directory？它是否被视为本地校长？

我们的应用程序是在 Windows 域上的 Windows 7 客户端上运行的 .NET WinForms 应用程序，试图访问运行 Windows Server 2008 R2 Standard SP 1 的文件服务器。如果你不知道，我有点超出我的深度这里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T21:40:15.780

啊，棘手的授权..

我不得不处理这个问题已经有一段时间了。这是问题的原因：LDAP 在 GUID 中工作。管理员组肯定会拥有与域中当前存在的不同的 guid。

出现此问题的原因是机器不同步或文件刚刚从以前的机器传输到新版本（不同的 HDD）。

有一个修复！

我将添加一个问题，在其中，我将获得文件的所有权并从头开始重新应用域策略。

我最近已经这样做了，如果您需要更多信息，请告诉我。

# ios - 更改 MessageUI 表单和 ActionSheet 的语言

> ID：12414349
> 
> 赞同：0
> 
> 时间：2012-09-13T20:33:24.890
> 
> 标签：ios, uiactionsheet, messageui, mfmessagecomposeview

我目前正在使用`MessageUI`发送短信和电子邮件的框架，但我的应用程序是西班牙语，而`MessageUI`界面是英文，如何更改按钮文本`MessageUI`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:54:29.550

您不需要修改界面的按钮`MessageUI`，因为通常它的界面会自动翻译成用户的语言（iPhone 设置中设置的语言）。

如果在您的测试期间不是这种情况，则可能有多种原因：

*   如果您在模拟器上而不是在设备上尝试，我猜框架的模拟器版本是轻量级版本，没有每个翻译的字符串（当然在设备上定义了所有本地化）。也许试试你的真实设备
*   如果 iOS 无法为手机的当前语言环境找到给定字符串的翻译，它会回退到使用`CFBundleDevelopmentRegion`Info.plist 键定义的语言环境。因此，如果在西班牙语中找不到您的按钮的翻译，如果您的 CFBundleDevelopmentRegion 设置为“en”，它将使用英语翻译。*这解释了前一点的行为：在模拟器上，西班牙语框架中可能不存在翻译（但应该存在于设备上），因此它回退到英语。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:05:15.273

你确定你的项目是西班牙语的吗？这个周末我遇到了这个问题，这是因为我有英文项目。我在项目中添加了西班牙语并删除了英语和messageui，其他系统界面出现了西班牙语。

您可能需要清理甚至删除设备上的应用程序并重新安装。

要添加西班牙语，请单击您的项目，转到本地化并单击 + 按钮并添加西班牙语。然后点击英语和 - 按钮将其删除

![在此处输入图像描述](../Images/5848c6ae5f9fca069d29c1af9fe02a9f.png)

# sql - 自动递增订单号（一张表中的多个公司）

> ID：12414352
> 
> 赞同：4
> 
> 时间：2012-09-13T20:33:28.977
> 
> 标签：sql, sql-server, auto-increment

我有一个自动递增的主键 OrderHeaderID，但我还需要根据下订单的公司自动递增 OrderNumber。

当前策略：（*在我对表的插入语句中*）

```
(SELECT MAX(OrderNumber) + 1 FROM  OrderHeader WHERE CompanyID = @CompanyID) 
```

问题：一旦我开始用一些音量进行测试，我开始收到重复的键错误：

表 OrderHeader：

```
OrderHeaderID CompanyID OrderNumber
1             1         10000
2             1         10001
3             1         10002

4             2         10000
5             2         10001
6             2         10002 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:42:05.193

要解决您的并发问题，您必须提高`SELECT`语句的隔离级别，然后执行`INSERT`同一事务的内部。

每个 RBDMS 的具体语法会有所不同，但这里有一个使用 Sql Server 的示例：

```
BEGIN TRANSACTION
    DECLARE @OrderNumber INT

    SELECT @OrderNumber = MAX(OrderNumber) + 1 
    FROM OrderHeader WITH (XLOCK)
    WHERE CompanyID = @CompanyID

    INSERT... (@OrderNumber)
COMMIT 
```

这将对语句期间读取的行设置一个排他锁`SELECT`，这将阻止该例程的另一个实例同时运行。相反，第二个实例将被阻塞，直到原始进程执行`INSERT`and `COMMIT`，此时第二个实例将继续读取并锁定新生成的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:18:00.960

看看我的答案：[sql server: generate primary key based on counter and another column value](https://stackoverflow.com/questions/4821831/sql-server-generate-primary-key-based-on-counter-and-another-column-value/4822494#4822494)

出于您的目的，您可以这样定义您的公司表：

```
create table dbo.company
(
  id   int         not null primary key ,
  name varchar(32) not null unique      ,
  order_counter    not null default(0)  ,
  ...
) 
```

以及您的订单表：

```
create table dbo.order
(
  company_id   int not null foreign key references dbo.company( id ) ,
  id           int not null ,
  order_number as 100000*company_id + id ,
  ...
  constraint order_AK01 unique nonclustere    ( order_number    ) ,
  constraint order_PK01 primary key clustered ( company_id , id ) ,
) 
```

并设置您的“添加订单”查询：

```
declare @new_order_number int

update dbo.company
set @new_order_number = dbo.company.order_counter + 1 ,
    order_counter     = dbo.company.order_counter + 1
where dbo.company.id = @some_company_id

insert dbo.order ( company_id , id ) value ( @some_company_id , @new_order_number ) 
```

您没有并发（竞争）条件：“联锁更新”负责处理。此外，您还没有对数据库设计进行非规范化（第一种范式要求每个行和列的交集都是*原子*的/不可分解的：它只包含来自适用域的一个值，仅包含一个值。像您这样的复合标识符是*禁止*的。）

简单的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:56:35.920

我会使用一个函数来自动增加每个给定 ID 的 OrderNumber。

这是我在 2 分钟内整理的内容。它可以满足您的要求。

```
create table dbo.OrderHeader (
    OrderHeader int identity(1,1) primary key
    ,CompanyID  int
    ,OrderNumber int
    )
go

create function dbo.NextOrderNumber (
    @CompanyID int
    )
returns int
as
begin
    declare @result int;

    select  @result = OrderNumber + 1
    from    OrderHeader
    where   CompanyID = @CompanyID 

    if @result is null
        set @result = 10000

    return  @result;
end
go  

insert into OrderHeader select 1, dbo.NextOrderNumber(1)

insert into OrderHeader select 2, dbo.NextOrderNumber(1)
insert into OrderHeader select 2, dbo.NextOrderNumber(1)

insert into OrderHeader select 1, dbo.NextOrderNumber(1)

select *
from OrderHeader 
```

# batch-file - 如何读取文本文件的 2 行连续并将它们保存为临时变量

> ID：12414356
> 
> 赞同：5
> 
> 时间：2012-09-13T20:33:45.623
> 
> 标签：batch-file, text-processing

我有带有`ID`,`model`和`date`. 这些文件的格式类似于`10000_9999-99_10-01-2011.zip`（其中`10000`是`ID`，`9999-99`是`model`，当然`10-01-2011`是`date`）。

我想修改`date`这些文件的 s，但保持会话之间的间隔相同`ID`。例如，如果 2 个会话的日期为`1/1/2011`，`2/1/2011`并且我想将最后一个会话的日期更新为`8/1/2012`，则第一个会话的日期为`7/1/2012`。

目前我的代码如下所示：

```
@echo off
setlocal enabledelayedexpansion
del filedates.txt
FOR /F "tokens=1,2,3,4,5 delims=_" %%a in (filenames.txt) do @echo %%c >>filedates.txt
FOR /F "tokens=1,2,3 delims=-" %%a in (filedates.txt) do (
  echo %%a%%b
) 
```

* * *

输出类似于此（年月）：

```
201107
201109
201204
etc.. 
```

* * *

我想在 中读取一行`filedates.txt`，将此日期存储为变量，然后读取下一行，并将其存储为另一个变量。这样，可以比较两个变量以查看哪个更大，并且该过程将继续。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T22:13:40.593

一次读取两行的一种直接方法是使用循环逐一处理输入文件中的行`for /f`，并且仅在偶数行上“反应”。这是一个示例代码：

```
@echo off
setlocal enabledelayedexpansion
set evenflag=1
for /f "tokens=*" %%x in (filedates.txt) do set x1=!x2! && set x2=%%x && (
set /a evenflag^^=1 && if !evenflag!==1 (
    rem Do something with !x1! and !x2!
)) 
```

这里的变量`evenflag`是一个布尔标志，指示当前行号是否为偶数（`1`对于偶数行，`0`到奇数行）。`x1`并`x2`保持当前读取的一对线。

# c# - .NET TreeNode 可以知道它的父节点已更改吗？

> ID：12414359
> 
> 赞同：2
> 
> 时间：2012-09-13T20:33:51.297
> 
> 标签：c#, .net, windows, winforms

我有一个`TreeNode`在 .NET 3.5 (C#) 中扩展的类，`LocationNode`. 这个类是一个`TreeNode`但包含一些额外的数据点以便于提取。显示这些`LocationNode`对象的 TreeView 实现了拖放功能。每个`LocationNode`对象都有一个`dirty`标志，指示我关心的任何数据点是否被用户更改。巧合的是，我关心的数据点之一是父节点。

我可以在拖放代码中实现一些功能，以确定父节点是否已经足够容易地更改，但为了抽象起见，我希望`LocationNode`对象跟踪自己的脏标志并在必要时将其设置为 true。

有什么方法可以知道父节点是否发生了变化？我没有看到任何可以挂钩的事件，`LocationNode`当它从集合中添加或删除时会提醒我。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T22:34:29.470

当您将节点添加到树视图时，存储其父节点（或 parent.fullpath），然后在进行脏计算时将当前父节点与存储的父节点进行比较。然后在您的 SetClean() 函数中，再次存储当前父级。

# python - 如何对列表的每个元素执行操作并将结果放入 Python 中的新列表中？

> ID：12414361
> 
> 赞同：4
> 
> 时间：2012-09-13T20:33:56.930
> 
> 标签：python, list, loops

嘿，我在试图解决这个问题时遇到了问题：

让我们从一个包含元素的列表和一个空白列表开始。

```
L = [a, b, c]  
BL = [  ] 
```

我需要做的是在 L[0] 上执行任务并将结果放入 BL[0]。然后在 L[1] 上执行任务并将结果放入 BL [1]。然后当然与列表中的最后一个元素相同。导致

```
L = [a, b, c]
BL =[newa, newb, newc] 
```

我希望你明白我想弄清楚什么。我是编程新手，我猜这可能是通过 for 循环完成的，但我不断收到错误。

好的，这就是我尝试过的。注意：链接是链接列表。

```
def blah(links):
   html = [urlopen( links ).read() for link in links]
   print html[1] 
```

我得到这个错误：

```
Traceback (most recent call last):
File "scraper.py", line 60, in <module>
main()
File "scraper.py", line 51, in main
getmail(links)
File "scraper.py", line 34, in getmail
html = [urlopen( links ).read() for link in links]
File "/usr/lib/python2.6/urllib.py", line 86, in urlopen
return opener.open(url)
File "/usr/lib/python2.6/urllib.py", line 177, in open
fullurl = unwrap(toBytes(fullurl))
File "/usr/lib/python2.6/urllib.py", line 1032, in unwrap
url = url.strip()
AttributeError: 'list' object has no attribute 'strip' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T20:35:35.553

很简单，这样做：

```
BL = [function(x) for x in L] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-13T20:53:54.967

> 好的，所以我继承了我尝试过的内容。注意：链接是链接列表。

```
html = [urlopen( links ).read() for link in links] 
```

在这里，您已经要求 Python 遍历`links`，使用`link`每个元素的名称...并且使用每个`link`，您调用`urlopen`... with `links`，即整个列表。大概你想`link`每次都通过一个给定的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T20:35:28.067

了解列表推导。

```
BL = [action(el) for el in L] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T20:47:20.757

这里有几种不同的方法，所有这些方法都假设`L = ['a', 'b', 'c']`它们`BL = []`是第一次运行的。

```
# Our function
def magic(x):
    return 'new' + x

#for loop - here we loop through the elements in the list and apply
# the function, appending the adjusted items to BL
for item in L:
    BL.append(magic(item))

# map - applies a function to every element in L. The list is so it
# doesn't just return the iterator
BL = list(map(magic, L))

# list comprehension - the pythonic way!
BL = [magic(item) for item in L] 
```

一些文档：

*   [为了](http://docs.python.org/tutorial/controlflow.html#for-statements)
*   [地图](http://docs.python.org/library/functions.html#map)
*   [列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T20:36:08.260

您创建一个函数，执行您想要的所有操作并使用 map 函数

```
def funct(a): # a here is L[i]
     # funct code here
     return b #b is the supposed value of BL[i]
BL = map(funct, L) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-13T20:42:11.963

怎么样？

```
x = 0
for x in range(len(L)):
    BL.append(do_something(x)) 
```

不像某些答案那么简洁，但对我来说很容易理解。

根据下面的评论进行疯狂的更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-19T14:10:26.520

这里一个有用的工具是函数式编程。Python支持一些可以解决这个问题的高阶函数。

我们特别想使用的函数称为[map](https://en.wikipedia.org/wiki/Map_(higher-order_function))。这里的一些答案使用地图，但没有一个完全接受功能方法。为此，我们将使用函数式编程中使用的“lambda”，而不是使用标准的 python 'def' 创建函数。这使我们能够在一行中很好地解决您的问题。

要了解有关 lambda 为何有用的更多信息，请转到[此处](https://stackoverflow.com/questions/890128/why-python-lambdas-are-useful)。我们将按照以下方式解决您的问题：

```
r = map(lambda x: urlopen(x).read(), L) 
```

# javascript - 从输入类型=文件上传base64 jpeg到服务器

> ID：12414363
> 
> 赞同：2
> 
> 时间：2012-09-13T20:34:02.493
> 
> 标签：javascript, html, base64

我有一个应用程序，如果我从计算机中选择图像，我可以通过将文件发布到服务器来上传文件。

现在我想扩展它以上传不在我的计算机上但在浏览器中作为 base64 字符串的图像。（它是我从画布导出的 jpeg）。

这完全可以在浏览器中完成吗？或者我会在服务器端转换 base64 吗？只支持IE9+

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:43:58.670

这样做很容易，甚至不需要 type=file 输入。

这是一些发布 base64 图像（来自画布）的客户端 JS：[https ://github.com/operasoftware/shinydemos/blob/master/demos/photo-booth/scripts/photobooth.js#L152](https://github.com/operasoftware/shinydemos/blob/master/demos/photo-booth/scripts/photobooth.js#L152)

然后在服务器端（在这种情况下使用 PHP），只需根据您发送的内容创建一个图像： [https ://github.com/operasoftware/shinydemos/blob/master/demos/photo-booth/email.php# L6](https://github.com/operasoftware/shinydemos/blob/master/demos/photo-booth/email.php#L6)

# mysql - Magento 订单导出期间出现相同的 ID 错误

> ID：12414367
> 
> 赞同：2
> 
> 时间：2012-09-13T20:34:14.217
> 
> 标签：mysql, export-to-csv, magento

我在从我的 magento 商店运行订单导出时遇到问题。我不断收到以下错误： `Item (Mage_Sales_Model_Order) with the same id "524" already exist`

研究告诉我这是由于我的数据库中有一些不良记录，但我找不到任何关于这些记录的信息。我一直在寻找有冲突的订单号，但似乎没有。

有谁知道此类错误的原因是什么和/或如何查找/修复导致它的数据库错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T11:47:51.937

我自己也遇到了同样的问题，例如在集合末尾添加一个组

```
->group(array('main_table.order.id')); 
```

# javascript - 等待返回值 NodeJS

> ID：12414368
> 
> 赞同：0
> 
> 时间：2012-09-13T20:34:14.500
> 
> 标签：javascript, node.js

我有一个节点服务器，它调用外部模块。我的问题是我需要通过调用模块返回数据，但节点（非阻塞）根本不等待返回值。有什么解决办法吗？

代码 ：

**服务器.js**

```
var value = module.functionA(param);
console.log("Message one %s", value); 
```

**模块.js**

```
function callToFunctionInModule(param){
console.log("In func");
return param+2;
}

exports.functionA = function(param){
console.log("Message two");
var returnVal = callToFunctionInModule(param);
return returnVal;
}; 
```

**输出**

```
Message two
Message one undefined
In func 
```

无论如何要获得以下输出（等待从模块中获取返回值而不使用*var value = module.functionA(param);行中的回调）*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:53:03.363

首先，您提供的代码（同步）并不代表实际情况（异步）。如果你想处理异步的东西，你应该做的是使用回调。这就是 node.js 背后的全部理念——事件驱动*。

**服务器.js**

```
module.functionA(param, function(val) {
    console.log("Message one %s", val);
}); 
```

**模块.js**

```
function callToFunctionInModule(param, cb) {
    console.log("In func");
    /* some db query */
    not_so_magical_async_stuff("blah", function(/* value passed as argument */) {
        cb(param + 2 /* or the value passed as an argument to this function */);
    }
}

exports.functionA = function (param, cb) {
    console.log("Message two");
    callToFunctionInModule(param, cb);
}; 
```

现在，发生的情况是这样的：传递给的函数`functionA`被传递给`callToFunctionInModule`，它以返回值作为参数调用它。结果：非阻塞的漂亮代码！相信我，一旦你迷上了这个异步的东西，你会爱上它的！

# java - 在java中的计算器应用程序中连接整数

> ID：12414371
> 
> 赞同：1
> 
> 时间：2012-09-13T20:34:31.687
> 
> 标签：java

所以我正在使用java中的计算器应用程序，我需要编写代码的核心。

我正在编写一个实现接口的类，在我的`addDigit(int digit)`方法中，我需要它来显示用户在程序上按下的两个整数的串联。

我已经进行了一些研究，并且正在寻找类似`value = "" + digit * digit;`或类似的东西，但似乎没有任何效果。

```
public class BasicAccumulator implements Accumulator {

    private int digit;
    private int value;

    public void BasicAccumulator(int digit, int value)
    {
        this.digit = digit;
        this.value = value;
    }

    public void addDigit(int digit)
    {
        value = digit + "" digit;
    }

    public void plus()
    {
        value = digit + digit;
    }

    public void minus()
    {
        value = digit - digit;
    }

    public void clear()
    {
        value = 0;
    }

    public int displayValue()
    {
        return value;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T20:36:46.200

怎么样：

```
public void addDigit(int digit)
{
    value = value * 10 + digit;
} 
```

还是我误解了您要做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:44:35.267

```
public void addDigit(int digit)
{
    value = (this.digit + "")+ digit;
} 
```

# python - 投票系统的 Django 模型

> ID：12414374
> 
> 赞同：0
> 
> 时间：2012-09-13T20:34:47.990
> 
> 标签：python, database-design, django-models

我正在编写网站来评级书籍，但我不确定如何为登录用户实施投票系统。用户应该能够从 1-10 对图书进行评分，当然，系统应该记住他的投票，计算所有投票并计算平均评分。

可以说我有以下模型：

```
class Book(models.Model):
    title = models.CharField(max_length=30)
    author = models.ForeignField(Author)
    #... other fields 
```

和

```
class User(models.Model):
   first_name = models.CharField(max_length=50)
   last_name = models.CharField(max_length=30)
   #... other fields 
```

现在我可以将 rate 和 rates_count 字段添加到 Book，但我需要记住用户的投票。显然我需要 Book 类中的 ManyToMany 字段，我认为这样的事情应该没问题：

```
class Vote(models.Model):
   user_who_voted = models.ForeignField(User)
   rated_book = models.ForeignField(Book)
   rate_date = models.DateField()
   rate = models.ForeignField(User)

class Book(models.Model):
    title = models.CharField(max_length=30)
    author = models.ForeignField(Author)
    votes = models.ManyToManyField(through='Vote')
    #... other fields 
```

我想知道在 Book 课中我是否需要 rate 和 rates_count。因为我可以从 Vote 模型中计算它们的值。对我来说，这里有几个未知数：

比方说，PostgreSQL 数据库引擎的快/慢速度如何计算所选书籍的平均率，（添加和计算所有投票投票 [平均率 = 所有添加的投票/投票数]） 10000 票，以及如何计算 1000000 票。操作时间是否保持不变？如果我的 PC 比服务器慢 1000 倍，那么计算所需的时间也是线性的吗？

对不起，如果我的问题很愚蠢，但我在数据库编程方面没有经验。谢谢你的任何答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:44:02.943

不是 ORM 和 Django 方面的专家，但大多数 SQL 数据库都有可以很快计算的总数。如果您有评级的数字字段，那么数学将非常简单快捷，并且最多可以在两个 DB SQL 调用中完成（您也需要计算记录数）。检查 django ORM 是否有总计（我相信有），否则（我确信 django orm 也提供直接 SQL）您可能需要制作自定义 SQL 查询来计算费率。此类查询将过滤所需的书籍 ID。

扩大算法规模并非易事。我想你也许应该把这个问题分开，一个关于模型，另一个关于性能，一旦你有了一些模型（也许还有替代模型）

# java - 使用“继续使用标签”到达内部 for 循环

> ID：12414378
> 
> 赞同：-1
> 
> 时间：2012-09-13T20:35:01.720
> 
> 标签：java, continue

```
while (true) {
    try {
        //create ImportantObject
        LoopToGoTo:
        for (int i = 0; i < Limit; i++) {
            //method in here throws the exception
            //ImportantObject is used in here.
        }
    } catch(Exception e) {
        //report error
        continue LoopToGoTo;
    }
} 
```

我想继续在 try catch 块内的循环。这可能吗？

编辑：对不起，我不清楚为什么我不能将 try catch 移到 for 循环内。（编辑片段）如果我把 try-catch 放在 for 循环中，里面的调用将无法访问 ImportObject.. 这就是我被卡住的地方。

EDIT2：好的，我解决了我的问题，尽管没有继续使用标签！我想我的问题的答案是一个简单的“不”。坏习惯可能到处都是，但我的作业要在两个小时内完成。我能说什么：D

```
//ImportantClass ImportantObject = null;
while (!ranOnce) {
    try {
        //create ImportantObject
        ranOnce = true;
    } catch(Exception e) {
        //report error
        continue;
    }
}
for (int i = 0; i < Limit; i++) {
    try {
        //method in here throws the exception
        //ImportantObject is used in here.
    } catch(Exception e) {
        //report error
        continue;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:38:00.547

不，这是不可能的，因为您已经超出了 try 块的范围。

为什么不把 try catch 移到 for 循环中呢？

```
for (int i = 0; i < Limit; i++) {
    try {
        //method in here throws the exception
    } 
    catch(Exception e) {
    //report error
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:38:50.813

你的意思是你想这样做吗？

```
 for (int i = 0; i < Limit; i++) {
          try {
            //method in here throws the exception
          } catch(Exception e) {
            //report error
          }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T20:39:02.137

我认为一个简单的`continue;`会产生相同的效果，你想要达到什么。

# c# - 将其设置为 NoCache 后更改 Response.Cache._cacheability

> ID：12414385
> 
> 赞同：1
> 
> 时间：2012-09-13T20:35:17.900
> 
> 标签：c#, asp.net, caching

似乎，一旦将可缓存性设置`Response.Cache`为`NoCache`，就无法再次更改它。这是该问题的简单但完整的说明：

```
protected void Page_Load(object sender, EventArgs e)
{
    FieldInfo fi = typeof(HttpCachePolicy).GetField(
        "_cacheability",
        BindingFlags.NonPublic | BindingFlags.Instance);

    // Default value = 6
    HttpCacheability first = (HttpCacheability)fi.GetValue(Response.Cache);

    // Can change it to Public
    Response.Cache.SetCacheability(HttpCacheability.Public);
    HttpCacheability second = (HttpCacheability)fi.GetValue(Response.Cache);

    // Can change it to Private
    Response.Cache.SetCacheability(HttpCacheability.Private);
    HttpCacheability third = (HttpCacheability)fi.GetValue(Response.Cache);

    // Can change it to NoCache
    Response.Cache.SetCacheability(HttpCacheability.NoCache);
    HttpCacheability fourth = (HttpCacheability)fi.GetValue(Response.Cache);

    // Can't go back to Private!  Stuck on NoCache
    Response.Cache.SetCacheability(HttpCacheability.Private);
    HttpCacheability fifth = (HttpCacheability)fi.GetValue(Response.Cache);
} 
```

我错过了什么吗？有没有办法做到这一点？

**编辑**：当然，如果我用反射设置它，它会起作用，但我担心当你设置它时会发生其他事情，`HttpCacheability.NoCache`如果我去幕后我会想念..并且宁愿在正式 -无论如何支持的方式。

**EDIT2：** 同样的事情似乎发生在`Private`; 你只能限制更多吗？

```
protected void Page_Load(object sender, EventArgs e)
{
    FieldInfo fi = typeof(HttpCachePolicy).GetField(
        "_cacheability",
        BindingFlags.NonPublic | BindingFlags.Instance);

    // Default value = 6
    HttpCacheability first = (HttpCacheability)fi.GetValue(Response.Cache);

    // Can change it to Private
    Response.Cache.SetCacheability(HttpCacheability.Private);
    HttpCacheability second = (HttpCacheability)fi.GetValue(Response.Cache);

    // Can't change to Public!  Stuck on Private
    Response.Cache.SetCacheability(HttpCacheability.Public);
    HttpCacheability third = (HttpCacheability)fi.GetValue(Response.Cache);

    // Can change to NoCache - Can only go more restrictive?
    Response.Cache.SetCacheability(HttpCacheability.NoCache);
    HttpCacheability fourth = (HttpCacheability)fi.GetValue(Response.Cache);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:20:42.277

打开反射器并查看内部`HttpCachePolicy`：

```
public void SetCacheability(HttpCacheability cacheability)
{
    if ((cacheability < HttpCacheability.NoCache) || (HttpCacheability.ServerAndPrivate < cacheability))
    {
        throw new ArgumentOutOfRangeException("cacheability");
    }
    if (s_cacheabilityValues[(int) cacheability] < s_cacheabilityValues[(int) this._cacheability])
    {
        this.Dirtied();
        this._cacheability = cacheability;
    }
} 
```

`s_cacheabilityValues`在静态构造函数期间设置：

```
s_cacheabilityValues = new int[] { -1, 0, 2, 1, 4, 3, 100 }; 
```

`Dirtied()`被调用，但它似乎只是设置了一些标志：

```
private void Dirtied()
{
    this._isModified = true;
    this._useCachedHeaders = false;
} 
```

看起来确实有更改值的规则，但看起来它们没有太大影响。因此，使用反射进行更改可能是安全的。

```
fi.SetValue(Response.Cache, HttpCacheability.Private); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-07T10:39:15.387

事实上，反思似乎是唯一安全的方法。深入查看代码，您需要从 Response 的 Cache 属性中提取类型为 HttpCachePolicy 的对象，如下所示：

```
 public class HttpCachePolicyWrapper : HttpCachePolicyBase
{
    private HttpCachePolicy _httpCachePolicy;
    ....
} 
```

为此，只需使用反射从 Response.Cache 对象中设置正确对象的值，如下面的代码所示：

```
FieldInfo fi = typeof(HttpCachePolicy).GetField("_cacheability", BindingFlags.NonPublic | BindingFlags.Instance);
var objectToChange = (HttpCachePolicy)context.Response.Cache.GetType().GetField("_httpCachePolicy", BindingFlags.NonPublic | BindingFlags.Instance).GetValue(context.Response.Cache);
fi.SetValue(objectToChange, HttpCacheability.Public); 
```

这只是为zimdanen的答案增加了更多具体步骤

# facebook - Facebook Canvas 应用程序：SSL 连接错误

> ID：12414392
> 
> 赞同：3
> 
> 时间：2012-09-13T20:35:46.587
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-canvas

我正在尝试制作一个 Facebook 画布应用程序，最终将托管在 Heroku 上，但现在它位于 localhost 上。我可以使用 Facebook 在本地主机上登录我的应用程序，但是当我尝试访问 Facebook 上的应用程序（现在只是一个 html 页面）时，我收到了这个 SSL 错误。

```
Unable to make a secure connection to the server. This may be a problem with the server, or it may be requiring a client authentication certificate that you don't have.
Error 107 (net::ERR_SSL_PROTOCOL_ERROR): SSL protocol error. 
```

这就是我在 Facebook 上设置应用程序的方式。谁能解释我做错了什么？我了解当我访问应用程序页面时，我应该能够在 Facebook 上看到该应用程序。 ![这就是我在 Facebook 上设置应用程序的方式](../Images/539ca5ee8b6a0b69eb2eb5aa0d957a36.png)

请注意，它处于沙盒模式，如果这有所作为。

![在此处输入图像描述](../Images/eedbffb5c5538cd12e683cc1a13d3dbb.png)

![在此处输入图像描述](../Images/eedbffb5c5538cd12e683cc1a13d3dbb.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T22:12:51.653

您的本地主机中没有 ssl。

在您的个人帐户中进行安全浏览以查看您的应用帐户设置 > 安全 > 安全浏览

# php - mysql更新难度

> ID：12414393
> 
> 赞同：-4
> 
> 时间：2012-09-13T20:35:57.623
> 
> 标签：php, mysql, referrer

我正在尝试修复我的邀请系统。当用户登录系统`$_SESSION['id']`时，脚本会检查 row 中是否有任何值`inviteid`。

如果有系统检查用户的积分是否超过 1000。如果他有系统，则使用 更新推荐人的积分`inviteid`。

```
<?php session_start();
ob_start();
error_reporting(0);
include("dbConn.php");
?>
<?php
    if(isset($_SESSION['id'])){
?>
<?php
   $unuserid = $_SESSION['id'];
   $sql="select * from users WHERE id = $unuserid"; 
   $result = mysql_query("SELECT * FROM users WHERE id='$unuserid'");
   while($row = mysql_fetch_array($result))
   {
    $unPOINTS = $row['points'];
    $uninviteid = $row['inviteid'];

    } 

     if(isset($uninvited)) {

     ?>

<?php
  if ($unPOINTS > 1000) {
?>
<?php
    $sql="UPDATE users SET points = $unPOINTS + 500 WHERE id = $uninviteid";
    $result=mysql_query($sql) or die(mysql_error()."<br />".$sql); 
    header("Location: index.php?page=changemember&id=$UID");
}   }

?>

<?php
    }
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:40:31.140

你在第 26 行有一个错字，它应该是：

```
if(isset($uninviteid)) { 
```

您可以通过使用 Eclipse 或 NetBeans 等 IDE 进行开发来避免此类错误。

并尝试使用 Zend 编码标准来格式化你的 PHP 代码，它会让你的生活更轻松。阅读更多： http: [//framework.zend.com/manual/1.12/en/coding-standard.html](http://framework.zend.com/manual/1.12/en/coding-standard.html)

# computer-vision - 如何获取骨骼坐标以及 RBG + 深度视频并使用 Kinect 保存数据？

> ID：12414396
> 
> 赞同：0
> 
> 时间：2012-09-13T20:36:09.573
> 
> 标签：computer-vision, kinect

我正在从事一个涉及捕获 RGB + 深度视频数据的机器学习项目（动作识别）。作为一个特征，我还需要提取关节的骨骼坐标。获取骨骼很容易，但是 KinectSDK 是否提供了这样的方法来从预先录制的视频中获取骨骼？

我正在考虑制作一个应用程序来记录 RGB 和深度视频并将坐标逐帧保存在文件中。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:25:28.187

不，Microsoft Kinect SDK 不为您提供从预先录制的视频中获取骨架的功能。此外，[如果传感器关闭，它不会为您提供从骨架数据到深度的映射](http://msdn.microsoft.com/en-us/library/jj591489.aspx#4)。

我建议在记录 RGB+深度数据时将映射到深度（或颜色，如果您愿意）的关节坐标写入文件。我还没有这样做，但我想它不会增加太多开销。

我猜你已经看过了，但为了完整起见，[这是第 9 频道骨骼跟踪教程的链接](http://channel9.msdn.com/Series/KinectQuickstart/Skeletal-Tracking-Fundamentals?format=html5)，其中包括这些映射功能。

# c# - 在客户端应用程序中隐藏服务命名空间

> ID：12414397
> 
> 赞同：3
> 
> 时间：2012-09-13T20:36:10.417
> 
> 标签：c#, .net, vb.net, wcf, windows-services

我有一个引用服务的 Dll（通过添加服务引用）。我计划在公司内部将这个库分发给各种开发人员。但是，我不希望他们直接访问该服务，而只想通过我的图书馆。在我在讨论中引用 dll 的测试客户端应用程序之一上，我看到服务命名空间也可访问。有没有办法限制，可能是我在 dll 中的服务引用有一个私有修饰符。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:38:16.860

我刚刚想出了这个问题的答案。我想在这里更新，所以将来可能对任何人都有帮助。

添加服务引用后，右键单击ServiceReference到“配置服务引用”。在“生成类的访问级别”字段中 - 选择“内部”，因此只能从该程序集中访问它。

# google-maps - GPS App 上的 GMap PanTo

> ID：12414399
> 
> 赞同：0
> 
> 时间：2012-09-13T20:36:19.133
> 
> 标签：google-maps, jquery-mobile, google-maps-api-3

我正在构建一个简单的 GPS 应用程序，我需要在其中更新标记/我在地图上的位置。这就是我正在使用的代码：

```
$('#map').live('pagecreate', function(){
    $('#map_canvas').gmap({'center': '0,0', 'zoom': 10, 'callback': function(map) {
        var self = this;
        self.watchPosition(function(position, status) {
            if (status === 'OK') {
                var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                if (!self.get('markers').client) {
                    self.addMarker({'id': 'client', 'position': latlng, 'bounds': true});
                } else {
                    self.get('markers').client.setPosition(latlng);
                    map.panTo(latlng);
                }
            }
        });
    }});
}); 
```

我还没有测试标记是否正在移动，但我的问题是为什么“panTo”功能以最大缩放平移到标记？我只需要它在实际缩放时跟随标记/我的位置。那怎么能做到呢？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:42:00.463

地图的 SetCenter 以匹配标记..

```
var latLng = marker.getPosition();  
map.setCenter(latLng); 
```

# ruby-on-rails - 带有 I18N 的基本设计规范

> ID：12414400
> 
> 赞同：1
> 
> 时间：2012-09-13T20:36:19.647
> 
> 标签：ruby-on-rails, rspec, devise

我是 RSpec 的新手，正在尝试编写一个简单的测试来显示 Devise 正在工作。我选择了一个随机页面并想编写一个测试来显示未登录的用户被重新重定向到 /users/sign_in。

```
describe OrgsController do

  describe "GET index when not logged in" do
    it "redirects to new_user_session_path" do
      user = FactoryGirl.create(:user)
      user.confirm!
      sign_in user
      sign_out user
      get :index
      response.should redirect_to new_user_session_path
    end
  end

  before(:each) do
    user = FactoryGirl.create(:user)
    user.confirm!
    sign_in user
  end

  # remaining specs

end 
```

我明白了`"Expected response to be a redirect to <http://test.host/users/sign_in?locale=en> but was a redirect to <http://test.host/users/sign_in>."`

我已经实现了 i18n，并且在我的应用程序控制器中有：

```
before_filter :set_i18n_locale_from_params 
```

就以下方面而言，使其工作的最佳方法是什么：

*   让路线匹配？
*   再次签入和签出用户以绕过 before(:each) 块的影响的 hackishness？
*   整体做法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:21:49.480

让控制器测试/规范正确设置语言环境的问题是一个长期存在的问题，请参阅：[如何为功能测试设置语言环境 default_url_options (Rails)](https://stackoverflow.com/questions/1987354/how-to-set-locale-default-url-options-for-functional-tests-rails)

从您所写的内容来看`get :index`，默认情况下似乎没有设置语言环境，因为`default_url_options`控制器测试/规范不起作用。尝试上面链接中提到的解决方案之一以获取匹配的路线。另请参阅 github 上的此讨论：[https ://github.com/rspec/rspec-rails/issues/255](https://github.com/rspec/rspec-rails/issues/255)

对于它的价值，这是我目前在规范/测试中使用[的补丁](https://github.com/rspec/rspec-rails/issues/255#issuecomment-7858480)，以使语言环境自动传递给当前语言环境的路由：

```
class ActionDispatch::Routing::RouteSet
  def url_for_with_locale_fix(options)
    url_for_without_locale_fix(options.merge(:locale => I18n.locale))
  end

  alias_method_chain :url_for, :locale_fix
end 
```

关于你所拥有的块设置的hackishness `before(:each)`，我真的建议使用上下文块分离案例，一个上下文没有 before 过滤器登录用户，另一个上下文使用 before 块登录用户。你有正确的设置现在对于试图查看发生了什么的人来说真的很困惑。

# ide - 使用活着！为源引擎创建插件？

> ID：12414404
> 
> 赞同：1
> 
> 时间：2012-09-13T20:36:31.140
> 
> 标签：ide, artificial-intelligence, game-engine

我正在创建一种我想在使用源引擎的游戏中实现的 AI 形式。我想知道我是否可以使用Alive！为源引擎创建插件而不是源引擎中的库存 AI？可能的？实际的？

让我知道你的想法，我对源引擎的股票 AI 不太熟悉，谢谢！

# eclipse - Eclipse CDT – 应用范围的主题配置

> ID：12414405
> 
> 赞同：1
> 
> 时间：2012-09-13T20:36:34.137
> 
> 标签：eclipse, ide, eclipse-cdt

我最近开始使用 Eclipse CDT。

经过一番搜索，我找到了一种通过从“文件”菜单导入 .epf 文件来更改其源视图主题的方法。但是，当我启动另一个 Eclipse 实例并创建一个新项目时，该主题会丢失（它会回到默认的白色背景）。

如何在 Eclipse CDT 中执行应用程序范围的主题配置？我希望我的所有 Eclipse 实例都具有相同的外观。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T11:15:27.267

如果有人想知道，这是一种方法：

1.  [从某处（例如， http](http://eclipsecolorthemes.org/) ://eclipsecolorthemes.org/）下载首选项文件（.epf 文件）
2.  从文件 -> 导入 -> 常规 -> 首选项导入它
3.  可选地从 Preferences -> C/C++ -> Editor -> Syntax Coloring 设置其他首选项
4.  从 File -> Export -> General -> Preferences 将新的首选项保存到首选项文件
5.  创建新项目后导入此首选项文件

不完美，但它有效。

# javascript - 如何将字符串存储在具有单引号和双引号的 JavaScript 变量中？

> ID：12414408
> 
> 赞同：3
> 
> 时间：2012-09-13T20:36:48.970
> 
> 标签：javascript, variables, quotes, double-quotes

我需要创建一个变量来存储动态生成的 HTML 内容。从 PHP 返回的字符串中的 html 内容可能有单引号或双引号。

```
html_content=<?=$string;?>; 
```

字符串可能有这样的双引号：

```
<span id="something">something else</span> 
```

或像这样的单引号：

```
<span id='something'>something else</span> 
```

那么，我怎样才能正确地将字符串保存在javascript中呢？我不能使用单引号或双引号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:48:30.040

您可以通过在输出之前在服务器端对其进行修改来保存这种字符串，如下所示：

```
html_content = "<?=addslashes($string);?>" 
```

然后，该方法`addslashes($string)`将在运行时转义任何双引号，然后再将其提供给 JavaScript 变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:41:13.500

好吧，您总是可以在存储之前使用[JavaScript 的转义函数来序列化您的字符串。](http://www.w3schools.com/jsref/jsref_escape.asp)那会奏效的。

不过，我认为这里更大的问题是，单引号实际上在您尝试在 id 属性中使用它们的方式（根据 HTML 规范）中是无效的。它总是必须是双引号。如果来自的代码不受您的控制，那么您无能为力，它只是坏了；但如果它在你的控制之下，你也应该修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T20:38:32.970

用于[`json_encode`](http://php.net/json-encode)将几乎任何变量从 PHP 传递到 JavaScript。

```
html_content=<?=json_encode($string)?>; 
```

如果是字符串，它将自动添加引号和任何必要的转义。

# servlets - 在由许多 servlet 扩展的基本 servlet 中仅在 WEB-INF 中加载自定义 XML 文件一次

> ID：12414413
> 
> 赞同：1
> 
> 时间：2012-09-13T20:37:13.623
> 
> 标签：servlets

我有一个普通的`Java EE`Web 应用程序，它不使用任何框架，如`Struts`等`JSF`。在这个 Web 应用程序中，我有一个自定义 XML ( `custom-config.xml`) 文件，其中包含特定于该应用程序的配置列表。我不想在`web.xml`文件中提及这个配置信息。现在当容器第一次初始化任何 servlet 时，我需要读取`custom-config.xml`文件中提到的配置信息。为了实现这一点，我创建了一个自定义的 Servlet 类`CustomServlet`，说它扩展自`HttpServlet`并且我的所有 Servlet 都将扩展自 this `CustomServlet`。所以当 Serlvet 类加载时，我的`CustomServlet`类也会被加载。

在我的`CustomServlet`课堂上，我有一个静态方法，可以加载`custom-config.xml`文件并理解本文中提到的配置。

我有两个问题。这是解决这个问题的正确方法吗？或者我应该把它放在类的`init()`方法中`CustomServlet`？如何`custom-config.xml`从类路径加载文件？我无法使用`ServletConfig.getResourceAsStream()`，因为我正在尝试`custom-config.xml`从静态方法加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T14:43:05.813

用静态方法做是没有意义的。从那里去是不可能的`ServletContext`。您需要在[`init()`](http://docs.oracle.com/javaee/6/api/javax/servlet/GenericServlet.html#init%28%29)方法中执行此操作。您可以使用 a`static AtomicBoolean`检查它是否已加载到当前 JVM 中。

```
public abstract class CustomServlet extends HttpServlet {

    private static AtomicBoolean loaded = new AtomicBoolean();

    @Override
    public void init() throws ServletException { 
        if (!loaded.getAndSet(true)) {
            InputStream input = getServletContext().getResourceAsStream("/WEB-INF/custom-config.xml");
            // ...
        }
    }

    // ...
} 
```

或者，使用`ServletContextListener`.

```
@WebListener
public class Config implements ServletContextListener {

    @Override
    public void contextInitialized(ServletContextEvent event) {
        InputStream input = event.getServletContext().getResourceAsStream("/WEB-INF/custom-config.xml");
        // ...
    }

    // ...
} 
```

您可以将解析的 XML 结果放在应用程序范围内，以使其可用于所有 servlet。

### 也可以看看：

*   [servlet 是如何工作的？实例化、会话、共享变量和多线程](https://stackoverflow.com/questions/3106452/how-do-servlets-work-instantiation-session-variables-and-multithreading/3106909#3106909)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-14T11:58:09.913

首先，为什么你有一个静态方法来加载 xml 文件？静态方法属于类而不属于对象。在超类中有一个默认构造函数并使其加载 xml。

```
public abstract class BaseServlet extends HttpServlet{

public Base(){
loadXml();
}
private void loadXml(){
...
}
}

public class Servlet1 extends BaseServlet {
...
} 
```

如果 xml 是类路径，则可以使用 FileInputStream() 加载 xml 文件。

# php - DQL 中的 Doctrine2 口音不敏感搜索

> ID：12414416
> 
> 赞同：1
> 
> 时间：2012-09-13T20:37:25.373
> 
> 标签：php, doctrine-orm, dql, mysql5

我没有找到关于那个主题的任何好东西。我目前正在实现简单的搜索功能，将使用 LIKE 来查找请求的记录。但我不想进行“无口音”搜索。

例如：对象名称为：“Gdańsk”，应通过字符串“Gdansk”和“Gdańsk”找到。

如果反过来的话，就跟转换搜索字符串一样简单，但既然我们必须在比较之前转换原始值，那就有点困难了。

欢迎任何帮助。

我使用 MySQL 5.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:50:41.583

这仅与 MySQL 有关。看：

[如何在 MySql 中进行口音敏感搜索](https://stackoverflow.com/questions/500826/how-to-conduct-an-accent-sensitive-search-in-mysql)

如果您想要*不区分重音*的搜索，请使用`utf8_general_ci`您的数据库排序规则。

# java - 十六进制字符串和十六进制

> ID：12414419
> 
> 赞同：0
> 
> 时间：2012-09-13T20:37:51.347
> 
> 标签：java

谁能告诉我这两者的区别？看起来相似但输出不同

```
 int b = 80 ;
    int a = Integer.parseInt(""+b, 16);
    int c = Integer.parseInt(Integer.toHexString(b)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T20:41:02.233

`int a = Integer.parseInt(""+b, 16)`解释`"80"`为以 16 为底的数字并将 a 设置为其值（`128`以 10 为底）。

`int c = Integer.parseInt(Integer.toHexString(b))`首先`80`以 10 为底转换为以 16 为底的数字（即`50`），然后将其解释为以 10 为底的数字，即`50`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:45:46.763

第一个表达式`Integer.parseInt(""+b, 16)`将值 80 解析为十六进制数 (0x80)，得到十进制数 128。

第二个表达式`Integer.parseInt(Integer.toHexString(b))`首先将十进制数 80 转换为十六进制 ( `Integer.toHexString(b)`)，得到十六进制数 50 (0x50)，然后将其解析为十进制数，得到十进制数 50。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T20:41:39.270

一个转换为十进制并将其解析为十六进制。

另一个转换为十六进制并将其解析为十进制。

如果它没有任何意义，那是一件好事。;)

# haml - 使用 Ember.js 的 HAML 中的车把模板

> ID：12414421
> 
> 赞同：9
> 
> 时间：2012-09-13T20:38:17.160
> 
> 标签：haml, ember.js

我正在寻找一种在嵌入 Rails 3.2 项目的 Ember.js 应用程序中使用 HAML 编写 Handlebars 模板的方法。

Handlebars 是 1.0.rc.1，需要 ember-rails gem 0.7.0
Ember 是 1.0.pre-90-g60e3c05

无论如何，我的模板现在看起来像这样：

```
<div id="container">
  This is my test
</div> 
```

我希望它是这样的：

```
#container
  This is my test 
```

顺便说一句，我看过 James Harton 的[Hamlbars](https://github.com/jamesotron/hamlbars)，但我不知道如何让它发挥作用。它不断输出`Ember.TEMPLATES["templates/choose_resort"] = Ember.Handlebars.compile("This is my test");`而不是预期的：

```
<div id="container">
  This is my test
</div> 
```

（即使返回的似乎未编译的代码中也缺少 div 块）

任何提示将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T06:43:00.590

试试新的[Emblem.js](https://github.com/machty/emblem.js)。它比 HAML 更接近 Slim，但如果你喜欢缩进模板语言和 Ember.js，你会得到最干净的结果。

它是 Ember.js[指南推荐的](http://emberjs.com/guides/templates/handlebars-basics/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T01:33:28.237

有一个名为 [Hamlbars](https://github.com/jamesotron/hamlbars)的 github 项目。它看起来像一个很棒的项目，我还没有在项目中使用它，但它看起来很有希望。

这：

```
= hb 'App.widgetController.title' 
```

将呈现：

```
{{App.widgetController.title}} 
```

还有这个：

```
%ul.authors
  = hb 'each authors' do
  %li<
    = succeed ',' do
      = hb 'lastName'
      = hb 'firstName' 
```

将渲染到

```
<ul class="authors">
  {{#each authors}}
    <li>{{lastName}}, {{firstName}}</li>
  {{/each}}
</ul> 
```

我看了看，我确定这正是您要找的。

干杯

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T08:51:26.543

如何分三步安装hamlbars：[指南](https://coderwall.com/p/ypsaxq)

# curl - php 中的 cURL 选项 - 什么选项是 -u

> ID：12414426
> 
> 赞同：11
> 
> 时间：2012-09-13T20:38:42.663
> 
> 标签：curl

我的参考文献列出了一个选项：

```
curl -u 'ExactID:Password'\ 
```

这是否意味着我只使用 CURLOPT_USERPWD 并使用格式 ExactID:Password？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-14T00:46:17.140

是的，CLI`-u`选项等价于 PHP`CURLOPT_USERPWD`选项，值相同。这两份文件中是否有不清楚的地方？

# c# - 如何更改 app.config 文件设置

> ID：12414435
> 
> 赞同：-2
> 
> 时间：2012-09-13T20:39:37.227
> 
> 标签：c#, wpf

如何更改我的 app.com 的 app.config 文件设置

```
 <configuration>
     <configSections>
        <sectionGroup name="applicationSettings" />
        <section name="Chat.Properties.Settings"/>
        </sectionGroup>
    </configSections>
    <applicationSettings>
        <Chat.Properties.Settings>
            <setting name="Chat_WebReference_WebService1" serializeAs="String">
                <value>http://localhost/logs/abc.asmx</value>
            </setting>
        </Chat.Properties.Settings>
    </applicationSettings>
</configuration> 
```

我想编辑值 **http://localhost/logs/abc.asmx**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:42:28.373

如果设置正确，您应该可以使用`Properties.Settings.Default`：

```
Properties.Settings.Default.Chat_WebReference_WebService1 = "new value"; 
```

如果你想持久化回文件，别忘了保存：

```
Properties.Settings.Default.Save(); 
```

* * *

**编辑**设置必须放在下面，`userSettings`否则上面会抛出错误。

```
<userSettings>
    <Chat.Properties.Settings>
        <setting name="Chat_WebReference_WebService1" serializeAs="String">
            <value>http://localhost/logs/abc.asmx</value>
        </setting>
    </Chat.Properties.Settings>
</userSettings> 
```

# c# - SharePoint 2010 客户端对象模型-“'基础连接已关闭：无法为 SSL/TLS 安全通道建立信任关系”

> ID：12414437
> 
> 赞同：1
> 
> 时间：2012-09-13T20:39:52.043
> 
> 标签：c#, wcf, ssl, sharepoint-2010

我试图为 SharePoint 2010 Web 服务编写一个代理，以绕过我们用 Ruby 编写的另一组服务的 NTLM 身份验证。我已经开发了它，当我在 Visual Studio 的 asp.net 服务器中调试它时，我能够很好地获取和解析数据。但是，当我将它部署到我们的 IIS 服务器时，我收到以下错误：

```
"The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel" 
```

我正在使用 SharePoint 2010 客户端对象模型来连接到我可以完全控制访问的自签名 Sharepoint 网站。同样，当我调试它时，它工作得非常好，但在 IIS 上，它会通过以下 Stacktrace 抛出该错误：

```
at System.Net.HttpWebRequest.GetResponse() at
Microsoft.SharePoint.Client.SPWebRequestExecutor.Execute() at
Microsoft.SharePoint.Client.ClientContext.EnsureFormDigest() at
Microsoft.SharePoint.Client.ClientContext.ExecuteQuery() at
SharepointProxy.SharepointProxy.GetListData(String listName) in
\\psf\home\documents\visual studio
2010\Projects\SharepointWSProxy\SharepointProxy\SharepointProxy.svc.cs:line 56 at
SharepointProxy.SharepointProxy.GetEmployees() in \\psf\home\documents\visual studio
2010\Projects\SharepointWSProxy\SharepointProxy\SharepointProxy.svc.cs:line 19 at
SyncInvokeGetEmployees(Object , Object[] , Object[] ) at
System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[]
inputs, Object[]& outputs) at
System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc) at
System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc&
rpc) at
System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc&
rpc) at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean
isOperationContextSet) 
```

这是相关的代码。也许我做错了什么？

```
ClientContext context = new ClientContext("https://url.to.subsite");
List destList = context.Web.Lists.GetByTitle(listName);
CamlQuery qry = new CamlQuery();
qry.ViewXml = "<Valid Query>";
ListItemCollection items = destList.GetItems(qry);
context.Load(items);
context.Load(destList);
context.ExecuteQuery(); 
```

上面的第 56 行是它引用 items 变量的地方。就在这条线的正下方。

有人有想法么？我完全不知道为什么它可以在调试中工作，但不能在 IIS 上工作。

# php - 如何在 php 中使用以下兄弟 xpath 查询？

> ID：12414439
> 
> 赞同：2
> 
> 时间：2012-09-13T20:40:04.757
> 
> 标签：php, xpath, siblings

XML:

```
<Routes>
  <Route type="source" >
   <Table>
     <Tablename>incoming</Tablename>
     <Fields>
       <Fieldsname ref="dest">truegoto</Fieldsname>
     </Fields>
   </Table>
  </Route>
</Routes> 
```

PHP：

```
$doc    = new SimpleXMLElement('routingConfig.xml', null, true);
$foo = $doc->xpath('/Routes/Route[@type="source"]/Table/Tablename[incoming]/following-sibling::Fields/Fieldsname[@ref="dest"]');
print_r($foo); 
```

试图`truegoto`通过知道的方式得到`<Tablename>incoming</Tablename>`。我当前的代码只返回一个空数组：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:11:35.727

问题不在于`following-sibling`零件。到那时，您已经没有选择任何节点。这是因为`Tablename[incoming]`意思是“`Tablename`有一个名为”的子元素的元素`incoming`。`Tablename[.="incoming"]`相反，您需要测试元素的内容：

```
/Routes/Route[@type="source"]/Table/Tablename[.="incoming"]/following-sibling::Fields/Fieldsname[@ref="dest"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:17:14.873

虽然我会接受@lonesomeday 的回答，但这里可能是一个更容易阅读的替代方案：

```
$foo = $doc->xpath('/Routes/Route[@type="source"]/Table[Tablename="incoming"]/Fields/Fieldsname[@ref="dest"]'); 
```

# jsf - com.sun.faces.logicalViewMap 用于查找/弹出 JSF 1.2

> ID：12414440
> 
> 赞同：0
> 
> 时间：2012-09-13T20:40:08.517
> 
> 标签：jsf, jsf-1.2

我有一个要求，一旦使用查找，我不希望查找视图存在于 com.sun.faces.logicalViewMap 中。

有人可以为我提供一些关于如何实现这一目标的信息。

基本上我不希望logicalViewMap 有超过4 个视图，我在web.xml 中设置了值。

但是由于我的屏幕有查找页面（通过 window.open 打开并且页面是 JSF），所以我最终会遇到这样的情况，即查找添加到视图中，并且在单击 5 个视图之后.. 主页会抛出 ViewExpiredException 。

```
<context-param>
 <param-name>com.sun.faces.numberOfViewsInSession</param-name>
 <param-value>4</param-value>
</context-param>
<context-param>
  <param-name>com.sun.faces.numberOfLogicalViews</param-name>
  <param-value>4</param-value>
</context-param> 
```

拉维

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T17:50:13.913

我们发现通过将 numberOfViewsInSession 修复为 15，我们能够解决该问题。

```
<context-param>
  <param-name>com.sun.faces.numberOfViewsInSession</param-name>
  <param-value>15</param-value>
</context-param>
<context-param>
  <param-name>com.sun.faces.numberOfLogicalViews</param-name>
  <param-value>4</param-value>
</context-param> 
```

# php - 无法在循环中到达变量 - php & fatfree 框架

> ID：12414451
> 
> 赞同：1
> 
> 时间：2012-09-13T20:40:44.303
> 
> 标签：php, fat-free-framework

我在 PHP 代码中创建一个数组，如下所示：

```
foreach ($this->get("DB")->result as $ct){
$contentTexts[$ct["langCode"]][$ct["wordCode"]] = $ct["wordText"]; //$contentTexts is a two dimensional array
} 
```

并分配一个这样的变量

```
$this->set("contentTexts",$contentTexts); // $contentTexts is an array described above
$this->set("lwMetaTitle",$content->lwMetaTitle); 
```

在模板文件中，当我想使用时：

```
<F3:repeat group="{{@contentTexts} }" key="{{@langCode}}" value="{{@ctext}}" counter="{{@counter}}">

{{@ctext[@lwMetaTitle]}}

</F3:repeat> 
```

它抛出一个错误。当我改变这一行

```
{{@ctext[@lwMetaTitle]}} 
```

至

```
{{var_dump(@ctext[@lwMetaTitle])}} 
```

它描述了这样的错误：

内部服务器错误未定义索引：@lwMetaTitle

我认为它无法在 for 循环中到达 @lwMetaTitle 变量。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T21:18:08.020

我知道这并不完全是一个答案，但我只是避免使用 F3 的模板系统，而​​是使用直接的 PHP 处理视图。我发现这要容易得多，尤其是因为 F3 的文档和支持很糟糕。此外，既然您已经了解 PHP，为什么还要学习新的非标准语法呢？

除此之外，我唯一的另一个想法是尝试在循环之外获取框架变量并将其分配给局部变量，如下所示：

```
$var = F3::get('var_name');
<F3:repeat .... >
  <?= $var; ?>
</F3:repeat> 
```

# ruby-on-rails - Rails before_filter

> ID：12414452
> 
> 赞同：0
> 
> 时间：2012-09-13T20:40:45.240
> 
> 标签：ruby-on-rails, devise

帮我解决问题：

我有两个设计模型（用户和管理员）

我有一些带有路由的后模型和控制器：

```
/posts
/posts/80
/posts/80/edit 
```

我想要：管理员拥有所有访问权限用户可以访问：

```
/post
   and 
/post/80 ( if he is creator of this post ) 
```

我这样做了：

```
 class PostsController < ApplicationController
        before_filter :check_guest_logged_in!, :except => [:index, :show]

.
.
.
    private

    def check_guest_logged_in! 
      if user_signed_in?
        authenticate_user!  

      elsif admin_signed_in?
        authenticate_admin!
      else
        redirect_to root_path
      end   
    end 
```

但在这种情况下，如果用户授权，他可以放入浏览器

```
/posts/80/edit 
```

并且他可以访问（即使他不是这篇文章的创建者）

**我怎样才能解决这个问题 ？**

我想要这样私人的东西

```
 def check_guest_logged_in! 
      if user_signed_in?
        authenticate_user!

    if ( current_user.id == @post.user.id ) 
    else
      return false;
    end     

      elsif admin_signed_in?
        authenticate_admin!
      else
        redirect_to root_path
      end   
    end 
```

但它不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T22:43:00.287

我的建议是使用 CanCan gem

[https://github.com/ryanb/cancan](https://github.com/ryanb/cancan)

这是一个很好的railscast

[http://railscasts.com/episodes/192-authorization-with-cancan](http://railscasts.com/episodes/192-authorization-with-cancan)

使用 cancan 你可以做这样的事情

```
class Ability
  include CanCan::Ability

  def initialize(user)
    user ||= User.new # guest user (not logged in)
    if user.admin?
      can :manage, :all
    else
      can :read, :all
    end
  end
end 
```

# django - 如何使用 Django-Userena 将初始值传递给自定义表单

> ID：12414454
> 
> 赞同：0
> 
> 时间：2012-09-13T20:40:54.820
> 
> 标签：django, django-forms, django-views

我一直在网上搜索（和 StackOverflow），寻找看似非常简单的问题的答案。我正在使用带有自定义表单的 django-userena。

在我的 form.py 里面是：

```
class RegistrationForm(SignupFormOnlyEmail):

    first_name = forms.CharField(label='First Name', max_length=30, required=True, error_messages={'required':'Please Provide Your First Name'})
    last_name = forms.CharField(label='Last Name', max_length=30, required=True)
    email2 = forms.EmailField(widget=forms.TextInput(attrs=dict(attrs_dict, maxlength=75)), label=_("Retype Email"), required=True)
    parent_type = forms.ChoiceField(label="I am a", choices=ACCOUNT_TYPES, widget=forms.RadioSelect)
    child_count = forms.ChoiceField(label="My Kids", choices=KID_CHOICES, widget=forms.Select)
    grade = forms.ChoiceField(label="My Classroom", choices=GRADE_CHOICES, widget=forms.Select)
    tos = forms.BooleanField(label="I accept the Terms of Use.", required=True)

    def __init__(self, *args, **kwargs):

        self.initial = kwargs.pop('initial', None)
        kidCount = self.initial['child_count']
        account_type = self.initial['parent_type']

        super(RegistrationForm, self).__init__(*args, **kwargs) 
```

在我的 urls.py 里面我放了：

```
url(r'^membership/signup/$', signup_view, name='userena_signup'), 
```

我的自定义视图如下所示：

```
def signup_view(request):

    form = RegistrationForm(initial={'parent_type':request.session['parent_type'],'child_count':request.session['child_count']})
    response = userena_views.signup(request,  signup_form=form, extra_context={'section':'Membership','pagetitle':'Sign Up'})
    return response 
```

当我发布表单并转到 /membership/signup/ 时，我得到一个“TypeError”

> “RegistrationForm”对象不可调用

这是堆栈跟踪的转储：

> 回溯：get_response 111 中的文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/handlers/base.py”。 response = callback(request, *callback_args, **callback_kwargs）signup_view 42 中的文件“/Users/lawrenceleach/Dropbox/Sites/django/wonderville/membership/views.py”。 response = userena_views.signup(request, signup_form=form, extra_context={'section':'Membership ','pagetitle':'Sign Up'}) File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/userena/decorators.py" in _wrapped_view 28\. return view_func( request, *args, **kwargs) 注册 115 中的文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/userena/views.py”。表格 = 注册表格（）
> 
> 异常类型：/membership/signup/ 处的 TypeError 异常值：“RegistrationForm”对象不可调用

就像我说的，我确信答案正盯着我看，而我只是看不到它。任何帮助将不胜感激。

先感谢您！

L.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:47:42.630

您应该将表单类传递给`signup`对象的函数。查看[代码](https://github.com/bread-and-pepper/django-userena/blob/master/userena/views.py#L76)以获取更多信息。

安装：

```
form = RegistrationForm(initial={'parent_type':request.session['parent_type'],'child_count':request.session['child_count']})
response = userena_views.signup(request,  signup_form=form, extra_context={'section':'Membership','pagetitle':'Sign Up'}) 
```

它应该是：

```
response = userena_views.signup(request,  signup_form=RegistrationForm, extra_context={'section':'Membership','pagetitle':'Sign Up'}) 
```

因为里面`userena_views.signup`有`form = signup_form()`。当然，现在您丢失了表单初始值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T20:07:40.740

解决方案是将初始表单值作为字典对象传递给视图中表单调用的“extra_context”变量。如果一直使用 Django 的内置表单工具，那么我最初在上面所做的就可以了。我把这个问题发布给了 Userena 的人。这似乎是他们系统中的一个错误。

# php - 将活动类添加到 php 生成的菜单中的选定链接

> ID：12414456
> 
> 赞同：0
> 
> 时间：2012-09-13T20:40:58.860
> 
> 标签：php, class, dynamic-data

我想在列表项中添加 class="active" 以突出显示所选菜单，但我不知道如何执行此操作，因为我不太熟悉 php。

这就是我在 tpl 文件中的内容

```
<ul class="menu">
<li>
    <a<?php echo $target; ?> href="<?php echo $link; ?>"<?php echo $nofollow; ?>><?php echo $this->escape_html($link_title); ?></a>
    <?php echo $sub_menu; ?>
</li> 
```

并在 php 文件中

```
 $links = $this->db->GetAll($query);
    foreach($links as $link) {
        $template = $this->PMDR->getNew('Template');
        $template->set('link',$link['url']);
        $template->set('link_title',$link['title']);
        $template->set('nofollow',($link['nofollow'] ? ' rel="'.$link['nofollow'].'"' : ''));
        $template->set('target',($link['target'] ? ' target="'.$link['target'].'"' : ''));
        $template->set('indent',str_repeat('&nbsp;&nbsp;&nbsp;&nbsp;',$level));
        ob_start();
        $this->getMenuLoop($link['id'], $level+1);
        $sub_menu = ob_get_clean();
        if(!empty($sub_menu)) {
            $menu_template = $this->PMDR->getNew('Template',$this->template);
            $menu_template->set('items', $sub_menu);
            $sub_menu = $menu_template->render();
        }
        $template->set('sub_menu', $sub_menu);
        echo $template->render($this->item_template);
    }
} 
```

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T22:05:07.320

在您的 tpl 中，添加`$class`（我把它放在 中`$target`，但它可以在 中的任何地方`<a>`）

```
<ul class="menu">
<li>
    <a<?php echo $target; echo $class; ?> href="<?php echo $link; ?>"<?php echo $nofollow; ?>><?php echo   $this->escape_html($link_title); ?></a>
    <?php echo $sub_menu; ?>
</li> 
```

在你的 php 文件中添加

```
$current_url = 'http'.(empty($_SERVER['HTTPS'])?'':'s').'://'.$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI']; 
```

和

```
$template->set('class',(($current_url == $link['url']) ? ' class="active"' : '')); 
```

此检查以查看当前 url 是否与 相同`$link['url']`，并添加 `class="active"

```
 //gets the current page
    $current_url = 'http'.(empty($_SERVER['HTTPS'])?'':'s').'://'.$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];

    $links = $this->db->GetAll($query);
foreach($links as $link) {
    $template = $this->PMDR->getNew('Template');
    $template->set('link',$link['url']);
    $template->set('link_title',$link['title']);
    $template->set('nofollow',($link['nofollow'] ? ' rel="'.$link['nofollow'].'"' : ''));
    $template->set('target',($link['target'] ? ' target="'.$link['target'].'"' : ''));
    $template->set('class',(($current_url == $link['url']) ? ' class="active"' : ''));
    $template->set('indent',str_repeat('&nbsp;&nbsp;&nbsp;&nbsp;',$level));
    ob_start();
    $this->getMenuLoop($link['id'], $level+1);
    $sub_menu = ob_get_clean();
    if(!empty($sub_menu)) {
        $menu_template = $this->PMDR->getNew('Template',$this->template);
        $menu_template->set('items', $sub_menu);
        $sub_menu = $menu_template->render();
    }
    $template->set('sub_menu', $sub_menu);
    echo $template->render($this->item_template);
} 
```

}

# java - 如何将查询结果直接转换为 Hibernate 中的数据对象？

> ID：12414459
> 
> 赞同：0
> 
> 时间：2012-09-13T20:41:10.957
> 
> 标签：java, hibernate

我有一个像

```
class DocInfo
{
String docId;
String corrId;
String familyId;
} 
```

这映射到数据库表。我使用会话工厂和条件的组合在休眠中执行我的查询，该查询返回与 docId 上的查询匹配的行。

```
Query q = getCurrentSession().createQuery("from DocInfo item where item.docId = :docId");
        q.setString("docId", docId);
        return q; 
```

有没有办法从查询结果中直接创建数据对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:43:36.703

是的，您可以使用 q.list() 获取 DocInfo 列表

```
List<DocInfo> docInfoList = q.list();
return docInfoList; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:43:28.483

`Query.list()`将执行查询并返回`List`结果`DocInfo`。

# python - 通过适配器而不是 REST 查询 CouchDB 是否更快？

> ID：12414462
> 
> 赞同：2
> 
> 时间：2012-09-13T20:41:18.423
> 
> 标签：python, database, performance, couchdb

假设我在 CouchDB 数据库中有一些数据。总大小约为 100K 文档。

我有一个存储“获取所有实体”视图的 _design 文档。

假设请求是在本地计算机上针对本地数据库完成的：

1.  通过卷曲：`curl -X GET http://127.0.0.1/mydb/_design/myexample/_view/all`
2.  通过[Couchdbkit](http://couchdbkit.org/docs/gettingstarted.html)：`entities = Entity.view('mydb/all’)`

与（JSON 编码/解码、HTTP 请求解析等）相比，是否`1`必须执行任何额外的计算，这如何影响从数据库中查询“所有”实体的性能？`2`

我想直接查询数据库（选项 2）应该比将请求/响应包装成 JSON 更快，但我不确定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T20:47:44.653

在 API 覆盖下，Couchdbkit 使用[`restkit`包](http://pypi.python.org/pypi/restkit)，它是一个 REST 库。

换句话说，Couchdbkit 是 CouchDB REST API 的 Python 式 API，将完成与自己使用 REST API 相同的工作量。

# jquery - 单击时添加和删除元素

> ID：12414466
> 
> 赞同：0
> 
> 时间：2012-09-13T20:42:03.850
> 
> 标签：jquery, dom

我试图通过单击添加和删除 div。我成功添加了它，但无法弄清楚**删除**部分。

*   +问题：是否使用 .remove() 从 DOM 中完全删除了元素？

**HTML：**

```
<center>
<a href='#' id='gogo'>Add</a>
<div id='sexy'></div>
</center> 
```

**jQuery：**

```
var extra="<div class='bass'><a href='#' class='gaga'>Remove</a></div>";

$('#gogo').on('click', function(){

    $('#sexy').append(extra);

});

$('.gaga').on('click', function(){

    $(this).parent().remove();

}); 
```

**JSFIDDLE：http:** [//jsfiddle.net/Vmhe2/1/](http://jsfiddle.net/Vmhe2/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:50:00.350

这应该有帮助

```
$('#gogo').on('click', function(){

    $('#sexy').append(extra);

    $('.gaga').on('click', function() {
         $(this).parent().remove();
    });

}); 
```

我在附加额外的 div 后立即移动了删除功能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:43:34.247

是的，该元素已完全从 DOM 中删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T20:43:52.897

## 是的，`.remove()`将从 DOM 树中完全删除元素。

* * *

但是，您的删除代码应如下所示：

```
$('#sexy').on('click', '.gaga', function(e){ 
    e.preventDefault();  // as .gaga is anchor, so use preventDefault() 
                         // to stop default page load of browser
    $(this).parent().remove();
}); 
```

当您`.gaga`动态追加时，您需要委托事件处理，您可以使用***[`.on()`](http://api.jquery.com/on)***方法来完成。

***[工作样本](http://jsfiddle.net/Vmhe2/4/)***

* * *

### 笔记

`.on()`代表事件*（又名现场）*的语法是：

```
$(StatciParent).on(eventName, target, handlerFunction); 
```

其中，`StaticParent`指`target`非动态元素的父元素，是`target`您需要绑定事件的元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T20:44:59.143

当您注册事件处理程序时，DOM 元素必须在那个时刻存在。如果要动态绑定，请使用delegate()：[http ://api.jquery.com/delegate/](http://api.jquery.com/delegate/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T21:01:27.257

[http://jsfiddle.net/Vmhe2/49/](http://jsfiddle.net/Vmhe2/49/)

试试这个 ：）

# php - jquery标签云不起作用

> ID：12414471
> 
> 赞同：-1
> 
> 时间：2012-09-13T20:42:15.143
> 
> 标签：php, jquery, blogs

[我正在使用的标签系统（链接）](http://primegap.net/2011/03/04/jqcloud-a-jquery-plugin-to-build-neat-word-clouds/)

简单地说内联标签永远不会被云取代

我从文件夹中加载了我的 JS（已确认链接）

```
<script type="text/javascript" src="/jquery/jqquery-1.7.2.js"></script>
<script type="text/javascript" src="/jquery/jqcloud-1.0.1.js"></script>
<link rel="stylesheet" href="/jquery/jqcloud.css" type="text/css" media="screen"> 
```

然后我使用一些 PHP 来生成标签数组

```
<script type="text/jscript">
var word_list = [
<?
foreach ($array as $key => $value) {
if ($value == $average) { $weight = 2;} 
else if ($value > $average) { $weight = 3;} 
else if ($value < $average) { $weight = 1;}
if (strlen($key) > 1 ){
  echo "{text: \"".$key."\", weight:".$weight.", url: \"http://myurl.com/tags/".$key."\", title: \"".$value."\"}";
  $total -= 1;
  if ($total == 0) echo ",";
}
}
?>
];
$(document).ready(function() {
    $("#wordcloud").jQCloud(word_list);
}); 
```

然而，我的标签部分只有一个空 div

[http://jsfiddle.net/K28Mc/ 运行](http://jsfiddle.net/K28Mc/)示例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:56:13.887

问题似乎是你永远不会关闭你的数组：

```
var word_list = [ // <-Note this character..
<?
foreach ($array as $key => $value) {
if ($value == $average) { $weight = 2;} 
else if ($value > $average) { $weight = 3;} 
else if ($value < $average) { $weight = 1;}
if (strlen($key) > 1 ){
  echo "{text: \"".$key."\", weight:".$weight.", url: \"http://myurl.com/tags/".$key."\", title: \"".$value."\"}";
  $total -= 1;
  if ($total == 0) echo ",";
}
}
?>
}; //<------- Right here, you fail to close the array.  This should be a ].  I have a feeling this is breaking everything else.
$(document).ready(function() {
    $("#wordcloud").jQCloud(word_list);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T16:08:24.213

```
foreach ($result['keywords'] AS $k => $keyword ) 
{

 $font_size = rand(10, 25);
 $fonts = array("Helvetica", "Arial", "Courier", "Georgia", "Serif", "Comic Sans", "Tahoma",  "Roman", "Modern");
 shuffle($fonts);
$randomFont = array_shift($fonts);
echo ' <a href="" title="' . $keyword['name'] . '">' . '<span style="font-family:' . $randomFont . '; font-size:'.$font_size.'px;">' . $keyword['name'] . '&nbsp;</span></a>';
} 
```

# python - 是否有与 Django Model.objects.filter() 等效的 CherryPy？

> ID：12414472
> 
> 赞同：0
> 
> 时间：2012-09-13T20:42:17.997
> 
> 标签：python, cherrypy

我知道在 Django 中，我可以使用 ModelName.objects.filter() 之类的东西从数据库中获取对象。

CherryPy 中是否有类似的模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:51:29.387

是的，但不是本地人。有几个 python ORM 似乎与具有与 django 类似的语法的樱桃派一起工作得很好。SQLAlchemy 是一个非常流行且支持良好的 ORM。它有一个庞大的活跃社区，可能是事实上的 python ORM。在cherrypy[网站](http://tools.cherrypy.org/wiki/SqlAlchemy)上发布了一个有助于集成的[工具。](http://code.google.com/p/webpyte/source/browse/trunk/webpyte/sqlalchemy_tool.py)

来自[维基百科](http://en.wikipedia.org/wiki/CherryPy)：

对象关系映射器：

1.  SQLAlchemy — Python 应用程序的数据库后端和 ORM。TurboGears 2.x 使用 CherryPy 作为服务器，使用 SQLAlchemy 作为其默认 ORM。[13]

2.  SQLObject — 一种流行的 ORM，用于为您的数据库提供对象接口。支持许多常见的数据库后端：发行版中包括 MySQL、PostgreSQL、SQLite、Sybase SQL Server、MaxDB、Microsoft SQL Server 和 Firebird。TurboGears 1.x 使用 CherryPy 作为服务器，使用 SQLObject 作为 ORM。[14]

3.  Storm — Canonical Ltd.（Ubuntu 的制造商）的 ORM

4.  Dejavu[15] — 用于 Python 应用程序的公共领域、线程安全的 ORM

# php - 如何创建一个搜索引擎来搜索mysql数据库

> ID：12414483
> 
> 赞同：2
> 
> 时间：2012-09-13T20:43:00.040
> 
> 标签：php, mysql, database, search, pdo

> **可能重复：**
> [如何在 PHP 中使用 LIKE 语句创建 PDO 参数化查询？](https://stackoverflow.com/questions/583336/how-do-i-create-a-pdo-parameterized-query-with-a-like-statement-in-php)

目前我有一个非常简单的搜索引擎，它使用旧的 mysql_* 查询并在查询中使用“like”，我知道这现在已经过时了，使用 like 查询会随着数据库的增长而变慢？

我正在寻找一些关于如何使用 PDO 创建搜索引擎的想法，因为它提供的保护比我目前拥有的更多，我研究了在查询中使用 MATCH 和 AGAINST 来搜索“标题”和“描述”列我的数据库，但由于我是初学者，我不确定从哪里开始。

我一直在试图弄清楚如何实现搜索查询，并在用户输入多个关键字时让搜索工作

非常感谢任何帮助，我知道这可能是一个很大的要求有人向我解释这一点，但我正在尽我所能学习，因为我是一名学生并正在做一个项目

谢谢大家的帮助！

这是我当前代码的一部分，我希望将其更改并更新为更安全且具有更好搜索功能的内容：

```
$query = "SELECT * FROM people WHERE ";

foreach ($terms as $each){
$i++;

if ($i == 1)
    $query .= "lname LIKE '%$each%' ";
if($i == 1 && $_GET['category'] != '') {
    $query .= "AND category = '$chosencategory' ";
}
else
    $query .= "AND lname LIKE '%$each%' ";
if($_GET['price'] != '') {
    $query .= " ORDER BY price $price";
}
echo $query;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:03:45.743

现在这是一个非常复杂的话题。因此，我只想为您指出几个起点。如果其他人能够在这里为这个非常复杂的话题制定一个很好的答案，我很乐意给他们一个赞成票。

*   原则 1 有一个不错的“搜索引擎”。[1]（如果您还没有使用 ORM，我强烈建议您尝试一下。）
*   Lucene[2] 也值得一试。
*   滚动您自己的搜索引擎。我也曾经认为它与一些 MySQL 功能或其他东西有关，但事实并非如此。这一切都是为了建立良好的索引并很好地使用它们。（也就是说，自己构建它们。不仅仅是使用数据库索引。）如果你有时间，这实际上是一个非常有趣的话题。
*   购买*改变未来*的九种算法 John MacCormick。[3] 它有一个关于搜索引擎如何工作的精彩章节。

[1] [http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/searching.html](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/searching.html)

[2] [http://en.wikipedia.org/wiki/Lucene](http://en.wikipedia.org/wiki/Lucene)

[3] [http://www.amazon.com/Nine-Algorithms-That-Changed-Future/dp/0691147140](https://rads.stackoverflow.com/amzn/click/com/0691147140)

# html - 网站的全球音频播放器

> ID：12414484
> 
> 赞同：0
> 
> 时间：2012-09-13T20:43:00.580
> 
> 标签：html, drupal-7, audio-streaming, html5-audio

我正在 Drupal 7 上建立一个网站，想在首页添加一个音频播放器，当用户转到另一个页面时，我希望音乐保持不间断（继续播放）。

这可能不使用框架标签吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:00:13.183

您可以通过使用 javascript（更可能是 jQuery 等）将您的内容（通过 AJAX）加载到页面中并将其插入到内容块中来做到这一点。这将允许您避免框架，但会增加新问题。一方面，您需要更改 Drupal 为您所做的大部分工作以允许此 AJAX 加载内容的方式。这意味着菜单需要触发 javascript 而不是加载页面。内容中的链接也是如此。

使用一些聪明的 jQuery，您可以将大部分链接功能与一些 live() 事件绑定，但如果您以前从未这样做过，那就有点棘手了。更具体地说，我需要看看您的代码的真实外观。

像 jQuery BBQ 这样的插件可以减轻这种技术的一些痛苦，但它不会是一个神奇的解决方案，它只是一个强大的工具，所以你可以自己做。[http://benalman.com/projects/jquery-bbq-plugin/](http://benalman.com/projects/jquery-bbq-plugin/)

# c# - 如果设置了所有属性，如何进行单元测试。没有重复

> ID：12414485
> 
> 赞同：3
> 
> 时间：2012-09-13T20:43:02.070
> 
> 标签：c#, .net, unit-testing, properties

您好我正在尝试测试一个代表 GUI 布局主题的类。它具有颜色和大小属性以及设置默认值的方法。

```
public class LayoutTheme : ILayoutTheme
{
    public LayoutTheme()
    {
        SetTheme();
    }

    public void SetTheme()
    {
        WorkspaceGap = 4;
        SplitBarWidth = 4;
        ApplicationBack = ColorTranslator.FromHtml("#EFEFF2");
        SplitBarBack = ColorTranslator.FromHtml("#CCCEDB");
        PanelBack = ColorTranslator.FromHtml("#FFFFFF ");
        PanelFore = ColorTranslator.FromHtml("#1E1E1E ");
        // ...
    }

    public int WorkspaceGap { get; set; }
    public int SplitBarWidth{ get; set; }
    public Color ApplicationBack { get; set; }
    public Color SplitBarBack { get; set; }
    public Color PanelBack { get; set; }
    public Color PanelFore { get; set; }
    // ...
} 
```

我需要测试： 1\. 如果所有的属性都是由 SetTheme 方法设置的。2.如果设置属性没有重复。

对于第一个测试，我首先循环遍历所有属性并设置一个不寻常的值。之后，我调用 SetTheme 方法并再次循环检查是否所有属性都已更改。

```
[Test]
public void LayoutTheme_IfPropertiesSet()
{
    var theme = new LayoutTheme();
    Type typeTheme = theme.GetType();

    PropertyInfo[] propInfoList = typeTheme.GetProperties();

    int intValue = int.MinValue;
    Color colorValue = Color.Pink;

    // Set unusual value
    foreach (PropertyInfo propInfo in propInfoList)
    {
        if (propInfo.PropertyType == typeof(int))
            propInfo.SetValue(theme, intValue, null);
        else if (propInfo.PropertyType == typeof(Color))
            propInfo.SetValue(theme, colorValue, null);
        else
            Assert.Fail("Property '{0}' of type '{1}' is not tested!", propInfo.Name, propInfo.PropertyType);
    }

    theme.SetTheme();

    // Check if value changed
    foreach (PropertyInfo propInfo in propInfoList)
    {
        if (propInfo.PropertyType == typeof(int))
            Assert.AreNotEqual(propInfo.GetValue(theme, null), intValue, string.Format("Property '{0}' is not set!", propInfo.Name));
        else if (propInfo.PropertyType == typeof(Color))
            Assert.AreNotEqual(propInfo.GetValue(theme, null), colorValue, string.Format("Property '{0}' is not set!", propInfo.Name));
    }
} 
```

实际上测试效果很好，我什至发现了两个错过的设置，但我认为它写得不好。可能它可以与接口的 Moq 一起使用并检查是否设置了所有属性。

关于第二次测试，不知道该怎么做。可能模拟和检查调用次数可以做到这一点。有什么帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T10:46:10.230

为了测试是否所有属性都设置为特定值，我将为`Equals()`此类实现并创建具有已知值的第二个对象并检查是否相等。这在测试状态变化等时也会派上用场。

如果没有明确的理由，我当然不会测试一个属性是否被多次设置。

# .net - WCF HTTP 文件流服务以及如何处理文件更改

> ID：12414486
> 
> 赞同：0
> 
> 时间：2012-09-13T20:43:02.380
> 
> 标签：.net, wcf, http, streaming

实现这个的正确方法是什么？我有一个简单的 WCF **http**流服务。我的 OperationContract 返回一个 Stream 对象：

```
返回 File.OpenRead（路径）；
```

但是如何处理服务器端的本地文件更改？如何替换当前文件？我不能，因为有些客户正在下载它...

我应该改变行为并返回部分内容吗？但是怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:59:28.890

也许没有您需要的可扩展性，但您可以打开文件 OpenShare = LockWrite

[OpenShare 枚举](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.openshare.aspx)

然后要更新文件，您需要等待锁定清除。

# android - getPressure 总是返回 1.0

> ID：12414491
> 
> 赞同：2
> 
> 时间：2012-09-13T20:43:39.747
> 
> 标签：android, pressure, motionevent

有谁知道为什么`getPressure()`总是返回`1.0`？

这是我的代码：

```
@Override
    public boolean onTouchEvent(MotionEvent event) {
        super.onTouchEvent(event);

        System.out.println(event.getPressure());

        return true;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:09:35.533

> 有谁知道为什么 getPressure() 总是返回 1.0？

典型的触摸屏/输入设备无法测量压力。您要么不按下并没有触摸事件，要么按下并获得值为 1 的触摸事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-15T19:15:20.823

[https://groups.google.com/forum/#!topic/android-developers/10pF8EUEuy0](https://groups.google.com/forum/#!topic/android-developers/10pF8EUEuy0) 这是关于 getPressure 和 getSize() 如何在 Android 中工作的答案，我认为这会有所帮助

# sqlite - SQLLite：如何重新编号自动递增字段？

> ID：12414493
> 
> 赞同：1
> 
> 时间：2012-09-13T20:43:47.810
> 
> 标签：sqlite

我有两个不同的 CSV 文件，我已将它们合并并导入到 SQLite3 数据库中的单个表中。每个 CSV 文件都包含一个名为 ID 的列。因为，一些 ID 是重复的（跨 CSV 文件），这是一个主键字段，我需要一种方法来完全重新编号表中每一行的 ID 字段。

ID 字段也是一个自增字段。

所以，我想做的是运行 SQL 命令或其他方法，其中将重置表的每一行的 ID 以确保唯一性。例如，第一行的 ID 字段将设置为 1，然后设置为 2，依此类推。

请注意，以 1 开头并不是那么重要。确保主键唯一性是这里的目标。它从哪个数字开始并不重要。也没有外键关系，所以这不是问题。

任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T22:07:11.813

好的，就我而言，我发现不导入 ID 列是最简单的。相反，我导入了其他所有内容，然后添加了一个自动增量类型的 ID 字段。一旦我这样做了，一切都会按照我的意愿重新编号。

# jquery - 在 HAML 中使用 JQuery 客户端模板逻辑

> ID：12414494
> 
> 赞同：1
> 
> 时间：2012-09-13T20:43:48.367
> 
> 标签：jquery, ruby, haml, jquery-templates

我目前在一个[get-serve](http://get-serve.com)的 web-services 项目中使用 HAML。似乎我的设置不允许我使用 JQuery 客户端模板逻辑。具体来说...

如何根据变量是否存在有条件地呈现视图代码。在我的 foo.html.haml 文件中，我正在尝试做

```
{{if $data}}
Show this
{{/if}} 
```

如果我没有有效地描述我的问题，我是使用 Web 服务构建应用程序的新手，请原谅我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T00:13:57.900

如果我理解正确，听起来您正在尝试将一些 tmpl 逻辑与生成该页面的 HAML 混合。重要的是要记住 jQuery tmpl 将在所有 HAML 被解析并转换为 HTML 之后发生。

因此，如果您想要以下内容作为客户端 HTML：

```
<script id="myTmpl" type="text/x-tmpl">
    {{if $error}}
         <div class="error">
             Error!!!
         </div>
    {{else}}
         <div class="non-error">
             Everything looks ${adjective} to me.
         </div>
    {{end if}}
</script> 
```

您可以像下面这样使用 HAMl（缩进将关闭）：

```
%script#myTmpl{:type => "text/x-tmpl"}
    :plain
        {{if $error}}
    .error Error!
    :plain
        {{else}}
    .non-error Everything looks ${adjective} to me.
    :plain
        {{/if}} 
```

请记住，您正在尝试输出可解析的 jQuery-tmpl。您的另一个选择是在 HAML 的`:plain`标签中执行所有操作，有些人更喜欢这样做以提高可读性。

# css - Internet Explorer 8 背靠背 divs CSS 问题

> ID：12414502
> 
> 赞同：0
> 
> 时间：2012-09-13T20:44:37.313
> 
> 标签：css, internet-explorer, html

以下布局在除 Internet Explorer 8 之外的所有浏览器（Firefox、Chrome、Opera）中都能正常工作：

HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <link href="style.css" rel="stylesheet" type="text/css"/>
    <head>
    <body>
        <div id="divMain" class="CMain">
            <div id="divL" class="CLeft">
            </div>
            <div id="divR" class="CRight">
            </div>
        </div>
    </body>
</html> 
```

CSS：

```
.CMain {
    position: absolute;
    overflow: hidden;
    top: 20px;
    left: 20px;
    right: 20px;
    height: 75%;
    min-width: 500px;
    min-height: 400px;
    max-height: 550px;
    background-color: cyan;
    border: 1px solid #000000;
    margin: 0 auto;
}

.CLeft {
    position: absolute;
    overflow: visible;
    top: 0px;
    right: 50%;
    width: 49%;
    height: 100%;
    min-width: 200px;
    min-height: 450px;
    max-width: 450px;
    max-height: 550px;
    background-color: yellow;
    border: 1px solid #000000;
    margin: 0 auto;
    padding: 0px;
}

.CRight{
    position: absolute;
    overflow: visible;
    top: 0px;
    left: 50%;
    width: 49%;
    height: 100%;
    min-width: 200px;
    min-height: 450px;
    max-width: 450px;
    max-height: 550px;
    background-color: blue;
    border: 1px solid #000000;
    margin: 0 auto;
    padding: 0px;
} 
```

两个内部 div 应该在主 div 的中心背靠背，它们显然在除 IE8 之外的所有浏览器中。在 IE8 中，左 div 位于左侧，而不是中心。

难道我做错了什么？（请不要建议删除最小/最大宽度/高度约束，它们是必需的）。任何建议将不胜感激。

这是这个设置的一个小提琴：http: [//jsfiddle.net/fNtJU/](http://jsfiddle.net/fNtJU/)

imageshack截图链接ie8：http: [//img831.imageshack.us/img831/3838/ie8g.jpg](http://img831.imageshack.us/img831/3838/ie8g.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T22:42:26.837

您是否尝试过在主容器上设置宽度？例如，宽度：90%；并失去left:20px;/right:20px;。我不认为当父容器没有指定明确的宽度时，子容器可以计算位置，即使使用最大宽度也是如此。我目前无法在 ie8 上进行测试。

# jquery - django-dynamic-formset 为每个表单集创建两个添加/删除链接

> ID：12414504
> 
> 赞同：0
> 
> 时间：2012-09-13T20:44:40.737
> 
> 标签：jquery, django, dynamic, dynamic-forms, formset

出于某种原因，我对 django-dynamic-formset 的实现有点滑稽。

它正在为我的模板中的每个动态表单集创建两个添加/删除链接。

我一直在摆弄试图弄清楚这一点，它得到了我最好的。

[这](http://imgur.com/QeowW)是我正在谈论的错误的屏幕截图

如果您想自己触发错误，我也可以提供登录名，这是我的模板：

```
<head>
    <script type="text/javascript" src="{{ STATIC_URL }}jquery.formset.js"></script>
    <script type="text/javascript">
       $(function() {
           $('#ingredients tbody tr').formset({
               prefix: '{{ ingredients_formset.prefix }}',
               formCssClass: 'dynamic-ingredients'
           });
            $('#steps tbody tr').formset({
               prefix: '{{ steps_formset.prefix }}',
               formCssClass: 'dynamic-steps'
           });
       })
   </script>
</head>
<body>
<form action="{% url cookbook.views.createrecipe %}" method="POST" id="ingredients">
    {% csrf_token %}
<table>
    <tbody>
        <tr>
            <label>
                Ingredients:
            </label>
        </tr>

        <tr>
            <td>
                <input type="text" cols="40" rows="10" />
            </td>
        </tr>
    </tbody>
</table>
</form>
<form action="{% url cookbook.views.createrecipe %}" method="POST" id="steps">
    {% csrf_token %}
<table>
    <tbody>
        <label>
            Steps:
        </label>
        <tr>
            <td>
                <input type="text"  cols="40" rows="10" />
            </td>
        </tr>
    </tbody>
</table>
</form>
</body> 
```

这是forms.py

```
class RecipeForm(forms.ModelForm):
    reset_recipe = forms.CharField(widget=forms.HiddenInput(), required = False)
    class Meta:
        model = Recipe
        widgets = {'original_cookbook':forms.HiddenInput(),
                    'pub_date':forms.HiddenInput(),
                    'author':forms.HiddenInput()}

        fields =("name", "picture","ingredients","steps","prep_time","type",'reset_recipe')

class CookbookForm(forms.ModelForm):
    class Meta:
        model = Cookbook

class StepsForm(forms.Form):
    Step = forms.CharField()

StepsFormSet = formset_factory(RecipeForm, StepsForm, can_order=True, can_delete=True, extra = 0)

class IngredientsForm(forms.Form):
    Ingredient = forms.CharField()

IngredientsFormSet = formset_factory(RecipeForm, IngredientsForm, can_order=True, can_delete=True, extra = 0) 
```

和观点：

```
def createrecipe(request):
    RecipeForm = RecipeForm(request.POST)
    IngredientsFormSet = formset_factory(IngredientsForm)
    StepsFormSet = formset_factory(StepsForm)
    if request.method == 'POST':
        form = RecipeForm(request.POST)
        ingredients_formset = IngredientsFormSet(request.POST, request.FILES, prefix='ifs')
        steps_formset = StepsFormSet(request.POST, request.FILES, prefix='sfs')
        if form.is_valid() and ingredients_formset.is_valid() and steps_formset.is_valid():
            print "form is valid"
            new_recipe = form.save(commit=False)
            new_recipe.original_cookbook = request.user.cookbooks.all()[0]
            new_recipe.author = request.user.cookbooks.all()[0].name
            new_recipe.steps = steps_formset
            new_recipe.ingredients = ingredients_formset
            new_recipe.save()
            cookbooks = request.user.cookbooks.all()
            cookbook = cookbooks[0]
            cookbook.recipes.add(new_recipe)
            form.save_m2m()             
            t = loader.get_template('cookbook/create_form.html')
            c = RequestContext(request, {
            'form': new_recipe,
            })

            data = {
            'replace': True,
            'form': t.render(c),
            'success': True,
            }

            json = simplejson.dumps(data)
            return HttpResponse(json, mimetype='text/plain')
        else:
            print "form is invalid"
            form = RecipeForm(request.POST)
            ingredients_formset = IngredientsFormSet(request.POST, request.FILES, prefix='ifs')
            steps_formset = StepsFormSet(request.POST, request.FILES, prefix='sfs')
            t = loader.get_template('cookbook/create_form.html')
            c = RequestContext(request, {
                'form':form,
            })

            data ={
                'form': t.render(c),
                'success': False,
            }

            json = simplejson.dumps(data)
            return HttpResponse(json, mimetype='text/plain') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:17:54.683

You can use the amazing [django-dynamic-formset](https://code.google.com/p/django-dynamic-formset/) jQuery plugin by [ELO80KA](http://blog.stanisla.us/2009/10/10/jquery-plugin-django-dynamic-formset/)

I'm using it on a project right now, let me show you how I'm doing it right now, lets take a look of the markup:

```
<div id="id_p_i_c_formset_div">
{% for form in p_i_c_formset.forms %}
    <div class="p_i_c_child_formset row-fluid">
        {{ form.id }}
        <h2>year</h2>
        {{ form.year }}
        <h2>product_category</h2>
        {{ form.product_category }}
        <h2>insurance_company</h2>
        {{ form.insurance_company }}
        <h2>value</h2>
        {{ form.value|attr:"placeholder:insurance_claims" }}
        <h2>result</h2>
        {{ form.result }}
    </div>
{% endfor %}
{{ p_i_c_formset.management_form }}
</div> 
```

Then, in the javascript you need to do the correct selector (where the fields of your formset lives), this is where the plugin will grab the code to clone it with the proper ids and names, don't forget to pase it the "prefix" of the formset:

```
$(function(){
    $('form#my-personal-info #id_p_i_c_formset_div .p_i_c_child_formset').formset({
        prefix: '{{ p_i_c_formset.prefix }}'
    });
}); 
```

The plugin will automatically create remove and add button.

# ruby-on-rails - 如何使用 SendGrid 发送多封电子邮件？

> ID：12414506
> 
> 赞同：1
> 
> 时间：2012-09-13T20:44:46.173
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, sendgrid

如果有一个用户，以下代码似乎可以工作，但会为多个用户截断电子邮件：

```
users.each do |user|
  mail(
    :to => user.email,
    :subject => 'Hi',
    :template_name => 'notification'
  ).deliver 
```

这是发送几封电子邮件的正确方法吗？

*   Ruby on Rails 3.2.2
*   Heroku
*   发送网格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:51:22.553

I think this is what you're looking for:

```
def my_mailer_method
  users = User.find({ ... })

  headers['X-SMTPAPI'] = { :to => users.to_a }.to_json

  mail(
   :to => "this.will@be.ignored.com",
   :subject => "Hi",
   :template_name => "notification"
  ).deliver
end 
```

This sends a message to any number of recipients use the SendGrid's SMTP API. You can find further information on [the docs page](http://docs.sendgrid.com/documentation/api/smtp-api/developers-guide/).

You might also want to take a look at the [sendgrid rails gem](https://github.com/sendgrid/sendgrid-rails)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:55:12.067

向多个用户发送电子邮件：传递一个数组

代替

```
:to => user.email 
```

和

```
:to => users.map(&:email) 
```

更多 >[导轨](http://guides.rubyonrails.org/action_mailer_basics.html#sending-email-to-multiple-recipients)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T22:07:10.870

如果对彼此隐藏电子邮件地址并不重要，您可以在逗号分隔的字符串中指定收件人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-20T20:44:34.330

似乎问题在于Mailer的每个实例只能发送一封电子邮件。也许邮件对象超出范围并被垃圾收集器清理......

有效的解决方案是在 Mailer 之外迭代用户，并为每个用户调用一次。它可能很慢，但无论如何它应该在后台发生，所以没关系。

# ruby - 将哈希合并到哈希子类 - 确保嵌套哈希具有子类属性

> ID：12414507
> 
> 赞同：2
> 
> 时间：2012-09-13T20:44:51.117
> 
> 标签：ruby, inheritance, hash

我有一个哈希子类，我通常想从另一个哈希初始化它的数据并使用它：

```
class ValidatedJson < Hash
    @schema = {}
    def initialize(hash = {})
        super
        JSON::Validator.validate!(@schema, hash, :validate_schema => true)
        self.update(hash)
    end

    def [](key)
        self.fetch(key)
    end
end 
```

但是，单独使用 self.update 时，任何嵌套哈希都将是 Hash 类型，而不是具有我的子类 ValidatedJson 的属性。有人知道确保这一点的快速有效方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T02:58:54.527

我可能会效仿 ActiveSupport 的`HashWithIndifferentAccess`作用，即覆盖`update()`以及构造函数。

有关它们的实现，请参见[https://github.com/rails/rails/blob/master/activesupport/lib/active_support/hash_with_indifferent_access.rb 。](https://github.com/rails/rails/blob/master/activesupport/lib/active_support/hash_with_indifferent_access.rb)

# delphi - 如何强制 Delphi 7 加载整个可执行文件？

> ID：12414509
> 
> 赞同：4
> 
> 时间：2012-09-13T20:44:55.750
> 
> 标签：delphi, delphi-7

这几乎是[Delphi 2006 相同问题](https://stackoverflow.com/questions/6905395/getting-external-exception-c0000006-in-d2006-app-how-can-i-force-delphi-to-loa)的克隆，但我想要 Delphi 7 的解决方案。我也得到了外部异常 C0000006。是否可以让**Delphi 7**加载内存中的所有可执行文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T20:49:46.013

您需要将构建后的操作添加到您正在使用的任何构建自动化中。找到一个外部工具来修改可执行文件的 PE 标志并从构建脚本中调用它。显然，这必须在构建可执行文件之后发生。

我建议使用MS 工具链中的[editbin](http://msdn.microsoft.com/en-us/library/xd3shwhf)。您可以将其安装为 Windows SDK 的一部分。

推荐将如下所示：

```
editbin /SWAPRUN:NET|CD yourexefile.exe 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T10:50:29.477

Delphi 7 内置了对 SetPEFlags 指令的支持，并且常量（IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP 等）已经在 Windows.pas 中定义。

根据[JEDI 的帮助](http://wiki.delphi-jedi.org/wiki/JEDI_Help%3aCompilerCapabilities)，该指令是在 Delphi 6 中引入的。

# database-design - 指向各种表的 FK 列

> ID：12414510
> 
> 赞同：1
> 
> 时间：2012-09-13T20:44:57.477
> 
> 标签：database-design, foreign-keys, entity-attribute-value, class-table-inheritance

有人建议我在项目中使用此处描述的表格，虽然我不能说为什么，但我认为这不是一个好主意。

MyTable（MyTableId PK，类型 INT NOT NULL，MyForeignKey INT NOT NULL）

MyForeignKey 可以根据 Type 的值指向各种表中的数据。当然，我们不能使用这样的模型来强制执行 FK 完整性，但是这个论点是否足以不使用它？

我会给你一个可以使用它的例子。假设您在系统中有一个 Notes 表来保存有关各种对象的注释；关于用户、文档等的注释。通常，我会这样建模：

注释（NoteId PK、Text VARCHAR(4000)、UserId INT NULL、DocumentId INT NULL、...）

我同事的建议是换一张这样的桌子：

注释（NoteId PK、文本 VARCHAR(4000)、ObjectType、ObjectId）

在第二个实现中，ObjectType 会告诉我们 ObjectId 是指向 Users 表还是 Documents 表中的一行。它的优点是如果我们想添加另一种类型的对象，数据库结构和代码需要的修改较少。

每种解决方案的优缺点是什么？

注意：我们永远不会拥有无数的对象类型。它应该保持在 10 以下。

事实上，我们的现实生活场景要复杂一些。它与权限系统有关，在该系统中，用户可能有权或可能无法访问各种类型的对象（文档、注释、事件等）

所以现在在我的数据库模型中，我有这些对象的表和其他表来建立它们与用户之间的关系（UserDocuments、UserNotes、UserEvents 等）。权限是通过这些链接表中的属性设置的。

我的同事提议使用一个单一的权限表，而不是像这样

权限（PermissionId PK、UserId INT、ObjectType、ObjectId、...其他权限字段...）

这是一个好主意吗？

另外，我们可以称之为 EAV 或 Open Schema 吗？这与我在这些主题上阅读的内容并不完全相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T08:43:48.237

这是个坏主意。当您在同一列中混合多种类型的数据，并添加相邻的类型列以消除歧义时，您几乎总是会后悔后果。

如果您正确地执行连接，您的连接条件将更加复杂，并且您的连接运行速度会更慢。如果你不正确地连接，你会得到错误。忘记检查类型列是错误的常见来源。

最好将指向不同表的指针放在不同的列中。但可能会有一个非常不同的设计，效果会更好。

您的多种类型对象的集合似乎非常适合称为“类表层次结构”的设计技术。这种技术基本上对类和子类使用单独的表，并具有共享的主键。共享主键需要应用程序中的代码将主键从类表传播到子类表。但这是值得的。

不需要单独的类型列，因为类表和子类表之间的连接会自动清除属于不同类的行。它光滑、简单、快速。

如果您在 SO 中在这里寻找类表继承或子类的关系建模的示例，您将获得数十个信息丰富的问答。

* * *

编辑将“类表层次结构”更改为“类表继承”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:25:14.650

好吧，老实说，机器人解决方案是正确的，但目的不同。正如您提到的此类类型的数量，这通常是驱动决策的唯一因素。

我假设我们正在谈论 OLTP 系统。因此，如果类型的数量相对较少，并且您确定它不会改变（特别是不会增长），您应该为不同的类型选择具有单独列的解决方案。

如果类型的数量很大（我认为 10 已经是一个很大的数字），您应该选择具有类型和键列的解决方案。

一般来说，多列变体更好，因为您可以使用 DBMS 机制来保持数据完整性，但在选择类型/键列变体时，您必须自己开发这些机制（即触发器和过程）。有时最好选择类型/键列变体，因为开发和维护工作不如结构更改工作那么大 - 如果您在系统的生产使用过程中没有看到在表中添加或删除 FK 列的任何问题，您仍然可以选择多列变体（在这种情况下它只是一个存储成本）。

# ios - MediaCaptureViewController iOS Adob e Air 原生扩展

> ID：12414512
> 
> 赞同：1
> 
> 时间：2012-09-13T20:44:59.417
> 
> 标签：ios, air, air-native-extension

有没有办法使用 MediaCaptureViewController 为 iOS 编写本机扩展，以在 Air-App 内的 StageVideo 上播放 iPhone/iPad 上本地设备存储中的视频（预先录制或录制后）。原生 Air SDK 仅包含 browseForImage() 但不包含 browseForVideo() 那么这是否意味着它在技术上是不可能的，或者它只是尚未实现？是否有任何现有的本机扩展来解决此问题？

# ruby-on-rails - 使用 jquery 的 Rails 自动保存表单

> ID：12414516
> 
> 赞同：3
> 
> 时间：2012-09-13T20:45:17.733
> 
> 标签：ruby-on-rails, ruby, ajax, jquery

我正在开发用户可以创建博客文章并且博客文章每隔一段时间定期更新的应用程序。我找到了一个用于处理自动保存的[jQuery 自动保存插件](https://github.com/nervetattoo/jquery-autosave)，但我仍然遇到问题。

1.  当我使用 firebug 进行调试时，我只看到 GET 请求，因此页面不会更新，我不确定如何在 GET 请求之后调用 POST。

2.  它不会在我键入时或每 3 秒更新一次，但在我单击表单字段外部时会更新。无论如何要让它每3秒左右更新一次？

我的代码在下面列出

**应用程序.js**

```
 jQuery(function($) {
      $("#main-form").autosave({
        callbacks: {
          trigger: ["change", function() {
            var self = this;

            $("[name=save]").click(function() {
              self.save();
            });
          }],
          save: {
            method: "ajax",
            options: {
              success: function() {
                alert("saved!");
              }
            }
          }
        }
      });
    }); 
```

**post_controller.rb**

```
def update
  @post = Post.find(params[:id])

  respond_to do |format|
    if @post.update_attributes(params[:post])
      format.html { redirect_to semester_post_path, notice: 'post was successfully updated.' }
      format.json { head :ok }
    else
      format.html { render action: "edit" }
      format.json { render json: @post.errors, status: :unprocessable_entity }
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-01T22:31:15.047

我相信你已经继续前进，但只是为了缩小这篇文章的差距。OnChange 发生在字段失去焦点时，因此您所看到的似乎按设计正常运行。

这是使用[超时自动保存的问题/答案的链接 AJAX](https://stackoverflow.com/questions/14991046/autosaving-a-form-in-rails-with-ajax)。

**自动保存意见：**

在文档正式提交之前，我不确定你是否*真的想要启用自动保存，但我会发布我最喜欢的 2。*

1.  有些表单往往有很多用于后端存储的移动部件，并且在将一堆数据填充到表中之前应该是有意的。（恕我直言）

2.  在第一次“真正”提交之前让他们单独（不是自动保存）的另一个理由是，在他们点击提交之前，他们可能并不真正希望您在系统中拥有该信息。

您有多少次在网上开始填写表格，然后决定不想填写该信息？...从我实际上决定退出注册的网站获得传单、电子邮件或电话会让我感到沮丧！

# android - 从片段执行活动的公共方法

> ID：12414518
> 
> 赞同：0
> 
> 时间：2012-09-13T20:45:21.000
> 
> 标签：android, methods, android-fragments, android-activity

我有一个 Fragment，它应该`reset()`从调用它的 Fragment 中的 Activity 执行一个（公共）方法。

我发现，例如，这个页面： [Calling Activity methods from Fragment](https://stackoverflow.com/questions/9212574/calling-activity-methods-from-fragment) 其他方式没有问题：

```
Input_tap Input_tap = (Input_tap) getFragmentManager().findFragmentById(R.id.input);
Input_tap.reset(); 
```

有人知道如何以另一种方式做到这一点吗？并且：该方法是否必须是公开的——它是一个“无效”的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:47:20.647

可以`Fragment`调用`getActivity()`以检索托管它的活动。

如果只有一个可能的活动可以承载片段，只需将其`Activity`转换为适当的类（例如，`MyActivity`）并在其上调用方法：

```
((MyActivity)getActivity()).someMethod(); 
```

如果可能有多个活动可以托管片段，则最好通过`interface`在所有这些活动上实现一个公共来为您提供最佳服务，因此您可以将`getActivity()`' 的结果转换为该接口：

```
((MyInterface)getActivity()).someMethod(); 
```

# mysql - mysql 查询优化 - 按+索引排序

> ID：12414521
> 
> 赞同：1
> 
> 时间：2012-09-13T20:45:51.790
> 
> 标签：mysql, indexing, query-optimization

我正在尝试学习一些关于优化和索引的知识，因为我运行了一个需要 4 分钟才能完成的插入选择查询。现在，我添加了多个索引，它似乎使我的查询在 0.160 秒内运行。现在我想知道的是，当我在我的订单表中按 orderdate 订购时，为什么客户表会收到 using filesort 消息。查询和解释：

![在此处输入图像描述](../Images/2da97191241a40fac7d61d30bc037921.png)

我什至在 O(Orders) 中为（orderdate，orderid）和（orderdate，orderid，customerid）尝试了一个索引。我认为其中一个会有所帮助，但没有骰子。谁能帮我理解为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:06:46.090

使用“filesort”的查询没有错；这意味着无法根据索引对结果进行排序。

现在无法对索引执行排序的原因是在这种情况下，因为您`ORDER BY`包含来自连接队列中第一个表以外的表的列。

由于您的查询结果不包含很多行，因此正在使用的临时表可能在内存中。

当从该查询中获取查询结果时，发生的情况是结果被放入一个临时表中，以便以后可以对它们进行排序。

添加初始索引很可能会加快您的查询速度，因为 MySQL 正在执行全表扫描以获取最初的结果，这非常耗时。添加正确的索引后，查找记录非常快。它最初可能不得不对临时表进行文件排序，但这可能不会比现在慢或快。

如果您尝试移动 Orders 表的连接并将其放在 Products 表的连接之前，您可能能够消除临时表和文件排序的使用。

看看[使用文件排序是什么意思？](http://www.mysqlperformanceblog.com/2009/03/05/what-does-using-filesort-mean-in-mysql/)以及[MySQL 如何使用内部临时表](http://dev.mysql.com/doc/refman/5.5/en/internal-temporary-tables.html)以获取更多信息。

# parameters - Windows XP 计划任务参数

> ID：12414522
> 
> 赞同：0
> 
> 时间：2012-09-13T20:46:09.320
> 
> 标签：parameters, windows-xp, scheduled-tasks

我在网上搜索了这个问题的答案，但无济于事......我有一个通过 C++`ITask`接口创建计划任务的应用程序（[http://msdn.microsoft.com/en-us/library/windows/desktop /aa381311(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381311(v=vs.85).aspx) )。

它工作正常，但我最近添加了 SetParameters 函数来处理调度 perl 脚本运行的实例。例如，命令是：
`C:\Perl\bin\perl.exe C:\Compare.pl -I C:\input.txt`

我最初能够将其作为运行任务的一部分。但是，由于在命令上附加了一些额外的引号，它失败了。所以我会得到：
`"C:\Perl\bin\perl.exe C:\Compare.pl -I C:\input.txt"`

在计划任务属性的运行部分。由于这些服务器有很多，手动删除它是不可能的。

这可以通过创建一个批处理脚本并安排它来轻松解决（我们目前正在这样做）。但是，我想正确地修复它。因此，我使用了 SetParameters 命令。

我的问题：Windows XP/Server 2003 是否支持 SetParameters？如果是这样，我如何验证它们是否已设置？我查看了计划任务属性部分，甚至尝试过`schtasks /Query /FO LIST /V`，但仍然看不到参数。我得到的只是运行属性的任务`C:\Perl\bin\perl.exe` ，注意我知道对 Windows server 2008 和 Windows 7 的支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T19:11:51.973

原来这是我的应用程序中的一个错误。我可以确认在 Windows XP 中可以查看参数。它们显示如下：

C:\Perl\bin\perl.exe C:\Compare.pl -IC:\input.txt

查看属性时在任务文本框中。

# java - 在eclipse中创建一个exc jar文件？

> ID：12414524
> 
> 赞同：1
> 
> 时间：2012-09-13T20:46:18.543
> 
> 标签：java, class, export, executable-jar

所以我创建了一个 jar 文件，点击导出等

但是当我双击它没有做任何事情

我没有在文件夹中看到我的课程

我看到的只是junit org.hamcrest.core_1.1.0.v2009050107100…</p>

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:48:07.913

如果您的 jar 是有效的可执行文件

那么这应该工作

```
java -jar your.jar 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T22:38:15.890

Jar 文件并不总是通过双击运行。

为了运行 jar 文件，请`java -jar yourjarfile.jar`在与 jar 文件相同的目录中运行命令。这假定您的 PATH 系统变量设置正确。

如果您收到诸如“无法从 yourjarfile.jar 加载主类清单属性”之类的错误，则表示您的 jar 文件中没有定义主类，并且 java 解释器不知道从哪里开始。

您可以通过导出为“可运行 JAR 文件”并确保选择用于运行程序的启动配置来确保在 Eclipse 中指定了主类。

为了列出 jar 文件的内容，请在与 jar 文件`jar tvf yourjarfile.jar`相同的目录中运行该命令。

为了提取 jar 文件的内容，请在与 jar 文件`jar xvf yourjarfile.jar`相同的目录中运行命令。

# javascript - 如何在 IE8 中去除 iframe 的边框

> ID：12414525
> 
> 赞同：18
> 
> 时间：2012-09-13T20:46:21.197
> 
> 标签：javascript, jquery, css, iframe, internet-explorer-8

我正在创建一个内部带有 iframe 的对话框，问题是边框一直显示在 IE8 中，这在任何其他浏览器中都可以正常工作。

这是我尝试过的，我也尝试过border:none

```
$(d.dialog).find('#MyCoolDialogInner').html('<iframe src="/apex/EscalationForm?id={!Case.Id}" height="495" width="380" marginheight="0" marginwidth="0" frameborder="0"/>'); 
```

提前致谢

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-13T20:50:19.690

添加 frameBorder 属性（注意大写的“B”）。

所以它看起来像：

```
<iframe frameBorder="0">Browser not compatible.</iframe> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T20:48:33.893

您是否尝试过通过 CSS 设置它？

```
iframe {
    border:0px none transparent !important;
} 
```

此外，这些似乎也有效 - `marginheight="0" marginwidth="0" frameborder="0"`。取自[同一 IE 问题的这篇文章](https://stackoverflow.com/a/2781026/448232)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T20:48:42.840

尝试这个：

```
<iframe frameborder="no" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-13T23:43:16.437

我意识到 IE8 对 iFRAMES 来说是个麻烦事。“Frameborder”在 HTML5 中已被弃用，因此虽然它是 IE8 最简单的选择，但这不是一个长期的解决方案。

通过将 iFRAME 放置在容器内，我成功地隐藏了边框和滚动条。iFRAME 容器本身放置在一个 div 内，用于在网页上进行整体定位。iFRAME 本身是绝对定位的，并且负边距应用于顶部和左侧，以隐藏顶部和左侧边框。绝对定位的 iFRAME 的宽度和高度应编码为 100% 以上，因此它超过了父尺寸，以至于右侧和底部边框不可见（滚动条也不可见）。此技术还使 iFrame 具有响应性，因为 iFRAME 容器使用百分比以及包含容器的 div。当然 iFRAME 父 div 必须设置为溢出：隐藏。

这是一个示例代码：

```
 /*THE PARENT DIV FOR THE iFRAME CONTAINER*/
    .calcontainer
        {
        width:100%;  /*adjust iFrame shrinking here - if floating use percentage until no white space around image.*/   
        max-width:200px;     
        margin:auto;     
        }

    /*THE RELATIVE POSITIONED CONTAINER FOR THE iFRAME*/

    .calinside  /*container for iFRAME - contents will size huge if the container is not contained and sized*/
        {   
        position:relative; /*causes this to be the parent for the absolute iFRAME*/
        padding-bottom: 100%; /* This is the aspect ratio width to height ratio*/
        height: 0;
        overflow:hidden; /*hides the parts of the iFRAME that overflow due to negative margins and over 100% sizing*/     
        }

/*THE ABSOLUTE POSITIONED iFRAME contents WITH NEGATIVE MARGINS AND OVER 100% SIZE IS CODED HERE.  SEE THE NORMAL SETTINGS VERSUS THE IE8 SETTINGS AS MARKED.  A SEPARATE CSS FILE IS NEEDED FOR IE8 WITH A CONDITIONAL STATEMENT IN THE HEAD OF YOUR HTML DOCUMENT/WEB PAGE*/

    .calinside iframe
        {
        position: absolute;
        top: 0;
        left: 0;
        width: 100% !important;/*must expand to hide white space to the right and below.  Hidden overflow by parent above*/
        height: 103% !important; /*must expand to hide white space to the right and below.  Hidden overflow by parent above*/
        /*IE8*/top: -2%;
        /*IE8*/left: -2%;   
        /*IE8*/width: 114% !important;/*For IE8 hides right border and scroll bar area that is white*/  
        /*IE8*/height: 105% !important; /*hide white space and border below.  Hidden overflow by parent above*/          
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-12T21:30:00.543

`frameborder`可以是`1`or `0`，不确定 "no" 是否有效。[Coda](https://panic.com/coda/ "结尾")在编码时提供了有效的值选项，当我对 iframe 执行此操作时，只有 1 和 0 可用。

# java - 无法加载 EJB 模块

> ID：12414526
> 
> 赞同：9
> 
> 时间：2012-09-13T20:46:26.510
> 
> 标签：java, glassfish

我正在学习企业应用程序开发课程。我是 JSF 的新手。我正在尝试使用 JSF 和 Netbeans IDE 使用 Glassfish 3.1 部署我的应用程序。

我得到的错误如下所示。

`Error occurred during deployment: Exception while preparing the app : Unable to load the EJB module. DeploymentContext does not contain any EJB. Check the archive to ensure correct packaging for F:\Seagate\docs backup\NetBeansProjects\ent-app-dev\Slamka_Project1\build\web. If you use EJB component annotations to define the EJB, and an ejb or web deployment descriptor is also used, please make sure that the deployment descriptor references a Java EE 5 or higher version schema, and that the metadata-complete attribute is not set to true, so the component annotations can be processed as expected. Please see server.log for more details.`

以下是我对 EJB 的引用。

```
import javax.ejb.LocalBean;
import javax.ejb.Stateless;
import javax.ejb.EJB;
@EJB 
```

任何帮助，将不胜感激。

编辑：这是一个 Java Web 应用程序。

**编辑** 战争文件结构树

*   元信息/清单.MF
*   WEB-INF/类
*   WEB-INF/lib/primefaces-2.1.1.jar
*   WEB-INF/web.xml
*   索引.shtml

我的文件在 xhtml 文档中没有 EJB 标记。它有下面列出的内容。

`<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:c="http://java.sun.com/jsf/core">`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T21:45:30.457

*将web.xml* `web-app`属性版本更改为`2.5`或更高版本可解决此问题。

*更新的web.xml*的 web-app 元素将是，

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.5"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:55:07.450

所以你有 web 应用程序，它不是 ejb-jar，它是打包成`*.war`归档的 web 模块。
结构应该是

*   *.war/META-INF/persistence.xml
*   *.war/META-INF/MANIFEST.MF
*   *.war/WEB-INF/sun-web.xml
*   *.war/WEB-INF/web.xml
*   *.war/WEB-INF/classes/ - 包中编译的类
*   *.war/WEB-INF/lib/ - 库
*   *.war/index.jsp - 主页

的例子`sun-web.xml`

```
<!DOCTYPE sun-web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Application Server 9.0 Servlet 2.5//EN" "http://www.sun.com/software/appserver/dtds/sun-web-app_2_5-0.dtd">
<sun-web-app>
  <context-root>/app</context-root>
</sun-web-app> 
```

如果你正在使用`Maven`，你可以使用`maven-war-plugin`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T22:40:54.030

原来问题是 SQL 语句中的拼写错误（1 和 l [小写 L]），我需要对项目进行“清理和构建”。感谢那些努力帮助我解决问题的人。

# jquery - 与表格一起使用的 Jquery UI 可排序

> ID：12414528
> 
> 赞同：0
> 
> 时间：2012-09-13T20:46:31.940
> 
> 标签：jquery, html, jquery-ui

我想问是否可以将可排序连接到表格元素。下面是结构。我读到元素不起作用，我的测试没有成功：

```
<table id="photoPreviews"><tr>
 <td>... other elements here</td>
 <td>... other elements here</td>
 <td>... other elements here</td>
 <td>... other elements here</td></tr><tr>
 <td>... other elements here</td>
 <td>... other elements here</td>
 <td>... other elements here</td>
 <td>... other elements here</td>
</tr></table> 
```

视觉上看起来像这样：

![在此处输入图像描述](../Images/a63b190e18a4c7774f1c6292c8ae7d49.png)

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:53:41.187

一个 html`<table>`真的应该只用于表格数据......除非一切都失败了。

在这种情况下，您最好使用`<ul>`. 就像是：

```
<ul id='photoPreviews'>
<li>Other elements go here. . .</li>
<li>Other elements go here. . .</li>
<li>Other elements go here. . .</li>
<li>Other elements go here. . .</li>
</ul> 
```

之后，只需按照[jquery 可排序](http://jqueryui.com/demos/sortable/)文档了解高级功能。

祝你好运！

# asp.net - 更改用户名 ASP.net MVC 3 成员资格

> ID：12414531
> 
> 赞同：5
> 
> 时间：2012-09-13T20:47:06.760
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-membership

我正在运行一个 ASP.net MVC 3 Web 应用程序，并使用 Membership Provider。我想知道是否可以允许用户（或管理员）更改现有帐户的用户名？我还没有找到一种方法来做到这一点。用户名不是电子邮件地址，而是在我尝试分配新名称之前验证其唯一性。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T22:02:59.787

会员提供者不提供更新用户名的方法。您将需要扩展成员资格提供程序 UpdateUser 方法或直接与成员资格表交互以允许此更改。无论您如何处理，请记住几项

1.  更新时，您需要检查用户名的唯一性，就像创建用户时发生的情况一样。

2.  如果用户已登录并更改其用户名，您将需要强制他们注销并重新登录或重新发出 AuthenticationTicket cookie。原因是，如果他们更改用户名，则 authTicket cookie 存储的用户名和实际用户名不再匹配。如果您使用`HttpContext.Identity.User.Name`查询数据存储或检查内容授权，您将不再返回任何结果，因为该用户名不再存在。

# shell - Echo：参数列表太长

> ID：12414532
> 
> 赞同：0
> 
> 时间：2012-09-13T20:47:16.623
> 
> 标签：shell, arguments, echo, ksh

我遇到了一个问题，我的 echo 参数列表太长，想要一些关于如何解决这个问题的想法，或者至少测试条件以便我可以正确处理它，它不会杀死我脚本

```
for file in `cat filelist`; do 
    PROTOCOLS1=`egrep -i 'rsh|rsync|remsh' "$file" | egrep -v '^[ |      ]*#'`
    FIELDS=`echo $PROTOCOLS1|wc -l`
    if [[ $FIELDS -gt 1024 ]]; then
        echo $file >> $debuglog
    else
        set -A myarray $PROTOCOLS1
        do stuff.....
    fi
done 
```

所以问题是，当我的 echo 参数列表太长时，`$FIELDS`设置为 null，因此我的测试`$FIELDS -gt 1024`总是为真并且不会被捕获。问题是当它进入数组时，它显然太大了，我得到一个下标超出范围的错误，我的脚本退出了。

任何想法都非常感谢。

* * *

编辑 9/18

好的，所以问题有点基本。

```
myserver-v1> echo $variable
myserver-v1> /usr/bin/echo: too many args 
```

我想在我的脚本中对此进行测试

我尝试了以下方法，它有效，但我把所有这些废话都送到了标准输出，它填满了我的调试日志并且很烦人

```
echo $variable
if [[ $? -ne 0 ]]; then
write to error log
fi 
```

有没有办法测试 echo $variable....而不将其发送到标准输出？我尝试了以下方法，但似乎都不起作用，所以我在这里有点不知所措。

```
[[ ! `echo $variable ]]
[[ `echo $variable ]] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:52:36.983

如果您在 中保留未引用的变量`$PROTOCOLS1`，则`echo`可以通过替换来简化生活：

```
FIELDS=`echo $PROTOCOLS1|wc -l` 
```

和

```
FIELDS=1 
```

这是因为当您在`$PROTOCOLS1`没有任何引号的情况下回显时，您将只有一行（可能很长）输出。或者，您可以使用：

```
FIELDS=$(echo "$PROTOCOLS1" | wc -l) 
```

其中双引号将保留 PROTOCOLS1 值中的换行符（但它会让你回到“参数列表太长”的问题）。

因此，您需要考虑使用：

```
FIELDS=$(egrep -i 'rsh|rsync|remsh' "$file" | egrep -c -v '^[ |      ]*#') 
```

这可以让第二个`egrep`为您进行行数计数。显然，由于脚本的后面部分使用`$PROTOCOLS1`，您将需要重新评估`egreps`以获取数据，但您应该考虑您的处理方案是否合适。如果遇到过长的字符串值，则可能没有以最佳方式进行处理。替代方案是什么取决于您要做什么，而问题并未揭示这一点。使用 Perl、Python 或 Ruby 等脚本语言进行额外处理可能是合适的。

# api - 使用单个 POST 请求进行更新以创建两个对象 糟糕的 API 设计？

> ID：12414538
> 
> 赞同：1
> 
> 时间：2012-09-13T20:47:25.587
> 
> 标签：api, rest, asp.net-web-api

考虑这样的场景，一个未知的未经身份验证的用户正在查看 nerddinners 列表，然后去参加特定的晚餐，输入他的姓名和电子邮件并单击“参加”。这应该导致两件事。创建用户并为该用户创建 DinnerAttendRequest。用户还有一个名为 FavProgLanguage 的属性，该属性设置为他想参加的晚餐的 prog 语言属性。

假设它是一个与 API 对话的单页 javascript 应用程序，我想到了两种方法。

1) 在客户端上，设置用户 FavProgLanguage，然后使用名称、电子邮件和 favproglanguage POST 到 /user 以创建用户。使用创建的 UserId 和 POST 到 /DinnerAttendRequest 以及 DinnerId 和 UserId 来创建 DinnerAttendRequest。

2) 使用名称、电子邮件和晚餐ID POST 到/somename，然后在服务器上使用晚餐ID 来填充用户的favproglanguage。创建用户，然后使用用户 ID 创建 DinnerAttendRequest

第一种方法看起来更自然/RESTful，但是如果计算 favprog 语言的逻辑有点复杂，所有 api 使用者都必须实现该逻辑，而第二种方法代码只在服务器上编写一次。

哪种方法更好？第二种方法是 RESTful 的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T08:06:06.747

您的第一个设计会将逻辑、工作流程和偏好语言决策的负担放在客户端上，这将使处理用户创建和预订成为一个单一事务变得困难，并且客户端应用程序需要编排一些事情。您最喜欢的语言逻辑听起来像是一个重要的业务规则，理想情况下应该再次位于服务器上以供重用......

你为什么不看看有一些像这样的资源：

1.  晚餐例如{“姓名”、“日期”等}
2.  预订例如 { "user" { NESTED USER RESOURCE }, "bookingStatus" 等 }
3.  用户 eg { "email", "name", "fav lang", etc.}

一些示例网址

1.  /晚餐/{uid}
2.  /dinners/{uid}/bookings
3.  /users/{uid}

基本上我会将包含嵌套用户资源的预订资源发布到晚餐预订网址并运行用于检查用户是否存在的逻辑，如果需要创建并在事务中更新他们的最爱语言。

因此，要创建预订，我会发布预订资源：

```
{
    "user": {
        "email": "john@doe.com",
        "name": "name"
    },
    "bookingStatus": "requested"
} 
```

到 /dinners/{uid}/bookings

并期待一个 201 创建的响应，响应如下：

```
{
    "uid": "4564654",
    "user": {
        "uid": "1234564",
        "email": "john@doe.com",
        "name": "name",
        "favLang": "C#"
    },
    "bookingStatus": "booked"
} 
```

显然，这些属性在很大程度上只是举例，但希望这能展示一些概念，并表明单个 POST 可以被认为是 RESTful ......

# actionscript-3 - AS3 将 mc 的 startdrag 约束到一个矩形，两个注册点都在中心

> ID：12414541
> 
> 赞同：1
> 
> 时间：2012-09-13T20:47:45.063
> 
> 标签：actionscript-3

想不出来这个。如何将注册点在中心的 mc 的拖动约束到注册点也在中心的较大剪辑？下面的代码拖动名为 img 的剪辑，但不限制为“rect”剪辑。

```
var bounds:Rectangle = new Rectangle(rect.width/2-img.width/2, rect.height/2-img.height/2, rect.width-img.width, rect.height-img.height);

img.addEventListener(MouseEvent.MOUSE_DOWN, drag);
img.addEventListener(MouseEvent.MOUSE_UP, drop);

function drag(event:MouseEvent) {
    img.startDrag(false, bounds);
}
function drop(event:MouseEvent) {
    img.stopDrag();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:30:29.793

如果`rect`是您希望对象 ( `img`) 留在其中的矩形，并且它们都锚定在中心，那么这就是您需要的：

```
var bounds:Rectangle = new Rectangle();
bounds.x = rect.x + (img.width * .5) - (rect.width * .5);  //offset by + half of the image, and - half of the rectangle
bounds.y = rect.y + (img.height * .5) - (rect.height * .5);
bounds.width = rect.width - img.width; //make the bounds the size of the rectangle, minus the size of the image
bounds.height = rect.height - img.height; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:18:26.527

注册点与拖动边界框无关。

例如

```
new Rectangle(0,0,100,100) 
```

仅允许 MovieCLip 仅从舞台左上角的 0,0 移动到 100,100。

[编辑]

```
boundingBox.graphics.moveTo(0,0);
boundingBox.graphics.beginFill(0);
boundingBox.graphics.lineTo(400,0);
boundingBox.graphics.lineTo(400,400);
boundingBox.graphics.lineTo(0,400);
boundingBox.graphics.lineTo(0,0);
boundingBox.graphics.endFill();
boundingBox.x = 100;
boundingBox.y = 100;

dragTarget.graphics.moveTo(0,0);
dragTarget.graphics.beginFill(0xff0000);
dragTarget.graphics.drawRect(0,0,10,10);
dragTarget.graphics.endFill();
dragTarget.x = 150;
dragTarget.y = 150;

container.addChild(boundingBox) 
container.addChild(dragTarget) 
this.addChild(container)

dragTarget.addEventListener(MouseEvent.MOUSE_DOWN,onDown)

var boundingBox:Sprite = new Sprite();
var dragTarget:Sprite = new Sprite();
var container:Sprite = new Sprite()
function onDown(event:Event):void{
  var bounds:Rectangle = new Rectangle(boundingBox.x,
                 boundingBox.y,
                 boundingBox.width-dragTarget.width,
                 boundingBox.height-dragTarget.height)
  dragTarget.startDrag( false,bounds )
} 
```

# graphviz - 如何使用点写图形名称

> ID：12414544
> 
> 赞同：0
> 
> 时间：2012-09-13T20:48:01.567
> 
> 标签：graphviz, dot

我想问的是我们可以使用**dot**绘制图形，但是是否可以为该图形**命名**，并且该名称**位于该图形下方**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T09:26:03.610

如果您的问题是关于 graphviz，以下是如何在图表下方添加标签：

```
digraph {
    1 -> 2;
    labelloc="b";
    label="Graph label";
} 
```

![图形输出](../Images/7e6b092c422c005057f67e93f2fe9fa4.png)

# c# - AddOrUpdate-ing 时锁定 ConcurrentDictionary？

> ID：12414546
> 
> 赞同：6
> 
> 时间：2012-09-13T20:48:12.290
> 
> 标签：c#, .net, thread-safety, concurrentdictionary

我使用 a`ConcurrentDictioanry<string, HashSet<string>>`跨多个线程访问一些数据。

我在[这篇文章](http://msdn.microsoft.com/en-us/library/dd997369)（向下滚动）中读到该方法`AddOrUpdate`不是在锁中执行的，因此它可能会危及线程安全。

我的代码如下：

```
//keys and bar are not the concern here
ConcurrentDictioanry<string, HashSet<string>> foo = new ...;
foreach(var key in keys) {
    foo.AddOrUpdate(key, new HashSet<string> { bar }, (key, val) => {
        val.Add(bar);
        return val;
    });
} 
```

我是否应该将`AddOrUpdate`调用附在`lock`语句中以确保一切都是线程安全的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T20:54:16.407

单独锁定 during`AddOrUpdate`无济于事 -*每次从 set 中读取时，您*仍然需要锁定。

如果您打算将此集合视为线程安全的，那么您确实需要这些值也是线程安全的。`ConcurrentSet`理想情况下，您需要一个。现在框架中不存在它（除非我错过了一些东西），但您可能可以创建自己的`ConcurrentSet<T>`，使用 a `ConcurrentDictionary<T, int>`（或任何`TValue`您喜欢的）作为其底层数据结构。基本上，您会忽略字典中的值，而只是将键的存在视为重要部分。

您不需要在其中实现所有内容`ISet<T>`- 只需您实际需要的部分。

然后，您将在应用程序代码中创建一个`ConcurrentDictionary<string, ConcurrentSet<string>>`，然后您就离开了 - 无需锁定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T21:15:43.090

您需要修复此代码，它会产生大量垃圾。即使不需要，您也可以创建一个新的 HashSet。使用另一个重载，即接受*valueFactory*委托的重载。所以 HashSet 仅在字典中不存在*键时创建。*

如果多个线程同时尝试添加相同的*key*值并且它不存在，则*valueFactory*可能会被多次调用。几率非常低，但不是零。只会使用其中一个哈希集。没问题，创建 HashSet 没有可能导致线程问题的副作用，额外的副本只会被垃圾收集。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:00:41.073

文章指出，添加委托不是在字典的锁中执行的，并且您获得的元素可能不是添加委托在该线程中创建的元素。这不是线程安全问题；字典的状态将是一致的，所有调用者将获得相同的实例，即使为每个调用者创建了不同的实例（并且除一个之外的所有调用者都被删除）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-06T13:44:44.520

似乎更好的答案是使用 Lazy，根据[这篇](https://andrewlock.net/making-getoradd-on-concurrentdictionary-thread-safe-using-lazy/)关于传递委托的方法的文章。

还有一篇关于延迟加载添加委托的好[文章](https://blogs.endjin.com/2015/10/using-lazy-and-concurrentdictionary-to-ensure-a-thread-safe-run-once-lazy-loaded-collection/)。*

# php - 获取具有某些元素的实体

> ID：12414548
> 
> 赞同：1
> 
> 时间：2012-09-13T20:48:16.983
> 
> 标签：php, symfony, doctrine, symfony-2.1

我有一个 Book 实体，它与 Page 实体有 One2Many 关系。我想创建一个查询来检索所有至少有一页的书。我做了：

```
 $qb = $this->getDoctrine()
        ->getRepository('AcmeDemoBundle:Book')
        ->createQueryBuilder('b');          
        ->leftJoin('b.pages','p')
        ->having($qb->expr()->gt($qb->expr()->count('p'), 0));

       $books = $qb
        ->getQuery()
        ->getResult(); 
```

问题是，虽然有很多书有页面，但这个查询只返回一本书。

创建的查询是：

```
SELECT b FROM Acme\DemoBundle\Entity\Book b LEFT JOIN b.pages p HAVING COUNT(p) > 0 
```

这对我来说看起来不错。知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T10:32:56.567

使用起来更简单

```
->innerJoin('b.pages','p') 
```

代替

```
->leftJoin('b.pages','p') 
```

你不需要聚合函数。简而言之：这个内部连接将只返回可以与至少一个页面连接的书籍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T22:56:09.607

You should add `groupBy` as you are using aggregate function. e.g.

```
 $qb = $this->getDoctrine()
    ->getRepository('AcmeDemoBundle:Book')
    ->createQueryBuilder('b');          
    ->leftJoin('b.pages','p')
    ->groupBy('b.id')
    ->having($qb->expr()->gt($qb->expr()->count('p'), 0)); 
```

# c - wxDev-C++ 的 64 位编译器

> ID：12414549
> 
> 赞同：0
> 
> 时间：2012-09-13T20:48:22.410
> 
> 标签：c, compiler-construction, ide

我正在使用“wxDev-C++”在我的 Windows 7、64 位机器上创建一个 DLL。但是，创建的 DLL 似乎是 32 位平台格式。

我认为这是因为包含的编译器是一个 MingW 32 位编译器。

问题：

1.  如何让我的 IDE 使用 64 位平台来构建我的 DLL？
2.  我在哪里可以获得 64 位编译器 64 位 windows 7 机器（Visual Studio 编译器除外）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:56:44.097

只需切换到 MingW 64 位。

[在这里得到它！](http://mingw-w64.sourceforge.net/)

# sql - TSQL：按日期降序返回客户？

> ID：12414552
> 
> 赞同：3
> 
> 时间：2012-09-13T20:48:32.020
> 
> 标签：sql, tsql

每次我的用户查找客户时，我都会存储客户 ID、名称和时间戳（时间戳 = 用户执行查找的时间）。

有点像：

```
ID  Name      Timestamp
1   CompanyA  2012-10-01 10:00
2   ComapnyB  2012-10-01 10:11
3   CompanyA  2012-10-01 10:22
4   CompanyA  2012-10-01 10:25
4   CompanyC  2012-10-01 10:32 
```

我的问题是...

我想返回按日期降序排序的 TOP 30 不同客户 - 我该怎么做？

我想返回这个：

```
CompanyC
CompanyA
CompanyB 
```

...只有一个按日期降序排序的实例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T20:50:57.037

```
SELECT TOP 30 Name
FROM Customer
GROUP BY Name
ORDER BY MAX(Timestamp) DESC 
```

# git - 设置 Gitolite 时出错：不接受 SSH 密钥

> ID：12414555
> 
> 赞同：2
> 
> 时间：2012-09-13T20:48:35.563
> 
> 标签：git, ssh, gitolite

我正在尝试在 linux 服务器上设置 gitolite。当我运行命令时：

```
gitolite setup -pk id_rsa.pub 
```

我收到以下错误：致命：'id_rsa.pub'不是可读文件

我真的不明白可能出了什么问题......我使用 puttygen 生成了 openssh 格式的密钥。我还尝试使用 sshgen -t rsa 通过 Git Bash 终端生成密钥，但我得到了同样的错误。在绝望的行为中，我直接在我的 linux 服务器上运行 sshgen 并且我得到了同样的错误，所以我认为它不再是 windows/linux/putty 的东西了......

我正在运行 Fedora 17。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:03:28.090

生成密钥应该意味着通常将`$HOME/.ssh/id_rsa(.pub)`.

在这种情况下，[安装 gitolite V3](http://sitaramc.github.com/gitolite/qi.html)时，我更喜欢指定公钥的**完整路径。**

```
GITOLITE_HTTP_HOME= gitolite setup -pk "$HOME/.ssh/gitoliteadm.pub" 
```

我在调用设置之前清除了`$GITOLITE_HTTP_HOME`，以确保脚本不会将该 gitolite 命令与从 web 执行的命令混淆。[您可以在我的项目中看到 gitolite 安装脚本](https://github.com/VonC/compileEverything/blob/master/gitolite/install_or_update_gitolite.sh#L18-L23)
的示例。

# c++ - pthread 上的段错误

> ID：12414561
> 
> 赞同：2
> 
> 时间：2012-09-13T20:48:43.330
> 
> 标签：c++, pthreads, segmentation-fault

我正在学习pthread，以下是我的简单代码：

```
 1 #include <pthread.h>
  2 #include <cstdlib>
  3 #include <iostream>
  4 #include <string>
  5 #include <sstream>
  6
  7 using namespace std;
  8
  9 struct ThreadParam
 10 {
 11     int thread_id;
 12     string message;
 13 };
 14
 15 string int2string(int i)
 16 {
 17     stringstream s;
 18     s << i;
 19     return s.str();
 20 }
 21
 22 void * Hello(void * param)
 23 {
 24     ThreadParam * threadParam = (ThreadParam*)param;
 25
 26     int tid = threadParam->thread_id;
 27     string msg = threadParam->message;
 28     string output = msg + " In thread " + int2string(tid);
 29
 30     cout << output << endl;
 31     pthread_exit(NULL);
 32 }
 33
 34 int main()
 35 {
 36     const int count = 30;
 37     ThreadParam params[count];
 38
 39     pthread_t threads[count];
 40     int rc;
 41     for(int t=0; t < count; t++)
 42     {
 43         cout << "In main: creating thread " << t << endl;
 44
 45         params[t].thread_id = t;
 46         params[t].message = "Hello " + int2string(t) + "!";
 47
 48         rc = pthread_create(&threads[t], NULL, Hello, (void*)&params[t]);
 49
 50         if(rc)
 51         {
 52             cout << "Error! Return code is " << rc << endl << flush;
 53             exit(-1);
 54         }
 55     }
 56     pthread_exit(NULL);
 57 } 
```

创建最后一个线程后出现分段错误。输出是：

```
In main: creating thread 0
In main: creating thread 1
In main: creating thread 2
In main: creating thread 3
In main: creating thread 4
In main: creating thread 5
In main: creating thread 6
In main: creating thread 7
In main: creating thread 8
In main: creating thread 9
In main: creating thread 10
In main: creating thread 11
Hello 0! In thread 0
Hello 1! In thread 1
Hello 2! In thread 2
Hello 3! In thread 3
Hello 4! In thread 4
In main: creating thread 12
In main: creating thread 13
In main: creating thread 14
In main: creating thread 15
In main: creating thread 16
In main: creating thread 17
In main: creating thread 18
In main: creating thread 19
In main: creating thread 20
In main: creating thread 21
In main: creating thread 22
In main: creating thread 23
In main: creating thread 24
In main: creating thread 25
In main: creating thread 26
In main: creating thread 27
In main: creating thread 28
In main: creating thread 29
Segmentation fault 
```

我不知道为什么，有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:58:15.907

查看您的代码，我可以告诉您，在创建最后一个线程后，您会破坏主线程（“创建者”线程）。这导致该线程的堆栈被释放。但是因为您使用指向主线程堆栈内存的指针（`ThreadParam params[count];`准确地说；您将指向它的指针传递给`pthread_create`函数）然后您尝试读取其他线程中的无效数据。在主线程销毁后，为主线程堆栈分配的内存页面被标记为“未使用”或“未分配”，因此您在尝试访问它们时会遇到段错误。

UPD：正如其他人所说，您应该使用`pthread_join`函数等待所有线程完成然后销毁主线程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T20:52:54.203

在退出程序之前，您必须等待线程完成。如果你不这样做——可能会发生很多坏事。要加入线程，请使用[`pthread_join()`](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_join.3.html). 您还可能在 API 文档中遇到“分离”线程——不要费心尝试使用它，它不起作用，至少在 Linux 中不起作用。

除此之外——调试器是最好的人选来告诉你的进程为什么会出现段错误，可能有很多原因，猜测在这方面没有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T20:55:20.510

您的主线程应该等到您的辅助线程完成执行。这导致了段错误。

主线程应该加入其他线程。

# javascript - 将 jQuery ajax 值传递回调用 JavaScript 函数

> ID：12414562
> 
> 赞同：1
> 
> 时间：2012-09-13T20:49:00.020
> 
> 标签：javascript, jquery, ajax

我在将数据从 JQuery ajax 调用传回调用位置时遇到问题。有问题的代码如下：

```
jQuery("#button").click(function()
{   
    for(var i = 0;i < data.length; i++)
    {
        result = updateUser(data[i]); //result is not populated..
                    alert(result); //prints 'undefined'

    }
});

function updateUser(user_id)
{       
    jQuery.ajax({
        url:"/users/update/"+user_id,
        type:"GET",
        async: false,
        success: (function(data){           
            //if I alert "data" here it shows up correctly
                            //but if i try to return it like below 
                            //it does not get passed correctly 
                            return data; 
        })
    }); 
```

非常感谢任何指针

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T20:52:37.533

您不能像这样从 AJAX 成功处理程序返回值。AJAX 是异步的，因此执行将继续执行`result`is的下一行`undefined`。从异步操作中取回数据的唯一方法是使用回调。回调是在异步操作完成它正在执行的操作时调用的函数：

```
jQuery("#button").click(function () {
    for (var i = 0; i < data.length; i++) {
        updateUser(data[i], function(result) {
            alert(result);
        });
    }
});

function updateUser(user_id, callback) {
    jQuery.ajax({
        url: "/users/update/" + user_id,
        type: "GET",
        success: callback
    });
} 
```

在这里，您在 AJAX 调用的成功处理程序中调用回调，因此现在您可以访问 AJAX 调用返回的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:51:14.113

ajax 中的 A 是异步的，这意味着当文件加载时，启动它的函数运行完成。尝试使用 jQuery Deferred：[http ://api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

例子：

```
jQuery("#button").click(function()
{   
    for(var i = 0;i < data.length; i++)
    {
        updateUser(data[i]).done(function(result) {
                    alert(result); //prints 'undefined'
        });

    }
});

function updateUser(user_id)
{
    return jQuery.ajax({
        url:"/users/update/"+user_id,
        type:"GET",
        async: false,
        success: (function(data){           
            ...
        })
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T20:53:17.147

让你的函数`return`得到调用的结果`jQuery.ajax()`——这个对象实现了 jQuery 延迟`promise`接口。也就是说，一个承诺在*一段时间后*返回结果的对象。

```
function updateUser(user_id) {       
    return jQuery.ajax({...});
} 
```

然后用于`.done()`注册要在 promise 获取时调用的函数`resolved`：

```
updateUser(data[i]).done(function(result) {
    alert(result);
}); 
```

重要的部分是`deferred`对象允许您完成异步任务（即您的函数）的*启动*`updateUser`与该任务完成（或失败）时应该发生的事情的解耦。

因此，无需将任何回调函数传递给`.ajax`，您还可以将调用与其他延迟对象（例如动画、其他 AJAX 请求）链接起来。

此外，您可以注册任意数量的`.done()`回调，也可以注册`.fail()`回调，而无需更改`updateUser()`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T20:52:04.013

调用成功函数的函数是 Ajax 请求，而不是 UpdateUser 函数。所以很明显，当你返回它时，它会从成功回调返回，但不会返回到 UpdateUser 函数。

此外，由于 ajax 是异步的，购买回调执行的时间，它将来自 UpdateUser 函数..！

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-13T20:52:27.617

很确定发生了什么（不是专家），但是您正在成功地为您的 annonomys 功能返回“数据”，而不是您的整个 updateUser 功能

```
function updateUser(user_id)
{       
    var retData;
    jQuery.ajax({
        url:"/users/update/"+user_id,
        type:"GET",
        async: false,
        success: (function(data){           
            //if I alert "data" here it shows up correctly
                            //but if i try to return it like below 
                            //it does not get passed correctly 
                            retData = data; 
        })
    return retData;
}); 
```

但就像我说的，我不是专家。

# android - Google Nexus 7 上的 NVidia PerfHUD ES Tegra

> ID：12414563
> 
> 赞同：4
> 
> 时间：2012-09-13T20:49:08.877
> 
> 标签：android, opengl-es, profiling, tegra

我正在尝试通过 ADB 在 Google Nexus 7 上使用[NVIDIA PerfHUD ES 。](https://developer.nvidia.com/nvidia-perfhud-es)我已使用批处理文件启用调试，但我无法连接到设备。查看 LogCat 我可以看到该设备无法开始通信。NVPerfHUD ES 处于活动状态 k:Error 创建套接字通信层初始化失败

当我在 PC 上启动 PerfHUD 时，它无法连接。

文档中提到了有关正确设置防火墙的内容，但我不确定 PC 或设备上的哪个防火墙（设备上是否有防火墙？）

我现在没有想法，重新启动设备几次等，但仍然没有运气。有什么想法我能做什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T21:10:49.953

文档要求应用程序具有 INTERNET 权限。此外，如果您碰巧有一个设备和模拟器正在运行，工具包中的批处理脚本也无法处理这种情况，因此只有在运行“adb devices”命令时只有一个条目时才应该运行它。

# javascript - CRM 2011 - 如何禁用 JS 库？

> ID：12414564
> 
> 赞同：0
> 
> 时间：2012-09-13T20:49:11.977
> 
> 标签：javascript, entity, dynamics-crm, dynamics-crm-2011, crm

CRM 2011 中的 AFAIK 只能禁用字段的 JS 函数。还有一种方法可以禁用表单上的单个 JS 库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:54:41.013

这仅用于开发目的，还是要投入生产？如果用于开发，您可以使用任意数量的基于浏览器的脚本阻止插件（noscript 插件等）之一，并有选择地阻止/启用脚本。

如果用于生产，您可以编写一个脚本，在加载 DOM 后从 DOM 中删除有问题的标签。这可能是有问题的，并且正如其他人所指出的那样不受支持，但假设核心 CRM 2011 脚本代码对开发人员来说是不可访问（或可移除）的。示例代码（使用 jQuery 进行简化）：

```
$(document).ready(function(){
  $('script[src="url_to_offending_script_here"]').remove();
}); 
```

# python - python解释器如何找到模块路径？

> ID：12414570
> 
> 赞同：1
> 
> 时间：2012-09-13T20:49:34.043
> 
> 标签：python, search-path

我是 python 新手，我发现要查看导入搜索路径，您必须导入`sys`模块，然后使用 访问路径列表`sys.path`，如果此列表在我显式导入模块之前不可用`sys`，那么解释器如何找出这个模块所在的位置。感谢您的任何解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:51:52.507

模块搜索路径始终存在，即使在您导入 sys 模块之前也是如此。sys 模块只是让您可以使用它。

它反映了系统变量的内容`$PYTHONPATH`，或者系统默认值，如果你没有设置那个环境变量的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-07T13:57:08.663

解释器中有一个默认的搜索路径。（[https://docs.python.org/2/install/#modifying-python-s-search-path](https://docs.python.org/2/install/#modifying-python-s-search-path)）

> 构建解释器时，将路径的默认值配置到 Python 二进制文件中。

顺便说一句，`sys`内置在 Python 解释器中。（[https://docs.python.org/2/tutorial/modules.html#standard-modules](https://docs.python.org/2/tutorial/modules.html#standard-modules)）

> 一个特定的模块值得关注：`sys`，它内置在每个 Python 解释器中。

# html - 显示：表格单元格，边框间距不适用于按钮？

> ID：12414573
> 
> 赞同：14
> 
> 时间：2012-09-13T20:49:58.227
> 
> 标签：html, css, button, input, css-tables

所以，我习惯`display: table-cell`将两个按钮放在一起，这样如果一个按钮的文本溢出到下一行，两个按钮的高度相同。我已经`border-collapse: separate`并且正在使用`border-spacing`在它们之间放置空间。如果我使用类似的东西，它工作得很好`<div class="button">`，但是一旦我使用该`<button>`元素，中间空间就会消失。
JSFiddle： http: [//jsfiddle.net/uASbb/](http://jsfiddle.net/uASbb/)

现在，使用现在`<div>`很好（如果在语义上不准确的话），所以我很想知道是否有人知道这里到底发生了什么。
注意：我还注意到`<input>`在相同情况下使用元素的一些（不同）奇怪行为：http: [//jsfiddle.net/G5SFX/1/](http://jsfiddle.net/G5SFX/1/)

是`display: table-cell`只是在这些情况下不支持？这是一个错误吗？

谢谢！

编辑：似乎您不能将 a`display: table-cell`应用于按钮；它只是默认回到`inline-block`. 请参阅 Chrome WebInspector
![表格单元 -> 内联块](../Images/f07cd6daa07e1a755e2d2c5e2e5aef67.png)

的此屏幕截图：现在问题仍然存在：这是故意的吗？是规范还是只是浏览器？我们可以改变它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T08:10:32.893

将`button`元素插入 a`div`是一个很好的解决方案（在您的位置，我也会选择它），但是如果您想`button`在没有 a 帮助的情况下并排显示两个元素之间有空格，`div`您可以为您的`.item`班级尝试这个：

```
.item {
    display: table-cell;
    width: 46%;
    background: aliceBlue;
    border: 1px solid black;
    margin: 1%;
} 
```

`Width`减少到`46%`允许每个元素周围有一个`margin`。你现在在它们之间有一个空间，而且如果你调整窗口大小，第二个元素不会落在第一个元素之下。`1%``button``button`

示例：http: [//jsfiddle.net/codenighter/H7TZU/](http://jsfiddle.net/codenighter/H7TZU/)

希望能帮助到你。

编辑：似乎`border-spacing`（实际上所有`block`样式都不起作用）不适用于`button`or `input`。但它确实适用于其他内联元素，如`span`,`h1`或`b`. 所以，for `input`and属性不能被正确应用（我已经改变了and`button`的值并且它显示了，而 for and the的值实际上保持在 50%）。`display: table-cell``width``button``input``span``b``width`

示例：http: [//jsfiddle.net/codenighter/HrTZS/](http://jsfiddle.net/codenighter/HrTZS/)

# php - PHP中的服务器端对象返回给客户端时为空

> ID：12414577
> 
> 赞同：1
> 
> 时间：2012-09-13T20:50:20.630
> 
> 标签：php, javascript, jquery, json, web-applications

我有一个服务器端 PHP 脚本，它生成一个包含来自数据库的聚合数据的对象。该脚本构建对象，将其编码为 JSON 并将其返回给客户端，原始请求是由该 jQuery.ajax 调用发出的：

```
$.ajax({
        async: false,
        url: 'scripts/getDataforUser.php?firstName=' + _firstName+ '&lastName=' + _lastName,
        dataType: "json",
        success: function(result) {
          //Do stuff with 'result' object
          //result object sometimes comes back empty
        },
        error:function (xhr, ajaxOptions, thrownError){
             displayError('An error occurred while fetching data');
             return;
          }
      }); 
```

我的问题是我偶尔会返回一个空的结果对象，这似乎发生在较大的请求中，但似乎是随机的，因此追踪原因是一个挑战。我使用 Zend Server 和 Eclipse 作为我的 IDE，我已经多次调试脚本以确认 A) 有数据，并且 B) 结果对象正在使用`json_encode($data, JSON_FORCE_OBJECT)`PHP 端正确编码为 JSON。

同样，这个错误似乎只发生在较大的对象上，因为我可以在直接调试 getDataforUser.php 脚本时看到数据，所以我专注于客户端并查看是否在 Javascript 端接收到一些错误。

在这一点上，我不确定从服务器到客户端的翻译中丢失了什么。我如何在 PHP 中对对象进行 JSON 编码有问题吗？我如何调用服务器来获取该编码对象？两者的结合？还是我缺少一些更基本的东西？

**更新：**

嗨，Ben，正如我在评论中所述，我在原始帖子中忽略的一个细节可能会提供对该问题的一些见解，即在他的本地开发服务器上运行相同 URL 的开发人员会返回一个空对象，而我只需获取一个具有空属性的对象。我们本地服务器的 PHP 配置可能是问题吗？在我的 PHP.ini 文件中，我的资源限制有以下设置，在这种情况下，我希望这些设置绰绰有余。

```
;;;;;;;;;;;;;;;;;;;
; Resource Limits ;
;;;;;;;;;;;;;;;;;;;

max_execution_time = 600     ; Maximum execution time of each script, in seconds
max_input_time = 180 ; Maximum amount of time each script may spend parsing request data
memory_limit = 128M      ; Maximum amount of memory a script may consume (128MB) 
```

从直接调试脚本开始，脚本执行此查询的时间不超过 600 秒。它在时限内很好地解析了请求数据，并且没有抛出内存耗尽的错误。

**更新 2：**

我的开发环境正在运行 Apache Web 服务器。

**更新 3：**

@Ben - 我快速浏览了[Apache 核心文档](http://httpd.apache.org/docs/2.2/mod/core.html#timeout)，Timeout 指令的默认值为 300 秒，尽管正如我上面提到的，我使用 Zend Server CE 作为我的开发服务器（它位于 Apache 之上），所以它可能有自己的默认超时指令，它在其内部 Apache 配置中设置。再次，我将不得不检查。

还要澄清一下，我在这个软件项目上的合作伙伴也遇到了同样的问题，只是他没有返回一个空对象，而是返回了 null。

**更新 4：**

好的，我在本地 Web 服务器上进行了一些广泛的测试和验证。一个相关的细节是我查询的数据库托管在 MS SQL Server 上，我使用 SQL Server Native Client PHP Driver 作为我的数据库抽象层。无论如何，在查看日志后，我发现数据查询超时，SQL Native Client 报告以下内容：

```
[0] => Array
        (
            [0] => 08S01
            [SQLSTATE] => 08S01
            [1] => 258
            [code] => 258
            [2] => [Microsoft][SQL Server Native Client 11.0]TCP Provider: Timeout error [258]. 
            [message] => [Microsoft][SQL Server Native Client 11.0]TCP Provider: Timeout error [258]. 
        )

    [1] => Array
        (
            [0] => 08S01
            [SQLSTATE] => 08S01
            [1] => 258
            [code] => 258
            [2] => [Microsoft][SQL Server Native Client 11.0]Communication link failure
            [message] => [Microsoft][SQL Server Native Client 11.0]Communication link failure
        )

    [2] => Array
        (
            [0] => 08S01
            [SQLSTATE] => 08S01
            [1] => -2147467259
            [code] => -2147467259
            [2] => [Microsoft][SQL Server Native Client 11.0]Communication link failure
            [message] => [Microsoft][SQL Server Native Client 11.0]Communication link failure
        ) 
```

这似乎是结果对象中空数据的主要来源，我仍在搜索有关此错误的信息，我不确定我需要更新的超时设置是在 SQL Server Native Client 本身还是在数据库。需要更多的调查。

**更新 5：**

我已经排除了数据库超时，远程连接超时设置设置为600秒。我在网上读到过，首选使用 PDO ODBC 驱动程序，因为超时似乎不是问题。我将尝试一下，看看它是否解决了这个超时问题。

**最终更新分辨率：**

好的，所以切换到 PDO 驱动程序似乎解决了我的超时问题，我验证了 PDO 驱动程序在我们的本地开发机器和我们的登台服务器上都工作。我仍然不确定在使用 SQLSRV 驱动程序时会导致 SQL Server Native Client 超时的原因。现在我将主要问题标记为已解决，因为我现在正在取回数据。感谢 Ben D 和其他所有人的支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T22:18:15.023

问题的三个明显来源：它要么是返回 ajax 请求的问题，要么是被调用的 PHP 脚本的问题，或者是服务于 php 结果的网络服务器。我猜这是一个PHP问题，但要彻底：

您的`$.ajax()`请求可能超时，因为即使 jquery 没有默认超时，不同的浏览器似乎在 ajax 请求上设置了自己的超时] [1](http://php.net/manual/en/function.json-last-error.php)。这可能会因`async: false`设置而变得更加复杂，尽管我不确定。我猜不是这样，因为我认为浏览器超时会触发 ajax 错误子句，并且您在评论中注意到有人能够直接从 URL 复制，但很容易确保使用 firebug（或等效) 并观察交通情况。

它是 PHP 问题的可能性要高得多。需要检查的几件事： 1\. PHP 脚本没有超时（`max_execution_time`在 ini 文件中）或达到内存上限（`memory_limit`在 ini 中）。还要确保您不会意外地尝试对非 utf8 字符进行编码，并且您只是碰巧在大对象中击中它们（在这种情况下`json_encode()`会返回`null`）。尝试打开错误，查看是否生成任何错误，并**尝试运行[json_last_error()](http://php.net/manual/en/function.json-last-error.php)**以查看创建 json 字符串是否有问题。

最后，Apache 可能是问题所在。您的请求看起来很小，所以我怀疑它是否达到了任何请求 url 限制，但是在等待 php 创建对象时，Web 服务器可能会超时...检查`TimeOut`您的 http.conf 文件中的值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T20:58:46.157

不要通过 URL 传递 GET 参数。改用“数据”属性：

```
$.ajax({.... data: { firstName: "bob", lastName: "smith" } }); 
```

# magento - 客户网格中自定义列的排序顺序

> ID：12414579
> 
> 赞同：1
> 
> 时间：2012-09-13T20:50:40.660
> 
> 标签：magento, collections, grid, magento-1.5

在我的管理端客户网格上，我有一个情况，有时和列名上的一些客户我需要名字 + 姓氏，它已经由 magento 核心完成，但有些客户我只需要打印名字。看看我的 Grid.php，我需要从“名称”连接中删除姓氏，但是当我从集合中删除时，我的列排序停止工作。

```
<?php

class Mage_Adminhtml_Block_Customer_Grid extends Mage_Adminhtml_Block_Widget_Grid
{

public function __construct()
{
    parent::__construct();
    $this->setId('customerGrid');
    $this->setUseAjax(true);
    $this->setDefaultSort('entity_id');
    $this->setSaveParametersInSession(true);
}

protected function _prepareCollection()
{
    $collection = Mage::getResourceModel('customer/customer_collection')
        ->addNameToSelect()
        ->addAttributeToSelect('email')
        ->addAttributeToSelect('created_at')
        ->addAttributeToSelect('group_id')
        ->joinAttribute('billing_postcode', 'customer_address/postcode', 'default_billing', null, 'left')
        ->joinAttribute('billing_city', 'customer_address/city', 'default_billing', null, 'left')
        ->joinAttribute('billing_telephone', 'customer_address/telephone', 'default_billing', null, 'left')
        ->joinAttribute('billing_region', 'customer_address/region', 'default_billing', null, 'left')
        ->joinAttribute('billing_country_id', 'customer_address/country_id', 'default_billing', null, 'left');

    /*foreach($collection as $customer){
        preg_match("/[A-z| ]*//*", $customer->getName(), $name);
        $customer->setName($name[0]);
        unset($name);
    }*/

    $this->setCollection($collection);

    return parent::_prepareCollection();
}

protected function _prepareColumns()
{
    $this->addColumn('entity_id', array(
        'header'    => Mage::helper('customer')->__('ID'),
        'width'     => '50px',
        'index'     => 'entity_id',
        'type'  => 'number',
    ));

    /*
    $this->addColumn('firstname', array(
        'header'    => Mage::helper('customer')->__('First Name'),
        'index'     => 'firstname'
    ));
    $this->addColumn('lastname', array(
        'header'    => Mage::helper('customer')->__('Last Name'),
        'index'     => 'lastname'
    ));
    */

    $this->addColumn('name', array(
        'header'    => Mage::helper('customer')->__('Name'),
        'sortable'  => true,
        'index'     => 'name'
    ));

    $this->addColumn('email', array(
        'header'    => Mage::helper('customer')->__('Email'),
        'width'     => '150',
        'index'     => 'email'
    ));

    $groups = Mage::getResourceModel('customer/group_collection')
        ->addFieldToFilter('customer_group_id', array('gt'=> 0))
        ->load()
        ->toOptionHash();

    $this->addColumn('group', array(
        'header'    =>  Mage::helper('customer')->__('Group'),
        'width'     =>  '100',
        'index'     =>  'group_id',
        'type'      =>  'options',
        'options'   =>  $groups,
    ));

    $this->addColumn('Telephone', array(
        'header'    => Mage::helper('customer')->__('Telephone'),
        'width'     => '100',
        'index'     => 'billing_telephone'
    ));

    $this->addColumn('billing_postcode', array(
        'header'    => Mage::helper('customer')->__('ZIP'),
        'width'     => '90',
        'index'     => 'billing_postcode',
    ));

    $this->addColumn('billing_country_id', array(
        'header'    => Mage::helper('customer')->__('Country'),
        'width'     => '100',
        'type'      => 'country',
        'index'     => 'billing_country_id',
    ));

    $this->addColumn('billing_region', array(
        'header'    => Mage::helper('customer')->__('State/Province'),
        'width'     => '100',
        'index'     => 'billing_region',
    ));

    $this->addColumn('customer_since', array(
        'header'    => Mage::helper('customer')->__('Customer Since'),
        'type'      => 'datetime',
        'align'     => 'center',
        'index'     => 'created_at',
        'gmtoffset' => true
    ));

    if (!Mage::app()->isSingleStoreMode()) {
        $this->addColumn('website_id', array(
            'header'    => Mage::helper('customer')->__('Website'),
            'align'     => 'center',
            'width'     => '80px',
            'type'      => 'options',
            'options'   => Mage::getSingleton('adminhtml/system_store')->getWebsiteOptionHash(true),
            'index'     => 'website_id',
        ));
    }

    $this->addColumn('action',
        array(
            'header'    =>  Mage::helper('customer')->__('Action'),
            'width'     => '100',
            'type'      => 'action',
            'getter'    => 'getId',
            'actions'   => array(
                array(
                    'caption'   => Mage::helper('customer')->__('Edit'),
                    'url'       => array('base'=> '*/*/edit'),
                    'field'     => 'id'
                )
            ),
            'filter'    => false,
            'sortable'  => false,
            'index'     => 'stores',
            'is_system' => true,
    ));

    $this->addExportType('*/*/exportCsv', Mage::helper('customer')->__('CSV'));
    $this->addExportType('*/*/exportXml', Mage::helper('customer')->__('Excel XML'));
    return parent::_prepareColumns();
}

protected function _prepareMassaction()
{
    $this->setMassactionIdField('entity_id');
    $this->getMassactionBlock()->setFormFieldName('customer');

    $this->getMassactionBlock()->addItem('delete', array(
         'label'    => Mage::helper('customer')->__('Delete'),
         'url'      => $this->getUrl('*/*/massDelete'),
         'confirm'  => Mage::helper('customer')->__('Are you sure?')
    ));

    $this->getMassactionBlock()->addItem('newsletter_subscribe', array(
         'label'    => Mage::helper('customer')->__('Subscribe to Newsletter'),
         'url'      => $this->getUrl('*/*/massSubscribe')
    ));

    $this->getMassactionBlock()->addItem('newsletter_unsubscribe', array(
         'label'    => Mage::helper('customer')->__('Unsubscribe from Newsletter'),
         'url'      => $this->getUrl('*/*/massUnsubscribe')
    ));

    $groups = $this->helper('customer')->getGroups()->toOptionArray();

    array_unshift($groups, array('label'=> '', 'value'=> ''));
    $this->getMassactionBlock()->addItem('assign_group', array(
         'label'        => Mage::helper('customer')->__('Assign a Customer Group'),
         'url'          => $this->getUrl('*/*/massAssignGroup'),
         'additional'   => array(
            'visibility'    => array(
                 'name'     => 'group',
                 'type'     => 'select',
                 'class'    => 'required-entry',
                 'label'    => Mage::helper('customer')->__('Group'),
                 'values'   => $groups
             )
        )
    ));

    return $this;
}

public function getGridUrl()
{
    return $this->getUrl('*/*/grid', array('_current'=> true));
}

public function getRowUrl($row)
{
    return $this->getUrl('*/*/edit', array('id'=>$row->getId()));
} 
```

}

我知道它的错误方式，但必须只获得名字并且没有其他方式。但是现在这使我对网格中的列的排序停止工作。我需要排序工作。如果我从我的 _prepareCollection() 中删除这 3 行，它可以正常工作，但我也需要它，并且它不适用于我的排序。我对此感到疯狂，有人可以帮忙吗？？？

Ty 建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:59:44.723

最好的办法是在集合中加载 firstname 属性并将其添加为独立列。[在 Magento 中向客户网格添加列 - 未填充数据](https://stackoverflow.com/questions/12411795/adding-column-to-customer-grid-in-magento-data-not-populating)将为您提供一个良好的开端。您应该只需要添加，`->addAttributeToSelect('firstname')`然后在 prepareColumns 函数中添加列...

```
$this->addColumn('firstname', array(
    'header'    => Mage::helper('customer')->__('First Name'),
    'index'     => 'firstname'
)); 
```

# c# - 需要帮助以 XMLSerialize 对象内容

> ID：12414580
> 
> 赞同：0
> 
> 时间：2012-09-13T20:50:41.633
> 
> 标签：c#, xml-serialization, entitycollection

我正在使用 XMLSerialization 通过管道通信过程将数据从基于客户端的 Win7 应用程序传递到我们的服务器（Server 2008 R2）。我被带入这个项目是为了完成之前放弃它的开发人员的努力......因此我目前正在尝试修复 VS2010 中不起作用的 C# 代码。

问题是我无法从“公共部分类测试”中的以下方法获得结果输出的完全序列化。我们在 MS Compact 服务器数据库（名为“Test”）中定义了一个表，它匹配下面的每个项目，并根据两个表中匹配的 TestID 对“Channel”表有一个 FK。EntityCollection 基于它与“Channel”表的关系：

```
public Test(Guid TestID, String TestName, String TestRemarks, String ScriptPath,
            EntityCollection<Channel> TChannels)
{
    ID = TestID;
    Name = TestName;
    Remarks = TestRemarks;
    Path = ScriptPath;
    Channels = TChannels;
} 
```

以下是如何在方法执行中使用它的示例：

```
Test T = new Test(NewID, "Test1", "Test_120912-1729",
            "C:\\Temp\\TestScript_16.txt", TChannels); 
```

以下是序列化过程的结果：

```
<DataCore xsi:type="Test">
  <ID>bc6a8ef7-c31f-404d-8108-86219d45be63</ID>
  <Name>Test1</Name>
  <Remarks>Test_120912-1729</Remarks>
  <Path>C:\Temp\TestScript_16.txt</Path>
</DataCore> 
```

前四个参数可以很好地序列化，但最后一个（EntityCollection）没有这样做。但是，如果我尝试自己序列化“TChannels”（在“测试”功能之外），每个测试通道的序列化工作完美。我不完全理解利用 XMLserialization 解决此问题的限制/要求。为什么我无法从函数中序列化 EntityCollection< >？

感谢你的协助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T23:16:15.583

我终于找到了解决上述问题的方法。尽管对许多建议表示赞赏，但它们都没有为我无法 XmlSerialize 子 EntityCollection 提供解决方案。我深入挖掘并查看了 ADO.NET 框架，并在我的数据库**Model.Designer.cs文件中的***自动生成*代码中找到了一个 [XmlIgnoreAttribute()]，靠近我的测试 (EdmEntityTypeAttribute) 中导航属性的开头。

 **我只是完全删除了 [XmlIgnoreAttribute()] 行，现在 EntityCollection<> 中“Channels”的所有子对象都已正确序列化。我希望这可以帮助其他也无法序列化子对象的人。

谢谢@Dave R。**

# php - 停止 Apache 阻止 ETag

> ID：12414583
> 
> 赞同：1
> 
> 时间：2012-09-13T20:50:52.237
> 
> 标签：php, apache, etag

我编写了一个 Web 应用程序，它使用*需要*ETags 的其他人的 API。我试过这段代码：

```
header("ETagbleh: whatever"); 
```

效果很好。但是，当我设置这个时：

```
header("ETag: whatever"); 
```

什么都没发生。我听说可能是 Apache 阻止了 ETag 的发送，但我不确定。我已经在我的 apache2.conf 中搜索了 ETag 并且找不到任何要取消注释/删除的内容，所以我来这里询问。

那么，如何阻止 Apache 阻止我的标头？

编辑：我使用的是 Apache 2.2.22，我认为脚本语言无关紧要，因为我正在使用的 PHP 5.4.4 可以设置任何其他标头。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-09T10:02:49.583

我有同样的问题。

在 Apache2 中删除 ETag 的一种非常流行的方法是添加以下配置：

```
Header unset ETag
FileETag None 
```

如果您在配置中找到它，请删除第一条配置行。

更难找到是`mod_include`导致问题的原因。默认情况下，此模块会删除 ETag-Header。但是您可以通过配置允许它。所以添加这样的东西：

```
 <IfModule mod_include.c>
     SSIETag on
 </IfModule> 
```

请参阅[此处](http://httpd.apache.org/docs/current/mod/mod_include.html#ssietag)了解更多信息。

# android - 如何删除数据库值？

> ID：12414587
> 
> 赞同：0
> 
> 时间：2012-09-13T20:51:04.853
> 
> 标签：android, database

我有一个联系人正在注册（只是为了测试），但是当它为空时，editText 仍然会将值发送到数据库，所以，我该如何删除它并为此创建一个 if/else 语句？我试过

```
 if(myVariable == null){
                   code...
              }.... 
```

但它没有奏效，“null”是指空白但我不太了解它，因为我是新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:55:03.120

因此，当您将其值发送到数据库时，您是否试图确保您的 EditText 不为空？

```
EditText text = ...

if(text.getText.toString().length() != 0){

  ...database code

} 
```

# r - JavaGD 无法加载

> ID：12414589
> 
> 赞同：1
> 
> 时间：2012-09-13T20:51:08.913
> 
> 标签：r

有人可以帮忙吗。

我让 Deducer 与 R 2.14 一起工作，但现在我已经更新到 2.15.1，我无法加载 JGR。我已经加载了 JGR 和 Deducer。

这是我安装时收到的消息

```
Loading required package: JavaGD
Error : .onLoad failed in loadNamespace() for 'JavaGD', details:
  call: .Call("RegGetStrValue", c(key, "CurrentVersion"), PACKAGE = "JavaGD")
  error: C symbol name "RegGetStrValue" not in DLL for package "JavaGD"
Error: package ‘JavaGD’ could not be loaded 
```

我已经删除了所有旧版本的 R 和 Ver 2.15.1 - 重新安装了 R 并且仍然收到此消息。

这是否可能是注册表问题，如果是，我应该在哪里查看。

我已经搜索过，虽然似乎有类似的报告问题，但没有一个与我所看到的完全相同。我的库中似乎没有多个 JavaGD 版本，并且 Namesake 文件位于 JavaGD 文件夹中。

我在相当当前的戴尔笔记本电脑上运行 Win 7 32 位版本。

R 似乎工作正常，我大部分时间都在使用 R-Studio，而且效果也很好。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-12-30T04:19:10.740

7 年来，OP 最初的问题是选择正确的 Java 下载对于我们的大多数 RStudio 环境都可以同步使用的 64 位机器来说至关重要。无论出于何种原因，下载 64 位 JRE 都很困难。为避免 Deducer 最近出现的相同错误，请务必从[https://www.java.com/en/download/manual.jsp](https://www.java.com/en/download/manual.jsp)下载 64 位 Java JRE 。注意，64 位版本必须按照说明离线下载（通常是 Windows 下载的底部）。检查安装路径是否为 c:\Program Files\Java 而不是 c:\Program Files(x86)\Java。再加上 JDK 应该可以解决这个问题。

# java - 如何使用java检查mysql中的特定数据库是否已经存在

> ID：12414596
> 
> 赞同：14
> 
> 时间：2012-09-13T20:51:27.867
> 
> 标签：java, mysql, jdbc

我是 JDBC 新手，我想知道是否有办法检查 MySQL 中是否已经存在特定数据库。

假设我想创建一个名为学生的数据库，如果学生数据库已经在 MySQL 中创建，则 Eclipse 中的错误消息会指出这个学生数据库已经存在。但是我想做的是创建一个布尔方法来检查学生数据库是否已经存在。如果存在，则布尔方法将返回 false，否则返回 true，然后我可以创建学生数据库。我如何在 Java 中执行这些操作？JDBC 中是否有任何方法可以做到这一点，或者我需要从头开始编写代码？

### 编辑 2

我遵循了mguymons的建议，这就是我想出的

```
public boolean checkDBExists(String dbName){

    try {
        Class.forName(JDBCDriver); //Register JDBC Driver

        System.out.println("Creating a connection...");
        conn = DriverManager.getConnection(DBURL, USER, PASS); //Open a connection

        ResultSet resultSet = conn.getMetaData().getCatalogs();

        while (resultSet.next()) {

          String databaseName = resultSet.getString(1);
            if(databaseName.equals(dbName)){
                return true;
            }
        }
        resultSet.close();

    }
    catch(Exception e){
        e.printStackTrace();
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-13T21:04:09.527

您可以使用[DatabaseMetaData#g​​etCatalogs从](http://docs.oracle.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getCatalogs%28%29)*JDBC 连接*获取该信息，这里是获取目录的示例，也就是数据库名称

```
// Connection connection = <your java.sql.Connection>
ResultSet resultSet = connection.getMetaData().getCatalogs();

//iterate each catalog in the ResultSet
while (resultSet.next()) {
  // Get the database name, which is at position 1
  String databaseName = resultSet.getString(1);
}
resultSet.close(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-13T20:54:24.933

```
show databases like 'students' 
```

如果你得到一行回来，它存在。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T20:56:08.853

在较新版本的 MySQL（5 及更高版本）中运行此查询：

```
SELECT COUNT(*)
FROM information_schema.tables 
WHERE table_schema = '[database name]' 
AND table_name = '[table name]'; 
```

如果结果为 1，则存在。

在 Java JDBC 中看起来像这样：

```
// Create connection and statement
String query = "SELECT COUNT(*) FROM information_schema.tables WHERE table_schema'[database name]' AND table_name = '[table name]'";
ResultSet rs = stmt.executeQuery(query);                  
rs.next();
boolean exists = rs.getInt("COUNT(*)") > 0;
// Close connection, statement, and result set.
return exists; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-13T22:07:24.743

你是从头到尾做的。正确的技术是尝试创建它并捕获异常。您想要执行的方式受时间窗口问题的影响：测试时它不存在，但是当您尝试创建它时它就存在。无论如何，您仍然必须捕获异常。

# unit-testing - Visual Studio 2012 中的测试生成

> ID：12414597
> 
> 赞同：0
> 
> 时间：2012-09-13T20:51:31.100
> 
> 标签：unit-testing, visual-studio-2012

Visual Studio 2010 有一个特性，可以为每个公共方法或类的属性生成一个测试方法。即使我知道结果或多或少少用了，我想知道这个功能在VS2012中是否仍然存在，因为我没有找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:53:32.753

此功能已从 VS 2012 中删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-14T11:15:15.427

试试这个插件：http: [//blogs.msdn.com/b/willy-peter_schaub/archive/2013/06/13/announcing-the-unit-test-generator-visual-studio-extension-beta.aspx](http://blogs.msdn.com/b/willy-peter_schaub/archive/2013/06/13/announcing-the-unit-test-generator-visual-studio-extension-beta.aspx)

我错过了配置它创建测试的结构的选项，但除此之外它工作正常。

# highcharts - Highcharts 范围选择器可以使用非日期线性范围吗？

> ID：12414598
> 
> 赞同：3
> 
> 时间：2012-09-13T20:51:37.547
> 
> 标签：highcharts, highstock

我正在使用 HighStock JS lib 生成一个图表，该图表对 xAxis 使用线性序列（不是时间序列）。

我仍然想使用范围选择器来缩放到我的线性系列中的预定范围。这可能吗？

例如; 说我的 xAxis 有一个系列：

`[[121,616],[122,600],[123,605],[124,585.5],[125,575.5],[126,580.5],[127,582],[128,582],[129,584],[130,583]]`

我想使用范围选择器缩放到`n`系列中的最后一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:05:02.957

我不认为开箱即用。但是支持的是[Axis.setExtremes()](http://api.highcharts.com/highstock#Axis.setExtremes%28%29)

您可以使用此方法动态设置 xAxis 的缩放，因此您可以为非时间序列图表创建自己的范围选择器

[Axis.setExtremes() 如何@jsFiddle](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/stock/members/axis-setextremes/)

[我对自定义范围选择器的尝试@jsFiddle](http://jsfiddle.net/jugal/cdAgr/)

# python - Suds 忽略代理设置

> ID：12414600
> 
> 赞同：7
> 
> 时间：2012-09-13T20:51:38.877
> 
> 标签：python, salesforce, suds

我正在尝试使用 salesforce-python-toolkit 对 Salesforce API 进行 Web 服务调用，但是我无法让客户端通过代理。由于该工具包是基于 suds 的，我尝试使用 suds 本身来查看是否可以让它尊重那里的代理设置，但它也不起作用。

这在 OS X 10.7（python 2.7）和 ubuntu 12.04 上的 suds 0.3.9 上进行了测试。

我提出的一个示例请求最终没有通过代理（只是在本地运行的 burp 或 charles 代理）：

```
import suds
ws = suds.client.Client('file://sandbox.xml',proxy={'http':'http://localhost:8888'})
ws.service.login('user','pass') 
```

我用代理尝试了各种方法——删除 http://，使用 IP，使用 FQDN。我已经逐步浏览了 pdb 中的代码，并看到它设置了代理选项。我也尝试过在没有代理的情况下实例化客户端，然后将其设置为： ws.set_options(proxy={'http':'http://localhost:8888'})

suds 不再使用代理了吗？我没有看到它直接列在这里[http://jortel.fedorapeople.org/suds/doc/suds.options.Options-class.html](http://jortel.fedorapeople.org/suds/doc/suds.options.Options-class.html)，但我确实在传输中看到它。我需要通过传输进行不同的设置吗？当我进入 pdb 时，它看起来确实像是在使用传输，但我不确定如何。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-15T00:40:46.103

我在 freenode 上进入了#suds，Xelnor/rbarrois 提供了一个很好的答案！显然，suds 中的自定义映射覆盖了 urllib2 使用系统配置环境变量的行为。此解决方案现在依赖于相应设置 http_proxy/https_proxy/no_proxy 环境变量。

我希望这可以帮助其他遇到代理和 suds（或其他使用 suds 的库）问题的人。[https://gist.github.com/3721801](https://gist.github.com/3721801)

```
from suds.transport.http import HttpTransport as SudsHttpTransport 

class WellBehavedHttpTransport(SudsHttpTransport): 
    """HttpTransport which properly obeys the ``*_proxy`` environment variables.""" 

    def u2handlers(self): 
        """Return a list of specific handlers to add. 

        The urllib2 logic regarding ``build_opener(*handlers)`` is: 

        - It has a list of default handlers to use 

        - If a subclass or an instance of one of those default handlers is given 
            in ``*handlers``, it overrides the default one. 

        Suds uses a custom {'protocol': 'proxy'} mapping in self.proxy, and adds 
        a ProxyHandler(self.proxy) to that list of handlers. 
        This overrides the default behaviour of urllib2, which would otherwise 
        use the system configuration (environment variables on Linux, System 
        Configuration on Mac OS, ...) to determine which proxies to use for 
        the current protocol, and when not to use a proxy (no_proxy). 

        Thus, passing an empty list will use the default ProxyHandler which 
        behaves correctly. 
        """ 
        return []

client = suds.client.Client(my_wsdl, transport=WellBehavedHttpTransport()) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T21:05:24.617

我认为您可以使用如下所示的 urllib2 开启器来完成。

```
import suds
t = suds.transport.http.HttpTransport()
proxy = urllib2.ProxyHandler({'http': 'http://localhost:8888'})
opener = urllib2.build_opener(proxy)
t.urlopener = opener
ws = suds.client.Client('file://sandbox.xml', transport=t) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-02-08T19:38:01.887

我实际上能够通过做两件事让它工作：

*   确保代理字典中`http`有`https`.
*   `set_options`使用创建客户端后设置代理。

所以，我的相关代码如下所示：

`self.suds_client = suds.client.Client(wsdl) self.suds_client.set_options(proxy={'http': 'http://localhost:8888', 'https': 'http://localhost:8888'})`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-23T03:28:23.293

我在使用 Suds 时遇到了多个问题，即使我的代理配置正确，我也无法连接到端点 wsdl。在花费大量时间尝试制定解决方法后，我决定试一试soap2py - [https://code.google.com/p/pysimplesoap/wiki/SoapClient](https://code.google.com/p/pysimplesoap/wiki/SoapClient)

直接工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-23T18:27:34.867

[对于通过 HTTPS 尝试cji 解决方案](https://stackoverflow.com/a/12433606/4166584)的任何人，您实际上需要保留一个处理程序以进行基本身份验证。我也在使用 python3.7 所以`urllib2`已经替换为`urllib.request`.

```
from suds.transport.https import HttpAuthenticated as SudsHttpsTransport
from urllib.request import HTTPBasicAuthHandler

class WellBehavedHttpsTransport(SudsHttpsTransport):
    """ HttpsTransport which properly obeys the ``*_proxy`` environment variables."""

    def u2handlers(self):
        """ Return a list of specific handlers to add.

        The urllib2 logic regarding ``build_opener(*handlers)`` is:

        - It has a list of default handlers to use

        - If a subclass or an instance of one of those default handlers is given
            in ``*handlers``, it overrides the default one.

        Suds uses a custom {'protocol': 'proxy'} mapping in self.proxy, and adds
        a ProxyHandler(self.proxy) to that list of handlers.
        This overrides the default behaviour of urllib2, which would otherwise
        use the system configuration (environment variables on Linux, System
        Configuration on Mac OS, ...) to determine which proxies to use for
        the current protocol, and when not to use a proxy (no_proxy).

        Thus, passing an empty list (asides from the BasicAuthHandler) 
        will use the default ProxyHandler which behaves correctly.
        """
        return [HTTPBasicAuthHandler(self.pm)] 
```

# c# - 异步/等待与 BackgroundWorker

> ID：12414601
> 
> 赞同：186
> 
> 时间：2012-09-13T20:51:48.933
> 
> 标签：c#, task-parallel-library, backgroundworker, .net-4.5, async-await

在过去的几天里，我测试了 .net 4.5 和 c# 5 的新特性。

我喜欢它的新异步/等待功能。早些时候，我使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/vstudio/system.componentmodel.backgroundworker%28v=vs.100%29.aspx)来处理具有响应式 UI 的后台较长进程。

我的问题是：在有了这些不错的新功能之后，我应该什么时候使用 async/await 以及什么时候使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/vstudio/system.componentmodel.backgroundworker%28v=vs.100%29.aspx)？两者的常见情况是什么？

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2012-09-13T22:29:41.563

对于许多人来说，这可能是 TL;DR，但是，我认为比较`await`就像`BackgroundWorker`比较苹果和橙子，我对此的想法如下：

`BackgroundWorker`旨在为您希望在后台执行的单个任务建模，在线程池线程上。 `async`/`await`是异步等待异步操作的语法。这些操作可能使用也可能不使用线程池线程，甚至使用*任何其他线程*。所以，它们是苹果和橙子。

例如，您可以使用以下方法执行以下操作`await`：

```
using (WebResponse response = await webReq.GetResponseAsync())
{
    using (Stream responseStream = response.GetResponseStream())
    {
        int bytesRead = await responseStream.ReadAsync(buffer, 0, buffer.Length);
    }
} 
```

但是，您可能永远不会在后台工作人员中建模，您可能会在 .NET 4.0（之前`await`）中执行类似的操作：

```
webReq.BeginGetResponse(ar =>
{
    WebResponse response = webReq.EndGetResponse(ar);
    Stream responseStream = response.GetResponseStream();
    responseStream.BeginRead(buffer, 0, buffer.Length, ar2 =>
    {
        int bytesRead = responseStream.EndRead(ar2);
        responseStream.Dispose();
        ((IDisposable) response).Dispose();
    }, null);
}, null); 
```

`using`请注意，两种语法之间的处置不相交，以及没有`async`/就不能使用`await`。

但是，你不会对`BackgroundWorker`. `BackgroundWorker`通常用于对您不想影响 UI 响应能力的单个长时间运行的操作进行建模。例如：

```
worker.DoWork += (sender, e) =>
                    {
                    int i = 0;
                    // simulate lengthy operation
                    Stopwatch sw = Stopwatch.StartNew();
                    while (sw.Elapsed.TotalSeconds < 1)
                        ++i;
                    };
worker.RunWorkerCompleted += (sender, eventArgs) =>
                                {
                                    // TODO: do something on the UI thread, like
                                    // update status or display "result"
                                };
worker.RunWorkerAsync(); 
```

真的没有什么可以使用 async/await 的，`BackgroundWorker`就是为你创建线程。

现在，您可以改用 TPL：

```
var synchronizationContext = TaskScheduler.FromCurrentSynchronizationContext();
Task.Factory.StartNew(() =>
                      {
                        int i = 0;
                        // simulate lengthy operation
                        Stopwatch sw = Stopwatch.StartNew();
                        while (sw.Elapsed.TotalSeconds < 1)
                            ++i;
                      }).ContinueWith(t=>
                                      {
                                        // TODO: do something on the UI thread, like
                                        // update status or display "result"
                                      }, synchronizationContext); 
```

在这种情况下，`TaskScheduler`将为您创建线程（假设为 default `TaskScheduler`），并且可以使用`await`如下：

```
await Task.Factory.StartNew(() =>
                  {
                    int i = 0;
                    // simulate lengthy operation
                    Stopwatch sw = Stopwatch.StartNew();
                    while (sw.Elapsed.TotalSeconds < 1)
                        ++i;
                  });
// TODO: do something on the UI thread, like
// update status or display "result" 
```

在我看来，一个主要的比较是您是否在报告进度。例如，您可能有`BackgroundWorker like`这样的：

```
BackgroundWorker worker = new BackgroundWorker();
worker.WorkerReportsProgress = true;
worker.ProgressChanged += (sender, eventArgs) =>
                            {
                            // TODO: something with progress, like update progress bar

                            };
worker.DoWork += (sender, e) =>
                 {
                    int i = 0;
                    // simulate lengthy operation
                    Stopwatch sw = Stopwatch.StartNew();
                    while (sw.Elapsed.TotalSeconds < 1)
                    {
                        if ((sw.Elapsed.TotalMilliseconds%100) == 0)
                            ((BackgroundWorker)sender).ReportProgress((int) (1000 / sw.ElapsedMilliseconds));
                        ++i;
                    }
                 };
worker.RunWorkerCompleted += (sender, eventArgs) =>
                                {
                                    // do something on the UI thread, like
                                    // update status or display "result"
                                };
worker.RunWorkerAsync(); 
```

但是，您不会处理其中的一些问题，因为您会将后台工作程序组件拖放到表单的设计表面上——这是您无法使用`async`/`await`和`Task`... 做的事情，即您不会t 手动创建对象、设置属性和设置事件处理程序。您只需填写`DoWork`、`RunWorkerCompleted`和`ProgressChanged`事件处理程序的主体。

如果您将其“转换”为异步/等待，您将执行以下操作：

```
 IProgress<int> progress = new Progress<int>();

     progress.ProgressChanged += ( s, e ) =>
        {
           // TODO: do something with e.ProgressPercentage
           // like update progress bar
        };

     await Task.Factory.StartNew(() =>
                  {
                    int i = 0;
                    // simulate lengthy operation
                    Stopwatch sw = Stopwatch.StartNew();
                    while (sw.Elapsed.TotalSeconds < 1)
                    {
                        if ((sw.Elapsed.TotalMilliseconds%100) == 0)
                        {
                            progress.Report((int) (1000 / sw.ElapsedMilliseconds))
                        }
                        ++i;
                    }
                  });
// TODO: do something on the UI thread, like
// update status or display "result" 
```

如果无法将组件拖到 Designer 表面，则真正由读者决定哪个“更好”。但是，对我来说，这是和之间的比较，`await`而`BackgroundWorker`不是你是否可以等待内置方法，如`Stream.ReadAsync`. 例如，如果您`BackgroundWorker`按预期使用，则可能很难转换为使用`await`.

其他想法：http: [//jeremybytes.blogspot.ca/2012/05/backgroundworker-component-im-not-dead.html](http://jeremybytes.blogspot.ca/2012/05/backgroundworker-component-im-not-dead.html)

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2012-09-13T20:55:11.517

async/await 旨在替换诸如`BackgroundWorker`. 虽然您当然*可以*根据需要使用它，但您应该能够使用 async/await 以及其他一些 TPL 工具来处理所有可用的东西。

由于两者都有效，因此取决于您何时使用的个人偏好。*什么对你*来说更快？*你*更容易理解什么？

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-09-13T21:30:15.353

这是一个很好的介绍： http: [//msdn.microsoft.com/en-us/library/hh191443.aspx](http://msdn.microsoft.com/en-us/library/hh191443.aspx) 线程部分正是您正在寻找的：

> 异步方法旨在成为非阻塞操作。当等待的任务正在运行时，异步方法中的等待表达式不会阻塞当前线程。相反，表达式将方法的其余部分注册为延续，并将控制权返回给异步方法的调用者。
> 
> async 和 await 关键字不会导致创建额外的线程。异步方法不需要多线程，因为异步方法不在其自己的线程上运行。该方法在当前同步上下文上运行，并且仅在该方法处于活动状态时才使用线程上的时间。您可以使用 Task.Run 将受 CPU 限制的工作转移到后台线程，但后台线程对等待结果可用的进程没有帮助。
> 
> 在几乎所有情况下，基于异步的异步编程方法都优于现有方法。特别是，对于 IO 绑定操作，这种方法比 BackgroundWorker 更好，因为代码更简单，并且您不必防范竞争条件。与 Task.Run 结合使用时，异步编程比 BackgroundWorker 更适合 CPU 密集型操作，因为异步编程将运行代码的协调细节与 Task.Run 传输到线程池的工作分开。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-05-03T19:43:31.660

[BackgroundWorker](http://msdn.microsoft.com/en-us/library/vstudio/system.componentmodel.backgroundworker%28v=vs.80%29.aspx)在 .NET 4.5 中被明确标记为已过时：

*   在[Joseph Albahari、Ben Albahari 的书中“C# 5.0 in a Nutshell: The Definitive Reference”](http://books.google.ru/books?id=EvXX03I5iLYC&pg=PA603&lpg=PA603&dq=%22BackgroundWorker%20in%20System.ComponentModel%20is%20a%20general-purpose%20implementation%20of%20the%20EAP%22&source=bl&ots=jFhk1uzPv2&sig=YG6Tpj50XtTCGFehh2DYta2h0f4&hl=en&sa=X&ei=LxGEUaOVBuqp4ASehIGICA&ved=0CCsQ6AEwAA#v=onepage&q=%22BackgroundWorker%20in%20System.ComponentModel%20is%20a%20general-purpose%20implementation%20of%20the%20EAP%22&f=false)
*   Stephen Cleary 对[我的问题的回答“难道不是 .NET 4.0 TPL 让 APM、EAP 和 BackgroundWorker 异步模式过时了吗？”](https://stackoverflow.com/a/16364264/2031316)

MSDN 文章[“使用 Async 和 Await 进行异步编程（C# 和 Visual Basic）”](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx#BKMK_Threads)讲述：

> 在几乎所有情况下，基于异步的异步编程方法**都优于现有方法**。**特别是，对于 IO 绑定操作**，这种方法比[BackgroundWorker](http://msdn.microsoft.com/en-us/library/vstudio/system.componentmodel.backgroundworker.aspx) 更好， 因为代码更简单，并且您不必防范竞争条件。**与 Task.Run 结合使用时，异步编程在 CPU 密集型操作**方面优于[BackgroundWorker](http://msdn.microsoft.com/en-us/library/vstudio/system.componentmodel.backgroundworker.aspx) ，因为异步编程将运行代码的协调细节与**Task.Run**转移到线程池的工作分开

 ********更新**

*   回应[@eran-otzap](https://stackoverflow.com/users/590088/eran-otzap)的评论：
    “对于 IO 绑定操作，因为代码更简单，而且您不必防范竞争条件”可能发生哪些竞争条件，您能举个例子吗？"

这个问题应该作为一个单独的帖子。

[维基百科对比赛](http://en.wikipedia.org/wiki/Race_condition#Example)条件有很好的解释。它的必要部分是多线程，来自同一篇 MSDN 文章[Asynchronous Programming with Async and Await (C# and Visual Basic)](http://msdn.microsoft.com/en-us/library/hh191443.aspx)：

> 异步方法旨在成为非阻塞操作。当等待的任务正在运行时，异步方法中的等待表达式不会阻塞当前线程。相反，表达式将方法的其余部分注册为延续，并将控制权返回给异步方法的调用者。
> 
> async 和 await 关键字不会导致创建额外的线程。异步方法不需要多线程，因为异步方法不在其自己的线程上运行。该方法在当前同步上下文上运行，并且仅在该方法处于活动状态时才使用线程上的时间。您可以使用 Task.Run 将受 CPU 限制的工作转移到后台线程，但后台线程对等待结果可用的进程没有帮助。
> 
> 在几乎所有情况下，基于异步的异步编程方法都优于现有方法。特别是，对于 IO 绑定操作，这种方法比 BackgroundWorker 更好，因为代码更简单，并且您不必防范竞争条件。与 Task.Run 结合使用时，异步编程在 CPU 密集型操作方面优于 BackgroundWorker，因为异步编程将运行代码的协调细节与 Task.Run 转移到线程池的工作分开

也就是说，“async 和 await 关键字不会导致创建额外的线程”。

据我记得一年前我在学习这篇文章时自己的尝试，如果你已经运行并玩过同一篇文章中的代码示例，你可能会遇到它的非异步版本（你可以尝试转换它给自己）无限期地阻止！

此外，对于具体示例，您可以搜索此站点。下面是一些例子：

*   [使用 c#5.0 调用异步方法](https://stackoverflow.com/questions/16144358/calling-an-async-method-with-c5-0/16145723#16145723)
*   [为什么此代码在通过 TPL/Tasks 执行时会失败？](https://stackoverflow.com/questions/13017892/why-does-this-code-fail-when-executed-via-tpl-tasks)
*   [await vs Task.Wait - 死锁？](https://stackoverflow.com/questions/13140523/await-vs-task-wait-deadlock)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2020-10-31T10:51:28.503

让我们对a[`BackgroundWorker`](https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.backgroundworker)和[`Task.Run`](https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task.run)++ [async/await](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/)组合进行最新比较。我将使用这两种方法来实现必须卸载到后台线程的模拟 CPU 绑定操作，以保持 UI 响应。该操作的总持续时间为 5 秒，并且在操作期间必须每 500 毫秒更新一次。最后，计算结果必须显示在. 首先是实现：[`Progress<T>`](https://docs.microsoft.com/en-us/dotnet/api/system.progress-1)`ProgressBar``Label``BackgroundWorker`

```
private void Button_Click(object sender, EventArgs e)
{
    var worker = new BackgroundWorker();
    worker.WorkerReportsProgress = true;
    worker.DoWork += (object sender, DoWorkEventArgs e) =>
    {
        int sum = 0;
        for (int i = 0; i < 100; i += 10)
        {
            worker.ReportProgress(i);
            Thread.Sleep(500); // Simulate some time-consuming work
            sum += i;
        }
        worker.ReportProgress(100);
        e.Result = sum;
    };
    worker.ProgressChanged += (object sender, ProgressChangedEventArgs e) =>
    {
        ProgressBar1.Value = e.ProgressPercentage;
    };
    worker.RunWorkerCompleted += (object sender, RunWorkerCompletedEventArgs e) =>
    {
        int result = (int)e.Result;
        Label1.Text = $"Result: {result:#,0}";
    };
    worker.RunWorkerAsync();
} 
```

事件处理程序内的 24 行代码。现在让我们用现代方法做同样的事情：

```
private async void Button_Click(object sender, EventArgs e)
{
    IProgress<int> progress = new Progress<int>(percent =>
    {
        ProgressBar1.Value = percent;
    });
    int result = await Task.Run(() =>
    {
        int sum = 0;
        for (int i = 0; i < 100; i += 10)
        {
            progress.Report(i);
            Thread.Sleep(500); // Simulate some time-consuming work
            sum += i;
        }
        progress.Report(100);
        return sum;
    });
    Label1.Text = $"Result: {result:#,0}";
} 
```

事件处理程序内的 17 行代码。整体代码相当少。

在这两种情况下，工作都是在[`ThreadPool`](https://docs.microsoft.com/en-us/dotnet/api/system.threading.threadpool)线程上执行的。

该方法的优点`BackgroundWorker`：

1.  可用于面向[.NET Framework 4.0](https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.0)及更早版本的项目。

`Task.Run`++ /方法的优点`Progress<T>`：`async``await`

1.  结果是强类型的。无需从`object`. 没有运行时的风险`InvalidCastException`。
2.  工作完成后的延续是在原来的范围内运行，而不是在一个lamda里面。
3.  允许通过`Progress`. 相反， a`BackgroundWorker`迫使您将任何额外信息作为 传递`object`，然后从`object` [`ProgressChangedEventArgs.UserState`](https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.progresschangedeventargs.userstate)属性中回退。
4.  允许使用多个`Progress`对象，以不同的频率报告不同的进度数据，轻松。这是非常乏味且容易出错的`BackgroundWorker`.
5.  取消操作遵循[协作取消的标准 .NET 模式](https://docs.microsoft.com/en-us/dotnet/standard/threading/cancellation-in-managed-threads)：[`CancellationTokenSource`](https://docs.microsoft.com/en-us/dotnet/api/system.threading.cancellationtokensource)+[`CancellationToken`](https://docs.microsoft.com/en-us/dotnet/api/system.threading.cancellationtoken)组合。目前有数千个 .NET API 使用`CancellationToken`. 相反，`BackgroundWorker`s 取消机制不能被使用，因为它不生成通知。
6.  最后`Task.Run`，它同样轻松地支持同步和异步工作负载。`BackgroundWorker`只能通过阻塞工作线程来使用异步 API 。******

# mysql - 试图将太多数据放入 mysql TEXT 数据类型

> ID：12414603
> 
> 赞同：7
> 
> 时间：2012-09-13T20:51:55.960
> 
> 标签：mysql, types, sqldatatypes

假设我有一个 html 表单（实际上我有一个编辑器 - TinyMCE），它通过 PHP 将一堆文本插入到 Mysql 表中。

我想知道以下内容：

如果我在 Mysql 列中有 TINYTEXT 数据类型 - 如果用户尝试将超过 255 个字节的文本放入 Mysql 表中会发生什么？

应用程序是否保存前 255 个字节并“切断”其余字节？或者没有任何东西保存到Mysql表中并且mysql发出警告？或者以上都不是？

实际上，我想要并打算做的是：通过将 Mysql 中的列数据类型设置为 TEXT 数据类型来限制用户表单输入的大小，该数据类型最多可以容纳 64 KB 的文本。我想限制从用户传递到数据库的文本量，以便用户不能一次将太多数据放入服务器。

所以，基本上，我想知道如果用户通过 TinyMCE 编辑器放置的文本超过 65535 字节，假设 mysql 表中的 TEXT 数据类型，会发生什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:09:11.190

默认情况下，如果数据太长，MySQL 会截断数据，并发送警告。

```
SHOW WARNINGS;
Data truncated for foo .. 
```

需要明确的是：数据**将**被保存，但您**会**丢失太大的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:10:56.190

如果值大于最大表字段定义大小，默认 mysql 配置会截断数据，这将产生非阻塞警告。

如果你想要一个阻塞错误，你必须将 sql_mode 设置为`STRICT_ALL_TABLES`

dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html#sqlmode_strict_all_tables

恕我直言，最好的方法是通过应用软件管理此错误。

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:10:26.250

如果您在 MySQL 中的 TEXT 字段中输入太多数据，它将无论如何都会插入该行，但该字段会被截断为最大长度，并发出警告。

即使 MySQL 确实阻止添加行，它也不是限制用户可以输入的数据长度的好方法。您应该检查 PHP 中 POSTed 字符串的长度，如果它太长，则根本不运行查询 - 并且可能告诉用户为什么没有输入他们的数据。

除此之外，您还可以防止用户在客户端输入太多字符（尽管您也应该始终检查服务器端，因为有人可以绕过客户端限制）。似乎在 TinyMCE 中没有内置的方法可以做到这一点，但可以通过编写回调来实现：[Limit the number of character in tinyMCE](https://stackoverflow.com/questions/11342921/limit-the-number-of-character-in-tinymce)

# c++ - C ++：使用“this”返回重载[]

> ID：12414605
> 
> 赞同：1
> 
> 时间：2012-09-13T20:52:14.320
> 
> 标签：c++, pointers, operator-overloading, return, this

我在 C++ 中重载了一个简单类的 []（方括号）运算符，以从数组中返回一个整数。我现在要在成员函数中重用这个重载运算符。我无法实现这一点，因为 using`*this[ i ]`显然不起作用，尽管我可以直接引用运算符：

```
int & A::operator [] (size_t i)
{

    return ints[ i ];

}
...
int A::getVal ( size_t i) const
{

  // Does not work
  return *this[ i ];

  // Does work
  // return operator []( i );

} 
```

为什么取消引用指针`this`并使用运算符 [] 会导致编译错误，但直接调用运算符会起作用？

我得到以下错误编译：

> 无法从 'const Array' 转换为 'char'

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T20:54:22.207

> 为什么取消引用指针 this 并使用运算符 [] 会导致编译错误

它没有。但你必须拼写正确。改变

```
return *this[ i ]; 
```

至

```
return (*this)[ i ]; 
```

如最初所写，它适用`[i]`于`this`，然后取消引用结果。

# php - PHP 警告：mysql_fetch_array() 期望参数 1 是资源，给定的布尔值

> ID：12414606
> 
> 赞同：3
> 
> 时间：2012-09-13T20:52:20.467
> 
> 标签：php, mysql

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

它引用的行`mysql_fetch_array()`是调用函数的行。运行时查询工作正常`phpmyadmin`。它也不会引发任何错误。任何帮助，将不胜感激。

```
$query = "select distinct s.time, s.parameter, s.data, t.units from alertData as s, parameters as t where s.parameter like '%Airtemp_Avg%' and s.staID = 'WS_001_UHC' and s.interval_min = 15 and t.parameter like '%Airtemp_Avg%' and unix_timestamp(s.time) >= (unix_timestamp(now()) - 86400) order by time desc";
$results = mysql_query($query) || die(mysql_error());
$dataCnt = 0;
while($info = mysql_fetch_array($results)) {
    //15 Min data
    if(($dataCnt == 0) && (getTimestamp($info['time']) >= ($now - 4500))) 
       $data15['temp'] = $info['data'];
    else 
       $data15['temp'] = '-';

    $dataCnt++;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:54:49.987

去掉`|| die (mysql_error())`后面的`mysql_query()`。它被评估为布尔值，这导致了错误。

编辑：

正如 bfavaretto 指出的那样，您可以`OR`改用。它只是 PHP 的另一个不一致之处。[在关于逻辑运算符](http://www.php.net/manual/en/language.operators.logical.php)的 PHP 文档中阅读更多相关信息（查看第一个代码示例的注释）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:10:43.980

如果有错误，$results 将返回 false。

使用这样的东西来检查你的结果：

```
if (false === $result) {
echo mysql_error();
} 
```

此外，不推荐使用 mysql_ 函数，并且不推荐使用。请改用 PDO 或 MySQLi。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T20:54:02.240

```
if ($results) { while... 
```

确保您确实有结果

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T21:40:02.843

我相信您的 SQL 查询有问题，请检查表名和列名是否正确，检查您是否与数据库有连接，以及 bfavaretto 所说的使用`or die(mysql_error())`。

我不是 100% 确定，但查询不应该是：

```
$query = "select distinct s.time, s.parameter, s.data, t.units as s, parameters as t from alertData where s.parameter like '%Airtemp_Avg%' and s.staID = 'WS_001_UHC' and s.interval_min = 15 and t.parameter like '%Airtemp_Avg%' and unix_timestamp(s.time) >= (unix_timestamp(now()) - 86400) order by time desc"; 
```

代替

```
$query = "select distinct s.time, s.parameter, s.data, t.units from alertData as s, parameters as t where s.parameter like '%Airtemp_Avg%' and s.staID = 'WS_001_UHC' and s.interval_min = 15 and t.parameter like '%Airtemp_Avg%' and unix_timestamp(s.time) >= (unix_timestamp(now()) - 86400) order by time desc"; 
```

# javascript - 如何使用节点/摇篮从 couchDB 获取文档字段列表？

> ID：12414613
> 
> 赞同：0
> 
> 时间：2012-09-13T20:52:44.063
> 
> 标签：javascript, node.js, couchdb, cradle

首先，我想让你知道我是 node 和 couchDB 的新手，我有这个项目，我需要在现有应用程序中添加一些功能。

所以，我有 javascript/node/express web 应用程序，我想使用 cradle 从远程 couchDB 获取特定文档，然后获取其字段及其值的列表。稍后我需要在一些 html 中显示这些字段/值。我不知道文档有哪些字段，因为它们是由第三方动态添加/删除的。我能够得到我想要的文档，但我不知道如何遍历它的字段。最好的方法是什么？

这是文档的简化示例：

```
{
"_id": "1.1.5",
"_rev": "5-56ebac233e7f56a14a4534c6902727f7",
"1.1.5.39": {
   "Project": {
       "Project1": {
           "files": "...",
           "status": "NEW",
           "id": 2
       },
       "Project2": {
           "files": "...",
           "status": "ASSIGNED",
           "id": 3
       }
   }
}
"1.1.5.23": {
   "Project": {
       "Project3": {
           "files": "...",
           "status": "NEW",
           "id": 4
       },
       "Project4": {
           "files": "...",
           "status": "NEW",
           "id": 5
       }
   }
}
} 
```

我需要获取字段“1.1.5.39”和“1.1.5.23”，以及“状态”值。这些字段代表软件的某些版本。问题也是字段的格式：数字和点，所以我不能只使用“Object.attribute”表示法......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T17:20:22.240

第一部分是通过 cradle 获取文档：

```
// get the Connection
var connection = new(cradle.Connection)('http://living-room.couch', 5984, {
  cache: true,
  raw: false
});
// get the DB
var db = connection.db('yourDB');

// get the document
var docID = "1.1.5";
db.get('docID', function (err, doc) {
  displayDoc(doc);
});

function displayDoc(doc) {
  // Do your display handling here
} 
```

您需要的第二部分是显示任意对象。在这里，我请您参考我对这个[问题](https://stackoverflow.com/questions/11557471/how-to-display-arbitrary-schemaless-data-in-html-with-node-js-mongodb/11571170#11571170)的回答。

祝你好运。

# python - 从 3D numpy 数组创建 3D 图

> ID：12414619
> 
> 赞同：26
> 
> 时间：2012-09-13T20:53:10.237
> 
> 标签：python, numpy, matplotlib

好的，所以我觉得应该有一种简单的方法来使用 matplotlib 创建一个 3 维散点图。我有一个 3D numpy 数组 ( `dset`)，其中 0 是我不想要的点，而 1 是我想要的地方，基本上现在要绘制它，我必须`for:`像这样逐步完成三个循环：

```
for i in range(30):
    for x in range(60):
        for y in range(60):
            if dset[i, x, y] == 1:
                ax.scatter(x, y, -i, zdir='z', c= 'red') 
```

关于如何更有效地完成此任务的任何建议？任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-13T21:08:31.783

如果您有`dset`类似的情况，并且只想获取`1`值，则可以使用`nonzero`，它“返回数组元组，每个维度一个`a`，包含该维度中非零元素的索引。”。

例如，我们可以制作一个简单的 3d 数组：

```
>>> import numpy
>>> numpy.random.seed(29)
>>> d = numpy.random.randint(0, 2, size=(3,3,3))
>>> d
array([[[1, 1, 0],
        [1, 0, 0],
        [0, 1, 1]],

       [[0, 1, 1],
        [1, 0, 0],
        [0, 1, 1]],

       [[1, 1, 0],
        [0, 1, 0],
        [0, 0, 1]]]) 
```

并找到非零元素所在的位置：

```
>>> d.nonzero()
(array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2]), array([0, 0, 1, 2, 2, 0, 0, 1, 2, 2, 0, 0, 1, 2]), array([0, 1, 0, 1, 2, 1, 2, 0, 1, 2, 0, 1, 1, 2]))
>>> z,x,y = d.nonzero() 
```

如果我们想要一个更复杂的切割，我们可以做一些类似`(d > 3.4).nonzero()`的事情，因为 True 有一个整数值 1 并且计数为非零。

最后，我们绘制：

```
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.scatter(x, y, -z, zdir='z', c= 'red')
plt.savefig("demo.png") 
```

给予

![演示 3d 图像](../Images/8afacbc91bac40b46d964b0e05bd03dd.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-16T01:59:35.467

如果您想避免使用该`nonzero`选项（例如，如果您有一个 3D numpy 数组，其值应该是数据点的颜色值），您可以做您所做的，但使用`ndenumerate`.

您的示例可能变为：

```
for index, x in np.ndenumerate(dset):
    if x == 1:
        ax.scatter(*index, c = 'red') 
```

我想重点是您不需要嵌套 for 循环来遍历多维 numpy 数组。

# c# - 在确定的索引 C# 中打开组合框

> ID：12414628
> 
> 赞同：0
> 
> 时间：2012-09-13T20:53:49.660
> 
> 标签：c#

我有这个 SQL 表列表

```
1 Guilherme
2 Alejandro
3 Thiago 
```

我使用此代码填充我的组合框1

```
da1.Fill(dt1);
BindingSource src = new BindingSource();
src.DataSource = dt1;
comboBox1.DataSource = src;
comboBox1.ValueMember = "ntj_id";
comboBox1.DisplayMember = "ntj_descricao"; 
```

这很好地填充了组合框1，现在我希望当组合框打开时，它会突出显示 value `alejandro`。我试过这个：

```
int abre = comboBox1.FindString("Alejandro"); 
comboBox1.SelectedItem  = abre; 
```

但是当我写这个或这个时：

```
comboBox1.SelectedIndex = abre; 
```

组合框打开并突出显示实际值。

# java - 如何将整数数组更改为字符串数组？

> ID：12414630
> 
> 赞同：1
> 
> 时间：2012-09-13T20:54:00.293
> 
> 标签：java, arrays, string, multidimensional-array

好吧，标题可能是骗人的。我要做的就是使用我的宾果程序，当打印第二张宾果卡时，我想用“X”替换所有“0”。我在想我必须去将数组更改为字符串，但我不确定从哪里开始。

**这是宾果游戏程序：**

```
import java.util.*;
import java.io.*;
import java.util.Arrays;

 public class Bingo
 {
public static final int ROWS = 5;
public static final int COLS = 5;
public static final int VERTICAL = 1;
public static final int DIAGONAL = 2;
public static final int HORIZONTAL = 3;
public static int winFound;
public static int currPick = 0;
public static int randomPick = 0;
public static int WinFound;

public static void main(String[] args)
{   
int Totcards;
int[][] card = new int[ROWS][COLS];
int[] picks = new int[25];

fillCard (card);
printCard(card);
playGame(card);
printCard(card);
finalCard(card);

   }

private static void fillCard (int[][] card)
{
//  FileReader fileIn = new FileReader("Bingo.in");
//  Bufferreader in = new Bufferreader(fileIn);

    try {
    Scanner scan = new Scanner(new File("bingo.in"));
      for (int i=0; i<card.length; i++){
               for (int j=0; j<card[0].length; j++){
                card[i][j] = scan.nextInt();
    }
    }
    } catch(FileNotFoundException fnfe) {
      System.out.println(fnfe.getMessage());
    }

}

private static void printCard (int[][] card)
{
    System.out.println("\n\tYOUR BINGO CARD : ");
    System.out.println("\n\tB    I    N    G    O");
    System.out.println("\t----------------------");

    for (int i=0; i<card.length; i++){
          for (int j=0; j<card[0].length; j++){
              System.out.print("\t" + card[i][j]);
              }
    System.out.print("\n");
    }
}

private static void playGame (int[][] card)
{

    int numPicks = 0;       

    System.out.println("\n\tBINGO NUMBERS PICKED AT RANDOM FROM BIN: ");    
    while (true)
            {
               markCard (card);   // Generate a random num & zero-it out
       winFound = checkForWin(card);  //  Look for zero sums
       numPicks++;

               if (winFound != 0)
               {
        if (winFound == 1)
        {
            System.out.print("\n\n\tYOU WIN WITH A VERTICAL WIN AFTER " + numPicks + " PICKS\n");
        }
        else if (winFound == 2){
            System.out.print("\n\n\tYOU WIN WITH A DIAGONAL WIN AFTER " + numPicks + " PICKS\n");
        }
        else if (winFound == 3){
            System.out.print("\n\n\tYOU WIN WITH A HORIZONTAL WIN AFTER " + numPicks + " PICKS\n");
        }

                 announceWin (numPicks);
                 return;
               }
            }

   }        
private static void markCard (int[][] card)
{
  int randomPick = (int) (Math.random() * 74) + 1;

  for (int j = 0;  j < ROWS;  j++){
        for (int k = 0;  k < COLS;  k++){
            if (card[j][k]==randomPick)
                    card[j][k] = 0;}    
    }
    System.out.print("\t " + randomPick + " ");
System.out.print("");
}

private static int checkForWin(int[][] card)
{
  int sum=0;

   for (int i = 0;  i < ROWS;  i++)
       {
        sum = 0;
        for (int j = 0;  j < COLS;  j++)
        sum += card[i][j];

        if (sum == 0)
            return HORIZONTAL;
       }

       for (int j = 0;  j < COLS;  j++)
       {
         sum = 0;
         for (int i = 0;  i < ROWS;  i++)
            sum += card[i][j];

        if (sum == 0)
            return VERTICAL;
       }

       sum = 0;
       for (int i = 0;  i < ROWS;  i++)
            sum += card[i][ROWS-i-1];
       if (sum == 0)
            return DIAGONAL;

       sum = 0;
       for (int i = 0;  i < ROWS;  i++)
          sum += card[i][i];

       if (sum == 0)
            return DIAGONAL;

       return WinFound;
    } 

private static void makeCard(int[][] card, int[] picks)
{
            int count = 100;
            int currPick = 0;
            for (int i=0; i<count; i++){
             currPick = (int)(Math.random() * 74) + 1;
             System.out.print(" " + currPick + "\n");
    picks[i] = currPick;
            }
}

private static void announceWin(int numPicks)
{

}

private static boolean duplicate (int currPick, int[] picks, int numPicks)
{
    for (int i = 0;  i < numPicks;  i++){
                    if (picks[i] == currPick){
                            return true;}
        }
            return false;

}

private static void finalCard (int[][] card)
{ 
    Arrays.sort(card);
    final String stringRep = Arrays.toString(card);
    final String[] out =
        stringRep.substring(1, stringRep.length() - 1).split("\\s*,\\s*");

    System.out.println(Arrays.toString(out));
}
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:30:53.823

为什么不`String[][]`从一开始就使用 a 字段？您仍然可以将`String`值与`int`s （`Integer.valueOf`例如）进行比较，这样您就不必在运行时切换类型...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:40:37.387

试试这个：

```
System.out.print("\t" + (card[i][j] == 0 ? "X" : card[i][j])) 
```

# c# - ASP.NET MVC4 WebSecurity - 数据库存储位置

> ID：12414632
> 
> 赞同：5
> 
> 时间：2012-09-13T20:54:11.680
> 
> 标签：c#, asp.net, asp.net-mvc-3, asp.net-mvc-4

我刚刚安装了 MVC 4 并创建了一个默认的 Internet 项目。我能够创建用户名/登录/更改密码。

在 MVC 3 中，创建用户后，我会在 App_Data 文件夹中看到一个 ASPNETDB.MDF 文件，并且我还可以在网站管理工具中管理用户/角色。

使用 MVC 4，即使单击显示所有文件，我也看不到 ASPNETDB.MDF 文件。此外，任何创建的新用户都不会显示在网站管理工具中。

我还有其他地方可以检索用户/设置卷吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T09:55:35.600

我不确定您是否可以在 MVC4 中使用“网站管理工具”

转到`Models`文件夹并打开`AccountModeles.cs`课程。

你会找到代码，

```
public UsersContext()
            : base("DefaultConnection")
        {
        } 
```

进入web.config文件查看连接字符串的名称`DefaultConnection`，可以看到存储用户/角色的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T13:04:39.523

据我所知，您必须刷新您的解决方案，显示所有文件，然后查看地图 App_Data。也许你忘了刷新？

您也可以手动转到您的 .MDF 文件，然后将其拖到 Visual Studio 中。然后它会自动打开服务器资源管理器，您可以在其中看到新用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T18:39:38.690

MVC 4 Internet 应用程序中的成员资格提供程序，称为 SimpleMembership，不使用数据库 ASPNETDB.MDF。您应该在 App_Data 目录中找到另一个数据库，该数据库使用约定 aspnet-project name-999999999999.mdf 命名，其中“项目名称”是创建它的 VS 项目的名称，我相信使用日期/时间的数字和也许其他一些数字来制作一个有点独特的ID。您会在此数据库中找到用户数据，它与网站管理工具不兼容。您可以在这篇文章中找到有关[SimpleMembership 数据库和对其进行自定义的](http://kevin-junghans.blogspot.com/2013/01/seeding-customizing-aspnet-mvc.html)更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T17:13:44.823

MVC 4 不支持使用网站管理工具，因为它使用 WebMatrix 的简单成员。

[本文建议这样做](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-07T14:49:50.940

在您的解决方案中打开 web.config 文件以检查 mdf 文件的创建位置和名称。

您应该可以在配置文件中找到您的数据库详细信息：

```
</configSections>
  <connectionStrings>
    <add name="DefaultConnection" connectionString="Data Source= ******> 
```

有了它，您可以在 SQL 服务器上打开相应的数据库，以检查您正在寻找的详细信息

# mongodb - Mongodb Gridfs 减小图像大小

> ID：12414633
> 
> 赞同：4
> 
> 时间：2012-09-13T20:54:12.047
> 
> 标签：mongodb, gridfs, node-mongodb-native

我正在使用 node.js 和 mongodb 开发类似 facebook 的应用程序。我已经能够成功地将图像文件上传到 GridFS 并使用 node-mongodb-native 驱动程序 wiki 的精彩示例检索它们。图像的最大使用将作为缩略图，所以我从各种 SO 帖子中了解到，同时保留大尺寸版本和小尺寸版本将是最快的解决方案。

所以我的问题是如何创建同一图像的各种大小的副本。[诸如MongoDB GridFS 存储多种大小的图像或使用动态调整大小的](https://stackoverflow.com/questions/7516045/mongodb-gridfs-store-multiple-sizes-of-image-or-use-on-the-fly-resizing)SO 上已经提出了许多此类问题，但没有一个真正回答如何更改大小。

在 mongo shell 中，我可以在 fs.chunks 集合中看到原始图像的二进制数据，当然必须有某种方法来操作这些二进制数据以获得更小的图像，然后我可以将其保存为单独的 GridFS 块或其他方式。请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:04:06.500

要减小图像的大小，您必须在将其保存到 GridFS 之前对其进行缩放。GridFS 与缩放图像的过程无关。

但是，如果我没记错的话，您可以制作 GridFS 二进制数据的数据流。[node-gd](https://github.com/taggon/node-gd)是一个用于缩放图像（除其他外）的库，据我所知，它可以处理流。

如果您可以直接处理上传的文件（在将它们保存到 GridFS 之前），[node-imagemagick](https://github.com/rsms/node-imagemagick)提供了一个非常简单的调整大小功能：

```
/* with express */
app.post('/image', function(req, res) {
    file = req.files[0];
    (require 'imagemagick')
        .resize({
            srcPath: file.path,
            dstPath: file.path + '-smaller.png',
            width: 50}, function(err, stdout, stderr) {
        /* You now have two files: file.path is the original, file.path + '-smaller.png' is the thumbnail. */
    });
}); 
```

# javascript - 如何最好地处理循环和 addEventListeners？

> ID：12414636
> 
> 赞同：-1
> 
> 时间：2012-09-13T20:54:16.787
> 
> 标签：javascript, for-loop

我之前的问题 -[为什么 JavaScript 在 for-loop 为 3 时总是提示 4？](https://stackoverflow.com/questions/12414271/why-javascript-alerts-allways-4-in-when-for-loop-is-for-3/12414357#12414357)- 表明它非常难以赶上 JS 中的 for-loops for addEventListeners，所以我提出了一个粗暴的解决方案......我怎样才能正确循环它**并**让新手易于阅读？

```
document.getElementById('layerChangerOryginal').addEventListener('click', function() { Layer1() });
document.getElementById('layerChanger1').addEventListener('click', function() { Layer1() });
document.getElementById('layerChanger2').addEventListener('click', function() { Layer2() });
document.getElementById('layerChanger3').addEventListener('click', function() { Layer3() });

function Layer1() {
    document.getElementById('oryginalLayer1').className='container layer1';
    document.getElementById('oryginalLayer2').className='container layer2';
    document.getElementById('oryginalLayer3').className='container layer3';
}
function Layer2() {
    document.getElementById('oryginalLayer1').className='container layer3';
    document.getElementById('oryginalLayer2').className='container layer1';
    document.getElementById('oryginalLayer3').className='container layer2';
}
function Layer3() {
    document.getElementById('oryginalLayer1').className='container layer3';
    document.getElementById('oryginalLayer2').className='container layer2';
    document.getElementById('oryginalLayer3').className='container layer1';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:38:07.747

```
for (var i = 1; i <= 3; i++) {
  document.getElementById('layerChanger'+i).addEventListener('click', window['Layer'+i]);
} 
```

这是有效的，因为任何名为的顶级函数或变量`name`都是`window[name]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T02:23:31.767

这是使用循环的解决方案：

```
var a, i, j,
    eventFunc, 
    args_list = [[1, 2, 3], [3, 1, 2], [3, 2, 1]],

    str1 = 'container layer',
    str2 = 'oryginalLayer',
    byId = function(x) {
        return document.getElementById(x);
    };

for (i = 1; i < 4; ++i) {
    eventFunc = function() {
        for (j = 1; j < 4; ++j) {
            byId(str2 + j).className = str1 + args_list[i][j];
        }
    };

    byId('layerChanger' + i).addEventListener('click', eventFunc, false);

    if (i === 1) {
        byId('layerChangerOryginal').addEventListener('click', eventFunc, false);
        ++i;
    }
}​ 
```

似乎比下面的等效代码复杂一点：

```
var str = 'container layer',
    byId = function (x) {
        return document.getElementById(x);
    },

    createLayerFunc = function ( a, b, c ) {
        return function LayerX(x) {
            byId('oryginalLayer1').className = str+a;
            byId('oryginalLayer2').className = str+b;
            byId('oryginalLayer3').className = str+c;
        };
    },

    Layer1 = createLayerFunc(1, 2, 3),
    Layer2 = createLayerFunc(3, 1, 2),
    Layer3 = createLayerFunc(3, 2, 1);

byId('layerChangerOryginal').addEventListener('click', Layer1, false);
byId('layerChanger1').addEventListener('click', Layer1, false);
byId('layerChanger2').addEventListener('click', Layer2, false);
byId('layerChanger3').addEventListener('click', Layer3, false); 
```

# templates - Windows 8 上的 VS2012 Ultimate 中没有 Metro 风格模板

> ID：12414638
> 
> 赞同：1
> 
> 时间：2012-09-13T20:54:24.260
> 
> 标签：templates, microsoft-metro, visual-studio-2012

我有一个带有 windows 8 x64 位的 VM，我从 microsoft webiste 安装了 VS2012 Ultimate。它提示我提供开发者许可证——我点击了确定。它要求我登录微软帐户。我创建了一个并签署了它并且它有效。但是当我尝试创建新项目时，我没有看到任何 Metro 风格的应用程序模板。我尝试卸载并再次安装，但没有任何进展。请帮忙。我在项目模板 \csharp 中没有看到 Metro 风格文件夹。当我下载[http://go.microsoft.com/fwlink/?LinkId=247147](http://go.microsoft.com/fwlink/?LinkId=247147)时它关闭了，我在模板中看到了 Metro 风格文件夹，但安装最后抛出了错误 - iis8 安装错误并且 vs 也没有打开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:27:18.290

以前称为“metro”模板，现在是“Windows Store App”模板。

# android - Android上的Phonegap Datepicker插件

> ID：12414640
> 
> 赞同：2
> 
> 时间：2012-09-13T20:54:25.583
> 
> 标签：android, cordova, datepicker

我正在使用适用于 Android 的 Phonegap Datepicker 插件。

打开屏幕时，我看不到日期选择器。我收到此错误。

09-13 22:37:55.894：E/Web 控制台（13123）：未捕获的类型错误：无法在文件中调用未定义的“显示”方法：///android_asset/www/index.html:689

我的代码如下所示：

```
<div data-role="controlgroup">
    <p>
        <label for="airportName">Airport</label> <input type="text" name="airportName" id="airportName" class="custom" />
        <label for="selectDate">Date</label> <input type="text" name="selectDate" id="selectDate" class="nativedatepicker" />            
    </p> 
```

我已经使用了事件处理程序，例如

```
$('.nativedatepicker').click(function(event) {
    var currentField = $(this);
    var myNewDate = Date.parse(currentField.val()) || new Date();

    // Same handling for iPhone and Android
    window.plugins.datePicker.show({
        date : myNewDate,
        mode : 'date', // date or time or blank for both
        allowOldDates : true
        }, function(returnDate) {
            var newDate = new Date(returnDate);
            currentField.val(newDate.toString("yyyy-MM-dd"));

            // This fixes the problem you mention at the bottom of this script with it not working a second/third time around, because it is in focus.
            currentField.blur();
    });
}); 
```

除了文档中显示的常用示例之外，是否有任何链接可以让我看到如何使用此插件的示例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T08:49:11.950

您必须做的事情是改变`DatePickerPlugin.java`，因为如果不使用新的`Cordova 2.0`将无法正常工作。更改此文件中的两行后，调用 from`Javascript`不会再麻烦您了。改变：

```
 final DroidGap currentCtx = (DroidGap) ctx.getContext(); 
```

为了这：

```
 final Context currentCtx = cordova.getActivity(); 
```

找到这个：

```
 ctx.runOnUiThread(runnable); 
```

并替换为：

```
 cordova.getActivity().runOnUiThread(runnable); 
```

阅读此线程以获取更多信息： [datePicker plugin not working in Phonegap 2.0](https://stackoverflow.com/questions/11776905/datepicker-plugin-not-working-in-phonegap-2-0)

# c# - 无法设置 Control.FindControl() 找到的控件的 Text 属性

> ID：12414647
> 
> 赞同：0
> 
> 时间：2012-09-13T20:54:52.473
> 
> 标签：c#, asp.net, findcontrol

**我正在尝试做的事情：**我正在通过`CreateUserWizard`控件创建用户，并且正在尝试将密码设置为随机生成的字母数字密码。密码`TextBox`对用户（管理员）是不可见的。

**我尝试**的解决方案：我找到密码`TextBox`并尝试更改值，但不会设置该值。我的代码如下：

```
CreateUserWizard1_CreatingUser(object sender, LoginCancelEventArgs e) 
{
    TextBox Password = (TextBox)CreateUserWizardStep1.ContentTemplateContainer.FindControl("Password");
    Password.Text = "randomAlphaNumericPassword";
} 
```

找到 Password 控件，该`Text`属性似乎已设置，但一旦离开事件方法，它就会忘记新值并返回到原来的值。我知道这是一个实际的参考，但不明白为什么该值不会设置。

这是我的asp标记：

```
<asp:CreateUserWizard ID="CreateUserWizard1" runat="server"
    EnableViewState="False" LoginCreatedUser="False" 
    oncreateduser="CreateUserWizard1_CreatedUser"
    oncreatinguser="CreateUserWizard1_CreatingUser" 
    CompleteSuccessText="A new account has been successfully created!" 
    ContinueDestinationPageUrl="~/Accounts.aspx" 
    CreateUserButtonText="Create Account" 
    AutoGeneratePassword="False">
    <WizardSteps>
        <asp:CreateUserWizardStep ID="CreateUserWizardStep1" runat="server">
            <ContentTemplate>
            ...
                <asp:TextBox ID="Password" runat="server" Visible="false"></asp:TextBox>
            </ContentTemplate>
        </asp:CreateUserWizardStep>
        ...
    </WizardSteps> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:08:26.783

我想到了。该值设置正确，但我认为这不是因为我不断收到密码失败消息，**“密码少于 7 个字符，并且必须包含至少一个非字母数字字符”**，即使我的密码长于 7 个字符。

我的错误是假设消息中的两个条件都为真。此情况并非如此。如果任一条件为真，则会显示此消息。

我将 web.config 文件更改为最低要求 0 个非字母数字字符，之后一切正常。我之前没有指定任何内容，因此它默认为至少 1 个非字母数字字符。

**如果我必须赞扬某人，那将是 MStodd**询问控件的验证代码。这让我更仔细地看待这个问题。

感谢大家的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T22:53:04.690

在您的页面生命周期的早期是否有一些东西，例如在 Page_Load 上将值设置为默认值？如果是这样，请确保您在以下代码块中执行此操作

```
if(!IsPostBack)
{
   // set default value
} 
```

# android - Android 中包含图像的大型 ListView

> ID：12414648
> 
> 赞同：5
> 
> 时间：2012-09-13T20:54:53.927
> 
> 标签：android, memory, android-listview, android-imageview

对于各种 Android 应用程序，我需要大`ListView`s，即具有 100-300 个条目的此类视图。

所有条目必须在应用程序启动时批量加载，因为需要进行一些排序和处理，否则应用程序无法知道首先显示哪些项目。

到目前为止，我一直在批量加载所有项目的图像，然后将其`ArrayList<CustomType>`与每个条目的其余数据一起保存。

但当然，这不是一个好的做法，因为您很可能会遇到`OutOfMemoryException`这样的情况：对所有图像的引用会`ArrayList`阻止垃圾收集器工作。

因此，显然，最好的解决方案是仅批量加载文本数据，然后根据需要加载图像，对吗？例如，Google Play 应用程序会这样做： 您可以看到图像在您滚动到它们时被加载，即它们可能是在适配器的`getView()`方法中加载的。但是对于 Google Play，这是一个不同的问题，无论如何，因为图像必须从 Internet 加载，这对我来说不是这种情况。我的问题不是加载图像需要太长时间，而是存储它们需要太多内存。

那么我应该如何处理图像呢？加载`getView()`，什么时候真正需要它们？会使滚动变慢。所以打电话给`AsyncTask`然后？还是只是一个正常的`Thread`？参数化它？

我可以将已经加载到的图像保存`HashMap<String,Bitmap>`到`getView()`. 但是如果这样做了，你又会遇到内存问题：`HashMap`存储对所有图像的引用，所以最后你可能会`OutOfMemoryException`再次遇到。

我知道这里已经有很多问题讨论图像的“延迟加载”。但它们主要涵盖了加载缓慢的问题，没有太多的内存消耗。

**编辑：**我现在决定[在 getView() 中启动 AsyncTasks，它将图像加载到后台的 ListView 中](http://developer.android.com/training/improving-layouts/smooth-scrolling.html)。但这会导致我的应用程序遇到 RejectedExecutionException。我现在该怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-21T14:19:59.360

I took the approach of loading the images with an AsyncTask and attaching the task to the view in the adapter's getView function to keep track of which task is loading in which view. I use this in an app of mine and there's no scroll lag and all images are loaded in the proper position with no exceptions being thrown. Also, because the task does no work if it's canceled, you can perform a fling on your list and it should lag up at all.

The task:

```
public class DecodeTask extends AsyncTask<String, Void, Bitmap> {

private static int MaxTextureSize = 2048; /* True for most devices. */

public ImageView v;

public DecodeTask(ImageView iv) {
    v = iv;
}

protected Bitmap doInBackground(String... params) {
    BitmapFactory.Options opt = new BitmapFactory.Options();
    opt.inPurgeable = true;
    opt.inPreferQualityOverSpeed = false;
    opt.inSampleSize = 0;

    Bitmap bitmap = null;
    if(isCancelled()) {
        return bitmap;
    }

    opt.inJustDecodeBounds = true;
    do {
        opt.inSampleSize++;
        BitmapFactory.decodeFile(params[0], opt);
    } while(opt.outHeight > MaxTextureSize || opt.outWidth > MaxTextureSize)
    opt.inJustDecodeBounds = false;

    bitmap = BitmapFactory.decodeFile(params[0], opt);
    return bitmap;
}

@Override
protected void onPostExecute(Bitmap result) {
    if(v != null) {
        v.setImageBitmap(result);
    }
}

} 
```

The adapter stores an ArrayList that contains the file paths of all the images that need loaded. The getView function looks like this:

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ImageView iv = null;
    if(convertView == null) {
        convertView = getLayoutInflater().inflate(R.id.your_view, null); /* Inflate your view here */
        iv = convertView.findViewById(R.id.your_image_view);
    } else {
        iv = convertView.findViewById(R.id.your_image_view);
        DecodeTask task = (DecodeTask)iv.getTag(R.id.your_image_view);
        if(task != null) {
            task.cancel(true);
        }
    }
    iv.setImageBitmap(null);
    DecodeTask task = new DecodeTask(iv);
    task.execute(getItem(position) /* File path to image */);
    iv.setTag(R.id.your_image_view, task);

    return convertView;
} 
```

NOTE: Just a caveat here, this might still give you memory problems on versions 1.5 - 2.3 since they use a thread pool for AsyncTask. 3.0+ go back to the serial model by default for executing AsyncTasks which keeps it to one task running at a time, thus using less memory at any given time. So long as your images aren't too big though, you should be fine.

**UPDATE:** While this solution will still work, there have been great additions to the open source community for solving this problem in a cleaner way. Libraries like Glide or Picasso both handle loading items in a list quite well and I'd recommend you look into one of those solutions if possible.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T23:44:20.717

1) To solve your memory problem with `HashMap<String, Bitmap>`: Can you use `WeakHashMap` so that images are recycled when needed? The same should work for the `ArrayList` you mentioned in the beginning, if your `CustomType` has weak references to images.

2) What about NOT loading images while user scrolls through the list, but instead when user stops scrolling, load images at that moment. Yes, the list will not look fancy without images, but it will be very efficient during scroll, and while user scrolls he does not see details anyway. Techinally it should work like this:

```
listView.setOnScrollListener(new OnScrollListener() {
  @Override
  public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount,
      int totalItemCount) {
    // Don't care.
  }

  @Override
  public void onScrollStateChanged(final AbsListView view, int scrollState) {
    // Load images here. ListView can tell you what rows are visible, you load images for these rows and update corresponding View-s.
  }
}) 
```

3) I have an app that loads about 300 images during app start and keeps them for app lifetime. So that's an issue for me too, but so far I have seen very few OOM reports and I suspect they happened because of a different leak. I try to save some memory by using `RGB_565` profile for ListView images (there's no significant difference in quality for this purpose) and I use 96x96 max image size, that should be enough for standard list item height.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T22:34:21.047

不要将所有图像存储在列表中，因为它太重了。您应该在 getView 中启动 AsyncTask，在 InBackground 中获取、解码您的图像，并在 PostExecute 中的 imageView 上绘制图像。为了保持列表的性能，您还可以使用 getView 方法中的 convertView 参数，但是 AsyncTask 开始变得复杂，因为您的视图可以在 AsyncTask 完成之前回收，您应该处理这个额外的......

您可以使用 LruCache，但这仅在从 Internet 下载图像时才有意义。当它们存储在本地时，使用它毫无意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-21T03:56:43.430

check this out: [https://github.com/DHuckaby/Prime](https://github.com/DHuckaby/Prime)

I would use this for images in a ListView vs trying to solve it yourself.. I actually use it for all remote images in my apps.. or at least read the source code.. image management is a pain.. lean on a mature library to get you going.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T06:51:46.723

您提供的[链接](http://lucasr.org/2012/04/05/performance-tips-for-androids-listview)有助于理解什么是 convertView、asyncTask 等。我认为这样做`View v = super.getView(position, convertView, parent);`行不通。如果你想回收视图，你应该这样做`if(convertView != null){ myView = convertView} else{ inflate(myView)};`

About AsyncTask that's right its different in different APIS but when you use execute() for old API and executeOnExecutor on the new one - I think everything is fine. You should pass URI and ImageView to your AsyncTask. Here you could have problem with convertView that it appears in a new row with AsyncTask working on it's image. You can hold for example hashmap of ImageView-AsyncTask and cancel these which are not valid any more.

PS.Sorry for creating a new comment but it was too long for inline answer :)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-20T10:16:41.517

```
 private class CallService extends AsyncTask<String, Integer, String>
         {   
                protected String doInBackground(String... u)
                {
                    fetchReasons();
                    return null;
                }
                protected void onPreExecute() 
                {
                    //Define the loader here.

                }
                public void onProgressUpdate(Integer... args)
                {           
                }
                protected void onPostExecute(String result) 
                {               
                    //remove loader
                    //Add data to your view.
                }
         }

public void fetchReasons()
    {
         //Call Your Web Service and save the records in the arrayList
    } 
```

Call new CallService().execute(); in onCreate() method

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2012-09-17T00:21:58.380

A small piece of advice would be to disable loading of images when a fling occurs.

* * *

**dirty HACK to make everything faster:**

In your Adapter's `getItemViewType(int position)`, return the position:

```
@Override
public long getItemViewType(int position) {
     return position;
}
@Override
public long getViewTypeCount(int position) {
     return getCount();
}
@Override
public View getView(int position, View convertView, ViewGroup arg2) {
    if (convertView == null) {
        //inflate your convertView and set everything
    }
    //do not do anything just return the convertView
    return convertView;
} 
```

`ListView` will decide the amount of images to cache.

* * *

# jsf-2 - EJB3 / JSF2：使用 ConversationalScope 和有状态 EJB 设计 JSF2 应用程序

> ID：12414652
> 
> 赞同：0
> 
> 时间：2012-09-13T20:55:00.830
> 
> 标签：jsf-2, ejb-3.0, java-ee-6

我的用例如下：

使用订单行、客户和付款详细信息管理订单。

该应用程序包含一个订单列表视图，从中可以打开一个订单详细信息视图以编辑现有订单或创建新订单。订单详细信息视图使用视图参数（现有订单 ID 或无以指示要创建的新订单）。

当打开订单详细信息视图时，OrderControllerBean 将启动 ConversationalScope，并根据订单 ID 的可用性加载或创建新的订单实体。这个 bean 是一个有状态的会话 bean，也可以用作外观。bean 包含处理订单行、客户和付款详细信息以及保存和删除订单的方法。这些方法使用被设计为无状态会话 bean 的注入 EJB 作为某种 DAO 来处理 JPA 实体订单、订单行、客户和支付细节。

从带有客户信息、付款信息和订单行列表的订单详细信息视图，用户可以导航到添加/编辑订单行的订单详细信息视图以及以类似方式导航到客户和付款详细信息视图。这些详细视图都使用相同的 OrderControllerBean。在客户、订单行和付款明细视图中，有确定和取消按钮，它们不是事务性的。

在订单详细信息视图中有一个保存和取消按钮，该按钮应保留在对话期间完成的所有修改。

我现在的问题是：这个设计合适吗？

我不确定以下问题：

如果用户从不使用 Save 或 Cancel 会发生什么？

在转换或会话超时之前，一切都会一直存在吗？从交易的角度来看，这意味着什么？这对托管实体意味着什么？如果用户离开他的工作场所并稍后回来继续进行对话会发生什么？如果对话超时，我该如何优雅地处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:13:06.897

在我看来，有状态的 bean 是一种痛苦和问题的根源。

如果您在 http 会话级别处理超时会更好，而不是将此责任交给应用程序服务器（特别是因为 http 会话超时仍然相关，您只需添加另一个超时）

您可以用某种对象缓存替换有状态 bean 提供的持久状态，或者如果您愿意，您可以将 sessionid 添加到数据库并在那里跟踪您的对象状态（它可以是保存临时对象的特殊表，直到保存或例如丢弃）。

总而言之，在 Web 服务器端将事物分开、超时和临时对象，并将 ejb 用于持久性 (JPA) 和作为外观（无状态 bean）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:24:15.733

为什么在创建订单时需要评估非此即彼的情况？应该有一个按钮，上面写着：启动弹出表单的**新订单**和另一个可能来自显示“查看订单详细信息”的数据表行。设计很好。只是一些微调。

1.  您需要创建和维护一个单一的会话范围对象（称为它`Visit`），您可以在其中存储所有与会话相关的材料。我建议您坚持使用依赖于 http 会话并且可以由容器有效管理的 JSF 会话范围 bean。JSF Session Scoped bean 作为简单对象存储在 http 会话中，因此可以在 JSF 上下文之外轻松操作。然而，CDI Session Scoped bean 在 CDI 之外处理起来比较棘手。
2.  我还建议您使用动态加载的页面片段`<ui:include/>`或精细的**primefaces 向导**组件将您的订单创建过程分解为一个多步骤过程。通过多步骤创建，您需要做的就是在步骤中收集数据，并且仅当您从 DTO 的所有步骤中获得所需的所有信息时才提交事务。将向导 DTO 保留在单个会话对象中，以便容器可以在超时的情况下进行清理。如果用户从不保存或取消或离开他的办公桌，会话将自然死亡。如果他及时完成交易，他可以回来继续他的交易。不知道卡洛斯反对什么**无状态会话 bean，但根据我的经验，它们是公开业务流程的好方法，因为它们可以以其他方式公开其功能，例如 web 服务和消息目标**(JEE5)。**最重要的是，将尽可能多的业务处理从托管 bean 中保留到 EJB 和 Spring bean 等持久构造中是非常好的设计。**

# asp.net-mvc - 如何在Require.js中引用捆绑的js文件（asp.net mvc4）？

> ID：12414654
> 
> 赞同：4
> 
> 时间：2012-09-13T20:55:04.137
> 
> 标签：asp.net-mvc, requirejs, durandal, bundling-and-minification, toastr

我一直在学习约翰·帕帕关于 SPA 的复数课程。

在他的`main.js`中，他为包中包含的每个 js 库命名。

```
(function () {
var root = this;

define3rdPartyModules();

function define3rdPartyModules() {
    // These are already loaded via bundles. 
    // We define them and put them in the root object.
    define('jquery', [], function () { return root.jQuery; });
    define('ko', [], function () { return root.ko; });
    define('amplify', [], function () { return root.amplify; });
    define('infuser', [], function () { return root.infuser; });
    define('moment', [], function () { return root.moment; });
    define('sammy', [], function () { return root.Sammy; });
    define('toastr', [], function () { return root.toastr; });
    define('underscore', [], function () { return root._; });
}

})(); 
```

但是`root`这里是什么？

* * *

通过这样做，我们可以在`define`语句中调用这些短名称：

```
define('vm.session',
['ko', 'datacontext', 'config', 'router', 'messenger', 'sort'],
function (ko, datacontext, config, router, messenger, sort) { 
```

目前，我不知道该怎么做。所以我的工作`define`声明很丑：

```
define('vm.admin.outfitters',
['/Scripts/lib/jquery-1.8.1.js', '/Scripts/lib/jsrender.js', ...], function(){... 
```

我知道一定有更好的方法。所有这些 js 文件都已包含在脚本包中。如何引用这些脚本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:41:58.130

**回复：根**

RequireJS 和 AMD 就绪库从全局范围中删除对象（比如 ko）。一些插件希望它们在全局范围内，因此我们可以填充这些插件或将对象弹出回全局范围。后者是这段代码中发生的事情。主要是为 Knockout 的插件完成的。

**RE：你的定义语句**

第一个参数是模块的名称，所以你可以在那里。第二个参数是 RequireJS 知道的模块列表。第三个参数是表示它的匹配变量。所以在你的代码中你可能有这样的东西......

```
define('vm.admin.outfitters',
['jquery', 'jsrender'], function($, jsrender) { 
```

# php - 使用 .HTACCESS 重写 URL 在 php 中不起作用

> ID：12414665
> 
> 赞同：0
> 
> 时间：2012-09-13T20:55:43.557
> 
> 标签：php, .htaccess, mod-rewrite

我的网址如下所示：

```
http://127.0.0.1/website/comments.php?topic_id=16 
```

我想让它看起来像这样：

```
http://127.0.0.1/website/comments/my-news-article/16.php 
```

我已经应用了这个

```
RewriteEngine on
RewriteRule ^comments/([a-zA-Z0-9_-]+)/([0-9]+)\.php$ comments.php?id=$2 
```

我也打开`Rewrite_module`了Apache。

但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:57:30.310

始终考虑整个 URL 路径。你的包括 /website，所以：

```
RewriteEngine on
RewriteBase /website
RewriteRule ^comments/([a-zA-Z0-9_-]+)/([0-9]+)\.php$ comments.php?id=$2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T22:31:47.193

RewriteBase 用于每个目录的指令。尝试

```
重写引擎开启
重写规则 ^/website/comments/([a-zA-Z0-9_-]+)/([0-9]+)\.php$ /website/comments.php?topic_id=$2

```

为我工作。请注意，我还将行尾的查询字符串参数更改为“topic_id”。也许这是另一个错误的原因。如果仍然失败，请检查配置是否在正确的虚拟主机配置中。

# windows - 如何在 Windows 中对窗口进行子类化？（使用围棋）

> ID：12414669
> 
> 赞同：1
> 
> 时间：2012-09-13T20:55:55.830
> 
> 标签：windows, go, subclass

我想对实际窗口进行子类化以检测其大小何时发生变化。

这是我尝试使用 CallWindowProcW 和 SetWindowLongW 对其进行子类化的相关代码，但是当我最大化窗口时它没有显示任何消息，所以我认为我错误地设置了其中一些过程。怎么做？

```
var oldWindowProc uintptr

func windowProc(hwnd syscall.Handle, msg uint32, wparam, lparam uintptr) (rc uintptr) {
    switch msg {
    case WM_SIZE:
        fmt.Println("Size")
        if wparam == SIZE_MAXIMIZED {
            fmt.Println("Changed!")
        }
    default:
        return CallWindowProcW(oldWindowProc, hwnd, msg, wparam, lparam)
    }
    return 0
}

func main() {
    oldWindowProc, _ = SetWindowLongW(syscall.Stdin, GWLP_WNDPROC,
        syscall.NewCallback(windowProc))

    for {

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T22:09:12.870

我对winapi不太了解，但您的代码似乎非常类似于[包装器](https://github.com/lxn/go-winapi)的[示例](http://neolit123.blogspot.com/2012/06/first-impressions-on-go-programming.html#hcon)[`go-winapi`](https://github.com/lxn/go-winapi)

并且使用该包装器库，这个修改后的版本似乎对我有用：

（[完整代码](http://pastebin.com/MY8Q9Tpu)）

*剪断*

```
// window procedure
func WndProc(hwnd winapi.HWND, msg uint32, wparam uintptr, lparam uintptr) uintptr {
    switch msg {
    case winapi.WM_SIZE:
        if wparam == SIZE_MAXIMIZED {
            fmt.Println("Changed!")
        }
    }
    // call original procedure
    return winapi.CallWindowProc(uintptr(oldWndProc), hwnd, msg, wparam, lparam)
} 
```

我相信您可以查看该包装器库并得出更直接的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:52:30.957

你的代码说：

SetWindowLongW(syscall.Stdin, GWLP_WNDPROC, syscall.NewCallback(windowProc))

但是为什么要将 syscall.Stdin 传递给 SetWindowLongW？您不打算提供窗口句柄吗？

亚历克斯

# android - android webview 渲染显示白页

> ID：12414672
> 
> 赞同：3
> 
> 时间：2012-09-13T20:56:09.410
> 
> 标签：android, android-webview

有时，当我使用 loadUrl 加载我的 webview 时，网站不会显示，直到我触摸屏幕或滚动。

这就像我有一个 webview 绘图问题。

```
 Context context = ctx;
        final Dialog dialog = new Dialog(context);
            dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
            dialog.setContentView(R.layout.website);
            WebView webView = (WebView) dialog.findViewById(R.id.weburl);
            webView.setScrollbarFadingEnabled(false);  
            //Disable the horizontal scroll bar  
            webView.setHorizontalScrollBarEnabled(false);  
            //Enable JavaScript  
            webView.getSettings().setJavaScriptEnabled(true);  
            //Set the user agent  
            webView.getSettings().setUserAgentString("AndroidWebView");  
            //Clear the cache  
            webView.clearCache(true);  

            webView.loadUrl("http://" + WebUrl);
            webView.setWebViewClient(new WebViewClient() {
                public boolean shouldOverrideUrlLoading(WebView view, String url){
                    // do your handling codes here, which url is the requested url
                    // probably you need to open that url rather than redirect:
                    view.loadUrl(url);
                    view.setVisibility(View.VISIBLE);
                    return false; // then it is not handled by default action
               }

                @Override
                public void onPageFinished(WebView view, String url) {
                    view.refreshDrawableState();
                    Log.v("FINISH","FINISH");
                }

            }); 
```

有谁知道我为什么会遇到这种问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T16:51:17.067

您在哪个版本的 Android 上进行测试？4.1 之前的 Android 版本似乎有时会在 WebViews 上出现此类问题。

将此添加到该 Activity 的清单中以解决问题：

```
android:hardwareAccelerated="false" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-26T17:10:12.683

在`WebView`您的布局中不可见：

```
<WebView
    ...
    android:visibility="invisible"
    .../> 
```

现在，在第一次发生时将其显示回来`onPageFinished`：

```
webView.setWebViewClient(new WebViewClient() {
    @Override
    public void onPageFinished(WebView view, String url) {
        if (webView.getVisibility() != View.VISIBLE) {
            webView.setVisibility(View.VISIBLE);
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T16:28:51.240

我不确定，我没有完整的代码，但我认为与`webViewClient`此函数中的实现有关：

```
public boolean shouldOverrideUrlLoading(WebView view, String url){
    // do your handling codes here, which url is the requested url
    // probably you need to open that url rather than redirect:
    view.loadUrl(url);
    view.setVisibility(View.VISIBLE);
    return false; // then it is not handled by default action
} 
```

这是官方定义：

[public boolean shouldOverrideUrlLoading（WebView 视图，字符串 url）](http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldOverrideUrlLoading%28android.webkit.WebView,%20java.lang.String%29)

尝试使用您的代码进行测试而不实现`shouldOverrideUrlLoading`，或者制作它`return true`。

# c# - LINQ Max 扩展方法对空集合给出错误

> ID：12414674
> 
> 赞同：24
> 
> 时间：2012-09-13T20:56:27.603
> 
> 标签：c#, linq

我有以下查询：

```
var maxNumber = dbContext.Where(a => a.Id == 9).Max(a => a.Sample_Num); 
```

如果没有 9 的 Id，我会收到错误消息。如果没有 9 的 Id，我喜欢将结果默认为 0。

我试过了：

```
var maxNumber = dbContext.Where(a => a.Id == 9).Max(a => a.Sample_Num) ?? 0; 
```

以及其他变体，但无法使其正常工作

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-09-13T21:01:19.747

您可以`Any`用来检查是否有匹配的元素：

```
int maxNumber = 0;
var id9 = dbContext.Where(a => a.Id == 9);
if(id9.Any())
{
    maxNumber = id9.Max(a => a.Sample_Num);
} 
```

或者你可以使用[`DefaultIfEmpty(defaultValue)`](http://msdn.microsoft.com/en-us/library/bb355419.aspx)：

```
int maxNumber = dbContext
    .Where(a => a.Id == 9)
    .Select(a => a.Sample_Num)
    .DefaultIfEmpty(0)
    .Max(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-09-03T15:38:31.753

只需使用 Max 的可为空版本（即使聚合的值不可为空）： `var maxNumber = dbContext.Where(a => a.Id == 9).Max(a => (int?)a.Sample_Num) ?? 0;`

Nate几乎就是这么做的。关键是 Max of nullables 作为结果从空集合中给出 null，而 Max of ints 给出异常，因为它的返回值是集合的现有 int。您通过显式声明该类型的结果来强制它为 Max<int?>。然后你可以在??之后指定所需的默认值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-05T16:19:52.083

您可以尝试 MaxOrDefault 的简单实现，而无需进行任何转换。只需检查 Max 函数中的选择器参数：

```
var maxNumber = dbContext.Where(a => a.Id == 9).Max(a => a?.Sample_Num) ?? 0; 
```

# networking - Network Link Conditioner 似乎对 Lion、Mountain Lion 的网络行为没有影响

> ID：12414676
> 
> 赞同：19
> 
> 时间：2012-09-13T20:56:42.210
> 
> 标签：networking, io, osx-lion, osx-mountain-lion

Network Link Conditioner 首选项面板（从 Apple 开发者网站上的“ [Hardware IO Tools for Xcode - Late July 2012](https://developer.apple.com/downloads/index.action?name=for%20Xcode%20-) ”DMG 安装）在打开时似乎没有任何效果。这个问题的原作者报告了山狮的症状。后来的一位编辑在安装了 Xcode 4.5.1 的 Lion 上遇到了相同的症状并且缺乏预期的网络行为变化。

启用后，/var/log/system.log 显示：

```
Jan 17 17:36:14 matt-mmf-macbook [0x0-0x1d01d].com.apple.systempreferences[371]: System Preferences(371,0x10fac7000) malloc: *** auto malloc[371]: error: GC operation on unregistered thread. Thread registered implicitly. Break on auto_zone_thread_registration_error() to debug.
Jan 17 17:36:18 matt-mmf-macbook System Preferences[371]: process command (simulate) failed
Jan 17 17:36:18 matt-mmf-macbook [0x0-0x1d01d].com.apple.systempreferences[371]: _nlc_start_simulation: (os/kern) failure
Jan 17 17:36:18 matt-mmf-macbook System Preferences[371]: Starting Network Link Conditioner 
```

并且网络连接不表现出所选配置文件指定的行为。

有没有人成功地让它工作，或者弄清楚 system.log 中的错误可能意味着什么？截至 2013 年 1 月 17 日，“接受/正确”的答案不适用于所有出现症状的人。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-20T07:51:00.227

我只是有同样的问题。在 Lion 上安装了 Conditioner 窗格，更新到 Mountain Lion 后，它仍然在设置窗格中可用，但打开时没有效果。

我通过删除调节器（在设置窗格中右键单击 -> 删除“网络...”）并从硬件 IO 工具映像（2012 年 7 月下旬）重新安装它来解决这个问题。

希望它也适合你。我认为 os x 更新一定覆盖了一些东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-17T14:32:32.957

我在 Lion 上遇到了这个问题。这里的方法都不起作用。我找到了另一个名为 SpeedLimit 的工具（它是一个免费的首选项窗格），它工作正常。[http://mschrag.github.io/](http://mschrag.github.io/)

# android - 如何在Android中实现两指双击？

> ID：12414680
> 
> 赞同：7
> 
> 时间：2012-09-13T20:56:50.977
> 
> 标签：android, multi-touch, gesture, double-click

我知道如何检测双击和两指触摸事件，但我怎样才能将它们结合起来做出反应，所以有人需要用两根手指双击？

默认情况下，Android 有长按作为第二种点击形式，但我特意寻找双指双击。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-23T22:32:43.723

我想要一个简单且可重用的界面，它可以监听两个手指的双击，并且表现得像 GestureDetector。这样您就可以像这样使用它（所有剪切和粘贴可运行代码）：

```
public class Example extends Activity {
    SimpleTwoFingerDoubleTapDetector multiTouchListener = new SimpleTwoFingerDoubleTapDetector() {
        @Override
        public void onTwoFingerDoubleTap() {
            // Do what you want here, I used a Toast for demonstration
            Toast.makeText(Example.this, "Two Finger Double Tap", Toast.LENGTH_SHORT).show();
        }
    };

    // Override onCreate() and anything else you want

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if(multiTouchListener.onTouchEvent(event))
            return true;
        return super.onTouchEvent(event);
    }
} 
```

我创建了 SimpleTwoFingerDoubleTapDetector。（这是一个长名称，但它是描述性的。您可以将其重命名为您想要的任何名称。）将这个新文件保存在您的项目中或作为库：

```
public abstract class SimpleTwoFingerDoubleTapDetector {
    private static final int TIMEOUT = ViewConfiguration.getDoubleTapTimeout() + 100;
    private long mFirstDownTime = 0;
    private boolean mSeparateTouches = false;
    private byte mTwoFingerTapCount = 0;

    private void reset(long time) {
        mFirstDownTime = time;
        mSeparateTouches = false;
        mTwoFingerTapCount = 0;
    }

    public boolean onTouchEvent(MotionEvent event) {
        switch(event.getActionMasked()) {
        case MotionEvent.ACTION_DOWN:
            if(mFirstDownTime == 0 || event.getEventTime() - mFirstDownTime > TIMEOUT) 
                reset(event.getDownTime());
            break;
        case MotionEvent.ACTION_POINTER_UP:
            if(event.getPointerCount() == 2)  
                mTwoFingerTapCount++;
            else 
                mFirstDownTime = 0;
            break;
        case MotionEvent.ACTION_UP:
            if(!mSeparateTouches)
                mSeparateTouches = true;
            else if(mTwoFingerTapCount == 2 && event.getEventTime() - mFirstDownTime < TIMEOUT) {
                onTwoFingerDoubleTap();
                mFirstDownTime = 0;
                return true;
            }
        }               

        return false;
    }

    public abstract void onTwoFingerDoubleTap();
} 
```

首先，关于 Android（一键式）**GestureDetector**的一些注意事项：

*   Android 的`onDoubleTap()`事件使用来自 ViewConfiguration 的标准超时值。我指的是同一时间。
*   他们测量从第一次点击的手指向下事件到第二次点击的手指向下事件的经过时间，然后广播`onDoubleTap()`和`onDoubleTapEvent()`。
    *   `onDoubleTap()`仅在第二次点击的手指向下事件发生时触发。
    *   `onDoubleTapEvent()`在第二次点击时为每个动作触发：向下、移动和向上。

关于**SimpleTwoFingerDoubleTapDetector**的几点说明：

*   我的超时时间是从第一个手指向下事件到最后一个手指*向上*事件，以防止错误的双击通知。我为默认的 ViewConfiguration 双击超时添加了一些额外的时间来解决这个问题。
*   Android 的 GestureDetector 测量倾斜度（两个水龙头之间的距离）。我没有看到这里需要这样做，也没有检查每次点击时两个手指之间的距离。
*   我只广播一个事件`onTwoFingerDoubleTap()`。

* * *

**最后一点：** 您可以*轻松地*将其更改为像 OnTouchListener 一样：

1.  更改 SimpleTwoFingerDoubleTapDetector 的定义：

    ```
    public abstract class SimpleTwoFingerDoubleTapListener implements OnTouchListener { 
    ```

2.  添加一个新的类变量：

    ```
    private View mFirstView; 
    ```

3.  改变`ACTION_DOWN`大小写：

    ```
    case MotionEvent.ACTION_DOWN:
        if(mFirstDownTime == -1 || mFirstView != v || hasTimedOut(event.getEventTime())) {
            mFirstView = v;
            reset(event.getDownTime());
        }
        break; 
    ```

4.  通过机箱`mFirstView`内部`ACTION_UP`：

    ```
    onTwoFingerDoubleTap(mFirstView); 
    ```

5.  最后，更改`onTwoFingerDoubleTap()`方法以反映哪个视图被点击：

    ```
    public abstract void onTwoFingerDoubleTap(View v); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:56:50.977

这是我为检测两指双击而创建的双击侦听器。

使用的变量：

```
private GestureDetector gesture;
private View.OnTouchListener gestureListener;
boolean click1 = false;
boolean click2 = false;
long first = 0;
long second = 0; 
```

在活动`onCreate()`中注册触摸事件：

```
gesture = new GestureDetector(getApplicationContext(), new SimpleOnGestureListener(){
    public boolean onDown(MotionEvent event) {
        return true;
    }
});
gestureListener = new View.OnTouchListener() {
    @Override
    public boolean onTouch(View v, MotionEvent event) {
        return gesture.onTouchEvent(event);
    }
}; 
```

活动外`onCreate()`：

```
@Override
public boolean onTouchEvent(MotionEvent event) {   
    try {
        int action = event.getAction() & MotionEvent.ACTION_MASK;
        //capture the event when the user lifts their fingers, not on the down press
        //to make sure they're not long pressing
        if (action == MotionEvent.ACTION_POINTER_UP) {
            //timer to get difference between clicks
            Calendar now = Calendar.getInstance();

            //detect number of fingers, change to 1 for a single-finger double-click, 3 for a triple-finger double-click, etc.
            if (event.getPointerCount() == 2) {
                if (!click1) {
                    //if this is the first click, then there hasn't been a second
                    //click yet, also record the time
                    click1 = true;
                    click2 = false;
                    first = now.getTimeInMillis(); 
                } else if (click1) {
                    //if this is the second click, record its time 
                    click2 = true;
                    second = now.getTimeInMillis();

                    //if the difference between the 2 clicks is less than 500 ms (1/2 second)
                    //Math.abs() is used because you need to be able to detect any sequence of clicks, rather than just in pairs of two
                    //(e.g. click1 could be registered as a second click if the difference between click1 and click2 > 500 but
                    //click2 and the next click1 is < 500)
                    if (Math.abs(second-first) < 500) {

                        //do something!!!!!!

                    } else if (Math.abs(second-first) >= 500) {
                        //reset to handle more clicks
                        click1 = false;
                        click2 = false;
                    }
                }
            }
        }
    } catch (Exception e){

    }
    return true;
} 
```

# sql - PostgreSQL 中的 IF 函数与 MySQL 中一样

> ID：12414683
> 
> 赞同：14
> 
> 时间：2012-09-13T20:57:00.867
> 
> 标签：sql, postgresql, dynamic, case, plpgsql

我正在尝试将该`IF`函数从 MySQL 复制到 PostgreSQL 中。

`IF`函数的语法是`IF(condition, return_if_true, return_if_false)`

我创建了以下公式：

```
CREATE OR REPLACE FUNCTION if(boolean, anyelement, anyelement)
   RETURNS anyelement AS $$
BEGIN
    CASE WHEN ($1) THEN
    RETURN ($2);
    ELSE
    RETURN ($3);
    END CASE;
    EXCEPTION WHEN division_by_zero THEN
    RETURN ($3);
END;
$$ LANGUAGE plpgsql; 
```

它适用于大多数情况，`if(2>1, 2, 1)`但它会引发以下错误：

```
if( 5/0 > 0, 5, 0) 
```

> 致命错误除以零。

**在我的程序中，我无法检查分母，因为条件是由用户提供的。**

有什么办法吗？也许如果我们可以将第一个参数从布尔值替换为其他值，因为在这种情况下，函数将工作，因为它会引发并返回异常。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T22:06:54.223

## PostgreSQL 遵循标准

这种行为似乎是[由 SQL 标准指定的](http://archives.postgresql.org/pgsql-general/2009-07/msg01420.php)。不过，这是我第一次看到这是一个真正的问题的案例。您通常只使用`CASE`表达式或 PL/PgSQL`BEGIN ... EXCEPTION`块来处理它。

MySQL 的默认行为是危险和错误的。它只能以这种方式支持依赖此行为的旧代码。当[严格模式](http://dev.mysql.com/doc/refman/5.6/en/server-sql-mode.html)处于活动状态时（它绝对应该始终如此），它已[在较新的版本中得到修复，](http://dev.mysql.com/doc/refman/5.6/en/server-sql-mode.html#sqlmode_error_for_division_by_zero)但不幸的是尚未设为默认值。使用 MySQL 时，请始终启用或。`STRICT_TRANS_TABLES``STRICT_ALL_TABLES`

ANSI 标准的零除法有时很痛苦，但它也可以防止错误导致数据丢失。

## SQL注入警告，考虑重新设计

如果您正在执行来自用户的表达式，那么您很可能会遇到[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)问题。根据您的安全要求，您可能可以接受，但如果您不完全信任所有用户，那就太糟糕了。请记住，[您的用户可能会被诱骗从其他地方输入恶意代码](http://bobby-tables.com/)。

考虑重新设计以向用户公开表达式构建器并使用查询构建器从用户表达式创建 SQL。这将更加复杂，但安全。

如果做不到，请查看是否可以将用户输入的表达式解析为抽象语法，在执行前对其进行验证，然后根据解析的表达式生成新的 SQL 表达式。这样你至少可以限制他们可以写的东西，这样他们就不会在表达中加入任何讨厌的东西。您还可以重写表达式以添加诸如检查零除法之类的内容。为代数表达式查找（或编写）解析器可能并不难，但这取决于您需要让用户编写什么样的表达式。

至少，应用程序需要使用一个角色（“用户”），该角色仅对`SELECT`表具有权限，不是超级用户，并且不拥有表。这将最大限度地减少任何 SQL 注入将造成的危害。

## CASE 不会像写的那样解决这个问题

无论如何，由于您当前不验证并且无法检查来自用户的表达式，因此您无法使用 SQL 标准`CASE`语句来解决此问题。因为`if( a/b > 0, a, b)`你通常会写这样的东西：

```
CASE
    WHEN b = 0 THEN b
    ELSE CASE 
        WHEN a/b=0 THEN a
        ELSE b
    END
END 
```

这显式地处理了零分母的情况，但只有当您可以分解表达式时才有可能。

## 丑陋的解决方法＃1

另一种解决方案是让 Pg 返回一个占位符，而不是通过定义替换除法运算符或函数来引发被零除的异常。这只会解决被零除的情况，而不是其他情况。

我想返回`'NaN'`，因为这是合乎逻辑的结果。不幸的是，'NaN' 大于数字而不是小于，并且你想要一个小于或类似错误的结果。

```
regress=# SELECT NUMERIC 'NaN' > 0;
 ?column? 
----------
 t
(1 row) 
```

这意味着我们必须使用返回 NULL 的 icky hack 来代替：

```
CREATE OR REPLACE FUNCTION div_null_on_zero(numeric,numeric) returns numeric AS $$
VALUES (CASE WHEN $2 = 0 THEN NULL ELSE $1/$2 END)
$$ LANGUAGE 'SQL' IMMUTABLE;

CREATE OPERATOR @/@ (
    PROCEDURE = div_null_on_zero(numeric,numeric),
    LEFTARG = numeric,
    RIGHTARG = numeric
); 
```

用法：

```
regress=# SELECT 5 @/@ 0, 5 @/@ 0>0, CASE WHEN 5 @/@ 0 > 0 THEN 5 ELSE 0 END;
 ?column? | ?column? | case 
----------+----------+------
          |          |    0
(1 row) 
```

您的应用程序可以将传入表达式中的“/”重写`@/@`为您很容易选择的任何运算符名称。

这种方法有一个非常关键的问题，那就是它与没有显式括号`@/@`的表达式具有不同的优先级，`/`可能不会像您期望的那样计算。您可以通过创建一个新模式、定义一个`/`在该模式中命名的运算符来解决此问题，该运算符执行您的 null-on-error 技巧，然后`search_path`在执行用户表达式之前将该模式添加到您的。不过，这可能是个坏主意。

## 丑陋的解决方法#2

由于您无法检查分母，我所能想到的就是将整个事物包装在一个[`DO`块](http://www.postgresql.org/docs/current/static/sql-do.html)（Pg 9.0+）或 PL/PgSQL 函数中，并从表达式的评估中捕获任何异常。

[Erwin 的回答](https://stackoverflow.com/a/12414969/398670)提供了一个比我更好的例子，所以我删除了这个。无论如何，这是一件可怕而危险的事情，不要这样做。您的应用程序需要修复。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-13T21:19:40.013

使用布尔参数，除以零总是会抛出异常（这是一件好事），甚至*在*你的函数被调用之前。您对此**无能为力**。它已经发生了。

```
CREATE OR REPLACE FUNCTION if(boolean, anyelement, anyelement)
 RETURNS anyelement LANGUAGE SQL AS
$func$
SELECT CASE WHEN $1 THEN $2 ELSE $3 END
$func$; 
```

我**强烈建议不要**`if`使用以开头命名的函数。`IF`是 PL/pgSQL 中的关键字。如果您使用用 PL/pgSQL 编写的用户定义函数，这将非常混乱。

直接使用标准 SQL 表达式[**`CASE`**](http://www.postgresql.org/docs/current/interactive/functions-conditional.html#FUNCTIONS-CASE)即可。

* * *

另一种方法是接受一个**`text`参数**并使用[动态 SQL](http://www.postgresql.org/docs/current/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN)对其进行评估。

### 概念证明

你所要求的将是这样的：

```
CREATE OR REPLACE FUNCTION f_if(_expr text
                              , _true anyelement
                              , _else anyelement
                              , OUT result anyelement)
  RETURNS anyelement LANGUAGE plpgsql AS
$func$
BEGIN
   EXECUTE '
   SELECT CASE WHEN (' || _expr || ') THEN $1 ELSE $2 END' -- !! dangerous !!
   USING _true, _else
   INTO result;

   EXCEPTION WHEN division_by_zero THEN
   result := _else;
   -- possibly catch more types of exceptions ...
END
$func$; 
```

测试：

```
SELECT f_if('TRUE'   , 1, 2)  --> 1
      ,f_if('FALSE'  , 1, 2)  --> 2
      ,f_if('NULL'   , 1, 2)  --> 2
      ,f_if('1/0 > 0', 1, 2); --> 2 
```

这在不受信任的用户手中是一个很大的**安全隐患。**阅读@Craig 的回答，了解如何使其更安全。但是，我看不到它是如何做到防弹的，并且永远不会使用它。

# objective-c - NSManagedObjectContext 在后台工作

> ID：12414685
> 
> 赞同：0
> 
> 时间：2012-09-13T20:57:09.510
> 
> 标签：objective-c, core-data, core-data-migration

我在合并两个上下文之间的更改时遇到问题。其中之一是在后台（附加上下文）中作为 Web 服务读取和写入数据到数据库。当我尝试保存主上下文中的任何更改时，应用程序卡住了，什么也没发生。我创建的来自 Web 服务（单例）的上下文，如下所示。当我尝试保存主上下文时，我发送通知以将更改与 WebServices 上下文合并，但它无法正常工作。怎么了？当后台正在读取数据并且主要上下文尝试在数据库中保存某些内容时会发生这种情况。

```
managedObjectContext = [NSManagedObjectContext new];
NSPersistentStoreCoordinator *store = [ [theDelegate managedObjectContext] persistentStoreCoordinator];
[managedObjectContext setPersistentStoreCoordinator:store];
[managedObjectContext setStalenessInterval:0.0]; 
```

* * *

在保存我使用的主要上下文之前：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(mergeChanges:) name:NSManagedObjectContextDidSaveNotification object:self.managedObjectContext]; 
```

我在哪里合并更改

```
 [[[WebServie instance] managedObjectContext] mergeChangesFromContextDidSaveNotification:notification] 
```

它应该可以工作，但我不知道出了什么问题，WebServices 在后台工作，DataBaseManager 在主线程中

* * *

那是我的合并上下文的代码是错误的吗？

```
NSNotificationCenter *dnc = [NSNotificationCenter defaultCenter];
[dnc addObserverForName:NSManagedObjectContextDidSaveNotification
                 object: self.managedObjectContext queue:nil
             usingBlock:^(NSNotification *notification)
 {
     NSLog(@"merge");
     [[[WebServiceManager instance] managedObjectContext] mergeChangesFromContextDidSaveNotification:notification];

 }];

NSError *error;
NSLog(@"error");
if (![self.managedObjectContext save:&error])
{
    NSLog(@"error :%@", error);// Update to handle any error appropriately.
}
NSLog(@"after error");

[dnc removeObserver:self
               name:NSManagedObjectContextDidSaveNotification
             object:self.managedObjectContext]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:02:10.343

您需要在应该进行合并的上下文队列上进行合并。不在发送它的队列（或线程）上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:10:20.357

如果您试图保持两个上下文同步，则需要监听两个上下文的 NSManagedObjectContextDidSaveNotification，并将第一个上下文的通知合并到第二个上下文，反之亦然。所以，假设你的 applicationDelegate 上有你的上下文，你的 web 单例上有一个上下文。您将在您的 applicationDelegate 上创建一个方法，以便在单例上下文保存时触发。在该方法上，您将从单例对象获取通知并将其与主线程上下文合并。在你的单例上，你会从主线程监听 NSManagedObjectContextDidSaveNotification 并将它与单例的上下文合并。

# php - 将表单字段值传递给 PHP 文件

> ID：12414687
> 
> 赞同：2
> 
> 时间：2012-09-13T20:57:28.830
> 
> 标签：php, jquery, html

我想使用 jQuery 和 PHP 做一个动态搜索功能。我正在努力将 HTML 表单字段传递给 JQUERY 函数（然后将传递给 PHP 文件）。

我的主要问题是：

1）如何将表单“输入”字段传递给 Jquery 函数？

2) 如何在“输出”字段中获取 PHP 结果？

我目前有...（简化）

```
JQUERY:
$.get("SEARCH.php", {"_input" :  $('input[name=input]').val()},
function(returned_data) 
{
   $("input[name=output]").val(returned_data);
}

SEARCH.php:
$input = 'Welcome ' . $_GET['_input'];
echo $input;
//should be "Welcome" plus whatever I type in to "input"

HTML FORM:
input: <input type="text" name="input" value="" /> 
output: <input type="text" name="output" id="output" /> 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T21:01:11.527

**jQuery**

```
$.get("SEARCH.php", {"_input" : $('input[name=input]').val() },
function(returned_data) {
   $("input[name=output]").val( returned_data );
} 
```

**HTML**

```
input: <input type="text" name="input" value="" />
output: <input type="text" name="output" /> 
```

**PHP** 使用`echo`而不是，`return`因为它看起来您的代码不在功能中：

```
$input = $_GET['_input'];
do some parsing of the input
echo $result; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T21:01:13.007

***jQuery***

```
$.get("SEARCH.php", {"_input" : $('input[name=input]').val() },
function(returned_data) {
    $('#output').val(returned_data);
}); 
```

***PHP***

```
$input = $_GET['_input'];
do some parsing of the input
echo $result; // not return 
```

***HTML***

```
input: <input type="text" name="input" value="" />
output: <input type="text" name="result" id="output" value="" /> 
```

# r - 如何在 R 中为基因/基因组覆盖制作时间线/瀑布图

> ID：12414690
> 
> 赞同：0
> 
> 时间：2012-09-13T20:57:41.083
> 
> 标签：r, plot, ggplot2, bioinformatics, genome

我想做一个相对简单的情节（让人想起这样的时间线：http: [//www.ats.ucla.edu/stat/sas/code/timeline.gif](http://www.ats.ucla.edu/stat/sas/code/timeline.gif)），但不是x轴上的时间，它将是基因组中的碱基位置。“时间跨度”将是 DNA 序列支架的覆盖距离，显示它们在基因组中的位置、重叠位置和没有覆盖的位置的跨度。这是我正在寻找的粗略模型，显示了 rRNA 的 contig 覆盖，（我省略了，但需要一个 x 轴，显示开始和停止的位置，以及 contig 的标记（彩色线））： [http://i.imgur.com/MDABx.png](http://i.imgur.com/MDABx.png)，坐标如下：

```
Contig# Start1  Stop1   Start2  Stop2   Start3  Stop3   Start4  Stop4
1   1   90  90  100 120 150 200 400
2   1   100 120 150 200 400 NA  NA
3   1   30  90  100 120 135 200 400
4   1   100 120 140 200 400 NA  NA
5   -35 80  90  100 130 150 200 400
6   1   100 200 300 360 400 NA  NA 
```

我很确定这可以在 R 中完成，可能使用 ggplot2，但由于某种原因我无法弄清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T21:53:20.257

这不会像您的情节那样有条理，但它将线条与您尚未提供的坐标一起放入：

```
dfr <- data.frame(seg=sample(1:6, 20, replace=TRUE), start=sample(1:100, 20, replace=TRUE), end=sample(1:100,20, replace=TRUE) )
 plot(c(1,100), c(1,6), type="n")
 with(dfr, segments(y0=seg, y1=seg, x0=start, x1=end, col=2:7, lwd=3)) 
```

使用新数据集：

```
 Contig <- read.table(text=" Start1  Stop1 Start2 Stop2 Start3 Stop3 Start4 Stop4
 1   1   90  90  100 120 150 200 400
 2   1   100 120 150 200 400 NA  NA
 3   1   30  90  100 120 135 200 400
 4   1   100 120 140 200 400 NA  NA
 5   -35 80  90  100 130 150 200 400
 6   1   100 200 300 360 400 NA  NA")
 # the reshape function can be tricky.... but seems to finally work.
 reshape(Contig, direction="long", sep="",
     varying=list(Start=names(Contig)[c(1,3,5,7)],
                   Stop=names(Contig)[c(2,4,6,8)] )  )
#------------------------------
    time Start1 Stop1 id
1.1    1      1    90  1
2.1    1      1   100  2
3.1    1      1    30  3
4.1    1      1   100  4
5.1    1    -35    80  5
6.1    1      1   100  6
1.2    2     90   100  1
2.2    2    120   150  2
3.2    2     90   100  3
4.2    2    120   140  4
5.2    2     90   100  5
6.2    2    200   300  6
1.3    3    120   150  1
2.3    3    200   400  2
3.3    3    120   135  3
4.3    3    200   400  4
5.3    3    130   150  5
6.3    3    360   400  6
1.4    4    200   400  1
2.4    4     NA    NA  2
3.4    4    200   400  3
4.4    4     NA    NA  4
5.4    4    200   400  5
6.4    4     NA    NA  6
#-----------------

 LContig <- reshape(Contig, direction="long", sep="",
   varying=list(Start=names(Contig)[c(1,3,5,7)], Stop=names(Contig)[c(2,4,6,8)] )  )
 plot(range(c(Contig$Start1, Contig$Stop1) , na.rm=TRUE ), c(1,6),
            type="n", xlab="Segments", ylab="Groups")
  with(LContig, segments(y0=id, y1=id, x0=Start1, x1=Stop1, col=2:7, lwd=3)) 
```

![在此处输入图像描述](../Images/e8810d4a67df35b706c3954280148868.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T19:02:07.593

这是使用的版本`ggplot2`：

```
# Never forget
options(stringsAsFactors = FALSE)

# Load ggplot2 and reshape2
library(ggplot2)
library(reshape2)

# Read in the data
contig <- read.table(
    text = "id Start1  Stop1   Start2  Stop2   Start3  Stop3   Start4  Stop4
            1  1       90      90      100     120     150     200     400
            2  1       100     120     150     200     400     NA      NA
            3  1       30      90      100     120     135     200     400
            4  1       100     120     140     200     400     NA      NA
            5  -35     80      90      100     130     150     200     400
            6  1       100     200     300     360     400     NA      NA",
    header = TRUE
)

# Reshape it
# Melt it all the way down - each data value is gets a record
# identified by id and variable name
contig.melt <- melt(contig, id.var = "id")

# Your variable names contain two pieces of information:
# whether this point is a start or a stop, and
# which span this point is associated with.
# Much easier to work with those separately, so I'll parse them
# into variables.

# Which span?
contig.melt$span <- gsub(x = contig.melt$variable, 
                         pattern = ".*(\\d)",
                         replace = "\\1")

# Start or stop?
contig.melt$point <- gsub(x = contig.melt$variable, 
                          pattern = "(.*)\\d",
                          replace = "\\1")

# Cast it back into a dataset with a record for each span
contig.long <- dcast(contig.melt, id + span ~ point)

# Plot it. The vertical position and line colors are determined by
# the ID. I'm calling that x here, but I'll flip the coords later
ggplot(contig.long, aes(x = id, color = factor(id))) +

    # geom_linerange plots a line from Start (ymin) to stop (ymax)
    # Control the width of the plot with size
    geom_linerange(aes(ymin = Start, ymax = Stop), size = 2) +

    # Flip the coordinates
    coord_flip() +

    # Make it pretty
    scale_colour_brewer("RNA ID", palette = "Dark2") +
    labs(x = "RNA ID", y = "Position") +
    theme_bw() 
```

![ggplot2 绘图](../Images/4f6c3af9f8567ae6d611a2b5fb26e1b2.png)

# php - Codeigniter 喜欢带有变音符号的字符？

> ID：12414691
> 
> 赞同：0
> 
> 时间：2012-09-13T20:57:51.043
> 
> 标签：php, sql, codeigniter, chars

是否可以“学习”codeigniget 来识别 ľščťžýáíé 或 ĽŠČŤŽÝÁÍÉ 等字符？因为我不想让搜索对这些字符敏感。例如，如果我在我的表格行中有“Šilíoá”并且我搜索 silioa，则不会出现任何问题。但是，如果我正在寻找 silioa，它就会被找到。所以我认为问题出在Š 是否有可能学习codeigniter 来识别Š？还是Ž等？这是我的查询：

```
$q = $this->db->query("SELECT * FROM (`knihy`) 
                  WHERE `stav` = 1 
                  AND (Autor1 LIKE '$vyraz' 
                  OR Autor2 LIKE '$vyraz' 
                  OR Autor3 LIKE '$vyraz' 
                  OR Autor4 LIKE '$vyraz') 
                  ORDER BY `id` desc LIMIT $limit OFFSET $offset "); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:32:45.693

我认为这与 MySQL 比 CI 更相关。也许这会帮助你：

1.  [Php/MySql 数组搜索 ã, š, é, ë, ú, ü, í, ž](https://stackoverflow.com/questions/6081087/php-mysql-array-search-with-a-s-e-e-u-u-i-z)
2.  [从 MySql 数据库中读取 č ć đ š ž 等符号](https://stackoverflow.com/questions/5057048/reading-signs-like-c-c-d-s-z-from-mysql-database)

# .net - 为什么我的应用程序加载我的文件两次？

> ID：12414693
> 
> 赞同：0
> 
> 时间：2012-09-13T20:58:02.580
> 
> 标签：.net, vb.net, visual-studio-2010, deployment

在我的应用程序中，我有自己的自定义文件类型。我将其设置为检测应用程序是从资源管理器中打开的文件启动的，还是刚刚从程序集中打开的。一切都很好，除了当我的一个文件从应用程序外部打开时，它会像它应该的那样打开应用程序并将文件加载到我的应用程序的文本编辑器中，就像它应该的那样。除了唯一的问题是将文件加载到文本编辑器中两次。我不知道为什么。任何人都可以解释一下吗？

代码在充当表单加载的覆盖中被调用。这样做的原因是因为我的启动表单在启动时是不可见的，除了它显示通知图标以便可以完成操作，或者可以显示表单。唯一使用此代码的其他地方是在上下文菜单中单击菜单项时，尽管这会打开一个 openfiledialog，然后在对话框中打开文件。

编辑：在子中添加了其余代码。

**我找到了解决我的问题的方法，我已经用修复回答了我自己的问题。我不想感谢任何帮助过的人。另外，我要感谢 Hans Passant，因为他是这里看到的覆盖代码的作者。这允许启动表单保持不可见，同时仍然显示通知图标。**

```
 Protected Overrides Sub SetVisibleCore(ByVal value As Boolean)

    If Not Me.IsHandleCreated Then
        Me.CreateHandle()
        value = False
    End If
    MyBase.SetVisibleCore(value)
    If (Environment.GetCommandLineArgs.Length > 1) Then

        Dim s As String = Environment.GetCommandLineArgs(1)

        Using sr As New StreamReader(s)
            While Not sr.EndOfStream
                Dim item As New ListViewItem
                item.SubItems.Add(sr.ReadLine())
                ListView3.Items.Add(item)
            End While
        End Using
        For I = 0 To ListView3.Items.Count - 1
            ListView3.Items(I).Text = CStr(I)
        Next
    End If 
```

**答案可以在下面看到。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:18:49.933

它对您的问题没有帮助，但是进行一些重构，您可以避免第二个循环：

```
With ListView3.Items.Add(ListView3.Items.Count)
  .Subitems.Add(sr.ReadLine())
End With 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:04:24.747

我想出了一个解决我的问题的方法。我发现确实是代码触发了两次。最有可能与覆盖有关。不过，仍然不是 100% 确定。我创建了一个布尔值，只允许代码触发一次。现在效果很好。感谢所有试图提供帮助的人。

```
 Protected Overrides Sub SetVisibleCore(ByVal value As Boolean)
    Static blnExecuted As Boolean
    If Not Me.IsHandleCreated Then
        Me.CreateHandle()
        value = False
    End If
    MyBase.SetVisibleCore(value)
    If (Environment.GetCommandLineArgs.Length > 1) Then

        Dim s As String = Environment.GetCommandLineArgs(1)
        If blnExecuted = False Then
            blnExecuted = True
            Using sr As New StreamReader(s)
                While Not sr.EndOfStream
                    Dim item As New ListViewItem
                    item.SubItems.Add(sr.ReadLine())
                    ListView3.Items.Add(item)
                End While
            End Using
            For I = 0 To ListView3.Items.Count - 1
                ListView3.Items(I).Text = CStr(I)
            Next
        End If

    Else
        openscriptfunc()
    End If 
```

# c# - 在列表上添加新项目时奇怪的速度差异（C#）

> ID：12414703
> 
> 赞同：2
> 
> 时间：2012-09-13T20:59:01.027
> 
> 标签：c#, performance, list

我已经对 C# 中的列表进行了一些速度测试。这是我无法解释的结果。我希望有人能弄清楚发生了什么。

如果在 cloneList.Add(next) 之前调用 cloneList.RemoveAt(cloneList.Count - 1)，则 1000 次迭代的毫秒数：x 毫秒。

如果在 cloneList.Add(next) 之前未调用 cloneList.RemoveAt(cloneList.Count - 1)，则 1000 次迭代的毫秒数：至少**20x**毫秒。

似乎如果再有一条语句，我的代码会快 20 倍（请参见下面的代码）：

```
 Stopwatch stopWatch = new Stopwatch();
        Random random = new Random(100);

        TimeSpan caseOneTimeSpan = new TimeSpan();
        TimeSpan caseTwoTimeSpan = new TimeSpan();

        int len = 1000;

        List<int> myList = new List<int>();
        myList.Capacity = len + 1;

        // filling the list
        for (int i = 0; i < len; i++)
            myList.Add(random.Next(1000));

        // number of tests (1000)
        for (int i = 0; i < 1000; i++)
        {
            List<int> cloneList = myList.ToList();
            int next = random.Next();

            // case 1 - remove last item before adding the new item
            stopWatch.Start();
            cloneList.RemoveAt(cloneList.Count - 1);
            cloneList.Add(next);
            caseOneTimeSpan += stopWatch.Elapsed;

            // reset stopwatch and clone list

            stopWatch.Reset();
            cloneList = myList.ToList();

            // case 2 - add without removing
            stopWatch.Start();
            cloneList.Add(next);
            caseTwoTimeSpan += stopWatch.Elapsed;

            stopWatch.Reset();

        }

        Console.WriteLine("Case 1: " + caseOneTimeSpan.TotalMilliseconds);
        Console.WriteLine("Case 2: " + caseTwoTimeSpan.TotalMilliseconds);
        Console.WriteLine("Case 2 / Case 1: " + caseTwoTimeSpan.TotalMilliseconds / caseOneTimeSpan.TotalMilliseconds); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:03:15.050

当您将项目添加到列表时，有两种可能性：

1.  内部缓冲区足够大，可以添加另一个项目。该项目被放置在下一个空闲位置。 **速度：O(1)**（这是最常见的情况。）
2.  内部缓冲区*不够*大。创建一个新的更大的缓冲区。将旧缓冲区中的所有项目复制到新缓冲区。将下一项添加到新缓冲区。 **速度：O(n)**（这不应该经常发生）

虽然大多数`Add`调用将是 O(1)，但有些是 O(n)。

删除最后一项总是 O(1)。

由于`Add`有时取决于列表的大小，因此当列表较大时，它需要更长的时间（如果任何调用需要新的缓冲区）。如果您在添加新项目时总是删除项目，则可以确保内部缓冲区始终有足够的空间。

您可以查看 的`Capacity`属性`List`以查看内部缓冲区的当前大小并将其与 进行比较`Count`，后者是列表实际拥有的项目数。（因此`Capacity-Count`是缓冲区中空闲项目的数量。）虽然在实际程序中并不经常有用，但在调试或开发应用程序时查看这些工具可能有助于帮助您了解下面发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:08:49.410

这应该使差异消失：

```
 // reset stopwatch and clone list
        stopWatch.Reset();
        cloneList = myList.ToList();
        cloneList.Capacity = cloneList.Capacity + 1;   // add this

        // case 2 - add without removing
        stopWatch.Start();
        cloneList.Add(next);
        caseTwoTimeSpan += stopWatch.Elapsed; 
```

# math - 正确的 glsl 仿射纹理映射

> ID：12414708
> 
> 赞同：6
> 
> 时间：2012-09-13T20:59:41.603
> 
> 标签：math, opengl, glsl, texture-mapping

我正在尝试在 GLSL 中编写正确的 2D 仿射纹理映射。

解释：

![](../Images/71ab55a9ccfc9150f8360d685449e3a5.png)

...这些图像都不适用于我的目的。右（标记为正确）具有我不想要的透视校正。所以这个：[了解 Q 纹理坐标](http://home.xyzw.us/~cass/qcoord/)解决方案（没有进一步改进）不是我想要的。

我想简单地在四边形内“拉伸”纹理，如下所示：

![在此处输入图像描述](../Images/359676a3638dd1eaa6effcfe21295f23.png)

但由两个三角形组成。请问有什么建议（GLSL）吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-15T17:04:07.263

只要您有一个梯形，并且它的平行边缘与局部轴之一对齐，这就会很好地工作。我建议使用我的[Unity 包](http://forum.unity3d.com/threads/151283-Correcting-affine-texture-mapping-for-trapezoids?p=1036716#post1036716)。

GLSL：

```
varying vec2 shiftedPosition, width_height;

#ifdef VERTEX
void main() {
    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;
    shiftedPosition = gl_MultiTexCoord0.xy; // left and bottom edges zeroed.
    width_height = gl_MultiTexCoord1.xy;
}
#endif

#ifdef FRAGMENT
uniform sampler2D _MainTex;
void main() {
    gl_FragColor = texture2D(_MainTex, shiftedPosition / width_height);
}
#endif 
```

C＃：

```
// Zero out the left and bottom edges, 
// leaving a right trapezoid with two sides on the axes and a vertex at the origin.
var shiftedPositions = new Vector2[] {
    Vector2.zero,
    new Vector2(0, vertices[1].y - vertices[0].y),
    new Vector2(vertices[2].x - vertices[1].x, vertices[2].y - vertices[3].y),
    new Vector2(vertices[3].x - vertices[0].x, 0)
};
mesh.uv = shiftedPositions;

var widths_heights = new Vector2[4];
widths_heights[0].x = widths_heights[3].x = shiftedPositions[3].x;
widths_heights[1].x = widths_heights[2].x = shiftedPositions[2].x;
widths_heights[0].y = widths_heights[1].y = shiftedPositions[1].y;
widths_heights[2].y = widths_heights[3].y = shiftedPositions[2].y;
mesh.uv2 = widths_heights; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-08T08:41:07.383

我最近设法为任何类型的四边形想出了一个通用的解决方案来解决这个问题。计算和 GLSL 可能会有所帮助。在 java 中有一个工作演示（在 Android 上运行），但紧凑且可读，应该很容易移植到统一或 iOS： http: [//www.bitlush.com/posts/arbitrary-quadrilaterals-in-opengl-es- 2-0](http://www.bitlush.com/posts/arbitrary-quadrilaterals-in-opengl-es-2-0)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-19T16:00:11.930

如果有人仍然感兴趣，这是一个 C# 实现，它采用由顺时针屏幕顶点 (x0,y0) (x1,y1) ... (x3,y3) 定义的四边形， (x,y) 处的任意像素并计算该像素的 u 和 v。它最初是为 CPU 将任意四边形渲染到纹理而编写的，但很容易将算法拆分到 CPU、顶点和像素着色器；我已经在代码中进行了相应的评论。

```
 float Ax, Bx, Cx, Dx, Ay, By, Cy, Dy, A, B, C;

            //These are all uniforms for a given quad. Calculate on CPU.
            Ax = (x3 - x0) - (x2 - x1);
            Bx = (x0 - x1);
            Cx = (x2 - x1);
            Dx = x1;

            Ay = (y3 - y0) - (y2 - y1);
            By = (y0 - y1);
            Cy = (y2 - y1);
            Dy = y1;

            float ByCx_plus_AyDx_minus_BxCy_minus_AxDy = (By * Cx) + (Ay * Dx) - (Bx * Cy) - (Ax * Dy);
            float ByDx_minus_BxDy = (By * Dx) - (Bx * Dy);

            A = (Ay*Cx)-(Ax*Cy);

            //These must be calculated per-vertex, and passed through as interpolated values to the pixel-shader 
            B = (Ax * y) + ByCx_plus_AyDx_minus_BxCy_minus_AxDy - (Ay * x);
            C = (Bx * y) + ByDx_minus_BxDy - (By * x);

            //These must be calculated per-pixel using the interpolated B, C and x from the vertex shader along with some of the other uniforms.
            u = ((-B) - Mathf.Sqrt((B*B-(4.0f*A*C))))/(A*2.0f);
            v = (x - (u * Cx) - Dx)/((u*Ax)+Bx); 
```

[![CPU 渲染到纹理的算法的示例输出](../Images/1a9e7db3fe8560e07ece331eb42d554d.png)](https://i.stack.imgur.com/mF96v.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-19T13:38:45.897

镶嵌解决了这个问题。细分四边形顶点添加提示以插入像素。

看看这个链接。 [https://www.youtube.com/watch?v=8TleepxIORU&feature=youtu.be](https://www.youtube.com/watch?v=8TleepxIORU&feature=youtu.be)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-23T10:29:12.180

我有类似的问题（[https://gamedev.stackexchange.com/questions/174857/mapping-a-texture-to-a-2d-quadrilateral/174871](https://gamedev.stackexchange.com/questions/174857/mapping-a-texture-to-a-2d-quadrilateral/174871)），在gamedev他们建议使用虚构的Z坐标，我用它计算下面的 C 代码，它似乎在一般情况下工作（不仅仅是梯形）：

```
//usual euclidean distance
float distance(int ax, int ay, int bx, int by) {
  int x = ax-bx;
  int y = ay-by;
  return sqrtf((float)(x*x + y*y));
}

void gfx_quad(gfx_t *dst //destination texture, we are rendering into
             ,gfx_t *src //source texture
             ,int *quad  // quadrilateral vertices
             )
{
  int *v = quad; //quad vertices
  float z = 20.0;
  float top = distance(v[0],v[1],v[2],v[3]); //top
  float bot = distance(v[4],v[5],v[6],v[7]); //bottom
  float lft = distance(v[0],v[1],v[4],v[5]); //left
  float rgt = distance(v[2],v[3],v[6],v[7]); //right

  // By default all vertices lie on the screen plane
  float az = 1.0;
  float bz = 1.0;
  float cz = 1.0;
  float dz = 1.0;

  // Move Z from screen, if based on distance ratios.
  if (top<bot) {
    az *= top/bot;
    bz *= top/bot;
  } else {
    cz *= bot/top;
    dz *= bot/top;
  }

  if (lft<rgt) {
    az *= lft/rgt;
    cz *= lft/rgt;
  } else {
    bz *= rgt/lft;
    dz *= rgt/lft;
  }

  // draw our quad as two textured triangles
  gfx_textured(dst, src
              , v[0],v[1],az, v[2],v[3],bz, v[4],v[5],cz
              , 0.0,0.0,      1.0,0.0,      0.0,1.0);
  gfx_textured(dst, src
              , v[2],v[3],bz, v[4],v[5],cz, v[6],v[7],dz
              , 1.0,0.0,      0.0,1.0,      1.0,1.0);
} 
```

我在软件中进行缩放和旋转 2d 精灵，对于 OpenGL 3d 应用程序，您需要在像素/片段着色器中执行此操作，除非您能够将这些虚构的 az、bz、cz、dz 映射到您的实际3d 空间并使用通常的管道。DMGregory 给出了 OpenGL 着色器的准确代码：[https ://gamedev.stackexchange.com/questions/148082/how-can-i-fix-zig-zagging-uv-mapping-artifacts-on-a-generated-mesh-that-锥形](https://gamedev.stackexchange.com/questions/148082/how-can-i-fix-zig-zagging-uv-mapping-artifacts-on-a-generated-mesh-that-tapers)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-09-17T16:37:38.117

感谢您的回答，但经过实验我找到了解决方案。

![](../Images/0339e97173787f6f16202ff5ff671111.png)

左边的两个三角形根据[这个](http://www.xyzw.us/~cass/qcoord/)有 uv (strq) ，右边的两个三角形是这个透视校正的修改版本。

数字和着色器：

```
tri1 = [Vec2(-0.5, -1), Vec2(0.5, -1), Vec2(1, 1)]
tri2 = [Vec2(-0.5, -1), Vec2(1, 1), Vec2(-1, 1)]

d1 = length of top edge = 2
d2 = length of bottom edge = 1

tri1_uv = [Vec4(0, 0, 0, d2 / d1), Vec4(d2 / d1, 0, 0, d2 / d1), Vec4(1, 1, 0, 1)]
tri2_uv = [Vec4(0, 0, 0, d2 / d1), Vec4(1, 1, 0, 1), Vec4(0, 1, 0, 1)] 
```

使用此 glsl 着色器仅渲染直角三角形（左侧是固定管道）：

```
void main()
{
    gl_FragColor = texture2D(colormap, vec2(gl_TexCoord[0].x / glTexCoord[0].w, gl_TexCoord[0].y);
} 
```

所以..只有U是透视，V是线性的。

# vb.net - Visual Basic 英镑 ActiveX 错误

> ID：12414709
> 
> 赞同：1
> 
> 时间：2012-09-13T20:59:41.527
> 
> 标签：vb.net, visual-studio-2010, activex

我是 Visual Basic 的新手，我正在处理的程序有问题。我正在使用 Sterling ActiveX 库创建一个基本的功能程序，该程序为 Sterling Trader 软件执行一项简单的任务（发送订单）。我只是想制作一些基本的东西，我可以从中建立起来。到目前为止，这是我的代码：

`Imports SterlingLib`

 ```Public Class Form1

```
Dim WithEvents m_STIEvents As STIEvents

Private Declare Sub GetLocalTime Lib "kernel32" (ByRef lpSystemTime As SYSTEMTIME)

Private Structure SYSTEMTIME

    Dim wYear As Short

    Dim wMonth As Short

    Dim wDayOfWeek As Short
    Dim wDay As Short
    Dim wHour As Short
    Dim wMinute As Short
    Dim wSecond As Short
    Dim wMilliseconds As Short
End Structure

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    m_STIEvents = New STIEvents

End Sub

Private Sub m_STIEvents_OnSTIOrderUpdateMsg(ByVal oSTIOrderUpdateMsg As SterlingLib.STIOrderUpdateMsg) Handles m_STIEvents.OnSTIOrderUpdateMsg

    Dim order As STIOrder
    order = New STIOrder
    Dim storder As structSTIOrder

    storder.bstrAccount = "ACCT7"
    storder.bstrSide = "B"
    storder.bstrSymbol = "CSCO"

    order.Quantity = "500"
    storder.bstrStrPriceType = SterlingLib.STIPriceTypes.ptSTIMkt
    storder.bstrTif = "D"
    storder.bstrDestination = "NYSE"

    Dim theTime As SYSTEMTIME
    GetLocalTime(theTime)

    storder.bstrClOrderId = storder.bstrAccount & theTime.wYear & theTime.wMonth & theTime.wDay & theTime.wHour & theTime.wMinute & theTime.wSecond & theTime.wMilliseconds

    Dim ret As Integer

    ret = order.SubmitOrder

End Sub

Private Function Text1() As Object
    Throw New NotImplementedException
End Function 
````` 

``End Class``

当我运行这个程序时，我收到以下错误：“您的应用程序中发生了未处理的异常。如果单击继续，应用程序将忽略此错误并尝试继续。如果单击退出，应用程序将立即关闭。

由于以下错误，检索具有 CLSID {5E89F49B-6A12-420F-8570-E510EF1B580A} 的组件的 COM 类工厂失败：800700c1。”

这是什么意思，我该如何纠正？当我调试时，它突出显示“m_STIEvents = New STIEvents”作为出现问题的行，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:05:39.863

您可以对错误代码 0x800700c1 进行逆向工程。如果不是通过谷歌那么设计。8 使它成为一个错误。7 是“设施代码”，错误的来源，7 表示 Windows。这使得最后 4 位数字成为 Windows 错误代码。0x00c1 = 错误 193。您可以通过多种方式查找，一种是查看 Windows SDK 的 WinError.h 文件：

```
//
// MessageId: ERROR_BAD_EXE_FORMAT
//
// MessageText:
//
// %1 is not a valid Win32 application.
//
#define ERROR_BAD_EXE_FORMAT             193L 
```

在 64 位操作系统上总是生成的那种错误代码。运行 64 位代码并尝试加载旧版 32 位 ActiveX 组件。

这表明了一个简单的解决方法：在解决方案资源管理器窗口中右键单击您的 EXE 项目。属性，编译选项卡，向下滚动，高级编译选项按钮。将目标 CPU 设置更改为“x86”以强制您的 VB.NET 代码在 32 位模式下运行，以便它可以加载该 ActiveX 控件。或者，如果它已经设置为 x86，则将其更改为“AnyCPU”以处理这是一个 64 位 ActiveX 控件的奇怪机会。

如果这不起作用或您有任何其他问题，请联系组件的供应商。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T04:10:02.417

不知道你有没有解决这个问题。我解决它的方法是在我的电脑上安装 vb6。我尝试了所有其他方法，但没有一个有效。这个 API 已经很老了。安装 vb6 解决了我的问题。此外，如果您希望程序正常运行，您必须登录 sterling trader pro。祝你好运。`

# jquery - Jquery 问题：为什么我的警报会被多次触发？

> ID：12414713
> 
> 赞同：0
> 
> 时间：2012-09-13T20:59:51.207
> 
> 标签：jquery

下面的代码需要一个 div 并在点击时移动它。返回按钮将 div 移回原来的位置。第二个警报有时会多次触发。有人可以解释为什么吗？

```
<html>
        <head>
            <script src="js/jquery.js"></script>
            <style>

            .profile {

                width: 250px;
                height: 250px;
                margin-top: 250px;
                margin-left: 250px;
                border: solid black 1px;
            }

        </style>

        </head>
        <body>
        <script>

            $(document).ready(function(){

                $('.profile').click(function(){

                                    // store current position
                    var activeProfile = $(this);
                    var profilePosition = activeProfile.offset();
                    var initialLeft = profilePosition.left;
                    var initialTop = profilePosition.top;

                    alert(initialLeft);

                    $(this).css({'position' : 'absolute', 'top' : 0, 'left' : 0, 'margin': 0});

                            // return to original start position
                        $('#close').click(function(e) {
                        alert('sometimes i get triggered multiple times!');
                        activeProfile.css({'left' : initialLeft, 'top' : initialTop});
                        e.stopPropagation();

                     });    

                });

            })

        </script>

            <div class="profile">
                <button id="close">Return</button>
            </div>

        </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:06:42.910

每次`.profile`单击时，您都会向`#close`. 然后，一旦`#close`单击，所有这些处理程序都会触发。如果您单击`.profile`3 次，则会打开三个单击处理程序，`#close`并且所有三个都会触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:02:48.293

看起来罪魁祸首是每次单击 .profile 类时，它都会将一个事件关联到 #close .. 因此，如果您单击两次它会绑定两次.. 所以您需要取消绑定并再次关联才能看到警报一次..

```
 $(document).ready(function () {

    $('.profile').on('click', function () {

        // store current position
        var activeProfile = $(this);
        var profilePosition = activeProfile.offset();
        var initialLeft = profilePosition.left;
        var initialTop = profilePosition.top;

        alert(initialLeft);

        $(this).css({
            'position': 'absolute',
            'top': 0,
            'left': 0,
            'margin': 0
        });

        // return to original start position
        $('#close').unbind().on('click', function (e) {
            alert('sometimes i get triggered multiple times!');
            activeProfile.css({
                'left': initialLeft,
                'top': initialTop
            });
            e.stopPropagation();

        });

    });

}) 
```

这是旧代码的[FIDDLE](http://jsfiddle.net/sushanth009/k2nj4/)

这是带有与之关联的取消绑定事件的[UPDATE FIDDLE ..](http://jsfiddle.net/sushanth009/k2nj4/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:01:06.260

1.您的页面上可能有多个`.profile`元素，它们可能相互嵌套？

```
--profile

----profile (so a click here would bubble up and trigger two handlers) 
```

2.绑定的代码不知何故被调用了两次？（在问题中不可见，但只是猜测，因为它很有可能）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T21:04:31.787

我已经修改了你的部分代码

```
// return to original start position
$('#close').click(function(e) {
     e.preventDefault();
     alert('sometimes i get triggered multiple times!');
     activeProfile.css({'left' : initialLeft, 'top' : initialTop});
     e.stopPropagation();
}); 
```

# c# - 是否必须安装 ASP.NET 框架才能在 vb.net 控制台应用程序上运行？

> ID：12414716
> 
> 赞同：1
> 
> 时间：2012-09-13T21:00:05.630
> 
> 标签：c#, asp.net, .net, vb.net, console-application

问题，我需要跨多个服务器运行 vb.net 控制台应用程序。我想知道是否需要在每个资产上安装 ASP.NET 框架才能运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:02:04.953

不，不需要 ASP.NET。但是，需要在应该运行应用程序的计算机上安装适当版本的 .NET Framework。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T10:31:22.030

我认为您对术语/技术的理解略有偏差：-

ASP.NET 是一个 Web 应用程序框架（[更多信息在这里](http://en.wikipedia.org/wiki/ASP.NET)）。为了运行提供 ASP.NET 页面的*Web 服务器*，您需要在*Web 服务器机器*上安装 .NET 框架。连接到 Web 服务器的客户端不需要安装 .NET Framework，因为它们只使用 Web 浏览器。

如果您想在任何机器上运行*控制台应用程序*，则该机器需要安装 .NET 框架。

如果控制台应用程序或 Web 应用程序是用 C# 或 VB.NET 编写的，则没有区别，同样的规则仍然适用。

# ios - iOS 6 流媒体播放器 com.apple.coremedia.networkbuffering 错误

> ID：12414717
> 
> 赞同：17
> 
> 时间：2012-09-13T21:00:12.430
> 
> 标签：ios, streaming, ios-simulator, mpmovieplayercontroller, ios6

我无法让我的应用程序（音乐和视频流播放器）在 iOS 6 模拟器上运行。

当我开始播放音乐或视频时，它崩溃并在此线程上显示错误：com.apple.coremedia.networkbuffering

这在日志信息中：

```
2012-09-13 17:45:09.260 app[32563:c07] [MPAVController] Autoplay: Disabling autoplay for pause
2012-09-13 17:45:09.260 app[32563:c07] [MPAVController] Autoplay: Disabling autoplay
2012-09-13 17:45:09.305 app[32563:c07] [MPAVController] Autoplay: Enabling autoplay
2012-09-13 17:45:09.307 app[32563:c07] handlePlaybackNowPlayingNotification
2012-09-13 17:45:09.308 app[32563:c07] [MPAVController] Autoplay: Likely to keep up or full buffer: 0
2012-09-13 17:45:09.308 app[32563:c07] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.
2012-09-13 17:45:09.318 app[32563:c07] [MPAVController] Autoplay: Enabling autoplay
2012-09-13 17:45:09.320 app[32563:c07] [MPCloudAssetDownloadController] Prioritization requested for media item ID: 0 
```

我正在将 MPMoviePlayerController 与基于 http 的流一起使用，它在 iOS 4 或 iOS 5 上运行良好

关于如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-17T09:52:00.123

我遇到了完全相同的问题...

在实例化播放器后尝试这样做：

```
[player prepareToPlay]; 
```

它应该在您调用 play 时自动调用，但显然在 iOS 6 上，如果您不明确调用它，就会出现问题。

就我而言，它解决了问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-20T13:43:46.577

您所观察到的不是崩溃，而是异常。您很可能启用了异常断点，这导致您假设应用程序崩溃。

该异常实际上由 SDK 正确处理（捕获）并且不会导致应用程序崩溃。

请注意，这只发生在模拟器上，而不是设备上。

该问题与此问题密切相关[what-does-this-gdb-output-mean](https://stackoverflow.com/questions/7961840/what-does-this-gdb-output-mean/8317546#8317546)。不同之处在于您不会再收到这些错误消息，但仍然会抛出异常（但也会咳嗽）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-21T22:43:39.667

我已经使用 xcode 4.5+SDK6.0 与 xcode 4.4.1+SDK5.1 组合验证了 iOS 6 版本的 MPMoviePlayerController 存在问题。我只使用过 iPad。

以下是我的观察：- - 我从未使用我的使用 MPMoviePlayerController 的代码在 ios 6.0 上看到视频播放。- 使用 xcode 4.4.1 和 SDK 5.1，我已经看到代码在 ios 版本 5.1、5.0 和 4.3 上工作。- 使用 xcode 4.5 和 SDK 6.0，播放器在模拟器中总是失败，但大多数在 ios 5.1 设备上的安装工作。我一直在 ios 5.1 设备上重新安装应用程序并试用播放器。它只失败了一次。

以下是我在播放器失败时的观察结果： - 有时播放器失败时，我看到了您上面提到的日志。其他时候，我什至没有看到日志。- 我在获得 MPMoviePlayerPlaybackDidFinishNotification 通知的函数中放置了一个断点。然后我在播放器中寻找errorLog，但没有。我查找了 MPMoviePlayerPlaybackDidFinishReasonUserInfoKey，它是 0 (MPMovieFinishReasonPlaybackEnded)。所以 MPMoviePlayerController 不知道出了什么问题！

结论：ios6 和/或 SDK 6 有一个错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-21T09:16:23.363

```
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"sample" ofType:@"mp4"]];
MPMoviePlayerViewController  *moviePlayer = [[MPMoviePlayerViewController alloc] initWithContentURL:url];

moviePlayer.view.frame = self.view.frame;
moviePlayer.moviePlayer.shouldAutoplay=YES;
moviePlayer.moviePlayer.controlStyle = MPMovieControlStyleNone;
[moviePlayer.moviePlayer setFullscreen:YES animated:YES];
[self.view addSubview:moviePlayer.view];
[moviePlayer.moviePlayer play]; 
```

注意：iOS 6之前，无需调用[moviePlayer.movi​​ePlayer play]；一旦您将播放器视图添加到视图中，它将开始播放，但在 iOS 6 中，您需要显式调用播放函数

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-24T09:57:45.987

我对 ios6 的 MPMoviePlayerController 有同样的问题。所以我将我的代码更改为流动，现在它工作正常..

```
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"sample" ofType:@"mp4"]];
MPMoviePlayerViewController  *moviePlayer = [[MPMoviePlayerViewController alloc] initWithContentURL:url];

moviePlayer.view.frame = self.view.frame;
moviePlayer.moviePlayer.shouldAutoplay=YES;
moviePlayer.moviePlayer.controlStyle = MPMovieControlStyleNone;
[moviePlayer.moviePlayer setFullscreen:YES animated:YES];
[self.view addSubview:moviePlayer.view];
[moviePlayer.moviePlayer play]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-23T10:50:24.307

我还没有解决这个问题，但在我的特殊情况下，它似乎与何时`MPMoviePlayerController`进入全屏或控制器存在潜在延迟有关。

我不是从网络流式传输内容，内容在设备上，所以最初内容在视图中显示良好。

我的猜测是他们已经实现了一项新功能`MPMoviePlayerController`，以防止播放期间出现“死区时间”。我见过一些应用程序会在电影数据离线或您碰巧走出 wifi 范围时挂起”

我解决此问题的尝试是查看传递给的通知消息 -

```
(void)moviePlayBackDidFinish: (NSNotification*)notification 
```

这是通过查询用户信息字典来完成的

```
NSDictionary *userInfo = [notification userInfo]; 
```

`MPMoviePlayerPlaybackDidFinishReasonUserInfoKey`在此类故障的情况下，的值为0。

这是一个起点。我的想法是在这个独特的失败点上恢复这部电影。

我会及时通知你结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-20T13:17:35.050

首先我做了类似下面的事情

```
[self.player.moviePlayer prepareToPlay];
[self.player.moviePlayer play];
self.player.moviePlayer.shouldAutoplay = YES; 
```

当我删除以下行时

```
self.player.moviePlayer.shouldAutoplay = YES; 
```

问题解决了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-05T18:10:44.363

我对下面的代码有问题，播放器全屏显示，但在那之后，它关闭并且根本不播放视频。

NSURL *url = [NSURL URLWithString:@" [http://streaming.disponivel.uol.com.br/video360p2/288148-1192657.mp4](http://streaming.disponivel.uol.com.br/video360p2/288148-1192657.mp4) "];

```
 _player = [[MPMoviePlayerViewController alloc] initWithContentURL:url];

    [_player.moviePlayer setMovieSourceType:MPMovieSourceTypeFile];

    [_player.moviePlayer setControlStyle:MPMovieControlStyleDefault];

    [_player.moviePlayer setFullscreen:YES animated:YES];      

    [self presentMoviePlayerViewControllerAnimated:_player];

    [_player.moviePlayer prepareToPlay];

    [_player.moviePlayer play]; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-25T13:02:11.110

我还使用`MPMoviePlayerViewController`来在我的应用程序上显示实时视频，并且我得到了与上面相同的错误列表。我发现它`MPMoviePlayer`不支持较大的数据来显示视频，但是如果您使用较小的视频数据，它可以正常工作，不会出错。其实这不是准备播放和播放电影播放器​​属性的问题。

如果您需要显示更大的数据，请在您的应用程序上使用 webview。

# c# - 无法订阅使用 dday.ical 创建的 webcal 提要

> ID：12414721
> 
> 赞同：2
> 
> 时间：2012-09-13T21:00:36.170
> 
> 标签：c#, asp.net-mvc-3, outlook, icalendar, outlook-2010

我一直忙于为我的网站创建用户可以订阅的 iCal 提要。经过一些初步的麻烦后，我找到了[http://nerddinner.codeplex.com/](http://nerddinner.codeplex.com/)，它的功能正是我想要的。下载源代码，根据自己的喜好修改，完成。我现在可以创建一个链接来下载动态创建的 iCal 文件。它可以通过outlook打开，一切似乎都很好。

除了：当我尝试创建日历提要而不是下载 .ics 文件时，Outlook 告诉我它不是有效的日历文件。

我已将 iCal 文件的链接创建为：

```
<a href="webcal://mnelab.3me.tudelft.nl/MyLab/iCalFeed/B928B195-BCC5-4014-AD23-6002B3880A6B/EquipmentBookings">feed</a> 
```

（我使用 RiaLibrary.Web.dll 来创建“花哨”的 Url。）

当我单击该链接时，我的浏览器会询问我是否要使用 Outlook 打开提要。然后当我单击“Lauch 应用程序”时，Outlook 会询问我是否要订阅该提要。我单击是，outlook 告诉文件“EquipmentBookings”不是有效的 Internet 日历文件。

当我将地址复制粘贴到浏览器中并用“http”替换“webcal”时，文件下载得很好，并且在 Outlook 中打开也一样好。

生成的ics文件内容如下图：

```
BEGIN:VCALENDAR
VERSION:2.0
METHOD:PUBLISH
PRODID:-//ddaysoftware.com//NONSGML DDay.iCal 1.0//EN
BEGIN:VEVENT
DTEND:20120810T120000
DTSTAMP:20120913T222252
DTSTART:20120810T090000
LOCATION:AFM Lab
SEQUENCE:0
SUMMARY:Nanosurf easyScan 2 STM
UID:2bed0b80-fb1d-4539-b171-063287dad4a2
END:VEVENT
BEGIN:VEVENT
DTEND:20120814T130000
DTSTAMP:20120913T222252
DTSTART:20120814T090000
LOCATION:AFM Lab
SEQUENCE:0
SUMMARY:Nanosurf easyScan 2 STM
UID:15d39ada-f80f-4b95-959d-a60937bb7a85
END:VEVENT
END:VCALENDAR 
```

[我用http://severinghaus.org/projects/icv/](http://severinghaus.org/projects/icv/)验证了它们，一切似乎都很好。这是可以预料的，因为该文件在 Outlook 中打开时没有错误。它只是不被接受为提要。

有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-09T21:12:54.537

事实证明这是一个非常非常糟糕的身份验证问题。控制器类上有一个 [Authorize] 属性。我不知道我怎么看不到。不管怎样，现在已经修好了。

# mysql - MySQL Workbench 列选项卡已停用

> ID：12414723
> 
> 赞同：3
> 
> 时间：2012-09-13T21:00:40.980
> 
> 标签：mysql, mysql-workbench

我正在尝试在 MySQL Workbench 中添加一个新表，但我不能，因为列选项卡已停用。

![在此处输入图像描述](../Images/12d11b55bba1341689f6c6fe37bec0af.png)

你知道发生了什么吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-11-01T22:00:52.037

只需将整个下部标签向上拉一点，您就会看到输入列的位置。

# svn - 将子文件夹移出 svn 1.7 wc，视为新 wc

> ID：12414725
> 
> 赞同：0
> 
> 时间：2012-09-13T21:00:55.060
> 
> 标签：svn, tortoisesvn

在 svn 1.7 中实现 WC-NG 之前，我可以简单地将一个子文件夹拖出其父文件夹并将其视为一个完全独立的 wc。在 1.7 之后，我很难找到一种简单的方法来执行此操作。我也找不到其他人似乎像我一样关心它。

inb4 '只需检查一个新的厕所'。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:24:49.790

发生这种情况是因为每个版本化文件夹内部都有一个 .svn 隐藏文件夹。此功能在 TortoiseSVN 1.7 中被删除，只有工作副本的根目录有 .svn 文件夹。这会使您拖出的子文件夹被 TortoiseSVN 视为未版本化。

顺便说一句，将子文件夹拖出父文件夹可能被认为是一种不好的做法，因为您可能会在此过程中危及工作副本的完整性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T15:50:32.100

Export a subfolder to an outside location. It will make a copy of all versioned files. Then do a checkout from svn source to that folder. Torotoisesvn will version all existing files and add/remove new ones. And the last step. It may happen that someone make changes to a code inside that svn subtree in the period of time between original wc revision and new sub-wc revision. In such case tortoisvn will show as you have modified files back to original wc revision. You just need to revert all these changes.

It's the only way of doing such sub-wc I know of. For a large code base it saves a lot of network traffic and time.

# java - 返回 Map 中的所有匹配值

> ID：12414729
> 
> 赞同：0
> 
> 时间：2012-09-13T21:01:13.927
> 
> 标签：java

我有地图，其中每个键都是一个字符串。

要访问一个值，我可以`.get`使用`Map`. 如果我想返回与键匹配的任何内容，例如：`"one, onetwo, onetwothree"`，获取包含字符串的所有值，`"two"`因此在这种情况下返回`"onetwo, onetwothree"`。这可能使用 a`Map`吗？

我目前使用一个列表并遍历每个字符串并检查字符串是否包含我正在搜索的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:05:56.127

`Map`任何类（afaik）都没有这种方法。您可以迭代键然后检查片段的包含，或使用完全不同的数据结构。我猜一个[trie](http://en.wikipedia.org/wiki/Trie) -map 会做到这一点。

* * *

编辑：
您目前所做的应该适用于所有情况的 99%。如果您要处理大量数据，请使用[全文索引](http://en.wikipedia.org/wiki/Full_text_search)。（这可以用[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)来完成）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:07:22.283

使用 a`HashMap`您将必须遍历所有键，并且一旦键与您的模式匹配，然后收集该值并继续执行直到完成。
使用 a`TreeMap`您可以按排序顺序获取键，因此您可以使用此属性进行更有效的搜索。
但我认为你应该切换到不同的数据结构。A `trie`as @zeller 还指出似乎做你想做的事

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:21:17.987

正如其他人所说，java集合API中没有方法可以实现这一点。这就是你如何通过迭代地图的键来做到这一点

```
 HashMap<String, String> map = new HashMap<String, String>();
    map.put("onesample", "1");
    map.put("onetwo", "2");
    map.put("onetwothree", "3");

    for(Entry<String, String> en: map.entrySet()) {
        if(en.getKey().contains("two")){
            System.out.println(en.getKey());
        }
    }
} 
```

# paypal - Ruby - 用于更新运费的 PayPal 即时更新回调 API

> ID：12414731
> 
> 赞同：1
> 
> 时间：2012-09-13T21:01:21.147
> 
> 标签：paypal

当用户在 PayPal 上更改地址时，PayPal 会向您的服务器发出 AJAX 调用以获取新的运费。我们的服务器从 PayPal 获取请求。我有这个工作。我的困境是“我该怎么做”和“我在哪里”将新的运费发送回 PayPal？API 没有说明如何将其发回。在 POST 中？在 GET 中？在渲染中？我尝试了渲染：文本并将其以字符串“METHOD=CallbackResponseOFFERINSURANCEOPTION=falseL_SHIPPINGOPTIONNAME0=UPS AirL_SHIPPINGOPTIONLABEL0=UPS Next Day Air FreightL_SHIPPINGOPTIONAMOUNT0=20.00&L_TAXAMT0=2.20&L_INSURANCEAMOUNT0=1.51L_SHIPPINGOPTIONISDEFAULT0=true”的形式发送。我正在使用没有运费回调方法的 Active Merchant Gem。当我尝试创建一个类似的方法来发送到沙箱 PayPal URL 时，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T05:43:15.973

使用回调 API 时，您充当 Web 服务，因此您只需确保您的脚本输出 NVP 响应，就像您展示的示例一样。

您可以调用您的运输承运商 API 等，为此您将进行 POST 调用，但是一旦您编译了该数据，您只需生成 NVP 字符串并将其回显到屏幕上。

当您运行该脚本时，您只希望输出 NVP 字符串，就像您在使用 NVP Web 服务并向其发布请求时收到的内容一样。你只是在另一端，所以你正在生成 NVP 响应。

不过，我会说，根据我的经验，回调系统不是很可靠。您可以将其设置为 6 秒的最长时间，这还不足以从 PayPal 接收数据、点击 3rd 方 API、生成结果并将其发送回 PayPal。它实际上只适用于非常简单的运输服务。否则，它会超时并默认为您使用 SetExpressCheckout 发送的运输选项。

希望这有用。

# ruby-on-rails - Rails 设计用户都属于_to 和 has_many

> ID：12414732
> 
> 赞同：0
> 
> 时间：2012-09-13T21:01:24.610
> 
> 标签：ruby-on-rails, ruby, associations, has-and-belongs-to-many

在花了几天的时间试图在网上找到答案后，我想我应该寻求帮助。我试图找出使用 Rails 关联来实现这些关系的最佳方法。

我有 4 个模型：`User`、`Transfer`和。`Building``Bag`

A`User`有一个`role`属性。`role`的可能值为`'admin'`和。`'building_contact'``'guest'`

这就是它在树形结构中的样子。,`Admin`和是 a 的`Guest`作用：`BuildingContact``@user`

```
           行政
             |
         转移
        / \
     贵宾楼
       | |
      包包建设联系方式

```

所以：

`Admin has_many :transfers`
`Transfer belongs_to :admin`

`Transfer has_many :guests`
`Guest belongs_to :transfer`
`Guest has_many :bags`

`Transfer belongs_to :building`
`Building has_many :transfers`
`Building has_many :building_contacts`

**实现与模型的关系的最佳方式是什么`User`？**

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:27:04.220

我想问的基本问题之一是：

一个用户会有多个角色吗？我猜不是，因为您只有一个角色属性。他们可能共享很多东西，但我想说不同用户类型的业务逻辑会创建不同的模型。放弃该角色属性并使用类型属性并使用 STI 怎么样？

```
class Admin < User; end
class Guest < User; end
class BuildingContact < User; end 
```

这样，您将拥有继承的用户功能，但您可以在适当的情况下定义不同的业务逻辑。您可以将其扩展到不同的控制器和视图，否则我认为您可能会冒着拥有比您想要的更大的 User 类的风险。

# c# - 当我期待 3 时只得到一场比赛

> ID：12414735
> 
> 赞同：2
> 
> 时间：2012-09-13T21:01:36.843
> 
> 标签：c#, regex, visual-studio-2010

在 C#，VS 2010 中使用正则表达式。这是代码。

```
static string capturePattern = @"\|([!-|]{2})([!-|]{2})([!-|]{2})?([!-|]{2})?([!-|]{2})?([!-|]{2})?([!-|]{2})?\|";

Regex rgx = new Regex(capturePattern);

string TS="!3829.87N/12033.82Wv169/000|!('d%*|"

MatchCollection matches = rgx.Matches(TS); 
```

matches.Count 最终为 1，matches[0] 为“|!('d%*|”。

我期待matches.Count为3，解析字符串为：

```
matches[0] = "!("
matches[1] = "'d"
matches[2] = "%*" 
```

我做错什么了？

查克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:14:50.610

您的正则表达式将条形之间的所有内容捕获`|`到一个匹配中。如果你想要括号中的部分，那些在`match[0].Groups`.

`Group[0]`是整个捕获组。第 1 组、第 2 组以及可选的第 3 组和更多组将成为括号中的字符对。

在您的情况下，matches.Count 将为 1，matches[0].Groups.Count 将为 4，其中：

```
matches[0].Group[1] == "!(" 
matches[0].Group[2] == "'d" 
matches[0].Group[3] == "%*" 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T21:04:01.680

[regexPlanet](http://www.regexplanet.com/advanced/java/index.html)是你的朋友，在那里测试你的表达。

# wpf - 选择性地允许编辑 XamDataGrid 单元格

> ID：12414741
> 
> 赞同：2
> 
> 时间：2012-09-13T21:02:36.607
> 
> 标签：wpf, binding, infragistics, xamdatagrid

我有一种情况，我将 XamDataGrid 的 DataSource 设置为 ViewModel 列表。因此，我的 XamDataGrid 预计会有多行。我想将给定单元格的可编辑性绑定到单元格视图模型上的属性。我最初的想法是将字段的 AllowEdit 属性绑定到 ViewModel（这对除了 Infragistics 之外的任何人都有意义），但这不起作用。我怎样才能做到这一点？

如果可能的话，我想通过绑定来实现这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T17:31:33.557

对于编辑编辑模式的逐个单元格控制，当您不想允许编辑时，必须处理 EditModeStarting 事件并将 e.Cancel 设置为 true。如果您只想通过绑定来做到这一点，那么您可能会使用行为并将逻辑放入行为中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-20T13:56:28.890

一段时间后我会回到这个问题，但我已经在其他地方实施了解决方案。好消息是，在 Infragistics 2014 及更高版本中，您可以使用[`FieldBinding`](http://help.infragistics.com/Help/Doc/WPF/2014.2/CLR4.0/html/xamDataPresenter_Binding_Field_FieldLayout_to_MVVM.html). 如果这不可用，则使用 Freezable 查看绑定代理，如此[处](http://www.thomaslevesque.com/2011/03/21/wpf-how-to-bind-to-data-when-the-datacontext-is-not-inherited/)所述。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-02T08:45:00.910

将网格级别的 AllowEdit 设置为 True

```
<igDP:FieldSettings AllowEdit="True"/> 
```

并为不允许编辑的列设置属性 Readonly true

```
[ReadOnly(true)]
public string Name{ get; set; } 
```

如果您已移至 4.0，则可以使用“EditableAttribute”

```
[EditableAttribute(AllowEdit ="False")]
public string Name{ get; set; } 
```

# vim - 将回显或注册内容发送到 mac os x 上的 pbcopy / mac 剪贴板

> ID：12414745
> 
> 赞同：5
> 
> 时间：2012-09-13T21:02:55.423
> 
> 标签：vim, pbcopy

我在 vimscript 中有一个自定义函数，它创建一个字符串，然后将其回显到底部控制台。目前，我使用 cmd-c 复制并粘贴该输出以将其复制到 mac os x 剪贴板。我想通过将 echo 管道传输到 pbcopy 来缩短此工作流程，我尝试过：

```
:echo "hello" <BAR> !pbcopy 
```

但这当然行不通。我还尝试将输出捕获到寄存器中，然后将其输出：

```
:@a!pbcopy 
```

但它只是尝试执行存储在@a 中的字符串，这不是vim 命令。我觉得这应该是直截了当的，谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T22:57:07.743

Assuming `pbcopy` takes its input from `stdin` you could try using `system()`

```
:call system('pbcopy', 'hello')
:call system('pbcopy', @a) 
```

For more information see

```
:h system() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T21:13:29.710

你用的是什么版本的 Vim？在任何合理的最新版本（通过 Mac Ports/Homebrew 或更好的 MacVim 安装）中，一个简单的

```
let @*="text" 
```

将放在`text`剪贴板上。

见`:h clipboard`。

# c - 返回局部变量行为的地址

> ID：12414746
> 
> 赞同：0
> 
> 时间：2012-09-13T21:02:58.823
> 
> 标签：c, pointers, scope, undefined-behavior, local-variables

> **可能重复：**
> [可以在其范围之外访问局部变量的内存吗？](https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope)

输入：

```
#include <stdlib.h>
#include <stdio.h>
int func2(void);
int* func1(void);

int func2(void)
{
    int* b;
    b = func1();
    printf("%d", *b);
    printf("%d", *b);
    printf("%d", *b);
}

int* func1()
{
    int a = 13;
    return &a;
}

int main()
{
    func2();
} 
```

输出：

```
13 -1077824828 -1077824828 
```

有人可以解释堆栈和操作系统中发生了什么吗？为什么得到指针的值后结果从 13 变成垃圾？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:06:15.920

当然。调试和发布（干净）的结果会有所不同。如果您查看程序集，则局部变量是 EBP-（一些偏移量）。这意味着，更高的堆栈，如“进一步”。

这是您返回的地址。

通常，如果函数只是返回，它将保持不变。在某些编译器的调试版本中，它会被故意丢弃以帮助您更快地捕获悬空指针错误。现在， printf 调用重用堆栈中的相同地址来传递参数和它自己的局部变量（它有一些）。它们将被写入 func1 return 清空的地址，从而覆盖您获得的地址所指向的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:05:57.580

调用 printf 会创建一个新的堆栈帧，它会覆盖之前由`a`.

# sql - PostgreSQL 中是否有类似 zip() 函数的东西，它结合了两个数组？

> ID：12414750
> 
> 赞同：28
> 
> 时间：2012-09-13T21:03:17.627
> 
> 标签：sql, arrays, postgresql

我在 PostgreSQL 中有两个长度相同的数组值：

`{a,b,c}`和`{d,e,f}`

我想把它们组合成

`{{a,d},{b,e},{c,f}}`

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-13T21:14:12.313

## Postgres 9.5 或更高版本

有[**`array_agg(array expression)`**](https://www.postgresql.org/docs/current/functions-aggregate.html#id-1.5.8.27.5.2.4.1.1.1.1)：

> `array_agg`( `anyarray`) →`anyarray`
> 
> 将所有输入数组连接成一个更高维度的数组。（输入必须具有相同的维度，并且不能为空或 null。）

`array_agg_mult()`这是下面演示的我的自定义聚合函数的直接替换。它是用 C 语言实现的，而且速度要快得多。用它。

## Postgres 9.4

使用将多个数组并行取消嵌套的`ROWS FROM`构造或更新。`unnest()`每个都可以有不同的长度。你得到（[根据文档](https://www.postgresql.org/docs/9.4/queries-table-expressions.html#QUERIES-TABLEFUNCTIONS)）：

> [...] 在这种情况下，结果行数是最大函数结果的行数，较小的结果用空值填充以匹配。

使用这个更简洁的变体：

```
SELECT ARRAY[a,b] AS ab
FROM   unnest('{a,b,c}'::text[] 
            , '{d,e,f}'::text[]) x(a,b); 
```

## Postgres 9.3 或更高版本

### 简单的 zip()

考虑以下 Postgres **9.3 或更早版本**的演示：

```
SELECT ARRAY[a,b] AS ab
FROM  (
   SELECT unnest('{a,b,c}'::text[]) AS a
        , unnest('{d,e,f}'::text[]) AS b
    ) x; 
```

结果：

```
 ab
-------
 {a,d}
 {b,e}
 {c,f} 
```

请注意，两个数组必须具有**相同数量的元素**才能并行取消嵌套，否则您将获得交叉连接。

如果您愿意，可以将其包装成一个函数：

```
CREATE OR REPLACE FUNCTION zip(anyarray, anyarray)
  RETURNS SETOF anyarray LANGUAGE SQL AS
$func$
SELECT ARRAY[a,b] FROM (SELECT unnest($1) AS a, unnest($2) AS b) x;
$func$; 
```

称呼：

```
SELECT zip('{a,b,c}'::text[],'{d,e,f}'::text[]); 
```

结果相同。

### zip() 到多维数组：

现在，如果你想将一组新数组**聚合**成一个**二维**数组，它会变得更加复杂。

```
~~SELECT ARRAY (SELECT ...)~~
```

或者：

```
~~SELECT array_agg(ARRAY[a,b]) AS ab
FROM  (
   SELECT unnest('{a,b,c}'::text[]) AS a
         ,unnest('{d,e,f}'::text[]) AS b
    ) x~~
```

或者：

```
~~SELECT array_agg(ARRAY[ARRAY[a,b]]) AS ab
FROM  ...~~
```

都会导致相同的错误消息（使用 pg 9.1.5 测试）：

> 错误：找不到数据类型 text[] 的数组类型

但是有一种方法可以解决这个问题，正如我们在[这个密切相关的问题](https://stackoverflow.com/q/9832973/939860)下所解决的那样。
创建自定义聚合函数：

```
CREATE AGGREGATE array_agg_mult (anyarray) (
   SFUNC    = array_cat
 , STYPE    = anyarray
 , INITCOND = '{}'
); 
```

并像这样使用它：

```
SELECT array_agg_mult(ARRAY[ARRAY[a,b]]) AS ab
FROM  (
   SELECT unnest('{a,b,c}'::text[]) AS a
        , unnest('{d,e,f}'::text[]) AS b
    ) x 
```

结果：

```
{{a,d},{b,e},{c,f}} 
```

注意附加`ARRAY[]`层！没有它，只是：

```
SELECT array_agg_mult(ARRAY[a,b]) AS ab
FROM ... 
```

你得到：

```
{a,d,b,e,c,f} 
```

这可能对其他目的有用。

滚动另一个函数：

```
CREATE OR REPLACE FUNCTION zip2(anyarray, anyarray)
  RETURNS SETOF anyarray LANGUAGE SQL AS
$func$
SELECT array_agg_mult(ARRAY[ARRAY[a,b]])
FROM (SELECT unnest($1) AS a, unnest($2) AS b) x;
$func$; 
```

称呼：

```
SELECT zip2('{a,b,c}'::text[],'{d,e,f}'::text[]); -- or any other array type 
```

结果：

```
{{a,d},{b,e},{c,f}} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-29T06:03:39.940

这是另一种对不同长度的数组安全的方法，使用 Erwin 提到的数组多重聚合：

```
CREATE OR REPLACE FUNCTION zip(array1 anyarray, array2 anyarray) RETURNS text[]
AS $$
SELECT array_agg_mult(ARRAY[ARRAY[array1[i],array2[i]]])
FROM generate_subscripts(
  CASE WHEN array_length(array1,1) >= array_length(array2,1) THEN array1 ELSE array2 END,
  1
) AS subscripts(i)
$$ LANGUAGE sql;

regress=> SELECT zip('{a,b,c}'::text[],'{d,e,f}'::text[]);
         zip         
---------------------
 {{a,d},{b,e},{c,f}}
(1 row)

regress=> SELECT zip('{a,b,c}'::text[],'{d,e,f,g}'::text[]);
             zip              
------------------------------
 {{a,d},{b,e},{c,f},{NULL,g}}
(1 row)

regress=> SELECT zip('{a,b,c,z}'::text[],'{d,e,f}'::text[]);
             zip              
------------------------------
 {{a,d},{b,e},{c,f},{z,NULL}}
(1 row) 
```

如果你想去掉多余的而不是空填充，只需将`>=`长度测试`<=`改为。

这个函数*不能*处理相当奇怪的 PostgreSQL 特性，即数组可能有一个非 1 的声明元素，但实际上没有人真正使用该特性。例如，使用零索引的 3 元素数组：

```
regress=> SELECT zip('{a,b,c}'::text[], array_fill('z'::text, ARRAY[3], ARRAY[0]));
          zip           
------------------------
 {{a,z},{b,z},{c,NULL}}
(1 row) 
```

而 Erwin 的代码*确实*适用于此类数组，甚至适用于多维数组（通过展平它们），但不适*用于*不同长度的数组。

数组在 PostgreSQL 中有点特殊，它们对于多维数组、可配置的原点索引等有点过于灵活。

在 9.4 中，您将能够编写：

```
SELECT array_agg_mult(ARRAY[ARRAY[a,b])
FROM unnest(array1) WITH ORDINALITY as (o,a)
NATURAL FULL OUTER JOIN
unnest(array2) WITH ORDINALITY as (o,b); 
```

这会更好，特别是如果将函数一起扫描而不是进行排序和连接的优化进入。

# php - 处理 JavaScript 的网络爬虫

> ID：12414754
> 
> 赞同：2
> 
> 时间：2012-09-13T21:03:45.177
> 
> 标签：php, javascript, web-scraping

> **可能的重复：**
> [制作一个支持 JavaScript 的爬虫](https://stackoverflow.com/questions/8326301/make-a-javascript-aware-crawler)

我正在试图弄清楚将什么用作基于 PHP 的网络抓取工具的基础，该网络抓取工具可以处理使用 JavaScript 呈现的页面。除非执行这些页面中的 JS，否则许多网站抓取尝试（至少是我处理的那些）现在都失败了。这些页面不是为了优雅地回退到无脚本实现而构建的。这包括那些大量使用 AJAX 的。

有人会建议从哪里开始开发可以处理现代且严重依赖 JavaScript 的网页的网络爬虫吗？

PHP可以使用的东西是最好的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:12:05.827

可以在无头模式下使用 Web 浏览器引擎来加载页面并分析 DOM。一些谷歌搜索指出我在[http://phantomjs.org/](http://phantomjs.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:09:45.797

那些使用大量 ajax 的网站，只需调用与页面相同的 url，并在该响应上构建您的网站内容，而不是请求页面。

那些具有大量 document.write 或等效框架的网站，您可能只需使用简单的正则表达式剥离空间或匹配标签或相关内容，然后再次请求负责的脚本而不是请求它的页面......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T21:14:07.770

You could use [Selenium](http://seleniumhq.org/) which is a browser automation tool and then use one of the PHP bindings [here](https://github.com/chibimagic/WebDriver-PHP/), [here](https://github.com/facebook/php-webdriver), [or here](http://code.google.com/p/php-webdriver-bindings/) so you can automate Selenium from PHP.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T21:11:29.803

您必须在 PHP 中有一个 JavaScript 引擎。或者命令行上的一些无头 Webkit。即便如此，它也会变得非常复杂。所以简短的回答是：不，对不起，你不能那样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T21:12:37.677

PHP 支持 V8 引擎，所以我想你可以将 javascript 传递给 V8。不过，这不是一件好事，我会使用其他东西而不是直接 PHP 来做到这一点。

# ruby-on-rails-3 - ActiveRecord 不会连接到 postgresql DB 但 rake db:migrate 工作

> ID：12414756
> 
> 赞同：1
> 
> 时间：2012-09-13T21:03:47.843
> 
> 标签：ruby-on-rails-3, postgresql, activerecord, ubuntu, heroku

几天后就从rails和Linux开始......我想部署到heroku，其中一个最佳实践是无论如何也要在本地环境中使用postgresql......我遵循了其中一个教程并创建了一个示例应用程序

安装了 pg gem。捆绑安装工作正常。`rake db:migrate`工作并为我的应用程序创建了表。但是......当我尝试运行我的rails页面时，它给出了这个错误：

```
ActiveRecord::ConnectionNotEstablished 
```

这是完整跟踪的结尾：

```
> activerecord (3.2.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:398:in `retrieve_connection'
activerecord (3.2.3) lib/active_record/connection_adapters/abstract/connection_specification.rb:168:in `retrieve_connection'
activerecord (3.2.3) lib/active_record/connection_adapters/abstract/connection_specification.rb:142:in `connection'
activerecord (3.2.3) lib/active_record/query_cache.rb:67:in `rescue in call'
activerecord (3.2.3) lib/active_record/query_cache.rb:61:in `call'
activerecord (3.2.3) lib/active_record/connection_adapters/abstract/connection_pool.rb:467:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `_run__4423031206660944571__call__1711406629982304701__callbacks'
activesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.3) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call' 
```

我正在使用 pgadmin 3 来查看我的数据库。我创建了一个名为 schaller 的用户，它与我在 Ubuntu 中的用户相同

我的 database.yml 文件：

```
development:
  adapter: postgresql
  database: rails
  encoding: unicode
  username: schaller
  password: password123
  host: localhost
  pool: 5 
```

为了让rails连接到postgres，我还能检查什么？

编辑：

在 webrick 上的 netbeans 中启动 rails 服务器时出错

> 在 2012-09-13 23:12:31 +0300 ActiveRecord::ConnectionNotEstablished (ActiveRecord::ConnectionNotEstablished) 开始 GET "/gangs/" for 127.0.0.1: activerecord (3.2.3) lib/active_record/connection_adapters/abstract /connection_pool .rb:398:in `retrieve_connection' activerecord (3.2.3) lib/active_record/connection_adapters/abstract /connection_specification.rb:168:in`retrieve_connection' activerecord (3.2.3) lib/active_record/connection_adapters/abstract /connection_specification.rb:142:in `connection' activerecord (3.2.3) lib/active_record/query_cache.rb:67:in`rescue in call' ...

编辑我的 gem 文件中的主要内容：

```
gem 'rails', '3.2.3'
gem 'pg'
gem 'thin' 
```

编辑：为 postgresql 连接添加日志

```
[local]
2012-09-15 18:05:35 IDT LOG:  connection received: host=127.0.0.1 port=44038
2012-09-15 18:05:35 IDT LOG:  connection authorized: user=schaller database=postgres
2012-09-15 18:05:35 IDT LOG:  connection received: host=127.0.0.1 port=44039
2012-09-15 18:05:35 IDT LOG:  connection authorized: user=schaller database=rails
2012-09-15 18:07:26 IDT LOG:  connection received: host=127.0.0.1 port=44048
2012-09-15 18:07:26 IDT LOG:  connection authorized: user=schaller database=rails 
```

无论如何，当我连接 pgadmin 3 并运行命令“rake db:migrate”时，我看到正在写入日志，但当我运行我的 rails 应用程序时却没有……

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:49:31.117

好的，已经有几天了..我再次阅读了所有答案和评论，因为无论如何我真的需要一个解决方案！@Muhammad Sannan 留下的评论起到了作用。我是 Rails 新手，所以我不知道适配器是什么.. 但在快速谷歌搜索后，我运行了这个命令：

```
gem install activerecord-postgresql-adapter 
```

这就是诀窍:)

现在一切正常。我只是不明白没有这个适配器的 db:migrate 是如何工作的..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:30:23.820

我认为问题出在你的 database.yml 上。你错过了我认为你在 heroku 上使用的模式的生产部分。只需添加

```
production:
  adapter: postgresql
  database: rails
  encoding: unicode
  username: schaller
  password: password123
  host: localhost
  pool: 5 
```

到 heroku 上的 database.yml

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T22:41:17.707

好吧，如果你能在 pgadmin 中看到 db，你就知道基本的连接细节是正确的。如果您没有修改 pgadmin，那么端口号或其他详细信息也不太可能发生变化。

所以 - 我们需要找出发生了什么。第一步是在 PostgreSQL 中打开连接日志并查看 rails 是否真的在连接。设置`log_connections`并重新启动 PG，然后看看会发生什么。如果您在日志中没有看到任何内容，但从 pgadmin 执行，则 rails 没有看到正确的连接设置。

[http://www.postgresql.org/docs/current/static/runtime-config-logging.html#GUC-LOG-CONNECTIONS](http://www.postgresql.org/docs/current/static/runtime-config-logging.html#GUC-LOG-CONNECTIONS)

# javascript - a 中的 setInterval 导致函数失败

> ID：12414757
> 
> 赞同：0
> 
> 时间：2012-09-13T21:04:01.087
> 
> 标签：javascript, jquery, for-loop, setinterval

我有两个功能

```
 function getImgStr(imgName){
        thisStr = '<img src="/_shared/img/discovery/200x100/'+imgName+'.jpg">';
        return thisStr;
    }
    function buildIt(imgSrc){
        console.log(imgSrc);
        $('#content').append('<div></div>');
        $('#content div:last').hide()
            .addClass('imgBox')
            .attr('id',imgSrc)
            .html(getImgStr(imgSrc))
            .slideDown(2000);
    } 
```

我有一个正在循环的数组

```
$(function(){
        for(i=0;i<=imgList.length-1;i++){
                buildIt(imgList[i]);
        }
    }); 
```

工作正常，没有问题。

但是当我尝试包装时，这是一个 setInterval is barfs

```
$(function(){
        for(i=0;i<=imgList.length-1;i++){
            var loadIt = setInterval(function(){
                buildIt(imgList[i]);
            },1000);
        }
    }); 
```

当 setInterval 存在时， buildIt 中的 console.log 是未定义的，所以我假设间隔会以某种方式影响循环，但我不明白我做错了什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:29:56.767

根据您的说明：如果您想每秒一个接一个地加载图像，您可以执行以下操作。你根本不需要循环。

```
var i = 0;
var id = setInterval(function() {
    if(i === imgList.length) {
        clearInterval(id);
    } else {
        buildIt(imgList[i++]);
    }
}, 1000) 
```

它的作用是将 的值初始化`i`为 0。`i`功能与 for 循环中的功能完全相同`i`。它本质上是一个索引。然后，将区间的值存储在变量`id`中。通过这种方式，您可以维护对间隔的引用，以便在完成加载图像时可以清除它。

最后，在区间函数中检查是否`i`等于图像列表中图像数量的长度。如果是，我们知道我们已经完成了所有的加载，所以我们清除了间隔。否则，我们调用与`buildIt`的当前值相对应的图像的函数`i`并增加 的值`i`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:20:20.727

**用[小提琴](http://jsfiddle.net/EQMDz/)**更新****

 **```
 this.buildIt= function(imgSrc){
    console.log("test"+imgSrc)
    console.log(imgSrc.length)
        };

$(function(){ 
      var imgList=[
"test1","test2","test3","test4"
]
        for(i=0;i<=imgList.length;i++){

            var loadIt = setInterval(function(){
                this.buildIt(imgList);
            },1000,imgList);
        }
    });​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T22:18:52.497

*更新*：我仍然不完全清楚 OP 正在尝试做什么，但根据我的理解，我将通过堆上的另一个解决方案。您有 N 个图像，并且您希望每秒按顺序更新这些图像。为此，您必须将 a`setTimeout`与 a结合起来`setInterval`。将`setTimeout`错开图像的更新，并且`setInterval`将导致每个图像依次更新。下面是它的外观：

```
function start() {
    var nImages = 5;
    for( i=0; i<nImages; i++ ) {
        (function(j){
            setTimeout( function() {
                buildIt(j);
                intervals.push(
                    setInterval( function() {
                        buildIt(j);
                    }, 1000*nImages )
                );
            }, j*1000 );
        })(i);
    }
}

function stop() {
    for( i in intervals ) {
        clearInterval( intervals[i] );
    }
} 
```

这是一个 jsFiddle 演示：http: [//jsfiddle.net/FtCCs/](http://jsfiddle.net/FtCCs/)

这是我之前的回答： Vivin 是在正确的轨道上，但他的解决方案也行不通，因为它只是将闭包问题推到了堆栈的下方。但是，他在一方面是正确的：您的`buildIt`函数调用没有获得您期望的索引，而是所有相同的索引。你需要做的是：

```
$(function(){
    for(i=0;i<=imgList.length-1;i++){
        (function(j){
            var loadIt = setInterval(function(){
                buildIt(imgList[j]);
            },1000);
        })(i);
    }
}); 
```

为了完全清楚发生了什么，请考虑以下示例：

HTML：

```
<div id="wrong1">Wrong:<br /></div>
<div id="wrong2">Wrong:<br /></div>
<div id="wrong3">Wrong:<br /></div>
<div id="right">Right:<br /></div> 
```

jQuery：

```
// won't work:
for(var i=0;i<5;i++) {
    setTimeout( function() { $('#wrong1').append(i+'<br />'); }, 500 );
}

// won't work:
for(var i=0;i<5;i++) {
    var j = i;
    setTimeout( function() { $('#wrong2').append(j+'<br />'); }, 500 );
}

// won't work:
for(var i=0;i<5;i++) {
    setTimeout( function() { (function(j){ $('#wrong3').append(j+'<br />'); })(i) }, 500 );
}

// works!
for(var i=0;i<5;i++) {
    (function(j){
        setTimeout( function() { $('#right').append(j+'<br />'); }, 500 );
    })(i);
} 
```

我在这里设置了一个 JsFiddle 来演示：http: [//jsfiddle.net/k3RJL/1/](http://jsfiddle.net/k3RJL/1/)

在所有“错误”的示例中，变量`i`or`j`是一个闭包，但是当`setTimeout`执行中的函数时，该值已更改为该闭包中的最终值，因此它们都相同。注意 的区别`wrong2`：它查看的`j`是在循环中定义的变量`for`，所以它永远不会收到 的最终值`i`，这就是它停在 4 的原因。

​</p>**

# powershell - 将powershell变量内联扩展为cmdlet参数？

> ID：12414763
> 
> 赞同：3
> 
> 时间：2012-09-13T21:04:15.407
> 
> 标签：powershell, parameters, arguments, cmdlet

调用 cmdlet 时，是否可以以某种方式扩展 powershell 变量的值，使其充当 cmdlet 的参数（具有相关值）？

这是我正在尝试的示例：

```
$CREDENTIALED_SECTION = "-Username $USER_NAME -Password $PASSWORD"
.
.
.

Invoke-Sqlcmd -ServerInstance "$SERVER_NAME" -Query "$SQL_STATEMENT" "$CREDENTIALED_SECTION" -Database "$DATABASE" 
```

Invoke-Sqlcmd 运行时出现问题。它告诉我找不到接受“-Username `my username`-Password `my password`”的位置参数，因此它正在扩展变量，但没有正确地将其作为一组参数发送。有没有办法做我在这里尝试的事情？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T21:43:26.497

您可以使用哈希表将这样的参数传递给 PowerShell 命令，例如：

```
$CREDENTIALED_SECTION = @{Username=$USER_NAME; Password=$PASSWORD}

Invoke-Sqlcmd -ServerInstance $SERVER_NAME -Query $SQL_STATEMENT @CREDENTIALED_SECTION -Database $DATABASE 
```

请注意，在这种情况下，不必引用 PowerShell 变量。您还需要在命令调用中使用 splatting 语法，例如`@<hashtable_with_parameter_name_value_pairs>`.

# c# - 从 json 转换 datetime 对象

> ID：12414765
> 
> 赞同：0
> 
> 时间：2012-09-13T21:04:16.890
> 
> 标签：c#, javascript, jquery, asp.net-mvc, json

我有以下代码

```
 var res = from c in model.Data 
            select new object[] { c.Id, c.Time, c.Name }; 
```

这个 res 变量作为 json 对象发送。

时间是 DateTime 属性。我在视图中获取这个 json 对象，如下所示

```
$(document).ready(function () {

        $('#myDataTable').dataTable({
            "bServerSide": true,
            "sAjaxSource": "/Home/AjaxHandler",
            "bProcessing": true,
            "aoColumns": [
                        { "sName": "ID",
                            "bSearchable": false,
                            "bSortable": false,
                            "fnRender": function (oObj) {
                                return '<a href=\"Details/' +
                                oObj.aData[0] + '\">View</a>';
                            }
                        },
                        { "sName": "Time" },
                        { "sName": "Name" }
                    ]
        });
    }); 
```

页面使用日期时间字段呈现，例如`/Date(1346996934000)/`

在服务器端或视图中转换它的最佳方法是什么以及如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:07:23.683

这个数字是刻度的日期吗？如果是这样的话，那么

```
DateTime date = new DateTime(long.Parse(1346996934000)); 
```

在这里发现：[从刻度到日期的格式](https://stackoverflow.com/questions/1129410/format-from-ticks-to-date)

这将被转换为：*Fri Sep 07 2012 01:48:54* in GMT-4 timezone。

这是我用 JavaScript 做的一个解决方案，在这里找到：http: [//deekshadev.blogspot.com/2011/03/convert-ticks-to-date-object.html](http://deekshadev.blogspot.com/2011/03/convert-ticks-to-date-object.html)

```
//convert the event day to a date object
var startticks = new Date(ticks * 1000);

//convert today to ticks will be in milliseconds
var todayticks = new Date().getTime();

var diff = startticks - todayticks;
var days = Math.floor(diff/(24*60*60*1000));
var hours = (diff/(60*60*1000)) % 24;
var mins = (diff/(60*1000)) % 60;
Here ticks was in seconds, so multiplying it with 1000 to convert to milliseconds. 
```

如果仅需要显示该日期，我不会在服务器级别执行此操作。我会在客户端上转换并根据需要显示它。

# java - 确定哪些 Callables 当前在 ExecutorService 中运行

> ID：12414767
> 
> 赞同：2
> 
> 时间：2012-09-13T21:04:20.680
> 
> 标签：java, multithreading, executorservice, callable

我希望能够获得我已经[`submit`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html#submit(java.util.concurrent.Callable))ted 到 ExecutorService（特别是 ThreadPoolExecutor）的 Callables，它们当前正在进行中（因此它们不能通过 获得`getQueue()`）。

我尝试创建一个要覆盖的子类`beforeExecute`，但是给定的 Runnable 原来是 FutureTask，而不是提交的原始 Callable。

还有其他方法可以确定活动的可调用对象吗？

* * *

最终，我想用这些信息做两件事：

1.  获取正在运行的任务，以便它们可以显示在用户界面中
2.  检查Callable引用的文件是否匹配某个模式，如果是，取消它

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T21:18:42.633

您可以覆盖`AbstractExecutorService.newTaskFor()`，它应该使您可以访问原始`Runnable`s 和`Callable`s。然后用你的跟踪装饰器装饰它们并传递给`super.newTaskFor()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T20:19:45.513

正如[axtavt 所建议的，](https://stackoverflow.com/a/12414953/446591)我创建了一个子类`FutureTask`：

```
public class FutureCallable<V> extends FutureTask<V> {
    private Callable<V> callable;

    public FutureCallable(Callable<V> callable) {
        super(callable);
        this.callable = callable;
    }

    public Callable<V> getCallable() {
        return callable;
    }

} 
```

并覆盖了我的`ThreadPoolExecutor`子类中的一些方法：

```
public class CustomThreadPoolExecutor extends ThreadPoolExecutor {
    private Set<FutureCallable<UpdateResult>> running = new HashSet<FutureCallable<UpdateResult>>();

    @Override
    public <T> FutureCallable<T> newTaskFor(Callable<T> callable) {
        return new FutureCallable<T>(callable);
    }

    @Override
    protected void beforeExecute(Thread t, Runnable r) {
        FutureCallable<UpdateResult> task = (FutureCallable<UpdateResult>) r;
        running.add(task);
    }

    @Override
    protected void afterExecute(Runnable r, Throwable t) {
        FutureCallable<UpdateResult> task = (FutureCallable<UpdateResult>) r;
        running.remove(task);
    }

    ...
} 
```

# java - SpringRoo GWT 脚手架 Maven 依赖重复错误

> ID：12414768
> 
> 赞同：0
> 
> 时间：2012-09-13T21:04:21.023
> 
> 标签：java, spring, gwt, maven, spring-roo

我正在尝试阅读本教程：

[http://gwtsts.blogspot.sk/2011/03/part-ii-generating-gwt-project-using.html](http://gwtsts.blogspot.sk/2011/03/part-ii-generating-gwt-project-using.html)

因为我需要知道如何从现有数据库生成 GWT 前端（在我的例子中是 Postgre，但这个例子也会很好地为我服务）。

这是我执行的来自 Pizzashop.roo 的脚本：

```
project --topLevelPackage com.blogspot.gwtsts.pizzashop

persistence setup --provider DATANUCLEUS --database GOOGLE_APP_ENGINE --applicationId pizzashopexample

enum type --class ~.shared.PaymentType
enum constant --name CC_ONLINE
enum constant --name CASH_ON_DELIVERY
enum constant --name CC_ON_DELIVERY

entity jpa --class ~.server.domain.Topping --testAutomatically
field string --fieldName name --notNull --sizeMin 2

entity jpa --class ~.server.domain.Base --testAutomatically
field string --fieldName name --notNull --sizeMin 2

entity jpa --class ~.server.domain.Pizza --testAutomatically
field string --fieldName name --notNull --sizeMin 2
field number --fieldName price --type java.lang.Float
field set --fieldName toppings --type ~.server.domain.Topping
field reference --fieldName base --type ~.server.domain.Base

entity jpa --class ~.server.domain.PizzaOrder --testAutomatically
field string --fieldName name --notNull --sizeMin 2
field string --fieldName address --sizeMax 30
field number --fieldName total --type java.lang.Float
field enum --fieldName paymentType --type ~.shared.PaymentType
field date --fieldName deliveryDate --type java.util.Date
field set --fieldName pizzas --type ~.server.domain.Pizza

gwt setup

logging setup --level INFO 
```

整个脚本执行没有任何问题。但是当我运行命令时`perform tests`，它给了我以下错误消息（一些依赖项已成功下载，但构建失败并以错误结束）：

```
[ERROR] Failed to execute goal org.datanucleus:maven-datanucleus-plugin:3.0.2:en
hance (default) on project pizzashop: Error executing DataNucleus tool org.datan
ucleus.enhancer.DataNucleusEnhancer: InvocationTargetException: Plugin (Bundle)
"org.datanucleus.enhancer" is already registered. Ensure you dont have multiple
JAR versions of the same plugin in the classpath. The URL "file:/C:/Users/jakub/
.m2/repository/org/datanucleus/datanucleus-enhancer/3.1.0-m2/datanucleus-enhance
r-3.1.0-m2.jar" is already registered, and you are trying to register an identic
al plugin located at URL "file:/C:/Users/jakub/.m2/repository/org/datanucleus/da
tanucleus-enhancer/3.0.1/datanucleus-enhancer-3.0.1.jar." -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e swit
ch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please rea
d the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionE
xception 
```

我正在尝试在stackoverflow上找到的技巧来编辑datanucleus-core所在的pom.xml，并具体将标签添加`<scope>runtime</scope>`到datanucleus-core依赖项，但结果是一样的。

我正在使用 Windows 7 Ultimate 64 位。Spring Roo 1.2.2、apache maven 3.0.3、spring 工具套件 3.0.0、vfabric-tc-server-developer 2.7.1。我已经设置了所有系统环境变量（JAVA_HOME、spring roo、maven）。

非常感谢您的帮助 ：）

我的 pom.xml： [pom.xml](http://dl.dropbox.com/u/51995533/pom.xml)

# google-apps-script - 你如何让应用程序脚本 API 视频“工作”

> ID：12414772
> 
> 赞同：1
> 
> 时间：2012-09-13T21:04:36.703
> 
> 标签：google-apps-script

所以这里是应用脚本外部 API 的“示例”。

[https://developers.google.com/apps-script/external_apis](https://developers.google.com/apps-script/external_apis)

但是当你剪切和粘贴代码时：

```
var url = "https://gdata.youtube.com/feeds/api/videos?"
    + "q=skateboarding+dog"
    + "&start-index=21"
    + "&max-results=10"
    + "&v=2";
var response = UrlFetchApp.fetch(url); 
```

进入 Code.gs

```
function myFunction() {

 var url = "https://gdata.youtube.com/feeds/api/videos?"
    + "q=skateboarding+dog"
    + "&start-index=21"
    + "&max-results=10"
    + "&v=2";
var response = UrlFetchApp.fetch(url);

} 
```

并按“发布部署为 Web 应用程序”（管理项目后）没有任何反应。

是否有一个工作示例不仅仅是上面的代码片段？换句话说，您如何处理将查询“显示”到 YouTube 等的响应变量？据说这个 URL-fetch 示例是理解大量教程示例所必需的，但它本身并没有真正完成任何事情。

谢谢

我在这里回应对以下答案的回应。

我试过 Browser.msgBox(response); 这给了我“未知的宏 doGet”。</p>

我试过 Logger.log(response); 这给了我“未知的宏 doGet”。</p>

```
function myFunction() {
    var url = "https://gdata.youtube.com/feeds/api/videos?"
    + "q=skateboarding+dog"
    + "&start-index=21"
    + "&max-results=10"
    + "&v=2";
var response = UrlFetchApp.fetch(url);

//Browser.msgBox(response);

// Logger.log(response);

} 
```

你说“这取决于你作为开发人员”但我不知道“作为开发人员”应该做什么</p>

是的，很明显我在这里遗漏了一些东西，这就是问题所在。我遗漏了一些基本的东西，假设我应该从示例中知道但我不知道。

教程中没有向我介绍 Listbox。

当我在 /apps-script 的搜索中键入“listbox”时，我得到了这个例子：

[https://developers.google.com/apps-script/class_listbox](https://developers.google.com/apps-script/class_listbox)

我将其放入电子表格并能够运行它以获取选择选项。那么为什么这与我应该使用 msgbox 或记录器得到的不同呢？这些都让我得到“未知宏 doGet”</p>

请我在这里迷路了。在继续其他教程之前，我需要了解这一点，但我遗漏了一些东西。

好的，我找到了一种方法来显示“响应”，但不使用“部署为 Web 应用程序”（这是我认为我需要的，但我想我不知道。

```
function onOpen() {
  var ss = SpreadsheetApp.getActiveSpreadsheet(); 
```

// 这些是 2 个菜单条目 var menuEntries = [ {name: "Surprise 1", functionName: "menuItem1"}, {name: "Surprise 2", functionName: "menuItem2"}, {name: "Surprise 3",函数名：“menuItem3”} ];

//surprise3 在另一个脚本中

// 定义菜单项后，然后定义菜单本身 ss.addMenu("Surprises", menuEntries); }

```
function menuItem1() {
   var url = "https://gdata.youtube.com/feeds/api/videos?"
    + "q=skateboarding+dog"
    + "&start-index=21"
    + "&max-results=10"
    + "&v=2";
  var response = UrlFetchApp.fetch(url);
  Browser.msgBox(response);
}

function menuItem2() {
  var url = "https://gdata.youtube.com/feeds/api/videos?"
    + "q=skateboarding+dog"
    + "&start-index=21"
    + "&max-results=10"
    + "&v=2";
  Browser.msgBox(url);
} 
```

但这所做的只是在 menu1 的框中打印“FetchReponse”。所以？

我如何将它放入浏览器？我的“部署到网络”选择一定有问题，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T21:16:32.847

该脚本确实完成了它的预期任务。

Google 应用程序脚本 UI 具有调试器功能。尝试使用它来逐步完成示例代码段。定义变量后，查看它的值。这将帮助您了解正在发生的事情。确实，示例本身（原样）不会对响应数据做任何事情，但这取决于作为开发人员的您。使用变量“响应”中的值，您可以填充列表框。但是没有提供执行此操作的代码，这取决于您；-) 如果您还不能编写该代码，我同意 Srik 的建议并查看教程。

最后，此链接可以帮助您解决有关示例中使用的 API 的更多问题。 [https://developers.google.com/youtube/2.0/developers_guide_protocol#Standard_parameters](https://developers.google.com/youtube/2.0/developers_guide_protocol#Standard_parameters)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T16:56:00.177

剪切并粘贴到一个函数中，仍然得到 Unknown Macro doGet。

```
function myFunction() {
     var url = "https://gdata.youtube.com/feeds/api/videos?"
    + "q=skateboarding+dog"
    + "&start-index=21"
    + "&max-results=10"
    + "&v=2";
  var response = UrlFetchApp.fetch(url);
  Browser.msgBox(response);
} 
```

将其保存为托管版本。然后“部署为 Web 应用程序”。剪切并粘贴链接和最新版本，它们都给我“未知宏 doGet”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T17:34:42.517

在进一步发布之前，请阅读[https://developers.google.com/apps-script/execution_web_apps](https://developers.google.com/apps-script/execution_web_apps)。

特别是这句话：**“为了将脚本部署为 Web 应用程序，它必须包含 doGet(e) 函数。”**

然后决定如何构建您的用户界面：[https](https://developers.google.com/apps-script/html_service) ://developers.google.com/apps-script/html_service或[https://developers.google.com/apps-script/uiapp](https://developers.google.com/apps-script/uiapp)

# php - 如何使用另一个类的属性值来引用一个类属性

> ID：12414774
> 
> 赞同：-1
> 
> 时间：2012-09-13T21:04:40.000
> 
> 标签：php

我知道我可以使用如下变量引用类的属性：

```
$field_name = 'first_name';
$myobject->$field_name // references $myobject->first_name 
```

有没有办法可以使用另一个类的属性来引用一个类的属性？例如，

```
$myobject->{$model->field_name} // Does not work 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:09:00.597

这对我有用：

```
class Foo {
    public $bar = 'baz';
}

class Bar {
    private $baz = 'Hello, World!';

    public function __construct() {
        $foo = new Foo;
        echo $this->{$foo->bar};
    }
}

new Bar; 
```

它[打印](http://codepad.org/fMImu0Dc)：

```
Hello, World! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:06:10.933

```
$field_name = $model->field_name
$myobject->$fieldname 
```

# java - 调用 TimeZone.getAvailableIDs() 时出现 NullPointerException

> ID：12414775
> 
> 赞同：5
> 
> 时间：2012-09-13T21:04:46.343
> 
> 标签：java, timezone, nullpointerexception

我尝试了很多我基本上做的代码示例

```
String[] IDs = java.util.TimeZone.getAvailableIDs(); 
```

它不起作用。我还尝试了另一帧示例代码，即[它](http://www.tutorialspoint.com/java/util/timezone_getavailableid_offset.htm)并返回：

```
at sun.util.calendar.ZoneInfoFile.getZoneIDs(ZoneInfoFile.java:785)
at sun.util.calendar.ZoneInfo.getAvailableIDs(ZoneInfo.java:560)
at java.util.TimeZone.getAvailableIDs(TimeZone.java:508)
at TimeZoneDemo.main(uu.java:6) 
```

我也尝试重新安装 JRE 和 JDK，但错误仍然存​​在。那么有什么意义呢？当我尝试这样做`String[] eg = {"one","two"};`时，它会起作用。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2016-08-05T02:20:13.813

如果您使用的是 Ubuntu 16.04，请尝试此操作

```
sudo apt-add-repository ppa:justinludwig/tzdata
sudo apt-get update
sudo apt-get install tzdata-java 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T21:14:20.553

你会在这里发现同样的问题：

*   [http://www.eclipse.org/forums/index.php/m/532341/](http://www.eclipse.org/forums/index.php/m/532341/)

*   [https://jira.atlassian.com/browse/FE-2662](https://jira.atlassian.com/browse/FE-2662)

*   [http://bugs.sun.com/view_bug.do?bug_id=6529213](http://bugs.sun.com/view_bug.do?bug_id=6529213)

建议：

下载并运行最新的 tzupdater 工具，看看是否能解决问题：

*   [http://www.oracle.com/technetwork/java/javase/tzupdater-readme-136440.html](http://www.oracle.com/technetwork/java/javase/tzupdater-readme-136440.html)

# java - 从 JQuery (Webdriver) 制作数组

> ID：12414781
> 
> 赞同：1
> 
> 时间：2012-09-13T21:05:21.990
> 
> 标签：java, jquery, webdriver

我有这个在 firebug 控制台上工作的 jquery：

```
$('#transaction_list>tbody>tr>td:nth-child(2)').each( function(){$(this).toArray();}) 
```

我需要在一个数组上获取返回值。

这是代码行：

```
String [] aux = (String[]) js.executeScript("return $('#transaction_list>tbody>tr>td:nth-child(2)').each( function(){$(this).toArray();})");

System.out.println(aux); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T23:15:42.527

返回 Javascript 数组不是这里的问题。但是您的 jQuery 代码不会返回您想要的。

假设您想要获取 table 的第二列中包含的所有文本的数组`#transaction_list`，您可能需要使用：

```
return $('#transaction_list>tbody>tr>td:nth-child(2)').map(
         function(i,e){
           return $(this).text();
         }
       ).get(); 
```

# c - 除了 Haar 级联之外，OpenCv 中的人脸检测？

> ID：12414785
> 
> 赞同：0
> 
> 时间：2012-09-13T21:05:39.150
> 
> 标签：c, opencv

我正在尝试在 OpenCv 中实现人脸检测。但是使用 Haar Cascades 会变得非常慢并且不能实时。我听说过冲浪。

谁能帮助我使用 SURF 或其他方法实现快速人脸检测？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:59:14.353

如果您正在寻找 SURF 的使用示例，请查看`samples/c/find_obj.cpp`. 但是，我怀疑它是否会比 Haar Cascade 分类器运行得更快。级联分类器使用非常简单的特征——只是图像的矩形区域，而 SURF 则要复杂得多。

您还可以尝试其他算法，从非常简单但效率低下的特征[脸](http://en.wikipedia.org/wiki/Eigenface)开始，到复杂但功能齐全的[主动外观模型](http://en.wikipedia.org/wiki/Active_appearance_model)结束（参见 Wiki 页面上的实现列表）。尽管它需要大量编程并且仍然不太可能击败级联分类器结果。所以，我建议重新考虑系统的其他部分。例如，我相信可以在后台线程中检测到人脸并以很少的延迟显示出来。此外，如果您想将其用于头部/面部跟踪，您可以仅对某个区域运行检测器，靠近面部的先前位置。

# matlab - 更改类中图形的 CloseRequestFunction

> ID：12414787
> 
> 赞同：0
> 
> 时间：2012-09-13T21:05:56.933
> 
> 标签：matlab, matlab-figure

所以我有一个带有构造函数的matlab类

```
function obj=MyClass(inputs)
        .
        .
        h=figure(ClosRquestFcn',@obj.test,,'Name','Progress','NumberTitle','off');
        .
        .
 end 
```

我的问题是它没有检测到 MyClass 类中的方法 test() 。我试过没有'obj'。前缀也是，但无济于事

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T14:46:45.250

在我看来，这是另一个问题的征兆。不确定您是否准确复制了代码，但其中有一些拼写错误。如果我制作玩具对象：

```
classdef testobj
  methods
    function testme(varargin)
      for ii=1:nargin
        if( isa(varargin{ii},'double') )
          disp( varargin{ii} );
          delete(varargin{ii});
        end
      end
    end
  end
end 
```

然后实例化对象并创建一个带有关闭函数回调的简单图形：

```
me = testobj
figure('CloseRequestFcn',@me.testme) 
```

当我关闭图形时，它会关闭，然后在屏幕上打印句柄编号。

```
4 
```

尝试只添加 close 函数并确保它按预期执行。如果您有任何`try`块，请务必显示任何`catch`错误。

# linux - 是否可以在同一个 PCIe 插槽上写入使用不同 PCIe 通道的多个设备？

> ID：12414798
> 
> 赞同：3
> 
> 时间：2012-09-13T21:06:54.953
> 
> 标签：linux, linux-kernel, driver, pci-e

我正在编写一个支持多个设备的 Linux 设备驱动程序。我有一个 x8 PCIe 卡，上面有 4 个这样的设备。每个都通过一个 PCIe 交换机并获得 2 个 PCIe 通道。有没有办法让司机同时写入多个车道？如果是这样，我该怎么做？我认为这应该是可能的，因为它都在一个 PCIe 插槽上，但我不知道如何从驱动程序中完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:59:39.410

PCIe 并不像您想象的那样工作。交换机不会将上游 x8 链路划分为多个 x2 链路——它只是将流量从一条链路转发到另一条链路。因此，您将看到一个到交换机的 x8 链路，然后是从交换机到下游设备的 4 个 x2 链路。然而，对于不同的交换机和不同的下游设备，同样有可能（例如）在任何地方都有 x8 链路，即从根端口到交换机的 x8 链路和从交换机到下游设备的 x8 链路。

但是，在您的情况下，您在交换机的两侧都有匹配的带宽量，因此设备竞争有限的带宽应该没有问题。您的驱动程序可以像有独立链接一样有效地同时与所有设备通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T13:22:07.487

听起来您正在寻找 PCIe 多播。这与通道的数量无关，而只是将单个写入尽可能高效地传递到多个目的地的功能。有*一个*标准，主要用于背板用途，请参阅：[http ://www.pcisig.com/developers/main/training_materials/get_document?doc_id=12f5c260ccf5e054366d4c96ee655fa6827db5b3](http://www.pcisig.com/developers/main/training_materials/get_document?doc_id=12f5c260ccf5e054366d4c96ee655fa6827db5b3)

新的 PCI BAR 类型似乎支持这一点，其中多个设备将具有相同的映射物理地址范围，并且交换机也将被配置为了解此多播范围。但这一切都需要操作系统支持，而且我在网上没有找到任何东西表明 Linux 具有配置设备以完成所有这些工作所需的部分。

由于您的父链接有足够的带宽来饱和所有四个子链接，因此您不会遇到吞吐量问题。使用多播唯一可以节省的是来自内存子系统的带宽。如果您拥有现代建筑，那么您将节省的金额将在噪音中。

换句话说，不要担心。将您的设备视为独立的（无论如何，这将使驱动程序更清洁）并继续您的项目。

# jquery - 当不透明度为 0% 时从元素中移除点击

> ID：12414799
> 
> 赞同：2
> 
> 时间：2012-09-13T21:06:56.170
> 
> 标签：jquery, click, opacity

我在页面上有一些内容需要淡出到 0% 的不透明度，而不是淡出并将元素从页面中完全删除，因此元素的高度和宽度仍然存在，但只是处于非活动状态。

问题是，该元素中的对象仍然是可点击的并且仍然会触发事件。`cursor:default;`有没有一种特殊的方法可以使它们不活动，或者它很简单`preventDefault();`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T21:08:46.807

尝试更改内容的可见性。

在 CSS 中，

```
visibility: hidden 
```

这将隐藏元素，但仍将占据与完全显示时相同的宽度和高度。

更好的是，您可以淡出元素，然后更改其可见性：

```
$('#target').animate({
      opacity: 0
    },
    1000, // specifies duration of fade (in milliseconds)
    function() {
        // this function will called after the opacity animation has completed
        $(this).css('visibility', 'hidden');
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-06T01:02:45.817

对我来说，它是这样工作的：

```
.dropdown-menu {
    transition: all .32s ease;
    opacity: 0;
    display: block;
    visibility: hidden;
}

.show {
    visibility: visible;
    opacity: 1;
} 
```

# sql-server-2008 - 具有关系的计算列

> ID：12414803
> 
> 赞同：0
> 
> 时间：2012-09-13T21:07:18.247
> 
> 标签：sql-server-2008

我有一个表 MapLocation，它有一个列和两个与表的关系，这些表有一个真正需要显示为单个连接值的字段。我在想这是一个计算列的完美案例，但不知道如何去做。

```
 MapLocation                          MaoNo                         Section   
_____________________                 _____________________         _____________________
 MapNoId                              MapNoId                       SectionId
 SectionId                            MapNumber (int)               Section (int)
 Identifier (nvarchar)
 LocationName (nvarchar) 
```

LocationName = "MapNUMer - SectionNumber - Identifier"
例如：20 - 03 - SW4

我该怎么写？我对计算列或 SQL 中的连接做的不多。

编辑：

我需要一个自动更新的实际计算列，我正在寻找公式。或者这更像是一个函数/触发器？有可能，我当然几乎不知道自己在做什么。这个想法是我不想再做两个服务器调用并将这些值连接到客户端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:11:29.653

你会使用这样的东西来获得价值：

```
select cast(n.MapNumber as nvarchar(10)) + ' - '   -- cast the MapNumber 
    + cast(s.SectionId as nvarchar(10)) + ' - '    -- cast the SectionId 
    + l.Identifier  
from MapLocation l
left join MaoNo n
    on l.MapNoId  = n.MapNoId 
left join Section s
    on l.SectionId = s.SectionId 
```

然后，如果您需要执行`UPDATE`：

```
update l
set l.LocationName =  (cast(n.MapNumber as nvarchar(10)) + ' - '    
                    + cast(s.SectionId as nvarchar(10)) + ' - '   
                    + l.Identifier)
from MapLocation l
left join MaoNo n
    on l.MapNoId  = n.MapNoId 
left join Section s
    on l.SectionId = s.SectionId 
```

编辑＃1 - 您可以使用`TRIGGER`：

```
CREATE TRIGGER trig_LocationName
ON MapLocation
AFTER INSERT
AS
Begin
    update MapLocation
    set LocationName =  (cast(n.MapNumber as nvarchar(10)) + ' - '    
                                        + cast(s.SectionId as nvarchar(10)) + ' - '   
                                        + i.Identifier)
    from Inserted i
    left join MaoNo n
        on i.MapNoId  = n.MapNoId 
    left join Section s
        on i.SectionId = s.SectionId
    where MapLocation.MapNoId  = i.MapNoId  -- fields here to make sure you update the correct record
End 
```

# c++ - C++ 函数参数创建类

> ID：12414804
> 
> 赞同：3
> 
> 时间：2012-09-13T21:07:21.120
> 
> 标签：c++

假设我有以下课程：

```
class A
{
public:
    A() {
    }

    A(int a):_a(a){
    }

    int _a;
}; 
```

以及以下功能：

```
void someFunc (A a)
{
    cout << a._a;
} 
```

所以程序中的以下行可以正常工作：

```
someFunc (5); // Calls A(int a) Constructor. 
```

但以下没有：

```
someFunc(); //Compile error 
```

可以预期，如果它可以在获取整数时构建 A，那么为什么不使用默认构造函数也构建一个，当不带参数调用时呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T21:08:55.857

因为`someFunc()`需要一个参数，而您没有提供一个不提供的重载。`int`存在从to的隐式转换`A`，但这并不意味着您可以忽略函数的签名并在不带参数的情况下调用它。如果您想在没有参数的情况下调用它，他们会为`a`.

```
void someFunc(A a = A()) { 
    /* stuff */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T21:09:45.807

因为您没有使用可转换的参数调用该函数，所以您调用了*不带参数*的函数。这是一种不同的超载，你没有提供。

考虑以下选项：

*   像这样调用函数：`someFunc(A())`.
*   定义函数参数的默认值：`void someFunc (A a = A()) { ... }`。
*   提供无参数重载：`void someFunc() { someFunc(A()); }`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T21:10:09.787

这是因为 的签名与 的签名`someFunc()`不匹配`void someFunc (A a)`。

根据 C++ 标准，第 13.3.2.3 节：

> *   首先，要成为一个可行的函数，候选函数应该有足够的参数以在数量上与列表中的参数一致。
> *   仅当 (m+1)-st 参数具有默认参数时，具有多于 m 个参数的候选函数才是可行的

在这种情况下，这些都不适用，因此对于使用空参数列表的调用`void someFunc (A a)`来说*不可行。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T21:59:27.263

我在这里并没有真正提供答案，但它仍然是有用的信息......有时你真的不想让`someFunc(5)`工作，因为它可能会导致错误的操作，或者只是误导。在这种情况下，您可以将构造函数声明为`explicit`：

```
class A
{
public:
    A() {}   // Are you sure you don't want to initialise _a here?

    explicit A(int a) :_a(a) {}

    int _a;
}; 
```

正如其他人已经说过的那样，您可以为 指定默认参数`someFunc`：

```
void someFunc( A a = A() ); 
```

现在：

```
someFunc();     // Calls A() by default

someFunc(5);    // Not allowed because of implicit construction

someFunc(A(5)); // Caller must pass an instance of A 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T21:27:03.453

挑剔。从 2003 C++ 标准开始，

> 17.4.3.2.1 全局名称 - ... - 每个以下划线开头的名称都保留给实现，用作全局名称空间中的名称

我会告诉你，以 _ 开头的任何变量名都是不好的做法。特别是当您可以将该实践扩展到命名变量参数（int foo（int _a）），或者不加思索地使用驼峰式（int _MyVar）。我个人会做类似的事情

```
int a_; 
```

你真的会遇到麻烦吗？可能不是。但最好不要以下划线开头。永远不要在名称中的任何地方使用两个下划线，或者以一个下划线后跟一个大写字母开头，当然，也是。

# codeigniter - 代码点火器和 mod_rewrite - 一个重写规则破坏另一个

> ID：12414809
> 
> 赞同：1
> 
> 时间：2012-09-13T21:08:04.130
> 
> 标签：codeigniter, mod-rewrite

我有一个内置于 codeigniter 的网站。我们使用数据库中的短 url 和重写规则将它们重定向到它们的完整路径。

例如，

```
RewriteRule ^secure-form$ form/contract/secure-form [L] 
```

这本身就可以正常工作。但我想在某些页面上使用 SSL。我已经编辑了代码，因此如果您转到这些页面之一，页面中的所有 http:// 实例都将替换为 https:// 但我还需要重写 url 才能使用它。

这些页面都使用相同的模板，所有内容都来自数据库，所以我不能只在特定目录上指定 ssl。

安全页面的 url 都以“secure”开头，所以我编写了以下规则并将它们放在其他重写之上。

```
RewriteCond %{HTTPS} off
RewriteCond %{REQUEST_URI} ^/secure/?.*$
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]

RewriteCond %{HTTPS} on 
RewriteCond %{REQUEST_URI} !^/secure/?.*$
RewriteRule ^(.*)$ http://%{HTTP_HOST}/$1 [R=301,L]

RewriteRule ^secure-form$ form/contract/secure-form [L]
RewriteRule ^secure-different-form$ form/contract/secure-different-form [L]
all other rewrite rules for specific pages follow

then the default rewrite further down...

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L] 
```

问题是当我添加规则来更改协议时，它最终会在 url 中显示“form/contract/secure-form”而不是“secure-form”。

这会使页面上的实际表单损坏，因为它使用该 url 来构建自己。

如果我取出更改协议的规则，它会在 url 中显示安全表单，但页面不安全。

我究竟做错了什么？

----更新---- 哦，经过20多个小时的搜索，我想我终于有了答案。因此，第一次通过时，https 关闭并打开。然后，由于 301，它再次运行，页面被发送到 form/contract/secure ......但这一次，https 开启。由于 uri 不再以安全开头，因此它会关闭 https。

希望这会对其他人有所帮助。

# java - 在 servlet 中关闭 http 连接后执行作业

> ID：12414811
> 
> 赞同：0
> 
> 时间：2012-09-13T21:08:15.623
> 
> 标签：java, tomcat, servlets

我希望用户发帖，处理帖子中的数据并将请求转发到 jsp 页面。jsp 页面被发送回给用户，但是服务器应该做一份工作。这项工作需要很多时间，所以用户不应该等待它。

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) {
  //... get posted data ...
  request.getRequestDispatcher("/page.jsp").forward(request, response);
  //do-someting
} 
```

我希望在连接关闭并且用户获取 page.jsp 后完成“做某事”。当然，“做某事”完全是服务器端的，比如更新数据库等。所以即使用户离开页面，服务器也会继续工作。在转发到 jsp 页面之后，我尝试刷新并关闭 servlet 中的输出流，但这会导致异常。jsp 页面中的刷新和关闭也会导致异常。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:16:41.323

如果您的工作（做某事）完全独立于应该在 jsp 中显示的内容，那么您可以使用以下方法之一：

*   计时器
*   一个线程（在线程池中）
*   像[Quartz](http://quartz-scheduler.org/)这样更强大的库，它将为您提供强大的调度功能

# c# - 使用另一个视图模型的参数实例化视图模型

> ID：12414812
> 
> 赞同：1
> 
> 时间：2012-09-13T21:08:26.917
> 
> 标签：c#, .net, mvvm, inversion-of-control, ioc-container

我正在尝试从 MainViewModel 实例化 SecondViewModel 注入第二个参数，这些参数是在 IoCContainer 中注册的服务和来自 MainVM 的对象。

代码是这样的：

```
class MainViewModel
{

    public MainViewModel()
    {
    }

    private string message = "the message";
    public string Message { get; set; }

}

class SecondViewModel
{

    public SecondViewModel(IService service, string message)
    {
    }

} 
```

现在，我知道我可以让 IoC Container 将 SecondViewModelFactory（承载服务实例）注入 MainViewModel，因此它可以通过它创建 SVM，但是如果 IService 的实现非常繁重，我不想实例化它，但当我真的需要它时。

如果我必须以类似的方式实例化其他 ViewModel 怎么办？我是否必须创建大量 VMFactories 和构造函数的参数？

如果我使用通用 ViewModelFactory，则需要实例化它，传递我拥有的每个 ViewModel 所需的所有服务，无论它们是否会被创建。

你知道我的案子有什么更好的解决方案吗？

感谢你们

# iphone-5 - iPhone 5 (4") 底部工具栏没有响应

> ID：12414817
> 
> 赞同：25
> 
> 时间：2012-09-13T21:08:53.500
> 
> 标签：iphone-5

我正在尝试修改应用程序以使用新的 iPhone 5、4" 屏幕。我添加了新的启动图像“Default-568h@2x.png”。之后一切似乎都很好。我观点的中间部分正在调整大小。

但是我注意到，在我有一个底部工具栏的视图中，工具栏上的按钮没有响应。看起来不错，但点击按钮什么也没做。相同的代码在 3.5" 屏幕的模拟器中运行正常。

有任何想法吗？

此视图位于导航控制器中。它由表格视图和工具栏组成。表格视图设置为调整高度。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-09-14T05:38:46.073

我有同样的问题，并注意到我的 window.frame.size.height 仍然是 480.0。

通过为**MainWindow.xib**文件启用**“启动时全屏”**解决了这个问题：

 **脚步：

1.  打开**MainWindow.xib**
2.  选择**窗口**元素
3.  打开**属性检查器**
4.  在**窗口**部分下，启用**启动时全屏**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T09:52:34.240

这个问题有两种解决方案：

1.  如果您使用 MainWindow，请按照以下步骤操作：

    一种。选择 MainWindow.xib b. 从属性检查器中可用的 Windows 选项中选择“启动时全屏显示”。

2.  如果您的应用程序不包含 MainWindow，则只需在 ViewDidLoad 中添加“Self.View.Frame = [UIScreen mainScreen].bounds”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T07:08:10.403

如果您的项目有 MainWindow.xib，那么您必须设置所有初始图像才能与您的应用程序兼容 iPhone 5 显示器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T02:15:59.937

我的项目没有使用 MainWindow.xib。我`viewDidLoad`在所有屏幕的视图控制器中添加了以下内容：

```
self.view.frame = [UIScreen mainScreen].bounds; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-25T10:09:38.053

添加

```
self.window.frame = [UIScreen mainScreen].bounds; 
```

在这种方法中：

```
-(BOOL)application:(UIApplication *)application 
didFinishLaunchingWithOptions:(NSDictionary*)options 
```

在你的`%your app name%AppDelegate.m`文件中**

# python - 使用点符号字符串“abcde”检查嵌套字典，自动创建缺失的级别

> ID：12414821
> 
> 赞同：14
> 
> 时间：2012-09-13T21:09:15.663
> 
> 标签：python, dictionary, nested, defaultdict

给定以下字典：

```
d = {"a":{"b":{"c":"winning!"}}} 
```

我有这个字符串（来自外部来源，我无法改变这个比喻）。

```
k = "a.b.c" 
```

我需要确定字典*是否有 key* `'c'`，如果没有，我可以添加它。

这适用于检索点符号值：

```
reduce(dict.get, key.split("."), d) 
```

但我不知道如何“减少”`has_key`支票或类似的东西。

我的最终问题是：给定`"a.b.c.d.e"`，我需要在字典中创建*所有必要的元素*，但如果它们已经存在，则不要踩它们。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-13T21:16:05.133

您可以使用无限的嵌套[defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)：

```
>>> from collections import defaultdict
>>> infinitedict = lambda: defaultdict(infinitedict)
>>> d = infinitedict()
>>> d['key1']['key2']['key3']['key4']['key5'] = 'test'
>>> d['key1']['key2']['key3']['key4']['key5']
'test' 
```

给定您的虚线字符串，您可以执行以下操作：

```
>>> import operator
>>> keys = "a.b.c".split(".")
>>> lastplace = reduce(operator.getitem, keys[:-1], d)
>>> lastplace.has_key(keys[-1])
False 
```

您可以设置一个值：

```
>>> lastplace[keys[-1]] = "something"
>>> reduce(operator.getitem, keys, d)
'something'
>>> d['a']['b']['c']
'something' 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-13T21:49:04.933

...或使用递归：

```
def put(d, keys, item):
    if "." in keys:
        key, rest = keys.split(".", 1)
        if key not in d:
            d[key] = {}
        put(d[key], rest, item)
    else:
        d[keys] = item

def get(d, keys):
    if "." in keys:
        key, rest = keys.split(".", 1)
        return get(d[key], rest)
    else:
        return d[keys] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-13T21:14:13.693

迭代方法怎么样？

```
def create_keys(d, keys):
    for k in keys.split("."):
        if not k in d: d[k] = {}  #if the key isn't there yet add it to d
        d = d[k]                  #go one level down and repeat 
```

如果您需要将最后一个键值映射到字典以外的任何其他内容，则可以将该值作为附加参数传递并在循环后设置：

```
def create_keys(d, keys, value):
    keys = keys.split(".")
    for k in keys[:-1]:
        if not k in d: d[k] = {}
        d = d[k]            
    d[keys[-1]] = value 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T22:37:28.503

```
d = {"a":{}}
k = "a.b.c".split(".")

def f(d, i):
    if i >= len(k):
        return "winning!"
    c = k[i]
    d[c] = f(d.get(c, {}), i + 1)
    return d

print f(d, 0)
"{'a': {'b': {'c': 'winning!'}}}" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-18T14:40:30.060

我认为这个讨论非常有用，但是为了我的目的只是获取一个值（而不是设置它），当一个键不存在时我遇到了问题。因此，只是为了将我的天赋添加到选项中，您可以`reduce`结合使用调整`dict.get()`来适应密钥**不**存在的情况，然后返回 None：

```
from functools import reduce
import re
from typing import Any, Optional

def find_key(dot_notation_path: str, payload: dict) -> Any:
    """Try to get a deep value from a dict based on a dot-notation"""

    def get_despite_none(payload: Optional[dict], key: str) -> Any:
        """Try to get value from dict, even if dict is None"""
        if not payload or not isinstance(payload, (dict, list)):
            return None
        # can also access lists if needed, e.g., if key is '[1]'
        if (num_key := re.match(r"^\[(\d+)\]$", key)) is not None:
            try:
                return payload[int(num_key.group(1))]
            except IndexError:
                return None
        else:
            return payload.get(key, None)

    found = reduce(get_despite_none, dot_notation_path.split("."), payload)

    # compare to None, as the key could exist and be empty
    if found is None:
        raise KeyError()
    return found 
```

在我的用例中，我需要在 HTTP 请求负载中找到一个键，它通常也可以包含列表。以下示例有效：

```
payload = {
    "haystack1": {
        "haystack2": {
            "haystack3": None, 
            "haystack4": "needle"
        }
    },
    "haystack5": [
        {"haystack6": None}, 
        {"haystack7": "needle"}
    ],
    "haystack8": {},
}

find_key("haystack1.haystack2.haystack4", payload)
# "needle"
find_key("haystack5.[1].haystack7", payload)
# "needle"
find_key("[0].haystack5.[1].haystack7", [payload, None])
# "needle"
find_key("haystack8", payload)
# {}
find_key("haystack1.haystack2.haystack4.haystack99", payload)
# KeyError 
```

**编辑：**添加列表访问器

# maps - 使用 Bing 主题将“类型”设置为图钉

> ID：12414823
> 
> 赞同：0
> 
> 时间：2012-09-13T21:09:19.377
> 
> 标签：maps, bing-maps, pushpin

我使用带有 bing 主题模块的最后一个版本的 bing 地图，我想添加一个类名以通过 css 隐藏它，我认为这是使用 typeName 属性完成的，但是使用 bing 主题它不起作用。该属性用于设置微图钉样式。有没有更好的办法？

还有什么是最好的方法以同样的方式有不同的图钉组类型，这样我就可以在地图中隐藏/显示图钉组。我应该使用多个实体层吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:01:24.970

嗯，不幸的是，他们`typeName`用 bing 主题模块破坏了该功能。

我想知道为什么你需要 CSS 来隐藏图钉。有一个布尔图钉选项`visible`，您可以切换它，是否有您不使用它的原因？如果你必须使用 css，必应主题模块中的微图钉似乎有一个`pin0`. 因此，您可以将以下样式添加到您的页面以隐藏所有它们（然后使用 jquery 稍后修改样式以取消隐藏）：

```
<style>
.pin0 {
    display:none
}
</style> 
```

> “还有什么是最好的方法，以同样的方式拥有不同组类型的图钉，这样我就可以在地图中隐藏/显示一组图钉。**我应该使用多个实体层**吗？”

是的

# binding - Silverlight 中基于绑定类型的不同控件行为

> ID：12414825
> 
> 赞同：0
> 
> 时间：2012-09-13T21:09:30.340
> 
> 标签：binding, silverlight-5.0

我在 Silverlight 中有一个自定义的 UserControl，它很简单，由 TextBlocks 和 TextBoxes 组成。我有一个类实体的层次结构如下：

*   Person 是一个抽象超类，包含属性 Name 和 Age
*   Man 是 Person 的子对象，添加了 FacialFeature 属性
*   Woman 是 Person 添加属性 LastMenstruated 和 HasHymen 的孩子

所以：

*   一个人包含属性名称和年龄
*   一个 Man 包含属性 Name、Age 和 FacialFeature
*   一个女人包含属性名称、年龄、LastMenstruated 和 HasHymen

我想要的是让我的 UserControl 简单地显示这些属性的值，如下所示：

如果 Person 是 Man 类型：

```
Name : Mark
Age : 23
FacialFeature : Fully Shaved 
```

或者如果 Person 是 Woman 类型：

```
Name : Jane
Age : 8
LastMenstruated : Never
HasHymen : Yes 
```

请记住，为了我的问题，这是一个简化的示例。

**我想要的是让我的 UserControl 显示不同的信息，并可能根据 Person 的运行时类型以不同的方式显示它。**

我曾考虑使用将打开 GetType(Person) 的 switch 语句在代码隐藏中创建控件，但我不喜欢这个，逻辑将在 UserControl 中。我想要一个让对象封装自己的显示的解决方案，这样如果我添加新类型的 Person，我不需要返回 UserControl 并为新类型添加案例等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:18:24.367

以您的男性/女性分裂为例，您需要将`Visibilty`元素绑定到通过带有参数的转换器显示的对象：

```
<TextBlock Visibility="{Binding SelectedPerson,
                        Converter={StaticResource GenderConverter},
                        ConverterParameter=Male)" /> 
```

然后在你的转换器中：

```
public class GenderConverter: IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if ((value is Man && parameter == "Male") ||
             value is Woman && parameter == "Female"))
            return Visibility.Visible;
        else
            return Visibility.Collapsed;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw NotImplementedException();
    }
} 
```

这意味着您不必将任意 UI 属性添加到您的类以让它们显示您想要的方式。

*我不是 100% 确定对象类型的测试（我没有在这台机器上安装 Silverlight 5）*

更多关于[`IValueConverter`接口](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter%28v=vs.95%29.aspx)的信息可以在 MSDN 上找到。

# jquery - Jquery如何在特定的div中循环数据

> ID：12414831
> 
> 赞同：0
> 
> 时间：2012-09-13T21:09:57.453
> 
> 标签：jquery, html, loops, each

在我的页面中，我有一个 div id="result" 并且这个 div 已经包含数据。

然后我有一个 ajax 调用来检索循环数据。

```
$.each(data, function(name, value) {
                document.write(value.email);
              });
// i tried  .html("#result")  but not working. 
```

如何将这些循环数据放入 div id="result" 并替换以前的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:11:35.213

你的语法不正确。你要：

```
$.each(data, function(name, value) {
    $("#result").html(value.email);
}); 
```

请参阅[该方法的文档](http://api.jquery.com/html/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:14:47.363

```
var html = '';
$.each(data, function(name, value) {
    html += value.email;
});

$('#result').html( html ); 
```

我认为，当您循环数据时，您似乎有多个 emeil 地址。因此，您可以创建一个包含所有循环数据（电子邮件）的字符串，然后将其设置为`html()`，而不是一次又一次`#request`地附加到循环内。`#result`

`.html()`将替换以前的数据并`#request`使用新结果更新该内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T21:23:56.280

您几乎接近了，但是您需要先构建 html，然后将其写入 div 内容..

```
var html = '';
$.each(data, function(name, value) {
     html += value.email;
 });

$("#result").empty().append(html); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T21:12:36.340

您需要将数据附加到结果 div：

```
var resultElement = $("#result");
$.each(data, function(name, value) {
    resultElement.append(value.email);
}); 
```

您所做的是写入文档而不是`result`div。

# javascript - 遍历 Handlebars 的对象？

> ID：12414834
> 
> 赞同：28
> 
> 时间：2012-09-13T21:10:05.570
> 
> 标签：javascript, jquery, templates, handlebars.js, mustache

所以这是我数据的一般要点（复制了 chrome webkit 检查器的外观）。

```
> Object
  > Fruit: Array[2]
    > 0: Object
       name: "banana"
       color: "yellow"
       animalthateats: "monkey"
       id: 39480
    > 1: Object
    length: 2
  > Vegetables: Array[179]
  > Dairy: Array[2]
  > Meat: Array[3]
  > __proto__: Object 
```

这就是我想要做的（一般来说）：

```
<select>
  <option value="">All Shows (default)</option>
  <optgroup label="Fruit">
    <option value="39480">Banana</option>
    <option value="43432">Strawberry</option>
  </optgroup>
  <optgroup label="Vegetables">
    <option value="3432">Broccoli</option>
  </optgroup>
</select> 
```

我对整个模板化的东西有点陌生，而且完成起来肯定看起来很不简单……如果我无论如何都可以使用 jQuery，那也可以，但最好只使用这个设置。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-12-22T16:37:56.710

只使用“这个”

```
`<script id="some-template" type="text/x-handlebars-template">
<option value="none">Selec</option>
{{#each data}}
    <optgroup label="{{@key}}">
    {{#each this}}
        <option value="{{id}}">{{name}}</option>
    {{/each}}
    </optgroup>
{{/each}}
</script>` 
```

[http://jsfiddle.net/rcondori/jfav4o6u/](http://jsfiddle.net/rcondori/jfav4o6u/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-14T03:47:02.187

您当前的数据格式给您带来了两个问题：

1.  Handlebars 真的想遍历数组，而不是对象。
2.  JavaScript 对象没有可靠的顺序。

如果您可以将数据重新排列为嵌套数组，您将会有更好的运气，如下所示：

```
var foods  = { /* what you already have */ };
var for_hb = [
        { name: 'Fruit',      foods: foods.Fruit },
        { name: 'Vegetables', foods: foods.Vegetables },
        //...
]; 
```

你可以用这样简单的东西来做到这一点：

```
var for_hb = [ ];
for(var k in foods)
    for_hb.push({name: k, foods: foods[k]});
for_hb.sort(function(a, b) {
    a = a.name.toLowerCase();
    b = b.name.toLowerCase();
    return a < b ? -1
         : a > b ? +1
         :          0;
});

var html = compiled_template({ groups: for_hb }); 
```

那么你的模板很简单：

```
<select>
  <option value="">All Shows (default)</option>
  {{#each group}}
    <optgroup label="{{name}}">
    {{#each foods}}
      <option value="{{id}}">{{name}}</option>
    {{/each}}
  {{/each}}
</select> 
```

您可以编写一个帮助程序来迭代一个对象，但如果您想确定一个合理的显示顺序，您仍然必须指定数组中的键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-14T06:38:37.387

您可以通过自定义组件执行此操作，请参见示例，我们的默认助手不支持此操作`{{each}}`（这是有意的）。

**样本数据：**

```
a = {a:'muhammad', b :'asif', c: 'javed', username: 'maxifjaved'} 
```

**

> 迭代抛出对象的在线演示
> 
> [http://emberjs.jsbin.com/yuheke/1/edit?html,js,输出](http://emberjs.jsbin.com/yuheke/1/edit?html,js,output)

**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T23:50:35.703

我更像是一个胡子男人:-{)

但是从这里的文档看来，这种事情会做到：

```
<select>
  <option value="">All Shows (default)</option>
  <optgroup label="Fruit">
    {{#each Fruit}}
    <option value="{{id}}">{{name}}</option>
    {{/each}}
  </optgroup>
  <!-- repeat for others-->
</select> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-21T14:20:58.560

至于 Handlebars-only 解决方案，我已经实现了这个逻辑：

```
{{#each Listings}} 

<a href="javascript:void(0)" title="" ><img src="    {{DefaultImage}}" alt=" {{Make}} {{Model}}" /> </a> 
```

# javascript - d3 nesting on several keys with a loop

> ID：12414837
> 
> 赞同：4
> 
> 时间：2012-09-13T21:10:17.617
> 
> 标签：javascript, csv, svg, nested, d3.js

I am using d3.nest() in order to make a hierarchical object from a CSV file.

Could you please help me understand why the following code does not work. I didn't manage to use the nesting function within a loop, as described below.

I have the following CSV file, taken from the examples on d3 website:

```
"type1","type2","type3","type4","type5","size"
"flare","analytics","cluster","AgglomerativeCluster","","3938"
"flare","analytics","cluster","CommunityStructure","","3812"
"flare","analytics","cluster","MergeEdge","","743"
"flare","analytics","graph","BetweennessCentrality","","3534"
"flare","analytics","graph","LinkDistance","","5731" 
```

This basic nesting works:

```
data = data.entries(csv)
        .key(function(d) {return d.type1; })
        .key(function(d) {return d.type2; })
        .key(function(d) {return d.type3; })
        .entries(csv); 
```

I want to use an array of values to specify my keys in order to modify them dynamically.

This works:

```
 var data = d3.nest();
    var nesting = ["type1","type2","type3"];
    data = data.key(function(d) {return d[nesting[0]]; });
    data = data.key(function(d) {return d[nesting[1]]; });
    data = data.key(function(d) {return d[nesting[2]]; });
    data = data.entries(csv); 
```

But it does not work with a loop...

```
 var data = d3.nest();
    for(var i=0;i<nesting.length;i++)
    {
        data = data.key(function(d) {return d[nesting[i]]; });
    }
    data = data.entries(csv); 
```

I can't understand why the loop version is not working... Maybe I miss something about the d3.nest() capabilities...

Also, I would like to know if there is a way to "skip" a nesting level if there is nothing filled at this level (ie: the "type5" level on all the lines from the extract above). How could I do that?

Thanks a lot for reading!

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-14T00:38:58.607

This isn't a problem with the `.nest()` operator, it's a problem with JavaScript closures. Any time you have this pattern:

```
for (var x=0; x < y; x++) {
    something.attachCallback(function() {
        // now do something with x
    });
} 
```

You are going to have problems with the closure. The inner anonymous function you're defining doesn't include a copy of the value of `x`, it includes a *reference* to the outer variable `x`, which will update when the outer variable updates. So by the end of your loop, the value of `x` in *every* one of your callback functions will be the final value of `x` in the loop (in the code above, `y`; in your code, `nesting.length`).

The D3 `.nest()` operator uses its `.key()` arguments as callbacks - they aren't executed until you call `.map()` or `.entries()`. So the problem above applies.

There are various ways to fix this; I tend to use `.forEach()` instead of a `for` loop. This doesn't work in older browsers, but neither will most of D3, so you're probably safe:

```
var data = d3.nest();
nesting.forEach(function(key) {
    data.key(function(d) {return d[key]; })
}); 
```

Another option is to use a separate function for callback definition. Passing the iterator variable to another function will "fix" its value, as the callback now has a reference to the argument of the creator function, not to the original `x` variable:

```
var data = d3.nest();

function addKey(index) {
    data.key(function(d) { return d[nesting[index]]; })
}

for(var i=0;i<nesting.length;i++) {
    addKey(i);
} 
```

There are a few other approaches as well, but in my opinion `forEach` is the most elegant.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-15T07:10:47.907

Late to the game, but this is a response to comment #2 above by @Ciwan. I don't have enough "reputation" to comment, so I have to answer here:

The result of `d3.nest()` is correctly:

```
{ key: something, values: [all,the,items,that,are,grouped,by,the,key] } 
```

If you'd rather have a count of those items, you can use d3.nest()'s rollup, like so:

```
var data = d3.nest().rollup(function(leaves) { return leaves.length; }) 
```

[Phoebe Bright's bl.ock](http://bl.ocks.org/phoebebright/raw/3176159/) is the canonical place to learn about d3.nest()

# google-chrome-extension - 用 img 标签替换图片 URL 文本，几秒钟后图片变成“破碎”

> ID：12414840
> 
> 赞同：0
> 
> 时间：2012-09-13T21:10:29.887
> 
> 标签：google-chrome-extension, google-plus, crossrider

我正在使用 Crossrider 为自己编写一个 Chrome 扩展程序。这很简单。它会抓取 URL 的评论并用`<img>`标签替换它们，以在评论中内嵌显示图像。

我尚未编写正则表达式检查以确定 URL 是否指向图像，但我一直在对带有图像 URL 的评论的帖子进行测试。

当页面加载时，图像 URL 被替换为`<img>`标签，并且图像**确实**显示...几秒钟。然后它变成一个“损坏的图像”图标。

我不确定发生了什么，除了似乎有两个图像请求，即使我的代码只执行一次。其中一个请求说它得到了 404，但是如果我在 Chrome 调试控制台中单击该请求，它会很好地显示图像，并且与没有得到 404 的请求的 URL 相同。

我的代码（同样，我还没有编写正则表达式匹配来查看 URL 是否指向图像）：

```
var $links;

$( '.Mi' ).has('a').each(function(i,e,a) {
    $links = $( e ).children('a');
    if ( $links.length > 0 ) {
        $links.each(function(i,e,a) {
            if ( !$( e ).has('img').length ) {
                $( e ).html( $('<img/>', { src: $(e).attr('href') }) );
            }
        });
    }
}); 
```

# php - 将使用 php 的 urlencode() 编码的字符串传递给 javascript 时出错

> ID：12414842
> 
> 赞同：0
> 
> 时间：2012-09-13T21:10:45.843
> 
> 标签：php, javascript, jquery, urlencode, decodeuricomponent

我有一个字符串从 php 脚本传递到用 rawurlencode() 编码的 jquery 脚本：

```
$str = '<test>';
echo rawurlencode($str); 
```

我正在尝试使用 decodeURIComponent 对其进行解码：

```
var decoded = decodeURIComponent(str); 
```

最后我还是得到了“%3Ctest%3E”。（我也尝试过 urlencode() 的结果相同。）我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:17:56.207

PHP端：

```
$str = htmlentities('<test>');
header("Content-type: application/json");
echo json_encode($str); 
```

Javascript方面：

```
var decoded = JSON.parse(answer);
$('#ui-tabs-1').append(decoded); 
```

通过这种方式，您也可以将数组或对象从 PHP 传递到您的 JS 代码。

更多信息[在这里](http://www.json.org/)

# algorithm - 如何在添加块后检测永远不会成为最短路径一部分的网格上的正方形？

> ID：12414843
> 
> 赞同：13
> 
> 时间：2012-09-13T21:10:51.393
> 
> 标签：algorithm, graph, graph-theory, path-finding, shortest-path

我有一个带有开始、结束和一些墙壁的网格。单位从起点到终点采用最短路径*（仅向上/向下/向左/向右移动）*，无需穿过墙壁。

![最短路径](../Images/64403d85414b59594538a676273cbb8a.png)

用户可以添加任意数量的额外墙来更改路径。

![添加墙壁](../Images/a166bc723eeb7e831881fc338a2dd991.png)

但是，请注意，无论添加多少墙或添加它们的位置，都有一些正方形**永远不会**成为最短路径的一部分！

![这些正方形永远不能成为最短路径的一部分！](../Images/3fe2a5e561b77b71dfebc58841d3bcbc.png)
*这些正方形永远不能成为最短路径的一部分！*

我正在寻找一种方法来检测哪些正方形永远不会成为最短路径的一部分。

* * *

上述案例很容易找到；但还有更复杂的情况。考虑：

![没有一个带红点的方块可以成为最佳路径的一部分](../Images/ba0ecddf012f2e3c8c21bd556d6c0efe.png)

在上图中，没有一个带有红点的方块是最佳路径的一部分，因为该区域只有一个入口，而且只有两个空间宽。如果它是三个空间宽，或者如果任何一堵墙被移除，那么这些方块中的大部分都可能成为最佳路径的一部分。

我一直在尝试找出一种方法来检测上述情况（主要使用最小切割和洪水填充），但没有成功。有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T04:30:20.943

考虑从 S 到 F 的任何路径。该路径可能是最短路径（如果您删除每隔一个正方形），除非您可以仅使用这些图块采取“捷径”。仅当您有两个在路径中不相邻的相邻方格时才会发生这种情况。所以你需要考虑所有相邻的正方形对；他们从 S 或 F 断开的任何东西（没有从 F 断开 S）都不能成为最短路径的一部分。此外，可以通过单个正方形断开的图块不能成为从 S 到 F 的任何路径（不重复顶点）的一部分，因此它们也需要去。

设 N 为网格中的方格数。对于任何特定的正方形对（其中有 O(N) 个），可以在 O(N) 时间内使用洪水填充计算断开的内容，因此这是 O(N^2)。这比你提到的尝试的 min-cut 便宜，所以我认为它对你来说足够便宜。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T03:42:54.187

首先我们看到，**可以被一个或两个相邻网格阻挡的区域永远不会在任何最短路径**上。

请参阅您的示例中的情况，正是这两个黄色网格使点被阻塞。

![在此处输入图像描述](../Images/2e1dd8e7fffb807a80d5aad1d4e254bd.png)

被一格挡住很容易理解。当被两个人阻止时：

1.  如果不相邻，我们可能会添加额外的墙壁以使其成为唯一的路径，通过其中一个进入并从另一个出来，所以我们可能需要内部的。
2.  如果相邻，我们总是可以直接从一个到另一个，所以我们仍然不需要那个区域内的网格。

所以算法来了：

枚举每个空网格

1.  在上面放一堵墙并使用洪水填充物找到被阻塞的区域，它们没有用。
2.  尝试在它的四个相邻网格之一上放一堵墙（如果是空的），使用洪水填充找到被阻塞的区域，它们没有用。

# ios - resizableImageWithCapInsets:resizingMode: 在 iOS 5.1 上崩溃

> ID：12414844
> 
> 赞同：4
> 
> 时间：2012-09-13T21:10:54.510
> 
> 标签：ios, xcode, uiimage

我正在使用此代码正确拉伸图像，但是在 iOS 5.1 上它会崩溃。如果我从最后删除 resizingMode，它会起作用，但图像会被平铺并且看起来很有趣。任何想法为什么它会崩溃？

谢谢

```
self.scrollViewImage.image = [[UIImage imageNamed:@"SysInfoBackBox"] resizableImageWithCapInsets:UIEdgeInsetsMake(40, 40, 40, 40) resizingMode:UIImageResizingModeStretch]; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T21:23:51.590

这是 iOS 6.0 中引入的一种新方法，以前的版本不支持。如果您想让代码在以前的版本上运行，您必须在运行时检查 UIImage 实例是否响应该方法的选择器，如果没有，则实施替代方案。

```
if ([UIImage instancesRespondToSelector:@selector(resizableImageWithCapInsets:resizingMode:)]) {
    self.scrollViewImage.image = [[UIImage imageNamed:@"SysInfoBackBox"] resizableImageWithCapInsets:UIEdgeInsetsMake(40, 40, 40, 40) resizingMode:UIImageResizingModeStretch];
} else {
    // alternative
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-11T12:01:46.163

此功能 `resizableImageWithCapInsets:resizingMode:` 不适用于 ios 5.0（仅 >=6.0），但 `resizableImageWithCapInsets:` 可以尝试使用它。也许一个简单的替换可以帮助你。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-31T12:15:41.613

我重播了另一个应该与您的问题有关的问题[https://stackoverflow.com/a/14623534/2028575](https://stackoverflow.com/a/14623534/2028575)

但如果你愿意，我可以在这里放一个简单的答案：

这只发生在 iOS5.x 调整 UIImageView 大小的设备上，该 UIImageView 显示以这种方式创建的 UIImage：

```
 UIEdgeInsets edgeInsets = UIEdgeInsetsMake(topCapHeight, leftCapWidth, topCapHeight, leftCapWidth);
    image = [originalImage resizableImageWithCapInsets:edgeInsets]; 
```

这可能是 iOS6.x 中已修复的 iOS 错误

如果您的情况是使用镜像标准调整图像大小，您可以使用这种方式：

创建一个 UIImage 类别并添加此实例方法：

```
- (UIImage*)resizableImageWithLeftCapWidth:(NSInteger)leftCapWidth topCapHeight:(NSInteger)topCapHeight </b>
{
    UIImage *image = nil;    
    float osVersion = [[[UIDevice currentDevice] systemVersion] floatValue];
    if (osVersion < 6.0) {
        image = [self stretchableImageWithLeftCapWidth:leftCapWidth topCapHeight:topCapHeight];
    } else {
        UIEdgeInsets edgeInsets = UIEdgeInsetsMake(topCapHeight, leftCapWidth, topCapHeight, leftCapWidth);
        image = [self resizableImageWithCapInsets:edgeInsets];
    }
    return image;
} 
```

方法 ： `- (UIImage *)stretchableImageWithLeftCapWidth:(NSInteger)leftCapWidth topCapHeight:(NSInteger)topCapHeight`

已在 iOS 文档中被弃用但不在框架中，这意味着您可以在 iOS5.x 设备上运行应用程序时使用它而不会出现任何问题，并在 iOS 6 或更高版本的设备上使用新支持的方法.

# objective-c - Obj-C 中 OS X 上的自动存储有什么限制，为什么我需要使用 malloc 而不是大型数组的普通自动数组？

> ID：12414847
> 
> 赞同：1
> 
> 时间：2012-09-13T21:11:05.650
> 
> 标签：objective-c, arrays, macos

今天遇到一个奇怪的错误，还是没看懂：

```
long long N = 2000;
long long N2 = N*N;
long long *s = malloc(sizeof(long long)*N2); // create array
// populate it
for (long long k = 1; k <= 55; k++) { 
```

不会产生任何错误，但是

```
long long N = 2000;
long long N2 = N*N;
long long s[4000000]; // create array
// populate it
for (long long k = 1; k <= 55; k++) { 
```

*在将 1 分配给 k之前*`for`（根据调试器），在行上给我一个 code=2 EXC_BAD_ACCESS ，就好像没有空间可以分配另一个 8 字节变量一样。此代码位于方法的开头；没有分配或分配其他变量。我猜我根本无法将 4000000 个元素的 long long 数组分配给堆栈，但不知何故我可以将它分配给动态堆。有人可以解释发生了什么，限制是什么等？这是运行 Mountain Lion、2GB RAM 的 Mac 上的 Objective-C。long long 是 8 字节宽，所以数组应该只有 32MB；我不明白为什么这应该是一个问题。

 *谢谢！

（顺便说一句，如果细节看起来很熟悉，那是因为这是我解决 Project Euler[问题 149](http://projecteuler.net/problem=149)的开始。我已经避免在这里提到解决方案的任何细节，因为我已经解决了这个问题。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:20:14.583

您的第一个示例从堆中分配内存，位于“数据段”中，第二个示例在堆栈上分配内存，位于“堆栈段”中。这些中的每一个都有不同的大小限制。

根据[Technical Q&A QA1419](http://developer.apple.com/library/mac/#qa/qa1419/_index.html)，默认堆栈段大小限制为 8 MiB。您可以通过`ulimit -a`在终端中运行来仔细检查：

```
:; ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
file size               (blocks, -f) unlimited
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) unlimited
open files                      (-n) 256
pipe size            (512 bytes, -p) 1
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 709
virtual memory          (kbytes, -v) unlimited 
```

如您所见，堆栈大小限制为 8192 KiB = 8 MiB。

我上面链接的技术问答描述了一些增加堆栈大小限制的方法。在不以 root 身份运行的情况下，您可以将其增加到的最大值为 64 MiB。

如果您创建线程，则每个线程都有自己的堆栈。根据问答，如果您使用`NSThread`API，则可以将线程的堆栈大小设置为 1 GiB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T21:19:35.337

自动本地分配在堆栈上；根据[此技术说明](http://developer.apple.com/library/mac/#qa/qa1419/_index.html)，OSX 进程的主线程的默认堆栈大小为 8MB，而附加线程的堆栈大小则更少。您可以尝试`setrlimit`注释中给出的链接器选项或解决方案，但 C 的传统是将堆用于任何大型分配。*

# mysql - 使用比较运算符时的 MYSQL 性能

> ID：12414848
> 
> 赞同：1
> 
> 时间：2012-09-13T21:11:12.753
> 
> 标签：mysql, database, performance, query-optimization

我有一个带有大约 40k 条目的表的 mysql 数据库。执行以下语句大约需要 10 秒（已选择数据库）：

`SELECT * FROM MyTable WHERE Column < 3`

为什么这需要这么长时间，我该如何提高性能？
其他数据库更快吗？（例如 MongoDB、CouchDB、...） 不过我更喜欢使用 MySQL 数据库。

编辑：

以下查询...

```
EXPLAIN SELECT * FROM MyTable WHERE Column < 3; 
```

结果如下：

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  Occurances  index   NULL    SearchString    102 NULL    40242   Using where; Using index 
```

以下查询显示了 Column 中值的分布

```
SELECT COUNT(*), Column FROM MyTable GROUP BY Column; 
```

结果如下：

```
COUNT(*)    Column
43      0
5       1
106     2
71      3
42      4
283     5
2337    6
9491    7
22073   8
1191    9
1064    10
1105    11
919     12
393     13
288     14
288     15
200     16
123     17
71      18
71      19
36      20
10      21
13      22
8       23
4       24
3       25
4       29 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:14:24.637

我冒昧地猜测您在该`Column`列上没有索引。尝试创建一个：

```
CREATE INDEX idx_MyTable_Column ON MyTable (Column); 
```

尝试比较`EXPLAIN`创建索引之前和之后的输出：

```
EXPLAIN SELECT * FROM MyTable WHERE Column < 3; 
```

您应该看到使用索引执行了索引扫描（或更好）。

只有当足够小的行集符合您的条件时，索引才会对您有所帮助。如果大多数表与表达式匹配，`Column < 3`那么索引将无济于事，并且规划器将退回到表扫描，因为这会比使用索引更快。

* * *

如果您想要更详细的答案，则必须提供更多信息。这两个查询的输出会有所帮助：

```
EXPLAIN SELECT * FROM MyTable WHERE Column < 3;
SELECT COUNT(*), Column FROM MyTable GROUP BY Column; 
```

以及上的索引列表`MyTable`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:30:46.987

您应该使用 Apache Solr 作为索引，但速度会太快，例如使用 Apache Solr instagram Netflix、eBay、Digg、AOL 等。

您阅读了有关 apache solr 的信息。我相信您会获得更多参考

[apache solr http://lucene.apache.org/solr](http://lucene.apache.org/solr/)

[维基 apache solr](http://wiki.apache.org/solr)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:23:09.767

对于 40k 条记录的简单选择，这似乎异常缓慢。如果表太大而无法存储在内存中（即可用内存非常少或者您将大文件直接存储在表中），那么 MySQL 将花费更长的时间来运行查询。

对列进行索引也会产生巨大的差异，尽管对于一个适合内存的表来说，即使在条件列上没有索引，10 秒似乎非常慢。

[为什么 MySQL 对大表可能会很慢？](http://www.mysqlperformanceblog.com/2006/06/09/why-mysql-could-be-slow-with-large-tables/)

# python - “不匹配格式”错误从字符串解析日期时间

> ID：12414858
> 
> 赞同：0
> 
> 时间：2012-09-13T21:11:44.390
> 
> 标签：python

试图从字符串解析时间，但得到这个错误。尝试了一些格式化字符串。

## 错误：

```
time data '10/2/2010 0:00:00' does not match format '"%m/%d/%Y %H:%M:%S"' 
```

## 代码：

```
strdt = '10/2/2010 0:00:00'
dt = datetime.strptime(strdt, '"%m/%d/%Y %H:%M:%S"') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T21:16:26.357

您的格式中有引号。把那些拿出来。

```
dt = datetime.strptime(strdt, '%m/%d/%Y %H:%M:%S') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T21:17:03.040

尝试从格式 '"%m/%d/%Y %H:%M:%S"' -> '%m/%d/%Y %H:%M:%S' 中删除引号

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T21:28:45.150

或者你可以使用[dateutil](http://niemeyer.net/python-dateutil)：

```
In [68]: import dateutil.parser as parser

In [69]: parser.parse('10/2/2010 0:00:00')
Out[69]: datetime.datetime(2010, 10, 2, 0, 0) 
```

* * *

请注意，默认情况下，`parser.parse`解释`10/2/2010`为`MM/D/YYYY`格式。

如果您的字符串有月份的前一天，则使用

```
parser.parse("10/2/2010", dayfirst = True) 
```

还有 yearfirst 选项；有关更多详细信息，请参阅[文档](http://niemeyer.net/python-dateutil)。

# javascript - element.css('filter') 在 jQuery 1.8 中返回 undefined

> ID：12414860
> 
> 赞同：2
> 
> 时间：2012-09-13T21:12:07.693
> 
> 标签：javascript, jquery, css, internet-explorer, filter

假设您具有以下样式（过滤器或-ms-filter，没关系）：

```
<style type="text/css">
    #someID {
        -ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#FFFFFF, endColorstr=#ECECEC)";
    }
</style> 
```

在 jQuery 1.7 中，以下脚本用于读取 IE 过滤器属性...

```
<script type="text/javascript">
    $(function(){
        alert($('#someID').css('filter'));
    });
</script> 
```

现在在 jQuery 1.8+ 中返回 undefined。a) 这是 jQuery 1.8 中的错误吗？b) 还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T22:42:12.113

我也找不到在 jQuery 中执行此操作的方法，但我找到了一种在普通 javascript 中执行此操作的方法（仅适用于 IE，您需要捕获它，以便其他浏览器不会失败）。

```
var _someID = document.getElementById('someID');
var someIdGradientFilter = _someID.filters.item('DXImageTransform.Microsoft.gradient');
alert("startColorstr: " + someIdGradientFilter.startColorstr + "\nendColorstr: " + someIdGradientFilter.endColorstr); 
```

# javascript - 为什么它在 IE 7 中不能按预期工作？

> ID：12414861
> 
> 赞同：3
> 
> 时间：2012-09-13T21:12:08.993
> 
> 标签：javascript, jquery, html, css, navigation

![导航的预期行为](../Images/e009c54a94a9d00c8746ef11b623eca8.png)

![IE7 导航行为](../Images/b06937f4b284fb71b25ecf1ecd80f329.png)

由于与客户的知识产权问题，我无法讨论任何代码。

IE7 中的两个标签之间有一条线或空格，`LI`而 Firefox 或 Chrome 中不存在这些标签。

我非常努力地发现问题出在哪里。我想经过 6 小时的尝试。所以任何新的想法都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T10:19:51.343

首先，尝试集成一个好的 CSS 重置（你可以在 www.html5boilerplate.com 上找到一个好的）。

其次，我只能假设菜单 CSS/HTML 代码（为什么不在这里发布代码？在线时，每个人都可以阅读您的 css/js/html 代码！）：

HTML：

```
<div class="menu">
  <ul>
     <li>menu item</li>
     <li>menu with subitem
         <ul>
            <li>sub menu item</li>
            ...
         </ul>
     </li>
     ... 
```

CSS：

```
.menu ul {
   ... 
```

}

我可以建议这种重置：

```
.menu ul, .menu li {
   margin: 0 !important;
   padding: 0 !important;
   display: block;
   list-style: none;
} 
```

并尝试使用子元素（`span`, `a`, ecc.）获取其他填充/间距。

# c# - 在 C# 中比较 AM、PM 格式的时间值

> ID：12414864
> 
> 赞同：4
> 
> 时间：2012-09-13T21:12:30.863
> 
> 标签：c#, .net, string, list

我有一个格式为“09.00 AM，12.00 PM，03.00 PM”等的时间值列表。让我们称之为ListTimes ..我有一个相同格式的时间值（testTimeValue）“xx.xx AM/PM”我正在传递给一个函数。我希望该函数将此“testTimeValue”与 ListTimes 中的每个项目进行比较，并返回最接近的时间。例如：在上述场景中，如果我将 01.00 PM 传递给函数，它应该返回 03.00 PM。

```
foreach (string item in listItems)
{
    //I need to consider the time formats in AM and PM and do a
    //proper comparison and return the closest in original format.                                           
}

return closestTimeValue; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T21:18:08.147

每次，运行`DateTime.ParseExact`

```
List<string> listTimes = new List<string>() { "09.00 AM", "12.00 PM", "03.00 PM" };
string testTimeString = "01.00 PM";
DateTime testTime = DateTime.ParseExact(testTimeString, "hh.mm tt", CultureInfo.InvariantCulture);
DateTime closestTime = DateTime.MinValue;
TimeSpan closestDifference = TimeSpan.MaxValue;

foreach (string item in listTimes)
{
    DateTime itemTime = DateTime.ParseExact(item, "hh.mm tt", CultureInfo.InvariantCulture);
    TimeSpan itemDifference = (itemTime - testTime).Duration();

    if (itemDifference < closestDifference)
    {
        closestTime = itemTime;
        closestDifference = itemDifference;
    }
}

return closestTime.ToString("hh.mm tt"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:48:51.487

有趣的问题:) 我写了这个小测试程序来尝试一下。如果您认为它有意义，您应该能够根据您的需要进行调整。基本上，从一个基本日期时间开始，在相同的 24 小时内生成一个随机的“测试”，然后随机生成一堆额外的时间，然后看看哪个与测试值的差异最小（在你的情况下会成为被比较的那个）。

```
List<DateTime> times = new List<DateTime>();

Random rnd = new Random();
int hourCount = (24 * 60) - 1;

DateTime dtBase = DateTime.Parse("01/01/2012 12:00 AM");
DateTime dtTest = dtBase.AddMinutes(rnd.Next(0, hourCount));

Console.WriteLine("Base: " + dtBase.ToString());
Console.WriteLine("Test: " + dtTest.ToString());
Console.WriteLine();

for (int i = 0; i < 24; i++) {
    times.Add(dtBase.AddMinutes(rnd.Next(0, hourCount)));
}

times.Sort();

TimeSpan lastSpan = TimeSpan.MaxValue;
DateTime dtMatch = DateTime.Now;

foreach (DateTime dt in times) {
    Console.Write(" " + dt.ToString());
    var diff = (dtTest - dt).Duration();
    if (diff < lastSpan) {
        lastSpan = diff;
        dtMatch = dt;
    }
    Console.WriteLine();
}

Console.WriteLine();
Console.WriteLine("Closest match to {0:hh:mm tt} => {1:hh:mm tt} ({2})", dtTest, dtMatch, lastSpan); 
```

示例输出运行：

```
Base: 1/1/2012 12:00:00 AM
Test: 1/1/2012 3:28:00 AM

 1/1/2012 1:03:00 AM
 1/1/2012 2:51:00 AM
 1/1/2012 2:52:00 AM
 1/1/2012 3:22:00 AM
 1/1/2012 4:30:00 AM
 1/1/2012 4:36:00 AM
 1/1/2012 5:50:00 AM
 1/1/2012 5:55:00 AM
 1/1/2012 6:50:00 AM
 1/1/2012 7:05:00 AM
 1/1/2012 7:17:00 AM
 1/1/2012 8:53:00 AM
 1/1/2012 9:25:00 AM
 1/1/2012 11:59:00 AM
 1/1/2012 12:22:00 PM
 1/1/2012 12:51:00 PM
 1/1/2012 2:04:00 PM
 1/1/2012 3:01:00 PM
 1/1/2012 3:26:00 PM
 1/1/2012 4:19:00 PM
 1/1/2012 6:15:00 PM
 1/1/2012 11:02:00 PM
 1/1/2012 11:28:00 PM
 1/1/2012 11:50:00 PM

Closest match to 03:28 AM => 03:22 AM (00:06:00) 
```

因此，您的实际功能如下所示：

```
DateTime GetClosestTime(DateTime testTimeValue, List<DateTime> listItems) {

    TimeSpan lastSpan = TimeSpan.MaxValue;
    DateTime dtMatch = DateTime.Now;

    foreach (DateTime dt in listItems) {
        var diff = (testTimeValue - dt).Duration();
        if (diff < lastSpan) {
            lastSpan = diff;
            dtMatch = dt;
        }
    }

    return dtMatch;
} 
```

假设您有时间与其他位置进行比较，您可以重写它以省略`testTimeValue`参数。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T21:49:20.413

这是一个 Linq 版本，虽然这比 Guvante 的回答慢：

```
List<string> ListTimes = new List<string>() { "09.00 AM", "12.00 PM", "03.00 PM" };
string testTimeString = "01.00 PM";
DateTime testTime = DateTime.ParseExact(testTimeString, "hh.mm tt", CultureInfo.InvariantCulture);

return ListTimes
    .Select(x => new
    {
        Time = x,
        Difference = (DateTime.ParseExact(x, "hh.mm tt", CultureInfo.InvariantCulture) - testTime).Duration()
    })
    .OrderBy(x => x.Difference)
    .First().Time; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T21:37:40.523

首先我相信数据类型是 DateTime

```
 List<DateTime> dates = new List<DateTime>();
            dates.Add(DateTime.Parse("9/11/2001 1:00 PM"));
            dates.Add(DateTime.Parse("9/11/2001 10:00 AM"));
            dates.Add(DateTime.Parse("9/11/1002 3:00 PM"));
            DateTime dateComp = DateTime.Parse("9/11/2001 11:00 AM");
            DateTime? dateClosest = null;
            foreach (DateTime dt in dates)
            {
                if (dateClosest == null) dateClosest = dt;
                else
                {
                    if( (dateComp.Subtract(dt).TotalMilliseconds) <
                         dateComp.Subtract((DateTime)dateClosest).TotalMilliseconds)
                    {
                        dateClosest = dt;
                    }
                }
            } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T22:24:06.600

你可以自己写。解决这样的任务甚至很有趣......有时））

```
static void Main(string[] args)
{    
     var listTimes = new string[] {"09.00 AM", "12.00 PM", "03.00 AM"};
     const string testTimeValue = "02.00 PM";
     Console.WriteLine(CompareFunction(listTimes, testTimeValue));
}

public static string CompareFunction(IEnumerable<string> listTimes, string testTimeValue)
{
     double minDiff = double.MaxValue;
     string result = string.Empty;

     foreach(string listTime in listTimes)
     {
          double difference = GetDifference(listTime, testTimeValue);
          if(difference < minDiff)
          {
                minDiff = difference;
                result = listTime;
          }
     }
     return result;
}

private static double GetDifference(string time1, string time2)
{
     return Math.Abs(ConvertStringTime(time1).TotalMinutes - ConvertStringTime(time2).TotalMinutes);
}

private static TimeSpan ConvertStringTime(string time)
{
     Regex validationRegex = new Regex(@"\d\d.\d\d AM|PM");
     if(!validationRegex.IsMatch(time)) throw new FormatException("Input time string was not in correct format");

     Regex hoursRegex = new Regex(@"\d\d.");
     Regex minutesRegex = new Regex(@".\d\d");
     bool postMeridiem = time.Contains("PM");

     string hstring = hoursRegex.Match(time).ToString().Replace(".", string.Empty);
     string mstring = minutesRegex.Match(time).ToString().Replace(".", string.Empty);

     double h = postMeridiem ? double.Parse(hstring) + 12 : double.Parse(hstring);
     double m = double.Parse(mstring);

     return new TimeSpan(0, (int)h, (int)m, 0);
} 
```

# css - Droid Web 浏览器填充或边距

> ID：12414868
> 
> 赞同：0
> 
> 时间：2012-09-13T21:12:49.580
> 
> 标签：css, mobile, browser, width

[http://m.snacknetworx.com/](http://m.snacknetworx.com/)在网络浏览器中完全 100% 宽，在 HTC Incredible 上，两边都有填充和/或边距。我创建了一个测试页面来测试复制问题： [http](http://m.snacknetworx.com/test.php) ://m.snacknetworx.com/test.php 只有一个带有内联 css 的 div：

测试...

问题是这个 div 没有到达 HTC 浏览器的边缘，同样的填充和/或边距问题，但在网络浏览器中达到 100%。

有谁知道如何在移动浏览器上获得 100% 的宽度？

# asp.net-mvc - 返回 HttpPostedFileBase 以查看验证错误

> ID：12414872
> 
> 赞同：7
> 
> 时间：2012-09-13T21:13:17.240
> 
> 标签：asp.net-mvc, modelstate, httppostedfilebase

当我尝试将图像上传到我的 MVC 控制器操作并且出现验证错误时，我必须单击每个按钮并再次找到我的所有文件。

如果我的观点包括

```
<input type="file" id="file0" name="Files[0]" />
<input type="file" id="file1" name="Files[1]" /> 
```

和一个控制器动作，比如

```
public ActionResult Create(ModelClass model, IEnumerable<HttpPostedFileBase> Files)
{
    if(ModelState.IsValid)
    {
        //do work
        if(PhotoValidation.IsValid(Files))
        {
            //do work
        }
        else 
        {
            ModelState.AddModelError("","Photos not valid");
        }
    }
    return view(model); // Way to return photos back to the view on modelstate error?
} 
```

文件可以很好地发布到服务器，但是如果出现模型验证错误，有没有办法返回模型和文件，这样用户就不必再次上传它们了？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T07:09:43.757

这是不可能的。intput type="file" 的值从不用于解析 HTML 页面。这是一个巨大的安全风险，因此没有现代浏览器允许它们“保留”值。

如果您确定您的客户正在使用支持 HTML5 的浏览器，您可以尝试使用 JavaScript File API 来消除回发 - 请查看以下文章：

*   [在 JavaScript 中处理文件，第 1 部分：基础知识](http://www.nczonline.net/blog/2012/05/08/working-with-files-in-javascript-part-1/)
*   [在 JavaScript 中处理文件，第 2 部分：FileReader](http://www.nczonline.net/blog/2012/05/15/working-with-files-in-javascript-part-2/)
*   [在 JavaScript 中处理文件，第 3 部分：进度事件和错误](http://www.nczonline.net/blog/2012/05/22/working-with-files-in-javascript-part-3/)
*   [在 JavaScript 中处理文件，第 4 部分：对象 URL](http://www.nczonline.net/blog/2012/05/31/working-with-files-in-javascript-part-4-object-urls/)
*   [在 JavaScript 中处理文件，第 5 部分：Blob](http://www.nczonline.net/blog/2012/06/05/working-with-files-in-javascript-part-5-blobs/)

# python - 如何将 Python 的 GTK 与 gevent 集成？

> ID：12414874
> 
> 赞同：6
> 
> 时间：2012-09-13T21:13:32.097
> 
> 标签：python, winapi, gtk, gevent, gtk3

Gtk 是一个与 Python 绑定的 GUI 工具包。Gevent 是一个 Python 网络库，构建在 libevent（较新版本的 libev）和 greenlets 之上，允许在 greenlets 中使用网络函数而不会阻塞整个过程。

Gtk 和 gevent 都具有调度事件的阻塞主循环。如何集成它们的主循环，以便我可以在我的应用程序上接收网络事件和 UI 事件，而不会阻塞另一个？

天真的方法是在 Gtk 的主循环上注册一个空闲回调，当没有 Gtk 事件时调用它。在这个回调中，我们产生了 greenlet，所以网络事件可以发生，同时也给出了一个小的超时，所以进程不会忙等待：

```
from gi.repository import GLib
import gevent

def _idle():
    gevent.sleep(0.1)
    return True

GLib.idle_add(_idle) 
```

这种方法远非理想，因为我在 UI 事件处理之间有 100 毫秒的延迟，如果我将值降低太多，我会浪费太多的处理器忙于等待。

我想要一种更好的方法，在没有事件要处理的情况下，我的进程真正处于睡眠状态。

PS：我已经找到了一个特定于 Linux 的解决方案（也可能在 MacOS 下工作）。我现在真正需要的是一个有效的 Windows 解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T21:13:32.097

鉴于当前的 gevent API，我认为没有通用的解决方案，但我认为每个平台可能都有特定的解决方案。

## Posix解决方案（在Linux下测试）

由于 GLib 的主循环接口允许我们设置 poll 函数，即获取一组文件描述符并在其中一个准备好时返回的函数，我们定义了一个 poll 函数，它依赖于 gevent 的 select 来知道文件描述符何时准备好.

Gevent 没有暴露`poll()`接口，`select()`接口有点不同，所以我们在调用的时候要翻译参数和返回值`gevent.select.select()`。

使事情复杂一点的是，GLib 没有通过 Python 的接口公开`g_main_set_poll_func()`允许该技巧的特定功能。所以我们必须直接使用C函数，为此，`ctypes`模块就派上用场了。

```
import ctypes
from gi.repository import GLib
from gevent import select

# Python representation of C struct
class _GPollFD(ctypes.Structure):
    _fields_ = [("fd", ctypes.c_int),
                ("events", ctypes.c_short),
                ("revents", ctypes.c_short)]

# Poll function signature
_poll_func_builder = ctypes.CFUNCTYPE(None, ctypes.POINTER(_GPollFD), ctypes.c_uint, ctypes.c_int)

# Pool function
def _poll(ufds, nfsd, timeout):
    rlist = []
    wlist = []
    xlist = []

    for i in xrange(nfsd):
        wfd = ufds[i]
        if wfd.events & GLib.IOCondition.IN.real:
            rlist.append(wfd.fd)
        if wfd.events & GLib.IOCondition.OUT.real:
            wlist.append(wfd.fd)
        if wfd.events & (GLib.IOCondition.ERR.real | GLib.IOCondition.HUP.real):
            xlist.append(wfd.fd)

    if timeout < 0:
        timeout = None
    else:
        timeout = timeout / 1000.0

    (rlist, wlist, xlist) = select.select(rlist, wlist, xlist, timeout)

    for i in xrange(nfsd):
        wfd = ufds[i]
        wfd.revents = 0
        if wfd.fd in rlist:
            wfd.revents = GLib.IOCondition.IN.real
        if wfd.fd in wlist:
            wfd.revents |= GLib.IOCondition.OUT.real
        if wfd.fd in xlist:
            wfd.revents |= GLib.IOCondition.HUP.real
        ufds[i] = wfd

_poll_func = _poll_func_builder(_poll)

glib = ctypes.CDLL('libglib-2.0.so.0')
glib.g_main_context_set_poll_func(None, _poll_func) 
```

我觉得应该有更好的解决方案，因为这样我们需要知道正在使用的 GLib 的具体版本/名称。`g_main_set_poll_func()`如果 GLib在 Python 中公开，则可以避免这种情况。此外，如果`gevent`实施`select()`，它可以很好地实施`poll()`，什么会使这个解决方案更简单。

## Windows 部分解决方案（又丑又坏）

Posix 解决方案在 Windows 上失败，因为`select()`只能使用网络套接字，而给定的 Gtk 句柄则不是。所以我想在另一个线程中使用 GLib 自己的`g_poll()`实现（Posix 上的瘦包装器，它是 Windows 上相当复杂的实现）来等待 UI 事件，并通过 TCP 套接字将其与主线程中的 gevent 端同步. 这是一个非常难看的方法，因为它需要真正的线程（除了你可能会使用的greenlets，如果你正在使用gevent）和等待线程端的普通（非gevent）套接字。

太糟糕了 Windows 上的 UI 事件是由线程分割的，因此默认情况下一个线程不能等待另一个线程上的事件。在您执行一些 UI 操作之前，不会创建特定线程上的消息队列。所以我不得不`MessageBoxA()`在等待线程上创建一个空的 WinAPI 消息框（）（当然有更好的方法），并用它来处理线程消息队列，`AttachThreadInput()`以便它可以看到主线程的事件。这一切都通过`ctypes`.

```
import ctypes
import ctypes.wintypes
import gevent
from gevent_patcher import orig_socket as socket
from gi.repository import GLib
from threading import Thread

_poll_args = None
_sock = None
_running = True

def _poll_thread(glib, addr, main_tid):
    global _poll_args

    # Needed to create a message queue on this thread:
    ctypes.windll.user32.MessageBoxA(None, ctypes.c_char_p('Ugly hack'),
                                     ctypes.c_char_p('Just click'), 0)

    this_tid = ctypes.wintypes.DWORD(ctypes.windll.kernel32.GetCurrentThreadId())
    w_true = ctypes.wintypes.BOOL(True)
    w_false = ctypes.wintypes.BOOL(False)

    sock = socket()
    sock.connect(addr)
    del addr

    try:
        while _running:
            sock.recv(1)
            ctypes.windll.user32.AttachThreadInput(main_tid, this_tid, w_true)
            glib.g_poll(*_poll_args)
            ctypes.windll.user32.AttachThreadInput(main_tid, this_tid, w_false)
            sock.send('a')
    except IOError:
        pass
    sock.close()

class _GPollFD(ctypes.Structure):
    _fields_ = [("fd", ctypes.c_int),
                ("events", ctypes.c_short),
                ("revents", ctypes.c_short)]

_poll_func_builder = ctypes.CFUNCTYPE(None, ctypes.POINTER(_GPollFD), ctypes.c_uint, ctypes.c_int)
def _poll(*args):
    global _poll_args
    _poll_args = args
    _sock.send('a')
    _sock.recv(1)

_poll_func = _poll_func_builder(_poll)

# Must be called before Gtk.main()
def register_poll():
    global _sock

    sock = gevent.socket.socket()
    sock.bind(('127.0.0.1', 0))
    addr = sock.getsockname()
    sock.listen(1)

    this_tid = ctypes.wintypes.DWORD(ctypes.windll.kernel32.GetCurrentThreadId())
    glib = ctypes.CDLL('libglib-2.0-0.dll')
    Thread(target=_poll_thread, args=(glib, addr, this_tid)).start()
    _sock, _ = sock.accept()
    sock.close()

    glib.g_main_context_set_poll_func(None, _poll_func)

# Must be called after Gtk.main()
def clean_poll():
    global _sock, _running
    _running = False
    _sock.close()
    del _sock 
```

到目前为止，应用程序运行并正确响应点击和其他用户事件，但在窗口内没有绘制任何内容（我可以看到框架和粘贴到其中的背景缓冲区）。在线程和消息队列的处理中可能缺少一些重绘命令。我不知道如何解决它。有什么帮助吗？关于如何做到这一点有更好的主意吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T23:54:45.537

或者您可以创建一个单独的线程来处理 Gevent 主循环。你需要一种机制来安全地从一个线程切换到另一个线程。

1.  从 gui 线程安全地切换到 Gevent 线程（类似于 Stackless 已经提供的东西：[在 Stackless Python 中的 diff OS 线程之间切换](http://www.disinterest.org/resource/stackless/2.6-docs-html/library/stackless/threads.html#channels-are-thread-safe)）。切换安全的解决方案是使用[libev.ev_async](http://doc.dvgu.ru/devel/ev.html#ev_async__how_to_wake_up_another_event_loop)。

示例代码：

```
def in_gevent_thread(data_to_send):
  #now you are in gevent thread, so you can use safe greenlet + and network stuff
    ...

def on_button_click():
  #now you are in gui thread
  safe_switch = gevent.core.async(gevent_hub.loop)
  safe_switch.callback = functools.partial(in_gevent_thread, data_to_send)
  safe_switch.send() 
```

1.  从 gevent 线程切换回 gui 线程应该很容易。与 WinApi PostThreadMessage 类似的东西也应该在 gtk 中......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T10:00:21.623

如果你使用 glib`timeout_add`而不是`idle_add`对 CPU 成本的影响是最小的（我什至没有注意到任何）。这是 GTK2 + gevent 的完整示例：

```
import gtk
import gobject

import gevent
from gevent.server import StreamServer
from gevent.socket import create_connection

def handle_tcp(socket, address):
    print 'new tcp connection!'
    while True:
        socket.send('hello\n')
        gevent.sleep(1)

def client_connect(address):
    sockfile = create_connection(address).makefile()
    while True:
        line = sockfile.readline()  # returns None on EOF
        if line is not None:
            print "<<<", line,
        else:
            break

def _trigger_loop():
    gobject.timeout_add(10, gevent_loop, priority=gobject.PRIORITY_HIGH)

def gevent_loop():
    gevent.sleep(0.001)
    _trigger_loop()
    return False

tcp_server = StreamServer(('127.0.0.1', 1234), handle_tcp)
tcp_server.start()
gevent.spawn(client_connect, ('127.0.0.1', 1234))
gevent.spawn(client_connect, ('127.0.0.1', 1234))

_trigger_loop()
gtk.main() 
```

# objective-c - CDVViewController 在删除父级后仍在执行 JS

> ID：12414876
> 
> 赞同：1
> 
> 时间：2012-09-13T21:13:35.667
> 
> 标签：objective-c, ios, webview, automatic-ref-counting, cordova

我试图将 Cordova CleaverView (CDVViewController) 插入从情节提要实例化的 UIViewController(SenchaViewController) 中，以呈现基于 JavaScript Sencha 的视图。

```
- (void)viewWillAppear:(BOOL)animated 
```

{

```
[super viewWillAppear:animated];

if (![ self.slidingViewController.underLeftViewController isKindOfClass:[MenuViewController class]]) {
    self.slidingViewController.underLeftViewController  = [self.storyboard instantiateViewControllerWithIdentifier:@"Menu"];    
}   

self.view.layer.shadowOpacity = 0.75f;
self.view.layer.shadowRadius = 10.0f;
self.view.layer.shadowColor = [UIColor blackColor].CGColor;

CDVViewController *cdvc = [CDVViewController new];

cdvc.wwwFolderName = @"www";
cdvc.startPage = @"sencha.html";
cdvc.useSplashScreen = NO;

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
{
    cdvc.view.frame = CGRectMake(0, 0, 768, 1004);
} else {
    cdvc.view.frame = CGRectMake(0, 0, 320, 460);
} 

[self.view addSubview:cdvc.view];
[self.view  bringSubviewToFront:self.menuButton];
[self.view  bringSubviewToFront:self.favButton];
cdvc = nil;

NSString *jsSetIdString = [NSString stringWithFormat:@"fetchGuid = function(){return '%@';}", [player valueForKey:@"playerID"]]; 
[[cdvc webView] stringByEvaluatingJavaScriptFromString:jsSetIdString];

[self.view addGestureRecognizer:self.slidingViewController.panGesture]; 
```

}

我的问题是在我删除拥有 CDVViewController 的视图实例的父 ViewController(SenchaViewController) 之后，CDVViewController 没有被释放并且仍在后台运行，因为我仍然可以在控制台中看到 javascript 日志记录。我同时运行多个 CDVViewController 的原因。

这是应用程序添加父视图控制器的方式：

```
- (void)renderPlayer:(NSNotification*)notification {
SenchaViewController* newTopViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"SenchaView"];
NSDictionary *player = notification.object;

// Set active player
if( player != nil && [player valueForKey:@"playerID"] != @"" ){        
    // Attach Player Dictionary to Sencha View
    newTopViewController.player = player;

    // Send it to the top
    CGRect frame = self.slidingViewController.topViewController.view.frame;
    self.slidingViewController.topViewController = newTopViewController;
    self.slidingViewController.topViewController.view.frame = frame;
} 
```

这就是删除拥有 CDVController 的父视图控制器的方式

```
_topViewController.view removeFromSuperview];
[_topViewController willMoveToParentViewController:nil];
[_topViewController removeFromParentViewController]; 
```

我错过了什么吗？我假设ARC会为我解除分配

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T02:46:53.673

科尔多瓦有一些肮脏的方面，这就是其中之一。删除 CDVViewController 不足以将其释放。您还必须调用 [controller dispose] 方法。

# internet-explorer-9 - IE9不显示音频播放器

> ID：12414878
> 
> 赞同：0
> 
> 时间：2012-09-13T21:13:43.667
> 
> 标签：internet-explorer-9, html5-audio

在其他浏览器中，我看到了音频播放器，但在 IE9 中，我看到了：

![空白播放器](../Images/cb1c6472ebbfdd54655fca6c92e58f4a.png)

[http://adamkobrin.com/test1.php](http://adamkobrin.com/test1.php)

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>test1</title>
<style type="text/css">
audio {
    width: 300px;
    height: 40px;
}
</style>
</head>
<body>

<audio controls preload="auto">
    <source src="audio/crickets.mp3" />
    <source src="audio/crickets.ogg" />
Your browser does not support the audio tag.
</audio>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:43:47.597

我认为 Lews 的意思是他只看到播放/暂停按钮，而不是 IE9 的完整音频控件（即音量、静音、进度条等）。我也只看到播放/暂停按钮。

如果您看到原始帖子中显示的图像，您可能需要检查您的服务器是否具有用于 mp3 扩展的音频/mpeg 的 mime 映射。我曾经在我的一个程序中看到相同的图像，并覆盖 mp3 的 mime 映射解决了这个问题。然后我就可以看到完整的音频控件并正常播放音频。

# xml - 尝试通过 OLEDB 加载 XML 文件时出现 System.Data.OleDb.OleDbException

> ID：12414879
> 
> 赞同：0
> 
> 时间：2012-09-13T21:13:49.107
> 
> 标签：xml, oledb

**收到错误：**

*无法识别的数据库格式“C:\Documents and Settings\YepMyUserName\Local Settings\Temp\tmp1E1.tmp”。---> System.Data.OleDb.OleDbException: 无法识别的数据库格式 'C:\Documents and Settings\YepMyUserName\Local Settings\Temp\tmp1E1.tmp'..*

**代码：**

```
using (OleDbConnection connection = new OleDbConnection(string.Format("Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0}", filename)))
            {
                try
                {
                    connection.Open();
                    .... 
```

在 connection.Open 处引发异常。我只找到一篇关于如何以这种方式加载 XML 文件的帖子，显然它没有帮助。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T22:05:05.223

如果要将 XML 加载到 ADO.Net 数据集中，可以使用该`DataSet.ReadXxml()`方法，该方法将采用文件路径或流/读取器。您也可以为它提供 XML 模式等。[这里](http://msdn.microsoft.com/en-us/library/fx29c3yd%28v=vs.90%29.aspx)还有更多内容。

# parsing - 解析浮点数程序集

> ID：12414880
> 
> 赞同：1
> 
> 时间：2012-09-13T21:13:54.650
> 
> 标签：parsing, floating-point, mips, ieee-754

嗨，我试图在 MIPS 中创建一个自定义过程，以从 ieee-754 中的字符串解析浮点数（32 位）。我按照[维基百科](http://en.wikipedia.org/wiki/Single-precision_floating-point_format#Converting_from_decimal_representation_to_binary32_format)的步骤。问题是我无法处理整数部分可能大于 2^32 的事实，因为我在 mulou 指令中溢出：

```
int_part:
    lb $t1, 0($a0)
    add $a0, $a0, 1
    beq $t1, '.', fract_part
    mulou $s2, $s2, 10
    add $s2, $s2, $t1
    subi $s2, $s2, '0'
    j int_part 
```

在上面的代码中，id 喜欢将输入的整数部分存储在 $s2 中，因此我能够对其进行规范化，然后将其转换为二进制（如维基百科中所述）

# macos - NSToolbar 图标保持纯黑色，而不是接收漂亮的灰色系统效果

> ID：12414882
> 
> 赞同：3
> 
> 时间：2012-09-13T21:14:03.373
> 
> 标签：macos, cocoa, nstoolbar, nstoolbaritem

[OS X Human Interface Guidelines](https://developer.apple.com/library/mac/#documentation/userexperience/Conceptual/AppleHIGuidelines/Controls/Controls.html#//apple_ref/doc/uid/TP30000359-TP6)的*[Designing Toolbar Icons](https://developer.apple.com/library/mac/#documentation/userexperience/Conceptual/AppleHIGuidelines/Windows/Windows.html#//apple_ref/doc/uid/20000961-BABIFCFJ)*部分说，系统对工具栏中的图标应用效果来改变它们的外观。换句话说，我们必须像这样创建一个*纯黑色*图标：

 *![纯黑色图标](../Images/f386c99a69e4ce169d2bb55372f9fed9.png)

系统显示如下：

![系统处理图标](../Images/b27f8e1ffd15f2faa6ead505e5c02dca.png)

这很好，但它对我不起作用。

我正在使用界面生成器。我在 NSToolbarItem 中有一个圆形纹理按钮：

![界面构建器层次结构](../Images/aa0868830708155b685d7adf10c1fe94.png)

我为工具栏项分配了一个纯黑色图标：

![在此处输入图像描述](../Images/b38a28097abe8a5bd29c57c927ac1e4b.png)

但是，当我显示它时，它看起来像一个...纯黑色图标：

![在此处输入图像描述](../Images/8d5c38815c83f0670637270f9e2083a4.png)

我究竟做错了什么？这件事快把我逼疯了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T10:06:05.913

尝试将您的图标从 重命名`Test`为`TestTemplate`。[您可以在OS X 发行说明](https://developer.apple.com/library/mac/releasenotes/Cocoa/AppKitOlderNotes.html#TextAndImageEffects)中找到有关此技巧的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-09T16:01:12.210

如果您直接处理 NSImage 对象（不在 Interface Builder 中），您可以调用 [myImage setTemplate:YES] ，它将表现出特殊的绘图行为。*

# apache - 如何在 RewriteRule 中使用 RewriteCond HTTP_HOST 的匹配部分？

> ID：12414893
> 
> 赞同：0
> 
> 时间：2012-09-13T21:14:33.903
> 
> 标签：apache, mod-rewrite

我需要使用正则表达式匹配域名的一部分，并重定向到另一个域，匹配的部分是文件名的一部分。

例如，在 this-is.com 上的 htaccess 中：

```
this-is-a-test.com redirects to this-is.com/test.htm
this-is-a-fish.com redirects to this-is.com/fish.htm
this-is-a-duck.com redirect to this-is.com/duck.htm 
```

到目前为止，我已经尝试了以下方法：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^this-is-a-(.*).com$                                                                                                                                         
RewriteRule (.*) http://this-is.com/test.htm [L] 
```

但这不起作用，因为 RewriteRule 只处理查询字符串部分而不是主机部分。

如何在 RewriteRule 中使用 RewriteCond 的匹配部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:27:09.567

解决了！

为了将来参考，您应该对 RewriteCond 匹配使用百分号：

```
RewriteCond %{HTTP_HOST} ^this-is-a-(.*).com$
RewriteRule (.*) http://this-is.com/%1.htm [L] 
```

# wpf - （临时）在 WPF 中禁用验证

> ID：12414904
> 
> 赞同：6
> 
> 时间：2012-09-13T21:15:40.330
> 
> 标签：wpf, validation

当一个类实现 IDataErrorInfo 接口并且该类是与表单绑定的一部分时，有没有办法暂时禁用与绑定关联的验证？

例如，如果我不想在我的类的属性中允许空字符串，当表单打开时，绑定控件被标记为有错误（默认情况下带有红色边框）。我认为立即将输入标记为有错误（在用户甚至有机会输入内容之前）有点笨拙。有没有解决的办法？

我下午大部分时间都在搜索，但我似乎想出的是如何禁用*提交*按钮，直到所有输入都有效（这不是我真正想要的）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T21:34:03.230

在实现 IDataErrorInfo 的类中有一个标志，该标志控制何时完成验证，例如 DoValiation；

当标志为假时，您将使 IDataErrorInfo 报告没有错误（即返回 null 等）。

在视图初始化期间，您可以在模型中将 DoValidation 标志设置为 false，然后让视图对您的数据执行所有绑定。

视图“加载”后，您将 DoValidation 标志设置为 true....从那时起...如果值仍然无效，对数据的更改将导致错误指示符出现。

有关如何构建 IDataErrorInfo 代码的更多详细信息，请参阅其他帖子：

*   [WPF 更新源触发器](https://stackoverflow.com/questions/12287913/wpf-updatesourcetrigger)

# c# - C# 异步 TCP 套接字通信在 2.try over 单独的计算机在网络上崩溃

> ID：12414906
> 
> 赞同：0
> 
> 时间：2012-09-13T21:15:47.657
> 
> 标签：c#, .net, sockets, asynchronous, tcp

我正在尝试开发一个异步 TCP 服务器-客户端应用程序。在我的应用程序中，我使用[MSDN](http://msdn.microsoft.com/tr-tr/library/fx6588te.aspx)文章作为起点。我更改了用于传输序列化对象而不是传输字符串的代码块。我正在用几个包在这个对象中传输大数据。

在我的本地机器上一切都很好：在开始客户端连接时，服务器接受并且它们连接到我结束。当我触发并开始等待数据时，客户端发送请求，服务器接收到数据，服务器立即返回发送结果，客户端收到此结果，操作结束。虽然系统仍然连接，但我再次触发客户端并且事务正在重复。我触发了多少次一切正常。

但是在任何其他 Intranet 计算机上，客户端开始连接，服务器接受并且事务第一次正常工作。但在第二次尝试时，服务器回答结果，但客户端应用程序在 BeginReceive-EndReceive 周期暂停......

怎么了？asynch .net c# TCP 套接字基础设施是否有任何神经网络限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:28:08.443

没有代码很难说，但请检查您的 keepalive 设置（尝试将其关闭）。

# android - Android：与主机通信

> ID：12414912
> 
> 赞同：1
> 
> 时间：2012-09-13T21:16:04.273
> 
> 标签：android, ssh, serial-port, android-2.2-froyo, raspberry-pi

我正在寻找关于你们所有人如何解决这个问题的想法。我将使用 Android 平板电脑作为项目的触摸屏输入。我需要能够控制伺服系统和螺线管等，所以我将使用 Raspberry Pi 来执行此操作。我正在寻找有关如何让平板电脑和 Raspberry Pi 交谈的想法。以下是我迄今为止所拥有的一些。

1.  使用 Wifi（我真的不想这样做，以太网没问题）通过 ssh 进入 Raspberry Pi（带有外部库）并以这种方式从 Android 应用程序运行脚本。
2.  使用 Android 的 com 端口（如果有可用的硬件，可能是 Andropod？）并在 Raspberry Pi 上运行脚本。

这些可能是我现在能想到的两个“最好”的想法。

谁能想到任何其他“更好”的想法？

在此先感谢您的帮助，

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T14:52:26.373

我正在寻找人们已经使用 WiFi 将 Android 设备与 Raspberry Pi 链接的项目，我遇到了这篇文章。我可以想到两种“不太复杂”的交流方式。

一种是将 WiFi 加密狗插入 RPi 并启动热点（在 RPi 上）以从 Android 设备直接连接。另一种是使用蓝牙加密狗，使用蓝牙串口进行通信。我已经使用蓝牙方法在 Android 手机和使用 BlueSmIRf 的 Arduino 之间进行通信。（当您不需要电缆时，它非常方便监控移动设备上的串行输出）它会便宜得多，因为 USB 蓝牙加密狗非常便宜。

我还假设与 USB 电缆的直接连接可能有效。也许手机可能需要像使用 PDAnet 这样的网络共享应用程序时那样处于 USB 调试模式。事实上，也许使用 PDAnet 和 USB 电缆进行网络共享也可以完成这项工作。

就个人而言，我现在正在更新我的 RPi 映像，以便将 WiFi 支持添加到新的 Raspbian 发行版中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:36:39.647

我认为您将需要比您计划的更多，如果您触摸显示屏，在 ssh 或网络级别上不会发生任何事情，要执行您想做的事情，您必须编写一个应用程序作为您的输入和您的 pc 主机之间的桥梁将为您要检查的每种输入执行特定的操作。

还要记住，在实践中，在绝大多数情况下，您无法访问 Android 的重要部分，包括内核模块，因为它被编译为单片机，因此使用 USB 端口并不是那么容易和微不足道，在 Android 下USB 仅用于连接由 Android 本身管理的其他设备，而不是建立从 pc 到设备的 2 路通信，反之亦然。

有一个 adb 是一个 telnet 解决方案，但需要在您的设备上启用开发人员设置，也取决于您在设备上拥有的权限级别。

最现实的解决方案是：

*   您在 Android 设备上使用 SSH 服务器并使用它进行通信
*   如果这还不够，因为您需要监控输入和其他内容，您将编写自己的应用程序

其他解决方案是：

*   你root手机
*   您将内核重新编译为模块化
*   您编写自己的 USB 驱动程序并将其加载到新内核中
*   您仍然需要编写自己的应用程序来管理用户输入...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T11:56:07.587

在平板电脑中创建一个网络应用程序并使用[webiopi](https://code.google.com/p/webiopi/wiki/README)与 raspberry-pi 进行通信怎么样？但是，这可能不是一种安全的做事方式

# php - 将“数组”插入 mysql 表

> ID：12414914
> 
> 赞同：0
> 
> 时间：2012-09-13T21:16:23.023
> 
> 标签：php

我想在 mysql 表中插入一个数组。该数组是通过脚本扫描所有链接，转换为绝对链接，然后将它们显示在一个数组中生成的。我决定将 mysql_query 数组放入表中，但现在我被卡住了。它只发布“数组”，而不是将数组中的每一行发布到不同的行中。有任何想法吗？？！

```
 <?php
 require_once('simplehtmldom_1_5/simple_html_dom.php');
 require_once('url_to_absolute/url_to_absolute.php');
   $connect = mysql_connect("xxxx", "xxxx", "xxx") or die('Couldn\'t connect to MySQL Server: ' . mysql_error());
    mysql_select_db("xxxx", $connect ) or die('Couldn\'t Select the database: ' . mysql_error( $connect ));

  $links = Array();
  $URL = 'http://www.theqlick.com'; // change it for urls to grab  
  // grabs the urls from URL 
 $file  = file_get_html($URL);
 foreach ($file->find('a') as $theelement) {
  $links[] = url_to_absolute($URL, $theelement->href);
  } 
  print_r($links);
  mysql_query("INSERT INTO pages (url) VALUES ('$links[]')");
  mysql_close($connect); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:20:42.840

您可能希望[`implode()`](http://php.net/implode)使用未出现在数据中的分隔符（不可打印的字符通常是一个不错的选择，但有时各种符号都可以使用）。或者，您可以让 PHP[`serialize()`](http://php.net/serialize)为您服务，甚至将其保存为[`json_encode`](http://php.net/json-encode)d 格式。

如果您实际上尝试插入多行，`$links`每行一个条目，您应该这样做：

```
mysql_query("INSERT INTO pages (url) VALUES ('".implode("'),('",$links)."')"); 
```

只需确保首先正确清理所有链接！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T21:19:33.790

您可以以 JSON 格式表示数组并将其插入到您的数据库中。但实际上，一个好的数据库设计应该不需要插入数组。更好的是为数组中的每个键都有一个单独的列，并且只存储值而不是实际的数组结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T21:17:55.677

将数组转换为字符串？这是我认为最好的选择。。

```
$ids = join(',',$links);  
$sql = "INSERT INTO pages (url) VALUES ('$ids')"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T21:19:17.860

你应该看看[`serialize()`](http://php.net/manual/en/function.serialize.php)

```
$serialized = serialize( $yourArray );
// insert _$serialized_ into the DB
// and when retrieving it - unserialize()
$unserialized = unserialize( $retrievedValue ); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-13T21:20:52.087

如果你想在数据库中存储每行的链接，你应该把 mysql_query("INSERT INTO pages (url) VALUES ('$link')"); 在foreach循环内。

否则使用 implode 方法：

[http://it2.php.net/manual/en/function.implode.php](http://it2.php.net/manual/en/function.implode.php)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-13T21:35:07.773

如果您只想插入一列，请尝试此操作。这可以防止需要通过构建适当的`VALUES`字符串来循环。

```
$value_string = "'" . implode("','", $links) . "'"; // makes string like 'url1','url2','url3'
mysql_query("INSERT INTO pages (url) VALUES ($value_string)"); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-09-13T21:20:13.017

您需要遍历数组并依次对每个元素进行 INSERT 查询。

# sql - 计数的前 1 行

> ID：12414918
> 
> 赞同：1
> 
> 时间：2012-09-13T21:16:47.067
> 
> 标签：sql, tsql

我有一个带有以下输出的查询

```
SELECT  BIN_NAME,ROW_NUMBER() Over(Order by BIN_NAME) C
FROM USR_BINS_ITEMS I 
LEFT JOIN USR_BINS B ON I.BIN_COD=B.BIN_COD 
WHERE I.LOC_ID='6' 
And I.ITEM_NO = '364001' 
```

输出是....

```
Bin     c
--------------
E1-03   1    
E1-08   2    
E2-01   3 
```

* * *

但是我希望我的输出是

```
E1-03   ,  3 
```

这意味着，仅选择 FIRST Row Bin Value 但也显示总行数（或 C 列的最大值）。我正在使用 MS SQL Server 2008。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:45:26.243

你只是想要：

```
SELECT MIN(BIN_NAME) as BIN_NAME, COUNT(*) AS BIN_COUNT
FROM ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:20:19.457

试试这个：

```
SELECT TOP 1 BIN_NAME, X.TOTAL
FROM USR_BINS_ITEMS I

LEFT JOIN USR_BINS B
ON I.BIN_COD = B.BIN_COD

INNER JOIN (
    SELECT COUNT(*) AS TOTAL
    FROM USER_BINS_ITEMS I2
    WHERE I2.LOC_ID = '6' And I2.ITEM_NO = '364001'
) X ON TRUE

WHERE I.LOC_ID = '6' And I.ITEM_NO = '364001'; 
```

它要求执行两次搜索，但它应该比使用子查询`SELECT BIN_NAME, (SELECT COUNT(*) ...) AS TOTAL ...`（

无论哪种方式，此查询都应该执行得很好并满足您的要求。

请注意，如果没有`ORDER BY`子句，数据库引擎可以自由地将它希望从结果集中返回给您的任何行。`ORDER BY`如果要获取某些特定行，请添加子句。

# javascript - 如何防止回调多次触发？

> ID：12414921
> 
> 赞同：2
> 
> 时间：2012-09-13T21:16:54.740
> 
> 标签：javascript, jquery, callback, jquery-animate

我在这里看到了一些关于此的问题（包括使用 when/promise 解决方案），但它们似乎没有用。基本上我一次为多个元素设置动画，并在回调中调用一个函数，但该函数被多次调用 - 对于每个被动画的元素......这是我的代码：

```
OBJCollection.css({
    'width': '0em',
    'height': '0em'
}).animate({
    'width': Screens.ImageW / 16 + 'em',
    'height': Screens.ImageH / 16 + 'em'
}, {
    duration: Screens.currentImageParent.data('LightboxFadeSpeedIn'),
    queue: false,
    step: function (now, fx) {
        componentScaler();
    },
    complete: function () {
        $Content.show('fade', Screens.currentImageParent.data('ContentFadeSpeedIn'));
        //calling function here
    }
}); 
```

我尝试过：

```
if (!OBJCollection.is(':animated')) { ... call function } 
```

这没有用。我也尝试过使用 when 的解决方案，但这似乎会引发我的函数调用（它根据 OBJCollection 的最终动画大小定位其他元素）。我不确定（因为这是我第一次使用 when/promise），但它是否在第一个项目完成动画并忽略所有其他项目后触发回调一次？看起来这就是它正在做的事情，但我正在寻找一种解决方案，当所有项目都完成动画时触发回调......

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T21:23:39.827

使用一个承诺对象。

```
OBJCollection.css({
    'width': '0em',
    'height': '0em'
}).animate({
    'width': Screens.ImageW / 16 + 'em',
    'height': Screens.ImageH / 16 + 'em'
}, {
    duration: Screens.currentImageParent.data('LightboxFadeSpeedIn'),
    queue: false,
    step: function(now, fx) {
        componentScaler();
    }
}).promise().done(function() {
    $Content.show('fade', Screens.currentImageParent.data('ContentFadeSpeedIn'));
    //calling function here
});​ 
```

# java - @JoinColumns - 实体映射中的重复列

> ID：12414926
> 
> 赞同：3
> 
> 时间：2012-09-13T21:17:12.387
> 
> 标签：java, hibernate, jpa

我可能只是误解了@JoinColumns 的工作原理，但是当我重用 name 属性时出现错误。但是名称属性不是映射到数据库列吗？我不应该能够重复使用它吗？

我得到了错误：

```
Repeated column in mapping for entity: data.model.DP column: division 
```

编码：

```
@Column(name = "division", nullable = false)
private String division;

@ManyToOne(fetch = FetchType.LAZY, optional = false)
@JoinColumns({
    @JoinColumn(name = "division_labeldefintion", referencedColumnName = "labeldefinition"),
    @JoinColumn(name = "division", referencedColumnName = "abbr")
})
private LabelFile divisionLabel; 
```

我想要做的是从一个表（包含`division`列，并将其与`LabelFile`表连接起来）进行多列连接。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-14T01:32:59.303

如果您想重用映射中的一列，您应该将一列标记为`insertable=false updatable=false`，以便 Hibernate 知道哪个 Java 引用值是相关的。

[此问题](https://stackoverflow.com/questions/3805584/please-explain-about-insertable-false-updatable-false)中提供了有关何时使用这些属性的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:52:51.623

使用 JoinColumn 注释时，您必须注意，根据两个表/实体之间的关联类型，属性“name”和“referencedColumnName”正在改变它们引用的位置。检查 JPA API，或[在此处](http://www.objectdb.com/api/java/jpa/JoinColumn)查看更详细的描述。

在您的情况下，“divisonLabel”属性上的 JoinColumn 的“名称”属性引用源表/实体。并且“referencedColumnName”引用了 LabelFile 表/实体中的列。因此，您试图在源表/实体中有两个“除”列。

让映射工作切换“name”和“referencedColumnName”的值。

# c# - 向网络浏览器显示 html 字符串

> ID：12414930
> 
> 赞同：0
> 
> 时间：2012-09-13T21:17:24.967
> 
> 标签：c#, silverlight, windows-phone-7

我正在尝试将这个应用程序从服务器接收到的 html 字符串显示到 Web 浏览器中。出于某种原因，我失败得很惨。我能够将 html 字符串显示到消息框中，但无法将其显示到 Web 浏览器中。我对 c# 很陌生，所以我为不必要的代码或错误道歉。也提前感谢。

```
namespace Test2
{
public partial class MainPage : PhoneApplicationPage
{
    private static readonly Dispatcher Dispatcher;
    // Constructor
    public MainPage()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        // Create a new HttpWebRequest object.
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://127.0.0.1/examples/servlets/servlet/ReverseServlet");

        request.ContentType = "application/x-www-form-urlencoded";

        // Set the Method property to 'POST' to post data to the URI.
        request.Method = "POST";

        // start the asynchronous operation
        request.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallback), request);

    }

    private static void GetRequestStreamCallback(IAsyncResult asynchronousResult)
    {
        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;

        // End the operation
        Stream postStream = request.EndGetRequestStream(asynchronousResult);
        System.Diagnostics.Debug.WriteLine("Please enter the input data to be posted:");//Test code
        string postData = "string is this = Testing out this app for windows 7 phone";// Test string added

        // Convert the string into a byte array.
        byte[] byteArray = Encoding.UTF8.GetBytes(postData);

        // Write to the request stream.
        postStream.Write(byteArray, 0, postData.Length);
        postStream.Close();

        // Start the asynchronous operation to get the response
        request.BeginGetResponse(new AsyncCallback(GetResponseCallback), request);
    }

    private static void GetResponseCallback(IAsyncResult asynchronousResult)
    {
        Deployment.Current.Dispatcher.BeginInvoke(
        () =>
        {
            HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;

            // End the operation
            HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asynchronousResult);
            Stream streamResponse = response.GetResponseStream();
            StreamReader streamRead = new StreamReader(streamResponse);
            string responseString = streamRead.ReadToEnd();

            WebBrowser webBrowser1 = new WebBrowser();
            MessageBox.Show(responseString);//Message box displays html
            webBrowser1.Visibility = Visibility.Visible;
            webBrowser1.NavigateToString(responseString);//Does NOT display html string

            System.Diagnostics.Debug.WriteLine(responseString+" FIXED IT");

            // Close the stream object
            streamResponse.Close();
            streamRead.Close();

            // Release the HttpWebResponse
            response.Close();
            //allDone.Set();
        });
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T05:20:00.427

您需要将 webBrowser 添加到您的 UI。如果您的 UI 有一个名为 ContentPanel 的网格，`ContentPanel.Children.Add(webBrowser);`您是否也可以将 webBrowser 直接添加到通过代码创建它的 UI 中。要显示来自字符串的 HTML 内容，请使用`webBrowser.NAvigateToString(responseString);`

# c++ - C++ 多语言字符串输出

> ID：12414933
> 
> 赞同：0
> 
> 时间：2012-09-13T21:17:35.630
> 
> 标签：c++, windows, linux, unicode

我想做的只是输出一行文本：

```
 #include <iostream>
 #include <string>

 int main(void)
 {
   std::wstring    d=L"string_contains_many_languages_German_Mädchenß_Russian_этотязык_and_ブリザンメント";
   std::wcout<<d<<"\n";

   return 0;
 } 
```

我听说过语言环境。但是，如果我有一个多语言用户怎么办？所以，我不能只坚持一种语言环境。

它既不能在带有 g++ 编译器的 Linux/Ubuntu 中也不能在 Windows XP 中正常工作。

我怀疑它可能不仅取决于 C++，还取决于显示此信息的终端和环境。在 Linux 中，我可以使用命令 touch“ブリザаäЯ”（tilda 终端）创建一个名称为的文件。

我想知道是否至少可以使用 C++ 方法创建一个文件，该文件的名称与我在 d （在代码中）之类的字符串中的名称相同

**更正：**

我也想在 Windows 和 Linux 上做这些操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:33:32.670

作为一般规则 wchar_t 在非 Windows 平台上毫无意义。在 Linux 上，这可以正常工作：

```
#include <iostream>
#include <string>

int main(void)
{
  std::string d = "Mädchenß_этотязык_ブリザンメント";
  std::cout << d << "\n";  
} 
```

只要您不使用在某处使用 UTF-8 编码以外的东西的古老配置。

由于多种原因，Windows 上的事情变得更加困难，但这是一种方法：

```
#include <iostream>
#include <string>
#include <io.h>
#include <fcntl.h>

int main(void)
{
  _setmode(_fileno(stdout), _O_U16TEXT);
  std::wstring d = L"Mädchenß_этотязык_ブリザンメント";
  std::wcout << d << "\n";  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:28:19.740

在 Windows 上，您应该能够将其写为文字，以 UTF-8 保存文件（因为大多数源代码文件已经保存），然后在输出之前执行 nowide 的 widen(string)。它会起作用的。

您不想用 UTF-16 中的文字保存源代码。另一种方法不是将字符串存储在文字中，而是将字符串存储在具有明确定义的编码的单独位置，该编码不会随着单击 IDE 中的按钮而改变。

# ruby-on-rails - jQuery-ui 自动完成在本地工作，但不在生产环境中工作

> ID：12414937
> 
> 赞同：1
> 
> 时间：2012-09-13T21:17:54.007
> 
> 标签：ruby-on-rails, jquery-ui, heroku

我无法让我的 JQuery-ui 自动完成工作在生产（heroku、rails）上工作，但它在本地工作。

这是我的javascript（是的，我知道它很乱，这是我第一次使用jquery-ui）

```
<script>
$(function() {
var projects = '/courses.json'

$( "#search" ).autocomplete({
    minLength: 2,
    source: projects,
    focus: function( event, ui ) {
        $( "#search" ).val( ui.item.course.abbrev );
        return false;
    },
    select: function( event, ui ) {
      window.location.replace("/courses/"+ui.item.id);
        return false;
    }
})
.data( "autocomplete" )._renderItem = function( ul, item ) {
    return $( "<li></li>" )
        .data( "item.autocomplete", item )
        .append( "<a>" + item.abbrev + "</a>" )
        .appendTo( ul );
};
});
</script> 
```

我不确定，但这可能是问题所在：

“/课程.json”

工作正常并以 JSON 格式列出我的所有对象

然而，

"/courses.json?term=m"

在本地返回正确的对象数组，但远程只返回一个空数组

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T21:33:48.840

如果您正在查询远程服务器，请确保您在 jQuery AJAX 请求中使用 JSONP 而不是 JSON。

[http://en.wikipedia.org/wiki/JSONP](http://en.wikipedia.org/wiki/JSONP)和[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

# symfony - Composer - 下载没有 composer.json 的 git repos

> ID：12414940
> 
> 赞同：7
> 
> 时间：2012-09-13T21:18:00.027
> 
> 标签：symfony, symfony-2.1, composer-php

我正在尝试在 Symfony 2.1 中使用 composer 从不知道 composer 并且可能永远不会知道的 github 库中下拉供应商。

例如：旧的 Deps 文件：

```
[jQuery]
git=git://github.com/jquery/jquery.git
version=1.8.1

[Mocha]
git=https://github.com/visionmedia/mocha.git 
```

作曲家（不工作）

```
"repositories": [
    {
        "type": "package",
        "package": {
            "name": "jquery",
            "version": "1.8.1",
            "dist": {
                "url": "git://github.com/jquery/jquery.git",
                "type": "git"
            }
        }
    }
],
"require": {
    "jquery": "1.8.1"
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T06:21:25.303

如果你从 git 下载，你需要指定一个“源”包，而不是一个“dist”包。采用：

```
"repositories": [
    {
        "type": "package",
        "package": {
            "name": "jquery",
            "version": "1.8.1",
            "source": {
                "url": "git://github.com/jquery/jquery.git",
                "type": "git",
                "reference": "1.8.1"
            }
        }
    }
],
"require": {
    "jquery": "1.8.1"
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-06T18:35:04.263

另一种选择是`Bower`用于前端包管理，并且仅将 Composer 用于其设计用途。（PHP 包）。

[http://bower.io/](http://bower.io/)

# java - java接口上的克隆方法

> ID：12414952
> 
> 赞同：-1
> 
> 时间：2012-09-13T21:18:36.083
> 
> 标签：java, interface, clone

我有以下问题；

我有公共方法 clone() 的接口：

```
public interface Something {
    Something clone();
} 
```

并且

```
public class SomethingImpl implements Something {

        private Something some;

    public Something clone() {
        return some.clone();
    }
} 
```

当我从某处的代码运行时

```
...
Something i =  new SomethingImpl();
...
// do something on i
...
someMethod(i);
...

public void someMethod(Something some){
    Something some2 = some.clone(); 
  } 
```

我在 Someting some2 = some.clone;

我编写了很多业务逻辑，但直到现在我才遇到克隆的必要性，尤其是这种方式。

有人能指出我应该往哪个方向走吗？我试图阅读有关该主题的文章，但变得更加困惑。

提前致谢， 英里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:26:25.700

鉴于你的例子，唯一的方法

```
public void someMethod(Something some){
    Something some2 = some.clone(); 
} 
```

`NullPointerException`如果您将 null 传递给 ，则可以抛出is `someMethod(Something some)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:23:23.363

方法和字段是两个不同的东西。`clone`是一个未定义的字段，因此将不存在。`clone()`是一种方法。你的意思是`Someting some2 = some.clone()`？

**编辑**我刚刚看到你的实际错误（尽管我上面所说的仍然应该被注意！）。这意味着`some`必须`null`- 您是否可能在您省略的代码部分中更改其值？每当您收到`NullPointerException`.

# haskell - Haskell 程序是如何在内部编译和执行的？

> ID：12414959
> 
> 赞同：37
> 
> 时间：2012-09-13T21:19:02.010
> 
> 标签：haskell, compilation, runtime, ghc

我无法理解 Haskell (GHC) 如何编译程序，以及这些程序是如何运行的。

1.  GHC 是用 Haskell 编写的非平凡程序的典型示例。但是，GHC 的某些部分似乎不是用 Haskell 编写的，即运行时环境（C/C--）。这是为什么？性能原因？（我知道[这个网站](http://hackage.haskell.org/trac/ghc/wiki/Commentary/Rts)和它的朋友，但不能理解他们。）
2.  说到运行时环境：为什么*编译语言*需要一个？编译的程序不应该是机器代码而没有别的吗？据我了解，运行时环境有点类似于虚拟机或字节码解释器，它处理某种形式的元代码并在此基础上进行实际计算。那么：GHC 运行时到底做了什么，为什么它首先是必要的？
3.  关于 FFI：如何处理 C 调用？最初，我认为使用 FFI 会生成一个可执行文件，其中 Haskell 和 C 编译在一起。但是，我多次读到 GHC 程序会从程序中调用 C 函数。这对于理解 FFI 在并行编程方面的问题尤其重要。那么：FFI 函数与普通 Haskell 函数有何不同？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-14T12:00:02.113

要在库存硬件上编译和执行编程语言，您需要做很多事情：

*   一个编译器，将你的源语言翻译成本机主机可执行的汇编代码
*   原始语言服务的支持库（又名运行时），例如内存管理、IO 和线程管理。必须从较低级别的系统服务中利用的东西。

C、Java 和 GHC Haskell 是此类系统的示例。在 GHC 的情况下，[这里描述了整个架构](http://www.aosabook.org/en/ghc.html)。这些作品也被单独详细地描述。

*   编译器（用 Haskell 编写）将 Haskell 翻译成 C、汇编、LLVM 位码和其他格式。它使用的策略在这里描述得最好：[在股票硬件上实现惰性函数式语言：Spineless Tagless G-machine](http://research.microsoft.com/pubs/67083/spineless-tagless-gmachine.ps.gz)。
*   运行时服务（又名“GHC 运行时”）在几篇论文中进行了描述：

    1.  [具有线程局部堆的多核垃圾收集器](http://community.haskell.org/~simonmar/papers/local-gc.pdf)
    2.  [垃圾收集器服务如何工作](http://community.haskell.org/~simonmar/papers/parallel-gc.pdf)
    3.  [多线程在 GHC 中的工作原理](http://community.haskell.org/~simonmar/papers/multicore-ghc.pdf)
    4.  [惰性是如何实现的](http://community.haskell.org/~simonmar/papers/ptr-tagging.pdf)
    5.  [运行时如何调用外语代码](http://community.haskell.org/~simonmar/papers/conc-ffi.pdf)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-13T21:46:29.707

我可以提供一些关于什么是运行时的精确度。

虚拟机是“一种”运行时，但不是唯一的。运行时系统只是您的程序可以假设在执行期间存在的环境（和一组服务）。即使是像 C 和 C++ 这样的非常低级的语言也有运行时系统（想想 malloc ......某人/某事正在为您进行分配，甚至除以零检查）。

一般来说，高级语言具有更丰富的运行时（意味着运行时为执行程序提供更多服务）；这些范围从内存管理（例如垃圾收集）到反射/内省基础设施（想想 ruby​​ 等......）再到数组边界检查，但几乎所有语言都有某种运行时系统（如果只有操作系统）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-09-14T16:06:12.393

**1：为什么RTS不是用Haskell写的？**

因为它做了一些不能用 Haskell 表达的低级东西。就像 Linux 内核是一个运行 C 程序的系统一样，但 Linux 内核的某些部分是用汇编而不是 C 编写的。

**2：为什么编译好的程序需要运行环境？据我了解，这类似于 Java 字节码解释器。**

GHCi 使用的东西几乎与 Java 字节码解释器一模一样。*编译*的 GHC 程序不会；编译后的程序是原始机器代码。

相反，Haskell RTS 更像是一种迷你操作系统。它进行内存管理、线程调度、异常处理的某些方面以及事务处理。每个 Haskell 程序都在这个 mini-OS 下运行。

（这有点像即使*编译*了 C 程序，它是原始机器代码，但如果没有 Windows 或 Linux 之类的操作系统，您仍然无法*运行它。）*

例如，每次 Haskell 程序内存不足时，Haskell 程序就会停止运行，而垃圾收集器开始运行。垃圾收集器尝试释放一些内存，一旦释放，Haskell 程序就会再次开始运行。

每个编译的 Haskell 程序都有这个垃圾收集器程序的副本，它只是 Haskell RTS 的一部分。类似地，多个 Haskell 线程可以在一个 OS 线程中运行，因此 RTS 内部有一个线程调度程序。我可以继续...

**3：FFI如何处理？我以为这些东西都是一起编译的。**

它全部编译[或者*更*确切地说，链接]在一起。如果你编写一个 C 程序，一个 C 函数可以调用另一个 C 函数。当 Haskell 调用 C 函数时，它与调用该 C 函数的任何其他函数非常相似。根据函数调用的作用，Haskell 端会发生一些事情，这可能会增加一些开销。

# hibernate - struts2-fullhibernatecore-plugin-2.2.2-GA 不工作

> ID：12414968
> 
> 赞同：0
> 
> 时间：2012-09-13T21:19:39.483
> 
> 标签：hibernate, jakarta-ee, struts2, struts2-s2hibernate

我在带有 Hibernate 的演示 strut2 项目中使用 struts2-fullhibernatecore-plugin-2.2.2-GA。我尽力而为，但无法使其发挥作用。我正在使用所有最新的罐子。

***我错过了什么吗？***

请帮忙

**错误日志**

```
2012-09-14 02:06:50 - [  INFO - SessionTransactionInjectorInterceptor:41 ] --> Full Hibernate Plugin Validation could not detect Hibernate Validator 3.x
2012-09-14 02:06:50 - [  INFO - SessionTransactionInjectorInterceptor:46 ] --> Full Hibernate Plugin Validation using Hibernate Validator 4.x 
```

**我项目中的图书馆**

![在此处输入图像描述](../Images/59856a727be2e03d6987773f1c0d736e.png)

**当我访问页面时出现错误**

```
java.lang.NullPointerException

    com.myapp.dao.CustomerDAOImpl.listCustomer(CustomerDAOImpl.java:26)
    com.myapp.web.CustomerAction.listCustomer(CustomerAction.java:47)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    java.lang.reflect.Method.invoke(Method.java:597)
    com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:453)...... 
```

**我的客户DAOImpl.java**

```
package com.myapp.dao;

import com.googlecode.s2hibernate.struts2.plugin.annotations.SessionTarget;
import com.googlecode.s2hibernate.struts2.plugin.annotations.TransactionTarget;
import com.myapp.model.Customer;
import org.hibernate.Session;
import org.hibernate.Transaction;

import java.util.List;

public class CustomerDAOImpl implements CustomerDAO {

    @SessionTarget
    Session session;

    @TransactionTarget
    Transaction transaction;

    //add the customer
    public void addCustomer(Customer customer) {
        session.save(customer);
    }

    //return all the customers in list
    public List<Customer> listCustomer() {
        return session.createQuery("from Customer").list();
    }
} 
```

**已编辑 *********************

```
 @SessionTarget
        Session session;

        @TransactionTarget
        Transaction transaction; 
```

当注入 Session 和 Transaction 时，问题出在上面的代码中。我想知道这可能是 struts2-fullhibernatecore-plugin-2.2.2-GA 不支持的问题

```
hibernate-release-4.1.6.Final
hibernate-validator-4.3.0.Final 
```

因为插件网站[http://code.google.com/p/full-hibernate-plugin-for-struts2/](http://code.google.com/p/full-hibernate-plugin-for-struts2/)提到只有支持的版本是

*这个插件兼容 Hibernate Validator 3.1.0 和 4.0.2（从 2.2 版本开始）*。

**是不是这个问题。有没有人在上面提到的版本中使用过这个插件？**

**还有一个问题：我们可以在生产环境中使用这个插件吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T13:19:00.173

我认为你必须使用 Hibernate 3 作为插件。

因为在 Hibernate 4`DTDEntityResolver`类的包中改变了由插件使用。在 Hibernate 3 中，这个类在`org.hibernate.util`包中，而在 hibernate4 中，这个类在`org.hibernate.internal.xml.util`包中。

# asp.net-mvc - 如何使用 Installshield 安装/需要 MVC

> ID：12414972
> 
> 赞同：2
> 
> 时间：2012-09-13T21:19:48.807
> 
> 标签：asp.net-mvc, installshield

我希望能够在我的 InstallShield installScript MSI 项目中检查/安装 MVC。我确实看到了这个条目

[使用 InstallShield 2012 安装 ASP .Net MVC 应用程序](https://stackoverflow.com/questions/11768723/using-installshield-2012-to-install-asp-net-mvc-application)

但是MVC部分没有详细说明。我没有在可再发行列表中看到 MVC。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T03:16:51.623

你应该试试[bin 部署 mvc](http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx)

# java - java - 如何使用java从appengine数据存储中带来更新的对象集合？

> ID：12414975
> 
> 赞同：0
> 
> 时间：2012-09-13T21:20:07.593
> 
> 标签：java, google-app-engine, google-cloud-datastore

在我更新对象后，我正在尝试从我的 appengine Web 应用程序中获取更新后的对象列表。

如果我查看控制台，在更新操作之后，我看到实体具有新值，但是当我询问对象列表时，它带有旧值，因为更新从未发生

我的更新实现是

```
 public void update( final T entity ){
        entityManager.merge( entity );
        entityManager.flush();
     } 
```

我的检索列表实现是

```
@SuppressWarnings("unchecked")
     @Transactional(readOnly = true)
     public List< T > findAll(){
        entityManager.flush();
        return entityManager.createQuery("select f from " + clazz.getName() + " as f").getResultList();
     } 
```

更新、合并方法是否有问题，或者数据存储是否使用了任何在此操作后不会刷新的特殊缓存。请帮忙。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T07:30:37.403

正如@dragonx 在评论中指出的那样，这是由于[HRD 的最终一致性而](https://developers.google.com/appengine/docs/java/datastore/structuring_for_strong_consistency)发生的。

`put(..)`当一个实体被更新时，当实体数据被持久化，但在所有关联的索引被建立之前，调用将立即返回。

所以，如果你`put()`再马上`get()`，你会得到一致的数据，因为`get()`不依赖索引来检索实体。

但是，如果您`put()`然后立即`query()`，您可能无法获得更新的数据，因为查询依赖于索引，并且插入/更新实体的索引条目仍在构建中。

# java - Java和MySQL中布尔变量的位标志

> ID：12414981
> 
> 赞同：0
> 
> 时间：2012-09-13T21:20:27.093
> 
> 标签：java, mysql, bitflags

我只想从一系列布尔变量中创建一个位标志，这样我就可以将一个变量存储在 MySQL 数据库中，而不是几个布尔值。例如，我有三个布尔标志（A、B、C）并希望根据布尔标志的值创建一个位标志。我认为这会起作用，但我猜有更好（或更清晰）的方法来做到这一点：

```
int myBitFlag = A ? 1:0;
myBitFlag += B ? 2:0;
myBitFlag += C ? 4:0; 
```

我不知道为什么我找不到任何关于这个的东西，也许是因为我做错了或者没有使用正确的术语..

并且要选择 B=true 的所有条目，我会使用它吗？

```
SELECT * FROM table WHERE myBitFlag & 2 = 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:51:48.477

我认为将位打包到 int 中的一般方法是将值向左移动一定数量的位。例如，如果您希望 A 在位 0，B 在位 1 和 C 在位 2，您可以执行以下操作：

```
 public static void main(String[] args)
  {
    boolean a = true;
    boolean b = false;
    boolean c = true;

    int flag = 0; 
    flag |= biteIt(a,0);
    flag |= biteIt(b,1);
    flag |= biteIt(c,2);
    System.out.println(flag);
  }

  private static int biteIt(boolean b, int place) {
    return b ? 1 << place : 0;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:46:11.363

不使用正确的“BIT NOT NULL”SQL 类型来允许数据库优化存储并在独立列上执行 WHERE 子句表达式。这就是使用 SQL 来充分描述您的数据以优化搜索的目的。

如果你真的需要位掩码值，你总是可以在 SELECT 输出部分使用表达式：

```
IF(bitColumnC, 4, 0) 
```

如果您的应用程序需要它用于 SELECT 输出，则获取整数值 4。还：

```
IF(bitColumnA, 1, 0) + IF(bitColumnB, 2, 0) 
```

如果你真的必须把它作为一个整数。

否则为什么将它们保留为 SQL 中的位字段，只需在 SQL 中使用 INT 类型并在客户端软件中进行屏蔽。INT(1) 的使用与 BIT 相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:38:11.333

将它们分别存储`INT(1)`在 SQL 中，让数据库为您优化存储。通过这种方式，您可以在标志上创建索引，这对于快速选择至关重要。

# javascript - IE9 AJAX 错误：“由于错误 c00c023f 无法完成操作”

> ID：12414982
> 
> 赞同：0
> 
> 时间：2012-09-13T21:20:31.060
> 
> 标签：javascript, ajax, internet-explorer, xmlhttprequest

我有一个运行 PHP 脚本的 AJAX 请求，我想处理请求返回状态 500 的情况。

我的代码在 Chrome 和 Firfox 上运行，但在 IE9 上，如果我添加一个条件，`if(httpRequest.status==500)`我会收到以下 JavaScript 错误：

`Could not complete the operation due to error c00c023f`.

我在页面上有一个加载图像，由于这个错误，我无法替换图像，并且页面似乎继续加载。就像这里引用的那样：

> 特别是如果您在执行请求时显示“加载动画”或类似内容。在我的情况下，结果似乎页面从未停止加载

首先，这是我的 AJAX 调用代码：

```
function sendRequest(url, params, divToChange)
{

  // code for IE7+, Firefox, Chrome, Opera, Safari
  if (window.XMLHttpRequest)
  {
      var httpRequest = new XMLHttpRequest();
  }   
  else // code for IE6, IE5
  {
      var httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
  }

  //open the request and prepare variables for the PHP method being activated on server side//
  httpRequest.open("POST", url, true); 

  //Set request headers for POST command//
  httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

  if(divToChange != "false")
  {
      httpRequest.onreadystatechange=function()
      {
          if(httpRequest.readyState==4 && httpRequest.status==200)
          {
              document.getElementById(divToChange).innerHTML=httpRequest.responseText;
              eval(document.getElementById("runscript").innerHTML);
          }
          else if (httpRequest.status==500)
          {
              document.getElementById(divToChange).innerHTML=httpRequest.responseText;

              //eval the lang variable from the php script.
              eval(document.getElementById("runscript").innerHTML); 

              if(lang == "en")
              {
                  document.getElementById(divToChange).innerHTML='<b> An error accured, please try again later</b>';
              }
              else
              {
                  document.getElementById(divToChange).innerHTML='<b> שגיאה התרחשה, בבקשה נסה שנית מאוחר יותר</b>';
              }     
          } 
      }  
  }

  httpRequest.send(params); //sending the request to the server//
} 
```

我已经搜索过它并[在 stack 上找到了这篇文章](https://stackoverflow.com/questions/7287706/ie-9-javascript-error-c00c023f)。从那里，我找到[了这句话](http://www.enkeladress.com/article.php/internetexplorer9jscripterror)：

> 就在您调用 XmlHttpRequest.abort() 方法之前，在其上设置一个标志，我是这样做的：

```
XmlHttpRequest.aborted = true;
XmlHttpRequest.abort();
In the onreadystatechanged handler, the first lines of code in my case is:
if (xmlHttpRequest.aborted==true) { 
  stopLoadAnimation();
  return;
} 
```

但就我而言，我什至不打电话`XmlHttpRequest.abort()`，那为什么我会首先收到错误消息？

顺便说一句，如果我删除所有条件`else if (httpRequest.status==500)`和其中的所有代码，我不会收到错误消息，但话又说回来，我将无法在 500 错误上显示消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:07:42.653

我猜，但我认为缺少 readyState 检查可能会给您带来一些问题。请记住，您不只是在调用完成时调用 onReadyStateChange 处理程序 - 它会在每次状态更改时调用。因此，对于前两个（Unitialized 和 Loadinf），我不相信“状态”属性可用 - 由于 ActiveX 和 JavaScript 之间的交互，IE 可能会抛出一个奇怪的错误。

我会为您的错误状态建议这样的事情（请注意，除了 500 之外，您可能还想捕获许多错误）：

(httpRequest.readyState > 1 && httpRequest.status != 200)

我只能猜测其他浏览器一开始就创建了 status 属性（如果这确实是问题）。

顺便说一句，我还可以（谦虚地）建议您尝试一下我的 AJAX 抽象库。它会自动处理几乎所有这些。成功和错误处理程序都可以设置，不用担心跨浏览器的东西，这一切都非常适合您现有的代码库。

组件在这里：

[http://depressedpress.com/javascript-extensions/dp_ajax/](http://depressedpress.com/javascript-extensions/dp_ajax/)

我发现它非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:13:36.657

当您对innerHTML 使用过多并创建它无法理解的无效标记时，IE 会做一些非常奇怪的事情。（例如，我遇到了一个非常相似的问题，有人试图在表单中嵌入表单。）

我敢打赌，`divToChange`它没有引用有效的 HTML`div`元素，并且您的错误来自尝试更改 div 本身。

在您的调试代码中，添加`console.log(divToChange)`（或者您可以使用`alert(divToChange)`. 它应该说类似`"[object HTMLDivElement]`或类似的内容。

在您的测试中，如果您想确保它`divToChange`不是*错误的*[1]，只需执行

```
 if (divToChange) 
```

[1]如果您来自强类型环境，Javascript 对`falsey`and的定义可能需要一些时间才能使用。`truthy`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-12T04:21:23.450

我已经尝试过了，它对我有用。希望这可以帮助：

```
if (xmlhttp.readyState==1 ) { return }     // added this to fix error c00c023f in IE9
                else if (xmlhttp.readyState==4 )
                    {
                        if(xmlhttp.status==200) { func(xmlhttp.responseText) }
                    } 
```

# php - 解析模拟值表

> ID：12414990
> 
> 赞同：0
> 
> 时间：2012-09-13T21:21:20.247
> 
> 标签：php, mysql, performance, parsing, mysqli

我将一些模拟寄存器（0和1）中的值存储到数据库中，我想做以下事情：

我在数据库中有下表用于存储传感器值：

```
ID   |          TIMESTAMP     |  ALIAS  |  STATUS
 1   |    2012-09-12 12:31:01 |   AR1   |     0
 2   |    2012-09-12 12:31:02 |   AR1   |     0
 3   |    2012-09-12 12:31:03 |   AR1   |     0
 4   |    2012-09-12 12:31:04 |   AR1   |     0
 5   |    2012-09-12 12:31:05 |   AR1   |     0
 6   |    2012-09-12 12:31:06 |   AR1   |     0
 7   |    2012-09-12 12:31:07 |   AR1   |     1
 8   |    2012-09-12 12:31:08 |   AR1   |     1
 9   |    2012-09-12 12:31:09 |   AR1   |     1
10   |    2012-09-12 12:31:10 |   AR1   |     0
11   |    2012-09-12 12:31:11 |   AR1   |     0
12   |    2012-09-12 12:31:12 |   AR1   |     0
13   |    2012-09-12 12:31:13 |   AR1   |     0
14   |    2012-09-12 12:31:14 |   AR1   |     0
15   |    2012-09-12 12:31:15 |   AR1   |     1
16   |    2012-09-12 12:31:16 |   AR1   |     0
17   |    2012-09-12 12:31:17 |   AR1   |     0
18   |    2012-09-12 12:31:01 |   AR1   |     0
 ... 
```

使用 SQL 查询，我希望能够在寄存器更改状态时返回，以便在不使用不必要点的情况下创建图表。请记住，该表包含 100 万个或更多值，通过这样做，我将减少返回数据的大小，并且图表会更快。

我不确定 MySQL 是否提供了所描述的功能，但起初我认为这`GROUP BY`可能是一个很好的解决方案，但不幸的是它不是。

有什么建议么？

期望的输出：

```
ID   |          TIMESTAMP     |  ALIAS  |  STATUS
 1   |    2012-09-12 12:31:01 |   AR1   |     0
 6   |    2012-09-12 12:31:06 |   AR1   |     0
 7   |    2012-09-12 12:31:07 |   AR1   |     1
 9   |    2012-09-12 12:31:09 |   AR1   |     1
10   |    2012-09-12 12:31:10 |   AR1   |     0
14   |    2012-09-12 12:31:14 |   AR1   |     0
15   |    2012-09-12 12:31:15 |   AR1   |     1
16   |    2012-09-12 12:31:16 |   AR1   |     0
 ... 
```

您可以观察到我正在删除连续值之间的中间线，因为我只需要第一次和最后一次出现的值以及新值。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:31:04.983

我会用变量来做。不幸的是，我不能把它写出来让你知道，但请在此处查看我的类似回复：

[获取mysql中的连续记录](https://stackoverflow.com/questions/12396200/get-consecutive-records-in-mysql/12396429#12396429)

我明天再试试看。

今天的答案：

您可以只使用状态更改的行（而不是包括之前的行）吗？假设记录了所有数据样本，这将为您提供持续时间...

如果是这样，这有效：

```
set @last_status = null;
select  id, timestamp, alias, status,
  case when @last_status is null or status != @last_status then 1 else  0 end as changed, 
@last_status := status
from sensor_values
having changed = 1; 
```

如果没有，我会在早上的采访之后再做一些修改:)

# c - 强制opengl 3.x的软件实现

> ID：12414991
> 
> 赞同：1
> 
> 时间：2012-09-13T21:21:28.620
> 
> 标签：c, opengl, glfw, mesa

首先我想说我试过`LIBGL_ALWAYS_SOFTWARE=1 ./myapp`但没有帮助

我安装了 gentoo、mesa 9.0、ATI X800 (R420)（仅支持 OpenGL 2.0）

我想强制软件实现。OpenGL 3.x 和相应的 GLSL，是否可以这样做？

我使用 glfw 和 glew。

```
glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 0);
glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE); 
```

这导致我无法`glfwOpenWindow`获得 OpenGL 2.x 并且没有提示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T18:41:20.713

MESA 如何拥有用于软件渲染的单独驱动程序：

```
llvmpipe 
```

但它仍然在 OpenGL 2.1 + 扩展上

# c - 自定义压缩算法

> ID：12414992
> 
> 赞同：1
> 
> 时间：2012-09-13T21:21:31.273
> 
> 标签：c, compression

我正在用 C 编写一个自定义压缩算法，它读取 ascii 字符，从每个字符中删除第一个位（因为它始终为 0），然后将其粘贴到一个新文件中。它使输入成为原始大小的 7/8。这是压缩：

```
#include <stdio.h>

int main()
{
  int i = 1;
  int c;
  unsigned short value = 0;

  while((c = getchar()) != EOF)
  {
    value = (c << i) | value;
    if(i != 1) putchar(value >> 8);
    value = value << 8;
    i++;
    if(i == 9) i = 1;
  }
  if(i != 1) putchar(value >> 8);
} 
```

这是解压：

```
#include <stdio.h>

int main() {

  int i = 1;
  int c;
  unsigned char value = 0;

  while((c = getchar()) != EOF) {
    value = (c >> i) | value;
    putchar(value);

    value = (c << (8-i)) | 0;
    value = value >> 1;

    if(++i == 8) {
      putchar(value);
      i = 1;
    }
  }
} 
```

如果我压缩“ororororor”（不带引号）之类的内容，然后解压缩，则输出为“orororor.r”，其中“。” 十六进制为 7F。但是，如果我给它“ororororrr”，那么它会输出正确的“ororororrr”。它只会在某些输入时失败，但我找不到当它搞砸时的模式。

抱歉，这不在函数中。我一直在使用它的方式是在 UNIX 中使用以下命令：

```
echo -n your input here > data
gcc compress.c
./a.out < data > inp
gcc decompress.c
./a.out < inp > out
hexdump -C out 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:40:23.687

您是否考虑了输入甚至不会落在 8 位边界上的情况？有点像base 64编码在做同样的事情时遇到的问题......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:46:00.830

`value`一个问题肯定是你在解压时没有归零。

在您到达文件末尾之前，这没有效果（多余的位被轮换）。

尝试：

```
 if(++i == 8) {
     putchar(value);
     i = 1;
     value = 0; // Clean up
 } 
```

测试用例（`value`如果有命令行参数，则将上述程序修改为零）：

```
 echo "xxxxxxxRxx" | ./comp | ./decomp OK
  xxxxxxxRxx
  echo "xxxxxxxRxx" | ./comp | ./decomp
  xxxxxxxRzx 
```

# php - $_POST 是 PHP 中的空数据

> ID：12414994
> 
> 赞同：17
> 
> 时间：2012-09-13T21:21:43.603
> 
> 标签：php, forms, codeigniter, post

我的 $_POST 数据没有通过有一个奇怪的问题。首先，这在我的本地主机上运行良好，但不适用于我在网络上的共享主机。这是表格：

```
<form action="/add" method="POST" enctype="multipart/form-data">

<div>
    Name : <input type='text' name='form[name]' class='form-text ' value="" style='width: 350px' placeholder="I.E. Boulder Vote Bus" maxlength="30"/>
</div>
<div>
    Description : <textarea name='form[description]' class='form-bigbox '/></textarea>
</div>
<div class='clearfix pull-left'>
    Logo: <input type="file" name='form[image_name]' class='' value="" accept="image/jpeg, image/jpg, image/png"/>
</div>
<div class='clearfix'></div>
<div>
    <span id='date' class='change'>
        Date : <input type='text' name='form[date]' id='datepicker' class='form-text ' placeholder="mm/dd/yyyy" value="" style='width: 160px;'/> 
    </span>
    Time : <input type='text' name='form[hr]' class='form-text ' style='width: 40px;' placeholder="01" value=""/> : <input type='text' style='width: 40px;' name='form[min]' class='form-text ' placeholder="00" value=""/> <select name='form[ampm]' class='form-text form-select' style='width: 60px;'><option value='am' >AM</option><option value='pm' >PM</option></select>
</div>
<div>
    Your Email : <input type='text' name='form[email]' class='form-text '  value="" style='width: 350px' placeholder="hero@voterides.com"/>
</div>
<div>
    Zip code : <input type='text' name='form[zipcode]' class='form-text '  value="" placeholder="80304"/> Radius : <input type='text' name='form[radius]' class='form-text '  value="" placeholder="25" style='width:50px;'/> mi
</div>
                    <div>
                            <input type='submit' class='form-submit btn-warning' value='Create a Ride' />
</div>
</form> 
```

问题是，在我提交表单后，我没有 $_POST 数据。如果我这样做，`echo serialize($_POST);`我会得到`a:0:{}`. 但是，如果我这样做，`echo file_get_contents('php://input');`我会得到以下信息：

```
------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[name]"

Some Name

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[description]"

Some Description

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[image_name]"; filename=""

Content-Type: application/octet-stream

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[date]"

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[hr]"

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[min]"

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[ampm]"

am

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[email]"

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[zipcode]"

------WebKitFormBoundaryLCabCxfMMHCvWsAO

Content-Disposition: form-data; name="form[radius]"

------WebKitFormBoundaryLCabCxfMMHCvWsAO-- 
```

此外，更奇怪的是，如果我将表单缩减为 3 个元素，它就可以工作。任何 3 个元素都可以，但 4 个则不起作用。此外，网站上的其他表单（超过 3 个元素）也可以正常工作。就这一个。

以下是我的共享主机中的一些相关 PHP 设置：

```
PHP Version 5.3.16
max_execution_time  300 
max_file_uploads    20  
max_input_time  -1  -1
max_input_vars  1000    1000
memory_limit    128M    128M
post_max_size   500M    500M 
```

如果它是服务器设置，知道它可能是什么吗？似乎是一个大小问题，但传递的数据并不多（所有这些都是小值）。

我有一个 htaccess，但我认为它不相关（我使用的是 codeigniter，它是标准的 CI htaccess，我的其他表单提交 a-ok）：

```
AddDefaultCharset UTF-8
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    #Removes access to the system folder by users.
    #Additionally this will allow you to create a System.php controller,
    #previously this would not have been possible.
    #'system' can be replaced if you have renamed your system folder.
    RewriteCond %{REQUEST_URI} ^system.*
    RewriteRule ^(.*)$ /index.php?/$1 [L]

    #When your application folder isn't in the system folder
    #This snippet prevents user access to the application folder
    #Submitted by: Fabdrol
    #Rename 'application' to your applications folder name.
    RewriteCond %{REQUEST_URI} ^application.*
    RewriteRule ^(.*)$ /index.php?/$1 [L]

    #Checks to see if the user is attempting to access a valid file,
    #such as an image or css document, if this isn't true it sends the
    #request to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?/$1 [L]
</IfModule> 
```

以下是 print_r($_SERVER) 产生的内容（为了安全起见，略作编辑）：

```
Array
(
    [CONTENT_LENGTH] => 1077
    [CONTENT_TYPE] => multipart/form-data; boundary=----WebKitFormBoundarydBnbAkAUNJntI6dz
    [DOCUMENT_ROOT] => [redaced]
    [GATEWAY_INTERFACE] => CGI/1.1
    [HTTP_ACCEPT] => text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    [HTTP_ACCEPT_CHARSET] => ISO-8859-1,utf-8;q=0.7,*;q=0.3
    [HTTP_ACCEPT_ENCODING] => gzip,deflate,sdch
    [HTTP_ACCEPT_LANGUAGE] => en-US,en;q=0.8
    [HTTP_CACHE_CONTROL] => max-age=0
    [HTTP_CONNECTION] => keep-alive
    [HTTP_COOKIE] => vrsession=8pO1KwOg4OPzCYqsJHX0Qr6FPfLteTimRjIKQPRC%2F83GlFRTepX%2FnrfE1yDxYxDXiPa2JcX4kQviV6lezxrXmJHjqVbWMe%2FgRne%2Bp9P4%2FfxlZrxta2Zl4DACs2C2nsp1SkqYj6k6xhP6Wc9Zlpxgsma752%2BGxHkvwnT6%2F%2FTey699wnV5je99kZe%2FIhSa04DZvoGXoFc6bx1%2B%2FZRtSvojD86ktpWK91AUFUvltcoj8%2F31jeX0h%2BR7VEOPMZLBeqJrcn7qZGeQ6N2XvCIsh6gqTRZIPdsvyAIW%2FTTibBiY0qUvh50yE5MH060D8utqsiv4S54UrXypBsCP3H2w66pLXHTQKKrK%2FAsn1SEWb2pew%2BEOE4prm%2BJKGxcAq0efCGhkpsHZoP9ZDKDekMzaJTIxUin99RUeXVZTF0yqsMD5A%2FFF0AdZuz343VWsJcV9zru4hPHaAky5NMoZa6R1be9PwA%3D%3D; __utma=74945813.1164249566.1347560100.1347560100.1347560100.1; __utmb=74945813.176.10.1347560100; __utmc=74945813; __utmz=74945813.1347560100.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
    [HTTP_HOST] => [redacted]
    [HTTP_ORIGIN] => [redacted]
    [HTTP_REFERER] => [redacted]/add
    [HTTP_USER_AGENT] => Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1
    [PATH] => /bin:/usr/bin
    [PHPRC] => [redacted]
    [QUERY_STRING] => 
    [REDIRECT_QUERY_STRING] => /add
    [REDIRECT_STATUS] => 200
    [REDIRECT_UNIQUE_ID] => UFJZCUoyAC0AAE5v7ps
    [REDIRECT_URL] => /add
    [REMOTE_ADDR] => [redacted]
    [REMOTE_PORT] => 48098
    [REQUEST_METHOD] => POST
    [REQUEST_URI] => /add
    [SCRIPT_FILENAME] => [redacted]/index.php
    [SCRIPT_NAME] => /index.php
    [SERVER_ADDR] => [redacted]
    [SERVER_ADMIN] => [redacted]
    [SERVER_NAME] => [redacted]
    [SERVER_PORT] => 80
    [SERVER_PROTOCOL] => HTTP/1.1
    [SERVER_SIGNATURE] => <ADDRESS>Apache/1.3.42 Server at [redacted] Port 80</ADDRESS>

    [SERVER_SOFTWARE] => Apache/1.3.42 (Unix) Sun-ONE-ASP/4.0.2 Resin/2.1.13 mod_fastcgi/2.4.6 mod_log_bytes/1.2 mod_bwlimited/1.4 mod_auth_passthrough/1.8 FrontPage/5.0.2.2635 mod_ssl/2.8.31 OpenSSL/0.9.7a
    [UNIQUE_ID] => UFJZCUoyAC0AAE5v7ps
    [PHP_SELF] => /index.php
    [REQUEST_TIME] => 1347574025
    [argv] => Array
        (
            [0] => /add
        )

    [argc] => 1
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-27T21:23:18.867

我读到你评论说：“没有变化。我正在使用 codeigniter，所以我在 htaccess 中有标准的 301。” 某处。如果您使用 301，您将被永久重定向（有时是“永远”）。检查来自服务器的浏览器响应（尝试保存日志）并查看您的帖子是否被重定向。如果是这样，您的 POST 数据将丢失。

[.htaccess 重定向后如何通过 ajax 请求保留 POST 数据？](https://stackoverflow.com/questions/13886631/how-to-preserve-post-data-via-ajax-request-after-a-htaccess-redirect)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T16:16:12.183

```
<form action="/add" 
```

使用目标页面名称更改“/添加”部分：example.php

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-27T04:43:30.733

1.  我在我的服务器上运行了这个表格，它没有问题。
2.  我把表格复制到`test.php`
3.  发送表单数据到`test2.php`
4.  显示输出`var_dump($_POST)`
5.  更改：（`action="/add"` *顺便说一下，这对我来说就像一个目录）*

    至：`action="test2.php"`

6.  产生以下输出：

    `array(1) { ["form"]=> array(9) { ["name"]=> string(0) "" ["description"]=> string(0) "" ["date"]=> string(0) "" ["hr"]=> string(0) "" ["min"]=> string(0) "" ["ampm"]=> string(2) "am" ["email"]=> string(0) "" ["zipcode"]=> string(0) "" ["radius"]=> string(0) "" } }`

尝试将输出发送到不同的脚本，即`"test2.php"`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-01-23T20:00:14.027

请记住：当您从表单中读取输入的名称时，区分大小写！例子：

```
<form>
  <input name="hello" />
</form> 
```

假设它包含值*bob*。在我写的php文件中：

```
<?
   $var = $_POST['Hello'];
?> 
```

它什么也不会读，因为对于 php 解释器来说，*hello*不是*Hello* - 它们是两个不同的值/字段名称。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-13T21:39:32.297

我认为 PHP 可能在使用相同 POST 子数组的文件输入和非文件输入方面存在问题。即，上传名为“form[image_name]”的文件和名为“form[something_else]”的其他字段不起作用。尝试为文件上传字段使用不同的名称，看看它是否有效。

[PHP：常见陷阱 - 文件上传](http://www.php.net/manual/en/features.file-upload.common-pitfalls.php)