# StackOverflow 问答 000522000-000522999

# c - 如何构建具有最少赋值运算符的 OneTwoThree 链表？

> ID：522010
> 
> 赞同：4
> 
> 时间：2009-02-06T20:18:17.903
> 
> 标签：c, initialization

我在准备面试时遇到了这个问题，很想知道它的不同写作方式。我在[http://cslibrary.stanford.edu/103/](http://cslibrary.stanford.edu/103/)找到了这个并给出了问题所在。

这是构建列表 {1,2,3} 的代码

```
struct node* BuildOneTwoThree() {
    struct node* head = NULL;
    struct node* second = NULL;
    struct node* third = NULL;
    head = malloc(sizeof(struct node)); // allocate 3 nodes in the heap
    second = malloc(sizeof(struct node));
    third = malloc(sizeof(struct node));
    head->data = 1; // setup first node
    head->next = second; // note: pointer assignment rule
    second->data = 2; // setup second node
    second->next = third;
    third->data = 3; // setup third link
    third->next = NULL;
    // At this point, the linked list referenced by "head"
    // matches the list in the drawing.
    return head;
} 
```

问：用最少的赋值（=）编写代码，这将构建上述内存结构。答：它需要 3 次调用 malloc()。3 个 int 分配 (=) 来设置 int。4 个指针分配给设置头和 3 个下一个字段。稍加一点C语言的聪明和知识，这一切都可以用7个赋值操作（=）来完成。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T20:37:27.880

我做了六个作业。我能得到什么？

```
struct node
{
    int data;
    struct node * next;
};

struct node * build_123()
{
    struct node * first = malloc(sizeof(*first));
    struct node * second = malloc(sizeof(*second));
    struct node * third = malloc(sizeof(*third));

    assert(first && second && third);

    *first = (struct node){ 1, second };
    *second = (struct node){ 2, third };
    *third = (struct node){ 3, NULL };

    return first;
} 
```

* * *

此外，练习不是很有用。如果我想从一组已知整数构建一个链表，我会这样做：

```
struct node
{
    int data;
    struct node * next;
};

#define build_list(...) \
    _build_list((sizeof((int []){ __VA_ARGS__ }))/(sizeof(int)), \
    (int []){ __VA_ARGS__ })

struct node * _build_list(size_t count, int values[count])
{
    struct node * next = NULL;

    for(size_t i = count; i--; )
    {
        struct node * current = malloc(sizeof *current);
        assert(current);
        *current = (struct node){ values[i], next };
        next = current;
    }

    return next;
} 
```

然后，您可以构建一个任意列表

```
struct node * list = build_list(1, 2, 3); 
```

* * *

这是另一个使用单个作业的版本，灵感来自[codelogic 的答案](https://stackoverflow.com/questions/522010/build-onetwothree-linked-list-with-minimum-assignment-operators/522193#522193)：

```
struct node * build_123(void)
{
    struct node * list = malloc(sizeof(struct node [3]));
    return memcpy(
        list,
        (struct node []){ { 1, list + 1 }, { 2, list + 2 }, { 3, NULL } },
        sizeof(struct node [3])
    );
} 
```

* * *

最后，我稍微修改了[MSN 的解决方案](https://stackoverflow.com/questions/522010/build-onetwothree-linked-list-with-minimum-assignment-operators/522055#522055)——现在，根本没有赋值：

```
struct node
{
    int data;
    struct node * next;
};

struct node * make_node(struct node * new_node, int data, struct node * next)
{
    return memcpy(new_node, &(struct node){ data, next }, sizeof(*new_node));
}

struct node * create_node(int data, struct node * next)
{
    return make_node(malloc(sizeof(struct node)), data, next);
}

struct node * build_123(void)
{
    return create_node(1, create_node(2, create_node(3, NULL)));
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T20:34:24.857

```
node= malloc
node->data= 1
node->next= malloc
node->next->data= 2
node->next->next= malloc
node->next->next->data= 3
node->next->next->next= NULL 
```

这是一个用两个来完成的：

```
node *make_node(node *new_node, int data, node *next) 
{ new_node->data= data; new_node->next= next; return new_node; }

node *create_node(int data, node *next) 
{ return make_node((node *)malloc(sizeof(node)), data, next); }

node *BuildOneTwoThree(void) 
{ return create_node(1, create_node(2, create_node(3, NULL))); } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T21:11:14.253

使用它总是构建 3 个节点的事实对 Christoph 的代码进行了 4 个分配的轻微修改：

```
struct node
{
    int data;
    struct node * next;
};

struct node * build_123()
{
    struct node* head = malloc( sizeof(struct node) * 3);
    *head     = (struct node){ 1, head+1 };
    *(head+1) = (struct node){ 2, head+2 };
    *(head+2) = (struct node){ 3, NULL };
    return head;
} 
```

编辑：从技术上讲（就汇编而言），使用结构初始化程序可能会导致至少 2 个分配，每个成员一个。所以它在 C 代码中看起来只是 4 个赋值，而实际上它是 7 个或更多。同样，MSN 的递归解决方案也会产生超过 2 个赋值，这些赋值是在递归中抽象出来的（不计算由于函数开销而可能发生的额外赋值，假设它没有内联）。

* * *

编辑：

好的，全局分配在堆栈上，因此即使在汇编中也没有分配。就链接列表（或其他任何东西）而言，糟糕的代码，但无论如何:-)

```
struct node
{
  int data;
  struct node * next;
};

struct node g_nodes[3] = { {1, g_nodes+1}, {2, g_nodes+2}, {3, NULL} };    
struct node * build_123()
{
  return g_nodes;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T21:12:56.980

您可以通过一次`malloc()`调用分配所有三个节点。我怀疑这是他们正在寻找的答案。虽然减少分配的数量不是一个实际问题，但将多个分配捆绑到一个`malloc()`中可以简化内存管理。我希望大多数高级 C 开发人员都熟悉这种技术。

```
struct node* BuildOneTwoThree() {
    struct node *list = malloc(3 * sizeof(struct node));

    list[0].data = 1;
    list[0].next = list+1;
    list[1].data = 2;
    list[1].next = list+2;
    list[2].data = 3;
    list[2].next = NULL;

    return list;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T23:47:56.793

由于没有人说这不是 C++，这是一个 C++ 版本，除了在测试代码中没有分配：

```
#include <iostream>
using namespace std;

struct Node {

    int mVal;
    Node * mNext;

    Node( int v, Node * n ) 
        : mVal( v ), mNext( n ) {}

    ~Node() {
        delete mNext;
    }
};

int main() {

    // build the list
    Node n( 1, new Node( 2, new Node( 3, 0 ) ) );

    // test it
    Node * p = & n;
    while( p ) {
        cout << p->mVal << endl;
        p = p->mNext;
    }

    return 0;
} 
```

# networking - 环回上的流量可以被数据包嗅探吗？

> ID：522012
> 
> 赞同：15
> 
> 时间：2009-02-06T20:19:57.167
> 
> 标签：networking, tcp

如果 PC 也连接到网络（无线或固定电话），是否可以嗅探使用环回 IP 127.0.0.1 (localhost) 在本地计算机上交换的任何数据？

想知道作为本地运行进程的进程间通信手段的环回是否可以被视为交换数据的安全手段（即，不知道任何驻留在网络外部的人使用数据包嗅探器轻松丢弃程序）。

这个问题是针对所有相关的操作系统平台提出的：

*   Win2K/WinXP
*   远景
*   Windows 7的
*   Mac OS X
*   Linux

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-06T20:32:17.063

是的，这是安全的。正如 VBNight 所说，交通永远不会撞到电线或空中。

但是，您实际上可以在本地计算机上嗅探 localhost 流量。例如，在我的 linux 机器上，我做了以下事情：

```
sudo tcpdump -i lo

tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on lo, link-type EN10MB (Ethernet), capture size 96 bytes
15:29:58.056585 IP localhost.56010 > localhost.16001: S 3572335637:3572335637(0) win 32792 <mss 16396,sackOK,timestamp 132126218 0,nop,wscale 6>
15:29:58.056604 IP localhost.16001 > localhost.56010: R 0:0(0) ack 3572335638 win 0
15:29:59.026016 IP localhost.41664 > localhost.41664: UDP, length 1
15:29:59.026346 IP localhost.41664 > localhost.41664: UDP, length 1
15:29:59.126838 IP localhost.41664 > localhost.41664: UDP, length 1
15:29:59.127486 IP localhost.41664 > localhost.41664: UDP, length 1 
```

因此，您可以使用它来嗅探您自己的流量/IPC 消息，但其他人无法在网络上看到它。

这是在系统中使用 TCP 或 UDP 等协议在 lo 接口上用于本地 IPC 的非常常见的情况。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-06T20:22:58.487

它应该不会被网络嗅探到数据包，因为流量永远不会通过网络（或电波）传输。

该本地机器上的进程可以嗅探数据包。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-29T11:00:17.123

您可以使用[RawCap（原始套接字嗅探器）](http://www.netresec.com/?page=Blog&month=2011-04&post=RawCap-sniffer-for-Windows-released)来嗅探 Windows 中的本地主机流量。RawCap 将创建一个 pcap 文件，您可以将其加载到 Wireshark、[NetworkMiner](http://www.netresec.com/?page=NetworkMiner)或任何您想要的文件中。

您将在此 StackOverflow 线程上找到更多信息： [Sniffer for localhost (Windows OS)](https://stackoverflow.com/questions/1566234/sniffer-for-localhost-windows-os)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T20:28:53.513

我很确定流行的数据包嗅探器无法嗅探环回接口（在本地主机上调试东西时会引起很多悲伤和烦恼）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T20:24:51.257

环回接口相对于外部网络可以被认为是安全的。它在同一主机内不安全。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T20:31:11.497

到目前为止的答案是正确的，但我会换一种说法。可以在 localhost 本身上嗅探环回适配器通信，但它通常需要特殊的驱动程序，具体取决于操作系统。不过，环回通信不受外部嗅探器的影响。

我曾经遇到过需要嗅探环回通信的情况，而且设置起来并不容易，但这是可能的（至少在 Windows 上，我敢打赌在 Linux 上也是如此）。

# delphi - 如何在 MS Access 表中插入 800000 条记录？

> ID：522023
> 
> 赞同：5
> 
> 时间：2009-02-06T20:24:18.450
> 
> 标签：delphi, ms-access, ado, delphi-2007

我需要在 MS Access 表中插入 800000 条记录。我正在使用 Delphi 2007 和`TAdoXxxx`组件。该表包含一些整数字段、一个浮点字段和一个只有一个字符的文本字段。其中一个整数字段（不是 autoinc）有一个主键，另一个整数和浮点字段有两个索引。

使用插入数据`AdoTable.AppendRecord(...)`需要> 10 分钟，这是不可接受的，因为每次用户开始使用带有程序的新数据库时都会这样做。我无法预填充表格，因为数据来自另一个数据库（无法通过 访问`ADO`）。

`tAdoCommand`通过将记录写入制表符分隔的文本文件并使用对象执行，我设法缩短到大约 1 分钟

```
insert into table (...) select * from [filename.txt] in "c:\somedir" "Text;HDR=Yes" 
```

但我不喜欢这样的开销。

我认为必须有更好的方法。

编辑：

一些附加信息：

*   选择 MS Access 是因为它不需要在目标机器上进行任何额外的安装，并且整个数据库都包含在一个可以轻松复制的文件中。
*   这是一个单用户应用程序。
*   数据将仅插入一次，并且在数据库的生命周期内不会更改。但是，该表包含一个附加字段，该字段用作标志以指示另一个数据库中的相应记录已由用户处理。
*   一分钟*是*可以接受的（最多 3 分钟也可以），我的解决方案有效，但对我来说似乎太复杂了，所以我认为应该有一种更简单的方法来做到这一点。
*   插入数据后，表的性能相当不错。
*   当我开始计划/实现与 Access 数据库一起使用的程序功能时，不需要该表。直到后来，当客户要求另一个功能时，它才变得必要。（不总是这样吗？）

编辑：

从到目前为止我得到的所有答案来看，似乎我已经获得了将这么多数据插入 Access 表的最快方法。感谢大家，感谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-06T20:31:51.837

既然您说过 800K 记录数据在数据库的生命周期内不会改变，我建议将文本文件作为表链接，并完全跳过插入。

如果硬要拉进数据库，那么1分钟80万条记录就超过13000条/秒。我认为您不会在 MS Access 中击败它。

如果您希望它对用户响应更快，那么您可能需要考虑加载一些最小的数据集，并设置一个后台线程以在它们工作时加载其余部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T20:29:13.730

没有索引会更快。你可以在导入后添加它们吗？

[在这个线程慢 MSAccess 磁盘写入](https://stackoverflow.com/questions/327658/slow-msaccess-disk-writing)中可能有一些可能感兴趣的建议

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T22:21:59.883

跳过文本文件并使用 ODBC 或 OLEDB 直接从源表导入会怎么样？这意味着更改您的 FROM 子句以使用源表名称和适当的连接字符串作为 FROM 子句的 IN '' 部分。

编辑：实际上我看到你说原始格式是 xBase，所以应该可以使用作为 Jet 一部分的 xBase ISAM 而不是需要 ODBC 或 OLEDB。看起来像这样：

```
INSERT INTO table (...) 
SELECT * 
FROM tablename IN 'c:\somedir\'[dBase 5.0;HDR=NO;IMEX=2;]; 
```

您可能需要对此进行调整——我刚刚获取了指向 DBF 文件的链接表的连接字符串，因此参数可能略有不同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T20:57:35.497

换个安排怎么样...

是否可以选择复制具有您需要的此表的现有 Access 数据库文件，然后删除除此大表之外的所有其他数据（不知道 Access 是否具有类似“ SQL Server 中的截断表）？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-07T10:41:18.113

我会用另一个数据库替换 MS Access，对于您的情况，我认为[Sqlite](http://www.sqlite.org)是最佳选择，它不需要任何安装到客户端计算机，它是非常快速的数据库和最好的嵌入式数据库解决方案之一。

您可以通过两种方式在 Delphi 中使用它：

1.  [您可以从Sqlite](http://www.sqlite.org)网站下载数据库引擎 Dll并使用免费的 Delphi 组件来访问它，如[Delphi SQLite 组件](http://www.aducom.com/cms/page.php?2)或[SQLite4Delphi](http://sqlite4delphi.sourceforge.net/)

2.  使用内置引擎的[DISQLite3](http://www.yunqa.de/delphi/doku.php/products/sqlite3/index)，您不必将 dll 与您的应用程序一起分发，它们有免费版本；-)

如果您仍然需要使用 MS Access，请尝试直接使用带有 SQL Insert 语句的 TAdoCommand，而不是使用 TADOTable，这应该比使用 TADOTable.Append 更快；

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-09-14T18:46:24.387

您的基于文本的解决方案似乎是最快的，但如果您可以获得接近末尾大小的预分配 MS Access，您可以更快地获得它。您可以通过填充典型的用户数据库、关闭应用程序（因此刷新缓冲区）并手动删除该大表的所有记录来做到这一点 - 但不收缩/压缩它。

因此，使用该文件开始真正的填充 - Access 不会请求任何（或很少）额外的磁盘空间。如果 MS Access 有办法自动执行此操作，请不要记住，但它可以帮助很多......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-09-14T19:45:27.497

正如有人提到的，您不会在一分钟内导入 800,000 条记录；这已经*非常*快了。

但是，如果您使用正确的方法（DAO 记录集）进行插入，则可以跳过烦人的翻译到文本文件的步骤。请参阅我在 StackOverflow 上提出并回答的上一个问题：[MS Access：为什么 ADODB.Recordset.BatchUpdate 比 Application.ImportXML 慢得多？](https://stackoverflow.com/questions/2986831/ms-access-why-is-adodb-recordset-batchupdate-so-much-slower-than-application-imp)

即使使用 DAO，也不要使用 INSERT INTO；它很慢。也不要使用 ADO；它很慢。但是 DAO + Delphi + Recordsets + 直接实例化 DbEngine COM 对象（而不是通过 Access.Application 对象）会给你很多速度。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-06T20:30:37.223

您正在以一种方式寻找正确的方向。使用单个语句进行批量插入比尝试遍历数据并逐行插入要快。作为基于文件的数据库，Access 在迭代写入中会非常慢。

问题是 Access 正在处理它如何在内部优化写入，并且实际上没有任何方法可以控制它。您可能已经达到了 INSERT 语句的最大效率。为了提高速度，您可能应该评估是否有任何方法可以在每次启动应用程序时将 800,000 条记录写入数据库。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T20:31:37.640

获取[SQL Server Express](http://www.microsoft.com/express/sql/default.aspx)（免费）并从 Access an external table 连接到它。SQL express 比 MS Access 快得多。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T21:03:56.280

我会预填充数据库，并将文件本身交给他们，而不是填充现有的（但为空的）数据库。

如果你要填写的数据发生变化，那么在服务器上保持一个 ODBC 访问数据库（MDB 文件）同步，使用一些代码来查看主数据库中的变化并将它们复制到访问数据库中。

当用户请求一个新数据库时，压缩 MDB，将其传输给他们，然后打开它。

或者，您可以找到直接打开数据并将数据插入数据库的代码。

或者，您可能能够找到另一种格式（csv 除外），该格式可以更快地导入。

-亚当

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-06T20:34:30.460

`adLockBatchOptimistic`也许您可以使用锁定模式和 CursorLocation打开表的 ADO 记录集`adUseClient`，将所有数据写入记录集，然后进行批量更新（`rs.UpdateBatch`）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-06T21:02:07.313

还要检查复制文件需要多长时间。这将是您写入数据的速度的下限。在 db 之类的 SQL 中，通常需要批量加载实用程序才能接近该速度。据我所知，MS 从未像 bcp 那样创建直接写入 MS Access 表的工具。专门的 ETL 工具也会优化一些围绕插入的步骤，比如 SSIS 在内存中进行转换的方式，DTS 也有一些优化。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-06T22:00:18.647

如果它来自dbase，您可以直接复制数据和索引文件并直接附加而不加载吗？应该非常有效（来自为您带来 FoxPro 的人。）我想它也会使用现有的索引。

至少，它应该是一个非常有效的单命令导入。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-07T09:07:07.570

800,000 条记录从一次创作到另一次创作的变化有多大？是否可以预先填充记录，然后在创建新数据库时更新外部数据库中已更改的记录？

这可以让您更快地创建新的数据库文件。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-09T07:36:49.163

你的磁盘转动速度有多快？如果是 7200RPM，那么 3 分钟内 800,000 行仍然是磁盘每转 37 行。我不认为你会做得比这更好。

同时，如果目标是简化流程，那么表格链接怎么样？

你说你不能通过 ADO 访问源数据库。您可以在 MS Access 中设置表链接到源数据库中的表或视图吗？然后，来自表链接的简单追加查询将为您将数据从源数据库复制到目标数据库。我不确定，但我认为这会很快。

如果直到运行时才能设置表链接，也许您可​​以通过 ADO 以编程方式构建表链接，然后以编程方式构建追加查询，然后调用追加查询。

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2010-09-14T10:34:55.910

嗨最好的方法是从 txt 文件批量插入，因为他们说您应该将记录插入 txt 文件，然后将 txt 文件批量插入表中，时间应该小于 3 秒。

# plsql - 不错的免费离线 PL/SQL 格式化程序

> ID：522040
> 
> 赞同：5
> 
> 时间：2009-02-06T20:31:09.157
> 
> 标签：plsql, formatting, offline

有谁知道免费和离线 PL/SQL 的良好格式化程序？

非常感谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T20:36:16.243

不太清楚你所说的“离线”是什么意思，但是 Oracle 有一个名为 SQL Developer 的工具，它是免费的，可以从他们的网站下载。它有一些格式选项，您可以将其应用于您的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T20:35:58.273

[SQLinForm](https://www.sqlinform.com)有桌面版

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-01-10T04:38:54.370

[Instant SQL 格式化程序](http://www.dpriver.com/pp/sqlformat.htm)是一个免费的在线 sql 格式化程序，没有任何查询大小限制。

# domain-driven-design - 你如何处理 DDD 中聚合之间的关联？

> ID：522043
> 
> 赞同：17
> 
> 时间：2009-02-06T20:31:42.663
> 
> 标签：domain-driven-design, aggregate

我还在纠结 DDD，我遇到的绊脚石之一是如何处理不同聚合之间的关联。假设我有一个封装客户的聚合和另一个封装发货的聚合。

出于业务原因，Shipments 是它们自己的集合，但它们需要明确地与客户相关联。我的客户域实体应该有一个货件清单吗？如果是这样，我如何在存储库级别填充此列表 - 假设我将有一个 CustomerRepository 和一个 ShipmentRepository（每个聚合一个 repo）？

我说的是“关联”而不是“关系”，因为我想强调这是一个领域决策，而不是基础设施决策——我首先从模型设计系统。

编辑：我知道我不需要将表直接建模为对象——这就是我首先设计模型的原因。在这一点上，我根本不关心数据库——只关心这两个聚合之间的关联。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-06T21:10:16.563

您的 ShipmentRepository 没有理由无法将客户数据汇总到您的货件模型中。存储库不必与表进行一对一的映射。

我有几个存储库，它们将多个表组合成一个域模型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T20:54:59.187

我认为回答这个问题有两个层次。一方面，问题是我如何填充客户和发货之间的关系。我真的很喜欢“填充”语义，您的货件存储库可以有一个 fillOrders(List customers, ....)。

另一个层次是“我如何处理作为 DDD 一部分的非规范化域模型”。而“客户”可能是最好的例子，因为它只是出现在很多不同的上下文中；几乎您的所有流程中都有客户，而且客户的环境通常非常多样化。最多有一半时间您对“订单”感兴趣。如果我在开始时对领域的理解是完美的，我永远*不会*提出客户领域的概念。但事实并非如此，所以我总是最终制作 Customer 对象。我仍然记得*3 年*后我觉得我能够制作正确的“客户”域模型的项目。我*会*正在寻找也代表客户的替代和更详细的概念；PotentialCustomer、OrderingCustomer、CustomerWithOrders 可能还有其他一些；对不起，名字不是更好。我需要更多时间；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T01:25:19.877

Shipment 与 Customer 具有多对一的关系。如果您正在寻找客户的货件，请向您的货件存储库添加一个带有客户参数的查询。

一般来说，当多方不受限制时，我不会在实体之间创建一对一的关联。

# .net - 如何从 DataGrid 获取 HTML 输出？

> ID：522048
> 
> 赞同：2
> 
> 时间：2009-02-06T20:32:51.960
> 
> 标签：.net, html, datagrid, webforms, render

我想知道是否有办法获得[DataGrid](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.aspx)的 HTML 输出。我想要数据绑定到网格后的*原始HTML。*我可以用来完成此任务的渲染方法是否存在某种重载？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T20:40:46.360

```
var outputBuffer = new StringBuilder();
using (var writer = new HtmlTextWriter(new StringWriter(outputBuffer)))
{
    yourDataGrid.RenderControl(writer);
}
outputBuffer.ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T20:38:03.400

即使您确实重写了 Render 方法并调用了基本的 Render 方法，HTML 也会在流中。

也许[控制适配器](http://weblogs.asp.net/scottgu/archive/2005/12/21/asp-net-2-0-control-adapter-architecture.aspx)架构可以帮助您尝试完成的任何事情？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T20:44:50.297

您可以在您的类中使用这种方法（从 DataGrid 派生）：

```
protected override void Render(System.Web.UI.HtmlTextWriter writer)
{
    StringWriter sw = new StringWriter();
    HtmlTextWriter hw = new HtmlTextWriter(sw);
    base.Render(hw);

    string html = ProcessHtml(sw.ToString());

    writer.Writer(html);
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-06T20:35:51.860

```
protected internal override void Render(HtmlTextWriter writer)
{
     /// use HtmlTextWriter to customize your output
} 
```

# javascript - 什么是最好的 javascript 混淆器？

> ID：522064
> 
> 赞同：18
> 
> 时间：2009-02-06T20:36:16.243
> 
> 标签：javascript, obfuscation

我正在寻找使用 javascript 混淆器。哪些是最受欢迎的，它们对性能有什么影响？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T20:46:45.067

雅虎有一个很好的。从技术上讲，它是一个缩小器，但它在过程中的混淆方面做得很好。

[YUI 压缩机](http://developer.yahoo.com/yui/compressor/ "YUI 压缩机")

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-05-15T18:06:34.807

测试了 8 种不同的混淆器（www.javascriptobfuscator.com 除外），并惊讶于它们的糟糕程度。最终使用正则表达式编写了我自己的混淆器。享受：

```
static Dictionary<string, string> names = new Dictionary<string, string>();
static bool testing = false;
static string[] files1 = 
    @"a.js,b.js,c.js"
    .Split(new string[] { Environment.NewLine, " ", "\t", "," }, StringSplitOptions.RemoveEmptyEntries);
static string[] ignore_names = 
    @"sin,cos,order,min,max,join,round,pow,abs,PI,floor,random,index,http,
    __defineGetter__,__defineSetter__,indexOf,isPrototypeOf,length,clone,toString,split,clear,erase
    RECT,SIZE,Vect,VectInt,vectint,vect,int,double,canvasElement,text1,text2,text3,textSizeTester,target,Number
    number,TimeStep,images,solid,white,default,cursive,fantasy,".
  Split(new string[] { Environment.NewLine, " ", "\t", "," }, StringSplitOptions.RemoveEmptyEntries);
string[] extra_names = @"a,b,c".Split(new string[] { Environment.NewLine, " ", "\t", "," }, StringSplitOptions.RemoveEmptyEntries);
string src = @"C:\temp";
string dest1 = src + "\\all1.js";
string dest2 = src + "\\all2.js";

static void Main()
{
  File.Delete(dest1);
  File.Delete(dest2);
  foreach (string s in files1)
    File.AppendAllText(dest1, File.ReadAllText(src + "\\" + s) + Environment.NewLine + Environment.NewLine + Environment.NewLine + Environment.NewLine + Environment.NewLine + Environment.NewLine, Encoding.UTF8);

  string all = File.ReadAllText(dest1);
  int free_index = 0;

  foreach (string s in extra_names)
  {
    free_index++;
    string free_name = "" + (char)('A' + (free_index % 25)) + (char)('A' + ((free_index / 25) % 25));
    Debug.Assert(free_name != "AA");
    names.Add(s, free_name);
  }

  Regex reg1 = new Regex("(var |function |\\.prototype\\.)([a-zA-Z0-9_]+)");

  int startat = 0;
  while (startat < all.Length)
  {
    Match match = reg1.Match(all, startat);
    if (!match.Success)
      break;

    string key = all.Substring(match.Groups[2].Index, match.Groups[2].Length);
    if (!ignore_names.Contains(key))
    {
      free_index++;
      string free_name = "" + (char)('A' + (free_index % 25)) + (char)('A' + ((free_index / 25) % 25));
      Debug.Assert(free_name != "AA");
      if (!names.ContainsKey(key))
        names.Add(key, testing ? key + free_name : free_name);
    }
    startat = match.Groups[0].Index + match.Groups[0].Length;
  }

  Regex reg2 = new Regex(@"/\*.*\*/", RegexOptions.Multiline);
  Regex reg3 = new Regex("([^:\\\\])//.*\r\n");
  Regex reg4 = new Regex("([a-zA-Z0-9_]+)");
  Regex reg5 = new Regex("(\r\n)*[ \t]+");
  Regex reg6 = new Regex("(\r\n)+");
  all = reg2.Replace(all, eval2);
  all = reg3.Replace(all, eval3);
  all = reg4.Replace(all, eval4);
  all = reg5.Replace(all, eval5);
  all = reg6.Replace(all, eval6);
  File.WriteAllText(dest2, all);
}

public static string eval4(Match match)
{
  return names.ContainsKey(match.Groups[1].Value) ? names[match.Groups[1].Value] : match.Groups[0].Value;
}
public static string eval5(Match match)
{
  return string.IsNullOrEmpty(match.Groups[1].Value) ? " " : Environment.NewLine;
}
public static string eval6(Match match)
{
  return Environment.NewLine;
}
public static string eval2(Match match)
{
  return " ";
}
public static string eval3(Match match)
{
  return match.Groups[1].Value + Environment.NewLine;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-06T20:39:26.673

好吧，谷歌把这个作为第一个链接：

[http://www.javascriptobfuscator.com](http://www.javascriptobfuscator.com)

但我想知道 javascript 的混淆有什么好处。无论您在需要混淆的 javascript 中做什么，都应该在服务器端完成，对吧？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T21:13:16.123

我从未在生产中使用过混淆器，但我测试过[JavaScript Utility](http://jsutility.pjoneil.net/)，它看起来还不错。

至于性能，**每次**加载页面时都必须即时解压缩混淆代码。对于小脚本可能不是问题，但是对于较大的文件，解包时间会很重要。另一方面，浏览器可以直接执行压缩代码。

一些混淆器可能会产生无法在较旧或不太常见的浏览器中运行的输出。您应该使用您计划支持的浏览器进行非常仔细的测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T22:22:35.530

你也可以试试Dean Edwards 写的[JavaScript Compressor 。](http://dean.edwards.name/packer/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-12T15:48:12.500

我不得不说Hackvertor（否认是我写的）它是免费的，它支持基于标签的转换。查看示例：-

[http://www.businessinfo.co.uk/labs/hackvertor/hackvertor.php#PEBoYXNlZ2F3YV83KCKqwMHCw8TGyMnKy8zNzs%2FQ0dLT1NXW2Nna29zd3t%2Fg4eLj5OXm5%2Bjp6uvs7e7v8PHy8%2FT19vj5%2Bvv8%2Ff4kXyIpPmFsZXJ0KCJJJ2Qgc2F5IEhhY2t2ZXJ0b3IiKTxAL2hhc2VnYXdhXzc%2B](http://www.businessinfo.co.uk/labs/hackvertor/hackvertor.php#PEBoYXNlZ2F3YV83KCKqwMHCw8TGyMnKy8zNzs%2FQ0dLT1NXW2Nna29zd3t%2Fg4eLj5OXm5%2Bjp6uvs7e7v8PHy8%2FT19vj5%2Bvv8%2Ff4kXyIpPmFsZXJ0KCJJJ2Qgc2F5IEhhY2t2ZXJ0b3IiKTxAL2hhc2VnYXdhXzc%2B)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-16T11:12:11.203

带base62的打包机

[http://dean.edwards.name/packer/](http://dean.edwards.name/packer/)
[https://github.com/jcoglan/packr](https://github.com/jcoglan/packr) <= ruby​​ 版本

# c# - C# 1.1：监控工作线程

> ID：522075
> 
> 赞同：0
> 
> 时间：2009-02-06T20:40:51.880
> 
> 标签：c#, .net, multithreading

使用 .Net Framework 1.1，有哪些选项可用于监视来自其他线程的线程？我试图解决 1.1 中线程实现的一个缺点，其中未处理的异常将导致线程无声地死掉。在 2.0 及更高版本中，这已得到纠正，因此任何线程上的任何未处理的异常都会导致整个应用程序死掉，我相信。

当我的应用程序中的线程死亡时，我想从主线程中检索尽可能多的上下文：它们正在执行的方法、堆栈跟踪等。我可以确定它们何时死亡，但检索上下文已被证明是困难的。我已经尝试为`AppDomain.CurrentDomain.UnhandledException`事件注册一个处理程序。但是当事件发生时我不会被召回。这可能是由于我正在开发的 API 的限制。

除了这个事件，当线程死在另一个线程上时，还有哪些选项可用于从线程获取上下文？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T20:53:48.907

你是如何创建这些线程的？您是否正在向线程池添加委托？如果是这样，您可以创建一个包装器方法，该方法采用提供的委托并围绕它包装另一个委托，该委托负责您的 try/catch，然后将该新委托添加到线程池队列中。这样您就可以在第二个委托中放入错误处理代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T21:00:01.563

您可以尝试添加一个线程异常处理程序：

System.Threading.ThreadExceptionEventArgs e 将包含有关未处理异常的信息。

```
// Setup Default Thread Exception Handler
Application.ThreadException += new System.Threading.ThreadExceptionEventHandler(Application_ThreadException);

static void Application_ThreadException(object sender, System.Threading.ThreadExceptionEventArgs e)
{
    // Insert Code
} 
```

来源：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T20:51:21.673

由线程 ID 索引的映射中每个线程的递增计数如何？当它停止增加时，它就死了，是时候杀死和/或重新启动它了。该地图可以包含您管理所有这些以及在托管线程和那些讨厌的小孩之间共享信息所需的一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T20:57:03.487

我将创建一个方法，该方法将接收通常传递给线程的回调，然后在一些包装代码中调用该方法，您将使用这些代码跟踪线程中的异常，如下所示：

```
public class ThreadStarter
{
  ThreadStart start;

  public ThreadStarter(ThreadStart start)
  {
    this.start = start
  }

  public void Run()
  {
    // Create the thread.
    Thread t = new Thread(new ThreadStart(InternalRun));
    t.Start();
  }

  private void InternalRun()
  {
    // Wrap in a try/catch.
    try
    {
      // Run the code.
      start();
    }
    catch (Exception e)
    {
      // Process exception here.
    }
  }
} 
```

# asp.net-mvc - asp.net MVC - 如何做一个主/详细页面

> ID：522077
> 
> 赞同：3
> 
> 时间：2009-02-06T20:42:06.030
> 
> 标签：asp.net-mvc

我希望创建一个主/详细信息页面。我看到它以两种方式之一工作：

*   单击网格中的一行会再次调用同一页面，并添加一个详细信息面板。
*   单击一行会 javascript/JSON 调用返回详细信息并填充面板的控制器操作。

我希望突出显示选定的行。选定的行可以是分页网格中的几页。

听起来很容易。不幸的是，我是 asp.net MVC 的新手，而且我不是经验丰富的程序员。但是，我可以遵循和调整示例。我会很感激上述两种方法的例子来帮助我学习 MVC。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T19:46:54.173

回答我自己的问题：

我最终使用了 PartialViews 和 jQuery。

单击一行上的选择链接会导致在所选行下方添加一个新行（使用 jQuery）。在这一行中，我使用 jQuery 来获取 /PurchaseOrder/Detail（一个 PartialView）。

这是我的Javascript：

```
function GetDetails(id, enableEdit) {

        var detailsRowExists = $().find("#detailsRow").size();

        if (detailsRowExists) {
            // Delete details row
            // Note: need to rename id for row to be deleted
            // because jQuery does not wait for the row to be
            // deleted before adding the new row.
            $("#detailsRow").attr("id", "detailsRowOld");
            $("#detail").slideUp("normal", function() {
                $("#detailsRowOld").remove();
            });
        };

        // Put new row below selected one
        $("tr[id=" + id + "]").after("<tr id='detailsRow'><td colspan='4'><div id='detail'><img src='../../Content/wait20trans.gif' />Loading...</div></td></tr>");

        // Pull details into new row
        $.get("/PurchaseOrder/Detail/" + id, { enableEdit: enableEdit },
            function(data) {
                $("#detail").hide();
                $("#detail").html(data);
                $("#detail").slideDown("normal");
            }
        );

    } 
```

希望这可以帮助其他人尝试实现主/详细信息页面。

# c# - DataGridView Autogeneratecolumns 作为 TextBox 而不是标签

> ID：522080
> 
> 赞同：1
> 
> 时间：2009-02-06T20:42:20.630
> 
> 标签：c#, asp.net, vb.net, datagridview, autogeneratecolumn

我怎样才能拥有一个自动生成文本框而不是标签的数据网格视图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T21:12:22.737

简而言之，你不能。您可以从 gridview 继承并自己实现它。它可能看起来像这样：

```
Public Class MyGrid
Inherits GridView

Private Sub MyGrid_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles Me.RowDataBound
  If Me.AutoGenerateColumns = True Then
    If e.Row.RowType = DataControlRowType.DataRow Then
        For Each c As TableCell In e.Row.Cells
            Dim tb As New TextBox()
            tb.Text = c.Text
            c.Controls.Clear()
            c.Controls.Add(tb)
        Next
    End If
    End If
End Sub 
```

# .net - 重新分配 resgen

> ID：522086
> 
> 赞同：1
> 
> 时间：2009-02-06T20:46:25.863
> 
> 标签：.net, visual-studio, resgen

任何人都知道您是否可以将 resgen.exe 作为应用程序的一部分重新分发？MSDN 上似乎没有关于此的任何文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T21:15:02.233

参数。我应该挖得更深。看起来 ResourceWriter 做同样的事情，我不需要重新分配它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T20:49:58.993

由于 EULA，它很可能必须与 .NET 框架一起分发，因此您必须为要运行 resgen 的任何版本的框架分发 .NET 的完整安装。

# geometry - 两点之间的位置？

> ID：522088
> 
> 赞同：9
> 
> 时间：2009-02-06T20:46:34.630
> 
> 标签：geometry

我有一个 python 应用程序，我需要在其中找到一个恰好位于两个屏幕坐标之间的位置，但我似乎找不到执行此操作的算法。如何实现？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-06T20:49:27.573

X 坐标为 (x1 + x2) / 2

y 坐标为 (y1 + y2) / 2

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-06T20:50:13.797

你想找到一条线的中点。这是一篇小文章来解释其背后的数学原理。 [~~[http://regentsprep.org/regents/math/midpoint/Lmidpoint.htm](http://regentsprep.org/regents/math/midpoint/Lmidpoint.htm)~~（死链接）]

[https://en.wikipedia.org/wiki/Midpoint](https://en.wikipedia.org/wiki/Midpoint)

[![中点公式图像](https://i.stack.imgur.com/WRywg.png)](https://i.stack.imgur.com/WRywg.png)

基本上，您的算法将如下所示：

```
midX = (x1 + x2) / 2

midY = (y1 + y2) / 2 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-06T20:49:39.587

这是初等几何：

*   点 1(x1,y1)
*   点2(x2,y2)
*   point_in_the_middle(x=(x1+x2)/2,y=(y1+y2)/2)

还是你的意思是别的？

dmckee：是的，亲爱的！:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T20:50:09.240

中点 (C) 应该是两点 (A, B) 的平均值：

```
Cx = (Ax + Bx) / 2
Cy = (Ay + By) / 2 
```

# sql - 谁能告诉我为什么我的 SQL 查询不起作用（请参阅详细信息）？

> ID：522105
> 
> 赞同：0
> 
> 时间：2009-02-06T20:50:53.420
> 
> 标签：sql, count, inner-join

我使用以下查询来查找重复项：

```
SELECT userID,
COUNT(userID) AS NumOccurrences
FROM userDepartments
GROUP BY userID
HAVING ( COUNT(userID) > 1 ) 
```

然后我尝试添加一个内部连接，以便我可以看到匹配的用户名，这些用户名存储在不同的表中。

```
SELECT userDepartments.userID, users.firstname, users.lastname,
COUNT(userID) AS NumOccurrences
FROM userDepartments INNER JOIN users ON userDepartments.userID = users.userID
GROUP BY userID
HAVING ( COUNT(userID) > 1 ) 
```

但它给了我一个错误，说 users.firstname 不是某个聚合函数或其他东西的一部分......

有谁知道我如何获得计数，只显示具有多个部门的用户，并从另一个表中获取名字和姓氏，这样我就可以获得分配了多个部门的用户名列表？

编辑：这是最终为我工作的查询......

```
SELECT     firstname, lastname
FROM         tbl_users
WHERE     (userID IN
                          (SELECT     userID
                            FROM          tbl_usersDepts
                            GROUP BY userID
                            HAVING      (COUNT(userID) > 1))) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T20:58:33.890

我会稍微重新排列查询....

```
SELECT
    duplicates.NumOccurrences,
    duplicates.userID,
    users.firstname,
    users.lastname
FROM (
    SELECT
        userID,
        COUNT(userID) AS NumOccurrences
    FROM userDepartments
    GROUP BY userID
    HAVING COUNT(userID) > 1
) duplicates
INNER JOIN users ON duplicates.userID = users.userID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T20:54:03.057

SQL 引擎不知道每个用户 ID 只有一个用户名，因此您必须按名字和姓氏以及用户 ID 进行分组。

```
SELECT userDepartments.userID, users.firstname, users.lastname,
COUNT(userID) AS NumOccurrences
FROM userDepartments INNER JOIN users ON userDepartments.userID = users.userID
GROUP BY userID, users.firstname, users.lastname
HAVING ( COUNT(userID) > 1 ) 
```

如果您不按名字和姓氏进行分组，那么引擎不知道如果它为给定的用户 ID 获得多个名字的值时应该做什么。通过告诉它按所有三个值分组，它知道如果每个用户标识多于一行，它应该返回所有这些行。即使这不应该发生，在这种情况下，引擎也不够聪明，无法自行决定。

你也可以这样做：

```
SELECT users.userId, users.firstname, users.lastname, departments.NumOccurrences
FROM users INNER JOIN (
     SELECT userId, count(userId) as NumOccurrences 
     FROM userDepartments 
     GROUP BY userID 
     HAVING ( COUNT(userID) > 1 )
) departments ON departments.userID = users.userID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T20:53:42.043

按所有三个分组：userDepartments.userID、users.firstname 和 users.lastname

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T20:54:12.353

您需要在 GROUP BY 子句中包含 user.firstname 和 users.lastname - 因为它们不是聚合值（请注意，MySQL 确实支持您在查询中使用的语法，但它不是标准的）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T20:54:45.050

如果您执行“分组依据”，则“选择”部分中的所有内容都需要：

1.  在“分组依据”条款中提及或

2.  聚合函数的结果（如 count()）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T20:59:38.833

我会这样做（在 Oracle 中，以防万一这在您的系统中不起作用）：

```
SELECT users.userID, users.firstname, users.lastname, NumOccurrences
  FROM users
       INNER JOIN (
         SELECT userID, COUNT(userID) AS NumOccurrences
           FROM userDepartments
           GROUP BY userID
           HAVING ( COUNT(userID) > 1 )
       ) d
       ON d.userID = users.userID 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T20:59:45.807

我看到很多关于将您的姓名字段添加到 group by 的好注释。不过，我想我会这样做：

```
SELECT Users.*, dups.NumOccurances, ud.DepartmentName
FROM Users
INNER JOIN
  (
    SELECT userID, COUNT(userID) AS NumOccurrences
    FROM userDepartments
    GROUP BY userID
    HAVING ( COUNT(userID) > 1 )
  ) dups ON dups.userID = Users.UserID
INNER JOIN userDepartments ud ON ud.UserID=Users.UserID
ORDER BY Users.LastName, Users.FirstName, Users.UserID 
```

采用这种方法的一个原因是，它可以更轻松地返回并获取您可能想要的任何其他信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-06T21:00:13.107

将您的 user.Firstname 和 User.lastname 添加到您的 group by 子句

# string - 有什么简单的方法可以判断单词列表是否是彼此的字谜？

> ID：522112
> 
> 赞同：7
> 
> 时间：2009-02-06T20:52:31.703
> 
> 标签：string, language-agnostic, anagram

你将如何列出彼此字谜的单词？

当我申请我现在的工作时，我被问到这个问题。

`orchestra`可以重新排列成`carthorse`所有原始字母只使用一次，因此这些词是彼此的字谜。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-06T20:54:56.610

将所有字母按字母顺序放入字符串中（排序算法），然后比较结果字符串。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-06T21:30:04.607

幸好我们都生活在 C# 现实中，即在内存溢出的四核机器上对短词进行就地排序。:-)

但是，如果您碰巧受到内存限制并且无法触及原始数据，并且您知道这些单词包含 ASCII 表下半部分的字符，您可以使用不同的算法来计算每个字母中每个字母的出现次数单词而不是排序。

如果您想在 O(N) 中执行该算法并且不关心内存使用情况（每个 Unicode 字符的计数器可能非常昂贵），您也可以选择该算法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-06T20:54:51.230

对每个元素进行排序（删除空格）并与前一个元素进行比较。如果它们都相同，它们都是字谜。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T21:02:00.420

有趣的是，[Eric Lippert 的 Fabulous Adventures In Coding Blog](http://blogs.msdn.com/ericlippert/)在 2009 年 2 月 4 日的[这篇文章](http://blogs.msdn.com/ericlippert/archive/2009/02/04/a-nasality-talisman-for-the-sultana-analyst.aspx)中处理了这个问题的一个变体。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T20:57:15.560

以下算法应该有效：

1.  对每个单词中的字母进行排序。

2.  对每个列表中已排序的字母列表进行排序。

3.  比较每个列表中的每个元素是否相等。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-28T01:57:49.827

对列表中的单词进行排序。

如果 abc、bca、cab、cba 是输入，那么排序列表将是 abc、abc、abc、abc。

现在他们所有的**哈希码**都是相等的。比较哈希码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-06T20:55:42.443

对字母进行排序和比较（逐个字母、字符串比较……）是首先想到的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T08:10:41.170

1.  比较长度（如果不相等，则不是机会）
2.  制作字符串长度的位向量
3.  对于第一个字符串中的每个`char`，在第二个字符串中找到它的出现
4.  为第一次未设置的事件设置位
5.  如果你能找到一站失败

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-19T12:21:16.017

```
public static void main(String[] args) {

    String s= "abc";
    String s1="cba";

     char[] aArr = s.toLowerCase().toCharArray(); 
     char[] bArr = s1.toLowerCase().toCharArray();

  // An array to hold the number of occurrences of each character
  int[] counts = new int[26]; 

  for (int i = 0; i < aArr.length; i++){
   counts[aArr[i]-97]++;  // Increment the count of the character at respective position
   counts[bArr[i]-97]--;  // Decrement the count of the character at respective position
  }

  // If the strings are anagrams, then counts array will be full of zeros not otherwise
  for (int i = 0; i<26; i++){
   if (counts[i] != 0)
    return false;
  } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-11T07:05:16.017

anagram 的尝试哈希码逻辑给了我错误的输出

```
public static Boolean anagramLogic(String s,String s2){
    char[] ch1 = s.toLowerCase().toCharArray();
        Arrays.sort(ch1);
        char[] ch2= s2.toLowerCase().toCharArray();
        Arrays.sort(ch2);
        return ch1.toString().hashCode()==ch2.toString().hashCode(); //wrong
    } 
```

要纠正此代码，以下是我看到的唯一选项，感谢任何建议

```
char[] ch1 = s.toLowerCase().toCharArray();
        Arrays.sort(ch1);
        char[] ch2= s2.toLowerCase().toCharArray();
        Arrays.sort(ch2);
        return Arrays.equals(ch1,ch2);
    } 
```

# mootools - 如何在 MooTools 中控制类名 class="fValidate['required']"

> ID：522125
> 
> 赞同：1
> 
> 时间：2009-02-06T20:54:15.693
> 
> 标签：mootools

我正在为 MooTools 使用 fValidator 插件，并且发现有必要控制（取决于用户选择）插件使用的所需类。

该类使用了一种以前从未使用过的奇怪格式，出于某种原因，MooTools 可以识别它。它可能与转义方括号和单引号有关。

我试过这样的东西，除其他外，但还没有运气。

这是代码：

```
$("checkbox3").removeClass("fValidate\\[\\'required\\'\\]"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T14:12:19.003

您是否希望删除/添加验证所需的元素？由于它首先会获取所有元素，因此您必须取消注册它们，删除该类，然后重新注册它们。

不幸的是，默认情况下它似乎没有取消注册方法，因此您必须修改脚本才能添加它，而且由于注册方法不解析类名，您必须添加一个新方法来执行此操作. 最后，您必须将添加到模糊字段的事件注册为一个绑定，您可以重新使用该绑定来删除该事件

这是一个相当复杂的 fValidator 补丁/重写来实现这一点，如果可能的话，我会看看另一个验证脚本——比如[表单检查](http://mootools.floor.ch/blog/?p=18 "表格检查")，它允许你在运行时取消注册和重新注册字段（在很多其他的改进）。

# windows - 如何将应用程序窗口作为属于另一个进程的窗口的子窗口托管？

> ID：522126
> 
> 赞同：3
> 
> 时间：2009-02-06T20:54:40.370
> 
> 标签：windows, hosting, embedding, reparenting

我想将来自进程“A”的应用程序窗口托管到进程“B”的主窗口中，就像“A”的窗口是 MDI 子窗口一样。这在 Windows 中可能吗？还是有一些技巧可以让我伪造这个？

顺便说一句，当“A”的窗口嵌入到“B”的窗口中时，我想删除它的标题栏（或者更好的是，所有非客户端的东西）。我想这必须通过调整窗口样式或窗口类来实现，但我绝不是这些 Win32 错综复杂的专家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T21:25:34.287

可以托管 Window。通过调用 SetParent 函数来更改 A 的父 HWND。要更改窗口样式，您需要使用 GetWindowLong/SetWindowLong 对来更改要使用的属性。

如果这是第三方应用程序（即，不是您的应用程序），那么您可能会遇到困难，特别是如果窗口对其窗口进行任何主题化或任何自定义（例如，更改拖动区域等） ）。

# visual-studio - VisualStudio：如何在设计时将虚线边框添加到 UserControl？

> ID：522133
> 
> 赞同：3
> 
> 时间：2009-02-06T20:55:20.307
> 
> 标签：visual-studio, user-controls

我有一个来自 UserControl 的用户控件。

当拖放到窗体上时，用户控件是不可见的，因为它没有任何类型的边框来显示自己。

PictureBox 和 Panel 控件在设计时绘制一个 1px 虚线边框以使其可见。

这样做的正确方法是什么？是否有一个属性可以用来让 VS 添加它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T22:39:53.093

没有属性会自动执行此操作。但是，您可以通过覆盖控件中的 OnPaint 并手动绘制矩形来归档它。

在被覆盖的事件中，您可以调用 base.OnPaint(e) 来绘制控件内容，然后添加使用图形对象在边缘周围绘制虚线。

```
 protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        if (this.DesignMode)
             ControlPaint.DrawBorder( e.Graphics,this.ClientRectangle,Color.Gray,ButtonBorderStyle.Dashed);   
    } 
```

如您所见，您需要将此额外代码包装在查询控件 DesignMode 属性的 if 语句中，以便它仅在您的 IDE 中绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-25T21:35:10.527

执行此操作的方式`Panel`（这表明这是执行此操作的实际正确方式）是使用[`DesignerAttribute`](https://msdn.microsoft.com/en-us/library/system.componentmodel.designerattribute(v=vs.110).aspx). 此属性可用于设计时添加到`Control`-components 以及非控制组件（如`Timer`）。

使用时，`DesignerAttribute`您需要指定一个派生自`IDesigner`. 特别是对于`Control`设计师，您应该从[`ControlDesigner`](https://msdn.microsoft.com/en-us/library/system.windows.forms.design.controldesigner(v=vs.110).aspx).

在您`ControlDesigner`想要覆盖的特定实现中[`OnPaintAdornment`](https://msdn.microsoft.com/en-us/library/system.windows.forms.design.controldesigner.onpaintadornments(v=vs.110).aspx)。此方法的目的是专门在控件顶部绘制设计器提示，例如边框。

下面是`Panel`使用的实现。您可以复制它并将其用于您的控制，但您显然需要调整专门引用`Panel`该类的部分。

```
internal class PanelDesigner : ScrollableControlDesigner
{
    protected Pen BorderPen
    {
        get
        {
            Color color = ((double)this.Control.BackColor.GetBrightness() < 0.5) ? ControlPaint.Light(this.Control.BackColor) : ControlPaint.Dark(this.Control.BackColor);
            return new Pen(color)
            {
                DashStyle = DashStyle.Dash
            };
        }
    }
    public PanelDesigner()
    {
        base.AutoResizeHandles = true;
    }
    protected virtual void DrawBorder(Graphics graphics)
    {
        Panel panel = (Panel)base.Component;
        if (panel == null || !panel.Visible)
        {
            return;
        }
        Pen borderPen = this.BorderPen;
        Rectangle clientRectangle = this.Control.ClientRectangle;
        int num = clientRectangle.Width;
        clientRectangle.Width = num - 1;
        num = clientRectangle.Height;
        clientRectangle.Height = num - 1;
        graphics.DrawRectangle(borderPen, clientRectangle);
        borderPen.Dispose();
    }
    protected override void OnPaintAdornments(PaintEventArgs pe)
    {
        Panel panel = (Panel)base.Component;
        if (panel.BorderStyle == BorderStyle.None)
        {
            this.DrawBorder(pe.Graphics);
        }
        base.OnPaintAdornments(pe);
    }
} 
```

`ScrollableControlDesigner`是一个公共类，您可能希望也可能不希望将其用作特定设计器实现的基础。

# c# - 启动时隐藏表单

> ID：522154
> 
> 赞同：10
> 
> 时间：2009-02-06T20:59:50.097
> 
> 标签：c#, winforms, forms, hide

我有一个程序，它只需要一个 NotifyIcon 就可以按预期工作。所以我一直试图在程序启动时隐藏主窗体。

在 frmMain_Load 中，我都尝试了

```
this.Hide();
this.Visible = false; 
```

没有成功。

它们在其他方法中工作，例如在 NotifyIcon_MouseClick 方法中，但我希望它在加载时隐藏。

我在 SO 的另一个问题中看到了 Matias 提出的建议：

```
BeginInvoke(new MethodInvoker(delegate
{
    Hide();
})); 
```

这可行，但是当我启动程序时，我可以看到表单快速闪烁。总比没有好，但我想知道是否有更好的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-06T21:27:55.250

```
// In Your Program.cs Convert This
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new Form1());
}

// To This
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Form1 TheForm = new Form1();
    Application.Run();
}

// Call Application.Exit() From Anywhere To Stop Application.Run() Message Pump and Exit Application 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T21:16:37.410

如果您的程序具有默认的 Visual Studio 生成的 Program.cs 文件，则有一种简单的方法：

```
[STAThread]
static void Main()
{
    Application.EnableVisualStyles ();
    Application.SetCompatibleTextRenderingDefault (false);
    Application.Run (new MainForm ());
} 
```

调用的简单事实`Run`确实使表单可见。尝试在表单的属性中执行以下操作：

1.  设置`WindowState`为`Minimized`
2.  设置`ShowInTaskbar`为`false`

这应该可以解决问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T21:02:20.513

不要在表单上调用 Show 或 ShowDialog，您可以让 Application.Run 以自定义类为目标，然后实例化表单并且不显示或创建 NotifyIcon 实例并从那里处理所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T21:19:56.437

您也可以将 this.hide = true 放在 form_shown 事件中。我相信该事件仅在加载事件之后触发一次。如果您的表单有很多控件和/或计算机速度很慢，您可能会看到一点点闪烁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T21:21:27.243

如果您的程序不需要表单来运行，那么最好的方法是根本没有表单。
在程序代码中设置您的 NotifyIcon，然后进入一个循环，直到您想通过设置某个值或调用某个方法来退出程序。
在此示例中，设置`UserExitCalled`为 true ( `Program.UserExitCalled = true`) 将导致程序退出。

这是一个简短的例子：

```
static class Program {
    internal static Boolean UserExitCalled;

    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main() {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);

        // Setup your tray icon here

        while (!UserExitCalled) {
            Application.DoEvents(); // Process windows messages
            Thread.Sleep(1);
        }

        return;
    }
} 
```

这里是我的系统托盘应用程序之一的完整程序类作为工作示例。

```
// *********************************************************************
// [DCOM Productions .NET]
// [DPDN], [Visual Studio Launcher]
//
//   THIS FILE IS PROVIDED "AS-IS" WITHOUT ANY WARRANTY OF ANY KIND. ANY
//   MODIFICATIONS TO THIS FILE IN ANY WAY ARE YOUR SOLE RESPONSIBILITY.
//
// [Copyright (C) DCOM Productions .NET  All rights reserved.]
// *********************************************************************

namespace VisualStudioLauncher
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Windows.Forms;
    using System.Threading;
    using VisualStudioLauncher.Common.Objects;
    using VisualStudioLauncher.Forms;
    using System.Drawing;
    using VisualStudioLauncher.Common.Data;
    using System.IO;

    static class Program
    {
        #region Properties

        private static ProjectLocationList m_ProjectLocationList;
        /// <summary>
        /// Gets or Sets the ProjectsLocationList
        /// </summary>
        public static ProjectLocationList ProjectLocationList
        {
            get
            {
                return m_ProjectLocationList;
            }

            set
            {
                m_ProjectLocationList = value;
            }
        }

        private static ShellProcessList m_ShellProcessList = null;
        /// <summary>
        /// Gets or Sets the ShellProcessList
        /// </summary>
        public static ShellProcessList ShellProcessList
        {
            get
            {
                return m_ShellProcessList;
            }

            set
            {
                m_ShellProcessList = value;
            }
        }

        private static NotifyIcon m_TrayIcon;
        /// <summary>
        /// Gets the programs tray application.
        /// </summary>
        public static NotifyIcon TrayIcon
        {
            get
            {
                return m_TrayIcon;
            }
        }

        private static bool m_UserExitCalled;
        /// <summary>
        /// Gets a value indicating whether the user has called for an Application.Exit
        /// </summary>
        public static bool UserExitCalled
        {
            get
            {
                return m_UserExitCalled;
            }

            set
            {
                m_UserExitCalled = value;
            }
        }

        // TODO: Finish implementation, then use this for real.
        private static ApplicationConfiguration m_ApplicationConfiguration = null;
        /// <summary>
        /// Gets the application configuration
        /// </summary>
        public static ApplicationConfiguration ApplicationConfiguration
        {
            get
            {
                if (m_ApplicationConfiguration == null)
                    m_ApplicationConfiguration = ApplicationConfiguration.LoadConfigSection(@"./settings.config");

                return m_ApplicationConfiguration;
            }
        }

        #endregion

        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main(string[] args)
        {
            if (args.Length > 0)
            {
                if (args[0].ToLower() == "-rmvptr")
                {
                    for (int i = 1; i < args.Length; i++) {
                        try {
                            if (File.Exists(Application.StartupPath + @"\\" + args[i])) {
                                File.Delete(Application.StartupPath + @"\\" + args[i]);
                            }
                        }
                        catch { /* this isn't critical, just convenient */ }
                    }
                }
            }

            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            SplashForm splashForm = new SplashForm();
            splashForm.Show();

            while (!UserExitCalled)
            {
                Application.DoEvents();
                Thread.Sleep(1);
            }

            if (m_TrayIcon != null)
            {
                m_TrayIcon.Icon = null;
                m_TrayIcon.Visible = false;
                m_TrayIcon.Dispose();

                GC.Collect();
            }
        }

        #region System Tray Management

        public static void SetupTrayIcon()
        {
            m_TrayIcon = new NotifyIcon();
            m_TrayIcon.Text = Resources.UserInterfaceStrings.ApplicationName;
            m_TrayIcon.Visible = false; // This will be set visible when the context menu is generated
            m_TrayIcon.MouseDoubleClick += new MouseEventHandler(m_TrayIcon_MouseDoubleClick);

            if (Orcas.IsInstalled)
            {
                m_TrayIcon.Icon = Orcas.Icon;
            }
            else if (Whidbey.IsInstalled) {
                m_TrayIcon.Icon = Whidbey.Icon;
            }
            else {
                m_TrayIcon.Icon = SystemIcons.Warning;
                m_TrayIcon.Text = "Visual Studio is not installed. VSL cannot run properly.";
            }
        }

        static void m_TrayIcon_MouseDoubleClick(object sender, MouseEventArgs e)
        {
            if (e.Button != MouseButtons.Left)
            {
                return;
            }

            SettingsForm settingsForm = new SettingsForm();
            settingsForm.Show();
        }
        #endregion
    }
} 
```

# java - 是否有可能在不使用小程序的情况下获得 Web 浏览器的 Java VM？

> ID：522158
> 
> 赞同：3
> 
> 时间：2009-02-06T21:01:24.633
> 
> 标签：java, javascript

我们有一个古老的 Java 小程序，我们希望升级到更新版本的 Java（5 或 6），但是直到今天，我们一直支持使用 Java VM 的人早在 1.1 版（特别是那些仍在使用微软虚拟机）

作为升级的一部分，我们希望能够为使用过时虚拟机的人们提供一个网页，告诉他们我们现在支持哪些版本以及他们可以从哪里下载它们。理想情况下，我们希望这样做，**而**不必首先提供 Java 1.1 小程序来确定 JVM 版本。

将不胜感激以下任一问题的答案（如果可能，请提供代码示例）：

问题 1：是否可以使用来自 HTTP 标头的信息来确定服务器上脚本中的 JVM？

问题2：是否可以仅使用JavaScript来确定客户端上的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T21:08:54.803

Q1：没有

Q2：是的，但我不知道它的便携性如何：

```
<html><head><title>Test</title>
</head><body>
<script type="text/javascript">
document.writeln('<table border="1">');
for (var i = 0; i < navigator.plugins.length; i++) {
  document.writeln("<tr>");
  document.writeln("<td>" + navigator.plugins[i].name + "<\/td>");
  document.writeln("<td>" + navigator.plugins[i].description + "<\/td>");
  document.writeln("<td>" + navigator.plugins[i].filename + "<\/td>");
  document.writeln("<\/tr>");
}
document.writeln("<\/table>");
</script>
</body></html> 
```

输出所有插件的表，应该包含版本。我认为您必须遍历所有插件，检查名称中是否包含“java”，然后从描述中解析版本...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T00:12:15.887

有一个部署工具包可以做这种事情。

提供小程序应该不会太糟糕。它可以是 1x1 像素错误，也可以是使用带有小 1.1 类的普通小程序，如果它可以加载您的 1.5 代码，则转发小程序生命周期方法。

没有人应该仍然使用 1.1。多年来，它一直没有修复安全漏洞。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T02:03:04.307

这个脚本似乎在所有主流浏览器上都能做到这一点：

[http://www.pinlady.net/PluginDetect/JavaDetect.htm](http://www.pinlady.net/PluginDetect/JavaDetect.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T02:05:06.157

我认为[部署工具包](http://java.sun.com/javase/6/docs/technotes/guides/jweb/deployment_advice.html)可能会做你想做的事。

> 使用 deployJava 中的 runApplet() 函数来确保在启动 applet 之前客户端计算机上的最小 Java 运行时环境可用。

# algorithm - 如何在固定区域生成不重叠的圆圈？

> ID：522164
> 
> 赞同：0
> 
> 时间：2009-02-06T21:02:07.830
> 
> 标签：algorithm, graphics

在有限空间内生成已知数量的非重叠固定半径圆的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T21:05:25.590

如果您只想在小区域内尽可能多的圆圈，请使用[hexagonal close packing](http://www.pages.drexel.edu/~bel23/HCP.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T21:06:44.373

用最少的剩余空间做到这一点的方法是将圆的中心放在六边形网格上，就像你制作金字塔硬币时得到的图案一样。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T21:07:46.117

参见维基百科上的[圆包装定理](http://en.wikipedia.org/wiki/Circle_packing_theorem)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-06T21:04:53.767

您可以将屏幕拆分为网格，并在每个“正方形”中画一个圆圈:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T21:09:59.967

我认为您的问题没有得到很好的说明。对世代有什么限制吗？

这是一个随机收集固定半径的非重叠圆的拒绝算法：

1.  维护所有圈子的列表
2.  生成候选人
    1.  在允许的区域中生成一个随机中心
    2.  测试列表中的每个现有圆圈是否与候选人发生冲突，如果发现任何冲突，则拒绝。如果全部通过，请将此候选人添加到您的列表中。
3.  转到＃1，直到您对生成的数字感到满意

**编辑：**更仔细地阅读问题，指定半径......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T21:08:27.207

这将取决于您未指定的空间形状和对圆圈性质的其他限制。例如，要在一个高度为 Y 长度为 X 的矩形中生成 N 个不重叠的圆，让每个圆的直径为 X/10*N 或 Y/10*N，取较小者，并让每个中心间隔均匀地分布在分割矩形的水平线上，横跨其长度的一半。

# g++ - Magick++ 和 cygwin 的 g++ 问题

> ID：522171
> 
> 赞同：2
> 
> 时间：2009-02-06T21:04:25.280
> 
> 标签：g++, cygwin, imagemagick, magick++

当我尝试使用 Magick++ 和 cygwin 编译一个简单的 c++ 文件时，我不断得到这个结果：

```
$ g++ -o imageTest imageTest.cpp `GraphicsMagick++-config --cppflags --cxxflags --ldflags --libs`  
g++: unrecognized option `-no-undefined'
/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld: cannot find -ldpstk  
collect2: ld returned 1 exit status 
```

我通过 cygwin gui 设置安装了 ImageMagick。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T09:45:23.933

GraphicsMagick 和 ImageMagick 是两个不同的库。如您所说，如果您想使用 ImageMagick 构建程序，只需更改即可

```
GraphicsMagick++-config 
```

进入

```
Magick++-config 
```

这应该有效。至于 GraphicsMagick，看起来 Cygwin 中当前的 -devel 库已损坏，因为它需要一个不再可用的库 (libdpstk)。（有兴趣的可以看[这里。）](http://lists.xastir.org/pipermail/xastir/2006-December/010620.html)

# asp.net - 你能阻止 LinqDataSource 设置属性吗？

> ID：522172
> 
> 赞同：1
> 
> 时间：2009-02-06T21:04:51.397
> 
> 标签：asp.net, linq-to-sql, linqdatasource

我有一个正在尝试更新的 Linq 2 SQL 对象。此对象的两个属性相互关联，设置一个设置另一个。

所以如果我这样做：

Foo.Code = 啤酒；

Foo.CodeID 属性将自动设置为 5（或其他值。）

问题是 LinqDataSource 设置 Foo.Code，然后立即设置 Foo.CodeID... 它没有绑定到任何东西，因为我们希望用户只设置 Code。这会立即将它们都设置回 null。

我知道我可以使用参数作为默认值，但是有没有办法告诉 LinqDataSource 甚至不设置属性？

编辑：通过创建隐藏字段并在表单视图的 ItemUpdating 事件中为该字段分配正确的值来解决问题。仍然希望避免进行四次相同的查找...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T22:26:24.040

是否可以将 Code 属性设为私有（在 dbml 中选择 Code 属性并在 Properties 窗口中设置 access 属性）并创建一个新的公共属性，您可以对其进行更多控制？

我个人已经编写了一个生成器，可以为我生成必要的文件（如 sqlmetal），让我可以完全控制代码。如果您不喜欢生成的 dbml，也许这也是您的一个选择。

# sql-server - SSIS 多播 - 在执行下一个分叉之前等待一个分叉完成

> ID：522177
> 
> 赞同：8
> 
> 时间：2009-02-06T21:06:15.293
> 
> 标签：sql-server, ssis

我有一个 SSIS 多播对象，它将我的流分成 2 条路径。

在第一个路径中，我将流插入另一个数据库。

在第二条路径中，我更新了流的行以显示它们已被插入。

我需要一种方法让一条路径等到另一条路径完成。（所以我可以处理任何插入错误，而不是更新那些错误的行。）

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T23:12:05.210

我对此进行了更多研究，这是我想出的答案：

在多播的每个输出上，我都进行了排序操作，然后使用 MergeJoin 操作加入它们。之后，我使用 OLE DB 命令对没有来自 mergejoin 的错误值的项目执行 SQL 更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-11-18T19:37:22.127

如果您大致知道完成一个 fork 需要多长时间，您可以在第二个 fork 上使用 OLE DB 命令。输入“waitfor delay '00:00:15'”以使服务器在进入下一步之前等待 15 秒。

[![等待](https://i.stack.imgur.com/0QWEx.png)](https://i.stack.imgur.com/0QWEx.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T21:38:05.900

你不能在 SSIS 中这样做。您只能在控制流级别强制执行优先约束（即强制运行顺序）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T21:18:07.673

在那种情况下，我不会使用多播，而是使用常规数据流，以便在第一个成功完成之前不会启动

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-17T19:59:02.897

最好的选择是实际使用脚本组件。从那里您可以管理使用 try catch 块按顺序进行插入和更新。

# java - Maven 项目有哪些额外的目录约定？

> ID：522197
> 
> 赞同：8
> 
> 时间：2009-02-06T21:12:36.950
> 
> 标签：java, maven-2, conventions

Maven 2 使用标准的项目目录布局，记录在这里：

[http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)

我想知道的是：除了普通的 Java 库、Java EE 和 WebApp 项目之外，还有其他项目的推荐约定吗？具体来说，在哪里放置ant文件、启动脚本、配置文件、示例应用等。

此外，将文件放在 src/ 目录树之外的约定是什么？例如，将文档放在 doc/ 下（作为 src 的兄弟）是否很常见？

是否有编译这些约定的页面？如果没有，其他读者能否提供他们自己项目中的示例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T21:51:01.677

我放置额外配置文件的主文件夹位于 src/main/java/resources 下。通常我在那里创建子目录。测试可以有自己的配置文件 src/test/resources。

您可以使用 pom.xml 的 build 部分中的指令来指定其他资源目录以及将文件复制到目标目录中特定位置的位置。通常，您尝试使用的语言或框架会出现约定。在这种情况下，混乱可以隐藏在父 pom.xml 中

请参阅[http://maven.apache.org/pom.html#Resources](http://maven.apache.org/pom.html#Resources)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-20T17:56:49.180

我认为桌面应用程序没有官方布局，但这是我们使用的布局。

*   src/main/config - 配置文件，复制并过滤到 ${project.build.directory}/config。
*   src/main/scripts - sh、bat、README 和其他被复制和过滤到 ${project.build.directory} 的纯文本文件。
*   **src/main/bin -未**过滤并复制到 ${project.build.directory}的二进制文件。
*   src/main/build - 构建过程使用但未包含在应用程序中的任何其他脚本、ant 文件或资源。
*   src/main/assembly - 用于创建应用程序程序集的程序集描述符。
*   使用 maven-dependency 插件将依赖项复制到 ${project.build.directory}/lib。
*   如果您使用包含 config 和 lib 目录以及与所有项目共享的标准文件类型的共享程序集描述符 jar，则可以加分。要包含的一组好的默认文件类型是具有可执行权限的 .sh、.bat 和 .exe；.jar、.zip、.txt、.pdf、.xml、.properties、.conf、.ico、.png、.jpg 具有标准权限。
*   使用 maven-jar 插件将 config 目录和 lib/ 前缀添加到类路径以制作可运行的 jar。
*   添加一个安装程序配置文件，使用 maven-assembly 插件和程序集描述符构建应用程序的程序集。然后，如果需要，该程序集可以由单独的安装程序项目使用。
*   避免将任何其他内容放在 src/ 级别。如果您确实需要，请将文档放在 src/site/ 目录（例如 src/site/sphinx）或 src/doc 中。
*   将上述所有配置放在父/公司 pom 中以与您的所有项目共享。只需在项目中引用 maven-dependency、maven-resources、maven-jar 和 maven-assembly 插件即可构建几乎无需配置的整个应用程序（不要忘记为 maven-jar 插件设置主类） .

# php - PHP中加载扩展的方法之间的差异

> ID：522200
> 
> 赞同：1
> 
> 时间：2009-02-06T21:13:03.830
> 
> 标签：php, php-extension

```
extension="ext.so"
zend_extension="/usr/lib/php4/ext.so"
zend_extension_ts="/usr/lib/php4/ext.so" 
```

有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T23:47:58.120

扩展用于加载向语言添加功能的用户模块，例如数据库访问、图像处理。zend_extension 和 zend_extension_ts 用于加载扩展底层 PHP 引擎的模块。一个这样的例子是[xdebug](http://xdebug.org)，一个允许您调试 PHP 应用程序的扩展。zend_extension_ts 用于启用 ZTS 的 PHP 安装。要查看您是否有 ZTS 构建，请从以下位置获取输出：

```
<?php
phpinfo();
?> 
```

# java - 如何序列化由 Spring 的 DataBinder 加载的 javabean？

> ID：522202
> 
> 赞同：0
> 
> 时间：2009-02-06T21:13:21.817
> 
> 标签：java, spring, serialization, properties, javabeans

我需要将一个javabean（带有任意嵌套的bean）序列化为纯文本，然后再恢复为一个对象图。

对于这个问题，我对 XML、JSON 等不感兴趣，而是对名称/值对感兴趣。

[Spring DataBinder](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/validation/DataBinder.html)非常适合将名称/值对列表转换为真正的对象。例如，我们可以提供：

```
values.addPropertyValue("id", "6789");
values.addPropertyValue("nestedBean[0].systemId", "FOO");
values.addPropertyValue("nestedBean[1].systemId", "BAR"); 
```

并使用 DataBinder 生成一个包含两个嵌套 bean的顶级 bean（带有 property `id`） 。`List`

我的问题是，如何轻松地将 bean 序列化为 DataBinder 期望的格式？

我希望有以下形式：

```
Map<String,String> reduceBeanToNameValuePairs(Object bean) 
```

但没有运气找到任何类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T23:43:29.477

你可以看看[Commons BeanUtils](http://commons.apache.org/beanutils/)。它的[BeanMap](http://commons.apache.org/beanutils/v1.8.0/apidocs/org/apache/commons/beanutils/BeanMap.html)类提供了一个[entrySet](http://commons.apache.org/beanutils/v1.8.0/apidocs/org/apache/commons/beanutils/BeanMap.html#entrySet())方法，用于访问作为映射条目的包装 bean 的属性。

对于“平面”bean，此功能已经足够了，并且可能会为为嵌套 bean 图添加必要的递归提供一个很好的起点。

# .net - 非规范化数据集

> ID：522208
> 
> 赞同：3
> 
> 时间：2009-02-06T21:15:36.320
> 
> 标签：.net, dataset, denormalization

我有一个带有一些 DataTables 的 DataSet，这些 DataTables 与 DataRelations（经典订单 Header/Detail 对）链接在一起。有没有一种简单的方法可以将整个批次非规范化为具有相关表的所有列的单个 DataTable？

表名和列在编译时是未知的，可能有两个以上的表/关系。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-02T10:44:30.483

我自己也有同样的问题，但由于这个问题没有答案，我不得不自己编写非规范化器。事实证明这并不是那么困难 - 所以这是您（或遇到此问题的其他人）可能能够使用/扩展的第一个剪辑：

```
public class DataSetDenormalizer
{
    public void DenormalizeRelationships(DataSet dataSet)
    {
        IOrderedEnumerable<DataRelation> orderedRelationship = SortRelationshipsByNumberOfChildRows(dataSet);
        var tablesToRemove = new List<DataTable>();

        foreach (DataRelation relationship in orderedRelationship)
        {
            DenormalizeColumns(relationship);
            DenormalizeData(relationship);
            RemoveDenormalizedRelationships(dataSet, relationship, tablesToRemove);
        }
    }

    private IOrderedEnumerable<DataRelation> SortRelationshipsByNumberOfChildRows(DataSet dataSet)
    {
        var relationships = new List<DataRelation>();
        foreach (DataRelation relationship in dataSet.Relations)
            relationships.Add(relationship);
        return relationships.OrderBy(r => r.ChildTable.Rows.Count);
    }

    private void DenormalizeColumns(DataRelation relationship)
    {
        for (int columnIndex = 0; columnIndex < relationship.ParentTable.Columns.Count; ++columnIndex)
        {
            DataColumn column = relationship.ParentTable.Columns[columnIndex];
            if (relationship.ParentColumns.Contains(column)) continue;
            relationship.ChildTable.Columns.Add(new DataColumn(column.ColumnName, column.DataType));
        }
    }

    private void DenormalizeData(DataRelation relationship)
    {
        for (int rowIndex = 0; rowIndex < relationship.ChildTable.Rows.Count; ++rowIndex)
        {
            DataRow row = relationship.ChildTable.Rows[rowIndex];
            DataRow parentRow = row.GetParentRow(relationship);

            for (int columnIndex = 0; columnIndex < relationship.ParentTable.Columns.Count; ++columnIndex)
            {
                DataColumn column = relationship.ParentTable.Columns[columnIndex];
                if (relationship.ChildTable.Columns.Contains(column.ColumnName))
                {
                    row.SetField(column.ColumnName, parentRow[column]);
                }
            }
        }
    }

    private void RemoveDenormalizedRelationships(DataSet dataSet, DataRelation relationship, List<DataTable> tablesToRemove)
    {
        dataSet.Relations.Remove(relationship);
        relationship.ChildTable.Constraints.Remove(relationship.RelationName);

        if (!tablesToRemove.Contains(relationship.ParentTable))
            tablesToRemove.Add(relationship.ParentTable);

        int numberOfColumns = relationship.ChildColumns.Length;
        for (int columnIndex = 0; columnIndex < numberOfColumns; ++columnIndex)
        {
            relationship.ChildTable.Columns.Remove(relationship.ChildColumns[columnIndex]);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T21:26:09.310

我不认为数据集本身就支持这一点，但在代码中很容易做到。

首先，您应该创建一个空数据表，然后从要合并的两个表中添加您需要的所有列。

然后，您逐步浏览主表中的数据，并逐步浏览相关表中的所有相关行。对于相关表中的每一行，您在新表中创建一个新行，并将两个数据行中的数据插入到新行中。

我现在无法访问这里的视觉工作室，但你明白了。

# html - 使用 diff 查找许多文件中相同的部分？（bizzaro 差异或逆差异）

> ID：522221
> 
> 赞同：3
> 
> 时间：2009-02-06T21:20:24.297
> 
> 标签：html, diff, inverse

## 比扎罗差异！！！

有没有办法做一个比扎罗/逆差异，只显示一组文件中相同的部分？（IE方式多于[三个文件](http://meld.sourceforge.net/meld_preview.png)）

奇怪的问题，我知道......但我正在将某人的古老静态页面转换为[更易于管理](https://stackoverflow.com/questions/518168/utilitiy-dynamic-creation-of-static-pages-im-not-asking-this-because-i-want-t)的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T21:37:13.610

您可以尝试*comm*命令（用于**common**）。它一次只会比较 2 个文件，但您应该能够通过一些巧妙的脚本来完成 3+ 个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T21:50:32.397

你可以试试[sim](http://www.cs.vu.nl/~dick/sim.html)。自从我使用它已经有几年了，但我记得它在寻找文件或许多不同文件中的相似之处时非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T10:26:17.707

你想要一个克隆检测器。它检测跨大型源系统的类似代码块。请参阅我们的 ClonedR 工具：[http ://www.semdesigns.com/Products/Clone/index.html](http://www.semdesigns.com/Products/Clone/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T06:08:44.420

这是一个[经典的问题](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem)。

如果我必须快速处理它，我可能会做类似 diff -U 1000000 的事情（假设一个支持它的 diff 版本），通过 sed 管道来获得共同的行（并去除前导空格）。不过，您必须遍历所有文件。

编辑：我忘了还有[Tcl 实现](http://tcllib.sourceforge.net/doc/struct_list.html)会稍微通用，但需要更多的编码。您可能能够找到适合您选择的语言的实现。

# c# - C# 与 LISP 中的函数式编程

> ID：522222
> 
> 赞同：31
> 
> 时间：2009-02-06T21:20:28.183
> 
> 标签：c#, functional-programming, programming-languages, lisp

LISP 和 C# 在函数式编程方面的主要区别是什么？具体来说，如果 LISP 程序员要改用 C#，他们最有可能错过的功能是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-06T21:53:30.377

在 C# 中进行函数式编程在技术上是可行的（嗯，任何具有等效函数指针或委托的语言都可以是“函数式的”）——但是如果你尝试做很多事情，C# 会变得非常痛苦。

在我的脑海中，没有特别的顺序：

*   类型推断
    *   现在只存在于当地人
    *   应该适用于几乎所有东西
    *   我在 C# 中遇到的 #1 问题就是这个。特别是当您声明一个本地函数时... Func<...> = 哎哟。
*   完整的一流功能
    *   代表不是答案，因为它们在结构上并不等效。没有规范类型来表示某种类型的函数。例如：什么是“增量”？它是一个功能吗？是转换器吗？是别的吗？这反过来又使推理更加复杂。
*   自动泛化
    *   不得不计算和指定所有泛型类型参数及其约束
*   更好地支持不变性
    *   让声明简单数据类型变得简单
    *   Copy-with-modify type stuff (var x = oldX { SomeField = newVal })
*   **元组**C# 7
*   有区别的联合（总和类型）
*   **模式匹配**C# 7
    *   使元组和求和类型更有价值
    *   允许更多面向表达式的代码
*   一般单子语法
    *   **使诸如异步代码之类的东西更容易编写**C# 5
    *   在您嵌套了 2 层以上的 BeginXXX/EndXXX 之后，它变得非常难看。
*   功能块的简单语法，因此您不会以“});});”之类的结束行结束

*编辑：*还有一个：

*   功能组成

    *   现在做任何类型的函数组合都很痛苦。柯里化、链接等。LINQ 在这里不会受到伤害，因为扩展方法像实例方法一样采用第一个参数。
*   **C# 也应该发出 tail.call。**不需要，JIT 将酌情添加尾调用。

自编写此答案以来，已解决**粗体**项目。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-06T21:25:04.100

主要是对不变性的支持。

创建不可变类型并验证它是否不可变应该很容易。*使用*不可变类型应该很容易- 支持对象和集合初始化器，但对于不可变的情况。

之后：更好的类型推断能力、元组、模式匹配和支持库（同样，不可变列表等）。

编辑：我应该说我*不是*一个函数式程序员，但我是一个 C# 程序员，试图学习更多的函数式方法。我目前正在（以某种方式）帮助编写函数式编程书籍，所以我在那里学习了很多东西。

但是，希望您对 LINQ 感到满意。它确实使处理数据序列的工作*变得更加*轻松。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-06T21:59:21.770

如果您询问的是*Lisper*而不是 ML 系列函数式程序员，您将不会听到任何有关元组或推理的信息。他们会沾沾自喜地说一件事：宏。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-07T01:35:02.147

根据您的问题，作为一个 Lisper，我在用 Java 编程时想念什么（对不起，我不使用 C#）：

1.  良好的语法：s 表达式。
2.  动态类型：没有复杂的类型声明。
3.  关闭。

据我了解，C# 分别用`var`和处理 (2) 和 (3) 。`=>`所以我的主要问题是花括号和分号，以及冗长、令人困惑的泛型类型声明。

* * *

根据你的标题，作为一名*函数式程序员*（Haskell），我想念其他人所说的：不变性、完整类型推断、元组、模式匹配、更容易的泛型，因为没有子类化、强类型库。

另外，作为一名 Haskell 程序员，我仍然不喜欢花括号和分号。:)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-06T21:54:16.460

稍微扩展一下 Jon 的观点，函数式编程语言对我来说真正的价值不是它们拥有什么，而是它们缺少什么。

如今，大多数“大型”语言都具有（或可能被欺骗拥有）基本的函数式编程原语，例如递归、高阶函数等。因此，如果您真的想要，可以在大多数语言中以函数式编程风格编写（见鬼，如果您在 C 编译器中进行了尾调用优化，那么您几乎可以用 C 编写函数式代码）。

另一方面，主流语言也拥有大量纯函数式编程语言所没有的东西，这些东西真的可以“打破”函数模型，让你无法推理你的函数——样式程序的方式与您对纯函数式语言的方式相同。可变的局部和全局变量，所有围绕可变状态并发（传统多线程编程）的用具，即使处理不当的迭代，都会使您的函数式代码无法运行（就像它一样）。

即使您可能能够克制自己不滥用主流编程语言中的功能，但随着时间的推移接触代码的每个人都不太可能能够克制自己，因此您不能对代码库的功能做出假设没有真正彻底的代码审查。一些“非功能性”问题也非常微妙，因此想要编写功能性代码的人可能会犯错。

确保你是函数式的最好方法是学习和使用函数式编程语言。我已经成功地学习了 Erlang，以至于我现在在我非常有限的业余时间大约两周内编写了一个游戏服务器，所以这并不是什么挑战——我相信函数式编程语言，一旦你包装您的头脑围绕基本概念，更容易学习，因为它们更加简洁。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-01-18T13:15:08.233

与 Linq（基本上是嵌入在 C# 中的一种函数式语言，在观看[Erik Meijers 博士关于 Haskell 的精彩视频系列](http://channel9.msdn.com/tags/C9+Lectures/)时变得更加明显）结合的一点创意将使您的代码看起来更具功能性。

这是一个不使用 Linq 的示例：

哈斯克尔：

```
 minThree :: Int -> Int -> Int -> Int
        minThree x y z 
          | x <= y && x <=z   = x
          | y <=z             = y                      
          | otherwise         = z 
```

C＃：

```
 int MinThree(int x, int y, int z)
    {
        return
              x <= y && x <= z    ? x
            : y <= z              ? y
            : z;

    } 
```

只是不要让 Resharper 代码清理运行在您的代码上，因为它会使它看起来像这样：

```
 int MinThree(int x, int y, int z)
    {
        return
            x <= y && x <= z
                ? x
                : y <= z
                      ? y
                      : z;
    } 
```

:(

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-09T21:01:20.730

我是，我愿意。也就是说，我在家里使用 Lisp，在工作中使用 C#，而在使用 C# 时我确实想念 Lisp。这个问题有点好笑，因为我不认为（通用）Lisp 比 C# 或 Ruby 或任何其他多范式语言更“实用”。

总的来说，C# 的功能特性变得相当不错，即使有点尴尬，它们可能已经足够好。（Common Lisp 对函数式编程的支持当然也不完美！）但是 Common Lisp 是一种多范式语言；C# 在语法抽象、代码生成、方法调度灵活性等方面不（也可能永远不会）与 Lisp 相匹敌。

如果你正在寻找一个借口来避免学习 Lisp，因为你认为 C# 同样强大，对不起。:-)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-06T21:55:39.453

除了乔恩的回答

1.  元组 - 元组可以使用库，但它缺乏大多数函数式语言所具有的内在语法。
2.  选项 - 与元组几乎相同
3.  深度类型推断支持 - C# 在 VS 2008 中添加了基本类型推断支持，但仅限于方法主体内的局部变量。大多数函数式语言，比如 F#，都有深度类型推断支持，它确实使语言更易读恕我直言

Eric 关于为什么 C# 没有深度推理：http: [//blogs.msdn.com/ericlippert/archive/2009/01/26/why-no-var-on-fields.aspx](http://blogs.msdn.com/ericlippert/archive/2009/01/26/why-no-var-on-fields.aspx)

4.  尾递归：C# 具有基本的尾递归支持，但它并未根植于语言中。请参阅我的博客文章，了解 C# 尾递归和延续在何处发生故障

[http://blogs.msdn.com/jaredpar/archive/2008/11/10/comparing-continuations-in-f-and-c.aspx](http://blogs.msdn.com/jaredpar/archive/2008/11/10/comparing-continuations-in-f-and-c.aspx)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-06T21:59:15.623

多个返回值。与返回元组相比，“out”和“ref”是不可读的。

正如 Jon 所说，更好地支持不变性。现在，由于人类纪律，类的不变性是可能的。

但最缺乏的功能是围绕不变性设计的可靠集合框架。

在我当前的项目中，我预计不变性将是一个巨大的胜利，而且确实如此，但集合框架是一场可怕的比赛。

例如，假设您想将员工添加到公司，例如

```
public Company AddEmployee(Employee employee)
{
    var newEmployeeList = new List(EmployeeList); 
    newEmployeeList.Add(employee);
    return new Company(newEmployeeList.AsReadOnly(), ....)
} 
```

只是不是很好执行或很好实施。

有一次，我什至考虑从一个简单的不可变 Cons 类开始制作我自己的集合。:)

另一方面，Linq 对我们来说非常好。我真的很喜欢它介绍的方法。我发现特殊的 Linq 语法不符合我的口味。

编辑：我的排名太低，无法发表评论，所以我会在这里回复乔恩的评论。乔恩，由于可维护性，我认为这是一个坏主意。在接下来的十年中维护这个项目的人可能没有太多的 Lisp/函数式编程知识。这让我想起了另一件事。我想知道在我的不可变对象变为可变之前需要多少个月的维护。（免责声明，IT 业务有时处于淘金热时代，我痛苦地意识到许多开发人员甚至不了解不可变和闭包之类的功能。）

# php - php下拉菜单填充

> ID：522227
> 
> 赞同：2
> 
> 时间：2009-02-06T21:23:18.847
> 
> 标签：php, jquery, drop-down-menu

我正在尝试编写一个 php 脚本，该脚本将根据主下拉菜单的选择填充第二个下拉菜单。我想使用 jquery 来做所有非页面刷新的事情。但是我发现那里存在的每一件事都很难理解和修改，你知道有什么写得很好而且很容易理解的东西，或者那里存在的教程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T00:24:47.437

这里有一些代码可以让你了解你想要做什么：

**HTML**

```
<select id="state" name="state">
    <option value="IL">Illinois</option>
    <option value="IN">Indiana</option>
</select>
<select id="city" name="city">
    <option value="">Please select a state...</option>
</select> 
```

**PHP**

```
<?php
    $cities = array(
        'IL' => array( 'Chicago', 'Naperville', 'Decatur', 'Saint Charles' ),
        'IN' => array( 'Gary', 'Miller', 'Portage', 'Merrillville' )
    );

    print json_encode( $cities[ $_POST[ 'state' ] ] );
    exit;
?> 
```

**jQuery**

```
jQuery(document).ready(function() {

    jQuery('#state').change(function() {
        jQuery.post(
            'some-url.php',
            {
                'state':jQuery('#state').val()
            },
            function(data, textStatus) {
                jQuery.each(data, function(index, value) {
                    jQuery('#city').append('<option value="' + value + '">' + value + '</option>');
                });
            },
            'json'
        );
    });

}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T21:43:34.923

网上有很多关于如何做到这一点的例子，[这里](http://remysharp.com/2007/01/20/auto-populating-select-boxes-using-jquery-ajax/)是 Remy Sharp 在他的博客上的一个很好的例子（[完整的例子在这里](http://remysharp.com/wp-content/uploads/2007/01/select.html)）

基本上，您所做的是在您的服务器上调用一个 PHP 页面，并在更改时使用您的第一个下拉列表的值。例如，如果您的第一个下拉列表是美国的州列表，那么您的第二个下拉列表可能会显示所选州的城市。当第一个下拉菜单被选中时，它的`onChange`事件会触发对服务器上 PHP 页面的请求，并传递状态名称 ( `example.com/city_lookup.php?state=NY`)

JQuery 然后接收来自`city_lookup`脚本的响应（[JSON 编码](http://en.wikipedia.org/wiki/JSON)可能是最好的方法），然后循环通过它并将值写入您的第二个下拉菜单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-15T07:22:21.610

再添加一行 `jQuery('#city').html('');`
现在代码如下所示：

```
jQuery(document).ready(function() {

    jQuery('#state').change(function() {

          jQuery('#city').html('');   
          jQuery.post(
                'some-url.php',
                {
                        'state':jQuery('#state').val()
                },
                function(data, textStatus) {
                        jQuery.each(data, function(index, value) {
                                jQuery('#city').append('<option value="' + value + '">' + value + '</option>');
                        });
                },
                'json'
        );
    });

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T21:43:12.863

两种不同的方式：

*   使第一级触发返回第二级所需数据的 AJAX 查询
*   为所有可能的选择编写一个包含所有所需数据的树形结构，并将其隐藏在初始页面中您的 Javascript 可以读取它的某个位置。完成的 HTML 菜单（根据需要隐藏和显示）或 JS 部分中的大 JSON 对象。

# python - 如何在 python 代码中使用 storeHtmlSource (Selenium RC)

> ID：522229
> 
> 赞同：0
> 
> 时间：2009-02-06T21:23:49.157
> 
> 标签：python, html, selenium

[我在Selenium 参考](http://seleniumhq.org/projects/core/reference.html)中找到了 storeHtmlSource 方法描述，但无法弄清楚如何在我通过从 Selenium IDE 导出我的操作记录而生成的 python 代码中使用它。

我需要将当前页面的html源代码传入一个函数进行处理。怎么做？任何人都可以显示调用此方法的代码示例吗？可以从python调用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T15:29:53.107

我不能说 Python，但请查看[Selenium 接口](http://release.seleniumhq.org/selenium-remote-control/1.0-beta-2/doc/java/com/thoughtworks/selenium/Selenium.html)的 Java API 的 getHtmlSource 方法。它非常清楚地解释了它的作用。

# licensing - 软件许可保护共识？

> ID：522231
> 
> 赞同：0
> 
> 时间：2009-02-06T21:24:09.673
> 
> 标签：licensing

关于何时以及多久向许可证服务器检查许可证是否仍处于活动状态，是否有任何普遍接受的准则？

编辑：为澄清起见，我正在处理的软件将过期。至少每次启动应用程序时都需要进行检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T21:28:09.400

检查应该相对较快，因此大多数应用程序会在应用程序启动时进行，也可选择在日翻转时进行（对于长时间运行的应用程序）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T21:43:10.117

通常会谨慎地这样做。仅在安装或首次启动产品时说。任何更多的频率都取决于 BA 对海盗的偏执程度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-23T05:20:44.837

许可客户回拨的频率应可根据许可进行配置。这样做的原因是客户不同，您应该能够轻松地定制您的解决方案以适应。

在某些情况下，每次应用程序启动时都访问服务器可能没问题，但一些客户（例如大多数金融机构）可能更喜欢您*从不*打电话而只是验证许可证。

此外，您使用的许可 API 应提供足够的信息来了解检查失败是因为它看不到服务器，还是因为许可证无效、过期或用完（在多席位许可证的情况下）。

有几个原因：

1.  用户可能在笔记本电脑上安装了软件，而笔记本电脑并不总是连接到互联网。

2.  如果您的公司遇到许可证服务器停机，您不希望阻止现有的软件安装运行。

强制性免责声明和插件：我共同创立的公司生产[OffByZero Cobalt 许可解决方案](https://cobalt.offbyzero.com/)。有了它，您可以配置每个单独的许可证回家的频率，并创建从不回家的离线许可证。它还返回有关连接的详细信息，这意味着即使许可证服务器暂时不可用，您也可以允许您的应用程序运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-23T06:45:21.467

我使用 30 到 90 天的滑动窗口。并且应用程序会保存许可证服务器的结果，以便离线运行。如果保存的许可证因任何原因无效，则联系服务器并更新保存的许可证。

该应用程序还通知用户（不是用唠叨对话框，对话框是邪恶的！）当他们的许可证到期前不到 31 天时，他们的许可证将很快到期。这很重要，这样他们就不会在不知道他们的许可证到期的情况下被抓到。

至于效果如何，请在 9 个月后问我，我们的 12 个月许可证何时到期！

# sql - 在数据库术语方面需要帮助

> ID：522232
> 
> 赞同：2
> 
> 时间：2009-02-06T21:24:11.903
> 
> 标签：sql, terminology

如果一个表中的数据应该在另一个表中，它们之间的关系叫什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-06T21:25:57.623

这种关系被称为**健康，但功能失调**。

如果您想知道它的“术语”：

**去规范化**。

我说它是“健康的”，因为*有时*开发人员希望性能胜过理智。但就像任何关系一样，尽量不要让它成为常态。

编辑：是的，我在那里对关系提出了双关语。今天是星期五，我感觉很活泼。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-06T21:32:02.510

我认为 OP 可能含糊其辞地提出了他的问题，并且真的想问：“您将一个表中的条目引用另一个表中的一行的关系称为什么？” 那是一个外键约束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T21:26:36.860

非标准化垃圾？

Unnormalized 是一个从未被规范化过的数据库

非规范化是一次已规范化的数据库，但有人出于某种原因（可能是性能）决定对一些数据进行混洗

# validation - 是否存在参数验证可能被认为是多余的情况？

> ID：522238
> 
> 赞同：4
> 
> 时间：2009-02-06T21:25:57.750
> 
> 标签：validation, parameters

我在公共方法中做的第一件事是在每个参数有机会被使用、传递或引用之前验证它们，然后在它们中的任何一个违反合同时抛出异常。我发现这是一个非常好的做法，因为它可以让您在违规发生的那一刻抓住罪犯，但是，我经常编写一个非常简单的 getter/indexer，例如：

```
private List<Item> m_items = ...;

public Item GetItemByIdx( int idx )
{
    if( (idx < 0) || (idx >= m_items.Count) )
    {
        throw new ArgumentOutOfRangeException( "idx", "Invalid index" );
    }

    return m_items[ idx ];
} 
```

在这种情况下，索引参数直接与列表中的索引相关，并且我知道一个事实（例如文档），列表本身将完全一样并且会抛出相同的异常。我应该删除此验证还是最好不要管它？

我想知道你们的想法，因为我现在正在重构一个大项目，我发现了很多类似上面的案例。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T23:31:53.533

这不仅仅是口味问题，请考虑

```
if (!File.Exists(fileName)) throw new ArgumentException("...");            
var s = File.OpenText(fileName); 
```

`OpenText()`这看起来与您的示例相似，但即使出现 FileNotFound 错误，该方法仍可能失败的原因有多种（并发性、访问权限） 。所以存在检查只是给人一种安全和控制的虚假感觉。

这是一种思维定势，当您编写 GetItemByIdx 方法时，它可能看起来很明智。但是，如果您查看随机的一段代码，通常有很多假设您可以在继续之前检查。一遍又一遍地检查它们是不切实际的。我们必须有选择性。

因此，在像 GetItemByIdx 这样的简单传递方法中，我反对冗余检查。但是，一旦该函数添加了更多功能，或者如果有一个非常明确的规范说明了有关 idx 的某些内容，那么该参数就会转过来。

As a rule of thumb an exception should be thrown when a well defined condition is broken and that condition is relevant at the current level. If the condition belongs to a lower level, then let that level handle it.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T21:34:20.370

我只会在会导致代码行为有所改进的情况下进行参数验证。既然您知道，在这种情况下，检查将由 List 本身执行，那么您自己的检查是多余的并且没有提供额外的价值，所以我不会打扰。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T21:34:09.200

确实，您可能复制了已经在 API 中完成的工作，但它现在就在那里。如果您的错误处理框架有效且可靠，并且不会导致性能问题（[分析 IYF](http://www.codinghorror.com/blog/archives/001218.html)），那么我认为将其保留，并在您有时间的情况下逐步淘汰它。这听起来不像是首要任务！

# java - 使组件对 Swing 中的拖动不那么敏感

> ID：522244
> 
> 赞同：6
> 
> 时间：2009-02-06T21:27:55.017
> 
> 标签：java, swing, drag-and-drop

我的一个`JComponent`人太激烈地触发了一个`mouseDragged`事件。当用户尝试单击时，即使鼠标仅移动了 1 个像素，它也会将其解释为拖动。

我将如何为特定组件添加一条规则，该规则相当于：

> 不要将其视为拖动事件，除非鼠标已从按下的点移动了 10 个像素。

注意：我知道这不是我操作系统中的系统设置，因为只有该组件上的事件才会受到这种过度敏感的影响。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-25T11:19:27.103

以前的答案结合在一起，并带有适当的事件类型：

```
public class DragInsensitiveMouseClickListener implements MouseInputListener {

    protected static final int MAX_CLICK_DISTANCE = 15;

    private final MouseInputListener target;

    public MouseEvent pressed;

    public DragInsensitiveMouseClickListener(MouseInputListener target) {
        this.target = target;
    }

    @Override
    public final void mousePressed(MouseEvent e) {
        pressed = e;
        target.mousePressed(e);
    }

    private int getDragDistance(MouseEvent e) {
        int distance = 0;
        distance += Math.abs(pressed.getXOnScreen() - e.getXOnScreen());
        distance += Math.abs(pressed.getYOnScreen() - e.getYOnScreen());
        return distance;
    }

    @Override
    public final void mouseReleased(MouseEvent e) {
        target.mouseReleased(e);

        if (pressed != null) {
            if (getDragDistance(e) < MAX_CLICK_DISTANCE) {
                MouseEvent clickEvent = new MouseEvent((Component) pressed.getSource(),
                        MouseEvent.MOUSE_CLICKED, e.getWhen(), pressed.getModifiers(),
                        pressed.getX(), pressed.getY(), pressed.getXOnScreen(), pressed.getYOnScreen(),
                        pressed.getClickCount(), pressed.isPopupTrigger(), pressed.getButton());
                target.mouseClicked(clickEvent);
            }
            pressed = null;
        }
    }

    @Override
    public void mouseClicked(MouseEvent e) {
        //do nothing, handled by pressed/released handlers
    }

    @Override
    public void mouseEntered(MouseEvent e) {
        target.mouseEntered(e);
    }

    @Override
    public void mouseExited(MouseEvent e) {
        target.mouseExited(e);
    }

    @Override
    public void mouseDragged(MouseEvent e) {
        if (pressed != null) {
            if (getDragDistance(e) < MAX_CLICK_DISTANCE) return; //do not trigger drag yet (distance is in "click" perimeter
            pressed = null;
        }
        target.mouseDragged(e);
    }

    @Override
    public void mouseMoved(MouseEvent e) {
        target.mouseMoved(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-08T07:51:51.120

我以前必须这样做。这是我的鼠标事件处理代码，减少到与使拖动相关的位，在被视为拖动之前需要几个像素。

```
public void mousePressed(int mod, Point loc) {
    pressLocation=copyLocation(loc,pressLocation);
    dragLocation=null;
    }

public void mouseReleased(int mod, Point loc) {
    if(pressLocation!=null && dragLocation!=null) {
        // Mouse drag reverted to mouse click - not dragged far enough
        // action for click
        pressLocation=null;
        }
    else if(dragLocation!=null) {
        // action for drag completed
        }
    else {
        // do nothing
        }

    pressLocation=null;
    dragLocation=null;
    }

public void mouseDragged(int mod, Point loc) {
    if(pressLocation!=null) {                                                   // initial drag actions following mouse press
        dragLocation=pressLocation;                                             // consider dragging to be from start point
        if(Math.abs(loc.x-pressLocation.x)<dragMinimum && Math.abs(loc.y-pressLocation.y)<dragMinimum) {
            return;                                                             // not dragged far enough to count as drag (yet)
            }
        // action drag from press location
        pressLocation=null;
        }
    else {
        // action drag from last drag location
        dragLocation=copyLocation(loc,dragLocation);
        }
    } 
```

请注意，我也遇到了一些~~JVM~~在拖动后生成点击事件的问题，我必须检测和抑制这些事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T21:43:48.463

如果我正确阅读了您的问题，则您正在跟踪单击和鼠标拖动事件。您可以在 mousedown 时跟踪坐标，然后在 mousedrag 中进行简短计算以查看鼠标是否已移动所需的最小像素数？当然，您还希望在 mouseup 或鼠标被拖动到 JComponent 边界之外时取消/重置。

警告：我自己没有这样做，但我认为如果是我，我会从这里开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-24T13:58:13.603

Software Monkey 的代码似乎缺少一些代码，所以我写了这个解决方案：

```
navigationTree.addMouseListener(new DragInsensitiveMouseClickListener(10) {
    @Override
    public void mouseClicked(MouseEvent e) {
        TreePath treePath = navigationTree.getPathForLocation(e.getX(), e.getY());

        if(treePath != null) {
            processChoice();
        }
    }
}); 
```

当用户产生最多 10 个像素的“拖动行程”时，这仍会触发 mouseClicked() 事件。

点击监听的代码：

```
import java.awt.Point;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

public class DragInsensitiveMouseClickListener extends MouseAdapter {

    private final int allowedTravel;

    public Point mouseDownPoint;

    public DragInsensitiveMouseClickListener(int allowedTravel) {
        this.allowedTravel = allowedTravel;
    }

    @Override
    public void mousePressed(MouseEvent e) {
        mouseDownPoint = e.getPoint();
    }

    @Override
    public void mouseReleased(MouseEvent e) {
        double horizontalTravel = Math.abs(mouseDownPoint.getX() - e.getX());
        double verticalTravel = Math.abs(mouseDownPoint.getY() - e.getY());

        if (horizontalTravel < allowedTravel && verticalTravel < allowedTravel) {
            mouseClicked(e);
        }
    }
} 
```

# random - 如何量化伪随机数生成器的质量？

> ID：522250
> 
> 赞同：5
> 
> 时间：2009-02-06T21:28:24.983
> 
> 标签：random, quantify

这是基于[这个问题](https://stackoverflow.com/questions/137783/)。提出了许多产生不均匀分布的答案，我开始想知道如何量化输出的不均匀性。我不是在寻找模式问题，只是在寻找单值方面。

接受的程序是什么？

* * *

我目前的想法是通过计算每个值的熵并取加权平均值来计算每次调用的平均[香农熵。](http://en.wikipedia.org/wiki/Information_entropy)然后可以将其计算为预期值。

我的担忧是

1.  这个对吗？
2.  如何在不损失精度的情况下计算这些值？

对于＃1，我想知道我是否正确。

对于#2，我担心的是我会处理大小为 1/7 +/- 1e-18 的数字，我担心浮点错误会因为除最小问题之外的任何问题而杀死我。计算的确切形式在这里可能会导致一些重大差异，我似乎记得对于一些特殊的日志案例有一些 ASM 选项，但我似乎找不到关于此的文档。

* * *

在这种情况下，使用为 range 获取一个“好”的 PRNG 并为 range`[1,n]`生成一个 SRNG `[1,m]`。问题是结果比输入差多少？

我所拥有的是每个输出值的预期发生率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T21:40:34.477

NIST 有一组文档和工具，用于统计分析跨各种指标的随机数生成器。

[http://csrc.nist.gov/groups/ST/toolkit/rng/index.html](http://csrc.nist.gov/groups/ST/toolkit/rng/index.html)

其中许多测试也包含在 Dieharder PRNG 测试套件中。

[http://www.phy.duke.edu/~rgb/General/rand_rate.php](http://www.phy.duke.edu/~rgb/General/rand_rate.php)

有很多不同的指标，因为有很多很多不同的方式来使用 PRNG。您不能在真空中分析 PRNG - 您必须了解用例。这些工具和文档提供了大量信息来帮助您，但最终您仍然必须了解您实际需要什么，然后才能确定算法是否合适。NIST 文档是详尽的，即使有些密集。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T21:48:14.630

[本页](http://www.math.utah.edu/~pa/Random/Random.html)讨论了一种检查是否得到错误分布的方法：在字段中绘制伪随机值，然后只查看它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-04T16:12:54.390

TestU01 的测试集比 Dieharder 更严格。最大的测试集称为“BigCrush”，但执行时间较长，因此也有仅称为“Crush”和“SmallCrush”的子集。这个想法是首先尝试 SmallCrush，如果 PRNG 通过了，就尝试 Crush，如果通过了，就尝试 BigCrush。如果它也通过了，它应该足够好。

[你可以在这里](http://www.iro.umontreal.ca/~simardr/testu01/tu01.html)得到 TestU01 。

# datetime - ISO 8601 和 RFC 3339 日期格式有什么区别？

> ID：522251
> 
> 赞同：389
> 
> 时间：2009-02-06T21:28:43.627
> 
> 标签：datetime, format, web-standards

[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)和[RFC 3339](https://www.rfc-editor.org/rfc/rfc3339)似乎是网络上常见的两种格式。我应该使用其中一个吗？一个只是扩展吗？我真的需要关心那么糟糕吗？

* * *

## 回答 #1

> 赞同：311
> 
> 时间：2009-02-06T21:37:04.437

> 一个只是扩展吗？

差不多，是的 - RFC 3339 被列为 ISO 8601 的配置文件。最值得注意的是 RFC 3339 指定了日期和时间的*完整表示*（只有小数秒是可选的）。RFC 也有一些细微的差别。例如，不允许截断只有两位数字的年份表示 - RFC 3339 要求 4 位年份，而 RFC 仅允许将句点字符用作小数秒的小数点。RFC 还允许将“T”替换为空格（或其他字符），而标准只允许省略它（并且仅在使用该表示的各方之间达成一致时）。

我不会太担心两者之间的差异，但是如果您的用例遇到它们的可能性不大，那么值得您看一眼：

*   [RFC 3339](https://www.rfc-editor.org/rfc/rfc3339)
*   [ISO 8601 上的维基百科条目](http://en.wikipedia.org/wiki/ISO_8601)

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2020-12-09T16:47:38.923

ISO 8601 和 RFC 3339 之间有很多不同之处。这里有一些示例可以让您了解：

`2020-12-09T16:09:53+00:00`是符合这两个标准的日期时间值。

`2020-12-09 16:09:53+00:00`使用空格分隔日期和时间。这是 RFC 3339 允许的，但 ISO 8601 不允许。

`2020-12-09T16:09:53-00:00`在时间偏移中指定负零。这是 RFC 3339 允许的，但 ISO 8601 不允许。

`20201209T160953Z`省略连字符和冒号。这在 ISO 8601 中是允许的，但在 RFC 3339 中是不允许的。

ISO 8601 允许诸如`2020-344`表示 2020 年第 344 天的序数日期之类的事情。RFC 3339 不允许这样做。

对于您的问题：

> 一个只是扩展吗？

不。如上所示，每个标准都支持其他标准不支持的语法变体。因此，一种语法不是另一种语法的超集或扩展。

> 我应该使用其中一个吗？

当然，这取决于您的情况。一个安全的通用策略是生成对两种标准都有效的日期时间字符串。

另一个好的通用策略是使用现有的标准库来解析/格式化日期时间字符串，而不是编写自定义实现，除非您正在处理真正自定义的场景。

> 我真的需要关心那么糟糕吗？

好吧，这取决于你。大多数处理日期时间字符串的常规开发人员应该有较高的理解，但不需要深入细节。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-03-11T12:59:08.407

RFC 3339 主要是 ISO 8601 的配置文件，但实际上与从 RFC 2822 借用“-00:00”时区规范不一致。这在 Wikipedia 文章中有所描述。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-04-02T14:33:14.543

实际访问 ISO 规范似乎很困难和/或昂贵。这就是为什么我们会看到许多指向维基百科页面的链接。

仅出于这个原因，我更喜欢 RFC3339：您可以直接访问主要来源。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T21:32:26.113

你不应该那么在意。就其本身而言，RFC 3339 是一组源自 ISO 8601 的标准。尽管存在相当多的细微差别，它们都在 RFC 3339 中进行了概述。我可以在这里全部介绍，但您可能会做得更好如果您担心，请自行阅读文档：

[https://www.rfc-editor.org/rfc/rfc3339](https://www.rfc-editor.org/rfc/rfc3339)

# java - 检查是否所有枚举值都已映射？

> ID：522260
> 
> 赞同：2
> 
> 时间：2009-02-06T21:30:43.107
> 
> 标签：java, enums

java标准库中是否有可用的便捷方法来检查 EnumMap 中所有可能的键是否都映射到一个值？

我可以编写自己的方法，例如：

```
public static <T extends Enum<T>> boolean areAllValuesMapped(EnumMap<T, ?> map, Class<T> enumClass)
{
    return map.keySet().equals(EnumSet.allOf(enumClass));
} 
```

但随后我重复 Class 参数（已在 EnumMap 构造函数中给出）以及创建一次性 KeySet 和 EnumSet 对象。EnumMap 应该有足够的信息作为内部操作有效地执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T21:58:49.337

没有内置的方法可以做到这一点，我可以找到`EnumMap`（我检查了源代码以确定）。但是，这里有一个稍微快一点的方法：

```
public static <T extends Enum<T>> boolean areAllValuesMapped(EnumMap<T,?> map, Class<T> enumClass) {
    return map.size() == enumClass.getEnumConstants().length;
} 
```

我应该注意`EnumMap.keySet()`不返回`EnumSet`; 如果是这样，`equals()`您使用的调用将是一个简单的比较问题`longs`。事实上，它必须使用迭代器并按顺序检查每个枚举常量。

# bash - 在 Shell 中搜索和替换

> ID：522261
> 
> 赞同：1
> 
> 时间：2009-02-06T21:30:50.593
> 
> 标签：bash, shell, sed, awk, textutils

我正在编写一个 shell (bash) 脚本，并试图找出一种简单的方法来完成一项简单的任务。

我在变量中有一些字符串。我不知道这是否相关，但它可以包含空格、换行符，因为实际上这个字符串是整个文本文件的内容。

我想用其他东西替换某个子字符串的最后一次出现。也许我可以为此使用正则表达式，但有两个时刻让我感到困惑：

*   我需要从头开始匹配，而不是从头开始
*   我要扫描的子字符串是固定的，而不是可变的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T21:36:44.280

*   在开始时截断：`${var#pattern}`
*   最后截断`${var%pattern}`
*   `${var/pattern/repl}`一般更换

模式是“文件名”样式扩展，最后一个可以在开头或结尾添加`#`或匹配前缀（分别）`%`

这一切都在（长）bash 手册页中。检查“参数扩展”一章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T21:36:06.747

像这样的表达

```
s/match string here$/new string/ 
```

应该做的伎俩 - s 用于替代， / 分解命令，$ 是行尾标记。您可以在 vi 中尝试此操作，看看它是否满足您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T21:32:30.747

我会查找 awk 或 sed 的手册页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T09:06:00.113

Javier 的答案是特定于 shell 的，不适用于所有 shell。

MrTelly 和 epochwolf 提到的 sed 答案不完整，应该如下所示：

```
MyString="stuff ttto be edittted"
NewString=`echo $MyString | sed -e 's/\(.*\)ttt\(.*\)/\1xxx\2/'` 
```

无需使用 $ 来标记结尾即可工作的原因是第一个 '.*' 是贪婪的，并且会尝试尽可能多地收集，同时允许正则表达式的其余部分为真。

这个 sed 命令应该在任何使用的 shell 上下文中都能正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T10:51:32.413

通常当我被 Sed 卡住时，我会使用这个页面，

[http://sed.sourceforge.net/sed1line.txt](http://sed.sourceforge.net/sed1line.txt)

# asp.net - 验证网站是否正常运行的最佳方法是什么

> ID：522269
> 
> 赞同：0
> 
> 时间：2009-02-06T21:33:57.750
> 
> 标签：asp.net

我正在考虑在 asp.net 的服务器端添加一些代码，以在重定向到它之前验证网站是否正常工作。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T21:47:27.393

你可以这样做：

```
System.Net.HttpWebRequest request = (System.Net.HttpWebRequest)System.Net.HttpWebRequest.Create(serverUrl);
System.Net.HttpWebResponse response = (System.Net.HttpWebResponse)request.GetResponse();

if (response.StatusCode == System.Net.HttpStatusCode.OK)
{
    response.Close();
    return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T21:37:40.473

这样做有什么特别的原因吗？如果有商业原因，那么您可能别无选择。

一般来说，这是一个坏主意。互联网的全部意义在于它是断开连接的。没有“保证交付”。

话虽如此，您可以在加载页面时使用“WebRequest 和 WebResponse”类调用另一个站点。请注意，如果其他站点关闭，此请求将挂起直到超时。您的用户将遇到此超时，因为您的页面无法加载，直到对其他页面的 WebRequest 超时。如果这没有仔细实施，其他站点正在关闭可能会使您的站点看起来也已关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T21:41:49.293

您可以新建一个 HttpWebRequest 并发送一个 HTTP“GET”，并确保返回的状态代码为 200。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T21:42:02.537

非常幼稚，也不是特别快，但是一个开始：

```
if ( new System.Net.WebClient().DownloadString(" url here ").Length > 0 )
{
   // ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T01:25:24.210

您应该在应用程序启动时启动一个线程，该线程会定期检查站点的可用性。保留一个 Hashtable/Dictionary/whatver 与这方面的信息，并在需要时进行查询。

如果你们中的任何人需要有关如何对我的回答发表评论的具体细节。

# c++ - 在 MSVC++ 中检查字节码时遇到问题

> ID：522278
> 
> 赞同：2
> 
> 时间：2009-02-06T21:36:07.480
> 
> 标签：c++, visual-c++, bytecode, x86

我在工作中一直在使用免费的 Digital Mars 编译器（我知道很淘气），并创建了一些代码来检查编译的函数并查看字节码以用于学习目的，看看我是否可以从编译器的构建方式中学到任何有价值的东西它的功能。但是，在 MSVC++ 中重新创建相同的方法失败得很惨，我得到的结果非常混乱。我有这样的功能：

```
unsigned int __stdcall test()
{
  return 42;
} 
```

然后我做：

```
unsigned char* testCode = (unsigned char*)test; 
```

在这种情况下，我似乎无法让 C++ static_cast 工作（它会引发编译器错误）......因此是 C 风格的强制转换，但这不是重点......我也尝试过使用参考 &test，但这无济于事。

现在，当我检查 testCode 指向的内存内容时，我感到很困惑，因为我看到的甚至看起来都不像有效代码，甚至还有一个调试断点卡在那里......它看起来像这样（目标是 IA -32):

0xe9, 0xbc, 0x18, 0x00, 0x00, 0xcc...

这显然是错误的，0xe9 是相对跳转指令，从 0xbc 字节外看是这样的：

0xcc，0xcc，0xcc……

即按照未分配或未使用内存的预期，内存初始化为调试断点操作码。

我对返回 42 的函数的期望是：

0x8b、0x2a、0x00、0x00、0x00、0xc3

或者至少一些 mov 的味道，然后是 ret （0xc2、0xc3、0xca 或 0xcb）再往下一点

MSVC++ 是出于安全原因采取措施阻止我做这种事情，还是我做了一些愚蠢的事情而没有意识到？使用 DMC 作为编译器，此方法似乎可以正常工作...

我也很难以另一种方式（执行字节），但我怀疑根本原因是相同的。

任何帮助或提示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T22:25:49.453

我只能猜测，但我很确定您正在检查调试版本。在调试模式下，MSVC++ 编译器将所有调用替换为对跳转存根的调用。这意味着，每个函数都从跳转到真正的函数开始，这正是您在这里所面临的。
周围的 0xCC 字节确实是断点指令，以便在您执行不应该执行的代码时触发可能附加的调试器。
在发布版本中尝试相同的操作。这应该按预期工作。

**编辑：** 这实际上受链接器设置 /INCREMENTAL 的影响。您所描述的效果没有出现在发布版本中的原因是，如果打开了任何类型的优化，这些跳转存根就会被简单地优化掉（这当然通常是发布版本的情况）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T22:38:48.507

对于您想要的演员表：

```
unsigned char* testCode = reinterpret_cast<unsigned char*>( test ); 
```

在项目 -> 属性 -> C/C++ -> 常规中将调试信息格式从“用于编辑和继续的程序数据库 (/ZI)”切换为“程序数据库 (/Zi)”。我相信正是这种设置导致编译器插入跳转代码，以便调试器可以在程序运行时重建函数并对其进行热补丁。也可能关闭“启用最小重建”。

在 MSVC 中检查代码的一种更简单的方法是简单地设置一个断点并检查反汇编（右键单击该行并从弹出菜单中选择“转到反汇编”。它使用源代码注释反汇编，以便您可以看到每一行编译成什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T21:43:30.943

如果您想查看给定编译函数的程序集和机器代码，向编译器提供 /FAcs 命令行选项并查看随后的 .asm 文件会更容易。

我不确定将函数指针转换为字节流的定义行为是什么——它甚至可能无法正常工作——但另一个可能造成混淆的原因是 x86 函数都是可变大小的，而且也是 little-endian .

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T22:09:44.137

如果这是在打开增量链接的情况下，那么您看到的是`jmp [destination]`. 您可以运行调试器并查看反汇编要验证的内容。

# c# - 如何在结构构造函数中设置自动属性支持字段的值？

> ID：522280
> 
> 赞同：20
> 
> 时间：2009-02-06T21:36:44.467
> 
> 标签：c#, constructor, struct, backing-field

给定这样的结构：

```
public struct SomeStruct
{
    public SomeStruct(String stringProperty, Int32 intProperty)
    {
        this.StringProperty = stringProperty;
        this.IntProperty = intProperty;
    }

    public String StringProperty { get; set; }
    public Int32 IntProperty { get; set; }
} 
```

当然，会生成一个编译器错误，读取**The 'this' object cannot be used before its all fields are assigned to**。

有没有办法为支持字段或属性本身分配值，或者我是否必须使用我自己的显式支持字段以老式方式实现属性？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-06T21:38:07.117

在 C# 6 之前，您需要在这种情况下使用“this”构造函数：

```
public SomeStruct(String stringProperty, Int32 intProperty) : this()
{
    this.StringProperty = stringProperty;
    this.IntProperty = intProperty;
} 
```

这样做会调用默认构造函数，并通过这样做初始化所有字段，从而允许`this`在自定义构造函数中引用。

* * *

编辑：直到 C# 6，这才开始合法；然而，这些天它会更好`readonly struct`：

```
public readonly struct SomeStruct
{
    public SomeStruct(string stringProperty, int intProperty)
    {
        this.StringProperty = stringProperty;
        this.IntProperty = intProperty;
    }

    public string StringProperty { get; }
    public int IntProperty { get; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T04:31:04.023

如果一个结构将具有并且其用户期望它具有以下所有三个特征：

1.  它的整个状态被封装在一些特定的固定可读成员集中
2.  可以很容易地创建一个实例，其中这些成员具有对其各自类型有效的值的任意组合。
3.  该类型的默认实例应将所有这些成员设置为其各自类型的默认值。

该类型应将其成员公开为字段。上述要求意味着一个结构将不能做任何暴露字段结构不能做的事情，也意味着如果代码没有遇到任何线程危险，那么结构将能够做任何暴露字段struct 可以做，尽管可能更慢并且有更多的线程危险。

如果一个结构`Foo`有字段`f1`and `f2`，以及一个按该顺序设置这些字段的构造函数，并且 if`fooExpr`是某种类型的表达式`Foo`[可能是变量、字段、数组引用、属性或其他]，则语句：

```
myFoo.f2 = someValue; 
```

只有在可以合法说的情况下才允许

```
myFoo = new Foo(myFoo.f1, someValue); 
```

并且在允许第一种形式并且第二种形式的行为已定义语义的所有情况下，它们的行为将相同。因此，试图“封装” 的属性`Foo`并不能真正完成任何事情，只会使代码编写起来更麻烦、不太清晰、执行起来更慢。

# hibernate - 在会话中存储 Grails/GORM 域对象 - 为什么不呢？

> ID：522295
> 
> 赞同：4
> 
> 时间：2009-02-06T21:39:40.343
> 
> 标签：hibernate, grails, grails-orm

我正在学习 Grails/GORM，据我了解，当前的最佳做法是不在会话中存储域对象（有关潜在修复，请参阅[http://jira.codehaus.org/browse/GRAILS-978 ）。](http://jira.codehaus.org/browse/GRAILS-978)

解决方法很简单；只需将域对象的引用 id 存储在会话中，然后在下一个请求中使用重新检索对象。

我的问题是：为什么域对象不能安全地存储在会话中？我试图了解它背后的技术细节。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-06T22:44:31.303

我对此的担忧之一是 GORM（我会说 Hibernate）对每个请求都使用 open-session-in-view 模式，其中工作的 Hibernate 的会话将在结束时关闭并刷新。

在 HTTP 会话中存储 GORM 对象意味着将对象从先前的 Hibernate 会话中分离出来，并将其重新附加到新创建的会话中。这可能会导致对象的两个版本之间发生冲突。

# wcf - 如何在不同的服务中重用复杂类型？

> ID：522303
> 
> 赞同：2
> 
> 时间：2009-02-06T21:41:19.340
> 
> 标签：wcf, wcf-binding

我有 2 个单独的 java 服务，它们使用一个完全相同的复杂类型，但将电子邮件对象作为参数，例如：

```
class Email{
     Description{get;}
     Address{get;}
} 
```

服务看起来像这样：

emailBasketBallTeam（电子邮件）；电子邮件网球队（电子邮件）；

有没有一种方法可以为电子邮件对象指定合同，或者以某种方式在不同的服务中重用电子邮件对象，尽管它们位于完全不同的命名空间中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T21:43:48.807

与 不同`wsdl /sharetypes`的是，您一次需要使用一项服务，但您可以重用现有程序集中的类型。

使用`svcutil`，您可以使用 /reference 开关。我相信你也可以在设计器的IDE中做到这一点。

# c# - 如何设置网络连接以在 Windows Mobile 设备上使用 AES 加密方法？

> ID：522313
> 
> 赞同：1
> 
> 时间：2009-02-06T21:43:30.180
> 
> 标签：c#, .net, xml, configurationmanager

我正在尝试使用 ConfigurationManager.ProcessConfiguration 配置网络连接，并使用 MSDN [docs](http://msdn.microsoft.com/en-us/bb737539.aspx)中指定的配置文件。我可以创建连接，并正确配置除加密类型之外的所有设置。无论我选择什么，它总是设置为 TKIP。我需要将其设置为 AES，这是设备上此属性的下拉菜单中唯一的其他选项。

我发送的 xml 如下所示（OMA 设备配置格式）：

```
<wap-provisioningdoc>
  <characteristic type="Wi-Fi">
    <characteristic type="access-point">
      <characteristic type="Name">
        <parm name="Authentication" value="4" />
        <parm name="Encryption" value="5" >
        <parm name="Hidden" value="1" />
      </characteristic>
    </characteristic>
  </characteristic>
</wap-provisioningdoc> 
```

我已经为“加密”参数尝试了 0-5 的值，但这些都没有任何效果。

有任何想法吗？

谢谢，P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T17:38:11.457

解决方案是对 Encryption 参数使用*未记录*的AES 值。

```
<parm name="Encryption" value="6" > 
```

# performance - 在保持元素/样式/脚本关系的同时缩小整个目录？

> ID：522315
> 
> 赞同：14
> 
> 时间：2009-02-06T21:43:31.240
> 
> 标签：performance, minify, page-load-time

当前是否存在可以缩小整个项目目录的解决方案？更重要的是，是否存在任何可以缩短类名、id 并在所有文档中保持一致的解决方案？

**可以改变这个的东西：**

索引.html ---

```
<div class="fooBar">
  <!-- Code -->
</div> 
```

样式.css ---

```
.fooBar { 
  // Comments and Messages
  background-color: #000000; 
} 
```

索引.js ---

```
$(".fooBar").click( function () { 
  /* More Comments */
  alert( "fooBar" ); 
}); 
```

**进入这个：**

索引.html ---

```
<div class="a"></div> 
```

样式.css ---

```
.a{background-color:#000;} 
```

索引.js ---

```
$(".a").click(function(){alert("fooBar");}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T22:55:24.980

您正在寻找的不是缩小，而是压缩。根据定义缩小*只会*删除空格，因为缩短标识符会改变接口，可能会破坏依赖它的外部脚本。出于这个原因，缩小本质上比压缩“更安全”，尽管在封闭系统（即封装的 Web 应用程序）中，压缩可能是一个好主意。

**对于 Javascript**，大多数人使用[YUI Compressor](http://developer.yahoo.com/yui/compressor/)或[Dean Edwards 的 Packer](http://dean.edwards.name/packer/)。

**对于 CSS**，有很多工具可以“优化”样式，但我也不知道有什么工具可以缩短类名。造成这种情况的原因可能有几个：

1.  要压缩 CSS 文件，脚本需要知道包含它的所有 HTML 文件，以便更改其中的类和 id 引用。根据您网站的大小和结构，他可能会很重要。
2.  压缩后，语义 HTML 变得不那么可读，`<span class="image_caption">`变成`<span class="a12">`，或者更糟的是，`<p id="a12">`.

绝对有可能做你所描述的事情（我实际上正在开发一个个人 CMS/框架），但为了使其*可*维护，它可能必须是结构紧密的 CMS 的一个集成部分，每当发布新的更改时，都会在“幕后”压缩所有文件，同时保留所有原始文件，以便可以将站点作为一个整体进行维护。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T19:01:45.333

我使用[http://www.w3compiler.com/](http://www.w3compiler.com/)进行压缩和混淆

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T19:49:22.050

我使用[YUICompressor](http://developer.yahoo.com/yui/compressor/)来缩小我的 css 和 js 文件，并使用一个名为[replace](http://www.bestcode.com/html/findreplace.html)的程序来自定义替换 html 中的字符串（删除注释，用 google api 替换本地 jquery 库等）

使用批处理文件在项目目录中具有特定扩展名的所有文件上调用程序，如下所示：

```
java -jar yuicompressor-2.4.2.jar -o temp\css\one-compressed.css temp\css\one.css
replace -quotes \q -srcdir temp\ -fname "*.php" -find "<script type=\qtext/javascript\q src=\qjs/jquery.js\q></script>" -replace "<script src=\qhttp://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js\q type=\qtext/javascript\q></script>" 
```

等等。

到目前为止，我还没有找到任何好的混淆工具。但是仅这两者就可以使缩小和压缩任务自动化并且变得更加容易。

# c# - 如何在安装结束时运行 nGen (MSI)？

> ID：522323
> 
> 赞同：11
> 
> 时间：2009-02-06T21:45:35.713
> 
> 标签：c#, optimization, windows-installer, ngen

我想在安装结束时执行 nGen，只是为了提高我的应用程序首次启动时的感知性能。我怎么能那样做？有一些最佳实践吗？我可以确定 nGen 始终与 .NET Framework 一起安装吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T16:49:50.233

您可以使用自定义安装程序操作来生成您的程序集。以下链接更详细地解释了这一点：

[http://www.dotnetperls.com/ngen](http://www.dotnetperls.com/ngen)

我还记得关于 Paint.NET 安装程序（包括 .NET Framework 引导、预 JITting 等）的一个很好的讨论，但我现在找不到它。如果我再次遇到它，我会编辑这篇文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T21:57:10.743

首先“是”，您可以保证，如果他们安装了 .Net 框架，他们就拥有 Ngen。您唯一需要知道的是他们安装了哪个版本，因为它在 1.1 和 2.0 之间是不同的。我过去所做的只是创建了一个我的安装程序在最后调用的脚本，它在所有程序集上运行 ngen。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T01:34:56.857

要提高启动时的感知性能，请查看应用程序中的静态。启动应用程序时，大量静态因素会导致大量开销。

此外，请考虑在 EXE 中仅包含主窗体，而在单独的 DLL 中包含其他所有内容。这不仅提高了性能，而且有助于保证您将视图与数据分开。

最后，如果您设置了 NGENing，请查看有关在您的 MSI 中运行自定义操作的帮助。您应该能够设置自定义操作来执行您想要的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-17T09:37:36.510

正如“Micah”所说，**是**的，您会发现 NGen 与 .Net Framework 一起安装。

查看 WiX 3.5 安装程序示例如何在安装期间对您的程序集进行 NGen。

**[NGen：创建设置项目](http://blogs.msdn.com/b/clrcodegeneration/archive/2010/04/27/ngen-creating-setup-projects.aspx)**

我希望这能帮到您。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-07T02:52:05.217

[发射`ngen.exe`](http://msdn.microsoft.com/en-us/library/6t9t5wcf%28VS.80%29.aspx)：

```
>ngen install c:\myfiles\MyAssembly.exe 
```

# emacs - Textmate：如何输入重复的字符序列？

> ID：522326
> 
> 赞同：6
> 
> 时间：2009-02-06T21:47:10.907
> 
> 标签：emacs, textmate

我经常需要像这样输入文本（由重复的字符组成）：

```
------------------------------------
 TODO
------------------------------------ 
```

在emacs中，我可以做一个

```
C-u 60 - 
```

即 Ctrl+U 后跟“60”后跟“-”，这样可以轻松输入重复的字符序列。

有没有办法在 TextMate 中做这样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-07T02:06:49.213

对于您给出的具体示例，您可以键入 Ctrl-Shift-B、“TODO”来创建文本横幅。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-14T02:37:42.967

在 TextMate 中，打开 Bundle Editor 并选择您希望使用的语言。（如果您希望在所有语言中都拥有此功能，请使用 Source bundle）单击左下角的加号，然后选择“新命令。” 为保存字段选择“Nothing”，为两个输入字段选择“Selected Text or Line”。然后将其粘贴到命令字段中：

```
#!/usr/bin/python
import sys
commandLine = raw_input("")
tmArgs = commandLine.split()
numberOfArgs = len(tmArgs)
for i in range(eval(tmArgs[0])):
    for j in range(1, numberOfArgs):
        sys.stdout.write(tmArgs[j]) 
```

然后，您可以在“激活”字段中选择一个键盘快捷键来激活它。它的工作方式与 emacs 命令非常相似：键入您想要的字符数，然后输入字符。然后选择它们（如果它们是该行中唯一的文本，则无需此步骤）并按快捷键。我的脚本允许您指定要打印的多个字符，由空格分隔。所以如果你输入

```
10 - = 
```

并点击快捷键，你会得到

```
-=-=-=-=-=-=-=-=-=-= 
```

**编辑**：在考虑之后......这是另一个版本。这将在数​​字之后打印字符串。所以例如

```
6 -= (space) 
```

印刷

```
-= -= -= -= -= -= 
```

这是那个版本：

```
#!/usr/bin/python
import sys
import string
commandLine = raw_input("")
timesToPrint = eval(commandLine.split()[0])
firstSpace = string.find(commandLine, " ")
for i in range(timesToPrint):
        sys.stdout.write(commandLine[firstSpace + 1:]) 
```

# unit-testing - 使用单元测试进行实际重构

> ID：522334
> 
> 赞同：11
> 
> 时间：2009-02-06T21:50:46.967
> 
> 标签：unit-testing, refactoring, legacy-code

[刚刚阅读了《重构：改进现有代码的设计》](https://rads.stackoverflow.com/amzn/click/com/0201485672)的前四章，我开始了我的第一次重构，但几乎立刻就遇到了障碍。它源于这样的要求，即在开始重构之前，您应该围绕遗留代码进行单元测试。这使您可以确保您的重构没有改变原始代码所做的事情（只是它是*如何*做的）。

所以我的第一个问题是：如何在遗留代码中对方法进行单元测试？如何围绕不只执行一项任务的 500 行（如果我幸运的话）方法进行单元测试？在我看来，我必须重构我的遗留代码才能使其可单元测试。

有没有人有使用单元测试重构的经验？如果是这样，你有什么实际的例子可以和我分享吗？

我的第二个问题有点难以解释。这是一个示例：我想重构一个从数据库记录中填充对象的遗留方法。难道我不需要编写一个单元测试来比较使用旧方法检索到的对象和使用重构方法检索到的对象吗？否则，我怎么知道我的重构方法会产生与旧方法相同的结果？如果这是真的，那么我要在源代码中保留旧的弃用方法多长时间？在我测试了几条不同的记录之后，我会直接敲它吗？或者，如果我在重构的代码中遇到错误，我是否需要保留一段时间？

最后，由于有几个人问过......遗留代码最初是用 VB6 编写的，然后移植到 VB.NET 中，架构更改最少。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-06T22:22:40.880

有关如何重构遗留代码的说明，您可能需要阅读《[有效地使用遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)一书。[这里](http://www.objectmentor.com/resources/articles/WorkingEffectivelyWithLegacyCode.pdf)还有一个简短的 PDF 版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T22:08:21.300

理论与现实相结合的好例子。单元测试旨在测试单个操作，许多模式纯粹主义者坚持[Single Responsibilty](http://en.wikipedia.org/wiki/Single_responsibility_principle)，因此我们有可爱的干净代码和与之配套的测试。然而，在真实（混乱）的世界中，代码（尤其是遗留代码）做了很多事情并且没有测试。这需要进行重构以清理混乱。

我的方法是使用单元测试工具构建测试，在一个测试中测试很多东西。在一项测试中，我可能正在检查数据库连接是否打开，更改大量数据，并对数据库进行前后检查。我不可避免地会发现自己编写辅助类来进行检查，并且通常可以将这些辅助类添加到代码库中，因为它们封装了紧急行为/逻辑/需求。我并不是说我有一个巨大的测试，我的意思是mnay测试正在做一个纯粹主义者称之为集成测试的工作——这样的事情还存在吗？我还发现创建一个测试模板然后从中创建许多测试以检查边界条件、复杂处理等很有用。

顺便说一句，我们在谈论哪种语言环境？有些语言比其他语言更适合重构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T22:00:29.990

根据我的经验，我不会为遗留代码中的特定方法编写测试，而是为它提供的整体功能编写测试。这些可能会或可能不会与现有方法紧密映射。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T22:08:57.587

在系统的任何级别编写测试（如果可以的话），如果这意味着运行数据库等，那就这样吧。您将需要编写更多代码来断言代码当前正在做什么，因为 500 行以上的方法可能会包含很多行为。至于比较新旧代码，如果您针对旧代码编写测试，它们就会通过并且涵盖了它所做的一切，那么当您针对新代码运行它们时，您实际上是在检查旧代码和新代码。我这样做是为了测试一个我想重构的复杂 sql 触发器，这很痛苦并且需要时间，但一个月后，当我们在该领域发现另一个问题时，值得在那里进行测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T06:29:04.220

以我的经验，这是处理遗留代码时的现实。Esko 提到的 Book (Working with Legacy..) 是一部出色的作品，它描述了可以带您到那里的各种方法。

我已经看到了与单元测试本身类似的问题，它已经发展成为系统/功能测试。为 Legacy 或现有代码开发测试最重要的是定义术语“单元”。它甚至可以是“从数据库读取”等功能单元。识别关键功能单元并维护增加价值的测试。

顺便说一句，Joel S. 和 Martin F. 最近就 TDD/单元测试进行了讨论。我的看法是，定义单位并专注于它很重要！网址：[公开信](http://blog.objectmentor.com/articles/2009/02/06/on-open-letter-to-joel-spolsky-and-jeff-atwood)，[乔尔的成绩单](http://www.joelonsoftware.com/items/2009/01/31.html)和[播客](https://blog.stackoverflow.com/2009/01/podcast-38)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T21:59:59.087

这确实是尝试修改遗留代码的关键问题之一。你能把问题域分解成更细化的东西吗？除了对 JDK/Win32/.NET Framework JAR/DLL/程序集的系统调用之外，这个 500 多行的方法是否会产生其他任何影响？即，您可以对 500 多行的庞然大物进行单元测试，是否有更精细的函数调用？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-28T12:29:51.340

下面的书：[单元测试的艺术](http://www.manning.com/osherove/)包含几个章节，其中包含一些关于如何在开发单元测试方面处理遗留代码的有趣想法。

我发现它很有帮助。

# rss - 阅读 rss 并显示为 html

> ID：522340
> 
> 赞同：0
> 
> 时间：2009-02-06T21:52:51.283
> 
> 标签：rss

我正在为我的 RSS 使用谷歌阅读器，我想将所有共享或加星标的 rss 项目导出到 HTML 以获取此 html 并放在我的网站上

有人知道吗？还有一件重要的事情，我可以浏览这个 html 页面吗？我的意思是将页面导出为页面，而不是全部在一个 html 页面中，让用户通过我加星标的提要访问我的网站页面。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T22:02:57.113

使用 XSTL，您可以将 XML 转换为您想要的任何格式，包括 HTML。您可以在服务器上进行转换，或者使用 IE6+ 和 Firefox2+ 等现代浏览器，您可以在客户端进行转换。XSTL 作为一种编程语言不是很漂亮，但是这个概念很简洁。

我不知道您是否可以直接链接到 RSS 提要 XML，以便它始终是最新的。我认为 Google 要求您进行身份验证并有权访问该提要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T21:54:56.600

您可以通过选择和迭代标签相当容易地从带有 jQ​​uery 的 RSS 中读取。此外，您还可以对属性等执行条件检查。

# objective-c - Objective-C中的继承和类别有什么区别

> ID：522341
> 
> 赞同：57
> 
> 时间：2009-02-06T21:53:16.167
> 
> 标签：objective-c, oop, inheritance, categories

有人可以向我解释一下 Objective C 中类别和继承之间的区别吗？我已经阅读[了 Wikipedia 中的条目，](http://en.wikipedia.org/wiki/Objective-C#Categories)并且关于类别的讨论看起来与继承没有任何不同。我也看了《Open iPhone Development》一书中关于这个话题的讨论，还是没看懂。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-02-07T01:52:16.260

有时，继承似乎比它的价值更麻烦。当您想向现有类添加一些改变该类行为的东西时，它是正确使用的。

使用类别，您只希望现有对象多做一点。如前所述，如果您只想拥有一个处理压缩的字符串类，则不需要对字符串类进行子类化，只需创建一个处理压缩的类别。这样，您无需更改已使用的字符串类的类型。

线索在于类别仅添加方法的限制，您不能使用类别将变量添加到类中。如果该类需要更多属性，则必须对其进行子类化。（编辑：我相信您可以使用关联存储）。

类别是添加功能的好方法，同时符合面向对象的原则，优先选择组合而不是继承。

**编辑 2012 年 1 月**

现在情况发生了变化。使用当前的 LLVM 编译器和现代的 64 位运行时，您可以将 iVar 和属性添加到类*扩展*（而不是类别）。这使您可以将私有 iVar 排除在公共界面之外。但是，如果您为 iVar 声明属性，它们仍然可以通过 KVC 访问/更改，因为在 Objective-C 中仍然没有私有方法之类的东西。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-06T22:03:19.500

类别允许您向现有类添加方法。因此，您可以直接将它们添加到 NSData 类中，而不是子类 NSData 来添加您时髦的新加密方法。您应用程序中的每个 NSData 对象现在都可以访问这些方法。

要了解这有多么有用，请查看：[CocoaDev](http://www.cocoadev.com/index.pl?NSDataCategory)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-12-09T05:37:41.217

NSString 是 Objective-c 类别中最喜欢的示例之一。NSString 是在 Foundation 框架中定义的，它没有视图或窗口的概念。但是，如果您在 Cocoa 应用程序中使用 NSString，您会注意到它会响应类似`– drawInRect:withAttributes:`.

AppKit 为 NSString 定义了一个类别，它提供了额外的绘图方法。该类别允许将新方法添加到现有类中，因此我们仍然只是处理 NSStrings。如果 AppKit 通过子类化来实现绘图，我们将不得不处理“AppKitStrings”或“NSSDrawableStrings”或类似的东西。

类别允许您将应用程序或特定领域的方法添加到现有类。它可以非常强大和方便。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-24T05:46:24.563

如果您作为程序员获得了代码库或应用程序的完整源代码集，那么您可以发疯并更改您需要的任何内容，以使用该代码实现您的编程目标。

不幸的是，情况并非总是如此，甚至是不可取的。很多时候，你会得到一个二进制库/对象工具包和一组头文件。

然后一个类需要一个新功能，所以你可以做几件事：

1.  创建一个新类整体而不是一个普通类——复制它的所有函数和成员，然后重写所有代码以使用新类。

2.  创建一个新的包装类，其中包含股票类作为成员（合成）并重写代码库以利用新类。

3.  库的二进制补丁来更改代码（祝你好运）

4.  强制编译器将您的新类视为旧类，并希望它不依赖于特定大小或内存中的位置和特定入口点。

5.  子类专业化——创建子类以添加功能并修改驱动程序代码以使用子类——理论上应该没有什么问题，如果你需要添加数据成员，这是必要的，但是内存占用会有所不同。您的优势是在子类中同时拥有新代码和旧代码，并选择使用哪一个，基类方法或覆盖方法。

6.  使用包含方法的类别定义修改必要的 objc 类以执行您想要的操作和/或覆盖股票类中的旧方法。

    这也可以修复库中的错误或为新硬件设备或其他自定义方法。它不是灵丹妙药，但它允许在不重新编译未更改的类/库的情况下添加类方法。原始类在代码、内存大小和入口点上是相同的，因此遗留应用程序不会中断。编译器只是将新方法作为属于该类的方式放入运行时，并使用与原始代码中相同的签名覆盖方法。

    一个例子：

    您有一个 Bing 类输出到终端，但不输出到串行端口，现在这就是您所需要的。（由于某些原因）。您的工具包中有 Bing.h 和 libBing.so，但没有 Bing.m。

    Bing 类在内部做了各种各样的事情，你甚至都不知道是什么，你只是在标题中有公共 api。

    你很聪明，所以你为 Bing 类创建了一个 (SerialOutput) 类别。

    ```
    [Bing_SerialOutput.m]
    @interface Bing (SerialOutput)   // a category
    - (void)ToSerial: (SerialPort*) port ;
    @end

    @implementation Bing (SerialOutput)
    - (void)ToSerial: (SerialPort*) port 
    {
    ... /// serial output code ///
    }
    @end 
    ```

    编译器必须创建一个可以与您的应用程序链接的对象，并且运行时现在知道 Bing 响应 @selector(ToSerial:) 并且您可以像使用该方法构建 Bing 类一样使用它。您不能仅添加数据成员方法，这并不是要创建附加到基类的巨大代码肿瘤，但与严格类型的语言相比，它确实具有优势。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-07-27T12:46:59.623

我认为其中一些答案至少表明继承是向现有类添加功能的一种较重的方式，而类别则更轻量级。

当您创建新的类层次结构（所有铃声和呼吸声）时使用继承，并且在选择作为向现有类添加功能的方法时可以说出很多工作。

正如这里的其他人所说...如果您使用继承来添加新方法，例如向 NSString，您必须去更改您在要使用此新方法的任何其他代码中使用的类型。但是，如果您使用类别，则可以简单地在现有 NSString 类型上调用该方法，而无需子类化。

两者都可以达到相同的目的，但类别似乎为我们提供了一个更简单且需要更少维护的选项（可能）。

任何人都知道是否存在绝对必要类别的情况？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T22:04:25.160

Category 就像一个 mixin：Ruby 中的一个模块，或者有点像 Java 中的一个接口。您可以将其视为“裸方法”。添加类别时，您正在向类添加方法。维基百科的文章有[好东西](http://en.wikipedia.org/wiki/Objective-C#Categories)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-06T02:31:54.210

看待这种差异的最好方法是： 1\. 继承：当想要完全按照您的方式进行转换时。示例：AsyncImageView 实现延迟加载。这是通过继承 UIView 来完成的。2\. category : 只是想给它增加一种额外的味道。示例：我们要替换文本字段文本中的所有空格

```
 @interface UITextField(setText)
      - (NSString *)replaceEscape;
   @end

   @implementation UITextField(setText)
      - (NSString *)replaceEscape
      {
         self.text=[self.text stringByTrimmingCharactersInSet:
                           [NSCharacterSet whitespaceCharacterSet]];
         return self.text;
      }
   @end 
```

--- 它将向文本字段添加一个新属性，以便您转义所有空格。就像在不完全改变其方式的情况下为其添加一个新维度一样。

# usability - 最有用的全选/取消全选复选框格式

> ID：522352
> 
> 赞同：19
> 
> 时间：2009-02-06T21:55:50.997
> 
> 标签：usability

全选或取消全选复选框的最佳模式是什么。有人可以想出一个更好的方法来以这种形式拥有它：

![在此处输入图像描述](https://i.stack.imgur.com/16WUB.png)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-06T22:05:28.467

老实说，我从不喜欢在“全选”选项中使用复选框的想法，即使您经常看到它。这不是要选择的单个项目，而是一个动作。如果您选择全部然后开始取消选择列表中的单个项目，则全选复选框的“选中”状态本质上会变得混乱。我更喜欢使用一个简单但明显的链接/按钮，当它被点击时，它会在“全选”和“取消全选”之间切换。当单个项目被取消选择时，没有任何状态可以让您感到困惑，并且按下按钮的结果是毫无疑问的。该操作的独特性使得来回切换非常合理（而不是使用两个始终可见的按钮；一个用于全选，一个用于取消全选），因为您最多只需单击两下即可实现所需的行为。它在视觉上将这个“动作”与单个项目区分开来，防止误点击和区分行为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T22:18:05.243

如果您可以使用列表格式化对话框，我喜欢“列表标题中的复选框”方法（并且大多数用户直觉地知道如何使用它）。

![全选复选框](https://www.ssw.com.au/SSW/standards/rules/Images/SelectAllCheckBox_Web.jpg)

如果您不想使用列表，我认为按钮或超链接（从“全选”切换到“全选”会比在所有其他复选框中难以辨认的另一个复选框更好。另外，取消选中“全选”复选框并不一定意味着用户具有“全选”功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T22:05:00.683

只需将全选复选框靠近左边框即可。也许更改文本，例如“所有以前的游戏”等，以明确选择“所有”的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-25T00:55:25.390

这是 WinForms 中的用户控件实现@nezroy 答案的逻辑。这也允许您指定 InitialAction [SelectAll 或 DeselectAll 之一]。

```
Imports System.ComponentModel

''' <summary>
''' A control which allows the user to toggle back-and-forth
''' between selecting all of something, or de-selecting all of something.
''' </summary>
Public Class uscSelectDeselectAll

#Region "Events"

    Public Event CurrentAction_Changed()

#End Region

#Region "Enums"

    Public Enum SelectAction
        SelectAll
        DeselectAll
    End Enum

#End Region

#Region "Module-level variables"

    Private _initialAction As SelectAction
    Private _currentAction As SelectAction

#End Region

#Region "Properties"

    Public Property CurrentAction As SelectAction
        Get
            Return _currentAction
        End Get
        Private Set(value As SelectAction)
            _currentAction = value
            SetActionLinkText()
        End Set
    End Property

    <Browsable(True)>
    <EditorBrowsable(EditorBrowsableState.Always)>
    <DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)>
    Public Property InitialAction As SelectAction
        Get
            Return _initialAction
        End Get
        Set(value As SelectAction)
            _initialAction = value
            SetActionLinkText()
        End Set
    End Property

#End Region

#Region "Procedures"

    Private Sub SetActionLinkText()
        If _currentAction = SelectAction.SelectAll Then
            llActionText.Text = "Select All"
        ElseIf _currentAction = SelectAction.DeselectAll Then
            llActionText.Text = "Deselect All"
        Else
            Throw New InvalidEnumArgumentException("Invalid SelectActionProvided.")
        End If
    End Sub

    Private Sub ToggleAction()
        If CurrentAction = SelectAction.SelectAll Then
            CurrentAction = SelectAction.DeselectAll
        ElseIf CurrentAction = SelectAction.DeselectAll Then
            CurrentAction = SelectAction.SelectAll
        Else
            Throw New Exception("CurrentAction has the invalid value: " & CurrentAction.ToString())
        End If
    End Sub

#End Region

#Region "Event Handlers"

    Private Sub llActionText_LinkClicked(sender As Object, e As LinkLabelLinkClickedEventArgs) Handles llActionText.LinkClicked
        RaiseEvent CurrentAction_Changed()
        ToggleAction()
    End Sub

    Private Sub uscSelectDeselectAll_Load(sender As Object, e As EventArgs) Handles Me.Load
        CurrentAction = InitialAction
    End Sub

#End Region

End Class 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-06T22:02:40.267

我会说这是进行全选/取消全选的最直观的方法。但我也看到有些人使用链接，但我更喜欢那样。

# html - 元刷新不起作用？

> ID：522353
> 
> 赞同：45
> 
> 时间：2009-02-06T21:55:55.537
> 
> 标签：html, internet-explorer, refresh, meta-tags

我有一个页面使用类似的东西

```
<meta http-equiv="refresh" content="0;url=http://example.com/" /> 
```

但对于某个工作站上的某些用户，这不起作用。在 IE 中。cookie 或某处的设置是否有问题会导致此操作失败？我从来没有听说过这样的事情。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-09-06T20:09:30.750

问题是当 IE 看​​到这个时：

```
<meta http-equiv="refresh" content="0;http://www.example.com" /> 
```

它期望内容属性包含一个数字。IE 检查 URL 的唯一时间是内容属性是否包含“URL=”，因此在所有浏览器中最有用的重定向是这样的：

```
<meta http-equiv="refresh" content="0;URL=http://www.example.com" /> 
```

上面的示例将立即重定向，但如果您将 0 更改为另一个数字，它将等待那么多秒。希望这一切都有意义，它应该可以正常工作，但我仍然认为我的第一个想法是更好的。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-02-07T01:05:39.880

Internet Explorer 中有一项安全设置不允许刷新元标记。它位于 Security 选项卡下，然后选择 Custom Level 和 Miscellaneous 下的 Meta Tag Refresh。如果禁用，它将停止元刷新工作。

除了能够有选择地禁用它之外，如果您将 IE 的安全级别设置为“高”[在 IE9 中观察到]，它会自动禁用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-06T22:10:25.523

它真的是旧版本的 IE 吗？如果是这样，请尝试：

```
<meta http-equiv="refresh" content="0;url=http://example.com/"> </meta> 
```

它需要一个空白区域。HTML 编辑器会抱怨，但忽略它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-10T15:22:53.283

看看这个解决方案。它同时处理 javascript 和 meta-refresh： [Meta-refresh and javascript](http://davidwalsh.name/meta-refresh-javascript)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T22:24:13.217

META 标记不是空标记，在 HTML 中没有结束标记，只有在 XHTML 中。（如果您真的要发送 XHTML，它可能无法在旧版本的 IE 上正常工作，只有将 XHTML 发送到旧版 IE 的变通方法。）

尝试：

```
<meta http-equiv="refresh" content="0;url=http://example.com/"> 
```

[W3 学校 META 标签说明](http://www.w3schools.com/html/html_meta.asp)

你也可以试试：

1.  检查 IE 的主要和次要版本。您可以在 help->about 菜单选项中执行此操作。
2.  IE 历来都被文件名和 MIMEtypes 搞糊涂了。确保您将 HTML 作为 htm 或 html 扩展文件发送，并且这些文件类型已在您的服务器上设置为发送 text/html mimetype。
3.  确保您的服务器没有发送冲突的元刷新 http 标头。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T22:10:01.513

只是一个疯狂的猜测：也许在重定向不起作用的那些机器上安装了一些广告拦截器。想不出任何其他原因为什么这种常见技术在某些机器上有效，而在其他机器上却对您无效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-27T11:52:37.843

如果有人尝试使用元刷新**重定向到**Facebook 应用程序（Page Tab 应用程序或 IFRAME 应用程序）中的新 URL，则 Facebook 会以某种方式禁用该标签。

解决方法是：

```
<script>
top.window.location = 'http://example.com';
</script> 
```

请记住以“顶部”为目标，因为 Facebook 应用程序位于 IFRAME 中。

# sql - 您遵循什么 SQL 编码标准？

> ID：522356
> 
> 赞同：53
> 
> 时间：2009-02-06T21:56:51.040
> 
> 标签：sql, coding-style

那里有任何广泛使用的 SQL 编码标准吗？SQL 与 C/C++ 类型的编程语言略有不同。真的不知道如何最好地格式化它以提高可读性。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-06T22:07:04.220

不会称之为编码标准 - 更像是编码风格

```
SELECT
    T1.col1,
    T1.col2,
    T2.col3
FROM
    table1 T1
    INNER JOIN ON Table2 T2 ON T1.ID = T2.ID
WHERE
    T1.col1 = 'xxx'
    AND T2.Col3 = 'yyy' 
```

*   保留字大写
*   新行上的主要关键字
*   不能习惯列前的逗号
*   总是使用简短的有意义的表别名
*   以 v 为视图前缀
*   使用 sp 作为存储过程的前缀（但是不要使用为内置过程保留的“sp_”）
*   不要给表格加前缀
*   表名单数

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-06T22:01:34.340

我喜欢逗号前面的方式：

```
SELECT
      column1
    , column2
    , column3
    , COALESCE(column4,'foo') column4
FROM
    tablename
WHERE
    column1 = 'bar'
ORDER BY 
      column1
    , column2 
```

在我看来，它使它最容易阅读和调试。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-06T23:08:54.127

我知道这很长，但请耐心等待，这很重要。这个问题打开了一个很酷的蠕虫罐头。如果您不喜欢数据库块，请继续阅读。

并且，在任何人考虑取消我的回复之前，*请*查看以下有关锁定和重新编译的文章及其相关文章；SQL 数据库上的两个最具破坏性的资源。

**[http://support.microsoft.com/kb/263889](http://support.microsoft.com/kb/263889)**

我可以打字很快，而且我不喜欢比下一个人打字更多。但是我非常关注以下几点，即使它是更多的打字。以至于我已经构建了自己的 SP 应用程序来为我做这件事。

我提出的观点非常重要！你甚至可能对自己说，“你在开玩笑吧，这不是问题”，好吧，那你就没有读过上面的文章。**而且，** M$ 将这些点作为注释放入是完全愚蠢的。这些问题对我来说应该是大胆的和尖叫的。

我还使用 C# 应用程序来构建我的基本脚本以加快开发速度，并且这些实践非常有效（值得 10 年），使脚本 SP 更容易，尤其是更快。

还有更多，但这是我为前 60% 所做的一切。

* * *

**最佳实践**

*   在对象周围使用方括号，以便查询引擎在看到字段时明确知道它
*   使用 THE SAME CASE 作为表对象名和字段名
*   从应用程序调用 SP 时，使用具有正确所有者和大小写的完全限定 [dbo].[procName]。不开玩笑！阅读上面的文章！
*   引用对象的所有者，以便明确知道安全性并且不必弄清楚
*   不要使用“sp_”，因为这是指系统存储的过程和开销
*   使用 SET NOCOUNT ON 和 SET NOCOUNT OFF 来消除额外的开销来跟踪存储过程中更新了多少记录，除非您需要它们。通常情况下，您不会这样做，而且您可以获得巨大的性能提升。

**优先**

*   使用 proc 为存储的 proc 添加前缀
*   为每个存储过程添加 SEL、UPD、DEL、INS（或 SELECT、UPDATE、DELETE、INSERT）后缀
*   保留字大写
*   新行上的主要关键字（脚本）
*   在列前使用逗号（脚本）
*   使用 vw 为视图添加前缀
*   不要为表格添加前缀
*   表名单数
*   为标准名称添加后缀，例如“_ByPK”、“_OrderByLastName”或“_Top15Orders”，以表示股票 SP 的变体

* * *

选择

> ```
> CREATE PROC [dbo].[procTable_SEL]
> AS
> SET NOCOUNT ON
> SELECT
>     [Column1] = T1.[col1]
>   , [Column2] = T1.[col2]
>   , [Column3] = T2.[col3]
> FROM [dbo].[Table] T1    
> INNER JOIN ON [dbo].[Table2] T2 ON T1.ID = T2.ID
> WHERE
>       T1.[col1] = 'xxx'
>   AND T2.[Col3] = 'yyy'
> SET NOCOUNT OFF
> GO 
> ```

* * *

更新

> ```
> CREATE PROC [dbo].[procTable_UPD]
> AS
> SET NOCOUNT ON
> UPDATE t1 SET
>     [Column1] = @Value1
>   , [Column2] = @Value2
>   , [Column3] = @Value3
> FROM [dbo].[Table1] T1
> INNER JOIN ON [dbo].[Table2] T2 ON T1.[ID] = T2.[ID]
> WHERE
>       T1.[col1] = 'xxx'
>   AND T2.[Col3] = 'yyy'
> SET NOCOUNT OFF
> GO 
> ```

* * *

插入

> ```
> CREATE PROC [dbo].[procTable_INS]
> AS
> SET NOCOUNT ON
> INSERT INTO [Table1] (
> [Column1]
>   , [Column2]
>   , [Column3]
> )
> VALUES (
>     @Value1
>   , @Value2
>   , @Value3
> )
> SET NOCOUNT OFF
> GO 
> ```

或者

> ```
> CREATE PROC dbo.procTable_INS
> AS
> SET NOCOUNT ON
> INSERT INTO [table1] (
>     [Column1]
>   , [Column2]
>   , [Column3]
> )
> SELECT
>     [Column1] = T1.col1
>   , [Column2] = T1.col2
>   , [Column3] = T2.col3
> FROM dbo.Table1 T1    
> INNER JOIN ON Table2 T2 ON T1.ID = T2.ID
> WHERE
>       T1.[col1] = 'xxx'
>   AND T2.[Col3] = 'yyy'
> SET NOCOUNT OFF
> GO 
> ```

* * *

删除

> ```
> CREATE PROC dbo.procTable_DEL
> AS
> SET NOCOUNT ON
> DELETE
> FROM [dbo].[Table1] T1
> INNER JOIN ON [dbo].[Table2] T2 ON T1.[ID] = T2.[ID]
> WHERE
>       T1.[col1] = 'xxx'
>   AND T2.[Col3] = 'yyy'
> SET NOCOUNT OFF
> GO 
> ```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-06T22:01:04.963

如果你用谷歌搜索，那里有很多编码标准。例如，

[数据库编码标准和指南](http://www.nyx.net/~bwunder/dbChangeControl/standard.htm)

和

[SQL SERVER 数据库编码标准和指南完整列表](http://blog.sqlauthority.com/2007/06/06/sql-server-database-coding-standards-and-guidelines-complete-list-download/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-06T22:13:01.367

来自关于 PostgreSQL 的一个非常好的博客，但这个主题一般适用：

[可维护的查询 - 我的观点 (depesz.com)](http://www.depesz.com/index.php/2009/01/04/maintainable-queries-my-point-of-view/)

> ...我决定编写可维护查询的优先级：
> 
> 1.  避免无用的打字。
>     
>     
> 2.  为表/视图使用别名。总是。并使它们成为合理的别名。
>     
>     
> 3.  以某种方式缩进代码。
>     
>     
> 4.  避免引用（是的，这就是我讨厌 Django 的原因）
>     
>     
> 5.  使用连接语法

我同意保留字和所有其他标识符的大写，除了我自己的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-06T22:19:08.000

我个人不喜欢在存储过程名称前加上 sp_ ——这是多余的，IMO。相反，我喜欢在它们前面加上一个“功能单元”标识符。例如，我将调用 sprocs 来处理订单 order_Save、order_GetById、order_GetByCustomer 等。它使它们在管理工作室中按逻辑分组，并且更难选择错误的。（GetOrderByProduct、GetCustomerById 等...）

当然，这是个人喜好，其他人可能更喜欢将所有 Get sprocs 放在一起，所有 Save sprocs 等等。

只是我的2c。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-06T22:01:10.830

我通常每行保留很少，即：

```
select
    col1,
    col2,
    col3
from
    some_table tabl1
where
    col1 = 'some'
and 
(
    col2 = 'condition'
or  col2 = 'other'
) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-06T22:01:59.610

Google for sql pretty printer 或看[这里](http://www.wangz.net/sqlpp.php)。我自己没有尝试过，但它给了你一个好的开始。大多数像 Toad 这样的商业工具都有一个“格式化”选项，它也有帮助。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-06T22:03:55.520

玩转[www.sqlinform.com](http://www.sqlinform.com) - 我建议使用[ANSI-92 标准](https://stackoverflow.com/questions/334201/why-isnt-sql-ansi-92-standard-better-adopted-over-ansi-89)，然后在该站点上进行美化。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-06T22:48:32.577

```
SELECT c.id
     , c.name
     , c.folder
     , cs.num_users active_members
     , cs.num_videos

  FROM campaign c
  JOIN campaign_stats cs
    ON cs.campaign_id = c.id
  JOIN (SELECT _c.id
             , _c.name

          FROM campaign _c
         WHERE _c.type = 9) t_c 
    ON t_c.id = c.id

 WHERE c.id IN (1,2,3)
   AND cs.num_videos > 10 
```

这对我们来说非常有效。

这个实际的查询没有多大意义，因为我试图快速构建它作为示例……但这不是重点。

*   t_c 代表类别表子查询或“临时类别”。
*   _underscoring 子查询中的内容。
*   别名列名称在查询的上下文中有意义。例如“active_members”
*   将逗号放在新行的开头可以更轻松地构建动态查询：

    ```
    $sql .= ", c.another_column" 
    ```

*   其他一切都很简单。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-07T00:07:49.093

蓝色的任何东西都是大写的`SELECT`, `DELETE`, `GO`, 等等

表名是单数的，就像我们的客户表是客户表一样

链接表是`tablename_to_tablename`

`_`在表名和参数中的作品之间使用

例子

```
BEGIN
    SELECT
        Company.ID AS Company_ID,
        Company.Client_Name,
        Company.Website,
        Office.Office_Name
    FROM
        Company_Office WITH(NOLOCK)
        INNER JOIN Company WITH(NOLOCK) ON Company_Office.Company_ID = Company.ID
    WHERE
END 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-07-13T20:18:39.337

令我惊讶的是，我使用了近 20 年的编码风格不在此列表中：

```
 SELECT column1,
         column2,
         column3,
         COALESCE(column4, 'foo') AS column4
    FROM tablename
   WHERE column1 = 'bar'
ORDER BY column1,
         column2 
```

我发现这绝对是最易读的，但我承认打字很乏味。如果右对齐关键字太多，我会选择左对齐：

```
SELECT   column1,
         column2,
         column3,
         COALESCE(column4, 'foo') AS column4
FROM     tablename
WHERE    column1 = 'bar'
ORDER BY column1,
         column2 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-02-07T00:20:35.540

```
create table
    #tempTable (
        col1 int,
        col2 int,
        col3 int
    )

insert into
    #tempTable (
        col1,
        col2,
        col3
    )
    select
        col1,
        col2,
        col3
    from
        Table3
        inner join Table2
            on Table1.col1 = Table2.col2
    where col1 = 5

select
    col2,
    case when col1 = 3
        then 'something'
        else 'somethingelse'
    end
from #tempTable
where
    col1 = 5
    and (
        col2 = 5
        or col3 in (
            select field
            from Table2
            where
                somecol = 2
                and othercol = 5
        )
    ) 
```

# javascript - 需要 Flash / Lightwindow 快速帮助

> ID：522359
> 
> 赞同：0
> 
> 时间：2009-02-06T21:57:33.210
> 
> 标签：javascript, html, css, flash, lightwindow

我正在尝试为我的公司完成一个 Flash 网站，并且对 Flash 中的 Lightwindow 链接有一些重大的挫败感。我有一个“视频”页面，其中包含一些链接，当您单击一个链接时，它会打开一个带有 .SWF 的灯箱，用于播放视频。问题是 Lightwindow 的顶部和 Flash 菜单栏相互妨碍，使一切变得不稳定。在 PC 上，我的老板甚至看不到 lightwindow 顶部的“关闭”按钮。有问题的网站在这里，供审查：

[http://www.facedigitalpost.com/test/](http://www.facedigitalpost.com/test/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T09:14:23.680

你的问题是闪光灯总是在上面。除非您使 wmode = 透明或不透明。

您在嵌入闪存的位置设置此参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T08:47:56.983

试试这个：[https ://stackoverflow.com/search?q=wmode+transparent](https://stackoverflow.com/search?q=wmode+transparent)

# windows - 连接到剪贴板？

> ID：522362
> 
> 赞同：10
> 
> 时间：2009-02-06T21:57:58.653
> 
> 标签：windows, linux, macos, clipboard, append

有谁知道将所选内容附加到剪贴板的实用程序（适用于 Windows、Linux 或 MacOSX）？而不是杀死已经存在的东西......（也许使用不同的键盘快捷键而不是**Ctrl+C**来做到这一点？

## 我不是指多个剪贴板项目...

我的意思是将多个文本字符串连接到剪贴板上的同一个剪辑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-07-26T02:33:44.460

我找到了一个！Lifehacker 有它的特色，虽然它只适用于 Windows，但它是：

[剪辑链](http://lifehacker.com/5337238/clipchain-copies-multiple-text-strings-for-easy-pasting)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T22:04:42.383

有很多实用程序可以保留最近剪辑项目的缓冲区/队列。

要执行您提到的特定功能（附加到现有项目），编写一个应用程序来获取剪贴板，保存那里的内容，附加新内容，然后将组合内容传输回剪贴板似乎相当简单。

一个很大的警告/陷阱......这对于文本来说非常简单，但是其他格式呢？如果剪贴板上有图像，您将如何处理附加文本？或相反亦然？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-19T19:08:34.357

LaunchBar 具有此功能，我广泛使用它。

说实话，我不把它用于图片，所以我不知道他们如何处理它，但它处理文本很漂亮。

启动键是双 CMD/C（即按住命令并按 C 两次）。这很直观，因为它是相同的组合键。下次您只需为普通副本执行普通 CMD/C（一次），然后我们重新开始。

更重要的是，还有剪贴板历史记录，所以如果你忘记加倍 C，你并没有丢失任何东西。甚至更多……我相信剪贴板历史记录的快捷方式访问和粘贴选项是我遇到的最好的（并且我尝试了许多实用程序）。

而且，（最后），您可以从 LaunchBar 作为启动器的主要资产中受益，我已经习惯了它，没有它我活不下去。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-12T15:42:50.897

不，但是用 C#（或许多其他语言）编写一个相对容易：

1.  创建一个隐藏到“系统托盘”的应用程序
2.  它创建了一个[键盘钩子](http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx)
3.  当按下适当的组合键时，如果剪贴板格式是文本，则获取当前文本，连接选定的文本（获取选定的文本将是困难的部分），然后将其放回剪贴板。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-07T18:45:33.350

在 Windows 10 上，有一个“保存多个剪贴板项目”设置，可以存储多个剪贴板项目。使用 WinLogo-V，您可以按任意顺序查看和粘贴它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-20T14:13:33.927

在 Windows 7 和 8 上，组合键 Ctrl-Shift-C 附加到现有剪贴板。

干杯!

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-19T09:50:48.627

当按下 Ctrl-Insert 时，Autohotkey 脚本会附加到剪贴板。

```
^Insert::  ; Add to clipboard
bak = %clipboard%
Clip()
clipboard = %bak%`r`n%clipboard%
return 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-06T22:00:04.437

我不确定这是否有帮助，但 emacs 保留了自己的杀戮环，因此您可以向后滚动，甚至搜索您剪切或复制的内容......

# sql - 为什么 SQL 连接会选择次优查询计划？

> ID：522367
> 
> 赞同：15
> 
> 时间：2009-02-06T21:59:10.913
> 
> 标签：sql, sql-server

好的，所以我意识到这是一个非常模糊的问题，但请耐心等待。

我曾多次使用不同且不相关的查询遇到此问题。下面的查询需要很长时间才能执行：

```
SELECT <Fields>
FROM <Multiple Tables Joined>
    LEFT JOIN (SELECT <Fields> FROM <Multiple Tables Joined> ) ON <Condition> 
```

但是，只需添加连接提示，它就会在几秒钟内查询执行：

```
SELECT <Fields>
FROM <Multiple Tables Joined>
    LEFT HASH JOIN (SELECT <Fields> FROM <Multiple Tables Joined> ) ON <Condition> 
```

奇怪的是，提示中指定的 JOIN 类型并不能真正提高性能。似乎是因为提示导致优化器孤立地执行子查询然后加入。如果我为子查询创建一个表值函数（不​​是内联函数），我会看到相同的性能改进。例如

```
SELECT <Fields>
FROM <Multiple Tables Joined>
    LEFT JOIN dbo.MySubQueryFunction() ON <Condition> 
```

有人知道为什么优化器在这种情况下如此愚蠢吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-06T22:06:35.670

如果这些表中的任何一个是表变量，则优化器使用 0 行的错误估计，并且通常选择嵌套循环作为连接技术。

这样做是因为缺少有关表的统计信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T22:07:55.513

优化器是一种算法。它既不笨也不聪明，它按照编程的方式工作。

`Hash join`意味着在较小的行源上构建哈希表，这就是必须首先执行内部查询的原因。

在第一种情况下，优化器可能选择了`nested loop`. 它将连接条件推送到内部查询中，并在每次迭代时使用附加谓词执行内部查询。它可能找不到此谓词的适当索引，并且`full table scan`每次迭代都发生了。

除非您发布确切的查询以及表中有多少行，否则很难说为什么会发生这种情况。

使用表函数，不可能将连接条件推送到内部查询中，这就是它只执行一次的原因。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-12-05T07:15:30.520

SQL Server 2005 内部：T-SQL 查询回答了这些问题和许多其他问题。我见过的 T-SQL 数据检索和动词处理的最佳外观之一。（不，我不是这本书的作者，我也不隶属于这本书的任何一位或多位作者，或者微软或微软出版社。这简直是一部令人难以置信的作品，我过去曾转向过各种 DBA几年同意。）

# logging - 依赖注入和日志接口

> ID：522370
> 
> 赞同：27
> 
> 时间：2009-02-06T21:59:34.717
> 
> 标签：logging, dependency-injection

我想知道有关日志记录和日志记录框架以及依赖注入的一些最佳实践。具体来说，如果我正在设计一个需要记录方式的类，我应该如何获取一个记录接口以牢记依赖注入？

依赖注入似乎表明应该从外部（构造函数或属性设置器）注入外部依赖项，那么我应该在构造函数中获取一个 ILog 实例并在类中使用吗？我是否应该考虑记录一个可选的依赖项并将其放入 setter 中？我是否通过允许更改日志接口来推动太大的灵活性，我是否应该只对特定的日志接口进行硬依赖（例如，通过调用工厂方法创建静态 ILog 变量）？这个工厂方法是否可以调用容器来获取 ILog 实现，或者这是否会在正在初始化的静态变量和正在初始化的 IoC 容器之间产生初始化冲突？

我应该这样做：

```
public class MyService : ISomeService
{
  private static readonly ILogger s_log = 
            LoggingFactory.GetLogger(typeof(MyService))
  ...
} 
```

或者这个：

```
public class MyService : ISomeService
{
  protected virtual ILogger Logger {get; private set;}
  public MyService(ILogger logger, [other dependencies])
  {
    Logger = logger;
  }
} 
```

甚至这个：

```
public class MyService : ISomeService
{
  public virtual ILogger Logger {get; set;}
  public MyService()
  {
  }
} 
```

Other patterns or ways to do this? What are people out there doing? What's working and when?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T22:27:05.503

It's great that you're looking into inversion-of-control and dependency-injection.

But for your question, there's another concept you might want to look into: aspect-oriented programming.

In .NET, there are some good frameworks available for doing aspect-oriented programming, including Castle, LinFu, and Microsoft's Policy-Injection Application Block. In fact, some inversion-of-control containers have some aspect-oriented features in them as well.

These concepts and tools help make concerns such as logging take a background seat in terms of code noise, and make be handled automagically.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T12:37:08.800

My advice? Wrap the logging interfaces into your own. I took a dependency on Log4Net once, got burned and had to refactor a lot of my projects because of it.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T22:04:04.553

This won't be a complete answer, but one consideration will be that if you inject your ILog via your class' constructor you can then mock that logging framework for your unit testing. Other thoughts... A property setter for passing in the ILog means that you can't log actions from the constructor. Also, you don't know for sure if your instance even has an ILog available meaning you have to wrap every call with a test for a valid ILog instance.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T22:07:46.527

I would stick to injecting it and using an interface. Mainly to facilitate testing. Making it is easier to substitute a mock or stub when testing the consuming object.

I would base whether I used constructor or setter injection on the importance of the log to the consuming class. If you want it to be critical then I would favor constructor injection, if optional then setter.

I don't see where using a factory method couldn't work with the container, however, it then makes testing the consumer class dependent on a proper configuration of this factory method.

# python - 在 Python 的列表中查找某个值的第一个和最后一个索引

> ID：522372
> 
> 赞同：96
> 
> 时间：2009-02-06T22:00:00.257
> 
> 标签：python, list, search

是否有任何内置方法是列表的一部分，可以为我提供某个值的第一个和最后一个索引，例如：

```
verts.IndexOf(12.345)
verts.LastIndexOf(12.345) 
```

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2009-02-06T22:05:06.453

序列有一个方法`index(value)`返回第一次出现的索引 - 在你的情况下，这将是`verts.index(value)`.

您可以运行它`verts[::-1]`以找出最后一个索引。在这里，这将是`len(verts) - 1 - verts[::-1].index(value)`

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-08-09T23:23:39.650

如果您正在搜索最后一次出现`myvalue`in的索引`mylist`：

```
len(mylist) - mylist[::-1].index(myvalue) - 1 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2020-09-10T17:32:01.923

也许找到*最后一个*索引的两种最有效的方法：

```
def rindex(lst, value):
    lst.reverse()
    i = lst.index(value)
    lst.reverse()
    return len(lst) - i - 1 
```

```
def rindex(lst, value):
    return len(lst) - operator.indexOf(reversed(lst), value) - 1 
```

两者都只占用 O(1) 额外空间，并且第一个解决方案的*两个*就地反转比创建反向副本快得多。让我们将其与之前发布的其他解决方案进行比较：

```
def rindex(lst, value):
    return len(lst) - lst[::-1].index(value) - 1

def rindex(lst, value):
    return len(lst) - next(i for i, val in enumerate(reversed(lst)) if val == value) - 1 
```

基准测试结果，我的解决方案是红色和绿色的： [![未洗牌，全系列](https://i.stack.imgur.com/ZRMc6.png)](https://i.stack.imgur.com/ZRMc6.png)

这是为了在一百万个数字的列表中搜索一个数字。x 轴表示搜索元素的位置：0% 表示它位于列表的开头，100% 表示它位于列表的末尾。所有解决方案在 100% 位置上都是最快的，这两个`reversed`解决方案几乎不需要时间，双反向解决方案需要一点时间，而反向复制需要很多时间。

仔细看看右端： [![未洗牌，尾部](https://i.stack.imgur.com/ANmnz.png)](https://i.stack.imgur.com/ANmnz.png)

在位置 100% 处，反向复制解决方案和双反向解决方案将所有时间都花在反转上（`index()`即时），因此我们看到两个原地反转的速度大约是创建反向副本的 7 倍。

上面是 with `lst = list(range(1_000_000, 2_000_001))`，它几乎在内存中按顺序创建 int 对象，这对缓存非常友好。`random.shuffle(lst)`让我们在用（可能不太现实，但很有趣）对列表进行洗牌之后再做一次：

[![洗牌列表，全系列](https://i.stack.imgur.com/xxsNh.png)](https://i.stack.imgur.com/xxsNh.png)

[![改组列表，尾部](https://i.stack.imgur.com/rznaG.png)](https://i.stack.imgur.com/rznaG.png)

正如预期的那样，一切都变慢了。反向复制解决方案遭受的损失最大，在 100% 时，它现在需要的时间大约是双反向解决方案的 32 倍 (!)。并且- 解决`enumerate`方案现在是仅次于位置 98% 的第二快解决方案。

总的来说，我最喜欢这个`operator.indexOf`解决方案，因为它是所有地点中后半部分或四分之一的最快的解决方案，如果你真的在`rindex`做某事，这可能是更有趣的地点。而且它只比早期位置的双反向解决方案慢一点。

在 Windows 10 Pro 1903 64 位上使用 CPython 3.9.0 64 位完成所有基准测试。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-04-08T20:57:56.737

作为一个小辅助函数：

```
def rindex(mylist, myvalue):
    return len(mylist) - mylist[::-1].index(myvalue) - 1 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-03-13T10:21:52.800

Python 列表有一个[`index()`](https://docs.python.org/3/library/stdtypes.html#common-sequence-operations)方法，您可以使用它来查找列表中*第一次*出现的项目的位置。请注意，当项目不在列表中时`list.index()`会引发，因此您可能需要将其包装在/中：`ValueError``try``except`

```
try:
    idx = lst.index(value)
except ValueError:
    idx = None 
```

要有效地查找列表中*最后一次*出现的项目的位置（即不创建反向中间列表），您可以使用此函数：

```
def rindex(lst, value):
    for i, v in enumerate(reversed(lst)):
        if v == value:
            return len(lst) - i - 1  # return the index in the original list
    return None    

print(rindex([1, 2, 3], 3))     # 2
print(rindex([3, 2, 1, 3], 3))  # 3
print(rindex([3, 2, 1, 3], 4))  # None 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-07-17T14:55:16.033

使用`max`+`enumerate`获取最后一个元素的出现

```
rindex = max(i for i, v in enumerate(your_list) if v == your_value) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-25T09:16:44.123

这种方法可以比上面更优化

```
def rindex(iterable, value):
    try:
        return len(iterable) - next(i for i, val in enumerate(reversed(iterable)) if val == value) - 1
    except StopIteration:
        raise ValueError 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-17T21:11:46.903

```
s.index(x[, i[, j]]) 
```

x 在 s 中第一次出现的索引（在索引 i 处或之后，索引 j 之前）

# frameworks - 轻量级 Javascript 框架

> ID：522376
> 
> 赞同：2
> 
> 时间：2009-02-06T22:00:54.950
> 
> 标签：frameworks, javascript, javascript-framework

我正在尝试创建一个可以在我的greasemonkey 脚本中使用的小型Javascript“框架”。我只需要**非常**基本的功能，所以这就是我选择不使用 mooTools 或 DOMAssistant 的原因。另外，我不会傻傻的把DOMAssitant 放到一个20KB 的Greasemonkey 脚本里！我只想要一小段整洁的代码。

我对下面的代码有一个小问题。我认为这是因为我在 $() 中返回了一个数组，所以我得到 .setStyle is not a function 错误消息。

```
 var fmini = {  
  $ : function(a) {
    var i=0,obj,d;
    var e = [];

    while (obj = arguments[i++]) {
      d = document.getElementById(obj);
      d.setStyle = fmini.setStyle;
      d.each = fmini.each;
      e.push(d);
    }

    return e;
  },
  setStyle : function(style, value) {
    if (typeof this.style.cssText !== 'undefined') {
      var styleToSet = this.style.cssText;
      if (typeof style === 'object') {
        for (var i in style) 
          if (typeof i === 'string') styleToSet += ';' + i + ':' + style[i];
      }
      else styleToSet += ';' + style + ':' + value;
      this.style.cssText = styleToSet;
    }
    return this;
  },
  each : function (functionCall) {
                for (var i=0, il=this.length; i < il; i++) 
                    functionCall.call(this[i]);
                return this;
    },
}
window.$ = fmini.$; 
```

当我这样做时，我希望它能够工作

```
 $('bob','amy').setStyle({
    'border' : '5px solid #ff0000',
    'background-color' : '#ccc'
    }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T22:09:01.533

*编写您的*方法来操作从`$`. 这样，两者都`$('bob').setStyle()` *将* `$('bob', 'amy').setStyle()`起作用。我看到你有一个通用`forEach`或`each`方法，这是一个好的开始。

```
var fmini = {
    $: function() {
        var i=0, obj;
        var e = [];
        e.setStyle = fmini.setStyle;
        e.each = fmini.each;

        while (obj = arguments[i++]) {
            e.push(document.getElementById(obj));
        }

        return e;
    },

    setStyle : function(style, value) {
        return this.each(function() {
            if (typeof this.style.cssText !== 'undefined') {
                var styleToSet = this.style.cssText;
                if (typeof style === 'object') {
                    for (var i in style) 
                        if (typeof i === 'string') styleToSet += ';' + i + ':' + style[i];
                }
                else styleToSet += ';' + style + ':' + value;
                this.style.cssText = styleToSet;
            }
        })
    }
} 
```

顺便说一句，这是`jQuery`第一个做/流行的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T22:17:45.227

就像您怀疑在这种情况下返回的 $ 是一个元素数组一样，您必须使用 setStyle 扩展数组，或者在填充数组时添加扩展，然后再将数组传回。那么你不应该得到一个错误，说 .setStyle 不是一个函数。但是，您还必须确保在像这样链接时处理对象上下文绑定，否则`this`指的是当前范围而不是数组中的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T22:19:36.800

$ 函数返回一个数组；它应该返回元素对象本身 (d)，在该元素对象上增加 setStyle 方法，或者只是另一个对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-11T02:04:50.100

如果你愿意，你可以使用我的图书馆。

它叫做 Ally，你可以在这里下载它：http: [//github.com/AllyToolkit/Ally](http://github.com/AllyToolkit/Ally)

我注意到你说你想要一些轻量级的东西，而 Ally 的库存版本目前刚刚超过 1300 行，25KB 未缩小，你可以轻松地删除你不需要的部分。

我写它的目的是很容易修改，但仍然非常强大，并且充满了有用的功能。

今晚我将很快发布第二个测试版。它应该会在接下来的一个小时内出现在发布分支 ( [http://github.com/AllyToolkit/Ally/tree/release ) 上。](http://github.com/AllyToolkit/Ally/tree/release)

如果你决定尝试一下，我希望你喜欢。:)

# asp.net-mvc - 在 MVC 中验证模型的一部分

> ID：522386
> 
> 赞同：2
> 
> 时间：2009-02-06T22:02:16.367
> 
> 标签：asp.net-mvc, validation

我正试图在 MVC 场景中进行验证。我有我的应用程序设置，因此它有一个使用 Linq2SQL 并在我的域模型中创建对象的数据/存储库层。我不会将我的 Linq2SQL 对象直接暴露给我的应用程序的其余部分，但是，就目前而言，我的域模型大多看起来像我的数据库表。我想这样做，以防我以后想放弃 Linq2SQL。

然后我有一个从我的控制器调用的服务层来执行操作并从我的数据层获取我的域模型。

我想使用一个验证框架，比如[xVal](http://xval.codeplex.com/)。您的模型应该包含您的验证规则似乎是普遍的智慧。我的问题是你如何验证模型的一部分（或各种状态）？例如，我有一个具有用户名、密码和其他属性的用户对象。我有一个登录操作，我想确保提供了用户名和密码。但是，当我创建新用户时，我希望需要更多字段。当我已经有了我的用户对象时，在我的模型中创建一个登录对象似乎很奇怪。

现在，我的登录操作只是采用发布给它的用户名和密码参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T22:06:44.033

你是对的，验证通常在模型层中。问题可能出在您的域模型中——您有一个用户的想法，除非它包含所有这些内容，否则它是无效的。

考虑而不是可以匿名或可以填写的用户。考虑这一点的一种简单方法是让用户拥有一个 Credentials 对象的实例；这也是跟踪权限等的好地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T22:23:02.907

对不起，但我无法超越你的例子。用户对象不应该有登录方法。我要做的是有以下

```
public class User
{
  public bool ConfirmPassword(string password)
  {
    ... 
  }
} 
```

然后是一个存储库。这会通过用户名找到用户，然后检查 ConfirmPassword 是否正确，如果不正确则返回 null。

```
public interface IUserRepository
{
  ..other stuff..
  User GetByUserNameAndPassword(string userName, string password);
} 
```

至于验证，我通常有两种获取约束的方法。

```
//The constraint itself
public interface IConstraint
{
  string Name { get; }
  bool IsValid();
}

//A way to get constraints that are inexpensive to evaluate, such
//as Name != null etc.  This can be implemented as a service to provide
//custom constraints from an external source (such as rows in a DB)
//which then additionally checks "instance" if it implements the
//interface and adds its constraints to the result too.

//These are the kinds of constraints I evaluated in the GUI every
//time the object changes, so I can show a list of errors.
public interface IConstraintProvider
{
  IEnumerable<IConstraint> GetConstraints(object instance);
}

//Finally a way to get constraints that are expensive to evaluate, this
//includes checking invariants that might involve DB access.  These constraints
//(along with the cheap evaluation constraints) are all evaluated before
//my persistence service attempts to write the object's changes to the DB
public interface IPreSaveConstraintProvider
{
  IEnumerable<IConstraint> GetConstraints(object instance);
} 
```

# .net - .NET - 查找外部应用程序主线程 ID

> ID：522394
> 
> 赞同：2
> 
> 时间：2009-02-06T22:03:56.440
> 
> 标签：.net, multithreading, external

我正在尝试查找外部应用程序**主线程的句柄。**我试图找到主线程的程序是多线程的，重要的是我总是找到主线程。我知道最多只会运行这个程序的一个副本。这就是我目前的做法：

```
Process[] someProcesses = Process.GetProcessesByName("some");
IntPtr threadHandle = OpenThread(ThreadAccess.SUSPEND_RESUME, false, (uint)someProcesses[0].Threads[0].Id); 
```

大多数时候，Threads[0] 是主线程，但其他时候不是。如何确保我找到的线程是其他应用程序的主线程？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T22:46:17.963

这是一个疯狂的猜测，但是 via `Processes`，你可以得到一个`ProcessThreadCollection`via`Threads`属性。每个线程都有一个`StartTime`（也可用`Ticks`），因此假设主线程是第一个启动的，您可以选择启动时间最短的线程。

否则，如果您可以获得每个线程的调用堆栈，则可以查找应用程序入口点。我找不到这方面的托管呼叫，但我相信您可以通过 P/Invoke 获得它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-02T15:23:07.563

谈论迟到的聚会——但是如果有人在谷歌搜索或其他东西中找到了这个，`Thread.CurrentThread.Name`当我的应用程序启动时，我对我的主线程的 ID 所做的事情就会被设置为一个值（比如“Main”）。

# java - 从 Java 中的 SOAPMessage 获取原始 XML

> ID：522395
> 
> 赞同：84
> 
> 时间：2009-02-06T22:04:00.420
> 
> 标签：java, soap, jax-ws

我已经在 J​​AX-WS 中设置了一个 SOAP WebServiceProvider，但是我无法弄清楚如何从 SOAPMessage（或任何节点）对象中获取原始 XML。这是我现在得到的代码示例，我正在尝试获取 XML：

```
@WebServiceProvider(wsdlLocation="SoapService.wsdl")
@ServiceMode(value=Service.Mode.MESSAGE)
public class SoapProvider implements Provider<SOAPMessage>
{
    public SOAPMessage invoke(SOAPMessage msg)
    {
        // How do I get the raw XML here?
    }
} 
```

有没有一种简单的方法来获取原始请求的 XML？如果有办法通过设置不同类型的 Provider（例如 Source）来获取原始 XML，我也愿意这样做。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-09-29T03:22:22.353

你可以试试这种方式。

```
SOAPMessage msg = messageContext.getMessage();
ByteArrayOutputStream out = new ByteArrayOutputStream();
msg.writeTo(out);
String strMsg = new String(out.toByteArray()); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-11-20T08:53:12.967

如果您有`SOAPMessage`or `SOAPMessageContext`，您可以使用 a `Transformer`，将其转换为`Source`via `DOMSource`：

```
 final SOAPMessage message = messageContext.getMessage();
            final StringWriter sw = new StringWriter();

            try {
                TransformerFactory.newInstance().newTransformer().transform(
                    new DOMSource(message.getSOAPPart()),
                    new StreamResult(sw));
            } catch (TransformerException e) {
                throw new RuntimeException(e);
            }

            // Now you have the XML as a String:
            System.out.println(sw.toString()); 
```

这将考虑编码，因此您的“特殊字符”不会被破坏。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-25T19:00:34.860

事实证明，可以通过使用 Provider<Source> 获取原始 XML，方式如下：

```
import java.io.ByteArrayOutputStream;
import javax.xml.transform.Source;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.stream.StreamResult;
import javax.xml.ws.Provider;
import javax.xml.ws.Service;
import javax.xml.ws.ServiceMode;
import javax.xml.ws.WebServiceProvider;

@ServiceMode(value=Service.Mode.PAYLOAD)
@WebServiceProvider()
public class SoapProvider implements Provider<Source>
{
    public Source invoke(Source msg)
    {
        StreamResult sr = new StreamResult();

        ByteArrayOutputStream out = new ByteArrayOutputStream();
        sr.setOutputStream(out);

        try {
            Transformer trans = TransformerFactory.newInstance().newTransformer();
            trans.transform(msg, sr);

            // Use out to your heart's desire.
        }
        catch (TransformerException e) {
            e.printStackTrace();
        }    

        return msg;
    }
} 
```

我最终不需要这个解决方案，所以我自己并没有真正尝试过这个代码——它可能需要一些调整才能正确。但我知道这是从 Web 服务获取原始 XML 的正确途径。

（如果您绝对必须有一个 SOAPMessage 对象，我不确定如何进行这项工作，但话又说回来，如果您要处理原始 XML，为什么要使用更高级别的对象？）

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-09-11T09:42:23.247

仅出于调试目的，请使用一行代码-

`msg.writeTo(System.out);`

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-12-04T16:28:44.770

如果您需要将 xml 字符串格式化为 xml，请尝试以下操作：

```
String xmlStr = "your-xml-string";
Source xmlInput = new StreamSource(new StringReader(xmlStr));
Transformer transformer = TransformerFactory.newInstance().newTransformer();
transformer.setOutputProperty(OutputKeys.INDENT, "yes");
transformer.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "2");
transformer.transform(xmlInput,
        new StreamResult(new FileOutputStream("response.xml"))); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-06-22T20:10:20.073

使用变压器工厂：-

```
public static String printSoapMessage(final SOAPMessage soapMessage) throws TransformerFactoryConfigurationError,
            TransformerConfigurationException, SOAPException, TransformerException
    {
        final TransformerFactory transformerFactory = TransformerFactory.newInstance();
        final Transformer transformer = transformerFactory.newTransformer();

        // Format it
        transformer.setOutputProperty(OutputKeys.INDENT, "yes");
        transformer.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "2");

        final Source soapContent = soapMessage.getSOAPPart().getContent();

        final ByteArrayOutputStream streamOut = new ByteArrayOutputStream();
        final StreamResult result = new StreamResult(streamOut);
        transformer.transform(soapContent, result);

        return streamOut.toString();
    } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-04-13T12:32:44.707

这行得通

```
 final StringWriter sw = new StringWriter();

try {
    TransformerFactory.newInstance().newTransformer().transform(
        new DOMSource(soapResponse.getSOAPPart()),
        new StreamResult(sw));
} catch (TransformerException e) {
    throw new RuntimeException(e);
}
System.out.println(sw.toString());
return sw.toString(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-17T15:20:02.443

如果您有客户端代码，则只需添加以下两行即可获取 XML 请求/响应。这里`_call`是`org.apache.axis.client.Call`

```
String request = _call.getMessageContext().getRequestMessage().getSOAPPartAsString();
String response = _call.getMessageContext().getResponseMessage().getSOAPPartAsString(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-13T17:37:59.760

这是很老的线程，但最近我遇到了类似的问题。我正在从一个休息服务调用一个下游肥皂服务，我需要按原样返回来自下游服务器的 xml 响应。

所以，我最终添加了一个 SoapMessageContext 处理程序来获取 XML 响应。然后我将响应 xml 作为属性注入到 servlet 上下文中。

```
public boolean handleMessage(SOAPMessageContext context) {

            // Get xml response
            try {

                ServletContext servletContext =
                        ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest().getServletContext();

                SOAPMessage msg = context.getMessage();

                ByteArrayOutputStream out = new ByteArrayOutputStream();
                msg.writeTo(out);
                String strMsg = new String(out.toByteArray());

                servletContext.setAttribute("responseXml", strMsg);

                return true;
            } catch (Exception e) {
                return false;
            }
        } 
```

然后我在服务层检索了 xml 响应字符串。

```
ServletContext servletContext =
                ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest().getServletContext();

        String msg = (String) servletContext.getAttribute("responseXml"); 
```

还没有机会对其进行测试，但这种方法必须是线程安全的，因为它使用的是 servlet 上下文。

# ruby-on-rails - How to manage table without id in Rails?

> ID：522408
> 
> 赞同：3
> 
> 时间：2009-02-06T22:06:42.910
> 
> 标签：ruby-on-rails

I have two models: Person and Relation. The second one stores information about relations between two people. It has parent_id and child_id fields and doesn`t have id field. I connected it with has_many :through and it works.

But:

1.  Relation.find(:all) returns empty array even if there are some relations in the table (becouse there is no id field).
2.  I don`t know how to delete relation.

My models looks like this:

```
class Person < ActiveRecord::Base
  has_many :child_relations, 
           :class_name => "Relation", 
           :foreign_key => "parent_id"
  has_many :parent_relations, 
           :class_name => "Relation", 
           :foreign_key => "child_id"

  has_many :children, :through => :child_relations
  has_many :parents, :through => :parent_relations
end

class Relation < ActiveRecord::Base
  belongs_to :parent, :class_name => "Person"
  belongs_to :child, :class_name => "Person"
end 
```

Any suggestions?

UPDATE: I've used **has_many :through** becouse I also store information about a type of the relation in the table. Currently I gave up and I added id field to my table (Rails convention...). But my question remains open.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T22:21:50.680

has_many :through depends on an id in the join table. It makes the join table a whole model. Since every operation with records happens with an id, you wont be able to directly interface with a table without it. When you delete a record rails generates sql to delete the record by its id. **If you have a join table that acts as a full model, it must have an id**

Or you can use `has_and_belongs_to_many` which works more like you expect. The remove a relationship you remove the object via its assocations and not directly with the relationship model.

Your best bet is to add an ID to the join table. That way in the future if the relationship model becomes more complex you can track it as its own entity.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T01:16:14.417

This should give you a step in the right direction. I am not at a rails prompt to test it, but it should be pretty quick to set up a model and try it. Hope it helps!

```
class Relation < ActiveRecord::Base
  belongs_to :parent, :class_name => "Person", :foreign_key => :parent_id
  belongs_to :child, :class_name => "Person", :foreign_key => :child_id
end

class Person < ActiveRecord::Base
  has_many :relations
  has_many :children, :through => :relations
  has_many :parents, :through => :relations
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T17:15:56.567

I've successfully used the has_and_belongs_to_many in this situation. The join table only has foreign keys, no id key. One important thing is that you don't have a model for the Relations table, just the two has_and_belongs_to_many references in the Person class

[Here is a good thorough treatment on Has and belongs to many](http://ramblings.gibberishcode.net/archives/rails-has-and-belongs-to-many-habtm-demystified/17)

# windows-vista - 如何获得 NANT zip 任务的输出以在 XP 上解压缩？

> ID：522421
> 
> 赞同：1
> 
> 时间：2009-02-06T22:11:17.033
> 
> 标签：windows-vista, windows-xp, zip, nant

我在我的 Vista 开发机器上编写了以下 Nant 脚本，并且对 Nant zip 任务的输出感到满意，因为我可以在遇到任何问题时解压缩它：

```
<zip zipfile="${dir.build}CeoConfigUtilities.${build-version}.zip">
   <fileset basedir="${dir.configutilities}" prefix="CeoConfigUtilities">
      <include name="**" />
   </fileset>
</zip> 
```

我将 Nant 脚本签入到 SVN 中，并且构建服务器毫无问题地压缩了我的文件。我测试并发现我也可以在我的 Vista 机器上解压缩这些文件。Life和Nant很好，对吧？好吧，其他人在 Windows XP Pro 上解压缩这些文件时会收到以下消息：

> 压缩（zipped）文件夹无效或损坏。

我将在我的机器上生成的文件带到 XP 机器上并得到了相同的消息。我注意到的一个区别是，当我使用 XP 的内置工具打开 zip 文件时，它显示每个文件的压缩率为 100%。在 Vista 上使用 jZip，每个文件都有不同的、非 100% 的比例。

有没有人经历过这样的事情？是否有一些我不知道的设置可以使 Nant zip 任务的输出在 XP 上解压缩？Nant 对我来说工作得很好，如果这个愚蠢的解压缩问题让 XP 用户搞砸了，我会很失望。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-07T19:07:59.323

我发现我的问题的答案不在于 Nant 脚本，而在于版本不兼容，我认为通过程序集版本重定向来解决这个问题很聪明。这教会了我认为我很聪明！

事实证明，我使用的 Nant 发行版（已签入 StructureMap SVN 存储库的发行版）包含两个不同版本的 SharpZipLib。在 lib 中，SharpZipLib.dll 的版本为 0.85.5.452。在 lib\common\neutral 中，SharpZipLib.dll 的版本为 0.85.1.271。添加 zip 任务会产生程序集绑定错误，因此我在 Nant.exe.config 中添加了以下内容：

```
<dependentAssembly> 
   <assemblyIdentity name="ICSharpCode.SharpZipLib" publicKeyToken="1b03e6acf1164f73" culture=""/>
   <bindingRedirect oldVersion="0.85.1.271" newVersion="0.85.5.452"/>
</dependentAssembly> 
```

我以为 DLL Hell 已经死了，我还以为我已经超越了我们现在所处的任何新地狱。事实证明，我应该简单地将lib\commmon\neutral 中的**旧版本复制到 lib 中的****新版本**上。

现在我的构建服务器生成可以在 XP 上解压缩的文件。

# architecture - 什么时候应该构建 Web 应用程序而不是胖客户端？

> ID：522422
> 
> 赞同：9
> 
> 时间：2009-02-06T22:12:23.367
> 
> 标签：architecture, web-applications, thick-client

我想听听其他人关于何时应该构建 Web 应用程序而不是构建胖客户端的建议。

在过去的几年里，我参与了几次关于是否应该使用 Web 浏览器界面构建应用程序（或升级旧应用程序）的讨论。通常这些是组织内部使用的系统，而不是大众市场的收缩包装产品，而且它们实际上不在公共互联网上。不过，我不想将讨论仅限于这些类型的应用程序。

有一个应用程序应该是一个或另一个的明显情况（例如，没有基于 Web 的视频编辑软件）。另一方面，Javascript 库正在让浏览器中更丰富的体验变得更容易实现。

Javascript 库和高级服务器端技术是否让诸如右键单击上下文菜单、拖放等操作可以在客户端轻松实现？在什么时候为 Web 编写额外的复杂性会覆盖诸如易于部署和跨平台兼容性之类的好处，特别是如果您不尝试创建下一个 Stack Overflow，而只是构建一个内部应用程序？

内部应用程序拥有有限且被俘虏的受众这一事实是否或多或少地覆盖了对胖客户端可以提供的改进可用性的任何担忧？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T22:15:22.033

当我不想这样做时，我会使用 Web 应用程序：

**- 支持一千种环境，每个环境都有自己的怪癖。** 具体来说，病毒、木马、软件干扰，并使其在任何地方都一样工作。

**- 担心应用升级和接听大量电话**

**- 处理丢失数据的客户**

当每个事务的计算密集，或者每个事务有大量数据传输时，我会选择一个胖客户端。

我喜欢通过一次升级解决每个人的问题。它可能不适合所有人，但它是我的生活质量和我为之工作的人提高的地方。让一个 Web 应用程序在几个不同的浏览器上运行可能比在不同条件下使用大量不同的操作系统更容易。

随着 Flex/Air 的出现，您可以在浏览器中提供完整的应用程序体验。浏览器正在成为通用界面，无论是安装在本地还是在云端。

Web 应用程序也有其缺点。我只是更有动力构建网络应用程序，因为专业人士似乎超过了我选择的项目的缺点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T23:01:03.160

我相信我们仍然处于这样的地步，除非有理由让它成为一个 Web 应用程序，否则它应该是一个本地应用程序（厚）。很明显它应该是一个网络应用程序。我的一个烦恼是认为它应该是一个网络应用程序，除非它很明显应该是本地的。我不相信我们处于企业愿意让他们的员工依赖于他们无法控制的 Web 应用程序的地步。对于公司内部的应用程序，我认为数据移动、安全性和部署/升级是决定的关键因素。

应用程序出现在网络上的几个关键原因。

1.  无论您使用什么计算机，应用程序和数据都需要跟随您。
2.  数据需要集中，需要传输给客户端的数据量是合理的。

使用厚应用程序的几个原因：

1.  使用本地资源的实用程序。
2.  对数据进行大量一次性处理的应用程序。
3.  与网络断开连接时需要访问数据的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T23:12:47.830

我记得在过去部署不基于 Web 的内部应用程序的糟糕日子中的事情：总是至少有一台计算机设置得如此不同以至于升级无法正常工作。有时更多，并且每台无法工作的机器的问题都不同。总是有一个用户拒绝安装升级，直到被管理层强制（通常是几周或几个月后）。这有时会导致数据出现问题，因为没有执行新的业务规则。

# python - 有没有办法循环遍历 Python 中列表的子部分

> ID：522430
> 
> 赞同：3
> 
> 时间：2009-02-06T22:15:20.927
> 
> 标签：python, loops, list

所以对于一个有 1000 个元素的列表，我想从 400 循环到 500。你是怎么做的？

我看不到使用 for each 和 for range 技术的方法。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-06T22:17:21.733

```
for x in thousand[400:500]:
    pass 
```

如果您使用的是可迭代而不是列表，则应使用[itertools](http://docs.python.org/library/itertools)：

```
import itertools
for x in itertools.islice(thousand, 400, 500):
    pass 
```

如果需要循环`thousand[500]`，则使用 501 作为后一个索引。即使`thousand[501]`不是有效的索引，这也会起作用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T22:16:58.037

```
for element in allElements[400:501]:
     # do something 
```

这些是[切片](http://docs.python.org/reference/expressions.html#id8)并生成整个列表的子列表。它们是 Python 的主要元素之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T18:08:58.863

使用

```
for element in allElements[400:501]:
    doSomething(element) 
```

使 Python 创建新对象，并可能对内存使用产生一些影响。

相反，我会使用：

```
for index in xrange(400, 501):
    doSomething(allElements[index]) 
```

这种方式还使您能够在迭代期间操作列表索引。

编辑：在 Python 3.0 中，您可以使用`range()`而不是`xrange()`，但在 2.5 和更早版本中`range()`创建一个列表，同时`xrange()`创建一个生成器，这会占用更少的宝贵 RAM。

# sql - 处理许多按要求排序的统计数据库列

> ID：522434
> 
> 赞同：0
> 
> 时间：2009-02-06T22:15:57.853
> 
> 标签：sql, sql-server, statistics

对于我目前的项目，我们想要展示统计数据并对其进行排名。就我而言，我正在谈论艺术家的“收藏”，计算艺术家曲目的播放次数，显示艺术家曲目已添加到播放列表中的播放列表的计数......这些都是非常特定于域的问题，但这是我的问题的一个具体例子。

主要问题是我将返回按顺序返回的所有这些统计属性的结果集。

这里有些例子：

*   音乐登陆页面应显示最受喜爱的前 5 位艺术家。
*   音乐登陆页面应显示播放次数最多的前 5 首曲目。

我的第一个想法是确定我需要一个计算聚合列。由于我想对这些值进行排序，这意味着对于我想要排序的每个聚合，一个 CLUSTERED INDEX 将是最佳的。其次，由于 CLUSTERED INDEX 列上的 DML 在插入时不连续时可能代价高昂，因此我需要将此作为计划作业。

所以，对于艺术家最喜欢的统计数据，这是我想出的 DDL。注意到我的 T-SQL 可能非常糟糕，但我认为意图很明确。

```
CREATE TABLE Stats_ArtistFavourites (
    FavouriteCount INT DEFAULT 0,
    ArtistId INT PRIMARY KEY NONCLUSTERED,
    FOREIGN KEY (ArtistId) REFERENCES Artists
)

CREATED CLUSTERED INDEX IDX_Favourites 
ON Stats_ArtistFavourites (FavouriteCount, ArtistId) DESC 
```

如您所见，我需要为我想要跟踪的每个统计信息创建一个单独的表，否则我将不得不对不在 CLUSTERED INDEX 中的列进行排序。这看起来很丑陋的事实让我觉得我做错了。

我是否应该开始考虑集成 OLAP（我对 OLAP 多维数据集的经验很少）？或者也许是 Lucene？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T22:23:48.383

通过普通索引进行扫描类似于连接，因为普通索引包含一个索引值以及对每个叶子中的表块的引用。要提取非索引值，您需要通过此块引用“加入”表。

相反，聚集索引包含每个叶子的表数据本身，您可以在扫描时获得非索引字段值。

只要选择前 5 条记录，就可以使用普通索引，因为一张表总是更易于管理。

它会比集群索引慢一点，因为这意味着上面描述的“连接”，但它只有 5 条记录，你几乎不会注意到任何区别。

您甚至可以这样创建统计表：

```
CREATE TABLE stats (type INTEGER, score INTEGER, artist INTEGER);
CREATE INDEX ix_stats (type, score); 
```

，这将帮助您更轻松地添加新的聚合值。

`1`因为`type`这里可以表示艺术家有多少次，他有多少次`played`等等。当您需要新的聚合时，您只需在表中创建一个新类型和 5 个新行，而不是更改其定义。`2``favorited``INSERT`

同样，如果我理解您的任务，我们正在讨论从该表中选择数十条记录。在这种情况下，可管理性比选择前 5 名艺术家快 10 毫秒更重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T03:21:57.763

您是否考虑过使用 RANK？您可能会对性能感到惊讶。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T22:25:46.817

您可能会探索索引视图。 [http://technet.microsoft.com/en-us/library/cc917715.aspx](http://technet.microsoft.com/en-us/library/cc917715.aspx)

*   聚合可以预先计算并存储在索引中，以最大限度地减少查询执行期间的昂贵计算。
*   可以预先加入表并存储结果数据集。
*   可以存储连接或聚合的组合。

第一点看起来像你所追求的。

# html - 如何让标签之间的空格不显示？

> ID：522435
> 
> 赞同：5
> 
> 时间：2009-02-06T22:15:59.803
> 
> 标签：html, css

我正在尝试使用锚标签创建一个菜单，它们应该彼此相邻，因此相关链接可以用边框连接。这是一些示例代码：

```
<html>
<head>
    <style type="text/css">
        a {
            border: 1px solid #939393;
            margin: 15px;
            padding: 8px;
        }
        a:hover {
            border-color: #111;
        }
        a.collapse-left {
            border-left-width: 0px;
            margin-left: 0px;
        }
        a.collapse-right {
            border-right-width: 0px;
            margin-right: 0px;
        }

    </style>
</head>
<body>
    <div class="body">
        <a href="#" class="collapse-right primary">This is</a>
        <a href="#" class="collapse-right collapse-left click">A group</a>
        <a href="#" class="collapse-left hover">Of Three</a>

        <a href="#" class="">I am by myself</a>

        <a href="#" class="collapse-right">We are</a>
        <a href="#" class="collapse-left">a pair</a>

    </div>
</body>
</html> 
```

组合在一起的按钮之间有一些空白。这是由`<a>`标签之间的换行引起的。可以删除这些换行符，问题就消失了，但代码的可读性要差*得多。*

是否可以保留换行符但不显示空白？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T22:23:20.287

您应该通过将 CSS 更改为以下内容来将框变成块`<a>`：

```
a {
    border: 1px solid #939393;
    margin: 15px;
    padding: 8px;
    display: block;
    float: left;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T22:26:17.503

不理想，但它有效并且比将它放在一条线上更好：

```
<a href="#">First link</a><!--
--><a href="#">Second link</a><!--
--><a href="#">Third link</a> 
```

请注意，我通常会使用列表标记进行站点导航以避免此类问题，但上述解决方案解决了一般的空白问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T22:26:48.063

我认为内联元素（span，em，a）在它们周围流动文本空白，而块级元素则没有（P，h1，div）。

为了创建导航栏，我通常将链接包装在无序列表的列表项中，并给出`float:left`强制的 li，`display:block`然后它们通常会彼此相对。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T22:23:36.730

不，锚之间的空间被合并为一个，它们出现在你的锚之间，因为它们都在一条“线上”在一起（即使该线跨越源代码中的多行）。更好的方法是使用样式化的无序列表。但是，在 IE 中（我认为只有 IE6，但也可能是 IE7），您仍然会得到带有列表项的空白。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T22:28:06.673

我对列表也有同样的问题。我找到的解决方案（并且完全有效）是将右括号放在下一个开始之前，我想您也可以使用**a**元素来做到这一点：

```
 <a href="#" class="collapse-right primary">This is</a
    ><a href="#" class="collapse-right collapse-left click">A group</a
    ><a href="#" class="collapse-left hover">Of Three</a> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T22:29:24.813

```
 <div class="body">
    <a href="#" class="collapse-right primary">This is</a
    ><a href="#" class="collapse-right collapse-left click">A group</a
    ><a href="#" class="collapse-left hover">Of Three</a>

    <!--alternate way.-->
    <a href="#" class="">I am by myself</a><
    a href="#" class="collapse-right">We are</a><
    a href="#" class="collapse-left">a pair</a>

</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T22:42:26.923

使用跨度来包含您的链接集将有助于减少在锚点上放置类名的需要（在该悬停中不是跨浏览器在 IE6 上不起作用但可接受的 IMO）：-

```
<html>
<head>
    <style type="text/css">

        span.linkSet { border: 1px solid #939393; margin: 15px; padding: 8px }
        span.linkSet:hover {border-color: #111; }

    </style>
</head>
<body>
    <div class="body">

        <span class="linkSet">
            <a href="#" >This is</a
            ><a href="#" >A group</a
            ><a href="#" >Of Three</a>
        </span>

        <span class="linkSet">
            <a href="#">I am by myself</a>
        </span>

        <span class="linkSet">
            <a href="#" >We are</a
            ><a href="#" >a pair</a>
        </span>

    </div>
</body>
</html> 
```

# javascript - Qunit 参数化测试和模拟

> ID：522437
> 
> 赞同：35
> 
> 时间：2009-02-06T22:16:53.670
> 
> 标签：javascript, qunit

我有两个问题：

您可以在 qunit 中进行参数化单元测试吗？

您如何使用 qunit 进行模拟，例如模拟`getJSON`呼叫？

谢谢

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2010-01-24T09:07:08.413

对于模拟 ajax 请求，您可以尝试这样的事情......

这是您要测试的功能：

```
 var functionToTest = function () {
        $.ajax({
            url: 'someUrl',
            type: 'POST',
            dataType: 'json',
            data: 'foo=1&foo=2&foo=3',
            success: function (data) {
                $('#main').html(data.someProp);
            }
        });
    }; 
```

这是测试用例：

```
 test('ajax mock test', function () {
        var options = null;
        jQuery.ajax = function (param) {
            options = param;
        };
        functionToTest();
        options.success({
            someProp: 'bar'
        });
        same(options.data, 'foo=1&foo=2&foo=3');
        same($('#main').html(), 'bar');
    }); 
```

它本质上覆盖了 jQuery 的 ajax 函数，然后检查以下两件事： - 传递给 ajax 函数的值 - 调用成功回调并断言它做了它应该做的事情

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-16T15:01:35.223

除了重写 jQuery 的 AJAX 函数，您还可以使用 .appendTo 开发的 jQuery Mockjax 插件。这个插件基本上做了其他答案的建议，但它允许更复杂的模拟。例如，如果您具有以下功能：

```
$.ajax({
    url:"/api/user",
    type:"GET",
    dataType:"json",
    data:'{"uid":"foobar"}',
    success:function(data){
        console.log("Success!");
    },
    error:function(data){
        console.log("Error!");
    }
}); 
```

您可以通过简单地调用函数 mockjax 来使用 mockjax 模拟它，该函数自动包含在 jQuery 中：

```
$.mockjax({
    url:"/api/user",
    type:"GET",
    response:function(requestData){
         //handle the mock response in here
         this.responseText = '{"fullname":"Mr. Foo Bar"}';
    }
}); 
```

第二个模拟函数可以包含在外部 JavaScript 文件中，例如“mocks.js”，唯一需要做的其他事情是包含 mockjax 库（可以在[https://github.com/appendto找到/jquery-mockjax/](https://github.com/appendto/jquery-mockjax/)）。唯一要记住的是，这只会模拟 jQuery ajax 调用，而不是所有 XMLHttpRequest。如果您想这样做，请遵循 @bertvh 的建议并使用 Sinon.js。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-02-21T23:59:32.010

我刚开始使用[Sinon.JS](http://sinonjs.org/)，它允许模拟 XMLHttpRequests 并且还提供了一个简单的假服务器 API。真的很容易使用！它还提供与 qunit 的集成。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-15T10:20:53.670

我的插件实现允许参数化 qunit 测试： [https ://github.com/AStepaniuk/qunit-parameterize](https://github.com/AStepaniuk/qunit-parameterize)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-18T13:34:21.297

请参阅此链接以在您的 setup/teardown 方法中模拟 getJSON 调用， [http: //www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=505](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=505)

# parallel-processing - 为什么摩尔定律需要并行计算？

> ID：522438
> 
> 赞同：13
> 
> 时间：2009-02-06T22:16:57.460
> 
> 标签：parallel-processing, moores-law

这是我的一本 CS 教科书中的一个问题。我很茫然。我不明白为什么它必然会导致并行计算。有人想指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-06T23:12:19.297

Moore's law just says that the number of transistors on a reasonably priced integrated circuit tends to double every 2 years.

Observations about speed or transistor density or die size are all somewhat orthogonal to the original observation.

Here's why I think Moore's law leads inevitably to parallel computing:

If you keep doubling the number of transistors, what are you going to do with them all?

*   More instructions!
*   Wider data types!
*   Floating Point Math!
*   More caches (L1, L2, L3)!
*   Micro Ops!
*   More pipeline stages!
*   Branch prediction!
*   Speculative execution!
*   Data Pre-Fetch!
*   Single Instruction Multiple Data!

Eventually, when you've implemented all the tricks you can think of to use all those extra transistors, you eventually think to yourself: why don't we just do all those cool tricks TWICE on the came chip?

Bada bing. Bada boom. Multicore is inevitable.

* * *

Incidentally, I think the current trend of CPUs with multiple identical CPU cores will eventually subside as well, and the real processors of the future will have a single master core, a collection of general purpose cores, and a collection of special purpose coprocessors (like a graphics card, but on-die with the CPU and caches).

The IBM Cell processor (in the PS3) is already somewhat like this. It has one master core and seven "synergistic processing units".

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-06T22:43:31.087

一个字——[热](http://blog.wired.com/gadgets/2008/09/battling-the-co.html)。

由于无法在当前晶体管水平上散热，工程师们正在利用他们不断增长的晶体管预算来创建更多内核，而不是创建更复杂（和热）的管道和更快的处理器。

摩尔定律根本不是死摩尔定律[是关于在给定成本下的晶体管密度](http://en.wikipedia.org/wiki/Moore's_law)。碰巧的是，出于各种原因（如营销），工程师决定使用他们的晶体管预算来增加时钟周期。现在他们决定（因为热量问题）开始使用晶体管进行并行处理，加上 64 位计算和降低功耗。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-06T22:22:13.267

摩尔定律描述了由于在电路板上添加更多晶体管而导致芯片性能有效翻倍的趋势。

由于设备的尺寸没有增加（如果相反的话），那么很明显，这些额外的晶体管的空间只是由于芯片技术变得更小和制造变得越来越好而变得可用。

但是，在某些时候，您会到达无法进一步最小化晶体管的阶段。由于产生的热量和所涉及的制造成本，将芯片的尺寸增加到超过某个点也变得不可能。

这些限制需要一种提高性能的方法，而不仅仅是生产更复杂的芯片。

一种这样的方法是在并行架构中使用更便宜、更简单的芯片，另一种是从传统的集成芯片转移到像量子计算这样的东西——根据它的定义，它就是并行处理。

值得注意的是，这个问题的标题更多地与观察到的定律结果（性能提升）有关，而不是实际定律本身，后者主要是对晶体管数量的观察。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-06T22:51:58.560

I think it is a reference to the [free lunch is over](http://www.gotw.ca/publications/concurrency-ddj.htm) article

basically, the original version of Moore's law, about transistor density, still holds. But one important derived law, about processing speed doubling every xx months, has hit a wall.

So we are facing a future where processor speeds will go up only slightly but we will have more core's and cache to play with.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-06T22:21:54.423

这是一个奇怪的问题。摩尔定律不需要任何东西，它只是观察计算能力的进步，它并没有规定它必须以一定的速度增加。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-06T22:20:44.770

提高处理器的速度会使工作温度变得非常高，以至于会在您的办公桌上烧出一个洞。芯片制造商正面临着他们无法绕过的某些限制……例如光速。并行计算将使他们能够在不引起火灾的情况下加速计算机。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-06T22:21:43.910

晶体管和 cpu 之类的东西越来越小，越来越快。唉，计算的热量和电压成本正在上升。热量和电压问题与实际物理尺寸最小值一样令人担忧。100ghz 芯片会吸收太多电压并变得太热，但 100 个 1ghz 芯片对此问题较少。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-21T01:03:06.947

有趣的是，在“必须”并行计算的问题中提出的想法受到了阿姆达尔定律的质疑，该定律基本上说，除非你的程序 100% 是可并行化的，否则拥有并行处理器只会让你走这么远（从来都不是这样）在现实世界）。

例如，如果您有一个程序需要在一个处理器上运行 20 分钟并且可并行化 50%，并且您购买了大量的处理器来加快速度，那么您的最短运行时间仍将超过 10 分钟。这是忽略了所涉及的成本和其他问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T22:56:55.367

The real answer is completely un-technical, not that the hardware explanations aren't fantastic. It's that Moore's Law has become less and less of an observation, and more of an expectation. This expectation of computers growing exponentially has become the driving force of the industry, which necessitates all the parallelism.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T23:08:18.043

Moore's law says that the number of transistors in an IC relative to cost increases exponentially year on year.

Historically, this was partly due to a decrease in transistor size, and smaller transistors also switched faster. Because you got faster transistors in step with Moore's law, clock speed increased. So there's a confusion that say Moore's law means faster processors rather than just wider.

Heat dissipation caused the speed increase to top out at around 3 GHz for economically produced silicon.

So if you want more cheap computation, it's easier to add more, slower circuits. So the current state-of-the-art commodity processors are multi-core - they are getting wider, but no faster.

[Graphene film transistors](https://www.technologyreview.com/computing/21889/?a=f) require less power, and are performing at around 30 GHz, with theoretical limits at around 0.6 THz.

When graphene technology matures to commodity level in a few years, expect there to be another sea change and no-one will care about using parallel cores for performance, and go back to narrow, fast cores. On the other hand, concurrent computing will still matter for the problems it is a natural fit for, so you'll still have to know how to handle more than one execution unit though.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-06T22:19:42.260

因为正交计算失败了。我们应该去[量子](http://en.wikipedia.org/wiki/Quantum_computing)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-06T22:53:32.427

Moore's law necessitates parallel computing because [Moore's law is on the verge of/is dead](http://www.techworld.com/opsys/news/index.cfm?newsid=3477). So taking that into consideration, if it is becoming harder and harder to cram transistors onto an IC (due to some of the reasons noted elsewhere) then the remaining options are to add more processors ala Parallel processing or go Quantum.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-06T23:28:26.007

摩尔定律仍然成立。晶体管数量仍在增加。问题在于找出对所有这些晶体管有用的东西。我们不能仅仅通过使流水线更深更宽来不断增加指令级并行性，因为证明指令之间独立性所需的电路在你需要证明独立性的指令数量上会显着增加。我们不能仅仅因为热量而不断提高时钟速度。我们可以继续增加缓存大小，但我们在这里遇到了收益递减点。晶体管的唯一用途似乎是将更多内核放在芯片上，这意味着工程师弄清楚如何处理晶体管的工作只是推高了抽象阶梯，现在程序员必须弄清楚该怎么做与所有这些核心。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-21T01:09:44.500

我不认为摩尔定律*需要*并行计算，但它确实需要最终从纯粹的小型化转变。存在多种解决方案。其中一个是并行计算，另一个是协同处理（这是真实的，但与并行计算不同。协同处理是将工作卸载到 GPU、DSP 等专用 CPU 时。）

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-02-06T22:21:38.777

老实说，我真的不知道，但我的猜测是晶体管在某些时候不会变得更小，需要并行分布处理能力。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-02-06T23:20:12.230

It's because we're all addicted to increasing speed in our processors. Years of conditioning have led us to expect more processing power, year after year. But the physical constraints caused by densely packed transistors have finally put a limit on clock speeds, so increases have to come from a different perspective.

It doesn't have to be this way. The success of the Intel Atom processor shows that processors could just get smaller and cheaper instead. The processor companies will try to keep us on the "bigger, faster" treadmill though, to keep their profits up. And we'll be willing participants, because we'll always find a way to use more power.

# php - 如何在 php 中进行 URL 重写？

> ID：522452
> 
> 赞同：1
> 
> 时间：2009-02-06T22:20:08.513
> 
> 标签：php, html, url-rewriting

这是一个双重问题：正确答案将转到“您如何在 PHP 中做到这一点”，解释是否有任何优势，如果可能的话也很重要。

我只是好奇，因为我真的不知道，我在网页上看到了很多。

编辑：我不知道技术名称，但例如在 Stackoverflow 上：“ `http://stackoverflow.com/posts/edit/522452`”是我所说的*“文件夹”*（以前在问题标题中使用的术语）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T22:33:05.837

如果您指的是`/posts/edit/522452`-style URLs 而不是`/posts.asp?action=edit&postid=522452`-style URLs（或它在后端转换为的任何内容），这通常是通过 URL 重写器完成的，例如[`mod_rewrite`](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html). 该 URL 的规则可能如下所示：

```
RewriteRule ^/posts/(\w+)/(\d+) /posts.asp?action=\1&postid=\2 
```

这种 URL 的两个主要优点是：

1.  “文件夹”类型的 URL 更易于人们键入和记住。
2.  该页面“看起来像”HTTP 代理的页面。传统上，代理不会缓存带有参数的页面，因为它们不代表单独的内容并且更改过于频繁（想想搜索结果）。使用“文件夹样式”的 URL 可以正常缓存它们。

在 PHP 中，您可以通过`$_GET['action']`和访问这些选项`$_GET['postid']`，就像浏览器要求重写表单一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T22:47:37.930

要使用此类 URL，您必须执行三个步骤：

1.  告诉您网络服务器，这些请求应该重定向到您的 PHP 脚本。使用 Apache，您可以使用[mod_rewrite 模块](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)来执行此操作：

    ```
    重写引擎开启
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule !^index\.php$ index.php [L]

    ```

    该指令将每个与文件系统中的文件不匹配的请求重定向到`index.php`.

2.  获取您的脚本来解析这些 URL：

    ```
    $_SERVER['REQUEST_URI_PATH'] = preg_replace('/\?.*/', '', $_SERVER['REQUEST_URI']);
    $segments = explode('/', trim($_SERVER['REQUEST_URI_PATH'], '/'));
    var_dump($segments);

    ```

    这可能是解析 URL 路径并获取每个路径段的最简单方法。

3.  在您的输出中使用此 URL。（琐碎的）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T22:38:12.503

正如其他人指出的那样，出于 SEO 目的、缓存和可读性的一部分，我想补充一点，文件夹样式的参数也是用户“玩弄”参数的动力。例如，在 Stackoverflow 上，当按标签过滤时，通常很想手动编辑 url，而不是寻找合适的按钮并单击它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T22:28:16.250

优点是可读性和可能在搜索引擎中更好的位置。

`mod_rewrite`如果您使用的是 Apache，您可以通过以下方式实现此目的。在 PHP 中，您还可以查看预定义的全局变量 - 我认为`$_SERVER['REQUEST_URI']`可行，但可能会有更好的全局变量。

在不重写的情况下使用纯 PHP 时，`.php`如果您适当地配置您的服务器，您也可以从脚本的文件名中删除 ，因此仍然可以获得“不错的”URL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T22:32:28.317

有几个原因，但主要是：

*   搜索引擎优化的目的。搜索引擎通常会忽略“？”之后的任何内容。问号符号，从而使您无法索引页面，或者更糟糕的是，根本没有索引。

*   可读性：

    ```
    www.somesite.com/products/devices/keyboards/20,asc
    www.somesite.com/products/devices/keyboards/20,asc.html 
    ```

    看起来比：

    ```
    www.somesite.com?show=products&cat=devices&sub_cat=keyboards&sort=asc&items=20 
    ```

*   缓存。

有关如何在 Apache 中执行此操作的信息： [http ://httpd.apache.org/docs/2.0/misc/rewriteguide.html](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)

# javascript - Javascript textRange错误

> ID：522462
> 
> 赞同：0
> 
> 时间：2009-02-06T22:22:28.820
> 
> 标签：javascript

谁能用 IE/javascript 中的 textRanges 解释“幕后”发生了什么？开始和结束位置实际上指向/参考什么？

我正在使用 textRanges 处理用户输入的数据。我根据数据中的回车创建了一个 textRanges 数组，每行一个。在我尝试将新字符串写入文本范围之前，每件事都按我的预期工作。

给定：rng[5].text 包含“数据行 5”

无论我使用： rng[5].text = 'new text' 还是 rng[5].pastHTML('new text') ，页面都会显示更改后的文本，但现在 rng[5].text 为空且 rng[ 5].select() 什么都不做。

我假设 textRange 的开始和结束位置保持对页面的位置引用，如果我有背靠背的 textRanges，增加第一个的文本会导致第二个的开始和结束重新调整.....或者至少，如果位置是绝对的，它会创建重叠范围......但似乎并非如此。

我意识到还有很多其他方法可以解析/处理一大块文本，但就 textRange 而言，我的错误是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T23:17:56.307

当您更改内容时，范围（和活动选择）将折叠到其端点，就像用户使用“粘贴”命令插入新内容一样。

如果要重新选择刚刚插入的文本段，请调用 range.moveStart('character', -n)，其中 n 是插入字符串的长度。然后根据需要调用 range.select() 。

（注意：范围处理换行符的方式非常不一致。如果您的字符串中有 '\r\n'，因为 IE 总是将虚假的 '\r' 插入文本区域，那么它只会算作一个字符moveStart/moveEnd 的目的。）

# search - 什么是“友好的 URL”？

> ID：522466
> 
> 赞同：57
> 
> 时间：2009-02-06T22:23:07.230
> 
> 标签：search, browser, seo, friendly-url

我最近（在本网站和其他地方）阅读了大量关于“友好 URL”的讨论，但我不确定究竟是什么使 URL “友好”以及为什么我们真的关心（直到某一点） . 插图：

以下是当前大多数 Web 开发人员认为“友好”的 URL 示例：

> www.myblog.com/posts/123/this-is-the-name-of-my-blog-post

而这将被认为是“不友好的”（即坏的、尼安德特人的、无知的、愚蠢的）：

> www.myblog.com/posts.aspx?id=123

我的问题：

*   “友好” URL 是否包含有关相关博客文章的重复标识信息？换句话说，一旦你有了帖子的 id (123)，为什么还需要标题？这不是违反“不要重复自己”的口头禅吗？
*   就用户而言，URL 的形式有什么不同？用户是否真的手动**输入**过完整的 URL（当然，除了 TLD 之外）？用户是否曾经查看页面的 URL 来确定该页面的内容？为什么我们在 URL 中需要博客文章的标题？这不就是页面的`<title>`标签和内容的用途吗？
*   我经常听到 SEO 是首选“友好”URL 形式的一个原因。为什么搜索引擎蜘蛛会关心 URL？它们不只是爬取页面（以及其中包含的其他页面的链接）的自动化软件吗？如果搜索引擎像其他软件组件（例如数据库访问组件）一样编写，那么 URL 对它们来说只是一个无意义的标识符（类似于关系数据库中的 rowguid）。如果我正在设计一个数据库模式，将上面的“友好”URL 作为表的主键，我会（非常正确地）被咀嚼。

我之前说过“在一定程度上”，因为很明显，URL 可能会失控。这是来自 Amazon.com 的实际 URL，我认为没有任何人会认为他们是“友好的”：

> [http://www.amazon.com/Bissell-Kitchen-Housewares/b/ref=amb_link_5001972_17?ie=UTF8&node=694500&pf_rd_m=ATVPDKIKX0DER&pf_rd_s=gp-center-5&pf_rd_r=1ZXNJFE0CCFFDH4B9HGH&pf_rd_t=101&pf_rd_p=405478901&pf_rd_i=510080](http://www.amazon.com/Bissell-Kitchen-Housewares/b/ref=amb_link_5001972_17?ie=UTF8&node=694500&pf_rd_m=ATVPDKIKX0DER&pf_rd_s=gp-center-5&pf_rd_r=1ZXNJFE0CCFFDH4B9HGH&pf_rd_t=101&pf_rd_p=405478901&pf_rd_i=510080)

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-02-06T22:37:29.383

Tim Berners-Lee（万维网的架构师）在大约 10 年前写[了一篇关于这个主题的精彩文章。](http://www.w3.org/Provider/Style/URI)

*   您的示例是一个错误的 URL - 但不仅仅是因为它同时具有 id 和“slug”（页面标题的缩写、连字符形式）。**从长远来看，将页面标题放入您的 URL 是有问题的。** 内容*会*随着时间而改变。如果您更改了该博客文章的标题，您将被迫在保留旧 URL 或更改 URL 以匹配新标题之间做出选择。更改 URL 将破坏该页面之前的任何链接；并且不更改它意味着您将拥有一个与页面不匹配的 URL。两者都对用户不利。最好只使用*www.myblog.com/posts/123*。

*   用户通常确实需要键入 URL，但更重要的是，有时他们还会编辑现有 URL 以查找您网站中的其他页面。因此，**拥有可发现的 URL 通常是件好事**。例如，如果我想查看帖子 #124，我可以轻松查看当前 URL，并确定我想查看的页面的 URL 是 www.myblog.com/posts/124。这是一种用户友好性水平，对于试图找到他们正在寻找的东西的人们来说是一个很大的帮助。包含其他信息（例如帖子的主题）会使这变得不可能——因此它减少了我的探索选择。

*   **忘记搜索引擎优化**。一段时间以来，搜索引擎技术一直在降低 SEO 黑客的有效性。好的内容仍然是王道——从长远来看，你将无法玩弄这个系统。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-06T23:58:45.320

对我来说，*友好的 URL*意味着有人尝试在 URL 中包含语义信息，以使其更适合人类消费。这是一个有趣的例子，说明计算机-计算机界面被增强和构建以制作更好的人机界面。

所以，在你的两个例子中：

*   `www.myblog.com/posts/123/this-is-the-name-of-my-blog-post`是友好的，因为您在 URL 中包含了标题 - 它*告诉*您有关页面的一些信息。
*   `www.myblog.com/posts.aspx?id=123`是不友好的，因为它神秘而晦涩：它对数据库非常有意义，但对你或我来说都没有。

友好的 URL 在某些情况下非常棒，而在其他情况下则毫无用处。基本上，如果用户要接触到它，我会优先考虑创建友好的 URL，这不仅仅是美学问题。如果您可以快速查看并了解各种选项是什么，则可以更轻松地从地址栏中返回 URL，此外，如果您正在关注来自网络的链接，它会使您要去的地方更加*明显*页。

将所有这些与 Firefox 3+ 中令人敬畏的栏（肯定也会出现在其他浏览器中）结合起来，当您处理友好的 URL 时，地址栏中的自动完成功能变得非常强大。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-06T22:29:13.300

关于查询字符串对爬虫的确切影响似乎有很多相互矛盾的信息，但共识是拥有多个参数会损害您的 SEO，因为长查询字符串变量表示动态内容，因此大多数搜索引擎会很多不那么激进地索引您的页面。

在您的 url 中添加一个 slug，例如您的示例*中的 this-is-the-name-of-my-blog-post*，也使您的链接与一个简单的 id 号相比更加不同，并在网址。这些都是搜索引擎寻找的东西。

就我个人而言，我发现这样的 url 更容易在视觉上解析，因为使用的标点符号较少，而且查询字符串中的名称-值对可能非常冗长且难以记住。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-06T23:58:17.740

关于如何在 URL 中放置不必要的信息，这是一个很好的观点。

```
http://stackoverflow.com/questions/522466/what-makes-a-friendly-url 
```

一旦唯一的 id 522466 已知 - 其余的都是无用的，所以它纯粹是为了使 URL 看起来“不错”，并为用户提供关于页面链接到什么的想法。但这会产生另一个问题。大多数网站不会“验证” URL 的那一部分，所以你可以放——

```
http://stackoverflow.com/questions/522466/omg-goatse-bought-by-bill-gates 
```

然而它仍然会链接到这篇文章。你可以看到这可能会导致*更多*的问题而不是它们的价值，因为它们可能被恶意使用。

我觉得 Digg 对此采取了正确的方法。他们不在其 URL 中使用 ID。在幕后，他们完全从给定的标题中获取数据库中的 ID。

```
http://digg.com/linux_unix/I_Like_Linux_so_my_aunt_sends_me_this_for_Christmas 
```

对我来说，这是一个**完美**的网址。它为我提供了在单击链接时感到安全所需的所有信息。

事实上，标题扮演着如此巨大的角色，以至于在 digg 的世界中，人们“盲目挖掘”纯粹是因为他们喜欢这个标题，或者对它感兴趣。如果您的网址看起来很有趣，那么您很可能会为您的网站获得更多流量。同时，您将使它对用户更友好、更漂亮，搜索引擎会感谢您。据我所知，友好的网址对每个人来说都是双赢的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-06T22:30:06.013

我对你的三颗子弹的看法：

*   我会说这不是最佳 URL。我不知道为什么要同时显示帖子标识符和标题。我的网址中根本不包含帖子 ID，只有标题和（有时）日期
*   对于用户来说，越短越好。
*   搜索引擎查看网址。不管是否有意义，他们都这样做了。在 URL 中包含关键字将提供一些 SEO 好处。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-06T22:28:01.620

我碰巧同意你的观点，但*嘘*不要告诉任何人。

这只是我的拙见，但对我来说似乎很愚蠢

```
http://stackoverflow.com/questions/522466/ 
```

和

```
http://stackoverflow.com/questions/522466/what-makes-a-friendly-url 
```

是同一页。我的意思是，我可以看到带连字符的问题标题为 URL 提供了一些上下文，但除非您知道该部分是可选的，否则 URL 只会不必要地变长。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-06T22:30:46.807

首先，它们对搜索引擎爬虫很友好。谷歌和其他人非常重视 url 中与页面上的单词匹配的单词，所以如果你的博客文章的标题在 URL 中，它将帮助你的搜索引擎榨汁。

其次，他们对不知道他们在访问什么的人很友好。如果您的 twitter/email/IM/etc 中出现了您用于比较的哪些链接，您更有可能点击它？

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-06T22:31:14.903

啊...诀窍是 URL 对谁友好。搜索引擎认为第一个 url 更友好，因为它显然在 URL 中包含内容信息，并且看起来不像使用不同参数重复相同的页面。

例如，比较

```
www.aTvShowSite.com/show.aspx?id=123
www.aTvShowSite.com/show.aspx?id=124 
```

机器人会说好吧，我不知道这些是什么……但它们对我来说看起来像同一页。

而比较

```
www.aTvShowSite.com/shows/AmericanIdol
www.aTvShowSite.com/shows/Lost 
```

使它们看起来像不同的页面（即使它可能是为它们提供服务的同一个 aspx 页面），并且机器人倾向于将它们排名更高。

编辑：此外，应该注意的是，许多机器人会查看 url 的文本以确定有用性，因此即使页面内容相同，搜索“Lost”可能会比第一种类型的 url 更多地命中第二种类型的 url。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-13T22:31:21.327

至于：

> *这不是违反“不要重复自己”的口头禅吗？*

那是指应用程序**代码！！**，而不是它自己的应用程序！

完全有道理

*   <title> 标签中的标题
*   在网址中
*   作为内容的第一行。

几乎所有其他地方的内容都需要它。

如果您的代码应如下所示，那么“口头禅”指的是什么：

```
 <title><%=obj.getTitle()%></title>
  Reading:<h1><%=obj.getTitle()%></h1>
  Link to this:<a href="getHrefFor( object.getTitle() )">obj.getTitle()</a>
  Etc. etc. 
```

而不是在您的应用程序周围使用不同的方法复制/粘贴代码。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-06T22:33:59.627

您显示的“不友好”URL 暴露了一个实现细节：如果将来某个时候您决定放弃 ASP 并使用其他东西怎么办？您将不得不更改所有 URL（糟糕！）或使用重命名方案。

在 URL 中重复标题可能不是必需的，但是当您进行大量链接粘贴时，它会很方便，以仔细检查您是否链接到正确的位置。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-06T22:47:21.783

我们的网站使用所谓的“不友好”URL，但我们会为特定位置创建特殊的“友好”URL，供公众用于特定功能，尤其是在印刷材料上。

例如，我们的停车罚单上有[http://www.dnv.org/parking](http://www.dnv.org/parking)。

CP

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-06T22:28:16.627

好吧，首先，尝试将字符与 (az,AZ,0-9) 分开，当然还有 :/._- 在 url 之外。不是每个人的键盘上都有所有这些（例如，我的键盘上没有 &，我也没有 ~）

例如，当做一些 url 解析或类似的事情时，如果 url 语法是“干净的”，也会有帮助

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-06T22:30:20.210

第二个 URL 看起来对用户更友好，而第一个 URL 看起来对搜索引擎友好。

搜索引擎与出现在 URL 中的词具有更高的相关性。域名获得最高（因为它不能改变），URL 的其余部分获得高优先级，因为长度有限，然后分析文档的正文。

我的回答是相当主观的，因为这取决于你是否对人类友好（易于手动输入，或阅读给朋友）或者你是否对搜索引擎友好（提高你的排名）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-06T22:39:02.360

在这种情况下，它并没有真正破坏 DRY 原则，因为就搜索引擎而言，“522466”与“what-makes-a-friendly-url”不同

通常对于像 StackOverflow 这样的网站，令牌是唯一重要的信息。通常你可以在那之后放任何你想要的东西，它会把你带到同一个地方（被网络服务器忽略）。

页面描述只是为了帮助搜索引擎识别页面的内容（这很好）

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-07T00:10:53.267

另一点：人们有时会手动编辑 URL，以便在目录树上向上。因此他们可能会尝试加载类似[http://site.com/a/b](http://site.com/a/b)的页面，得到“未找到”错误，然后尝试[http://site.com/a](http://site.com/a)或[http://site.com](http://site.com)。当然，如果您的 URL 不是基于实际的目录树，这可能行不通。但是你仍然可以尝试支持它。

一些浏览器甚至鼓励这样做，例如带有错误消息的 IE，以及带有在您右键单击页面标题时出现的菜单的 Safari。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-01-29T17:29:44.903

马特和@bigmattyh：搜索引擎优化不是“黑客”：它理解“好内容”在网络上的含义。页面标题是内容的一部分。链接中好的锚文本是“好的内容”（而不是使用像“点击这里”这样的词作为链接文本）。将链接放在上下文中而不是列表中是“好的内容”。

页面标题是唾手可得的果实，但它们仍然是改进 SERP 的最简单方法之一。是的，入站链接（及其质量​​）至关重要，但标题可以创造奇迹，尤其是在短期内。您不必使用页面标题（可能会不时更改）作为帖子标题：手动总结内容。

不要猜测这些东西：(a) 阅读 SEOmoz.org 等资源和 (b) 严格分析您自己的网站。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-04-12T11:55:44.653

术语**可读 url**也被大量使用。使用友好/可读的 url 是一种 SEO 诞生的技术，仅此而已。否则路径越短越好。执行重写规则通常**会减慢**将页面快速发送到客户端的过程，因此也要考虑到这一点。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-07-13T16:21:17.570

在我看来，ID 和 UUID 永远不应该成为 URL 的一部分，永远不要。

1) 一些 NoSQL 数据库根本不使用 ID，它们使用 UUID。UUID 很长，部分使用破折号分隔。Google 会将破折号视为单词分隔符：这意味着您的 url 将有 5 个以上无用的关键字。

2) 人类不理解 ID 或 UUID。一个人理解单词和说话的 URL。

3）如果标题发生变化，您可以像 WordPress 一样简单地进行重定向，就像 @TRiG 指出的那样。

4) 最后，记得使用日期，这样您就可以区分两篇标题相同但发布于不同年份、月份或日期的文章。例如，您可以对同一本书有两个评论（第一版和第二版）。

```
http://example.com/2013/02/11/data-mining-concepts-and-techniques 
```

和

```
http://example.com/2011/05/23/data-mining-concepts-and-techniques 
```

5) 日期还可以帮助任何用户确定内容是否是最近的。

6) 日期将为您的 URL 添加一个重要的关键字：年份。假设我想看看世界上最漂亮的女孩，我会在 Google 中输入：“2014 年世界上最漂亮的女孩”。我的网址将是：

```
http://example.com/2014/07/10/the-most-beatiful-girls-in-the-world 
```

7）最后但同样重要的是，Chrome会缓存您访问过的网站，因此您只需在地址栏中输入“女孩”即可找到上述网站。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-11-12T03:45:06.157

主题链接的内页在逻辑上相互配合。这是接收 URL 结构的最佳方式。

在不使用客户端网站的情况下，最好的例子是查看 BBC 网站，这是在最佳实践中完成的：

www.bbc.com/
www.bbc.com/news
www.bbc.com/news/world
www.bbc.com/news/world/australia

内页已正确组织。这是告诉搜索引擎如何在网站上移动的最佳做法。

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2016-07-01T07:42:25.447

术语可读 url 也被大量使用。使用友好/可读的 url 是一种 SEO 诞生的技术，仅此而已。否则路径越短越好。

# c# - 在对象中查找空白字段 - C#

> ID：522468
> 
> 赞同：4
> 
> 时间：2009-02-06T22:23:23.860
> 
> 标签：c#

我们有一个场景，如果源和目标之间存在实体，我们应该合并目标中的数据，即从目标列为空白的基础列复制值。

我们正在使用 WCF 服务调用，并且我们有实体对象。

如果我有一个实体，可以说`Staff`，工作人员包含名称等的基本属性，我们有一个`StaffAddress`、`StaffEmail`和的列表`StaffPhone`。

所以我只是想知道有没有办法使用 LINQ 或任何其他机制 - 我可以找出`Staff`对象上的属性列表是 null 还是空白？

一种基本方法当然是手动检查一个空白的属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-06T22:29:10.710

您可以通过反射获取所有属性，然后在每个 PropertyInfo 实例上调用 GetValue。如果它为空，您将返回 PropertyInfo：

```
static IEnumerable<PropertyInfo> GetNullProperties(object obj)
{
  // Get the properties and return only the ones where GetValue
  // does not return null.
  return 
    from pi in obj.GetType().GetProperties(
      BindingFlags.Instance | BindingFlags.Public)
    where pi.GetValue(obj, null) != null
    select pi;
} 
```

请注意，这将只返回该类型的公共属性，而不是非公共属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T22:33:55.193

这是使用 LINQ 的一种快速而肮脏的方法

```
public static IEnumerable<string> FindBlankFields(Staff staff)
{
    return staff.GetType()
        .GetProperties(BindingFlags.Instance | BindingFlags.Public |
            BindingFlags.NonPublic)
        .Where(p => p.CanRead)
        .Select(p => new { Property = p, Value = p.GetValue(staff, null) })
        .Where(a => a.Value == null || String.IsNullOrEmpty(a.Value.ToString()))
        .Select(a => a.Property.Name);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T22:33:33.137

您需要为此使用一些反射：

```
var unsetProperties = from prop in foo.GetType().GetProperties()
            let value = prop.GetValue(foo, null)
            where value == null || value.Equals(string.Empty)
            select prop.Name; 
```

# iphone - UIComboBox...它在哪里？

> ID：522480
> 
> 赞同：0
> 
> 时间：2009-02-06T22:26:36.753
> 
> 标签：iphone, cocoa-touch

所以我很确定我已经知道了这个问题的答案，但是 SDK 是否包括对移动 safari 中使用的组合框控件的访问？

建造一个应该很容易......但如果我不需要的话，我不想重新发明轮子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T22:28:42.163

不是内置的，没有。即使它们只是一个文本字段和一个 UITable 一起工作。

# html - 在表格单元格中放置一个 div

> ID：522492
> 
> 赞同：0
> 
> 时间：2009-02-06T22:28:53.503
> 
> 标签：html, css

我正在尝试将 DIV 元素放入表格单元格中，以一种`<div>`沿整个单元格区域传播的方式。但是，不知什么原因，`border`出现了一个 1px；据我所知，它既不是表格的一部分，也不是 div 的一部分（表格没有边框、填充或间距，div 没有边距或填充）。也许你能发现我的错误？

```
<html>
  <head>
    <style type="text/css">
      #arrow {
        border-style: solid;
        margin: 0;
        padding: 0;
        border-width: 100px 0px 100px 50px;
        border-color: blue blue blue red;
      }

      table {
        border-collapse: collapse;
        border-style: none;
        padding: 0px;
        spacing: 0px;
      }
    </style>
  </head>

  <body>
    <table>
      <tr>
        <td bgcolor="red">
          Blah,
        </td>
    <td>
      <div id="arrow"><!----></div>
    </td>
        <td bgcolor="blue">
          blah.
        </td>
      </tr>
    </table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T22:31:43.780

CSS 属性是“border-spacing”而不是“spacing”

另外我使用重置表

```
outline: 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T22:34:48.423

```
<table cellspacing="0" cellpadding="0" border="0"> 
```

- 或者 -

```
td { padding:0 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T23:55:04.533

为表格单元格添加样式：

```
 <html>
  <head>
    <style type="text/css">
      #arrow {
        border-style: solid;
        margin: 0;
        padding: 0;
        border-width: 100px 0px 100px 50px;
        border-color: blue blue blue red;
      }

      table {
        border-collapse: collapse;
        border-style: none;
        padding: 0px;}

        td  { padding:0; border:0;}

    </style>
  </head>

  <body>
    <table>
      <tr>
        <td bgcolor="red">
          Blah,
        </td>
    <td>
      <div id="arrow"><!----></div>
    </td>
        <td bgcolor="blue">
          blah.
        </td>
      </tr>
    </table>
</body>
</html> 
```

# internet-explorer - 测试IE在特定页面的渲染速度

> ID：522498
> 
> 赞同：1
> 
> 时间：2009-02-06T22:29:36.733
> 
> 标签：internet-explorer, language-agnostic, com, rendering

如果我的目标是通过重复加载测试特定网页在 IE 中的渲染速度（仅使用 javascript onload 事件进行计时并查看页面并不能削减它），那么有什么好方法呢？

我目前的尝试是在 VB 和 C# 中使用 IE WebBrowser 对象，尽管我愿意接受其他建议。

下面是一些简单的 VB 代码，虽然我在 C# 中尝试过类似的东西。我还尝试为每个测试创建一个新的 Web 浏览器控件（这让事情变得更糟）。我也尝试过使用事件本身而不是使用 readystate 循环。在所有情况下，测试都需要越来越长的时间来运行，尽管使用`reload`完全插入`navigate2`似乎有点帮助，也许暗示问题是某种历史问题。

```
For cnt = 1 To 100
    timer = GetTickCount()
    Form1.WebBrowser1.Navigate2 "http://www.example.com"
    While Form1.WebBrowser1.ReadyState <> READYSTATE_COMPLETE And GetTickCount() - timer < 5000
        Sleep 50
        DoEvents
    Wend
    Debug.Print GetTickCount() - timer
Next 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-15T16:54:23.287

我不确定你可以在控件上挂起什么事件来开始和结束，但这是我在单元测试中使用的代码，用于计算我的引擎处理我给它的数据所花费的时间。

```
Stopwatch stopWatch = new Stopwatch();

stopWatch.Start();
//perform work
stopWatch.Stop();

TimeSpan ts = stopWatch.Elapsed;
string elapsedTime = String.Format("{0:00}:{1:00}:{2:00}.{3:00}",
                                           ts.Hours,
                                           ts.Minutes,
                                           ts.Seconds,
                                           ts.Milliseconds/10);
Console.Write(elapsedTime); 
```

干杯!

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-19T02:39:05.650

我认为更好的方法是处理 Webbrowser 控件公开的 OnBeforeNavigate 和 OnDocumentComplete 事件。在 OnBeforeNavigate 中设置一个计时器并在 OnDocumentComplete 中停止它。

现在你正忙着等待，这绝不是一个好主意。

# scripting - 如何以编程方式更改端口的连接速度？

> ID：522509
> 
> 赞同：0
> 
> 时间：2009-02-06T22:32:01.580
> 
> 标签：scripting, switch-statement, snmp

我需要通过程序或脚本更改交换机上端口的连接速度。可能的选择是 100M 全双工、10M 全双工和 10M 半双工。

服务器运行 Linux Debian。这些交换机通过 SNMP “对话”。

我该怎么做？最好的是 Perl 和/或 PHP。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T22:52:20.477

交换机是否是您计算机的一部分也很重要。我见过的大多数交换机都是属于您网络的一部分的盒子。他们有各种与他们交谈的方法。如果它更好，您可以建立 ssh 连接并发出一些命令来更改配置。例如 switch 应该很容易作为脚本自动化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T22:48:52.717

假设这是一个较低级别的任务。尝试谷歌“linux 流量整形器”。

# asp.net - ASP.net：有谁知道如何实现 youtube 搜索框效果？

> ID：522510
> 
> 赞同：0
> 
> 时间：2009-02-06T22:32:03.530
> 
> 标签：asp.net, css

当 youtube 上的搜索文本框聚焦于它时，它会在文本框周围以蓝色突出显示。我想在我的网络应用程序上实现这种效果。有谁知道这是怎么做的或类似的？

杰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T22:35:34.880

您将使用 Javascript 根据客户端事件（获得/失去焦点）更改文本框行为。您可能会看到[这篇文章](http://www.dotnet2themax.com/showcontent.aspx?id=00fa0fd6-4970-4ddf-aa6b-335c3d1259be)开始，其中涵盖了突出显示。调整边框属性将以类似的方式完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T22:39:04.497

它只是一种 Css 风格

```
#masthead .search-term-focus {
border:2px solid #BBDAFD !important;
margin:4px 4px 0 0;
} 
```

Html 使用 Javascript 添加和删除 Class

```
<input id="footer-search-term" class="search-term" type="text" 
onblur="removeClass(this, 'search-term-focus')" 
onfocus="addClass(this, 'search-term-focus')" maxlength="128" value="" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T22:39:57.680

您可以在 CSS 中使用 :active 伪选择器，但这不适用于 IE6 或 IE7。

```
input:active {
     border: 2px solid #BBDAFD;
} 
```

由于这不适用于所有浏览器，因此他们在 onfocus 和 onblur 事件中使用 javascript 来删除设置边框颜色的类。你可以像这样使用 jQuery 1.3 做到这一点：

```
.input-focus {
     border: 2px solid #BBDAFD;
}

$(document).ready(function() {
    $("input:text").focus(function() { $(this).addClass("input-focus"); });
    $("input:text").blur(function() { $(this).removeClass("input-focus"); });
}); 
```

# c# - 文本中任意位置的 WPF 中 ComboBox 的自动完成（不仅仅是开始）

> ID：522521
> 
> 赞同：29
> 
> 时间：2009-02-06T22:34:13.370
> 
> 标签：c#, .net, wpf, combobox

我在 WPF 中有一个 ComboBox，我用过很多次（它有一个自定义模板和一个自定义项模板）。我现在已经达到了它几乎可以按照我想要的方式工作的地步，除了当我在 ComboBox 中键入时，它正在为我进行过滤，但仅在假设我键入的内容开始时进行过滤组合框。

例如，如果我在 ComboBox 中有一个名为“Windows Media Player”的项目，它只会在我开始输入“Windows Media ...”时找到它，如果我开始输入“Media Play...”，它将找不到它. 有没有办法解决？我可以在某处设置一个属性来告诉它在整个字符串中搜索，而不仅仅是使用 StartsWith() 吗？

如果没有，最好的方法是让我自己做到这一点？有什么方法可以获取原始控制权，基本上只是将对 StartsWith() 的调用更改为对 Contains() 的调用，还是我必须走得更底层？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2011-11-30T22:21:03.270

组合框现在支持自动完成，只需确保在 xaml 中放置组合框

```
IsEditable="True" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-12-30T20:25:10.060

查看 CodeProject 中的以下文章： [A Reusable WPF Autocomplete TextBox](http://www.codeproject.com/KB/WPF/autocomplete_textbox.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T08:45:28.097

据我所知，仅通过更改设置无法强制标准 ComboBox 以这种方式运行。因此，您必须为此实现自己的组合框衍生工具，或者搜索现成的第 3 方控件（我相信它们有很多）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-18T03:06:48.110

您可以尝试处理 ComboBox 的 TextInput 或 PreviewTextInput 事件，自己进行文本搜索，选择最合适的项目，并设置“e.Handled = true”。只是一个想法。希望这可以帮助！

编辑：

这适用于单个字符（即，如果您输入字母“j”，它将选择包含“j”或“J”的第一个项目），但我确信有一种方法可以使用您的控件来执行此操作。享受！

```
private void MyComboBox_PreviewTextInput(object sender, TextCompositionEventArgs e) {
    foreach (ComboBoxItem i in MyComboBox.Items) {
        if (i.Content.ToString().ToUpper().Contains(e.Text.ToUpper())) {
            MyComboBox.SelectedItem = i;
            break;
        }
    }
    e.Handled = true;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T07:58:46.957

WPF 组合框不支持自动完成

这是一个示例，它允许您通过对项目应用过滤器以间接方式执行此操作。

请参阅[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cec1b222-2849-4a54-bcf2-03041efcf304/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cec1b222-2849-4a54-bcf2-03041efcf304/)

# debugging - 调试 .NET CLR 应用程序时，如何查看评估堆栈上的局部变量？

> ID：522522
> 
> 赞同：6
> 
> 时间：2009-02-06T22:34:20.497
> 
> 标签：debugging, stack, windbg, il, sos

我正在使用 Windbg（带有 sos 扩展名）并尝试调试崩溃的应用程序。我能够转储引发异常的调用的 IL，并且通过检查代码，如果我可以转储评估堆栈的内容，我似乎可以获得所需的信息。可以用 WinDbg & sos 做什么吗？

这是我所做的：

1.  *启动 WinDbg*
2.  *附加到崩溃的进程*
3.  **loadby sos mscorwks** *（加载 sos 扩展）*
4.  **!token2ee *theModuleName* 0600009a** *（其中**theModuleName**是我正在调试的应用程序（和程序集）的名称，**9a**是 Windows 错误报告工具报告的崩溃方法的方法偏移量*。我得到了这个输出：

    模块：000e2c3c (theApplicationName.exe)
    令牌：0x0600009a
    MethodDesc：000e67c8
    名称：MyNamespace.MyClassName.theCulpritFn(MyOtherClass)
    JITTED 代码地址：0081b1d0

5.  **!dumpil 00e67c8** *（它为所讨论的方法转储了 IL）*。这是输出：

    ```
     // ..
    // .. the previous code omitted for brevity
    .catch
    {
     IL_0071: stloc.0
     IL_0072: nop
     IL_0073: ldstr "Can't set CurrentServer property for: "
     IL_0078: ldarg.0
     IL_0079: ldfld MyNamespace.MyClassName::_currentServer
     IL_007e: brtrue.s IL_0087
     IL_0080: ldstr ""
     IL_0085: br.s IL_0092
     IL_0087: ldarg.0
     IL_0088: ldfld MyNamespace.MyClassName::_currentServer
     IL_008d: callvirt MyNamespace.MyOtherClass::get_Name
     IL_0092: call System.String::Concat
     IL_0097: ldloc.0
     IL_0098: newobj MyNamespace.MySpecialExceptionType::ctor
     IL_009d: throw
    } 
    ```

    问题是：有没有办法让我看到在抛出异常之前压入堆栈的内容。如果我没记错的话，传递给异常构造函数的参数应该是评估堆栈上索引 0 处的局部变量。

    PS 当我尝试调用*!clrstack -a*时，我收到一条消息：无法遍历托管堆栈。当前线程可能不是托管线程。您可以运行 !threads 以获取进程中的托管线程列表。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-06T23:38:40.290

您需要识别并选择正确的线程。当前线程的 id 显示在 WinDbg 提示符中。

`!threads`将显示应用程序中的所有托管线程。`~Xs`一旦确定，您可以使用其中 X 是线程的 WinDbg id来切换线程。

`!clrstack`将向您显示堆栈跟踪。如果您想要本地人和/或参数，请使用`-l`/ `-p`（或`-a`两者都使用）。

您可以遍历所有线程并使用 列出它们的调用堆栈`~*e!clrstack`。

如果 local/parameters 不能满足您的需求，请使用`!dso`来显示推送到堆栈上的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T00:44:46.017

哇，这很难，没有真正的转储可以戳穿。:-)

这里有几个问题..然后我将添加一个之前未在上面的答案中列出的命令..

问题：

1.  您确定您正在捕获第一个异常，而不仅仅是最后一个未处理并破坏流程的异常吗？

2.  你能看一下引发异常的线程的本机调用堆栈吗？
    注意：应该调用 RaiseException() 或访问冲突。

3.  当心与您的代码完全无关的异步异常，并且可以进入并将您弹出到一个 catch 块中......或更糟（Thread.AbortException/System.OutofMemoryException 和...... StackOverflowException :-)

为了进一步挖掘，您在故障线程上运行**!dumpstack**。输出*并不准确*，但是它确实在遍历线程调用堆栈方面做得非常出色，您可能会幸运地看到一个引用 .cxr 异常的**@**符号和.exr 在消息中。如果你这样做了，那么你可以运行**.cxr -cxr-address**并查看异常链中的第一个异常是什么。

要点：虽然我可能会绕开这个问题，但如果调用 WER 的异常**未处理**并取消进程，您可能希望记录初始调用堆栈或将先前的异常添加为内部异常，以便确定根本原因.

谢谢，亚伦

# c# - 如何处理 C# 应用程序中的“创建窗口句柄时出错”错误？

> ID：522534
> 
> 赞同：4
> 
> 时间：2009-02-06T22:38:15.577
> 
> 标签：c#, controls, user-interface, window-handles

我已经看过[这个问题](https://stackoverflow.com/questions/88904/error-creating-window-handle)，并且我已经检查了那里提出的建议。我的程序创建和销毁了很多 UI 控件（*很多*UI 控件），任何使控件在“销毁”后仍然存在的东西都会导致这个问题。（有趣的事实：如果你在销毁它的容器之前没有将`ToolStrip`控件的`Visible`属性设置为 false，它不会被释放，因为它仍然在 Windows 中注册以接收主题更改事件；它只会在它不可见时取消注册，并且它显然无法知道在其容器被销毁时会发生这种情况。）

问题是，我的应用程序实际上有可能真的用完了窗口句柄。该程序有一个包含嵌套选项卡控件的表单。每个父选项卡有 12 或 13 个子选项卡，一个子选项卡上可以有 30 或 40 个控件。用户很可能在任何给定时间打开 15 个父选项卡，这进入了应用程序中 5000 多个实时控件的领域。而且我知道我的许多控件使用多个窗口句柄。

（在你说“好吧，看起来你的 UI 设计错了”之前，让我先放弃这一点：应用程序存在的全部原因首先是用户拥有巨大的数据空间，他们需要能够快速导航到。选项卡内的选项卡实际上对他们非常有效。）

我的理解是每个应用程序有 10,000 个窗口句柄的硬性限制。如果这确实是真的（我知道很多事情是真的而不是真的），那么我将不得不管理我的应用程序对它们的使用。例如，当我开始在窗口句柄上运行不足时，我可以丢弃最近最少使用的选项卡的内容。

但是我怎么知道我已经开始在窗口句柄上运行不足？这真的是解决问题的正确方法吗？

（这只是我想在 WPF 中重建此 UI 的众多原因之一。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T23:01:23.283

最好的方法是减少句柄的数量，而不是对达到进程限制做出反应。这将提供更好的性能并且（在我看来）将更可靠。

您熟悉大多数网格控件的工作原理吗？一个网格可以有大量的单元格，但网格控件不会为每个单元格创建一个编辑框（控件）。只有一个编辑框，可以根据需要移动；如果一个单元格是一个组合框（下拉列表），则创建一个组合框并四处移动；等等。这意味着您需要绘制一些看起来像所需控件的东西，但在实际使用中您只需要一个（每个）控件。

类似地，一些选项卡控件使用单个窗口/控件，而不是为每个选项卡创建一个窗口。

我建议考虑像这样的技术来减少你的控制数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T01:00:08.033

我已经解决了这个问题，我已经在[这个答案](https://stackoverflow.com/questions/143206/how-do-you-obtain-current-window-handle-count-and-window-handle-limit-in-net/534991#534991)中详细描述了这个问题。我在那里而不是在这里回答，主要是因为当我阅读其他对这个问题的回答时，我对 Raymond Chen 很生气。

简短的回答：

1.  维护一个标签页的[LRU 缓存](http://csharp-lru-cache.googlecode.com)，每当用户访问一个标签页时，该缓存就会更新。
2.  在创建新标签页之前计算正在使用的窗口句柄。
3.  如果正在使用的窗口句柄过多，则处理最近最少访问的标签页的内容，直到正在使用的窗口句柄数量下降到安全水平。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T23:23:03.317

您可以使用无窗口控件 - 这些类型的控件不需要窗口。设计为在窗口中有大量控件的应用程序实际上应该设计为使用无窗口控件。例如，参见 Internet Explorer——在 Spy++ 中查看它——你会发现它显示的控件数量惊人地少。

当我们迁移到 .Net 时，我们发现一个有趣的事实是窗口具有线程关联性，您必须在该线程中销毁它们 - 因此，如果您只是将其留给垃圾收集（在不同的线程中运行）来清理您的控件那么窗户就不会被破坏。因此，在具有窗口的控件中，实现 IDisposable 并显式销毁它们。

您可以使用任务管理器、进程资源管理器、perfmon 等查看应用程序中存在多少 GDI 对象。窗口句柄是 GDI 对象，因此如果您看到这个计数上升到数千个，您就知道您会遇到问题。

# cocoa-touch - -[UITableView scrollToRowAtIndexPath:atScrollPosition:animated:] 查询

> ID：522546
> 
> 赞同：2
> 
> 时间：2009-02-06T22:40:25.040
> 
> 标签：cocoa-touch, interface-builder

我有一个带有 UIView 的 NIB 文件，几个 UIImageView（包括一个徽标）和一个 UITableView 嵌入在徽标下方的 UIView 中，我允许用户输入用户名/密码以登录到我的应用程序。我在用户名/密码下方的 UITableViewCell 中还有第三个任意 UITextField。问题是，当它被点击时，键盘覆盖了整行。

我已经`-scrollToRowAtIndexPath:atScrollPosition:animated:`成功地在我的应用程序的其他部分使用，但不同之处在于我的 UITableView 覆盖了内容视图的整个高度/宽度，所以滚动工作。在这里它根本不滚动，我猜是因为 UITableView 嵌入在 UIView 中。

任何有关如何获得适当行为的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T02:30:51.333

表格视图中是否有足够的内容溢出其边界框？根据您的描述，听起来您可能不会，在这种情况下它不会滚动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T09:26:44.957

我面临同样的情况。建议您在键盘出现时更改视图的高度。您所描述的情况下的问题是，tableview 中没有足够的内容来向上滚动并且在键盘隐藏的区域中仍然有一些东西。

如果将 tableview 的大小调整为等于 480-150（视图高度 - 键盘高度），并使用 scrollToRowAtIndexPath，它将按预期工作。一旦键盘再次隐藏，将 tableview 的高度改回原来的高度。

# cruisecontrol.net - cc.net 项目可见性

> ID：522555
> 
> 赞同：0
> 
> 时间：2009-02-06T22:45:27.073
> 
> 标签：cruisecontrol.net

是否可以限制 cc.net Dashboard 中列出的项目的可见性？

我在仪表板中列出了项目 1、2 和 3。我想将项目 2 和 3 移动到不同的仪表板。这样我就可以将 URL1 分发到dashboard1，其中列出了 Porject1 和 URL2 到 Dashboard（列出了项目 2 和 3）给另一组人。因为仪表板从同一个 cc.net.config 文件中读取，是否可以通过添加属性来分离项目？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T17:20:21.030

您可以使用类别标签对它们进行排序，您将在左侧获得一个链接以独立转到每个组。只需将该组与您想要的每个项目相关联，它们就会位于链接页面下。

如果你真的很有野心，你可以创建他们自己的队列，这样每个人都可以独立集成，这样他们就不必等待他们不关心的其他类别。

```
<project name="CC.NET test" queue="testing" queuePriority="5">
  <category>Testing Group</category>
    ...
    ...
    ...
</project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T14:45:49.337

我相信，如果您查看类别功能，它应该有助于您尝试做的事情。

两组用户都可以导航到另一个类别，但您将能够满足为每个类别拥有不同的不同 URL 的要求。

# python - 在“for”循环中访问索引？

> ID：522563
> 
> 赞同：4572
> 
> 时间：2009-02-06T22:47:54.433
> 
> 标签：python, loops, list

如何在`for`如下循环中访问索引？

```
ints = [8, 23, 45, 12, 78]
for i in ints:
    print('item #{} = {}'.format(???, i)) 
```

我想得到这个输出：

```
item #1 = 8
item #2 = 23
item #3 = 45
item #4 = 12
item #5 = 78 
```

当我使用循环遍历它时`for`，如何访问循环索引，在这种情况下从 1 到 5？

* * *

## 回答 #1

> 赞同：7618
> 
> 时间：2009-02-06T22:52:36.357

使用额外的状态变量，例如索引变量（通常在 C 或 PHP 等语言中使用），被认为是非 Python 的。

更好的选择是使用 Python 2 和 3 中的内置函数[`enumerate()`](https://docs.python.org/3/library/functions.html#enumerate "枚举")：

```
for idx, val in enumerate(ints):
    print(idx, val) 
```

查看[PEP 279](https://www.python.org/dev/peps/pep-0279/ "政治人物 279")了解更多信息。

* * *

## 回答 #2

> 赞同：1105
> 
> 时间：2015-01-21T17:11:49.620

> # 使用 for 循环，我如何访问循环索引，在这种情况下从 1 到 5？

用于`enumerate`在迭代时获取元素的索引：

```
for index, item in enumerate(items):
    print(index, item) 
```

请注意，Python 的索引从零开始，所以你会得到 0 到 4 上面。如果您想要计数，从 1 到 5，请执行以下操作：

```
count = 0 # in case items is empty and you need it after the loop
for count, item in enumerate(items, start=1):
    print(count, item) 
```

# 统一的控制流

您要求的是以下 Pythonic 等价物，这是大多数低级语言程序员会使用的算法：

> ```
> index = 0            # Python's indexing starts at zero
> for item in items:   # Python's for loops are a "for each" loop 
>     print(index, item)
>     index += 1 
> ```

或者在没有 for-each 循环的语言中：

> ```
> index = 0
> while index < len(items):
>     print(index, items[index])
>     index += 1 
> ```

或者有时在 Python 中更常见（但不习惯）：

> ```
> for index in range(len(items)):
>     print(index, items[index]) 
> ```

# 使用枚举函数

Python 的[`enumerate`函数](https://docs.python.org/2/library/functions.html#enumerate)通过隐藏对索引的说明，并将可迭代对象封装到另一个可迭代对象（`enumerate`对象）中，从而减少视觉混乱，从而产生索引的两项元组和原始可迭代对象将提供的项。看起来像这样：

```
for index, item in enumerate(items, start=0):   # default is zero
    print(index, item) 
```

这个代码示例很好[地](http://python.net/%7Egoodger/projects/pycon/2007/idiomatic/handout.html#index-item-2-enumerate)说明了 Python 惯用代码和非 Python 代码之间的区别。惯用代码是复杂（但不复杂）的 Python，以预期使用的方式编写。该语言的设计者期望使用惯用代码，这意味着通常该代码不仅更具可读性，而且更高效。

## 计数

即使您不需要索引，但您需要计算可以开始的迭代次数（有时是可取的）`1`，最终数字将是您的计数。

```
count = 0 # in case items is empty
for count, item in enumerate(items, start=1):   # default is zero
    print(item)

print('there were {0} items printed'.format(count)) 
```

当你说你想要从 1 到 5 时，计数似乎更多的是你打算要求的（而不是索引）。

* * *

## 分解它 - 一步一步的解释

为了分解这些示例，假设我们有一个要使用索引迭代的项目列表：

```
items = ['a', 'b', 'c', 'd', 'e'] 
```

现在我们将这个迭代传递给枚举，创建一个枚举对象：

```
enumerate_object = enumerate(items) # the enumerate object 
```

我们可以从这个迭代中拉出第一项，我们将使用该`next`函数进入循环：

```
iteration = next(enumerate_object) # first iteration from enumerate
print(iteration) 
```

我们看到我们得到了一个元组`0`，第一个索引和`'a'`第一个项目：

```
(0, 'a') 
```

我们可以使用所谓的“[序列解包](https://docs.python.org/2/tutorial/datastructures.html#tuples-and-sequences)”来从这个二元组中提取元素：

```
index, item = iteration
#   0,  'a' = (0, 'a') # essentially this. 
```

当我们检查时`index`，我们发现它指的是第一个索引，0，并且`item`指的是第一个项目，`'a'`。

```
>>> print(index)
0
>>> print(item)
a 
```

# 结论

*   Python 索引从零开始
*   要在迭代时从可迭代对象中获取这些索引，请使用 enumerate 函数
*   以惯用的方式使用 enumerate（以及元组解包）创建的代码更具可读性和可维护性：

所以这样做：

```
for index, item in enumerate(items, start=0):   # Python indexes start at zero
    print(index, item) 
```

* * *

## 回答 #3

> 赞同：194
> 
> 时间：2014-05-27T10:04:52.163

从以下开始非常`1`简单`0`：

```
for index, item in enumerate(iterable, start=1):
   print index, item  # Used to print in python<3.x
   print(index, item) # Mirate print() after 3.x+ 
```

* * *

## 回答 #4

> 赞同：115
> 
> 时间：2009-02-06T22:49:23.213

```
for i in range(len(ints)):
   print(i, ints[i]) # print updated to print() in Python 3.x+ 
```

* * *

## 回答 #5

> 赞同：56
> 
> 时间：2017-08-15T02:17:41.007

与 Python 中的规范一样，有几种方法可以做到这一点。在所有示例中假设：`lst = [1, 2, 3, 4, 5]`

## 1.使用枚举（*被认为是最惯用的*）

```
for index, element in enumerate(lst):
    # do the things that need doing here 
```

在我看来，这也是最安全的选择，因为已经消除了进入无限递归的机会。项目及其索引都保存在变量中，无需编写任何进一步的代码来访问该项目。

## 2.创建一个变量来保存索引（*使用`for`*）

```
for index in range(len(lst)):   # or xrange
    # you will have to write extra code to get the element 
```

## 3.创建一个变量来保存索引（*使用`while`*）

```
index = 0
while index < len(lst):
    # you will have to write extra code to get the element
    index += 1  # escape infinite recursion 
```

## 4.总有另一种方式

如前所述，还有其他方法可以做到这一点，这里没有解释，它们甚至可能更适用于其他情况。*例如*与 for 一起使用`itertools.chain`。它比其他示例更好地处理嵌套循环。

* * *

## 回答 #6

> 赞同：43
> 
> 时间：2009-02-06T22:52:06.157

老套路：

```
for ix in range(len(ints)):
    print(ints[ix]) 
```

列表理解：

```
[ (ix, ints[ix]) for ix in range(len(ints))]

>>> ints
[1, 2, 3, 4, 5]
>>> for ix in range(len(ints)): print ints[ix]
... 
1
2
3
4
5
>>> [ (ix, ints[ix]) for ix in range(len(ints))]
[(0, 1), (1, 2), (2, 3), (3, 4), (4, 5)]
>>> lc = [ (ix, ints[ix]) for ix in range(len(ints))]
>>> for tup in lc:
...     print(tup)
... 
(0, 1)
(1, 2)
(2, 3)
(3, 4)
(4, 5)
>>> 
```

* * *

## 回答 #7

> 赞同：41
> 
> 时间：2016-08-04T09:49:50.743

# 访问索引和方法的性能基准测试

**在Python 3.7**中访问循环内列表索引的最快方法是对小型、中型和大型列表使用[enumerate 方法](https://docs.python.org/2/library/functions.html#enumerate)。

请在下面的代码示例中查看可用于迭代列表和访问索引值**及其性能指标**（我认为这对您有用）的**不同方法：**

 **```
# Using range
def range_loop(iterable):
    for i in range(len(iterable)):
        1 + iterable[i]

# Using enumerate
def enumerate_loop(iterable):
    for i, val in enumerate(iterable):
        1 + val

# Manual indexing
def manual_indexing_loop(iterable):
    index = 0
    for item in iterable:
        1 + item
        index += 1 
```

请参阅以下每种方法的性能指标：

```
from timeit import timeit

def measure(l, number=10000):
    print("Measure speed for list with %d items" % len(l))
    print("range: ", timeit(lambda :range_loop(l), number=number))
    print("enumerate: ", timeit(lambda :enumerate_loop(l), number=number))
    print("manual_indexing: ", timeit(lambda :manual_indexing_loop(l), number=number))

# Measure speed for list with 1000 items
measure(range(1000))
# range:  1.161622366
# enumerate:  0.5661940879999996
# manual_indexing:  0.610455682

# Measure speed for list with 100000 items
measure(range(10000))
# range:  11.794482958
# enumerate:  6.197628574000001
# manual_indexing:  6.935181098000001

# Measure speed for list with 10000000 items
measure(range(10000000), number=100)
# range:  121.416859069
# enumerate:  62.718909123
# manual_indexing:  69.59575057400002 
```

因此，`enumerate`在需要索引时，使用方法是最快的迭代方法。

在下面添加一些有用的链接：

*   *[Python 2.X 中的 range 和 xrange 函数有什么区别？](https://stackoverflow.com/questions/94935/what-is-the-difference-between-range-and-xrange-functions-in-python-2-x)*

*   *[在 Python 中使用 enumerate 的 for 循环或使用 xrange 的 for 循环哪个更快？](https://stackoverflow.com/questions/4852944/what-is-faster-for-loop-using-enumerate-or-for-loop-using-xrange-in-python)*

*   *[范围（len（list））还是枚举（list）？](https://stackoverflow.com/questions/11990105/rangelenlist-or-enumeratelist)*

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2021-12-18T16:05:51.363

您可以`enumerate`在字符串文字中使用和嵌入表达式来获得解决方案。

这是一个简单的方法：

```
a=[4,5,6,8]
for b, val in enumerate(a):
    print('item #{} = {}'.format(b+1, val)) 
```

* * *

## 回答 #9

> 赞同：21
> 
> 时间：2019-01-17T01:07:23.130

# 这是您在`for`循环中访问索引时得到的结果：

> **`for i in enumerate(items): print(i)`**

```
items = [8, 23, 45, 12, 78]

for i in enumerate(items):
    print("index/value", i) 
```

结果：

```
# index/value (0, 8)
# index/value (1, 23)
# index/value (2, 45)
# index/value (3, 12)
# index/value (4, 78) 
```

> **`for i, val in enumerate(items): print(i, val)`**

```
items = [8, 23, 45, 12, 78]

for i, val in enumerate(items):
    print("index", i, "for value", val) 
```

结果：

```
# index 0 for value 8
# index 1 for value 23
# index 2 for value 45
# index 3 for value 12
# index 4 for value 78 
```

> **`for i, val in enumerate(items): print(i)`**

```
items = [8, 23, 45, 12, 78]

for i, val in enumerate(items):
    print("index", i) 
```

结果：

```
# index 0
# index 1
# index 2
# index 3
# index 4 
```

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2015-05-25T15:08:34.367

首先，索引将从 0 到 4。编程语言从 0 开始计数；不要忘记这一点，否则您会遇到索引越界异常。在 for 循环中，您只需要一个从 0 计数到 4 的变量，如下所示：

```
for x in range(0, 5): 
```

请记住，我写了 0 到 5，因为循环在最大值之前停止了一个数字。:)

要获取索引的值，请使用

```
list[index] 
```

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2012-05-05T07:10:07.783

根据这个讨论：[http ://bytes.com/topic/python/answers/464012-objects-list-index](http://bytes.com/topic/python/answers/464012-objects-list-index)

循环计数器迭代

当前循环遍历索引的习惯用法使用内置`range`函数：

```
for i in range(len(sequence)):
    # work with index i 
```

循环遍历元素和索引可以通过旧的习惯用法或使用新的`zip`内置函数来实现：

```
for i in range(len(sequence)):
    e = sequence[i]
    # work with index i and element e 
```

或者

```
for i, e in zip(range(len(sequence)), sequence):
    # work with index i and element e 
```

通过[http://www.python.org/dev/peps/pep-0212/](http://www.python.org/dev/peps/pep-0212/)

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2015-05-25T15:26:58.247

您可以使用以下代码执行此操作：

```
ints = [8, 23, 45, 12, 78]
index = 0

for value in (ints):
    index +=1
    print index, value 
```

如果您需要在循环结束时重置索引值，请使用此代码：

```
ints = [8, 23, 45, 12, 78]
index = 0

for value in (ints):
    index +=1
    print index, value
    if index >= len(ints)-1:
        index = 0 
```

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2018-06-04T02:10:17.493

如果我要迭代`nums = [1, 2, 3, 4, 5]`我会做

```
for i, num in enumerate(nums, start=1):
    print(i, num) 
```

或者得到长度为`l = len(nums)`

```
for i in range(l):
    print(i+1, nums[i]) 
```

* * *

## 回答 #14

> 赞同：15
> 
> 时间：2018-08-15T17:52:50.627

在您的问题中，您写道*“我如何访问循环索引，在这种情况下从 1 到 5？”*

但是，列表的索引从零开始。所以，那么我们需要知道你真正想要的是列表中每个项目的索引和项目，或者你是否真的想要从 1 开始的数字。幸运的是，在 Python 中，很容易做到两者之一。

首先，为了澄清，该`enumerate`函数迭代地返回列表中每个项目的索引和对应项目。

```
alist = [1, 2, 3, 4, 5]

for n, a in enumerate(alist):
    print("%d %d" % (n, a)) 
```

上面的输出是，

```
0 1
1 2
2 3
3 4
4 5 
```

请注意，索引从 0 开始运行。这种索引在包括 Python 和 C 在内的现代编程语言中很常见。

如果您希望循环跨越列表的一部分，您可以对列表的一部分使用标准 Python 语法。例如，要从列表中的第二项循环到但不包括最后一项，您可以使用

```
for n, a in enumerate(alist[1:-1]):
    print("%d %d" % (n, a)) 
```

请注意，输出索引从 0 开始运行，

```
0 2
1 3
2 4 
```

这将我们带到`start=n`了`enumerate()`. 这只是抵消了索引，您可以等效地简单地在循环内的索引中添加一个数字。

```
for n, a in enumerate(alist, start=1):
    print("%d %d" % (n, a)) 
```

输出为

```
1 1
2 2
3 3
4 4
5 5 
```

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2018-06-10T03:59:43.483

如果列表中没有重复值：

```
for i in ints:
    indx = ints.index(i)
    print(i, indx) 
```

* * *

## 回答 #16

> 赞同：9
> 
> 时间：2018-02-07T14:04:10.590

你也可以试试这个：

```
data = ['itemA.ABC', 'itemB.defg', 'itemC.drug', 'itemD.ashok']
x = []
for (i, item) in enumerate(data):
      a = (i, str(item).split('.'))
      x.append(a)
for index, value in x:
     print(index, value) 
```

输出是

```
0 ['itemA', 'ABC']
1 ['itemB', 'defg']
2 ['itemC', 'drug']
3 ['itemD', 'ashok'] 
```

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2020-04-18T20:25:15.250

使用 While 循环的简单答案：

```
arr = [8, 23, 45, 12, 78]
i = 0
while i < len(arr):
    print("Item ", i + 1, " = ", arr[i])
    i += 1 
```

输出：

[![在此处输入图像描述](https://i.stack.imgur.com/Ucu0o.png)](https://i.stack.imgur.com/Ucu0o.png)

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2018-05-30T21:34:22.213

您可以使用该`index`方法

```
ints = [8, 23, 45, 12, 78]
inds = [ints.index(i) for i in ints] 
```

**编辑** 在注释中强调，如果 中存在重复，则此方法不起作用`ints`，下面的方法应该适用于中的任何值`ints`：

```
ints = [8, 8, 8, 23, 45, 12, 78]
inds = [tup[0] for tup in enumerate(ints)] 
```

或者，

```
ints = [8, 8, 8, 23, 45, 12, 78]
inds = [tup for tup in enumerate(ints)] 
```

如果您想同时获取索引和值`ints`作为元组列表。

它使用该`enumerate`问题的选定答案中的方法，但使用列表理解，从而以更少的代码使其更快。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2018-04-24T10:53:56.490

`for`使用循环在列表理解中打印 (index, value) 的元组：

```
ints = [8, 23, 45, 12, 78]
print [(i,ints[i]) for i in range(len(ints))] 
```

输出：

```
[(0, 8), (1, 23), (2, 45), (3, 12), (4, 78)] 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2021-05-09T19:19:48.383

您可以简单地使用变量`count`来计算列表中的元素数量：

```
ints = [8, 23, 45, 12, 78]
count = 0
for i in ints:
    count = count + 1
    print('item #{} = {}'.format(count, i)) 
```

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2022-01-05T15:19:17.483

循环将“计数器”变量设置为初始化程序，该变量将作为参数，格式化字符串，作为项目编号。***for***循环访问作为列表的“listos”变量。当我们通过 "i" 访问列表时，"i" 被格式化为商品价格{或它是什么}。

```
listos = [8,23,45,12,78]
counter = 1
for i in listos :
    print('Item #{} = {}'.format(counter,i))
    counter += 1

output:
Item #1 = 8
Item #2 = 23
Item #3 = 45
Item #4 = 12
Item #5 = 78 
```

* * *

## 回答 #22

> 赞同：-5
> 
> 时间：2018-04-24T10:45:29.747

这很好用：

```
list2 = [11, 'sumit', 43.21, 'sharma', '44', 'test', 2]
for x in list1:
    print( 'index: ', list2.index(x), 'value:', x ) 
```

# .net - 通过 Web 服务将 Sql Server 转换为 Excel

> ID：522571
> 
> 赞同：3
> 
> 时间：2009-02-06T22:49:36.053
> 
> 标签：.net, sql-server, web-services, excel

我想知道将数据从 Web 服务传输到 Excel 工作表（Office 2007）的最佳方式。我对从网站输出报告到 excel 不感兴趣。在我们的场景中，用户将使用 excel（带有许多宏等）并将大约 11000 行数据从服务器请求到工作表。

有人对此有经验吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T00:38:37.127

我过去用于通过 Web 服务器将数据从数据库获取到 Excel 的一个简单解决方案是简单地将数据公开为网页中的表格。这可以使用您喜欢的任何技术来完成，例如 ASP.NET，它可以连接到数据库、检索数据并将数据放入 GridView 控件中。

然后，您可以在 Excel 中设置“Web 查询”。这是通过使用菜单项 Data -> Import External Data -> New Web Query 完成的。然后，您可以导航到您的网页，选择表格作为数据源，然后选择应写入的范围。

有自动刷新、查询字符串参数（来自工作表中的单元格）等选项。

您可以使用 VBA 自动刷新您的 Web 查询，作为更大过程的一部分，例如

```
Sheet1.QueryTables(1).Refresh 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T16:41:52.413

检查 SharePoint 和 Excel Services - 这正是它的设计目的。您可以在 SharePoint 中发布数据源以供任何用户在 Excel 中使用，并使他们的 Excel 电子表格与数据仓库保持同步。

架构概述：

[http://technet.microsoft.com/en-us/magazine/2009.02.bookbi.aspx](http://technet.microsoft.com/en-us/magazine/2009.02.bookbi.aspx)

SQL Server Magazine 中的实施指南（需要订阅）：

[http://www.sqlmag.com/Articles/Index.cfm?ArticleID=99355&pg=2](http://www.sqlmag.com/Articles/Index.cfm?ArticleID=99355&pg=2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T22:53:22.270

您可以使用 SQL SSIS 连接 web 服务任务[http://msdn.microsoft.com/en-us/library/ms140114.aspx](http://msdn.microsoft.com/en-us/library/ms140114.aspx)

然后进行典型的移动到 excel 目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T01:29:46.223

我最近使用了一个系统，它做了类似的事情，本质上它只是一个带有一些 VB 脚本的 Excel 工作簿，可以调用 Web 服务。它还提示用户输入凭据。

我不能发布任何与电子表格相关的代码，但是有很多示例和信息，例如Microsoft 提供的[this](http://msdn.microsoft.com/en-us/magazine/cc163837.aspx)以及其他教程/示例，例如[this](http://www.webcontinuum.net/ws_4.aspx)。

# c# - 将数据从 Web 应用程序提交到 C# 控制台应用程序

> ID：522574
> 
> 赞同：3
> 
> 时间：2009-02-06T22:51:24.847
> 
> 标签：c#, web-applications, console-application

我需要将数据从 Web 应用程序提交到控制台应用程序。当前计划要求 Web 应用程序将数据提交到数据库，并要求控制台应用程序轮询数据库，然后在插入数据时对数据进行操作。我是否应该更改控制台应用程序以包含 Web 应用程序可以提交数据的 http 处理程序，这样它就不必轮询数据库？有没有更好的方法在这两个应用程序之间传递数据？控制台应用程序永远不必向 Web 应用程序发送数据。

**更新**

这是一个 .NET 2.0 控制台应用程序，因此 WCF 似乎不是一个可行的选择。数据负载相当小（几个 9 位 ID 字段，总共不到 150 个字节），并且将以每分钟 10 个左右的速率发送。这两个应用程序之间没有防火墙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T22:56:50.810

我不确定您的要求或设置，但[WCF](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)可能是一种选择。

[编辑]
要扩展，您可以在控制台应用程序中托管 wcf 服务，并让 asp.net 站点调用它。就此而言，远程处理（或任何其他形式）也可以工作。这样，您就不必在不需要时让控制台应用程序池化数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T22:58:38.170

你基本上想要一个应用程序到应用程序的通信。有很多选择，但实际上取决于您的要求（数据量、大小、频率、延迟）、环境（防火墙后、在线/离线、恢复）等。

使用数据库是一种解决方案。但是你可以使用其他的——比如 web 服务 (wcf)、消息系统 (msmq)、.net 远程处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T11:01:44.623

使用最简单的技术，您的控制台应用程序可以在由 Timer 或 BackgroundWorker 控制的循环中连接到数据库。您需要一种方法来了解哪些记录是新的，哪些不是。如果您可以在轮询时从该表中删除记录，这意味着每次执行此操作时，您只会获得新记录。如果您无法删除它们，请使用该表中的时间戳字段，并且每次轮询时选择该时间戳大于前一批的最大时间戳的记录。如果您需要将这些记录标记为已处理，则可以设置该标志并忘记时间戳。

# com - 分析 COM 对象注册表干扰的好工具？

> ID：522580
> 
> 赞同：1
> 
> 时间：2009-02-06T22:53:07.403
> 
> 标签：com, registry

我继承了两个复杂的 COM 对象。一个是从另一个派生的，并且（据称）GUID 等都已更改，因此它们不应干扰。它们确实会干扰，到目前为止，我们的调试还没有确定罪魁祸首——我们已经完成了注册表比较和源代码差异，并查看了 SCCS 签入。显然我们遗漏了一些东西，但它们足够大和复杂，我并不感到惊讶。

是否有可以提供帮助的工具，例如检查 COM 对象的良好行为或检测两个 COM 对象之间的冲突或分析注册表？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-06T22:57:57.987

如果您有 Visual Studio，则可以使用[regcap](http://nidget.wordpress.com/2012/08/01/create-registry-file-reg-equivalent-to-the-regsvr32-command/)提取注册表项，然后通过脚本收集 GUID 列表。您也可以使用 OLEView（也来自 Visual Studio）来执行此操作。

还有其他免费工具可以做到这一点：
如果你有 VB，MMM（Make My Manifest）可能会被吸引这样做。
分别来自 Wix 3.0 和 2.0 的 Heat 或 Tallow 也可以做这样的事情。

每种情况下的输出格式都会略有不同，但足以将相关信息收集到文本文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T23:03:09.847

不确定自动化工具，但在这种情况下我要做的第一件事是运行 RegEdt32.exe 并查看 HKEY_CLASSES_ROOT - 此时您应该能够看到每个 COM 对象，这将为您提供 ClassID。然后，您可以在 HKEY_CLASSES_ROOT/CLSID 中查找这些 CLSID 以找到类型库 GUID。这是一种手动方法，但它应该告诉您所有您需要了解的有关冲突的信息。

另一个想法，也许他们都共享一个基于通用的 DLL。您可以使用[Dependency Walker进行检查](http://www.dependencywalker.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-06T23:34:12.703

一些工作工具：
[Deviare COM Spy Console](http://www.nektra.com/products/deviare/comconsole/Deviare%20Com%20Console.exe)

[调试工具箱列表](http://blogs.msdn.com/debuggingtoolbox/)

[WinAPIOverride32](http://jacquelin.potier.free.fr/winapioverride32/index.php) - 可以挂钩 COM OLE 和 ActiveX 接口

# c# - How can I pass object[] or several objects to enqueueworkitem method?

> ID：522585
> 
> 赞同：0
> 
> 时间：2009-02-06T22:54:49.567
> 
> 标签：c#

The parameterizedthreadstart object has an enqueueworkitem. This (if I can remember my methods and their parameters correctly) takes an object parameter as "state".

However, when I have a method which has several object parameters (e.g. string, int which are children of object) what can I do to pass all of these parameters into the enqueueworkitem method? Also, what if I have an object[] and not object parameter?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T00:54:01.620

将 object[] 传递给接受 object 的函数是完全合法的。任何类型都可以转换为对象。

在被调用的函数中，只需将 state 参数转换回 object[] 就可以了。

```
public void CallThreadPool(object[] arguments) {
  ThreadPool.QueueUserWorkItem(new WaitCallBack(MyThreadProc), arguments);
}

public void MyThreadProc(object state) {
  object[] data = (object[])state;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T22:57:39.187

You can always wrap any number of arguments you need in a type and pass an instance of that.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T02:43:49.980

就个人而言，我会避免使用“状态”参数——它失去了类型安全性（编译器不检查强制转换）。匿名方法更干净：

```
int foo =...;
string bar =...;
ThreadPool.QueueUserWorkItem(delegate {
    YourMethod(foo,bar);
}); 
```

# python - AppEngine：在创建记录时保持 DataStore 一致性

> ID：522586
> 
> 赞同：3
> 
> 时间：2009-02-06T22:55:04.060
> 
> 标签：python, google-app-engine, transactions, google-cloud-datastore, consistency

我遇到了一个小难题！我有一个叫 vote 的处理程序；当它被调用时，它将用户的投票设置为他们选择的任何内容。为了记住他们之前选择的选项，我存储了一个 VoteRecord 选项，其中详细说明了他们当前的投票设置。

当然，他们第一次投票时，我必须创建对象并存储它。但是连续的投票应该只是改变现有 VoteRecord 的值。但问题来了：在某些情况下，可以创建两个 VoteRecords。这种情况很少见（到目前为止，我们在 500 次投票中只发生过一次），但当它发生时仍然很糟糕。

之所以会出现这个问题，是因为两个单独的处理程序基本上都这样做：

```
query = VoteRecord.all().filter('user =', session.user).filter('poll =', poll)

if query.count(1) > 0:
 vote = query[0]

 poll.votes[vote.option] -= 1
 poll.votes[option] += 1
 poll.put()

 vote.option = option
 vote.updated = datetime.now()
 vote.put()
else:
 vote = VoteRecord()
 vote.user = session.user
 vote.poll = poll
 vote.option = option
 vote.put()

 poll.votes[option] += 1
 poll.put()

 session.user.votes += 1
 session.user.xp += 3
 session.user.put()

 incr('votes') 
```

我的问题是：在确保没有请求丢失并且没有请求创建两个 VoteRecord 对象的同时，处理这些请求的最有效和最快的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T15:29:25.770

最简单的方法是为您的投票对象使用键名，并使用 Model.get_or_insert。首先，为你的键名提出一个命名方案——在投票之后命名是个好主意——然后执行 get_or_insert 来获取或创建相关实体：

```
vote = VoteRecord.get_or_insert(pollname, parent=session.user, user=session.user, poll=poll, option=option)
if vote.option != option:
  # Record already existed; we need to update it
  vote.option = option
  vote.put() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T03:19:59.627

问题是这部分：

```
if vote.count(1) == 0:
    obj = VoteRecord()
    obj.user = user
    obj.option = option
    obj.put() 
```

如果没有事务，您的代码可以在两个解释器实例中按此顺序运行：

```
if vote.count(1) == 0:
    obj = VoteRecord()
    obj.user = user

if vote.count(1) == 0:
    obj = VoteRecord()
    obj.user = user
    obj.option = option
    obj.put()

    obj.option = option
    obj.put() 
```

或者任何奇怪的组合。问题是计数测试在 put 发生之前再次运行，因此第二个线程通过条件的第一部分而不是第二部分。

您可以通过将代码放入函数中然后使用来解决此问题

```
db.run_in_transaction() 
```

运行该功能。

问题是您似乎依赖于查询返回的对象计数来获取需要放入事务中的决策逻辑。如果您阅读 Google I/O 演讲或查看该组，您会发现不推荐这样做。那是因为您不能事务化查询。相反，您应该将计数作为实体值存储在某处，在事务函数*之外*查询它，然后将该实体的键传递给您的事务函数。

这是检查实体属性的事务函数的示例。它作为参数传递了密钥：

```
def checkAndLockPage(pageKey):
  page = db.get(pageKey)
  if page.locked:
    return False
  else:
    page.locked = True
    page.put()
    return True 
```

一次只有一个用户可以锁定这个实体，并且永远不会有任何重复的锁定。

# php - 谷歌地图api数据库交互

> ID：522590
> 
> 赞同：2
> 
> 时间：2009-02-06T22:56:05.977
> 
> 标签：php, javascript, mysql, google-maps

我目前正在做一个项目，用户需要能够将地质数据（例如某个街道名称）输入到网站中，该网站将被放入数据库中，然后检索并显示在谷歌地图上供所有用户查看。

我做了一些研究，到目前为止，看起来最好的方法是使用 PHP 脚本获取数据并将其发送到 MySQL 数据库，然后可以由另一个 PHP 脚本检索它，然后传递给 JavaScript显示在地图上。

从大局来看，这是最好的做事方式吗？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T23:16:44.797

看起来您的问题有几个单独的步骤：

1.  注册一个 Google Maps API 密钥。

2.  写一些东西让用户输入地址并将其保存在数据库中。
    2a. 相同的脚本应该使用地理编码将地址转换为坐标。结果也应该（必须）保存在数据库中，因为 Google 每天每个 IP 只接受 15k 的地理编码查询。由于您将保存结果，因此只有在一天内向地图添加超过 15k 项时才会出现问题。

3.  编写生成地图的脚本。可能有一些很酷的 Google API 调用，如果没有，您将不得不自己做一些工作。使用时间戳缓存地图，以便您可以节省一些处理器/时间。

4.  创建一个将显示地图的界面，与步骤 2a 集成，并调用步骤 3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T04:54:08.017

@Phil 的反应很好。以下是我的一些补充：

谷歌地理编码不必在服务器端完成。15k 限制计入*客户端*ip 而不是服务器 ip。如果是**这样**，单个恶意客户端可能会耗尽主机站点的限制并有效地破坏站点的地理编码功能。

[http://code.google.com/support/bin/answer.py?answer=93464&topic=12266](http://code.google.com/support/bin/answer.py?answer=93464&topic=12266)

在存储 db 结果之前执行地理编码服务器端的一个原因是它可以更容易地验证用户的输入以确保他们输入的地址实际上是可地理编码的。在这种情况下，您将受到 15k 查询主机的限制。如果您将验证代码放在客户端上，您会将请求传播到所有客户端。

有一些漂亮的 Google API 调用。快速浏览文档将揭示一个简单的过程：

*   从数据库中获取地址
*   将其地理编码为 GPoint
*   将地图置于 GPoint 的中心
*   并可能在 GPoint 上放置一个标记

这些类型的东西在文档中已经完全涵盖了。

[http://code.google.com/apis/maps/documentation/examples/](http://code.google.com/apis/maps/documentation/examples/)

另外，直接回答你的问题。是的，看起来你在正确的轨道上。

# c# - 为什么在尝试使用数据表更新 Access 数据库文件 (.mdb) 时出现此错误：

> ID：522591
> 
> 赞同：2
> 
> 时间：2009-02-06T22:56:33.433
> 
> 标签：c#, ms-access, datatable, dataset, oledbcommand

我已经为我的问题工作了 30 个小时。每次我修复一件事时，都会出现一个新错误。我要做的就是从内存中获取一个 DataTables 并简单地更新一个 Access .MDB 文件。这是我的代码：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.OleDb;
using System.IO;
using System.Linq;
using System.Text;

namespace LCR_ShepherdStaffupdater_1._0
{
    public class DatabaseHandling
    {
        static DataTable datatableB = new DataTable();
        static DataTable datatableA = new DataTable();
        public static DataSet datasetA = new DataSet();
        public static DataSet datasetB = new DataSet();
        static OleDbDataAdapter adapterA = new OleDbDataAdapter();
        static OleDbDataAdapter adapterB = new OleDbDataAdapter();
        static string connectionstringA = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Settings.getfilelocationA();
        static string connectionstringB = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Settings.getfilelocationB();
        static OleDbConnection dataconnectionB = new OleDbConnection(connectionstringB);
        static OleDbConnection dataconnectionA = new OleDbConnection(connectionstringA);
        static DataTable tableListA;
        static DataTable tableListB;

        static public void addTableA(string table, bool addtoDataSet)
        {
            dataconnectionA.Open();
            datatableA = new DataTable(table);
            try
            {
                OleDbCommand commandselectA = new OleDbCommand("SELECT * FROM [" + table + "]", dataconnectionA);
                adapterA.SelectCommand = commandselectA;
                adapterA.Fill(datatableA);
            }
            catch
            {
                Logging.updateLog("Error: Tried to get " + table + " from DataSetA. Table doesn't exist!", true, false, false);
            }

            if (addtoDataSet == true)
            {
                datasetA.Tables.Add(datatableA);
                Logging.updateLog("Added DataTableA: " + datatableA.TableName.ToString() + " Successfully!", false, false, false);
            }

            dataconnectionA.Close();
        }

        static public void addTableB(string table, bool addtoDataSet)
        {
            dataconnectionB.Open();
            datatableB = new DataTable(table);

            try
            {
                OleDbCommand commandselectB = new OleDbCommand("SELECT * FROM [" + table + "]", dataconnectionB);
                adapterB.SelectCommand = commandselectB;
                adapterB.Fill(datatableB);
            }
            catch
            {
                Logging.updateLog("Error: Tried to get " + table + " from DataSetB. Table doesn't exist!", true, false, false);
            }

            if (addtoDataSet == true)
            {
                datasetB.Tables.Add(datatableB);
                Logging.updateLog("Added DataTableB: " + datatableB.TableName.ToString() + " Successfully!", false, false, false);
            }

            dataconnectionB.Close();
        }

        static public string[] getTablesA(string connectionString)
        {
            dataconnectionA.Open();
            tableListA = dataconnectionA.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new Object[] { null, null, null, "TABLE" });
            string[] stringTableListA = new string[tableListA.Rows.Count];

            for (int i = 0; i < tableListA.Rows.Count; i++)
            {
                stringTableListA[i] = tableListA.Rows[i].ItemArray[2].ToString();
            }
            dataconnectionA.Close();
            return stringTableListA;
        }

        static public string[] getTablesB(string connectionString)
        {
            dataconnectionB.Open();
            tableListB = dataconnectionB.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new Object[] { null, null, null, "TABLE" });
            string[] stringTableListB = new string[tableListB.Rows.Count];

            for (int i = 0; i < tableListB.Rows.Count; i++)
            {
                stringTableListB[i] = tableListB.Rows[i].ItemArray[2].ToString();
            }
            dataconnectionB.Close();
            return stringTableListB;
        }

        static public void createDataSet()
        {

            string[] tempA = getTablesA(connectionstringA);
            string[] tempB = getTablesB(connectionstringB);
            int percentage = 0;
            int maximum = (tempA.Length + tempB.Length);

            Logging.updateNotice("Loading Tables...");
            Logging.updateLog("Started Loading File A", false, false, true);
            for (int i = 0; i < tempA.Length ; i++)
            {
                if (!datasetA.Tables.Contains(tempA[i]))
                {
                    addTableA(tempA[i], true);
                    percentage++;
                    Logging.loadStatus(percentage, maximum);
                }
                else
                {
                    datasetA.Tables.Remove(tempA[i]);
                    addTableA(tempA[i], true);
                    percentage++;
                    Logging.loadStatus(percentage, maximum);
                }
            }
            Logging.updateLog("Finished loading File A", false, false, true);
            Logging.updateLog("Started loading File B", false, false, true);
            for (int i = 0; i < tempB.Length ; i++)
            {
                if (!datasetB.Tables.Contains(tempB[i]))
                {
                    addTableB(tempB[i], true);
                    percentage++;
                    Logging.loadStatus(percentage, maximum);
                }
                else
                {
                    datasetB.Tables.Remove(tempB[i]);
                    addTableB(tempB[i], true);
                    percentage++;
                    Logging.loadStatus(percentage, maximum);
                }
            }
            Logging.updateLog("Finished loading File B", false, false, true);
            Logging.updateLog("Both files loaded into memory successfully", false, true, false);

        }

        static public DataTable getDataTableA()
        {
            datatableA = datasetA.Tables[Settings.textA];

            return datatableA;
        }
        static public DataTable getDataTableB()
        {
            datatableB = datasetB.Tables[Settings.textB];
            return datatableB;
        }

        static public DataSet getDataSetA()
        {
            return datasetA;
        }

        static public DataSet getDataSetB()
        {
            return datasetB;
        }

        static public void InitiateCopyProcessA()
        {
            DataSet tablesA;
            tablesA = DatabaseHandling.getDataSetA();

                foreach (DataTable table in tablesA.Tables)
                {
                    OverwriteTable(table, table.TableName);
                    Logging.updateLog("Copied " + table.TableName + " successfully.", false, true, false);
                }

        }

        static void OverwriteTable(DataTable sourceTable, string tableName)
        {
            using (var destConn = new OleDbConnection(connectionstringA))
            using (var destCmd = new OleDbCommand(tableName, destConn) { CommandType = CommandType.TableDirect })
            using (var destDA = new OleDbDataAdapter(destCmd))
            {
                // Since we're using a single table, we can have the CommandBuilder
                // generate the appropriate INSERT and DELETE SQL statements
                using (var destCmdB = new OleDbCommandBuilder(destDA))
                {
                    destCmdB.QuotePrefix = "["; // quote reserved column names
                    destCmdB.QuoteSuffix = "]";
                    destDA.DeleteCommand = destCmdB.GetDeleteCommand();
                    destDA.InsertCommand = destCmdB.GetInsertCommand();

                    // Get rows from destination, and delete them
                    var destTable = new DataTable();
                    destDA.Fill(destTable);
                    foreach (DataRow dr in destTable.Rows)
                    {
                        dr.Delete();
                    }

                     destDA.Update(destTable); // !!! Run-time error: Syntax error in FROM clause. !!!

                    // Set rows from source as Added, so the DataAdapter will insert them
                    foreach (DataRow dr in sourceTable.Rows)
                    {
                        dr.SetAdded();
                    }
                    destDA.Update(sourceTable);
                }
            }
        }

        }          
    } 
```

**编辑：**

好的谢谢！但同样出现了一个新问题。相同的源代码，但是当我将表复制到 .MDB 文件时，已经复制了 10 个左右的表，然后我收到了这个运行时错误：

**对于不返回任何键列信息的 SelectCommand，不支持为 DeleteCommand 生成动态 SQL。**

在这个命令**destDA.DeleteCommand = destCmdB.GetDeleteCommand();**

这应该是我的最后一个问题，我的项目将完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T23:07:18.480

```
destCmdB.QuotePrefix = "["; // quote reserved column names
destCmdB.QuotePrefix = "]"; 
```

QuotePrefix 两次？也许这可能是一个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T23:26:22.983

> 对于不返回任何键列信息的 SelectCommand，不支持为 DeleteCommand 生成动态 SQL。

你需要一个主键...

在您的 Access 表中，您需要指定一个包含唯一值的列。主键用于标识单个行。通常您会创建一个定义为自动编号的“ID”列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T23:08:54.187

```
 destCmdB.QuotePrefix = "["; // quote reserved column names
destCmdB.QuoteSuffix = "]"; 

```

我只能找到这个错字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T23:04:35.460

有什么办法可以转储 SQL 吗？如果你能做到这一点，你应该能够发现问题。

# apache-flex - Flex 编译器将 .aso 文件放在哪里？

> ID：522604
> 
> 赞同：0
> 
> 时间：2009-02-06T23:01:03.393
> 
> 标签：apache-flex, flash, actionscript-3, flashdevelop

我希望能够手动删除 Flex mxmlc 编译器生成的中间 .aso 文件。它们存储在哪里？

（我知道 Flash IDE 有一个“删除 asos”按钮，但我使用的是 FlashDevelop IDE，它没有。我想要这个的原因是我可以在一个相当大的项目上使用编译器的警告设置，如果 .aso 文件是最新的，编译器将不会尝试重新编译。）

谢谢，马特

更新：谢谢，确实 Filemon 没有出现 .aso 文件或我能看到的任何其他中间文件。触摸每个文件是我最终要做的。所以我的新问题是：mxmlc 如何*存储*它的中间文件？它必须有它们，因为删除 .swf 不会触发完全重新编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T06:59:19.620

AFAIK Flex 3 编译器不使用 .aso 文件，因为这些文件仅为 ActionScript 2 类创建。我不太了解 FlashDevelop，但我希望如果您更改编译器设置，它会重新构建应用程序。如果没有，也许对源文件做一个小的改动（添加一个空格），以便 IDE 重新编译就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T00:14:16.277

ASO 是特定于 AS2 的（BTW FlashDevelop 会选择性地自动清理 ASO 文件）。

对于 AS3，FlashDevelop 托管 Flex 编译器 SHell (FCSH)，它包含在 Flex 3 SDK 中。这个不错的工具将您的代码保存在内存中，它应该重新编译已更改的类。

在 FlashDevelop 中，如果编译器运行愚蠢，您只需切换活动项目 - 这将重置 shell。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T23:15:58.713

看看[Filemon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)。它对于确定文件来自或去往（除其他外）的位置非常有用。

# perl - Perl Catalyst 操作是如何实现的？

> ID：522618
> 
> 赞同：2
> 
> 时间：2009-02-06T23:08:56.700
> 
> 标签：perl, catalyst

下面的代码是如何在 Perl 中实现的？

```
 sub add_item : Local {
     my ( $self, $c ) = @_;

     my $item_id = $c->req->param("item");

     push @{ $c->session->{items} }, $item_id;

  } 
```

我对**add_item : Local**部分感兴趣，因为我认为这些不是 Perl 关键字。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-06T23:17:28.070

它们是属性。请参阅[属性](http://perldoc.perl.org/attributes.html)文档，以及[通过 my() 的私有变量](http://perldoc.perl.org/perlsub.html#Private-Variables-via-my())和[perlsub](http://perldoc.perl.org/perlsub.html)中的子[例程属性](http://perldoc.perl.org/perlsub.html#Subroutine-Attributes)。

# gdb - 如何对程序进行双向或反向调试？

> ID：522619
> 
> 赞同：16
> 
> 时间：2009-02-06T23:11:41.017
> 
> 标签：gdb, debugging, reverse-debugging

有没有人真正使用过可逆调试器？谷歌出现的唯一产品是[UndoDB](http://undo-software.com)。它显然仅适用于 Linux。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-10-08T03:43:39.270

最新的 gdb 版本 7.0（本周发布）支持在许多平台上进行反向调试（例如，本机 i386 和 x86_64 linux、VMware 工作站、UndoDB 和 Virtutech 的 Simics 模拟器）。 [ftp://ftp.gnu.org/pub/gdb](ftp://ftp.gnu.org/pub/gdb)

它适用于 VMware 工作站 7.0 的最新预览版/预发布版，它还支持使用 Visual Studio 调试器对 MSWindows 来宾进行反向调试。[在http://communities.vmware.com/community/beta/workstation](http://communities.vmware.com/docs/DOC-10714)获取工作站 7.0 的免费试用下载，并在[http://communities.vmware.com/docs/DOC-10714](http://communities.vmware.com/community/beta/workstation)找到一些有用的使用提示

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-09T18:48:01.853

新发布的 gdb-7.0 包括针对原生 linux x86 和 x86_64 的反向调试功能。您可以像往常一样调试任何 linux 程序，打开“录制”功能，从那时起，如果您前进得太远，您可以后退或反向继续到断点。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-11-06T22:16:44.523

As a amusing historical note, EXDAMS implemented a post-mortem reverse debugging back in the late 60s for MULTICS.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-06T23:23:55.467

您寻找的词可能是“无所不知的调试”。

这是一个：[http ://www.lambdacs.com/debugger/](http://www.lambdacs.com/debugger/)

UndoDB 页面有一些指向（昂贵的）商业调试器的链接。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-10-20T19:25:52.467

Yes, I have used [Virtutech Simics](http://www.virtutech.com/whitepapers/reverse_debug.html) with reverse since 2005\. It is incredibly useful, and does make most bugs very simple to fix. Especially those related to timing and race conditions, and multicore/thread "heisenbugs".

See [http://jakob.engbloms.se/archives/1547](http://jakob.engbloms.se/archives/1547), [http://jakob.engbloms.se/archives/1554](http://jakob.engbloms.se/archives/1554), and [http://jakob.engbloms.se/archives/1564](http://jakob.engbloms.se/archives/1564) take inventory of most known reverse debugger attempts to date.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-06-08T11:43:31.177

Although this question is old, [reverse-debugging](/questions/tagged/reverse-debugging "show questions tagged 'reverse-debugging'") remains an interesting topic, so I thought I'd post an updated answer. My thesis, [*Combining reverse debugging and live programming towards visual thinking in computer programming*](http://hdl.handle.net/10019.1/96853), covers some of the historical approaches, and explains the difference between omniscient debugging and true reverse debugging:

> The computer, having forward-executed the program up to some point, should really be able to provide us with information about it. Such an improvement is possible, and is found in what are called omniscient debuggers. They are usually classified as reverse debuggers, although they might more accurately be described as "history logging" debuggers, as they merely record information during execution to view or query later, rather than allow the programmer to actually step backwards in time in an executing program. "Omniscient" comes from the fact that the entire state history of the program, having been recorded, is available to the debugger after execution. There is then no need to rerun the program, and no need for manual code instrumentation.
> 
> Software-based omniscient debugging started with the 1969 EXDAMS system where it was called "debug-time history-playback". The GNU debugger, GDB, has supported omniscient debugging since 2009, with its 'process record and replay' feature. TotalView, UndoDB and Chronon appear to be the best omniscient debuggers currently available, but are commercial systems. TOD, for Java, appears to be the best open-source alternative, which makes use of partial deterministic replay, as well as partial trace capturing and a distributed database to enable the recording of the large volumes of information involved.
> 
> Debuggers that do not merely allow navigation of a recording, but are actually able to step backwards in execution time, also exist. They can more accurately be described as back-in-time, time-travel, bidirectional or reverse debuggers.
> 
> The first such system was the 1981 COPE prototype ...

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-06T23:39:41.553

我认为 VS 2010 应该有这样的东西。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-10T13:53:18.073

您可以考虑使用最新版本的 VMware Workstation 中提供的 VMware 的 Replay Debugging，例如参见[http://www.replaydebugging.com/2008/08/vmware-workstation-65-reverse-and.html](http://www.replaydebugging.com/2008/08/vmware-workstation-65-reverse-and.html)。[您可以在http://www.vmware.com/products/ws/](http://www.vmware.com/products/ws/)下载试用版，它适用于 Visual Studio。

（免责声明：我为 VMware 工作，但不在此产品上。）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-10-09T18:50:42.450

Yes, I've used it back in the 90th.. The Watcom C Debugger (understood FORTRAN and most other languages as well) had the option to let you step back and forward in time.

It's great, but not a big new thing...

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-09T10:12:09.097

I am using UndoDB on Linux instead of plain gdb for every debugging session. Reverse debugging is very useful and speeds up debugging significantly. You can start debugging from the symptom of the problem (e.g. assertion failure or some wrong message is printed) and debug backwards in time, looking for the root cause of the problem.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-04-28T07:38:26.230

**Mozilla `rr` open source trace based reverse debugging**

[https://github.com/mozilla/rr](https://github.com/mozilla/rr)

It is similar to UndoDB, but free and open source.

Only works on Linux [x86](https://github.com/mozilla/rr/issues/1373) unfortunately, because such tools require advanced OS features to work efficiently.

Here is a minimal example of rr in action: [How to go to the previous line in GDB?](https://stackoverflow.com/questions/1206872/how-to-go-to-the-previous-line-in-gdb/46996380#46996380)

# asp.net - What assembly are ASP.NET UserControls put into?

> ID：522625
> 
> 赞同：0
> 
> 时间：2009-02-06T23:13:38.250
> 
> 标签：asp.net, user-controls

Classes I create in **~/App_Code** are put into the **App_Code** assembly.

If I create the following ASP.NET UserControl:

**~/UserControls/BasicUserControl.ascx**

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="BasicUserControl.ascx.cs" Inherits="UserControl_BasicUserControl" %>
Hello world! 
```

**~/UserControls/BasicUserControl.ascx.cs**

```
using System;

public partial class UserControl_BasicUserControl : System.Web.UI.UserControl
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

What assembly would this dynamic ASP.NET UserControl be added to?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T23:16:59.833

Build your website then checkout the ASP.UserControls_BasicUserControl_ascx namespace/class

everytime you make a change to the .ascx you will have to build the project for the changes to show up in intellisense though

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T03:32:24.703

如果您打开新创建的 UserControl 程序集，您会发现 UserControl 的命名空间是 ASP。因此，这意味着当使用 register 指令在页面上注册用户控件时，您必须将命名空间称为 ASP。之后编译并重建您的应用程序，您将获得智能感知支持。

我已经创建了一个关于这种情况的视频让我知道，我会发布一个链接。

# c# - 在执行长时间运行的数据库任务时处理 Web 服务超时

> ID：522626
> 
> 赞同：13
> 
> 时间：2009-02-06T23:13:49.997
> 
> 标签：c#, sql-server, web-services, architecture, timeout

我们其中一款产品的架构是典型的 3 层解决方案：

*   C# 客户端
*   WCF 网络服务
*   SQL Server 数据库

客户端从 Web 服务请求信息。Web 服务访问数据库以获取信息并将其返回给客户端。

这就是问题所在。其中一些查询可能需要很长时间，而且我们预先不知道哪些查询会很慢。我们知道一些通常比其他的慢，但即使是最简单的请求也可能会因为足够的数据而变慢。有时对大量数据使用查询或运行报告。查询只能在庞大的数据量减慢查询速度之前进行优化。

如果数据库中的查询达到 SQL Server 中的最大查询超时，则数据库查询终止，并且 Web 服务向客户端返回错误。这是可以理解的。我们可以处理这些错误。

客户端正在等待 Web 服务调用完成。如果数据库调用需要很长时间，客户端可能会在调用 Web 服务时超时。客户端放弃，但数据库请求继续处理。此时，客户端与数据库不同步。数据库调用可能会也可能不会成功。可能有错误。客户永远不会知道。在某些情况下，我们不希望我们的用户发起另一个请求，这可能会在前一个请求完成后导致无效状态。

我很好奇其他人是如何处理这个问题的。 **您使用了哪些策略来防止 Web 服务超时影响数据库调用？**

我能想到的最好的想法是在某处建立一个实际的数据库层——在 Web 服务内部，连接到消息队列——一些东西。将每一个查询卸载到另一个进程似乎是多余的。（再说一次，我们并不总是知道给定的请求是快还是慢。）

如果我们可以将发出 HTTP 请求的行为与启动和运行数据库进程的行为分开，那就太好了。我在以前的公司看到过使用自定义服务器完成此操作，但它使用的是直接套接字通信，我宁愿避免用一些自定义应用程序替换 Web 服务。

请注意，考虑到我们处理的数据量，我们已经完成了查询优化。查询优化、索引等，仅在数据量大的情况下才带您到此为止。有时事情只需要很长时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-08T17:48:15.347

我过去遇到过类似的问题，并使用以下 3 种方法之一来解决它：

1.  将所有长时间运行的查询添加到队列中，并按顺序处理这些查询。
    在我的情况下，这些都是复杂的报告，然后通过电子邮件发送给客户，或者存储在永久的“临时”表格中，供客户在收到通知后查看。
2.  我们使用 JQuery 调用调用 Web 服务，然后在完成后调用 javascript 回发方法。
    当我们不想使页面加载与 Web 服务正在执行的操作同步时，这很有效。
    然而，这确实意味着在长时间运行的过程完成之前，该功能不可用。
3.  最复杂的一个。
    我们弹出了另一个窗口，其中显示了一个进度条，它也定期轮询服务器。
    这使用会话变量来确定显示进度条的距离。
    启动进度条后，启动了一个新线程，该线程定期更新相同的会话变量。
    一旦会话变量值设置为 100，弹出窗口就会自行关闭。
    客户喜欢这种方法。

无论如何，我希望其中之一对您有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-07T00:12:50.173

Web 服务可以在线程池中运行查询，如果线程没有在 5 秒内完成（请参阅 Thread.Join()），则 Web 服务调用会返回客户端一个 JobID，而不是客户端可以返回的结果集用于每隔几秒轮询一次服务器以查看其查询是否完成。当线程完成时，结果可以存储在哈希表中，直到客户端再次轮询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-18T16:38:16.467

我们最近使用的解决方案之一是将庞大的数据库进程分解为单独的并行操作。每个操作都小得多，并且设计得尽可能高效。客户端启动操作，产生几个线程，并并行执行他们可以做的任何事情。

例如，我们将一些庞大的流程分解为一系列步骤，例如开始、流程 1 工作块、完成和收集报告数据。Process Work 步骤可以并行运行，但在 Start 步骤完成之前它们无法启动。Finish 步骤需要等待所有 Process Work 步骤完成。

由于客户正在控制流程，因此客户可以准确报告其所处步骤的进度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-19T10:53:02.440

将问题分解成小块当然是个好主意。

除此之外以及其他人所说的（并且只有当您掌握了 web 服务的实现时）我一直在使用传递给 web 服务的回调 url。WS 必须在查询字符串或发布数据中出现错误或结果时调用它。

url 通常包含一个令牌，用于允许回调重新进入客户端，并映射到在接收到回调后执行操作所需的任何相关信息（存储在数据库或内存中）。

它有点重（特别是如果您还没有在网络服务器中运行），但可以保证在客户端超时但网络服务正确接收指令并且处理速度很慢的情况下成功往返。

一旦设置完成，您的 Web 服务实际上更接近于准备好异步运行，因此可以快速响应客户端：通常，做任何检查以回答是否可以，并在单独的循环中产生缓慢的操作，使用回调 url，以便它可以向客户端报告。

我不确定这是多么正统，顺便说一句，但它确实解决了实际问题。

# oracle - 数据泵导出的 Oracle 错误

> ID：522634
> 
> 赞同：1
> 
> 时间：2009-02-06T23:17:05.980
> 
> 标签：oracle, oracle10g, ora-04063

我收到以下错误。它不会一直发生，但一旦开始，它就不会停止。

```
处理对象类型SCHEMA_EXPORT/TABLE/TABLE_DATA
ORA-39125: 在调用 DBMS_METADATA.FETCH_XML_CLOB [] 时，KUPW$WORKER.GET_TABLE_DATA_OBJECTS 中的工作人员意外致命错误
ORA-31642: 以下 SQL 语句失败：
BEGIN "DMSYS"."DBMS_DM_MODEL_EXP".SCHEMA_CALLOUT(:1,0,1,'10.02.00.03.00'); 结尾;
ORA-06512: 在“SYS.DBMS_SYS_ERROR”，第 86 行
ORA-06512：在“SYS.DBMS_METADATA”，第 907 行
ORA-04063: 包体 "DMSYS.DBMS_DM_IMP_INTERNAL" 有错误
ORA-06508: PL/SQL: 找不到被调用的程序单元: "DMSYS.DBMS_DM_IMP_INTERNAL"
ORA-06512: 在“SYS.DBMS_SYS_ERROR”，第 95 行
ORA-06512：在“SYS.KUPW$WORKER”，第 6228 行
----- PL/SQL 调用栈 -----
  对象线对象
  句柄号码名称
000007FFA0B608F8 14916 包体 SYS.KUPW$WORKER
000007FFA0B608F8 6293 包体 SYS.KUPW$WORKER
000007FFA0B608F8 9108 包体 SYS.KUPW$WORKER
000007FFA0B608F8 1881 包体 SYS.KUPW$WORKER
000007FFA0B608F8 6854 包体 SYS.KUPW$WORKER
000007FFA0B608F8 1259 包体 SYS.KUPW$WORKER
000007FFBC77F128 2 匿名块
作业 "SYS"."SYS_EXPORT_SCHEMA_90" 由于致命错误在 12:31:55 停止

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T15:44:39.680

答：错误无关紧要，因为没有使用数据挖掘。导出仍然发生。

根据以下查询，原因似乎是 DMSYS 包无效

```
SQL> 连接系统/密码
SQL> 设置第 200 行
SQL>选择状态，
            object_id,
            对象类型，
            所有者||'.'||object_name "OWNER.OBJECT"
     来自 dba_objects
     其中状态！=“有效”
     按 4,2 排序；

```

下面应该解决这个问题，但我们没有安装数据挖掘包。

```
SQL> 连接 dmsys/dmsys
错误：
ORA-28000: 帐户被锁定
警告：您不再连接到 ORACLE。

SQL> CONNECT / as sysdba
连接的。

SQL> ALTER USER dmsys IDENTIFIED BY dmsys ACCOUNT UNLOCK;
用户更改。

SQL> 连接 dmsys/dmsys
连接的。

SQL> @$ORACLE_HOME/dm/admin/dmutil.plb
包创建。
包创建。

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T15:36:00.650

这可能没有帮助，但我很想知道包体`DMSYS.DBMS_DM_IMP_INTERNAL`中的错误是什么。跑步

```
SHOW ERRORS PACKAGE BODY DMSYS.DBMS_DM_IMP_INTERNAL; 
```

在 SQL*Plus 中应该列出它们。

# c++ - 对象应该在 C++ 中删除自己吗？

> ID：522637
> 
> 赞同：24
> 
> 时间：2009-02-06T23:17:49.320
> 
> 标签：c++, oop, memory-management, resource-cleanup, self-destruction

我在 C# 中度过了过去 4 年，因此我对 C++ 中当前的最佳实践和常见设计模式很感兴趣。考虑以下部分示例：

```
class World
{
public:
    void Add(Object *object);
    void Remove(Object *object);
    void Update();
}

class Fire : Object
{
public:
    virtual void Update()
    {
        if(age > burnTime)
        {
            world.Remove(this);
            delete this;
        }
    }
} 
```

在这里，我们有一个负责管理一组对象并定期更新它们的世界。火是一个可以在许多不同情况下添加到世界的对象，但通常是由世界上已经存在的另一个对象添加的。火是唯一知道它何时烧毁的对象，所以目前我让它自行删除。造成火灾的物体可能不再存在或不再相关。

这是明智的做法还是有更好的设计可以帮助清理这些物体？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-06T23:42:04.357

你做了`Update`一个虚函数，暗示派生类可以覆盖`Update`. 这带来了两大风险。

1.) 被覆盖的实现可能记得做 a `World.Remove`，但可能忘记`delete this`. 内存泄露了。

2.) 重写的实现调用基类`Update`，它执行 a `delete this`，但随后继续进行更多工作，但使用无效的 this 指针。

考虑这个例子：

```
class WizardsFire: public Fire
{
public:
    virtual void Update()
    {
        Fire::Update();  // May delete the this-object!
        RegenerateMana(this.ManaCost); // this is now invaild!  GPF!
    }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-06T23:49:52.297

这样做的问题是，您实际上是在对象和 World 类之间创建隐式耦合。

如果我尝试在 World 类之外调用 Update()，会发生什么？我可能最终会删除该对象，但我不知道为什么。职责似乎严重混淆。当您在编写此代码时没有想到的新情况下使用 Fire 类时，这将导致问题。如果对象应该从多个位置删除，会发生什么？也许它应该从世界、当前地图和玩家的库存中移除？您的更新功能会将其从世界中删除，然后删除该对象，并且下次地图或库存尝试访问该对象时，会发生坏事。

一般来说，我会说 Update() 函数删除它正在更新的对象是非常不直观的。我还要说一个对象删除自己是不直观的。该对象应该更有可能有某种方式来触发一个表明它已经完成燃烧的事件，任何有兴趣的人现在都可以对此采取行动。例如，将其从世界上移除。要删除它，请考虑所有权。

谁拥有该对象？世界？这意味着只有世界才能决定物体何时死亡。只要世界对对象的引用比对它的其他引用更持久，那很好。你认为对象拥有自己吗？那有什么意思？当对象不再存在时应该删除对象吗？没有意义。

但是如果没有明确定义的单一所有者，实现共享所有权，例如使用实现引用计数的智能指针，如`boost::shared_ptr`

但是在对象本身上有一个成员函数，它被硬编码以从*一个*特定列表中删除该对象，无论它是否存在于那里，以及它是否也存在于任何其他列表中，并且无论哪个列表都删除对象本身对它的引用是一个坏主意。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-06T23:29:36.080

在 C++ 中删除自己的对象并没有什么问题，大多数引用计数的实现都会使用类似的东西。但是，它被视为一种略微深奥的技术，您需要密切关注所有权问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-06T23:39:24.687

*如果对象没有*被分配并使用 new 构造，删除将失败并可能导致程序崩溃。此构造将阻止您在堆栈上或静态实例化类。在您的情况下，您似乎正在使用某种分配方案。如果你坚持这一点，这可能是安全的。不过，我当然不会这样做。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-06T23:33:42.767

我更喜欢更严格的所有权模式。世界应该拥有其中的对象并负责清理它们。要么让 world remove 这样做，要么让 update （或另一个函数）返回一个值，该值指示应该删除一个对象。

我也猜测在这种类型的模式中，您将希望引用计数对象以避免以悬空指针结束。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-06T23:47:28.853

它当然适用于由调用者创建的对象`new`以及当调用者`Update`正确了解该行为时。但我会避免它。在你的情况下，所有权显然在世界，所以我会让世界删除它。该对象不会自行创建，我认为它也不应该自行删除。如果您在对象上调用函数“更新”，可能会非常令人惊讶，但是突然间，如果 World 没有自己做任何事情（除了将其从列表中删除 - 但在另一个框架中），该对象就不再存在了！代码调用对象上的更新不会注意到）。

对此的一些想法

1.  将对象引用列表添加到 World。该列表中的每个对象都待删除。这是一种常用技术，在 wxWidgets 中用于已关闭但仍可能接收消息的顶级窗口。在空闲时间，当所有消息都处理完毕后，处理挂起列表，并删除对象。我相信 Qt 遵循类似的技术。
2.  告诉全世界该对象要被删除。世界将得到适当的通知，并将处理任何需要完成的事情。像一个`deleteObject(Object&)`可能的东西。
3.  `shouldBeDeleted`如果对象希望被其所有者删除，则向每个对象添加一个返回 true 的函数。

我更喜欢选项 3。世界会调用更新。之后，它会查看是否应该删除该对象，并且可以这样做 - 或者如果它愿意，它会通过手动将该对象添加到待删除列表中来记住该事实。

当您无法确定何时以及何时不能访问对象的函数和数据时，这真是令人头疼。例如，在 wxWidgets 中有一个 wxThread 类，它可以在两种模式下运行。其中一种模式（称为“可分离”）是，如果它的主函数返回（并且应该释放线程资源），它会删除自己（以释放 wxThread 对象占用的内存）而不是等待线程的所有者对象来调用等待或加入函数。然而，这会导致严重的头痛。你永远不能在它上面调用任何函数，因为它可能在任何情况下都被终止，而且你不能用 new 来创建它。相当多的人告诉我，他们非常不喜欢它的这种行为。

引用计数对象的自我删除很臭，恕我直言。让我们比较一下：

```
// bitmap owns the data. Bitmap keeps a pointer to BitmapData, which
// is shared by multiple Bitmap instances. 
class Bitmap {
    ~Bitmap() {
        if(bmp->dec_refcount() == 0) {
            // count drops to zero => remove 
            // ref-counted object. 
            delete bmp;
        }
    }
    BitmapData *bmp;
};

class BitmapData {
    int dec_refcount();
    int inc_refcount();

}; 
```

将其与自删除引用对象进行比较：

```
class Bitmap {
    ~Bitmap() {
        bmp->dec_refcount();
    }
    BitmapData *bmp;
};

class BitmapData {
    int dec_refcount() {
        int newCount = --count;
        if(newCount == 0) {
            delete this;
        }
        return newCount;
    }
    int inc_refcount();
}; 
```

我认为第一个更好，而且我相信设计良好的引用计数对象*不会*“删除它”，因为它增加了耦合：使用引用计数数据的类必须知道并记住数据将自身删除为减少引用计数的副作用。请注意“bmp”如何可能成为 ~Bitmap 的析构函数中的悬空指针。可以说，不这样做“删除这个”在这里要好得多。

回答类似问题[“删除这个有什么用”](https://stackoverflow.com/questions/447379/what-is-the-use-of-delete-this/447531#447531)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-06T23:36:23.290

这是一个相当常见的引用计数实现，我之前已经成功使用过。

但是，我也看到它崩溃了。我希望我能记住坠机的情况。[@abelenky](https://stackoverflow.com/questions/522637/should-objects-delete-themselves-in-c/522686#522686)是我见过它崩溃的一个地方。

它可能是您进一步子类化的地方`Fire`，但未能创建虚拟析构函数（见下文）。当您没有虚拟析构函数时，该`Update()`函数将调用`~Fire()`而不是适当的析构函数`~Flame()`。

```
class Fire : Object
{
public:
    virtual void Update()
    {
        if(age > burnTime)
        {
            world.Remove(this);
            delete this; //Make sure this is a virtual destructor.
        }
    }
};

class Flame: public Fire
{
private: 
    int somevariable;
}; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-07T03:23:12.333

其他人提到了“删除这个”的问题。简而言之，既然“世界”管理着火的创建，它也应该管理着它的删除。

另一个问题是，如果世界以仍在燃烧的大火而告终。如果这是可以摧毁火灾的唯一机制，那么您最终可能会出现孤儿或垃圾火灾。

对于您想要的语义，我将在您的“Fire”类（或 Object，如果适用）中有一个“active”或“alive”标志。然后这个世界有时会检查它的物品清单，并摆脱那些不再活跃的物品。

--

还有一点需要注意的是，您编写的代码具有从 Object 私有继承的 Fire，因为这是默认设置，尽管它比公共继承少得多。您可能应该明确表示这种继承，我怀疑您真的想要公共继承。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T23:32:33.657

除非必要或以非常直接的方式使用，否则执行“删除”通常不是一个好主意。在您的情况下，看起来 World 可以在删除对象时删除它，除非我们没有看到其他依赖项（在这种情况下，您的 delete 调用将导致错误，因为它们没有得到通知）。将所有权保留在对象之外可以让您的对象更好地封装和更稳定：对象不会因为选择删除自身而在某个时候变得无效。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-06T23:25:20.677

我不认为对象删除本身存在任何内在错误，但另一种可能的方法是让世界负责删除对象作为 ::Remove 的一部分（假设所有已删除的对象也被删除。）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-07T00:23:33.990

删除这个是非常危险的。它没有任何“错误”。这是合法的。但是当你使用它时有很多事情可能会出错，所以应该谨慎使用它。

考虑这样一种情况，有人打开了对象的指针或引用，然后它去删除自己。

在大多数情况下，我认为对象生命周期应该由创建它的同一个对象管理。它只是更容易知道破坏发生在哪里。

# cocoa - NSImage - 裁剪后 PDF 模糊

> ID：522639
> 
> 赞同：2
> 
> 时间：2009-02-06T23:18:11.003
> 
> 标签：cocoa, pdfkit

我正在尝试裁剪包含 PDF 的 NSImage。打印时，我使用 NSImage 的 drawInRect 让它只绘制我需要的东西 - 这很好用。

但是，现在我正在尝试创建一个仅包含裁剪区域的新 NSImage 。我玩了一会儿，然后在 CocoaBuilder 上找到了这段代码：

```
- (NSImage *) imageFromRect: (NSRect) rect
{
  NSAffineTransform * xform = [NSAffineTransform transform];

  // translate reference frame to map rectangle 'rect' into first quadrant
  [xform translateXBy: -rect.origin.x
                  yBy: -rect.origin.y];

  NSSize canvas_size = [xform transformSize: rect.size];

  NSImage * canvas = [[NSImage alloc] initWithSize: canvas_size];
  [canvas lockFocus];

  [xform concat];

  // Get NSImageRep of image
  NSImageRep * rep = [self bestRepresentationForDevice: nil];

  [rep drawAtPoint: NSZeroPoint];

  [canvas unlockFocus];
  return [canvas autorelease];
} 
```

这可行，但返回的 NSImage 模糊，不再适合打印。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-07T00:27:22.377

`lockFocus`/`unlockFocus`对图像缓存执行光栅绘制。这就是它“模糊”的原因——它的分辨率低并且可能配准错误。你需要矢量图。

使用 PDF 套件。首先，将每个页面的裁剪框设置为您的矩形。然后，您应该能够从`dataRepresentation`PDFDocument 中创建裁剪的 NSImage。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T01:46:34.743

这是执行 Peter Hosey 回答的代码。谢谢！

```
PDFDocument *thePDF = [[PDFDocument alloc] initWithData:pdfData];
PDFPage *thePage = [thePDF pageAtIndex:0];
NSRect pageCropRect = NSMakeRect(0, 100, 100, 100);

[thePage setBounds:pageCropRect forBox:kPDFDisplayBoxMediaBox];
NSImage *theCroppedImage = [[NSImage alloc] initWithData:[thePage dataRepresentation]]; 
```

# exchange-server - How do you screen for legacy or linked mailboxes?

> ID：522648
> 
> 赞同：0
> 
> 时间：2009-02-06T23:24:19.837
> 
> 标签：exchange-server, exchange-management-shell

I've noticed when I pull up exchange management console, it shows mailboxes which have the "Recipient Type Details" as Legacy Mailboxes.

How do I go about querying which ones are legacy, user or linked mailboxes?

I've tried

```
get-mailbox -identity <displayname> | select deleteditemflags 
```

but that doesn't seem to work.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T16:06:37.050

This will get you all Legacy or Linked mailboxes:

```
Get-Mailbox -resulteSize unlimited -RecipientTypeDetails LegacyMailbox,LinkedMailbox 
```

For just one user:

```
Get-Mailbox -Identity userName -RecipientTypeDetails LegacyMailbox,LinkedMailbox 
```

EDIT:
Get all mailboxes name and type

```
Get-Mailbox | Format-Table Name,RecipientTypeDetails 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-30T21:55:12.673

您可以通过 Get-MailboxStatistics 获取已禁用和软删除的邮箱。有关详细信息，请参阅此链接： [https ://technet.microsoft.com/en-us/library/mt577269(v=exchg.160).aspx](https://technet.microsoft.com/en-us/library/mt577269(v=exchg.160).aspx)

要查找硬删除的邮箱，您必须查找墓碑：

```
var path = "GC://{YourGlobalCatalogFQDN}";
var root = new DirectoryEntry(path, username, password);
var filter = "(objectClass=person)(isDeleted=TRUE)(msExchMailboxGuid=*)(cn=*)";          //tombstone mailboxes don't have 'objectCategory' property
var props = "objectClass sAMAccountName objectGUID msExchMailboxGuid cn whenChanged isDeleted".Split(' ');   //tombstone mailboxes don't have 'mail' property
var ds = new DirectorySearcher(root, filter, props, SearchScope.Subtree);
ds.Tombstone = true;
using (var mailboxes = ds.FindAll())
{
    foreach (SearchResult mailbox in mailboxes)
    { ... }
} 
```

# awk - 从哪里开始使用简单的 AWK 示例？

> ID：522656
> 
> 赞同：2
> 
> 时间：2009-02-06T23:27:12.000
> 
> 标签：awk

我所有的代码都失败了。他们应该分别打印“he”、“hello”和“5 \n 3”：

```
awk -v e='he' {print $e}       // not working, why?
awk NF { print hello }
awk { print ARGV[5,3] } 
```

**有一些关于 AWK 的简单例子吗？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T23:31:36.357

首先，你不要在 awk 中使用 $ 作为变量，试试这个：

```
fury> echo | awk -v e='he' '{print e}'
he 
```

第二，你的条件 NF 意味着 NF!=0 所以它只会打印非空行：

```
fury> echo | awk 'NF {print "hello"}'
fury> echo "7 8" | awk 'NF {print "hello"}'
hello 
```

我从未见过您的第三个语法，ARGV 是一维数组，因此您可以使用：

```
fury> awk 'BEGIN {print ARGV[5]}' 1 2 3 4 5 6 7
5
fury> awk 'BEGIN {print ARGV[5] "\n" ARGV[3]}' 1 2 3 4 5 6 7
5
3 
```

请注意，我在第三个中使用 BEGIN 块，否则它将尝试将 1、2、3、... 作为文件打开和处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T00:22:18.813

首先，基本的 shell 脚本健全性：

*   始终将您的脚本用单引号引起来

请注意，脚本是单个参数 - 或带有 ' `-f file`' 的文件名。

awk 脚本是一系列 ' `<pattern> <action>`' 对。为了清楚起见，动作用大括号 ' `{}`' 括起来 - 再次保持理智。

正如 Pax 所说，第一个例子应该是：

```
awk -v -e e='he' '{ print e }' 
```

第二个例子是不可思议的——你可能的意思是：

```
awk '{ print "hello" }' 
```

变量 NF 是行中的字段数。你可能会得到 awk 来解释

```
awk 'NF { print "hello" }' 
```

好像输入行上有任何数据（NF！= 0，或字段数不为零），然后打印'hello'。

最后一个例子同样令人费解。ARGV 是 'awk' 的参数数组，命令行没有提供任何参数。但它是一个一维数组。您的下标符号希望将其视为 Python 字典或 Perl 哈希，并结合了两个索引。没关系 - awk 支持关联数组；但由于您没有在 ARGV[5,2] 的数组中添加任何内容，因此它不会打印任何内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T00:22:05.087

尝试：

```
echo "hello" | awk ' {print $0} '
echo "hello" | awk ' {print $1} ' 
```

注意 $0 返回整个记录，$1 只是第一个条目；awk 的计数器从 1 开始。所以

```
echo "hello1 hello2 hello3" | awk ' {print $0} ' 
```

返回 hello1 hello2 hello3。尽管

```
echo "hello1 hello2 hello3" | awk ' {print $3} ' 
```

将返回 hello3

我喜欢这个[awk 教程。](http://sparky.rice.edu/~hartigan/awk.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T23:38:33.740

我使用这个[网站。](http://people.cs.uu.nl/piet/docs/nawk/nawk_toc.html)O'Reilly [Sed & Awk](https://rads.stackoverflow.com/amzn/click/com/1565922255)的书也不错。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-31T16:38:43.860

此外，[http://awk.info上有很多有用的信息和教程](http://awk.info)

# jquery - 多个ajax调用处理

> ID：522666
> 
> 赞同：3
> 
> 时间：2009-02-06T23:32:30.427
> 
> 标签：jquery, ajax

我正在使用 jQuery 进行一些 ajax 调用，并想知道人们如何处理这种情况。

1.  向服务器发出 ajax 请求以检索一些信息。
2.  在请求返回之前发出另一个请求。第一个请求现在无效且已过期。

我如何判断初始请求现在无效并且在返回时可以忽略。我只想显示第二个请求的结果并忽略（或取消）第一个请求。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-06T23:53:33.210

jQuery`XmlHttpRequest`从调用返回对象`ajax()`，我用它来实现你想要的，如下所示：

```
var lastRequest;
function getSomeData() {
    if(lastRequest) {
        lastRequest.abort();
        lastRequest = null
    }
    lastRequest = $.ajax(...);
} 
```

最终效果是，如果发出后续请求，则忽略较早请求的响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T23:38:27.483

保留标识请求的变量（例如：“request_id”）的记录。在每次新请求时将变量加 1。仅当服务器返回的 request_id 等于您在客户端上的变量时才处理请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T23:37:41.947

我以前从未遇到过这种情况，但是您可以发送一个在发出请求时递增的密钥，并将密钥与响应一起发回。当响应到达时，您可以检查密钥以查看它是否符合您的预期。

```
var incrementor = 1;
var lastSent = 0;

jQuery(document).ready(function() {

    jQuery('a.submitter').click(function(event) {
        event.preventDefault();
        lastSent = incrementor;
        incrementor++;
        jQuery.post(
            'some-url.php',
            {
                'request-id': lastSent,
                'other-data': 'some-data'
            },
            function( data, textStatus ) {
                if( data.requestId == lastSent ) {
                    // Do stuff
                }
            },
            'json'
        );
    });

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-06T23:38:19.853

“我如何判断初始请求现在无效”

你不要……！您在客户端层对 Ajax 请求进行排队，在之前的请求返回*并*完成对 DOM 的操作之前不要让它们触发......

您可以在我关于“如何创建 Ajax 库”的博客中获得有关如何执行此操作的一些详细信息；[http://ra-ajax.org/how-to-create-an-ajax-library-part-7-the-ra-ajax-class.blog](http://ra-ajax.org/how-to-create-an-ajax-library-part-7-the-ra-ajax-class.blog)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-07T02:46:01.207

我不想涉及服务调用，您可能并不总是可以控制服务定义。我想看到这样的东西

```
$(function() {
    $('.ajaxButton').click(function() {
        $.currentCallId = (new Date()).getTime();

        $.ajax({
            type: "get",
            url: 'http://www.google.com/',
            beforeSend: function(xhr) {
                this.callId = $.currentCallId;
            },
            success: function(data) {
                if (this.callId === $.currentCallId) {
                    // process it
                } else {
                    // throw it out
                }
            }
        });
    });
}); 
```

# c# - 如何修复：对于不返回任何键列信息的 SelectCommand，不支持为 DeleteCommand 生成动态 SQL

> ID：522710
> 
> 赞同：6
> 
> 时间：2009-02-06T23:54:24.610
> 
> 标签：c#, sql, ms-access, primary-key

我的代码有效。在我复制了大约 10 个表后，我得到了一个错误。`Dynamic SQL generation for the DeleteCommand is not supported against a SelectCommand that does not return any key column information.`好的，我知道我需要生成一个主键。但是为什么我可以复制 10 个左右的表，然后我得到错误。每一行都必须返回一个主键吗？如果一行没有主键，我如何生成一个？

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.OleDb;
using System.IO;
using System.Linq;
using System.Text;

namespace LCR_ShepherdStaffupdater_1._0
{
    public class DatabaseHandling
    {
        static DataTable datatableB = new DataTable();
        static DataTable datatableA = new DataTable();
        public static DataSet datasetA = new DataSet();
        public static DataSet datasetB = new DataSet();
        static OleDbDataAdapter adapterA = new OleDbDataAdapter();
        static OleDbDataAdapter adapterB = new OleDbDataAdapter();
        static string connectionstringA = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Settings.getfilelocationA();
        static string connectionstringB = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Settings.getfilelocationB();
        static OleDbConnection dataconnectionB = new OleDbConnection(connectionstringB);
        static OleDbConnection dataconnectionA = new OleDbConnection(connectionstringA);
        static DataTable tableListA;
        static DataTable tableListB;

        static public void addTableA(string table, bool addtoDataSet)
        {
            dataconnectionA.Open();
            datatableA = new DataTable(table);
            try
            {
                OleDbCommand commandselectA = new OleDbCommand("SELECT * FROM [" + table + "]", dataconnectionA);
                adapterA.SelectCommand = commandselectA;
                adapterA.Fill(datatableA);
            }
            catch
            {
                Logging.updateLog("Error: Tried to get " + table + " from DataSetA. Table doesn't exist!", true, false, false);
            }

            if (addtoDataSet == true)
            {
                datasetA.Tables.Add(datatableA);
                Logging.updateLog("Added DataTableA: " + datatableA.TableName.ToString() + " Successfully!", false, false, false);
            }

            dataconnectionA.Close();
        }

        static public void addTableB(string table, bool addtoDataSet)
        {
            dataconnectionB.Open();
            datatableB = new DataTable(table);

            try
            {
                OleDbCommand commandselectB = new OleDbCommand("SELECT * FROM [" + table + "]", dataconnectionB);
                adapterB.SelectCommand = commandselectB;
                adapterB.Fill(datatableB);
            }
            catch
            {
                Logging.updateLog("Error: Tried to get " + table + " from DataSetB. Table doesn't exist!", true, false, false);
            }

            if (addtoDataSet == true)
            {
                datasetB.Tables.Add(datatableB);
                Logging.updateLog("Added DataTableB: " + datatableB.TableName.ToString() + " Successfully!", false, false, false);
            }

            dataconnectionB.Close();
        }

        static public string[] getTablesA(string connectionString)
        {
            dataconnectionA.Open();
            tableListA = dataconnectionA.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new Object[] { null, null, null, "TABLE" });
            string[] stringTableListA = new string[tableListA.Rows.Count];

            for (int i = 0; i < tableListA.Rows.Count; i++)
            {
                stringTableListA[i] = tableListA.Rows[i].ItemArray[2].ToString();
            }
            dataconnectionA.Close();
            return stringTableListA;
        }

        static public string[] getTablesB(string connectionString)
        {
            dataconnectionB.Open();
            tableListB = dataconnectionB.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new Object[] { null, null, null, "TABLE" });
            string[] stringTableListB = new string[tableListB.Rows.Count];

            for (int i = 0; i < tableListB.Rows.Count; i++)
            {
                stringTableListB[i] = tableListB.Rows[i].ItemArray[2].ToString();
            }
            dataconnectionB.Close();
            return stringTableListB;
        }

        static public void createDataSet()
        {

            string[] tempA = getTablesA(connectionstringA);
            string[] tempB = getTablesB(connectionstringB);
            int percentage = 0;
            int maximum = (tempA.Length + tempB.Length);

            Logging.updateNotice("Loading Tables...");
            Logging.updateLog("Started Loading File A", false, false, true);
            for (int i = 0; i < tempA.Length ; i++)
            {
                if (!datasetA.Tables.Contains(tempA[i]))
                {
                    addTableA(tempA[i], true);
                    percentage++;
                    Logging.loadStatus(percentage, maximum);
                }
                else
                {
                    datasetA.Tables.Remove(tempA[i]);
                    addTableA(tempA[i], true);
                    percentage++;
                    Logging.loadStatus(percentage, maximum);
                }
            }
            Logging.updateLog("Finished loading File A", false, false, true);
            Logging.updateLog("Started loading File B", false, false, true);
            for (int i = 0; i < tempB.Length ; i++)
            {
                if (!datasetB.Tables.Contains(tempB[i]))
                {
                    addTableB(tempB[i], true);
                    percentage++;
                    Logging.loadStatus(percentage, maximum);
                }
                else
                {
                    datasetB.Tables.Remove(tempB[i]);
                    addTableB(tempB[i], true);
                    percentage++;
                    Logging.loadStatus(percentage, maximum);
                }
            }
            Logging.updateLog("Finished loading File B", false, false, true);
            Logging.updateLog("Both files loaded into memory successfully", false, true, false);

        }

        static public DataTable getDataTableA()
        {
            datatableA = datasetA.Tables[Settings.textA];

            return datatableA;
        }
        static public DataTable getDataTableB()
        {
            datatableB = datasetB.Tables[Settings.textB];
            return datatableB;
        }

        static public DataSet getDataSetA()
        {
            return datasetA;
        }

        static public DataSet getDataSetB()
        {
            return datasetB;
        }

        static public void InitiateCopyProcessA()
        {
            DataSet tablesA;
            tablesA = DatabaseHandling.getDataSetA();
            int percentage = 0;
            int maximum = (tablesA.Tables.Count);

                foreach (DataTable table in tablesA.Tables)
                {
                    Logging.loadStatus(percentage, maximum);
                    OverwriteTable(table, table.TableName);
                    Logging.updateLog("Copied " + table.TableName + " successfully.", false, true, false);
                    percentage++;
                }

        }

        static void OverwriteTable(DataTable sourceTable, string tableName)
        {
            using (var destConn = new OleDbConnection(connectionstringA))
            using (var destCmd = new OleDbCommand(tableName, destConn) { CommandType = CommandType.TableDirect })
            using (var destDA = new OleDbDataAdapter(destCmd))

            {
                // Since we're using a single table, we can have the CommandBuilder
                // generate the appropriate INSERT and DELETE SQL statements
                using (var destCmdB = new OleDbCommandBuilder(destDA))
                {
                    destCmdB.QuotePrefix = "["; // quote reserved column names
                    destCmdB.QuoteSuffix = "]";
                    destDA.DeleteCommand = destCmdB.GetDeleteCommand();
                    destDA.InsertCommand = destCmdB.GetInsertCommand();

                    // Get rows from destination, and delete them
                    var destTable = new DataTable();
                    destDA.Fill(destTable);
                    foreach (DataRow dr in destTable.Rows)
                    {
                        dr.Delete();
                    }

                     destDA.Update(destTable);

                    // Set rows from source as Added, so the DataAdapter will insert them
                    foreach (DataRow dr in sourceTable.Rows)
                    {
                        dr.SetAdded();
                    }
                    destDA.Update(sourceTable);
                }
            }
        }

        }          
    } 
```

谷歌在这方面对我帮助不大。请提供一个编码示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T00:09:42.630

没有编码示例真的会起作用。您必须从表中确定表的唯一标识符是什么。如果没有主键（或至少没有唯一索引），那么您就不走运了。

解决此问题的唯一方法是自己创建一个动态命令，它将表中的每个值与您要删除的记录进行比较。如果它们相同，则删除它们。

但是，您冒着从表中删除多行的风险，因为表中可能有多行具有相同的值。

# c# - 如何将 CSS 样式表添加到 WCF 生成的 RSS 提要？

> ID：522712
> 
> 赞同：0
> 
> 时间：2009-02-06T23:56:51.283
> 
> 标签：c#, asp.net, wcf, rss, syndication-feed

我有一个使用 System.ServiceModel.Syndication.SyndicationFeed 创建 RSS 提要的 WCF 服务。

但是我无法弄清楚如何将处理指令添加到指向我的 CSS 样式表的输出。

我需要的是一个看起来有点像这样的处理指令：

```
<?xml-stylesheet type="text/css" href="http://you.com/rss.css" ?> 
```

任何人都提示您如何使用 SyndicationFeed 添加它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T00:23:02.137

我不熟悉 WCF，但我发现[了这个](http://www.developmentnow.com/g/8_2008_2_0_0_1041398/xslt-and-System-ServiceModel-Syndication.htm). 我想这可能会帮助你。

[http://www.developmentnow.com/g/8_2008_2_0_0_1041398/xslt-and-System-ServiceModel-Syndication.htm](http://www.developmentnow.com/g/8_2008_2_0_0_1041398/xslt-and-System-ServiceModel-Syndication.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T00:24:14.380

由于您的合同将返回一个实现 IXmlSerializable 的 SyndicationFeedFormatter 实例，因此我会让您在服务合同上的方法获取该实例，然后调用 IXmlSerializable 上的方法以将输出序列化为 XML。然后，您可以将处理指令添加到 XML（XDocument 或 XmlDocument），然后将这些内容传回。

# c# - 如何比较 2 个 XML 文档？

> ID：522713
> 
> 赞同：2
> 
> 时间：2009-02-06T23:57:11.393
> 
> 标签：c#, linq, linq-to-xml

我有两个相似的文档，但我需要找到一种优雅而有效的方法来比较这两个文件并返回 Doc #1 中不存在于 Doc #2 中的值。

XML 文档 #1

```
 <ids>
        <id>1</id>
        <id>2</id>
        <id>5</id>
        <id>6</id>
        <id>7</id>
        <id>8</id>
        <id>9</id>
       </ids>
    </ids> 
```

XML 文档 #2

```
 <ids>
    <id>1</id>
    <id>2</id>
    <id>7</id>
    <id>8</id>
    <id>9</id>
  </ids> 
```

如果我可以在 id 字段上加入这两个文档，我正在考虑使用 linq。有没有更好的办法？我希望返回 id #s 5 和 6。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T01:04:47.653

这是一个我知道有效的示例，我只用小文件进行了尝试（File1.xml 有 20 个项目，File2.xml 有 8 个项目）。

```
XDocument file1Doc = XDocument.Load("File1.xml");
XDocument file2Doc = XDocument.Load("File2.xml");

IEnumerable<string> file1Elements = from d in file1Doc.Descendants("Id")
                                    select d.Value;

IEnumerable<string> file2Elements = from d in file2Doc.Descendants("Id")
                                    select d.Value;

var difference = file1Elements.Except(file2Elements); 
```

或者，可能更符合您的要求的是：

```
XDocument file1Doc = XDocument.Load("File1.xml");
XDocument file2Doc = XDocument.Load("File2.xml");

IEnumerable<string> file2Elements = from d in file2Doc.Descendants("Id")
                                    select d.Value;

var x = from include in file1Doc.Descendants("Id")
        where file2Elements.Contains(include.Value) != true
        select include; 
```

您还可以[在 MSDN 上查看 101 LINQ Samples](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)找到一些帮助。

# ruby-on-rails - 从字符串中删除重音符号/变音符号，同时保留其他特殊字符（尝试 mb_chars.normalize 和 iconv）

> ID：522715
> 
> 赞同：10
> 
> 时间：2009-02-06T23:58:12.437
> 
> 标签：ruby-on-rails, ruby, string, diacritics

已经有一个非常[相似的问题](https://stackoverflow.com/questions/225471/how-do-i-replace-accented-latin-characters-in-ruby)。其中一种解决方案使用如下代码：

```
string.mb_chars.normalize(:kd).gsub(/[^x00-\x7F]/n, '').to_s 
```

这很神奇，直到你注意到它还删除了空格、点、破折号，谁知道还有什么。

我不太确定第一个代码是如何工作的，但可以让它*只*去除重音吗？或者至少得到一个要保存的字符列表？我对正则表达式的了解很少，但我尝试过（无济于事）：

```
/[^\-x00-\x7F]/n # So it would leave the dash alone 
```

我即将做这样的事情：

```
string.mb_chars.normalize(:kd).gsub('-', '__DASH__').gsub
  (/[^x00-\x7F]/n, '').gsub('__DASH__', '-').to_s 
```

残暴？是的...

我也试过：

```
iconv = Iconv.new('UTF-8', 'US-ASCII//TRANSLIT') # Also tried ISO-8859-1
iconv.iconv 'Café' # Throws an error: Iconv::IllegalSequence: "é" 
```

请帮忙？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-07T01:00:08.910

> 它还删除了空格、点、破折号，还有谁知道还有什么。

它不应该。

```
string.mb_chars.normalize(:kd).gsub(/[^x00-\x7F]/n, '').to_s 
```

您打错了，x00 之前应该有一个反斜杠，以引用 NUL 字符。

```
/[^\-x00-\x7F]/n # So it would leave the dash alone 
```

您已将“-”放在“\”和“x”之间，这将破坏对空字符的引用，从而破坏范围。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-14T11:27:02.073

我会使用这种`transliterate`方法。请参阅[http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-transliterate](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-transliterate)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T01:04:25.233

它不像 Iconv 那样整洁，但可以满足我的要求：

[http://snippets.dzone.com/posts/show/2384](http://snippets.dzone.com/posts/show/2384)

# javascript - javascript和css加载

> ID：522719
> 
> 赞同：2
> 
> 时间：2009-02-07T00:01:08.123
> 
> 标签：javascript, css, performance, browser

我想知道，如果我有，假设一个页面上包含 6 个 javascripts，并且同一页面上还包含 4-5 个 css，如果我创建一个或两个文件，它实际上是否使页面加载成为最佳选择将它们全部附加在一起而不是一堆？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-07T00:04:50.143

是的。它会以更少的文件获得更好的性能。

这有几个原因，我相信其他人会加入，因为我不会全部列出。

1.  除了文件大小之外，请求中还有开销，例如请求本身、标头、cookie（如果已发送）等。即使在许多缓存场景中，浏览器也会发送请求以查看文件是否已被修改。当然，正确的标头/服务器配置可以帮助解决这个问题。

2.  默认情况下，浏览器具有有限数量的同时连接，它将一次打开到给定域。我相信 IE 有 2 个，而 firefox 有 4 个（我可能弄错了数字）。不管怎样，关键是，如果你有 10 个图像，5 个 js 文件和 2 个 css 文件，那么需要下载 17 个项目，同时只完成几个，其余的只是排队。

我知道这些是模糊和简单的解释，但我希望它能让你走上正轨。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T00:09:21.820

您的目标之一是减少 http 请求，所以是的。名为 yslow 的工具可以对您的应用程序进行评分，以帮助您了解可以做些什么来获得更好的用户体验。

[http://developer.yahoo.com/yslow/](http://developer.yahoo.com/yslow/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-07T00:58:04.390

即使浏览器执行多个请求，它也会尝试打开最少数量的 TCP 连接（请参阅 Keep-Alive HTTP 标头选项文档）。通过在服务器端设置压缩（DEFLATE 或 GZIP）模式也可以提高网页加载速度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T00:09:21.990

每个包含都是用户浏览器必须发出的单独的 HTTP 请求，并且 HTTP 请求会产生开销（在服务器和连接上）。组合多个 CSS 和 JavaScript 文件将使您和您的用户更轻松。

这也可以通过一种称为 CSS sprites 的技术来处理图像。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-07T00:09:22.507

是的。这样，您发出的 HTTP 请求就更少了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T00:11:24.467

最好的解决方案是将所有代码添加到一个页面，以便浏览器可以在一个 GET 请求中获取它。如果您要链接到多个文件，则每次加载页面时浏览器都必须请求这些外部页面。

如果在浏览器中启用了流水线并且站点没有产生太多流量，这可能不会导致问题。

谷歌已经将他们的代码简化为一体。我什至无法想象有多少请求通过如此多的流量节省并减轻了服务器上的负载。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-14T12:58:00.060

不再有任何理由在一方面为了组织而想要对 js 和 css 文件进行分区，另一方面为了效率而想要拥有很少的文件之间感到纠结。有一些工具可以让您实现两者。

例如，您可以将[Blender](http://github.com/front-end/front-end-blender/tree/master)合并到您的构建过程中以聚合（和压缩）CSS 和 JavaScript 资产。Java 开发人员应该看看[JAWR](https://jawr.dev.java.net/)，它是最先进的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-07T00:12:55.870

我对影响服务器负载的因素并不是很精通，但是我认为最好的办法是在拥有一大块和将脚本组织成有意义的单独文件之间找到平衡。我认为拥有五个左右不同的文件不会对性能产生太大影响。

一个更有影响力的因素是脚本的压缩，有各种在线实用程序可以摆脱空白并使用更有效的变量名，我认为这些将比将文件放在一起带来更显着的改进。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-12T19:44:49.193

正如其他人所说，是的，您可以包含的文件越少越好。

我强烈推荐使用[Blender](http://github.com/cgriego/front-end-blender/tree/master)来压缩和合并多个 CSS/JS 文件。如果您像我一样，并且经常以 10-15 个样式表结束（重置、屏幕、打印、主页、关于、产品、搜索等），那么这个工具会很有帮助。

# ruby - 在 Ruby 中将方法作为参数传递

> ID：522720
> 
> 赞同：137
> 
> 时间：2009-02-07T00:02:01.443
> 
> 标签：ruby, parameters, methods

我正在尝试用 Ruby 来解决一些问题。因此，我尝试实现“编程集体智能”Ruby 一书中的算法（用 Python 给出）。

在第 8 章中，作者传递了一个方法 a 作为参数。这似乎在 Python 中有效，但在 Ruby 中无效。

我这里有方法

```
def gaussian(dist, sigma=10.0)
  foo
end 
```

并想用另一种方法调用它

```
def weightedknn(data, vec1, k = 5, weightf = gaussian)
  foo
  weight = weightf(dist)
  foo
end 
```

我得到的只是一个错误

```
ArgumentError: wrong number of arguments (0 for 1) 
```

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-02-07T15:50:15.820

引用块和 Procs 的注释是正确的，因为它们在 Ruby 中更常见。但是如果你愿意，你可以传递一个方法。您调用`method`获取方法并`.call`调用它：

```
def weightedknn( data, vec1, k = 5, weightf = method(:gaussian) )
  ...
  weight = weightf.call( dist )
  ...
end 
```

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2009-02-07T00:24:38.637

你想要一个 proc 对象：

```
gaussian = Proc.new do |dist, *args|
  sigma = args.first || 10.0
  ...
end

def weightedknn(data, vec1, k = 5, weightf = gaussian)
  ...
  weight = weightf.call(dist)
  ...
end 
```

请注意，您不能在这样的块声明中设置默认参数。因此，您需要使用 splat 并在 proc 代码本身中设置默认值。

* * *

或者，根据您的所有范围，传递方法名称可能更容易。

```
def weightedknn(data, vec1, k = 5, weightf = :gaussian)
  ...
  weight = self.send(weightf)
  ...
end 
```

在这种情况下，您只是调用在对象上定义的方法，而不是传入完整的代码块。根据您的结构，您可能需要替换`self.send`为`object_that_has_the_these_math_methods.send`

* * *

最后但并非最不重要的一点是，您可以暂停该方法。

```
def weightedknn(data, vec1, k = 5)
  ...
  weight = 
    if block_given?
      yield(dist)
    else
      gaussian.call(dist)
    end
  end
  ...
end

weightedknn(foo, bar) do |dist|
  # square the dist
  dist * dist
end 
```

但听起来你想要更多可重用的代码块。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2010-11-04T08:39:47.520

您可以使用方式将方法作为参数传递`method(:function)`。下面是一个非常简单的例子：

```
定义双（一）
  返回一个 * 2
结尾
=> 无

def method_with_function_as_param（回调，数字）
  callback.call(号码)
结尾
=> 无

method_with_function_as_param（方法（：双），10）
=> 20

```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-02-07T00:41:04.580

正常的 Ruby 方法是使用块。

所以它会是这样的：

```
def weightedknn( data, vec1, k = 5 )
  foo
  weight = yield( dist )
  foo
end 
```

并使用如下：

```
weightenknn( data, vec1 ) { |dist| gaussian( dist ) } 
```

这种模式在 Ruby 中被广泛使用。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-12-30T11:04:01.340

您可以在方法实例`&`上使用运算符将​​方法*转换为块*。`Method`

 *例子：

```
def foo(arg)
  p arg
end

def bar(&block)
  p 'bar'
  block.call('foo')
end

bar(&method(:foo)) 
```

更多详细信息，[请访问 http://weblog.raganwald.com/2008/06/what-does-do-when-used-as-unary.html](http://weblog.raganwald.com/2008/06/what-does-do-when-used-as-unary.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T00:06:59.000

您必须调用函数对象的方法“调用”：

```
weight = weightf.call( dist ) 
```

编辑：正如评论中所解释的，这种方法是错误的。如果您使用 Procs 而不是普通函数，它将起作用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-31T12:23:42.407

我建议使用 & 来访问函数中的命名块。按照[本文](http://eli.thegreenplace.net/2006/04/18/understanding-ruby-blocks-procs-and-methods/)中给出的建议，您可以编写类似这样的内容（这是我工作程序中的真正废品）：

```
 # Returns a valid hash for html form select element, combined of all entities
  # for the given +model+, where only id and name attributes are taken as
  # values and keys correspondingly. Provide block returning boolean if you
  # need to select only specific entities.
  #
  # * *Args*    :
  #   - +model+ -> ORM interface for specific entities'
  #   - +&cond+ -> block {|x| boolean}, filtering entities upon iterations
  # * *Returns* :
  #   - hash of {entity.id => entity.name}
  #
  def make_select_list( model, &cond )
    cond ||= proc { true } # cond defaults to proc { true }
    # Entities filtered by cond, followed by filtration by (id, name)
    model.all.map do |x|
      cond.( x ) ? { x.id => x.name } : {}
    end.reduce Hash.new do |memo, e| memo.merge( e ) end
  end 
```

Afterwerds，你可以这样调用这个函数：

```
@contests = make_select_list Contest do |contest|
  logged_admin? or contest.organizer == @current_user
end 
```

如果您不需要过滤您的选择，您只需省略该块：

```
@categories = make_select_list( Category ) # selects all categories 
```

Ruby 块的强大功能就这么多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-04T23:52:10.453

[与Proc](https://stackoverflow.com/a/522771/9527665)或[方法调用](https://stackoverflow.com/a/523996/9527665)类似，您也可以将 lambda 作为`weightf`参数传递：

```
def main
  gaussian = -> (params) {
    ...
  }
  weightedknn(data, vec1, k = 5, gaussian, params)
  # Use symbol :gaussian if method exists instead
end 
```

```
def weightedknn(data, vec1, k = 5, weightf, params)
  ...
  weight = weightf.call(params)
  ...
end 
```

* * *

## 回答 #9

> 赞同：-7
> 
> 时间：2015-03-18T06:11:24.763

您也可以使用“eval”，并将该方法作为字符串参数传递，然后简单地在另一个方法中对其进行评估。

# java - 基本的 Spring 帮助

> ID：522728
> 
> 赞同：0
> 
> 时间：2009-02-07T00:07:05.257
> 
> 标签：java, spring

我正在尝试我的第一个 Spring 项目，并且必须做一些非常愚蠢的事情，因为我不知道如何让以下简单的代码片段工作：

这是我的定义文件：

```
 <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="AWSProperties" class="com.addy.server.queue.AWSProperties" scope="singleton">
        <property name="awsAccessKey" value="test1"/>
        <property name="awsSecretKey" value="test2"/>
        <property name="awsSQSQueueName" value="testqueue"/>
    </bean>

    <bean id="QueueService" class="com.addy.server.queue.QueueService">
     <constructor-arg ref="AWSProperties"/>
    </bean>

</beans> 
```

还有我的两个简单的豆子：

```
public class AWSProperties {

    private String awsAccessKey;
    private String awsSecretKey;
    private String awsSQSQueueName;

    public void setAwsAccessKey(String awsAccessKey) {
        awsAccessKey = awsAccessKey;
    }

    public String getAwsAccessKey() {
        return awsAccessKey;
    }

    public void setAwsSecretKey(String awsSecretKey) {
        awsSecretKey = awsSecretKey;
    }

    public String getAwsSecretKey() {
        return awsSecretKey;
    }

    public void setAwsSQSQueueName(String awsSQSQueueName) {
        awsSQSQueueName = awsSQSQueueName;
    }

    public String getAwsSQSQueueName() {
        return awsSQSQueueName;
    }

}

public class QueueService {

    private AWSProperties properties;

    public QueueService(AWSProperties properties)
    {
        this.properties = properties;
    }

    public void receiveMessage()
    {
        System.out.println(properties.getAwsAccessKey());
    }

} 
```

当我运行以下代码段时，我期待“test1”时得到“null”

```
 public class VMMConsumer {

    public static void main(String[] args) 
    {

        ApplicationContext context = new ClassPathXmlApplicationContext(new String[] {"VMMConsumer.xml"});

        QueueService service = (QueueService)context.getBean("QueueService");

        service.receiveMessage();   

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-07T00:19:55.107

在这种情况下，在参数上使用 final 会有所帮助。

您可以设置 Eclipse 以将 Final 作为 Save Action 添加到参数中。

请注意——你不会犯同样的错误两次！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T00:14:12.637

没关系，这真的很愚蠢。我的设置器不正确——这就是我使用 eclipse 自动生成的结果。

使固定：

公共类 AWSProperties {

```
private String awsAccessKey;
private String awsSecretKey;
private String awsSQSQueueName;

public void setAwsAccessKey(String awsAccessKey) {
    this.awsAccessKey = awsAccessKey;
}

public String getAwsAccessKey() {
    return awsAccessKey;
}

public void setAwsSecretKey(String awsSecretKey) {
   this.awsSecretKey = awsSecretKey;
}

public String getAwsSecretKey() {
    return awsSecretKey;
}

public void setAwsSQSQueueName(String awsSQSQueueName) {
    this.awsSQSQueueName = awsSQSQueueName;
}

public String getAwsSQSQueueName() {
    return awsSQSQueueName;
} 
```

}

# python - 如何在不注释掉 Python 日志调用的情况下剥离它们？

> ID：522730
> 
> 赞同：30
> 
> 时间：2009-02-07T00:08:11.557
> 
> 标签：python, optimization, logging, bytecode

今天我在考虑我一年前写的一个 Python 项目，我在该项目中使用`logging`得非常广泛。`hotshot`我记得由于开销（表明这是我最大的瓶颈之一），不得不在类似内部循环的场景（90% 的代码）中注释掉很多日志调用。

我现在想知道是否有一些规范的方法可以以编程方式去除 Python 应用程序中的日志记录调用，而无需一直注释和取消注释。我认为您可以使用检查/重新编译或字节码操作来执行此类操作，并且**仅针对导致瓶颈的代码对象**。这样，您可以添加一个操纵器作为编译后步骤并使用集中配置文件，如下所示：

```
[Leave ERROR and above]
my_module.SomeClass.method_with_lots_of_warn_calls

[Leave WARN and above]
my_module.SomeOtherClass.method_with_lots_of_info_calls

[Leave INFO and above]
my_module.SomeWeirdClass.method_with_lots_of_debug_calls 
```

当然，**您可能希望谨慎地使用它，并且可能以每个函数的粒度**- 仅用于已显示`logging`为瓶颈的代码对象。有人知道这样的事情吗？

**注意：**由于动态类型和后期绑定，有一些事情使得以高性能方式执行此操作更加困难。例如，对名为的方法的任何调用都`debug`可能必须用`if not isinstance(log, Logger)`. 无论如何，我假设所有的小细节都可以通过君子协议或一些运行时检查来克服。:-)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-08T17:33:41.710

使用[logging.disable](http://docs.python.org/library/logging.html?highlight=logging#logging.disable "记录.禁用")怎么样？

我还发现如果创建日志消息的成本很高，我必须使用[logging.isEnabledFor 。](http://docs.python.org/library/logging.html?highlight=logging#logging.Logger.isEnabledFor)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-16T03:36:10.827

使用[pypreprocessor](http://code.google.com/p/pypreprocessor/)

也可以在[PYPI（Python 包索引）](http://pypi.python.org/pypi/pypreprocessor)上找到并使用 pip 获取。

这是一个基本的用法示例：

```
from pypreprocessor import pypreprocessor

pypreprocessor.parse()

#define nologging

#ifdef nologging
...logging code you'd usually comment out manually...
#endif 
```

本质上，预处理器以您之前手动执行的方式注释掉代码。它只是根据您的定义有条件地即时执行。

您还可以通过在 import 和 parse() 语句之间添加“pypreprocessor.removeMeta = True”来删除所有预处理器指令并从后处理代码中注释掉代码。

字节码输出 (.pyc) 文件将包含优化的输出。

*旁注：pypreprocessor 与 python2x 和 python3k 兼容。*

*免责声明：我是 pypreprocessor 的作者。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-04T07:22:20.253

我也看到过以这种方式使用的断言。

```
assert logging.warn('disable me with the -O option') is None 
```

（我猜警告总是不返回。如果没有，你会得到一个 AssertionError

但实际上这只是一种有趣的方式：

```
if __debug__: logging.warn('disable me with the -O option') 
```

当您使用 -O 选项运行包含该行的脚本时，该行将从优化的 .pyo 代码中删除。相反，如果您有自己的变量，如下所示，您将有一个始终执行的条件（无论变量是什么值），尽管条件应该比函数调用执行得更快：

```
my_debug = True
...
if my_debug: logging.warn('disable me by setting my_debug = False') 
```

所以如果我对**调试**的理解是正确的，这似乎是摆脱不必要的日志调用的好方法。另一方面是它还会禁用所有断言，因此如果您需要断言，这是一个问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T00:27:15.963

作为一个不完美的捷径，使用[MiniMock 之](http://pypi.python.org/pypi/MiniMock/)`logging`类的东西在特定模块中模拟怎么样？

例如，如果`my_module.py`是：

```
import logging
class C(object):
    def __init__(self, *args, **kw):
        logging.info("Instantiating") 
```

您将使用以下内容替换您的使用`my_module`：

```
from minimock import Mock
import my_module
my_module.logging = Mock('logging')
c = my_module.C() 
```

在模块的初始导入之前，您只需要这样做一次。

`logging.getLogger`通过模拟特定方法或返回一个模拟对象，其中一些方法无效而其他方法委托给真实`logging`模块，获得特定于级别的行为会很简单。

在实践中，您可能希望用更简单、更快的东西替换 MiniMock；至少不会将使用情况打印到标准输出的东西！当然，这并不能解决模块 A`logging`从模块 B 导入的问题（因此 A 也导入了 B 的日志粒度）......

这永远不会像根本不运行日志语句那样快，但应该比一直深入到日志模块的深处发现根本不应该记录该记录要快得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T01:30:41.780

你可以尝试这样的事情：

```
# Create something that accepts anything
class Fake(object):
    def __getattr__(self, key):
        return self
    def __call__(self, *args, **kwargs):
        return True

# Replace the logging module
import sys
sys.modules["logging"] = Fake() 
```

`Fake`它本质上用一个简单地接受任何东西的实例替换（或最初填充）日志记录模块的空间。在尝试在任何地方使用日志记录模块之前，您必须运行上述代码（只需一次！）。*这是一个测试：*

```
import logging

logging.basicConfig(level=logging.DEBUG,
                    format='%(asctime)s %(levelname)-8s %(message)s',
                    datefmt='%a, %d %b %Y %H:%M:%S',
                    filename='/temp/myapp.log',
                    filemode='w')
logging.debug('A debug message')
logging.info('Some information')
logging.warning('A shot across the bows') 
```

如上所述，正如所料，根本没有记录任何内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T17:59:32.550

我会使用一些花哨的日志装饰器，或者其中的一堆：

```
def doLogging(logTreshold):
    def logFunction(aFunc):
        def innerFunc(*args, **kwargs):
            if LOGLEVEL >= logTreshold:
                print ">>Called %s at %s"%(aFunc.__name__, time.strftime("%H:%M:%S"))
                print ">>Parameters: ", args, kwargs if kwargs else "" 
            try:
                return aFunc(*args, **kwargs)
            finally:
                print ">>%s took %s"%(aFunc.__name__, time.strftime("%H:%M:%S"))
        return innerFunc
    return logFunction 
```

您只需要在每个模块中声明 LOGLEVEL 常量（或者只是全局声明并在所有模块中导入它），然后您可以像这样使用它：

```
@doLogging(2.5)
def myPreciousFunction(one, two, three=4):
    print "I'm doing some fancy computations :-)"
    return 
```

如果 LOGLEVEL 不小于 2.5，您将获得如下输出：

```
>>Called myPreciousFunction at 18:49:13
>>Parameters:  (1, 2) 
I'm doing some fancy computations :-)
>>myPreciousFunction took 18:49:13 
```

如您所见，需要做一些工作才能更好地处理 kwargs，因此如果存在默认值，将打印它们，但这是另一个问题。

您可能应该使用一些**`logger`**模块而不是原始**`print`**语句，但我想专注于装饰器的想法并避免使代码太长。

无论如何 - 使用这样的装饰器，您可以获得功能级日志记录，任意多个日志级别，易于应用到新功能，并且禁用日志记录您只需要设置 LOGLEVEL。如果您愿意，您可以为每个函数定义不同的输出流/文件。您可以将 doLogging 编写为：

```
 def doLogging(logThreshold, outStream=sys.stdout):
      .....
      print >>outStream, ">>Called %s at %s" etc. 
```

并利用基于每个功能定义的日志文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-06T22:38:39.300

这也是我的项目中的一个问题——记录最终会非常一致地记录在分析器报告中。

我之前在 PyFlakes ( [http://github.com/kevinw/pyflakes](http://github.com/kevinw/pyflakes) ) 的一个分支中使用了 _ast 模块......而且绝对可以按照你在问题中的建议去做——在之前检查和注入警卫调用日志记录方法（您承认必须进行一些运行时类型检查）。有关简单示例，请参见[http://pyside.blogspot.com/2008/03/ast-compilation-from-python.html](http://pyside.blogspot.com/2008/03/ast-compilation-from-python.html)。

**编辑：**我刚刚在我的 planetpython.org 提要上注意到[MetaPython——](http://blog.pythonisito.com/2009/03/announcing-metapython-macros-for-python.html)示例用例是在导入时删除日志语句。

也许最好的解决方案是让某人将日志记录重新实现为 C 模块，但我不会是第一个抓住这样一个......机会的人：p

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-11T03:43:26.800

:-) 我们曾经称它为预处理器，尽管 C 的预处理器具有其中的一些功能，但“山中之王”是 IBM 大型机 PL/I 的预处理器。它在预处理器中提供了广泛的语言支持（完全赋值、条件、循环等），并且可以仅使用 PL/I PP 编写“编写程序的程序”。

我编写了许多具有成熟的复杂程序和数据跟踪的应用程序（当时我们没有用于后端进程的合适调试器）用于开发和测试，然后在使用适当的“运行时标志”编译时只需干净地剥离所有跟踪代码，而不会影响性能。

我认为装饰器的想法是一个好主意。您可以编写一个装饰器来包装需要记录的函数。然后，对于运行时分发，装饰器变成了“无操作”，消除了调试语句。

乔恩·R

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-06-09T12:35:04.693

我目前正在做一个项目，该项目使用大量日志记录来测试使用 Pandas 库的数据分析 API 的逻辑和执行时间。

我发现这个字符串有类似的问题 - 例如，即使 logging.basicConfig 级别设置为 level=logging.WARNING，logging.debug 语句的开销是多少

我已经编写了以下脚本来在部署之前注释掉或取消注释调试日志：

```
import os
import fileinput

comment = True

# exclude files or directories matching string
fil_dir_exclude = ["__","_archive",".pyc"]

if comment :
    ## Variables to comment
    source_str = 'logging.debug'
    replace_str = '#logging.debug'
else :
    ## Variables to uncomment
    source_str = '#logging.debug'
    replace_str = 'logging.debug'

# walk through directories
for root, dirs, files in os.walk('root/directory') :
    # where files exist
    if files:
        # for each file
        for file_single in files :
            # build full file name
            file_name = os.path.join(root,file_single)
            # exclude files with matching string
            if not any(exclude_str in file_name for exclude_str in fil_dir_exclude) :
                # replace string in line
                for line in fileinput.input(file_name, inplace=True):
                    print "%s" % (line.replace(source_str, replace_str)), 
```

这是一个文件递归，它根据条件列表排除文件，并根据此处找到的答案执行就地替换：[Search and replace a line in a file in Python](https://stackoverflow.com/questions/39086/search-and-replace-a-line-in-a-file-in-python)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-07T21:16:58.140

我喜欢 'if __debug_' 解决方案，只是把它放在每次调用之前有点分散注意力和丑陋。我遇到了同样的问题，并通过编写一个脚本来克服它，该脚本自动解析您的源文件并用 pass 语句替换日志语句（并注释掉日志语句的副本）。它还可以撤消此转换。

当我将新代码部署到生产环境中时，我会使用它，因为在生产环境中有很多我不需要的日志语句并且它们正在影响性能。

你可以在这里找到脚本：http: [//dound.com/2010/02/python-logging-performance/](http://dound.com/2010/02/python-logging-performance/)

# gnuplot - 使用 Gnuplot 进行时间序列的线性回归

> ID：522731
> 
> 赞同：7
> 
> 时间：2009-02-07T00:08:42.460
> 
> 标签：gnuplot, time-series, linear-regression

我是 Gnuplot 的忠实粉丝，我在学习期间一直将它用于各种项目。

最近我想用 Gnuplot 来绘制一些时间序列图，比如减肥、锻炼结果、气体消耗等。

因此，我像缩放 x 轴一样

```
set xdata time
set timefmt "%d.%m %Y"
set format x "%d.%m" 
```

现在我想使用拟合函数给我一个线性拟合。我的问题是，如果 x 轴与时间相关，我无法让它工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T00:30:57.313

然后将日期更改为数字，例如从第一个日期开始的天数，进行拟合，然后将数字再次转换回日期。这样，您将拥有“常规” x 和 y 数据集。

# latex - 如何在 LaTeX 列表中隐藏项目符号？

> ID：522753
> 
> 赞同：57
> 
> 时间：2009-02-07T00:15:51.400
> 
> 标签：latex

从语义上讲，我想要一个逐项列表，但在视觉上我只想要一些空间。如何隐藏子弹？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-02-07T00:19:27.307

```
\item[] text 
```

或者，您可以在 [] 中添加一些内容。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-06-25T02:49:16.773

我不能说任何其他设置，但我在 MacTex 上使用 Tufte-Latex，我只是输入了以下内容：

`\begin{itemize}[]`

有效。:-) 我喜欢猜测这样做。因此，请尝试`[]`在之后添加。

PS 来自 lindelof 的“广义”列表也有效，但它们的排列不如 itemize 那样好。Jakub 的建议激发了我的猜测，当我尝试时，我得到了一堆“label=”字符串作为项目符号。

编辑：正如其他人所指出的，更标准的方法是再次使用 []，但在列表中的每个项目旁边，就像在此页面上的其他答案中一样。如果您厌倦了在每一行看到方括号，请尝试此页面上的其他方法 :)

```
\begin{description}
\item[] first item
\end{description} 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2010-03-27T20:40:56.817

我对这个线程的回复已经很晚了，但我想我会为了任何未来的搜索者的利益而添加它。

我通过使用描述环境并为 \item 命令使用空格来完成此操作。

例如

```
\begin{description}
\item[] first item
\end{description} 
```

这对我来说很好。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-07T00:54:03.430

您可能想要的是一个通用列表：

```
\begin{list}{\quad}{}
\item ...
\end{list} 
```

此环境的第二个参数是将插入到每个项目前面的符号。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-07T01:23:53.637

我认为最好的解决方案是使用[`enumitem`](https://www.ctan.org/pkg/enumitem)CTAN 的包：它存在于 teTeX 和 LaTex 中，也应该存在于大多数其他 TeX 发行版中。然后你就可以使用：

```
\begin{itemize}[label=]
\item 1st item
\item ...
\end{itemize} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-08T23:48:27.247

项目符号本身是一个宏，因此您可以像这样轻松地在全局范围内重新定义它：

`\renewcommand{\labelitemi}{$\star$}`

在您的情况下，只需将宏留空。有关详细信息，请参阅[此页面](http://www-h.eng.cam.ac.uk/help/tpl/textprocessing/teTeX/latex/latex2e-html/ltx-250.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-10T12:54:24.197

如果你想要的只是空间，而不是列表环境，你可以使用 tabbing 环境

```
\begin{tabbing}
\hspace{30pt}\=\hspace{30pt}\=\kill 
\> First Item\\
\> Second item\\
\> Third item
\end{tabbing} 
```

# c++ - C ++中的凯撒密码

> ID：522778
> 
> 赞同：5
> 
> 时间：2009-02-07T00:26:39.600
> 
> 标签：c++, string, encryption

首先，我已经学习了四个星期的 C++ 课程，但我什至不知道循环，所以请说婴儿话？

好的，所以我应该从文件中读取十二个字符串（加上 NULL 使十三个），然后将字母向后移动三个，然后将我的结果打印到屏幕和文件中。除了移动字母外，我对一切都很好。我不想编写数英里的代码来单独获取每个字符，减去三个，然后重新组合字符串，但我不确定如何一次处理整个字符串。有人可以推荐一个非常简单的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T00:38:48.780

如果您正在处理简单的字母（A 到 Z 或 a 到 z），那么您可以假设内部代码是线性的。

字母编码为数字，介于 0 和 127 之间。A 编码为 65，B 编码为 66，C 编码为 67，Z 编码为 90。

为了移动字母，您只需将内部字母代码更改为数字，因此基本上只需从字符中减去 3。但请注意极端情况，因为将 3 减去 'A' 会得到 '>'（代码 62）而不是 'X'（代码 88）。您可以使用“if”语句或模运算符（“%”）来处理它们。

这是一个[ASCII 字符表](http://en.wikipedia.org/wiki/Ascii)来帮助你

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T11:21:06.567

加载字符串后，您可以使用模运算符旋转，同时保持在 AZ 空间的范围内。

我会跟踪这封信是否以大写字母开头：

```
bool isCaps = ( letter >= 'A' ) && ( letter <= 'Z' );
if( isCaps )
  letter -= 'A'-'a'; 
```

然后像这样进行密码转换：

```
int shift = -3;
letter -= 'a'; // to make it a number from 0-25
letter = ( letter + shift + 26 ) % 26;
        // add 26 in case the shift is negative
letter += 'a'; // back to ascii code 
```

终于结束了

```
if( isCaps )
  letter += 'A'-'a'; 
```

所以，把所有这些放在一起，我们得到：

```
char *mystring; // ciphertext
int shift = -3; // ciphershift

for( char *letter = mystring; letter; ++letter )
{
  bool isCaps = ( *letter >= 'A' ) && ( *letter <= 'Z' );
  if( isCaps )
    *letter -= 'A'-'a';

  letter -= 'a';
  letter = ( letter + shift + 26 ) % 26;
  letter += 'a';

  if( isCaps )
    letter += 'A'-'a';
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T00:35:30.567

你将不得不学习循环。它们将允许您在字符串的字符上重复一些代码，这正是您需要的。您将保留一个整数变量，该变量将作为字符串的索引，并在循环内对该索引处的字符进行字母移位，并将索引变量加一，直到达到 NULL。

**编辑：**如果您不希望在课程中了解循环，也许他们希望您这样做：

```
string[0] -= 3; // this is short for "string[0] = string[0] - 3;"
string[1] -= 3;
string[2] -= 3;
... 
```

它只会产生 12 行代码而不是英里。您不必以这种方式“重新组装”字符串，您可以就地编辑每个字符。然后我敢打赌，在让你这样做之后，他们会向你展示使用循环的快速方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T00:33:04.767

使用 for 循环遍历字符。用 char* 做你想做的事。然后把新的字符放回去。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T00:33:35.827

```
for(int i=0; i<12; i++){
  string[i] = string[i] - 3;
} 
```

其中 string 是您的字符数组（字符串）。如果您想让它定期进行，则涉及更多内容（IE 将 A 环绕到 Z，但上面的代码应该可以帮助您入门）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T00:36:15.977

我有点不清楚“将字母向后移动 3”是什么意思？这是否意味着 D ==> A？
如果是这样，这是一个简单的循环。

（我没有从文件中读取或写入文件......那是你的部分）

```
#include <string.h>

int main(void)
{                      
    char input[13] = "ABCDEFGHIJKL";
    int i;

    int len = strlen(input);

    for(i=0; i<len; ++i)
    {
        input[i] = input[i]-3;
    }

    printf("%s", input);  // OUTPUT is: ">?@ABCDEFGHI"
} 
```

# python - 如何使用雅虎搜索 API 搜索特定文件类型？

> ID：522781
> 
> 赞同：1
> 
> 时间：2009-02-07T00:27:40.520
> 
> 标签：python, yahoo-api, yahoo-search

有谁知道是否有一些参数可用于雅虎程序搜索允许限制结果，因此只返回特定类型文件的链接（例如 PDF）？在 GUI 中可以做到这一点，但如何通过 API 实现呢？

我非常感谢 Python 中的示例代码，但任何其他解决方案也可能会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-07T00:30:34.040

就在这里：

[http://developer.yahoo.com/search/boss/boss_guide/Web_Search.html#id356163](http://developer.yahoo.com/search/boss/boss_guide/Web_Search.html#id356163)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T21:54:07.787

谢谢你。我发现自己这样的东西可以正常工作（文件类型是第一个参数，查询是第二个）：

格式 = sys.argv[1]

查询 = " ".join(sys.argv[2:])

srch = create_search("Web", app_id, query=query, format=format)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-24T14:52:02.897

这就是我为这类事情所做的。它公开了更多参数，因此您可以根据需要对其进行调整。这应该打印出查询“resume”中的前十个 PDF URL [我的不是其中之一；）]。您可以随意下载这些 URL。

从查询返回的 json 字典有点粗糙，但这应该可以帮助您入门。请注意，在实际代码中，您需要检查字典中的某些键是否存在。当没有结果时，这段代码可能会抛出异常。

Tiago 提供的链接有助于了解“type”参数支持哪些值。

```
from yos.crawl import rest
APPID="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
base_url = "http://boss.yahooapis.com/ysearch/%s/v%d/%s?start=%d&count=%d&type=%s" + "&appid=" + APPID
querystr="resume"
start=0
count=10
type="pdf"
search_url = base_url % ("web", 1, querystr, start, count, type)
json_result = rest.load_json(search_url)
for url in [recs['url'] for recs in json_result['ysearchresponse']['resultset_web']]:
    print url 
```

# apache-flex - 具有可变大小项目的弹性容器

> ID：522791
> 
> 赞同：3
> 
> 时间：2009-02-07T00:31:55.067
> 
> 标签：apache-flex, flex3

我需要使用 Flex 显示图像的水平列表。我不能使用水平的 TileList，因为这些瓷砖最终都是第一项的大小。是否有弹性控件可以让我拥有不同尺寸的物品？

编辑：理想情况下，项目列表来自数据提供者。不幸的是，如果项目具有固定宽度，则 Chetan Sastry 的答案中的控件仅支持数据提供者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T02:55:01.237

这是一个代码段，我在其中执行我认为您所描述的操作。图像有各种尺寸，但这会将它们显示在方形网格中。诀窍（至少对于我的要求）是为进入每个单元格的容器设置高度和 minWidth。

```
<mx:TileList id="imgTiles" width="100%" height="100%"  
      paddingTop="2" paddingBottom="2" paddingLeft="2" paddingRight="2"  
      itemClick="eTilesClick(event)">     
    <mx:itemRenderer>  
        <mx:Component>  
            <mx:VBox horizontalAlign="center"  
                   height="250" minWidth="150"  
                   horizontalScrollPolicy="off" verticalScrollPolicy="off"  
                   borderColor="#D2D2D2" borderThickness="1"
                   borderStyle="solid">
                <mx:Label text="{data.imageCaption}" height="15" fontSize="10" fontWeight="bold"/>
                <mx:Image source="{data.thumbnailUrl}" width="100%"/>
            </mx:VBox>
        </mx:Component>
    </mx:itemRenderer>
</mx:TileList> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T06:44:46.747

带有[中继器的](http://livedocs.adobe.com/flex/3/langref/mx/core/Repeater.html)[HBox](http://livedocs.adobe.com/flex/3/langref/mx/containers/HBox.html)怎么样？

# java - Android 文本视图计时器

> ID：522800
> 
> 赞同：19
> 
> 时间：2009-02-07T00:35:11.003
> 
> 标签：java, android, timer, textview

对于我的 Android 应用程序，有一个计时器可以测量经过了多少时间。每 100 毫秒，我都会用一些文本更新我的 TextView，例如“分数：10 时间：100.10 秒”。但是，我发现 TextView 只更新前几次。该应用程序仍然非常敏感，但标签不会更新。我试图调用 .invalidate()，但它仍然不起作用。我不知道是否有某种方法可以解决此问题，或者使用更好的小部件。

这是我的代码示例：

```
float seconds;
java.util.Timer gametimer;
void updatecount() { TextView t = (TextView)findViewById(R.id.topscore);
t.setText("Score: 10 - Time: "+seconds+" seconds");
t.postInvalidate();
}
public void onCreate(Bundle sis) {
... Load the UI, etc...
  gametimer.schedule(new TimerTask() { public void run() {
     seconds+=0.1; updatecount();
} }, 100, 100);
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-11-26T16:58:28.493

一般的解决方案是使用 android.os.Handler 代替它在 UI 线程中运行。它只执行一次性回调，因此每次调用回调时都必须再次触发它。但它很容易使用。几年前写了一篇关于这个主题的博客文章：

[http://android-developers.blogspot.com/2007/11/stitch-in-time.html](http://android-developers.blogspot.com/2007/11/stitch-in-time.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T03:30:23.100

我认为正在发生的是你从 UI 线程上掉下来了。有一个处理所有屏幕更新的“looper”线程。如果您尝试调用“invalidate()”并且您不在此线程上，则不会发生任何事情。

尝试在您的视图上使用“postInvalidate()”。当您不在当前 UI 线程中时，它可以让您更新视图。

更多信息[在这里](http://code.google.com/android/reference/android/view/View.html#postInvalidate())

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-19T14:00:02.177

使用下面的代码在 TextView 上设置时间

```
public class MyCountDownTimer extends CountDownTimer {
        public MyCountDownTimer(long startTime, long interval) {
            super(startTime, interval);
        }

        @Override
        public void onFinish() {

            ExamActivity.this.submitresult();
        }

        @Override
        public void onTick(long millisUntilFinished) {

            long millis = millisUntilFinished;

            int seconds = (int) (millis / 1000) % 60;
            int minutes = (int) ((millis / (1000 * 60)) % 60);
            int hours = (int) ((millis / (1000 * 60`enter code here` * 60)) % 24);

            String ms = String
                    .format("%02d:%02d:%02d", hours, minutes, seconds);
            txtimedisplay.setText(ms);
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-14T12:45:12.373

还有另一种每秒更改文本的方法；这是`ValueAnimator`。这是我的解决方案：

```
 long startTime = System.currentTimeMillis();
  ValueAnimator animator = new ValueAnimator();
            animator.setObjectValues(0, 1000);
            animator.setDuration(1000);
            animator.setRepeatCount(ValueAnimator.INFINITE);
            animator.addListener(new AnimatorListenerAdapter() {

                @Override
                public void onAnimationStart(Animator animation) {
                    long currentTime = System.currentTimeMillis();
                    String text = TimeFormatUtils.formatTime(startTime - currentTime);
                   yourTextView.setText(text);
                }

                @Override
                public void onAnimationRepeat(Animator animation) {
                    long currentTime = System.currentTimeMillis();
                    String text = TimeFormatUtils.formatTime(startTime - currentTime);
                    yourTextView.setText(text);
                }
            });
            animator.start(); 
```

# design-patterns - 为什么访问者负责在访问者模式中枚举孩子？

> ID：522803
> 
> 赞同：7
> 
> 时间：2009-02-07T00:36:19.580
> 
> 标签：design-patterns, enumeration, visitor-pattern

根据我找到的代码，似乎需要访问者知道访问对象的结构并调用所需的子对象。在某些情况下，即使访问的类被修改，访问者仍希望继续工作，这似乎有点笨拙。

我想真正的问题是：*它们是由访问代码而不是访问代码完成枚举的模式吗？*

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-07T01:32:25.803

访问者对象*需要*知道它访问的事物的结构。不过没关系。您*应该*为访问者知道如何访问的每种类型的事物编写专门的访问操作。这允许访问者决定它真正想要访问多少，以及以什么顺序访问。

假设你有一棵树。一个访问者可能会进行前序遍历，一个可能会进行中序遍历，而另一个访问者可能只作用于叶节点。访问者类可以做所有这些事情，而不需要对树类进行任何更改。

访问者知道结构，但这并不一定意味着访问者执行的操作知道所有结构。您可以将访问者与*命令*结合起来。给访问者对象一个命令对象，访问者将在它访问的每个事物上调用该命令。

如果您想进行简单的操作并让集合为您提供要操作的每个项目，那么您希望集合为自己提供一个**迭代器**。在迭代器给你的每一件事上调用你的函数。

如果您想以各种顺序迭代树的节点，那么树将需要提供多个迭代器。如果要按树不支持的顺序处理节点，则需要修改树类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T07:53:35.377

是的。被访问的对象可以进行枚举（即调用所需的子对象）。这仍然被称为“访问者”模式（实际上，*设计模式*的第一个访问者示例就是这样做的）。我编造的示例片段：

```
public void accept(Visitor visitor) {
  for (Node n : children) {
    n.accept(visitor);
  }
} 
```

注意：为了探望孩子，我们不能说`visitor.visit(n);`。这是因为 Java 不会动态选择方法（基于其参数的运行时类），而是静态选择方法（通过其参数的编译时类型）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T02:40:23.327

简而言之，我认为访问者模式与枚举的方式是正交的。它可以以任何一种方式完成，或者根本不枚举。

我认为访问者需要知道访问结构由哪些元素组成。想知道汽车由车轮和发动机组成。我认为没有必要知道它们是如何组合的。考虑以下示例。Insider 知道访问的对象结构并自己执行枚举。局外人不知道它并将枚举委托给访问的对象。

```
interface Visitable {
    void accept(Visitor visitor);
}

class WorkingRoom implements Visitable {
    public int number;
    WorkingRoom(int number) {
        this.number = number;
    }

    public void accept(Visitor visitor) {
        visitor.visit(this);
    }
}

class BossRoom implements Visitable {
    public String bossName;
    BossRoom(String bossName) {
        this.bossName = bossName;
    }
    public void accept(Visitor visitor) {
        visitor.visit(this);
    }
}

interface Visitor{
    void visit(WorkingRoom workingRoom);
    void visit(BossRoom bossRoom);
    void visit(Office office);
}

class Office implements Visitable{
    public Visitable[] firstFloor;
    public Visitable[] secondFloor;
    public Visitable ceoRoom;
    public Office(){
        firstFloor = new Visitable[]{ new WorkingRoom(101),
                                        new WorkingRoom(102),
                                        new BossRoom("Jeff Atwood"),
                                        new WorkingRoom(103)};
        secondFloor = new Visitable[]{  new WorkingRoom(201),
                                        new WorkingRoom(202),
                                        new BossRoom("Joel Spolsky")};

        ceoRoom = new BossRoom("Bill Gates");
    }

    public void accept(Visitor visitor) {
        visitor.visit(this);
    }

    public void showMeTheOffice(Visitor visitor, boolean sayPlease) {
        // Office manager decides the order in which rooms are visited
        for(int i=secondFloor.length-1; i >= 0; i--){
            secondFloor[i].accept(visitor);
        }
        if (sayPlease){
            ceoRoom.accept(visitor);
        }
        for (int i = 0; i < firstFloor.length; i++) {
            firstFloor[i].accept(visitor);
        }
    }
}

class Insider implements Visitor{
    public void visit(WorkingRoom workingRoom) {
        System.out.println("I> This is working room #"+workingRoom.number);
    }

    public void visit(BossRoom bossRoom) {
        System.out.println("I> Hi, "+bossRoom.bossName);
    }

    public void visit(Office office) {
        // I know about office structure, so I'll just go to the 1st floor
        for(int i=0;i<office.firstFloor.length;i++){
            office.firstFloor[i].accept(this);
        }
    }
}

class Outsider implements Visitor{

    public void visit(Office office) {
        // I do not know about office structure, but I know they have a 
        // nice office manager
        // I'll just ask to show me the office
        office.showMeTheOffice(this, true);
    }

    public void visit(WorkingRoom workingRoom) {
        System.out.println("O> Wow, room #"+workingRoom.number);
    }

    public void visit(BossRoom bossRoom) {
        System.out.println("O> Oh, look, this is "+bossRoom.bossName);
    }
}

public class Main{
    public static void main(String[] args) {
        Office office = new Office(); // visited structure
        // visitor who knows about office structure
        Insider employee = new Insider(); 
        office.accept(employee);
        System.out.println();
        // visitor who does not know about exact office structure
        // but knows something else
        Outsider candidate = new Outsider(); 
        office.accept(candidate);

        // no enumeration at all, but still a visitor pattern
        Visitable v = new BossRoom("Linus Torvalds");
        v.accept(candidate);
    }
} 
```

我有一个广泛使用访问者模式的项目，根本没有任何枚举。我们有基本接口 Field 和许多实现它的类，如 StringField、NumberField 等。很多时候，我们不得不根据字段类型做不同的事情，例如以不同的方式渲染它、从 DB 加载、导出到 xml 等. 我们可以在 Field 接口中定义方法，但这会使它与项目的每一个特性相结合 - 糟糕的字段必须知道导出、导入、呈现为 html 和 rtf 等。我们也可以使用 instanceof，但可以设置实现 Field 接口的类随着时间的推移而改变，可以添加新的字段类型而忘记添加

```
else if (field instanceof NewlyAddedFieldType) {...} 
```

某处。所以我们决定使用访问者模式，就像

```
Visitor v = new XMLExportVisitor(outputStream);
field.accept(v); 
```

因为任何 Field 实现都需要有方法

```
void accept(FieldVisitor visitor) 
```

那么如果我添加 Field 接口的新实现，我必须以某种方式实现它。通常是

```
visitor.visit(this); 
```

这是一个新添加的类。这迫使我添加

```
void visit(NewlyAddedClass visited); 
```

到 FieldVisitor 接口，这使我可以在我们已经拥有的每个 FieldVisitor 实现中实现它。所以如果我忘记做这件事——我会得到编译器错误。在这种情况下，枚举（如果有）是在访问的结构和访问者之外完成的。但我仍然认为它是访问者模式的一个有效案例。它碰巧实现起来有点困难，但使用起来更容易、更安全。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-08T02:34:44.553

[分层访问者模式](http://www.c2.com/cgi/wiki?HierarchicalVisitorPattern)解释了一种不同的方法，它添加了进入和离开关卡的事件。相关的[讨论页面](http://www.c2.com/cgi/wiki?HierarchicalVisitorDiscussion)提供了在访问者或容器内进行迭代的参数。它包括一个使用外部迭代器的建议，如果你有一个常规的树并且需要以不同的方式迭代，这对我来说很有意义。

回顾我的[oofRep 访问者](http://www.oofile.com.au/oofile_ref/html/classoof_rep_visitor.html)，它有一系列不同级别的类要访问，并且在方法中进行了迭代，例如：

```
void
oofRepVisitor::VisitViewHeaders(oofRepBandList& inBands)
{
    VisitBandList(inBands);
}

void
oofRepVisitor::VisitBandList(oofRepBandList& inBands)
{
    EnterLevel();
    const unsigned long numBands = inBands.count();
    for (unsigned long i=0; i<numBands; i++) {
        oofRepBand* theBand = inBands.value(i);
        assert(theBand);
        VisitTypedBand(theBand);
    }
    LeaveLevel();
} 
```

有一个覆盖

```
void
OOF_repXMLlayoutVisitor::VisitViewHeaders(oofRepBandList& inBands)
{
    oofRepStreamEnv::out() << mIdentities.getIndentString();
    if (inBands.keepTogether())
        oofRepStreamEnv::out()  << "<header>\n";    
    else  // default is ON, and simplifies XML
        oofRepStreamEnv::out()  << "<header keepTogether='false'>\n";
    VisitBandList(inBands);
    oofRepStreamEnv::out() 
        << mIdentities.getIndentString()
        << "</header>\n";
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T00:40:45.157

看看这篇[文章](http://www.butunclebob.com/ArticleS.UncleBob.IuseVisitor)中的解释。

来自[维基](http://en.wikipedia.org/wiki/Visitor_pattern)：

> 在面向对象的编程和软件工程中，访问者设计模式是一种将算法与其操作的对象结构分离的方法。这种分离的实际结果是能够在不修改现有对象结构的情况下向现有对象结构添加新操作。因此，使用访问者模式有助于遵守开放/封闭原则。

# macos - Core Graphics 中的字体大小

> ID：522804
> 
> 赞同：2
> 
> 时间：2009-02-07T00:37:14.133
> 
> 标签：macos, fonts, core-graphics, quartz-graphics, font-size

我正在尝试使用 Core Graphics API 渲染一些文本，但遇到了一些概念上的困难。

我正在尝试使用[CGContextSetFontSize](http://developer.apple.com/documentation/graphicsimaging/Reference/CGContext/Reference/reference.html#//apple_ref/doc/uid/TP30000950-CH1g-F17049)指定字体大小。size 参数位于所谓的“**文本空间单位**”中。那是什么？它如何映射到“ **em** ”单位？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T02:48:29.987

> 我正在尝试使用 CGContextSetFontSize 指定字体大小。size 参数位于所谓的“文本空间单位”中。那是什么？它如何映射到“em”单位？

首先回答您的第二个问题，1 em（遵循[CSS 定义](http://www.w3.org/TR/CSS2/syndata.html#length-units)）将等于您在此处指定的数量。

Core Graphics 的“文本空间”来源于用户空间。还有一个额外的转换矩阵，文本矩阵，它将用户空间转换为文本空间。[`CGContextSetTextMatrix`](http://developer.apple.com/documentation/graphicsimaging/Reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextSetTextMatrix)请参阅[Quartz 2D 如何绘制文本](http://developer.apple.com/documentation/graphicsimaging/Conceptual/drawingwithquartz2d/dq_text/chapter_18_section_2.html)和[绘制文本](http://developer.apple.com/documentation/graphicsimaging/Conceptual/drawingwithquartz2d/dq_text/chapter_18_section_4.html)。

默认情况下，文本矩阵是单位矩阵，所以文本空间 = 用户空间。

# machine-learning - 我认为是机器学习问题的最佳方法

> ID：522814
> 
> 赞同：9
> 
> 时间：2009-02-07T00:45:17.130
> 
> 标签：machine-learning, modeling, neural-network, classification, regression

我在这里需要一些专家指导，了解什么是我解决问题的最佳方法。我研究了一些机器学习、神经网络和类似的东西。我已经调查了 weka，某种贝斯解决方案.. R.. 几种不同的东西。不过，我不确定如何真正进行。这是我的问题。

我拥有或将拥有大量事件......最终大约有 100,000 个左右。每个事件由几个（30-50）个自变量和一个我关心的因变量组成。在确定因变量的值时，一些自变量比其他变量更重要。而且，这些事件与时间相关。今天发生的事情比十年前发生的事情更重要。

我希望能够为某种学习引擎提供一个事件，并让它预测因变量。然后，知道这个事件（以及之前发生的所有事件）的因变量的真正答案，我希望它可以训练后续的猜测。

一旦我知道了编程方向，我就可以进行研究并弄清楚如何将我的想法转化为代码。但我的背景是并行编程，而不是这样的东西，所以我很想对此有一些建议和指导。

谢谢！

编辑：这里有更多关于我要解决的问题的详细信息：这是一个定价问题。假设我想预测一本随机漫画书的价格。价格是我唯一关心的。但是可以想出很多自变量。是超人漫画还是凯蒂猫漫画。它几岁了？什么条件？等等等等。经过一段时间的训练，我希望能够给它关于我可能正在考虑的漫画书的信息，并让它给我一个合理的漫画书期望值。好的。所以漫画书可能是一个虚假的例子。但你得到了一般的想法。到目前为止，从答案来看，我正在对支持向量机和朴素贝叶斯进行一些研究。感谢您迄今为止的所有帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-07T01:31:17.270

听起来你是[支持向量机](http://en.wikipedia.org/wiki/Support_Vector_Machines)的候选人。

去获取[libsvm](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)。阅读他们分发的简短的“SVM 分类实用指南”。

基本上，您将参加您的活动，并将它们格式化为：

```
dv1 1:iv1_1 2:iv1_2 3:iv1_3 4:iv1_4 ...
dv2 1:iv2_1 2:iv2_2 3:iv2_3 4:iv2_4 ... 
```

通过他们的 svm-scale 实用程序运行它，然后使用他们的 grid.py 脚本搜索适当的内核参数。学习算法应该能够找出变量的不同重要性，尽管您也可以对事物进行加权。如果您认为时间有用，只需添加时间作为训练算法使用的另一个自变量（特征）。

如果 libsvm 不能完全达到您想要的精度，请考虑升级到[SVMlight](http://svmlight.joachims.org/)。只是稍微难处理，还有更多的选择。

[Bishop 的模式识别和机器学习](https://rads.stackoverflow.com/amzn/click/com/0387310738)可能是第一本详细了解 libsvm 和 SVMlight 对您的数据所做的事情的教科书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-08T02:05:09.137

SVM 通常是最好的分类器。这完全取决于您的问题和您的数据。对于某些问题，其他机器学习算法可能会更好。我已经看到神经网络（特别是循环神经网络）更擅长解决的问题。这个问题没有正确答案，因为它高度依赖情境，但我同意 dsimcha 和 Jay 的观点，即 SVM 是正确的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T21:59:19.443

The book [Programming Collective Intelligence](http://oreilly.com/catalog/9780596529321/) has a worked example with source code of a price predictor for laptops which would probably be a good starting point for you.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T01:30:59.830

如果你有一些分类数据——一堆样本问题及其正确答案——从训练一些简单的算法开始，比如 K-Nearest-Neighbor 和 Perceptron，看看是否有任何有意义的结果。在您知道是否可以简单或完全解决之前，不要费心尝试以最佳方式解决它。

如果您没有任何分类数据，或者没有太多分类数据，请开始研究无监督学习算法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-07T01:32:59.763

听起来任何类型的分类器都应该适用于这个问题：为一个实例（你的事件）找到最好的类（你的因变量）。一个简单的起点可能是[朴素贝叶斯](http://en.wikipedia.org/wiki/Naive_Bayesian_classification)分类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T01:35:12.647

这绝对是一个机器学习问题。如果您了解 Java 并且想要一个不错的 GPL 库，那么 Weka 是一个很好的选择，您所要做的就是选择分类器并编写一些胶水。R 可能不会为那么多实例（事件，正如你所说的那样）削减它，因为它非常慢。此外，在 R 中，您仍然需要查找或编写机器学习库，尽管这应该很容易，因为它是一种统计语言。

如果您认为您的特征（自变量）是条件独立的（意思是，在给定因变量的情况下独立），朴素贝叶斯是完美的分类器，因为它快速、可解释、准确且易于实现。但是，使用 100,000 个实例和仅 30-50 个特征，您可能会实现一个相当复杂的分类方案，该方案可以捕获数据中的大量依赖结构。您最好的选择可能是支持向量机（Weka 中的 SMO）或随机森林（是的，这是一个愚蠢的名字，但它帮助随机森林流行起来。）如果您想要分类器易于解释的优势，即使在牺牲一些准确性，也许直接的 J48 决策树会起作用。我建议不要使用神经网络，因为它们真的很慢而且不会

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-20T08:35:53.537

您提到您有 30-50 个自变量，其中一些比其余的更重要。所以，假设你有历史数据（或者我们所说的训练集），你可以使用 PCA（主成分分析）或其他降维方法来减少自变量的数量。这一步当然是可选的。根据情况，您可以通过保留每个变量来获得更好的结果，但根据它们的相关性为每个变量添加权重。在这里，PCA 可以帮助您计算变量的“相关性”程度。

您还提到最近发生的事件应该更重要。如果是这种情况，您可以将最近事件的权重较高，将较旧的事件权重较低。请注意，事件的重要性不必随着时间线性增长。如果它以指数方式增长可能更有意义，所以你可以在这里玩这些数字。或者，如果您不缺少训练数据，也许您可​​以考虑丢弃太旧的数据。

正如 Yuval F 所说，这看起来更像是一个回归问题，而不是一个分类问题。因此，您可以尝试 SVR（支持向量回归），它是 SVM（支持向量机）的回归版本。

您可以尝试的其他一些东西是：

1.  尝试如何缩放自变量的值范围。比如说，通常是 [-1...1] 或 [0...1]。但是您可以尝试其他范围，看看它们是否有帮助。有时他们会这样做。大多数时候他们没有。
2.  如果您怀疑存在具有较低维度的“隐藏”特征向量，例如 N << 30 并且它本质上是非线性的，那么您将需要非线性降维。您可以阅读内核 PCA 或最近的流形雕刻。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T15:50:14.937

你描述的是一个经典的分类问题。在我看来，当你有像 Weka 这样的工具时，为什么还要编写新的算法。如果我是你，我会使用 10 倍（或 k 倍）交叉验证遍历一系列监督学习算法（我不完全理解为什么人们首先建议无监督学习，因为这显然是一个分类问题） ，如果我记得的话，这是 Weka 中的默认设置，看看你会得到什么结果！我会尝试：

-Neural Nets
-SVMs
-Decision Trees（当我在做类似的问题时，这个对我来说非常有效）
-使用决策树/树桩
进行提升 -其他任何东西！

Weka 让事情变得如此简单，您确实可以获得一些有用的信息。我刚上了一门机器学习课，我用上面的算法做了你想要做的事情，所以我知道你在哪里。对我来说，决策树桩的提升效果非常好。（顺便说一句，boosting 实际上是一种元算法，可以应用于大多数监督学习算法，通常可以增强它们的结果。）

使用决策树（如果您使用 ID3 或类似品种）的一个好处是，它会按照它们区分数据的程度来选择要拆分的属性 - 换句话说，哪些属性基本上可以最快地确定分类。所以你可以在运行算法后检查树，看看漫画书的哪个属性最能决定价格——它应该是树的根。

编辑：我认为 Yuval 是对的，我没有注意将您的分类价格值离散化的问题。但是，我不知道 Weka 中是否提供回归，您仍然可以很容易地将分类技术应用到这个问题上。您需要对价格值进行分类，例如漫画的多个价格范围，这样您就可以有一个离散的数字（如 1 到 10）来表示漫画的价格。然后你可以很容易地运行分类它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-20T08:07:01.257

我相信您的问题是[回归](http://www.answers.com/topic/regression-analysis)问题，而不是分类问题。主要区别：在分类中，我们试图学习离散变量的值，而在回归中，我们试图学习连续变量的值。涉及的技术可能相似，但细节不同。[线性回归](http://www.answers.com/topic/linear-regression-1)是大多数人首先尝试的。如果线性回归不能解决问题，还有很多其他回归技术。

# ruby - 我不明白如何表达三个单独的表之间的关系

> ID：522815
> 
> 赞同：3
> 
> 时间：2009-02-07T00:46:00.733
> 
> 标签：ruby, database-design, activerecord

给定 ActiveRecord 中的下表：

*   作者
*   网站
*   文章

我不知道如何表达作者根据出版物的不同获得不同的报酬，但是为同一出版物工作的作者有不同的费率：

*   约翰以 300 美元的价格在 Foo 上发表了一篇文章
*   约翰以 350 美元在 Bar 发表文章
*   约翰以 400 美元在 Baz 发表文章
*   迪克以 250 美元的价格在 Foo 上发表了一篇文章
*   迪克以 400 美元在酒吧发表文章

等等

我想描述什么样的关系？

目前，我有一个带有 author `_id, site`_id 和 amount 列的“rates”表。给定publication.id和author.id，我得出文章的成本

```
cost = Rate.find(:first, :conditions => ["author_id = ? and site_id = ?", author.id, site.id]).rate 
```

这行得通，但我不确定这是不是最好的方法，而且我不确定如何确保我最终不会让“John”对“Baz”有两个费率。

我不认为我需要代码，而是希望有人说“哦，那是……关系”，这样我就可以掌握我在谷歌搜索的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-07T01:01:52.430

它拥有并属于许多具有丰富连接表的人。

```
class Author
  has_many :publications, :through => :rates
end

class Publication
  has_many :authors, :through => :rates
end

class Rate #rich join table
  belongs_to :author
  belongs_to :publication
end 
```

然后你可以像这样简化你的发现：

```
@author.rates.find_by_site_id(123) 
```

另外，您可以直接访问连接表

```
@author.publications
@publication.authors 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T00:58:59.160

它很简单，但我不知道这种关系是否有特定的名称。

看起来你需要三个表：

1.  作者（关于作者的信息）
2.  站点（有关站点的信息）
3.  评价作者/网站（仅评价信息）

在第三张表中，您至少有：

*   作者 ID（FK 到作者和主键）
*   站点 ID（FK 到站点和主键）
*   速度

并且费率表有两个字段作为具有唯一约束的主键。任何涉及作者和站点的连接都将涉及 3 表连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T05:39:48.767

当三个实体相互关联时，称为三元关系。

我们处理的大多数关系都是二元的，将两个实体相互关联。例如，学生和课程之间的“注册”关系。二元关系进一步分为多对多、多对一和一对一。但你知道的。

三元关系可以分为多对多对多、多对多对一、多对一对一等。

二元和三元关系可以进一步推广到 n 元关系。

以下是我对您概述的案例的看法：存在三个实体：作者、出版物和文章。除了这三个实体之外，还有一个度量，即比率。我可能错了。

所以我会看到三个实体表：

具有 PK AuthorID 的作者。
具有 PK PublicationID 的出版物。
文章，带有 PK ArticleID。

然后会有一个包含四列的关系表：

AuthorID (FK)、PublicationID (FK)、AtricleID (FK)、Rate，即货币金额。

这个的PK是(AuthorID, PublicationID, ArticleID)

并不是说，在这个设计中，没有费率表。这只是一个措施。

另请注意，在此设计中，可以由多个作者合作撰写一篇文章，并且每个作者都可以根据他/她的文章份额获得单独的费率。这在其他一些提议的设计中是不可能的。

同一篇文章也有可能出售给多个出版物。如果现实世界施加相同的约束，则可能需要对数据施加约束。

无论如何，如果您想向 Google 搜索一个搜索词，则该词是“三元关系”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T01:01:32.620

我会使用第三张表：

```
author_site_mapper
------------------
id
author_id
site_id
rate 
```

我通常听说这被称为“映射器”关系。它表示两个表之间的多对多关系。

# flash - FLV：如何阻止 VideoPlayer 与其包含的 MovieClip 一起缩放？

> ID：522816
> 
> 赞同：1
> 
> 时间：2009-02-07T00:46:30.543
> 
> 标签：flash, actionscript, flv

我在 swf 中创建了一个 VideoPlayer 对象，效果很好。我正在使用 autoSize 调整它的大小，这也很好。我正在努力做到这一点，以便当包含的 swf 变大时，视频保持相同的大小。swf 实际上是从另一个 Flash 电影加载的，这是调整大小的地方。VideoPlayer 类或movieclip 中是否有设置，我可以设置使其停止与movieclip 一起缩放？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T21:06:54.807

我不相信你想要的确切方法会奏效。在我看来，作为 DisplayObjectContainer 或扩展 DisplayObjectContainer 的 MovieClip 对象利用了复合设计模式，其中的子级在受到影响时会受到影响。考虑制作如下影片剪辑：

```
var mc:MovieClip = new MovieClip();
addChild(mc);

var mcChild:MovieClip = new MovieClip();
mc.addChild(mcChild); 
```

现在，如果您移动父级 mc，mcChild 会移动精确数量的像素，保留其“x”和“y”位置以及所有其他属性。

话虽如此，您需要将 VideoPlayer 放在可调整大小的影片剪辑的外部。很有可能，一旦影片剪辑的大小发生变化，您可能希望将视频播放器定位在相同的相对位置。

```
var mc:MovieClip = new MovieClip();
addChild(mc);

var vp:VideoPlayer = new VideoPlayer();
vp.x = mc.x + 10;
vp.y = mc.y + 10;
addChild(vp);

/**
 *If mc's registration point is "Top-Left" then adjustments aren't 
 *required because mc will span down and to the right, otherwise we
 *need to reposition the video.
 */
function resizeMovie(pWidth:Number, pHeight:Number):void
{
    mc.width = pWidth;
    mc.height = pHeight;

   adjustVideo();
}
function repositionMovie(pX:Number, pY:Number):void
{
    mc.width = pWidth;
    mc.height = pHeight;

   adjustVideo();
}
function adjustVideo():void
{
    //This is where we make sure of vp's positioning upon mc's change.
    vp.x = mc.x + 10;
    vp.y = mc.y + 10;
} 
```

因此，无论何时我们影响主体，我们都可以以自己的方式影响其他对象。同样的想法适用于调整舞台大小。

```
stage.addEventListener(Event.RESIZE, onStageResize);
function onStageResize():void
{
    //Make mc the size of the stage
    mc.width = stage.stageHeight;
    mc.height = stage.stageHeight;

    //Position video in relation to mc
    adjustVideo();
} 
```

最后，MovieClip 被设置为相对于自身的调整方式来调整其子级。作为 DisplayObjectContainer，其中的项目由父级（MovieClip）决定是有道理的，要完成您想要的，您只需将视频播放器从 swf 中抽象出来并相应地对其进行更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T21:33:06.617

并不是说我已经测试过了，但也许你可以在包含视频播放器的 swf 中为 Event.RESIZE 添加一个处理程序。然后做这样的事情：

```
private function onResize(e:Event):void
{
  childClip.scaleX = (scaleX != 0) ? (1 / scaleX) : 0;
  childClip.scaleY = (scaleY != 0) ? (1 / scaleY) : 0;
} 
```

# latex - 如何在 LaTeX 中输入多行脚注？

> ID：522823
> 
> 赞同：2
> 
> 时间：2009-02-07T00:52:36.287
> 
> 标签：latex

我的直觉是

```
Lorem ipsum\footnote{long footnote
  that spans a whole
  bunch of
  lines.
} 
```

但是，无论我将`{`and`}`与脚注文本放在哪里，我都会收到以下错误：

```
Latex Error: ./mydoc.tex:142 Package inputenc Error: Unicode char \u8:― not set up for use with LaTeX. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-07T01:01:48.390

脚注就像任何其他段落一样填充在可用空间中：您只需编写

```
\footnote{ 
    a whole lot of text that goes on and on and on and...
    ...
    and may consists of multiple sentences. But after a while
    ... 
    it finally comes to a stop.
} 
```

那不是你的问题。查看错误消息（我从个人经验中无法识别），我会说您的问题与字符集或字体有关。

您是使用 unicode 的编辑器吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-07T01:01:12.060

您收到的错误表明存在编码设置问题。谷歌搜索错误消息表明您可能正在运行 TexShop，或者您需要安装 latex unicode 支持。采用

```
apt-get latex-ucs 
```

或类似的东西，然后再试一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-26T16:35:43.573

当我从另一个文档中剪切文本并粘贴到 LaTeX 中时，我经常遇到这个错误。我的纯文本编辑器没有警告我我粘贴了一些坏字符。虽然很繁琐，但是可以

*   注释掉脚注的整个文本，将其替换为 XX，并确认您的文档现在可以运行
*   手动重新输入脚注的整个文本。

这总是对我有用。作为捷径，您可能会看到一个标点符号是罪魁祸首，然后简单地修复它。

在您给出的示例中，看起来您可能有一个 em-dash 字符，需要用两个或三个连字符的标准 LaTeX 结构替换。

# code-readability - 代码是用于计算机还是用于人？

> ID：522828
> 
> 赞同：30
> 
> 时间：2009-02-07T00:55:01.993
> 
> 标签：code-readability

最终，代码（最终）编译成 CPU 的指令。然而，代码（以我的拙见）是供人类阅读、更新和交互的。这使我得出以下观察结果：

*其他工程师无法阅读的代码，即使它是功能性的，也是糟糕的代码。*

考虑到这一点，这个程序员可以做些什么来使代码更容易被人类阅读？

*   命名约定？（乔尔对此有很多话要说）

*   代码结构/布局？（拜托，看在上帝的份上，不要卷入`{`位置辩论）

*   措辞？（是否可以编写看起来更像英语的代码）

[除了Joel 的](http://www.joelonsoftware.com/articles/Wrong.html)文章之外，还有其他好的文章吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-02-07T00:56:57.090

是的。

如果计算机不运行它，它就坏了。如果人们不能阅读它，它就会被破坏。很快。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-02-07T01:33:40.120

> “任何傻瓜都可以编写计算机可以理解的代码。优秀的程序员编写人类可以理解的代码。” *——Martin Fowler，“重构：改进现有代码的设计”*

但既然你自己已经得出了这个结论，那足以说这是一个巨大的话题。这不是你能得到一个单一答案的东西。使您的代码可维护不仅限于编码风格，还涉及您的整体设计以及构建过程。以下是该网站上的一些标签，其中几乎所有的问题和答案都会影响到这个主题：

*   [编码风格](https://stackoverflow.com/questions/tagged/coding-style)
*   [最佳实践](https://stackoverflow.com/questions/tagged/best-practices)
*   [重构](https://stackoverflow.com/questions/tagged/refactoring)

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-02-07T01:29:07.510

> 程序应该写给人们阅读，并且只是偶然地让机器执行。

——摘自 Abelson 和 Sussman 的“计算机程序的结构和解释”

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-07T01:33:24.490

编译器不在乎你的代码是写得很干净还是乱七八糟——只要语法正确，代码就会编译并运行。

**但是**，在代码维护方面，为人们编写干净的代码将非常有用。从业务案例的角度来看，新程序员理解代码所需的时间越短，让新人跟上进度所需的钱就越少。因此，更干净的代码更有价值。当程序员需要多 100% 的时间来理解不可读的代码时，它的执行速度提高了 5%，这有什么意义呢？毕竟，程序员要花不少钱。

遵循样式、变量命名等编码标准编写代码对于保持多人编写的代码保持一致非常*重要*。**遵循良好编码标准的一致代码库将更易于维护。**

通常，当涉及到优化代码时，它可能会变成一团难以理解的混乱，但总的来说，现在编译器在优化方面已经变得更好，因此编写更清晰的代码也将提高编译器捕获某些构造并执行优化的机会在它上面，从而提高性能。

**为人而不是机器写作。**

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-07T01:31:12.013

Roedy Green 写了一份详尽的指南，名为：[不可维护的代码](http://mindprod.com/jgloss/unmain.html)。

> “考虑到这一点，这个程序员可以做些什么来让代码更容易被人类阅读？”

回答：阅读本指南并将其内容反过来应用到您的开发活动中。

引用一般原则部分：

> “要挫败维护程序员，你必须了解他的想法。他有你的巨大程序。他没有时间阅读它，更不用说理解它了。他想快速找到进行更改的地方，制作它并走出去，不会因为改变而产生意想不到的副作用。
> 
> 他通过卫生纸管查看您的代码。他一次只能看到你程序的一小部分。你要确保他永远无法通过这样做来了解全局。你想让他尽可能难找到他正在寻找的代码。但更重要的是，你想让他安全地忽略任何事情变得尽可能尴尬。
> 
> 程序员因惯例而自满。每隔一段时间，通过巧妙地违反惯例，你强迫他用放大镜阅读你的每一行代码。
> 
> 你可能会认为每一种语言特性都会使代码无法维护——不是这样，只有在被正确滥用的情况下。”

虽然它是一个坚定的舌头，但它实际上是一个非常有用的列表（除了令人讨厌的广告），如果你真的关心编写可读/可维护的代码，应该避免什么。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-09-18T15:17:40.147

我对它的看法有点切题——这不是关于可读性，而是关于可维护性。

阅读只是看代码并认为您可以阅读它。通常认为，为了可读，它必须对没有努力理解它的人来说是可读的。

维护是进行更改以修复错误或实施新/更改的要求。阅读只是这个过程的一部分。我不知道任何不需要维护者学习曲线的可维护代码，对于没有爬过该曲线的人来说，代码看起来“不可读”。

同时，我认为*教维护者*帮助他们攀登学习曲线是程序员的一部分责任。一种方法是留下关于如何执行可以预期的未来变化的分步说明。

我经常看到被空白填充的代码，因此不太适合在屏幕上显示，并且给出了冗长的命名和冗长的注释。这给人以可读性的*印象*。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-07T00:58:20.223

`<sarcasm>`代码只能由机器读取。只要最终结果满足用户的需求，代码看起来如何并不重要。`</sarcasm>`

现在可维护的代码或可以更改的代码，这是一个完全不同的故事。

你会在餐巾纸背面写下一个计划来建造一所房子，还是在你建造完一所房子后扔掉蓝图，你可能想在一天内增加一个房间？

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-01T19:05:41.923

我建议看一下Robert Martin 的[Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882)。这是关于如何使您的代码更具可读性和简洁性的一个很好的指南。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-07T00:58:58.037

不要在类型安全的语言中使用[匈牙利符号。](http://en.wikipedia.org/wiki/Hungarian_notation)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-07T01:21:56.010

我对此的看法是，一切都是相对的。

当您需要更改代码时，代码是给您的，当它为机器执行时。

如果代码正常工作，它就有被读取的潜力。

你的人性和合作精神应该使它易于被其他人阅读，但最终，除了约定之外，代码的可读性有时可能在旁观者的眼中。

代码越容易被人们阅读，就越容易更改和维护，因为进化受益于您应用于问题的贡献/贡献者的数量，这种类型的代码可以比不可读的代码更好地声明。

但最终，代码将被制作成一组机器指令。

人类的意图被翻译成机器可以遵循的东西，因此代码同时适用于两者，一次一个。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-07T00:56:54.080

缺少的项目：评论。

即使代码对其作者来说完全清晰易读，但它可能并不适合所有人。

# latex - 如何在 LaTeX 中发出引用的文本内容？

> ID：522838
> 
> 赞同：6
> 
> 时间：2009-02-07T00:59:14.747
> 
> 标签：latex

我有一个部分：

```
\section{Introduction} \label{sec:introduction} 
```

我想要一个指向该部分的链接，其中链接文本是该部分的名称。我可以使用`hyperref`：

```
The \hyperrf[sec:introduction]{Introduction} introduces the paper. 
```

但这需要重复部分标题（“简介”）。有没有办法抓住它？`ref`产生节号，这是不对的。 `autoref`产生“节”，然后是节号，这也不对。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-07T01:27:02.473

有几个软件包可以为您提供这个。nameref 作为 hyperref 的一部分分发以执行此操作：
[http ://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=nameref](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=nameref)

有一个更通用的包用于交叉引用基本上任何东西，称为 zref： [http ://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=zref](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=zref)

它与 hyperref 的作者 Heiko Oberdiek 为同一作者；这是我会选择的。这是一个例子：

```
\documentclass[oneside,12pt]{article}
\usepackage[user,titleref]{zref}
\begin{document}
\section{Introduction of sorts.}\zlabel{sec:intro}
Hello
\subsection{Structure}
We begin in `\ztitleref{sec:intro}'.
\end{document} 
```

请注意，它甚至会删除部分标题中的尾随句点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T01:23:55.977

据我所知，没有标准的方法可以做到这一点。简而言之，分段命令不会将分段的名称存储在可以轻松检索到的任何地方。是的，它们被插入到目录（和相关的辅助文件）中并设置了标记，但对这些的访问充其量是不可靠的，并且通常在没有额外上下文的情况下是不可能的，当您需要返回时几乎总是不可用到该部分。

您发布的代码示例看起来像我要写的。可能有一个包可以自动执行此操作，但如果存在的话，它可能是非常多毛的代码，因为这实际上不是一个特别常见的用例。实际上，要对您进行所有语法纳粹分析，您创建的最终文本是不正确的；“介绍”这个词在句子中应该是小写的，这不能通过反向引用实际的章节标题来实现（通常）。

我只是把它吸起来，然后手动写出这样的参考资料。它们的数量不足以证明自动化是合理的。当然，如果你做的事情比你的例子所暗示的更多（许多自动生成的部分或其他东西），事情可能会有所不同，但如果是这样的话，那真的是一个完全不同的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T01:16:05.040

你可以尝试使用

*   `\newsavebox`
*   `\savebox`
*   `\usebox`

这不会为您节省任何打字时间，但会为您提供每个标题的单一权威来源

* * *

你可能会搜索`ctan.org`，我怀疑这已经完成了。

# jquery - jquery 拖放问题：drop() 函数永远不会被调用

> ID：522846
> 
> 赞同：1
> 
> 时间：2009-02-07T01:02:43.787
> 
> 标签：jquery, drag-and-drop, draggable, droppable

我在 jquery 1.3.1（UI 版本 1.5.3）中的可放置效果遇到问题。据我所知，除了 drop() 函数没有被调用之外，一切都运行良好。我可以告诉可放置目标正在接受被拖动的元素（通过缩略图类），但可拖动项目不会下降。提前感谢您的帮助！

```
<html>
<head>
<script type="text/javascript" language="javascript" src="/jquery/jquery.js"></script>
<script type="text/javascript" language="javascript" src="/jquery/jquery.ui.js"></script>
<script type="text/javascript" language="javascript">
//<!--
    $(document).ready(function() {
        $('.drop_box').droppable({
            accept: '.thumbnail',
            activeClass: 'droppable-active',
            hoverClass: 'droppable-hover',
            drop: function (ev, ui) { 
                alert("Dropped!"); 
            }
        });

        $('#sample_thumbnail').draggable({ 
            helper: 'clone'
        });
    });
//-->
</script>
<style type="text/css">
    .drop_box {
        top:16px;
        width:250px;
        height:250px;
        border:1px solid #000000;
        float: right;   
    }
    .droppable-hover {
        background-color: #eeeeee;
        border: 1px solid red;
    }
    .droppable-active {
        background-color: orange;
        color: white;
        border: 1px solid blue;
    }
    .thumbnail {
        width:100px; 
        height:100px;
        border:1px solid green;
    }
</style>
</head>
<body>
<div class="drop_box">droppable</div>
<div id="sample_thumbnail" class="thumbnail">draggable</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T01:30:58.490

“jquery 1.3.1（用户界面版本 1.5.3）”

您不应该使用这对版本。JQuery 1.3.x 与 UI 1.5.x 系列不兼容，需要 1.6 候选版本。如果您只需要拖放功能，则候选发布版本非常稳定；我根本不会担心在生产中使用它们。我只使用拖放，所以我无法评论 UI 的 1.6 分支其余部分的稳定性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T01:35:09.650

我在使用 jQuery 1.2.6 和 jQuery UI 1.5.3 的 Mac/Safari 或 Mac/Firefox 上的代码没有任何问题。我认为您的问题与不兼容的版本有关。

# linux - 如何在 .screenrc 中指定选项卡？

> ID：522850
> 
> 赞同：0
> 
> 时间：2009-02-07T01:04:27.373
> 
> 标签：linux, gnu-screen

根据[this website](http://www.mattcutts.com/blog/screen-power-tips-screenrc/)，您可以更改为Unix“screen”实用程序使用的命令键序列，如下所示：

```
escape ^Bb # Instead of Control-a, make the 
           # escape/command character be 
           # Control-b 
```

我想知道，您将如何使其成为 Control-Tab？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T01:15:31.763

从未尝试过，但您可以使用此[链接](http://www.staldal.nu/tech/2009/01/10/how-to-use-ctrl-tab-in-gnu-screen/)

# java - 如何在 Java 中四舍五入货币值？

> ID：522855
> 
> 赞同：12
> 
> 时间：2009-02-07T01:06:18.100
> 
> 标签：java, currency, rounding

好的，这是我的问题。基本上我有这个问题。

我有一个像 .53999999 这样的数字。如何在不使用任何数学函数的情况下将其四舍五入到 54？

我猜我必须乘以 100 来缩放它，然后除以？类似的东西？

* * *

问题在于钱。假设我有 50.5399999 美元，我知道如何获得 50 美元，但我不知道如何获得美分。我可以得到 .539999 部分，但我不知道如何将其变为 54 美分。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-07T01:19:19.103

我会使用类似的东西：

```
BigDecimal result = new BigDecimal("50.5399999").setScale(2, BigDecimal.ROUND_HALF_UP); 
```

[JavaWorld](http://www.javaworld.com)上有一篇名为[Make cents with BigDecimal](http://www.javaworld.com/javaworld/jw-06-2001/jw-0601-cents.html?page=2)的精彩文章，您应该看看。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-07T01:16:30.140

您应该使用小数或货币类型来表示货币，而不是浮点数。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-07T10:14:57.777

### 有钱的数学比大多数工程师想象的要复杂（过度概括）

如果您在进行货币计算，我认为您可能正在研究表面上看起来很简单但实际上非常复杂的问题。例如，由于业务逻辑决策经常重复而产生的舍入方法会极大地影响计算的总数。

*   我建议查看[Java Currency 类](http://java.sun.com/javase/6/docs/api/java/util/Currency.html)以了解货币~~格式~~。
*   还可以查看有关在 java[中表示货币的此页面](http://www.javapractices.com/topic/TopicAction.do?Id=13)可能会有所帮助。

如果这是家庭作业，向老师展示您已经思考了现实世界的问题，而不是仅仅将一堆“有效”的代码放在一起 - 肯定会更令人印象深刻。

顺便说一句，我最初打算建议查看源代码中 Java 数学方法的实现，所以我看了一下。我注意到 Java 正在使用本机方法来进行舍入方法——就像它应该做的那样。

但是，查看 BigDecimal 表明存在可用于在 Java 中舍入的 Java 源代码。因此，我建议您查看 Java 源代码中的 BigDecimal 私有方法 doRound(MathContext mc) ，而不是只为您的作业提供代码。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-07T01:30:38.863

如果 50.54 不能以双精度表示，则舍入将无济于事。

如果您尝试将 50.53999999 转换为整数美元*和整数美分*，请执行以下操作：

```
double d = 50.539999; // or however many 9's, it doesn't matter
int dollars = (int)d;
double frac = d - dollars;
int cents = (int)((frac * 100) + 0.5); 
```

请注意，在最后一步中添加 0.5 是四舍五入到*最接近的*整数美分。如果您总是希望它*向上取*整，请将其更改为添加 0.9999999 而不是 0.5。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-07T01:07:50.250

为什么你不想使用任何数学函数？

```
static long round(double a) 
```

- 返回最接近参数的 long。

[http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Math.html](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Math.html)

为了代表金钱，我会接受以下建议，而不是重新发明轮子：

[http://www.javapractices.com/topic/TopicAction.do?Id=13](http://www.javapractices.com/topic/TopicAction.do?Id=13)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-19T21:07:36.713

尝试将您的货币存储为美分数量（您可以将其抽象为基本货币单位的数量）并使用 long。

编辑：由于这是家庭作业，您可能无法控制类型。将此视为未来项目的教训

```
long money = 5054;

long cents = money % 100;
long dollars = money / 100; // this works due to integer/long truncation

System.out.printf("$%d.%02.d", dollars, cents); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-07T01:24:45.647

您需要将数字设为 0.535 并将其与您的原始数字进行比较，看看您是否会向上或向下舍入。以下是从 .53999999 获得 .535 的方法（应该适用于任何数字）：

```
num = .53999999;
int_num = (int)(num * 100); // cast to integer, however you do it in Java
compare_num = (int_num + 0.5) / 100; 
```

`compare_num`在这种情况下为 0.535。如果`num`大于或等于`compare_num`，则向上取整`int_num + 1`。否则简单地向下舍入`int_num`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-07T09:17:31.697

我建议您使用 long 来舍入一个 double 值。对小数字没关系，但可能会有所作为。

```
double d = 50.539999;
long cents = (long)(d * 100 + 0.5);
double rounded = cents/100; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-07T01:16:58.283

肖恩似乎有它，除了，如果你想强加适当的规则，那么你可能想像这样抛出一个 if 语句：

```
double value = .539999;
int result = (int) (value*100);
if(((value*100)%result)>.5)
    result++; 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-07T01:10:25.300

你到底想做什么？您是否总是试图达到两位数？还是无论如何，您总是试图在最后修复诸如 99999 之类的问题？

根据评论，实际上是前者：四舍五入到美元和美分。所以确实`round(100*a)/100`正是你想要的。（后者会复杂得多......）

最后，如果您只想提取美分​​部分，则可以使用以下方法：

```
dollars_and_cents = round(100*a)/100
cents = (dollars_and_cents-(int)dollars_and_cents)*100 
```

（或者 java 是否只有`frac`？在这种情况下，最后一行将是`frac(dollars_and_cents)*100`.

# vb.net - VB.Net 界面 Visual Studio 2008 字体颜色设置

> ID：522861
> 
> 赞同：1
> 
> 时间：2009-02-07T01:12:20.273
> 
> 标签：vb.net, visual-studio, resharper

是否可以使用 VB.Net 和 Resharper/VS2008 更改接口名称出现的字体颜色？

我已经成功地更改了 C# 中的接口名称，但 VB 没有运气 :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T01:16:04.930

是和不是。您可以更改界面关键字的颜色，但您必须将所有关键字的颜色更改为该颜色。在 VB 中没有办法只更改 Interface 关键字的名称。这是 VS 2008 中的一个不幸的限制。

# javascript - 在页面加载时打开 jquery 模式对话框

> ID：522864
> 
> 赞同：4
> 
> 时间：2009-02-07T01:14:38.320
> 
> 标签：javascript, jquery, jquery-ui

我有一个页面，我希望它在页面加载后立即在模式对话框（jquery UI 对话框）中显示一些内容。

```
 $(document).ready(function(){
    $("#example").dialog();
  });

<div id="example" class="flora" title="This is my title">
    I'm in a dialog!
</div> 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-07T01:51:13.313

您的 div 标签格式不正确，需要关闭。以下对我有用，但它需要适当的 CSS 文件。

```
<html>
<head>
<script type="text/javascript" language="javascript"
        src="jquery/jquery.js"></script>
<script type="text/javascript" language="javascript"
        src="jquery/jquery.ui.js"></script>
<script type="text/javascript" language="javascript">
    $(document).ready(function(){
        $("#example").dialog({modal: true});
    });
</script>
</head>
<body>
    <div id="example" class="flora" title="This is my title">
        I'm in a dialog!
    </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T07:55:47.053

韦恩汗是对的

> 默认行为是在您调用 dialog() 时打开，除非您将 autoOpen 设置为 false。

尽管默认对话框不是模态对话框，但 tvanfosson 几乎是正确的。要显示模式窗口，您必须将**`modal`**选项设置为**`true`**

为了说明，这是我今晚正在做的一个[小项目](http://drfloob.com/code/3:incomeagain)的精简摘录：

```
...
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script>
<script type="text/javascript" src="./jquery-ui-personalized-1.6rc6.min.js"></script>
<script type="text/javascript" src="./init.js"></script>
<link rel="stylesheet" href="./css.css" type="text/css" />
<script type="text/javascript">
    $(function() {
        $('#exampleNode').dialog({
            modal: 'true'
        });
    });
</script>
... 
```

* * *

供你参考：

*   [jQuery 对话框文档](http://docs.jquery.com/UI/Dialog)（样式参考见底部）
*   [模态对话框示例](http://ui.jquery.com/demos/dialog/#modal)
*   我的小型 MIT 许可项目，有一个模态对话框：[inComeAgain？](http://drfloob.com/uploads/inComeAgain/)

# c# - 如何确保用户只能在 ASP.NET 投票中投票一次

> ID：522871
> 
> 赞同：6
> 
> 时间：2009-02-07T01:16:41.857
> 
> 标签：c#, asp.net, ip-address

我正在尝试进行 ASP.NET (C#) 投票，该投票将询问用户是/否问题并将投票记录到数据库中。为了防止垃圾邮件，我希望能够确保用户只能投票一次。我考虑过记录用户的 IP 地址。如果这是答案，有人可以给我一个教程，说明如何完成。如果这不是答案，请给我您的建议。

**编辑：**我不要求用户注册，因为这不是我的网站。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-07T01:22:53.170

如果您可以对用户进行身份验证，您只能保证每个用户都有一票。因此，您需要一种身份验证机制，这将允许您阻止用户注册多个帐户。

我只能在用户向他的帐户中投资的环境中看到这项工作，例如在线报纸的订阅者或 StackOverflow 上的声誉系统。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T01:23:39.080

如果您有注册用户列表，请向他们发送一封电子邮件，其中包含生成的包含 guid 的唯一链接（例如），将 GUID 记录在数据库中并在投票时进行匹配。

如果您谈论的是通常可公开访问和安全的，那么 IP 地址本身是不够的（谷歌电子选举投票解决了与安全公众投票相关的许多问题）。

您是否考虑过使用其中一项免费投票服务？

[Condorcet 网络投票服务](http://www.cs.cornell.edu/andru/civs.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-07T01:36:43.547

您不能将单次投票限制为一个 IP 地址。IP 地址不等于单个用户。一个 IP 地址代表一个或多个用户。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-07T01:25:58.670

IP 地址也不适用于在代理后面工作的数百万人。

Cookie 是部分解决方案，但投票机器人无法发送 cookie。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-07T01:28:37.650

登录会话是防止双重投票欺诈的唯一方法，但由于您明确要求记录 IP 地址的方法，您可以通过以下方式获得：

`HttpContext.Current.Request.UserHostAddress;`

或者

`HttpContext.Current.Request.ServerVariables["REMOTE_ADDR"];`

应该很容易保存到数据库并检查每次轮询中是否已经存在 IP。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-07T01:34:16.110

进行需要电子邮件确认注册的注册，并确保电子邮件地址在您的用户中是数据库中的唯一列。然后将投票与电子邮件地址联系起来。它不会完全阻止拥有多个电子邮件地址的袜子木偶，但至少会让大多数人不值得付出努力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-07T01:39:23.293

IP 和用户代理的组合可以给你一个合理的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-07T03:28:24.180

我同意一个 IP 地址不对应一个用户，但我认为这是维持每人一票的最安全方式。我通常使用 cookie 来跟踪谁投票。当然，这是一个简单的技巧，您可以删除 cookie，然后再次投票。如果投票只是一些随机的东西，那么我真的不在乎。如果正确的投票对您的应用程序真的很重要，那么请使用 IP 地址。

# php - Base 64 编码与加载图像文件

> ID：522897
> 
> 赞同：40
> 
> 时间：2009-02-07T01:29:57.103
> 
> 标签：php, mysql, html, image, base64

所以我正在用 php 做一些事情，我必须从 sql 数据库中获取我的图像，它们将以 base64 编码。显示这些图像的速度至关重要，因此我试图弄清楚将数据库数据转换为图像文件然后将其加载到浏览器中是否会更快，或者只是回显原始 base64 数据并使用：

```
<img src="data:image/jpeg;base64,/9j/4AAQ..." /> 
```

FireFox 和其他 Gecko 浏览器均支持该功能。

所以回顾一下，传输实际图像文件或base64代码会更快吗？使用ajax加载图像时需要更少的http请求吗？

图像总共不超过 100 像素。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-07T01:47:53.947

*   Base64 编码使文件更大，因此传输速度更慢。
*   通过在页面中包含图像，每次都必须下载它。外部图像通常只下载一次，然后由浏览器缓存。
*   它不兼容所有浏览器

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-23T05:52:08.253

好吧，我不同意你们中的任何人。在某些情况下，您必须加载越来越多的图像。并非所有页面都包含 3 张图片。实际上，我正在一个需要加载 200 多张图片的网站上工作。当 100000 个用户在一个负载非常大的网站上请求 200 张图片时会发生什么。服务器的磁盘，返回图像应该崩溃。更糟糕的是，您必须向服务器发出如此多的请求，而不是使用 base64。对于这么多缩略图，我更喜欢 base64 表示，预先保存在数据库中。[我在http://www.stoimen.com/2009/04/23/when-you-should-use-base64-for-images/](http://www.stoimen.com/2009/04/23/when-you-should-use-base64-for-images/)找到了解决方案和强有力的论据. 这家伙真的是那种情况，做了一些测试。我印象深刻，也进行了测试。现实就像它说的那样。对于在一页中加载的如此多的图像，来自服务器的一个响应确实很有帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-07T09:26:58.713

如果不修改，为什么要一次又一次地重新生成图像。假设，即使基于 1000 个不同的条件要显示 1000 个不同的可能图像，我仍然认为磁盘上的 1000 个图像更好。请记住，基于磁盘的图像可以由浏览器缓存并节省带宽等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-07T01:57:33.333

不要认为`data://`在 IE7 或更低版本中有效。

当请求图像时，您可以将其保存到文件系统，然后从那时起提供该图像。如果数据库中的图像数据发生更改，则只需删除该文件。也可以从另一个域（例如 img.domain.com）提供它。您可以从您的网络服务器免费获得上次修改或电子标签的所有好处，而无需启动 PHP，除非您也需要。

如果您使用的是 apache：

```
# If the file doesn't exist:
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^/(image123).jpg$ makeimage.php?image=$1 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-12-16T19:47:02.840

为了回答最初的问题，我进行了一个测试，以 96 ppi 测量 400x300 像素的 jpeg 图像：

```
base64ImageData.Length
177732

bitmap.Length
129882 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-02-15T17:07:40.543

这是一个非常快速和简单的解决方案。虽然图像大小会增加 33% 左右，但使用 base64 会显着减少 http 请求的数量。

Google 图像和 Yahoo 图像使用 base64 并内联提供图像。检查源代码，你会看到它。

当然，这种方法也有缺点，但我相信收益大于成本。我发现的一个缺点是慢速设备。例如，在 iPhone 3GS 中，由 google 图像提供的图像渲染速度非常慢，因为图像是从服务器 gzip 压缩的，并且必须在浏览器中解压缩。因此，如果客户的设备速度较慢，他在渲染图像时会受到一点影响。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-02-27T08:17:43.277

我曾经使用过一次或两次 base64 图像作为图标（10x10 像素左右）。

# Base64 图像优点：

*   紧凑 - 你有一个文件。同样，如果文件被压缩，base64 图像几乎被压缩到普通图像的大小。
*   在单个请求中检索页面。

# Base64 图像缺点：

*   实际上，您可能需要在包含图像的所有页面上使用脚本引擎（例如 PHP）。
*   如果图像更改，则必须重新下载所有缓存的页面。
*   因为图像是内联的，所以不能使用 CDN 或静态内容 Web 服务器。

# 普通图像优点：

*   如果您使用 SPDY 协议，至少理论上，页面 + 图像 + CSS 也将通过单个请求加载。
*   您可以在图像上设置过期时间，因此将从浏览器缓存内容。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-07T01:50:37.920

一般来说，使用 base64 编码会使字节大小增加约 1/3。因此，您将不得不将 1/3 字节从数据库移动到服务器，然后将这些额外的 1/3 字节通过线路移动到浏览器。

当然，随着图像大小的增长，所提到的开销也会成比例地增加。

话虽如此，我认为将文件更改为数据库中的字节表示形式并传输它们是个好主意。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-03-21T10:16:54.437

回答 OP 问题。作为静态文件，直接通过磁盘通过网络服务器。它们只有 100 像素，非常适合 Web 服务器的内存缓存。几乎所有的 Web 服务器都有大量的信息、缓存策略、配置、操作方法。

Infact - 就用户体验（您所指的图像速度）而言，最佳选择是使用支持 CDN 的对象存储。时期。

作为静态存储选择的“数据库”非常昂贵——就所有开销处理、数据库负担、财务和技术债务而言。

几件事，来自几个答案

> Google 图像和 Yahoo 图像使用 base64 并内联提供图像。检查源代码，你会看到它。

不，他们绝对不会。图像主要来自静态文件“网络服务器”，特别是 gstatic.com：例如[https://ssl.gstatic.com/gb/images/p1_2446527d.png](https://ssl.gstatic.com/gb/images/p1_2446527d.png)

> 紧凑 - 你有一个文件。同样，如果文件被压缩，base64 图像几乎被压缩到普通图像的大小。

所以实际上，一点优势都没有，加上需要压缩的处理？

> 在单个请求中检索页面。同样，多个并行请求而不是单个更大的负载。
> 
> 当 100000 个用户在一个负载非常大的网站上请求 200 张图片时会发生什么。服务器的磁盘，返回图像应该崩溃。您仍将发送相同数量的数据，但连接时间更长，并且会给您的数据库带来压力。其次，工厂站点运行具有 100000 个并发连接的可能性......即使是这样，如果您在单个服务器上运行这一切，您就是一个愚蠢的管理员。

通过将图像（二进制 blob 或 base64）存储在数据库中，您所做的一切都会为数据库增加巨大的开销。要么，你有大量的 RAM，要么你通过数据库的查询无论如何都会从磁盘上掉下来。而且，如果您确实拥有如此无限的 RAM，那么从 Ramdisk 上提供 bin 图像 - 理想情况下，通过替代专用的、轻量级的 Web 服务器静态文件和缓存优化，在子域上配置，将是最快、最轻的负载！

远期规划？到目前为止，您只能扩大规模，并且扩大数据库的成本很高（相对而言）。你说的磁盘再次将“sp

在这种情况下，您为 100000 个并发用户提供 100 张图像，您的图像服务应该是 CDN 对象存储的域。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-07T02:19:26.037

如果您想要最快的速度，那么您应该在上传/修改它们时将它们写入磁盘，并让网络服务器提供静态文件。Rojoca 的建议也很好，因为它们最大限度地减少了 php 的调用。从另一个域提供服务的另一个好处是（大多数）浏览器将并行发出请求。

除此之外，当您查询数据时，请检查它是否上次修改，然后将其写入磁盘并从那里提供服务。您需要确保尊重 If-Modified-Since 标头，以免不必要地传输数据。

如果您无法写入磁盘或其他缓存，那么将其作为二进制数据存储在数据库中并将其流出是最快的。此时调整缓冲区大小将有所帮助。

# php - 在 mysql_fetch_array 函数中获取 php 中的指针位置

> ID：522908
> 
> 赞同：0
> 
> 时间：2009-02-07T01:33:42.103
> 
> 标签：php, while-loop

我有一个相当标准的 while mysql_fetch_array 语句在 php 中，我试图找出结果集中的哪一行正在打印。

我认为这应该很简单，但我已经提出了一个相当标准的

```
$i=0;
$count=mysql_num_rows($getResults);
而($resultArray=mysql_fetch_array($getResults)){

$i++
如果（$i==$count）{
echo "这是最后一行";
}
}

```

但奇怪的是，这是行不通的。还有其他方法可以找到最后一行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T01:48:12.073

你得到的是正确的（也就是说，它*应该*工作）：你确定有超过 0 行被返回？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T01:59:49.460

这对我有用。您的位置有点不同，$i++ 后面没有分号

```
$i=0;
$count=mysql_num_rows($result);
while($resultArray=mysql_fetch_array($result))
{
    if($i==$count-1)
    {
        "this is the last row";
    }
    $i++;
} 
```

# c# - 这是对三元运算符的合理使用吗？

> ID：522919
> 
> 赞同：7
> 
> 时间：2009-02-07T01:39:04.633
> 
> 标签：c#, c++, c, ternary

是否有任何由代码导致的理解/可维护性问题，例如

```
inVar1 == 0 ? NULL : v.push_back(inVar1);
inVar2 == 0 ? NULL : v.push_back(inVar2); 
```

等等。

可能令人困惑的想法是使用三元运算符进行程序流而不是变量赋值，这是通常的解释。

我还没有看到工作中解决这种用法的编码标准，所以虽然我很乐意这样做，但我想知道是否有充分的理由不这样做。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-07T01:41:35.580

我认为这比简单地打字更令人困惑并且更难阅读。

```
if (inVar != 0)
  v.push_back(inVar); 
```

我不得不多次扫描你的例子，以确定结果是什么。我什至更喜欢单行 if() {} 语句而不是您的示例 - 我讨厌单行 if 语句:)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-07T01:44:40.333

三元运算符旨在返回一个值。

IMO，它不应该改变状态，应该使用返回值。

在另一种情况下，使用 if 语句。If 语句用于执行代码块。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-07T02:53:33.283

三元是个好东西，我一般都提倡它的用法。

然而，你在这里所做的事情会损害它的可信度。它更短，是的，但它不必要地复杂。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-07T01:41:26.813

我认为应该避免这种情况。您可以在其位置使用 1 行 if 语句。

```
if(inVar1 != 0) v.push_back(inVar1); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-07T02:34:59.640

如今的编译器将使 if 与三元运算符一样快。

您的目标应该是其他软件开发人员阅读的难易程度。

我投票给

```
if ( inVar != 0 )
{
   v.push_back( inVar );
} 
```

为什么要使用括号...因为有一天您可能想在其中放些其他东西，而括号是为您预先完成的。如今，大多数编辑无论如何都会把它们放进去。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-07T02:48:23.200

**您对三元运算符的使用不会给您带来任何好处，并且会损害代码的可读性。**

由于三元运算符返回一个您未使用的值，因此它是奇数代码。在像您这样的情况下，使用 an`if`更加清楚。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-07T03:38:26.313

正如评论中提到的 litb ，这[不是有效的 C++](http://www.kuzbass.ru:8086/docs/isocpp/expr.html#expr.cond)。例如，GCC 将在此代码上发出错误：

```
error: `(&v)->std::vector<_Tp, _Alloc>::push_back [with _Tp = int, _Alloc =
std::allocator<int>](((const int&)((const int*)(&inVar1))))' has type `void' 
and is not a throw-expression 
```

但是，这可以通过强制转换来解决：

```
inVar1 == 0 ? (void)0 : v.push_back(inVar1);
inVar2 == 0 ? (void)0 : v.push_back(inVar2); 
```

但代价是什么？出于什么目的？

在这种情况下，这里使用三元运算符并不比 if 语句更简洁：

```
inVar1 == 0 ? NULL : v.push_back(inVar1);
if(inVar1 != 0) v.push_back(inVar1); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-07T02:39:55.527

虽然在实践中，我同意那些不鼓励这种写作的人的观点（阅读时，你必须做额外的工作来扫描表达式的副作用），我想提供

```
!inVar1 ?: v.push_back(inVar1);
!inVar2 ?: v.push_back(inVar2); 
```

...如果您要晦涩难懂，那就是。GCC 允许`x ?: y`代替`x ? x : y`. :-)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-07T07:39:50.787

当我需要使用条件参数调用某个函数时，我使用三元运算符 - 在这种情况下，它会更好`if`。

比较：

```
printf("%s while executing SQL: %s",
        is_sql_err() ? "Error" : "Warning", sql_msg()); 
```

和

```
if (is_sql_err())
    printf("Error while executing SQL: %s", sql_msg());
else
    printf("Warning while executing SQL: %s", sql_msg()); 
```

我觉得前者更吸引人。并且它符合[DRY](http://en.wikipedia.org/wiki/DRY)原则，与后者不同 - 你不需要编写两条几乎相同的行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-07T01:44:48.710

我认为你最好做一个适当的 if 结构。我什至更喜欢在 if 结构中始终使用大括号，以防我稍后必须在条件执行中添加行。

```
if (inVar != 0) {
    v.push_back(inVar);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-07T21:52:23.670

我认为有时三元在构造函数的初始化列表中是必要的。我主要将它们用于要分配内存并在构造函数主体之前设置一些指向它的指针的构造函数。

举个例子，假设您有一个整数存储类，您希望将向量作为输入，但内部表示是一个数组：

```
class foo
{
public:
    foo(std::vector<int> input);
private:
    int* array;
    unsigned int size;
};

foo:foo(std::vector<int> input):size(input.size()), array( (input.size()==0)?
        NULL : new int[input.size])
{
    //code to copy elements and do other start up goes here
} 
```

这就是我使用三元运算符的方式。我不认为它像某些人那样令人困惑，但我确实认为应该限制他们使用它的数量。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-08T01:14:35.283

我看到的大多数受折磨的三元组（头韵如何？）只是尝试将真正属于 if 语句的逻辑放在 if 语句不属于或不能去的地方。

例如：

```
if (inVar1 != 0)
  v.push_back(inVar1);
if (inVar2 != 0)
  v.push_back(inVar2); 
```

假设 v.push_back 是无效的，但如果它返回一个需要传递给另一个函数的值怎么办？在这种情况下，它必须看起来像这样：

```
SomeType st;
if (inVar1 != 0)
  st = v.push_back(inVar1);
else if (inVar2 != 0)
  st = v.push_back(inVar2);
SomeFunc(st); 
```

但是对于这么简单的一段代码，这更需要消化。我的解决方案：定义另一个函数。

```
SomeType GetST(V v, int inVar1, int inVar2){
    if (inVar1 != 0)
      return v.push_back(inVar1);
    if (inVar2 != 0)
      return v.push_back(inVar2);        
}

//elsewhere
SomeFunc(GetST(V v, inVar1, inVar2)); 
```

无论如何，重点是：如果您有一些逻辑对于三元组来说太折磨了，但是如果将其放在 if 语句中会弄乱您的代码，请将其放在其他地方！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-19T00:52:36.920

```
inVar1 != 0 || v.push_back(inVar1);
inVar2 != 0 || v.push_back(inVar2); 
```

在 Perl 等语言中发现的常见模式。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-07T07:50:35.587

如果您在一个或两个三元参数中有多个方法调用，那么它是错误的。所有代码行，无论是什么语句，都应该简短而简单，最好不要复合。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-07T07:50:54.663

正如其他人所提到的，正确的 if 语句更具可读性。此外，当您使用调试器单步执行代码时，当所有内容都在一行中或使用三元表达式时，您将无法轻易看到 if 的哪个分支：

```
if (cond) doIt();

cond ? noop() : doIt(); 
```

而下面的步骤要好得多（无论你是否有大括号）：

```
if (cond) {
    doIt();
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-08T01:15:46.903

如前所述，它并不比 1 行 if 语句更短或更清晰。然而，它也不再是——而且并不那么难理解。如果您知道三元运算符，那么很明显发生了什么。

毕竟，如果将其分配给变量，我认为任何人都不会有问题（即使它也是变异状态）：

```
var2 = inVar1 == 0 ? NULL : v.push_back(inVar1); 
```

三元运算符总是返回一个值 - IMO - 的事实是无关紧要的。当然没有要求您使用所有返回值......毕竟，赋值返回一个值。

话虽如此，如果我用 NULL 分支遇到它，我会用 if 语句替换它。

*但是*，如果它替换了 3 行 if 语句：

```
if (inVar == 0) {
   v.doThingOne(1);
} else {
   v.doThingTwo(2);
} 
```

和：

```
invar1 == 0 ? v.doThingOne(1) : v.doThingTwo(2); 
```

我*可能会*离开它......取决于我的心情。;)

# python - Python 无法创建实例

> ID：522921
> 
> 赞同：5
> 
> 时间：2009-02-07T01:39:29.390
> 
> 标签：python, pycxx

我正在尝试使用[PyCXX](http://cxx.sourceforge.net)创建一个简单的 Python 扩展。我正在针对我的 Python 2.5 安装进行编译。

我的目标是能够在 Python 中执行以下操作：

```
import Cats

kitty = Cats.Kitty()

if type(kitty) == Cats.Kitty:
    kitty.Speak() 
```

但每次我尝试，这是我得到的错误：

`TypeError: cannot create 'Kitty' instances`

它确实`Cats.Kitty`被视为一个类型对象，但我无法创建 Kitty 类的实例，有什么想法吗？

这是我目前的来源：

```
#include "CXX/Objects.hxx"
#include "CXX/Extensions.hxx"
#include <iostream>

using namespace Py;
using namespace std;

class Kitty : public Py::PythonExtension<Kitty>
{
    public:
        Kitty()
        {
        }

        virtual ~Kitty()
        {
        }

        static void init_type(void)
        {
            behaviors().name("Kitty");
            behaviors().supportGetattr();

            add_varargs_method("Speak", &Kitty::Speak);
        }

        virtual Py::Object getattr( const char *name )
        {
            return getattr_methods( name );
        }

        Py::Object Speak( const Py::Tuple &args )
        {
            cout << "Meow!" << endl;
            return Py::None();
        }
};

class Cats : public ExtensionModule<Cats>
{
    public:
        Cats()
            : ExtensionModule<Cats>("Cats")
        {
            Kitty::init_type();

            initialize();

            Dict d(moduleDictionary());
            d["Kitty"] = Type((PyObject*)Kitty::type_object());
        }

        virtual ~Cats()
        {
        }

        Py::Object factory_Kitty( const Py::Tuple &rargs )
        {
            return Py::asObject( new Kitty );
        }
};

void init_Cats()
{
    static Cats* cats = new Cats;
}

int main(int argc, char* argv[])
{
    Py_Initialize();

    init_Cats();

    return Py_Main(argc, argv);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T03:05:25.333

我在代码中没有看到它，但通常意味着它无法创建实例，这意味着它找不到 ctor。你确定你有一个与预期签名*完全匹配的演员吗？*

# html - 您可以在不使用表格的情况下进行这种 HTML 布局吗？

> ID：522928
> 
> 赞同：103
> 
> 时间：2009-02-07T01:44:01.893
> 
> 标签：html, css, layout

好的，一两周前我遇到了一个简单的布局问题。即页面的各个部分需要一个标题：

```
+---------------------------------------------------------+
| Title                                            Button |
+---------------------------------------------------------+ 
```

很简单的东西。事情是表格仇恨似乎已经在 Web 世界中占据了主导地位，当我问[为什么 HTML 表单使用定义列表（DL、DD、DT）标签而不是表格时，我想起了这一点？](https://stackoverflow.com/questions/519234/why-use-definition-lists-dl-dd-dt-tags-for-html-forms-instead-of-tables) 现在已经讨论了表格与 divs/CSS 的一般主题，例如：

*   [DIV 与表](https://stackoverflow.com/questions/83073/div-vs-table)；和
*   [表而不是 DIV](https://stackoverflow.com/questions/30251/tables-instead-of-divs)。

因此，这并不是关于 CSS 与表格布局的一般性讨论。这只是解决一个问题。我使用 CSS 尝试了上述各种解决方案，包括：

*   按钮或包含按钮的 div 向右浮动；
*   按钮的相对位置；和
*   位置相对+绝对。

由于不同的原因，这些解决方案都不能令人满意。例如，相对定位导致了 z-index 问题，我的下拉菜单出现在内容下方。

所以我最终回到：

```
<style type="text/css">
.group-header { background-color: yellow; width: 100%; }
.group-header td { padding: 8px; }
.group-title { text-align: left; font-weight: bold; }
.group-buttons { text-align: right; }
</style>
<table class="group-header">
<tr>
  <td class="group-title">Title</td>
  <td class="group-buttons"><input type="button" name="Button"></td>
</tr>
</table> 
```

而且效果很好。它很简单，尽可能向后兼容（甚至可能在 IE5 上也可以使用），并且可以正常工作。没有搞乱定位或浮动。

那么任何人都可以在没有桌子的情况下做同样的事情吗？

要求是：

*   **向后兼容：**到FF2和IE6；
*   **合理一致：**跨不同浏览器；
*   **垂直居中：**按钮和标题高度不同；和
*   **灵活：**允许对定位（填充和/或边距）和样式进行合理精确的控制。

顺便说一句，我今天看到了几篇有趣的文章：

*   [为什么 CSS 不应该用于布局](http://www.flownet.com/ron/css-rant.html)；和
*   [表格 vs CSS：CSS 巨魔开始了](http://iamelgringo.blogspot.com/2009/02/tables-vs-css-css-trolls-begone.html)

**编辑：**让我详细说明浮动问题。这类作品：

```
<html>
  <head>
    <title>Layout</title>
    <style type="text/css">
      .group-header, .group-content { width: 500px; margin: 0 auto; }
      .group-header { border: 1px solid red; background: yellow; overflow: hidden; }
      .group-content { border: 1px solid black; background: #DDD; }
      .group-title { float: left; padding: 8px; }
      .group-buttons { float: right; padding: 8px; }
    </style>
  </head>
  <body>
    <div class="group-header">
      <div class="group-title">This is my title</div>
      <div class="group-buttons"><input type="button" value="Collapse"></div>
    </div>
    <div class="group-content">
      <p>And it works perfectly. It's simple, as backward compatibile as it gets (that'll work probably even on IE5) and it just works. No messing about with positioning or floats.</p>
      <p>So can anyone do the equivalent without tables that is backwards compatible to at least FF2 and IE6?</p>
      <p>On a side note, I came across a couple of interesting articles today:</p>
    </div>
  </body>
</html> 
```

感谢[Ant P](https://stackoverflow.com/users/42092/ant-p)的`overflow: hidden`部分（尽管仍然不明白为什么）。这就是问题所在。假设我希望标题和按钮垂直居中。这是有问题的，因为元素的高度不同。将此与以下内容进行比较：

```
<html>
  <head>
    <title>Layout</title>
    <style type="text/css">
      .group-header, .group-content { width: 500px; margin: 0 auto; }
      .group-header { border: 1px solid red; background: yellow; overflow: hidden; }
      .group-content { border: 1px solid black; background: #DDD; }
      .group-header td { vertical-align: middle; }
      .group-title { padding: 8px; }
      .group-buttons { text-align: right; }
    </style>
  </head>
  <body>
    <table class="group-header">
    <tr>
      <td class="group-title">This is my title</td>
      <td class="group-buttons"><input type="button" value="Collapse"></td>
    </tr>
    </table>
    <div class="group-content">
      <p>And it works perfectly. It's simple, as backward compatibile as it gets (that'll work probably even on IE5) and it just works. No messing about with positioning or floats.</p>
      <p>So can anyone do the equivalent without tables that is backwards compatible to at least FF2 and IE6?</p>
      <p>On a side note, I came across a couple of interesting articles today:</p>
    </div>
  </body>
</html> 
```

效果很好。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-07T02:11:11.917

使用可用的工具快速正确地完成工作并没有错。

在这种情况下，一张桌子工作得很好。

我个人会为此使用一张桌子。

我认为应该避免嵌套表，事情会变得一团糟。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-07T01:50:05.003

只需左右浮动并设置为清除两者，你就完成了。不需要桌子。

**编辑：**我知道我为此得到了很多支持，我相信我是对的。但在某些情况下，您只需要有表。你可以尝试用 CSS 做所有事情，它可以在现代浏览器中工作，但如果你想支持旧的......不要重复我自己，这里是[相关的堆栈溢出线程](https://stackoverflow.com/questions/1251218/css-clearfix-problem-with-firefox-2-and-seamonkey)和[我的博客上的咆哮](http://www.backwardcompatible.net/83-css-is-awesome-after-spending-endless-hours)。

**Edit2：**由于旧的浏览器不再那么有趣，我正在使用 Twitter 引导程序进行新项目。它非常适合大多数布局需求并且确实使用 CSS。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-07T01:50:53.690

向左浮动标题，向右浮动按钮，以及（这是我直到最近才知道的部分）- 将它们都制作成容器`{overflow:hidden}`。

无论如何，这应该避免 z-index 问题。如果它不起作用，并且您*确实*需要 IE5 支持，请继续使用该表。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-02-07T06:31:52.343

这是一个棘手的问题：在你开始之前，它看起来非常简单

> 假设我希望标题和按钮垂直居中。

我想郑重声明，是的，在 CSS 中垂直居中是很困难的。当人们在 SO 上发帖时，“你能用 CSS 做 X 吗”，答案几乎总是“是”，他们的抱怨似乎没有道理。在这种情况下，是的，一件特别的事情很难。

有人应该将整个问题编辑为“CSS 中的垂直居中是否有问题？”。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-09T00:27:47.793

在纯 CSS 中，有朝一日一个可行的答案就是使用`"display:table-cell"`. 不幸的是，这不适用于当前的 A 级浏览器，因此如果您只想获得相同的结果，那么您最好使用表格。至少你会确信它在过去足够远。

**老实说，如果更容易的话，就用一张桌子。它不会受伤。**

如果表格元素的语义和可访问性对您来说真的很重要，那么有一个工作草案可以使您的表格变得非语义：

[http://www.w3.org/TR/wai-aria/#presentation](http://www.w3.org/TR/wai-aria/#presentation)

我认为这需要 XHTML 1.1 之外的特殊 DTD，这只会激起整个`text/html`vs`application/xml`辩论，所以我们不要去那里。

**所以，关于你未解决的 CSS 问题......**

垂直对齐两个元素的中心：可以通过几种不同的方式完成，使用一些钝的 CSS 技巧。

如果您可以适应以下约束，那么有一个相对简单的方法：

*   两个元素的高度是固定的。
*   容器的高度是固定的。
*   元素将足够窄而不会重叠（或可以设置为固定宽度）。

然后你可以使用负边距的绝对定位：

```
.group-header { height: 50px; position: relative; }
.group-title, .group-buttons { position: absolute; top: 50%; }
# Assuming the height of .group-title is a known 34px
.group-title { left: 0; margin-top: -17px; }
# Assuming the height of .group-buttons is a known 38px
.group-buttons { right: 0; margin-top: -19px; } 
```

但这在大多数情况下是没有意义的......如果您已经知道元素的高度，那么您可以使用浮动并添加足够的边距以根据需要定位它们。

这是另一种使用文本基线将两列垂直对齐为内联块的方法。这里的缺点是您需要为列设置固定宽度以填充从左边缘开始的宽度。因为我们需要将元素锁定到文本基线，所以我们不能只对第二列使用 float:right。（相反，我们必须使第一列足够宽以将其推过。）

```
<html>
  <head>
    <title>Layout</title>
    <style type="text/css">
      .group-header, .group-content { width: 500px; margin: 0 auto; }
      .group-header { border: 1px solid red; background: yellow; }
      .valign { display: inline-block; vertical-align: middle; }
      .group-content { border: 1px solid black; background: #DDD; }
      .group-title { padding: 8px; width: 384px; }
      .group-buttons { padding: 8px; width: 84px; text-align: right; }
    </style>
    <!--[if lt IE 8]>
    <style type="text/css">
      .valign { display: inline; margin-top: -2px; padding-top: 1px; }
    </style>
    <![endif]-->
  </head>
  <body>
    <div class="group-header">
      <div class="valign">
        <div class="group-title">This is my title.</div>
      </div><!-- avoid whitespace between these! --><div class="valign">
        <div class="group-buttons"><input type="button" value="Collapse"></div>
      </div>
    </div>
    <div class="group-content">
      <p>And it works perfectly, but mind the hacks.</p>
    </div>
  </body>
</html> 
```

**HTML：**我们在每一列周围添加 .valign 包装器。（如果它让你更快乐，就给它们一个更“语义化”的名字。）这些需要保持中间没有空格，否则文本空间会将它们分开。（我知道这很糟糕，但这就是你用标记“纯粹”并将它与表示层分开所得到的......哈！）

**CSS：**我们用于`vertical-align:middle`将块排列到 group-header 元素的文本基线。每个块的不同高度将保持垂直居中并推出其容器的高度。需要计算元素的宽度以适应宽度。在这里，它们是 400 和 100，减去它们的水平填充。

**IE 修复：** Internet Explorer 仅显示本机内联元素的内联块（例如 span，而不是 div）。但是，如果我们给 div hasLayout 然后内联显示它，它的行为就像 inline-block 一样。边距调整是在顶部修复 1px 的间隙（尝试在 .group-title 中添加背景颜色以查看）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-07T02:57:59.437

在这种情况下，我建议不要使用表格，因为那不是表格数据；将按钮放在最右边纯粹是为了展示。这就是我要复制您的表结构的方法（更改为不同的 H# 以适应您在站点层次结构中的位置）：

```
<style>
  .group-header { background: yellow; zoom: 1; padding: 8px; }
  .group-header:after { content: "."; display: block; height: 0; clear: both; visibility: hidden; }
  /* set width appropriately to allow room for button */
  .group-header h3 { float: left; width: 300px; }
  /* set line-height or margins to align with h3 baseline or middle */
  .group-header input { float: right; }
</style>

<div class="group-header">
  <h3>This is my title</h3>
  <input type="button" value="Collapse"/>
</div> 
```

如果您希望在中间真正垂直对齐（即，如果文本换行，则按钮仍然相对于两行文本居中对齐），那么您需要做一个表格或使用`position: absolute`和边距进行处理。您可以添加`position: relative`到您的下拉菜单（或更可能是它的父级），以便将其拉入与按钮相同的排序级别，如果涉及到，您可以使用 z-index 将其置于它们之上。

请注意，您不需要`width: 100%`div，因为它是块级元素，`zoom: 1`并使 div 的行为就像它在 IE 中具有 clearfix 一样（其他浏览器选择实际的 clearfix）。如果您更具体地定位某些东西，您也不需要所有这些无关的类，尽管您可能需要在按钮上使用包装器 div 或 span 以使定位更容易。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-07T01:58:35.780

在 div 中执行双浮点并使用 clearfix。[http://www.webtoolkit.info/css-clearfix.html](http://www.webtoolkit.info/css-clearfix.html) 你有任何填充/边距限制吗？

```
<div class="clearfix">
   <div style="float:left">Title</div>
   <input type="button" value="Button" style="float:right" />
</div> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-07T02:09:35.977

```
<div class="group-header">
    <input type="button" name="Button" value="Button" style="float:right" />
    <span>Title</span>
</div> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-10-23T21:18:19.430

我同意实际上应该只将表格用于表格数据，原因很简单，表格在完成加载之前不会显示（无论速度有多快；CSS 方法更慢）。但是，我确实觉得这是最简单、最优雅的解决方案：

```
<html>
    <head>
        <title>stack header</title>
        <style type="text/css">
            #stackheader {
                background-color: #666;
                color: #FFF;
                width: 410px;
                height: 50px;
            }
            #title {
                color: #FFF;
                float: left;
                padding: 15px 0 0 15px;
            }
            #button {
                color: #FFF;
                float: right;
                padding: 15px 15px 0 0;
            }
        </style>
    </head>

    <body>
        <div id="stackheader">
        <div id="title">Title</div>
        <div id="button">Button</div>
        </div>
    </body>
</html> 
```

按钮功能和任何额外的细节都可以通过这个基本形式来设计。为不好的标签道歉。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-10-11T19:53:41.137

我选择使用 Flexbox，因为它让事情变得简单多了。

你基本上需要去你想要对齐和添加的孩子的父母`display:box`（当然是前缀）。要让它们坐在侧面，请使用[justify-content](http://css-tricks.com/almanac/properties/j/justify-content/)。当您有需要对齐到末尾的元素时，间隔是正确的，就像在这种情况下（见链接）......

然后是垂直对齐问题。因为我做了两个元素的父元素，所以要对齐一个 Flexbox。现在很容易使用`align-items: center`。

然后我添加了您之前想要的样式，从标题中的标题和按钮中删除了浮动并添加了一个填充：

```
.group-header, .group-content {
    width: 500px;
    margin: 0 auto;
}
.group-header{
    border: 1px solid red;
    background: yellow;
    overflow: hidden;
    display: -webkit-box;
    display: -moz-box;
    display: box;
    display: -webkit-flex;
    display: -moz-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-justify-content: space-between;
    -moz-justify-content: space-between;
    -ms-justify-content: space-between;
    -o-justify-content: space-between;
    justify-content: space-between;
    webkit-align-items: center;
    -moz-align-items: center;
    -ms-align-items: center;
    -o-align-items: center;
    align-items: center;
    padding: 8px 0;
}
.group-content{
    border: 1px solid black;
    background: #DDD;
}
.group-title {
    padding-left: 8px;
}
.group-buttons {
    padding-right: 8px
} 
```

**[看演示](http://codepen.io/anon/pen/HyhLg)**

# c++ - 基于运行时创建变量/向量

> ID：522931
> 
> 赞同：0
> 
> 时间：2009-02-07T01:45:04.763
> 
> 标签：c++

我正在开发一个基于提供的书本文件“编码”文件的程序。生成的文件将每个字母替换为一个数字。这个数字对应于书籍文件中出现的字母的偏移量。因此，如果我们有“hello”，它将从 bookfile 中选择一个“h”，找到它的位置编号并在输出中替换它。

我的工作正常，但我正在寻找一种优化它的方法。截至目前，每次它引入一个新字母时，它都会创建一个偏移数字向量以供选择。如果我再次找到相同的数字，我希望能够“保存”这个向量并再次使用它。

但是，我不知道如何对此进行编程。例如，如果我读到一个“h”，我想将它保存为`vector<int> hLocations`；

有没有这样做，或者我只是疯了？我正在考虑制作一个这样做的功能，但让我感到困惑的部分是`<int>Locations`；有没有办法在 C++ 代码中使用变量？我想这就是我真正要问的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T01:50:58.323

您可以使用`std::map<unsigned int, std::vector<unsigned int> >`, 以便感兴趣的字符是偏移向量的关键。这样，您不必为文件中的每个可能字符编写 N 个不同的向量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T21:33:18.223

这个问题很老了，但我问的是真的“C++ 有变量名吗？”

PHP有这个...

```
$foo = 'bar';
$bar = 'foobar';
echo $$foo;    //This outputs foobar 
```

我在 C++ 中寻找类似的东西。

# architecture - 存储徽章标准的最佳方式？

> ID：522943
> 
> 赞同：34
> 
> 时间：2009-02-07T01:53:37.350
> 
> 标签：architecture, badge

我一直在考虑如何在新网站上实现类似于 SO 的徽章功能。存储徽章标准的最佳方式是什么？

两个想法：

*   所有代码
*   “第二个系统” - 创建用于定义徽章及其标准的元架构。在数据库中存储一些信息并让代码查询它以找出徽章及其标准。

有没有更好的方法？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-07T02:01:32.140

规则。

您在系统中创建事件，并在事件流处理器中使用规则。

具体来说，假设您有一个“发了 10 个帖子”的徽章。您不会为每个帖子运行“从 user = :user 的帖子中选择计数（*）”。相反，您有一个简单的规则来监视每个帖子，并“计算它们”，将规则状态存储在用户配置文件中。

这样，“发 10 个帖子”就和“发 1,000,000 个”帖子一样便宜。

这也使系统更具可扩展性。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-07T02:08:52.920

我同意威尔的观点。

在页面上创建“事件”，以便每次发生事件时，即。用户删除帖子，它将使用事件查询事件模块，比如说，EVENT_USER_DELETE_POST，然后您可以选择该事件并基于它构建查询。然后，您可以决定是否授予徽章。

这将使两个逻辑保持分离并保持模块化设计。这种方式应该很容易实现。

唯一的缺点是，如果事件没有被“捕获”，那么用户很可能已经获得了徽章标准，但尚未获得奖励。但是，这绝不应该发生。我能想到的唯一情况是手动操作数据库。

# database - 将图像存储在数据库中的最佳格式是什么？

> ID：522957
> 
> 赞同：11
> 
> 时间：2009-02-07T02:05:33.457
> 
> 标签：database, image, binary, format, base64

将图像存储在数据库中的最佳格式是什么，例如二进制、base64 等，以获得最佳速度/大小。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-07T02:18:58.750

Microsoft 对 SQL Server 的建议曾经是，出于速度和大小的考虑，将图像存储在文件系统中，并在数据库中提供链接。我认为他们已经稍微缓和了他们的偏好，但我仍然认为它肯定是一个更好的主意，因为它不会占用数据库中的空间。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-07T03:07:35.033

Blob 是您问题的答案。

您可以将图像存储在硬盘中并将文件名存储在数据库中，而不是将图像直接存储到数据库中。我认为这种方式是合适的。性能方面这很好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-07T02:10:06.647

二进制。

除此之外，您是否选择 PNG、GIF、JPEG、TIFF 等取决于图像的用途（质量、压缩等）。

用例将（应该）驱动格式而不是数据库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T02:10:16.740

大多数数据库可以以某种方式存储二进制数据：

*   MySQL: [BLOB](http://dev.mysql.com/doc/refman/5.0/en/blob.html) ;
*   甲骨文：[BLOB](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:1019631214472)；
*   SQL Server：[二进制、varbinary 和图像](http://msdn.microsoft.com/en-us/library/aa258271(SQL.80).aspx)。

至于图像文件格式，这是一个单独的问题。不确定你是否暗示了这个问题。如果您是，那么 PNG、GIF 和 JPG 之间通常无关紧要，除了 JPG 是一种有损格式（其他两种格式是 lsosless），这对于照片等来说是可以的，但对于图标或文本来说就不行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-07T02:55:51.203

Blob 不在乎你用什么样的图像填充它们，所以实际上，正确的选择可能是在使用之前需要最少的后期选择处理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-13T20:22:50.233

使用hdf5。

与 XML 文档类似，HDF 文件是自描述的，允许用户指定复杂的数据关系和依赖关系。与 XML 文档相比，HDF 文件可以包含二进制数据（以多种表示形式）并允许直接访问文件的某些部分，而无需先解析整个内容。

![为什么是hdf5？](https://i.stack.imgur.com/vZPAS.jpg)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-07T02:18:20.047

这很大程度上取决于图像的用途。

*   头像只能压缩 JPEGS
*   将通过图像处理软件处理的图像将是 TIFF
*   照片网站上的图像将是 JPEG 供查看，TIFF 供下载。

我们只需要更多信息。如果文件非常大，请将它们存储在数据库中带有链接的目录中。

# c# - C# 正则表达式 - 匹配整个单词？

> ID：522960
> 
> 赞同：2
> 
> 时间：2009-02-07T02:07:02.863
> 
> 标签：c#, regex

我正在编写一个程序，该程序需要在 LARGE 文本文档中搜索大量单词。这些词都是文件名，其中带有下划线（例如，this_file_name）。我知道如何打开和遍历文本文档，但我很好奇是否应该使用 Regex 来搜索这些名称，如果是，应该使用哪种 reg。前任。我应该使用序列吗？我试过了

```
正则表达式 r = new Regex("?this\_file\_name");

```

但我每次都得到一个无效的参数错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T02:16:42.903

查看源文本的示例会很有帮助。但也许这有帮助

```
var doc = @"asdfsdafjkj;lkjsadf asddf jsadf asdfj;lksdajf
sdafjkl;sjdfaas  sadfj;lksadf sadf jsdaf jf sda sdaf asdf sad
jasfd sdf sadf sadf sdajlk;asdf
this_file_name asdfsadf asdf asdf asdf 
asdf sadf asdfj asdf sdaf sadfsadf
sadf asdf this_file_name asdf asdf ";

var reg = new Regex("this_file_name", RegexOptions.IgnoreCase | RegexOptions.Multiline);
var matches = reg.Matches(doc); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T03:29:32.557

也许通过首先拆分空格或非单词字符将您的文档分解为标记？

之后，我认为可能对您有用的正则表达式看起来像这样：

`Regex r = new Regex(@"([\w_]+)");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T03:26:34.277

如果我正确理解您的问题，我认为正则表达式是错误的工作工具。我假设您的文件名用某种分隔符（如逗号或换行符）分隔。

如果是这种情况，请使用`String.Split`将所有文件名放入一个数组中，按字母顺序对数组进行排序，然后针对您提到的“集合”中的每个项目对排序后的数组执行二进制搜索。我很确定这是执行任务的计算效率最高的方法。

当您说“大”文本文件时，请考虑它们相对于运行该程序的机器的大小。1 MB 的文本文件可能看起来很大，但它很容易放入具有 2 GB RAM 的机器的内存中。如果该文件与您的客户端计算机的内存相比要大得多，请一次读取该文件。这称为缓冲。

# authentication - 忘记密码：实现忘记密码功能的最佳方法是什么？

> ID：522967
> 
> 赞同：53
> 
> 时间：2009-02-07T02:10:38.720
> 
> 标签：authentication, passwords, forgot-password, change-password

我想知道在网站上创建忘记密码功能的最佳方法是什么。我已经看到了很多，这里有一些或组合：

*   密码短语问题/答案（1 个或多个）
*   使用新密码发送电子邮件
*   在屏幕上输入新密码
*   通过电子邮件确认：必须单击链接以获取新密码
*   要求用户输入新密码的页面

您会为忘记密码功能添加哪些组合或附加步骤？我想知道他们如何请求新密码以及他们最终如何获得它。

我操作的主体是无法找回密码；必须提供/生成新密码。

**编辑**我喜欢科里所说的不显示用户名是否存在，但我想知道要显示什么。我在想问题的一半是用户忘记了他们使用的电子邮件地址，显示某种“不存在”消息很有用。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-02-07T02:15:52.813

1.  我个人会发送一封电子邮件，其中包含一个短期页面的链接，可以让他们设置新密码。使页面名称成为某种 UID。
2.  如果这对您没有吸引力，那么向他们发送一个新密码并强制他们在首次访问时更改它也可以。

选项1要容易得多。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-07T04:44:16.523

几个重要的安全问题：

*   密码短语问题/答案实际上会降低安全性，因为它通常会成为流程中最薄弱的环节。猜测某人的答案通常比密码更容易——尤其是在没有仔细选择问题的情况下。
*   假设电子邮件在您的系统中作为用户名运行（出于各种原因，通常建议这样做），对密码重置请求的响应不应表明是否找到了有效帐户。它应该简单地说明密码请求电子邮件已发送到提供的地址。为什么？指示电子邮件存在/不存在的响应允许黑客通过提交多个密码请求（通常通过诸如 burp 套件之类的 HTTP 代理）并注意是否找到电子邮件来获取用户帐户列表。为了防止登录收集，您必须确保没有登录/身份验证相关功能提供任何指示何时在登录/密码重置表单上输入了有效用户的电子邮件。

有关更多背景信息，请[查看 Web 应用程序黑客手册](https://rads.stackoverflow.com/amzn/click/com/0470170778)。这是一本关于创建安全身份验证模型的优秀读物。

**编辑**：关于您编辑中的问题 - 我建议：

> “密码请求电子邮件已发送到您提供的地址。如果电子邮件没有很快到达，请检查您的垃圾邮件文件夹。如果没有电子邮件到达，那么您提供的电子邮件不存在帐户。”

这里需要在易用性和安全性之间进行权衡。您必须根据上下文来平衡这一点 - 安全性对您和您的用户来说是否足够重要以证明这种不便是合理的？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-07T02:15:38.150

使用新密码发送电子邮件。

当他们到达并输入新密码时，强制更改密码。

这确保了想要密码的人将是唯一进入该帐户的人。

如果电子邮件被嗅探，有人可以进入该帐户（当然），但真正的一方会立即发现这一点（因为您刚刚发送给他们的密码不起作用）。

还向用户发送密码更改确认。

如果有人收到新密码，然后收到一封电子邮件说“感谢更改密码”，他们会很困惑，如果他们没有这样做，他们会与管理员交谈。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-07T02:25:21.890

使用电子邮件验证/密码重置链接将为您提供更好的安全性。如果您环顾四周，这就是大多数网站的做法，而且人们已经习惯了这种验证，所以我建议使用这种类型的身份验证。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-31T18:43:28.040

我认为（gbrandt 的）选项 2 将是一个很好的方法，如果它与您已经为用户拥有的一些个人信息相结合。即出生日期。

当用户通过输入他的电子邮件地址请求新密码（重置）时，他还必须在密码重置之前输入正确的出生日期（或其他内容）并将新密码通过电子邮件发送给用户。

只有熟悉他的人才可能会通过重置他的密码来惹恼他！它不能是陌生人或机器人

在 5 或 7 个错误的电子邮件地址和出生日期组合时，用户会收到电子邮件，要求重置其密码，但由于凭据不正确而失败。然后该帐户的密码重置将暂停 24 小时或任何所需的时间。

（如果有太多用户就这封电子邮件联系网络管理员，他会知道有人正试图从您的网站/应用程序恶意获取信息）

你们有什么感想？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-07T02:24:46.400

选项 1.**不是**一个好主意，因为通常他很容易被其他人猜到。Sarah Palin 的个人电子邮件（我认为是雅虎）被第三方以这种方式入侵。

其他选项更好，以前的帖子已经概述了细节。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-01-19T15:05:53.893

**我正在考虑的想法是对发送给用户的链接中的数据进行签名。然后，当用户单击链接并且服务器接收到调用时，服务器也会获取加密部分并可以验证数据未被触及。**

我已经为这个用例实现了一个 JAVA 项目。它在 GitHub 上，开源。它完美地回答了您的问题……用 Java 实现。

至于**电子邮件中的链接**- 它会生成链接，并在使用时对其进行验证。

对所有事情都有解释（如果缺少某些东西 - 让我知道......）

看看：[https ://github.com/OhadR/Authentication-Flows](https://github.com/OhadR/Authentication-Flows)

在此处查看[演示](http://auth-flows-demo.appspot.com/)。

这是使用 auth-flows 的客户端 web 应用程序，带有所有解释的 README。它指导您实施：[https ://github.com/OhadR/authentication-flows/tree/master/authentication-flows](https://github.com/OhadR/authentication-flows/tree/master/authentication-flows)

# arrays - AWK 如何进行数组运算？

> ID：522974
> 
> 赞同：0
> 
> 时间：2009-02-07T02:15:21.410
> 
> 标签：arrays, awk, math

我想从 Excel 转移到 Awk。我需要数组的基本数学运算，例如加法和除法。

例如，数组 A 和 B 分别是 [1, 3, 2] 和 [2, 1, 2]。如何从 A 和 B 之间的乘法中得到数组 [2, 3, 4]？A和B之间的加法和除法呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T02:25:37.443

我认为 awk 不适用于这种数字工作。它更多地用于文本处理。awk 中的数组是关联的并且被稀疏占用（在其索引之间可能有“洞”）。您使用字符串来索引它们：

```
for(int j=0; j<length(A) && j<length(B); j++)
    C[j] = A[j] * B[j] 
```

这就像一个哈希映射。所以，在 awk 你可以做

```
A[100] = 10;
A[1] = 2; 
```

[并且只有 2 个元素存储在该数组中（不存在从 2 到 99的](http://www.gnu.org/software/gawk/manual/gawk.html#Arrays)元素），由通过转换数字 100 和 1 创建的字符串索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T02:26:08.847

在`awk`“数组”中是关联的。也就是说，它们不是由连续的数字串而是由任意输入值索引的哈希值。所以你可以做类似的事情

```
for (i=0; i<3; i++){
   c[i] = a[i] * b[i];
}; 
```

如果您知道数字索引元素存在，或者您可以执行以下操作：

```
d["sam"] = a[3] + b["dog"]; 
```

但是阵列处理确实不是`awk`我们的强项，我建议您在批发本课程之前仔细查看所涉及的内容。

`python`使用或另一种相当现代的快速开发语言可能会更好。

顺便说一句——上周我写了我的第一个重要的代码`python`，我完全被迷住了。在偶尔接触`tcl`和之后`perl`，我真的对这些工具的价值一无所知。我想`python`会让我成为一个信徒。

# web-crawler - 如何最好地开发网络爬虫

> ID：522975
> 
> 赞同：3
> 
> 时间：2009-02-07T02:15:36.213
> 
> 标签：web-crawler

我习惯于创建一些爬虫来编译信息，当我来到一个网站时，我需要这些信息，我为该站点启动了一个新的爬虫，大部分时间使用 shell 脚本，有时使用 PHP。

我的做法是`for`对页面列表进行简单的迭代，下载`wget`它和`sed`,或其他实用程序来清理页面并获取我需要的特定信息。`tr``awk`

所有过程都需要一些时间，具体取决于站点以及下载所有页面的更多时间。而且我经常进入一个让一切变得复杂的 AJAX 网站

我想知道是否有更好的方法来做到这一点，更快的方法，甚至是一些应用程序或语言来帮助这样的工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T02:27:17.220

使用正则表达式来解析内容是一个**坏主意**，这里的问题已经无数次讨论过了。

您应该将文档解析为 DOM 树，然后您可以提取任何您想要的超链接、样式表、脚本文件、图像或其他外部链接并相应地遍历它们。

许多脚本语言都有用于获取网页（例如 PHP 的 curl）和解析 HTML（例如 Python 的 Beautiful Soup）的包。走那条路，而不是正则表达式匹配的 hackky 解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-05T03:44:05.647

如果你使用 python，[Scrapy](http://scrapy.org/)非常好用。

# build - TeamCity Twitter 通知程序？

> ID：522996
> 
> 赞同：9
> 
> 时间：2009-02-07T02:27:41.680
> 
> 标签：build, twitter, teamcity, continuous-integration

有没有人构建了一些东西来通过 Twitter 发送您的 TeamCity 构建状态？这可以通过 TeamCity 的 Jabber 支持来完成吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-25T15:45:36.777

我看到了这篇文章，以为我会给你写一个插件。

[这是关于如何做到这一点的博客文章](http://sleepoverrated.com/archive/2009/03/twitter-notifications-with-teamcity/)

这是谷歌代码项目

[teamcity-twitter-notifier](http://code.google.com/p/teamcity-twitter-notifier/)

[![替代文字](https://i.stack.imgur.com/ZejbJ.jpg)](https://i.stack.imgur.com/ZejbJ.jpg)
[（来源：[sleepoverrated.com](https://sleepoverrated.com/wp-content/uploads/2009/03/ttn-05.jpg)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T08:47:56.720

我只是在寻找同样的东西。我还没有成功找到任何 Jabber 到 Twitter 的网关。一个原生的 Twitter 通知器会非常整洁:-)

# django - 有没有办法相对于外键自动增加 Django 字段？

> ID：522997
> 
> 赞同：23
> 
> 时间：2009-02-07T02:27:56.173
> 
> 标签：django, django-models, django-admin

我目前正在用 Django 编写一个站点（因为你永远学不会太多框架！），我想知道是否有一种方法可以相对于相关对象自动增加对象。例如，假设我有一个 Entry 模型和一个 EntryVersion 模型：

**条目**
- 标题
- slug

**EntryVersion**
- 条目（外键）
- version_number
- 内容

我想`version_number`相对于条目外键自动递增（这样一个条目可能有多个版本，从一个开始并向上移动一个）。但是，它不会是真正的自动增量，因为它在数据库中不会是唯一的（可能有许多版本号 = 1 的条目版本；对于给定的条目只有一个）。

我知道我可以滚动自己的管理员并在那里处理这个问题，但想知道是否有任何方法可以让 Django 管理员在保存新条目版本时自动将版本号加一。

* * *

**编辑：我使用的特定代码（更正为仅在第一次保存时设置版本号）**

Tiago 的回答是正确的，但是为了将来有类似困境的 StackOverflow 用户的利益，这里是我使用的具体代码：

```
def save(self, force_insert=False, force_update=False):
    # Only modify number if creating for the first time (is default 0)
    if self.version_number == 0:
        # Grab the highest current index (if it exists)
        try:
            recent = EntryVersion.objects.filter(entry__exact=self.entry).order_by('-version_number')[0]
            self.version_number = recent.version_number + 1
        except IndexError:
            self.version_number = 1
    # Call the "real" save() method
    super(EntryVersion, self).save(force_insert, force_update) 
```

`order_by`w/ index 技巧是我从这里的 Django 文档中收集到的一个技巧：

[http://docs.djangoproject.com/en/dev/topics/db/queries/#id4](http://docs.djangoproject.com/en/dev/topics/db/queries/#id4)

请注意，您必须在您的字段上进行`default=0`定义才能使其正常工作。`version_number`

可能有更好的方法，但这似乎正是我需要的方式；希望其他人也会发现它很有用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-07T10:04:00.077

你可以这样做：

```
def save(self, force_insert=False, force_update=False):
    #if self.id is None:
    self.version_number += 1

    super(EntryVersion, self).save(force_insert, force_update) # Call the "real" save() method. 
```

直接来自这里：

[http://docs.djangoproject.com/en/dev/topics/db/models/#overriding-predefined-model-methods](http://docs.djangoproject.com/en/dev/topics/db/models/#overriding-predefined-model-methods)***