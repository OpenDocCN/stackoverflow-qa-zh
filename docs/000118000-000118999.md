# StackOverflow 问答 000118000-000118999

# estimation - 有人使用功能点吗？

> ID：118023
> 
> 赞同：14
> 
> 时间：2008-09-22T22:31:05.610
> 
> 标签：estimation, function-points

关于功能点的一些问题：

1）这是一种合理精确的估算方法吗？（我这里不是不讲理，只是想知道和其他估算方法相比）

2) 你所付出的努力是否值得你从中得到好处？

3) 您使用哪种类型的功能点？

4）您是否使用任何工具来执行此操作？

**编辑**：我有兴趣听取使用它们或使用过它们的*人的*意见。我已经阅读了估算实践，包括各种技术的优缺点，但我对*实践*中的价值感兴趣。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-01T23:09:52.687

从 2002 年到 2005 年，我是一名 IFPUG 认证功能点专家，我仍然使用它们来评估业务应用程序（基于 Web 和胖客户端）。我的经验主要是小型项目（1000 FP 或更少）。

在使用用例点和代码行之后，我选择了功能点。（我已经积极使用估计技术 10 多年了）。

> 关于功能点的一些问题：
> 
> 1）这是一种合理精确的估算方法吗？（我这里不是不讲理，只是想知道和其他估算方法相比）

很难快速回答，因为这取决于您在生命周期中的哪个阶段（从眼前一亮到完成）。您还必须意识到，估计不仅仅是精度。

他们最大的优势在于，结合历史数据，他们能够很好地承受来自决策者的压力。通过将项目范围与生产力 (h/FP) 分开，他们会产生更具建设性的对话。（当我是一名网络程序员时，我第一次参与基于指标的估计，不得不说服我公司创始人兼首席执行官的私人朋友回到他的投资者那里，告诉他们他承诺的日期无法实现。我们都知道是这样，但真正说服他的是项目历史和功能规模（当时本土的用例点）。

他们的优势在生命周期的早期是最大的，那时您甚至必须在团队组建之前评估项目的可行性。

与普遍的看法相反，如果您知道自己在做什么，不需要那么长时间就能得出一个有用的计数。根据在初始客户会议中推断的基本信息类型（逻辑文件）和我们团队的平均生产力，我可以得出一个粗略的计数（但不比那个阶段的所有其他未知数更粗略）和一个有用的估计在一个下午。

将功能点分析与促进需求研讨会相结合，您就有了一个很好的项目设置方法。

一旦事情变得严重并且我们已经提名了一个团队，我们就会使用规划扑克和其他一些估算技术来得出一个独立的数字，并将两者进行比较。

> 2) 你所付出的努力是否值得你从中得到好处？

绝对地。除了所有其他好处之外，我发现准备计数是审查用户目标级别要求的一致性和完整性的绝佳方式。甚至在建立敏捷项目时也是如此。我经常发现客户错过的隐含故事。

> 3) 您使用哪种类型的功能点？

IFPUG CPM（计数实践手册）4.2

> 4）您是否使用任何工具来执行此操作？

培训我的人给了我一个 Excel 电子表格模板。您输入文件或事务属性，它会为您完成所有表查找。

作为结束语，没有任何估计值像 bean-counters 所希望的那样精确（或更准确地说，准确），原因在许多其他地方都有很好的记录。因此，您必须以能够适应这种情况的方式运行您的项目（为敏捷欢呼三声）。

但是估计仍然是商业环境中决策支持的重要组成部分，我永远不想没有我的功能点。我怀疑那些将它们描述为“幻想”的人从未见过它们被正确使用（相信我，我看到它们被过度炒作和滥用，可笑）。

不要误会我的意思，FP 有时对他们有一种随意的感觉。但是，套用丘吉尔的话说，功能点是已知的最糟糕的早期生命周期估计技术，除了所有其他技术。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-30T15:04:12.020

Mike Cohn 在他的[Agile Estimating and Planning](https://rads.stackoverflow.com/amzn/click/com/0131479415)中认为 FP 很棒，但很难做到正确。他（显然）建议改用基于故事点的估计。我倾向于同意这一点，因为对于每个新项目，我越来越多地看到敏捷方法的好处。

* * *

*1）这是一种合理精确的估算方法吗？（我这里不是不讲理，只是想知道和其他估算方法相比）*

就估计精度而言，功能点非常好。以我的经验，如果你想正确地做到这一点，它们是伟大的，但在所涉及的努力方面是昂贵的。没有多少项目能够负担得起一个细化阶段来正确地进行基于 FP 的估计。

*2) 你所付出的努力是否值得你从中得到好处？*

FP 很棒，因为它们得到了 ISO 的正式认可，这使您的估计具有很大的可信度。如果你为一个大客户做一个大项目，那么投资于看起来像官方的详细估算可能会很有用。但是，如果一开始的不确定性很大（如其他供应商的集成、遗留系统、松散的要求等），无论如何您都不会接近精确，因此通常您必须接受这一点并稍后重新迭代估计。如果是这种情况，一种更便宜的估算方法（用户故事和故事点）会更好。

*3) 您使用哪种类型的功能点？*

如果我正确理解了您问题的这一部分，我们过去常常根据特征点进行估计，但逐渐远离这些，几乎所有项目都期望那些高度重视内部功能的项目。

*4）您是否使用任何工具来执行此操作？*

Excel 非常适合您可以使用的所有公式。如果您想以协作方式执行此操作，则使用 Google 电子表格而不是 Excel 会有所帮助。

[Sparx](http://www.sparxsystems.com.au/) Enterprise Architect还内置了一个很棒的工具，它允许您根据用例进行估计，该用例也可用于 FP 估计。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-23T21:17:27.497

伟大的 hacknot 现在下线了，但它是书本形式的。他有一篇关于功能点的文章：[http](http://www.scribd.com/doc/459372/hacknot-book-a4) ://www.scribd.com/doc/459372/hacknot-book-a4 ，结论是它们是一个幻想（我同意）。

Joel on Software 有一个合理的替代方案，称为[基于证据的调度](http://www.joelonsoftware.com/items/2007/10/26.html)，至少**听起来**它可能有效......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-05T15:24:29.013

根据我对功能点的研究（我的一位老师高度参与功能点理论的过程），他无法回答我们所有的答案。功能点在很多方面都失败了，因为这不是因为你有你可以正确评估的读或写的东西。您可能会得到 450 个功能点的结果，其中一些功能点需要 1 小时，而一些需要 1 周。这是一个我永远不会再使用的指标。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T00:05:02.063

1.  否，因为任何特定需求都可以根据需求作者的精确度（或不精确度）以及功能点评估者的经验水平进行任意量的工作。
2.  不，因为对抽象功能的不精确推导的管理不会产生可靠的估计。
3.  没有如果我能帮助它。
4.  工具？对于功能点？Excel怎么样？还是字？还是记事本？还是爱德林？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-27T20:02:37.823

要回答您的问题：

1.  是的，它们比我遇到的任何其他东西都更精确（20 多年来）。

2.  是的，他们非常值得付出努力。您可以仅从 FP 计数来估计大小、资源、质量和进度 - 非常有用。手动计算一个 FP 平均需要 1 分钟，完全编写一个 FP 平均需要 8 小时（价值约 800 美元）。考虑一下木匠的“测量两次切割一次”的说法。现在是一个无耻的插件：使用[https://www.ScopeMaster.com](https://www.ScopeMaster.com)，您可以每秒测量 1 FP，而您无需学习如何！

3.  我喜欢 Cosmic Function Points（因为它们用途广泛）和 IFPUG，因为有很多已发布的数据（主要来自 Capers Jones）。

4.  在开发一个从需求中自动计算 FP 的工具上投入了大量时间、精力和金钱后，我再也不用手动完成了！

# accessibility - 网站遵守美国残疾人法案 (ADA)

> ID：118038
> 
> 赞同：10
> 
> 时间：2008-09-22T22:35:30.750
> 
> 标签：accessibility, w3c, standards-compliance, section508, wcag

是否有任何自动、在线或离线工具来测试 xhtml/css 是否符合[美国残疾人法案 (ADA)](http://www.access-board.gov/sec508/guide/1194.22.htm)的屏幕阅读器和其他视觉指南？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-22T22:49:50.870

没有自动化工具可以告诉您网站是否可访问。有一些工具，例如[Rational Policy Tester](http://www-01.ibm.com/software/awdtools/tester/policy/accessibility/)，可以识别潜在的问题区域，但它们只能与对需求有很好理解的人的手动检查结合使用。开始寻找工具的好地方是[WAI](http://www.w3.org/WAI/ER/tools/Overview.html)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-24T15:02:53.300

我同意@Jim 的观点，即可访问性合规性目前不是一门 100% 的客观科学。

以图像替代文本的经典案例为例。假设一个关于美国教育的故事包括一张微笑的西班牙裔女学生（大约 10 岁）的特写照片，她在教室的桌子上用铅笔在一张纸上写字。WCAG1指南说要为[每张](http://www.w3.org/TR/WCAG10-HTML-TECHS/)图片包含一个“文本等价物”。有些人会认为这 `alt="young Hispanic girl at a desk in a classroom"`不会提供足够的含义来同样地传达照片所显示的内容。其他人会争辩说它传达了太多，它只是一个股票艺术填充物，这`alt="girl at desk"`是适当的。其他人会争辩说，这张照片代表了文章中的一个观点，这`alt="Education policies of the past 10 years have affected minority students most."`是最合适的替代文字。

因此，即使是该领域的专家也可能不同意这种简单情况的最佳选择。自动化工具只能检测替代文本是否丢失——而不是它是否提供文本等价物。我们都可以同意，放置`alt="[image]"`不符合提供文本等价物的意图或准则。

有一些在线检查器可以测试其中一些问题。Chris Pederick 的 Firefox Web Developer Extension 提供了针对 WAI 和 508 进行测试的简便方法——就像 IE Developer Toolbar 一样。

# oop - 关于面向对象的问题

> ID：118040
> 
> 赞同：2
> 
> 时间：2008-09-22T22:36:28.610
> 
> 标签：oop

自从我学习面向对象编程以来，我就有了这个问题。现在，我有一个很棒的论坛，我想问这个。

假设我们正在使用 EJB 实现员工管理应用程序。

现在，有两种方法可以做到这一点。

1.  通常，我们创建代表员工的实体 (POJO)。然后我们创建一个 EJB 接口“EmployeeManager”，其中包含 add、delete、update、retrieve、retrieveAll 方法。这样我就可以使用“员工”实体作为数据传输对象。

2.  我们称 EJB 接口本身为“雇员”。实现可以称为“EmployeeImpl”，它具有*字段*以及方法实现（add、delete、update、retrieve、retrieveAll）。如果我使用分层方法，其中我的业务逻辑需要访问员工详细信息，我需要传递“EmployeeImpl”（因为它包含值）。

你认为哪一个是更好的方法？

我更喜欢第一个，因为它“看起来”很好并且不会感到尴尬。喜欢

```
EmployeeMgr empMgr = // JNDI lookup;
Employee emp = new Employee();
empMgr.add(emp);
Employee employees[] = empMgr.retrieveAll(); 
```

第二个看起来像哪里（虽然我不确定），

```
Employee emp = // JNDI lookup;
emp.setName(); //set the properties
emp.add();
Employee employees[] = emp.retrieveAll(); 
```

如您所见，第二个看起来很尴尬。

我请求你们在这方面给我建议。

谢谢馒头

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T22:50:05.270

在你的例子中，我不推荐#2，因为它给了 Employee 类太多的责任。

虽然没有给出直接的答案，但我可以诚挚地推荐 Martin Fowler 的《[企业应用程序架构模式》](http://www.martinfowler.com/books.html#eaa)一书。对我个人来说，这让我大开眼界，并描述了几种不同的方法。

我还认为开源[Hibernate](http://www.hibernate.org/)是持久化实体的绝佳工具。我相信你会在那里找到很多好的输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T22:42:27.393

第一个肯定更清晰，清晰肯定应该是您的代码的目标。但是，就第一个而言，我将在[这里](http://www.codinghorror.com/blog/archives/000553.html)指导您：Jeff Atwood 将事物称为“SomethingManager” - 不推荐。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T19:34:03.000

争取适当的设计，而不是“OO 合规性”。

顺便说一下，EJB 根本不是面向对象的。

使用 EJB 的最佳实践是：

*   DataContainer 类保存您从数据库或用户获得的数据；“POJO”
*   EJB 具有对 DataContainer 进行操作的方法
*   DAO 处理从数据库中持久化/检索数据容器。

EJB 通常没有字段，除非它们被部署为无状态，这很少需要。

如果您正在使用 EJB，那将是大多数人所期望的设计。这显然不是 OO，因为 DataContainer 不包含实际方法，而 EJB/DAO 不包含实际数据。

这不是一件坏事; 它分离了关注点，使您的系统更具可变性和可维护性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T23:00:30.407

为持久化 Employee 设置单独的类看起来更 OO。而且更灵活，因为您可能希望使用 DBEmployeeMrg、FileSystemEmployeeMrg、InMemoryEmployeeMgr 和 MockEmployeeMgr 进行测试——所有这些类都可能以不同的方式实现接口 EmployeeMrg。

为了使您的代码更短，您可能希望员工能够保存自己 - employee.save() 而不是 employeeMrg.save(employee) 我可以理解员工保存自己、更新甚至删除时的设计，但绝对是一名员工不需要通过 id 加载另一个员工并加载员工列表。

# asp.net - 您能否通过 SSL 在单个 ASP.NET 应用程序实例上托管多个租户？

> ID：118042
> 
> 赞同：2
> 
> 时间：2008-09-22T22:36:54.130
> 
> 标签：asp.net, iis, ssl, hosting

我有一个 ASP.NET 应用程序，它将托管多个租户（软件即服务风格）。每个租户都将拥有自己的域名（www.mydomain.com、www.yourdomain.com）和自己的 SSL 证书。

**有没有办法托管应用程序，使所有租户都在同一个应用程序*实例*上？**

*   我知道您可以让多个 IIS 网站指向同一个共享位置，但这不起作用——它不是同一个*实例*。那是同一*应用程序的不同**实例*。
**   我也知道您可以将 SSL 主机标头映射与通配符证书一起使用，但这不起作用，因为所有租户都需要是同一主域的子域 - yourdomain.commondomain.com、mydomain.commondomain.com。为了使解决方案有效，每个人都需要拥有自己的域名，而不是子域。（理想情况下，每个租户也可以选择使用 EV 证书，并且您不能拥有通配符 EV 证书。）*

 ** * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T13:14:58.387

问题是经典 SSL 要求在 Web 浏览器指示它要使用的主机之前提供证书。因此，您只能为每个 IP/端口组合配置一个证书。

TLS 有一个扩展名为[Server Name Indication](http://en.wikipedia.org/wiki/Server_Name_Indication)，它允许浏览器指示它想要与哪个逻辑服务器通信。[从 IIS 8.0 (Windows Server 2012) 开始支持](http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-server-name-indication-sni-ssl-scalability)此功能。

通配符起作用是因为证书*本身*表明它对该域下的所有服务器都有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T23:32:57.273

您仅限于 IIS - 或者也可以选择软/硬代理或内容切换硬件？

认为您可以在代理或内容切换处终止 SSL - 然后将请求转换为您自己的内部 url。

例如 foo.com/x 和 bar.com/y 在引擎盖下分别被翻译成 myapp/x 和 myapp/y - 在请求标头中传递原始主机名。

# javascript - 您可以在没有任何 UI 元素的情况下将 Silverlight 与 AJAX 一起使用吗？

> ID：118043
> 
> 赞同：3
> 
> 时间：2008-09-22T22:37:16.080
> 
> 标签：javascript, ajax, silverlight

我知道您可以只使用 CSS 来隐藏 DIV 或 Silverlight 插件，但是有没有办法使用根本不显示任何 UI 元素的 JavaScript 来实例化 Silverlight 组件/应用程序？

Silverlight 中有很多很棒的功能，比如多线程和编译代码，它们可以被传统的 Ajax 应用程序使用，而根本不需要使用 Silverlight 的 XAML/UI 层。

我只想对我的 UI 层使用标准的 HTML/CSS，并在后台使用一些已编译的 .NET/Silverlight 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T23:45:46.523

是的，你可以，而且你提出的一些理由是完全有道理的。几周前，我在 CodeCampNZ 就 HTML 桥进行了一次演讲，并在我的博客上[收集了很多资源。](http://jonas.follesoe.no/2008/09/01/unit-testing-presentation-model-and-the-html-bridge-at-codecamp-nz/)

我还建议查看[Wilco Bauwers 博客，了解](http://www.wilcob.com/Wilco/Silverlight/silverlight-interoperability.aspx)有关 HTML 桥的大量详细信息。

非可视 Silverlight 的其他一些场景：

*   用托管语言（C#、Ruby、JScript.NET 等）而不是原生（解释型）JavaScript 编写新代码。
*   使用 OpenFileDialog 在客户端读取文件，无需往返服务器。
*   将临时数据安全地存储在客户端上的隔离存储中。
*   通过 BackgroundWorker 或使用普通线程在后台执行工作，从而提高响应能力和性能。
*   通过网络 API 访问跨域数据。
*   通过套接字从服务器检索实时数据。
*   通过重用 WPF 的数据绑定引擎来绑定数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T22:40:21.783

是的。[我认为这在与其他动态语言](http://www.codeplex.com/sdlsdk)混合时特别有趣——但是，我可能有偏见。:)

**编辑：**但是您需要使用作为 Silverlight 动态语言 SDK 一部分的托管 Javascript，而不是作为浏览器一部分的普通 Javascript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T23:26:03.310

Curt，使用托管 JavaScript 仍然需要您在页面上显示一些 Silverlight/XAML 显示层，对吗？有没有办法完全摆脱任何 Silverlight/UI 元素的显示？

# c# - C# 网格绑定不更新

> ID：118051
> 
> 赞同：2
> 
> 时间：2008-09-22T22:40:20.910
> 
> 标签：c#, data-binding, datagridview

我有一个绑定到集合的网格。由于某种我不知道的原因，现在当我在网格中执行某些操作时，网格不会更新。

情况：当我单击网格中的按钮时，它会增加同一行中的值。当我单击时，我可以调试并查看值增量，但网格中的值不会改变。**但是**当我单击按钮，最小化并恢复窗口时，值会更新......我必须做什么才能像以前一样更新值？

**更新** 这没有解决，但我在这里接受了最好的答案。

它没有解决，因为当数据来自数据库而不是来自缓存时，它照常工作。对象被序列化并在事件丢失的过程中被抛出。这就是为什么我重新构建它们并且它适用于我所知道的，因为我可以与它们交互但似乎由于未知原因它不适用于更新网格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T00:35:37.573

为了使绑定是双向的，从控件到数据源以及从数据源到控制数据源必须以两种可能的方式之一实现属性更改通知事件：

*   实现[INotifyPropertyChanged](https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.inotifypropertychanged)接口，并在属性更改时引发事件：

    ```
    public string Name 
    {
      get
      {
        return this._Name;
      }
      set
      {
        if (value != this._Name)
        {
            this._Name= value;
            NotifyPropertyChanged("Name");
        }
      }
    } 
    ```

*   为每个必须在更改时通知控件的属性实现更改事件。事件名称必须采用*PropertyName* Changed 形式：

    ```
    public event EventHandler NameChanged;

    public string Name 
    {
      get
      {
        return this._Name;
      }
      set
      {
        if (value != this._Name)
        {
            this._Name= value;
            if (NameChanged != null) NameChanged(this, EventArgs.Empty);
        }
      }
    } 
    ```

    *请注意，您的属性值在窗口最大化后是正确的，因为控件会重新读取数据源中的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T22:59:17.493

听起来您需要在更新代码中调用 DataBind 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T23:08:17.580

我在我的集​​合和我的网格之间使用 BindingSource 对象。通常我不需要打电话。

# sql - 有没有人有一个用于创建 SQL Where 子句的用户界面示例？

> ID：118054
> 
> 赞同：5
> 
> 时间：2008-09-22T22:41:03.043
> 
> 标签：sql, user-interface

我在尝试将嵌套条件映射到直观界面时遇到问题。

例如。您将如何表示 ((Condition1 AND Condition2) OR (Condition1 AND Condition5)) AND Condition4

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T00:14:29.980

这是我几年前为 linux 应用程序制作的原型截图。您可以单击 +/- 图标将行添加到组中，然后单击“添加新...”和“删除最后...”按钮以删除最底部的组。

每组上方是几个菜单按钮，可以选择“AND 匹配的项目...”/“OR 匹配的项目...”（第一组略有不同）和“以下任何一项” /“以下所有”。每一行都是类型感知的，因此如果您为变量选择了一个字符串，则条件将是“IS”、“IS NOT”、“BEGINS WITH”等等。对于整数，您将获得“IS”、“GREATER THAN”等，对于日期，您将获得“ON”、“BEFORE”、“ON OR BEFORE”等。

如果您在第一组的第二行和第三行之前看到“或”一词，如果选择了“以下任何一项”，则为“或”，如果选择“以下所有：”则为“和”加强选择并使对话更容易“阅读”。

它不会让你做任何可以想象的查询，但我认为它涵盖了普通用户想要做的大约 90% 的事情，并且以我认为相当可用的方式进行。

[![db查询表单截图](https://i.stack.imgur.com/GcvPR.jpg)](https://i.stack.imgur.com/GcvPR.jpg)
[（来源：[clearlight.com](http://www1.clearlight.com/~oakley/dbquery.jpg)）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T22:56:58.840

有些人会争辩说这很直观。

![逻辑](https://i.stack.imgur.com/UeDGm.gif)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T22:50:54.097

假设 .NET，我将使用 DataGridView 来存储每个条件并在创建时为其分配一个 ID，并有一个允许您输入特定查询条件的文本框。

然后，您可以在编写完所有条件后，允许一次将 2 与 AND 或 OR 组合，然后显示结果查询以进行验证

条件1

条件2

条件3

条件4

条件5

在你的情况下，一旦你将每一个添加到你的数据集并填充 DataGridView，你就会这样做（我想象一个带有 3 个下拉框的表单，顶部的一个和底部的一个允许条件或“化合物”，中间的下拉列表是 AND/或仅：

条件 1 和条件 2 = "复合 1"

条件 1 和条件 5 = "复合 2"

化合物 1 或化合物 2 =“化合物 3”

Compound3 AND Condition4 = "Compound4"

Compound4 是您的最终查询

说得通？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T23:43:38.167

[球棒！](http://www.ritlabs.com/en/)有我个人遇到的最好的界面。（用于邮件分类规则。）

它去：

**源文件夹** 不是 \\Google\Inbox 之一

和

> **主题** 以“新评论”结尾
> 
> 或**主题** 匹配“一些字符串”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T22:50:47.687

Microsoft SQL Server 有一个类似的界面，我在 SQL Server 2000 中使用过它，但我敢打赌它也在 2005 express 中，所以如果你愿意，可以看看。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T23:03:52.943

如果这很重要，需要花费大量时间，我会考虑使用维恩图。可视化将表示结果集而不是查询词。因此，为了演示 AND，您将显示两个代表结果的圆圈，并突出显示它们之间的重叠（交叉点）。

为了演示 OR，您将显示两个圆圈并突出显示两者的结合。

然后要显示整个多部分查询，您可以显示五个圆圈，其中包含联合和交集的某种组合，或者组合每个括号然后隐藏细节，使结果成为一个新的圆圈以与其他元素组合。这里有很多拖放操作，并且为了清晰起见动态调整子条款的大小。

要使这个直观且易于使用需要相当多的工作，但对于某些应用程序来说，这将是一个非常强大的界面。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-12-21T16:02:53.157

查看 EasyQuery 的任何现场演示：

[http://devtools.korzh.com/easyquery/livedemos/](http://devtools.korzh.com/easyquery/livedemos/)

它是商业软件，但“条件”部分允许您添加单个条件或条件组，这消除了具有多个 AND 和/或 OR 的子句的许多复杂性。它做得很好并且易于使用。

（我不隶属于 EasyQuery，只是对他们的查询生成器印象深刻。）

[![易查询截图](https://i.stack.imgur.com/EJtDd.png)](https://i.stack.imgur.com/EJtDd.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T22:45:55.717

我见过的最好的界面是一个自制的控件，它画了一个树来清楚地显示操作的顺序。我从未见过这样做的第三方控件，但我也没有寻找过。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T22:52:00.600

您可以检查 MS Access 是如何做到的。我不会称之为直观，但它很简单。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-02T03:19:03.057

它是特定于它的领域的，但是[f-spot](http://f-spot.org)有一个很好的方法来做到这一点。它是照片管理软件，如果您单击其中一个标签以按标签查找图片，它会在搜索结果的顶部显示一个栏。然后，您可以将标签拖放到该条上，然后右键单击以选择否定，并且可以在条中拖动标签以将其分组到 and 和 or 子句中。我不确定它对于大量标签（或非枚举条件）的扩展性如何，但它很容易弄清楚并且交互性很好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T23:12:10.740

我曾经在一个系统上工作，我们将类似于下面的布尔逻辑对齐。

右列 (Inner) 和 (Outer) 提供两个逻辑级别。

```
可变内外
条件 1 和
条件 2 或
条件 1 和
条件 5 和
条件4               

或者更优化...

条件 4 和
条件 1 和       
条件 2 或
条件5

```

# user-interface - 您如何设计网站以充分利用广告？

> ID：118062
> 
> 赞同：1
> 
> 时间：2008-09-22T22:43:57.937
> 
> 标签：user-interface

有谁知道从网络广告中增加广告收入的一般 UI 设计指南？显然，许多 SO 用户使用 adblock，并且可能觉得这类问题应受谴责，但我相信可以将广告（和其他收入流）整合到网站中，以使它们具有视觉吸引力、目标性和功能性。然而，这只是一种信念；）。

鉴于广告作为一种收入手段被广泛使用，这似乎是一个活跃的研究领域。

我相信任何旨在产生收入的网页设计都应该考虑到这一点，因为网页设计师（阅读：SO 用户群的相当大一部分）应该试图在他们的时间/技能上获得最大的回报。

（这个问题是一个转贴，因为SO 上*没有*办法* 对“封闭式问题”提出质疑，而且只需要一个有足够代表的人就可以决定他们不喜欢它。）

**编辑：**万一有人去看，我删除了最初的问题（已关闭），因为污染搜索结果没有意义。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-22T22:46:46.447

事实上，[创建这个网站的人之一](https://stackoverflow.com/users/1)在他的[博客上发了一篇](http://www.codinghorror.com/)[关于这个](http://www.codinghorror.com/blog/archives/000893.html)的帖子

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T17:24:17.057

您可能有兴趣[了解 Google](https://www.google.com/adsense/support/bin/answer.py?hl=en&answer=17954)对广告展示位置的看法。

# project-management - 管理大型项目的用户故事

> ID：118064
> 
> 赞同：13
> 
> 时间：2008-09-22T22:45:41.317
> 
> 标签：project-management, agile, scrum, user-stories

我们刚刚开始一个包含许多子项目的非常大的项目。我们目前不使用任何类型的命名流程，但我希望通过后门获得某种敏捷/类似 scrum 的流程。

我将最关注的领域是整个项目的积压工作，至少在我的脑海中，迭代的想法是从积压工作中提取一些东西，更详细地研究并开发到合理的截止日期.

我想知道人们使用什么技术将项目分解为待办事项，以及一旦创建了待办事项，它是如何维护和排序的。以及如何维护元素之间的关系（即必须在可以这样做之前完成，或者这是一个故事现在是五个故事）

我不确定我期望这个问题的答案是什么样的。我认为最有帮助的是，如果有一个开源项目以某种方式保持其积压在线，以便我可以看到其他人是如何做到的。

其他可以从我那里得到+1的东西是来自真实项目的真实用户故事的例子（“用户可以登录”的故事并不能帮助我描绘我的项目中的事物。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-23T11:07:13.127

我建议您在采用工具之前仔细考虑，特别是因为听起来您的过程一开始可能会在您找到自己的脚时变得流畅。我的感觉是，在这个阶段，一个工具可能更可能约束你而不是赋予你，你会发现它无法替代[物理空间中的一个好的卡片墙](http://www.infoq.com/articles/agile-kanban-boards)。我建议你把精力集中在手头的任务上，当你觉得你真的需要一个工具时，就去拿一个工具。到那个阶段，您将更有可能清楚地了解您的要求。

我现在已经运行了几个敏捷项目，我们从来不需要比电子表格更复杂的工具，而且在一个预算超过一百万英镑的项目上。大多数情况下，我们发现白板和索引卡（每个用户故事一张）就足够了。

在确定您的故事时，请确保您始终以对用户有意义的方式来表达它们 - 一些（也许只是很小的）表面功能。永远不要让自己陷入无法向用户展示的有关技术细节的故事。

安排故事的技巧是首先尝试优先考虑您最不了解的事情（计划您想学习的内容，而不是您想做的事情），同时从允许您开发核心功能的故事开始您的应用程序，使用后续故事将功能（和技术复杂性）包装在它们周围。

如果您有信心可以将其中的一部分留到以后，请不要费力地了解其中的细节 - 只需写一张故事卡，代表您稍后需要进行的重要对话，然后得到继续更重要的事情。如果您需要了解即将发生的事情的规模，请查看称为[计划扑克](http://www.planningpoker.com/)的宽带德尔福估计技术。

Mike Cohn 的书籍，尤其是[敏捷估算和规划，](https://rads.stackoverflow.com/amzn/click/com/0131479415)将在这个阶段为您提供很多帮助，并为您提供一些有用的技术。

祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T02:01:27.680

与 DanielHonig 一样，我们也使用 RallyDev（小规模），听起来它可能是一个有用的系统，至少可以让您进行调查。

此外，一本关于用户故事开发方法的好书是Mike Cohn的《[用户故事应用》。](https://rads.stackoverflow.com/amzn/click/com/0321205685)如果你还没有，我当然会推荐阅读它。它应该回答你的很多问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T23:40:34.727

我不确定这是否是您正在寻找的，但它可能仍然有帮助。来自codequeeze 的Max Pool 有一段视频解释了他的“敏捷墙”。看到他的过程很酷，即使它可能不一定与您的问题有关：

[我的敏捷墙（加上一些技巧）](http://www.codesqueeze.com/my-agile-wall-plus-a-few-tricks/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T01:05:55.537

所以这里有一些提示： 我们使用 RallyDev。
我们创建了我们的需求所在的包的视图。大型故事被标记为史诗，并被放入它们所针对的版本的发布积压中。儿童故事被添加到史诗中。我们发现最好保持故事的细化。粗粒度的故事使真实地估计和执行故事变得困难。

所以总的来说：

1.  按发布组织

2.  将迭代保持在 2-4 周之间

3.  产品负责人和项目经理将故事添加到发布待办事项中

4.  开发团队根据 T 恤尺寸、分数等来估算故事……
5.  在春季计划会议中，开发团队从发布积压中选择迭代工作。

这是我们过去 4 个月一直在做的事情，并且发现它运作良好。保持故事的大小和粒度非常重要。

记住评估用户故事的 Invest 和 Smart 首字母缩略词，一个好的故事应该是： I - 独立 N - 可协商 V - 有价值 E - 可估计 S - 小 T - 可测试

聪明的：

S - 具体 M - 可测量 A - 可实现 R - 相关 T - 时间盒

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T01:47:17.713

我会首先说保持简单.. 使用带有跟踪（和备份）的共享电子表格。如果您发现扩展或同步问题使得将积压工作保持在一致状态变得越来越耗时，请进行交易。这将自动验证支出/再培训成本并证明其合理性。

我[从 Thoughtworks 读到了一些关于 Mingle 的](http://studios.thoughtworks.com/mingle-project-intelligence)好东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-03T16:08:27.827

这是我对类似问题的回答，可能会给您一些想法

[帮助一个BA！管理用户故事...](http://www.bridging-the-gap.com/help-a-ba-how-do-i-manage-user-stories-so-there-is-a-body-of-project-knowledge/?utm_source=feedburner&utm_medium=twitter&utm_campaign=Feed%3A+BridgingTheGapBetweenBusinessAndIt+%28Bridging+the+Gap%29)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-20T02:53:28.507

很多这些回复都是关于使用工具的建议。然而，现实情况是，您的流程将比您用于实施流程的工具重要得多。远离那些试图把方法论塞进喉咙的工具。但是，也要警惕使用新工具简单地实现旧的非敏捷流程。以下是在确定流程工具时需要考虑的一些重要事实：

1.  使用软件工具检测的不良流程将导致不良的软件工具实施。
2.  流程将根据您管理的组而改变。重要的是人，而不是过程。实施他们可以成功运作的东西，你的项目就会成功。

综上所述，这里有一些指导方针可以帮助您：

*   从一个记录过程的纯粹实现开始，
*   使你的迭代小，
*   在每次迭代后与您的团队交谈并询问他们将更改什么，实施有意义的更改。

对于较大的组织，如果您使用 SCRUM，请使用级联站立机制。Scrum 主管与他们的团队会面。然后 Scrum Master 以 6 到 9 人的方式开会，由 Super-Scrum-MAster 负责将 Scum-Master 的 scrum 中的项目报告到下一个级别……等等。

您可能会发现，每周举行一次超级 Scrum 会议在您的最高层级就足够了。

# c - 为什么 GCC 不优化结构？

> ID：118068
> 
> 赞同：50
> 
> 时间：2008-09-22T22:46:19.287
> 
> 标签：c, optimization, gcc, struct

系统要求某些原语与内存中的某些点对齐（整数到 4 的倍数的字节，短到 2 的倍数的字节等）。当然，这些可以优化为在填充中浪费最少的空间。

我的问题是为什么 GCC 不自动执行此操作？是否缺少更明显的启发式（从最大尺寸要求到最小尺寸的顺序变量）？某些代码是否依赖于其结构的物理顺序（这是个好主意）？

我只是问，因为 GCC 在很多方面都经过了超级优化，但在这方面却没有，而且我认为一定有一些相对酷的解释（我没有注意到）。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-09-22T23:13:43.637

gcc 不会重新排序结构的元素，因为这会违反 C 标准。C99 标准的第 6.7.2.1 节规定：

> 在结构对象中，非位域成员和位域所在的单元的地址按声明顺序递增。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-22T22:48:40.950

结构经常被用作二进制文件格式和网络协议的打包顺序的表示。如果这样做，这将打破。此外，不同的编译器会以不同的方式优化事物，将两者的代码链接在一起是不可能的。这根本不可行。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-22T22:56:53.990

GCC 在从源代码生成机器代码方面比我们大多数人更聪明；但是，如果它在重新排列我们的结构时比我们更聪明，我会颤抖，因为它是可以写入文件的数据。如果在 GCC 决定它应该重新排列结构成员的另一个系统上读取，则以 4 个字符开头然后具有 4 个字节整数的结构将毫无用处。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-31T19:11:25.470

gcc SVN 确实有结构重组优化（-fipa-struct-reorg），但它需要全程序分析，目前还不是很强大。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T22:50:58.543

*由于*您提到的对齐问题，C 编译器不会自动打包结构。不在字边界（大多数 CPU 上为 32 位）上的访问会在 x86 上带来严重的惩罚，并在 RISC 架构上造成致命的陷阱。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-18T19:18:47.507

并不是说这是一个好主意，但您当然可以编写依赖于结构成员顺序的代码。例如，作为 hack，人们通常将指向结构的指针转换为他们想要访问的内部某个字段的类型，然后使用指针算术来到达那里。对我来说，这是一个非常危险的想法，但我已经看到它被使用过，特别是在 C++ 中，当它位于来自 3rd 方库的类中并且未公开封装时，强制一个已被声明为私有的变量可公开访问。重新排序成员将完全打破这一点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-09-12T04:25:10.627

您可能想尝试最新的 gcc 主干或正在积极开发的 struct-reorg-branch。

[https://gcc.gnu.org/wiki/cauldron2015?action=AttachFile&do=view&target=Olga+Golovanevsky_+Memory+Layout+Optimizations+of+Structures+and+Objects.pdf](https://gcc.gnu.org/wiki/cauldron2015?action=AttachFile&do=view&target=Olga+Golovanevsky_+Memory+Layout+Optimizations+of+Structures+and+Objects.pdf)

# markup - 如何向 TWiki 添加自定义标记？

> ID：118073
> 
> 赞同：0
> 
> 时间：2008-09-22T22:46:51.050
> 
> 标签：markup, twiki

在我以前工作的地方，一位同事想出了如何配置 MediaWiki，例如，`#12345`可以将 wiki 标记中的字符串扩展为票证系统中票证 12345 的超文本链接。

我想在 TWiki 中做类似的事情。不过，我还没有弄清楚怎么做。所以，如果我这样做了，我会试着回答这个问题。:)

-丹尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T06:38:31.713

InterWiki 链接可能是链接到外部站点的最佳方式。否则，您可以编写一个 TWikiplugin 来注册 TWiki TAG 处理程序（即 %TAG% 语法）或在主题文本通过渲染器时处理它（有点慢）。

它不是复杂的 Perl，但是:)

SvenDowideit

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-22T23:17:29.807

如果启用了 InterwikiPlugin，则可以通过 TWiki 中的 InterWikis 节点轻松添加“wiki 链接”。这不是完全成熟的自定义标记，但实现这样的链接就像`RT:12345`添加这样的表格行一样简单：

```
| RT | https://your-rt-server/Ticket/Display.html?id= | '$page' in RT system | 
```

然后，包含类似字符串的 wiki 文本`RT:12345`将扩展为超链接`https://your-rt-server/Ticket/Display.html?id=12345`

# msbuild - 你给 MSBuild 项目构建文件起什么名字？

> ID：118091
> 
> 赞同：7
> 
> 时间：2008-09-22T22:51:30.477
> 
> 标签：msbuild

我正在尝试学习如何使用 MSBuild，以便我们可以使用它来构建我们的项目。文档中似乎有一个非常大的漏洞，我在任何地方都发现了这个漏洞，这个漏洞是你如何命名或以其他方式指定 MSBuild 项目文件？

例如，可以从 Microsoft 下载的有关 MSBuild 的教程详细介绍了构建文件的内容。例如，这里有一点他们的 Hello World 项目文件。

```
<Project MSBuildVersion = "1.0" DefaultTargets = "Compile">
   <Property appname = "HelloWorldCS"/>
   <Item Type = "CSFile" Include = "consolehwcs1.cs"/>
   <Target Name = "Compile">
      <Task Name = "CSC" Sources = "@(CSFile)">
         <OutputItem  TaskParameter = "OutputAssembly" Type = "EXEFile" Include = "$(appname).exe"/>
      </Task>
      <Message Text="The output file is @(EXEFile)"/>
   </Target>
</Project> 
```

它继续等等等等等等等等等等等等的项目，这就是你如何做到这一点，这就是你如何做到这一点。没用，完全没用。因为他们从来不说这个 xml 文件应该如何被 MSBuild 应用程序识别。它应该以特定方式命名吗？它应该放在特定目录中吗？两个都？两者都不？

他们不告诉它的不仅仅是MS教程。我无法在 MSDN 上找到它，也无法在任何我可以从 Groups.Google 中提取的链接上找到它。

这里有人知道吗？我当然希望如此。

> **编辑添加：** 我将教程中包含的 .proj 文件误认为是 .csproj 文件，这就是提供给 MSBuild 的文件，但在我看到这个之前，它得到了下面的答案。这应该很明显，但我错过了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-22T22:58:23.720

您可以根据需要命名文件。来自 MSBuild 的帮助

```
msbuild.exe /?

Microsoft (R) Build Engine Version 2.0.50727.3053
[Microsoft .NET Framework, Version 2.0.50727.3053]
Copyright (C) Microsoft Corporation 2005\. All rights reserved.

Syntax:              MSBuild.exe [options] [project file] 
```

因此，如果您将文件保存为 mybuildfile.xml，您将使用以下语法：

```
msbuild.exe mybuildfile.xml 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T10:33:18.407

如果您遵循以下策略，则不必指定构建文件：

> 今天，当您从命令行调用 msbuild.exe 并且不指定任何项目文件作为参数时，我们会进行一些自动推断和扫描并决定是否应该构建任何东西。如果我们找到 msbuild 项目（任何具有 *proj 扩展名的项目）或解决方案文件 (.sln)，只要目录中只有一个解决方案或一个项目，我们将构建项目或解决方案。如果有解决方案和项目，我们会优先考虑解决方案。如果有多个项目或多个解决方案，我们会发出错误消息，因为我们无法决定要构建哪一个。

这取自[新功能反馈请求：/IgnoreProjectExtensions - A new command-line switch](http://blogs.msdn.com/msbuild/archive/2006/03/24/559547.aspx)。

我总是将我手动编写的脚本命名为*build.proj*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-12T12:18:55.733

不是直接的答案，而是相关的；如果您将`.msproj`其用作扩展程序，Visual Studio 将为您提供智能感知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T14:39:12.463

或者对于像我这样的真正懒惰的人。

```
msbuild.exe project-file-name.vcproj /t:Rebuild /p:Configuration=Release 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T21:33:53.587

Visual Studio 2012 将其识别`.msbuildproj`为扩展并将其视为解决方案资源管理器中的“项目”。

# php - 将一个 URL 替换为另一个

> ID：118092
> 
> 赞同：1
> 
> 时间：2008-09-22T22:51:38.183
> 
> 标签：php

在 PHP 中，用字符串中的另一个 URL 替换一个 URL，例如

```
New post on the site <a href="http://stackoverflow.com/xyz1">http://stackoverflow.com/xyz1</a></p> 
```

变成：

```
New post on the site <a href="http://yahoo.com/abc1">http://yahoo.com/abc1</a></p> 
```

必须适用于上述重复字符串。欣赏这很简单但很困难！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T22:57:18.013

```
function replace_url($text, $newurl) {
    $text = preg_replace('@(https?://([-\w\.]+)+(:\d+)?(/([\w/_\.]*(\?\S+)?)?)?)@', $newurl, $text);
    return $text;
} 
```

应该管用。[正则表达式从这里](http://snipplr.com/view/2371/regex-regular-expression-to-match-a-url/)被盗。这将用新的 URL 替换字符串中的所有 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T22:55:03.400

使用[str_replace()](http://php.net/str_replace)：

```
$text = str_replace('http://stackoverflow.com/xyz1', 'http://yahoo.com/abc1', $text); 
```

这将用 $text 中的第二个 URL 替换第一个 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T22:55:26.537

尝试这个：

```
preg_replace('#(https?://)(www\.)?stackoverflow.com\b#', '\1\2yahoo.com', $text); 
```

如果要更改 url 之后的路径，请添加另一个组并使用`preg_replace_callabck`. PHP 文档中的更多信息。

# python - 如何将逗号分隔的字符串解析为列表（警告）？

> ID：118096
> 
> 赞同：24
> 
> 时间：2008-09-22T22:54:10.347
> 
> 标签：python, split, escaping, quotes

我需要能够采用如下字符串：

```
'''foo, bar, "one, two", three four''' 
```

进入：

```
['foo', 'bar', 'one, two', 'three four'] 
```

我有一种感觉（来自#python 的提示）该解决方案将涉及 shlex 模块。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-22T23:09:45.487

这取决于您想要变得多复杂......您是否要允许不止一种类型的引用。转义引号怎么样？

您的语法看起来很像 Python 标准库支持的常见 CSV 文件格式：

```
import csv
reader = csv.reader(['''foo, bar, "one, two", three four'''], skipinitialspace=True)
for r in reader:
  print r 
```

输出：

```
['foo', 'bar', 'one, two', 'three four'] 
```

！

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-22T23:15:45.050

shlex 模块解决方案允许转义引号，一个引号转义另一个引号，以及 shell 支持的所有花哨的东西。

```
>>> import shlex
>>> my_splitter = shlex.shlex('''foo, bar, "one, two", three four''', posix=True)
>>> my_splitter.whitespace += ','
>>> my_splitter.whitespace_split = True
>>> print list(my_splitter)
['foo', 'bar', 'one, two', 'three', 'four'] 
```

转义引号示例：

```
>>> my_splitter = shlex.shlex('''"test, a",'foo,bar",baz',bar \xc3\xa4 baz''',
                              posix=True) 
>>> my_splitter.whitespace = ',' ; my_splitter.whitespace_split = True 
>>> print list(my_splitter)
['test, a', 'foo,bar",baz', 'bar \xc3\xa4 baz'] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-22T22:56:56.190

您可能还需要考虑[csv](http://docs.python.org/lib/module-csv.html)模块。我没有尝试过，但看起来你的输入数据更接近 CSV 而不是 shell 语法（这是 shlex 解析的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T23:02:31.153

你可以这样做：

```
>>> import re
>>> pattern = re.compile(r'\s*("[^"]*"|.*?)\s*,')
>>> def split(line):
...  return [x[1:-1] if x[:1] == x[-1:] == '"' else x
...          for x in pattern.findall(line.rstrip(',') + ',')]
... 
>>> split("foo, bar, baz")
['foo', 'bar', 'baz']
>>> split('foo, bar, baz, "blub blah"')
['foo', 'bar', 'baz', 'blub blah'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T14:08:53.300

我想说正则表达式将是您在这里寻找的内容，尽管我对 Python 的 Regex 引擎并不十分熟悉。

假设您使用惰性匹配，您可以在一个字符串上获得一组匹配，您可以将其放入您的数组中。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-22T23:09:25.940

如果它不需要漂亮，这可能会让你上路：

```
def f(s, splitifeven):
    if splitifeven & 1:
        return [s]
    return [x.strip() for x in s.split(",") if x.strip() != '']

ss = 'foo, bar, "one, two", three four'

print sum([f(s, sie) for sie, s in enumerate(ss.split('"'))], []) 
```

# project-management - 你用什么工具做燃尽图？

> ID：118100
> 
> 赞同：13
> 
> 时间：2008-09-22T22:55:07.877
> 
> 标签：project-management, charts

你用工具吗？或者只是手动制作它们？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-28T13:03:47.487

[谷歌图表 api/server](http://code.google.com/apis/chart/basics.html)可以很容易地制作一个

![燃尽 2](https://chart.apis.google.com/chart?chs=600x250&cht=lxy&chtt=Burndown&chxt=x,y&chxl=days&chdl=Estimated|Actual&chco=FF0000,00FF00&chd=t:-1|40,36,32,28,24,20,16,12,8,4,0|-1|40,38,36,35,20,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1&chxr=0,0,30,2|1,0,40,2&chds=0,40&chm=s,FF0000,0,-1,5|s,0000ff,1,-1,5|s,00aa00,2,-1,5) ![烧掉](https://chart.apis.google.com/chart?chs=600x250&chtt=Burndown&cht=lc&chxt=x,y&chxl=days&chdl=Estimated|Actual&chco=FF0000,00FF00&chd=t:40,36,32,28,24,20,16,12,8,4,0|40,39,38,37,36,35,30,25,23,21,18,14,4,0,0&chxr=0,0,30,2|1,0,40,2&chds=0,40)

您在 URL 中指定所有内容，以便于更新：

```
http://chart.apis.google.com/chart?
chs=600x250& // the size of the chart
chtt=Burndown& // Title
cht=lc& // The chart type - "lc" means a line chart that only needs Y values
chdl=estimated|actual& // The two legends
chco=FF0000,00FF00& // The colours in hex of the two lines
chxr=0,0,30,2|1,0,40,2& // The data range for the x,y (index,min,max,interval)
chds=0,40 // The min and max values for the data. i.e. amount of features
chd=t:40,36,32,28,24,20,16,12,8,4,0|40,39,38,37,36,35,30,25,23,21,18,14,12,9,1 // Data 
```

上面的 URL 以 2 为间隔绘制 - 所以每 2 天工作一次。您每天都需要更大尺寸的图表。为此，使数据具有 30 个估计值和实际值，并更改“chxr”，使间隔为 1，而不是 2。

您只能使用“lxy”图表类型（第一张图像）更清楚地绘制完成的日子。这也需要您输入 X 数据值（所以是一个向量）。使用 -1 表示未知数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T23:10:24.300

我们倾向于只使用一个简单的共享 Excel 表，其中一个选项卡上有图表，另一个选项卡上有数据透视表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-09-03T01:15:11.123

我自己没用过，但是[http://apps.vanpuffelen.net/charts/burndown.jsp](http://apps.vanpuffelen.net/charts/burndown.jsp)提供了一个比 google 图表 api 还要简单的 api。例子：

```
http://apps.vanpuffelen.net/charts/burndown.jsp?days=17,18,19,22,23,24,25,26,29,30&work=125,112,104,99,95 
```

给出下图：

![在此处输入图像描述](https://i.stack.imgur.com/uy5SF.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T23:06:34.323

我确实使用了 TargetProcess，但我现在更喜欢一种更具触觉的方法，所以我在白板上手动绘制它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T23:28:30.747

[VersionOne](http://www.versionone.com/)很好地制作了燃尽表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-05T02:10:51.847

就像在这篇文章中回答的那样，[哪些工具可以为 Bugzilla 或 Mylyn 提供燃尽图？](https://stackoverflow.com/questions/528519/what-tools-provide-burndown-charts-to-bugzilla-or-mylyn/8736768#8736768)

[www.in-sight.io](http://www.burndown-charts.com/)（以前称为burndowncharts）是一个很棒的SCRUM 分析工具。

以下是一些仪表板示例：

[冲刺指标](http://www.burndown-charts.com/teams/family-petre-bach/sprints/baby-shower)

[团队指标](http://www.burndown-charts.com/teams/family-petre-bach)

![在此处输入图像描述](https://i.stack.imgur.com/I01lT.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T22:56:46.033

我们在本地使用基于[http://opentcdb.org/](http://opentcdb.org/)的东西，但它会进行 scrum 跟踪，并绘制漂亮的图表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T00:59:28.953

我们使用 RallyDev 的社区版，它制作了漂亮的燃尽图。问题是我们的团队还没有能够完成输入数据以保持燃尽信息有意义的可靠工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T01:05:11.060

我们还使用具有漂亮图表的社区版[RallyDev 。](http://www.rallydev.com/)一旦你确定了你真正想要使用的部分，我发现它是一个很好的工具。大多数人不会使用大量的字段和功能，这对于更大的团队来说可能是一个令人困惑的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T17:29:04.237

我们曾经在 rallydev.com 上使用这些工具，但随着时间的推移，我们发现该工具对于我们想要的东西来说太麻烦了。

随着时间的推移，我只使用了一个简单的 Excel 电子表格。每天早上起床前，我都会计算剩余的时间，然后在图表上的“理想”燃尽线旁边添加趋势线。我把它贴在我们举行晨会的墙上。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-28T13:15:51.997

我们是 Team Foundation Server 和 conchango 的 scrum 模板，通过这个漂亮的小 scrum 仪表板使用内置的燃尽图

[http://www.codeplex.com/scrumdashboard](http://www.codeplex.com/scrumdashboard)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-06-14T23:37:18.263

我使用谷歌文档和excel。本文底部提供了两者的模板（并包括许多不错的功能，例如效率因子的自动计算）

[燃尽图教程：简单的敏捷项目跟踪](http://joel.inpointform.net/software-development/burn-down-charts-tutorial-simple-agile-project-tracking/)

# nhibernate - 如何在 nHibernate 中完全禁用缓存？

> ID：118108
> 
> 赞同：17
> 
> 时间：2008-09-22T22:56:50.387
> 
> 标签：nhibernate

如何在 nHibernate 中完全禁用缓存？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-23T00:21:08.437

使用 IStatelessSession 绕过一级缓存：[http ://darioquintana.com.ar/blogging/?p=4](http://darioquintana.com.ar/blogging/?p=4)

为了使用二级缓存，您必须显式配置它。如果您不使用它，您将不会使用它。

您还可以在映射中关闭延迟加载。懒惰=假。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T08:48:23.380

注意 IStatelessSession 是我认为 Nhibernate 2.0 中的新功能

二级缓存配置细节：[第 25 章 NHibernate.Caches](http://nhibernate.info/doc/nhibernate-reference/caches.html)

# asp.net - 使用 ASP.NET WebForms 避免大泥球的技巧

> ID：118126
> 
> 赞同：7
> 
> 时间：2008-09-22T23:00:32.000
> 
> 标签：asp.net, webforms

尽管最近 ASP.NET MVC 似乎大肆宣传，但 WebForms 仍然相当普遍。你如何保持你的项目理智？让我们在这里收集一些提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T23:17:02.037

我通常会尽量避开它......但是当我使用 WebForms 时，我会遵循以下规则：

1.  **保持生成的 HTML 干净**：仅仅因为您没有手动编写`<div>`代码并不意味着生成的代码必须成为无法阅读的噩梦。避免产生丑陋代码的控件可以减少以后的调试时间，使问题更容易被发现。
2.  **最小化外部依赖**：你不会因为调试其他人的代码而获得报酬。如果您*确实*选择依赖第 3 方组件，那么请获取源代码，这样您就不必浪费大量时间来修复他们的错误。
3.  **避免在一个页面上做太多事情**：如果您发现自己为给定页面实现了复杂的“模式”，请考虑将其分解为多个单一模式页面，也许使用母版页来分解出共同的方面。
4.  **避免回**发：这一直是个糟糕的主意，而且还没有变得更糟糕。通过不使用依赖回发的控件可以省去的麻烦是一个不错的奖励。
5.  **避免 VIEWSTATE**：参见#4 的注释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-22T23:38:54.700

对于大型项目，我能给你的最好建议是遵循一种通用的设计模式，你的所有开发人员都受过良好的培训并且非常了解。如果您正在处理 ASP.NET，那么对我来说最好的两个选择是：

o 模型视图演示器（[尽管现在是主管控制器和被动视图](http://martinfowler.com/eaaDev/ModelViewPresenter.html)）。这是一个将用户界面和业务模型分开的可靠模型，您的所有开发人员都可以轻松地遵循它。生成的代码更具可测试性和可维护性。问题是它没有强制执行，您需要编写大量支持代码来实现模型。

o ASP.NET MVC 这个问题在于它是预览版。我与 Tatham Oddie 交谈过，有人提到它非常稳定且可用。我喜欢它，它强制分离关注点，并为开发人员使用最少的额外代码。

我认为无论您选择哪种模型，最重要的是拥有一个模型并确保您的所有开发人员都能够坚持该模型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T23:04:31.910

*   为不属于母版页类型内容的多个页面上显示的任何内容创建 Web 用户控件。示例：如果您的应用程序在 10 个页面上显示产品信息，最好有一个在 10 个页面上使用的用户控件，而不是剪切'n'粘贴显示代码 10 次。
*   将尽可能少的业务逻辑放在后面的代码中。后面的代码应该遵从您的业务层来执行与将内容放在页面上并从业务层来回发送数据没有直接关系的工作。
*   不要重新发明轮子。我见过的很多草率的代码隐藏都是由执行框架已经提供的事情的代码组成的。
*   一般来说，避免 html 中的脚本块。
*   不要一页做太多事情。我一次又一次地看到一个页面说有添加和编辑模式。没关系。但是，如果您要添加和编辑许多子模式，则最好为每个子模式设置多个页面，并通过用户控件重用。您确实需要避免使用一堆嵌套的 IF 来确定您的用户正在尝试做什么，然后根据它显示正确的内容。如果您的页面有许多可能的状态，事情很快就会失控。
*   学习/了解页面生命周期并将其用于您的优势。如果编码人员更好地理解页面生命周期，我见过的许多丑陋的代码隐藏页面可能会更干净。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T23:04:09.073

从第 1 天的 Master Pages 开始 - 重新进行改造会很痛苦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T00:32:31.607

按照 Odd 所说的，我正在尝试一个名为 Model Presentation 的 MVP 版本，到目前为止它对我来说效果很好。我仍然对它有所了解并对其进行调整以适应我自己的使用，但它从我以前编写的代码中令人耳目一新。

在这里查看：[演示模型](http://martinfowler.com/eaaDev/PresentationModel.html)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-22T23:26:29.190

使用版本控制和文件夹结构来防止太多文件都在同一个文件夹中。没有什么比等待 Windows 资源管理器加载更痛苦的了，因为一个文件夹中有 1,000 多个文件，并且必须在打开文件夹时加载所有文件。如果可能的话，提前制定一个命名变量和方法的约定也很好，这样就不会出现这种混杂的代码，不同的开发人员都把他们独特的接触和痛苦地展示出来。

使用设计模式有助于组织代码并使其很好地扩展，例如，当必须添加必须支持的新型产品或设备时，策略模式可以使时间更容易。类似于使用一些适配器或外观模式。

最后，了解您的表单将遵循哪些标准：它是否仅适用于 IE 用户，或者 IE、Firefox 或 Safari 中的任何一个是否应该轻松加载表单并看起来不错？

# c# - C# - 为什么全屏 Winform 应用程序不总是覆盖任务栏？

> ID：118130
> 
> 赞同：23
> 
> 时间：2008-09-22T23:02:07.283
> 
> 标签：c#, .net, winforms, fullscreen, keyboard-hook

我使用的是 Windows Vista 和 C#.net 3.5，但我让我的朋友在 XP 上运行该程序并且遇到了同样的问题。

所以我有一个 C# 程序，我在后台运行，系统托盘中有一个图标。我有一个低级键盘钩子，所以当我按下两个键（在本例中为 Ctr+windows）时，它会拉出应用程序的主窗体。表单在组合按键事件处理程序中设置为全屏：

```
this.FormBorderStyle = FormBorderStyle.None;
this.WindowState = FormWindowState.Maximized; 
```

所以它基本上可以工作。当我点击 CTR+Windows 时，无论我关注什么程序，它都会弹出表单。但有时，任务栏仍会显示在表单上，​​这是我不想要的。当我按下那个组合键时，我希望它总是全屏显示。

我认为这与最初关注的应用程序有关。但即使当我点击我的主窗体时，任务栏有时也会停留在那里。所以我想知道焦点是否真的是问题所在。似乎有时任务栏很顽固，不想坐在我的程序后面。

任何人有任何想法我可以解决这个问题吗？

编辑：更多细节 - 我试图达到与网络浏览器相同的效果，当您将其置于全屏模式或将 powerpoint 置于演示模式时。

在 windows 窗体中，您可以通过将边框样式设置为 none 并最大化窗口来做到这一点。但有时由于某种原因，窗口不会覆盖任务栏。一半的时间会。

如果我将主窗口放在最上面，那么当我单击它时，其他窗口会落在它后面，如果任务栏被隐藏，我不希望这样做。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-22T23:11:44.593

试试这个（`this`你的表格在哪里）：

```
this.Bounds = Screen.PrimaryScreen.Bounds;
this.TopMost = true; 
```

这会将表单设置为全屏，并将覆盖任务栏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-15T09:41:22.780

我尝试了很多解决方案，其中一些适用于 Windows XP，而所有解决方案都不适用于 Windows 7。毕竟我写了一个简单的方法来做到这一点。

```
private void GoFullscreen(bool fullscreen)
    {
        if (fullscreen)
        {
            this.WindowState = FormWindowState.Normal;
            this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.None;
            this.Bounds = Screen.PrimaryScreen.Bounds;
        }
        else
        {
            this.WindowState = FormWindowState.Maximized;
            this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.Sizable;
        }
    } 
```

代码的顺序很重要，如果您更改 WindwosState 和 FormBorderStyle 的位置，它将不起作用。

此方法的优点之一是将 TOPMOST 设置为 false，以允许其他表单超越主表单。

它绝对解决了我的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-26T17:56:57.560

```
private void Form1_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.F11)
        if (FormBorderStyle == FormBorderStyle.None)
        {
            FormBorderStyle = FormBorderStyle.Sizable;
            WindowState = FormWindowState.Normal;
        }
        else
        {
            SuspendLayout();
            FormBorderStyle = FormBorderStyle.None;
            WindowState = FormWindowState.Maximized;
            ResumeLayout();
        }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T23:07:48.033

据我所知，根据“将任务栏保持在其他窗口之上”设置，任务栏位于窗口上方或下方。（至少，这是 XP 中的措辞。）我想您可以尝试查看是否可以检测到此设置并在需要时切换它？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T23:08:31.217

尝试调整表单大小并将其置于 z 顺序的前面，如下所示：

```
 Rectangle screenRect = Screen.GetBounds(this);
        this.Location = screenRect.Location;
        this.Size = screenRect.Size;
        this.BringToFront(); 
```

# python - 如何为 MacOS 开发和创建一个独立的 PyGTK 应用程序包，并带有本地外观的小部件？

> ID：118138
> 
> 赞同：7
> 
> 时间：2008-09-22T23:04:07.857
> 
> 标签：python, macos, gtk, pygtk

我读过可以[在 MacOS X 上构建 GTK+](http://developer.imendio.com/projects/gtk-macosx/build-instructions)。我知道可以[在 MacOS 上创建 GTK+ 应用程序包](http://developer.imendio.com/projects/gtk-macosx/creating-app-bundles)。我也知道可以创建[看起来有点原生](http://people.imendio.com/richard/archives/2008/02/native_mac_them_1.html)的小部件。但是，四处搜索我并不清楚如何创建一个包含本机主题内容的包，并使用 Python 而不是它自己的 C 要点。也有传言[说可以构建 PyGTK](http://developer.imendio.com/node/175)，但听起来这个过程可能仍然存在一些问题。

但是，没有一步一步的指南来解释如何设置一个可以从 Python 源运行应用程序的环境，然后在应用程序包中构建和部署。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T10:12:16.930

具有原生外观的小部件非常复杂。这里有一个石英引擎（用于主题）的开始[http://git.gnome.org/browse/gtk+/tree/gdk/quartz](http://git.gnome.org/browse/gtk+/tree/gdk/quartz) 对于独立的应用程序，请查看[http://live.gnome上新发布的包.org/GTK%2B/OSX](http://live.gnome.org/GTK%2B/OSX)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T14:03:07.010

我不确定我是否了解了您问题的所有细节，但是总体上看您的问题（如何在 mac 上部署 python 应用程序），我倾向于说答案是[py2app](http://undefined.org/python/py2app.html)。基本上，这将为您捆绑一个 python 解释器和所有相关的 python 文件，并为您提供一个可编写脚本的系统，您可以使用它来添加您需要的任何其他资源/依赖项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T10:03:37.467

虽然它不是*仅*针对 python/GTK+/OS X 的指南，[但这篇文章](http://groups.google.com/group/reinteract/msg/4846099674d2153a)很好、详细地描述了其他人尝试完成您所描述的大部分内容的尝试。显然，特定于应用程序的东西会有所不同。

# perl - 鹦鹉到底是什么？

> ID：118141
> 
> 赞同：26
> 
> 时间：2008-09-22T23:04:40.913
> 
> 标签：perl, jit, vm-implementation, parrot

我知道 Parrot 是一个虚拟机，但我觉得我并没有完全掌握它背后的想法。

据我了解，它是一个用于处理多种语言的虚拟机。这个对吗？

使用虚拟机而不仅仅是解释器有什么好处？

Parrot 到底在做什么让它如此重要？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-22T23:28:02.213

[Parrot](http://www.parrotcode.org/)是专门设计用于处理多种语言的虚拟机，尤其是动态语言。尽管涉及到一些有趣的技术，但由于它可以处理一种以上的语言，因此它将能够跨越语言边界。例如，一旦它可以编译 Ruby、Perl 和 Python，应该很容易跨越这些界限，让我在 Python 中使用 Ruby 库，Python 中的 Perl 库，所以我喜欢任何组合。

Parrot 起源于 Perl 世界，许多从事此工作的人都是经验丰富的 Perl 人员。Parrot 没有使用显示其时代的当前 Perl 解释器，而是允许 Perl 具有诸如可分发的预编译模块（其他人已经拥有很长时间）和更智能的垃圾收集器等功能。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-22T23:15:42.133

Chris 介绍了面向用户的差异，所以我将介绍另一面。

Parrot 是基于寄存器而不是基于堆栈的。这意味着编译器开发人员可以更轻松地优化为给定代码段分配寄存器的方式。此外，从 Parrot 字节码到机器码的编译在理论上可以比基于堆栈的代码更快，因为我们运行基于寄存器的系统并且有更多针对它们优化的经验。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-22T23:06:52.843

Parrot 是一个字节码解释器（未来可能会使用 JIT）。想想 Java 和它的虚拟机，除了 Java（目前）更倾向于静态语言，而 Parrot 从一开始就倾向于动态语言。

另请参阅科迪的出色回答！强烈推荐。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-23T07:44:54.453

其他人已经给出了很好的答案，所以我剩下的就是解释“动态”语言的实际含义。

在虚拟机的上下文中，这意味着变量的类型在编译时是未知的。在“静态”语言中，类型（或至少它的父类）在编译时是已知的，并且许多优化都建立在该知识之上。

另一方面，在动态语言中，您可能知道变量是否包含容器类型（如数组）或标量（字符串、数字等），但在编译时您拥有的类型信息要少得多。

另一个特点是动态语言通常使类型转换更容易，例如在 perl 和 javascript 中，如果您使用字符串作为数字，它会自动转换为数字。

Parrot 旨在使此类操作变得简单快捷，并允许在编译时不知道类型信息的情况下进行优化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-28T23:59:09.223

这是[官方鹦鹉维基](http://www.perlfoundation.org/parrot/index.cgi?parrot)。

你可以在那里找到很多信息和链接。

Parrot wiki 主页的底部还显示来自[Planet Parrot](http://planet.parrotcode.org/)提要聚合器的最新头条新闻。

除了 VM 之外，Parrot 项目正在构建一个非常强大的工具链，以便更轻松地移植现有语言或开发新语言。

Parrot VM 还将为许多强大的 Perl 6 新特性提供其他语言的支持（请参阅[官方 Perl 6 Wiki](http://www.perlfoundation.org/perl6/index.cgi?perl_6)了解更多 Perl 6 信息）。

Parrot 将提供不同语言的模块之间的互操作性，例如，其他语言可以利用将成为巨大的 Perl 6 版本的 CPAN（巨大的 Perl 5 模块存档，Perl 6 将能够通过即将发布的Perl 5.12）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T00:37:59.240

老实说，我不知道这有什么大不了的。它已经走了很长一段路，但并没有看到太多用处。主要目标语言尚未真正出现，并且在行业专业人士中已经失去了巨大的份额。同时，.Net 等其他解决方案和 Jython 等项目向我们表明，此时此地可以击败任何感知到的炒作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-03T17:29:21.380

*   Parrot 将成为 java 的目标，但从未实现 - 适用于所有操作系统和平台的 vm
*   Parrot 将为任何动态语言和真正的跨平台实现微软公共语言运行时背后的想法
*   Parrot 现在和将来都是免费和开源的
*   Parrot 将成为使用动态语言进行开源编程的事实标准

# php - Python 正则表达式与 PHP 正则表达式

> ID：118143
> 
> 赞同：3
> 
> 时间：2008-09-22T23:06:02.547
> 
> 标签：php, python, regex

不是竞争，而是我试图找出为什么某个正则表达式在一个中起作用，而在另一个中不起作用。

```
(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?) 
```

那是我的正则表达式，我正在尝试运行它

```
127.255.0.0 
```

使用 Python 正则表达式我什么也得不到，使用 PHP 我匹配它，下面是我正在进行的两个调用（只是以防它与此有关）。本质上，我试图弄清楚为什么它在 PHP 中有效，但在 Python 中无效。

```
re.findall(regex, string)
preg_match_all($regex, $string, $matches); 
```

* * *

找到解决方案，这是由于我迭代结果的方式，这个正则表达式将它们变成组，然后它不想以相同的方式打印出来等等等等。谢谢大家的帮助，真的赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-22T23:10:13.520

这个对我有用。你一定做错了什么。

```
>>> re.match(r'(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)', '127.255.0.0').groups()
('127', '255', '0', '0') 
```

不要忘记使用原始字符串转义正则表达式：`r'regex_here'`如[Regex Howto中所述](http://docs.python.org/dev/howto/regex.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-22T23:14:34.197

我建议使用正则表达式进行十进制范围验证不一定是此问题的正确答案。这更具可读性：

```
def valid_ip(s):
    m = re.match(r"(\d+)\.(\d+)\.(\d+)\.(\d+)$", s)
    if m is None:
        return False
    parts = [int(m.group(1+x)) for x in range(4)]
    if max(parts) > 255:
        return False
    return True 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T20:16:59.273

仅仅因为您*可以*使用正则表达式来做到这一点，并不意味着您应该这样做。编写如下指令会更好：在句点上拆分字符串，确保每个组都是数字并且在一定的数字范围内。

如果您想使用正则表达式，只需验证它是否“看起来像”一个 IP 地址，就像 Greg 的正则表达式一样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T23:14:43.743

没有更多细节，我猜它是某种形式的转义。PHP 和 python 的 RegEX 对象都将字符串作为参数。这些字符串在传递给 RegEx 引擎之前会被语言转义。

在使用正则表达式时，我总是使用 Python 的“原始”字符串格式。它确保“[不以任何特殊方式处理反斜杠](http://www.amk.ca/python/howto/regex/)”

```
r'(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-22T23:10:35.143

该正则表达式在这里匹配，不知道你做错了什么：

```
>>> import re
>>> x = re.compile(r'(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|'
... r'2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]'
... r'[0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)')
>>> x.match("127.0.0.1")
<_sre.SRE_Match object at 0x5a8860>
>>> x.match("127.255.0.1")
<_sre.SRE_Match object at 0x5a8910>
>>> x.match("127.255.0.0")
<_sre.SRE_Match object at 0x5a8860> 
```

请注意，`preg_match`转换为`re.search`Python 而不是`re.match`. `re.match`对词法分析很有用，因为它是锚定的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-22T23:14:25.990

[PHP](http://www.regular-expressions.info/php.html)使用 3 种不同风格的正则表达式，而 python 只使用一种。我不在 python 中编写代码，所以我没有就它如何使用 REGEX 做专家声明。[O'Reilly Mastering Regular Expressions](http://oreilly.com/catalog/9781565922570/)是一本很棒的书，就像他们的大部分作品一样。

# mysql - 在不更改表结构的情况下选择表中最后 n 行的最有效方法是什么？

> ID：118144
> 
> 赞同：19
> 
> 时间：2008-09-22T23:06:05.433
> 
> 标签：mysql, sql

使用 mySQL 选择表中最后 n 行的最有效方法是什么？该表包含数百万行，并且在任何给定时间我都不知道该表有多大（它在不断增长）。该表确实有一列会自动递增并用作每行的唯一标识符。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-09-22T23:11:27.650

```
SELECT * FROM table_name ORDER BY auto_incremented_id DESC LIMIT n 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-18T13:11:51.140

实际上，按顺序获取最后 n 行的正确方法是使用子查询：

```
(SELECT id, title, description FROM my_table ORDER BY id DESC LIMIT 5) 
ORDER BY tbl.id ASC 
```

因为这种方式是我所知道的唯一可以按正确顺序返回它们的方式。接受的答案实际上是“*从按 ID 降序排列的集合中选择前 5 行*”的解决方案，但这很可能是您需要的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-19T12:23:35.043

（类似于“marco”的回答，）
我最喜欢的也是 MySQL 的 max()-function，在一个简单的**one-liner**中，但还有其他方法可以确定：

```
SELECT whatever FROM mytable WHERE id > (SELECT max(id)-10 FROM mytable); 
```

...你会得到“last id minus 10”，通常是该表的最后 10 个条目。

这是避免错误 1111（“组函数的无效使用”）的捷径，不仅在存在 auto_increment-row（此处为 id）的情况下。
max() 函数可以有多种使用方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-22T23:11:51.300

也许按唯一 id 降序排列：

```
SELECT * FROM table ORDER BY id DESC LIMIT n 
```

唯一的问题是你可能想以不同的顺序选择，这个问题让我不得不通过计算行数来选择最后一行，然后使用 LIMIT 选择它们，但显然这可能不是一个好的解决方案在你的情况下。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-22T23:11:49.383

使用 ORDER BY 以 DESC 顺序按标识符列排序，并使用 LIMIT 指定您想要多少个结果。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-22T23:14:12.217

您可能还想添加一个降序索引（或在 mysql 中调用的任何内容）以使选择快速，如果这是您经常要做的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-29T08:49:08.527

当您有大桌子时，这要快得多，因为您不必订购整张桌子。您只需使用 id 作为唯一的行标识符。当您在某些列中有大量数据作为图像（例如 blob）时，这也更有效。在这种情况下，订购可能非常耗时且耗费数据。

```
select * 
from TableName 
where id > ((select max(id) from TableName)-(NumberOfRowsYouWant+1)) 
order by id desc|asc 
```

唯一的问题是如果您在所需的时间间隔内删除行。在这种情况下，您不会得到真正的“NumberOfRowsYouWant”。

当您需要在多个网页中向后显示表格时，您还可以轻松地使用它为每个页面选择 n 行，只需将 (NumberOfRowsYouWant+1) 乘以页码即可。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-31T07:52:53.610

在这里您可以根据需要更改表名和列名。如果您想显示最后 10 行，请根据您的要求输入 n=10，或 n=20，或 n=30 ...等。

select * from (select * from employee Order by emp_id desc limit n) a Order by emp_id asc;

# javascript - 使用 JavaScript 在 DIV 中旋转内容的最佳方法？

> ID：118151
> 
> 赞同：1
> 
> 时间：2008-09-22T23:07:08.957
> 
> 标签：javascript, html

例如，请参阅[MySQL](http://www.mysql.com/)网站。它只会用于在大约 3-5 个“广告”中轮换到网站的值得注意的区域。我想要某种链接控制来回溯到其他内容（再次，如 MySQL 站点）。谷歌给了我一堆非常容易实现的东西，用于旋转本身，很难的是链接控制。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-22T23:14:14.370

我发现 jQuery 的[循环插件](http://malsup.com/jquery/cycle/)非常通用。它可以以多种方式旋转元素，并且可以添加下一个/上一个控制菜单。

# apache-flex - 如何检测和调用用户在特定 AIR 应用程序上本地安装的 AIR 运行时？

> ID：118157
> 
> 赞同：6
> 
> 时间：2008-09-22T23:08:18.283
> 
> 标签：apache-flex, installation, air, adobe

我正在编写一个程序，它具有 AIR 前端，但后端是用另一种语言（在本例中为 Python）编写的。由于 AIR 无法调用其他可执行文件，因此关系必须相反，Python 运行 AIR 子进程。如何定位用户的 AIR 运行时？我希望能够在 Mac、Windows 和 Linux 上执行此操作。

（具有讽刺意味的是，如果我可以打包 AIR 调试运行时，这将非常容易，但许可协议要求用户自己下载常规运行时并运行安装程序。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T06:41:34.497

首先，您可以获得（免费）许可证来重新分发安装的 AIR 运行时：

看：

[http://www.mikechambers.com/blog/2008/04/07/redistributing-the-adobe-air-runtime-installer/](http://www.mikechambers.com/blog/2008/04/07/redistributing-the-adobe-air-runtime-installer/)

和

[http://www.adobe.com/products/air/runtime_distribution1.html#license](http://www.adobe.com/products/air/runtime_distribution1.html#license)

至于启动 AIR 应用程序，您可以像任何其他本机应用程序一样启动它（因为 AIR 应用程序在安装后只是一个本机应用程序）。

至于查找用户安装应用程序的位置，至少在 Windows 上，我相信您可以根据要启动的 AIR 应用程序的 appid 以编程方式从注册表中获取信息。

最后，您可以在此处找到关于此的概念证明：

[http://www.mikechambers.com/blog/2008/01/17/commandproxy-net-air-integration-proof-of-concept/](http://www.mikechambers.com/blog/2008/01/17/commandproxy-net-air-integration-proof-of-concept/)

和

[http://www.mikechambers.com/blog/2008/01/22/commandproxy-its-cool-but-is-it-a-good-idea/](http://www.mikechambers.com/blog/2008/01/22/commandproxy-its-cool-but-is-it-a-good-idea/)

麦克风

# mysql - 帮助从 MySQL 迁移到 MS SQL 的提示

> ID：118185
> 
> 赞同：0
> 
> 时间：2008-09-22T23:15:41.853
> 
> 标签：mysql, sql-server, data-migration

一段时间以来，我一直对数据库开发感兴趣，并决定 MS SQL 在 T-SQL 方面可以提供很多功能，并且通常具有更多功能（并不是说 Oracle 或 Postgres 没有）。

我想知道：

1.  我应该期待看到哪些重大的范式变化？
2.  “常规”公司在开发他们的数据库（事务、触发器、事件、数据清理、ETL）方面投入了多少精力？
3.  我可以从 MS SQL 开发人员团队的内部工作以及他们如何与 .NET 应用程序开发人员交互中期待什么？

我希望我正确地表达了我的问题。我对整个 .NET 场景不是很了解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T23:56:28.917

无法回答 #1，因为我从未使用过 mysql，但我会尝试 #2 和 #3。

这往往取决于数据库的大小和/或公司的规模（或专业性）。拥有大量用户的大型数据库的公司确实花费了大量时间来确保数据库具有完整性和性能调整。如果他们不这样做，他们将失去客户。我们有 6 人只做 ETL 工作，5 名 dbas 调整和管理数据库和数据库服务器，还有许多编写 t-sql 代码的开发人员。

至于#3，在优秀的公司里，这些人作为一个团队一起工作得很好。在糟糕的公司中，两个群体之间经常存在紧张关系，并且每个人都将另一个群体作为任何问题的替罪羊。我与一群优秀的 .net 开发人员一起工作。他们尊重我的数据库专业知识，就像我尊重他们的 .net 专业知识一样，我们就设计问题和调优问题以及任何需要双方提供意见的问题相互协商。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T00:26:06.007

[http://forums.mysql.com/read.php?60,124480,124480](http://forums.mysql.com/read.php?60,124480,124480)详细信息使用从 SQL Server 到 MySQL 的链接服务器来进行实际的数据迁移。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T00:29:56.417

[Apache DDLUtils](http://db.apache.org/ddlutils/)应该能够提供帮助。您可以将架构逆向工程为通用 DDL，也可以将数据导出到平面文件。之后导入它。

# sql - 如何忽略从 SQL Plus 运行的 SQL 脚本中的 & 符号？

> ID：118190
> 
> 赞同：112
> 
> 时间：2008-09-22T23:19:04.093
> 
> 标签：sql, oracle, sqlplus

我有一个 SQL 脚本，它创建一个包含与符号 (&) 的注释的包。当我从 SQL Plus 运行脚本时，系统会提示我输入以 & 开头的字符串的替代值。如何禁用此功能以使 SQL Plus 忽略 & 符号？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2008-09-22T23:25:36.213

这可能对您有用：

```
set define off 
```

否则，＆符号需要在字符串的末尾，

```
'StackOverflow &' || ' you' 
```

编辑：保存时我很高兴...这是从[博客](http://blog.andrewbeacock.com/2008/09/using-ampersands-without-variable_15.html)中引用的。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2010-12-08T22:26:47.227

如果您有时使用替换变量，您可能不想关闭定义。在这些情况下，您可以将 & 符号从其等效数字转换为 in`|| Chr(38) ||`或将其作为单个字符附加为 in `|| '&' ||`。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-11-22T10:56:25.343

我用下面的代码解决了：

```
set escape on 
```

并在 & 旁边放一个 \ 在左边 `'value_\&_intert'`

攻击者

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-12-07T17:34:48.927

您可以通过使用`SET DEFINE <1_CHARACTER>`

默认情况下，DEFINE 功能本身是开启的，并且它被设置为**&**

它可以被关闭 - 如前所述 - 但也可以通过将其设置为不同的值来避免它。非常清楚您将其设置为什么标志。在下面的示例中，我选择了 # 字符，但该选择只是一个示例。

```
SQL> select '&var_ampersand #var_hash' from dual;
Enter value for var_ampersand: a value

'AVALUE#VAR_HASH'
-----------------
a value #var_hash

SQL> set define #
SQL> r
  1* select '&var_ampersand #var_hash' from dual
Enter value for var_hash: another value

'&VAR_AMPERSANDANOTHERVALUE'
----------------------------
&var_ampersand another value

SQL> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-19T18:35:45.790

set define off <- 这是我找到的最佳解决方案

我也试过...

设置定义 }

我能够插入几条包含＆符号'&'的记录，但我不能在文本中使用'}'字符所以我决定使用“设置定义关闭”并且一切正常。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-22T23:27:16.770

根据[这个不错的常见问题解答](http://www.orafaq.com/wiki/SQL*Plus_FAQ#How_does_one_disable_interactive_prompting_in_SQL.2APlus.3F)，有几个解决方案。

`\`如果您可以修改注释，您也可以使用反斜杠字符转义与号。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-10T04:04:00.950

我有一个 CASE 语句，其中 WHEN column = 'sometext & more text' THEN ....

我将其替换为 WHEN column = 'sometext' || CHR(38) || '更多文字'然后...

您也可以使用 WHEN 列 LIKE 'sometext _ more text' THEN ...

（_ 是单个字符的通配符）

# .net - 在服务器上引发远程处理异常时出现 Socket 关闭错误

> ID：118192
> 
> 赞同：2
> 
> 时间：2008-09-22T23:19:14.327
> 
> 标签：.net, exception, sockets, remoting

我有一个使用 .Net 远程处理构建的应用程序。验证时，如果有错误，我在服务器上抛出异常。异常是可序列化的。但是当服务器上抛出异常时，有时我会在客户端看到一个错误，上面写着“已建立的连接被主机中的软件中止”。

这是我在尝试调试服务器时从 windbg 获得的堆栈跟踪。看起来远程框架正在这样做。关于为什么关闭套接字以及如何处理这个问题的任何想法？

```
System.Net.Sockets.Socket.Close()
System.Runtime.Remoting.Channels.SocketHandler.Close()
System.Runtime.Remoting.Channels.SocketHandler.CloseOnFatalError（System.Exception）
System.Runtime.Remoting.Channels.SocketHandler.ProcessRequestNow()
System.Runtime.Remoting.Channels.RequestQueue.ProcessNextRequest（System.Runtime.Remoting.Channels.SocketHandler）
System.Runtime.Remoting.Channels.SocketHandler.BeginReadMessageCallback(System.IAsyncResult)
System.Net.LazyAsyncResult.Complete(IntPtr)
System.Net.ContextAwareResult.CompleteCallback(System.Object)
System.Threading.ExecutionContext.Run（System.Threading.ExecutionContext，System.Threading.ContextCallback，System.Object）
System.Net.ContextAwareResult.Complete(IntPtr)
System.Net.LazyAsyncResult.ProtectedInvokeCallback（System.Object，IntPtr）
System.Net.Sockets.BaseOverlappedAsyncResult.CompletionPortCallback（UInt32，UInt32，System.Threading.NativeOverlapped*）
System.Threading._IOCompletionCallback.PerformIOCompletionCallback（UInt32，UInt32，System.Threading.NativeOverlapped*）

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T20:34:30.250

.Net 远程处理框架是否会在每次引发远程处理异常时关闭套接字？从使用 WinDbg 进行调试来看，情况如此。有人可以证实这一点吗？另外，根据特定情况，是否有时在发送响应后关闭套接字，有时在发送响应之前关闭套接字？

当我没有得到“已建立的连接被主机中的软件中止”时，这是来自客户端的 windbg 的跟踪。在这种情况下，我得到一个远程异常

```
06d2f45c 7c812aeb [HelperMethodFrame: 06d2f45c]
06d2f500 7a5ff43e System.Net.Sockets.Socket.Receive（字节 []，Int32，Int32，System.Net.Sockets.SocketFlags）
06d2f51c 67777fb0 System.Runtime.Remoting.Channels.SocketStream.Read（字节 []，Int32，Int32）
06d2f530 67777b12 System.Runtime.Remoting.Channels.SocketHandler.ReadFromSocket(Byte[], Int32, Int32)
06d2f540 67777aea System.Runtime.Remoting.Channels.SocketHandler.BufferMoreData()
06d2f548 67777a7c System.Runtime.Remoting.Channels.SocketHandler.Read(Byte[], Int32, Int32)
06d2f56c 67777998 System.Runtime.Remoting.Channels.SocketHandler.ReadAndMatchFourBytes（字节 []）
06d2f578 67783199 System.Runtime.Remoting.Channels.Tcp.TcpSocketHandler.ReadVersionAndOperation(UInt16 ByRef)
06d2f598 67783ece System.Runtime.Remoting.Channels.Tcp.TcpClientSocketHandler.ReadHeaders()
06d2f5b4 67782456 System.Runtime.Remoting.Channels.Tcp.TcpClientTransportSink.ProcessMessage（System.Runtime.Remoting.Messaging.IMessage，System.Runtime.Remoting.Channels.ITransportHeaders，System.IO.Stream，System.Runtime.Remoting.Channels。 ITransportHeaders ByRef，System.IO.Stream ByRef）
06d2f5d0 06e61bdf com.imageright.security.remoting.IdentityClientSink.ProcessMessage（System.Runtime.Remoting.Messaging.IMessage，System.Runtime.Remoting.Channels.ITransportHeaders，System.IO.Stream，System.Runtime.Remoting.Channels.ITransportHeaders ByRef , System.IO.Stream ByRef)
06d2f5f0 6778ae69 System.Runtime.Remoting.Channels.BinaryClientFormatterSink.SyncProcessMessage（System.Runtime.Remoting.Messaging.IMessage）
06d2f62c 793c319f System.Runtime.Remoting.Proxies.RemotingProxy.CallProcessMessage（System.Runtime.Remoting.Messaging.IMessageSink，System.Runtime.Remoting.Messaging.IMessage，System.Runtime.Remoting.Contexts.ArrayWithSize，System.Threading.Thread， System.Runtime.Remoting.Contexts.Context，布尔值）
06d2f650 793c2f82 System.Runtime.Remoting.Proxies.RemotingProxy.InternalInvoke（System.Runtime.Remoting.Messaging.IMethodCallMessage，布尔值，Int32）
06d2f6b4 793c2db9 System.Runtime.Remoting.Proxies.RemotingProxy.Invoke（System.Runtime.Remoting.Messaging.IMessage）
06d2f6c4 79374dc3 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke（System.Runtime.Remoting.Proxies.MessageData ByRef，Int32）
06d2f960 79f98b43 [TPMethodFrame: 06d2f960] com.imageright.server.IInstrumentation.GetEnterpriseID()
06d2f970 06e618ee imageright.proxies_com.imageright.server.IInstrumentationProxy.GetEnterpriseID()
06d2f9c4 069fddae ImageRight.EMC.EnterpriseNode.EstablishConnection()
06d2fa00 069fdce7 ImageRight.EMC.RootNode.TryOpenConnections（System.Object）
06d2fa38 79407caa System.Threading._ThreadPoolWaitCallback.WaitCallback_Context(System.Object)
06d2fa3c 79373ecd System.Threading.ExecutionContext.Run（System.Threading.ExecutionContext，System.Threading.ContextCallback，System.Object）
06d2fa54 79407e18 System.Threading._ThreadPoolWaitCallback.PerformWaitCallbackInternal（System.Threading._ThreadPoolWaitCallback）
06d2fa68 79407d90 System.Threading._ThreadPoolWaitCallback.PerformWaitCallback(System.Object)
06d2fbf8 79e7c74b [GCFrame: 06d2fbf8]

```

这是当我收到错误“已建立的连接被主机中的软件中止”时的跟踪。在这种情况下，我得到一个套接字错误。

```
06d2f45c 7c812aeb [HelperMethodFrame: 06d2f45c]
06d2f500 7a5ff43e System.Net.Sockets.Socket.Receive（字节 []，Int32，Int32，System.Net.Sockets.SocketFlags）
06d2f51c 67777fb0 System.Runtime.Remoting.Channels.SocketStream.Read（字节 []，Int32，Int32）
06d2f530 67777b12 System.Runtime.Remoting.Channels.SocketHandler.ReadFromSocket(Byte[], Int32, Int32)
06d2f540 67777aea System.Runtime.Remoting.Channels.SocketHandler.BufferMoreData()
06d2f548 67777a7c System.Runtime.Remoting.Channels.SocketHandler.Read(Byte[], Int32, Int32)
06d2f56c 67777998 System.Runtime.Remoting.Channels.SocketHandler.ReadAndMatchFourBytes（字节 []）
06d2f578 67783199 System.Runtime.Remoting.Channels.Tcp.TcpSocketHandler.ReadVersionAndOperation(UInt16 ByRef)
06d2f598 67783ece System.Runtime.Remoting.Channels.Tcp.TcpClientSocketHandler.ReadHeaders()
06d2f5b4 67782456 System.Runtime.Remoting.Channels.Tcp.TcpClientTransportSink.ProcessMessage（System.Runtime.Remoting.Messaging.IMessage，System.Runtime.Remoting.Channels.ITransportHeaders，System.IO.Stream，System.Runtime.Remoting.Channels。 ITransportHeaders ByRef，System.IO.Stream ByRef）
06d2f5d0 06e61bdf com.imageright.security.remoting.IdentityClientSink.ProcessMessage（System.Runtime.Remoting.Messaging.IMessage，System.Runtime.Remoting.Channels.ITransportHeaders，System.IO.Stream，System.Runtime.Remoting.Channels.ITransportHeaders ByRef , System.IO.Stream ByRef)
06d2f5f0 6778ae69 System.Runtime.Remoting.Channels.BinaryClientFormatterSink.SyncProcessMessage（System.Runtime.Remoting.Messaging.IMessage）
06d2f62c 793c319f System.Runtime.Remoting.Proxies.RemotingProxy.CallProcessMessage（System.Runtime.Remoting.Messaging.IMessageSink，System.Runtime.Remoting.Messaging.IMessage，System.Runtime.Remoting.Contexts.ArrayWithSize，System.Threading.Thread， System.Runtime.Remoting.Contexts.Context，布尔值）
06d2f650 793c2f82 System.Runtime.Remoting.Proxies.RemotingProxy.InternalInvoke（System.Runtime.Remoting.Messaging.IMethodCallMessage，布尔值，Int32）
06d2f6b4 793c2db9 System.Runtime.Remoting.Proxies.RemotingProxy.Invoke（System.Runtime.Remoting.Messaging.IMessage）
06d2f6c4 79374dc3 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke（System.Runtime.Remoting.Proxies.MessageData ByRef，Int32）
06d2f960 79f98b43 [TPMethodFrame: 06d2f960] com.imageright.server.IInstrumentation.GetEnterpriseID()
06d2f970 06e618ee imageright.proxies_com.imageright.server.IInstrumentationProxy.GetEnterpriseID()
06d2f9c4 069fddae ImageRight.EMC.EnterpriseNode.EstablishConnection()
06d2fa00 069fdce7 ImageRight.EMC.RootNode.TryOpenConnections（System.Object）
06d2fa38 79407caa System.Threading._ThreadPoolWaitCallback.WaitCallback_Context(System.Object)
06d2fa3c 79373ecd System.Threading.ExecutionContext.Run（System.Threading.ExecutionContext，System.Threading.ContextCallback，System.Object）
06d2fa54 79407e18 System.Threading._ThreadPoolWaitCallback.PerformWaitCallbackInternal（System.Threading._ThreadPoolWaitCallback）
06d2fa68 79407d90 System.Threading._ThreadPoolWaitCallback.PerformWaitCallback(System.Object)
06d2fbf8 79e7c74b [GCFrame: 06d2fbf8]。

```

在服务器上引发异常的是我们的自定义接收器，它负责安全性。我本可以将代码发布在一个地方并且直截了当。

# c++ - C++ 线程，共享数据

> ID：118199
> 
> 赞同：30
> 
> 时间：2008-09-22T23:22:06.783
> 
> 标签：c++, multithreading, synchronization, mutex

我有一个正在运行 2 个线程的应用程序... 是否可以确定当我从一个线程更改全局变量时，另一个线程会注意到此更改？我没有任何同步或互斥系统......但这段代码是否应该一直工作（想象一个名为**dataUpdated的全局****布尔**值）：

 **线程 1：

```
while(1) {
    if (dataUpdated)
        updateScreen();
    doSomethingElse();
} 
```

线程 2：

```
while(1) {
    if (doSomething())
        dataUpdated = TRUE;
} 
```

像 gcc 这样的编译器是否会以不检查全局值的方式优化此代码，只在编译时考虑它的值（因为它永远不会同时更改）？

PS：对于类似游戏的应用程序来说，在写入值时是否会读取并不重要......重要的是其他线程会注意到更改。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-22T23:56:36.297

是的。不，也许。

首先，正如其他人所提到的，您需要使 dataUpdated 不稳定；否则编译器可以自由地将它从循环中读取出来（取决于它是否可以看到 doSomethingElse 没有触及它）。

其次，根据您的处理器和订购需求，您可能需要内存屏障。volatile 足以保证其他处理器最终会看到更改，但不足以保证更改将按照执行顺序被看到。您的示例只有一个标志，因此并没有真正显示这种现象。如果你需要并使用内存屏障，你应该不再需要 volatile

[Volatile 被认为是有害](http://www.kernel.org/doc/Documentation/volatile-considered-harmful.txt)的，[Linux Kernel Memory Barriers](http://www.kernel.org/doc/Documentation/memory-barriers.txt)是潜在问题的良好背景；我真的不知道专门为线程编写的类似内容。值得庆幸的是，线程不会像硬件外围设备那样经常提出这些问题，尽管您描述的那种情况（指示完成的标志，如果设置了标志，则其他数据假定有效）正是排序的那种事情很重要...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-22T23:46:29.597

这是一个使用提升条件变量的示例：

```
bool _updated=false;
boost::mutex _access;
boost::condition _condition;

bool updated()
{
  return _updated;
}

void thread1()
{
  boost::mutex::scoped_lock lock(_access);
  while (true)
  {
    boost::xtime xt;
    boost::xtime_get(&xt, boost::TIME_UTC);
    // note that the second parameter to timed_wait is a predicate function that is called - not the address of a variable to check
    if (_condition.timed_wait(lock, &updated, xt))
      updateScreen();
    doSomethingElse();
  }
}

void thread2()
{
  while(true)
  {
    if (doSomething())
      _updated=true;
  }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-22T23:51:13.127

使用锁。始终始终使用锁来访问共享数据。将变量标记为 volatile 将阻止编译器优化内存读取，但不会阻止其他问题，例如[内存重新排序](http://en.wikipedia.org/wiki/Memory_ordering)。如果没有锁，则无法保证 doSomething() 中的内存写入将在 updateScreen() 函数中可见。

唯一的其他安全方法是使用[内存栅栏](http://en.wikipedia.org/wiki/Memory_barrier)，例如显式或隐式使用 Interlocked* 函数。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-23T00:08:26.000

使用***volatile***关键字向编译器提示该值可以随时更改。

```
volatile int myInteger; 
```

以上将保证对变量的任何访问都将在没有任何特定优化的情况下进出内存，因此在同一处理器上运行的所有线程都将“看到”对变量的更改，其语义与代码读取的语义相同。

Chris Jester-Young 指出，在多处理器系统中可能会出现对这种可变值变化的一致性问题。这是一个考虑因素，它取决于平台。

实际上，相对于平台，确实有两个考虑因素需要考虑。它们是内存事务的一致性和原子性。

原子性实际上是单处理器和多处理器平台的考虑因素。出现问题是因为变量本质上可能是多字节的，问题是一个线程是否可以看到对值的部分更新。即：某些字节更改，上下文切换，中断线程读取的无效值。对于具有自然机器字长或更小的单个变量并且自然对齐的单个变量不应该是一个问题。具体来说，一个***int***类型在这方面应该总是可以的，只要它是对齐的——这应该是编译器的默认情况。

相对于一致性，这是多处理器系统中的一个潜在问题。问题是系统是否在处理器之间实现了完全缓存一致性。如果实施，这通常通过硬件中的 MESI 协议完成。该问题没有说明平台，但英特尔 x86 平台和 PowerPC 平台在正常映射的程序数据区域的处理器之间是缓存一致的。因此，即使有多个处理器，线程之间的普通数据内存访问也不应该担心此类问题。

与原子性相关的最后一个问题是特定于读-修改-写原子性。也就是说，您如何保证如果读取的值更新了值并写入，这会原子地发生，即使在多个处理器之间也是如此。因此，要使其在没有特定同步对象的情况下工作，将要求访问该变量的所有潜在线程仅是读取器，但期望一次只有一个线程可以成为写入器。如果不是这种情况，那么您确实需要一个可用的同步对象来确保对变量的读-修改-写操作的原子操作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-22T23:25:52.563

除其他问题外，您的解决方案将使用 100% CPU。谷歌搜索“条件变量”。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-22T23:36:21.913

Chris Jester-Young 指出：

> 这仅适用于 Java 1.5+ 的内存模型。C++ 标准不涉及线程，并且 volatile 不保证处理器之间的内存一致性。你确实需要一个内存屏障

既然如此，唯一真正的答案是实施同步系统，对吧？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-22T23:24:08.977

使用**volatile**关键字向编译器提示该值可以随时更改。

```
volatile int myInteger; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-22T23:25:13.423

不，这不确定。如果您声明变量 volatile，那么编译器应该生成始终在读取时从内存中加载变量的代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-22T23:47:02.527

如果范围是正确的（“extern”、全局等），那么就会注意到更改。问题是什么时候？并按什么顺序？

问题是编译器**可以**并且经常**将**重新排序您的逻辑以填充所有并发管道作为性能优化。

它并没有真正显示在您的具体示例中，因为您的分配周围没有任何其他指令，但想象一下在您的 bool 分配之后声明的函数在分配**之前**执行。

在 wikipedia 上查看[Pipeline Hazard](http://en.wikipedia.org/wiki/Pipeline_stall#Eliminating_hazards) 或在 google 中搜索“编译器指令重新排序”

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-22T23:53:45.617

正如其他人所说，`volatile`关键字是你的朋友。:-)

当您在 gcc 中禁用所有优化选项时，您很可能会发现您的代码可以工作。在这种情况下（我相信），它将所有内容都视为易失性，因此每次操作都会在内存中访问变量。

打开任何类型的优化后，编译器都会尝试使用寄存器中保存的本地副本。根据您的功能，这可能意味着您只能间歇性地看到变量的变化，或者在最坏的情况下，永远不会。

使用关键字`volatile`向编译器表明此变量的内容可以随时更改，并且不应*使用*本地缓存的副本。

综上所述，您可能会通过使用信号量或条件变量找到更好的结果（正如[Jeff所暗示的）。](https://stackoverflow.com/questions/118199/c-thread-shared-data#118211)

[这](http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html)是对该主题的合理介绍。

# .net - 如何使用 WebBrowser 控件“在新窗口中打开”？

> ID：118203
> 
> 赞同：6
> 
> 时间：2008-09-22T23:23:39.743
> 
> 标签：.net, internet-explorer, browser

当您在 .NET 中使用 WebBrowser 控件时，您可以在您的应用程序中“嵌入”一个 IE 实例，实质上是制作您自己的基于 IE 的 Web 浏览器。

有谁知道如何使创建的任何新窗口（例如当用户从上下文菜单中选择“在新窗口中打开”时）在您的 Web 浏览器应用程序的另一个窗口中打开，而不是在计算机的默认浏览器中打开？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-22T23:36:45.330

也许这篇 CodeProject 文章中的源代码可以提供帮助：

[扩展的 .NET 2.0 WebBrowser 控件](http://www.codeproject.com/KB/cpp/ExtendedWebBrowser.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-22T23:42:29.887

我很久以前在VB中做过这个。

据我记得，当控件触发 NewWindow2 事件时，我们将取消原始请求并打开一个单独的 VB 表单，其中包含指向请求 URL 的 WebBrowser 控件的另一个实例。

我做了一个快速的谷歌搜索，似乎这个事件在 .Net 中并不那么容易访问。 [在这里查看可能的解决方案。](http://blogs.artinsoft.net/mrojas/archive/2008/09/18/newwindow2-events-in-the-c-webbrowsercontrol.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T23:49:48.183

这里有一个代码示例，其中包含用于将 NewWindow2 事件添加到 WebBrowser 控件的代码。如果他们将此事件添加到 WebBrowser 控件本身，那肯定会很好。

[http://zerosandtheone.com/media/p/277.aspx](http://zerosandtheone.com/media/p/277.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-10T17:37:48.107

如果您使用的是 .net 版本的 webbrowser 控件，此站点有我发现的最佳解决方案

[http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/f497f8a5-dac8-48cb-9fce-7936c9389f09](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/f497f8a5-dac8-48cb-9fce-7936c9389f09)

# windows - 如何将 subversion 存储库发布到本地 IIS？

> ID：118205
> 
> 赞同：8
> 
> 时间：2008-09-22T23:24:23.283
> 
> 标签：windows, svn, iis, tortoisesvn, continuous-integration

在工作中，我们有一个安装了 IIS 和 Subversion 的 windows server 2003。我们使用它在本地发布和测试我们的 ASP.NET 网站。每个程序员都在他的 PC 上安装了 Tortoise，并且可以更新/提交内容到服务器。托管存储库工作正常。但是保存在这些存储库中的文件需要复制到我们的本地 IIS（虚拟目录）。

将这些颠覆存储库发布到我们本地 IIS 的简单方法是什么？

编辑：
感谢[puetzk](https://stackoverflow.com/users/14312/puetzk)，我添加了一个简单的 bat 文件，每次提交时都会执行该文件（查看关于钩子的[颠覆文档）。](http://svnbook.red-bean.com/nightly/en/svn.reposadmin.create.html)我的 bat 文件只包含：

```
echo off
setlocal

:: Localize the working copy where IIS points)
pushd E:\wwwroot\yourapp\trunk
:: Update your working copy
svn update

endlocal
exit 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-22T23:39:46.147

1.  只需将 Web 服务器的文件区域保留为工作副本，并在您想要“发布”时在其中执行 svn up。配置它以隐藏 .svn 文件夹的内容，如果它们看起来不整洁（我不具体知道如何执行此操作，但我认为可以完成）。他们将已经拥有文件系统隐藏位，这可能会解决这个问题。

2.  如果您希望它真正自动（一旦有人提交就更新），请使用 SVN 服务器上的提交后挂钩脚本来启动第一个进程。

评论中的其他人建议使用导出而不是结帐。这也可以工作，并避免 .svn 混乱，但有两个缺点。一，它每次都必须重新下载整个内容，而不仅仅是修改过的文件（因为它没有保留 .svn 目录来记住它有什么）。如果你有很多文件，这会慢得多。第二，更新自动替换文件（将新版本写入 .svn/tmp，然后将其移动到位）。导出将文件在下载时逐渐写入其目的地。这意味着导出可能会将不完整的文件传递给在错误时间浏览它的人。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-22T23:31:24.390

SVN 不支持 IIS；但是，您可以[将独立的 svnserve 服务器作为 Windows 服务运行](http://svn.collab.net/repos/svn/trunk/notes/windows-service.txt)。

有关于它的[SVN 常见问题解答条目，](http://subversion.tigris.org/faq.html#svnserve-win-service) [Vertigo Software 博客](http://blogs.vertigosoftware.com/teamsystem/archive/2006/01/16/Setting_up_a_Subversion_Server_under_Windows.aspx)上的这篇博文也可能会有所帮助。

更新：在您澄清之后，我看到您正在寻找的是一种在签入后自动更新服务器上代码的方法。查看[CruiseControl.NET](http://ccnet.thoughtworks.com/)，在查看了[颠覆集成教程](http://confluence.public.thoughtworks.org/display/CCNET/Subversion+Source+Control+Block)之后，它看起来应该做什么你要。

更新 2：本教程描述了[集成 Subversion、CruiseControl.NET 和 Nant](http://www.testearly.com/2006/05/01/integrating-ccnet-with-nant-and-subversion-on-windows/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-14T10:32:17.690

也许 SVNIsapi 可以解决这个问题（[http://www.svnisapi.com](http://www.svnisapi.com)）。因为它只使用 IIS 安装，因此您不需要 APACHE 服务器或 SVNSERVER 服务。其次，应该可以将 ASP.NET ISAPI 插件堆叠到 SVNISAPI 的处理上，以便在从存储库读取后解释 ASP.NET (.aspx) 页面。

干杯保罗

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T23:56:07.093

使用可以使用免费的[Visual-SVN Server](http://www.visualsvn.com/server/)快速安装带有 Apache 前端的 Subversion。它还有一个很好的 MMC 管理单元，用于管理服务器和存储库。

您将能够使用 HTTP 或 HTTPS 访问 subversion，但端口号必须与本地 IIS 使用的端口号不同（Visual-SVN 服务器的默认端口是 8080）。

如果您确实需要使用本地 IIS 端口 80 访问存储库，您可以尝试使用[SVN-IIS](http://www.svniis.org/)，它充当 IIS 和 Apache 之间的桥梁。我自己还没有尝试过这个。

# python - Python 中最好的调度程序/回调库是什么？

> ID：118221
> 
> 赞同：2
> 
> 时间：2008-09-22T23:28:37.143
> 
> 标签：python

我需要允许其他 Python 应用程序为我的应用程序中的事件注册回调函数。这些需要与它们相关联的优先级（因此优先级为 10 的回调在优先级为 1 的回调之前运行）并且回调函数需要能够向调度程序发出错误信号。

这些都是在同一个进程中运行的轻量级回调，所以我不需要跨进程边界发送信号。

是否有一个好的 Python 库来处理这个问题，还是我需要自己编写？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-22T23:30:39.320

这些其他应用程序是否在另一个地址空间中运行？如果是这样，您将需要使用像[D-BUS](http://www.freedesktop.org/wiki/Software/dbus)这样的进程间通信库。

如果您只是在同一进程中发送信号，请尝试[PyDispatcher](http://pypi.python.org/pypi/PyDispatcher/2.0.1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T23:30:44.703

你在什么平台下运行？GObject 是在 Linux 下广泛使用的 GTK GUI 的基础，它支持具有此类优先级事件的事件循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-16T21:01:38.773

尝试 Twisted 处理任何与网络相关的内容。它的透视代理非常好用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-16T08:52:15.487

尝试 python-callbacks - [http://code.google.com/p/python-callbacks/](http://code.google.com/p/python-callbacks/)。

# wordpress - 如何将 SCM 与 Wordpress 等 PHP 应用程序一起使用？

> ID：118235
> 
> 赞同：2
> 
> 时间：2008-09-22T23:33:40.530
> 
> 标签：wordpress, version-control

我使用 Wordpress 运行我的博客，最近我成为了SCM 的*忠实*信徒。我真的很想把我的网站变成颠覆（这就是我现在正在使用的，也许 git 稍后会出现）但我想不出正确的方法来做到这一点。基本上，我的存储库当前设置有一个“实现”目录和一个“资源”目录，实现包含最终将发布到实时站点的内容。我希望能够在本地预览我的网站，而无需出于明显的原因上传到服务器。但是，要做到这一点，我发现我需要在本地实际安装 Wordpress（不仅仅是将远程站点复制到我的本地机器）。这是在 Wordpress.org 上告诉我的。

这带来了能够在安装中使用 SCM 的问题，因为我需要不时升级我的本地站点，但这会与 subversion 产生不一致，因为它无法跟踪正在发生的事情，因为外部系统正在弄乱它的存储库结构体。那是行不通的。

我最初的倾向是尝试仅对我的主题信息进行 SCM，因为这确实是我“拥有”的唯一东西，而其他所有东西实际上只是我平台的一部分（实际上与 Apache 或 PHP 没有什么不同）。然而，这就是我的理解崩溃的地方。我怎样才能有选择地只选择 SCM 目录结构的一部分，我怎样才能维护我正在使用的 Wordpress 的配置？

无论如何，我确信其他人已经解决了这个问题，并且该解决方案可能适用于许多类似于 Wordpress 的应用程序（Drupal、phpBB、phpMyAdmin 等）。你是怎么做到的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T00:45:20.733

这实际上并不难，但我将在这里分解为一些建议。您所描述的或多或少是一个“供应商下降”目录。这基本上是您在 SVN 中维护代码的地方，但是当它出现时用更新的内容替换内容。

你应该从一个空目录开始。设置一个 SVN 存储库，然后对空目录执行 SVN 检出（它仍然是空的，除了它会添加一个隐藏的 .svn 目录）。接下来，在这里正常安装wordpress，然后将其文件添加到svn。您可能只是“svn add *”，但要小心，并删除您不希望版本化的任何内容（上传/临时/缓存目录，如果适用）。如果您愿意，您还可以使用 svn:ignore 属性告诉它忽略某些目录或文件类型。运行“svn stat”来向您展示将要签入的内容等，一旦一切顺利，提交它（svn commit）并从那里开始工作。现在你已经在 SVN 中安装了 wordpress 的基本安装。

当你工作和做出改变时，提交它们。

当需要升级时，只需将 wordpress 替换为您所拥有的。确保当您替换目录时，您替换的是内容，而不是整个目录本身。您不想丢失每个文件夹中隐藏的 .svn 文件夹，因为这会搞砸颠覆。做一个 svn stat 和/或 svn diff 来找出改变了什么，如果有的话，主要是什么是新添加的。此时，您可以再次提交。

要在您的生产站点上部署，您可以执行 svn 导出，或定期检出到 web 目录。如果您进行结帐，请确保仅在准备好部署时进行更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T16:41:13.340

这是我正在测试的方法。设置需要一些时间，但您应该（理论上）进行面向未来的安装：

[以正确的方式安装 WordPress](http://solutions.treypiepmeier.com/2008/05/28/installing-wordpress-the-right-way/)

另请查看 svn:externals 以获取插件更新：

[使用 svn:externals 安装 WordPress 插件](http://scott.yang.id.au/2006/04/svnexternal-wordpress-plugins/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T01:05:54.710

我认为升级部分甚至可以比这更容易一些；我使用 2.5 和 2.6 的最新版本以及 WP 的前沿主干修订版来执行此操作。

由于 Wordpress 将他们所有的东西都作为颠覆存储库提供，因此获取稳定标签的当前版本就像制作博客目录一样简单，然后

```
# svn co http://svn.automattic.com/wordpress/tags/2.6.2/ (replace the current rev here for the first check out). 
```

当升级可用时，只需导航到您的博客目录并运行

```
#svn sw http://svn.automattic.com/wordpress/tags/2.6.3/ (or whatever wordpress rev you're updating to) 
```

然后发布到您的生产站点只是一个导出，正如[gregmac 提到](https://stackoverflow.com/questions/118235/how-do-i-use-scm-with-a-php-app-such-as-wordpress#118465)的 但是，我认为这并不能回答您的实际问题，我将其解释为“如何在能够升级 Wordpress 的同时将我的自定义内容保留在 SCM 中”。您对要添加的目录的直觉几乎是目标（您自己的个人博客的东西 - 主题，pplugins - 将在 wp-content 中，因此您只需要将其放入 subversion 中）但我对 subversion 不够精通告诉您如何将目录放入您自己的存储库，同时仍然能够依赖 Wordpress 的存储库进行升级。我网站上这些文件的“SCM”是 wp-content 目录的服务器外副本。

也许从这个角度来看，gregmac 的答案对你更有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T04:11:56.290

> 我最初的倾向是尝试仅对我的主题信息进行 SCM，因为这确实是我“拥有”的唯一东西，而其他所有东西实际上只是我平台的一部分（实际上与 Apache 或 PHP 没有什么不同）。然而，这就是我的理解崩溃的地方。我怎样才能有选择地只选择 SCM 目录结构的一部分，我怎样才能维护我正在使用的 Wordpress 的配置？

这正是我对博客进行版本控制的方式。我发现它很好用。通常，如果您正在编辑 WordPress 的文件，那么您做错了，并且在升级时会陷入困境。

为了简化这一点，我使用 TortoiseSVN。我在 Windows 资源管理器中导航到我的 /wp-content/themes/ 目录，右键单击我的自定义主题目录，然后从上下文菜单中选择*导入。*导入所有现有文件后，我对该目录进行了*签出，一切都设置好了。*

# javascript - 用 JavaScript 计算文本宽度

> ID：118241
> 
> 赞同：545
> 
> 时间：2008-09-22T23:37:52.050
> 
> 标签：javascript, textbox

我想使用 JavaScript 来计算字符串的宽度。这是否可能无需使用等宽字体？

如果它不是内置的，我唯一的想法是为每个字符创建一个宽度表，但这非常不合理，特别是支持[Unicode](http://en.wikipedia.org/wiki/Unicode)和不同的字体大小（以及所有浏览器）。

* * *

## 回答 #1

> 赞同：505
> 
> 时间：2014-01-09T08:46:45.823

在**HTML 5**中，您可以只使用[Canvas.measureText 方法（](http://www.w3schools.com/tags/canvas_measuretext.asp)[在此处](http://www.html5canvastutorials.com/tutorials/html5-canvas-text-metrics/)进一步解释）。

[试试这个小提琴](http://jsfiddle.net/eNzjZ/34/)：

```
/**
  * Uses canvas.measureText to compute and return the width of the given text of given font in pixels.
  * 
  * @param {String} text The text to be rendered.
  * @param {String} font The css font descriptor that text is to be rendered with (e.g. "bold 14px verdana").
  * 
  * @see https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript/21015393#21015393
  */
function getTextWidth(text, font) {
  // re-use canvas object for better performance
  const canvas = getTextWidth.canvas || (getTextWidth.canvas = document.createElement("canvas"));
  const context = canvas.getContext("2d");
  context.font = font;
  const metrics = context.measureText(text);
  return metrics.width;
}

function getCssStyle(element, prop) {
    return window.getComputedStyle(element, null).getPropertyValue(prop);
}

function getCanvasFontSize(el = document.body) {
  const fontWeight = getCssStyle(el, 'font-weight') || 'normal';
  const fontSize = getCssStyle(el, 'font-size') || '16px';
  const fontFamily = getCssStyle(el, 'font-family') || 'Times New Roman';

  return `${fontWeight} ${fontSize} ${fontFamily}`;
}

console.log(getTextWidth("hello there!", "bold 12pt arial"));  // close to 86 
```

如果要使用某些特定元素的字体大小`myEl`，可以使用`getCanvasFontSize`实用函数：

```
const fontSize = getTextWidth(text, getCanvasFontSize(myEl));
// do something with fontSize here... 
```

说明：该`getCanvasFontSize`函数采用某些元素的（默认情况下：`body`'s）字体并将其转换为与[Context.font 属性](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/font)兼容的格式。当然，任何元素在使用之前都必须先添加到 DOM 中，否则它会为您提供虚假值。

el.remove()); // hackfix：不要这样做！返回 el; } console.log(getTextWidth(“你好！”，getCanvasFontSize(createEl('span')))); console.log(getTextWidth("你好！", getCanvasFontSize(createEl('h1')))); ``` -->

## 更多笔记

这种方法有几个优点，包括：

*   比其他（基于 DOM）的方法更简洁、更安全，因为它不会更改全局状态，例如您的 DOM。
*   通过[修改更多的画布文本属性](http://diveintohtml5.info/canvas.html#text)（例如`textAlign`和）可以进一步定制`textBaseline`。

注意：将文本添加到 DOM 时，请记住还要考虑[padding、margin 和 border](http://api.jquery.com/outerwidth/)。

注意 2：在某些浏览器上，此方法会产生亚像素精度（结果是浮点数），而在其他浏览器上则不会（结果只是 int）。您可能希望在结果上运行`Math.floor`（或`Math.ceil`），以避免不一致。由于基于 DOM 的方法从来都不是亚像素精度的，因此这种方法比这里的其他方法具有更高的精度。

根据[这个 jsperf](http://jsperf.com/measure-text-width/4)（感谢评论中的贡献者），如果在基于 DOM 的方法中添加了缓存并且您没有使用 Firefox，那么*Canvas*方法*和*基于*DOM 的方法*几乎同样快。在 Firefox 中，出于某种原因，这种*Canvas 方法比**基于 DOM 的方法*快得多（截至 2014 年 9 月）。

 ***## 表现

[这个小提琴](http://jsfiddle.net/eNzjZ/70/)将这个 Canvas 方法与[Bob Monteverde 的基于 DOM 的方法](https://stackoverflow.com/a/5047712/2228771)的变体进行了比较，因此您可以分析和比较结果的准确性。

* * *

## 回答 #2

> 赞同：400
> 
> 时间：2008-09-22T23:40:58.250

创建一个具有以下样式的 DIV。在您的 JavaScript 中，设置您要测量的字体大小和属性，将您的字符串放入 DIV，然后读取 DIV 的当前宽度和高度。它将拉伸以适应内容，并且大小将在字符串呈现大小的几个像素内。

```
var fontSize = 12;
var test = document.getElementById("Test");
test.style.fontSize = fontSize;
var height = (test.clientHeight + 1) + "px";
var width = (test.clientWidth + 1) + "px"

console.log(height, width);
```

```
#Test
{
    position: absolute;
    visibility: hidden;
    height: auto;
    width: auto;
    white-space: nowrap; /* Thanks to Herb Caudill comment */
}
```

```
<div id="Test">
    abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ
</div>
```

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2011-02-18T23:39:25.843

这是我在没有例子的情况下拼凑在一起的。看起来我们都在同一个页面上。

```
String.prototype.width = function(font) {
  var f = font || '12px arial',
      o = $('<div></div>')
            .text(this)
            .css({'position': 'absolute', 'float': 'left', 'white-space': 'nowrap', 'visibility': 'hidden', 'font': f})
            .appendTo($('body')),
      w = o.width();

  o.remove();

  return w;
} 
```

使用它很简单：`"a string".width()`

**添加`white-space: nowrap`以便可以计算宽度大于窗口宽度的字符串。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2010-10-27T11:01:47.570

这对我有用...

```
// Handy JavaScript to measure the size taken to render the supplied text;
// you can supply additional style information too if you have it.

function measureText(pText, pFontSize, pStyle) {
    var lDiv = document.createElement('div');

    document.body.appendChild(lDiv);

    if (pStyle != null) {
        lDiv.style = pStyle;
    }
    lDiv.style.fontSize = "" + pFontSize + "px";
    lDiv.style.position = "absolute";
    lDiv.style.left = -1000;
    lDiv.style.top = -1000;

    lDiv.textContent = pText;

    var lResult = {
        width: lDiv.clientWidth,
        height: lDiv.clientHeight
    };

    document.body.removeChild(lDiv);
    lDiv = null;

    return lResult;
} 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2010-01-22T14:05:50.880

jQuery：

```
(function($) {

 $.textMetrics = function(el) {

  var h = 0, w = 0;

  var div = document.createElement('div');
  document.body.appendChild(div);
  $(div).css({
   position: 'absolute',
   left: -1000,
   top: -1000,
   display: 'none'
  });

  $(div).html($(el).html());
  var styles = ['font-size','font-style', 'font-weight', 'font-family','line-height', 'text-transform', 'letter-spacing'];
  $(styles).each(function() {
   var s = this.toString();
   $(div).css(s, $(el).css(s));
  });

  h = $(div).outerHeight();
  w = $(div).outerWidth();

  $(div).remove();

  var ret = {
   height: h,
   width: w
  };

  return ret;
 }

})(jQuery); 
```

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2018-01-09T16:30:40.710

我喜欢你做一个静态字符宽度图的“唯一想法”！它实际上很适合我的目的。有时，出于性能原因或因为您无法轻松访问 DOM，您可能只想要一个快速的 hacky 独立计算器，校准为单一字体。所以这里有一个校准到 Helvetica 的；传递一个字符串和一个字体大小：

```
const widths = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2796875,0.2765625,0.3546875,0.5546875,0.5546875,0.8890625,0.665625,0.190625,0.3328125,0.3328125,0.3890625,0.5828125,0.2765625,0.3328125,0.2765625,0.3015625,0.5546875,0.5546875,0.5546875,0.5546875,0.5546875,0.5546875,0.5546875,0.5546875,0.5546875,0.5546875,0.2765625,0.2765625,0.584375,0.5828125,0.584375,0.5546875,1.0140625,0.665625,0.665625,0.721875,0.721875,0.665625,0.609375,0.7765625,0.721875,0.2765625,0.5,0.665625,0.5546875,0.8328125,0.721875,0.7765625,0.665625,0.7765625,0.721875,0.665625,0.609375,0.721875,0.665625,0.94375,0.665625,0.665625,0.609375,0.2765625,0.3546875,0.2765625,0.4765625,0.5546875,0.3328125,0.5546875,0.5546875,0.5,0.5546875,0.5546875,0.2765625,0.5546875,0.5546875,0.221875,0.240625,0.5,0.221875,0.8328125,0.5546875,0.5546875,0.5546875,0.5546875,0.3328125,0.5,0.2765625,0.5546875,0.5,0.721875,0.5,0.5,0.5,0.3546875,0.259375,0.353125,0.5890625]
const avg = 0.5279276315789471

function measureText(str, fontSize) {
  return Array.from(str).reduce(
    (acc, cur) => acc + (widths[cur.charCodeAt(0)] ?? avg), 0
  ) * fontSize
} 
```

那个巨大的丑陋数组是由字符代码索引的 ASCII 字符宽度。所以这只支持ASCII（否则它假设一个平均字符宽度）。幸运的是，宽度基本上与字体大小成线性比例关系，因此它在任何字体大小下都能很好地工作。它明显缺乏对字距调整或连字等的任何认识。

为了“校准”，我只是在 svg 上将每个字符渲染到 charCode 126（强大的波浪号），并得到边界框并将其保存到这个数组中；[更多代码和解释和演示在这里](https://bl.ocks.org/tophtucker/62f93a4658387bb61e4510c37e2e97cf)。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2008-09-23T17:12:27.570

[ExtJS javascript 库](https://www.sencha.com/products/extjs/)有一个很棒的类，叫做 Ext.util.TextMetrics，它“为文本块提供精确的像素测量，以便您可以准确地确定给定文本块的高度和宽度（以像素为单位）”。您可以直接使用它，也可以查看其源代码以了解它是如何完成的。

[http://docs.sencha.com/extjs/6.5.3/modern/Ext.util.TextMetrics.html](http://docs.sencha.com/extjs/6.5.3/modern/Ext.util.TextMetrics.html)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-02-22T21:58:08.730

我为此写了一个小工具。也许它对某人有用。它可以**在没有 jQuery**的情况下工作。

**[https://github.com/schickling/calculate-size](https://github.com/schickling/calculate-size)**

用法：

```
var size = calculateSize("Hello world!", {
   font: 'Arial',
   fontSize: '12px'
});

console.log(size.width); // 65
console.log(size.height); // 14 
```

小提琴：http: [//jsfiddle.net/PEvL8/](http://jsfiddle.net/PEvL8/)

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-09-22T23:46:48.237

```
<span id="text">Text</span>

<script>
var textWidth = document.getElementById("text").offsetWidth;
</script> 
```

只要 <span> 标记没有应用其他样式，这应该可以工作。offsetWidth 将包括任何边框的宽度、水平填充、垂直滚动条宽度等。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-01-12T08:17:54.387

您可以使用画布，因此您不必处理太多 CSS 属性：

```
var canvas = document.createElement("canvas");
var ctx = canvas.getContext("2d");
ctx.font = "20pt Arial";  // This can be set programmaticly from the element's font-style if desired
var textWidth = ctx.measureText($("#myElement").text()).width; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-06-12T09:04:21.490

万一其他人来到这里寻找一种测量字符串宽度的方法*和*一种知道适合特定宽度的最大字体大小的方法，这里有一个基于[@Domi解决方案](https://stackoverflow.com/a/21015393)的函数，带有二进制搜索：

```
/**
 * Find the largest font size (in pixels) that allows the string to fit in the given width.
 * 
 * @param {String} text - The text to be rendered.
 * @param {String} font - The css font descriptor that text is to be rendered with (e.g. "bold ?px verdana") -- note the use of ? in place of the font size.
 * @param {Number} width - The width in pixels the string must fit in
 * @param {Number} minFontPx - The smallest acceptable font size in pixels
 * @param {Number} maxFontPx - The largest acceptable font size in pixels
 **/
function GetTextSizeForWidth(text, font, width, minFontPx, maxFontPx) {
  for (;;) {
    var s = font.replace("?", maxFontPx);
    var w = GetTextWidth(text, s);
    if (w <= width) {
      return maxFontPx;
    }

    var g = (minFontPx + maxFontPx) / 2;

    if (Math.round(g) == Math.round(minFontPx) || Math.round(g) == Math.round(maxFontPx)) {
      return g;
    }

    s = font.replace("?", g);
    w = GetTextWidth(text, s);
    if (w >= width) {
      maxFontPx = g;
    } else {
      minFontPx = g;
    }
  }
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-01-08T13:42:34.623

您也可以使用 createRange 来执行此操作，它比文本克隆技术更准确：

```
function getNodeTextWidth(nodeWithText) {
    var textNode = $(nodeWithText).contents().filter(function () {
        return this.nodeType == Node.TEXT_NODE;
    })[0];
    var range = document.createRange();
    range.selectNode(textNode);
    return range.getBoundingClientRect().width;
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-06-29T11:15:08.033

下面的代码片段，“计算”跨度标签的宽度，如果它太长，则附加“...”并减少文本长度，直到它适合其父级（或直到它尝试超过一千次）

CSS

```
div.places {
  width : 100px;
}
div.places span {
  white-space:nowrap;
  overflow:hidden;
} 
```

HTML

```
<div class="places">
  <span>This is my house</span>
</div>
<div class="places">
  <span>And my house are your house</span>
</div>
<div class="places">
  <span>This placename is most certainly too wide to fit</span>
</div> 
```

JavaScript（使用 jQuery）

```
// loops elements classed "places" and checks if their child "span" is too long to fit
$(".places").each(function (index, item) {
    var obj = $(item).find("span");
    if (obj.length) {
        var placename = $(obj).text();
        if ($(obj).width() > $(item).width() && placename.trim().length > 0) {
            var limit = 0;
            do {
                limit++;
                                    placename = placename.substring(0, placename.length - 1);
                                    $(obj).text(placename + "...");
            } while ($(obj).width() > $(item).width() && limit < 1000)
        }
    }
}); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-09-13T15:27:19.637

更好的是在显示元素之前检测文本是否适合。所以你可以使用这个不需要元素在屏幕上的功能。

```
function textWidth(text, fontProp) {
    var tag = document.createElement("div");
    tag.style.position = "absolute";
    tag.style.left = "-999em";
    tag.style.whiteSpace = "nowrap";
    tag.style.font = fontProp;
    tag.innerHTML = text;

    document.body.appendChild(tag);

    var result = tag.clientWidth;

    document.body.removeChild(tag);

    return result;
} 
```

用法：

```
if ( textWidth("Text", "bold 13px Verdana") > elementWidth) {
    ...
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-01-19T05:14:02.727

试试这个代码：

```
function GetTextRectToPixels(obj)
{
var tmpRect = obj.getBoundingClientRect();
obj.style.width = "auto"; 
obj.style.height = "auto"; 
var Ret = obj.getBoundingClientRect(); 
obj.style.width = (tmpRect.right - tmpRect.left).toString() + "px";
obj.style.height = (tmpRect.bottom - tmpRect.top).toString() + "px"; 
return Ret;
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-06-14T22:27:37.487

文本的宽度和高度可以通过`clientWidth`和`clientHeight`

```
var element = document.getElementById ("mytext");

var width = element.clientWidth;
var height = element.clientHeight; 
```

确保样式位置属性设置为绝对

```
element.style.position = "absolute"; 
```

不需要在 a 内`div`，可以在 a`p`或 a内`span`

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-04-04T12:44:11.420

根据[Deepak Nadar 的回答](https://stackoverflow.com/a/2117698/1762224)，我更改了 functions 参数以接受文本和字体样式。您不需要引用元素。此外，它们`fontOptions`具有默认值，因此您无需提供所有这些。

```
(function($) {
  $.format = function(format) {
    return (function(format, args) {
      return format.replace(/{(\d+)}/g, function(val, pos) {
        return typeof args[pos] !== 'undefined' ? args[pos] : val;
      });
    }(format, [].slice.call(arguments, 1)));
  };
  $.measureText = function(html, fontOptions) {
    fontOptions = $.extend({
      fontSize: '1em',
      fontStyle: 'normal',
      fontWeight: 'normal',
      fontFamily: 'arial'
    }, fontOptions);
    var $el = $('<div>', {
      html: html,
      css: {
        position: 'absolute',
        left: -1000,
        top: -1000,
        display: 'none'
      }
    }).appendTo('body');
    $(fontOptions).each(function(index, option) {
      $el.css(option, fontOptions[option]);
    });
    var h = $el.outerHeight(), w = $el.outerWidth();
    $el.remove();
    return { height: h, width: w };
  };
}(jQuery));

var dimensions = $.measureText("Hello World!", { fontWeight: 'bold', fontFamily: 'arial' });

// Font Dimensions: 94px x 18px
$('body').append('<p>').text($.format('Font Dimensions: {0}px x {1}px', dimensions.width, dimensions.height));
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-12-28T11:42:35.347

从头开始重写我的答案（感谢那个减号）。现在函数接受要应用的文本和 css 规则（并且不再使用 jQuery）。所以它也会尊重填充。结果值被四舍五入（你可以在那里看到 Math.round，如果你想要更精确的值，请删除）

```
function getSpan(){
    const span = document.createElement('span')
    span.style.position = 'fixed';
    span.style.visibility = 'hidden';
    document.body.appendChild(span);
    return span;
}

function textWidth(str, css) {
    const span = getSpan();
    Object.assign(span.style, css || {});
    span.innerText = str;
    const w = Math.round(span.getBoundingClientRect().width);

    span.remove();

    return w;
}

const testStyles = [
  {fontSize: '10px'},
  {fontSize: '12px'},
  {fontSize: '60px'},
  {fontSize: '120px'},
  {fontSize: '120px', padding: '10px'},
  {fontSize: '120px', fontFamily: 'arial'},
  {fontSize: '120px', fontFamily: 'tahoma'},
  {fontSize: '120px', fontFamily: 'tahoma', padding: '5px'},
];

const ul = document.getElementById('output');
testStyles.forEach(style => {
  const li = document.createElement('li');
  li.innerText = `${JSON.stringify(style)} > ${textWidth('abc', style)}`;
  ul.appendChild(li);
});
```

```
<ul id="output"></ul>
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-12-01T02:36:36.210

可以[`max-content`](https://developer.mozilla.org/en-US/docs/Web/CSS/max-content)用来测量文本的像素宽度。

这是一个实用功能。它可以选择将任何节点作为上下文来计算宽度，同时考虑任何 CSS，如`font-size`,`letter-spacing`等。

```
function measureTextPxWidth(
  text,
  template = document.createElement("span")
) {
  const measurer = template.cloneNode();
  measurer.style.setProperty("all", "revert", "important");
  measurer.style.setProperty("position", "position", "important");
  measurer.style.setProperty("visibility", "hidden", "important");
  measurer.style.setProperty("width", "max-content", "important");
  measurer.innerText = text;

  document.body.appendChild(measurer);
  const { width } = measurer.getBoundingClientRect();
  document.body.removeChild(measurer);
  return width;
}

document.querySelector('.spanTextWidth').innerText = 
  `${measureTextPxWidth('one two three')}px`

document.querySelector('.h1TextWidth').innerText = 
  `${measureTextPxWidth('one two three', document.querySelector('h1'))}px`
```

```
h1 {
  letter-spacing: 3px;
}
```

```
<span>one two three</span>
<div class="spanTextWidth"></div>

<h1>one two three</h1>
<div class="h1TextWidth"></div>
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-05-14T21:44:55.110

我想这与 Depak 条目非常相似，但基于 Louis Lazaris 的作品，该作品发表在[令人印象深刻的网页上的一篇文章中](http://www.impressivewebs.com/textarea-auto-resize/)

```
(function($){

        $.fn.autofit = function() {             

            var hiddenDiv = $(document.createElement('div')),
            content = null;

            hiddenDiv.css('display','none');

            $('body').append(hiddenDiv);

            $(this).bind('fit keyup keydown blur update focus',function () {
                content = $(this).val();

                content = content.replace(/\n/g, '<br>');
                hiddenDiv.html(content);

                $(this).css('width', hiddenDiv.width());

            });

            return this;

        };
    })(jQuery); 
```

fit 事件用于在函数关联到控件后立即执行函数调用。

例如：$('input').autofit().trigger("fit");

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-01-28T18:06:32.913

没有 jQuery：

```
String.prototype.width = function (fontSize) {
    var el,
        f = fontSize + " px arial" || '12px arial';
    el = document.createElement('div');
    el.style.position = 'absolute';
    el.style.float = "left";
    el.style.whiteSpace = 'nowrap';
    el.style.visibility = 'hidden';
    el.style.font = f;
    el.innerHTML = this;
    el = document.body.appendChild(el);
    w = el.offsetWidth;
    el.parentNode.removeChild(el);
    return w;
}

// Usage
"MyString".width(12); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-06-19T18:35:36.607

工作示例的小提琴：http: [//jsfiddle.net/tdpLdqpo/1/](http://jsfiddle.net/tdpLdqpo/1/)

HTML：

```
<h1 id="test1">
    How wide is this text?
</h1>
<div id="result1"></div>
<hr/>
<p id="test2">
    How wide is this text?
</p>
<div id="result2"></div>
<hr/>
<p id="test3">
    How wide is this text?<br/><br/>
    f sdfj f sdlfj lfj lsdk jflsjd fljsd flj sflj sldfj lsdfjlsdjkf sfjoifoewj flsdjfl jofjlgjdlsfjsdofjisdojfsdmfnnfoisjfoi  ojfo dsjfo jdsofjsodnfo sjfoj ifjjfoewj fofew jfos fojo foew jofj s f j
</p>
<div id="result3"></div> 
```

JavaScript 代码：

```
function getTextWidth(text, font) {
    var canvas = getTextWidth.canvas ||
        (getTextWidth.canvas = document.createElement("canvas"));
    var context = canvas.getContext("2d");
    context.font = font;
    var metrics = context.measureText(text);
    return metrics.width;
};

$("#result1")
.text("answer: " +
    getTextWidth(
             $("#test1").text(),
             $("#test1").css("font")) + " px");

$("#result2")
    .text("answer: " +
        getTextWidth(
             $("#test2").text(),
             $("#test2").css("font")) + " px");

$("#result3")
    .text("answer: " +
        getTextWidth(
             $("#test3").text(),
             $("#test3").css("font")) + " px"); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-06-02T21:55:09.597

> 该`Element.getClientRects()`方法返回一个对象集合，`DOMRect`这些对象指示客户端中每个 CSS 边框框的边界矩形。返回值是一个`DOMRect`对象集合，每个对象对应一个与该元素关联的 CSS 边框框。每个`DOMRect`对象都包含只读`left`、和描述边界框的属性`top`，以像素为单位，左上角相对于视口的左上角。`right``bottom`

> [Mozilla Contributors](https://developer.mozilla.org/en-US/docs/Web/API/Element/getClientRects$history)的[Element.getClientRects()在](https://developer.mozilla.org/en-US/docs/Web/API/Element/getClientRects)[CC-BY-SA 2.5](http://creativecommons.org/licenses/by-sa/2.5/)下获得许可。

将所有返回的矩形宽度相加得出总文本宽度（以像素为单位）。

```
document.getElementById('in').addEventListener('input', function (event) {
    var span = document.getElementById('text-render')
    span.innerText = event.target.value
    var rects = span.getClientRects()
    var widthSum = 0
    for (var i = 0; i < rects.length; i++) {
        widthSum += rects[i].right - rects[i].left
    }
    document.getElementById('width-sum').value = widthSum
})
```

```
<p><textarea id='in'></textarea></p>
<p><span id='text-render'></span></p>
<p>Sum of all widths: <output id='width-sum'>0</output>px</p>
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-08-07T22:18:06.457

我正在使用[text-metrics](https://www.npmjs.com/package/text-metrics)包。效果很好，我尝试了这个[解决方案](https://stackoverflow.com/a/21961146/3012785)，但由于某些原因，它算错了。

```
textMetrics.init(document.querySelector('h1'), { fontSize: '20px' });

textMetrics.init({
  fontSize: '14px',
  lineHeight: '20px',
  fontFamily: 'Helvetica, Arial, sans-serif',
  fontWeight: 400,
  width: 100,
}); 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2013-11-15T05:46:50.800

```
var textWidth = (function (el) {
    el.style.position = 'absolute';
    el.style.top = '-1000px';
    document.body.appendChild(el);

    return function (text) {
        el.innerHTML = text;
        return el.clientWidth;
    };
})(document.createElement('div')); 
```

# eclipse - 在 Mac 上打开多个 Eclipse 工作区

> ID：118243
> 
> 赞同：198
> 
> 时间：2008-09-22T23:39:24.697
> 
> 标签：eclipse, macos

如何在 Mac 上同时打开多个 Eclipse 工作区？

在其他平台上，我可以只启动额外的 Eclipse 实例，但 Mac 不允许我打开同一个应用程序两次。有没有比保留两个 Eclipse 副本更好的方法？

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2008-12-22T15:09:11.140

这似乎是 OS X 中支持的本机方法：

```
cd /Applications/eclipse/

open -n Eclipse.app 
```

一定要指定“.app”版本（目录）；在 OS X Mountain Lion 中错误地使用符号链接，例如`open -n eclipse`，可能会导致 GateKeeper 停止访问：

> 无法打开“eclipse”，因为它来自身份不明的开发人员。
> 
> 您的安全首选项只允许安装来自 Mac App Store 和已识别开发者的应用程序。

即使删除扩展属性`com.apple.quarantine`也不能解决这个问题。相反，仅使用“.app”版本将取决于您之前的同意，或提示您一次：

> “Eclipse”是从 Internet 下载的应用程序。您确定要打开它吗？

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2012-09-28T13:01:28.880

到目前为止，最好的解决方案是[http://torkild.resheim.no/2012/08/opening-multiple-eclipse-instances-on.html](http://torkild.resheim.no/2012/08/opening-multiple-eclipse-instances-on.html)中提供的 OSX Eclipse 启动器。它可以在市场[http://marketplace 中下载。 eclipse.org/content/osx-eclipse-launcher#.UGWfRRjCaHk](http://marketplace.eclipse.org/content/osx-eclipse-launcher#.UGWfRRjCaHk)

我每天都使用它并且非常喜欢它！为了演示使用的简单性，请看下图：

![演示插件用法的图像：只需转到文件/打开工作区/选择一个](https://i.stack.imgur.com/U4Tw6.png)

* * *

## 回答 #3

> 赞同：179
> 
> 时间：2008-09-22T23:52:35.463

**编辑：从 10.5 开始，** [Milhous 的回答](https://stackoverflow.com/a/386470/16562)似乎是官方支持的方式。早期版本的 OS X 甚至 10.5 及更高版本仍应使用以下说明工作。

* * *

1.  打开**命令行**（终端）

2.  导航到 Eclipse 安装文件夹，例如：

    *   `cd /Applications/eclipse/`
    *   `cd /Developer/Eclipse/Eclipse.app/Contents/MacOS/eclipse`
    *   `cd /Applications/eclipse/Eclipse.app/Contents/MacOS/eclipse`
    *   `cd /Users/<usernamehere>/eclipse/jee-neon/Eclipse.app/Contents/MacOS`
3.  启动 Eclipse：`./eclipse &`

最后一个命令将启动 eclipse 并立即将进程置于后台。

冲洗并重复以打开任意数量的唯一 Eclipse 实例。

* * *

### 警告

您可能必须**更改 Tomcat**服务器端口才能在**不同/多个 Tomcat 实例**中运行您的项目，请参阅[Tomcat 服务器错误 - 端口 8080 已在使用中](https://stackoverflow.com/a/34259707/759452)

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2016-03-07T06:43:22.963

为此，您需要导航到 Eclipse.app 目录并使用以下命令：

```
open -n Eclipse.app 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-06-26T08:16:50.303

实际上，更好的（GUI）解决方案是将 Eclipse.app 复制到例如 Eclipse2.app 中，您将在 Dock 中拥有两个 Eclipse 图标以及在 Spotlight 中拥有 Eclipse2。根据需要重复。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2010-03-05T22:17:27.193

如果问题是如何轻松地将 Eclipse 与多个*不同的*工作区一起使用，那么您必须使用 kludge，因为 OS X 中的快捷方式不提供传递命令行参数的机制，例如 Eclipse 采用的“--data”参数指定工作区。虽然创建 Eclipse 安装的副本可能有不同的原因，但为此目的，IMNSHO 很糟糕（现在您必须维护多个 Eclipse 配置、插件等？）。

无论如何，这里有一个解决方法。在（单个）Eclipse 目录（包含 Eclipse.app 的目录）中创建以下脚本，并给它一个“.command”后缀（例如 eclipse-workspace2.command），以便您可以从中创建别名：

```
#!/bin/sh
# open, as suggested by Milhous
open -n $(dirname $0)/Eclipse.app --args -data /path/to/your/other/workspace 
```

现在在您的桌面或您想要的任何地方为该文件创建一个别名。您可能必须为每个不同的工作区重复此过程，但至少它将使用相同的 Eclipse 安装。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-01-11T14:53:29.497

# 2018 年更新，因为许多答案不再有效

# 带有 Eclipse Oxygen 的 OS X Heigh Sierra (10.13)

转到安装 Eclipse 的位置。右键->显示包内容->内容->MacOS->双击名为eclipse的可执行文件

将打开一个终端窗口，并启动一个新的 eclipse 实例。

**请注意，如果您关闭终端窗口，新的 Eclipse 实例也将关闭。**

[![在此处输入图像描述](https://i.stack.imgur.com/5C09O.gif)](https://i.stack.imgur.com/5C09O.gif)

为了让您的生活更轻松，您可以将可执行文件拖到您的 Dock 上以便于访问

[![在此处输入图像描述](https://i.stack.imgur.com/qdtgq.gif)](https://i.stack.imgur.com/qdtgq.gif)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-05-21T10:25:25.280

与其复制 Eclipse.app，不如创建一个自动运行上面的 shell 脚本。

运行自动机，创建应用程序。

选择Utilities->Run shell script，并添加上面的脚本（需要eclipse的完整路径）

然后你可以把它作为一个普通的应用程序拖到你的 Dock 上。

对其他工作区重复此操作。

您甚至可以简单地更改图标 -[](https://discussions.apple.com/message/699288?messageID=699288    </div>
    <div class=)

[于 2011-05-21T10:25:25.280 回答](https://discussions.apple.com/message/699288?messageID=699288    </div>
    <div class=)[](https://discussions.apple.com/message/699288?messageID=699288    </div>
    <div class=)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-04-01T19:16:04.630

另一种方法是仅复制“Eclipse.app”文件，而不是制作整个 eclipse 目录的多个副本。右键单击“Eclipse.app”文件并单击复制选项以创建副本。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-06-27T22:33:29.650

如果你像我一样，你可能大部分时间都在运行终端。您可以像这样在 /Users//.bash_profile 中创建一个别名 alias eclipse='open -n path_to_eclipse.app'

那么你所要做的就是打开终端并输入eclipse。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-10-27T06:27:32.937

基于对我有帮助的先前答案，但目录不同：

```
cd /Applications/Eclipse.app/Contents/MacOS
./eclipse & 
```

谢谢

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-05-13T23:11:58.657

您可以创建一个 AppleScript 文件以使用给定的工作区打开 Eclipse。您甚至可以将 AppleScript 文件保存为应用程序，这相当于在 Windows 操作系统中创建带参数的别名。

打开脚本编辑器并键入以下内容：

```
do shell script "open '/path/to/your/Eclipse/installation' -n --args -data /path/to/your/workspace" 
```

例如：

```
do shell script "open '/Applications/Eclipse.app' -n --args -data /MyWorkspaces/Personal" 
```

按“运行”按钮检查它是否正常工作。

这个脚本可以这样保存，但我更喜欢将它保存为应用程序。这样，我可以通过将 *.icns 图标从原始 Eclipse.app 包复制到脚本应用程序包来自定义图标。

要打开 App 文件夹，请使用“查看内容”上下文菜单选项。它应该如下所示：

[![脚本应用程序的内容](https://i.stack.imgur.com/SPeZu.png)](https://i.stack.imgur.com/SPeZu.png)

其中“main.scpt”是 AppleScript 文件，“applet.icns”是原始 Eclipse 包中的图标。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-12-02T15:23:51.607

我不久前找到了这个解决方案，不记得在哪里，但它似乎对我来说仍然很有效。

为您要使用的每个工作区（对于此示例 ProjectB.app）创建 Eclipse.app 的副本，然后打开 ProjectB.app/Contents/MacOS/eclipse.ini 并在文件开头添加这两行：

```
-data
/Users/eric/Workspaces/projectb 
```

...替换您的工作区所在的位置。当您启动 ProjectB.app 时，它将自动从该工作区开始，而不是提示您输入位置，并且您应该能够与其他 Eclipse 实例同时运行它而没有问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-01-28T15:52:23.247

如果您想打开多个工作区并且您**不是****终端用户**，只需在您的eclipse 文件夹中找到 Unix 可执行文件并单击它。

所述文件的路径是

> Eclipse(文件夹) -> eclipse(右键) -> Show package Contents -> Contents -> MacOs -> eclipse(unix可执行文件)

单击此可执行文件将打开一个单独的 eclipse 实例。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-06-20T04:41:44.883

在终端中只需粘贴以下行并按 Enter ..

/Applications/Eclipse.app/Contents/MacOS/eclipse；出口;

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-06-25T11:24:05.750

启动终端并运行`open -n /Applications/Eclipse.app`一个新实例。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-02-19T14:02:30.970

更方便的方法：

1.  如上所述创建一个可执行脚本：

    #!/bin/sh

    cd /Applications/Adobe\ Flash\ Builder\ 4.6

    打开 -n Adob​​e\ Flash\ Builder\ 4.6.app

2.  在您当前的 Flashbuilder 或 Eclipse 实例中，添加一个新的外部工具配置。这是工具栏上调试/运行/配置文件按钮旁边的按钮。在该对话框中，单击“程序”并添加一个新程序。给它你想要的名称，然后在“位置”字段中，输入步骤 1 中脚本的路径：

    /用户/用户名/bin/flashbuilder

3.  您可以在第 2 步停止，但我更喜欢在工具栏中添加自定义图标。我使用快速启动插件来做到这一点：

    [http://sourceforge.net/projects/quicklaunch/files/](http://sourceforge.net/projects/quicklaunch/files/)

4.  添加插件后，转到“运行”->“组织快速启动”并添加步骤 2 中的外部工具配置。然后您可以为其配置图标。

5.  保存后，您将在工具栏中看到该图标。现在，您只需在每次需要新的 Flashbuilder/Eclipse 实例时单击它即可。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-08-30T05:22:32.167

您可以通过在其文件夹中为 Eclipse 应用程序创建一个假名并使用它来运行新的 Eclipse 实例来运行多个 Eclipse 实例

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-02-08T13:24:37.273

让我们尝试在 Mac 上的 Eclipse 中下载它，您将能够一次打开多个 Eclipse[链接](https://marketplace.eclipse.org/content/osx-eclipse-launcher#.UGWfRRjCaHk)

名称：macOS Eclipse 启动器

脚步 ：

1.  去日食市场。
2.  搜索“macOS Eclipse Launcher”并安装。
3.  它将重新启动。
4.  现在在文件菜单下检查打开选项>在那里你会发现其他项目也同时打开。

* * *

## 回答 #20

> 赞同：-8
> 
> 时间：2011-03-13T20:20:37.753

```
Window -> New Window 
```

这将打开一个新窗口，然后您可以在其中打开另一个项目。希望您可以将其用作解决方法。

它实际上允许您在同一个工作区中工作。

# ruby-on-rails - 在 Rails 应用程序中实现 ACL 的最佳方式是什么？

> ID：118247
> 
> 赞同：8
> 
> 时间：2008-09-22T23:40:09.610
> 
> 标签：ruby-on-rails, ruby, acl

我只是想比较在 Rails 中实现 ACL 时使用的不同解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T04:25:04.403

我使用授权插件（由[Bill Katz](http://www.billkatz.com/)创建）：

> 可以为整个应用程序、模型类或特定对象授权角色。该插件提供了一种使用 permit 和 permit 在类或实例方法级别检查授权的方法？方法。它还提供类似英语的动态方法，例如“user.is_manager_of project”（其中“user”充当授权，“manager”是角色，“project”是可授权模型）。如果授权被拒绝，您可以指定如何重定向控制。（[引用来源](http://www.vaporbase.com/postings/Authorization_in_Rails)）

主页： [http ://www.writertopia.com/developers/authorization](http://www.writertopia.com/developers/authorization)

文档：http: [//github.com/DocSavage/rails-authorization-plugin/tree/master/authorization/README.rdoc](http://github.com/DocSavage/rails-authorization-plugin/tree/master/authorization/README.rdoc)

* * *

您可能也有兴趣阅读此比较（从去年开始，但仍然有些用；这是我从上面引用的地方）： [http ://www.vaporbase.com/postings/Authorization_in_Rails](http://www.vaporbase.com/postings/Authorization_in_Rails)

以及最近的比较： [http ://steffenbartsch.com/blog/2008/08/rails-authorization-plugins/](http://steffenbartsch.com/blog/2008/08/rails-authorization-plugins/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T00:21:06.797

我发现最好的是[role_requirement](http://github.com/timcharper/role_requirement/tree/master)。它直接插入 restful_authentication 插件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T00:19:43.620

有一个名为 acl_system2 的插件，它通过用户表和角色表进行操作。[自述](http://github.com/ezmobius/acl_system2/tree/master/README)文件中有很多有用的信息，该项目也在 github 上。

# .net - 支持 OleDb 和存储过程的良好 .NET ORM 框架？

> ID：118248
> 
> 赞同：1
> 
> 时间：2008-09-22T23:40:15.103
> 
> 标签：.net, orm, oledb

我们系统中的典型存储过程接受大约 20 个左右的参数。也没有机会重构这些存储过程。我基本上求助于编写自己的代码生成器，将这些 SP 包装到（与数据库提供程序无关的）“命令”对象中，它们的公共属性对应于 SP 参数。它有效，但我更喜欢第 3 方久经考验的解决方案。

任何人都可以推荐任何东西吗？我还没有找到一个支持 OleDB 和存储过程的。

编辑：由于 SQL 6.5（信不信由你），我需要 OleDb 连接。ADO.NET 无法连接到 SQL 6.5。此外，这是一个 .NET 2.0 应用程序，所以 LinqToSql 对我没有用处。

Edit2：我已经尝试过 nHibernate 和 iBatis。它们都不适合我的需要。上次我尝试 nHibernate 时，它​​要求 SP 返回一个结果集。我的SP不是这种情况。它们都需要我手动指定参数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T00:05:17.553

我有 3 个 ORM 层的经验：

*   [亚音速](http://subsonicproject.com/)
*   [CSLA.NET](http://www.lhotka.net/cslanet/)
*   [.NET 层](http://nettiers.com)

这三个都是免费的，支持 OleDb 连接和存储过程。

Subsonic - 这是专为 Web 应用程序构建的。它模仿了 Ruby On Rails 所做的很多事情。他们只是添加了迁移。亚音速是三者中最轻的。使用 Winforms 有点困难，但没有我想象的那么难。它带有一个很好的 UI 工具来生成代码和维护数据库设置。这是唯一支持不同数据库的。我已经将它与 SQLite、SQL Server CE 和 SQL Server 一起使用。

CSLA.NET - 这个几乎可以处理几乎所有新的和闪亮的 .NET 技术。我知道作者刚刚添加了对 WCF、WPF 和 Silverlight 的支持。当我需要非常繁重的企业类型应用程序时，这就是我使用的。它有很多不错的功能，例如无限制的对象撤消、将集合标记为只读的能力，以及在任何你想要的地方移动和锚定对象的能力。这是最接近 JBoss 在 Java 上所做的事情。

Net Tiers - 我不是一个大粉丝，但它会完成工作。它比 CSLA 轻，但仍比 Subsonic 重。

我还要提到[NHibernate](http://www.hibernate.org/343.html)、[Castle Active Record](http://www.castleproject.org/activerecord/index.html)和[Microsoft Enterprise Library](http://www.codeplex.com/entlib)。不过我对这些没有太多经验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T23:53:08.237

据我所知，ADO .NET Entitry 框架对存储过程的支持很少……LINQ2SQL 你可以让它工作，但可能需要某种代理类……NHibernate 和 IBatis 是你最好的选择……

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-22T23:49:51.880

备择方案：

1.  LINQ 到 SQL
2.  ADO.NET 实体框架
3.  休眠
4.  你的选择 ）

# python - 如何在不使用 Windows Vista 上的快捷方式的情况下启动 IDLE（Python 编辑器）？

> ID：118260
> 
> 赞同：48
> 
> 时间：2008-09-22T23:44:21.877
> 
> 标签：python, python-idle, komodo, pywin

当我击中正确的按键时，我正在尝试教 Komodo 启动[IDLE 。](http://en.wikipedia.org/wiki/IDLE_(Python))我可以使用 Windows Explorer 位置栏中开始菜单中快捷方式的确切路径来启动 IDLE，所以我希望 Komodo 也能够使用它。但是，将这条路径提供给 Komodo 会导致它说返回 1。这似乎是一个失败，因为 IDLE 没有启动。

我想我会避开捷径，只使用确切的路径。我去开始菜单，找到IDLE的快捷方式，右键查看属性。目标显示为灰色，但显示“Python 2.5.2”。“开始于”设置为“C:\Python25\”。“打开文件位置”按钮也显示为灰色。

我如何找出这个快捷方式真正指向的位置？我尝试在 C:\Python25 中启动 python.exe 和 pythonw.exe，但都没有启动 IDLE。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-09-22T23:49:11.273

`idle.py`在你的 Python 安装目录中有一个名为`Lib\idlelib\idle.py`.

如果您使用 Python 运行该文件，则 IDLE 应该会启动。

> c:\Python25\pythonw.exe c:\Python25\Lib\idlelib\idle.py

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-09-12T21:48:51.350

在 Python 3.2.2 中，我发现`\Python32\Lib\idlelib\idle.bat`这很有用，因为它可以让我打开在 IDLE 中作为 args 提供的 python 文件。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-22T23:56:03.393

这是您可以使用的另一条路径。我不确定这是否是标准发行版的一部分，或者该文件是否是在首次使用 IDLE 时自动创建的。

```
C:\Python25\Lib\idlelib\idle.pyw 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-11-23T04:35:54.310

如果您只运行 Python shell，请键入：

```
import idlelib.PyShell
idlelib.PyShell.main() 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-02-21T11:33:34.420

有一个 .bat 脚本可以启动它（python 2.7）。

```
c:\Python27\Lib\idlelib\idle.bat 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-08-02T18:05:55.023

Python 安装文件夹 > Lib > idlelib > idle.pyw

双击它，你就可以开始了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-08T10:51:18.877

您也可以直接将热键分配给 Windows 快捷方式（至少在 Windows 95 中可以，从那时起我没有再次检查过，但我认为该选项应该仍然存在^_^）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-06T18:06:16.727

空闲快捷方式是“广告快捷方式”，它破坏了某些功能，如“查找目标”按钮。谷歌了解更多信息。

您可以使用十六进制编辑器查看链接或下载[LNK Parser](https://code.google.com/p/lnk-parser/)以查看它指向的位置。

就我而言，它运行：
`..\..\..\..\..\Python27\pythonw.exe "C:\Python27\Lib\idlelib\idle.pyw"`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-11T23:10:12.210

我设置了一个快捷方式（使用 Windows）并将目标设置为

```
C:\Python36\pythonw.exe c:/python36/Lib/idlelib/idle.py 
```

效果很好

还发现这个作品

```
with open('FILE.py') as f:
    exec(f.read()) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-12-29T00:48:36.690

Windows 的另一个选项将自动使用已安装的最新版本的 Python，并且也不会让您查找安装路径：

目标：`pyw -m idlelib`
开始：任何你想要的地方

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-30T20:20:31.547

我有一个空闲（Python GUI）的快捷方式。

*   单击左下角的 Window 图标或使用 Window Key (仅 Python 2)，您将看到 Idle (Python GUI) 图标
*   右键单击图标然后更多
*   打开文件所在位置
*   将出现一个新窗口，您将看到 Idle (Python GUI) 的快捷方式
*   右键单击，按住并拉出到桌面，在桌面上创建 Python GUI 的快捷方式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-04-08T20:02:41.840

Python 安装文件夹 > Lib > idlelib > idle.pyw

发送快捷方式到桌面。

您也可以从桌面快捷方式将其添加到任务栏以便快速访问。

希望这可以帮助。

# .net - asp.net 进程中长时间运行的代码

> ID：118261
> 
> 赞同：5
> 
> 时间：2008-09-22T23:45:00.393
> 
> 标签：.net, asp.net

例如，我们在 asp.net 形式的 codebihind 中的这段代码：

```
private void btnSendEmails_OnClick()
{
    Send100000EmailsAndWaitForReplies();
} 
```

此代码执行将被超时原因终止。为了解决这个问题，我希望看到这样的事情：

```
private void btnSendEmails_OnClick()
{
    var taskId = AsyncTask.Run( () =>  Send100000EmailsAndWaitForReplies() );
    // Store taskId for future task execution status checking.
} 
```

并且此方法将在特殊环境中的 w3wp.exe 进程之外以某种方式执行。

有人知道解决此类问题的框架/工具集吗？

**更新：**电子邮件发送方法只是我的意思的一个例子。事实上，我可能有很多功能需要在 asp.net 工作进程之外执行。

例如，这一点对于聚合来自几个 3rd 方服务的数据、对其进行处理并将其发送回另一个服务的应用程序非常重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-22T23:53:46.893

这已作为其他问题的一部分进行了讨论：

[asp.net 中的多线程](https://stackoverflow.com/questions/50221/multithreading-in-aspnet#50377)

[ASP.NET 中的 BackgroundWorker 线程](https://stackoverflow.com/questions/57845/backgroundworker-thread-in-aspnet)

没有好的方法可以做到这一点。您不希望 ASP.NET 工作进程中有任何长时间运行的进程，因为它可能会在您完成之前回收。

编写一个 Windows 服务在后台运行，为您完成工作。将消息放入 MSMQ 以启动任务。然后他们可以想跑多久就跑多久。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-10T18:56:06.430

1.  [QueueBackgroundWorkItem](http://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)我的示例显示发送电子邮件。
2.  [HangFire](http://hangfire.io/) 开源项目适用于共享主机。
3.  在 Azure 上，您可以使用[WebJobs](http://www.asp.net/aspnet/overview/developing-apps-with-windows-azure/azure-webjobs-recommended-resources)。
4.  在 Azure 上，[云服务](http://azure.microsoft.com/en-us/documentation/articles/cloud-services-dotnet-get-started/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T23:52:25.633

我可以想到两条可能的路径：

1.  您可以创建一个托管远程对象的 Windows 服务，并让您的 Web 应用程序调用该远程对象，以确保该方法在 IIS 进程空间之外执行。
2.  您可以设置要记录请求的 DB 或 MSMQ。然后，您的 Web 应用程序可以监视请求的状态，以便随后通知用户它已完成。我会设想一个完成请求的服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-09T08:21:04.203

ASP.NET 托管环境对于任何长时间运行的进程（无论是 CPU 还是 I/O 消耗）都是非常危险的，因为可能会发生突然的 AppDomain 卸载。

如果您想在请求处理管道之外执行后台任务，请考虑使用[http://hangfire.io](http://hangfire.io)，它为您处理后台处理的所有困难和风险，无需安装额外的 windows 服务（但可以使用他们，到时候）。也有一个[邮件发送教程](http://docs.hangfire.io/en/latest/tutorials/send-email.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T23:50:10.897

一种选择是让任务执行一定数量的电子邮件，然后 Response.Redirect 回到自身并重复，直到所有电子邮件都已发送。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T23:53:21.077

您可以将发送邮件的功能作为服务运行。向它提交请求，并让它处理它。每隔一段时间查询一下它的状态。如果您可以控制服务器，则可以安装 Windows 服务，这可能是优化处理和生命周期管理的理想选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-22T23:53:42.073

ASP.NET 2.0+ 支持异步页面的概念。将页面指令 Async="true" 添加到您的页面。

然后在 Page_Load 中，使用 BeginEventHandler 和 EndEventHandler 委托在相应的“处理程序”中异步执行代码。

```
<%@ Page Language="C#" Async="true" %>
<script runat="server">

  protected void Page_Load(object sender, EventArgs e)
  {
    BeginEventHandler begin = new BeginEventHandler(BeginMethod);
    EndEventHandler  end = new EndEventHandler(EndMethod);

    AddOnPreRenderCompleteAsync(begin, end);
  }
</script> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-27T08:52:33.890

当您的站点由共享托管服务提供商托管时，通常不可能运行自定义 Windows 服务。运行一个单独的线程让你定期进入睡眠状态可能会不一致，因为 IIS 会不时地回收你的线程，甚至在 cofig 文件中或通过代码设置脚本执行属性也不会确保你的线程不会被杀死和回收。

我遇到了一个基于缓存过期的方法，考虑到共享托管服务上可用的方法可能是最安全的，即最一致的选择。这篇文章很好地解释了它，并在文章末尾提供了一个作业队列类来帮助管理您的计划作业，请在此处查看 - [http://www.codeproject.com/KB/aspnet/ASPNETService.aspx](http://www.codeproject.com/KB/aspnet/ASPNETService.aspx)

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2008-09-22T23:52:57.333

Server.ScriptTimeout = 360000000;

# c# - 嵌入 Webkit 时操作页面的最佳方法是什么？

> ID：118270
> 
> 赞同：2
> 
> 时间：2008-09-22T23:47:16.317
> 
> 标签：c#, javascript, html, dom, webkit

我正在使用 Webkit-sharp 将 Webkit 嵌入到应用程序中，我需要挂钩某些链接以在我的应用程序中执行操作，而不是它们的正常操作。

我考虑过使用 Javascript 来遍历锚标记并替换与正确链接匹配的标记，但我想知道这是否是最好的方法。有这样做的首选方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T23:53:55.567

jQuery 有很多有用的迭代特性可以用于此目的。:-) 我没有使用过 jQuery，但[`find`](http://docs.jquery.com/Traversing/find)看起来[`attr`](http://docs.jquery.com/Attributes/attr)很有希望用于您的目的。

# java - 如何解决内部类的循环依赖？

> ID：118272
> 
> 赞同：2
> 
> 时间：2008-09-22T23:47:54.380
> 
> 标签：java, circular-dependency, anonymous-inner-class

（Java问题）

如果我引用内部类中的字段，这会导致封闭类和内部类之间的循环依赖吗？

我怎样才能避免这种情况？

这是一个例子：

```
public class Outer {

  private Other o;
  private Inner i;    

  public Outer() {
    o = new Other();

    i = new Inner() {
      public void doSomething() {
        o.foo();
      }
    };

  }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-23T01:42:01.753

**静态与实例类：**如果将内部类声明为静态，则内部类的实例对外部类没有任何引用。如果它不是 satic，那么您的内部对象将有效地指向创建它的外部对象（它有一个隐式引用，事实上，如果您在其构造函数上使用反射，您将看到一个用于接收外部实例的额外参数）。

**内部实例指向外部实例：**循环引用是在每个实例指向另一个实例的情况下。很多时候，您使用内部类来优雅地实现某些接口并访问私有字段，而不是使用外部类来实现接口。它确实意味着内部实例指向外部实例，但并不意味着相反。不需要循环引用。

**结束循环：**无论如何，Java 中的循环引用没有任何问题。对象工作得很好，当它们没有被更多引用时，它们就会被垃圾收集。他们是否互相指向都没关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-22T23:58:49.050

您在示例中使用的语法有点偏离，没有声明类或接口 Inner。但是这个例子的概念没有任何问题。在 Java 中它可以正常工作。

我不确定你在这里做什么，但你可能想考虑一个更简单的可维护性设计等。

匿名事件处理程序引用其父类的元素是一种常见模式，因此如果是这种情况，没有理由避免它，这就是 Java 的设计方式，而不是函数指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T00:49:15.263

（不确定这是否是您要问的......）

在运行时，内部类具有对其所属外部类实例的隐式引用。因此，每当您传递内部类实例时，您也会传递外部类实例。
您可以通过将内部类声明为“静态”来避免这种情况，但这意味着内部类无法访问外部类的成员变量。因此，在这种情况下，如果要访问外部类的成员，则需要将其显式传递给内部类（使用 setter 或使用内部类的构造函数）。

# jquery - 试图在 IE6 中调整 jQuery 对话框的大小？

> ID：118280
> 
> 赞同：3
> 
> 时间：2008-09-22T23:50:32.863
> 
> 标签：jquery, css, jquery-ui, modal-dialog, jquery-ui-dialog

我以为我在 jQuery 网站上看到过关于此的错误报告，但现在我找不到它。我正在尝试在 IE6 中调整对话框的大小。但是当元素调整大小时，内容和标题栏不会缩小。但是，如果对话框变大，它们会调整大小。结果是关闭按钮最终被切断，并且如果用户将对话框的大小调整为更小，内容将被剪裁。

我已经尝试处理 resizeStop 事件并手动调整内容和标题栏的大小，但这会给我带来奇怪的结果。内容区域中元素的大小和位置仍然不正确。此外，即使我调整了标题栏的大小，关闭按钮仍然没有移回视图。有任何想法吗？如果这是 jQuery-ui 中的一个错误，有没有人知道一个好的解决方法？

```
<html>
<head>
  <title>Example of IE6 resize issue</title>
  <link rel="stylesheet" type="text/css" href="http://ui.jquery.com/repository/latest/themes/flora/flora.all.css" />
  <script src="http://www.google.com/jsapi"></script>
  <script>        
    google.load("jquery", "1");        
    google.load("jqueryui", "1");        
    google.setOnLoadCallback(        
    function() {                
      $(document).ready(function()        
      {            
        $("#main-dialog").dialog();        
      });    
    });
    </script>
</head>
<body>
    <div id="main-dialog">    
      This is just some simple content that will fill the dialog. This example is    
      sufficient to reproduce the problem in IE6\. It does not seem to occur in IE7    
      or FF. I haven't tried with Opera or Safari.
    </div>
</body> 
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T21:29:39.393

我能够想出一个解决方案。如果将样式**overflow: hidden**添加到对话框容器 div 元素（应用了 css 类 .ui-dialog-container），那么所有内容都会正确调整大小。我所做的只是在植物主题中添加如下 CSS 规则：

```
.ui-dialog .ui-dialog-container {
  overflow: hidden;
} 
```

也可以通过执行以下操作来纠正：

```
if ($.browser.msie && $.browser.version == 6)
{
  $(".ui-dialog-container").css({ overflow: 'hidden' });
} 
```

这纠正了我在 IE6 下看到的问题，并且没有在 FireFox 中引入任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T09:31:54.150

CSS可能是一个因素。你能改变你的例子，以便我们可以看到你的样式表吗？我已经更新了这个例子，使它不依赖于本地的 jQuery。

```
<html>
<head>
<title>Example of IE6 resize issue</title>
<link rel="stylesheet" type="text/css" href="?.css" />
<script src="http://www.google.com/jsapi"></script>
<script>
    google.load("jquery", "1");
    google.load("jqueryui", "1");

    google.setOnLoadCallback(
    function() {
        $(document).ready(function()
        {
            $("#main-dialog").dialog();
        });
    });
</script>
</head>
<body>
<div id="main-dialog">
    This is just some simple content that will fill the dialog. This example is
    sufficient to reproduce the problem in IE6\. It does not seem to occur in IE7
    or FF. I haven't tried with Opera or Safari.
</div>
</body> 
</html> 
```

# perl - 如何使用 GetOpt::Long::GetOptions 解析字符串？

> ID：118289
> 
> 赞同：7
> 
> 时间：2008-09-22T23:52:56.070
> 
> 标签：perl, getopt-long

我有一个带有可能命令行参数的字符串（使用 Read-Eval-Print-Loop 程序），我希望它在传递给 Getopt::Long 时被解析为类似于命令行参数。

详细说明：

我有一个字符串

```
$str = '--infile /tmp/infile_location --outfile /tmp/outfile' 
```

我希望它由 GetOptions 解析，以便我更容易添加新选项。

我能想到的一种解决方法是将字符串拆分为空格并用新数组替换@ARGV，然后调用GetOptions。就像是 ...

```
my @arg_arr = split (/\s/, $input_line);

# This is done so that GetOptions reads these new arguments
@ARGV = @arg_arr;
print "ARGV is : @ARGV\n";
GetOptions (
            'infile=s'  => \$infile,
            'outfile=s' => \$outfile
           ); 
```

有什么好的/更好的方法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-23T00:15:42.287

查看[Getopt::Long 手册页中](http://perldoc.perl.org/Getopt/Long.html)[任意字符串的部分解析选项](http://perldoc.perl.org/Getopt/Long.html#Parsing-options-from-an-arbitrary-string)，我认为它完全符合您的要求。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-23T00:05:50.657

不要在空格上拆分，而是使用内置的 glob 函数。除了在空格上拆分之外，这将执行标准命令行扩展，然后返回一个列表。（例如 * 会给出文件列表等。）我还建议按照一般原则对 @ARG 进行本地化。

~~除此之外，这是不重写 GetOptions 的唯一方法。~~ （显然我需要更仔细地阅读文档。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-23T00:23:36.807

哇！！！

我想我可以同时使用本蒂利和地诺米特的答案并执行以下操作：

*   使用 glob 执行标准命令行扩展
*   将 glob 后的数组传递给 GetOpt::Long 的 GetOptionsFromArray 方法（参见[此处](http://search.cpan.org/~jv/Getopt-Long-2.37/lib/Getopt/Long.pm#Parsing_options_from_an_arbitrary_array)）

代码可能看起来像...

```
GetOptionsFromArray ([glob ($input_line)]); 
```

那只是一行..很酷（我知道我必须做一些错误检查等）..但它很酷...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T07:22:56.410

当您在用户输入以外的其他内容上使用 Getopt::Long 时，请注意某些功能会根据 POSIXLY_CORRECT 环境变量而有所不同。您可以通过对配置的适当调用来覆盖它。

[强制性 POSIXLY_CORRECT 轶事](http://everything2.com/node/877243)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T10:57:15.943

似乎 GetOptionsFromArray 和 GetOptionsFromString 方法仅在 v2.36 中添加，墨菲会说我只有 2.35 版。

现在，我想我将不得不与当地的@ARGV 一起生活。

# c# - 替代 String.Replace

> ID：118292
> 
> 赞同：18
> 
> 时间：2008-09-22T23:53:10.967
> 
> 标签：c#, regex, string, replace

所以我今天写了一些代码，基本上是这样的：

```
string returnString = s.Replace("!", " ")
            .Replace("@", " ")
            .Replace("#", " ")
            .Replace("$", " ")
            .Replace("%", " ")
            .Replace("^", " ")
            .Replace("*", " ")
            .Replace("_", " ")
            .Replace("+", " ")
            .Replace("=", " ")
            .Replace("\", " ") 
```

这不是很好。我想知道是否有一个正则表达式或我可以编写的东西来替换对`Replace()`函数的所有调用？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-22T23:55:23.693

您可以使用**Regex.Replace()**。所有字符都可以放在方括号之间，这与方括号之间的任何字符匹配。一些特殊字符必须用反斜杠转义，我在这里使用@verbatim 字符串，所以我不必为 C# 编译器双重转义它们。第一个参数是输入字符串，最后一个参数是替换字符串。

```
var returnString = Regex.Replace(s,@"[!@#\$%\^*_\+=\\]"," "); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T00:21:48.310

仅供参考 - 如果您需要修改此正则表达式，您需要了解正则表达式语言。这很简单，作为一名开发人员，你真的应该为你自己添加正则表达式到你的工具箱中——你不需要每天都需要它们，但是当需要时能够在必要时适当地应用它们会给你带来回报十倍于最初的努力。这是一个网站的链接，其中包含一些一流的、易于遵循的教程和有关正则表达式的参考资料：[regular-expressions.info](http://www.regular-expressions.info/)。一旦您对正则表达式有所了解并想在您的软件中使用它们，您就会想购买 Regex Buddy。它是学习和使用正则表达式的廉价而非凡的工具。我*很*很少购买开发工具，但这个值得每一分钱。它在这里：正则[表达式好友](http://www.regexbuddy.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T23:57:18.383

```
s/[!@#$%^*_+=\]/ / 
```

将是它的正则表达式......在c＃中你应该能够使用

```
Regex.Replace(yourstring, "[!@#$%^*_+=\]", "" ); 
```

虽然我的 C# 生锈了..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T01:38:52.103

如果您不想深入研究 Regex，这里有一些其他扩展方法的可能性。

您可以传入要替换的特定字符：

```
static public string ReplaceCharsWithSpace(this string original, string chars)
{
    var result = new StringBuilder();
    foreach (var ch in original)
    {
        result.Append(chars.Contains(ch) ? ' ' : ch);
    }
    return result.ToString();
} 
```

或者，如果您知道您只想保留或仅删除特定类型的字符，您可以使用 中的各种方法`char`，例如`IsLetter`、`IsDigit`、`IsPunctuation`和`IsSymbol`：

```
static public string ReplaceNonLetterCharsWithSpace(this string original)
{
    var result = new StringBuilder();
    foreach (var ch in original)
    {
        result.Append(char.IsLetter(ch) ? ch : ' ');
    }
    return result.ToString();
} 
```

以下是您如何使用这些可能性：

```
string s = "ab!2c";
s = s.ReplaceCharsWithSpace(@"!@#$%^*_+=/");  // s contains "ab  c"

string t = "ab3*c";
t = t.ReplaceNonLetterCharsWithSpace();  // t contains "ab  c" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T02:37:30.363

如果需要，您可以通过使用 Lambda 表达式和`List<>, ForEach`

```
using System.Collections.Generic;

namespace ReplaceWithSpace 
 {
    class Program 
    {
        static void Main(string[] args) 
        {
            string someString = "#1, 1+1=2 $string$!";

            var charsToRemove = new List<char>(@"!@#$%^*_+=\");
            charsToRemove.ForEach(c => someString = someString.Replace(c, ' '));

            System.Diagnostics.Debug.Print(someString); //" 1, 1 1 2  string  "
        }
    }

} 
```

# php - 在 PHP 中将 UTF-8 字符串转换为/从 7 位 XML

> ID：118305
> 
> 赞同：2
> 
> 时间：2008-09-22T23:55:02.883
> 
> 标签：php, html, xml, unicode, utf-8

UTF-8 字符串（即 8 位字符串）如何与 XML 兼容的 7 位字符串（即带有数字实体的可打印 ASCII）相互转换？

即`encode()`这样的函数：

```
encode("“£”") -> "&#8220;&#163;&#8221;" 
```

`decode()`也很有用：

```
decode("&#8220;&#163;&#8221;") -> "“£”" 
```

PHP 的`htmlenties()`/`html_entity_decode()`对没有做正确的事情：

```
htmlentities(html_entity_decode("&#8220;&#163;&#8221;")) ->
  "&amp;#8220;&pound;&amp;#8221;" 
```

费力地指定类型会有所帮助，但仍会返回与 XML 不兼容的命名实体，而不是数字实体：

```
htmlentities(html_entity_decode("&#8220;&#163;&#8221;", ENT_QUOTES, "UTF-8"), ENT_QUOTES, "UTF-8") ->
  "&ldquo;&pound;&rdquo;" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-11T12:24:50.727

[`mb_encode_numericentity`](http://php.net/manual/en/function.mb-encode-numericentity.php)正是这样做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T21:16:27.267

这是一种解决方法，但我阅读了一些内容，但我`iconv()`认为它不会为您提供数字实体（未经过测试）

```
function decode( $string )
{
  $doc = new DOMDocument( "1.0", "UTF-8" ); 
  $doc->LoadXML( '<?xml version="1.0" encoding="UTF-8"?>'."\n".'<x />', LIBXML_NOENT );
  $doc->documentElement->appendChild( $doc->createTextNode( $string ) );
  $output = $doc->saveXML( $doc );
  $output = preg_replace( '/<\?([^>]+)\?>/', '', $output ); 
  $output = str_replace( array( '<x>', '</x>' ), array( '', '' ), $output );
  return trim( $output );
} 
```

但是，我已经对此进行了测试。稍后我可能会做相反的事情，只是不要屏住呼吸;-)

# linux - 一种确定进程“真实”内存使用情况的方法，即私有脏 RSS？

> ID：118307
> 
> 赞同：57
> 
> 时间：2008-09-22T23:55:44.957
> 
> 标签：linux, macos, memory, memory-management, freebsd

'ps' 和 'top' 之类的工具会报告各种内存使用情况，例如 VM 大小和驻留集大小。但是，这些都不是“真正的”内存使用：

*   程序代码在同一程序的多个实例之间共享。
*   共享库程序代码在使用该库的所有进程之间共享。
*   一些应用程序分叉进程并与它们共享内存（例如，通过共享内存段）。
*   虚拟内存系统使 VM 大小报告几乎毫无用处。
*   当进程被换出时，RSS 为 0，因此它不是很有用。
*   等等等等。

我发现 Linux 报告的私有脏 RSS 是最接近“真实”内存使用的东西。这可以通过将 中的所有`Private_Dirty`值相加来获得`/proc/somepid/smaps`。

但是，其他操作系统是否提供类似的功能？如果没有，有什么替代方案？特别是，我对 FreeBSD 和 OS X 很感兴趣。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-12-23T19:15:34.180

在 OSX 上，活动监视器实际上给你一个很好的猜测。

私有内存肯定是仅由您的应用程序使用的内存。例如堆栈内存和所有使用 malloc() 和类似函数/方法（Objective-C 的分配方法）动态保留的内存都是私有内存。如果你分叉，私人内存将与你的孩子共享，但标记为写时复制。这意味着只要页面没有被任何一个进程（父进程或子进程）修改，它就会在它们之间共享。只要任一进程修改任何页面，该页面就会在被修改之前被复制。即使此内存与 fork 子共享（并且**只能**与 fork 子共享），它仍然显示为“私有”内存，因为在最坏的情况下，它的每一页都会被修改（迟早）并且然后它再次对每个进程都是私有的。

共享内存要么是当前共享的内存（相同的页面在不同进程的虚拟进程空间中可见），要么是将来可能共享的内存（例如只读内存，因为没有理由不共享 read -仅记忆）。至少我是这样从 Apple 读取一些命令行工具的源代码的。因此，如果您使用 mmap（或将相同内存映射到多个进程的类似调用）在进程之间共享内存，这将是共享内存。然而，可执行代码本身也是共享内存，因为如果您的应用程序的另一个实例启动，它没有理由不共享已加载到内存中的代码（可执行代码页默认为只读，除非您正在运行您的调试器中的应用程序）。因此，共享内存实际上是您的应用程序使用的内存，

实际内存是当前“分配”给您的进程的 RAM 量，无论是私有的还是共享的。这可以恰好是私有和共享的总和，但通常不是。您的进程分配给它的内存可能比它当前需要的多（这会加快将来对更多内存的请求），但这不会对系统造成任何损失。如果另一个进程需要内存并且没有可用内存，在系统开始交换之前，它会从你的进程中取出多余的内存并分配给另一个进程（这是一个快速而轻松的操作）；因此，您的下一次 malloc 调用可能会慢一些。实际内存也可以小于私有和物理内存；这是因为如果您的进程向系统请求内存，它只会收到“虚拟内存”。只要您不使用此虚拟内存，它就不会链接到任何实际内存页面（因此 malloc 10 MB 内存，仅使用其中一个字节，您的进程将只获得一个分配的内存页面，4096 字节- 其余部分仅在您真正需要时才分配）。交换的更多内存也可能不计入实际内存（对此不确定），但它将计入共享和私有内存。

虚拟内存是您的应用程序进程空间中被认为有效的所有地址块的总和。这些地址可能链接到物理内存（同样是私有的或共享的），也可能不链接，但在这种情况下，一旦您使用该地址，它们就会链接到物理内存。访问已知地址之外的内存地址将导致 SIGBUS 并且您的应用程序将崩溃。交换内存时，该内存的虚拟地址空间保持有效，访问这些地址会导致内存被换回。

**结论：**
如果您的应用程序没有显式或隐式使用共享内存，则私有内存是您的应用程序所需的内存量，因为堆栈大小（或多线程大小）以及您为动态内存进行的 malloc() 调用。在这种情况下，您不必非常关心共享内存或真实内存。

如果您的应用程序使用共享内存，并且这包括一个图形 UI，例如，内存在您的应用程序和 WindowServer 之间共享，那么您可能也会查看共享内存。一个非常高的共享内存数量可能意味着您目前在内存中加载了太多的图形资源。

应用程序开发对真实内存没有多大兴趣。如果它大于共享和私有的总和，那么这意味着系统懒惰地从您的进程中取出内存。如果它更小，那么你的进程请求的内存比它实际需要的多，这也不错，因为只要你不使用所有请求的内存，你就不会从系统中“窃取”内存。如果它远小于共享和私有的总和，您可能只考虑在可能的情况下请求更少的内存，因为您有点过度请求内存（同样，这还不错，但它告诉我您的代码不是针对最小内存使用进行了优化，如果它是跨平台的，其他平台可能没有如此复杂的内存处理，

如果您仍然对所有这些信息不满意，您可以获得更多信息。打开终端并运行：

```
sudo vmmap <pid> 
```

您的进程的进程 ID 在哪里。这将向您显示进程空间中每个内存块的统计信息**以及**开始和结束地址。它还会告诉您此内存来自哪里（映射文件？堆栈内存？Malloc 内存？可执行文件的 __DATA 或 __TEXT 部分？），它有多大（KB），访问权限以及它是否是私有的，共享或写时复制。如果它是从文件映射的，它甚至会为您提供文件的路径。

如果您只想“实际”使用 RAM，请使用

```
sudo vmmap -resident <pid> 
```

现在它将为每个内存块显示该内存块实际上有多大，以及它当前实际存在于物理内存中的有多少。

在每个转储的末尾还有一个概述表，其中包含不同内存类型的总和。对于我的系统上的 Firefox，此表现在看起来像这样：

```
REGION TYPE             [ VIRTUAL/RESIDENT]
===========             [ =======/========]
ATS (font support)      [   33.8M/   2496K]
CG backing stores       [   5588K/   5460K]
CG image                [     20K/     20K]
CG raster data          [    576K/    576K]
CG shared images        [   2572K/   2404K]
Carbon                  [   1516K/   1516K]
CoreGraphics            [      8K/      8K]
IOKit                   [  256.0M/      0K]
MALLOC                  [  256.9M/  247.2M]
Memory tag=240          [      4K/      4K]
Memory tag=242          [     12K/     12K]
Memory tag=243          [      8K/      8K]
Memory tag=249          [    156K/     76K]
STACK GUARD             [  101.2M/   9908K]
Stack                   [   14.0M/    248K]
VM_ALLOCATE             [   25.9M/   25.6M]
__DATA                  [   6752K/   3808K]
__DATA/__OBJC           [     28K/     28K]
__IMAGE                 [   1240K/    112K]
__IMPORT                [    104K/    104K]
__LINKEDIT              [   30.7M/   3184K]
__OBJC                  [   1388K/   1336K]
__OBJC/__DATA           [     72K/     72K]
__PAGEZERO              [      4K/      0K]
__TEXT                  [  108.6M/   63.5M]
__UNICODE               [    536K/    512K]
mapped file             [  118.8M/   50.8M]
shared memory           [    300K/    276K]
shared pmap             [   6396K/   3120K] 
```

这告诉我们什么？例如，Firefox 二进制文件和它加载的所有库在它们的 __TEXT 部分中共有 108 MB 数据，但目前只有 63 MB 驻留在内存中。字体支持 (ATS) 需要 33 MB，但实际上只有大约 2.5 MB 在内存中。它使用超过 5 MB 的 CG 后备存储，CG = Core Graphics，它们很可能是为快速绘图而缓存的窗口内容、按钮、图像和其他数据。它通过 malloc 调用请求了 256 MB，目前 247 MB​​ 实际映射到内存页面。它为堆栈保留了 14 MB 的空间，但现在只有 248 KB 的堆栈空间真正在使用。

vmmap在表格上方也有很好的总结

```
ReadOnly portion of Libraries: Total=139.3M resident=66.6M(48%) swapped_out_or_unallocated=72.7M(52%)
Writable regions: Total=595.4M written=201.8M(34%) resident=283.1M(48%) swapped_out=0K(0%) unallocated=312.3M(52%) 
```

这显示了 OS X 的一个有趣的方面：​​对于来自库的只读内存，如果它被换出或简单地未分配，它就不起作用；只有居民，没有居民。对于可写内存，这会有所不同（在我的情况下，所有请求的内存中有 52% 从未被使用过并且未分配，0% 的内存已被换出到磁盘）。

原因很简单：映射文件中的只读内存不会被交换。如果系统需要内存，则简单地从进程中删除当前页面，因为内存已经“交换”了。它仅包含直接从文件映射的内容，并且可以在需要时重新映射此内容，因为文件仍然存在。这样，该内存也不会浪费交换文件中的空间。只有可写内存在被删除之前必须首先交换到文件，因为它的内容之前没有存储在磁盘上。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-10-12T02:08:51.500

在 Linux 上，您可能需要 /proc/self/smaps 中的 PSS（比例集大小）数字。映射的 PSS 是其 RSS 除以使用该映射的进程数。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-23T01:57:15.273

Top知道如何做到这一点。它在 Debian Linux 上默认显示 VIRT、RES 和 SHR。VIRT = 交换 + RES。RES = 代码 + 数据。SHR 是可以与另一个进程（共享库或其他内存）共享的内存。

此外，“脏”内存只是已使用和/或尚未交换的 RES 内存。

这可能很难说，但最好的理解方法是查看一个没有交换的系统。那么，RES-SHR就是进程独占内存。但是，这不是一个很好的查看方式，因为您不知道 SHR 中的内存正在被另一个进程使用。它可能表示仅由进程使用的未写入的共享对象页面。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-29T18:06:25.947

你真的不能。

我的意思是，进程之间的共享内存......你要数它吗？如果你不计算它，你就错了；所有进程的内存使用量的总和不会是总内存使用量。如果你数它，你将数它两次——总和不会是正确的。

我，我对 RSS 很满意。并且知道你不能完全依赖它......

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-03-06T20:55:32.187

您可以从 /proc/pid/smaps 获取私有脏和私有干净 RSS

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-03-10T16:26:15.413

看看smem。它会给你PSS信息

[http://www.selenic.com/smem/](http://www.selenic.com/smem/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-05-16T21:04:38.607

对其进行了重新设计，使其更加简洁，以展示 bash 中的一些适当的最佳实践，特别是使用`awk`而不是`bc`.

```
find /proc/ -maxdepth 1 -name '[0-9]*' -print0 | while read -r -d $'\0' pidpath; do
  [ -f "${pidpath}/smaps" ] || continue
  awk '!/^Private_Dirty:/ {next;}
       $3=="kB" {pd += $2 * (1024^1); next}
       $3=="mB" {pd += $2 * (1024^2); next}
       $3=="gB" {pd += $2 * (1024^3); next}
       $3=="tB" {pd += $2 * (1024^4); next}
       $3=="pB" {pd += $2 * (1024^5); next}
       {print "ERROR!!  "$0 >"/dev/stderr"; exit(1)}
       END {printf("%10d: %d\n", '"${pidpath##*/}"', pd)}' "${pidpath}/smaps" || break
done 
```

在我机器上的一个方便的小容器上，`| sort -n -k 2`用于对输出进行排序，如下所示：

```
 56: 106496
         1: 147456
        55: 155648 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-08-31T15:39:19.087

使用 mincore(2) 系统调用。引用手册页：

```
DESCRIPTION
     The mincore() system call determines whether each of the pages in the
     region beginning at addr and continuing for len bytes is resident.  The
     status is returned in the vec array, one character per page.  Each
     character is either 0 if the page is not resident, or a combination of
     the following flags (defined in <sys/mman.h>): 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-01-07T07:31:35.527

对于一个提到 Freebsd 的问题，很惊讶还没有人写这个：

如果您想要 linux 风格的 /proc/PROCESSID/status 输出，请执行以下操作：

```
mount -t linprocfs none /proc
cat /proc/PROCESSID/status 
```

至少在 FreeBSD 7.0 中，默认情况下没有安装（7.0 是一个更旧的版本，但是对于这个基本的东西，答案隐藏在邮件列表中！）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-15T17:19:49.497

查看一下，这是 gnome-system-monitor 的源代码，它认为一个进程“*真正使用*`info->mem`”的内存是X Server Memory( `info->memxserver`) 和 Writable Memory( ) 的 sum( `info->memwritable`)，“ ***Writable Memory*** ”是**/proc/PID/smaps**文件中标记为“ **Private_Dirty** ”的内存块。

 **除了 linux 系统，根据 gnome-system-monitor 代码可能会有不同的方式。

```
static void
get_process_memory_writable (ProcInfo *info)
{
    glibtop_proc_map buf;
    glibtop_map_entry *maps;

    maps = glibtop_get_proc_map(&buf, info->pid);

    gulong memwritable = 0;
    const unsigned number = buf.number;

    for (unsigned i = 0; i < number; ++i) {
#ifdef __linux__
        memwritable += maps[i].private_dirty;
#else
        if (maps[i].perm & GLIBTOP_MAP_PERM_WRITE)
            memwritable += maps[i].size;
#endif
    }

    info->memwritable = memwritable;

    g_free(maps);
}

static void
get_process_memory_info (ProcInfo *info)
{
    glibtop_proc_mem procmem;
    WnckResourceUsage xresources;

    wnck_pid_read_resource_usage (gdk_screen_get_display (gdk_screen_get_default ()),
                                  info->pid,
                                  &xresources);

    glibtop_get_proc_mem(&procmem, info->pid);

    info->vmsize    = procmem.vsize;
    info->memres    = procmem.resident;
    info->memshared = procmem.share;

    info->memxserver = xresources.total_bytes_estimate;

    get_process_memory_writable(info);

    // fake the smart memory column if writable is not available
    info->mem = info->memxserver + (info->memwritable ? info->memwritable : info->memres);
} 
```

# asp.net - ASP.NET TextBox 控件在后台带有标签文本

> ID：118320
> 
> 赞同：5
> 
> 时间：2008-09-23T00:00:04.493
> 
> 标签：asp.net, textbox

我正在创建一个登录页面。我想创建具有“用户名”和“密码”作为其文本的 ASP.NET 文本框控件，但是一旦它们获得焦点，这些词就会消失，并且无论用户类型应该出现什么，就像普通文本框一样。如果用户将其留空并跳到下一个文本框，那么这些词会再次出现。这将消除在文本框前面放置单独标签的需要。如果有人可以分享他们的专业知识，我将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T00:02:13.287

使用 Microsoft 的 AJAX 工具包中的[TextBox Watermark Extender](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/TextBoxWatermark/TextBoxWatermark.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T00:00:54.880

谷歌“ASP.NET 水印文本框”。有很多实现

# linq - 如何调试 LINQ 语句

> ID：118341
> 
> 赞同：42
> 
> 时间：2008-09-23T00:06:17.053
> 
> 标签：linq, debugging, linq-to-objects

我有一个 Linq to objects 语句

```
 var confirm = from l in lines.Lines 
 where (l.LineNumber == startline.LineNumber) || (l.LineNumber == endline.LineNumber) 
 select l; 
```

确认对象在 System.Linq.Enumerable.WhereListIterator`1.MoveNext() 处返回“Object Null or Not A Reference”

如果查询的结果为空，它只会返回一个空的枚举数。我知道语句中没有空对象。是否可以单步执行 LINQ 语句以查看它在哪里崩溃？

**编辑**当我说*我知道没有空对象的事实*时，事实证明我在撒谎：[，但问题仍然存在，尽管我假设答案是“你不能真的”

LINQPad 是个好主意，我用它来自学 LINQ，但我可能会再次将其视为调试/斜线和刻录风格工具

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-03T23:15:55.260

是的，确实可以在 linq 查询中途暂停执行。

使用 lambda 表达式将您的 linq 转换为查询样式，并插入一个 Select 语句，该语句在您要调试的 linq 点之后的某个位置返回自身。一些示例代码会使它更清晰 -

```
 var query = dataset.Tables[0].AsEnumerable()
            .Where (i=> i.Field<string>("Project").Contains("070932.01"))
 //         .Select(i =>
 //         {return i;}
 //           )
            .Select (i=>i.Field<string>("City")); 
```

然后取消注释注释行。确保 {return i;} 在它自己的行上并在那里插入一个调试点。您可以将此选择放在冗长而复杂的 linq 查询中的任何位置。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-23T00:09:12.177

我不确定是否可以从 VS 进行调试，但我发现[LINQPad](http://www.linqpad.net/)非常有用。它可以让您转储 LINQ 查询的每个部分的结果。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-23T03:02:00.407

您应该能够在`where`LINQ 语句的子句中的表达式上设置断点。

在此示例中，将光标放在以下代码段中的任意位置：

```
(l.LineNumber == startline.LineNumber) || (l.LineNumber == endline.LineNumber) 
```

然后按`F9`或使用菜单或上下文菜单添加断点。

如果设置正确，只有上面的代码应该在编辑器中而不是整个 LINQ 语句中具有断点格式。您也可以在断点窗口中查看。

如果设置正确，每次都会在实现上述查询部分的函数处停止。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-12-10T16:24:53.003

早在 2010 年，我就在 Simple-Talk.com ( [LINQ Secrets Revealed: Chaining and Debugging](http://www.simple-talk.com/dotnet/.net-framework/linq-secrets-revealed-chaining-and-debugging/) )上写了一篇综合文章来解决这个问题：

我将 LINQPad（正如 OwenP 前面提到的）作为Visual Studio*外部的一个很好的工具来谈论。*特别注意其非凡的 Dump() 方法。您可以将其注入 LINQ 链中的一个或多个点，以惊人的干净和清晰的方式查看您的数据。虽然非常有用，但 LINQPad 是 Visual Studio 外部的。因此，我还介绍了几种可*在*Visual Studio 中使用的技术，因为有时将一大块代码迁移到 LINQPad 是不切实际的：

(1) 注入对我在文章中介绍的 Dump() 扩展方法的调用以允许记录。我从 Bart De Smet 的 Watch() 方法开始，在他的信息文章[LINQ to Objects – Debugging 中](http://community.bartdesmet.net/blogs/bart/archive/2009/04/23/linq-to-objects-debugging.aspx)添加了一些标签和着色以增强可视化，尽管与 LINQPad 的 Dump 输出相比它仍然相形见绌。

(2) 使用 Robert Ivanc 的[LINQPad Visualizer](http://code.google.com/p/linqpadvisualizer/)插件将 LINQPad 的可视化直接引入 Visual Studio。不确定这是否是通过我的推动 :-)，但我在撰写文章时出现的一些不便现在都在最新版本中得到了很好的解决。它具有完整的 VS2010 支持，并允许您在调试时检查您喜欢的任何对象。

(3) 在 LINQ 链的中间嵌入 nop 语句，以便您可以设置断点，如 Amazing Pete 前面所述。

**2016.12.01 更新**

而我刚刚写了上述文章的续篇，标题为简单的[LINQ 调试和可视化](https://www.simple-talk.com/dotnet/net-development/linq-debugging-visualization/)，它揭示了真正的 LINQ 调试功能终于在 Visual Studio 2015 中出现，OzCode 中即将发布的新功能。@Dror 对这个问题的回答只是对它的一瞥，但我鼓励您阅读我的新文章以深入了解“如何做”。（而且我*不*为 OzCode 工作。:-)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-09-13T13:11:09.447

*[免责声明：我在 OzCode 工作]*

LINQ 的问题是很难调试——即使在处理简单查询时，开发人员也被迫将他/她的查询重构为一堆 foreach 循环，或者使用日志记录。即将发布的 OzCode 版本（[目前作为早期访问预览](http://o.oz-code.com/LINQ_EAP)版）支持 LINQ 调试，它可以帮助开发人员深入研究他们的 LINQ 代码，并查明那些难以在查询中捕获异常的地方

这就是您的查询在 OzCode 中的样子：[![调试 LINQ 异常](https://i.stack.imgur.com/LfJ4T.gif)](https://i.stack.imgur.com/LfJ4T.gif)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-08-07T15:19:31.693

可以在不设置任何临时断点的情况下进入 LINQ 表达式。您需要进入**评估**LINQ 表达式的函数，例如：

```
var confirm = from l in lines.Lines 
              where (l.LineNumber == startline.LineNumber)
                    || (l.LineNumber == endline.LineNumber) 
              select l;

 confirm.ToArray(); // Press F11 ("Step into") when you reach this statement

 foreach(var o in q) // Press F11 when "in" keyword is highlighted as "next statement"
    // ... 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-23T00:14:15.410

检查异常堆栈跟踪并查看执行的代码的最后一位。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-23T00:15:03.800

从错误的外观来看，我建议您查看 line.Lines 并确保其枚举器已正确实现。我认为它不应该返回null。

哦，只需确保 line 和 line.Lines 对象不为空或返回空值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-02-20T11:01:15.903

虽然它不是一种调试方式，但我建议使用以下方法：

```
using (var db = new AppContext())
        {
            db.Database.Log = s => System.Diagnostics.Debug.WriteLine(s);
            // Rest of code
        } 
```

然后，您可以在调试时检查输出窗口，以查看从您的 LINQ 查询生成的 SQL。

# cvs - 如何搜索cvs评论历史

> ID：118342
> 
> 赞同：8
> 
> 时间：2008-09-23T00:06:42.340
> 
> 标签：cvs

我知道这个命令： `cvs log -N -w<userid> -d"1 day ago"`

不幸的是，这会生成一个带有许多换行符的格式化报告，这样文件路径、文件版本和注释文本都在不同的行上。因此很难扫描它以查找所有出现的注释文本（例如，grep），并将匹配项与文件/版本相关联。

（请注意，如果只有 cvs 可以本地执行过滤，日志输出将是完全可以接受的。）

编辑：示例输出。每个存储库文件都会报告这样的文本块：

```
RCS 文件：/data/cvs/dps/build.xml,v
工作文件：build.xml
头：1.49
分支：
锁：严格
访问列表：
关键字替换：kv
总修订：57；选定的修订：1
描述：
----------------------------
修订版 1.48
日期：2008/07/09 17:17:32；作者：noec；状态：经验​​；线路：+2 -2
修复了 src.jar 引用
----------------------------
修订版 1.47
日期：2008/07/03 13:13:14；作者：noec；状态：经验​​；线路：+1 -1
修复了 common-src.jar 引用。
==================================================== ============================

```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T19:32:38.393

这些`-w`选项似乎与该`-S`选项一起工作得更好。否则，会有其他结果似乎与用户 ID 无关。也许有人可以解释一下。

```
cvs log -N -S -w<userid> -d"1 day ago" 
```

有了这个，我通过管道将它传递给 grep 已经获得了合理的成功：

```
cvs log -N -S -w<userid> -d"1 day ago" | grep -B14 "some text" > afile 
```

我将输出重定向到一个文件，因为 cvs 日志很嘈杂，我不知道如何让它安静。我想另一种方法是将 stderr 重定向到`/dev/null`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-17T22:55:55.723

您需要[cvsps](http://www.cobite.com/cvsps/) - 它将根据 CVS 历史生成补丁集。然后，您应该在 cvsps 输出中只有一个注释实例，文件整齐地列在其下方

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T00:25:10.267

我的第一个想法是使用 egrep（或 grep -E，我认为）来搜索多种模式，例如：

```
<Cmd> | egrep 'Filename:|Version:|Comment:' 
```

但后来我意识到你想要更智能地过滤。

为此，我将使用 awk（或 perl）逐行处理输出，当您找到感兴趣的部分时设置一个 echo 变量；这里的伪代码：

```
# Assume the sections are of the format:
#   Filename: <filename>
#   Version:  <version>
#   Comment:  <comment>
#             <more comment>

Set echo to false
While more lines left
    Get line
    If line starts with "Filename: " and <filename> is of interest
        Set echo to true
    If line starts with "Filename: " and <filename> is not of interest
        Set echo to false
    If echo is true
        Output line
End while 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T21:22:42.117

这是我所做的 - 一个简单的 Java 脚本：

```
import java.io.IOException;

public class ParseCVSLog
{

    public static final String CVS_LOG_FILE_SEPARATOR = "=============================================================================";
    public static final String CVS_LOG_REVISION_SEPARATOR = "----------------------------";
    public static final String CVS_LOG_HEADER_FILE_NAME = "Working file";
    public static final String CVS_LOG_VERSION_PREFIX = "revision";

    public static void main(String[] args) throws IOException
    {
        String searchString = args[0];

        System.out.println( "SEARCHING FOR: " + searchString );

        StringBuffer cvsLogOutputBuffer = new StringBuffer();
        byte[] bytes = new byte[1024];
        int numBytesRead = 0;
        while( (numBytesRead = System.in.read( bytes )) > 0 )
        {
            String bytesString = new String(bytes, 0,  numBytesRead);
            cvsLogOutputBuffer.append( bytesString );
        }

        String cvsLogOutput = cvsLogOutputBuffer.toString();

        String newLine = System.getProperty("line.separator");
        String[] fileArray = cvsLogOutput.split( CVS_LOG_FILE_SEPARATOR );

        for ( String fileRecord : fileArray )
        {
            if ( !fileRecord.contains( searchString ) )
            {
                continue;
            }

            String[] revisionArray = fileRecord.split( CVS_LOG_REVISION_SEPARATOR );
            String[] fileHeaderLineArray = revisionArray[ 0 ].split( newLine );
            String fileName = "";
            for ( String fileHeadeLine : fileHeaderLineArray )
            {
                if ( fileHeadeLine.contains( CVS_LOG_HEADER_FILE_NAME ) )
                {
                    fileName = fileHeadeLine.split( ": " )[ 1 ];
                    break;
                }
            }
            System.out.print( fileName );
            for ( int i = 1; i < revisionArray.length; i++ )
            {
                String versionRecord = revisionArray[ i ];
                if ( !versionRecord.contains( searchString ) )
                {
                    continue;
                }
                String[] versionLineArray = versionRecord.split( newLine );
                for ( String versionLine : versionLineArray )
                {
                    if ( versionLine.contains( CVS_LOG_VERSION_PREFIX ) )
                    {
                        System.out.print( " " + versionLine.split( " " )[ 1 ] );
                    }
                }

            }
            System.out.println();
        }
    }
} 
```

这是我使用它的方式：

```
cvs log -N -S -washamsut | java ParseCVSLog GS-242 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-17T16:05:51.293

这个命令和 gawk 脚本帮助我只找到每个日志条目的文件名、日期和注释行。

```
cvs log -N -S -b -w<userid> -d ">1 day ago" 2>/dev/null | gawk 'BEGIN{out=0;} /^Working file:/ { print $0; } /^date:/ { out=1; } /^===/ { print ""; out=0; } (out==1){print $0;}' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T00:17:51.377

这可能有点矫枉过正，但您可以使用[git-cvsimport](http://www.kernel.org/pub/software/scm/git/docs/git-cvsimport.html)将 CVS 历史导入 Git 存储库并使用 Git 的工具进行搜索。您不仅可以搜索提交消息中的文本，还可以搜索曾经在存储库中的文件中添加*或删除的代码。*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T00:19:15.447

[CVSSearch](http://cvssearch.sourceforge.net/)可能会有所帮助，但它是一个 CGI 应用程序 :'(

# ado.net - 如何使用 ADO.NET Entity Framework 自动更新 ModifiedAt 字段？

> ID：118343
> 
> 赞同：0
> 
> 时间：2008-09-23T00:07:05.427
> 
> 标签：ado.net

Ruby on Rails 具有[神奇的时间戳字段](http://wiki.rubyonrails.com/rails/pages/Timestamping)，这些字段会在创建或更新记录时自动更新。我试图在实体框架中找到类似的功能。我考虑过数据库触发器和 SavingChanges 事件处理程序。我忽略了一个更明显的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-23T00:10:52.923

如果您使用的是 MS SQL Server，请使用时间戳字段。该值本身是没有意义的，除了告诉您自上次检索以来是否已触及记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T18:32:32.917

我求助于 SavingChanges 事件处理程序。[我的博客上的详细信息](http://rabblerule.blogspot.com/2008/10/automatic-timestamping-for-entity.html)。

# c# - 如何扩展 msbuild 以在 .cs 文件上运行自定义预处理器？

> ID：118356
> 
> 赞同：1
> 
> 时间：2008-09-23T00:14:24.537
> 
> 标签：c#, msbuild

我有一个自定义程序，它预处理一个 C# 文件并生成一个新的 C# 文件作为输出。我想在项目中的每个 C# 文件上从 msbuild 调用它，然后编译输出文件而不是原始 C# 文件。我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T08:14:13.773

您可能想研究在 Visual Studio 中使用“自定义工具”代码生成技术；[CodeProject](http://www.codeproject.com/KB/cs/VsMultipleFileGenerator.aspx?display=Print)上有一篇关于它的文章

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T00:22:20.773

我不确定是否有一种简单的方法可以使用默认的 msbuild 任务来执行它。但是您可以创建自己的任务来做任何您想做的事情：

[如何：实施自定义任务 - 第一部分](http://blogs.msdn.com/msbuild/archive/2006/01/21/515834.aspx)

[您也可以在“ MSBuild community tasks](https://github.com/loresoft/msbuildtasks) ”站点搜索合适的任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T07:47:56.270

如果您的自定义程序是可执行文件，最简单的方法是使用 Exec 调用可执行文件：

```
<Exec Command="your executable" /> 
```

不过，我建议编写一个自定义 MSBuild 任务。您可以查看[SDC 任务](http://www.codeplex.com/sdctasks) 以获取有关如何执行此操作的示例。

# oracle - 用于创建 Oracle SQL Loader 控制文件的用户界面

> ID：118367
> 
> 赞同：5
> 
> 时间：2008-09-23T00:16:28.307
> 
> 标签：oracle, ide, sql-loader

是否有用于创作 Oracle SQL Loader 控制文件的良好用户界面？PL/SQL Developer 包括一个“文本导入器”功能（提醒 Excel 导入向导之一）将文本文件导入表格，但使用专有格式而不是 SQL 加载器格式。对于 SQL Loader 格式，这样的东西会很有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T07:22:32.823

TOAD 有一个执行 SQL*Loads 的接口，它也可以生成控制文件......

[http://www.toadsoft.com/get2know9/#Loader](http://www.toadsoft.com/get2know9/#Loader)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T18:03:45.883

TOAD 的答案可能是目前最好的。然而，在试用 TOAD SQL Loader 向导时，我对可用性水平感到失望。它假设我有一个预先存在的表来加载数据。我一直在寻找能让我先入为主的东西

*   在固定宽度的输入文件中定位列，然后
*   分析候选名称和数据类型的列，然后
*   生成用于加载数据的表*和*控制文件

由于我找不到任何能充分满足我需求的东西，我为此创建了一个实用程序。该实用程序是根据我的特定需求定制的（固定宽度的文件格式、顶部的标题、将标题与数据分开的虚线分隔线、列之间的空白），并且仅支持我需要的 SQL 加载器功能。如果我有机会将其充实为更普遍可用的东西，我很乐意将其发布给社区。

# python - 如何在 Python 中使用省略号切片语法？

> ID：118370
> 
> 赞同：183
> 
> 时间：2008-09-23T00:17:09.663
> 
> 标签：python, numpy, subclass, slice, ellipsis

这出现在 [Hidden features of Python](https://stackoverflow.com/questions/101268/hidden-features-of-python)中，但我看不到很好的文档或示例来解释该功能的工作原理。

* * *

## 回答 #1

> 赞同：279
> 
> 时间：2008-09-23T00:55:09.367

省略号在 numpy 中用于对高维数据结构进行切片。

它的目的是*在这一点上插入尽可能多的完整切片 ( `:`) 以将多维切片扩展到所有维度*。

**示例**：

```
>>> from numpy import arange
>>> a = arange(16).reshape(2,2,2,2) 
```

现在，您有一个 2x2x2x2 阶的 4 维矩阵。要选择第 4 维中的所有第一个元素，可以使用省略号表示法

```
>>> a[..., 0].flatten()
array([ 0,  2,  4,  6,  8, 10, 12, 14]) 
```

这相当于

```
>>> a[:,:,:,0].flatten()
array([ 0,  2,  4,  6,  8, 10, 12, 14]) 
```

在您自己的实现中，您可以自由地忽略上面提到的合同并将其用于您认为合适的任何事情。

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2008-09-23T00:24:21.360

`Ellipsis`，或者`...`不是隐藏的特征，它只是一个常数。它与作为语言语法一部分的 javascript ES6 完全不同。没有内置类或 Python 语言构造使用它。

因此，它的语法完全取决于您或其他人是否编写了代码来理解它。

Numpy 使用它，如[文档](http://wiki.scipy.org/Numpy_Example_List_With_Doc#head-490d781b49b68b300eedaef32369fae7d58627fb)中所述。[这里](http://wiki.scipy.org/Tentative_NumPy_Tutorial#head-864862d3f2bb4c32f04260fac61eb4ef34788c4c)有一些例子。

在您自己的课程中，您会像这样使用它：

```
>>> class TestEllipsis(object):
...     def __getitem__(self, item):
...         if item is Ellipsis:
...             return "Returning all items"
...         else:
...             return "return %r items" % item
... 
>>> x = TestEllipsis()
>>> print x[2]
return 2 items
>>> print x[...]
Returning all items 
```

当然，还有[python 文档](https://docs.python.org/library/constants.html#Ellipsis "省略")和[语言参考](https://docs.python.org/reference/expressions.html#grammar-token-slicing)。但这些都不是很有帮助。

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2008-09-23T09:34:48.480

这是省略号的另一种用途，它与切片无关：我经常在与队列的线程内通信中使用它，作为表示“完成”的标记；它在那里，它是一个对象，它是一个单例，它的名字的意思是“缺乏”，它不是过度使用的 None （可以作为正常数据流的一部分放入队列中）。YMMV。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-06-07T04:03:58.113

如其他答案所述，它可用于创建切片。当您不想编写许多完整的切片符号 ( `:`)，或者当您不确定要操作的数组的维数时，它很有用。

我认为重要的是要强调，而其他答案中缺少的是，即使没有更多要填充的维度，它也可以使用。

例子：

```
>>> from numpy import arange
>>> a = arange(4).reshape(2,2) 
```

这将导致错误：

```
>>> a[:,0,:]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: too many indices for array 
```

这将起作用：

```
a[...,0,:]
array([0, 1]) 
```

# java - 你如何确保多个线程可以安全地访问一个类字段？

> ID：118371
> 
> 赞同：10
> 
> 时间：2008-09-23T00:17:29.397
> 
> 标签：java, multithreading, synchronized

当多个线程通过getter方法访问一个类字段时，如何维护线程安全？同步关键字是否足够？

这安全吗：

```
public class SomeClass {
    private int val;

    public synchronized int getVal() {
        return val;
    }

    private void setVal(int val) {
        this.val = val;
    }
} 
```

还是二传手会引入更多的复杂性？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-23T00:22:28.010

如果您在此处的设置器上也使用“同步”，则此代码是线程安全的。然而，它可能不够精细；如果您有 20 个 getter 和 setter，并且它们都是同步的，那么您可能会造成同步瓶颈。

在这个特定的实例中，使用单个 int 变量，然后消除“同步”并将 int 字段标记为“volatile”也将确保可见性（每个线程在调用 getter 时将看到最新的“val”值）但它可能不会足够同步以满足您的需求。例如，期待

```
 int old = someThing.getVal();
 if (old == 1) {
    someThing.setVal(2);
 } 
```

当且仅当它已经是 1 时将 val 设置为 2 是不正确的。为此，您需要一个外部锁或一些原子比较和设置方法。

我强烈建议您阅读Brian Goetz*等人的**Java Concurrency In Practice*，它对 Java 的并发结构有最好的覆盖。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T00:39:05.087

除了[Cowan 的评论](https://stackoverflow.com/questions/118371/how-do-you-ensure-multiple-threads-can-safely-access-a-class-field#118388)之外，您还可以执行以下操作进行比较和存储：

```
synchronized(someThing) {
    int old = someThing.getVal();
    if (old == 1) {
        someThing.setVal(2);
    }
} 
```

这是有效的，因为通过同步方法定义的锁与对象的锁隐式相同（[参见 java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/statements.html#255769)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T00:19:12.013

据我了解，您应该在 getter 和 setter 方法上使用同步，这就足够了。

编辑：这是一个[链接](https://java.sun.com/docs/books/tutorial/essential/concurrency/syncmeth.html)，指向有关同步的更多信息以及其他信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-07T15:56:49.327

如果您的类只包含一个变量，那么实现线程安全的另一种方法是使用现有的 AtomicInteger 对象。

```
public class ThreadSafeSomeClass {

    private final AtomicInteger value = new AtomicInteger(0);

    public void setValue(int x){
         value.set(x);
    }

    public int getValue(){
         return value.get();
    }

} 
```

但是，如果您添加其他变量以使它们相互依赖（一个变量的状态取决于另一个变量的状态），那么 AtomicInteger 将不起作用。

赞同阅读“Java Concurrency in Practice”的建议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T10:37:47.253

对于简单的对象，这可能就足够了。在大多数情况下，您应该避免使用 synchronized 关键字，因为您可能会遇到同步死锁。

例子：

```
public class SomeClass {

  private Object mutex = new Object();
  private int    val   = -1; // TODO: Adjust initialization to a reasonable start
                             //       value
  public int getVal() {
    synchronized ( mutex ) {
      return val;
    }
  }

  private void setVal( int val ) {
    synchronized ( mutex ) {
      this.val = val;
    }
  }
} 
```

确保只有一个线程读取或写入本地实例成员。

阅读“Java 中的并发编程（tm）：设计原则和模式（Java（Addison-Wesley））”一书，可能是[http://java.sun.com/docs/books/tutorial/essential/concurrency/index.html](http://java.sun.com/docs/books/tutorial/essential/concurrency/index.html)也很有帮助...

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-09-23T00:33:20.577

存在同步是为了防止线程干扰和内存一致性错误。通过在 getVal() 上同步，代码保证 SomeClass 上的其他同步方法不会同时执行。由于没有其他同步方法，因此它没有提供太多价值。另请注意，对原语的读取和写入具有原子访问权限。这意味着通过仔细编程，不需要同步对字段的访问。

阅读[同步](http://java.sun.com/docs/books/tutorial/essential/concurrency/sync.html)。

不太确定为什么将其降至-3。我只是在总结 Sun 的同步教程所说的（以及我自己的经验）。

> 使用简单的原子变量访问比通过同步代码访问这些变量更有效，但需要程序员更加小心以避免内存一致性错误。额外的努力是否值得取决于应用程序的大小和复杂性。

# security - 在编写自己的密码学方法时，您使用了哪些技术？

> ID：118374
> 
> 赞同：17
> 
> 时间：2008-09-23T00:17:58.303
> 
> 标签：security, language-agnostic, encryption, cryptography

多年来，也许是 10 年，我一直对密码学着迷。我读了一本关于基于 XOR 位的加密的书，从那以后就迷上了。

我想更公平地说，我对那些可以破解各种加密方法的人着迷，但我离题了。

直截了当——你在编写密码学时使用什么方法？混淆在密码学中好吗？

我使用两个基于密钥的 XOR 加密、密钥上的各种散列技术 (SHA1) 以及简单的东西，例如在这里和那里反转字符串等。

我很想看看其他人在编写一种不那么开箱即用的加密方法时的想法和尝试。此外——任何关于专业人士如何“破解”各种密码技术的信息也会很有趣。

**澄清一下——我不想在任何生产代码或我的任何代码中使用它。我很感兴趣通过玩弄而不是重新发明轮子来了解它是如何工作的。:)**

伊恩

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-23T00:20:26.783

我能给你的最好建议是：抵制重新发明轮子的诱惑。密码学比你想象的要难。

获取 Bruce Schneier 的《[应用密码学](http://www.schneier.com/book-applied.html)》一书并仔细阅读。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-23T04:17:14.843

与迄今为止其他人所说的相矛盾，**去吧！** 是的，您的代码中可能存在缓冲区溢出漏洞，并且可能很慢、有错误等，但您这样做是为了**好玩**！我完全理解玩加密货币的娱乐乐趣。

话虽如此，密码学根本不基于混淆（或至少不应该）。良好的加密将继续工作，即使[Eve](http://en.wikipedia.org/wiki/Alice_and_Bob#List_of_characters)已经通过你的混淆代码并完全理解正在发生的事情。IE：许多报纸都有[替代代码](http://en.wikipedia.org/wiki/Caesar_cipher)谜题，读者在早餐时尝试破解。如果他们开始做一些事情，比如反转整个字符串，是的，这会更难，但 Joe Reader 仍然能够打破它，neve tuohtiw gnieb dlot。

好的加密基于被认为非常困难的问题（尚未证明，AFAIK）。这方面的示例包括[因式分解素数](http://en.wikipedia.org/wiki/RSA#Security)、[查找对数](http://en.wikipedia.org/wiki/Diffie-Hellman)或任何其他[NP 完全](http://en.wikipedia.org/wiki/NP-complete)问题。

[编辑：snap，这些都没有被**证明**是NP完全的。它们都未经证实，但又不同。希望你仍然明白我的观点：加密是基于单向函数的。这些操作很容易做，但很难撤消。即乘以两个数字与找到产品的主要因素。好赶上[tduehr](https://stackoverflow.com/users/20486/tduehr) ]

玩弄一个非常酷的数学分支给你更多的力量，只要记住加密是基于困难而不是复杂的东西。许多加密算法，一旦你真正理解它们，就会简单得令人难以置信，但仍然有效，因为它们基于一些困难的东西，而不仅仅是交换字母。

注意：话虽如此，一些算法确实添加了额外的怪癖（如字符串切断），以使暴力强制它们变得更加困难。我的一部分感觉就像我在某个地方读到了这个引用[DES](http://en.wikipedia.org/wiki/Data_Encryption_Standard)，但我不相信它...... [编辑：我是对的，请参阅[本文的第 5 段，](http://scienceblogs.com/goodmath/2008/09/des_encryption_part_1_encrypti.php)以获取对排列无用的引用。]

顺便说一句：如果你以前没有找到它，我猜[TEA](http://en.wikipedia.org/wiki/Tiny_Encryption_Algorithm) / [XTEA](http://en.wikipedia.org/wiki/XTEA) / [XXTEA](http://en.wikipedia.org/wiki/XXTEA)系列算法会很有趣。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-23T00:21:46.470

正确的答案是不要做这样的事情。最好的方法是为此目的选择众多密码库之一，并在您的应用程序中使用它们。通过默默无闻的安全永远不会奏效。

选择当前加密算法的最高标准。AES 用于加密，SHA256 用于散列。Elgamal 用于公钥。

阅读应用密码学也是一个好主意。但是本书的大部分内容是大多数应用程序不需要的实现细节。

编辑：扩展编辑中给出的新信息。当前的绝大多数密码学都涉及许多复杂的数学。即使是看起来像是各种比特币的分组密码也是一样的。

在这种情况下，请阅读应用密码学，然后获得可以免费下载[的应用密码学手册。](http://www.cacr.math.uwaterloo.ca/hac/)

这两者都有很多关于密码算法的信息。对差分和线性密码分析等事物的一些解释。另一个资源是[Citeseer](http://citeseer.ist.psu.edu/)，其中包含两本书引用的许多学术论文供下载。

密码学是一个困难的领域，具有悠久的学术历史，可以去任何地方。但是，如果您拥有技能，那将是非常有益的，就像我发现的那样。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-23T01:04:29.987

在这里做练习：

[http://www.schneier.com/crypto-gram-9910.html#SoYouWanttobeaCryptographer](http://www.schneier.com/crypto-gram-9910.html#SoYouWanttobeaCryptographer)

对于初学者，请查看多维数据集攻击论文 ( [http://eprint.iacr.org/2008/385](http://eprint.iacr.org/2008/385) ) 并尝试用它来破解一些算法。在您熟悉破解密码方案后，您将更擅长创建它们。

至于生产代码，我将重复已经说过的内容：使用市场上可用的，因为所有主流方案都经过了多轮密码分析。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-23T15:02:29.520

以上所有建议都是合理的。混淆不好。在没有先让公众对其进行抨击的情况下，不要将自己的加密货币投入生产。

补充几点：

*   编码*不是*加密。由于开发人员在这里的误解，我最近绕过了一个网站的身份验证系统。

*   学习如何打破最基本的系统。您会惊讶于简单旋转密码的知识实际上有用的频率。

*   A^B = C。您说您一直在使用两个密钥 XOR 加密。在构建密码系统时，请始终检查您的步骤是否确实在完成某些事情。在两键异或的情况下，您实际上只是使用了不同的键。

*   A^A = 0。XOR 加密对已知或选择的明文攻击非常弱。如果您知道全部或部分明文，则可以获得全部或部分密钥。明文 ^ 密文 = 密钥

*   另一本值得阅读的好书是 Simon Singh 的 The Code Book。它回顾了密码学的一些历史以及破解他所涵盖的大多数密码系统的方法。

*   两种学习算法（学习它们及其背后的历史）：

    *   3DES：是的，它已经过时了，但它是学习 fiestel 和块密码的一个很好的起点，并且从 DES 中创建它有一些很好的教训。此外，所使用的加密、解密、加密方法的推理是一件值得学习的事情。
    *   RSA：我将在这里展示我内心的数学极客。可能是当今使用的最简单的加密算法。破解它的方法是已知的（只考虑密钥），但计算起来非常困难。m^d mod n 其中 n = p*q（p 和 q 素数）且 gcd(d,n)=1。一点群/数论解释了为什么在不知道 p 和 q 的情况下不容易逆转。在我的数论课程中，我们至少以六种方式证明了这背后的理论。

PhirePhly 的注释：

素数分解和离散对数不是 NP-Complete 或 NP-Hard 的。它们的复杂性都未知。我想你只要弄清楚那部分就会获得相当大的名气。也就是说，您的其余断言是正确的。好的加密是基于容易做但没有密钥很难撤销的事情。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-23T00:20:59.497

除非你是（成为）该领域的专家，否则不要在生产产品中使用自制的加密货币。说够了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-23T00:23:10.287

***不！***

即使是专家也*很难*知道他们是否做对了。在加密 CS 类之外，只需使用其他人的代码。仅在绝对必须时移植代码，然后使用已知的良好代码对其进行测试。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-23T00:29:52.003

大多数专家同意，在开发密码方法和算法时，开放性比混淆更有价值。

换句话说，似乎每个人都能够设计出一个除了他们之外每个人都可以破解的新代码。最好的加密货币经受住了将算法和一些加密消息放在那里并让最好的加密货币黑客试图破解它的考验。

一般来说，大多数混淆方法和简单的散列（我自己也做过很多）很容易被破解。这并不意味着尝试和学习它们没有乐趣。

[密码学书籍列表](http://en.wikipedia.org/wiki/Books_on_cryptography)（来自维基百科）

这个问题引起了我的注意，因为我目前正在重新阅读Neal Stephenson 的[Cryptonomicon](http://en.wikipedia.org/wiki/Cryptonomicon)，这本身并不是一个糟糕的概述，即使它是一本小说......

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-23T00:32:42.603

为了呼应其他所有人（为了后代），永远不要实施自己的加密货币。使用图书馆。

也就是说，这是一篇关于如何实现 DES 的文章：

[http://scienceblogs.com/goodmath/2008/09/des_encryption_part_1_encrypti.php](http://scienceblogs.com/goodmath/2008/09/des_encryption_part_1_encrypti.php)

排列和噪声对许多加密算法至关重要。重点不在于模糊事物，而是在过程中增加步骤，使蛮力攻击变得不切实际。

另外，获取并阅读[Applied Cryptography](http://www.schneier.com/book-applied.html)。这是一本很棒的书。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-23T00:34:01.883

必须同意其他海报。除非你正在写一篇关于它的论文并且需要做一些研究或其他事情，否则不要这样做。

如果您认为自己对此了解很多，请阅读[应用密码学](http://www.schneier.com/book-applied.html)一书。我知道很多数学，那本书仍然让我很兴奋。你可以从他的伪代码中阅读和分析。如果您愿意，这本书的后面还有大量参考资料可以深入挖掘。

加密是很多人认为很酷的东西之一，但概念背后的实际数学超出了他们的掌握。我很久以前就决定，为了达到那个水平，我不值得付出精神上的努力。

如果您只是想看看它是如何完成的（研究代码中的现有实现），我建议您看看[Crypto++ 库](http://www.schneier.com/book-applied.html)，即使您通常不使用 C++ 编写代码，它也可以很好地了解实现加密的主题和部分.

布鲁斯也有一个很好[的资源列表，](http://www.schneier.com/resources.html)你可以从他的网站获得。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-23T00:36:01.723

我参加了今年 Aus TechEd 的代码安全会议。在谈到 .Net 中的 AES 算法以及如何选择它时，主持人 (Rocky Heckman) 向我们介绍了一种用于破解先前加密的技术。有人设法使用热像仪记录 CPU 在加密数据时的热特征。他们能够使用此记录来确定芯片正在执行哪些类型的计算，然后对算法进行逆向工程。他们手头有太多的时间，我相当有信心我永远不会聪明到打败那样的人！:(

*   注意：我真诚地希望我已经正确地传达了这个故事，如果没有 - 错误很可能是我的，而不是提到的主持人的错误。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-25T23:39:18.277

你不应该在产品中使用本土加密货币已经被打死了。但是我已经阅读了您的问题，并且您明确表示您只是为了好玩。对我来说，这听起来像是真正的极客/黑客/学术精神。您知道它有效，您想知道它为什么有效，并尝试看看您是否可以使它有效。

我完全鼓励这样做，并且对我编写的许多程序也这样做只是为了好玩。我建议在名为“rootlabs”的博客上阅读这篇文章 ( [http://rdist.root.org/2008/09/18/dangers-of-amateur-cryptography/ )。](http://rdist.root.org/2008/09/18/dangers-of-amateur-cryptography/)帖子中有一系列链接，您应该会发现它们非常有趣。一个对数学/加密感兴趣的人，拥有计算机科学博士学位并为谷歌工作，他决定写一系列关于编程加密的文章。他犯了几个不明显的错误，行业专家 Nate Lawson 指出了这些错误。

我建议你阅读它。如果它不鼓励你继续尝试，它无疑仍然会教给你一些东西。

祝你好运！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-23T00:28:27.000

我同意不重新发明轮子。

请记住，默默无闻的安全根本不是安全。如果您的安全机制的任何部分使用“没有人会弄清楚这一点！”这样的短语，那么它就是不安全的。想想 AES——该算法是公开可用的，所以*每个人都*知道它*是*如何工作的，但没有人能破解它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-23T00:57:40.080

根据其他答案 - 发明加密方案绝对是专家的事情，任何新提出的加密方案确实需要接受公众审查，以获得任何合理的验证希望和对其稳健性的信心。然而，实现现有的算法和系统是一项更实际的“为了好玩”的努力，所有主要标准都有很好的测试向量来帮助证明你的实现的正确性。

话虽如此，对于生产解决方案，现有的实现很多，通常没有理由您*需要*自己实现一个系统。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-25T23:50:20.933

我同意所有答案，“*不要*为生产使用编写自己的加密算法”和“*地狱是的，为你自己的教育而努力*”，但我想起了一些我相信可敬的 Bruce Schneier 经常写的东西：“**有人很容易创造出他们自己无法打破的东西。”**

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-23T00:39:05.303

非专家应该能够期望得到正确的唯一密码是简单的一次性密码。

```
CipherTextArray = PlainTextArray ^ KeyArray; 
```

除此之外，任何值得一看的东西（即使是为了娱乐）都需要高水平的数学学位。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-23T05:03:48.973

我不想深入探讨已经给出的正确答案（不要为生产而做；简单的反转不够；混淆不好；等等）。

我只想补充一下 Kerckoff 的原则，“即使系统的所有内容（除了密钥）都是公共知识，密码系统也应该是安全的”。

当我谈到它时，我还会提到 Bergofsky 的原理（由 Dan Brown 在 Digital Fortress 中引用）：“如果计算机尝试了足够多的密钥，它在数学上可以保证找到正确的密钥。代码的安全性并不在于它的通过-key 是找不到的，而是大多数人没有时间或设备来尝试。”
只是那本质上是不正确的。丹布朗弥补了这一点。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-22T21:46:19.480

回应 PhirePhly 和 tduehr，关于保理的复杂性：

很容易看出，因式分解存在于 NP 和 coNP 中。我们需要看到的是问题“给定 n 和 k，找到 n 的质因子 p，1 < p <= k”和“表明不存在这样的 p”都在 NP 中（第一个是决策变体因式分解问题，第二个是补码的决策变体）。

第一个问题：给定一个候选解 p，我们可以很容易地（即在多项式时间内）检查是否 1 < p <= k 以及 p 是否整除 n。解 p 总是比 n 短（在用于表示它的位数上），因此因式分解在 NP 中。

第二个问题：给定一个完整的素数分解 (p_1, ..., p_m)，我们可以快速检查它们的乘积是否为 n，并且没有一个介于 1 和 k 之间。我们知道 PRIMES 在 P 中，所以我们可以在多项式时间内检查每个 p_i 的素数。由于最小的素数是 2，因此在任何有效分解中最多有 log_2(n) 个素数因子。每个因子都小于 n，因此它们最多使用 O(n log(n)) 位。因此，如果 n 在 1 和 k 之间没有质数因子，则有一个简短的（多项式大小）证明，可以快速验证（在多项式时间内）。

所以因式分解在 NP 和 coNP 中。如果它是 NP 完全的，那么 NP 将等于 coNP，这通常被认为是错误的。可以将此作为因子分解确实不是 NP 完全的证据；我宁愿等待证明;-)

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2008-09-23T01:48:44.433

通常，我首先获得数论博士学位。然后我进行了十年左右的研究，并随后进行了大量的出版和同行评审。就我使用的技术而言，它们是来自我的研究和我的同行的各种技术。有时，当我在半夜醒来时，我会开发一种新技术，实施它，找到其中的漏洞（在我的数论和计算机科学同行的帮助下），然后从那里改进。

如果你给鼠标一个算法......

# javascript - 为什么我的 Drupal 站点在调用 Javascript 函数时会注销用户？

> ID：118391
> 
> 赞同：2
> 
> 时间：2008-09-23T00:23:30.927
> 
> 标签：javascript, drupal

我有 Drupal 5 站点，单击按钮并调用 JavaScript 函数。该函数基本上构建一个字符串，然后重定向到我们网站上的另一个页面。单击按钮后，有时用户会退出并看到“拒绝访问”屏幕，即使他们之前已登录。他们被重定向的页面与前一个页面具有相同的访问限制，但不管怎样，他们不应该被注销。

一个用户大约有一半的时间会发生这种情况（另一半它应该正常工作），而另一个用户报告说在单击该按钮时总是被注销。但是，我总是能够在我使用的机器上顺利运行它，我怀疑这与使用 IE6 的机器有关。以前有没有人遇到过这个问题，或者对可能导致此问题的原因有任何想法？我在Drupal论坛上搜索和发帖，在这个论坛上搜索过，还没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T00:29:03.830

很多事情浮现在脑海。

*   页面是否被重定向到同一个域？就 cookie 而言，domain.com 和 www.domain.com 并不相同（取决于它们的设置方式）。
*   你能在任何浏览器中 100% 可靠地重现它吗？没有冒犯您的用户，但用户是骗子（或至少不善于报告技术错误）。我不会相信用户告诉我的事实（“哦，好吧，是的，我在尝试之间关闭了浏览器。但这不重要。”）。
*   服务器上是否正在运行正在清除会话的东西，或者会话过期限制设置的太宽松了？

道德：先去尝试重现问题，这样你就可以准确地缩小问题的范围。我建议使用 Firebug + Firecookie 来调试 Firefox 和一般 cookie 问题，使用 Fiddler2（代理）来调试 IE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T00:34:50.713

老实说，我认为最好的方法是发布导致此问题的代码。

Drupal 使用 PHP 会话来执行此操作，它使用 cookie……是否有任何用户关闭了 cookie？

有很多事情可能导致这种情况，重定向到不同的域，清除会话（/tmp cleanup？），但通常，我会把这样的事情放到浏览器中。

询问他们是否仍然可以使用其他浏览器进行复制（尝试使用 firefox）...检查他们的 cookie 安全设置等。

# oop - 如何防止同一业务对象的多个类？

> ID：118401
> 
> 赞同：1
> 
> 时间：2008-09-23T00:25:51.200
> 
> 标签：oop, code-duplication

很多时候，我会有一个业务对象，它具有用户索引的属性或某些数据的一组索引。当我在表单或其他视图中显示此对象时，我需要用户全名或数据的其他一些属性。通常我会创建另一个类 myObjectView 或类似的东西。处理这种情况的最佳方法是什么？

进一步澄清：如果我有一个问题跟踪器类，并且我的问题类具有 IxCreatedByUser 作为属性和 IxAttachment 值的集合（附件记录的索引）。当我在网页上显示此内容时，我想显示 John Doe 而不是 IxCreatedByUser，并且我想在页面上显示指向附件和文件名的链接。所以通常我创建一个带有附件对象集合和 CreatedByUserFullName 属性或类似性质的新类。创建第二个类以在页面上显示数据只是感觉不对。也许我错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T00:48:29.133

**立面图案。**

我认为您的方法，创建一个外观模式来抽象具有多个数据源的复杂性通常是合适的，并且将使您的代码易于理解。

应该注意创建过多的抽象层，因为间接级别会破坏使代码更易于阅读的最初尝试。特别是，如果你觉得你只是编写类来匹配你在其他地方所做的事情。例如，如果您有一个 myLoanView，则不一定需要为系统中的每个对话创建一个 myView。从代码中退后 10 步，也许制作一个可重用且直观的抽象外观，您可以在多个地方使用。

随意详细说明您的挑战的确切性质。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T00:38:12.497

一个关键原则是你的每个类都应该有一个明确的目的。如果您的“业务对象”类的目的是公开与业务对象相关的相关数据，那么在该类上创建一个属性，将查找描述的请求委托给负责该查询的相关类可能是完全合理的。信息。任何特定于您的班级的格式都将在该属性中完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T23:39:21.283

以下是一些指导方针，可帮助您决定如何处理这种（很常见，IMO）模式：

1.  如果您只需要一个指向不经常更改的查找表的快速链接（例如，链接到州和/或国家/地区表的地址表），您可以保留查找的延迟加载的静态副本桌子。

2.  如果你有一个非常大的类，它需要大量的连接或子查询来加载只是为了显示目的，你可能想要像上面描述的那样为显示目的创建一个“视图”或“信息”类。只需确保 XInfo 类（用于显示）加载速度明显快于 X 类（用于编辑）。在这种情况下，在数据库端使用视图可能是一个非常好的主意。

# apache - 如何让 apache 将 Web 服务请求转发到 tomcat？

> ID：118404
> 
> 赞同：1
> 
> 时间：2008-09-23T00:26:38.673
> 
> 标签：apache, tomcat

我知道 websphere 做到了，所以一定有一些东西可以让 apache 弄清楚应用服务器需要什么以及它可以自己处理什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T00:32:47.190

你有两个选择。您可以使用[mod_jk](http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html)或[mod_proxy_ajp](http://httpd.apache.org/docs/2.2/mod/mod_proxy_ajp.html)转发您的请求。我通常使用 mod_proxy_ajp，因为它是 Apache 2.2 附带的，不需要我安装任何额外的东西。

# c# - 日期时间时区调整

> ID：118415
> 
> 赞同：8
> 
> 时间：2008-09-23T00:29:16.200
> 
> 标签：c#, date

我的数据库位于例如加利福尼亚。我的用户表包含所有用户的时区，例如 -0700 UTC

每当我向居住在纽约的用户显示日期时，如何从我的数据库服务器调整时间？UTC/GMT -4 小时

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T00:34:12.023

您应该以 UTC 格式存储数据并以本地时区格式显示。

```
DateTime.ToUniversalTime() -> server;
DateTime.ToLocalTime() -> client 
```

您可以使用 AddXXX 方法组调整日期/时间，但这很容易出错。[.NET 在System.TimeZoneInfo](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.aspx)类中支持时区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-25T21:56:23.423

如果您使用 .Net，则可以使用`TimeZoneInfo`. 既然你用'c#'标记了这个问题，我假设你这样做了。

第一步是获取`TimeZoneInfo`要转换为的时区。在您的示例中，纽约的时区。这是您可以做到的一种方法：

```
//This will get EST time zone
TimeZoneInfo clientTimeZone
    = TimeZoneInfo.FindSystemTimeZoneById("Eastern Standard Time");

//This will get the local time zone, might be useful
// if your application is a fat client
TimeZoneInfo clientTimeZone = TimeZoneInfo.Local; 
```

然后，`DateTime`从数据库中读取 a 后，您需要确保其`Kind`设置正确。假设`DateTime`数据库中的 's 是 UTC（顺便说一下，通常建议这样做），您可以准备将​​其转换为：

```
DateTime aDateTime = dataBaseSource.ReadADateTime();
DateTime utcDateTime = DateTime.SpecifyKind(aDateTime, DateTimeKind.Utc); 
```

最后，为了转换到不同的时区，只需执行以下操作：

```
DateTime clientTime = TimeZoneInfo.ConvertTime(utcDateTime, clientTimeZone); 
```

一些额外的说明：

*   `TimeZoneInfo`如果您只对几个特定时区感兴趣，可以将其存储在静态字段中；
*   `TimeZoneInfo`存储有关夏令时的信息。因此，您不必担心这一点；
*   如果您的应用程序是 Web 应用程序，那么找出您的客户端所在的时区可能会很困难。这里解释了一种方法：http: [//kohari.org/2009/06/15/automagic-time-localization/](http://kohari.org/2009/06/15/automagic-time-localization/)

我希望这有帮助。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T00:35:32.037

在 .NET 3.5 (VS 2008) 之前，.NET 没有任何对时区的内置支持，除了与 UTC 相互转换。

如果全年（夏季和冬季）时差总是正好 3 小时，只需使用**`yourDate.AddHours(3)`**一种方式将其更改，然后**`yourDate.AddHours(-3)`**将其更改回来。请务必将其分解为解释添加/减去这 3 个小时的原因的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T00:36:08.773

您可以使用 TimeZoneInfo.GetSystemTimeZones() 的组合，然后使用 TimeZoneInfo.BaseUtcOffset 属性根据偏移差来偏移数据库中的时间

关于 System.TimeZoneInfo 的信息在[这里](http://msdn.microsoft.com/en-us/library/system.timezoneinfo_members.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T00:50:53.170

你知道，这是一个很好的问题。今年我完成了我的第一个数据库应用程序，因为我与时间相关的输入数据是一个 Int64 值，这就是我存储在数据库中的值。我的客户端应用程序检索它并对该值执行 DateTime.FromUTC() 或 FromFileTimeUTC() 并执行 .LocalTime() 以在其本地时间显示内容。我想知道这是否好/坏/可怕，但到目前为止它已经足够满足我的需求了。当然，这项工作最终由我编写的数据访问层库完成，而不是在数据库本身中完成。

似乎工作得很好，但我相信其他对这类事情有更多经验的人可以指出这不是最好的方法。

祝你好运！

# php - 为本地开发/测试设置 Apache？

> ID：118423
> 
> 赞同：13
> 
> 时间：2008-09-23T00:31:59.407
> 
> 标签：php, codeigniter, apache

Rails 的截屏视频给我留下了深刻的印象，这些视频演示了内置的 Web 服务器和数据库，以允许在本地机器上进行开发和测试。如何让 Apache 实例将项目目录作为其 DocumentRoot 执行，并可能在端口 8080（或类似端口）上提供文件？

我问的原因是我将尝试 CodeIgniter，并且我想将它用于多个项目。我宁愿不要把我机器的 DocumentRoot 都弄得乱七八糟。也欢迎有关如何进行数据库迁移的建议。

* * *

感谢您到目前为止的回复。我应该澄清一下，我使用的是 Mac OS X。看起来 WAMP 仅适用于 Windows。此外，XAMPP 看起来是安装 Apache 和许多其他 Web 工具的好方法，但我看不到加载实例以提供项目目录的方法。Mac OS X 同时安装了 Apache 和 PHP——我只是在寻找一种方法让它在非标准端口上为项目提供服务。

我刚刚发现[MAMP Pro 可以满足](http://www.mamp.info/en/mamp-pro/)我的需求，但如果可能的话，更简约的方法会更好。有没有人`httpd.conf`可以编辑并放入项目目录的文件？

另外，很抱歉我刚刚提出了那个数据库迁移问题。我希望找到能够让我将模式更改推送到实时服务器上而不会丢失现有数据的东西。我怀疑这很困难并且高度依赖于环境因素。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-23T01:44:29.077

您的 Mac 带有一个 Apache Web 服务器和一个 PHP 版本。这是该平台深受 Web 开发人员喜爱的重要原因之一。

由于您使用的是 Code Igniter，因此您需要 PHP 5，这是 PHP 10.5 附带的默认版本。如果您使用的是以前版本的操作系统，请转到[entropy.ch](http://www.entropy.ch/home/)并安装提供的 PHP5 包。

接下来，您需要打开 Apache。在共享首选项面板中，打开个人 Web 共享。这将在您的本地计算机上启动 apache。

接下来，您需要设置一些虚假的开发 URL 以用于您的网站。长期以来的传统是我们会为此使用伪造的 TLD .dev（例如 stackoverflow.dev）。但是，`.dev`它现在是一个实际的 TLD，因此您可能不想这样做 -`.localhost`似乎是一个新兴的事实标准。编辑您的 /etc/hosts 文件并添加以下行

```
127.0.0.1    www.example.localhost
127.0.0.1    example.localhost 
```

这会将上述 URL 指向您的本地计算机。最后一步是配置 apache。具体来说，启用命名虚拟主机、启用 PHP 并设置一些虚拟主机。如果您使用了 entropy PHP 包，则启用 PHP 已经完成。如果没有，您需要按照[此处](http://foundationphp.com/tutorials/php_leopard.php)所述编辑您的 http.conf 文件。基本上，您取消注释将加载 PHP 模块的行。

每当您对 apache 配置进行更改时，您都需要重新启动 apache 以使更改生效。在终端窗口中，键入以下命令

```
sudo apachectl graceful 
```

这将优雅地重新启动 apache。如果您在配置文件中出现语法错误，apache 将不会重新启动。您可以突出显示配置问题

```
sudo apachectl configtest 
```

因此，启用 PHP 后，您需要打开 NamedVirtualHosts。这将让 apache 响应多个 URL。在 http.conf 文件中查找以下（或类似的）行并取消注释。

```
#NameVirtualHost * 
```

最后，您需要告诉 apache 它应该在哪里为您的新虚拟主机查找文件。您可以通过将以下内容添加到您的 http.conf 文件来做到这一点。注意：我发现将这样的配置规则分解到一个单独的文件中并使用 include 指令来包含您的更改是一个很好的最佳实践。这将阻止任何自动更新清除您的更改。

```
<VirtualHost *>
    DocumentRoot /Users/username/Sites/example.localhost
    ServerName example.localhost
    ServerAlias www.example.localhost
</VirtualHost> 
```

您可以将任何文件夹指定为 DocumentRoot，但我发现使用您的个人站点文件夹很方便，因为它已经配置了包含文件的正确权限。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T01:23:40.720

抱歉，凯尔，我没有足够的信誉直接回复您的评论。但是，如果您想让每个项目在不同的端口上提供服务，请尝试像上面 Kelly 的一样设置您的虚拟主机配置（减去 DNS 的东西），除了 80 之外，给每个虚拟主机自己的端口号，假设您已将此端口添加到您的`ports.conf`文件中。

```
NameVirtualHost *

<virtualhost *:80>
DocumentRoot /site1/documentroot
</virtualhost>

<virtualhost *:81>
DocumentRoot /site2/documentroot
</virtualhost>

<virtualhost *:82>
DocumentRoot /site3/documentroot
</virtualhost>

<virtualhost *:83>
DocumentRoot /site4/documentroot
</virtualhost> 
```

希望有帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T00:59:37.143

我还为每个下载了最新的二进制文件并手动设置它们。我发现这是一个轻松的过程，只要您对配置 Apache 有一点了解。

在我的开发机器上，我有[基于名称的虚拟主机的](http://httpd.apache.org/docs/1.3/vhosts/name-based.html)apache 设置。我还有一个[dyndns.org](http://www.dyndns.com/)帐户，它将我的开发域映射到我的本地机器。[DynDNS](http://www.dyndns.com/)提供了一个通配符域，因此使用基于名称的虚拟主机，我可以轻松地为尽可能多的开发域创建尽可能多的站点（具有单独的文档根），所有站点都运行在一个 Apache 实例上。

例如，虚拟主机的 Apache 配置可能类似于

```
NameVirtualHost *:80

<virtualhost *:80>
ServerName site1.mydyndns.dyndns.org
DocumentRoot /site1/documentroot
</virtualhost>

<virtualhost *:80>
ServerName site2.mydyndns.dyndns.org
DocumentRoot /site2/documentroot
</virtualhost> 
```

这是我在本地机器上轻松维护许多开发站点的最快和最简单的方法。

我希望这是有道理的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T01:07:40.447

我不使用 macOS，但我使用 Apache。在我的 apache 配置文件（在 Linux 上通常位于`/etc/apache2/apache2.conf`）中，查找对名为`ports.conf`. 找到这个文件并添加行

```
Listen 8080 
```

然后重启apache进程。在那之后，你应该做生意。如果这在mac上不起作用，我提前道歉:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T00:38:47.817

[您可以使用XAMPP](http://www.apachefriends.org/en/index.html)等低端安装包并将其作为单独的实例运行。还有许多其他类似的项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T00:42:43.953

对于 PHP，您有几个用于部署 Apache+Mysql+PHP 的高质量包，例如[WAMP](http://www.wampserver.com/en/)和[XAMPP](http://www.apachefriends.org/en/xampp.html)。就个人而言，我下载每个最新的二进制文件并手动安装以获得更细粒度的控制。有很多关于如何处理的在线教程。

数据库迁移应该很简单——在服务器上转储数据库，无论是在命令行还是通过[PHPMyAdmin](http://www.phpmyadmin.net/home_page/index.php)之类的界面，然后以类似的方式将其导出（如果您没有使用 Mysql 命令行的经验，建议使用 PHPMyAdmin）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T02:24:43.647

您可以使用 MAMP pro，但免费版本也是一个很好的选择。在这里获取：http: [//www.mamp.info/en/mamp.html](http://www.mamp.info/en/mamp.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T16:25:54.153

我可能会建议为您希望试验的每个开发环境使用单独的 LAMP 虚拟设备。

在 VMware Server 或 VirtualBox 上运行它们。

# mysql - 选择分组到特定标识符的值

> ID：118443
> 
> 赞同：1
> 
> 时间：2008-09-23T00:36:20.833
> 
> 标签：mysql, sql, database

我有一个应用程序可以跟踪游戏中的高分。

我有一个将 user_id 映射到分数的**user_scores**表。

*我需要返回 5 个最高分，但对于任何特定*用户只有 1 个高分。

因此，如果用户 X 在纯数字基础上获得 5 个最高分，我只需返回最高分，然后返回接下来的 4 个用户得分。

我曾尝试使用：

```
SELECT user_id, score 
FROM user_scores 
ORDER BY score DESC 
GROUP BY user_id 
LIMIT 5 
```

但似乎 MySQL 会丢弃任何得分超过 1 的 user_id。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T00:40:22.260

这应该有效：

```
SELECT user_id, MAX(score)
FROM user_scores 
GROUP BY user_id 
ORDER BY MAX(score) DESC 
LIMIT 5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T00:50:27.460

```
SELECT user_id, MAX(score) AS score
FROM user_scores 
GROUP BY user_id
ORDER BY score DESC
LIMIT 5 
```

应该为你做这项工作......虽然不要忘记创建索引......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T00:37:38.660

如果没有汇总函数（SUM、COUNT 等），您将无法分组

GROUP BY 子句说明如何对 SUM 或 COUNT 进行分组。

如果您只是想将长列表分成具有共同值的束，那不是 SQL。这就是您的应用程序必须做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T00:38:59.720

你能用 Distinct 运算符说

```
SELECT DISTINCT(user_id), score
FROM user_scores
ORDER BY score DESC
LIMIT 5 
```

没有测试所以不确定这是否一定会奏效

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T00:49:55.060

仅返回给定用户的最高分数类似于以下内容。

```
SELECT user_id, max(score) FROM user_scores
GROUP BY user_id 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T01:08:12.520

我不知道是缺乏咖啡因还是只是大脑爆炸，但这里的答案很简单。

我实际上让它与这个怪物一起工作：

```
SELECT s1.user_id, 
    (SELECT score FROM user_scores s2 WHERE s2.user_id = s1.user_id ORDER BY score DESC LIMIT 1) AS score 
FROM user_scores s1         
GROUP BY s1.user_id
ORDER BY s1.score DESC        
LIMIT 5 
```

# python - 如何将列表加入字符串（警告）？

> ID：118458
> 
> 赞同：5
> 
> 时间：2008-09-23T00:41:25.330
> 
> 标签：python, string, list, csv

按照我上一个[问题](https://stackoverflow.com/questions/118096/how-can-i-parse-a-comma-delimited-string-into-a-list-caveat)的思路，我如何将字符串列表加入到字符串中，以使值被干净地引用。就像是：

```
['a', 'one "two" three', 'foo, bar', """both"'"""] 
```

进入：

```
a, 'one "two" three', "foo, bar", "both\"'" 
```

我怀疑 csv 模块会在这里发挥作用，但我不确定如何获得我想要的输出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T00:43:42.593

使用该`csv`模块，您可以这样做：

```
import csv
writer = csv.writer(open("some.csv", "wb"))
writer.writerow(the_list) 
```

如果您需要一个字符串，只需将`StringIO`实例用作文件：

```
f = StringIO.StringIO()
writer = csv.writer(f)
writer.writerow(the_list)
print f.getvalue() 
```

输出：`a,"one ""two"" three","foo, bar","both""'"`

`csv`将以稍后可以读回的方式写入。`dialect`您可以根据需要通过定义 a 、 set `quotechar`、`escapechar`等来微调其输出：

```
class SomeDialect(csv.excel):
    delimiter = ','
    quotechar = '"'
    escapechar = "\\"
    doublequote = False
    lineterminator = '\n'
    quoting = csv.QUOTE_MINIMAL

f = cStringIO.StringIO()
writer = csv.writer(f, dialect=SomeDialect)
writer.writerow(the_list)
print f.getvalue() 
```

输出：`a,one \"two\" three,"foo, bar",both\"'`

相同的方言可以与 csv 模块一起使用，以便稍后将字符串读回列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T15:29:04.197

在相关的说明中，Python 的[内置编码器](http://docs.python.org/lib/standard-encodings.html)也可以进行字符串转义：

```
>>> print "that's interesting".encode('string_escape')
that\'s interesting 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T01:26:34.877

这是一个稍微简单的替代方案。

```
def quote(s):
    if "'" in s or '"' in s or "," in str(s):
        return repr(s)
    return s 
```

我们只需要引用一个可能有逗号或引号的值。

```
>>> x= ['a', 'one "two" three', 'foo, bar', 'both"\'']
>>> print ", ".join( map(quote,x) )
a, 'one "two" three', 'foo, bar', 'both"\'' 
```

# performance - pki 与对称加密的性能差异是什么？

> ID：118463
> 
> 赞同：14
> 
> 时间：2008-09-23T00:44:31.860
> 
> 标签：performance, encryption, encryption-symmetric, encryption-asymmetric

我们希望对我们的项目进行一些严格的安全要求，并且我们需要进行大量高性能的加密。

我认为我知道 PKI 比对称加密要慢得多且复杂得多，但我找不到支持我感觉的数字。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-23T00:54:15.097

是的，纯非对称加密比对称密码（如 DES 或 AES）慢得多，这就是实际应用程序使用[混合加密](http://en.wikipedia.org/wiki/Hybrid_cryptosystem)的原因：昂贵的公钥操作仅用于加密（和交换）对称算法的加密密钥将用于加密真实消息。

公钥密码学解决的问题是没有共享秘密。使用对称加密，您必须信任所有相关方来保守密钥的秘密。这个问题应该比性能更受关注（可以通过混合方法来缓解）

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-23T22:13:06.863

在运行 OS X 10.5.5 和 OpenSSL 库存版本的 Macbook 上，“openssl speed”以每秒 46,000 1024 位块的速度运行 AES-128-CBC。同一个盒子以每秒 169 个签名的速度运行 1024 位 RSA。AES-128-CBC 是“教科书”块加密算法，RSA 1024 是“教科书”公钥算法。这是从苹果到橘子，但答案是：**RSA 要慢得多**。

然而，这不是你不应该使用公钥加密的原因。以下是真正的原因：

1.  **公钥加密操作不适用于原始数据加密**。像 Diffie-Hellman 和 RSA 这样的算法被设计为一种为块加密算法交换密钥的方式。因此，例如，您将使用安全随机数生成器为 AES 生成 128 位随机密钥，并使用 RSA 加密这 16 个字节。

2.  **像 RSA 这样的算法比 AES 更不“用户友好”**。使用随机密钥，您提供给 AES 的明文块将随机出现给没有密钥的任何人。RSA 实际上并非如此，它 --- 比 AES 更重要 --- 只是一个数学方程。因此，除了正确存储和管理密钥之外，您还必须非常小心格式化 RSA 纯文本块的方式，否则最终会出现漏洞。

3.  **如果没有密钥管理基础设施，公钥将无法工作**。如果您没有验证公钥的方案，攻击者可以用他们自己的密钥对代替真实的密钥对来发起“中间人”攻击。这就是为什么 SSL 会强制您通过证书的繁琐。*像 AES这样*的块加密算法也确实存在这个问题，但是没有 PKI，AES 的安全性不亚于 RSA。

4.  **公钥加密操作比 AES 更容易受到实施漏洞的影响**。例如，RSA 交易的双方必须就*参数*达成一致，这些参数是输入 RSA 方程的数字。攻击者可以替换一些邪恶的值来静默禁用加密。Diffie Hellman 也是如此，椭圆曲线更是如此。另一个例子是 2 年前在多个高端 SSL 实现中发生的 RSA 签名伪造漏洞。

5.  **使用公钥是您正在做一些“与众不同”的事情的证据**。与众不同正是你*永远*不想使用密码学的东西。除了算法之外，加密*设计*在被认为是安全的之前都要经过多年的审计和测试。

对于希望在其应用程序中使用密码学的客户，我们提出两个建议：

*   **对于“静态数据”，请使用 PGP**。真的！PGP 已经被打败了十多年，被认为可以避免愚蠢的实施错误。它有开源和商业变体。

*   **对于“传输中的数据”，请使用 TLS/SSL**。世界上没有任何安全协议比 TLS 更容易理解和测试。各地的金融机构都接受它作为移动最敏感数据的安全方法。

[这是](http://www.matasano.com/log/558/public-key-signature-forgery-collected/)我和专业密码学家 Nate Lawson 几年前写的一篇不错的文章 [matasano.com]。它更详细地介绍了这些要点。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-23T00:48:38.090

使用 OpenSSL[`speed`](https://www.openssl.org/docs/manmaster/man1/speed.html)子命令对算法进行基准测试并亲自查看。

```
[dave@hal9000 ~]$ openssl speed aes-128-cbc
Doing aes-128 cbc for 3s on 16 size blocks: 26126940 aes-128 cbc's in 3.00s
Doing aes-128 cbc for 3s on 64 size blocks: 7160075 aes-128 cbc's in 3.00s
...
The 'numbers' are in 1000s of bytes per second processed.
type             16 bytes     64 bytes    256 bytes   1024 bytes   8192 bytes
aes-128 cbc     139343.68k   152748.27k   155215.70k   155745.61k   157196.29k

[dave@hal9000 ~]$ openssl speed rsa2048
Doing 2048 bit private rsa's for 10s: 9267 2048 bit private RSA's in 9.99s
Doing 2048 bit public rsa's for 10s: 299665 2048 bit public RSA's in 9.99s
...
                  sign    verify    sign/s verify/s
rsa 2048 bits 0.001078s 0.000033s    927.6  29996.5 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-23T00:54:08.700

实际的基于 PKI 的加密系统使用非对称加密来加密对称密钥，然后使用该密钥进行对称加密来加密数据（话虽如此，有人会指出一个反例）。

因此，非对称加密算法相对于对称加密算法的额外开销是固定的——它不依赖于数据大小，只依赖于密钥大小。

上次我对此进行测试时，验证了 3 个左右的 X.509 证书链 [编辑添加：以及他们正在签名的数据] 在以 100MHz 左右运行的 ARM 上花费了几分之一秒（多次重复的平均值，明显地）。我不记得有多小了——不是可以忽略不计，但不到一秒钟。

抱歉，我不记得确切的细节，但总结是，除非您使用非常受限的系统或进行大量加密（例如，如果您想每秒接受尽可能多的 SSL 连接），NIST 批准非对称加密方法很快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T00:50:18.273

显然它差了 1000 倍。（[http://windowsitpro.com/article/articleid/93787/symmetric-vs-asymmetric-ciphers.html](http://windowsitpro.com/article/articleid/93787/symmetric-vs-asymmetric-ciphers.html)）。但除非你真的在处理大量数据，否则这无关紧要。您可以做的是使用非对称加密来交换对称加密密钥。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T02:15:31.920

也许您可以添加一些有关您的项目的详细信息，以便获得更好质量的答案。你想保护什么？从谁？如果你能解释你的安全要求，你会得到一个更好的答案。如果加密机制不能保护您认为的那样，性能就没有多大意义。

例如，X509 证书是保护客户端/服务器端点的工业标准方式。PGP 装甲可用于保护许可证文件。为简单起见，如果您控制两个端点，则在 Perl 或 Java 中使用 Blowfish（和许多其他密码）进行密码块链接很容易。

谢谢。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-29T17:15:45.610

是的，PGP、TLS 和 CMS 等标准化加密方案提供的混合加密确实对每个消息或会话施加了固定的性能成本。这种影响有多大取决于选择的算法以及您正在谈论的操作。

对于 RSA，解密和签名操作相对较慢，因为它需要使用大的私有指数进行模幂运算。另一方面，RSA 加密和签名验证非常快，因为它使用小的公共指数。这种差异与密钥长度成二次方。

在 ECC 下，由于对等点使用大小相似的密钥进行相同的数学运算，因此操作比 RSA 更加平衡。在集成加密方案中，可以生成临时 EC 密钥，并用于密钥协商算法；这需要消息发送者做一些额外的工作。ECDH 密钥协议比 RSA 加密慢*得多*，但比 RSA 解密快得多。

就相对数量而言，使用 AES 解密可能比使用 RSA 解密快 100,000 倍。就绝对数字而言，很大程度上取决于硬件，AES 每个块可能需要几*纳秒*，而 RSA 需要一两*毫秒*。这就提出了一个问题，为什么有人会使用非对称算法呢？

答案是这些算法在混合加密方案中出于不同目的一起使用。AES 等快速对称算法用于保护消息本身，而 RSA 等慢速非对称算法反过来用于保护对称算法所需的密钥。这使以前从未共享过任何秘密信息的各方（例如您和您的搜索引擎）能够彼此安全地通信。

# windows - 在 Windows 中监视网络连接的工具

> ID：118466
> 
> 赞同：0
> 
> 时间：2008-09-23T00:46:09.780
> 
> 标签：windows, networking, ping, connectivity

你会推荐什么工具来监控机器的连接状态，如果给定的机器能够随着时间的推移连接到一些 Web 服务器。它应该能够记录状态。

[在http://ping-monitors.qarchive.org/](http://ping-monitors.qarchive.org/)上有一长串免费软件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T01:09:07.323

我倾向于使用 Nagios 和 OpenNMS 来监控大批量的服务器（并且在 Unix 环境中，而不是在 windows 中）。然而，我合作过的一些纯橱窗商店非常喜欢使用[What's Up Gold](http://www.whatsupgold.com)。或者，一个快速的 perl 脚本、来自 CPAN 的 LWP 库和计划任务管理器的组合可能也可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T01:08:00.180

当我们不得不做类似的事情时，我们只是模拟了一些 VBS 脚本来尝试连接到我们需要登录的机器。显然在防火墙后面，在同一个域上。将日志转储到 Excel 中。对于某些网络诊断来说快速而肮脏，但不是长期解决方案。

# python - 如何使用 SOAPpy 创建非标准类型？

> ID：118467
> 
> 赞同：3
> 
> 时间：2008-09-23T00:46:14.833
> 
> 标签：python, web-services, soap

我正在使用[SOAPpy](http://pywebsvcs.sourceforge.net/)从 Python调用[WSDL Web 服务](http://www.pingdom.com/services/api-documentation/)。我需要调用的是[Auth_login](http://www.pingdom.com/services/api-documentation/operation_login)方法。这有 2 个参数 - 第一个，一个字符串是 API 密钥；第二个，[包含用户名和密码的自定义类型](http://www.pingdom.com/services/api-documentation/class_CredentialsData)。自定义类型称为 Auth_credentialsData，其中包含 2 个值作为字符串 - 一个用于用户名，一个用于密码。如何使用 SOAPpy 创建此自定义类型？我尝试传递一个列表和一个字典，但都不起作用。

到目前为止的代码：

```
from SOAPpy import WSDL

wsdlUrl = 'https://ws.pingdom.com/soap/PingdomAPI.wsdl'
client = WSDL.Proxy(wsdlUrl) 
```

两种都试过：

```
credentials = ['email@example.com', 'password']
client.Auth_login('key', credentials) 
```

和

```
credentials = {'username': 'email@example.com', 'password': 'passsword'}
client.Auth_login('key', credentials) 
```

两者都给出身份验证失败错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-23T00:54:58.183

更好的方法是使用 ZSI soap 模块，它允许您获取 WDSL 文件并将其转换为您可以用来调用它的类和方法。在线文档[在他们的网站上](http://pywebsvcs.sourceforge.net/zsi.html#SECTION0012300000000000000000)，但最新的文档更容易在源包中找到。如果您安装在 Debian/Ubuntu（软件包名称 python-zsi）中，文档位于 /usr/share/doc/python-zsi 中的一对 PDF 中，您可以在其中找到。

# asp.net-mvc - 动作命名约定

> ID：118474
> 
> 赞同：28
> 
> 时间：2008-09-23T00:47:25.410
> 
> 标签：asp.net-mvc, model-view-controller

是否有人为 MVC 中的操作建立了良好的命名约定？我专门研究了 ASP.net MVC，但这是一个普遍的问题。例如，我有一个显示登录屏幕 (Login) 的操作和一个处理来自该页面的登录请求 (LoginTest) 的操作。我对名字不感兴趣，我还有很多申请要写。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-09-23T10:27:10.100

MS 的 Rob Conery 提出了一些有用的 RESTful 风格命名动作。

> ```
> * Index - the main "landing" page. This is also the default endpoint.
> * List - a list of whatever "thing" you're showing them - like a list of Products.
> * Show - a particular item of whatever "thing" you're showing them (like a Product)
> * Edit - an edit page for the "thing"
> * New - a create page for the "thing"
> * Create - creates a new "thing" (and saves it if you're using a DB)
> * Update - updates the "thing"
> * Delete - deletes the "thing" 
> ```

导致 URL 类似于 (for a forum)

> ```
> * http://mysite/forum/group/list - shows all the groups in my forum
> * http://mysite/forum/forums/show/1 - shows all the topics in forum id=1
> * http://mysite/forums/topic/show/20 - shows all the posts for topic id=20 
> ```

[Rob Conery 谈 MVC 的 RESTful 架构](http://blog.wekeroad.com/2007/12/06/aspnet-mvc-using-restful-architecture/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-21T09:57:38.663

Rails 对 CRUD 操作有一个很好的操作命名约定：[Rails Routing from the Outside In](http://guides.rubyonrails.org/routing.html#crud-verbs-and-actions)。

`HTTP Verb Path Controller#Action Used for GET /photos photos#index display a list of all photos GET /photos/new photos#new return an HTML form for creating a new photo POST /photos photos#create create a new photo GET /photos/:id photos#show display a specific photo GET /photos/:id/edit photos#edit return an HTML form for editing a photo PATCH/PUT /photos/:id photos#update update a specific photo DELETE /photos/:id photos#destroy delete a specific photo`

*这本质上是对[Paul Shannon 答案](https://stackoverflow.com/a/120227/1171227)的更新，因为他的消息来源（Rob Conery）含蓄地说他从 Rails 复制了他的列表。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T17:31:35.090

我发现[Stephen Walther 的一篇博文](http://stephenwalther.com/archive/2008/06/27/asp-net-mvc-tip-11-use-standard-controller-action-names.aspx)有助于找到一致的命名方案。他也源自 REST 风格的命名方案，他解释了一些独特的例外。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-17T10:24:24.793

Stephen Walther 在[ASP.NET MVC Tip #11 – Use Standard Controller Action Names](http://stephenwalther.com/archive/2008/06/27/asp-net-mvc-tip-11-use-standard-controller-action-names)上的帖子可能会澄清您关于命名约定的`MVC Action`命名约定...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T00:51:56.223

内置的 Django 操作后缀为 _done。因此 LoginDone 将是处理登录的页面（在 ASP.NET MVC 驼峰式风格中）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T10:19:52.177

您使用哪种约定来命名 Controller Action 是相当不相关的，只要它对您来说是一致的并且易于被从事它的工作人员理解。

对于您的登录操作，LoginDone 很好，同样，ProcessLogin 也很容易理解，因此请使用您觉得舒服的约定。

就我个人而言，我可能会支持 Login 和 ProcessLogin，因为 LoginDone 在 Action 正在做什么方面可能会有点误导 - 这当然是假设 Action 正在对用户的凭据做出反应并检查它们是否有效。然后，一旦登录成功，您就可以传递到另一个名为 LoginDone 的操作，如果不是，则可以传递到 LoginFailed。

# sql - MySQL Query：选择最近的项目

> ID：118487
> 
> 赞同：3
> 
> 时间：2008-09-23T00:50:14.607
> 
> 标签：sql, mysql

对不起，标题没有更多帮助。我有一个来自两个来源的媒体文件 URL 数据库：

(1) RSS 提要和 (2) 手动输入。

我想查找最近添加的十个 URL，但最多从任何提要中查找一个。为简化起见，表“ `urls`”有列`'url, feed_id, timestamp'`。

`feed_id=''`对于手动输入的任何 URL。

我将如何编写查询？请记住，我想要十个最近的 url，但只有一个来自任何一个`feed_id`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T01:24:17.380

假设 feed_id = 0 是手动输入的东西，这可以解决问题：

```
select p.* from programs p
left join 
(
    select max(id) id1 from programs
    where feed_id <> 0
    group by feed_id
    order by max(id) desc
    limit 10
) t on id1 = id
where id1 is not null or feed_id = 0 
order by id desc
limit 10; 
```

它之所以有效，是因为 id 列不断增加，而且速度也很快。t 是表别名。

这是我原来的答案：

```
(
select 
    feed_id, url, dt 
    from feeds  
    where feed_id = ''
    order by dt desc 
    limit 10
)
union
(

select feed_id, min(url), max(dt) 
        from feeds
        where feed_id <> '' 
        group by feed_id
        order by dt desc    
        limit 10
)
order by dt desc
limit 10 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T01:46:43.800

假设这张表

```
 CREATE TABLE feed (
  feed varchar(20) NOT NULL,
  add_date datetime NOT NULL,
  info varchar(45) NOT NULL,
  PRIMARY KEY  (feed,add_date); 
```

**这个查询应该做你想做**的。内部查询通过提要选择最后一个条目并选择最近的 10 个，然后外部查询返回这些条目的原始记录。

```
 select f2.*
  from (select feed, max(add_date) max_date
          from feed f1
         group by feed
         order by add_date desc
         limit 10) f1
  left join feed f2 on f1.feed=f2.feed and f1.max_date=f2.add_date; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T01:56:54.337

这是（缩写）表：

```
CREATE TABLE programs (
  id int(11) NOT NULL auto_increment,
  feed_id int(11) NOT NULL,
  `timestamp` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
  PRIMARY KEY  (id)
) ENGINE=InnoDB; 
```

这是我基于 sambo99 概念的查询：

```
(SELECT feed_id,id,timestamp 
    FROM programs WHERE feed_id='' 
    ORDER BY timestamp DESC LIMIT 10)
UNION
    (SELECT feed_id,min(id),max(timestamp) 
    FROM programs WHERE feed_id<>'' GROUP BY feed_id 
    ORDER BY timestamp DESC LIMIT 10)
ORDER BY timestamp DESC LIMIT 10; 
```

似乎工作。需要更多测试，但至少我理解它。（一件好事！）。使用“id”列有什么增强？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T00:59:44.193

你可能想要一个[union](http://dev.mysql.com/doc/refman/5.0/en/union.html)。像这样的东西应该工作：

```
 (SELECT 
        url, feed_id, timestamp 
    FROM rss_items  
    GROUP BY feed_id 
    ORDER BY timestamp DESC 
    LIMIT 10)
UNION
    (SELECT 
        url, feed_id, timestamp 
    FROM manual_items  
    GROUP BY feed_id 
    ORDER BY timestamp DESC 
    LIMIT 10)
ORDER BY timestamp DESC
LIMIT 10 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T01:04:57.643

MySQL 对这种类型的查询没有最大的支持。

您可以使用“GROUP-BY”和“HAVING”子句的组合来执行此操作，但您将扫描整个表，这可能会很昂贵。

这里发布了一个更有效的解决方案，假设您有一个关于组 id 的索引： [http ://www.artfulsoftware.com/infotree/queries.php?&bw=1390#104](http://www.artfulsoftware.com/infotree/queries.php?&bw=1390#104)

（基本上，创建一个临时表，将每个组的前 K 插入其中，从表中选择，删除表。这样您就可以从 LIMIT 子句中获得提前终止的好处）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T01:08:14.000

按您想要与众不同的领域进行分组是否有效？

SELECT url, feedid FROM urls GROUP BY feedid ORDER BY timestamp DESC LIMIT 10;

# .net - .Net 1.1 Windows 的 RTF 控件

> ID：118490
> 
> 赞同：1
> 
> 时间：2008-09-23T00:50:49.910
> 
> 标签：.net, controls, rtf

任何人都可以为 .Net 1.1 Windows 开发推荐一个便宜又好的 RTF 控件。它需要能够进行打印/预览和一些基本的文本格式、字体等，但不要太高级。

干杯

安德烈亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T00:54:27.717

如果您有兴趣推出自己的，框架默认提供 RTF 控件。这很神秘，但是可以学习足够的 RTF 来创建简单的格式，并且打印/打印预览都可以使用本机类来实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T01:03:37.490

我认为Scott Lysle 的[这篇文章](http://www.vbdotnetheaven.com/UploadFile/scottlysle/WordProcessor09122006234320PM/WordProcessor.aspx)很好地讨论了如何实现你想要的，以及一些全面的源代码来帮助你入门。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T01:54:39.367

我们已经相当广泛地使用了 Sub Systems 的[TE EDIT](http://www.subsystems.com/tewf.htm) Control。我们评估了很多控件，发现这是迄今为止最好的。API 有点陈旧，但技术支持非常灵敏，我们能够让它做我们需要做的任何事情。

# linq-to-sql - LINQ + 类型表最佳实践

> ID：118497
> 
> 赞同：3
> 
> 时间：2008-09-23T00:52:54.413
> 
> 标签：linq-to-sql

什么是用于 LINQ 的最佳设计模式和 SQL 中存在的类型表。

我在 SQL 中有将值限制为类型值的表，并且我希望能够在我的 C# 代码中将其用作强类型值。

我目前对“PackageStatus”类型的方法如下：

**SQL 表**

> `PackageStatusType (int)`
> `desc (varchar)`

**C# 类 - 使用 LINQ**

```
public class PackageStatusType
{
    static PackageStatusType()
    {

        var lookup = (from p in DataProvider.ShipperDB.PackageStatus
                      select p).ToDictionary(p => p.Desc);

        Unknown = lookup["Unknown"];
        LabelGenerated = lookup["Label generated"];
        ReadyForCollection = lookup["Ready for pickup"];
        PickedUp = lookup["Picked up"];
        InTransit = lookup["In Transit"];
        DeliveryAttempted = lookup["Delivery attempted"];
        DeliveredByHand = lookup["By hand"];
        DeliveryFailed = lookup["Delivery failed"];
        Delivered = lookup["Delivered"];
        Voided = lookup["Voided"];
    }

    public static ShipperDB.Model.PackageStatus Unknown;
    public static ShipperDB.Model.PackageStatus LabelGenerated;
    public static ShipperDB.Model.PackageStatus ReadyForCollection;
    public static ShipperDB.Model.PackageStatus PickedUp;
    public static ShipperDB.Model.PackageStatus InTransit;
    public static ShipperDB.Model.PackageStatus DeliveryAttempted;
    public static ShipperDB.Model.PackageStatus DeliveryFailed;
    public static ShipperDB.Model.PackageStatus Delivered;
    public static ShipperDB.Model.PackageStatus DeliveredByHand;
    public static ShipperDB.Model.PackageStatus Voided;
} 
```

然后我可以`PackageStatusType.Delivered`输入我的 C# 代码，它会正确引用正确的 LINQ 实体。

这很好用，但让我想知道：

a) 我怎样才能提高效率 b) 为什么微软似乎没有提供任何东西来创建强类型表 c) 我的数据库设计甚至是一个好的数据库设计吗？d) 其他人都在做什么！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T01:02:18.960

Linq to SQL 允许您将数据库中的字符串或 int 列映射到 C# 代码中的枚举。这允许您在从数据库中选择时让 Linq to SQL 为您映射这些值。在这种情况下，我会将包状态列更改为包含枚举值的 int 列或表示枚举值的字符串。

在您的情况下，我将有一个具有您指定的不同值的 PackageStatus 枚举，然后使用 ORM 设计器或 SQLMetal，将该列映射到该枚举。唯一需要注意的是，数据库中列中的字符串值必须与枚举中的值匹配，因为 Linq to SQL 将使用 Enum.Parse() 将字符串值从数据库映射到枚举或确保 int 值在数据库中匹配来自枚举的值。

这更有效，因为您甚至根本不需要在代码中映射查找表。

[http://msdn.microsoft.com/en-us/library/bb386947.aspx#EnumMapping](http://msdn.microsoft.com/en-us/library/bb386947.aspx#EnumMapping)描述了它是如何工作的。

# sql-server - 用于测量某物分布的数据库图（ER 图/表格布局）是什么样的？

> ID：118501
> 
> 赞同：8
> 
> 时间：2008-09-23T00:53:57.500
> 
> 标签：sql-server, database, statistics

例如，如果我要*计算*多台计算机上的“活动”并显示该活动的汇总，那么存储数据的数据库会是什么样子？

就这么简单？似乎太简单了。我想太多了。

```
ACTIVITYID  COUNT
----------  ----- 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T01:43:03.840

如果卷不会大得离谱，我可能会创建一个单独记录每个事件的表，并使用 @Turnkey 建议的 DateTime 以及可能记录它的机器等。

```
LOGID (PK)  ACTIVITYID  SOURCE  DATELOGGED
----------  ----------  ------  ---------- 
```

这将使您能够运行查询以获取当前计数，还可以使用数据来确定某个时间段内的事件和/或来自特定机器的事件。ActivityID 上的聚集索引应该为您提供良好的查询性能，并且表很窄，因此插入的成本不应该太高。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T02:50:16.627

我认为实际的活动会在日志表中创建某种类型的记录，其中至少有一个 ActivityId 和 ActivityDate。另一列可能是创建日志条目的计算机的标识符。

然后，您将通过聚合指定时间段内的活动记录来创建计数。

地铁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T01:09:20.490

是的，恐怕就是这么简单，假设您只对每个活动发生的次数感兴趣。填充该表后，您可以通过按计数和绘图进行排序来轻松创建结果的[直方图](http://en.wikipedia.org/wiki/Histogram)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T01:13:35.067

我认为您可以添加一个 DateTime 字段，以便您可以在某个时间间隔之间报告事件，或者至少知道上次活动计数的时间。

# php - 存储过程、MySQL 和 PHP

> ID：118506
> 
> 赞同：3
> 
> 时间：2008-09-23T00:54:37.653
> 
> 标签：php, mysql, stored-procedures

这个问题是一个相当开放的问题。一段时间以来，我一直在经典的 ASP 和 ASP.net 中使用带有 MS SQLServer 的存储过程，并且非常喜欢它们。

我有一个我正在从事的小型爱好项目，由于各种原因，我选择了 LAMP 路线。在 MySQL 和 PHP5 中使用存储过程的任何提示/技巧/陷阱或良好的起点？我的 MySQL 版本支持存储过程。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-12-21T18:17:27.473

@michal kralik - 不幸的是，PDO 使用的 MySQL C API 存在一个错误，这意味着使用某些版本的 MySQL 运行上述代码会导致错误：

> “语法错误或访问冲突：例程 $procedure_name 的 1414 OUT 或 INOUT 参数 $parameter_number 不是变量或新伪变量”。

[您可以在bugs.mysql.com](http://bugs.mysql.com/bug.php?id=11638)上查看错误报告。它已针对 5.5.3+ 和 6.0.8+ 版本进行了修复。

要解决此问题，您需要将输入和输出参数分开，并使用用户变量来存储结果，如下所示：

```
$stmt = $dbh->prepare("CALL sp_takes_string_returns_string(:in_string, @out_string)");
$stmt->bindParam(':in_string', 'hello'); 

// call the stored procedure
$stmt->execute();

// fetch the output
$outputArray = $this->dbh->query("select @out_string")->fetch(PDO::FETCH_ASSOC);

print "procedure returned " . $outputArray['@out_string'] . "\n"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T10:36:02.700

算了`mysqli`，它比 PDO 更难使用，应该已经被删除了。确实，它对 mysql 进行了巨大的改进，但要在 mysqli 中实现相同的效果，有时需要对 PDO 即 associative 付出巨大的努力`fetchAll`。

相反，请查看[PDO](http://www.php.net/manual/en/book.pdo.php)，特别 [是准备好的语句和存储过程](http://www.php.net/manual/en/pdo.prepared-statements.php)。

```
$stmt = $dbh->prepare("CALL sp_takes_string_returns_string(?)");
$value = 'hello';
$stmt->bindParam(1, $value, PDO::PARAM_STR|PDO::PARAM_INPUT_OUTPUT, 4000); 

// call the stored procedure
$stmt->execute();

print "procedure returned $value\n"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T01:13:44.690

您需要使用**MySQLI**（MySQL 改进扩展）来调用存储过程。以下是您如何调用**SP**：

```
$mysqli = new MySQLI(user,pass,db);

$result = $mysqli->query("CALL sp_mysp()"); 
```

使用 SP 时，您需要关闭第一个结果集，否则您会收到错误消息。这里有更多信息：

> [http://blog.rvdavid.net/using-stored-procedures-mysqli-in-php-5/](http://blog.rvdavid.net/using-stored-procedures-mysqli-in-php-5/) （断开的链接）

或者，您可以使用**Prepared Statements**，我觉得它非常简单：

```
 $stmt = $mysqli->prepare("SELECT Phone FROM MyTable WHERE Name=?");

  $stmt->bind_param("s", $myName);

  $stmt->execute(); 
```

MySQLI 文档：[http ://no.php.net/manual/en/book.mysqli.php](http://no.php.net/manual/en/book.mysqli.php)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T21:23:50.913

在 MySQL 5 中使用 mysqli 或 PDO 调用存储过程实际上并不是强制性的。您可以使用旧的 mysql_ 函数很好地调用它们。您唯一不能做的就是返回多个结果集。

我发现返回多个结果集无论如何都容易出错。它在某些情况下确实有效，但前提是应用程序记得将它们全部使用，否则连接将处于断开状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T08:49:04.990

我一直在使用 ADODB，这对于抽象实际命令以使其在不同 SQL Server 之间可移植（即 mysql 到 mssql）非常有用。但是，似乎不直接支持存储过程。这意味着，我已经运行了一个 SQL 查询，就好像它是一个正常的查询一样，但是要“调用”SP。一个示例查询：

```
$query = "Call HeatMatchInsert('$mMatch', '$mOpponent', '$mDate', $mPlayers, $mRound,  '$mMap', '$mServer', '$mPassword', '$mGame', $mSeason, $mMatchType)"; 
```

这不考虑返回的数据，这很重要。我猜这可以通过设置 @Var 来完成，您可以选择自己作为返回 @Variable 。

虽然要抽象一点，尽管制作第一个基于 php 存储过程的 Web 应用程序非常难以解决（mssql 有很好的文档记录，但事实并非如此），但它完成后很棒 - 由于分离，更改很容易进行。

# project-management - 项目报废或归档

> ID：118512
> 
> 赞同：2
> 
> 时间：2008-09-23T00:57:18.847
> 
> 标签：project-management

退出当前活动项目的最佳方法是什么？我已经在这方面工作了一段时间，我认为是时候放手了。没有太多细节，还有其他项目和技术现在遥遥领先，我认为进一步投资它没有太大价值。

你为退出一个项目做了什么？过程是怎样的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T01:04:54.463

随着操作系统、编译器等的变化，重建旧项目可能会很困难。

考虑创建一个配置为再次构建它的虚拟机，以防您将来出于某种原因需要对其进行更新。将该 VM 与源代码等一起归档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T01:01:08.433

我个人之前也做过这个，并且贴在项目的首页

“我不再希望维护这个项目 - 如果你有兴趣接管它，请随时给我发电子邮件 (email@address)”

然后让别人接手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T01:05:19.220

这是个人、社区还是商业/专业项目？

由于缺乏来自客户的反馈，我的专业项目失败了。基本上，他们的发展速度比他们应有的速度要慢，并且已经到了继续使用软件比获得预构建替代软件更昂贵的地步。在那种情况下，我只是引入了数据来向客户展示他们的储蓄在哪里，并建议放弃。它难以下咽，但过了一会儿，他们意识到这是最好的。

# python - 如何使用 xlrd 将 Excel 文件读入 Python？它可以读取较新的 Office 格式吗？

> ID：118516
> 
> 赞同：11
> 
> 时间：2008-09-23T00:58:09.360
> 
> 标签：python, xlrd, import-from-excel

我的问题在下面，但是任何有 xlrd 经验的人都会感兴趣的评论。

我刚刚找到 xlrd，它看起来像是完美的解决方案，但我在开始时遇到了一点问题。我正在尝试以编程方式从我从道琼斯提取的 Excel 文件中提取数据，其中包含道琼斯工业平均指数的当前成分（链接：[http](http://www.djindexes.com/mdsidx/?event=showAverages) ://www.djindexes.com/mdsidx/?event=showAverages ）

当我打开未修改的文件时，出现令人讨厌的 BIFF 错误（无法识别二进制格式）

但是，您可以在此屏幕截图中看到 Excel 2008 for Mac 认为它是“Excel 1997-2004”格式（屏幕截图：[http](http://skitch.com/alok/ssa3/componentreport-dji.xls-properties) ://skitch.com/alok/ssa3/componentreport-dji.xls-properties ）

如果我改为手动在 Excel 中打开它并明确保存为“Excel 1997-2004”格式，然后在 python usig xlrd 中打开，一切都很好。请记住，Office 认为该文件已经是“Excel 1997-2004”格式。所有文件都是 .xls

这是复制问题的 ipython 会话的 pastebin：http: [//pastie.textmate.org/private/jbawdtrvlrruh88mzueqdq](http://pastie.textmate.org/private/jbawdtrvlrruh88mzueqdq)

任何想法：如何欺骗 xlrd 识别文件以便我可以提取数据？如何使用 python 将显式“另存为”格式自动化为 xlrd 将接受的格式？B计划？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-29T14:21:13.750

FWIW，我是 xlrd 的作者，也是 xlwt（pyExcelerator 的一个分支）的维护者。几点：

1.  文件 ComponentReport-DJI.xls 命名错误；它不是 XLS 文件，而是制表符分隔值文件。用文本编辑器（例如记事本）打开它，你就会明白我的意思了。您还可以使用 Python 查看非非常原始的原始字节：

    ```
    >>> open('ComponentReport-DJI.xls', 'rb').read(200)
    'COMPANY NAME\tPRIMARY EXCHANGE\tTICKER\tSTYLE\tICB SUBSECTOR\tMARKET CAP RANGE\
    tWEIGHT PCT\tUSD CLOSE\t\r\n3M Co.\tNew York SE\tMMM\tN/A\tDiversified Industria
    ls\tBroad\t5.15676229508\t50.33\t\r\nAlcoa Inc.\tNew York SE\tA' 
    ```

    您可以使用 Python 的 csv 模块读取此文件……只需`delimiter="\t"`在调用`csv.reader()`.

2.  xlrd 可以读取 pyExcelerator 可以读取的任何文件，并且可以更好地读取它们 - 日期不会以浮点数形式出现，有关 Excel 日期的完整故事在 xlrd 文档中。

3.  pyExcelerator 是废弃软件——xlrd 和 xlwt 还活得好好的。查看[http://groups.google.com/group/python-excel](http://groups.google.com/group/python-excel)

HTH 约翰

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T14:14:03.777

xlrd 对 Office 2007/2008 (OpenXML) 格式的支持处于 alpha 测试阶段 - 请参阅 python-excel 新闻组中的以下帖子： [http ://groups.google.com/group/python-excel/msg/0c5f15ad122bf24b?hl=en](http://groups.google.com/group/python-excel/msg/0c5f15ad122bf24b?hl=en)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T02:05:29.457

有关 pyExcelerator 的更多信息：要读取文件，请执行以下操作：

```
import pyExcelerator
book = pyExcelerator.parse_xls(filename) 
```

其中 filename 是一个字符串，它是要读取的文件名（不是类似文件的对象）。这将为您提供一个表示工作簿的数据结构：一个对列表，其中对的第一个元素是工作表名称，第二个元素是工作表数据。

工作表数据是一个字典，其中键是 (row, col) 对（从 0 开始），值是单元格内容——通常是 int、float 或 string。因此，例如，在所有数据都在第一个工作表上的简单情况下：

```
data = book[0][1]
print 'Cell A1 of worksheet %s is: %s' % (book[0][0], repr(data[(0, 0)])) 
```

如果单元格为空，您将收到 KeyError。如果您正在处理日期，它们*可能*（我忘记了）以整数或浮点数的形式出现；如果是这种情况，您需要转换。基本上规则是： datetime.datetime(1899, 12, 31) + datetime.timedelta(days=n) 但可能相差 1 或 2 （因为 Excel 将 1900 年视为与 Lotus 兼容的闰年，并且因为我不记得 1900-1-1 是 0 还是 1)，所以请进行一些试验和错误检查。日期时间存储为浮点数，我认为（天和一天的一小部分）。

我认为对论坛有部分支持，但我不保证任何事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T01:14:51.067

好吧，这是我做的一些代码：（往下看）：[这里](http://anonsvn.labs.jboss.com/labs/jbossrules/trunk/drools-decisiontables/src/main/resources/python-dt/pydt.py)

不确定更新的格式 - 如果 xlrd 无法读取，xlrd 需要发布新版本！

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-23T02:33:40.647

你必须使用xlrd吗？我刚刚从该网站下载了“更新 - 道琼斯工业平均指数 - 2008”，并且使用[pyExcelerator](http://sourceforge.net/projects/pyexcelerator)阅读它没有任何问题。

```
import pyExcelerator
book = pyExcelerator.parse_xls('DJIAMovers.xls') 
```

# nhibernate - 您如何处理 NHibernate 中的并发性？

> ID：118526
> 
> 赞同：18
> 
> 时间：2008-09-23T01:00:07.220
> 
> 标签：nhibernate

您如何使用 NHibernate 支持乐观/悲观并发？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-23T01:08:19.850

NHibernate 支持 2 种类型的乐观并发。

您可以通过在映射文件中的“class”元素上使用“optimistic-lock=dirty”属性来检查脏字段，也可以使用“optimistic-lock=version”（这也是默认设置）。如果您使用的是版本，则需要在映射文件中提供一个“版本”元素，该元素映射到数据库中的字段。

版本可以是 Int64、Int32、Int16、Ticks、Timestamp 或 TimeSpan 类型，并在保存时自动递增。有关详细信息，请参阅NHibernate 文档中的[第 5 章。](http://nhibernate.info/doc/nh/en/index.html#mapping)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-23T01:03:59.690

NHibernate 默认支持乐观并发。另一方面，悲观并发可以通过该`ISession.Lock()`方法来实现。

[这些问题将在本文档](http://nhibernate.info/doc/nh/en/index.html#transactions)中详细讨论。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T08:28:54.007

您还可以“仅”手动比较版本号（假设您已将 Version 属性添加到您的实体）。

显然，乐观是唯一理智的选择。当然，有时我们必须处理疯狂的场景，但是......

# .net - DataGridView 在我的两个屏幕之一上的可怕重绘性能

> ID：118528
> 
> 赞同：84
> 
> 时间：2008-09-23T01:01:09.463
> 
> 标签：.net, winforms, performance, datagridview, nvidia

## 我实际上已经解决了这个问题，但我将其发布为后代。

我的双显示器系统上的 DataGridView 遇到了一个非常奇怪的问题。该问题表现为控件的极慢重绘（*例如完全重绘需要 30 秒*），但仅当它位于我的一个屏幕上时。另一方面，重绘速度很好。

我有一个 Nvidia 8800 GT，带有最新的非 beta 驱动程序（175。一些东西）。是驱动程序错误吗？我将把它留在空中，因为我必须忍受这种特殊的配置。（但它不会发生在 ATI 卡上……）

绘制速度与单元格内容无关，自定义绘制根本不会提高性能——即使只是绘制一个实心矩形也是如此。

后来我发现在表单上放置一个 ElementHost（来自 System.Windows.Forms.Integration 命名空间）可以解决问题。它不必被弄乱；它只需要是 DataGridView 也打开的表单的子项。只要*Visible*属性为真，它就可以调整为 (0, 0)。

我不想明确地将 .NET 3/3.5 依赖项添加到我的应用程序中；我使用反射创建了一种在运行时（如果可以的话）创建此控件的方法。它可以工作，至少它在没有所需库的机器上优雅地失败了——它只是变慢了。

此方法还允许我在应用程序运行时申请修复，从而更容易查看 WPF 库在我的表单上发生的变化（使用 Spy++）。

经过大量的试验和错误，我注意到在控件本身（而不仅仅是表单）上启用双缓冲可以解决问题！

* * *

因此，您只需要基于 DataGridView 创建一个自定义类，以便启用它的 DoubleBuffering。就是这样！

```
class CustomDataGridView: DataGridView
{
    public CustomDataGridView()
    {
        DoubleBuffered = true;
    }
} 
```

只要我所有的网格实例都使用这个自定义版本，一切都很好。如果我遇到无法使用子类解决方案的情况（如果我没有代码），我想我可以尝试将该控件注入表单:) （*虽然我'将更有可能尝试使用反射从外部强制 DoubleBuffered 属性再次避免依赖*）。

可悲的是，这么简单的事情占用了我这么多时间……

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-10-01T12:41:14.397

您只需要基于 DataGridView 创建一个自定义类，以便启用它的 DoubleBuffering。就是这样！

```
 class CustomDataGridView: DataGridView
{
    public CustomDataGridView()
    {
        DoubleBuffered = true;
    } 
} 
```

只要我所有的网格实例都使用这个自定义版本，一切都很好。如果我遇到无法使用子类解决方案的情况（如果我没有代码），我想我可以尝试将该控件注入表单:) （尽管我'将更有可能尝试使用反射从外部强制 DoubleBuffered 属性再次避免依赖）。

可悲的是，这么简单的事情占用了我这么多时间……

注意：使答案成为答案，以便可以将问题标记为已回答

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-10-01T19:49:51.043

这是一些使用反射设置属性的代码，没有像 Benoit 建议的那样进行子类化。

```
typeof(DataGridView).InvokeMember(
   "DoubleBuffered", 
   BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.SetProperty,
   null, 
   myDataGridViewObject, 
   new object[] { true }); 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-04-24T18:52:47.950

对于搜索如何在 VB.NET 中执行此操作的人，这里是代码：

```
DataGridView1.GetType.InvokeMember("DoubleBuffered", Reflection.BindingFlags.NonPublic Or Reflection.BindingFlags.Instance Or System.Reflection.BindingFlags.SetProperty, Nothing, DataGridView1, New Object() {True}) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-05-18T15:15:03.437

添加到以前的帖子中，对于 Windows 窗体应用程序，这是我用于 DataGridView 组件以使其快速运行的方法。DrawingControl 类的代码如下。

```
DrawingControl.SetDoubleBuffered(control)
DrawingControl.SuspendDrawing(control)
DrawingControl.ResumeDrawing(control) 
```

在构造函数中 InitializeComponent() 之后调用 DrawingControl.SetDoubleBuffered(control)。

在进行大数据更新之前调用 DrawingControl.SuspendDrawing(control)。

大数据更新后调用 DrawingControl.ResumeDrawing(control)。

最后两个最好用 try/finally 块来完成。（或者甚至更好地将类重写为并在构造函数和中`IDisposable`调用。）`SuspendDrawing()``ResumeDrawing()``Dispose()`

```
using System.Runtime.InteropServices;

public static class DrawingControl
{
    [DllImport("user32.dll")]
    public static extern int SendMessage(IntPtr hWnd, Int32 wMsg, bool wParam, Int32 lParam);

    private const int WM_SETREDRAW = 11;

    /// <summary>
    /// Some controls, such as the DataGridView, do not allow setting the DoubleBuffered property.
    /// It is set as a protected property. This method is a work-around to allow setting it.
    /// Call this in the constructor just after InitializeComponent().
    /// </summary>
    /// <param name="control">The Control on which to set DoubleBuffered to true.</param>
    public static void SetDoubleBuffered(Control control)
    {
        // if not remote desktop session then enable double-buffering optimization
        if (!System.Windows.Forms.SystemInformation.TerminalServerSession)
        {

            // set instance non-public property with name "DoubleBuffered" to true
            typeof(Control).InvokeMember("DoubleBuffered",
                                         System.Reflection.BindingFlags.SetProperty |
                                            System.Reflection.BindingFlags.Instance |
                                            System.Reflection.BindingFlags.NonPublic,
                                         null,
                                         control,
                                         new object[] { true });
        }
    }

    /// <summary>
    /// Suspend drawing updates for the specified control. After the control has been updated
    /// call DrawingControl.ResumeDrawing(Control control).
    /// </summary>
    /// <param name="control">The control to suspend draw updates on.</param>
    public static void SuspendDrawing(Control control)
    {
        SendMessage(control.Handle, WM_SETREDRAW, false, 0);
    }

    /// <summary>
    /// Resume drawing updates for the specified control.
    /// </summary>
    /// <param name="control">The control to resume draw updates on.</param>
    public static void ResumeDrawing(Control control)
    {
        SendMessage(control.Handle, WM_SETREDRAW, true, 0);
        control.Refresh();
    }
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-04-13T16:45:37.523

这个问题的答案也对我有用。我想我会添加一个改进，我认为这应该是任何实施该解决方案的人的标准做法。

该解决方案运行良好，除非 UI 在远程桌面下作为客户端会话运行，尤其是在可用网络带宽较低的情况下。在这种情况下，使用双缓冲可能会使性能变差。因此，我建议以下作为更完整的答案：

```
class CustomDataGridView: DataGridView
{
    public CustomDataGridView()
    {
        // if not remote desktop session then enable double-buffering optimization
        if (!System.Windows.Forms.SystemInformation.TerminalServerSession)
            DoubleBuffered = true;
    } 
} 
```

有关详细信息，请参阅[检测远程桌面连接](https://stackoverflow.com/questions/973802/detecting-remote-desktop-connection)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T22:35:41.230

只是添加我们为解决此问题所做的工作：我们升级到最新的 Nvidia 驱动程序解决了这个问题。无需重写任何代码。

为了完整起见，该卡是 Nvidia Quadro NVS 290，驱动程序日期为 2008 年 3 月 (v. 169)。升级到最新版本（2009 年 2 月第 182 版）显着改善了我所有控件的绘制事件，尤其是 DataGridView。

在任何 ATI 卡（发生开发的地方）上都没有发现此问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-07T20:28:17.023

我找到了解决问题的方法。转到高级显示属性中的疑难解答选项卡并检查硬件加速滑块。当我从 IT 部门拿到我的新公司 PC 时，它被设置为从满的一个刻度，我对数据网格没有任何问题。一旦我更新了显卡驱动程序并将其设置为完整，数据网格控件的绘制变得非常缓慢。所以我将它重置回原来的位置，问题就消失了。

希望这个技巧也适用于你。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-10T16:54:18.120

最好的！：

```
Private Declare Function SendMessage Lib "user32" _
  Alias "SendMessageA" _
  (ByVal hWnd As Integer, ByVal wMsg As Integer, _
  ByVal wParam As Integer, ByRef lParam As Object) _
  As Integer

Const WM_SETREDRAW As Integer = &HB

Public Sub SuspendControl(this As Control)
    SendMessage(this.Handle, WM_SETREDRAW, 0, 0)
End Sub

Public Sub ResumeControl(this As Control)
    RedrawControl(this, True)
End Sub

Public Sub RedrawControl(this As Control, refresh As Boolean)
    SendMessage(this.Handle, WM_SETREDRAW, 1, 0)
    If refresh Then
        this.Refresh()
    End If
End Sub 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-07T19:45:51.177

我们在双显示器系统上使用 .NET 3.0 和 DataGridView 时遇到过类似的问题。

我们的应用程序将显示带有灰色背景的网格，表示无法更改单元格。选择“更改设置”按钮后，程序会将单元格的背景颜色更改为白色，以向用户指示可以更改单元格文本。“取消”按钮会将上述单元格的背景颜色更改回灰色。

随着背景颜色的变化，会出现闪烁，这是对具有相同行数和列数的默认大小的网格的简要印象。此问题只会出现在主监视器上（绝不会出现在辅助监视器上），并且不会出现在单个监视器系统上。

双缓冲控件，使用上面的例子，解决了我们的问题。我们非常感谢您的帮助。

# asp.net - 测试 Web 表单应用程序 (ASP.NET) 的最佳方法是什么

> ID：118531
> 
> 赞同：37
> 
> 时间：2008-09-23T01:01:46.530
> 
> 标签：asp.net, webforms, automated-tests

测试我的网络表单应用程序的最佳方法是什么？

看起来人们喜欢Watin和硒。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-26T20:49:22.963

只是想知道，您为什么将 WatiN 称为**单元**测试工具？上次我检查时，它运行了**集成**测试。

最好的方法是将所有不依赖于 HttpContext 的代码移动到单独的程序集中并像往常一样运行单元测试。其余的可以用[Ivonna](http://ivonna.biz)进行测试。她不测试客户的行为，这就是 WatiN 可以提供帮助的地方；但是，如果您想单独测试您的页面或控件，她是您唯一的选择。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-23T01:03:54.213

**更新**：*鉴于 WatiN 已经停滞了一年多，我会指导任何需要 web ui 测试的人使用[selenium](http://seleniumhq.org)，它正在被许多贡献者持续使用和开发，并且被谷歌积极使用。*

[WatiN](http://watin.sourceforge.net/)是我发现的最好的。它集成到 Visual Studio 单元测试或 nunit 中，您可以在浏览器中执行几乎所有您需要的操作（单击链接、提交表单、查找文本/图像等）

有关类似答案，请参阅以下问题：

*   [对 ASP 网页 (C#) 进行单元测试的最佳方法是什么？](https://stackoverflow.com/questions/4363/what-is-the-best-way-to-do-unit-testing-for-asp-web-pages-c#4386)
*   [.Net 的 Web 应用程序测试（watin 测试记录器）](https://stackoverflow.com/questions/15015/web-application-testing-for-net-watin-test-recorder)
*   [您如何以编程方式填写表格并“发布”网页？](https://stackoverflow.com/questions/26857/how-do-you-programmatically-fill-in-a-form-and-post-a-web-page#26864)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-23T01:06:52.600

这是 Webforms 的最大缺点——出于所有实际原因，它在测试控制器的单元测试等方面是不可测试的。

这是 MVC 框架的主要优点之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-03T04:33:58.743

我倾向于将业务逻辑与 UI 代码分离的方法。这是一篇描述单元测试友好模式的文章（Model-View-Presenter）

[http://www.unit-testing.net/CurrentArticle/How-To-Use-Model-View-Presenter-With-AspNet-WebForms.html](http://www.unit-testing.net/CurrentArticle/How-To-Use-Model-View-Presenter-With-AspNet-WebForms.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T01:04:55.383

我会使用 WaitIn 之类的工具：

“WatiN 是 .NET 中的 Web 应用程序测试，此测试记录器将通过在嵌入式 IE 浏览器中记录您的点击来为您生成大量源代码”（来自[Scott Hanselman 的博客](http://www.hanselman.com/blog/ScottHanselmans2007UltimateDeveloperAndPowerUsersToolListForWindows.aspx)——感谢 StackOverflow 上的另一篇文章，我发现了这一点

[等待网站](http://watintestrecord.sourceforge.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T01:21:36.917

我会选择 WATIR（Ruby 中的 Web 应用程序测试）- [http://wtr.rubyforge.org/](http://wtr.rubyforge.org/)。我们（Acsys Interactive）已经使用了大约一年，这个工具很棒。

我在 .NET 中开发了一个简单的包装器，以便我可以从单元测试中执行我的 WATIR 脚本。该框架令人难以置信，并且您拥有完整的 Ruby 功能。支持 Firefox 和 Safari（FireWatir 项目）。

它与 WATIN 非常相似（实际上我认为 WATIN 是受 WATIR 启发的），但我发现 WATIR 社区比 WATIN 社区大得多。

那里有你可以使用的测试记录器和大量的教程。

这真的是你的选择。如果您觉得测试需要使用 .NET 并且您不想支持任何其他语言，那么您的选择是 WATIN。另一方面，如果您想尝试一种有趣且功能强大的脚本语言（这就是 Ruby），那么请选择 WATIR。

向 WATIN 伙计们提问，它是否支持 FireFox/Safari？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-27T14:16:48.620

这是对 Watin、Watir 和 Selenium 的评论 [http://adamesterline.com/2007/04/23/watin-watir-and-selenium-reviewed/](http://adamesterline.com/2007/04/23/watin-watir-and-selenium-reviewed/)

显然 Selenium 对测试人员的工作速度很慢，但如果您注意到，正如其中一条评论所指出的那样，这只是由于它支持多种浏览器而造成的。

然而，WatiN 有一个 CTP（社区技术预览）版本，它提供对 Internet Explorer 和 FireFox 自动化的支持。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-07T02:20:25.570

I have had a great experience using Selenium. Web tests can be very fragile, but here is an article from my blog where I talk about how to make the tests less fragile. [http://www.unit-testing.net/CurrentArticle/How-To-Make-Web-Tests-Less-Fragile.html](http://www.unit-testing.net/CurrentArticle/How-To-Make-Web-Tests-Less-Fragile.html)

# asp.net-mvc - 从 Asp.net MVC 发送 HTML 电子邮件的最佳方式是什么？

> ID：118532
> 
> 赞同：8
> 
> 时间：2008-09-23T01:02:00.693
> 
> 标签：asp.net-mvc, email

我希望能够呈现视图并将其作为电子邮件发送，类似于使用 Ruby on Rails 可以完成的操作。做这个的最好方式是什么？

编辑：到目前为止，我的解决方案是使用模板引擎（NHaml，StringTemplate.net）。它可以工作，但我不希望在我的网站中有第二个模板引擎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T08:58:57.707

一旦发布[mvc-preview-5-rendering-a-view-to-string-for-testing](https://stackoverflow.com/questions/115060/mvc-preview-5-rendering-a-view-to-string-for-testing)得到答案并包含解决方案，该解决方案也适用于这个解决方案。一旦你有了一个字符串，你可以使用默认的 .net 邮件选项（如 dimarzionist：SendMail / SmtpClient 所示）发送它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-09T04:43:11.940

你可以考虑 MvcMailer。[请参阅此处](http://nuget.org/Packages/Search?packageType=Packages&searchCategory=All+Categories&searchTerm=mvcmailer)的 NuGet 包和[项目文档](https://github.com/smsohan/MvcMailer/wiki/MvcMailer-Step-by-Step-Guide)

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T01:02:58.457

这看起来像是 Haacked 建议的方法的一种[可能实现](http://aspnetlibrary.com/articledetails.aspx?article=Use-Response.Filter-to-intercept-your-HTML)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-14T08:10:02.050

我建议[邮政](http://aboutcode.net/postal/)

它允许您使用（强类型）MVC 视图创建电子邮件，并使用标准 SmtpClient 发送它们。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2008-09-23T01:57:01.980

抱歉，伙计，但我认为您对 ASP.NET MVC 的理解有问题。它仍然是 ASP.NET 和框架的一部分，因此您可以使用您在那里使用的相同技术，例如 SendMail 和 SmtpClient。

# video - 您可以控制在 Quartz Composer 中播放的视频剪辑的速度吗？

> ID：118534
> 
> 赞同：4
> 
> 时间：2008-09-23T01:03:00.503
> 
> 标签：video, interpolation, playback, quartz-composer, finalcut

有没有办法控制视频播放的速度？我对一种通过帧混合减慢速度的方法特别感兴趣，就像 Final Cut Pro 中的功能一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T02:08:26.090

目前无法使用内置`Movie Loader`补丁进行帧混合。

不过，您*可以*任意控制播放头。

*   插入`Movie Loader`补丁，并设置`Movie Location`.
*   将其连接到`Billboard`. 电影应该以正常速度播放。
*   右键单击补丁，选择`Timebase`，然后选择`External`。这给了`Movie Loader`补丁一个`Patch Time`输入，并在第一帧冻结它。
    *   您输入的值是应该渲染`Patch Time`的时间偏移量（以秒为单位） 。`Movie Loader`
*   插入一个`Patch Time`补丁，并将其输出连接到`Movie Loader`的`Patch Time`输入。电影应再次以正常速度播放。

有趣的来了：

*   插入`Mathematical Expression`补丁并输入`t/2`方程式。
*   `Patch Time`将补丁连接到 的输入，将`Mathematical Expression`的输出连接到补丁`Mathematical Expression`的`Patch Time`输入`Movie Loader`——电影现在以半速播放。

您可以更改等式以更改播放速率 ---`t/3`将以 1/3 速度`t*2`播放，以双倍速度播放，等等。

**但是**，如果您在播放电影时更改播放速率方程，您会注意到播放头会跳到一个新位置，而不是从前一次继续。

为了解决这个问题，您需要使用`Integrator`补丁。

*   创建一个`Integrator`，将 设置`Value`为`1`，并将`Integrator`' 的输出连接到`Movie Loader`' 的`Patch Time`输入。电影应该以正常速度从头开始播放。
*   `Integrator`将'更改`Value`为`0.5`. 影片应以半速播放，从当前位置继续播放。

您甚至可以使用此技术向后播放电影（不过，根据您使用的编解码器，它可能会严重影响性能）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T02:55:30.030

插值应该能帮到你。Quartz Composer (Interpolation Modes.qtz) 包含一个示例，[这里](http://www.macdevcenter.com/pub/a/mac/2006/03/23/quartz-composer.html)有一个简单提到它的入门教程（第 5 步）。 [这篇 wiki 文章](http://www.quartzcompositions.com/phpBB2/mediawiki/index.php/Interpolation)也讨论了它并讨论了不同的类型。

注意：我实际上没有可以运行 QC 的 Mac，所以这正是我通过谷歌能够找到的，但听起来它应该能让你走上正轨。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-13T11:11:58.607

[v002 Movie Player (Beta)](http://v002.info/?page_id=13)作为内置 Movie Loader 补丁的替代提供了一个`Rate`输入。我得到了非常流畅的视频速度变化。

![v002 电影播放器](https://i.stack.imgur.com/5UlHS.png)

（我添加了`Playhead Seconds`输入；如果其他人觉得有用，我会发布它。）

# drupal - 如何在不修改核心文件或使用 String Override 插件的情况下更改 Drupal 的一些默认菜单字符串？

> ID：118536
> 
> 赞同：1
> 
> 时间：2008-09-23T01:03:23.403
> 
> 标签：drupal

如果您需要更多详细信息，请告诉我。

**编辑**：为清楚起见更改了标题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T00:00:21.333

[http://drupalmodules.com/module/string-overrides](http://drupalmodules.com/module/string-overrides)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T13:23:13.593

如果您使用 Drupal 6，您可以访问[menu_alter](http://api.drupal.org/api/function/hook_menu_alter/6)和[menu_link_alter](http://api.drupal.org/api/function/hook_menu_link_alter/6)钩子。如果您无法通过常规管理选项进行所需的更改，您可以创建一个模块来实现这些钩子中的一个或两个，以便您可以在构建 menu_router 表内容时更改生成的菜单项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T00:29:38.687

如果您只是想更改“我的帐户”页面或“创建内容”页面或任何其他默认 Drupal 页面的标题，那么您可以通过前往“域”来修改菜单项本身。 com/admin/build/菜单/列表”。

例如，如果您想将“我的帐户”的标题更改为“您的帐户”，您会在“/admin/build/menu/list”的菜单列表页面中找到标题为“导航”的菜单。“导航”菜单位于“/admin/build/menu-customize/navigation”。找到菜单项“我的帐户”，然后单击“编辑”。从那里，您可以修改菜单项的标题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T01:05:23.103

Drupal 在他们的网站上提供翻译...

[http://drupal.org/project/Translations](http://drupal.org/project/Translations)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T00:12:12.927

您可以为它创建一个别名。例如，为“论坛”创建一个以指向别名“论坛”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T12:23:37.437

通常，此功能将通过[locale](http://drupal.org/node/290)模块实现，该模块是 Drupal 核心的一部分。对于这种情况，该模块非常易于使用。只需启用它，然后转到设置页面；添加“语言”（只是您网站的一组自定义翻译字符串），然后输入您要翻译的字符串和翻译。

如果您正在运行 Drupal 5，您可能还想查看[localizer](http://drupal.org/project/localizer)模块以获取其他选项。

# python - 我的 snap to grid 代码有什么问题？

> ID：118540
> 
> 赞同：0
> 
> 时间：2008-09-23T01:04:10.003
> 
> 标签：python, graphics, grid

首先，我很确定捕捉到网格相当容易，但是在这种情况下我遇到了一些奇怪的麻烦，而且我的数学太弱，无法具体找出问题所在。

这是情况

我有一个网格的抽象概念，Y 步完全分开 Y_STEP（x 步工作正常，所以暂时忽略它们）

网格在一个抽象的坐标空间中，为了让东西对齐，我在里面有一个神奇的偏移量，我们称之为 Y_OFFSET

捕捉到网格我有以下代码（python）

```
def snapToGrid(originalPos, offset, step):
    index = int((originalPos - offset) / step) #truncates the remainder away
    return index * gap + offset 
```

所以我将光标位置、Y_OFFSET 和 Y_STEP 传递给该函数，它返回网格上最近的地板 y 位置

这在原始场景中似乎工作正常，但是当我考虑到视图是可滚动的事实时，事情变得有点奇怪。

滚动是尽可能基本的，我有一个视口，可以计算沿 Y 轴滚动的距离，并抵消通过它的所有内容。

这是光标的 mouseMotion 代码片段：

```
def mouseMotion(self, event):
    pixelPos = event.pos[Y]
    odePos = Scroll.pixelPosToOdePos(pixelPos)
    self.tool.positionChanged(odePos) 
```

所以这里有两件事要看，首先是 Scroll 模块从像素位置到抽象坐标空间的转换，然后是工具的 positionChanged 函数，它获取抽象坐标空间值并捕捉到最近的 Y 步长。

这是相关的滚动代码

```
def pixelPosToOdePos(pixelPos):
    offsetPixelPos = pixelPos - self.viewPortOffset
    return pixelsToOde(offsetPixelPos)

def pixelsToOde(pixels):
    return float(pixels) / float(pixels_in_an_ode_unit) 
```

工具更新代码

```
def positionChanged(self, newPos):
    self.snappedPos = snapToGrid(originalPos, Y_OFFSET, Y_STEP) 
```

最后一个相关的块是工具去渲染自己的时候。它通过 Scroll 对象，该对象将工具的捕捉坐标空间位置转换为屏幕上的像素位置，代码如下：

```
#in Tool
def render(self, screen):
    Scroll.render(screen, self.image, self.snappedPos)

#in Scroll
def render(self, screen, image, odePos):
    pixelPos = self.odePosToPixelPos(odePos)
    screen.blit(image, pixelPos) # screen is a surface from pygame for the curious

def odePosToPixelPos(self.odePos):
    offsetPos = odePos + self.viewPortOffset
    return odeToPixels(offsetPos)

def odeToPixels(odeUnits):
    return int(odeUnits * pixels_in_an_ode_unit) 
```

唷，这是一个很长的解释。希望你还在我身边...

我现在遇到的问题是，当我向上滚动时，绘制的图像会与光标失去对齐。
它开始捕捉到光标下方恰好 1 步的 Y 步。此外，它似乎逐步进入和退出联盟。
在某些卷轴上它是 1，而在其他卷轴上它是正确的。
它永远不会超过 1，并且总是捕捉到有效的网格位置。

我能想到的最好的猜测是，我在错误的地方截断了一些数据，但不知道它在哪里或如何以这种行为结束。

任何熟悉坐标空间、滚动和捕捉的人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T03:56:48.403

好的，正如 alexk 提到的，我在这里回答我自己的问题，使用 int 截断是我的错误。

我所追求的行为最好由 math.floor() 建模。

抱歉，最初的问题没有包含足够的信息来真正解决问题所在。那时我没有额外的信息。

关于打字错误，我想我可能会以一种令人困惑的方式使用上下文......从 positionChanged() 函数的角度来看，参数是一个新的位置。
从 snapToGrid() 函数的角度来看该参数是正在更改为捕捉位置的原始位置。语言就是这样，因为它的一部分在我的事件处理代码中，另一部分在我的通用服务代码中。我应该为示例更改它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T01:33:59.197

你在 positionChanged() 中有错字吗？

```
def positionChanged(self, newPos):
    self.snappedPos = snapToGrid(newPos, Y_OFFSET, Y_STEP) 
```

我猜你是因为浮点除法的准确性问题而偏离了一个像素。尝试将您的 snapToGrid() 更改为：

```
def snapToGrid(originalPos, offset, step):
    EPS = 1e-6
    index = int((originalPos - offset) / step  + EPS) #truncates the remainder away
    return index * gap + offset 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T02:54:08.240

谢谢解答，可能有错别字，但我看不到...

不幸的是，对 snapToGrid 的更改并没有产生任何影响，所以我认为这不是问题所在。

它不是偏离一个像素，而是偏离 Y_STEP。再玩一些，我发现在屏幕向上滚动的任何时候我都无法让它准确，而且它发生在屏幕顶部，我怀疑这是 ODE 位置为零，所以我猜我的问题是围绕小值或负值。

# c++ - 使用 C/C++ 在 Windows (XP/2003) 上创建 ZIP 文件

> ID：118547
> 
> 赞同：13
> 
> 时间：2008-09-23T01:05:12.557
> 
> 标签：c++, winapi, zip

我正在寻找一种从 Windows C/C++ API 中的文件夹创建 ZIP 文件的方法。我可以找到使用 Shell32.Application CopyHere 方法在 VBScript 中执行此操作的方法，并且我还找到了解释如何在 C# 中执行此操作的教程，但对于 C API 没有任何内容（C++ 也很好，项目已经使用 MFC）。

如果有人可以分享一些可以在 Windows XP/2003 上成功创建 zip 文件的示例 C 代码，我将不胜感激。做不到这一点，如果有人能找到很好的可靠文档或教程，因为 MSDN 搜索不会出现太多。我真的希望避免为此提供第三方库，因为功能显然存在，我只是不知道如何访问它。谷歌搜索没有任何用处，只是一些诱人的信息。在此希望社区中的某个人已经解决了这个问题，并可以分享给后代！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-23T15:26:09.150

如评论中其他地方所述，这仅适用于已创建的 Zip 文件。该内容也必须不存在于 zip 文件中，否则将显示错误。这是我能够根据接受的答案创建的工作示例代码。您需要链接到 shell32.lib 和 kernel32.lib（用于 CreateToolhelp32Snapshot）。

```
#include <windows.h>
#include <shldisp.h>
#include <tlhelp32.h>
#include <stdio.h>

int main(int argc, TCHAR* argv[])
{
    DWORD strlen = 0;
    char szFrom[] = "C:\\Temp",
         szTo[] = "C:\\Sample.zip";
    HRESULT hResult;
    IShellDispatch *pISD;
    Folder *pToFolder = NULL;
    VARIANT vDir, vFile, vOpt;
    BSTR strptr1, strptr2;

    CoInitialize(NULL);

    hResult = CoCreateInstance(CLSID_Shell, NULL, CLSCTX_INPROC_SERVER, IID_IShellDispatch, (void **)&pISD);

    if  (SUCCEEDED(hResult) && pISD != NULL)
    {
        strlen = MultiByteToWideChar(CP_ACP, 0, szTo, -1, 0, 0);
        strptr1 = SysAllocStringLen(0, strlen);
        MultiByteToWideChar(CP_ACP, 0, szTo, -1, strptr1, strlen);

        VariantInit(&vDir);
        vDir.vt = VT_BSTR;
        vDir.bstrVal = strptr1;
        hResult = pISD->NameSpace(vDir, &pToFolder);

        if  (SUCCEEDED(hResult))
        {
            strlen = MultiByteToWideChar(CP_ACP, 0, szFrom, -1, 0, 0);
            strptr2 = SysAllocStringLen(0, strlen);
            MultiByteToWideChar(CP_ACP, 0, szFrom, -1, strptr2, strlen);

            VariantInit(&vFile);
            vFile.vt = VT_BSTR;
            vFile.bstrVal = strptr2;

            VariantInit(&vOpt);
            vOpt.vt = VT_I4;
            vOpt.lVal = 4;          // Do not display a progress dialog box

            hResult = NULL;
            printf("Copying %s to %s ...\n", szFrom, szTo);
            hResult = pToFolder->CopyHere(vFile, vOpt); //NOTE: this appears to always return S_OK even on error
            /*
             * 1) Enumerate current threads in the process using Thread32First/Thread32Next
             * 2) Start the operation
             * 3) Enumerate the threads again
             * 4) Wait for any new threads using WaitForMultipleObjects
             *
             * Of course, if the operation creates any new threads that don't exit, then you have a problem. 
             */
            if (hResult == S_OK) {
                //NOTE: hard-coded for testing - be sure not to overflow the array if > 5 threads exist
                HANDLE hThrd[5]; 
                HANDLE h = CreateToolhelp32Snapshot(TH32CS_SNAPALL ,0);  //TH32CS_SNAPMODULE, 0);
                DWORD NUM_THREADS = 0;
                if (h != INVALID_HANDLE_VALUE) {
                    THREADENTRY32 te;
                    te.dwSize = sizeof(te);
                    if (Thread32First(h, &te)) {
                        do {
                            if (te.dwSize >= (FIELD_OFFSET(THREADENTRY32, th32OwnerProcessID) + sizeof(te.th32OwnerProcessID)) ) {
                                //only enumerate threads that are called by this process and not the main thread
                                if((te.th32OwnerProcessID == GetCurrentProcessId()) && (te.th32ThreadID != GetCurrentThreadId()) ){
                                    //printf("Process 0x%04x Thread 0x%04x\n", te.th32OwnerProcessID, te.th32ThreadID);
                                    hThrd[NUM_THREADS] = OpenThread(THREAD_ALL_ACCESS, FALSE, te.th32ThreadID);
                                    NUM_THREADS++;
                                }
                            }
                            te.dwSize = sizeof(te);
                        } while (Thread32Next(h, &te));
                    }
                    CloseHandle(h);

                    printf("waiting for all threads to exit...\n");
                    //Wait for all threads to exit
                    WaitForMultipleObjects(NUM_THREADS, hThrd , TRUE , INFINITE);

                    //Close All handles
                    for ( DWORD i = 0; i < NUM_THREADS ; i++ ){
                        CloseHandle( hThrd[i] );
                    }
                } //if invalid handle
            } //if CopyHere() hResult is S_OK

            SysFreeString(strptr2);
            pToFolder->Release();
        }

        SysFreeString(strptr1);
        pISD->Release();
    }

    CoUninitialize();

    printf ("Press ENTER to exit\n");
    getchar();
    return 0;

} 
```

尽管获得了半功能代码，但我决定不走这条路，因为经过进一步调查，Folder::CopyHere() 方法似乎实际上并不尊重传递给它的 vOptions，这意味着您不能强制它覆盖文件或不向用户显示错误对话框。

鉴于此，我也尝试了另一张海报提到的 XZip 库。该库可以很好地创建 Zip 存档，但请注意，使用 ZIP_FOLDER 调用的 ZipAdd() 函数不是递归的 - 它只是在存档中创建一个文件夹。为了递归压缩档案，您需要使用 AddFolderContent() 函数。例如，要创建 C:\Sample.zip 并将 C:\Temp 文件夹添加到其中，请使用以下命令：

```
HZIP newZip = CreateZip("C:\\Sample.zip", NULL, ZIP_FILENAME);
BOOL retval = AddFolderContent(newZip, "C:", "temp"); 
```

重要提示：AddFolderContent() 函数不像 XZip 库中包含的那样起作用。由于传递给 ZipAdd() 的路径中存在错误，它将递归到目录结构中，但无法将任何文件添加到 zip 存档中。为了使用此功能，您需要编辑源代码并更改此行：

```
if (ZipAdd(hZip, RelativePathNewFileFound, RelativePathNewFileFound, 0, ZIP_FILENAME) != ZR_OK) 
```

到以下：

```
ZRESULT ret;
TCHAR real_path[MAX_PATH] = {0};
_tcscat(real_path, AbsolutePath);
_tcscat(real_path, RelativePathNewFileFound);
if (ZipAdd(hZip, RelativePathNewFileFound, real_path, 0, ZIP_FILENAME) != ZR_OK) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-23T03:26:56.320

我们为此目的使用 XZip。它是免费的，作为 C++ 源代码提供并且运行良好。

[http://www.codeproject.com/KB/cpp/xzipunzip.aspx](http://www.codeproject.com/KB/cpp/xzipunzip.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-23T01:20:38.357

编辑：这个答案很旧，但我不能删除它，因为它已被接受。看下一个

[https://stackoverflow.com/a/121720/3937](https://stackoverflow.com/a/121720/3937)

----- 原始答案 -----

有示例代码可以做到这一点here

[编辑：链接现已断开]

[http://www.eggheadcafe.com/software/aspnet/31056644/using-shfileoperation-to.aspx](http://www.eggheadcafe.com/software/aspnet/31056644/using-shfileoperation-to.aspx)

确保您阅读了有关如何处理要完成的线程的监视的信息。

编辑：从评论中，此代码仅适用于现有的 zip 文件，但[@Simon](https://stackoverflow.com/users/20135/simonbuchanmyopenidcom)提供了此代码来创建一个空白 zip 文件

```
FILE* f = fopen("path", "wb");
fwrite("\x50\x4B\x05\x06\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0", 22, 1, f);
fclose(f); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-23T18:02:49.320

如评论所述，上述创建空 zip 文件的代码已损坏，但我能够使其正常工作。我在十六进制编辑器中打开了一个空 zip，并注意到了一些差异。这是我修改后的示例：

```
FILE* f = fopen("path", "wb"); 
fwrite("\x50\x4B\x05\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", 22, 1, f);
fclose(f); 
```

这对我有用。然后我能够打开压缩文件夹。未使用 winzip 等 3rd 方应用程序进行测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T01:21:49.023

一个快速的谷歌搜索想出了这个站点：[http](http://www.example-code.com/vcpp/vcUnzip.asp) ://www.example-code.com/vcpp/vcUnzip.asp ，它有一个非常简短的例子，可以使用可下载的库解压缩文件。还有很多其他可用的库。另一个示例可在名为[Zip and Unzip in the MFC way 的](https://www.codeproject.com/Articles/611/Zip-and-Unzip-in-the-MFC-way)Code Project 上获得，它有一个完整的 gui 示例。如果你想用 .NET 来做，那么 System.Compression 下总是有类。

还有 7-Zip 库[http://www.7-zip.org/sdk.html](http://www.7-zip.org/sdk.html)。这包括多种语言的源代码和示例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T01:19:55.720

我不认为 MFC 或 Windows 标准 C/C++ API 提供了内置 zip 功能的接口。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T01:20:40.447

如果您不想发布另一个库，则始终可以静态链接到免费软件 zip 库...

# javascript - 如何从 javascript 调用 Web 服务

> ID：118565
> 
> 赞同：11
> 
> 时间：2008-09-23T01:08:32.783
> 
> 标签：javascript, web-services

假设我有一个网络服务[http://www.example.com/webservice.pl?q=google](http://www.example.com/webservice.pl?q=google)返回文本“google.com”。我需要从带有参数 (q=google) 的 JavaScript 模块调用此 Web 服务 ( [http://www.example.com/webservice.pl](http://www.example.com/webservice.pl) )，然后使用返回值 ("google.com") 做进一步的事情加工。

最简单的方法是什么？我是一个 JavaScript 新手，所以非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-23T03:14:33.980

**编辑：**

[自从我回答这个问题以来已经过去了十年，我们现在以CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)的形式支持跨域 XHR 。

对于任何现代应用程序，请考虑使用[fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch)来发出您的请求。如果您需要对旧版浏览器的支持，您可以添加一个[polyfill](https://github.com/github/fetch)。

**原答案：**

请记住，您不能跨域发出请求。例如，如果您的页面在 yourexample.com 上，而 Web 服务在 myexample.com 上，则您不能直接向它发出请求。

如果您确实需要发出这样的请求，那么您需要在您的服务器上设置一个代理。您将向该代理页面发出请求，它将从 Web 服务检索数据并将其返回到您的页面。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-23T01:10:42.280

看看那里的众多 javascript 库之一。我个人推荐[jQuery](http://www.jquery.com)。除了他们可以做的所有花哨的 UI 东西之外，它还有非常好的[跨浏览器 AJAX 库](http://docs.jquery.com/Ajax)。

```
$.get(
    "http://xyz.com/webservice.pl",
    { q : "google" },
    function(data) {
        alert(data);  // "google.com"
    }
); 
```

# vxworks - 有没有办法在 vxWorks 中为 RTP 和内核模块使用相同的文件？

> ID：118590
> 
> 赞同：0
> 
> 时间：2008-09-23T01:15:41.567
> 
> 标签：vxworks

我们有一个 vxWorks 应用程序，我们希望将其部署为内核模块或实时进程。

有没有办法从同一个源文件中执行此操作，还是我们必须为内核模块创建一个文件，为 RTP 创建另一个文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T01:23:04.870

最简单的解决方案是拥有一个可以编译为内核模块或实时进程的文件。它可能看起来应该是这样的：

```
 void MyModule_Init()
{
   // Initialize the module
   ...
}
...
#ifdef __RTP__
int main(...)
{
   // RTP Main just invokes the Module's initialization
   MyModule_Init();
}
#endif 
```

如果构建用于 RTP 环境
，则定义 __RTP__ 宏 如果构建用于内核环境，则定义 _WRS_KERNEL 宏。

使用这两个宏，您可以为这两个环境编译代码。

# python - 如何在纯 Python 中表达这个 Bash 命令

> ID：118591
> 
> 赞同：1
> 
> 时间：2008-09-23T01:15:54.123
> 
> 标签：python, shell, language-comparisons

我在一个有用的 Bash 脚本中有这一行，但我还没有设法将其翻译成 Python，其中“a”是用户输入的要归档的文件的天数：

```
find ~/podcasts/current -mindepth 2 -mtime '+`a`+' -exec mv {} ~/podcasts/old \; 
```

对于最通用的跨平台元素，我熟悉 os.name 和 getpass.getuser。我也有这个函数来生成相当于 ~/podcasts/current 的所有文件的全名列表：

```
def AllFiles(filepath, depth=1, flist=[]):
    fpath=os.walk(filepath)
    fpath=[item for item in fpath]
    while depth < len(fpath):
        for item in fpath[depth][-1]:
            flist.append(fpath[depth][0]+os.sep+item)
        depth+=1
    return flist 
```

首先，必须有更好的方法来做到这一点，欢迎提出任何建议。无论哪种方式，例如，“AllFiles('/users/me/music/itunes/itunes music/podcasts')”都会在 Windows 上给出相关列表。大概我应该能够检查这个列表并调用 os.stat(list_member).st_mtime 并将所有超过某个天数的东西移到存档中；我有点坚持这一点。

当然，任何带有 bash 命令简洁的东西也会很有启发性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T02:39:18.447

```
import os
import shutil
from os import path
from os.path import join, getmtime
from time import time

archive = "bak"
current = "cur"

def archive_old_versions(days = 3):
    for root, dirs, files in os.walk(current):
        for name in files:
            fullname = join(root, name)
            if (getmtime(fullname) < time() - days * 60 * 60 * 24):
                shutil.move(fullname, join(archive, name)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T03:05:37.027

```
import subprocess
subprocess.call(['find', '~/podcasts/current', '-mindepth', '2', '-mtime', '+5',
                 '-exec', 'mv', '{}', '~/podcasts/old', ';'], shell=True) 
```

这不是开玩笑。这个 python 脚本将完全执行 bash 脚本的工作。

**编辑**：在最后一个参数上删除了反斜杠，因为它不需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T01:34:37.447

这不是 Bash 命令，而是`find`命令。如果你真的想把它移植到 Python 上，这是可能的，但你永远无法编写出如此简洁的 Python 版本。`find`经过 20 多年的优化，在操作文件系统方面表现出色，而 Python 是一种通用编程语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T01:38:31.870

```
import os, stat
os.stat("test")[stat.ST_MTIME] 
```

会给你mtime。我建议修复那些 in `walk_results[2]`，然后递归调用每个 dir 中的函数`walk_results[1]`。

# asp.net - AJAX webservices - web 或 biz 层的扩展？

> ID：118595
> 
> 赞同：0
> 
> 时间：2008-09-23T01:18:02.980
> 
> 标签：asp.net, javascript, ajax, web-services

我的问题可能是一个微妙的问题：

Web 服务——它们是表示/Web 层的扩展吗？..或者它们是商务/数据层的扩展？

这似乎是一个愚蠢的问题。 *Web*服务是*Web*层的扩展。不过我不太确定。我正在构建一个具有一些 AJAX 特性的非常标准的网络表单，在我看来，我可以通过以下两种方式之一构建网络服务：

1.  他们可以为我检索数据（商务/数据层扩展）。
    示例：`GetUserData(userEmail)`
    Web 表单上的 javascript 知道如何使用用户数据并更改标记
2.  他们可以返回完全呈现的用户控件（html；Web 层的扩展）
    示例：`RenderUserProfileControl(userEmail)`
    Web 表单具有简单/哑 js，仅将 Web 服务 html 复制并粘贴到表单中

我可以看到它在任何一种情况下都有效，但我对不同的观点感兴趣......想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T13:41:35.220

在我看来，网络服务有两个特点：

1.  它将数据暴露给外部源，即它们所在的应用程序之外的其他源。从这个意义上说，我同意[@Pete](https://stackoverflow.com/questions/118595/ajax-webservices-extensions-of-web-or-biz-layer#118814)的观点，因为您并没有真正设计 Web 服务。您正在设计一个帮助类，它以类似 Web 服务的方式响应请求。也许是语义上的区别，但事实证明对我有用。
2.  它以可供多个消费者重复使用的格式返回数据（并且仅返回数据）。对我来说，这是对“为什么不 #2”问题的答案——如果你返回类似 web 控制的结构，那么你将 web 服务的有用性限制为其他潜在的调用者。他们**必须**以您返回数据的方式呈现数据，并且不能选择以另一种方式表示它，这会最大限度地降低整个服务的有用性（和重用性）。

综上所述，如果您真正看到的是一个像 Web 服务一样响应的辅助类，并且您只打算在这个用例中使用它，那么您可以做任何您喜欢的事情，而您的案例 #2 将**工作**。不过，在我看来，它打破了职责分离。您将数据访问和呈现功能组合在同一个类中。我怀疑即使您不关心 MVC 模式选项＃2 也会使您的类更难维护，并且您肯定会限制它们对您未来的有用性；如果您曾经想访问相同的数据但以不同的方式呈现它，则需要重构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T01:20:24.533

我会说绝对不是＃2，但＃1是有效的。

我还认为（这是观点）将 Web 服务作为数据访问层并不理想。该服务必须具有更多的价值（总的来说 - 我确信这有明显的例外）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T01:23:49.423

即使在场景 1 中，此服务也呈现数据层中可用的数据，而不是数据层本身的一部分，只是它以不同于 UI 格式（即 JSON、xml 等）的格式呈现数据.)

至于我将使用哪种场景，我会选择场景#1，因为该服务可在其他 Web 表单和其他场景中重用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T02:38:54.063

虽然 #1（定义不是 #2）通常是正确的方法（仅将所需的数据公开到视图层并在那里处理所有标记），但请注意设计中服务的*Web*部分。

如果数据是要远程使用的，则只能将数据公开为 *Web 服务*（SOAP/WSDL、REST）（一些 SOA 架构师可能会争论这一点，但我认为这超出了这个问题的范围），否则你可能会这样做太多了，并且过度设计了您的请求和响应格式。使用对您的应用程序有意义的东西——一个促进客户端/服务器通信并抽象通信底层格式的 Ajax 框架可能会有很大帮助。重要的是很好地封装检索您想要的数据的代码（您可以将其称为服务，但很可能它只是一个编写良好的辅助类），以便可以重用，然后以任何方式公开这些数据方式对给定的应用程序最有意义。

# c# - 即使使用相同的密钥，加密输出也总是不同

> ID：118599
> 
> 赞同：4
> 
> 时间：2008-09-23T01:19:00.123
> 
> 标签：c#, encryption, cryptography

我正在尝试将密码存储在我想稍后检索的文件中。哈希不是一个选项，因为我需要密码以供以后连接到远程服务器。

以下代码运行良好，但即使密钥相同，每次都会创建不同的输出。这很糟糕，因为当应用程序关闭并重新启动时，我将无法再检索我的密码。如何将密码存储在文件中并稍后检索？

```
public class EncyptDecrypt {

    static System.Security.Cryptography.TripleDESCryptoServiceProvider keyProv = new System.Security.Cryptography.TripleDESCryptoServiceProvider();

    public static System.Security.Cryptography.TripleDESCryptoServiceProvider KeyProvider {
        get {
            keyProv.Key = new byte[] { /* redacted with prejudice */ };
            return keyProv;
        }
    }

    public static string Encrypt(string text, SymmetricAlgorithm key) {

        if (text.Equals(string.Empty)) return text;

        // Create a memory stream.
        MemoryStream ms = new MemoryStream();

        // Create a CryptoStream using the memory stream and the
        // CSP DES key.
        CryptoStream encStream = new CryptoStream(ms, key.CreateEncryptor(), CryptoStreamMode.Write);

        // Create a StreamWriter to write a string
        // to the stream.
        StreamWriter sw = new StreamWriter(encStream);

        // Write the plaintext to the stream.
        sw.WriteLine(text);

        // Close the StreamWriter and CryptoStream.
        sw.Close();
        encStream.Close();

        // Get an array of bytes that represents
        // the memory stream.
        byte[] buffer = ms.ToArray();

        // Close the memory stream.
        ms.Close();

        // Return the encrypted byte array.
        return System.Convert.ToBase64String(buffer);
    }

    // Decrypt the byte array.
    public static string Decrypt(string cypherText, SymmetricAlgorithm key) {

        if (cypherText.Equals(string.Empty)) return cypherText;

        string val;

        try {
            // Create a memory stream to the passed buffer.
            MemoryStream ms = new MemoryStream(System.Convert.FromBase64String(cypherText));

            // Create a CryptoStream using the memory stream and the
            // CSP DES key.
            CryptoStream encStream = new CryptoStream(ms, key.CreateDecryptor(), CryptoStreamMode.Read);

            // Create a StreamReader for reading the stream.
            StreamReader sr = new StreamReader(encStream);

            // Read the stream as a string.
            val = sr.ReadLine();

            // Close the streams.
            sr.Close();
            encStream.Close();
            ms.Close();
        }
        catch (System.Exception) {

            return string.Empty;
        }

        return val;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-23T01:22:56.960

我相信正在发生的事情是加密提供者正在随机生成一个 IV。指定这个，它应该不再不同。

编辑：您可以通过设置 IV 属性在“keyProvider”中执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T01:27:18.993

根据 CreateEncryptor 的文档：

> 如果当前 IV 属性是空引用（在 Visual Basic 中为 Nothing），则调用 GenerateIV 方法来创建新的随机 IV。

这将使密文每次都不同。

[注意：这里](https://stackoverflow.com/questions/65879/should-i-use-an-initialization-vector-iv-along-with-my-encryption#66259)讨论了一种解决方法，我建议您可以在明文前面加上 mac ...然后密文的第一个块实际上是 IV，但它都是可重复的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T17:04:21.720

您需要指定一个 IV（初始化向量），即使您生成一个随机向量。如果您使用随机 IV，那么您必须将其与密文一起存储，以便稍后在解密时使用它，或者您可以从其他一些数据中导出 IV（例如，如果您正在加密密码，您可以从用户名）。

# api - 如何访问 Castle Windsor 的 Fluent Interfaces API？

> ID：118615
> 
> 赞同：4
> 
> 时间：2008-09-23T01:23:23.653
> 
> 标签：api, castle-windsor, fluent-interface

在让 Castle Windsor 的非 xml 配置正常工作时，我遇到了很多问题。与此同时，我看到越来越多的人通过 Windsor Container 流畅的界面提供建议。最后一天我一直在谷歌搜索，但我在任何地方都找不到这个 API。

我说的是关键的 .Register() 方法，它似乎是 IWindsorContainer 对象的扩展方法。似乎它可能在 Castle.MicroKernel.Registration 命名空间中，但我在任何地方都找不到相应的库！

另外，有什么地方可以找到这些东西的文档吗？

* * *

**编辑：** 我发现[这里的示例项目](http://rhysc.blogspot.com/2008/08/masstransit-classic-webforms.html)中的 Castle.MicroKernel 副本比我使用的命名空间多（即使这个比我使用的要大 8 天，v1.0.0 而我的是 v1.0.3...），仍然无法找到 .Register() 方法或任何示例。

**编辑：** 我[在 Bitter Coder 找到了一些流畅的界面示例](http://blog.bittercoder.com/PermaLink,guid,6c1a25f7-5c8c-4a5e-bda9-04ffa944ebd0.aspx)，但没有可下载的示例，所以我仍然不知所措。

**再次编辑：**终于明白了。城堡温莎最新的源代码在[这里](http://builds.castleproject.org/cruise/DownloadBuild.castle)，获取最新的成功构建，zip文件里面是一个bin目录。流畅的接口位于 Castle.Microkernel 内部（您可能还需要引用 Castle.Dynaproxy、Castle.Dynaproxy2 和 Castle.Windsor）。

PS这篇文章是“城堡流利的界面文档”的#1谷歌结果伤心的家伙，你需要继续下去。 *蟋蟀啁啾*那是什么？美好的。让我弄清楚这一点，然后我会继续下去。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T03:06:31.767

Fluent 接口是不久前引入的 - 但仅在 Trunk 上可用（在 RC3 之后）或者获取城堡源（来自项目 subversion 存储库）并从[这里](http://svn.castleproject.org:8080/svn/castle/trunk)自己构建 IoC 项目，或者更容易获取最新的成功[构建](http://builds.castleproject.org/cruise/index.castle)持续集成服务器并使用它。

**Castle.MicroKernel.Registration**是您需要在 MicroKernel 程序集中使用的名称空间 - 一旦您拥有相当新的 Castle 构建，您应该能够在 IKernel 和 IWindsorContainer 接口上找到 Register(...) 方法，允许应用“注册组件”（任何实现 IRegistration 的东西），其中包括 Castle 中各种流畅的组件注册功能，以及您可能开发的任何自定义。

询问有关 Castle 问题的最佳地点是 google [castle-project-users](http://groups.google.com/group/castle-project-users?hl=en)和[castle-project-devel](http://groups.google.com/group/castle-project-devel?hl=en)组 - 请特别留意 Craig Neuwirt，因为他是开发 Castle Windsor 流畅界面功能的核心开发人员，等等最适合回答有关各种流畅界面功能的问题，因为它们尚未被广泛记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-05-21T14:11:34.597

好的，仅供参考。API 的官方完整文档位于[Castle Windsor Documentation Wiki](http://stw.castleproject.org/Windsor.Fluent-Registration-API.ashx)

# html - 什么是语义标记，我为什么要使用它？

> ID：118624
> 
> 赞同：10
> 
> 时间：2008-09-23T01:26:28.403
> 
> 标签：html, language-agnostic, xhtml, web-standards, semantic-markup

就像它说的那样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T01:31:48.843

使用语义标记意味着您在页面中使用的 (X)HTML 代码包含描述其用途的元数据——例如，`<h2>`包含员工姓名的可能会被标记`class="employee-name"`。最初有些人希望搜索引擎会使用这些信息，但随着网络的发展，语义标记已主要用于为 CSS 提供挂钩。

使用 CSS 和语义标记，您可以将页面的视觉设计与标记分开。这可以节省带宽，因为设计只需下载一次，并且更容易修改设计，因为它没有混入标记中。

* * *

另一点是使用的元素应该与其中包含的数据具有逻辑关系。例如，表格应该用于表格数据，`<p>`应该用于文本段落，`<ul>`应该用于无序列表等。这与早期的网页设计形成鲜明对比，后者通常使用表格来处理所有事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T01:34:03.410

语义的字面意思是使用“有意义的”语言；在 Web 开发中，这基本上意味着使用描述内容的标签和标识符。

例如，将#Navigation、#Header 和#Content 等ID 应用于<div> 标签，而不是#Left 和#Main，或者将无序列表用于导航链接列表，而不是表格。

主要好处是在未来的维护中；您可以轻松更改布局或演示文稿，而不会失去内容的意义。您的导航栏可以从左向右移动，或者您的链接水平显示而不是垂直显示，而不会失去意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T01:29:09.067

来自[http://www.digital-web.com/articles/writing_semantic_markup/](http://www.digital-web.com/articles/writing_semantic_markup/)：

> 语义标记是具有足够描述性的标记，可以让我们和我们编程的机器识别它并做出决定。换句话说，当我们可以识别它并用它做有用的事情时，标记*就意味着*什么。通过这种方式，语义标记变得不仅仅是描述性的。它成为一种出色的机制，允许人类和机器“理解”相同的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T04:02:36.283

除了已经提到的允许软件“理解”数据的目标之外，还有更多实际应用可以使用它在本体之间进行转换，或者用于在不同的数据表示之间进行映射——而无需转换或标准化数据（这可以导致信息丢失，并且通常会阻止您在未来提高您的理解）。

今年在 OSCon 上至少有 2 场与语义技术的使用相关的会议。一个是关于 BigData（幻灯片可在此处获得：[http](http://en.oreilly.com/oscon2008/public/schedule/proceedings) ://en.oreilly.com/oscon2008/public/schedule/proceedings ，另一个是来自[FreeBase](http://www.freebase.com/)的人。

BigData 使用它在两个不同的数据模型之间进行映射（包括使用专门为处理语义数据集而创建的查询语言）。FreeBase 在不同的数据集之间进行映射，然后执行进一步的分析以得出这些数据集的含义。

要研究的相关主题：OWL、OQL、SPARQL、[Franz](http://www.franz.com/)（AllegroGraph、RacerPRO 和 TopBraid）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-23T16:08:53.117

下面是一个 HTML5 的示例，我一直在使用语义标记的网站，它使用[http://schema.org](http://schema.org)中指定的最近接受的微格式以及 HTML5 的新的语义标记元素。

[http://blog-to-book.com/view/stuff/about/semantic%20web](http://blog-to-book.com/view/stuff/about/semantic%20web)

谷歌有一个方便的语义标签测试工具，它将向您展示如何将语义标签添加到内容中，从而使搜索引擎能够“理解”更多关于您的网页的信息。

这是测试工具：[http ://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fblog-to-book.com%2Fview%2Fstuff%2Fabout%2Fsemantic+web&view=](http://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fblog-to-book.com%2Fview%2Fstuff%2Fabout%2Fsemantic+web&view=)

请注意 google 现在如何知道页面上的“事物”是书籍，并且它们具有 isbn13 标识符。添加其他元数据，例如价格和作者，可以进行进一步的推断。

希望这能为您指明一些有趣的方向。使用良好关系本体可以实现更详细的语义标记，这几乎是我现在能想到的最全面的。

# c++ - C++ 中重载算术运算符的最佳签名是什么？

> ID：118630
> 
> 赞同：1
> 
> 时间：2008-09-23T01:29:26.383
> 
> 标签：c++, operator-keyword

我假设 operator+ 的规范形式，假设存在重载的 operator+= 成员函数，是这样的：

```
const T operator+(const T& lhs, const T& rhs)
{
    return T(lhs) +=rhs;
} 
```

但有人向我指出，这也行得通：

```
const T operator+ (T lhs, const T& rhs)
{
    return lhs+=rhs;
} 
```

本质上，这种形式将临时的创建从实现主体转移到函数调用。

两个参数有不同的类型似乎有点别扭，但是第二种形式有什么问题吗？有理由偏爱其中一个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T01:43:26.897

我不确定两者生成的代码是否有很大差异。

在这两者之间，我（个人）更喜欢第一种形式，因为它更好地传达了意图。这是关于您对 += 运算符的重用和通过 const& 传递模板化类型的习惯用法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T01:39:58.807

对于已编辑的问题，首选第一种形式。编译器更有可能优化返回值（您可以通过在 T 的构造函数中放置断点来验证这一点）。第一种形式也将两个参数都作为 const，这将是更可取的。

**返回值优化**课题的研究，比如这个链接作为一个简单的例子：[http ://www.cs.cmu.edu/~gilpin/c++/performance.html](http://www.cs.cmu.edu/~gilpin/c++/performance.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T02:15:12.890

为了便于阅读，我更喜欢第一种形式。

在我看到第一个参数被复制之前，我不得不三思而后行。我没想到会这样。因此，由于这两个版本可能都一样有效，我会选择一个更容易阅读的版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T04:02:53.537

```
const T operator+(const T& lhs, const T& rhs)
{
    return T(lhs)+=rhs;
} 
```

如果您想要简洁，为什么不这样做呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T07:10:01.153

我的第一个想法是第二个版本可能比第一个版本快得多，因为没有将引用作为参数推送到堆栈上。但是，这将非常依赖于编译器，并且取决于例如编译器是否执行命名返回值优化。

无论如何，如果有任何疑问，永远不要选择一个非常小的性能提升，甚至可能不存在并且您很可能不需要 - 选择最清晰的版本，这是第一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-02T01:09:16.730

实际上，第二个是首选。如 c++ 标准中所述，

> 3.7.2/2：自动存储时长
> 
> 如果命名的自动对象具有初始化或具有副作用的析构函数，则不应在其块结束之前将其销毁，即使看起来未使用，也不应作为优化消除，除非类对象或其副本可以按照 12.8 中的规定消除。

也就是说，由于使用复制构造函数创建了一个未命名的临时对象，编译器可能不会使用返回值优化。然而，对于第二种情况，未命名的返回值优化是允许的。请注意，如果您的编译器实现了命名返回值优化，那么最好的代码是

```
const T operator+(const T& lhs, const T& rhs)
{
    T temp(lhs);
    temp +=rhs;
    return temp;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-02T01:20:44.477

I think that if you inlined them both (I would since they're just forwarding functions, and presumably the operator+=() function is out-of-line), you'd get near indistinguishable code generation. That said, the first is more canonical. The second version is needlessly "cute".

# css - CSS 让表格列占用尽可能多的空间，而其他列则尽可能少

> ID：118632
> 
> 赞同：9
> 
> 时间：2008-09-23T01:30:11.483
> 
> 标签：css, css-tables, column-width

我需要用 CSS 布局一个 html 数据表。

表格的实际内容可能有所不同，但总是有一个主列和 2 个或更多其他列。我想让主列占用尽可能多的宽度，无论其内容如何，​​而其他列占用尽可能少的宽度。我无法为任何列指定确切的宽度，因为它们的内容可能会改变。

如何仅使用简单的语义有效的 html 表和 css 来做到这一点？

例如：

```
| 主栏 | 第 2 栏 | 第 3 栏 |
 <----------------- 固定宽度，单位为 px ------------------->
 <--------尽可能宽-------->
 根据内容尽可能薄：<-----> <-------->

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-23T02:06:40.710

类似于 Alexk 的解决方案，但根据您的情况可能更容易实现：

```
<table>
    <tr>
        <td>foo</td>
        <td class="importantColumn">bar</td>
        <td>woo</td>
        <td>pah</td>
    </tr>
</table>

.importantColumn{
    width: 100%;
} 
```

`white-space:nowrap`如果您想避免包装，您可能还想应用于单元格。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T01:38:07.517

我远不是 CSS 专家，但这对我有用（在 IE、FF、Safari 和 Chrome 中）：

```
td.zero_width {
    width: 1%;
} 
```

然后在您的 HTML 中：

```
<td class="zero_width">...</td> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-31T18:35:36.160

我`width: 100%;`似乎没有成功，因为如果没有具有固定宽度的容器 div，这将无法获得预期的结果。相反，我使用类似下面的东西，它似乎给了我最好的结果。

```
.column-fill { min-width: 325px; } 
```

这样，如果需要，它可以变得更大，并且似乎浏览器会将所有额外空间分配给以这种方式设置的任何列。不确定它是否适用于所有人，但在 chrome 中对我有用（没有尝试过其他人）......值得一试。

# .net - 使用 GC.Collect() 有什么问题？

> ID：118633
> 
> 赞同：109
> 
> 时间：2008-09-23T01:30:12.357
> 
> 标签：.net, performance, memory-management, garbage-collection

尽管我确实理解使用此功能的严重影响（或者至少我是这么认为的），但我不明白为什么它会成为受人尊敬的程序员永远不会使用的东西之一，即使是那些甚至不知道的人它是干什么用的。

假设我正在开发一个应用程序，其中内存使用量根据用户的操作而变化很大。应用程序生命周期可以分为两个主要阶段：编辑和实时处理。在编辑阶段，假设创建了数十亿甚至数万亿个对象；其中有些很小，有些没有，有些可能有终结器，有些可能没有，假设它们的生命周期从几毫秒到几小时不等。接下来，用户决定切换到实时阶段。在这一点上，假设性能起着根本性的作用，并且程序流程中最轻微的改变都可能带来灾难性的后果。然后通过使用对象池等将对象创建减少到最低限度，但随后，GC 意外地插入并将其全部丢弃，并且有人死了。

问题：在这种情况下，在进入第二阶段之前调用 GC.Collect() 不是明智的吗？

毕竟，这两个阶段永远不会在时间上相互重叠，GC 可能收集的所有优化和统计信息在这里用处不大......

注意：正如你们中的一些人所指出的，.NET 可能不是这样的应用程序的最佳平台，但这超出了这个问题的范围。目的是澄清 GC.Collect() 调用是否可以改善应用程序的整体行为/性能。我们都同意你会做这样的事情的情况非常罕见，但话又说回来，GC 试图猜测并且大部分时间都做得很好，但它仍然是猜测。

谢谢。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-09-23T02:15:16.947

[来自 Rico 的博客...](https://docs.microsoft.com/en-us/archive/blogs/ricom/when-to-call-gc-collect)

> **规则1**
> 
> 不。
> 
> 这确实是最重要的规则。公平地说，GC.Collect() 的大多数用法都是一个坏主意，我在原始帖子中详细介绍了这一点，所以我不会在这里重复所有这些。那么让我们继续...
> 
> **规则 #2**
> 
> 如果一些非重复事件刚刚发生并且该事件很可能导致许多旧对象死亡，请考虑调用 GC.Collect()。
> 
> 一个典型的例子是，如果您正在编写一个客户端应用程序，并且您显示一个非常大且复杂的表单，其中包含大量相关数据。您的用户刚刚与此表单进行了交互，可能会创建一些大型对象...诸如 XML 文档或一两个大型 DataSet 之类的东西。当表单关闭时，这些对象已死，因此 GC.Collect() 将回收与它们关联的内存......

所以听起来这种情况可能属于第 2 条规则，你知道有一段时间很多旧对象已经死亡，而且它不会重复出现。但是，不要忘记 Rico 的离别词。

> 在没有强有力证据的情况下，规则 #1 应该胜过规则 #2。

测量，测量，测量。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-09-23T01:49:20.160

如果您在生产代码中调用 GC.Collect() ，您实际上是在声明您比 GC 的作者了解更多。情况可能就是这样。然而，它通常不是，因此强烈建议不要这样做。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-01-12T15:30:57.230

那么，当您使用来自 .NET 的 MS Word 或 MS Excel 等 COM 对象时又如何呢？释放 COM 对象后不调用`GC.Collect`，我们发现 Word 或 Excel 应用程序实例仍然存在。

实际上我们使用的代码是：

```
Utils.ReleaseCOMObject(objExcel)

' Call the Garbage Collector twice. The GC needs to be called twice in order to get the
' Finalizers called - the first time in, it simply makes a list of what is to be finalized,
' the second time in, it actually does the finalizing. Only then will the object do its 
' automatic ReleaseComObject. Note: Calling the GC is a time-consuming process, 
' but one that may be necessary when automating Excel because it is the only way to 
' release all the Excel COM objects referenced indirectly.
' Ref: http://www.informit.com/articles/article.aspx?p=1346865&seqNum=5
' Ref: http://support.microsoft.com/default.aspx?scid=KB;EN-US;q317109
GC.Collect()
GC.WaitForPendingFinalizers()
GC.Collect()
GC.WaitForPendingFinalizers() 
```

那么这会是对垃圾收集器的错误使用吗？如果是这样，我们如何让互操作对象死掉？此外，如果它不打算这样使用，为什么`GC`'`Collect`方法甚至`Public`？

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-23T03:09:26.083

好吧，GC是我爱/恨关系的那些东西之一。我们[过去](http://web.archive.org/web/20100709211835/http://www.vistadb.net/blog/post/2007/12/27/To-Collect-or-not-to-Collect.aspx)通过 VistaDB 打破了它，并在博客中介绍了它。他们已经修复了它，但是需要很长时间才能从他们那里获得对此类问题的修复。

GC 很复杂，在这么大的东西上，一刀切的方法是非常非常难以实现的。MS 在这方面做得相当不错，但有时可能会欺骗 GC。

一般来说，你不应该添加 a `Collect`，除非你知道你刚刚转储了大量内存，如果 GC 现在不清理它，它将进入[中年危机。](https://blogs.msdn.microsoft.com/ricom/2003/12/04/mid-life-crisis/)

`GC.Collect`你可以用一系列糟糕的陈述搞砸整个机器。对 collect 语句的需求几乎总是指向更大的潜在错误。内存泄漏通常与引用有关，并且对它们的工作方式缺乏了解。或者使用`IDisposable`不需要它的 on 对象并在 GC 上施加更高的负载。

通过系统性能计数器密切关注在 GC 中花费的时间百分比。如果你看到你的应用程序在 GC 中使用了 20% 或更多的时间，那么你就有严重的对象管理问题（或异常的使用模式）。您希望始终尽量减少 GC 花费的时间，因为它会加速您的整个应用程序。

同样重要的是要注意，服务器上的 GC 与工作站上的不同。我已经看到一些难以追踪的小问题，因为人们没有同时测试它们（或者甚至不知道他们是其中的两个）。

为了尽可能完整地回答我的问题，如果您也针对该平台，您还应该在 Mono 下进行测试。由于它是一个完全不同的实现，它可能会遇到与 MS 实现完全不同的问题。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-09-23T01:39:49.573

在某些情况下它很有用，但通常应该避免它。您可以将其与 GOTO 或骑轻便摩托车进行比较：您在需要时执行此操作，但您不会告诉您的朋友。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-09-23T01:40:58.307

根据我的经验，在生产代码中调用 GC.Collect() 是不可取的。在调试中，是的，它有助于澄清潜在的内存泄漏。我想我的根本原因是 GC 是由比我聪明得多的程序员编写和优化的，如果我觉得我需要调用 GC.Collect() 这表明我已经偏离了道路某处。在您的情况下，听起来您实际上并没有内存问题，只是您担心集合会给您的流程带来什么不稳定性。看到它不会清除仍在使用的对象，并且它可以非常迅速地适应上升和下降的需求，我想你不必担心它。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-09-23T02:07:19.023

调用 GC.Collect() 的最大原因之一是当您刚刚执行了一个产生大量垃圾的重要事件时，例如您所描述的。在这里调用 GC.Collect() 可能是个好主意；否则，GC 可能无法理解这是“一次性”事件。

当然，您应该对其进行分析，并亲自查看。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-09-23T01:36:20.423

好吧，显然您不应该使用具有非实时垃圾收集的语言编写具有实时要求的代码。

在具有明确定义的阶段的情况下，触发垃圾收集器没有问题。但这种情况极为罕见。问题是很多开发者会尝试用它来以货物崇拜的方式来解决问题，并且不加选择地添加它会导致性能问题。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-09-23T01:55:53.480

调用 GC.Collect() 会强制 CLR 进行堆栈遍历，以查看是否可以通过检查引用来真正释放每个对象。如果对象数量很高，这将影响可伸缩性，并且还已知会过于频繁地触发垃圾收集。信任 CLR 并让垃圾收集器在适当的时候自行运行。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-03-20T15:20:24.210

事实上，我不认为调用 GC.Collect 是一个非常糟糕的做法。
可能有我们需要的情况。例如，我有一个运行线程的表单，该线程反过来打开数据库中的不同表，将 BLOB 字段中的内容提取到临时文件，加密文件，然后将文件读入二进制流并返回 BLOB另一个表中的字段。

整个操作占用了相当多的内存，并且不确定表格中文件内容的行数和大小。

我曾经经常遇到 OutofMemory Exception，我认为基于计数器变量定期运行 GC.Collect 是明智之举。我增加一个计数器，当达到指定的级别时，调用 GC 来收集可能已经形成的任何垃圾，并回收由于不可预见的内存泄漏而丢失的任何内存。

在此之后，我认为它运行良好，至少没有例外！
我通过以下方式调用：

```
var obj = /* object utilizing the memory, in my case Form itself */
GC.Collect(GC.GetGeneration(obj ,GCCollectionMode.Optimized). 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-05-13T16:31:56.990

在.net 下，执行垃圾收集所需的时间与非垃圾的数量密切相关，而不是与垃圾的数量相关。实际上，除非对象覆盖`Finalize`（显式地或通过 C# 析构函数），是 a 的目标`WeakReference`，位于大对象堆上，或者在其他与 gc 相关的方式中是特殊的，否则唯一标识它所在的内存作为一个对象，存在对它的根引用。否则，GC 的操作类似于从建筑物中取出所有有价值的东西，然后将建筑物炸毁，在旧建筑物的场地上建造新建筑物，然后将所有有价值的物品放入其中。炸毁建筑物所需的努力完全与其中的垃圾量无关。

因此，调用`GC.Collect`很容易增加系统必须完成的工作总量。它将延迟下一次收集的发生，但可能会立即完成与下一次收集发生时所需的工作一样多的工作；在发生下一次收集时，收集所花费的总时间将与`GC.Collect`未调用时大致相同，但系统会积累一些垃圾，导致需要比`GC.Collect`没有更早地进行后续收集被调用。

我可以看到`GC.Collect`真正有用的时候是需要测量某些代码的内存使用情况（因为内存使用数字只有在集合之后才真正有意义），或者分析几种算法中的哪一种更好（调用 GC.Collect()在运行几段代码中的每一个之前可以帮助确保一致的基线状态）。在其他一些情况下，人们可能知道 GC 不知道的事情，但是除非您正在编写单线程程序，否则人们无法知道`GC.Collect`可以帮助一个线程的数据结构避免“中年危机”的调用" 不会导致其他线程的数据出现本可以避免的“中年危机”。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-10-22T20:52:34.957

在循环中创建图像 - 即使您调用 dispose，内存也不会恢复。每次都收集垃圾。我的照片处理应用程序的内存从 1.7GB 增加到 24MB，性能非常好。

绝对有时间需要调用 GC.Collect。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2017-04-03T22:18:32.537

显式调用集合并没有错。有些人只是真的想相信，如果它是供应商提供的服务，请不要质疑它。哦，所有这些随机冻结在您的交互式应用程序的错误时刻？下个版本会更好！

让后台进程处理内存操作意味着不必自己处理它，真的。但这在逻辑上并不意味着我们最好不要在任何情况下自己处理它。GC 针对大多数情况进行了优化。但这在逻辑上并不意味着它在所有情况下都得到了优化。

您是否曾经用明确的答案回答过诸如“哪个是最好的排序算法”之类的开放性问题？如果是这样，请不要触摸 GC。对于那些询问条件或给出“在这种情况下”类型答案的人，您可以继续了解 GC 以及何时激活它。

不得不说，我在 Chrome 和 Firefox 中遇到过应用程序冻结，这让我非常沮丧，即使这样，在某些情况下，内存也会不受阻碍地增长——如果他们学会调用垃圾收集器——或者给我一个按钮，这样当我开始阅读页面文本时，我可以点击它，从而在接下来的 20 分钟内不会出现冻结。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2014-02-05T15:32:01.893

我们遇到了垃圾收集器没有收集垃圾并释放内存的类似问题。

在我们的程序中，我们使用 OpenXML 处理一些大小适中的 Excel 电子表格。电子表格包含 5 到 10 张“工作表”，大约 1000 行 14 列。

32 位环境 (x86) 中的程序会因“内存不足”错误而崩溃。我们确实让它在 x64 环境中运行，但我们想要一个更好的解决方案。

我们找到了一个。

以下是一些简化的代码片段，说明在显式调用垃圾收集器以从已处置对象中释放内存时哪些不起作用以及哪些起作用。

从子例程内部调用 GC 不起作用。记忆从未被回收...

```
For Each Sheet in Spreadsheets
    ProcessSheet(FileName,sheet)
Next

Private Sub ProcessSheet(ByVal Filename as string, ByVal Sheet as string)
    ' open the spreadsheet 
    Using SLDoc as SLDocument = New SLDocument(Filename, Sheet)
        ' do some work....
        SLDoc.Save
    End Using
    GC.Collect()
    GC.WaitForPendingFinalizers()
    GC.Collect()
    GC.WaitForPendingFinalizers()
End Sub 
```

通过将 GC 调用移到子例程范围之外，垃圾被收集并释放内存。

```
For Each Sheet in Spreadsheets
    ProcessSheet(FileName,sheet)
    GC.Collect()
    GC.WaitForPendingFinalizers()
    GC.Collect()
    GC.WaitForPendingFinalizers()
Next

Private Sub ProcessSheet(ByVal Filename as string, ByVal Sheet as string)
    ' open the spreadsheet 
    Using SLDoc as SLDocument = New SLDocument(Filename, Sheet)
        ' do some work....
        SLDoc.Save
    End Using
End Sub 
```

我希望这有助于其他对 .NET 垃圾收集感到沮丧的人，因为它似乎忽略了对 .NET 的调用`GC.Collect()`。

保罗·史密斯

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-23T01:33:56.093

我认为你对这个场景是正确的，但我不确定 API。

微软表示，在这种情况下，您应该[添加内存压力](http://msdn.microsoft.com/en-us/library/system.gc.addmemorypressure.aspx)作为 GC 的提示，它应该很快执行一次收集。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-24T23:14:29.157

它出什么问题了？事实上，你在猜测垃圾收集器和内存分配器，它们之间比你更清楚地了解应用程序在运行时的实际内存使用情况。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-19T17:23:38.450

调用 GC.Collect() 的愿望通常是试图掩盖你在其他地方犯的错误！

如果您找到忘记丢弃不再需要的东西的地方会更好。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-08-17T01:19:25.740

它会做的最糟糕的事情是让你的程序冻结一点。所以，如果你没问题，那就去做吧。通常，对于主要是用户交互的胖客户端或 Web 应用程序不需要它。

我发现有时具有长时间运行线程的程序或批处理程序即使正确处理对象也会出现 OutOfMemory 异常。我记得一个业务线数据库事务处理；另一个是胖客户端应用程序中后台线程上的索引例程。

在这两种情况下，结果都很简单：没有 GC.Collect，内存不足，始终如一；GC.Collect，完美的性能。

我已经尝试过多次解决内存问题，但无济于事。我把它拿出来了。

简而言之，除非您遇到错误，否则不要将其放入。如果您将其放入但无法解决内存问题，请将其取出。请记住在发布模式下进行测试并将苹果与苹果进行比较。

唯一可能出现问题的情况是当你对它有道德的时候。这不是价值观问题；许多程序员已经死去，他们的代码中有许多不必要的 GC.Collects，它们比他们更长寿。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-23T01:41:38.070

最重要的是，您可以分析应用程序并查看这些附加集合如何影响事物。我建议您远离它，除非您要进行简介。GC 旨在照顾自己，随着运行时的发展，它们可能会提高效率。您不希望有一堆代码可能会破坏工作并且无法利用这些改进。使用 foreach 而不是 for 也有类似的论点，即未来的改进可以添加到 foreach 中，并且您的代码不必更改即可利用。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-23T03:25:24.187

.NET Framework 本身从未设计为在实时环境中运行。如果您确实需要实时处理，您可以使用不基于 .NET 的嵌入式实时语言，或者使用在 Windows CE 设备上运行的 .NET Compact Framework。

# html - 基于 XML 的 GUI 语言的“必备”功能是什么

> ID：118635
> 
> 赞同：0
> 
> 时间：2008-09-23T01:31:02.667
> 
> 标签：html, xml, user-interface, language-design, xul

迫不及待的总结：

我想知道的是你想用一种新的 gui 语言拥有什么。关于提到的简短答案`$your_favorite_one`；我假设你的意思是，这样的语言应该看起来像`$your_favorite_one`. 这些没有帮助。抵制诱惑。

我正在考虑基于 XML 的语言的用户友好性，例如 XHTML（或 HTML，尽管它们不是 XML，它们非常相似）、XUL、MXML 和其他（在这种情况下，“其他”意味着，我知道存在其他语言及其实现替代它们的原始语言，并且仅按名称提及这些语言的目的是为了让我了解我在说什么，我不想提及任何其他语言，而且，我认为没有无论如何都要尝试制作一个全面的清单。）。我对这种语言应该具有哪些功能有一些看法；

1.  该语言应该是“人类可写的”，这样，普通的开发人员应该能够编写大量代码，而无需不断地参考哪些标签具有哪些属性，什么是允许的。XHTML/HTML 在这方面是最好的。
2.  应该为常见任务内置良好的控件集合。XHTML/HTML 在这里很糟糕。
3.  它应该能够使用类似 css 的语言进行样式设置（就功能而言）。应该很容易区分对结构和眼睛糖果的关注。这个组合整体的布局算法应该简单直观。为什么地狱浮动从布局中删除元素？为什么没有 layout:not-included 或类似的东西？

我知道我什至没有提到非常重要的设计注意事项，例如与渲染引擎和其他通用语言的交互、数据绑定、严格的 XML 合规性（定义新标签的能力？没有命名空间？）但这些都是我想要的问一下你认为对于这种语言来说什么是重要的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T01:52:54.177

最新的 XML GUI 语言（实际上不仅用于 GUI）称为 XAML。它拥有所有这些糖果：样式、布局定义、对象初始化等。但是编写或多或少的大型 XAML 文件很**痛苦。**自动完成有助于但核心问题 - 尖括号森林 - 没有解决。高级基于 XML 的 GUI 语言的另一个问题 - 它们试图同时用于多个目的，但 XML 语法并不适合所有情况。例如 XAML 支持数据绑定，但我为什么要把它写在属性字符串中呢？这是一流的功能，应该有适当的支持。

IMO 所有现代的基于 XML 的语言都非常糟糕。面向*人类*的语言不得强迫其用户编写大量括号或进行深度标签嵌套。它必须是*用户*友好的，而不是*计算机*友好的。我的梦想是拥有具有类似 Python 语法的 GUI 语言。

### 最后我想说：

**亲爱的基于 XML 的语言作者，请保持人性化，不要创建基于 XML 的另一种语言。阅读一些关于领域特定语言的好书，请不要再让我输入 < 和 > 符号。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T02:00:42.457

在能力和简单性之间总会有一个权衡。

就我个人而言，我对用于 MS 开发的 WPF（使用 XAML）的功能感到满意。我根本不认为它的复杂性是发展的障碍。

但是，如果您要将您的工具包/语言定位到需要更高程度的简单性的人群，您可能会利用现有的框架并为最终用户提供特定于他们需求的[DSL 。](http://en.wikipedia.org/wiki/Domain_Specific_Language)

不过，为整个开发社区编写一个新框架是一项艰巨的任务，我怀疑您会发现，由于所需的功能范围广泛，您将不得不*在某些时候*处理大量的复杂性。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T01:52:05.427

您应该指定您是指 Web 客户端还是富客户端，但无论哪种方式，请查看 XAML/WPF。如果你反对 MS，那么看看 Moonlight，它是 SilverLight 的 Mono 实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T03:24:47.480

我希望它能够轻松连接到任何数据库，执行返回记录集的查询，并能够轻松解析和迭代所述记录集以在图形控件中显示其数据，例如饼图、条形图、时间线图（股票期权之类的），具有动画效果的节点图，所有这些都在运行时。

简单的鼠标事件捕捉，实现对鼠标悬停、鼠标悬停、鼠标悬停、点击、拖放、剪贴板管理等的任何操作。一个好的无限缩放功能也很棒。

我不想在设计时设置在我的 SQL 查询中的某些列和某些可显示元素之间建立固定连接的“数据源”，我想随时执行我想要的任何查询并显示与任何查询字段相关的元素, 在运行时。我不想只能在设计时绑定数据源和可显示元素。

一切的 css 样式功能。或者简单易行的事情。

自动调整大小和布局。轻松访问本地文件，进行解析、播放、显示。用于图像管理的简单类，支持透明度、调整大小等。用于在屏幕中绘制的基本和高级类：lineTo、矩形、圆形、动画。甚至是3D。

嵌入字体功能。我不想担心“用户会安装这个字体吗？” 我也不想担心 DPI 或屏幕分辨率。

基本小部件：树视图等。

一个好的设计师。我不想添加编写代码的小部件。我想将它们直观地放置在屏幕上。

此外，如果它可以连接到一般用 C++ 或 COM 对象制作的 dll，那就太好了。

# python - 有没有办法将 Python 代码中的缩进转换为大括号？

> ID：118643
> 
> 赞同：83
> 
> 时间：2008-09-23T01:33:13.363
> 
> 标签：python, accessibility

我是一个完全盲目的程序员，想学习 Python。不幸的是，代码块用不同级别的缩进表示这一事实是一个主要的绊脚石。我想知道是否有任何可用的工具允许我使用大括号或其他代码块分隔符编写代码，然后将该格式转换为 Python 解释器可以使用的正确缩进表示？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-09-23T02:04:01.760

您的问题有一个解决方案，它与 python 本身一起分发。`pindent.py`，它位于 Windows 安装中的 Tools\Scripts 目录中（我的路径是 C:\Python25\Tools\Scripts），如果你正在运行它，看起来你必须[从 svn.python.org 获取它](https://svn.python.org/projects/python/trunk/Tools/scripts/pindent.py)Linux 或 OSX。

它在关闭块时添加注释，或者如果放入注释，它可以正确缩进代码。下面是 pindent 使用命令输出的代码示例：

`pindent.py -c myfile.py`

```
def foobar(a, b):
   if a == b:
       a = a+1
   elif a < b:
       b = b-1
       if b > a: a = a-1
       # end if
   else:
       print 'oops!'
   # end if
# end def foobar 
```

原来`myfile.py`在哪里：

```
def foobar(a, b):
   if a == b:
       a = a+1
   elif a < b:
       b = b-1
       if b > a: a = a-1
   else:
       print 'oops!' 
```

您还可以使用`pindent.py -r`基于注释插入正确的缩进（阅读 pindent.py 的标题以了解详细信息），这应该允许您在 python 中编码而不必担心缩进。

例如，运行`pindent.py -r myfile.py`会将以下代码转换为与上面示例`myfile.py`生成的相同的正确缩进（以及注释）的代码`pindent.py -c`：

```
def foobar(a, b):
if a == b:
a = a+1
elif a < b:
b = b-1
if b > a: a = a-1
# end if
else:
print 'oops!'
# end if
# end def foobar 
```

我有兴趣了解您最终使用的解决方案，如果您需要任何进一步的帮助，请评论这篇文章，我会尽力提供帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-23T01:35:23.517

我个人怀疑目前是否存在，因为许多 Python 爱好者喜欢 Python 的这种方式，空格分隔。

但是，我从未真正将其视为可访问性问题。也许它是作为 Python 的错误报告提出的？

我假设您在这里使用屏幕阅读器来输出？所以标签对你来说似乎是“不可见的”？使用盲文输出可能更容易阅读，但我可以确切地理解这可能是多么令人困惑。

事实上，这对我来说非常有趣。我希望我知道的足够多，能够编写一个可以为你做这件事的应用程序。

我认为这肯定是我会在错误报告中放入的东西，除非你自己已经这样做了，或者想要这样做。

编辑：另外，正如[John Millikin所](https://stackoverflow.com/users/3560/john-millikin)[指出](https://stackoverflow.com/questions/118643#118656)的，还有[PyBraces](http://timhatch.com/projects/pybraces/)这对您来说可能是一个可行的解决方案，并且可能会根据您的编码技能被一起破解以成为您所需要的（我希望如果是这样的话，您将其发布给像您自己一样的其他人使用）

编辑 2：我刚刚[将此报告](http://bugs.python.org/issue3942)给 python 错误跟踪器

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-23T01:51:53.303

虽然我不是盲人，但我听说过关于[Emacspeak](http://emacspeak.sourceforge.net/)的好消息。[自 1998 年发布 8.0 版](http://emacspeak.sourceforge.net/releases/release-8.0.html)以来，他们就拥有了 Python 模式（他们似乎已经发布了 28.0 版！）。绝对值得一试。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-23T01:38:10.683

您应该能够配置您的编辑器来朗读制表符和空格——我知道在大多数编辑器中都可以*显示*空格，因此必须有一个可访问性选项来朗读它们。

如果做不到这一点，还有[pybraces](http://timhatch.com/projects/pybraces/)，它是作为一个恶作剧而写的，但实际上可能对你有一些帮助。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-11-08T15:40:12.840

如果您使用的是 Windows，我强烈建议您从以下网址查看 EdSharp： [http](http://empowermentzone.com/EdSharp.htm) ://empowermentzone.com/EdSharp.htm 它支持所有领先的 Windows 屏幕阅读器，可以配置为说出代码的缩进级别，或者它有一个名为 PyBrace 的内置实用程序，如果你想这样做，它可以转换成大括号语法和从大括号语法转换，它支持程序员在我们的文本编辑器中期望的所有其他功能。我已经使用它多年了，从 PHP 到 JavaScript 到 HTML 到 Python，我喜欢它。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-07-08T09:42:09.123

所有这些“不，你不能”类型的答案真的很烦人。当然可以。

这是一个黑客，但你可以做到。

[http://timhatch.com/projects/pybraces/](http://timhatch.com/projects/pybraces/)

在将大括号交给解释器之前，使用自定义编码将大括号转换为缩进块。

* * *

顺便说一句，作为python的新手——我不接受甚至*不允许*大括号/通用块分隔符背后的原因......除了这是python开发人员的偏好。如果您正在对代码进行一些自动处理或在不了解空格很重要的编辑器中工作，那么大括号至少不会被意外吃掉。如果您要自动生成代码，则不必跟踪缩进级别很方便。如果你想使用 python 来做一个 perl 式的单线，你会自动瘫痪。如果没有别的，只是作为一种保障。如果你的 1000 行 Python 程序的所有标签都被吃掉了怎么办？你要逐行找出缩进应该在哪里？

询问它总是会得到一个诙谐的回答，比如“只做'从__未来__导入大括号'”，“正确配置你的IDE”，“反正它更好，所以习惯它”......

我明白他们的意思，但是，嘿，如果我愿意，我可以在每一行后加一个分号。所以我不明白为什么每个人都对牙套如此执着。如果您需要您的语言来强制您正确缩进，那么您一开始就没有做对。

只是我的 2c - 无论如何我都会使用大括号。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-23T01:43:21.843

我很欣赏你的问题，但认为你是在指定实现而不是你需要解决的问题。与其转换成大括号，不如想办法让屏幕阅读器告诉你缩进级别？

例如，[有些人](http://viming.blogspot.com/2007/02/indent-level-highlighting.html)研究过 vim 语法着色来表示 python 缩进级别。也许修改后的语法着色可以产生您的屏幕阅读器会阅读的内容？

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-08-16T23:34:46.350

搜索一个可访问的 Python IDE，发现这个并决定回答。在带有 JAWS 的 Windows 下：

1.  在您喜欢的文本编辑器中按`JawsKey`+ `6`（在字母上方的数字行上）进入设置中心。如果 JAWS 提示创建新的配置文件，请同意。
2.  在搜索字段中，输入“缩进”
3.  只会有一个结果：“说缩进字符”。打开这个。
4.  享受！

唯一让我们感到沮丧的是，我们无法在网站上享受代码示例（因为在浏览器中使用缩进说话不太舒服——它会产生多余的语音）。

来自另一个 Python 初学者的快乐编码）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-25T20:06:08.097

我将 eclipse 与 pydev 扩展一起使用，因为它是我有很多经验的 IDE。我也很欣赏它为编码 if 语句、循环等提供的智能缩进。我已经将 pindent.py 脚本配置为一个外部工具，我可以在当前专注的 python 模块上运行它，这让我的生活更轻松，所以我可以看到什么是关闭的地方不必经常检查缩进。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-17T18:49:29.283

有各种答案解释了如何做到这一点。但我建议不要走这条路。虽然您可以使用脚本进行转换，但它会使团队项目的工作变得困难。

我的建议是配置您的屏幕阅读器以宣布选项卡。这并不像听起来那么烦人，因为它只会说“缩进 5”而不是“tab tab tab tab tab”。此外，缩进只有在更改时才会被读取，因此您可以通过整个代码块而不会听到缩进级别。这样，听到缩进并不比听到大括号更冗长。

由于我不知道您使用哪种操作系统或屏幕阅读器，很遗憾我无法给出实现这一目标的确切步骤。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-09-25T22:36:33.670

[Edsger Dijkstra](http://en.wikipedia.org/wiki/Edsger_Dijkstra)在他的“受保护的命令语言”中使用了[if ~ fi](http://en.wikipedia.org/wiki/Guarded_Command_Language#Selection:_if)和[do ~ od](http://en.wikipedia.org/wiki/Guarded_Command_Language#Repetition:_do)，这些似乎起源于[Algol68](https://sourceforge.net/projects/algol68/)。[RosettaCode.org](http://rosettacode.org/wiki/Python)中还使用了一些示例 python 保护块。

```
fi = od = yrt = end = lambda object: None;
class MyClass(object):
    def myfunction(self, arg1, arg2):
        for i in range(arg1) :# do
            if i > 5 :# then
                print i
            fi
        od # or end(i) #
    end(myfunction)
end(MyClass) 
```

如果使用保护块 if/fi、do/od 和 try/yrt 以及分号 ";" 分开陈述。非常适合明确的杂志列表或从网页剪切/粘贴。

编写一个简短的 python 程序来插入/删除保护块和分号应该很容易。

# import - 将网站导入 Visual Sourcesafe 2005 数据库的最佳方式

> ID：118648
> 
> 赞同：0
> 
> 时间：2008-09-23T01:34:49.820
> 
> 标签：import, visual-sourcesafe

将网站导入 Visual Sourcesafe 2005 数据库的最佳方法是什么？

我尝试打开 VSS 数据库并拖放文件夹，但它开始提示我对每个文件夹进行评论。有没有更好的方法或某种方式让它只询问一次正在处理的任何文件或文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T01:41:00.100

我假设您为您的网站使用 ASP.NET，如果不是我很抱歉，但您没有在您的问题中指定。这里有一篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms972977.aspx#vssstarttofinish_topic4)描述了如何在 VSS 中使用 ASP.NET 网站，希望对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T02:45:51.397

如果您有安装了 VSS 源代码控制插件的 Visual Studio (03/05/08)，则可以很容易地右键单击现有解决方案或项目并选择“将 X 添加到 SourceSafe”。

# .net - 铁蟒，美汤，win32 app

> ID：118654
> 
> 赞同：21
> 
> 时间：2008-09-23T01:37:48.830
> 
> 标签：.net, python, ironpython

美汤配铁蟒有用吗？如果是这样，使用哪个版本的铁蟒？使用 Iron python 在 .net 2.0 上分发 Windows 桌面应用程序有多容易（主要是 c# 调用一些 python 代码来解析 html）？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-04T19:04:21.950

我问自己同样的问题，在努力遵循这里和其他地方的建议以使 IronPython 和 BeautifulSoup 与我现有的代码很好地配合之后，我决定去寻找一个替代的原生 .NET 解决方案。BeautifulSoup 是一段很棒的代码，起初它看起来没有任何可用于 .NET 的可比较的东西，但后来我发现了[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)，如果有的话，我认为我实际上已经获得了比 BeautifulSoup 的一些可维护性。它采用干净或粗糙的 HTML 并从中生成优雅的 XML DOM，可以通过 XPath 进行查询。使用几行代码，您甚至可以取回原始 XDocument，然后[在 LINQ to XML 中制作您的查询](http://vijay.screamingpens.com/archive/2008/05/26/linq-amp-lambda-part-3-html-agility-pack-to-linq.aspx). 老实说，如果网络抓取是您的目标，那么这是您可能找到的最干净的解决方案。

**编辑**

这是一个解析美国众议院假期时间表的简单（阅读：根本不健全）示例：

```
using System;
using System.Collections.Generic;
using HtmlAgilityPack;

namespace GovParsingTest
{
    class Program
    {
        static void Main(string[] args)
        {
            HtmlWeb hw = new HtmlWeb();
            string url = @"http://www.house.gov/house/House_Calendar.shtml";
            HtmlDocument doc = hw.Load(url);

            HtmlNode docNode = doc.DocumentNode;
            HtmlNode div = docNode.SelectSingleNode("//div[@id='primary']");
            HtmlNodeCollection tableRows = div.SelectNodes(".//tr");

            foreach (HtmlNode row in tableRows)
            {
                HtmlNodeCollection cells = row.SelectNodes(".//td");
                HtmlNode dateNode = cells[0];
                HtmlNode eventNode = cells[1];

                while (eventNode.HasChildNodes)
                {
                    eventNode = eventNode.FirstChild;
                }

                Console.WriteLine(dateNode.InnerText);
                Console.WriteLine(eventNode.InnerText);
                Console.WriteLine();
            }

            //Console.WriteLine(div.InnerHtml);
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-23T01:53:58.620

我已经在 IPy 1.1 和 2.0 中测试并使用了 BeautifulSoup（忘记哪个 beta，但这是几个月前的事了）。如果您仍然遇到问题，请发表评论，我会挖掘我的测试代码并发布它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-23T01:43:40.530

如果 BeautifulSoup 在 IronPython 上不起作用，那是因为 IronPython 没有实现整个 Python 语言（与 CPython 一样）。BeautifulSoup是pure-python，没有C-extensions，所以唯一的问题是IronPython与CPython在Python源代码方面的兼容性。应该没有，但如果有，错误会很明显（“没有模块命名为 ...”、“没有命名为 ... 的方法”等）。谷歌表示只有 BS 的一项测试在 IronPython 上失败了。它可能有效，并且该测试现在可能已修复。我不会知道的。

试试看，这将是我的建议，除非有人有更具体的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T20:16:56.330

此外，关于先前关于使用 -X:SaveAssemblies 编译的评论之一 - 这是错误的。-X:SaveAssemblies 是一种调试功能。有一个 API 用于将 python 代码编译成二进制文件。[这篇文章](http://blogs.msdn.com/srivatsn/archive/2008/08/06/static-compilation-of-ironpython-scripts.aspx)解释了 API 以及两种模式之间的区别。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T20:10:02.993

关于问题的第二部分，您可以使用 DLR Hosting API 从 C# 应用程序中运行 IronPython 代码。DLR 托管规范在[这里](http://compilerlab.members.winisp.net/dlr-spec-hosting.pdf)。该[博客](http://blogs.msdn.com/seshadripv/)还包含一些示例托管应用程序

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-13T15:31:20.553

我们正在分发一个 40k 行的 IronPython 应用程序。我们还不能将整个东西编译成一个二进制可分发文件。取而代之的是，我们一直将它作为无数个微小的 dll 分发，每个 IronPython 模块一个。不过，这很好用。

然而，在较新的版本 IronPython 2.0 上，我们最近出现了一个峰值，它似乎能够将所有内容编译成一个二进制文件。这也导致更快的应用程序启动（模块导入更快。）希望这个峰值将在接下来的几天内迁移到我们的主树中。

我们使用 WiX 进行分发，这是一个用于创建 msi 安装的 Microsoft 内部工具，它已经开源（或至少免费提供）。它没有给我们带来任何问题，即使我们的安装有一些相当繁琐的要求。将来我一定会考虑使用 WiX 分发其他 IronPython 项目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-01T14:24:05.940

似乎与 IronPython 2.7 一起工作得很好。只需将其指向正确的文件夹即可：

```
D:\Code>ipy
IronPython 2.7 (2.7.0.40) on .NET 4.0.30319.235
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.path.append("D:\Code\IronPython\BeautifulSoup-3.2.0")
>>> import urllib2
>>> from BeautifulSoup import BeautifulSoup
>>> page = urllib2.urlopen("http://www.example.com")
>>> soup = BeautifulSoup(page)
<string>:1: DeprecationWarning: object.__new__() takes no parameters
>>> i = soup('img')[0]
>>> i['src']
'http://example.com/blah.png' 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T01:42:48.397

我还没有测试过它，但我想说它很可能适用于最新的 IPy2。

至于分发，很简单。使用 -X:SaveAssemblies 选项将 Python 代码编译为二进制文件，然后将其与其他 DLL 和 IPy 依赖项一起发布。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-09-23T07:58:31.597

如果你有完整的标准库和真正的`re`模块（IronPython 社区版的谷歌），它可能会工作。但是 IronPython 是一个非常糟糕的 python 实现，我不会指望它。

此外，`html5lib`试一试。该解析器使用与 firefox 解析文档相同的规则进行解析。

# c++ - 如何同时使用 Qt 和 SDL？

> ID：118659
> 
> 赞同：30
> 
> 时间：2008-09-23T01:38:32.900
> 
> 标签：c++, winapi, qt, sdl

我正在 Windows 中构建物理模拟引擎和编辑器。我想使用 Qt 构建编辑器部分，并且我想使用 SDL 和 OpenGL 运行引擎。

我的第一个想法是仅使用 Qt 构建编辑器，并与引擎（资源管理器、渲染器、数学）共享尽可能多的代码。但是，我也希望能够在编辑器中运行模拟。**这意味着我还必须共享使用 SDL 线程的模拟代码。**

所以，我的问题是：有没有办法通过使用 SDL 将 OpenGL 渲染到 Qt 窗口？

我在网上读到有可能为 SDL 提供一个用于渲染的窗口句柄。有人有经验吗？

此外，模拟器的线程部分可能会出现问题，因为它使用 SDL 线程。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-28T01:35:28.987

这是我在项目中所做的简化。您可以像使用普通小部件一样使用它，但根据需要，您可以使用它的 m_Screen 对象绘制到 SDL 表面，它会显示在小部件中:)

```
#include "SDL.h"
#include <QWidget>

class SDLVideo : public QWidget {
    Q_OBJECT

public:
    SDLVideo(QWidget *parent = 0, Qt::WindowFlags f = 0) : QWidget(parent, f), m_Screen(0){
        setAttribute(Qt::WA_PaintOnScreen);
        setUpdatesEnabled(false);

        // Set the new video mode with the new window size
        char variable[64];
        snprintf(variable, sizeof(variable), "SDL_WINDOWID=0x%lx", winId());
        putenv(variable);

        SDL_InitSubSystem(SDL_INIT_VIDEO | SDL_INIT_NOPARACHUTE);

        // initialize default Video
        if((SDL_Init(SDL_INIT_VIDEO) == -1)) {
            std:cerr << "Could not initialize SDL: " << SDL_GetError() << std::endl;
        }

        m_Screen = SDL_SetVideoMode(640, 480, 8, SDL_HWSURFACE | SDL_DOUBLEBUF);
        if (m_Screen == 0) {
            std::cerr << "Couldn't set video mode: " << SDL_GetError() << std::endl;
        }
    }

    virtual ~SDLVideo() {
        if(SDL_WasInit(SDL_INIT_VIDEO) != 0) {
            SDL_QuitSubSystem(SDL_INIT_VIDEO);
            m_Screen = 0;
        }
    }
private:
    SDL_Surface *m_Screen;
}; 
```

希望这可以帮助

注意：将此小部件的最小和最大尺寸设置为 SDL 表面尺寸通常是有意义的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-06T16:37:13.837

虽然您可能会像第一个答案一样让它工作，但建议您可能会因为线程而遇到问题。在线程方面没有简单的解决方案，在这里您可以让 SDL Qt 和 OpenGL 主循环交互。不好玩。

最简单和最明智的解决方案是将这两个部分解耦。这样 SDL 和 Qt 在单独的进程中运行，并让它们使用某种消息进行通信（我在这里推荐 d-bus）。您可以让 SDL 呈现到无边框窗口中，并且您的编辑器通过消息发送命令。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T02:00:29.553

从 QT 渲染到 opengl 很简单（并且效果很好） 没有 SDL 的直接经验，但这里有一个关于混合它们的示例应用程序。 [http://www.devolution.com/pipermail/sdl/2003-January/051805.html](http://www.devolution.com/pipermail/sdl/2003-January/051805.html)

有一篇关于将 QT widgewts 直接与 opengl 混合的好文章 [http://doc.trolltech.com/qq/qq26-openglcanvas.html](http://doc.trolltech.com/qq/qq26-openglcanvas.html)有点超出您的严格需要，但相当聪明！

# sharepoint - 有哪些不错的方法可以阻止用户创建会议工作区？

> ID：118678
> 
> 赞同：1
> 
> 时间：2008-09-23T01:43:27.630
> 
> 标签：sharepoint, outlook, integration

我在 sharepoint 中有一个事件列表，需要禁止用户在新事件表单中创建会议工作区。羞于自定义新的事件表单（这会破坏附件支持），如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T04:34:41.667

默认情况下，为了让用户创建会议工作区，他们需要是管理员或站点所有者（特别是他们需要“创建站点”权限）。如果您不授予他们此权限，他们将无法创建会议工作区。

这将禁止用户在设置了这些权限的站点下创建任何站点。我不知道有一种方法可以限制对特定站点定义的访问，但仍允许用户创建不同的站点定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T08:49:15.640

我认为没有支持的方式来做到这一点。一种选择是编辑 C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\TEMPLATE\1033\XML\WEBTEMP.XML 中的 WEBTEMP.XML 文件（当然要先备份）。注释掉这些行，如下所示：

```
 <!-- <Template Name="MPS" ID="2">
    ...    
    </Template> --> 
```

编辑此文件并在场中的每台服务器上执行 IISRESET 后，您应该无法再创建会议工作区。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T01:47:47.470

如果您可以在母版页中添加一些 javascript，我想出了这个小技巧。

它确实有几个缺点，因为 MS 可能会发布一个修补程序或服务包：

*   更改“使用会议工作区组织此事件的与会者、议程、文档、会议记录和其他详细信息”复选框的名称，使得名称中不再包含字符串“CrossProjectLinkField”，或者...

*   他们可以在某些其他 OOTB 标记上的某些其他输入元素的名称中使用相同的字符串

在梯形图的情况下（我现在不完全确定这是错误的），如果它们正在运行运行此脚本的母版页，这些输入将被禁用。

但这是我可以应对的风险。每当您依赖由其他人控制的客户端 ID 和名称时，您就会面临这些风险。

```
<script type="text/javascript">    
    var anchors = document.getElementsByTagName('input');
    for(var i=0;i<anchors.length;i++)
    {
        var anchorName = anchors[i].name.match('CrossProjectLinkField');
        if(anchorName != null)
        {
            anchors[i].disabled = true;
            break;
        }
    }
</script> 
```

这样做是找到允许用户创建会议工作区的复选框并将其禁用，以便他们无法检查它。问题解决了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-21T13:14:41.683

使用功能接收器创建一个 Web 范围的功能，该功能接收器会删除激活该功能的当前 Web，并让它抛出一个 SPException，说明无法使用该模板。然后创建一个 Web 应用程序或场范围的功能订书机，将以前的功能装订到您要阻止的站点定义。在 Web 应用程序或场上激活该功能。然后，当有人从其中一个站点定义创建站点时，该站点将被删除，并且用户将看到一个错误页面，其中显示了引发的 SPException 的文本。

# css - 如何将我的 CSS 样式表应用到 RSS 提要

> ID：118685
> 
> 赞同：18
> 
> 时间：2008-09-23T01:44:42.090
> 
> 标签：css, rss, blogs

在我的博客上，我使用了一些在我的样式表中定义的 CSS 类，但在 RSS 阅读器中，这些样式不会显示出来。我一直在寻找`class="whatever"`并替换为`style="something: something;"`. 但这意味着每当我修改我的 CSS 时，我也需要修改我的 RSS 生成代码，并且它不适用于属于多个类（即`class="snapshot accent"`）的标签。有没有办法从我的提要中指向我的样式表？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-20T05:11:17.307

流行的 RSS 阅读器不会费心下载样式表，即使您提供一个样式表并使用`<?xml-stylesheet?>`.

许多 RSS 阅读器只是简单地`style`从您的标签中去除所有内联属性。从今天的测试中，我发现 Outlook 2007 似乎去除了所有样式，例如，即使它们是内联的。

好的 RSS 阅读器允许一组有限的内联`style`属性。例如，请参阅[Bloglines 上的这篇文章，](http://www.bloglines.com/help/css-support)了解他们不会剥离哪些 CSS。从实验来看，谷歌阅读器似乎可以毫发无损地通过某些样式。

RSS 的哲学确实是读者负责呈现。许多人认为 RSS 应该是纯文本，RSS 提要中的 CSS 是不合适的。在您的 RSS 提要上强加不同的字体可能是不合适的。但是，某些类型的内容（例如，漂浮在左侧的图像，带有仔细定位的标题）需要最少的样式以保持其语义含义。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-23T01:45:54.083

RSS 的要点是与显示无关。您不应该将样式属性放在您的提要中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T01:49:12.937

我发现这篇[博客文章](http://mondaybynoon.com/2006/08/14/beginning-to-style-your-rss-feed/)描述了如何为您的 RSS 提要添加样式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T01:54:37.633

因为 RSS 是（应该是）XML，所以您可以使用 XML 样式表。

[http://www.w3.org/TR/xml-stylesheet/](http://www.w3.org/TR/xml-stylesheet/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T17:16:36.450

RSS 提要的目的是允许将内容轻松传输到您网站之外的地方。整个想法是提要中的内容是无格式的，因此任何软件都可以读取它。正在阅读您的提要的程序负责如何以视觉方式呈现它。例如，如果您有一个阅读 RSS 的网站，您可能希望将提要解析为 HTML，并以这种方式设置样式。但是，如果您正在构建一个桌面应用程序来读取提要，那么您会以完全不同的方式实现格式设置。

# gdi+ - MeasureString() 在左边和右边填充文本

> ID：118686
> 
> 赞同：18
> 
> 时间：2008-09-23T01:45:15.893
> 
> 标签：gdi+, drawstring

我在 C++ 中使用 GDI+。（这个问题也可能存在于 C# 中）。

我注意到，每当我调用 Graphics::MeasureString() 或 Graphics::DrawString() 时，字符串的左右两侧都会填充空格。

例如，如果我使用的是 Courier 字体（不是斜体！）并且我测量“P”我得到 90，但“PP”给我 150。我希望等宽字体给出的宽度正好是“PP”的两倍.

我的问题是：这是预期的还是记录在案的行为，我该如何禁用它？

```
RectF Rect(0,0,32767,32767);
RectF Bounds1, Bounds2;
graphics->MeasureString(L"PP", 1, font, Rect, &Bounds1);
graphics->MeasureString(L"PP", 2, font, Rect, &Bounds2);
margin = Bounds1.Width * 2 - Bounds2.Width; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-23T02:10:50.747

这是设计使然，该方法不使用实际字形来测量宽度，因此在悬垂的情况下添加了一点填充。

[如果您需要更高的准确性， MSDN](http://msdn.microsoft.com/en-us/library/6xe5hazb.aspx)建议使用不同的方法：

> 要获取适合布局中相邻字符串的指标（例如，在实现格式化文本时），请使用[MeasureCharacterRanges](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.measurecharacterranges.aspx)方法或采用[StringFormat的](http://msdn.microsoft.com/en-us/library/system.drawing.stringformat.aspx)[MeasureString](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.measurestring.aspx)方法之一，并传递[GenericTypographic](http://msdn.microsoft.com/en-us/library/system.drawing.stringformat.generictypographic.aspx)。此外，确保[Graphics](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.aspx)的[TextRenderingHint](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.textrenderinghint.aspx)是[AntiAlias](http://msdn.microsoft.com/en-us/library/ssazt6bs.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-12T08:28:42.080

确实这是设计使然，但是接受答案的链接实际上并不完美。问题是当您真正想要使用的是像素（整数）时，在所有这些方法中使用浮点数。

TextRenderer[类](http://msdn.microsoft.com/en-us/library/system.windows.forms.textrenderer.aspx)就是为此目的而设计的，它使用真实的大小。有关使用此链接的演练， 请参阅[msdn的此链接。](http://msdn.microsoft.com/en-us/library/7sy6awsb.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-12-15T06:20:08.137

追加`StringFormat.GenericTypographic`将解决您的问题：

```
graphics->MeasureString(L"PP", 1, font, width, StringFormat.GenericTypographic); 
```

将相同的属性应用于`DrawString`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T02:13:46.823

听起来它也可能与提示有关，基于这篇 kb 文章，[为什么使用 GDIPlus 与 GDI 绘制时文本看起来不同](http://support.microsoft.com/?id=307208)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-04T21:24:48.257

TextRenderer 非常适合获取字体的大小。但是在绘图循环中，与 graphics.DrawString() 相比，使用 TextRenderer.DrawText 的速度非常慢。

由于字符串的宽度是问题，因此最好结合使用 TextRenderer.MeasureText 和 graphics.DrawString..

# javascript - 如何在 Javascript 中动态创建适用于所有浏览器的单选按钮？

> ID：118693
> 
> 赞同：28
> 
> 时间：2008-09-23T01:47:47.353
> 
> 标签：javascript

使用例如动态创建单选按钮

```
var radioInput = document.createElement('input');
radioInput.setAttribute('type', 'radio');
radioInput.setAttribute('name', name); 
```

在 Firefox 中有效，但在 IE 中无效。为什么不？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-23T04:10:47.387

按照 Patrick 的建议，使用临时节点，我们可以摆脱 try/catch：

```
function createRadioElement(name, checked) {
    var radioHtml = '<input type="radio" name="' + name + '"';
    if ( checked ) {
        radioHtml += ' checked="checked"';
    }
    radioHtml += '/>';

    var radioFragment = document.createElement('div');
    radioFragment.innerHTML = radioHtml;

    return radioFragment.firstChild;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-23T01:50:31.060

基于这篇文章及其评论： [http ://cf-bill.blogspot.com/2006/03/another-ie-gotcha-dynamiclly-created.html](http://cf-bill.blogspot.com/2006/03/another-ie-gotcha-dynamiclly-created.html)

以下作品。显然问题是您不能在 IE 中动态设置 name 属性。我还发现您也不能动态设置选中的属性。

```
function createRadioElement( name, checked ) {
    var radioInput;
    try {
        var radioHtml = '<input type="radio" name="' + name + '"';
        if ( checked ) {
            radioHtml += ' checked="checked"';
        }
        radioHtml += '/>';
        radioInput = document.createElement(radioHtml);
    } catch( err ) {
        radioInput = document.createElement('input');
        radioInput.setAttribute('type', 'radio');
        radioInput.setAttribute('name', name);
        if ( checked ) {
            radioInput.setAttribute('checked', 'checked');
        }
    }

    return radioInput;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T11:15:40.093

这是一个更通用的解决方案示例，它预先检测 IE 并处理 IE 也有问题的其他属性，从[DOMBuilder](http://code.google.com/p/dombuilder/)中提取：

```
var createElement = (function()
{
    // Detect IE using conditional compilation
    if (/*@cc_on @*//*@if (@_win32)!/*@end @*/false)
    {
        // Translations for attribute names which IE would otherwise choke on
        var attrTranslations =
        {
            "class": "className",
            "for": "htmlFor"
        };

        var setAttribute = function(element, attr, value)
        {
            if (attrTranslations.hasOwnProperty(attr))
            {
                element[attrTranslations[attr]] = value;
            }
            else if (attr == "style")
            {
                element.style.cssText = value;
            }
            else
            {
                element.setAttribute(attr, value);
            }
        };

        return function(tagName, attributes)
        {
            attributes = attributes || {};

            // See http://channel9.msdn.com/Wiki/InternetExplorerProgrammingBugs
            if (attributes.hasOwnProperty("name") ||
                attributes.hasOwnProperty("checked") ||
                attributes.hasOwnProperty("multiple"))
            {
                var tagParts = ["<" + tagName];
                if (attributes.hasOwnProperty("name"))
                {
                    tagParts[tagParts.length] =
                        ' name="' + attributes.name + '"';
                    delete attributes.name;
                }
                if (attributes.hasOwnProperty("checked") &&
                    "" + attributes.checked == "true")
                {
                    tagParts[tagParts.length] = " checked";
                    delete attributes.checked;
                }
                if (attributes.hasOwnProperty("multiple") &&
                    "" + attributes.multiple == "true")
                {
                    tagParts[tagParts.length] = " multiple";
                    delete attributes.multiple;
                }
                tagParts[tagParts.length] = ">";

                var element =
                    document.createElement(tagParts.join(""));
            }
            else
            {
                var element = document.createElement(tagName);
            }

            for (var attr in attributes)
            {
                if (attributes.hasOwnProperty(attr))
                {
                    setAttribute(element, attr, attributes[attr]);
                }
            }

            return element;
        };
    }
    // All other browsers
    else
    {
        return function(tagName, attributes)
        {
            attributes = attributes || {};
            var element = document.createElement(tagName);
            for (var attr in attributes)
            {
                if (attributes.hasOwnProperty(attr))
                {
                    element.setAttribute(attr, attributes[attr]);
                }
            }
            return element;
        };
    }
})();

// Usage
var rb = createElement("input", {type: "radio", checked: true}); 
```

完整的 DOMBuilder 版本还处理事件侦听器注册和子节点的规范。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-23T11:31:46.733

我个人不会自己创建节点。正如您所注意到的，浏览器特有的问题太多了。通常我使用来自[script.aculo.us的](http://script.aculo.us/)[Builder.node](http://github.com/madrobby/scriptaculous/wikis/builder)。使用这个你的代码会变成这样：

```
Builder.node('input', {type: 'radio', name: name}) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-12T12:15:54.110

在 javascript 中动态创建的单选按钮：

```
<%@ Page Language=”C#” AutoEventWireup=”true” CodeBehind=”RadioDemo.aspx.cs” Inherits=”JavascriptTutorial.RadioDemo” %>

<!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Transitional//EN” “http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd”&gt;

<html xmlns=”http://www.w3.org/1999/xhtml”&gt;
<head runat=”server”&gt;
<title></title>
<script type=”text/javascript”&gt;

/* Getting Id of Div in which radio button will be add*/
var containerDivClientId = “&lt;%= containerDiv.ClientID %>”;

/*variable count uses for define unique Ids of radio buttons and group name*/
var count = 100;

/*This function call by button OnClientClick event and uses for create radio buttons*/
function dynamicRadioButton()
{
/* create a radio button */
var radioYes = document.createElement(“input”);
radioYes.setAttribute(“type”, “radio”);

/*Set id of new created radio button*/
radioYes.setAttribute(“id”, “radioYes” + count);

/*set unique group name for pair of Yes / No */
radioYes.setAttribute(“name”, “Boolean” + count);

/*creating label for Text to Radio button*/
var lblYes = document.createElement(“lable”);

/*create text node for label Text which display for Radio button*/
var textYes = document.createTextNode(“Yes”);

/*add text to new create lable*/
lblYes.appendChild(textYes);

/*add radio button to Div*/
containerDiv.appendChild(radioYes);

/*add label text for radio button to Div*/
containerDiv.appendChild(lblYes);

/*add space between two radio buttons*/
var space = document.createElement(“span”);
space.setAttribute(“innerHTML”, “&amp;nbsp;&nbsp”);
containerDiv.appendChild(space);

var radioNo = document.createElement(“input”);
radioNo.setAttribute(“type”, “radio”);
radioNo.setAttribute(“id”, “radioNo” + count);
radioNo.setAttribute(“name”, “Boolean” + count);

var lblNo = document.createElement(“label”);
lblNo.innerHTML = “No”;
containerDiv.appendChild(radioNo);
containerDiv.appendChild(lblNo);

/*add new line for new pair of radio buttons*/
var spaceBr= document.createElement(“br”);
containerDiv.appendChild(spaceBr);

count++;
return false;
}
</script>
</head>
<body>
<form id=”form1″ runat=”server”&gt;
<div>
<asp:Button ID=”btnCreate” runat=”server” Text=”Click Me” OnClientClick=”return dynamicRadioButton();” />
<div id=”containerDiv” runat=”server”&gt;</div>
</div>
</form>
</body>
</html> 
```

（[来源](http://knowpacific.wordpress.com/2012/09/12/dynamically-created-radio-buttons-in-javascript/)）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-12-14T10:41:02.243

我的解决方案：

```
html
    head
        script(type='text/javascript')
            function createRadioButton()
            {
               var newRadioButton
                 = document.createElement(input(type='radio',name='radio',value='1st'));
               document.body.insertBefore(newRadioButton);
            }
    body
        input(type='button',onclick='createRadioButton();',value='Create Radio Button') 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-10-22T13:11:20.763

```
for(i=0;i<=10;i++){
   var selecttag1=document.createElement("input");
   selecttag1.setAttribute("type", "radio");
   selecttag1.setAttribute("name", "irrSelectNo"+i);
   selecttag1.setAttribute("value", "N");
   selecttag1.setAttribute("id","irrSelectNo"+i);

   var lbl1 = document.createElement("label");
   lbl1.innerHTML = "YES";
   cell3Div.appendChild(lbl);
   cell3Div.appendChild(selecttag1);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-20T18:23:20.100

快速回复旧帖：

Roundcrisis 上面的帖子很好，如果且仅当，您知道将预先使用的单选/复选框控件的数量。在某些情况下，通过“动态创建单选按钮”这一主题来解决，用户需要的控件数量是未知的。此外，我不建议“跳过”“try-catch”错误捕获，因为这样可以轻松捕获可能不符合当前标准的未来浏览器实现。在这些解决方案中，我建议使用 Patrick Wilkes 在回答他自己的问题时提出的解决方案。

为了避免混淆，这里重复了一遍：

```
function createRadioElement( name, checked ) {
   var radioInput;
   try {
        var radioHtml = '<input type="radio" name="' + name + '"';
        if ( checked ) {
            radioHtml += ' checked="checked"';
        }
        radioHtml += '/>';
        radioInput = document.createElement(radioHtml);
    } catch( err ) {
        radioInput = document.createElement('input');
        radioInput.setAttribute('type', 'radio');
        radioInput.setAttribute('name', name);
        if ( checked ) {
            radioInput.setAttribute('checked', 'checked');
        }
    }
    return radioInput;} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T01:52:16.453

帕特里克的回答有效，或者您也可以设置“defaultChecked”属性（这将在 IE 中用于单选或复选框元素，并且不会在其他浏览器中导致错误。

PS 此处列出了您无法在 IE 中设置的属性的完整列表：

[http://webbugtrack.blogspot.com/2007/08/bug-242-setattribute-doesnt-always-work.html](http://webbugtrack.blogspot.com/2007/08/bug-242-setattribute-doesnt-always-work.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T11:29:57.597

为什么不创建输入，将样式设置为显示：无，然后在必要时更改显示，这样您也可以更好地处理用户 whitout js。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-23T01:51:10.590

我的建议是不要使用 document.Create()。更好的解决方案是构建未来控件的实际 HTML，然后将其像 innerHTML 一样分配给某个占位符 - 它允许浏览器自己呈现它，这比任何 JS DOM 操作都要快得多。

干杯。

# php - PHP中的延迟函数定义 - 可能吗？

> ID：118698
> 
> 赞同：5
> 
> 时间：2008-09-23T01:49:19.037
> 
> 标签：php, design-patterns, optimization

在 JavaScript 中，您可以使用[延迟函数定义](http://peter.michaux.ca/article/3556)来优化对函数的第 2 次 - 第 N 次调用，方法是仅在第一次调用函数时执行**昂贵**的一次性操作。

我想在 PHP 5 中做同样的事情，但是不允许重新定义函数，也不允许重载函数。

实际上，我想要做的是如下所示，仅进行了优化，因此第 2 次 - 第 N 次调用（比如 25-100）不需要重新检查它们是否是第一次调用。

```
$called = false;
function foo($param_1){
  global $called;
  if($called == false){
    doExpensiveStuff($param_1);
    $called = true;
  }
  echo '<b>'.$param_1.'</b>';
} 
```

PS 我曾考虑使用 include_once() 或 require_once() 作为函数中的第一行来只执行一次外部代码，但我听说这些也很昂贵。

有任何想法吗？还是有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-23T05:06:32.993

使用本地静态变量：

```
function foo() {
    static $called = false;
    if ($called == false) {
        $called = true;
        expensive_stuff();
    }
} 
```

避免为此使用全局变量。它使全局命名空间变得混乱，并使函数的封装更少。如果函数内部以外的其他地方需要知道它是否被调用，那么将这个函数放在像 Alan Storm 所指出的类中是值得的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T01:55:27.290

你真的分析过这段代码吗？我怀疑额外的布尔测试是否会对页面呈现时间产生任何可衡量的影响。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T01:55:36.523

你可以做**条件**函数定义。

```
if( !function_exists('baz') )
{ 
    function baz( $args ){ 
        echo $args; 
    }
} 
```

但是目前，一个函数在定义时就变成了一块砖。

你可以使用`create_function`，但我建议你**不要**，因为它很慢，使用大量内存，在 php 退出之前不会获得 free()，并且是一个与 eval() 一样大的安全漏洞。

等到 PHP5.3，我们有“闭包” [http://wiki.php.net/rfc/closures](http://wiki.php.net/rfc/closures)

然后你将被允许做

```
if( !isset( $baz ) ) 
 { 
    $baz = function( $args )
    { 
        echo $args;
    }
}

$baz('hello');

$baz = function( $args )
{ 
       echo $args + "world"; 
}
$baz('hello'); 
```

进一步阅读，这就是你想要的效果。

```
$fname = 'f_first'; 
function f_first( $even ) 
{ 
    global $fname; 
    doExpensiveStuff(); 
    $fname = 'f_others';
    $fname( $even );
    /* code */ 
}
function f_others( $odd ) 
{
     print "<b>".$odd."</b>";
}

foreach( $blah as $i=>$v ) 
{
   $fname($v);
} 
```

它会做你想做的事，但调用可能比普通函数调用贵一点。

在 PHP5.3 这也应该是有效的：

```
$func = function( $x ) use ( $func ) 
{ 
     doexpensive(); 
     $func = function( $y )
     { 
          print "<b>".$y."</b>";
     }
     $func($x);
}
foreach( range(1..200) as $i=>$v ) 
{ 
    $func( $v ); 
} 
```

（就个人而言，我当然认为所有这些巧妙的技巧都会比你之前对 2 个正位的比较慢得多。；））

如果您真的担心在任何地方都能获得*最佳*速度

```
$data = // some array structure
doslowthing(); 
foreach( $data as $i => $v ) 
{
   // code here 
} 
```

但是，您可能无法做到这一点，但是您没有给出足够的范围来澄清。但是，如果您能做到这一点，那么简单的答案通常是最好的:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T02:27:33.373

请不要使用`include()`or `include_once()`，除非您不在乎是否`include()`失败。如果您包含代码，那么您在乎。始终使用`require_once()`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T02:07:12.847

如果您最终发现额外的布尔测试太昂贵了，您可以将变量设置为函数的名称并调用它：

```
$func = "foo";    

function foo()
{
    global $func;
    $func = "bar";
    echo "expensive stuff";
};

function bar()
{
    echo "do nothing, i guess";
};

for($i=0; $i<5; $i++)
{
    $func();
} 
```

试一试

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T02:12:02.040

您有什么理由致力于功能样式模式？尽管有匿名函数和关闭计划，PHP 确实不是一种函数式语言。在这里，类和对象似乎是更好的解决方案。

```
Class SomeClass{
    protected $whatever_called;
    function __construct(){
        $this->called = false;
    }
    public function whatever(){
        if(!$this->whatever_called){
            //expensive stuff
            $this->whatever_called = true;
        }
        //rest of the function
    }
} 
```

如果您想变得花哨，可以使用魔术方法来避免必须预定义被调用的布尔值。如果您不想实例化对象，请使用静态。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T08:47:45.927

PHP 没有词法作用域，所以你不能用函数做你想做的事。但是，PHP 有类，它们在概念上以完全相同的方式工作。

在 javascript 中，你会这样做：

```
var cache = null;
function doStuff() {
  if (cache == null) {
    cache = doExpensiveStuff();
  }
  return cache;
} 
```

使用类（在 PHP 中），您可以：

```
class StuffDoer {
  function doStuff() {
    if ($this->cache == null) {
      $this->cache = $this->doExpensiveStuff();
    }
    return $this->cache;
  }
} 
```

是的，基于类的 oop 比函数式编程更冗长，但在性能方面它们应该差不多。

除此之外，PHP 5.3 可能会获得词法作用域/闭包支持，因此当它出现时，您可以用更流畅的函数式编程风格编写代码。[有关此功能的详细说明，](http://wiki.php.net/rfc/closures)请参阅 PHP rfc-wiki 。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T09:29:18.650

使用局部静态变量怎么样？

```
function doStuff($param1) {
    static $called = false;
    if (!$called) {
        doExpensiveStuff($param1);
        $called = true;
    }
    // do the rest
} 
```

如果您只需要为给定的参数值做一次昂贵的事情，您可以使用数组缓冲区：

```
function doStuff($param1) {
    static $buffer = array();
    if (!array_key_exists($param1, $buffer)) {
        doExpensiveStuff($param1);
        $buffer[$param1] = true;
    }
    // do the rest
} 
```

局部静态变量在函数调用中是持久的。他们记住返回后的值。

# .net - 如何有效地保留 .Net 字体对象？

> ID：118719
> 
> 赞同：6
> 
> 时间：2008-09-23T01:55:38.897
> 
> 标签：.net, serialization, fonts

用例：用户对设计表面上的对象进行字体自定义，我需要将其加载/保存到我的数据存储区。即粗体、斜体、大小、字体名称等设置需要保留。

是否有一些简单（可靠）的机制可以从字体对象的字符串表示形式转换/读回（在这种情况下，我只需要一个属性）？还是多个属性与自定义逻辑相结合是正确的选择？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-23T02:07:42.440

使用[类型转换器](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx)：

```
Font font = new Font("Arial", 12, GraphicsUnit.Pixel);

TypeConverter converter = TypeDescriptor.GetConverter(typeof (Font));

string fontStr = converter.ConvertToInvariantString(font);

Font font2 = (Font) converter.ConvertFromString(fontStr);

Console.WriteLine(font.Name == font2.Name); // prints True 
```

如果您想使用 XML 序列化，您可以创建 Font 类包装器，它将存储 Font 属性的某些子集。

*注意（Gishu） - 永远不要直接访问类型转换器。相反，请使用 TypeDescriptor 访问相应的转换器。很重要 ：）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T02:12:53.847

您需要将其保存在哪种类型的数据存储中？如果只是可以保存在文件中的用户设置，则可以将字体对象序列化为二进制或 xml 格式的设置文件（如果您希望能够直接编辑配置文件）。序列化命名空间（System.Xml.Serialization 和 System.Runtime.Serialization）提供了执行此操作的所有工具，而无需编写自定义代码。

关于 XML 序列化的 MSDN 站点：[.Net 框架中的 XML 序列化](http://msdn.microsoft.com/en-us/library/ms950721.aspx)

[编辑]所以显然字体对象是不可序列化的。哎呀，对不起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T02:59:22.300

在我正在进行的项目中，我使用了多个属性。

我通过分解字体的名称、大小、样式和单位将字体保存到数据库表中，然后保留这些值。

检索这些值后，按需重新创建字体是一件轻而易举的事。

# java - Preferred way to do logging in the SpringFrame work

> ID：118724
> 
> 赞同：2
> 
> 时间：2008-09-23T01:57:03.197
> 
> 标签：java, spring, logging

I have done some searches looking for information about how to do logging with the Spring Framework.

We currently have an application that has no logging in it except for system.out statements (very bad way).

What I would like to do, is add logging, but also want to be able to control the logging at run time, with say JMX.

We are using Rad 7.0 / WebSphere 6.1

I am interesting to find out what is the best way(s) to accomplish this (I figure there may be several).

Update: Thoughts on the following [Spring AOP Logging](http://www.devx.com/Java/Article/30799/0/page/1) Good ideal or not. This is in reference to a question posted here on logging: [Conditional Logging](https://stackoverflow.com/questions/105852/how-do-you-deal-with-conditional-logging-when-trying-to-respect-a-limited-cyclo). Does this improve things or just makes it more difficult in the area of logging?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T02:26:37.557

I would use [Commons Logging](http://commons.apache.org/logging/) and [Log4j](http://logging.apache.org/log4j/1.2/index.html). This is not really a question for Spring, however the Springframework source does uses Commons Logging as well. If you create a log4j logger and appender in log4j, you can enable logging within the Springframework classes too. There are a few ways to control logging at runtime. The Log4j sandbox has a JSP, that you can drop into your webapp, that will allow you to control the log levels of all of the loggers within your application.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T08:13:05.680

See the other answers for log4j. But also consider [JAMon](http://jamonapi.sourceforge.net/) for *application monitoring*. It's very easy to add to a spring application, e.g.:

```
 <bean id="performanceMonitor" class="org.springframework.aop.interceptor.JamonPerformanceMonitorInterceptor">
        <property name="useDynamicLogger" value="false"/>
        <property name="trackAllInvocations" value="true"/>
    </bean>

   <bean id="txRequired" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" abstract="true">
            <property name="transactionManager" ref="transactionManager"/>
            <property name="transactionAttributes" >
                <props> <prop key="*">PROPAGATION_REQUIRED</prop> </props>
            </property>
        <property name="preInterceptors">
           <list>
              <ref bean="performanceMonitor"/>      
           </list>
        </property>
   </bean> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T04:14:40.747

here's a sample file for configuring log4j for a console and file logger. if this file is on the classpath it will get read by log4j automatically. However, since you're inside an app server, there may be another preferred way of configuring logging. I remember inside JBoss there was an xml file you had to modify. Not sure about websphere configuration. But if you want to configure it for a simple test app, this will get you going.

```
# Set root logger level to WARN and appenders to A1 & F1.
log4j.rootLogger=WARN, A1, F1

# A1 is set to be a ConsoleAppender.
log4j.appender.A1=org.apache.log4j.ConsoleAppender
# logging to console only INFO
log4j.appender.A1.Threshold=INFO
# F1 is a file appender
log4j.appender.F1=org.apache.log4j.RollingFileAppender

# Tell Spring to be quiet
log4j.logger.org.springframework=WARN
# debug logging for my classes
log4j.logger.com.yourcorp=DEBUG
log4j.logger.org.hibernate=INFO

# A1 uses PatternLayout.
log4j.appender.A1.layout=org.apache.log4j.PatternLayout
log4j.appender.A1.layout.ConversionPattern=%-4r : %d{HH:mm:ss,SSS} [%t] %-5p %c{1} %x - %m%n

log4j.appender.F1.File=./log/mylogfile.log
log4j.appender.F1.MaxFileSize=10MB
log4j.appender.F1.MaxBackupIndex=5
log4j.appender.F1.layout=org.apache.log4j.PatternLayout
log4j.appender.F1.layout.ConversionPattern=%-4r : %d{HH:mm:ss,SSS} [%t] %-5p %c{1} %x - %m%n 
```

# remote-desktop - 在远程网络上启用对 PC 的桌面访问的最佳方式

> ID：118725
> 
> 赞同：2
> 
> 时间：2008-09-23T01:57:13.087
> 
> 标签：remote-desktop, remote-access

启用远程访问（用于桌面支持目的）到在固定 IP 上有单个服务器和许多 Windows DHCP 客户端（都可以访问 Internet，但客户端都使用 NAT 进行外部访问）的网络的最佳方法是什么使用权）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T02:30:32.727

[Bomgar](http://www.bomgar.com/)和[UltraVNC](http://www.uvnc.com/)也很不错。（我对 Bomgar 非常满意；只需单击几下即可随时远程访问任何客户端机器——甚至是 Mac。UltraVNC 是一款出色的*免费*跨平台工具。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T02:03:15.103

我们使用[远程桌面](http://www.microsoft.com/windowsxp/using/mobility/getstarted/remoteintro.mspx)（Windows XP pro 附带）。

我们还使用了[LogMeIn](https://secure.logmein.com/home.asp?originid=978&utpk=log%20me%20in&lang=en)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T02:01:09.303

也许是愚蠢的答案 - 在所有机器上安装 Live Mesh，而不依赖于安全策略，只要端口 80 未关闭，您就可以获得桌面访问权限。) 干杯。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T02:05:43.053

我没用过，但我听说[FogCreek 的 Copilot](https://www.copilot.com/)对桌面支持很有用（而且它是 Joel Spolsky 的公司 :)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T02:11:41.447

我过去使用过它，它运行良好并且可以免费使用：

[https://secure.logmein.com/home.asp?lang=en](https://secure.logmein.com/home.asp?lang=en)

有一个非常好的界面，可以通过网络访问任何你为它设置的电脑，并穿过防火墙（只要端口 80 出站没有被阻止，我怀疑或者没有人会浏览网络；））。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-23T02:14:05.043

最好的工具之一是 LogMeIn，因为您不必处理 Nat / Ip 或其他技术（非用户）信息。它非常快速和可靠。

我已经多次使用这个工具，而且效果很好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T02:48:14.713

如果远程网络中有 SSH 服务器，则可以使用 SSH 隧道来传输[VNC 流量](http://people.hmdc.harvard.edu/~mathpre/vnc/putty/)或[远程桌面流量](http://www.engr.wisc.edu/computing/best/rdesktop-putty.html)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-23T03:09:43.070

UltraVNC 在这里。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-02-03T22:39:54.067

我的公司使用代理网络软件来做到这一点。我觉得它很容易使用。会推荐他们的[远程桌面](http://www.proxynetworks.com)程序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T02:01:39.943

如果您一次只需要访问一个用户/计算机，您可以转发 RDP (3389)，然后一旦连接到该计算机，您就可以将 RDP 连接到该网络上的任何其他计算机。

为了清楚起见，您连接到可公开访问的机器，该机器与网络上的另一台机器有 RDP 连接。

这很好用，但您一次只能有一个用户。

根据机器/安全策略的数量，您可以使用 Live Mesh。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-23T02:39:06.810

我们使用 TightVNC 一个免费的跨平台 VNC。但是 Tight VNC 本身并不是很安全（密码是明文发送的！）我们使用 CopSSH 和隧道 SSH 客户端。TightVNC 和 Tunnelier 可以从 Thunbdrive 和 Tunnelier 当然是隧道启动，从而简化代理和防火墙问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-23T02:40:27.883

ultravnc 单击，让用户下载一个小型 (160kb) 应用程序并连接到您。

我已经设置了一个本地中继器和几个传入频道，这样当用户打电话给我们时，我们可以告诉他们使用什么频道，他们可以连接到办公室中的任何人。

只遇到过一个有防火墙阻止它的地方

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-23T03:08:01.623

如果您在远程端有一个 linux 机器，并且您可以将 SSH（端口 22）从防火墙转发到它，那么您可以考虑使用[NoMachine](http://nomachine.com/)的 NX 。它可以充当本地网络中机器的 VNC 或 RDP 管道。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T03:28:15.210

RealVNC [http://www.realvnc.com/](http://www.realvnc.com/)非常友好。他们有一个免费版本和一个带支持的付费版本。（我不隶属）

# c++ - 用 VS2008 编译 mshtml.h 中的编译错误

> ID：118727
> 
> 赞同：3
> 
> 时间：2008-09-23T01:57:27.423
> 
> 标签：c++, visual-studio-2008

我正在将我们的一个项目从 VS6 移动到 VS2008，并且我在 mshtml.h 中遇到了以下编译错误：

```
1>c:\program files\microsoft sdks\windows\v6.0a\include\mshtml.h(5272) : error C2143: syntax error : missing '}' before 'constant'
1>c:\program files\microsoft sdks\windows\v6.0a\include\mshtml.h(5275) : error C2143: syntax error : missing ';' before '}'
1>c:\program files\microsoft sdks\windows\v6.0a\include\mshtml.h(5275) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>c:\program files\microsoft sdks\windows\v6.0a\include\mshtml.h(28523) : error C2059: syntax error : '}'
1>c:\program files\microsoft sdks\windows\v6.0a\include\mshtml.h(28523) : error C2143: syntax error : missing ';' before '}'
1>c:\program files\microsoft sdks\windows\v6.0a\include\mshtml.h(28523) : error C2059: syntax error : '}' 
```

在第一个错误语句之后进入 mshtml.h 代码的这一部分，指向“True = 1”行：

```
EXTERN_C const GUID CLSID_CDocument;
EXTERN_C const GUID CLSID_CScriptlet;
typedef 
enum _BoolValue
    {   True    = 1,
    False   = 0,
    BoolValue_Max   = 2147483647L
    }   BoolValue;

EXTERN_C const GUID CLSID_CPluginSite; 
```

看起来专家交换上的某个人也遇到了这个错误，但我宁愿不通过“7 天免费试用”来尊重该网站。

任何建议都将受到欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T02:04:29.840

您可能已经定义了 True & False 符号，请尝试

```
#undef True 
#undef False 
```

在包含该文件之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T02:01:10.880

可能有一个#define 改变了一些东西。尝试仅在 .cpp 上运行预处理器并生成 .i 文件。该设置位于项目属性页面中。

编辑：此外，您可以通过滚动到页面底部从其他专家网站获得答案。他们必须这样做，否则谷歌会将它们从索引中删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T02:02:35.743

您在当前编译的文件中还有哪些其他 incode？可能`True`已经被宏定义为`1`. 这将解释错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T03:56:42.363

多谢你们。我为那些#undef 找到了正确的位置。我将它们放入类头文件中，就在一个`#include <atlctl.h>`似乎可以解决问题的方法之前。

感谢您提供有关其他专家网站的提示，我必须牢记这一点。

# notepad++ - Notepad++：在空行后禁用自动缩进

> ID：118728
> 
> 赞同：37
> 
> 时间：2008-09-23T01:57:27.643
> 
> 标签：notepad++, indentation, auto-indent

我发现 Notepad++ 的自动缩进风格有点奇怪：当我在缩进的行上打字时，我*确实*希望它在按下 Enter 后缩进下一行（它确实如此）。但是，当我在一个空行（没有缩进，没有字符）并按 Enter 键时，它会缩进下一行，使用与最后一个非空行相同的缩进。我觉得这非常烦人；你有没有遇到过这个问题，你知道如何解决吗？

（注意：我正在编辑 HTML/PHP 文件。）

（此外，欢迎其他优秀的 HTML/PHP 免费编辑器的建议，以防无法改变这种行为。）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-06T12:43:39.133

1) 如果没有，请先安装 NppAutoIndent 插件。

> 插件 > 插件管理器 > 显示插件管理器，然后从该菜单的“可用”选项卡**安装 NppAutoIndent 。**

2）可以通过执行以下操作来关闭此行为：

> 插件 > NppAutoIndent > 上一行

3）如果禁用此选项，您可能需要先检查此选项：

> 插件 > NppAutoIndent > 忽略语言

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-23T02:09:34.917

我可以确认 Notepad++ 版本 5.0.3 会发生此问题。我发现的唯一相关设置是在“设置”>“首选项”>“其他”>“自动缩进”下，但这只会打开或关闭所有自动缩进。

我过去使用过 Editra ( [http://editra.org](http://editra.org) ) 并且对它很满意，它似乎可以按照您描述的方式处理缩进。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-28T14:22:37.823

我找到了另一种方法：

使用宏“修剪尾随并保存”快捷键“Alt + Shift + S”

我一直需要这个，只需将保存快捷方式与宏“修剪尾随并保存”快捷方式交换即可。

我只在编程时倾向于使用记事本++，所以这对我来说很有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-19T12:40:02.453

不幸的是 Notepad++ 不会自动修剪第二个空的新行。但是，作为一种解决方法，我同意[user108570](https://stackoverflow.com/questions/118728/notepad-disable-auto-indent-after-empty-lines/2865528#1166267)：宏将是完美的。

**我喜欢在“软”**和**“硬”**换行之间做出概念上的区分，类似于这两种类型的选项卡。前者的输出取决于当前的样式和缩进设置。然而，后者的输出应该始终是一个简单、纯粹、普通的新行。

当然，最常用的换行风格应该映射到更简单的组合键。对于您的大部分编辑，您可能希望将“软换行”映射到“Enter”键并更改“Ctrl+Enter”以触发“硬换行”。

在“菜单 -> 设置 -> 快捷方式映射器 -> 主菜单”中，您将看到默认情况下“Ctrl+Enter”映射到“单词补全”。这需要首先通过将其映射到“无”来禁用。

然后简单地录制一个宏：

1.  菜单 -> 宏 -> 开始录制
2.  键盘 -> 输入
3.  键盘 -> 选项卡
4.  键盘 -> Shift + Home
5.  键盘 -> 删除
6.  菜单 -> 宏 -> 停止录制
7.  菜单 -> 宏 -> 保存当前录制的宏

最后一步将弹出一个对话框，您可以在其中命名宏（例如“硬换行”）并设置其映射（即“Ctrl+Enter”）。

在第 3 步，我们可以添加任何内容（可打印）。它的唯一目的是在之前没有任何内容的情况下添加要删除的内容，以便光标后面的任何文本都保持不变。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T03:12:55.230

我在 Notepad++ 中所做的是：

*   TexFX > TexFX Edit 中有一个“修剪尾随空格”宏。
*   使用它来构建“修剪和保存”宏。
*   将该宏绑定到`CTRL`+ `S`，并将“保存”绑定到其他内容。

我会告诉你如何录制一个使用另一个宏的宏，但几年前我做到了，现在我只是复制文件。我希望它可以正常工作，或者我可能通过手动编辑快捷方式文件来做到这一点。它看起来像这样（在 shortcuts.xml 中）：

```
<Macro name="Trim and save" Ctrl="no" Alt="yes" Shift="yes" Key="83">
    <Action type="1" message="2170" wParam="0" lParam="0" sParam=" " />
    <Action type="1" message="2170" wParam="0" lParam="0" sParam=" " />
    <Action type="1" message="2170" wParam="0" lParam="0" sParam=" " />
    <Action type="0" message="2327" wParam="0" lParam="0" sParam="" />
    <Action type="0" message="2327" wParam="0" lParam="0" sParam="" />
    <Action type="2" message="0" wParam="42024" lParam="0" sParam="" />
    <Action type="2" message="0" wParam="41006" lParam="0" sParam="" />
</Macro> 
```

两个警告：

*   修剪宏是错误的。仅当光标在使用时位于行尾时才有效。我偶尔会考虑尝试修复它或自己做，但我永远不会被打扰，因为我在保存之前通过自己移动光标来反射性地解决它。相同的解决方法可以内置到您的“修剪和保存”宏中。

*   如果你从“他们的”文件中去掉尾随空格，有些人会感到不安——要么是因为他们喜欢它，要么是因为他们有时使用 diff 而不忽略空格（例如在更改报告中）并且不想看到你已经改变了文件的一半，而实际上它是单行的。因此，对于这些文件，只需将尾随空格保持原样并使用 alt-fs（或您移动保存到的“其他东西”）而不是 ctrl-s 保存。您可能需要将 Notepad++ 设置为不要在保存时清除撤消缓冲区：否则这里的错误将是一场灾难。但我还是这样设置的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-22T15:49:21.967

修剪尾随空间并保存很烦人。您会注意到您无意中在文档中插入了几个字符。

而是记录一个宏并将其绑定到您的 ctrl + s。

这是如何做到的：

1.  宏 -> 开始录制
2.  编辑 -> 修剪尾随空格
3.  文件 -> 保存
4.  宏 -> 停止录制
5.  宏 -> 保存当前录制的宏（修剪并保存）
6.  设置->快捷方式映射器
7.  主菜单 -> 保存 -> Ctrl + Alt + Shift + 保存
8.  宏-> 修剪并保存-> Ctrl + S

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T02:02:49.067

老实说，这对我来说似乎是预期的行为。我自己经常使用空行来分解代码以使其更具可读性，让程序让我不得不再次标记出来会非常烦人。

我可以将其理解为对 Python 之类的挫败感，但对 PHP 则不然……尽管在大括号等之前，这可能很烦人。

然而，试试[Komodo Edit](http://www.activestate.com/Products/komodo_ide/komodo_edit.mhtml)，它是免费的，而且我发现它通常对我来说是自动缩进的最佳选择。它似乎已经学会了我的编码风格（或者它有所有编码风格的选项，它会选择你正在使用的东西）并自动正确缩进所有内容。

编辑：正如您在回复中指出的那样，问题出在“尾随空格” - 我不太了解 Notepad++，但大多数为编码而设计的现代编辑器都有“保存时去除尾随空格”选项（我知道 Komodo做！）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-27T11:24:13.027

您可以参考此设置并注意“标签大小”。 [![在此处输入图像描述](https://i.stack.imgur.com/UG838.png)](https://i.stack.imgur.com/UG838.png)

# assembly - GCC 内联汇编器，混合寄存器大小 (x86)

> ID：118730
> 
> 赞同：12
> 
> 时间：2008-09-23T01:59:00.993
> 
> 标签：assembly, gcc, x86, inline-assembly, cpu-registers

有谁知道我怎样才能摆脱以下汇编程序警告？

代码是 x86，32 位：

```
int test (int x)
{
  int y;
  // do a bit-rotate by 8 on the lower word. leave upper word intact.
  asm ("rorw $8, %0\n\t": "=q"(y) :"0"(x));
  return y;
} 
```

如果我编译它，我会收到以下（非常有效的）警告：

```
Warning: using `%ax' instead of `%eax' due to `w' suffix 
```

我正在寻找的是一种告诉编译器/汇编器我想要访问 %0 的低 16 位子寄存器的方法。访问字节子寄存器（在本例中为 AL 和 AH）也很高兴知道。

我已经选择了“q”修饰符，所以编译器被迫使用 EAX、EBX、ECX 或 EDX。我已经确保编译器必须选择一个具有子寄存器的寄存器。

我知道我可以强制 asm 代码使用特定的寄存器（及其子寄存器），但我想将寄存器分配工作留给编译器。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-23T02:01:58.397

`%w0`如果我没记错你可以使用。我也刚测试过。:-)

```
int
test(int x)
{
    int y;
    asm ("rorw $8, %w0" : "=q" (y) : "0" (x));
    return y;
} 
```

编辑：响应 OP，是的，您也可以执行以下操作：

```
int
test(int x)
{
    int y;
    asm ("xchg %b0, %h0" : "=Q" (y) : "0" (x));
    return y;
} 
```

对于 x86，它记录在手册扩展 Asm 部分的[x86 操作数修饰符部分](https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#x86-Operand-Modifiers)。

对于非 x86 指令集，您可能必须`.md`在 GCC 源代码中挖掘它们的文件。例如，`gcc/config/i386/i386.md`在正式记录之前，它是唯一可以找到它的地方。

（相关：[在 GNU C 内联汇编中，对于单个操作数，xmm/ymm/zmm 的大小覆盖修饰符是什么？](https://stackoverflow.com/questions/34459803/in-gnu-c-inline-asm-what-are-the-size-override-modifiers-for-xmm-ymm-zmm-for-a)对于向量寄存器。）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-24T04:25:31.473

很久以前，但我可能需要这个作为我自己未来的参考......

加上克里斯的好回答说，关键是在“％”和输出操作数的数量之间使用修饰符。例如，`"MOV %1, %0"`可能变成`"MOV %q1, %w0"`.

我在 constraints.md 中找不到任何内容，但是[/gcc/config/i386/i386.c](https://raw.github.com/mirrors/gcc/trunk/gcc/config/i386/i386.c)在源代码中有这个潜在有用的注释`print_reg()`：

```
/* Print the name of register X to FILE based on its machine mode and number.
   If CODE is 'w', pretend the mode is HImode.
   If CODE is 'b', pretend the mode is QImode.
   If CODE is 'k', pretend the mode is SImode.
   If CODE is 'q', pretend the mode is DImode.
   If CODE is 'x', pretend the mode is V4SFmode.
   If CODE is 't', pretend the mode is V8SFmode.
   If CODE is 'h', pretend the reg is the 'high' byte register.
   If CODE is 'y', print "st(0)" instead of "st", if the reg is stack op.
   If CODE is 'd', duplicate the operand for AVX instruction.
 */ 
```

下面的评论`ix86_print_operand()`提供一个例子：

> b -- 打印指定操作数的寄存器的 QImode 名称。
> 
> 如果操作数 [0] 为 reg 0，则 %b0 将打印 %al。

[GCC 内部](http://gcc.gnu.org/onlinedocs/gccint/)文档的[输出模板](http://gcc.gnu.org/onlinedocs/gccint/Output-Template.html)下列出了一些更有用的选项：

> '%cdigit' 可用于替换作为常量值的操作数，而无需通常指示立即操作数的语法。
> 
> '%ndigit' 与 '%cdigit' 类似，只是常量的值在打印前被取反。
> 
> '%adigit' 可用于替换操作数，就像它是内存引用一样，实际操作数被视为地址。这在输出“加载地址”指令时可能很有用，因为此类指令的汇编语法通常要求您编写操作数，就好像它是内存引用一样。
> 
> '%ldigit' 用于将 label_ref 替换为跳转指令。
> 
> '%=' 输出一个数字，该数字对整个编译中的每条指令都是唯一的。这对于在生成多个汇编指令的单个模板中多次引用本地标签很有用。

' `%c2`' 构造允许使用偏移量正确格式化 LEA 指令：

```
#define ASM_LEA_ADD_BYTES(ptr, bytes)                            \
    __asm volatile("lea %c1(%0), %0" :                           \
                   /* reads/writes %0 */  "+r" (ptr) :           \
                   /* reads */ "i" (bytes)); 
```

请注意“ ”中关键但记录很少的“c” `%c1`。这个宏相当于

```
ptr = (char *)ptr + bytes 
```

但不使用通常的整数算术执行端口。

编辑添加：

在 x64 中进行直接调用可能很困难，因为它需要另一个未记录的修饰符：' `%P0`'（这似乎适用于 PIC）

```
#define ASM_CALL_FUNC(func)                                         \
    __asm volatile("call %P0") :                                    \
              /* no writes */ :                                     \
              /* reads %0 */ "i" (func)) 
```

小写的“p”修饰符在 GCC 中的作用似乎也相同，尽管 ICC 只识别大写的“P”。[/gcc/config/i386/i386.c](https://raw.github.com/mirrors/gcc/trunk/gcc/config/i386/i386.c)可能提供更多详细信息。搜索“'p'”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T17:12:58.753

当我在考虑它时......你应该在克里斯的第二个解决方案中用大写的“Q”约束替换“q”约束：

```
int
test(int x)
{
    int y;
    asm ("xchg %b0, %h0" : "=Q" (y) : "0" (x));
    return y;
} 
```

“q”和“Q”在 64 位模式下略有不同，您可以获得所有整数寄存器（ax、bx、cx、dx、si、di、sp、bp、r8-r15）的最低字节. 但是您只能获得四个原始 386 寄存器（ax、bx、cx、dx）的倒数第二个字节（例如 ah）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T06:20:31.740

所以显然有一些技巧可以做到这一点......但它可能没有那么有效。32 位 x86 处理器在处理通用寄存器中的 16 位数据时通常**很慢。**如果性能很重要，您应该对其进行基准测试。

除非这是（a）性能关键并且（b）被证明要快得多，否则我会为自己省去一些维护麻烦，只需在 C 中进行即可：

```
uint32_t y, hi=(x&~0xffff), lo=(x&0xffff);
y = hi + (((lo >> 8) + (lo << 8))&0xffff); 
```

使用 GCC 4.2 和 -O2 可以优化到六个指令......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T16:41:26.643

明白了。好吧，如果这是一个您将一遍又一遍地重用的原始例程，我对此没有任何争论……克里斯指出的寄存器命名技巧是一个很好的技巧，我必须记住。

如果它也能成为标准的 GCC 文档，那就太好了！

# internet-explorer - 在 Internet Explorer 7 中打开多个页面的 Windows 控制台命令

> ID：118748
> 
> 赞同：3
> 
> 时间：2008-09-23T02:05:52.333
> 
> 标签：internet-explorer, command-line, windows-xp, batch-file

如何使用单个 DOS 命令在 Internet Explorer 7 中打开多个页面？批处理文件是执行此操作的唯一方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T02:30:19.827

批处理文件将作为一种快速而肮脏的解决方案。

```
@echo off
@setlocal

:openurl
set url=%~1

if "%url:~0,4%" == "http" (
   start "%ProgramFiles%\Internet Explorer\iexplore.exe" "%url%"
)
if NOT "%url:~0,4%" == "http" (
   start "%ProgramFiles%\Internet Explorer\iexplore.exe" "http://%url%"
)

shift
if "%~1" == "" goto :end
goto :openurl

:end 
```

编辑：添加了对没有 http 处理程序前缀的域名的支持。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-20T04:07:00.493

1.  打开扩展名为 .txt 的 txt 文件
2.  添加以下行

    *   启动 www.google.com
    *   开始 www.yahoo.com
    *   开始 www.microsoft.com
3.  保存文件，在文件上选择重命名并将扩展名从 .txt 更改为 .cmd

4.  双击.cmd文件执行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T02:10:50.700

不幸的是，没有办法将多个 URL 作为命令行参数。这是[一篇博客文章](http://blogs.msdn.com/tonyschr/archive/2007/01/19/ie-automation-amp-tabs.aspx)，详细介绍了另一种（相当复杂的）通过 Javascript 实现此目的的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-01T19:59:07.793

我已经下载了执行此操作的软件。从命令行打开多个网站，无需复制、粘贴 VB 脚本或批处理文件等……可在[http://www.multiwebpageopener.com](http://www.multiwebpageopener.com)获得。

# scala - 如何计算 Lift 中的行数（Scala 的 Web 框架）

> ID：118750
> 
> 赞同：5
> 
> 时间：2008-09-23T02:06:50.820
> 
> 标签：scala, lift

我想向我的 User 模型添加一个属性，该属性返回 Project 表中具有用户的用户 ID 的行数。

所以像这样的事情......

```
def numProjects = {

    /* somehow get count from Project table
       The straight sql would be:
       SELECT COUNT(*) FROM projects WHERE userId = <the current user>

     */

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T05:51:32.963

根据此处的文档[（](http://scala-tools.org/mvnsites/liftweb/lift-webkit/scaladocs/net/liftweb/mapper/MetaMapper.html)在[此处](http://scala-tools.org/mvnsites/liftweb/lift-webkit/scaladocs/)找到），假设您正在寻找 id 为 1234 的用户的项目计数并假设您的项目模型继承了 MetaMapper 特征（可能通过 KeyedMetaMapper），您似乎可以使用 count 方法作为这样的：

```
Project.count(By(User.id, 1234)) 
```

或者

```
Project.count(BySql("userId = ?", 1234)) 
```

我无法测试，因为我还没有使用 Lift，但它看起来不错...... :) 让我知道它是否有效！

# c++ - 有没有一种干净的方法可以防止 windows.h 创建近远宏？

> ID：118774
> 
> 赞同：14
> 
> 时间：2008-09-23T02:14:49.940
> 
> 标签：c++, c, winapi, dos

在 WinDef.h 的深处，有一个分段内存时代的遗物：

```
#define far
#define near 
```

如果您尝试使用 near 或 far 作为变量名，这显然会导致问题。任何干净的解决方法？其他然后重命名我的变量？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-23T07:23:55.580

与其他人的说法相反，您可以安全地取消定义它们。原因是它们只是宏的。它们只影响定义和未定义之间的预处理器。在您的情况下，这将是从 windows.h 的早期到 windows.h 的最后一行。如果您需要额外的 windows 标头，您可以在 windows.h 之后和 #undef 之前包含它们。在您的代码中，预处理器只会按预期保持符号不变。

关于旧代码的评论是无关紧要的。该代码将在一个单独的库中，独立编译。只有在链接时，当宏早已不存在时，它们才会被连接。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-23T02:18:08.623

在包括以下内容后取消定义您不想要的任何宏`windows.h`：

```
#include <windows.h>
#undef near
#undef far 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T02:15:50.500

也许：

```
#undef near
#undef far 
```

虽然可能很危险...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T03:02:48.873

您可能不希望到处都未定义近处和远处。但是当您需要使用变量名时，您可以使用以下内容在本地取消定义宏，并在完成后将其添加回来。

```
#pragma push_macro("near")
#undef near
//your code here.
#pragma pop_macro ("near") 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-23T02:16:36.473

最好不要。它们被定义为与旧代码向后兼容——如果你以某种方式摆脱了它们，然后需要使用一些旧代码，你就会被破坏。

# python - 如何从 OSX Leopard 卸载 python 以便可以使用 MacPorts 版本？

> ID：118813
> 
> 赞同：19
> 
> 时间：2008-09-23T02:38:04.317
> 
> 标签：python, macos, osx-leopard, macports

我想使用 python 的 macports 版本，而不是 Leopard 附带的版本。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-23T02:41:53.247

不。Apple 发布了各种依赖系统 Python（尤其是 Python“框架”构建）的系统实用程序；删除它会给你带来问题。

相反，将您的 PATH 环境变量修改`~/.bash_profile`为`/opt/local/bin`放在第一位。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-23T02:40:05.513

我都安装了：

```
$ which python
/usr/bin/python
$ which python2.5
/opt/local/bin/python2.5 
```

我还将以下行添加到我的`.profile`：

```
export PATH=/opt/local/bin:/opt/local/sbin:$PATH 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-03T03:04:32.797

使用[python_select](http://www.macports.org/ports.php?by=name&substr=python_select)端口切换 python 解释器。

```
sudo port install python25
sudo port install python_select
sudo python_select python25 
```

这将符号链接`/opt/local/bin/python`到所选版本。`PATH`然后如上所述导出。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2011-05-29T07:17:41.623

`python_select`现在已弃用，请改用：

```
sudo port select python python26 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-23T02:40:13.093

不要卸载内置的 Python，而是安装 MacPorts 版本，然后先修改您`$PATH`的 MacPorts 版本。

例如，如果 MacPorts 安装`/usr/local/bin/python`，则将您的修改`.bashrc`为最后包含`PATH=/usr/local/bin:$PATH`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-23T02:41:15.760

我不会卸载它，因为当许多脚本不遵循约定并使用`#!/usr/bin/env python`. 你应该简单地编辑你`.profile`的`.bash_profile`macports 二进制文件是你路径中的第一个。

你`.profile`应该有这一行：

```
export PATH=/opt/local/bin:/opt/local/sbin:$PATH 
```

如果没有，添加它，现在你的 shell 将`bin/`首先搜索 macport 的，并且应该在系统 python 之前找到 macports python。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-04-12T10:22:33.840

当前的 Macports 安装程序会自动进行 .profile PATH 修改。

# sql-server - SQL Server 2000 MSDE 上的多个数据库损坏

> ID：118833
> 
> 赞同：0
> 
> 时间：2008-09-23T02:46:03.597
> 
> 标签：sql-server, database

我们将 SQL Server 2000 MSDE 用于在大约 800 个收银机上运行的销售点系统。每个盒子都有自己的副本，只有本地软件才能访问它。

这是收银机供应商的新更新平台——他们将保持匿名。

我们经常看到 Master、MSDB、Model 和软件使用的数据库损坏。

我在这里寻找的东西比什么都重要，并且有信心说出那个古老的回答：“这不是软件问题，而是硬件问题”。

我的直觉告诉我，这种类型的损坏表明存在硬件问题。任何人都可以提出一些替代方案来检查吗？

**编辑**：关于问题的新信息

自从我第一次发布这个问题以来已经有一段时间了。事实证明，以预防方式积极使用 CHKDSK 似乎可以最大限度地减少问题的发生。此外，我似乎没有提到收银机正在运行 Windows XP 的 WePOS 版本。最后，我遇到了一些不属于应用程序一部分的损坏文件，这些文件已通过 CHKDSK 修复。

这些新事实有没有引起任何人的共鸣？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T03:07:25.853

我有一个经验法则，每 100 个问题中有 90 个是用户误解（例如关闭 PC），10 个是由软件引起的，1 个是硬件引起的。

有这么多系统要更新，我会寻找诸如尚未完全修补的系统之类的东西。用户关闭电脑等。电脑是否锁定或崩溃？

如果上述所有问题的答案是否定的，那么根据经验法则，我会寻找您的软件，因为那将是 SQL 数据库的接口（大概）。

这里没有足够的信息来提供更多帮助。

这个软件是你写的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T02:51:09.980

我知道它不是“替代品”，但不管你信不信，我已经从微软那里找到了很多关于我的微软问题的答案。

您可能想在[microsoft developer network提交查询](http://msdn.microsoft.com/en-us/default.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T03:00:49.707

我以前走过那条路，但我错了。您是否能够识别操作系统或任何其他文件中的任何数据损坏情况？此外，如果您的 POS 不必在非工作时间启动，请尝试运行压力测试，将数据直接加载到您的架构中，并通过您的应用程序的数据层（如果可能）。

这些可能找不到问题，但是除了坏硬件之外，这些问题仍然有许多偷偷摸摸的方式传播。

# ruby - gsub 部分替换

> ID：118839
> 
> 赞同：19
> 
> 时间：2008-09-23T02:48:25.650
> 
> 标签：ruby, regex

我只想替换此表达式中括号中的组：

```
my_string.gsub(/<--MARKER_START-->(.)*<--MARKER_END-->/, 'replace_text') 
```

这样我得到：`<--MARKER_START-->replace_text<--MARKER_END-->`

我知道我可以在替换表达式中重复整个`MARKER_START`和`MARKER_END`块，但我认为应该有一种更简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-23T03:31:55.420

您可以使用[零宽度前瞻和后视断言](http://www.perlmonks.org/?node_id=518444)来做到这一点。

这个正则表达式应该在 ruby​​ 1.9 和 perl 和许多其他地方工作：

*注意：ruby 1.8 只支持前瞻断言。您需要前瞻和后瞻才能正确执行此操作。*

```
 s.gsub( /(?<=<--MARKER START-->).*?(?=<--MARKER END-->)/, 'replacement text' ) 
```

ruby 1.8 中发生的事情是`?<=`它崩溃的原因，因为它不理解后向断言。对于那部分，您必须回退到使用反向引用 - 就像[Greig Hewgill 提到的](https://stackoverflow.com/questions/118839/gsub-partial-replace#118852)

所以你得到的是

```
 s.gsub( /(<--MARKER START-->).*?(?=<--MARKER END-->)/, '\1replacement text' ) 
```

### 解释第一：

我已经用`(.)*`你的正则表达式替换了`.*?`- 这是非贪婪的。如果您没有非贪婪，那么您的正则表达式将尝试尽可能多地匹配 - 如果您在一行上有 2 个标记，则会出错。最好通过示例来说明这一点：

```
"<b>One</b> Two <b>Three</b>".gsub( /<b>.*<\/b>/, 'BOLD' )
=> "BOLD" 
```

我们真正想要的：

```
"<b>One</b> Two <b>Three</b>".gsub( /<b>.*?<\/b>/, 'BOLD' )
=> "BOLD Two BOLD" 
```

### 解释二：

零宽度前瞻性断言听起来像是一大堆书呆子的困惑。

“look-ahead-assertion”实际上意味着“只有匹配，如果我们正在寻找的东西，后面跟着其他东西。

例如，只匹配一个数字，如果它后跟一个 F。

```
"123F" =~ /\d(?=F)/ # will match the 3, but not the 1 or the 2 
```

“零宽度”实际上意味着“在我们的搜索中考虑‘跟随’，但在进行替换或分组或类似的事情时不要将其视为匹配的一部分。使用 123F 的相同示例，如果我们没有'不使用前瞻断言，而只是这样做：

```
"123F" =~ /\dF/ # will match 3F, because F is considered part of the match 
```

如您所见，这是检查我们的 的理想选择`<--MARKER END-->`，但我们需要的`<--MARKER START-->`是能够说“仅匹配，如果我们正在寻找的东西跟随其他东西”。这称为后视断言，由于某些奇怪的原因，ruby 1.8 没有。

希望这是有道理的:-)

PS：为什么使用前瞻断言而不是反向引用？如果您使用前瞻，您实际上并没有替换`<--MARKER-->`位，而只是替换了内容。如果您使用反向引用，您将替换整个批次。我不知道这是否会对性能造成很大影响，但从编程的角度来看，这似乎是正确的做法，因为我们实际上根本不想替换标记。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-23T02:56:04.383

你可以这样做：

```
my_string.gsub(/(<--MARKER_START-->)(.*)(<--MARKER_END-->)/, '\1replace_text\3') 
```

# codeplex - 在 CodePlex 中启动项目

> ID：118844
> 
> 赞同：0
> 
> 时间：2008-09-23T02:53:06.247
> 
> 标签：codeplex

如何在 CodePlex.com 中启动项目？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T02:58:25.220

尝试去 CodePlex 并在那里[阅读如何做到这一点](http://www.codeplex.com/CodePlex/Wiki/View.aspx?title=CodePlex%20FAQ&referringTitle=Home)。 [登记](https://www.codeplex.com/site/register)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T03:00:25.760

在主页面，左侧有一个链接：[创建新项目](http://www.codeplex.com/Project/ProjectCreation.aspx)

您必须拥有一个 CodePlex 帐户才能执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T02:58:29.697

[https://www.codeplex.com/Project/ProjectCreation.aspx](https://www.codeplex.com/Project/ProjectCreation.aspx)

请记住，您必须在 30 天内发布某些内容（即使只是部分来源），否则他们会删除您的项目。它不适用于私人或闭源项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T02:59:58.430

页面左侧有一个[创建新项目链接。](http://www.codeplex.com/Project/ProjectCreation.aspx)

您可能必须先[注册](https://www.codeplex.com/site/register)。

你对这个过程有更具体的问题吗？

# asp.net-mvc - ASP.NET MVC 路由

> ID：118851
> 
> 赞同：3
> 
> 时间：2008-09-23T02:55:31.420
> 
> 标签：asp.net-mvc, routing

到目前为止，我已经能够摆脱使用 ASP.NET MVC 附带的默认路由。不幸的是，现在我正在涉足更复杂的路线，我正在努力思考如何让它发挥作用。

我试图获得的一个简单示例是让路径 /User/{UserID}/Items 映射到用户控制器的 Items 函数。谁能告诉我我在这里的路由做错了什么？

```
routes.MapRoute("UserItems", "User/{UserID}/Items", 
                      new {controller = "User", action = "Items"}); 
```

在我的 aspx 页面上

```
Html.ActionLink("Items", "UserItems", new { UserID = 1 }) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T04:00:25.163

按照我面前的 MVC Preview 4 代码，您正在使用的 Html.ActionLink() 的重载是这个：

```
public string ActionLink(string linkText, string actionName, object values); 
```

注意第二个参数是*actionName*而不是*routeName*。

因此，尝试：

```
Html.ActionLink("Items", "Items", new { UserID = 1 }) 
```

或者，尝试：

```
<a href="<%=Url.RouteUrl("UserItems", new { UserId = 1 })%>">Items</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T03:47:25.787

你能发布更多信息吗？链接中生成的 aspx 页面是什么 URL？这可能是因为您的路线定义的顺序。我认为您需要在默认路由之前声明您的路由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T07:22:25.037

首先查看它生成的 URL 并使用[Phil Haack](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)的路由调试库检查它。它会清除很多东西。

如果您有一堆路由，您可能需要考虑命名您的路由并使用命名路由。当您重新访问代码时，它将使您的意图更加清晰，并且可能会提高解析速度。

此外（这纯粹是个人意见）我喜欢在页面开头的某处以字符串的形式生成链接，然后将这些字符串放入我的 HTML 中。这是一个很小的开销，但在我看来使代码更具可读性。此外，如果您有或重复链接，则只需生成一次。

我更喜欢放

```
<% string action = Url.RouteUrl("NamedRoute", new 
    { controller="User",
      action="Items",
      UserID=1});%> 
```

后来写

```
<a href="<%=action%>">link</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-30T01:53:48.963

```
Html.ActionLink("Items", "User", new { UserID = 1 }) 
```

# oop - 何时在 VBA 中使用类？

> ID：118863
> 
> 赞同：41
> 
> 时间：2008-09-23T02:59:55.793
> 
> 标签：oop, vba, class

什么时候适合在 Visual Basic for Applications (VBA) 中使用类？

我假设[加速开发和减少引入错误](http://en.wikipedia.org/wiki/Class_(computer_science)#Reasons_for_using_classes)对于大多数支持 OOP 的语言来说是一个共同的好处。但是对于 VBA，是否有特定的标准？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-27T10:51:06.943

这取决于谁将开发和维护代码。典型的“高级用户”宏编写者破解小型临时应用程序可能会因使用类而感到困惑。但是对于认真的开发，使用类的原因与其他语言相同。您有与 VB6 相同的限制 - 没有继承 - 但您可以通过使用接口来实现多态性。

类的一个很好的用途是表示实体和实体的集合。例如，我经常看到 VBA 代码将 Excel 范围复制到二维数组中，然后使用如下代码操作二维数组：

```
Total = 0
For i = 0 To NumRows-1
    Total = Total + (OrderArray(i,1) * OrderArray(i,3))
Next i 
```

将范围复制到具有适当命名属性的对象集合中更具可读性，例如：

```
Total = 0
For Each objOrder in colOrders
    Total = Total + objOrder.Quantity * objOrder.Price
Next i 
```

另一个例子是使用类来实现 RAII 设计模式（google for it）。例如，我可能需要做的一件事是取消保护工作表，进行一些操作，然后再次保护它。使用类可确保即使代码中出现错误，工作表也将始终受到保护：

```
--- WorksheetProtector class module ---

Private m_objWorksheet As Worksheet
Private m_sPassword As String

Public Sub Unprotect(Worksheet As Worksheet, Password As String)
    ' Nothing to do if we didn't define a password for the worksheet
    If Len(Password) = 0 Then Exit Sub

    ' If the worksheet is already unprotected, nothing to do
    If Not Worksheet.ProtectContents Then Exit Sub

    ' Unprotect the worksheet
    Worksheet.Unprotect Password

    ' Remember the worksheet and password so we can protect again
    Set m_objWorksheet = Worksheet
    m_sPassword = Password
End Sub

Public Sub Protect()
    ' Protects the worksheet with the same password used to unprotect it
    If m_objWorksheet Is Nothing Then Exit Sub
    If Len(m_sPassword) = 0 Then Exit Sub

    ' If the worksheet is already protected, nothing to do
    If m_objWorksheet.ProtectContents Then Exit Sub

    m_objWorksheet.Protect m_sPassword
    Set m_objWorksheet = Nothing
    m_sPassword = ""
End Sub

Private Sub Class_Terminate()
    ' Reprotect the worksheet when this object goes out of scope
    On Error Resume Next
    Protect
End Sub 
```

然后，您可以使用它来简化代码：

```
Public Sub DoSomething()
   Dim objWorksheetProtector as WorksheetProtector
   Set objWorksheetProtector = New WorksheetProtector
   objWorksheetProtector.Unprotect myWorksheet, myPassword

   ... manipulate myWorksheet - may raise an error

End Sub 
```

当这个 Sub 退出时， objWorksheetProtector 超出范围，并且工作表再次受到保护。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-25T11:17:02.587

我认为标准与其他语言相同

如果您需要将几条数据和一些方法联系在一起，并且还需要专门处理创建/终止对象时发生的情况，那么类是理想的

假设您有几个程序在您打开表单时触发并且其中一个需要很长时间，您可能会决定要对每个阶段进行计时......

您可以创建一个秒表类，其中包含用于启动和停止的明显函数的方法，然后您可以添加一个函数来检索到目前为止的时间并在文本文件中报告它，使用表示正在计时的进程名称的参数。您可以编写逻辑来仅记录最慢的性能以进行调查。

然后，您可以添加一个进度条对象，其中包含打开和关闭它的方法，并显示当前操作的名称，以及以毫秒为单位的时间以及基于先前存储的报告等可能剩余的时间

另一个示例可能是，如果您不喜欢 Access 的用户组垃圾，您可以创建自己的 User 类，其中包含登录和注销方法以及组级用户访问控制/审核/记录某些操作/跟踪错误等功能

当然，您可以使用一组不相关的方法和大量变量传递来做到这一点，但是将它们全部封装在一个类中对我来说似乎更好。

您迟早会接近 VBA 的极限，但它是一种非常强大的语言，如果您的公司将您与它联系起来，您实际上可以从中获得一些好的、复杂的解决方案。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-02-13T17:26:10.017

类在处理更复杂的 API 函数时非常有用，尤其是当它们需要数据结构时。

例如，GetOpenFileName() 和 GetSaveFileName() 函数采用具有许多成员的 OPENFILENAME 结构。您可能不需要利用所有这些，但它们就在那里并且应该被初始化。

我喜欢将结构 (UDT) 和 API 函数声明包装到 CfileDialog 类中。Class_Initialize 事件设置结构成员的默认值，这样当我使用类时，我只需要设置我想要更改的成员（通过 Property 程序）。标志常量被实现为枚举。因此，例如，要选择要打开的电子表格，我的代码可能如下所示：

```
Dim strFileName As String
Dim dlgXLS As New CFileDialog

With dlgXLS
  .Title = "Choose a Spreadsheet"
  .Filter = "Excel (*.xls)|*.xls|All Files (*.*)|*.*"
  .Flags = ofnFileMustExist OR ofnExplorer

  If OpenFileDialog() Then
    strFileName = .FileName
  End If
End With
Set dlgXLS = Nothing 
```

该类将默认目录设置为“我的文档”，但如果我愿意，可以使用 InitDir 属性更改它。

这只是一个类如何在 VBA 应用程序中发挥巨大作用的一个例子。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-23T03:40:25.557

我不会说有一个特定的标准，但我从来没有真正找到一个有用的地方在 VBA 代码中使用类。在我看来，它与 Office 应用程序周围的现有模型是如此相关，以至于在该对象模型之外添加额外的抽象只会使事情变得混乱。

这并不是说**无法**在 VBA 中为类找到有用的位置，或者无法使用类做非常有用的事情，只是我从未发现它们在那种环境中有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-13T01:29:06.310

如果我想创建一个自我封装的代码包，我将使用类，我将在为各种客户遇到的许多 VBA 项目中使用该代码包。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T11:03:28.540

您还可以在不使用实际类的情况下重用 VBA 代码。例如，如果您有一个称为 VBACode。您可以使用以下语法访问任何模块中的任何函数或子：

```
VBCode.mysub(param1, param2) 
```

如果您创建对模板/文档的引用（就像您创建 dll 一样），您可以以相同的方式引用其他项目的代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-12T16:51:19.540

对于数据递归（又名 BOM 处理），自定义类非常有用，我认为有时是必不可少的。你可以在没有类模块的情况下制作递归函数，但是很多数据问题无法有效解决。

（我不知道为什么人们不为 VBA 兜售 BOM 库集。也许 XML 工具有所作为。）

多个表单实例是一个类的常见应用（许多自动化问题否则无法解决），我认为问题是关于**自定义**类。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-12T21:16:39.370

当我需要做某事时，我会使用类，而类会做得最好：) 例如，如果您需要响应（或拦截）事件，那么您需要一个类。有些人讨厌 UDT（用户定义类型），但我喜欢它们，所以如果我想要纯英语的自文档代码，我会使用它们。Pharmacy.NCPDP 比 strPhrmNum 更容易阅读 :) 但是 UDT 是有限的，所以说我希望能够设置 Pharmacy.NCPDP 并填充所有其他属性。而且我也想做到这一点，这样你就不会意外地改变数据。然后我需要一个类，因为您在 UDT 中没有只读属性等。

另一个考虑因素只是简单的可读性。如果您正在处理复杂的数据结构，知道您只需要调用 Company.Owner.Phone.AreaCode 然后尝试跟踪所有内容的结构通常是有益的。特别是对于那些在你离开 2 年后必须维护该代码库的人:)

我自己的两分钱是“有目的的代码”。不要无缘无故地使用课程。但如果你有理由，那就去做吧:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T17:28:43.643

使用面向对象编程开发软件，即使使用 Microsoft Access，通常也是一种很好的做法。它将通过允许对象松散耦合以及许多优势来实现未来的可伸缩性。这基本上意味着您系统中的对象将更少相互依赖，因此重构变得容易得多。您可以使用类模块来实现这一点。缺点是您无法在 VBA 中执行类继承或多态性。最后，关于使用类没有硬性规定，只有最佳实践。但请记住，随着您的应用程序的增长，使用类进行维护变得更加容易。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-10-29T17:27:17.047

由于在 VBA 中使用类有很多代码开销，我认为一个类必须提供比其他语言更多的好处：

所以这是在使用类而不是函数之前要考虑的事情：

*   vba 中没有类继承。所以当你在不同的类中做类似的小事情时，准备复制一些代码。当您想要使用接口并想要在不同的类中实现一个接口时，尤其会发生这种情况。

*   vba 类中没有内置的构造函数。就我而言，我创建了一个如下所示的额外函数来模拟这一点。但是诅咒，这也是开销，并且可以被如何使用该类的人忽略。另外：由于不可能使用具有相同名称但参数不同的不同函数，因此您必须为“构造函数”函数使用不同的名称。此外，这些功能会导致额外的调试步骤，这可能会很烦人。

`Public Function MyClass(ByVal someInit As Boolean) As MyClassClass Set MyClass = New MyClassClass Call MyClass.Init(someInit) End Function`

*   开发环境不为类名提供“goto 定义”。这可能很烦人，尤其是在使用带有接口的类时，因为您总是必须使用模块浏览器来跳转到类代码。

*   对象变量在不同地方的使用与其他变量类型不同。所以你必须使用额外的“Set”来分配一个对象

`Set varName = new ClassName`

*   如果您想对对象使用属性，则由不同的设置器完成。你必须使用“set”而不是“let”

*   如果您在 vba 中实现接口，则函数名称被命名为“InterfaceName_functionName”并定义为私有。因此，只有将变量强制转换为接口时，才能使用接口函数。如果你想使用原始类的函数，你必须创建一个额外的“公共”函数，它只调用接口函数（见下文）。这也创建了一个额外的调试步骤。

`'content of class-module: MyClass implements IMyInterface private sub IMyInterface_SomeFunction() 'This can only be called if you got an object of type "IMyInterface" end function private sub IMyInterface_SomeFunction() 'You need this to call the function when having an object of the type "MyClass" Call IMyInterface_SomeFunction() end function`

这表示：

*   我不！当它们不包含成员变量时使用类。
*   我知道开销并且不使用类作为默认值来做事。通常只使用函数是在 VBA 中做事的默认方式。

我创建的类示例，我发现它们很有用：

*   集合类：例如缺少提供集合功能的 StringCollection、LongCollection vba
*   DbInserter-Class：创建插入语句的类

我创建的但我发现没有用的类的示例：

*   Converter-class：提供将变量转换为其他类型的功能的类（例如 StringToLong、VariantToString）
*   StringTool-class：一个可以为字符串提供一些功能的类。例如 StartsWith

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-08-03T18:37:10.463

您可以在访问中定义一个比记录集和查询定义更方便的 sql 包装类。例如，如果要根据另一个相关表中的条件更新表，则不能使用联接。您可以构建一个 vba recorset 和 querydef 来做到这一点，但是我发现使用类更容易。此外，您的应用程序可能有一些需要超过 2 个表的概念，为此使用类可能会更好。例如，您的应用程序跟踪事件。事件有几个属性，将保存在几个表中{用户及其联系人或个人资料、事件描述；状态跟踪；帮助支持人员回复事件的清单；回复 ...} 。要跟踪所有涉及的查询和关系，oop 可能会有所帮助。能够做 Incident.Update(xxx) 而不是所有的编码是一种解脱......

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-09-23T03:01:45.837

我不明白为什么 VBA 的标准与另一种语言有任何不同，特别是如果您指的是 VB.NET。

# asp.net - 如何设置 sql profiler 来分析 SQL 2005 报告服务

> ID：118872
> 
> 赞同：2
> 
> 时间：2008-09-23T03:02:27.393
> 
> 标签：asp.net, sql-server, reporting-services, reportingservices-2005, sql-server-profiler

我正在尝试分析从 ASP.NET 应用程序使用的 SQL 报告服务。在 SQL 分析器中，由 ASP.NET 运行的所有 SQL 都会显示出来。看起来报告 SQL（来自 RDL）没有显示。我缺少一些设置或过滤器吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T18:48:46.783

应用程序名称列 = Reporting Services（或类似）通常。

您可能需要跟踪 SQL 批处理完成*和*RPC 调用完成我以前被这个咬过......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T03:35:43.757

当你得到那个乱七八糟的球时，你可以搜索它。我会搜索您知道只能由 SSRS 使用的 sp 或 sql 语句。（如果这不存在，那么出于测试目的强制其中一些东西）。查看所有列。可能会有一列作为报告服务的独特之处跳出来，您可以将其用作过滤器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-17T23:33:10.473

所以我有几种方法可以帮助你。

1.  添加名为“HostName”的列，您将获得显示为运行报告的计算机的服务器名称。
2.  将报告登录名添加到数据库并在报告服务的共享数据源上使用该名称，然后按 LoginName 过滤。
3.  如果您向报告添加注释，那么您将看到该注释和报告的 sql 出现在数据窗口中。

对于第三个，我的意思是这样做：

* * *

-- 获取产品报告

从产品中选择productid、productname

* * *

并且注释行将与 SQL 一起出现在窗口中，当您注意到其中一个导致问题时，可以很容易地跟踪到报告，进一步跟踪。

希望有帮助。

# c++ - “__callback” SAL 注释的作用是什么？

> ID：118876
> 
> 赞同：0
> 
> 时间：2008-09-23T03:04:15.220
> 
> 标签：c++, visual-c++, annotations, callback, static-analysis

虽然我当然了解缓冲区注释的目的，但我看不出[__callback](http://msdn.microsoft.com/en-us/library/aa383701%28VS.85%29.aspx)检测到什么样的错误。

有什么想法、例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T03:30:14.580

因为如果你忘记了返回 void* 并且*不是*回调的东西的括号，SAL 可以告诉你。

# javascript - 如何强制浏览器重新加载缓存的 CSS 和 JavaScript 文件

> ID：118884
> 
> 赞同：1101
> 
> 时间：2008-09-23T03:07:13.577
> 
> 标签：javascript, css, caching, auto-versioning

我注意到一些浏览器（特别是 Firefox 和[Opera](https://en.wikipedia.org/wiki/Opera_%28web_browser%29)）非常热衷于使用**.css**和**.js**文件的缓存副本，即使在浏览器会话之间也是如此。当您更新其中一个文件时，这会导致问题，但用户的浏览器会继续使用缓存的副本。

强制用户浏览器在文件更改时重新加载文件的最优雅方法是什么？

理想情况下，该解决方案不会强制浏览器在每次访问页面时重新加载文件。

* * *

我发现[John Millikin](https://stackoverflow.com/questions/118884/how-to-force-the-browser-to-reload-cached-css-and-javascript-files/118921#118921)和[da5id 的](https://stackoverflow.com/questions/118884/how-to-force-the-browser-to-reload-cached-css-and-javascript-files/118901#118901)建议很有用。事实证明有一个术语：**自动版本控制**。

我在下面发布了一个新答案，它结合了我的原始解决方案和约翰的建议。

**SCdF**提出的另一个想法是将伪造的查询字符串附加到文件中。（一些 Python 代码自动使用时间戳作为伪造的查询字符串，由[*pi*](https://stackoverflow.com/questions/118884/how-to-force-the-browser-to-reload-cached-css-and-javascript-files/121143#121143)[提交](https://stackoverflow.com/questions/118884/how-to-force-the-browser-to-reload-cached-css-and-javascript-files/121143#121143)*。。）*

 *但是，关于浏览器是否会缓存带有查询字符串的文件存在一些讨论。（请记住，我们希望浏览器缓存文件并在以后的访问中使用它。我们只希望它在文件更改时再次获取文件。）

* * *

## 回答 #1

> 赞同：483
> 
> 时间：2008-09-23T03:07:49.363

这个解决方案是用 PHP 编写的，但它应该很容易适应其他语言。

原始的`.htaccess`正则表达式可能会导致文件出现问题，例如`json-1.3.js`. 解决方案是仅在末尾正好有 10 位时才重写。（因为 10 位数字涵盖了从 2001 年 9 月 9 日到 2286 年 11 月 20 日的所有时间戳。）

首先，我们在 .htaccess 中使用以下重写规则：

```
RewriteEngine on
RewriteRule ^(.*)\.[\d]{10}\.(css|js)$ $1.$2 [L] 
```

现在，我们编写以下 PHP 函数：

```
/**
 *  Given a file, i.e. /css/base.css, replaces it with a string containing the
 *  file's mtime, i.e. /css/base.1221534296.css.
 *
 *  @param $file  The file to be loaded.  Must be an absolute path (i.e.
 *                starting with slash).
 */
function auto_version($file)
{
  if(strpos($file, '/') !== 0 || !file_exists($_SERVER['DOCUMENT_ROOT'] . $file))
    return $file;

  $mtime = filemtime($_SERVER['DOCUMENT_ROOT'] . $file);
  return preg_replace('{\\.([^./]+)$}', ".$mtime.\$1", $file);
} 
```

现在，无论您在哪里包含您的 CSS，都将其更改为：

```
<link rel="stylesheet" href="/css/base.css" type="text/css" /> 
```

对此：

```
<link rel="stylesheet" href="<?php echo auto_version('/css/base.css'); ?>" type="text/css" /> 
```

这样，您无需再次修改链接标签，用户将始终看到最新的 CSS。浏览器将能够缓存 CSS 文件，但是当您对 CSS 进行任何更改时，浏览器会将其视为新 URL，因此它不会使用缓存的副本。

这也适用于图像、网站图标和 JavaScript。基本上任何不是动态生成的。

* * *

## 回答 #2

> 赞同：219
> 
> 时间：2008-09-23T04:04:57.150

### 简单的客户端技术

一般来说，缓存是好的……所以有几种技术，取决于您是在开发网站时为自己解决问题，还是在生产环境中尝试控制缓存。

您网站的一般访问者不会获得与您在开发网站时相同的体验。由于普通访问者访问该站点的频率较低（可能每月只有几次，除非您是 Google 或 hi5 Networks），因此他们不太可能将您的文件缓存在缓存中，这可能就足够了。

如果你想强制一个新版本进入浏览器，你总是可以在请求中添加一个查询字符串，并在你进行重大更改时提高版本号：

```
<script src="/myJavascript.js?version=4"></script> 
```

这将确保每个人都能获得新文件。它之所以有效，是因为浏览器会查看文件的 URL 以确定它是否在缓存中有副本。如果您的服务器未设置为对查询字符串执行任何操作，它将被忽略，但该名称在浏览器中看起来就像一个新文件。

另一方面，如果您正在开发一个网站，您不希望每次保存对开发版本的更改时都更改版本号。那会很乏味。

因此，在您开发网站时，一个好技巧是自动生成查询字符串参数：

```
<!-- Development version: -->
<script>document.write('<script src="/myJavascript.js?dev=' + Math.floor(Math.random() * 100) + '"\><\/script>');</script> 
```

在请求中添加查询字符串是对资源进行版本控制的好方法，但对于简单的网站，这可能是不必要的。请记住，缓存是一件好事。

还值得注意的是，浏览器不一定会吝啬将文件保存在缓存中。浏览器对这类事情有策略，它们通常遵循 HTTP 规范中规定的规则。当浏览器向服务器发出请求时，响应的一部分是一个[Expires](https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Standard_response_fields)标头......一个告诉浏览器应该在缓存中保留多长时间的日期。下次浏览器遇到对同一文件的请求时，它会看到它在缓存中有一个副本，并查看*到期*日期来决定是否应该使用它。

所以不管你信不信，实际上是你的服务器让浏览器缓存如此持久。您可以调整您的服务器设置并更改*Expires*标头，但我上面写的这个小技巧可能是一种更简单的方法。由于缓存很好，您通常希望将该日期设置为远在未来（“Far-future Expires Header”），并使用上述技术强制更改。

如果您对有关 HTTP 或如何发出这些请求的更多信息感兴趣，一本好书是 Steve Souders 的“高性能网站”。这是一个很好的主题介绍。

* * *

## 回答 #3

> 赞同：115
> 
> 时间：2011-04-07T22:26:11.663

Google 的[Apache的](https://en.wikipedia.org/wiki/Apache_HTTP_Server)[mod_pagespeed](http://code.google.com/p/modpagespeed/)插件将为您进行自动版本控制。它真的很光滑。

它在离开网络服务器的过程中解析 HTML（适用于 PHP、[Ruby on Rails](https://en.wikipedia.org/wiki/Ruby_on_Rails)、Python、静态 HTML ——任何东西）并重写指向 CSS、JavaScript、图像文件的链接，以便它们包含一个 id 代码。它在修改后的 URL 上提供文件，并对它们进行非常长的缓存控制。当文件更改时，它会自动更改 URL，因此浏览器必须重新获取它们。它基本上可以正常工作，无需对您的代码进行任何更改。它甚至会在退出时缩小您的代码。

* * *

## 回答 #4

> 赞同：96
> 
> 时间：2008-09-23T13:25:04.790

我建议您使用实际 CSS 文件的 MD5 哈希值，而不是手动更改版本。

所以你的网址会是这样的

```
http://mysite.com/css/[md5_hash_here]/style.css 
```

您仍然可以使用重写规则去除散列，但优点是现在您可以将缓存策略设置为“永久缓存”，因为如果 URL 相同，则意味着文件未更改。

然后，您可以编写一个简单的 shell 脚本来计算文件的哈希值并更新您的标签（您可能希望将其移动到单独的文件中以包含在内）。

每次 CSS 更改时只需运行该脚本即可。浏览器只会在更改文件时重新加载您的文件。如果您进行了编辑然后撤消它，那么确定您需要返回哪个版本以使您的访问者不会重新下载是没有痛苦的。

* * *

## 回答 #5

> 赞同：89
> 
> 时间：2013-01-26T10:53:34.730

我不知道你们为什么要付出这么多的痛苦来实施这个解决方案。

如果获取文件的修改时间戳并将其作为查询字符串附加到文件中，您需要做的就是。

在 PHP 中，我会这样做：

```
<link href="mycss.css?v=<?= filemtime('mycss.css') ?>" rel="stylesheet"> 
```

*filemtime()*是一个 PHP 函数，它返回文件修改的时间戳。

* * *

## 回答 #6

> 赞同：57
> 
> 时间：2008-09-23T03:12:49.427

你可以`?foo=1234`在你的 CSS / JavaScript 导入的最后加上，把 1234 改成你喜欢的。以 Stack Overflow HTML 源代码为例。

无论如何，`?`参数都会在请求中被丢弃/忽略，并且您可以在推出新版本时更改该数字。

* * *

**注意：**关于这究竟如何影响缓存存在一些争论。我相信它的一般要点是带有或不带参数的[GET请求](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)*应该*是可缓存的，因此上述解决方案应该有效。

但是，由网络服务器决定是否要遵守规范的那部分和用户使用的浏览器，因为它可以直接继续并要求一个新版本。

* * *

## 回答 #7

> 赞同：43
> 
> 时间：2008-09-23T03:21:55.770

我听说这称为“自动版本控制”。最常见的方法是在 URL 中的某处包含静态文件的修改时间，并使用重写处理程序或 URL 配置将其删除：

也可以看看：

*   [Django 中的自动资产版本控制](http://muffinresearch.co.uk/archives/2008/04/08/automatic-asset-versioning-in-django/)
*   [自动版本化您的 CSS 和 JavaScript 文件](http://particletree.com/notebook/automatically-version-your-css-and-javascript-files/)

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2015-08-03T20:09:42.697

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2017-03-03T10:15:11.377

在[Laravel](https://en.wikipedia.org/wiki/Laravel) (PHP) 中，我们可以通过以下清晰而优雅的方式来实现（使用文件修改时间戳）：

```
<script src="{{ asset('/js/your.js?v='.filemtime('js/your.js')) }}"></script> 
```

和 CSS 类似

```
<link rel="stylesheet" href="{{asset('css/your.css?v='.filemtime('css/your.css'))}}"> 
```

示例 HTML 输出（`filemtime`以[Unix 时间戳](https://www.unixtimestamp.com/index.php)的形式返回时间）

```
<link rel="stylesheet" href="assets/css/your.css?v=1577772366"> 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2008-09-23T06:02:44.853

不要使用`foo.css?version=1`！

浏览器不应该缓存带有 GET 变量的 URL。根据[http://www.thinkvitamin.com/features/webapps/serving-javascript-fast](http://www.thinkvitamin.com/features/webapps/serving-javascript-fast)，虽然 Internet Explorer 和 Firefox 忽略了这一点，但[Opera](https://en.wikipedia.org/wiki/Opera_%28web_browser%29)和[Safari](https://en.wikipedia.org/wiki/Safari_%28web_browser%29)却没有！相反，使用*foo.v1234.css*，并使用重写规则去除版本号。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2015-01-13T14:46:12.453

Here is a pure JavaScript solution

```
(function(){

    // Match this timestamp with the release of your code
    var lastVersioning = Date.UTC(2014, 11, 20, 2, 15, 10);

    var lastCacheDateTime = localStorage.getItem('lastCacheDatetime');

    if(lastCacheDateTime){
        if(lastVersioning > lastCacheDateTime){
            var reload = true;
        }
    }

    localStorage.setItem('lastCacheDatetime', Date.now());

    if(reload){
        location.reload(true);
    }

})(); 
```

The above will look for the last time the user visited your site. If the last visit was before you released new code, it uses `location.reload(true)` to force page refresh from server.

I usually have this as the very first script within the `<head>` so it's evaluated before any other content loads. If a reload needs to occurs, it's hardly noticeable to the user.

I am using local storage to store the last visit timestamp on the browser, but you can add cookies to the mix if you're looking to support older versions of IE.

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2010-08-05T16:55:01.247

RewriteRule 需要对末尾包含点符号版本控制的 JavaScript 或 CSS 文件进行小更新。例如，*json-1.3.js*。

我在正则表达式中添加了一个点否定类 [^.]，所以是 .number。被忽略。

```
RewriteRule ^(.*)\.[^.][\d]+\.(css|js)$ $1.$2 [L] 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2009-06-24T23:20:10.143

有趣的帖子。在这里阅读了所有答案，再加上我从未遇到过“虚假”查询字符串的任何问题（我不确定为什么每个人都不愿意使用它），我猜想是解决方案（它消除了对 Apache 重写规则的需要如在接受的答案中）是计算 CSS 文件内容的简短*哈希*（而不是文件日期时间）作为伪造的查询字符串。

这将导致以下结果：

```
<link rel="stylesheet" href="/css/base.css?[hash-here]" type="text/css" /> 
```

当然，日期时间解决方案在编辑 CSS 文件的情况下也能完成工作，但我认为这是关于 CSS 文件内容而不是文件日期时间，那么为什么要把这些混在一起呢？

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2014-09-30T20:11:38.663

对于 ASP.NET 4.5 及更高版本，您可以使用[脚本捆绑](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)。

> 该请求`http://localhost/MvcBM_time/bundles/AllMyScripts?v=r0sLDicvP58AIXN_mc3QdyVvVj5euZNzdsa2N1PKvb81`针对捆绑包 AllMyScripts，并包含查询字符串对 v=r0sLDicvP58AIXN_mc3QdyVvVj5euZNzdsa2N1PKvb81。查询字符串`v`有一个值标记，它是用于缓存的唯一标识符。只要包没有改变，ASP.NET 应用程序就会使用这个令牌请求 AllMyScripts 包。如果捆绑包中的任何文件发生更改，ASP.NET 优化框架将生成一个新令牌，确保浏览器对捆绑包的请求将获得最新的捆绑包。

捆绑还有其他好处，包括通过缩小来提高首次页面加载的性能。

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2015-07-24T19:12:57.190

对于我的开发，我发现 Chrome 有一个很好的解决方案。

[https://superuser.com/a/512833](https://superuser.com/a/512833)

打开开发人员工具后，只需长按刷新按钮，然后将鼠标悬停在“空缓存和硬重新加载”上即可。

这是我最好的朋友，并且是获得您想要的东西的超轻量级方式！

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2011-01-07T05:58:27.343

感谢[Kip 的完美解决方案](https://stackoverflow.com/questions/118884/how-to-force-the-browser-to-reload-cached-css-js-files/118886#118886)！

我将其扩展为将其用作 Zend_view_Helper。因为我的客户在虚拟主机上运行他的页面，所以我也为此扩展了它。

```
/**
 * Extend filepath with timestamp to force browser to
 * automatically refresh them if they are updated
 *
 * This is based on Kip's version, but now
 * also works on virtual hosts
 * @link http://stackoverflow.com/questions/118884/what-is-an-elegant-way-to-force-browsers-to-reload-cached-css-js-files
 *
 * Usage:
 * - extend your .htaccess file with
 * # Route for My_View_Helper_AutoRefreshRewriter
 * # which extends files with there timestamp so if these
 * # are updated a automatic refresh should occur
 * # RewriteRule ^(.*)\.[^.][\d]+\.(css|js)$ $1.$2 [L]
 * - then use it in your view script like
 * $this->headLink()->appendStylesheet( $this->autoRefreshRewriter($this->cssPath . 'default.css'));
 *
 */
class My_View_Helper_AutoRefreshRewriter extends Zend_View_Helper_Abstract {

    public function autoRefreshRewriter($filePath) {

        if (strpos($filePath, '/') !== 0) {

            // Path has no leading '/'
            return $filePath;
        } elseif (file_exists($_SERVER['DOCUMENT_ROOT'] . $filePath)) {

            // File exists under normal path
            // so build path based on this
            $mtime = filemtime($_SERVER['DOCUMENT_ROOT'] . $filePath);
            return preg_replace('{\\.([^./]+)$}', ".$mtime.\$1", $filePath);
        } else {

            // Fetch directory of index.php file (file from all others are included)
            // and get only the directory
            $indexFilePath = dirname(current(get_included_files()));

            // Check if file exist relativ to index file
            if (file_exists($indexFilePath . $filePath)) {

                // Get timestamp based on this relativ path
                $mtime = filemtime($indexFilePath . $filePath);

                // Write generated timestamp to path
                // but use old path not the relativ one
                return preg_replace('{\\.([^./]+)$}', ".$mtime.\$1", $filePath);
            } else {
                return $filePath;
            }
        }
    }
} 
```

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2016-05-31T06:43:06.170

我还没有找到动态创建脚本节点（或 CSS）元素的客户端 DOM 方法：

```
<script>
    var node = document.createElement("script");
    node.type = "text/javascript";
    node.src = 'test.js?' + Math.floor(Math.random()*999999999);
    document.getElementsByTagName("head")[0].appendChild(node);
</script> 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2008-09-24T08:51:32.210

假设您有一个可用的文件：

```
/styles/screen.css 
```

您可以将带有版本信息的查询参数附加到 URI 上，例如：

```
/styles/screen.css?v=1234 
```

或者您可以预先添加版本信息，例如：

```
/v/1234/styles/screen.css 
```

恕我直言，第二种方法更适合 CSS 文件，因为它们可以使用相对 URL 来引用图像，这意味着如果您指定`background-image`这样的：

```
body {
    background-image: url('images/happy.gif');
} 
```

它的 URL 实际上是：

```
/v/1234/styles/images/happy.gif 
```

这意味着如果您更新使用的版本号，服务器会将其视为新资源而不使用缓存版本。如果您的版本号基于[Subversion](https://en.wikipedia.org/wiki/Apache_Subversion)、[CVS](https://en.wikipedia.org/wiki/Concurrent_Versions_System)等修订，这意味着 CSS 文件中引用的图像的更改将被注意到。第一个方案不能保证这一点，即`images/happy.gif`相对于`/styles/screen.css?v=1235`的URL`/styles/images/happy.gif`不包含任何版本信息。

我已经通过 Java servlet 使用这种技术实现了一个缓存解决方案，并使用`/v/*`委托给底层资源（即`/styles/screen.css`）的 servlet 简单地处理请求。`DefaultServlet`在开发模式下，我设置了缓存标头，告诉客户端始终使用服务器检查资源的新鲜度（如果您委托给 Tomcat和`.css`,这通常会导致 304`.js`等文件没有更改， ），而在部署模式下我设置了“永远缓存”的标题。

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2017-10-27T10:16:25.863

Google Chrome 具有**硬重新加载**以及**空缓存和硬重新加载**选项。您可以单击并按住重新加载按钮（在*Inspect Mode*中）以选择一个。

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2008-09-23T13:54:40.803

我最近使用 Python 解决了这个问题。这是代码（应该很容易被其他语言采用）：

```
def import_tag(pattern, name, **kw):
    if name[0] == "/":
        name = name[1:]
    # Additional HTML attributes
    attrs = ' '.join(['%s="%s"' % item for item in kw.items()])
    try:
        # Get the files modification time
        mtime = os.stat(os.path.join('/documentroot', name)).st_mtime
        include = "%s?%d" % (name, mtime)
        # This is the same as sprintf(pattern, attrs, include) in other
        # languages
        return pattern % (attrs, include)
    except:
        # In case of error return the include without the added query
        # parameter.
        return pattern % (attrs, name)

def script(name, **kw):
    return import_tag('<script %s src="/%s"></script>', name, **kw)

def stylesheet(name, **kw):
    return import_tag('<link rel="stylesheet" type="text/css" %s href="/%s">', name, **kw) 
```

此代码基本上将文件时间戳作为查询参数附加到 URL。以下函数的调用

```
script("/main.css") 
```

将导致

```
<link rel="stylesheet" type="text/css"  href="/main.css?1221842734"> 
```

好处当然是您不必再更改您的 HTML 内容，触摸 CSS 文件会自动触发缓存失效。它工作得很好，开销并不明显。

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2008-09-23T03:23:48.480

如果将会话 ID 添加为 JavaScript/CSS 文件的虚假参数，则可以强制执行“会话范围的缓存”：

```
<link rel="stylesheet" src="myStyles.css?ABCDEF12345sessionID" />
<script language="javascript" src="myCode.js?ABCDEF12345sessionID"></script> 
```

如果你想要一个版本范围的缓存，你可以添加一些代码来打印文件日期或类似的。如果您使用的是 Java，则可以使用自定义标签以优雅的方式生成链接。

```
<link rel="stylesheet" src="myStyles.css?20080922_1020" />
<script language="javascript" src="myCode.js?20080922_1120"></script> 
```

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2013-07-04T10:01:51.350

您可以简单地使用 CSS 和 JavaScript URL 添加一些随机数，例如

```
example.css?randomNo = Math.random() 
```

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2013-08-03T13:28:49.630

对于 ASP.NET，我提出了以下具有高级选项（调试/发布模式、版本）的解决方案：

以这种方式包含 JavaScript 或 CSS 文件：

```
<script type="text/javascript" src="Scripts/exampleScript<%=Global.JsPostfix%>" />
<link rel="stylesheet" type="text/css" href="Css/exampleCss<%=Global.CssPostfix%>" /> 
```

*Global.JsPostfix*和*Global.CssPostfix在**Global.asax*中通过以下方式计算：

```
protected void Application_Start(object sender, EventArgs e)
{
    ...
    string jsVersion = ConfigurationManager.AppSettings["JsVersion"];
    bool updateEveryAppStart = Convert.ToBoolean(ConfigurationManager.AppSettings["UpdateJsEveryAppStart"]);
    int buildNumber = System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.Revision;
    JsPostfix = "";
#if !DEBUG
    JsPostfix += ".min";
#endif
    JsPostfix += ".js?" + jsVersion + "_" + buildNumber;
    if (updateEveryAppStart)
    {
        Random rand = new Random();
        JsPosfix += "_" + rand.Next();
    }
    ...
} 
```

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2019-06-17T18:11:06.297

对于开发：使用浏览器设置：例如，`Chrome` `network tab`有一个`disable cache`选项。

对于生产：使用服务器端呈现框架或纯 JavaScript 代码将唯一的查询参数附加到请求（*例如*， ）。`q?Date.now()`

```
// Pure JavaScript unique query parameter generation
//
//=== myfile.js

function hello() { console.log('hello') };

//=== end of file

<script type="text/javascript">
    document.write('<script type="text/javascript" src="myfile.js?q=' + Date.now() + '">
    // document.write is considered bad practice!
    // We can't use hello() yet
</script>')

<script type="text/javascript">
    hello();
</script> 
```

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2016-12-23T16:25:21.033

如果您使用的是[Git](https://en.wikipedia.org/wiki/Git)和 PHP，则可以在每次 Git 存储库发生更改时从缓存中重新加载脚本，使用以下代码：

```
exec('git rev-parse --verify HEAD 2> /dev/null', $gitLog);
echo '  <script src="/path/to/script.js"?v='.$gitLog[0].'></script>'.PHP_EOL; 
```

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2017-09-12T06:40:52.297

只需将此代码添加到您想要进行硬重新加载的位置（强制浏览器重新加载缓存的 CSS 和 JavaScript 文件）：

```
$(window).load(function() {
    location.reload(true);
}); 
```

在 内部执行此`.load`操作，因此它不会像循环一样刷新。

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2018-07-31T06:06:16.600

只需使用服务器端代码添加文件的日期......这样它将*被*缓存并且仅在文件更改时重新加载。

在 ASP.NET 中：

```
<link rel="stylesheet" href="~/css/custom.css?d=@(System.Text.RegularExpressions.Regex.Replace(File.GetLastWriteTime(Server.MapPath("~/css/custom.css")).ToString(),"[^0-9]", ""))" />

<script type="text/javascript" src="~/js/custom.js?d=@(System.Text.RegularExpressions.Regex.Replace(File.GetLastWriteTime(Server.MapPath("~/js/custom.js")).ToString(),"[^0-9]", ""))"></script> 
```

这可以简化为：

```
<script src="<%= Page.ResolveClientUrlUnique("~/js/custom.js") %>" type="text/javascript"></script> 
```

通过在项目中添加扩展方法来扩展*Page*：

```
public static class Extension_Methods
{
    public static string ResolveClientUrlUnique(this System.Web.UI.Page oPg, string sRelPath)
    {
        string sFilePath = oPg.Server.MapPath(sRelPath);
        string sLastDate = System.IO.File.GetLastWriteTime(sFilePath).ToString();
        string sDateHashed = System.Text.RegularExpressions.Regex.Replace(sLastDate, "[^0-9]", "");

        return oPg.ResolveClientUrl(sRelPath) + "?d=" + sDateHashed;
    }
} 
```

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2019-10-31T09:45:27.980

对于在开发和测试时遇到此问题的开发人员：

暂时删除缓存。

`"keep caching consistent with the file"`..太麻烦了..

一般来说，我不介意加载更多——甚至再次加载没有改变的文件——在大多数项目中——实际上是无关紧要的。在开发应用程序时——我们主要是从磁盘加载`localhost:port` ——所以这个`increase in network traffic`问题**不是一个破坏交易的问题**。

大多数小项目只是在玩——它们永远不会最终投入生产。所以对他们来说，你不需要更多...

因此，如果您使用**Chrome DevTools**，您可以按照下图所示的禁用缓存方法进行操作：

[![如何强制chrome重新加载缓存文件](https://i.stack.imgur.com/fzd7C.png)](https://i.stack.imgur.com/fzd7C.png)

如果您有**Firefox**缓存问题：

[![如何在 Firefox 上强制重新加载资源](https://i.stack.imgur.com/O8hno.png)](https://i.stack.imgur.com/O8hno.png)

[![如何在开发时禁用 Firefox 中的缓存](https://i.stack.imgur.com/dFHrK.png)](https://i.stack.imgur.com/dFHrK.png)

仅在开发中执行此操作。您还需要一种强制重新加载生产的机制，因为如果您经常更新应用程序并且您没有提供像上面答案中描述的那样的专用缓存同步机制，您的用户将使用旧的缓存无效模块。

是的，这些信息已经在以前的答案中，但我仍然需要进行谷歌搜索才能找到它。

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2016-07-07T16:50:33.593

似乎这里的所有答案都暗示了命名方案中的某种版本控制，这有其缺点。

浏览器应该通过读取 Web 服务器的响应，特别是 HTTP 标头，清楚地知道什么要缓存，什么不应该缓存——这个资源的有效期是多久？自从我上次检索后，此资源是否已更新？等等

如果配置“正确”，只需更新应用程序的文件就应该（在某些时候）刷新浏览器的缓存。例如，您可以将 Web 服务器配置为告诉浏览器永远不要缓存文件（这是一个坏主意）。

关于其工作原理的更深入的解释是*[Web 缓存的工作原理](https://www.mnot.net/cache_docs/#WORK)*。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2019-05-15T03:02:34.213

您可以使用[SRI](https://en.wikipedia.org/wiki/Subresource_Integrity)来破坏浏览器缓存。您只需每次都使用新的 SRI 哈希更新您的*index.html文件。*当浏览器加载 HTML 并发现 HTML 页面上的 SRI 哈希与资源的缓存版本不匹配时，它将从您的服务器重新加载您的资源。它还具有绕过跨域读取阻塞的良好副作用。

```
<script src="https://jessietessie.github.io/google-translate-token-generator/google_translate_token_generator.js" integrity="sha384-muTMBCWlaLhgTXLmflAEQVaaGwxYe1DYIf2fGdRkaAQeb4Usma/kqRWFWErr2BSi" crossorigin="anonymous"></script> 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2011-06-22T12:46:04.343

我将文件内容的 MD5 哈希值放在其 URL 中。这样我可以设置一个很长的过期日期，而不必担心用户有旧的 JS 或 CSS。

我还在运行时（或在文件系统更改时）为每个文件计算一次，因此在设计时或构建过程中没有什么可笑的。

如果您使用的是 ASP.NET MVC，那么您可以[在此处查看我的其他答案中](https://stackoverflow.com/questions/936626/how-can-i-force-a-hard-refresh-ctrlf5/6439351#6439351)的代码。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2013-06-11T12:16:51.897

对于[Java Servlet](https://en.wikipedia.org/wiki/Jakarta_Servlet)环境，您可以查看[Jawr 库](https://jawr.java.net/)。功能页面解释了它如何处理缓存：

> Jawr 将尽最大努力强制您的客户端缓存资源。如果浏览器询问文件是否已更改，则会返回一个没有内容的 304（未修改）标头。另一方面，使用 Jawr，您将 100% 确保您的捆绑包的新版本已被所有客户端下载。您的资源的每个 URL 都将包含一个自动生成的基于内容的前缀，该前缀会在资源更新时自动更改。部署新版本后，捆绑包的 URL 也会更改，因此客户端不可能使用较旧的缓存版本。

该库还执行 JavaScript 和 CSS 缩小，但如果您不想要，可以将其关闭。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2012-07-06T02:50:39.193

[TomA 的回答](https://stackoverflow.com/users/35440/toma)是对的。

[使用“querystring”方法将不会被缓存，正如下面Steve Souders](http://www.stevesouders.com/blog/2008/08/23/revving-filenames-dont-use-querystring/)所引用的那样：

> ... Squid 是一种流行的代理，它不会使用查询字符串缓存资源。

[TomA 建议](https://stackoverflow.com/users/35440/toma)使用 style.TIMESTAMP.css 很好，但是 MD5 会好很多，因为只有当内容真正改变时，MD5 也会改变。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2008-09-24T11:38:17.847

我建议实施以下过程：

*   每次部署时对 CSS 和 JavaScript 文件进行版本控制。类似：screen.1233.css（如果您使用版本控制系统，该数字可以是您的 SVN 修订版）

*   缩小它们以优化加载时间

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2013-01-17T16:05:50.527

我发现在资源 URL 中使用基于时间戳或哈希的区分符的方法存在问题，该区分符会根据服务器的请求被剥离。包含指向例如样式表的链接的页面也*可能会被缓存*。因此，缓存页面可能会请求旧版本的样式表，但它将提供最新版本，这可能会或可能不会与请求页面一起使用。

要解决此问题，您必须使用标头或元数据来保护请求页面`no-cache`，以确保它在每次加载时都会刷新。或者您必须维护您曾经部署在服务器上的样式文件的*所有版本*，每个版本都作为一个单独的文件，并且它们的差异化因素保持不变，以便请求页面可以获取其设计的样式文件版本。在后一种情况下，您基本上将 HTML 页面和样式表的版本捆绑在一起，这可以静态完成，不需要任何服务器逻辑。

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2014-09-16T15:09:15.363

如果您使用的是现代浏览器，则可以使用清单文件来通知浏览器需要更新哪些文件。这不需要标题，URL 中没有版本等。

有关更多详细信息，请参阅： *[使用应用程序缓存](https://developer.mozilla.org/nl/docs/Web/HTML/Applicatie_cache_gebruiken#Introduction)*

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2015-07-20T20:05:11.050

[SilverStripe](http://www.silverstripe.org)特定的答案通过阅读得出：[http](http://api.silverstripe.org/3.0/source-class-SS_Datetime.html#98-110) ://api.silverstripe.org/3.0/source-class-SS_Datetime.html#98-110 ：

希望这将有助于使用 SilverStripe 模板并尝试在每次页面访问/刷新时强制重新加载缓存图像的人。在我的情况下，它是一个 GIF 动画，它只播放一次，因此在缓存后没有重播。在我的模板中，我只是添加了：

```
?$Now.Format(dmYHis) 
```

到文件路径的末尾以创建唯一的时间戳并强制浏览器将其视为新文件。

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2018-02-11T02:25:30.003

仅针对纯 JavaScript 中**的本地开发**禁用*script.js缓存。*

 **它注入一个随机*script.js?wizardry=1231234*并阻止常规*script.js*：

```
<script type="text/javascript">
  if(document.location.href.indexOf('localhost') !== -1) {
    const scr = document.createElement('script');
    document.setAttribute('type', 'text/javascript');
    document.setAttribute('src', 'scripts.js' + '?wizardry=' + Math.random());
    document.head.appendChild(scr);
    document.write('<script type="application/x-suppress">'); // prevent next script(from other SO answer)
  }
</script>

<script type="text/javascript" src="scripts.js"> 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2013-03-29T13:51:04.680

> “SCdF 提出的另一个想法是将伪造的查询字符串附加到文件中。（一些 Python 代码自动使用时间戳作为伪造的查询字符串是由 pi 提交的。）但是，关于是否或不是浏览器会缓存带有查询字符串的文件。（请记住，我们希望浏览器缓存文件并在以后的访问中使用它。我们只希望它在文件更改时再次获取文件。）因为不清楚虚假查询字符串会发生什么，我不接受这个答案。”

```
<link rel="stylesheet" href="file.css?<?=hash_hmac('sha1', session_id(), md5_file("file.css")); ?>" /> 
```

散列文件意味着当它发生变化时，查询字符串也会发生变化。如果没有，它将保持不变。每个会话也强制重新加载。

或者，您还可以使用重写使浏览器认为它是一个新的[URI](https://en.wikipedia.org/wiki/Uniform_Resource_Identifier)。

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2014-08-12T13:19:18.070

对 ASP.NET 网站的另一个建议，

1.  为不同的静态文件设置不同`cache-control:max-age`的值。

2.  对于 CSS 和 JavaScript 文件，在服务器上修改这些文件的机会很高，因此请将最小的*cache-control:max-age*值设置为 1 或 2 分钟或满足您的需要。

3.  对于图像，将远日期设置为*cache-control:max-age*值，例如 360 天。

4.  通过这样做，当我们发出第一个请求时，所有静态内容都会下载到客户端机器，并返回*200-OK*响应。

5.  在随后的请求和两分钟后，我们看到对 CSS 和 JavaScript 文件*的 304-Not Modified*请求，这使我们避免了 CSS 和 JavaScript 版本控制。

6.  图像文件将不会被请求，因为它们将从缓存内存中使用，直到缓存过期。

7.  通过使用以下*web.config*配置，我们可以实现上述行为，

    ```
    <system.webServer>
        <modules runAllManagedModulesForAllRequests="true"/>
        <staticContent>
            <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="00.00:01:00"/>
        </staticContent>
        <httpProtocol>
            <customHeaders>
                <add name="ETAG" value=""/>
            </customHeaders>
        </httpProtocol>
    </system.webServer>

    <location path="Images">
        <system.webServer>
            <staticContent>
                <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="180.00:00:00" />
            </staticContent>
        </system.webServer>
    </location> 
    ```

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2014-12-12T19:54:04.643

这里的许多答案都提倡在 URL 中添加时间戳。除非您直接修改生产文件，否则文件的时间戳不太可能反映文件更改的时间。在大多数情况下，这将导致 URL 比文件本身更频繁地更改。这就是为什么您应该使用文件内容的快速散列，如[levik 和其他](https://stackoverflow.com/questions/118884/how-to-force-the-browser-to-reload-cached-css-and-javascript-files/120960#120960)人建议的[MD5 。](https://en.wikipedia.org/wiki/MD5)

请记住，该值应在构建或运行时计算一次，而不是每次请求文件时计算。

例如，下面是一个简单的 bash 脚本，它从[标准输入](https://en.wikipedia.org/wiki/Standard_streams#Standard_input_(stdin))读取文件名列表并将包含散列的 JSON 文件写入标准输出：

```
#!/bin/bash
# Create a JSON map from filenames to MD5 hashes
# Run as hashes.sh < inputfile.list > outputfile.json

echo "{"
delim=""
while read l; do
    echo "$delim\"$l\": \"`md5 -q $l`\""
    delim=","
done
echo "}" 
```

然后可以在服务器启动时加载并引用此文件，而不是读取文件系统。

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2016-05-12T08:20:43.190

我在为我的 SPA 寻找解决方案时遇到了这个问题，它只有一个*index.html*文件，列出了所有必要的文件。虽然我得到了一些帮助我的线索，但我找不到快速简便的解决方案。

最后，我编写了一个快速页面（包括所有代码） ，作为发布过程的一部分，它可以自动转换 HTML/JavaScript *index.html文件。*它运行良好，仅根据上次修改日期更新新文件。

*[您可以在Autoversion your SPA index.html](http://blueskycont.com/wp/2016/05/12/autoversion-your-spa-index-html/)*中查看我的帖子。那里也有一个独立的 Windows 应用程序。

代码的核心是：

```
private void ParseIndex(string inFile, string addPath, string outFile)
{
    string path = Path.GetDirectoryName(inFile);
    HtmlAgilityPack.HtmlDocument document = new HtmlAgilityPack.HtmlDocument();
    document.Load(inFile);

    foreach (HtmlNode link in document.DocumentNode.Descendants("script"))
    {
        if (link.Attributes["src"]!=null)
        {
            resetQueryString(path, addPath, link, "src");
        }
    }

    foreach (HtmlNode link in document.DocumentNode.Descendants("link"))
    {
        if (link.Attributes["href"] != null && link.Attributes["type"] != null)
        {
            if (link.Attributes["type"].Value == "text/css" || link.Attributes["type"].Value == "text/html")
            {
                resetQueryString(path, addPath, link, "href");
            }
        }
    }

    document.Save(outFile);
    MessageBox.Show("Your file has been processed.", "Autoversion complete");
}

private void resetQueryString(string path, string addPath, HtmlNode link, string attrType)
{
    string currFileName = link.Attributes[attrType].Value;

    string uripath = currFileName;
    if (currFileName.Contains('?'))
        uripath = currFileName.Substring(0, currFileName.IndexOf('?'));
    string baseFile = Path.Combine(path, uripath);
    if (!File.Exists(baseFile))
        baseFile = Path.Combine(addPath, uripath);
    if (!File.Exists(baseFile))
        return;
    DateTime lastModified = System.IO.File.GetLastWriteTime(baseFile);
    link.Attributes[attrType].Value = uripath + "?v=" + lastModified.ToString("yyyyMMddhhmm");
} 
```

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2018-10-05T18:12:08.487

我所知道的最好和最快的方法之一是更改您拥有 CSS 或 JavaScript 文件的文件夹的名称。

或者对于开发人员：更改 CSS 和 JavaScript 文件的名称，例如版本。

```
<link rel="stylesheet" href="cssfolder/somecssfile-ver-1.css"/> 
```

对您的 JavaScript 文件执行相同的操作。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2020-03-17T13:45:14.193

静态文件的简单解决方案（仅用于开发目的），使用脚本标记注入向脚本 URI 添加随机版本号

```
<script>
    var script = document.createElement('script');
    script.src = "js/app.js?v=" + Math.random();
    document.getElementsByTagName('head')[0].appendChild(script);
</script> 
```

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2020-09-17T05:55:17.713

在 ASP.NET Core 中，您可以通过添加“asp-append-version”来实现：

```
<link rel="stylesheet" href="~/css/xxx.css" asp-append-version="true" />

 <script src="~/js/xxx.js" asp-append-version="true"></script> 
```

它将生成 HTML：

```
<link rel="stylesheet" href="/css/xxx.css?v=rwgRWCjxemznsx7wgNx5PbMO1EictA4Dd0SjiW0S90g" /> 
```

每次更新文件时，框架都会生成一个新的版本号。

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2018-09-07T20:14:01.827

现有答案的小改进......

使用随机数或会话 ID 会导致它在每个请求上重新加载。理想情况下，只有在任何 JavaScript 或 CSS 文件中进行了一些代码更改时，我们才可能需要进行更改。

当使用一个通用 JSP 文件作为许多其他[JSP](https://en.wikipedia.org/wiki/JavaServer_Pages)和 JavaScript 文件的模板时，将以下内容添加到一个通用 JSP 文件中

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<c:set var = "version" scope = "application" value = "1.0.0" /> 
```

现在在您的 JavaScript 文件包含的所有位置使用上述变量，如下所示。

```
<script src='<spring:url value="/js/myChangedFile.js?version=${version}"/>'></script> 
```

**优点：**

> 1.  这种方法将帮助您仅在一个位置更改版本号。

> 2.  维护正确的版本号（通常是构建/发布号）将帮助您检查/验证您的代码更改是否正确部署（来自浏览器的开发人员控制台）。

**另一个有用的提示：**

如果您使用的是 Chrome 浏览器，您可以在*开发工具*打开时禁用缓存。在 Chrome 中，点击`F12`→`F1`并滚动到*设置*→*首选项*→*网络*→ *禁用缓存（[DevTools](https://developers.google.com/web/tools/chrome-devtools/)打开时）

[![Chrome 开发者工具](https://i.stack.imgur.com/S3Ojy.png)](https://i.stack.imgur.com/S3Ojy.png)

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2008-09-25T01:40:46.137

我的方法是简单地将链接元素放入服务器端，包括：

```
<!--#include virtual="/includes/css-element.txt"--> 
```

css-element.txt 的内容在哪里

```
<link rel="stylesheet" href="mycss.css"/> 
```

因此，在您想链接到 my-new-css.css 或其他任何内容的那一天，您只需更改包含。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2020-03-31T20:51:00.807

这是我的基于 Bash 脚本的缓存清除解决方案：

1.  我假设您的*index.html*文件中引用了 CSS 和 JavaScript文件
2.  *在index.html*中添加时间戳作为 .js 和 .css 的参数，如下所示（仅限一次）
3.  使用上述时间戳创建一个*timestamp.txt文件。*
4.  对 .css 或 .js 文件进行任何更新后，只需运行以下 .sh 脚本

带有时间戳的 .js 和 .css 的示例*index.html条目：*

```
<link rel="stylesheet" href="bla_bla.css?v=my_timestamp">
<script src="scripts/bla_bla.js?v=my_timestamp"></script> 
```

文件*timestamp.txt*应该只包含相同的时间戳'my_timestamp'（稍后将被脚本搜索并替换）

最后是脚本（我们称之为 cache_buster.sh :D）

```
old_timestamp=$(cat timestamp.txt)
current_timestamp=$(date +%s)
sed -i -e "s/$old_timestamp/$current_timestamp/g" index.html
echo "$current_timestamp" >timestamp.txt 
```

（Visual Studio Code 用户）您可以将此脚本放在一个挂钩中，以便每次将文件保存在您的工作区中时都会调用它。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2016-08-21T02:59:01.733

好吧，我已经通过在每次页面加载时通过向 JavaScript 文件版本添加随机数来更改 JavaScript 文件版本来实现它，如下所示：

```
// Add it to the top of the page
<?php
    srand();
    $random_number = rand();
?> 
```

然后将随机数应用于 JavaScript 版本，如下所示：

```
<script src="file.js?version=<?php echo $random_number;?>"></script> 
```

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2021-10-18T16:24:03.713

如果您不希望客户端缓存文件，此解决方案似乎是最快实施的。`time()`如果您在 footer.php 中加载文件，请调整该部分：

```
<script src="<?php echo get_template_directory_uri(); ?>/js/main.js?v=<?= time() ?>"></script> 
```

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2020-02-21T10:54:29.733

我们有一种解决方案，采用不同的实施方式。我们使用上述解决方案。

```
datatables?v=1 
```

我们可以处理文件的版本。这意味着每次我们更改文件时，也要更改它的版本。但这不是一个合适的方式。

另一种方法是使用[GUID](https://en.wikipedia.org/wiki/Globally_unique_identifier)。它也不适合，因为每次它获取文件并且不从浏览器缓存中使用。

```
datatables?v=Guid.NewGuid() 
```

最后一种最好的方法是：

发生文件更改时，也要更改版本。检查以下代码：

```
<script src="~/scripts/main.js?v=@File.GetLastWriteTime(Server.MapPath("/scripts/main.js")).ToString("yyyyMMddHHmmss")"></script> 
```

这样，当您更改文件时，LastWriteTime 也会更改，因此文件的版本会更改，并且在接下来打开浏览器时，它会检测到新文件并获取它。

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2020-07-27T15:01:38.347

我已经通过使用 [ETag](https://en.wikipedia.org/wiki/HTTP_ETag)解决了这个问题：

> ETag 或实体标签是万维网协议 HTTP 的一部分。它是 HTTP 为 Web 缓存验证提供的多种机制之一，它允许客户端发出条件请求。这允许缓存更有效并节省带宽，因为如果内容没有更改，Web 服务器不需要发送完整的响应。ETags 也可用于乐观并发控制，[1](https://en.wikipedia.org/wiki/HTTP_ETag)作为一种帮助防止资源的同时更新相互覆盖的方法。

*   我正在运行一个单页应用程序（用 Vue.JS 编写）。
*   应用程序的输出由 npm 构建，并存储在 dist 文件夹中（重要文件为：dist/static/js/app.my_rand.js）
*   Nginx 负责提供这个 dist 文件夹中的内容，它会根据修改时间和 dist 文件夹的内容生成一个新的 Etag 值，这是某种指纹。因此，当资源发生变化时，会生成一个新的 Etag 值。
*   当浏览器请求资源时，请求标头和存储的 Etag 之间的比较可以确定资源的两种表示是否相同，并且可以从缓存中提供服务，或者需要提供具有新 Etag 的新响应。

* * *

## 回答 #53

> 赞同：-1
> 
> 时间：2008-09-24T20:06:02.527

如果您使用的是[jQuery](https://en.wikipedia.org/wiki/JQuery)，则有一个名为 cache 的选项会附加一个随机数。

我知道这不是一个完整的答案，但它可能会为您节省一些时间。

* * *

## 回答 #54

> 赞同：-2
> 
> 时间：2014-02-06T21:43:23.157

JavaScript 文件的另一种方法是将 jQuery`$.getScript`与`$.ajaxSetup`option结合使用`cache: false`。

代替：

```
<script src="scripts/app.js"></script> 
```

您可以使用：

```
$.ajaxSetup({
  cache: false
});

$.getScript('scripts/app.js'); // GET scripts/app.js?_1391722802668 
```

* * *

## 回答 #55

> 赞同：-3
> 
> 时间：2008-09-23T05:54:51.393

更改文件名将起作用。但这通常不是最简单的解决方案。

正如您所注意到的，“no-cache”的 HTTP 缓存控制标头并不总是有效。HTTP 1.1 规范允许用户代理有回旋余地来决定是否请求新副本。（如果你只看指令的名称，这是不直观的。去阅读实际的[HTTP 1.1 缓存规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9)......它在上下文中更有意义。）

简而言之，如果您想要严格的缓存控制使用

```
Cache-Control: no-cache, no-store, must-revalidate 
```

在您的响应标题中。

* * *

## 回答 #56

> 赞同：-3
> 
> 时间：2011-11-03T17:34:42.217

最简单的方法是利用 PHP 文件读取功能。只需让 PHP 将文件内容回显到标签中即可。

```
<?php
//Replace the 'style.css' with the link to the stylesheet.
echo "<style type='text/css'>".file_get_contents('style.css')."</style>";
?> 
```

如果您使用 PHP 以外的其他工具，则根据语言会有一些变化，但几乎所有语言都有打印文件内容的方法。将它放在正确的位置（在该部分中），这样，您就不必依赖浏览器。

# html - 如何从典型的 html 日期/时间安排中提取数据？

> ID：118905
> 
> 赞同：0
> 
> 时间：2008-09-23T03:14:07.630
> 
> 标签：html, regex

我正在尝试编写一个解析器来从典型的 html 表格日期/时间安排中获取数据（像[这样](http://kut.org/about/schedule)）。

我想给这个解析器一个页面和一个表类/ID，并让它返回一个事件列表，以及它们发生的日期和时间。它应该考虑行跨度和列跨度，因此对于链接的示例，它将返回

```
{:event => "Music With Paul Ray", :times => [T 12:00am - 3:00am, F 12:00am - 3:00am]}, etc. 
```

我已经想出了一个使用 ruby​​ 的半执行的混乱方法，我想知道你如何解决这样的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T06:54:27.023

最好的办法是使用 HTML 解析器。使用 HTML 解析器，您可以以编程方式查看表格行，而无需求助于脆弱的正则表达式并自己进行解析。

然后你可以运行一些逻辑（这不是可运行的代码，只是一个你应该能够从中看到想法的草图）：

```
for row in table:
    i = 0
    for cell in row: # skipping row 1
        event = name
        starttime = row[0]
        endtime = table[ i + cell.rowspan + 1 ][0]

        print event, starttime, endtime
    i += 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T03:57:58.897

这是程序需要做的：

1.  读取标签（检测属性和打开/关闭标签）
2.  构建表格的内部表示（您将如何处理格式错误的表格？）
3.  计算每个事件的日期、开始时间和结束时间
4.  将重复的事件合并到一个事件系列中

那是很多组件！您可能需要问一个更具体的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T16:15:11.383

如前所述，在 HTML 上使用正则表达式通常不是一个好主意，您应该使用一个好的解析器。
为了验证 XHTML 页面，您可以使用在大多数语言中都可用的简单 XML 解析器。唉，在你的情况下，给定的页面没有验证（W3C 的标记验证服务报告 230 个错误，7 个警告！）
对于通用的，可能格式错误的 HTML，有一些库可以处理它（kigurai 推荐 Python 的 BeautifulSoup，我也知道 TagSoup for Java，还有其他的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T07:06:11.690

使用[http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/)并且该任务应该是轻而易举的。

# ajax - 保护 AJAX 应用程序的最佳方式

> ID：118910
> 
> 赞同：13
> 
> 时间：2008-09-23T03:16:16.410
> 
> 标签：ajax, security, ssl, cookies

我目前正在研究基于 AJAX 的站点的身份验证，并且想知道是否有人对此类事情的最佳实践有任何建议。

我最初的方法是基于 cookie 的系统。本质上，我设置了一个带有身份验证代码的 cookie，并且每次数据访问都会更改 cookie。同样，每当身份验证失败时，该用户的所有会话都将被取消身份验证，以防止劫持者进入。要劫持会话，必须有人让自己保持登录状态，并且黑客需要发送最后的 cookie 更新来欺骗会话。

不幸的是，由于 AJAX 的性质，当快速发出多个请求时，它们可能会乱序返回，设置错误的 cookie，并中断会话，所以我需要重新实现。

我的想法是：

*   一种明显不太安全的基于会话的方法
*   在整个站点上使用 SSL（似乎有点矫枉过正）
*   使用经过 ssl 身份验证的 iFrame 来进行安全交易（我只是假设这是可能的，有一点 jquery hacking）

问题不在于传输的数据，唯一的担忧是有人可能会控制不属于他们的帐户。

一种明显不太安全的基于会话的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T08:24:13.103

一个常见的解决方案是对用户的会话 ID 进行哈希处理，并将其与每个请求一起传递，以确保请求来自有效用户（请参阅[此幻灯片](http://simonwillison.net/2008/talks/amajax-security/)）。[从CSRF](http://en.wikipedia.org/wiki/Csrf)的角度来看，这是相当安全的，但如果有人在嗅探数据，它可能会被拦截。根据您的需要，ssl 始终是最安全的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T17:47:29.363

SSL 是必须的，可以防止多个用户使用的透明代理连接。然后，我只需将传入的 IP 地址与经过身份验证的 IP 地址一起检查即可。

重新认证：

*   一旦IP地址改变
*   在没有任何请求的情况下超过 n 秒的超时
*   单独处理任何重要交易

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T03:26:50.127

就个人而言，我没有发现对整个站点（或大部分站点）使用 SSL 是矫枉过正的。也许不久前，当速度和进给速度较慢时。现在我会毫不犹豫地将网站的任何部分置于 SSL 之下。

如果您决定对整个站点使用 SSL 是可以接受的，您可以考虑只使用旧的“基本身份验证”，其中服务器返回*401*响应，这会导致浏览器提示输入用户名/密码。如果您的应用程序可以使用这种类型的登录，则非常适合 AJAX 和对您网站的所有其他访问，因为浏览器使用适当的凭据处理重新提交请求（并且如果您使用 SSL 是安全的，但**前提**是您使用 SSL -- 不要将基本身份验证与普通 http 一起使用！）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T02:50:15.717

您可以尝试阅读 Billy Hoffman 和 Bryan Sullivan 所著的 Ajax Security 一书。我发现它改变了我对安全性的看法。Ajax 的每个阶段都有非常具体的建议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T03:20:52.140

如果您在来自服务器的每个响应上放置一个“生成的”时间戳，那么 AJAX 应用程序可以始终使用具有最新时间戳的 cookie。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T03:27:38.720

**您最好的选择是使用 SSL 连接，而不是先前经过身份验证的与 Apache 和/或 Tomcat 的连接。** 任何一种基于表单的身份验证，都需要 SSL 连接，从而为您提供安全的连接。然后，webapp 可以为会话提供安全性和身份，而客户端 Ajax 不需要关注安全性。

# logging - ETW - 混乱界面的最佳修复/类库？

> ID：118929
> 
> 赞同：2
> 
> 时间：2008-09-23T03:23:30.417
> 
> 标签：logging, etw

ETW 我的意思是“Windows 的事件跟踪”。

根据我的实验，一个优点是，虽然设计它偶尔无法在非常繁忙的条件下记录事件，否则它可以正常工作，正如您可能对内核功能所期望的那样。如果您希望每个处理器缓冲以避免缓存与多线程日志记录问题，ETW 是城里唯一的游戏，因为据我了解，“只有内核知道”您的线程在任何给定时刻真正运行的位置，特别是如果您不分配亲和力等。

然而，界面很混乱，如果你考虑微软推荐的相对于 EventWrite() 的方法，它会变得更糟。在简化程序员对这个强大的内核子系统的访问方面，最好的努力是什么？我对 C++ 接口感兴趣，但查看此问题的其他人也想了解其他语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T13:50:16.983

如果您正在 ETW 之上寻找易于使用的 C/C++ 包装器，那么唯一接近的就是 WPP。如果你太先进了，你可能会遇到 WPP 的限制。注意 10 月份的 Microsoft PDC 是否有帮助；）

# asp.net - ASP.NET MVC & Web Services

> ID：118931
> 
> 赞同：48
> 
> 时间：2008-09-23T03:24:20.413
> 
> 标签：asp.net, asp.net-mvc, wcf, web-services, architecture

Does adding a Web Service to my ASP.NET MVC project break the whole concept of MVC?

That Web Service (WCF) depends on the Model layer from my MVC project to communicate with the back-end (so it looks to me like it needs to be part of the MVC solution).

Should I add this to the Controller or Model layer?

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-23T14:23:09.083

It sounds like you should split out your model into its own assembly and reference it from your MVC-application and WCF-application.

*   YourApp.Data -- Shared model and data access maybe
*   YourApp.Web -- If you want to share more across your web-apps
*   YourApp.Web.Mvc
*   YourApp.Web.WebService

If you want to do WebServices MVC-style maybe you should use MVC to build your own REST-application.

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-23T03:36:21.523

Is there a specific reason you need to add web services to your MVC application? Unless there is a specific reason you should use your controllers in a RESTful manner just as you would a RESTful web service.

Check out this post from Rob Connery for more information: [ASP.Net MVC: Using RESTful architecture](http://blog.wekeroad.com/2007/12/06/aspnet-mvc-using-restful-architecture/)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-25T14:11:16.023

Separating the Model into it's own project is not breaking the "MVC" pattern. First off, it is just that -- a pattern. The intention of the MVC pattern is to clearly delineate between your data, the data handlers, and the presenters and the way you interface between them. The best way to do it is how Seb suggested:

*   YourApp.Data
*   YourApp.Web.Mvc
*   YourApp.Web.WebService

Something that might help you out is the MVC Storefront that Rob Conery put together. Go watch the video's here:

[MVC Storefront Video Series](http://www.asp.net/learn/mvc-videos/#MVCStorefrontStarterKit "MVC Storefront Video Series")

And if you want to look at the actual code in your browser to quickly see how he did it, go here: [MVC Storefront Codeplex Code Browser](http://www.codeplex.com/mvcsamples/SourceControl/changeset/view/17015)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T10:08:49.527

I don't think separating the model into it's own assembly has any bearing on whether or not you're using MVC, you still have a model. Where it is is irrelevant surely?

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-01T02:52:38.800

I've had a go at doing this.

See my result at [my blog](http://zacthetechie.blogspot.com/2009/10/mvc-with-web-services.html)

ps: I don't believe that this will break the MVC concept so long as you think that a web service is the model of a repository because all a web service does is returning a XML dump.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T05:09:25.777

I have added web services to my application and it works well. I don't believe it violates MVC because it is an alternative interface to your model. MVC is not appropriate for web services because web services don't have a view.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-22T15:10:10.683

Think of web services and databases as one in the same. Under this analogy, I think it makes sense to place your web service ingteractions where you place your database logic.

# linux - 知道 OCAML IDE 吗？

> ID：118935
> 
> 赞同：26
> 
> 时间：2008-09-23T03:24:59.837
> 
> 标签：linux, ide, ocaml, typerex

知道 OCAML/CAML IDE 吗？尤其是在 Linux 上运行的？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-23T03:33:49.020

Emacs 在[Caml 模式](http://www.cs.jhu.edu/~scott/pl/caml/emacs.html)，或[Tuareg 模式](https://who.rocq.inria.fr/Albert.Cohen/tuareg/index.html.en)，或[TypeRex 模式](http://www.typerex.org/)。TypeRex 在 emacs 中为 Taureg 添加了自动完成功能——对于喜欢图形化 IDE 的人来说，这是一个非常好的功能。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-23T03:41:43.367

有[茶花](http://camelia.sourceforge.net/)。您还可以[将 OCaml 集成到 Eclipse](http://mirror.ocamlcore.org/wiki.cocan.org/ocaml_and_eclipse.html)中。同样在 Emacs 中，您可以使用 ocaml-mode 和 tuareg-mode。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-10-25T18:26:03.020

我投票[给 OcaIDE](http://www.algo-prog.info/ocaide/)。现在它已经升级到 v1.2.5。它成为一个最新的 IDE（支持 ocaml 3.10-3.11，尤其是 ocamlbuild，它可以节省大量时间）并具有丰富、稳定的功能。

我已经在 eclipse 3.5(Galileo) 上安装了 OcaIDE，它运行良好。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-23T03:36:07.127

Emacs 有两种使用 OCaml 的模式： ocaml-mode 和[tuareg-mode](http://www-rocq.inria.fr/~acohen/tuareg/)。两者都可以通过 apt 或在网络上获得。

它们提供语法高亮，tuareg-mode 包括与 OCaml 顶层和调试器的接口。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-23T13:53:32.337

`vim`您还可以[加载](http://www.ocaml.info/vim/) 一些文件...查看和[上](http://www.vim.org/scripts/script.php?script_id=1197)的工具列表以获取更多工具。并确保使用on 进行编译，这样您就可以利用注释文件通过击键来确定类型。[`hump`](http://caml.inria.fr/cgi-bin/hump.en.cgi?sort=-1&browse=12)[`godi`](http://www.camlcity.org/)`-dtypes`

您还可以将 netbeans 用作带有[ocaml 插件](http://caml.inria.fr/cgi-bin/hump.cgi?contrib=705)的 ide 。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-12-06T00:03:10.260

如果那是您的事，实际上可以通过 DrScheme 使用 OCaml。

[http://coach.cs.uchicago.edu:8080/display.ss?package=drocaml.plt&owner=abromfie](http://coach.cs.uchicago.edu:8080/display.ss?package=drocaml.plt&owner=abromfie)

只需在 DrScheme 中运行 '(require (planet abromfie/drocaml:2:0/tool))' 即可选择 OCaml 语言。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-02-02T19:15:05.860

您可以尝试基于 NetBeans 的[OcamlIDE](http://ocamlplugin.loki-a.com)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-23T03:43:21.117

[http://ocaml.eclipse.ortsa.com:8480/ocaide/](http://ocaml.eclipse.ortsa.com:8480/ocaide/)

我刚刚为它找到了一个可能很有希望的 Eclipse 插件。看起来不太活跃。我会尝试并报告结果。

哎呀....emacs？vi中有什么？;)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-02-24T12:19:35.703

[**有关OCaml**](http://www.typerex.org/)的开发环境 TypeRex ，[请](https://stackoverflow.com/questions/7582388/looking-for-ocaml-ide/9414666#9414666)参阅我的帖子。[](http://www.typerex.org/)

 *** * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-08-29T10:03:15.647

如果您更喜欢在 eclipse 平台上工作，请查看 OCaml 的 eclipse 插件。例如，像这样一个： http: [//ocamldt.free.fr/](http://ocamldt.free.fr/)

除此之外，直接从诸如 emacs 或 vim 之类的普通编辑器开始对于编程来说已经足够了。此外，它还可以帮助您更好地了解语言的语法和编译过程。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-19T11:14:51.993

[您甚至可以使用ideone](http://ideone.com/YNQhz)在线编辑、编译和运行简单的 Ocaml 代码。还有适用于移动设备的应用程序，可让您使用智能手机进行编程/实验。

# c++ - 最佳 C/C++ 网络库

> ID：118945
> 
> 赞同：78
> 
> 时间：2008-09-23T03:27:26.413
> 
> 标签：c++, c, networking

我有一段时间没有在 C/C++ 方面做过工作，只是想知道人们最喜欢使用哪些跨平台库。

我正在寻找一个既快速又脏的库以及更健壮的库。通常这是两个不同的库，这没关系。

* * *

## 回答 #1

> 赞同：315
> 
> 时间：2008-09-23T03:35:59.373

图书馆汇总列表

*   [Boost.Asio](http://www.boost.org/doc/libs/release/doc/html/boost_asio.html)真的很好。
*   [Asio](http://think-async.com/Asio/)也可作为独立库使用。
*   [ACE](http://www.dre.vanderbilt.edu/%7Eschmidt/ACE.html)也不错，比较成熟，有几[本书](https://rads.stackoverflow.com/amzn/click/com/0201604647)[支持](https://rads.stackoverflow.com/amzn/click/com/0201795256)它。
*   [C++ 网络库](http://cpp-netlib.org/index.html)
*   [POCO](http://pocoproject.org/)
*   [Qt](http://www.qt.io/developers/)
*   [拉克网](http://www.jenkinssoftware.com/)
*   [零MQ](http://www.zeromq.org/) (C++)
*   [nanomsg](http://nanomsg.org/)（C 库）
*   [ng](https://github.com/nanomsg/nng)（C 库）
*   伯克利插座
*   [libevent](http://libevent.org/)
*   [阿帕奇 APR](http://apr.apache.org/)
*   [屈服](https://github.com/glycerine/yield)
*   Winsock2（仅限 Windows）
*   [wvstreams](http://code.google.com/p/wvstreams/)
*   [零点](https://zeroc.com/)
*   [库库尔](http://curl.haxx.se/libcurl/)
*   [libuv](https://github.com/libuv/libuv)（跨平台 C 库）
*   [SFML 的网络模块](http://www.sfml-dev.org/tutorials/2.3/#network-module)
*   [C++ Rest SDK (卡萨布兰卡)](https://github.com/microsoft/cpprestsdk)
*   [RCF](http://www.deltavsoft.com/doc/rcf_user_guide/Intro.html#rcf_user_guide.Intro.WhatIsRcf)
*   [Restbed（HTTP 异步框架）](https://github.com/corvusoft/restbed)
*   [SedNL](http://github.com/zenol/sednl)
*   [SDL_net](https://www.libsdl.org/projects/SDL_net/)
*   [OpenSplice|DDS](http://www.prismtech.com/vortex/vortex-opensplice)
*   [facil.io](http://facil.io)（C，可选 HTTP 和 Websockets，Linux / BSD / macOS）
*   [GLib 网络](https://developer.gnome.org/gio/stable/gio-gnetworking.h.html)
*   来自谷歌的[grpc](http://www.grpc.io/)
*   Valve 的[GameNetworkingSockets](https://github.com/ValveSoftware/GameNetworkingSockets)
*   [CYSockets](https://github.com/OmarAflak/Asynchronous-Socket-Class-C-Windows)用最简单的方式做简单的事情
*   [优吉博](https://github.com/networkprotocol/yojimbo)
*   [GGPO](https://github.com/pond3r/ggpo)
*   [网络](http://enet.bespin.org)
*   [SLikeNet](https://github.com/SLikeSoft/SLikeNet)是 Raknet 的一个分支
*   [网络代码](https://github.com/networkprotocol/netcode)
*   [photon](https://www.photonengine.com)是封闭源代码，需要许可证才能使用他们的 sdk
*   [crossplatform network](https://bitbucket.org/ptroen/crossplatformnetwork) - 基于 boost asio 的开源非阻塞元模板框架

# orm - 业务对象/数据库访问层的架构

> ID：118955
> 
> 赞同：7
> 
> 时间：2008-09-23T03:30:57.480
> 
> 标签：orm, architecture

由于各种原因，我们正在编写一个新的业务对象/数据存储库。该层的要求之一是将业务规则的逻辑与实际的数据存储层分开。

可以有多个数据存储层来实现对同一个对象的访问——例如，实现大多数对象的主“数据库”数据存储源，以及实现用户对象的另一个“ldap”源。在这种情况下，用户可以选择来自 LDAP 源，可能具有稍微不同的功能（例如，无法保存/更新用户对象），但应用程序以相同的方式使用它。另一种数据存储类型可能是 Web 服务或外部数据库。

我们正在考虑通过两种主要方式来实现这一点，我和一位同事在基本层面上存在分歧，这是正确的。我想就哪一个最好用一些建议。我会尽量保持对每一个的描述尽可能中立，因为我在这里寻找一些客观的观点。

*   业务对象是基类，数据存储对象继承业务对象。客户端代码处理数据存储对象。

    在这种情况下，每个数据存储对象都继承了通用的业务规则，而客户端代码直接使用的是数据存储对象。

    这意味着客户端代码确定对给定对象使用哪种数据存储方法，因为它必须显式声明该类型对象的实例。客户端代码需要明确知道它使用的每种数据存储类型的连接信息。

    如果数据存储层为给定对象实现不同的功能，客户端代码在编译时明确知道它，因为对象看起来不同。如果数据存储方式发生变化，客户端代码也必须更新。

*   业务对象封装了数据存储对象。

    在这种情况下，业务对象直接由客户端应用程序使用。客户端应用程序将基本连接信息传递给业务层。由业务对象代码决定给定对象使用哪种数据存储方法。连接信息将是从配置文件中获取的一大块数据（客户端应用程序并不真正了解/关心它的细节），它可能是数据库的单个连接字符串，也可能是各种数据存储类型的多个连接字符串。其他数据存储连接类型也可以从另一个位置读取 - 例如，数据库中的配置表指定各种 Web 服务的 URL。

    这样做的好处是，如果将新的数据存储方法添加到现有对象，则可以在运行时设置配置设置以确定使用哪种方法，并且对客户端应用程序完全透明。如果给定对象的数据存储方法发生更改，则无需修改客户端应用程序。

*   业务对象是基类，数据源对象继承自业务对象。客户端代码主要处理基类。

    这与第一种方法类似，但客户端代码声明了基本业务对象类型的变量，并且业务对象上的 Load()/Create()/etc 静态方法返回适当的数据源类型对象。

    此解决方案的架构与第一种方法类似，但主要区别在于为给定业务对象使用哪个数据存储对象由业务层而非客户端代码决定。

我知道已经有现有的 ORM 库提供了一些这样的功能，但现在请打折扣（数据存储层有可能是用这些 ORM 库之一实现的） - 另请注意，我故意不告诉你这里使用的是什么语言，除了它是强类型的。

我在这里寻找一些关于哪种方法更好使用（或随意提出其他建议）以及原因的一般建议。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T03:36:56.500

我是否可以建议另一种选择，可能更好地解耦：业务对象*使用*数据对象，而数据对象*实现*存储对象。这应该将业务规则保留在业务对象中，但不依赖于存储源或格式，同时允许数据对象支持所需的任何操作，包括动态更改存储对象（例如在线/离线操作）

这属于上面的第二类（业务对象封装了数据存储对象），但是将数据语义与存储机制分离得更清晰

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T03:50:27.013

你也可以有一个门面来阻止你的客户直接打电话给公司。它还为您的业务创建了共同的切入点。

如前所述，您的业务不应该暴露于您的 DTO 和 Facade 之外的任何东西。

是的。您的客户可以处理 DTO。这是通过应用程序传递数据的理想方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-22T00:03:05.003

我通常最喜欢“业务对象封装数据对象/存储”。但是，简而言之，您可能会发现您的数据对象和业务对象的高度冗余可能看起来不值得。如果您选择 ORM 作为数据访问层 (DAL) 的基础，则尤其如此。但是，从长远来看，真正的回报是：应用程序生命周期。如图所示，“数据”来自一个或多个存储子系统（不限于 RDBMS）的情况并不少见，尤其是随着云计算的出现，以及分布式系统中的常见情况。例如，您可能有一些来自 Restful 服务的数据、来自 RDBMS 的另一个块或对象、另一个来自 XML 文件、LDAP 等的数据。有了这个认识，这意味着很好地封装来自业务的数据访问的重要性。还要注意通过 c-tors 和属性公开 (DI) 的依赖项。

也就是说，我一直在玩弄的一种方法是将架构的“肉”放在业务控制器中。将现代数据访问更多地视为一种资源而不是传统思维，控制器然后接受 URI 或其他形式的元数据，这些元数据可用于了解它必须为业务对象管理哪些数据资源。然后，业务对象本身并不封装数据访问；而是控制器。这使您的业务对象保持轻量和具体，并允许您的控制器提供优化、可组合性、事务环境等。请注意，您的控制器将“托管”您的业务对象集合，就像许多 ORM 的控制器一样。

此外，还要考虑业务规则管理。如果你仔细观察你的 UML（或者像我一样在你脑海中的模型 :D），你会注意到你的业务规则模型实际上是另一个模型，有时甚至是持久的（例如，如果你使用的是业务规则引擎） . 我会考虑让业务控制器也实际控制您的规则子系统，并让您的业务对象通过控制器引用规则。原因是，不可避免地，规则实现通常需要执行查找和交叉检查，以确定有效性。通常，它可能需要混合业务对象查找以及后端数据库查找。考虑检测重复的实体，例如，只有“新”实体是水合的。让您的规则由您的​​业务控制器管理，

在伪代码中：

```
using(MyConcreteBusinessContext ctx = new MyConcreteBusinessContext("datares://model1?DataSource=myserver;Catalog=mydatabase;Trusted_Connection=True ruleres://someruleresource?type=StaticRules&handler=My.Org.Business.Model.RuleManager")) {

User user = ctx.GetUserById("SZE543");
user.IsLogonActive = false;
ctx.Save();
}

//a business object
class User : BusinessBase {
  public User(BusinessContext ctx) : base(ctx) {}

  public bool Validate() {
    IValidator v = ctx.GetValidator(this);
    return v.Validate();
  }
}

// a validator
class UserValidator : BaseValidator, IValidator {
 User userInstance;
 public UserValidator(User user) {
  userInstance = user;
 }

 public bool Validate() {
   // actual validation code here
   return true;
 }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T03:44:28.230

客户端不应该直接处理存储对象。它们可以直接处理 DTO，但任何具有任何存储逻辑但未包装在业务对象中的对象不应由客户端直接调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T03:58:31.657

查看 Rocky Lhotka 的 CSLA.net。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T05:09:38.337

里昂证券已经存在了很长时间。但是我喜欢 Eric Evans 书中讨论的方法 [http://dddcommunity.org/](http://dddcommunity.org/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T13:50:52.250

好吧，我在这里，同事格雷格提到。

Greg 非常准确地描述了我们一直在考虑的替代方案。我只是想在情况描述中添加一些额外的注意事项。

客户端代码可能不知道存储业务对象的数据存储，但在只有一个数据存储或同一业务对象类型有多个数据存储（用户存储在本地数据库和外部 LDAP 中）的情况下，这是可能的，但是客户端不创建这些业务对象。在系统分析方面，这意味着不应该存在相同类型的对象的两个数据存储的存在会影响用例流的用例。

一旦需要区分在不同数据存储中创建的对象，客户端组件就必须意识到其域中数据存储的多样性，并且它不可避免地要负责在对象创建时决定使用哪个数据存储（而且，我认为，从数据存储中加载对象）。业务层可以假装它正在做出这个决定，但决策的算法将基于来自客户端组件的信息的类型和内容，使客户端有效地对决策负责。

这种责任可以通过多种方式实现：它可以是每个数据存储的特​​定类型的连接对象；它可以是调用以创建新的 BO 实例等的隔离方法。

问候，

迈克尔

# workflow - 如果你是盲人，你怎么能编程？

> ID：118984
> 
> 赞同：685
> 
> 时间：2008-09-23T03:41:32.057
> 
> 标签：workflow, development-environment, accessibility, blind

视力是大多数程序员认为理所当然的感觉之一。大多数程序员会花几个小时看电脑显示器（尤其是在他们*处于区域的*时候），但我知道有些程序员是盲人（比如目前在谷歌工作的 TV Raman）。

如果您是一个盲人（或逐渐失明），您将如何设置开发环境来帮助您进行编程？

（请每个答案提出一个建议。这个问题的目的是将好的想法带到顶部。此外，屏幕阅读器可以更早地阅读好想法。）

* * *

## 回答 #1

> 赞同：1015
> 
> 时间：2008-09-29T14:22:00.757

我是一个完全失明的大学生，有过几次编程实习，所以我的答案将基于这些。我使用 windows xp 作为我的操作系统，并使用[Jaws](http://freedomscientific.com/products/fs/jaws-product-page.asp)以合成语音向我阅读屏幕上显示的内容。对于 java 编程，我使用 eclipse，因为它是一个可访问的功能齐全的 IDE。

根据我的经验，使用 SWT 作为 GUI 工具包的 java 程序比使用 Swing 的程序更容易访问，这就是我远离 netbeans 的原因。对于任何 .net 编程，我都使用 Visual Studio 2005，因为它是我实习时使用的标准版本，并且使用 Jaws 和一组脚本非常易于访问，这些脚本旨在使诸如表单设计器之类的东西更易于访问。

对于 C 和 C++ 编程，我使用 cygwin 和 gcc 作为我的编译器，并使用 emacs 或 vim 作为我的编辑器，这取决于我需要做什么。我的很多实习都涉及 Z/OS 编程。我通过 Cygwin 使用 rlogin 会话来访问大型机上的 USS 子系统，并使用 C3270 作为我的 3270 仿真器来访问大型机的 ISPF 部分。

我通常依靠合成语音，但确实有盲文显示器。我发现我通常在语音方面工作得更快，但在标点符号很重要且变得复杂的情况下使用盲文显示器。例如，带有大量嵌套括号的 if 语句和标点符号非常重要的 JCL。

## 更新

我在 cygwin [http://emacspeak.sourceforge.net](http://emacspeak.sourceforge.net)下玩 Emacspeak我不确定这是否可以用作编程编辑器，因为它似乎有点反应迟钝，但我没有看过任何配置选项然而。

* * *

## 回答 #2

> 赞同：400
> 
> 时间：2009-01-17T18:17:32.267

我是盲人，并且已经在 Windows、Mac、Linux 和 DOS 上编程了大约 13 年，使用的语言包括 C/C++、Python、Java、C# 和各种较小的语言。虽然最初的问题是关于配置环境的，但我认为最好通过看看盲人如何使用计算机来回答。

有些人使用谈话环境，例如其他答案中提到的 TV Raman 和 Emacspeak 环境。到目前为止，更常见的解决方案是让屏幕阅读器在后台运行，监控操作系统活动并通过合成语音或物理盲文显示器（通常一次显示 20 到 80 个字符）提醒用户。这意味着盲人可以使用任何可访问的应用程序。

因此，这些天我个人使用 Visual Studio 2008，并且只进行了很少的修改即可运行它。我关闭了某些功能，例如在我输入时显示错误，因为我发现这会分散注意力。在加入微软之前，我所有的开发都是在像记事本这样的标准文本编辑器中完成的，所以再一次没有定制。

可以配置屏幕阅读器来宣布缩进。我个人不使用这个，因为 Visual Studio 会处理这个，而 C# 使用大括号。但这在像 Python 这样空格很重要的语言中非常重要。最后，Emacspeak 确实使用不同的声音/音高来表示语法的不同部分（关键字、注释、标识符等）。

* * *

## 回答 #3

> 赞同：107
> 
> 时间：2011-03-28T15:23:05.150

我是盲人，过去 12 年左右一直是程序员。目前是一名高级架构师，在 Sapient Corporation（一家位于剑桥的咨询公司，创建基于 Web 和基于胖客户端的企业解决方案）工作。我使用了几个屏幕阅读器，但大多坚持使用 Jaws for windows 和 NVDA。

我主要在 Microsoft 平台和 Visual Studio 作为我的环境工作。我还使用 MS Sql 企业工作室等工具进行数据库访问、网络监控等。我尝试花一些时间在 emacspeak 上，但由于我的工作主要基于 MS 平台，因此从未真正花很多时间在那里。我还花了几年时间在 linux 上研究 C++——主要使用 Windows 上的记事本或 Visual Studio 进行所有编码，然后使用 samba 与 linux 环境共享文件。也将 borland C 用于一些实验性的东西。最近一直在玩python，正如上面其他人所指出的，它对盲人用户特别不友好，因为它是使用缩进作为嵌套机制编写的。话虽如此，NVDA，最受欢迎的开源屏幕阅读器完全使用 python 编写，该项目的一些提交者本身就是盲人。作为一名架构师，我经常被问到的一个特别有趣的问题是我如何处理图表 - UML 和 visio 以及理性玫瑰等。Visio 可能是最容易使用的图表工具。我能够编写下颚脚本来为我阅读理性的玫瑰图。我使用了一些德国大学开发的名为 T-dub（盲人技术图表理解）的工具来访问 UML 2.0 图表。曾使用基于 java 的丑陋工具（称为magic draw）进行模型驱动开发，并且是 androMDA 项目的提交者，并帮助从 UML 模型开发 .Net 代码生成器。作为一名架构师，我经常被问到的一个特别有趣的问题是我如何处理图表 - UML 和 visio 以及理性玫瑰等。Visio 可能是最容易使用的图表工具。我能够编写下颚脚本来为我阅读理性的玫瑰图。我使用了一些德国大学开发的名为 T-dub（盲人技术图表理解）的工具来访问 UML 2.0 图表。曾使用基于 java 的丑陋工具（称为magic draw）进行模型驱动开发，并且是 androMDA 项目的提交者，并帮助从 UML 模型开发 .Net 代码生成器。作为一名架构师，我经常被问到的一个特别有趣的问题是我如何处理图表 - UML 和 visio 以及理性玫瑰等。Visio 可能是最容易使用的图表工具。我能够编写下颚脚本来为我阅读理性的玫瑰图。我使用了一些德国大学开发的名为 T-dub（盲人技术图表理解）的工具来访问 UML 2.0 图表。曾使用基于 java 的丑陋工具（称为magic draw）进行模型驱动开发，并且是 androMDA 项目的提交者，并帮助从 UML 模型开发 .Net 代码生成器。我能够编写下颚脚本来为我阅读理性的玫瑰图。我使用了一些德国大学开发的名为 T-dub（盲人技术图表理解）的工具来访问 UML 2.0 图表。曾使用基于 java 的丑陋工具（称为magic draw）进行模型驱动开发，并且是 androMDA 项目的提交者，并帮助从 UML 模型开发 .Net 代码生成器。我能够编写下颚脚本来为我阅读理性的玫瑰图。我使用了一些德国大学开发的名为 T-dub（盲人技术图表理解）的工具来访问 UML 2.0 图表。曾使用基于 java 的丑陋工具（称为magic draw）进行模型驱动开发，并且是 androMDA 项目的提交者，并帮助从 UML 模型开发 .Net 代码生成器。

总的来说，我发现在一个可以发挥自己优势的团队环境中，我最能茁壮成长。例如，虽然图表对于交流/记录设计非常有用，但实际的设计过程涉及大量的思考和头脑风暴，当设计完成后，您的一位团队成员可以帮助您快速拼凑出一张整齐的画画出来的。人们错误地将上述内容误解为缺乏独立性或能力，而我认为这是纯粹的相互依赖——因为我确信单独的队友永远不可能靠他/她自己和在-转身，如果我依靠他来记录设计，就这样吧。我面临的大多数障碍是基于工具的不可访问性。

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2012-05-21T21:30:42.937

我是一名盲人开发人员，我在 Windows、GNU Linux 和 MacOS X 下工作。每个平台为盲人用户提供不同的工作流程。这取决于盲人开发人员使用的屏幕阅读器。盲人开发人员无法完全使用开发工具。我可以在所有 IDE 中键入代码并使用编译功能，但是如果我必须使用 Interface Builder、XGlade 或其他设计工具来设计界面，则会出现很多问题。当我使用 Borland Delphi 进行开发时，我可以添加一个控件，例如一个 Button，并且我可以使用对象检查器窗口修改控件的每个视觉属性。许多 IDE 使用对象检查器窗口来修改可视和非可视属性，但是对于盲人开发人员来说，问题是添加新控件，因为添加新控件的方法包括将控件从调色板拖放到画布上。Visual Studio 200x 使用替代方法来执行此操作，但 IDE 的界面在每个新版本中都会发生变化，这是一个大问题，因为 Windows 的屏幕阅读器需要特殊支持，使用脚本来识别某些非标准应用程序的每个区域。盲人开发人员可以通过屏幕阅读器使用 Visual Studio 2008，但是当出现此 IDE 的新版本时，他必须等待此版本 IDE 的新脚本版本。带有 Interface builder 的 Xcode 还没有替代拖放任务的方法。我多次向 Apple 询问过，但他们正在做其他事情。我在 App Store 中发布了 3 个应用程序（Accessible minesweeper、accessible fruitmachine 和 Programar a ciegas RSS），我必须通过代码设计所有界面。这是一项艰苦的工作，但我可以管理每个控件的所有功能。Eclipse 有一个可访问的代码编辑器，但其他开发工具（如调试控制台、设计插件或文档区域）为盲人用户的辅助工具带来了问题。

对于盲人开发人员来说，文档也是一个问题。很多样例和演示都使用图片来展示说明（设置环境设置如图）

我认为问题不在于盲目。问题是公司和开发团队认为可访问性会影响最终软件，但不会影响开发软件。他们认为盲人用户应该是客户，但盲人用户不能成为开发伙伴。

盲人协会要求产品和服务的可访问性，但他们忘记了盲人开发人员。盲人可以担任律师、记者、教师，但盲人开发人员即使对盲人来说也是一个奇怪的概念。很多时候我感到孤独，因为我的一些盲人朋友无法理解我的工作。

[您可以在我的博客http://www.programaraciegas.net/2010/11/05/la-accesibilidad-en-crisis-para-los-desarrolladores-ciegos/](http://www.programaraciegas.net/2010/11/05/la-accesibilidad-en-crisis-para-los-desarrolladores-ciegos/)中阅读我对这个问题的看法。 网页中有翻译工具。抱歉，我没有翻译。

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2008-09-23T03:48:24.477

Emacs 有许多扩展允许盲人用户操作文本文件。您必须咨询该主题的专家，但 emacs 具有文本到语音的功能。而且可能更多。

此外，还有 BLinux：

[http://leb.net/blinux/](http://leb.net/blinux/)

盲人Linux。已经存在了很长时间。我觉得十几年了，而且很成熟。

* * *

## 回答 #6

> 赞同：43
> 
> 时间：2008-09-23T04:00:10.437

请记住，“盲人”是一系列条件——有些人在法律上是盲人，可以阅读一个非常大的显示器或在放大镜的帮助下，还有一些人根本没有视力。我记得有一个大学同学有一个特殊的设备可以放大书籍，还有一个特殊的软件可以用来放大屏幕的一部分。她正在努力完成大学学业，因为她的视力越来越差，即将完全消失。

编程也有一系列需求——有些人擅长编写大量代码，而有些人则更擅长看大局和架构。我想考虑到屏幕界面带来的困难，失明可能会增强你获得大局的能力......

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2008-09-23T03:49:26.593

Hanselman[最近与一位盲人开发人员进行了一个非常有趣的播客](http://www.hanselman.com/blog/HanselminutesPodcast125AccessibilityInWebAndRichApplications.aspx)。

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2010-01-27T20:03:07.597

我在大底特律盲人协会工作了三年，运行一个专为盲人访问量身定制的 BBS，并与许多盲人用户一起研究如何更好地满足他们的需求，并与新盲人用户一起让他们适应可用的硬件和当时可用的软件产品。如果不出意外，我至少学会了阅读盲文作为对冲我曾经在同样情况下结束的案例！

大多数盲人计算机用户和程序员都使用某种屏幕阅读器。[尤其是大白鲨](http://www.freedomscientific.com/products/fs/jaws-product-page.asp)很受欢迎。幸运的是，如今大多数主要应用程序都提供某种形式的无障碍访问。您可能需要稍微调整您的环境以减少喋喋不休，例如考虑在 Visual Studio 中禁用 Intellisense。

[盲文显示器](http://en.wikipedia.org/wiki/Refreshable_Braille_display)不太常见，而且相对昂贵得多，可以显示 40 或 80 列文本，并且可以在精确定位/标点符号很重要时使用。虽然屏幕阅读器可以配置为使用标点符号，但很多人发现它会分散注意力，并且在许多情况下更容易通过它来感觉自己的方式。Jaws 可以配置为驱动显示器，因此您无需处理可访问性应用程序。

此外，许多合法盲人用户仍然有一些视力。使用高对比度背景和放大功能可以帮助很多这些用户。

在 Windows 中使用 ToggleKeys 可以让您听到当您不小心点击模式“大写锁定”、“数字锁定”、“滚动锁定”等键之一时的声音。

我知道至少有一个 Haskell 程序员使用屏幕阅读器并且在不使用 Haskell 布局规则的情况下显式编程，而是选择使用相当非惯用但支持`{;}`的 's 代替，因为它更容易/更少分散他的注意力他的屏幕阅读器阅读标点符号，而不是让他找出符合 Haskell 布局规则的确切缩进。同样，我听到一些盲人程序员抱怨他们何时必须编写 Python。

最终，您将学会发挥自己的优势。

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2008-09-29T15:16:33.230

我不记得出处了，但我听说过/读过一种可听语法“着色”的形式——这样就可以将字符串分配读作

> foo 等于引号 这是一个字符串引号

字符串部分将以不同的音高或声音阅读，以使元素的分离更加清晰。

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2008-09-23T03:49:25.800

一个起点是 Blinux 项目：

[http://leb.net/blinux/](http://leb.net/blinux/)

该项目描述了如何获得 Emacspeak（文本到语音的编辑器）并拥有许多其他资源。

我与一个视力正常但阻止他们使用显示器的人一起工作——他们在屏幕阅读器软件方面做得很好，并且花了很多时间使用基于文本的应用程序和外壳。

维基百科的屏幕阅读器包列表是另一个起点：[http ://en.wikipedia.org/wiki/List_of_screen_readers](http://en.wikipedia.org/wiki/List_of_screen_readers)

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2011-09-21T09:29:54.163

我是中国北京的一名研究生。我主修计算机科学，我的很多工作都是编程。我天生视力低下，我需要使用放大工具才能清楚地看到屏幕上的字体。我在 windows 上使用 microsoft 的 mgnify 工具，如果在 linux 上使用 compiz 的 magnify 插件。我通常将该工具设置为原始字体大小的三倍。对我来说放大工具没问题，主要问题是速度，我必须移动鼠标才能让光标跟随我正在查看的文本，微软的放大提供了“自动跟随文本编辑点”的选项，这让我从编辑或编码时连续鼠标移动。但它并不总是有效，因为编辑软件或 IDE 可能不支持。linux上的放大工具很难用。KMag自带的KDE刷新率很差，眼睛不舒服，我现在用的compiz的放大插头还可以，但是没有自动对焦（自动对焦）的功能。iOS 为我提供了非常完美的全屏放大解决方案，尤其是在 ipad 的 9.7 英寸屏幕上。不需要自动对焦，因为我几乎不使用它们来编码或做其他编辑工作。Android 提供的辅助功能很少，只有抖音反馈之类的，对我来说没什么用。android上没有任何好的放大工具，更不用说iOS上的全屏放大等高级功能。我以前学Qt，想在linux上，甚至在android上做一个有用的放大工具。但几乎没有什么进展。但没有自动对焦功能（对焦自动跟随）。iOS 为我提供了非常完美的全屏放大解决方案，尤其是在 ipad 的 9.7 英寸屏幕上。不需要自动对焦，因为我几乎不使用它们来编码或做其他编辑工作。Android 提供的辅助功能很少，只有抖音反馈之类的，对我来说没什么用。android上没有任何好的放大工具，更不用说iOS上的全屏放大等高级功能。我以前学Qt，想在linux上，甚至在android上做一个有用的放大工具。但几乎没有什么进展。但没有自动对焦功能（对焦自动跟随）。iOS 为我提供了非常完美的全屏放大解决方案，尤其是在 ipad 的 9.7 英寸屏幕上。不需要自动对焦，因为我几乎不使用它们来编码或做其他编辑工作。Android 提供的辅助功能很少，只有抖音反馈之类的，对我来说没什么用。android上没有任何好的放大工具，更不用说iOS上的全屏放大等高级功能。我以前学Qt，想在linux上，甚至在android上做一个有用的放大工具。但几乎没有什么进展。Android 提供的辅助功能很少，只有抖音反馈之类的，对我来说没什么用。android上没有任何好的放大工具，更不用说iOS上的全屏放大等高级功能。我以前学Qt，想在linux上，甚至在android上做一个有用的放大工具。但几乎没有什么进展。Android 提供的辅助功能很少，只有抖音反馈之类的，对我来说没什么用。android上没有任何好的放大工具，更不用说iOS上的全屏放大等高级功能。我以前学Qt，想在linux上，甚至在android上做一个有用的放大工具。但几乎没有什么进展。

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2010-01-27T21:54:39.637

当我在读研究生时，我们的研究团队中有一个失明的成员。他年纪大了一点，大概40多岁。他告诉我们他是如何编写他的第一台计算机（这远在文本转语音普及之前）以摩尔斯电码输出屏幕内容的。为了克服明显的先有鸡还是先有蛋的问题，他每次都必须从头开始完全重写代码，直到代码运行良好，可以让他读回代码。

现在他使用文本转语音，尽管他在实际编写任何代码之前对代码进行了非常彻底的计划，以最大限度地减少调试循环。

他也很擅长做 PowerPoint 演示文稿，尽管他视力不佳，但其格式与任何有视力的演示者的一样好。

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2008-09-23T03:48:37.250

这篇博文提供了一些关于 Visual Studio 团队如何使他们的产品易于访问的信息：

[Visual Studio 核心团队的辅助功能实验室参观活动](http://blogs.msdn.com/vsaccessibility/articles/232159.aspx)

许多程序员使用 Emacspeak：

[Emacspeak -- 完整的音频桌面](http://emacspeak.sourceforge.net/)

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2010-01-28T08:06:46.033

回到新西兰后，我认识一个患有[黄斑变性](http://en.wikipedia.org/wiki/Macular_degeneration)的人，所以视力不全。他是一位非常有才华的程序员，最终使用了 Delphi，因为他可以通过识别单词形状来工作。使用类似 Pascal 的语法比使用 C-ish 波浪括号更容易。他有一个网站，但似乎根本没有提到黄斑变性，所以我不会命名他。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2011-12-20T11:48:05.687

我是盲人，从几个月开始，我将 VINUX（基于 Ubuntu 的 Linux 发行版）与 SODBEANS（带有名为 SAPPY 的插件的 netbeans 版本，添加了 TTS 支持）一起使用。这个解决方案效果很好，但有时我更喜欢启动 Win XP 和 NVDA 来在 FireFox 上启动许多页面，因为当您尝试打开 3 个以上的 FireFox 窗口时，Vinux 不能很好地工作......

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2012-01-05T06:48:59.953

正如许多人指出的那样，emacspeak 一直是许多老黑客的持久解决方案跨平台。由于它支持 Linux 和 Mac 开箱即用，它已成为我开发 Windows 不可知项目的首选方式。

对于通过听觉而不是视觉来实际掌握语法的问题，我发现如果不在同一个比赛场地上，存在多种技术可以使语法接近。

例如，听觉图标可以代替语言描述。您可以为一行缩进的距离设置音调。音调越长，缩进越远。由于音调可以与文本到语音的同时播放，因此信息在同一时间范围内传递，并且不会序列化如此基本的东西的通信。

盲文可以快速准确地为用户解码一行的确切语法。这对于在日常生活中使用盲文的人来说更有用；最大的优点是随机访问显示的内容。可刷新单元通常在每个字符单元上方都有路由器键，可以将光标置于该单元。不用摆弄箭头键 O(n) op vs O(1) 访问。

听觉维度（音高、速率、音量、拐点、丰富度、重音等）可以传达一个概念（关键字、类别、变量、错误等）。例如，评论可以以单调的变化形式阅读......如果我可以这么说的话：）。

Emacs 和其他编辑器在较小程度上（Visual Studio）允许编码人员以语义方式仔细阅读程序（下一个块、折叠块、向下 defun、跳转到 def、向上分析树等）。这样做，您可以非常快速地获得整个项目结构的“大”图；使用 Cedet 之类的扩展，您可以获得 VS/Eclipse/etc 跨平台和文本编辑器的优点。

可能会继续下去，但简而言之，这就是为什么我们中的一些人在工业界、学术界或地下室中进行黑客攻击的基础:)。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2010-10-30T11:27:29.843

[harald van Breederode](http://prutser.wordpress.com/)是荷兰著名的盲人 Oracle DBA 专家、培训师和演讲者。他的博客包含一些对视障人士有用的提示。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2010-10-28T15:18:05.607

一群来自南伊利诺伊大学爱德华兹维尔分校和华盛顿州立大学的学生正在为盲人开发一种编程语言：

[http://www.youtube.com/watch?v=lC1mOSdmzFc](http://www.youtube.com/watch?v=lC1mOSdmzFc)

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-09-23T04:01:01.807

盲文键盘到底是什么？

有诸如盲文书写器之类的东西，但您永远不会将盲文书写器用作计算机的输入设备。

如果您只是在谈论带有盲文符号的键盘，这也是一个非常糟糕的主意。打字时你将有更多的键可以触及，而且速度仍然会更慢。

触摸打字*不是*一种视觉技能，盲人可以像有视力的人一样做到这一点。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-09-22T14:30:23.170

NVDA 是一个很好的开源屏幕阅读器。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-09-23T03:46:19.457

我认为这在使用结对编程原理的极限编程中会很有效。如果您正在为盲人制作软件，那么谁能更好地制作它，然后是真正与业务需求保持联系的人，所以我认为这根本不是牵强附会。

至于编写代码，除非有某种反馈，否则我认为一个人可能会在语法方面遇到困难。不过，音频反馈可能会有所帮助。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2010-11-11T20:24:26.513

发明一种插入USB端口的设备怎么样？基本上是一块“橡胶片”，它会自我修改以显示你的代码的盲点，让盲人阅读它而不是听到它？

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2011-09-21T23:07:32.030

有多种工具可以帮助盲人或视力不佳的人，包括语音反馈和盲文键盘。[http://www.rnib.org.uk/Pages/Home.aspx](http://www.rnib.org.uk/Pages/Home.aspx)是一个很好的网站，可以就这些问题提供帮助和建议。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2012-05-10T07:01:52.670

有一次我遇到了 Sam Hartman，他是 2000 年以来著名的 Debian 开发人员，而且是个盲人。在[这次](http://raphaelhertzog.com/2011/06/24/people-behin-debian-sam-hartman-kerberos-package-maintainer/)采访中，他谈到了 Linux 用户的可访问性。他使用 Debian 和 gnome-orca 作为屏幕阅读器，它与 Gnome 配合使用，并且“在说 Iceweasel/Firefox 和 Libreoffice 方面做得比较好”。

具体谈到编程，他说：

> 虽然 [gnome-orca] 确实会说 gnome-terminal，但它在说终端程序方面还不够好，我觉得使用它很舒服。因此，我使用 Emacspeak 包运行 Emacs。在其中，我运行 Emacs 终端仿真器，在其中，我倾向于运行 Screen。为了增加乐趣，我经常在内部屏幕中运行额外的 Emacs 实例。

# javascript - Adobe AIR 中有哪些打印功能？

> ID：118990
> 
> 赞同：2
> 
> 时间：2008-09-23T03:45:25.217
> 
> 标签：javascript, printing, adobe, air

我一直试图弄清楚如何在 Adob​​e AIR 中打印。我知道标准的 javascript 函数不起作用。AIRforJSDev 指南说：“Adobe AIR 1.0 不支持 window.print() 方法。通过公开的 AIRAPI 可以使用其他方法，让您可以在运行时访问打印”

但我找不到这些功能。我查看了语言参考，但在任何地方都找不到它们。他们在哪里，他们是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T04:04:59.070

您需要做的是访问 AS3 [flash.printing.PrintJob](http://livedocs.adobe.com/flex/201/langref/flash/printing/PrintJob.html) API。这是一个关于[从 javascript 访问 flash API](http://livedocs.adobe.com/air/1/devappshtml/help.html?content=ProgrammingHTMLAndJavaScript_05.html)的页面（基本上你只需执行 window.runtime.XYZ ，其中 XYZ 是 flash API）。

您应该查找有关在 Flash 中打印的教程，只需要从 JS 进行细微调整即可。这是我发现的两个关于在闪存中打印的随机教程：[一](http://blog.tikikitchen.com/2008/04/18/printing-in-flash-in-1000000000-simple-steps)、[二](http://snipplr.com/view/4942/as3-flash-printing-basics/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-11-25T13:01:43.263

如果您只是在谈论打印到控制台，那么您将需要 trace() 方法。

假设您包含 AIRAliases.js 文件，则可以在 javascript 中使用 air.trace() 访问它。**************