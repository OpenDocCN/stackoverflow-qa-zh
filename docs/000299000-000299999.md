# StackOverflow 问答 000299000-000299999

# java - 从 Oracle 存储过程访问 Web 服务

> ID：299002
> 
> 赞同：10
> 
> 时间：2008-11-18T15:08:43.200
> 
> 标签：java, oracle, web-services, stored-procedures, plsql

是否有人从 Oracle 存储过程中成功访问了 Web 服务？如果是这样，它是一个 Java 存储过程吗？PL/SQL 存储过程？

有什么理由我不应该尝试从存储过程中访问 WS？

这是我到目前为止发现的几个参考文献

*   [数据库网络服务](http://download.oracle.com/docs/cd/B19306_01/java.102/b14187/chtwelve.htm#CBBEFCHI)
*   [从 Java 存储过程调用外部 Web 服务](http://www.oracle.com/technology/sample_code/tech/java/jsp/samples/wsclient/Readme.html)

*..澄清一下，这是针对 SOAP 调用的*

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-18T15:28:53.613

首先，您调用的是哪种网络服务？我假设是 SOAP 或 REST。

对于 REST Web 服务，UTL_HTTP 通常是绰绰有余，在一个简单的 PL/SQL 存储过程中结合一点 XPath。

对于 SOAP Web 服务，这取决于您需要（或想要）变得多复杂。您当然可以使用 XQuery 创建一个符合 Web 服务规范的 XML 文档，使用 UTL_HTTP 发布文档并获取响应，然后使用一些 XPath 来解析响应，这一切都在 PL/SQL 中。这是一个相对手动且相对蛮力的解决方案，但如果您谈论的是少数 Web 服务，它涉及最少的基础设施，并且调用可以很快地组合在一起。

如果您希望调用随着时间的推移而发展，或者您希望有许多过程调用许多 Web 服务，那么将时间投入到诸如 UTL_DBWS 之类的东西上可能是有意义的（不过，这不是您通常会得到的东西在几个小时内工作）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-09T22:44:43.763

将 UTL_HTTP 包装在一个便利函数中是相当简单的：

```
FUNCTION post
(
    p_url     IN VARCHAR2,
    p_data    IN CLOB,
    p_timeout IN BINARY_INTEGER DEFAULT 60
) 
    RETURN CLOB
IS
    --
    v_request  utl_http.req;
    v_response utl_http.resp;
    v_buffer   CLOB;
    v_chunk    VARCHAR2(4000);
    v_length   NUMBER;
    v_index    NUMBER;
BEGIN

    v_index := 1;
    v_length := nvl(length(p_data), 0);

    -- configure HTTP
    utl_http.set_response_error_check(enable => FALSE);
    utl_http.set_detailed_excp_support(enable => FALSE);
    utl_http.set_transfer_timeout(p_timeout);

    -- send request
    v_request := utl_http.begin_request(p_url, 'POST','HTTP/1.0');
    utl_http.set_header(v_request, 'Content-Type', 'text/xml');
    utl_http.set_header(v_request, 'Content-Length', v_length);
    WHILE v_index <= v_length LOOP
        utl_http.write_text(v_request, substr(p_data, v_index, 4000));
        v_index := v_index + 4000;
    END LOOP;

    -- check HTTP status code for error
    IF v_response.status_code <> utl_http.http_ok THEN   
        raise_application_error(
            cn_http_error,
            v_response.status_code || ' - ' || v_response.reason_phrase
        );
    END IF;

    -- get response
    dbms_lob.createtemporary(v_buffer, FALSE);
    v_response := utl_http.get_response(v_request);
    BEGIN
        LOOP
            utl_http.read_text(v_response, v_chunk, 4000);
            dbms_lob.writeappend(v_buffer, length(v_chunk), v_chunk);
        END LOOP;
    EXCEPTION
        WHEN utl_http.end_of_body THEN NULL;
    END;
    utl_http.end_response(v_response);

    RETURN v_buffer;

END; 
```

然后你只需要一些东西来发布一个 SOAP 信封：

```
FUNCTION invoke
(
    p_url IN VARCHAR2,
    p_method IN XMLTYPE,
    p_timeout IN NUMBER := 60
)
    RETURN XMLTYPE
IS
    -- calls the given SOAP service
    cn_procedure_name CONSTANT VARCHAR2(30) := 'invoke';
    --
    v_envelope XMLTYPE;
    v_response CLOB;
    v_fault XMLTYPE;
    v_sqlerrm VARCHAR2(2000);
BEGIN

    -- wrap method in SOAP envelope
    SELECT
        XMLElement(
            "soap:Envelope",
            XMLAttributes(
                'http://schemas.xmlsoap.org/soap/envelope/' AS "xmlns:soap"
            ),
            XMLElement(
                "soap:Body",
                p_method
            )
        )
    INTO
        v_envelope
    FROM
        dual;

    -- POST request
    v_response := post(
        p_url,
        '<?xml version="1.0" encoding="ISO-8859-1"?>' || chr(10) || v_envelope.getClobVal(),
        p_timeout
    );
    IF v_response IS NULL THEN
        RAISE null_response;
    END IF;

    -- parse response
    BEGIN
        v_envelope := XMLType(v_response);
    EXCEPTION
        WHEN OTHERS THEN
            v_sqlerrm := SQLERRM;
            RAISE xml_parse_error;
    END;

    -- check for a fault
    v_fault := v_envelope.extract(  
        '/soap:Envelope/soap:Body/soap:Fault', 
        'xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'
    );
    IF v_fault IS NOT NULL THEN
        v_sqlerrm := v_fault.extract('.//faultstring/text()').getStringVal();
        RAISE soap_fault;
    END IF;

    -- the actual response is the child of the <soap:Body /> element
    RETURN v_envelope.extract(
        '/soap:Envelope/soap:Body/*[position() = 1]', 
        'xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'
    );

END; 
```

请注意，我删除了我们的异常处理块，因为它与示例不是特别相关。

这样，您可以让任何其他过程生成调用服务所需的 XML，通过调用传递它，并解析返回值。

我们在 9i 数据库上开发了这个解决方案，所以我们还没有研究 UTL_DBWS。不过，它工作得很好。

# eclipse - 使用 RAD 清除工作空间环境的方法（基于 Eclipse）

> ID：299011
> 
> 赞同：5
> 
> 时间：2008-11-18T15:12:52.617
> 
> 标签：eclipse, rad

启动 RAD7 时出现很多错误。服务器不响应类更改。有时服务器不会启动。有时 RAD 不会确认我添加到服务器的模块。这是一种越野车。

我知道工作区中有元数据，是否有安全的方法来清理元数据或 RAD？

其中 RAD = Rational Application Developer

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T08:58:11.120

另一个技巧是在 Eclipse 中删除 Servers 视图中的所有项目，停止服务器，启动服务器，打开服务器的管理控制台，看看那里的所有东西也都消失了。如果您仍然看到已配置的应用程序，请在管理控制台中删除它们。关闭服务器，重新启动并检查是否干净启动。这可确保您的 Eclipse 服务器插件和服务器同步。现在您可以再次将项目添加到服务器；也许这会提高稳定性。

如果没有，更严厉的措施是在 Eclipse 中删除您的服务器配置（不要删除服务器本身）并在 Servers 视图中再次添加它。

您也可以尝试禁用自动发布。您可以转到 Preferences->Server 并取消选中“Automatically publish...”如果您使用的是 WAS，您还可以在 Servers 视图中双击您的服务器，然后转到“Automatic Publishing”部分并选中“Never自动发布”。这可能会让您更好地控制何时将内容发布到您的服务器，尽管它有时有自己的想法并且在某些情况下会自动发布。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-30T15:25:38.857

eljenso 已经发布了一半的答案。对于没有获取资源的服务器，请验证您正在发布。右键单击服务器并点击发布（我个人关闭自动发布）管理控制台/卸载耳朵/然后重新添加耳朵是另一种方法，但是在 RAD 中我从来不需要这样做。在 WID 中，您*需*要这样做，因为发布在那个被上帝遗弃的工具中被彻底破坏了。

RAD 修复：您尚未涉及的另一半难题是确保您的项目工作区都是最新的。有时你会流血（构建错误），即使你知道它什么都没有。发生这种情况时，关闭所有项目，可选步骤：关闭 rad 并重新打开 rad，重新打开项目，刷新所有项目，然后再进行一次构建/清理。

ClearCase 修复：如果你碰巧在使用 clearcase，那么当事情无缘无故流血时，你真的会处于一个受伤的世界。在您执行我上面列出的操作之前，您需要进行更新、还原（是的，我知道更新应该执行还原所做的以及更多操作 - 但它*不会，*因为它使用缓存数据进行操作，所以它只更新它*认为*需要更新的内容。不幸的是缓存算法有缺陷），然后刷新。这将保证所有文件都已正确推送到您的文件系统，现在您需要执行上述步骤以使 RAD 获取刚刚推送到您的文件系统的 [可能是新的] 文件更改。

如果您正在处理一个大型项目并且您拥有 RAD + clearcase，请高枕无忧，恢复完成需要一段时间。最好尝试更新、刷新 + RAD 修复，看看是否能先解决问题。恢复应该是您在大型项目上的最后努力。（如果你有一个小项目，每次都做所有的事情）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T15:27:28.497

Eclipse 可以在启动时采用 -clean 参数。也许这就是你要找的？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T21:23:07.107

如果您确实需要擦除所有工作区元数据，则删除工作区中的`.metadata`目录应该可以解决问题。请注意，这会清除设置、工作区布局，甚至哪些项目可用（您将需要重新导入所有旧项目，尽管它们仍在工作区目录中）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T02:52:46.983

如果您需要清除元数据设置，请先尝试删除 .metadata/.plugins/org.eclipse.core.resources！这为我省去了很多麻烦...

# visual-studio-2008 - 如何使用 MSBuild 发布 Web 项目？

> ID：299017
> 
> 赞同：10
> 
> 时间：2008-11-18T15:15:19.460
> 
> 标签：visual-studio-2008, command-line, build-process

在 Visual Studio 2008 中，如果您有一个 Web 项目，您可以使用菜单 Build -> Publish Web。
我可以通过命令行使用 msbuild 获得相同的结果吗？

* * *

在这篇博文中找到了答案：[如何使用 MSBuild 发布网站](http://codingcockerel.co.uk/2008/05/18/how-to-publish-a-web-site-with-msbuild/)。
更详细的信息在这里：[使用 MSBuild 部署 Visual Studio 2005 Web 应用程序](http://www.driebier.net/post/Using-MSBuild-to-deploy-visual-studio-2005-web-applications.aspx)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T15:30:53.343

我认为您要使用的是 aspnet_compliler

```
C:\Program Files\Microsoft Visual Studio 9.0\VC>aspnet_compiler -?
Utility to precompile an ASP.NET application
Copyright (C) Microsoft Corporation. All rights reserved.

Usage:
aspnet_compiler [-?] [-m metabasePath | -v virtualPath [-p physicalDir]]
                [[-u] [-f] [-d] [-fixednames] targetDir] [-c]
                [[-keyfile file | -keycontainer container]
                     [-aptca] [-delaySign]]
                [-errorstack]

-?            Prints this help text.
-m            The full IIS metabase path of the application. This switch cannot
              be combined with the -v or -p switches.
-v            The virtual path of the application to be compiled (e.g.
              "/MyApp"). If -p is specified, the physical path is used to
              locate the application. Otherwise, the IIS metabase is used, and
              the application is assumed to be in the default site (under
              "/LM/W3SVC/1/Root"). This switch cannot be combined with the -m
              switch.
-p            The physical path of the application to be compiled. If -p is
              missing, the IIS metabase is used to locate the app. This switch
              must be combined with -v.
-u            If specified, the precompiled application is updatable.
-f            Overwrites the target directory if it already exists. Existing
              contents are lost.
-d            If specified, the debug information is emitted during
              compilation.
targetDir     The physical path to which the application is compiled. If not
              specified, the application is precompiled in-place.
-c            If specified, the precompiled application is fully rebuilt. Any
              previously compiled components will be re-compiled. This option
              is always enabled when targetDir is specified.
-keyfile      The physical path to the strong name key file.
-keycontainer Specifies a strong name key container.
-aptca        If specified, the strong-name assembly will allow partially
              trusted callers.
-delaysign    If specified, the assembly is not fully signed when created.
-fixednames   If specified, the compiled assemblies will be given fixed names.
-nologo       Suppress compiler copyright message.
-errorstack   Shows extra debugging information that can help debug certain
              conditions.

Examples:

The following two commands are equivalent, and rely on the IIS metabase. The
compiled application is deployed to c:\MyTarget:
    aspnet_compiler -m /LM/W3SVC/1/Root/MyApp c:\MyTarget
    aspnet_compiler -v /MyApp c:\MyTarget

The following command compiles the application /MyApp in-place. The effect is
that no more compilations will be needed when HTTP requests are sent to it:
    aspnet_compiler -v /MyApp

The following command does *not* rely on the IIS metabase, as it explicitly
specifies the physical source directory of the application:
    aspnet_compiler -v /MyApp -p c:\myapp c:\MyTarget 
```

# database - 跨数据库是否可以接受？

> ID：299027
> 
> 赞同：4
> 
> 时间：2008-11-18T15:17:35.210
> 
> 标签：database, database-design

我不确定这种做法实际上叫什么，所以也许有人可以编辑标题以更准确地反映我的问题。

假设我们有一个存储不同类型对象的站点。每种类型的对象都有自己的数据库（书籍和各种信息及其表格的数据库，CD 和信息及其表格的数据库，等等）。但是，所有对象都有关键字，并且无论类型如何，所有对象的关键字都应该是统一的。创建了一个带有几个表的新数据库来存储关键字，但是每个对象数据库都负责将对象 ID 映射到一个关键字。

这是一个好习惯吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T15:31:17.087

是否有理由为每种类型的对象设置单独的数据库？您最好使用多个表并加入它们。例如，您可能有一个表格`GENERIC_OBJECT`，其中包含所有类型的通用内容，然后是一个表格，称为给定书籍的`BOOK_OBJECT`位置。`BOOK_OBJECT.ID = GENERIC_OBJECT.ID`另一个表是`CD_OBJECT`给`CD_OBJECT.ID = GENERIC_OBJECT.ID`定 CD 的位置。然后，所有对象中通用的关键字之类的内容将存储在`GENERIC_OBJECT`表中，而特定于项目的内容将进入项目的相应表中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T15:25:20.563

通过将它们分成不同的数据库，您将失去：

*   执行 ACID 事务的能力（假设您没有使用两阶段提交解决方案）。
*   具有参照完整性的能力。
*   跨表联接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T15:31:38.037

Thomas，您在对我们对参照完整性的担忧的评论回复中缺少的是，您不能跨两个数据库执行外键。如果这两个表在一个数据库中，那么您可以使用外键约束来确保当您删除一个对象时，任何依赖于其对象 id 的东西也会被删除，以及其他类似的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T15:36:11.040

虽然可以跨数据库进行连接，但我通常不会因为它们的类别略有不同而将数据*拆分到数据库之间。*其他人还提到无法跨数据库使用参照完整性。

另一方面，如果每种类型的产品都有完全不同的前端应用程序，或者如果您希望每个数据库都变得非常庞大，那么这些可能是*考虑*将它们留在单独数据库中的原因。（尽管对于大多数现代数据库来说，缩放不是问题）。

跨数据库连接的语法示例：

```
SELECT *
FROM books b
INNER JOIN KeywordDB.dbo.Keywords k
ON b.keywordID = k.keywordID 
```

在此示例中，您正在从包含 books 表的*本地数据库执行查询，并且您正在连接到另一个数据库。*（这是一个 MS SQL 语法示例）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T15:20:55.640

不，这是个坏主意。通过将它们分离到不同的数据库中，您会显着削弱执行 JOIN 查询的能力。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-18T15:31:37.757

它看起来确实有点太分离了，但如果有一些设计良好的视图，它可以工作，特别是如果视图只是查找。

为什么首先要进行这种分离？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-18T18:34:39.947

正如每个人都提到的那样，这通常不是一个好主意。 **但是，**为了扮演魔鬼的拥护者，我见过其他开发人员这样做。我确信有一些原因可能希望完成此操作，但是如果绝对需要（不确定您是否要求解决方案，但）您可能希望使用某种同步来保持数据同步。拥有两个数据库中的所有（或需要的）数据。

这也不是一个理想的解决方案，但如果您必须使用两种不同的数据库类型，这可能是解决此类问题的更好方法。

它至少可以解决每个人一直在概述的问题——尽管请记住它确实提出了一个新问题……*一切都同步了吗？*

祝你好运，
弗兰克

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T14:56:56.033

如果您决定使用一个还是两个数据库，我建议您只使用一个数据库。从您的问题来看，这两个表中的数据似乎密切相关。大小和复杂性似乎不值得分成两个数据库。

你的 DBMS 是什么？如果它是 Oracle、DB2、SQL Server 甚至是 MS Access，那么管理具有逻辑相关表中的关键字数据和对象数据的单个数据库应该不会有任何问题。

# build-automation - 使用 PVCS 实现项目部署自动化

> ID：299045
> 
> 赞同：1
> 
> 时间：2008-11-18T15:24:06.367
> 
> 标签：build-automation, pvcs

我们使用 PVCS 对所有代码进行源代码控制。我们在欧盟拥有 7 台服务器，覆盖 17 个国家/地区。PVCS 在生产中模仿我们的文件夹结构：

```
folderA
|
|--folderB
|     |
|     | -- folderC
|     |
|     | -- folder
| --folderD
|     |
|     | -- folderE
|     |
|     | -- folderF 
```

我们的项目可以依赖多个文件夹中的文件，因此我们只需复制一个文件夹即可部署新项目。多个程序也可以存在于同一个文件夹中。

我们有一个 DEV、UAT 和生产服务器。文件将在 DEV 服务器上开发，放到 UAT 上（他们应该这样做，这是问题的一部分，涉及的人手太多，有些人不想玩球），供用户测试。当 UAT 获得批准后，它们将被放回 PVCS 并带有适当的版本标签并分配一个开发级别（它们可以更早地放回 PVCS 并带有开发版本标签）。

当所有相关批准都完成后，就会提出变更控制请求，支持团队会将代码部署到生产环境中。

我们最大的问题是这个过程太小了，有太多的人必须在特定的时间做特定的事情，并以正确的顺序告诉人们一些事情。

我们想要的是一个可以自动部署项目的程序。您需要能够为 PVCS 中不同文件夹中的不同文件分配一个项目标签，然后能够处理该标签并根据需要部署所有文件。

这存在吗？

我希望这是有道理的。

谢谢

乔恩

**编辑：**

我们将一直在创建新项目。项目将与部署相关。即项目 1234 将具有文件 1、2、5、6 项目 2345 将使用文件 2、5、8。因此，为此，我们需要一种快速简便的方法来添加和管理项目。

如果有人能提出一种更好的方法来处理这种自动化，那也很好。

我们对编译代码和测试不感兴趣，因为有多种语言，我相信目前这超出了我们的范围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T15:29:14.003

查看[nAnt](http://nant.sourceforge.net/)和[Cruise Control](http://cruisecontrol.sourceforge.net/index.html)

**编辑：** 使用 Cruise Control，您始终可以编写自己的插件以更好地处理您的环境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-15T03:24:59.483

PVCS 可以自动化。我组织中的软件工程人员已经创建了一整套脚本来配合 PVCS。我们使用这些脚本来自动化我们的软件集成和发布过程。

例如，我们有一个创建 Release 的脚本，这意味着创建一个新项目，其中包含来自许多项目和数据库的特定版本的文件。听起来与您想要做的事情相似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-11T12:03:24.327

为了自动化我们的部署过程，我必须使用 pcli 和 python 创建一个工具。pcli 脚本在哪里获取代码（使用来自用户的输入（标签））和 python 以部署到我们的服务器。

检查位于 VM_Install_Dir\books\vm\vmbooks\pcli.pdf 下的 pcli 文档

# ruby-on-rails - Capistrano - RAILS_GEM_VERSION 错误

> ID：299057
> 
> 赞同：1
> 
> 时间：2008-11-18T15:27:32.477
> 
> 标签：ruby-on-rails, capistrano

我想不通。Capistrano 不断给我这个错误：

```
 ** [out :: myserver.net] Missing the Rails 2.1.1 gem. Please `gem install -v=2.1.1 rails`, update your RAILS_GEM_VERSION setting in config/environment.rb for the Rails version you do have installed, or comment out RAILS_GEM_VERSION to use the latest version installed. 
```

所以，就像好的错误消息说的那样，我检查了我的`config/environments.rb`文件，发现确实设置为`RAILS`_`GEM`_`VERSION`

```
RAILS_GEM_VERSION = '2.1.1' unless defined? RAILS_GEM_VERSION 
```

我将其更改为“2.1.2”，因为这是我的服务器上的内容，并再次尝试修改：同样的错误。

所以，我在我的开发机器上升级了 Rails（2.1.1 -> 2.1.2）并再次尝试：同样的错误。

我试着注释掉这一行：同样的错误。

最后，我登录到我的服务器，删除了我的项目目录中的所有内容（`config/environments.rb`我希望删除所有缓存的副本），然后再次尝试。 *同样的错误*。

这是怎么回事？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T19:44:18.963

好的 - 我的问题是我忘记将更改推`config/environments.rb`送到我的存储库，所以 Capistrano 在部署时没有注册我的更改。

现在工作正常。我需要休息... ：）

# java - Java 中异常对性能的影响是什么？

> ID：299068
> 
> 赞同：535
> 
> 时间：2008-11-18T15:31:11.207
> 
> 标签：java, performance, exception

问题：Java 中的异常处理真的很慢吗？

传统观点以及许多 Google 结果都认为，异常逻辑不应该用于 Java 中的正常程序流。通常给出两个原因，

1.  它真的很慢 - 甚至比常规代码慢一个数量级（给出的原因各不相同），

和

2.  这很混乱，因为人们只希望在异常代码中处理错误。

这个问题是关于#1。

作为示例，[此页面](http://leepoint.net/notes-java/flow/exceptions/03exceptions.html)将 Java 异常处理描述为“非常慢”，并将慢速与异常消息字符串的创建联系起来——“此字符串随后用于创建抛出的异常对象。这并不快。” 《[Java 中的有效异常处理](http://adtmag.com/articles/2000/08/22/effective-exception-handling-in-java.aspx)》一文说，“原因在于异常处理的对象创建方面，这使得抛出异常本质上很慢”。另一个原因是堆栈跟踪的生成会减慢它的速度。

我的测试（在 32 位 Linux 上使用 Java 1.6.0_07、Java HotSpot 10.0）表明异常处理并不比常规代码慢。我尝试在执行某些代码的循环中运行一个方法。在方法结束时，我使用一个布尔值来指示是*返回*还是*抛出*。这样实际处理是一样的。我尝试以不同的顺序运行这些方法并平均我的测试时间，认为这可能是 JVM 正在预热。在我所有的测试中，投掷至少和返回一样快，如果不是更快的话（最多快 3.1%）。我完全接受我的测试错误的可能性，但我没有看到任何代码示例、测试比较或过去一两年的结果表明 Java 中的异常处理实际上是慢的。

让我走上这条道路的是我需要使用的一个 API，它作为正常控制逻辑的一部分抛出异常。我想纠正它们的用法，但现在我可能无法做到。相反，我是否必须赞扬他们的前瞻性思维？

在论文[Efficient Java exception handling in just-in-time compilation](http://portal.acm.org/citation.cfm?id=337453)中，作者建议仅存在异常处理程序，即使没有抛出异常，也足以阻止 JIT 编译器正确优化代码，从而减慢它的速度. 我还没有测试过这个理论。

* * *

## 回答 #1

> 赞同：363
> 
> 时间：2008-11-18T16:43:39.297

这取决于如何实现异常。最简单的方法是使用 setjmp 和 longjmp。这意味着 CPU 的所有寄存器都被写入堆栈（这已经需要一些时间），并且可能需要创建一些其他数据......所有这些都已经在 try 语句中发生了。throw 语句需要展开堆栈并恢复所有寄存器的值（以及 VM 中可能的其他值）。所以 try 和 throw 同样慢，而且相当慢，但是如果没有抛出异常，在大多数情况下退出 try 块不需要任何时间（因为所有东西都放在堆栈上，如果方法存在，它会自动清理）。

Sun 和其他人认识到，这可能不是最理想的，当然随着时间的推移，VM 会变得越来越快。还有另一种实现异常的方法，它使 try 本身快如闪电（实际上，一般 try 根本没有发生任何事情 - 当 VM 加载类时，需要发生的所有事情都已经完成）并且它使得 throw 不那么慢. 我不知道哪个 JVM 使用了这种新的、更好的技术……

...但是您是用 Java 编写的，因此您的代码以后只能在一个特定系统上的一个 JVM 上运行吗？因为如果它可以在任何其他平台或任何其他 JVM 版本（可能是任何其他供应商）上运行，谁说他们也使用快速实现？快的比慢的更复杂，并且不容易在所有系统上实现。你想保持便携吗？然后不要依赖异常快速。

在 try 块中执行的操作也会产生很大的不同。如果您打开一个 try 块并且从不从该 try 块中调用任何方法，则该 try 块将非常快，因为 JIT 实际上可以将 throw 视为简单的 goto。它既不需要保存堆栈状态，也不需要在抛出异常时展开堆栈（它只需要跳转到 catch 处理程序）。但是，这不是您通常会做的事情。通常你打开一个 try 块然后调用一个可能抛出异常的方法，对吧？即使你只是在你的方法中使用 try 块，这将是一种什么样的方法，它不会调用任何其他方法？它只会计算一个数字吗？那你为什么需要例外？有更优雅的方式来规范程序流。除了简单的数学之外，几乎所有其他事情，

请看以下测试代码：

```
public class Test {
    int value;

    public int getValue() {
        return value;
    }

    public void reset() {
        value = 0;
    }

    // Calculates without exception
    public void method1(int i) {
        value = ((value + i) / i) << 1;
        // Will never be true
        if ((i & 0xFFFFFFF) == 1000000000) {
            System.out.println("You'll never see this!");
        }
    }

    // Could in theory throw one, but never will
    public void method2(int i) throws Exception {
        value = ((value + i) / i) << 1;
        // Will never be true
        if ((i & 0xFFFFFFF) == 1000000000) {
            throw new Exception();
        }
    }

    // This one will regularly throw one
    public void method3(int i) throws Exception {
        value = ((value + i) / i) << 1;
        // i & 1 is equally fast to calculate as i & 0xFFFFFFF; it is both
        // an AND operation between two integers. The size of the number plays
        // no role. AND on 32 BIT always ANDs all 32 bits
        if ((i & 0x1) == 1) {
            throw new Exception();
        }
    }

    public static void main(String[] args) {
        int i;
        long l;
        Test t = new Test();

        l = System.currentTimeMillis();
        t.reset();
        for (i = 1; i < 100000000; i++) {
            t.method1(i);
        }
        l = System.currentTimeMillis() - l;
        System.out.println(
            "method1 took " + l + " ms, result was " + t.getValue()
        );

        l = System.currentTimeMillis();
        t.reset();
        for (i = 1; i < 100000000; i++) {
            try {
                t.method2(i);
            } catch (Exception e) {
                System.out.println("You'll never see this!");
            }
        }
        l = System.currentTimeMillis() - l;
        System.out.println(
            "method2 took " + l + " ms, result was " + t.getValue()
        );

        l = System.currentTimeMillis();
        t.reset();
        for (i = 1; i < 100000000; i++) {
            try {
                t.method3(i);
            } catch (Exception e) {
                // Do nothing here, as we will get here
            }
        }
        l = System.currentTimeMillis() - l;
        System.out.println(
            "method3 took " + l + " ms, result was " + t.getValue()
        );
    }
} 
```

结果：

```
method1 took 972 ms, result was 2
method2 took 1003 ms, result was 2
method3 took 66716 ms, result was 2 
```

try 块的减速太小，无法排除诸如后台进程之类的混杂因素。但是 catch 块杀死了一切，让它慢了 66 倍！

正如我所说，如果将 try/catch 和 throw 全部放在同一个方法（method3）中，结果不会那么糟糕，但这是我不会依赖的特殊 JIT 优化。即使使用这种优化，抛出仍然很慢。所以我不知道你想在这里做什么，但肯定有比使用 try/catch/throw 更好的方法。

* * *

## 回答 #2

> 赞同：275
> 
> 时间：2011-11-05T23:14:35.250

仅供参考，我扩展了 Mecki 所做的实验：

```
method1 took 1733 ms, result was 2
method2 took 1248 ms, result was 2
method3 took 83997 ms, result was 2
method4 took 1692 ms, result was 2
method5 took 60946 ms, result was 2
method6 took 25746 ms, result was 2 
```

前 3 个与 Mecki 的相同（我的笔记本电脑显然较慢）。

method4 与 method3 相同，只是它创建的是 a`new Integer(1)`而不是do `throw new Exception()`。

method5 与 method3 类似，不同之处在于它创建了`new Exception()`而不抛出它。

method6 与 method3 类似，只是它抛出一个预先创建的异常（实例变量）而不是创建一个新异常。

在 Java 中，抛出异常的大部分代价是收集堆栈跟踪所花费的时间，这发生在创建异常对象时。抛出异常的实际成本虽然很大，但远低于创建异常的成本。

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2015-01-21T19:21:43.567

Aleksey Shipilëv 进行了[非常彻底的分析](http://shipilev.net/blog/2014/exceptional-performance/)，他在各种条件组合下对 Java 异常进行了基准测试：

*   新创建的异常与预先创建的异常
*   堆栈跟踪启用与禁用
*   请求的堆栈跟踪与从未请求的堆栈跟踪
*   在顶层捕获vs在每个级别重新抛出vs在每个级别链接/包裹
*   各种级别的 Java 调用堆栈深度
*   没有内联优化 vs 极端内联 vs 默认设置
*   用户定义的字段读取与未读取

他还将它们与在不同错误频率级别检查错误代码的性能进行了比较。

结论（从他的帖子中逐字引用）是：

1.  **真正异常的异常表现出色。**如果您按设计使用它们，并且只在常规代码处理的大量非异常情况中传达真正的异常情况，那么使用异常就是性能优势。

2.  异常的性能成本有两个主要组成部分：实例化异常时的**堆栈跟踪构造**和异常抛出期间的**堆栈展开。**

3.  **堆栈跟踪构建成本与异常实例化时的**堆栈深度成正比。**这已经很糟糕了，因为地球上谁知道调用这个抛出方法的堆栈深度？即使关闭堆栈跟踪生成和/或缓存异常，也只能摆脱这部分性能成本。**

***   **堆栈展开成本取决于我们在编译代码中更接近异常处理程序的幸运程度。**仔细构造代码以避免深度异常处理程序查找可能有助于我们变得更幸运。

    *   **如果我们消除这两种影响，异常的性能成本就是本地分支的性能成本。**不管它听起来多么美妙，这并不意味着您应该使用异常作为通常的控制流，因为在这种情况下，**您将受制于优化编译器！**你应该只在真正例外的情况下使用它们，在这种情况下，异常频率**摊销**了引发实际异常的可能的不幸成本。

    *   乐观的经验法则似乎是**10^-4**的异常频率已经足够异常了。当然，这取决于异常本身的权重、异常处理程序中采取的确切操作等。** 

 **结果是，当不抛出异常时，您无需支付任何费用，因此当异常情况足够罕见时，异常处理比`if`每次都使用更快。完整的帖子非常值得一读。

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2011-04-10T07:30:53.980

不幸的是，我的回答太长了，无法在此处发布。因此，让我在这里总结一下，并推荐您参考[http://www.fuwjax.com/how-slow-are-java-exceptions/](http://www.fuwjax.com/how-slow-are-java-exceptions/)了解详细信息。

这里真正的问题不是“与'永不失败的代码'相比，'失败报告为异常'有多慢？” 正如您所接受的答复可能会让您相信的那样。相反，问题应该是“与以其他方式报告的故障相比，‘作为异常报告的故障’有多慢？” 通常，报告失败的另外两种方法是使用标记值或使用结果包装器。

哨兵值是在成功的情况下尝试返回一个类，在失败的情况下返回另一个类。您几乎可以将其视为返回异常而不是抛出异常。这需要一个与成功对象共享的父类，然后执行“instanceof”检查和几个强制转换以获得成功或失败信息。

事实证明，冒着类型安全的风险，Sentinel 值比异常值快，但只有大约 2 倍。现在，这可能看起来很多，但这 2 倍仅涵盖了实施差异的成本。在实践中，这个因素要低得多，因为我们可能失败的方法比本页其他地方的示例代码中的一些算术运算符更有趣。

另一方面，结果包装器根本不牺牲类型安全。它们将成功和失败信息包装在一个类中。因此，它们不是“instanceof”，而是为成功和失败对象提供“isSuccess()”和吸气剂。但是，结果对象比使用异常**慢大约 2 倍。**事实证明，每次创建一个新的包装对象比有时抛出异常要昂贵得多。

最重要的是，异常是提供指示方法可能失败的方式的语言。没有其他方法可以仅通过 API 来判断哪些方法应该总是（大部分）工作，哪些方法应该报告失败。

异常比哨兵更安全，比结果对象更快，而且比任何一个都不令人惊讶。我不是建议 try/catch 替换 if/else，但异常是报告失败的正确方法，即使在业务逻辑中也是如此。

也就是说，我想指出，我遇到过的两种最常见的严重影响性能的方法是创建不必要的对象和嵌套循环。如果您可以选择创建异常或不创建异常，请不要创建异常。如果您可以在有时创建异常或始终创建另一个对象之间进行选择，请创建异常。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2014-08-15T09:59:49.477

我扩展了[@Mecki](https://stackoverflow.com/a/299315/340290)和[@incarnate](https://stackoverflow.com/a/3980148/340290)给出的答案，没有为 Java 填充堆栈跟踪。

在 Java 7+ 中，我们可以使用`Throwable(String message, Throwable cause, boolean enableSuppression,boolean writableStackTrace)`. 但是对于 Java6，请参阅[我对这个问题的回答](https://stackoverflow.com/a/25324497/340290)

```
// This one will regularly throw one
public void method4(int i) throws NoStackTraceThrowable {
    value = ((value + i) / i) << 1;
    // i & 1 is equally fast to calculate as i & 0xFFFFFFF; it is both
    // an AND operation between two integers. The size of the number plays
    // no role. AND on 32 BIT always ANDs all 32 bits
    if ((i & 0x1) == 1) {
        throw new NoStackTraceThrowable();
    }
}

// This one will regularly throw one
public void method5(int i) throws NoStackTraceRuntimeException {
    value = ((value + i) / i) << 1;
    // i & 1 is equally fast to calculate as i & 0xFFFFFFF; it is both
    // an AND operation between two integers. The size of the number plays
    // no role. AND on 32 BIT always ANDs all 32 bits
    if ((i & 0x1) == 1) {
        throw new NoStackTraceRuntimeException();
    }
}

public static void main(String[] args) {
    int i;
    long l;
    Test t = new Test();

    l = System.currentTimeMillis();
    t.reset();
    for (i = 1; i < 100000000; i++) {
        try {
            t.method4(i);
        } catch (NoStackTraceThrowable e) {
            // Do nothing here, as we will get here
        }
    }
    l = System.currentTimeMillis() - l;
    System.out.println( "method4 took " + l + " ms, result was " + t.getValue() );

    l = System.currentTimeMillis();
    t.reset();
    for (i = 1; i < 100000000; i++) {
        try {
            t.method5(i);
        } catch (RuntimeException e) {
            // Do nothing here, as we will get here
        }
    }
    l = System.currentTimeMillis() - l;
    System.out.println( "method5 took " + l + " ms, result was " + t.getValue() );
} 
```

在 Core i7、8GB RAM 上使用 Java 1.6.0_45 输出：

```
method1 took 883 ms, result was 2
method2 took 882 ms, result was 2
method3 took 32270 ms, result was 2 // throws Exception
method4 took 8114 ms, result was 2 // throws NoStackTraceThrowable
method5 took 8086 ms, result was 2 // throws NoStackTraceRuntimeException 
```

因此，与抛出异常的方法相比，返回值的方法仍然更快。恕我直言，我们无法设计一个清晰的 API，只使用成功和错误流的返回类型。在没有堆栈跟踪的情况下抛出异常的方法比普通异常快 4-5 倍。

编辑：NoStackTraceThrowable.java*谢谢@Greg*

```
public class NoStackTraceThrowable extends Throwable { 
    public NoStackTraceThrowable() { 
        super("my special throwable", null, false, false);
    }
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-11-18T15:54:50.970

我认为第一篇文章提到遍历调用堆栈和创建堆栈跟踪的行为是昂贵的部分，虽然第二篇文章没有说，但我认为这是对象创建中最昂贵的部分。John Rose 有[一篇文章描述了加速异常的不同技术](http://blogs.oracle.com/jrose/entry/longjumps_considered_inexpensive)。（预分配和重用异常，没有堆栈跟踪的异常等）

但是 - 我认为这应该被认为只是一种必要的邪恶，最后的手段。John 这样做的原因是为了模拟 JVM 中（还没有）可用的其他语言的特性。您不应该养成使用控制流异常的习惯。尤其不是出于性能原因！正如您自己在 #2 中提到的那样，您可能会以这种方式掩盖代码中的严重错误，并且对于新程序员来说维护起来会更加困难。

Java 中的微基准测试非常难以正确（有人告诉过我），尤其是当您进入 JIT 领域时，所以我真的怀疑在现实生活中使用异常是否比“返回”更快。例如，我怀疑您的测试中有 2 到 5 个堆栈帧？现在想象您的代码将被 JBoss 部署的 JSF 组件调用。现在您可能有一个长达几页的堆栈跟踪。

也许您可以发布您的测试代码？

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-11-18T22:27:58.477

不久前，我编写了一个类来测试使用两种方法将字符串转换为整数的相对性能：(1) 调用 Integer.parseInt() 并捕获异常，或 (2) 将字符串与正则表达式匹配并调用 parseInt()只有匹配成功。我以最有效的方式使用了正则表达式（即，在循环之前创建 Pattern 和 Matcher 对象），并且我没有打印或保存异常的堆栈跟踪。

对于一万个字符串的列表，如果它们都是有效数字，则 parseInt() 方法的速度是正则表达式方法的四倍。但是如果只有 80% 的字符串是有效的，那么正则表达式的速度是 parseInt() 的两倍。如果 20% 是有效的，这意味着 80% 的时间会抛出并捕获异常，那么正则表达式的速度大约是 parseInt() 的 20 倍。

考虑到正则表达式方法两次处理有效字符串，我对结果感到惊讶：一次用于匹配，另一次用于 parseInt()。但是抛出和捕获异常不仅仅弥补了这一点。这种情况在现实世界中不太可能经常发生，但如果发生，则绝对不应该使用异常捕获技术。但是，如果您只是验证用户输入或类似的东西，请务必使用 parseInt() 方法。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2010-10-20T16:30:21.433

不知道这些主题是否相关，但我曾经想实现一个依赖于当前线程的堆栈跟踪的技巧：我想发现方法的名称，它触发了实例化类内部的实例化（是的，这个想法很疯狂，我完全放弃了）。所以我发现调用`Thread.currentThread().getStackTrace()`非常**慢**（由于`dumpThreads`它在内部使用的本机方法）。

所以 Java`Throwable`相应地有一个本地方法`fillInStackTrace`。我认为`catch`前面描述的杀手块以某种方式触发了该方法的执行。

但是让我告诉你另一个故事......

在 Scala 中，一些功能特性是在 JVM 中使用 编译的，它以下列方式`ControlThrowable`扩展`Throwable`和覆盖它：`fillInStackTrace`

```
override def fillInStackTrace(): Throwable = this 
```

所以我调整了上面的测试（循环量减少了十，我的机器有点慢:)：

```
class ControlException extends ControlThrowable

class T {
  var value = 0

  def reset = {
    value = 0
  }

  def method1(i: Int) = {
    value = ((value + i) / i) << 1
    if ((i & 0xfffffff) == 1000000000) {
      println("You'll never see this!")
    }
  }

  def method2(i: Int) = {
    value = ((value + i) / i) << 1
    if ((i & 0xfffffff) == 1000000000) {
      throw new Exception()
    }
  }

  def method3(i: Int) = {
    value = ((value + i) / i) << 1
    if ((i & 0x1) == 1) {
      throw new Exception()
    }
  }

  def method4(i: Int) = {
    value = ((value + i) / i) << 1
    if ((i & 0x1) == 1) {
      throw new ControlException()
    }
  }
}

class Main {
  var l = System.currentTimeMillis
  val t = new T
  for (i <- 1 to 10000000)
    t.method1(i)
  l = System.currentTimeMillis - l
  println("method1 took " + l + " ms, result was " + t.value)

  t.reset
  l = System.currentTimeMillis
  for (i <- 1 to 10000000) try {
    t.method2(i)
  } catch {
    case _ => println("You'll never see this")
  }
  l = System.currentTimeMillis - l
  println("method2 took " + l + " ms, result was " + t.value)

  t.reset
  l = System.currentTimeMillis
  for (i <- 1 to 10000000) try {
    t.method4(i)
  } catch {
    case _ => // do nothing
  }
  l = System.currentTimeMillis - l
  println("method4 took " + l + " ms, result was " + t.value)

  t.reset
  l = System.currentTimeMillis
  for (i <- 1 to 10000000) try {
    t.method3(i)
  } catch {
    case _ => // do nothing
  }
  l = System.currentTimeMillis - l
  println("method3 took " + l + " ms, result was " + t.value)

} 
```

所以，结果是：

```
method1 took 146 ms, result was 2
method2 took 159 ms, result was 2
method4 took 1551 ms, result was 2
method3 took 42492 ms, result was 2 
```

`method3`你看，和之间的唯一区别`method4`是它们抛出不同类型的异常。是的，`method4`仍然比`method1`and慢`method2`，但差异更容易接受。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-18T16:41:13.840

我已经使用 JVM 1.5 进行了一些性能测试，并且使用异常至少慢了 2 倍。平均而言：一个微不足道的小方法的执行时间增加了三倍以上 (3x)，但有异常。一个必须捕获异常的微不足道的小循环使自时间增加了 2 倍。

我在生产代码和微基准测试中看到了类似的数字。

异常绝对***不***应该用于任何经常调用的东西。每秒抛出数千个异常会导致巨大的瓶颈。

例如，使用“Integer.ParseInt(...)”在一个非常大的文本文件中查找所有错误值——这是个非常糟糕的主意。（我已经看到这个实用方法会在生产代码上*杀死性能）*

使用异常报告用户 GUI 表单上的错误值，从性能的角度来看可能还不错。

无论它是否是一个好的设计实践，我都会遵循规则：如果错误是正常/预期的，则使用返回值。如果不正常，使用异常。例如：读取用户输入，错误值是正常的——使用错误代码。将值传递给内部实用函数，应通过调用代码过滤错误值——使用异常。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-03-18T00:00:36.173

Java 和 C# 中的异常性能还有很多不足之处。

作为程序员，这迫使我们遵守“应不经常引起异常”的规则，仅仅是出于实际性能原因。

然而，作为计算机科学家，我们应该反对这种有问题的状态。编写函数的人通常不知道调用它的频率，或者成功或失败的可能性更大。只有调用者有此信息。试图避免异常会导致不清楚的 API 习惯，在某些情况下，我们只有干净但缓慢的异常版本，而在其他情况下，我们会遇到快速但笨拙的返回值错误，而在其他情况下，我们最终会同时出现这两种情况. 库实现者可能必须编写和维护两个版本的 API，调用者必须决定在每种情况下使用两个版本中的哪一个。

这有点乱。如果异常具有更好的性能，我们可以避免使用这些笨拙的习惯用法并使用异常，因为它们本来应该被使用......作为结构化的错误返回工具。

我真的很想看到使用更接近返回值的技术实现异常机制，因此我们可以让性能更接近返回值。因为这是我们在性能敏感代码中恢复的内容。

这是一个将异常性能与错误返回值性能进行比较的代码示例。

公共类 TestIt {

```
int value;

public int getValue() {
    return value;
}

public void reset() {
    value = 0;
}

public boolean baseline_null(boolean shouldfail, int recurse_depth) {
    if (recurse_depth <= 0) {
        return shouldfail;
    } else {
        return baseline_null(shouldfail,recurse_depth-1);
    }
}

public boolean retval_error(boolean shouldfail, int recurse_depth) {
    if (recurse_depth <= 0) {
        if (shouldfail) {
            return false;
        } else {
            return true;
        }
    } else {
        boolean nested_error = retval_error(shouldfail,recurse_depth-1);
        if (nested_error) {
            return true;
        } else {
            return false;
        }
    }
}

public void exception_error(boolean shouldfail, int recurse_depth) throws Exception {
    if (recurse_depth <= 0) {
        if (shouldfail) {
            throw new Exception();
        }
    } else {
        exception_error(shouldfail,recurse_depth-1);
    }

}

public static void main(String[] args) {
    int i;
    long l;
    TestIt t = new TestIt();
    int failures;

    int ITERATION_COUNT = 100000000;

    // (0) baseline null workload
    for (int recurse_depth = 2; recurse_depth <= 10; recurse_depth+=3) {
        for (float exception_freq = 0.0f; exception_freq <= 1.0f; exception_freq += 0.25f) {            
            int EXCEPTION_MOD = (exception_freq == 0.0f) ? ITERATION_COUNT+1 : (int)(1.0f / exception_freq);            

            failures = 0;
            long start_time = System.currentTimeMillis();
            t.reset();              
            for (i = 1; i < ITERATION_COUNT; i++) {
                boolean shoulderror = (i % EXCEPTION_MOD) == 0;
                t.baseline_null(shoulderror,recurse_depth);
            }
            long elapsed_time = System.currentTimeMillis() - start_time;
            System.out.format("baseline: recurse_depth %s, exception_freqeuncy %s (%s), time elapsed %s ms\n",
                    recurse_depth, exception_freq, failures,elapsed_time);
        }
    }

    // (1) retval_error
    for (int recurse_depth = 2; recurse_depth <= 10; recurse_depth+=3) {
        for (float exception_freq = 0.0f; exception_freq <= 1.0f; exception_freq += 0.25f) {            
            int EXCEPTION_MOD = (exception_freq == 0.0f) ? ITERATION_COUNT+1 : (int)(1.0f / exception_freq);            

            failures = 0;
            long start_time = System.currentTimeMillis();
            t.reset();              
            for (i = 1; i < ITERATION_COUNT; i++) {
                boolean shoulderror = (i % EXCEPTION_MOD) == 0;
                if (!t.retval_error(shoulderror,recurse_depth)) {
                    failures++;
                }
            }
            long elapsed_time = System.currentTimeMillis() - start_time;
            System.out.format("retval_error: recurse_depth %s, exception_freqeuncy %s (%s), time elapsed %s ms\n",
                    recurse_depth, exception_freq, failures,elapsed_time);
        }
    }

    // (2) exception_error
    for (int recurse_depth = 2; recurse_depth <= 10; recurse_depth+=3) {
        for (float exception_freq = 0.0f; exception_freq <= 1.0f; exception_freq += 0.25f) {            
            int EXCEPTION_MOD = (exception_freq == 0.0f) ? ITERATION_COUNT+1 : (int)(1.0f / exception_freq);            

            failures = 0;
            long start_time = System.currentTimeMillis();
            t.reset();              
            for (i = 1; i < ITERATION_COUNT; i++) {
                boolean shoulderror = (i % EXCEPTION_MOD) == 0;
                try {
                    t.exception_error(shoulderror,recurse_depth);
                } catch (Exception e) {
                    failures++;
                }
            }
            long elapsed_time = System.currentTimeMillis() - start_time;
            System.out.format("exception_error: recurse_depth %s, exception_freqeuncy %s (%s), time elapsed %s ms\n",
                    recurse_depth, exception_freq, failures,elapsed_time);              
        }
    }
} 
```

}

结果如下：

```
baseline: recurse_depth 2, exception_freqeuncy 0.0 (0), time elapsed 683 ms
baseline: recurse_depth 2, exception_freqeuncy 0.25 (0), time elapsed 790 ms
baseline: recurse_depth 2, exception_freqeuncy 0.5 (0), time elapsed 768 ms
baseline: recurse_depth 2, exception_freqeuncy 0.75 (0), time elapsed 749 ms
baseline: recurse_depth 2, exception_freqeuncy 1.0 (0), time elapsed 731 ms
baseline: recurse_depth 5, exception_freqeuncy 0.0 (0), time elapsed 923 ms
baseline: recurse_depth 5, exception_freqeuncy 0.25 (0), time elapsed 971 ms
baseline: recurse_depth 5, exception_freqeuncy 0.5 (0), time elapsed 982 ms
baseline: recurse_depth 5, exception_freqeuncy 0.75 (0), time elapsed 947 ms
baseline: recurse_depth 5, exception_freqeuncy 1.0 (0), time elapsed 937 ms
baseline: recurse_depth 8, exception_freqeuncy 0.0 (0), time elapsed 1154 ms
baseline: recurse_depth 8, exception_freqeuncy 0.25 (0), time elapsed 1149 ms
baseline: recurse_depth 8, exception_freqeuncy 0.5 (0), time elapsed 1133 ms
baseline: recurse_depth 8, exception_freqeuncy 0.75 (0), time elapsed 1117 ms
baseline: recurse_depth 8, exception_freqeuncy 1.0 (0), time elapsed 1116 ms
retval_error: recurse_depth 2, exception_freqeuncy 0.0 (0), time elapsed 742 ms
retval_error: recurse_depth 2, exception_freqeuncy 0.25 (24999999), time elapsed 743 ms
retval_error: recurse_depth 2, exception_freqeuncy 0.5 (49999999), time elapsed 734 ms
retval_error: recurse_depth 2, exception_freqeuncy 0.75 (99999999), time elapsed 723 ms
retval_error: recurse_depth 2, exception_freqeuncy 1.0 (99999999), time elapsed 728 ms
retval_error: recurse_depth 5, exception_freqeuncy 0.0 (0), time elapsed 920 ms
retval_error: recurse_depth 5, exception_freqeuncy 0.25 (24999999), time elapsed 1121   ms
retval_error: recurse_depth 5, exception_freqeuncy 0.5 (49999999), time elapsed 1037 ms
retval_error: recurse_depth 5, exception_freqeuncy 0.75 (99999999), time elapsed 1141   ms
retval_error: recurse_depth 5, exception_freqeuncy 1.0 (99999999), time elapsed 1130 ms
retval_error: recurse_depth 8, exception_freqeuncy 0.0 (0), time elapsed 1218 ms
retval_error: recurse_depth 8, exception_freqeuncy 0.25 (24999999), time elapsed 1334  ms
retval_error: recurse_depth 8, exception_freqeuncy 0.5 (49999999), time elapsed 1478 ms
retval_error: recurse_depth 8, exception_freqeuncy 0.75 (99999999), time elapsed 1637 ms
retval_error: recurse_depth 8, exception_freqeuncy 1.0 (99999999), time elapsed 1655 ms
exception_error: recurse_depth 2, exception_freqeuncy 0.0 (0), time elapsed 726 ms
exception_error: recurse_depth 2, exception_freqeuncy 0.25 (24999999), time elapsed 17487   ms
exception_error: recurse_depth 2, exception_freqeuncy 0.5 (49999999), time elapsed 33763   ms
exception_error: recurse_depth 2, exception_freqeuncy 0.75 (99999999), time elapsed 67367   ms
exception_error: recurse_depth 2, exception_freqeuncy 1.0 (99999999), time elapsed 66990 ms
exception_error: recurse_depth 5, exception_freqeuncy 0.0 (0), time elapsed 924 ms
exception_error: recurse_depth 5, exception_freqeuncy 0.25 (24999999), time elapsed 23775  ms
exception_error: recurse_depth 5, exception_freqeuncy 0.5 (49999999), time elapsed 46326 ms
exception_error: recurse_depth 5, exception_freqeuncy 0.75 (99999999), time elapsed 91707 ms
exception_error: recurse_depth 5, exception_freqeuncy 1.0 (99999999), time elapsed 91580 ms
exception_error: recurse_depth 8, exception_freqeuncy 0.0 (0), time elapsed 1144 ms
exception_error: recurse_depth 8, exception_freqeuncy 0.25 (24999999), time elapsed 30440 ms
exception_error: recurse_depth 8, exception_freqeuncy 0.5 (49999999), time elapsed 59116   ms
exception_error: recurse_depth 8, exception_freqeuncy 0.75 (99999999), time elapsed 116678 ms
exception_error: recurse_depth 8, exception_freqeuncy 1.0 (99999999), time elapsed 116477 ms 
```

检查和传播返回值确实会增加一些与基线空调用相比的成本，并且该成本与调用深度成正比。在调用链深度为 8 时，错误返回值检查版本比不检查返回值的基线版本慢约 27%。

相比之下，异常性能不是调用深度的函数，而是异常频率的函数。然而，随着异常频率的增加，降级更为显着。只有 25% 的错误频率，代码运行速度慢了 24 倍。在 100% 的错误频率下，异常版本几乎慢了 100 倍。

这向我表明，可能在我们的异常实现中做出了错误的权衡。异常可以更快，要么通过避免代价高昂的跟踪，要么直接将它们转变为编译器支持的返回值检查。在他们这样做之前，当我们希望我们的代码快速运行时，我们会一直避开它们。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-18T16:07:25.580

HotSpot 非常有能力删除系统生成的异常的异常代码，只要它都是内联的。但是，显式创建的异常和那些没有被删除的异常会花费大量时间来创建堆栈跟踪。覆盖`fillInStackTrace`以查看这如何影响性能。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-18T15:35:38.607

即使抛出异常并不慢，但为正常的程序流抛出异常仍然是一个坏主意。以这种方式使用它类似于 GOTO...

我想这并不能真正回答这个问题。我想在早期的java版本（<1.4）中抛出异常缓慢的“传统”智慧是正确的。创建异常需要 VM 创建整个堆栈跟踪。从那时起，为了加快速度，VM 发生了很多变化，这可能是一个已经改进的领域。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-01-04T17:14:26.473

只需将我们说 Integer.parseInt 与以下方法进行比较，该方法仅在无法解析数据的情况下返回默认值，而不是抛出异常：

```
 public static int parseUnsignedInt(String s, int defaultValue) {
    final int strLength = s.length();
    if (strLength == 0)
      return defaultValue;
    int value = 0;
    for (int i=strLength-1; i>=0; i--) {
      int c = s.charAt(i);
      if (c > 47 && c < 58) {
        c -= 48;
        for (int j=strLength-i; j!=1; j--)
          c *= 10;
        value += c;
      } else {
        return defaultValue;
      }
    }
    return value < 0 ? /* übergebener wert > Integer.MAX_VALUE? */ defaultValue : value;
  } 
```

只要您将这两种方法应用于“有效”数据，它们就会以大致相同的速率工作（即使 Integer.parseInt 设法处理更复杂的数据）。但是，一旦您尝试解析无效数据（例如，解析“abc”1.000.000 次），性能上的差异应该是必不可少的。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-03-21T19:38:56.507

关于异常性能的好帖子是：

[https://shipilev.net/blog/2014/exceptional-performance/](https://shipilev.net/blog/2014/exceptional-performance/)

实例化与重用现有的，有堆栈跟踪和没有，等等：

```
Benchmark                            Mode   Samples         Mean   Mean error  Units

dynamicException                     avgt        25     1901.196       14.572  ns/op
dynamicException_NoStack             avgt        25       67.029        0.212  ns/op
dynamicException_NoStack_UsedData    avgt        25       68.952        0.441  ns/op
dynamicException_NoStack_UsedStack   avgt        25      137.329        1.039  ns/op
dynamicException_UsedData            avgt        25     1900.770        9.359  ns/op
dynamicException_UsedStack           avgt        25    20033.658      118.600  ns/op

plain                                avgt        25        1.259        0.002  ns/op
staticException                      avgt        25        1.510        0.001  ns/op
staticException_NoStack              avgt        25        1.514        0.003  ns/op
staticException_NoStack_UsedData     avgt        25        4.185        0.015  ns/op
staticException_NoStack_UsedStack    avgt        25       19.110        0.051  ns/op
staticException_UsedData             avgt        25        4.159        0.007  ns/op
staticException_UsedStack            avgt        25       25.144        0.186  ns/op 
```

根据堆栈跟踪的深度：

```
Benchmark        Mode   Samples         Mean   Mean error  Units

exception_0000   avgt        25     1959.068       30.783  ns/op
exception_0001   avgt        25     1945.958       12.104  ns/op
exception_0002   avgt        25     2063.575       47.708  ns/op
exception_0004   avgt        25     2211.882       29.417  ns/op
exception_0008   avgt        25     2472.729       57.336  ns/op
exception_0016   avgt        25     2950.847       29.863  ns/op
exception_0032   avgt        25     4416.548       50.340  ns/op
exception_0064   avgt        25     6845.140       40.114  ns/op
exception_0128   avgt        25    11774.758       54.299  ns/op
exception_0256   avgt        25    21617.526      101.379  ns/op
exception_0512   avgt        25    42780.434      144.594  ns/op
exception_1024   avgt        25    82839.358      291.434  ns/op 
```

有关其他详细信息（包括来自 JIT 的 x64 汇编程序），请阅读原始博客文章。

这意味着 Hibernate/Spring/etc-EE-shit 由于异常 (xD) 而运行缓慢。

通过重写应用程序控制流并避免异常（将错误返回为 a `return`）将应用程序的性能提高 10 倍至 100 倍，具体取决于您抛出它们的频率））

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-02-22T17:34:24.107

使用附带的代码，在 JDK 15 上，@Mecki 测试用例得到了完全不同的结果。这基本上在 5 个循环中运行代码，第一个循环稍短一些，以便给 VM 一些时间来预热。

结果：

```
Loop 1 10000 cycles
method1 took 1 ms, result was 2
method2 took 0 ms, result was 2
method3 took 22 ms, result was 2
method4 took 22 ms, result was 2
method5 took 24 ms, result was 2
Loop 2 10000000 cycles
method1 took 39 ms, result was 2
method2 took 39 ms, result was 2
method3 took 1558 ms, result was 2
method4 took 1640 ms, result was 2
method5 took 1717 ms, result was 2
Loop 3 10000000 cycles
method1 took 49 ms, result was 2
method2 took 48 ms, result was 2
method3 took 126 ms, result was 2
method4 took 88 ms, result was 2
method5 took 87 ms, result was 2
Loop 4 10000000 cycles
method1 took 34 ms, result was 2
method2 took 34 ms, result was 2
method3 took 33 ms, result was 2
method4 took 98 ms, result was 2
method5 took 58 ms, result was 2
Loop 5 10000000 cycles
method1 took 34 ms, result was 2
method2 took 33 ms, result was 2
method3 took 33 ms, result was 2
method4 took 48 ms, result was 2
method5 took 49 ms, result was 2 
```

```
package hs.jfx.eventstream.api;

public class Snippet {
  int value;

  public int getValue() {
      return value;
  }

  public void reset() {
      value = 0;
  }

  // Calculates without exception
  public void method1(int i) {
      value = ((value + i) / i) << 1;
      // Will never be true
      if ((i & 0xFFFFFFF) == 1000000000) {
          System.out.println("You'll never see this!");
      }
  }

  // Could in theory throw one, but never will
  public void method2(int i) throws Exception {
      value = ((value + i) / i) << 1;
      // Will never be true
      if ((i & 0xFFFFFFF) == 1000000000) {
          throw new Exception();
      }
  }

  private static final NoStackTraceRuntimeException E = new NoStackTraceRuntimeException();

  // This one will regularly throw one
  public void method3(int i) throws NoStackTraceRuntimeException {
      value = ((value + i) / i) << 1;
      // i & 1 is equally fast to calculate as i & 0xFFFFFFF; it is both
      // an AND operation between two integers. The size of the number plays
      // no role. AND on 32 BIT always ANDs all 32 bits
      if ((i & 0x1) == 1) {
          throw E;
      }
  }

  // This one will regularly throw one
  public void method4(int i) throws NoStackTraceThrowable {
      value = ((value + i) / i) << 1;
      // i & 1 is equally fast to calculate as i & 0xFFFFFFF; it is both
      // an AND operation between two integers. The size of the number plays
      // no role. AND on 32 BIT always ANDs all 32 bits
      if ((i & 0x1) == 1) {
          throw new NoStackTraceThrowable();
      }
  }

  // This one will regularly throw one
  public void method5(int i) throws NoStackTraceRuntimeException {
      value = ((value + i) / i) << 1;
      // i & 1 is equally fast to calculate as i & 0xFFFFFFF; it is both
      // an AND operation between two integers. The size of the number plays
      // no role. AND on 32 BIT always ANDs all 32 bits
      if ((i & 0x1) == 1) {
          throw new NoStackTraceRuntimeException();
      }
  }

  public static void main(String[] args) {
    for(int k = 0; k < 5; k++) {
      int cycles = 10000000;
      if(k == 0) {
        cycles = 10000;
        try {
          Thread.sleep(500);
        }
        catch(InterruptedException e) {
          // TODO Auto-generated catch block
          e.printStackTrace();
        }
      }
      System.out.println("Loop " + (k + 1) + " " + cycles + " cycles");
      int i;
      long l;
      Snippet t = new Snippet();

      l = System.currentTimeMillis();
      t.reset();
      for (i = 1; i < cycles; i++) {
          t.method1(i);
      }
      l = System.currentTimeMillis() - l;
      System.out.println(
          "method1 took " + l + " ms, result was " + t.getValue()
      );

      l = System.currentTimeMillis();
      t.reset();
      for (i = 1; i < cycles; i++) {
          try {
              t.method2(i);
          } catch (Exception e) {
              System.out.println("You'll never see this!");
          }
      }
      l = System.currentTimeMillis() - l;
      System.out.println(
          "method2 took " + l + " ms, result was " + t.getValue()
      );

      l = System.currentTimeMillis();
      t.reset();
      for (i = 1; i < cycles; i++) {
          try {
              t.method3(i);
          } catch (NoStackTraceRuntimeException e) {
            // always comes here
          }
      }
      l = System.currentTimeMillis() - l;
      System.out.println(
          "method3 took " + l + " ms, result was " + t.getValue()
      );

      l = System.currentTimeMillis();
      t.reset();
      for (i = 1; i < cycles; i++) {
          try {
              t.method4(i);
          } catch (NoStackTraceThrowable e) {
            // always comes here
          }
      }
      l = System.currentTimeMillis() - l;
      System.out.println( "method4 took " + l + " ms, result was " + t.getValue() );

      l = System.currentTimeMillis();
      t.reset();
      for (i = 1; i < cycles; i++) {
          try {
              t.method5(i);
          } catch (RuntimeException e) {
            // always comes here
          }
      }
      l = System.currentTimeMillis() - l;
      System.out.println( "method5 took " + l + " ms, result was " + t.getValue() );
    }
  }

  public static class NoStackTraceRuntimeException extends RuntimeException {
    public NoStackTraceRuntimeException() {
        super("my special throwable", null, false, false);
    }
  }

  public static class NoStackTraceThrowable extends Throwable {
    public NoStackTraceThrowable() {
        super("my special throwable", null, false, false);
    }
  }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-11-08T17:55:39.130

我在上面更改了@Mecki 的答案，让 method1 返回一个布尔值并检查调用方法，因为您不能只用任何内容替换 Exception 。两次运行后，method1 仍然是最快的，或者与 method2 一样快。

这是代码的快照：

```
// Calculates without exception
public boolean method1(int i) {
    value = ((value + i) / i) << 1;
    // Will never be true
    return ((i & 0xFFFFFFF) == 1000000000);

}
....
   for (i = 1; i < 100000000; i++) {
            if (t.method1(i)) {
                System.out.println("Will never be true!");
            }
    } 
```

和结果：

运行 1

```
method1 took 841 ms, result was 2
method2 took 841 ms, result was 2
method3 took 85058 ms, result was 2 
```

运行 2

```
method1 took 821 ms, result was 2
method2 took 838 ms, result was 2
method3 took 85929 ms, result was 2 
```

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2015-09-12T18:00:04.610

我对异常速度与以编程方式检查数据的看法。

许多类都有字符串到值的转换器（扫描器/解析器），也有受人尊敬和知名的库；）

通常有形式

```
class Example {
public static Example Parse(String input) throws AnyRuntimeParsigException
...
} 
```

异常名称只是示例，通常是未选中的（运行时），所以 throws 声明只是我的图片

有时存在第二种形式：

```
public static Example Parse(String input, Example defaultValue) 
```

从不投掷

当第二个 ins 不可用（或者程序员阅读的文档太少并且只使用第一个）时，使用正则表达式编写这样的代码。正则表达式很酷，政治正确等：

```
Xxxxx.regex(".....pattern", src);
if(ImTotallySure)
{
  Example v = Example.Parse(src);
} 
```

有了这个代码，程序员就没有异常成本。但是，正则表达式的成本非常高，有时异常的成本很小。

我几乎总是在这种情况下使用

```
try { parse } catch(ParsingException ) // concrete exception from javadoc
{
} 
```

在不分析堆栈跟踪等的情况下，我相信在您的讲座之后相当快。

不要害怕例外

* * *

## 回答 #18

> 赞同：-6
> 
> 时间：2008-11-18T15:41:09.483

为什么异常应该比正常回报慢？

只要您不将堆栈跟踪打印到终端，将其保存到文件或类似文件中，catch 块就不会比其他代码块做更多的工作。所以，我无法想象为什么“throw new my_cool_error()”会这么慢。

好问题，我期待有关此主题的更多信息！

# ant - 如果出现编译错误，如何（忽略|继续）gant-build？

> ID：299075
> 
> 赞同：0
> 
> 时间：2008-11-18T15:31:46.213
> 
> 标签：ant, gant

有人知道我如何运行忽略构建错误的 gant 构建吗？像 ant 和 make 之类的东西正在使用 '-k' 或 '-keep-going' 开关。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-01T18:50:22.283

-k 标志尚未添加到 gant，afaik。您可以在此处提交功能请求：

[http://jira.codehaus.org/browse/GANT](http://jira.codehaus.org/browse/GANT)

# methodology - 扩展文学编程？

> ID：299076
> 
> 赞同：17
> 
> 时间：2008-11-18T15:33:48.250
> 
> 标签：methodology, literate-programming

问候。我现在一直在看文学编程，我确实喜欢它背后的想法：你基本上写了一篇关于你的代码的小论文，并写下尽可能多的设计决策，代码可能围绕模块，内部工作由设计决策、潜在扩展产生的模块、假设和结论，所有这些都可以使用 tex 以一种很好的方式写下来。当然，第一点：它是文档。它必须保持最新，但这不应该那么糟糕，因为你的改变应该有一个理由，你可以把它写下来。

但是，文学编程如何在更大程度上扩展？总的来说，文学编程仍然只是文本。当然，文本是人类可读的，但仍然是文本，因此很难遵循大型系统。例如，我修改了编译器的大部分以使用 >> 和一些魔法将编译步骤链接在一起，因为一些 "x.register_follower(y); y.register_follower(z); y.register_follower(a);... " 变得非常笨拙，将其更改为 x >> y >> z >> a 使它变得更好一些，即使这也处于临界点。

那么，文学编程如何扩展到更大的系统？有人尝试这样做吗？

我的想法是使用 LP 来指定使用事件流相互通信的组件，并使用 graphviz 的子集将所有这些链接在一起。这将是 LP 的一个相当自然的扩展，因为您可以从网络中提取文档——数据流图——并且还可以很好地从中生成代码。你怎么看呢？

——特萨。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-18T16:14:20.870

“基于物理的渲染”一书[（pbrt.org）](http://www.pbrt.org/)是我所知道的大规模读写编程的最佳示例。本书实现了一套完整的渲染系统，书本和光线追踪代码都是从同一个“源”生成的。

在实践中，我发现仅仅使用像 Doxygen 这样的系统并真正深入挖掘并利用它的所有功能比完全成熟的“文学”编程要好，除了诸如教科书、教育材料之类的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T15:52:37.357

很好的问题。文学编程的动机永远不会消失，但我认为它应该被视为流动的。它的意思是“让读者休息一下，并教育他们你正在尝试做的事情”。我不认为这意味着“让你的代码真的很罗嗦”。

也就是说，读者将不得不付出一些努力，这取决于他们已经知道的内容。大概代码是值得理解的，没有什么是免费的。

我也认为这不仅仅意味着编写可读的代码。某人阅读代码的原因很可能是因为他们需要进行更改。您应该预测可能需要的更改，并在必要时告诉他们如何进行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-18T16:38:36.780

大约 15 年前，我使用 WEB 进行了一些文学编程。最近，我尝试从 wiki 提取代码并从 Squeak Smalltalk 环境生成文档。

自下而上的部分可以通过从 TDD/BDD 框架生成文档来处理得比较好，但 LP 侧重于向读者解释代码。

有几个问题：

*   对于不同的利益相关者/读者来说，要讲述的故事是不同的；
*   大多数环境中的项目结构不是讲故事所需的结构；
*   缺少对连续改进/披露的支持；
*   除了需要对图片的文字支持；
*   从源代码控制系统中的注释可以得出系统是如何构建的。故事应该是系统是如何构建的（事后看来）。

要使 LP 用于更大的系统，您需要比 wiki 或对象浏览器更好的 IDE 支持。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-03-31T10:38:43.663

> “总的来说，文学编程仍然只是文本”

错误的。

图表很好。

> 我的想法是使用 LP 来指定使用事件流相互通信的组件

这只是建筑，这很好。

> 你可以从网上提取一个文档——一个数据流图——也可以很好地从中生成代码。你怎么看呢？

数据流图对于生成详细的代码并没有那么大的帮助。它们是方便的摘要，而不是精确的信息来源。

一个好的书写工具（如 LaTex）可以在文档中对图表进行编码。您可能可以从文档的其他部分找到一种方法。

**底线**

从长远来看，您最好生成图表作为文本的摘要。

为什么？

图表故意省略了细节。图表是摘要或概述。但是作为代码的来源，图表很糟糕。为了提供*所有*细节，图表变得非常混乱。

但是其他一些 LP 标记的图表总结会很好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-18T16:18:37.927

[pbrt](http://www.pbrt.org/)是一个基于物理的光线追踪器，以文学风格编写，用于计算机科学毕业生（和我）的教育，它是一个中等规模的系统。作为非专业程序员，这一级别的文档对于理解程序做什么以及为什么这样做是非常重要的。

我还可以使用 Java 中的研究渲染器，它写得很好，但相对没有文档，但有一些 SIGGRAPH 论文。这也是相对可以理解的，但我也可以接触到作者。

我也经常使用[ImageJ](http://rsbweb.nih.gov/ij/developer/index.html)，并在底层 Java 的底层进行了研究——如果不了解底层哲学，就很难理解。

总而言之，我的观点是，如果有人能抽出时间把它做好，那么识字编程是很棒的，这很可能是在教育环境中。很难看到它在商业代码生产中完成。我对代码可以完全自我记录的想法持怀疑态度。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-01-11T02:48:57.407

文学编程背后的想法是强调文档，代码散布在文档中，而不是注释散布在代码中。

这是一种本质上不同的理念，更长的变量名、命名空间和类等差异不会影响理念。文学编程提倡有意义的变量名。

它可以扩展到更大的系统，因为文档与代码的基本比例与代码大小成线性关系。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-03-11T11:09:48.730

12.5年后，终于有了一些有希望的发展。[GToolkit](https://gtoolkit.com)提供了集成的多个视图、入口点和工具来做好文学编程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T15:41:02.933

文学编程是在一个根本不可能长变量和函数名称的时代发展起来的。正因为如此，代码真的不那么可读。

显然，从那以后发生了很多事情。

在当今世界，代码本身就是文档，因此称为“自文档化代码”。实现是没有一组注释或外部文档可以与底层代码保持同步。因此，当今许多程序员的目标是以其他人可读的方式编写代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-24T06:46:01.943

Try NanoLP - LP 可扩展工具，支持多种文档格式（Markdown、OpenOffice、Creole、TeX、Asciidoc 等）、导入其他 LP 程序、模板等。用户可以添加自己的命令/宏（在 Python 中），例如进行特殊导入，例如从 VCS... [http://code.google.com/p/nano-lp](http://code.google.com/p/nano-lp)

# java - 为什么这个带有多个“或”语句的代码比在 Java 中使用查找表要快一些？

> ID：299079
> 
> 赞同：10
> 
> 时间：2008-11-18T15:34:34.023
> 
> 标签：java, optimization

[在查看我昨天（此处](https://stackoverflow.com/questions/295579/fastest-way-to-determine-if-an-integers-square-root-is-an-integer)）提出的一个微优化问题时，我发现了一些奇怪的东西：`or`Java 中的语句运行速度*比*在布尔数组中查找布尔值要快一些。

`long`在我的测试中，在0 到 10 亿的值上运行以下算法，alg1 的速度大约快 2%。（我改变了算法的测试顺序，得到了相同的结果）。我的问题是：**为什么 alg1 更快？** 我本来预计 alg2 会稍微快一些，因为它使用了一个查找表，而 alg1 必须对 75% 的输入执行 4 次比较和 3 次或操作。

```
private final static boolean alg1(long n)
{
  int h = (int)(n & 0xF);
  if(h == 0 || h == 1 || h == 4 || h == 9)
  {
    long tst = (long)Math.sqrt(n);
    return tst*tst == n;
  }  
  return false;

}

private final static boolean[] lookup = new boolean[16];
static
{
  lookup[0] = lookup[1] = lookup[4] = lookup[9] = true;
}
private final static boolean alg2(long n)
{
  if(lookup[(int)(n & 0xF)])
  {
    long tst = (long)Math.sqrt(n);
    return tst*tst == n;
  }
  else
    return false;
} 
```

*如果你很好奇，这段代码正在测试一个数字是否是一个完美的正方形，并利用了完美的正方形必须以十六进制的 0、1、4 或 9 结尾的事实。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-18T16:02:39.317

加载一些随机数据通常比一些非分支代码慢。

当然，这一切都取决于处理器架构。您的第一个 if 语句可以实现为四个指令。第二个可能需要空指针检查、边界检查以及加载和比较。此外，更多的代码意味着更多的编译时间，以及更多以某种方式阻碍优化的机会。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T15:41:29.360

我*猜想*问题是数组的范围检查以及数组查找是否作为方法调用实现。这肯定会使 4 次直接 int 比较黯然失色。你看过字节码吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T15:41:21.043

根据[这篇文章](http://www.javaworld.com/javaworld/jw-09-1998/jw-09-speed.html?page=6)，访问数组元素是“访问非数组元素的 2 或 3 倍”。您的测试表明差异可能更大。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T03:52:06.717

在当前示例中，我同意边界检查可能是让您感到高兴的原因（为什么 JVM 不优化这一点超出了我的理解 - 示例代码可以确定地显示为不会溢出......

另一种可能性（特别是对于更大的查找表）是缓存延迟......这取决于处理器寄存器的大小以及 JVM 如何选择使用它们 - 但如果字节数组没有完全保留在处理器上，那么你与简单的 OR 相比，会看到性能下降，因为每次检查都会将阵列拉到 CPU 上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T00:11:28.377

这是一段有趣的代码，但 2% 是一个非常小的差异。我认为你不能从中得出很多结论。

# c# - 在 C# 应用程序中模仿 SQL Server Profiler？

> ID：299080
> 
> 赞同：3
> 
> 时间：2008-11-18T15:35:16.970
> 
> 标签：c#, sql-server, trace, smo, sql-server-profiler

我想从我的 C# 应用程序在数据库服务器上创建跟踪，就像您在 SQL Server Profiler 中所做的那样。我发现似乎不适用于我的 SQL 管理工作室的存储过程（sys.sp_trace_create 等）。我想知道是否有人可以帮助编码，或者我会从哪里开始？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T15:46:40.550

您是否希望它是实时的，就像 Profiler 本身一样？那将很难做到。你基本上会重新创建分析器。

如果这不是必需的，我建议只需调用您发现的 sp_trace_create 存储过程来启动服务器端跟踪，然后使用您的应用程序打开此跟踪生成的文件。

了解其工作原理的最简单方法是运行 SQL Profiler 本身，设置所需的所有选项，然后单击“运行”，然后立即单击“停止”。然后转到文件、导出、脚本跟踪定义，并选择适当的版本。

这应该会为您提供一个 TSQL 脚本，它将所有正确的部分放在一起，包括所有跟踪事件、列等。

探查器的更多技术历史：[这篇旧的 SQLMag 文章](http://www.microsoft.com/technet/prodtechnol/sql/70/tips/sqlprof.mspx)有一些探查器的历史，它在引入 SQL 7.0 时取代了一个名为“SQL Trace”的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T03:59:55.033

如果您仍然感兴趣，请找到此代码

```
public void FileToTable()
{
    TraceServer reader = new TraceServer();

    ConnectionInfoBase ci = new SqlConnectionInfo("localhost");
    ((SqlConnectionInfo)ci).UseIntegratedSecurity = true;

    reader.InitializeAsReader(ci, @"Standard.tdf");

    int eventNumber = 0;

    while (reader.Read())
    {
        Console.Write( "{0}\n", reader.GetValue(0).ToString() );
    }
    reader.Close();        
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T16:18:32.280

如果您使用的是 LINQ to SQL，那么它生成的所有 SQL 命令都可以发送到输出窗口（如果需要，也可以记录到文件中）。见这里：[http ://www.u2u.info/Blogs/Kris/Lists/Posts/Post.aspx?ID=11](http://www.u2u.info/Blogs/Kris/Lists/Posts/Post.aspx?ID=11)

# web-services - 使用 web 服务来包装数据访问层真的是一个坏主意吗？

> ID：299084
> 
> 赞同：3
> 
> 时间：2008-11-18T15:35:52.740
> 
> 标签：web-services, data-access-layer, data-access

我不相信 - 我认为将您的数据公开给可以在您的 Web 服务之上构建他们的前端应用程序的不同消费者可能很有用。

有人可以提供使用 Web 服务包装数据访问层时的示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T15:57:06.100

根据您对“数据访问层”的定义，可能有也可能没有充分的理由这样做。传统上，分布式 API，如 Web 服务或 RPC 层位于下一层。这具有以下优点：

1.  如果没有与 DB 的紧密耦合，您可以调整该层以很好地与分布式访问配合使用 - 例如组织 API 以最大限度地减少往返行程。

2.  您可以在 API 上添加额外的验证层。原始数据访问层可能允许将不良数据写入系统。出于这个原因，将其暴露给不受信任的客户是不好的。

3.  您可以采用数据访问层可能无法实现的方式将应用程序级安全性置于服务层之上。

4.  第 1 点和第 2 点意味着您可以在中间层重用业务规则验证。

为 CRUD 操作公开一个简单的 API 也可以通过直接连接到数据库服务器来实现，因此在此之上的 Web 服务层不会为您提供 DBMS 尚未提供的任何东西。一些数据库引擎还可以通过 HTTP 直接提供查询服务，因此您可以通过大多数防火墙对其进行隧道传输。但是，这意味着您几乎肯定不想将其暴露给公共互联网。

虽然理论上您可以通过 Web 服务公开 CRUD 操作（我假设您的意思是“数据访问层”），但有一些相当充分的理由不这样做，这样做的好处相对较小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T15:57:52.947

当今世界的主要推动力是向云计算或 SaaS 计算。

考虑到这一点，包括 SalesForce (CRM)、Google、Parature (helpdesk) 等在内的许多主要应用程序都通过 Web 服务公开他们的应用程序。

这不仅仅是一个好主意，它还是让希望将其集成到其环境中的公司认真对待您的应用程序的唯一方法。

也就是说，当使用 Web 服务来包装 DAL 时，我能想到的唯一示例是当只有一个应用程序会调用 DAL 并且它在您的直接开发控制之下时是个坏主意。这是由于跨 Web 服务边界对数据进行序列化/反序列化会导致性能损失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T15:39:50.080

好吧，如果您将整个 API 暴露在没有安全性的 Web 服务上，那可能是个坏主意。

但是，如果您以安全、只读的方式公开它的所需部分，并且您的客户喜欢它，那肯定是一件好事。

如果您需要说服管理层，请记住“Google 做”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T19:03:49.387

在 .NET 中，WCF 似乎提供了一种解决 Chris 提到的性能问题的方法。WCF 应该允许您让您的数据访问组件在您自己的应用程序的进程中运行，但也可以很容易地公开为 Web 服务。（免责声明：我实际上并没有实现这个，只是看着它。）

# c# - C#如何在文本框有焦点时按Enter键单击按钮？

> ID：299086
> 
> 赞同：67
> 
> 时间：2008-11-18T15:36:40.337
> 
> 标签：c#, winforms

我正在使用 C# 中的 WinForm 应用程序，在我在文本框中键入内容后，我想按 Enter 键但文本框仍然有焦点（闪烁的光标仍在文本框中），我该如何实现？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-11-18T15:38:22.580

简单的选项就是将表单的 AcceptButton 设置为您想要按下的按钮（通常是“OK”等）：

```
 TextBox tb = new TextBox();
    Button btn = new Button { Dock = DockStyle.Bottom };
    btn.Click += delegate { Debug.WriteLine("Submit: " + tb.Text); };
    Application.Run(new Form { AcceptButton = btn, Controls = { tb, btn } }); 
```

如果这不是一个选项，您可以查看 KeyDown 事件等，但这是更多的工作......

```
 TextBox tb = new TextBox();
    Button btn = new Button { Dock = DockStyle.Bottom };
    btn.Click += delegate { Debug.WriteLine("Submit: " + tb.Text); };
    tb.KeyDown += (sender,args) => {
        if (args.KeyCode == Keys.Return)
        {
            btn.PerformClick();
        }
    };
    Application.Run(new Form { Controls = { tb, btn } }); 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-11-18T16:00:11.270

执行此操作的常用方法是将`Form`'s设置`AcceptButton`为要“单击”的按钮。您可以在 VS 设计器或代码中执行此操作，并且`AcceptButton`可以随时更改。

这可能适用于您的情况，也可能不适用，但我已将其与表单上`GotFocus`不同 es 的事件结合使用，`TextBox`以根据用户按 Enter 的位置启用不同的行为。例如：

```
void TextBox1_GotFocus(object sender, EventArgs e)
{
    this.AcceptButton = ProcessTextBox1;
}

void TextBox2_GotFocus(object sender, EventArgs e)
{
    this.AcceptButton = ProcessTextBox2;
} 
```

使用此方法时要注意的一件事是，不要将`AcceptButton`集合留到`ProcessTextBox1`何时`TextBox3`变得专注。我建议在es 上使用设置 的`LostFocus`事件，或者创建一个方法，让所有不使用特定调用的控件。`TextBox``AcceptButton``GotFocus``AcceptButton`

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2013-07-25T08:30:49.967

```
private void textBox_KeyDown(object sender, KeyEventArgs e)
{
     if (e.KeyCode == Keys.Enter)
     {
         button.PerformClick();
         // these last two lines will stop the beep sound
         e.SuppressKeyPress = true;
         e.Handled = true;
     }
} 
```

将此 KeyDown 事件绑定到文本框，然后当您按下某个键时，将触发此事件。在事件中我们检查用户是否按下了“回车键”，如果是，你可以执行你的操作

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-06-05T00:31:05.473

我自己在寻找相同的东西时遇到了这个问题，我注意到当您不想在按 Enter 时单击表单上的“接受按钮”时，列出的答案都没有真正提供解决方案。

一个简单的用例是屏幕上的文本搜索框，其中按 Enter 应该“单击”“搜索”按钮，而不是执行表单的 AcceptButton 行为。

这个小片段可以解决问题；

```
private void textBox_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar == 13)
    {
        if (!textBox.AcceptsReturn)
        {
            button1.PerformClick();
        }
    }
} 
```

就我而言，此代码是从 TextBox 派生的自定义 UserControl 的一部分，并且该控件具有“ClickThisButtonOnEnter”属性。但上面是一个更通用的解决方案。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-01-26T10:55:01.977

只需将表单“ **Accept Button** ”属性设置为您要按 Enter 键点击的按钮。或者在加载事件中写入`this.acceptbutton = btnName;`

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-02-13T10:27:19.610

最适合初学者的解决方案是：

1.  在您的设计器中，单击您希望发生这种情况的文本字段。在属性窗口（默认：右下角）单击迅雷（事件）。此图标位于字母排序图标和属性图标旁边。

2.  向下滚动到`keyDown`。单击它右侧的下拉字段。您会注意到那里没有任何内容，因此只需按 Enter。Visual Studio 将为您编写以下代码：

    ```
    private void yourNameOfTextbox_KeyDown(object sender, KeyEventArgs e)
    {

    } 
    ```

3.  然后只需将其粘贴在括号之间：

    ```
    if (e.KeyCode == Keys.Enter)
    {
         yourNameOfButton.PerformClick();
    } 
    ```

这将像您单击它一样起作用。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-03-14T12:35:18.990

在 Visual Studio 2017 中，使用 c#，只需将 AcceptButton 属性添加到您的按钮，在我的示例中为“btnLogIn”：

```
this.btnLogIn = new System.Windows.Forms.Button();
//....other settings
this.AcceptButton = this.btnLogIn; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-02-26T18:44:48.963

或者您可以只使用这个简单的 2 行代码 :)

```
if (e.KeyCode == Keys.Enter)
            button1.PerformClick(); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-10-04T14:25:18.040

在我的情况下，TextBox 根本没有收到回车键。我尝试的第一件事是将回车键更改为输入键，但是当按下回车键时我仍然收到系统哔声。因此，我继承并覆盖了 ProcessDialogKey() 方法并发送了我自己的事件，我可以将点击处理程序绑定到该事件。

```
public class EnterTextBox : TextBox
{
    [Browsable(true), EditorBrowsable]
    public event EventHandler EnterKeyPressed;

    protected override bool ProcessDialogKey(Keys keyData)
    {
        if (keyData == Keys.Enter)
        {
            EnterKeyPressed?.Invoke(this, EventArgs.Empty);
            return true;
        }
        return base.ProcessDialogKey(keyData);
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-02-25T23:01:32.610

将此添加到表单的构造函数中：

```
this.textboxName.KeyDown += (sender, args) => {
    if (args.KeyCode == Keys.Return)
    {
        buttonName.PerformClick();
    }
}; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-06-03T05:25:10.353

你可以在 keyup 事件中捕获它[http://www.itjungles.com/dotnet/c-how-to-easily-detect-enter-key-in-textbox-and-execute-a-method](http://www.itjungles.com/dotnet/c-how-to-easily-detect-enter-key-in-textbox-and-execute-a-method)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-02-27T07:13:58.803

这对 WinForms 非常有效。但是，在 WPF 中，您需要以不同的方式做事，而且更容易。将与此文本区域相关的**Button的****IsDefault**属性设置为 true。

 **完成捕获回车键后，不要忘记相应地切换属性。

# silverlight - 我可以让 Silverlight 媒体播放器播放 .Vox 文件吗？

> ID：299089
> 
> 赞同：0
> 
> 时间：2008-11-18T15:37:00.397
> 
> 标签：silverlight, silverlight-2.0

我需要在我的网页上播放 .vox 文件。有人对如何使用 Silverlight Mediaplayer 控件播放 .vox 文件有任何提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T16:52:58.577

Silverlight 现在只能播放 VC-1 编码的内容。您可以在此处查看支持的格式/容器：[支持的音频和视频格式](http://msdn.microsoft.com/en-us/library/cc189080(VS.95).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T15:19:58.777

它不会播放 VOX 文件。将其转换为 MP3，它应该可以播放。

# c# - C#：如何在整数上进行简单的数学运算，四舍五入？

> ID：299094
> 
> 赞同：19
> 
> 时间：2008-11-18T15:38:24.827
> 
> 标签：c#, math, rounding

我想要一个四舍五入到最接近整数的方程的结果。例如

```
137 * (3/4) = 103 
```

考虑以下不正确的代码。

```
int width1 = 4;
int height1 = 3;

int width2 = 137;
int height2 = width2 * (height1 / width1); 
```

在 C# 中执行“整数”数学的正确方法是什么？

我真的必须这样做吗：

```
int height2 = (int)Math.Round(
      (float)width2 * ((float)height1 / (float)width1)
   ); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-18T15:50:29.513

如上所述，您应该在除法之前进行乘法运算。无论如何，你可以只用除数来写你的表达式：

```
int height2 = (int)Math.Round(width2 * (height1 / (float)width1)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T15:40:45.570

```
int height2 = (width2 * height1) / width1; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T15:45:00.007

先做乘法（只要它们不太可能溢出），然后再做除法。

整数数学中的 3/4 == 0 （整数数学不会在除法时四舍五入，它会截断）。

如果您真的需要舍入，则必须使用定点、浮点或使用模数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-15T21:51:53.323

我认为这是最优雅的方法：

```
Math.round(myinteger * 0.75); 
```

使用 0.75 而不是 3/4 会将其隐式转换为双精度/浮点数，为什么不使用为此提供的默认函数呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T02:23:15.633

我将通过添加零行代码来修复不正确的代码：

```
float width1 = 4;
float height1 = 3;

float width2 = 137;
float height2 = width2 * (height1 / width1); 
```

对于可能包含小数的变量，您应该使用浮点数。这包括根据比率计算的高度。如果这是一个问题，您可以随时转换为 int 。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T19:53:51.203

永远不要转换为浮点数，它的精度甚至低于 32 位整数。如果要使用浮点数，请始终使用双精度数而不是浮点数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-09-06T14:11:27.967

刚刚偶然发现这个问题。亚伦的回答对我来说似乎几乎是正确的。但我非常确定如果您的问题是“现实世界”问题，您需要指定中点舍入。所以我的答案，基于亚伦的代码，是

```
int height2 = (int)Math.Round(width2 * (height1 / (float)width1),MidpointRounding.AwayFromZero); 
```

要查看差异，请在控制台中运行该代码

```
 Console.WriteLine((int)Math.Round(0.5));
    Console.WriteLine((int)Math.Round(1.5));
    Console.WriteLine((int)Math.Round(2.5));
    Console.WriteLine((int)Math.Round(3.5));
    Console.WriteLine((int)Math.Round(0.5, MidpointRounding.AwayFromZero));
    Console.WriteLine((int)Math.Round(1.5, MidpointRounding.AwayFromZero));
    Console.WriteLine((int)Math.Round(2.5, MidpointRounding.AwayFromZero));
    Console.WriteLine((int)Math.Round(3.5, MidpointRounding.AwayFromZero));
    Console.ReadLine(); 
```

有关详细信息，您可以查看[这篇](http://msdn.microsoft.com/en-us/library/system.midpointrounding%28v=vs.110%29.aspx)文章。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-06T02:54:29.217

六年后（四舍五入），这是我的贡献——我很久以前就学会的一个小技巧，很惊讶没有其他人在这里提到过。

这个想法是通过在进行除法之前将除数的一半添加到分子来进行舍入。

```
 int height2 = (width2 * height1 + width1 / 2) / width1; 
```

实际上，在除数是变量的情况下，我不一定建议这样做，例如 OP。相反，使用 Math.Round() 可能会更好，因为它更容易理解。

但是在除数是常数的情况下，我确实使用了这个技巧。所以而不是

```
 int height2 = width2 * height1 / 4;  // No rounding 
```

我会用

```
 int height2 = (width2 * height1 + 2) / 4; 
```

这是一个更典型的例子

```
 private static Size ResizeWithPercentage(Size oldSize, int resizePercentage)
  {
     return new Size((oldSize.Width * resizePercentage + 50) / 100, 
                     (oldSize.Height * resizePercentage + 50) / 100);
  } 
```

另一种可能性是将这个技巧与 dongilmore 和 supercat 提到的想法结合起来，而不是用指定或隐含的两个除，你可以将分子和分母都乘以 2。

```
 int height2 = (width2 * height1 * 2 + width1) / (width1 * 2); 
```

在除数是或可能是奇数的情况下，这会给出更好的答案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-18T15:44:52.380

对 Jeffery 消息的详细说明，因为您通常比溢出 32 位整数更有可能截断所需的小数（并且因为乘法和除法是可交换的），您通常应该在除法之前进行乘法运算。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-19T02:09:00.810

```
int height2 = ((width2 * height1 * 10) + 5) / (width1 * 10); 
```

在进行任何整数除法之前，请检查以确保除数不为零。另请注意，这假定为正商。如果为负数，则舍入需要为 -5，而不是 +5。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-08-22T22:40:23.123

Convert 的转换总是四舍五入，所以：

```
int height2 = Convert.ToInt32(width2 * height1 / (double)width1); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-02T06:11:58.513

如果最终除以偶数并且结果始终为正，则一种相当有效的方法是除以该值的一半，加一，再除以二。如果结果可能是负数，则应尽可能添加一个使一切为正数的量，进行计算，然后减去相应的量。

如果最终除以奇数，则将分子和分母都乘以 2，然后按上述方法进行。例如，要计算 a*5/7，四舍五入，计算`(a*10+1)>>1`。需要注意的一件事是，您可能需要将值扩展到更大的数字类型以避免溢出，或者，如果这不可能，则将划分细分为多个部分。例如，要计算 a*14/15，您可以计算 ((a*4/3*7)/5+1)/2。如果 a 太大，该计算可能仍会溢出，但允许范围将是在另一个除法之前没有除以 3 的情况下评估它的三倍。请注意，细分操作会使舍入稍微不那么精确，但对于许多目的来说仍然足够接近。

# datagrid - Silverlight DataGrid 设置 ItemSource/DataContext 时自动选择，排序，

> ID：299095
> 
> 赞同：4
> 
> 时间：2008-11-18T15:38:42.390
> 
> 标签：datagrid, silverlight-2.0

有没有办法关闭 Silverlight 内置 DataGrid 中第一行的自动选择？

我们基于用户在数据网格中选择一行来构建许多功能。当数据绑定或排序时，SelectionChanged 的​​自动触发确实给我们带来了问题。我们试图在选择周围设置一些守卫，但似乎无法涵盖所有​​问题。

例如，如果在加载屏幕时未显示的 TabControl 选项卡中有 DataGrid，并且 DataGrid 绑定到作为对象列表的 DataContext 的属性。在显示选项卡之前，网格不会进行数据绑定。是否有事件告诉我们网格是数据绑定的？数据绑定的默认行为不应该是不选择行吗？

谢谢迈克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-22T19:51:54.907

您是否尝试过在用户控件的构造函数中设置一个布尔字段（例如 bool dataGridFirstLoad），该字段设置为 false。

然后在 DataGrid 的 SelectionChanged 事件上，检查 dataGridFirstLoad 是否为 false。如果 false 设置为 true 并将 SelectedItem 设置为 null。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T07:14:44.513

麦克风，

我通过包装 windows 控件并捕获包装 windows 网格的选择更改事件解决了这个问题。

在您的控件中，连接控件的 Loaded 事件，并在加载时将布尔私有成员变量设置为 true。然后，当您捕获内部数据网格的选择更改事件时，如果您的控件已加载，则仅引发您自己的选择更改事件。完成后，您现在可以返回 OnApplyTemplate 子程序，将内部数据网格的选定索引设置为 -1，将选定项设置为空。由于索引和项目的设置将在您的控件完成加载之前发生，因此不会触发选择更改事件。我在选项卡式和非选项卡式环境中都试过这个，它似乎没有问题。现在来解决一个更难的问题，您可能已经注意到，当您对 windows 数据网格进行排序时（当它是绑定到 ItemsSource 的数据时），它总是选择显示数据的顶部项目。这当然会触发选择更改事件，并移动到以前未选择的项目，据我所知，不应选择。要处理这个问题，您将不得不做一些更棘手的编码。如果您注意到，当您捕获内部网格的选择更改事件并查看其所选项目时，只有少数情况下所选项目未设置为任何内容，即当不再选择项目时（即. 选择被清除），或者当（提示）列正在排序时。当你在排序时，有两个事件会触发，第一个是取消选择项目（SelectedItem is Nothing），第二个是选择列表中的顶部项目（SelectedIndex 0）。现在，如果您要在事件处理程序中为内部网格选择更改事件放置一个标志，并发现该项目什么都不是，您可以跟踪先前的选定项目，然后设置内部数据网格的选定项目到之前选择的项目。

这很好地解决了问题，并且在包装 Windows 控件时可能会出现不希望的结果，但据我所知，这似乎是解决在加载问题时选择第一行的唯一方法。然而，我只能想象，这将在某个时候由 M$ 解决。

我希望这有帮助，

谢谢，

斯科特

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T16:27:52.153

这与上面的帖子相似（并散列了 Paulo T 的建议）。这很好用。//在 xaml 或构造函数中设置 selectionchanged 处理程序 //我的页面上有 2 个网格，所以我为每个网格创建一个布尔属性

```
private bool IsFirstLoad { get; set; }
private bool IsFirstLoadDetails { get; set; }
public BookDisplay()
{
  //code here
  this.IsFirstLoad = true;
  this.IsFirstLoadDetails = true;
  BindBooks(); //define this function (not in this snippet for the sake of brevity)
}
private void GridBooks_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
  if (this.IsFirstLoad)
  {
    GridBooks.SelectedItem = -1;
    this.IsFirstLoad = false;
  }
  else
  {
    //do your stuff
  }
}
private void GridBooksWithDetails_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
  if (this.IsFirstLoadDetails)
  {
     GridBooksWithDetails.SelectedItem = -1;
     this.IsFirstLoadDetails = false;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T15:14:57.490

下面的代码应该做到这一点（每当您更新/刷新网格时将 JustRefreshed 设置为 true）：

```
 int LastSelectedIndex = -1;
 bool JustRefreshed = false;

        private void dataGrid_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (JustRefreshed)
            {
                JustRefreshed = false;
                dataGrid.SelectedIndex = LastSelectedIndex;
                return;
            }
            if (e.AddedItems.Count > 0)
            {
                LastSelectedIndex = dataGrid.SelectedIndex;
                        }    
                //Your logic comes here...
            }
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-03T22:29:44.873

由于 Microsoft 提供了 DataGrid 的代码，因此我们删除了选择，因此我们不必解决它。我相信这不再是 Silverlight 3.0 网格的问题。

# networking - 霍比特人监控 - 在 bbretest 之前没有颜色变化？

> ID：299097
> 
> 赞同：1
> 
> 时间：2008-11-18T15:39:30.283
> 
> 标签：networking, monitoring, hobbitmon

我目前正在使用 Hobbit 监控一个大型网络，并负责降低错误（或至少不相关）警报的数量。在我的列表顶部是由 bbtest-net 发起的测试“http”和“conn”。此命令检查 ping、ssh 等，如果例如 ping 超时，它会立即将状态设置为红色。一分钟后，bbretest 命令启动，检查所有新变红的主机，发现它又变绿了。这种情况**一直在**发生，它弄乱了我的日志。

第一次运行 bbretest 后，我​​有什么方法可以让 Hobbit 报告红色状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T15:42:19.233

首先，这是一个编程网站，所以你不会得到很多答案。

但是……但是……

如果您的服务器超时，这不是问题吗？

在我看来，霍比特人完成了它所设计的工作：告诉你有一些事情需要你注意。

修复超时问题，你的日志应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T07:37:51.270

我认为你最好的选择是避开现有的 Hobbit 服务测试并编写自己的测试。这并不难。

*除非连续*几次尝试失败，否则您的测试脚本不会变红是个好主意。

您可以禁用标准的霍比特人并使用您自己的。话虽如此，“conn”测试的默认行为似乎相当合理（如果服务器不 ping，则立即变红）。

不幸的是，霍比特人警报系统没有选项仅在问题持续 X 分钟时发出警报，这将非常有用 - 但我相信您也可以使用自定义警报脚本来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T09:25:51.567

您可以使用：

```
<ip> <hostname> # noconn 
```

在不响应 ping 的服务器的 bb-hosts 中。然后通过服务测试它的活力。

# xml - xslt 模板优化

> ID：299106
> 
> 赞同：2
> 
> 时间：2008-11-18T15:41:25.537
> 
> 标签：xml, xslt

我有以下 xslt 代码：

```
<xsl:template match="table_terms_and_abbr">
    <informaltable frame='none' colsep='none' rowsep='none'>
        <tgroup cols='2' align='left'>
            <colspec colnum="1" colwidth='1*'/>
            <colspec colnum="2" colwidth='1*'/>
            <xsl:apply-templates/>
        </tgroup>     
    </informaltable>
</xsl:template> 
```

以及它正在处理的以下xml：

```
<table_terms_and_abbr>
        <tblrow_hdr>Name ,, Description</tblrow_hdr>
        <tbody>
            <tblrow_bold_first> BOT ,, &j_bot;</tblrow_bold_first>
            ...
        </tbody>    
</table_terms_and_abbr> 
```

现在我想通过在以下行中移动以下行来改进 xslt `table_terms_and_abbr`：

```
<tblrow_hdr>Name ,, Description</tblrow_hdr>
<tbody>

</tbody> 
```

所以我会有类似的东西：

```
<xsl:template match="table_terms_and_abbr">
    <informaltable frame='none' colsep='none' rowsep='none'>
        <tgroup cols='2' align='left'>
            <colspec colnum="1" colwidth='1*'/>
            <colspec colnum="2" colwidth='1*'/>
             <xsl:call-template name="tblrow_hdr">
                  BOT ,, &j_bot;                      * ???? *
             </xsl:call-template>
            <tbody>
            <xsl:apply-templates/>
            </tbody>
        </tgroup>     
    </informaltable>
</xsl:template> 
```

标有 * 的行？？？？* 不起作用。我在 linux 平台上使用 saxon9（xslt 2.0 样式表）并得到这个错误：

*XTSE0010：xsl:call-template 中不允许有字符数据*

我知道如何将属性传递给模板，即：

```
<xsl:with-param name="is_make_first_bold" select = "1" as="xs:integer"/> 
```

但是如何传递自由文本？

这个想法是将所有静态数据移到模板中，并且在 xml 中仅使用可变数据，即

```
<table_terms_and_abbr>
    <tblrow_bold_first> BOT ,, &j_bot;</tblrow_bold_first>
    ...
</table_terms_and_abbr> 
```

**更多信息**
我的要求是为我们的 DocBook 文档创建一个用于定义可重复表的简化语法。为此，我创建了一个通用命名模板`tblrow`，它将以“，”分隔的行拆分为单独的实体，并将在表格行中创建一个条目列表。
每个条目可以是一个简单的字符串、一个实体或另一个模板。由于参数编号未定义（表格可以有不同数量的单元格），我不能为模板使用标准参数并使用分隔字符串。如果我想让其中一个表条目包含指向文档中某个位置的链接，我将无法再次使用这些参数，因为我无法将外部参照模板作为参数传递。
不改的主要原因`tblrow`模板是它正在工作:) 它有点复杂。我花了很长时间才实现这一目标，但我并不完全理解它是如何工作的:)。

现在最重要的是，我有一些变量可以控制显示的输出，例如`tblrow_hdr`将下划线和粗体显示每个条目中的文本。因为`tblrow_hdr`对于所有表来说都是通用的，`table_terms_and_abbr`所以在 xml 中没有这个对我来说听起来很合乎逻辑，而是将调用`tblrow_hdr`放在`table_terms_and_abbr`模板内部，我就卡在这里了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T15:50:36.923

> 我知道如何将属性传递给模板，即：
> 
> ```
> <xsl:with-param name="is_make_first_bold" select = "1" as="xs:integer"/> 
> ```
> 
> 但是如何传递自由文本？

将文本作为`xsl:with-param`元素的内容传递。

[XSL 转换 11.6 向模板传递参数](http://www.w3.org/TR/xslt#section-Passing-Parameters-to-Templates)

```
<xsl:with-param
  name = qname
  select = expression>
  <!-- Content: template -->
</xsl:with-param> 
```

`xsl:with-param`使用该元素将参数传递给模板。required`name`属性指定参数的名称（要替换其绑定值的变量）。name 属性的值是一个[QName ，它按照](http://www.w3.org/TR/REC-xml-names#NT-QName)[[2.4 Qualified Names]](http://www.w3.org/TR/xslt#qname)中的描述进行扩展。'xsl:with-param' 允许在`xsl:call-template`和中使用`xsl:apply-templates`。参数值的指定方式与 for`xsl:variable`和相同`xsl:param`。用于计算 element 指定值的当前节点和当前节点列表与它所在的or元素`xsl:with-param`使用的相同。将参数*x*传递给没有`xsl:apply-templates``xsl:call-template`*`xsl:param`*x*的元素；该参数被简单地忽略。*

 *此示例为编号块定义了一个命名模板，并带有一个参数来控制数字的格式。

```
<xsl:template name="numbered-block">
  <xsl:param name="format">1\. </xsl:param>
  <fo:block>
    <xsl:number format="{$format}"/>
    <xsl:apply-templates/>
  </fo:block> 
```

```
<xsl:template match="ol//ol/li">
  <xsl:call-template name="numbered-block">
    <xsl:with-param name="format">a. </xsl:with-param>
  </xsl:call-template>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T00:48:37.447

You can pass the additional string data as a parameter:

     <xsl:with-param name="pNeededText" select="'--123Abc'"/>

and in the called template define this parameter:

     <xsl:param name="pNeededText" as="xs:string">

Or, you could define a **global `<xsl:variable/>` or `<xsl:param/>`** and reference it directly in the called template.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-21T03:04:10.557

```
> 由于参数编号为
> 未定义（表可以有
> 不同数量的单元格）我不能使用
> 标准参数
> 模板和使用的分隔字符串。
```

事实上，事实并非如此。

这是一个示例

```
<xsl:with-param/>
```

，其主体是一个节点集，可能由不同调用的不同数量的元素组成：

```
    <xsl:模板匹配="/">
      <xsl:变量名="vrtfTParams">
        <p>xxx</p>
        <p>年年</p>
        <p>zzz</p>
      </xsl:变量>

      <xsl:call-template name="makeTable">
        <xsl:with-param name="pTParams"
         select="msxsl:node-set($vrtfTParams)/*"/>
      </xsl:调用模板>
    </xsl:模板>

```

“makeTable”模板可以这么简单：

```
    <xsl:template name="makeTable">
      <xsl:param name="pTParams"/>

      <表格>
        <tr>
          <xsl:for-each select="$pTParams">
            <td>
              <xsl:value-of select="."/>
            </td>
          </xsl:for-each>
        </tr>
      </table>
    </xsl:模板>

```

msxsl:node-set() 扩展函数可以与 Microsoft XSLT 处理器一起使用。大多数其他处理器都支持 exslt:node-set() 扩展功能（Microsoft 的 .Net XSLT 处理器 XslCompiledTransform 也支持它）。

如果 $vrtfTParams 的内容不是动态生成的（如本例中的情况），则不需要 xxx:node-set() 函数，因为 <xsl:variable> 的内容可以像这样传递：

```
<xsl:with-param name="pTParams"
   select="document('')/*/xsl:variable[name()=vrtfTParams)/*"/>

```

这里 $vrtfTParams 必须是全局定义的（<xsl:template/> 的子级）。

在 XSLT 2.0（和 XPath 2.0）中，没有 RTF 类型，也根本不需要 xxx:node-set() 扩展函数。

希望这有帮助。

干杯，

迪米特·诺瓦切夫

# coding-style - 我们应该使用哪些指标来判断代码质量？

> ID：299110
> 
> 赞同：2
> 
> 时间：2008-11-18T15:41:46.193
> 
> 标签：coding-style, code-metrics

我目前正在从事一个大型项目，许多开发人员随着时间的推移工作，代码很糟糕。经过多次重构，我们现在到达了一个点，代码没问题。现在我在想“ok”是什么意思——可能对每个人来说都是不同的。

你认为可以指定“ok”吗？什么是重要的？NDepend 指标？测试覆盖率？注释？编码风格？文档？

我知道已经有很多关于编码风格或评论的话题（例如[这里](https://stackoverflow.com/questions/tagged/best-practices+programming)）。这个问题只是关于哪些事实是重要的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T15:44:00.773

我认为对于任何重要的项目，您都应该有适当的编码指南（样式、评论等）和指标，以了解它们是否被遵循。您列出的清单是一个很好的开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T15:49:55.833

你把两种不同的东西混在一起了。

您谈论编码风格，但随后您提到测试覆盖率、指标等。

编码风格当然可以指定——所有需求文档都必须声明“为了代码维护和一致性，这个项目将遵循这些编码风格和标准。”

然而，一般来说，大多数项目只需要“良好的行业实践”和“整个项目的一致编码风格”，并将其实际定义和实现留给开发人员。

但是，您正在讨论的其他问题，需要重构、测试、覆盖等的错误代码（我也会抛出 LINT 和静态分析），这些都应该明确指定和要求。没有理由将它们排除在规范之外 - 它们是显示哪种类型的编码错误（或者，在风格和错误代码之间的模糊线上，哪种类型的编码模式可能产生错误代码）的硬指标在任何给定的代码中，它的性能如何，以及测试显示正确操作的程度。

例如，在大型项目中，客户将与主要开发人员坐下来检查 LINT 配置，以确保它满足他们的需求，并且没有任何轻率的错误会减慢开发速度。

所以，简而言之，是的，所有这些都可以（并且应该，恕我直言）为任何重要的项目指定。

-亚当

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T15:50:42.010

你说得对，每个人的情况都不一样。也就是说，一旦你定义了期望，保持它向前发展的最好方法就是通过频繁的代码审查。

人们，尤其是项目中的新人，总是带着自己的风格。代码审查有助于使代码雌雄同体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T16:06:08.280

有许多事情可以提高项目的质量，而这些事情与代码和工具无关。

1.  需求管理。有一些流程来对您的要求进行质量控制。它们有意义吗？谁要求的？他们是提出这些要求的合适人选吗？

2.  测试设计。根据要求而不是实现来构建测试。不要让您的编码人员进行测试！

3.  测试一切——每次。完成每个版本的完整测试周期，没有次要版本。

以我的经验，诸如代码度量和代码标准之类的东西从来没有真正起作用。你会知道谁是无赖编码员；您不需要正式的流程来识别它们。

真正能提高质量和输出的一种技术是代码审查。您需要一些纪律和骨干才能让您的三个资源花一天时间审查 5 天的工作。但是没有什么能如此彻底地揭示潜在的问题，而且，如果人们知道下周有人会批评它，该死的人只会写出更好的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T16:25:37.710

StyleCop ... 还有，FxCop ...

一个团队绝对应该标准化他们的风格。一些个人选择的空间，但一个团队绝对应该标准化他们的风格。代码更易读、更易维护、更容易审查等等等等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T16:32:38.977

某种准则（样式不如内容 IMO 重要），例如最佳模式/实践，但更重要的是代码审查。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T15:48:21.810

有很多东西可以说是 ok/good 代码的属性。

*   编译时没有错误或警告

还有一些关于这个主题的其他主题......

# php - 我可以使用 vim "star" 搜索来搜索 PHP 类成员和方法吗？

> ID：299114
> 
> 赞同：3
> 
> 时间：2008-11-18T15:42:23.477
> 
> 标签：php, search, vim, editor

vim * 星号 / 星号搜索 (:help star) 是一个很棒的功能，它可以让您找到光标所在单词的下一个出现位置。不幸的是，它将美元前缀视为字符串的一部分，所以如果我在类名中的“SearchTerm”上方按*，它会在评论中找到“SearchTerm”和“$this->SearchTerm”，但不是“$SearchTerm “：

```
class SearchTerm 
{
    /* do something with SearchTerm */

    var $SearchTerm;

    function DoStuff() 
    {
         return $this->SearchTerm;
    }
} 
```

有没有办法告诉星搜索忽略 $-prefix？

**只是为了扩展[海斯](https://stackoverflow.com/users/4993/haes])的答案：**

我需要从 iskeyword 中删除 $

```
:set iskeyword         # iskeyword=@,48-57,_,192-255,$

:set iskeyword-=$      # remove the $ as an acceptable word character 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T16:01:20.800

实际上在 Mac 上使用 vim 7.2，star search 完全按照您的意愿工作。

编辑：检查您的 'iskeyword' (:set iskeyword) 设置为什么，因为星号搜索基于此选项来查找单词搜索词。

或者，您可以使用 'g*' (:help gstar) 对光标所在的单词进行部分搜索。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-18T15:52:16.357

您应该能够通过在 $ 前面放置一个反斜杠来转义它：\$

# .net - 如何在 Linq 中没有“分组依据”的情况下执行聚合？

> ID：299117
> 
> 赞同：0
> 
> 时间：2008-11-18T15:44:32.847
> 
> 标签：.net, linq, c#-3.0

我在 linq 中可以找到的所有聚合都有一个“group by”子句。我将如何在 LINQ 中编写此查询？我有一个日期值对列表，我想取这些值的平均值：

```
SELECT AVG(MySuff.Value) AS AvgValue FROM MyStuff 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T15:46:13.250

早上艾伦：

```
int count = (from a in myContext.MyStuff
            select a).Count(); 
```

假设 myContext 是 DataContext。

请注意，这会给您立即执行，您可能不希望这样做。

您可以改为将查询结果存储在 var 中：

```
var allResults = from a in myContext.MyStuff
                 select a;

//sometime later when needed
int count = allResults.Count(); // executes the SQL query now! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T15:50:08.140

LINQ 中有很多非分组聚合运算符。艾伦的回答向您展示了`Count`操作员，但[MSDN 列出了其他人](http://msdn.microsoft.com/en-us/library/bb546138.aspx)。

编辑：看到你的编辑，看起来你想要[平均](http://msdn.microsoft.com/en-us/library/system.linq.queryable.average.aspx)操作员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T15:49:45.660

应该注意的是，Alan 的 LINQ 代码将完全生成 AlanR 的 SQL 代码，尽管您可能会猜到其他情况。

但是，这里应该小心。如果写成：

```
var q = from a in MyStuff select a;
int count = q.count();
foreach(MyStuff m in q) {...} 
```

然后将生成两个数据库查询：第一个为“select count(*)...”，第二个为“select * ....”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T15:53:20.053

修改示例的答案（我相信）是：

```
var average = (from a in MyStuff
              select a.Value).Average(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T14:48:57.250

位分拣机

```
pairs.Average(a=>a.Value) 
```

如果没有 join、group 或 let，我认为 Query Expressions (from ...) 不值得。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T15:56:55.303

谢谢大家的帮助。这是我决定的，它有效。

```
(from s in series select s).Average( a => a.Value ) 
```

问候，艾伦...R

# sql-server - SQL Server 依赖项

> ID：299128
> 
> 赞同：11
> 
> 时间：2008-11-18T15:47:01.423
> 
> 标签：sql-server

有没有一种简单的方法可以在 SQL Server 2005+ 中追踪表/存储过程/函数依赖关系？我继承了一个巨大的应用程序，其中包含许多表，甚至更多的存储过程和函数，它们很长且相互关联。

归根结底，有没有办法构建依赖树？理想情况下，我正在寻找两个方向：

**对于表格/程序 - 什么取决于它？**: 显示所有最终引用它的存储过程（最好在树视图中，这样子过程嵌套到调用它们的更大过程中）

**对于一个程序 - IT 依赖于什么？**：显示给定过程在运行时将（或可能）触及的所有过程和表格。

看起来这个工具不应该那么难制作，并且通常对于数据库维护非常有用。有人知道这样的事情吗？如果这不存在，那为什么不呢？

Management Studio 中的内置功能很好，但信息似乎并不完整。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-11T19:09:36.793

希望我不会为时已晚：

如果您的 SQL 登录可以访问特定数据库中的 sys 模式，则可以使用 sys.dependencies 视图一次性查找对象的所有依赖项：

```
SELECT o.name, o.type_desc, p.name, p.type_desc
FROM sys.sql_dependencies d
INNER JOIN sys.objects o
    ON d.object_id = o.object_id
INNER JOIN sys.objects p
    ON d.referenced_major_id = p.object_id 
```

以此为起点，您可能会构建一个体面的工具来创建依赖关系树。还有一些特定类型的视图（例如 sys.columns），可以提供有关每个特定数据库对象类型的更深入信息；如有必要，这些可用于提供有关对象的上下文信息。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-18T15:53:06.840

Red Gate 有一个非常有用的工具，叫做[SQL Dependency Tracker](http://www.red-gate.com/products/SQL_Dependency_Tracker/index.htm)。我们已经成功地将它用于您希望获得的结果类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T15:49:08.547

我不认为这是一个保证完整的列表，但在 Management Studio 中，您可以右键单击表或存储过程并选择该`View Dependencies`选项。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T16:15:54.970

如果您的预算不足，这里有一个选项列表：

[http://www.mssqltips.com/tip.asp?tip=1294](http://www.mssqltips.com/tip.asp?tip=1294)

当您单击“查看依赖项”时，您还可以运行跟踪并查看管理工作室实际在做什么。获取该代码，看看您是否可以修改它以供自己使用。这是一种很好的技术，可以帮助您了解如何自动化您通常通过 UI 执行的各种操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-30T06:07:05.837

我找到了这个解决方案，它很棒。

```
SELECT referencing_schema_name, referencing_entity_name,
referencing_id, referencing_class_desc, is_caller_dependent
FROM sys.dm_sql_referencing_entities ('dbo.udf_func', 'OBJECT'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T15:57:06.100

试图跟踪依赖关系的系统表通常是错误的，因此您从中得到的任何答案都必须通过其他方式重新确认，所以为什么要打扰它呢？

存在商业产品，例如 Redgate SQL Dependency Tracker。

像我这样可怜的开发人员，我使用免费的 SQL Digger。通过在 DDL 中搜索对象名称，您通常可以找到相关对象的一级依赖关系。

下一个级别的依赖跟踪是跟踪 C# 或 VB.NET 网络对象依赖于 SQL 中的对象，但是 AFAIK，在全局搜索之外不存在用于该对象的工具。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-14T07:31:53.870

试试这个生产力工具[http://sqlhopper.weebly.com/](http://sqlhopper.weebly.com/) 很酷

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-26T10:21:35.597

来自[MSDN](https://msdn.microsoft.com/en-us/library/ms190624.aspx?f=255&MSPPError=-2147217396)：

```
SELECT * FROM sys.sql_expression_dependencies
WHERE referenced_id = OBJECT_ID(N'Production.Product'); 
```

我们可以让它更漂亮：

```
select
I.name depending, I.xtype dependingtype,
E.name depended, E.xtype dependedtype
from sys.sql_expression_dependencies D
left outer join sysobjects I on D.referencing_id = I.id
left outer join sysobjects E on D.referenced_id = E.id
where 1 = 1
and ( E.name = 'mytable' or I.name = 'mytable' )  -- customize this any way you want
order by dependedtype, depended, dependingtype, depending 
```

# java - java.util.concurrent

> ID：299129
> 
> 赞同：0
> 
> 时间：2008-11-18T15:47:09.893
> 
> 标签：java, websphere, executorservice, commonj

我试图启动一个 Runnable 类的运行方法，但是我不断收到 NullPointerException，我使用 WebSpheres commonj.workmanager 来获取 executorService 的实例。这是我正在使用的代码。

```
executorService.execute(new Runnable() {
    public void run() {
        System.out.println("Inside run ()method..");
    }
});

ANY IDEAS? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T15:56:54.790

您是否`executorService`在调用之前检查是否为 null `execute()`？如果没有，听起来您需要查看 WebSphere 文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T16:10:17.367

感谢您的回复，`executorService`就是这样`null`。我使用 Spring 注入属性。

# java - 当我对 List 进行排序时，它的迭代器会发生什么？

> ID：299135
> 
> 赞同：11
> 
> 时间：2008-11-18T15:48:32.620
> 
> 标签：java, collections, concurrency

假设我有**一个`List`对象**和该列表**的迭代器**。

现在我对列表进行排序`java.util.Collections.sort()`

*   迭代器会发生什么？
*   它的行为是否仍然被定义并且仍然可以使用？
*   如果没有，我可以防止破坏列表的迭代器吗？

我知道，这个问题可以通过改变程序设计来规避，例如克隆列表，但我特别想知道 Java 的“官方”行为。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-18T15:51:52.053

迭代器通常在对其基础集合进行*任何修改后无效，除非通过迭代器本身。*（例如，[`ListIterator`](http://java.sun.com/javase/6/docs/api/java/util/ListIterator.html)允许插入和移除。）

我当然希望任何迭代器在排序后都会失效——如果不是，我不知道期望什么顺序。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-18T15:55:14.463

中的大多数集合`java.util`都是“快速失败的”，如果基础集合发生更改，**可能会**抛出一个。[`ConcurrentModificationException`](http://java.sun.com/javase/6/docs/api/java/util/ConcurrentModificationException.html)应该指出的是，这是用于调试的，因此不能保证。根据 javadocs，对于 的所有后继者都是如此[`AbstractList`](http://java.sun.com/javase/6/docs/api/java/util/AbstractList.html)，但对于旨在用于多线程使用的 而言，情况**并非**如此。[`CopyOnWriteArrayList`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-18T15:55:10.080

通常，集合上的任何类型的突变都会使其迭代器无效。通过迭代器完成的突变不会使该迭代器无效。有一些特殊的集合实现，例如`CopyOnWriteArrayList`.

一般的解决方案是对集合的副本进行排序或重新创建迭代器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T16:13:14.617

我编写了一些代码来查看在迭代时对集合进行排序时会发生什么。迭代器似乎没有抛出任何异常，而是继续正常迭代。如果您期望遍历未排序的集合，它仍然会给您错误的结果。看那个 ：

```
public static void main(String[] args) {
    List<String> list = new ArrayList<String>();
    list.add("D");
    list.add("B");
    list.add("A");
    list.add("C");
    list.add("E");

    Iterator<String> it = list.iterator();
    String s = it.next();
    System.out.println(s);
    s = it.next();
    System.out.println(s);

    Collections.sort(list);
    Iterator<String> it2 = list.iterator();

    s = it.next();
    System.out.println(s);
    s = it.next();
    System.out.println(s);
    s = it.next();
    System.out.println(s);

    while (it2.hasNext()) {
        System.out.println(it2.next());
    }
    } 
```

希望能帮助到你。

# svn - 使用 TortoiseSVN 如何将更改从主干合并到分支，反之亦然？

> ID：299142
> 
> 赞同：135
> 
> 时间：2008-11-18T15:50:12.493
> 
> 标签：svn, tortoisesvn, merge, branch

我一直在阅读有关使用 Subversion 1.5 进行分支/合并的文章，使用优秀且免费的[版本控制与 Subversion](http://svnbook.red-bean.com/)书。我认为我了解如何使用 Subversion 命令行客户端来执行我最需要的操作，它们是：

**使用来自主干的更改更新分支**

从分支的工作目录运行：

> svn 合并[http://svn.myurl.com/proj/trunk](http://svn.myurl.com/proj/trunk)

**将分支合并到主干**

从主干的工作目录运行：

> svn merge --reintegrate [http://svn.myurl.com/proj/branches/mybranch](http://svn.myurl.com/proj/branches/mybranch)

但是，我们使用 TortoiseSVN 1.5 作为 Subversion 的接口。我想知道如何最好地使用 TortoiseSVN 执行这些操作。新对话框在主菜单上提供了三个不同的选项。

1.  合并一系列修订
2.  重新整合分支
3.  合并两棵不同的树

据我所知，TortoiseSVN 总是使用以下语法执行 svn。

> svn merge [--dry-run] --force From_URL@revN To_URL@revM PATH

此外，重新集成分支通常会失败，并显示一条消息，指出某些目标尚未合并，因此无法继续，因此我不得不使用选项 #3。

我的问题是：

1.  如何使用 TortoiseSVN 1.5 将更改从主干合并到分支？
2.  如何使用 TortoiseSVN 1.5 将分支合并到主干，使用和不使用 reintegrate 方法？
3.  我应该为每个选项使用上述哪个选项，为什么？

* * *

**编辑**

通过“试运行”测试我发现命令行 Subversion 操作

> svn 合并[http://svn.myurl.com/proj/trunk](http://svn.myurl.com/proj/trunk)

类似于 TortoiseSVN 中的选项 #1（合并修订范围），只要我将修订范围留空。

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2013-03-27T12:31:24.833

我无法正确遵循其他答案，这里有更多的傻瓜指南......

`trunk -> branch`你可以这样做`branch -> trunk`。我总是先`trunk -> branch`解决那里的任何冲突，然后再合并`branch -> trunk`。

### 将主干合并到分支/标签中

1.  **签出分支/标签**
2.  右键单击分支的根 | 乌龟SVN | 合并...
3.  **合并类型：**合并一系列修订 | 点击下一步' ![在此处输入图像描述](https://i.stack.imgur.com/JfV4b.png)
4.  **合并修订范围：**选择您复制到分支/标签的主干目录的 URL。输入要合并的修订或将该字段留空以合并所有修订 | 点击下一步' ![在此处输入图像描述](https://i.stack.imgur.com/Y0X12.png)
5.  **合并选项：**我只是将这些保留为默认值 | 点击“合并” ![在此处输入图像描述](https://i.stack.imgur.com/foKHp.png)
6.  这会将修订合并到签出的分支/标签中
7.  然后将合并的更改提交到分支/标签

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-11-18T17:44:45.913

行为取决于您的存储库具有哪个版本。Subversion 1.5 允许 4 种类型的合并：

1.  合并 sourceURL1[@N] sourceURL2[@M] [WCPATH]
2.  合并源WCPATH1@N 源WCPATH2@M [WCPATH]
3.  合并 [-c M[,N...] | -r N:M ...] 源[@REV] [WCPATH]
4.  合并 --reintegrate SOURCE[@REV] [WCPATH]

1.5 之前的 Subversion 只允许前 2 种格式。

从技术上讲，您可以使用前两种方法执行所有合并，但后两种方法启用 subversion 1.5 的合并跟踪。

TortoiseSVN 的选项在您的存储库为 1.5+ 时将一个范围或修订映射合并到方法 3，或者当您的存储库较旧时合并到方法一。

将功能合并到发布/维护分支时，您应该使用“合并一系列修订”命令。

只有当您想将分支的所有功能合并回父分支（通常是主干）时，您才应该考虑使用“重新集成分支”。

最后一个命令 - 合并两个不同的树 - 仅在您想要超出正常分支行为时才有用。（例如比较不同的版本，然后将不同的版本合并到另一个分支）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-18T16:02:42.157

您应该使用“合并一系列修订”。

要将主干的更改合并到分支，请在分支工作副本中选择“合并修订范围”并输入主干 URL 以及要合并的开始和结束修订。

同样以相反的方式在主干中合并一个分支。

关于 --reintegrate 标志，请在此处查看手册：http: [//tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-merge.html#tsvn-dug-merge-reintegrate](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-merge.html#tsvn-dug-merge-reintegrate)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T17:59:21.483

看看[svnmerge.py](http://www.orcaware.com/svn/wiki/Svnmerge.py)。它是命令行的，不能被 TortoiseSVN 调用，但它更强大。从[常见问题解答](http://www.orcaware.com/svn/wiki/Svnmerge.py#FAQ)：

> 传统的颠覆将让您合并更改，但它不会“记住”您已经合并的内容。它也没有提供一种方便的方法来排除更改集的合并。svnmerge.py 自动化了一些工作，并简化了它。Svnmerge 还使用来自它合并的所有事物的日志消息创建提交消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-02T18:03:41.300

Shift-右键单击该文件夹并选择 TortoiseSVN -> Merge All

# flash - 如何在 Flash 中设置透明的精灵背景？

> ID：299148
> 
> 赞同：2
> 
> 时间：2008-11-18T15:50:47.750
> 
> 标签：flash, actionscript-2

我正在玩这个生成随机“曲线”的[ActionScript 。](http://www.dncompute.com/blog/2007/03/19/seed-based-pseudorandom-number-generator-in-actionscript.html)

每次放置“曲线”时，它都会出现在具有白色背景的精灵中。

例如，如果我将 Flash 文件的背景颜色更改为粉红色，它仍会显示为白色。

有人知道我如何使精灵背景透明吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T17:50:03.610

在 RandomSquiggle.as 中将第 76 行从

```
bitmapData = new BitmapData(width,height,false,0xfafafa); 
```

到

```
bitmapData = new BitmapData(width,height,true,0x000000); 
```

第三个参数是透明度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T17:46:58.390

这不是一个实际的 Sprite（Sprite 是一种 AS3 数据类型），它只是一个称为“sprite”的 MovieClip。我看到在代码中，曲线实际上被绘制到一个名为“paintSurface”的电影剪辑上，然后当它完成时，“paintSurface”的位图通过这一行被捕获：

```
bitmapData.draw(paintSurface); 
```

然后将其附加到此处的“精灵”MovieClip：

```
sprite.attachBitmap(bitmapData, 3); 
```

这可能就是你得到白色背景的原因。

我假设为了处理速度而捕获位图。

如果您不捕获位图，而是将“paintSurface”附加到“sprite”，也许您可​​以看到会发生什么。

# wcf - WCF留在这里？

> ID：299150
> 
> 赞同：3
> 
> 时间：2008-11-18T15:51:21.040
> 
> 标签：wcf

目前正在阅读一本相当沉重的 WCF 书籍。我曾经在生产中使用过它一次，使用 tcp，很有魅力。无论如何，您对这项技术有什么看法，它会继续存在吗，是否值得花时间学习所有复杂的功能等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T15:56:58.360

我认为它会留下来。它可以很容易地为移动端点进行配置，它看起来很健壮，并且允许您（几乎）执行您在 Web 服务和远程处理中可以执行的所有操作，而无需单独实现的开销。

我可以看到您来自哪里，MS 最近泄露了有关持续支持和维护 Linq to SQL 的信息，但我认为 WCF 完全是一个不同的野兽。这是一种允许互操作性的技术，以及去复杂化（我知道这不是一个真实的词，但它应该是）系统之间的通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T18:54:06.117

我赞同 ZombieSheep 所说的话。虽然复杂，但它极大地简化了跨物理和逻辑边界分布应用程序，促进互操作性，并且主要解耦了实现细节，如用于通信的端口/协议。

绝对值得花时间学习，尽管取决于解决方案，它有时可能是矫枉过正。我想你会发现随着版本的继续，配置会变得更容易——尽管这纯粹是猜测。

虽然 Linq to SQL 在实体框架中有一个更大的表亲，但 WCF 没有这样的亲戚。它留在这里。

# sql - SQL 动作关键字

> ID：299158
> 
> 赞同：0
> 
> 时间：2008-11-18T15:53:08.697
> 
> 标签：sql, triggers

SQL Action 关键字有什么作用？我可以在触发器中使用此关键字并确定触发器是否由插入、删除或更新调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T16:35:26.303

ACTION 保留用于 ODBC 函数调用。[这些词不限制最低 SQL 语法；但是，为确保与支持核心 SQL 语法的驱动程序兼容，应用程序应避免使用这些关键字。](http://msdn.microsoft.com/en-us/library/aa238507.aspx)

要在某些步骤上创建触发器，您所要做的就是在创建触发器期间指定哪些步骤。您不必像下面的示例那样将所有三个选项都放置，您可以根据您的目标放置 3 个选项的任意组合

```
CREATE TRIGGER TriggerName
ON TableName
  [FOR|AFTER|INSTEAD OF]
  AFTER,UPDATE,DELETE
AS
 ... 
```

如果您需要确定其中哪一个称为触发器，您应该检查插入和删除的表，如下所示。

```
IF EXISTS (SELECT TOP 1 * FROM Inserted) AND NOT EXISTS (SELECT TOP 1 * FROM Deleted) --INSERT
  ...

IF EXISTS (SELECT TOP 1 * FROM Inserted) AND EXISTS (SELECT TOP 1 * FROM Deleted) --UPDATE
  ...

IF NOT EXISTS (SELECT TOP 1 * FROM Inserted) AND EXISTS (SELECT TOP 1 * FROM Deleted) --DELETE
  ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T15:58:37.670

不，你不能用它。但是您可以查看[Inserted 和 Deleted](http://msdn.microsoft.com/en-us/library/aa214435(SQL.80).aspx)表以了解发生了什么。

一个不同的基本示例将如下所示：

```
If exists (select * from inserted) and exists (select * from deleted)
    --Update happened
If exists (select * from inserted)
    --Insert happened
If exists (select * from deleted)
    --Delete happened
Else
    --Nothing happened 
```

但实际上，这仅取决于您需要做什么。在某些情况下，您最终可能只是通过主键加入这些表并执行各种操作。

但是，如果您在问题中发布有关您正在尝试的内容的更多详细信息，则提供更具体的回复会更容易。

# .net - jQuery .Net 部署问题

> ID：299160
> 
> 赞同：1
> 
> 时间：2008-11-18T15:53:33.377
> 
> 标签：.net, jquery, deployment

刚开始使用 jQuery，并且在我的本地开发框（VS 2008 内置 Web 服务器）上完美运行 jQuery Post 调用时遇到问题，但是当我部署到 Windows 2003 服务器（IIS 6）框时失败。

帖子可以正常工作，并且发布的页面可以正确处理事情，但调用 Post 函数从未收到响应。提交页面只是重新加载，没有任何变化。

这是我的 Post 函数（它包含在`$(document).ready(function() {...`

响应函数中的警报永远不会触发：

```
 $('.nextButton').click(function() {

            var idString = '';

            $("div.dropZone > div").each(function(n) {
                idString += this.id + '|';
            });

            $.post('CustomPostHandler.aspx?step=criteria', { 
                selected: idString
            },
                function(data) {
                    alert(data);
                });
        }); 
```

后处理程序页面确实收到了 idString 变量，经过一些处理后它会尝试写回响应：

```
 // Return dummy response to caller
        Response.Clear();
        Response.ContentType = "text/plain";
        Response.Write("success");
        Response.End(); 
```

我检查了部署服务器环境，没有发现任何缺失（这是针对 3.5 SP1 框架运行的）。任何人有任何想法或我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T16:02:12.063

问题可能是由于缓存。
尝试在帖子 URL 中添加一个随机数

```
$.post('CustomPostHandler.aspx?step=criteria&random=' + Math.random().toString(), { 
            selected: idString
        }, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T19:20:08.950

我同意这可能是由于缓存。更通用的`$.ajax`功能允许您将缓存选项设置为 false 以禁用缓存。

看看[文档](http://docs.jquery.com/Ajax/jQuery.ajax#options)。

# database - 比较：数据库全文搜索到搜索引擎（Lucene）

> ID：299167
> 
> 赞同：3
> 
> 时间：2008-11-18T15:54:59.753
> 
> 标签：database, full-text-search, lucene, scaling

从 stackoveflow.com 的角度来看（由 2-3 名工程师组成的团队构建一个旨在扩展的网站项目），在开发过程的早期花费精力来构建基于 Lucene/Autonomy 的搜索是否有意义……而不是基于数据库全文搜索。

优点/缺点：
对于像 nutch 或自治这样的成熟 Lucene 实现，在后期迁移到 Lucene（这是不可避免的）的成本可以忽略不计。
大量添加额外的索引服务器（比如使用 nutch）来维护不断增长的搜索索引相对容易。
对于 Lucene 实现，我很可能需要一个额外的服务器来维护内存索引（在扩展过程的早期阶段）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T15:57:20.590

数据库全文搜索性能因数据库而异，但它是迄今为止最简单的设置选项。所以从那个开始，如果它被证明太慢，就转向 lucene 或 sphinx。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-22T05:25:32.143

不过，您应该保持隔离 - 如果您知道将用搜索引擎查询替换它们，请不要开始在您的代码中抛出 SELECTS。用一个薄抽象层包裹你的数据库的全文搜索，确保你不使用你不应该使用的数据库功能。

不过，我支持公认的答案-这里的过早优化绝对是邪恶的。

# html - 如何在没有 CSS 的情况下设置 HTML 链接的样式？

> ID：299168
> 
> 赞同：2
> 
> 时间：2008-11-18T15:55:09.237
> 
> 标签：html, css, blackberry

我需要为禁用 CSS 的黑莓浏览器设置链接样式。

以下是我试图实现的目标：

```
<style type="text/css">
a.hover { 
  border:0;
} 
a {
  text-decoration: none;
}
</style> 
```

是否有可能，只使用html？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-18T16:01:25.527

您只能设置颜色。

```
<body link="XXX" alink="YYY" vlink="ZZZ"> 
```

XXX 是用于链接的颜色，YYY 是鼠标悬停链接时的颜色，ZZZ 是已访问链接的颜色。颜色可以像样式表一样以十六进制表示

```
#AABBCC 
```

您无法设置链接是否带下划线，或者是否有边框。这完全取决于浏览器……除非这些设备有一些特殊的、秘密的非标准 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T08:31:30.590

`tex-decoration:bilnk`; 这会让你的文字闪烁，就像说唱歌手一样

# sql - ORACLE SQL：需要对两个值求和，但一个可能不存在......这可能吗？

> ID：299176
> 
> 赞同：2
> 
> 时间：2008-11-18T15:56:50.903
> 
> 标签：sql, oracle, plsql, oracle10g

在将一些旧的 ASP 文件复制到一些较新的 .NET 2.0 代码中时，我遇到了一些问题。其中一项任务是将 4-5 条 SQL 语句合并为一条。虽然我已经做到了这一点并在性能提升方面取得了一些成功，但 Oracle 对我来说是一个新包。然而，这个问题超出了我自己的 SQL 技能，因为我以前没有这样做过。

基本上，我在一堆销售中的一张表中有一个 QUANTITY。每个销售都有一个整数值。每个销售还附有一个项目。每个项目都有一个转换因子，就像我卖 1 袋东西 = 10 捆东西一样。因此，当我运行报告并想找出最终价值时，我需要将每笔销售及其数量乘以它的转换因子。大多数都是简单的 1 对 1，所以它基本上是 25 * 1、30 * 1 等。

我的问题是我的记录中有过去的销售项目已从我们的系统中删除，因此不存在转换因素。这些记录从我的查询中删除，因为 FACTOR 消失了。

```
SELECT rth.CODE, rth.NUMBER, rth.QUANTITY, rth.sale_code 
FROM salesdetails rth, salesheader rsh
WHERE rsh.number = rth.number(+)
AND rsh.customer_code = '05'
AND rsh.r_code = '01'
AND rsh.location_code = '12'
AND rth.sale_code IN('ITEM07')
AND rth.c_code = 'WLMT'
AND rsh.year = '2008' 
```

这是我的第一个查询。如果我将转换添加到：

```
SELECT rth.CODE, rth.NUMBER, rth.QUANTITY, rth.sale_code, rth.quantity * cf.conversion
FROM salesdetails rth, salesheader rsh, conversionfactor cf
WHERE rsh.number = rth.number(+)
AND rsh.customer_code = '05'
AND rsh.r_code = '01'
AND rsh.location_code = '12'
AND rth.sale_code IN('ITEM07')
AND rth.c_code = 'WLMT'
AND rsh.year = '2008'
AND cf.item_code = rth.item_code
and cf.code = '01'
and cf.loc_code = '00001' 
```

这在一定程度上有效。它列出了所有相同的记录，但缺少任何不存在 CONVERSION 因素的记录。无论如何，我仍然可以在第二个查询中包含 FACTOR 不存在的那些记录，而不是逐行进行转换并以这种方式进行转换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T16:33:39.067

您还可以使用 Coalesce 函数，带有子查询......

< 合并(arg0, arg1, arg2, ..... 等 argN)

依次评估每个参数并返回它找到的第一个不是 Null 的参数。>

```
Select D.CODE, D.NUMBER, D.QUANTITY, D.sale_code, 
    D.quantity * Coalesce((Select conversion 
                           From conversionfactor
                           Where item_code = H.item_code
                              And code = '01'
                              And loc_code = '00001'), 1.0)
From salesheader H
   Left Join salesdetails D
     On D.Number = H.Number
Where H.customer_code = '05'
   And H.r_code = '01'
   And H.location_code = '12'
   And H.year = '2008'
   And D.sale_code In ('ITEM07')
   And D.c_code = 'WLMT' 
```

当记录不再在转换因子表中时，将子查询末尾的 1.0 替换为您希望转换因子的“默认”值是什么...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T16:28:45.100

**从 rsh 到 rth 的外部**连接然后从 rth 到 cf 的**内部**连接是没有意义的。使它们都成为外部连接。此外， (+) 符号必须出现在 rth 的所有连接条件的“外侧”：

```
SELECT rth.CODE, rth.NUMBER, rth.QUANTITY, rth.sale_code,
       rth.quantity * cf.conversion
FROM salesdetails rth, salesheader rsh, conversionfactor cf
WHERE rsh.number = rth.number(+)
AND rsh.customer_code = '05'
AND rsh.r_code = '01'
AND rsh.location_code = '12'
AND rth.sale_code (+) IN('ITEM07')
AND rth.c_code (+) = 'WLMT'
AND rsh.year = '2008'
AND cf.item_code (+) = rth.item_code
and cf.code (+) = '01'
and cf.loc_code (+) = '00001' 
```

顺便说一句，这是非常老式的语法。为什么不使用更现代的：

```
SELECT rth.CODE, rth.NUMBER, rth.QUANTITY, rth.sale_code,
       rth.quantity * cf.conversion
FROM salesheader rsh
LEFT OUTER JOIN salesdetails rth
   ON  rsh.number = rth.number
   AND rth.sale_code IN ('ITEM07')
   AND rth.c_code = 'WLMT'
LEFT OUTER JOIN conversionfactor cf
   ON  cf.item_code = rth.item_code
   AND cf.code = '01'
   AND cf.loc_code = '00001'
WHERE rsh.customer_code = '05'
AND rsh.r_code = '01'
AND rsh.location_code = '12'
AND rsh.year = '2008' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T16:10:44.713

现在我无法访问 Oracle。看看这个查询：

```
SELECT rth.CODE, rth.NUMBER, rth.QUANTITY, rth.sale_code, rth.quantity * cf.conversion
FROM salesdetails rth, salesheader rsh, conversionfactor cf
WHERE rsh.number = rth.number(+)
AND rsh.customer_code = '05'
AND rsh.r_code = '01'
AND rsh.location_code = '12'
AND rth.sale_code IN('ITEM07')
AND rth.c_code = 'WLMT'
AND rsh.year = '2008'
AND rth.item_code  =  cf.item_code (+)
and cf.code = '01'
and cf.loc_code = '00001' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T16:14:57.077

不，我相信 OUTER JOIN 不起作用，因为记录实际上并不存在。它不是空的，它只是不存在了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T16:16:27.963

我认为这应该有效。它假设转换因子在不存在时等于 1

```
select 
    rth.code, rth.number, rth.quantity, rth.sale_code, rth.quantity * coalesce(cf.conversion,1)
from 
    salesdetails rth
    inner join  salesheader rsh on rsh.number = rth.number
    left join conversionfactor cf on cf.item_code = rth.item_code
where 
rsh.customer_code = '05'
and rsh.r_code = '01'
and rsh.location_code = '12'
and rth.sale_code in('item07')
and rth.c_code = 'wlmt'
and rsh.year = '2008'
and cf.code = '01'
and cf.loc_code = '00001' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T16:23:46.857

我相信 SQL 假设我有一个空记录。我没有，当转换不存在时，我根本没有记录。如果我能找到一种方法为我的数据库中不存在的那些 CONVERSION 返回 null，我可以这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T16:45:57.717

实际上，您对 OUTER JOIN 的看法是正确的。我当时认为它所做的事情存在技术问题，但我明白为什么它仍然没有包含价值。其他两个条件必须是 (+) 才能包含 NULL。我将它与 COALESCE 结合起来，它似乎正在工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-20T04:38:23.987

我想你正在丢失记录，因为你试图乘以一个空值。看看将 NVL() 与您的转换因子一起使用，以将其默认为 1 或其他适合您的默认值。

喜欢，

```
SELECT rth.CODE, rth.NUMBER, rth.QUANTITY, rth.sale_code, rth.quantity * NVL(cf.conversion,1)
FROM salesdetails rth, salesheader rsh, conversionfactor cf
WHERE rsh.number = rth.number(+)
AND rsh.customer_code = '05'
AND rsh.r_code = '01'
AND rsh.location_code = '12'
AND rth.sale_code IN('ITEM07')
AND rth.c_code = 'WLMT'
AND rsh.year = '2008'
AND cf.item_code = rth.item_code
and cf.code = '01'
and cf.loc_code = '00001' 
```

仔细检查 NVL 语法。自从我与 Oracle 合作以来已经有几年了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-28T13:39:48.483

如果您处理空值和数字，请考虑使用“合并”函数，其中列表中的第一个非空值作为结果传回。

# ajax - 在 JSF 中加载 ajax 加载

> ID：299185
> 
> 赞同：1
> 
> 时间：2008-11-18T15:58:25.847
> 
> 标签：ajax, jsf, view, include, subview

好的，这是我的问题：我有一个 JSF 应用程序和一些 JSP 文件。假设我有 main.jsp，它有一个视图并包含 sub.jsp。这工作正常。sub.jsp 包含一个子视图。因此，sub.jsp 中表单元素的所有 ID 都遵循 'subview:component' 的形式。现在假设我正在使用一些 ajax 并想要获取 jsp 页面 sub.jsp 并将其包含在某个 DIV 中。现在 ID 都是“组件”形式的。我不知道如何解决这个问题，并且必须在我的交互式 javascript 中检查 2 组不同的 ID 是一件痛苦的事情。有没有办法获得一致的ID？

我试过：删除子视图 - （然后 AJAX 调用将失败，因为没有找到视图）

和

h:form prependid=false - 这只会删除表单 id，而不是子视图 id

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T17:16:37.047

AJAX 与 JSF 配合起来很棘手。如果您使用的 JSF 框架不支持它，您将遇到许多视图状态问题。

我很惊讶当您直接寻址*sub.jsp时没有引发异常 -* *sub.jsp*中不应该有 h:view并且没有 UIViewRoot，我不确定如何创建 UI 树。如果您在*sub.jsp*中有 ah:view ，那么您将两个 UIViewRoots 放入您的 UI 树中 - 这是一个错误。（JSF 组件树大致类似于 Swing 或 SWT 等其他 Java 小部件工具包。）

我怀疑您正在观察的问题是您提交的视图与最初渲染的视图不同。由于组件树完全不同，clientIds 将从不同的视图根生成。[您可以在此答案](https://stackoverflow.com/questions/265175/how-does-jsf-generate-the-name-of-the-form-input-field#265561)中了解它们是如何构建的。

简而言之，我不认为您用来更新客户端的机制是有效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T15:05:51.773

你看过 ajax4Jsf（又名 Richfaces）吗？

# arrays - 在什么情况下，ATL CSimpleArray 是比 CAtlArray 更好的选择

> ID：299190
> 
> 赞同：1
> 
> 时间：2008-11-18T15:59:16.110
> 
> 标签：arrays, atl

文档说 CSimpleArray 用于处理少量对象。在这种情况下什么是小？CSimpleArray 是一个不错的选择，还是我应该始终使用不同的集合类，例如 CAtlArray？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T18:17:27.390

"Small" here is a rule of thumb, which stems from the way the two classes manage their memory internally. Basically, CAtlArray provides more fine-grained control of the memory it uses, and CSimpleArray deals with memory simply but naively.

Specifically, when an element is added to a CSimpleArray, if the array already uses all the memory it has allocated, it will double its size, which is a fairly expensive operation. A newly created CSimpleArray will start with space for 0 items. So let's say you want to add 5 things to an array. It will look like this:

*   Add 1st item - there is no room, so reallocate space for 1 item in total
*   Add 2nd item - there is no room, so reallocate space for 2 items in total
*   Add 3rd item - there is no room, so reallocate space for 4 items in total
*   Add 4th item - there is room, so just add
*   Add 5th item - there is no room, so reallocate space for 8 items in total
*   and so on...

Also note that there is no way to specify the initial size of a CSimpleArray, so this patten will always happen.

On the other hand, a CAtlArray allows you to specify the allocated memory all at once, via the SetCount( ) method. Using the same example as above, before adding the items, call SetCount(5). Then there will always be room for 5 items and no reallocations need to be done.

So to answer the question: use CAtlArray if you care about memory management, especially if you are worried abot performance. Use CSimpleArray if you just want to keep a few items in a list and don't care how the memory the list occupies is managed. To answer the specific question about what "small" and "large" mean in this context, "small" means few enough elements that it's ok with you to reallocate every time the length exceeds the next power of 2.

It's also worthwhile to note that CSimpleArray lets you search through the Array using the Find( ) method, and CAtlArray does not.

(Note: my answer is based only on looking through the ATL source code.)

# tomcat - 用iis6前端tomcat最常用的方法是什么

> ID：299191
> 
> 赞同：4
> 
> 时间：2008-11-18T15:59:20.057
> 
> 标签：tomcat, iis-6, webserver

我想在 IIS 6 后面运行一些 tomcat Web 应用程序。我想知道最常见的实现方式是什么。我已经使用 Apache 使用 AJP 连接器和 HTTP proxypass 完成了这项工作。这是否与 IIS 6 相同？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T15:39:17.133

## IIS-Tomcat 重定向器

您可以使用 IIS-Tomcat Redirector，这是实现此目的的常用插件。

Tomcat 有一个非常简洁的文档关于如何做到这一点，可以在以下位置找到：

**[http://tomcat.apache.org/connectors-doc-archive/jk2/jk/iishowto.html](http://tomcat.apache.org/connectors-doc-archive/jk2/jk/iishowto.html)**

和

**[http://tomcat.apache.org/connectors-doc/webserver_howto/iis.html](http://tomcat.apache.org/connectors-doc/webserver_howto/iis.html)**

* * *

替代快速修复

或者，您可以使用下面链接中提供的 MSI 设置，*“它允许您跳过本页“配置 ISAPI 重定向器”部分中的步骤 1 到 7”*

**[http://wiki.apache.org/tomcat/Tomcat_and_IIS_Howto](http://wiki.apache.org/tomcat/Tomcat_and_IIS_Howto)**

希望有帮助

# wpf - 属性“Pages”不包含对 PageContentCollection 类型的支持

> ID：299195
> 
> 赞同：2
> 
> 时间：2008-11-18T16:00:15.967
> 
> 标签：wpf

我在下面代码的第二行收到以下错误：

错误是：属性“页面”不包含对 PageContentCollection 类型的支持。

这是我的完整代码：

```
 <FixedDocument Name="customerReport">

        <PageContent>
           <FixedPage>
            <Label FontSize="20" Margin="100,20,0,0">REPORT</Label>            
            <ListView  BorderThickness="0" Margin="50,100,0,0" FontSize="14" Width="Auto" Height="Auto" ItemsSource="{Binding}">
              <ListView.View>
                <GridView x:Name="gridReport">             

                  <GridViewColumn Width="200" Header="FirstName" DisplayMemberBinding="{Binding Path=FirstName}">

                    <GridViewColumn.CellTemplate>
                      <DataTemplate>
                        <Label/>
                      </DataTemplate>
                    </GridViewColumn.CellTemplate>
                  </GridViewColumn>
                  <GridViewColumn Width="200" Header="LastName" DisplayMemberBinding="{Binding Path=LastName}">
                    <GridViewColumn.CellTemplate>
                      <DataTemplate>
                        <Label/>
                      </DataTemplate>
                    </GridViewColumn.CellTemplate>
                  </GridViewColumn>
                </GridView>
              </ListView.View>
            </ListView>        

          </FixedPage>   
        </PageContent>

      </FixedDocument> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T19:06:48.633

刚刚发现这是一个已知的错误：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=293646](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=293646)

# c# - 实现 C# 通用超时

> ID：299198
> 
> 赞同：158
> 
> 时间：2008-11-18T16:00:43.440
> 
> 标签：c#, multithreading, c#-3.0, asynchronous, timeout

我正在寻找实现通用方法的好主意，以使单行（或匿名委托）代码在超时时执行。

```
TemperamentalClass tc = new TemperamentalClass();
tc.DoSomething();  // normally runs in 30 sec.  Want to error at 1 min 
```

我正在寻找一种可以在我的代码与气质代码交互的许多地方优雅地实现的解决方案（我无法更改）。

此外，如果可能的话，我希望停止执行有问题的“超时”代码。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2008-11-18T16:31:14.017

这里真正棘手的部分是通过将执行程序线程从 Action 传递回可以中止的地方来终止长时间运行的任务。我通过使用一个包装的委托来实现这一点，该委托将要杀死的线程传递到创建 lambda 的方法中的一个局部变量中。

我提交这个例子，为了你的享受。您真正感兴趣的方法是 CallWithTimeout。 **这将通过中止它并吞下 ThreadAbortException 来取消长时间运行的线程**：

用法：

```
class Program
{

    static void Main(string[] args)
    {
        //try the five second method with a 6 second timeout
        CallWithTimeout(FiveSecondMethod, 6000);

        //try the five second method with a 4 second timeout
        //this will throw a timeout exception
        CallWithTimeout(FiveSecondMethod, 4000);
    }

    static void FiveSecondMethod()
    {
        Thread.Sleep(5000);
    } 
```

做这项工作的静态方法：

```
 static void CallWithTimeout(Action action, int timeoutMilliseconds)
    {
        Thread threadToKill = null;
        Action wrappedAction = () =>
        {
            threadToKill = Thread.CurrentThread;
            try
            {
                action();
            }
            catch(ThreadAbortException ex){
               Thread.ResetAbort();// cancel hard aborting, lets to finish it nicely.
            }
        };

        IAsyncResult result = wrappedAction.BeginInvoke(null, null);
        if (result.AsyncWaitHandle.WaitOne(timeoutMilliseconds))
        {
            wrappedAction.EndInvoke(result);
        }
        else
        {
            threadToKill.Abort();
            throw new TimeoutException();
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2009-06-13T11:54:11.350

**我们在生产中大量使用这样的代码**：

```
var result = WaitFor<Result>.Run(1.Minutes(), () => service.GetSomeFragileResult()); 
```

实施是开源的，即使在并行计算场景中也能高效工作，并且作为[Lokad 共享库的一部分提供](https://github.com/Lokad/lokad-shared-libraries)

```
/// <summary>
/// Helper class for invoking tasks with timeout. Overhead is 0,005 ms.
/// </summary>
/// <typeparam name="TResult">The type of the result.</typeparam>
[Immutable]
public sealed class WaitFor<TResult>
{
    readonly TimeSpan _timeout;

    /// <summary>
    /// Initializes a new instance of the <see cref="WaitFor{T}"/> class, 
    /// using the specified timeout for all operations.
    /// </summary>
    /// <param name="timeout">The timeout.</param>
    public WaitFor(TimeSpan timeout)
    {
        _timeout = timeout;
    }

    /// <summary>
    /// Executes the spcified function within the current thread, aborting it
    /// if it does not complete within the specified timeout interval. 
    /// </summary>
    /// <param name="function">The function.</param>
    /// <returns>result of the function</returns>
    /// <remarks>
    /// The performance trick is that we do not interrupt the current
    /// running thread. Instead, we just create a watcher that will sleep
    /// until the originating thread terminates or until the timeout is
    /// elapsed.
    /// </remarks>
    /// <exception cref="ArgumentNullException">if function is null</exception>
    /// <exception cref="TimeoutException">if the function does not finish in time </exception>
    public TResult Run(Func<TResult> function)
    {
        if (function == null) throw new ArgumentNullException("function");

        var sync = new object();
        var isCompleted = false;

        WaitCallback watcher = obj =>
            {
                var watchedThread = obj as Thread;

                lock (sync)
                {
                    if (!isCompleted)
                    {
                        Monitor.Wait(sync, _timeout);
                    }
                }
                   // CAUTION: the call to Abort() can be blocking in rare situations
                    // http://msdn.microsoft.com/en-us/library/ty8d3wta.aspx
                    // Hence, it should not be called with the 'lock' as it could deadlock
                    // with the 'finally' block below.

                    if (!isCompleted)
                    {
                        watchedThread.Abort();
                    }
        };

        try
        {
            ThreadPool.QueueUserWorkItem(watcher, Thread.CurrentThread);
            return function();
        }
        catch (ThreadAbortException)
        {
            // This is our own exception.
            Thread.ResetAbort();

            throw new TimeoutException(string.Format("The operation has timed out after {0}.", _timeout));
        }
        finally
        {
            lock (sync)
            {
                isCompleted = true;
                Monitor.Pulse(sync);
            }
        }
    }

    /// <summary>
    /// Executes the spcified function within the current thread, aborting it
    /// if it does not complete within the specified timeout interval.
    /// </summary>
    /// <param name="timeout">The timeout.</param>
    /// <param name="function">The function.</param>
    /// <returns>result of the function</returns>
    /// <remarks>
    /// The performance trick is that we do not interrupt the current
    /// running thread. Instead, we just create a watcher that will sleep
    /// until the originating thread terminates or until the timeout is
    /// elapsed.
    /// </remarks>
    /// <exception cref="ArgumentNullException">if function is null</exception>
    /// <exception cref="TimeoutException">if the function does not finish in time </exception>
    public static TResult Run(TimeSpan timeout, Func<TResult> function)
    {
        return new WaitFor<TResult>(timeout).Run(function);
    }
} 
```

* * *

这段代码还是有问题的，你可以试试这个小测试程序：

```
 static void Main(string[] args) {

         // Use a sb instead of Console.WriteLine() that is modifying how synchronous object are working
         var sb = new StringBuilder();

         for (var j = 1; j < 10; j++) // do the experiment 10 times to have chances to see the ThreadAbortException
         for (var ii = 8; ii < 15; ii++) {
            int i = ii;
            try {

               Debug.WriteLine(i);
               try {
                  WaitFor<int>.Run(TimeSpan.FromMilliseconds(10), () => {
                     Thread.Sleep(i);
                     sb.Append("Processed " + i + "\r\n");
                     return i;
                  });
               }
               catch (TimeoutException) {
                  sb.Append("Time out for " + i + "\r\n");
               }

               Thread.Sleep(10);  // Here to wait until we get the abort procedure
            }
            catch (ThreadAbortException) {
               Thread.ResetAbort();
               sb.Append(" *** ThreadAbortException on " + i + " *** \r\n");
            }
         }

         Console.WriteLine(sb.ToString());
      }
   } 
```

有一个竞争条件。很明显，在调用该方法后会引发 ThreadAbortException `WaitFor<int>.Run()`。我没有找到解决此问题的可靠方法，但是通过相同的测试，我无法重现*TheSoftwareJedi*接受的答案的任何问题。

[![在此处输入图像描述](https://i.stack.imgur.com/iX0X8.png)](https://i.stack.imgur.com/iX0X8.png)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-18T16:06:17.530

好吧，你可以用委托做事（BeginInvoke，用回调设置一个标志——原始代码等待那个标志或超时）——但问题是很难关闭正在运行的代码。例如，杀死（或暂停）一个线程是危险的......所以我认为没有一种简单的方法可以稳健地做到这一点。

我会发布这个，但请注意它并不理想 - 它不会停止长时间运行的任务，并且在失败时不会正确清理。

```
 static void Main()
    {
        DoWork(OK, 5000);
        DoWork(Nasty, 5000);
    }
    static void OK()
    {
        Thread.Sleep(1000);
    }
    static void Nasty()
    {
        Thread.Sleep(10000);
    }
    static void DoWork(Action action, int timeout)
    {
        ManualResetEvent evt = new ManualResetEvent(false);
        AsyncCallback cb = delegate {evt.Set();};
        IAsyncResult result = action.BeginInvoke(cb, null);
        if (evt.WaitOne(timeout))
        {
            action.EndInvoke(result);
        }
        else
        {
            throw new TimeoutException();
        }
    }
    static T DoWork<T>(Func<T> func, int timeout)
    {
        ManualResetEvent evt = new ManualResetEvent(false);
        AsyncCallback cb = delegate { evt.Set(); };
        IAsyncResult result = func.BeginInvoke(cb, null);
        if (evt.WaitOne(timeout))
        {
            return func.EndInvoke(result);
        }
        else
        {
            throw new TimeoutException();
        }
    } 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-15T15:11:33.990

对 Pop Catalin 的最佳答案的一些小改动：

*   函数而不是动作
*   超时值错误引发异常
*   在超时的情况下调用 EndInvoke

添加了重载以支持信号工作者取消执行：

```
public static T Invoke<T> (Func<CancelEventArgs, T> function, TimeSpan timeout) {
    if (timeout.TotalMilliseconds <= 0)
        throw new ArgumentOutOfRangeException ("timeout");

    CancelEventArgs args = new CancelEventArgs (false);
    IAsyncResult functionResult = function.BeginInvoke (args, null, null);
    WaitHandle waitHandle = functionResult.AsyncWaitHandle;
    if (!waitHandle.WaitOne (timeout)) {
        args.Cancel = true; // flag to worker that it should cancel!
        /* •————————————————————————————————————————————————————————————————————————•
           | IMPORTANT: Always call EndInvoke to complete your asynchronous call.   |
           | http://msdn.microsoft.com/en-us/library/2e08f6yc(VS.80).aspx           |
           | (even though we arn't interested in the result)                        |
           •————————————————————————————————————————————————————————————————————————• */
        ThreadPool.UnsafeRegisterWaitForSingleObject (waitHandle,
            (state, timedOut) => function.EndInvoke (functionResult),
            null, -1, true);
        throw new TimeoutException ();
    }
    else
        return function.EndInvoke (functionResult);
}

public static T Invoke<T> (Func<T> function, TimeSpan timeout) {
    return Invoke (args => function (), timeout); // ignore CancelEventArgs
}

public static void Invoke (Action<CancelEventArgs> action, TimeSpan timeout) {
    Invoke<int> (args => { // pass a function that returns 0 & ignore result
        action (args);
        return 0;
    }, timeout);
}

public static void TryInvoke (Action action, TimeSpan timeout) {
    Invoke (args => action (), timeout); // ignore CancelEventArgs
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-11-18T17:04:24.480

这就是我的做法：

```
public static class Runner
{
    public static void Run(Action action, TimeSpan timeout)
    {
        IAsyncResult ar = action.BeginInvoke(null, null);
        if (ar.AsyncWaitHandle.WaitOne(timeout))
            action.EndInvoke(ar); // This is necesary so that any exceptions thrown by action delegate is rethrown on completion
        else
            throw new TimeoutException("Action failed to complete using the given timeout!");
    }
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-18T16:13:54.893

我现在刚刚把它淘汰了，所以它可能需要一些改进，但会做你想做的。这是一个简单的控制台应用程序，但演示了所需的原则。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace TemporalThingy
{
    class Program
    {
        static void Main(string[] args)
        {
            Action action = () => Thread.Sleep(10000);
            DoSomething(action, 5000);
            Console.ReadKey();
        }

        static void DoSomething(Action action, int timeout)
        {
            EventWaitHandle waitHandle = new EventWaitHandle(false, EventResetMode.ManualReset);
            AsyncCallback callback = ar => waitHandle.Set();
            action.BeginInvoke(callback, null);

            if (!waitHandle.WaitOne(timeout))
                throw new Exception("Failed to complete in the timeout specified.");
        }
    }

} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-08-12T20:00:40.017

使用 Thread.Join(int timeout) 怎么样？

```
public static void CallWithTimeout(Action act, int millisecondsTimeout)
{
    var thread = new Thread(new ThreadStart(act));
    thread.Start();
    if (!thread.Join(millisecondsTimeout))
        throw new Exception("Timed out");
} 
```

# javascript - Webkit/Safari/Firefox/API：我可以以编程方式读取/提取多个标签的 URL 吗？

> ID：299200
> 
> 赞同：4
> 
> 时间：2008-11-18T16:01:13.033
> 
> 标签：javascript, firefox, safari, applescript, automator

主题：在 OS X 10.4.x+ Tiger/Leopard 中以编程方式操作 Web 浏览器。主题：Webkit、Safari、Firefox、API、Applescript、Automator、Javascript、Ruby、Ruby on Rails、OS X、Tiger 目标：从 Safari 中收集/读取/提取 URL 到文本（Ruby on Rails 代码）文件中。注意：也非常感谢使用 FF 的解决方案。我使用 Safari（v. 3.x，OS X 10.4.x）越来越喜欢在 Safari 中工作的解决方案。

有时，我使用网络浏览器查找/显示多个网站页面，我 1) 想稍后再次访问和 2) 我想将其组合在一个文本文件中的 URL 以供 a) 将来参考和/或 b)以编程方式操作。

例如：在今天的《纽约时报》中，我找到了七篇我想发布到我的 del.icio.us 帐户的 NYT 文章。并在他们成为当天在线版的头条新闻很久之后，通过电子邮件以他们的“打印机友好”格式分享。我在浏览器窗口的点击中打开每一个，然后是 Presto！他们的 URL 自动被放入一个文件中，一个（自定义）Ruby on Rails 应用程序将打印版本的 URL 发送到电子邮件地址和我的 Del.icio.us 帐户。

我认为有一种方法可以使用 Applescript 或 Automator 从操作系统中提取 URL。我认为可能有一种方法可以使用 Javascript 来做到这一点。

我的问题：如何读取网络浏览器选项卡的位置字段并将这些字符串整理到文本文件中（在我的操作系统中或通过网络连接到网络应用程序。）？

非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T02:25:56.750

对于 Safari，这对于 Applescript 来说非常简单。我建议从[书签所有选项卡](http://www.macosxhints.com/article.php?story=20060227192533174)之类的东西开始，以获得您需要的基本选项卡抓取逻辑，并可能将其合并到 John Gruber 的旧[Save and restore Safari URLs](http://daringfireball.net/2003/02/save_and_restore_safari_urls)脚本中，以将 URL 作为列表保存到文本文件.

那里也可能有更好的 Applescript 解决方案；这些只是我通过谷歌找到的第一个，而且都过时了。

有关 Applescript 的更多帮助和资源，我建议您访问[MacScripter 论坛](http://bbs.macscripter.net/)。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T16:24:40.427

如果您想在 Firefox 中做到这一点，您将不得不学习和使用 XUL。这些标签对 javascript 不可见（安全/隐私问题），并且在 firefox 之外没有此类信息的 API。

[Getting Started with XUL development](http://willcode4beer.com/design.jsp?set=gettingStartedWithXUL)是一个很好的资源，可以帮助您开始使用 XUL 进行编程。

IBM为您的第一个 XUL 代码提供了[不错的教程。](http://www.ibm.com/developerworks/edu/x-dw-x-xulintro.html)

这是[XUL](http://piro.sakura.ne.jp/xul/_multipletab.html.en)中的选项卡处理程序，可让您了解如何处理选项卡。

一个[简短的教程，演示](http://www.sitepoint.com/print/xul-nets-biggest-secret-1/)混合 XUL、javascript 和其他技术来更新网站。

最后，这是一个[关于 firefox 扩展/附加组件的优秀 lifehacker 教程，](http://lifehacker.com/software/programming/how-to-build-a-firefox-extension-264490.php)它通过一个简单的示例向您展示了上面的大部分内容，然后是如何将其打包为 .xpi，以便其他人可以轻松地将其添加到他们的 firefox 并对其进行管理。

我对 Safari 没有任何了解，但它基于 webkit，并且应该有一些资源来自定义它，类似于在 Firefox 上使用 XUL 的方式。

祝你好运！

-亚当

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T16:42:26.210

Firefox 中最简单的解决方案是“为所有打开的标签添加书签”（在书签菜单中）。给这个“书签文件夹”一个特定的名称。然后，您可以进入您的个人资料（[http://support.mozilla.com/en-US/kb/Profiles](http://support.mozilla.com/en-US/kb/Profiles)）并打开文件“bookmarks.html”，其中包含您想要的所有信息，然后是一些信息。

如果您想使用 UI，请查看禁忌和“Sitzungs-Manager”（可能是 Session-Manager）。两者都适用于 Firefox 3.0+

Taboo 允许您保存标签以供“以后阅读”（有点像书签菜单，但只需单击一下；也会保存页面的屏幕截图）。

会话管理器插件允许您保存当前打开的选项卡和窗口并在以后恢复它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-26T20:46:42.837

这是一个 AppleScript 的脚本，它应该可以帮助您（该脚本适用于 Safari）...

```
property these_URLs : {}
set the text item delimeters of AppleScript to ""
----------------------------------------------------------------------------------
--Initialize the program
set the action to the button returned of (display dialog "Create or view a list of favorites..." buttons{"Cancel","View","Create"} default button 3)
if the action is "Create" then
    create_text_file()
else
    open_favorites()
end if

---------------------------------SUBROUTINES--------------------------------------

on create_text_file()
    --get the URL of every tab of every window
    tell application "Safari"
        set theWindows to (get every document) as list
        repeat with i from 1 to the count of theWindows
            set this_Window to item i of theWindows
            set theTabs to (get every tab of this_Window) as list
            repeat with x from 1 to the count of theTabs
                set this_Tab to item x of theTabs
                set this_URL to (the URL of this_tab) as string
                set the end of these_URLs to this_URL
            end repeat
        end repeat
    end tell

    --put the URLs into a text document
    set newFile to (choose file name with prompt "Choose a name and location for the new file:" default location (path to desktop folder))
    try
        open for access newFile with write permission
        set the text item delimiters of AppleScript to return
        set the_URLs to these_URLs as string
        write the_URLS to file newFile
        close access newFile
    on error
        try
            close access newFile
        end try
    end try
    set the text item delimiters of AppleScript to ""
end create_text_file()

on open_favorites()
   --Verify whether you have saved any favorites with this script
   if these_URLs is {} then display dialog "You have not added any favorites with this script." with icon note buttons{"Cancel"}
   --there are favorites so open all the URLs you stored in the text file
   repeat with i from 1 to the count of these_URLs
       set this_URL to item i of these_URLs
       tell application "Safari" to make new tab at the end of tabs of document 1 with properties {URL:this_URL}
   end repeat
end open_favorites 
```

如果你有问题，就问吧。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-02T18:27:33.073

您可以修改此位 0 代码以帮助您入门。我用它为一个标签构建了我自己的个人书签插件。您可以在 xul 窗口中弹出 url 列表，然后选择要发布/代理到一个地方的那些。

```
function getGetDocData(){
var wm = Components.classes["@mozilla.org/appshell/window-mediator;1"]
               .getService(Components.interfaces.nsIWindowMediator);
var mainWindow = wm.getMostRecentWindow("navigator:browser");
var tab  = mainWindow.getBrowser().selectedTab;
titleDG = tab.label;
for(var i = 0; i < window.opener.length; i++){
    var doc = window.opener[i].document;
    if(doc.title == tab.label){
        hrefToDG = doc.location.href;
    }
} 
```

}

# c# - 将存储的 proc 输出参数转储到 DataGridView 行中

> ID：299209
> 
> 赞同：0
> 
> 时间：2008-11-18T16:04:53.540
> 
> 标签：c#, sql-server, user-interface, stored-procedures, datagridview

我是 c# 的长期新手，这个问题可能太明显了，所以如果我“做错了”，请原谅。

使用 Visual Studio 2005 Pro、C#、SQL Server 2000 EE SP3。

我有一个存储过程，它接受一个输入参数并返回与该输入有关的几个输出参数。我也成功调用它，并将输出 String.Format-ing 到 RichTextBox 中。我想定期调用这个过程，每次都将输出参数粘贴到 DataGridView 行中，因此结果会随着时间的推移而累积。

*   将这些参数放入 DataGridView 的最简单/最优雅的方法是什么？我更喜欢代码而不是一些 GUI 构建器解决方案。
*   我是否忽略了一些更好的方法，例如更合适的控制？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T16:14:27.607

```
//set up the datatable
DataTable dt = new DataTable("parms");
dt.Columns.Add("ParmName",typeof(string));
dt.Columns.Add("ParmValue",typeof(string));
//bind to a gui object
myDataGridView.DataSource = dt;

//do this after each sproc call
foreach (SqlParameter parm in cmd.Parameters)
{
    if (parm.Direction == ParameterDirection.Output)
    {
        //do something with parm.Value
        dt.Rows.Add(new object [] { parm.ParameterName, 
            Convert.ToString(parm.Value) } );
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T16:56:47.927

史蒂夫的回答让我很接近。我不确定 DataGridView 是最好的解决方案，但它似乎正在工作。

在 Form() 中，在 InitializeComponent() 之后，我放置了列设置代码（因为我想定期添加行）：

```
dgvOutput.Columns.Add("@col1", "Val 1");
dgvOutput.Columns.Add("@col2", "Val 2");
dgvOutput.Columns.Add("@col3", "Val 3"); 
```

并在按钮处理程序中，调用存储过程后

```
dgvOutput.Rows.Add(new object[]{
    Convert.ToString(cmd.Parameters["@col1"].Value),
    Convert.ToString(cmd.Parameters["@col2"].Value),
    Convert.ToString(cmd.Parameters["@col3"].Value)
});
dgvOutput.AutoResizeColumns(); 
```

# c# - .Net Forms（不是 asp.net）中托管的 Flash ActiveX 的高效数据绑定

> ID：299215
> 
> 赞同：0
> 
> 时间：2008-11-18T16:07:55.127
> 
> 标签：c#, winforms, apache-flex

[此问题](https://stackoverflow.com/questions/43533/embedding-flv-flash-player-in-windows-forms)询问有关在 .net 中嵌入 Flash 播放器的问题。提供的答案是在表单上托管 ActiveX Flash 播放器。

这适用于简单的事情，例如播放 Flash 电影。但是，如果您想将 .net 应用程序托管的数据提供给 flex 应用程序怎么办？有没有一种有效的方法将数据从 .net 应用程序传输到 flex 运行时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-27T04:05:57.713

您必须使用 XML 或 JSON 返回值创建 Web 服务，和/或您可以通过 .net 将查询字符串数据传递给 flex 应用程序。

# c# - 保存附件

> ID：299217
> 
> 赞同：3
> 
> 时间：2008-11-18T16:08:33.720
> 
> 标签：c#, .net, outlook, attachment

我正在尝试监视我的 Outlook 收件箱，因此每当新电子邮件带有附件时，我都会将附件保存到其他位置。谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T16:15:57.013

这不是一个完整的解决方案，但它描述了您将在 Outlook API 中使用的一些基本工具。

从[使用 ASP.NET、C# 访问 Outlook 电子邮件](http://hspinfo.wordpress.com/tag/outlook-email-using-c/)：

```
using Outlook;

 Outlook.Application oOutlook;
 Outlook.NameSpace oNs;
 Outlook.MAPIFolder oFldr;
 long iAttachCnt;

 try
 {
     oOutlook = new Outlook.Application();
     oNs = oOutlook.GetNamespace(”MAPI”);

     //getting mail folder from inbox
     oFldr = oNs.GetDefaultFolder(OlDefaultFolders.olFolderInbox);
     Response.Write(”Total Mail(s) in Inbox :” + oFldr.Items.Count + “&lt;br>”);
     Response.Write(”Total Unread items = ” + oFldr.UnReadItemCount);
     foreach (Outlook.MailItem oMessage in oFldr.Items)
     {
         StringBuilder str = new StringBuilder();
         str.Append(”&lt;table style=’border:1px solid gray;font-family:Arial;font-size:x-small;width:80%;’ align=’center’&gt;<tr><td style=’width:20%;’&gt;<b>Sender :</b></td><td>”);
         str.Append(oMessage.SenderEmailAddress.ToString() + “&lt;/td></tr>”);
         //basic info about message
         str.Append(”&lt;tr><td><b>Date :</b></td><td>” + oMessage.SentOn.ToShortDateString() + “&lt;/td></tr>”);
         if (oMessage.Subject != null)
         {
             str.Append(”&lt;tr><td><b>Subject :</b></td><td>” + oMessage.Subject.ToString() + “&lt;/td></tr>”);
         }
         //reference and save all attachments

         iAttachCnt = oMessage.Attachments.Count;
         if (iAttachCnt > 0)
         {
             for (int i = 1; i <= iAttachCnt; i++)
             {
                 str.Append(”&lt;tr><td><b>Attachment(” + i.ToString() + “) :</b></td><td>” + oMessage.Attachments[i].FileName + “&lt;/td></tr>”);
             }
         }
         str.Append(”&lt;/table><br>”);
         Response.Write(str.ToString());

     }

 }
 catch (System.Exception ex)
 {
     Response.Write(”Execption generated:” + ex.Message);
 }
 finally
 {
     GC.Collect();
     oFldr = null;
     oNs = null;
     oOutlook = null;

 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T16:41:41.033

[Outlook Redemption](http://www.dimastr.com/redemption/)是我发现目前使用的最好的东西。它将允许您进入邮件并提取附件和邮件正文。我现在正在使用它来做到这一点。当您访问消息时，它还可以防止出现安全对话框。

这是我在课堂上使用的一些代码。我包括了我用来保存附件的构造函数和处理函数。我剪掉了特定于我需要的代码，但您可以在这里了解要使用的内容。

```
 private RDOSession _MailSession = new RDOSession();
    private RDOFolder _IncommingInbox;
    private RDOFolder _ArchiveFolder;
    private string _SaveAttachmentPath;

    public MailBox(string Logon_Profile, string IncommingMailPath, 
                   string ArchiveMailPath, string SaveAttPath)
    {
        _MailSession.Logon(Logon_Profile, null, null, true, null, null);
        _IncommingInbox = _MailSession.GetFolderFromPath(IncommingMailPath);
        _ArchiveFolder = _MailSession.GetFolderFromPath(ArchiveMailPath);
        _SaveAttachmentPath = SaveAttPath;
    }
public void ProcessMail()
        {

            foreach (RDOMail msg in _IncommingInbox.Items)
            {
                foreach (RDOAttachment attachment in msg.Attachments)
                {
                    attachment.SaveAsFile(_SaveAttachmentPath + attachment.FileName);
                    }
                }
                if (msg.Body != null)
                {
                    ProcessBody(msg.Body);
                }

            }

        } 
```

这就是我所说的以及传递的内容

```
MailBox pwaMail = new MailBox("Self Email User", @"\\Mailbox - Someone\Inbox",
                              @"\\EMail - Incomming\Backup", @"\\SomePath"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T16:43:23.837

使用 Office 互操作时请注意...

而不是调用[GC.Collect()](https://stackoverflow.com/questions/118633/whats-so-wrong-about-using-gccollect#118721)你应该调用[Marshal.ReleaseComObject](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.releasecomobject.aspx)当你完成你的包装，即 Outlook 对象。

# ruby-on-rails - 在 Rails 应用程序中初始化 DRb 服务的正确位置在哪里？

> ID：299219
> 
> 赞同：2
> 
> 时间：2008-11-18T16:10:26.180
> 
> 标签：ruby-on-rails, ruby, backgroundrb, drb

我在 Rails 应用程序中使用 DRb 来卸载 Rails 进程之外的昂贵任务。在使用 DRbObject.new 初始化客户端存根之前，需要使用 DRb.start_service 初始化 DRb 服务。

在模型或控制器中执行此操作似乎会使线程处于不确定状态。当我退出杂种时，它说：

`Reaping 1 threads for slow workers because of 'shutdown' Waiting for 1 requests to finish, could take 60 seconds.`

在 environment.rb 中初始化服务似乎可以正常工作，但有一个很大的警告：我也在使用 backgroundrb 和一些 rails 工作人员。当它们初始化时，它们运行 environment.rb 并再次由于双重初始化而导致问题。

在客户端调用 DRb.start_service 的正确位置在哪里？或者，有没有办法测试初始化​​，这样我就可以避免为同一个过程做两次？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T18:50:34.657

以下代码将检查主服务器是否已经处于活动状态以避免重复初始化。通过将 DRb 线程移动到与 mongrel 正在使用的线程组不同的线程组，可以避免 mongrel 在退出时挂起。

```
 # start DRb service if it hasn't been started before
    begin
        DRb.current_server
    rescue DRb::DRbServerNotFound
        DRb.start_service
        # move to different ThreadGroup to avoid mongrel hang on exit
        ThreadGroup.new.add DRb.thread
    end 
```

在使用类之前运行它（而不是在 environment.rb 中）产生了最好的结果，并且似乎与 backgroundrb 一起工作得很好。

# php - 管理多个客户端的 Web 服务视图/模板

> ID：299222
> 
> 赞同：0
> 
> 时间：2008-11-18T16:11:20.563
> 
> 标签：php, html, web-services, rest

我有一个服务于多个客户端的服务器端 Web 服务。客户端包括网络浏览器、iPhone、BlackBerry、Android 等。我的问题是，我需要能够为这些客户端的视图生成动态内容。无论是完整的 HTML 模板、HTML 片段、JSON、XML 等。根据请求客户端的用户代理，Web 服务器会生成并吐出不同的“视图”模板。

我的问题是，是否有任何优雅的“视图”框架或样式可以适应以简化管理所有这些片段/片段/完整模板的有序方式？我一直在寻找一种优雅的方式来管理这无数的客户端处理，通过直接的维护和简单的移交程序给用户界面开发人员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T20:38:36.733

您需要的是模型和表示之间的明确分离。如果您编写了许多以与表示无关的方式（模型）提取数据的通用组件，那么您可以拥有许多适配器，它们为每个特定目标（视图）呈现输出。有一些框架将所有这些都捆绑在一个大包中。它们通常被标记为**MVC-framework**。但是，如果它不符合您的口味，则您实际上并不需要它。对于大多数类型的输出，您可以使用模板引擎来帮助您编写视图。对于更多数据 - 较少表示的东西 - 例如 JSON 或 XML 以及供机器使用的一般输出，您可能会使用其他东西来生成输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T17:53:55.300

我认为您正在寻找模板引擎。我使用 Smarty 已经有一段时间了，非常喜欢它。它在页面的逻辑和设计之间创建了分离。您需要做的就是为发出请求的用户代理加载模板文件。其余的逻辑将保持不变。

[http://www.smarty.net/](http://www.smarty.net/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-11-18T16:17:52.063

首先，您不应该通过 Web 服务返回 HTML。恕我直言，网络服务应返回通用/客户端独立形式。我建议使用一个简单的 ASPX 网页，它为某些客户端获取一堆 XSL 布局转换。

使其可定制，即使有新客户出现或您的可视化发生变化，您也不必长时间接触代码。

# c# - DataGridView/DataSet 更新

> ID：299231
> 
> 赞同：2
> 
> 时间：2008-11-18T16:15:26.937
> 
> 标签：c#, datagridview

我无法将 DataGridView 中的新行保存回数据库。简要地，

1) 我使用 SqlDataAdapter 来填充 DataSet 中的 DataTable。

2) DataTable 是网格视图的数据源。

3) 如果用户单击 DataGridView 底部的空白“新行”，我会在 RowEnter 事件中捕获新的空行并用数据填充它。数据出现在 DataGridView 中。

4) 当我在 SqlDataAdapter 上调用 Update 时，新数据消失并且没有保存到数据库中。

在第 3 步和第 4 步之间，我尝试了 DataGrid.EndEdit、DataSet.AcceptChanges、BindingContext [...].EndCurrentEdit 以及其他一些可能没有成功的事情。

如何将更改从 DataGridView 传播回 DataSet？

而且，如果我可以被允许发出短暂的抱怨，为什么很难找到这样一个显而易见的事情的简单例子呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T16:28:48.547

我在这里的方法取得了成功：

[http://msdn.microsoft.com/en-us/library/fbk67b6z.aspx](http://msdn.microsoft.com/en-us/library/fbk67b6z.aspx)

不过，我仍然认为很难在文档中找到答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T16:57:51.530

据此[，](http://p2p.wrox.com/topic.asp?TOPIC_ID=16539) AcceptChanges 可能是问题所在。

去引用：

嘿，

> > 您不能在更新前执行 AcceptChanges。AcceptChanges 使 RowState 恢复为 Unchanged（添加的行应该是 Additional RowState 值，更新的行应该是 Modified RowState 值）。
> > 
> > Update 语句应该为您调用 AcceptChanges

请注意，我在 MSDN 的任何地方都没有找到这个。

您会从一家要求 Google 查询自己的文档的公司购买搜索引擎吗？

# xslt - 将 XHTML 转换为 Word ML

> ID：299235
> 
> 赞同：4
> 
> 时间：2008-11-18T16:16:13.673
> 
> 标签：xslt, xhtml, file-conversion, wordml

将 word HTML 转换为 word XML 的最佳方法是什么？我买不到工具，所以需要最好的 XSLT 工具，它是免费的，并且适用于段落、列表、粗体和斜体等基本格式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-09T20:11:23.970

Stephane Bouillon 在 MSDN 上写了[一篇](http://blogs.msdn.com/infopath/archive/2007/03/19/transforming-infopath-rich-text-to-word.aspx)关于此的博客。她提供了一个非常好的 xslt 转换来完成这项工作。它是为与 InfoPath 一起使用而设计的，并且仅支持 InfoPath 将生成的 XHTML 标记，因此您可能需要针对您的特定应用程序对其进行修改。但它似乎工作得很好，应该给你一个开始工作的起点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T16:27:56.520

如果您想保留 XHTML 文件外部的任何格式（例如，在外部样式表中），XSLT 本身对您没有任何好处。此外，Word 具有打开 (X)HTML 文件的能力，而且已经有一段时间了。它可能看起来不像原来的那么好，但它确实有效。

事实上，如果你有 Word 和一些 VB 脚本技能，我相信可以编写一个脚本来打开 (X)HTML 文件，然后如果你使用 Word 2003 或将其保存为 WordML 或普通旧 Word 或较旧，如果您有 2007，则为 .docx。

# apache-flex - Flex 应用程序架构，我如何构建可以被覆盖的组件库

> ID：299245
> 
> 赞同：3
> 
> 时间：2008-11-18T16:20:24.197
> 
> 标签：apache-flex, actionscript-3, architecture

我有一个我们刚刚为客户构建的相当大的 flex 应用程序。现在，老板告诉我，越来越多的客户对这款应用感兴趣。然而，他们的实现需要一些小的调整（不总是！）。

我们正在使用 Cairngorm，据我所知，客户之间唯一不同的是视图。目前，视图位于主 flex 应用程序中，其他所有内容都位于库中。

所以我把视图（mxml 组件）放在一个库中，这样所有新的客户端实现都可以使用它们。到目前为止，一切都很好。所以现在我创建了一个新的 Flex 应用程序项目，引用我的新 mxml 组件库，将它们添加到主 mxml 应用程序文件中，应用程序运行良好。

但是问题来了，我如何构建这个东西，以便我可以用客户端特定的组件覆盖“默认”组件中的行为？如果我可以将一个 Mxml 文件添加到我的客户端 Flex 应用程序并且框架知道它应该覆盖默认组件，那就太好了。您可能会说我可以只换出主应用程序文件中的组件，但我需要换出任何组件的能力，即使是那些深深嵌套在其他自定义组件中的组件。

在 Asp.net 中，您可以使用“占位符”控件，然后在运行时确定要加载的控件。但我不确定如何在 Flex 中做到这一点。

如何建造这个东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T14:47:29.960

您可以通过使用**类工厂**来解决问题。不是直接创建新组件的实例，而是要求工厂类为您创建组件，并根据某些标准（可能是应用程序中的静态常量值？）工厂将决定从哪个类实例化组件。

Wikipedia 上的文章和代码示例比我能更好地解释它： [工厂方法模式](http://en.wikipedia.org/wiki/Factory_method_pattern#Encapsulation)（从“封装”标题继续阅读）。

这种方法有两个潜在的缺点：

1.  您将为您的代码库添加更多架构。以我的经验，工厂模式并不一定会使代码更易于阅读。难以阅读的代码 == 可重用代码较少。
2.  如果您严重依赖 MXML，您可能需要更多的怪癖来从工厂实例化组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T20:42:20.843

无论您要在某处更改对特定类的引用。您可以子类化（使用扩展）组件，然后修改它们的行为，但是您必须更改引用以与子类而不是父类对话。

我只会为您需要扩展功能（扩展含义更改或以任何身份添加）的那些东西创建一个子类，然后使用这些子类代替您使用父类的位置。它的工作量更大，但重用代码的最简单和更多机会。

# python - 如何让我的 python（2.5 版）脚本在文件夹内而不是从命令行运行 jar 文件？

> ID：299249
> 
> 赞同：4
> 
> 时间：2008-11-18T16:22:39.447
> 
> 标签：python

我熟悉使用*os.system 从命令行*运行。但是，我希望能够从特定文件夹中运行 jar 文件，例如。我的“测试”文件夹。这是因为我的 jar（位于我的“测试”文件夹中）需要一个位于“测试”文件夹中的文件。那么，我将如何在我的脚本中编写一个执行以下操作的函数：`c:\test>java -jar run_this.jar required_parameter.ext`？我是一个python新手，所以非常感谢细节。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-18T16:59:37.033

这是一个帮助您入门的小脚本。有一些方法可以让它“更好”，但不知道你试图完成的全部范围就足够了。

```
import os

if __name__ == "__main__":
   startingDir = os.getcwd() # save our current directory
   testDir = "\\test" # note that \ is windows specific, and we have to escape it
   os.chdir(testDir) # change to our test directory
   os.system("java -jar run_this.jar required_paramter.ext")
   os.chdir(startingDir) # change back to where we started 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T16:27:24.073

一般来说：使用os.chdir来改变父进程的目录，然后使用os.system来运行jar文件。如果你需要保持 Python 的工作目录稳定，你需要 chdir 回到原来的工作目录——你需要用 os.getcwd() 记录下来。

在 Unix 上：使用 os.fork 显式创建一个子进程。在父级中，使用 os.waitpid 等待子级。在孩子中，使用 os.chdir，然后使用 os.exec 来运行 java。

# java - 如何向 javax.comm 添加“驱动程序”？Java中的串口编程

> ID：299250
> 
> 赞同：4
> 
> 时间：2008-11-18T16:22:54.237
> 
> 标签：java, serial-port, javax.comm

我正在尝试在我的 PC 上使用带有 javax.comm 类的 RS-232 串行端口。我是那个 API 的新手，所以首先我浏览了文档，我发现你应该做的第一件事是“列出”类 CommPortListener 中的所有端口并选择其中一个。

那工作得很好！问题是，现在，我的端口不见了。它列出了我的计算机上不存在的 /dev/ttyS0 和 /dev/ttyS1 端口。我的端口（我已经多次使用它们）是 /dev/ttySNX0 和 /dev/ttySNX1。

再次上网时，我发现我应该做一些事情，比如将我的卡的驱动程序“注册”或“加载”到 API 系统上，这些事情可以在以前的版本中完成，但现在不行。此外，我尝试在 Windows 下执行此操作，他们为我提供了 API 的“通用”版本，需要一些 RXTX 应用程序，这开始击败我。

我会感谢任何建议，文档链接......一些东西......允许我通过Java使用我的串行端口，这最终是我的目标......

谢谢各位！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-23T01:40:44.547

你试过 RXTX 吗？我已经在 Windows/XP 上成功使用了该 API。我不确定你所说的“开始打败我”是什么意思。

RXTX 项目最近有很多活动，一个包含许多修复和额外支持的新版本迫在眉睫。邮件列表也比较活跃。`javax.comm`已经或多或少地死了一段时间。

# c# - 通过 COM 互操作公开索引器/默认属性

> ID：299251
> 
> 赞同：4
> 
> 时间：2008-11-18T16:23:35.950
> 
> 标签：c#, collections, asp-classic, vbscript, com-interop

我正在尝试用 C# 编写一个组件，以供经典 ASP 使用，它允许我访问组件的索引器（也称为默认属性）。

例如：
C# 组件：

```
public class MyCollection {
    public string this[string key] {
        get { /* return the value associated with key */ }
    }

    public void Add(string key, string value) {
        /* add a new element */
    }
} 
```

ASP 消费者：

```
Dim collection
Set collection = Server.CreateObject("MyCollection ")
Call collection.Add("key", "value")
Response.Write(collection("key")) ' should print "value" 
```

是否有我需要设置的属性，我需要实现接口还是需要做其他事情？或者这不能通过 COM 互操作实现？

目的是我试图为一些内置的 ASP 对象（例如 Request）创建测试替身，这些对象使用使用这些默认属性（例如`Request.QueryString("key")`）的集合。欢迎提供替代建议。

更新：我问了一个后续问题：[为什么我的 .NET 组件上的索引器并不总是可以从 VBScript 访问？](https://stackoverflow.com/questions/317759/why-is-the-indexer-on-my-net-component-not-always-accessible-from-vbscript)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T16:50:16.850

尝试将属性的 DispId 属性设置为 0，如[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.dispidattribute(VS.71).aspx)中所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T07:43:28.013

感谢 Rob Walker 的提示，我通过将以下方法和属性添加到 MyCollection 来使其工作：

```
[DispId(0)]
public string Item(string key) {
    return this[key];
} 
```

编辑：查看这个使用索引器的[更好的解决方案。](https://stackoverflow.com/a/311946/3195477)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-23T00:25:05.370

这是使用索引器而不是`Item`方法的更好解决方案：

```
public class MyCollection {
    private NameValueCollection _collection;

    [DispId(0)]
    public string this[string name] {
        get { return _collection[name]; }
        set { _collection[name] = value; }
    }
} 
```

它可以从 ASP 中使用，例如：

```
Dim collection
Set collection = Server.CreateObject("MyCollection")
collection("key") = "value"
Response.Write(collection("key")) ' should print "value" 
```

注意：我无法让它更早地工作，因为我已经超载了索引器，`this[string name]`，`this[int index]`。

# mysql - 我应该如何在存储过程中临时存储行？

> ID：299254
> 
> 赞同：0
> 
> 时间：2008-11-18T16:24:32.080
> 
> 标签：mysql, database, stored-procedures, temp-tables

本质上，我想在 MySQL 中的一个过程的生命周期中将一些行存储在一个临时变量中。

我的程序将在程序开始时抓取一列外键。完成与他们的合作后，我想更新表格以表明他们已被处理。当我的程序处理它的数据集时，可能会有插入到这个表中，所以我不想错误地将这些新行标记为已处理。我也不想锁定这个表并阻止正在插入的线程。

临时表是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T16:42:14.823

如果它在 SQL Server 中，请改为使用表变量进行调查...

```
Declare @MyFKs  Table 
   (FkId Integer Primary Key Not Null,
    isProcessed bit) 
```

虽然它们没有那么灵活（不能向它们添加多个索引），但表变量不像临时表那样参与事务日志记录，所以对于窄表，您只存储一个键和最多几个数据列，它们可以比临时表更好的性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T11:06:57.150

临时表将是解决此问题的最简单且可能最好的方法。

# php - 使用 PHPUnit 对 Doctrine 对象进行单元测试

> ID：299255
> 
> 赞同：4
> 
> 时间：2008-11-18T16:24:39.273
> 
> 标签：php, doctrine, phpunit

我开始尝试使用 PHPUnit 测试我的 Doctrine 对象，并且希望每次都从我的模型对象中重新加载数据库。

我的第一次尝试看起来像这样：

```
class Tests_User extends PHPUnit_Framework_TestCase
{

    public function setUp()
    {

        Doctrine_Manager::connection('mysql://user:pass@localhost/testdb');

        Doctrine::createDatabases();
        Doctrine::createTablesFromModels('../../application/models');

    }

    public function testSavingWorks()
    {

        $user = new User();
        $user->save();

    }

    public function testSavingWorksAgain()
    {

        $user = new User();
        $user->save();

    }

    public function tearDown()
    {

        Doctrine::dropDatabases();

    }

} 
```

问题是当第二次测试再次调用 setUp() 时， createTablesFromModels() 失败，所以我收到一个错误，因为没有表存在。

我非常感谢其他人如何为 PHPUnit 或其他单元测试目的重新初始化 Doctrine 连接的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T21:12:28.333

所以事实证明 createTablesFromModels 包含文件，然后比较之前和之后定义的类的列表，这就是为什么它不能工作两次。

重复时，类似以下的序列有效：

```
Doctrine::loadModels($path);
Doctrine::createTablesFromArray(Doctrine::getLoadedModels()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-26T10:24:56.750

查看 Ocramius 的 Gist，它表明您可以使用数据夹具进行测试：[https ://gist.github.com/Ocramius/3994325](https://gist.github.com/Ocramius/3994325)

# .net - Web 服务还是 DLL？

> ID：299260
> 
> 赞同：10
> 
> 时间：2008-11-18T16:25:47.227
> 
> 标签：.net, web-services, architecture

我正在创建一个需要由托管在内部网络上的 Web 前端访问并作为计划任务运行的应用程序。在我们的内部系统之外不需要访问任何东西，一旦应用程序启动并运行，我们预计一段时间内不会发生任何变化。

我最初的想法是创建一个封装大部分必要功能的 DLL，然后通过手动执行的 Web 窗体界面和作为自动（每日）计划任务运行的控制台应用程序调用它。

另一个建议是为核心功能公开一个 Web 服务，但由于应用程序永远不需要由外部资源调用，我认为实现 Web 服务所需的额外努力可能不值得麻烦。DLL 解决方案也应该更快（？）。

我的问题是你会选择哪条路线？有没有我没有提到的优点/缺点？有什么明显的遗漏吗？

**免责声明：**我是 .Net 的新手，但由于我们的一位开发人员卷入了一场严重的事故，我被要求加紧处理。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-18T16:31:51.910

就个人而言，我说使用 DLL。这将是快速和简单的。

使用 Web 服务，您将需要考虑您的网络、防火墙、性能等。这也使得调试变得更加困难，因为您将无法从客户端进入 Web 服务，您将不得不设置断点在通话双方。

Web 服务给您带来的另一个问题是您需要更加健壮地处理故障。使用 DLL，您知道对方法的调用将会成功，但使用 Web 服务，您需要为调用失败或在进行任何调用时超时做好准备。

最后，如果您以后发现需要 Web 服务，您应该能够相当轻松地将 DLL 转换为 Web 服务，只需最少的改造。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T16:34:34.073

现在**不需要**创建 web 服务。您只需要在服务器上维护其他 IIS 服务。如果您稍后创建一些需要该 DLL 的接口，您可以简单地引用它。所以没有必要采取预防措施。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T16:30:46.343

你是对的，Web 服务从经验上来说很麻烦，而且速度要慢得多。我建议 - 做一个 PONO（普通的旧 .net 对象），但使用接口。查看 Spring.NET 框架——它可以为你导出这个对象作为任何类型的（web）服务，所以你不需要做任何事情。在客户端，您还可以使用 spring 进行依赖注入，并通过更改配置文件中的值来决定是否需要进程内 DLL 或 Web 服务实现。Spring 还集成了 Quartz 调度程序，您可能也想研究一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T16:40:22.033

使用 DLL 是一种正确的方法，它更快，并且它提供了未来使用这些 dll（如果需要）创建 Web 服务的自由，并且比 Web 服务更安全。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-28T17:21:46.033

我不敢相信接受的答案是建议您使用 DLL 的答案...

“我们预计在一段时间内不会发生任何变化。”

这就是为什么我们必须花时间解决开发人员做出这些决定时产生的问题。不要只考虑今天，要考虑明天。数据库的东西应该对客户端隐藏，如果你必须添加一个新客户端，明天再添加一个新客户端怎么办？建立适当的合同并使用服务，无论是否是网络。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T16:32:19.303

就个人而言，我会照你说的做；将我的逻辑放在 DLL 中。然后使用来自您的应用程序、Web 服务以及他们将来请求的尚未确定的接口中的 DLL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T16:41:15.510

我们真的需要更多信息。如果不知道您的具体要求是什么，很难回答。分层方法（dll/单独的类）简单快捷。分层方法（Web 服务）将让您拥有一个环境并为您提供更多抽象。您可以在不更改客户端的情况下更改 Web 服务背后的代码。

但是为了评估这一点，我们需要知道你的项目是什么，这个 dll 会做什么。否则你只是听到人们的喜好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T16:50:31.687

将您的逻辑封装到一个程序集中就足以满足您的解决方案，因为似乎什么都不会离开您的域边界，您的两个内部应用程序都将使用您设计的组件公开的功能。

出于可维护性的考虑，您可以很容易地从 URL 加载此程序集，并且如果需要将此组件包装到 Web 服务中，这当然是可能的，然后您的代码可以用最少的代码更改创建 Web 代理类。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-28T11:56:20.717

我正在开发一个类似的应用程序。我采取的方法是将我的提取逻辑放在 dll 中。这是通过网络服务公开的。我发现 Web 服务更简单，因为我不需要在客户端上删除接口或公开我的对象（我使用类来封装数据）。然后我让 web 开发人员和 winforms 开发人员编写他们自己的表示层。虽然有优点和缺点（不会进入它们）Web 服务更简单，因为我只有一层。使用远程处理，我需要额外的接口或客户端库，必须在每个客户端上安装。这样，我只管理服务器端，而不同的 GUI 是独立的。我只是喜欢松散耦合编码。我们运行许多也使用 Web 服务的 Windows 服务。我们是一个信用卡组织，我们与许多系统进行交互。

毕竟，考虑到您的要求，这归结为您自己的个人喜好。我会说，如果不考虑以最小的努力进行更改的能力，请不要选择 1 而不是另一个。我发现 rad 应用程序会随着不断添加的新要求而迅速改变。花点时间，考虑项目的范围和生命周期以及需求。然后发展到你的优势。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-10-10T05:25:10.623

哇哇哇。他们都共享一个数据库？如果是这样的话，不，不，不。如果数据库不共享，那么它肯定是 DLL。

正确的选择是 Web 服务。原因也很简单。

1）领域模型和业务逻辑的一致性。假设您将一个枚举存储在一个列中，然后添加一个枚举并部署到一个应用程序。现在它将破坏其他两个应用程序。

2) 易于部署。一次更改 = 一次部署。如果是 dll，则一次更改 = 3 次部署。

3）数据库事务和并发控制。在一个应用程序域中解决它要容易得多。

至于其他人建议的缺点，我觉得他们太片面了。

1) 跨应用程序域调试困难。您应该通过 WSDL 将可能的异常发布为故障异常。调用客户端也应该适当地处理这些错误异常。在调用客户端和服务器上设置单元测试和模拟也非常容易。断点不是调试和使用分布式应用程序的正确方法。可以，而且不难。我只是不相信这是正确的方法。

2) 性能。WCF 允许您通过配置设置不同的绑定。从基本的 http（更容易调试）一直到命名管道，您可以使用它来获得接近原生的调用性能。这个决定（几乎。有一些你需要考虑的不同绑定的怪癖。）也可以在开发之后决定。

3）安全。说 WCF 不处理安全性是非常错误的。

最后，我的真正缺点：

1) 更复杂。同意。不同的上下文使应用程序设计更加困难。这有两种方式。这种复杂性强制执行层的明确分离。演示上下文应该保持在它们所在的位置，在演示级别。

2）需要更多的计划。为 WCF Web 服务设计合同本身就是一门艺术。

3) 配置的管理开销。对于新开发人员来说可能会让人望而生畏，但我希望你能尽快克服这个障碍。WCF 配置是一把双刃剑，功能强大但复杂（对某些人来说）。

我个人的经验是，每当共享数据库并且跨多个应用程序域使用 DLL 时，我很遗憾我没有对开发团队进行足够的打击以采用 Web 服务路线。

那么你最后的决定是什么？现在已经四年了。

# windows - 挂钩进程

> ID：299261
> 
> 赞同：6
> 
> 时间：2008-11-18T16:26:43.870
> 
> 标签：windows, hook

有谁知道像[SpyStudio](http://www.nektra.com/products/spystudio/)这样的工具来挂钩进程？我想拥有的功能是：

*   记录对其他进程的函数调用
*   图形用户界面
*   可编写脚本
*   开源

我已经看过一些工具，例如：

*   [间谍工作室](http://www.nektra.com/products/spystudio/)
*   [弯路](http://research.microsoft.com/sn/detours/)
*   [动态仪表](http://www.dyninst.org/)

但没有一个真正让我完全满意。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T05:51:41.607

[WinAPIOverride32](http://jacquelin.potier.free.fr/winapioverride32/)

WinAPIOverride32 的主要用途是监视/记录其他进程的函数调用。它还具有插件框架，因此您可以编写自己的钩子处理程序。它是开源的（GPL）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T16:30:55.890

它可能使用调试 API 并将调试钩子放置在应用程序的关键点以捕获事件。[您甚至可以使用ollydbg](http://www.ollydbg.de/)做您想做的事。

编辑：我只是查看了该站点并观看了演示视频，我会说他们几乎可以肯定是通过调试 API 做到这一点的。他们可能会在目标中所需的函数入口点处放置断点。当一个陷阱事件触发时，看起来他们使用 RPC 调用来通知用户他们的 API 并允许他们查看发生了什么并可能修改一些东西。在 RPC 调用中发回下一步要做什么。一个不错的设计，但只是一个美化的调试器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T16:32:12.783

它不是开源的，但除此之外，[OllyDbg](http://www.ollydbg.de/)可能是您正在寻找的东西。其他有用的工具和信息可以在[www.openrce.org](http://www.openrce.org/)上找到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T14:31:28.437

您可以使用开发[SpyStudio](http://www.nektra.com/products/deviare/)的同一家公司的 Deviare。它可以让你挂接 COM 接口。 [SpyStudio](http://www.nektra.com/products/spystudio/)使用这个 API 来监控函数。它有一个类型数据库，可让您获取/设置任何类型的参数值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T16:56:01.940

您可以查看 Microsoft Research 的 Detours 库。它是一个通用的 API Hooking 库。

# c++ - C/C++ 中的图像缩放和旋转

> ID：299267
> 
> 赞同：14
> 
> 时间：2008-11-18T16:28:39.187
> 
> 标签：c++, c, image, image-scaling

缩放 2D 图像阵列的最佳方法是什么？例如，假设我有一个 1024 x 2048 字节的图像，每个字节是一个像素。每个像素都是从 0 到 255 的灰度级别。我希望能够按任意因子缩放此图像并获得新图像。所以，如果我将图像缩放 0.68 倍，我应该得到一个大小为 0.68*1024 x 0.68*2048 的新图像。一些像素将相互折叠。而且，如果我按 3.15 倍缩放，我会得到一个更大的图像，其中像素被复制。那么，实现这一目标的最佳方法是什么？

接下来，我希望能够将图像旋转任意角度，范围为 0 到 360 度（0 - 2Pi）。旋转后裁剪图像不是问题。最好的方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-18T16:40:10.597

有很多方法可以缩放和旋转图像。最简单的扩展方法是：

```
dest[dx,dy] = src[dx*src_width/dest_width,dy*src_height/dest_height] 
```

但这会在增加尺寸时产生块状效果，而在减小尺寸时会丢失细节。有一些方法可以产生更好看的结果，例如[双线性过滤](http://en.wikipedia.org/wiki/Bilinear_interpolation)。

对于旋转，可以使用[旋转矩阵](http://mathworld.wolfram.com/RotationMatrix.html)计算 src 像素位置：

```
sx,sy = M(dx,dy) 
```

其中 M 是将目标像素映射到源图像的矩阵。同样，您需要进行插值以产生非块状结果。

但是，如果您不想深入了解图像处理的数学知识，可以使用大量库。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-18T17:00:46.500

您正在做的是将一组输入点映射到一组输出点。问题的第一部分是确定调整大小或旋转的映射；第二部分是处理不完全位于像素边界上的点。

调整大小的映射很容易：

```
x' = x * (width' / width)
y' = y * (height' / height) 
```

旋转映射只有一点点困难。

```
x' = x * cos(a) + y * sin(a)
y' = y * cos(a) - x * sin(a) 
```

确定网格外像素值的技术称为插值。有许多这样的算法，在速度和最终图像质量方面范围很广。其中一些按质量/时间递增的顺序是最近邻、双线性、双三次和 Sinc 滤波器。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-18T16:38:19.620

没有简单的方法可以做到这一点。[缩放](http://en.wikipedia.org/wiki/Image_scaling)和旋转都不是微不足道的过程。

因此，建议使用 2d 成像库。[Magick++](http://www.imagemagick.org/Magick++/)可以是一个想法，正如 divideandconquer.se 指出的那样，但还有其他想法。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-18T16:34:56.943

你想自己做脏活还是[ImageMagick](http://www.imagemagick.org/)可以帮你做？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-18T16:56:40.923

复制或丢弃像素不是最好的方法或调整图像大小，因为结果会显示像素化和锯齿状。为获得最佳效果，您应该*重新采样*图像，这将使生成的图像看起来更平滑。重采样的方法有很多，例如双线性、双三次、lanczos 等。

看看 wxWidgets 中的[ResampleBicubic](https://github.com/wxWidgets/wxWidgets/blob/eaaad6471df81ad7f801935ff63bea98bcbc715c/src/common/image.cpp#L930)函数。它适用于各种图像，不仅是灰度，而且您应该能够根据您的需要进行调整。然后还有[来自 VirtualDub](http://www.google.com/codesearch?hl=en&q=lanczos+resample+show:C5fdsXpDZSg:9_oY4Akrwqg:FkpVJ1B0ZbY&sa=N&cd=26&ct=rc&cs_p=http://www.makayama.com/avimerger.zip&cs_f=sources/VirtualDub/Kasumi/source/resample.cpp)的重新采样代码。Google Codesearch 可能会显示更多相关代码。

编辑：链接在预览中看起来不错，但在发布时会损坏。这很奇怪。去谷歌代码搜索并分别查询“wxwidgets resamplebicubic”和“virtualdub resample”以获得相同的结果。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-08-30T11:25:44.173

它还没有被提及，所以我将指出 OpenCV 具有缩放和旋转图像的功能，以及大量其他实用程序。它可能包含许多与问题无关的功能，但它很容易设置和用于此类库。

您可以尝试手动实现这样的转换，但简单的缩放和旋转方法通常会导致大量细节丢失。

使用 OpenCV，可以像这样进行缩放：

```
float scaleFactor = 0.68f;
cv::Mat original = cv::imread(path);
cv::Mat scaled;
cv::resize(original, scaled, cv::Size(0, 0), scaleFactor, scaleFactor, cv::INTER_LANCZOS4);
cv::imwrite("new_image.jpg", scaled); 
```

这使用 Lanczos 插值将图像缩小了 0.68 倍。

我对旋转不太熟悉，但这里是 OpenCV 网站上的教程之一的示例的一部分，我已将其编辑到相关部分。（原文也有歪曲和翻译...）

```
/// Compute a rotation matrix with respect to the center of the image
Point center = Point(original.size().width / 2, original.size().height / 2);
double angle = -50.0;
double scale = 0.6;

/// Get the rotation matrix with the specifications above
Mat rot_mat( 2, 3, CV_32FC1 );
rot_mat = getRotationMatrix2D(center, angle, scale);

/// Rotate the image
Mat rotated_image;
warpAffine(src, rotated_image, rot_mat, src.size()); 
```

[OpenCV 网站](http://opencv.org/)

[他们也有一些非常好的文档。](http://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-18T17:08:37.017

**[CxImage](http://www.xdp.it/cximage.htm)**是一个免费的图像处理库，它可以做你想做的事。除了琐碎的东西我没有亲自使用它，但我已经看到它反复推荐。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-19T14:21:29.163

CxImage 调整大小的方法会产生奇怪的结果。我将 Resample 和 Resample2 函数与所有可用的插值方法变体一起使用，结果相同。例如，尝试将填充白色的 1024 x 768 图像大小调整为 802 x 582 大小。您会发现图像上存在与白色*不同*颜色的像素！你可以检查一下：在 Windows Paint 中打开调整大小的图像并尝试用黑色填充它。结果一定会让你开心。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-15T17:48:20.617

查看[英特尔性能原语](http://software.intel.com/en-us/articles/intel-ipp/)。我以前使用过它，它在 x86 上产生了接近最佳的性能。还有一个测试程序可以让我们使用各种算法。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-08-04T15:19:59.863

```
point scaling(point p,float sx,float sy) {
    point s;

    int c[1][3];
    int a[1][3]={p.x,p.y,1};
    int b[3][3]={sx,0,0,0,sy,0,0,0,1};

    multmat(a,b,c);

    s.x=c[0][0];
    s.y=c[0][1];

    return s;
} 
```

# javascript - jQuery对象后代过滤

> ID：299272
> 
> 赞同：2
> 
> 时间：2008-11-18T16:30:56.297
> 
> 标签：javascript, jquery, dom

假设我有一个树结构

```
UL
--LI
---INPUT (checkbox) 
```

我想获取选中的输入，我会选择

```
$('ul li input:checked') 
```

但是，我想选择没有 ID 的特定对象 $myUL 的选中输入。

```
$myUL.children('li input:checked') 
```

返回所有 li，因为 children 过滤了直接子项 - 选中的过滤器没有影响。

还有其他方法吗？另一个后代过滤器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T16:39:14.890

采用`$myUL.find('li>input:checked')`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-24T08:30:01.063

`$myUL.find('li>input:checked')`按预期工作。任何性能权衡？

# java - 如何为 Eclipse 编写插件？

> ID：299283
> 
> 赞同：86
> 
> 时间：2008-11-18T16:33:45.480
> 
> 标签：java, eclipse, plugins

如何开始为[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)编写插件？

我找了资料，可惜资料太少或者很差，有什么文章可以推荐？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-11-18T16:43:41.793

Eclipse 和 IBM 的主站点上有一些非常好的资源和教程。最好的方法之一是选择一个开源插件，它与你想做的事情有一些相似的特性，然后开始剖析它。

*   *[PDE 做插件](http://www.eclipse.org/articles/Article-PDE-does-plugins/PDE-intro.html)*
*   *[插件开发 101，第 1 部分：基础知识](http://www.ibm.com/developerworks/library/os-eclipse-plugindev1/index.html)*
*   *[Eclipse 插件公开，第 1 部分：第一眼](http://www.onjava.com/pub/a/onjava/2005/02/09/eclipse.html)*
*   *[开发 Eclipse 插件](http://www.ibm.com/developerworks/opensource/library/os-ecplug/)*

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-11-18T16:45:16.080

Eclipse 有一个很好的“ [Your First Plug-in](http://www.eclipse.org/articles/Article-Your%20First%20Plug-in/YourFirstPlugin.html) ”教程。如果令人困惑，我相信他们会非常感谢您的反馈。请记住，Eclipse 本质上是 Java，所以如果您没有很好地掌握 Java，请先阅读一般的 Java 教程，然后再回到 Eclipse 开发。

O'Reilly 有两个很好的 Eclipse 插件教程：

*   [Eclipse 插件公开](http://www.onjava.com/pub/a/onjava/2005/02/09/eclipse.html)
*   [为 Eclipse 开发自己的插件](http://www.onjava.com/pub/a/onjava/2004/08/18/eclipseplugins.html)

他们不仅通过简单的代码示例，还为您提供该过程的屏幕截图，因为很多工作都是通过向导类型的界面窗口完成的。

如果这些没有帮助，也许您可​​以更具体地说明难以遵循的内容。

-亚当

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T17:21:02.920

涵盖插件开发几乎所有方面的最佳分步指南是“Eclipse：构建商业质量插件”一书。

它在大多数书店都有售，在 safari 上也有电子版：http: [//safari.oreilly.com/9780321574435](http://safari.oreilly.com/9780321574435)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-13T08:35:00.563

我找到了一个很棒的 Eclipse 插件教程，名为*[Extending Eclipse - Plug-in Development Tutorial](http://cvalcarcel.wordpress.com/2009/07/08/writing-an-eclipse-plug-in-part-1-what-im-going-to-do/)*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T19:09:32.420

我认为一个很好的资源也是查看通过新插件项目向导提供的示例。

根据您想为插件提供的内容，您可以从编辑器插件、视图插件、提供属性页的插件（仅举几例）中进行选择，并查看它们的构建方式和他们实现了哪些扩展点。

# c# - 打印发票、取票等的最佳方式

> ID：299287
> 
> 赞同：3
> 
> 时间：2008-11-18T16:34:47.957
> 
> 标签：c#, .net, winforms, printing, reporting

好吧，这是我的场景。

客户端/服务器以 SQL Express 作为数据库的 winforms 应用程序。我需要能够打印发票、装箱单等。

我希望客户能够修改发票。IE。能够放置他们的标志或更改字体大小等...基本上格式化显示。

到目前为止我考虑的事情是。

1) 使用模板引擎（类似于 codesmith 或 mygeneration）并使用输出 HTML 的模板。然后打印html页面。

2) 在本地模式下使用 ReportViewer。我听说用户可以下载 web dev express 的插件并编辑本地报告文件。谁能证实这一点？

3) 在远程模式下使用 Reportviewer。

我对 ReportViewer 没有太多经验，所以我不确定是否也应该使用本地或远程模式。

那些在你推荐之前做过这种事情的人？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-18T16:37:44.143

在刚刚完成一个项目后，我衷心推荐[iTextSharp](http://www.google.com/search?q=itextsharp&sourceid=navclient-ff&ie=UTF-8&rlz=1B3GGGL_enUS216US216)将您的发票和其他表单创建为 PDF。除了从头开始创建 PDF，您还可以使用它来填写 PDF 表单和/或使用 Acrobat（甚至是 MS Office/OpenOffice）创建的模板。它是免费的。

在 Windows 应用程序或 ASP.Net 应用程序中使用它非常容易。大多数文档和相关书籍（例如***[iText in Action](http://www.manning.com/lowagie/)***）都是关于原始 Java 版本[iText](http://www.lowagie.com/iText/)的。但是，有关于转换过程的教程和示例代码，并且在大多数情况下，所有函数和库在 .Net 版本中的工作方式都相同，因此改编本书和参考代码没有问题。

我确实学到了 HTML 和 CSS 非常适合浏览器（嗯，除了“每个浏览器都解释它不同”的问题之外很好），但是对于尝试生成一致、有吸引力和精确的打印输出和表单来说是可怕的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T16:59:27.097

我个人使用[Aspose Words](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)：他们使用 word 文档作为模板，我使用 Words 书签功能来标记和检索我需要填写的字段。

Aspose 与表格很好地配合使用（即：您可以在表格中添加行等...）并将 Word 文档视为 XML 文档。然后，您可以将文档另存为 MSWord 或 PDF。

我不会说它是世界上最伟大的图书馆，但绝对值得一看 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-13T17:35:28.343

您可以为此使用水晶报表。但首先你需要扫描 INVOICE 并将其保存为图像，

接下来是，在您的水晶报表上，将图像导出到上面，然后将字段拖到发票上必须打印的位置（图像作为您的指南）。然后在设置完所有内容后，删除图像并尝试一下。

希望这可以帮助。

# c# - Linq to Entities 和级联属性

> ID：299291
> 
> 赞同：6
> 
> 时间：2008-11-18T16:35:42.980
> 
> 标签：c#, linq, c#-3.0, linq-to-entities

有谁知道是否可以在现有实体类型上创建一个新属性，该实体类型基于连接在一起的 2 个其他属性？

例如，我的人实体类型有这些字段“ID”、“名字”、“姓氏”、“出生日期”

我想创建一个名为“全名”的新字段，它是

```
Forenames + " " + Surname 
```

所以我最终得到“ID”、“Forename”、“Surname”、“DOB”、“Fullname”。

我知道我可以以编程方式使用 Linq 来做到这一点，即

```
var results = from p in db.People
select new { 
ID = p.ID, 
Forename = p.Forename, 
Surname = p.Surname, 
DOB = p.DOB,
Fullname = p.Forename+ " " + p.Surname
}; 
```

然后调用类似的东西

```
var resultsAfterConcat = from q in results 
where q.Fullname.Contains(value)
select q; 
```

但是，我真的很想在概念模型级别使用 Linq to Entities 为我完成这项工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T18:06:01.987

还没有，但也许很快。首先，请注意，无论有没有该属性，您建议的查询在 LINQ to Entities 中都不起作用，因为目前它不支持包含。但是，.NET 4.0 中的新版本实体框架应该支持 LINQ to Entities 查询中的自定义方法。您可以[从 PDC 观看有关此的视频](http://mschnlnine.vo.llnwd.net/d1/pdc08/WMV-HQ/TL20.wmv)。本质上，您必须编写两次自定义方法；一次在代码中，一次在您的数据库中（例如，在计算字段中）。有关更多信息，请参阅视频。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-01-26T03:37:53.827

对于任何在问题得到解答多年后偶然阅读此书的人：

这里有一个更新和更符合 DRY 的答案：[Using a partial class property inside LINQ statement](https://stackoverflow.com/questions/6879529/using-a-partial-class-property-inside-linq-statement)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T20:19:25.560

包含对您“有效”的原因是因为您调用的是 String.Contains，而不是 Craig 认为的 IEnumerable.Contains。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T13:29:45.990

克雷格，

Sarted看了视频，然后意识到它有一个多小时的时间，所以当我有更多时间时必须观看它。只是想让你知道.. ***Contains***对我来说似乎工作正常，这是由 Linq to Entities 生成的 SQL：

```
SELECT 
1 AS [C1], 
[Extent1].[PeopleID] AS [PeopleID], 
[Extent1].[Forenames] AS [Forenames], 
[Extent1].[Surname] AS [Surname]
FROM [dbo].[People] AS [Extent1]
WHERE (CHARINDEX(N'Dave', [Extent1].[Forenames] + N' ' + [Extent1].[Surname])) > 0 
```

这似乎是一种享受。如果 Concatinated 字段包含输入的文本，即上述情况是“ ***Dave*** ”，则使用***CHARINDEX***进行锻炼。

 *谢谢戴夫

# c# - Ndepend 和其他自动代码分析器的关系？

> ID：299296
> 
> 赞同：5
> 
> 时间：2008-11-18T16:37:49.043
> 
> 标签：c#, .net, code-analysis

从昨天开始，我正在使用[Ndepend](http://www.ndepend.com/)分析我们的一个项目（其大部分功能免费），而且我正在使用它，而且我更怀疑这种软件（代码分析软件）的真正价值。

让我解释一下，系统通过对每个指标进行排名来构建关于系统和类的健康状况的报告。我认为这是进行修改的一个很好的起点，但大多数最佳结果都在这里，因为它们在类中有超过 100 行（我们有大标题，我们确实使用 VS 注释样式）所以这没什么大不了的。 .比传入耦合级别（CA）的数量总是太高，这对于我们经常使用的接口来说几乎是非常正确的......所以此时我没有看到有什么问题，但 NDepend 似乎不喜欢它（如果您有改进建议，请告诉我，因为我认为没有必要）。对于我的大多数界面都太高的孩子数量的称为“NOC”的指标来说，这是一样的......

目前，唯一非常有用的指标是圈复杂度......

**我的问题是**：你觉得用 NDepend 之类的自动代码分析器分析代码值得吗？如果是，您如何过滤我提到的所有信息，这些信息并不能真正显示系统的真实健康状况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T20:08:49.023

我不一定将 NDepend 的结果视为软件工程中的“好”或“坏”，应用程序的设计方式总是有充分的理由。我认为它是一份报告，可能可以帮助我指出我的设计问题，但在决定一个方法是否需要重构或者它是否符合我的设计方式时，我有最终决定权。一般来说，不要太着迷于试图回答是否值得。绝对是，相反，我建议您仔细查看结果。这将帮助您从另一个角度查看您的设计，并且在某些情况下，您可能会决定设计它的方式是实现应用程序目标的最佳方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T23:02:29.080

实际上指标只是 NDepend 的一项功能，您是否尝试使用 VisualNDepend 让您比报告更深入地分析您的项目？通过阅读您的评论，我几乎可以肯定您没有使用 NDepend UI（独立或集成在 Visual Studio 中），这是过滤代码库数据的最佳方式。

我是 NDepend 的开发人员之一，我们经常使用它来分析我们自己的代码。[基本上，我们使用基于LINQ 查询的代码规则 (CQLinq)](http://www.ndepend.com/Features.aspx#CQL)编写自己的质量规则。这些规则自动确保我们的设计没有回归。在这里，您将找到大约[200 条默认代码规则](http://www.ndepend.com/DefaultRules/webframe.html)的列表。

以下是 NDepend 的一些独特功能，与代码指标无关：

*   编写 CQLinq 规则以确保我们没有架构缺陷，例如[组件之间的依赖循环](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_namespaces_dependency_cycles.html)、[直接使用 DB 的 UI](http://www.ndepend.com/DefaultRules/webframe.html?Q_UI_layer_shouldn%27t_use_directly_DB_types.html)或与业务对象纠缠的 DB。

*   确保我们在测试的代码覆盖率方面没有问题（就像我们使用 CQLinq 规则确保如果一个类应该被 100% 覆盖，[那么它将在未来保持 100% 覆盖](http://www.ndepend.com/DefaultRules/webframe.html?Q_Types_that_used_to_be_100__covered_but_not_anymore.html)）

*   强制执行无副作用的代码（[不可变类](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_transforming_an_immutable_type_into_a_mutable_one.html)/纯方法）

*   在发布新版本之前，使用将 2 次分析与自上次发布以来的代码审查更改进行比较的能力。更具体地说，我喜欢使用 NDepend 来了解[自上次发布以来添加和重构了哪个方法，并且测试没有 100% 覆盖](http://www.ndepend.com/DefaultRules/webframe.html?Q_From_now,_all_types_added_or_refactored_should_be_100__covered_by_tests.html)。

*   对我们所有的成员和类型进行最佳封装（比如[知道哪些内部方法可以声明为 private](http://www.ndepend.com/DefaultRules/webframe.html?Q_Methods_that_could_have_a_lower_visibility.html)）。这也与NDepend 也支持的[死代码检测有关。](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Types.html)

有关 NDepend 的完整功能列表，请参见[此处](http://www.ndepend.com/Features.aspx)。

# java - 为什么 Java 的 String 中的 hashCode() 使用 31 作为乘数？

> ID：299304
> 
> 赞同：536
> 
> 时间：2008-11-18T16:39:43.627
> 
> 标签：java, string, algorithm, hash

根据 Java 文档，对象的[哈希码](http://java.sun.com/javase/6/docs/api/java/lang/String.html#hashCode())`String`计算为：

> ```
> s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1] 
> ```
> 
> 使用`int`算术运算，其中`s[i]`是字符串的第 *i*个字符，是字符串`n`的长度，`^`表示取幂。

为什么用 31 作为乘数？

我知道乘数应该是一个相对较大的素数。那么为什么不是 29、37 甚至 97 呢？

* * *

## 回答 #1

> 赞同：443
> 
> 时间：2008-11-18T18:53:24.447

根据 Joshua Bloch 的[Effective Java](https://rads.stackoverflow.com/amzn/click/com/0321356683)（这本书推荐得不够多，由于在 stackoverflow 上的不断提及，我买了这本书）：

> 选择值 31 是因为它是一个奇数素数。如果它是偶数并且乘法溢出，则信息将丢失，因为乘以 2 相当于移位。使用素数的优势不太明显，但它是传统的。31 的一个很好的属性是乘法可以用移位和减法代替以获得更好的性能：`31 * i == (i << 5) - i`. 现代虚拟机自动进行这种优化。

*（来自第 3 章第 9 项：覆盖等于时始终覆盖哈希码，第 48 页）*

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2008-11-18T20:56:28.757

Goodrich 和 Tamassia 从超过 50,000 个英语单词（由两个 Unix 变体中提供的单词列表的并集）计算得出，使用常量 31、33、37、39 和 41 在每种情况下将产生少于 7 个冲突。这可能是许多 Java 实现选择此类常量的原因。

[请参阅Java](https://enos.itcollege.ee/%7Ejpoial/algorithms/GT/Data%20Structures%20and%20Algorithms%20in%20Java%20Fourth%20Edition.pdf)中的数据结构和算法的第 9.2 节哈希表（第 522 页）。

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2008-11-18T17:01:45.563

在（大部分）旧处理器上，乘以 31 可能相对便宜。例如，在 ARM 上，它只有一条指令：

```
RSB       r1, r0, r0, ASL #5    ; r1 := - r0 + (r0<<5) 
```

大多数其他处理器将需要单独的移位和减法指令。但是，如果您的乘数很慢，这仍然是一个胜利。现代处理器往往具有快速乘法器，因此只要 32 在正确的一侧，它就不会产生太大影响。

这不是一个很好的哈希算法，但它已经足够好并且比 1.0 代码更好（并且比 1.0 规范好得多！）。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2009-05-19T18:10:57.263

通过乘法，位向左移动。这使用了更多可用的哈希码空间，减少了冲突。

通过不使用 2 的幂，低位、最右边的位也被填充，与进入散列的下一条数据混合。

表达式`n * 31`等价于`(n << 5) - n`。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2016-02-10T00:46:26.533

[您可以在http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4045622](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4045622)的“评论”下阅读 Bloch 的原始推理。他研究了不同哈希函数在哈希表中产生的“平均链大小”的性能。`P(31)`是他在 K&R 的书中找到的那个时期的常见函数之一（但即使是 Kernighan 和 Ritchie 也不记得它是从哪里来的）。最后他基本上只能选择一个，所以他选择了，`P(31)`因为它似乎表现得足够好。尽管`P(33)`实际上并没有更糟，并且乘以 33 的计算速度同样快（只是移位 5 和加法），但他选择了 31，因为 33 不是素数：

> 在剩下的四个中，我可能会选择 P(31)，因为它是在 RISC 机器上计算的最便宜的（因为 31 是 2 的两个幂的差）。P(33) 计算起来同样便宜，但它的性能稍差，而且 33 是​​复合的，这让我有点紧张。

因此，推理并不像这里的许多答案似乎暗示的那样合理。但我们都善于在直觉决定后提出合理的理由（甚至布洛赫也可能倾向于这样做）。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2011-07-27T19:37:44.703

实际上，37 会很好用！z := 37 * x 可以计算为`y := x + 8 * x; z := x + 4 * y`. 这两个步骤都对应一个 LEA x86 指令，因此速度非常快。

事实上，与更大的素数**73**的乘法可以通过设置 以相同的速度完成`y := x + 8 * x; z := x + 8 * y`。

使用 73 或 37（而不是 31）可能会更好，因为它会导致*代码更密集*：两个 LEA 指令只占用 6 个字节，而 move+shift+subtract 的 7 个字节用于乘以 31。一个可能的警告是此处使用的 3 参数 LEA 指令在英特尔的 Sandy 桥架构上变得更慢，延迟增加了 3 个周期。

此外，[73](http://bigbangtheory.wikia.com/wiki/73)是 Sheldon Cooper 最喜欢的数字。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2011-12-07T15:27:18.477

Neil Coffey[解释了](http://www.javamex.com/tutorials/collections/hash_function_technical_2.shtml)为什么在*Ironing out the bias*中使用 31 。

基本上使用 31 可以为散列函数提供更均匀的设置位概率分布。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2017-06-12T21:17:03.210

来自[JDK-4045622](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4045622)，其中 Joshua Bloch 描述了选择该特定（新）`String.hashCode()`实现的原因

> 下表总结了上述各种散列函数对三个数据集的性能：
> 
> 1) 韦氏词典第 2 版国际未删节词典中包含条目的所有单词和短语（311,141 个字符串，平均长度 10 个字符）。
> 
> 2) /bin/ *、 /usr/bin/*、 /usr/lib/ *、 /usr/ucb/* 和 /usr/openwin/bin/* 中的所有字符串（66,304 个字符串，平均长度 21 个字符）。
> 
> 3) 昨晚运行了几个小时的网络爬虫收集的 URL 列表（28,372 个字符串，平均长度 49 个字符）。
> 
> 表中显示的性能指标是散列表中所有元素的“平均链大小”（即，比较查找元素的键数的预期值）。
> 
> ```
>  Webster's   Code Strings    URLs
>                           ---------   ------------    ----
> Current Java Fn.          1.2509      1.2738          13.2560
> P(37)    [Java]           1.2508      1.2481          1.2454
> P(65599) [Aho et al]      1.2490      1.2510          1.2450
> P(31)    [K+R]            1.2500      1.2488          1.2425
> P(33)    [Torek]          1.2500      1.2500          1.2453
> Vo's Fn                   1.2487      1.2471          1.2462
> WAIS Fn                   1.2497      1.2519          1.2452
> Weinberger's Fn(MatPak)   6.5169      7.2142          30.6864
> Weinberger's Fn(24)       1.3222      1.2791          1.9732
> Weinberger's Fn(28)       1.2530      1.2506          1.2439 
> ```
> 
> 查看此表，很明显，除了当前的 Java 函数和 Weinberger 函数的两个损坏版本之外，所有函数都提供了出色的、几乎无法区分的性能。我强烈推测这种性能本质上是“理论理想”，如果您使用真正的随机数生成器代替散列函数，您会得到这种性能。
> 
> 我会排除 WAIS 函数，因为它的规范包含随机数页，并且它的性能并不比任何更简单的函数更好。其余六个功能中的任何一个似乎都是不错的选择，但我们必须选择一个。我想我会排除 Vo 的变体和 Weinberger 的函数，因为它们增加了复杂性，尽管很小。在剩下的四个中，我可能会选择 P(31)，因为它是在 RISC 机器上计算的最便宜的（因为 31 是 2 的两个幂的差）。P(33) 计算起来同样便宜，但它的性能稍差，而且 33 是​​复合的，这让我有点紧张。
> 
> 乔什

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2010-04-28T22:39:13.817

布洛赫并没有完全深入，但我一直听到/相信的基本原理是这是基本代数。哈希归结为乘法和取模运算，这意味着如果可以提供帮助，您永远不想使用具有公因数的数字。换句话说，相对质数提供了答案的均匀分布。

使用哈希组成的数字通常是：

*   您放入的数据类型的模数（2^32 或 2^64）
*   哈希表中存储桶计数的模数（变化。在 java 中曾经是素数，现在是 2^n）
*   在混合函数中乘以或移位一个幻数
*   输入值

您实际上只能控制其中几个值，因此需要格外小心。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-02-18T02:03:42.737

在最新版本的 JDK 中，仍然使用 31。[https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html#hashCode()](https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html#hashCode())

哈希字符串的目的是

*   唯一（让查看`^`哈希码计算文档中的运算符，它有助于唯一）
*   计算成本低廉

31是最大值可以放入8位（= 1字节）寄存器，最大素数可以放入1字节寄存器，是奇数。

乘以 31 <<5 然后减去自身，因此需要廉价资源。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-07-18T18:05:06.043

**Java String hashCode() 和 31**

这是因为 31 有一个很好的属性——它的乘法可以用比标准乘法更快的按位移位来代替：

```
31 * i == (i << 5) - i 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-11-18T16:58:03.683

我不确定，但我猜他们测试了一些素数样本，发现 31 在一些可能的字符串样本上给出了最佳分布。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-06-23T23:54:38.877

哈希函数的一个很大期望是，它们的结果的均匀随机性可以在诸如`hash(x) % N`其中 N 是任意数（在许多情况下是 2 的幂）之类的操作中幸存下来，一个原因是此类操作通常在哈希表中用于确定槽. 在计算哈希时使用素数乘数会降低乘数和 N 共享除数的概率，这会使运算结果的随机性降低。

其他人指出了乘以 31 可以通过乘法和减法来完成的好特性。我只想指出，这种素数有一个数学术语：[梅森素数](https://en.wikipedia.org/wiki/Mersenne_prime)

所有梅森素数都小于 2 的幂，因此我们可以将它们写为：

```
p = 2^n - 1 
```

将 x 乘以 p：

```
x * p = x * (2^n - 1) = x * 2^n - x = (x << n) - x 
```

在许多机器上，移位 (SAL/SHL) 和减法 (SUB) 通常比乘法 (MUL) 快。请参阅[Agner Fog 的说明表](https://www.agner.org/optimize/instruction_tables.pdf)

这就是为什么 GCC 似乎通过用移位和子替换它们来优化梅森素数的乘法，[见这里](https://godbolt.org/z/jpeZEB)。

然而，在我看来，这么小的素数对于散列函数来说是一个糟糕的选择。使用相对较好的散列函数，您会期望散列的较高位具有随机性。然而，使用 Java 散列函数，具有较短字符串的较高位几乎没有随机性（并且较低位的随机性仍然非常值得怀疑）。这使得构建高效的哈希表变得更加困难。看看[这个用 Java 散列函数做不到的好技巧](https://lemire.me/blog/2016/06/27/a-fast-alternative-to-the-modulo-reduction/)。

一些答案提到他们认为 31 适合一个字节是好的。这实际上是无用的，因为：

(1) 我们执行移位而不是乘法，因此乘数的大小无关紧要。

(2) 据我所知，没有特定的 x86 指令可以将 8 字节值与 1 字节值相乘，因此即使您正在相乘，您也需要将“31”转换为 8 字节值。看到[这里](https://godbolt.org/z/HqArTp)，你乘以整个 64 位寄存器。

（而 127 实际上是一个字节中最大的梅森素数。）

较小的值会增加中低位的随机性吗？也许吧，但它似乎也大大增加了可能的冲突:)。

人们可以列出许多不同的问题，但它们通常归结为两个没有很好地实现的核心原则：[混淆和扩散](https://en.wikipedia.org/wiki/Confusion_and_diffusion)

但它快吗？可能，因为它没有多大作用。但是，如果性能真的是这里的重点，那么每个循环一个字符是非常低效的。对于更长的字符串，为什么不每次循环迭代一次 4 个字符（8 个字节），[像这样](https://godbolt.org/z/b2TKFs)？好吧，这与当前的哈希定义很难做到，您需要将每个字符单独相乘（请告诉我是否有一些技巧可以解决这个问题：D）。

# eclipse - 在 CFEclipse 中双击文本选择

> ID：299312
> 
> 赞同：3
> 
> 时间：2008-11-18T16:42:36.117
> 
> 标签：eclipse, configuration, coldfusion, cfeclipse

在 CFEclipse 中，我做了很多双击来选择文本。标准行为是选择最近*单词边界*内的所有文本。在编辑原始编辑器不使用驼峰式大小写的代码时，这是有问题的；例如，他们将“myObject”写为“my_object”。

有没有办法更改双击选择行为以包含“_”作为有效的*单词*字符？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-18T13:49:12.353

在最新版本的 CFEclipse 中，现在可以选择在双击时定义哪些字符被视为单词边界，以及在使用 alt 或 shift 键时使用不同字符的选项。

在首选项中，转到 CFEclipse > Editor > Text Selection 以更新此内容：（ [来源：][[bpsite.net](https://bpsite.net/misc/eclipse_text-selection.png)][）][![替代文字](https://i.stack.imgur.com/hUj2C.png)](https://i.stack.imgur.com/hUj2C.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T16:54:35.950

在 eclipse 3.4.1 Ganymede 上，它似乎选择了最近的边界，*包括*“_”（至少在我正在使用的 java 文件中）

你用的是什么eclipse版本？

该[博客](http://blog.jonschneider.com/2008/07/don-treat-underscore-as-word-separator.html)甚至报告说 eclipse3.3 确实选择了您所期望的单词...

![记事本2](https://i.stack.imgur.com/gRC0h.jpg)对比![火狐](https://i.stack.imgur.com/FeN1L.jpg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T14:00:02.070

CFEclipse 不能将下划线或句点识别为通过双击选择文本的字符。除了卷起袖子并破解编辑器代码来更改它之外，我没有其他办法。我怀疑这会随着 Adob​​e 即将发布的 Bolt 很快改变。

# .net - 在 .NET 中创建和部署 ActiveX 控件

> ID：299323
> 
> 赞同：5
> 
> 时间：2008-11-18T16:45:42.537
> 
> 标签：.net, installation, activex, browser

由于显然没有[可以接受位图粘贴的 Flash 控件](https://stackoverflow.com/questions/295524/website-image-manager-with-copypaste-flash)，我想考虑自己编写一个。不过我宁愿不使用 Flash，所以我想使用 .NET。

现在我相信可以在浏览器中下载和运行的本机代码控件的正确术语是“ActiveX 控件”。所以我的问题是，我可以用 .NET 创建这样的 ActiveX 控件吗？

我在网上找到了一些教程，但他们都希望您将程序集安装在本地计算机上，并注册并信任它和访问它的网站。

这对潜在的匿名 Internet 用户要求很高，即使对于 Intranet 用户，另一种部署方法也更可取。

我清楚地记得一些网站要求我下载这个或那个 ActiveX 控件。在需要诸如 Flash 和 Java 之类的浏览器插件的页面上，有一些机制可以让浏览器知道从哪里获取该媒体类型的插件。

所以我的问题是双重的：

*   我可以在 .NET 中创建一个可以在用户浏览器中运行的控件吗？
*   我可以实现的（半）自动交付的最佳方法是什么？

* * *

回复桑尼：

是的，许多 JavaScript 富文本编辑器允许您将**链接的图像**粘贴到文本字段中，它会插入正确的 <img> 标记。但是，这仅适用于已经在网络上具有位置的图像，我希望它仅通过从剪贴板复制/粘贴任何随机位图来上传新图像。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T23:11:47.810

如果您只对 IE 没问题，我喜欢 IE 托管控件在 Active-X 上的安全模型，但是，从 09 年 1 月 1 日起，Microsoft 不赞成使用 .NET（正在处理）来扩展 IE，因此 XBAP 没问题，但不在 ActiveX 控件或 IE 托管控件中。

7/13 更新：Microsoft 已发布[有关实施进程内扩展的指南](http://msdn.microsoft.com/en-us/library/windows/desktop/dd758089%28v=vs.85%29.aspx)；它仍然被弃用。

编辑：无需调整注册表，IE8 只会从 Intranet 或受信任区域加载 .NET 托管控件，因此对于一般 Internet 使用，浏览器内完全信任访问需要 Active-X。

跟进 Russ 的帖子：Silverlight 无法访问剪贴板：[http ://silverlight.net/forums/t/13024.aspx](http://silverlight.net/forums/t/13024.aspx)

大多数 IE 托管控件信息都在博客中，因此我使用：[http](http://www.google.com/search?q=ie+hosted+control+site:msdn.com) ://www.google.com/search?q=ie+hosted+control+site:msdn.com来查找它们。以下是我发现特别有用的。

快速简便的控制：http: [//blogs.msdn.com/mikechr/archive/2006/11/28/writing-a-simple-managed-control-under-ie.aspx](http://blogs.msdn.com/mikechr/archive/2006/11/28/writing-a-simple-managed-control-under-ie.aspx)

关于安全性的奇怪事情，除非“证据”是一个 url，否则程序集可能是可信的，但不是域，需要断言来修复：http: [//blogs.msdn.com/carloc/archive/2006/11/01/代码访问安全托管控制在 ie.aspx](http://blogs.msdn.com/carloc/archive/2006/11/01/code-access-security-hosting-control-in-ie.aspx)

这在 3.5 中已通过清单“修复”。正确操作很复杂，因此请参阅 Shawnfa 的 .NET 安全博客中有关使用清单的说明，用于[.NET 3.5 Beta](http://blogs.msdn.com/shawnfa/archive/2007/03/09/manifests-for-ie-hosted-controls.aspx)并[发布 GA .NET 3.5](http://blogs.msdn.com/shawnfa/archive/2008/01/24/manifested-controls-redux.aspx)。Todd 的 Random Discovery 博客还记录了[为托管控件创建清单的步骤](http://rrandomdiscovery.blogspot.com/2009_05_01_archive.html)

我从一篇关于设置安全性的知识库文章中发现这很有用，但您仍然需要了解很多关于 CAS 的知识：http: [//support.microsoft.com/kb/892466](http://support.microsoft.com/kb/892466)。这可能是决定使用（.net）Active-X 还是使用 IE 托管控件时的主要考虑因素——也就是说，哪种安全模型最适合您和您的用户。我希望使用清单将使 IE 托管控件像单击一次一样工作，其中要求用户“信任”并且系统创建正确的设置。对于我的公司，我们使用可以自动为用户设置安全性，因此我们选择了 ie 托管。

我从未想过的一件事是我是否必须从（用户）控件继承或不必继承（用户）控件以获得无 ui 控件。这样做对我来说效果更好，但我不得不“隐藏”对象标签所在的 div。

如果您为调试而编译并在加载控件后附加到 IE 以进行“托管”调试，则调试控件很容易。如果您无法加载控件，请在融合程序集绑定查看器上查找信息：http: [//msdn.microsoft.com/en-us/library/e74a18c4.aspx](http://msdn.microsoft.com/en-us/library/e74a18c4.aspx)以及如何打开 IEHost 跟踪：[http: //support.microsoft.com/kb/313892](http://support.microsoft.com/kb/313892)以调试加载过程。

确保对程序集的每个版本进行版本控制。如果你不这样做，那么当下载缓存中的程序集不同但与 url 引用的程序集具有相同的版本时，IE 会感到困惑并且不会加载控件（gacutil /cdl 清除 .net 下载缓存）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T17:17:21.443

查找“在 IE 中托管的 Winforms”。几年前我不得不做类似的事情，这就是我最终能够取得一些进展的地方。

需要注意的两件事：您可能已经注意到，这个问题并不经常出现，因此示例有限。（我不再有任何分享，对不起）。此外，.NET 的安全模型与基于 COM 的 ActiveX 有很大不同，因此要让它在 IE 的不同安全区域中工作会有点棘手。

如果您有能力使用 Silverlight 2，我可能会朝那个方向倾斜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T14:46:15.787

使用 ActiveX 仅限于 IE 和 Windows。最好看看 google docs 和/或 gmail，看看他们如何处理仅使用 javascript 将图像粘贴到您的电子邮件/在线文档中。适用于大多数浏览器和操作系统。

# open-source - 是否有任何支持 dynaturtles 的开源/免费 LOGO 实现？

> ID：299326
> 
> 赞同：5
> 
> 时间：2008-11-18T16:46:37.543
> 
> 标签：open-source, turtle-graphics, logo-lang

我正在寻找支持“dynaturtles”的[LOGO](http://en.wikipedia.org/wiki/Logo_programming_language)编程语言的实现 - 动画海龟可以以编程方式改变形状、速度和方向，以及检测彼此之间或环境中其他对象的碰撞。

回到地球是新的和 8 位微型统治至高无上的时代的迷雾中，[雅达利 LOGO](http://en.wikipedia.org/wiki/Atari_LOGO)在这方面做得很好。使用这种技术可以非常轻松地创建各种小型游戏和模拟环境，因为该语言的实现具有经过深思熟虑的优雅语法。

我知道 LCSI 的[Microworlds](http://www.microworlds.com/)，但我正在寻找可以用来让一些朋友和他们的孩子参与编程而又不超出我预算的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T18:19:52.923

在网上搜索了一下，我发现[了 OpenStarLogo](http://education.mit.edu/openstarlogo/)。尽管他们没有特别提到“dynaturtles”，但文档确实提到了碰撞检测。该站点有代码和文档下载。

在这篇[wikipedia article 中](http://en.wikipedia.org/wiki/Logo_(programming_language))，在 Implementations 部分下，有一个 PDF 列出了已知的当前和古老的实现。其中一些，例如[StarLogo TNG](http://education.mit.edu/drupal/starlogo-tng)和[Elica](http://www.elica.net/site/index.html)支持 3D 对象。这些绝对不像我小时候写的LOGO程序……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T13:40:45.720

我使用 [microworlds](http://wakoopa.com/software/microworlds-ex)作为我的标志...我知道 kturtle for kde [kturtle](http://edu.kde.org/kturtle/) 我还发现了一些可能很有趣的链接
[python turtle](http://docs.python.org/library/turtle.html)
[fmslogo](http://www.fmslogo.org/index2.html)
[MSWlogo](http://www.softronix.com/logo.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T07:40:10.307

查看海龟 python 包。它在标准 python 发行版中，支持图形海龟界面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T18:46:03.453

如果你使用win-logo（www.win-logo.de/eng/e_index.htm;你必须注册，然后你可以尝试30天），你可以练习这个代码（德文版Nr.2）：

```
PR test
   ;* #####  Startdatei  ######
   SETZE "sprung.x" 0
   SETZE "sprung.y" 0
   flug
ENDE

PR flug
   sprung
   tasten
   flug
ENDE

PR sprung
   SETZE "sprung.x" :sprung.x + (SIN KURS)/2
   SETZE "sprung.y" :sprung.y + (COS KURS)/2
   AUFXY (XKO + :sprung.x) (YKO + :sprung.y)
ENDE

PR tasten
   SETZE "t" TASTE
   WENN :t = "d" DANN LI 30
   WENN :t = "e" DANN DZ "Abbruch!" AUSSTIEG
   WENN :t = "f" DANN RE 30
   WENN :t = "h" DANN sprung
   tasten
ENDE 
```

好的？问候。迈克尔克劳斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T10:31:56.173

我昨天的帖子中添加了两个关于 dynaturtle 的 LOGO 程序的内容：

1.) 键“d”是数字 4

键“e”是 NUM 5

键“f”是 NUM 6

键“h”是 NUM 8

2.) 点击“e”= NUM​​ 5 停止递归过程后，您还必须单击退出按钮。- 我试图找出原因，但我不知道。

迈克尔克劳斯

# vb.net - 输入期间的无效投射

> ID：299332
> 
> 赞同：0
> 
> 时间：2008-11-18T16:49:15.213
> 
> 标签：vb.net

我正在做一个基本的家庭作业，如下所示：

```
 While input <> -1
        input = CDbl(InputBox("Enter numbers to add, enter -1 to stop"))
        values = values + input
    End While 
```

在我按输入框上的“取消”之前，它工作正常。然后字符串输入是“”，我得到以下错误：

```
System.InvalidCastException {"Conversion from string "" 
                              to type 'Double' is not valid."} 
```

我想我理解错误，我正在尝试使用 CDbl 转换非数字值。我的问题是编写此代码的更合适的方法是什么？是代码，还是只是缺少错误处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T16:53:36.327

您可以尝试使用 Double.TryParse 或使用带有 Double.Parse 的 try catch 块。既然是家庭作业，我会让你在 MSDN 上查找它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T16:54:09.383

尝试使用 Double.TryParse

```
Dim value as Double = Nothing
If Double.TryParse(InputBox("Enter numbers..."), value) Then
    values = values + value
End If 
```

我的语法可能有点不对劲，但你应该明白

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T17:00:38.107

如果他们输入的不是双精度值或太大而无法存储在双精度值中的值，您也会收到错误消息。

但是，提出的建议应该足够了，您基本上想在尝试投射之前验证用户输入。

# java - 在 Java 中解析元标记

> ID：299334
> 
> 赞同：2
> 
> 时间：2008-11-18T16:49:49.907
> 
> 标签：java, html, xml, parsing

我有一组 HTML 文档，我需要为这些文档解析 <head> 部分中的 <meta> 标记的内容。这些是我感兴趣的唯一值的 HTML 标记，即我不需要解析 <body> 部分中的任何内容。

我尝试使用 JDom 提供的 XPath 支持来解析这些值。然而，这并不是很好，因为 <body> 部分中的许多 HTML 不是有效的 XML。

有没有人对我如何以可以处理格式错误的 HTML 的方式解析这些标记值有任何建议？

干杯，唐

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-18T16:56:05.950

您可能会使用[Jericho HTML Parser](http://jerichohtml.sourceforge.net/doc/index.html)。特别是，看看[这个](http://jerichohtml.sourceforge.net/samples/console/src/FindSpecificTags.java)，看看你如何去寻找特定的标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T16:52:53.117

如果它适合您的应用程序，您可以使用[Tidy](http://tidy.sourceforge.net/)将 HTML 转换为有效的 XML，然后使用尽可能多的 XPath！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T16:54:51.427

[JTidy](http://jtidy.sourceforge.net/)应该为此提供一个很好的起点。

# c# - VS 05 - 设计器属性和组件设计器。它们有什么关系？

> ID：299341
> 
> 赞同：1
> 
> 时间：2008-11-18T16:50:42.933
> 
> 标签：c#, .net-2.0, attributes, components

我在我问的[另一篇文章](https://stackoverflow.com/questions/297335/enumerate-net-controls-items-generically-menustrip-toolstrip-statusstrip)中有这个答案：

“我相信 VS 设计器通过获取控件设计器的实例（参见 Designer 属性）来实现 [菜单条/状态条的组件]，如果设计器是 ComponentDesigner，则获取 AssociatedComponents 属性。”

我该怎么做呢？我什至不知道从哪里开始......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T22:39:58.703

该`DesignerAttribute`属性可以附加到 WinForms 中的一个`Control`或`Component`类，以指示实现设计器以可视化编辑该类型的控件或组件的类。例如，`Form`该类有一个`DesignerAttribute`表示名为`FormDocumentDesigner`实现其设计器的类。

设计器允许在 Visual Studio 的 WinForms 设计器中应用特殊设计时行为，例如调整列表视图列的大小或控件上的大小调整句柄。支持将子控件添加到现有控件的设计器，例如`FormDocumentDesigner`最终派生自`ComponentDesigner`.

您可以使用 .NET Reflector 之类的工具来检查这一点。

# asp.net - DbNull.Value 存储过程参数？

> ID：299342
> 
> 赞同：0
> 
> 时间：2008-11-18T16:51:16.677
> 
> 标签：asp.net, web-services

我有一个 Web 服务，它具有一个通用函数，该函数从存储过程的结果中返回一个数据集......一些存储过程具有可选参数，其中的值可以为空，但并非总是如此。

无论如何，我试图传入一个值为 DBNull.Value 的参数

我明白**了生成 XML 文档时出错。**这样做时从 Web 服务返回

如果我不考虑这个参数，它可以正常工作......但真的很想知道为什么 DBNull.Value 会导致这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T16:54:47.387

我相信这是因为 System.DBNull 值在数据库表中为空，但过程中的空字段实际上等同于 null/nothing 关键字。不是数据库空值。我不确定引擎盖下的技术差异。

但是在您的存储过程中，您可以将其默认为 null 而不是像您已经完成的那样发送值，或者我相信如果您发送 null/nothing 它也可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-22T16:24:45.127

您可以在 SqlParemeter 中传递 NULL 值，但必须进行一些类型转换以确保传递正确的 null 值。

在此示例中，有一个名为“Count”的参数，它是一个整数，作为 null 传递：

```
Using dtResult as New DataTable 
  Using cn as SqlConnection = New SqlConnection ("ConnectionString") 
    Using sqlcmd as SqlCommand - New SqlCommand("StoredProceName", cn) with {.CommandType=CommandType.StoredProcedure}

      Dim sp As SqlParameter
      sp = sqlcmd.Parameters.Add("@Count", SqlDbType.Int)
      sp.value = CType(Nothing, SqlTypes.SqlInt32) 

      Using myDR as SqlDataReader = sqlcmd.ExecuteReader
        dtResult.Load(myDR)
      end using 
      return dtResult 
    End Using ' For sqlcmd 
    cn.Close() ' Close the connection 
  end using ' For cn 
end using ' For dtResult 
```

# apache-flex - 如何将 Flex 应用程序的一部分导出到 SWF？

> ID：299344
> 
> 赞同：0
> 
> 时间：2008-11-18T16:51:26.193
> 
> 标签：apache-flex, actionscript, flash, export

我有一个允许您动态构建动画的 Flex 应用程序。它有一个 UI 和一个结果动画的显示，这是一个扩展 UIComponent 的自定义类。有没有办法让用户将动态生成的组件保存/导出到 SWF，以便在其他 Flash/Flex 应用程序中重复使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T17:15:00.280

您可以轻松导出屏幕截图，但我认为您无法保存 swf。看到这个线程： [http ://www.actionscript.org/forums/showthread.php3?t=145846](http://www.actionscript.org/forums/showthread.php3?t=145846)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-29T18:43:55.850

您可以在 SWC 设计时库或 RSL 运行时库中导出组件（或多个组件）以在应用程序之间共享。

# sql-server - 如果有人问你一个系统是否可以维持双倍增长，你会回答哪三件事？

> ID：299345
> 
> 赞同：2
> 
> 时间：2008-11-18T16:51:58.623
> 
> 标签：sql-server, scalability, benchmarking

假设在你的工作中你的老板说，

> 那边的那个系统，它已经失去了所有的机构知识，但现在似乎运行得很好，我们能把双倍的数据转储到里面并生存下来吗？

你完全不熟悉这个系统。

它位于 SQL Server 2000（主要是数据库应用程序）中。

没有测试环境。

如果您需要运行基准测试，您也许可以在周末劫持它。

你会做三件事来说服自己和你的经理你可以承担额外的负担。如果你不能做到这一点，在相同的硬件上......额外的硬件（以美元衡量）将需要满足该要求。

为了解决来自 doofledorfer 的响应，您的假设几乎都偏离了 180 度。但对于一个模棱两可的问题，这是我的错。

1.  其中一台主要服务器以 70% 的基础运行 7x24，并且从那里开始飙升，没有人知道它在做什么。

2.  这不是买进或抱怨的问题……我们公司在这件事上可能没有太多选择。

3.  由于这是外部强制执行的，因此延迟实施可能会导致巨额罚款。如此大的会议来评估风险几乎是不可能的。存在一个风险，即转储双倍数据会使现有客户的系统停机。

我希望有人会说类似的话，看看你是否在周日晚上的午夜让系统脱机并运行 SQLIO 测试，看看存储子系统有多接近饱和。像这样的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T17:03:19.257

1.  设置一个测试环境，即使我必须在我的笔记本电脑上进行。

2.  在生产系统上启用某种日志记录以了解除了数据量之外的事务量。

3.  当我在笔记本电脑上使用越来越多的数据运行压力测试时，请阅读源代码。

话虽如此，我很同情这个任务，因为它不公平。这就像问船上的人，船是否可以漂浮两倍的货物——但你不能下船，也不能让它停止正常服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T17:22:02.603

您刚刚描述了一个典型的敏捷项目。你的答案应该是：

1.  我不知道，如果没有测试，我将无法判断。
2.  除了数据量之外，使用模式、应用程序交互、数据库和服务器调优等方面也可能存在问题。
3.  因此，让我们研究一下风险因素的基本列表，以及我们如何解决它们。
4.  一旦我们做到了，让我们以风险的相反顺序来解决它们；并在我们开发结果时做出停止/继续决定。
5.  等等

至少在那个级别没有管理层的支持和参与，你可能给出的任何其他答案都是高风险的愿望，而“3 最重要”是不合逻辑的。

除非您当前的系统已经大量加载，否则我会很乐观。大多数服务器应在所有资源上以低于 50% 的容量运行，否则将处于生命支持状态。如果现有服务器已经在处理负载问题，我希望您不会进行对话；尽管“现在似乎运行得很好”不够精确，令人担忧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T17:00:35.067

这主要取决于其当前水平。如果加倍是从 2GB 到 4GB，那就去做吧。如果它从 1 TB 变为 2 TB，那么您有一些计划要做。

我会使用性能监视器收集一些信息并提供它以帮助做出明智的决定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T17:41:12.643

这取决于您所说的“数据加倍”是什么意思。

如果这只会影响一个表（比如产品表），那么您可能是安全的，因为大多数引用该表的查询最有可能将执行时间加倍（假设您不会两次引用同一时间在查询中）。

如果将所有表中的数据量加倍，就会出现问题，因为执行时间可能会以指数方式增长，并且可能导致一些严重的问题。

但总的来说，我会支持[doofledorfer 的回答](https://stackoverflow.com/questions/299345/if-you-were-asked-if-a-system-could-sustain-double-growth-what-3-things-would-y#299452)

# datetime - 维护服务器时间的最佳方法是什么

> ID：299359
> 
> 赞同：0
> 
> 时间：2008-11-18T16:55:08.197
> 
> 标签：datetime, synchronization, client-server

许多应用程序经常需要服务器时间。

在客户端机器上维护服务器时间的最佳方法是对服务器的请求最小化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T16:59:41.823

[标准](http://www.ntp.org/)方法是使用[NTP](http://en.wikipedia.org/wiki/Network_Time_Protocol)。您可以将其配置为根据需要进行同步，如果您的机器有不错的时钟并且除非您想要微秒精度或类似的东西，您应该每天同步一次左右

# c# - 我可以一次为 Amazon S3 存储桶中的所有对象设置 expires 标头吗？

> ID：299366
> 
> 赞同：7
> 
> 时间：2008-11-18T16:57:10.533
> 
> 标签：c#, .net, amazon-s3, amazon-web-services, cloud

我在一个桶里有大约 20 万张图片。它们都有 2050 的过期标头，但我读过您不应该发送超过一年的过期标头。我想安排一个脚本每月运行一次，并将标题设置为 6 个月后。外面有什么吗？显然我想避免迭代 200k 个对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T14:41:24.033

*免责声明：*我是这个工具的开发者，但我认为它可能会回答你的问题。

[CloudBerry Explorer](http://cloudberrylab.com) r 免费软件将能够在下一个版本中执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T14:15:35.657

S3 似乎不支持批量更新，因为它的 API 不包含此类操作。一些第三方工具声称具有批量更新功能；但是，我打赌他们只是自动化迭代。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-08T09:27:06.013

也许这是一个愚蠢的问题。但是，当您可以简单地添加 max-age=26297438 时，为什么还要设置一个脚本和所有这些？

max-age=26297438 = 大约 10 个月

yslow 和 g speed 都接受可接受的未来日期设置

# windows - 我必须做什么才能使我的 WH_SHELL 或 WH_CBT 挂钩程序接收来自其他进程的事件？

> ID：299370
> 
> 赞同：12
> 
> 时间：2008-11-18T16:58:06.333
> 
> 标签：windows, delphi, winapi, hook

我正在尝试使用`SetWindowsHookEx`设置`WH_SHELL`挂钩来获取系统范围`HSHELL_WINDOWCREATED`和`HSHELL_WINDOWDESTROYED`事件的通知。我为最后一个`dwThreadId`参数传递了 0，根据[文档](http://msdn.microsoft.com/en-us/library/ms644990(VS.85).aspx)，它应该“将钩子过程与在与调用线程相同的桌面上运行的所有现有线程相关联”。我还将参数传递给我的 DLL（`HInstance`在 Delphi 中）的句柄，`hMod`就像我查看的所有示例一样。

然而，我只收到由我自己的应用程序创建的窗口的通知，而且 - 通常情况下 - 我的测试导致桌面进程在我关闭我的应用程序后陷入困境。在你问之前，我会打电话`UnhookWindowsHookEx`。我也总是`CallNextHookEx`从我的处理程序中调用。

我正在从一个有限的用户帐户运行我的测试应用程序，但到目前为止，我还没有发现任何暗示这会起作用的提示......（虽然这实际上让我感到惊讶）

AFAICT，我按照书本做了所有事情（显然我没有，但到目前为止我看不到在哪里）。

我正在使用 Delphi (2007)，但我认为这并不重要。

**编辑：**也许我之前应该提到这一点：我确实下载并尝试了几个示例（尽管不幸的是，Delphi 没有那么多可用的示例 - 特别是`WH_SHELL`or没有`WH_CBT`）。虽然它们不会像我的测试应用程序那样使系统崩溃，但它们仍然不会捕获来自其他进程的事件（即使我可以使用 ProcessExplorer 验证它们是否可以正常加载到它们中）。因此，我的系统配置似乎有问题，或者示例错误，或者根本无法从其他进程捕获事件。任何人都可以启发我吗？

**EDIT2：**好的，这是我的测试项目的来源。

包含挂钩过程的 DLL：

```
library HookHelper;

uses
  Windows;

{$R *.res}

type
  THookCallback = procedure(ACode, AWParam, ALParam: Integer); stdcall;

var
  WndHookCallback: THookCallback;
  Hook: HHook;

function HookProc(ACode, AWParam, ALParam: Integer): Integer; stdcall;
begin
  Result := CallNextHookEx(Hook, ACode, AWParam, ALParam);
  if ACode < 0 then Exit;
  try
    if Assigned(WndHookCallback)
//    and (ACode in [HSHELL_WINDOWCREATED, HSHELL_WINDOWDESTROYED]) then
    and (ACode in [HCBT_CREATEWND, HCBT_DESTROYWND]) then
      WndHookCallback(ACode, AWParam, ALParam);
  except
    // plop!
  end;
end;

procedure InitHook(ACallback: THookCallback); register;
begin
//  Hook := SetWindowsHookEx(WH_SHELL, @HookProc, HInstance, 0);
  Hook := SetWindowsHookEx(WH_CBT, @HookProc, HInstance, 0);
  if Hook = 0 then
    begin
//      ShowMessage(SysErrorMessage(GetLastError));
    end
  else
    begin
      WndHookCallback := ACallback;
    end;
end;

procedure UninitHook; register;
begin
  if Hook <> 0 then
    UnhookWindowsHookEx(Hook);
  WndHookCallback := nil;
end;

exports
  InitHook,
  UninitHook;

begin
end. 
```

以及使用钩子的应用程序的主要形式：

```
unit MainFo;

interface

uses
  Windows, SysUtils, Forms, Dialogs, Classes, Controls, Buttons, StdCtrls;

type
  THookTest_Fo = class(TForm)
    Hook_Btn: TSpeedButton;
    Output_Lbx: TListBox;
    Test_Btn: TButton;
    procedure Hook_BtnClick(Sender: TObject);
    procedure Test_BtnClick(Sender: TObject);
  public
    destructor Destroy; override;
  end;

var
  HookTest_Fo: THookTest_Fo;

implementation

{$R *.dfm}

type
  THookCallback = procedure(ACode, AWParam, ALParam: Integer); stdcall;

procedure InitHook(const ACallback: THookCallback); register; external 'HookHelper.dll';
procedure UninitHook; register; external 'HookHelper.dll';

procedure HookCallback(ACode, AWParam, ALParam: Integer); stdcall;
begin
  if Assigned(HookTest_Fo) then
    case ACode of
  //    HSHELL_WINDOWCREATED:
      HCBT_CREATEWND:
          HookTest_Fo.Output_Lbx.Items.Add('created handle #' + IntToStr(AWParam));
  //    HSHELL_WINDOWDESTROYED:
      HCBT_DESTROYWND:
        HookTest_Fo.Output_Lbx.Items.Add('destroyed handle #' + IntToStr(AWParam));
    else
      HookTest_Fo.Output_Lbx.Items.Add(Format('code: %d, WParam: $%x, LParam: $%x', [ACode, AWParam, ALParam]));
    end;
end;

procedure THookTest_Fo.Test_BtnClick(Sender: TObject);
begin
  ShowMessage('Boo!');
end;

destructor THookTest_Fo.Destroy;
begin
  UninitHook; // just to make sure
  inherited;
end;

procedure THookTest_Fo.Hook_BtnClick(Sender: TObject);
begin
  if Hook_Btn.Down then
    InitHook(HookCallback)
  else
    UninitHook;
end;

end. 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-21T23:11:02.353

问题是您的钩子 DLL 实际上被加载到几个不同的地址空间中。每当 Windows 在某个外部进程中检测到必须由您的钩子处理的事件时，它会将钩子 DLL 加载到该进程中（当然，如果它尚未加载）。

但是，每个进程都有自己的地址空间。这意味着您在 InitHook() 中传递的回调函数指针仅在您的 EXE 上下文中才有意义（这就是它适用于您应用程序中的事件的原因）。在任何其他进程中，该指针都是**垃圾**；它可能指向无效的内存位置，或者（更糟）指向一些随机代码部分。结果可能是访问冲突或静默内存损坏。

通常，解决方案是使用某种[进程间通信](http://msdn.microsoft.com/en-us/library/aa365574(VS.85).aspx)(IPC) 来正确通知您的 EXE。对于您的案例，最轻松的方法是发布一条消息并将所需的信息（事件和 HWND）塞入其 WPARAM/LPARAM。您可以使用 WM_APP+n 或使用 RegisterWindowMessage() 创建一个。确保消息已发布而不是发送，以避免任何死锁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-14T19:52:44.650

这可能是您的问题的第三个问题，但是正如您所看到的，钩子**很难**正确处理 - 如果您可以通过任何方式避免使用它，那就去做吧。你会遇到各种各样的问题，尤其是在你必须处理 UIPI 的 Vista 上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T19:44:09.933

只是为了澄清“efotinis”提到的关于将消息发布回您的进程的内容 - 您发布到主进程的 wParam 和 lParam 不能是指针，它们只能是“数字”。

例如，假设您挂钩 WM_WINDOWPOSCHANGING 消息，Windows 将向您传递一个指向 lparam 中的 WINDOWPOS 的指针。您不能只将该 lparam 发布回您的主进程，因为 lparam 指向的内存仅在接收消息的进程中有效。

当他说“将所需的信息（事件和 HWND）塞进其 WPARAM/LPARAM”时，这就是“efotinis”的意思。如果你想传回更复杂的消息，你将需要使用其他一些 IPC（如命名管道、TCP 或内存映射文件）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-21T10:08:19.530

大声笑，看起来错误在测试代码中。

如果您创建两个单独的按钮，一个用于 Init，一个用于 UnInit（我更喜欢 Exit）。

```
procedure THooktest_FO.UnInitClick(Sender: TObject);
begin
  UninitHook;
end;

procedure THooktest_FO.InitClick(Sender: TObject);
begin
  InitHook(HookCallback)
end; 
```

启动应用程序。单击初始化，然后单击测试按钮，显示以下输出：

```
created handle #1902442
destroyed handle #1902442
created handle #1967978
created handle #7276488 
```

然后显示消息框。

如果你点击确定，你会得到：

```
destroyed handle #1967978 
```

高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-21T13:45:06.380

我找到了 SetWindowsHookEx 的 Delphi 基础文档。但是文字有点模糊。

```
function SetWindowsHookEx(idHook: Integer; lpfn: TFNHookProc; 
  hmod: HInst; dwThreadId: DWORD): HHOOK; 
```

*   hmod：包含 lpfn 参数指向的钩子函数的模块（DLL）句柄。如果 dwThreadId 标识由当前进程创建的线程并且 dlpfn 指向位于与当前进程关联的代码中的挂钩函数，则必须将此参数设置为零。

*   dwThreadId：已安装的钩子函数将关联到的线程的标识符。如果此参数设置为零，则挂钩将是与所有现有线程相关联的系统范围挂钩。

顺便说一句，对于 hmod 参数，您应该使用模块句柄。（HINSTANCE 指向应用程序句柄）。

```
hand := GetModuleHandle('hookhelper.dll');
Hook := SetWindowsHookEx(WH_SHELL, @HookProc, hand, 0); 
```

但是，尽管手与 HINSTANCE 不同，它仍然显示相同的结果。

# java - db4o 和 OSGi - 重新启动后的空数据库

> ID：299373
> 
> 赞同：0
> 
> 时间：2008-11-18T16:59:00.827
> 
> 标签：java, osgi, db4o

我在 OSGi 环境中使用 db4o 6.4.54 作为模型存储。每次我重新启动 OSGi 框架时，数据库似乎是空的，尽管文件在那里并且肯定不是空的。

我有以下配置：

一个核心包，它依赖于 db4o 提供的标准 db4o_osgi 包。一个 UI 包，它依赖于核心插件，从中获取模型。

核心包通过 openServer(String, 0) 方法创建内存服务器，然后为每个请求/线程创建单独的客户端。

问题是，每次创建 db4o 服务器时，查询都不会返回结果。

我尝试使用该服务，但它也没有工作。

我测试的下一步是将 db4o 直接包含到我的包中并且它可以工作（效果是 db4o 类由与模型对象相同的类加载器加载，我将其存储到数据库中）。db4o 论坛 [1] 中有一篇帖子，但它未能解释为什么会存在这个问题以及应该如何（正确地）解决它。我会继续我的调查，但我想知道是否还有其他人在我之前解决了这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-20T23:09:31.107

您是否在关闭 osgi 包时提交了更改并关闭了客户端连接？

eg: sth like

```
ObjectContainer client;

public void start(BundleContext context) throws Exception {
   client = Db4oClientServer.openClient(...);
}    

public void stop(BundleContext context) throws Exception {
   if (!client.ext().isClosed())
      client.close();
} 
```

或者查看[我的独立 Db4oServer](https://timefinder.svn.sourceforge.net/svnroot/timefinder/branches/timefinderwicket/src/main/java/de/timefinder/data/dao/odb/Db4oServer.java)，它可以从要停止的客户端收到消息“停止”。

# silverlight - 如何构建用于 Silverlight 类库的样式库？

> ID：299379
> 
> 赞同：0
> 
> 时间：2008-11-18T17:00:05.520
> 
> 标签：silverlight, styling

我有一个由一组 Silverlight 类库构建的 Silverlight 应用程序。我想创建一个通用 Silverlight 库，其中包含一组用于定义用于所有 Silverlight UI 库的样式的资源。这与`<Styles>'s`App.xaml 文件中的节点中定义的类似。

这可能吗？如果是这样，我将如何实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T18:50:49.180

虽然使用 WPF 可以做到这一点（通过动态资源，[请参阅此视频](http://channel9.msdn.com/pdc2008/PC47/)并快进到 12:00），但我认为这在 Silverlight 中尚不可行。与此最接近的是[Silverlight 工具包中的主题](http://www.codeplex.com/Silverlight/Wiki/View.aspx?title=Silverlight%20Toolkit%20Overview%20Part%203&referringTitle=Home)。团队在该页面上有一条评论指出您无法在 Silverlight 2 中在运行时更改主题（或资源样式）：

> unruledboy，我们不支持在运行时更改主题，因为这不是 Silverlight 框架支持的功能。

所以我认为主题是目前最接近的东西。

# vb.net - 如何在 VB.NET 1.1 中对对象序列化/反序列化进行单元测试？

> ID：299382
> 
> 赞同：2
> 
> 时间：2008-11-18T17:00:44.800
> 
> 标签：vb.net, unit-testing, serialization, nunit, .net-1.1

我正在寻找提供单元测试以从内存流中序列化和反序列化对象的示例代码。我找到了[使用 C# 2.0 的示例](https://stackoverflow.com/questions/236599/how-to-unit-test-if-my-object-is-really-serializablable)，但是我当前的项目使用的是 VB.NET 1.1（不要问我为什么......），所以解决方案不能使用泛型。我也在使用 NUnit 框架进行单元测试。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-30T14:30:00.460

这是我确定的模式：

```
<Test()> _
Public Sub SerializationTest()
    Dim obj As New MySerializableObject()
    'Perform additional construction as necessary

    Dim obj2 As MySerializableObject
    Dim formatter As New BinaryFormatter
    Dim memoryStream As New MemoryStream()

    'Run through serialization process
    formatter.Serialize(memoryStream, obj)
    memoryStream.Seek(0, SeekOrigin.Begin)
    obj2 = DirectCast(formatter.Deserialize(memoryStream), MySerializableObject)

    'Test for equality using Assert methods
    Assert.AreEqual(obj.Property1, obj.Property1)
    'etc...
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-12T17:06:44.787

NUnit 内置了对此的支持，这使它变得相当容易：

```
Dim obj As New MySerializableObject()
Assert.That(obj, Is.BinarySerializable) 
```

或者对于 xml：

```
Dim obj As New MySerializableObject()
Assert.That(obj, Is.XmlSerializable) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T17:27:51.173

如果您要做的只是确保它们是可序列化的，那么您应该做的就是对对象进行序列化并确保没有引发 XmlSerializationException

```
[Test]
public void ClassIsXmlSerializable()
{
   bool exceptionWasThrown = false;

   try
   {
      // .. serialize object
   }
   catch(XmlSerializationException ex)
   {
      exceptionWasThrown = true;
   }

   Asset.IsFalse(exceptionWasThrown, "An XmlSerializationException was thrown. The type xx is not xml serializable!");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T17:05:39.407

嗯...所以您正在尝试为序列化编写单元测试？还是用于流？希望这已经由 MS 完成了......但是如果您不信任或自己实现某些东西......您可以用一些数据填充对象，保存它，恢复它，并检查字段值是否到位?

# datetime - C# 将类序列化为 XML，其中类属性之一是 DateTime。如何以 ISO 格式制作此属性？

> ID：299387
> 
> 赞同：11
> 
> 时间：2008-11-18T17:01:55.203
> 
> 标签：datetime, xml-serialization

我正在序列化包含 DateTime 属性的类。

```
public DateTime? Delivered { get; set; } 
```

序列化 Delivered 节点后包含 DateTime 格式如下：

```
2008-11-20T00:00:00 
```

如何更改此属性以使其看起来像这样：

```
2008-11-20 00:00:00 
```

提前致谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-18T17:39:29.853

我在 XmlSerialization 期间用于奇怪格式的 hack 是拥有一个仅在 XmlSerialization 期间使用的特殊属性

```
//normal DateTime accessor
[XmlIgnore]
public DateTime Delivered { get; set; }

//special XmlSerialization accessor
[XmlAttribute("DateTime")]
public string XmlDateTime
{
    get { return this.Delivered.ToString("o"); }
    set { this.Delivered = new DateTime.Parse(value); }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T17:14:44.133

看看[XmlAttributeOverrides 类](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlattributeoverrides(VS.71).aspx)。

# iphone - 我一般如何使用 KVC 来更新字段？

> ID：299390
> 
> 赞同：3
> 
> 时间：2008-11-18T17:02:51.490
> 
> 标签：iphone, objective-c, cocoa-touch

假设我有以下 Objective-C 类：

```
@interface Foo {
     int someNumber;
     NSString *someString;
} 
```

由于我不会进入这里的原因，我想使用 KVC 以通用方式更新这些变量的值：

```
[f setValue:object forKey:@"someNumber"];

or

[f setValue:object forKey:@"someString"];` 
```

If`object`是一个字符串并且我正在更新`someNumber`变量，看来我需要知道使用 NSNumberFormatter 来获取 NSNumber ，然后 Cocoa 会自动将其转换为 int inside `setValue:forKey:`。

有什么办法可以避免这种自定义代码并让 Cocoa 从字符串推断转换为 int，还是我需要每次都捕捉到这种情况并自己处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T17:43:58.317

下面的代码应该自动处理转换，只要`object`参数是实现的类的成员`integerValue`。

请注意两者`NSNumber`并`NSString`实现此方法。

```
- (void)setValue:(id)object forKey:(NSString *)key
{
    if ([key isEqual:@"someNumber"])
    {
        someNumber = [object integerValue];
    }
    //...
}
```

**编辑：（**旁注）：您可以避免使用objective-c属性自己编写方法。的默认实现`setValue:forKey:`将为您完成工作，只要您为`someNumber`和创建属性`someString`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T17:36:17.333

您应该使用数字格式化程序自己进行转换，它为您提供比框架可能认为合适的任何东西更好的控制。使用对象的单个实例来更新 ivars 的值也可能不是一个好主意。更恰当地说，您可以根据对象的类执行更新（前提是您没有`id`通过使用 查询运行时关于对象的类来存储在 中`object_getClassName`。更多信息可在 Objective-C 2.0 运行时参考. 但一般来说，你可能会在你的代码中发现错误，因为这样做的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T19:52:13.893

我和wisequark在这个。我认为 setValue:forKey: 相当于直接调用 setter。如果你有一个方法：

```
- (void)setSomeValue:(NSInteger)aValue 
```

您不会期望能够传入一个 NSString 并希望该方法能够解决它。

换句话说，键值使您可以访问属性，并且该属性具有类型。使用 KVC 时，数字只是被包装在一个 NSNumber 对象中，因此只有一个 setValue:forKey: 方法。因此，我说将字符串打包到 NSNumber 对象中始终是调用代码的责任。

像这样的时候，我感叹 Cocoa Touch 不支持绑定。绑定将允许您添加一个值转换器，该转换器可以自动为您处理从字符串到数字的转换。也许在下一个版本！

# batch-file - 如何创建批处理文件计时器以全天执行/调用另一个批处理

> ID：299392
> 
> 赞同：17
> 
> 时间：2008-11-18T17:03:02.720
> 
> 标签：batch-file, timer, cmd

如何创建批处理文件计时器以在一天中执行/调用另一个批处理可能在给定时间运行但不在周末运行？必须在系统时间上运行也可以是.cmd 才能在xp server 2003上运行

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-12-02T21:21:17.587

对于脚本的计时器部分，我强烈建议使用：

```
echo.
echo Waiting For One Hour... 
TIMEOUT /T 3600 /NOBREAK
echo.
echo (Put some Other Processes Here)
echo.
pause >nul 
```

此脚本等待 1 小时（3600 秒），然后继续执行该脚本，用户无法按任何按钮绕过计时器（CTRL+C 除外）。

您可以使用

```
Timeout /t 3600 /nobreak >nul 
```

如果您不想在屏幕上看到倒计时。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-18T17:18:17.900

我会使用调度程序（控制面板）而不是 cmd 行或其他应用程序。

控制面板 -> 计划任务

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-29T20:02:20.890

下面是一个批处理文件，它将等待 1 分钟，检查日期，然后执行操作。它使用 PING.EXE，但不需要 Windows 未包含的文件。

```
@ECHO OFF

:LOOP
ECHO Waiting for 1 minute...
  PING -n 60 127.0.0.1>nul
  IF %DATE:~0,3%==Mon CALL SomeOtherFile.cmd
  IF %DATE:~0,3%==Tue CALL SomeOtherFile.cmd
  IF %DATE:~0,3%==Wed CALL SomeOtherFile.cmd
  IF %DATE:~0,3%==Thu CALL WootSomeOtherFile.cmd
  IF %DATE:~0,3%==Fri CALL SomeOtherFile.cmd
  IF %DATE:~0,3%==Sat ECHO Saturday...nothing to do.
  IF %DATE:~0,3%==Sun ECHO Sunday...nothing to do.
GOTO LOOP 
```

它可以在许多方面进行改进，但它可能会让你开始。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T15:09:54.227

AT 命令可以做到这一点，但这就是 Scheduled Tasks gui 的用途。在 cmd 窗口中输入“help at”以获取详细信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T17:14:58.687

我通过编写一个小 C# 应用程序来做到这一点，该应用程序刚刚唤醒以启动定期任务——不知道它是否可以从批处理文件中执行，而无需下载扩展程序以支持睡眠命令。（出于我的目的，Windows 调度程序不起作用，因为启动的应用程序没有可用的图形上下文。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-19T15:28:15.783

```
@echo off
:Start
title timer
color EC
echo Type in an amount of time (Seconds)
set /p time=

color CE

:loop
cls
ping localhost -n 2 >nul
set /a time=%time%-1
echo %time%
if %time% EQU 0 goto Timesup
goto loop

:Timesup
title Time Is Up!
ping localhost -n 2 >nul
ping localhost -n 2 >nul
cls
echo The Time is up!
pause
cls
echo Thank you for using this software.
pause
goto Web
goto Exit

:Web
rem type ur command here

:Exit
Exit
goto Exit 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-29T11:18:50.190

```
@echo off
:Start # seting a ponter
title timer  #name the cmd window to "Timer"
echo Type in an amount of time (Seconds)  
set /p A=  #wating for input from user
set B=1  

cls  
:loop  
ping localhost -n 2 >nul  #pinging your self for 1 second
set /A A=A-B  #sets the value A - 1
echo %A%  # printing A
if %A% EQU 0 goto Timesup  #if A = 0 go to ponter Timesup eles loop it
goto loop

:Timesup  #ponter Timesup
cls  #clear the screen
MSG * /v "time Is Up!"  #makes a pop up saying "time Is Up!"
goto Exit  #go to exit

:Exit 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-08-11T18:21:21.530

不涉及 ping 的更好的代码：

```
SET COUNTER=0
:loop
SET /a COUNTER=%COUNTER%+1
XCOPY "Server\*" "c:\minecraft\backups\server_backup_%COUNTER%" /i /s
timeout /t 600 /nobreak >nul
goto loop 
```

600 秒是 10 分钟，但是你可以设置任何你想要的时间

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-30T19:06:54.570

你也可以这样做>

```
@echo off
:loop
set a=60
set /a a-1
if a GTR 1 (
echo %a% minutes remaining...
timeout /t 60 /nobreak >nul
goto a
) else if a LSS 1 goto finished
:finished
::code
::code
::code
pause>nul 
```

或类似的东西。

# perl - 什么时候应该使用 OO Perl？

> ID：299405
> 
> 赞同：7
> 
> 时间：2008-11-18T17:07:20.527
> 
> 标签：perl, oop

我只是在学习 Perl。

什么时候建议使用 OO Perl 而不是非 OO Perl？

我的倾向是总是更喜欢 OO，除非项目只是一个小于 10 行的代码片段。

TIA

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-18T20:58:40.513

[从达米安康威](http://www.perlmonks.org/?node_id=91080)：

> ## 了解何时使用面向对象设计的 10 个标准
> 
> * * *
> 
> 1.  ### 设计很大，或可能变大
>     
>     
> 2.  ### 当数据被聚合成明显的结构时，尤其是当每个聚合中有大量数据时
>     
>     
>     
>     例如，IP 地址不是一个好的候选者：与 IP 地址相关的信息只有 4 个字节。一个过海关的移民有很多与他相关的数据，比如姓名、原籍国、携带的行李、目的地等。
>     
>     
> 3.  ### 当数据类型形成允许我们使用继承的自然层次结构时。
>     
>     
>     
>     继承是面向对象最强大的特性之一，使用它的能力是一个标志。
>     
>     
> 4.  ### 当对数据的操作因数据类型而异时
>     
>     
>     
>     GIF 和 JPG 的裁剪方式可能不同，即使它们都是图形。
>     
>     
> 5.  ### 当您可能需要稍后添加数据类型时
>     
>     
>     
>     OO 为您提供了未来扩展的空间。
>     
>     
> 6.  ### 当数据之间的交互最能由操作员显示时
>     
>     
>     
>     使用可以重载的运算符可以最好地显示某些关系。
>     
>     
> 7.  ### 当组件的实现可能发生变化时，尤其是在同一个程序中
>     
>     
> 8.  ### 当系统设计已经是面向对象时
>     
>     
> 9.  ### 当大量客户使用您的代码时
>     
>     
>     
>     如果您的代码将分发给将要使用它的其他人，那么标准接口将使维护和安全更加容易。
>     
>     
> 10.  ### 当您有一段数据应用了许多不同的操作时
>     
>     
>     
>     例如，图形图像可能会被模糊、裁剪、旋转和调整。
>     
>     
> 11.  ### 当操作种类有标准名称时（检查、处理等）
>     
>     
>     
>     对象允许您拥有`DB::check`, `ISBN::check`,`Shape::check`等而不会在检查类型之间产生冲突。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-18T19:01:19.393

关于同一主题[@PerlMonks](http://perlmonks.org/?node_id=693430)进行了很好的讨论。

拥有[Moose](http://moose.perl.org)肯定会让从一开始就更容易始终使用 OO。唯一真正的例外是编译启动是否存在问题（Moose 目前确实有编译时间开销）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-18T17:18:54.187

我认为您不应该通过代码行来衡量它。

你是对的，通常当你只是编写一个简单的脚本时，OO 可能开销太大，但我认为你应该更灵活地考虑 10 行方法。

在所有情况下，当您使用 OO Perl 时，请记住[使用 Moose](http://search.cpan.org/perldoc?Moose)（或鼠标）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-18T19:44:43.363

这个问题与 Perl 没有太大关系。问题是“如果可以选择，我什么时候应该使用 OO？” 那个“给定选择”位是因为在某些语言（例如Java）中，你真的别无选择。

答案是“当它有意义时”。想想你要解决的问题。该问题是否适合类和对象的 OO 概念？如果是这样，那就太好了，请使用 OO。否则使用其他范式。

Perl 相当灵活，您可以轻松编写过程式、函数式或 OO Perl，甚至可以将它们混合在一起。不要因为其他人都在做OO。学习为每项任务使用正确的方法。

所有这些都需要经验和实践，因此请务必尝试所有这些方法，甚至可能会采取一些较小的问题并以多种方式解决它们，以了解每种方法的工作原理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T17:43:55.197

[Damian Conway在](http://search.cpan.org/~dconway/)[Perl Best Practices](http://books.google.com/books?id=gJf9tI2mytIC&pg=PA365&lpg=PA365&dq=perl+best+practices+objects&source=bl&ots=Hk-hfJzBhs&sig=mEWiKgcOEeUqh_7rHX-6jGrsqu4&hl=en&sa=X&oi=book_result&resnum=1&ct=result#PPA320,M1)中有一篇关于此的文章。这不是你必须遵循的规则，但它可能是更好的建议，我可以在不知道你在做什么的情况下给出。

如果这是链接到该书的更好位置，那么 这里是[出版商的页面。](http://safari.oreilly.com/0596001738)

# linux - 是否有适用于 Linux 的 WinSCP？

> ID：299412
> 
> 赞同：213
> 
> 时间：2008-11-18T17:10:24.780
> 
> 标签：linux, scp, winscp

我喜欢Windows 的[WinSCP](https://en.wikipedia.org/wiki/WinSCP)。什么是 Linux 的最佳等效软件？

我尝试使用 sshfs 在本地机器上挂载远程文件系统，但它不像简单地启动 GUI 那样用户友好，而且它似乎需要在客户端机器上进行 root 访问，这不是很方便。

当然命令行工具如 scp 是可能的，但我正在寻找一个简单的 GUI。

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2008-11-18T18:44:04.483

如果您使用的是[GNOME](https://en.wikipedia.org/wiki/GNOME)，您可以转到：*Places* → *Connect to Server* in [Nautilus](https://en.wikipedia.org/wiki/GNOME_Files)并选择 SSH。如果您运行并配置了 SSH 代理，则不会询问密码！（这与 Nautilus 中的 sftp://root@servername/directory 相同）

在[Konqueror](https://en.wikipedia.org/wiki/Konqueror)中，您只需键入：fish://servername。

Per Mike R：在[Ubuntu 14.04](https://en.wikipedia.org/wiki/Ubuntu_version_history#Ubuntu_14.04_LTS_.28Trusty_Tahr.29)（使用[Unity](https://en.wikipedia.org/wiki/Unity_(user_interface))）中，它位于菜单中的*Files* → *Connect to Server或侧边栏中的**Network* → *Connect to Server*下。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2008-11-18T17:40:48.540

FileZilla 适用于 Linux。如果您使用的是 Ubuntu：

```
sudo apt-get install filezilla 
```

否则，您可以从[FileZilla 网站](http://filezilla-project.org/download.php?type=client)下载。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2014-06-23T01:55:23.527

我使用*FileZilla*，它适用于**SFTP**（SSH 文件传输协议）。请按照以下步骤安装和配置它：

**1.**通过终端安装*FileZilla ：*

```
sudo apt-get install filezilla 
```

**2.**打开程序并转到菜单*文件*→*站点管理器...*或简单地输入`Ctrl`+`S`

**3.**应出现以下窗口： ![在此处输入图像描述](https://i.stack.imgur.com/iZHRa.png)

**4.**输入您的主机名称，选择端口（对于 ssh/scp/sftp，通常为*22*）并选择**SFTP - SSH 文件传输协议**作为协议，如果需要身份验证，可选择将**登录类型**设置为**正常**，然后输入您的数据.

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2013-01-23T17:39:17.637

[Xfce](https://en.wikipedia.org/wiki/Xfce) / [Thunar](https://en.wikipedia.org/wiki/Thunar)解决方案与[GNOME](https://en.wikipedia.org/wiki/GNOME) / [Nautilus](https://en.wikipedia.org/wiki/GNOME_Files)基本相同：

只需`sftp://yourhost/`在 Thunar 中输入地址行（您可以通过`Ctrl`+到达那里`L`）。

（授权与`ssh`/相同`scp`，即正确使用 file `~/.ssh/config`、 keys 和 ssh-agent ，您可以获得不错的易用性和安全性：服务器别名 + 不询问密码。）

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2014-04-18T22:37:28.470

[要在 Linux ( Ubuntu 12.04](https://en.wikipedia.org/wiki/Ubuntu_version_history#Ubuntu_12.04_LTS_.28Precise_Pangolin.29) (Precise Pangolin))下运行 WinSCP ，请执行以下步骤：

1.  运行`sudo apt-get install wine`（仅运行一次，以在您的系统中获取“葡萄酒”，如果您没有的话）
2.  下载最新的 WinSCP 便携包[https://winscp.net/eng/download.php](https://winscp.net/eng/download.php)
3.  做一个文件夹，把ZIP文件的内容放到这个文件夹里
4.  打开终端
5.  类型`wine WinSCP.exe`

完毕！WinSCP 将像在 Windows 环境中一样运行！

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-11-18T17:17:53.953

1.  [gFTP](https://en.wikipedia.org/wiki/GFTP)
2.  [Konqueror](https://en.wikipedia.org/wiki/Konqueror)的鱼 kio-slave（只要写成文件路径：ssh://user@server/path

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-11-18T17:14:35.443

我为此使用了[gFTP](http://gftp.seul.org/)。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2009-12-15T12:46:00.183

WinSCP 在[Wine](https://en.wikipedia.org/wiki/Wine_%28software%29)下的 Linux 上运行良好。我安装了 Wine 和 WinSCP，没有任何问题。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2010-05-20T06:05:22.097

使用[FireFTP](https://en.wikipedia.org/wiki/FireFTP)、[Krusader](https://en.wikipedia.org/wiki/Krusader)和其他类似的应用程序。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2012-12-04T09:02:38.333

在这种情况下，可以轻松使用 Nautilus。

对于[Fedora](https://en.wikipedia.org/wiki/Fedora_%28operating_system%29) 16，进入菜单*File* → *Connect To Server*，选择适当的协议，输入所需的详细信息并简单地连接。只需确保 SSH 服务器正在另一端运行。它工作得很好。

这在[Ubuntu 14.04](https://en.wikipedia.org/wiki/Ubuntu_version_history#Ubuntu_14.04_LTS_.28Trusty_Tahr.29) (Trusty Tahr) 上也有效。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-11-13T21:51:52.133

我发现 WinSCP 做得很好但使用 Ubuntu 工具无法轻松完成的一件事是通过隧道连接到辅助机器。这是通过 WinSCP 中的一对一连接设置完成的。虽然我可以使用 Ubuntu (11.11) 中的本机文件浏览器访问任何机器，但我无法轻松地通过中间机器访问第三台机器。我怀疑这是因为我不太了解如何设置隧道。我在玩 gSTM，但文档很少，我怀疑它是用于设置本地隧道，而不是远程隧道。无论如何，它并不像 WinSCP 做的那么简单。这不是答案，但也许它突出了 WinSCP 的一个关键特性，即对替代方案的建议应该解决。

现在开始了解有关隧道的更多信息...

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-08-04T17:26:47.863

没有提到的一件大事是，使用 WinSCP，您还可以使用密钥文件身份验证，而我无法在 Ubuntu FTP 客户端上成功地做到这一点。KFTPGrabber 是我能找到的最接近支持密钥文件身份验证的东西......但它仍然对我不起作用，而 WinSCP 可以。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2012-09-17T10:53:42.837

使用[Nautilus](https://en.wikipedia.org/wiki/GNOME_Files)，[GNOME](https://en.wikipedia.org/wiki/GNOME)中的默认文件管理器。以下是您可能的方法 - *[Linux 上的最佳 SCP GUI](http://adhocshare.blogspot.in/2012/09/best-scp-gui-on-linux.html)*。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-06-12T07:56:33.683

如果您使用[Xfce](https://en.wikipedia.org/wiki/Xfce)（或[LXDE](https://en.wikipedia.org/wiki/LXDE)）而不是[GNOME](https://en.wikipedia.org/wiki/GNOME)，则有一个等效工具：[Gigolo](http://www.uvena.de/gigolo/index.html)。

我想，但不确定，它也可以安装在其他桌面环境中。

它支持 FTP、SSH 和 WebDAV，使用起来非常直观：只需点击*Connect*，选择协议，填写参数即可。您可以保存连接以供以后使用。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-05-20T06:42:18.920

只需使用[GNOME](https://en.wikipedia.org/wiki/GNOME)。只需输入地址就可以了！

# asp.net - 如果页面作为弹出窗口打开，是否可以隐藏 asp.net 母版页的内容？

> ID：299414
> 
> 赞同：2
> 
> 时间：2008-11-18T17:11:34.357
> 
> 标签：asp.net, javascript

我有几个 aspx 页面可以正常打开（在浏览器中全屏），或者从另一个页面作为弹出窗口调用（我使用的是 Greybox，fwiw）

如果页面在 Greybox 中作为弹出窗口打开，我不想显示母版页内容（显示常见的顶部和左侧菜单等）。

据我所知，如果页面是弹出窗口，则无法知道服务器端，这必须在客户端 javascript 中检测到（在 Greybox 的情况下，通过检查 window.parent.parent），因此母版页内容也必须通过 javascript 隐藏。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-18T18:06:18.367

为弹出窗口创建一个简化的母版页。覆盖（实际页面的） OnPreInit 方法并根据查询字符串参数切换母版页：

```
protected override void OnPreInit(EventArgs e)
{
        base.OnPreInit(e);

        if(Request["PopUp"] == "Y")
        {
            MasterPageFile = "~/MyPopUp.master";
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T17:17:10.477

好吧，您可以有条件地根据查询字符串呈现导航控件等，在弹出窗口时传入字符串，如果存在则不呈现控件。有几种不同的方法可以做到这一点，但我认为你应该让服务器不呈现控件而不是客户端隐藏它们。

PS 还没有听说过 Greybox，所以我不能在那里提供任何具体的见解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T20:40:56.867

我同意。这是一个服务器端的问题，而不是在客户端上拼凑出来的问题。组织您的网页也可能很有价值，其中弹出窗口和主页之间的公共内容是分开维护的，并将服务器端导入到具有母版页环绕的页面中。链接弹出窗口的页面应该使用评论内容，而不是周围。

有很多方法可以做到这一点（但我认为没有人想知道 FrontPage 扩展如何提供帮助）。尝试服务器端包含。

# sql - 桥接表的 SQL 查询帮助

> ID：299416
> 
> 赞同：6
> 
> 时间：2008-11-18T17:13:03.730
> 
> 标签：sql, sql-server, pivot

我正在使用现有数据库并尝试编写一个 sql 查询来获取所有帐户信息，包括权限级别。这是为了安全审计。我们希望以一种可读的方式转储所有这些信息，以便于比较。我的问题是权限有一个桥/链接表，因此每个用户有多个记录。我想在一行上获得一个用户的所有权限的结果。这是一个例子：

```
Table_User:
UserId   UserName
1        John
2        Joe
3        James

Table_UserPermissions:
UserId   PermissionId   Rights
1        10             1
1        11             2
1        12             3
2        11             2
2        12             3
3        10             2 
```

PermissionID 链接到带有权限名称及其功能的表。权利就像 1 = 查看，2 = 修改等等。

我从用户 1 的基本查询中得到的是：

```
UserId UserName PermissionId Rights
1      John     10           1
1      John     11           2
1      John     12           3 
```

我想要这样的东西：

```
UserId UserName Permission1 Rights1 Permission2 Right2 Permission3 Right3
1      John     10          1       11          2      12          3 
```

理想情况下，我希望所有用户都这样做。我发现的最接近的是 SQL Server 2005 中的 Pivot 函数。 [http://geekswithblogs.net/lorint/archive/2006/08/04/87166.aspx](http://geekswithblogs.net/lorint/archive/2006/08/04/87166.aspx) 据我所知，这个问题是我需要为每个用户命名每一列，我不确定如何获得权限级别。使用真实数据，我有大约 130 个用户和 40 种不同的权限。

是否有另一种仅使用 sql 的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T17:38:49.887

你可以这样做：

```
select userid, username
,      max(case when permissionid=10 then rights end) as permission10_rights
,      max(case when permissionid=11 then rights end) as permission11_rights
,      max(case when permissionid=12 then rights end) as permission12_rights
from   userpermissions
group by userid, username; 
```

您必须为每个权限 ID 显式添加类似的 max(...) 列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T01:33:50.973

如果你在哪里使用 MySQL，我建议你使用[group_concat()](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)如下所示。

```
select UserId, UserName, 
       group_concat(PermissionId) as PermIdList,
       group_concat(Rights SEPARATOR ',') as RightsList
from Table_user join Table_UserPermissions on 
     Table_User.UserId = Table_UserPermissions.UserId=
GROUP BY Table_User.UserId 
```

这将返回

```
UserId UserName PermIdList  RightsList
1      John     10,11,12    1,2,3 
```

对“mssql group_concat”的快速谷歌搜索显示了可以实现相同行为的 MSSQL 的几个不同存储过程 ( [I](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=33574) )、( [II](http://www.stevenmapes.com/index.php?/archives/23-Recreating-MySQL-GROUP_CONCAT-In-MSSQL-Cross-Tab-Query.html) )。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T17:52:58.407

简短的回答：

不。

您不能在查询中动态添加列。

请记住，SQL 是一种基于集合的语言。您查询集合并将集合连接在一起。

您要挖掘的是一个递归列表，并要求该列表水平而不是垂直地串在一起。

您可以使用一组自连接来伪造它，但为了做到这一点，您必须在编写查询之前了解所有可能的权限......这是其他建议所提出的。

您还可以将记录集拉回另一种语言，然后对其进行迭代以生成正确的列。

就像是：

```
SELECT Table_User.userID, userName, permissionid, rights
FROM Table_User
        LEFT JOIN Table_UserPermissions ON Table_User.userID =Table_UserPermissions.userID
ORDER BY userName 
```

然后使用（Python）之类的东西显示每个用户的所有权限：

```
userID = recordset[0][0]
userName = recordset[0][1]
for row in recordset:
   if userID != row[0]:
       printUserPermissions(username, user_permissions)
       user_permissions = []
       username = row[1]
       userID = row[0]

    user_permissions.append((row[2], row[3]))

printUserPermissions(username, user_permissions) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T18:30:26.290

如果可以接受，我在设计和/或实施方面使用的策略是将查询转储到 Excel 或 Access 中。两者都有更友好的用户界面来透视数据，并且更多的人在这种环境中感到舒适。

一旦有了自己喜欢的设计，就更容易考虑如何在 TSQL 中复制它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T18:51:47.370

似乎枢轴函数是为您可以在其中一个字段上使用聚合函数的情况而设计的。就像我想知道每个销售人员为 x 公司赚了多少收入一样。我可以总结销售表中的价格字段。然后我会得到销售人​​员以及他们有多少销售收入。对于权限，尽管对permissionId 字段或Rights 字段进行求和/计数/等是没有意义的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T19:02:54.693

您可能希望查看以下有关在 SQL 中创建交叉表查询的示例：

[http://www.databasejournal.com/features/mssql/article.php/3521101/Cross-Tab-reports-in-SQL-Server-2005.htm](http://www.databasejournal.com/features/mssql/article.php/3521101/Cross-Tab-reports-in-SQL-Server-2005.htm)

SQL Server 2005 中似乎包含了一些新操作，称为 PIVOT 和 UNPIVOT

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T17:41:12.440

您可以创建一个临时 table_flatuserpermissions ：

```
用户身份
权限 ID1
权利1
权限 ID2
权利2
...等您需要的尽可能多的权限/权利组合
```

从 Table_user 将记录插入此表，所有权限和权限字段均为空。

从 table_userpermissions 更新此表上的记录 - 第一条记录插入并设置 PermissionID1 和 Rights1，第二条记录用于用户更新 PermissionsID2 和 Rights2 等。

然后查询此表以生成报告。

就个人而言，我会坚持使用您现在拥有的 UserId、UserName、PermissionID、Rights 列。

也许用一些文本代替 PermissionID 和 Rights 而不是数值。

也许按 PermissionID、User 而不是 User、PermissionID 对表进行排序，以便审核员可以检查每个权限类型的用户。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-21T15:09:49.980

对于这种类型的数据转换，您将需要先执行数据`UNPIVOT`，然后再执行`PIVOT`数据。如果您知道要转换的值，则可以使用静态数据透视对查询进行硬编码，否则可以使用动态 sql。

**创建表：**

```
CREATE TABLE Table_User
    ([UserId] int, [UserName] varchar(5))
;

INSERT INTO Table_User
    ([UserId], [UserName])
VALUES
    (1, 'John'),
    (2, 'Joe'),
    (3, 'James')
;

CREATE TABLE Table_UserPermissions
    ([UserId] int, [PermissionId] int, [Rights] int)
;

INSERT INTO Table_UserPermissions
    ([UserId], [PermissionId], [Rights])
VALUES
    (1, 10, 1),
    (1, 11, 2),
    (1, 12, 3),
    (2, 11, 2),
    (2, 12, 3),
    (3, 10, 2)
; 
```

**静态枢轴：**

```
select *
from
(
  select userid,
    username,
    value,
    col + '_'+ cast(rn as varchar(10)) col
  from
  (
    select u.userid,
      u.username,
      p.permissionid,
      p.rights,
      row_number() over(partition by u.userid 
                        order by p.permissionid, p.rights) rn
    from table_user u
    left join Table_UserPermissions p
      on u.userid = p.userid
  ) src
  unpivot
  (
    value
    for col in (permissionid, rights)
  ) unpiv
) src
pivot
(
  max(value)
  for col in (permissionid_1, rights_1, 
              permissionid_2, rights_2, 
              permissionid_3, rights_3)
) piv
order by userid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/b2b95/6)

**动态枢轴：**

如果您有未知数量的`permissionid`s 和`rights`，那么您可以使用动态 sql：

```
DECLARE 
    @query  AS NVARCHAR(MAX),
    @colsPivot as  NVARCHAR(MAX)

select @colsPivot = STUFF((SELECT  ',' 
                      + quotename(c.name +'_'+ cast(t.rn as varchar(10)))
                    from
                    (
                      select row_number() over(partition by u.userid 
                                order by p.permissionid, p.rights) rn
                      from table_user u
                      left join Table_UserPermissions p
                        on u.userid = p.userid
                    ) t
                    cross apply sys.columns as C
                   where C.object_id = object_id('Table_UserPermissions') and
                         C.name not in ('UserId')
                   group by c.name, t.rn
                   order by t.rn
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query 
  = 'select *
     from
     (
       select userid,
         username,
         value,
         col + ''_''+ cast(rn as varchar(10)) col
       from
       (
         select u.userid,
           u.username,
           p.permissionid,
           p.rights,
           row_number() over(partition by u.userid 
                             order by p.permissionid, p.rights) rn
         from table_user u
         left join Table_UserPermissions p
           on u.userid = p.userid
       ) src
       unpivot
       (
         value
         for col in (permissionid, rights)
       ) unpiv
     ) x1
     pivot
     (
       max(value)
       for col in ('+ @colspivot +')
     ) p
     order by userid'

exec(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/b2b95/15)

两者的结果是：

```
| USERID | USERNAME | PERMISSIONID_1 | RIGHTS_1 | PERMISSIONID_2 | RIGHTS_2 | PERMISSIONID_3 | RIGHTS_3 |
---------------------------------------------------------------------------------------------------------
|      1 |     John |             10 |        1 |             11 |        2 |             12 |        3 |
|      2 |      Joe |             11 |        2 |             12 |        3 |         (null) |   (null) |
|      3 |    James |             10 |        2 |         (null) |   (null) |         (null) |   (null) | 
```

# asp.net - 在 ASP.NET AJAX ReorderList 中对 DragHandleTemplate 的编程访问

> ID：299433
> 
> 赞同：0
> 
> 时间：2008-11-18T17:15:20.183
> 
> 标签：asp.net, ajaxcontroltoolkit, reorderlist

有没有办法以编程方式访问 ReorderList 的 DragHandleTemplate（ASP.NET AJAX 控件工具包）......特别是在 ReorderList 的 ItemDataBound 期间，以便在每个项目级别更改其外观？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-29T17:40:01.673

您还可以在 LINQ 中表达 FindControlRecursive：

```
 private Control FindControlRecursive(Control root, string id)
        {
            return root.ID == id
                       ? root
                       : (root.Controls.Cast<Control>().Select(c => FindControlRecursive(c, id)))
                             .FirstOrDefault(t => t != null);
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T10:12:51.857

不幸的是，没有办法从 ReorderListItem 获取拖拽器。相反，您可以在 DragHandleTemplate（例如 PlaceHolder）中创建一个服务器控件，然后在您的 ItemDataBound 事件处理程序中找到它：

在 aspx 文件中：

```
<DragHandleTemplate>
  <div class="dragHandle">
    <asp:Label ID="lblDragHandle" runat="server" />
  </div>
</DragHandleTemplate> 
```

在 aspx.cs 文件中：

```
protected void ReorderList1_ItemDataBound(object sender, AjaxControlToolkit.ReorderListItemEventArgs e)
{
   Label lblDragHandle = (Label)FindControlRecursive(e.Item, "lblDragHandle");
   lblDragHandle.Text = e.Item.ItemIndex.ToString();
}

private Control FindControlRecursive(Control root, string id)
{
   if (root.ID == id)
   {
      return root;
   }

   foreach (Control c in root.Controls)
   {
      Control t = FindControlRecursive(c, id);
      if (t != null)
      {
         return t;
      }
   }

   return null;
} 
```

我从 Jeff 的博客中复制了[FindControlRecursive方法。](https://blog.codinghorror.com/recursive-pagefindcontrol/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T15:33:59.650

您不能**在服务器上以**编程方式访问 DragHandleTemplate ，但如果您创建具有唯一 ID（每行）的周围元素，您应该能够使用 CSS 选择器或 Javascript 仅更改某些项目。

# visual-studio - Visual Studio - 管理许多打开文件的工作的技巧

> ID：299437
> 
> 赞同：29
> 
> 时间：2008-11-18T17:17:10.307
> 
> 标签：visual-studio, tabs

您对 VS 让您寻找几分钟前打开的标签页时使用的标签页有何感想？不断拖动标签以使您使用的标签保持在一起怎么样？

哦，所以你也认为*AARGH*？然后继续阅读。

我在一个包含数十个项目和数百个文件的软件上工作。填满标签栏真的很容易——比如在调试时，它可以打开很多文件，其中大部分只是样板文件，或者对手头的任务并不感兴趣。这使得与“脱落”选项卡栏*相关*
的少数文件，或者通过浏览可见选项卡很难找到。

 *有一些解决方案，其中一些比其他解决方案更广为人知。这是我的前 3 名：

**三、**如果您能**准确**记住文件名（或至少是第一个字母），则此方法有效：使用“查找框”：

```
type: Ctrl-D >of yourFileName 
```

当您键入文件名时，您会自动完成解决方案中的文件名。更多细节[在这里](http://www.alteridem.net/2007/09/11/quickly-findopen-a-file-in-visual-studio/)。

**二、**最明显的一个：使用按字母顺序排列的选项卡栏右侧的“活动文件”下拉菜单。
鲜为人知的事实：使用**`Ctrl-Alt-DownArrow`**打开该下拉菜单，然后开始输入文件名。您将获得可视化可用选项的额外好处。[[从这里](http://www.chinhdo.com/20070920/top-11-visual-studio-2005-ide-tips-and-tricks-to-make-you-a-more-productive-developer/)无耻地窃取信息]

**I.** `<drum roll/>`这是我个人最喜欢的一个，它基于 VS 2005/2008 的一个未记录的特性。激活后，它会做一件简单的事情：单击选项卡会将其移动到窗口的最左侧。这个基本操作通常可以让我在前 3 到 5 个标签中找到我正在寻找的标签。它是这样的：

*删除了死 ImageShack 链接 - 示例动画*

为了启用此功能，您必须亲自操作 Windows 注册表。
强制编辑注册表自行承担风险警告：
*编辑注册表可能会使您的网卡将数据包丢弃在地板上。你被警告了。*

将此键添加到 VS 2005 的注册表中：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\8.0]
"UseMRUDocOrdering"=dword:00000001 
```

或者对于 VS 2008：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\9.0]
"UseMRUDocOrdering"=dword:00000001 
```

您甚至不必重新启动 VS 即可看到它的工作！[[从这里](http://blogs.msdn.com/msbuild/archive/2007/04/13/window-tab-management-in-visual-studio.aspx)抄袭]
现在继续，试一试！

**更新：** 这个技巧不再适用于 VS2010 Pro :(

* * *

这结束了我的部分。现在轮到你分享你如何处理标签搜索了！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-24T18:49:20.820

您可以使用VS 的[Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef)扩展。

安装后，转到工具 -> 选项 -> 生产力工具 -> 文档选项卡 -> 常规 -> 然后选中“垂直显示选项卡”。

这将为您提供左侧打开文件的列表。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-19T01:56:22.597

按住 Ctrl，按 Tab，然后按住 Ctrl。现在您可以使用箭头键选择任何打开的文件（右列）或工具窗口（左列）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-18T21:10:10.740

ReSharper 及其最近的文件功能对我来说效果更好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-18T17:30:10.933

我主要使用`Ctrl`-`TAB`来循环浏览我最近处理的选项卡。我似乎可以不用这种方式来管理一堆 4 或 5 个文件。`Ctrl`如果文件不在堆栈中，那么我通常会使用-再次重新打开它`O`。

或者，如果我想要的文件与我正在查看的一段代码有关，那么突出显示该文件中定义的变量、方法等并点击`F12`有效。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-24T10:36:56.227

我专门为此目的为 Visual Studio 创建了[Tabs Studio](http://www.tabsstudio.com)加载项 - 以便轻松处理大量打开的文件。Tabs Studio 插件提供多行选项卡和选项卡分组。

有关详细信息，请参阅[Tabs Studio 主页](http://www.tabsstudio.com)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-18T19:22:51.347

我的公司使用[Visual Assist X](http://www.wholetomato.com/)。这在 Visual Studio 中提供了许多出色的功能，首先是更好的“智能感知”功能。但是，它还有一个“在解决方案中打开文件”对话框，允许我键入我正在查找的文件的子字符串并相应地过滤列表。我向所有使用 Visual Studio 的开发人员强烈推荐这个软件。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-04-21T12:05:14.373

我遇到了这里描述的相同问题，所以我创建了一个 Visual Studio 插件来管理“会话”中的打开文档，它是免费且开源的，您可以在[此处找到有关 codeplex 项目的更多信息](http://dsmaddin.codeplex.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T19:16:12.047

Control-Tab 和“>of”技巧都很有用。但是，它们都不适合我，尤其是当我有很多打开的文件或者我想要更快地访问时。

我喜欢免费的[DPack](http://www.usysware.com/dpack/)工具集。里面有很多简洁的东西，其中一些是内置于更新版本的 VS 中的。不过，我还没有见过像文件浏览器这样的东西。它用作工具窗口（或对话框，如果您愿意），并为您提供解决方案中文件的增量过滤列表。如果您将列表用作模式对话框，您可以将列表限制为打开文件，显然，尽管我没有尝试过。

[![USWare 文件浏览器](https://i.stack.imgur.com/INaVo.png)](https://i.stack.imgur.com/INaVo.png)
[（来源：[ussysware.com](http://www.usysware.com/dpack/images/FileBrowser2.png)）]

# .net - .NET Guard 类库？

> ID：299439
> 
> 赞同：18
> 
> 时间：2008-11-18T17:17:17.247
> 
> 标签：.net, code-contracts

我正在寻找提供保护方法（例如检查空参数）的库或源代码。显然，这很容易构建，但我想知道是否已经有任何 .NET 可用。一个基本的谷歌搜索并没有透露太多信息。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-08-14T10:16:27.500

有[CutEdge.Conditions](http://conditions.codeplex.com/)。页面中的使用示例：

```
public ICollection GetData(Nullable<int> id, string xml, ICollection col)
{
    // Check all preconditions:
    id.Requires("id")
        .IsNotNull()          // throws ArgumentNullException on failure
        .IsInRange(1, 999)    // ArgumentOutOfRangeException on failure
        .IsNotEqualTo(128);   // throws ArgumentException on failure

    xml.Requires("xml")
        .StartsWith("<data>") // throws ArgumentException on failure
        .EndsWith("</data>"); // throws ArgumentException on failure

    col.Requires("col")
        .IsNotNull()          // throws ArgumentNullException on failure
        .IsEmpty();           // throws ArgumentException on failure

    // Do some work

    // Example: Call a method that should not return null
    object result = BuildResults(xml, col);

    // Check all postconditions:
    result.Ensures("result")
        .IsOfType(typeof(ICollection)); // throws PostconditionException on failure

    return (ICollection)result;
} 
```

另一种不错的方法，未打包在库中，但很容易[在 Paint.Net 博客上](http://blog.getpaint.net/2008/12/06/a-fluent-approach-to-c-parameter-validation/)：

```
public static void Copy<T>(T[] dst, long dstOffset, T[] src, long srcOffset, long length)
{
    Validate.Begin()
            .IsNotNull(dst, "dst")
            .IsNotNull(src, "src")
            .Check()
            .IsPositive(length)
            .IsIndexInRange(dst, dstOffset, "dstOffset")
            .IsIndexInRange(dst, dstOffset + length, "dstOffset + length")
            .IsIndexInRange(src, srcOffset, "srcOffset")
            .IsIndexInRange(src, srcOffset + length, "srcOffset + length")
            .Check();

    for (int di = dstOffset; di < dstOffset + length; ++di)
        dst[di] = src[di - dstOffset + srcOffset];
} 
```

[我在我的项目](http://code.google.com/p/functional-dotnet/)中使用它，你可以从那里借用代码。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-18T17:24:36.670

鉴于 Microsoft 的[代码合同](http://research.microsoft.com/contracts)与 .NET 4.0 一起出现，如果可能的话，我会尝试找到一个最兼容的 - 如果没有，请自己编写。这样，当您（最终）升级到 .NET 4.0 时，迁移会更容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T17:25:53.207

您可以使用多种方法。

我最喜欢的是使用面向方面的编程。查看 PostSharp。

您还可以查看 Spec#，它是 C# 的扩展

在 4.0 中，您将拥有一个功能齐全的合约库。

最后，我的一位同事提出了一个非常有用的保护库： [http ://blueonionsoftware.com/blog.aspx?p=ca49cb62-7ea2-43c5-96aa-91d11774fb48](http://blueonionsoftware.com/blog.aspx?p=ca49cb62-7ea2-43c5-96aa-91d11774fb48)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T17:26:57.557

我不知道任何商业上可用的。模式和实践企业库中对这种类型的代码有一些支持。CodePlex 上似乎也有很多开源项目（在不同程度上）这样做：http: [//www.codeplex.com/Project/ProjectDirectory.aspx](http://www.codeplex.com/Project/ProjectDirectory.aspx?ProjectSearchText=validation) ?ProjectSearchText=validation 。

大多数情况下，这些类型的库最终都是自定义编写的，并保留在使用它们的公司内部。

.NET 4.0 支持使用基于 Spec# 的[Code Contracts](http://research.microsoft.com/contracts)来提供执行此操作的机制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-14T06:32:48.853

我最近写了一篇关于警卫类的帖子（也没有找到任何信息）：[http ://ajdotnet.wordpress.com/2009/08/01/posting-guards-guard-classes-explained/](http://ajdotnet.wordpress.com/2009/08/01/posting-guards-guard-classes-explained/)

我还发布了相应的 Guard 类实现（随意使用此代码，或根据您的需要进行调整）：ajdotnet.wordpress.com/guard-class/

关于 .NET 4.0（Spec# 的继承者）中 Guard 类和 Code Contract 之间的关系，请查看以下帖子：www.leading-edge-dev.de/?p=438

（对不起，碎片链接，该网站只允许一个链接......）

嗨，AJ.NET

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-31T12:40:39.350

安装 netfx-guard nuget 包。您还可以获得 notnull 和 notempty 的代码片段，它的执行速度与您的手动检查一样快

# c# - 构造函数没有出现在我的 WCF 客户端中，序列化问题？

> ID：299441
> 
> 赞同：4
> 
> 时间：2008-11-18T17:17:50.367
> 
> 标签：c#, wcf, serialization

我的 WCF 服务中有一个简单的类，对于访问我的 WCF 的客户端似乎没有正确显示。

我的班级有 4 个字符串类型的公共属性。

我用 [DataContract()] 标记了该类，并用 [DataMember] 标记了每个成员。

为什么我的构造函数不可见？构造函数是否有特殊的[属性]？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-18T17:22:52.167

数据契约与构造函数没有任何关系。因此，当您在客户端上创建代理时，您只会得到一个实现数据协定的类。

如果要在客户端添加类似的构造函数（假设生成的类型名为 SomeDataItem），可以使用分部类添加：

```
public partial class SomeDataItem
{
    public SomeDataItem(int a, int b)
    {
        A = a;
        B = b;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-04T16:10:32.037

同意您可以将部分类添加到 WCF 客户端应用程序 - 您还可以将 [OnDeserializing] 和 [OnDeserialized] 方法添加到服务器端类以处理初始化等。

当我在搜索如何解决这个问题时发现了以下很好的例子——在 [http://social.msdn.microsoft.com/forums/en-US/wcf/thread/447149d5-b44c-47cd-a690-20928244b52b /](http://social.msdn.microsoft.com/forums/en-US/wcf/thread/447149d5-b44c-47cd-a690-20928244b52b/)

```
[DataContract]
public class MyClassWithSpecialInitialization
{
    List<string> myList;
    string str1;
    [DataMember]
    public string Str1
    {
        get { return str1; }
        set
        {
            this.myList.Add(value);
            str1 = value;
        }
    }
    string str2;
    [DataMember]
    public string Str2
    {
        get { return str2; }
        set
        {
            this.myList.Add(value);
            str2 = value;
        }
    }
    public MyClassWithSpecialInitialization()
    {
        this.myList = new List<string>();
    }
    [OnDeserializing]
    public void OnDeserializing(StreamingContext context)
    {
        Console.WriteLine("Before deserializing the fields");
        this.myList = new List<string>();
    }
    [OnDeserialized]
    public void OnDeserialized(StreamingContext context)
    {
        Console.WriteLine("After deserializing the fields... myList should be populated with the values of str1 and str2");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T17:32:32.193

您如何生成客户端代码：VS 添加服务参考，SVCUTIL？您使用什么参数/设置？您是否查看过客户端代码以查看实际创建的内容？

您的班级是否在服务中被正确使用？我有一个问题，我创建了一个公开的数据协定类，但没有在服务方法中使用它，因此该类没有导出到客户端代码中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T17:22:35.177

将类标记为数据协定时不需要括号。你能提供你班级的代码示例吗？

# php - 我应该扩展这个类还是只使用它？

> ID：299444
> 
> 赞同：2
> 
> 时间：2008-11-18T17:18:40.723
> 
> 标签：php, oop, inheritance

我正在为 PHP 中的一个大型项目编写帮助程序类，并且我编写了一个名为`Command`. 它本质上是一个以受控方式从 PHP 运行系统命令的 OOP 包装器。它具有`addOption()`添加 -a 类型选项和`addArgument()`添加其他参数等方法。

我需要对周围的文件进行大量的 scp'ing，所以我会经常使用 Command 类。对 scp 的调用非常具体，因为我每次都需要使用某些选项。

扩展这个类并创建一个类有意义`ScpCommand`吗？`Command`它似乎有一个“是”的关系，但它实际上与每次都有特定选项的类是一样的。我真的不认为我需要覆盖除构造函数之外的任何方法。我可能只会添加类变量。这真的只是一种方便。

这里最有意义的是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T17:33:02.100

如果只是配置，为什么不考虑在为您进行样板配置后返回命令的工厂？

```
function getScpCommand($???) 
{
    $Command = new Command();
    $Command->addOption(/* scp specific this */);
    $Command->addArgument(/* scp specific that */);
    /* etc */
    $Command->addOption(/* handle your getScpCommand parameters here */)

    return $Command;
} 
```

# python - 如何使用 Python 将目录更改回原来的工作目录？

> ID：299446
> 
> 赞同：31
> 
> 时间：2008-11-18T17:19:47.680
> 
> 标签：python

我有一个类似于下面的功能。我不确定如何在 jar 执行结束时使用 os 模块返回到我原来的工作目录。

```
def run(): 
    owd = os.getcwd()
    #first change dir to build_dir path
    os.chdir(testDir)
    #run jar from test directory
    os.system(cmd)
    #change dir back to original working directory (owd) 
```

注意：我认为我的代码格式已关闭 - 不知道为什么。我提前道歉

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2016-06-23T16:00:24.433

上下文管理器是非常适合这项工作的工具：

```
from contextlib import contextmanager

@contextmanager
def cwd(path):
    oldpwd=os.getcwd()
    os.chdir(path)
    try:
        yield
    finally:
        os.chdir(oldpwd) 
```

...用作：

```
os.chdir('/tmp') # for testing purposes, be in a known directory
print 'before context manager: %s' % os.getcwd()
with cwd('/'):
    # code inside this block, and only inside this block, is in the new directory
    print 'inside context manager: %s' % os.getcwd()
print 'after context manager: %s' % os.getcwd() 
```

...这将产生类似的东西：

```
before context manager: /tmp
inside context manager: /
after context manager: /tmp 
```

这实际上**优于**内置的`cd -`shell，因为它还负责在由于抛出异常而退出块时更改目录。

* * *

对于您的特定用例，这将是：

```
with cwd(testDir):
    os.system(cmd) 
```

* * *

另一个要考虑的选项是使用`subprocess.call()`而不是`os.system()`，它可以让您指定要运行的命令的工作目录：

```
# note: better to modify this to not need shell=True if possible
subprocess.call(cmd, cwd=testDir, shell=True) 
```

...这将阻止您根本不需要更改解释器的目录。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-18T17:24:48.497

您只需添加以下行：

```
os.chdir(owd) 
```

请注意，这也在您的其他[问题](http://stackoverflow.com/questions/299249/how-can-i-get-my-python-version-25-script-to-run-a-jar-file-inside-a-folder-ins)中得到了回答。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-18T21:34:16.307

使用建议`os.chdir(owd)`很好。将需要更改目录的代码放在一个`try:finally`块中（或在 python 2.6 及更高版本中，一个块）是明智的。这样可以降低在更改回原始目录之前`with:`意外将 a 放入代码中的风险。`return`

```
def run(): 
    owd = os.getcwd()
    try:
        #first change dir to build_dir path
        os.chdir(testDir)
        #run jar from test directory
        os.system(cmd)
    finally:
        #change dir back to original working directory (owd)
        os.chdir(owd) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-10-30T12:50:42.043

对于这种情况（执行系统命令），上下文管理器是多余的。最好的解决方案是改用`subprocess`模块（Python 2.4 及更高版本）和带有参数的`run`or`popen`方法。`cwd`

因此，您的代码可以替换为：

```
def run(): 
    #run jar from test directory
    subprocess.run(cmd, cwd=testDir) 
```

请参阅[https://bugs.python.org/issue25625](https://bugs.python.org/issue25625)和[https://docs.python.org/3/library/subprocess.html#subprocess-replacements](https://docs.python.org/3/library/subprocess.html#subprocess-replacements)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-18T17:25:20.990

os.chdir(owd) 应该可以解决问题（就像您在更改为 testDir 时所做的那样）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-11T11:05:26.663

Python 区分大小写，因此在键入路径时请确保它与您要设置的目录相同。

```
import os

os.getcwd()

os.chdir('C:\\') 
```

# html - 使用 CSS 进行布局和格式化的屏幕抓取页面...如何抓取适用于 html 的 CSS？

> ID：299448
> 
> 赞同：7
> 
> 时间：2008-11-18T17:20:11.250
> 
> 标签：html, css, screen-scraping, firebug

我正在开发一个应用程序，用于对外部网页的一小部分（不是整个页面，只是其中的一小部分）进行屏幕抓取。

所以我的代码可以完美地抓取 html，但我的问题是我不仅想抓取原始 html，还想抓取用于格式化我正在提取的页面部分的 CSS 样式，所以我可以显示在新页面的原始格式完好无损。

如果您熟悉 firebug，它能够显示哪些 CSS 样式适用于您突出显示的页面的特定子集，所以如果我能找到一种方法来做到这一点，那么我可以在显示时使用这些样式我的新页面上的内容。但我不知道如何做到这一点............

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-01-05T03:41:24.303

今天，我需要在 Facebook 应用程序的应用程序构建器中抓取 Facebook 共享对话框，用作动态预览示例。我采用了 Firebug 1.5 代码库并添加了一个新的上下文菜单选项“使用内联样式复制 HTML”。我已经从 lib.js 复制了他们的 getElementHTML 函数并对其进行了修改以执行此操作：

*   删除类、id 和样式属性
*   删除 onclick 和类似的 javascript 处理程序
*   删除所有 data-something 属性
*   删除显式href并将其替换为“#”
*   用 div 替换所有块级元素，用 span 替换内联元素（以防止在目标页面上继承样式）
*   绝对化相对 url
*   将所有应用的非默认 CSS 属性内联到全新的样式属性中
*   通过遍历 DOM 树考虑样式父/子继承来减少内联样式膨胀
*   缩进输出

它适用于更简单的页面，但由于 Firebug（或 Firefox？）中的错误，该解决方案并非 100% 健壮。但是，当由可以调试和修复所有怪癖的 Web 开发人员操作时，它绝对是可用的。

**到目前为止我发现的问题：**

*   有时不会发出清除 css 属性（它严重破坏了布局）
*   :hover 和其他伪类无法以这种方式捕获
*   firefox 仅在其模型中保留 mozilla 特定的 css 属性/值，因此例如您丢失 -webkit-border-radius，因为 CSS 解析器跳过了它

无论如何，这个解决方案节省了我很多时间。最初我是手动选择他们的样式表并进行手动选择和后处理。它缓慢、无聊并且污染了我们的类命名空间。现在我可以在几分钟而不是几小时内抓取 facebook 标记，并且导出的标记不会干扰页面的其余部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T17:36:55.150

下面是一个好的开始：通过您计划提取的 HTML 补丁，将每个元素（及其 ID/类/内联样式）收集到一个数组中。立即从页面的样式表中获取这些元素 ID 和类的样式。

然后，从目标补丁中最外层的元素开始，以类似的方式遍历 DOM 中的其余元素，最终一直到 body 和 HTML 元素，与您的初始数组和收集未在目标补丁中声明的任何样式或其应用的样式。

您还需要检查任何 * 声明并抓住它们。然后，确保在将样式重新应用到最终输出时，按照正确的顺序执行此操作，因为您从 DOM 层次结构中从低到高收集它们，并且需要从高到低重新应用它们.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T18:02:45.517

一个快速的技巧是拉下他们的 CSS 文件并将其应用于您用来显示数据的页面。为了避免任何干扰，您可以将页面加载到 IFrame 中，无论您需要在哪里显示它。当然，我不得不质疑这段代码的意图。您是否可以重新发布您正在抓取的信息？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-18T18:12:26.903

如果您有任何方法来确定“计算样式”，那么您可以有效地丢弃样式表，并且****gasp****，使用所有计算样式的属性应用内联样式。

但我不推荐这个。会很臃肿。

# .net - 如何最好地实现脏话处理程序（.NET 首选）？

> ID：299450
> 
> 赞同：1
> 
> 时间：2008-11-18T17:21:21.607
> 
> 标签：.net, asp.net, spell-checking

对于 ASP.NET 应用程序，自定义脏话删除器/替换器的最佳实践实现方法是什么？

如果这是一个数据表解决方案，是否有免费资源来获取数据？（类似于查找可以导入系统进行拼写检查的公共字典表）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-18T17:24:02.227

[淫秽过滤器：坏主意，还是令人难以置信的相互交流的坏主意？](https://blog.codinghorror.com/obscenity-filters-bad-idea-or-incredibly-intercoursing-bad-idea/ "淫秽过滤器：坏主意，还是令人难以置信的相互交流的坏主意？")^_^

另请参阅[如何实现良好的亵渎过滤器？](https://stackoverflow.com/questions/273516/how-do-you-implement-a-good-profanity-filter "你如何实现一个好的亵渎过滤器？").

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-18T17:42:31.003

获胜的唯一方法就是不玩。

考虑以下句子：

“爱德华二世是少数几个生下有记录的私生子的君主之一。”

混蛋是一个边界线的脏话，但在这种情况下，它是一个完全合理的术语。

还要考虑：

*   “熔渣从坩埚中掉了出来。”
*   “母狗嗅了另一只狗的屁股。”

您将永远无法构建能够确定用法是否正确的解析器。即使你决定继续前进，只是说出这些话，它们也很容易被颠覆。

扪心自问，“Tw*t”真的比“twat”没有那么令人反感吗？每个人都知道你指的是什么词，每个人都明白它的意思。

归根结底，这个问题的解决方案不是技术性的。真的，您想使用某种人类主持人来摆脱发誓的人。人类温和派拥有算法永远不会具备的能力：它可以进行判断。使用这种判断比用计算机科学解决问题要有用得多。

在此问题的其他答案中详细讨论了这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T18:32:08.017

好吧，我们 (*) 所做的是创建一个两层的“坏词”列表（使用正则表达式希望能捕捉到一些变化）。使用第 1 层单词会给您一个警告，指出您违反了服务条款，并且在您修复它之前无法保存该消息。如果您使用第 2 层词，则会发布消息，但会自动提出反对意见。所有带有异议标记的消息（系统或用户生成的）都由人工审核，以确定它是留下还是消失。

(*) “我们”是一家大型、稳重的实体连锁店的电子商务部门，该连锁店刚刚开始允许用户在其网站上生成内容。

# javascript - 用于 Javascript 的有效 Json 库？

> ID：299461
> 
> 赞同：1
> 
> 时间：2008-11-18T17:24:38.527
> 
> 标签：javascript, json

我去了[http://www.json.org/js.html](http://www.json.org/js.html)并下载了 json2.js，我想我会没事的，毕竟该网站在谷歌搜索“json javascript”中排名第一——他们也有这个非常酷的网址:)

所以我一直在使用它，它看起来很好，但现在我开始遇到麻烦 - 它根本不会解析我用 Newtonsoft 的 JSON .NET 序列化程序编码的某些东西。好吧，也许.net seralizer 搞砸了？不是我看到的 - 它产生一个看起来像完美 json 的精细 javascript 字符串。

当它必须对单引号 ' 和双引号 " 进行编码时，问题就来了。看看这些示例（仅部分完整字符串）

```
{"Id":10651,"Text":"\'69"}
{"Id":184,"Text":"13\""} 
```

我错过了什么吗？它是一个更大字符串的一部分，并且都放在一个像这样的 javascript 变量中

```
var jsonObject = '[{"Id":46,"Type":2,..................... 
```

我认为它必须转义字符串中的单引号以避免与我在单引号中的字符串换行冲突，并转义双引号以避免与 json 格式冲突？

所以要么我做错了，要么 json2.js 做错了？或者是的，也许 .net json 搞砸了——我有点想我搞砸了，但我一直在尝试做各种事情来帮助解析，比如在序列化/转义之前进行转义/取消转义等。反序列化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T17:35:37.193

这可能是导...

[http://binnyva.blogspot.com/2006/10/invalid-json.html](http://binnyva.blogspot.com/2006/10/invalid-json.html)

如果你正在序列化，也许可以通过序列化来保护`&apos;`自己`&apos;`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T18:10:18.343

好的，我解决了这个问题。实际上，乔尔在对我的问题的评论中给我的提示是尝试评估它，而不是让我认为我可以信任我正在尝试解析/评估的这个 json，并且因为我在构建页面时就知道它，为什么不要将其作为对象硬编码到网页中 - 不会转义引号或任何东西，也不会评估，最重要的是 - 没有字符串：P

所以感谢你乔尔和你的文章:)

# documentation - 面向小型组织的基于 Web 的文档共享

> ID：299465
> 
> 赞同：3
> 
> 时间：2008-11-18T17:25:28.150
> 
> 标签：documentation, salesforce

过去，我使用 nexo.com 与一家小型初创公司的销售、营销、公关和技术人员共享文档。但我想知道是否有更好的解决方案让不同类型的地理分散的工作人员访问各种上传的文档。我不想自己构建或托管它，免费或便宜总是好的。

我阅读了有关 Confluence 的信息，但它似乎超出了我的需要。我只是想要云中的访问控制文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T17:34:36.917

我自己还没有使用过这个，但我听说过关于它的好消息[google docs](http://docs.google.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-10T06:13:18.277

我们为此使用[s3fm](http://www.s3fm.com/)。这是一个免费的解决方案，但需要一个 Amazon S3 帐户。因为我们有一个满足我们的托管需求，所以这是一个明显的选择。但鉴于 Amazon S3 的最低定价，我认为为此考虑开放一个可能是有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T17:41:16.823

喜欢 Dropbox ！！！不过，我还没有用它来设置很多组访问权限。

听起来[Google 协作平台](http://www.google.com/sites/help/intl/en/overview.html)会对您有很大帮助。您可以建立一个由不同网站组成的网络——一个用于销售，另一个用于营销，另一个用于 PR——并将您的文件上传到它们。您可以确定谁可以访问每个站点以及每个内容页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-21T15:16:28.053

以防其他人检查此问题：使用 filesanywhere.com 结束 - 具有我正在寻找的确切功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T17:27:44.853

我们使用以下组合：

*   背包
*   SVN
*   丛林磁盘

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T17:27:55.667

看看[Dropbox](https://www.getdropbox.com/home)。

访问控制有些有限，但对我来说效果很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T17:40:05.673

不幸的是，我正在为客户编写这样的应用程序。我可以推荐的最好的方法是使用现有的基于 Web 的文件管理器并添加权限功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T17:45:12.043

有一个非常大的免责声明，我将其作为我的日常工作：

如果您正在寻找有关这些文档的反馈[Backboard](http://www.getbackboard.com)为您提供基于 Web 的查看和协作，无需任何软件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-10T06:24:50.657

有一个名为 docpro 的产品。它允许您设置各种安全级别、路由方法等。它是一个基于 Web 的产品，您可以将其用于全球地理上分散的团队成员。但它不是免费的，但我认为很便宜。检查此链接

[http://www.omnexsystems.com/Faq/documentpro.html](http://www.omnexsystems.com/Faq/documentpro.html)

# etl - 对 Web 表单进行逆向工程

> ID：299474
> 
> 赞同：2
> 
> 时间：2008-11-18T17:30:19.733
> 
> 标签：etl

我有一个网站，我从中下载 2-3 MB 的原始数据，然后将其输入 ETL 流程以将其加载到我的数据集市中。不幸的是，数据提供者是美国农业部 (USDA)，他们不允许通过 FTP 下载。他们要求我使用网络表单来选择我想要的元素，点击 2-3 个屏幕并最终点击下载文件。我想自动化这个下载过程。我不是网络开发人员，但不知何故，我似乎应该能够使用一些工具来准确地告诉我从最终请求到服务器的 put/get/magic 是什么。如果我有一个工具说“将这些参数传递给这个 url 并等待响应”，那么我可以在 Perl 中组合一些东西来自动化这个过程。

我意识到，如果我解构他们的所有 5 个页面并阅读 JavaScript 包含的内容并将我的愈合点按 3 次，我可以从我可以访问的内容中获取此信息。但我想要一个更快、更直接的路径，不需要我手动解析他们所有的 JS。

重述最后一个问题：是否有工具或方法可以清楚地显示从 Web 表单发送的最终请求请求是什么以及它是如何构造的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T17:35:14.340

使用 Fiddler2 作为代理查看来回传递的内容。我在其他类似情况下成功地做到了这一点

主页在这里：[http ://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T17:35:26.493

篡改者最好的朋友（这些是 Firefox 扩展，你也可以使用类似[Wireshark](http://www.wireshark.org/)的东西）

[HTTPFox](https://addons.mozilla.org/en-US/firefox/addon/6647)

[篡改数据](https://addons.mozilla.org/en-US/firefox/addon/966)

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T01:32:59.010

与其他回复一样，除了我选择的工具是[查尔斯](http://www.charlesproxy.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T21:54:16.717

使用 Web 测试工具包，比如[Watir](http://wtr.rubyforge.org/)和 Ruby 怎么样？

易于填写表格..只需使用输出..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-26T22:21:23.823

使用[WatiN](http://watin.sourceforge.net/)并将其与 WatiN TestRecorder (Google for it) 结合使用

它可以“模拟”坐在浏览器前的用户输入您可以从您自己的 C# 代码中提供的值...

# encryption - 将 Rijndaelmanged() byte[] 转换为字符串

> ID：299475
> 
> 赞同：2
> 
> 时间：2008-11-18T17:30:53.100
> 
> 标签：encryption, aes, rijndaelmanaged

我想将 Rijndaemanaged() 加密值转换为字符串。

ToBase64String() 就足够了吗？它说它仅适用于 8 位数组，但 AES 是 128 位的，对吗？

**更新**

对于加密，我使用的代码来自[http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T17:37:50.840

Base64 通常是一个不错的方法。它相当有效，您通常无需担心编码问题，因为结果将是 ASCII。但是，如果您要在 URL 中使用结果，您可能应该小心——“正常”Base64 不是 url 安全的。（尽管有使用不同符号的替代编码。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T17:32:49.430

字节为字节 = 8 位。ToBase64String 将起作用。正如 Jon 所指出的，它在 url 或文件名中使用它有局限性。

您可以使用[它](http://www.codeproject.com/KB/recipes/hexencoding.aspx)来将其转换为十六进制字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T19:25:52.180

多年来，我们一直成功地在托管 Rijndael 的加密字节上使用 Convert.ToBase64String。

# .net - 通过互联网访问数据的最佳方式。ADO.Net 数据服务？

> ID：299477
> 
> 赞同：1
> 
> 时间：2008-11-18T17:32:07.483
> 
> 标签：.net, sql-server

这可能是一个新手问题，但请原谅我是 dot Net 世界的新手。

我必须制作一个连接到本地 SQL Server 数据库的桌面应用程序。但是，在某些情况下，相同的数据库将在可以通过 Internet 访问的服务器上运行。

设计这样一个程序的最佳方法是什么。基本上，该程序是数据输入表单的集合，我正在考虑将每个查询作为 Web 服务从服务器获取数据，然后将其作为 Web 服务返回。但是有没有更好的方法来解决这样的问题？我想在这两种情况下使用相同的程序，只需在配置文件中进行更改以告诉程序使用本地数据库或远程服务器上的数据库。由于我是新手，我不知道如何构建程序。我听说过一些关于 ADO.Net 数据服务的信息？这是解决这个问题的最佳方法吗？LLB Gen pro 适合哪里？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T18:45:35.820

我会亲自将这种逻辑构建到您的 DAL（数据访问层）中。无论是使用 ADO.Net 还是其他方式，这个概念都是一样的，因为您构建了一种灵活的方式来连接到远程数据库以及本地数据库，基于它是您的应用程序的要求这一事实。

在那之后，魔鬼就在细节中。您肯定会想看看微软偶尔连接的应用程序的链接，例如[这个链接。](http://msdn.microsoft.com/en-us/sync/bb887608.aspx)

另请查看有关使用 ADO.Net 构建 DAL 的[链接。](http://msdn.microsoft.com/en-us/magazine/cc188750.aspx)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T18:26:19.510

.NET Remoting 或 WCF 会更理想。WCF 将允许您使用不同的通道，无论是 Web 服务还是二进制数据格式。任何一种方法都是可配置的。Remoting 选项将允许您在本地或服务中运行相同的 API，尽管细节可能很棘手。一般来说，Web 服务更适合通过 Internet 工作的应用程序，因为可以配置或允许 HTTP 协议通过代理和防火墙。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T17:35:05.480

您可以使用 ADO.NET 通过 SqlConnection 对象使用连接字符串连接到数据库服务器的正常路线。只要确保“通过互联网连接”允许这种连接（除非你有一些讨厌的防火墙阻止它，否则它可能会）。

# active-directory - 如何在 Active Directory 中查询密码过期的用户？

> ID：299490
> 
> 赞同：4
> 
> 时间：2008-11-18T17:35:16.417
> 
> 标签：active-directory, ldap, dsquery

我需要在 Active Directory 中查询密码即将过期的用户列表。显而易见（且简单）的方法是：

```
dsquery user -stalepwd n 
```

问题是我需要添加额外的过滤器来只查找特定安全组中的用户。这对于具有内置 -stalepwd 选项的“dsquery user”语法来说很难做到，所以我一直在使用“dsquery * -filter”选项，它允许您使用 LDAP 查询语法。不幸的是，虽然通过 LDAP 查询应用其他过滤器相对容易，但我在过滤密码年龄大于 n 的用户时遇到了麻烦。

有谁知道使用“dsquery * -filter”方法而不是“dsquery user -stalepwd”方法过滤旧密码的语法（或者甚至可能）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T21:40:17.887

您可以通过比较用户对象上的 pwdLastSet 属性来编写比较“陈旧”密码的 LDAP 查询：

```
(&(objectClass=person)(objectClass=User)(pwdLastSet<=n)) 
```

ActiveDirectory 对此时间戳使用一种非常特殊的格式。我相信这是文件时间，但我会在网上仔细检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T21:15:54.270

有比 dsquery 更好的工具可以使用。

[来自joeware](http://www.joeware.net/freetools/tools/findexpacc/usage.htm)的 FindExpAcc 将执行与 stalepwd 相同的操作，并允许通过其 -f 开关进行过滤。

过滤器将如下所示：

```
&(objectCategory=user)(memberof=CN=User Group,OU=Test,DC=foo,dc=com) 
```

还可以查看[joeware](http://www.joeware.net/freetools/index.htm)的 adfind 和 admod 工具，它们比 Microsoft 的命令行查询工具更强大，但可能更难学习。

# java - 如何将图像添加到 JPanel？

> ID：299495
> 
> 赞同：357
> 
> 时间：2008-11-18T17:36:05.150
> 
> 标签：java, image, swing, jpanel

我有一个[JPanel](http://download.oracle.com/javase/1.4.2/docs/api/javax/swing/JPanel.html)，我想在其中添加即时生成的 JPEG 和 PNG 图像。

到目前为止，我在[Swing 教程](http://java.sun.com/docs/books/tutorial/uiswing/)中看到的所有示例，特别是在[Swing 示例](http://java.sun.com/docs/books/tutorial/uiswing/examples/components/)中都使用`ImageIcon`s。

我将这些图像生成为字节数组，它们通常比示例中使用的常见图标（640x480）大。

1.  使用 ImageIcon 类在 JPanel 中显示该大小的图像是否有任何（性能或其他）问题？
2.  *通常*的做法是什么？
3.  如何在不使用 ImageIcon 类的情况下将图像添加到 JPanel？

**编辑**：对教程和 API 的更仔细检查表明您不能将 ImageIcon 直接添加到 JPanel。相反，它们通过将图像设置为 JLabel 的图标来实现相同的效果。只是感觉不太对...

* * *

## 回答 #1

> 赞同：539
> 
> 时间：2010-04-25T00:46:40.017

如果您正在使用 JPanel，那么可能正在使用 Swing。试试这个：

```
BufferedImage myPicture = ImageIO.read(new File("path-to-file"));
JLabel picLabel = new JLabel(new ImageIcon(myPicture));
add(picLabel); 
```

该图像现在是一个摆动组件。它会像任何其他组件一样受到布局条件的影响。

* * *

## 回答 #2

> 赞同：259
> 
> 时间：2008-11-18T17:50:48.210

这是我的做法（有关如何加载图像的更多信息）：

```
import java.awt.Graphics;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.imageio.ImageIO;
import javax.swing.JPanel;

public class ImagePanel extends JPanel{

    private BufferedImage image;

    public ImagePanel() {
       try {                
          image = ImageIO.read(new File("image name and path"));
       } catch (IOException ex) {
            // handle exception...
       }
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawImage(image, 0, 0, this); // see javadoc for more info on the parameters            
    }

} 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2010-12-27T06:49:54.080

Fred Haslam 的方法很好用。我在文件路径上遇到了麻烦，因为我想在我的 jar 中引用一个图像。为此，我使用了：

```
BufferedImage wPic = ImageIO.read(this.getClass().getResource("snow.png"));
JLabel wIcon = new JLabel(new ImageIcon(wPic)); 
```

由于我只有有限数量（大约 10 个）需要使用此方法加载的图像，因此效果很好。它无需正确的相对文件路径即可获取文件。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-10-03T19:07:59.950

我认为没有必要对任何东西进行子类化。只需使用 Jlabel。您可以将图像设置为 Jlabel。因此，调整 Jlabel 的大小，然后用图像填充它。没关系。我就是这样做的。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-11-19T00:37:00.603

通过使用免费[SwingX](https://swingx.java.net//)库中的 JXImagePanel 类，您可以完全避免滚动您自己的 Component 子类。

[下载](http://java.net/projects/swingx/downloads)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-05-04T21:40:06.673

```
JLabel imgLabel = new JLabel(new ImageIcon("path_to_image.png")); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-18T17:48:00.947

您可以将 JPanel 子类化 - 这是我的 ImagePanel 的摘录，它将图像放置在 5 个位置中的任何一个位置：上/左、上/右、中/中、下/左或下/右：

```
protected void paintComponent(Graphics gc) {
    super.paintComponent(gc);

    Dimension                           cs=getSize();                           // component size

    gc=gc.create();
    gc.clipRect(insets.left,insets.top,(cs.width-insets.left-insets.right),(cs.height-insets.top-insets.bottom));
    if(mmImage!=null) { gc.drawImage(mmImage,(((cs.width-mmSize.width)/2)       +mmHrzShift),(((cs.height-mmSize.height)/2)        +mmVrtShift),null); }
    if(tlImage!=null) { gc.drawImage(tlImage,(insets.left                       +tlHrzShift),(insets.top                           +tlVrtShift),null); }
    if(trImage!=null) { gc.drawImage(trImage,(cs.width-insets.right-trSize.width+trHrzShift),(insets.top                           +trVrtShift),null); }
    if(blImage!=null) { gc.drawImage(blImage,(insets.left                       +blHrzShift),(cs.height-insets.bottom-blSize.height+blVrtShift),null); }
    if(brImage!=null) { gc.drawImage(brImage,(cs.width-insets.right-brSize.width+brHrzShift),(cs.height-insets.bottom-brSize.height+brVrtShift),null); }
    } 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-11-18T17:49:03.563

1.  不应该有任何问题（除了您在使用非常大的图像时可能遇到的任何一般问题）。
2.  如果您正在谈论将多个图像添加到单个面板，我会使用`ImageIcon`s. 对于单个图像，我会考虑制作一个自定义子类`JPanel`并覆盖其`paintComponent`绘制图像的方法。
3.  （见2）

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-11-18T18:21:05.323

`JPanel`子类几乎总是错误的类。你为什么不子类`JComponent`？

`ImageIcon`构造函数阻止读取图像有一个小问题。从应用程序 jar 加载时并不是真正的问题，但如果您可能正在通过网络连接进行读取，则可能会出现问题。即使在 JDK 演示中，也有很多 AWT 时代的使用示例和`MediaTracker`朋友。`ImageObserver`

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-11-18T18:28:11.940

我正在从事的私人项目中做一些非常相似的事情。到目前为止，我已经生成了高达 1024x1024 的图像，没有任何问题（内存除外），并且可以非常快速地显示它们并且没有任何性能问题。

覆盖 JPanel 子类的paint 方法是多余的，并且需要比您需要做的更多的工作。

我这样做的方式是：

```
Class MapIcon implements Icon {...} 
```

或者

```
Class MapIcon extends ImageIcon {...} 
```

您用于生成图像的代码将在此类中。我使用 BufferedImage 进行绘制，然后在调用 paintIcon() 时，使用 g.drawImvge(bufferedImage); 这减少了生成图像时完成的闪烁量，并且您可以对其进行线程化。

接下来我扩展 JLabel：

```
Class MapLabel extends Scrollable, MouseMotionListener {...} 
```

这是因为我想将图像放在滚动窗格上，即显示图像的一部分并让用户根据需要滚动。

然后我使用 JScrollPane 来保存 MapLabel，它只包含 MapIcon。

```
MapIcon map = new MapIcon (); 
MapLabel mapLabel = new MapLabel (map);
JScrollPane scrollPane = new JScrollPane();

scrollPane.getViewport ().add (mapLabel); 
```

但是对于您的场景（每次只显示整个图像）。您需要将 MapLabel 添加到顶部 JPanel，并确保将它们全部调整为图像的完整大小（通过覆盖 GetPreferredSize()）。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-09-30T17:10:45.693

这个答案是对@shawalli 答案的补充......

我也想在我的 jar 中引用一个图像，但我没有使用 BufferedImage，而是这样做了：

```
 JPanel jPanel = new JPanel();      
 jPanel.add(new JLabel(new ImageIcon(getClass().getClassLoader().getResource("resource/images/polygon.jpg")))); 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-04-18T05:02:53.293

在您的项目目录中创建一个源文件夹，在本例中，我将其命名为 Images。

```
JFrame snakeFrame = new JFrame();
snakeFrame.setBounds(100, 200, 800, 800);
snakeFrame.setVisible(true);
snakeFrame.add(new JLabel(new ImageIcon("Images/Snake.png")));
snakeFrame.pack(); 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-02-23T07:32:44.013

您可以避免使用自己`Component`的 s 和 SwingX 库和`ImageIO`类：

```
File f = new File("hello.jpg");
JLabel imgLabel = new JLabel(new ImageIcon(file.getName())); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-03-10T00:36:41.833

我可以看到很多答案，并没有真正解决 OP 的三个问题。

**1）**关于性能的一句话：除非您可以使用与您的显示适配器当前分辨率和颜色深度相匹配的精确像素字节顺序，否则字节数组可能效率不高。

To achieve the best drawing performance, simply convert your image to a BufferedImage which is generated with a type corresponding to your current graphics configuration. See createCompatibleImage at [https://docs.oracle.com/javase/tutorial/2d/images/drawonimage.html](https://docs.oracle.com/javase/tutorial/2d/images/drawonimage.html)

These images will be automatically cached on the display card memory after drawing a few times without any programming effort (this is standard in Swing since Java 6), and therefore the actual drawing will take negligible amount of time - *if* you did not change the image.

Altering the image will come with an additional memory transfer between main memory and GPU memory - which is slow. Avoid "redrawing" the image into a BufferedImage therefore, avoid doing getPixel and setPixel at all means.

例如，如果您正在开发一个游戏，而不是将所有游戏 actor 绘制到 BufferedImage 然后再绘制到 JPanel，将所有 actor 加载为较小的 BufferedImage 并在您的 JPanel 代码中一一绘制它们会快得多它们的正确位置 - 这样，除了用于缓存的图像的初始传输外，主内存和 GPU 内存之间没有额外的数据传输。

ImageIcon 将在后台使用 BufferedImage - 但基本上分配具有*正确*图形模式的 BufferedImage 是关键，并且没有努力做到这一点。

**2)**执行此操作的常用方法是在 JPanel 的重写 paintComponent 方法中绘制 BufferedImage。尽管 Java 支持大量额外的好东西，例如控制缓存在 GPU 内存中的 VolatileImages 的缓冲区链，但由于 Java 6 在不暴露 GPU 加速的所有这些细节的情况下做得相当好，因此不需要使用任何这些东西。

*请注意，GPU 加速可能不适用于某些操作，例如拉伸半透明图像。*

**3）**不要添加。就像上面提到的那样画它：

```
@Override
protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    g.drawImage(image, 0, 0, this); 
} 
```

如果图像是布局的一部分，则“添加”是有意义的。如果您需要它作为填充 JPanel 的背景或前景图像，只需在paintComponent 中绘制即可。如果您更喜欢制作一个可以显示图像的通用 Swing 组件，那么情况也是如此（您可以使用 JComponent 并覆盖其 paintComponent 方法） - 然后将其添加*到*您的 GUI 组件布局中。

**4)**如何将数组转换为 Bufferedimage

将字节数组转换为 PNG，然后加载它是非常耗费资源的。更好的方法是将现有的字节数组转换为 BufferedImage。

为此：*不要使用 for 循环*和复制像素。这是非常非常缓慢的。反而：

*   学习 BufferedImage 的首选字节结构（现在可以安全地假设 RGB 或 RGBA，即每个像素 4 个字节）
*   学习使用中的扫描线和扫描大小（例如，您可能有一个 142 像素宽的图像 - 但在现实生活中，它将存储为 256 像素宽的字节数组，因为它可以更快地处理它并通过 GPU 硬件屏蔽未使用的像素)
*   那么一旦你根据这些原则构建了一个数组，BufferedImage 的 setRGB 数组方法就可以将你的数组复制到 BufferedImage 中。

# c# - 在 IE 托管的 Windows 窗体控件中使用事件

> ID：299497
> 
> 赞同：1
> 
> 时间：2008-11-18T17:36:17.850
> 
> 标签：c#, .net, winforms, internet-explorer

我创建了一个在 Internet Explorer 中成功运行的 Windows 窗体控件。我想给它一个事件并能够通过 javascript 响应事件。[我在这里](http://msdn.microsoft.com/en-ca/magazine/cc301932.aspx)找到了一个讨论它的链接。它向我展示了如何创建接口，但我不确定如何从我的控件中触发事件？

这是我的代码片段：

```
//Control Code:
public class CardReader : Panel,ICardReaderEvents, ICardReaderProperties
{
   public void Error()
   {
   }
   public void Success()
   {
   }
}

//Interface for events
[Guid("DD0C202B-12B4-4457-9FC6-05F88A6E8BC5")]
[InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
public interface ICardReaderEvents
{
    [DispId(0x60020000)]
    void Error();

    [DispId(0x60020001)]
    void Success();
}

//Interface for public properties/methods
public interface ICardReaderProperties
{
     ...
}

//JavaScript to handle events
<SCRIPT FOR="CardReader1" EVENT="Error">
    window.status = "Error...";
</SCRIPT>

<SCRIPT FOR="CardReader1" EVENT="Success">
    window.alert("Success");
    window.status = "";
</SCRIPT> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T17:49:28.587

您在 CardReader 类中执行错误：

```
public event Error;
public event Success;

protected void OnError()
{
    if(Error != null)
        Error();
}

protected void OnSuccess()
{
    if(Success != null)
        Success();
} 
```

如果您的 ICardReaderEvents 接口更改为 Error 和 Success 带参数，则只需在 OnError 和 OnSuccess 中调用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T19:31:30.923

那么，现在您需要知道如何将其挂接到 Javascript 中吗？以下是我知道如何做到这一点：

```
<object id="CR" ...></object>

<script type="text/javascript">
  function CR::Error()
  {
    alert("Error!");
  }

  function CR::Success()
  {
    alert("Success");
  }
</script> 
```

# refactoring - 需要重构吗？

> ID：299501
> 
> 赞同：1
> 
> 时间：2008-11-18T17:37:06.723
> 
> 标签：refactoring

为什么公司应该投资重构组件，尽管它不会为产品添加任何新功能？

我同意它是清理代码、修复错误和删除死代码 - 但有什么办法呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-18T17:38:53.897

维护。它将显着降低您的维护成本。完全分解的代码与大多数公司存储库中的垃圾代码之间没有可比性。后者几乎一文不值，而前者是黄金。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T17:39:11.477

这取决于你问谁。非技术经理可能会说没有必要。支持开发人员会说这将有助于降低维护成本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T17:39:32.337

重构需要成为您日常工作的一部分。您不断重构代码以使其更具可读性/可维护性/健壮性/可重用性等。

你的代码是一个活的文档。如果它不随着时间的推移而改变，它就会变得停滞不前。

投资于测试。投资重构。投资于编写好的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T17:41:55.823

维护。有时，一个项目变得很大或有太多“快速”补丁需要进一步扩展。你只需要冷静地坐下来清理和重构。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T17:45:35.553

虽然其他答案都是正确的，但重构的力量在于它允许您以可预测的结果更改代码的设计。维护的最大问题是几乎不可能预测复杂应用程序的所有要求。

其中大部分可以通过添加新功能（如新报告或命令）来处理。但其他将需要重新设计您的应用程序的一部分。这就是重构及其兄弟单元测试发挥作用的地方。通过使用重构技术，您可以安全地进行所需的设计更改。

它不是万能的技术，而是另一种提高代码质量的工具。（结构化编程、面向对象等）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T17:39:53.300

首先：重构是一种税。如果代码有效，那么您正在花时间修复已经有效的代码，我可以看到现在看起来很奇怪的业务类型。我喜欢的一句话是“Legacy 是代码有效的代名词”。

现在，在您开始花更多时间维护开发功能的代码之前，需要解决不断增长的代码库的许多问题。

我个人喜欢“不破窗”的理念。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T17:40:09.260

如果它没有坏，就不要修理它。

但是，如果您需要开始使组件适应新的不可预测的需求，那么确定可以提取和重用的位通常是有意义的。您需要确定您的更改会引入意想不到的错误 - 因此您需要良好的测试覆盖率。

# oracle - 通过 cygwin sqlplus 连接到远程 oracle

> ID：299504
> 
> 赞同：2
> 
> 时间：2008-11-18T17:38:44.270
> 
> 标签：oracle, cygwin, sqlplus

我正在尝试使用 cygwin sqlplus 连接到位于 myserver.mycompany.com 端口 1530 的远程 oracle 安装。当我尝试

```
sqlplus username@myserver.mycompany.com:1530/orcl 
```

我得到错误：

```
ORA-12154: TNS:could not resolve the connect identifier specified 
```

当我设置`ORACLE_HOME`为 /`cygdrive/c/oracle/product/10.2.0/client_1`时，我得到一个不同的错误：

```
Error 6 initializing SQL*Plus
Message file sp1<lang>.msb not found
SP2-0750: You may need to set ORACLE_HOME to your Oracle software directory 
```

我可以telnet到服务器的1530端口，本地安装的SQL Developer也可以连接数据库。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T17:51:47.723

我不知道 Oracle 有一个本地 cygwin 客户端（如果我在这里错了，请纠正我，但我在 Oracle 的网站上也找不到任何提及）。如果您将 Cygwin 与 Windows 客户端一起使用，则需要使用本机 Windows 路径。它不会理解您的 /cygdrive 路径。

但是，我已经将 Win32 Oracle 客户端与 cygwin 一起使用并使其工作 - 相同的 shell 脚本可以在 Cygwin、Linux 和 Solaris 上工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T18:41:00.353

没有 cygwin Oracle 客户端。如上回答，使用设置为 windows 路径的 ORACLE_HOME。

对于您问题的前半部分，请尝试查看 TNS_NAMES 环境变量的设置，如果未设置，您可能需要尝试将其设置到正确的位置。通常它默认为 %ORACLE_HOME%/network/admin/tnsnames.ora 。SQL Developer 保留它自己的 tnsnames 文件副本，因此您无法回复该文件来解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-27T13:45:53.170

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T18:42:14.440

NXC 是对的——它不是我使用的 cygwin 客户端，而是 windows sqlplus 客户端。我设置了 windows 环境变量，`ORACLE_HOME`然后`ORACLE_SID`能够使用`net_service_name`from tnsnames.ora 在 cygwin bash shell 中运行 sqlplus。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-18T13:07:53.573

它对我有用的方式是删除`/cygdrive/d`或`/cygdrive/c`用`d:/`or替换它们，`c:/`然后您`sqlplus`在 cygwin 会话中的调用将起作用。令人`/cygdrive/DriveLetter`困惑。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-24T01:10:48.913

I have same error like you,

you should set not only `ORACLE_HOME` in windows Variables,

But also `PATH` include `%ORACLE_HOME%\bin`

then you can open windows cmd,

try `sqlplus username/password@your_define_tnsname`

if okay, then remove all `ORACLE PATH` setting in cygwin, restart cygwin,try it.

if failure, should let sqlplus works well in windows cmd at first

# vb.net - VS2008 中 VB.NET 项目的重构菜单项

> ID：299509
> 
> 赞同：1
> 
> 时间：2008-11-18T17:39:32.227
> 
> 标签：vb.net, visual-studio-2008, refactoring

有没有办法在 VB.NET 项目中使用 VS2008 内置的重构功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T07:19:12.227

我相信本机重构仅适用于 C#。但是有重构！这是免费的。

[http://msdn.microsoft.com/en-us/vbasic/bb693327.aspx](http://msdn.microsoft.com/en-us/vbasic/bb693327.aspx)

如果您注册，您将获得更多免费重构。

# sql-server - 如何使用 Emacs 连接到 SQL Server？

> ID：299512
> 
> 赞同：24
> 
> 时间：2008-11-18T17:40:00.180
> 
> 标签：sql-server, emacs, ide, database-connection, sql-mode

我要采取什么步骤？在使用 Emacs 时，有任何需要注意的问题或增强特定于 SQL Server 的 IDE 体验的技巧吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-18T19:18:49.187

**连接**

从 Emacs 连接到 SQL Server 数据库实例：

```
M-x sql-ms RET
M-x sql-mode 
```

系统将提示您输入标准连接信息，具体如下：

*   用户
*   密码
*   服务器
*   数据库

对于 SQL Server 身份验证，键入必要的用户和密码信息。但是，如果通过 Windows 身份验证连接，则对用户名和密码都按 RETURN，将其留空。

**查看输出结果**

请注意，要查看 *SQL* 缓冲区中任何输出结果的文本，应该在某个时候调用“go”语句。有几种方法可以做到这一点。

例如，这条 sql 语句将执行，但不会以当前格式在 *SQL* 缓冲区中显示任何结果文本：

```
select 'foo' as bar 
```

但是，如果在末尾附加“go”：

```
select 'foo' as bar
go 
```

以下将显示在 *SQL* 缓冲区中：

```
 bar   
 ----- 
 foo

(1 row affected) 
```

或者，如果您不想让“go”语句在 SQL 脚本的文本中乱扔垃圾，那么动态调用“go”以查看自上次将上一个“go”语句发送到 sql 进程以来的所有输出结果：

```
C-c C-s go RET 
```

如果您需要查看最初可能未显示在 *SQL* 缓冲区中的任何错误消息，这将很有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-01T06:23:29.230

有时，emacs 的 sql-ms 显示很糟糕，因为显示的某些列太宽而无法阅读。

这里有一些针对糟糕输出体验的技巧。

1.

```
M-x toggle-truncate-lines 
```

切换截断行可以提高一些可读性。

2.

```
select left(columnName, 25) from table 
```

这会将列宽截断为 25 个字符。这对我来说很完美。

来源在这里： [http ://bloggingmath.wordpress.com/2011/02/03/using-emacs-as-your-sql-interface/](http://bloggingmath.wordpress.com/2011/02/03/using-emacs-as-your-sql-interface/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-18T17:27:12.133

另外，请参见此处：

[https://github.com/kiwanami/emacs-edbi](https://github.com/kiwanami/emacs-edbi)

这样我只使用 odbc 通过 DBD::ODBC 连接到所有东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-30T20:45:41.783

作者在尝试连接到 SQL 服务器时提到了“陷阱”。

当尝试连接到*mysql*服务器时，正如投票最多的答案所暗示的那样`M-x sql-mysql`，我发现我不断得到

> 找不到 SQL 程序“mysql”

按照[这个关于 emacs, sql and Macs 的 SO question](https://stackoverflow.com/questions/4141159/emacs-and-mysql-on-mac)的建议，我设置了以下值：

`(setq sql-mysql-program "/usr/local/mysql/bin/mysql")`

这是我本地*mysql*二进制文件的位置/路径。

不知道为什么在我看过的任何其他教程中都没有提到这个变量，所以我把它贴在这里，作为前面提到的连接到*mysql*服务器时的“陷阱”。

# c# - 反思以识别扩展方法

> ID：299515
> 
> 赞同：80
> 
> 时间：2008-11-18T17:40:09.527
> 
> 标签：c#, reflection, extension-methods

在 C# 中是否有一种使用反射来确定方法是否已作为扩展方法添加到类的技术？

给定如下所示的扩展方法，是否可以确定 Reverse() 已添加到字符串类中？

```
public static class StringExtensions
{
    public static string Reverse(this string value)
    {
        char[] cArray = value.ToCharArray();
        Array.Reverse(cArray);
        return new string(cArray);
    }
} 
```

我们正在寻找一种机制来确定在单元测试中扩展方法是由开发人员适当添加的。尝试这样做的一个原因是开发人员可能会将类似的方法添加到实际的类中，如果是，编译器会选择该方法。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2008-11-18T17:42:15.713

您必须查看可以定义扩展方法的所有程序集。

查找用 修饰的类[`ExtensionAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.extensionattribute.aspx)，然后查找该类中*也*用 修饰的方法`ExtensionAttribute`。然后检查第一个参数的类型，看它是否匹配你感兴趣的类型。

这是一些完整的代码。它可能更严格（它不检查类型是否嵌套，或者至少有一个参数），但它应该为您提供帮助。

```
using System;
using System.Runtime.CompilerServices;
using System.Reflection;
using System.Linq;
using System.Collections.Generic;

public static class FirstExtensions
{
    public static void Foo(this string x) {}
    public static void Bar(string x) {} // Not an ext. method
    public static void Baz(this int x) {} // Not on string
}

public static class SecondExtensions
{
    public static void Quux(this string x) {}
}

public class Test
{
    static void Main()
    {
        Assembly thisAssembly = typeof(Test).Assembly;
        foreach (MethodInfo method in GetExtensionMethods(thisAssembly,
            typeof(string)))
        {
            Console.WriteLine(method);
        }
    }

    static IEnumerable<MethodInfo> GetExtensionMethods(Assembly assembly,
        Type extendedType)
    {
        var query = from type in assembly.GetTypes()
                    where type.IsSealed && !type.IsGenericType && !type.IsNested
                    from method in type.GetMethods(BindingFlags.Static
                        | BindingFlags.Public | BindingFlags.NonPublic)
                    where method.IsDefined(typeof(ExtensionAttribute), false)
                    where method.GetParameters()[0].ParameterType == extendedType
                    select method;
        return query;
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-01-09T19:07:13.407

根据 John Skeet 的回答，我创建了自己的 System.Type 类型扩展。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Runtime.CompilerServices;

namespace System
{
    public static class TypeExtension
    {
        /// <summary>
        /// This Methode extends the System.Type-type to get all extended methods. It searches hereby in all assemblies which are known by the current AppDomain.
        /// </summary>
        /// <remarks>
        /// Insired by Jon Skeet from his answer on http://stackoverflow.com/questions/299515/c-sharp-reflection-to-identify-extension-methods
        /// </remarks>
        /// <returns>returns MethodInfo[] with the extended Method</returns>

        public static MethodInfo[] GetExtensionMethods(this Type t)
        {
            List<Type> AssTypes = new List<Type>();

            foreach (Assembly item in AppDomain.CurrentDomain.GetAssemblies())
            {
                AssTypes.AddRange(item.GetTypes());
            }

            var query = from type in AssTypes
                where type.IsSealed && !type.IsGenericType && !type.IsNested
                from method in type.GetMethods(BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic)
                where method.IsDefined(typeof(ExtensionAttribute), false)
                where method.GetParameters()[0].ParameterType == t
                select method;
            return query.ToArray<MethodInfo>();
        }

        /// <summary>
        /// Extends the System.Type-type to search for a given extended MethodeName.
        /// </summary>
        /// <param name="MethodeName">Name of the Methode</param>
        /// <returns>the found Methode or null</returns>
        public static MethodInfo GetExtensionMethod(this Type t, string MethodeName)
        {
            var mi = from methode in t.GetExtensionMethods()
                where methode.Name == MethodeName
                select methode;
            if (mi.Count<MethodInfo>() <= 0)
                return null;
            else
                return mi.First<MethodInfo>();
        }
    }
} 
```

它从当前 AppDomain 中获取所有程序集并搜索扩展方法。

用法：

```
Type t = typeof(Type);
MethodInfo[] extendedMethods = t.GetExtensionMethods();
MethodInfo extendedMethodInfo = t.GetExtensionMethod("GetExtensionMethods"); 
```

下一步是使用方法扩展 System.Type，它返回所有方法（也是“普通”方法和扩展方法）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-11-04T23:01:57.083

这将返回以某种类型定义的所有扩展方法的列表，包括通用方法：

```
public static IEnumerable<KeyValuePair<Type, MethodInfo>> GetExtensionMethodsDefinedInType(this Type t)
{
    if (!t.IsSealed || t.IsGenericType || t.IsNested)
        return Enumerable.Empty<KeyValuePair<Type, MethodInfo>>();

    var methods = t.GetMethods(BindingFlags.Public | BindingFlags.Static)
                   .Where(m => m.IsDefined(typeof(ExtensionAttribute), false));

    List<KeyValuePair<Type, MethodInfo>> pairs = new List<KeyValuePair<Type, MethodInfo>>();
    foreach (var m in methods)
    {
        var parameters = m.GetParameters();
        if (parameters.Length > 0)
        {
            if (parameters[0].ParameterType.IsGenericParameter)
            {
                if (m.ContainsGenericParameters)
                {
                    var genericParameters = m.GetGenericArguments();
                    Type genericParam = genericParameters[parameters[0].ParameterType.GenericParameterPosition];
                    foreach (var constraint in genericParam.GetGenericParameterConstraints())
                        pairs.Add(new KeyValuePair<Type, MethodInfo>(parameters[0].ParameterType, m));
                }
            }
            else
                pairs.Add(new KeyValuePair<Type, MethodInfo>(parameters[0].ParameterType, m));
        }
    }

    return pairs;
} 
```

这只有一个问题：返回的类型与 typeof(..) 所期望的不同，因为它是通用参数类型。为了找到给定类型的所有扩展方法，您必须比较该类型的所有基本类型和接口的 GUID，例如：

```
public List<MethodInfo> GetExtensionMethodsOf(Type t)
{
    List<MethodInfo> methods = new List<MethodInfo>();
    Type cur = t;
    while (cur != null)
    {

        TypeInfo tInfo;
        if (typeInfo.TryGetValue(cur.GUID, out tInfo))
            methods.AddRange(tInfo.ExtensionMethods);

        foreach (var iface in cur.GetInterfaces())
        {
            if (typeInfo.TryGetValue(iface.GUID, out tInfo))
                methods.AddRange(tInfo.ExtensionMethods);
        }

        cur = cur.BaseType;
    }
    return methods;
} 
```

要完整：

我保留了一个类型信息对象的字典，这是在迭代所有程序集的所有类型时构建的：

```
private Dictionary<Guid, TypeInfo> typeInfo = new Dictionary<Guid, TypeInfo>(); 
```

其中`TypeInfo`定义为：

```
public class TypeInfo
{
    public TypeInfo()
    {
        ExtensionMethods = new List<MethodInfo>();
    }

    public List<ConstructorInfo> Constructors { get; set; }

    public List<FieldInfo> Fields { get; set; }
    public List<PropertyInfo> Properties { get; set; }
    public List<MethodInfo> Methods { get; set; }

    public List<MethodInfo> ExtensionMethods { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-18T18:05:54.403

为了澄清 Jon 忽略的一点......“添加”一个扩展方法到一个类不会以任何方式改变这个类。这只是 C# 编译器执行的一点点旋转。

所以，使用你的例子，你可以写

```
string rev = myStr.Reverse(); 
```

但是写入程序集的 MSIL 将与您编写的完全一样：

```
string rev = StringExtensions.Reverse(myStr); 
```

编译器只是让您自欺欺人地认为您正在调用 String 的方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-18T19:05:59.463

> 尝试这样做的一个原因是开发人员可能会将类似的方法添加到实际的类中，如果是，编译器会选择该方法。

*   假设定义了一个扩展方法*void Foo(this Customer someCustomer)*。
*   还假设修改了 Customer 并添加了方法*void Foo()*。
*   然后，客户上的新方法将覆盖/隐藏扩展方法。

此时调用旧 Foo 方法的唯一方法是：

```
CustomerExtension.Foo(myCustomer); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-20T19:35:29.993

```
void Main()
{
    var test = new Test();
    var testWithMethod = new TestWithExtensionMethod();
    Tools.IsExtensionMethodCall(() => test.Method()).Dump();
    Tools.IsExtensionMethodCall(() => testWithMethod.Method()).Dump();
}

public class Test 
{
    public void Method() { }
}

public class TestWithExtensionMethod
{
}

public static class Extensions
{
    public static void Method(this TestWithExtensionMethod test) { }
}

public static class Tools
{
    public static MethodInfo GetCalledMethodInfo(Expression<Action> expr)
    {
        var methodCall = expr.Body as MethodCallExpression;
        return methodCall.Method;
    }

    public static bool IsExtensionMethodCall(Expression<Action> expr)
    {
        var methodInfo = GetCalledMethodInfo(expr);
        return methodInfo.IsStatic;
    }
} 
```

输出：

错误的

真的

# asp.net - ASP.NET 压力测试

> ID：299518
> 
> 赞同：23
> 
> 时间：2008-11-18T17:41:12.097
> 
> 标签：asp.net, remoting, session, stress-testing, weborb

有没有办法测试一个应用程序，您可以模拟一百个不同的客户端连接到 IIS 服务器并询问相同的数据？在我们的项目运行的客户那里，他们有 400 台计算机，他们经常对所有计算机进行压力测试。另一方面，我只有我的笔记本电脑......（和一个开发服务器）。

（在我的情况下，数据是通过 WebORB 网关询问的）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-18T19:08:32.857

*   HP（原 Mercury）[LoadRunner](https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-126-17%5E8_4000_100__)或[Performance Center](https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-126-17_4000_100__)
*   Visual Studio [Application Center 测试](http://msdn.microsoft.com/en-us/library/aa287410.aspx)（仅限企业版？）
*   Microsoft [Web 应用程序压力工具](http://www.microsoft.com/downloads/details.aspx?familyid=e2c0585a-062a-439e-a67d-75a89aa36495&displaylang=en)（又名 WAST，又名“Homer”；Application Center Test 的前身）
*   RadView[网络加载](http://www.radview.com/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-18T17:51:27.320

ab 是为 Apache 设计的工具，[但您可以将它与 IIS 一起使用](http://www.cyberciti.biz/tips/howto-performance-benchmarks-a-web-server.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-02-10T17:37:07.570

在调查了大量开源和付费工具后，我发现最成功的是微软的 Visual Studio 2008 Team Suite 测试版（即将成为 Visual Studio 2010 Ultimate 的一部分）。它具有强大的压力测试功能。Microsoft 的免费压力测试应用程序[WCAT](http://www.iis.net/downloads/default.aspx?tabid=34&i=1466&g=6)功能不足且存在漏洞，但完整的测试版可与 LoadRunner 等产品相媲美，但更易于使用，与 VS/ASP.NET 更好地集成，并且每个虚拟用户的成本要低得多。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-11-07T16:06:21.607

看看**StresStimulus**。

**它与Fiddler**集成得非常好。设置和使用非常流畅，它提供了很多功能和配置。在谷歌搜索 Web 负载测试解决方案时，我找到了最好的方法。Fiddler btw 是一个很棒的工具。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-03-11T11:48:54.663

Microsoft 有一个随 Visual Studio 2013 Ultimate Edition 一起提供的解决方案，请参阅以下链接：更新链接：[压力测试](https://msdn.microsoft.com/Library/vs/alm/Test/performance-testing/run-performance-tests-app-before-release)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-02T12:37:35.520

Trty 这个工具，我已经测试过我的网站似乎运行良好 > [x0Bench](http://www.softpedia.com/get/Internet/Servers/Server-Tools/x0Bench.shtml#download)

# performance - JMeter：如何记录 HTTPS 流量？

> ID：299529
> 
> 赞同：13
> 
> 时间：2008-11-18T17:43:15.183
> 
> 标签：performance, https, automation, jmeter, load-testing

我正在使用 Apache JMeter 2.3，它现在支持代理服务器元素下的“尝试 HTTPS 欺骗”。

我已经在几个不同的服务器上尝试过，但都没有成功。有没有人能够使用此设置从 HTTPS 源成功录制？

或者除非成功录制，任何人都可以分享解决方法吗？如果可用，我只是在服务器级别关闭了 HTTPS，但这并不总是可行的。想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-04-02T16:28:09.147

1.  从 JMeter 3.0 开始，[HTTP(S) 测试脚本记录器](https://jmeter.apache.org/usermanual/component_reference.html#HTTP(S)_Test_Script_Recorder)的默认端口是`8888`

2.  配置录制的最简单方法是使用[JMeter 模板](https://www.ubik-ingenierie.com/blog/templates-or-how-to-speed-up-your-tests-scripting-with-jmeter/)功能。从 JMeter 的主菜单中选择：

    ```
    File -> Templates -> Recording -> Create 
    ```

[![录音模板](https://i.stack.imgur.com/N4ZPT.png)](https://i.stack.imgur.com/N4ZPT.png)

3.  不要忘记启动录音机：

    *   在JMeter < 4.0，展开“Workbench”，如果>= 4.0，忽略这一步
    *   选择“HTTP(S) 测试脚本记录器”
    *   点击“开始”按钮

[![启动记录器](https://i.stack.imgur.com/I3cJd.png)](https://i.stack.imgur.com/I3cJd.png)

4.  您将看到有关 的消息`Root CA Certificate`。点击确定：

[![好的消息](https://i.stack.imgur.com/Bdhmo.png)](https://i.stack.imgur.com/Bdhmo.png)

*   没关系，它会通知您 JMeter 已创建一个根证书颁发机构，您需要将其导入浏览器才能正确记录 HTTPS 流量。

    [![启动代理](https://i.stack.imgur.com/I3cJd.png)](https://i.stack.imgur.com/I3cJd.png)

    4.  要在 Firefox 中导入此根 CA 证书（它位于 jmeter/bin 文件夹中），例如：

[![步骤1](https://i.stack.imgur.com/E21E3.png)](https://i.stack.imgur.com/E21E3.png)

[![第2步](https://i.stack.imgur.com/wI8eR.png)](https://i.stack.imgur.com/wI8eR.png)

[![第 3 步](https://i.stack.imgur.com/K8PNZ.png)](https://i.stack.imgur.com/K8PNZ.png)

[![第4步](https://i.stack.imgur.com/MtWE1.png)](https://i.stack.imgur.com/MtWE1.png)

[![第 5 步](https://i.stack.imgur.com/QartJ.png)](https://i.stack.imgur.com/QartJ.png)

5.  配置浏览器以使用 JMeter 作为代理：

[![在浏览器中将 JMeter 配置为代理](https://i.stack.imgur.com/lJZr9.png)](https://i.stack.imgur.com/lJZr9.png)

现在好了。

*   您可以导航到您的应用程序，采样器将在“线程组”元素下的“[记录控制器”下创建](https://jmeter.apache.org/usermanual/component_reference.html#Recording_Controller)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-30T21:08:32.600

虽然 JMeter 代理已经能够记录 HTTPS 请求，但最近出现了一个创建 JMeter 脚本的 Chrome 扩展： [https ://chrome.google.com/webstore/detail/blazemeter-the-load-testi/mbopgmdnpcbohhpnfglgohlbhfongabi?hl= zh](https://chrome.google.com/webstore/detail/blazemeter-the-load-testi/mbopgmdnpcbohhpnfglgohlbhfongabi?hl=en)

它使用 BlazeMeter 作为中间人（云服务中的商业 JMeter），但您可以永远使用他们的免费服务，并且即使您从未使用过任何付费计划。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-24T20:48:20.633

我要做的是：

1.  使用我的网络服务器的 IP 地址（即[http://2.2.2.2/login.html](http://2.2.2.2/login.html)）访问我的网站
2.  启动记录器并运行我的测试用例
3.  停止录制
4.  将 IP 地址的所有值替换为来自 HTTP 请求采样器的域名（即，将 2.2.2.2 替换为 yoursite.com）
5.  在 HTTP 请求采样器中将协议设置为 https

如果您有多个页面，最简单的方法是创建一个 HTTP Request Defaults 项目，并在那里设置您的域名和协议。

仅供参考，我正在使用截至 2010 年 5 月 24 日的最新稳定版本：Jmeter 2.3.4 r785646。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-20T16:35:26.290

最新版本的 Jmeter (2.4) 现在支持 HTTPS 录制。麾！

更多细节： [http ://wiki.apache.org/jmeter/JMeterFAQ#Can_JMeter_record_HTTPS_requests_using_the_recording_proxy.3F](http://wiki.apache.org/jmeter/JMeterFAQ#Can_JMeter_record_HTTPS_requests_using_the_recording_proxy.3F)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T18:12:01.543

除了 Bad boy 和 Https 欺骗之外，还有其他记录 HTTPS 的方法吗？

是的——使用 JMeter 的夜间版本，例如版本 r922204。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-22T19:18:52.373

截至今天，Https 记录已在 Jmeter 2.9 的新版本中成功运行。我必须导入代理证书并使用 Firefox 才能使其正常工作。

有关更多信息，请参阅此链接 [使用 Jmeter 记录 Https](http://qtp-automate.blogspot.co.uk/2013/05/https-recording-with-new-jmeter_22.html)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-11-30T13:43:43.450

是的，我已将它与“尝试 HTTPS 欺骗”一起使用。事情很简单：

1.  打开 HTTPS 欺骗（当然）。
2.  确保浏览器向 Jmeter 发送 Http 请求，以便 Jmeter 可以记录它，然后将加密的请求发送回服务器。因此，浏览器中的 URL 应该以 http://（而不是 https://）开头。详细信息可以在[我的博客](http://deathbycode.blogspot.com/2010/11/load-testing-of-gui-using-jmeter.html)中找到。

请让我知道它是否适合您。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2010-04-08T20:43:39.903

I am using Webscarab to record https and ajax conversations. It workd fine. I extended the Webscarab with export function for Jmeter. Bugzilla 48898.

# c# - 在 ListView (Winforms) 中创建一个 int 列

> ID：299536
> 
> 赞同：2
> 
> 时间：2008-11-18T17:44:45.897
> 
> 标签：c#, .net, winforms

是否可以在 ListView 中创建整数（或 DataTime 等）列？这很重要，因为我想根据此列对列表进行正确排序。

将子项添加到我发现的 ListViewItem 的唯一方法是：

```
listviewitem.SubItems.Add("1"); 
```

我想避免解析这些字符串来获取每种类型的 int 表示！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T20:10:34.683

您可以使用 Tag 属性。这些小辅助函数负责处理它：

```
private void setListItem(int row, int column, int value) {
  ListViewItem.ListViewSubItem item = listView1.Items[row].SubItems[column];
  item.Tag = value;
  item.Text = value.ToString();
}
private int getListItem(int row, int column) {
  return (int)listView1.Items[row].SubItems[column].Tag;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T17:55:56.623

而不是您只需将字符串添加到列表并使用`.Text`属性接收字符串。

例子：

```
int a = 0;
listView1.Items.Add(a.ToString()); 
```

或者

```
int a = Convert.ToInt32(listView1.Items[0].SubItems[0].Text); 
```

您可以对`DataTime`其他数据类型执行相同的操作，只需将它们转换为`String`类型即可。

您如何解释包含 ie 日期的列，这完全取决于您。只需实现对特定`ListView`列进行排序的算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T18:38:03.613

我认为我们有一个整数类型的列，就像我们在 datagrid 中的列一样，实际上我不知道 listview 控件。如果您找到答案，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-19T06:51:31.567

请点击此链接：
[如何在 Visual C# 中按列对 ListView 控件进行排序](https://support.microsoft.com/en-us/kb/319401)

然后对于函数`Compare`：（
根据您对列数据类型的数据类型要求添加以下开关盒）

```
public int Compare(object x, object y)
{
    //(...)
    switch (ColumnToSort)
    {
        case 2:
            compareResult = objectComparer.Compare(DateTime.Parse(listviewX.SubItems[ColumnToSort].Text), DateTime.Parse(listviewY.SubItems[ColumnToSort].Text));
            break;
        case 3:
            compareResult = objectComparer.Compare(float.Parse(listviewX.SubItems[ColumnToSort].Text.Replace("kb", "").Replace("mb", "")), float.Parse(listviewY.SubItems[ColumnToSort].Text.Replace("kb", "").Replace("mb", "")));
            break;

        default:
            compareResult = objectComparer.Compare(listviewX.SubItems[ColumnToSort].Text, listviewY.SubItems[ColumnToSort].Text);
            break;
    }
    //(...)
} 
```

# reporting-services - 如何设计好看的报表？

> ID：299539
> 
> 赞同：5
> 
> 时间：2008-11-18T17:45:25.380
> 
> 标签：reporting-services, reporting, report

我目前正在为 SSRS 做一些报告，我只是确认一下我已经知道的事情，我很讨厌配色和让事情看起来很漂亮。

有谁知道一个好的网站或其他东西来帮助我弄清楚报告的外观。我需要帮助！任何网站或建议将不胜感激。我试图坚持看起来很酷的调色板，它只是没有用......

PS：我知道这不是与编程或类似的东西有关的问题，但是这种缺乏冷静会影响我所做的一切：p

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-18T18:06:20.690

最佳选择：除非您有特殊需要，否则不要使用颜色。许多年前，我在求职商业印刷行业做过一段时间的排版工作。由于设置成本，大多数客户不想为彩色打印作业付费，因此作业往往是黑白或两种专色。

此外，我已经完成了任何数量的文档工作，其中输出设备是黑白激光打印机。

除非你对色彩有很好的认识，否则尝试扮演业余平面设计师可能比它的价值更麻烦。从黑白报告开始，可能使用一两种突出显示颜色。如果您找到喜欢的整体配色方案，可以将其用作标准格式，但要保持简单。否则，您实际上只是在添加[Chart Junk](http://en.wikipedia.org/wiki/Chartjunk)，这是一件坏事。

如果您真的需要颜色，请谨慎使用，并避免反转标题（深色背景上的浅色文本）。一些节省颜色使用的建议：

*   标题或最左侧列上的浅色（不比相当于 10-20% 灰色半色调的颜色更暗）。仅在最左侧的列相对较窄时对其进行遮蔽。这种左侧带有灯条的标题将构成报告。

*   交替的酒吧约。5行左右。纯白色背景中的 5 行和柔和阴影中的 5 行。这应该比您在上述标题中使用的阴影更轻（相当于 5-10% 的灰色）。仅当条的大小相同时才使用它 - 如果条的高度不同，它看起来很难看。

*   以警报颜色突出显示的值（如果您有超出特定范围的数字会改变）。这对于 KPI 报告可能非常有用。

*   图表 - 使用较浅的阴影而不是明亮的原色打印图表，除非您正在制作折线图，其中线条应该是相对较细和较深的颜色，如栗色或海军蓝。将任何边框、点、轴和标签保留为黑色。

避免图形装饰本身，除非您实际上是一个称职的图形艺术家。随着桌面出版的出现，业余平面设计在 1980 年代和 1990 年代获得了当之无愧的坏名声。保持报告看起来很专业，如果您与用户发生任何争论，请使用这个术语（“应该看起来很专业”）。

这种方法应该可以让您在满足人们对颜色的要求的同时仍保持一定程度的专业性（和自尊）。可以看出您可以满足用户请求，而不会看起来像个白痴。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T18:26:17.560

我使用[Color Brewer](http://www.personal.psu.edu/faculty/c/a/cab38/ColorBrewer/ColorBrewer.html)为报告、图表、地图等选择互补色方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T20:10:47.240

内容*是*最重要的元素。之后，简单。

*   使用一组有限的字体和颜色
*   谨慎使用粗体、斜体和下划线
*   使用大量空格
*   基于网格的页面布局

有关布局的一些提示：[图形设计](http://www.online.tusc.k12.al.us/tutorials/grdesign/grdesign.htm)和[排版和页面布局的基础知识](http://www.typography-1st.com/typo/prnc-des.shtml)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T18:50:33.907

我会说报告的布局比它的配色方案更重要。
一份好的报告的目的是组织信息并以简洁、有意义的方式呈现它，并引导人们从一个元素到另一个元素。时髦的油漆工作是可选的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T17:10:15.047

当您使用报表创建向导时，我总是使用默认的深蓝色/浅蓝色配色方案。

我已经用它做报告一年多了，从来没有收到过投诉。

# iis - 使用 Powershell 更改 IIS 站点主目录

> ID：299546
> 
> 赞同：8
> 
> 时间：2008-11-18T17:48:41.223
> 
> 标签：iis, powershell

我可以查询 AD 并找到所有 IIS 站点及其虚拟目录，现在我需要能够更新这些主目录并保存更改。

获取目录条目后，我可以使用 显示站点路径`$site.Path`，但是设置它似乎没有任何效果。它永远不会改变实际存储的路径。

我已经尝试过`$site.Path = <new path>`，`$site.Put( "Path", <new path> )`但这些似乎都没有影响存储的路径。

```
 $site = $iis.psbase.children | 
        where {$_.keyType -eq "iiswebserver"} | 
        where {$_.psbase.properties.servercomment -eq $siteConfig.name };

    $s = [ADSI]($site.psbase.path + "/ROOT");
    $s.Path
    # $s.Path = $siteConfig.path
    # $s.Put("Path", $siteConfig.path )
    $s.psbase.CommitChanges() 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2011-03-28T19:04:26.527

```
Import-Module WebAdministration
Set-ItemProperty 'IIS:\Sites\Default Web Site\' -name physicalPath -value $siteConfig.path 
```

[http://technet.microsoft.com/en-us/library/ee909471(WS.10).aspx](http://technet.microsoft.com/en-us/library/ee909471(WS.10).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T17:53:25.020

好的，我试过这个，它似乎工作：

```
 $s.psbase.properties.path[0] = $siteConfig.path
    $s.psbase.CommitChanges() 
```

有没有更好的清洁方法来处理这个问题？

# delphi - ItemIndex 是否有 TDBComboBox 等价物？

> ID：299548
> 
> 赞同：2
> 
> 时间：2008-11-18T17:49:08.243
> 
> 标签：delphi, controls, data-aware

在 TDBComboBox 的帮助文件条目中，它表示所选选项的文本成为该字段的新值。是否有任何类似的控件通过 ItemIndex 而不是文本？（例如，表示枚举类型。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T19:28:30.493

试试 TDBLookupComboBox。查看 ListField、DataField 和 KeyField 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T20:23:12.940

您可以用数字（'0、'1'、'2'、...）填充 TDBComboBox 项目，但将 DBComboBox1.Style 设置为 csOwnerDrawFixed 并编写 OnItemDraw 事件。像这样的东西：

```
procedure TForm1.DBComboBox1DrawItem(Control: TWinControl; Index: Integer;
  Rect: TRect; State: TOwnerDrawState);
begin
  with (Sender as TDBComboBox).Canvas do
  begin
    FillRect(Rect);
    TextRect(Rect, Rect.Left+1, Rect.Top+1, MyValueDescriptions[Index]);
  end;
end; 
```

# c# - 比较 XML 文件是否相等的最佳方法是什么？

> ID：299553
> 
> 赞同：12
> 
> 时间：2008-11-18T17:50:14.840
> 
> 标签：c#, .net, xml, unit-testing, comparison

我正在使用 .NET 2.0，最近的代码更改使我之前的 Assert.AreEqual 调用（它比较了两个 XML 字符串）无效。在新的代码库中，只有一个 XML 元素实际上是不同的，所以我希望所有其他元素的比较会给我想要的结果。比较需要以编程方式完成，因为它是单元测试的一部分。

起初，我正在考虑使用几个 XmlDocument 实例。但后来我发现了这个： [http ://drowningintechnicaldebt.com/blogs/scottroycraft/archive/2007/05/06/comparing-xml-files.aspx](http://drowningintechnicaldebt.com/blogs/scottroycraft/archive/2007/05/06/comparing-xml-files.aspx)

看起来它可能会起作用，但我对 Stack Overflow 的反馈很感兴趣，以防有更好的方法。

如果可能的话，我想避免为此添加另一个依赖项。

## 类似问题

*   [NUnit 是否有 XML 断言？](https://stackoverflow.com/questions/3552648/is-there-an-xml-asserts-for-nunit)
*   [您将如何比较两个 XML 文档？](https://stackoverflow.com/questions/167946/how-would-you-compare-two-xml-documents)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-18T17:56:24.533

这实际上取决于您要检查的“差异”。

现在，我们正在使用 Microsoft XmlDiff：http: [//msdn.microsoft.com/en-us/library/aa302294.aspx](http://msdn.microsoft.com/en-us/library/aa302294.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T18:46:35.850

您可能会发现将 XML 解析为 XmlDocument 并将您的 Assert 调用基于 XPath Query 并不那么脆弱。以下是我经常使用的一些辅助断言方法。每一个都需要一个 XPathNavigator，您可以通过在 XmlDocument 或从文档中检索的任何节点上调用 CreateNavigator() 来获得它。一个使用示例是：

```
 XmlDocument doc = new XmlDocument( "Testdoc.xml" );
     XPathNavigator nav = doc.CreateNavigator();
     AssertNodeValue( nav, "/root/foo", "foo_val" );
     AssertNodeCount( nav, "/root/bar", 6 )

    private static void AssertNodeValue(XPathNavigator nav,
                                         string xpath, string expected_val)
    {
        XPathNavigator node = nav.SelectSingleNode(xpath, nav);
        Assert.IsNotNull(node, "Node '{0}' not found", xpath);
        Assert.AreEqual( expected_val, node.Value );
    }

    private static void AssertNodeExists(XPathNavigator nav,
                                         string xpath)
    {
        XPathNavigator node = nav.SelectSingleNode(xpath, nav);
        Assert.IsNotNull(node, "Node '{0}' not found", xpath);
    }

    private static void AssertNodeDoesNotExist(XPathNavigator nav,
                                         string xpath)
    {
        XPathNavigator node = nav.SelectSingleNode(xpath, nav);
        Assert.IsNull(node, "Node '{0}' found when it should not exist", xpath);
    }

    private static void AssertNodeCount(XPathNavigator nav, string xpath, int count)
    {
        XPathNodeIterator nodes = nav.Select( xpath, nav );
        Assert.That( nodes.Count, Is.EqualTo( count ) );
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T18:08:12.667

对字符串进行简单的字符串比较`xml`并不总是有效。为什么 ？

例如两者：

`<MyElement></MyElmennt>`并且`<MyElment/>`从一个角度来看是平等的`xml`..

有一些用于转换的算法`xml`总是看起来相同，它们被称为规范化算法。`.Net`支持规范化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-29T06:45:35.220

我编写了一个带有用于序列化的断言的小型库[source](https://github.com/JohanLarsson/Gu.SerializationAsserts)。

样本：

```
[Test]
public void Foo()
{
   ...
   XmlAssert.Equal(expected, actual, XmlAssertOptions.IgnoreDeclaration | XmlAssertOptions.IgnoreNamespaces);
} 
```

[![NuGet](https://img.shields.io/nuget/v/Gu.SerializationAsserts.svg)](https://www.nuget.org/packages/Gu.SerializationAsserts/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T21:43:56.133

由于 XML 文件的内容可以具有不同的格式，并且在测试相等性时仍然被认为是相同的（从 DOM 的角度来看），因此您需要确定该相等性的度量是什么，例如，格式是否被忽略？元数据是否被忽略等定位很重要，很多边缘情况。

通常，您会创建一个定义相等规则的类并将其用于比较，如果您的比较类实现了`IEqualityComparer and/or IEqualityComparer<T>`接口，那么您的类也可以在一堆内置框架列表中用作相等测试实现。另外，当然，您可以根据需要以不同的方式衡量平等。

IE

```
IEnumerable<T>.Contains
IEnumerable<T>.Equals
The constructior of a Dictionary etc etc 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T23:08:44.853

我最终通过以下代码得到了我想要的结果：

```
private static void ValidateResult(string validationXml, XPathNodeIterator iterator, params string[] excludedElements)
    {
        while (iterator.MoveNext())
        {
            if (!((IList<string>)excludedElements).Contains(iterator.Current.Name))
            {
                Assert.IsTrue(validationXml.Contains(iterator.Current.Value), "{0} is not the right value for {1}.", iterator.Current.Value, iterator.Current.Name);
            }
        }
    } 
```

在调用该方法之前，我以这种方式在 XmlDocument 的实例上创建一个导航器：

```
XPathNavigator nav = xdoc.CreateNavigator(); 
```

接下来，我创建一个 XPathExpression 实例，如下所示：

```
XPathExpression expression = XPathExpression.Compile("/blah/*"); 
```

我在使用表达式创建迭代器后调用该方法：

```
XPathNodeIterator iterator = nav.Select(expression); 
```

我仍在研究如何进一步优化它，但它现在可以解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-28T18:14:01.590

我做了一个方法来创建简单的 XML 路径。

```
static XElement MakeFromXPath(string xpath)
{
    XElement root = null;
    XElement parent = null;
    var splits = xpath.Split('/'); //split xpath into parts
    foreach (var split in splits)
    {
        var el = new XElement(split);
        if (parent != null)
            parent.Add(el);
        else
            root = el; //first element created, set as root
        parent = el;
    }
    return root;
} 
```

示例用法：

`var element = MakeFromXPath("My/Path/To/Element")'`

`element`将包含值：

```
<My>
  <Path>
    <To>
      <Element></Element>
    </To>
  </Path>
</My> 
```

# java - 在会话中使用 jsp bean

> ID：299554
> 
> 赞同：1
> 
> 时间：2008-11-18T17:50:40.317
> 
> 标签：java, jsp, javabeans

我正在使用 JSP bean，当我对新对象进行分配时，它会在提交给前一个对象时被覆盖。

```
<jsp:useBean id="base" class="com.example.StandardBase" scope="session" />
...
//base object id  = 396
base = new Base()
//base object id = 1000 
```

在重新提交我得到的页面时

```
<jsp:useBean id="base" class="com.example.StandardBase" scope="session" />
//base object id = 396 
```

有没有办法告诉 JSP 做一个新的任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T17:56:00.070

我不完全确定，但我认为`base = new Base()`不会更新存储在会话范围内的引用。因此，您使用初始创建的 bean`<jsp:useBean/>`仍然存在，而您手动创建然后更新的 bean 不存在。

摆脱，`base = new Base()`你应该没事。

如果你坚持更新它，你使用[`HttpSession.setAttribute()`](http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/http/HttpSession.html#setAttribute(java.lang.String,%20java.lang.Object)). 像这样：

```
session.setAttribute("bean", bean); 
```

我相信该变量`session`是由 JSP 引擎自动为您创建和初始化的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T17:55:18.153

你不应该自己更新 bean。让 JSP 为你做这件事

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T17:54:16.690

将范围从会话更改为请求会为您解决这个问题吗？

# ruby-on-rails - restful_authentication：授权？= NoMethodError（但logged_in？工作正常......？）

> ID：299563
> 
> 赞同：1
> 
> 时间：2008-11-18T17:53:29.700
> 
> 标签：ruby-on-rails, authentication

我不明白为什么一种方法会起作用，而如果它们来自同一个 lib 文件，另一种方法会抛出 NoMethodError 。

```
# app/views/bunnies/show.html.erb
<% if logged_in? %>
  <%= current_user.login %> |
  <%= link_to 'Logout', logout_path %> |
  <% if authorized? %>
    <%= link_to 'Edit Details', edit_bunny_path(@broker) %> |
  <% end %>
  <%= link_to 'Back', bunnies_path %>
<% end %> 
```

... 为`authorized?`. 如果我评论说如果被阻止，则页面可以正常工作（带有）。`logged`_`in?`

```
# lib/authenticated_system.rb
def logged_in?
  !!current_user
end

def authorized?
  current_user.login == "admin"
end

# app/controllers/application.rb
class ApplicationController < ActionController::Base
  include AuthenticatedSystem
end 
```

是什么赋予了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T14:19:41.223

我猜你在抛出错误时没有登录。NoMethod 不是指#authorized?。它实际上是指 current_user 的#login 方法。如果您没有登录，则 current_user 为 nil，当在 #authorized? 中调用 current_user.login 时会导致 NoMethod。

有像授权的助手吗？检查用户状态应该包括检查logged_in？首先绕过这个问题。试试这个...

```
def authorized?
  logged_in? and current_user.login == "admin"
end 
```

这样，如果未登录，您将退出条件，并且您不会尝试访问 #login 方法，除非您实际上有可用的对象。

您还可以查看一些与 Restful_Authentication 一起使用的可用的基于角色的身份验证方案。如果您的访问模式比仅检查管理员更复杂，那么使用其中一个插件会更容易。

顺便说一句，在authenticated_system.rb 的更下方，您会发现以下代码：

```
# Inclusion hook to make #current_user and #logged_in?
# available as ActionView helper methods.
def self.included(base)
  base.send :helper_method, :current_user, :logged_in?, :authorized? if base.respond_to? :helper_method
end 
```

这就是使该模块中的方法可用作视图中的辅助方法的原因。如果您向 authenticated_system.rb 添加一个返回用户状态的方法（例如，#superuser? 之类的东西），您需要将该方法符号添加到此代码中的 base.send 调用中。同样，如果您发现自己为访问控制编写了大量代码，那么学习其中一个插件将是顺理成章的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T14:32:58.303

```
def is_admin?
  logged_in? && current_user.login == "admin"
end 
```

足够

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T18:59:53.920

是的，所以我仍然不明白为什么这不起作用，但我找到了替代解决方案。

(1) 将 authenticated_system.rb 保持原样。

(2) 在controllers/application.rb中添加一个helper方法：

```
helper_method :is_admin?
def is_admin?
  if logged_in? && current_user.login == "admin"
    true
  else
    false
  end
end 
```

(3) 使用辅助方法代替`authorized?`. 如果有人想解释为什么原始代码不起作用，我全神贯注！

（感谢[这篇文章](http://railsonedge.blogspot.com/2008/03/rails-forum-restful-authenticationpart.html)）

# c - 如何在 Visual C++ Express 2008 上禁用 interface 关键字？

> ID：299565
> 
> 赞同：6
> 
> 时间：2008-11-18T17:54:20.260
> 
> 标签：c, visual-studio-2008

我在这里编译一个遗留的 C 代码，有很多名为“interface”的变量和结构成员，但是 VC2008 express 抱怨这些，你知道如何禁用它吗？

我已经更改了设置以仅将代码编译为 C 代码，但对此没有影响。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-03-25T12:09:23.717

问题是 MS #defines interface to struct 这样

```
interface Name {...} 
```

可以在 COM c++ 代码中使用。(objbase.h:199 `#define interface __STRUCT__`:)

就`#undef interface`在包括 Windows.h 之后..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T18:02:20.697

做一个

```
#define interface QQInterface 
```

在您的代码之前（例如在头文件中），在使用关键字接口的任何地方，编译器都会看到“QQInterface”，这不是关键字。如果所有代码都包含此定义，则不会出现编译器或链接器错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-18T18:41:28.107

如果您正在尝试编译可移植的 C 代码，则可能值得禁用 Microsoft 语言扩展（命令行上的 /Za，VS 中的配置属性 > C/C++ > 语言），然后查看代码是否编译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T18:13:19.770

“接口” a 不应该是 C 或 ISO C++ 中的关键字。它*是*C++ 托管扩展中的一个关键字，因此，我猜，在您的配置中，您仍然在告诉它为 .NET 创建代码。确保所有地方都设置为“本机代码”

但是，您很可能无法在 Express 版本中将其设置为 Native Code --- 这只是一个猜测，但考虑到 Express/Standard/Pro 版本的 MS 定位，这是合理的。

更新：忽略最后一段。MSFT 坚持您可以使用 VisualC++ Express 创建本机 Win32 应用程序：http: [//www.microsoft.com/express/vc/](http://www.microsoft.com/express/vc/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-24T12:00:03.873

在编译包含 dbus 头文件的 C++ 代码时，我遇到了类似的问题。由于 dbus 有几个函数，它使用“接口”作为 I/P 参数名称，恰好是 C++ 关键字，我收到以下错误：`error: expected ',' or '...' before 'struct'`.

当我尝试这个时：

```
#ifdef interface 
#undef interface 
#endif 
```

它解决了这个问题。不确定使用 dbus C++ 绑定是否会更好。无论如何，我没有使用 dbus，只是远程依赖一个 dbus 标头，这个解决方案工作得很好！！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-22T08:37:20.137

您可以定义 WIN32_LEAN_AND_MEAN 以避免包含此定义。请参阅[MSDN 文档](https://docs.microsoft.com/en-us/windows/win32/winprog/using-the-windows-headers?redirectedfrom=MSDN#faster-builds-with-smaller-header-files)

# .net - 在 .NET 中，我的 app.config 设置的运行时等效项是什么？

> ID：299574
> 
> 赞同：3
> 
> 时间：2008-11-18T17:56:03.050
> 
> 标签：.net, wcf, proxy

如果我的 app.config 文件中有以下设置。这是我需要确保我的 WCF 客户端可以协商默认代理服务器的设置。

```
<system.net>
    <defaultProxy enabled="true" useDefaultCredentials="true"></defaultProxy>
</system.net> 
```

不幸的是，我无法在我的环境中添加 app.config 文件。如何通过在运行时设置这些设置来确保这些设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T18:15:36.273

我认为您所做的是创建一个`System.Net.WebProxy`对象，然后设置适当的变量，然后设置`System.Net.WebRequest.DefaultWebProxy`：

```
System.Net.WebProxy proxy = new WebProxy();
proxy.UseDefaultCredentials = true;
WebRequest.DefaultWebProxy = proxy; 
```

这篇文章有点谈论整个事情：[链接](http://www.west-wind.com/WebLog/posts/2542.aspx)

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T18:22:35.010

在项目的属性页面上应该有一个设置选项卡。您放在那里的任何内容实际上都存在于项目的 *.settings 文件中，但也会在部署时自动包含在 app.config 文件中。你可以在那里进行更改吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-22T06:41:29.743

我想您正在使用从 WSHttpBindingBase 继承的绑定。如果是这样，您也可以尝试在代码中设置“UseDefaultWebProxy”属性。像这样的东西：

```
myWSHttpBinding.UseDefaultWebProxy = True; 
```

**编辑：** BasicHttpBinding 也具有相同的属性。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-18T18:14:18.020

无论您的可执行文件（不是库 dll）程序集的定义名称是什么，请在末尾添加一个“.config”...

所以如果你的可执行文件是

AcmeWidgets.EastCoast.MyApplicationName.exe

然后 app.config 将重命名为

AcmeWidgets.EastCoast.MyApplicationName.exe.config

但是，我不建议您尝试在运行时动态更改这些设置（在磁盘上的配置文件中）...

相反，您是否可以对您的应用程序进行编码，以便它从这些配置设置中填充和使用静态变量......然后实现动态“更改值”功能，以便它更改这些静态变量......

这样您仍然可以动态“影响”运行时行为，但避免了写入配置文件的麻烦，并且 Ops 管理可以通过编辑配置文件中的“默认”值来管理它......

# javascript - javascript 富文本编辑器

> ID：299577
> 
> 赞同：32
> 
> 时间：2008-11-18T17:56:33.690
> 
> 标签：javascript, wysiwyg, richtext, rte, rich-text-editor

有几个（非常好的）用 Javascript 编写的富文本 Web 编辑器（例如 FCKeditor、YUI Texteditor 和许多其他）。

但是我找不到任何关于如何构建这样一个组件的教程。可以解释高级考虑因素（架构）和/或低级“关键”点的更多细节（即为什么大多数编辑器都使用 iFrame，如何处理键盘输入，如 Ctrl-B、Ctrl -C 选择文本时和未选择文本时等）

我的主要动机是好奇心。如果我今天必须开发这样的编辑器，我不知道从哪里开始。

有谁知道任何涵盖上述问题的教程（理想情况下，解释如何从头开始构建所见即所得编辑器的东西）？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-11-20T11:39:13.387

经过更多研究，我发现了以下内容。构建富文本编辑器的功能已经在浏览器中实现。IE 是第一个创建这样一个 API 的，Firefox 复制了它。

## 概述

要点是javascript对象“document”有一个名为designMode的属性，可以设置为“on”。这会将所有页面转换为类似 textarea 的组件。想象一下浏览器打开页面的方式与 MS-Word 相同：用户可以看到格式，但他也可以输入页面（通常浏览器以只读方式打开页面）。

```
window.document.designMode = "On"; 
```

由于上述影响所有网页，大多数编辑器使用 iFrame，因此可编辑区域只有 iFrame 具有它自己的文档对象。

最重要的是，有一个 API 可以让 JavaScript 轻松访问样式。这是暴露的抛出 execCommand() 方法。例如，您可以从 Javascript 调用

```
document.execCommand('bold', false, ''); 
```

并且选定的文本将变为粗体。

## 教程

我发现了以下内容：

一个简短的分步[指南](http://www.bewebmaster.com/55.php)。

Mozilla[指南](http://developer.mozilla.org/en/Rich-Text_Editing_in_Mozilla)。它有我找到的最方便的 API 参考以及更多链接。

[微软](http://msdn.microsoft.com/en-us/library/ms537834(VS.85).aspx)的指南。

# javascript - 是否有用于 Windows Media Player 的文档化 JavaScript API？

> ID：299582
> 
> 赞同：7
> 
> 时间：2008-11-18T17:57:52.923
> 
> 标签：javascript, windows-media-player

我想使用 JavaScript 来控制嵌入式 Windows Media Player，以及访问播放器公开的任何属性。我在网上找到了一些骇人听闻的例子，但没有什么具体的。

我真的需要访问播放、暂停、停止、搜索、全屏等。我还想访问播放器碰巧广播的任何事件。

帮助会很棒（我已经有一个 Flash equiv，所以你知道），谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-08T00:30:28.900

API 需要 Internet Explorer 原生的 ActiveX 连接，或者可以使用[Firefox 插件](http://port25.technet.com/pages/windows-media-player-firefox-plugin-download.aspx)。

这是一个可以帮助您入门的示例页面。

```
<html>
<head>
  <title>so-wmp</title>
  <script>

    onload=function() {
      player = document.getElementById("wmp");
      player.URL = "test.mp3";
    };

    function add(text) {
      document.body
        .appendChild(document.createElement("div"))
        .appendChild(document.createTextNode(text));
    };

    function handler(type) {
      var a = arguments;
      add(type +" = "+ PlayStates[a[1]]);
    };

    // http://msdn.microsoft.com/en-us/library/bb249361(VS.85).aspx
    var PlayStates = {
       0: "Undefined", // Windows Media Player is in an undefined state.
       1: "Stopped", // Playback of the current media item is stopped.
       2: "Paused", // Playback of the current media item is paused. When a media item is paused, resuming playback begins from the same location.
       3: "Playing", // The current media item is playing.
       4: "ScanForward", // The current media item is fast forwarding.
       5: "ScanReverse", // The current media item is fast rewinding.
       6: "Buffering", // The current media item is getting additional data from the server.
       7: "Waiting", // Connection is established, but the server is not sending data. Waiting for session to begin.
       8: "MediaEnded", // Media item has completed playback.
       9: "Transitioning", // Preparing new media item.
      10: "Ready", // Ready to begin playing.
      11: "Reconnecting" // Reconnecting to stream.
    };

  </script>
  <script for="wmp" event="PlayStateChange(newState)">
    // http://msdn.microsoft.com/en-us/library/bb249362(VS.85).aspx
    handler.call(this, "playstatechange", newState);
  </script>
</head>
<body>
  <div id="page">
    <object id="wmp"
       classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"
          type="application/x-oleobject">
    </object>
  </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-07T23:30:58.683

Microsoft 的开发者中心有一个 API，但它只有在使用 active-x 嵌入 windows 媒体播放器时才能工作。

要“了解”有关 API 的更多信息，请查看 MSDN：http: [//msdn.microsoft.com/en-us/library/dd564034 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd564034(VS.85).aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-18T19:56:13.683

Windows 媒体播放器作为一个 activex 控件公开，在 Windows 脚本宿主中运行的任何脚本语言都应该能够访问该控件。您应该能够使用 jscript 来控制它。Jscript 是微软对 java 脚本的实现。有关使用 jscript for windows media player 可以使用哪些对象和方法的信息，请参阅[此链接。](http://msdn.microsoft.com/en-us/library/bb249259(VS.85).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T20:18:41.063

据我所知，没有用于 WMP 播放器的跨浏览器客户端处理的开放 JavaScript 库。然而，[这个链接](http://dotupdate.wordpress.com/2007/08/15/using-wmp-and-quicktime-with-silverlight/)应该让你很容易开始你自己的小图书馆。代码可能需要在现代浏览器版本中进行一些更新和测试，但您已经具备了基础知识。

您搜索的库对于 Google 代码项目来说是一个好主意，我想虽然今天每个人都在使用带有[sIFR](http://wiki.novemberborn.net/sifr3) / [swfobject的 Adob​​e Flash 或带有](http://code.google.com/p/swfobject/)[sistr](http://fortes.com/projects/silverlight/sistr/)等的Microsoft Silverligt ，但编写用于 WMP 的客户端脚本控制的兴趣不大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-17T05:26:38.143

应该使用下一个 WMP 对象（适用于 Chrome、FF、Safari）

```
 objPlayer = document.getElementById("wmp");           
    objPlayer.controls.stop();
    objPlayer.URL = this.url;
    objPlayer.controls.play();

<EMBED id="wmp" TYPE="application/x-mplayer2" name="MediaPlayer" width="0" height="0" ShowControls="0" ShowStatusBar="0" ShowDisplay="0" autostart="0"></EMBED> 
```

# c++ - C++ 多重虚拟继承与 COM

> ID：299585
> 
> 赞同：6
> 
> 时间：2008-11-18T17:58:17.587
> 
> 标签：c++, com, multiple-inheritance, virtual-inheritance

网上充斥着对[“可怕的钻石问题”](http://en.wikipedia.org/wiki/Diamond_problem)的解释。StackOverflow 也是如此。我想我理解这一点，但我未能将这些知识转化为理解相似但不同的东西。

我的问题从纯 C++ 问题开始，但答案很可能会扩展到 MS-COM 细节。一般问题的问题是：

```
class Base { /* pure virtual stuff */ };
class Der1 : Base /* Non-virtual! */ { /* pure virtual stuff */ };
class Der2 : Base /* Non-virtual! */ { /* pure virtual stuff */ };
class Join : virtual Der1, virtual Der2 { /* implementation stuff */ };
class Join2 : Join { /* more implementation stuff + overides */ }; 
```

这*不是*经典的钻石解决方案。究竟“虚拟”在这里做什么？

我真正的问题是试图理解[我们朋友在 CodeProject 的讨论。](http://www.codeproject.com/KB/COM/flashcontrol.aspx?fid=915540&select=2784823&tid=2774438)它涉及用于为 Flash 播放器创建透明容器的自定义类。

我想我会试试这个地方的乐趣。事实证明，以下声明使用 Flash 播放器版本 10 使您的应用程序崩溃。

```
class FlashContainerWnd:   virtual public IOleClientSite,
                           virtual public IOleInPlaceSiteWindowless,
                           virtual public IOleInPlaceFrame,
                           virtual public IStorage 
```

调试表明，当输入来自不同调用者的函数实现（QueryInterface 等）时，我得到不同调用的不同“this”指针值。但是**删除“虚拟”就可以了！**没有崩溃，并且相同的“this”指针。

我想清楚地了解到底发生了什么。非常感谢。

干杯亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T20:09:09.053

第一个示例中的虚拟继承不做任何事情。我敢打赌，如果它们被删除，它们会编译成相同的代码。

虚拟继承的类只是标记编译器，它应该合并更高版本的`Der1`or `Der2`。由于每一个都只出现在继承树中，因此没有做任何事情。虚拟对 没有影响`Base`。

```
auto p = new Join2;
static_cast<Base*>(static_cast<Der1*>(p)) !=
      static_cast<Base*>(static_cast<Der2*>(p)) 
```

虚拟继承仅影响下一个继承的类，并且仅适用于已被定义为虚拟的实例。这与您的预期相反，但它是对类编译方式的限制。

```
class A {};
class B : virtual public A {};
class C : virtual public A {};
class D : public A {};
class E : virtual public A, public B, public C, public D {};
class F : public A, public B, public C, public D {};

F::A != F::B::A or F::C::A or F::D::A
F::B::A == F::C::A
F::D::A != F::B::A or F::C::A or F::A

E::B::A == E::C::A == E::A
E::D::A != E::B::A or E::C::A or E::D::A 
```

A 必须在 C 和 B 而不是 E 或 F 中标记为虚拟的原因之一是 C 和 B 需要知道不要调用 A 的构造函数。通常他们会初始化他们的每个副本。当他们参与钻石继承时，他们不会。但是您不能重新编译 B 和 C 以不构造 A。这意味着 C 和 B 必须提前知道在不调用 A 的构造函数的情况下创建构造函数代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T20:05:30.620

我**认为**您的 COM 示例的问题在于，通过添加 virtual 关键字，您是在说所有 IOle* 接口共享一个通用的 IUnknown 实现。为了实现这一点，编译器必须创建多个 v-table，因此根据派生类的不同，您可以使用不同的“this”值。

COM 要求当您在对象上为 IUnknown 调用 IQueryInterface 时，该对象公开的**所有接口都返回****相同**的IUnknown ...此实现显然会破坏。

如果没有虚拟继承，每个 IOle* 名义上都有自己的 IUnknown 实现。但是，由于 IUnknown 是一个抽象类，并且没有任何存储编译器，并且所有 IUnknown 实现都来自 FlashContainerWnd，因此只有一个实现。

（好吧，所以最后一点听起来很弱......也许对语言规则有更好理解的人可以更清楚地解释它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-16T15:57:46.300

正如 Caspin 所说，您的第一个示例实际上并没有做任何有用的事情。然而，它将做的是添加一个 vpointer 来告诉派生类在哪里可以找到它继承的类。

这修复了您现在可能创建的任何菱形（您没有创建），但由于类结构现在不再是静态的，因此您不能再在其上使用 static_cast。我对所涉及的 API 不熟悉，但 Rob Walker 所说的 IUnkown 可能与此有关。

简而言之，当您需要*自己的*基类时应该使用正常继承，不应与“兄弟”类共享：（a 是一个容器，b，c，d 是每个都有一个容器的部分，e 组合了这些部分（不好的例子，为什么不使用组合？））

```
a  a  a
|  |  |
b  c  d <-- b, c and d inherit a normally
 \ | /
   e 
```

而虚拟继承适用于您的基类应该与他们共享的情况。（a 是车辆，b，c，d 是车辆的不同专业，e 结合了这些）

```
 a
 / | \
b  c  d <-- b, c and d inherit a virtually
 \ | /
   d 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T22:33:12.040

现在有点过时了，但我遇到过的关于 C++ 内部的最佳参考是 Lippman 的 Inside The C++ Object Model。确切的实现细节可能与编译器的输出不匹配，但它提供的理解非常有价值。

在第 96 页左右，有一个关于虚拟继承的解释，它专门解决了菱形问题。

我将留给您阅读详细信息，但基本上虚拟继承的使用需要在虚拟表中查找才能找到基类。这不是正常继承的情况，基类位置可以在编译时计算。

（上次我采取了简单的方法，只是推荐了一本书来回答堆栈溢出问题，我得到了相当多的投票，所以让我们看看这种情况是否会再次发生...... :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-10T10:52:40.787

我想我会试试你的例子。我想出了：

```
#include "stdafx.h"
#include <stdio.h>

class Base
{
public:
  virtual void say_hi(const char* s)=0;
};

class Der1 : public Base
{
public:
  virtual void d1()=0;
};

class Der2 : public Base
{
public:
  virtual void d2()=0;
};

class Join : virtual public Der1, virtual public Der2
             // class Join : public Der1, public Der2
{
public:
  virtual void say_hi(const char* s);
  virtual void d1();
  virtual void d2();
};

class Join2 : public Join
{
  virtual void d1();
};

void Join::say_hi(const char* s)
{
  printf("Hi %s (%p)\n", s, this);
}

void Join::d1()
{}

void Join::d2()
{}

void Join2::d1()
{
}

int _tmain(int argc, _TCHAR* argv[])
{
  Join2* j2 = new Join2();
  Join* j = dynamic_cast<Join*>(j2);
  Der1* d1 = dynamic_cast<Der1*>(j2);
  Der2* d2 = dynamic_cast<Der2*>(j2);
  Base* b1 = dynamic_cast<Base*>(d1);
  Base* b2 = dynamic_cast<Base*>(d2);

  printf("j2: %p\n", j2);
  printf("j:  %p\n", j);
  printf("d1: %p\n", d1);
  printf("d2: %p\n", d2);
  printf("b1: %p\n", b1);
  printf("b2: %p\n", b2);

  j2->say_hi("j2");
  j->say_hi(" j");
  d1->say_hi("d1");
  d2->say_hi("d2");
  b1->say_hi("b1");
  b2->say_hi("b2");

  return 0;
} 
```

它产生以下输出：

```
j2: 00376C10
j:  00376C10
d1: 00376C14
d2: 00376C18
b1: 00376C14
b2: 00376C18
Hi j2 (00376C10)
Hi  j (00376C10)
Hi d1 (00376C10)
Hi d2 (00376C10)
Hi b1 (00376C10)
Hi b2 (00376C10) 
```

因此，当将 Join2 转换为其基类时，您可能会得到不同的指针，但传递给 say_hi() 的 this 指针始终是相同的，几乎与预期的一样。

因此，基本上，我无法重现您的问题，因此很难回答您的真实问题。

关于 wat “virtual” 的作用，我发现[维基百科](http://en.wikipedia.org/wiki/Virtual_inheritance)上的文章很有启发性，尽管那似乎也关注钻石问题

# python - 在 Python 中使用 XML 模式进行验证

> ID：299588
> 
> 赞同：113
> 
> 时间：2008-11-18T17:59:56.850
> 
> 标签：python, xml, validation, xsd

我在另一个文件中有一个 XML 文件和一个 XML 模式，我想验证我的 XML 文件是否符合该模式。我如何在 Python 中做到这一点？

我更喜欢使用标准库的东西，但如有必要，我可以安装第三方包。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-18T18:16:53.587

我假设您的意思是使用 XSD 文件。令人惊讶的是，支持这一点的 python XML 库并不多。但是，lxml 确实如此。[使用 lxml](http://lxml.de/validation.html)检查验证。该页面还列出了如何使用 lxml 来验证其他模式类型。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2016-06-22T15:14:40.473

## Python3 中使用流行库[lxml的简单验证器示例](http://lxml.de/)

**安装lxml**

```
pip install lxml 
```

如果您收到类似*“在库 libxml2 中找不到函数 xmlCheckVersion。是否安装了 libxml2？”这样的错误。*，请先尝试执行此操作：

```
# Debian/Ubuntu
apt-get install python-dev python3-dev libxml2-dev libxslt-dev

# Fedora 23+
dnf install python-devel python3-devel libxml2-devel libxslt-devel 
```

* * *

**最简单的验证器**

让我们创建最简单的**validator.py**

```
from lxml import etree

def validate(xml_path: str, xsd_path: str) -> bool:

    xmlschema_doc = etree.parse(xsd_path)
    xmlschema = etree.XMLSchema(xmlschema_doc)

    xml_doc = etree.parse(xml_path)
    result = xmlschema.validate(xml_doc)

    return result 
```

然后编写并运行**main.py**

```
from validator import validate

if validate("path/to/file.xml", "path/to/scheme.xsd"):
    print('Valid! :)')
else:
    print('Not valid! :(') 
```

* * *

**一点OOP**

为了验证多个文件，不需要每次都创建一个*XMLSchema对象，因此：*

**验证器.py**

```
from lxml import etree

class Validator:

    def __init__(self, xsd_path: str):
        xmlschema_doc = etree.parse(xsd_path)
        self.xmlschema = etree.XMLSchema(xmlschema_doc)

    def validate(self, xml_path: str) -> bool:
        xml_doc = etree.parse(xml_path)
        result = self.xmlschema.validate(xml_doc)

        return result 
```

现在我们可以验证目录中的所有文件，如下所示：

**主文件**

```
import os
from validator import Validator

validator = Validator("path/to/scheme.xsd")

# The directory with XML files
XML_DIR = "path/to/directory"

for file_name in os.listdir(XML_DIR):
    print('{}: '.format(file_name), end='')

    file_path = '{}/{}'.format(XML_DIR, file_name)

    if validator.validate(file_path):
        print('Valid! :)')
    else:
        print('Not valid! :(') 
```

* * *

有关更多选项，请在此处阅读：[使用 lxml 进行验证](http://lxml.de/validation.html#xmlschema)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2011-04-06T12:53:52.580

至于“纯python”解决方案：包索引列表：

*   [pyxsd](http://pypi.python.org/pypi/pyxsd)，描述说它使用xml.etree.cElementTree，它不是“纯python”（但包含在stdlib中），但源代码表明它回退到xml.etree.ElementTree，所以这将被视为纯python。没有使用它，但根据文档，它确实进行了模式验证。
*   [minixsv](http://pypi.python.org/pypi/minixsv) : '一个用“纯” Python 编写的轻量级 XML 模式验证器'。然而，描述说“目前支持 XML 模式标准的一个子集”，所以这可能还不够。
*   [XSV](http://pypi.python.org/pypi/XSV)，我认为它用于 W3C 的在线 xsd 验证器（它似乎仍然使用旧的 pyxml 包，我认为它已不再维护）

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2018-09-13T09:30:12.083

[您可以使用xmlschema Python 包](https://xmlschema.readthedocs.io/en/latest/usage.html)轻松地根据 XML 模式 (XSD) 验证 XML 文件或树。它是纯 Python，可在[PyPi](https://pypi.org/project/xmlschema/#description)上使用，并且没有太多依赖项。

示例 - 验证文件：

```
import xmlschema
xmlschema.validate('doc.xml', 'some.xsd') 
```

如果文件未针对 XSD 进行验证，则该方法会引发异常。然后，该异常包含一些违规细节。

如果要验证多个文件，只需加载 XSD 一次：

```
xsd = xmlschema.XMLSchema('some.xsd')
for filename in filenames:
    xsd.validate(filename) 
```

如果您不需要异常，您可以像这样进行验证：

```
if xsd.is_valid('doc.xml'):
    print('do something useful') 
```

或者，xmlschema 直接作用于文件对象和内存 XML 树（使用 xml.etree.ElementTree 或 lxml 创建）。例子：

```
import xml.etree.ElementTree as ET
t = ET.parse('doc.xml')
result = xsd.is_valid(t)
print('Document is valid? {}'.format(result)) 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-12-22T12:54:33.477

[http://pyxb.sourceforge.net/](http://pyxb.sourceforge.net/)上的 PyXB 包从 XML 模式文档生成 Python 的验证绑定。它处理几乎所有模式构造并支持多个命名空间。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2015-08-26T13:51:27.637

有两种方法（实际上还有更多）可以做到这一点。
1.使用[lxml](http://lxml.de/)
`pip install lxml`

```
from lxml import etree, objectify
from lxml.etree import XMLSyntaxError

def xml_validator(some_xml_string, xsd_file='/path/to/my_schema_file.xsd'):
    try:
        schema = etree.XMLSchema(file=xsd_file)
        parser = objectify.makeparser(schema=schema)
        objectify.fromstring(some_xml_string, parser)
        print "YEAH!, my xml file has validated"
    except XMLSyntaxError:
        #handle exception here
        print "Oh NO!, my xml file does not validate"
        pass

xml_file = open('my_xml_file.xml', 'r')
xml_string = xml_file.read()
xml_file.close()

xml_validator(xml_string, '/path/to/my_schema_file.xsd') 
```

2.  从命令行使用[xmllint](http://xmlsoft.org/xmllint.html)。xmllint 安装在许多 Linux 发行版中。

`>> xmllint --format --pretty 1 --load-trace --debug --schema /path/to/my_schema_file.xsd /path/to/my_xml_file.xml`

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-18T18:09:40.027

lxml 提供 etree.DTD

从[http://lxml.de/api/lxml.tests.test_dtd-pysrc.html上的测试](http://lxml.de/api/lxml.tests.test_dtd-pysrc.html)

```
...
root = etree.XML(_bytes("<b/>")) 
dtd = etree.DTD(BytesIO("<!ELEMENT b EMPTY>")) 
self.assert_(dtd.validate(root)) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-06-23T07:37:24.943

```
import xmlschema

def get_validation_errors(xml_file, xsd_file):
    schema = xmlschema.XMLSchema(xsd_file)
    validation_error_iterator = schema.iter_errors(xml_file)
    errors = list()
    for idx, validation_error in enumerate(validation_error_iterator, start=1):
        err = validation_error.__str__()
        errors.append(err)
        print(err)
    return errors

errors = get_validation_errors('sample3.xml', 'sample_schema.xsd') 
```

# java - 简单的 jdbc 包装器

> ID：299597
> 
> 赞同：14
> 
> 时间：2008-11-18T18:03:53.813
> 
> 标签：java, jdbc, data-access, spring-jdbc

为了在我们的应用程序中实现数据访问代码，我们需要一些框架来包装 jdbc（ORM 不是我们的选择，因为可扩展性）。

我曾经使用过的最酷的框架是[Spring-Jdbc](http://static.springframework.org/spring/docs/2.5.x/reference/jdbc.html)。但是我公司的策略是避免外部依赖，尤其是spring，J2EE等。所以我们正在考虑写自己的手办jdbc框架，功能类似于Spring-jdbc：行映射，错误处理，支持java5的特性，但没有事务支持。

有没有人有编写这样的 jdbc 包装器框架的经验？如果有人有使用其他 jdbc 包装器框架的经验，请分享您的经验。

提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-18T19:13:17.450

我们编写了自己的包装器。这个话题值得写一篇论文，但我怀疑我是否有时间写它，所以这里有一些关键点：

*   我们接受了 sql，并没有试图隐藏它。唯一的调整是添加对命名参数的支持。参数很重要，因为我们不鼓励使用 on-the-fly sql（出于安全原因）并且我们总是使用 PreparedStatements。

*   对于连接管理，我们使用了 Apache DBCP。这在当时很方便，但目前还不清楚现代 JDBC 实现需要多少这样的东西（缺少关于这些东西的文档）。DBCP 还汇集 PreparedStatements。

*   我们没有打扰行映射。相反（对于查询），我们使用了类似于 Apache dbutil 的 ResultSetHandler 的东西，它允许您将结果集“提供”到一个方法中，然后该方法可以将信息转储到您想要的任何地方。这更灵活，实际上为行映射实现 ResultSetHandler 并不难。对于插入/更新，我们创建了一个通用记录类（基本上是一个带有一些额外花里胡哨的哈希图）。行映射（对我们而言）最大的问题是，一旦您执行“有趣”的查询，您就会陷入困境，因为您可能有映射到不同类的字段；因为你可能有一个分层的类结构但是一个扁平的结果集；或者因为映射很复杂并且依赖于数据。

*   我们内置了错误记录。对于异常处理：在查询中我们捕获并记录，但对于更新，我们捕获、记录并重新抛出未经检查的异常。

*   我们使用包装器方法提供事务支持。调用者提供执行事务的代码，我们确保事务得到妥善管理，不会忘记完成事务，并且内置回滚和错误处理。

*   稍后，我们添加了一个非常简单的关系方案，它允许单个更新/插入应用到记录及其所有依赖项。为简单起见，我们没有在查询中使用它，我们特别决定不支持删除，因为使用级联删除更可靠。

迄今为止，该包装器已成功用于两个项目。它当然是轻量级的，但现在每个人都说他们的代码是轻量级的。更重要的是，它提高了程序员的工作效率，减少了错误的数量（并使问题更容易追踪），并且如果需要的话，它也相对容易追踪，因为我们不相信为了提供漂亮的架构而添加很多层。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T18:28:50.723

Spring-JDBC 非常棒。考虑到像 Spring 这样的开源项目，外部依赖的负面影响最小化。您可以采用满足您的 JDBC 抽象要求的最稳定的 Spring 版本，并且您知道，如果遇到问题，您将始终能够自己修改源代码——而不依赖于外部方。您还可以通过外部方编写的代码检查您的组织可能存在的任何安全问题的实施。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T18:30:45.560

我更喜欢的一个：[Dalesbred](http://dalesbred.org/)。它是麻省理工学院许可的。

获取自定义类（部门）的所有行的简单示例。

```
List<Department> departments = db.findAll(Department.class,
    "select id, name from department"); 
```

当自定义类定义为：

```
public final class Department {
    private final int id;
    private final String name;

    public Department(int id, String name) {
        this.id = id;
        this.name = name;
    }
} 
```

免责声明：这是由我工作的公司提供的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-17T11:46:54.023

[`JdbcSession`](http://jdbc.jcabi.com/apidocs-0.12.1/com/jcabi/jdbc/JdbcSession.html)从[jcabi-jdbc](http://jdbc.jcabi.com/)尝试。它就像 JDBC 一样简单，例如：

```
String name = new JdbcSession(source)
  .sql("SELECT name FROM foo WHERE id = ?")
  .set(123)
  .select(new SingleOutcome<String>(String.class)); 
```

就是这样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-17T12:08:49.090

这听起来像是一个非常短视的决定。考虑开发/维护这样一个框架的成本，特别是当你可以得到它时，它是免费的源代码。您不仅不必自己进行开发，还可以根据需要随意修改它。

话虽如此，您真正需要复制的是 JdbcTemplate 的概念及其回调（PreparedStatementCreator、PreparedStatementCallback）以及 RowMapper/RowCallbackHandler。编写这样的东西不应该过于复杂（特别是考虑到您不必进行事务管理）。

但是，正如我所说，当您可以免费获得它并根据您认为合适的方式修改源代码时，为什么还要编写它呢？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-13T16:18:13.620

mJDBC：[https ://mjdbc.github.io/](https://mjdbc.github.io/)

我使用它多年，发现它非常有用（我是这个库的作者）。

它受到 JDBI 库的启发，但没有依赖项，增加了事务支持，提供性能计数器，并允许在您真正需要时轻松切换到 Java 中可能的最低 SQL 级别（旧的普通 JDBC API）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-27T13:35:39.413

# 杰杜

有一个名为[Jedoo](https://github.com/pwwiur/Jedoo)的包装类，它使用数据库连接池和单例模式将其作为共享变量进行访问。它有很多功能可以快速运行查询。

## 用法

要使用它，您应该将它添加到您的项目中并将其单例加载到 java 类中：

```
import static com.pwwiur.util.database.Jedoo.database; 
```

使用它也很容易：

```
if(database.count("users") < 100) {
    long id = database.insert("users", new Object[][]{
        {"name", "Amir"},
        {"username", "amirfo"}
    });

    database.setString("users", "name", "Amir Forsati", id);

    try(ResultSetHandler rsh = database.all("users")) {
         while(rsh.next()) {
             System.out.println("User ID:" + rsh.getLong("id"));
             System.out.println("User Name:" + rsh.getString("name"));
         }
    }
} 
```

您还可以在上面链接的文档中找到一些有用的功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-18T17:42:59.473

试试我的图书馆作为替代方案：

```
<dependency>
  <groupId>com.github.buckelieg</groupId>
  <artifactId>jdbc-fn</artifactId>
  <version>0.2</version>
</dependency> 
```

更多信息[在这里](https://buckelieg.github.io/jdbc-fn/)

# flash - Flash 截图

> ID：299600
> 
> 赞同：1
> 
> 时间：2008-11-18T18:06:13.857
> 
> 标签：flash, image-processing, actionscript-2

我们正在尝试将大型 SWF 文件的图像发送到服务器以将其邮寄出去，但我们在传输时间方面遇到了一些问题。

SWF 大约为 900 像素 x 600 像素，并且仅限于 AS2，因此我们一直在使用这个 Bitmap Exporter 类。我们尝试了几种不同的方式来传输数据；base10、base36 和 base128，但它们都不会及时发送文件。

现在我们正在处理每张图像 60-120 秒，这是不可接受的。

有没有人对处理此类或其他类以将大型位图数据发送到具有闪存的服务器有任何建议？

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T23:26:09.327

您获得如此长的上传时间的原因是图像几乎没有压缩（或根本没有压缩，具体取决于类的实现方式）。900 x 600 像素，16 bpp（或现在使用的任何闪存）相当于 1.5mb 的原始数据。

我怀疑 AS2 是否有任何有用的压缩库，但这**可能**是一条可能的路径。

在客户端缩小图像的最简单方法是降低分辨率。一旦到达服务器，您是否使用完整分辨率？如果不是，那可能是一种可能的方式。

（我想您知道使用 AS3 会更容易，然后您可以毫不费力地将整个图像压缩为 jpeg 客户端，但我猜您的应用程序的其余部分是 AS2，这有点没有实际意义）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T04:40:03.750

您也可以尝试使用 amfphp，因为它允许在向服务器发送数据时进行二进制序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:46:05.300

您可能希望在 AS2 中实现一个简单的 RLE 算法（如果尚不存在）来压缩位图。假设你有很好的纯色矢量元素，RLE 应该提供很好的压缩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T20:03:57.220

as3 有几个很好的 JPEG 压缩类，我使用的是谷歌：[http ://code.google.com/p/as3corelib/](http://code.google.com/p/as3corelib/)

您也许可以将其移植到 as2 ...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T03:12:46.420

只需快速浏览并链接 - [http://www.gskinner.com/blog/archives/2006/03/saving_bitmapda.html](http://www.gskinner.com/blog/archives/2006/03/saving_bitmapda.html)

编辑 - 这也可能有帮助！[http://www.5etdemi.com/blog/archives/2006/10/the-ultimate-as2-bitmapdata-saving-solution/](http://www.5etdemi.com/blog/archives/2006/10/the-ultimate-as2-bitmapdata-saving-solution/)

Grant Skinner 建议将图像数据下采样到较小的调色板，然后进行一些运行时压缩（他倾向于压缩 UTF-8 字符串，然后在其他地方处理图像转换，我想是服务器）

UltimateBrent 与 JPEG 压缩库的链接听起来是一个不错的想法，即使在技术上没有挑战性。

调色板深度是个问题吗？有损压缩？

您可以将一堆变量发送到服务器，在本地运行的 swf 上重新创建图像，然后将其导出到那里吗？还是变量太多（例如在绘画类型程序中）？比如说，如果它是一种制作你自己的头像之类的东西，你也许可以将设置转换为 XML 并从服务器上生成图像。不知道！

# windows - 如何在不重新启动的情况下卸载 Windows 服务并删除其文件

> ID：299604
> 
> 赞同：46
> 
> 时间：2008-11-18T18:06:43.997
> 
> 标签：windows, scripting, windows-services, operating-system, filesystems

我当前的项目涉及部署作为 Windows 服务运行的升级的 .exe 文件。为了用新版本覆盖现有的 .exe，我目前需要：

1.  停止服务
2.  卸载服务
3.  重新启动系统（因此 Windows 释放它对文件的保留）
4.  部署新的 .exe
5.  重新安装服务
6.  启动升级服务。

我想避免重新启动，以便这可以是完全脚本化/自动升级。

有什么办法可以避免重启？也许是一个命令行工具会迫使 Windows 放弃它对旧 .exe 的死控制？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-11-19T13:47:39.387

```
sc delete "service name" 
```

将删除服务。我发现[sc 实用程序](http://technet.microsoft.com/en-us/library/bb490995.aspx)比寻找 installutil 更容易找到。如果您还没有停止服务，请记住停止服务。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-09T16:15:26.190

我遇到了和你一样的问题。我有一个系统服务，我想卸载它，然后作为更新的一部分重新安装。在某些系统上，如果不重新启动，这将无法工作。问题是对 DeleteService() 的调用会返回 ok，但对 CreateService() 的以下调用会告诉我该服务仍然存在，但标记为删除（错误代码 1072）。注册表会反映这一点，因为子项仍然存在（在 HKLM\System\CurrentControlSet\Services 下），但“DeleteFlag”设置为 1。从那时起，只有重新启动才能解决此问题。

一些不起作用的东西：

*   使用“sc delete”：它和我有同样的问题。调用会返回正常，但服务并没有真正消失，仍然在注册表中，DeleteFlag = 1。
*   删除注册表中的键。服务管理器似乎在内存中保留了一个数据库，而注册表只是它的一个副本，用于下次启动。
*   添加等待循环、等待 .exe 文件准备好被覆盖、终止进程等。
*   关闭服务的句柄。哪个？？

但这是有效的：

我在 stackoverflow 上的一些文章中注意到 net.exe 也具有启动/停止功能（我只知道 sc.exe 实用程序）。奇怪的是，“net stop svcname”加上“sc delete svcname”起作用了！所以 net.exe 必须做一些我不做的事情。

但是 net.exe 不包含对 ControlService() 的导入，那么它如何停止服务呢？我发现 net.exe 生成 net1.exe，但 net1.exe 也不导入 ControlService()。我使用了很棒的 AP​​I Monitor 实用程序 ( [http://www.rohitab.com/apimonitor](http://www.rohitab.com/apimonitor) ) 来查看 net1.exe 正在做什么，但它从来没有调用任何看起来很有希望的东西。

但后来我看到它从 NETAPI32.DLL 导入 NetServiceControl()（它的名称中至少有“服务”！）。MSDN 说这个功能已经过时了。尽管如此，我还是在 LMSvc.h 中找到了原型，并在此处找到了一些参数说明：http: [//cyberkinetica.homeunix.net/os2tk45/srvfpgr/369_L2_NetServiceControlorN.html](http://cyberkinetica.homeunix.net/os2tk45/srvfpgr/369_L2_NetServiceControlorN.html)。当您加载 NETAPI32.DLL 并使用`NetServiceControl(NULL, service_name, 3, 0, 0)`（3 用于 SERVICE_CTRL_UNINSTALL，用于停止）后，该服务将停止。并且可以在没有DeleteFlag或重新启动的情况下删除并重新安装！

因此，删除问题从来都不是问题，而是正确停止服务的问题。NetServiceControl() 可以解决问题。对不起，很长的帖子，但我认为它可能会帮助有类似问题的人。（仅供参考，我使用的是 Win7 SP1 x64。）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-18T18:10:36.563

您是否无法使用以下命令在更新之前停止服务（并在更新后重新启动）？

```
net stop <service name>
net start <service name> 
```

每当我测试/部署服务时，只要服务停止，我就可以上传文件而无需重新安装。我不确定您遇到的问题是否有所不同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-18T18:28:30.833

如果在 .net 中（我不确定它是否适用于所有 Windows 服务）

*   停止服务（这可能是您遇到问题的原因。）
*   InstallUtil -u [可执行文件的名称]
*   Installutil -i [可执行文件的名称]
*   再次启动服务...

除非我更改服务的公共接口，否则我经常部署我的服务的升级版本，甚至没有卸载/重新安装......我所做的就是停止服务，替换文件并再次重新启动服务......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T17:31:37.780

正如 StingyJack 和 mcbala 所指出的，并参考 Mike L 的评论，我的经验是，在 Windows 2000 机器上，当卸载/重新安装 .Net 服务时，“installutil /u”**确实**需要重新启动，即使该服务是之前停了。另一方面，“sc /delete”不需要重新启动 - 它会立即删除服务（只要它停止）。

实际上，我经常想知道“installutil / u”是否有充分的理由需要重新启动......“sc / delete”实际上是在做错什么/让某些东西挂起吗？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-18T18:41:19.950

乔纳森和查尔斯都是对的……你必须先停止服务，然后卸载/重新安装。将他们的两个答案结合起来可以制作完美的批处理文件或 PowerShell 脚本。

我将提到一个通过艰难的方式学到的警告——Windows 2000 Server（也可能是客户端操作系统）无论如何都需要在重新安装之前重新启动。必须有一个注册表项在重新启动框之前未完全清除。Windows Server 2003、Windows XP 和更高版本的操作系统不会遭受这种痛苦。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-19T13:25:55.717

> （所以 Windows 发布它保留在文件上）

相反，在服务停止后立即执行 Ctrl+Alt+Del 并终止服务的 .exe。比，您可以在不重新启动的情况下卸载该服务。这过去发生在我身上，它解决了您需要重新启动的部分。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-09-22T15:46:37.060

如果需要手动删除服务：

1.  运行 Regedit 或 regedt32。
2.  在以下项下找到您的服务的注册表项：HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services
3.  删除注册表项

在服务中更新列表之前，您必须重新启动

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-17T06:48:29.580

我正在使用与 .NET Framework 一起打包的 InstallUtil.exe。

卸载的用法是：InstallUtil '\path\to\assembly\with\the\installer\classes' /u 例如：`installutil MyService.HostService.exe /u`

该`/u`开关代表卸载，没有它，实用程序将执行服务的正常安装。如果该实用程序正在运行，该实用程序将停止该服务，并且我从未遇到过 Windows 锁定服务文件的问题。[您可以在MSDN](http://msdn.microsoft.com/cs-cz/library/50614e95%28v=vs.110%29.aspx)上阅读有关 InstallUtil 的其他选项的信息。

PS：如果您的路径变量中没有 installutil，请使用如下完整路径：`C:\Windows\Microsoft.NET\Framework\v4.0.30319\InstallUtil.exe "C:\MyServiceFolder\MyService.HostService.exe" /u` 或者如果您需要 64 位版本，可以在 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\' 中找到。版本路径中的数字因 .NET 版本而异。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-09T17:52:53.847

我的批处理文件停止和删除服务

```
@echo off
title Service Uninstaller
color 0A
set blank=
set service=blank
:start
echo.&echo.&echo.
SET /P service=Enter the name of the service you want to uninstall:  

IF "%service%"=="" (ECHO Nothing is entered
GoTo :start)
cls
echo.&echo.&echo We will delete the service: %service%
ping -n 5 -w 1 127.0.0.1>nul
::net stop %service%
ping -n 2 -w 1 127.0.0.1>nul
sc delete %service%
pause
:end 
```

# java - Java：将 char[] 转换为 CharSequence

> ID：299606
> 
> 赞同：25
> 
> 时间：2008-11-18T18:07:42.373
> 
> 标签：java, string

`char[]`将 a 转换为 a的最直接和/或有效的方法是`CharSequence`什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-18T18:13:30.630

没有副本：

```
CharSequence seq = java.nio.CharBuffer.wrap(array); 
```

然而，这种`new String(array)`方法可能更容易编写、更容易阅读和更快。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-18T18:09:20.480

A`String`是一个`CharSequence`。所以你可以创建一个新的`String`给定你的`char[]`.

```
CharSequence seq = new String(arr); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-12-17T10:48:03.617

**语境：**

char[] 而不是 String 的最常见用法之一是“临时”存储机密/密码。将它传递给一些服务/客户端的初始化......在这样的初始化之后不需要 sercrets。但是在java中字符串是不可能从内存中清除的（手动也不是垃圾收集）......*所以，基本上禁止在字符串中存储秘密。*

推荐方式：将秘密加载到 char[]，将其传递给 init 进程，然后手动清除（设置 forEach char[i] = '0';）。在专门的博客上阅读有关此问题的信息...

**问题/答案：**

*   如果 service/cliets API 只接受 pass/secret 作为字符串 - 不要使用它（并报告错误）
*   如果 service/cliets API 接受 char 数组，使用它并清除它
*   如果服务/客户端 API 接受 CharSequence，则可以使用 java.nio.CharBuffer.wrap(array) 并在之后清除

注意：不幸的是，甚至必须检查 3rd 方服务/客户端初始化源代码，碰巧他们将 char 数组转换为代码深处的字符串...）-：明智地选择您的依赖项。

# .net - 用于调试的健壮错误消息中应该包含什么？

> ID：299608
> 
> 赞同：2
> 
> 时间：2008-11-18T18:08:25.927
> 
> 标签：.net, debugging, error-handling

除了通知用户之外，我们还希望收集信息用于调试目的。我们的系统是一个只有大约 1400 名客户的小众系统，因此我们的资金并不如我们希望的那样充足，因此错误比我们希望的更常见。我们目前有一个窗口，以较大的字体显示错误消息的第一行，黄色背景以吸引用户的眼球，其下方的文本框中带有灰色背景的可怕部分。还有一个按钮可以将所有内容放在复制缓冲区中以发送给客户支持。我们试图访问的消息由 exception.Message、堆栈跟踪的最后五个部分以及导致错误的方法的名称 (Reflection.MethodBase) 组成。我们计划增加用户说出他当时在做什么的能力，可能还有一个单选按钮，指示这种情况发生的频率，并将其写入日志文件。我们还应该包括哪些其他有用的信息？

我们也在考虑通过电子邮件将其发送给客户支持，但如果电子邮件失败，我们不会强调。电子邮件还有其他注意事项 - 客户支持可能会淹没其中，用户可能会反对，因为我们也会发送系统信息等。

我在 SO 上发现了两个类似的问题，但它们并没有真正关注我感兴趣的内容。[错误消息文本 - 最佳实践](https://stackoverflow.com/questions/117083/error-message-text-best-practices)处理如何为用户制作有用的消息，[处理错误消息的最佳方法处理](https://stackoverflow.com/questions/116542/best-way-to-handle-error-messages)哪里保留错误 ID 与错误文本。我对调试更感兴趣（因为不幸的是我们的系统确实有很多错误）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T18:14:53.403

如果您最终包含自动电子邮件提交，请将它们发送到新邮箱，以便您可以过滤它们并路由它们，而不会干扰现有的客户支持人员。

除此之外，包括以下内容可能很有用：

*   如果您有多个版本的产品浮动，则错误消息中的软件版本号。
*   UTC 日期/时间
*   操作系统/浏览器/环境/等。（任何相关的）
*   用户的安全角色、登录等。
*   跟进用户的联系信息（电话、电子邮件等）
*   错误屏幕上的您的联系信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T20:22:17.733

我们使用以下方法获取系统指标。我们还记录用户/机器数据和堆栈。

```
string _osSql = @"SELECT * FROM Win32_OperatingSystem";
string _metric = string.Format("Metric Data:{0}", Environment.NewLine);

foreach (Screen _screen in Screen.AllScreens)
{
    if (_screen.Primary == true)
    {
        _metric += "Primary";
    }

    _metric += string.Format("Screen: Width:={0}, Height:={1}{2}", Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height, Environment.NewLine);
}

ManagementObjectSearcher _mgmt = new ManagementObjectSearcher(_osSql);

foreach (ManagementObject _o in _mgmt.Get())
{
    _metric += string.Format("OS:={0} - {1}{2}", _o.Properties["Caption"].Value.ToString(), _o.Properties["CSDVersion"].Value.ToString(), Environment.NewLine);
    _metric += string.Format("Memory  Total:={0}, Available:={1}{2}", _o.Properties["TotalVisibleMemorySize"].Value.ToString(), _o.Properties["FreePhysicalMemory"].Value.ToString(), Environment.NewLine);
    _metric += string.Format("Description:={0}{1}", _o.Properties["Description"].Value.ToString(), Environment.NewLine);
    _metric += string.Format("TotalVisibleMemorySize:={0}{1}", _o.Properties["TotalVisibleMemorySize"].Value.ToString(), Environment.NewLine);
    _metric += string.Format("FreePhysicalMemory:={0}{1}", _o.Properties["FreePhysicalMemory"].Value.ToString(), Environment.NewLine);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T22:08:38.297

我记录用户的输入（针对每个请求）、应用程序的当前状态（从本地变量到抛出代码）、错误消息和简短的堆栈跟踪（针对意外错误）。但是，出于安全原因，我只发送“客户友好”（公司批准）错误消息，其中包括一些纠正建议、联系信息和错误 ID（详细日志条目的 UUID）。

# php - 如何通过 ajax 将数组发送到 php？

> ID：299610
> 
> 赞同：25
> 
> 时间：2008-11-18T18:09:27.190
> 
> 标签：php, ajax, multiple-select

我想发送一个用 javascript 构造的数组，其中包含多项选择的选定值。有没有办法使用 ajax 将此数组发送到 php 脚本？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-10-22T10:23:14.230

您可以使用 jQuery 的 $.post 方法来做到这一点（例如）：

```
var myJavascriptArray = new Array('jj', 'kk', 'oo');

$.post('urltocallinajax', {'myphpvariable[]': myJavascriptArray }, function(data){
   // do something with received data!
}); 
```

PHP 将收到一个名为**myphpvariable**的数组，它将包含 myJavascriptArray 值。

是那个吗 ？

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-18T18:15:29.843

您可以使用 XML 或 JSON 回发到您的服务器。您的 javascript 必须构建帖子，在 XML 的情况下需要您在 javascript 中创建它。JSON 不仅轻量级，而且更容易用 javascript 制作。查看[JSON-PHP](http://mike.teczno.com/json.html)以解析 JSON。

您可能想看看[在 PHP 中创建 JSON 数据](http://extjs.com/learn/Tutorial:Creating_JSON_Data_in_PHP)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T18:54:19.190

IIRC，如果 PHP 看到一个看起来像 的查询字符串`http://blah.com/test.php?var[]=foo&var[]=bar&var[]=baz`，它会自动创建一个名为的数组`$var`，其中包含 foo、bar 和 baz。我认为您甚至可以在查询字符串的方括号中指定数组索引，它会将值粘贴在该索引中。您可能需要对括号进行 URL 编码...使用此功能的通常方式是创建一个名为“var[]”的 HTML 输入字段，因此只需执行浏览器通常在那里执行的任何操作。PHP 文档中有一个关于通过请求的数组变量的部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T18:20:30.257

您可能正在寻找一种对数据进行[序列化](http://docs.jquery.com/Ajax/serialize)（jQuery 版本）的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-02T11:02:53.967

[jQuery 1.4](http://jquery14.com/day-01/jquery-14#backwards)更新为使用 PHP 语法发送数组。您可以使用以下方法将其切换为旧样式：

这是语法：

```
jQuery.ajaxSetting.traditional = true; 
```

这是示例

```
$.ajax({    
 traditional: true,
 type: "post",
 url: myURL,
 dataType: "text", 
 data: dataToSend, //this will be an array eg. 
 success: function(request) {
  $('#results').html(request);
 }  // End success
 }); // End ajax method 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T12:19:48.980

您可以按照 Meador 的建议创建一个数组并发送它：（以下代码是 Mootooled，但在其他库/普通旧 JS 中类似）

```
myArray.each(function(item, index)  myObject.set('arrayItems['+index+']', item);
myAjax.send(myObject.toQueryString()); 
```

这将向 php 发送一个名为 arrayItems 的数组，可以通过 $_POST['arrayItems'] 访问该数组

```
echo $_POST['arrayItems'] ; 
```

会回显类似：array=>{[0]=>'first thing', [1]=> second thing}

# objective-c - 是否有用于 gSOAP 的 Objective-C 包装器？

> ID：299617
> 
> 赞同：3
> 
> 时间：2008-11-18T18:11:10.510
> 
> 标签：objective-c, cocoa, word-wrap, gsoap

我将在我的 Mac 项目中使用 gSOAP 与 WCF Web 服务进行交互。它几乎完全符合我的需要并且做得很好（与 WSMakeStubs 完全相反；））。唯一的缺点是它只是 C/C++，这意味着我要么需要将我的所有类型即时转换为 C 类型，要么编写一个完整的包装解决方案来为我做这件事。

我宁愿不在这里重新发明轮子，而且我[显然](http://blog.phanfare.com/2005/10/web-service-integration-mac-vs-pc/)不是[唯一](http://markmail.org/message/26pp6uumbgloo6hn#query:gSOAP%20objective-C+page:1+mid:adprnpvfghqzmeoy+state:results) [一个](http://www.cocoabuilder.com/archive/message/cocoa/2005/3/14/130417)想要这样做的人，但到目前为止，我还没有找到任何人实际上已经发布了任何代码。

有没有人知道任何可用的代码可以让我不必自己编写整个事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T22:10:37.343

（它不能完全回答您的问题，但是）我使用了[Cocoa SOAP Client](http://ditchnet.org/soapclient/)（开源）中使用的技术来连接到服务器并发送/接收 SOAP 请求。它工作得非常好，除非您使用自签名 SSL 证书连接到服务器。

（这基本上将 XML 结构转换为本地 Cocoa 结构，并在发送时以另一种方式返回）。

我们在工作中使用 gSOAP，它可以完成这项工作，但会生成大量代码，并限制您以特定方式处理数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T16:37:50.977

我正在开发一个包装器生成器（或者可能对 gSOAP 本身进行修改以回馈）；我还没有完成，也不会有一段时间。

> 注意：我是你联系到的人之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-25T23:10:16.583

我会说当前的答案是“否”。

我最终为我的 Web 服务手动创建了一个 Objective-C 包装器（包括 NSArray 的类别方法，用于将 X 的 NSArray 转换为 X 的肥皂数组，反之亦然，等等），因为它是一次性的，我做到了不要指望它会特别频繁地改变。我对此很满意，但是每当更改签名或添加方法时，我确实需要手动修改它。

# java - 获取Eclipse中当前编辑文件的绝对路径

> ID：299619
> 
> 赞同：17
> 
> 时间：2008-11-18T18:12:00.023
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-api

我想编写一个插件来处理 Eclipse 中当前编辑的文件。但我不确定如何正确获取文件的完整路径。

这就是我现在所做的：

```
IFile file = (IFile) window.getActivePage().getActiveEditor.getEditorInput().
    getAdapter(IFile.class); 
```

现在我有一个 IFile 对象，我可以检索它的路径：

```
file.getFullPath().toOSString(); 
```

然而，这仍然只给了我相对于工作空间的路径。我怎样才能从中获得绝对路径？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-18T18:15:50.030

看起来像你想要[`IResource.getRawLocation()`](http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fcore%2Fresources%2FIResource.html)的。这将返回一个，如果你想加倍确定你有一个绝对路径`IPath`，它也有一个方法。`makeAbsolute()`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-02T23:50:20.520

我认为对 Java 更友好的解决方案是使用以下内容：

```
IResource.getLocation().toFile() 
```

这利用了 IPath API（getLocation() 部分）并将返回一个 java.io.File 实例。当然，其他答案可能也会让你到达你想去的地方。

顺便说一句，`(org.eclipse.ui.ide.IDE)`当涉及到编辑器时，我发现 IDE 类是一个有用的实用资源。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-02-15T19:08:25.707

对我有用的答案（我测试了它！）是：

```
// Get the currently selected file from the editor
IWorkbenchPart workbenchPart = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage().getActivePart(); 
IFile file = (IFile) workbenchPart.getSite().getPage().getActiveEditor().getEditorInput().getAdapter(IFile.class);
if (file == null) throw new FileNotFoundException();
String path = file.getRawLocation().toOSString();
System.out.println("path: " + path); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T17:23:37.297

我通常调用返回 IPath 的 IFile.getLocation()，然后调用 IPath.toOSString()。

```
file.getLocation().toOSString() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T14:22:35.580

```
IWorkspace ws      = ResourcesPlugin.getWorkspace();  
IProject   project = ws.getRoot().getProject("*project_name*");

IPath location = new Path(editor.getTitleToolTip());  
IFile file     = project.getFile(location.lastSegment());

into file.getLocationURI() it's the absolute path 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-04-02T20:32:56.853

对我来说，这个运行还可以。

IWorkspaceRoot workSpaceRoot = ResourcesPlugin.getWorkspace().getRoot();

文件文件 = workSpaceRoot.getRawLocation().makeAbsolute().toFile();

此位置的文件列表：

文件[] 文件 = file.listFiles();

# html - 是否有一个有效的 html css 规范化器？

> ID：299620
> 
> 赞同：0
> 
> 时间：2008-11-18T18:12:05.997
> 
> 标签：html, css, normalize

很久以前，我写了一个样式“规范器”程序来扫描一大堆经典 ASP 页面的 ASP/HTML 代码（其中大部分最初是从 MS-Word 文档生成的，所以自然而然地到处都是多余的样式表和大量的样式表） -off 样式）。样式规范器生成了一组最小的样式表和样式以及一个新的“净化”asp/html 文档，因此净化后的文档产生与原始文件完全相同的渲染输出（通过屏幕截图图像比较验证）。

时不时地，我遇到对这样一个程序的需求，并且正在考虑编写一个用于商业发布的想法。

我的谷歌搜索技能并没有完全像这样出现（HTML：Normalize Perl 模块和 HTML Tidy 项目似乎只是清理标签）。

所以，我的问题是：

1.  是否已经有这样的工具，商业或其他？
2.  如果没有，真的有人需要吗？
3.  如果是这样，哪些功能会让它真正值得？

例如，关于#3，为一组页面收集基本样式表，或调整所有页面以使用给定的基本样式表；保留经典的 asp 命令，遵循#includes，保留 asp.net 嵌入式脚本等。越具体、越多越好。

示例：
带有嵌入标签的旧 html

```
<html><head>
<title>title</title>
<style type='css/text'>
.cls1 { font-family: arial; font-size: 10px; font-weight: bold; }
</style>
</head>
<body>
<% somefunction() %>
<div class='cls1' style='font-size:10px;'>test div</div>
</body>
</html> 
```

新的 html

```
<html><head>
<title>title</title>
<style type='css/text'>
.cls1 { font-family: arial; font-size: 10px; font-weight: bold; }
</style>
</head>
<body>
<% somefunction() %>
<div class='cls1'>test div</div>
</body>
</html> 
```

请注意，div 上的样式已经消失，因为它与 cls1 类是多余的

编辑：删除了“消毒剂”一词，因为我不专注于 XSS 攻击或过滤评论中的输入，而只是将许多临时样式和随机 CSS 类整合到一组最小的连贯样式表中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T20:42:42.590

好吧，我不能肯定地说这对所描述的所有内容都“有效”，但 Tidy 所做的不仅仅是清理标签。

请参阅[HTML Tidy Configuration Options](http://tidy.sourceforge.net/docs/quickref.html)，尤其是那些与 Microsoft Word 相关的（如[word-2000](http://tidy.sourceforge.net/docs/quickref.html#word-2000)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-21T00:50:31.247

如果你想知道你是否做了一个合理的工作，你应该尝试[这些测试](http://htmlpurifier.org/live/smoketests/xssAttacks.php)（使用像 Tidy 这样的东西你可能会发现你没有做一个合理的工作）。

一些选项：

*   [PHP 中的 HTML 净化器](http://htmlpurifier.org/)
*   [Python 中的 lxml.html.clean](http://codespeak.net/svn/lxml/trunk/src/lxml/html/clean.py)
*   [feedparser 在 Python 中有一个积极的清理器](http://www.feedparser.org/)
*   [Perl 中的 LiveJournal 代码](http://code.sixapart.com/trac/livejournal/browser/trunk/cgi-bin/cleanhtml.pl)

任何使用正则表达式并且不解析标记的东西在我看来都是可疑的（而且实现起来太复杂了）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-08T18:27:09.490

老问题，但有些人可能仍然觉得这很有用。查看[http://necolas.github.com/normalize.css/](http://necolas.github.com/normalize.css/)。它运作良好！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-21T01:24:02.567

不要忘记美丽的汤

[如何修复错误嵌套/未闭合的 HTML 标签？](https://stackoverflow.com/questions/293482/how-do-i-fix-wrongly-nested-unclosed-html-tags)

# http - HTTP DELETE 请求是否允许实体主体？

> ID：299628
> 
> 赞同：896
> 
> 时间：2008-11-18T18:14:26.727
> 
> 标签：http, rest

发出 HTTP DELETE 请求时，请求 URI 应完全标识要删除的资源。但是，是否允许在请求的实体主体中添加额外的元数据？

* * *

## 回答 #1

> 赞同：712
> 
> 时间：2008-11-18T18:36:11.877

[该规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)没有明确禁止或阻止它，所以我倾向于说它是允许的。

微软也有同样的看法（我能听到观众的低语），他们在 MSDN 文章中关于[ADO.NET 数据服务框架的 DELETE 方法的](https://web.archive.org/web/20090213142728/http://msdn.microsoft.com:80/en-us/library/cc716657.aspx)文章中指出：

> 如果 DELETE 请求包含实体主体，则该主体将被忽略 [...]

此外，这里是[RFC2616](http://www.w3.org/Protocols/rfc2616/rfc2616.html) (HTTP 1.1) 关于请求的内容：

*   实体*主体*仅在存在*消息主体*时才存在（第 7.2 节）
*   *消息体*的存在通过包含一个`Content-Length`or`Transfer-Encoding`标头来表示（第 4.3 节）
*   当请求方法的规范不允许发送*实体主体时，不得包含消息主体*（*第*4.3 节）
**   仅在 TRACE 请求中明确禁止实体主体，所有其他请求类型均不受限制（特别是第 9 节和第 9.8节*）**

 *对于响应，已定义：

*   是否包含*消息体*取决于请求方法*和*响应状态（第 4.3 节）
*   在响应 HEAD 请求时明确禁止*消息体（特别是第 9 节和第 9.4 节）*
*   在1xx（信息性）、204（无内容）和 304（未修改）响应中明确禁止*消息体（第 4.3 节）*
*   所有其他响应都包括一个消息体，尽管它的长度可能为零（第 4.3 节）

* * *

## 回答 #2

> 赞同：277
> 
> 时间：2012-04-04T16:49:51.403

[HTTP 1.1 规范 ( RFC 7231](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.5) )的最新更新明确允许在 DELETE 请求中使用实体主体：

> DELETE 请求消息中的有效负载没有定义的语义；在 DELETE 请求上发送有效负载正文可能会导致某些现有实现拒绝该请求。

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2010-01-15T19:56:17.090

某些版本的 Tomcat 和 Jetty 似乎会忽略存在的实体主体。如果您打算接收它，这可能会很麻烦。

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2013-08-09T06:24:55.327

在删除请求中使用正文的一个原因是为了乐观并发控制。

您阅读了记录的第 1 版。

```
GET /some-resource/1
200 OK { id:1, status:"unimportant", version:1 } 
```

您的同事阅读了记录的第 1 版。

```
GET /some-resource/1
200 OK { id:1, status:"unimportant", version:1 } 
```

您的同事更改了记录并更新了数据库，从而将版本更新为 2：

```
PUT /some-resource/1 { id:1, status:"important", version:1 }
200 OK { id:1, status:"important", version:2 } 
```

您尝试删除记录：

```
DELETE /some-resource/1 { id:1, version:1 }
409 Conflict 
```

你应该得到一个乐观锁异常。重新阅读记录，看看它是否重要，也许不要删除它。

使用它的另一个原因是一次删除多条记录（例如，带有行选择复选框的网格）。

```
DELETE /messages
[{id:1, version:2},
{id:99, version:3}]
204 No Content 
```

请注意，每条消息都有自己的版本。也许您可以使用多个标头指定多个版本，但 George 认为这更简单、更方便。

这适用于 Tomcat (7.0.52) 和 Spring MVC (4.05)，也可能是早期版本：

```
@RestController
public class TestController {

    @RequestMapping(value="/echo-delete", method = RequestMethod.DELETE)
    SomeBean echoDelete(@RequestBody SomeBean someBean) {
        return someBean;
    }
} 
```

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2016-05-25T23:46:25.520

请注意，如果您在 DELETE 请求中提供正文并使用谷歌云 HTTPS 负载均衡器，它将拒绝您的请求并显示 400 错误。我正用头撞墙，结果发现无论出于何种原因，Google 都认为带有正文的 DELETE 请求是格式错误的请求。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2008-11-18T18:37:21.190

在我看来，[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616)没有指定这一点。

从第 4.3 节开始：

> 请求中消息体的存在通过在请求的消息头中包含 Content-Length 或 Transfer-Encoding 头字段来表示。如果请求方法的规范（第 5.1.1 节）不允许在请求中发送实体主体，则消息主体不得包含在请求中。服务器应该在任何请求上读取并转发消息体；如果请求方法不包括为实体主体定义的语义，则在处理请求时应该忽略消息主体。

第 9.7 节：

> DELETE 方法请求源服务器删除由 Request-URI 标识的资源。此方法可能会被源服务器上的人工干预（或其他方式）覆盖。即使从源服务器返回的状态码表明操作已经成功完成，客户端也不能保证操作已经执行。但是，服务器不应指示成功，除非在给出响应时它打算删除资源或将其移动到无法访问的位置。
> 
> 如果响应包含描述状态的实体，则成功的响应应该是 200（OK），如果操作尚未制定，则为 202（已接受），如果操作已经制定但响应不包括，则应为 204（无内容）一个实体。
> 
> 如果请求通过缓存并且 Request-URI 标识了一个或多个当前缓存的实体，那么这些条目应该被视为陈旧的。对此方法的响应不可缓存。c

所以它没有被明确地允许或禁止，并且沿途的代理有可能会删除消息体（尽管它应该读取并转发它）。

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2020-02-22T22:25:23.223

HTTP 邮件列表上的 Roy Fielding 澄清了 http 邮件列表 [https://lists.w3.org/Archives/Public/ietf-http-wg/2020JanMar/0123.html](https://lists.w3.org/Archives/Public/ietf-http-wg/2020JanMar/0123.html)并说：

> GET/DELETE 正文绝对禁止对请求的处理或解释产生任何影响

这意味着主体不能修改服务器的行为。然后他补充说：

> 除了必须读取和丢弃接收到的字节以维护消息帧之外。

最后是不禁身的原因：

> 我们没有禁止发送正文的唯一原因是因为这会导致延迟实现，假设不会发送正文。

因此，虽然客户端可以发送有效负载正文，但服务器应该删除它，并且 API 不应该为这些请求中的有效负载正文定义语义。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2018-11-09T15:25:11.207

值得注意的是，3.0 版的 OpenAPI 规范放弃了对带有主体的 DELETE 方法的支持：

请参阅[此处](https://swagger.io/specification/#operationRequestBody)和[此处](https://github.com/swagger-api/swagger-ui/issues/4425)以获取参考

这可能会影响您将来对这些 API 的实施、文档或使用。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2019-03-19T19:33:46.100

将 DELETE 与 Body 一起使用是有风险的......我更喜欢这种方法用于列表操作而不是 REST：

**常规操作**

GET */objects/* **获取所有对象**

GET */object/ **ID*** **获取具有指定 ID 的 Object**

POST */objects* **添加一个新对象**

PUT */object/ **ID*** **添加一个具有指定 ID 的对象，更新一个对象**

DELETE */object/ **ID*** **删除指定 ID 的对象**

**所有自定义操作都是 POST**

POST */objects/ **addList*** **添加包含在正文中的对象列表或数组**

POST */objects/ **deleteList*** **删除包含在正文中的对象列表**

POST */objects/ **customQuery*** **根据正文中的自定义查询创建一个列表**

如果客户不支持您的扩展操作，他们可以以常规方式工作。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2019-02-17T16:35:47.470

我不认为已经发布了一个好的答案，尽管对现有答案有很多很好的评论。我将把这些评论的要点提升为一个新的答案：

[RFC7231 中的这一段](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.5)已经被引用了几次，它确实总结了它。

> DELETE 请求消息中的有效负载没有定义的语义；在 DELETE 请求上发送有效负载正文可能会导致某些现有实现拒绝该请求。

我从其他答案中错过的是暗示。是的，它允许在`DELETE`请求中包含正文，但它在语义上没有意义。这真正意味着发出`DELETE`带有请求正文的请求在语义上等同于不包括请求正文。

包含请求正文不应该对请求产生任何影响，因此包含它从来没有意义。

tl; dr：从技术上讲`DELETE`，允许带有请求正文的请求，但这样做从来没有用处。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2013-05-27T14:59:07.640

似乎 ElasticSearch 使用了这个： [https ://www.elastic.co/guide/en/elasticsearch/reference/5.x/search-request-scroll.html#_clear_scroll_api](https://www.elastic.co/guide/en/elasticsearch/reference/5.x/search-request-scroll.html#_clear_scroll_api)

这意味着 Netty 支持这一点。

就像评论中提到的那样，情况可能不再如此

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-01-09T07:43:46.927

**这没有定义**。

> DELETE 请求消息中的有效负载没有定义的语义；在 DELETE 请求上发送有效负载正文可能会导致某些现有实现拒绝该请求。
> [https://www.rfc-editor.org/rfc/rfc7231#page-29](https://www.rfc-editor.org/rfc/rfc7231#page-29)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-08-21T20:29:30.850

如果有人遇到这个问题测试，不，它不是普遍支持的。

我目前正在使用 Sahi Pro 进行测试，很明显，http DELETE 调用会剥离任何提供的正文数据（根据端点设计批量删除的大量 id 列表）。

我已经与他们多次联系，并发送了三个单独的文件包、图像、日志供他们查看，但他们仍然没有确认这一点。一个失败的补丁，后来他们的支持错过了电话会议，我仍然没有得到一个可靠的答案。

我确信 Sahi 不支持这一点，我想还有很多其他工具会效仿。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-07-28T11:37:34.787

实际答案：否

一些客户端和服务器会忽略甚至删除 DELETE 请求中的正文。在极少数情况下，它们会失败并返回错误。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2019-02-17T16:22:58.740

可能是下面的 GitHub 网址会帮助你，得到答案。实际上，像 Tomcat 这样的应用程序服务器，Weblogic 拒绝了带有请求负载的 HTTP.DELETE 调用。所以请记住这些，我在 github 中添加了示例，请查看

[https://github.com/ashish720/spring-examples](https://github.com/ashish720/spring-examples)

* * *

## 回答 #16

> 赞同：-6
> 
> 时间：2019-04-17T12:41:59.580

我能够使用请求正文实现 DELETE 操作。我使用 AWS Lambda 和 AWS API 网关并使用 Go 语言。

# asp.net - 减少 HTML 占用空间的好工具？

> ID：299636
> 
> 赞同：1
> 
> 时间：2008-11-18T18:18:07.217
> 
> 标签：asp.net, javascript, html, optimization, footprint

有谁知道一个可以在页面上运行的好工具（例如，对于 asp.net），以帮助最小化页面的占用空间？

该页面将包含典型项目：HTML、Javascript 等。

我过去听说过 Javascript crunchers，这将使代码的大小尽可能紧凑（我想会混淆它）。

目标是帮助优化页面大小（使其尽可能小以提高速度，而无需更改任何内容）。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T18:24:23.040

您可以将 Web 服务器配置为动态压缩页面（并可能缓存压缩版本），以供任何表明它可以采用 gzip 或 zip（或其他）编码的客户端，这几乎是所有这些。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T18:23:50.793

好吧，它不是一个自动清洁器，但我喜欢[YSlow](http://developer.yahoo.com/yslow/)来优化页面。[YUI Compressor](http://developer.yahoo.com/yui/compressor/)可以缩小你的 javascript 。

如果您真的对 javascript 感兴趣，关键字是“minify”。

另外，看看刚刚发布的这个问题：[HTML and stuff](https://stackoverflow.com/questions/299636/good-tool-to-minimize-html-footprint)

希望有帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T18:27:10.290

是的，当然。我不是 asp.net 人，但你可以寻找的东西（正如其他人所说）：

*   页面的 gzip 压缩 - 服务器选项
*   js：就像你说的，javascript 有缩小选项，反过来也可以压缩。
*   css：有像 javascript 一样的缩小选项，也可以 gzip 压缩。

我们的 java 应用程序使用[pack:tag](http://sourceforge.net/projects/packtag)。也许您可以找到类似的 .net 替代品。

已经提到的 Yslow 可以显示您可以进行哪些改进。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T18:36:51.877

搜索一些 ASP .NET 压缩技术，如果您使用的是 IIS6，我推荐您使用[MbCompression](http://www.codeplex.com/MbCompression)，但是如果您运行的是 IIS 7，它具有强大的内置[HTTP 压缩支持](http://blogs.iis.net/ksingla/archive/2006/06/13/changes-to-compression-in-iis7.aspx)，您可以根据其 MIME 类型定义压缩哪些文件在您的配置文件中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T18:45:13.217

一些基础知识：IIS 将 JS/CSS/Html 文件的压缩响应保存在磁盘上，因此后续对 JS/CSS 的请求由磁盘提供（绕过压缩步骤）。虽然 ASPX/ASCX 的压缩响应不会缓存在磁盘上，因为响应因请求而异。

因此，最佳做法是将 Javascript/CSS 保留在自己的文件中，并避免将内联 CSS/Script 放入 aspx/ascx。

一般来说，有两种方法可以减少页面大小/HTML 1) 通过 webserver/HTTPModule 进行压缩 [启用 IIS 6 HTTP 压缩][1]

2) 第三方工具的混淆/压缩 - [JASOB](http://www.jasob.com/Features.html) 是我最喜欢的工具。

它还可以从您的 php/asp.net/perl/jsp/XSLT 文件中压缩/混淆 javascript/css 代码。如果像vanila DOS，那么也有命令行界面。

我已经在几个 ASP.NET 项目中使用过它，我只需选择我的 webproject 目录，JASOB 提供了很好的选项来发布 webproject 目录的混淆版本。这意味着它会从您的 webproject 目录下的所有文件中混淆 javascript/css，是的，它也遍历子目录。一键完成所有这些。

希望它有所帮助，Maulik Modi [http://www.jasob.com/Features.html](http://www.jasob.com/Features.html)

[1]： -http: [//msmvps.com/blogs/omar/archive/2006/08/10/iis-6-compression-quickest-and-effective-way-to-do-it-for-asp-net -压缩.aspx](http://msmvps.com/blogs/omar/archive/2006/08/10/iis-6-compression-quickest-and-effective-way-to-do-it-for-asp-net-compression.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-18T19:11:17.657

我个人不会为了大小而牺牲可读性和可维护性。

动态 Web 服务器压缩为我节省了 TON（鉴于文本压缩得如此之好），而进一步的优化对我的帮助很小。

# database - 什么是数据库/DBMS“补丁访问”？

> ID：299637
> 
> 赞同：0
> 
> 时间：2008-11-18T18:18:27.593
> 
> 标签：database

在谷歌上找不到这个词很容易。

我认为这是在不停止服务的情况下通过更新修补 DBMS 的能力。

它是否正确？如果没有，请指导我。

提前致谢。

吉布

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T08:49:02.547

**补丁访问**通常是指一种服务（最好是容易地）访问相关补丁（在这种情况下是为您的 dbms）。

有关更多信息，请参阅：

*   [http://www.databasejournal.com/features/oracle/article.php/3569941/Database-Security-and-Patches--Part-3.htm](http://www.databasejournal.com/features/oracle/article.php/3569941/Database-Security-and-Patches--Part-3.htm)
*   [http://en.wikipedia.org/wiki/Comparison_of_relational_database_management_systems#Access_Control](http://en.wikipedia.org/wiki/Comparison_of_relational_database_management_systems#Access_Control)

# user-interface - 需要有关分层解决方案、关注点分离等方面的建议

> ID：299638
> 
> 赞同：2
> 
> 时间：2008-11-18T18:19:11.227
> 
> 标签：user-interface, data-access-layer, separation-of-concerns, business-logic-layer

我们有一个分层的应用程序，或者至少正在过渡到一个，分解如下：

*   接口（用户接口或应用程序接口，即webservice等）
*   商业逻辑
*   数据访问

为了使这个问题的其余部分更加具体，我将描述一个具体的例子。

我们有一个用户界面，它背后有一个控制器对象（业务逻辑层）。该控制器通过另一个对象（数据访问层）与数据库通信。

在给定的上下文中，用户界面允许用户选择一个员工来绑定正在执行的操作。由于有关于用户（实际上是控制器之外的任何世界）可以选择哪些员工的规则，控制器为此提供了两件事：

*   一个可读的属性，其中包含可供选择的可用员工列表
*   包含当前选择的员工的读/写属性

用户界面可能会读取列表并使用它来填充组合框。

在此应用程序的版本 1 中，组合框包含员工的识别号 + 员工的姓名。

一切都很好...

...直到版本 1.1，一个错误修复。用户抱怨他无法在*Jimmy Olson*和*Jimmy Olson*之间进行选择，因为该应用程序无法让他轻松地知道哪个是哪个。他知道销售部门有一个 Jimmy，开发部门有另一个，所以这个 1.1 版本的解决方法是简单地在组合框中添加一个斜线 + 部门名称。在版本 2 中，我们会选择将组合框替换为具有列支持的组合框，删除斜线，但在 1.1 中，选择此选项是为了最大限度地降低出现更多错误的风险。

换句话说，组合框将包含：

*   1 - 吉米奥尔森/销售
*   2 - 吉米奥尔森/发展
*   *   其他人

但是，用户界面代码没有 SQL 代码，也没有任何方法可以控制该部门，因此我们必须到控制器那里查看代码。控制者不需要部门，说实话，连员工的名字都不需要，身份证号码就够了，所以控制者里面没有任何东西向部门索要或做什么。所以我们必须深入到数据访问层并在那里更改 SQL。

坦率地说，这个解决方案很臭。

如果这个控制器有多个接口，有不同的要求，我们有三种可能的解决方案：

1.  更改数据访问层以满足多个接口（2 层之外）的（增加/多样化）需求，这意味着所有接口都可能获得它们需要的所有数据，但它们也将获得任何所需的所有数据其他接口的
2.  添加一些东西，让用户界面告诉数据访问层（仍然是 2 层）它需要什么
3.  以某种方式使用户界面层获得所需的数据，而无需更改所涉及的控制器或访问层，这听起来像是我们需要更多的数据访问代码，某处。

以上解决方案都感觉不好。

我想知道的是，我们完全偏离轨道了吗？你会怎么做？在上述 3 之下是否有第四和第五种解决方案？

根据这个问题：[Separation of Concerns](https://stackoverflow.com/questions/98734/separation-of-concerns)，接受的答案包含以下引用：

> 关注点分离就是将每个关注点的代码分开。更改接口不应该需要更改业务逻辑代码，反之亦然。

这是否仅仅意味着所有控制器/数据访问层应该为我们提供完成其工作所需的一切（即员工的识别号），然后用户界面应该与数据库对话并询问更多信息关于*这些特定的员工*？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T18:30:55.430

在我看来，你有两种可能性：

1.  让较低层发送他们拥有的关于一个人的*所有* 信息，可能作为 XML 文档，即使该信息的许多消费者并不需要它。
2.  为更高级别的层提供 API 以深入了解并获取他们需要的信息。所以在你给的情况下，有一个接口可以让业务层向数据库层询问给定用户ID的部门的方法。

两者都有取舍。第一个公开了更多信息，可能是对无权获得该信息的消费者。第二个是每笔交易传递的信息要少得多，但需要更多的交易。第一个不需要在每次获得更多信息时都更改 API，但会更改 XML。第二种是保持现有 API 的接口不变，但根据需要提供新的 API。等等。

# visual-studio - 如何关闭 Visual Studio 源窗口底部的标记显示？

> ID：299644
> 
> 赞同：0
> 
> 时间：2008-11-18T18:21:20.020
> 
> 标签：visual-studio, visual-studio-2008, visual-web-developer

Visual Studio 试图通过显示光标所在的所有嵌套标签来提供帮助（代码窗口底部的显示，在“设计 | 拆分 | 源”选项旁边），但我从不使用它，而且它似乎当我只是试图通过大块代码时放慢速度。有什么办法可以关闭这个功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T18:30:32.200

快速查看工具 -> 选项 -> HTML 设计器选项似乎没有提供关闭此功能的方法。您可以设置默认视图，但没有开/关选项。

# wpf - WPF：如何将动画与自定义事件处理结合起来？

> ID：299645
> 
> 赞同：0
> 
> 时间：2008-11-18T18:21:24.043
> 
> 标签：wpf, drag-and-drop

我正在尝试创建一个可拖动的自定义 WPF 控件，但我还需要在拖动时对其进行动画处理。我需要重写 OnMouseDown 来实现拖动功能，但我也希望在 MouseDown 事件上触发我的动画。

如果没有拖动功能 - 即，当 OnMouseDown 未被覆盖时 - 动画可以工作，但是当我覆盖 OnMouseDown 以实现拖动功能时，动画将停止工作。

这里有什么诀窍？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T18:48:34.270

解决方案：我正在使用 PreviewMouseLeftButtonDown 而不是覆盖 OnMouseDown 来开始拖动操作。

# java - POI 生成的 Excel 工作簿在链接时不起作用

> ID：299650
> 
> 赞同：2
> 
> 时间：2008-11-18T18:22:47.787
> 
> 标签：java, excel, apache-poi

这是我正在做的事情：

1.  在内存中创建工作簿（book = new HSSFWorkbook(), ...）
2.  将其保存到磁盘 (book.write(...))
3.  在 Excel 中打开（确定）
4.  在 Excel 中创建另一个工作簿，该工作簿链接到第一个工作簿 (=PoiWorkbook?xls!A1)
5.  关闭 Excel

然后每次我再次打开第二个工作簿时，所有链接都是#N/A，除非我同时打开了 POI 生成的工作簿。

我从未在 Excel 中创建的标准工作簿中看到这种行为。有人看过这个并找到解决方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-11T12:49:17.420

这个问题似乎可以通过更新版本的 POI（现在使用 3.6）解决。

# web-applications - 员工排班软件？基于网络/浏览器

> ID：299658
> 
> 赞同：8
> 
> 时间：2008-11-18T18:26:24.783
> 
> 标签：web-applications, scheduling, project-planning

只是想知道你们中是否有人知道任何基于网络/基于浏览器的员工调度软件/工具？

目前在 Excel 中完成这一切，但它还不够智能……有什么产品建议吗？

需要在数周和数月内处理多个员工的时间......安排短期和长期工作，让我看到可能的资源问题等。

当您只从事项目工作时，这是一个简单的问题答案，但在我的机构，我们从事项目和日常保留类型的事情，这些事情可以随时进入，通常属于“放下一切，现在就做”类型.

如果只是项目，那么任何一种在线项目管理工具（GoPlan、Cop​​per Project、MS Project）就足够了（但肯定不是 Basecamp，我觉得这对于非常小的项目和小团队来说还可以，但我认为任何更大的工具都可以它作为 PM 工具完全倒下）

唯一接近完成我想要的所有事情的是 Workschedule - [http://www.workschedule.net/](http://www.workschedule.net/)

它基于浏览器，成本低，有无数的选项，真正让我能够为该机构规划资源水平。唯一的缺点是它看起来很糟糕，但我很快就克服了这一点。

澄清：必须是通用的，即不仅仅是一个行业

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T18:42:24.953

我女朋友的雇主使用： http: [//www.hotschedules.com/](http://www.hotschedules.com/)据我所见，它似乎功能齐全......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T07:01:31.183

看起来[@task](http://www.attask.com/)可能是您正在寻找的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-24T20:45:11.967

这是一个名为 Orchestrate的托管[员工调度软件应用程序。](http://orchestrateapp.com/employee-scheduling-software.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-26T11:02:18.753

似乎是一个旧帖子，但对于任何仍然感兴趣的人，Enigmai 提供了一项新的免费服务（[http://www.enigmai.com](http://www.enigmai.com)）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T15:29:16.730

[http://www.whentowork.com](http://www.whentowork.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-16T18:08:52.013

[VIP 任务管理器专业版](http://www.taskmanagementsoft.com/products/taskmanagerpro/)？

解决方案： * 员工任务计划 * 销售流程管理 * 待办事项管理 * 项目管理 * 员工时间计划 * 进度管理 * 团队协作 * 员工任务跟踪 * 工作流自动化 * 员工时间跟踪 * 工作组生产力管理 * 采购流程管理

> ...通过本地网络 (LAN) 和低速网络（互联网、VPN）同时访问公共数据库

“为员工分配任务”

价格：399.90 美元 500.00 美元（至 2009 年 3 月 31 日）

看起来他们有一个 Camtasia 播放演示，您可以查看。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-27T14:17:56.647

我们已经使用[findmyshift.com](http://www.findmyshift.com/)大约一年了。我当时能找到的最简单的网站。每周免费使用（我们不需要提前预订）。附带短信和所有内置功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T23:04:00.880

为[JustRosters.com +1](http://www.JustRosters.com)

编辑：刚刚注意到他们[对所有计划都有 30 天的免费试用期](http://www.justrosters.com/pages/pricing)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-01T10:42:20.100

前面提到过，但我也推荐**findmyshift.com** - 迄今为止我见过的最简单的界面。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-07-30T21:05:38.740

我在他的放射科公司的朋友和我在他的人力资源公司的另一位朋友使用来自[http://www.azazia.com](http://www.azazia.com)的名为 OnSched 的本地可安装的基于 Web 浏览器的工具。当他提出写推荐信时，他免费得到了一个。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-10-12T07:45:02.867

如果您正在寻找通用的东西.. 适用于不同行业，那么 Microsoft 项目计划软件是最佳选择，拥有广泛的项目管理解决方案。它可用于媒体、教育、建筑、石油和天然气、金融等许多行业。有关详细信息，请参阅 Microsoft[项目管理解决方案的案例研究。](http://www.microsoft.com/project/en/us/customer-success.aspx)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-10T00:27:32.260

检查这个： http: [//keeptempo.com](http://keeptempo.com)，它的标签方法似乎可以适应您正在寻找的额外灵活性[http://keeptempo.com/help/time-reporting/how-can-i-use-tags-to -组织我的时间/](http://keeptempo.com/help/time-reporting/how-can-i-use-tags-to-organize-my-time/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-16T03:15:49.523

这是我的：http: [//quickrosters.com](http://quickrosters.com)

源代码在这里： [http ://rosters.rubyforge.org](http://rosters.rubyforge.org)

还有一个不错的：http: [//justrosters.com](http://justrosters.com)

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-03-15T19:38:54.943

我喜欢 WSS（Windows Sharepoint 服务）。它是免费的，可以安装在 W2K3 或 W2K8 服务器上。开箱即用，非常容易使用。并且易于定制。使用 Intelligantt，您也可以在那里发布您的 MS Project 文件。然后通过插入 Microsoft Office Sharepoint Designer，您可以构建一些自定义工作流。

当然，最喜欢的与 Microsoft Office Outlook 的集成始终是一个加分项。您可以导出日历和任务列表。

# java - Java中的SoftReference和WeakReference有什么区别？

> ID：299659
> 
> 赞同：868
> 
> 时间：2008-11-18T18:26:37.637
> 
> 标签：java, reference, weak-references, soft-references

[`java.lang.ref.WeakReference`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/ref/WeakReference.html)和有什么区别[`java.lang.ref.SoftReference`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/ref/SoftReference.html)？

* * *

## 回答 #1

> 赞同：981
> 
> 时间：2008-11-18T18:37:29.690

来自Ethan Nicholas 的《[理解弱引用](https://web.archive.org/web/20061130103858/http://weblogs.java.net/blog/enicholas/archive/2006/05/understanding_w.html)》：

> **弱引用**
> 
> *简而言之，弱引用*是一种强度不足以迫使对象保留在内存中的引用。弱引用允许您利用垃圾收集器为您确定可达性的能力，因此您不必自己做。您可以像这样创建一个弱引用：
> 
> ```
> WeakReference weakWidget = new WeakReference(widget); 
> ```
> 
> 然后在代码的其他地方，您可以使用它 `weakWidget.get()`来获取实际 `Widget`对象。当然，弱引用的强度不足以阻止垃圾回收，因此您可能会发现（如果没有对小部件的强引用） `weakWidget.get()`突然开始返回`null`.
> 
> ...
> 
> **软参考**
> 
> 软*引用*与弱引用完全一样，只是它不太急于丢弃它所引用的对象。只能弱可达的对象（对它的最强引用是`WeakReferences`）将在下一个垃圾回收周期被丢弃，但软可达的对象通常会保留一段时间。
> 
> `SoftReferences`不需要与 有任何不同的行为 *，*`WeakReferences`但实际上只要内存充足，通常会​​保留软可访问的对象。这使它们成为缓存（例如上面描述的图像缓存）的绝佳基础，因为您可以让垃圾收集器担心对象的可达性（强可达性对象*永远不会*从缓存中删除）以及它的严重程度需要他们正在消耗的内存。

彼得凯斯勒在评论中补充道：

> Sun JRE 对 SoftReference 的处理与 WeakReference 不同。如果可用内存没有压力，我们会尝试保留由 SoftReference 引用的对象。一个细节：“-client”和“-server”JRE 的策略是不同的：-client JRE 试图通过更喜欢清除 SoftReferences 而不是扩展堆来保持你的占用空间小，而 -server JRE 试图保持你的通过更喜欢扩展堆（如果可能）而不是清除 SoftReferences 来提高性能。一种尺寸并不适合所有人。

* * *

## 回答 #2

> 赞同：224
> 
> 时间：2008-11-18T18:27:02.863

急切地收集弱引用。如果 GC 发现一个对象是弱可访问的（只能通过弱引用访问），它会立即清除对该对象的弱引用。因此，它们非常适合保留对您的程序还保留（强引用）“关联信息”的对象的引用，例如有关类的缓存反射信息或对象的包装器等。在与它关联的对象被 GC-ed 之后，没有任何意义。当弱引用被清除时，它会被排入一个引用队列，你的代码会在某个地方轮询，并且它也会丢弃关联的对象。也就是说，您保留有关对象的额外信息，但是一旦它所引用的对象消失，就不需要该信息。实际上，在某些情况下，您甚至可以继承 WeakReference 并将有关对象的相关额外信息保留在 WeakReference 子类的字段中。WeakReference 的另一个典型用途是与 Maps 结合使用以保持规范实例。

另一方面，SoftReferences 有利于缓存外部的、可重新创建的资源，因为 GC 通常会延迟清除它们。尽管可以保证在抛出 OutOfMemoryError 之前所有 SoftReference 都会被清除，因此理论上它们不会导致 OOME[*]。

典型的用例示例是保留文件中内容的解析形式。您将实现一个系统，您将在其中加载文件、解析它，并为解析表示的根对象保留一个 SoftReference。下次您需要该文件时，您将尝试通过 SoftReference 检索它。如果您可以检索到它，您就省去了另一个加载/解析，如果 GC 在此期间清除了它，您就重新加载它。这样，您可以利用空闲内存进行性能优化，但不会冒 OOME 的风险。

现在为 [*]。保持 SoftReference 本身不会导致 OOME。另一方面，如果您错误地将 SoftReference 用于要使用 Wea​​kReference 的任务（即，您保持与某个对象关联的信息以某种方式被强引用，并在 Reference 对象被清除时丢弃它），您可能会遇到 OOME轮询 ReferenceQueue 并丢弃关联对象的代码可能碰巧没有及时运行。

因此，决定取决于使用情况 - 如果您要缓存构建成本高昂但仍可从其他数据重建的信息，请使用软引用 - 如果您要保留对某些数据的规范实例的引用，或者您想要在没有“拥有”它的情况下引用一个对象（从而防止它被 GC'd），使用弱引用。

* * *

## 回答 #3

> 赞同：182
> 
> 时间：2015-08-03T10:39:35.950

**在 Java 中**；从强到弱依次为：强、软、弱、幻

**强引用**是保护被引用对象不被 GC 收集的普通引用。即从不垃圾收集。

软**引用**有资格被垃圾收集器收集，但在需要其内存之前可能不会被收集。即垃圾收集之前`OutOfMemoryError`。

**弱引用**是不保护被引用对象不被 GC 收集的引用。即当没有强或软引用时垃圾收集。

**幻影引用**是对对象的引用，它在最终确定之后但在其分配的内存被回收之前被幻影引用。

[来源](https://en.wikipedia.org/wiki/Soft_reference)

**类比：**假设JVM是一个王国，Object是王国的国王，GC是王国的攻击者试图杀死国王（对象）。

*   当King is **Strong**时，GC无法杀死他。
*   当 King 是**Soft**时，GC 攻击他，但 King 以保护方式统治王国，直到资源可用。
*   当国王**很弱**时，GC攻击他但没有保护地统治王国。
*   当 king 是**Phantom**时，GC 已经杀死了他，但 king 可以通过他的灵魂获得。

* * *

## 回答 #4

> 赞同：80
> 
> 时间：2013-10-17T03:05:44.993

**弱参考** [http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ref/WeakReference.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ref/WeakReference.html)

**原理：** `weak reference`与垃圾回收有关。通常，具有一个或多个的对象`reference`将没有资格进行垃圾回收。
上述原则不适用时`weak reference`。如果一个对象与其他对象只有弱引用，那么它就可以进行垃圾回收了。

让我们看看下面的例子：我们有一个`Map`with Objects ，其中 Key 是引用一个对象。

```
import java.util.HashMap;   
public class Test {

    public static void main(String args[]) {
        HashMap<Employee, EmployeeVal> aMap = new 
                       HashMap<Employee, EmployeeVal>();

        Employee emp = new Employee("Vinoth");
        EmployeeVal val = new EmployeeVal("Programmer");

        aMap.put(emp, val);

        emp = null;

        System.gc();
        System.out.println("Size of Map" + aMap.size());

    }
} 
```

现在，在执行我们制作的程序期间`emp = null`。握住钥匙在`Map`这里毫无意义`null`。在上述情况下，对象没有被垃圾回收。

**弱哈希映射**

`WeakHashMap`是一个条目 ( `key-to-value mappings`) 将在不再可能从`Map`.

**让我用Wea​​kHashMap**来展示上面的例子

 **```
import java.util.WeakHashMap;

public class Test {

    public static void main(String args[]) {
        WeakHashMap<Employee, EmployeeVal> aMap = 
                    new WeakHashMap<Employee, EmployeeVal>();

        Employee emp = new Employee("Vinoth");
        EmployeeVal val = new EmployeeVal("Programmer");

        aMap.put(emp, val);

        emp = null;

        System.gc();
        int count = 0;
        while (0 != aMap.size()) {
            ++count;
            System.gc();
        }
        System.out.println("Took " + count
                + " calls to System.gc() to result in weakHashMap size of : "
                + aMap.size());
    }
} 
```

**输出：**结果`20 calls to System.gc()`为`aMap size`：0。

`WeakHashMap`只有对键的弱引用，而不是像其他`Map`类那样的强引用。当值或键被强引用时，尽管您使用了`WeakHashMap`. 这可以通过将对象包装在**WeakReference**中来避免。

```
import java.lang.ref.WeakReference;
import java.util.HashMap;

public class Test {

    public static void main(String args[]) {
        HashMap<Employee, EmployeeVal> map = 
                      new HashMap<Employee, EmployeeVal>();
        WeakReference<HashMap<Employee, EmployeeVal>> aMap = 
                       new WeakReference<HashMap<Employee, EmployeeVal>>(
                map);

        map = null;

        while (null != aMap.get()) {
            aMap.get().put(new Employee("Vinoth"),
                    new EmployeeVal("Programmer"));
            System.out.println("Size of aMap " + aMap.get().size());
            System.gc();
        }
        System.out.println("Its garbage collected");
    }
} 
```

**软参考。**

`Soft Reference`比弱参考稍强。软引用允许垃圾收集，但只有在没有其他选项时才请求垃圾收集器清除它。

垃圾收集器不会像处理弱可达对象那样积极地收集软可达对象——相反，它只在它真的“需要”内存时才收集软可达对象。软引用是对垃圾收集器说的一种方式，“只要内存不太紧张，我想保留这个对象。但如果内存变得非常紧张，继续收集它，我会处理接着就，随即。” 垃圾收集器需要在抛出之前清除所有软引用`OutOfMemoryError`。

* * *

## 回答 #5

> 赞同：55
> 
> 时间：2012-04-03T15:23:54.727

软引用和弱引用之间唯一真正的区别是

> 垃圾收集器使用算法来决定是否回收一个软可达对象，但总是回收一个弱可达对象。

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2008-11-18T18:27:22.223

`SoftReference`专为缓存而设计。当发现 a`WeakReference`引用了一个无法访问的对象时，它将立即被清除。`SoftReference`可以保持原样。通常，有一些算法与可用内存量和最后用于确定是否应该清除它的时间有关。当前的 Sun 算法是在没有使用 Java 堆上的可用内存兆字节的秒数内清除引用（可配置，服务器 HotSpot 检查由 设置的最大可能堆`-Xmx`）。`SoftReference`s 将在`OutOfMemoryError`被抛出之前被清除，除非可以访问。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2018-08-14T18:28:32.943

这篇[文章](https://community.oracle.com/blogs/enicholas/2006/05/04/understanding-weak-references)对于理解强引用、软引用、弱引用和虚引用非常有帮助。

* * *

给大家总结一下，

如果您只有对对象的**弱引用**（没有强引用），那么该对象将在下一个 GC 循环中被 GC 回收。

如果你只有对一个对象的**软引用**（没有强引用），那么只有当 JVM 内存不足时，GC 才会回收该对象。

* * *

所以你可以说，强引用具有*终极力量*（GC永远无法收集）

软引用比弱引用更*强大*（因为它们可以逃避 GC 循环，直到 JVM 内存不足）

弱引用*甚至不如*软引用强大（因为它们无法摆脱任何 GC 循环，并且如果对象没有其他强引用，它们将被回收）。

* * *

**餐厅类比**

*   服务员 - GC
*   你 - 堆中的对象
*   餐厅区域/空间 - 堆空间
*   新客户 - 想要在餐厅用餐的新对象

现在，如果您是一个*强大的客户*（类似于强参考），那么即使有新客户来到餐厅或发生什么事情，您也永远不会离开您的餐桌（堆上的内存区域）。服务员无权告诉您（甚至要求您）离开餐厅。

如果你是*软顾客*（类似于软参考），那么如果餐厅有新顾客进来，服务员不会要求你离开餐桌，除非没有其他空桌子可以容纳新顾客。（换句话说，只有当有新客户进来并且没有其他桌子可供该新客户使用时，服务员才会要求您离开餐桌）

如果您是*弱客户*（类似于弱参考），那么服务员可以（在任何时间点）随意要求您离开餐厅：P

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-08-17T05:31:13.210

Java 中的六种对象可达状态：

1.  **强**可达对象 - GC**不会**收集（**回收所占用的内存**）这种对象。这些**可以通过根节点或另一个强可达对象** （即通过局部变量、类变量、实例变量等）访问
2.  **可软**访问的对象 - GC**可能会根据内存争用尝试**收集此类对象。这些可以通过一个或多个**软引用对象从根访问**
3.  **弱**可达对象 - GC**必须**收集这种对象。这些可以通过一个或多个**弱引用对象从根访问**
4.  **Resurrect-able** objects - GC 已经在收集这些对象的过程中。但他们可能会通过执行一些终结**器回到其中一种状态 - 强/软/弱**
5.  **幻象**可达对象 - GC**已经在收集这些对象的过程中，并且已经确定任何终结器都不能复活（如果它自己声明了 finalize() 方法，那么它的终结器将已经运行）**。这些可以通过一个或多个**幻像引用对象从根访问**
6.  **无法到达**的对象 - 一个对象既不是强烈的、柔和的、弱的，也不是幻影可以到达的，也不是可复活的。这些对象已准备好进行回收

更多详情：[https](https://www.artima.com/insidejvm/ed2/gc16.html) ://www.artima.com/insidejvm/ed2/gc16.html « 折叠

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-09-19T03:08:32.803

### 唯一真正的区别

根据[文档](http://archive.is/Y1suz#selection-275.18-275.59)，松散的 WeakReferences**必须**由正在运行的 GC 清除。

根据[文档，](http://archive.is/j4Hsg#selection-287.48-289.16)**必须**在抛出 OOM 之前清除松散的 SoftReferences 。

这是唯一真正的区别。其他一切都不是合同的一部分。（我假设最新的文档是合同性的。）

**软引用很有用。**内存敏感缓存使用 SoftReferences，而不是 WeakReferences。

* * *

WeakReference的唯一**正确**用途是观察 GC 运行。为此，您可以创建一个新的 WeakReference，其对象立即超出范围，然后尝试从`weak_ref.get()`. 当它是 时`null`，您会了解到在这段时间之间，GC 运行了。

至于 WeakReference 的**错误**使用，不胜枚举：

*   一个糟糕的 hack 来实现优先级 2 软引用，这样您就不必编写一个，**但**它不能按预期工作，因为缓存会在**每次**GC 运行时被清除，即使有空闲内存也是如此。有关 phails，请参阅 [https://stackoverflow.com/a/3243242/632951](https://stackoverflow.com/a/3243242/632951)。（此外，如果您需要 2 级以上的缓存优先级怎么办？您仍然需要一个真正的库。）

*   将数据与现有类的对象相关联的糟糕技巧，**但是**当您的 GC 决定在创建弱引用后休息时，它会产生内存泄漏 (OutOfMemoryError)。此外，它非常丑陋：更好的方法是使用元组。

*   将数据与现有类的对象相关联的糟糕技巧，其中该类有胆量使其自身不可子类化，并用于您需要调用的**现有函数代码中。**在这种情况下，正确的解决方案是编辑类并使其可子类化，或编辑函数并使其采用接口而不是类，或使用替代函数。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-08-24T04:35:13.740

为了给出实际的内存使用方面，我做了一个实验，在重负载下使用强、软、弱和幻影引用，将它们保留到程序结束。然后**监控堆使用情况和 GC 行为**。这些指标可能会因具体情况而异，但肯定会提供高水平的理解。以下是调查结果。

**重负载下的堆和 GC 行为**

*   **强/硬引用**- 随着程序的继续，JVM 无法收集保留的强引用对象。最终以“java.lang.OutOfMemoryError: Java heap space”告终
*   **软引用**- 随着程序的继续，堆使用量不断增长，但 OLD gen GC 在接近最大堆时发生。启动程序后，GC 启动时间稍晚。
*   **弱参考**- 随着程序的启动，对象几乎立即开始完成并被收集。大多数对象在年轻代垃圾收集中被收集。
*   **幻影引用**- 与弱引用类似，幻影引用的对象也开始完成并立即进行垃圾收集。没有老年代GC，所有对象都在年轻代垃圾收集本身中被收集。

您可以在[此处获得此实验的更多深度图表、统计数据和观察结果](http://itsallbinary.com/java-weak-reference-soft-reference-phantom-reference-hard-reference-heap-gc-behavior-with-example/)。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-05-15T04:32:48.163

应该知道，弱引用对象只有在它只有弱引用时才会被收集。如果它只有一个强引用，那么无论它有多少弱引用，它都不会被收集。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-11-05T10:12:52.663

**WeakReference**：在每个 GC 周期（次要或完全）收集仅被弱引用的对象。

**SoftReference**：何时收集仅软引用的对象取决于：

1.  -XX:SoftRefLRUPolicyMSPerMB=N 标志（默认值为 1000，即 1 秒）

2.  堆中的可用内存量。

    *例子：*

    *   heap 有 10MB 的可用空间（full GC 之后）；
    *   -XX:SoftRefLRUPolicyMSPerMB=1000

    如果上次访问的时间大于 10 秒，则仅由 SoftReference 引用的对象将被收集。

# java - 构造 JSP/Java 代码，其中逻辑不在 JSP 文件中

> ID：299666
> 
> 赞同：5
> 
> 时间：2008-11-18T18:27:48.337
> 
> 标签：java, jsp

这是一个设计问题和良好实践问题。您如何构建 Java Web 开发以使 JSP 文件中没有很多逻辑。您是否应该将任何 JSP 标记用于 if 结构或循环。我看到很多代码由于设计不良的 JSP 文件而难以遵循逻辑。然后当您想要输出到不同的格式（如 PDF 或 XML 文档）时，您不能这样做，因为所有逻辑都在 JSP 文件中。

对于 Java Web 开发，您是否遵循任何提示或实践。

我目前正在使用 Spring、Hibernate、Struts 的组合......并使用一些 Servlet 代码。

有一些与 Java 开发相关的良好实践。我们许多工作过一段时间的人都知道他们。JSP 开发有哪些好的实践。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-18T18:34:30.507

避免在 JSP 中放置逻辑的最简单方法是在将请求转发到 JSP*之前执行所有逻辑。*在 JSP 中您需要做的唯一逻辑是一些基本的循环（例如，用于创建 HTML 表格行）、评估条件语句和数据格式化。

所有这些都可以通过使用 JSP 标记库和 EL 来完成，而无需在 JSP 中使用 scriptlet 代码（Java 代码）。最重要的标签库是[JSTL](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/index.html)。JSTL 标记库提供了您应该在视图中执行的大部分逻辑，尽管您有时也可能使用诸如[displaytag](http://displaytag.sourceforge.net/11/)之类的利基 3rd 方标记库，这可以减少您需要为特定任务编写的 JSP 代码量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T18:35:13.440

由于您已经在使用 Spring，您可能需要查看 Spring Webflow。我假设您使用的是 Spring 表单标签，但如果没有，您也应该检查一下。使用这种组合，应该很少需要 [如果有的话] 在您的视图逻辑中使用 JSP 标记。

# javascript - 如何检测浏览器关闭？

> ID：299679
> 
> 赞同：16
> 
> 时间：2008-11-18T18:31:28.190
> 
> 标签：javascript, servlets

在我的网络应用程序中，当用户登录时，我将他的 Id 添加到 servlet 中的有效 Id 向量中，当他注销时，我从向量中删除他的 Id，这样我就可以看到有多少当前用户处于活动状态，如果用户忘记注销，我的servelt生成的html有：

```
<meta http-equiv="Refresh" content="30; url=My_Servlet?User_Action=logout&User_Id=1111"> 
```

在标签中自动注销他。

但我注意到许多用户永远在那里，从未退出过。我发现了为什么通过关闭他们的浏览器，他们永远不会手动或自动注销，所以他们的用户 ID 永远不会从有效的用户 ID 向量中删除。

所以，我的问题是：我如何检测用户关闭他们的浏览器，所以我的 servlet 可以从向量中删除他们的 ID？

* * *

我在隧道尽头看到了一些亮光，但仍然存在问题，我的程序有这样的东西：

活跃用户列表：

```
User_1 : Machine_1 [ IP_1 address ]
User_2 : Machine_2 [ IP_2 address ]
User_3 : Machine_3 [ IP_3 address ]
... 
```

我如何从会话侦听器中知道哪个用户的会话已结束并因此将他从我的列表中删除？

我希望当会话结束时，`destroy()`会调用 HttpServlet 的方法，并且我可以删除其中的用户 ID，但是当用户关闭浏览器时它永远不会被调用，为什么？当会话关闭时，HttpServlet 中是否还有其他方法被调用？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-18T18:47:58.500

在服务器端无法知道浏览器已关闭（除非您使用一些 JavaScript 向服务器发送消息）。怎么会有？想想 HTTP 是如何工作的——一切都是请求和响应。

但是，应用程序服务器将跟踪会话何时处于活动状态，甚至会告诉您会话何时被销毁（例如由于超时）。查看[此页面](http://www.stardeveloper.com/articles/display.html?article=2001112001&page=1)以了解如何配置 a[`HttpSessionListener`](http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/http/HttpSessionListener.html)以接收这些事件。然后，您可以简单地跟踪活动会话的数量。

活动会话的数量将落后于当前用户的实际数量，因为在会话超时之前必须经过一段（可配置的）时间；但是，这应该有点接近（您可以降低会话超时以提高准确性）并且它比 1）自己跟踪会话或 2）在浏览器关闭时向服务器发送一些异步 JavaScript（不保证会发送）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-18T18:37:05.107

我建议您在 Servlet 引擎销毁会话时删除 ID。注册一个在被调用[`HttpSessionListener`](http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSessionListener.html)时删除用户 ID的。`sessionDestroyed()`

[Diodeus](https://stackoverflow.com/questions/299679/java-servlet-how-to-detect-browser-closing#299697)的想法只会帮助您更快地检测到会话结束。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T18:36:30.643

在 JavaScript 中，您可以使用该`onbeforeclose`事件在用户关闭浏览器时将调用传回服务器。

我通常使用同步 Ajax 调用来执行此操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T18:47:32.527

没有万无一失的方法来做你想做的事，但 sblundy 和 Diodeus 都有涵盖大多数情况的计划。对于在浏览器中关闭 Javascript、互联网连接中断或电源中断的人，您无能为力。您应该在一段时间不活动后剔除会话（我认为这是 sblundy 建议监听会话破坏的方法）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-18T21:15:47.220

我最近不得不这样做，经过一些搜索，我在网上找到了一些解决方案......所有这些都不能通用！

onbeforeclose 和 onclose 事件用于此任务。但是有两个问题：当用户重新加载页面甚至只是更改当前页面时它们会被触发。有一些技巧可以查看事件是否实际上是一个窗口/页面/选项卡关闭（查看一些 Dom 属性在关闭事件时变得混乱），但是：

*   它们依赖于浏览器
*   这些技巧没有记录，因此很脆弱
*   实际上它们随着浏览器版本/更新而变化......

最糟糕的是，这些事件现在被大多数现代浏览器忽略了，因为它们已被浏览器关闭时弹出窗口的流氓广告滥用。它们不会在 Safari、Opera、IE7 等中触发。

正如所指出的，大多数具有登录功能的 Web 应用程序会在一段时间后破坏用户会话，例如。半小时。我被要求在浏览器关闭时注销以更快地释放宝贵的资源：许可证。因为用户经常忘记注销...

我给出的解决方案是定期（比如 1 分钟）使用 Ajax 请求（发送用户 ID）ping 服务器。如果服务器在 3 分钟内没有收到 ping，它会断开用户连接。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-11T20:08:35.160

这是完成“检测浏览器关闭”的一种肮脏方式，我在本网站某处的论坛中找到了它，当我再次找到它时，我将链接到它。

向 http 响应添加额外的标头。当额外的请求进来时，它们将包含这些额外的标头。您可以检查这些标题，如果它们不存在，您可以终止会话，因此将开始一个新的。虽然这不会“通知”您浏览器是否关闭，但它可以告诉您是否有人关闭了他们的窗口并试图回来，因为您添加的标题将丢失。

```
 wrapper.setHeader("Cache-Control", "no-cache, no-store, must-     revalidate");
 wrapper.setHeader("Pragma", "no-cache");
 wrapper.setDateHeader("Expires", 0);

 Where wrapper is a response wrapper.

 if (wrapper.getHeaderNames().size() < the number of headers you are expecting)
 request.getSession().invalidate();

 Not perfect but it might help someone. 
```

# visual-studio - 更改自定义构建步骤的路径

> ID：299683
> 
> 赞同：0
> 
> 时间：2008-11-18T18:32:25.130
> 
> 标签：visual-studio, visual-c++

我继承了一个使用一些自定义构建步骤的 Visual Studio 2003 项目。我在工具的路径上遇到了一些问题。Visual Studio 从哪里获得它的 PATH？我在自定义构建步骤中回显了 %PATH% ，它与系统路径没有相似之处。我确实在注册表中找到了一个值

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\7.1\VC\VC_OBJECTS_PLATFORM_INFO\Win32\Directories

Path Dirs 看起来可能是 Visual C 使用的路径，但更改它似乎不会改变 VC 中的路径。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T18:48:41.557

Visual Studio 有一个讨厌的习惯，就是“玩弄”你的路径，这会导致你看到的效果。

*如果*您愿意更改 VS 内部的环境（这将为您的所有项目更改它） ，最简单的解决方法是转到工具 > 选项 > 项目 > VC++ 目录并将所需的目录添加到适当的设置- 在您的情况下，应该是“可执行文件”。

如果我不想更改整体环境，我正在使用的另一种方法是创建一个批处理文件，该文件首先为适当的编译器版本调用 vsvars32.bat，然后操作 PATH 变量，最后启动“devenv”。我实际上更喜欢这种方法，但这意味着你的磁盘上到处都是小批量文件，你只能用来启动 Visual Studio ......

# asp.net - 在 ASP.NET 中查找重定向的原因？

> ID：299695
> 
> 赞同：6
> 
> 时间：2008-11-18T18:36:08.850
> 
> 标签：asp.net, web-config

我试图在我的 web.config 中放入一个异常，以便一页不需要身份验证。但是，它仍然会重定向到登录页面。

**问题不在于如何设置 web.config**。为什么？我们的系统（无论好坏）除了 web.config 之外还有一堆工具。我们有 global.asax 和自定义 HttpHandlers。代码库并不庞大，但重定向的潜在原因很多。

我想知道的是**如何最好地确定重定向的原因**。有什么方法可以找出触发重定向的代码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T19:39:45.213

如果您可以调试应用程序，则从global.asax中的[HttpApplication.BeginRequest开始并](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.beginrequest.aspx)[逐步浏览 System.Web 的参考源](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)将是蛮力方式。

或者，在 HttpResponse.Redirect(string, bool) 上设置断点并遵循调用堆栈 - 我怀疑运行时是否有任何其他方式用于重定向请求。

如果这没有解决任何问题（或者您无法调试），并且由于蛮力方法可能会导致大量代码 - 而且您的问题似乎与安全相关 - 您可能只是挂钩 HttpApplication。AuthenticateRequest 和 HttpApplication。AuthorizeRequest，（及其相关的 Post* 事件）并查看那里的情况。

如果您使用的是表单身份验证，我碰巧知道 FormsAuthenticationModule 在 HttpApplication.EndRequest 查找状态代码 401 来决定是否重定向请求。设置 401（拒绝访问）的任何内容都将导致重定向 - 而不是 401 返回到浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T19:15:57.290

当向需要身份验证的 asp.net 页面发出请求时，asp.net 会重定向到指定的登录页面，并默认提供一个 ReturnUrl 查询字符串参数来标识原始请求的页面。虽然此 ReturnUrl 是可配置的，但如果您没有修改配置，它的存在应该表明身份验证失败。

在这种情况下，您应该专注于对页面的身份验证设置进行故障排除。戈登贝尔的回答看起来不错。

```
<system.web>
...
</system.web>

<location path="NoAuthNeeded.aspx">
    <system.web>
        <authorization>
        <allow roles="*" />
        <allow roles="?" />
        </authorization>
    </system.web>
</location> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T19:49:15.053

此外，如果这仅发生在您的生产应用程序中，您可能能够使用 WinDBG 找出发生了什么。松散地遵循[本文](http://www.cornetdesign.com/2008/06/debugging-net-windows-service-that-is.html)，您将执行以下操作：

*   启动 WinDBG 并附加到 w3wp 进程
*   WinDBG 将断点，因此`.loadby sos mscorwks`会加载 SOS 模块
*   在 CLR 异常上键入`sxe clr`断点
*   输入`g`继续

现在您的应用程序将因任何异常而中断。由于 Response.Redirect 通常会引发 ThreadAbortException，因此它可能是一种简单的中断方法。然后执行 a`!printexception`以获取堆栈跟踪。`~*e!clrstack`如果我的 WinDBG foo 没有让我看到当前正在执行的所有线程的托管堆栈，您也可以这样做。

请注意，您在闯入时冻结了 w3wp 进程，所以要快！

希望您可以改用另一种方法，但如果所有其他方法都失败了，这可能会帮助您入门。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T18:43:47.883

您是否尝试过打开跟踪？这可能会有所帮助。

您如何指定页面不需要身份验证，例如：

```
<system.web>
...
</system.web>

<location path="NoAuthNeeded.aspx">
    <system.web>
        <authorization>
        <allow roles="*" />
        <allow roles="?" />
        </authorization>
    </system.web>
</location> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T19:36:26.453

在每个 HTTP 处理程序的开头放置一个断点，并注意哪个是在重定向发生之前最后调用的处理程序。您可能会在其中找到问题的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-21T10:45:58.437

您可以使用以下方法在您自己的代码中查找重定向：

打开异常设置窗口并搜索“threadabort”。选中 ThreadAbortException 的复选框。现在，当从代码执行重定向时，您的调试会话将进入中断模式。

[![异常设置](https://i.stack.imgur.com/9ANGq.png)](https://i.stack.imgur.com/9ANGq.png)

但是由于您正在谈论 web.config 中的身份验证，因此问题很可能存在，而不是代码中。

仔细检查[HectorMac 的答案](https://stackoverflow.com/a/299808/125938)`authorization`中提到的所有元素是否正确。

# c# - 委托关键字与 lambda 表示法

> ID：299703
> 
> 赞同：188
> 
> 时间：2008-11-18T18:38:08.537
> 
> 标签：c#, .net, delegates, lambda, anonymous-methods

编译后，两者之间是否有区别：

```
delegate { x = 0; } 
```

和

```
() => { x = 0 } 
```

?

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2008-11-18T18:43:35.810

简短的回答：没有。

可能不相关的更长答案：

*   如果将 lambda 分配给委托类型（例如`Func`或`Action`），您将获得匿名委托。
*   如果将 lambda 分配给 Expression 类型，您将获得表达式树而不是匿名委托。然后可以将表达式树编译为匿名委托。

编辑：这是表达式的一些链接。

*   [System.Linq.Expression.Expression(TDelegate)](http://msdn.microsoft.com/en-us/library/bb335710.aspx)（从这里开始）。
*   带有委托（例如 System.Func）的 Linq in-memory 使用[System.Linq.Enumerable](http://msdn.microsoft.com/en-us/library/system.linq.enumerable_methods.aspx)。带有表达式的 Linq to SQL（以及其他任何东西）使用[System.Linq.Queryable](http://msdn.microsoft.com/en-us/library/system.linq.queryable_members.aspx)。查看这些方法的参数。
*   [ScottGu](http://weblogs.asp.net/scottgu/archive/2007/04/08/new-orcas-language-feature-lambda-expressions.aspx)的解释。简而言之，Linq in-memory 会产生一些匿名方法来解决您的查询。Linq to SQL 将生成一个表示查询的表达式树，然后将该树转换为 T-SQL。Linq to Entities 将生成一个表示查询的表达式树，然后将该树转换为适合平台的 SQL。

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2008-11-18T19:32:28.877

我喜欢艾米的回答，但我认为我会很迂腐。问题是“一旦编译” - 这表明两个表达式*都已*编译。它们怎么能同时编译，但一个被转换为委托，一个被转换为表达式树？这是一个棘手的问题——你必须使用匿名方法的另一个特性；唯一不被 lambda 表达式共享的。如果您指定匿名方法而不指定参数列表*，*则它与任何返回 void 且不带任何`out`参数的委托类型兼容。有了这些知识，我们应该能够构造两个重载以使表达式完全明确但非常不同。

但是灾难来袭！至少在 C# 3.0 中，您不能将带有块体的 lambda 表达式转换为表达式 - 也不能将带有赋值的 lambda 表达式转换为主体（即使它被用作返回值）。这可能会随着 C# 4.0 和 .NET 4.0 而改变，它们允许在表达式树中表达更多内容。所以换句话说，对于 MojoFilter 碰巧给出的例子，两者*几乎*总是会被转换成同一个东西。（稍后会详细介绍。）

如果我们稍微改变一下主体，我们可以使用委托参数技巧：

```
using System;
using System.Linq.Expressions;

public class Test
{
    static void Main()
    {
        int x = 0;
        Foo( () => x );
        Foo( delegate { return x; } );
    }

    static void Foo(Func<int, int> action)
    {
        Console.WriteLine("I suspect the anonymous method...");
    }

    static void Foo(Expression<Func<int>> func)
    {
        Console.WriteLine("I suspect the lambda expression...");
    }
} 
```

可是等等！如果我们足够狡猾，即使不使用表达式树，我们也可以区分两者。下面的示例使用重载解析规则（和匿名委托匹配技巧）...

```
using System;
using System.Linq.Expressions;

public class Base
{
    public void Foo(Action action)
    {
        Console.WriteLine("I suspect the lambda expression...");
    }
}

public class Derived : Base
{
    public void Foo(Action<int> action)
    {
        Console.WriteLine("I suspect the anonymous method...");
    }
}

class Test
{
    static void Main()
    {
        Derived d = new Derived();
        int x = 0;
        d.Foo( () => { x = 0; } );
        d.Foo( delegate { x = 0; } );
    }
} 
```

哎哟。记住孩子们，每次你重载从基类继承的方法时，小猫就会开始哭泣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T18:55:28.750

在上面的两个示例中，没有区别，为零。

表达方式：

```
() => { x = 0 } 
```

是带有语句体的 Lambda 表达式，因此不能编译为表达式树。事实上它甚至没有编译，因为它需要在 0 后加一个分号：

```
() => { x = 0; } // Lambda statement body
() => x = 0      // Lambda expression body, could be an expression tree. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T18:59:25.263

艾米 B 是正确的。请注意，使用表达式树可能有一些好处。LINQ to SQL 将检查表达式树并将其转换为 SQL。

您还可以使用 lamdas 和表达式树来有效地将类成员的名称以重构安全的方式传递给框架。 [起订](http://code.google.com/p/moq/)量就是一个例子。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-25T01:44:17.263

它们是有区别的

例子：

```
var mytask = Task.Factory.StartNew(() =>
{
    Thread.Sleep(5000);
    return 2712;
});
mytask.ContinueWith(delegate
{
    _backgroundTask.ContinueTask(() =>lblPercent.Content = mytask.Result.ToString(CultureInfo.InvariantCulture));
}); 
```

我用 lambda:(error) 替换

```
var mytask = Task.Factory.StartNew(() =>
{
    Thread.Sleep(5000);
    return 2712;
});
mytask.ContinueWith(()=>
{
    _backgroundTask.ContinueTask(() =>lblPercent.Content = mytask.Result.ToString(CultureInfo.InvariantCulture));
}); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-05-13T07:14:07.003

这里有一些基础知识。

这是一个匿名方法

```
(string testString) => { Console.WriteLine(testString); }; 
```

由于匿名方法没有名称，我们需要一个委托，我们可以在其中分配这两个方法或表达式。例如

```
delegate void PrintTestString(string testString); // declare a delegate

PrintTestString print = (string testString) => { Console.WriteLine(testString); }; 
print(); 
```

* * *

与 lambda 表达式相同。通常我们需要一个委托来使用它们

```
s => s.Age > someValue && s.Age < someValue    // will return true/false 
```

我们可以使用 func 委托来使用这个表达式。

```
Func< Student,bool> checkStudentAge = s => s.Age > someValue && s.Age < someValue ;

bool result = checkStudentAge ( Student Object); 
```

# python - 让我的 Python 代码第一次运行的好方法是什么？

> ID：299704
> 
> 赞同：53
> 
> 时间：2008-11-18T18:39:05.350
> 
> 标签：python, debugging

我的代码中有很多错误。因此，我希望能够在一开始就将它们最小化，或者在代码执行之前看到尽可能多的错误。这可能吗？如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-11-18T18:48:51.617

如果您遇到语法问题，可以尝试使用语法高亮的编辑器。在你对一种语言有感觉之前，简单的错误不会突然出现在你身上。

最简单的调试形式就是插入一些打印语句。一种更高级（和可扩展）的方法是使用标准库中的[日志记录](http://docs.python.org/library/logging.html#module-logging)模块。

交互式解释器是处理 Python 代码的绝佳工具，而[IPython](http://ipython.org)是对内置 REPL（Read Eval Print Loop）的巨大改进。

如果你真的想单步调试你的代码，python 调试器叫做[pdb](http://docs.python.org/library/pdb.html#module-pdb)，它可以从命令行调用，或者嵌入到你的代码中。

如果您习惯于完全集成的 IDE，我建议您将 Eclipse 与 pydev 结合使用，并且 PyCharm 具有出色的商业产品，具有自动完成、快速访问文档和众多快捷方式以及许多其他有趣的功能。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-11-18T21:18:00.427

以下是一些有助于在 Python 中进行调试的技术：

*   使用交互式外壳，例如[ipython](http://ipython.scipy.org/moin/Documentation)。Python 是一种动态语言，您可以在键入时探索代码。shell 一直在我的编辑器的第二个窗口中运行。

*   将 shell 中的代码复制粘贴到文档字符串中，该代码说明了函数（类、模块）的主要用法和极端情况。`doctest.testmod()`放置在一个`if __name__=="__main__"`部分允许测试模块中的所有文档字符串。[doctest](https://docs.python.org/library/doctest.html)可以很容易地与[unittest](https://docs.python.org/library/unittest.html)集成。

*   用于`assert`永远不会发生的事情。

*   `print()`可以解决很多调试问题；[logging](https://docs.python.org/library/logging.html)模块适用于长期存在的 python 进程。

*   编写测试（不一定在您的代码之前），经常运行它们（自动或最多一次按键）；[鼻子为](http://code.google.com/p/python-nose/)[unittest](https://docs.python.org/library/unittest.html)提供扩展的测试发现和运行功能。

*   偶尔运行[pylint](http://www.logilab.org/card/pylint_tutorial)。

在这一点上，正式的 python 调试器有点用处。 [如果您需要， Winpdb](http://winpdb.org/docs/)是一个外部多平台 GPL 的 GUI python 调试器。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-18T18:55:50.810

所有真正酷的东西都可以在交互式解释器中轻松演示。我认为这可能是优秀设计的“黄金标准”：

**你可以交互式地练习你的课程吗？**

如果您可以交互地做事情，那么您可以自信地编写单元测试和文档测试，相信它是可测试的、简单的、可靠的。

而且，更重要的是，您可以交互式地探索它。没有什么比输入代码并确切地看到发生的事情所带来的即时满足更好的了。

编译的语言习惯（写一堆东西，调试一堆东西，测试一堆东西）可以被抛在后面。相反，你可以写一些东西，探索它，写一个正式的测试，然后将你的一些东西附加到你不断增长的最终项目中。

你还是做整体设计。但是您不会浪费时间编写可能有效也可能无效的代码。在 Python 中，您编写有效的代码。如果你不确定，你可以交互地玩它，直到你确定为止。然后你编写有效的代码。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-18T18:46:43.917

Python 提供了一个调试器，它允许您单步执行代码、检查变量并操作它们。请参阅[http://pythonconquerstheuniverse.wordpress.com/category/python-debugger/](http://pythonconquerstheuniverse.wordpress.com/category/python-debugger/)它可以带您完成这些步骤...

还要检查 pdb 的 python 标准库参考 [http://www.python.org/doc/2.5.2/lib/module-pdb.html](http://www.python.org/doc/2.5.2/lib/module-pdb.html)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-01-10T04:38:53.477

我是 python 新手，一直在尝试几种不同的调试器。以下是我到目前为止遇到的选项：

1.  **Eclipse with Pydev** - 如果您已经在使用 eclipse，这可能是要走的路。调试器运行良好，并且非常有特色。
2.  **Komodo IDE** - 一个轻量级的 python IDE。基本上是一个文本编辑器+一个调试器。这真的很容易弄清楚并立即变得富有成效。
3.  **WinPDB** - 接下来尝试这个。看起来很有特色，我可以使用我选择的任何编辑器。
4.  **PDB** - 还没有尝试过，因为我已经读过 WinPDB 是一个更好的选择。
5.  **带有 %run 命令的 Ipython** - 我使用过 IPython，但不是像这样的调试器。我需要试试这个。（感谢您的提示，EOL）
6.  **Eric IDE** - 也可以尝试。
7.  **老派打印，断言语句**- 简单，有用，但不是完整的解决方案。

**内存调试**——为了调试内存问题，我遇到了一些工具：

1.  **objgraph** - 将生成 png 的参考图。整洁的。还有其他功能，例如： import objgraph;print(objgraph.show_most_common_types(limit=10)) 将打印内存中最常见的 10 种类型。
2.  **gc 模块**- 直接与垃圾收集器交互。
3.  **heapy** - 堆分析器。例如：从 guppy 导入 hpy；hp = hpy(); print(hp.heap()) 将打印最常见的类型、它们的内存使用情况等。

这是一个非常不完整的列表，但希望这是一个好的开始。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-18T18:46:48.690

尽早测试并经常测试。

这并不一定意味着首先跳入测试驱动设计池的头部（尽管这不是一个坏主意）。这只是意味着，一旦你有一些有用的东西，就立即测试你的对象和方法。不要等到有一大堆代码才进行测试。

花一些时间学习测试框架。如果输入测试用例对您来说是微不足道的，那么您更有可能这样做。如果你没有任何类型的框架测试可能会很痛苦，所以你会避免它。所以，尽早建立一些好习惯，你以后会遇到更少的问题。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-18T22:24:11.870

通常，我只是使用一堆打印语句。

```
page = grabpage(url)
print "Page content:", page
print "page type():", type(page) 
```

有时执行以下操作很有用：

```
debug = True
if debug: print "page content", page 
```

..有了这个，您可以通过将调试变量更改为 False 来快速禁用所有调试打印语句。

虽然在大多数情况下打印调试会让你走得很远，但有时很难调试诸如循环或一系列 if/else/try/except/etc 之类的东西。为此，允许单步执行代码并设置断点的调试器很有用。

`pdb`包含在 Python 中。[这](http://www.ferg.org/papers/debugging_in_python.html)是一个很好的简单教程。您甚至可以在运行时（本教程涵盖）期间执行更改变量之类的操作。更长的教程可以在[这里找到](http://www.onlamp.com/pub/a/python/2005/09/01/debugger.html)

有一个非常好的 GUI 等效 pdb - [Winpdb](http://winpdb.org/)

基本上你运行`winpdb myscript --arg 4 -b 4`然后它在终端中加载命令，在左侧显示你的代码，当前，本地/全局变量列表（及其值）和当前调用堆栈。

然后，您可以通过单击 Step（或 F6）单步执行代码。F5 运行代码。如果您单击行号旁边，它会设置一个断点，代码将自动执行（当您按下运行时）。

我发现它更容易使用，并且它有很多额外的增强功能（比如远程调试，所以你可以`rpdb2`在待调试的应用程序中运行后端部分（），并将 Winpdb 连接到它（加密）。它还有支持 PDB 中没有的线程和其他有用的东西。您也可以访问类似 pdb 的控制台。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-11-18T22:21:40.363

[我使用这个技巧](http://code.activestate.com/recipes/65287/)将 Python 设置为在出现未捕获的异常时自动启动调试器。这样，您可以轻松检查程序的状态，而无需太多的日志记录代码。（另外，向我发送[Growl 通知](http://blog.mckuhn.de/2007/10/sending-growl-notifications-from-python.html)。）

哦，这样你就可以通过添加在代码中创建一个断点

```
if answer == 42:
    1/0 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-18T18:47:46.083

自由地使用断言语句。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-18T21:13:40.110

在执行之前识别错误是静态检查/分析的领域。我很幸运使用[PyChecker](http://pychecker.sourceforge.net/)对 Python 代码进行基本静态检查。

pycheesecake 网站对 Python的测试工具有很好的[总结。](http://pycheesecake.org/wiki/PythonTestingToolsTaxonomy)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-11-18T22:36:21.707

eclipse 的 PyDev 插件是我的首选工具。它识别简单的语法错误和缩进错误，并用红线强调错误。它有一个强大的调试器，甚至还有一个名为 PyLint 的插件，它会警告你危险代码。

编辑：它还具有用户友好的运行时错误堆栈跟踪、部分自动完成和其他一些漂亮的功能。

再次编辑：我没有注意到顶部帖子中提到了 pydev。我希望我带来了其他东西。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-18T18:47:44.507

python -m pdb yourcode.py 应该这样做。或者，您可以在代码中“导入 pdb”并使用 pdb.set_trace() 设置断点。有关更多信息，请参阅手册：http: [//www.python.org/doc/2.5.2/lib/module-pdb.html](http://www.python.org/doc/2.5.2/lib/module-pdb.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-07T07:18:01.787

Python 有一个非常好的 GUI 调试器，叫做[Winpdb](http://winpdb.org/)。试试看。基于 wxWidgets 库和多平台构建。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-04T12:38:07.210

为了获得最集成的体验，您可以使用完整的 IDE，例如 PyCharm：

[http://blog.jetbrains.com/pycharm/files/2011/05/template-debug2.png](http://blog.jetbrains.com/pycharm/files/2011/05/template-debug2.png)![在此处输入图像描述](https://i.stack.imgur.com/2QeaQ.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-03-29T10:02:27.507

Eric4 IDE 也有一个很棒的内置调试器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-01-06T09:18:49.007

[IPython](http://ipython.scipy.org/doc/manual/html/interactive/tutorial.html) Python shell 有一个`%pdb`命令可以在出现问题时自动调用[调试器。](http://ipython.scipy.org/doc/manual/html/interactive/tutorial.html#debug-a-python-script)然后，您可以检查变量、逐步执行代码等。

您可以使用该命令从 IPython[运行程序。](http://ipython.scipy.org/doc/manual/html/interactive/tutorial.html#the-run-magic-command)`%run`

更一般地说，正如在其他一些答案中所指出的那样，一个好的 Python shell 是你的朋友。IPython 是你最好的朋友。:)

# jsp-tags - JSPTag：异常 - 此属性不支持请求时间值

> ID：299715
> 
> 赞同：1
> 
> 时间：2008-11-18T18:44:08.493
> 
> 标签：jsp-tags

我收到“此属性不支持请求时间值”。在编译我的自定义 jsp 标签实现时。

我的顶级域名文件

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE taglib PUBLIC "-//Sun Microsystems, Inc.//DTD JSP Tag Library 1.1//EN" "http://java.sun.com/j2ee/dtds/web-jsptaglibrary_1_1.dtd">
<taglib>
    <tlibversion>1.0</tlibversion>
    <jspversion>1.1</jspversion>
    <shortname>My Extension</shortname>
    <info>Customization Extensions</info>
  <tag>
    <name>requireDisplay</name>
    <tagclass>com.view.LinksTag</tagclass>
    <teiclass>com.view.LinksTagExtraInfo</teiclass>
    <bodycontent>JSP</bodycontent>
    <info> My Tags Exercise
    </info>
  <attribute>
      <name>viewID</name>
      <required>true</required>
      <rtexpvalue>true</rtexpvalue>
  </attribute>
  <attribute>
      <name>viewType</name>
      <required>true</required>
      <rtexpvalue>true</rtexpvalue>
  </attribute>
</tag>
</taglib> 
```

我的 JSP 标签实现有以下方法

```
/**
 * doStartTag is called by the JSP container when the tag is encountered
 */
public int doStartTag() throws JspException {
    try {
        JspWriter out = pageContext.getOut();
        out.println(getContent());
    } catch (Exception ex) {
        throw new ElmsUncheckedException(ex);
    }
    // Must return SKIP_PAGE because we are done with the content.
    return SKIP_BODY;
}

/**
 * getContent is called by the startTag to print the Request View button
 * contents.
 */
private String getContent() {
    String linkURL = ViewConstants.BASE_URL;
    StringBuffer sbuffer = new StringBuffer();
    sbuffer.append("<form name=\"postView\" action=\"" + linkURL + "\" target=\"_blank\" method=\"POST\">\n");
    sbuffer.append("<input type=\"hidden\" name=\"ID\" value=\"" + viewID + "\" />\n");
    sbuffer.append("<input type=\"hidden\" name=\"Type\" value=\"" + viewType + "\" />\n");
    sbuffer.append("<tr>\n");
    sbuffer.append("<td class=\"BodyBG\">\n");
    sbuffer
            .append("<button type=\"submit\" class=\"GridButton\" name=\"dispatch\" value=\"postView\">postView</button> \n");
    sbuffer.append("</td><td width=\"1\"></td>\n");
    sbuffer.append("</tr>\n");
    sbuffer.append("</form>\n");
    return sbuffer.toString();
}

public int doEndTag() throws JspException {
    resetVariables();
    return EVAL_PAGE;
} 
```

我的jsp有以下

```
<%@ taglib uri="/WEB-INF/view.tld" prefix="cmd" %>

.....

<cmd:requireDisplay viewID="<%=vox.getViewID()%>" viewType="<%=vox.getViewType()%>"/> 
```

但我收到以下异常

```
[jspc] Error encountered while compiling 'jspURI'
view_details.jsp:136:22: The required attribute "viewID" is missing.

                   <cmd:requireDisplay viewID="<%=vox.getViewID()%>" viewType="<%=vox.getViewType()%>"/>

                     ^----------------------^

view_details.jsp:136:22: The required attribute "viewType" is missing.

                   <cmd:requireDisplay viewID="<%=vox.getViewID()%>" viewType="<%=vox.getViewType()%>"/>

                     ^----------------------^

view_details.jsp:136:42: This attribute does not support request time values.

                   <cmd:requireDisplay viewID="<%=vox.getViewID()%>" viewType="<%=vox.getViewType()%>"/>

                                                         ^---------^

view_details.jsp:136:57: This attribute does not support request time values.

                   <cmd:requireDisplay viewID="<%=vox.getViewID()%>" viewType="<%=vox.getViewType()%>"/>

                                                                                                                         ^----------^ 
```

我错过了什么吗？就像在 tld 中一样，即使我也尝试提供 TagExtraInfo。但没有运气。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T23:29:52.097

我弄清楚了这个问题。这是一个错字:(

```
 <rtexpvalue>true</rtexpvalue> 
```

条目假设是

```
 <rtexprvalue>true</rtexprvalue> 
```

# c - 虚拟区域到页面

> ID：299719
> 
> 赞同：3
> 
> 时间：2008-11-18T18:45:57.630
> 
> 标签：c, linux, memory-management, linux-kernel, kernel

在 Linux 内核中，给定`task_struct`s`mm`我可以访问进程的`vm_area_struct`s 列表。给定这些`vm_area_struct`s，我如何获得`struct page`实际对应于这个 vma 的 s？

我尝试在 mm/memory.c 等中寻找函数，但不知所措。

编辑：想法是找出 vma 中的哪些页面当前在内存中，哪些不在内存中。但我**不**希望有人告诉我该怎么做，因为这是我需要自己弄清楚的家庭作业的一小部分。但我似乎无法弄清楚如何找到与这个 vma 对应的页面。如果我能找到这些页面，我想我可以检查它们是否有有效的 pfn。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T19:40:10.017

从您的评论到另一个答案（编辑：另一个答案似乎已被删除），您似乎想从用户空间读取。获取用户空间页面的功能是[`get_user_pages()`](http://lwn.net/Articles/28548/)，但这很可能不是您想要的；你可能想要`copy_from_user`/ `copy_to_user`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:54:50.837

我没有直接的答案，但是使用 lxr.linux.no 导航结构不会花很长时间

鉴于您已经有了想要开始的结构，请查看[http://lxr.linux.no/linux+v2.6.29/+code=vm_area_struct](http://lxr.linux.no/linux+v2.6.29/+code=vm_area_struct)。您可以查找定义，查看使用单个结构的位置等...如果您已经知道要查找的最终结构名称，则可以反向并向上导航直到到达 mm。

请注意，如果您的网络连接不太好，您可能希望通过获取发行版的 lxr 包并在本地生成索引来安装索引源的本地副本。过去在 400mhz / 128mb 机器上需要 2 个小时，现在它应该快得多。

# c# - SAML 与 .NET 2.0

> ID：299721
> 
> 赞同：5
> 
> 时间：2008-11-18T18:46:18.393
> 
> 标签：c#, .net-2.0, saml

我的任务是与 SAML 合作，在我的公司和第三方提供商之间实施 SSO 解决方案。我唯一的问题是我似乎找不到如何在 C# 2.0 中实现 SAML。我已经找到了一些 .Net 3.0 和 3.5 的示例，但没有找到 2.0 的示例（而且他们使用的类似乎在 2.0 中不可用）。有谁知道使用 SAML 和 C# 2.0 的任何在线示例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T03:46:09.147

很抱歉这么晚了，但我遇到了和你一样的问题。但是我在 .NET 2.0 中找到了一个很好的解决方案，即 OIOSAML.NET（目前是 v. 1.4）。

[http://www.softwareborsen.dk/projekter/softwarecenter/brugerstyring/oiosaml.net/releases/1.4/oiosaml-dot-net-v1-4.zip](http://www.softwareborsen.dk/projekter/softwarecenter/brugerstyring/oiosaml.net/releases/1.4/oiosaml-dot-net-v1-4.zip)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T01:28:31.687

除非您能找到第三方实现，否则您将不得不升级到 v2.0 以上。可能不是你想听到的，对不起...

# visual-studio - 如何将菜单恢复到 Visual Studio 2008 菜单栏？

> ID：299722
> 
> 赞同：2
> 
> 时间：2008-11-18T18:46:19.190
> 
> 标签：visual-studio, visual-studio-2008

我的 Alt 键在不知不觉中被卡住了，我试图在 VS 中打开我的窗口菜单，这导致从栏中删除了菜单。

我的问题是，我怎么能把它拿回来？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-18T18:50:10.023

右键单击可见的工具栏之一，选择**自定义...**
（或**工具 > 自定义...**菜单）

然后在**Toolbars**列表中，选择**Menu Bar**，然后单击**Reset**按钮

# database - 我可以在 CouchDB 中进行事务和锁定吗？

> ID：299723
> 
> 赞同：82
> 
> 时间：2008-11-18T18:46:24.323
> 
> 标签：database, couchdb, nosql

我需要做事务（开始、提交或回滚）、锁定（选择更新）。我怎样才能在文档模型数据库中做到这一点？

编辑：

情况是这样的：

*   我想经营一个拍卖网站。
*   我也认为如何直接购买。
*   在直接购买中，我必须减少项目记录中的数量字段，但前提是数量大于零。这就是为什么我需要锁和事务。
*   我不知道如何在没有锁和/或事务的情况下解决这个问题。

我可以用 CouchDB 解决这个问题吗？

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2008-11-18T18:51:23.953

不，CouchDB 使用“乐观并发”模型。用最简单的术语来说，这只是意味着您将文档版本与更新一起发送，如果当前文档版本与您发送的内容不匹配，CouchDB 将拒绝更改。

看起来很简单，真的。您可以为 CouchDB 重构许多基于常规事务的场景。不过，在学习 CouchDB 时，您确实需要放弃您的 RDBMS 领域知识。从更高的层次解决问题是有帮助的，而不是试图将 Couch 塑造成一个基于 SQL 的世界。

**跟踪库存**

您概述的问题主要是库存问题。如果您有一个描述项目的文档，并且它包含一个“可用数量”字段，您可以处理这样的并发问题：

1.  检索文档，记下`_rev`CouchDB 发送的属性
2.  减少数量字段，如果它大于零
3.  `_rev`使用属性将更新的文档发回
4.  如果`_rev`匹配当前存储的号码，完成！
5.  如果有冲突（当`_rev`不匹配时），检索最新的文档版本

在这种情况下，需要考虑两种可能的故障情况。如果最新文档版本的数量为 0，则您可以像在 RDBMS 中一样处理它，并提醒用户他们实际上无法购买他们想要购买的东西。如果最新文档版本的数量大于 0，您只需使用更新的数据重复操作，然后从头开始。这迫使您比 RDBMS 做更多的工作，并且如果有频繁的、冲突的更新，可能会有点烦人。

现在，我刚刚给出的答案假定您将在 CouchDB 中以与在 RDBMS 中相同的方式做事。我可能会以不同的方式处理这个问题：

我将从包含所有描述符数据（名称、图片、描述、价格等）的“主产品”文档开始。然后我会为每个特定实例添加一个“库存单”文档，其中包含 和`product_key`字段`claimed_by`。如果您要销售一种锤子模型，并且有 20 个要出售，那么您可能有带有 、 等键的文档`hammer-1`来`hammer-2`表示每个可用的锤子。

然后，我将创建一个视图，为我提供可用锤子的列表，并使用 reduce 函数让我看到“总数”。这些完全是即兴的，但应该让您了解工作视图的外观。

**地图**

```
function(doc) 
{ 
    if (doc.type == 'inventory_ticket' && doc.claimed_by == null ) { 
        emit(doc.product_key, { 'inventory_ticket' :doc.id, '_rev' : doc._rev }); 
    } 
} 
```

这为我提供了按产品密钥列出的可用“门票”列表。当有人想买一把锤子时，我可以抓住其中的一组，然后迭代发送更新（使用`id`and `_rev`）直到我成功申领一个（之前申领的票会导致更新错误）。

**减少**

```
function (keys, values, combine) {
    return values.length;
} 
```

这个 reduce 函数只返回无人认领的物品总数`inventory_ticket`，因此您可以知道有多少“锤子”可供购买。

**注意事项**

对于您提出的特定问题，这个解决方案代表了大约 3.5 分钟的总思考时间。可能有更好的方法来做到这一点！也就是说，它确实大大减少了冲突更新，并减少了使用新更新来响应冲突的需要。在此模型下，您不会有多个用户尝试更改主要产品条目中的数据。在最坏的情况下，您将有多个用户试图索取一张票，如果您从您的视图中抓取了其中的几个，您只需转到下一张票并再试一次。

参考：[https ://wiki.apache.org/couchdb/Frequently_asked_questions#How_do_I_use_transactions_with_CouchDB.3F](https://wiki.apache.org/couchdb/Frequently_asked_questions#How_do_I_use_transactions_with_CouchDB.3F)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-11-25T10:02:12.037

扩展库尔特先生的答案。对于很多场景，您不需要按顺序兑换股票。您可以从剩余的票中随机选择，而不是选择第一张票。给定大量票证和大量并发请求，与每个人都试图获得第一个票证相比，这些票证的争用将大大减少。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-07-31T23:01:59.983

restfull 事务的设计模式是在系统中创建一个“张力”。对于银行账户交易的流行示例用例，您必须确保更新两个相关账户的总数：

*   创建交易凭证“将 10 美元从账户 11223 转移到账户 88733”。这会在系统中产生张力。
*   解决所有交易文件的任何紧张扫描和
    *   如果源账户尚未更新，则更新源账户（-10 美元）
    *   如果源帐户已更新但交易文档未显示此内容，则更新交易文档（例如在文档中设置标志“sourcedone”）
    *   如果目标账户尚未更新，则更新目标账户（+10 美元）
    *   如果目标账户已更新，但交易文件未显示，则更新交易文件
    *   如果两个帐户都已更新，您可以删除交易文件或将其保留以供审计。

张力扫描应该在所有“张力文件”的后端过程中完成，以保持系统中的张力时间短。在上面的示例中，当第一个帐户已更新但第二个帐户尚未更新时，将出现短时间预期的不一致。如果您的 Couchdb 是分布式的，则必须以与处理最终一致性相同的方式考虑这一点。

另一种可能的实现完全避免了事务的需要：只需存储张力文档并通过评估每个涉及的张力文档来评估系统的状态。在上面的示例中，这意味着一个帐户的总额仅被确定为涉及该帐户的交易文档中的总和值。在 Couchdb 中，您可以很好地将其建模为 map/reduce 视图。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-10-25T03:28:31.207

不，CouchDB 通常不适合事务性应用程序，因为它不支持集群/复制环境中的原子操作。

CouchDB 牺牲了事务能力以支持可扩展性。为了进行原子操作，您需要一个中央协调系统，这限制了您的可扩展性。

如果您可以保证您只有一个 CouchDB 实例，或者修改特定文档的每个人都连接到同一个 CouchDB 实例，那么您可以使用冲突检测系统使用上述方法创建一种原子性，但如果您稍后扩展到集群或者使用像 Cloudant 这样的托管服务，它会崩溃，你必须重做系统的那部分。

所以，我的建议是使用 CouchDB 以外的其他东西作为您的帐户余额，这样会容易得多。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-08-09T16:17:06.343

作为对 OP 问题的回应，Couch 可能不是这里的最佳选择。使用视图是跟踪库存的好方法，但钳制到 0 或多或少是不可能的。当您阅读视图结果时，问题是竞争条件，决定您可以使用“hammer-1”项目，然后编写一个文档来使用它。问题是，如果视图的结果是 > 0 个锤子-1，则没有原子方法可以仅编写文档以使用锤子。如果 100 个用户同时查询视图并看到 1 个锤子-1，他们都可以编写一个文档来使用锤子 1，从而产生 -99 个锤子-1。在实践中，竞争条件会相当小——如果您的数据库运行的是 localhost，则非常小。但是，一旦您扩展并拥有一个异地数据库服务器或集群，问题就会变得更加明显。

MrKurt 回复的更新（可能只是过时了，或者他可能不知道某些 CouchDB 功能）

视图是处理 CouchDB 中的余额/库存等事情的好方法。

您不需要在视图中发出 docid 和 rev。当您检索查看结果时，您可以免费获得这两个。发出它们——尤其是像字典这样冗长的格式——只会让你的视图不必要地变大。

用于跟踪库存余额的简单视图应该看起来更像这样（我也想不到）

```
function( doc )
{
    if( doc.InventoryChange != undefined ) {
        for( product_key in doc.InventoryChange ) {
            emit( product_key, 1 );
        }
    }
} 
```

而reduce函数就更简单了

```
_sum 
```

这使用了一个[内置的 reduce 函数](http://wiki.apache.org/couchdb/Built-In_Reduce_Functions)，它只是将所有行的值与匹配的键相加。

在此视图中，任何文档都可以有一个成员“InventoryChange”，该成员将 product_key 映射到它们的总库存的变化。IE。

```
{
    "_id": "abc123",
    "InventoryChange": {
         "hammer_1234": 10,
         "saw_4321": 25
     }
} 
```

将添加 10 个hammer_1234 和 25 个 saw_4321。

```
{
    "_id": "def456",
    "InventoryChange": {
        "hammer_1234": -5
    }
} 
```

会从库存中烧掉 5 把锤子。

使用此模型，您永远不会更新任何数据，只会追加。这意味着没有更新冲突的机会。更新数据的所有事务问题都消失了 :)

这个模型的另一个好处是数据库中的任何文档都可以从库存中添加和减去项目。这些文档中可以包含各种其他数据。您可能有一个“装运”文档，其中包含有关接收日期和时间、仓库、接收员工等的大量数据，只要该文档定义了 InventoryChange，它就会更新库存。就像“Sale”文档和“DamagedItem”文档等一样。查看每个文档，他们读得很清楚。视图处理所有艰苦的工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-20T08:09:54.137

实际上，你可以在某种程度上。查看[HTTP 文档 API](http://wiki.apache.org/couchdb/HTTP_Document_API)并向下滚动到标题“使用单个请求修改多个文档”。

*基本上，您可以在对URI /{dbname}/_bulk_docs*的单个发布请求中创建/更新/删除一堆文档，它们要么全部成功，要么全部失败。不过，该文件确实警告说，这种行为将来可能会改变。

编辑：正如预测的那样，从 0.9 版开始，批量文档不再以这种方式工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-21T04:10:49.723

只需使用 SQlite 一种轻量级的事务解决方案，当事务成功完成后复制它，并在 SQLite 中标记它已复制

SQLite 表

```
txn_id    , txn_attribute1, txn_attribute2,......,txn_status
dhwdhwu$sg1   x                    y               added/replicated 
```

您也可以删除复制成功的事务。

# unix - 如何在脚本中使用 newgrp 然后在脚本退出时留在该组中

> ID：299728
> 
> 赞同：14
> 
> 时间：2008-11-18T18:46:57.877
> 
> 标签：unix, shell, solaris, csh

我在 solaris Box 上运行脚本。特别是 SunOS 5.7。我不是根。我正在尝试执行类似于以下内容的脚本：

> > newgrp thegroup << FOO
> > source .login_stuff
> > echo "hello world"
> > FOO

脚本运行。问题是它返回到调用进程，这使我进入了旧组，而源 .login_stuff 没有被获取。我理解这种行为。我正在寻找的是一种留在子外壳中的方法。现在我知道我可以在脚本中放一个 xterm&（见下文），这样就可以了，但是有一个新的 xterm 是不可取的。

> 将您当前的 pid 作为参数传递。
> 
> > newgrp thegroup << FOO
> > source .login_stuff
> > xterm&
> > echo $1
> > kill -9 $1
> > FOO

我没有可用的 sg。此外，newgrp 是必要的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-09-08T11:33:09.283

以下效果很好；将以下位放在（Bourne 或 Bash）脚本的顶部：

```
### first become another group
group=admin

if [ $(id -gn) != $group ]; then
  exec sg $group "$0 $*"
fi

### now continue with rest of the script 
```

这在 Linuxen 上运行良好。一个警告：包含空格的参数被分开了。我建议您使用 env arg1='value 1' arg2='value 2' script.sh 构造来传递它们（由于某种原因，我无法让它与 $@ 一起使用）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-18T19:47:58.567

该`newgrp`命令只能从交互式外壳 AFAICT 中有意义地使用。事实上，我放弃了关于......好吧，让我们说很久以前我写的替代品现在有资格在英国和美国投票。

请注意，这`newgrp`是一个“内置”外壳的特殊命令。严格来说，它是 shell 外部的命令，但 shell 具有关于如何处理它的内置知识。shell 实际上`exec`就是程序，所以之后你会立即得到一个新的 shell。它也是一个 setuid 根程序。至少在 Solaris 上，`newgrp`似乎也忽略了 SHELL 环境变量。

我有各种各样的程序可以解决`newgrp`想要解决的问题。请记住，该命令早于用户同时属于多个组的能力（请参阅第[7 版 Unix 手册](http://netlib.bell-labs.com/7thEdMan/)）。由于`newgrp`不提供在执行命令后执行命令的机制，与`su`or不同`sudo`，我编写了一个程序`newgid`，该程序与 or 一样`newgrp`，是一个 setuid 根程序，允许您从一个组切换到另一个组。它相当简单——只需要 main() 加上一组标准化的错误报告函数。联系我（第一个点最后在 gmail dot com）获取来源。我还有一个更危险的命令，叫做 '`asroot`' 这让我（但只有我 - 在默认编译下）可以更彻底地调整用户和组列表。

```
asroot: Configured for use by jleffler only
Usage: asroot [-hnpxzV] [<uid controls>] [<gid controls>] [-m umask] [--] command [arguments]
    <uid controls> = [-u usr|-U uid] [-s euser|-S euid][-i user]
    <gid controls> = [-C] [-g grp|-G gid] [-a grp][-A gid] [-r egrp|-R egid]
Use -h for more help

Option summary:
 -a group  Add auxilliary group (by name)
 -A gid    Add auxilliary group (by number)
 -C        Cancel all auxilliary groups
 -g group  Run with specified real GID (by name)
 -G gid    Run with specified real GID (by number)
 -h        Print this message and exit
 -i        Initialize UID and GIDs as if for user (by name or number)
 -m umask  Set umask to given value
 -n        Do not run program

 -p        Print privileges to be set
 -r euser  Run with specified effective UID (by name)
 -R euid   Run with specified effective UID (by number)
 -s egroup Run with specified effective GID (by name)
 -S egid   Run with specified effective GID (by number)
 -u user   Run with specified real UID (by name)
 -U uid    Run with specified real UID (by number)
 -V        Print version and exit
 -x        Trace commands that are executed
 -z        Do not verify the UID/GID numbers
Mnemonic for effective UID/GID:
    s is second letter of user;
    r is second letter of group 
```

（这个程序成长了：如果我从头开始重做，我会接受用户 ID 或用户名，而不需要不同的选项字母；组 ID 或组名也是如此。）

获得安装 setuid root 程序的权限可能很棘手。由于多组设施，现在有一些解决方法可用。一种可行的技术是在您希望创建文件的目录上设置 setgid 位。这意味着无论谁创建文件，该文件都将属于拥有该目录的组。这通常可以达到您需要的效果 - 尽管我知道很少有人一直使用它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-02T22:37:22.197

这个例子是从 plinjzaad 的回答扩展而来的；它处理一个命令行，其中包含包含空格的引号参数。

```
#!/bin/bash
group=wg-sierra-admin
if [ $(id -gn) != $group ]
then
    # Construct an array which quotes all the command-line parameters.
    arr=("${@/#/\"}")
    arr=("${arr[*]/%/\"}")
    exec sg $group "$0 ${arr[@]}"
fi

### now continue with rest of the script
# This is a simple test to show that it works.
echo "group: $(id -gn)"
# Show all command line parameters.
for i in $(seq 1 $#)
do
    eval echo "$i:\${$i}"
done 
```

我用它来证明它有效。

```
% ./sg.test  'a b' 'c d e' f 'g h' 'i j k' 'l m' 'n o' p q r s t 'u v' 'w x y z'
group: wg-sierra-admin
1:a b
2:c d e
3:f
4:g h
5:i j k
6:l m
7:n o
8:p
9:q
10:r
11:s
12:t
13:u v
14:w x y z 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-09T21:27:57.873

```
newgrp adm << ANYNAME
# You can do more lines than just this.
echo This is running as group \$(id -gn)
ANYNAME 
```

..将输出：

```
This is running as group adm 
```

小心——确保用斜杠转义“$”。交互有点奇怪，因为它在作为另一个组执行 shell 之前扩展了单引号。因此，如果您的主要组是“用户”，而您尝试使用的组是“adm”，那么：

```
newgrp adm << END
# You can do more lines than just this.
echo 'This is running as group $(id -gn)'
END 
```

..将输出：

```
This is running as group users 
```

..因为 'id -gn' 是由当前 shell 运行的，然后发送到以 adm 身份运行的那个。无论如何，我知道这篇文章很古老，但希望这对某人有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T19:01:35.307

也许

```
exec $SHELL 
```

会成功吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T19:26:17.550

您可以使用 sh& （或您想使用的任何外壳）而不是 xterm&

或者你也可以考虑使用别名（如果你的 shell 支持这个），这样你就可以留在当前 shell 的上下文中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-28T13:19:20.860

在脚本文件中，例如 tst.ksh：

```
#! /bin/ksh
/bin/ksh -c "newgrp thegroup" 
```

在命令行：

```
>> groups fred
oldgroup
>> tst.ksh

>> groups fred
thegroup 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-28T08:35:16.817

```
sudo su - [user-name] -c exit; 
```

应该做的伎俩:)

# javascript - Javascript 到 Flash 通信

> ID：299729
> 
> 赞同：8
> 
> 时间：2008-11-18T18:47:02.403
> 
> 标签：javascript, flash, actionscript

我正在尝试从 javascript 调用 Actionscript 函数，但在 Internet Explorer 中遇到问题。我在 mootools 1.2.1 中使用 Swiff.remote 来调用 actionscript 函数，即：

```
Swiff.remote(playSwf.toElement(), 'sendResult', result, plays, name); 
```

这一切在 FireFox、Safari 和 Opera 中运行良好，但在 Internet Explorer 6 和 7 中出现“未指定”错误。我尝试使用 bog 标准：

```
window['flash'].sendResult(result, plays, name); 
```

无济于事。

谢谢你的帮助。标记

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T19:41:55.397

我不熟悉 Swiff 插件，但您不需要插件即可从 Javascript 调用 flash 函数。在本地实现它甚至更容易。

从作为：

```
//1\. calling javascript function from Flash.
ExternalInterface.call("sendData",tempStr);
// argument 1: javascript function, argument 2: data/variables to pass out.
//2\. calling javascript function from Flash with recursion.
var returnValue:String = ExternalInterface.call("sendReturn",tempStr).toString();
//3\. setting up a callback function for javascript
ExternalInterface.addCallback("callFlash",flashResponse);
// argument 1: function name called by javascript, argument 2: function on the Flash side.
// AS2 version looks like this : ExternalInterface.addCallback("callFlash",null,flashResponse); 
```

来自 JS：

```
//1\. javascript function as called from Flash.
function sendData(val){
    alert(val);
    document.flashForm.flashOutput.value = val;
}

//2\. javascript function with recursion.
function sendReturn(val){
    var tempData = "Hello from JS";
    return tempData + ' :return';
}

//3\. calling Flash function with javascript.
function sendToFlash(val){
    window['flash'].callFlash(val);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T20:28:56.393

啊，这是你问题的答案。

```
<form>
    <input type="button" onclick="callExternalInterface(id)" value="Call ExternalInterface" />
</form>
<script>
function callExternalInterface(id) {
    thisMovie("externalInterfaceExample").callAS(id);
}

function thisMovie(movieName) {
    if (navigator.appName.indexOf("Microsoft") != -1) {
        return window[movieName]
    }
    else {
        return document[movieName]
    }
}
</script> 
```

因此，如果客户端是 Internet Explorer，您应该从文档对象中获取电影。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T21:51:44.237

如果您的代码可以在除 Internet Explorer 之外的所有浏览器中运行，那肯定是因为用于 IE 的 Flash Player 是一个 ActiveX 插件。我在某处读到 ActiveX 以 .NET 格式进行通信，而 Flash 的外部 API 以 XML 进行通信。

我也在尝试在 Internet Explorer 上学习 Javascript-Flash 通信，所以我会及时向大家发布我所学的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T16:33:40.750

想发布这个答案，因为这*可能*是给其他人造成问题的原因，显然这不会导致您的问题。仍在为您的问题寻找解决方案。

来自 MooTools 文档： http: [//mootools.net/docs/Utilities/Swiff](http://mootools.net/docs/Utilities/Swiff) 注意：

SWF 文件必须与 ExternalInterface 组件一起编译。有关详细信息，请参阅有关外部接口的 Adob​​e 文档。

动作脚本 2.0

```
import flash.external.*; 
```

动作脚本 3.0

```
package com
{
   import flash.external.ExternalInterface;
   public class Main 
   {
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T16:42:29.173

也许这可以帮助你，看起来像一个类似的问题，但使用 swfobject。

[http://blog.deconcept.com/swfobject/forum/discussion/1064/swfobject-21-problems-with-externalinterface-in-ie/](http://blog.deconcept.com/swfobject/forum/discussion/1064/swfobject-21-problems-with-externalinterface-in-ie/)

祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T15:15:39.830

你可以直接调用它：

```
playSwf.remote('sendResult', result, plays, name) 
```

当然`sendResult`必须`ExternalInterface.addCallback()`在 AS 代码中注册，*并且*闪存文件必须完全加载（否则所有调用都会失败）。

可以在这个[github 存储库 (fancyupload)](http://github.com/digitarald/digitarald-fancyupload/tree/master/source)中找到一个示例： as3proj 包含 AS 源代码，JS 远程调用位于*Swiff.Uploader.js*中。

# svn - SVN 配置文件问题重访

> ID：299734
> 
> 赞同：0
> 
> 时间：2008-11-18T18:47:59.857
> 
> 标签：svn, tortoisesvn

我搜索并找到[了这个问题](https://stackoverflow.com/questions/233441/svn-how-do-i-maintain-my-local-configblah-file)，但不喜欢这个答案。

是否有另一种方法让 SVN 忽略就地签入的配置文件（您无法签入更改），但必须在您的系统上进行修改。

这是 SVN 的一次非常严重的失败，实际上是我对该系统的第一次失望。我希望有人想出一个窍门，也许只是将配置文件分支到一个新分支上，而其他所有内容都指向原始分支。也许修改 .svn 目录？

必须有比模板/副本更好的解决方案，这似乎无法维护。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T22:14:01.347

我们通过以下方式解决这个问题：

所有开发机器都是一致的。我们都是从 c:\projects\TopGear\trunk 开发出来的...我们都将我们的 SQL 服务器别名为 PROJECTNAME（例如 TOPGEAR）。我们都使用相同的 IIS 主机名 (TopGearDev)

当我们进行部署时，我们的 NANT 部署构建脚本会根据需要重写所有配置，因此我们无需担心设置 - 所有相关的设置都会被重写。

额外的好处：构建服务器（我们使用 TeamCity）设置起来很*简单*。

它咬了我们一两次，轻微的，但其他方面都很好。

不是 SVN 特定的（虽然我们使用的是 SVN），但是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T21:55:26.093

在搞砸了几个小时后，我想我有一个答案。既然这是我自己的问题，我想我会让它成为社区维基......

我创建了整个存储库的一个分支，并将“配置”类型的文件指向新分支，然后将它们签入。

我不确定这将如何发挥作用，但它使“检查所有内容”的东西正常工作。我想如果我更改其中一个文件，它会正常工作，将其签入我的本地存储库。

唯一可能令人烦恼的是，如果其他人更改了我已分支的文件，我不确定如何确定我应该合并的事实。

# c# - 在 XDocument 中定位和设置元素值的最有效方法是什么？

> ID：299747
> 
> 赞同：1
> 
> 时间：2008-11-18T18:52:32.220
> 
> 标签：c#, .net, xml, linq-to-xml

给定以下 XML“模板”：

```
<Request module="CRM" call="list_service_features" id="{ID}">
  <block name="auth">
     <a name="username" format="text">{USERNAME}</a>
     <a name="password" format="password">{PASSWORD}</a>
     <a name="client-id" format="counting">{CLIENT-ID}</a>
  </block>
  <a name="service-id" format="counting">{SERVICE-ID}</a>
</Request> 
```

使用 XDocument，在大括号中设置值的最佳方法是什么。我到目前为止，但被困在选择元素内三个`<a />`节点中的每一个的最佳方法上。`<block/>`这只是 XML 的一小部分，其他的可能有多达 20 个`<a name="..."></a>`元素。

XML 的构造方式不是我创造的，这是我们必须发送到供应商的“网络服务”的方式......在任何人嘲笑 format="counting" 属性之前:)

[@David](https://stackoverflow.com/questions/299747/whats-the-most-efficient-way-to-locate-and-set-element-values-in-an-xdocument#299887) - 为响应欢呼，感谢。我有点希望它会更优雅一点，有点像：

```
List<XElement> e = doc.Descendants("a").ToList();
e.Where(x => x.Attributes("name") == "username").Single().Value = "abc";
e.Where(x => x.Attributes("name") == "password").Single().Value = "abc"; 
```

显然上面的代码不起作用，但我认为每个`<a>`标签都会有一个优雅的衬里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T19:44:15.657

这对你有用吗？良好的旧后裔财产。

```
string xmlInput = ...;
XDocument myDoc = XDocument.Parse(xmlInput);
//
List<XElement> someElements = myDoc.Descendants("a").ToList();
someElements.ForEach(x => x.Value = "Foo");
//
Console.WriteLine(myDoc); 
```

嗯，我看到你有一个属性。也可以这样做：

```
string xmlInput = //...
XDocument myDoc = XDocument.Parse(xmlInput);
//
List<XText> someText =
  myDoc.Descendants()
  .Nodes()
  .OfType<XText>()
  .Where(x => x.Value.StartsWith("{") && x.Value.EndsWith("}"))
  .ToList();
//
List<XAttribute> someAttributes =
  myDoc.Descendants()
  .Attributes()
  .Where(x => x.Value.StartsWith("{") && x.Value.EndsWith("}"))
  .ToList();
//
someText.ForEach(x => x.Value = "Foo");
someAttributes.ForEach(x => x.Value = "Bar");
//
Console.WriteLine(myDoc); 
```

啊，现在有了你所期望的，我会让它工作：

```
List<XElement> e = myDoc.Descendants("a").ToList();
e.Where(x => x.Attribute("name").Value == "username").Single().Value = "abc";
e.Where(x => x.Attribute("name").Value == "password").Single().Value = "abc"; 
```

# java - Eclipse 对自定义 facelets 标记的支持

> ID：299754
> 
> 赞同：2
> 
> 时间：2008-11-18T18:56:08.110
> 
> 标签：java, eclipse, facelets, taglib

我最近开始了 facelets 开发，几天前制作了我的第一个有用的自定义标签。现在我想在 Eclipse 中支持自动完成，就像我对标准标签库（如 h、c 和 ui）的支持一样。

是否有任何简单的方法（少于 30 分钟的工作）来启用自定义标签的工具支持？

我正在使用带有 jboss 工具的 eclipse 3.4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-08T16:40:10.037

您可以使用 Jboss Tools 3.0M3 或更新版本。关于它对自定义 facelets 的支持你可以在这里找到信息[Jboss 工具论坛](http://www.jboss.org/index.html?module=bb&op=viewtopic&t=154315)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T19:08:03.793

您使用的是什么版本的 Eclipse？

我当前的版本（版本：3.4.0，构建 id：I20080617-2000，带有 WTP）对于在我的 JSP 页面上作为指令添加的任何 taglib 具有自动完成功能（即使当前的 JSP 文件对`<%@ include file="..." %>`带有 taglib 声明的实际文件做了一个在里面），即使是非标准的。

例如，`<form:blah>`如果我有以下声明，Eclipse 将为我自动完成所有标签：

```
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %> 
```

# java - 如何使用 Eclipse 和/或 Ant 仅移动当前文件？

> ID：299755
> 
> 赞同：1
> 
> 时间：2008-11-18T18:56:20.090
> 
> 标签：java, eclipse, ant

我正在一个由 Web 应用程序开发人员组成的小型团队中工作。我们在自己的机器上编辑 Eclipse 中的 JSP，然后将它们转移到共享的应用程序服务器上以测试更改。我有一个 Ant 脚本，它将获取我机器上的所有 JSP 并将它们移动到应用程序服务器，但只有当我机器上的 JSP 是“更新的”时才会覆盖 JSP。这在大多数情况下都很有效，但并非所有时候都有效。我们的更新方法不保留文件更改日期/时间，因此我机器上的更新可能会将文件日期/时间设置为现在，而不是文件实际上次更改的时间。如果其他人在 1 小时前处理了该文件（但尚未提交更改），那么我 PC 上的旧文件实际上将具有更新的日期。因此，当我运行 Ant 脚本时，它会用旧文件覆盖他们的更改。

我正在寻找的是一种简单的方法来移动我目前正在处理的文件。有没有办法在 Ant 脚本中指定“当前”文件？还是在 Eclipse 中移动当前文件的简单方法？也许是一个很好的插件来做这种事情？我可以使用 Windows 资源管理器单独移动文件，但我更希望能够从 Eclipse 中执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T19:34:18.033

将目标添加到您的[ant](http://ant.apache.org)构建文件中，以使用@matt b 描述的命令行属性定义复制单个 jsp。

创建一个新的外部工具启动配置文件并使用“字符串替换首选项”在编辑器中传递对活动文件的引用 ( `resource_name`)。

请参阅 Eclipse 帮助 | Java 开发用户指南 | 参考 | 偏好 | 运行/调试 | 发射 | 字符串替换

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T19:03:47.220

Ant 怎么知道哪个文件是“当前”的？它没有办法知道。

您*可以*将文件的名称传递到您的 Ant 脚本中（通过利用您传递给 Ant 的任何`-D`参数在您的脚本中自动成为参数这一事实）...

> 蚂蚁 -Dfile=myfile.jsp 更新

让你的脚本看起来像......

```
<copy file=${myfile} todir="blah"/> 
```

...但是在命令行上不断输入文件名可能会很痛苦。

老实说，当您有多个开发人员共享一个环境时，您所描述的问题类型是不可避免的。我认为对您和您的团队长期而言，更好的方法是让每个开发人员在本地应用程序服务器实例上工作/测试，然后再提升代码。这消除了与其他人共享应用服务器时的所有麻烦、瓶颈和调度问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T19:05:40.273

任何时候你有多个人在做同一件事时，你都应该真正使用源代码控制（好吧，无论如何你都应该使用它，但这是一个不同的对话）。这样，当发生此类冲突时，该工具将知道并让某人执行合并，这样就不会丢失任何人的更改。然后，测试服务器可以在源代码的干净签出上运行，每个开发人员还可以在本地测试完整的应用程序，因为每个人的更改都将通过源存储库立即提供给他们。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-18T20:21:07.203

我建议你使用源代码控制。我更喜欢颠覆。每当有人提交新代码时，您都可以使用[CruiseControl](http://cruisecontrol.sourceforge.net/)自动构建。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-12-15T23:07:07.000

antrunner4e 插件正是您正在寻找的——请参阅[http://sourceforge.net/projects/antrunner4e/](http://sourceforge.net/projects/antrunner4e/)

# oracle - 如何将 Oracle BI 集成到现有应用程序中？

> ID：299760
> 
> 赞同：7
> 
> 时间：2008-11-18T18:59:18.307
> 
> 标签：oracle, business-intelligence, obiee

我有一个用 Perl 编写的现有应用程序。现在我需要将此应用程序与 OBI 集成。该计划有一个按钮，用户可以单击以在*iframe*中打开 OBI 。OBI 驻留在与正在运行的应用程序不同的服务器上。

有没有人这样做过，知道这样做的最佳做法是什么，这样做的努力是什么？
另一个问题是是否可以向*iframe*中显示的 OBI 添加自定义项。？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-02T14:20:51.080

有两种方法可以解决我知道并尝试过的问题。根据您的需要，其中一个或另一个可能更合适（或两者兼而有之，它们并不相互排斥）。在这两种情况下，文档都很好并且很容易获得。

# “转到网址”

Go URL 在 Oracle Business Intelligence Presentation Services 管理指南中有更详尽的记录。它以 URL 的形式为您已经定义的报告提供了一个快速简便的界面。让它运行所需的只是填写一些查询参数以指向您想要的报告。您可能还需要包含身份验证令牌。

*   优点：很容易尝试。
*   缺点：更难获得正确的安全性。

# 网络服务

演示服务器附带一系列 Web 服务，这些服务支持以更加程序化的方式查询您的存储库。通过此渠道提供的功能更进一步：例如，大多数目录管理，包括报告创建和编辑都是可能的。完整列表包含了自己的指南：Oracle 商业智能 Web 服务指南。

*   优点：更好的集成（即，不需要 IFRAME）；更容易获得安全权利。
*   缺点：更难设置；大量的 XML；更高级的功能（例如就地钻取）需要一个 HTTP 桥接器，这在我的情况下是个婊子。生成的 HTML 可能与您的有点冲突，需要清理，特别是在 CSS 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:43:27.703

在非 ADF Web 应用程序中嵌入 OBIEE 报告非常困难。如果您可以选择在 ADF 中重新编写您的 Web 应用程序，您的生活将会轻松很多。只需将报告和可视化拖放到您的 Web 应用程序中。Oracle 自己的融合应用程序也遵循这种方法。如果您的应用需要大量分析，那么它可能是一个很好的探索选择。这是[Oracle 文档的链接](http://docs.oracle.com/cd/E21764_01/bi.1111/e10545/embedding_adf.htm#BGBGCFJG)。

# c++ - CUDA：在 C++ 中包装设备内存分配

> ID：299761
> 
> 赞同：17
> 
> 时间：2008-11-18T18:59:22.377
> 
> 标签：c++, cuda, raii, placement-new

我现在开始使用 CUDA，不得不承认我对 C API 有点失望。我理解选择 C ​​的原因，但是如果该语言是基于 C++ 的，那么有几个方面会简单得多，例如设备内存分配（通过`cudaMalloc`）。

我的计划是自己做这件事，使用`operator new`放置`new`和 RAII 重载（两种选择）。我想知道到目前为止是否有任何我没有注意到的警告。该代码*似乎*有效，但我仍然想知道潜在的内存泄漏。

**RAII**代码的用法如下：

```
CudaArray<float> device_data(SIZE);
// Use `device_data` as if it were a raw pointer. 
```

在这种情况下，一个类可能是矫枉过正（特别是因为你仍然必须使用`cudaMemcpy`，类只封装 RAII）所以另一种方法是**放置`new`**：

```
float* device_data = new (cudaDevice) float[SIZE];
// Use `device_data` …
operator delete [](device_data, cudaDevice); 
```

在这里，`cudaDevice`仅仅作为一个标签来触发过载。然而，由于在正常放置中`new`这将指示放置，我发现语法奇怪地一致，甚至可能比使用类更可取。

我会很感激各种批评。是否有人可能知道下一个版本的 CUDA 是否计划在这个方向上做一些事情（正如我所听说的，这将改进其对 C++ 的支持，无论他们的意思是什么）。

所以，我的问题实际上是三个方面：

1.  我的展示位置`new`重载在语义上是否正确？它会泄漏内存吗？
2.  有没有人知道未来 CUDA 发展朝着这个大方向发展的信息（让我们面对现实：C++ s*ck 中的 C 接口）？
3.  我怎样才能以一致的方式更进一步（还有其他 API 需要考虑，例如不仅有设备内存，还有常量内存存储和纹理内存）？

* * *

```
// Singleton tag for CUDA device memory placement.
struct CudaDevice {
    static CudaDevice const& get() { return instance; }
private:
    static CudaDevice const instance;
    CudaDevice() { }
    CudaDevice(CudaDevice const&);
    CudaDevice& operator =(CudaDevice const&);
} const& cudaDevice = CudaDevice::get();

CudaDevice const CudaDevice::instance;

inline void* operator new [](std::size_t nbytes, CudaDevice const&) {
    void* ret;
    cudaMalloc(&ret, nbytes);
    return ret;
}

inline void operator delete [](void* p, CudaDevice const&) throw() {
    cudaFree(p);
}

template <typename T>
class CudaArray {
public:
    explicit
    CudaArray(std::size_t size) : size(size), data(new (cudaDevice) T[size]) { }

    operator T* () { return data; }

    ~CudaArray() {
        operator delete [](data, cudaDevice);
    }

private:
    std::size_t const size;
    T* const data;

    CudaArray(CudaArray const&);
    CudaArray& operator =(CudaArray const&);
}; 
```

关于这里使用的单身人士：是的，我知道它的缺点。但是，这些在这种情况下无关紧要。我在这里只需要一个不可复制的小型标签。其他一切（即多线程注意事项、初始化时间）都不适用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-07-22T06:51:47.827

与此同时，还有一些进一步的发展（不是在 CUDA API 方面，但至少在尝试使用类似 STL 的 CUDA 数据管理方法的项目方面）。

最值得注意的是 NVIDIA 研究的一个项目：[推力](http://code.google.com/p/thrust)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T01:26:17.353

我会采用安置新方法。然后我会定义一个符合 std::allocator<> 接口的类。理论上，您可以将此类作为模板参数传递给 std::vector<> 和 std::map<> 等等。

当心，我听说做这样的事情充满了困难，但至少你会通过这种方式学到更多关于 STL 的知识。而且你不需要重新发明你的容器和算法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T17:55:56.933

有几个项目尝试类似的东西，例如[CUDPP](http://cudpp.github.io/)。

然而，与此同时，我实现了自己的分配器，它运行良好且简单明了（> 95% 的样板代码）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-02-22T09:33:32.860

> 有没有人知道未来 CUDA 发展朝着这个大方向发展的信息（让我们面对现实：C++ s*ck 中的 C 接口）？

是的，我做过类似的事情：

[https://github.com/eyalroz/cuda-api-wrappers/](https://github.com/eyalroz/cuda-api-wrappers/)

> nVIDIA 的 CUDA 运行时 API 适用于 C 和 C++ 代码。因此，它使用 C 风格的 API，即较低的公分母（模板化函数重载的一些显着例外）。
> 
> 这个围绕运行时 API 的包装库旨在允许我们包含 C++ 的许多特性（包括一些 C++11）以使用运行时 API - 但不会降低表达性或增加抽象级别（例如， ，推力库）。使用 cuda-api-wrappers，您仍然拥有您的设备、流、事件等 - 但以更多 C++ 惯用方式使用它们会更方便。

# .net - .NET Compact Framework 是否有流行的单元测试框架？

> ID：299769
> 
> 赞同：6
> 
> 时间：2008-11-18T19:02:46.130
> 
> 标签：.net, unit-testing, compact-framework

我在 NUnit 和 MBUnit 方面拥有丰富的经验，但我是 .NET Compact Framework 开发的新手，我希望能走上正轨。

.NET Compact Framework 是否存在流行的单元测试框架，如果有，它是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T22:50:36.653

我们在 TFS (2008) 下使用 MSTest。最大的优势是它在实际设备上运行测试（我们同时针对模拟器和物理设备运行），并且测试是从服务器驱动的，而不是设备驱动的。这意味着您不必从设备 UI（例如 CFNUnitBridge）中选择要运行的测试等，这非常尴尬并且不利于持续集成。

然而，MSTest 并不是万能的。它有一些严重的缺点（比如调试测试真的很痛苦并且测试启动很慢），但它比我们尝试过的任何其他方法都要好。希望随着 MS 的发展，可用性将会提高，我们可以继续使用我们拥有的测试框架。

使用我们认为风险太大的任何其他东西，因为许多设备框架和库在没有主要赞助商的情况下往往会枯萎和消亡。例如，NUnitLite 在这篇文章的两年生命中只有 477 次下载和很少的代码流失或活动——这并没有激发任何对它会在功能上增长的信心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T20:08:42.393

查看 NUnitLite：[http ://www.codeplex.com/Wiki/View.aspx?ProjectName=NUnitLite](http://www.codeplex.com/Wiki/View.aspx?ProjectName=NUnitLite)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T19:59:15.750

@Simon：为 CF.NET 编译的模块不能在桌面硬件上运行，因此无法使用 NUnit 进行测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T03:08:32.393

您可能已经想到了这一点，但是对于 Visual Studio 2008 Professional，“最好的”方法是使用 MSTest（我是一个彻头彻尾的 NUnit 人，但就是这样）。

右键单击方法或类，然后选择“创建单元测试”。这将指导您创建包含您开始所需的所有依赖项的测试项目。

关键点，这将在设备上运行测试——这是您想要发生的，然后在 MSTest 运行器中将结果报告给您。

但是仍然存在测试问题。我找不到任何适用于 .net cf 的模拟框架。但这是一个开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T03:19:34.973

对于在 Portable.NET 上运行的嵌入式项目，我们最终编写了自己的 NUnit 最小版本，因为我们无法让 NUnit 代码在该运行时上编译和运行。实际上，这并不难做到。

# sql - 简单的 Oracle SQL 日期语法问题

> ID：299770
> 
> 赞同：7
> 
> 时间：2008-11-18T19:02:51.620
> 
> 标签：sql, oracle, ms-access, vbscript, date

我正在尝试将工作的 MS Access 查询转换为在通过 VB 脚本 (.asp) 访问的 Oracle 数据库上运行。这是 WHERE 子句的最后一部分：

```
sql = sql & "WHERE (UAT.HB.MB_MODE = 'A' AND   UAT.HB.PRINT_DATE >= '" 
& SD & "' AND UAT.HB.PRINT_DATE <= '" & ED  &"'  )" 
```

变量“SD”（即“开始日期”）是一个文本字符串，可以包含诸如“11/11/2008”之类的值。变量“ED”（即“结束日期”）也是如此。

但是，日期不起作用。Oracle 是否需要一种特殊的方式来使用日期？

日期必须转换吗？我是否像在 MS Access 中那样用“#”关键字包围它们？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-18T19:08:49.690

在 Oracle 中，您的日期应写为 ANSI 日期文字，如下所示：

```
DATE '2008-11-11' 
```

或者从这样的字符串转换为日期：

```
TO_DATE('11/11/2008', 'MM/DD/YYYY') 
```

看[这里](https://docs.oracle.com/database/121/SQLRF/sql_elements003.htm#BABGIGCJ)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-18T19:14:17.823

不要假设默认的 Oracle 日期格式是什么。检查[NLS_DATE_FORMAT](http://download-uk.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams122.htm)或使用[TO_DATE](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions183.htm)进行转换。像这样：

```
TO_DATE('2008-11-18 14:13:59', 'YYYY-MM-DD HH24:Mi:SS') 
```

注意分钟的'Mi'而不是'MM'。这吸引了很多人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T19:09:29.237

据此，[您](http://www.java2s.com/Code/Oracle/Date-Timezone/SimpleExamplesofStoringandRetrievingDates.htm)可以使用以下内容：

```
to_date('19960725','YYYYMMDD') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T19:06:28.477

Oracle 的默认日期格式是“dd-mon-yy”。您可以在日期字段上执行 TO_CHAR 函数，将其转换为您喜欢匹配的格式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T19:15:57.507

以下是转换日期和从日期转换的几个示例：

*   `select to_date('2008/11/18:12:00:00AM', 'yyyy/mm/dd:hh:mi:ssam') from dual`
*   `select to_char(sysdate, 'mm/dd/yyyy') from dual`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T19:17:36.443

默认的 Oracle 日期格式可以从一个数据库更改为下一个数据库。因此，如果您不知道数据库使用的日期格式，那么您应该使用带有明确日期格式字符串的 TO_DATE 函数。鉴于默认日期格式可能随时更改，因此最好使用明确的日期格式字符串。

例如：TO_DATE('11/11/2008 17:30','MM/DD/YYYY HH24:MI')

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T10:32:12.010

不要忘记日期包括时间（默认为 00:00:00），所以
不要被这样的事情抓住：
给定三个日期，,`start_date, print_date, end_date`都在***同***一天
`print_date >= start_date AND print_date <= end_date`失败，因为`print_date`大于`end_date` **：**
`start_date`是 2008 -11-19 (00:00:00)
和`end_date`2008-11-19 (00:00:00)
和`print_date`2008-11-19 ( **16:00:00** )

# asp.net - 键盘快捷键

> ID：299776
> 
> 赞同：4
> 
> 时间：2008-11-18T19:05:50.600
> 
> 标签：asp.net, keyboard-shortcuts

在为 Web 应用程序实现键盘快捷键/加速键方面是否有标准。示例：在网格中显示的项目列表中导航 他们是否有关于如何实现这一点的指南？Google 在“实验室”部分有一个用于 GMail 的。

投入时间在网络应用程序中实现键盘快捷键/加速键是否具有商业意义

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T19:15:36.337

我使用了许多定义自己的键盘快捷键的网站和 Web 应用程序。它们通常没有很好的文档记录，并且与传统的基于鼠标的使用相比几乎没有价值。

正如 Galwegian 所提到的，您应该小心干扰可访问性选项，特别是如果您想遵守[ADA Web 指南](http://webdesign.about.com/od/accessibility/Web_Accessibility_Web_Usability.htm)。

您还应该针对流行的 Web 浏览器中的键盘快捷键测试您的 Web 应用程序。有些人使用这些，当您的网络应用程序覆盖浏览器的键时会感到恼火。

我认为花时间测试Web 表单和其他页面元素的**标签顺序**会更值得。当我填写 web 表单时，我倾向于使用 tab 来前进到下一个表单域，但我发现一些网站的 tab 跳转到页面上一些意想不到的地方，而不是视觉上相邻的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T19:08:33.670

从可访问性的角度来看，短键盘很危险，因为它们可能会干扰视障用户使用的屏幕阅读器等软件的预编程快捷方式。

出于这个原因，我要么避免使用它们，要么确保您可以关闭此功能。

祝你好运！

# java - 从现有的 WSDL 文件开发 Web 服务应用程序

> ID：299778
> 
> 赞同：0
> 
> 时间：2008-11-18T19:06:13.470
> 
> 标签：java, web-services, sun

我已经使用 wsdl2java 在 Websphere 上完成了此操作（re: title of this topic），用于生成 wsdl 到 java 映射 xml 文件。我的端点是一个通用的无状态 EJB。EJB中的代码是通过遍历每个wsdl，得到wsdl操作生成的，并将其粘在生成的远程EJB接口中。每个 EJB 方法 impl 都是通用的，并且以相同的方式处理所有服务。使用此文档上的说明在 WAS 上执行此操作：http: [//publib.boulder.ibm.com/infocenter/wasinfo/v7r0/index.jsp ?topic=/com.ibm.websphere.base.doc/info/aes/ ae/twbs_devwbsjaxrpcwsdl.html](http://publib.boulder.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=/com.ibm.websphere.base.doc/info/aes/ae/twbs_devwbsjaxrpcwsdl.html)

现在，如果有人在 Sun AS 9.1 中做过类似的事情，我请大家帮忙。

从现有的 WSDL（和 xsd）文件开始。知道每个服务的唯一 EJB 服务端点实现是相同的，并生成一个 EAR 文件（webservices.xml、ejb-jar.xml 等）。

曾在 wscompile 等方面苦苦挣扎，但没有以与 WebSphere 相同的方式获得任何软件。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T09:29:28.040

您想创建一个在 Sun AS 下运行的 WS 客户端吗？我不详细了解 Sun AS，也不知道它提供的 WS 库。但您可能想要使用公共 WS 库：

*   [阿帕奇轴 2](http://ws.apache.org/axis2/)
*   [阿帕奇 CXF](http://cxf.apache.org/)

对于每个库，都有描述如何从 WSDL 创建项目的文档。

您甚至可以使用 Eclipse 从 WSDL 为您创建一个项目：文件 -> 新建 -> 其他... -> Web 服务 -> WSDL。确保您已安装“WST Web 服务”插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T16:47:39.303

我自己从未使用过它，但我最近才读到注释的`wsdlLocation()`属性`WebService`，它应该将服务映射到预先存在的 WSDL 文档（虽然不确定您是否甚至使用 EJB3）。

# c# - 最佳 OpenLDAP 身份验证选项？

> ID：299793
> 
> 赞同：0
> 
> 时间：2008-11-18T19:10:36.910
> 
> 标签：c#, asp.net, authentication, openldap

我想阻止用户浏览其他用户名、安全性（当然）和性能

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2008-11-19T08:13:33.677

使用 Macing/Network 权限来限制对您的 openLDAP 服务器的访问，*仅限于*您的管理机器和您的 IIS 机器。因此只有这两台机器可以浏览您的目录。

使用 SSL 与您的 openLDAP 服务器进行所有通信。这将需要连接到端口 636。

默认情况下，openLDAP 以明文形式存储密码；而是强制它使用盐渍哈希。OpenLDAP 带有一个命令行实用程序，可以为您散列密码。

# c# - 从批处理 SQL 命令 (SQL Server) 中检索“输出消息”

> ID：299797
> 
> 赞同：3
> 
> 时间：2008-11-18T19:11:20.090
> 
> 标签：c#, sql-server, ado.net

我正在针对 SQL Server 批量执行几个离散查询。例如：

```
更新 tableX 设置 colA = 'freedom';

从客户中选择姓氏；

插入表 Y (a,b,c) 值 (x,y,z);

```

现在，我想在 DataSet（来自 select 语句）中捕获结果，这很容易做到……但是我如何也捕获来自该命令的“元”响应，类似于查询分析器/SQL Mgt Studio 的方式当它显示“消息”选项卡并显示类似于以下内容时：

```
（1 行受影响）
（更新了 2 行）

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T10:23:11.047

查看 SQL 连接事件。我认为这就是你所追求的：http: [//msdn.microsoft.com/en-us/library/a0hee08w.aspx](http://msdn.microsoft.com/en-us/library/a0hee08w.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T19:55:02.983

我的建议是为此使用@@rowcount 变量。通常，当我执行此类命令时，如果我想同时捕获潜在错误和受影响的行，我会这样做

```
declare @rowsAffected int, @error int

select * from sometable
     select @rowsAffected = @@rowcount, @error = @@error

if @@error <> 0 goto errorCleanup 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T07:04:36.843

尼克的建议是正确的`@@ROWCOUNT`——事实上，作为我一直使用的例行程序`SET NOCOUNT ON`，它具有（小）性能优势——但更重要的是，这个细节是一个实现细节——所以你的代码不应该关心......

如果要返回一个值（例如更新的行数），请使用以下任何一种：

*   返回值
*   输出参数
*   选择语句

最后一个开销最大

# firefox - SQL Reporting Services 2005 - 在 FireFox 中打印

> ID：299798
> 
> 赞同：2
> 
> 时间：2008-11-18T19:11:41.917
> 
> 标签：firefox, reporting-services, printing

打印按钮在 FireFox 中打开时不会显示在报告工具栏中。

有什么解决方案可以解决 FireFox 中不显示打印按钮的问题吗？
可以启用它还是没有解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T19:21:36.670

我认为您在这里唯一的选择是导出为 pdf 或其他格式，然后打印。

工具栏上的打印按钮是一个 activex 控件，Firefox 不支持，也可能不支持。

# speech-recognition - 使用 SAPI 5.3 Speech API 进行声学训练

> ID：299799
> 
> 赞同：9
> 
> 时间：2008-11-18T19:12:20.103
> 
> 标签：speech-recognition, sapi, speech

在 Vista 上使用 Microsoft 的 SAPI 5.3 Speech API，您如何以编程方式对 RecoProfile 进行声学模型训练？更具体地说，如果您有一个文本文件和一个用户说出该文本的音频文件，您将使用该文本和音频进行什么 SAPI 调用序列来训练用户的配置文件？

### 更新：

关于这个问题的更多信息我还没有解决：你在“开始”调用 ISpRecognizer2.SetTrainingState( TRUE, TRUE )，在“结束”调用 ISpRecognizer2.SetTrainingState( FALSE, TRUE )。但目前还不清楚这些行动何时必须相对于其他行动发生。

例如，您必须进行各种调用以使用与您的音频匹配的文本来设置语法，并进行其他调用以连接音频，以及对各种对象进行其他调用以说“你现在可以开始了”。但是什么是相互依存关系——在发生什么之前必须发生什么？如果您使用音频文件而不是系统麦克风进行输入，这是否会使相对时间不那么宽容，因为识别器不会一直坐在那里听，直到扬声器正确？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-10-05T23:26:38.247

实施 SAPI 培训相对困难，文档并没有真正告诉您需要了解什么。

[ISpRecognizer2::SetTrainingState](http://msdn.microsoft.com/en-us/library/ms718576(VS.85).aspx)将识别器切换到训练模式或退出训练模式。

当您进入训练模式时，真正发生的事情是识别器为用户提供了更多关于识别的余地。因此，如果您尝试识别一个短语，那么引擎对识别的严格程度将大大降低。

在您离开训练模式并且您设置了 fAdaptFromTrainingData 标志之前，引擎不会真正进行任何调整。

当引擎适应时，它会扫描存储在配置文件数据下的训练音频。将新的音频文件放在引擎可以找到的地方进行调整是训练代码的责任。

这些文件也必须被标记，以便引擎知道所说的内容。

那么你是怎么做到的呢？您需要使用三个鲜为人知的 SAPI API。特别是，您需要使用[ISpRecognizer::GetObjectToken](http://msdn.microsoft.com/en-us/library/ms718612(VS.85).aspx)和 [SpObjectToken::GetStorageFileName](http://msdn.microsoft.com/en-us/library/ms718252(VS.85).aspx)获取配置文件令牌以正确定位文件。

最后，您还需要使用[ISpTranscript](http://msdn.microsoft.com/en-us/library/ms719553(VS.85).aspx)生成正确标记的音频文件。

要将它们放在一起，您需要执行以下操作（伪代码）：

创建一个 inproc 识别器并绑定适当的音频输入。

确保您保留音频以供识别；你稍后会需要它。

创建一个包含要训练的文本的语法。

设置语法的状态以在识别发生时暂停识别器。（这也有助于从音频文件进行训练。）

发生识别时：

获取识别的文本和保留的音频。

使用 CoCreateInstance(CLSID_SpStream) 创建一个流对象。

[使用ISpRecognizer::GetObjectToken](http://msdn.microsoft.com/en-us/library/ms718612(VS.85).aspx)和[ISpObjectToken::GetStorageFileName](http://msdn.microsoft.com/en-us/library/ms718252(VS.85).aspx)创建训练音频文件，并将其绑定到流（使用[ISpStream::BindToFile](http://msdn.microsoft.com/en-us/library/ms719484(VS.85).aspx)）。

将保留的音频复制到流对象中。

[QI ISpTranscript](http://msdn.microsoft.com/en-us/library/ms719553(VS.85).aspx)接口的流对象，并使用[ISpTranscript::AppendTranscript](http://msdn.microsoft.com/en-us/library/ms719554(VS.85).aspx)将识别的文本添加到流中。

更新下一个话语的语法，恢复识别器，然后重复直到训练文本结束。

# javascript - 如何检查选择器是否匹配 jQuery 中的某些内容？

> ID：299802
> 
> 赞同：503
> 
> 时间：2008-11-18T19:13:31.130
> 
> 标签：javascript, jquery, jquery-selectors

在 Mootools 中，我只需要运行`if ($('target')) { ... }`. 在 jQuery 中的工作方式是否`if ($('#target')) { ... }`相同？

* * *

## 回答 #1

> 赞同：784
> 
> 时间：2008-11-18T19:20:29.900

正如其他评论者所建议的那样，最有效的方法似乎是：

```
if ($(selector).length ) {
    // Do something
} 
```

如果你绝对必须有一个 exists() 函数——这会更慢——你可以这样做：

```
jQuery.fn.exists = function(){return this.length>0;} 
```

然后在你的代码中你可以使用

```
if ($(selector).exists()) {
    // Do something
} 
```

[在这里](https://stackoverflow.com/questions/31044/is-there-an-exists-function-for-jquery)回答

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2008-11-18T19:17:09.160

不，无论选择器是否匹配，jquery 总是返回一个 jquery 对象。您需要使用 .length

```
if ( $('#someDiv').length ){

} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-01-14T19:43:58.340

如果您使用：

```
jQuery.fn.exists = function(){return ($(this).length > 0);}
if ($(selector).exists()) { } 
```

你会暗示链接是可能的，而不是。

这会更好

```
jQuery.exists = function(selector) {return ($(selector).length > 0);}
if ($.exists(selector)) { } 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-03-18T16:22:10.937

我想这里回答的大多数人都不太明白这个问题，否则我可能会弄错。

问题是“如何检查jQuery 中是否存在*选择器”。*

大多数人认为这是“如何使用 jQuery 检查 DOM 中是否存在元素”。很难互换。

jQuery 允许您创建自定义选择器，但请看这里在初始化之前尝试在 e 上使用时会发生什么；

```
$(':YEAH');
"Syntax error, unrecognized expression: YEAH" 
```

遇到这个之后，我意识到这只是一个检查的问题

```
if ($.expr[':']['YEAH']) {
    // Query for your :YEAH selector with ease of mind.
} 
```

干杯。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-10-22T07:53:37.147

还有一种方式：

```
$('#elem').each(function(){
  // do stuff
}); 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-05-27T04:22:51.350

```
if ($('#elem')[0]) {
  // do stuff
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-19T09:40:06.110

或者：

```
if( jQuery('#elem').get(0) ) {} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-11T19:50:19.130

我更喜欢

```
 if (jQuery("#anyElement").is("*")){...} 
```

它基本上检查这个元素是否是一种“*”（任何元素）。只是更简洁的语法，而“is”在“if”中更有意义

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-23T13:56:23.183

```
jQuery.fn.exists = function(selector, callback) {
    var $this = $(this);
    $this.each(function() {
        callback.call(this, ($(this).find(selector).length > 0));
    });
}; 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2012-02-02T12:08:22.510

对我来说`.exists`不起作用，所以我使用索引：

```
if ($("#elem").index() ! = -1) {} 
```

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2013-09-30T08:47:38.127

首先创建一个函数：

```
$.fn.is_exists = function(){ return document.getElementById(selector) } 
```

然后

```
if($(selector).is_exists()){ ... } 
```

# .net - 获取从 VB.NET 中的电子邮件附件复制到剪贴板的文件名

> ID：299805
> 
> 赞同：4
> 
> 时间：2008-11-18T19:15:00.177
> 
> 标签：.net, windows, vb.net, clipboard

如果用户将文件从 Outlook 电子邮件附件复制到 Windows 中的剪贴板，有什么方法可以在 VB.NET 中获取该文件的名称？

如果文件是从 Windows 资源管理器复制的，则有我可以用来获取此文件的数据，但是当从电子邮件附件复制文件时，该列表为空（`Clipboard.GetFileDropList`只有四种可用格式 - `FileGroupDescriptorW`、`FileGroupDescriptor`和）。`RenPrivateItem``FileContents`

感觉这应该是可能的，因为我可以将文件粘贴到 Windows 资源管理器中，并将其与附件名称一起粘贴。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T19:51:04.770

事实证明，您可以从格式为`FileGroupDescriptor`. 不过，代码有点神秘：

```
Dim fileName As New StringBuilder("")
Dim theStream As Stream = Clipboard.GetData("FileGroupDescriptor")
Try
    Dim fileGroupDescriptor(512) As Byte
    theStream.Read(fileGroupDescriptor, 0, 512)

    Dim i As Integer = 76
    While fileGroupDescriptor(i) <> 0
        fileName.Append(Convert.ToChar(fileGroupDescriptor(i)))
        i += 1
    End While
Finally
    If theStream IsNot Nothing Then theStream.Close()
End Try 
```

# java - 从 Eclipse 插件启动 URL

> ID：299806
> 
> 赞同：8
> 
> 时间：2008-11-18T19:15:31.313
> 
> 标签：java, eclipse, eclipse-plugin

我想让我的 Eclipse 插件导致用户的默认浏览器打开一个 URL。这似乎是非常标准的行为，但我无法找到任何有关如何执行此操作的文档。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-19T08:29:27.967

如果您想在外部浏览器中使用它，则无需创建一个。这是这样的：

```
PlatformUI.getWorkbench().getBrowserSupport().getExternalBrowser().openURL(new URL("http://www.example.com/")); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-18T19:33:52.870

使用SWT API 中的[Program.launch(String)](http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/program/Program.html#launch(java.lang.String))。

（或者，Java 6 引入了[Desktop](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html)类。）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-18T21:06:34.367

您正在寻找：

```
final IWebBrowser browser = PlatformUI.getWorkbench().getBrowserSupport().createBrowser( ... );
browser.openURL(url); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T19:27:00.293

您的意思是在 Eclipse 之外启动一个外部窗口（IE、FireFox、...），还是打开一个内部“[浏览器](http://kickjava.com/src/org/eclipse/swt/browser/Browser.java.htm)”组合？

因为在内部方面，[org.eclipse.help.ui.internal.browser.embedded.EmbeddedBrowser](http://kickjava.com/src/org/eclipse/help/ui/internal/browser/embedded/EmbeddedBrowser.java.htm)似乎能够定义任何类型的主要浏览器。

打开默认用户的浏览器（作为内部或外部窗口）是在常规/Web 浏览器中定义的首选项。

# html - 为什么重新加载页面时复选框保持选中状态？

> ID：299811
> 
> 赞同：85
> 
> 时间：2008-11-18T19:16:47.083
> 
> 标签：html, firefox, checkbox

我正在重新加载具有以下代码的网页：

```
<label for="showimage">Show Image</label>
<input id="showimage" name="showimage" type="checkbox" value="1" /> 
```

即使每次重新加载页面时发送到浏览器的 HTML 都是相同的，但在执行重新加载时，复选框始终采用选中的值。换句话说，如果用户选中复选框并重新加载，复选框仍然处于选中状态。

这里有一些缓存吗？

**编辑**：我在下面尝试了 Gordon Bell 的解决方案，发现即使在删除 value="1" 后这种情况仍然存在。还有什么我可能会丢失的吗？

```
<label for="showimage">Show Image</label> 
<input id="showimage" name="showimage" type="checkbox" /> 
```

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2009-01-22T22:39:08.703

添加`autocomplete="off"`到页面上的表单元素中。缺点是这不是有效的 XHTML，但它在没有任何复杂的 javascript 的情况下解决了这个问题。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-11-18T19:28:55.860

是的，我相信它正在缓存。例如，我在 Firefox 上看到了这种行为（不是 Safari，这是值得的 :)）。

`CTRL`您可以使用-重新加载页面并绕过缓存（在 Firefox 上）`SHIFT`，`R`您会看到检查值不携带（正常`CTRL`-`R`但是会从缓存中获取信息）

**编辑**：我能够在 Firefox 上禁用此服务器端，设置缓存控制标头：

```
Cache-Control: no-store 
```

这似乎禁用了 Firefox 的“记住表单值”功能

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-07-14T04:03:51.177

使用 js 设置 autocomplete="off" 也运行良好。

例如使用 jquery：

```
$(":checkbox").attr("autocomplete", "off"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-06-25T18:12:18.493

这是一个老问题，但对于 Firefox 来说仍然是一个活跃的问题。我尝试过的所有回复都*没有*解决它，但为我解决的只是这个：

```
 document.getElementById('formId').reset(); 
```

这只是在每次页面加载时将表单重置为默认选项。不理想，因为您失去了精细控制，但它是唯一为我解决这个问题的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T21:04:41.640

这是 Firefox 的一个不错的功能：如果您键入内容但重新加载页面，文本仍会保留在文本区域中。您选择的其他设置同上。

唉，它在 SO（可能由 JS 重置）和 IE 等更笨的浏览器中不起作用......

这提出了一个解决方案：如果您确实需要这样做，请使用 JS 重置表单。form.reset() 可能会完成这项工作（就像重置输入按钮一样）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T12:47:19.337

或者代替 f5 在地址栏上按 enter :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T13:54:25.300

这可能是由于浏览器缓存 - 对于不经常更改的静态网站非常有用，对于动态 Web 应用程序非常不利。
尝试在页面的 head 部分使用这两个元标记。第二个元标记适用于不识别“无缓存”元标记的旧浏览器 (IE5)，尽管不同会产生相同的结果：每个请求都发送到服务器。

> ```
> <META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
> <META HTTP-EQUIV="Expires" CONTENT="-1"> 
> ```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-15T07:25:18.337

$("#showimage").prop("checked",false);

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-06T20:59:14.960

解决这个问题的公众想法

制作表格和重置按钮

```
<form>
<checkbox>
<reset>
</form>

$(reset).trigger("click");//to clear the cache and input 
$(checkbox).trigger("click");//to mark checkbox 
```

# windows-server-2003 - 磁盘空间不足警报，发送电子邮件 Windows 2003 Server PerfMon 警报

> ID：299814
> 
> 赞同：1
> 
> 时间：2008-11-18T19:18:36.753
> 
> 标签：windows-server-2003, alerts

当我的一台服务器上的可用磁盘空间小于指定值时，我正在尝试设置警报以通过电子邮件 (SMTP) 通知我。为此，我使用了 PerfMon 警报，如[MSFT Technet](http://support.microsoft.com/kb/324796)中所述。我有警报工作并写入系统日志，但是当我尝试将其设置为“运行程序”时它失败了。日志警报触发，但程序失败。

我正在使用的程序是我编写的用于发送 smtp 电子邮件的小型 C# 应用程序。我已经独立于该服务器测试了该应用程序，手动运行它并且工作正常，无需任何用户交互（控制台应用程序）。但是当我将它设置为通过警报触发器运行时，它会失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T23:44:56.717

可能是您的程序没有命令行参数吗？我在[http://support.microsoft.com/kb/324752/en-us上找到了以下内容](http://support.microsoft.com/kb/324752/en-us)

> 发生警报时，服务会创建一个进程并运行指定的命令文件。该服务还将您定义的任何命令行参数复制到用于运行文件的命令行。单击命令行参数，然后单击以选中相应的复选框以包括程序运行时所需的参数。
> 
> 注意 您必须至少选择一个命令行参数，否则程序将无法运行。（无论您选择什么程序，这都是正确的。）

如果在您的 C# 应用程序中处理/记录异常，您有什么办法吗？你能从中得到什么吗？

你能把你的 C# 应用程序调用放在一个批处理文件中并从警报开始吗？如果你添加类似的东西

```
echo %date% %time% > log.txt 
```

在批处理文件的开头，您可以查看它是否已启动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T17:54:31.820

您是否在警报属性中设置了*运行方式字段？*如果没有，您的程序将作为 LocalService 运行，它没有网络访问权限（除其他外）。

尝试将其设置为能够验证程序是否正常运行的用户帐户。

# windows - linux 中的文件权限与 windows 中的文件权限

> ID：299826
> 
> 赞同：5
> 
> 时间：2008-11-18T19:22:05.170
> 
> 标签：windows, linux, security, file, permissions

在 linux 中，如果我有一个要与组共享的文件，并且我将文件放在 USB 记忆棒上，例如，并将其复制到没有相同组或用户的计算机，文件是否对那台新计算机上的任何人都没有权限？如果我带来一个只允许用户 X 将其读取到 Windows 机器的 linux 文件怎么办？谁可以在 Windows 机器上阅读它？因为该机器上不存在用户 X（和组）。

将 linux 文件复制到另一台 linux 机器上可以获得什么样的安全性？windows机器怎么样？

将 Windows 文件复制到另一台 Windows 机器上可以获得什么样的安全性？linux机器怎么样？

请告诉我。

吉布

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-18T19:28:44.017

关于 USB 密钥：通常，USB 密钥使用 FAT 系列文件系统之一；FAT 根本不支持安全性，因此一旦您将文件复制到其中，安全性信息就会丢失。因此，对于您的第一个问题，任何拥有 USB 密钥的人都可以在任何计算机上从任何用户帐户读取它。可以使用另一个文件系统（例如，支持安全性的 NTFS）格式化 USB 密钥；在这种情况下，如果目标计算机上不存在帐户（至少在 Windows 中，它必须是域帐户或类似帐户，只是将两个帐户命名相同不会这样做），则只有一个可以忽略文件系统权限的用户（例如 *nix 上的 root 或 Windows 上的管理员）将能够访问该文件。

第二，我不是 100% 确定，但我相信这取决于你如何复制它；像 FTP 和 rcp 之类的东西通常不会复制权限，所以我假设文件获得目标目录的某种默认权限，或者复制程序中内置的默认权限，具体取决于复制程序的功能。

对于 Windows，据我所知，安全描述符最初是从目标文件夹继承的；同样，权限不会跨机器保留。复制后可以修改。

一般来说，除了在设计用于传输权限的特定环境中，我会假设将任何文件从一台计算机传输到另一台计算机会将安全权限重置为默认值（通常是该位置的*新*文件会收到什么）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-18T19:46:18.147

正如技术爱好者所说，可移动驱动器通常使用 FAT 文件系统，因此根本不会复制权限信息。

在 *nix 机器之间的更多“直接”副本上，如果写入过程在 root 下运行，通常会有标志来保留权限位和所有者/组。此外，它们中的大多数通过数字保留用户/组身份。如果没有“全局”用户身份数据库（LDAP、NIS 甚至 AD），请务必查找“按名称”身份。

一些例子：

*   NFS：假设“数字身份”，除非您使用一些“壁球”选项使每个文件都具有相同的所有者/组。
*   cp：“-p”标志保留模式、所有权（按编号）和时间戳。
*   scp：“-p”标志保留模式，但（通常）不保留所有权
*   rsync：只有 root 可以保留所有权（-o、-g 或 -p），尝试匹配用户名，但如果不可能，则回退到用户 ID。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-11-28T02:35:27.150

为什么要打扰权限？

除非您正在运行某种服务器，否则它们大部分时间都会妨碍您。

也许从 linux FS 复制到 FAT32、exfat 或 NTFS FS，这样您就不必处理权限？

这就是我所做的。我通常选择 NTFS 在台式机和笔记本电脑之间进行文件“共享”，其中笔记本电脑有 linux，台式机有 Windows 7。如果不多次执行 chmod，就无法轻松地将 *nix 笔记本电脑转换为 *nix 桌面电脑（即使这样也不能保证 R/W 权限)

当我试图在 *nix 之间共享时，一切都很糟糕。我需要每个人都可以从任何外部驱动器对任何盒子进行完全读/写访问。

ntfs 的唯一问题是您的 *nix 没有写入或正确关闭它。然后我必须使用windows来修复它（也很痛苦）。因此，我保留窗户的原因之一。

我拥有的每个闪存和外部驱动器都是 NTFS，除了其中 2 个是胖的 32 到 100% 保证没有与 linux 要求权限的错误（很多时候，即使使用 chmod，我也无法更改）。

当然我的数据是普通的老电影音乐图片，国内类似的项目。

但同样的理论认为，如果您没有或不能对该文件写入权限，那么任何人都应该能够从任何操作系统使用该文件。

我什至将一个顽固的文件复制到一个胖 32 闪存驱动器上，只是为了剥离权限然后将其复制回来。讨厌输入命令行的东西。

对我来说，我需要对所有计算机的外部驱动器上的任何数据进行 100% 的读写访问。

关于使用 root - 大多数 linux '供应商' 强烈反对使用 root 来做很多事情。

同样，绕过权限的简单方法是***，如果您可以复制它，您可以***通过将其发送到 fat32 来剥离它。或者ntfs。还有安全。

如果某些东西如此敏感以至于您在文件共享时需要文件安全性，那么为什么要首先共享它呢？

如果您想防止篡改文件，请将其刻录到 cd/dvd。那是只读的。即使他们复制并篡改它，原件仍然没有受到影响。

# asp.net-mvc - ASP.NET MVC 应用程序的图形页面组件在哪里？

> ID：299831
> 
> 赞同：0
> 
> 时间：2008-11-18T19:23:46.213
> 
> 标签：asp.net-mvc

这听起来很愚蠢，但有人告诉我，您可以将可视组件（包括 JavaScript 或 AJAX 组件？）拖放到 ASP.NET MVC 中的网页视图上，然后通过编辑它们背后的代码一次“自定义”组件他们就位。要么我误解了我被告知的内容，要么我是盲人并且不知道如何做到这一点，但这样做的能力会有很大帮助，特别是因为我无法真正设计东西来挽救我的生命。

**编辑 1：**为了澄清：按照我被告知的方式，它看起来像是您可以转到面板，将按钮拖到视图区域，然后将按钮放在那里的 HTML/CSS 将被删除。然后，您可以打开一个代码编辑器并根据您的需要调整所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T20:02:08.117

拖放更适合标准 ASP.NET 网络表单，而不是 MVC。我认为您仍然可以在 MVC 中执行此操作，但前提是控件不依赖于视图状态（MVC 不支持）。

尝试谷歌搜索“asp.net mvc 用户控件”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T20:12:59.607

即使使用 Webforms，Design 视图也毫无用处。即使是相对简单的网站设计，它也远不及您所设想的所见即所得编辑器。虽然您可以在技术上将组件拖放到页面上，但它们通常与呈现的 html 没有任何相似之处。

如果您想使用任何一种 ASP.Net 框架设计网站，您需要熟悉编写标记。这样做的好处是 MVC 框架大大简化了事物的标记方面。

# visual-studio - Notepad++ 类似 VisualStudio 中的搜索高亮显示

> ID：299838
> 
> 赞同：9
> 
> 时间：2008-11-18T19:25:54.337
> 
> 标签：visual-studio, highlighting

Notepad++ 有一个巧妙的功能，结合了搜索和突出显示。当您选择一个单词时，它会在页面上显示的任何其他位置突出显示，因此这是一种隐式搜索，我发现它非常有用。

有没有办法让它进入VS？

我也有兴趣让这些突出显示保持不变，以便我可以突出显示多个关键字（当然使用不同的 bgcolor），甚至在使它们保持不变后，在我打开的新页面上自动突出显示所有这些关键字。现在那真是太酷了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T19:29:55.530

查看此[问题](https://stackoverflow.com/questions/256931/how-to-highlight-occurrences-of-a-search-term-in-text-in-visual-studio)和相关答案： [如何在 Visual Studio 中突出显示文本中出现的搜索词？](https://stackoverflow.com/questions/256931/how-to-highlight-occurrences-of-a-search-term-in-text-in-visual-studio)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T19:28:39.057

Visual Studio 2010 将为 C# 和 Visual Basic 中的符号引入一个名为“突出显示引用”的功能，它的行为与您描述的一样。但是，尚不支持“粘性”突出显示（2010 年）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T19:29:02.927

Eclipse 中也提供了相同的功能。很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T19:32:58.270

Sara Ford 在她的博客上有一篇关于制作自定义编辑器的文章。可能是研究编写自己的插件或编辑器以实现目标的良好起点。

[http://blogs.msdn.com/saraford/archive/2006/08/09/693548.aspx](http://blogs.msdn.com/saraford/archive/2006/08/09/693548.aspx)

# java - 在 Java 中与多个打开的应用程序共享文件存储索引

> ID：299843
> 
> 赞同：1
> 
> 时间：2008-11-18T19:27:49.463
> 
> 标签：java, http, file, caching

我正在为 Java 编写一个 HTTP 缓存库，并且我试图在同一个应用程序中使用该库，该应用程序启动了两次。我希望能够在这些实例之间共享缓存。

什么是最好的解决方案？我还希望能够写入同一个存储，并且它应该可用于两个实例。

现在我有一个基于内存的可用于缓存的文件的索引，这不能在多个 VM 上共享。它在启动之间被序列化，但这不适用于共享缓存。

根据 HTTP 规范，我不能只将文件映射到 URI，因为基于请求的相同有效负载可能会有所不同。例如，我可能有一个在“接受语言”标头上有所不同的请求：在这种情况下，我将为每个后续请求指定一个不同的文件，该文件指定不同的语言。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T23:47:19.783

首先，当有多个缓存时，您确定要编写自己的缓存吗？像：

*   [ehcache](http://ehcache.sourceforge.net/)
*   [jboss缓存](http://www.jboss.org/jbosscache/)
*   [内存缓存](http://www.danga.com/memcached/)

前两个是用 Java 编写的，第三个可以从 Java 访问。前两个还处理分布式缓存，我认为这是您所要求的一般情况。当它们启动时，它们希望连接到其他成员，以便它们在实例之间保持一致的缓存。对一个的更改会反映在多个实例中。它们可以设置为通过多播或指定的特定服务器列表进行连接。

Memcached 通常以稍微不同的方式工作，因为它在您正在运行的 Java 进程的外部运行，因此所有启动的 Java 实例都将与一个公共服务通信。您可以将 memcached 设置为以分布式方式工作，但它通过散列键来实现，以便您要连接的服务器可以由您正在寻找的服务器来确定。

做一个内容一致的真正分布式缓存很难做好，这就是我建议查看现有库的原因。如果你想自己做，看看列出的那些，看看他们是怎么做的，并考虑使用像 JGroups 这样的东西作为你的底层机制，仍然会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T20:00:47.167

我认为你应该看看[WebDav-Specifications](http://www.greenbytes.de/tech/webdav/)。它是用于在服务器上共享/编辑/存储/版本控制资源的 HTTP 扩展。存在一个作为[Apache 模块](http://www.webdav.org/mod_dav/)的实现，它允许您快速开始使用它们。

因此，与其实现自己的缓存服务器实现，不如使用对两个应用程序都可用的本地 Apache + mod-dav 实例更好。

额外奖励：由于 WebDav 是一个指定的协议，您可以免费获得与许多工具的互操作性。

# php - 在 CodeIgniter 中密钥未知时获取 post 值

> ID：299851
> 
> 赞同：6
> 
> 时间：2008-11-18T19:29:19.073
> 
> 标签：php, forms, codeigniter, post, input

CodeIgniter 允许通过以下方式访问 POST 数据：

```
$this->input->post('input_name'); 
```

其中 'input_name' 是表单字段的名称。这适用于每个输入名称提前知道的静态表单。

就我而言，我正在从数据库中加载一组键/值对。该表单包含每个键/值对的文本输入。

我想知道，**有没有办法通过 CodeIgniter api 获取一组发布的数据？**

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-18T19:35:46.517

根据文件，没有。我建议只使用`array_keys($_POST)`来获取密钥。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-05-05T19:39:12.657

```
foreach($this->input->post() as $key => $val)  {  echo "<p>Key: ".$key. " Value:" . $val . "</p>\n";  } 
```

可以用来

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T19:39:34.497

当然，如果您有数据库中的一组键，则可以使用它，例如：

```
foreach ($arrayFromDb as $key => $value) {
    $newValue = $this->input->post($key);
} 
```

然后你有一个优势，如果人们提交额外的字段（例如通过修改表单并自己发布），这些字段将被忽略

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-03T18:47:34.610

```
$array_db_columns = $this->db->query('SHOW COLUMNS FROM ci_props');
    $array_db_columns = $array_db_columns->result_array();
    $array_save_values = array();
    foreach ( $array_db_columns as $value )
    {
        $array_save_values[$value['Field']] = $this->input->post($value['Field']);
    } 
```

插入 ：

`$this->db->insert('props', $array_save_values);`

更新 ：

`$this->db->where('id',$id); $this->db->update('props',$array_save_values);`

# visual-studio-2008 - 添加 VS2008 中缺少的 Web Reference 选项

> ID：299856
> 
> 赞同：30
> 
> 时间：2008-11-18T19:30:14.077
> 
> 标签：visual-studio-2008, console-application

我正在尝试向 VS2008 .Net 3.5 控制台应用程序添加 Web 引用，但该选项不存在。有“添加参考”和“添加服务参考”的选项。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-18T19:34:23.087

柯克·埃文斯（Kirk Evans）在博客中谈到了这个[问题](http://blogs.msdn.com/kaevans/archive/2008/03/18/where-the-heck-is-add-web-reference-in-visual-studio-2008.aspx)

基本上，您只需添加一个服务引用。Web 参考只是您可以添加的一种服务。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-12-19T15:13:04.487

1.  右键单击引用，然后单击“添加服务引用”
2.  在添加服务引用对话框中单击高级
3.  在高级对话框中单击“添加 Web 参考”
4.  像往常一样继续使用 asmx Web 服务。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T19:37:10.240

服务参考与 Web 参考相同——也就是说，您可以添加一个 ASMX Web 服务作为参考，它将生成您的代理/等。就像 Add Web Reference 所做的那样。

更改是为了支持 WCF 并让所有远程（“服务”）引用在 VS 中看起来和行为相同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T16:59:24.060

我认为您需要将 url 传递给 asmx，而不是 wsdl

# c# - 什么可以用作双面资源字典？

> ID：299869
> 
> 赞同：6
> 
> 时间：2008-11-18T19:37:31.363
> 
> 标签：c#, resourcedictionary

我正在使用 ResourceDictionary，但我希望能够使用其他项目查找值或键。每个都是独一无二的，所以这不是问题。有没有这种双面查找功能的类型？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-18T19:41:12.307

不是内置的，但这很容易编写。不过，我可能会为此实现 IDictionary ...然后您将 ResourceDictionary 转储到您的自定义类型中。

```
public class DoubleLookup<TKey, TValue>
{
  private IDictionary<TKey, TValue> keys;
  private IDictionary<TValue, TKey> values;

  //stuff...

  public void Add(TKey key, TValue value)
  {
    this.keys.Add(key, value);
    this.values.Add(value, key);
  }

  public TKey GetKeyFromValue(TValue value)
  {
    return this.values[value];
  }

  public TValue GetValueFromKey(TKey key)
  {
    return this.keys[key];
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T20:24:35.170

反转字典中的键/值关系时要非常小心。

字典的契约保证，对于集合中的每个值，都有一个映射到该值的键。钥匙是独一无二的。但反之则不然；对于每个不同的值，可以有许多不同的键映射到该值。

在我自己的个人代码库（用 Java 编写，足够接近）中，我有 MultiMap 类来处理这类事情。尽管键是唯一的，但每个键都可以与多个值相关联。它与 Map> 完全相同。

当我需要在集合中执行 value-to-key 查找时，我会执行以下操作：

```
Map<K, V> lookupTable = ...;
MultiMap<V, K> reverseLookupTable = MapUtil.invert(lookupTable);

V value = ...;
if (reverseLookupTable.containsKey(value)) {
   Set<K> keys = reverseLookupTable.get(value);
} 
```

如果您使用 MultiMap 以外的其他东西（如 HashMap 或 Dictionary）作为反向查找表，则可能会丢失一些 V->K 映射，除非您可以保证集合中的所有键和所有值是独一无二的。

* * *

编辑：

哎呀。我刚刚注意到您说您的集合中的所有键和值都是唯一的。但无论如何，我会在这里留下我的答案，作为对阅读本文的其他人的警告，他们可能无法提供相同的保证。

# css - 如何将图像水平居中并将其与容器底部对齐？

> ID：299870
> 
> 赞同：40
> 
> 时间：2008-11-18T19:37:51.067
> 
> 标签：css, positioning

如何将图像水平居中并同时与容器底部对齐？

我已经能够自行将图像水平居中。我还能够自行对齐容器的底部。但我无法同时做到这两点。

这是我所拥有的：

```
.image_block {
    width: 175px;
    height: 175px;
    position: relative;
    margin: 0 auto;
}
.image_block a img {
position: absolute;
bottom: 0;
}

<div class="image_block">
    <a href="..."><img src="..." border="0"></a>
</div> 
```

该代码将图像与 div 的底部对齐。我需要添加/更改什么才能使其在 div 内水平居中图像？图像尺寸事先不知道，但它会是 175x175 或更小。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-11-18T19:55:32.933

```
.image_block    {
    width: 175px;
    height: 175px;
    position: relative;
}

.image_block a  {
    width: 100%;
    text-align: center;
    position: absolute;
    bottom: 0px;
}

.image_block img    {
/*  nothing specific  */
} 
```

**解释**：绝对定位的元素将相对于最近的具有非静态定位的父元素。我假设你对你的`.image_block`显示方式很满意，所以我们可以把相对定位留在那里。

因此，`<a>`元素将相对于 定位`.image_block`，这将为我们提供底部对齐。然后，我们`text-align: center`将`<a>`元素设置为 100% 的宽度，使其大小为`.image_block`.

然后`<img>`内部`<a>`将适当地居中。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-01-04T11:08:09.307

这也有效（从这个[问题](https://stackoverflow.com/questions/1520825/vertical-align-image)中得到提示）

```
.image_block {
  height: 175px;
  width:175px;
  position:relative;
}
.image_block a img{
 margin:auto; /* Required */
 position:absolute; /* Required */
 bottom:0; /* Aligns at the bottom */
 left:0;right:0; /* Aligns horizontal center */
 max-height:100%; /* images bigger than 175 px  */
 max-width:100%;  /* will be shrinked to size */ 
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-18T19:44:25.873

不会

```
margin-left:auto;
margin-right:auto; 
```

添加到`.image_block`一个img 做的伎俩？
请注意，这在 IE6 中不起作用（也许 7 不确定）
你必须在`.image_block`容器 Div上做

```
text-align:center; 
```

`position:relative;`也可能是个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-18T19:56:44.400

这很棘手；它失败的原因是你不能在绝对定位时通过边距或文本对齐来定位。

如果图像在 div 中是单独的，那么我推荐这样的东西：

```
.image_block {
    width: 175px;
    height: 175px;
    line-height: 175px;
    text-align: center;
    vertical-align: bottom;
} 
```

您可能需要将`vertical-align`呼叫粘贴在图像上；不测试就不太确定。不过，使用`vertical-align`and`line-height`会比尝试使用绝对定位来更好地对待你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T19:42:02.243

删除`position: relative;`线。我不确定为什么，但它为我修复了它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T19:55:59.703

你有没有尝试过：

```
.image_block{
text-align: center;
vertical-align: bottom;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-07T15:49:30.987

```
#header2
{
   display: table-cell;
   vertical-align: bottom;
   background-color:Red;
}

<div style="text-align:center; height:300px; width:50%;" id="header2">
<div class="right" id="header-content2">
  <p>this is a test</p>
</div>
</div> 
```

# eclipse - Eclipse中饥饿的退格？

> ID：299876
> 
> 赞同：9
> 
> 时间：2008-11-18T19:40:32.543
> 
> 标签：eclipse, plugins, ide, editor

在某些编辑器中，存在实现称为“饥饿退格”或“饥饿删除”功能的插件。

如果此模式在文本编辑器中处于活动状态，则单击退格键将自动删除从当前光标位置到第一个非空白字符的所有空白字符。

例如，此功能存在于[Emacs](http://www.gnu.org/software/emacs/manual/html_node/ccmode/Hungry-WS-Deletion.html)和[IntelliJ IDEA](http://plugins.intellij.net/plugin/?id=162)中。

有谁知道它是否也可以在 Eclipse 中使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T19:59:43.923

Alt-Del 可能与您在不自己编写插件的情况下获得的一样接近。其他人要求提供此功能（来自 intelliJ），但到目前为止它不存在，或者尚未发布。

-亚当

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T20:02:00.923

CTRL-退格也非常接近：**删除上一个单词**：

```
function();    (4 spaces) 
```

+ CTRL-BACKSPACE 给出：

```
function 
```

除此之外，**[AnyEdit](http://andrei.gmxhome.de/anyedit/index.html)**插件可以将尾随空格转换为制表符（但也可以转换为“”，有效地删除它们）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T22:59:45.760

**Ctrl+Shift+Left，退格**总是对我有用。适用于记事本，网络浏览器，无处不在。坚持标准:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T20:51:11.370

在 SciTE 和 Eclipse (3.4) 中，Ctrl+Shift+Del 和最后一个可见字符后面的插入符号将删除这些空格。IE。它从插入符号删除到行尾。

实际上，在 SciTE 中我不需要这样做，因为我已将其设置为在保存时自动删除这些尾随空格。

注意：在 Preferences > General > Keys 中，有一个 Remove Trailing Whitespace 绑定（默认情况下没有键分配）似乎适用于 File。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-26T14:12:45.027

从 Eclipse Windows 菜单/首选项搜索键并过滤到“删除上一个单词”并将其绑定到 Ctrl+Backspace ![在此处输入图像描述](https://i.stack.imgur.com/GH5mR.png)

# agile - 敏捷 - 用户故事定义

> ID：299879
> 
> 赞同：12
> 
> 时间：2008-11-18T19:41:15.600
> 
> 标签：agile, user-stories

我正在为我朋友的业务编写一个小应用程序，并想借此机会复习我在年初进行的一些敏捷项目管理培训。

我（我认为，我现在的组织！）一直在努力以用户故事的形式收集需求，其形式如下：

作为 [用户类型] 我想要 [功能] 以便 [一些好处]

我*总是*很想错过开始和结束，然后离开这个功能——但这只是变成了收集旧方法的需求！

但我不想让它适合，这样我就可以说“我正在做敏捷”......例如，如果我知道要向用户展示一个项目列表，那么原因不言而喻，不是吗？

例如

作为[商店经理]，我想[查看库存商品列表]，以便...？

省略 [so that] 子句是正常的做法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-18T19:52:46.560

我们曾经也错过了它。通过忽略它，我们错过了很多。要正确理解该功能，而不仅仅是做正确的事情，而是做正确的事情，关键是要知道为什么要使用该功能，而下一个关键是谁（角色）在 DDD 术语中，利益相关者。利益相关者可以是不同的，每个关心的人。从程序员和数据库管理员到所有类型的用户。

所以，首先要了解，谁是利益相关者，然后你知道他关心的 50%，然后是好处，然后几乎很明显要实施什么。

尽量不要只写“作为用户”。指定。“作为商店经理”，甚至“作为负责结束一天的轮班负责人”，我需要......所以......

也许你可以实施一些不同的东西，这会给同一个利益相关者带来更好的利益！！！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-18T21:28:30.143

尝试，以实现 [商业价值] 作为 [用户] 我需要 [功能]。

目标是专注于功能提供的价值。它可以帮助您在垂直切片中进行思考，从而减少不可见的纯“技术任务”。这不是一个简单的过渡，但是当您开始垂直思考时，您就开始真正能够减少流程中的浪费。

另一种方法是考虑您的客户可以编写的验收测试，以确保该功能能够正常工作。然后使用[FitNesse](http://www.fitnesse.org)之类的东西来自动化这些测试只是一个短暂的跳跃。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-18T21:06:16.707

不，这实际上并不明显 - 有很多理由想要查看列表，很多您可能想要使用它的东西 - 扫描它以获取一些信息，获取概述，打印，复制并粘贴到word 文档等。它究竟是什么会给你关于合理实施细节的有价值的提示——列表的格式、确切的内容；甚至暗示不同的功能可能是满足这种需求的更好主意。不要惊讶地发现原因实际上是“这样我就可以计算条目的数量”......

当然，这实际上可能不适用于您。事实上，我的实际观点是人们想出这个模板是有原因的——还有很多有经验的人实际上并没有使用它的原因。而且，当您不熟悉该练习时，您无法评估遵循练习的所有利弊，因此我强烈建议您尝试密切关注它一段时间。您可能会对它的有用性感到惊讶 - 或者不会，在这种情况下，您仍然学到了一些东西，并且可以用简洁明了的方式放弃它...... :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T19:53:52.377

用户故事是另一种说法，您需要采访您的用户以了解他们想要什么以及他们试图解决什么问题。这就是敏捷开发的核心。如果表格不适合您，请退后一步，尝试一种不同的方法，让您感觉更自然或更适合您作为作家的能力。

简而言之，不要觉得你必须穿直筒夹克。重要的是你要遵循方法论的精神。

在这种特定情况下，您希望获得用户遇到的问题、问题的原因以及他们认为对他们有帮助的列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T19:50:58.887

我认为你真的应该尝试定义一个原因，即使它看起来很明显。如果你不能想出一个理由，那么为什么要首先构建这个功能呢？此外，原因可能会指出设计中的其他缺陷，这些缺陷可能会引发其他领域的改进。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-18T19:52:20.477

我经常按主要相关的用户/角色对我的故事进行分类，因此我不会将用户的身份放在故事标题中。我的故事也比一些敏捷方法建议的要大。通常，我从一个标题开始。我将其用于计划目的。一旦我接近实际处理那个故事，我就会用一些细节充实它——基本的想法、约束、假设、相关的故事——这样我就可以捕捉到更多我知道的关于它的信息。我还将我的故事保存在 wiki 中，而不是记事卡上。我理解这种权衡——即，我可能会在需要细节之前花太多时间在细节上，但我能够轻松地捕捉并与通常不在现场的客户分享。

对我来说，底线是敏捷是一种哲学，而不是规范。有些特定的实现可能（强烈）建议您以某种方式做事，并且在某些项目上可能是不可协商的。例如，如果你不配对程序，就很难说你在做 XP。不过，总的来说，我会说大多数敏捷主义者会说你应该按照它们为你工作的方式做那些对你有用的事情——只要它们符合一般原则，你仍然可以调用自己敏捷。一般原则包括早期发布/经常发布、单元测试、短迭代、承认会发生变化、延迟详细计划直到你准备好实施……

对我来说，底线是：如果这些故事在没有用户和理由的情况下对你有用——只要你了解用户是谁以及他们为什么想要某样东西——就按你的意愿去做。在开始实施之前不需要完整的规范。

# asp-classic - 这个 ASP 递归函数有什么问题？

> ID：299895
> 
> 赞同：2
> 
> 时间：2008-11-18T19:46:56.120
> 
> 标签：asp-classic, vbscript, ado

当我调用这个函数时，一切正常，只要我不尝试再次递归调用该函数。换句话说，如果我取消注释该行：

```
GetChilds rsData("AcctID"), intLevel + 1 
```

然后功能中断。

```
<%
    Function GetChilds(ParentID, intLevel)
        Set rsData= Server.CreateObject("ADODB.Recordset")
        sSQL = "SELECT AcctID, ParentID FROM Accounts WHERE ParentID='" & ParentID &"'"
        rsData.Open sSQL, conDB, adOpenKeyset, adLockOptimistic
        If IsRSEmpty(rsData) Then
            Response.Write("Empty")
        Else
            Do Until rsData.EOF
                Response.Write rsData("AcctID") & "<br />"
                'GetChilds rsData("AcctID"), intLevel + 1 
                rsData.MoveNext
            Loop
        End If
        rsData.close: set rsData = nothing
    End Function

    Call GetChilds(1,0)
%> 
```

*反馈后编辑

谢谢大家，

除了通常的错误：

```
Error Type: (0x80020009) Exception occurred. 
```

我不确定是什么导致了这些问题。我知道这可能是由于几个因素。

1.  不关闭连接并尝试重新打开相同的连接。
2.  到数据库的许多并发连接。

数据库内容如下：

```
AcctID | ParentID
1        Null
2        1
3        1
4        2
5        2
6        3
7        4 
```

我的想法是，我可以拥有一个带有子帐户的主帐户，而这些子帐户可以拥有自己的子帐户。最终将有另一个父 ID 为 Null 的主帐户，该主帐户将拥有自己的子帐户。考虑到这一点，我是否以正确的方式进行？

感谢您的快速回复。

* * *

谢谢大家，

除了通常的错误：

> 错误类型：（0x80020009）发生异常。

我不确定是什么导致了这些问题。我知道这可能是由于几个因素。

1.  不关闭连接并尝试重新打开相同的连接。
2.  到数据库的许多并发连接。

数据库内容如下：

```
AcctID | ParentID
1        Null
2        1
3        1
4        2
5        2
6        3
7        4 
```

我的想法是，我可以拥有一个带有子帐户的主帐户，而这些子帐户可以拥有自己的子帐户。最终将有另一个父 ID 为 Null 的主帐户，该主帐户将拥有自己的子帐户。考虑到这一点，我是否以正确的方式进行？

感谢您的快速回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T19:52:50.537

看起来它失败了，因为您的连接仍在忙于为上一次调用的 RecordSet 提供服务。

一种选择是为每个呼叫使用新连接。存在的危险是，如果您递归太多次，您将很快失去连接。

另一种选择是将每个 RecordSet 的内容读入一个断开连接的集合：（字典、数组等），这样您就可以立即关闭连接。然后遍历断开的集合。

如果您使用的是 SQL Server 2005 或更高版本，还有更好的选择。您可以使用 CTE（公用表表达式）来编写递归 sql 查询。然后您可以将所有内容移动到数据库中，您只需要执行一个查询。

其他一些注意事项：
ID 字段通常`int`是 ​​s，因此您不应将它们包含在 ' sql 字符串中的字符中。

最后，这段代码可能没问题，因为我怀疑是否允许用户直接输入身份证号码。但是，使用的动态 sql 技术非常危险，一般应避免使用。改为使用查询参数来防止 sql 注入。

我不太担心不使用`intLevel`任何东西。查看代码，这显然是一个早期版本，并且 intLevel 可以在以后用于确定诸如缩进或样式元素时使用的类名之类的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T19:51:20.353

SQL 连接用完了？

您在那里处理了很多层（用于客户端的 Response.Write、用于服务器的 ASP 和数据库），因此出现问题也就不足为奇了。

也许您可以发布有关该错误的一些详细信息？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T19:52:29.133

如果没有更多关于它如何破坏的描述，很难说，但你没有使用 intLevel 做任何事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T19:51:05.377

尝试使用函数定义中的 DIM 语句将变量声明为本地变量：

```
Function GetChilds(ParentID, intLevel)
Dim rsData, sSQL
Set ... 
```

编辑：好的，我尝试更明确。

我的理解是，由于 rsData 不是由 DIM 声明的，所以它不是局部变量，而是全局变量。因此，如果您遍历 WHILE 语句，您将到达最内层 rsData 记录集的 .Eof。您从递归函数调用返回，下一步又是 rsData.MoveNext，但失败了。

如果 rsData 确实是本地的，请纠正我。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T19:51:50.663

怎么破？

我的猜测是，经过一定次数的递归后，您可能会遇到堆栈溢出（讽刺），因为您没有分配太多的 RecordSet。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T19:54:04.840

在每次调用中，您都会打开与数据库的新连接，并且在打开新连接之前不要关闭它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T19:55:05.853

并不是说这实际上是递归问题的解决方案，但您最好制定一条 SQL 语句，以分层格式返回所有信息，而不是对数据库进行递归调用。

想一想，这可能是因为您有太多的并发数据库连接。您不断地打开，但在退出递归循环之前不会开始关闭。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T20:35:54.243

如果您需要这样的递归，我会亲自将递归放入存储过程并在数据库端处理该处理，以避免打开多个连接。如果您使用的是 mssql2005，请查看名为 Common Table Expressions (CTE) 的东西，它们使递归变得容易。还有其他方法可以实现与其他 RDBMS 的递归。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-18T21:04:23.000

基于这些建议，当我找到有关如何执行此操作的好教程时，我将尝试将查询移动到 CTE（公用表表达式）中。现在，作为一个快速而肮脏的修复，我已将代码更改如下：

```
Function GetChilds(ParentID, intLevel)
        'Open my Database Connection and Query the current Parent ID
        Set rsData= Server.CreateObject("ADODB.Recordset")
        sSQL = "SELECT AcctID, ParentID FROM Accounts WHERE ParentID='" & ParentID &"'"
        rsData.Open sSQL, conDB, adOpenKeyset, adLockOptimistic
        'If the Record Set is not empty continue
        If Not IsRSEmpty(rsData) Then
            Dim myAccts()
            ReDim myAccts(rsData.RecordCount)
            Dim i
            i = 0
            Do Until rsData.EOF
                Response.Write "Account ID: " & rsData("AcctID") & " ParentID: " & rsData("ParentID") & "<br />"
                'Add the Childs of the current Parent ID to an array.
                myAccts(i) = rsData("AcctID")
                i = i + 1
                rsData.MoveNext
            Loop
            'Close the SQL connection and get it ready for reopen. (I know not the best way but hey I am just learning this stuff)
            rsData.close: set rsData = nothing
            'For each Child found in the previous query, now lets get their childs.
            For i = 0 To UBound(myAccts)
                Call GetChilds(myAccts(i), intLevel + 1)
            Next
        End If
    End Function

    Call GetChilds(1,0) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-27T17:04:13.200

我有相同场景的工作代码。

我使用客户端光标

```
...
rsData.CursorLocation = adUseClient
rsData.Open sSQL, conDB, adOpenKeyset, adLockOptimistic
rsData.ActiveConnectcion = Nothing
... 
```

正如在其他回复中指出的那样，这不是很有效，我仅在管理界面中使用它，在该界面中不经常调用代码并且速度并不那么关键。

我不会在常规网页中使用这样的递归过程。要么重新编写代码以在一次调用中从数据库中获取所有数据，要么进行一次调用并将其保存到本地数组并将数组保存在应用程序变量中。

# caching - phpbb3中的缓存文件夹设置

> ID：299897
> 
> 赞同：0
> 
> 时间：2008-11-18T19:48:00.610
> 
> 标签：caching, config, phpbb3

谁能告诉我 phpbb3 的缓存文件夹配置在哪里？由于我的 isp，我需要使用不同的文件夹，并且找不到可以将文件夹指向另一个位置的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T20:38:17.730

找到了。如果其他人需要这个，现在它就在这里。:) 从没想过我会在这里回答我自己的问题。;) 谢谢我！

包括/acm/acm_file.php

```
/**
* Set cache path
*/
function acm()
{
    global $phpbb_root_path;
    $this->cache_dir = $phpbb_root_path . 'cache/';
} 
```

# java - Calling Java (or python or perl) from a PHP script

> ID：299913
> 
> 赞同：3
> 
> 时间：2008-11-18T19:51:54.423
> 
> 标签：java, php, python, dynamic-linking

I've been trying to build a simple prototype application in Django, and am reaching the point of giving up, sadly, as it's just too complicated (I know it would be worth it in the long-run, but I really just don't have enough time available -- I need something up and running in a few days). So, I'm now thinking of going with PHP instead, as it's the method for creating dynamic web content I'm most familiar with, and I know I can get something working quickly.

My application, while simple, is probably going to be doing some reasonably complex AI stuff, and it may be that libraries don't exist for what I need in PHP. So I'm wondering how easy / possible it is for a PHP script to "call" a Java program or Python script or a program or script in another language. It's not entirely clear to me what exactly I mean by "call" in this context, but I guess I probably mean that ideally I'd like to define a function in, let's say Java, and then be able to call it from PHP. If that's not possible, then I guess my best bet (assuming I do go with PHP) will be to pass control directly to the external program explicitly through a POST or GET to a CGI program or similar.

Feel free to convince me I should stick with Django, although I'm really at the point where I just can't figure out what model I need to produce the HTML form I want, which seems such a basic thing that I fear for my chances of doing anything more complex...

Alternatively, anyone who can offer any advice on linking PHP and other languages, that'll be grateful received.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T20:31:06.747

"where I just can't figure out what model I need to produce the HTML form I want, which seems such a basic thing that I fear for my chances of doing anything more complex"

Common problem.

Root cause: Too much programming.

Solution. Do less programming. Seriously.

Define the Django model. Use the default admin pages to see if it's right. Fix the model. Regenerate the database. Look at the default admin pages. Repeat until the default admin pages work correctly and simply.

Once it's right in the default admin pages, you have a model that works. It's testable. And the automatic stuff is hooked up correctly. Choices are defined correctly. Computations are in the model mmethods. Queries work. Now you can start working on other presentations of the data.

Django generally starts (and ends) with the model. The forms, view and templates are derived from the model.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T20:01:46.243

For an easy access of Java classes from PHP scripts you can use a php-java bridge.

There is a open source solution: [http://php-java-bridge.sourceforge.net/pjb/](http://php-java-bridge.sourceforge.net/pjb/)
or a solution from Zend ([http://www.zend.com/en/products/platform/product-comparison/java-bridge](http://www.zend.com/en/products/platform/product-comparison/java-bridge)).

I'm more familiar with the later, and it's very easy and intuitive to use.

# sql-server - 跟踪 SQL Server 2005 数据库中的更改

> ID：299931
> 
> 赞同：9
> 
> 时间：2008-11-18T19:56:06.663
> 
> 标签：sql-server, tracking, change-management

我的任务是开发一个跟踪数据库更改的解决方案。

对于我需要捕获的更新：

*   更新日期
*   旧值
*   新价值
*   受影响的领域
*   做改变的人
*   记录编号
*   表记录在

对于删除：

*   删除日期
*   删除的人
*   已删除记录的标题/描述/ID。我正在跟踪所有更改的表都有标题或描述字段。我想在删除记录之前捕获它。
*   表记录在

对于插入：

*   插入日期
*   做改变的人
*   记录编号
*   表记录在

我想了几种方法来做到这一点：

*   我正在使用存储过程进行任何更新/删除/插入。我会创建一个通用的“跟踪”表。它将有足够的字段来捕获所有数据。然后，我会在每个存储过程中添加另一行，以实现“将记录插入跟踪表”的效果。
    *   缺点：所有更新/删除/插入都混杂在同一张表中
    *   很多 NULL 字段
    *   如何跟踪批量更新/删除/插入？<---- 这可能不是问题。我真的没有在应用程序中做任何这样的事情。
    *   如何捕获进行更新的用户。数据库只看到一个帐户。
    *   编辑大量现有代码进行编辑。
*   最后，我可以创建一个在更新/删除/插入之后调用的触发器。许多与第一个解决方案相同的缺点，除了：我必须编辑尽可能多的代码。我不确定如何跟踪更新。看起来没有办法使用触发器来查看最近更新的记录。

我正在使用 asp.net、C#、sql server 2005、iis6、windows 2003。我没有预算，很遗憾我买不到任何东西来帮助我解决这个问题。

感谢您的回答！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T20:09:51.690

我不想回避这个问题，我知道你没有预算，但最简单的解决方案是升级到 SQL Server 2008。它[内置了](http://msdn.microsoft.com/en-us/library/bb522489.aspx)这个功能。我认为至少应该为遇到此问题的其他人提及这一点，即使您自己不能使用它。

（在 SQL 2008 的可部署版本中，此功能仅在 Enterprise 中可用。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T20:16:08.290

由于多种原因，触发器不会包含您需要的所有信息 - 但没有用户 ID 是关键。

我会说你在正确的轨道上使用一个通用的 sp 插入任何进行更改的地方。如果您正在为您的接口标准化 sp，那么您就处于领先地位 - 很难潜入未跟踪的更改。

将此视为相当于会计应用程序中的审计跟踪 - 这是日志 - 记录每笔交易的单个表。他们不会为存款、取款、调整等实施单独的日记帐，这是相同的原则。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T11:09:43.990

我建议您在每个表中使用 2 列。名称**rowhistory**和**IsDeleted**并且数据类型将是 xml 和 bit。 **永远不要删除行，总是使用标志 IsDeleted** 现在使用更新触发器。我会给你举个例子，我有一个叫做 Page 的表

```
 CREATE TABLE te_Page([Id] [int] IDENTITY(1,1) NOT NULL, [Name] [varchar](200) NOT NULL, [Description] [varchar](200) NULL,[CreatedBy] [uniqueidentifier] NULL, [CreatedDate] [datetime] NOT NULL, [UpdatedBy] [uniqueidentifier] NULL, [UpdatedDate] [datetime] NULL, [IsDeleted] [bit] NULL, [RowHistory] [xml] NULL, CONSTRAINT [PK_tm_Page] PRIMARY KEY CLUSTERED ([Id] ASC )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY] ) ON [PRIMARY] 
```

现在创建表格后，您需要做的就是复制粘贴下面的代码，您的任务就完成了 Page 表格。它将开始记录同一行中行的历史记录，该行与旧值和新值一起更新。

```
 ALTER Trigger [dbo].[Trg_Te_Page]    
        On [dbo].[te_Page]                
        After Update                
        As                 
        --If @@rowcount = 0 Or Update(RowHistory)    
        --Return    

        Declare @xml NVARCHAR(MAX)     
        Declare @currentxml NVARCHAR(MAX)   
        Declare @node NVARCHAR(MAX)    
        Declare @ishistoryexists XML    

        Declare @FormLineAttributeValueId int  

        -- new Values  
        Declare @new_Name varchar(200)  
        Declare @new_Description varchar(200)  

        Declare @new_CreatedBy UNIQUEIDENTIFIER    
        Declare @new_CreatedDate DATETIME    
        Declare @new_UpdatedBy UNIQUEIDENTIFIER    
        Declare @new_UpdatedDate DATETIME    
        Declare @new_IsDeleted BIT  

        --old values  
        Declare @old_Name varchar(200)  
        Declare @old_Description varchar(200)  

        Declare @old_CreatedBy UNIQUEIDENTIFIER    
        Declare @old_CreatedDate DATETIME    
        Declare @old_UpdatedBy UNIQUEIDENTIFIER    
        Declare @old_UpdatedDate DATETIME    
        Declare @old_IsDeleted BIT  

        -- declare temp fmId  
        Declare @fmId int  
        -- declare cursor  
        DECLARE curFormId cursor   
        FOR select Id from INSERTED   
        -- open cursor       
        OPEN curFormId  
        -- fetch row  
        FETCH NEXT FROM curFormId INTO @fmId  

        WHILE @@FETCH_STATUS  = 0   
        BEGIN   

        Select   
        @FormLineAttributeValueId = Id,   
        @old_Name = Name,  
        @old_Description = [Description],  

        @old_CreatedBy = CreatedBy,    
        @old_CreatedDate =CreatedDate,  
        @old_UpdatedBy =UpdatedBy,    
        @old_UpdatedDate =UpdatedDate,  
        @old_IsDeleted  = IsDeleted,  
        @currentxml = cast(RowHistory as NVARCHAR(MAX))  
        From DELETED where Id=@fmId  

        Select      
        @new_Name = Name,  
        @new_Description = [Description],  

        @new_CreatedBy = CreatedBy,    
        @new_CreatedDate =CreatedDate,  
        @new_UpdatedBy =UpdatedBy,    
        @new_UpdatedDate =UpdatedDate,  
        @new_IsDeleted  = IsDeleted  
        From INSERTED where Id=@fmId  

        set @old_Name = Replace(@old_Name,'&','&amp;')
        set @old_Name = Replace(@old_Name,'>','&gt;')  
        set @old_Name = Replace(@old_Name,'<','&lt;')     
        set @old_Name = Replace(@old_Name,'"','&quot;')
        set @old_Name = Replace(@old_Name,'''','&apos;')          

        set @new_Name = Replace(@new_Name,'&','&amp;')      
        set @new_Name = Replace(@new_Name,'>','&gt;')  
        set @new_Name = Replace(@new_Name,'<','&lt;')     
        set @new_Name = Replace(@new_Name,'"','&quot;')
        set @new_Name = Replace(@new_Name,'''','&apos;') 

        set @old_Description = Replace(@old_Description,'&','&amp;')
        set @old_Description = Replace(@old_Description,'>','&gt;')  
        set @old_Description = Replace(@old_Description,'<','&lt;')     
        set @old_Description = Replace(@old_Description,'"','&quot;')
        set @old_Description = Replace(@old_Description,'''','&apos;')          

        set @new_Description = Replace(@new_Description,'&','&amp;')      
        set @new_Description = Replace(@new_Description,'>','&gt;')  
        set @new_Description = Replace(@new_Description,'<','&lt;')     
        set @new_Description = Replace(@new_Description,'"','&quot;')
        set @new_Description = Replace(@new_Description,'''','&apos;')   

        set @xml = ''     

        BEGIN      

        -- for Name  
        If ltrim(rtrim(IsNull(@new_Name,''))) != ltrim(rtrim(IsNull(@old_Name,'')))    
        set @xml = @xml + '<ColumnInfo ColumnName="Name" OldValue="'+ @old_Name + '" NewValue="' + @new_Name + '"/>'    

        -- for Description  
        If ltrim(rtrim(IsNull(@new_Description,''))) != ltrim(rtrim(IsNull(@old_Description,'')))    
        set @xml = @xml + '<ColumnInfo ColumnName="Description" OldValue="'+ @old_Description + '" NewValue="' + @new_Description + '"/>'    

        -- CreatedDate     
        If IsNull(@new_CreatedDate,'') != IsNull(@old_CreatedDate,'')  
        set @xml = @xml + '<ColumnInfo ColumnName="CreatedDate" OldValue="'+ cast(isnull(@old_CreatedDate,'') as varchar(100)) + '" NewValue="' + cast(isnull(@new_CreatedDate,'') as varchar(100)) + '"/>'    

        -- CreatedBy     
        If cast(IsNull(@new_CreatedBy,'00000000-0000-0000-0000-000000000000')as varchar (36)) != cast(IsNull(@old_CreatedBy,'00000000-0000-0000-0000-000000000000')as varchar(36))    
        set @xml = @xml + '<ColumnInfo ColumnName="CreatedBy" OldValue="'+ cast(IsNull(@old_CreatedBy,'00000000-0000-0000-0000-000000000000') as varchar(36)) + '" NewValue="' + cast(isnull(@new_CreatedBy,'00000000-0000-0000-0000-000000000000') as varchar(36))+
        '"/>'    

        -- UpdatedDate       
        If IsNull(@new_UpdatedDate,'') != IsNull(@old_UpdatedDate,'')    
        set @xml = @xml + '<ColumnInfo ColumnName="UpdatedDate" OldValue="'+ cast(IsNull(@old_UpdatedDate,'') as varchar(100)) + '" NewValue="' + cast(IsNull(@new_UpdatedDate,'') as varchar(100)) + '"/>'    

        -- UpdatedBy     
        If cast(IsNull(@new_UpdatedBy,'00000000-0000-0000-0000-000000000000') as varchar(36)) != cast(IsNull(@old_UpdatedBy,'00000000-0000-0000-0000-000000000000') as varchar(36))    
        set @xml = @xml + '<ColumnInfo ColumnName="UpdatedBy" OldValue="'+ cast(IsNull(@old_UpdatedBy,'00000000-0000-0000-0000-000000000000') as varchar(36)) + '" NewValue="' + cast(IsNull(@new_UpdatedBy,'00000000-0000-0000-0000-000000000000') as varchar(36))+
        '"/>'    

        -- IsDeleted  
        If cast(IsNull(@new_IsDeleted,'') as varchar(10)) != cast(IsNull(@old_IsDeleted,'') as varchar(10))    
        set @xml = @xml + '<ColumnInfo ColumnName="IsDeleted" OldValue="'+ cast(IsNull(@old_IsDeleted,'') as varchar(10)) + '" NewValue="' + cast(IsNull(@new_IsDeleted,'') as varchar(10)) + '" />'    

        END    

        Set @xml = '<RowInfo TableName="te_Page" UpdatedBy="' + cast(IsNull(@new_UpdatedBy,'00000000-0000-0000-0000-000000000000') as varchar(50)) +  '" UpdatedDate="' + Convert(Varchar(20),GetDate()) + '">' + @xml + '</RowInfo>'    
        Select @ishistoryexists = RowHistory From DELETED     

        --print @ishistoryexists  

        If @ishistoryexists is null    
        Begin     
        Set @xml = '<History>' + @xml + '</History>'      
        Update te_Page    
        Set    
        RowHistory = @xml    
        Where     
        Id = @FormLineAttributeValueId    

        End    

        Else    
        Begin     
        set @xml = REPLACE(@currentxml, '<History>', '<History>' + @xml)  
        Update te_Page  
        Set  
        RowHistory = @xml  
        Where   
        Id = @FormLineAttributeValueId     
        End  

        FETCH NEXT FROM curFormId INTO @fmId  
        END   

        CLOSE curFormId  
        DEALLOCATE curFormId 
```

现在，每当您执行任何更新时，您的数据都将存储在**rowhistory**列中

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T20:32:41.813

我见过这种处理的一种方法（虽然我不推荐它，老实说）是通过存储过程来处理它，将用户 ID/用户名/任何东西作为参数传递。存储过程将调用日志记录过程，该过程将相关详细信息写入中央日志表。

不过，这就是它有点古怪的地方......

对于 INSERT/UPDATE，一旦 INSERT/UPDATE 成功完成，相关行就会作为 XML 数据存储在表中。对于 DELETE，行是在 DELETE 运行之前存储的（但实际上，他们可以从 DELETE 语句的输出中获取它——至少在 SQL Server 2005 中是这样）。

如果我没记错的话，该表只有几列：UserID、日志记录的 DateTime、Transaction Type (I/U/D)、包含相关行的 XML 数据、表名和主键值（主要用于快速搜索他们想要什么记录）。

给猫剥皮的方法有很多，但是...

**我的建议是保持简单。如果/当您需要时，稍后将其展开。**

如果您有能力这样做，请将用户锁定为只能通过存储过程对表执行可操作的语句，然后从那里处理日志记录（无论您想要什么）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T20:36:16.987

我们构建了自己的，只需要将用户和 pc 传递到每个添加/更新存储过程中。那么只需获取原始记录并填充变量并将它们与传入的变量进行比较并将数据记录到我们的表中即可。对于删除，我们只有原始表的副本 + 时间戳字段，因此该记录永远不会真正删除，并且可以在我们需要的任何时候恢复（显然删除例程检查 FK 关系等）。

添加/更新日志表看起来像 datetime、table_name、column_name、record_id、old_value、new_value、user_id、computer

我们从不插入空值，因此我们将它们转换为空字符串，新条目在 old_value 列中用“{new entry}”标记。record_id 由尽可能多的键列组成，以唯一标识该单个记录（ field1 + '.' + field2 + ... ）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T14:25:02.553

首先，在所有表中，您应该至少将这些列添加到数据列 DateCreated、UserCreated、DateModified、UserModified。可能您可能想要添加“状态”或“最后操作”列，这样您就不会真正删除只是将其设置为已删除/插入/更新状态的行。接下来，您可以创建一个“历史表”，它是第一个表的精确副本。然后在任何更新或删除时让触发器将 Deleted 表条目复制到 History 表中，同时更改 DateModified、UserModified 和 Status 字段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T21:24:01.980

我在 SQL Server 中有一个设置，我们将使用视图来访问我们的数据，这将使用 INSTEAD OF 触发器处理插入、更新和删除。

例如：视图上的**INSTEAD OF DELETE**触发器会将基础表中的记录标记为已删除，并且视图被过滤为不显示已删除的记录。

在所有触发器中，我们更新了修改日期和用户名。问题是记录的数据库用户名与最终的应用程序用户名不同。

视图需要是模式绑定才能工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-27T10:27:38.127

关于记录更改数据库的用户：您可以根据需要为数据库创建尽可能多的 SQL 用户，如果您使用会话和对程序/脚本的受限/注册访问，您可以使用该信息来启动不同的数据库连接设置（即用户名） , 在对 DB 进行任何操作之前。

至少这对于 PHP-wise 脚本应该是可行的，但对于 asp.net 我可能是错误的。

# .net - 我应该如何设置默认代理以使用默认凭据？

> ID：299940
> 
> 赞同：63
> 
> 时间：2008-11-18T20:00:53.393
> 
> 标签：.net, proxy

以下代码适用于我：

```
var webProxy = WebProxy.GetDefaultProxy();
webProxy.UseDefaultCredentials = true;
WebRequest.DefaultWebProxy = webProxy; 
```

不幸的是，`WebProxy.GetDefaultProxy()`已弃用。我还应该做什么？

（在我的部署中不允许使用 app.config 设置 defaultProxy 设置）

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2011-11-18T10:20:20.040

对于那些与 Brian Genisio 不同的是，*他们*能够设置应用程序配置文件的内容：- 不要在代码中做任何事情。而是将其添加到您的 app.config/web.config。

```
<system.net>
  <defaultProxy useDefaultCredentials="true" />
</system.net> 
```

真正地，真正地使用默认凭据的默认值应该是“true”；我看到这个问题让很多人感到困惑——开发人员、用户、IT 人员。

有关更多信息，请参见此处：- [http://sticklebackplastic.com/post/2007/01/26/Poxy-proxies.aspx](http://sticklebackplastic.com/post/2007/01/26/Poxy-proxies.aspx)

更新：我为微软创建了这个问题/想法，将 useDefaultCredentials 的默认值从 false 更改为 true，这样整个问题就消失了，.NET 应用程序“正常工作”；如果您同意，请投票：http:
[//visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2397357-fix-it-so-that-net-apps-can-access-http-thru-授权](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2397357-fix-it-so-that-net-apps-can-access-http-thru-auth)

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-11-19T01:10:10.133

从 .NET 2.0 开始，您不需要这样做。如果您没有在 Web 请求上显式设置 Proxy 属性，它将使用静态 WebRequest.DefaultWebProxy 的值。如果要更改所有后续 WebRequest 使用的代理，可以设置此静态 DefaultWebProxy 属性。

WebRequest.DefaultWebProxy 的默认行为是使用与 Internet Explorer 相同的基础设置。

如果您想对当前用户使用**不同的代理设置**，那么您需要编写代码

```
WebRequest webRequest = WebRequest.Create("http://stackoverflow.com/");
webRequest.Proxy = new WebProxy("http://proxyserver:80/",true); 
```

或者

```
WebRequest.DefaultWebProxy = new WebProxy("http://proxyserver:80/",true); 
```

您还应该记住代理的对象模型包括代理可以根据目标主机名而有所不同的概念。在调试和检查 webRequest.Proxy 的属性时，这会使事情变得有点混乱。称呼

`webRequest.Proxy.GetProxy(new Uri("http://google.com.au"))`查看将使用的代理服务器的实际详细信息。

关于是否可以设置`webRequest.Proxy`或`WebRequest.DefaultWebProxy = null`阻止使用任何代理似乎存在一些争论。这对我来说似乎工作正常，但您可以将其设置为`new DefaultProxy()`不带参数以获得所需的行为。要检查的另一件事是，如果您的应用程序配置文件中存在[代理元素，.NET Framework 将](http://msdn.microsoft.com/en-us/library/sa91de1e.aspx)**不会**使用 Internet Explorer 中的代理设置。

MSDN 杂志文章[通过 .NET 中的自动配置减轻用户的负担](http://msdn.microsoft.com/en-gb/magazine/cc300743.aspx)提供了有关幕后发生的事情的更多详细信息。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-09-30T05:02:53.447

这将强制`DefaultWebProxy`使用默认凭据，效果与通过`UseDefaultCredentials = true`.

```
WebRequest.DefaultWebProxy.Credentials = CredentialCache.DefaultNetworkCredentials; 
```

因此，**所有**新创建的**`WebRequest`**实例都将使用已配置为使用代理的默认凭据的默认代理。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-11T09:44:44.127

您可以使用反射将`UseDefaultCredentials`-Property from Code 设置为“true”

```
System.Reflection.PropertyInfo pInfo = System.Net.WebRequest.DefaultWebProxy.GetType().GetProperty("WebProxy", 
System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);

((System.Net.WebProxy)pInfo.GetValue(System.Net.WebRequest.DefaultWebProxy, null)).UseDefaultCredentials = true; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-01-25T09:44:07.107

似乎在一些较新的应用程序中，配置是不同的，正如我在这个问题上看到的那样[，使用 HttpClient 类时如何对代理进行身份验证？](https://stackoverflow.com/questions/9827976/how-to-authenticate-against-a-proxy-when-using-the-httpclient-class)

```
<system.net>
    <defaultProxy enabled="true" useDefaultCredentials="true">
         <proxy usesystemdefault="True" />
    </defaultProxy>
</system.net> 
```

还记录在[https://msdn.microsoft.com/en-us/library/dkwyc043.aspx](https://msdn.microsoft.com/en-us/library/dkwyc043.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-12-11T10:24:14.107

这个线程很旧，但我最近偶然发现了 defaultProxy 问题，也许它可以帮助其他人。

我按照安德鲁的建议使用了配置设置。部署它时，我的客户收到一条错误消息，说没有足够的权限来设置配置“defaultProxy”。

不知道为什么我无权设置此配置以及如何处理它，我只是将其删除，它仍然有效。所以似乎在 VS2013 中这个问题是固定的。

当我们这样做时：

```
 WebRequest.DefaultWebProxy.Credentials = new NetworkCredential("ProxyUsername", "ProxyPassword"); 
```

将默认代理与您的凭据一起使用。如果您想强制不使用代理，只需将 DefaultWebProxy 设置为 null（尽管我不知道是否需要）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-17T18:44:46.803

在我的部署中，我不能使用 app.config 来嵌入 Andrew Webb 建议的内容。
所以我这样做：

```
 IWebProxy proxy = WebRequest.GetSystemWebProxy();
    proxy.Credentials = CredentialCache.DefaultCredentials;

    WebClient wc = new WebClient();
    wc.UseDefaultCredentials = true;
    wc.Proxy = proxy; 
```

以防万一您想检查我的 IE 设置：

![在此处输入图像描述](https://i.stack.imgur.com/Z6uEw.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-17T22:30:52.277

这是新建议的方法。

```
WebRequest.GetSystemWebProxy(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-12T06:33:33.493

这里的大多数答案都使用了已弃用的 API。在 Powershell 5/6/7 中执行此操作的新方法是：

```
[System.Net.WebRequest]::GetSystemWebProxy().Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials; 
```

您可以将上述行放在您的 Powershell 5 和 Powershell 6/7 $Profile.AllUsersAllHosts 中。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2014-11-11T19:42:14.050

在某些系统中需要将代理属性设置为空：

Net.WebRequest.DefaultWebProxy.Credentials = System.Net.CredentialCache.DefaultCredentials Dim request As WebRequest = WebRequest.Create(sRemoteFileURL) request.Proxy = Nothing

这是一个错误。

# c# - 正则表达式匹配 HTML 标签并提取文本

> ID：299942
> 
> 赞同：7
> 
> 时间：2008-11-18T20:01:54.497
> 
> 标签：c#, regex

我有一串这样的测试：

```
<customtag>hey</customtag> 
```

我想使用 RegEx 修改“customtag”标签之间的文本，使其看起来像这样：

```
<customtag>hey, this is changed!</customtag> 
```

我知道我可以使用 MatchEvaluator 来修改文本，但我不确定要使用正确的 RegEx 语法。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-18T20:10:19.863

我也不会为此使用正则表达式，但如果你必须这个表达式应该工作： `<customtag>(.+?)</customtag>`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-18T20:04:49.670

在使用正则表达式来解析和更改 HTML 之前，我会咬断自己的腿。

使用[XSL](http://www.w3schools.com/xsl/xsl_languages.asp)或[DOM](http://www.w3schools.com/dom/default.asp)。

* * *

有两条评论要求我澄清。正则表达式替换适用于 OP 问题的特定情况，但一般来说正则表达式不是一个好的解决方案。正则表达式可以匹配[正则语言](http://en.wikipedia.org/wiki/Regular_language)，即可以被有限状态机接受的输入序列。HTML 可以包含任意深度的嵌套标签，因此它不是常规语言。

这与问题有什么关系？对 OP 的问题使用正则表达式，因为它是书面的，但是如果标签之间的内容`<customtag>`包含其他标签怎么办？如果文本`<`中出现文字字符怎么办？Jon Tackabury 提出这个问题已经 11 个月了，我猜在那个时候，他的问题的复杂性可能会增加。

正则表达式是很棒的工具，我一直都在使用它们。但是使用它们代替真正的解析器来处理需要解析器的输入只会在非常简单的情况下起作用。实际上，这些情况不可避免地会超出正则表达式的处理范围。发生这种情况时，您会很想编写更复杂的正则表达式，但这些很快就会变得非常费力开发和调试。当解析需求扩大时，准备废弃正则表达式解决方案。

XSL 和 DOM 是设计用于处理 XML 或 XHTML 标记的两种标准技术。这两种技术都知道如何解析结构化标记文件、跟踪嵌套标签并允许您转换标签属性或内容。

这里有几篇关于如何在 C# 中使用 XSL 的文章：

*   [http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=63](http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=63)
*   [http://www.csharphelp.com/archives/archive78.html](http://www.csharphelp.com/archives/archive78.html)

这里有几篇关于如何在 C# 中使用 DOM 的文章：

*   [http://msdn.microsoft.com/en-us/library/aa290341%28VS.71%29.aspx](http://msdn.microsoft.com/en-us/library/aa290341%28VS.71%29.aspx)
*   [http://blogs.msdn.com/tims/archive/2007/06/13/programming-html-with-c.aspx](http://blogs.msdn.com/tims/archive/2007/06/13/programming-html-with-c.aspx)

这是一个 .NET 库，可帮助对 HTML 进行 DOM 和 XSL 操作：

*   [http://www.codeplex.com/Wiki/View.aspx?ProjectName=htmlagilitypack](http://www.codeplex.com/Wiki/View.aspx?ProjectName=htmlagilitypack)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T07:29:10.867

如果两个标签之间没有任何其他标签，则此正则表达式更安全，更高效：

```
<customtag>[^<>]*</customtag> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-20T08:31:05.420

```
//This is to replace all HTML Text

var re = new RegExp("<[^>]*>", "g");

var x2 = Content.replace(re,"");

//This is to replace all &nbsp;

var x3 = x2.replace(/\u00a0/g,''); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-18T00:15:54.247

大多数人使用 HTML Agility Pack 进行 HTML 文本解析。但是，对于我自己的需求，我发现它有点健壮和复杂。我在内存中创建了一个 Web 浏览器控件，加载页面并从中复制文本。（见下面的例子）

你可以在这里找到 3 个简单的例子：

[http://jakemdrew.wordpress.com/2012/02/03/getting-only-the-text-displayed-on-a-webpage-using-c/](http://jakemdrew.wordpress.com/2012/02/03/getting-only-the-text-displayed-on-a-webpage-using-c/)

# java - 我可以这样实现 HttpSessionListener 吗？

> ID：299947
> 
> 赞同：0
> 
> 时间：2008-11-18T20:03:25.557
> 
> 标签：java, servlets

我正在尝试在我的 Java servlet 中跟踪有效的用户 ID，我可以这样实现 HttpSessionListener 吗？

```
public class my_Servlet extends HttpServlet implements HttpSessionListener
{
  String User_Id;
  static Vector<String> Valid_User_Id_Vector=new Vector<String>();
  private static int activeSessions=0;

  public void sessionCreated(HttpSessionEvent se)
  {
// associate User_Id with session Id;
// add User_Id to Valid_User_Id_Vector
    Out(" sessionCreated : "+se.getSession().getId());
    activeSessions++;
  }

  public void sessionDestroyed(HttpSessionEvent se)
  {
    if (activeSessions>0)
    {
// remove User_Id from Valid_User_Id_Vector by identifing it's session Id
      Out(" sessionDestroyed : "+se.getSession().getId());
      activeSessions--;
    }
  }

  public static int getActiveSessions()
  {
    return activeSessions;
  }

  public void init(ServletConfig config) throws ServletException
  {
  }

  public void destroy()
  {

  }

  protected void processRequest(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException
  {
    User_Id=request.getParameter("User_Id");
  }

  protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException
  {
    processRequest(request, response);
  }

  protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException
  {
    processRequest(request, response);
  }

  public String getServletInfo()
  {
    return "Short description";
  }
} 
```

如何在会话结束时通知听众？我试图一起绕过“/WEB-INF.web.xml”，可行吗？还是有意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T20:10:52.093

这不会绕过`/WEB-INF/web.xml`. 此外，您最终会得到这个类的 2 个实例，而不是 1 个执行这两个功能。我建议你把这个 Vector 放在[`ServletContext`](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletContext.html)并有 2 个单独的类。

在 servlet 中，您可以通过[`getServletContext()`](http://java.sun.com/javaee/5/docs/api/javax/servlet/GenericServlet.html#getServletContext()). 在侦听器中，您将执行以下操作：

```
public void sessionCreated(HttpSessionEvent se) {
    Vector ids = (Vector) se.getSession().getServletContext().getAttribute("currentUserIds");
    //manipulate ids
} 
```

# sql-server - SQL Server 对非拉丁字符集的 SoundEx 函数？

> ID：299949
> 
> 赞同：3
> 
> 时间：2008-11-18T20:04:21.560
> 
> 标签：sql-server, soundex

SQL Server (2000) **Soundex 函数是否适用于亚洲字符集**？我在查询中使用它，它似乎没有正常工作，但我意识到这可能是因为我不知道如何阅读中文......

此外，是否还有其他语言可能无法使用该功能？（例如俄语）

谢谢你，
弗兰克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T20:57:50.390

Soundex 相当特定于英语 - 它可能适用于其他语言，也可能不适用于其他语言。新西兰发生的一个例子是尝试使用 Soundex 进行患者姓名匹配。不幸的是，太平洋岛屿名称不能很好地与 Soundex 配合使用，在许多情况下会散列到相同的小值集。必须使用不同的算法。

你的旅费可能会改变。在较新版本的 SQL Server 上，您可以编写一个 CLR 函数来执行一些其他计算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T20:11:58.330

按照设计，它最适用于使用 ASCII 字符集的英语句子。我在罗马尼亚的一个项目中使用了它，在那里我将罗马尼亚语特殊字符替换为*听起来*或多或少相同的相应 ASCII 字符。它并不完美，但就我而言，它总比没有好。

我认为你在亚洲字符集上应用 SOUNDEX 不会有很大的成功。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T20:44:48.280

我知道旧版本的 SQLServer 中的 soundex 忽略了任何非英语字符。我相信它甚至不能处理 Latin-1，更不用说更奇特的东西了。

我从来没有在 SQL2k 中过多地处理 soundex，我所知道的只是它不能正确处理阿拉伯语。这也可能扩展到其他非拉丁字符集。

在任何情况下，即使除了字符集问题，基于 soundex 的算法也不太可能为非英语语言产生可接受的结果。Soundex 专门设计用于处理名称的英语发音（主要是西欧血统的名称），并且在该用途之外不能很好地发挥作用。您通常最好研究几种 soundex 变体或其他不相关的语音相似性算法中的任何一种，这些算​​法旨在解决相关语言的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-24T17:54:03.630

您可以使用类似 Levenshtein distance 的算法。该算法有多种实现方式作为用户定义的函数，您可以在`SELECT`语句中使用它们。

# .net - 如何创建通用链接列表？

> ID：299950
> 
> 赞同：2
> 
> 时间：2008-11-18T20:04:46.817
> 
> 标签：.net, generics, c#-3.0, list, linked-list

我正在尝试使用通用链接列表在我的应用程序中保存一些工作流程步骤。这是我将它持久保存到我的数据库的方式。

OrderID WorkFlowStepID ParentWorkFlowStepID
178373 1 NULL
178373 2 1
178373 3 2

我将此数据集返回到 datareader 对象中。然后，我遍历数据读取器并创建一个包含 WorkFlowStepID 属性和 ParentWorkFlowStepID 属性的 WorkFlowStep 对象。我使用 .AddFirst() 方法将第一个对象添加到我的 LinkedList 中。我的下一个想法是创建下一个对象，然后将其插入到 LinkedList 中的对象之后，其中它的 WorkFlowStepID 等于新对象的 ParentWorkFlowStepID。我无法在 LinkedList 中找到对象。find() 方法要求一个值，但我不明白它是什么值，或者我如何找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T20:13:15.347

那么你的意思是你[在框架中使用链表类](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)吗？

如果是这样，该`Find`方法并没有真正做到你想要的。基本上你想要一个带有谓词的版本。如果该类公开了[`LinkedListNode<T>`](http://msdn.microsoft.com/en-us/library/ahf4c754.aspx). 幸运的是，很容易提供一个扩展方法来做到这一点：

```
public static IEnumerable<LinkedListNode<T>> GetNodes<T>(this LinkedList<T> list)
{
    LinkedListNode<T> current = list.First;
    while (current != null)
    {
        yield return current;
        current = current.Next;
    }
} 
```

然后你可以这样做（我强调所有这些都未经测试）：

```
var node = list.GetNodes().FirstOrDefault(x.Value.WorkFlowerStepID = parentWorkFlowStepID);
if (node != null)
{
    list.AddAfter(node, newItem);
}
else
{
    // Whatever. Add to tail?
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T20:45:54.237

是否可以像订单 ID、工作流程步骤 ID、重量一样持久化您的数据

然后第一个项目的重量为 0，下一个重量为 1，下一个重量为 2。重的项目沉到列表的末尾。

最后，当您从数据库中读取数据时，您只需按重量（升序）对其进行排序，然后在从结果中读取数据时将每个项目添加到列表的末尾。这意味着您根本不需要自定义查找方法。

如果您想直接从数据库中删除一个步骤，以这种方式表示它会使生活变得更简单，因为现在可以通过删除 WorkFlowStepID 2 来破坏您的数据库模式。然后项目 3 没有要附加到的父项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T21:01:31.773

如果输出是一棵退化的树（即一个节点总是有 1 个子节点），您可以有一个指向最后一个节点的链表并继续将子节点添加到最后一个节点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T20:17:18.913

定义一个比较函数，然后使用作为委托传入的比较函数调用 list .Sort() 方法。该函数应该接受 2 个对象（例如 X 和 Y），如果 X 大于 Y，则返回 -1，如果它们相等则返回 0，如果 Y 大于 X，则返回 1。

# c# - 将 ItemCommand 添加到 CompositeDataBoundControl

> ID：299956
> 
> 赞同：2
> 
> 时间：2008-11-18T20:08:20.647
> 
> 标签：c#, asp.net

我有一个 CompositeDataBoundControl 并且我试图向它添加一个 ItemCommand，ala System.Web.UI.WebControls.Repeater - 所以就像一个笨蛋，我只是想如果我反射并添加这样的代码，它应该可以工作：

```
private static readonly object EventItemCommand = new object();

protected override bool OnBubbleEvent(object sender, EventArgs e)
{

   // throw new Exception();
    bool flag = false;
    if (e is RepeaterCommandEventArgs)
    {
        this.OnItemCommand((RepeaterCommandEventArgs)e);
        flag = true;
    }
    return flag;
}

protected virtual void OnItemCommand(RepeaterCommandEventArgs e)
{
    RepeaterCommandEventHandler handler = (RepeaterCommandEventHandler)base.Events[EventItemCommand];
    if (handler != null)
    {
        handler(this, e);
    }
}

public event RepeaterCommandEventHandler ItemCommand
{
    add
    {
        base.Events.AddHandler(EventItemCommand, value);
    }
    remove
    {
        base.Events.RemoveHandler(EventItemCommand, value);
    }
} 
```

不幸的是，即使我绑定了事件，它似乎也没有触发。我试图沿着 IPostBackEventHandler 的路线走，但它仍然不太正确（我可以在没有 args 的情况下触发一个空事件，但我看不到用 RepeaterCommandEventArgs 调用 OnItemCommand 的体面方法

任何想法如何让它发挥作用？

在过去的 4 个小时里，我一直坐在办公室里，试图让它发挥作用！帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T22:16:25.880

对于 Repeater 控件，RepeaterItem 对象实际上是引发气泡事件并提供 RepeaterCommandEventArgs：

```
protected override bool OnBubbleEvent(object source, EventArgs e)
{
    if (e is CommandEventArgs)
    {
        RepeaterCommandEventArgs args = new RepeaterCommandEventArgs(this, source, (CommandEventArgs) e);
        base.RaiseBubbleEvent(this, args);
        return true;
    }
    return false;
} 
```

如果您没有在控件中使用RepeaterItem，您可能永远不会得到RepeaterCommandEventArgs。请尝试检查 CommandEventArgs。还要确保曾经调用过控件的 OnBubbleEvent 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T12:18:25.180

我使用自定义的“RepeaterItem”（例如RecipeItem） - 我似乎无法让OnBubbleEvent（已覆盖它并从RepeaterItem 偷东西）在项目中触发。

没关系，我是个白痴。注释掉了一个 DataBind();！

# c# - 填充 asp:dropdownlist - VS 2008

> ID：299969
> 
> 赞同：1
> 
> 时间：2008-11-18T20:10:37.617
> 
> 标签：c#, asp.net, visual-studio-2008

我有名为 2 DDL 的表单

州和市

状态：

```
<asp:UpdatePanel ID="States" runat="server" UpdateMode="Conditional">
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="States"EventName="SelectedIndexChanged" />
        </Triggers>
        <ContentTemplate>
            <asp:DropDownList ID="States" runat="server"
            AutoPostBack="True" DataSourceID="StatesObjectDataSource" 
            AppendDataBoundItems="true" 
                onselectedindexchanged="States_SelectedIndexChanged">
            <asp:ListItem Value="-1" Text="- None -"/>    
            </asp:DropDownList>
            <asp:ObjectDataSource ID="StatesObjectDataSource" runat="server" 
                onselecting="StatesObjectDataSource_Selecting" 
                SelectMethod="GetStates" 
                TypeName="Something">
            </asp:ObjectDataSource>
        </ContentTemplate>
    </asp:UpdatePanel> 
```

城市：

```
<asp:DropDownList ID="Cities" runat="server">
        </asp:DropDownList> 
```

当他们选择一个州时，我想用该州的所有城市填充 Cities DDL。

在后面的代码中，我可以到达

```
States_SelectedIndexChanged(object sender, EventArgs e) 
```

我尝试以此填充 Cities DDL

```
Cities.Items.Add(new ListItem(city,city)); 
```

但是，我没有看到我的 Cities DDL 已填充

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T22:52:21.423

我建议在 ViewState 中创建一个私有属性来保存物理对象的集合。然后将对象添加到该列表，然后将对象列表数据绑定到下拉列表。

后面的页面

```
<asp:DropDownList runat="server" ID="ddlCity" DataValueField="Key" DataTextField="Value">
</asp:DropDownList> 
```

代码背后

```
private List<KeyValuePair<string, string>> ListData
{
    get { return (List<KeyValuePair<string, string>>) (ViewState["ListData"] ??     
                 (ViewState["ListData"] = new List<KeyValuePair<string, string>>())); }
    set { ViewState["ListData"] = value; }
}

protected void States_SelectedIndexChanged_SelectedIndexChanged(object sender, EventArgs e)
{
  ListData.Add(new KeyValuePair<string, string>(ddlCitys.SelectedValue, ddlCitys.SelectedValue));
  ddlCitys.DataSource = ListData;
  ddlCitys.DataBind();
} 
```

get 语句还对 ListData 属性使用延迟加载，因此您在访问列表时永远不会遇到空引用异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T23:01:00.843

如果可能的话，我建议使用[CascadingDropDown Extender](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/CascadingDropDown/CascadingDropDown.aspx)而不是 UpdatePanel。重新发明那个轮子是没有用的，而且 Toolkit 控件使用 Web 服务而不是部分回发（快得多）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T23:05:42.987

将您的城市 DropDownList 放在更新面板中。

# excel - 导出到 CSV 或 Excel 的不同结果

> ID：299972
> 
> 赞同：1
> 
> 时间：2008-11-18T20:10:59.627
> 
> 标签：excel, reporting-services, csv

我有一个简单的报告，我想导出到 CSV 文件。只有按一个字段分组的明细行，没有组标题，以及总计的组页脚。问题是当我导出为 CSV 格式时，组的总行列在每条记录的前面？

如果我导出到 Excel 然后另存为 CSV 文件，总行就是它所属的位置。然而，一个字段分布在 3 列中，然后这些列被“合并并居中”，这在行的中间添加了两个逗号。并且在记录的开头添加一列，在记录的末尾添加两列，多出 3 个逗号。

编写一个宏来“清理”电子表格并将其导出为我的最终用户的 csv 文件会很容易。然而，企业“不安全”将不允许最终用户拥有宏。

任何帮助、建议、指向其他地方的建议都非常感谢。

干杯

鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T09:21:09.200

任何标准报告工具生成的 CSV 都是扁平的数据结构，因此会重复所有数据集。由复制工具生成的 XLS 通常要在 XLS 中打开，它的 XLS 默认行为会为每个合并的单元格添加额外的逗号。最好的方法是创建一个具有相同数据长度列的布局的报告，即使是标题，即在格式化报告时不要将标题放在中心，长度较大，粗体和斜体等，将其作为第一列并将长度与详细记录中的数据匹配。通过这种方式，您将能够创建在 XLS 中看起来无法呈现但会在 CSV 中为您提供所需数据的报告

# xml - 如何为 XML 模式中的整数设置最小长度？

> ID：299978
> 
> 赞同：4
> 
> 时间：2008-11-18T20:13:06.487
> 
> 标签：xml, xsd

我正在创建 XML 模式，我的值之一是一年。因此，我想确保所有值都恰好有 4 个字符。为此，我使用以下语法：

```
<xs:element name="publish_year" maxOccurs="1">
  <xs:simpleType>
    <xs:restriction base="xs:positiveInteger">
      <xs:totalDigits value="4"/>
    </xs:restriction>
  </xs:simpleType>                                      
</xs:element> 
```

如果我正确理解“totalDigits”，有人可以传入“2008”或“200”的“publish_year”值。两者都是有效的。因此，我如何构建我的 XSD 以确保需要 4 位数字？乍一看，我猜我会使用正则表达式，但我想知道我是否忽略了一些已经嵌入的东西（比如“totalDigits”）

更新：

我采用了以下解决方案。这可能有点矫枉过正，但它明白了这一点：

```
<xs:simpleType>
    <xs:restriction base="xs:positiveInteger">
        <xs:totalDigits value="4" fixed="true"/>
        <xs:minInclusive value="1900"/>
        <xs:pattern value="^([1][9]\d\d|[2]\d\d\d)$"/>
    </xs:restriction>
</xs:simpleType> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-18T20:17:18.757

作为附加限制的价值宝藏怎么样？

( [minInclusive](http://www.w3.org/TR/xmlschema-2/#rf-minInclusive) - [maxInclusive](http://www.w3.org/TR/xmlschema-2/#dc-maxInclusive) )

例如 ？

```
<xs:minInclusive value="1900"/> et <xs:maxInclusive value="2008"/> 
```

但是要回到[totalDigits](http://www.w3.org/TR/xmlschema-2/#dt-totalDigits)约束，为什么不将`fixed`属性设置为 true ？

> 如果 {fixed} 为真，则当前类型为 {base type definition} 的类型不能为 totalDigits 指定 {value} 以外的值。

```
<xs:totalDigits value="4" fixed="true" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-24T00:38:22.527

我会根据需要使用基本类型 xs:gYear，并带有额外的约束方面。有关更多信息，[这](http://www.w3.org/TR/xmlschema-2/#built-in-datatypes)可能会有所帮助。

# asp.net-mvc - ASP.NET MVC 安装失败

> ID：299980
> 
> 赞同：1
> 
> 时间：2008-11-18T20:14:55.687
> 
> 标签：asp.net-mvc, installation

我需要一些关于 asp.net mvc 安装的帮助。

尝试安装 ASP.NET MVC Beta 时出现以下两个错误：

*错误应用程序 devenv.exe，版本 9.0.21022.8，时间戳 0x47317b3d，错误模块未知，版本 0.0.0.0，时间戳 0x00000000，异常代码 0xc0000005，错误偏移量 0x006c0061，进程 ID 0x11d8，应用程序启动时间 0x01c949b7447a7a50。*

*产品：Microsoft ASP.NET MVC Beta -- 错误 1722。此 Windows Installer 程序包存在问题。作为设置的一部分运行的程序未按预期完成。请联系您的支持人员或软件包供应商。操作 VisualStudio_VSSetup_Command，位置：D:\Program Files\Microsoft Visual Studio 9.0v2\Common7\IDE\devenv.exe，命令：/setup*

我卸载并安装了 Visual Studio，但没有任何改变。

我有以下配置：Visual Studio 2008 sp1、.net 3.5 sp1、Windows Server 2008

有人对此有解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T20:35:32.620

你试过重启你的机器然后再试一次吗？

您是否尝试过重新下载安装程序并再次尝试？

# asp.net - asp.net 线程和 gui

> ID：299981
> 
> 赞同：3
> 
> 时间：2008-11-18T20:15:30.740
> 
> 标签：asp.net, multithreading

更改将出现在线程内网页上的元素是否存在任何问题。我来自 Windows 编程背景，显然如果线程需要以某种方式更改 GUI，则必须将其委托给 GUI 线程。

基本上我的页面使用 3 个可以同时运行的 sql 查询来获取页面数据。所以我设置了 3 个线程并让它们运行，如果一个失败或没有记录，它会显示一条关于它的错误消息，这目前在线程内完成并且似乎有效。

注意： 3 个 sql 查询是针对非常不同的数据，运行 3 个单独的查询绝对是最快的，同时运行它们会使其更快（就页面显示所需的时间而言）。

编辑：线程加入页面加载事件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T21:08:05.143

在呈现页面之前，您必须加入所有 3 个线程。一旦它被渲染出来，就没有更新它了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T21:29:34.057

基本上 asp.net 渲染是关于构建一个大字符串，这将是渲染的输出，这是一个 html 页面。（不包括动态图像渲染等。）所以简短的回答是否定的，高于任何“正常”线程问题。

# mysql - 开发和生产数据库？

> ID：299986
> 
> 赞同：20
> 
> 时间：2008-11-18T20:16:30.647
> 
> 标签：mysql

我正在使用 PHP 和 mySQL。我终于了解了源代码控制，并且对 PHP 部分的整个开发（测试）v 生产 v 存储库的事情感到非常满意。

我的新难题是如何处理数据库。我是否为测试环境创建一个，为生产环境创建一个？我目前只有两个环境都使用的那个，我的测试数据就放在那里。我觉得我应该有两个，但在确保我的生产数据库看起来和感觉与我的测试数据库完全相同方面我很紧张。

关于走哪条路的任何想法？而且，如果您认为是后者，最好的方法是保持两个数据库相同（当然，除了数据......）？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-18T20:19:41.607

每个环境都应该有一个单独的数据库。编写所有数据库对象（表、视图、过程等）的脚本并将脚本存储在源代码管理中。脚本首先应用于开发数据库，​​然后提升到测试（QA、UAT 等），然后是生产。通过将相同的脚本应用于每个数据库，它们最终应该都是相同的。

如果您有需要加载的数据（代码表、查找值等），请将数据加载脚本作为数据库创建过程的一部分。

通过将所有内容编写脚本并将其保存在源代码管理中，可以随时为任何给定的构建级别重新创建数据库结构。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T20:19:11.467

你绝对应该有两个。就保持它们同步而言，您应该始终创建 DDL 来创建数据库对象。像对待 PHP 代码一样对待这些脚本 - 将它们保存在版本控制中。每当您必须修改测试数据库时，制作一个脚本来执行此操作，并将其签入。然后您可以在准备好后将这些更改传播到生产系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T20:24:31.753

每个开发工作站至少有一个数据库，生产工作站至少有一个数据库。除此之外，您应该有一个用于测试环境，除非您只是一名开发人员并且具有与生产环境类似的设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T07:25:59.203

也可以看看

[您如何对数据库架构进行版本控制？](https://stackoverflow.com/questions/175451/how-do-you-version-your-database-schema)

这是一个常见问题，已被多次询问和回答。

Thomas Owens：复制不能用于版本控制模式 - 它用于复制数据。您永远不想从开发复制到生产，反之亦然。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T21:38:52.790

我一直在做的一件事是创建一个安装了数据库的 VM。您可以将 VM 保存为播放文件，包括其数据。然后您可以做的是拍摄播放文件的快照，并根据需要启动任意数量的不同 VM。它们可以全部相同，或者您可以修改一个或另一个。这是一件好事：假设您有一个开发版本的数据库，您可以简单地在生产服务器而不是当前服务器上启动该 VM。

如果您的生产数据不在您的开发机器上，这完全是另一个问题。不过，在这种情况下，您可以做的一件事就是设置一个跟踪虚拟机。运行从主数据库到跟踪 VM 的复制。当您需要在生产数据库上运行一些更改时，首先停止从属服务器并保存快照。

启动该快照的一个实例，将其完全脱离从属模式，应用您的更改，并将您的 QA 框指向该数据库。如果它按预期工作，您可以针对您的主生产数据库运行补丁。如果没有，请调出快照，并再次从主服务器复制它，直到您准备好重复更新测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T20:22:05.377

一旦我部署了我的数据库，对我的开发数据库所做的任何更改都在 SQL 脚本（不是工具）中完成，并且脚本被保存并编号。

```
deploy.001.description.sql
deploy.002.description.sql
deploy.003.description.sql
... etc.. 
```

然后我在部署时按顺序运行每个脚本。

然后我将它们归档到一个名为的目录中

```
\deploy.YYMMDD\ 
```

并重新开始。

如果我犯了错误，我永远不会回到以前的部署脚本，我会创建一个新脚本并将我的修复放在那里。

祝你好运

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-07T04:28:42.223

我也有同样的困境。我一直认为`production db`vs之间有明显的二分法`development db`。即它们是硬币的两个面，永远不会相遇。

当我停止让我的应用程序按照“*非此即彼”的方式“* `production db` *思考* `development db`”时，很多问题都消失了。相反，我的应用程序使用`local db`.

当它在我的虚拟（开发）机器上运行时，该本地数据库恰好是`dev db`. 我的应用程序并不真正“知道”这一点。

因此，对于主要部分，问题消失了。

但有时我想使用实时数据运行测试，或者将数据从代码移动到实时生产数据库并快速查看结果。

这是我添加`live-read-only db connection`. 应用程序对此进行了不同的处理。这有点像您的应用程序如何对待像 Google Apps 这样的网络服务。它是“您的应用程序使用的一些外部资源”。

默认情况下，我的应用程序使用`local db`and 在一些非常特殊的条件下（在测试套件中）它还使用`live-readonly db`. （因为它是一个只读连接，所以我不担心在测试期间弄乱实时数据）。

因此，我的应用程序没有问“OR”这个问题，而是问*“* OR `dev db` *”* 。`production db``local db` *`live-read-only db`*

 *显然我的情况可能与你的不同，但我发现这种“理解上的突破”对我最有帮助。

# c# - C# 泛型和方法

> ID：299987
> 
> 赞同：0
> 
> 时间：2008-11-18T20:16:57.027
> 
> 标签：c#, .net, generics, .net-2.0, c#-2.0

我怎样才能选择好的方法（我在下面的示例中显示了 2 种不同的方式不起作用）。我使用而不是带有 IF 和 IS 的 Object 类型的变量来完成这项工作，但我试图避免使用 Object 和装箱/拆箱。所以我认为 Generic 可以完成这项工作，但我被困在这里。

这是说明我的问题的一小段代码：

```
class Program
{
    static void Main(string[] args)
    {
        Parser p = new Parser();
        ObjectType1 o1 = new ObjectType1();
        p.execute(o1);
        Console.Read();
    }
}

class Parser
{
    public T execute<T>(T obj)
    {
        /*
        if (obj is ObjectType1)
            this.action((ObjectType1)obj);
        else if (obj is ObjectType2)
            this.action((ObjectType2)obj);
        */
        this.action(obj);
        return obj;
    }

    private void action(ObjectType1 objectType1)
    {
        Console.WriteLine("1");
    }

    private void action(ObjectType2 objectType2)
    {
        Console.WriteLine("2");
    }
}

class ObjectType1
{
}

class ObjectType2
{
} 
```

## 更新

我不想要接口和类。对不起。我知道这不是问题的目标。

使用 (ObjectType)obj 进行投射不起作用，但如果你这样做：

```
 if (obj is ObjectType1)
            this.action(obj as ObjectType1);
        else if (obj is ObjectType2)
            this.action(obj as ObjectType1); 
```

它有效......为什么？

而且...我不能为所有类型的执行方法重载，因为此方法来自接口。这就是为什么所有都需要从这个方法中调用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T20:22:44.207

不，你不能这样做。泛型不像 C++ 模板那样工作——泛型方法只编译一次。编译器可以用于重载决策的唯一信息是它在泛型方法中知道的信息，而不管什么代码使用它。

作为展示这一点的示例，这里有一些代码可能无法按照您的预期工作：

```
using System;

class Test
{    
    static void Main()
    {
        string x = "hello";
        string y = string.Copy(x);

        Console.WriteLine(x==y); // Overload used
        Compare(x, y);
    }

    static void Compare<T>(T x, T y) where T : class
    {
        Console.WriteLine(x == y); // Reference comparison
    }
} 
```

如果不知道更多关于你想要做什么，很难说出最好的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T20:26:18.550

你考虑过接口吗？

```
interface IAction
{
   void action();
}

class ObjectType1 : IAction
{
   void action() {
      Console.WriteLine("1");
   }
}

class ObjectType2 : IAction
{
    void action() {
      Console.WriteLine("2");
    }
}

class Parser
{
   public IAction execute(IAction obj)
   {
      obj.action();
      return obj;
   }
} 
```

### 由OP编辑：

此解决方案需要更改所有业务逻辑对象以具有此接口。这真的不是一件事情（在我的情况下）。而且，在其他情况下，我总是更喜欢干净的 BusinessObject 没有与业务无关的接口。在我的问题中，我想要一个与 Generic/Object/Delegate 方法更相关的解决方案来实现它。谢谢你。这个答案不会被接受。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T20:22:57.623

我没试过，但你能做到吗？

 ~~~~```
public T execute<T>(T obj)
{
    this.action((T)obj);
    return obj;
} 
```~~  ~~（根据评论，不起作用）

或者

```
public T execute<T>(T obj)
{
    this.action(obj as T);
    return obj;
} 
```

（根据评论，作品）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T20:40:28.227

> Parser 类有很多私有方法，这些私有方法由 execute 方法调用，具体取决于对象类型。它需要重定向到好的方法。

编译器将为您完成这项工作。只需使用重载。

```
class Parser
{
    public ObjectType1 action(ObjectType1 objectType1)
    {
        Console.WriteLine("1");
        return objectType1;
    }
    public ObjectType2 action(ObjectType2 objectType2)
    {
        Console.WriteLine("2");
        return objectType2;
    }
}

class ObjectType1 { }
struct ObjectType2 { } 
```

然后，调用：

```
Parser p = new Parser();
p.action(new ObjectType1());
p.action(new ObjectType2()); 
```

没有装箱/拆箱，并且调用了适当的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T20:54:26.700

我知道您担心装箱/拆箱，因此这里可能涉及 ValueTypes。

```
public T execute<T>(T obj)   
{        
    this.action(obj);
    return obj;
} 
```

假设该操作正在修改 obj，并且还假设*该修改对调用者很重要*（这就是您将值返回给调用者的原因）。此代码有一个令人讨厌的按值传递缺陷。

考虑这段代码：

```
 public int execute(int obj)   
    {        
        this.action(obj);
        return obj;
    }

    public void action(int obj)
    {
        obj = obj + 1;
    } 
```

以这种方式调用。

```
int x = p.execute(1); 
```

x 是 1，而不是 2。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T20:33:00.550

IIRC你可以使用“where”子句来允许这个

```
public T execute<T>(T obj) where : /* somthing */
{
} 
```

我总是要自己去谷歌那个，所以我会留在那里。

编辑：阅读一些评论。我不建议调用类型特定的代码。而是将该代码放在虚拟函数中并调用它。调用签名可能会很长，但这就是自动完成的目的。

[Koodos 到 joshua.ewer 查找手册页](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T21:05:14.603

泛型发生在编译时。当您希望将相同的代码应用于不同的类型时，最好使用它。它不是动态的，因此它不会帮助您根据输入类型在方法之间切换。

David B 的回复中的重载解析有效，但也发生在编译期间。

更新中的代码做同样的事情。它强制转换（在仔细检查类型之后），然后使用重载来解析该方法。

我觉得您想根据运行时输入切换方法。

如果您使用反射，您可以获得更动态的行为。

```
 public object execute(object obj) 
        {
            MethodInfo m = typeof(Parser).GetMethod(
                "action", 
                BindingFlags.Instance | BindingFlags.NonPublic, 
                null, 
                new Type[] { obj.GetType() }, 
                null);
            m.Invoke(this, new object[] { obj });
            return obj; 
        } 
```

它可能有点脆弱，但它在示例中有效。

# svn - 托管颠覆建议或建议

> ID：299990
> 
> 赞同：3
> 
> 时间：2008-11-18T20:17:46.197
> 
> 标签：svn, hosting, saas

我正在研究将托管颠覆用于工作中的新项目，并且想知道是否有人有任何经验可以分享。

我个人在家里将[Beanstalk用于小型项目，但没有用于多个用户或大型存储库。](http://www.beanstalkapp.com/)

你用过什么/谁？

适用于什么规模/类型的项目？

你的经历是什么？（正常运行时间、性能、客户服务等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T20:26:46.460

wush.net 非常棒 - 很好的支持 我将它用于个人项目以及两个自由项目（一个有几十万行代码） 没有大量的开发人员，但这应该不是问题

svnrepository 也不错 - 但手握要少得多。我切换到 wush 只是因为我不想做太多的管理工作——主要是为了 trac 的东西。他们也有很好的支持，但你要负责更多的管理员。

我没有经历过任何我注意到的停机时间。（对于 svn 或 trac）

[https://stackoverflow.com/questions/297153/can-you-recommend-a-svn-closed-source-project-hosting-site#297180](https://stackoverflow.com/questions/297153/can-you-recommend-a-svn-closed-source-project-hosting-site#297180)

还有关于这个主题
的其他 SO 问题......搜索 svn 和托管应该会提出这些问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T21:07:01.370

看看[Unfuddle](http://unfuddle.com) .... 他们有一个免费的计划加上其他一些不错的项目管理类型的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T00:59:15.037

我使用 DreamHost 是因为我真的不喜欢“仅限颠覆”主机所施加的限制，例如非常小的空间或很少的存储库。

我希望能够检查与构建相关的所有内容，而不必考虑空间限制。

它很便宜（每月 10 美元）并且几乎无限的磁盘空间（以及无限的用户和存储库）。没有经历过任何停机时间，但有时有点慢。

唯一的缺点是他们有 subversion v. 1.4.2，而我没有取得很大的成功升级。但是有 Linux 经验的人可能很快就能做到 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T20:21:34.147

如果您的项目是开源的，您可能需要考虑使用 Google Code。

我发现它很棒！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T20:22:14.223

我在小型个人项目中使用[wush.net](http://www.wush.net)一段时间，从未遇到任何问题……服务可靠且快速。一旦我将我的网络托管移动到也支持 svn 的提供商，我就在那里终止了我的帐户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-03T22:40:07.450

我同意[mikeymo](https://stackoverflow.com/users/4398/mikeymo) [Unfuddle](http://unfuddle.com)是一个很棒的票务和颠覆主机。他们有一个免费帐户，我已经使用了将近一年，而且非常棒。它需要大量的开发工作，尤其是在处理任务和相关提交时。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-27T17:54:23.903

您始终可以在云中使用 Subversion 和 VisualSVN Server 部署您自己的版本控制服务器。您需要在 MS Azure 或 AWS 中使用基于 Windows 的虚拟机。

安装过程非常简单，您将获得一个强大的托管版本控制服务器。有关安装说明，请参阅[入门指南](https://www.visualsvn.com/visualsvn/getting-started/)。

# sharepoint - 如何创建并要求完成几个任务的子集 Workflow Foundation？

> ID：299991
> 
> 赞同：1
> 
> 时间：2008-11-18T20:18:12.640
> 
> 标签：sharepoint, workflow, workflow-foundation

我有一个流程，需要四五个人中的任何两个人的批准。我想创建一个分配给每个人的任务，在其中两个任务完成后，删除剩余的任务并继续工作流程。

有没有办法用一个`CreateTask`活动创建多个任务？另外，我对 WorkFlow 还是很陌生，所以如果我将它们存储`TaskIDs`在一个数组中，我可以遍历它们以在事后删除剩余的任务吗？

或者我会以完全错误的方式解决这个问题？我愿意接受建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T21:42:17.710

我不确定它们是否适用于 Sharepoint，但请查看 Matt Winkler 的这些帖子：

*   [WF 的不同执行模式（或者，超越顺序和状态机）](http://blogs.msdn.com/mwinkle/archive/2007/05/24/different-execution-patterns-with-wf-or-going-beyond-sequential-and-state-machine.aspx)
*   [在 WF 中实现 N of M 模式](http://blogs.msdn.com/mwinkle/archive/2007/06/27/implementing-the-n-of-m-pattern-in-wf.aspx)

我认为第二篇文章准确地描述了你的情况。

# silverlight - Expression Blend 2 中 Silverlight 控件的设计时渲染

> ID：299992
> 
> 赞同：2
> 
> 时间：2008-11-18T20:18:34.557
> 
> 标签：silverlight, expression-blend, blend, expression-blend-2

我正在研究一些 Silverlight 控件，我想明确处理它们在 Blend 中的显示方式。具体来说，这些控件具有在运行时初始化的依赖项，因此会在设计器中引发异常。但即使没有例外，我也想让它们在 Blend 中以某种方式出现。

我知道 WPF 可以做到这一点（使用 myassembly.VisualStudio.Design.dll），但我无法找到有关使用 Silverlight 执行此操作的信息。

我已经看到[这里](http://blogs.msdn.com/expression/archive/2008/10/27/simulating-sample-data-in-blend-2-sp1.aspx)描述的黑客检查这样做：

```
bool designTime = (System.Windows.Browser.HtmlPage.IsEnabled == false); 
```

不过，我更喜欢更明确的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T21:16:09.793

这里有一篇关于[如何处理设计时可扩展性](http://silverlight.net/blogs/justinangel/archive/2008/11/17/silverlight-design-time-extensibility.aspx)的非常详细的帖子。在那里，您将了解如何为 Silverlight 执行 Visual Studio 和 Blend 设计时的工作。

> 控件供应商和编写自定义控件的人经常发现自己希望能够为自定义控件提供更好的体验。然而，关于这个话题的公开信息非常缺乏。我决定用这篇 50 多页的短文来纠正这种情况。

就像我说的，它很长。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T04:51:58.337

要检查的具体属性是`DesignerProperties`：

```
using System.ComponentModel.DesignerProperties

if (DesignerProperties.GetIsInDesignMode(this))
{
} 
```

其中`this`是一个`DependencyObject`（任何视觉元素）。

# java - 实例化类型参数的对象

> ID：299998
> 
> 赞同：104
> 
> 时间：2008-11-18T20:20:05.990
> 
> 标签：java, generics, reflection

我有一个模板类如下：

```
class MyClass<T>
{
    T field;
    public void myMethod()
    {
       field = new T(); // gives compiler error
    }
} 
```

如何在我的班级中创建 T 的新实例？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2008-11-18T20:24:09.210

在类型擦除之后，所知道`T`的只是它是`Object`. 您需要指定一些工厂来创建`T`.

一种方法可以使用[`Supplier<T>`](http://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html)：

```
class MyClass<T> {

  private final Supplier<? extends T> ctor;

  private T field;

  MyClass(Supplier<? extends T> ctor) {
    this.ctor = Objects.requireNonNull(ctor);
  }

  public void myMethod() {
    field = ctor.get();
  }

} 
```

用法可能如下所示：

```
MyClass<StringBuilder> it = new MyClass<>(StringBuilder::new); 
```

或者，您可以提供一个`Class<T>`对象，然后使用反射。

```
class MyClass<T> {

  private final Constructor<? extends T> ctor;

  private T field;

  MyClass(Class<? extends T> impl) throws NoSuchMethodException {
    this.ctor = impl.getConstructor();
  }

  public void myMethod() throws Exception {
    field = ctor.newInstance();
  }

} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-19T22:05:01.503

另一种非反射方法是使用混合的构建器/抽象工厂模式。

在 Effective Java 中，Joshua Bloch 详细介绍了 Builder 模式，并提倡通用的 Builder 接口：

```
public interface Builder<T> {
  public T build();
} 
```

具体的builder可以实现这个接口，外部类可以根据需要使用concretebuilder来配置Builder。构建器可以作为`Builder<T>`.

使用此模式，您可以获得 的新实例`T`，即使`T`具有构造函数参数或需要额外配置。当然，您需要一些方法将 Builder 传递给 MyClass。如果你不能将任何东西传递给 MyClass，那么 Builder 和 Abstract Factory 就不行了。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-18T23:20:37.327

这可能比您正在寻找的更重量级，但它也可以工作。请注意，如果您采用这种方法，则在构造时将工厂注入 MyClass 而不是在每次调用时将其传递给您的方法会更有意义。

```
interface MyFactory<T> 
{
    T newObject();
}

class MyClass<T> 
{
    T field;
    public void myMethod(MyFactory<T> factory)
    {
       field = factory.newObject()
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T20:50:18.533

如果您愿意子类化，您也可以避免擦除，请查看 [http://www.artima.com/weblogs/viewpost.jsp?thread=208860](http://www.artima.com/weblogs/viewpost.jsp?thread=208860)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-23T22:12:02.043

`T`您可以在不传递任何参数的情况下获取类型的类对象。

试试这个。

```
static class MyClass<T> {
    Class<?> clazz;

    @SafeVarargs
    public MyClass(T... dummy) {
        if (dummy.length > 0)
            throw new IllegalArgumentException("Do not specify arguments");
        clazz = dummy.getClass().componentType();
    }

    @Override
    public String toString() {
        return "MyClass<T = " + clazz.getName() + ">";
    }
}

public static void main(String[] args) {
    MyClass<String> s = new MyClass<>();
    System.out.println(s);
    Object i = new MyClass<Integer>();
    System.out.println(i);
} 
```

输出：

```
MyClass<T = java.lang.String>
MyClass<T = java.lang.Integer> 
```

`T`您可以像这样实例化类型参数的对象。

```
clazz.getConstructor().newInstance(); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-12-17T04:34:34.900

一种选择是使用 Object 进行投射

```
{field = (T) new Object();} 
```

field 最初将是 Object 类型，但随后将转换为 T 类型。这是一个丑陋的，因为将转换为零是对象初始化的目标。但我认为这会奏效。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2017-11-18T10:22:12.463

类 classOfT

```
 try {
            t = classOfT.newInstance();//new T(); NOTE: type parameter T cannot be instantiated directly
        } catch (Exception e) {
            e.printStackTrace();
        } 
```

# ruby-on-rails - 在 rails 中使用 MIME 类型渲染文件

> ID：299999
> 
> 赞同：17
> 
> 时间：2008-11-18T20:20:30.623
> 
> 标签：ruby-on-rails, ruby, render, mime-types

这是代码：

```
render :file => @somedir + "/blah.xml" 
```

...但是当我签入 FireBug 时，生成的 MIME 类型是 text/html。在这种情况下如何指定 MIME 类型？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-18T21:48:36.590

实际上有两种方法可以设置内容类型（我认为这就是你所说的 mime 类型）。如果它适用于您的 Rails 版本，您应该使用第二个选项。

```
class FileController < ApplicationController

  def index
    filename = 'some.xml'

    extname = File.extname(filename)[1..-1]
    mime_type = Mime::Type.lookup_by_extension(extname)
    content_type = mime_type.to_s unless mime_type.nil?

    # 1
    #headers['Content-Type'] = content_type
    #render :file => filename

    # 2
    render :file => filename, :content_type => content_type
  end

end 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-07-09T11:04:14.683

```
render :file => @somedir + "/blah.xml", :content_type => Mime::XML 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T21:48:54.080

关于什么

```
headers["Content-Type"] = "text/xml" 
```

? 希望有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T20:33:45.120

看看[这里](http://api.rubyonrails.org/classes/Mime/Type.html)。基本上你需要使用 render :xml => blah.to_xml

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-16T05:37:19.853

根据[http://api.rubyonrails.org/classes/Mime/Type.html](http://api.rubyonrails.org/classes/Mime/Type.html)，您可以像这样指定它：

```
render file: @somedir + "/blah.xml", mime_type: Mime::Type.lookup("text/xml") 
```~~~~***********