# StackOverflow 问答 10490000-10490999

# javascript - Jquery淡入文本一段时间

> ID：10490006
> 
> 赞同：2
> 
> 时间：2012-05-07T22:29:00.477
> 
> 标签：javascript, jquery, html

在我的应用程序中，我有一个脚本可以告诉某人何时上线或下线。`content = name+' went offline'`我输入了是否有人通过或反之亦然上线/下线的文本。然后，我在函数调用结束时将该文本放入 div 中：`$('#new').text(content);`

问题在于淡出，总而言之，它并没有真正起作用。我一直在尝试玩弄它。这是我到目前为止所拥有的：

```
$('#new').text(content);
$('#new').fadeIn('slow', function() {
        setTimeout($('#new').fadeOut('slow', function() {
        $('#new').css('display', 'none');   
        }));
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:34:08.280

`display:none`内部回调是不必要的，`fadeOut()`结束后自动将显示设置为无。

```
$('#new').text(content);
$('#new').fadeIn('slow', function() {
    setTimeout("$('#new').fadeOut('slow');", 2000);
}); 
```

2000 是您想要延迟的毫秒数，将其更改为更适合您的值。

正如@Pst 评论的那样，即使我个人对函数对象的问题多于代码字符串，函数对象也可能更加一致。

您也可以使用函数对象：

```
$('#new').text(content);
$('#new').fadeIn('slow', function() {
    setTimeout(function(){ $('#new').fadeOut('slow'); }, 2000);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:34:29.393

您需要记住提供`setTimeout`在采取行动之前应该等待的持续时间。

```
$("#hello")
  .text(content)
  .fadeIn("slow", function(){
    setTimeout(function(){
      $("#hello").fadeOut();
    }, 2000);
  }); 
```

2000 表示 2 秒。如果您希望它保持可见更长时间，请增加此值。

功能演示：http: [//jsbin.com/aciwon/edit#javascript,html](http://jsbin.com/aciwon/edit#javascript,html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T22:38:27.753

你在里面用这个`$(document).ready()`吗？如果没有，请将其放置为：

```
$(document).ready(function() {
    $('#new')
        .text(content)
        .fadeIn('slow', function() { 
            setTimeout(function() { $('#new').fadeOut('slow'); }, 2000); 
        });
}); 
```

此外，请务必使用 a 初始化您的元素，`display: none`并注意我已删除部分不必要的代码。

你的`setTimeout()`代码是错误的，你必须向它传递一个函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T23:00:31.703

为什么不只使用[延迟](http://api.jquery.com/delay/ "延迟")？

```
$("#new").text(content).fadeIn("slow").delay(1000).fadeOut("slow"); 
```

# http - 未在 http 响应标头中设置“缓存控制”的后果是什么？

> ID：10490012
> 
> 赞同：1
> 
> 时间：2012-05-07T22:29:31.877
> 
> 标签：http, cache-control, http-caching

比如说，我的 Web 应用程序响应一个 http 请求，其响应头中没有“缓存控制”。如果客户端在较短的时间内提交相同的请求，会发生什么？是否使用了响应的缓存副本，因此请求不需要到达服务器？还是像第一次一样将请求发送到服务器？

如果答案是“取决于”，请说明依赖项是什么。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:46:40.337

HTTP/1.1 协议中没有为没有缓存相关标头的资源定义缓存行为，因此这实际上取决于 HTTP 客户端的实现。

这是[RFC](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html)的链接。

# java - 添加 ActionListener 的方法

> ID：10490014
> 
> 赞同：4
> 
> 时间：2012-05-07T22:29:40.867
> 
> 标签：java, swing, actionlistener

假设我有一个名为 button1 的按钮。如果我想为按钮创建一个actionListener，我应该选择哪种方法：（在第二个中，你必须扩展actionListener接口）

```
// Imports
public class Test{
    JButton test = new JButton();
    Test(){
        // Pretend there is an adapter
        test.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e){
                ...
            }
        });
    ...
} 
```

或者

```
// Imports
public class Test2 extends ActionListener{
    JButton button2 = new JButton();
    Test2(){
        button2.addActionListener(this);
    }
    // Pretend there is an adapter

    public void actionPerformed(ActionEvent e){
        Object src = e.getSource();
        if(src == button2){
            ...
        }else{
            ...
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:35:22.683

去第一个。您不应该让您的 GUI 类也实现您的侦听器，因为这要求 GUI 或视图类做太多事情。通过分离您的侦听器代码，即使它位于匿名侦听器类中，以后如果您想将侦听器代码与视图代码完全分离，您也会有更轻松的时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T22:36:46.897

在第二种情况下，您必须*实现*`ActionListener`接口。除此之外，答案是“视情况而定”。如果为多个图形组件重用相同的动作监听器是有意义的，那么使用第二个版本。如果处理事件是单个组件的一次性事件，则使用第一个版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T22:40:07.003

如果每个侦听器都是唯一的，您可能希望使用匿名类（第一个示例）。如果您不得不一遍又一遍地重写相同的代码，那么在命名类中实现它（如在您的第二个示例中）会更好，这样您就可以重用相同的侦听器。

但是，与其扩展 ActionListener（如第二个示例中那样），您可能会发现将侦听器实现放入不同的类（甚至是实现 ActionListener 的内部类）可以更好地逻辑分离您的代码。

# python - 在 Mac 上编写脚本以自动创建项目文件夹结构和 Mercurial 存储库/子存储库克隆

> ID：10490018
> 
> 赞同：0
> 
> 时间：2012-05-07T22:30:14.403
> 
> 标签：python, macos, bash, mercurial, automator

我经常（每周不止一次）在我的开发机器（Mac）上创建新的“项目”。我正在尝试简化工作流程并自动化我现在手动执行的操作：

1.  创建一个项目文件夹结构（我有一个我复制的模板目录结构）
2.  将样板源代码基线克隆（Mercurial）到新创建的文件夹结构中
3.  克隆另一个（Mercurial）存储库作为上述基线存储库的子存储库
4.  修改 .hgsub 配置文件 (Mercurial) 以设置子存储库
5.  修改 hgrc 配置文件 (Mercurial) 以设置默认推送文件夹
6.  做一个初始提交（Mercurial）
7.  在我的 bash_profile 中创建一系列别名

编写上述工作流程的最佳（或最简单）方法是什么？我想传递几个参数，例如项目名称和子存储库名称等。

这是我可以在 shell 脚本中轻松实现的吗？自动机？Python脚本？

谢谢。

普雷姆博。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T03:12:14.150

> 手动工作流程中的步骤可以完全变成 shell 脚本中的步骤。一个区别是您可以使用 sed 来修改文件，而不是在编辑器中打开它们。您将使用位置参数或 getopts 来传递您的参数。有关这些信息，请参阅 man bash。然后回来问具体的重点问题。
> 
> ——丹尼斯威廉姆森

# algorithm - 最大值调度算法

> ID：10490021
> 
> 赞同：3
> 
> 时间：2012-05-07T22:30:19.157
> 
> 标签：algorithm, scheduling, time-complexity

我有一个项目清单，每个项目都需要**两天时间**才能完成，并且有一个截止日期。设**P[i].id、P[i].duedate、p[i].value**分别为项目的id、项目的截止日期、按时完成项目获得的价值(on或截止日期前）

**编写**一个算法，将数组 A 作为输入，并返回您将执行哪些项目以及何时执行的时间表，以最大化您获得的价值。该算法的输出是一个数组 B，其中 B[i] 是您将在第 i 天工作的项目的 ID，i>= 1。

在特定日期不超过一个项目，除非您在截止日期前完成，否则您不会获得项目的价值，今天是第 0 天，您将从第 1 天开始处理项目（截止日期是一个整数），例如，如果一个项目的截止日期是 5，您可以选择在第 3 天和第 5 天工作）

**1-编写算法。2-证明算法是最优的？3-算法的时间复杂度是多少？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:47:45.517

如果所有值都相同，这很简单，通过选择尽可能少的截止日期的贪婪方法效果很好。

当值不同时，您可以使用类似的方法，但这次是通过动态编程（我假设您的截止日期是离散的）。

创建一个大小`Max{due date}`命名为的数组`V`，该数组保存在特定时间可以获得的最大可能值，并为每个值创建另一个数组`V`以保存相关的选定任务`V[i]`，现在您可以选择以下 DP：

> V[0] = 0, V[1] = max{value_x [1] , V[i] = Max {V[i-2] + value_x [i] , V[i-1]}

这里 value_x [i]表示到期日期等于或小于 的最大值任务`i`，此外，在更新 V[i] 选择之后，此任务不应该在 V[i-2] 选择中。

最后我会留给你完成你的作业，找出这个算法的顺序和它的正确性，你也可以提高内存使用率。

# java - 休眠错误：org.xml.sax.SAXParseException：必须声明元素类型“休眠映射”

> ID：10490024
> 
> 赞同：1
> 
> 时间：2012-05-07T22:30:27.540
> 
> 标签：java, hibernate

我正在使用hibernate-core-4.1.3.Final.jar。将数据插入表中时，出现以下错误：

`org.xml.sax.SAXParseException: Element type "hibernate-mapping" must be declared.`

我的映射文件如下：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
 "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated May 7, 2012 3:07:47 PM by Hibernate Tools 3.4.0.CR1 -->
<hibernate-mapping>
<class name="com.paypal.socialpay.models.User" table="user" catalog="socialdb">
    <id name="id" type="java.lang.Integer">
        <column name="id" />
        <generator class="identity" />
    </id>
    <property name="payerid" type="string">
        <column name="payerid" length="50" not-null="true" />
    </property>
    <property name="emailid" type="string">
        <column name="emailid" length="100" not-null="true" />
    </property>
    <property name="createdDt" type="timestamp">
        <column name="created_dt" length="0" not-null="true" />
    </property>
    <property name="updatedDt" type="timestamp">
        <column name="updated_dt" length="0" not-null="true" />
    </property>
    <property name="firstname" type="string">
        <column name="firstname" length="100" />
    </property>
    <property name="lastname" type="string">
        <column name="lastname" length="100" />
    </property>
    <property name="correlationid" type="string">
        <column name="correlationid" length="100" />
    </property>
</class>
</hibernate-mapping> 
```

错误的堆栈跟踪是：

```
org.xml.sax.SAXParseException: Element type "hibernate-mapping" must be declared.
    at org.apache.xerces.framework.XMLParser.reportError(XMLParser.java:1213)
    at org.apache.xerces.validators.common.XMLValidator.reportRecoverableXMLError(XMLValidator.java:1807)
    at org.apache.xerces.validators.common.XMLValidator.validateElementAndAttributes(XMLValidator.java:3633)
    at org.apache.xerces.validators.common.XMLValidator.callStartElement(XMLValidator.java:1229)
    at org.apache.xerces.framework.XMLDocumentScanner$ContentDispatcher.dispatch(XMLDocumentScanner.java:938)
    at org.apache.xerces.framework.XMLDocumentScanner.parseSome(XMLDocumentScanner.java:381)
    at org.apache.xerces.framework.XMLParser.parse(XMLParser.java:1098)
    at org.dom4j.io.SAXReader.read(SAXReader.java:465)
    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:78)
    at org.hibernate.cfg.Configuration.add(Configuration.java:478)
    at org.hibernate.cfg.Configuration.add(Configuration.java:474)
    at org.hibernate.cfg.Configuration.add(Configuration.java:647)
    at org.hibernate.cfg.Configuration.addResource(Configuration.java:730)
    at org.hibernate.cfg.Configuration.parseMappingElement(Configuration.java:2109)
    at org.hibernate.cfg.Configuration.parseSessionFactory(Configuration.java:2081)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2061)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2014)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1929)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1908)
    at com.paypal.utils.HibernateUtil.<clinit>(HibernateUtil.java:12)
    at com.paypal.utils.UserService.findUserByEmail(UserService.java:29)
    at com.paypal.socialpay.controllers.APIController.doGetAuthDetails(APIController.java:257)
    at com.paypal.socialpay.controllers.APIController.handleRequest(APIController.java:73)
    at com.paypal.socialpay.controllers.APIController.doPost(APIController.java:55)
    at com.paypal.socialpay.controllers.APIController.doGet(APIController.java:49)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T18:38:20.740

正如 Rags 所提到的，您必须在 CLASSPATH 中包含适当的休眠 jar。

有关更多详细信息，请参阅： [http ://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html_single/#tutorial-firstapp-mapping](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html_single/#tutorial-firstapp-mapping)

```
Hibernate will not load the DTD file from the web, but first look it up from the classpath of 
the application. The DTD file is included in hibernate-core.jar (it is also included in the 
hibernate3.jar, if using the distribution bundle). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T11:35:24.947

`<hibernate-mapping>`如果起始标记之前的标头中有任何非法字符，则可能会发生此行为。这甚至可以是不可打印的字符。

发生这种情况的另一个原因是错误的字符编码。我的映射文件中的第一行始终是

```
<?xml version="1.0" encoding="utf-8"?> 
```

# javascript - Jquery将url作为变量打开并更改文本

> ID：10490025
> 
> 赞同：0
> 
> 时间：2012-05-07T22:30:32.673
> 
> 标签：javascript, jquery

我有这个：

```
<fieldset id="social_associations" class="">
    <a href="/social/login/twitter">Associate your account to twitter</a>
    <br>
    <a href="/social/login/facebook">Associate your account to facebook</a>
    <br>
</fieldset> 
```

而且我想要一个函数来跟踪这些链接中的 URL，但是这些 URL 是由脚本生成的，并且可能会根据用户的个人资料进行更改（如果用户已经关联了一个帐户，那么将出现的 URL 将改为“断开连接” 'login'），所以该函数必须采用链接中出现的任何内容，它不能被硬编码。我不想在单击时离开当前页面。当单击链接时，我想将文本从关联...更改为断开连接。一定很容易，但我不知道！

编辑：

我知道这个问题不清楚，所以我在这里改写了： [javascript on click change href and open in new window](https://stackoverflow.com/questions/10494835/javascript-on-click-change-href-and-open-in-new-window)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:41:13.927

要更改链接文本，我会这样做。至于问题的其余部分，我不确定我是否理解。

```
$( '#social_associations' )
     .on( 'click', 'a[href*="/login/"]', function(){
             // not sure what 'follow the URLs within these links' means, but do it here

               //then change the link text
             $( this ).text( $( this ).text().replace( /Associate/i, "disconnect" ) );            
         })
     .on( 'click', 'a[href*="/disconnect/"]', function(){
               // not sure what 'follow the URLs within these links' means, but do it here

               //then change the link text
               $( this ).text( $( this ).text().replace( /disconnect/i, "Associate" ) );
         }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:59:27.240

```
<script>
$(function(){
    $('#social_associations').each(function(){
        if(/this.href/.test(/login/i)){
            this.innerHTML = 'Login';
        }
        if(/this.href/.test(/disconnect/i)){
            this.innerHTML = 'Disconnect';
        }
    });
});
</script>
<fieldset id="social_associations" class="">
    <a href="/social/login/twitter">Associate your account to twitter</a>
    <br>
    <a href="/social/login/facebook">Associate your account to facebook</a>
    <br>
</fieldset> 
```

我不确定这是否是您想要的，所以请告诉我是否不是:)

# c++ - 从 python 访问 c++ 类

> ID：10490027
> 
> 赞同：1
> 
> 时间：2012-05-07T22:30:45.683
> 
> 标签：c++, python, cython

我在单个 .cpp 文件中有一个很大的 c++ 程序，它定义了很多类（相互依赖）并最终运行一个主函数。现在我只对在 python 中使用其中一个类感兴趣，特别是这个类的一种方法，它接受 5 个浮点数作为输入并输出一个浮点数。我试图找到最简单的方法来实现这一点。在 boost:python 没有成功之后（主要是因为安装问题），我来到了 Cython，它在当前版本中支持 C++。我可以成功运行 Cython 教程中给出的 Rectangle 示例，但我不知道如何继续并使其适应我不需要如此复杂的 .pyx 文件且没有 .h 的情况文件。有人可以用简单的话解释我应该在 setup.py 和 .pyx 文件中写什么，如果我的 .

```
...
class Nuclei {
public:
...
    double potential(float,float,float,float,float);
...
private:
...
};
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T08:17:05.903

如果您只想调用一个函数，[使用 C/C++ 扩展 Python](http://docs.python.org/extending/extending.html)可能是最简单的方法。[这个页面](http://docs.python.org/extending/building.html)提供了一个很好的例子。

该示例中的相关 setup.py 代码是

```
from distutils.core import setup, Extension

module1 = Extension('demo',
                    define_macros = [('MAJOR_VERSION', '1'),
                                     ('MINOR_VERSION', '0')],
                    include_dirs = ['/usr/local/include'],
                    libraries = ['tcl83'],
                    library_dirs = ['/usr/local/lib'],
                    sources = ['demo.c'])

setup (name = 'PackageName',
       version = '1.0',
       description = 'This is a demo package',
       author = 'Martin v. Loewis',
       author_email = 'martin@v.loewis.de',
       url = 'http://docs.python.org/extending/building',
       long_description = '''
This is really just a demo package.
''',
       ext_modules = [module1]) 
```

如果您要调用的 C++ 代码在 中`demo.c`，则可以`import demo`在 Python 中使用 with。

请注意，这并不是那么简单——您将创建一个函数，该函数接受一个带有参数的 PyObject * 并返回一个 PyObject *，关于它们的构造方式可以说很多。看看上面链接的页面——它们充满了例子。

# jsf - JSF1064：无法找到或提供资源，jquery.js Tomcat 7 + RichFaces 4

> ID：10490028
> 
> 赞同：0
> 
> 时间：2012-05-07T22:30:51.340
> 
> 标签：jsf, richfaces, windows-server-2008, tomcat7

我一直在使用 RichFaces 4 和 Tomcat 7。清理和构建应用程序 (NetBeans) 时没有错误。部署应用程序后，一切正常，但有时会引发以下异常，我不知道错误在哪里或可能是什么：

这是 Tomcat 的 catalina.log 的堆栈跟踪

```
may 07, 2012 3:36:43 PM com.sun.faces.application.resource.ResourceHandlerImpl logMissingResource
WARNING: JSF1064: Unable to find or serve resource, jquery.js.
may 07, 2012 3:36:43 PM com.sun.faces.application.resource.ResourceHandlerImpl logMissingResource
WARNING: 
ClientAbortException:  java.io.IOException
    at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:373)
    at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:437)
    at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:351)
    at org.apache.catalina.connector.OutputBuffer.writeBytes(OutputBuffer.java:396)
    at org.apache.catalina.connector.OutputBuffer.write(OutputBuffer.java:385)
    at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:93)
    at java.nio.channels.Channels$WritableByteChannelImpl.write(Channels.java:458)
    at com.sun.faces.application.resource.ResourceHandlerImpl.handleResourceRequest(ResourceHandlerImpl.java:283)
    at org.richfaces.resource.ResourceHandlerImpl.handleResourceRequest(ResourceHandlerImpl.java:257)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:591)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:964)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
    at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1824)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.io.IOException
    at org.apache.coyote.http11.InternalAprOutputBuffer.flushBuffer(InternalAprOutputBuffer.java:205)
    at org.apache.coyote.http11.InternalAprOutputBuffer.access$100(InternalAprOutputBuffer.java:37)
    at org.apache.coyote.http11.InternalAprOutputBuffer$SocketOutputBuffer.doWrite(InternalAprOutputBuffer.java:235)
    at org.apache.coyote.http11.filters.ChunkedOutputFilter.doWrite(ChunkedOutputFilter.java:119)
    at org.apache.coyote.http11.AbstractOutputBuffer.doWrite(AbstractOutputBuffer.java:192)
    at org.apache.coyote.Response.doWrite(Response.java:533)
    at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:368)
    ... 25 more 
```

有人可以给我一些关于在哪里或如何停止显示此警告/异常的想法吗？为什么会被抛出？

干杯，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T02:36:02.317

> ```
> ClientAbortException 
> ```

客户端已中止资源请求，因为最终用户在页面仍在加载时匆匆离开。或者因为最终用户在页面仍在加载时按下了*Esc 。*或者是因为在页面还在加载时，最终用户的 5 岁儿子用剪刀剪断了网线。或者是因为 PC 在页面仍在加载时被雷击着火了。等等。

这是不可预测的，也无法避免的。只是忽略他们。如有必要，通过记录器配置将它们从日志中隐藏。

# java - SOA中如何解耦数据库实体依赖？

> ID：10490033
> 
> 赞同：0
> 
> 时间：2012-05-07T22:31:13.500
> 
> 标签：java, database-design, soa

我有两个服务：TeacherService 和 PupilSerivce，它们共享同一个数据库。它们之间的关系是一对多的，即一位老师可以有很多学生，而每个学生只有一位老师。

```
CREATE TABLE `test`.`teacher` {
`id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT 'id',
`name` varchar(40),
PRIMARY KEY (`id`)
} ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `test`.`pupil` {
`id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT 'id',
`teacher_id` bigint unsigned NOT NULL COMMENT 'teacher id',
PRIMARY KEY (`id`),
CONSTRAINT `fk_teacher_id` FOREIGN KEY (`teacher_id`) REFERENCES `teacher`(`id`) ON DELETE CASCADE
} ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

你可以想象，我有两个实体 TeacherVO 和 PupilVO，它们在我的 Java 代码中表示数据库表。

问题是，TeacherService 和 PupilSerivce 都在单独的进程中运行并与消息通信，我不希望它们相互之间有任何编译依赖。然而，当添加一个新的学生时，该方法看起来像：

```
PupilService.addNewPupil(long teacherId) {
     if (isValidTeacher(teacherId) {
         // add the pupile
     }
} 
```

这需要 PupileService 了解 TeacherVO，因此它可以进行一些验证，但 TeacherVO 在 TeacherService 包中！

消除这种依赖的最佳实践是什么？

我想到了一些方法：

1.  创建一条 validateTeacher 消息，然后 PupilService 将此消息发送给 TeacherService 并等待响应。但是，如果我有进一步的要求，例如搜索有名字的老师，那么我必须创建另一条消息，最终导致消息爆炸。直接搜索数据库是一种更灵活、更高效的方式，但会引入依赖。

2.  如果teacher_id 无效，不要做任何检查和捕获由外键引起的SQL 异常。但是，这并不能解决我可能有进一步要求的问题。

我认为如果多个服务共享同一个数据库，这应该是 SOA 架构中的一个常见问题。我做了一段时间的研究，但没有得到任何有价值的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:55:26.147

我同意托尼霍普金森的观点，你试图做的事情根本上是不健全的。你不能把老师和学生的顾虑分开。

# matlab - matlab中两个数组的对矩阵

> ID：10490039
> 
> 赞同：0
> 
> 时间：2012-05-07T22:31:46.710
> 
> 标签：matlab, matrix, perceptron, neural-network

我有几个数组：

```
x = [0:pi/16:2*pi] 
y = [0:pi/16:2*pi] 
```

我想用这种方式制作一个矩阵 xy：

```
xY = [(0,0)      (0,pi/16)      ...     (0,2pi);
      (pi/16,0)  (pi/16,pi/16)  ...     (pi/16,2pi);
          :            :                     :
      (2pi,0)    (2pi,pi/16)    ...     (2pi,2pi)] 
```

我已经尝试过很多这样的事情：

```
for i=1:length(x)
    for j=1:length(y)
        xy{i,j} = [{x(i),y(j)}];
    end
end 
```

，但是我遇到了很多错误。

我知道这应该很容易，最大的问题是我的帖子标题（因此，我寻求帮助的方式）是错误的，所以我为此道歉。

我想我应该提到我正在尝试创建一个多层感知器，它将使用该矩阵和这个公式进行训练：

```
fxy = cos(x)-3*sin(y); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:54:20.380

最简单的方法是创建大小矩阵`length(x)`-by- `length(y)`-by- `2`：

```
 A = zeros(length(x), length(y), 2);
 for i = 1 : length(x); for j = 1 : length(y); A(i, j, :) = [x(i), y(j)]; end; end; 
```

在您的情况下，矩阵`A`将具有 size `33x33x2`。要使用索引获取对，请使用`i, j`以下代码：

```
 squeeze(A(i, j, :)) 
```

或者您可以调整代码以使用此类 3 维矩阵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:59:34.310

这正是[`meshgrid`](http://www.mathworks.com/help/techdoc/ref/meshgrid.html)设计的目的。

# javascript - 人力车图表的 onClick 选项

> ID：10490041
> 
> 赞同：15
> 
> 时间：2012-05-07T22:31:53.763
> 
> 标签：javascript, events, charts, onclick, rickshaw

我想知道是否真的对数据点上的 onclick 事件提供了开箱即用的支持，或者我必须修改库以使其工作。我扫描了源代码的某些部分，没有看到任何允许绑定自定义单击操作的内容。他们网站上的教程也没有显示此选项（[http://code.shutterstock.com/rickshaw/](http://code.shutterstock.com/rickshaw/)）。

任何帮助都是感激的。我目前正在 flot、rickshaw 和 flotr2 之间进行评估。到目前为止，它们都没有满足所有要求，我很惊讶除了 flot，在其他库中没有自定义 onClick 事件的选项。我看到有些人为 flotr2 添加了一些 hack-ish 方式，但它仅适用于条形图。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-07T14:52:39.987

这有点骇人听闻，但我有同样的要求。我已经连接了一个 HoverDetail 对象，所以我连接了 HoverDetail 对象的 onShow 事件来存储所选项目的 x 标签的值。

（这是在一个角度应用程序中，所以这就是我在范围内设置变量的原因）

```
var hoverDetail = new Rickshaw.Graph.HoverDetail({
    onShow: function(event){
        scope.data.activeDate = $(".x_label").text();
    },
    graph: graph
}); 
```

然后，我将正常的单击处理程序连接到图形，并访问存储在其中的 onShow 处理程序的变量。

有关如何使用 HoverDetail 对象和其他 Rickshaw 构造的更多信息，请查看此截屏视频：http: [//tagtree.tv/d3-with-rickshaw-and-angular](http://tagtree.tv/d3-with-rickshaw-and-angular)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-13T15:28:10.680

我从 HoverDetail 派生了这个，到目前为止它似乎有效：

```
Rickshaw.namespace('Rickshaw.Graph.ClickDetail');
Rickshaw.Graph.ClickDetail = Rickshaw.Class.create({

    initialize: function (args) {
        this.graph = args.graph;
        this.clickHandler = args.clickHandler || function(data){};
        this.lastEvent = null;
        this._addListeners();
    },

    update: function (e) {

        e = e || this.lastEvent;
        if (!e) return;
        this.lastEvent = e;

        if (!e.target.nodeName.match(/^(path|svg|rect|circle)$/)) return;

        var graph = this.graph;

        var eventX = e.offsetX || e.layerX;
        var eventY = e.offsetY || e.layerY;

        var j = 0;
        var points = [];
        var nearestPoint;
        var nearestValue;

        this.graph.series.active().forEach(function (series) {

            var data = this.graph.stackedData[j++];

            if (!data.length)
                return;

            var domainX = graph.x.invert(eventX);

            var domainIndexScale = d3.scale.linear()
                .domain([data[0].x, data.slice(-1)[0].x])
                .range([0, data.length - 1]);

            var approximateIndex = Math.round(domainIndexScale(domainX));
            if (approximateIndex == data.length - 1) approximateIndex--;

            var dataIndex = Math.min(approximateIndex || 0, data.length - 1);

            for (var i = approximateIndex; i < data.length - 1;) {

                if (!data[i] || !data[i + 1]) break;

                if (data[i].x <= domainX && data[i + 1].x > domainX) {
                    dataIndex = Math.abs(domainX - data[i].x) < Math.abs(domainX - data[i + 1].x) ? i : i + 1;
                    break;
                }

                if (data[i + 1].x <= domainX) {
                    i++
                } else {
                    i--
                }
            }

            if (dataIndex < 0) dataIndex = 0;
            var value = data[dataIndex];
            var distance = Math.sqrt(
                Math.pow(Math.abs(graph.x(value.x) - eventX), 2) +
                Math.pow(Math.abs(graph.y(value.y + value.y0) - eventY), 2)
            );

            if (!nearestPoint || distance < nearestPoint.distance) {
                nearestValue = value;
            }
        }, this);
        if(nearestValue){
            this.clickHandler(nearestValue);
        }
    },

    render: function (args) {
        // Do nothing
    },

    _addListeners: function () {
        this.graph.element.addEventListener(
            'click',
            function (e) {
                this.update(e);
            }.bind(this),
            false
        );
    }
}); 
```

像这样的用法：

```
 new Rickshaw.Graph.ClickDetail({
            graph: graph,
            clickHandler: function(value){
                alert(value.x + ' ' + value.y);
            }
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-01T20:11:42.563

你试过 HighCharts.js 吗？它是一个用于创建交互式图表和图形的 javascript 库。

[http://www.highcharts.com/](http://www.highcharts.com/)

您可以自定义 onclick 事件以在使用 HighCharts 时调用 javascript 函数。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-02-15T10:31:26.347

```
$('#chart').on('click', 'svg rect' ,function() {
        x = $(this)[0].__data__.x; //The value of x
        y = $(this)[0].__data__.y; //The value of y
        }); 
```

久经考验；）

# checkbox - 如何在 InnoSetup 向导页面中读取和设置复选框的值？

> ID：10490046
> 
> 赞同：10
> 
> 时间：2012-05-07T22:32:29.873
> 
> 标签：checkbox, inno-setup, pascalscript

我在 InnoSetup 脚本的“附加任务”页面中添加了一个复选框

```
[Tasks]
Name: "StartMenuEntry" ; Description: "Start my app when Windows starts" ; GroupDescription: "Windows Startup"; MinVersion: 4,4; 
```

我想在页面显示时初始化此复选框，并在单击按钮`wpSelectTasks`时读取值。`Next`我不知道如何访问复选框“选中”值。

```
function NextButtonClick(CurPageID: Integer): Boolean;

var
  SelectTasksPage : TWizardPage ;
  StartupCheckbox : TCheckbox ;

begin
Result := true ;
case CurPageID of

    wpSelectTasks :
        begin
        SelectTasksPage := PageFromID (wpSelectTasks) ;
        StartupCheckbox := TCheckbox (SelectTasksPage... { <== what goes here??? }
        StartupCheckboxState := StartupCheckbox.Checked ;
        end ;
    end ;    
end ; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-07T23:09:56.330

任务复选框实际上是[`WizardForm.TasksList`](http://www.jrsoftware.org/ishelp/topic_scriptclasses.htm#TNewCheckListBox)复选框中的项目。如果你知道它们的索引，你可以很容易地访问它们。请注意，可以对项目进行分组（这只是您的情况），并且每个新组还在该复选框中包含一个项目，因此对于您的情况，项目索引将为 1：

```
[Setup]
AppName=TasksList
AppVersion=1.0
DefaultDirName={pf}\TasksList

[Tasks]
Name: "TaskEntry"; Description: "Description"; GroupDescription: "Group";

[code]
function NextButtonClick(CurPageID: Integer): Boolean;
begin
  Result := True;
  if CurPageID = wpSelectTasks then
  begin
    if WizardForm.TasksList.Checked[1] then
      MsgBox('First task has been checked.', mbInformation, MB_OK)
    else
      MsgBox('First task has NOT been checked.', mbInformation, MB_OK);
  end;
end;

procedure CurPageChanged(CurPageID: Integer);
begin
  if CurPageID = wpSelectTasks then
    WizardForm.TasksList.Checked[1] := False;
end; 
```

下图说明了[`WizardForm.TasksList`](http://www.jrsoftware.org/ishelp/topic_scriptclasses.htm#TNewCheckListBox)当您有两个具有不同组的任务时，检查列表框的外观：

![在此处输入图像描述](../Images/07cafce592fc957526196484cdcb24e9.png)

要通过描述访问任务复选框，请尝试以下操作：

```
[Setup]
AppName=Task List
AppVersion=1.0
DefaultDirName={pf}\TasksList

[Tasks]
Name: "Task"; Description: "Task Description"; GroupDescription: "Group 1";

[code]
function NextButtonClick(CurPageID: Integer): Boolean;
var
  Index: Integer;
begin
  Result := True;
  if CurPageID = wpSelectTasks then
  begin
    Index := WizardForm.TasksList.Items.IndexOf('Task Description');
    if Index <> -1 then
    begin
      if WizardForm.TasksList.Checked[Index] then
        MsgBox('First task has been checked.', mbInformation, MB_OK)
      else
        MsgBox('First task has NOT been checked.', mbInformation, MB_OK);
    end;
  end;
end;

procedure CurPageChanged(CurPageID: Integer);
var
  Index: Integer;
begin
  if CurPageID = wpSelectTasks then
  begin
    Index := WizardForm.TasksList.Items.IndexOf('Task Description');
    if Index <> -1 then    
      WizardForm.TasksList.Checked[Index] := False;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-03T19:13:51.770

上面的答案很好。给了我我需要的东西。

我有一个案例，我有一堆辅助安装程序，我使用了“checkonce”选项，但如果文件夹丢失，我希望重新检查它们（例如，用户手动清除了安装文件夹），例如

```
[Tasks]
Name: "InstallPython" ; Description: "Install Python"     ; Flags: checkedonce
Name: "InstallNPP"    ; Description: "Install Notepad++"  ; Flags: checkedonce

[Code]
procedure CurPageChanged(CurPageID: Integer);
var
ItemIx: Integer;

begin
    if CurPageID = wpSelectTasks then begin
        if not DirExists(ExpandConstant('{app}')) then begin
            for ItemIx := 0 to (WizardForm.TasksList.Items.Count - 1) do
                WizardForm.TasksList.Checked[ItemIx] := True;
        end
    end
end; 
```

# android - 使用签名的密钥库反编译 apk

> ID：10490049
> 
> 赞同：1
> 
> 时间：2012-05-07T22:32:44.460
> 
> 标签：android

我和我的同事正在编写 Android 应用程序，我们正在使用 git 来跟踪代码更改。在我最后一次拉动之后，我更改了许多代码行并插入了很多新代码。

在尝试推动更改时，出现了一些冲突，我得到了他的项目版本，而我的却不见了。

“幸运的是”，我在我的手机上安装了最新版本的应用程序，并在我的电脑上使用了密钥库对其进行签名。

**有没有办法使用签名的密钥库来反编译 .apk 文件？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:43:55.910

实际上，没有。虽然可以反编译 apk，但该过程会产生一些丑陋的东西，以至于恢复它所花费的时间可能会令人望而却步。您可以使用 baksamali [（链接）](http://code.google.com/p/smali/)对其进行反汇编，以及将 .class 文件反编译为 Java 文件的类似工具。然而不幸的是，编译过程丢失了足够的上下文，您可能会丢失文件中的大量结构，并且如果不进行大量平滑处理，您获得的结果将无法使用。在这种情况下，虽然在*技术上*是可行的，但对生成的反编译代码进行逆向工程所需的时间将足够长，以至于您可能宁愿自己重做编码。

# ruby-on-rails - Postgres 有像 mysql 这样的本机连接池吗？

> ID：10490050
> 
> 赞同：1
> 
> 时间：2012-05-07T22:32:51.670
> 
> 标签：ruby-on-rails, postgresql, rails-postgresql

我问是因为在 Rails (config/database.yml) 中，您可以指定池大小。

Postgres 对此做了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:55:40.390

该池大小适用于 Rails postgresql 中内置的连接池，不附带连接池。如果您需要外部连接池，请搜索 pgbouncer 或 pgpool II

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T08:41:35.267

请记住，RoR 在事务池模式下无法与 pgpool/pgbouncer 一起正常工作 - [https://github.com/rails/rails/issues/1627](https://github.com/rails/rails/issues/1627)

# cookies - 如果没有 cookie，重新加载 iframe 的父级？

> ID：10490052
> 
> 赞同：0
> 
> 时间：2012-05-07T22:33:03.887
> 
> 标签：cookies, refresh

我正在寻找一种从 iframe 重新加载它的父页面的方法，但只有一次。

所以基本上我需要：

1.  检查cookie是否存在
2.  如果没有，写入 cookie 并刷新父页面

任何人都知道如何使用 PHP/JS 来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:40:17.577

使用此代码`create`和`read`来自 的 cookie `JavaScript`。

检查`createCookie`函数返回的内容`null`是否确定未设置 cookie。

```
function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
} 
```

[在此处](http://www.quirksmode.org/js/cookies.html)阅读有关 cookie的更多信息。

# python - 计算具有不同根的方程的pythonic方法是什么？

> ID：10490053
> 
> 赞同：-5
> 
> 时间：2012-05-07T22:33:21.687
> 
> 标签：python, math

我有一个方程`((1 -/+ p)/6) % p`，我需要运行几百万个`p`.

我目前拥有的代码是

```
primes = [5,7,11,13,17,19,23,29,31,37,41,43,47,
          53,59,61,67,71,73,79,83,89,97]

if __name__ == "__main__":

    for p in primes:

        print ((1 - p)/6) % p, ((1 + p)/6) % p 
```

正如预期的那样，这给了我

```
4 1
6 1
9 2
11 2
14 3
16 3
19 4
24 5
26 5
31 6
34 7
36 7
39 8
44 9
49 10
51 10
56 11
59 12
61 12
66 13
69 14
74 15
81 16 
```

我想知道的是如何获得

```
1
6
2
11
3
16
4
5
26
31
7
36
8
9
10
51
56
12
61
66
14
15
81 
```

我还没有真正尝试过任何东西，我已经放弃了使用发电机的想法。但是，这样做我不确定是否会遇到性能问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:50:59.633

这是你想要的？

```
for p in primes:
    r1=f(p - 4) % p
    r2=((1 - p)/6) % p
    if r2==r1:
        print r1, r2
    else:
        print r1, ((1 + p)/6) % p 
```

当您说您还没有真正尝试过任何东西时，请不要尝试优化它！只要得到能产生你想要的东西——然后担心使用生成器或性能问题。

编辑：

你大大改变了你的问题，现在还不清楚你在寻找什么。如果您正在寻找根查找，[这里有一些代码](http://www.math-cs.gordon.edu/courses/mat342/python/findroot.py)。

[Scipy](http://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize)也有许多寻根方法。

选择一个方向 - 让一些东西运行 - 如果它太慢，请尝试修复它。

# android - 一个有效的 JSON 字符串抛出 JSONException，异常变量为空

> ID：10490055
> 
> 赞同：2
> 
> 时间：2012-05-07T22:33:36.397
> 
> 标签：android, wcf, rest

我的系统基于一个 android 客户端和一个 wcf - rest - web 服务。我正在使用本教程： http: [//fszlin.dymetis.com/post/2010/05/10/Comsuming-WCF-Services-With-Android.aspx](http://fszlin.dymetis.com/post/2010/05/10/Comsuming-WCF-Services-With-Android.aspx) 我遇到了一个奇怪的问题。我有一个有效的 JSON 字符串（使用在线工具检查过），对缓冲区的读取很顺利，但是当我尝试创建一个 JSON 数组时，它会抛出 JSONException 而没有异常变量（变量为 NULL - 我以前从未发生过) 抛出异常的行：

```
 request.setHeader("Accept", "application/json");
            request.setHeader("Content-type", "application/json");

            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpResponse response = httpClient.execute(request);

            HttpEntity responseEntity = response.getEntity();

            // Read response data into buffer
            char[] buffer = new char[(int)responseEntity.getContentLength()];
            InputStream stream = responseEntity.getContent();
            InputStreamReader reader = new InputStreamReader(stream);
            reader.read(buffer);
            stream.close();

            JSONArray plates = new JSONArray(new String(buffer)); 
```

最后一行抛出异常。

来自服务的文本是这样的： [{"dtFromDate":"1899-12-30 20:00:00","fBuyWindow":120,"fNewPrice":150,"fOldPrice":400,"lLatitude":32.021327 ，“Llongitude”：34.776452，“ndestineplatform”：1，“nmessageid”：1，“nrange”：5，“nstickinghours”：48，“strdetaileddescription”：“strילייתמסוגn95，הנעלייםםשלמסי，בהנחהמארפת。” ,"strDisplayAddress":"חנקין 49, חולון","strFullAddress":"חנקין 49, חולון, ישראל","strImagePath":"http://images.free-extras.com/pics/n/nike_swoosh-703。 jpg","strItemDescrpition":"נעלי נייק דגם N95 לבן","strThumbPath":"http://images.free-extras.com/pics/n/nike_swoosh-703.jpg","strTitle":"נייק קניון חולון"},{"dtFromDate":"1899-12-30 20:00:00","fBuyWindow":120,"fNewPrice":150,"fOldPrice":400,"lLatitude":32.021327,"lLongitude “：34.776452，”ndestindplatform“：1，”nmessageid“：2，”nrange“：5，”nstickinghours“：48，”strdetaileddescription“：”strילייתמסוגn95，הנעלייםשלשלמסי，בהנחהמארפת。“，”strdisplayaddress ":"","strFullAddress":"חנקין 49, חולון, ישראל","strImagePath":"","strItemDescrpition":"נעלי נייק דגם N95 לבן","strThumbPath":"","strTitle":"נייק קניון חולון"},{"dtFromDate":"1899-12-30 20:00:00","fBuyWindow":120,"fNewPrice":150,"fOldPrice":400,"lLatitude":32.021327,"lLongitude":34.776452,"nDestinatedPlatform":1,"nMessageID":3,"nRange":5,"nStickingHours":48,"strDetailedDescription":"נעלי נייק מסוג N95 ，אייתשללאונלמסי，בהנחהמטורפת。“strdisplayaddress”：“”，“strullladdress”：“חנקין49，חולון，יורה”，“strimagepath”：“”，“stritemdescrpition”：“נעלינייקקדגםn95לבן”， "strThumbPath":"","strTitle":"נייק קניון חולון"},{"dtFromDate":"1899-12-30 20:00:00","fBuyWindow":120,"fNewPrice":150,"fOldPrice ":400,"lLatitude":32.021327,"lLongitude":34.776452,"nDestinatedPlatform":1,"nMessageID":4,"nrange“：5，”nstickinghours“：48，”strdetaileddescription“：”נעלילייתמסוגn95，הנעלייםשלשלמסי，בהנחהמארפת。“，”strdisplayaddress“：”strdisplayaddress“：”“，”strufulladdress“：”strין49，חולון，יוראל“ ,"strImagePath":"","strItemDescrpition":"נעלי נייק דגם N95 לבן","strThumbPath":"","strTitle":"נייק קניון חולון"},{"dtFromDate":"1899-12-30 20 :00:00","fBuyWindow":120,"fNewPrice":150,"fOldPrice":400,"lLatitude":32.021327,"lLongitude":34.776452,"nDestinatedPlatform":1,"nMessageID":5,"nRange ":5,"nStickingHours":48,"strDetailedDescription":"נעלי נייק מסוג N95，הנעליים של לאונל מסי，בהנחה מטורפת。","strDisplayAddress":"","strFullAddress":"חנקין 49, חולון, ישראל","strImagePath":"","strItemDescrpition":"נעלי נייק דגם N95 לבן","strThumbPath":"","strTitle": "נייק קניון חולון"}]

有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:54:14.153

我会建议这样的事情：

```
String newString = reader.read(buffer); //assuming you only get one line in response, rather than many (add a loop if so)
JSONArray plates = new JSONArray(newString); 
```

这可能会有所帮助。否则，这是我使用 JSONArray 完成的一些与 JSON 相关的编码：

```
public JSONArray getQuestionsJSONFromUrl(String url, List<NameValuePair> params) {  
    // Making HTTP request
    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        String jsonData = reader.readLine();
        JSONArray jarr = new JSONArray(jsonData);
        is.close();
        return jarr;
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:19:55.343

试试下面的。

改变这一行...

```
char[] buffer = new char[(int)responseEntity.getContentLength()]; 
```

...使用字节数组如下...

```
byte[] buffer = new byte[(int)responseEntity.getContentLength()]; 
```

您将不得不忘记使用`InputStreamReader`，因为它仅适用于`char[]`. 而是使用...读取流

```
stream.read(buffer); 
```

然后改变这一行...

```
JSONArray plates = new JSONArray(new String(buffer)); 
```

...为此创建一个 UTF-8 编码的字符串...

```
JSONArray plates = new JSONArray(new String(buffer, "UTF-8")); 
```

# android - 不推荐使用 ClientLogin 的 C2DM

> ID：10490058
> 
> 赞同：4
> 
> 时间：2012-05-07T22:33:51.227
> 
> 标签：android, android-c2dm

现在，当 ClientLogin 身份验证被弃用时，我们是否应该使用 OAuth 2.0 进行 C2DM 消息传递？

我的应用程序是需要向注册设备发送消息的 C# Web 应用程序。任何示例如何使用 OAuth 获取身份验证令牌以与 C2dm 消息一起使用？我需要使用哪种类型的身份验证（已安装的应用程序、Web 服务器...）？

**2012 年 6 月 28 日编辑**

C2DM 已弃用。鼓励开发者切换到 GCM，C2DM 将在短时间内得到支持。简单 API 代替不受支持的 ClientLogin 和 oAuth2。 [http://developer.android.com/guide/google/gcm/index.html](http://developer.android.com/guide/google/gcm/index.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T09:28:56.140

这里有一个讨论：[C2DM with PHP using OAuth2.0 (ClientLogin is deprecated!)](https://stackoverflow.com/questions/10340005/c2dm-with-php-using-oauth2-0-clientlogin-is-deprecated)

我假设由于 android C2DM 仍然是实验室的一部分（意味着实验性），它仍然运行 clientlogin 并且不会很快被弃用。弃用政策的一个片段指出：

> 此弃用政策不适用于标记为“实验性”的版本、特性和功能。

但是由于它仍然是实验性的，我们都有一个更严重的问题，谷歌会完全取消 C2DM 的插件吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T20:48:55.567

Android C2DM 仍然要求您使用客户端登录授权。oAuth 2.0 尚不适用于 C2DM，因此请实施客户端登录。正如 Warpzit 所说，谷歌的弃用政策声明它不适用于实验性功能，云到设备的消息传递仍被认为处于“实验室”状态。

# javascript - 将大图像转换为谷歌地图

> ID：10490065
> 
> 赞同：1
> 
> 时间：2012-05-07T22:34:38.707
> 
> 标签：javascript, google-maps, google-maps-api-3

我看过[http://code.google.com/p/maptiler/](http://code.google.com/p/maptiler/)和[http://www.bartlett.ucl.ac.uk/casa/latest/software/gmap-image-cutter](http://www.bartlett.ucl.ac.uk/casa/latest/software/gmap-image-cutter)

Maptiler 不会为没有地理数据的 png 生成 gmap（只需要能够将东西引用为 x,y 像素坐标 -> latlng），栅格只有 openlayers。Openlayers/etc 对我来说不是一个选择。

当我尝试打开 2GB 图像时，Gmap 图像切割器会死机。

是否有任何其他建议或任何方法可以让瓷砖在 Gmap v3 上工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T01:15:03.493

在切割瓷砖时，我个人对 Photoshop 脚本的运气要好得多。这是一个相对较新的（但我自己没有使用过）：[http ://www.bram.us/2012/04/23/photoshop-google-maps-tile-cutter-script/](http://www.bram.us/2012/04/23/photoshop-google-maps-tile-cutter-script/)

# python - 尝试通过 pip 安装 Paramiko 时出错

> ID：10490068
> 
> 赞同：0
> 
> 时间：2012-05-07T22:34:52.327
> 
> 标签：python, osx-lion, paramiko

我正在尝试通过操作系统中的终端安装 paramiko，以便可以按照本教程进行操作：http: [//www.macdrifter.com/2012/05/automated-ftp-from-dropbox-with-hazel/](http://www.macdrifter.com/2012/05/automated-ftp-from-dropbox-with-hazel/)

我使用 python 站点的 OKG 安装最新版本（3.2.3），但我在代码中看到 2.7。当谈到终端时，我仍然非常n3wb，所以不确定其中一些错误是什么意思或如何处理它们（或者如何准确地破译日志）。非常感谢任何帮助（我去掉了一堆“复制”行，用 ...... 表示这是从初始命令到结束的所有内容。

```
sudo pip install paramiko

Downloading/unpacking paramiko
  Downloading paramiko-1.7.7.1.zip (1.1Mb): 1.1Mb downloaded
  Running setup.py egg_info for package paramiko

Downloading/unpacking pycrypto>=2.1 (from paramiko)
  Downloading pycrypto-2.5.tar.gz (426Kb): 426Kb downloaded
  Running setup.py egg_info for package pycrypto

Installing collected packages: paramiko, pycrypto
  Running setup.py install for paramiko

  Running setup.py install for pycrypto
    checking for gcc... no
    checking for cc... no
    checking for cl.exe... no
    configure: error: in `/Users/username/build/pycrypto':
    configure: error: no acceptable C compiler found in $PATH
    See `config.log' for more details

    Traceback (most recent call last):
      File "<string>", line 1, in <module>
      File "/Users/username/build/pycrypto/setup.py", line 452, in <module>
        core.setup(**kw)
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/core.py", line 152, in setup
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 953, in run_commands
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
      File "/Library/Python/2.7/site-packages/distribute-0.6.26-py2.7.egg/setuptools/command/install.py", line 53, in run
        return _install.run(self)
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/command/install.py", line 573, in run
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/cmd.py", line 326, in run_command
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/command/build.py", line 127, in run
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/cmd.py", line 326, in run_command
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
      File "/Users/username/build/pycrypto/setup.py", line 247, in run
        self.run_command(cmd_name)
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/cmd.py", line 326, in run_command
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
      File "/Users/username/build/pycrypto/setup.py", line 274, in run
        raise RuntimeError("autoconf error")
    RuntimeError: autoconf error
    Complete output from command /usr/bin/python -c "import setuptools;__file__='/Users/username/build/pycrypto/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /tmp/pip-u08kV1-record/install-record.txt:
    running install

running build
running build_py
creating build
creating build/lib.macosx-10.7-intel-2.7
creating build/lib.macosx-10.7-intel-2.7/Crypto
copying lib/Crypto/__init__.py -> build/lib.macosx-10.7-intel-2.7/Crypto
.........
copying lib/Crypto/Signature/PKCS1_v1_5.py -> build/lib.macosx-10.7-intel-2.7/Crypto/Signature

running build_ext
running build_configure
checking for gcc... no
checking for cc... no
checking for cl.exe... no
configure: error: in `/Users/username/build/pycrypto':
configure: error: no acceptable C compiler found in $PATH
See `config.log' for more details

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Users/username/build/pycrypto/setup.py", line 452, in <module>
    core.setup(**kw)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/core.py", line 152, in setup
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 953, in run_commands
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
  File "/Library/Python/2.7/site-packages/distribute-0.6.26-py2.7.egg/setuptools/command/install.py", line 53, in run
    return _install.run(self)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/command/install.py", line 573, in run
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/cmd.py", line 326, in run_command
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/command/build.py", line 127, in run
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/cmd.py", line 326, in run_command
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
  File "/Users/username/build/pycrypto/setup.py", line 247, in run
    self.run_command(cmd_name)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/cmd.py", line 326, in run_command
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
  File "/Users/username/build/pycrypto/setup.py", line 274, in run
    raise RuntimeError("autoconf error")
RuntimeError: autoconf error

----------------------------------------
Command /usr/bin/python -c "import setuptools;__file__='/Users/username/build/pycrypto/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /tmp/pip-u08kV1-record/install-record.txt failed with error code 1 in /Users/username/build/pycrypto
Storing complete log in /Users/username/Library/Logs/pip.log 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:39:38.980

从 Apple App Store 安装 XCode，并确保进入 Preferences -> Downloads 并安装命令行工具。你需要一个编译器。

# c# - 在代码中更改 CSProj 中的 AssemblyName

> ID：10490069
> 
> 赞同：0
> 
> 时间：2012-05-07T22:34:54.337
> 
> 标签：c#, xpath, csproj

我正在编写一个实用程序来更改 csproj 文件的程序集名称。我知道 csproj 本质上是 XML，所以 XPath 应该可以工作。事实上，我可以让它为某些信息工作。这是我的代码：

```
var xmlDoc = new XmlDocument();
xmlDoc.Load(file);
XmlNamespaceManager mgr = new XmlNamespaceManager(xmlDoc.NameTable);
mgr.AddNamespace("x", xmlDoc.DocumentElement.NamespaceURI);

XmlNode node = xmlDoc.SelectSingleNode("//x:PropertyGroup//AssemblyName", mgr);
node.Value = newValue;
xmlDoc.Save(file); 
```

但是，`node`为空。我也试过用`"//x:PropertyGroup[1]//AssemblyName"`没用。如果我只是尝试发现`"//x:PropertyGroup"`它会正常工作，那么我假设我的问题是并非每个 PropertyGroup 节点都有一个 AssemblyName 节点。

我正在根据[该线程](https://stackoverflow.com/q/3745029/1265219)中的建议使用 NamespaceManager，并且我已经能够按照[此处](https://stackoverflow.com/q/1191151/1265219)的建议通过 Xlinq 检索 AssemblyName 值，但我需要更新该值，而不仅仅是读取它。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:00:10.270

似乎这是通过评论解决的：

只是猜测，但 AssemblyName 不会也在此 XPath 中由 x 表示的命名空间中：//x:PropertyGroup//AssemblyName。即（不知道数据）我打赌它应该是 //x:PropertyGroup//x:AssemblyName – dkackman

# php - 将 youtube 嵌入到异步自动更新新闻提要中

> ID：10490074
> 
> 赞同：0
> 
> 时间：2012-05-07T22:35:37.410
> 
> 标签：php, javascript, ajax

我正在使用一个简单的 AJAX 脚本设置为每 5 秒执行一次，以显示来自 sql 表的所有新闻提要。一切正常，但是当我想将 youtube 视频嵌入到文章中时，它每 5 秒重新加载一次。

有没有办法解决这个问题？

这是我的脚本...“updatedStories.php”基本上从我的提要表中提取所有数据并回显它。

```
<script>
//get AJAX xmlhttp
function getAJAX(){
    var xmlhttp;
    if(window.XMLHttpRequest) { // IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else { // IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    return xmlhttp;
}
//ajax example
function updateStories(){
    var xmlhttp = getAJAX();

    xmlhttp.onreadystatechange=function() {
        if(xmlhttp.readyState==4 && xmlhttp.status==200) {
            document.getElementById("stories").innerHTML=xmlhttp.responseText;
        }
    }
    xmlhttp.open("POST","updatedStories.php",true);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send();
}
updateStories();
setInterval("updateStories()",5000);
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T01:12:41.653

您正在用数据库中的新内容完全替换故事。这意味着您每次都在创建新的 YouTube 嵌入 - 因此会出现重新加载问题。您需要更改页面的工作方式。与其每五秒获取所有当前商店，不如考虑仅获取自上次更新以来新/更改的故事。不幸的是，它比您当前的代码涉及更多的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T09:20:07.230

我设法让它工作！我正在使用 jQuery 来添加新帖子，所以现在它们按顺序排列。

这是我的代码：javaScript

```
//get AJAX xmlhttp
function getAJAX(){
    var xmlhttp;
    if(window.XMLHttpRequest) { // IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else { // IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    return xmlhttp;
}

setInterval(function (){
    var xmlhttp = getAJAX();

    xmlhttp.onreadystatechange=function() {
        if(xmlhttp.readyState==4 && xmlhttp.status==200) {
            //document.getElementById("stories").innerHTML=xmlhttp.responseText + document.getElementById("stories").innerHTML;
            jQuery("#main_section div#stories").prepend(xmlhttp.responseText);
        }
    }
    xmlhttp.open("POST","updatedStories.php",true);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send();
},5000); 
```

比添加新帖子的脚本：

```
 function update(){
            $query = 'SELECT * FROM stories WHERE time > \''.$_SESSION['last_time'].'\' ORDER BY time DESC ';
            $result = mysql_query($query);
            $num = mysql_num_rows($result);
            $first = true;
            while($rows = mysql_fetch_array($result)){

            $time = $rows['time'];
                if ($first) {
                    $_SESSION['last_time']=$time;
                        $first = false;     
                }
                $title = $rows['title'];
                $user_id =$rows['user_id'];
                $content = $rows['content'];
                display($title,$time,$user_id,$content);
                $_SESSION['last_time']=$time;
            }

        } 
```

# python - 如何从处理程序中退出异步调度程序？

> ID：10490077
> 
> 赞同：6
> 
> 时间：2012-05-07T22:35:58.283
> 
> 标签：python, asyncore

[我在文档](http://docs.python.org/library/asyncore.html)中找不到这个，但我是如何在`asyncore.loop()`不使用信号的情况下突破的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-07T22:37:27.283

在查看源代码后很快就解决了。感谢文档直接链接到源！

您可以简单地从应用程序中引发一个[ExitNow异常，该异常退出循环。](http://hg.python.org/cpython/file/2.7/Lib/asyncore.py#l76)

使用`EchoHandler`文档中的示例，我已将其修改为在接收数据时立即退出。

```
class EchoHandler(asyncore.dispatcher_with_send):

    def handle_read(self):
        data = self.recv(8192)
        if data:
            raise asyncore.ExitNow('Server is quitting!') 
```

另外，请记住，`ExitNow`如果您在内部使用它，您的应用程序不会引发问题。这是我的一些来源：

```
def run(config):
    instance = LockServer(config)
    try:
        asyncore.loop()
    except asyncore.ExitNow, e:
        print e 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-12T12:53:32.527

当没有连接时，异步循环也会退出，因此您可以关闭连接。如果您有多个连接正在进行，那么您可以使用 asyncore.close_all()。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-02T17:07:46.417

试试这个：

服务器的一类（扩展 asyncore.dispatcher）：

```
class Server(asyncore.dispatcher):

    def __init__(self, port):
        asyncore.dispatcher.__init__(self)

        self.host = socket.gethostname()
        self.port = port

        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        self.set_reuse_addr()
        self.bind((self.host, self.port))
        self.listen(5)
        print "[Server] Listening on {h}:{p}".format(h=self.host, p=self.port)

    def handle_accept(self):
        pair = self.accept()
        if pair is not None:
            sock, addr = pair
            print "[ServerSocket] We got a connection from {a}".format(a=addr)
            SocketHandler(sock) 
```

用于管理服务器的线程的另一个类（扩展线程）...检查 run() 方法，我们在其中调用 asyncore.loop()：

```
class ServerThread(threading.Thread):
    def __init__(self, port):
        threading.Thread.__init__(self)
        self.server = Server(port)

    def run(self):
        asyncore.loop()

    def stop(self):
        self.server.close()
        self.join() 
```

现在启动服务器：

```
# This is the communication server, it is going to listen for incoming connections, it has its own thread:
s = ServerThread(PORT)
s.start()               # Here we start the thread for the server
print "Server is ready..."
print "Is ServerThread alive? {t}".format(t=str(s.is_alive()))
raw_input("Press any key to stop de server now...")
print "Trying to stop ServerThread..."
s.stop()
print "The server will die in 30 seconds..." 
```

您会注意到服务器不会立即死亡......但它会优雅地死亡

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-31T15:45:55.930

另一种方法是使用 asyncore.loop 调用的 count 参数。然后，您可以将 asyncore.loop 包装在其他逻辑中：

```
while(i_should_continue()):
    asyncore.loop(count=1) 
```

这不会立即停止打开的连接，或过早超时。但这可能是件好事？我在启动监听服务器时使用它。

# java - Swing：如何对齐 JButton

> ID：10490080
> 
> 赞同：2
> 
> 时间：2012-05-07T22:36:29.453
> 
> 标签：java, swing, alignment, jbutton

我一直在尝试对齐 JButton，并且一直在谷歌搜索一些东西，但似乎没有任何效果。我发现的所有代码都不会移动 JButton。我想对齐 JButton，使它们看起来像计算器的脸。这是我的代码：

```
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class CalculatorUI extends JFrame
{
    //Variables.
    private JTextField text1;
    private JButton button1;
    private JButton button2;
    private JButton button3;
    private JButton button4;
    private JButton button5;
    private JButton button6;
    private JButton button7;
    private JButton button8;
    private JButton button9;
    private JButton button0;
    private JPanel pane;

    public CalculatorUI()
    {
        super ("Calculator");
        setLayout(new FlowLayout());
        text1 = new JTextField(20);
        text1.setEditable(false);
        add(text1);
        button1 = new JButton("1");
        button1.setAlignmentX(LEFT_ALIGNMENT);
        add(button1);
        button2 = new JButton("2");
        add(button2);
        button3 = new JButton("3");
        add(button3);
        button4 = new JButton("4");
        add(button4);
        button5 = new JButton("5");
        add(button5);
        button6 = new JButton("6");
        add(button6);
        button7 = new JButton("7");
        add(button7);
        button8 = new JButton("8");
        add(button8);
        button9 = new JButton("9");
        add(button9);
        button0 = new JButton("0");
        add(button0);

        theHandler handler = new theHandler();
        text1.addActionListener(handler);
        button1.addActionListener(handler);
        button2.addActionListener(handler);
        button3.addActionListener(handler);
        button4.addActionListener(handler);
        button5.addActionListener(handler);
        button6.addActionListener(handler);
        button7.addActionListener(handler);
        button8.addActionListener(handler);
        button9.addActionListener(handler);
        button0.addActionListener(handler);

    }
    private class theHandler implements ActionListener
    {
    public void actionPerformed(ActionEvent event)
    {
        String string = "";

        if(event.getSource() == text1)
        {
            string = String.format("Field1: %s", event.getActionCommand());
        }
        else if(event.getSource() == button1)
        {
            string = String.format("Field2: %s", event.getActionCommand());
        }
        else if(event.getSource() == button2)
        {
            string = String.format("Field3: %s", event.getActionCommand());
        }
        else if(event.getSource() == button3)
        {
            string = String.format("Pasword Field: %s", event.getActionCommand());
        }

        JOptionPane.showMessageDialog(null, string);
    }
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T22:42:57.450

由于 Marvo 给出了具体的建议，我将与他有点矛盾，并告诉您在您更熟悉更简单的布局管理器之前避免使用 GridBagLayout。例如，对于 JButton 网格，使用 GridLayout。如果您需要其他组件，请考虑将使用 GridLayout 的 JPanel 放置在另一个使用不同布局的 JPanel 中，例如 BorderLayout ——您可以使用简单布局嵌套 JPanel 以实现复杂的 GUI。本教程将再次向您展示方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-07T22:40:02.613

您需要找到合适的布局，而 FlowLayout 可能不是要走的路。

对于这种事情，我对 GridBayLayout 很幸运。

[http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)

但我最终也为我遇到的一项独特任务编写了自己的布局管理器。不是特别难。

事实上，如果您需要的只是网格中的按钮，那么简单的 GridLayout 就可以工作。也会更容易。

# jquery - 使用 html Mustache.js 模板的 JQuery 包装元素

> ID：10490082
> 
> 赞同：1
> 
> 时间：2012-05-07T22:36:39.220
> 
> 标签：jquery, jquery-templates, mustache

在我的页面上，我有一个可以称为 myobject 的元素。

```
<div class="outter">
<div class="somethingElse"><a href="#">test</a></div>
{{myobject}}
</div>
</div> 
```

我想在 DOM 中创建上面的代码，其中包含`myobject`这段代码。

所以上面会变成：

```
<div class="outter">
<div class="somethingElse"><a href="#">test</a></div>
<img id="myCoolImage" src="myimage.jpg"/>
</div>
</div> 
```

理想情况下，具有“outter”类的图像将具有来自 img 元素的所有样式元素，但这并不像将其插入我的模板那么重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:55:31.417

考虑到您使用的是模板（Mustache.js？），您可以`myobject`像这样将您的模板添加到您的脚本中：

```
$(document.body).on('click', 'button', function(){
   var myobject={img: "myimage.jpg"};       
   var output = Mustache.render("<img id="myCoolImage" 
       src={{myobject.img}}/>", myobject);    
}); 
```

对于非模板路由，您可以使用 jQuery[`append()`](http://api.jquery.com/append/)方法在 DOM 元素的末尾插入内容，如下所示（HTML）：

```
<div class="outter">
   <some-elements></>
      ...appended stuff goes after all of "outter"'s child elements..
       ... but before its closing tag
</div> 
```

JS会是这样的：

```
$(document.body).on('click', 'button', function(){
   var myobject={img: "myimage.jpg"};       
    $('.outter').append("<img id="myCoolImage" src="'+myobject.img+'"/>");    
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:48:28.540

我会尝试回答这个问题，但不太了解它应该如何工作？

假设它不是模板系统/插件，重点是用一个元素替换花括号，同时移动 CSS，我会这样做：

```
var img = $("#myCoolImage")[0],
    css = img.style.cssText,
    wrapper = $(".outter"),
    wrapperContent = wrapper[0].innerHTML,
    placeholder = wrapperContent.match(/{{(.*?)}}/gi);

wrapper.html(wrapperContent.replace(placeholder, img.outerHTML)).get(0).style.cssText = css; 
```

这是一个[FIDDLE](http://jsfiddle.net/adeneo/3yNpg/)，看看它是如何工作的。

这只会移动内联 CSS 语句，如果您需要移动在外部样式表或样式标签中设置的样式，则必须查看 Javascript 中的 currentStyle / getComputedStyle 函数，但这似乎有点矫枉过正，当您真的需要要做的是将样式应用到一个类，然后将该类添加到`outter`元素中。

​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-15T12:11:48.830

您可以使用三重胡须：**{{{myobject}}}**

接着：

```
var template = "<div class="outter">
<div class="somethingElse"><a href="#">test</a></div>
{{{myobject}}}
</div>
</div>";

$("body").append(Mustache.render(template, {myobject: "<img id="myCoolImage" src="myimage.jpg"/>"})); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T22:40:30.637

查看[.before()](http://api.jquery.com/before/)和.after( [)](http://api.jquery.com/after/)

所以...您的代码如下所示：

```
$("myCoolImage").before("<div class='outter'><div class='somethingElse'><a href='#'>test</a></div>");
$("myCoolImage").after("</div></div>"); 
```

# syntax-error - FROM 子句 vb.net 中的语法错误

> ID：10490089
> 
> 赞同：0
> 
> 时间：2012-05-07T22:37:17.173
> 
> 标签：syntax-error, vb.net-2010, oledbconnection

只是为了让你知道这是我在这个网站上发布的第一个问题，所以如果我错过了任何事情，请告诉我。我遇到的问题是，当程序运行时，我收到以下错误消息

FROM 子句中的语法错误

代码在这里

```
 Dim dbProvider As String
    Dim dbSource As String
    Dim con As New OleDb.OleDbConnection
    Dim ds As New DataSet
    Dim MaxRows As Integer
    Dim sql As String
    Dim TableName As String
    Dim TableCreate As New OleDb.OleDbCommand("CREATE TABLE [" & TableName & "](" & "ID INTEGER NOT NULL," & ")", con)
    Dim da As New OleDb.OleDbDataAdapter("SELECT * FROM  [" & TableName & "]", con)
    Dim cb As New OleDb.OleDbCommandBuilder(da)

    TableName = TbTableName.Text

    dbProvider = "PROVIDER=Microsoft.Jet.OLEDB.4.0;"
    dbSource = "Data Source = E:\A2 Computing\Project\PasswordDatabase.mdb"

    con.ConnectionString = dbProvider & dbSource

    con.Open()

    da.Fill(ds, "NewTable")

    MaxRows = ds.Tables("NewTable").Rows.Count 
```

我遇到的问题是在这条线上

```
 da.Fill(ds, "NewTable") 
```

我不确定我错过了什么，当我声明 tablecreate 或 da 时，我猜测它与括号有关？=S 任何帮助将不胜感激。=)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:47:44.873

您需要在使用`TableName` *之前*分配一些东西，而不是之后。您当前的 SQL 是`SELECT * FROM []`，这就是您在此处遇到语法错误的原因。

更改代码的顺序：

```
Dim TableName As String
TableName = TbTableName.Text

Dim TableCreate As New OleDb.OleDbCommand("CREATE TABLE [" & TableName & "](" & _
   "ID INTEGER NOT NULL" & ")", con)
Dim da As New OleDb.OleDbDataAdapter("SELECT * FROM  [" & TableName & "]", con)
Dim cb As New OleDb.OleDbCommandBuilder(da) 
```

您还需要执行该`TableCreate`语句。IIRC，你曾经`ExecuteNonQuery`这样做过。

```
TableCreate.ExecuteNonQuery; 
```

顺便说一句，您的表创建 SQL 可以简化：

```
' Remove unnecessary concatenation for column definition, as it's always
' the same
Dim TableCreate As New OleDb.OleDbCommand("CREATE TABLE [" & TableName & _
  "](ID INTEGER NOT NULL)", con) 
```

您实际上在哪里连接到数据库？`OleDBConnection`我在您的代码中没有看到任何地方？

[这是OleDBCommand.ExecuteNonScalar](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbcommand.executenonquery.aspx)的 MSDN 文档中的完整示例：

```
Private Sub CreateOleDbCommand( _
      ByVal queryString As String, ByVal connectionString As String)
  Using connection As New OleDbConnection(connectionString)
    connection.Open()
    Dim command As New OleDbCommand(queryString, connection)
    command.ExecuteNonQuery()
  End Using
End Sub 
```

另外，您知道这样做`CREATE TABLE`会创建一个新的空表，因此您的`SELECT * FROM`它不会返回任何内容，只返回`NULL`一行，因为您没有插入任何数据？

# c# - 获取大字符串中分隔符之间的所有值

> ID：10490092
> 
> 赞同：0
> 
> 时间：2012-05-07T22:37:33.617
> 
> 标签：c#, regex, string

我有一个包含一堆文本的字符串。我需要找到位于 'site.com/PI/' 和 '/500/item.jpg 之间的所有值

例子：

```
String STRING = @"
http://site.com/PI/0/500/item.jpg
blah-blah
http://site.com/PI/1/500/item.jpg
blah-blah
http://site.com/PI/2/500/item.jpg
blah-blah
http://site.com/PI/4/500/item.jpg
blah-blah
http://site.com/PI/8/500/item.jpg
blah-blah
http://site.com/PI/6/500/item.jpg    blah-blah" 
```

需要获取 { 0, 1, 2, 4, 8, 6 } 的列表

使用正则表达式很容易出现一次：

```
Regex.Match(STRING, @"(?<=/PI/).*(?=/500/)").Value; 
```

我怎样才能把所有的事件都放在一个列表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:46:14.467

您可以使用 LINQ。

```
List<string> matches = Regex.Matches(STRING, @"(?<=/PI/).*(?=/500/)")
                            .Cast<Match>()
                            .Select(m => m.Value)
                            .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:44:21.183

您可以使用该`Matches`功能。它将返回一个`Match`对象集合。

```
var matches = Regex.Matches(STRING, @"(?<=/PI/).*(?=/500/)")
foreach(Match match in matches)
{
  Console.WriteLine(match.Value);
} 
```

# javascript - 将 JavaScript 动画渲染为电影

> ID：10490094
> 
> 赞同：0
> 
> 时间：2012-05-07T22:37:56.147
> 
> 标签：javascript

我有一个用 JavaScript 编写的动画。我想把它渲染成电影。我不想使用外部帧捕获程序来执行此操作。我想要非常精确地控制时间。我更喜欢这样的系统：

(1) 我可以在每一帧进行浏览器调用，然后浏览器将当前显示呈现为图像。

(2) 因此，我得到了一堆像 foo000.svg foo001.svg foo002.svg ...

(3) 稍后，我可以将这些 svg 转换为 png，并将其放入单个电影中。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:13:47.843

好吧，基本上你想在给定的时间点多次渲染你的网页。我看到以下可能性。

*   网络上有缩略图服务，用于需要链接到的其他站点的小快照的网页。如果 oyu 每单位时间不要求太多快照，它们通常是免费的。现在我不知道是否有任何提供不仅可以渲染缩略图，还可以渲染非小型化页面。试着找一个。

    然后有类似的服务提供全面的网页渲染，例如[http://browsershots.org/](http://browsershots.org/)，尽管我认为它们对来自单一来源的请求有更严格的限制。

    所以你的网页可以做的是，在每一帧之后，创建一个`<img>`带有属性的新元素`src = "http://somethumbnailingservice.com/?render=www.mywebsite.com"`。然后，等到图像加载（在 JS 中有一个事件）并继续你的动画。要保存这些图像，您可以从浏览器手动执行此操作，或者在浏览器缓存中查找它们......或者，最优雅的是，通过 ajax 将它们设置为将接收并保存它们的服务器应用程序。

*   为了避免这些缩略图服务的限制，为什么不自己构建一个呢？Webkit（Safari、Chrome）或 Gecko（Firefox）等浏览器渲染引擎是开源的。这一次，在每一帧，您的 javascript 应用程序都会获取您网页的代码（类似于`document.getElementsByTagName('html')[0].outerHTML`）。然后，通过 ajax 将其发送到您自己的 Web 应用程序，该应用程序将生成快照。这将通过运行渲染引擎、将 html 标记作为输入传递、获取图像输出并保存来完成。

*   最后，一个相当愚蠢但可能仍然可用的方法是使用 javascript 的`print`方法。尽管这可能会每次都要求您进行打印机设置。您肯定安装了 postscript 打印机，它会（如名称所示）将图像保存到 postscript 中，而不是在纸上打印。Postscript 不完全是一种图像格式，但它仍然是一种矢量格式，因此应该有一些应用程序会将其转换为图像。另外，请注意打印机的 CSS 设置通常与屏幕的不同，因此请确保它们不会不同；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:05:04.713

只是一个想法，但是您可以做的是每次要捕获帧时都抓取内部 html，然后将其添加到数组中。完成捕获后，您可以将整个阵列发送到服务器。然后回放会做的是编写内部html。本质上，您将编写自己的各种视频格式，其中每一帧都是当时的 dom 状态。

顺便说一句，您不能轻松地将 HTML 转换为 SVG。此外，根据您的描述，没有简单的方法可以使用 javascript 进行屏幕截图。你可能想看看 flash 的能力，甚至是silverlight。

# google-app-engine - appengine 将数据作为文件下载发送

> ID：10490106
> 
> 赞同：2
> 
> 时间：2012-05-07T22:38:46.347
> 
> 标签：google-app-engine

我是python和appengine的新手。所以我有这个简单的问题。我想发送服务器数据并让服务器将其作为文件下载发送回来。如果我在页面加载之前下载文件，我可以下载文件. 但在那之后我无法下载。这是我现在拥有的：

```
class UploadHandler(webapp.RequestHandler):

  def get(self):
    try:    
        xml=parseString(self.request.body)
        result=sanitize(xml)
        if result == None:
          text=xml.toxml('UTF-8')
          name="file.xml"   
          self.response.out.write(text)
          self.response.headers.add_header('Method','get')
          self.response.headers.add_header('Content-Type','text/xml')
          self.response.headers.add_header('name',name)
          self.response.headers.add_header('Content-Disposition','attachment')
          self.response.headers.add_header('filename',name)
          self.response.headers.add_header('Content',text)
   except:
        print self.request.body 
```

这是调用它的javascript：

```
 var text=getMarkup();
        new Ajax.Request("http://localhost:8080/file",{
        method:'get',
        contentType:"text",
        postBody:text,
        onSuccess:function(){
            console.log(transport.responseText);            
        },          
        onFailure: function(){ 
            console.log('Could not load file...'); 
        },
        onException: function(req,exception) {
            console.log(exception);
            return true;
            }, 
        }); 
```

我已经尝试以多种不同的方式更改这两个部分。我可以得到响应，但我无法让它去下载。如果我对主页使用相同的代码，它仍然可以工作。我错过了什么？

[终于明白了....我在这里](https://developers.google.com/appengine/docs/python/blobstore/overview)使用此页面上的示例， 只是我将 url 作为响应发回，并在“onsuccess”处理程序中使用 window.open 来打开它。

blobstore的问题是文件保存在服务器上，其他人可以查看它们，所以我最好的解决方案是使用全局变量来保存帖子中的数据，然后将其传递给get并从javascript调用get使用 window.open()。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:17:27.800

我认为这会有所帮助

```
import mimetypes
...... 

(content_type, _) = mimetypes.guess_type(name)
self.response.headers['Content-Type'] = content_type
self.response.headers['Content-Disposition'] = 'attachment; filename=' + name
self.response.out.write(text) 
```

顺便一提。您还可以使用 blobstore 保存文件并下载 blob 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:05:49.097

您是否尝试过 Content-Type: application/force-download？这将表明您正在从服务器发送文件，并且该用户想要下载（而不是查看）它。

```
self.response.headers.add_header('Content-Type','application/force-download') 
```

# javascript - 我的网站在 IE9 中崩溃

> ID：10490108
> 
> 赞同：0
> 
> 时间：2012-05-07T22:39:09.717
> 
> 标签：javascript, crash, internet-explorer-9

我的网站在某个页面的 IE9 中偶尔崩溃。该页面有很多 Javascript，包括 Twitter Bootstrap、JQuery、Google Analytics、Olark、Facebook、ZeroClipboard，以及很多自定义脚本，这些脚本大多是从 CoffeeScript 编译而来的。我也使用了一些 CSS3，甚至是一些动画的东西，但我已经从这个页面中删除了所有这些（我认为）。

这是 IE 可执行文件的硬崩溃。F12 脚本调试器没有捕捉到这一点或给出任何提示它可能是什么。Windows 事件查看器会记录崩溃，但没有有用的详细信息。

该页面在 Windows、Mac 和 iOS 上的所有其他主要浏览器上都很好。我什至不知道如何解决这个问题。我一直在破解各种东西。

崩溃有点随机。但是，您应该能够像这样重现：

1.  去这里：[http ://slotted.co/sheets/edit/94cvk6as](http://slotted.co/sheets/edit/94cvk6as)
2.  单击“删除此工作表”，然后重复单击“取消”

几次后，它应该崩溃。

注意：如果上面的链接损坏，请转到主页并创建一个新工作表。

任何关于如何解决这个问题的想法都非常感谢。

更新：如果您无法使用上述步骤重现，请在单击链接之间按 F5 几次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:44:59.990

1.  进入一个可以通过使用 Selinium 或类似工具自动单击按钮来可靠地避免崩溃的位置。

2.  二进制切碎非必要的 js，重新测试测试（AB 然后回到 A）以确认您已经找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T04:47:11.797

我很确定问题出在 ZeroClipboard 上。让我详细说明。零剪贴板带有两个 Flash 文件`ZeroClipboard.swf`和`ZeroClipboard10.swf`. 我一直在使用前者。

我切换到`ZeroClipboard10.swf`，问题就消失了。

*起初它似乎*并没有消失。完全删除 ZeroClipboard 后的事件，我仍然能够重现崩溃。我的理论是 IE 在缓存中保留了一些有害状态。

我不能肯定地说。我能说的是，切换到`ZeroClipboard10.swf` 我相信改变是改变后我无法再重现崩溃。

# jquery-ui - 在 chrome 中调整旋转图像的大小

> ID：10490109
> 
> 赞同：1
> 
> 时间：2012-05-07T22:39:13.303
> 
> 标签：jquery-ui, google-chrome, rotation

我正在使用可调整大小的 jquery ui。

当我在 chrome 中旋转元素时，控件也会旋转，但是当我使用手柄调整 div 的大小时，它们会被反转。

正常情况应该是；如果我向内调整图像大小，它应该减小，如果我向外调整它，它应该增加它的大小。

这对于未旋转的图像很好，但对于旋转的图像则不然。

这是js小提琴

[http://jsfiddle.net/fahadnabbasi/2FLuf/11/](http://jsfiddle.net/fahadnabbasi/2FLuf/11/)

# ms-word - 如何将单词选择转换为html？

> ID：10490113
> 
> 赞同：2
> 
> 时间：2012-05-07T22:39:46.363
> 
> 标签：ms-word, ms-office, vsto

VSTO如何将Word中选定的文本以最小的损失转换为HTML格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T15:02:05.033

`Inspector.CommandBars.ExecuteMso("FileSaveAsHtml")`如果您想将文本保存为 html 格式，也许您可​​以试试这个。

[参考](http://msdn.microsoft.com/en-us/library/office/aa434602%28v=office.12%29.aspx)

# objective-c - 对于具有大量查找表的 iOS 应用程序，什么是好的模式？

> ID：10490116
> 
> 赞同：1
> 
> 时间：2012-05-07T22:39:56.377
> 
> 标签：objective-c, ios, design-patterns

我有一个应用程序有很多（短）查找表（代码-> 人类可读字符串），在 ObjC/iOS 应用程序中实现查找这些代码的最佳方法是什么？

我在想一个“查找”类，它对每个查找都有一个字典（属性），或者可能有一个 plist 的东西？

我想知道其他人如何处理这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:52:47.443

这很大程度上取决于你的意思。一个 plist 可能会很好用。但是，如果您存储大量数据，并且如果您需要存储与代码相关的任何其他内容，我会研究核心数据。这看起来像是一个很好的教程，关于如何使用 plist 做到这一点：[http://iphonebyradix.blogspot .com/2011/03/read-and-write-data-from-plist-file.html](http://iphonebyradix.blogspot.com/2011/03/read-and-write-data-from-plist-file.html)

# actionscript-3 - Flex Mobile：列表闪烁

> ID：10490117
> 
> 赞同：1
> 
> 时间：2012-05-07T22:39:56.893
> 
> 标签：actionscript-3, apache-flex, list, mobile

好的，我有一个包含 IconItemRenderer 的列表。当我在 AS3 中设置它的 dataprovider 并开始滚动时，列表闪烁一次（一帧变白）。这只发生在设置了 messageField/messageFunction 并且消息区域中有不同数量的行时。我确定这是一个框架错误。有没有人有同样的经历？如果有人知道解决方法，我会很高兴。提前致谢。

* * *

这是视图组件的示例代码。奇怪的是，闪烁似乎有时需要更多时间，有时需要更少时间。我在 Android 和桌面模式 (adl) 上对其进行了测试，两者都发生了错误。“blabla..”只是为了得到一个随机行数的字符串。

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009"
        xmlns:s="library://ns.adobe.com/flex/spark" title="HomeView">
    <s:actionContent>
        <s:Button label="Set List" click="btn_click(event)"/>
    </s:actionContent>
    <s:List width="100%" height="100%" id="list">
        <s:itemRenderer>
            <fx:Component>
                <s:IconItemRenderer messageField="text"/>
            </fx:Component>
        </s:itemRenderer>
    </s:List>
    <fx:Script>
        <![CDATA[
            import mx.collections.ArrayList;

            protected function btn_click(event:MouseEvent):void
            {
                var al:ArrayList = new ArrayList;
                var obj:Object;
                var str:String = "blablablablablablablablablablablablablablablablablablablablabblablablablablablablablablablablablablablablablablablablablabblablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablabla";
                for(var i:int = 0; i < 20; i++) {
                    obj = new Object;
                    obj.text = str.substr(0, Math.random()*str.length);
                    al.addItem(obj);
                }
                list.dataProvider = al;
            }

        ]]>
    </fx:Script>
</s:View> 
```

* * *

请参阅错误报告：[https ://issues.apache.org/jira/browse/FLEX-33383](https://issues.apache.org/jira/browse/FLEX-33383)

有关解决方法，请参阅下面的正确答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T10:07:46.723

我想我可能有一个解决方法给你。该问题似乎与内容对齐有关，因此我尝试通过设置自定义布局`contentJustify`而不是默认来更改默认对齐`justify`：

```
<s:VerticalLayout gap="0" 
                  horizontalAlign="contentJustify" 
                  requestedMinRowCount="5" /> 
```

这解决了我的闪烁问题，但现在列表也可以横向滚动，这也是不希望的。我通过设置`horizontalScrollPolicy`来解决这个问题`off`。这是最终结果：

```
<s:List width="100%" height="100%" id="list" horizontalScrollPolicy="off">
    <s:itemRenderer>
        <fx:Component>
            <s:IconItemRenderer messageField="text"/>
        </fx:Component>
    </s:itemRenderer>
    <s:layout>
        <s:VerticalLayout gap="0" horizontalAlign="contentJustify" r
                          equestedMinRowCount="5" />
    </s:layout>
</s:List> 
```

您可能希望正式提交此错误，尽管我不完全知道您必须在哪里执行此操作，因为 Flex 正在从 Adob​​e 迁移到 Apache。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:50:28.843

我最终找到了解决方法。基本上它只是在列表调度 updateComplete 事件时伪造一个拖动事件。这可以防止在用户第一次开始滚动时出现闪烁，并且由于在最初显示列表之前调用了 updateComplete，因此根本没有闪烁。积极的副作用是，每次您切换到包含此列表的视图或列表获取另一个数据提供者时，滚动条都会显示片刻，因此您无需触摸即可猜测列表有多大。

所以这里是代码。我将此列表用作我所有列表的超类：

```
import mx.events.FlexEvent;
import mx.events.TouchInteractionEvent;
import spark.components.List;

public class MyList extends List
{
    public function MyList()
    {
        super();

        //add event listeners
        addEventListener(FlexEvent.UPDATE_COMPLETE, updateCompleteHandler);
    }

    //update complete
    protected function updateCompleteHandler(event:FlexEvent):void
    {
        //fake touch start
        fakeTouchEvent(TouchInteractionEvent.TOUCH_INTERACTION_START);
        callLater(endTouch);
    }

    //quit touch event
    protected function endTouch():void {
        //fake touch end
        fakeTouchEvent(TouchInteractionEvent.TOUCH_INTERACTION_END);
    }

    //fake touch event
    protected function fakeTouchEvent(type:String):void {
        var evt:TouchInteractionEvent = new TouchInteractionEvent(type);
        evt.relatedObject = scroller;
        scroller.dispatchEvent(evt);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T05:12:54.477

我也确实看到了这个问题（Flex 4.6 + AIR 3.1），正如描述的那样：白色闪烁只发生一次，当 List 被拖动到任一方向时。它不会在触摸时发生。在我的情况下，我什至不使用 Label/IconItemRenderer，而是基于这个漂亮的下降通道构建了一个自定义 ItemRenderer。[我](http://www.asfusion.com/blog/entry/mobile-itemrenderer-in-actionscript-part-4) 的 measure() 方法根本不使用 setElementSize()。当 virtualLayout=false 时不会发生此问题，这在移动设备上对于数据提供程序中的大型 (>200) 元素是不可接受的。抱歉，目前还没有解决方法。

# java - 从 Hibernate entitymanager 3.6.9 移动到 4.1.2 崩溃 mysql 连接

> ID：10490129
> 
> 赞同：-1
> 
> 时间：2012-05-07T22:41:25.443
> 
> 标签：java, hibernate

我意识到有关于从 3.x 迁移到 4.x 的帖子。

但是，我无法破译这些指南所说的内容并将其与我需要对我的 maven 依赖项或代码执行的操作相关联。

具体操作失败后

> TypedQuery q = em.createQuery(blah..);

在

> 列表结果 = q.getResultList();

当驱动程序试图建立连接时，最终会发出呱呱叫的声音

> 找不到合适的驱动程序...

我找不到任何关于我是否需要的直接答案

*   更改persistence.xml
*   更改我的代码
*   重新调整我的 JPA 范式

我需要对我的代码和我的 Maven 依赖项进行任何更改吗？我是否应该为习惯休眠 4 而烦恼？

持久性.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
  version="1.0">
  <persistence-unit name="z666" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <class>z666.Node</class>
    <properties>
      <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLInnoDBDialect" />
      <property name="hibernate.connection.driver_class" value="com.mysql.jdbc.Driver" />
      <property name="hibernate.show_sql" value="true" />
      <property name="hibernate.connection.username" value="zzz" />
      <property name="hibernate.connection.password" value="666" />
      <property name="hibernate.connection.url" value="jdbc:mysql://localhost:3306/z666" />
      <property name="hibernate.max_fetch_depth" value="3" />
    </properties>
  </persistence-unit>
</persistence> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:56:56.190

好像您缺少 MySQL 驱动程序`mysql-connector-java-<version>.jar` [Current version](http://www.mysql.com/downloads/connector/j/) is `mysql-connector-java-5.1.20.jar`. 您需要一个 Maven 依赖项，例如：

```
<dependency>
  <groupId>mysql</groupId>
  <artifactId>mysql-connector-java</artifactId>
  <version>5.1.20</version>
</dependency> 
```

我不知道 Hibernate 4 可以接受哪些版本，但我认为您至少需要 5.1

# actionscript-3 - Flash builder Mobile AS3 项目：将 DisplayObject 居中

> ID：10490130
> 
> 赞同：0
> 
> 时间：2012-05-07T22:41:31.897
> 
> 标签：actionscript-3, flash, object, mobile, center

**编辑：**另请参阅 Stackoverflow 上的下一个问题： [Flash builder Mobile AS3 项目：屏幕 DPI、应用程序 DPI、图像 DPI、中心图像](https://stackoverflow.com/questions/10610807/flash-builder-mobile-as3-project-screen-dpi-application-dpi-image-dpi-center)

它与DPI设置有关......

* * *

我想将 DisplayObject 居中到屏幕的中心。这是从资源动态创建的图像。创建对象后，我使用以下代码将其居中：

```
public function showProgress(bValue : Boolean = true):void
{
  this.imgProgress.visible = bValue;
  if( bValue )
  {
    this.imgProgress.x = (this.stage.stageWidth - this.imgProgress.width) * 0.5;
  }
} 
```

对我来说看起来很简单，但对象仍然不在中心。例如：

```
this.stage.stageWidth == 500;
this.imgProgress.width == 480;
Result is: 10px; (this.imgProgress.x) /* 10px is correct */ 
```

我尝试了几件事，也使用 localToGlobal 和 GlobalToLocal 但得到了不可预测的结果，仍然没有居中。

我认为它与屏幕dpi或其他什么有关？但是 Capabilities.screenDPI 返回奇怪的结果。例如，作为 iPhone 3GS 运行，它返回 163dpi。

如何计算正确的中心位置？

**编辑：一些额外的信息：**

```
public class Main extends Sprite
{
// setup stage
this.stage.color = 0;
this.stage.align = StageAlign.TOP_LEFT;
this.stage.scaleMode = StageScaleMode.NO_SCALE; 
```

imgProgress 是 this.stage 的孩子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T12:40:36.003

它与纵横比有关（计算后您可以正确居中）

另请参阅： [在 AS3 移动应用程序中设置 ApplicationDPI](https://stackoverflow.com/questions/10644314/set-applicationdpi-in-as3-mobile-application)

# android - Android服务在快速连续多次被杀死后没有重新启动

> ID：10490133
> 
> 赞同：4
> 
> 时间：2012-05-07T22:41:53.773
> 
> 标签：android, service

我构建了一个简单的 Android 应用程序来解决一个恼人的问题。每当您在我的大学加入无线网络时，您都会被重定向到一个登录页面，您必须在其中提供您的学号和密码。

我已经构建了一个 Android 应用程序，可以让您输入您的详细信息，然后服务会使用意图过滤器注册接收器`WifiManager.NETWORK_STATE_CHANGED_ACTION`。每当设备连接到大学网络时，都会使用登录详细信息发出 HTTP post webrequest。从而解决被重定向的问题。

一切都很完美......但是在我的扩展测试中，我发现了一个非常奇怪的问题。当我按下“Go Power Master”应用程序闪电按钮一次然后打开设置>应用程序>运行时，我看到我的服务正在重新启动（以及许多其他服务，例如 Facebook）。大约 30 秒后，服务重新启动，一切都恢复正常。

但是，如果我快速连续多次（3 次或更多）按下闪电按钮，然后转到设置>应用程序>运行，我不再看到我的服务。就像它从未尝试过重新启动一样。Facebook 服务和其他服务会经历正常的重启阶段并最终成功。

有谁知道发生了什么？当我多次按下闪电按钮时，为什么我的服务会永远死掉？

在您回答之前知道我已经更改了我的应用程序以使用它`startForeground()`，这在我所有的扩展测试中都非常有效。然而，这不是一个有效的解决方案，因为我不希望我的应用程序在状态栏中有一个持续的通知。

PS 如果你想重新创建这个奇怪的问题，我的项目在 github 上[https://github.com/ccoffey/NUIMWiFi](https://github.com/ccoffey/NUIMWiFi)

PPS “Go Power Master”应用程序是 Google Play 上的免费应用程序，闪电按钮应该可以回收丢失的 RAM？我想它会迫使所有后台服务死掉。无论如何，这肯定是它看起来要做的事情。

**编辑以包含 LogCat 日志**

好的，我已经部分回答了我自己的问题。下面是我的服务的 LogCat 输出，过滤后仅包含 ie.cathalcoffey.android。我已经强调了重要的行。事实证明，每次您终止服务时，它的重新启动时间都会增加。最初是 135096 毫秒，第二次杀死服务变成 540384 毫秒，最后一次杀死服务变成 2161536 毫秒。

所以现在我知道为什么我的服务在快速连续多次被杀死后似乎没有重新启动。我仍然不知道为什么 Facebook 服务每次被杀死时都会很快重启（重启时间没有增加）。关于如何解决这个问题的任何想法？

```
05-08 09:52:20.997: I/ActivityManager(192): START   
{act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] 
flg=0x10000000 cmp=ie.cathalcoffey.android/.MyActivity} from pid 3364 05-08 
09:52:21.403: I/ActivityManager(192): Displayed 
ie.cathalcoffey.android/.MyActivity: +290ms (total +41s557ms) 05-08
 09:53:01.888: I/ActivityManager(192): Killing proc 
3330:ie.cathalcoffey.android/10033: kill background 05-08 09:53:01.888: 
W/ActivityManager(192): Scheduling restart of crashed service 
ie.cathalcoffey.android/.MyService in 135096ms 05-08 09:55:17.013: 
I/ActivityManager(192): Start proc ie.cathalcoffey.android for service 
ie.cathalcoffey.android/.MyService: pid=3633 uid=10033 gids={3003} 05-08 
09:56:21.325: I/ActivityManager(192): Killing proc 
3633:ie.cathalcoffey.android/10033: kill background 05-08 09:56:21.333: 
W/ActivityManager(192): Scheduling restart of crashed service 
ie.cathalcoffey.android/.MyService in 540384ms 05-08 10:05:21.747: 
I/ActivityManager(192): Start proc ie.cathalcoffey.android for service 
ie.cathalcoffey.android/.MyService: pid=3943 uid=10033 gids={3003} 05-08 
10:17:20.786: I/ActivityManager(192): Killing proc 
3943:ie.cathalcoffey.android/10033: kill background 05-08 10:17:20.786: 
W/ActivityManager(192): Scheduling restart of crashed service 
ie.cathalcoffey.android/.MyService in 2161536ms 
```

好的，所以用 facebook 过滤 LogCat 会返回以下有趣的信息，有趣的东西再次以粗体显示。他们是怎么做到的？如何将这种不杀逻辑合并到我的服务中。

```
05-08 10:47:15.896: I/ActivityManager(192): Killing proc 
4530:com.facebook.katana/10077: kill background 05-08 10:47:15.896: 
W/ActivityManager(192): Scheduling restart of crashed service 
com.facebook.katana/.service.MediaUploadService in 24955ms 05-08 
10:47:16.552: W/ActivityManager(192): Permission Denial: Accessing service
ComponentInfo{com.facebook.katana/com.facebook.katana.service.MediaUploadService } from pid=907, uid=10069 that is not exported from uid 10077 05-08 10:47:16.560: W/System.err(907): java.lang.SecurityException: Not allowed to stop service Intent { cmp=com.facebook.katana/.service.MediaUploadService } 05-08 10:47:17.263: W/System.err(907): java.lang.SecurityException: Not allowed to stop service Intent { cmp=com.facebook.katana/.service.MediaUploadService } 05-08 10:47:17.263: W/ActivityManager(192): Permission Denial: Accessing service ComponentInfo{com.facebook.katana/com.facebook.katana.service.MediaUploadService} from pid=907, uid=10069 that is not exported from uid 10077 05-08 10:47:17.778: W/System.err(907): java.lang.SecurityException: Not allowed to stop service Intent { cmp=com.facebook.katana/.service.MediaUploadService } 05-08 10:47:17.778: W/ActivityManager(192): Permission Denial: Accessing service ComponentInfo{com.facebook.katana/com.facebook.katana.service.MediaUploadService} from pid=907, uid=10069 that is not exported from uid 10077 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T11:55:14.473

解决方案是在 AndroidManifest.xml 中将exported="false" 添加到服务中

# java - Maven - 如何验证声明的存储库中是否存在依赖项？

> ID：10490135
> 
> 赞同：12
> 
> 时间：2012-05-07T22:42:05.847
> 
> 标签：java, maven

我刚刚为一个项目编辑了`<repositories />`我的`pom.xml`文件部分，删除了几个我认为不需要的 repo。

我想验证声明的依赖项在可用存储库中是否仍然可以解析。

但是，所有声明的依赖项都在我的本地仓库中可用，因此任何构建尝试都只会使用本地的。

我不想简单地破坏我的本地存储库，因为从头开始下载所有依赖项需要很多小时。

同样，我对让 maven 尝试下载所有依赖项不感兴趣，我只是希望它确保它们都是可解析的（包括传递依赖项）。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-28T08:05:39.650

跑 `mvn dependency:analyze`

它将为您检查依赖项。

参考： [http ://maven.apache.org/plugins/maven-dependency-plugin/analyze-mojo.html](http://maven.apache.org/plugins/maven-dependency-plugin/analyze-mojo.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T06:43:46.743

我可以说的第一件事是[不要在 pom 中定义存储库](http://www.sonatype.com/people/2009/02/why-putting-repositories-in-your-poms-is-a-bad-idea/)，因为它会导致很多问题，特别是对于使用这个项目的其他人。此外，我建议使用存储库管理器，它可以解决问题并提高下载过程中的性能，并简化对这种情况的检查，这意味着只需删除本地存储库并尝试构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T06:12:43.107

清空本地仓库似乎是唯一的选择。此链接可能有助于[防止 Maven 解决本地存储库中的依赖关系](https://stackoverflow.com/questions/2772552/how-to-prevent-maven-to-resolve-dependencies-in-local-repository)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T23:11:52.183

清空你的本地仓库（rm -rf ~/.m2/repository）并构建。

您无法解决这个耗时的问题。如果不下载特定的工件，就无法知道它是否在特定的外部仓库中。如果 maven 只是问“你有 X 吗？” 您会从损坏的工件中得到误报，这在某些存储库中很常见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T04:55:02.663

我假设您已经尝试过 mvn validate -U ？我不是很棒的 Maven 专家，但这就是我要尝试的。（尽管我经常爆破我的本地非第三方报告，以确保该构建对其他人有效）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T07:22:54.680

好吧，如果您愿意敲出自己的插件，那么想到的就是让插件仅解析校验和。这些校验和仅在已经部署了相应的 jar/war/zip/whatever 工件之后才部署到远程存储库。

如果下载所有工件需要几个小时，那么您显然需要一个存储库管理器，例如 Nexus 或 Artifactory，就像 Karl-Heinz 已经建议的那样。它将保留远程工件的缓存版本，从中下载将是时间问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-24T08:43:11.710

也许这不是答案，但由于某种原因，我在 pom 文件中有 html，所以有时我会在开始时将 Mvn 依赖项添加到 pom.xml：

```
<repositories>
    <repository>
        <id>mvn</id>
        <name>mvn</name>
        <url>http://maven.icm.edu.pl/artifactory/repo/</url>
    </repository>
...other resps 
```

并删除整个 .m2/repositories 目录，或者我使用以下命令搜索损坏的文件：

```
grep -R -l -L groupId  --include \*.pom   //Search all that not contain groupId string 
```

（在 .m2 目录中执行此操作）

# c# - IntelliSense 不适用于 C# Project-Visual Studio 2010 中的 python

> ID：10490145
> 
> 赞同：2
> 
> 时间：2012-05-07T22:43:18.623
> 
> 标签：c#, visual-studio-2010, intellisense, ironpython, ptvs

我有一个项目，在 VS 中是一个 C# 项目，但在其中我有很多 IronPython 源。开箱即用的 PTVS 突出显示语法，而 IntelliSense 正在使用系统模块。但我也有一些程序集（通过对项目的引用正确链接）；C# 可以使用它们，它们也可以在 IronPython 中运行（脚本正在运行）。但是，IntelliSense 不会自动完成或解析编辑器中的对象。我想也许 PTVS 中的 IronPython 没有看到我的库，所以我将它们添加到 IRONPYTHONPATH 并在它之后 + clr.AddReference。我可以在交互式控制台中使用它们，但编辑器没有运气。在设置中，我将所有解释器都设置为 IronPython。

# vba - Excel VBA 使用不同工作表中的查找/替换更新单元格

> ID：10490147
> 
> 赞同：2
> 
> 时间：2012-05-07T22:43:23.893
> 
> 标签：vba, excel

嘿，我有一张 sheet1，其中包含 A 列中的搜索模式列表，以及 B 列中相应的类别名称列表。我有一张 sheet2，其中包含我的银行交易的各种描述列表。

例如，在表 1 中，我有杂货、燃料、娱乐、储蓄，在表 2 中，我有“壳牌服务站、abc 路”、“Coles 超市”等。

> > **我想在交易列中查找单词，然后将找到的行替换为类别..**

例如。如果我在 Sheet2 中找到“Shell”这个词，我想用“Fuel”这个词替换该行

到目前为止，我已经完成了这项工作，但我不认为这是最有效或最有效的方法。下面是我的代码。

```
Sub UpdateCats()
Dim x As Integer
Dim FindString As String
Dim ReplaceString As String
Dim NumRows As Integer
'Replace and update Categories
With Sheets("Categories")
    .Activate
  ' Set numrows = number of rows of data.
  NumRows = Range("A2", Range("A2").End(xlDown)).Rows.Count
  ' Select cell a1.
  Range("A2").Select
  ' Establish "For" loop to loop "numrows" number of times.
  For x = 1 To NumRows
     FindString = ActiveCell.Value
     ActiveCell.Offset(0, 1).Select
     ReplaceString = ActiveCell.Value
     ActiveCell.Offset(1, -1).Select

     With Sheets("Data")
        .Activate
        'With Columns(2)
        Cells.Replace What:=FindString, Replacement:=ReplaceString, LookAt:=xlWhole, SearchOrder:=xlByRows, MatchCase:=False
        'End With
     End With
     Sheets("Categories").Activate
  Next
End With
End Sub 
```

到目前为止我不喜欢我的代码的原因是因为它在循环中运行时必须不断地在工作表之间切换（激活）。有没有办法更好地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T13:41:49.947

总的来说，我不认为这是一个很好的方法。使用“ActiveCell”和“.Activate”是一个相当危险的习惯，因为任何更改都会搞砸你的整个代码。尝试使用命名层次结构（名称应用程序-名称工作簿-名称表-动态范围，例如命名范围）。我个人也不是很喜欢offset函数，不知道为什么大家都这么痴迷，修改这种代码比较不透明，很少真的需要。您可以将整个内容加载到字符串数组中并循环遍历它。它简短易读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T05:40:18.913

Use this piece of code:

```
Application.ScreenUpdating=false 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-15T10:28:45.777

这将大大缩短处理时间。

```
Sub UpdateCats()
    Dim v As Long, vFSRSs As Variant

    On Error GoTo bm_Safe_Exit
    Application.EnableEvents = False
    Application.ScreenUpdating = False

    'Replace and update Categories
    With Sheets("Categories")
        vFSRSs = .Range(.Cells(2, 1), .Cells(Rows.Count, 1).End(xlUp).Offset(0, 1)).Value2
    End With

    With Sheets("Data")
        With .Columns(2)
            For v = LBound(vFSRSs, 1) To UBound(vFSRSs, 1)
                'Debug.Print vFSRSs(v, 1) & " to " & vFSRSs(v, 2)
                .Replace What:=vFSRSs(v, 1), Replacement:=vFSRSs(v, 2), _
                         LookAt:=xlWhole, MatchCase:=False
            Next v
         End With
    End With

bm_Safe_Exit:
    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub 
```

通过将搜索项和替换项存储在二维数组中，通过工作表单元格的循环被丢弃。此外，已避免使用任何形式的[Worksheet.Activate 方法](https://msdn.microsoft.com/en-us/library/office/ff838003.aspx)或范围。`.Select`

请参阅[如何避免在 Excel VBA 宏中使用 Select 以](https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros)了解更多摆脱依赖 select 和 activate 来实现目标的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-05T02:31:18.207

我会使用内置的应用程序功能对您有利。在我的代码中，我实现了“TypeName”和“Search”方法，基本上与 Ctrl+F 和 Ctrl+replace 做同样的事情，只是变得更具可读性。我认为重要的是要注意 VBA 方法的强大功能，并在使用更非正统的方法之前先使用这些方法。

```
Sub Cats()

With ThisWorkbook
For i = 1 To Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row

    Dim lookupvalue As String

    lookupvalue = Sheets(1).Cells(i, 1).Value

    For n = 1 To Sheets(2).Cells(Rows.Count, 1).End(xlUp).Row

        If TypeName(Application.Search(lookupvalue, Sheets(2).Cells(n, 1))) = "Double" Then
                Sheets(2).Cells(n, 1).Value = Sheets(1).Cells(i, 2).Value
                GoTo exitloop
        End If
    Next n
exitloop:
Next i

End With

End Sub 
```

# android - mp3 文件的加密

> ID：10490150
> 
> 赞同：2
> 
> 时间：2012-05-07T22:43:59.467
> 
> 标签：android, ios, security, encryption, mp3

我需要开发一个下载一些 mp3 音乐并存储在用户手机上的移动应用程序 (android|iphone)，但我需要确保用户不会分发该 mp3。我需要一种加密这些文件的方法。
有什么我可以做的吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:47:28.767

您可以使用 CommonCrypto 函数通过 AES 加密/解密并将密钥保存在钥匙串中。

这是一些示例代码：

```
#import <CommonCrypto/CommonCryptor.h>

+ (NSData *)doCipher:(NSData *)dataIn
                  iv:(NSData *)iv
                 key:(NSData *)symmetricKey
             context:(CCOperation)encryptOrDecrypt
{
    CCCryptorStatus ccStatus   = kCCSuccess;
    size_t          cryptBytes = 0;    // Number of bytes moved to buffer.
    NSMutableData  *dataOut    = [NSMutableData dataWithLength:dataIn.length + kCCBlockSizeAES128];

    ccStatus = CCCrypt( encryptOrDecrypt,
                       kCCAlgorithmAES128,
                       kCCOptionPKCS7Padding,
                       symmetricKey.bytes, 
                       kCCKeySizeAES128,
                       iv.bytes,
                       dataIn.bytes,
                       dataIn.length,
                       dataOut.mutableBytes,
                       dataOut.length,
                       &cryptBytes);

    if (ccStatus != kCCSuccess) {
        NSLog(@"CCCrypt status: %d", ccStatus);
    }

    dataOut.length = cryptBytes;

    return dataOut;
}
// Also add Security.framework to your project. 
```

请注意，这需要 iv（初始化向量），并且不应将简单密码用于密钥。良好的安全性需要多个加密例程，它需要良好的密码学知识和完整的代码审查。

# django - 在 Redhat4 上使用 Apache2 设置 python django 的步骤

> ID：10490152
> 
> 赞同：0
> 
> 时间：2012-05-07T22:44:11.263
> 
> 标签：django, apache, mod-wsgi, redhat

在 Redhat4 系统上安装使 python django 与 Apache2 一起工作所需的所有依赖项的步骤是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:02:34.933

检查您是否有安装其他模块所需的 Apache [apxs 模块](http://httpd.apache.org/docs/2.0/programs/apxs.html)（sudo find / -name "apxs"）。

如果不存在 apxs 模块，则：

```
sudo yum install httpd-devel 
```

对于 python 的 django 模块，您需要安装 python 开发人员包及其依赖项——在我的情况下，我运行了以下 2 个安装命令：

```
sudo yum install gcc
sudo yum install python-devel 
```

安装和配置 dgango 与 apache 对话有点复杂。您需要安装 mod_wsgi python 模块并编辑/配置 apache 配置文件和 wsgi.py 文件（[阅读此内容](http://code.google.com/p/modwsgi/wiki/QuickInstallationGuide)）。

```
wget http://modwsgi.googlecode.com/files/mod_wsgi-3.3.tar.gz
tar xvfz mod_wsgi-3.3.tar.gz
cd mod_wsgi-3.3
./configure 
```

将此行添加到 apache 配置文件的“LoadModule”部分（即类似以下名称的名称：`www.vhost.conf`、、`httpd.conf`等）

```
LoadModule wsgi_module modules/mod_wsgi.so 
```

重新启动 apache，以便它识别您的新更改：

```
/etc/init.d/sudo service httpd stop
/etc/init.d/sudo service httpd start 
```

[用于安装 Apache 模块的 Redhat Docs](http://www.centos.org/docs/5/html/Deployment_Guide-en-US/s1-apache-addmods.html)

# ruby-on-rails - 计算 ruby 中的可用周数

> ID：10490154
> 
> 赞同：2
> 
> 时间：2012-05-07T22:44:13.617
> 
> 标签：ruby-on-rails, ruby

我需要一种根据当前日期和已使用日期计算可用周数的方法。

我提出了不同的解决方案，但对于 Ruby，所有这些似乎都“丑陋”。我知道有更好的方法来做到这一点。

要求：

方法接受 3 个参数

```
start  - Date, to start calculation from

amount - Integer, How many weeks do we want?

used_weeks - Array of already used weeknumbers (optional) Default: nil 
```

假设我们通过这个方法：

```
calculate_available_weeks (Date.current, 5, [1,3,7]) 
```

（为简单起见，假设 Date.current 返回*Sun, 01 Jan 2012*）

然后该方法应返回以下几周的日期：2,4,5,6,8

这是我到目前为止所得到的：

```
def calculate_week_dates(start, amount, excluded_weeks = nil)
  weeks = []

  last_checked = start
  until weeks.length == amount do
    unless excluded_weeks && excluded_weeks.include?(last_checked.cweek)
      weeks << last_checked
    end
    last_checked = last_checked.next_week
  end

  weeks
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:43:04.257

这就是我喜欢红宝石的原因。

```
def calculate(starting_week, amount, excluded_weeks = [])
  ((starting_week..52).to_a - excluded_weeks).first(amount)
end

puts calculate( 1, 5, [1,3,7]).inspect # => [2, 4, 5, 6, 8]
puts calculate( 5, 5, [1,3,7]).inspect # => [5, 6, 8, 9, 10]
puts calculate(10, 5, [1,3,7]).inspect # => [10, 11, 12, 13, 14] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T00:25:45.980

好吧，您可以链接函数式枚举器：

```
def calculate_week_dates(start, amount, excluded_weeks = [])
  (0 ... amount + excluded_weeks.size).
  inject( [start] ) {|a,wk| a << a.last.next_week }.
  reject {|wk| excluded_weeks.include? wk.cweek }.
  first(amount)
end 
```

但我对这是否比累积循环更清晰或更漂亮感到复杂。在任何一种情况下，您最好断言 exclude_weeks 是一个空数组而不是 nil ，以避免在您想使用它时出现后面的 nil 守卫。

# ubuntu - 无法使用 Mono 运行 .net 应用程序 - 找不到 mscorlib.dll（版本不匹配？）

> ID：10490155
> 
> 赞同：69
> 
> 时间：2012-05-07T22:44:19.310
> 
> 标签：ubuntu, mono

我有一个使用 .net 3.5SP1 在 Windows 下编写和编译的简单 .net 命令行工具。我想使用 Mono 在 Linux 上运行它。

我使用的是 Ubuntu 12.04，并使用 Ubuntu 软件中心安装了 Mono Runtime。如果我尝试通过执行以下操作在终端中启动我的应用程序：

```
mono MyApp.exe 
```

我得到错误：

> 未找到或无法加载程序集 mscorlib.dll。它应该已经安装在 'usr/lib/mono/2.0/mscorlib.dll' 中。

如果我导航到该位置，我发现它不存在。但是，有`usr/lib/mono/4.0/mscorlib.dll`（以及同一文件夹中的更多 DLL）。

所以似乎存在版本不匹配。

[如果重要，`mono -V`请显示`Mono JIT compiler version 2.10.8.1 (Debia 2.10.8.1-1ubuntu2)`]

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-05-07T23:58:31.770

我通过安装 mono-complete 让它工作：

```
sudo apt-get install mono-complete 
```

之后，我在 usr/lib/mono 下有 2.0、3.5、4.0 等文件夹

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-02-06T06:18:24.443

如果你只是想运行它，`sudo apt-get install libmono2.0-cil libmono-system-net2.0-cil mono-runtime`可能就足够了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-02T21:49:32.793

我遇到了同样的问题，对于我的发行版（ubuntu 12\. 32 位），单声道完全不可用。所以我刚刚安装了以下软件包，并且具有最重要的 dll 的单声道已经可用：

```
sudo apt-get install mono-dmcs
sudo apt-get install mono-gmcs
sudo apt-get install mono-devel 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-22T02:57:46.320

您要查找的软件包是“libmono-system.data2.0-cil”，它与 Mono-complete 一起安装

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-06T11:18:38.813

我跑了`sudo apt-get purge mono-*`，然后`sudo apt-get install mono-complete`。这在 /usr/lib/mono 中创建了文件，但是在 /usr/local/lib/mono 中查找不存在的文件时仍然会生成错误。

试图将 MONO_PATH 更改为正确的位置，但没有奏效。最后最终将整个目录复制到 /usr/local/lib 最终让它工作。

# video-encoding - 手刹；多个输入

> ID：10490159
> 
> 赞同：3
> 
> 时间：2012-05-07T22:44:56.997
> 
> 标签：video-encoding

如何使用 HandBrake / HandBrakeCLI 编码和连接多个视频？

在我运行的 HandBrakeCLI 中： HandBrakeCLI -i file1.MPG -i file2.MPG -o out.m4v -O -e x264 -r 23.976 --pfr

输出只包含第二个文件！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T14:16:34.180

您无法使用 HandBrakeCLI 连接视频。

如果它们在 MPG-1 中，您可以简单地连接视频

使用 FFMPEG 你可以做到

```
ffmpeg -i input1.avi -same_quant intermediate1.mpg
ffmpeg -i input2.avi -same_quant intermediate2.mpg
cat intermediate1.mpg intermediate2.mpg > intermediate_all.mpg 
```

有关详细信息，请参阅[FFmpeg 常见问题解答](http://ffmpeg.org/faq.html#How-can-I-join-video-files_003f)。

连接视频后，您可以根据需要对它们进行编码。

# jquery - 使用 jQuery 获取标题属性

> ID：10490162
> 
> 赞同：12
> 
> 时间：2012-05-07T22:45:10.667
> 
> 标签：jquery, jquery-mobile

我有一个 jQuery Mobile 手风琴菜单设置如下：

```
<div class="subCat" data-role="collapsible">
    <h3 title="someTitle">Subcategory Name</h3>
    <div class="itemImg">
        <img alt="Item 1" src="[image location]" /><span>Item 1</span>
    </div>
    <div class="itemImg">
        <img alt="Item 1" src="[image location]" /><span>Item 1</span>
    </div>
</div><!--End of subCat--> 
```

这适用于几个子类别。单击时，我有一些代码可以从图像中获取子类别名称和标题属性。

```
var currCat=$(this).closest('.subCat').children('h3').text();
var titleData=$(this).closest('.subcat').children('h3').attr("title"); 
```

“this”是被点击的图像。currCat 获得了它需要的正确字符串，但我总是得到 titleData 的“未定义”。不要起诉获得标题有什么问题。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-07T22:48:39.527

你的第二行有`subcat`而不是`subCat`. 以下应该有效：

```
$(this).closest('.subCat').children('h3').attr("title"); 
```

感谢您提醒我选择器中的类名区分大小写。很容易错过。

# c# - wsdl.exe 忽略包含单个数组元素的 complexType

> ID：10490164
> 
> 赞同：2
> 
> 时间：2012-05-07T22:46:18.727
> 
> 标签：c#, visual-studio, wsdl, complextype, wsdl.exe

我想在我的 WSDL 中有以下结构（省略命名空间）

```
<complexType name="NotesResponseType">
  <sequence>
    <element name="Notes" type="string" minOccurs="0" maxOccurs="unbounded"/>
  </sequence>
</complexType>

<element name="Response">
  <complexType>
    <sequence>
      .
      .
      <xs:element name="Notes" type="tns:NotesResponseType" minOccurs="0"/>
      .
      .
    </sequence>
  </complexType>
</element> 
```

这样我就可以在我的 C# 代码中获得以下结构

```
Response response; 
response.Notes = new NotesResponseType(); 
response.Notes.Notes = new string[1]; 
```

但 wsdl.exe 似乎完全忽略了复杂类型“NotesResponseType”，即 response.Notes 是一个字符串数组，而不是我期望的 NotesResponseType 类型。有没有办法告诉 wsdl.exe 不要这样做？

# xaml - 从 GridViewItem 中删除填充

> ID：10490167
> 
> 赞同：1
> 
> 时间：2012-05-07T22:46:32.227
> 
> 标签：xaml, gridview, windows-8, windows-runtime, winrt-xaml

有人知道从 GridViewItem 中删除所有填充的方法吗？我正在使用非常小的物品（虽然不是太小，我在下图中夸大了），并且在选择物品时有一些填充物，这使得它变得非常糟糕，我想把它拿出来。这就是我的意思：

![在此处输入图像描述](../Images/710718910850779a91ef72e4a41009b3.png)

图像的代码是这样的：

```
<GridView Margin="120,80,0,0"
                  SelectionMode="Multiple">
            <GridView.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel
                        Orientation="Horizontal" />
                </ItemsPanelTemplate>
            </GridView.ItemsPanel>
            <GridView.ItemContainerStyle>
                <Style TargetType="GridViewItem">
                    <Setter Property="HorizontalAlignment" Value="Center" />
                    <Setter Property="VerticalAlignment" Value="Center" />
                </Style>
            </GridView.ItemContainerStyle>
            <Rectangle Height="10" Width="10" Fill="Red" />
            <Rectangle Height="10" Width="10" Fill="Orange" />
            <Rectangle Height="10" Width="10" Fill="Blue" />
            <Rectangle Height="10" Width="10" Fill="Green" />
            <Rectangle Height="10" Width="10" Fill="Yellow" />
        </GridView> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T04:14:21.010

如果您提取 GridViewItem 的模板 - 您会看到它有一些硬编码值 - 4pt 边距、40x40 路径等。要解决这个问题 - 您需要修改模板，但您可以将项目尺寸硬编码为使它们更小 - 只需确保您可以使用不可见的选择复选标记：

```
 <GridView
        Margin="120,80,0,0"
        SelectionMode="Multiple">
        <GridView.ItemsPanel>
            <ItemsPanelTemplate>
                <VirtualizingStackPanel
                    Orientation="Horizontal" />
            </ItemsPanelTemplate>
        </GridView.ItemsPanel>
        <GridView.ItemContainerStyle>
            <Style
                TargetType="GridViewItem">
                <Setter
                    Property="HorizontalAlignment"
                    Value="Center" />
                <Setter
                    Property="VerticalAlignment"
                    Value="Center" />
                <Setter
                    Property="Width"
                    Value="20" />
                <Setter
                    Property="Height"
                    Value="20" />
                <Setter
                    Property="Padding"
                    Value="0" />
                <Setter
                    Property="Margin"
                    Value="0" />
            </Style>
        </GridView.ItemContainerStyle>
        <Rectangle
            Height="10"
            Width="10"
            Fill="Red" />
        <Rectangle
            Height="10"
            Width="10"
            Fill="Orange" />
        <Rectangle
            Height="10"
            Width="10"
            Fill="Blue" />
        <Rectangle
            Height="10"
            Width="10"
            Fill="Green" />
        <Rectangle
            Height="10"
            Width="10"
            Fill="Yellow" />
    </GridView> 
```

# image - 将表单结果传输到不同页面，并将变量设置为源值

> ID：10490168
> 
> 赞同：0
> 
> 时间：2012-05-07T22:46:34.863
> 
> 标签：image, src

我已经为此工作了一段时间。

我想要的是网页有一个表单，它要求输入图像的 url，一旦他们输入 url 并单击提交，它应该转到另一个页面并应该在页面上显示图像。

帮助？

另外，有什么方法可以调用图像的高度和宽度？

注意：我不能使用 ASP

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:11:31.317

您的文件格式 **为 form.html**

```
<form method='get' action='show_img.php'>
<input type='text' name='url' value='' /> URL
<input type='submit' value='Submit' />
</form> 
```

接收表单数据并显示图像的文件： **show_img.php**

```
<?php
$url_path = $_GET['url'];
// Don't forget to cheack if recieved data is SAFE!

echo "<img src={$url_path} />";

?> 
```

# c# - Linq 外连接可能的问题

> ID：10490174
> 
> 赞同：0
> 
> 时间：2012-05-07T22:46:59.850
> 
> 标签：c#, linq, tdd

```
 var query1 = from l in context.Logs
                    where l.LogID == maxid
                    select l;
        int count1 = query1.Count();

        var query2 = from ld in context.LogDetails
                     where ld.LogID == maxid
                     select ld;
        int count2 = query2.Count();

        Assert.AreEqual(1,count1);
        Assert.AreEqual(0,count2); 
```

我希望我能以更好的方式编写上述查询。如果我使用的是 TSQL，我可以使用 OUTER JOIN 和过滤器来查看 ld.LogID 是否为空。但我不知道如何在 LINQ 中做到这一点。有什么办法可以清理这个吗？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:51:30.470

[在 LINQ 中可以进行外部连接](https://www.google.com/search?q=outer+join+linq)。

```
var query = from log in context.Logs
            join logDetail in context.LogDetails
                on log.LogID = logDetail.LogID into lj
            from item in lj.DefaultIfEmpty()
            select new { log.LogID, MissingDetails = lj == null }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T01:11:23.160

这是使用导航属性的外部联接：

```
from log in context.Logs
from logDetail in log.LogDetails.DefaultIfEmpty()
select new {log, logDetail} 
```

不要忘记测试 logdetail 是否为空。

# asp.net-mvc-3 - _MINIPROFILER UPDATED Layout.cshtml Razor 问题

> ID：10490176
> 
> 赞同：0
> 
> 时间：2012-05-07T22:47:02.307
> 
> 标签：asp.net-mvc-3, razor, mvc-mini-profiler

什么是“_MINIPROFILER UPDATED Layout.cshtml”，为什么它总是给我带来问题，为什么我尝试构建？

`"The name 'ViewBag' does not exist in the current context" _MINIPROFILER UPDATED Layout.cshtml`

`"The name 'Url' does not exist in the current context" _MINIPROFILER UPDATED Layout.cshtml`

我没有生成这些视图，所以我不知道如何控制其中的内容。肯定是一个简单的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:25:52.937

通过 NuGet 将 MiniProfiler 添加到项目时，会生成“_MINIPROFILER UPDATED Layout.cshtml”文件。这是一个示例文件；它显示了如何在布局中呈现 MiniProfiler 包含 (css og js)。您应该抓住*@MiniProfiler.RenderIncludes()*行并将其放入您的标准布局文件（_Layout.cshtml），然后删除“_MINIPROFILER UPDATED Layout.cshtml”文件。

# c# - 在代码隐藏中使用 DataKeys 和 LinqToSql 作为数据源

> ID：10490183
> 
> 赞同：0
> 
> 时间：2012-05-07T22:47:47.467
> 
> 标签：c#, asp.net, linq-to-sql, gridview, webforms

我一直在做一个项目，我们只使用**一个**GridView 来显示不同 Linq 结果的结果。

此网格视图具有：

```
AutoGenerateColumns = true; 
```

有一个我们想要用作数据源的 Linq 结果。在这个结果中，我们有想要用作 DataKeys 的列。当我们将结果绑定到我们的 GridView 时，我们不想将这些列显示给用户。

这是一个例子：

```
gvMyGrid.DataSource = from finalRows in summaryReport
                      select new
                      {
                          finalRows.a,
                          finalRows.b,
                          finalRows.c,
                          finalRows.d,
                          finalRows.e
                      };

gvMyGrid.DataKeyNames = new string[] { "a", "b" };
gvMyGrid.DataBind(); 
```

所以在这个绑定完成后，我们仍然看到“a”和“b”作为列。我们可以在调用时使用“a”和“b”：

```
gvReport.Datakeys 
```

但是，我们不想在 gridview 上看到它们。

所以我的问题是，我们如何隐藏这些列但仍将它们用作数据键？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:08:22.563

我认为没有使用 DataKeys if 的直接方法`AutoGenerateColumns = true;`。你可以试试这个方法。在绑定数据源之前，请确保您的 DataKey 列始终位于集合中的相同位置。说datakey“a”是列索引1，说datakey“b”是列索引2。所以无论你的集合返回10列还是20列仍然“a”和“b”应该在索引1和2中。然后你可以做这是隐藏列。

```
 protected void gvReport_RowCreated(object sender, GridViewRowEventArgs e)
        {
            for (int i = 0; i < e.Row.Cells.Count; i++)
            {
                e.Row.Cells[1].Visible = false; 
                e.Row.Cells[2].Visible = false;                
            }            
        } 
```

GridView 会像

```
<asp:GridView ID="gvReport" runat="server" onrowcreated="gvReport_RowCreated" AutoGenerateColumns="true"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:11:27.923

我想到了一些选项：

1.  不要使用 AutoGenerateColumns 而是明确地创建您想要显示的*列*。

2.  显式隐藏键列：

    ```
    gvMyGrid.Columns["a"].Visible = false;
    gvMyGrid.Columns["b"].Visible = false; 
    ```

# javascript - 页面不会停止加载 - javascript

> ID：10490184
> 
> 赞同：0
> 
> 时间：2012-05-07T22:47:56.080
> 
> 标签：javascript

如果页面选项卡中旋转的东西不会停止旋转，即说它正在加载，这意味着什么？

我有一个 php for 循环，在每一个循环中它都会抛出我有一个带有 for 循环的 javascript onload 函数，以查看该 id（来自 mysql）是否在 javascript cookie 数组中。希望这是有道理的。一切正常，但不会停止加载。无论如何，我玩过 break 并 return false 停止加载但没有给我想要的结果。

谁能指出我正确的方向？谢谢

这是 img 标签中的 onload 调用的 javascript 函数，php for 函数创建的每个循环都会抛出该函数。n 是标识。secondarray 是放入可读数组的 cookie 数据。

```
function cookietest(n)
{ 
for (i = 0; i < secondarray.length; i++) 
{ 
if (secondarray[i] == "ca[]="+n  ) document.getElementById(n).src = "saved.png" ;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:00:19.000

检查循环内的长度总是一个杀手。并且在某个点打破循环，也可以帮助您提高性能。

```
function cookietest(n)
{ 

    var l = secondarray.length;
    for (i = 0; i < l i++) 
    { 
        if (secondarray[i] == "ca[]="+n  ) {
          document.getElementById(n).src = "saved.png" ;
          break; //break out of loop it is no longer needed I GUESS
        }
    }

} 
```

[PS：我只是根据OP提供的代码来回答，罪魁祸首也可能是其他人。]

# google-maps - 在商业分布式应用程序中提供地图的选项

> ID：10490188
> 
> 赞同：0
> 
> 时间：2012-05-07T22:48:40.800
> 
> 标签：google-maps, map, openstreetmap

我正在寻找一种在我的商业分布式网络应用程序中提供地图（如谷歌地图）的方法。据我所知，谷歌地图并没有给我我需要的东西。以下是我的要求：

1) 不得要求我的客户购买和提供 API 密钥

2) 不得仅限于一个 URL 或一组 URL（我不知道我的客户将在哪里使用我的应用程序）。

3) 我不在乎它是否是托管解决方案，或者我是否需要将映射解决方案与我的软件捆绑在一起。我确实需要一个 JavaScript API。

我查看了一些 OpenStreetMaps 解决方案 .. 但找不到允许我这样做的解决方案。我不介意为此解决方案付费..我不需要“免费”..

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T15:35:42.337

我不确定您所说的“分布式 Web 应用程序”是什么意思。您是为您的客户托管它还是只是将它作为一个软件包提供给您的客户自己托管？

无论如何，使用 OpenStreetMaps 有很多方法，这取决于您希望地图来自外部（互联网）还是托管在 Intranet 上。这还取决于您是要覆盖整个世界还是仅覆盖其中的一些较小部分。

一些资源：

*   [http://switch2osm.org/](http://switch2osm.org/)
*   [http://developer.mapquest.com/web/products/open/map](http://developer.mapquest.com/web/products/open/map)
*   [http://maperitive.net/](http://maperitive.net/)（免责声明：我是 Maperitive 的作者）

# c++ - 放置新零是否会耗尽内存？

> ID：10490191
> 
> 赞同：3
> 
> 时间：2012-05-07T22:49:07.647
> 
> 标签：c++, new-operator, placement-new

我有以下代码：

```
struct foo {};
void bar(foo *d) {
  new(d) foo(*d);
} 
```

表达式是否使`new(d) foo(*d)`指向的对象`d`保持不变？更具体地说，如果类`foo`和其中递归包含的所有对象仅具有微不足道的复制构造函数，那么上述情况是否正确，那么是否`new(d) foo(*d)`保持`*d`不变？不正确的情况可能是，`new`在调用复制构造函数之前首先将内存清零。C++语言中有这样的子句吗？

**编辑**：有人想要这样做有重要的原因。考虑跨地址空间复制对象，例如，从 CPU 内存到 GPU 内存。一种解决方案是逐字节地处理对象。这在很多情况下都有效。如果该类具有虚方法，则逐字节复制复制 vtable 指针，该指针随后将指向一些 CPU 内存。可以在对象上使用上述表达式`new(d) foo(*d)`来强制编译器重置 vtable 指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:14:52.583

关于placement new是否将内存清零，它不会，它只是调用适当的构造函数，该构造函数将执行该构造函数所做的任何事情，这可能取决于它的定义方式是否将内存清零。在这种特殊情况下，您使用的是复制构造函数

在您提供的代码中，它是未定义的行为。要么`d`指向有效对象，要么不指向有效对象。如果它引用了一个有效对象，则您正在对已构造的对象调用构造函数，如果该对象具有非平凡的析构函数，则这是未定义的行为。如果它之前没有被初始化（即它没有引用一个`foo`对象），那么从它复制它是未定义的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-08-02T10:51:46.360

我刚刚在研究性能问题时遇到了这个问题。一些在包含大缓冲区的对象上使用放置新的代码出乎意料地慢。原因：placement new 在调用构造函数之前将内存清零。

我对该标准的阅读与其他答案一致：编译器不需要做任何特别的事情。

但是，gcc 4.9、gcc 5.3、clang 3.4、clang 3.8 和 Apple clang 在放置新案例中似乎都将内存归零。检查汇编器输出，`memset`在调用构造函数之前有一个显式调用。堆栈构造的对象不是零初始化的，所以它似乎不是构造函数在做这项工作。

检查来自 Dignus Systems/C++ for z/OS 的汇编器输出似乎也调用了一个库函数，大概是在做类似的事情（而且速度很慢）。

所以：放置 new 被允许将内存归零，并且似乎许多实现都将内存归零。

示例测试用例：

```
#include <new>
#include <cstdint>
#include <stdio.h>

struct Test {
    char b[4];

    void show(char const* prefix) {
        for (unsigned i = 0; i < sizeof(b); ++i)
            printf("%s index %d: %d\n", prefix, i, b[i]);
    }
};

int main()
{
    char* p = new char[sizeof(Test)];

    for (unsigned i = 0; i < sizeof(Test); ++i)
        p[i] = 'Q';

    Test* t1 = new(p) Test();
    Test t2;

    t1->show("t1");
    t2.show("t2");
} 
```

示例输出（FreeBSD 上的 clang 3.4）：

```
t1 index 0: 0
t1 index 1: 0
t1 index 2: 0
t1 index 3: 0
t2 index 0: 51
t2 index 1: -1
t2 index 2: 3
t2 index 3: 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T23:02:11.090

我相信这是未定义的行为：一旦存储对象的内存用于其他用途，对象的生命周期就会结束。当您进入`this`指针等于的复制构造函数时`d`，原始对象将不复存在（就语言而言），因此您在复制构造函数中有一个悬空引用。

当然更容易的是`~foo()`产生影响的情况，在这种情况下，您还有另一个未定义行为的原因。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-12-27T01:46:45.303

是和否。

我认为我们在这里进入编译器定义的行为。但是，对于 Visual C++ 2019，如果没有默认构造函数，placement new 将清除数据。请参阅下面的片段。

```
int buffer[4];

class some_class
{
public:
    int a, b, c;
};

class some_class2
{
public:
    int a, b, c;

    some_class2()
    {
        ;
    }
};

buffer[0] = 1;
buffer[1] = 2;
buffer[2] = 3;
some_class* c = new (buffer) some_class();
std::cout << "placement new with a class clears it" << std::endl;
std::cout << c->a << " " << c->b << " " << c->c << std::endl;

buffer[0] = 1;
buffer[1] = 2;
buffer[2] = 3;
some_class2* d = new (buffer) some_class2();
std::cout << "placement new with a class that has a constructor does not clear it" << std::endl;
std::cout << d->a << " " << d->b << " " << d->c << std::endl; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T22:50:17.910

放置 new 的唯一工作是在为尚未初始化的对象预留的内存上运行构造函数。如果您手动调用构造函数（尽管这是不可能的），那么它所做的就是您将得到的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-07T22:55:09.173

请注意，您正在调用对象的复制构造函数，并将其自身作为复制源。我希望这简直是疯了。谁知道。我在标准中看不到任何让我期待任何东西的东西。

# c# - 根据长度分隔字节并将字节转换为ASCII

> ID：10490192
> 
> 赞同：0
> 
> 时间：2012-05-07T22:49:37.383
> 
> 标签：c#, arrays, multidimensional-array, byte

我用谷歌搜索了很多，找不到我需要的答案。我需要找到一种将长字节拆分为 512 位长字节数组的方法。我正在使用的代码：

```
 System.Drawing.Image newimg = System.Drawing.Image.FromFile(image.jpg);
            byte[] size = new byte[];
            MemoryStream ms = new MemoryStream();
            newimg.Save(ms, System.Drawing.Imaging.ImageFormat.Gif);
            size = Encoding.ASCII.GetBytes(ms.ToArray()); 
```

现在我想要做的是将其拆分为 512 位，但首先我需要找到一种将字节编码为 ASCII 的方法，然后将其拆分。我对字节很陌生，所以如果这段代码非常错误和草率，请提前原谅。

# c# - TypeConverters 因原始类型而损坏？

> ID：10490193
> 
> 赞同：9
> 
> 时间：2012-05-07T22:49:43.467
> 
> 标签：c#, .net, typeconverter

我遇到了`DecimalConverter`and`Int32Converter`类的问题，这似乎返回了不一致的结果，如下面的简单控制台程序所示：

```
using System;
using System.ComponentModel;

class App
{
    static void Main()
    {
        var decConverter = TypeDescriptor.GetConverter(typeof(decimal));
        Console.WriteLine("Converter: {0}", decConverter.GetType().FullName);
        Console.WriteLine("CanConvert from int to decimal: {0}", decConverter.CanConvertFrom(typeof(int)));
        Console.WriteLine("CanConvert to int from decimal: {0}", decConverter.CanConvertTo(typeof(int)));

        Console.WriteLine();

        var intConverter =  TypeDescriptor.GetConverter(typeof(int));
        Console.WriteLine("Converter: {0}", intConverter.GetType().FullName);
        Console.WriteLine("CanConvert from int to decimal: {0}", intConverter.CanConvertTo(typeof(decimal)));
        Console.WriteLine("CanConvert to int from decimal: {0}", intConverter.CanConvertFrom(typeof(decimal)));
    }
} 
```

输出如下：

```
Converter: System.ComponentModel.DecimalConverter
CanConvert from int to decimal: False
CanConvert to int from decimal: True

Converter: System.ComponentModel.Int32Converter
CanConvert from int to decimal: False
CanConvert to int from decimal: False 
```

除非我对 TypeConverters 的理解不正确，否则以下内容应该成立：

```
TypeDescriptor.GetConverter(typeof(TypeA)).CanConvertFrom(typeof(TypeB)) 
```

应该给出相同的结果

```
TypeDescriptor.GetConverter(typeof(TypeB)).CanConvertTo(typeof(TypeA)) 
```

至少在 和 的情况下`System.Int32`，`System.Decimal`它们没有。

我的问题是：有人知道这是否是设计使然吗？或者 C# 中本机类型的 TypeConverters 是否真的损坏了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:10:02.403

根据Int32Converter的[MSDN 文档...](http://msdn.microsoft.com/en-us/library/system.componentmodel.int32converter.aspx)

> 此转换器只能将 32 位有符号整数对象与字符串转换。

我同意评论中的@svick，不过，我不明白为什么首先需要通过 Int32 将 JSON 字符串反序列化为 Decimal。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T00:35:44.187

在这种情况下，您根本不需要处理类型转换器。如果要反序列化模型类，请执行以下操作：

```
serializer.Deserialize<Model>(json) 
```

它会为您处理所有转换。

如果您确实需要手动进行转换，请使用[`Convert.ToDecimal(integer)`](http://msdn.microsoft.com/en-us/library/system.convert.todecimal.aspx)(或[`Convert.ChangeType(integer, typeof(decimal))`](http://msdn.microsoft.com/en-us/library/dtb69x08.aspx))，它将正常工作。

# objective-c - 当一些隐藏时在视图上重新定位 UIImageViews

> ID：10490197
> 
> 赞同：0
> 
> 时间：2012-05-07T22:49:56.807
> 
> 标签：objective-c, ios, xcode, uiview, hidden

我有一个 UIView，其中包含一些图像，这些图像将被隐藏以显示我收到的功能。我一直在四处寻找，但我还没有找到重新定位这些 UIImageView 以使它们居中的方法。

我的意思是如果我有以下行：

```
|X||X||X||X||X||X||X| 
```

我隐藏了我想展示的第二个和第五个元素

```
 |X||X||X||X||X| 
```

但我明白了

```
|X|   |X||X|   |X||X| 
```

是否有任何 UIView 属性来控制它，或者我必须手动创建不同的 UIView 或以编程方式在我的代码中添加元素？现在我只使用我的 UIImageView 元素的隐藏属性。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:29:59.497

试穿这个尺寸！;-)

***视图控制器.h***

```
#define BUFFER 10
#define WIDTH 90
#import <UIKit/UIKit.h>
@interface ViewController : UIViewController
@property (strong, nonatomic) NSMutableArray *ViewArray;
- (IBAction)hideViews:(id)sender;
- (void)centerVisibleViews;
@end 
```

***视图控制器.m***

```
#import "ViewController.h"
@implementation ViewController
@synthesize ViewArray;
- (void)viewDidLoad {
    [super viewDidLoad];
    NSMutableArray *colorArray = [NSMutableArray array];
    [colorArray addObject:[UIColor redColor]];
    [colorArray addObject:[UIColor orangeColor]];
    [colorArray addObject:[UIColor yellowColor]];
    [colorArray addObject:[UIColor greenColor]];
    [colorArray addObject:[UIColor blueColor]];
    [colorArray addObject:[UIColor purpleColor]];
    [colorArray addObject:[UIColor blackColor]];
    [self setViewArray:[NSMutableArray array]];
    for (int i = 0; i < 7; i = i + 1) {
        UIView *view = [[UIView alloc] initWithFrame:CGRectMake(BUFFER + ((WIDTH + BUFFER) * i), BUFFER, WIDTH, WIDTH)];
        [view setBackgroundColor:[colorArray objectAtIndex:i]];
        [[self ViewArray] addObject:view];
        [[self view] addSubview:view];
    }
}
- (IBAction)hideViews:(id)sender {
    for (int i = 0; i < [[self ViewArray] count]; i = i + 1) {
        if (i == 1 || i == 4) {
            [(UIView *)[[self ViewArray] objectAtIndex:i] setHidden:YES];
        }
    }
    [self centerVisibleViews];
}
- (void)centerVisibleViews {
    int visibleViews = 0;
    for (int i = 0; i < [[self ViewArray] count]; i = i + 1) {
        if (![(UIView *)[[self ViewArray] objectAtIndex:i] isHidden]) {
            visibleViews = visibleViews + 1;
        }
    }
    float totalWidth = (BUFFER * 2) + (WIDTH * [[self ViewArray] count]) + (BUFFER * ([[self ViewArray] count] - 1));
    float visibleWidth = (BUFFER * 2) + (WIDTH * visibleViews) + (BUFFER * (visibleViews - 1));
    // Make it sexy with an animation!!!
    [UIView animateWithDuration:1.0
                     animations:^{
                         float offset = (totalWidth - visibleWidth) / 2.0;
                         for (int i = 0; i < [[self ViewArray] count]; i = i + 1) {
                             UIView *thisView = [[self ViewArray] objectAtIndex:i];
                             if (![thisView isHidden]) {
                                 [thisView setFrame:CGRectMake(offset, BUFFER, WIDTH, WIDTH)];
                                 offset = offset + WIDTH + BUFFER;
                             } 
                         }
                     }
     ];

}
@end 
```

唯一要做的就是在主视图中添加一个按钮并将其绑定到`IBOutlet`. 在我的 iPad 模拟器上又漂亮又漂亮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T09:06:22.167

修改@mbm30075代码后的最终解决方案如下：

```
- (void)centerVisibleViews{

int visibleViews = 0;
for (int i = 0; i < [[self imgViews] count]; i = i + 1) {
    if (![(UIView *)[[self imgViews] objectAtIndex:i] isHidden]) {
        visibleViews = visibleViews + 1;
    }
}
if(visibleViews==0) return;

float screenWidth = imgAnimals.superview.bounds.size.width;
//float maxWidthImage = screenWidth / visibleViews;

float imgWidth = [imgAnimals frame].size.width;

// Make it sexy with an animation!!!
[UIView animateWithDuration:1.0
                 animations:^{
                     float offset = screenWidth / 2.0 - (visibleViews * imgWidth / 2.0);
                     for (int i = 0; i < [[self imgViews] count]; i = i + 1) {
                         UIView *thisView = [[self imgViews] objectAtIndex:i];
                         if (![thisView isHidden]) {
                             CGRect rect = [thisView frame];
                             rect.origin = CGPointMake(offset, 0);
                             [thisView setFrame:rect];
                             offset = offset + rect.size.width;
                         } 
                     }
                 }
 ];

} 
```

问题是我想使用我分配给 UIImageViews 的特定宽度，并在中间集中在一起。我希望这对任何人都有帮助！

非常感谢！

# ruby - 使用 Ruby 将动态列表捕获到数组中

> ID：10490204
> 
> 赞同：0
> 
> 时间：2012-05-07T22:51:04.703
> 
> 标签：ruby, watir, selectlist

我已经重写了这个问题，使它更有意义。

有没有办法让 Ruby 监听网页上新创建的（动态）选择列表并将该列表保存到数组中？

这将是这样的场景：

1.  用户选择分行编号，02
2.  用户选择一个人类型，传教士
3.  生成一个新的传教士名字动态选择列表

Ruby 需要捕获动态创建的名称列表并将它们保存到一个数组中。这是到目前为止的代码：

```
missionaries = Array.new

browser.select_list(:id,'branch_select').select_value('02')
browser.select_list(:id,'user_type_select').select_value('1') # 1 = Missionary
browser.select_list(:index,2).click # <-This is the dynamically created list
missionaries = browser.select_list(:index,2) # <-This is just a guess, doesn't work
puts "Missionary List: " + missionaires.to_s # <-Prints to verify list saved 
```

这实际上打印到屏幕上的是：

```
 Missionary List: #<Watir::Select:0x147e54e> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:02:13.483

有许多不同的 ruby​​-tastic 方法可以将信息收集到数组（如收集等），这里有一个：

```
@myArray = Array.new

@browser.select_list(:how, what).options.each do |option|
  @myArray << option
end 
```

由于“选项”为您提供了数组格式的所有选项，您也可以（并且可能应该）这样做：

```
@myArray = @browser.select_list.options 
```

根据您的评论进行更新 - 该代码生成了您正在寻找的列表，但您没有指定您要使用它做什么。您看到的输出是列表的 Ruby 对象格式。以与我们迭代上述项目相同的方式，您可以迭代您的数组选项：

```
@num = 0
@myArray.each do |option|
   @num += 1
   puts "#{@num}. option"
end 
```

*   输出看起来像：
    1.  棒球
    2.  篮球
    3.  水下编篮

您可以将它们写入文件、控制台、保存等。这些都是 Ruby 要做的简单事情。希望有帮助！

根据您的评论更新#2：我相信您需要简化您对应用程序的思考方式。我们不再谈论传教士或篮球，甚至是网页。由于我们已经确定了您需要访问的对象（select_list），并将其数据提取到一个数组中，我们现在可以对其执行操作。

我们有一个数组。我们知道这个 Array 包含 select_list 中的所有单个选项。我们可以使用任何 Ruby 数组方法然后对这些数据做*一些事情*。如果我们想要选项总数：

```
@myArray.length
(basically, @browser.select_list.options.length) 
```

同样，您可以使用此数组 delete_at，您可以对其内容重新排序，或者您可以像我在更新 #1 中所做的那样显示每个项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T18:44:34.183

为了扩展我的评论，我找到了一个我认为您在获得返回给您的选项数量时遇到的问题的示例

b 是我的浏览器实例，因为我很懒。

```
b.goto("http://remysharp.com/wp-content/uploads/2007/01/select.html")
b.select_list(:id => "ctlJob").select("Developer")
puts b.select_list(:id => "ctlPerson").options.count
=> 3 
```

所以在我上面的例子中，它输出 3（我期待 2），因为当时动态列表还没有时间更新。刷新内容通常需要一秒钟或更长时间。如果我将示例调整为等待，它应该（并且确实）为我返回正确的数字。

```
b.goto("http://remysharp.com/wp-content/uploads/2007/01/select.html")
b.select_list(:id => "ctlJob").select("Developer")
sleep 5
puts b.select_list(:id => "ctlPerson").options.count
=> 2 
```

这次您获得了正确数量的选项，因为它有时间更新列表中的选项（在睡眠期间），因此当您要求 Watir 给您计数时，它会返回正确的数字，而不是“过时”的数字。

但让我们面对现实吧，睡觉是魔鬼。根据我的经验，明智的做法是不要在“这是我遇到的时间问题吗？”之外使用睡眠。调试情况。

那么我们怎样才能改善上面脚本的行为呢？在计算选项之前给它一个等待的条件。

```
b.goto("http://remysharp.com/wp-content/uploads/2007/01/select.html")
original_option = b.select_list(:id => "ctlPerson").options[1].text
b.select_list(:id => "ctlJob").select("Developer")
# Pay attention to the line below
b.wait_until{b.select_list(:id => "ctlPerson").options[1].text != original_option}
puts b.select_list(:id => "ctlPerson").options.count 
```

所以在上面的例子中，它会等到第一个选项的文本发生变化，然后才会计算列表中的选项。我选择 options[1] 因为通常有一个“选择...”默认选项，所以如果你使用 0 它会等到它在很多情况下超时。

所以，是的，我认为此页面上的许多其他答案都为计数返回 0，因为当 Watir 查看选择列表时，它确实是空的，并且只有**在**页面动态更新列表之后。

编辑：

因此，作为一个示例，您可以根据您提供的示例来了解它

```
browser.select_list(:id,'branch_select').select_value('02')
browser.select_list(:id,'user_type_select').select_value('1') # 1 = Missionary
# Im not sure you need to click here at all
browser.select_list(:index,2).click # <-This is the dynamically created list
# As the other answers were all returning zero, lets wait until the option count is higher
browser.wait_until{browser.select_list(:index,2).options.count > 0}
missionaries = browser.select_list(:index,2).options.count
# Potentially minus 1 if there's a "Select..." option
assert(missionaries == number_im_expecting) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T18:24:18.830

尝试这个：

```
missionaries = Array.new

browser.select_list(:id,'branch_select').select_value('02')
browser.select_list(:id,'user_type_select').select_value('1') # 1 = Missionary
browser.select_list(:index,2).click # <-Assuming this is the dynamic list
missionaries = browser.select_list(:index,2).options.collect{ |x| x.text } #Create an array containing the text of each option in the dynamic list
puts "Missionary List: " + missionaires.to_s # <-Prints to verify list saved
puts missionaires.length # <-Prints number of options in dynamic list 
```

请注意，这基本上是亚当的建议，基于以下假设进行了一些改进：

1.  您对选项集合不感兴趣。相反，您需要一个包含动态下拉列表文本的数组。
2.  根据您对 的输出`missionaires.to_s`，您使用的是 Watir-Webdriver，而不是经典的 Watir。根据我的测试，OptionCollection.to_s 在 Watir 和 Watir-Webdriver 之间给出了不同的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T20:29:02.590

好的，我已经想通了。该列表由 JSON 调用动态填充。我必须首先弄清楚选择第二个列表项（在本例中为传教士）时会发生什么。一旦选择了它，就会发送一个 GET 请求，然后接收一个 JSON 字符串。

该字符串必须由 Ruby 使用 open-uri gem/library 捕获。然后使用 json gem 解析。之后，我使用正则表达式来计算找到新 id 的次数。这是新代码：

```
browser.select_list(:id,'branch_select').select_value('01')
browser.select_list(:id,'user_type_select').select_value('1') 
browser.select_list(:index,2).click
json = open("http://10.5.26.9:8080/MissionaryLetters/getUsers?branchID=01&userTypeID=1").read
json = JSON.parse(json)
puts json
missionaries = json.to_s.scan(/id\d/).length
puts missionaries 
```

这将打印在分部中发现的传教士数量，在本例中为 16。

# java - MongoDB 和 upsert 问题

> ID：10490205
> 
> 赞同：2
> 
> 时间：2012-05-07T22:51:06.827
> 
> 标签：java, mongodb

我有两个模型：

1-资源假期：

```
 @Id
    private String resourceID;
    private List<Vacation> vacationList; 
```

2-假期：

```
@Id
private String id;
private String start;
private String title; 
```

我插入 ResourceVacation 后的 JSON：

> {“_id”：“foo”，“_class”：“com.test.model.ResourceVacation”，“vacationList”：[{“_id”：“1”，“start”：“abc”，“title”：“测试” } ] }

我需要更新假期；如果我需要的资源 ID 已经存在于 ResourceVacation 中，请将“vacationList”替换为我拥有的 json。

ELSE：插入一个新的 ResourceVacation

```
 Vacation vacation = new Vacation("a", "a", "a");
    List<Vacation> list = new ArrayList<Vacation>();
    list.add(vacation);

    ResourceVacation resourceVacation = new ResourceVacation("foo", list);
    MongoOperations mongoOperations = mongoConfiguration.getMongoTemplate();
    DBCollection db = mongoOperations.getCollection("resourceVacation");

    BasicDBObject myQuery = new BasicDBObject("_id", resourceVacation.getResourceID());
    BasicDBObject myUpdate = new BasicDBObject("push ", new BasicDBObject("vacationList",
            resourceVacation.getVacationList()));

    db.update(myQuery, myUpdate); 
```

我得到以下异常：

```
java.lang.IllegalArgumentException: can't serialize class com.springway.model.Vacation 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T07:05:30.510

首先，看起来你根本没有在做一个 upsert。Java API 中的语法将 db.update 的第三个参数设置为 true。

```
 db.update(com.mongodb.DBObject, com.mongodb.DBObject, boolean /*upsert */, boolean /* multi */) 
```

你也不应该做 $push - 你说你想在 mongo shell 中做的语义是：

```
db.collection.update( {"resourceVacation":resourceID}, {$set:{"vacationList":[...]}, true) 
```

这表示：如果存在具有 resourceID 的 resourceVacation，则将其“vacationList”设为我给您的内容。如果它不存在，则插入此记录。

如果您直接使用 Java API，那么上面的等价物就足够了。

看起来您正在使用 Spring 中的 MongoTemplate。您需要检查您使用的是哪个版本，因为它没有用于允许[upserts](https://jira.springsource.org/browse/DATAMONGO-308)。该问题被标记为已解决。如果您卡在旧版本上，那么这里描述了一种解决[方法](http://forum.springsource.org/showthread.php?115184-MongoDB-unvailable-quot-upsert-quot-update)。

如果你是最新的，你应该可以直接使用新添加的 upsert 方法，如此[处](http://static.springsource.org/spring-data/data-mongo/docs/current/api/org/springframework/data/mongodb/core/MongoTemplate.html#upsert%28org.springframework.data.mongodb.core.query.Query,%20org.springframework.data.mongodb.core.query.Update,%20java.lang.String%29)所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:55:17.473

该异常可能是由 updateFirst 方法的已知错误引起的。看看[这里](http://forum.springsource.org/showthread.php?108678-Can-t-serialize-an-embedded-object)。

# asp.net - 列组之间的柱形图间距和/或 x 轴上的列对齐方式

> ID：10490207
> 
> 赞同：2
> 
> 时间：2012-05-07T22:51:18.317
> 
> 标签：asp.net, data-visualization, alignment, asp.net-charts

不幸的是，我没有足够的声誉点来发布图片，所以这里有一个[示例图表](http://i.imgur.com/0Ayyj.png "图表输出的示例图像")的链接。

有谁知道我怎样才能让这个图表中的列与 x 轴正确对齐？图表上的大多数列甚至都不靠近它们各自的 x 轴标签。如果您查看我的示例，前两列*应该*与 2005 年的 x 轴对齐，但它甚至没有显示在图表中。与最后一列相同。那个也没有出现在图表中，但是，它应该与 2015 年的 x 轴对齐。

我已经在这个问题上工作了很长一段时间。我发现的所有可能的解决方案（包括这里的 SO）都没有为我工作。

这是我为生成示例输出而编写的代码：（标记）

```
<div style="width:100%;">
    <div>        
        <asp:Chart ID="chEmpTRI" runat="server" Width="600px">
            <series>
            </series>
            <chartareas>
                <asp:ChartArea Name="ChartArea1">
                </asp:ChartArea>
            </chartareas>
        </asp:Chart>
        <asp:SqlDataSource ID="sdsEmpTRI" runat="server" 
            ConnectionString="<%$ ConnectionStrings:ConnectionString1 %>" 
            SelectCommand="
                SELECT 
                    [Desc], 
                    [Year], 
                    [Value] 
                FROM [vw_EmpTRI] 
                --WHERE [Year] BETWEEN 2005 AND 2007
                ORDER BY [Year], [Desc]">
        </asp:SqlDataSource>        
    </div>
</div> 
```

（代码后面）

```
 int? min = 0, max = 0;
protected void Page_Load(object sender, EventArgs e)
{        
    DataView dv = sdsEmpTRI.Select(DataSourceSelectArguments.Empty) as DataView;
    if (dv != null)
    {
        min = dv.Table.Compute("Min(Year)", string.Empty) as int?;
        max = dv.Table.Compute("Max(Year)", string.Empty) as int?;

        if (min.HasValue && max.HasValue)
        {
            for (int i = min.Value; i <= max.Value; i++)
            {
                dv.RowFilter = String.Format("[Year] = {0}", i);
                foreach (DataRowView drv in dv)
                {                                              
                    Decimal? value = drv.Row.Field<Decimal?>("Value");
                    Series s = new Series(String.Format("{0}_{1}", drv.Row.Field<string>("Desc"), i));
                    s.ChartType = SeriesChartType.Column;
                    s.XValueType = ChartValueType.Int32;                       
                    DataPoint p = new DataPoint(s);
                    p.XValue = i;
                    p.YValues = new double[] { value.HasValue ? decimal.ToDouble(value.Value) : double.NaN };
                    s.Points.Add(p);
                    s.SetCustomProperty("PixelPointWidth", "150");
                    s.SetCustomProperty("PointWidth", "1");
                    s.Label = String.Format("{0}", value);
                    chEmpTRI.Series.Add(s);
                }
            }
        }
    }
} 
```

我尝试使用自定义属性 s.SetCustomProperty("PointWidth", "1") 来尝试减少列组之间的间距，但这并没有任何影响。有没有人对如何排队有任何建议？

# html - CSS用日语渲染？

> ID：10490216
> 
> 赞同：3
> 
> 时间：2012-05-07T22:52:15.777
> 
> 标签：html, css, character-encoding

*注意：我继承了这个网站，我没有建立它。*

主页突然不工作了。看起来这是一个CSS问题。当我进入 Safari(Mac) 中的网络检查器时，我点击打开 CSS，它显示了一堆看起来像日本字符的东西。不知道会发生什么。除了进行一些基本的内容（HTML）更改之外，我从未对该站点做过很多事情。他们说也没有其他人在做出改变。该站点的其余部分使用不同的样式表，并且工作正常。有任何想法吗？这是[网站](http://millionmightymen.com/)。提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T03:32:16.533

问题是由 HTML 文档的编码引起的：它是 UTF-16LE 编码的。您可以看到这一点，例如在 Firefox 上打开它，通过查看菜单检查正在应用的编码，然后通过该菜单手动将编码更改为 ISO-8859-1。您会看到，当解释为 ISO-8859-1 时，文档以“ÿþ”开头，这是 UTF-16 中的字节顺序标记。（这会覆盖`meta`声称文档为 ISO-8859-1 编码的标签的效果。）

由于外部 CSS 文件没有关于 HTTP 标头或文件内容中编码的信息提供服务，因此浏览器将不得不做出猜测。IE 正确猜测它是 Ascii 编码，但其他浏览器使用 HTML 文档的编码。如果您使用两个 Ascii 字符并将它们解释为 UTF-16 代码单元，您通常会得到一个中文 (CJK) 字符。

由于 UTF-16 通常不应该在 Web 上使用，解决方法是在编辑器中打开 HTML 文档，并将其保存为 ISO-8859-1 编码或类似的编码，例如 windows-1252。例如，在记事本上，使用“另存为”并选择“ANSI”格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-18T08:51:03.837

这里的回答方迟到了，但我找到了另一种解决方案，可以在 html 正在呈现但 css 文件以日文（或中文我不确定！）特殊字符出现的情况下工作。

解决方案对我来说更简单：

我将属性 charset="UTF-8" 添加到在 Html 文件中导入 css 文件本身的行中。

这对我有用，因为它解决了在 chrome 检查器源视图中以日语打开 css 文件的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:07:54.917

汉字通常是不正确的 Unicode 编码的结果（Unicode 本质上是 ASCII 之后出现的），可能是 UTF-16。如果我在 Chrome 中的选项卡下查看该[文件](http://millionmightymen.com/css/global-index.css)，它看起来很正常，但如果我在 Chrome 的检查器/控制台中查看它，它看起来像乱码。 ~~只需保存文件的副本，下载[Notepad++](http://notepad-plus-plus.org/)之类的内容，安装、运行并打开文件，然后尝试使用不同的 UTF 编码或 Ascii 保存*它的副本*，将您的 html 链接到它，看看是否有帮助.~~

编辑：

~~或者地狱，我为什么要你这样做，当我可以使用[pastebin](http://pastebin.com/5hUn36UY) < - 请注意链接，我只是为你粘贴了我的副本。~~

Jukka 的建议似乎很合理。问题似乎不是css文件而是html文档。我的编辑推荐应该有效，但许多其他编辑也应该如此。（我几乎想删除这个答案，但我认为指出一个常见错误可能很有用。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-21T03:06:24.687

I know I'm late but here it goes: Exactly WHAT is causing the issue, I'm not sure, but ultimately, its an issue with the character set. The solution above worked for me ("I added the property charset="UTF-8" to the line that imports the css file itself in the Html file"), probably because specifying the charset directly in the CSS link overrides whatever the issue is.

# javascript - 如何摆脱谷歌偏好脚本？

> ID：10490218
> 
> 赞同：4
> 
> 时间：2012-05-07T22:52:46.333
> 
> 标签：javascript, safari, preferences

我总是在我的浏览器 Safari 的源代码中看到这一点，尽管它不是页面源代码的一部分——就像 Safari 总是把它放在其他部分的前面一样。

```
<script type="text/javascript">window["_gaUserPrefs"] = { ioo : function() { return true; } }</script> 
```

我在某处读到它用于将浏览行为的偏好发送给谷歌，但我不知道这是否属实。

无论如何：我怎样才能摆脱它？

谢谢！

丹尼斯

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-07T22:55:57.510

这是导致它的浏览器扩展。

[https://tools.google.com/dlpage/gaoptout](https://tools.google.com/dlpage/gaoptout)

要摆脱该行，请确保您没有安装此扩展程序。

# spring-webflow - 动态网络流配置

> ID：10490227
> 
> 赞同：2
> 
> 时间：2012-05-07T22:54:27.700
> 
> 标签：spring-webflow

有什么方法可以更新 webflow 配置并重新加载它以动态影响 web 应用程序的流程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T09:43:11.857

因此，您希望 webflow 动态获取对您的流定义所做的更改？WebFlow 2 添加了对此的支持，在您的 flow-builder-services 中指定“development="true"，如下所示：

```
<flow:flow-builder-services id="flowBuilderServices"
                                view-factory-creator="viewFactoryCreator"
                                conversion-service="customConversionService"
                                development="true"/> 
```

这是文档中的部分：http: [//static.springsource.org/spring-webflow/docs/2.3.x/reference/htmlsingle/spring-webflow-reference.html#flow-registry-builder-services](http://static.springsource.org/spring-webflow/docs/2.3.x/reference/htmlsingle/spring-webflow-reference.html#flow-registry-builder-services)

> **development**：将此设置为 true 以打开流开发模式。开发模式开启流定义更改的热重载，包括对依赖流资源（如消息包）的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T16:13:12.833

如果您的意思是 webflow 配置流定义 xml，您可以将它们放入 WEB-INF 文件夹中。在这里您可以更新它们，应用程序将使用实际版本。

# web-services - Sharepoint RunWithElevatedPrivileges 与模拟

> ID：10490228
> 
> 赞同：1
> 
> 时间：2012-05-07T22:54:40.210
> 
> 标签：web-services, sharepoint, impersonation

我花了几个小时处理一个奇怪的“错误”，该错误涉及来自 .NET Web 服务的请求 AD 信息用户权限的 Web 方法。

好消息是我修复了这个错误，但我会理解为什么更正是有效的。

**有 bug 的 web 方法如下：**

```
public bool ValidateTask(string originatingUser)
{
    SPUserToken userToken = null;

    // get the System account for impersonation
    string userToken = site.SystemAccount.UserToken; 
    using (SPSite rootSite = new SPSite(site.ID, userToken)) 
    {
        using (SPWeb web = rootSite.OpenWeb()) 
        {
            // get the domain name of the application pool of the web app
            string servicesDomain = 
                StringUtilities.GetDomain(site.WebApplication.ApplicationPool.ManagedAccount.Username);
            // get the domain name of the user
            string accountsDomain = StringUtilities.GetDomain(originatingUser);

            PrincipalContext ServicesDomainContext = 
                new PrincipalContext(ContextType.Domain, servicesDomain);
            PrincipalContext AccountsDomainContext = 
                new PrincipalContext(ContextType.Domain, accountsDomain);

            // COMException when the FindByIdentity is called because 
            // AccountsDomainContext.connectedServer throw exception
            using (UserPrincipal usr = 
                UserPrincipal.FindByIdentity(AccountsDomainContext, IdentityType.SamAccountName, originatingUser))
            {
            // get user groups memberships
            }
        }
        // check groups memberships and return the true or false
    }
} 
```

**带校正的 web 方法如下：**

```
public bool ValidateTask(string originatingUser)
{
    SPSecurity.RunWithElevatedPrivileges(
        delegate ()
        {
            ...
            using (SPSite rootSite = new SPSite(site.ID))
            {
                using (SPWeb web = rootSite.OpenWeb())
                {
                    // get the domain name of the application pool of the web app
                    string servicesDomain = 
                        StringUtilities.GetDomain(site.WebApplication.ApplicationPool.ManagedAccount.Username);
                    // get the domain name of the user
                    string accountsDomain = StringUtilities.GetDomain(originatingUser);

                    PrincipalContext ServicesDomainContext = 
                        new PrincipalContext(ContextType.Domain, servicesDomain);
                    PrincipalContext AccountsDomainContext = 
                        new PrincipalContext(ContextType.Domain, accountsDomain);

                    using (UserPrincipal usr = 
                        UserPrincipal.FindByIdentity(AccountsDomainContext, IdentityType.SamAccountName, originatingUser))
                    {
                    // get user groups memberships
                    }
                }
            }

           // check groups memberships and return the true or false
        }
    ); // end of delegate method
} 
```

==================================================== ==========================

在 sharepoint 中，我认为 Impersonation 和 RunWithElevatedPrivilege 会产生相同的结果。所以我的问题是：

1- 那么为什么 RunWithElevatedPrivilege 有效？

2-当我们在 WebMethod 上下文中提升权限时，凭证是什么？这是 SharePoint Web Services Root 的身份池帐户？

3-我可以追踪这两种方法的凭据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T08:12:49.920

RunWithElevatedPrivileges 在新线程中运行代码。这个新线程在当前应用程序池的帐户下运行。如果您在[http://localhost/_vti_bin/yourservice](http://localhost/_vti_bin/yourservice)下调用它，则应用程序池是端口 80 上的 Web 应用程序的应用程序。使用带有用户令牌的新 SPSite 仅在定义的用户的上下文中打开 SPSite 并执行不启动新线程。您可以通过调用 WindowsIdentity.Current 来跟踪当前用户

# c# - 获取 insertbatch 命令插入的每个对象的返回状态

> ID：10490241
> 
> 赞同：0
> 
> 时间：2012-05-07T22:56:27.443
> 
> 标签：c#, mongodb, mongodb-.net-driver

我正在为 Mongo Db 使用 C# 驱动程序。我想使用 insertbatch 命令向它传递一个对象列表（IList）。对于插入的每个对象，我想知道结果状态（是否成功插入）。我看到 insertbatch 只为它插入的每个 16MB 块返回一个 SafeModeResult 对象。如果我想使用 insertbatch 命令并为我插入的每个对象获取返回状态，对我来说最好的方法是什么？

对于使用返回多个元素的查询从集合中删除元素，同样的问题也随之而来。我想知道我删除的每个元素是否已成功删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T05:20:30.640

首先，确保安全模式已打开。最简单的方法是在连接字符串中设置 SafeMode：

var connectionString = "mongodb://localhost/?safe=true";

如果 InsertBatch 完成且未引发异常，则您知道所有文档均已插入且没有错误。

如果 InsertBatch 引发异常，则它在批处理的中途失败。不幸的是，服务器没有报告在失败之前它进入了多少批次，您将查询数据库以查看是否插入了特定文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T05:23:53.330

对于 Remove 类似，如果 Remove 完成且未引发异常，则您知道所有匹配的文档都已成功删除。

如果服务器报告错误（假设 SafeMode 已打开），则 Remove 会引发异常。但是，服务器不会报告它是否删除了任何文档。使用传递给 Remove 的相同查询调用 Find 将检索所有未删除的文档。

# ruby-on-rails - 如何将值从视图传递到另一个视图以填充 Rails 3 中的另一个表单

> ID：10490242
> 
> 赞同：1
> 
> 时间：2012-05-07T22:56:33.183
> 
> 标签：ruby-on-rails

如何将值从视图传递到另一个视图以填充 rails 3 中的另一个表单？

我是rails新手，我对如何实现这一点有点困惑，这是我的场景：

我生成了一个客户和一个销售脚手架，然后在客户索引视图中放置了一个搜索文本字段，用于搜索客户并将其呈现在其下方。每个客户都有一个名为“销售”的按钮，单击它时应将您重定向到 new_sales_path 并使用客户的值自动填写表单的某些字段，例如：姓名、地址、ID、电话号码等...

所以我想要做的是：我想在单击按钮 Sale 时传递客户的信息，然后污染 new_sales 表单。

所以我在索引客户端视图中有这个代码：

```
<%= form_tag clientes_path, :method => 'get', :id => "clientes_search", :class => "form-search" do %>
<p>
<%= text_field_tag :search, params[:search], :class => "input-medium search-query" %>

<%= submit_tag "Search", :name => nil, :class => "btn" %>

<% @clients.each do |client| %>
<tr>
<td><%= client.id %></td>
<td><%= client.email %></td>
...
...
<%= link_to t('.edit', :default => t("helpers.links.edit")),
                  edit_client_path(client), :class => 'btn btn-mini' %>
<%= link_to "Sale", new_sale_path, :action => 'sale_button', :id => 'sale_button', :class => 'btn btn-mini' %>
<% end %>
</tr>
<% end %> 
```

在我的应用程序助手中，我有：

```
def sale_button
@sale_button = client
end 
```

在我的客户和销售控制员中，我有这样一行：

```
helper_method :sale_button 
```

在我的新销售视图中，我有

```
<div id='sales'>
<%= simple_form_for @sale, :html => { :class => 'form-horizontal' } do |f| %> 
<%= f.input :client, :label => "Client ID", :required => true, :as => :string, :input_html => { :value => @sale_button.id } %>
...
... 
<% end %> 
```

我不知道我是否以正确的方式做这件事，或者我是否缺少某些东西，欢迎提供任何帮助或意见。

我正在使用 Rails 3.2 顺便说一句

* * *

销售总监

```
class SalesController < ApplicationController
before_filter :authenticate_user!
helper_method :sort_column, :sort_direction
helper_method :boton_venta

  # GET /sales
  # GET /sales.json
  def index
    @sales = Sale.search(params[:search]).order(sort_column + " " + sort_direction).paginate(:per_page => 10, :page => params[:page])
    @lista_porcentajes = Porcentaje.all
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @sales }
      format.js
    end
  end

  # GET /sales/1
  # GET /sales/1.json
  def show
    @sale = Sale.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @sale }
    end
  end

  # GET /sales/new
  # GET /sales/new.json
  def new
    @sale = Sale.new
    @client = Client.find(params[:client_id])
    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @sale }
      format.json { render json: @client }
    end
  end

  # GET /sales/1/edit
  def edit
    @sale = Sale.find(params[:id])
  end

  # POST /sales
  # POST /sales.json
  def create
    @sale = Sale.new(params[:sale])

    respond_to do |format|
      if @sale.save
        format.html { redirect_to @sale, notice: 'Sale was successfully created.' }
        format.json { render json: @sale, status: :created, location: @sale }
      else
      format.html { render action: "new" }
        format.json { render json: @sale.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /sales/1
  # PUT /sales/1.json
  def update
    @sale = Sale.find(params[:id])

    respond_to do |format|
      if @sale.update_attributes(params[:sale])
        format.html { redirect_to @sale, notice: 'Sale was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @sale.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /sales/1
  # DELETE /sales/1.json
  def destroy
    @sale = Sale.find(params[:id])
    @sale.destroy

    respond_to do |format|
      format.html { redirect_to sales_url }
      format.json { head :no_content }
    end
  end

  private

  def sort_column
    Sale.column_names.include?(params[:sort]) ? params[:sort] : "id"
  end

  def sort_direction
    %w[asc desc].include?(params[:direction]) ? params[:direction] : "asc"
  end
end 
```

路线.rb

```
Puntodeventa::Application.routes.draw do

  resources :empresas

  resources :cliente_grupo_empresas

  devise_for :users, :admin_empresas, :empresa_users, :cliente_users, :admins

  resources :relacion_porcentaje_grupoempresas

  resources :relacion_grupo_empresas

  resources :porcentajes

  resources :categoria_empresas

  resources :grupo_empresas

  resources :sales

  resources :cliente_empresas

  resources :clients

  get "home/index"

  resources :productos

  root :to => "home#index" 
```

耙路线

```
sales GET    /sales(.:format)                                      sales#index
                                  POST   /sales(.:format)                                      sales#create
                         new_sale GET    /sales/new(.:format)                                  sales#new
                        edit_sale GET    /sales/:id/edit(.:format)                             sales#edit
                             sale GET    /sales/:id(.:format)                                  sales#show
                                  PUT    /sales/:id(.:format)                                  sales#update
                                  DELETE /sales/:id(.:format)                                  sales#destroy 
```

销售 new.html.erb

```
<%- model_class = @sale.class -%>
<h1><%=t '.title', :default => t('helpers.titles.new', :model =>     model_class.model_name.human,
                               :default => "New #{model_class.model_name.human}") %>      </h1>
<%= render :partial => 'form' %> 
```

在 sales new.html.erb 中呈现的表单

```
 <div id='sales'>

<%= simple_form_for @sale, :html => { :class => 'form-horizontal' } do |f| %>

  <%= f.input :client, :label => "Serial del cliente", :required => true, :as => :text, :input_html => { :value => ' ' } %>
  <%= f.association :client, :label_method => :nombre, :label_value => :id, :required => true, :as => :string %>
  <%= f.association :porcentaje, :label_method => :porcentaje, :value_method => :porcentaje, :required => true %>
  <%= f.input :monto_venta, :required => true, :as => :string %>
  <% if current_user.try(:admin?) %>
  <%= f.association :empresa, :label_method => :nombre, :value_method => :id, :required => true %>
  <% else %>
  <% f.association :empresa, :disabled => true, :input_html => { :value => current_user.empresa_id } %>
  <% end %>
  <div class="form-actions">
    <%= f.button :submit, :class => 'btn-primary' %>
    <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
                sales_path, :class => 'btn' %>
  </div>
<% end %>

</div> 
```

具有您建议的修改的新销售视图。

```
<table class="table table-striped">
  <thead>
    <tr>
      <th><%= sortable "id", "Id" %></th>
      <th><%= sortable "name", "Name" %></th>
      <th><%= sortable "grupo_empresa", "Grupo" %></th>
      <th><%= sortable "telefono", "Telefono" %></th>
      <th><%= sortable "celular", "Celular" %></th>
      <th><%= sortable "email", "Email" %></th>
      <th><%= sortable "serial_cliente", "Serial del cliente" %></th>
      <th><%= sortable "puntos_cliente", "Puntos del cliente" %></th>
        <th><%= sortable "created_at", "Creado el" %></th>
        <th><%=t '.actions', :default => t("helpers.actions") %></th>
    </tr>
  </thead>
  <tbody>
    <% @clients.each do |client| %>
      <tr>
        <td><%= client.id %></td>
        <td><%= link_to client.nombre, client_path(client) %></td>
        <td><%= client.grupo_empresa.nombre %></td>
        <td><%= client.telefono %></td>
        <td><%= client.celular %></td>
        <td><%= client.email %></td>
        <td><%= client.serial_client %></td>
          <td><%=l client.created_at %></td>
        <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                      edit_client_path(client), :class => 'btn btn-mini' %>
        <%= link_to "Sale", new_sale_path, :client_id => client.id , :id => 'boton_venta', :class => 'btn btn-mini' %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T15:01:44.757

仔细听，

以下链接“销售”应该在您的应用程序中的某个位置。

```
<%= link_to "Sale", new_sale_path, :client_id => client.id , :class => 'btn btn-mini' %> 
```

如果用户单击该链接，link_to 方法会检查路径，并且您已将其称为“new_sale_path”

从你的**“耙路线”，**

```
new_sale GET    /sales/new(.:format)                                  sales#new 
```

很明显 new_sale_path 指的是 sales#new(sales controller, new action)

如果你添加下划线路径，rails 会处理这个问题。例如，edit_sale_path 将执行销售控制器，编辑操作/方法。

在这一步之后，由于执行了 sales 控制器中的新操作，rails 将在 app/views/sales 中查找“new.html.erb”文件。

如果存在，该 html.erb 文件将在您的浏览器中显示/呈现。

您应该了解上述工作。

现在，让我们具体一点。

单击该销售链接时，应用程序会到达 sales#new 操作，其中 :client_id 作为 params 哈希中的参数。

您可以按如下方式访问该参数哈希，

```
@client = Client.find(params[:client_id]) 
```

你已经做到了。上述语句将传递的 :client_id 作为输入，并使用 Client 模型和 find 方法从数据库中找到正确的客户端。

现在，实例变量已设置为与 :client_id 匹配的 Clients 表中的记录。

实例变量是@client。

现在，在您看来，您可以按如下方式使用实例变量@client，您还没有这样做，或者我没有看到。app/views/sales/_form.html.erb 中有什么？

也请张贴。

```
<%- model_class = @sale.class -%>
<h1><%=t '.title', :default => t('helpers.titles.new', :model =>     model_class.model_name.human,
                               :default => "New #{model_class.model_name.human}") %>      </h1>
<%= render :partial => 'form' %> 
```

如果您使用如下的 form_for，

```
<% form_for @client do |client| %>

<% text_field_tag client.name %>
-
-
-

<% end %> 
```

将有一个 text_field 将预先填充客户的姓名。

如果你有什么不明白的，请告诉我。

If you understood few things and couldn't figure out few things, tell me.

If you understood everything, tell me.

Thanks.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:12:12.650

**将 client_id 作为参数传递给此链接，如下所示，**

```
 <%= link_to "Sale", new_sale_path, :client_id => client.id , :class => 'btn btn-mini' %> 
```

确保 new_sale_path 击中销售控制器，新操作。

在新操作中，以 params[:client_id] 的形式访问 client_id 并获取当前客户端记录并呈现如下表单，

```
SalesController

def new
 @client = Client.find(params[:client_id])
 -
 -
 -
 render 'new'
end 
```

在您看来，new.html.erb，您必须编写一个 form_for @client 作为，

```
<% form_for @client do |client| %>

<% text_field_tag client.name %>
-
-
-

<% end %> 
```

现在，我不确定我的语法。试着理解我在这里做什么。

谢谢。

# c++ - 虚函数和模板冲突

> ID：10490245
> 
> 赞同：4
> 
> 时间：2012-05-07T22:56:38.973
> 
> 标签：c++, templates, abstract-class, boost-serialization

我有一个 pointAccumulator 的抽象基类。这个抽象基础将填充有诸如返回所有点平均值的函数之类的方法。这两个类的示例如下所示：

```
class lala {
public:
    virtual someFunctions = 0;

    virtual bool isEmpty() = 0;
};

class lalaLower : public lala {
public:
    lalaLower(){}
    ~lalaLower(){}

    someFunctions

    template<class Archive> void serialize(Archive & ar, const unsigned int version) {
        ar & heights_;
    }

protected:
    std::deque<double> heights_;
}; 
```

正如您在代码中看到的那样，我还想使用 boost 序列化来保存这些类型。现在使用工厂模式，我相信您可以像这样调用 pointAccumulator 类型：

```
lala *a1 = new lalaLower(); 
```

我的问题是，如果我以这种方式调用模板化的序列化方法，它将无法访问。我也不能在抽象类中使用模板类，因为 c++ 不允许这样做。有没有办法解决这个问题？

编辑：

我已经考虑过序列化的非侵入式方法，但这需要公开 heights_ ，这并不理想，也不是良好的编程风格。我认为潜在的使用友元类或函数的方法可以通过访问变量来穿透类，同时仍然保持基类抽象？谁能解释这将如何工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T15:52:22.017

我认为使用朋友类或函数是一个很好的解决方案，您可以添加新类，如 Serializor

这是朋友功能的示例

```
class Serializor;
class meanAccumulator : public pointAccumulator 
{ 
public:     
meanAccumulator(){}     
~meanAccumulator(){}     
double getHeight();     
void addHeight(double Height);     
void setHeight(double Height);     
bool isEmpty(){ return heights_.empty(); }      

protected:     std::deque<double> heights_; 
friend int Serializor::Func1( Serializor& );

}; 
```

请参阅[http://msdn.microsoft.com/en-us/library/ahhw8bzz.aspx](http://msdn.microsoft.com/en-us/library/ahhw8bzz.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:29:54.577

我相信如果不`Archive`以这种或另一种方式将类型参数包装到多态层次结构中，你就无法做到这一点。

似乎`Boost.Serialization` [这对你有用](http://www.boost.org/doc/libs/1_49_0/libs/serialization/doc/archive_reference.html#polymorphic)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T04:29:24.220

您可能知道`template`s 和`virtual`方法不能齐头并进。

我建议删除该`meanAccumulator::serialize()`方法并添加到`class pointAccumulator`正文中，并`virtual`在需要的地方调用函数。
您还可以考虑传递派生类的句柄并用它调用方法。

```
class pointAccumulator {
public:
  template<class Archive, class Derived>
  void serialize(Archive & ar, const unsigned int version, Derived &derived)
  {                                            // optional ^^^^^^^^^^^^^^^^^
    // call virtual methods to derived from here
    // optional: for non-virtual method, you can use derived class handle
  }
}; 
```

您唯一需要注意的是，无论您在内部`serialize()`使用`derived`句柄 --> 调用的任何非虚拟方法在 的所有子类中都应具有相同的名称`pointAccumulator`，无论它们在内部做什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T18:25:20.063

事实上，我会让我的评论成为答案：

```
~/src/snips$ cat serializer-demo.cc 
#include <boost/archive/polymorphic_iarchive.hpp>
#include <boost/archive/polymorphic_oarchive.hpp>

typedef boost::archive::polymorphic_iarchive bpi;
typedef boost::archive::polymorphic_oarchive bpo;
typedef const unsigned int cui;

struct ABC
{
        virtual void serialize(bpi &ar, cui v) = 0;
        virtual void serialize(bpo &ar, cui v) = 0;
};

struct A : ABC
{
        void serialize(bpi &ar, cui v ) { ar & data; }
        void serialize(bpo &ar, cui v ) { ar & data; }
        int data;
        bool operator==(const A & rhs) const
                { return data == rhs.data; }
        A(int data=0) : data(data) {}
};

#include <sstream>
#include <boost/archive/polymorphic_text_iarchive.hpp>
#include <boost/archive/polymorphic_text_oarchive.hpp>

#include <boost/archive/polymorphic_binary_iarchive.hpp>
#include <boost/archive/polymorphic_binary_oarchive.hpp>
int main(int argc, char* argv[])
{
    const A a(1);
    const ABC &abc = a;
    A a1;
    ABC &abc1 = a1;
    {
        std::stringstream ss;
        {
            boost::archive::polymorphic_text_oarchive oa(ss);
            boost::archive::polymorphic_oarchive & oa_interface = oa; 
            oa_interface << abc;
        }
        {
            boost::archive::polymorphic_text_iarchive ia(ss);
            ia >> abc1;
        }
    }
    if(! (a == a1))
        return 1;
    {
        std::stringstream ss;
        {
            boost::archive::polymorphic_binary_oarchive oa(ss);
            oa << abc;
        }
        {
            boost::archive::polymorphic_binary_iarchive ia(ss);
            boost::archive::polymorphic_iarchive & ia_interface = ia; 
            ia_interface >> abc1;
        }
    }
    if(! (a == a1))
        return 1;
    return 0;
}

~/src/snips$ make -B serializer-demo
g++ -o bin/serializer-demo --std=c++0x -g -O -march=native -pipe -Wall -Wno-parentheses   -lboost_serialization  serializer-demo.cc
~/src/snips$ type -pa serializer-demo
./bin/serializer-demo
~/src/snips$ serializer-demo
~/src/snips$ echo $?
0
~/src/snips$ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-16T04:42:16.710

所以我有一种有趣的方式来为模板化的函数伪造虚拟化。[伪造一个虚拟模板函数c ++](https://stackoverflow.com/questions/10575457/faking-a-virtual-templated-function-c)

如果您需要在层次结构中强制执行此操作，则可能会在此处应用基本动机，但您可以利用 boost 元编程库来允许此问题的运行时解决方案。

# php - 如何在 drupal 7 中保存会话变量？

> ID：10490253
> 
> 赞同：6
> 
> 时间：2012-05-07T22:57:31.823
> 
> 标签：php, drupal, drupal-7, session-variables

我想使用变量会话（$_session），但它在 Drupal 7 中不起作用。为了保存变量会话，Drupal 7 中有哪些可能性。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-08T07:04:29.710

你可以试试这个。

```
function lists_session($key, $value = NULL) {
  static $storage;
  if ($value) {
    $storage[$key] = $value ;
    $_SESSION['lists'][$key] = $value ;   // I use 'lists' in case some other module uses 'type' in $_SESSION
  }
  else if (empty($storage[$key]) && isset($_SESSION['lists'][$key])) {
    $storage[$key] = $_SESSION['lists'][$key];
  }
  return $storage[$key];
} 
```

因此，要在 Session 中保存变量：

```
lists_session("s_key", "value"); 
```

要检索值，只需使用：

```
$myVar = lists_session("s_key"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-08T10:40:41.873

我在自己的模块中使用 $_SESSION 变量没有问题。请记住为您的数据创建一个唯一的子键。

```
$_SESSION['mydata'] = array(of your data); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-19T03:07:00.253

请记住在保存到会话之前序列化您的数据，例如数组，对象...。$arr = 数组（）；$_SESSION['mysession'] = serialise($arr);

# sql - SQLite：像 Oracle Decode 或 MS "If" 之类的东西

> ID：10490254
> 
> 赞同：3
> 
> 时间：2012-05-07T22:57:48.770
> 
> 标签：sql, oracle, sqlite

过去，在 SQL 查询的 SELECT stmt 中，我在 Oracle 中使用过“decode”，在 Microsoft 中使用过“iif”。

我一直在考虑将 SQLite 用于一个项目，但据我所知，SELECT stmt 中的条件很难。谷歌搜索提出了 CASE 的使用.. 但直观地说，这似乎性能不会很好，更不用说更难编码了。或者也许我不完全理解它。

任何人的想法或建议？我真的很想在这个项目中使用 SQLite。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-07T23:06:21.387

我认为案例同样易于使用。它对语法的熟悉可能会让您感到困扰，但这也同样有效。

```
CASE Gender WHEN 'F' then 'FEMALE'
            WHEN 'M' then 'MALE'
            ELSE 'UNDEFINED'
            END as GenderName 
```

或者

```
CASE WHEN GENDER = 'F' THEN 'FEMALE'
     WHEN GENDER = 'M' THEN 'MALE'
     ELSE 'UNDEFINED' 
     END as GenderName 
```

应该注意的是，CASE 几乎与 db 无关：解码、iif、if 和其他变体都不是。因此，如果您的查询需要在几个不同的数据库上工作；坚持大小写，因为它更有可能跨多个数据库平台工作。

# css - 给定同一行上的两个 div，在我为右 div 指定宽度后，如何让左 div 填充剩余的水平空间？

> ID：10490256
> 
> 赞同：1
> 
> 时间：2012-05-07T22:58:11.343
> 
> 标签：css, width

这是我对问题的抽象：http: [//jsfiddle.net/BsHpj/8/](http://jsfiddle.net/BsHpj/8/)

这是我在[另一个有效的线程](https://stackoverflow.com/questions/8094787/fixed-width-div-on-right-fill-remaining-width-div-on-left)中找到的一个：http: [//jsfiddle.net/QHTeS/2/](http://jsfiddle.net/QHTeS/2/)

为什么他的作品我想要而我的不想要？所有帮助表示赞赏。

这是我的不太抽象的版本：http: [//jsfiddle.net/nLn3A/](http://jsfiddle.net/nLn3A/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T23:04:30.653

您的版本不起作用，因为您浮动的是右侧的 div，而不是左侧的。所以左边的 div 占据了父容器的 100% 的宽度，并向下碰撞了右边的 div。如果您添加`float: left;`到左侧 div 和`float: right;`右侧 div，您应该看到它们在同一行，它们之间有一个间隙。

将浮点数视为将容器“收缩包装”到内容的大小。默认情况下，容器通常会占据父容器宽度的 100%。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T23:04:07.523

交换左右顺序。否则第一个 div 将填充所有水平空间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T09:15:54.680

我相信您正在寻找的是右侧的一个固定柱和左侧的一个流体。

方法1：左右交换顺序：http: [//jsfiddle.net/BsHpj/19/](http://jsfiddle.net/BsHpj/19/)这种方法涉及的CSS最少，但它意味着你必须让你的HTML不那么直观。（由林海德利）

方法2：使用margin-left 和margin-right： http: [//jsfiddle.net/VmaZr/14/](http://jsfiddle.net/VmaZr/14/)这个方法有很好的HTML，但涉及到更多的CSS代码。（动态驱动）

方法 3：将 div 格式化为表格： http: [//jsfiddle.net/BsHpj/9/](http://jsfiddle.net/BsHpj/9/)易于理解，但 CSS 多一点（作者 Oswaldo Acauan）。

# c - 从 ASCII 位模型到仅幅度位模型的转换

> ID：10490257
> 
> 赞同：-1
> 
> 时间：2012-05-07T22:58:11.420
> 
> 标签：c, ascii

本质上，我正在尝试编写代码来执行从变量 n 的 ASCII 位模型到变量 x 的仅幅度位模型的转换。我只是假设用户只输入了三位数字。这是我到目前为止所拥有的：

```
#include <stdio.h>
main()
{
  char n[10];
  int x;
  printf("Enter three digit, nonnegative: ");
  scanf("%s" ,n);
  .
  .
  .
  printf("The number is %d\n", x);
} 
```

任何帮助深表感谢。

编辑：仅幅度位模型：最简单的位模型用于非负整数。在这种情况下，每个位表示 2 的非负整数幂。位值 0 表示位值 0；位值 1 表示位值。通过将所有位的位置值相加来找到表示的数字的总值。示例：8位表示的值为19：0+0+0+16+0+0+2+1=19。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:38:45.447

虽然 BLUEPIXY 的答案在技术上完全符合您的要求，但它非常复杂，可能不是您想要的任何实际程序的答案，除非您参加的是混淆 C 比赛。您可能想要更多类似的东西：

```
int main() {
    int x;

    printf("Enter three digit, nonnegative: ");
    while (scanf("%d", &x) != 1 || x < 100 || x > 999) {
        printf("Not a valid input, try again: ");
        fflush(stdin);
    }
    printf("The number is %d\n", x);
    return 0;
} 
```

现在这与 BLUEPIXY 写的不同，接受不同的输入。特别是，它允许（并忽略）空格，将忽略数字后面的多余部分，如果前导数字为 0，甚至允许输入 4+ 位数字，因此最终数字最终为 100..999。如果您特别想禁止此类输入，则需要更像他所写的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-07T16:17:32.740

两个现有答案都使用`scanf`，这总是一个错误：在这种情况下，这是一个错误，因为**`scanf`如果用户输入太多输入数字，则会表现出未定义的行为**。我不是在编造这个。

在 C 中读取用户输入的更好方法是使用`fgets`（或者`getline`如果可用且需要考虑长行）一次读取整行，然后使用函数族将数字转换为二进制`strto*`，这与函数家族不同`scanf`， - 定义的输入溢出行为。它们还使得从其他类型的格式错误的输入中检测和恢复变得非常容易（在这种情况下这并不是一个真正的问题，但如果输入格式稍微复杂一点就会出现问题）。

```
#include <stdio.h>
#include <stdlib.h>
int main(void)
{
    char buf[10], *endp;
    unsigned long n;
    int c;
    for (;;) {
        fputs("Enter three digit, nonnegative: ", stdout);
        fgets(buf, sizeof buf, stdin);
        n = strtoul(buf, &endp, 10);
        if (n <= 999 && *endp == '\n')
            break;
        puts("?Redo from start");
        do c = getchar(); while (c != '\n' && c != EOF);
    }
    printf("The number is %lu\n", n);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:32:21.697

```
#include <stdio.h>

int main(void){
    char n[10];
    int x=0;
redo:
    printf("Enter three digit, nonnegative: ");
    if(4!=scanf("%1[1-9]%1[0-9]%1[0-9]%1[\n]", &n[0],&n[1],&n[2],&n[3])){
        fflush(stdin);
        goto redo;
    }
    //printf("%s\n",n);
    x = 100*(n[0]-'0')+10*(n[1]-'0')+(n[2]-'0');
    printf("The number is %d\n", x);
    return 0;
} 
```

# node.js - 代理而不重定向 node-http-proxy

> ID：10490259
> 
> 赞同：1
> 
> 时间：2012-05-07T22:58:25.567
> 
> 标签：node.js, proxy, node-http-proxy

我正在尝试使用 node-http-proxy 将我的网站代理到另一个网站，例如 google.com 每当我尝试他们在 github 上的文档中给出的一些示例而不是我的网站显示它只是重定向到的 google.com 的内容时google.com 这是我正在使用的代码

```
var proxy = require("http-proxy");
var options = {
   router: {
      "myserver.com" : "google.com"
   }
}
var proxyServer = proxy.createServer(options);
proxyServer.listen(80); 
```

我做错了，它只是为了反向代理？如果它是 node-http-proxy 中的什么允许我做常规代理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:38:54.540

因为 google.com 返回 301 重定向，它会将浏览器发送到不同的位置。在这种情况下，您可以只使用完整的 url (www.google.com)，它不会将 301 重定向发送回 www.google.com。重要的是，由于 google.com 正在发回 301 重定向，因此您必须使用重定向的网站而不是重定向客户端。例如，如果你运行`curl google.com`，你会看到一个 301 重定向，如果你只是运行`curl www.google.com`重定向是不存在的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T08:40:33.610

尝试 CodeRarity 的回答给了我：

```
> curl www.google.com    
<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">  
<TITLE>302 Moved</TITLE></HEAD><BODY>                                           
<H1>302 Moved</H1>                                                              
The document has moved                                                          
<A HREF="http://www.google.co.uk/">here</A>.                                    
</BODY></HTML> 
> 
```

如您所见，即使使用 www.google.com，您仍可能会收到重定向，具体取决于您所在的位置。

为什么不尝试一个不那么聪明的不同网站呢？

# directx - 如何使用 DirectInput 在我的游戏中创建聊天框？

> ID：10490260
> 
> 赞同：0
> 
> 时间：2012-05-07T22:58:50.567
> 
> 标签：directx, directinput

我能想到的唯一解决方案是检查正在按下哪个字符，然后在屏幕上显示该字符。然而，这让我觉得这真的很烦人，而且通常是一个糟糕的解决方案。我想不出另一种解决方案。我考虑过使用 Windows 消息循环而不是 DirectInput，但我仍然需要逐个字符地检查（除非我误解了某些东西），所以看起来我会遇到同样的问题。

有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T00:37:29.297

您可以创建一些类来帮助您：

*   一个“TextBuffer”，用于存储并提供对当前编辑的字符串（包括插入符号位置等）的键入操作。

*   一个“TextPanel”或“TextWidget”，它绘制/显示一个 TextBuffer 并在获得*焦点*时接收+转发按键消息。

在 UI 中编码输入“焦点”的概念有助于大大简化控制流。

# windows - 调整窗口大小时调整 Powershell 屏幕缓冲区的大小

> ID：10490261
> 
> 赞同：1
> 
> 时间：2012-05-07T22:58:50.500
> 
> 标签：windows, powershell, window

当我在窗口、最大化和半屏（例如`Win`+ `Left`）之间切换 Powershell 时，我仍然受到控制台属性（布局下）中指定的“内部”尺寸的限制，它完成的只是显示/隐藏滚动条。

有没有办法让它自动重新调整缓冲区大小？如果它可以优雅地处理在 Vim 或 SSH 中，则可以加分，但我不会抱有希望的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T05:37:16.930

尝试将其保存为 Console-sizing.ps1 （我在原始 powershell 控制台中使用它，不知道在 VIM 或 SSH 或其他控制台中是否有效！）

```
function Size($w, $h)
{
    New-Object System.Management.Automation.Host.Size($w, $h)
}

Write-Host '[Arrows] resize  [Esc] exit ...'
$ErrorActionPreference = 'SilentlyContinue'
for($ui = $Host.UI.RawUI;;) {
    $b = $ui.BufferSize
    $w = $ui.WindowSize
    switch($ui.ReadKey(6).VirtualKeyCode) {
        37 {
            $w = Size ($w.width - 1) $w.height
            $ui.WindowSize = $w
            $ui.BufferSize = Size $w.width $b.height
            break
        }
        39 {
            $w = Size ($w.width + 1) $w.height
            $ui.BufferSize = Size $w.width $b.height
            $ui.WindowSize = $w
            break
        }
        38 {
            $ui.WindowSize = Size $w.width ($w.height - 1)
            break
        }
        40 {
            $w = Size $w.width ($w.height + 1)
            if ($w.height -gt $b.height) {
                $ui.BufferSize = Size $b.width $w.height
            }
            $ui.WindowSize = $w
            break
        }
        27 {
            return
        }
    }
} 
```

**编辑：请阅读评论以了解[原始功能编码器](https://stackoverflow.com/users/323582/roman-kuzmin)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T11:50:23.273

I am writing a system audit app using PowerShell, so I can easily dump to a non XML based html file, preformatted for reporting.

Part of it is using a tool set I have compiled, and part of THAT uses a custom menu (PS) that I am creating, to make it look nice and professional, I use a batch file to run the powershell and bypass the UAC and settings for running restricted ps1 files. But to make it look really pretty, I set the width, height and it's position, as well as the buffer size, and set all the menus to have it all fit perfectly in the window...

Below is the code I use for the settings of the window.

Hope it helps.

```
# Use as short code for everything else.
$uisettings = (Get-Host).UI.RawUI

# Set the title of the window itself.
$uisettings.WindowTitle = "Something you want it to say."

# Sets the style of the cursor, 100 = full block (easier to see).
$uisettings.CursorSize = "100"

# Set the window size for the screen.  
$b = $uisettings.WindowSize
$b.Width = 80
$b.Height = 60
$uisettings.WindowSize = $b

# Set the position on the screen for the window. 
$x = $uisettings.WindowPosition
$x.x = 0
$x.y = 0
$uisettings.WindowPosition = $x

# Set the buffer size;
# use the below code to set the buffer to OTHER than the WindowSize above.
# OR, if you want to ensure it fits just right, remove lines 1, 2 and 3 below,
# and set $uisettings.BufferSize to $b instead.
$s = $uisettings.BufferSize
$s.Width = 80
$s.Height = 60
$uisettings.BufferSize = $s 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-11T14:05:44.513

以下powershell函数模仿cmd模式120 40

```
 function mode ($1,$2){
 $s = (get-host).ui.rawui
 $b = $s.buffersize
 $b.height = $2
 $b.width = $1
 $s.buffersize = $b
 $w = $s.windowsize
 $w.height = $2
 $w.width = $1
 $s.windowsize = $w
 } 
```

# c# - 使用存储 C#.Net CNG 中的密钥的 ECDSA 签名文件

> ID：10490263
> 
> 赞同：23
> 
> 时间：2012-05-07T22:59:01.360
> 
> 标签：c#, .net, cryptography, elliptic-curve, cng

我正在尝试使用 CNG API 和 Microsoft Certificate Store 中的证书使用 ECDSA 签署文件。我已经阅读了很多文档并且几乎完成了，但是我对从证书中导入私钥感到困惑。我用 RSA 做了同样的事情，但它似乎做得非常不同。这是我到目前为止的代码：

```
 static void signFile()
    {
        X509Certificate2 myCert = 
             selectCert(StoreName.My, 
                        StoreLocation.CurrentUser, 
                        "Select a Certificate",
                        "Please select a certificate from the list below:");

        Console.Write("Path for file to sign: ");
        string path = Console.ReadLine();
        TextReader file = null;
        try
        {
            file = new StreamReader(path);
        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
            Console.Write("\nPress any key to return to the main menu: ");
            Console.ReadKey();
        }
        UnicodeEncoding encoding = new UnicodeEncoding();
        byte[] data = encoding.GetBytes(file.ReadToEnd());
        ECDsaCng dsa = new ECDsaCng(
            CngKey.Import(StringToByteArray(myCert.PrivateKey.ToString()),
                          CngKeyBlobFormat.EccPrivateBlob,
                          CngProvider.MicrosoftSoftwareKeyStorageProvider));

        dsa.HashAlgorithm = CngAlgorithm.Sha384;
        byte[] sig = dsa.SignData(data);
        TextWriter signatureFile = new StreamWriter("signature.txt");
        signatureFile.WriteLine("-----BEGIN SHA384 SIGNATURE-----" + 
                                ByteArrayToString(sig) + 
                                "-----END SHA384 SIGNATURE-----");
        signatureFile.Close();
    } 
```

我得到了错误

> System.NotSupportedException：不支持证书密钥算法。

我的证书是 ECDSA_P256 sha384ECDSA，具有以下扩展名：

```
Digital Signature, Non-repudiation, independent signing revocation list (CRL), CRL Signing (CRL) (c2)
Server Authentication (1.3.6.1.5.5.7.3.1)
Client Authentication (1.3.6.1.5.5.7.3.2)
Code Signing (1.3.6.1.5.5.7.3.3)
Unknown Key Usage (1.3.6.1.4.1.311.2.1.22)
Unknown Key Usage (1.3.6.1.4.1.311.2.1.21)
IKE-intermediary IP-security (1.3.6.1.5.5.8.2.2) 
```

看起来好像证书是问题，但我不确定它是否可能是代码。

* * *

这是我的公钥证书：

```
Certificate:
Data:
    Version: 3 (0x2)
    Serial Number: 2 (0x2)
Signature Algorithm: ecdsa-with-SHA384
    Issuer: C=##, O=#######, OU=#####, OU=#####, CN=###########
    Validity
        Not Before: Apr 27 16:35:51 2012 GMT
        Not After : Apr 26 16:35:51 2017 GMT
    Subject: C=##, O=###########, OU=#####, CN=#############
    Subject Public Key Info:
        Public Key Algorithm: id-ecPublicKey
            Public-Key: (256 bit)
            pub:
                04:fc:d5:ce:ad:1f:0c:19:b9:3d:2b:bd:7d:f0:8c:
                44:46:db:e3:42:14:b1:1a:9f:7c:ab:e1:be:ad:a5:
                0c:03:2d:0f:ff:3f:10:d4:69:eb:4c:82:a1:2a:61:
                56:45:03:04:a6:49:f7:16:6e:dd:60:22:c6:20:c5:
                4d:44:49:21:41
            ASN1 OID: prime256v1
    X509v3 extensions:
        X509v3 Key Usage: critical
            Digital Signature, Non Repudiation, CRL Sign
        X509v3 Extended Key Usage: critical
            TLS Web Server Authentication, TLS Web Client Authentication, Co
de Signing, Microsoft Commercial Code Signing, Microsoft Individual Code Signing
, 1.3.6.1.5.5.8.2.2
        X509v3 Authority Key Identifier:
            DirName:/C=##/O=#######/OU=#####/OU=#####/CN=######
            serial:01
        X509v3 Subject Key Identifier:
            B7:A8:F9:55:9A:43:9E:BE:1C:4B:62:52:91:C2:F1:39:72:E1:CE:1B
        X509v3 Basic Constraints: critical
            CA:FALSE
Signature Algorithm: ecdsa-with-SHA384
     30:81:88:02:42:01:75:55:f3:64:f9:aa:2a:66:55:b1:ca:dc:
     86:ac:1f:7d:2a:ec:10:87:db:74:88:0e:77:e3:18:82:15:a7:
     32:91:1a:2d:ea:07:2e:78:8d:dc:8a:18:3c:2b:5a:9b:6a:0f:
     97:f6:f8:8d:c5:fc:0e:9f:20:e9:b0:16:90:1a:c4:58:ac:02:
     42:01:dc:b3:88:ae:44:54:c4:e0:b7:c2:37:88:0b:19:6b:96:
     99:f7:21:12:45:12:21:e5:ab:83:39:a6:47:3a:08:87:b0:fa:
     0e:31:1b:97:83:8d:65:30:a1:43:c1:82:27:77:6e:93:89:1b:
     bd:57:b1:7a:54:9e:cc:e1:44:cc:74:16:c5 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-03-27T19:36:48.467

我已经用 X509 证书与 ECDsa 和 CngKey 斗争了很长时间，并且遇到了完全相同的问题。我们最终使用 ECDsa_P256 SHA256 创建了我们自己的 CngKey，但我相信我在挖掘 CryptoApi 方面学到了一些东西：

当您拥有标有“服务器身份验证 (1.3.6.1.5.5.7.3.1)”（用作 SSL 证书）的证书时，您的证书将包含密钥交换算法 ECDH。不知何故，这“优先于”ECDsa 算法组。因此，您会得到可怕的“不支持证书密钥算法”。

我花了一个多小时与赛门铁克一起看着我的肩膀，他们无法解决这个难题，所以他们放弃了“对不起，我们不支持将 SSL 证书用于除 SSL 之外的任何东西”。

[您可以使用 Codeplex ( http://clrsecurity.codeplex.com/](http://clrsecurity.codeplex.com/) )的 CLRSecurity 从证书中获取您的私有 CngKey 。这为您的 x509Certificate2 提供了一个允许此代码的扩展：

```
X509Certificate cer = <getyourcertcode>;
CngKey k = cer.GetCngPrivateKey(); 
```

检查“k”并查看您的算法组可能与预期不同。我的是ECDH...

我现在正在尝试的解决方案是设置一个新的 CA 服务器，强制它完全按照我的意愿行事。基本上这将是一个 X509 证书，仅用于代码签名......

“X509v3 密钥用法：关键数字签名”可能必须是唯一允许的用法......

希望这对其他人有帮助:-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-19T14:53:25.607

.NET 4.6.1 解决了这个问题的核心需求。新代码将是

```
...
byte[] sig;
using (ECDsa ecdsa = cert.GetECDsaPrivateKey())
{
    if (ecdsa == null) throw new Exception("Not an ECDSA cert, or has no private key");

    sig = ecdsa.SignData(data, HashAlgorithmName.SHA384);
} 
```

.NET 4.6.1 还修复了一些证书密钥作为 ECDH 返回并因此失败的问题。（嗯，它并没有解决一些私钥被认为是 ECDH 的问题——这与服务器身份验证 EKU 无关，但这是一个很好的猜测——但认为这些密钥现在是有效的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T17:03:55.360

如果您运行的是 Windows Vista 或 Windows 2008，则不支持 CngKeyBlobFormat.EccPrivateBlob。您使用的是什么操作系统？ [CngKey.Import 仅在某些机器上抛出 CryptographicException](http://social.msdn.microsoft.com/Forums/en-SG/netfxbcl/thread/aaa10f81-6296-4768-a948-edb3449550de)

# python - 将 perl 正则表达式转换为 python

> ID：10490264
> 
> 赞同：0
> 
> 时间：2012-05-07T22:59:07.430
> 
> 标签：python

我正在尝试将一些 perl 行更改为 python，并且我正在努力理解 perl 代码中发生了什么。任何帮助将不胜感激。

谢谢！

```
 my($junk1, $filename, $junk2) = $mydir =~ m/(.*\\)(.*\\)(.*)/;
    $filename =~ s/\\//;
        print $out $filename, "\n"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T02:47:07.027

不要使用正则表达式来分割文件路径。

相反，使用[`os.path`模块](http://docs.python.org/library/os.path.html)和字符串函数。特别是，该`os.path`模块解释了操作系统之间的许多差异（目录分隔符 - unix`/`与 windows`\\`等），这使您的代码更有可能在不同的计算机上运行。

```
>>> mypath = "D:\\lws\\vc\\.git\\objects\\dd"

>>> mydir = os.path.dirname(mypath)
>>> mydir
'D:\\lws\\vc\\.git\\objects'

>>> dirs = mydir.split(os.path.sep) # On windows, os.path.sep is `\\`.
>>> dirs
['D:', 'lws', 'vc', '.git', 'objects']

>>> dirs[0:2]
['D:', 'lws']

>>> filename = os.path.basename(mypath)
>>> filename
'dd' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T02:14:09.163

`my($junk1, $filename, $junk2) = $mydir =~ m/(.*\\)(.*\\)(.*)/;`

这要么（错误地）尝试获取文件名，要么实际上获取目标文件的包含文件夹。

`$filename =~ s/\\//;`

删除任何前导或尾随路径分隔符。顺便说一句，Perl 写得不好，因为它不检查正则表达式的成功或失败。

所以，结果如下：

```
my $mydir="c:\\music\\ap\\mahadeva.mp3";    
my($junk1, $filename, $junk2) = $mydir =~ m/(.*\\)(.*\\)(.*)/;
$filename =~ s/\\//;
print $filename, "\n"; 
```

印刷：`ap`

Python re 的直译是：

```
import re

mydir="c:\\music\\ap\\mahadeva.mp3"

m=re.search(r'(.*\\)(.*\\)(.*)', mydir)
if m:
    print re.sub(r'\\', '', m.group(2)) 
```

这不是完美的翻译，因为 Python 会检查匹配，而 Perl 版本不会。

不过，在 Python 中有更简单的方法可以做到这一点（还有 Perl）。你可以这样做：

```
 print p.split('\\')       # ['c:', 'music', 'ap', 'mahadeva.mp3']

 print p.split('\\')[-2]   # prints 'ap' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T23:38:27.857

第一行（`m/(.*\\)(.*\\)(.*)/`分为`$mydir`三个部分，前两个部分以反斜杠结尾。

例如，如果`$mydir`是`Asdf\fdsa\jkl`，第一行设置`$junk1 = Asdf\`, `$filename = fdsa\`, `$junk2 = jkl`.

线

```
$filename =~ s/\\//; 
```

接受`$filename`( `fdsa\`) 并删除最后一个反斜杠（语法为`s/stuff_to_match/stuff_to_substitute_with/`）。

在 python 中，您可以使用该[`re`模块](http://docs.python.org/library/re.html)来执行正则表达式，或者在这种情况下，您看起来可以只拆分反斜杠，从而无需正则表达式。

# ubuntu - go - 从 ubuntu ppa 安装的说明

> ID：10490270
> 
> 赞同：2
> 
> 时间：2012-05-07T22:59:32.203
> 
> 标签：ubuntu, installation, environment-variables, go

我已经使用 Ubuntu 的[Go 语言 ppa](https://launchpad.net/~gophers/+archive/go)安装了 golang-stable 。

[官方安装说明](http://golang.org/doc/install#freebsd_linux)似乎忽略了这个选项，根本没有提到它。

`sudo apt-get`我的问题是：有谁知道在为这个包做完之后还需要什么吗？特别是，我是否必须手动设置任何环境变量？

我之所以问，是因为我已经能够 " `go get`" [Go-SDL](https://github.com/0xe2-0x9a-0x9b/Go-SDL)，但是当我尝试执行它的测试时，我收到以下错误：

```
$ ./test
panic: No such environment variable: GOPATH 
```

这种让我很困惑。那个变量不应该已经初始化了吗？特别是考虑到我已经能够编译和安装一个库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T12:43:09.723

`go`您在内部安装的命令包含在缺少`/usr/lib/go/bin/`环境变量时使用的默认路径。`GOPATH`对于 Ubuntu 软件包，此默认路径指向`/usr/lib/go`. 因此 Go-SDL 的安装目录位于`/usr/lib/go/src`. 以这种方式安装 Go-SDL 需要 root 权限。

我建议您按照 http://golang.org/doc/code.html 中的说明进行设置`GOPATH`并[重新](http://golang.org/doc/code.html)安装 Go-SDL。例如：

```
# Uninstall Go-SDL from /usr/lib/go
sudo go clean -i github.com/0xe2-0x9a-0x9b/Go-SDL/...

# Setup GOPATH
mkdir -p $HOME/go/src
export GOPATH=$HOME/go

# Install Go-SDL into $GOPATH
go get -v github.com/0xe2-0x9a-0x9b/Go-SDL/... 
```

`test`from`github.com/0xe2-0x9a-0x9b/Go-SDL`需要知道`GOPATH`找到一些资源文件（基于How [to access resource files after the 'go' tool installed the executable?](https://stackoverflow.com/questions/9443418/how-to-access-resource-files-after-the-go-tool-installed-the-executable)）。

# php - 如何使用 PHP 从远程 json 数组中获取特定内容

> ID：10490272
> 
> 赞同：-1
> 
> 时间：2012-05-07T22:59:56.613
> 
> 标签：php, json

我需要一种方法来显示来自远程 json 数组的特定内容。我尝试了一些你会用 MySQL 数组做的事情，但这似乎不起作用。我当前的代码是这样的（没有 curl 设置和东西）：

```
$epf = json_decode(curl_exec($down));
$type = $epf['type'];
echo $type; 
```

谁能给我一个简单的解决方案，说明如何从特定标题（例如“成本”）获取内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:04:33.730

我宁愿用`print_r($epf);`

# iphone - 无法删除 UISearchBar

> ID：10490274
> 
> 赞同：0
> 
> 时间：2012-05-07T22:59:57.583
> 
> 标签：iphone, ios, cocoa-touch, uisearchbar

我创建`SearchBarView`了 的子类`UIView`，并将`UISearchBar`其作为子视图添加到其中。（从）调用后`removeFromSuperview`，不会消失。我试图从我创建 SearchBarView 的地方调用，但它没有帮助。任何想法为什么？`SearchBarView``searchBarSearchButtonClicked``UISearchBar``removeFromSuperview``SearchBarView`

```
#import <UIKit/UIKit.h>
@interface SearchBarView : UIView <UISearchBarDelegate> {
    UISearchBar *querySearchBar;
}
@end

#import "SearchBarView.h"
@implementation SearchBarView
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        querySearchBar = [[UISearchBar alloc] initWithFrame:CGRectMake(0,0,frame.size.width,44)];
        querySearchBar.delegate = self;
        [self addSubview:querySearchBar];
    }
    return self;
}

#pragma mark -
#pragma mark UISearchBarDelegate methods
- (void)searchBarSearchButtonClicked:(UISearchBar *)searchBar {
    [self removeFromSuperview];    
}

- (void)searchBarCancelButtonClicked:(UISearchBar *)searchBar
{   
    searchBar.text = @""; 
    [searchBar resignFirstResponder];
    [searchBar setShowsCancelButton:NO animated:YES]; 
}

- (BOOL)searchBarShouldEndEditing:(UISearchBar *)searchBar
{  
    [searchBar setShowsCancelButton:NO animated:YES]; 
    return YES;   
}  

- (BOOL)searchBarShouldBeginEditing:(UISearchBar *)searchBar
{  
    [searchBar setShowsCancelButton:YES animated:YES];  
    return YES;    
}  
@end 
```

SearchBarView 创建如下：

```
SearchBarView *searchBarView = [[SearchBarView alloc] initWithFrame:CGRectMake(0, 0, 480, 300)];
UIView *rootView = [[[[UIApplication sharedApplication] delegate] window] rootViewController].view;
[rootView addSubview:searchBarView]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-19T15:59:12.563

你的问题是

```
[self addSubview:querySearchBar]; 
```

如果您将搜索控制器添加到子视图，那么当您执行这些操作时它不起作用。

```
[searchController.searchBar removeFromSuperview()]

self.definesPresentationContext = true

searchController.active = false 
```

我建议你做

```
presentViewController(searchController, animated: true, completion: nil) 
```

并尝试关闭 searchController

```
[searchController.searchBar removeFromSuperview()] 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-07T23:52:13.287

尝试

```
[searchbar removefromsuperview]; 
```

# jsf - 如何在 JSF 中使用 dataTable 访问对象方法？

> ID：10490275
> 
> 赞同：1
> 
> 时间：2012-05-07T23:00:02.590
> 
> 标签：jsf, jsf-2, datatable, last.fm

我正在使用 LastFM api，假设我有一个名为的类`Artist`，我在此调用`dataTable`：

```
<h:dataTable var="artist" value="#{personEAO.topArtists}" >
    <h:column>Artist : #{artist.name} </h:column>
</h:dataTable> 
```

Artit 有一个字段引用他的图片：

```
artist.getImageURL(ImageSize.LARGE) 
```

哪个工作正常，但是如何使用 dataTable 在我的 jsf 页面中调用此方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T02:57:55.613

我四处搜索Javadocs，但在任何地方都找不到它们。答案取决于什么样的常数`ImageSize.LARGE`。

如果`ImageSize`是枚举，只需执行以下操作：

```
<h:graphicImage value="#{artist.getImageURL('LARGE')}" /> 
```

但如果它不是并且因此是一个`public static`常数，那么其中一种方法是将它包装在一些帮助 bean 中，它返回的正是：

```
<h:graphicImage value="#{artist.getImageURL(someHelperBean.ImageSize_LARGE)}" /> 
```

我当然假设您的环境支持 EL 2.2。

# python - 无法在视图文件中导入 app.models

> ID：10490277
> 
> 赞同：0
> 
> 时间：2012-05-07T23:00:21.923
> 
> 标签：python, django, django-models, import

第一个 django 应用程序有点麻烦，我的项目是这样布局的

```
MyProject
  -dinners (python package, my app)
    -views (python package)
      __init__.py
      dinners.py(conflict was here... why didn't I add this to the q.. sigh)
      general.py
    __init__.py
    admin.py
    models.py
    tests.py
    views.py
  -Standard django project boilerplate 
```

在我的 /views/general.py 文件中，它看起来像这样：

```
import os
import re
from django.http import HttpResponse
from django.template import Context,loader
from dinners.models import Dinner

def home(request):
    first_page_dinners = Dinner.objects.all().order_by('-created_at')[:5]
    t = loader.get_template('general/home.html')
    c = Context({
        'dinners':first_page_dinners,
    })
    return HttpResponse(t.render(Context())) 
```

在我的 urls.py 文件中，我有这个正则表达式来映射到这个视图

```
url(r'^/*$','dinners.views.general.home', name="home") 
```

但是，当我尝试访问主页时出现此错误：无法导入晚餐.views.general。错误是：没有名为模型的模块

删除general.py 顶部的dinings.models 导入（加上所有特定于模型的代码）可以消除错误。我是否以某种方式错误地导入到视图文件中？当然，我需要能够从视图中访问我的模型......

谢谢

更新：回答我在 -views 包中有一个冲突的文件 Dinners.py

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:03:10.840

您需要`__init__.py`在“dinners”和“views”文件夹中放置一个文件来制作这些有效的包。

**编辑：**

此外，删除该 views.py 文件，这将与包产生冲突。

# ruby-on-rails - 按请求向用户收费 - rails 应用程序

> ID：10490282
> 
> 赞同：0
> 
> 时间：2012-05-07T23:01:04.820
> 
> 标签：ruby-on-rails, gem, ruby-on-rails-plugins, payment

我正在开展一个旨在按要求向用户收费的项目。他将有一个帐户，并且每月应向他发送一张收据，说明他当月使用了多少服务。是否有一些关于此的宝石或文档？

我担心的只是在请求正确完成时注册为合法用途，以避免向他收取错误请求。我相信它是应用程序中非常谨慎的一部分。有没有人看到这方面的任何事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T07:57:03.760

我认为您不会为此找到宝石。可能您最终会创建一个 Rack 中间件并将其添加到中间件链的末尾，检查状态代码是否为 200 并增加用户的使用计数器。

# java - 读取 Pid 时将 byte[] 转换为 Java 中的字符串

> ID：10490283
> 
> 赞同：2
> 
> 时间：2012-05-07T23:01:08.820
> 
> 标签：java, parsing, parseint

我正在尝试使用以下代码在 Ubuntu 下获取我的应用程序的 Pid：

```
 byte[] bo = new byte[100];
    String[] cmd = { "bash", "-c", "echo $PPID" };
    Process p = Runtime.getRuntime().exec(cmd);
    p.getInputStream().read(bo);
    return Integer.parseInt(new String(bo)); 
```

但我得到了这个例外：`Exception in thread "main" java.lang.NumberFormatException: For input string: "10961\n`

为什么要转换为字符串会添加一个 " ？我认为 parseInt 可以处理的 \n ......是编码问题吗？

谢谢，

佩德罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:03:27.630

`\n`是一个 unix 换行符。您可以在发送到 之前将其剥离`parseInt()`。

```
return Integer.parseInt(new String(bo).replace("\n", "")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T23:06:32.393

您会收到 NumberFormat 异常，因为`\n`它不是数字字符。您可以剥离尾随`\n`：

```
return Integer.parseInt(new String(bo).replaceAll("\\n", ""); 
```

或者一开始就`echo`不要添加一个：

```
String[] cmd = { "bash", "-c", "echo -n $PPID" }; 
```

# ruby-on-rails - 带有标签的rails分页问题

> ID：10490288
> 
> 赞同：2
> 
> 时间：2012-05-07T23:01:51.623
> 
> 标签：ruby-on-rails, tabs, pagination

我想知道点击分页时是否可以只影响一个标签？我正在使用 will_paginate gem

我有一些看起来像...

```
 <div class="tab-content">
      <div class="tab-pane active span8" id="received">
        <h3>Received Messages</h3>
        <%= render 'received_message_feed'%>
      </div>
      <div class="tab-pane span8" id="sent">
        <h3>Sent Messages</h3>
        <%= render 'sent_message_feed'%>
      </div>
    </div> 
```

这呈现...

```
<% if @sent_message_items.any? %>
  <ol class="microposts">   
    <%= render partial: 'shared/message_item', collection: @sent_message_items %>
  </ol>
  <%= will_paginate @sent_message_items %>
<% end %> 
```

我也有一个等效的 received_message 部分。

在我的第一个代码块中，我有 2 个选项卡，一个用于接收的消息，一个用于发送的消息。假设我单击我的已发送选项卡，然后单击第 2 页。由此产生了两个问题。

1.  页面刷新并转到我收到的消息选项卡，该选项卡最初是活动选项卡。有没有办法让它重新发送？

2.  更大的问题是，当我在发送选项卡中单击第 2 页时，它也会在我收到的选项卡上加载第 2 页。有没有办法防止这种情况？

我不知道如何解决这个问题...帮助将不胜感激。谢谢你！

更新。

我结束了使用 ajax 分页，所以页面不会重新加载并且问题 1 被规避。但是问题2仍然是一个问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T22:14:07.940

我修好了它。

我结束了使用 ajax 分页，所以页面不会重新加载并且问题 1 被规避。

至于问题2，这节省了一天

[http://blog.devinterface.com/2011/08/tips-multiple-pagination-with-will_paginate/](http://blog.devinterface.com/2011/08/tips-multiple-pagination-with-will_paginate/)

# shell - Bourne shell：强制 STDOUT 到 STDERR

> ID：10490289
> 
> 赞同：3
> 
> 时间：2012-05-07T23:02:07.273
> 
> 标签：shell, sh

我正在创建一个 Subversion [post-commit hook](http://svnbook.red-bean.com/en/1.6/svn-book.html#svn.ref.reposhooks.post-commit)。我需要强制将一个命令输出到 STDERR，以便提交后挂钩将消息编组回客户端。

如何强制 STDOUT 到 STDERR？

在这个简化的示例中，文件`foo`存在，但`bar`不存在。

```
# touch foo
# ls foo bar
ls: bar: No such file or directory
foo 
```

我想将 STDOUT 发送到 STDERR。我以为我可以用 来做到这一点`>&2`，但它似乎不起作用。

我期待下面的示例将 STDOUT 重定向到 STDERR，这`/tmp/test`将包含命令的输出和错误。但相反，STDOUT 似乎从未重定向到 STDERR，因此`/tmp/test`只包含来自命令的错误。

```
# ls foo bar >&2 2>/tmp/test
foo
# cat /tmp/test
ls: bar: No such file or directory 
```

我错过了什么？

我已经在 CentOS、Ubuntu、FreeBSD 和 MacOSX 上尝试过上面的例子。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T00:09:26.720

shell 重定向是从左到右一次评估一个。所以当你有：

```
# ls foo bar >&2 2>/tmp/test 
```

FIRST 将 stdout 重定向到 stderr（无论它最初是什么——可能是终端），然后将 stderr 重定向到 /tmp/test。因此，stdout 将指向最初指向的任何 stderr，而不是文件。你要

```
# ls foo bar 2>/tmp/test >&2 
```

首先将 stderr 重定向到文件，然后将 stdout 重定向到同一位置。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-07T23:21:40.853

STDOUT 具有编号为 1 的文件描述符，您还需要指定它。所以你只是错过了一个1。

```
$ ls bar 1>&2 2>test
$ cat test
ls: cannot access bar: No such file or directory 
```

在 bash 的手册页中，在 REDIRECTIONS 下：-

```
Appending Standard Output and Standard Error
   This construct allows both the standard output (file descriptor 1) and the standard error output (file descriptor 2) to be appended to the
   file whose name is the expansion of word.

   The format for appending standard output and standard error is:

          &>>word

   This is semantically equivalent to

          >>word 2>&1 
```

# javascript - 使用 jQuery 变量添加和删除表单输入字段

> ID：10490296
> 
> 赞同：0
> 
> 时间：2012-05-07T23:02:53.273
> 
> 标签：javascript, jquery

我试图在单击带有 class="checkbox" 的跨度时向表单添加一个隐藏的输入字段，并在单击带有复选标记的跨度时删除相同的字段。

我可以添加输入，但**无法删除它**。

我的 HTML：

```
<span title="Here's My Title" class="wishlistcheck checkbox">1</span>

<form id="wishlistform"></form> 
```

我的Javascript：

```
$(document).ready(function() {

    var appNum = 0;

    $("span.wishlistcheck").click(function() {
        var el = $(this);
        var appName = el.attr("title");

        var isChecked = el.hasClass('checkmark');
        if(!isChecked) {
            el.removeClass('checkbox');
            el.addClass('checkmark');

            appNum++

            $("#wishlistform").append("<input id=\"" + appName + "\" type=\"hidden\" name=\"product_" + appNum + "\" value=\"" + appName + "\">");

        } else {
            el.removeClass('checkmark');
            el.addClass('checkbox');

            appNum--

            $("input#" + appName).remove();

        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:07:48.903

我想你必须`appNum--`在 .remove() 方法调用之后放置。尝试一下：

```
$(document).ready(function() {
    var appNum = 0;
    $("span.wishlistcheck").click(function() {
        var el = $(this);
        var appName = el.attr("title");
        var isChecked = el.hasClass('checkmark');
        if(!isChecked) {
            el.removeClass('checkbox');
            el.addClass('checkmark');
            appNum++
            $("#wishlistform").append("<input class=\"" + appName + "\" type=\"hidden\" name=\"product_" + appNum + "\" value=\"" + appName + "\">");
        } else {
            el.removeClass('checkmark');
            el.addClass('checkbox');
            appNum--
            $("input[class=" + appName + "]").remove();
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T23:09:49.543

您可能通过该 id 标记有多个 DOM 元素，因此它可能正在删除与该 id 匹配但不是正确的元素。

尝试给它一个类名，并通过添加父元素来获得更具体的 jQuery 参数，即

```
 $('#wishlistform input#' + appName).remove(); 
```

# jquery - 不显眼的验证适用于一个控制器，但不适用于另一个控制器

> ID：10490297
> 
> 赞同：0
> 
> 时间：2012-05-07T23:02:55.043
> 
> 标签：jquery, asp.net-mvc, jquery-validate, telerik-mvc, unobtrusive-validation

我有两个不同的视图属于两个不同的控制器。第一个控制器的视图可以通过不显眼的验证正常工作。第二种观点没有。似乎验证插件没有运行，因为`$.validator.unobtrusive`is `undefined`。

在共享的 _layout 文件中，我有以下脚本标签：

```
<script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.19.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script> 
```

那么为什么第二个视图不能与不显眼的验证一起工作呢？

## 更新

在这两种情况下，我都通过 Ajax 调用加载表单。我已经验证了带有损坏验证的主页可以支持对非 ajax 加载的表单进行不显眼的验证。

## 更新2

我终于让它工作了，但它还不是永久修复。问题的根源是同一页面上的**可编辑Telerik MVC Grid。**它以某种方式删除/防止`$.validator.unobtrusive`在我的 ajax 负载中使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:21:46.137

我不知道这是否会有所作为，但是您能否将每一行更改为以下内容？

```
<script src="@Url.Content('~/Scripts/jquery-1.7.2.min.js')" type="text/javascript"></script>
<script src="@Url.Content('~/Scripts/jquery-ui-1.8.19.min.js')" type="text/javascript"></script>
<script src="@Url.Content('~/Scripts/jquery.validate.min.js')" type="text/javascript"></script>
<script src="@Url.Content('~/Scripts/jquery.validate.unobtrusive.min.js')" type="text/javascript"></script>
<script src="@Url.Content('~/Scripts/jquery.unobtrusive-ajax.min.js')" type="text/javascript"></script> 
```

这是一个非常小的更改，但`"`@Url.Contents() 中的 s 已更改为`'`s。报价可能会在某些时候交叉。

# web - 当表单重新显示时 - “密码”字段通常是空白的。为什么？

> ID：10490299
> 
> 赞同：0
> 
> 时间：2012-05-07T23:03:15.863
> 
> 标签：web, passwords, theory, form-submit

当注册表单验证失败时，要求用户重新输入密码是一种奇怪的传统。

例如，验证码值错误，现在*密码*字段为空：用户必须重新输入。

这是什么原因？即使通过HTTPS，将密码放回输入端真的那么不安全吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:05:26.340

在密码输入字段中输入一个值需要它在 html 源代码中以纯文本形式出现。

# python - 如何在 matplotlib 中为等高线图创建图例？

> ID：10490302
> 
> 赞同：41
> 
> 时间：2012-05-07T23:03:53.827
> 
> 标签：python, plot, matplotlib, contour

我似乎无法在任何地方找到答案！[我在这里](http://www.mail-archive.com/matplotlib-users@lists.sourceforge.net/msg08735.html)找到了一个讨论，但尝试这个我得到了`TypeError: 'NoneType' object is not iterable`：

```
>>> import numpy as np
>>> import matplotlib.pyplot as plt
>>> x, y = np.meshgrid(np.arange(10),np.arange(10))
>>> z = x + y
>>> cs = plt.contourf(x,y,z,levels=[2,3])
>>> cs.collections[0].set_label('test')
>>> plt.legend()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/matplotlib/pyplot.py", line 2791, in legend
    ret =  gca().legend(*args, **kwargs)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/matplotlib/axes.py", line 4475, in legend
    self.legend_ = mlegend.Legend(self, handles, labels, **kwargs)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/matplotlib/legend.py", line 365, in __init__
    self._init_legend_box(handles, labels)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/matplotlib/legend.py", line 627, in _init_legend_box
    handlebox)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/matplotlib/legend_handler.py", line 110, in __call__
    handlebox.get_transform())
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/matplotlib/legend_handler.py", line 352, in create_artists
    width, height, fontsize)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/matplotlib/legend_handler.py", line 307, in get_sizes
    size_max = max(orig_handle.get_sizes())*legend.markerscale**2
TypeError: 'NoneType' object is not iterable 
```

**编辑**：我正在寻找这样的东西：

![kamland 太阳能三角洲卡方图](../Images/7c5cc3b0760faf7731170891db39fd66.png)

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-08T07:05:50.977

您也可以直接使用轮廓线来完成，而无需使用代理艺术家。

```
import matplotlib
import numpy as np
import matplotlib.cm as cm
import matplotlib.mlab as mlab
import matplotlib.pyplot as plt

matplotlib.rcParams['xtick.direction'] = 'out'
matplotlib.rcParams['ytick.direction'] = 'out'

delta = 0.025
x = np.arange(-3.0, 3.0, delta)
y = np.arange(-2.0, 2.0, delta)
X, Y = np.meshgrid(x, y)
Z1 = mlab.bivariate_normal(X, Y, 1.0, 1.0, 0.0, 0.0)
Z2 = mlab.bivariate_normal(X, Y, 1.5, 0.5, 1, 1)
# difference of Gaussians
Z = 10.0 * (Z2 - Z1)

# Create a simple contour plot with labels using default colors.  The
# inline argument to clabel will control whether the labels are draw
# over the line segments of the contour, removing the lines beneath
# the label
plt.figure()
CS = plt.contour(X, Y, Z)
plt.clabel(CS, inline=1, fontsize=10)
plt.title('Simplest default with labels')

labels = ['line1', 'line2','line3','line4',
           'line5', 'line6']
for i in range(len(labels)):
    CS.collections[i].set_label(labels[i])

plt.legend(loc='upper left') 
```

将产生：

![图例和标签](../Images/a20cdc841dbeeead2137de55a3b0c955.png)

但是，您可能还想根据自己的需要查看注释。在我看来，它会给你一个更细粒度的控制你在图像上写的位置和内容，这是带有一些注释的相同示例：

```
### better with annotation, more flexible
plt.figure(2)
CS = plt.contour(X, Y, Z)
plt.clabel(CS, inline=1, fontsize=10)
plt.title('Simplest default with labels')

plt.annotate('some text here',(1.4,1.6))
plt.annotate('some text there',(-2,-1.5)) 
```

![带注释的图](../Images/e02c669b40ed6ebe61f722fe7457fcd1.png)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-05-08T01:00:12.520

您可以创建代理艺术家来制作图例：

```
import numpy as np
import matplotlib.pyplot as plt
x, y = np.meshgrid(np.arange(10),np.arange(10))
z = np.sqrt(x**2 + y**2)
cs = plt.contourf(x,y,z,levels=[2,3,4,6])

proxy = [plt.Rectangle((0,0),1,1,fc = pc.get_facecolor()[0]) 
    for pc in cs.collections]

plt.legend(proxy, ["range(2-3)", "range(3-4)", "range(4-6)"])
plt.show() 
```

![在此处输入图像描述](../Images/a30e6bf9a457badea247ab55e5258e66.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-14T20:16:33.313

我有一个类似的[问题](https://stackoverflow.com/q/57024194/6135182)，但需要超出[HYRY 的回答](https://stackoverflow.com/a/10491152/6135182)。为了使包对用户友好，我想`ax.legend()`在不需要用户传递任何句柄的情况下工作，这可以通过将标签传递给代理来实现

```
proxy = plt.Rectangle((0, 0), 1, 1, fc='red', label='some label') 
```

然后将代理添加到轴的补丁中：

```
ax.patches += [proxy] 
```

（`ax = plt.gca()`获取当前轴）

[此答案](https://stackoverflow.com/a/57030414/6135182)中对此进行了更详细的描述。

# python - 在 OSX Lion 上安装 Scrapy

> ID：10490303
> 
> 赞同：4
> 
> 时间：2012-05-07T23:03:55.130
> 
> 标签：python, osx-lion, scrapy

所以我试图在 Lion 上安装 Scrapy，但不确定它是否正确安装。

我按照这里的指南[http://doc.scrapy.org/en/latest/intro/install.html#intro-install](http://doc.scrapy.org/en/latest/intro/install.html#intro-install)

然后尝试做第一步，在这里创建一个教程项目，

[http://doc.scrapy.org/en/latest/intro/tutorial.html](http://doc.scrapy.org/en/latest/intro/tutorial.html)

但是当我尝试跑步时，

```
scrapy startproject tutorial 
```

它不起作用。我得到...

$ python scrapy /Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python：无法打开文件'scrapy'：[Errno 2]没有这样的文件或目录

知道为什么我会收到这样的错误吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-08T16:28:01.283

事实证明，这可能是一个路径问题。

在我的 Mac 上，我使用`easy_install`了`/usr/bin`.

```
sudo /usr/bin/easy_install scrapy 
```

然后将生成的`scrapy`命令安装到`/usr/local/bin/scrapy`.

您的路径中可能没有该目录，因此请查看以下是否属实：

```
echo $PATH 
```

如果它不在那里，您可以像 一样临时添加它`export PATH=/usr/local/bin:$PATH`，或者修改您的`~/.bash_profile`以永久添加它。

* * *

或者，我通常不使用系统在 Mac 中安装 Python - 我安装自制软件并安装单独的 Python 版本，然后`scrapy`使用该版本安装（`scrapy`然后安装到`/usr/local/share/python/scrapy`）。

# ruby-on-rails - 使用带有 Rails ActiveRecord 查找方法的 if 语句

> ID：10490304
> 
> 赞同：0
> 
> 时间：2012-05-07T23:04:07.090
> 
> 标签：ruby-on-rails, activerecord, exception-handling

我想检查一个用户是否包含在一个组中。为了做到这一点，我有以下声明：

```
user_id = current_user.id
unless (group.user.find(user_id))
  redirect_to different_path
end 
```

查看文档，“如果使用 id 调用查找，则找不到请求的对象会引发 ResourceNotFound 异常。” 如何编写 unless 语句以使其正常运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:29:34.177

如果你定义了组和用户之间的关系，你可以调用`current_user.group.present?`This 将返回 false 如果没有相关对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:29:47.297

您可以将重定向作为异常处理的一部分来处理

```
redirect_to path if group.user.find(user_id)

rescue ResourceNotFound
  redirect_to differenct_path
end 
```

或者，可能更好的方法是围绕你的逻辑构建

```
user.groups.include?(group) 
```

# c# - 任务发生异常时，根据用户输入多次重试任务

> ID：10490307
> 
> 赞同：15
> 
> 时间：2012-05-07T23:04:26.113
> 
> 标签：c#, wpf, exception-handling, task-parallel-library, task

我的应用程序中的所有服务调用都是作为任务实现的。当一个任务出现故障时，我需要向用户显示一个对话框来重试上次失败的操作。如果用户选择重试，程序应该重试任务，否则记录异常后应继续执行程序。任何人对如何实现此功能有一个高层次的想法？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-05-08T07:28:20.860

**更新 5/2017**

**C# 6**异常过滤器使`catch`子句更简单：

```
 private static async Task<T> Retry<T>(Func<T> func, int retryCount)
    {
        while (true)
        {
            try
            {
                var result = await Task.Run(func);
                return result;
            }
            catch when (retryCount-- > 0){}
        }
    } 
```

和递归版本：

```
 private static async Task<T> Retry<T>(Func<T> func, int retryCount)
    {
        try
        {
            var result = await Task.Run(func);
            return result;
        }
        catch when (retryCount-- > 0){}
        return await Retry(func, retryCount);
    } 
```

**原来的**

编写 Retry 函数的方法有很多：可以使用递归或任务迭代。不久前，在希腊 .NET 用户组中[讨论](http://www.dotnetzone.gr/cs/forums/thread/67309.aspx)了执行此操作的不同方法。
如果您使用 F#，您还可以使用 Async 构造。不幸的是，您至少不能在 Async CTP 中使用 async/await 结构，因为编译器生成的代码不喜欢多个等待或可能在 catch 块中重新抛出。

递归版本可能是在 C# 中构建 Retry 的最简单方法。以下版本不使用 Unwrap 并在 retries 之前添加可选延迟：

```
private static Task<T> Retry<T>(Func<T> func, int retryCount, int delay, TaskCompletionSource<T> tcs = null)
    {
        if (tcs == null)
            tcs = new TaskCompletionSource<T>();
        Task.Factory.StartNew(func).ContinueWith(_original =>
        {
            if (_original.IsFaulted)
            {
                if (retryCount == 0)
                    tcs.SetException(_original.Exception.InnerExceptions);
                else
                    Task.Factory.StartNewDelayed(delay).ContinueWith(t =>
                    {
                        Retry(func, retryCount - 1, delay,tcs);
                    });
            }
            else
                tcs.SetResult(_original.Result);
        });
        return tcs.Task;
    } 
```

[StartNewDelayed](http://blogs.msdn.com/b/pfxteam/archive/2009/06/03/9691796.aspx)函数来自[ParallelExtensionsExtras](http://blogs.msdn.com/b/pfxteam/archive/2010/04/04/9990342.aspx)示例，并使用计时器在超时发生时触发 TaskCompletionSource。

F# 版本要简单得多：

```
let retry (asyncComputation : Async<'T>) (retryCount : int) : Async<'T> = 
let rec retry' retryCount = 
    async {
        try
            let! result = asyncComputation  
            return result
        with exn ->
            if retryCount = 0 then
                return raise exn
            else
                return! retry' (retryCount - 1)
    }
retry' retryCount 
```

不幸的是，不可能在 C# 中使用来自 Async CTP 的 async/await 编写类似的东西，因为编译器不喜欢 catch 块中的 await 语句。以下尝试也静默失败，因为运行时不喜欢在异常后遇到等待：

```
private static async Task<T> Retry<T>(Func<T> func, int retryCount)
    {
        while (true)
        {
            try
            {
                var result = await TaskEx.Run(func);
                return result;
            }
            catch 
            {
                if (retryCount == 0)
                    throw;
                retryCount--;
            }
        }
    } 
```

至于询问用户，可以修改Retry，调用一个询问用户并通过TaskCompletionSource返回任务的函数，在用户回答时触发下一步，例如：

```
 private static Task<bool> AskUser()
    {
        var tcs = new TaskCompletionSource<bool>();
        Task.Factory.StartNew(() =>
        {
            Console.WriteLine(@"Error Occured, continue? Y\N");
            var response = Console.ReadKey();
            tcs.SetResult(response.KeyChar=='y');

        });
        return tcs.Task;
    }

    private static Task<T> RetryAsk<T>(Func<T> func, int retryCount,  TaskCompletionSource<T> tcs = null)
    {
        if (tcs == null)
            tcs = new TaskCompletionSource<T>();
        Task.Factory.StartNew(func).ContinueWith(_original =>
        {
            if (_original.IsFaulted)
            {
                if (retryCount == 0)
                    tcs.SetException(_original.Exception.InnerExceptions);
                else
                    AskUser().ContinueWith(t =>
                    {
                        if (t.Result)
                            RetryAsk(func, retryCount - 1, tcs);
                    });
            }
            else
                tcs.SetResult(_original.Result);
        });
        return tcs.Task;
    } 
```

通过所有的延续，您可以看到为什么 Retry 的异步版本如此受欢迎。

**更新：**

在 Visual Studio 2012 Beta 中，以下两个版本有效：

带有 while 循环的版本：

```
 private static async Task<T> Retry<T>(Func<T> func, int retryCount)
    {
        while (true)
        {
            try
            {
                var result = await Task.Run(func);
                return result;
            }
            catch
            {
                if (retryCount == 0)
                    throw;
                retryCount--;
            }
        }
    } 
```

和递归版本：

```
 private static async Task<T> Retry<T>(Func<T> func, int retryCount)
    {
        try
        {
            var result = await Task.Run(func);
            return result;
        }
        catch
        {
            if (retryCount == 0)
                throw;
        }
        return await Retry(func, --retryCount);
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-03T08:15:49.707

这是我已经测试并在生产中使用的[Panagiotis Kanavos 出色答案](https://stackoverflow.com/a/10494424/11635)的重复版本。

它解决了一些对我很重要的事情：

*   希望能够根据先前尝试的次数和当前尝试的异常来决定是否重试
*   不想依赖`async`（环境限制少）
*   希望`Exception`在失败的情况下得到结果，包括每次尝试的详细信息

```
static Task<T> RetryWhile<T>(
    Func<int, Task<T>> func, 
    Func<Exception, int, bool> shouldRetry )
{
    return RetryWhile<T>( func, shouldRetry, new TaskCompletionSource<T>(), 0, Enumerable.Empty<Exception>() );
}

static Task<T> RetryWhile<T>( 
    Func<int, Task<T>> func, 
    Func<Exception, int, bool> shouldRetry, 
    TaskCompletionSource<T> tcs, 
    int previousAttempts, IEnumerable<Exception> previousExceptions )
{
    func( previousAttempts ).ContinueWith( antecedent =>
    {
        if ( antecedent.IsFaulted )
        {
            var antecedentException = antecedent.Exception;
            var allSoFar = previousExceptions
                .Concat( antecedentException.Flatten().InnerExceptions );
            if ( shouldRetry( antecedentException, previousAttempts ) )
                RetryWhile( func,shouldRetry,previousAttempts+1, tcs, allSoFar);
            else
                tcs.SetException( allLoggedExceptions );
        }
        else
            tcs.SetResult( antecedent.Result );
    }, TaskContinuationOptions.ExecuteSynchronously );
    return tcs.Task;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T00:52:21.097

在高层次上，我发现根据您拥有的和想要的进行功能签名会很有帮助。

你有：

*   为您提供任务的函数 ( `Func<Task>`)。我们将使用该函数，因为任务本身通常不可重试。
*   确定整个任务是否已完成或应重试的函数 ( `Func<Task, bool>`)

你要：

*   总体任务

因此，您将拥有如下功能：

```
Task Retry(Func<Task> action, Func<Task, bool> shouldRetry); 
```

扩展函数内部的实践，任务几乎有 2 个操作与它们有关，读取它们的状态和`ContinueWith`. 制定自己的任务，`TaskCompletionSource`是一个很好的起点。第一次尝试可能类似于：

```
//error checking
var result = new TaskCompletionSource<object>();
action().ContinueWith((t) => 
  {
    if (shouldRetry(t))
        action();
    else
    {
        if (t.IsFaulted)
            result.TrySetException(t.Exception);
        //and similar for Canceled and RunToCompletion
    }
  }); 
```

这里明显的问题是只会发生 1 次重试。为了解决这个问题，您需要为函数提供一种调用自身的方法。使用 lambdas 执行此操作的通常方法是这样的：

```
//error checking
var result = new TaskCompletionSource<object>();

Func<Task, Task> retryRec = null; //declare, then assign
retryRec = (t) => { if (shouldRetry(t))
                        return action().ContinueWith(retryRec).Unwrap();
                    else
                    {
                        if (t.IsFaulted) 
                            result.TrySetException(t.Exception);
                        //and so on
                        return result.Task; //need to return something
                     }
                  };
 action().ContinueWith(retryRec);
 return result.Task; 
```

# ios - iOS UIButton 在框架外接收触摸，但不在框架内

> ID：10490308
> 
> 赞同：0
> 
> 时间：2012-05-07T23:04:27.127
> 
> 标签：ios, cocoa-touch, event-handling, uikit, touch-event

我有一个带有框架（4,8），（13,13）的子视图 UIbutton。

触摸 A 位于相对于 superview 的位置 (4,16)，但被发送到 superview，即使它在按钮范围内。在窗口坐标中，这是 (49,131)。

触摸 B 发生在窗口坐标为 (48,131) 的左侧一个像素，但被发送到子视图按钮，即使它超出了边界。视图报告 UIButton 中的 (-1,7) 位置。

**触摸A**

```
<UITouch: 0x7b2ddeb0> phase: Ended tap count: 1 
window: <DebugWindow: 0x791357f0; baseClass = UIWindow; frame = (0 0; 320 480); layer = <UIWindowLayer: 0x791358d0>> 
view: <QueueOverlayCellView: 0x7b1ca320; frame = (2 2; 269 30); tag = 1; layer = <CALayer: 0x7b1ca3a0>> 
location in window: {49, 131} previous location in window: {49, 131} 
location in view: {4, 16} previous location in view: {4, 16} 
```

**触摸 B**

```
<UITouch: 0x7b442e90> phase: Ended tap count: 1 
window: <DebugWindow: 0x791357f0; baseClass = UIWindow; frame = (0 0; 320 480); layer = <UIWindowLayer: 0x791358d0>>
view: <TableButton: 0x7b1cada0; baseClass = UIButton; frame = (4 8; 13 13); opaque = NO; layer = <CALayer: 0x7b1cae40>> 
location in window: {48, 130} previous location in window: {48, 130}
location in view: {-1, 7} previous location in view: {-1, 7} 
```

superview 没有实现自定义的 pointInside 方法。

如何将超出子视图边界的触摸转发到子视图，而将子视图边界内的触摸转发到父视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:45:08.240

不是解决方案，而是解决我自己的问题的方法。

这种奇怪的行为似乎发生在太小的按钮上，在本例中为 13x13。扩大按钮大小（并使用 contentInsent 放置图像），将可触摸区域（在本例中将其扩大到 43 像素宽）增加到按钮的一半左右。

# javascript - sIEve 内存泄漏 IE9

> ID：10490314
> 
> 赞同：0
> 
> 时间：2012-05-07T23:05:12.383
> 
> 标签：javascript, jquery, internet-explorer-9

我正在使用[sIEve](http://home.orange.nl/jsrosman/)检查我的 ASP MVC 网站中的内存泄漏。sIEve 告诉我我的一个页面已经存在，但我不确定如何使用 sIEve 提供的信息来开始解决一些泄漏问题。

例如，在下面的[屏幕截图](http://tinypic.com/r/2dwce1l/6)中，我看到我的 ID 为“twitter-link”的 A 标签有泄漏，在我的代码中我有以下内容：

```
$("#twitter-link").click(function () {
                        $.cookie(cookieName, cookieValue);
                        popup("Twitter", "http://twitter.com/MyWebSite", 568, 1006);
                    });

function popup(source, url, height, width, callback) {
    settings = {
        height: 568, // sets the height in pixels of the window.
        width: 1006, // sets the width in pixels of the window.
        toolbar: 0, // determines whether a toolbar (includes the forward and back buttons) is displayed {1 (YES) or 0 (NO)}.
        scrollbars: 1, // determines whether scrollbars appear on the window {1 (YES) or 0 (NO)}.
        status: 0, // whether a status line appears at the bottom of the window {1 (YES) or 0 (NO)}.
        resizable: 1, // whether the window can be resized {1 (YES) or 0 (NO)}. Can also be overloaded using resizable.
        left: 0, // left position when the window appears.
        top: 0, // top position when the window appears.
        center: 1, // should we center the window? {1 (YES) or 0 (NO)}. overrides top and left
        createnew: 1, // should we create a new window for each occurance {1 (YES) or 0 (NO)}.
        location: 0, // determines whether the address bar is displayed {1 (YES) or 0 (NO)}.
        menubar: 0, // determines whether the menu bar is displayed {1 (YES) or 0 (NO)}.
        onUnload: null // function to call when the window is closed
    };
    if (settings.center == 1) {
        if ($.browser.msie) {//hacked together for IE browsers
            centeredY = (window.screenTop - 120) + ((((document.documentElement.clientHeight + 120) / 2) - (settings.height / 2)));
            centeredX = window.screenLeft + ((((document.body.offsetWidth + 20) / 2) - (settings.width / 2)));
        } else {
            centeredY = window.screenY + (((window.outerHeight / 2) - (settings.height / 2)));
            centeredX = window.screenX + (((window.outerWidth / 2) - (settings.width / 2)));
        }
        settings.top = centeredY; //(screen.height-(settings.height + 110))/2;
        settings.left = centeredX; // (screen.width-settings.width)/2;
    }
    parameters = "location=" + settings.location + ",menubar=" + settings.menubar + ",height=" + settings.height + ",width=" + settings.width + ",toolbar=" + settings.toolbar + ",scrollbars=" + settings.scrollbars + ",status=" + settings.status + ",resizable=" + settings.resizable + ",left=" + settings.left + ",screenX=" + settings.left + ",top=" + settings.top + ",screenY=" + settings.top;

    var popup = window.open(url, source, parameters);
    var popuptimer = setInterval(function () {
        if (popup.closed) {
            clearInterval(popuptimer);
            if (callback)
                callback.call();
        }
    }, 1000);
}

<li><a id="twitter-link" href="javascript:void(0);"><img alt="Twitter" title="Twitter" src="twitter.png" />follow us on twitter</a></li> 
```

我不明白“twitter-link”是如何导致泄漏的，所以我的问题是，如何使用 sIEve 提供的信息来消除泄漏？

在此先感谢您的帮助。

# php - php，在zend中发布表单后数据不更新？

> ID：10490320
> 
> 赞同：0
> 
> 时间：2012-05-07T23:06:11.220
> 
> 标签：php, zend-framework, post, file-upload, request

这可能是一个新手问题，这是我的情况：

我有一个上传图片的上传表格。在我的`editAction`我做：

```
if ($request->isPost()) {
            if (isset($_POST['upload_picture']) && $formImageUpload->isValid($_POST)) {
                //here i will add the picture name to my database and save the file to the disk.
            }
}

$picVal = $this->getmainPic(); // here i do a simple fetch all and get the picture that was just uploaded

$this->view->imagepath = $picVal; 
```

发生的情况是新上传的图片没有显示。我检查了数据库和鸡巴，文件在那里。

我认为问题可能是请求的顺序或类似的东西。

有任何想法吗？

编辑：另一件事是，为了使新图像出现，我必须执行 SHIFT+F5 而不仅仅是按下浏览器刷新按钮

编辑2：更多代码

我首先调用上传到磁盘函数然后如果返回成功将文件添加到数据库

```
$x = $this->uploadToDiskMulty($talentFolderPath, $filename)

if($x == 'success'){
    $model->create($data);
} 
```

上传功能

```
public function uploadToDiskMulty($talentFolderPath, $filename)
{
    // create the transfer adapter
    // note that setDestiation is deprecated, instead use the Rename filter
    $adapter = new Zend_File_Transfer_Adapter_Http();
    $adapter->addFilter('Rename', array(
            'target'    => $filename,
            'overwrite' => true
    ));

    // try to receive one file
    if ($adapter->receive($talentFolderPath)) {
        $message = "success";
    } else {
        $message = "fail";
    }

    return $message;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:22:47.920

如果图片仅在您执行 SHIFT+F5 时出现，则表示这是缓存问题。当您上传图片时，您的浏览器不会获取图片。你使用相同的文件名吗？

# ruby-on-rails - 我怎样才能找到两个日期相隔多少天？

> ID：10490326
> 
> 赞同：1
> 
> 时间：2012-05-07T23:06:33.070
> 
> 标签：ruby-on-rails, ruby

我有一个 ActiveRecord 模型，其中一些属性存储在 MySQL 中作为`DATE`s。在 Ruby 中，它们显示为`Date`s。

假设 2011 年 3 月 3 日与 2011 年 3 月 4 日相隔一天，与 3 月 5 日相隔两天等，我如何才能知道它们相隔多少天。

另外，我需要找出它们与当前日期相隔多少天。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:17:20.930

使用`distance_of_time_in_words`助手：

```
distance_of_time_in_words(date1, date2) 
```

如果您想要更高的准确性，我写了一个名为的 gem [`dotiw`](http://github.com/radar/dotiw)，它允许这样的事情：

```
distance_of_time_in_words(date1, date2, false, :only => ["days"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T00:21:54.953

看了一圈后，我想到了这个......

```
(obj.arrival_date - obj.departure_date).floor.abs
 # => How many days apart. 
```

和...

```
(obj.arrival_date - Date.today).floor.abs 
```

根据实验，它似乎有效，尽管我不能 100% 确定它总是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:15:33.523

`Date.new(2001,2,3) - Date.new(1999,2,3)`

将给出天数

# iphone - 刷新 CoreData 表？

> ID：10490327
> 
> 赞同：1
> 
> 时间：2012-05-07T23:06:33.090
> 
> 标签：iphone, ios, uitableview, core-data, reloaddata

我可以通过调用刷新任何非CoreData加载的tableView`[nameoftableView reloadData];`

但是当我在加载了 CoreData 的 TVC 上调用它时，它不会重新加载表。**这有什么不同吗？**

如果我停止并再次启动应用程序，它会更新它的内容 - 以便它重新加载数据库，所以我知道它里面有更新的内容。

干杯杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T08:05:09.200

没有细节很难知道发生了什么，但如果你使用一个简单的`NSFetchRequest`我认为你需要执行查询并`reloadData`再次调用。

*一个简单的笔记*

我建议您`NSFetchedResultsController`在处理 Core Data 和`UITableView`s 时使用。[raywenderlich](http://www.raywenderlich.com/)有一个关于如何在 Core Data 中使用该类的教程。首先，它允许您处理以`UITableView`. 特别是，如果`NSFetchRequest`您使用 with，您设置了批量大小，数据将以“批量”形式检索。例如，前 10 个。然后，如果您滚动其他 10 个，依此类推...

此外，您可以使用`NSFetchedResultsControllerDelegate`类（[参考 NSFetchedResultsControllerDelegate](http://developer.apple.com/library/ios/#documentation/CoreData/Reference/NSFetchedResultsControllerDelegate_Protocol/Reference/Reference.html) ）免费处理数据更改（更新、插入或删除）。

希望能帮助到你。

# android - 带有图像和正文的 Android MMS Intent

> ID：10490329
> 
> 赞同：4
> 
> 时间：2012-05-07T23:06:54.027
> 
> 标签：android, android-intent, message, mms

我正在尝试创建一个意图，该意图将为我启动 MMS 应用程序，并附有图像文件和消息正文中存在的一些预定义文本。

到目前为止，我已经能够完成其中一个或，但不能同时完成两者。

我尝试过的事情（及其结果）：

```
sendIntent = new Intent(android.content.Intent.ACTION_SEND,Uri.parse("mms://"));
sendIntent.setType("image/gif");
sendIntent.putExtra(Intent.EXTRA_STREAM, imgStreamUri);
sendIntent.putExtra("sms_body", "HelloWorld");
startActivity(Intent.createChooser(sendIntent,"Send"));    
/**********
Image file is attached but no text added to message body.
 **********/

sendIntent = new Intent(android.content.Intent.ACTION_SEND);
sendIntent.setType("image/gif");
sendIntent.putExtra(Intent.EXTRA_STREAM, imgStreamUri);
sendIntent.putExtra(Intent.EXTRA_SUBJECT, "HelloWorld");
sendIntent.putExtra(Intent.EXTRA_TITLE, "WorldHello");
startActivity(Intent.createChooser(sendIntent,"Send"));
/**********
Image file is attached but no text added to message body(or subject or anything).
 **********/ 
```

有谁知道我如何将正文文本和图像文件附加到将启动默认消息传递应用程序并填写适当项目的 mms 意图？

**编辑：**测试了答案中提供的代码@lenik。它正在某些设备上运行，这是我发现的

正常工作：

*   史诗 4g (银河 S)
*   Epic 4g 触控 (Galaxy S II)
*   Galaxy Nexus(ICS 4.0.4)
*   HTC 欲望 (Froyo 2.2)
*   摩托罗拉光子

附图片但无文字：

*   搭档 4g
*   三星变形超

任何人都知道我是否基本上对无法以这种方式正常工作的设备感到满意？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T00:52:49.493

以下代码适用于我：

```
Intent intent = new Intent(Intent.ACTION_SEND);
intent.putExtra("sms_body", "Hi how are you");
intent.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(new File("/sdcard/file.gif")));
intent.setType("image/gif"); 
startActivity(Intent.createChooser(intent,"Send")); 
```

# c# - mono touch-iphone 平台上最后调用的函数

> ID：10490330
> 
> 赞同：2
> 
> 时间：2012-05-07T23:07:11.963
> 
> 标签：c#, iphone, ios, xamarin.ios

当用户单击主页按钮或应用程序崩溃时，是否有任何方法或方法被调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T04:20:23.813

是的，UIApplicationDelegate.DidEnterBackground 在你的应用程序进入后台之前被调用：

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm?UIApplicationDelegate/applicationDidEnterBackground](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm?UIApplicationDelegate/applicationDidEnterBackground)：

如果您的应用程序崩溃，则不会调用任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T13:14:08.850

在某些情况下，例如托管异常，您可以将`[AppDomain.UnhandledException][1]`事件设置为通知 - 但在此阶段您无能为力。

但是，这**不**包括将在本机代码中发生的崩溃。有些产品可以记录和报告此类崩溃，但它们不会让您执行自己的代码（并且不能用于许多崩溃，例如内存不足的情况）。

例如[，如何在 MonoTouch 应用程序中捕获 iOS 崩溃](https://stackoverflow.com/q/7989444/220643)

# ruby - ruby 中的数组和范围有什么区别？

> ID：10490333
> 
> 赞同：3
> 
> 时间：2012-05-07T23:07:41.093
> 
> 标签：ruby, arrays, range

只是想知道数组和范围之间的细微差别是什么。我遇到了一个示例，其中我将`x = *(1..10)`x 作为数组输出并`*(1..10) == (1..10).to_a`引发错误。这对我来说意味着两者之间存在细微差别，我只是好奇它是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-07T23:15:22.300

首先，当您不在赋值或参数传递的中间时，这`*(1..10)`是一个语法错误，因为 splat 运算符不会以这种方式解析。这与数组或范围本身并没有真正的关系，但我想我会弄清楚为什么这是一个错误。

其次，**数组和范围实际上是苹果和橙子**。数组是一个对象，它是任意元素的集合。范围是具有“开始”和“结束”的对象，并且知道如何从开始移动到结束，而不必枚举其间的所有元素。

最后，当您使用 将范围转换为数组时`to_a`，您并没有真正“转换”它，就像您所说的“从该范围的开头开始并不断给我元素直到到达结尾”。在“(1..10)”的情况下，范围是给你 1，然后是 2，然后是 3，依此类推，直到你达到 10。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:14:30.090

一个区别是范围本身并不单独存储每个元素，这与数组不同。

```
r = (1..1000000) # very fast
r.to_a # sloooooow 
```

但是，您将失去索引到任意点的能力。

# node.js - 了解 NodeJS/NodeInspector V8 协议

> ID：10490334
> 
> 赞同：1
> 
> 时间：2012-05-07T23:07:45.427
> 
> 标签：node.js, v8, node-inspector

我想控制[NodeInspector](https://github.com/dannycoates/node-inspector)前端。它本身旨在远程控制 Node.js。它们通过[v8 协议](http://en.wikipedia.org/wiki/V8_%28JavaScript_engine%29)进行通信，我还找到了对该协议原理的（相当简短的）[描述](http://code.google.com/p/v8/wiki/DebuggerProtocol)。但仅仅了解沟通的运作方式对我来说还不够。启动时的预期内容，什么时候抛出的事件是前端的预期内容，以便突出显示特定的行等。

我目前的方法是输出 Node-Inspector 和 NodeJS 之间的通信，然后我尝试模仿它。我取得了进步，但这很乏味。另一种方法是使用 NodeInspector 代码（它是一个修改后的 WebInspector），但我是 JavaScript 新手，这可能也很乏味。

所以我的问题是，是否有人知道我开始了解与 NodeJS 或 NodeInspector 的通信如何工作的综合指南或入口点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T09:25:44.190

node-inspector 前端是 webkit 调试器前端的旧版本。

前端：[http ://trac.webkit.org/export/head/trunk/Source/WebCore/inspector/front-end/](http://trac.webkit.org/export/head/trunk/Source/WebCore/inspector/front-end/)

协议：[https ://developers.google.com/chrome-developer-tools/docs/protocol/1.0/index](https://developers.google.com/chrome-developer-tools/docs/protocol/1.0/index)

我创建了一个使用新协议但更关注时间线的新版本。 [https://github.com/Skomski/node-webkit-agent](https://github.com/Skomski/node-webkit-agent)

# sql-server - sql server时间与偏移量比较

> ID：10490336
> 
> 赞同：1
> 
> 时间：2012-05-07T23:07:51.343
> 
> 标签：sql-server, datetime, getdate

我有一个选择查询，它返回已过期的行列表

```
 SELECT *
  FROM dbo.myTable
  WHERE  endDate < Convert(datetime, Convert(int, GetDate())) 
```

我怎样才能让它在凌晨 2 点使用当天而不是我现在的时间`GetDate()`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:15:17.640

要在凌晨 2 点获取当天：

```
convert(datetime,left(convert(varchar, getdate(), 121),10) + ' 02:00') 
```

# regex - 从长度不超过 2 个字符的字符串中获取值

> ID：10490337
> 
> 赞同：0
> 
> 时间：2012-05-07T23:07:52.063
> 
> 标签：regex, string, linq

我有以下表达

```
List<string> Images = Regex.Matches(html, @"(?<=/PI/).*(?=/500/)").Cast<Match>().Select(m => m.Value).ToList(); 
```

`/PI/`它在和之间获得所有价值`/500/`

我想确保每个值不超过 3 个字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:10:31.980

```
(?<=/PI/).{0,3}(?=/500/) 
```

# java - java - 如何使用Scanner方法“hasNext”作为条件退出java中的while循环？

> ID：10490344
> 
> 赞同：22
> 
> 时间：2012-05-07T23:08:22.737
> 
> 标签：java, loops, while-loop, infinite-loop

我是java编程的初学者，遇到了一个奇怪的问题。下面是我的代码，它要求用户输入并打印出用户一次输入一个单词的内容。

问题是程序永远不会结束，根据我有限的理解，它似乎卡在了 while 循环中。谁能帮我一点忙？提前致谢。

```
import java.util.Scanner;

public class Test{
   public static void main(String args[]){
      System.out.print("Enter your sentence: ");
      Scanner sc = new Scanner (System.in);

      while (sc.hasNext() == true ) {
        String s1 = sc.next();
        System.out.println(s1);
      }

      System.out.println("The loop has been ended"); // This somehow never get printed.
   }
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-07T23:11:47.373

您继续获取新字符串并继续循环，如果它不为空。只需在循环中为退出字符串插入一个控件。

```
while(!s1.equals("exit") && sc.hasNext()) {
    // operate
} 
```

如果要在循环内声明字符串，并且如果字符串为“exit”，则不执行循环体中的操作：

```
while(sc.hasNext()) {
    String s1 = sc.next();
    if(s1.equals("exit")) {
        break;
    }
    //operate
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-07T23:11:05.860

将`Scanner`继续读取，直到找到“文件结束”条件。

当您从 阅读时`stdin`，这将是您发送 EOF 字符（通常在 Unix 上）时，或者如果您使用样式重定向`^d`，则在文件末尾。`<`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-07T23:16:50.307

当您使用扫描仪时，如 Alnitak 所述，只有当您有 EOF 字符时，hasNext() 才会得到“假”，基本上......您不能使用键盘轻松发送 EOF 字符，因此在这种情况下，这很常见具有可以发送以停止执行的特殊字符或单词，例如：

```
String s1 = sc.next();
if (s1.equals("exit")) {
    break;
} 
```

Break 会让你跳出循环。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-07T23:16:04.187

您的条件是正确的（尽管您应该放弃`== true`）。正在发生的事情是扫描仪将继续运行，直到它到达输入的末尾。尝试`Ctrl+D`，或通过管道从文件 ( `java myclass < input.txt`) 输入输入。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-17T04:27:28.540

它不起作用，因为您没有将故障安全编程到代码中。java 看到扫描器仍然可以在有输入被收集时收集输入，如果可能的话，虽然这是真的，但它会继续这样做。让扫描仪测试以查看某个单词（例如 EXIT）是否正常，但您也可以让它循环一定次数，例如十次左右。但最有效的方法是询问程序的用户他们希望输入多少个字符串，当他们输入的字符串数少于他们输入的数时，程序将执行。一个附加的选项可能是如果他们键入 EXIT，当他们看到他们需要的空格比他们输入的少并且不想用空格填充下一个单元格时。你可以让程序询问他们是否想输入更多的输入，以防他们意识到需要将更多数据输入计算机。该程序制作起来会非常简单，因为您可以通过多种方式来制作它。请随时向我询问这些方法，不过我的房间已经用完了。XD

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-17T17:52:16.780

如果您不想为此使用 EOF 字符，可以使用 StringTokenizer ：

```
import java.util.*;
public class Test{
   public static void main(){
      Scanner sc = new Scanner (System.in);
      System.out.print("Enter your sentence: ");
      String s=sc.nextLine();
      StringTokenizer st=new StringTokenizer(s," ");//" " is the delimiter here.
      while (st.hasMoreTokens() ) {
        String s1 = st.nextToken();
        System.out.println(s1);
      }

      System.out.println("The loop has been ended");
   }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-05T11:53:39.267

我遇到了同样的问题，我通过使用一个扫描仪对象从控制台读取整行，然后使用第二个扫描仪对象解析结果字符串来解决它。

```
Scanner console = new Scanner(System.in);
System.out.println("Enter input here:");
String inputLine = console.nextLine();

Scanner input = new Scanner(inputLine);
List<String> arg = new ArrayList<>();

while (input.hasNext()) {
    arg.add(input.next().toLowerCase());
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-30T00:41:40.567

您可以简单地使用系统相关的文件结束指示符之一（ d 代表 Unix/Linux/Ubuntu，z 代表 Windows）使 while 语句为 false。这应该让你很好地脱离循环。:)

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2013-02-19T05:53:27.890

修改while循环如下。将 s1 声明为字符串 s1；一次在循环之外。要结束循环，只需使用 ctrl+z。

```
 while (sc.hasNext())
  {    
    s1 = sc.next();
    System.out.println(s1);
    System.out.print("Enter your sentence: ");
  } 
```

# java - 从文件中读取数据到对象？

> ID：10490348
> 
> 赞同：3
> 
> 时间：2012-05-07T23:09:42.877
> 
> 标签：java, filereader

好的，关于我正在编写的程序的另一个问题，称为“飞行”。在我的测试器中，我正在从名为 myFlight 的 Flight 类创建一个对象。该对象有几个字段（航班名称、行驶里程等），但我正在做的是从名为 input.txt 的文件中读取数据并尝试将其放入我创建的对象中。我正在阅读的文件有五行信息。由于某种原因，我不能完全正确，如果有人可以帮助我解决这个问题，我将不胜感激。

这是包含我的 Flight 类中所有字段的构造函数：

```
 public Flight(String name, int num, int miles, String origin, String destination)
  {
    Airlinename = name;
    flightnumber = num;
    numofmiles = miles;
    Origincity = origin;
    Destinationcity = destination;
  } 
```

以及我创建对象并尝试从文件中读取数据的程序部分。我也在我的类中创建了一个空白构造函数，因为我不确定在创建对象时是否应该在对象中放入任何东西。

```
Flight myFlight = new Flight();

    File myFile = new File("input.txt");
    Scanner inputFile = new Scanner(myFile);

    while (inputFile.hasNext())
    {
      myFlight = inputFile.nextLine();
    }

    inputFile.close();
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:41:57.083

万一您使用特殊字符，您需要修改您的程序，以便您可以正确阅读它们。

```
Scanner inputFile = new Scanner(myFile, "UTF-8"); 
```

另一方面，如果文本文件包含以下内容，则可能后续调用会`nextInt()`生成运行时异常。

```
Gran España
1
1001
New York
Los Angeles 
```

如果是这样的话，读数应该是不同的。

```
myFlight = new Flight(inputFile.nextLine(), 
           Integer.parseInt(inputFile.nextLine()), 
           Integer.parseInt(inputFile.nextLine()), 
           inputFile.nextLine(), 
           inputFile.nextLine()); 
```

与任何程序一样，当添加更多条件来改进模型时，它需要越来越多的代码。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:13:31.933

尝试

```
myFlight = new Flight(inputFile.next(), inputFile.nextInt(), 
           inputFile.nextInt(), inputFile.next(), inputFile.next()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:17:37.993

您不能直接将字符串行分配给对象，您需要将行解析为部分并为变量一一赋值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T23:20:19.943

您的输入文本是如何组织的？Scanner 的`nextLine()`方法返回一个 String 对象，绝对不能将它分配给 Flight 类型。有不同的方法可以在 Scanner 中获取不同的值，例如`nextInt(), nextFloat()`.

基本上你可以这样尝试

```
Flight myFlight = new Flight();
myFlight.setFlightName(inputFile.next());
myflight.setMiles(inputFile.nextInt(); 
```

等等

这只是一个示例，您需要检查 input.txt 文件中的格式。

# php - PHP在启动时加载一个函数

> ID：10490349
> 
> 赞同：0
> 
> 时间：2012-05-07T23:09:43.787
> 
> 标签：php

我正在做一些 PHP 编程并且有一个问题：如何在 PHP 脚本首次运行时加载 PHP 函数，并且仅在首次运行时加载？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T23:12:13.337

您可以使用锁定文件

```
$lock = "run.lock" ;

if(!is_file($lock))
{
    runOneTimeFuntion(); //
    touch($lock);
} 
```

**编辑 1**

一次性功能

```
runOneTimeFuntion ();
runOneTimeFuntion ();
runOneTimeFuntion ();
runOneTimeFuntion ();
runOneTimeFuntion ();
runOneTimeFuntion ();
runOneTimeFuntion ();
runOneTimeFuntion ();

function runOneTimeFuntion() {
    if (counter () < 1) {
        var_dump ( "test" );

    }

}

function counter() {
    static $count = 0;
    return $count ++;
} 
```

输出

```
string 'test' (length=4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:15:56.013

每次您启动 php 脚本时，他都会作为一个新脚本启动，无论它被调用了多少次。

如果您知道在 PHP 中禁止重新声明函数，请使用以下方法从外部文件加载函数：

```
<?php require_once(my_function_file.php); ?> 
```

如果你想让 scrpt 记住他之前是否被调用过，可以使用某种形式的日志记录（数据库\文件）并在加载之前对其进行检查......但在函数加载的情况下我看不出有任何理由。 ..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:17:05.377

或者使用普通的布尔值...

```
$bFirstRun = true;

if( $bFirstRun ) {
    run_me();
    $bFirstRun = false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T23:23:55.293

有一个 PHP 函数叫做`function_exists`

您可以在此函数中定义自己的函数，然后您可以查看它是否存在。

```
if (!function_exists('myfunction')) {
  function myfunction() {
    // do something in the function
  }
  // call my function or do anything else that you like, from here on the function exists and thus this code will only run once.
} 
```

在此处阅读有关 function_exists 的更多信息：[http ://www.php.net/function_exists](http://www.php.net/function_exists)

# objective-c - 您如何将电子邮件正文动态传递给 MFMailComposeViewController

> ID：10490364
> 
> 赞同：0
> 
> 时间：2012-05-07T23:11:32.573
> 
> 标签：objective-c, ios

大家好，感谢您的宝贵时间。我相信我有一个简单的问题。

我正在尝试剥离字符串电子邮件正文的引号（它们似乎来自从字典中获取我的正文）并将其传递给 MailObject .... 没有运气，我一直在我的 *finalString 行上获得 SIGBRT。
我错过了什么。再次感谢任何帮助。

```
NSMutableDictionary *my_data = [myMasterOrderList objectAtIndex:[self.tableView indexPathForCell:cell].row];
   NSMutableArray   *toEmail = [[NSMutableArray alloc] init];
   [toEmail addObject:[my_data objectForKey:@"repemail"]];

   NSMutableString *toBody = [my_data objectForKey:@"myOrder"];
  // [toBody addObject:[my_data objectForKey:@"myOrder"]];
  // NSString *finalSting = [[NSString alloc] init];
   NSMutableString *finalString = [NSMutableString stringWithFormat:@"%@",[toBody stringByReplacingOccurrencesOfString:@"\"" withString:@"%20"]];

   NSLog(@" toBody my_data%@", finalString);
//*************  SEND MAIL *************
   if ([MFMailComposeViewController canSendMail]) {

       MFMailComposeViewController *mailViewController = [[MFMailComposeViewController alloc] init];
       mailViewController.mailComposeDelegate = self;
       [mailViewController setToRecipients:toEmail];
       [mailViewController setSubject:@"Sub Goes Here."];
       [mailViewController setMessageBody:finalString isHTML:NO];

       [self presentModalViewController:mailViewController animated:YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:45:43.803

我认为问题是这样的：`withString:@"%20"`它需要是`withString:@"%%20"`因为 % 字符在 NSStrings 中是特殊的，所以要有一个文字 % 符号，你需要转义它。

我还要注意，如果您不需要 finalString 是可变的（从您发布的代码中，您不需要），您可以这样做：

```
NSString *finalString = [toBody stringByReplacingOccurrencesOfString:@"\"" withString:@"%%20"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:45:54.573

我测试了这段代码：

```
NSString *toBody = @"this \" is my \" body \" email\"";
NSMutableString *finalString = [NSMutableString stringWithFormat:@"%@",[toBody stringByReplacingOccurrencesOfString:@"\"" withString:@"%20"]];
NSLog(@"%@", finalString); 
```

NSLog 的输出是：

```
2012-05-07 19:44:04.157 StringTesting[19203:f803] this %20 is my %20 body %20 email%20 
```

我实际上复制了你的代码来使用。我知道这听起来很基本，但是自从我的工作以来，您是否尝试过重新启动 Xcode 和/或重新启动您的机器，清理您的项目等...？

# xml - 在 AS3 中解析图像进出 XML

> ID：10490365
> 
> 赞同：0
> 
> 时间：2012-05-07T23:11:32.583
> 
> 标签：xml, image, actionscript-3

我有一个应用程序，我可以通过 URLLoader 加载图像并将其弹出到影片剪辑中并显示该影片剪辑。

然后我需要能够将该图像写入 xml 文件，以便我可以在需要时重新加载图像。

我目前正在加载图像，然后通过以下方式将其存储为 BitmapData：

```
var decodedBitmapData:BitmapData = Bitmap(image).bitmapData;
backgroundImageBitmapData = decodedBitmapData; 
```

然后我按照以下几行执行一些操作，将其写入 xml 文件。数据存储在一个对象中，该对象存储在一个名为 aRooms 的数组中。（也就是上面的“backgroundImageBitmapData”。）

```
var tempImage:Bitmap = new Bitmap(aRooms[i].backgroundImageData);
var bytes:ByteArray = tempImage.bitmapData.getPixels(tempImage.bitmapData.rect);
var roomBG:XML = new XML( <bg> { String(bytes) } </bg>); 
```

然后将该 roomBG (XML) 变量附加到我要导出的完整 XML 文件中。

从那里，我需要读取该 xmllist 并将其转换为我认为的位图数据，以便我可以通过加载器加载它。但这就是我卡住的地方。

我也有可能保存错误，所以如果是这种情况，欢迎所有帮助和更正。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T12:15:08.863

如果我正确理解你的问题。您想要字节数组的字符串表示形式。您可以通过对其进行 base64 编码来实现这一点。[您可以在此处下载库](http://www.sociodox.com/base64.html)。

然后你会有这样的事情：

```
var rect:Rectangle = new Rectangle(0,0,myImage.width,myImage.height);
var byteArray:ByteArray = myImage.bitmapData.getPixels(rect);

//to encode to a string
var encoded:String = Base64.encodeByteArray(byteArray);

//to decode the string 
var decoded:ByteArray = Base64.decodeToByteArray(encoded);
decoded.position = 0;

var newBitmapData:BitmapData = new BitmapData(rect.width,rect.height,true,0xFFFFFFFF);
newBitmapData.setPixels(rect, decoded);

var newImage:Bitmap = new Bitmap(newBitmapData, "auto", true); 
```

# php - 从日期和时间数组中识别冲突

> ID：10490366
> 
> 赞同：4
> 
> 时间：2012-05-07T23:11:35.563
> 
> 标签：php

我检查了其他 SO 问题，但似乎找不到与此相关的任何内容 - 如果我错过了什么，请指出我正确的方向。

我目前有以下数组，其中包含日期和时间（要求的会议时间）：

```
Array (
    [0] =>
        day => 'Thursday',
        start_time => '14:00',
        end_time => '15:00'
    [1] =>
        day => 'Thursday',
        start_time => '16:30',
        end_time => '17:30'
) 
```

用户必须参加这两个时间。我试图做的是与另一个包含用户当前约会的数组进行比较，并检测是否存在冲突/时间重叠问题

```
Array (
    [0] =>
        day => 'Monday',
        start_time => '09:00',
        end_time => '13:00'
    [1] =>
        day => 'Wednesday',
        start_time => '10:45',
        end_time => '11:15'
    [2] =>
        day => 'Thursday',
        start_time => '16:45',
        end_time => '17:45'
) 
```

使用上面的示例，我想确定与`[1] =>`第一个数组的第二个时间段（提议的会议）发生冲突，该时间`[2] =>`段与第二个数组的第三个时间段（当前会议）发生冲突。

我见过带有时间戳和完整日期的示例，但不仅仅是日期和开始/结束时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:13:06.703

如果它们都在数据库中，则冲突查询可能如下所示：

```
SELECT `plan`.*
FROM `plan`
    JOIN `current` ON `plan`.`day`=`current`.`day`
WHERE
    `plan`.`start_time` < `current`.`end_time`
    AND `plan`.`end_time` > `current`.`start_time` 
```

where`current`是当前日程表，`plan`是用户日程表。我没有测试这个只是因为我没有一个例子，但这应该返回日期相同且`plan`时间重叠`current`时间的行。

编辑：如果不需要，您可能还想做标记`current`为暂定之类的东西。您可以将其放入查询 where 子句中。

也意味着开始和结束分钟不包括在内`>`。`<`因此，如果一个在另一个开始的同时结束，这不会将它们标记为冲突。如果您希望开始/结束分钟包含在内，请将它们更改为`>=`and `<=`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T00:20:13.653

你可以这样做

```
$slot1 = Array (
        0 => array (
                'day' => 'Thursday',
                'start_time' => '14:00',
                'end_time' => '15:00' 
        ),
        1 => array (
                'day' => 'Thursday',
                'start_time' => '16:30',
                'end_time' => '17:30' 
        ) 
);

$slot2 = Array (
        0 => array (
                'day' => 'Monday',
                'start_time' => '09:00',
                'end_time' => '13:00' 
        ),
        1 => array (
                'day' => 'Wednesday',
                'start_time' => '10:45',
                'end_time' => '11:15' 
        ),
        2 => array (
                'day' => 'Thursday',
                'start_time' => '16:45',
                'end_time' => '17:45' 
        ) 
);

echo "<pre>";
$format = "l H:s";
foreach($slot1 as $value)
{
    $slot1Start = DateTime::createFromFormat ($format , $value ['day'] . " " . $value['start_time'] );
    $slot1End = DateTime::createFromFormat ( $format , $value ['day'] . " " . $value['end_time'] );

    foreach($slot2 as $value2)
    {
        $slot2Start = DateTime::createFromFormat ( $format , $value2 ['day'] . " " .$value2['start_time'] );
        $slot2End = DateTime::createFromFormat ( $format , $value2 ['day'] . " " .$value2 ['end_time'] );

        if ($slot1Start <= $slot2End && $slot1End >= $slot2Start) {
            echo sprintf ( "Even Overlap on %s %s-%s AND %s %s-%s", $value ['day'], $value ['start_time'], $value ['end_time'],
                    $value2 ['day'], $value2 ['start_time'], $value2 ['end_time'] ), PHP_EOL;
        }

    }
} 
```

输出

```
Even Overlap on Thursday 16:30-17:30 AND Thursday 16:45-17:45 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:28:45.957

你有一些修改过的数组代码

```
 $current_sheduler = Array (
        [0] =>
            day => 'Thursday',
            start_time => '14:00',
            end_time => '15:00'
        [1] =>
            day => 'Thursday',
            start_time => '16:30',
            end_time => '17:30'
    )

    $user_plans = Array (
        [0] =>
            plan_name => 'event1',
            day => 'Monday',
            start_time => '09:00',
            end_time => '13:00'
        [1] =>
            plan_name => 'event2',
            day => 'Wednesday',
            start_time => '10:45',
            end_time => '11:15'
        [2] =>
            plan_name => 'event3',
            day => 'Thursday',
            start_time => '16:45',
            end_time => '17:45'
    ) 
```

如果用户计划的事件与您的第一个数组的时间匹配，这是处理您的数组和捕获的方法

```
foreach($user_plans as $plan){
  foreach($current_sheduler as current){
     if($plan['day']==$current['day']){
       if(
         ($plan['start_time']>=$current['start_time']) &&
         ($plan['end_time']<=$current['end_time'])
       ){
          echo "Event {$plan['plan_name']} is working now!";
       }
     }
  }
} 
```

这是一般逻辑，对于情况，匹配仅表示全时段匹配。

另一个注意事项：在比较时间之前，您需要将它们重新计算为计数分钟格式。

# c++ - 如何从字符数组中删除换行符？

> ID：10490367
> 
> 赞同：2
> 
> 时间：2012-05-07T23:11:40.450
> 
> 标签：c++, pointers, char

我已使用此函数将文件的内容放入字符数组中：

```
void Read::readFile(){
FILE * fp = fopen(this->filename,"rt");
fseek(fp, 0, SEEK_END);
long size = ftell(fp);
fseek(fp, 0, SEEK_SET);
char *pData = new char[size + 1];
fread(pData, sizeof(char), size, fp);
fclose(fp);
this->data = pData;
} 
```

现在我想从字符数组中删除所有行尾。在不先将字符数组转换为字符串的情况下如何做到这一点？

顺便提一句。这是我们不允许使用字符串库的家庭作业的一部分。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-07T23:22:52.273

```
#include <algorithm>
size = std::remove(pData, pData + size, '\n') - pData;
pData[size] = 0; // optional 
```

对于一些 C++11 lambda 乐趣：

```
#include <algorithm>
size = std::remove_if(pData, pData + size, [](char c) { return c == '\n'; }) - pData;
pData[size] = 0; // optional 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:19:08.183

最简单的方法是使第二个缓冲区的大小与原始数组的大小相同。

```
int len = size;

char* newBufer = calloc(len,sizeof(char));
int i = 0;
int j = 0;
int nlCount = 0;

for(i=0; i<len; i++) {
  if(pData[i] != '\n') {
    newBuffer[j++] = pData[i];
  } else {
    nlCount++;
  }
}

printf("Finished copying array without newlines. Total newlines removed: %d",nlCount); 
```

这里的额外好处是因为你调用而不是 malloc 数组，所有值最初都是零，所以在这种情况下，一旦你完成复制，从 (len-nlCount) 到 (len) 的数据将全部为零（即：'\0'），因此它会自动以空值结尾，就像字符串一样。完成后不要忘记释放（）数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T23:23:34.533

就地拆除：

```
void strip_newlines(char* p) {
    char* q = p;
    while (p != 0 && *p != '\0') {
        if (*p == '\n') {
            p++;
            *q = *p;
        } 
        else {
            *q++ = *p++;
        }
    }
    *q = '\0';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T00:30:47.757

像这样的东西：

```
void Read::readFile()
{ 
    FILE * fp = fopen(this->filename,"rt"); 
    if (fp)
    {
        char *pData = NULL;

        fseek(fp, 0, SEEK_END); 
        long size = ftell(fp); 
        if (size != -1L)
        {
            pData = new char[size];
            if (size > 0)
            {
                fseek(fp, 0, SEEK_SET); 
                size = fread(pData, sizeof(char), size, fp);
            }
        }
        fclose(fp);

        if (size < 0)
        {
            delete[] pData;
            pData = NULL;
        }
        else if (size > 0)
        {
            char *start = pData;
            char *end = start + size;

            char *ptr = (char*) memchr(pData, '\n', size);
            while (ptr)
            {
                int len = 1;
                if ((ptr > start) && ((*ptr-1) == '\r'))
                {
                    --ptr;
                    ++len;
                }

                memmove(ptr, ptr+len, end - (ptr+len));
                end -= len;

                ptr = (char*) memchr(ptr, '\n', end - ptr);
            }

            size = (end - start);
        }

        this->data = pData; 
        this->size = size; 
    }
} 
```

# sencha-touch - sencha touch 2 - 如何操作历史支持

> ID：10490371
> 
> 赞同：3
> 
> 时间：2012-05-07T23:11:47.933
> 
> 标签：sencha-touch, sencha-touch-2

我想使用路由系统来提供后退按钮支持。我正在显示基于唱片店的项目列表。当我处理 itemtap 事件时，`function(list, index, target, record)`我得到了对所选记录的引用，我将其传递到我实例化并显示的新屏幕。

在这种情况下，我如何指示我已移动到新屏幕并启用后退按钮的历史管理器。我明白`application.redirectTo`了，但我会失去对我想使用的记录的引用。（redirectTo 会将一个新操作推送到历史堆栈中，其中包括记录的主要 id，但这似乎是多余的，因为当我处理重定向时，我需要根据 id 重新查找记录。）

有没有直接的方法来告诉历史对象前进到一个新的动作并启用后退按钮支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-21T14:23:20.380

我没有找到更容易的方法。这是我在我的应用程序中的操作方式（使用嵌套列表）。我用这样的路由创建了控制器：

```
Ext.define('MyApp.controller.ListItems', {
    extend: 'Ext.app.Controller',

    config: {
            refs: {
                    nestedList: '.nestedlist'
            },
            control: {
                    nestedList: {
                            itemtap: 'itemSelected'
                    }
            },
            routes: {
                    'item/:id': 'showListItem'
            }
    },

    list: null,
    index: null,
    target: null,
    record: null,
    showListItem: function( id ){
            var nestedList = this.getNestedList(),
                    store = nestedList.getStore(),
                    node = store.getById(id);
            if ( node.isLeaf() ){
                    nestedList.goToLeaf(node);
                    nestedList.fireEvent('leafitemtap', nestedList, this.list, this.index, this.target, this.record);
            } else {
                    nestedList.goToNode(node);
            }
    },
    itemSelected: function( nl, list, index, target, record ){
            this.list = list;
            this.index = index;
            this.target = target;
            this.record = record;
            var path = 'item/'+record.data.id;
            this.redirectTo(path);
    }
}); 
```

我还重写了嵌套列表的 onItemTap 方法，现在所有列表更改都是通过控制器和 propper 路由完成的。

```
onItemTap: function(list, index, target, record, e){
    this.fireEvent('itemtap', this, list, index, target, record, e);
} 
```

希望它会有所帮助。写在这里，如果你找到更好的方法，请。

# java - jasper 报告 - 如何输出 Java 变量的值？

> ID：10490375
> 
> 赞同：3
> 
> 时间：2012-05-07T23:12:13.350
> 
> 标签：java, jasper-reports

我正在尝试测试 jasperreport 并编写 Java 代码，但它给了我错误：

```
 -------------------- PDF exception 
    net.sf.jasperreports.engine.JRException: 
Error loading byte data : C:\Users\mt\Desktop\project20111116\test
\src3\report2_1336431810533_776931.class 
```

我究竟做错了什么？

**代码：**

```
public static void main(String[] args) {

    try {

        File jrxmlFile = new File("C:\\Users\\mt\\report2.jrxml");

        if(jrxmlFile.exists()) {

            //jrxml complie
            JasperReport jasperReport =    JasperCompileManager.compileReport(jrxmlFile.getAbsolutePath());

            List<Map<String, ?>> list = new ArrayList<Map<String, ?>>();

            for (int i = 0; i < 10; i++) {
                Map<String, String> map = new HashMap<String, String>();
                map.put("orderNumber", "hello");
                map.put("anotherNumber", "world");
                //map.put("canIUseArray", new String[]{"foo", "bar", "moo", "pee"});
                list.add(map);
           }

          JRMapCollectionDataSource dataSource = new JRMapCollectionDataSource(list);

          JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, new HashMap(), dataSource);

          JasperViewer.viewReport(jasperPrint, false);

      }
   }
   catch(Exception e) {
      System.out.println("-------------------- PDF exception ");
      System.out.println(e); 
   }

System.out.println("DONE");

}//end main 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:32:59.657

这是由于 jrxml 没有指定使用的语言。

就我而言，我将其设置为“groovy”并且代码运行良好。

（在 jasperReport 标签中，添加了**language="groovy"**属性）

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" 
name="report2" 
language="groovy"
pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
    <property name="ireport.zoom" value="1.2100000000000006"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <style name="table"> 
```

# sql - 导出随时间进行的 SQL 数据库更改

> ID：10490376
> 
> 赞同：1
> 
> 时间：2012-05-07T23:12:15.553
> 
> 标签：sql, sql-server

我们正在建立一个测试环境来运行自动化测试。

我们希望有一个干净的环境，因此每次签入代码时，我们都会删除数据库，从头开始创建一个新数据库，并使用 .sql 脚本中的数据填充它。

由于我很懒，我想要的是一种让某人使用 UI 进行更改以更改数据库中的内容的方法，然后只需将所做的更改导出到我们可以添加到基础的 .sql 脚本中创建数据库时的脚本。

有谁知道是否有办法开始检测对数据库所做的任何更改并将其导出到 sql 脚本中？

我已经对此进行了基本搜索，如果它存在，我一定不会搜索正确的术语。谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:17:54.923

有第三方工具可以满足您的要求，特别是 RedGate SQL 比较[http://www.red-gate.com/products/sql-development/sql-compare/](http://www.red-gate.com/products/sql-development/sql-compare/)（注意，我不隶属于 RedGate以任何方式）。

否则，除了为每个表创建 ON INSERT/ON DELETE/ON UPDATE CASCADE 触发器之外，我并没有真正看到一种简洁的方法。

编辑：完全忘记了触发器和存储过程。它们不会被 CASCADE 触发器覆盖。

# playn - 如何使用 playn 捕获图像层点击？

> ID：10490378
> 
> 赞同：0
> 
> 时间：2012-05-07T23:12:20.530
> 
> 标签：playn

当我得到这张图片的点击事件时，我创建了一个图像并添加到图像层？使用指针它只返回被点击的 x 和 y 的值。当我这样做时，我想确定在图像上单击了哪个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T04:36:14.390

您的问题并不完全清楚，但我相信您是在问是否可以直接在图层上监听点击事件，您可以：

```
ImageLayer layer = ...
layer.addListener(new Pointer.Adapter() {
  public void onPointerStart(Pointer.Event event) {
    // event.localX() and event.localY() are the mouse position in the layer's
    // coordinate system; event.x() and event.y() are the mouse position
    // in screen coordinates
  }
}); 
```

从评论中可以看出，您要测试图像中的像素是否透明，并且您需要一个示例。干得好：

```
Image image = ...;
int[] argb = new int[1];
// this will copy the ARGB value of the pixel at x y into the argb array
image.getRgb(x, y, 1, 1, argb, 0, 1);
// this will extract the alpha value from the pixel
int alpha = (argb[0] >> 24) & 0xFF; 
```

# rally - 使用 Rally LookBack API 是否对使用 in 运算符可以查询的元素数量有限制？

> ID：10490379
> 
> 赞同：2
> 
> 时间：2012-05-07T23:12:28.777
> 
> 标签：rally, lookbackapi

给定表达式

```
{WorkProduct: {$in:[0001,0002,0003,...]} 
```

我可以查询的项目数量是否有限制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T13:56:26.570

我们的 API 没有强制限制，但我们发送到底层引擎的整体查询必须小于 4MB。即使考虑到开销，理论上，您也可以在 $in 子句中放入几十万个条目，然后再点击它。

所以，这就是理论和绝对极限。我怀疑你会在那之前很久就达到实际限制，因为 $in 子句按 m * Log (n) 的顺序执行，其中 n 是集合中的元素数，m 是 $in 子句中的元素数. 因此，$in 子句中的元素数量会线性下降。

# php - 使用 MAMP 的 Max OS Lion 10.7.3 DNS 查找非常慢

> ID：10490380
> 
> 赞同：1
> 
> 时间：2012-05-07T23:12:31.480
> 
> 标签：php, dns, osx-lion, mamp, ipv6

这个问题已经以多种形式提出，我花了六个多小时在互联网上搜寻可以解决我的问题的答案。到目前为止，我一直没有成功。我使用 MAMP 开发 PHP 应用程序，昨天我从 Snow Leopard 升级到了 Lion，我的本地应用程序立即运行得慢了很多。我相信这是关于 Lion 如何处理 IPv6 的 DNS 查找问题。我尝试了以下步骤来解决问题：

1.  将我的主机文件中的所有条目更改为不再使用 .local TLD
2.  将我的主机文件中的所有条目放在单独的行中
3.  确保我的主机文件具有正确的编码
4.  将 IPv6 条目添加到我的主机文件中的所有本地条目
5.  安装了 dnsmasq（可能没有正确完成）
6.  将我所有的主机文件条目放在 fe80::1%lo0 localhost 行之前

这解决了一些问题，但还有一个问题我还没有弄清楚。在我们的 PHP 应用程序中，我们像这样定义 SOAP 端点：

> api:8080/contract/services/SomeService?wsdl

在每台服务器上，主机文件中都有一个“api”条目，它指向 SOAP API 的 IP 地址。因此，当我想指向我们的开发服务器时，我将主机文件更改为如下所示：

> 132.93.1.4 接口

（不是真实IP）

每次在主机文件中对 api 条目的 DNS 查找仍然需要 5 秒。当我 ping api 时，结果立即返回。但是，当我 ssh api 时，大约需要 5 秒钟才能连接到服务器。这意味着当我加载我的 PHP 应用程序时，任何 SOAP 查询都将花费 5 秒 + 无论实际查询花费多长时间，这使得本地开发完全不可能。我意识到我们定义端点的方式可能不是最好的设计决策，但这是我必须使用的。

从我读过的其他问题来看，我相信它首先尝试在 IPv6 中查找“api”，失败，然后在 /etc/hosts 中查找。我尝试使用 dnsmasq 切换此顺序，但没有运气。有谁知道如何强制它先读取 /etc/hosts 或完全跳过 IPv6？

更新：我将主机文件中的条目更改为 api.com、api.foo、任何带有“。”的内容。在里面，它立即做出了反应。但是，我仍然想找到一个不需要更改名称“api”的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-20T16:20:20.640

自从升级支持 IPv6 的调制解调器后，我遇到了同样的问题。添加两种主机名格式（IPv4 和 IPv6）解决了以下问题：

```
::1 domain.dev # <== localhost on crack
127.0.0.1   domain.dev 
```

# javascript - Facebook 滚动条是如何工作的？

> ID：10490381
> 
> 赞同：-4
> 
> 时间：2012-05-07T23:12:32.463
> 
> 标签：javascript, jquery, html, facebook

在 Facebook 上，当收到消息时，文档滚动条会控制消息容器。

**问题：** 如何重新创建此功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:22:40.117

从我可以从您的消息中解读出来，我相信这将回答您的问题： [更改滚动条位置](https://stackoverflow.com/questions/1247874/changing-scrollbar-position)

您还应该看看 jQuery 的 scrollTo（插件）函数： [http ://demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

# c++ - C++ 3D 向量保留“块”

> ID：10490387
> 
> 赞同：0
> 
> 时间：2012-05-07T23:13:45.157
> 
> 标签：c++, vector, multidimensional-array, stdvector, preserve

假设我需要数量不定的 3×4 矩阵。（或任何其他固定 m×n 维矩阵的序列。）我的第一个想法是将这些矩阵存储在 a`std::vector`中，其中每个矩阵本身就是 a `std::vector<std::vector<double> >`。我如何使用这些矩阵`std::vector::reserve()`中的一个数字来预先分配空间？`x`因为我知道其中的两个维度，所以我应该（或者我希望）能够`x`乘以这些块的大小。

我知道如何在 1D 中实现这个对象`std::vector`，但我想知道如何在 3D 中实现它`std::vector`，如果没有其他原因，只是为了更好地学习如何使用`std::vector`该类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:16:38.540

将矩阵存储为向量中的向量可能效率很低，但如果必须，就去吧。预留空间和往常一样：

```
typedef std::vector<std::vector<int>> matrix_type;

std::vector<matrix_type> collection;

collection.reserve(100);  // set capacity for 100 "matrices"

// make 10 4x3-matrices; `collection` won't reallocate
collection.resize(10, matrix_type(4, std::vector<int>(3))); 
```

对于您的基本类型，您可能最好拥有一个`m * n`元素向量并大步访问它，即 (i,j) ^(th)元素将位于 position `i * n + j`。每个向量本身都是一个动态容器，您可能不希望到处都有那么多动态分配。

同样，上述`reserve`调用可能不会像您想的那样做，因为它只为内部向量的簿记数据（通常每个向量三个字，即 300 个字）保留内存，而*不是*为实际数据保留内存。

有鉴于此，您甚至可能希望将 a`std::array<int, m*n>`视为您的矩阵类型（并大步访问它）；现在您实际上*可以*预先为实际矩阵保留空间 - 但`m`现在`n`必须是编译时常量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:32:26.380

更好的方法是提供一个类接口并为整个矩阵使用单个线性内存块。然后，您可以以不同的方式实现该接口，范围从适当大小的内部数组（如果大小是大小的一部分），或者`std::vector<int>`通过提供索引 ( `pos = row*cols + col`) 来实现。

在该`std::vector< std::vector<int> >`方法中，外部向量将分配内存来存储内部向量，并且每个向量都将分配内存来保存自己的元素。使用原始指针，它在内存布局中类似于：

```
int **array = new int*[ N ];
for ( int i = 0; i < N; ++i ) 
   array[i] = new int[ M ]; 
```

那是：

```
[ 0 ] -------> [ 0, 1, 2, ... ]
[---]
[ 1 ] -------> [ 0, 1, 2, ... ]
[ . ]
[ . ] 
```

或者基本上是 N+1 个单独的内存块。

# rspec - RSpec 标题测试因变量 full_title 失败，但通过变量 full_title 提供给标题的字符串文本

> ID：10490389
> 
> 赞同：5
> 
> 时间：2012-05-07T23:13:49.170
> 
> 标签：rspec, railstutorial.org

我正在[阅读 RailsTutorial.org 的第 5 章](http://ruby.railstutorial.org/chapters/filling-in-the-layout#sec%3asignup_url)。

我有一项测试，无论我做什么，我都无法开始工作。当我输入变量传递的字符串时它会传递，但当我输入变量本身时它不会传递。

错误显示**未定义的方法'full_title'**（在键入此内容后浏览相关问题 30 分钟后我找不到答案。）

做一个粗浅的测试，想要的内容显示在应用程序中，标题包括完整的标题和“注册”。

这是我的代码：

```
require 'spec_helper'

describe "User pages" do

  subject { page }

  describe "signup page" do
      before { visit signup_path }
      it { should have_selector('h1', text: 'Sign up') }
      it { should have_selector('title', text: full_title('Sign up')) }
  end
end 
```

这是错误显示**未定义方法'full_title'的时候**

当我使用这段代码时它通过了：

```
require 'spec_helper'

describe "User pages" do

  subject { page }

  describe "signup page" do
      before { visit signup_path }
      it { should have_selector('h1', text: 'Sign up') }
      it { should have_selector('title', text: 'Ruby on Rails Tutorial Sample App | Sign up') }
  end
end 
```

谢谢你的帮助！亚当

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T10:04:51.217

重新启动 Guard 解决了这个问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-08T02:07:12.223

要使`full_title`测试工作，请确保`spec/support/utilities.rb`从[清单 5.26创建](http://ruby.railstutorial.org/chapters/filling-in-the-layout#sec%3apretty_rspec)

我无意中跳过了它，因为它看起来与第 3 章中的重复方法一模一样。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-22T18:18:07.267

我遇到了同样的问题，这就是我解决它的方法。确保该文件`/spec/support/utilities.rb`具有以下代码：

```
include ApplicationHelper 
```

这将解决您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-16T10:52:14.170

如果将：config.include ApplicationHelper 写入 spec_helper.rb 一切都会正常工作，但是那一刻我看不到将文件 utility.rb 放入 spec/support 的逻辑（没有它一切都可以正常工作）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-05T03:18:39.290

我遇到了完全相同的问题...除了将头撞到墙上 20 分钟后，我终于看到了问题所在：我将`rspec/support`文件夹命名为`suppport`。难怪`spec_helper.rb`找不到。*掌心*

# php - 为什么 while 循环或其他长循环会阻止 PHP 中的后续请求？

> ID：10490390
> 
> 赞同：1
> 
> 时间：2012-05-07T23:13:49.540
> 
> 标签：php, ajax

是否有类似会话 ID 的东西可以防止同一会话同时具有多个请求/线程？它是如何工作的？

我的应用程序的一个控制器类的方法中有一个循环，该循环等待某些操作（检查数据库）。

我需要看代码，下面是方法里面的代码摘录：

```
// Times in hundredths of seconds.
$timestamp = number_format(microtime(TRUE), 2, '', '');
$closing_time = $timestamp + ($auditorium_lot_timeout * 100);

// Loop until time's up.
do
{
  usleep(250000); // Sleep 250ms to unload the CPU.
  if (Model_Event::count_new_bids())
  {
    // Etc, etc, etc...
    // Change closing time to wait 10 seconds more.
  }
} while (number_format(microtime(true), 2, '', '') < $closing_time);

// After time's up, continue with closing the bids definitely.
// Perform some more actions. 
```

此摘录所属的方法是由 AJAX 请求的。它的目的是在拍卖中关闭出价，但在关闭前等待几秒钟，以便有机会进行最后一次出价。为此，它会循环预先配置的时间量（如 30 秒），并且在循环时，整个应用程序无法接收来自同一用户的任何其他请求。这是为什么？这很难阻止我，因为该用户是现场拍卖的运营商/拍卖师，并且必须在他触发此循环时向未在线参与（但在真实礼堂中呈现）的用户发送“投标”请求。

**更新：** JS 请求代码由[CanJS 模型](http://canjs.us/#can_model)抽象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T03:34:07.983

发生这种情况是因为如果某些请求仍然使用它，内置会话机制会锁定会话文件。

因此，您可能的解决方案是通过以下方式以长寿代码发布会话`session_write_close()`

[PS：哦，还没有看到@chris 有这样的评论。作为一个理由，我放了这个链接并不是偷答案，证明我之前回答过类似的问题：[https ://stackoverflow.com/a/6405685/251311](https://stackoverflow.com/a/6405685/251311)]

# java - SocketOutputStream 的线程安全

> ID：10490391
> 
> 赞同：5
> 
> 时间：2012-05-07T23:13:54.880
> 
> 标签：java, linux, multithreading, sockets

我知道java套接字的线程安全已经在stackoverflow上的几个线程中讨论过，但我无法找到这个问题的明确答案 - 实际上，让多个线程同时写入同一个线程是否安全SocketOutputStream，或者是否存在从一个线程发送的数据与来自另一个线程的数据混淆的风险？（例如，另一端的接收者首先接收一个线程消息的前半部分，然后从另一个线程的消息中接收一些数据，然后是第一个线程的消息的其余部分）

我说“在实践中”的原因是我知道 Socket 类没有记录为线程安全的，但如果它在当前实现中实际上是安全的，那么这对我来说已经足够了。我最好奇的具体实现是在 Linux 上运行的 Hotspot。

在查看热点实现的Java层时，更具体地说是SocketOutputStream中socketWrite()的实现，只要socketWrite0()的本机实现是安全的，它看起来应该是线程安全的。但是，在查看该方法的实现时（j2se/src/solaris/native/java/net/SocketOutputStream.c），它似乎将要发送的数据拆分为 64 或 128kb 的块（取决于它是 64 位JVM），然后在单独的写入中发送块。

所以 - 对我来说，从不同的线程发送超过 64kb 的数据似乎是不安全的，但如果它小于 64kb，它应该是安全的......但我很可能在这里遗漏了一些重要的东西。这里有没有其他人看过这个并得出不同的结论？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T23:21:39.760

我认为如此严重地依赖可能超出您控制范围的事物的实现细节是一个*非常糟糕的主意。*如果你做这样的事情，你将不得不非常小心地控制你使用的*所有东西*的版本，以确保它是你所期望的，而这很难做到。而且您还必须有一个非常强大的测试套件来验证多线程操作是否正确运行，因为您的解决方案依赖于代码检查和来自 StackOverflow 上随机数的谣言。

为什么不能将 SocketOutputStream 包装到另一个直通 OutputStream 中，然后在该级别添加必要的同步？这样做会更安全，而且您在路上遇到意外问题的可能性要小得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T23:42:41.990

根据此文档[http://www.docjar.com/docs/api/java/net/SocketOutputStream.html](http://www.docjar.com/docs/api/java/net/SocketOutputStream.html)，该类并未声称是线程安全的，因此假设它不是。它继承自 FileOutputStream，通常文件 I/O 本身并不是线程安全的。

我的建议是，如果该类与硬件或通信有关，则它不是线程安全的或“阻塞”的。原因是线程安全操作消耗更多时间，您可能不喜欢。我的背景不是 Java，但其他库在哲学上是相似的。

我注意到你对这门课进行了广泛的测试，但你可以整天测试它很多天，它可能无法证明什么，我的 2 美分。

祝你好运，玩得开心。

汤米奎

# java - 使用 JAXB 注释创建以 atom 作为前缀的元素

> ID：10490395
> 
> 赞同：0
> 
> 时间：2012-05-07T23:14:12.863
> 
> 标签：java, annotations, jaxb

我正在尝试创建一个我想要作为原子前缀的 xml 元素。我知道我不能这样做：

```
@XmlElement(prefix="atom") 
```

并创造

```
<XmlAttribute>
   <atom:link ...>
</XmlAttribute> 
```

有没有可能的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:22:27.530

是的，你只需要定义这个前缀对应的命名空间：

```
@XmlElement(name="link", namespace="..") 
```

这只会将与`atom`前缀对应的命名空间添加到您的`link`元素。如果您的问题是关于专门获取`atom`此名称空间的前缀，那么请查看以下问题：[是否可以自定义 JAXB 在编组为字符串时使用的名称空间前缀？](https://stackoverflow.com/questions/1982977/is-it-possible-to-customize-the-namespace-prefix-that-jaxb-uses-when-marshalling)

# php - Gtranslate 插件在撇号前添加反斜杠

> ID：10490397
> 
> 赞同：0
> 
> 时间：2012-05-07T23:14:19.250
> 
> 标签：php, javascript

我正在为客户端网站使用**Gtranslate**插件并使用撇号翻译一些单词我发现该插件在它之前添加了一个反斜杠：

**你好我要去吃饭了...**

如何删除撇号前的反斜杠？

我可以将一个 php 修复程序添加到插件中，还是应该使用 javascript 解决方案？

在这两种情况下，你能帮我找到一个好方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:24:50.597

Javascript 中的正则表达式可以删除所有反斜杠，但在某些情况下，字符串确实意味着使用反斜杠。然后你需要一个更具体的改变，从`\'`到`'`

[http://jsfiddle.net/scx8t/](http://jsfiddle.net/scx8t/)

```
​s = "I\\'m Bob and you\\'re Jane\\\\'s mother";
document.write("before: " + s + "<br>")

s = s.replace(/\\/g, "")​​​​​​​​​​​​​​​​​​​​​​​​​​;
​document.write("after: " + s); 
```

要专门替换\'写`s.replace(/\\'/g, "'")`

对于这个斜线`/`，你会写`s.replace(/\//g, "")`​​​​​​​​​，对于两者，`s.replace(/[\/\\]/g, "")`

*编辑*：对于这个应用程序，PHP`preg_replace`似乎更合适。我现在没有运行 PHP，所以我写了 Javascript :P 它应该是这样的：

```
<?php
$str = 'I\\\'m Joe, you\\\'re Sara';
$str = preg_replace('/\\/', '', $str);
// I'm not sure if the g goes at the end of the pattern to replace all.
echo $str;
?> 
```

*注意* `/\\/`可能需要是`/\\/g`. 我不熟悉PHP。

[从这里](http://php.net/manual/en/function.preg-replace.php)示例 #4 去除空格

# apache - 如何配置 apache 以运行组 ID 与文件不同的页面

> ID：10490399
> 
> 赞同：2
> 
> 时间：2012-05-07T23:14:39.310
> 
> 标签：apache, centos, cpanel, centos6, suphp

我有一个带有 godaddy 的 vps，它具有以下功能：
centos 6
latest apache
whm/cpanel

我正在运行 suphp 启用。
文件和文件夹都是 755,644

我有一个程序位于：/home/programname/public_html

这个程序编辑位于不同用户帐户的同一服务器上的文件。为了实现这一点，我必须：
chown programname:programname /home/username/ public_html 当我尝试查看 /home/username中的文件时
，这允许 /home/programname/public_html 上运行的程序编辑 文件/public_html 位于其域名 username.com

我收到“服务器遇到内部错误或配置错误，无法完成您的请求。”

为了解决这个问题，我必须
chown username:username /home/username/public_html

我该如何解决这个问题，这样我就可以查看网站文件而不必 chown 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-21T19:53:50.570

您可以使用 ACL：

在文件系统上启用 ACL： [https ://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/ch-acls.html](https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/ch-acls.html)

在文件系统上设置 ACL： [https ://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/acls-setting.html](https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/acls-setting.html)

还有一个我不太幸运的 apache 模块：apache2-mpm-itk - [http://www.webtatic.com/packages/httpd-itk/](http://www.webtatic.com/packages/httpd-itk/)

它有一些问题，因为它不能正确支持 prefork。

# perl - WWW::Scripter 的身份验证问题

> ID：10490405
> 
> 赞同：1
> 
> 时间：2012-05-07T23:15:41.413
> 
> 标签：perl, mechanize, www-mechanize

我正在使用插件[WWW::Scripter](http://search.cpan.org/perldoc/WWW%3a%3aScripter)（[WWW::Mechanize](http://search.cpan.org/perldoc/WWW%3a%3aMechanize)的子类）对我的主机登录页面进行身份验证。他们在登录页面上使用`Ruby`了一些`JavaScript`功能，所以我不能只使用该`LWP::Agent`模块。这是代码：

```
#!/usr/bin/env perl
use strict;
use warnings;
use diagnostics;

use LWP::Debug qw(+);
use LWP::ConnCache;
use WWW::Scripter;

my $url = 'https://control.vp.net/login';
my $username = 'example@example.com';
my $password = 'example';

my $w = WWW::Scripter->new(keep_alive => 1) or die "error1: $!\n";
$w->conn_cache(LWP::ConnCache->new);
$w->use_plugin('JavaScript') or die "error2: $!\n";
$w->credentials($url, undef, $username, $password) or die "error3: $!\n";
$w->get($url) or die "error4: $!\n";
print $w->content() or die "error5: $!\n"; 
```

我有以下错误：

```
Uncaught exception from user code:
error3 
```

我花了几个小时在谷歌上搜索，我觉得我现在真的需要你的帮助。我将不胜感激任何有助于理解为什么我无法进行身份验证的帮助。如果重要的话，我的 Perl 版本在 Ubuntu 11 上是 5.10.1。

谢谢。

**更新**

我已将代码中的一行更改为：

```
$w->credentials($username, $password) or die "error3: $!\n"; 
```

现在只得到白页。如果我启用诊断编译指示，则会出现一个相当普遍的错误：

```
Use of uninitialized value in subroutine entry at blib/lib/Net/SSLeay.pm
(autosplit into blib/lib/auto/Net/SSLeay/randomize.al) line 2227 (#1)
(W uninitialized) An undefined value was used as if it were already
defined.  It was interpreted as a "" or a 0, but maybe it was a mistake.
To suppress this warning assign a defined value to your variables. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T08:19:18.300

`credentials`对[标准 HTTP 身份验证](https://www.rfc-editor.org/rfc/rfc2617)很有用，但 Web 表单有所不同。删除该方法调用并了解 Web 表单的功能。JavaScript 对 Web 表单没有影响，Mechanize 就足够了。

```
use strictures;
my ($url, $username, $password)
    = qw(https://control.vps.net/login example@example.com example);
my $w = WWW::Mechanize->new;
$w->get($url);  # automatically raises exception on HTTP errors
$w->submit_form(with_fields => {
    'session[email_address]' => $username,
    'session[password]' => $password,
});
die 'login failed'
    if $w->content =~ /your email and password combination were incorrect/; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T01:11:24.097

您不能像这样简单地期望每个函数都返回一个成功的真值和一个错误的失败值。

例如，的[条目`credentials`](http://search.cpan.org/~jesse/WWW-Mechanize-1.72/lib/WWW/Mechanize.pm#%24mech-%3Ecredentials%28_%24username,_%24password_%29)没有说明它返回的内容，所以你不应该尝试对它返回的任何内容做任何事情。

也是如此[`get`](http://search.cpan.org/~jesse/WWW-Mechanize-1.72/lib/WWW/Mechanize.pm#%24mech-%3Eget%28_%24uri_%29)- 它返回一个响应对象，这可能总是正确的。

您需要调用所有函数，然后检查[`$w->status()`](http://search.cpan.org/~jesse/WWW-Mechanize-1.72/lib/WWW/Mechanize.pm#%24mech-%3Estatus%28%29). 如果它返回 401 或 403，则验证失败。

# xml - 为每个位置命名来自 XSLT 的 XHTML 元素

> ID：10490415
> 
> 赞同：1
> 
> 时间：2012-05-07T23:16:38.687
> 
> 标签：xml, xslt, position

我有一个选择下拉菜单和一个跨度，它们在 javascript 文件中分别引用为“quantity1”、“quantity2”和“price1”、“price2”等。

在 XSLT 中，我需要能够将该元素的 ID 声明为相对于循环的位置，但不能完全弄清楚如何。

```
<span id="price<xsl:value-of select="position()"/>/>£<xsl:value-of select="price"/>"> 
```

这不起作用（显然！），任何人都可以解释如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:18:13.037

假设您在`<span>`XSLT 转换中创建元素，您可以使用[属性值模板](http://www.w3.org/TR/xslt#attribute-value-templates)语法。像这样：

```
<span id="price{position()}">£<xsl:value-of select="price"/></span> 
```

将`<span>`在模板或`xsl:for-each`构造中创建，为`position()`您提供您所期望的。

您还可以使用更详细的[xsl:attribute](http://www.w3.org/TR/xslt#creating-attributes)构造与`xsl:value-of`您最初尝试的类似：

```
<span>
    <xsl:attribute name="id">price<xsl:value-of select="position()"/></xsl:attribute>
    £<xsl:value-of select="price"/>
</span> 
```

属性值模板的花括号更符合我的口味。

# c# - 如何以编程方式向 contentPlaceHolder 添加内容？

> ID：10490417
> 
> 赞同：7
> 
> 时间：2012-05-07T23:16:52.913
> 
> 标签：c#, asp.net, master-pages, contentplaceholder

我有一个母版页，我的所有页面都继承了它。对于格式化，我想将不同页面的内容放在 ContentPlaceHolder 中。

现在，我怎样才能将所有内容插入其中？由于我打算用数据库中的内容填充 ContentPlaceHolder，我想我必须以编程方式进行。

1.  如何向 ContentPlace Holder 添加控件？我检查了其他[答案](https://stackoverflow.com/questions/291037/set-aspcontentplaceholder-content-programatically)，但我无法通过其 ID 访问它。

2.  我应该从一开始就使用多个 ContentPlaceHolders 吗？假设我想放电影。是否应该只有一个包含所有图像、描述和评级，或者每件事一个 ContentPlaceHolder？

我对其他解决方案持开放态度，因为我没有使用 ASP 的经验。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-10-08T19:30:30.160

老问题......但我刚刚遇到了这个问题，这是谷歌上不断出现的 #1 帖子，所以我想我会添加我的答案，因为其他人在我的情况下不起作用。

`<asp:Content`以下是当常规无法正常工作时我是如何做到的（尽管在正常使用中，@JayC 的答案是你如何做到的）：

MasterPage 有这个`ContentPlaceHolder`：

```
<asp:ContentPlaceHolder ID="ScriptsPlace" runat="server"></asp:ContentPlaceHolder> 
```

必须从用户控件动态添加一些 JavaScript。尝试`ContentPlaceHolder`直接使用会出现此错误：

> 解析器错误消息：内容控件必须是内容页或引用母版页的嵌套母版页中的顶级控件。

所以我想从代码隐藏中添加脚本。这是`.ascx`文件的页面加载：

```
protected void Page_Load(object sender, EventArgs e)
{
    ContentPlaceHolder c = Page.Master.FindControl("ScriptsPlace") as ContentPlaceHolder;
    if (c != null)
    {
        LiteralControl l = new LiteralControl();
        l.Text="<script type=\"text/javascript\">$(document).ready(function () {js stuff;});</script>";
        c.Controls.Add(l);
    }
} 
```

**更新：**所以事实证明，我不得不在比预期更多的地方使用它，并最终使用了一种更灵活/可读性更高的方式。在用户控件本身中，我只是将 javascript 和其他任何需要使用常规移动的`div`.

```
<div id="_jsDiv" runat="server">
    $(document).ready(function() {
         //js stuff
    });
    Other server controls or HTML junk
</div> 
```

然后后面的代码会找到那个div，然后把它移到`ContentPlaceHolder`.

```
protected void Page_Load(object sender, EventArgs e)
{
    ContentPlaceHolder c = Page.Master.FindControl("ScriptsPlace") as ContentPlaceHolder;
    HtmlGenericCOntrol jsDiv = this.FindControl("_jsDiv") as HtmlGenericControl;
    if (c != null && jsDiv != null)
    {
        c.Controls.Add(jsDiv);
    }
} 
```

我实际上将此代码放在自定义用户控件中，我只是让我的常规用户控件继承自自定义用户控件，所以一旦我用 a 包装 javascript/etc `<div id="_jsDiv" runat="server">`，自定义用户控件会处理其余的事情，而我不会不必在用户控件后面的代码中做任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T23:30:03.777

通常发生的是

1.  `ContentPlaceHolder`您使用正确的 html 和s设置母版页
2.  您根据该母版页创建页面。如果您使用 Visual Studio，并告诉它基于现有母版页创建一个新页面，它将`Content`为您添加区域。
3.  您将内容添加到新创建页面的内容区域。

如果您想将控件动态添加到母版（或任何）页面，您可以将控件添加到任何现有控件。如果它不应该以任何方式包装，只需添加一个`Placeholder`（它是一个 asp.net 控件）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T02:20:06.137

我确实喜欢这个

```
<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
<asp:Literal ID="jsstuff" runat="server"></asp:Literal>
</asp:Content> 
```

这进入了后面的代码：

```
string stuff =  @"<script type=""text/javascript"">
                                        var searchBox = 0;
                                         var currentCountry = '';
                                         </script>";
                    jsstuff.Text = stuff; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-17T04:29:59.177

如果内容页和母版页的命名空间不同，则内容页控件无法在内容页的代码隐藏中访问。

另外，检查您的设计器文件。如果该控件未在设计器文件中列出，则删除该文件并重新创建（项目-> 转换为 Web 应用程序）

# c# - C# 控制台应用程序 - 佣金计算器 - 如何在方法中使用方法

> ID：10490419
> 
> 赞同：1
> 
> 时间：2012-05-07T23:17:19.243
> 
> 标签：c#, methods, console-application

我是 C# 新手，最近在处理我的控制台应用程序时遇到了一些问题。我试图有3种方法：

`getsales`获得用户的销售额，`calcCom`计算销售额的佣金，最后`main`让他们工作并建立程序。

我很难让这些方法相互配合。

在我输入所有销售后，程序转到 else 语句并告诉我“无效输入”。由于我还没有真正输出变量，我没想到会有任何输出，但我希望程序告诉用户每个人的佣金和销售额。

如果我滥用了任何术语或词语，请原谅我，就像我说我是这种语言的新手！:D

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication38
{
class Program
{

    public static void getsales ()
    {
        string inputsales;
        double total = 0;
        double sale = 0;

        for (int salecount = 1; salecount <= 3; ++salecount)
        {

            Console.WriteLine("Enter sale: ");
            inputsales = Console.ReadLine();
            sale = Convert.ToDouble(inputsales);
            total = total + sale;
            Console.WriteLine();
        }
    }

    public static void calcComm ()
    {
        double total = 0;
        double comm = 0;
        comm = total * 0.2;

    }

    static void Main()
    {
        Console.WriteLine("           Sunshine Hot Tubs \n        Sales Commissions Report\n");
        char Letter;
        string name;
        const string name1 = "Andreas";
        const string name2 = "Brittany";
        const string name3 = "Eric";
        string inputLetter;

        Console.WriteLine("Please enter intial or type z to quit");

        inputLetter = Console.ReadLine();
        Letter = Convert.ToChar(inputLetter);

        while (Letter != 'z')
        {

            if (Letter == 'a')
            {
                name = name1;
                getsales();
                calcComm();
            }
               if (Letter == 'b')
               {
                   name = name2;
                   getsales();
                   calcComm();
               }
                   if (Letter == 'e')
                   {
                       name = name3;
                       getsales();
                       calcComm();
                   }

                   else
                   {

                      Console.WriteLine("Invalid entry try again");
                      inputLetter = Console.ReadLine();

                   }

        }
    }
 }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:25:05.633

我认为你的问题是你需要这个：

```
if (Letter == 'a')
{
    name = name1;
    getsales();
    calcComm();
}
else if (Letter == 'b')
{
     name = name2;
     getsales();
     calcComm();
}
else if (Letter == 'e')
{
     name = name3;
     getsales();
     calcComm();
}
else
{

    Console.WriteLine("Invalid entry try again");
    inputLetter = Console.ReadLine();
} 
```

您还需要在循环`else block`结束的 ,之后复制此代码。`while`

```
Console.WriteLine("Please enter intial or type z to quit");

inputLetter = Console.ReadLine();
Letter = Convert.ToChar(inputLetter); 
```

此外，从 else 块中删除此行。它不是必需的。

```
inputLetter = Console.ReadLine(); 
```

您可能打算在控制台上显示佣金。改变你的`getsales`and`calcComm`看起来像这样：

```
public static void getsales ()
{
    string inputsales;
    double total = 0;
    double sale = 0;

    for (int salecount = 1; salecount <= 3; ++salecount)
    {

        Console.WriteLine("Enter sale: ");
        inputsales = Console.ReadLine();
        sale = Convert.ToDouble(inputsales);
        total = total + sale;
        Console.WriteLine();
    }
    calcComm(total);
}

public static void calcComm (double total)
{
    double comm = 0;
    comm = total * 0.2;
    Console.WriteLine(comm);
} 
```

`calcComm`然后从该`Main`方法中删除所有调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:29:41.887

变量“total”在这两种方法中，它们不会在您定义的两种方法之间保留您正在寻找的数据。也就是说，getSales() 方法中的总变量与 calcComm() 方法不同。

你应该移动这个：

```
 double total = 0; 
```

在这两种方法之外，并将其放在具有静态范围的类中。像：

```
class Program    
{        
    static double total; 
```

此外，在 getSales() 方法中将 total 重新初始化为零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:31:34.047

calcComm() 没有做任何事情......

我认为您可能希望将一些变量设置为全局变量，这样如果它们被某个方法修改，您仍然可以检索它们的值，或者甚至更好地将它们传递给该方法并让它们与新值一起返回。

要声明全局变量，您应该在类 Program 中但在任何方法之外声明它们，然后确保没有其他方法具有同名的变量

# javascript - 为什么此按钮的 onclick 参数不起作用？

> ID：10490424
> 
> 赞同：0
> 
> 时间：2012-05-07T23:18:04.127
> 
> 标签：javascript, html, button

```
<input type="button" value="Accept Contract" class="button" onclick="if(confirm('Are you sure you want to accept this contract?')) window.open('actionurl.php');"> 
```

很简单，为什么它不起作用？它根本不会弹出确认框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:21:14.330

我宁愿为此创建一个单独的函数。

```
<script>
function bla()
{
    if(confirm('Are you sure you want to accept this contract?'))
        window.open('actionurl.php');
}
</script>

<input type="button" value="Accept Contract" class="button" onclick="bla();"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T23:22:12.970

它在这里运作良好。但是，试试这个：

```
<script>
document.getElementById('confirmButton').onclick = function(){
    if(confirm('Are you sure you want to accept this contract?'))
        window.open('actionurl.php');
}
</script>
<input type="button" value="Accept Contract" class="button" id="confirmButton"> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T23:25:31.443

测试它并且工作正常，自己检查它

[http://jsfiddle.net/XSTCm/](http://jsfiddle.net/XSTCm/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T23:25:23.287

似乎在小提琴中工作：

[http://jsfiddle.net/B5MxX/](http://jsfiddle.net/B5MxX/)

如果它在那里不起作用，那么它可能与确认的浏览器兼容性有关

# ruby - Sass 的 Ruby 哈希获取问题

> ID：10490434
> 
> 赞同：1
> 
> 时间：2012-05-07T23:19:34.000
> 
> 标签：ruby, sass, compass-sass

我不知所措。希望有更多 Ruby 经验的人能告诉我发生了什么。

我正在从我的样式表中调用一个自定义 Sass 函数，如下所示：

```
$color: user_var('color') 
```

自定义函数如下所示：

```
module Sass::Script::Functions
  def user_var(param_name)
    puts options[:custom]
    puts options[:custom].fetch('color')
    puts options[:custom].fetch(param_name)
  end
end 
```

`puts options[:custom]`（如预期）的结果是这样的：

```
{"color"=>#eeeeee, "header"=>20px} 
```

结果`puts options[:custom].fetch('color')`是#eeeeee

但是......结果`puts options[:custom].fetch(param_name)`是“找不到密钥：'颜色'（KeyError）”。

这里完全懵了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T13:53:51.013

我的猜测是 param_name 是一个符号，选项哈希中的颜色键被定义为一个字符串。

这应该有效。

```
options[:custom].fetch("#{param_name}") 
```

# android - 自动完成文本视图错误

> ID：10490438
> 
> 赞同：0
> 
> 时间：2012-05-07T23:20:13.827
> 
> 标签：android, autocomplete, textview

我目前正在创建一个使用联系人数据的自动完成文本视图。我似乎无法修复最后一行的错误

```
 Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI, null, null, null, null);
    nameList = new ArrayList<String>(); 
    while (cur.moveToNext())
    {
        nameList.add(cur.getString(cur.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME)));
        nameList.add(cur.getString(cur.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER)));
    }

    phonenumber =(AutoCompleteTextView) this.findViewById(R.id.tosend1); 
```

错误行是这样的：

```
 ArrayAdapter<String> adapter = newArrayAdapter <String>(this,R.layout.list_item2,nameList); 
```

好像有什么问题？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:37:50.183

*查看 logcat 错误确实*很有帮助，但我发现了几个错误，我只能猜测其余的：

```
Cursor cursor = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, 
        new String[] { ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME, ContactsContract.CommonDataKinds.Phone.NUMBER }, 
        null, null, ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);

int nameIndex = cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
int numberIndex = cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);

List<String> list = new ArrayList<String>();
while(cursor.moveToNext()) {
    list.add(cursor.getString(nameColumn) + ": " + cursor.getString(numberColumn));
}

ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, list); 
```

瞧，你的每个名字和联系人中的号码。

# sql - SQL 查询按天分组并计算经过的时间（聚合行）

> ID：10490440
> 
> 赞同：1
> 
> 时间：2012-05-07T23:20:23.753
> 
> 标签：sql, sql-server-2008

我正在使用 SQL Server 2008 并查看如何创建这样的查询：

我有一张桌子：

```
Username nvarchar(50), LogDate datetime

Test1, 2012.01.01 00:00:00
Test2, 2012.01.01 00:00:02
Test1, 2012.01.01 00:00:05
Test3, 2012.01.01 00:00:06
Test1, 2012.01.02 00:01:01
Test2, 2012.01.02 00:02:50
Test1, 2012.01.02 00:01:01 
```

每隔几秒钟，用户就会发送更新以将当前日期时间及其用户名插入到日志表中。我需要计算用户每天“在线”的时间。

我假设查询应该对具有相同用户名的两行之间的 DateDiff 求和，并按天分组。

我尝试使用排名，但没有得到我想要的。

提前谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T01:58:22.160

您可以提取 DateTime 的日期部分并按 UserName 分组以在 MIN / MAX 值上使用 DateDiff：

表和数据设置：

```
create table UserLog (Username nvarchar(50), LogDate DateTime);

insert into UserLog Values('Test1', '2012-01-01 00:00:00');
insert into UserLog Values('Test2', '2012-01-01 00:00:02');
insert into UserLog Values('Test1', '2012-01-01 00:00:05');
insert into UserLog Values('Test3', '2012-01-01 00:00:06');
insert into UserLog Values('Test3', '2012-01-01 00:01:26');
insert into UserLog Values('Test3', '2012-01-01 00:03:22');
insert into UserLog Values('Test3', '2012-01-01 00:05:42');
insert into UserLog Values('Test3', '2012-01-01 00:00:06');
insert into UserLog Values('Test1', '2012-01-02 00:01:01');
insert into UserLog Values('Test2', '2012-01-02 00:02:50');
insert into UserLog Values('Test1', '2012-01-02 00:01:01'); 
```

然后你可以选择如下：

```
select UserName, CAST(LogDate AS DATE) as BusinessDay,
MIN(LogDate) as FirstLogEntry, MAX(LogDate) as LastLogEntry,
DATEDIFF(second,MIN(LogDate), MAX(LogDate)) as ElapsedSeconds
FROM UserLog
GROUP BY Username, CAST(LogDate AS DATE) 
```

这将产生以下结果，您可以从秒计算小时数。我根据您的示例数据显示了几秒钟，并扩展了 test3 用户：

```
UserName BusinessDay FirstLogEntry           LastLogEntry            ElapsedSeconds
-------- ----------- ----------------------- ----------------------- --------------
Test1    2012-01-01  2012-01-01 00:00:00.000 2012-01-01 00:00:05.000 5
Test2    2012-01-01  2012-01-01 00:00:02.000 2012-01-01 00:00:02.000 0
Test3    2012-01-01  2012-01-01 00:00:06.000 2012-01-01 00:05:42.000 336
Test1    2012-01-02  2012-01-02 00:01:01.000 2012-01-02 00:01:01.000 0
Test2    2012-01-02  2012-01-02 00:02:50.000 2012-01-02 00:02:50.000 0 
```

# c# - 如何通过在 HTML 文档中查找字符串来生成 xpath？

> ID：10490442
> 
> 赞同：0
> 
> 时间：2012-05-07T23:20:39.090
> 
> 标签：c#, html, xpath

我有一个 HTML 文档，我愿意找出包含某个字符串的元素的 xpath。

详细说明一下：

我的 HTML 文档是动态创建的，我没有 s 的特定名称。我感兴趣的 div 看起来像（或多或少）：

```
<div>Country: China</div>
<div>Type: Earphones</div> 
```

我想得到整个字符串“国家：中国”。为此，我想通过在 HTML 中搜索“Country:”来找到该 div 的 xpath。

我希望我足够具体...谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:40:31.107

这里有几种方法：

```
//div[contains(child::text(), "Country:")]
//div/child::text()[contains(., "Country:")]/parent::node() 
```

如果您想在浏览器中进行尝试，请尝试[浏览器中的 XPath 小书签](http://smallfixes.blogspot.com/2011/01/xpath-tester-bookmarklet.html)。

# html - 人人网、微博和百度赞按钮仅使用 HTML（无 Javascript）

> ID：10490443
> 
> 赞同：18
> 
> 时间：2012-05-07T23:20:46.137
> 
> 标签：html, url, social-networking, weibo, sinaweibo

我正在开发一个将在中国销售的网站，我想知道是否有一种方法可以为[人人](http://www.renren.com/)（类似于 Facebook）、[微博](http://weibo.com/)（类似于 Twitter）和[百度点赞](http://share.baidu.com/)（类似于 Google 的）创建“分享”按钮+1) 仅使用 HTML。

例如，对于 Facebook、Twitter 和 Google 的 +1，您将使用以下内容：

*   [http://twitter.com/share?url=http://example.com&text=Description](http://twitter.com/share?url=http://example.com&text=Description)
*   [http://www.facebook.com/sharer.php?u=http://example.com](http://www.facebook.com/sharer.php?u=http://example.com)
*   [https://plusone.google.com/_/+1/confirm?hl=en&url=http://example.com](https://plusone.google.com/_/+1/confirm?hl=en&url=http://example.com)

我知道人人使用以下内容：

*   [http://share.renren.com/share/buttonshare.do?link=http://example.com&title=Description](http://share.renren.com/share/buttonshare.do?link=http://example.com&title=Description)

但是，**我很想知道微博和百度 Like 的 HTML 唯一 URL 是什么**。

如果有帮助，这里是分享按钮的 Javascript 版本的文档：

*   [http://wiki.dev.renren.com/wiki/Xn:share-button](http://wiki.dev.renren.com/wiki/Xn:share-button)
*   [http://open.weibo.com/sharebutton](http://open.weibo.com/sharebutton)
*   [http://share.baidu.com/like/get-codes](http://share.baidu.com/like/get-codes)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-14T22:09:57.420

希望这可以帮助将来的人；以下是如何为人人、微博和百度点赞/空间/论坛/书签实现仅 HTML 的分享/点赞按钮：

**人人网**

如上所述，使用以下 URL 格式在人人网分享链接：

*   [http://share.renren.com/share/buttonshare.do?link=http://example.com&title=Description](http://share.renren.com/share/buttonshare.do?link=http://example.com&title=Description)

**微博**

以下 URL 格式将允许您以与 Twitter 相同的方式发布到您的微博帐户：

*   [http://service.weibo.com/share/share.php?url=http://example.com&appkey=&title=Description&pic=&ralateUid=&language=zh_cn](http://service.weibo.com/share/share.php?url=http://example.com&appkey=&title=Description&pic=&ralateUid=&language=zh_cn)

**百度**

百度有多种可以发帖的服务；与这篇文章相关的是百度点赞，但我也提供了百度空间、论坛和书签的 URL 以供参考：

要以与 Facebook/Google +1 相同的方式点赞链接，请使用以下 URL 结构：

*   [http://like.baidu.com/set?buttontype=small&cb=bdShare.ajax._callbacks.bd4bb141b&index=0&url=http://example.com](http://like.baidu.com/set?buttontype=small&cb=bdShare.ajax._callbacks.bd4bb141b&index=0&url=http://example.com)

我使用数据包分析器跟踪了上述 URL，据我所知，百度 Like 必须从引用页面调用，或者至少从引用域调用。回调函数`bd4bb141b`似乎并不特定于任何域或用户 ID。

* * *

请注意，我*没有*彻底测试以下 URL 结构：

*   要在百度空间分享链接，请使用以下 URL 结构：[http ://apps.hi.baidu.com/share/?url=http://example.com&title=Description](http://apps.hi.baidu.com/share/?url=http://example.com&title=Description)
*   要在百度贴吧（论坛）上分享链接，请使用以下 URL 结构：[http ://tieba.baidu.com/i/app/open_share_api?link=http://example.com](http://tieba.baidu.com/i/app/open_share_api?link=http://example.com)
*   要保存指向百度仓的链接（书签），请使用以下 URL 结构：[http ://cang.baidu.com/do/add?it=Description&iu=http://example.com](http://cang.baidu.com/do/add?it=Description&iu=http://example.com)

* * *

另外作为参考，[FeedBurner](http://feedburner.google.com/)的一个不错的中文替代品是[FeedSky](http://www.feedsky.com/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-11-10T00:50:05.583

使用我自己的网站（当前），使用 httpS 时不会显示共享按钮...但使用 http 时会显示

这是最近（2015年11月10日）微博分享按钮代码生成器的链接（滚动到底部获取代码）：

[http://open.weibo.com/sharebutton](http://open.weibo.com/sharebutton)

# qt - 从 QRegExpValidator 中删除空格

> ID：10490444
> 
> 赞同：1
> 
> 时间：2012-05-07T23:20:53.313
> 
> 标签：qt, qt4

我有一个有人写的代码

```
 this->llBankCode = new widgetLineEditWithLabel(tr("Bankleitzahl"), "", Qt::AlignTop, this);
 QRegExpValidator *validatorBLZ = new QRegExpValidator(this);
 validatorBLZ->setRegExp(QRegExp( "[0-9]*", Qt::CaseSensitive));
 this->llBankCode->lineEdit->setValidator(validatorBLZ); 
```

从这段代码可以看出，它`validatorBLZ`只能接受 0 到 9 之间的数字。我想改变它，它`validatorBLZ`也可以作为输入空格（但不能以空格开头），但是它不会显示。

示例：如果我尝试复制并粘贴格式为“22 34 44”的字符串，结果将是一个空字段。我想要发生的是字符串'22 34 44'将在字段中显示为'223444'。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:33:06.323

编写您自己的 QValidator 子类并重新实现验证**和**修复。Fixup 可以满足您的要求：以使其处于中间/可接受的方式更改输入。在您的情况下，请考虑以下代码片段进行修复：

```
fixup (QString &input) const
{
  QString fixed;
  fixed.reserve(input.size());
  for (int i=0; i<input.size(); ++i)
    if (input.at(i).isDigit()) fixed.append(input.at(i));
  input = fixed;
} 
```

（这未经测试）

validate 函数显然看起来很相似，当遇到非数字字符时返回 QValidator::Invalid 并返回 pos 中的相应位置。

如果您的 BLZ 仅限于德国，您可以轻松添加验证功能，它仅在有八位数字时返回 QValidator::Acceptable，否则返回 QValidator::Intermediate。

无论如何，编写一个自己的 QValidator，通常非常简单直接，在大多数情况下是最好的（也是最面向未来的）解决方案。正则表达式很棒，但 C++ 显然是这里更强大的语言，它还产生了一个更具可读性的验证器；）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:52:23.077

您可以尝试使用：

```
QString string = "22 34 44";
string.replace(QString(" "), QString("")); 
```

这将用非空格替换任何空格。

# php - Windows 中的 NEWLINE 转到 UNIX

> ID：10490449
> 
> 赞同：0
> 
> 时间：2012-05-07T23:21:32.723
> 
> 标签：php, windows, unix, porting

我正在Windows环境上`PHP`开发。 我有一些我读写的文件。 我确实使用了 NEWLINES 的定义（对于 Windows，对于 UNIX），但是当我移植到 UNIX 时，我是否必须将所有这些文件转换为 UNIX 文本格式？这不是许多奇怪的烦人错误的大门吗？`APACHE``xampp`

`\r\n``\n`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:25:42.453

是的，这可能是任何烦人的问题。您将需要以某种方式解决它。我使用 fstream/sstream 编写了自己的 C++ 实用程序，但有很多解决方案。实际上有一个堆栈溢出，其中提到了一些方法来做到这一点：

[如何在 Bash 脚本中将 DOS/Windows 换行符 (CRLF) 转换为 Unix 换行符 (\n)？](https://stackoverflow.com/questions/2613800/how-to-convert-dos-windows-newline-to-unix-newline-in-bash-script)

# ruby-on-rails - NoMethodError 导轨

> ID：10490450
> 
> 赞同：0
> 
> 时间：2012-05-07T23:21:32.703
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我在 lib 目录中有一个名为“Transpo.rb”的模块：

```
module Transpo
  class FT

    def getCities

      ...

    end

  end
end 
```

在控制器中我有

```
require 'Transpo.rb'

class TranspoController < ApplicationController

 def index
    @transpo = Transpo::FT.getCities()
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @transpo }
    end
  end 
```

但是当我运行“http://localhost:3000/transpor”时总是报错：

```
NoMethodError in TranspoController#index

undefined method `getCities' for Transpo::FT:Class 
```

为什么？我已经在 application.rb 中设置了 auto_load 库，但仍然遇到同样的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:23:23.427

`getCities`被定义为实例方法，但您将其称为类方法。

要么用类似的东西创建一个实例，要么将to`instance = Transpo::FT.new`的定义更改为使其成为类方法。`getCities``def self.getCities`

# django - 在 django 表单向导中使用不同的模板

> ID：10490455
> 
> 赞同：3
> 
> 时间：2012-05-07T23:21:49.307
> 
> 标签：django, django-forms, django-formwizard

我正在查看文档，但我不太确定如何为每个步骤使用不同的模板......

我查看了源代码，似乎模板名称是硬编码的：

```
class WizardView(TemplateView):
    """
    The WizardView is used to create multi-page forms and handles all the
    storage and validation stuff. The wizard is based on Django's generic
    class based views.
    """
    storage_name = None
    form_list = None
    initial_dict = None
    instance_dict = None
    condition_dict = None
    template_name = 'formtools/wizard/wizard_form.html'

........... 
```

文档说了一些关于 mixins 的内容，但我不知道如何使用它们，因为我刚开始使用 django ......

谢谢

* * *

更新：

我进一步查看了源代码并意识到有一个方法`get_template_names`。

我试过：

```
class AddWizard(SessionWizardView):
        def get_template_names(self, step):
                if step == 0:
                        return 'business/add1.html'
                return 'business/add2.html'
        def done(self, form_list, **kwargs):
                return render_to_response('business/done.html', {
                        'form_data': [form.cleaned_data for form in form_list],
                }) 
```

但出现错误：

`get_template_names() takes exactly 2 arguments (1 given)`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-07T23:42:29.483

`get_template_names`不接受论据。您不能只为要接受的函数定义一个新参数并希望框架将其传递进来！（用于您将来的故障排除）

从`WizardView`来源来看，您似乎可以访问当前活动的步骤`self.steps.current`，您可以通过该步骤在`get_template_names`视图中返回包含该步骤的路径。

```
class AddWizard(SessionWizardView):
        def get_template_names(self):
            return ['step_{0}_template.html'.format(self.steps.current)] 
```

我不确定`current`是字符串还是整数还是什么 - 但看看视图，你应该会发现一个有用的“找不到名为 X 的模板”错误。

# php - PHP Pathfinder 不返回结果

> ID：10490461
> 
> 赞同：-1
> 
> 时间：2012-05-07T23:22:43.893
> 
> 标签：php

我一直在尝试从其他语言的示例中创建一个 PHP 路径查找器，并根据我的游戏需要对其进行了调整，但它没有返回任何值。

我应该注意 - 我的错误日志文件中也没有错误，所以我猜它是一个逻辑错误？

希望有人能发现它，因为我看不到错误=/

代码： http: [//www.paste.to/NDI3MTE1](http://www.paste.to/NDI3MTE1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:26:16.607

只是看了一眼，但是：

```
function findpath($sx, $sy, $sdata) {
    if( in_array($sx, $sdata) && in_array($sy, $sdata($sx) ) ){
        ...
    }
}

$sdata = array(
           "13" => ...,               
           "14" => ...,    
           "15" => ...
);

$astar = findpath(13,15,$sdata); 
```

`in_array`检查数组值，而不是键......因此，您的整个函数甚至什么都不做。用于`array_key_exists`此。

# azure - 对于 Hadoop，选择哪种数据存储，Amazon S3 还是 Azure Blob Store？

> ID：10490463
> 
> 赞同：2
> 
> 时间：2012-05-07T23:22:48.273
> 
> 标签：azure, hadoop, amazon-web-services, emr

我正在处理一个 Hadoop 项目并在我的本地集群中生成大量数据。不久之后，我将使用基于云的 Hadoop 解决方案，因为与实际工作负载相比，我的 Hadoop 集群非常小，但是我现在无法选择我将使用哪一个，即基于 Windows Azure、EMR 或其他。我正在本地生成大量数据，并希望将这些数据存储到一些基于云的存储中，因为我稍后将很快将这些数据与 Hadoop 一起使用。

我正在寻找建议，以根据某人的经验决定选择哪个云存储。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T04:34:20.997

首先这是一个很好的问题。让我们试着了解一下“数据在 Hadoop 中是如何处理的”：

1.  在 Hadoop 中，所有数据都在 Hadoop 集群上处理，这意味着当您处理任何数据时，该数据会从其源复制到 HDFS，这是 Hadoop 的重要组成部分。
2.  仅在您在其中运行 Map/Reduce 作业以获取结果后将数据复制到 HDFS 时。
3.  这意味着无论您的数据源是什么以及在哪里（Amazon S3、Azure Blob、SQL Azure、SQL Server、本地源等），您都必须将数据从源移动/传输/复制到 HDFS，在Hadoop的限制。
4.  在 Hadoop 集群中处理数据后，结果将存储在您在作业中配置的位置。输出数据源可以是 HDFS 或可从 Hadoop 集群访问的外部位置

5.  将数据复制到 HDFS 后，您可以将其保留为一个 HDFS，但您必须为使用 Hadoop 集群付出代价。

6.  在某些情况下，当您在某个间隔之间运行 Hadoop 作业并且可以更快地完成数据移动/复制时，最好有一个策略来 1）获取 Hadoop 集群 2）复制数据 3）运行作业 4）释放集群。

因此，基于上述详细信息，当您为 Hadoop 集群选择云中的数据源时，您必须考虑以下几点：

1.  如果您要处理大数据（这在 Hadoop 集群中很常见），请考虑不同的数据源以及将数据从这些数据源复制/移动到 HDFS 所需的时间，因为这将是您的第一步。

2.  您需要选择一个必须具有最低网络延迟的数据源，以便您可以尽可能快地输入和输出数据。

3.  您还需要考虑如何将大量数据从当前位置移动到任何云存储。最好的选择是拥有一个可以发送数据磁盘（HDD/磁带等）的存储空间，因为上传多个 TB 数据将花费大量时间。

4.  Amazon EMR（已经可用）、Windows Azure（CTP 中的 HadoopOnAzure）和 Google（预览中的 BigQuery，基于 Google Dremel）在云中提供了预配置的 Hadoop 集群，因此您可以选择想要运行 Hadoop 作业的位置，然后您可以考虑云存储。

5.  即使您选择一个云数据存储并决定迁移到另一个，因为您想在云中使用其他 Hadoop 集群，您当然可以传输数据，但请考虑您可用的时间和数据传输支持。

6.  例如，使用 HadooponAzure，您可以连接各种数据源，即 Amazon S3、Azure Blob 存储、SQL Server 和 SQL Azure 等，因此各种数据源是任何云 Hadoop 集群的最佳选择。

# c# - 从 List 中隐式删除泛型参数

> ID：10490469
> 
> 赞同：2
> 
> 时间：2012-05-07T23:23:08.170
> 
> 标签：c#

TL；DR：（标题给出了它）我可以`List<T>`在一次转换中“隐式地从”中删除通用参数吗？

今天一位朋友问我是否可以将 a 隐式转换`List<T>`为非泛型包装器。

```
var list = new List<_some_type_>();
ObjectResult result = list; 
```

该方法看起来像这样：

```
public static implicit operator ObjectResult(List<T> list) { ... } 
```

显然，`T`这里没有定义，并且隐式运算符的方法名称是类型名称，因此除非类型实际上是通用的，否则您不能在方法名称中包含通用参数，即：

```
class ObjectResult<T> { ... } 
```

代替

```
class ObjectResult { ... } 
```

我们对用户定义的转换的限制是（我错过了什么吗？）：

1.  无法转换为 Base 类型或从 Base 类型转换
2.  无法转换为接口或从接口转换。
3.  必须将转换包含在两种类型之一中。

是什么让`List<T>`这么难：

1.  `List<T>`的唯一推导来自`Object`; 因此我们必须直接从`List<T>`
2.  `List<T>`只有接口，再次，必须直接来自`List<T>`
3.  `List<T>`，显然，是在框架中编译出来的，所以，它一定是来自我们的包装器

我想到了一个两步解决方案，其中有一个我们可以转换的中间人（而唯一的中间人`List<T>`is `Object`，并且由于规则#1，这不是一个选项）。

```
public class ObjectResult
{
  public static implicit operator ObjectResult(WrapperBase arg) { ... }
}

public class WrapperBase { }

public class ObjectResultWrapper<T> : WrapperBase
{
  public static implicit operator ObjectResultWrapper<T>(List<T> arg) { ... }
} 
```

然后，调用代码将如下所示：

```
var list = new List<int>();
ObjectResultWrapper<int> wrap = list;
ObjectResult result = wrap; 
```

这并不能真正解决问题，它只是一种`T`隐式删除的解决方法（但分两步，而不是一步）。在这一点上，有一个辅助方法会更容易，而不是使用用户定义的转换。

可能存在反对隐含放弃通用论点的目标的论点——我没有其他任何关于他为什么认为这很重要的东西。认为这只是一个学术问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:18:47.200

答案：**不，你不能用隐式强制转换来做到这一点。**

备择方案：

我认为最好的方法是静态`ObjectWrapper.FromList<T>(List<T>)`方法。

wrapper cast 也是一种选择，虽然没有那么优雅。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T02:13:50.293

声明一个静态的“转换”函数而不是尝试声明一个转换运算符怎么样？然后你可以使用编译器的类型推断做这样的事情（调用转换方法`From`）：

```
List<int> list = new List<int>();
ObjectResult result = ObjectResult.From(list); 
```

该`From`方法可能如下所示：

```
public class ObjectResult
{
    //...
    public static ObjectResult From<T>(T arg) { return new ObjectResult<T>(arg); }
    //...
}
public class ObjectResult<T> : ObjectResult
{
    //...
    public ObjectResult(T obj) { /* ... some implementation ... */ }
    //...
} 
```

# javascript - JSON+Javascript/jQuery。如何从 json 文件中导入数据并解析？

> ID：10490473
> 
> 赞同：21
> 
> 时间：2012-05-07T23:23:35.543
> 
> 标签：javascript, jquery, json, getjson

如果我有一个`JSON`名为**names.json**的文件：

```
{"employees":[
    {"firstName":"Anna","lastName":"Meyers"},
    {"firstName":"Betty","lastName":"Layers"},
    {"firstName":"Carl","lastName":"Louis"},
]} 
```

如何在 javascript 中使用其内容？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-07T23:45:37.280

如何做到这一点的一个例子可能是：

```
<html>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript">
    $(function(){
        $.getJSON('names.json',function(data){
            console.log('success');
            $.each(data.employees,function(i,emp){
                $('ul').append('<li>'+emp.firstName+' '+emp.lastName+'</li>');
            });
        }).error(function(){
            console.log('error');
        });
    });
</script>
</head>
<body>
    <ul></ul>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-04-02T16:10:35.673

您可以简单地在 HTML 中包含一个将 JSON 对象声明为变量的 Javascript 文件。`data.employees`然后，您可以使用例如从您的全局 Javascript 范围访问您的 JSON 数据。

索引.html：

```
<html>
<head>
</head>
<body>
  <script src="data.js"></script>
</body>
</html> 
```

数据.js：

```
var data = {
  "employees": [{
    "firstName": "Anna",
    "lastName": "Meyers"
  }, {
    "firstName": "Betty",
    "lastName": "Layers"
  }, {
    "firstName": "Carl",
    "lastName": "Louis"
  }]
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-07T23:43:14.190

您的 JSON 文件不包含有效的 JSON。请尝试以下操作。

```
 {
     "employees": 
     [
         {
             "firstName": "Anna",
             "lastName": "Meyers"
         },
         {
             "firstName": "Betty",
             "lastName": "Layers"
         },
         {
             "firstName": "Carl",
             "lastName": "Louis"
         }
     ]
 } 
```

然后，您应该会看到响应。查看[http://jsonlint.com/](http://jsonlint.com/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-07T23:27:02.110

在 jQuery 代码中，您应该拥有该`employees`属性。

```
data.employees[0].firstName 
```

所以它会是这样的。

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
</head>
<body>
<script type="text/javascript">
    $.getJSON("names.json", function(data) {
        console.log(data);
        $('body').append(data.employees[0].firstName);
    });
</script>
</body>
</html> 
```

当然，对于非 jQuery 版本，您也需要该属性，但您需要先解析 JSON 响应。

另请记住，这`document.write`会破坏您的整个页面。

* * *

如果您仍然遇到问题，请尝试完整的`$.ajax`请求而不是`$.getJSON`包装器。

```
 $.ajax({
        url: "names.json",
        dataType: "json",
        success: function(data) {
            console.log(data);
            $('body').append(data.employees[0].firstName);
        },
        error: function(jqXHR, textStatus, errorThrown) {
            console.log('ERROR', textStatus, errorThrown);
        }
    }); 
```

[http://api.jquery.com/jquery.ajax/](http://api.jquery.com/jquery.ajax/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-07T23:27:52.427

如果你想使用 PHP。

```
<?php
    $contents = file_get_contents('names.json');
?>
<script>
    var names = <?php echo $contents; ?>
    var obj = JSON.parse(names);

    //use obj
</script> 
```

可选地，使用它异步：

```
<script>
    $(document).ready(function(){
        $.get("get_json.php?file=names",function(obj){
            //use obj here          
        },'json');
    });
</script> 
```

PHP：

```
<?php
    $filename = $_GET['file'] . '.json';
    $data['contents'] = file_get_contents($filename);
    echo json_encode($data);
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-16T18:27:51.880

对于那些在 JQuery 倒下后由 Google 发送到这里的人，请使用[Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)

```
fetch("test.json").then(async (resp) => {
  const asObject = await resp.json();
  console.log(asObject);
}) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-11T18:37:43.527

我知道答案是很久以前给出的，但这个结果在谷歌上显示在第一位。

但是我不想使用 jquery，所以在 vanilla JS 中，[我发现这个快速教程](https://codepen.io/KryptoniteDove/post/load-json-file-locally-using-pure-javascript)比 senornestor 答案更干净（它还允许根据变量加载文件）：

```
function loadJSON(filelocation, callback) {   

  var xobj = new XMLHttpRequest();
  xobj.overrideMimeType("application/json");
  xobj.open('GET', filelocation, true); // Replace 'my_data' with the path to your file
  xobj.onreadystatechange = function () {
    if (xobj.readyState == 4 && xobj.status == "200") {
      // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
      callback(xobj.responseText);
    }
  };
  xobj.send(null);  
}

function init() {
  var location = "myfile.json";
  loadJSON(filelocation=location,  function(response) {
    // Parse JSON string into object
    loadedJSON = JSON.parse(response);
    console.log(loadedJSON.somethingsomething);
  });
}

init(); 
```

并在您的 html 文件中：

```
`<script src="myscript.js"></script>` 
```

# c++ - 如何使用 CMake 包含 NTL

> ID：10490474
> 
> 赞同：1
> 
> 时间：2012-05-07T23:23:36.793
> 
> 标签：c++, cmake, gmp, ntl

我使用这一行来编译一个简单的程序：

```
g++ main.cc -lntl -lm -lgmp 
```

你如何将它包含到 CMake 中？

```
find_package(NTL REQUIRED)
find_package(GMP REQUIRED) 
```

不工作。并给出以下错误：

```
CMake Error at CMakeLists.txt:30 (find_package):
  Could not find module FindNTL.cmake or a configuration file for package
  NTL.
...
. 
```

和

```
SET(CMAKE_CXX_FLAGS ${CMAKE_CXX_FLAGS} -std=c++0x -lntl -lm -lgmp) 
```

也不起作用（但我认为这通常是错误的）。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:52:31.817

If `ntl`, `m`, and `gmp` libraries are usually installed to somewhere in the default path (e.g. `/usr/` or `/usr/local/`), you could simply do something like:

```
cmake_minimum_required(VERSION 2.8 FATAL_ERROR)
project(Test)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++0x")
add_executable(test main.cc)
target_link_libraries(test ntl m gmp) 
```

This is probably closest to your original g++ command, but it isn't very robust however; if any of the libraries aren't found, you won't know about it until you try linking. If you want to fail at configure time (i.e. while running CMake), you could add `find_library` calls for each of the required libs, e.g.

```
find_library(NTL_LIB ntl)
if(NOT NTL_LIB)
  message(FATAL_ERROR "ntl library not found.  Rerun cmake with -DCMAKE_PREFIX_PATH=\"<path to lib1>;<path to lib2>\"")
endif() 
```

You'd then have to change your `target_link_libraries` command to

```
target_link_libraries(test ${NTL_LIB} ${M_LIB} ${GMP_LIB}) 
```

You'd probably also then have to do a `find_file` for one of each lib's header files to find out the appropriate path to add via the `include_directories` command (which translates to `-I` for g++).

Note, it's important to put quotes around the extra CXX_FLAGS arguments, or CMake treats them like separate values in a list and inserts a semi-colon between the flags.

For further information about `find_library`, `find_file`, etc. run:

```
cmake --help-command find_library
cmake --help-command find_file 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T23:56:01.460

关于你的错误：

看起来`FindNTL.cmake`CMake 中没有包含模块。这意味着您必须：

*   自己写`FindNTL.cmake`，
*   再找一个别人写的，
*   破解一个解决方案：
    *   检查是否安装了 NTL
    *   提供链接目标、相关标志等。

从（相当快速的）谷歌搜索中，似乎有人有[一个用于 CMake 的 NTL 模块](https://github.com/vernamlab/cuHE/blob/master/cuhe/cmake/FindNTL.cmake)。由于 NTL 使用 GMP，您可能需要[CMake 相关的 GMP 模块](https://github.com/vernamlab/cuHE/blob/master/cuhe/cmake/FindGMP.cmake)。它看起来不像一个功能齐全的 CMake 模块，但它似乎也是最好的东西（再次，它是一个*快速*的谷歌搜索，我不使用 NTL）。

要使用，你需要在你的`CMakeLists.txt`:

```
# Let CMake know where you've put the FindNTL.cmake module. 
set(CMAKE_MODULE_PATH "${CMAKE_CURRENT_SOURCE_DIR}/build/CMake/Modules")
# Call the FindNTL module:
find_package(NTL REQUIRED) 
```

* * *

> SET(CMAKE_CXX_FLAGS ${CMAKE_CXX_FLAGS} -std=c++0x -lntl -lm -lgmp)

是的，这是错误的。你不想`CXX_FLAGS`用*链接*指令设置你的。我会使用：

```
SET ( CMAKE_CXX_FLAGS ${CMAKE_CXX_FLAGS} -std=cxx0x ) 
```

设置您要使用的 Cxx 标准。要实际链接到库，您需要：

*   确保您找到了库（带有相关`find_package ( FOO )`行）
*   将它们与您的目标联系起来，如下所示：

    ```
    # Build the Foo executable. (Or library, or whatever)
    add_executable (FooEXE ${Foo_SOURCES} )
    target_link_libraries (FooEXE
        ${bar_LIBRARIES}
        ${baz_LIBRARY}
        ) 
    ```

    请注意！`${bar_LIBRARIES}`并且`${baz_LIBRARY}`不是错字；没有在`FindFOO.cmake`模块中设置相关库的标准方法，在我看来，这很烦人。如果一个不起作用，请尝试另一个，或者，在最坏的情况下，查看相关`FindFOO.cmake`文件（默认情况下安装了一堆 CMake）以查看每个文件的用途。通过我提供的链接，您可以使用 ${NTL_LIB} 和 ${GMP_LIB}。

# iphone - iPhone touchesBegian 无法在 iPad 上工作，x 和 y 始终为零

> ID：10490477
> 
> 赞同：0
> 
> 时间：2012-05-07T23:23:52.770
> 
> 标签：iphone, ios

我有一个双应用程序，并将 touchesBegan 的代码块从 iPhone 代码复制到 iPad。我没有进行任何更改，并且该方法总是在第一次触摸时为 x 和 y 给我一个零。

代码块：

```
-(void) touchesBegan: (NSSet *) touches withEvent: (UIEvent *) event {

  int iCardId;

  NSSet *allTouches = [event allTouches];

  // we are dealing with one finger get first touch

  // get first touch
  UITouch *touch=[[allTouches allObjects] objectAtIndex:0];

  // get the x and y
  CGPoint pt    = [touch locationInView: self.view];
  float x=pt.x; // this is always a zero
  float y=pt.y; // this is always a zero
  .........
  .........
  .........
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:36:43.397

我一直认为获得 a 的正确方法`UITouch`是使用`[touches anyObject]`. 试试看你是否仍然得到`(0,0)`.

***编辑/更新***

我设置了一个新的单视图应用程序并将以下代码放入`UIViewController`：

```
-(void) touchesBegan: (NSSet *) touches withEvent: (UIEvent *) event {
    NSSet *allTouches = [event allTouches];
    // we are dealing with one finger get first touch
    // get first touch
    UITouch *touch=[[allTouches allObjects] objectAtIndex:0];
    // get the x and y
    CGPoint pt = [touch locationInView:[self view]];
    NSLog(@"(%f,%f)", pt.x, pt.y);
} 
```

它似乎给了我适当的坐标。你把你的代码放在哪里了？

# android - 在后台线程中安全地取消 ORMLite 写入

> ID：10490479
> 
> 赞同：2
> 
> 时间：2012-05-07T23:24:00.913
> 
> 标签：android, multithreading, sqlite, ormlite

我正在 Android 中设计一个模块，该模块进行一些处理，然后使用 ORMLite 事务写入数据库。特别是，我的背景代码将类似于：

```
public class BackgroundOperation implements Runnable {
        @Override
    public void run() {
        //Do some stuff

        //Write to the database in a transaction
        try {

            ORMHelper h = ORMHelper.getDefaultOrmHelper();
            final MyModel modelObj = h.myModelDao.queryForId(someId);
            TransactionManager.callInTransaction(
                h.getConnectionSource(),
                new Callable<Void>() {
                    public Void call() throws Exception {
                        modelObj.col1 = 10;
                        modelObj.col2 = "hello";
                        h.myModel2Dao.update(modelObj);
                        h.myModel2Dao.create(new MyModel2("a", "b"));
                        return null;
                    }
                }
            );
        }
        catch (Exception e) {
            return null;
        }
    }
} 
```

然后，这个可运行文件将通过提交给 ThreadPoolExecutor 来执行。如果需要，我希望能够取消后台线程，并试图确保如果操作被取消，那么事务将简单地失败并且什么都不做。例如，如果我这样做：

```
Future f = myThreadPoolExecutor.submit(new BackgroundOperation());

//Some time later
f.cancel(true); 
```

我可以确定这将是全有或全无处理 ORMLite 中的交易。也就是说，不需要清理，我的 modelObj 将同时设置 col1 和 col2 或都不设置？在 Runnable 中捕获 InterruptedException 以处理以这种方式取消任务的情况时，我是否需要做任何特别的事情，或者我可以简单地退出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T01:17:39.813

如果您调用`f.cancel(true)`，所做的只是中断`Thread`导致`wait()`,`sleep()`和其他一些抛出的方法`InterruptedException`。它*不会*取消正在进行的数据库事务。

如果需要，您可以在 IO 操作中间检查中断位：

```
h.myModel2Dao.update(modelObj);
if (Thread.currentThread().isInterrupted()) {
   throw new RuntimeException("Thread was interrupted");
}
h.myModel2Dao.create(new MyModel2("a", "b")); 
```

有关线程中断时发生的情况的更多信息，请参见此处：

> [java.lang.Thread.interrupt() 有什么作用？](https://stackoverflow.com/questions/3590000/what-does-java-lang-thread-interrupt-do)

* * *

事务用于将多个对象作为一个单元更新或写入多个表时。请参阅[有关事务的文档，](http://ormlite.com/docs/transactions)其中包含更新事务的 an`Account`和`Order`inside 的示例。

此外，如果要更新同一行中的多个字段，则不需要使用事务。更新语句被认为是一个单一的单元，数据库应该确保该行自动更新。只有当您在同一个表或不同的表中更新多个*不同的行时，您才需要事务。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:39:02.193

ORMLite 将在幕后利用 sqlite 事务。这很可能是双阶段提交，它只允许您将事务作为一个整体提交。

简而言之，您可以放心 col1 和 col2 只会被修改为单个原子单元。此外，如果被中断，提交将失败，对 col1 和 col2 的更改将被回滚。

# selenium-ide - Selenium IDE 中的选择值

> ID：10490480
> 
> 赞同：0
> 
> 时间：2012-05-07T23:24:04.877
> 
> 标签：selenium-ide

有没有办法根据包含一组字符的标签来选择一个项目？我不能按索引选择，因为它会改变，并且在选择中生成的项目最后会附加一些随机数。我想基本上说标签是否包含“这个”。

那可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-15T20:31:42.387

另一个例子

```
<label for="blah">
     <input name="blah" id="blah" type="checkbox" />
     Store Locator Plus
</label> 
```

我获得复选框的目标：

```
//label[contains(text(),'Store Locator Plus')]//input[@type="checkbox"] 
```

为了检查它，我使用命令“check”，上面提到的目标，以及“On”的值，这会强制标记复选框（而不是使用 click 来打开/关闭它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T14:18:20.613

当然，XPath 中的示例：

```
//*[contains(text(), 'this')] 
```

或 CSS：

```
select:contains('This') 
```

# c# - 从 CodeBehind 调用 Javascript 函数并返回值

> ID：10490483
> 
> 赞同：0
> 
> 时间：2012-05-07T23:24:31.913
> 
> 标签：c#, javascript, webforms, code-behind

我有一些看起来像这样的代码，都在代码隐藏中......

```
var script = "confirm('Would you like to close this order?')";
ClientScript.RegisterStartupScript(typeof(Page), "CloseOrder", script, true); 
```

如何获取用户是否在下一行单击是或否的值？是否有可能当此脚本触发时，它会返回该值并在代码隐藏的下一行继续？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:30:32.200

```
var script = function(){
    var choice = confirm('Would you like to close this order?');
    if(choice){
        //If the user clicks yes
    }else{
        //If the user clicks no
    }
}
ClientScript.RegisterStartupScript(typeof(Page), "CloseOrder", script, true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:30:53.040

这里的简单示例：http: [//jsfiddle.net/ChaseWest/W569P/](http://jsfiddle.net/ChaseWest/W569P/)

改变：`var script = "confirm('Would you like to close this order?')";`

至：`var script = confirm('Would you like to close this order?');`

这将根据确认弹出框的是或否将真或假保存到脚本中。

# windows-7 - 如何使 FFMPEG 在 CMD 中可访问

> ID：10490485
> 
> 赞同：0
> 
> 时间：2012-05-07T23:24:45.717
> 
> 标签：windows-7, ffmpeg

我需要从 Windows 7 中的 CMD 提示符访问 FFMPEG。我认为这与设置环境变量有关，但我不记得如何了。

保重，李

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:38:36.720

您需要将 ffmpeg bin 位置（即 C:/Program Files/ffmpeg/bin 或安装它的位置）添加到系统 PATH 环境变量中。有关如何执行此操作的信息，请参见[此处。](http://www.computerhope.com/issues/ch000549.htm)

# .net - 架构 - 为 .NET 应用程序选择 NoSQL

> ID：10490489
> 
> 赞同：3
> 
> 时间：2012-05-07T23:25:16.103
> 
> 标签：.net, architecture, nosql

这个问题是关于选择“正确”类型的 NoSQL 数据库，我希望甚至可以根据我将在下面列出的一些要求/用例以及目前在地方。这有点长，但我认为关于这个主题的任何讨论都对那些试图学习新范式的人非常有益。有很多关于 NoSQL 的讨论，但据我所见 - 它们中的大多数都是高级别的，并没有为新手提供足够的洞察力。

所以，它来了：

在我的大部分编程生涯（15 年）中，我一直在针对传统的 RDBMS/SQL 系统进行开发，并且在这方面有很好的经验。最近，关于 NoSQL 及其有用性的话题引起了轰动——所以我很想了解它如何带来好处。我描述的系统比我见过的普通 TODO 或日历示例要复杂一些，因此可以进行很好的讨论。

该系统与相对复杂的蜂窝网络有关——在这样的网络中大约有 300 个“类”（并且“完全部署”可以有多个网络，并且可以增长到 1000 个或更多类）具有不同数量的实例（每个 100,000 - 10 秒）。每天（有时一天几次）将其加载到数据库中以驱动系统。类之间的关系要么是包含，要么是“使用”。领域变化相对较快（网络软件更新之间大约 3 个月，每次通常意味着向现有类添加参数并添加一些（10-20）个新类）。

系统的使用（用例）如下： 0\. 解析数据（进入数据容器层次结构）并将其加载到关系数据库（通常来自大约 2GB 的 XML 文件）

1.  查看属性（如“select field1, field2 from table1 where ids in ()”并以表格格式查看
2.  跟踪变化（今天和昨天之间的变化 - 参数谁的值已更改和添加/删除实例
3.  检查业务规则：
    *   它可以很简单（SELECT idField1...idFieldN, paramValue FROM table where paramValue<>default”
    *   或更复杂 - 检查关系 - 例如 x 类型的子项数量等
4.  检索类的所有层次结构 - 选择特定的类实例、其子级，有时还选择实例或其子级使用的类
5.  对类实例进行更改并推回网络（然后查看它确实已执行 - 验证更改）。这通常需要根据类的层次结构生成一些 XML 文件。

在 RDBMS 解决方案中，为了克服这些要求，我将数据映射到关系表（每个表都有一个类），然后保存一个元数据和关系字典。此外，为数据检索任务创建了一个通用数据容器（类类型名称 + 键值（或值））或使用可以合并到视图或文件中的 DataTables。

这种架构（平台）意味着在升级时我所要做的就是更新/创建表（更改/创建表）并更新元数据和关系 - 其余代码是“通用的”并由元数据驱动。唯一的例外是上面的 (4)，有时需要我进行硬编码（将子级添加到数据检索层次结构中），尽管最终我也概括了这个过程（分层数据检索 - 基于父级的 id 获取子元素等）等级制度）。

该系统在大多数情况下运行良好，但有时速度太慢（尤其是在 4 中）。缓慢与从数据库中检索数据有关，但仅在某些部署中，它可能与维护不善或硬件不足（或编程不当，但为什么它在其他部署中运行良好？-）有关

我要补充一点，由于域是一个网络，每个实例都有一个不同的名称 - 通常由它的层次结构组成（实例及其父级，例如“Node=ER222,Subrack=3,Slot=5”或“Node=ER222,Equipment =1,Sector=2,Carrier=C2") 并且每个类的层次结构通常是相同的（尽管有些类可以出现在多个层次结构中（例如具有不同的祖先）

通常系统上的负载并不多——可能多达 50 个活跃用户，但通常要少得多。在更大的网络中，这可能会增长到 300-400 个用户。

现在我想开发一个具有类似要求的系统，并且正在考虑 NoSQL 可能带来的优势：

*   我读到动态模式或无模式 NoSQL 是一个自然的选择。
*   我读到图形数据库非常适合建模“网络”（或类似网络），所以也许这可能是一个解决方案（节点=类，边缘=包含或使用（在边缘具有属性））。
*   也许使用一些文档数据库并只保留部分解析的 XML 并通过层次结构访问它？
    *   如何从特定类中选择特定字段 - 我是否必须为此生成可怕的 XPath 查询？
*   也许是一个对象数据库？
    *   但是然后 - 我是否必须保留 1000 个或更多 POCO 的（臃肿）模型？序列化/反序列化有多容易？

除了上述之外，我正在使用 .NET 技术进行开发，所以如果有人有特定的想法 - 更好的适合这个生态系统或者至少可以使用 .NET 开发（例如 REST/THRIFT 接口和匹配的 .NET API）

如果你读得那么远——我非常感激，如果你愿意加入——更是如此；-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T07:42:11.563

好的，这只是我的拙见，但一般来说，RDBMS 是具有人们认为理所当然的功能的工具，直到他们离开它们然后讨厌他们切换到的 NoSQL 产品，因为他们不应该首先切换地方。一般来说，根据炒作切换*总是错误的。*还要记住，与 RDBMS 相比，NoSQL 数据库通常非常有限和专门化，因此你往往放弃的比你得到的要多。对不起，事情就是这样。最后，关系数据库管理系统往往非常擅长优化事情，以至于间歇性性能问题可能很难追踪，但至少您并没有自己进行所有优化。

因此，在阅读了所有您可能认为我认为您应该排除 NoSQL 的内容后，但我不是。我的意思是你应该谨慎对待它。NoSQL 数据库通常针对非常小的领域进行了很好的优化，因此在通用任务上往往表现不佳。另一方面，这种优化有时会让它们变得有用。

而不是用 NoSQL 数据库替换您的关系数据库，问题可能是您是否可以使用一些 NoSQL 数据库作为存储/缓存/预处理的辅助引擎，从而避免您当前遇到的一些问题。在这个观点中，NoSQL 数据库属于传统关系处理系统的附属品。我将在这里查看图形和文档数据库，作为关系数据库的预处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T08:00:27.960

正如 Chris 所说，您应该记住，在 RBMS 世界中您认为理所当然的许多事情在 NoSQL 数据库中经常缺失。您应该记住的另一件事是，NoSQL 是一个涵盖许多技术的非常广泛的术语，因此从这个意义上说，您的问题缺乏焦点。

您在 .NET 中进行开发，因此具有良好集成的 NoSQL 数据库并不多见。您可以考虑的文档数据库是[RavenDB](http://ravendb.net/)。它是用 .NET 编写的（您可以将索引和查询编写为 Linq），它是事务性的（就更新数据而言——尽管索引最终是一致的）并且它是面向文档的（即无模式）。

您可以在[此处](http://ravendb.net/docs/client-api/querying/handling-document-relationships)查看如何在 RaveDB 中处理关系，但请注意，如果您的大多数查询都是图遍历，则您可能需要一个图数据库

# facebook - 如何将默认 FB App 设置从 Only Me 设置为 Friends？

> ID：10490494
> 
> 赞同：0
> 
> 时间：2012-05-07T23:25:46.157
> 
> 标签：facebook, facebook-opengraph

我一直无法在 FB / API 文档中找到答案，我希望有人能指出我正确的方向。

当我点击我的测试应用程序时，它要求我授予它权限，其中一个下拉菜单设置为“仅限我”，因此该应用程序发送的任何更新都只能由我看到。我希望我的朋友也能看到它。

我一切正常，只需要知道如何更改该特定设置！

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T02:44:37.230

我猜你在谈论 Auth Dialog。
该[文件](https://developers.facebook.com/docs/opengraph/authentication/#configure)称，默认隐私设置遵循用户的默认隐私权限。

> 默认活动隐私：此字段使用默认操作可见性设置设置身份验证对话框，用户可以在授权您的应用程序时更新该设置。默认情况下，此值设置为无，这意味着您发布的操作将遵循用户的默认隐私权限。用户的默认隐私权限（最初由用户通过隐私设置页面设​​置）适用于用户在 Facebook 上发帖的任何时间。如果用户将其更改为好友，则权限将仅更新为好友。如果用户将其更改为公开，您的应用活动将变为公开操作。可能的设置：无、朋友、仅限我或公开。用户还可以通过身份验证对话框更改活动隐私设置。

因此，基本上默认值取决于每个安装用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T09:34:24.697

转到开发者页面。应用程序 > Your_APP_NAME > 设置 > 权限 > 默认活动隐私并将您想要的任何内容设置为默认值。如果您没有设置任何内容，那么它将遵循“Go Hagiwara”回答的用户默认值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-14T09:28:13.370

这现在位于应用程序 > YOUR_APP_NAME > 应用程序详细信息 > 配置应用程序中心权限 > 默认活动隐私

# java - 如何从 Java 代码访问小程序？

> ID：10490496
> 
> 赞同：2
> 
> 时间：2012-05-07T23:25:53.827
> 
> 标签：java, applet

我们正在开发一个应用程序，它可以访问在某些嵌入式系统上公开的 API。此 API 在内部验证用户以提供对嵌入式系统的访问权限。为了验证呼叫，它会打开一个对话框并询问用户名和密码。这个对话框本质上是一个在小程序查看器中打开的 Java 小程序。

我们希望通过构建小型 exe 或在 tomcat 服务器中执行相同的操作来自动化整个过程。为此，我们需要获取对话框的对象并填写凭据。我们怎样才能做到这一点。必须有某种方法可以自动测试可用于完成上述任务的小程序。

感谢您的帮助。如果有人可以提供相同的代码片段或链接，那就太好了:)

*我想要这种系统的原因：*

*我们需要构建一个应用程序来获取 PLC 设备的内存状态。该设备与重型机器相连，并通过数字网络拥有自己的编程语言。为了获取内存映射，在 java 中公开了与汇编语言通信的 API。我们使用这些 API 从 PLC 设备中获取各种内存变量的内存状态。根据内存状态，我们通过发送电子邮件或 SMS 发出警报。* ***当我们第一次尝试访问该设备的内存区域时，它会弹出一个授权对话框，要求输入 PLC 设备的用户名和密码。***

*因此，为了自动化可以发送警报的内存监控系统，我们必须通过java程序或其他方式填写授权对话框。当我从 Java 控制台程序访问 PLC 的内存时，我们需要这个授权对话框自行填充，而无需任何手动干预。*

*那么，我们怎样才能得到这个对话框的对象呢？*

我希望情况很清楚。我们不需要构建任何可以自动化小程序 UI 的框架。我们只需要特定的对话框。请帮忙！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T04:37:24.433

您可以使用任意数量的 Java GUI 功能测试工具。这是一个很好的列表，看起来 FEST 或 Jemmy 可能是一个好方法：

[Java Swing GUI 的自动化测试](https://stackoverflow.com/questions/91179/automated-tests-for-java-swing-guis)

看起来它们都建立在上面，`java.awt.Robot`所以如果你想自己动手，你可以看看。

如果这不起作用，您可能必须使用本机 GUI 测试框架。此处为 Windows 列出了一些不错的选项：

[https://stackoverflow.com/questions/120359/tools-for-automated-gui-testing-on-windows](https://stackoverflow.com/questions/120359/tools-for-automated-gui-testing-on-windows)

[http://sikuli.org/](http://sikuli.org/)不错。

# php - 如何从此xml在php中生成soap请求？

> ID：10490497
> 
> 赞同：4
> 
> 时间：2012-05-07T23:26:00.017
> 
> 标签：php, xml, soap, request

我厌倦了尝试使用 SOAP 发送请求。这是我的xml

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tem="http://tempuri.org/" xmlns:bpf="http://schemas.datacontract.org/2004/07/Bpf.Security.Common" xmlns:bpf1="http://schemas.datacontract.org/2004/07/Bpf.Security.Authentication.Common">
         <soapenv:Header>
 <InfoTag xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.w3.org/BaufestProductivityFramework">
  <ClientIp xmlns="http://schemas.datacontract.org/2004/07/Bpf.Common.Service">200.125.145.10</ClientIp> 
  <CompanyId xmlns="http://schemas.datacontract.org/2004/07/Bpf.Common.Service">1</CompanyId>
  <UserName xmlns="http://schemas.datacontract.org/2004/07/Bpf.Common.Service">someUser</UserName> 
  </InfoTag>
        </soapenv:Header>
           <soapenv:Body>
              <tem:LogIn>         
                <tem:token>
                    <bpf:type>
                       <bpf1:Description>someDesc</bpf1:Description>
                       <bpf1:Id>1</bpf1:Id>
                       <bpf1:Name>someDesc</bpf1:Name>
                    </bpf:type>
                    <bpf:password>somePass</bpf:password>
                    <bpf:userName>someUser</bpf:userName>
                </tem:token>
              </tem:LogIn>
           </soapenv:Body>
        </soapenv:Envelope> 
```

此函数发送带有命名空间的标头，但不止一个...我必须全部发送它们吗？

```
 private function __getHeaders() {
            $ns = 'http://schemas.xmlsoap.org/soap/envelope/'; //Namespace of the WS. 
            $ip = $_SERVER['REMOTE_ADDR'];
    //Body of the Soap Header. 
            $headerbody = array('ClientIp' => $ip,
                                'CompanyId' => 1, 
                                'UserName' => 'someUser'
                                );

    //Create Soap Header.        
            $header = new SOAPHeader($ns, 'InfoTag', $headerbody);
            return $header;
        }

    public function prepareWs(){
    $wsdl="the web service";
           $client = new SoapClient($wsdl, array('trace' => true));
    //Set the Headers of Soap Client. 
           $header = $this->__getHeaders();
           $client->__setSoapHeaders($header); 
```

我尝试发送此正文，我检查了带有肥皂故障的异常，但消息仅返回“错误请求 NULL NULL NULL”。

```
$params = new stdClass();  
      $params = new SoapVar("<tem:token>
        <bpf:type xmlns:bpf="http://schemas.datacontract.org/2004/07/Bpf.Security.Common">
           <bpf1:Description xmlns:bpf1="http://schemas.datacontract.org/2004/07/Bpf.Security.Authentication.Common">someDesc</bpf1:Description>
           <bpf1:Id xmlns:bpf1="http://schemas.datacontract.org/2004/07/Bpf.Security.Authentication.Common">1</bpf1:Id>
           <bpf1:Name xmlns:bpf1="http://schemas.datacontract.org/2004/07/Bpf.Security.Authentication.Common">someName</bpf1:Name>
        </bpf:type>
        <bpf:password xmlns:bpf="http://schemas.datacontract.org/2004/07/Bpf.Security.Common">somePass</bpf:password>
        <bpf:userName xmlns:bpf="http://schemas.datacontract.org/2004/07/Bpf.Security.Common">someUser</bpf:userName>
    </tem:token>", XSD_ANYXML);

       $response = $client->Login($params);

} 
```

使用 CURL 我可以发送这个 XML 并接收 XML 响应，但是使用 SOAPClient 我不能发送这个请求。

我希望有人可以帮助我，谢谢。

这是我可以用萤火虫看到的代码，我唯一得到的是“错误请求”。当我使用 __getLastRequest() 时，我看到了同样的结果……我猜标题不应该被正确发送，但是 __setSoapHeaders 函数返回 true。这是输出：

```
<soap-env:envelope xmlns:ns1="http://tempuri.org/" xmlns:soap-env="http://schemas.xmlsoap.org/soap/envelope/">
<soap-env:header>
<soap-env:contextinformation>
<item>
<key>ClientIp</key>
<value>127.0.0.1</value>
</item>
<item>
<key>CompanyId</key>
<value>1</value>
</item>
<item>
<key>UserName</key>
<value>someUser</value>
</item>
</soap-env:contextinformation>
</soap-env:header>
<soap-env:body>
<tem:login>
<tem:token>
<bpf:type>
<bpf1:description>someDesc</bpf1:description>
<bpf1:id>1</bpf1:id>
<bpf1:name>someName</bpf1:name>
</bpf:type>
<bpf:password>somePass</bpf:password>
<bpf:username>someUser</bpf:username>
</tem:token>
</tem:login>
</soap-env:body>
</soap-env:envelope> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T19:19:48.747

`SoapHeader`相当随意地对待数组。如果您想使用数组，请考虑使用[`ArrayObject`而不是原生构造](http://www.fischco.org/blog/2011/3/26/php-soapserver-objects-arrays-and-encoding.html)。

但是，您根本不需要数组，因为您只是尝试在标题中构造单个元素。而且因为您的每个内部元素（例如**ClientIP**）都有一个唯一的名称空间，所以您不能只传入一个基本对象。相反，您必须使用该类为每个元素指定一个特定的命名空间`SoapVar`，这允许您将普通 PHP 数据包装在`SoapClient`可以理解和翻译的“SOAP-ready”容器中。

```
$innerNS = "http://www.w3.org/BaufestProductivityFramework";
$outerNS = "http://schemas.datacontract.org/2004/07/Bpf.Common.Service";

$tag = new stdClass();
$tag->ClientIP = new SoapVar("200.125.145.10", XSD_STRING, null, null, null, $innerNS);
$tag->CompanyId = new SoapVar(1, XSD_INT, null, null, null, $innerNS);
$tag->UserName = new SoapVar("someUser", XSD_STRING, null, null, null, $innerNS);

$client->__setSoapHeaders(new SoapHeader($outerNS, 'InfoTag', $tag)); 
```

最后，作为一项规则，**不要手动编写 XML！** 考虑重写您的 SOAP 主体代码，如此处所示的标头代码。您应该能够专门处理 XML 的*内容*，而不是其结构。

# asp.net - ASP.NET Linq 过滤器检查日期不起作用

> ID：10490501
> 
> 赞同：0
> 
> 时间：2012-05-07T23:26:37.510
> 
> 标签：asp.net, linq

所以在我的页面上，我有两个日期框，用户可以在其中选择一个日期和日期。问题是当我输入例如以下内容时。我得到的项目实际上日期大于 2012 年 5 月 4 日，根据以下情况，这不应该发生。

基本上我想要实现的是

*   如果输入起始日期，则日期 >= 起始日期
*   如果输入了日期，则日期 <= 到日期
*   如果两者都输入，则 date >= from date and date <= to date

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:33:44.357

发生这种情况是因为如果列表中的任何项目小于 05/04/2012 ，您`cl.claimStatus.Any`将返回。因此，您的陈述将如下所示：`true``claimStatus`

```
filteredClaims = filteredClaims.Where(c1=>true); 
```

...因此归还一切。

# javascript - 标题 JQuery Mobile 中的导航栏

> ID：10490502
> 
> 赞同：4
> 
> 时间：2012-05-07T23:26:47.997
> 
> 标签：javascript, jquery, html, jquery-mobile

编辑：我的临时解决方案是关闭所有转换并为每个标题使用不同的 id。然后，您将获得永久工具栏，但没有过渡。 [没有过渡的工作示例](http://jsfiddle.net/9ASRg/)

我在 JQuery Mobile 的标题中使用了一个持久的固定导航栏。我在 3 个 html 文件之间导航，在第一个（主）页面上没有问题，但在第二个和第三个页面上，导航栏涵盖了一些内容。

导航栏和标题的损坏导航栏代码示例：

```
<div data-role="header" data-id="header" data-position="fixed">
        <h1>Page 1</h1>
        <a href="options.html" data-icon="gear" class="ui-btn-right">Options</a>
        <div data-role="navbar">
            <ul>
                <li><a href="#page1" data-icon="home" data-iconpos="top"class="ui-btn-active ui-state-persist"  >Page1</a></li>
                <li><a href="#page2" data-icon="info" data-iconpos="top"  >Page2</a></li>
                <li><a href="#page3" data-icon="gear" data-iconpos="top" >Page3</a></li>
            </ul>
        </div><!-- /navbar -->
    </div><!-- /header --> 
```

我在这里上传了一个问题示例（页面在一个 html 文件中，而不是三个 html 文件中）：[损坏的导航栏](http://jsfiddle.net/LvuUX/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T03:37:34.937

这是更新的：http: [//jsfiddle.net/LvuUX/2/](http://jsfiddle.net/LvuUX/2/)

你在`data-id="header"`所有三个页面上都有相同的，因为你正在使用`multi-page template`，所以你不能有相同`id`的`multiple elements`

编辑： http: [//jsfiddle.net/LvuUX/3/](http://jsfiddle.net/LvuUX/3/) 看起来 jQuery`padding-top`在页面加载时使用不正确。要解决此问题，您只需`padding-top`为您的`data-role="content"`

```
<style type="text/css">
    .ui-page-header-fixed { padding-top: 5.9em; }
</style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-10T01:24:36.960

我认为您正在尝试做的事情与我遇到的问题相似。我有一个固定定位的导航栏，但我的页面内容隐藏在它下面。我通过对我的内容 div 应用等于导航栏高度的上边距解决了这个问题。（即，我的内容 div 的 margin-top 是 50px，因为那是我的导航栏的高度。）

[固定定位元素](http://www.w3schools.com/css/css_positioning.asp)从正常流程中移除。文档和其他元素的行为就像固定定位元素不存在一样。

我希望我正确地解释了你的问题。我只学习了 html&css 3 个月，但是当我看到你的问题时，我认为这可能会有所帮助。

# iphone - iPhone在点击主页按钮后关闭键盘

> ID：10490505
> 
> 赞同：-1
> 
> 时间：2012-05-07T23:27:05.233
> 
> 标签：iphone, keyboard

当用户在键盘启动时按下主页按钮时，如何关闭 iPhone 键盘？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T23:48:13.680

你可以试试：

```
-(void)applicationDidEnterBackground:(UIApplication *)application {

    [yourtextfield resignFirstResponder];
} 
```

# c - 在 C 中释放指针时显示垃圾值

> ID：10490509
> 
> 赞同：0
> 
> 时间：2012-05-07T23:27:31.863
> 
> 标签：c, pointers

当我尝试释放 dataToWrite 时，我不确定为什么在 if 循环中会抛出垃圾值。它在 else 循环中工作正常。谁能帮我这个？

```
FILE *readFilePointer = NULL;
Message_buf outputMsgBuffer;
char fileData[PIPE_BUF];
char *dataToWrite=NULL;

readFilePointer = fopen(fileToReadFrom, "r");

if (readFilePointer == NULL)
{
    outputMsgBuffer.messageType=1;
    dataToWrite=(char *)malloc(strlen(strcat(fileToReadFrom," does not exists!!"))+1);
    memset(dataToWrite,0,strlen(dataToWrite));
    dataToWrite=strcat(fileToReadFrom," does not exists!!");
    strcat(outputMsgBuffer.messageText,dataToWrite);
    memset(dataToWrite,0,strlen(dataToWrite)+1);
    free(dataToWrite);
}
else
{   
    //outputMsgBuffer.messageText[0] = '\0';
    while (fgets(fileData, sizeof(fileData), readFilePointer) != NULL)
    {
        dataToWrite=(char *)malloc(sizeof(fileData));
        memset(dataToWrite,0,strlen(dataToWrite));
        strcpy(dataToWrite,fileData);
        strcat(outputMsgBuffer.messageText,dataToWrite);    
        free(dataToWrite);
    }

    fclose(readFilePointer);
}
outputMsgBuffer.messageType=1;
outputMsgBuffer.messageLength=strlen(outputMsgBuffer.messageText);
mesg_send(fd,&outputMsgBuffer);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:32:54.200

```
dataToWrite=(char *)malloc(strlen(strcat(fileToReadFrom," does not exists!!"))+1);
memset(dataToWrite,0,strlen(dataToWrite)); 
```

您没有初始化分配的内存，因此调用会`strlen`调用`dataToWrite`未定义的行为。

此外，您似乎没有意识到`strcat`修改其第一个参数指向的内存并返回指向它的指针的事实，

```
dataToWrite=strcat(fileToReadFrom," does not exists!!"); 
```

丢弃刚刚分配的内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:33:24.583

好吧，这让我大吃一惊：

```
dataToWrite=(char *)malloc(sizeof(fileData));
memset(dataToWrite,0,strlen(dataToWrite)); 
```

您正在调用`strlen`指向`char*`您刚刚分配的内存的`malloc`. 您不知道该内存块中将包含什么，但是您调用`strlen`which 在返回之前查找空字符。你`memset`错了，可能在任何地方写，导致内存损坏。

附带说明一下，不要在 C 中转换 malloc 的返回值。这是完全没有必要的，实际上可以隐藏您忘记包含 stdlib.h 的事实（在旧版本的标准中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:35:23.617

```
dataToWrite=(char *)malloc(strlen(strcat(fileToReadFrom," does not exists!!"))+1); 
```

您已将字符串复制到`fileToReadFrom`; 除了文件名之外，您是否确信它足够大以处理额外的字符串数据？（*为什么*这必须发生在这里？不要试图在一行中做太多。）

我怀疑您误解了`strcat(3)`工作原理；再看一下原型：

```
 char *strcat(char *dest, const char *src); 
```

是目的地`dest` *：*

```
dataToWrite=(char *)malloc(strlen(strcat(fileToReadFrom," does not exists!!"))+1);
memset(dataToWrite,0,strlen(dataToWrite));
dataToWrite=strcat(fileToReadFrom," does not exists!!"); 
```

假设`fileToReadFrom`包含`hello`. 在此代码之后，`dataToWrite`包含：

```
hello does not exists!! does not exists!! 
```

如果`fileToReadFrom`不够大，那么您已经在*很多**不*相关的内存上乱涂乱画。

 *我强烈建议在你的程序中找到*每一个*使用，`strcpy(3)`并检查每一个的正确性。您可能在程序的其余部分中存在可利用的安全漏洞。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T23:47:44.027

你的代码有很多问题。

```
dataToWrite=(char *)malloc(strlen(strcat(fileToReadFrom," does not exists!!"))+1); 
```

你确定 fileToReadFrom 有足够的空间吗？

```
dataToWrite=strcat(fileToReadFrom," does not exists!!"); 
```

再次，你确定吗？...然后您将覆盖指向新分配内存的指针

```
free(dataToWrite); 
```

dataToWrite 不再包含来自 malloc 的指针。

```
strcat(outputMsgBuffer.messageText,dataToWrite); 
```

你确定 outputMsgBuffer.messageText 有足够的空间吗？如果是，为什么要为另一个指针分配内存（在 else 中）？

你可能想要的是：

```
strcpy(outputMsgBuffer.messageText,fileToReadFrom); 
strcat(outputMsgBuffer.messageText," does not exists!!"); 
```

而在其他

```
strcpy(outputMsgBuffer.messageText,fileData); 
```

仅此而已（如果您确定 outputMsgBuffer.messageText 足够大）。*

# ios - 作为 RESTful 客户端，你更喜欢什么 - RestKit vs Resty

> ID：10490512
> 
> 赞同：4
> 
> 时间：2012-05-07T23:28:28.103
> 
> 标签：ios, json, rest, asihttprequest, restkit

我需要在我的应用程序中实现基本的 RESTful 功能，例如 post/get/delete + json 解析。

您建议将什么用作框架：

1) Resty [http://projects.lukeredpath.co.uk/resty/](http://projects.lukeredpath.co.uk/resty/) (ARC?) 2) [http://restkit.org/](http://restkit.org/) (ARC?)

他们每个人的优势是什么？

我问的原因是因为昨天我使用 ASIHTTPRequest 实现了一些 RESTful 功能，但今天我阅读的内容不再受支持:(

还有一件事，我听说 iOS5 SDK（GCD Dispatcher 或类似的东西）中有内置 JSON 支持，它适用于 iOS4 客户端吗？（它是编译时依赖还是运行时依赖？），它可以发布/获取请求吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T12:37:33.563

Depends on your requirements.

If you just need some RESTful communication with a server then Resty isnt too bad (Though I never used it, it looks straightforward).

Restkit on the other hand is one powerful package because of 1 ultimate feature. Integration with core data. Restkit is able to parse Json responses, make them into objects and save these objects to core data with minimal coding out of the box. This makes it highly useful in case this is the type of functionality you are looking for.

I would encourage you to define the functionality you need and have a look at the frameworks. If it basic stuff, as you say, then one can argue that Restkit may be too powerful.

As for the inbuilt JSON parsing library, well it is way down the list in priority. These framework already includes a Json parser and they work pretty well. I would seriously consider the advantages before I go on to retrofit these packaged frameworks with a JSON parser of choice.

# clojure - 如何在匿名 fn 中进行递归，没有尾递归

> ID：10490513
> 
> 赞同：21
> 
> 时间：2012-05-07T23:28:32.730
> 
> 标签：clojure, functional-programming, lisp, anonymous-function, tail-recursion

如何在不使用尾递归的情况下在匿名函数中进行递归？

例如（来自 Vanderhart 2010，第 38 页）：

```
(defn power
  [number exponent]
  (if (zero? exponent)
    1
    (* number (power number (- exponent 1))))) 
```

假设我想将其作为匿名函数来执行。出于某种原因，我不想使用尾递归。我该怎么做？例如：

```
( (fn [number exponent] ......))))) 5 3)
125 
```

我可以为此使用**循环**，还是循环只能与**recur**一起使用？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-05-07T23:57:54.230

`fn`特殊形式让您可以[选择提供](http://clojure.org/special_forms#Special%20Forms--%28fn%20name?%20%5Bparams*%20%5D%20exprs*%29)可在内部用于递归的名称。

```
(doc fn)
;=> (fn name? [params*] exprs*) 
```

因此，添加“power”作为名称来完成您的示例。

```
(fn power [n e]
  (if (zero? e)
    1
    (* n (power n (dec e))))) 
```

即使递归发生在尾部位置，也不会被优化以替换当前堆栈帧。Clojure 强制您使用`loop`/`recur`和明确说明它`trampoline`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-07T23:40:24.667

我知道在 Clojure 中有对“命名”匿名函数的语法支持，正如其他答案所指出的那样。但是，我想展示一种解决问题的第一性原理方法，这种方法不依赖于编程语言中特殊语法的存在，并且适用于任何具有一阶过程 (lambdas) 的语言。

原则上，如果要进行递归函数调用，则需要引用函数的名称，因此“匿名”（即*无名*函数）不能用于执行递归......除非您使用[Y-Combinator](https://en.wikipedia.org/wiki/Y-combinator) . [下面](http://www.fatvat.co.uk/2009/04/understanding-y-combinator.html)解释了它在 Clojure 中的工作原理。

让我通过一个示例向您展示它是如何使用的。首先，`Y-Combinator`适用于具有可变数量参数的函数：

```
(defn Y [f]
  ((fn [x] (x x))
   (fn [x]
       (f (fn [& args]
              (apply (x x) args)))))) 
```

现在，实现问题中定义的过程的*匿名*函数。`power`显然，它没有名字，`power`只是最外层函数的一个参数：

```
(fn [power]
      (fn [number exponent]
          (if (zero? exponent)
              1
              (* number (power number (- exponent 1)))))) 
```

最后，这里是如何将 应用于`Y-Combinator`匿名`power`过程，作为参数传递`number=5`并且`exponent=3`（它不是尾递归 BTW）：

```
((Y 
  (fn [power]
      (fn [number exponent]
          (if (zero? exponent)
              1
              (* number (power number (- exponent 1)))))))
 5 3)

> 125 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-08T00:00:51.903

`fn`接受一个[可选的名称参数](http://clojure.org/special_forms#Special%20Forms--%28fn%20name?%20%5Bparams%2a%20%5D%20exprs%2a%29)，可用于递归调用函数。

例如：

```
user> ((fn fact [x]
           (if (= x 0)
               1
               (* x (fact (dec x)))))
       5)
;; ==> 120 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-08T01:02:40.610

是的，您可以使用`loop`它。`recur`适用于`loop`s 和`fn`s

```
user> (loop [result 5 x 1] (if (= x 3) result (recur (* result 5) (inc x))))
125 
```

一个惯用的 clojure 解决方案如下所示：

```
user> (reduce * (take 3 (repeat 5)))
125 
```

或使用 Math.pow() ;-)

```
user> (java.lang.Math/pow 5 3)
125.0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T01:02:52.160

[循环](http://clojuredocs.org/clojure_core/clojure.core/loop)可以是重复目标，所以你也可以这样做。

# java - 使用字符串加载预设脚本

> ID：10490514
> 
> 赞同：2
> 
> 时间：2012-05-07T23:28:34.480
> 
> 标签：java, android, eclipse, command-line, command

好的，我没有很好地解释我的问题，所以这里修改了几次。

我有一个调查，调查产生一个整数。我将此数字转换为与存储在我的资源中的预设字符串相关的字符串文件名。根据对问题所做的选择，最后需要不同的字符串。

此代码生成所需的命令行；R.string.c####

```
 int Q1 = question1.getmCounter();
int Q2 = question2.getmCounter();
int Q3 = question3.getmCounter();
int Q4 = question4.getmCounter();

int qTotal = Q1 + Q2 + Q3 + Q4;
String Test5 = "R.string.c" + qTotal; 
```

此代码位于 onCreate 内部，用于为 TextView 生成内容。

```
 textOut = (TextView) findViewById(R.id.ChmpNametxt);
    textOut.setText(Test5); 
```

现在我的概念是它将 Test5 读取为“R.string.c####”并加载所需的字符串。它不这样做，我想知道如何将 Test5 的内容放入命令行。

希望有人能帮我做麦芽..

提前致谢

-克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:34:17.850

您已经在这里得到了正确答案：[Creating Strings than can be used as Filepath - Eclipse / Android](https://stackoverflow.com/questions/10489432/creating-strings-than-can-be-used-as-filepath-eclipse-andriod)

在你的情况下：

```
String stringId = "c" + qTotal; //note: not the same as what you did with your Test5
int resId = getResources().getIdentifier(stringId, "string", getPackageName());
textOut.setText(resId); 
```

还是我们误解了您对“命令行”一词的使用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:33:58.347

您需要获取文本的资源 ID，此代码为您获取资源 ID：

```
ContextWrapper cw = this.getContext();// how you get this can be different, but you need a ContextWrapper from somewhere to use.
int resId = cw.getResources().getIdentifier("c" + qTotal, "string", cw.getPackageName()); 
```

然后您可以使用带有 resId 变量的 textOut.setText 作为参数。

# ruby - 钩子后的黄瓜可以获取场景变量吗？

> ID：10490517
> 
> 赞同：0
> 
> 时间：2012-05-07T23:29:12.503
> 
> 标签：ruby, cucumber

我的黄瓜场景如下：

```
Scenario: test add user
Given I logged in with email
When I add user with name test1 in my test
Then I should see my user
#After remove user with name test1 
```

一些示例步骤定义如下：

```
When /^add user with name (\w+) in my test$/ do |name|
    @test.add_user(name)
end 
```

我想在测试场景完成后删除我刚刚添加的用户以保持系统清洁。我可以通过使用 After hook 来实现这一点吗？我找不到将用户名传递到 After 挂钩的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T10:30:17.960

实际上并没有一种方法可以专门将信息传递到钩子中，这是一件好事，您的场景*应该*不知道可能执行或不执行的任何钩子。

不过，钩子可以访问全局状态，因此您可以轻松地将每个创建的用户添加到全局数组中，并使用钩子清除这些用户：

```
# In step def
@test_users ||= []
@test_users << name
@test.add_user(name)

# In hook
@test_users.each { |u| @test.remove_user(u) } 
```

值得指出的是，[database_cleaner](https://github.com/bmabey/database_cleaner) gem 是专门为清除测试或测试套件之间的测试数据而设计的，并且可能能够为您提供所需的内容，而无需手动滚动您自己的清理代码。

# vba - 我可以用 Groovy 的 Scriptom 完全替换 VBA 吗？

> ID：10490518
> 
> 赞同：2
> 
> 时间：2012-05-07T23:29:14.343
> 
> 标签：vba, groovy, automation, scriptom

我必须将几个 Java 应用程序与一个用 C 开发的系统集成，该系统嵌入了用于自动化的 VBA。我更喜欢使用 Scriptom 而不是 VBA。

我不必与任何用 VB 开发的组件集成，只需用 C 开发的组件。我可以用 Scriptom 完全替换 VBA 吗？有什么我应该考虑的问题吗？

谢谢，

阿尔贝托

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T05:02:08.723

我今天早些时候实际上正在研究这个。Scriptom 使用 Jacob，它是 Java COM Bridge。Groovy In Action 有一整章专门介绍 Scriptom，并引用了 Jacob 的这段话：

> Jacob 提供了一个通用 API，可用于访问任何本机对象。

我正准备使用它来收集 Windows 事件查看器日志，但我个人以前从未使用过它。

# c# - RavenDB 映射归约函数

> ID：10490519
> 
> 赞同：0
> 
> 时间：2012-05-07T23:29:14.910
> 
> 标签：c#, indexing, mapreduce, ravendb

我正在尝试为索引编写一个 RavenDB Map Reduce 函数来整理来自一堆 DomainModels 的信息。我无法填充所有结果字段，但已经花了一天左右的时间，并且遗漏了一些我认为的基本内容。

这里是：

```
public class All_Groups : AbstractMultiMapIndexCreationTask<All_Groups.Result>
{
    public class Result
    {
        public string Type { get; set; }
        public string Id { get; set; }
        public string ChildId { get; set; }
        public string Name { get; set; }
        public string GroupType { get; set; }
        public int MemberCount { get; set; }
        public int ProjectCount { get; set; }
        public int TeamCount { get; set; }
        public int OrganisationCount { get; set; }
        public int ChildGroupCount { get; set; }
        public AppRoot AppRoot { get; set; }
        public Organisation Organisation { get; set; }
        public Team Team { get; set; }
        public Project Project { get; set; }
        public UserProject UserProject { get; set; }
    }

    public All_Groups()
    {
        AddMap<AppRoot>(appRoots => from appRoot in appRoots
                select new
                {
            Type = "group",
                    appRoot.Id,
                    ChildId = (string)null,
                    appRoot.Name,
                    GroupType = "approot",
                    MemberCount = 0,
                    ProjectCount = 0,
                    TeamCount = 0,
                    OrganisationCount = 0,
                    ChildGroupCount = 0
                });

        AddMap<Organisation>(organisations => from organisation in organisations
                select new
                {
            Type = "group",
                    organisation.Id,
                    ChildId = (string)null,
                    organisation.Name,
                    GroupType = "organisation",
                    MemberCount = 0,
                    ProjectCount = 0,
                    TeamCount = 0,
                    OrganisationCount = 1,
                    ChildGroupCount = 0
                });

        AddMap<Team>(teams => from team in teams
                select new
                {
            Type = "group",
                    team.Id,
                    ChildId = (string)null,
                    team.Name,
                    GroupType = "team",
                    MemberCount = 0,
                    ProjectCount = 0,
                    TeamCount = 1,
                    OrganisationCount = 0,
                    ChildGroupCount = 0
                });

        AddMap<Project>(projects => from project in projects
                select new
                {
            Type = "group",
                    project.Id,
                    ChildId = (string)null,
                    project.Name,
                    GroupType = "project",
                    MemberCount = 0,
                    ProjectCount = 1,
                    TeamCount = 0,
                    OrganisationCount = 0,
                    ChildGroupCount = 0
                });

        AddMap<UserProject>(userProjects => from userProject in userProjects
                select new
                {
            Type = "group",
                    userProject.Id,
                    ChildId = (string)null,
                    userProject.Name,
                    GroupType = "userproject",
                    MemberCount = 0,
                    ProjectCount = 0,
                    TeamCount = 0,
                    OrganisationCount = 0,
                    ChildGroupCount = 0
                });

        AddMap<GroupAssociation>(groupAssociations => from groupAssociation in groupAssociations
                select new
                {
            Type = "groupassociation",
                    Id = groupAssociation.ParentGroupId,
                    ChildId = groupAssociation.ChildGroupId,
                    Name = "n/a",
                    GroupType = "groupassociation",
                    MemberCount = 0,
                    ProjectCount = 0,
                    TeamCount = 0,
                    OrganisationCount = 0,
                    ChildGroupCount = 1
                });

        AddMap<Member>(members => from member in members
                select new
                {
            Type = "member",
                    member.Id,
                    ChildId = (string)null,
                    Name = "n/a",
                    GroupType = "member",
                    MemberCount = 1,
                    ProjectCount = 0,
                    TeamCount = 0,
                    OrganisationCount = 0,
                    ChildGroupCount = 0
                });

        Reduce = results => from result in results
                group result by result.Id
                into g
                select new
                {
            g.Where(x => x.Id == g.Key).First().Type,
            Id = g.Key,
            g.Where(x => x.Id == g.Key).First().ChildId,
            g.Where(x => x.Id == g.Key).First().Name,
            g.Where(x => x.Id == g.Key).First().GroupType,
            MemberCount = g.Where(x => x.Id == g.Key && x.Type == "member").Sum(x => x.MemberCount),
            ProjectCount = g.Where(x => x.GroupType == "project").Sum(x => x.ProjectCount),
            TeamCount = g.Where(x => x.GroupType == "team").Sum(x => x.TeamCount),
            OrganisationCount = g.Where(x => x.GroupType == "organisation").Sum(x => x.OrganisationCount),
            ChildGroupCount = g.Where(x => x.GroupType == "groupassociation" && x.Id == g.Key).Sum(x => x.ChildGroupCount)
                };

                TransformResults = (database, results) =>
                from result in results
                let appRoot = database.Load<AppRoot>(result.Id)
                let organisation = database.Load<Organisation>(result.Id)
                let team = database.Load<Team>(result.Id)
                let project = database.Load<Project>(result.Id)
                let userProject = database.Load<UserProject>(result.Id)
                select new
                {
                    result.Id,
                    result.Type,
                    result.Name,
                    result.GroupType,
                    AppRoot = appRoot,
                    Organisation = organisation,
                    Team = team,
                    Project = project,
                    UserProject = userProject,
                    result.MemberCount,
                    result.ProjectCount,
                    result.TeamCount,
                    result.OrganisationCount,
                    result.ChildGroupCount
                };

                Store(x => x.Type, FieldStorage.Yes);
                Store(x => x.Id, FieldStorage.Yes);
                Store(x => x.Name, FieldStorage.Yes);
                Store(x => x.GroupType, FieldStorage.Yes);
                Store(x => x.MemberCount, FieldStorage.Yes);
                Store(x => x.ProjectCount, FieldStorage.Yes);
                Store(x => x.TeamCount, FieldStorage.Yes);
                Store(x => x.OrganisationCount, FieldStorage.Yes);
                Store(x => x.ChildGroupCount, FieldStorage.Yes);
    }
} 
```

基本上问题似乎是我没有得到 OrganisationCount 和 TeamCount 的任何结果，尽管它们的文档存在。

（如果有人想要域模型图，请访问：[https](https://github.com/Bowerbird/bowerbird-web/blob/master/Docs/Model.vsd) ://github.com/Bowerbird/bowerbird-web/blob/master/Docs/Model.vsd ）

我一直在为此扯头发，它几乎就在那里，但我需要一些新鲜的眼睛吗？

干杯，

哈米什。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T07:33:23.700

事实证明它比我上面的要简单一些。我试图解决的问题是：

AppRoot 是我的应用程序和域模型的根级别的组。可以是组织、团队或项目的组可以链接为 AppRoot 的子项，或者按组织有团队、团队有项目的顺序进行链接。

还有一些用户项目作为 AppRoot 的关联存在。

我需要计算每个项目中的所有成员以及每个项目中的子项目，这就是 Map Reduce 函数在下面使用域模型对象 GroupAssociation 所做的事情。

有关更多详细信息，请参见上面链接的域模型图：

```
public class All_Groups : AbstractMultiMapIndexCreationTask<All_Groups.Result>
{
    public class Result
    {
        public string Type { get; set; }
        public string GroupType { get; set; }
        public string Id { get; set; }
        public int GroupMemberCount { get; set; }
        public int TeamProjectCount { get; set; }
        public int OrganisationTeamCount { get; set; }
        public int AppRootOrganisationCount { get; set; }
        public int AppRootUserProjectCount { get; set; }
        public int AppRootTeamCount { get; set; }
        public int AppRootProjectCount { get; set; }
        public Group Group { get { return AppRoot ?? Organisation ?? Team ?? Project ?? UserProject ?? (Group)null; } }
        public AppRoot AppRoot { get; set; }
        public Organisation Organisation { get; set; }
        public Team Team { get; set; }
        public Project Project { get; set; }
        public UserProject UserProject { get; set; }
    }

    public All_Groups()
    {
        AddMap<AppRoot>(appRoots => from appRoot in appRoots
                                    select new
                                    {
                                        Type = "group",
                                        GroupType = "approot",
                                        appRoot.Id,
                                        GroupMemberCount = 0,
                                        TeamProjectCount = 0,
                                        OrganisationTeamCount = 0,
                                        AppRootOrganisationCount = 0,
                                        AppRootUserProjectCount = 0,
                                        AppRootTeamCount = 0,
                                        AppRootProjectCount = 0
                                    });

        AddMap<Organisation>(organisations => from organisation in organisations
                                              select new
                                                    {
                                                        Type = "group",
                                                        GroupType = "organisation",
                                                        organisation.Id,
                                                        GroupMemberCount = 0,
                                                        TeamProjectCount = 0,
                                                        OrganisationTeamCount = 0,
                                                        AppRootOrganisationCount = 0,
                                                        AppRootUserProjectCount = 0,
                                                        AppRootTeamCount = 0,
                                                        AppRootProjectCount = 0
                                                    });

        AddMap<Team>(teams => from team in teams
                              select new
                              {
                                  Type = "group",
                                  GroupType = "team",
                                  team.Id,
                                  GroupMemberCount = 0,
                                  TeamProjectCount = 0,
                                  OrganisationTeamCount = 0,
                                  AppRootOrganisationCount = 0,
                                  AppRootUserProjectCount = 0,
                                  AppRootTeamCount = 0,
                                  AppRootProjectCount = 0
                              });

        AddMap<Project>(projects => from project in projects
                                    select new
                                    {
                                        Type = "group",
                                        GroupType = "project",
                                        project.Id,
                                        GroupMemberCount = 0,
                                        TeamProjectCount = 0,
                                        OrganisationTeamCount = 0,
                                        AppRootOrganisationCount = 0,
                                        AppRootUserProjectCount = 0,
                                        AppRootTeamCount = 0,
                                        AppRootProjectCount = 0
                                    });

        AddMap<UserProject>(userProjects => from userProject in userProjects
                                            select new
                                            {
                                                Type = "group",
                                                GroupType = "userproject",
                                                userProject.Id,
                                                GroupMemberCount = 0,
                                                TeamProjectCount = 0,
                                                OrganisationTeamCount = 0,
                                                AppRootOrganisationCount = 0,
                                                AppRootUserProjectCount = 0,
                                                AppRootTeamCount = 0,
                                                AppRootProjectCount = 0
                                            });

        AddMap<GroupAssociation>(groupAssociations => from groupAssociation in groupAssociations
                                                      select new
                                                      {
                                                          Type = "groupassociation",
                                                          GroupType = (string)null,
                                                          Id = groupAssociation.ParentGroupId,
                                                          GroupMemberCount = 0,
                                                          TeamProjectCount = groupAssociation.ParentGroupType == "team" && groupAssociation.ChildGroupType == "project" ? 1 : 0,
                                                          OrganisationTeamCount = groupAssociation.ParentGroupType == "organisation" && groupAssociation.ChildGroupType == "team" ? 1 : 0,
                                                          AppRootOrganisationCount = groupAssociation.ParentGroupType == "approot" && groupAssociation.ChildGroupType == "organisation" ? 1 : 0,
                                                          AppRootUserProjectCount = groupAssociation.ParentGroupType == "approot" && groupAssociation.ChildGroupType == "userproject" ? 1 : 0,
                                                          AppRootTeamCount = groupAssociation.ParentGroupType == "approot" && groupAssociation.ChildGroupType == "team" ? 1 : 0,
                                                          AppRootProjectCount = groupAssociation.ParentGroupType == "approot" && groupAssociation.ChildGroupType == "project" ? 1 : 0
                                                      });

        AddMap<Member>(members => from member in members
                                  select new
                                  {
                                      Type = "member",
                                      GroupType = (string)null,
                                      member.Group.Id,
                                      GroupMemberCount = 1,
                                      TeamProjectCount = 0,
                                      OrganisationTeamCount = 0,
                                      AppRootOrganisationCount = 0,
                                      AppRootUserProjectCount = 0,
                                      AppRootTeamCount = 0,
                                      AppRootProjectCount = 0
                                  });

        Reduce = results => from result in results
                            group result by result.Id
                                into g
                                select new
                                {
                                    Type = g.Select(x => x.Type).FirstOrDefault(),
                                    GroupType = g.Select(x => x.GroupType).FirstOrDefault(),
                                    Id = g.Key,
                                    GroupMemberCount = g.Sum(x => x.GroupMemberCount),
                                    TeamProjectCount = g.Sum(x => x.TeamProjectCount),
                                    OrganisationTeamCount = g.Sum(x => x.OrganisationTeamCount),
                                    AppRootOrganisationCount = g.Sum(x => x.AppRootOrganisationCount),
                                    AppRootUserProjectCount = g.Sum(x => x.AppRootUserProjectCount),
                                    AppRootTeamCount = g.Sum(x => x.AppRootTeamCount),
                                    AppRootProjectCount = g.Sum(x => x.AppRootProjectCount)
                                };

        TransformResults = (database, results) =>
            from result in results
            let appRoot = database.Load<AppRoot>(result.Id)
            let organisation = database.Load<Organisation>(result.Id)
            let team = database.Load<Team>(result.Id)
            let project = database.Load<Project>(result.Id)
            let userProject = database.Load<UserProject>(result.Id)
            select new
            {
                result.Type,
                result.GroupType,
                result.Id,
                result.GroupMemberCount,
                result.TeamProjectCount,
                result.OrganisationTeamCount,
                result.AppRootOrganisationCount,
                result.AppRootUserProjectCount,
                result.AppRootTeamCount,
                result.AppRootProjectCount,
                AppRoot = appRoot,
                Organisation = organisation,
                Team = team,
                Project = project,
                UserProject = userProject
            };

        Store(x => x.Type, FieldStorage.Yes);
        Store(x => x.GroupType, FieldStorage.Yes);
        Store(x => x.Id, FieldStorage.Yes);
        Store(x => x.GroupMemberCount, FieldStorage.Yes);
        Store(x => x.TeamProjectCount, FieldStorage.Yes);
        Store(x => x.OrganisationTeamCount, FieldStorage.Yes);
        Store(x => x.AppRootOrganisationCount, FieldStorage.Yes);
        Store(x => x.AppRootUserProjectCount, FieldStorage.Yes);
        Store(x => x.AppRootTeamCount, FieldStorage.Yes);
        Store(x => x.AppRootProjectCount, FieldStorage.Yes);
    }
} 
```

在这里，因为模型是线性结构的，所以可以计算组之间的所有关系和组的成员资格，因为组可以有父母和孩子，但只有一种类型。

这可能会或可能不会帮助那些试图做一个复杂的 Map/Reduce 的人，但我从中学到的教训是确保在每一步都可以使用务实的方法进行聚合。

# python - Python子进程Popen没有将所有参数发送到shell

> ID：10490529
> 
> 赞同：2
> 
> 时间：2012-05-07T23:30:10.303
> 
> 标签：python, subprocess, popen

我正在使用 Python 的 subprocess 模块来启动另一个程序。该程序需要一个参数“-c{0-7}”。

```
this_dir = os.path.dirname(os.path.abspath(__file__))
cmd = [os.path.join(this_dir,'foobar'),'-c%d' % channel]
print "Starting process: %s" % str(cmd)
Proc = subprocess.Popen(cmd,stdout=subprocess.PIPE,shell=True) 
```

在 C++ 程序中，我正在检查传入的参数：

```
for (int i = 0; i < argc; i++)
{   
    cerr << i << "   " << argv[i] << endl;
}   
cerr << "" << endl; 
```

这是我运行 python 脚本时的输出：

```
user@home:~/embedded_pqa/saleae$ ./foobar.py -c3
Starting process: ['/home/user/code/foobar', '-c3']
0   /home/user/code/foobar 
```

很明显，参数“-c3”没有传递给子进程。有什么想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-07T23:40:08.830

问题在于`shell=True`. 引用[文档](http://docs.python.org/library/subprocess.html#subprocess.Popen)：

> 在 Unix 上，shell=True: […] 如果 args 是一个序列，第一项指定命令字符串，任何附加项将被视为 shell 本身的附加参数。

这意味着它调用以下命令：

```
sh -c /home/user/code/foobar -c3 
```

shell 将其解释为命令`/home/user/code/foobar`和附加的 shell 参数`-c3`。

只需摆脱，`shell=True`因为无论如何您都没有使用任何 sh 功能，并且您自己正在使用已经分离的参数列表。

# html - CSS：正文中的字体系列不适用于内容

> ID：10490530
> 
> 赞同：2
> 
> 时间：2012-05-07T23:30:26.590
> 
> 标签：html, css, font-family

我正在使用 google font api，当我将 font-family 线移动到封装的类和 id 中时，此代码有效，为什么我必须将 font-family 线移动到 .banner 才能影响横幅类中的文本

CSS：

```
body{
    font-family: 'Crimson Text';
    font-size: 15px;
    margin: 0px;

    .banner {
        otherstuff
    }

} 
```

html.erb：

```
<div class="banner">
    <%= image_tag("logo.png")%>
    <div class="login_menu_bar">
        <label>login</label>
        <label>password</label>
        </br>
        yeah
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:33:50.980

上面的CSS不应该是这样的吗？

```
body{
    font-family: 'Crimson Text';
    font-size: 15px;
    margin: 0px;
}

.banner {
    otherstuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:34:13.497

它工作正常[http://jsfiddle.net/QCYVs/](http://jsfiddle.net/QCYVs/)

# c++ - 如何创建一个假的 QNetworkAccessManager

> ID：10490537
> 
> 赞同：2
> 
> 时间：2012-05-07T23:32:00.113
> 
> 标签：c++, qt, mocking, qnetworkaccessmanager

有点问题。我目前有一个要测试的大型项目，其中大部分是否完全取决于 QNetworkAccessManager 实际响应调用的方式。由于我不能真正手动坐下并拔出以太网线以获得我想要的结果，所以我想制作一个假 QNAM。通常，我只会派生出与类派生出的相同接口，然后告诉使用它的对象有一个基类指针，这样它就可以毫不费力地处理假的和正确的。

```
 InterfaceQNAM &_manager; // should have virtual put, post, finished() etc that both 
                         //  the real QNAM and the fake one would derive 
```

然而！Qt 并没有真正做接口，QNAM 只继承自 QOobject，我真的不想对我的代码那么松散，只是告诉类对 QObject 进行所有调用（它没有虚拟 put、post 或任何东西）。这将需要在类内进行太多的代码更改（强制转换，两个不同的对象，具体取决于我们将注入的对象 etc..etc..） 我将如何实际解决这个问题？

查看了请求的分支更改 QtMock 但由于缺乏文档，我无法启动并运行它。

此外，开始从 QNAM dervie，但由于我使用 arent virtual 的方法，它不会拿起我的。

我的班级看起来像这样：

```
class BaseRequest : public QObject {

    Q_OBJECT

protected:
    QNetworkAccessManager &_manager;
    QPointer<QNetworkReply> _reply; 
    QPointer<IParser> _parser; 

public:
    BaseRequest(QNetworkAccessManager &manager, IParser *parser = 0, QObject *parent = 0) 
        : QObject(parent), _manager(manager), _reply(0), _retryCount(0), _parser(parser) {}

    virtual ~BaseRequest(); 
} 
```

然后它将使用 QNAM 执行 REST 请求并检查何时完成。

那么，我怎么能做一个假的 QNAM，我可以插入到这个代码中，而不必做太多的改变呢？有什么好的设计模式或任何可以解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:17:47.393

从问题的评论中，让我提出一个详细的答案：

```
class MyNAM : public QNetworkAccessManager
{
  bool fakedNAM; // with setter and getter functions also...
  ...
  QNetworkReply *   post ( const QNetworkRequest & request, const QByteArray & data )
  ...
}

...

QNetworkReply *MyNAM::post ( const QNetworkRequest & request, const QByteArray & data ) 
{
  if (fakedNAM) {
     // your debugging code
  }
  else {
     return QNetworkAccessManager::post(request, data);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:57:57.123

我打算建议你将你的类设为模板，然后你可以覆盖这种方式......但当然，因为你正在实现 Q_OBJECT，所以你不能。也没有预处理器的东西可以工作。

您必须在这里使用多层抽象。一个在 Q_OBJECT 中实现非信号内容的基类，以及一个提供您需要在 QNetworkAccess 中使用的最小接口的基类。然后你可以将任何你需要的东西变成虚拟的，你可以制作一个测试版本和一个/或/两者的 Qt 版本。

如果您将创建的 QNetwork 事物基础转换为与 C++ 兼容的东西，例如 boost::signals，那么您可能无需为 Q_OBJECT 实现基础就可以逃脱。

祝你好运。试图让 Qt 做你期望在 C++ 中能够做的事情是一种脱发的经历。

# jquery - 如何防止用户使用 jQuery 在 textarea 中输入多个中断？

> ID：10490538
> 
> 赞同：2
> 
> 时间：2012-05-07T23:32:03.833
> 
> 标签：jquery, line-breaks

如何防止用户在一行中插入多个换行符到文本字段中？我更喜欢使用 jQuery 的解决方案。

更新 1：

我已将 anadeo 的代码插入到我的代码中，如下所示。不幸的是，它不起作用 - 它仍然允许在 textarea #posttext 中连续出现多个换行符。有人知道怎么修这个东西吗？谢谢 ：）

```
//Post something
$('#postDiv').on('keydown', '#posttext', function(e) {
if (e.which==13 && !e.shiftKey && $('#posttext').val()!=' Post something...') {

    var last = false;

    var code = (e.keyCode ? e.keyCode : e.which);
    if(code == 13) {
        if (last) { e.preventDefault(); }
        last=true;
    }else{
        last=false;
    }

    //If not currently loading and enough text typed in, submit
    if($('#imageFeedback').html()!=' | Loading...' && $('#posttext').val().length>15){

        //Say that it is loading
        $('#imageFeedback').css('color','black').css('font-weight','normal').html(' | Loading...');

        //Call function to post
        post($(this));
        return false;
    }
}
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:43:35.203

我想出了这个：

**NEW AND IMPROVED**（可以定义允许的换行数）

[http://jsfiddle.net/cEzUx/6/](http://jsfiddle.net/cEzUx/6/)

```
<textarea id="my" rows="5"></textarea>
<div id="out"> </div>

maxBreaks = 1;

$("#my").keydown(function(e) {
    if(e.keyCode == 13) {    
        if(countBreaks($("#my").val()) == maxBreaks) {
            e.preventDefault();
        }
    }
});

function countBreaks(str) {
  var num = 0;        
  for (var i = 0; i < str.length; i++) {
      if (str.charAt(i) === '\n') { num++; }
  }
  return num;
}
​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T00:03:25.443

```
$(textarea).on('keydown', function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if(code == 13 && this.value.match(/\n/g)) e.preventDefault();
});​ 
```

[小提琴](http://jsfiddle.net/adeneo/RF9QE/1/)

```
...more than one line break in a row 
```

您是否正在考虑避免连续多次换行（一个接一个），如下所示：

```
var last = false;

$(textarea).on('keydown', function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if(code == 13) {
        if (last) { e.preventDefault(); }
        last=true;
    }else{
        last=false;
    }
});​ 
```

[小提琴](http://jsfiddle.net/adeneo/RF9QE/2/)

**编辑：**

首先，`on()`仅在 jQuery 1.7+ 中受支持，因此请确保您使用的是更新版本的库。

您还使用了 , 的委托版本`on()`，这应该不是问题，但它假定您的 textarea 稍后插入到 DOM 中，并且从一开始就不存在，即。它是用JS等动态插入的。

其余的似乎没问题，但是`last`变量必须放在 keydown 函数之外才能正常工作，并且 var`code`应该在顶部，只检查一次 enter 键，因为第二次检查并不是真正必要的。该`code`变量实际上是可选的，因为 jQuery 应该是 normalize `e.which`，但是检查是否支持`keycode`or`which`似乎是确保跨浏览器兼容性的好主意。

对值的检查`#posttext`只会进行一次，一旦输入了换行符，值就不再是 `Post something...`，并且会启用“限制换行符”功能？

总而言之，我认为这应该可行，试试看？

```
var last = false;

$('#postDiv').on('keydown', '#posttext', function(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if (code==13 && !e.shiftKey && $('#posttext').val()!=' Post something...') {
        if (last) { e.preventDefault(); }
        last=true;
    }else{
        last=false;
    }
});​ 
```

[小提琴](http://jsfiddle.net/adeneo/cjc2W/)

此外，使用不太常见的变量名称而不是`last`类似的名称可能是一个好主意`MyLastTyped`，这样不太可能与名称在其他地方或插件等中`PostTextLast`的函数或变量混淆。`last`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T23:57:24.857

```
$("#myTarea").keydown(function(e) {
    if(e.keyCode == 13) {
       if($(this).val().match(/\n/)) e.preventDefault();
    }
});

<textarea id="myTarea" rows="5"></textarea> 
```

[**演示。**](http://jsfiddle.net/heera/cEzUx/5/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T23:59:12.467

`\n`解决方案的关键是，一旦您检测到页面上至少有一个`\n`字符，就阻止插入回车的默认行为。

在`event`传递给 keypress 处理程序的对象中，使用“which”方法检查输入键“keypress”事件，该事件由数字 13 表示。如果按下该键，则检查 textarea 的全部内容是否有回车return，它再次由转义序列表示`\n`。如果字符集合的长度`\n`大于 0，则调用`event.preventDefault()`，这会阻止将 enter 键添加到 textarea 的 value 属性：

```
$('#wmd-input').keypress(function(event) {
    if(event.which == 13 && $('#wmd-input').val().match(/\n/g).length > 0) {
        event.preventDefault();
    }
}); 
```

# java - Android 包名必须以“com.”开头？

> ID：10490539
> 
> 赞同：3
> 
> 时间：2012-05-07T23:32:08.810
> 
> 标签：java, android

> **可能重复：**
> [你真的使用你的反向域在 java 中进行包命名吗？](https://stackoverflow.com/questions/189209/do-you-really-use-your-reverse-domain-for-package-naming-in-java)

我是android编程的初学者。我使用 eclipse 做了一些 android 项目。当我赶上一些 android 教程时，我可以看到每个人都使用“com”作为包名称的起始词。我想知道为什么，据我所知它只是包名，但为什么每个人都以“com”开头？我必须跟随吗？还是以编程方式有任何具体原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T23:56:31.617

> 我想知道为什么，据我所知它只是包名，但为什么每个人都以“com”开头？

因为创建这些项目的人碰巧拥有以`.com`.

> 我必须跟随吗？

不可以，但您需要确保您的应用程序包在整个 Google Play 商店中是唯一的（假设您计划以这种方式分发应用程序）。最简单的方法是根据您拥有并计划用于营销应用程序的域名创建 Java 包。该域名是否以`.com`or `.net`or `.biz`or 结尾取决于您。

# google-app-engine - datanucleus 2 级缓存返回陈旧值

> ID：10490544
> 
> 赞同：2
> 
> 时间：2012-05-07T23:32:29.017
> 
> 标签：google-app-engine, jpa-2.0, datanucleus

appengine 1.6.4 datanucleus-appengine-2.0.0 datanucleus 缓存 3.0.1

大家好

我正在使用 datanucleus 2 级缓存从读取查询返回过时的数据。

我的持久配置没有缓存设置，因此从文档中它使用默认设置。

问题

第 1 步：在 TX1 中对实体 MerchantPromotion(5) 进行简单合并。

结果 1：数据存储查看器显示实体已正确更新。

第 2 步：在 TX2 中读取实体 MerchantPromotion(5)。

结果 2：返回的数据是预合并的数据，而不是更改的数据。

它似乎与二级缓存有关，因为当二级缓存设置为 NONE 时，操作成功。

附加了 DN 跟踪。

任何帮助表示赞赏。

-lp

```
<persistence-unit name="transactions-optional">
    <provider>org.datanucleus.api.jpa.PersistenceProviderImpl</provider>
    <properties>
        <property name="datanucleus.ConnectionURL" value="appengine"/>
        <property name="datanucleus.metadata.allowLoadAtRuntime" value="true"/>
        <property name="datanucleus.appengine.ignorableMetaDataBehavior" value="ERROR"/>
        <property name="datanucleus.DetachAllOnCommit" value="true" />
        <property name="datanucleus.DetachOnClose" value="true" />
        <property name="datanucleus.appengine.datastoreEnableXGTransactions" value="true"/>           

    </properties>
</persistence-unit> 
```

合并现有实体

```
07/05/2012 11:00:43 PM com.asteriski.mingle.venueportal.managedbeans.PromotionBackingBean saveAction
INFO: saveSun May 06 00:00:00 UTC 2012
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl initialiseLevel1Cache
FINE: Level 1 Cache of type "soft" initialised
07/05/2012 11:00:43 PM     com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection <init>
FINE: Created ManagedConnection using DatastoreService = com.google.appengine.api.datastore.DatastoreServiceImpl@136fb9fd
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection added to the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@47d77d9e for key=org.datanucleus.ObjectManagerImpl@1f4790be in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM com.asteriski.mingle.venueportal.service.PromotionService save
INFO: com.asteriski.mingle.venueportal.beans.PromotionBean@147834eb
07/05/2012 11:00:43 PM com.asteriski.mingle.venueportal.dao.PromotionDAO save
INFO: content:another one here11
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl putObjectIntoCache
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@6ac1abcf" (id="org.datanucleus.identity.IdentityReference@20e74663") added to Level 1 cache (loadedFlags="[YYYYYYYYYY]")
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@47d77d9e for key=org.datanucleus.ObjectManagerImpl@1f4790be in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@47d77d9e for key=org.datanucleus.ObjectManagerImpl@1f4790be in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@47d77d9e for key=org.datanucleus.ObjectManagerImpl@1f4790be in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@47d77d9e for key=org.datanucleus.ObjectManagerImpl@1f4790be in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@47d77d9e for key=org.datanucleus.ObjectManagerImpl@1f4790be in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl replaceObjectId
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@6ac1abcf" (id="org.datanucleus.identity.IdentityReference@20e74663") being changed to be referenced by id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)" in Level 1 cache
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl putObjectIntoCache
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@6ac1abcf" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)") added to Level 1 cache (loadedFlags="[YYYYYYYYYY]")
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@47d77d9e for key=org.datanucleus.ObjectManagerImpl@1f4790be in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl performLevel2CacheUpdateAtCommit
FINE: Object with id="org.datanucleus.identity.IdentityReference@20e74663" removed from Level 2 cache since was updated yet object has been GCed
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl$1 managedConnectionPostClose
FINE: Connection removed from the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@47d77d9e for key=org.datanucleus.ObjectManagerImpl@1f4790be in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM org.datanucleus.state.LifeCycleState changeState
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@6ac1abcf" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)") has a lifecycle change : "P_NEW"->"DETACHED_CLEAN"
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl removeObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)" being removed from Level 1 cache [current cache size = 1]
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl disconnectSMCache
FINE: Level 1 Cache cleared 
```

读取实体

```
07/05/2012 11:00:43 PM com.google.appengine.datanucleus.query.JPQLQuery performExecute
FINE: JPQL Query : Execution Time = 6 ms
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id "com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(3)" not found in Level 1 cache [cache size = 0]
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(3)" taken from Level 2 cache (loadedFlags="[YYYYYYYYYY]", relationFields="null") - extracting into managed persistable object
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl putObjectIntoCache
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@1aa3c177" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(3)") added to Level 1 cache (loadedFlags="[NNNYNNNNNN]")
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(3)" taken from Level 2 cache represented as "com.asteriski.mingle.venueportal.entity.MerchantPromotion@1aa3c177" 
07/05/2012 11:00:43 PM org.datanucleus.state.LifeCycleState changeState
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@1aa3c177" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(3)") has a lifecycle change : "P_CLEAN"->"P_NONTRANS"
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@230cc23b for key=org.datanucleus.ObjectManagerImpl@2db1d931 in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM com.asteriski.mingle.venueportal.service.PromotionService find
INFO: published:MerchantLocation does not exist
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id "com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(4)" not found in Level 1 cache [cache size = 1]
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(4)" taken from Level 2 cache (loadedFlags="[YYYYYYYYYY]", relationFields="null") - extracting into managed persistable object
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl putObjectIntoCache
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@74f2794a" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(4)") added to Level 1 cache (loadedFlags="[NNNYNNNNNN]")
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(4)" taken from Level 2 cache represented as "com.asteriski.mingle.venueportal.entity.MerchantPromotion@74f2794a" 
07/05/2012 11:00:43 PM org.datanucleus.state.LifeCycleState changeState
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@74f2794a" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(4)") has a lifecycle change : "P_CLEAN"->"P_NONTRANS"
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@230cc23b for key=org.datanucleus.ObjectManagerImpl@2db1d931 in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM com.asteriski.mingle.venueportal.service.PromotionService find
INFO: published:MerchantLocation does not exist
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id "com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)" not found in Level 1 cache [cache size = 2]
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)" taken from Level 2 cache (loadedFlags="[YYYYYYYYYY]", relationFields="null") - extracting into managed persistable object
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl putObjectIntoCache
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@574a3347" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)") added to Level 1 cache (loadedFlags="[NNNYNNNNNN]")
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl getObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)" taken from Level 2 cache represented as "com.asteriski.mingle.venueportal.entity.MerchantPromotion@574a3347" 
07/05/2012 11:00:43 PM org.datanucleus.state.LifeCycleState changeState
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@574a3347" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)") has a lifecycle change : "P_CLEAN"->"P_NONTRANS"
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl allocateConnection
FINE: Connection found in the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@230cc23b for key=org.datanucleus.ObjectManagerImpl@2db1d931 in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM com.asteriski.mingle.venueportal.service.PromotionService find
INFO: published:null
07/05/2012 11:00:43 PM org.datanucleus.store.connection.ConnectionManagerImpl$1 managedConnectionPostClose
FINE: Connection removed from the pool : com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl$DatastoreManagedConnection@230cc23b for key=org.datanucleus.ObjectManagerImpl@2db1d931 in factory=ConnectionFactory:tx[com.google.appengine.datanucleus.DatastoreConnectionFactoryImpl@7fac4f3e]
07/05/2012 11:00:43 PM org.datanucleus.state.LifeCycleState changeState
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@574a3347" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)") has a lifecycle change : "P_NONTRANS"->"DETACHED_CLEAN"
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl removeObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(5)" being removed from Level 1 cache [current cache size = 3]
07/05/2012 11:00:43 PM org.datanucleus.state.LifeCycleState changeState
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@74f2794a" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(4)") has a lifecycle change : "P_NONTRANS"->"DETACHED_CLEAN"
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl removeObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(4)" being removed from Level 1 cache [current cache size = 2]
07/05/2012 11:00:43 PM org.datanucleus.state.LifeCycleState changeState
FINE: Object "com.asteriski.mingle.venueportal.entity.MerchantPromotion@1aa3c177" (id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(3)") has a lifecycle change : "P_NONTRANS"->"DETACHED_CLEAN"
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl removeObjectFromCache
FINE: Object with id="com.asteriski.mingle.venueportal.entity.MerchantPromotion:MerchantPromotion(3)" being removed from Level 1 cache [current cache size = 1]
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl disconnectSMCache
FINE: Level 1 Cache cleared
07/05/2012 11:00:43 PM org.datanucleus.ObjectManagerImpl initialiseLevel1Cache
FINE: Level 1 Cache of type "soft" initialised 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T12:43:39.027

我在应用引擎上使用 jpa 和 datanucleus。如果我运行查询“DELETE FROM SOMETABLENAME a”，然后通过它的 id 获取对象，缓存仍然会返回它！

添加到我的 persistence.xml 文件解决了这个问题。

当前的库版本是

```
datanucleus-api-jdo-3.1.1 
datanucleus-api-jpa-3.1.1
datanucleus-core-3.1.1 
```

堆栈跟踪的一部分

```
ObjectManagerImpl.getObjectFromCache(Object) line: 5030 
ObjectManagerImpl.findObject(Object, boolean, boolean, String) line: 3282   
JPAEntityManager.find(Class<T>, Object, LockModeType, Map<String,Object>) line: 358 
JPAEntityManager.find(Class, Object) line: 256 
```

这是过去 6 个月内发生的更新吗？在更新到此版本之前，所有单元测试都很好。禁用缓存后，一切都会再次签出。应用引擎会尊重新设置吗？

# android - Android - 以错误的比例绘制位图

> ID：10490548
> 
> 赞同：2
> 
> 时间：2012-05-07T23:33:09.157
> 
> 标签：android, bitmap, scale, terrain, world-map

为了好玩，我一直在研究一个简单的基于瓷砖的地形生成器，但遇到了一些问题。

一、资料：

设备：宏碁 Iconica a500

操作系统：ICS

目标版本：3.1+

可用屏幕分辨率：1280x752

编程于：Eclipse / AIDE

所以，现在的问题：

我正在使用的所有瓷砖都被绘制得比它们应该的大。Tehy 都是 32x32 .png 文件，但它们都以 43 x 43 的分辨率绘制在屏幕上。从我读到的内容来看，这可能与它们被绘制到的画布的密度有关，所以我试图通过添加来修复它

```
canvas.setDensity(0x0000000);  //density int value for DENSITY_NONE 
```

不幸的是，这并没有解决问题。我也尝试对单个位图进行相同的操作，但无济于事。

我试图在 Stack 和其他地方找到解决方案，但到目前为止还没有运气。

有谁知道如何解决这一问题？

先感谢您。这是我的绘图类的完整代码：（我知道这段代码可能有很多问题，我是一名业余程序员。欢迎提出建设性的批评）

```
package com.psstudio.hub.views;

import java.util.Random;

import com.psstudio.hub.R;
import com.psstudio.hub.R.drawable;
import com.psstudio.hub.gen.PocketDimension;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.PointF;
import android.view.Display;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

import android.util.AttributeSet;
import android.util.Log;

public class DrawWorld extends SurfaceView implements SurfaceHolder.Callback {

private WorldThread wThread;

PointF playerPos = new PointF();
PocketDimension dim = null;             //Holder for the dimension

int screenW = 0;        //this.getWidth();
int screenH = 0;        //this.getHeight();
int dimType = 1;                    //Which type of dimension is it?
int curType = -1;
int r;
int g;
int b;
int numTilesX;
int numTilesY;

float curX = 0.0f;
float curY = 0.0f;
float curXOffset = 0.0f;
float curYOffset = 0.0f;

private boolean run = false;

Random rand = new Random(255-0);

Paint heightPaint = new Paint();
Paint black = new Paint();
Paint colorPaint = new Paint();

Bitmap grassBMP = BitmapFactory.decodeResource(getResources(), R.drawable.grass);
Bitmap dirtBMP = BitmapFactory.decodeResource(getResources(), R.drawable.dirt);
Bitmap mountainBMP = BitmapFactory.decodeResource(getResources(), R.drawable.mountain);
Bitmap treeBMP = BitmapFactory.decodeResource(getResources(), R.drawable.tree);
Bitmap stoneBMP = BitmapFactory.decodeResource(getResources(), R.drawable.stone);
Bitmap oceanBMP = BitmapFactory.decodeResource(getResources(), R.drawable.ocean);
Bitmap nothingBMP = BitmapFactory.decodeResource(getResources(), R.drawable.nothing);
Bitmap bTemp = null;

double curElevation = 0.0;

boolean drawHeight = false;
boolean drawContour = false;
boolean drawTerrain = false;
boolean minimap = false;

MiniMap mMap;

public void init(){
    getHolder().addCallback(this);
    wThread = new WorldThread(getHolder(), this);
}

public DrawWorld(Context context) {
    super(context);
    init();
}

public DrawWorld(Context context, AttributeSet attrs) {
    super(context, attrs);
    init();
}

public DrawWorld(Context context, PocketDimension _dim) {
    super(context);
    dim = _dim;;
    init();
}

@Override
protected void onSizeChanged(int xNew, int yNew, int xOld, int yOld){       //used to get the view dimensions.
    screenW = xNew;
    screenH = yNew;
    Log.d("Hub", "Screen W x H : " + screenW + " x " + screenH + "  |  " + this.getWidth() + " x " + this.getHeight());
    numTilesX = screenW / 32;
    numTilesY = screenH / 32;
}

public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
    // TODO Auto-generated method stub

}

public void surfaceCreated(SurfaceHolder arg0) {
    //Log.d("Hub","Surface Created");
    wThread.setRunning(true);
    wThread.start();

}

public void surfaceDestroyed(SurfaceHolder arg0) {
    boolean retry = true;
    wThread.setRunning(false);
    while(retry){
        try{
            wThread.join();
            retry=false;
        } catch(InterruptedException e){

        }
    }

}

/*************************************************************
 * 
 * Get Methods
 * 
 ************************************************************/

/*************************************************************
 * 
 * Set Methods
 * 
 ************************************************************/
public void setPocketDimension(PocketDimension _dim, MiniMap mm, float pX, float pY){
    dim = _dim;
    mMap = mm;
    playerPos.set(pX, pY);
    //Log.d("Hub", "Dimension set, starting thread");
}

public void setPlayerPos(float pX, float pY){
    playerPos.x = pX;
    playerPos.y = pY;
}

class WorldThread extends Thread{       //Thread for handling tile selection and adjusting map to match character pos.

    private SurfaceHolder surfaceHolder;
    private DrawWorld dTV;              //drawWorld View

    public void setRunning(boolean isRun){
        run = isRun;
    }//end setRunning()

    public WorldThread(SurfaceHolder surface, DrawWorld drawWorld) {
        surfaceHolder = surface;
        dTV = drawWorld;
    }

    public void run() {
        Canvas canvas;
        boolean first = false;

        //Log.d("Hub", "mMap : " + mMap + "  |  nTX : " + numTilesX + "  |  nTY : " + numTilesY);
        mMap.setMiniMapInfo(numTilesX, numTilesY);

        /*while (run) {
            canvas = null;
            try {
                canvas = surfaceHolder.lockCanvas();
                synchronized (surfaceHolder){
                    if(canvas != null){
                        dTV.onDraw(canvas);
                    } else {
                        Log.d("Hub", "null canvas");
                    }
                }
            } finally {
                // do this in a finally so that if an except is thrown
                // during the above, we don't leave the Surface in an 
                // inconsistent state
                if ( canvas != null) {
                    surfaceHolder.unlockCanvasAndPost(canvas);
                }
            }

            /*******************************************************
             * 
             *  Put all things that happen here
             *   
             ******************************************************/
            //Log.d("Hub", "Draw World Thread");

        //} // end while (run)*
    }//end run()

} //end WorldThread() class

public void onDraw(Canvas canvas){

    //Log.d("Hub", "Starting onDraw()");
    Bitmap toDraw = null;
    Bitmap player = BitmapFactory.decodeResource(getResources(), R.drawable.player);

    //Log.d("Hub", "numTilesX : " + numTilesX + "  |  numTilesY : " + numTilesY);
    heightPaint.setColor(Color.WHITE);
    black.setColor(Color.BLACK);

    //Log.d("Hub", "onDraw();" + screenW + "  |  " + screenH);      //Test successful, it is reaching onDraw()

    //canvas.drawColor(Color.BLACK);

    for(int x = -1; x < numTilesX + 2; x++){
        for(int y = -1; y < numTilesY + 2 ; y++){

            curType = -1;
            curX = ((playerPos.x - (numTilesX / 2)) + x);
            curY = ((playerPos.y - (numTilesY / 2)) + y);
            curXOffset = (playerPos.x - ((int) playerPos.x));
            curYOffset = (playerPos.y - ((int) playerPos.y));

        //  Log.d("Hub", "CurX : " + curX + "  |  CurY : " + curY);     
            if(curX >= 0 && curY >= 0 && curX < (200 - (numTilesX / 2)) && curY < (200 - (numTilesY/2))){
                curType = dim.getType((int)curX, (int)curY);    //get the tile for the current x position
            } else {
                curType = -1;
            }

            toDraw = getBMP(curType);
            canvas.drawBitmap(toDraw, (x*32) - (curXOffset * 32), (y*32) - (curYOffset * 32), null);
            //canvas.drawRect(624,384,624+32+11,384+32+11,heightPaint); //32x32 bitmaps are being drawn at 43x43
            canvas.drawBitmap(player, 624, 384, null);

        }
    }

    if(drawHeight || drawContour || drawTerrain){
        for(int x = 0; x < 200; x++){               //Draw Heightmap, "Contour" map, and Terrain Map
            for(int y = 0; y < 200; y++){

                curType = dim.getType(x, y);
                curElevation = dim.getElevation(x, y);

                if(drawHeight){
                    heightPaint.setAlpha((int) (255*dim.getElevation(x, y)));
                    canvas.drawPoint(x + 20, y + 20, black);
                    canvas.drawPoint(x + 20, y + 20, heightPaint);      //Heightmap
                }

                colorPaint.setColor(Color.WHITE);
                if(drawContour){
                    if(curElevation >= 0.01 && curElevation <0.1) colorPaint.setColor(Color.BLACK);
                    else if(curElevation >= 0.1 && curElevation <0.2) colorPaint.setColor(Color.rgb(127, 0, 255));
                    else if(curElevation >= 0.2 && curElevation <0.3) colorPaint.setColor(Color.rgb(75, 0, 130));
                    else if(curElevation >= 0.3 && curElevation <0.4) colorPaint.setColor(Color.BLUE);
                    else if(curElevation >= 0.4 && curElevation <0.5) colorPaint.setColor(Color.GREEN);
                    else if(curElevation >= 0.5 && curElevation <0.6) colorPaint.setColor(Color.YELLOW);
                    else if(curElevation >= 0.6 && curElevation <0.7) colorPaint.setColor(Color.rgb(255,127,0));
                    else if(curElevation >= 0.7) colorPaint.setColor(Color.RED);
                    canvas.drawPoint(x + 20, y + 220, colorPaint);      //"Contour" Map
                }

                if(drawTerrain){
                    if(curType == 1) colorPaint.setColor(Color.rgb(1, 166, 17));
                    else if(curType == 2) colorPaint.setColor(Color.rgb(207, 181, 144));
                    else if(curType == 3) colorPaint.setColor(Color.rgb(105, 108, 117));
                    else if(curType == 4) colorPaint.setColor(Color.rgb(0, 92, 9));
                    else if(curType == 5) colorPaint.setColor(Color.rgb(186, 173, 166));
                    else if(curType == 6) colorPaint.setColor(Color.BLUE);
                    canvas.drawPoint(x + 20, y + 420, colorPaint);      //Terrain Map
                }
            }
        }
    }

    r = rand.nextInt();
    g = rand.nextInt();
    b = rand.nextInt();

    colorPaint.setColor(Color.rgb(r, g, b));

    canvas.drawRect (0,0,10,10,colorPaint);

    //Log.d("Hub", "Ending onDraw()");
}// end onDraw()

public Bitmap getBMP(int nBMP){

    bTemp = nothingBMP; // image for areas beyond the map
    switch (dimType){
    case 1:
        switch(nBMP){
            case -1:
                bTemp = nothingBMP;
                break;
            case 1 :
                bTemp = grassBMP;
                break;
            case 2 :
                bTemp = dirtBMP;
                break;
            case 3 :
                bTemp = mountainBMP;
                break;
            case 4 :
                bTemp = treeBMP;
                break;
            case 5 :
                bTemp = stoneBMP;
                break;
            case 6 :
                bTemp = oceanBMP;
                break;
        }
    }
    //Log.d("Hub", "getBMP() " + dimType + "  |  " + nBMP + "  |  " + bTemp );
    //bTemp.setDensity(0x0000000);
    return bTemp;
}//end getBMP();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:47:01.030

当您使用 解码位图时，实际上会发生基于密度的缩放`decodeResources`。您可以使用[`BitmapFactory.Options`](http://developer.android.com/reference/android/graphics/BitmapFactory.Options.html)指定的重载。有许多选项，但您可能只想设置[`inScaled`](http://developer.android.com/reference/android/graphics/BitmapFactory.Options.html#inScaled)为`false`.

# perl - 如何使用我的脚本分发 perl 模块？

> ID：10490555
> 
> 赞同：1
> 
> 时间：2012-05-07T23:34:13.463
> 
> 标签：perl, module, distribution, distribute

这是个好主意吗？我写了一个脚本，它使用了一些不受欢迎的模块。安装它们需要很长时间，所以我认为最好将它们与我的应用程序一起分发。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T08:42:11.160

通常将依赖项放在`inc`您的发行版目录中。[我在如何链接 PerlIO Perl 包而不“安装它”](https://stackoverflow.com/questions/9066955/how-do-i-link-perlio-perl-package-without-installing-it)并[自动从 CPAN 安装缺少的模块](https://stackoverflow.com/questions/8183293/automatically-install-missing-modules-from-cpan)之前已经讨论过这个问题。

这个问题很模糊，所以不是代码，而是建议：我假设你根本不需要安装。将解压后的依赖项放入`inc`目录中。在运行时使用[`use lib 'inc';`](http://p3rl.org/lib).

就这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T02:22:49.000

当然。在 Apache 许可下，您可以重新分发模块。

这些面向对象的模块不导入任何功能吗？然后，您无需执行任何操作。只需`use My::Module;`从主程序中删除 ，然后将其附加`My::Module`到主程序的末尾即可。

如果您不使用面向对象的代码，而是通过`@EXPORT`数组导出函数，则必须采取一些额外的措施：

在这里，我必须添加`Local::Foo->import qw(foo)`将`foo`函数导入主程序**，即使它是通过`@EXPORT`而不是`@EXPORT_OK`**导出的。我还必须在模块中的导出声明周围使用 BEGIN。否则，我的主程序将找不到要导入的内容：

原创节目：

## 主程序：

```
#! /usr/bin/env perl
# test.pl

use warnings;
use strict;
use Local::Foo;

use feature qw(say);

my $bar = foo("bar");

say "Bar is '$bar'"; 
```

## 模块本地::Foo

```
#! /usr/bin/env perl
# Local/Foo.pm
#
package Local::Foo;

use Exporter qw(import);
our @EXPORT = qw(foo);

sub foo {
    my $value = shift;
    return "FOOOOOO $value";
}
1; 
```

## 联合计划

```
#! /usr/bin/env perl
# test.pl

use warnings;
use strict;
# use Local::Foo;

# Force importation of `foo`

Local::Foo->import qw(foo);

use feature qw(say);

my $bar = foo("bar");

say "Bar is '$bar'";

#-----------------------------------------------------------------------
#! /usr/bin/env perl
# Local/Foo.pm
#
package Local::Foo;

# Add BEGIN clause to module

BEGIN {
    use Exporter qw(import);
    our @EXPORT = qw(foo);
}

sub foo {
    my $value = shift;
    return "FOOOOOO $value";
}
1; 
```

# html - Mobile Safari - Html 下载链接打开选项卡而不是下载文件

> ID：10490558
> 
> 赞同：1
> 
> 时间：2012-05-07T23:34:25.643
> 
> 标签：html, ipad, mobile-safari

我正在使用具有下载 xml 文件的链接的 web 应用程序。如中，单击链接，浏览器下载文件。该文件按预期从我桌面上的 Chrome/FF/Safari 下载。当我将我的用户代理伪装成 iPad 时，它也适用于 FF。但是，当从 iPad 上的 Mobile Safari 中单击时，该链接会将浏览器导航到新页面并尝试将 xml 显示为 html，而无需下载任何内容。

当前，HTTP 响应包含以下标头：

```
Content-Disposition:attachment; filename="myFile.xml"    
Content-Type:application/octet-stream;charset=UTF-8 
```

据我了解，这两个 HTTP 标头应该告诉浏览器下载而不是显示响应流。

有人知道为什么这在 iPad 上运行的 Mobile Safari 中不起作用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T23:52:37.993

MobileSafari 通常不会下载文件，即使在 HTTP 标头中指示。例如，在 MobileSafari 中不可能从网站下载 MP3，它只会播放它。这源于 iPhone/iPad 没有用户可访问的文件系统 - 如果您无法访问文件系统，则实际上无法保存或访问下载的文件。所以，因为 MobileSafari 不能下载文件，它只会尝试显示它，不管 HTTP 标头说什么。

# sql - 需要将缓冲区记录添加到 CSV 文件中，以在记录 ID 的间隙之间提供填充物

> ID：10490561
> 
> 赞同：0
> 
> 时间：2012-05-07T23:34:48.427
> 
> 标签：sql, csv, excel-2007

我有一个包含大约 2,000 个客户帐户的 CSV 文件。不幸的是，客户 ID 不是从 1 开始的，也不是按顺序排列的。例如，客户 ID 在排序后按此顺序（2、3、12、19、23 等）

MS Excel 2007 或 SQL 或任何其他应用程序/工具中是否有任何功能可以填补 CustomerID 之间的空白？对于已填写的记录，我可以为客户姓名、地址等使用一些虚拟数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:53:49.803

将数据导入excel。使用公式填写 A 列，这样不会跳过任何数字。

*   使用 vlookup 填充基于 ID 匹配的列
*   空白/#N/A 是您需要修复的记录
*   另存为 CSV（完成）

第 8 行显示了我使用的公式 C1:D3 是 lokup 值，因此您可以看到 1,3、5 已填充 2 4、6、7 未填充

![在此处输入图像描述](../Images/f83a01c7a4c84073ae8736e1b59d81bb.png)

# knockout.js - knockout.js 并没有在页面加载时绑定下拉列表

> ID：10490562
> 
> 赞同：0
> 
> 时间：2012-05-07T23:34:57.503
> 
> 标签：knockout.js

我有一个绑定到下拉列表的可观察数组。下拉列表通过 ASP.NET MVC Html Helpers 在页面加载时填充，但由于可观察数组设置为 []，它会删除所有内容。有没有办法让它不删除页面加载或初始应用绑定时的所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:50:20.870

听起来您想稍后从可观察数组中设置选项（可能来自 AJAX 调用？）。Knockout 没有任何内置的方法来做到这一点。我看到你至少有三个选择：

1.  显而易见的方法是让您的 ASP.NET 代码填写可观察数组而不是选择列表。然后 Knockout 将做正确的事情并填充您的下拉列表。

2.  使用包装绑定的自定义绑定`options`，但忽略空数组：

    ```
    ko.bindingHandlers.optionsNotBlank = {
        update: function (element, valueAccessor, allBindingsAccessor) {
            var value = ko.utils.unwrapObservable(valueAccessor());
            if (value.length)
                ko.bindingHandlers.options.update(element, valueAccessor, allBindingAccessor);
        }
    }; 
    ```

3.  动态设置`options`下拉列表上的绑定。这不是已发布的功能，但确实使用了导出的 Knockout 方法。代替使用标准`data-bind`属性，您将使用该`ko.applyBindingsToNode`方法并在您填写完可观察数组后将绑定对象传递给它。不过，您需要小心只调用`ko.applyBindingsToNode`一次。

    ```
    viewModel.myArrayOfItem(newValues);
    if (!boundDropDown) {
        ko.applyBindingsToNode(document.getElementById("mydropdown"), { options: viewModel.myArrayOfItems }, viewModel);
        boundDropDown = true;
    } 
    ```

编辑：

这是基于使用“脏”标志的评论的第四个选项：

```
 ko.bindingHandlers.optionsNotBlank = {
        update: function (element, valueAccessor, allBindingsAccessor) {
            var value = ko.utils.unwrapObservable(valueAccessor()),
                isDirty = element._isDirty;
            if (isDirty || value.length) {
                element._isDirty = true;
                ko.bindingHandlers.options.update(element, valueAccessor, allBindingAccessor);
            }
        }
    }; 
```

# scala - 当scala文件有中文字符用于注释时如何设置scala编译器

> ID：10490563
> 
> 赞同：2
> 
> 时间：2012-05-07T23:35:01.090
> 
> 标签：scala

我用中文评论 Rational.scala 文件的代码行，如下所示：

```
var a = new Rational(-4,6)
var b = new Rational(3,-9)
var c = a + a * b //满足运算符的优先级别 
```

当我运行命令时：

> scala Rational.scala

它抛出一个异常。而我留下评论或用英文评论，没关系！

我要配置什么？

很感谢

仅供参考：这是例外：

```
java.lang.ClassNotFoundException: Main (args = , classpath = d:\DOCUME~1\LUJUNM~1\LOCALS~1\Temp\scalascript3969467400078546162.tmp;C:\Program%20Files\
Java\jdk1.6.0_20\jre\lib\resources.jar;C:\Program%20Files\Java\jdk1.6.0_20\jre\lib\rt.jar;C:\Program%20Files\Java\jdk1.6.0_20\jre\lib\jsse.jar;C:\Prog
ram%20Files\Java\jdk1.6.0_20\jre\lib\jce.jar;C:\Program%20Files\Java\jdk1.6.0_20\jre\lib\charsets.jar;C:\Program%20Files\Java\jdk1.6.0_20\jre\lib\ext\
dnsns.jar;C:\Program%20Files\Java\jdk1.6.0_20\jre\lib\ext\localedata.jar;C:\Program%20Files\Java\jdk1.6.0_20\jre\lib\ext\sunjce_provider.jar;C:\Progra
m%20Files\Java\jdk1.6.0_20\jre\lib\ext\sunmscapi.jar;C:\Program%20Files\Java\jdk1.6.0_20\jre\lib\ext\sunpkcs11.jar;C:\SCALA-~1.FIN\bin\..\lib\jline.ja
r;C:\SCALA-~1.FIN\bin\..\lib\scala-compiler.jar;C:\SCALA-~1.FIN\bin\..\lib\scala-dbc.jar;C:\SCALA-~1.FIN\bin\..\lib\scala-library.jar;C:\SCALA-~1.FIN\
bin\..\lib\scala-swing.jar;C:\SCALA-~1.FIN\bin\..\lib\scalap.jar;C:\Program%20Files\Java\jdk1.6.0_20\bin;C:\Program%20Files\Java\jdk1.6.0_20\lib)
        at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.run(ScalaClassLoader.scala:103)
        at scala.tools.nsc.ObjectRunner$.run(ObjectRunner.scala:33)
        at scala.tools.nsc.ObjectRunner$.runAndCatch(ObjectRunner.scala:40)
        at scala.tools.nsc.ScriptRunner.scala$tools$nsc$ScriptRunner$$runCompiled(ScriptRunner.scala:171)
        at scala.tools.nsc.ScriptRunner$$anonfun$runScript$1.apply(ScriptRunner.scala:188)
        at scala.tools.nsc.ScriptRunner$$anonfun$runScript$1.apply(ScriptRunner.scala:188)
        at scala.tools.nsc.ScriptRunner$$anonfun$withCompiledScript$1.apply$mcZ$sp(ScriptRunner.scala:157)
        at scala.tools.nsc.ScriptRunner$$anonfun$withCompiledScript$1.apply(ScriptRunner.scala:131)
        at scala.tools.nsc.ScriptRunner$$anonfun$withCompiledScript$1.apply(ScriptRunner.scala:131)
        at scala.tools.nsc.util.package$.waitingForThreads(package.scala:26)
        at scala.tools.nsc.ScriptRunner.withCompiledScript(ScriptRunner.scala:130)
        at scala.tools.nsc.ScriptRunner.runScript(ScriptRunner.scala:188)
        at scala.tools.nsc.ScriptRunner.runScriptAndCatch(ScriptRunner.scala:201)
        at scala.tools.nsc.MainGenericRunner.runTarget$1(MainGenericRunner.scala:58)
        at scala.tools.nsc.MainGenericRunner.process(MainGenericRunner.scala:80)
        at scala.tools.nsc.MainGenericRunner$.main(MainGenericRunner.scala:89)
        at scala.tools.nsc.MainGenericRunner.main(MainGenericRunner.scala) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:13:18.673

您的问题是您使用的是 Windows，而 Windows 的默认字符集不是 UTF-8。

做这个：

1.  确保您知道写入源文件的字符集是什么。最好是 UTF-8。

2.  使用参数`-encoding`指定要使用的字符集。例如，`scalac -enconding utf8 Rational.scala`。

# hadoop - 检索 PIG 中出现频率最高的值

> ID：10490567
> 
> 赞同：2
> 
> 时间：2012-05-07T23:35:24.193
> 
> 标签：hadoop, apache-pig

如果我有以下数据集：

```
c1   c2
---  ---
1    5
1    5
1    6
2    9
2    9
3    1
3    2 
```

我想为第一列 (c1) 中的每个值返回第二列 (c2) 中出现频率最高的值。所以我希望返回的数据集如下所示，因为对于 c1=1，值“5”出现两次，值“6”只出现一次，而对于 c1=2，值“9”出现两次，没有出现其他值：

```
1    5
2    9
3    1 
```

我遇到问题的情况是出现的次数相等（在这种情况下，c1=3。）在 c2 中出现的值数量相等的情况下（c1=3），我只想要第一次出现返回。

任何想法都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T12:44:56.537

假设您在 A 上有 c1 和 c2 ：

```
B = GROUP A BY (c1, c2)
C = FOREACH B GENERATE GROUP, COUNT(A) as num;

D = GROUP C BY GROUP.c1
E = FOREACH D {
    SA = ORDER C BY num DESC;
    SB = LIMIT SA 1;
    GENERATE FLATTEN(SB.group);
} 
```

应该可以解决您的问题。（虽然我在记事本中写过，你应该通过描述/说明检查是否需要任何扁平化）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-19T09:57:49.810

对于像我这样的语言新手并试图理解上面代码中发生的事情的每个人，我的评论版本（添加了描述和转储输出）：

数据样本（'sample_data/test_limiting.pig'）：

```
1|5
1|5
1|6
2|9
2|9
3|1
3|2 
```

还有猪脚本本身：

```
A = LOAD 'sample_data/test_limiting.pig' USING PigStorage('|') AS (c1:int, c2:int);
----
-- A: {c1: int,c2: int}
----
-- (1,5)
-- (1,5)
-- (1,6)
-- (2,9)
-- (2,9)
-- (3,1)
-- (3,2)

B = GROUP A BY (c1, c2);
----
-- B: {group: (c1: int,c2: int),A: {(c1: int,c2: int)}}
----
-- ((1,5),{(1,5),(1,5)})
-- ((1,6),{(1,6)})
-- ((2,9),{(2,9),(2,9)})
-- ((3,1),{(3,1)})
-- ((3,2),{(3,2)})

C = FOREACH B GENERATE group, COUNT(A) as num;
----
-- C: {group: (c1: int,c2: int),num: long}
----
-- ((1,5),2)
-- ((1,6),1)
-- ((2,9),2)
-- ((3,1),1)
-- ((3,2),1)

D = GROUP C BY group.c1;
----
-- D: {group: int,C: {(group: (c1: int,c2: int),num: long)}}
----
-- (1,{((1,5),2),((1,6),1)})
-- (2,{((2,9),2)})
-- (3,{((3,1),1),((3,2),1)})

E = FOREACH D {
    SA = ORDER C BY num DESC;
    SB = LIMIT SA 1;
    GENERATE FLATTEN(SB.group);
}
----
-- E: {null::group: (c1: int,c2: int)}
----
-- ((1,5))
-- ((2,9))
-- ((3,1)) 
```

顺便说一句，我需要用小写字母写参考“组”，因为它被大写变体轰炸了。可能因为版本不同，不知道。

# javascript - 从遗留代码调用 AngularJS

> ID：10490570
> 
> 赞同：181
> 
> 时间：2012-05-07T23:35:52.297
> 
> 标签：javascript, actionscript-3, externalinterface, angularjs

我正在使用 AngularJS 构建与旧版 Flex 应用程序交互的 HTML 控件。Flex 应用程序的所有回调都必须附加到 DOM 窗口。

例如（在 AS3 中）

```
ExternalInterface.call("save", data); 
```

将会通知

```
window.save = function(data){
    // want to update a service 
    // or dispatch an event here...
} 
```

从 JS 调整大小函数中，我想调度一个控制器可以听到的事件。似乎创建服务是要走的路。你能从 AngularJS 之外更新服务吗？控制器可以监听来自服务的事件吗？在一个[实验中（点击小提琴）](http://jsfiddle.net/6JvRV/)，我似乎可以访问服务，但更新服务的数据并没有反映在视图中（在示例中`<option>`应该添加到`<select>`）。

谢谢！

* * *

## 回答 #1

> 赞同：296
> 
> 时间：2012-05-09T01:29:49.563

从 Angular 外部到 Angular 的互操作与调试 Angular 应用程序或与第三方库集成相同。

对于任何 DOM 元素，您都可以这样做：

*   `angular.element(domElement).scope()`获取元素的当前范围
*   `angular.element(domElement).injector()`获取当前的应用程序注入器
*   `angular.element(domElement).controller()`获取`ng-controller`实例。

从注入器中，您可以获取角度应用程序中的任何服务。同样，您可以从范围调用任何已发布到它的方法。

请记住，对角度模型的任何更改或范围上的任何方法调用都需要`$apply()`像这样包装：

```
$scope.$apply(function(){
  // perform any model changes or method invocations here on angular app.
}); 
```

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2013-07-21T05:03:46.013

Misko 给出了正确的答案（显然），但我们中的一些新手可能需要进一步简化它。

如果要从遗留应用程序中调用 AngularJS 代码，请将 AngularJS 代码视为存在于遗留应用程序的受保护容器中的“微型应用程序”。你不能直接调用它（有很好的理由），但你可以通过 $scope 对象进行远程调用。

要使用 $scope 对象，您需要获取 $scope 的句柄。幸运的是，这很容易做到。

您可以使用 AngularJS“微应用”HTML 中任何 HTML 元素的 id 来获取 AngularJS 应用 $scope 的句柄。

例如，假设我们想在 AngularJS 控制器中调用几个函数，例如 sayHi() 和 sayBye()。在 AngularJS HTML（视图）中，我们有一个 id 为“MySuperAwesomeApp”的 div。你可以使用下面的代码，结合jQuery来获取$scope的句柄：

```
var microappscope = angular.element($("#MySuperAwesomeApp")).scope(); 
```

现在您可以通过作用域句柄调用您的 AngularJS 代码函数：

```
// we are in legacy code land here...

microappscope.sayHi();

microappscope.sayBye(); 
```

为了使事情更方便，您可以随时使用函数来获取范围句柄：

```
function microappscope(){

    return angular.element($("#MySuperAwesomeApp")).scope();

} 
```

您的电话将如下所示：

```
microappscope().sayHi();

microappscope().sayBye(); 
```

你可以在这里看到一个工作示例：

[http://jsfiddle.net/peterdrinnan/2nPnB/16/](http://jsfiddle.net/peterdrinnan/2nPnB/16/)

我还在 Ottawa AngularJS 小组的幻灯片中展示了这一点（只需跳到最后两张幻灯片）

[http://www.slideshare.net/peterdrinnan/angular-for-legacyapps](http://www.slideshare.net/peterdrinnan/angular-for-legacyapps)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-03-09T19:34:58.440

我发现的概念的最佳解释位于此处： [https ://groups.google.com/forum/#!msg/angular/kqFrwiysgpA/eB9mNbQzcHwJ](https://groups.google.com/forum/#!msg/angular/kqFrwiysgpA/eB9mNbQzcHwJ)

为了节省您的点击：

```
// get Angular scope from the known DOM element
e = document.getElementById('myAngularApp');
scope = angular.element(e).scope();
// update the model with a wrap in $apply(fn) which will refresh the view for us
scope.$apply(function() {
    scope.controllerMethod(val);
}); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-01-30T10:15:14.357

感谢上一篇文章，我可以使用异步事件更新我的模型。

```
<div id="control-panel" ng-controller="Filters">
    <ul>
        <li ng-repeat="filter in filters">
        <button type="submit" value="" class="filter_btn">{{filter.name}}</button>
        </li>
    </ul>
</div> 
```

我声明我的模型

```
function Filters($scope) {
    $scope.filters = [];
} 
```

我从我的范围之外更新我的模型

```
ws.onmessage = function (evt) {
    dictt = JSON.parse(evt.data);
    angular.element(document.getElementById('control-panel')).scope().$apply(function(scope){
        scope.filters = dictt.filters;
    });
}; 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-10-10T13:53:39.727

进一步的其他答案。如果您不想访问控制器中的方法但想直接访问服务，您可以执行以下操作：

```
// Angular code* :
var myService = function(){
    this.my_number = 9;
}
angular.module('myApp').service('myService', myService);

// External Legacy Code:
var external_access_to_my_service = angular.element('body').injector().get('myService');
var my_number = external_access_to_my_service.my_number 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-12-04T00:15:57.643

更安全、更高效的方法，尤其是在调试数据关闭时，是使用共享变量来保存回调函数。您的角度控制器实现此功能以将其内部返回给外部代码。

```
var sharedVar = {}
myModule.constant('mySharedVar', sharedVar)
mymodule.controller('MyCtrl', [ '$scope','mySharedVar', function( $scope, mySharedVar) {

var scopeToReturn = $scope;

$scope.$on('$destroy', function() {
        scopeToReturn = null;
    });

mySharedVar.accessScope = function() {
    return scopeToReturn;
}
}]); 
```

**概括为可重用指令：**

我创建了一个“exposeScope”指令，它以类似的方式工作，但使用更简单：

```
<div ng-controller="myController" expose-scope="aVariableNameForThisScope">
   <span expose-scope='anotherVariableNameForTheSameScope" />
</div> 
```

这将当前范围（赋予指令的链接函数）存储在全局“范围”对象中，该对象是所有范围的持有者。提供给指令属性的值用作此全局对象中范围的属性名称。

[在此处](https://plnkr.co/edit/GjPuGIJePQwA9ivuIR3y)查看演示。正如我在演示中所展示的，当范围从全局“范围”对象中存储和删除时，您可以触发 jQuery 事件。

```
<script type="text/javascript" >
    $('div').on('scopeLinked', function(e, scopeName, scope, allScopes) {
      // access the scope variable or the given name or the global scopes object
    }.on('scopeDestroyed', function(e, scopeName, scope, allScopes) {
      // access the scope variable or the given name or the global scopes object
    }

</script> 
```

请注意，当实际元素从 DOM 中删除时，我没有测试 on('scopeDestroyed') 。如果它不起作用，则在文档本身而不是元​​素上触发事件可能会有所帮助。（参见 app.js ）演示插件中的脚本。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-03-22T04:25:40.250

**我知道这是一个老问题，但我最近正在寻找这样做的选项，所以我想我把我的发现放在这里，以防它对任何人有用。**

在大多数情况下，如果需要外部遗留代码与 UI 状态或应用程序的内部工作进行交互，则服务可能有助于抽象出这些更改。如果外部代码直接与您的角度控制器、组件或指令交互，则您的应用程序与遗留代码严重耦合，这是个坏消息。

我最终使用的是浏览器可访问的全局变量（即 window ）和事件处理的组合。我的代码有一个智能表单生成引擎，它需要来自 CMS 的 JSON 输出来初始化表单。这是我所做的：

```
function FormSchemaService(DOM) {
    var conf = DOM.conf;

    // This event is the point of integration from Legacy Code 
    DOM.addEventListener('register-schema', function (e) {

       registerSchema(DOM.conf); 
    }, false);

    // service logic continues .... 
```

表单模式服务按预期使用角度注入器创建：

```
angular.module('myApp.services').
service('FormSchemaService', ['$window' , FormSchemaService ]) 
```

在我的控制器中： function () { 'use strict';

```
angular.module('myApp').controller('MyController', MyController);

MyEncapsulatorController.$inject = ['$scope', 'FormSchemaService'];

function MyController($scope, formSchemaService) {
    // using the already configured formSchemaService
    formSchemaService.buildForm(); 
```

到目前为止，这是纯 Angular 和 javascript 面向服务的编程。但是遗留集成在这里：

```
<script type="text/javascript">

   (function(app){
        var conf = app.conf = {
       'fields': {
          'field1: { // field configuration }
        }
     } ; 

     app.dispatchEvent(new Event('register-schema'));

 })(window);
</script> 
```

显然，每种方法都有其优点和缺点。这种方法的优点和使用取决于您的 UI。之前建议的方法在我的情况下不起作用，因为我的表单架构和遗留代码无法控制和了解角度范围。因此，如果我们更改范围，基于配置我`angular.element('element-X').scope();` 的应用程序可能会破坏应用程序。但是，如果您的应用程序了解范围并且可以依赖它而不经常更改，那么之前建议的方法是一种可行的方法。

希望这可以帮助。也欢迎任何反馈。

# symfony - 多对多关系是否需要 Symfony 2 / Doctrine 中的“连接实体”？

> ID：10490575
> 
> 赞同：0
> 
> 时间：2012-05-07T23:36:56.030
> 
> 标签：symfony, doctrine-orm

我开始了解 Symfony 2 和 Doctrine 是如何处理多对多关系的，但我被困在一些事情上，我似乎已经阅读了不同的意见。

假设我有一个 Author 实体和一个 Book 实体……它们之间存在多对多关系。

在我的数据库中，我用三个表来表示它，一个`authors`表，一个`books`表和一个`authors_books`表（基本上只是将它们连接在一起。

在 Symfony 2 中，我是否还创建了一个`AuthorsBooks`实体，其唯一目的是将 Author 和 Book 实体连接在一起？或者，Symfony 会为我处理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T08:44:35.997

如果除了作者和书籍的关联之外别无其他，则无需创建`AuthorsBooks`实体。

您现在有两个选择，单向或双向。您可以在[此处直接在 Doctrine2 文档中找到更多信息](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html#many-to-many-bidirectional)

对于单向，你会有类似的东西（yml）：

```
Author:
  type: entity
  manyToMany:
    bookList:
      targetEntity: Group
      joinTable:
        name: authors_books
          joinColumns:
            user_id:
              referencedColumnName: id
          inverseJoinColumns:
            book_id:
              referencedColumnName: id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:43:11.280

Symfony 与此无关，这完全是 Doctrine 的事情。但是，不，您不必创建`AuthorsBooks`实体。您所要做的就是正确配置Doctrine，即使用[`@JoinTable`注释](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html#many-to-many-unidirectional)来指定应该使用哪个表来连接两个实体。

# ruby-on-rails - 我应该如何负责任地备份基于 heroku/s3/github 的应用程序？

> ID：10490576
> 
> 赞同：5
> 
> 时间：2012-05-07T23:37:07.693
> 
> 标签：ruby-on-rails, heroku, backup

我有一个在 Heroku 上运行的 rails 应用程序，使用他们的标准 postgres 数据库和托管在 s3 上的图像。

我应该如何负责任地进行备份？

到目前为止，我每月都会下载我的应用程序代码、s3 文件和数据库快照，并将其存储在外部驱动器上。从 s3 下载我的文件非常慢，我预计随着时间的推移它会变得更糟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:57:48.583

我一直在使用 PG Backups Heroku 插件：

[https://devcenter.heroku.com/articles/pgbackups](https://devcenter.heroku.com/articles/pgbackups)

它备份您的 postgres 数据库，并且可以配置为每天存储备份（或者如果需要，可以更频繁地存储）。我一般推荐它用于数据库的基本备份。

我只需将代码副本保存在 github（或其他一些 git 存储库）的存储库中。Github 很棒，我想不出做其他事情的理由。

S3 本身非常安全可靠。以下是他们产品信息的摘录：

> Amazon S3 提供了一个高度耐用的存储基础设施，专为关键任务和主要数据存储而设计。对象冗余存储在 Amazon S3 区域中跨多个设施的多个设备上。为帮助确保持久性，Amazon S3 PUT 和 COPY 操作在返回 SUCCESS 之前将您的数据同步存储在多个设施中。

如果从 S3 获得所有文件的安全副本很重要，我可能会设置某种定期安排的批处理作业，将它们复制到我可以单独备份的服务器。我过去曾使用**S3 工具**来执行此操作：

[http://s3tools.org/s3cmd](http://s3tools.org/s3cmd)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-09T22:53:24.650

我只需要归档一个站点，在该站点上，用于推送它的 git 存储库的访问权限并不容易获得。我使用 heruku cli 执行了以下操作。

*   登录
*   heroku git:clone -a your-app-name
*   heroku pg:backups:capture -a your-app-name
*   heroku pg:backups:download -a your-app-name

完成后，您将拥有一个代码目录和一个名为“latest.dump”的数据库转储，我建议您将其重命名为包含应用程序名称。

所有这些都相当容易编写脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-13T19:14:05.250

对于自动备份，您只需要配置[heroku-db-backup-s3](https://elements.heroku.com/buildpacks/devsenexx/heroku-db-backup-s3%20heroku-db-backup-s3%20buildpack) buildpack。并按照文档中的说明重新安排它。

# c - 希望提高这种内联汇编的效率，有人可以提供建议吗？

> ID：10490577
> 
> 赞同：0
> 
> 时间：2012-05-07T23:37:09.483
> 
> 标签：c, assembly, x86, inline-assembly

谢谢大家对我的耐心。我只需要把头绕在我正在看的东西上。为缓慢而道歉，只是试图学习和理解。

在重新阅读了每个人的评论并查看了几次代码后，我意识到我的问题指向了错误的方向。我

我会用简单的组装说明替换这两行吗？还是我必须做类似的事情`asm()`。我想这就是我感到困惑的地方。一旦我知道了这一点，我想我会从那里得到它。

**编辑**
我没有意识到我从帖子中省略了这个。显然是最重要的部分，感谢 Oli 指出。

*目标是用内联汇编代码替换附加程序中 for 循环内的两行代码。您必须从内联汇编代码中获得相同的输出。（执行相同的结果，循环次数相同）*

**C ：**

```
#include "stdlib.h"
#include "time.h"

int main (int argc, char* argv[])
{
    int num1 = 10;
    int num2 = 27;
    int sum = 0;
    int cases = 0;
    int loose = 0;
    float time1 = 0;
    float time2 = 0;
    float time = 0;
    int i = 0;

    sum = num1 + num2;

    asm("xor %%eax,%%eax;"
        "mov %1,%%eax;"
        "add %2,%%eax;"
        "mov %%eax,%0;"
        :"=r"(sum)                   /* outputs */
        :"r"(num1),"r"(num2)         /* input   */
        :"%eax");                    /*clobber list*/

    printf("The sum is %d \n",sum);

    time1 = clock();
    for (i = 0; i<1000000000; i++)
    { 

        cases = i/num1;
        loose = i%num1;

    }  
    printf("The number of cases are %d \n",cases);
    printf("The number of loose items are %d \n",loose);

    time2 = clock();

    time = (time2 - time1) / CLOCKS_PER_SEC;

    printf("The elapsed time is %f seconds \n", time);

    system("pause");
    return 0;
} 
```

**集会 ：**

```
.file   "inlineAsm.c"
.def    ___main;    .scl    2;  .type   32; .endef
.section .rdata,"dr"

LC1:
    .ascii "The sum is %d \12\0"
LC2:
    .ascii "The number of cases are %d \12\0"
    .align 4
LC3:
    .ascii "The number of loose items are %d \12\0"
    .align 4
LC5:
    .ascii "The elapsed time is %f seconds \12\0"
LC6:
    .ascii "pause\0"
    .align 4
LC4:
    .long   1148846080
    .text
.globl _main
    .def    _main;  .scl    2;  .type   32; .endef

_main:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $56, %esp
    andl    $-16, %esp
    movl    $0, %eax
    addl    $15, %eax
    addl    $15, %eax
    shrl    $4, %eax
    sall    $4, %eax
    movl    %eax, -40(%ebp)
    movl    -40(%ebp), %eax
    call    __alloca
    call    ___main
    movl    $10, -4(%ebp)
    movl    $27, -8(%ebp)
    movl    $0, -12(%ebp)
    movl    $0, -16(%ebp)
    movl    $0, -20(%ebp)
    movl    $0x00000000, %eax
    movl    %eax, -24(%ebp)
    movl    $0x00000000, %eax
    movl    %eax, -28(%ebp)
    movl    $0x00000000, %eax
    movl    %eax, -32(%ebp)
    movl    $0, -36(%ebp)
    movl    -8(%ebp), %eax
    addl    -4(%ebp), %eax
    movl    %eax, -12(%ebp)
    movl    -4(%ebp), %ecx
    movl    -8(%ebp), %edx
/APP
    xor %eax,%eax;mov %ecx,%eax;add %edx,%eax;mov %eax,%edx;
/NO_APP
    movl    %edx, %eax
    movl    %eax, -12(%ebp)
    movl    -12(%ebp), %eax
    movl    %eax, 4(%esp)
    movl    $LC1, (%esp)
    call    _printf
    call    _clock
    pushl   %eax
    fildl   (%esp)
    leal    4(%esp), %esp
    fstps   -24(%ebp)
    movl    $0, -36(%ebp)
L2:
    cmpl    $999999999, -36(%ebp)
    jg  L3
    movl    -36(%ebp), %edx
    leal    -4(%ebp), %ecx
    movl    %ecx, -40(%ebp)
    movl    %edx, %eax
    movl    -40(%ebp), %ecx
    cltd
    idivl   (%ecx)
    movl    %eax, -40(%ebp)
    movl    -40(%ebp), %eax
    movl    %eax, -16(%ebp)
    movl    -36(%ebp), %edx
    leal    -4(%ebp), %ecx
    movl    %ecx, -40(%ebp)
    movl    %edx, %eax
    movl    -40(%ebp), %ecx
    cltd
    idivl   (%ecx)
    movl    %edx, -20(%ebp)
    leal    -36(%ebp), %eax
    incl    (%eax)
    jmp L2
L3:
    movl    -16(%ebp), %eax
    movl    %eax, 4(%esp)
    movl    $LC2, (%esp)
    call    _printf
    movl    -20(%ebp), %eax
    movl    %eax, 4(%esp)
    movl    $LC3, (%esp)
    call    _printf
    call    _clock
    pushl   %eax
    fildl   (%esp)
    leal    4(%esp), %esp
    fstps   -28(%ebp)
    flds    -28(%ebp)
    fsubs   -24(%ebp)
    flds    LC4
    fdivrp  %st, %st(1)
    fstps   -32(%ebp)
    flds    -32(%ebp)
    fstpl   4(%esp)
    movl    $LC5, (%esp)
    call    _printf
    movl    $LC6, (%esp)
    call    _system
    movl    $0, %eax
    leave
    ret
    .def    _system     ;.scl   3;  .type   32; .endef
    .def    _clock      ;.scl   3;  .type   32; .endef
    .def    _printf     ;.scl   3;  .type   32; .endef 
```

**输出 ：**

```
/*
The sum is 37
The number of cases are 99999999
The number of loose items are 9
The elapsed time is 9.359000 seconds
Press any key to continue . . .
*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:43:30.883

看起来对您的程序最好的优化是简单地**删除**所有内联汇编，因为它与`sum = num1 + num2;`上面的语句做同样的事情 - 作为奖励，您的程序也将变得更加可移植！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:59:45.590

根据您在最近编辑中添加的信息，您需要修改循环内的代码以使程序更快。

在我看来，程序运行缓慢的原因是它无缘无故地循环了 1000000000 次。

显然，最好的办法是完全消除循环。但是，如果您仅限于修改循环内的代码，您是否可以让循环在除最后一次之外的每次迭代中都执行 NOOP？

注意：这是一个足够奇怪的问题，我仍然认为对赋值的参数可能存在一些误解。

编辑：让我们看一下内联汇编：

```
asm("xor %%eax,%%eax;"
    "mov %1,%%eax;"
    "add %2,%%eax;"
    "mov %%eax,%0;"
    :"=r"(sum)                   /* outputs */
    :"r"(num1),"r"(num2)         /* input   */
    :"%eax");                    /*clobber list*/ 
```

出于优化的目的，您需要了解的最重要的事情是*它只运行一次*。不仅如此，它还进行了一个极其简单和快速的操作，如果它是用 C 编写的，它可能同样简单和快速。除了让程序更复杂之外，拥有这个内联汇编没有任何意义，这是我的另一个原因觉得这个作业有些奇怪。它似乎充满了红鲱鱼。

让我们逐行看汇编程序。

第一行是清零`%eax`寄存器的简写方式。如果你`xor`有自己的东西，结果总是零。（我不知道为什么需要在这里，因为您正在覆盖`%eax`下一行的内容。）

第二行加载`%eax`变量 1，即第一个输入 ( `num1`)。

第三行将变量 2 ( `num2`) 添加到`%eax`.

第四行将加载的结果复制`%eax`到输出变量 ( `sum`)。

剩下的几行定义了我们刚刚提到的变量，顺序为 (0, 1, 2)，并且还告诉编译器您刚刚使用了该`%eax`寄存器，因此在接下来使用它之前必须将其清除。

您可以轻松地用 C 中的简单添加替换所有该汇编程序，并且不会更慢。编译器非常聪明。

基本上，您应该需要使用内联汇编程序的唯一情况是在一个循环中，该循环代表您的程序的大部分处理时间，在您知道编译器优化不佳的代码中。这个内联汇编器在这两个方面都不符合条件。尤其是因为它确实与它正上方的 C 行完全相同！您可以完全删除 asm() 调用，而根本不更改程序的输出。

如果您的任务是使您的程序明显更快，但仅限于编辑该内联汇编程序，那么您是在做傻事。

# c - MPI 在根进程上收集数组

> ID：10490579
> 
> 赞同：7
> 
> 时间：2012-05-07T23:37:12.463
> 
> 标签：c, mpi

我是 MPI 的新手。我有 4 个进程：进程 1 到 3 填充一个向量并将其发送到进程 0，进程 0 将向量收集到一个非常长的向量中。我有有效的代码（太长无法发布），但是进程 0 的 recv 操作很笨拙而且很慢。

抽象地说，代码执行以下操作：

```
MPI::Init();
int id = MPI::COMM_WORLD.Get_rank();

if(id>0) {
    double* my_array = new double[n*m]; //n,m are int
    Populate(my_array, id);
    MPI::COMM_WORLD.Send(my_array,n*m,MPI::DOUBLE,0,50);
}

if(id==0) {
    double* all_arrays = new double[3*n*m];
    /* Slow Code Starts Here */
    double startcomm = MPI::Wtime();
    for (int i=1; i<=3; i++) {
    MPI::COMM_WORLD.Recv(&all_arrays[(i-1)*m*n],n*m,MPI::DOUBLE,i,50);
    }
    double endcomm = MPI::Wtime();
    //Process 0 has more operations...
}
MPI::Finalize(); 
```

事实证明，`endcomm - startcomm`这占总时间的 50%（0.7 秒，而程序完成需要 1.5 秒）。

**有没有更好的方法来接收来自进程 1-3 的向量并将它们存储在进程 0 中`all_arrays`？**

我检查了 MPI::Comm::Gather，但我不确定如何使用它。特别是，它是否允许我指定进程 1 的数组是 all_arrays 中的第一个数组，进程 2 的数组是第二个，等等？谢谢。

**编辑：**我删除了“慢”循环，而是将以下内容放在“if”块之间：

```
MPI_Gather(my_array,n*m,MPI_DOUBLE,
    &all_arrays[(id-1)*m*n],n*m,MPI_DOUBLE,0,MPI_COMM_WORLD); 
```

结果同样缓慢。这是否与根进程在尝试下一个接收之前“等待”每个接收完成的事实有关？或者这不是正确的思考方式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-07T23:50:13.337

是的，`MPI_Gather`会这样做。从 MPI_Gather 的 anl[页面](http://www.mcs.anl.gov/research/projects/mpi/www/www3/MPI_Gather.html)：

```
int MPI_Gather(void *sendbuf, int sendcnt, MPI_Datatype sendtype, 
               void *recvbuf, int recvcnt, MPI_Datatype recvtype, 
               int root, MPI_Comm comm) 
```

这`sendbuf`是您在每个进程上的数组 ( `my_array`)。`recvbuf`是接收过程中的长数组 ( `all_arrays`)，短数组被收集到其中。接收过程中的短数组被复制到它在长数组中的连续位置，所以你不必担心自己做。每个进程的数组将连续排列在长数组中。

编辑：

如果接收进程在聚会中没有贡献 sendbuf，您可能希望改用[MPI_Gatherv](http://www.mcs.anl.gov/research/projects/mpi/www/www3/MPI_Gatherv.html)（感谢@HristoIliev 指出这一点）。

# javascript - 寻找一个好的 jQuery/JavaScript 验证插件

> ID：10490583
> 
> 赞同：0
> 
> 时间：2012-05-07T23:37:54.273
> 
> 标签：javascript, jquery

对于一个好的/简单的客户端验证插件或教程有什么建议吗？

*   想使用模糊对每个字段进行实时验证。
*   希望内置许多验证方案（即日期正确、电话号码等），但根据需要允许 ajax 调用（现有用户名、有效邮政编码等）
*   提交时需要检查必填字段。
*   希望能够在每个字段旁边自定义样式错误消息。
*   当最终发布要保存的数据时，允许相同的插件处理显示最终的服务器端验证错误可能会很好。
*   也许很高兴在焦点上显示建议文本。

还是从头开始制作一样容易？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:41:54.333

[jQuery.validate](http://docs.jquery.com/Plugins/Validation)是显而易见的候选者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:42:59.410

[http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)有一个很棒的验证插件。它非常可定制，并且有很好的基本用法文档，尽管您可能需要搜索有关如何进行更复杂验证的说明。

# php - 使用 javascript 在页面上显示 JSON 数据

> ID：10490586
> 
> 赞同：1
> 
> 时间：2012-05-07T23:38:10.700
> 
> 标签：php, ajax, json, jquery-ui, codeigniter

我终于成功地通过 AJAX 传递数据并以 JSON 格式返回。但是，现在我不知道如何在我的页面上显示它。

这是我的 JS：

```
$(function() {
    $( "#selectable" ).selectable({
        selected: updatefilters,
        unselected: updatefilters
    });   
    function updatefilters(ev, ui){
        // get the selected filters
        var $selected = $('#selectable').children('.ui-selected');
        // create a string that has each filter separated by a pipe ("|")
        var filters = $selected.map(function(){return this.id;}).get().join("\|");
        $.ajax({
            type: "POST",
            url: 'updatefilters',
            dataType: 'json', 
            data: { filters: filters },
            success: function(data){
                $('#board').replaceWith(data.content);
            }
        });
    }
}); 
```

在我的模型运行后，它会回显在 firebug 中发现的以下内容：

```
[{"thread_id":"226","owner_id":"1","subject":"trying to create a HUGE body for thread testi","body":"Firstly, I think 45 characters is perfect for the heading. \n\nHowever, once the body gets huge, I assume that the \"preview\" is going to get a bit out of hand if not truncated. I have truncated code in place...but it doesn't seem to be working.\n\nI'll have to keep testing to ensure we can get it shrunk down to a few hundred characters so as to not completely screw up the page format\n\nyadda yadda yadda...yadda yadda yadda...and more yadda yadda yadda...\n\nBabble Babble Babble Babble Babble \n\nBabble Babble Babble ","timestamp":"2012-05-02 15:29:19","replystamp":"2012-05-02 15:29:53","last_post_id":"1","slug":"226-trying-to-create-a-huge-body-for-thread-testi","replies_num":"1","views":"19"},{"thread_id":"219","owner_id":"3","subject":"testing icons","body":"hellow world","timestamp":"2012-05-01 11:37:08","replystamp":"2012-05-01 11:37:08","last_post_id":"3","slug":"219-testing-icons","replies_num":"0","views":"3"},{"thread_id":"212","owner_id":"1","subject":"This thread is based off entertainm","body":"Yay","timestamp":"2012-04-25 14:07:55","replystamp":"2012-04-25 14:07:55","last_post_id":"1","slug":"212-this-thread-is-based-off-entertainment","replies_num":"0","views":"4"}] 
```

关于如何用返回的 JSON 数组中的数据替换 div“板”的任何建议都将非常有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:41:38.457

```
success: function(data){
 $.each(data, function(index, value) { 
    $('#board').append(index + ': ' + value + '<br/>'); 
 });
} 
```

您也可以直接从 json 访问值

```
success: function(data) {
    $('#board').append('Thread Subject' + data.subject); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:51:11.320

假设您想在包含主题和正文的表格中显示数据。你可以这样写：

```
success: function(data){
    var html = "<table>";
    for (i=0 ; i< data.length ; i++)
    {
        html += "<tr><td>" + data[i].subject + "</td><td>" + data[i].body + "</td></tr>";
    }
    html += "</table";
    $('#board').html(html);
} 
```

你明白了。如果您有时间研究更好的解决方案，我还建议您研究模板库[mustache.js 。](https://github.com/janl/mustache.js)这将使您可以将模板与数据分开，并使用 Javascript 消除 HTML 和数据的丑陋连接。（虽然是一种更高级的解决方案，您可能只想保持简单。） Mustache.js 引擎允许您像这样编写上面的代码：

```
var template = "{{#item}}<tr><td>{{subject}}</td><td>{{body}}</td></tr>{{/item}}";
var html = "<table>" + mustache.render(template, data) + "</table>";
$("#board").html(html); 
```

# actionscript-3 - 将 Flex SWF 加载到 Flash 中的问题

> ID：10490590
> 
> 赞同：1
> 
> 时间：2012-05-07T23:38:33.877
> 
> 标签：actionscript-3, flash, apache-flex, actionscript, mxml

我正在尝试将 Flex SWF 加载到我的 Flash SWF 中，但它不起作用。我收到此错误：

```
Error: Error #2136: The SWF file file:///C|/Program%20Files/Adobe/Adobe%20Fireworks%20CS6/Configuration/Command%20Panels/Texture Panel.swf contains invalid data.

    at _Main_mx_managers_SystemManager/create()
    at mx.managers.systemClasses::ChildManager/initializeTopLevelWindow()
    at mx.managers::SystemManager/initializeTopLevelWindow()
    at mx.managers::SystemManager/http://www.adobe.com/2006/flex/mx/internal::kickOff()
    at mx.managers::SystemManager/http://www.adobe.com/2006/flex/mx/internal::preloader_completeHandler()
    at flash.events::EventDispatcher/dispatchEventFunction()
    at flash.events::EventDispatcher/dispatchEvent()
    at mx.preloaders::Preloader/timerHandler()
    at flash.utils::Timer/_timerDispatch()
    at flash.utils::Timer/tick() 
```

这是我的 Flash SWF 代码：

```
package 
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.text.*;
    import adobe.utils.*;
    import flash.external.ExternalInterface;
    import flash.display.Loader;
    import flash.net.URLRequest;

    public class Main extends Sprite 
    {

        public function Main():void 
        {
            if (stage) init(); else addEventListener(Event.ADDED_TO_STAGE, init);
        }

        private function init(e:Event = null):void 
        {
            removeEventListener(Event.ADDED_TO_STAGE, init);

            var myLoader:Loader = new Loader(); addChild(myLoader);

            function systemManagerHandler(event:Event):Boolean { event.preventDefault(); return false; }

            myLoader.addEventListener("mx.managers.SystemManager.isBootstrapRoot", systemManagerHandler);
            myLoader.addEventListener("mx.managers.SystemManager.isStageRoot", systemManagerHandler);

            myLoader.load(new URLRequest("Texture Panel.swf"));
        }

    }

} 
```

我很乐意为此提供任何帮助。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T15:04:07.217

来自安迪摩尔的[提示：](http://www.andymoore.ca/2010/11/flash-error-2136-oh-joy/)

1) Flash：文件 > 新建 > Flash AS3.0 文件

2) 从旧 FLA 中复制整个“库”

3) 将整个“库”粘贴到新的 FLA

4）删除旧文件，这是神奇的毒药

# prolog - 如何关闭 SWI-Prolog 标志？

> ID：10490598
> 
> 赞同：0
> 
> 时间：2012-05-07T23:39:32.873
> 
> 标签：prolog, swi-prolog

我不确定标志是否是合适的术语，但无论如何配置一个 swi-prolog 程序在查询完成时不输出真或假，而是简单地打印出程序中确定的另一条语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:11:46.070

有一种工具可以定制这种行为，但它可能会非常复杂。我自己没有玩过它，但查看手册和 Prolog 引导文件可能会对您有所帮助。

Prolog 有一个“顶层”，它是一段 Prolog 代码，用于控制 Prolog 命令行并执行在其上输入的目标。使用 SWI-Prolog，您可以指定一个替代顶层：

```
pl -t my_quiet_prolog 
```

如果您`my_quiet_prolog/0`在启动时加载的文件中定义，例如在您的`~/.plrc`文件中。

默认顶层称为`prolog/0`. 这个源代码和默认 Prolog 环境的其他部分可以在`/usr/lib/pl-5.6.36/boot`（在我的 Cygwin 系统上；对你来说可能不同）中找到。查看`toplevel.pl`默认的顶层。消息“是”和“否”也在`messages.pl`.

您可以尝试覆盖消息，或者简单地复制顶层并对其进行修改以适合您。

# javascript - Jquery / imagemap组合无法正常工作

> ID：10490599
> 
> 赞同：0
> 
> 时间：2012-05-07T23:39:49.113
> 
> 标签：javascript, jquery, html, imagemap

我正在使用 Jquery 和 html imagemap 的组合来制作带有翻转不同区域的横幅。它的基本功能运行良好，但我在让它更高级时遇到了问题。

这是 jsfiddle [http://jsfiddle.net/2fav4/](http://jsfiddle.net/2fav4/)

发生了什么，悬停工作正常，新图像出现等等。当用户点击图片时，它会一直保持（就像它应该做的那样），问题是点击状态永远不会消失。我希望用户能够通过第二次单击来关闭图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T03:33:57.217

诀窍是使用`.toggleClass()`.

显着简化，我得到：

```
jQuery("#map-container area").mouseover(function() {
    jQuery('.'+$(this).attr('id')+'-map').show();
}).mouseout(function() {
    jQuery('.'+$(this).attr('id')+'-map').not('.selected').hide();
}).click(function(){
    var regionMap = jQuery('.'+$(this).attr('id')+'-map');
    jQuery('#map-container img.region').not(regionMap).removeClass('selected').hide();
    regionMap.toggleClass('selected').not('.selected').hide();
}); 
```

见[小提琴](http://jsfiddle.net/PPg4D/1/)

你会看到我删除了所有与`....list`它无关的东西，至少在我能看到的 HTML 中。如果列表内容很重要，则必须将其重新添加。

# java - 在这种情况下，我应该尝试修复特殊情况还是只捕获 stackoverflow 错误？

> ID：10490600
> 
> 赞同：1
> 
> 时间：2012-05-07T23:39:52.477
> 
> 标签：java, recursion

```
public boolean isConnected(int row, int col) {    //helper Method 
        int i;
        int j;

        if (BOARD[row][col].isEmpty())
            return false;
        for (i = row; i > 0; i--)
            if (hasRed(i, col))
                return true;
            else if (isEmpty(i, col))
                break;
        for (i = row; i < ROWS; i++)
            if (hasRed(i, col))
                return true;
            else if (isEmpty(i, col))
                break;
        for (i = col; i < COLS; i++)
            if (hasRed(row, i))
                return true;
            else if (isEmpty(row, i))
                break;
        for (i = col; i > 0; i--)
            if (hasRed(row, i))
                return true;
            else if (isEmpty(row, i))
                break;
        for (i = row, j = col; i > 0 && j < COLS; i--, j++)
            if (hasRed(i, j))
                return true;
            else if (isEmpty(i, j))
                break;
        for (i = row, j = col; i < ROWS && j > 0; i++, j--)
            if (hasRed(i, j))
                return true;
            else if (isEmpty(i, j))
                break;
        for (i = row, j = col; i > 0 && j > 0; i--, j--)
            if (hasRed(i, j))
                return true;
            else if (isEmpty(i, j))
                break;
        for (i = row, j = col; i < ROWS && j < COLS; i++, j++)
            if (hasRed(i, j))
                return true;
            else if (isEmpty(i, j))
                break;

        return false;

    } 
```

//可能导致异常的主要方法在许多测试用例尝试后的算法总是在有一个真正的解决方案时终止，但可能会或可能不会因错误的解决方案而终止，我猜的原因是递归步骤并没有简化原始问题但实际上扩展了它！为了有机会获得正确的解决方案，问题是在某些肯定应该返回 false 的条件下，算法不能终止，因为它会继续检查以前解决的子问题等等。

```
public boolean isConnected2(int rowCurr, int colCurr) {

            if (rowCurr >= ROWS || rowCurr < 0 || colCurr < 0 || colCurr >= COLS) 
                return false;                  //Base case 1 reached bounds of the 2d array
            if (isEmpty(rowCurr, colCurr))
                return false;
            if (isConnected(rowCurr, colCurr)) // base case 2 current piece is connected according to the method above
                return true;

            else {
                return     isConnected2(rowCurr + 1, colCurr + 1)                                          
                        || isConnected2(rowCurr - 1, colCurr - 1)
                        || isConnected2(rowCurr + 1, colCurr - 1)
                        || isConnected2(rowCurr - 1, colCurr + 1)
                        || isConnected2(rowCurr - 1, colCurr - 1)
                        || isConnected2(rowCurr + 1, colCurr)
                        || isConnected2(rowCurr - 1, colCurr)
                        || isConnected2(rowCurr, colCurr + 1) 
                        || isConnected2(rowCurr, colCurr - 1);
// if any of the above calls returns true we are done

            }

        } 
```

问题是我不确定如何处理导致算法无限递归的特殊情况，而且我确信由于 (||) 运算符的性质，如果存在真正的解决方案，它将终止。那么在这种情况下，仅处理 StackOverFlow 错误并将其视为方法的错误返回不是更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:00:33.013

任何递归函数都可以转换为非递归函数。

例如，使用某种队列。将方法的不同参数推`isConnected2`送到队列中，然后不断地从队列中弹出一组参数，并对它们进行评估。如果该评估导致对该函数的更多调用，则将一组新参数推送到队列中。然后，如果队列太大或经过一定时间后，您可以终止。

这样您就可以使用堆而不是堆栈，并避免堆栈溢出的可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T12:42:31.033

永远不要在程序中留下堆栈溢出。让它发生并抓住它对 JVM 来说是一个巨大的负担。修复您的递归，使其不会发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T11:51:52.983

```
public boolean isConnected2(int row, int col) {
        int i; int j;
        if (OutOfBounds(row, col)) 
            return false;
        if (isEmpty(row, col))
            return false;
        if (isConnected(row, col)) 
            return true;

        else {

            for (i = row; i > 0; i--)
                if(isConnected(i,col))
                    return true;
                else if(isEmpty(i, col))
                    break;

            for (i = row; i < ROWS; i++)
                if(isConnected(i,col))
                    return true;
                else if(isEmpty(i,col))
                    break;
            for (i = col; i < COLS; i++)
                if(isConnected(row,i))
                    return true;
                else if(isEmpty(row,i))
                    break;
            for (i = col; i > 0; i--)
                if(isConnected(row,i))
                    return true;
                else if(isEmpty(row,i))
                    break;
            for (i = row, j = col; i > 0 && j < COLS; i--, j++)
                if(isConnected(i,j))
                    return true;
                else if(isEmpty(i,j))
                    break;
            for (i = row, j = col; i < ROWS && j > 0; i++, j--)
                if(isConnected(i,j))
                    return true;
                else if(isEmpty(i,j))
                    break;
            for (i = row, j = col; i > 0 && j > 0; i--, j--)
                if(isConnected(i,j))
                    return true;
                else if(isEmpty(i,j))
                    break;
            for (i = row, j = col; i < ROWS && j < COLS; i++, j++)
                if(isConnected(i,j))
                    return true;
                else if(isEmpty(i,j))
                    break;

        }
        return false;

    } 
```

这是迭代实现的相同方法 isConnected2 是否类似？现在它只检查 2d 数组中的每个方向一次，而不是在所有方向上重复传播

# binding - NInject 多个命名范围所需的服务

> ID：10490601
> 
> 赞同：3
> 
> 时间：2012-05-07T23:40:03.760
> 
> 标签：binding, ninject, named-scope

我在 Ninject 论坛上发了一个帖子，但没有收到任何答案……想知道是否有人有任何建议？

[http://groups.google.com/group/ninject/browse_thread/thread/9ac79d5541f015cb](http://groups.google.com/group/ninject/browse_thread/thread/9ac79d5541f015cb)

大家好，我在 Windows 服务中有几个不同的工作流，这些工作流共享一些依赖项。我想定义多个范围，然后绑定到该范围。如果我进行多个绑定，每个绑定都有不同的范围，我会得到一个异常，基本上说我有重复的绑定。有这样做的首选方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T17:33:42.020

范围定义生命周期，而不是何时使用哪个绑定。使用条件绑定来判断何时使用哪种类型。例如，为某些父绑定添加名称并使用WhenParentNamed 或WhenAnyAnchestorNamed 来告知应该使用哪个绑定。

如果拥有多个绑定的唯一原因是您有不同的范围名称，那么请考虑使用相同的范围名称。不要求它们不同。例如，如果您有多个控制器，那么它们都可以定义控制器范围。

# java - 将字符串插入已排序的字符串数组列表的最有效方法是什么？

> ID：10490607
> 
> 赞同：5
> 
> 时间：2012-05-07T23:40:35.130
> 
> 标签：java, string, arraylist, add

我有一个包含 17,000 个单词的 ArrayList。仅当单词尚未在列表中时，我才需要将其添加到列表中，并且我需要保留列表的排序顺序。即，我需要将其放入按字母顺序排列的正确位置。

我不知道如何找到正确的插入位置。我正在使用二进制搜索来查找单词是否已经在列表中，如果它在列表中则返回索引，如果不是则返回-1。我打算使用 ArrayList.add(int index, E element) 把它放进去。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T00:13:58.387

将其`ArrayList`转换为`TreeSet` [http://docs.oracle.com/javase/7/docs/api/java/util/TreeSet.html](http://docs.oracle.com/javase/7/docs/api/java/util/TreeSet.html)

`TreeSet`将为您处理重复项，并按字母顺序排列单词。

示例：（`WordList`是`ArrayList`单词的）

```
TreeSet<String> WordSet = new TreeSet<String>(WordList); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T00:02:32.207

使用内置[`binarySearch`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#binarySearch%28java.util.List,%20T%29)方法。如果未找到密钥，则返回的数字为
`-(insertionIndex) - 1`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T23:42:13.603

想到[二进制搜索，虽然列表 api 可能包含更好](http://en.wikipedia.org/wiki/Binary_search_algorithm)

在二分搜索中，您将到达一个点，即您还剩下 2 个项目，一个在上面，一个在下面，其中一个可能 == 到您的项目。对于您的情况，您将没有 == 情况，因此返回较高的索引并插入其位置。不知道java有没有元组类，也可以自己构建一个容器。无论哪种方式，返回类似：

```
(bool, int) binSearch(IList list)
  returns true, -1 if found
  returns false, higher of 2 bounds otherwise 
```

显然这不是java，但转换并不困难

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T23:55:29.037

如果您编写了二进制搜索，则可以对其进行修改以返回最后搜索的值。该值可以是匹配字符串的位置，也可以是应该插入的位置。

那是在二分搜索中，您细分列表，直到您找到字符串或无法进一步细分它。不能再细分列表的那个位置就是应该插入字符串的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-08T00:02:07.273

众所周知，要加快进程，一般的想法是使用更多的内存。在这里，它可以是每个字母的第一个字符串的索引。例如一个额外的 ArrayList，用伪写：

```
ArrayList indexes;
indexes[0] = {"a", 0};
indexes[1] = {"b", 123};
... 
```

对于以“a”开头的字符串，您可以在索引 0-123 之间进行二进制搜索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T00:10:01.483

如您所说，如果没有重复的单词，则可以考虑实施[trie](http://en.wikipedia.org/wiki/Trie)。在 trie 上的插入操作比在哈希表中要快一些，因为没有冲突。搜索也是如此。

此外，在`ArrayList`列表中间插入一个元素，这意味着重新定位一半元素或增加数组大小，这可能有点昂贵。

如果你很好奇，可以在以下页面中看到一个实现：[https ://forums.oracle.com/forums/thread.jspa?messageID=8787521](https://forums.oracle.com/forums/thread.jspa?messageID=8787521)

# python - python中的运算符重载，运算符右侧的对象

> ID：10490610
> 
> 赞同：17
> 
> 时间：2012-05-07T23:40:50.030
> 
> 标签：python, operator-overloading

我最近了解了 python 中的运算符重载，我想知道以下是否可能。

考虑以下假设/人为类。

```
class My_Num(object):
    def __init__(self, val):
        self.val = val
    def __add__(self, other_num):
        if isinstance(other_num, My_Num):
            return self.val + other_num.val
        else:
            return self.val + other_num 
```

我知道上面写的方式，我可以做这样的事情

```
n1 = My_Num(1)
n2 = My_Num(2)
n3 = 3
print n1 + n2
print n1 + n3 
```

这些将按预期工作。我也知道它目前的写法我不能这样做

```
n1 = My_Num(1)
n2 = 2
print 2 + n1 
```

有没有办法解决？我知道这个例子是人为的，但是我有一个应用程序，如果在我进行运算符重载时，我定义运算符的类可以出现在运算符的右侧，它将非常有用。这在python中可能吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-07T23:46:35.530

是的。例如，有[`__radd__`](http://docs.python.org/reference/datamodel.html#object.__radd__). 此外，[没有](http://docs.python.org/reference/datamodel.html#object.__lt__)for `__le__()`、`__ge__()`等，但正如 Joel Cornett 正确观察到的那样，如果您仅定义`__lt__`，则`a > b`调用 的`__lt__`函数`b`，这提供了一种解决方法。

```
>>> class My_Num(object):
...     def __init__(self, val):
...         self.val = val
...     def __radd__(self, other_num):
...         if isinstance(other_num, My_Num):
...             return self.val + other_num.val
...         else:
...             return self.val + other_num
... 
>>> n1 = My_Num(1)
>>> n2 = 3
>>> 
>>> print n2 + n1
4
>>> print n1 + n2
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unsupported operand type(s) for +: 'My_Num' and 'int' 
```

请注意，至少在某些情况下，这样做是合理的：

```
>>> class My_Num(object):
...     def __init__(self, val):
...         self.val = val
...     def __add__(self, other_num):
...         if isinstance(other_num, My_Num):
...             return self.val + other_num.val
...         else:
...             return self.val + other_num
...     __radd__ = __add__ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T23:50:38.840

您必须重载该`__radd__`方法（右侧添加）。您的函数应该看起来与您的方法几乎相同`__add__`，例如：

```
def __radd__(self, other):
     return self.val + other.val 
```

# iphone - TableView中UIImage的自定义子视图

> ID：10490611
> 
> 赞同：0
> 
> 时间：2012-05-07T23:41:05.270
> 
> 标签：iphone, objective-c, ios, uitableview, facebook-graph-api

现在我正在尝试从 Facebook 中提取图像，并将其放在表格视图中。

我不想使用单元格的默认图像视图。因为图像大小可能会有所不同。

如何制作图像视图并将其放入单元格中，然后调整单元格高度以使其与图像高度匹配？

任何帮助都会非常有帮助。

谢谢，维林德博拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:55:30.180

`UITableViewDelegate`您可以在方法中指定行的高度`- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath`。有可能通过使用该方法，您可以使用的内置`imageView`属性`UITableViewCell`

编辑：如果由于某种原因该`imageView`属性不会让你做你想做的事，我会考虑制作一个自定义子类`UITableViewCell`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T00:09:41.447

它对我有用：

***视图控制器.h***

```
#import <UIKit/UIKit.h>
#import "ResizingCell.h"
@interface ViewController : UITableViewController
@property (strong, nonatomic) IBOutlet ResizingCell *Cell;
@end 
```

***视图控制器.m***

```
#import "ViewController.h"
@implementation ViewController
@synthesize Cell;
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 1;
}
- (float)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return [(ResizingCell *)[self tableView:tableView cellForRowAtIndexPath:indexPath] getHeight];
}
- (ResizingCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    ResizingCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell"];
    if (!cell) {
        [[NSBundle mainBundle] loadNibNamed:@"ResizingCell" owner:self options:nil];
        cell = [self Cell];
        [self setCell:nil];
    }
    UIImage *image = [UIImage imageNamed:[NSString stringWithFormat:@"%d.png", [indexPath row]]];
    [cell setImage:image];
    return cell;
}
@end 
```

***调整Cell.h***

```
#define BUFFER 20
#import <UIKit/UIKit.h>
@interface ResizingCell : UITableViewCell
@property (strong, nonatomic) IBOutlet UIImageView *myImageView;
- (void)setImage:(UIImage *)image;
- (float)getHeight;
@end 
```

***调整Cell.m***

```
#import "ResizingCell.h"
@implementation ResizingCell
@synthesize myImageView;
- (void)setImage:(UIImage *)image {
    [[self myImageView] setImage:image];
    // Because the width will be important, I'd recommend setting it here...
    [[self myImageView] setFrame:CGRectMake(currFrame.origin.x, currFrame.origin.y, image.size.width, currFrame.size.height)];
}
- (float)getHeight {
    return (2 * BUFFER) + [[self myImageView] image].size.height;
}
@end 
```

代码应该是不言自明的。当我用一个非常高的图像测试它时，它会适当地改变高度。

# android - 关于 Android 中的警报管理器的问题

> ID：10490612
> 
> 赞同：1
> 
> 时间：2012-05-07T23:41:19.653
> 
> 标签：android, android-widget, alarmmanager

我正在使用`Alarm Manager`通过 with`Service`来更新小部件实例。在这样做的时候，我想错过了一些重要的地方。

这就是我设置的方式`Alarm Manager`：

```
public class MyWidget extends AppWidgetProvider {

    public void onEnabled(Context ctx) {
        alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
        Intent i = new Intent(context, MyService.class);
        pi = PendingIntent.getService(context, 0, i, PendingIntent.FLAG_UPDATE_CURRENT);

        // Repeat value depends on preferences.
        Long repeat = Long.parseLong(prefs.getString("update_preference", "600"));
        alarmManager.setRepeating(AlarmManager.RTC, SystemClock.elapsedRealtime(), 1000*repeat, pi); 
    }

    @Override
    public void onDisabled(Context context) {
        super.onDisabled(context);
        AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
        Intent i = new Intent(context, MyService.class);
        PendingIntent pi = PendingIntent.getService(context, 0, i, PendingIntent.FLAG_UPDATE_CURRENT);
        alarmManager.cancel(pi);
    }

} 
```

让我解释一下：

1.  如果设备接到电话或拨打电话，**Edge/3G**无法正常工作。如何处理来电？如果可以，是否可以在通话后重新启动/触发警报管理器？或任何其他建议表示赞赏。
2.  当设备**休眠**（几分钟）后，即使超过**间隔值，解锁警报管理器也会立即工作。**但是，如果睡眠需要很长时间，则在解锁警报管理器和小部件接收器后无法正常工作。每次重复都睡着的方法是什么。
3.  如何控制**重启进度**？我的意思是在重新启动服务后应该启动小部件更新。不知道开始的方式。

任何帮助或建议都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:57:31.700

你的一些问题不是很清楚，所以我会尽力回答我的理解：

1.  [您可以为TelephonyManager.ACTION_PHONE_STATE_CHANGED](http://developer.android.com/reference/android/telephony/TelephonyManager.html#ACTION_PHONE_STATE_CHANGED)注册广播接收器
2.  将您的呼叫更改`setRepeating`为使用`AlarmManager.RTC_WAKEUP`而不是`AlarmManager.RTC`. [在这里](http://developer.android.com/reference/android/app/AlarmManager.html#RTC_WAKEUP)阅读更多
3.  您可以为 注册广播接收器`Intent.ACTION_BOOT_COMPLETED`。这必须在您的应用清单上注册为接收器。[在这里](http://developer.android.com/reference/android/content/Intent.html#ACTION_BOOT_COMPLETED)阅读更多。

# c - 使用哪种 C 变量类型

> ID：10490616
> 
> 赞同：-2
> 
> 时间：2012-05-07T23:41:42.490
> 
> 标签：c, types

我有与 SS 号码形式相同的帐号，例如 123-12-1234 应该使用哪种 C 变量类型来存储这些？原始类型可以保存这样的“数字”吗？一个简短的解释也会很棒！谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T23:46:31.110

你想用这些数字做什么？如果要显示它们，您可能希望将它们存储为字符串。如果每个部分都有意义并且您将比较它们，您可能希望将其存储为 3 个整数。如果要进行大量比较或排序，您可能希望将其存储为 1 int 并在显示时处理格式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T23:45:18.667

如果帐号具有固定数量的字符，则固定的字符数组`char[11]`可能是合适的；否则请使用传统的以空字符结尾的字符数组（又名“C 字符串”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:48:22.073

如果您仔细考虑一下，您会发现 char* / [long] int 将满足您的需求。取决于你的需要

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T03:05:09.517

我认为将它用作 char * 会更好。这样做，您还可以实现 2 级散列来搜索帐号。

# windows - Windows PATH - 为什么要永久扩展变量

> ID：10490619
> 
> 赞同：1
> 
> 时间：2012-05-07T23:42:00.397
> 
> 标签：windows, path, expand

我对 PATH 语句或 DOS 并不陌生，我知道变量替换是如何工作的。我只有一台计算机遇到意外行为。所有人都在使用 Windows 7 x64 或 Windows 2008 x64 Server R2。

在所有系统上，PATH 都包含其他环境变量。这按我的预期工作。但是，在一个 Windows 7 Enterprise 上，PATH 语句被更改为永久扩展变量。这是一个示例，来自：

这适用于所有系统，除了一个：

> 系统变量
> 
> ```
> ANT_HOME=C:\dev\ant
> JAVA_HOME=C:\dev\java
> MAVEN_HOME=C:\dev\maven
> PATH=[standard Windows paths go here];%JAVA_HOME%\bin;%ANT_HOME%\bin;%MAVEN_HOME%\bin 
> ```

一个系统，当我在“环境变量”窗口中更改 PATH 变量时，它最终会更改为完全扩展的值。我不是指在 DOS 提示符下运行时，我指的是 Windows 中更改这些设置的位置。

我一直无法弄清楚是什么导致了这种变化。这使得将 XXX_HOME 值之一轻松切换到不同版本并期望 PATH 接收更新变得不可能。如果这是 Windows 一直以来的工作方式，我会理解，但为什么只在一个系统上呢？

有什么想法或导致这种情况的原因吗？有没有其他人经历过这个？

# iphone - 如何为旧设备加载不同的视图控制器？

> ID：10490621
> 
> 赞同：0
> 
> 时间：2012-05-07T23:42:23.890
> 
> 标签：iphone, objective-c

我的应用程序的新版本依赖于 iOS 5.0+。但是，我的旧版本允许 iOS 4。如果我没记错的话，如果它删除了对某些用户的支持，Apple 将拒绝该应用程序。我试图让不在 iOS 5.0+ 上的设备加载另一个名为`oldVersion`. 这是我尝试过的：

```
float version = [[[UIDevice currentDevice] systemVersion] floatValue];
if (version < 5.0) {
    UIViewController *olderVersion = [[[ViewController alloc] initWithNibName:@"oldVersion" bundle:nil] autorelease];
    self.window.rootViewController = olderVersion;
    [self.window makeKeyAndVisible];
} else {
    //Load normally.
} 
```

（这是在应用程序委托的`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`）

* * *

我也试过加载我的新版本和

```
float version = [[[UIDevice currentDevice] systemVersion] floatValue];
if (version < 5.0) {
    oldVersion *screen = [[oldVersion alloc] initWithNibName:nil bundle:nil];
    [self presentModalViewController:screen animated:NO];
    [screen release];
    return;
} else {
    //Normal stuff...
} 
```

在我的`viewDidLoad`. 它们都不能正常工作。第一个（在应用程序委托中）加载屏幕但不加载代码中的任何内容（如 NSLog() 和 UIAlertView 的）。第二个（viewDidLoad）不显示屏幕，它只是加载我的新版本，没有我在代码中进行的任何自定义。

那么，我如何将不在 iOS 5.0+ 上的设备发送到`oldVersion`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:45:31.007

在viewDidLoad中，检查版本并记录到nsuserdefaults，这样就不用每次都检查了。然后加载新视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T00:04:51.860

您可能会检查对象是否实现了仅在较新版本的操作系统上可用的方法。这是检查当前运行时环境的常用方法。例如：

```
if ( [[UIApplication sharedApplication] respondsToSelector(userInterfaceLayoutDirection)] ) {
    // userInterfaceLayoutDirection is only available in iOS 5+
    // use 5.0+ version of xib
} 
```

我相信您还可以检查常量的地址是否不为零，并从中派生操作系统版本：

```
if ( &UIApplicationLaunchOptionsNewsstandDownloadsKey != nil ) {
    // UIApplicationLaunchOptionsNewsstandDownloadsKey is only available in iOS 5+
    // use 5.0+ version of xib
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:15:30.070

我解决了！显然，我所要做的就是在显示新的 XIB 之前稍等一下（我使用的是 0.1）。所以现在是：

```
[self performSelector:@selector(usersOnOldVersionsOfiOSReallyNeedToUpgradeToiOS5OrHigherToUseThisVeryCoolApp) withObject:nil afterDelay:0.1]; 
```

在哪里`usersOnOldVersionsOfiOSReallyNeedToUpgradeToiOS5OrHigherToUseThisVeryCoolApp`为 > iOS 5 打开 XIB。

# actionscript-3 - 如何避免我的 swf 被缓存？

> ID：10490629
> 
> 赞同：0
> 
> 时间：2012-05-07T23:43:27.753
> 
> 标签：actionscript-3, caching, flash

如何避免我的 swf 被缓存在内存中？，我读到我必须使用这样的东西：

```
<META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE"> 
```

就这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T08:29:49.253

我使用 get param 来避免缓存，例如 myswf.swf?date 或 myswf.swf?random

我正在使用 swfobject 将 swf 加载到 html 页面。这里给你一个例子。

"myContent.swf?"+Math.random()*321 -> 这使得 swf 没有缓存。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>SWFObject dynamic embed - step 3</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <script type="text/javascript" src="swfobject.js"></script>

    <script type="text/javascript">
    swfobject.embedSWF("myContent.swf?"+Math.random()*321, "myContent", "300", "120", "9.0.0");
    </script>

  </head>
  <body>
    <div id="myContent">
      <p>Alternative content</p>
    </div>
  </body>
</html> 
```

[SWFOBJECT 链接](http://code.google.com/p/swfobject/wiki/documentation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:50:39.090

您还可以将 expires 标头与已经过去的日期一起使用：

```
<!-- BEGIN INSERT --> 
<META HTTP-EQUIV="Expires" CONTENT="Mon, 04 Dec 1999 21:29:02 GMT">
<!-- END INSERT --> 
```

但是，是的，仅此而已！

# python - 用于 Perforce 文件规范通配符的 Python glob

> ID：10490635
> 
> 赞同：1
> 
> 时间：2012-05-07T23:44:17.583
> 
> 标签：python, perforce

我需要扩展包含 Perforce 通配符的文件规范。我需要这个用于磁盘上的本地文件（不在 Perforce 仓库中）。

也就是说，我需要标准 Python 之类的东西`glob.glob()`，它也能理解 Perforce 通配符“...”。例如：

```
>>> from p4glob import p4glob        # The module I wish I had
>>> p4glob('....xml')
['a.xml', 'dir/b.xml', 'x/y/z/c.xml'] 
```

有人有可以做到这一点的模块吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:09:21.683

只需使用[`os.walk`](http://docs.python.org/library/os.html#os.walk)并过滤它。

```
import os

def p4glob(ext, startdir='.'):
    for root, dirs, files in os.walk(startdir):
        for f in files:
            # whatever filter params you need. e.g:
            if f.endswith(ext):
                yield os.path.join(root, f)
                # or append to an output list if you dont want a generator

# usage
[i for i in p4glob(".xml")] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T15:01:40.280

此外，如果您拥有最新版本的 Perforce，您可以使用 P4Python 等效的`p4 status ....xml`.

# c++ - 将字符串中的字符与给定字符进行比较

> ID：10490636
> 
> 赞同：9
> 
> 时间：2012-05-07T23:44:17.757
> 
> 标签：c++, c, string, strcmp

我有以下内容：

```
int findPar(char* str)
{
int counter=0;

while (*str) 
{
    if(str[0] == "(") <---- Warning
    {
        counter++;
    }
    else if (str[0]== ")") <---- Warning
    {
        counter--;
    }
    if (counter<0) 
    {
        return 0;
    }
    str++;
}

if (counter!=0) 
{
    return 0;
}
return 1;
} 
```

我得到的警告是 int 和 char 之间的比较。

我也尝试使用 strcmp 进行比较（字符串中的第一个字符与给定的字符），如下所示：

```
 if (strcmp(str, ")")==0) { stuff } 
```

但即使比较（应该）是正确的，它也永远不会进入“东西”。

我该怎么做？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-07T23:47:41.293

如果`str`是 C 字符串（以空字符结尾的字符数组），那么`str[0]`是字符。

请注意，引号的类型很重要！`')'`是一个字符，`")"`而是一个字符串（即一个`')'`字符后跟一个空终止符）。

因此，您可以比较两个字符：

```
str[0] == ')' 
```

或者你可以比较两个字符串

```
strcmp(str, ")") == 0 
```

自然，（如果`str`字符串真的只包含该括号，则第二个有效）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-07T23:46:41.303

您正在将字符 ( `str[0]`) 与`const char[N]`( `"whatever"`) 进行比较。您需要使用单引号，因为双引号表示字符数组，而单引号表示单个字符：

```
if (str[0] == ')') // or *str == ')' 
```

等等。

失败的原因`strcmp`也是因为，虽然字符串在某些时候确实指向`)`，但它有更多的字符（即不紧跟 a `'\0'`），所以字符串不等于`")"`只有一个字符的字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T23:46:37.720

双引号`"`是字符串分隔符，`")"`指向字符串文字的指针也是如此`if(str[0] == "(")`。你想比较一个字符，所以你必须使用单引号

```
if(str[0] == '(') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T23:46:48.760

您需要`if (str[0] == ')')`等。注意单引号（撇号）表示字符文字。

# css - 为什么我不能用 display: block 和 width: X 右对齐元素？

> ID：10490639
> 
> 赞同：14
> 
> 时间：2012-05-07T23:45:17.487
> 
> 标签：css, layout, text-alignment

这里的总 n00b 问题（至少对于 CSS 精英）：

为什么同时`display: block;`具有值​​和值的元素`width`似乎不符合`text-align`其父项的属性？也就是说，它似乎总是坚持向左走。

[这是一个说明问题的jsFiddle。](http://jsfiddle.net/Z6Twf/)

显然，这必须与 CSS 规范一致（我的意思是，如果 Chrome、Firefox 和 Opera 都同意，我几乎没有疑问）；我只是不明白。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-07T23:50:02.353

文本在 150 像素的框内对齐。那是对的。块元素不会与父元素中的 text-align 对齐。

要解决此问题，您需要在 .width div 上使用`display: inline-block`或使用。`float: right`

编辑：使用浮动，添加`clear: right`以避免它与前一个 div 在同一行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:58:08.963

`<span>`是一个带有 的元素`display: inline`。`display: inline`跟随文本对齐的元素。`display: block`不遵循文本对齐方式的元素由浮动对齐 OWNED。

当您仅更改元素的宽度时，仍会按照文本的对齐方式保持内联，但是当您将显示更改为阻塞并更改其宽度时，其内容会采用文本的对齐方式，但元素不会。我试图用你的代码中的一些颜色来说明这一点；）

[http://jsfiddle.net/Z6Twf/3/](http://jsfiddle.net/Z6Twf/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:49:22.600

这是因为您的课程是块宽度而不是宽度。重命名类 block_width ，然后在你的css中制作最后一个 .block_width 而不是你拥有的 .width 并且它可以工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-23T09:17:37.740

替代方式

```
<div style="text-align:right; margin:0px auto 0px auto;">
<p> Hello </p>
</div>
  <div style="">
<p> Hello </p>
</div> 
```

# iphone - 你能得到一个 iphone 应用程序来读取像 Excel 电子表格这样的文件吗？

> ID：10490648
> 
> 赞同：-1
> 
> 时间：2012-05-07T23:46:09.377
> 
> 标签：iphone, objective-c, ios

所以我正在制作一个我想填充一个巨大数组的应用程序，我希望我的数组中的信息是对象，以及来自我的文件的信息。因此，如果有一种读取/写入文件的方法，不必是 excel 文件，我将如何去做，或者 NSCoding 是唯一的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:56:02.720

您可以读/写文件。查看[NSFileManager](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html)。没有理由不能从 excel 文件中读取，但为了效率和简单性，如果从 CSV 或 JSON 文件中读取会更好。

# assembly - 为什么 gnu 链接器的 `--oformat binary' 选项将 `.data' 段放置在 0x0200000

> ID：10490658
> 
> 赞同：4
> 
> 时间：2012-05-07T23:47:07.127
> 
> 标签：assembly, ld, att

我一直在为 i386 实模式编写一些“独立”代码，并在 PXE 网络引导我的代码时遇到了一些奇怪的错误：

```
PXE-E79: NBP is too big to fit in free base memory
PXE-M0F: Exiting Intel Boot Agent. 
```

在摆弄了我的二进制文件之后，我将其隔离**为**在

```
.data 
```

段标记。

在 hexdumping 之后，我发现 ld 将指令一直移动到`0x0200000`所有地方。

我目前正在生成我的平板箱：

```
ld --oformat binary 
```

* * *

*问题：*

1.  为什么这样`ld`做？

2.  这是特定于`oformat`选项吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T04:34:28.993

1）链接器这样做可能是因为它感觉像它（例如，可能是为了与 80x86 上的“2 MiB 页面”对齐），并且因为您没有提供一个链接器脚本来说明除了“无论链接器感觉如何”。

2）我假设所有输出格式“无论链接器感觉如何”（除非链接器另有说明）。

*注意：实际行为可能由隐藏在某处的默认链接器脚本确定，并且可能是“无论操作系统的发行版感觉如何”，而不仅仅是“链接器感觉如何”。*

在任何情况下，如果您希望链接器执行特定的操作，您需要通过编写链接描述文件具体告诉链接器您想要什么。如果您实际上已经编写了一个“不太具体”的链接器脚本，那么您需要使该脚本更具体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T07:19:06.873

1-ld 使用默认的链接描述文件。尝试 -v 查看您的默认值 2-不是特定于 oformat 3-要设置其他大小，您必须使用 -z max-page-size=0x

我尝试使用 0x100 和 0x1000 并且工作正常，但 0x500 没有。

Salu2 总计

# button - 缩进按钮效果 CSS

> ID：10490659
> 
> 赞同：1
> 
> 时间：2012-05-07T23:47:18.487
> 
> 标签：button, css

我正在尝试创建一个类似于 DuckDuckGo 的“更多”按钮的缩进按钮。

![在此处输入图像描述](../Images/1e20119ad8fdbaf7f8a257c9f329b43c.png)

左边的图片是 DuckDuck 的，右边是我的。最底部的阴影是我要重新创建的。放大它们看起来像： ![在此处输入图像描述](../Images/2a639bb77fe36b23be2c0130e086ffbf.png)

现在，我使用了他们的背景标题图像和按钮背景（不是小提琴的一部分）。这个小提琴是到目前为止的代码。使用 IE9 开发工具，我关闭了 DuckDuck 中所有其他不相关的样式等。据我所知，在我的一生中，我无法看到它们是如何实现阴影效果的......

jsfiddle：http: [//jsfiddle.net/25Hhu/](http://jsfiddle.net/25Hhu/)

# php - Symfony2 子域路由 - 不同的捆绑包

> ID：10490660
> 
> 赞同：8
> 
> 时间：2012-05-07T23:47:28.363
> 
> 标签：php, symfony

**编辑** 现在可以在 symfony 2.2 中执行此操作

```
PlatformFooBundle:
    resource: "@PlatformFooBundle/Resources/config/routing.php"
    domain: foo.testdomain.com

PlatformBarBundle:
    resource: "@PlatformBarBundle/Resources/config/routing.php"
    domain: bar.testdomain.com

PlatformBazBundle:
    resource: "@PlatformBazBundle/Resources/config/routing.php"
    domain: baz.testdomain.com 
```

您也可以在域中使用参数

**编辑**

在将此标记为重复之前，请继续阅读

[http://www.craftitonline.com/2011/08/symfony2-locale-on-subdomains-not-on-the-url-path/](http://www.craftitonline.com/2011/08/symfony2-locale-on-subdomains-not-on-the-url-path/)

我读过这篇文章，但它并不能帮助我做我想做的事情。

我有 3 个不同的应用程序在同一个域名上运行，具有单独的子域。目前，他们都在他们自己的 symfony 安装中运行，我想摆脱它。

```
foo.testdomain.com
bar.testdomain.com
baz.testdomain.com 
```

每个都使用不同的捆绑包

```
PlatformFooBundle
PlatformBarBundle
PlatformBazBundle 
```

他们每个人都有自己的路线定义。

基本上，我想要的是这个

```
PlatformFooBundle:
    resource: "@PlatformFooBundle/Resources/config/routing.php"
    subdomain: www|devwww

PlatformBarBundle:
    resource: "@PlatformBarBundle/Resources/config/routing.php"
    subdomain: bar|devbar

PlatformBazBundle:
    resource: "@PlatformBazBundle/Resources/config/routing.php"
    subdomain: baz|devbaz 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T05:19:43.043

正在进行[讨论](https://github.com/symfony/symfony/pull/3378)以添加此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T12:23:50.673

看看[ExperiumDomainedRoutingBundle](https://github.com/experium/ExperiumDomainedRoutingBundle)，它对我来说效果很好。我没有添加 Bundle-wide 域路由（仅每个控制器使用注释），但我希望它也能工作。

例子：

```
/**
 * @Route("/", name="frontend_show", options = {"domain_pattern"="{username}.%base_domain%"})
 * @Route("/u/{username}", name="private_show")
 * @Template("SiteBundle:Frontend:show.html.twig")
 */ 
```

# objective-c - 检查 NSString 对象中的数字是否相等？

> ID：10490669
> 
> 赞同：0
> 
> 时间：2012-05-07T23:48:29.020
> 
> 标签：objective-c

我正在从 json 提要中解析价格，但如果价格等于，我想显示另一个按钮`0`

所以我得到了类似的东西

```
NSString *const Small = [NSString stringWithFormat:  @"%i", [PriceFree intValue]]; 
```

注意：`PRICEFREE = 0` .

```
 if ([StoreParse objectForKey:@"price"]) {
    //display button to pay   

    } else if ([StoreParse objectForKey:@"price"] == Small) {

   //display button = free
    } else {
    } 
```

但它只显示“支付”按钮，如果价格为`0`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:05:23.277

您的错误是使用 比较字符串引用`==`，因此您正在比较两个变量是否引用*同一个对象*，而不是它们是否引用包含相同字符的字符串；做后者使用的`NSString`方法`isEqualToString`。

但是，您最好比较整数值，即：

首先更改 的定义`Small`：

```
int Small = [PriceFree intValue]; 
```

然后将您的比较更改为：

```
[[StoreParse objectForKey:@"price"] intValue] == Small) 
```

这具有基于字符串表示的*数值而不是它们包含的**字符*进行比较的优点，例如`@"00"`将比较等于，`@"0"`因为两者都具有 value `0`。

**在成本为 0.99 美元（99 美分）的附属问题后跟进**

如果您的价格以美元和美分作为浮点数，那么您可以：

(a) 需要更改`int`& `intValue`to`float`及`floatValue`以上；

(b) 使用，例如，将值转换为美分`int Small = (int)([PriceFree floatValue] * 100)`；或者

(c) 使用十进制数。

(a) 有一个*缺点*是你最终测试浮点值是否相等，这不是一个好主意；(b) 避免这种情况并且很容易；而（c）也避免了这种情况，但涉及更多。真正的财务计算不使用浮点数来避免舍入错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T23:52:38.367

您正在做的比较是针对指针值，而不是实际字符串，请尝试使用：

```
} else if ([[StoreParse objectForKey:@"price"] isEqualToString:Small]) { 
```

比较实际的字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T02:06:58.570

您正在做的是昵称的*字符串类型（**强类型*的文字游戏）。字符串类型是指将每种类型转换为字符串并使用字符串方法来比较或操作数据。

字符串对象用于文本，并且仅用于文本。如果要比较数字，请确保您使用的是数字类型。

我认为它`StoreParse`是一个字典，包含一个`price`映射到`NSNumber`或`NSDecimalNumber`表示项目价格的键。如果`price`也是一个字符串，那么您需要修改您的应用程序，以便`StoreParse`包含`price`键的数字类型。

If `price`is an `NSNumber`or `NSDecimalNumber`then 你可以通过以下方式判断某物是否免费：

```
if ([[StoreParse objectForKey:@"price"] intValue] == 0)
{
    // price is 0
} 
```

## 小费：

如果您正在处理货币，请使用`NSDecimalNumber`能够*准确*表示十进制数字的。这很有用，因为大多数货币都是十进制的。二进制浮点类型（例如`float`和`double`）无法准确表示所有十进制数，在处理货币时，尽可能保持准确性很重要。

# ios - iOS 关闭之前的 ViewController

> ID：10490673
> 
> 赞同：1
> 
> 时间：2012-05-07T23:49:31.040
> 
> 标签：ios, xcode, view, uiviewcontroller, dismiss

我正在使用以下代码展示一个新的 ViewController

```
UIStoryboard *storyboard = self.storyboard;
finishViewController *finished = [storyboard instantiateViewControllerWithIdentifier:@"finishViewController"];
[self presentViewController:finished animated:YES completion:nil]; 
```

当完成视图控制器时，前一个视图（上面代码打开的那个）仍在后台处理。有什么办法可以杀死它吗？

# c++ - boost::bool_testable<> 是否被重新定位或移除？

> ID：10490675
> 
> 赞同：2
> 
> 时间：2012-05-07T23:50:01.343
> 
> 标签：c++, boost, safe-bool-idiom

我正在尝试利用`boost::bool_testable<>`（来自 Boost.Operators）为一个类实现安全的 bool 习惯用法，但该库的最新版本（截至本文为 1.49）似乎不再具有它。

它去哪儿了？现在有没有更好的替代品，而我只是错过了它？

我不能使用 C++11，因此不能使用不需要安全布尔的语言扩展。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T00:07:12.637

这是一个迟到的答案，但我只在 Stack Overflow 上活跃了很短的时间，我刚刚找到了你的问题。我是 Boost.Operators 的维护者，我在 2003 年 12 月在它意外发布之前将其[删除。](http://permalink.gmane.org/gmane.comp.lib.boost.devel/94644) `bool_testable`

Sam Partington 几周前提出了它，我将它添加到 CVS 存储库中。一开始看起来很有希望，但很快就在某些场景中出现了问题。

IIRC派生类的*主要*问题与转换检测有关。可转换为，但不能转换为 的类应该 yield ，但相反，它变得模棱两可，最终导致编译失败。`T``boost::bool_testable<T>``bool``int``boost::is_convertible<T,int>::value == false`

还有其他问题，解决其中一个问题通常意味着破坏另一个问题。一个示例涉及用户想要显式转换到的类型`bool` *和*他自己的`operator int()`.

所以，长话短说，我们从来没有想出如何让它足够健壮。如有疑问，与潜在问题相比，好处太小了（安全的 ~ 5 行复制粘贴代码），我决定安全行事，因此我将其删除。

在它被删除之后，这个问题就再也没有出现过，人们最终开始将 Safe-Bool-Idiom 代码复制粘贴到他们的类中，或者（一段时间后）他们开始使用`explicit operator bool()`它。

也就是说，最好手动复制这些行。我知道这不是一个优雅的解决方案，我也不喜欢复制粘贴，但替代方案都比这更糟糕。

# php - `if (isset($_SESSION))` 和 `if ($_SESSION)` 之间的区别？

> ID：10490678
> 
> 赞同：7
> 
> 时间：2012-05-07T23:50:10.200
> 
> 标签：php, if-statement, isset

我注意到人们经常简单地写

```
<?php  if($_SESSION['username']) {...} ?> 
```

虽然我一直在使用：

```
 <?php if(isset($_SESSION['username'])) {...} ?> 
```

有人可以在检查是否设置变量时解释差异（这就是我使用它的目的）吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-07T23:51:33.803

在 PHP 中，如果一个变量不存在（“未设置”），那么 PHP 将吐出一个`E_NOTICE`错误，创建缺少的变量，并将其分配给`NULL`.

如果您不希望您的脚本充满恼人的错误消息，这些错误消息会泄漏有关您的服务器和脚本的信息 - 然后`isset()`在尝试访问值之前使用测试。

基本上，您是在要求 PHP`username`退出，`$_SESSION`而 PHP 就像*是“没有`username`*”！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-08T00:17:19.920

根据 PHP.net，isset() 执行以下操作：

> 确定变量是否已设置且不为 NULL。

写作时：

```
<?php  if($_SESSION['username']) {...} ?> 
```

您正在检查 $_SESSION['username'] 是否等于 true。换句话说，您正在检查该值是否不等于 false。

根据[PHP.net](http://php.net/manual/en/language.types.boolean.php)，以下内容被视为 FALSE：

> 转换为布尔值时，以下值被视为 FALSE：

```
the boolean FALSE itself
the integer 0 (zero)
the float 0.0 (zero)
the empty string, and the string "0"
an array with zero elements
an object with zero member variables (PHP 4 only)
the special type NULL (including unset variables)
SimpleXML objects created from empty tags 
```

如您所见，未设置的变量/ NULL 变量被视为 FALSE。因此，通过测试 $_SESSION 元素是否为真，您还可以确定它是否存在。

另一方面，Isset 实际上检查变量是否存在。如果您想知道该名称是否存在 SESSION 变量，请使用 isset() 测试它的 TRUE/FALSE 不依赖于变量是否存在。

此外，请查看以下示例：

```
$_SESSION['a'] = FALSE;
if($_SESSION['a']){
echo 'Hello'; //This line is NOT echo'd.
}

if(isset($_SESSION['b'])){
echo 'Hello'; //This line is NOT echo'd because $_SESSION['b'] has not been set.
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T00:05:17.503

假设您将变量 = 设置为 false ...

```
$variable = false; 
```

这不会返回任何内容，因为它确保变量不为 null、false 或 empty('')...

```
if($variable){
    echo'something';
} 
```

无论我们将变量设置为什么，只要我们设置它，这将起作用……它可以是 false、str、int，除了 null 之外的任何值！

```
if(isset($variable)){
    echo'something';
} 
```

# node.js - 我应该使用 gevent-socketio 还是编写本机 sockit.io 代码？

> ID：10490682
> 
> 赞同：0
> 
> 时间：2012-05-07T23:50:33.337
> 
> 标签：node.js, socket.io, gevent

用 gevent-socketio 代替原生的 Socket.io/Node.js 代码好不好？您对此有何看法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:02:22.877

这实际上取决于您要创建的内容以及您习惯使用的工具和语言。

我可以告诉你，Node.js 和 Socket.IO 是一个非常强大的组合，易于学习且非常高效。但是，如果您对 Gevent 更有经验，并且时间优先，请坚持您所知道的。

该线程显示了 Gevent 和 Node 服务器之间的基本比较： [http ://groups.google.com/group/gevent/browse_thread/thread/a1d48014d8fd310f?pli=1](http://groups.google.com/group/gevent/browse_thread/thread/a1d48014d8fd310f?pli=1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T05:56:01.373

您是否考虑过使用 Tornado/TornadIO2？它们维护良好、稳定且运行良好。我首先尝试使用基于 gevent 的实现并遇到各种问题（与 Django 一起使用时），但使用 TornadIO2 取得了更大的成功，并强烈推荐它们。

# algorithm - 如何确定点组

> ID：10490691
> 
> 赞同：1
> 
> 时间：2012-05-07T23:51:42.970
> 
> 标签：algorithm, grouping, aggregation, points

假设我有一个带点的坐标系。人类可以确定它们被排列成聚合。有没有可以将这些点分组的算法？这是一个说明性示例：

![分组点](../Images/4612936079b84f711ceecf6e0a8dd5c6.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:07:43.103

这是被称为[聚类](http://en.wikipedia.org/wiki/Data_clustering)的一类非常普遍的问题的一部分。鉴于对这个主题进行了大量研究，我怀疑在不了解更多问题的情况下，一个单一的答案就足够了。

我建议你开始看一些基本的，比如[k-means clustering](http://en.wikipedia.org/wiki/K-means_algorithm)。

如果可以使用库，[SVM](http://en.wikipedia.org/wiki/Support_vector_machine)也是一个很好的选择。

# php - php AJAX 服务器

> ID：10490692
> 
> 赞同：0
> 
> 时间：2012-05-07T23:51:50.917
> 
> 标签：php, javascript, ajax

我将输入发送到 php 服务器，服务器将输出返回到客户端。似乎输入不会发送到服务器，并且我在实现高亮功能的逻辑上遇到了一些问题。

客户端键入输入并发送到服务器

```
 <html>
  <head>
  <script type="text/javascript">
  function showUser(str)
  {
  if (str=="")
  {
     document.getElementById("txtHint").innerHTML="";
     return;
   } 
  if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
  }
  else
 {// code for IE6, IE5
   xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
 }
  xmlhttp.onreadystatechange=function()
 {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
  {
   document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
  }
}
   xmlhttp.open("GET","test_server.php?q="+str,true);
   xmlhttp.send();
}
</script>
</head>
<body>

<form>
    Input: <input type="text" name="user" />
   <input type="submit" value="Submit" />
 </form>
<br />
<div id="txtHint"><b>The result will be listed here.</b></div>

</body>
</html> 
```

服务器获取输入以及句子中是否有名称或数字。它突出显示这些条件并返回给客户。

```
 <?php
 $q=$_GET["q"];
 $name=array("jake","jill");
 $number=array("one","two","three","four","five");
 $sentence= split(" ", $q);
 echo "<table border='1'>
 <tr>
 <th>insert</th>
 <th>tagged</th>

 </tr>";
 echo "<tr>";
 echo "<td>" . $q . "</td>";
 echo "<td>" "</td>";
 echo "</tr>";

 echo "</table>";

 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:04:06.617

试试这个，在这里工作得很好：

```
 <html>
  <head>
  <script type="text/javascript">
window.onload = function(){
  function showUser(str)
  {
  if (str=="")
  {
     document.getElementById("txtHint").innerHTML="";
     return;
   } 
  if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
  }
  else
 {// code for IE6, IE5
   xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
 }
  xmlhttp.onreadystatechange=function()
 {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
  {
   document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
  }
}
   xmlhttp.open("GET","test_server.php?q="+str,true);
   xmlhttp.send();
   return false;
}
document.getElementById('form').onsubmit = function(){
    showUser(document.getElementById('user').value);
    return false;
}
}
</script>
</head>
<body>

<form id="form">
    Input: <input type="text" id="user" name="user" />
   <input type="submit" value="Submit" />
 </form>
<br />
<div id="txtHint"><b>The result will be listed here.</b></div>

</body>
</html> 
```

# asp.net-web-api - 为 ApiController 之外的 asp.net web api 中的资源生成 url

> ID：10490693
> 
> 赞同：10
> 
> 时间：2012-05-07T23:51:55.263
> 
> 标签：asp.net-web-api

寻找一种在 asp.net web api 中为特定资源构造或生成 url 的方法。它可以在控制器中完成，因为它继承自 ApiController，因此您获得了 UrlHelper。

我希望从 ApiController 的上下文中构造资源 url。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-23T08:49:49.457

这是我所做的：

*   需要 HttpContext/Request，因此在 Application_Start 中可能不起作用。
*   仅在 WebApi 1 中测试
*   仅适用于在 GlobalConfiguration 中注册的路由（但如果您有其他路由，只需将其传入即可）

```
// given HttpContext context, e.g. HttpContext.Current
var request = new HttpRequestMessage(HttpMethod.Get, context.Request.Url) {
    Properties = {
        { HttpPropertyKeys.HttpConfigurationKey, GlobalConfiguration.Configuration },
        { HttpPropertyKeys.HttpRouteDataKey, new HttpRouteData(new HttpRoute()) },
        { "MS_HttpContext", new HttpContextWrapper(context) }
    }
};

var urlHelper = new UrlHelper(request); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T13:19:40.940

UrlHelper 类呢：

```
System.Web.Http.Routing.UrlHelper;
System.Web.Mvc.UrlHelper 
```

MVC 有一些有用的静态方法来接受路由信息，或者它可以用作通过传入 RequestContext（在大多数 MVC 过滤器和其他各种地方都可用）创建的实例。实例方法应该正是您生成 url 所需要的。

HTTP 接受一个 ControllerContext（在大多数 HTTP 过滤器和其他各种地方也可用）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-08T00:02:23.200

我不确定 ApiController，因为我以前没有使用过它。这对您来说可能是多余的，但话又说回来，它可能不是。查看您的 Global.asax.cs 文件，特别是 RegisterRoutes 函数。最初，您应该看到以下映射：

```
 routes.MapRoute ("Default", "{controller}/{action}/{id}", new { controller = "MyController", action = "Index", id = "" }); 
```

因此，默认情况下，您的应用程序设置为处理以下格式的路由：

```
 {ControllerName}/{ActionName}/{ResourceId} 
```

如下设置的控制器类应该使您能够接收该格式的请求。

```
 class {ControllerName}Controller : ApiController
 {
      public ActionResult {ActionName} (string id)
      {
           // fetch your resource by its unique identifier
      }
 } 
```

# ios - 在 UIWebView 中使用自定义字体

> ID：10490696
> 
> 赞同：60
> 
> 时间：2012-05-07T23:52:14.517
> 
> 标签：ios, uiwebview, fonts, truetype

我想在 UIWebView 中显示自定义字体。我已经将字体放在“应用程序提供的字体”下的 plist 中。使用的代码：

```
 UIWebView *webView = [[UIWebView alloc] initWithFrame:myRect];
        NSURL *baseURL = [NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]];
        [webView loadHTMLString:html baseURL:baseURL];
        [self addSubview:webView]; 
```

其中 html 是一个具有以下内容的 NSString：

```
<html><head>
<style type="text/css">
@font-face {
    font-family: gotham_symbol;
    src: local('GOTHAMboldSymbol_0.tff'), format('truetype') 
} 
body { 
 font-family: gotham_symbol;
font-size: 50pt;
}
</style>
</head><body leftmargin="0" topmargin="0">
This is <i>italic</i> and this is <b>bold</b> and this is some unicode: &#1101;
</body></html> 
```

我使用的是 iOS 4.2，所以应该支持 TTF。我会很感激一些实际有效的 html/代码。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-10-02T19:42:13.537

经过一些尝试和错误后，我找到了一种使用本地 CSS 加载自定义字体的可靠方法。

1.将您的字体添加到应用程序...确保文件正确定位到应用程序

![在此处输入图像描述](../Images/0243fa30a337fe1a9c9852699ef781d4.png) ![在此处输入图像描述](../Images/c9f5f1dbe1cabe9e48b12ffbb76a64b8.png)

2\. 然后将你的字体添加到 yourApp-Info.plist

![在此处输入图像描述](../Images/b1743e02c0065fb7d488e9a60b7d248c.png)

3\. 运行`NSLog(@"Available fonts: %@", [UIFont familyNames]);`以检查字体/字体系列对系统具有的名称...

![在此处输入图像描述](../Images/7da2dded4e848147afaef2a3e3632398.png)

4\. 复制该名称并在您的 CSS 中使用它们...不需要@font-face

```
body {
    font-family:"Liberation Serif";
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-10-02T05:47:18.803

尽管我不确定我在上面做错了什么，但我最终使它工作。这是我使用的 HTML (NSString *htmll)。我添加了所有内容，其中一些可能与解决方案无关。

```
<html><head><style type="text/css">
@font-face {
font-family: 'gotham_symbol';
src: url('GOTHAMboldSymbols_0.ttf')  format('truetype') 
}
@font-face {
font-family: 'gotham_symbol_italic';
src: url('GothamBoldItalic.ttf')  format('truetype') 
}
#w {display:table;}
#c {display:table-cell; vertical-align:middle;}
i { font-family: 'Helvetica-BoldOblique'; }
</style></head><body topmargin="0" leftmargin="0">
<div style="display: table; width: 320px; height: 50px; #position: relative; overflow: hidden;">
<div style=" #position: absolute; #top: 50%;display: table-cell; vertical-align: middle;">
<div style=" #position: relative; #top: -50%">
<p style="font-size:20px;font-family:'gotham_symbol';color:#97371f;">THE TEXT GOES HERE</p></div></div></div></body></html> 
```

我加载 UIWebView 如下：

```
UIWebView *webView = [[UIWebView alloc] initWithFrame:rect];
[webView makeTransparent];
NSURL *baseURL = [NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]];
[webView loadHTMLString:html baseURL:baseURL]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-08-07T02:57:57.497

对于 Swift 和 WKWebView，这对我有用：

```
@IBOutlet weak var webView: WKWebView!

let html = """
<!DOCTYPE html>
<head>
    <style>
        @font-face {
            font-family: 'Raleway-Regular';
            src: url('Raleway-Regular.ttf')  format('truetype')
        }
        img {
            width: 100%;
        }
        body {
            font-family: 'Raleway-Regular';
            font-size: 30px;
        }
    </style>
</head>
<body>
    My HTML Content
</body>
</html>
"""

let baseURL = URL(fileURLWithPath: Bundle.main.bundlePath)
webView.loadHTMLString(html, baseURL: baseURL) 
```

必须像往常一样将字体添加到 XCode 项目中，并复制捆绑资源

```
<key>UIAppFonts</key>
<array>
    <string>Raleway-Bold.ttf</string>
    <string>Raleway-Regular.ttf</string>
</array> 
```

# ios - 存储桶中文件的 AWS 开发工具包公共 URL

> ID：10490697
> 
> 赞同：1
> 
> 时间：2012-05-07T23:52:15.730
> 
> 标签：ios, sdk, amazon-web-services

我参考了下面的答案来检索存储桶中的所有文件。

[Amazon AWS IOS SDK：如何列出文件夹中的所有文件名](https://stackoverflow.com/questions/9329234/amazon-aws-ios-sdk-how-to-list-all-file-names-in-a-folder)

有没有办法检索公共 url 以使用 iOS AWS SDK 检索下载文件？

# android - Theme.Holo.Light 问题中的自动完成下拉项文本颜色

> ID：10490700
> 
> 赞同：0
> 
> 时间：2012-05-07T23:52:20.527
> 
> 标签：android, android-theme

我为这个问题搜索了一整天，没有解决方法，我希望有一双新的眼睛来看看这个。我正在使用 Android 3.2 和主题 Holo.Light 与 ActionBar（重要）。

我的布局xml：

```
 <AutoCompleteTextView
            android:id="@+id/autocompleteSearchTxt"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_weight="0.52"
            android:textSize="@dimen/text_size_normal"
            android:hint="@string/search"
            android:textColor="@android:color/primary_text_light"
            android:textCursorDrawable="@null" /> 
```

在 Android 清单文件中：`android:theme="@style/Theme.Holo.Light.Workaround"`

在themes.xml 文件中：

```
<style name="Theme.Holo.Light.Workaround" parent="@android:style/Theme.Holo.Light">
   <item name="android:autoCompleteTextViewStyle">@style/AutoCompleteTextViewLight</item>
    <item name="android:dropDownItemStyle">@style/Widget.DropDownItemLight</item>
</style> 
```

在styles.xml 文件中：

```
 <style name="AutoCompleteTextViewLight" parent="@android:style/Widget.AutoCompleteTextView">
    <item name="android:textColor">@android:color/primary_text_light</item>
</style>
<style name="Widget.DropDownItemLight" parent="@android:style/Widget.DropDownItem">
    <item name="android:textColor">@android:color/primary_text_light</item>
</style> 
```

现在在这里我尝试了我自己的颜色，红色，蓝色......会脱颖而出的颜色。

结果是……什么都没有。它没有任何改变，当我在自动完成中写入字符时，我可以看到它正在完成，但根本看不到下拉项文本颜色。它是透明的，或白底白字（在真实设备上）。

我无法理解我做错了什么。以前有人解决过这个问题吗？请任何线索都会很棒。还是非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T10:02:01.997

可能有点晚了，但如果您仍然需要答案...

您如何设置阵列适配器？如果您正在使用：

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_dropdown_item_1line,my_list_of_values); 
```

然后，Android 提供的默认布局将覆盖您在 xml 中所做的任何事情。

相反，您为什么不尝试使用 textview 组件创建一个布局文件，然后在实例化您的`ArrayAdapter`?

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,R.layout.your_textview_layout,my_list_of_values); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-22T14:41:52.613

```
 private ArrayAdapter<String> autoCompleteAdapter = new ArrayAdapter<String>
                          (this,android.R.layout.simple_list_item_1, yourList){                     
    public View getView(int position, View convertView, ViewGroup parent) {
     View v = super.getView(position, convertView, parent);

    ((TextView) v).setTextSize(14);                             
     Typeface Type = getFont () ;  // custom method to get a font from "assets" folder
     ((TextView) v).setTypeface(Type);              
    ((TextView) v).setTextColor(YourColor);                                             
     ((TextView) v) .setGravity(Gravity.LEFT|Gravity.CENTER_VERTICAL);

        return v;
     }          
     };

    YourAutoCompleteView.setAdapter(autoCompleteAdapter); 
```

# ios - UIViewController 子类也会影响我的 UITableViewControllers 吗？

> ID：10490703
> 
> 赞同：2
> 
> 时间：2012-05-07T23:52:48.450
> 
> 标签：ios, ios5, uiviewcontroller, uitableview, subclass

我需要为我的所有视图控制器添加一个通用方法，无论它们是什么类型。我注意到虽然我的一些视图控制器继承自 UIViewController 和一些从 UITableViewControllers。

如何编写可以同时用于两者的子类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:58:59.537

UITableViewController 继承自 UIViewController，因此如果您希望能够从两者调用自定义方法，您可以在 UIViewController 上编写一个类别，然后在 UIViewController 或 UITableViewController 的任何子类中调用该类别的方法。这是 Apple 关于类别和扩展的文档的链接。[http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:58:03.550

如果您将类别添加到`UIViewController`，您将能够在子类上调用这些方法`UITableViewController`，就像`UITableViewController`的子类一样`UIViewController`

# wcf - 使用现有的 WCF 服务

> ID：10490704
> 
> 赞同：0
> 
> 时间：2012-05-07T23:52:55.747
> 
> 标签：wcf, reference, datacontract

我是 WCF 服务编程的新手，所以我希望如果你回答我的问题 - 你会考虑到这一点，并像我小时候一样向我解释（wcf 服务傻瓜:)。我有一个需要连接的现有 WCF 服务。我应该创建自己的 WCF 服务，该服务将与现有服务进行通信并共享一些已在现有服务中定义的请求和响应对象。谁能告诉我该怎么做（建立两者之间的通信并在服务中使用与现有服务相同类型的对象），一步一步？我试图在网上找到答案，但这有点令人困惑（参考，使用合同......）。正如我所说，您可以像向真正的初学者一样自由地解释。任何帮助都非常受欢迎......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T01:25:50.747

“我应该创建自己的 WCF 服务，该服务将与现有服务进行通信，并共享一些已在现有服务中定义的请求和响应对象。” - 这听起来你需要创建一个**客户端**来连接到服务（见下文如何创建客户端）。您可以创建 WCF 服务以与其他服务进行通信，但您需要比这种格式允许的更多背景。

您可以通过[WCF 示例](http://www.microsoft.com/en-us/download/details.aspx?id=21459)快速了解 WCF 。在示例中的 WF_WCF_Samples\WCF\Basic 下，您可以找到许多应首先进行的服务/客户端设置。[MSDN 杂志](http://msdn.microsoft.com/en-us/magazine/ee532094.aspx?sdmr=wcf&sdmi=topics)有大量关于这个主题的文章。

在 10,000 英尺的视野中：

客户端 - 要使用服务，请创建一个测试控制台应用程序。在您的项目中添加服务引用（当您右键单击引用时，您将看到该选项）。将“服务引用”对话框的地址指向您要使用的服务，就会发生很多事情。最终结果是您可以使用以下内容调用服务上的服务方法（其中 Service1 将替换为您正在调用的任何服务）

```
 static void Main(string[] args)
        {
            var proxy = new ServiceReference1.Service1Client();
            var test = proxy.GetData(1);
        } 
```

服务 - 您将使用方法和类型创建一个接口，然后使用属性装饰此接口，例如：

```
[ServiceContract]
    public interface IService1
    {
        [OperationContract]
        string GetData(int value);

        [OperationContract]
        CompositeType GetDataUsingDataContract(CompositeType composite);

        // TODO: Add your service operations here
    } 
```

这些是您的服务可以执行的操作（OperationContract）。服务方法可以返回原始或复杂类型（字符串与 CompositeType），也可以接受复杂或原始的参数。

您将执行此合同：

```
public class Service1 : IService1
    {
        public string GetData(int value)
        {
            throw  new ApplicationException("Boom");
            return string.Format("You entered: {0}", value);

        }

        public CompositeType GetDataUsingDataContract(CompositeType composite)
        {
            if (composite == null)
            {
                throw new ArgumentNullException("composite");
            }
            if (composite.BoolValue)
            {
                composite.StringValue += "Suffix";
            }
            return composite;
        }
    } 
```

接下来，您需要托管您的服务。根据您的托管要求，您有很多选择来完成此操作。您可以做的最简单的托管是使用控制台应用程序：

```
class Program
    {
        static void Main(string[] args)
        {
            var host = new ServiceHost(typeof(Service1), new Uri("http://localhost:8999/"));

            host.AddServiceEndpoint(typeof(IService1), new BasicHttpBinding(), "");

            var metadataBehavior = host.Description.Behaviors.Find<ServiceMetadataBehavior>();
            if (metadataBehavior == null)
            {
                metadataBehavior = new ServiceMetadataBehavior();
                metadataBehavior.HttpGetEnabled = true;
                host.Description.Behaviors.Add(metadataBehavior);
            }

            host.Open();

            Console.WriteLine("Running..");
            Console.ReadLine();
        }
    } 
```

# solr - Solr 查询在字段中查找 IN、IT 或 IS

> ID：10490707
> 
> 赞同：0
> 
> 时间：2012-05-07T23:53:27.763
> 
> 标签：solr, django-haystack

执行这些查询时（单独）：

```
country:IN 
```

-或者-

```
country:IT 
```

-或者-

```
country:IS 
```

...我得到返回的索引中的所有项目。我只想获取其国家字段与这些参数匹配的项目。我已经尝试过使用单/双引号和单/双斜杠进行转义的每种组合。这样做时，根本不会退回任何物品。

我已经通过转储整个索引（使用松散的查询）并识别它们来验证这些参数的索引中是否存在项目。我在 django-haystack 上，以防万一，但 Django python shell 和 Solr Web 管理界面都存在问题。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T05:51:21.140

[过滤器查询](http://wiki.apache.org/solr/CommonQueryParameters#fq)返回与其匹配的文档子集。

```
fq=country:(IN OR IT OR IS)
fq=country:IN 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:53:38.130

这些是标准的噪音/停用词。您可以从停用词文件 (stopwords_en.txt) 中删除这些术语并重新索引您的文档。或者将类型设置为字符串并使用 fq 就像上面提到的 aitchnyu 一样。

# c# - 如果 ListView 处于“无”选择模式之外，则不会在 Metro ListViewItem 上触发 RightTapped

> ID：10490709
> 
> 赞同：3
> 
> 时间：2012-05-07T23:53:56.260
> 
> 标签：c#, xaml, windows-8, windows-runtime, winrt-xaml

该问题实际上与此处描述的相同：http: [//social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/542b827a-7c8e-4984-9158-9d8479b2d5b1](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/542b827a-7c8e-4984-9158-9d8479b2d5b1)但我对接受的答案不满意在那里，觉得必须有更好的解决方案......

我正在尝试在我的列表视图上实现一个“经典”上下文菜单（不是通过 AppBar，而是通过 PopupMenu），并且效果很好，但前提是我将列表视图设置为“无”选择模式。

上面的链接正确解释了如果 ListView 设置为“无”选择模式以外的 ListViewItem 会“吞下”正确的点击事件。如何覆盖此行为，以便选择列表视图项并且列表视图仍会触发我可以做出反应的 RightTapped 事件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T19:16:55.060

我相信我通过继承 ListView 和 ListViewItem 类解决了这个问题。

```
public class MyListView : ListView
{
    protected override DependencyObject GetContainerForItemOverride()
    {
        return new MyListViewItem();
    }
}

public class MyListViewItem : ListViewItem
{
    protected override void OnRightTapped(Windows.UI.Xaml.Input.RightTappedRoutedEventArgs e)
    {
        base.OnRightTapped(e);
        e.Handled = false; // Stop 'swallowing' the event
    }
}

<CustomControls:MyListView
    x:Name="MyListView"
    ...
    SelectionMode="Single"
    RightTapped="MyListView_RightTapped">
</CustomControls:MyListView> 
```

通过这种简单的方法，即使 SelectionMode 设置为“Single”、“Multiple”或“Extended”，也会调用 MyListView_RightTapped 处理程序。然而，下一个问题是，这个小小的胜利是否会带来一个好的应用程序 UI 设计。我不会在这里尝试回答这个问题......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T04:25:32.157

您可以在 GridViewItem 上使用 PointerPressed/PointerReleased 事件来获得与 RightTapped 或 ManipulationCompleted 相同的效果。

```
 <ListView
        Margin="120,80,0,0"
        SelectionMode="Multiple">
        <ListView.ItemContainerStyle>
            <Style
                TargetType="ListViewItem">
                <Setter
                    Property="Width"
                    Value="100" />
                <Setter
                    Property="Height"
                    Value="100" />
            </Style>
        </ListView.ItemContainerStyle>
        <ListViewItem
            RightTapped="ListViewItem_RightTapped_1"
            PointerPressed="ListViewItem_PointerPressed_1"
            PointerReleased="ListViewItem_PointerReleased_1"
            ManipulationStarted="ListViewItem_ManipulationStarted_1">
            <Rectangle
                Height="80"
                Width="80"
                Fill="Red" />
        </ListViewItem>
    </ListView> 
```

.

```
 private void ListViewItem_RightTapped_1(object sender, RightTappedRoutedEventArgs e)
    {
        Debug.WriteLine("Tap");
    }

    private void ListViewItem_PointerPressed_1(object sender, PointerEventArgs e)
    {
        Debug.WriteLine("Press");
    }

    private void ListViewItem_ManipulationStarted_1(object sender, ManipulationStartedRoutedEventArgs e)
    {
        Debug.WriteLine("Manipulating");
    }

    private void ListViewItem_PointerReleased_1(object sender, PointerEventArgs e)
    {
        Debug.WriteLine("Release");
    }
} 
```

输出：

新闻稿 新闻稿

*编辑

抱歉，我一定是错过了这些事件与触摸和鼠标不同的工作方式。我认为你得到的答案可能是你能得到的最好的答案。否则 - 您将需要实现您自己的 ListView 版本。您可以尝试向他们施压，希望在未来的某个版本中获得更好的解决方案，但我对此不抱太大希望。据我所知 - ContextMenus 不是很实用，并且有比右键菜单更好的 UX 解决方案。您可以在 AppBar 中或在选择项目后打开的详细信息页面上显示命令。这可能比试图破解一个从未被设计为支持的东西的解决方法更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-23T21:14:12.570

我采纳了@Jan Zeman 的想法（顺便说一下；））并对其进行了一些改进。

原始方法的一些问题：

*   事件处理程序必须设置`e.Handled = true`，否则事件将冒泡，直到它`Page`自己处理正确的点击事件 - 并因此打开应用栏。
*   如果没有人收听此事件，则该事件将*始终*冒泡并到达`Page`.
*   当右键点击列表的项目*或*项目周围的空白区域时，将触发事件处理程序。

这种方法解决了上述问题：

```
public class MyListView : ListView
{
    public event RightTappedEventHandler ItemRightTapped;

    protected override DependencyObject GetContainerForItemOverride()
    {
        var item = new MyListViewItem();
        item.RightTapped += OnItemRightTapped;
        return item;
    }

    protected virtual void OnItemRightTapped(object sender, RightTappedRoutedEventArgs args)
    {
        if (ItemRightTapped != null)
            ItemRightTapped(sender, args);
        args.Handled = true;
    }
}

public class MyListViewItem : ListViewItem
{
    protected override void OnRightTapped(RightTappedRoutedEventArgs e)
    {
        base.OnRightTapped(e);

        // Stop 'swallowing' the event
        e.Handled = false;
    }
} 
```

现在您可以订阅该`ItemRightTapped`事件，当且仅当一个项目被右击时才会触发。

该项目会将事件标记为未处理，列表将让您处理事件，然后将其标记为已处理 - 防止它冒泡并点击`Page`.

# ruby - RSpec any_instance 在函数中初始化的对象上存根

> ID：10490710
> 
> 赞同：1
> 
> 时间：2012-05-07T23:54:17.383
> 
> 标签：ruby, methods, rspec, stub

免责声明：总的来说，我对 RSpec 和 TDD 很陌生，所以我可能会以完全错误的方式解决这个问题。

我想为我的程序编写一个命令行界面，它接受一个命令并生成一个类来处理它。该程序的工作方式类似于 git 和 svn 等工具；即你可以传递“srs init”来初始化程序，“srs add”来添加一些东西，等等。

所以我有一个类，它接受 ARGV 并将其传递给特定的处理程序，如下所示：

```
class CLI
    def run!(*arguments)
        command = arguments.shift
        case command
        when "init"
            CLI::Init.new.run!(*arguments)
        end
    end
end 
```

我的 Init 处理程序将如下所示：

```
class CLI
    class Init
        def initialize()
        end
        def run!(*arguments)
        end
    end
end 
```

我正在尝试为 CLI 类的路由功能编写一个测试套件。如果我使用以下内容，RSpec 会失败：

```
describe CLI do
    it "should launch the Init handler if we pass init" do
        CLI::Init.any_instance.should_receive(:run!)
        CLI::run!(*["init"])
    end
end 
```

但是，如果我将调用替换为`CLI::run!`直接调用 Init 处理程序的运行，它就会通过；IE：-

```
describe CLI do
    it "should launch the Init handler if we pass init" do
        CLI::Init.any_instance.should_receive(:run!)
        CLI::Init.new.run!(*[])
    end
end 
```

看起来 any_instance 似乎只适用于在`describe`块内定义/构造的实例，但我不太确定。如果有人可以为我提供任何指导，无论是我如何检查在我的`run!`函数内部构造的实例上是否调用了类方法，或者首先测试此功能的更好方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T09:08:45.740

有时解释问题会揭示答案。实际上，处理程序的名称“Init”作为参数传递给`describe`块，更像这样：

```
%w{Init}.each do |cmd|
    describe CLI do
        it "should launch the #{cmd} handler if we pass #{cmd}" do
            CLI.const_get(cmd).any_instance.should_receive(:run!)
           CLI::run!(*[cmd])
        end
    end
end 
```

在描述问题时，我拿出循环来简化问题，但这样做做出了一个关键的改变——类名 Init 以大写“I”开头，而传递给命令的命令名行 init 以一个小的“i”开头。

所以结果证明测试正确失败，因为当我应该传递命令“init”时，我试图传递命令“init”。

TL;DR——原始代码*确实*有效！抱歉打扰了。

# sql - SQL SERVER 中的 Group by/Print 相关查询

> ID：10490712
> 
> 赞同：1
> 
> 时间：2012-05-07T23:54:35.080
> 
> 标签：sql, sql-server, database, error-handling

好的，所以我有一个表，其中有 custid、lastname、firstname 和 DOB。

我的任务是再创建一个包含客户出生十年的字符串的列...

即，如果 cust 出生于 1950 年，则该记录的新列应显示为 50 年代，如果 cust 出生于 1974 年，则该记录的新列应显示为 70 年代。等等。

我想我必须按每个十年分组，并创建一个新列，给出客户出生十年的“字符串”表示。

这是我的尝试...

`Select DateOfBirth, COUNT(DateOfBirth) as 'DOBYEAR' From Customers Group by DateOfBirth Order By DateOfBirth asc If (Customers.DateOfBirth <= '1979') begin set DOBYEAR = 'Seventies and Before' end If (Customers.DateOfBirth between '1980' and '1989)' begin set DOBYEAR = 'Eighties' end If (Customers.DateOfBirth between '1990' and '1999') begin set DOBYEAR = 'Nineties' end If Customers.DateOfBirth >= '2000' Begin set DOBYEAR = '20th century' end Go`

我正在创建 DOBYEAR 作为新列，并尝试输入诸如“七十年代和之前、八十年代、九十年代和 20 世纪......

给我以下错误。

```
Msg 102, Level 15, State 1, Line 6
Incorrect syntax near '='.
Msg 102, Level 15, State 1, Line 10
Incorrect syntax near '='.
Msg 102, Level 15, State 1, Line 14
Incorrect syntax near '='.
Msg 102, Level 15, State 1, Line 18
Incorrect syntax near '='. 
```

请指导我正确的方向。

我可以使用“Print 'Seventies and Before'”而不是“set DOBYEAR = 'Seventies and Before'”吗？

也许，我可以在不使用 IF 语句的情况下做到这一点，但不知道如何。

谢谢X

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:01:17.850

您不需要 group by 来执行此操作。假设`DateOfBirth`列是类型`datetime`（提示：应该）：

```
Select 
    DateOfBirth, 
    Case 
      when datepart(year, DateOfBirth) between 1970 and 1979 then 'Seventies' 
      when datepart(year, DateOfBirth) between 1980 and 1989 then 'Eighties' 
      when datepart(year, DateOfBirth) between 1990 and 1999 then 'Nineties' 
      when datepart(year, DateOfBirth) >= 2000 then '21st century' 
      else 'Before 1970' 
    end as DOBDecadeString
From 
   Customers
Order By DateOfBirth asc 
```

# this - 如何在 JSDoc 3 标签中记录对象的属性：@this

> ID：10490713
> 
> 赞同：42
> 
> 时间：2012-05-07T23:54:44.160
> 
> 标签：this, jsdoc

该`@param`标签允许记录属性，例如

```
 /**
  * @param {Object} userInfo Information about the user.
  * @param {String} userInfo.name The name of the user.
  * @param {String} userInfo.email The email of the user.
  */ 
```

我将如何记录@this 标签的属性？

```
 /**
  * @this {Object} 
  * @param {String} this.name The name of the user.
  * @param {String} this.email The email of the user.
  */ 
```

我想知道是否有从事该项目的人知道。（文档仍在创建中...）

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2014-01-23T19:10:35.053

要记录实例成员，请使用`@name Class#member`：

```
/**
 * Construct a new component
 *
 * @class Component
 * @classdesc A generic component
 *
 * @param {Object} options - Options to initialize the component with
 * @param {String} options.name - This component's name, sets {@link Component#name}
 * @param {Boolean} options.visible - Whether this component is visible, sets {@link Component#visible}
 */
function Component(options) {
   /**
    * Whether this component is visible or not
    *
    * @name Component#visible
    * @type Boolean
    * @default false
    */
    this.visible = options.visible;

   /**
    * This component's name
    *
    * @name Component#name
    * @type String
    * @default "Component"
    * @readonly
    */
    Object.defineProperty(this, 'name', {
        value: options.name || 'Component',
        writable: false
    });
} 
```

这会导致文档中的**成员**部分列出每个成员、其类型、默认值以及它是否为只读。

由 jsdoc@3.3.0-alpha3 生成的输出如下所示：

![JSDoc3 输出](../Images/343f2fb02600cc13063b8fa20a64c3e3.png)

也可以看看：

*   [JSDoc 名称路径](http://usejsdoc.org/about-namepaths.html)
*   [`@instance`标签](http://usejsdoc.org/tags-instance.html)
*   [`@readonly`标签](http://usejsdoc.org/tags-readonly.html)
*   [`@type`标签](http://usejsdoc.org/tags-type.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-31T22:07:46.633

使用`@property`标签来描述对象的属性。

`@param`用于定义方法或构造函数的参数。

`@this`用于定义`this`所指的对象。所以这里是一个使用 JSDOC 3 的例子。

```
/**
* @class Person
* @classdesc A person object that only takes in names.
* @property {String} this.name - The name of the Person.
* @param {String} name - The name that will be supplied to this.name.
* @this Person
*/
var Person = function( name ){
    this.name = name;
}; 
```

JSDOC 3：[https ://github.com/jsdoc3/jsdoc](https://github.com/jsdoc3/jsdoc)

更多信息：[http ://usejsdoc.org/index.html](http://usejsdoc.org/index.html)

更多信息：[http ://code.google.com/p/jsdoc-toolkit/wiki/TagParam](http://code.google.com/p/jsdoc-toolkit/wiki/TagParam)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-15T13:31:42.800

在类的构造函数中，jsdoc 将自己意识到文档化的属性属于类实例。所以这应该足够了：

```
/**
 * @classdesc My little class.
 *
 * @class
 * @memberof module:MyModule
 * @param {*} myParam Constructor parameter.
 */
function MyLittleClass(myParam) {
    /**
     * Instance property.
     * @type {string}
     */
    this.myProp = 'foo';
} 
```

如果 jsdoc 不清楚该函数是类构造函数，可以使用`@this`来定义`this`指的是什么：

```
/**
 * @classdesc My little class.
 *
 * @class
 * @memberof module:MyModule
 * @name MyLittleClass
 * @param {*} myParam Constructor parameter.
 */

// Somewhere else, the constructor is defined:
/**
 * @this module:MyModule.MyLittleClass
 */
function(myParam) {
    /**
     * Instance property.
     * @type {string}
     */
    this.myProp = 'foo';
} 
```

# php - 显示数组中的表单错误消息

> ID：10490716
> 
> 赞同：0
> 
> 时间：2012-05-07T23:55:09.957
> 
> 标签：php, ajax

我想将 GUMP [https://github.com/Wixel/GUMP](https://github.com/Wixel/GUMP)合并到我的站点中以进行服务器端验证。但不幸的是，文档很简单，而且我是 PHP 新手。

这是我的验证码：

```
//Validation
$gump = new GUMP(); 
$rules = array(
    'dept'     => 'required|numeric',
    'hosp'     => 'required|numeric',
    'subhosp'  => 'required|numeric',
    'user'     => 'required|numeric',
    'gpo'      => 'required|boolean|exact_len,1',
    'clin'     => 'required|valid_name',
    'clinmail' => 'required|valid_email',
    'comp'     => 'required|alpha_dash',
    'cpt'      => 'required|alpha_dash',
    'past'     => 'required|boolean|exact_len,1',
    'latex'    => 'required|boolean|exact_len,1',   
);
$validated = $gump->validate($_POST,$rules);
print_r($validated); // Something went wrong 
```

当我在 FireBug 中查看 AJAX 响应时，上述代码的输出给了我一个数组：

```
Array
(
    [0] => Array
        (
            [field] => clin
            [value] => .-0
            [rule] => validate_valid_name
        )

    [1] => Array
        (
            [field] => clinmail
            [value] => %$sd
            [rule] => validate_valid_email
        )

) 
```

我需要的是这样的：

```
<div class="error-msg">You did not enter a valid email address</div><br>
<div class="error-msg">You did not enter a valid username</div><br> 
```

从我得到的文档中：

```
 if($validated === TRUE)
{
    // Do something, everything went well
}
else
{   
    // This is where I am stuck. Do I have to loop through and put my <div> tags here?
} 
```

我的问题是社区将如何处理使用此类输出错误消息？我唯一的想法是，我遍历上面的结果并根据字段和被破坏的规则输出不同的消息，但这似乎很乏味。有没有更好的方法或更好的类来使用独立的 PHP 输入验证？我正在使用另一个非常易于使用的类，但是当我从内联 PHP 转移到 AJAX 时它开始崩溃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T23:59:28.597

将您的代码编辑为：

```
$gump = new GUMP(); 
$rules = array(
'dept'     => 'required|numeric',
'hosp'     => 'required|numeric',
'subhosp'  => 'required|numeric',
'user'     => 'required|numeric',
'gpo'      => 'required|boolean|exact_len,1',
'clin'     => 'required|valid_name',
'clinmail' => 'required|valid_email',
'comp'     => 'required|alpha_dash',
'cpt'      => 'required|alpha_dash',
'past'     => 'required|boolean|exact_len,1',
'latex'    => 'required|boolean|exact_len,1',   
);

$error_texts = array(
'dept'     => 'You must enter a numeric value',
'hosp'     => 'You must enter a numeric value',
'subhosp'  => 'You must enter a numeric value',
'user'     => 'You must enter a numeric value',
'gpo'      => 'You must enter a boolean value',
'clin'     => 'You must enter a valid name',
'clinmail' => 'You must enter a valid email',
'comp'     => 'You must enter a valid alpha dash',
'cpt'      => 'You must enter a valid alpha dash',
'past'     => 'You must enter 1 char',
'latex'    => 'You must enter 1 char',
);

$validated = $gump->validate($_POST,$rules);

if($validated === TRUE)
{
   echo "Every thing is ok";
}
else
{
    foreach($validated as $key=>$error)
    {
        echo '<div class="error-msg">' . $error_texts["{$error['field']}"] . '</div><br />';
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T22:03:27.520

我想补充一点，如果验证失败两次，例如，如果需要一个值并且必须存在超过 10 个字符，那么`@semsems`answer 将为同一字段打印多行。

我更改了上面的代码并添加了：

```
$_validated = array();
foreach($validated as $key=>$error)
{
    if ( !in_array($error['field'], $_validated) )
    {
        print '<div class="error-msg">' . $error_texts["{$error['field']}"] . '</div>';
        $_validated[] = $error['field'];
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-01T04:50:19.987

我知道这个问题已经有一年的历史并且已经得到解答，但是由于我自己基于已接受的答案并且在我看来使它变得更好（完全通用，区域设置为额外），我认为分享并获得一些会很好反馈...你们觉得我的代码怎么样？现在基于**semsem 的**回答......我喜欢他编写部分代码的方式，我从中派生出以下代码：
首先我用自己的类扩展了 GUMP，这样我就可以覆盖一些函数

```
<?php

require("gump.class.php");

class GumpValidator extends GUMP 
{
    private $locale;
    private $translator;

    public function GumpValidator($lang = "en")
    {
        $this->locale = $lang;
        $this->loadValidationLocales();
    }

    /** Overwrite the default validate() function of GUMP so that I can add an extra "message" property */
    public function validate(array $input, array $ruleset) 
    {
        $validated_data = GUMP::validate($input, $ruleset);
        if(is_array($validated_data)) {
            foreach($validated_data as $index=>$error) {
                $validation = str_replace(":attribute",  $error['field'], $this->translator[$error['rule']]);
                $validation = str_replace(":param",  $error['param'], $validation);
                $validated_data[$index++]['message'] = $validation;
            }
        }

        return $validated_data;
    }

    /** Depending on the language locale, load the proper set of validation messages */
    private function loadValidationLocales()
    {
        $this->translator = require "/lang/" . $this->locale . "/validation.php";
        return $this->translator;
    }  
} // EOC 
```

然后正如您从扩展类中看到的那样，我为自己创建了一组用于验证的语言环境语言消息，并且我直接从 Github 上的 GUMP 代码中获取了可能的验证错误的完整列表，查看`get_readable_errors()`获取完整列表的函数的错误。Github 链接[在这里](https://github.com/Wixel/GUMP/blob/master/gump.class.php)...我创建的语言环境保存在单独的语言文件夹`/lang/en/validation.php`，`/lang/fr/validation.php`等...您可以轻松创建任意数量...我从 Laravel 框架中获取概念...这些`validation.php`文件看起来像，像这样（每种语言/区域设置 1 个文件），这里是英文的：

```
<?php

return array(
    "validate_alpha"            => "The :attribute may only contain letters.",
    "validate_alpha_numeric"    => "The :attribute may only contain letters and numbers.",
    .....
); 
```

然后最后在我的 POST 中验证代码，我只是这样称呼它：

```
// load my extended class with language locale I want to use
$gump = new GumpValidator("en");

// now validate the data 
$validated_data = $gump->validate( $_POST, $rules ); 
```

所以最后我得到了对象`message`内部的额外属性，`$validated_data`可以选择我选择显示错误消息的任何语言环境……瞧！！！在我的情况下，我阅读了 javascript 中的代码以显示错误`Bootstrap alert`，但如果你想要 PHP，你也可以查看 semsem 答案。所以最后，我知道它需要更多的代码，因为我有一个额外的类来包装它和额外的语言环境，但是首先让它通用（每个验证错误）然后轻松地拥有多种语言环境不是很好吗？

# css - 如何将所有表单字段（和提交按钮）放在一行上？

> ID：10490717
> 
> 赞同：0
> 
> 时间：2012-05-07T23:55:13.037
> 
> 标签：css

我试图将所有表单字段（和提交按钮）放在一行上，以便可以从左到右读取/填写整个表单。

这是我正在使用的代码：[JsFiddle Demo](http://jsfiddle.net/Abijah/XZXHt)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:59:35.743

只需制作`.form p` `display:inline`. [小提琴](http://jsfiddle.net/XZXHt/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:58:44.947

用于`display:inline`表单中的所有输入（包括您的案例中的 p 标签）

# regex - 过滤单词/短语上的字符串：Perl

> ID：10490724
> 
> 赞同：0
> 
> 时间：2012-05-07T23:56:06.947
> 
> 标签：regex, perl, filtering

我是 perl 的新手，我正在寻找一些基本过滤关键字列表的帮助。简而言之，这是针对相同单词/短语哈希的字符串哈希。这是为了得到最小的公分母并清理列表。

例如说列表包括以下内容：

```
bat
bat boy
bat-boy
bat&boy
bat:boy
bat's
bat-boy's
batman & bat boy 
```

它应该只匹配以下内容：

```
bat boy            (because of bat)
batman & bat boy   (because of bat) 
```

正则表达式显然是要走的路，但我坚持以下，因为我不能使用 /b（单词边界匹配），因为某些单词包含非单词字符 -、'、&、: 等。

编写正则表达式的最佳方法是什么？我正在检查 $keyx 和 $keyz

这是正则表达式：

```
if $keyx=~m/\Q$keyz\E/ 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:28:05.177

不太确定你在追求什么，但我猜你只想匹配整个单词，不匹配部分单词，也不匹配与非字母相关的单词。实现此目的的一种方法是使用否定的环视断言：

```
use strict;
use warnings;
use v5.10;

for (split /, */, <DATA>) {
    say if /(?<![^ ])bat(?![^ ])/;
}

__DATA__
bat, bat boy, bat-boy, bat&boy, bat:boy, bat's, bat-boy's, batman & bat boy 
```

**输出：**

```
bat
bat boy
batman & bat boy 
```

所以我们断言关键字周围的字符不是空格。

# javascript - Google CSE - 重定向到带有结果的页面的搜索框

> ID：10490725
> 
> 赞同：0
> 
> 时间：2012-05-07T23:56:08.107
> 
> 标签：javascript, google-custom-search

伙计们。

我对 Google CSE 手册有点困惑，无法理解它的一些基本功能。

所以，我创建了一个免费的自定义搜索配置文件，我得到的只是唯一的代码片段，这个：

```
<div id="cse" style="width: 100%;">Loading</div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript"> 
  google.load('search', '1', {language : 'ru', style : google.loader.themes.V2_DEFAULT});
  google.setOnLoadCallback(function() {
    var customSearchOptions = {};
    var googleAnalyticsOptions = {};
    googleAnalyticsOptions['queryParameter'] = 'q';
    googleAnalyticsOptions['categoryParameter'] = '';
    customSearchOptions['googleAnalyticsOptions'] = googleAnalyticsOptions;  var customSearchControl = new google.search.CustomSearchControl(
      '001098741616107095995:xeqdxoqdue8', customSearchOptions);
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    customSearchControl.draw('cse');
  }, true);
</script> 
```

此代码段在指定的 div 中创建 google 自定义搜索控件。这就是为什么这个片段可能会位于搜索结果页面中的原因，例如 www.site.com/search.html

但我要实现的是我网站每个页面侧边栏中的搜索框。用户无论身在何处都可以在该搜索框中输入搜索查询，然后直接进入结果页面 www.site.com/search.html 等待他的匹配集。

我怎样才能做到这一点？

浏览手册对我没有任何影响，我遗漏了一些东西，但无法弄清楚到底是什么......谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T15:06:22.467

here something that worked for me. ( if I understood correctly your Q )

> src="https://www.google.com/jsapi"> .........
> 
> ```
>  customSearchControl.draw('google_search');
> 
>    <? if (isset($keyword)) { ?>     
>      customSearchControl.execute('<?=$keyword?>'); <? } ?>    
>    }
> google.setOnLoadCallback(OnLoad);
> </script> 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T14:44:15.773

google 搜索通过从 URL 参数获取搜索查询来工作。您只需要创建一个表单，将获取参数发布到您的结果页面。您的搜索字段的名称需要与 URL 栏中的名称匹配，通常是 aq，例如 www.yoursite.com?q=your+search

```
<form action="http://www.yoursite.com/resulspage" method="get">
Search: <input type="text" name="q" />
<input type="submit" value="Seacrh" />
</form> 
```

# c# - 如何创建一个简单的设置表单？

> ID：10490726
> 
> 赞同：0
> 
> 时间：2012-05-07T23:56:26.057
> 
> 标签：c#, winforms, settings, application-settings

**我的项目**

我有一个项目允许您从不同的站点（商店网站）下载 csv、txt、xls 等格式的 Internet 文件。这些文件是采购订单。

下载过程涉及下载选项（参数），可分为三类：

*   日期范围：初始日期和最终日期
*   订单状态：可用、已下载、已读等
*   店铺名称

**我的问题**

我需要创建一个这样的表单：

![在此处输入图像描述](../Images/656cb291dd3c83699f977e9a0c6c14fc.png)

设置将保存在数据库中，因此我不会使用 app.config 文件。

主要问题是每个商店的下载选项都不相同。例如，商店 A 使用这些订单状态并且不需要日期范围（因此，必须隐藏日期范围控件）

*   状态一
*   状态 b

并且商店 B 使用这些状态，它需要一个日期范围

*   状态 c
*   状态 d
*   日期范围

如何根据所选商店禁用选项？

如何轻松处理组合框中的多个选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:05:27.540

您可以使用显示或隐藏元素

```
 this.button1.Visible = false; //hide
 this.button1.Visible = true; //show 
```

我会编写一个模板解析器来提供/选择不同的选项（如果我理解你是正确的）

# objective-c - 退出应用程序并重新加载时保存 UIButton 的状态

> ID：10490730
> 
> 赞同：1
> 
> 时间：2012-05-07T23:56:51.927
> 
> 标签：objective-c, ios, xcode, uibutton, save

我在视图上有一个自定义 UIButton，当我按下它时，它会改变状态和 img。当我退出视图并返回它时，UIButton 的状态保持不变。但是当我退出我的应用程序并重新启动它时。我的自定义 UIButton 的状态恢复为默认值。当我退出应用程序时，有没有办法可以保存该按钮的状态？

下面是一个示例图片

[在 http://i.minus.com/ibzHa1XCTDwSAJ.png 之前](http://i.minus.com/ibzHa1XCTDwSAJ.png)

![之后] [http://min.us/mtkB3JQRI](http://min.us/mtkB3JQRI)

这是我试图在 -(void)viewDidLoad 上执行此操作的代码

```
UOEventPost *post = (UOEventPost *)self.event;
if(post.postWanted == YES){
    [wantThis setBackgroundImage:[UIImage imageNamed:@"wanted@2x.png"] forState:UIControlStateSelected];
    [wantThis setSelected:TRUE];
    wantThis.titleLabel.text = [NSString stringWithFormat:@"Wanted"];
}else {
    [wantThis setSelected:FALSE];
} 
```

## 编辑

```
 savedState = [[NSUserDefaults standardUserDefaults]boolForKey:@"TheSavedState"];

UOEventPost *post = (UOEventPost *)self.event;
if(post.postWanted == YES){
    [[NSUserDefaults standardUserDefaults]setBool:YES forKey:@"TheSavedState"];
}else {
    [[NSUserDefaults standardUserDefaults]setBool:NO forKey:@"TheSavedState"];
}

if(!savedState){
    [wantThis setSelected:FALSE];
}else {
    [wantThis setBackgroundImage:[UIImage imageNamed:@"wanted@2x.png"] forState:UIControlStateSelected];
    [wantThis setSelected:TRUE];
    wantThis.titleLabel.text = [NSString stringWithFormat:@"Wanted"];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:00:26.320

使用 nsuserdefaults，因此只要用户拥有您的应用程序，它就会保存。您可以在需要时覆盖它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T00:02:40.990

在我看来，您可以将`selected`状态存储为 a `BOOL`，然后稍后再读回来。研究在会话`NSUserDefaults`中保留这样的信息。（为您的特定应用程序执行此操作的最佳方法可能是为`NSArray`用户想要参与的每个事件存储一个包含标识符。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:26:06.557

只需将状态写入文件即可。从中读取，onLoad。问题解决了。如果您需要帮助，请查看在 ios 中读写文件。或者您也可以使用设置。即使用户完全退出应用程序，它也会保持状态。

# perl - 使方法不可继承？

> ID：10490731
> 
> 赞同：1
> 
> 时间：2012-05-07T23:56:57.870
> 
> 标签：perl, moose

在重构时，我试图暂时保留一些向后兼容性。我想知道是否可以在对象上有一个方法，但防止该方法被继承它的类继承？例如给定

```
package Class {
    use Moose;

    sub foo { 'test' };
}

my $class = Class->new;
$class->foo; 
```

会工作，但是

```
package Extended::Class {
    use Moose;
    extends 'Class';
}
my $class = Extended::Class->new;

$class->foo; 
```

不会。

我意识到这可能违反了某些原则，但我正在弃用这些接口。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:36:09.927

怎么样：

```
use 5.014;

package Class {
    use Carp qw( croak );
    use Moose;

    sub foo {
        my $self = shift;
        croak unless __PACKAGE__ eq ref $self;

        return 'test';
    }
}

package Extended::Class {
    use Moose;
    extends 'Class';
}

package main {
    my $x = Class->new;
    say $x->foo;

    my $y = Extended::Class->new;
    say $y->foo;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:49:38.723

你考虑过委托吗？

```
package Original {
  use Moose;
  sub foo { 23 }
  sub bar { 42 }
}

package Subclass {
  use Moose;
  has original => (
    buidler => '_build_original',
    handles => [qw( bar )],
  );
  sub _build_original { Original->new }
} 
```

当然能不能用得看你的情况。子类不会通过`isa`上述检查（但`isa`如果必须，您可以覆盖）。根据用例，将原始参数传递给您正在扩展的对象可能会很烦人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T07:02:58.200

`foo`因为它会在第一个中寻找方法，所以`Extended::Class`你可以在那里声明一个不做任何事情的方法。这样，除非您在子类中的某处这样做，否则不会调用继承的。

不过，我不确定 Moose 是否会改变这种行为。

```
package Class {
    use Moose;

    sub foo { 'test' }
}

package Extended::Class {
    use Moose;
    extends 'Class';

    sub foo {
        # do nothing
    }
}

package main {
    my $x = Class->new;
    my $y = Extended::Class->new;

    print $x->foo;
    print $y->foo;
} 
```

# c++ - 任何人都可以明确如何在 C++ 中获取 tiff 评级元数据，或者只是按照 Win Explore 读取文件的方式获取文件评级吗？

> ID：10490732
> 
> 赞同：2
> 
> 时间：2012-05-07T23:57:07.777
> 
> 标签：c++, image, metadata, tiff, rating

嘿，在阅读 C++ 中的 tiff 元数据时，我完全迷失了，我查看了谷歌并找不到任何示例。我要做的就是读取 rating 属性并将其输出到控制台，我应该能够从那里获取它。提前致谢。

更新谢谢大家，我会更多地研究 libtiff 库

查看 libtiff 文件夹，对于我想要完成的工作似乎有点矫枉过正。是否可以阅读设置库的文件的“属性/详细信息”选项卡，还是我在问一些非常迟钝的东西。同样，我要查找的只是他的文件是否有评级。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:02:44.780

好吧，libtiff 公开了所有这些功能，您只需要阅读文档即可。

要设置元数据，您有 TIFFSetField

```
int
TIFFSetField(TIFF* tif, ttag_t tag, ...) 
```

同样，要检索元数据，您有[TIFFGetField](http://www.remotesensing.org/libtiff/man/TIFFGetField.3tiff.html)

```
int
TIFFGetField(TIFF* tif, ttag_t tag, ...) 
```

这里要注意的一件事是，如果您正在阅读标准 TIFF 标签或专有标签。如果它们是专有的并且不在 libtiff 库中，那么有人自己添加了它们，在这种情况下，您需要将他们的标签声明合并到您的 libtiff 版本中（或者只是获取他们的）。如果涉及到，您可以按照[本指南](http://www.libtiff.org/internals.html#AddingTags)进行操作（我必须这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T00:07:29.967

有 ImageMagick 可以处理 TIFF 图像：[http ://www.imagemagick.org/script/formats.php 您可以使用它在下面使用](http://www.imagemagick.org/script/formats.php)[libTiff](http://www.libtiff.org/)的框架拉元数据，使用它您应该能够使用调用拉元数据[标签](http://www.libtiff.org/libtiff.html#Tags)喜欢`TIFFGetField`Ed S. 建议

这是从 libTiff 页面中提取的示例用法：

```
TIFF* tif = TIFFOpen("myfile.tif", "r");
if (tif) {
uint32 imageWidth, imageLength;
uint32 tileWidth, tileLength;
uint32 x, y;
tdata_t buf;

TIFFGetField(tif, TIFFTAG_IMAGEWIDTH, &imageWidth);
TIFFGetField(tif, TIFFTAG_IMAGELENGTH, &imageLength);
TIFFGetField(tif, TIFFTAG_TILEWIDTH, &tileWidth);
TIFFGetField(tif, TIFFTAG_TILELENGTH, &tileLength);
buf = _TIFFmalloc(TIFFTileSize(tif));
for (y = 0; y < imageLength; y += tileLength)
    for (x = 0; x < imageWidth; x += tileWidth)
    TIFFReadTile(tif, buf, x, y, 0);
_TIFFfree(buf);
TIFFClose(tif);
} 
```

还有一个由库处理的标签列表：[http ://www.libtiff.org/support.html](http://www.libtiff.org/support.html)

# android - Android：在内部存储中使用应用程序打包文件？

> ID：10490739
> 
> 赞同：0
> 
> 时间：2012-05-07T23:57:57.730
> 
> 标签：android

我想用我的应用程序打包一个保存为数据文件的java对象，然后再覆盖它。我在哪里可以将此文件放在我的应用程序中，我将在应用程序中对其进行写访问？有没有办法将它与应用程序打包，以便它在我的私人内存中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T05:48:27.927

您需要将其作为资产或原始资源放入应用程序中。然后在第一次运行应用程序时，将其作为私有文件复制到内部存储中。如果只读访问就足够了，您可以直接从资产/资源中读取它。

# ruby - 使用 rake 任务和来自抓取 html 的 ruby 代码构建记录

> ID：10490747
> 
> 赞同：0
> 
> 时间：2012-05-07T23:59:01.723
> 
> 标签：ruby, ruby-on-rails-3.1, nokogiri

我使用 nokogiri 来抓取一个 html 页面，我不擅长抓取，就像我不擅长创建任务一样。我找到了一些教程，我认为我可以根据自己的需要对其进行修改，但我无法让它发挥作用。

这是我用来废弃 html 的 ruby​​ 代码，当我在 ruby​​ 控制台中运行它时效果很好，但现在我需要使用所有这些字段创建一个新记录：

```
require 'rubygems'
require 'mechanize'
#require 'pp'

a = Mechanize.new { |agent|
  agent.user_agent_alias = 'Mac Safari'
}

a.get('http://ted.europa.eu/udl?uri=TED:NOTICE:143331-2012:DATA:EN:HTML&tabId=3') do |page|
  title             = page.search('table').search('tr')[0].search('td').map{ |n| n.text }
  doc_nr            = page.search('table').search('tr')[1].search('td').map{ |n| n.text }
  pub_date          = page.search('table').search('tr')[2].search('td').map{ |n| n.text }

  puts "#{title} - #{doc_nr} - #{pub_date}"
end 
```

很高兴得到一个完整的答案，但是..一些好的教程和维基链接也可以。非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T01:05:08.183

对于活动记录：

```
Record.new(:title => title, :doc_nr => doc_nr, :pub_date => pub_date).save 
```

# asp.net - 找不到 ProfileCommon

> ID：10490754
> 
> 赞同：2
> 
> 时间：2012-05-07T23:59:39.753
> 
> 标签：asp.net, c#-4.0

我的代码中出现错误 ProfileCommon can not found 。我不知道如何修复错误。我使用 system.Web.Profile 放置命名空间，但这里仍然存在错误。有人可以帮助如何做到这一点吗？如果你知道，请帮助我。谢谢

```
public partial class UserProfile : System.Web.UI.UserControl
{
    private string _userName = "";
    public string UserName
    {
        get { return _userName; }

        set { _userName = value; }
    }

    protected void Page_Init(object sender, EventArgs e)
    {
        this.Page.RegisterRequiresControlState(this);
    }

    protected override void LoadControlState(object savedState)
    {
        object[] ctlState = (object[])savedState;
        base.LoadControlState(ctlState[0]);
        _userName = (string)ctlState[1];
    }

    protected override object SaveControlState()
    {
        object[] ctlState = new object[2];
        ctlState[0] = base.SaveControlState();
        ctlState[1] = _userName;
        return ctlState;
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!this.IsPostBack)
        {
            // if the UserName property contains an emtpy string, retrieve the profile
            // for the current user, otherwise for the specified user
            ProfileCommon profile = this.Profile;
            if (this.UserName.Length > 0)
                profile = this.Profile.GetProfile(this.UserName);
            txtFirstName.Text = profile.FirstName;
            txtLastName.Text = profile.LastName;
            ddlGenders.SelectedValue = profile.Gender;
            if (profile.BirthDate != DateTime.MinValue)
                txtBirthDate.Text = profile.BirthDate.ToShortDateString();
            ddlOccupations.SelectedValue = profile.Occupation;
            txtWebsite.Text = profile.Website;
            txtStreet.Text = profile.Address.Street;
            txtCity.Text = profile.Address.City;
            txtPostalCode.Text = profile.Address.PostalCode;
            txtState.Text = profile.Address.State;
            txtPhone.Text = profile.Contacts.Phone;
            txtFax.Text = profile.Contacts.Fax;
        }
    }
    public void Save()
    {
        // if the UserName property contains an emtpy string, save the current user's
        // profile, othwerwise save the profile for the specified user
        ProfileCommon profile = this.Profile;
        if (this.UserName.Length > 0)
            profile = this.Profile.GetProfile(this.UserName);
        profile.FirstName = txtFirstName.Text;
        profile.LastName = txtLastName.Text;
        profile.Gender = ddlGenders.SelectedValue;
        if (txtBirthDate.Text.Trim().Length > 0)
            profile.BirthDate = DateTime.Parse(txtBirthDate.Text);
        profile.Occupation = ddlOccupations.SelectedValue;
        profile.Website = txtWebsite.Text;
        profile.Address.Street = txtStreet.Text;
        profile.Address.City = txtCity.Text;
        profile.Address.PostalCode = txtPostalCode.Text;
        profile.Address.State = txtState.Text;
        profile.Contacts.Phone = txtPhone.Text;
        profile.Contacts.Fax = txtFax.Text;
        profile.Save();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T02:17:09.093

正如 Mark 指出的那样，配置文件只能与网站模板一起使用，我已经在博客中介绍了如何使用插件来促进 Web 应用程序项目的配置文件的使用：

[http://www.codersbarn.com/post/2008/07/10/ASPNET-PayPal-Subscriptions-IPN.aspx](http://www.codersbarn.com/post/2008/07/10/ASPNET-PayPal-Subscriptions-IPN.aspx)

可以自己做，这里有一个完整的实现，你可以下载：

[http://leedumond.com/blog/asp-net-profiles-in-web-application-projects/](http://leedumond.com/blog/asp-net-profiles-in-web-application-projects/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T00:12:23.770

根据这些链接（链接[1](http://guyellisrocks.com/coding/type-or-namespace-name-profilecommon-could-not-be-found/)，[链接2](http://forums.asp.net/p/1031740/1432855.aspx)）

> Web 应用程序不支持 ProfileCommon 对象的自动生成

然后第一个链接给出一个[VS Addin](http://archive.msdn.microsoft.com/WebProfileBuilder)的链接以及[如何将其合并到构建过程](http://weblogs.asp.net/joewrobel/archive/2008/02/03/web-profile-builder-for-web-application-projects.aspx)中以解决问题的说明

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-15T11:51:08.697

对于所有只想破解事物的编码人员，有一个非常简单的解决方法。您可以获取 ProfileBase 类型并将配置文件加载到其中，但您会丢失强类型。如果您可以控制配置文件中的数据，或者您确定配置文件中的数据属于某种类型，那么您就可以开始了。

```
 string user = "Steve"; // The username you are trying to get the profile for.
    bool isAuthenticated = false;

        MembershipUser mu = Membership.GetUser(user);

        if (mu != null)
        {
            // User exists - Try to load profile 

            ProfileBase pb = ProfileBase.Create(user, isAuthenticated);

            if (pb != null)
            {
                // Profile loaded - Try to access profile data element.
                // ProfileBase stores data as objects in (I assume) a Dictionary 
                // so you have to cast and check that the cast succeeds.

                string myData = (string)pb["MyKey"];

                if (!string.IsNullOrWhiteSpace(myData))         
                {
                    // Woo-hoo - We're in data city, baby!
                    Console.WriteLine("Is this your card? " + myData + " - Ta Dah!");
                }
            }       
       } 
```

# c - 如何在 Linux 中从 C 中使用 sched_getaffinity 和 sched_setaffinity？

> ID：10490756
> 
> 赞同：18
> 
> 时间：2012-05-07T23:59:47.307
> 
> 标签：c, linux, process, schedule, affinity

我在尝试着：

*   在处理器固定的情况下同时运行 16 个副本（每个内核 2 个副本）

*   在处理器固定（每个内核 2 个副本）的同时运行 8 个副本，并在某些功能（例如功能 1）完成后将处理器内核翻转到最远的内核。

我面临的问题是如何选择最远的处理器。

一些朋友建议使用 sched_getaffinity 和 sched_setaffinity 但我算没有找到任何好的例子。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-30T03:50:20.213

要使用 sched_setaffinity 使当前进程在核心 7 上运行，请执行以下操作：

```
cpu_set_t my_set;        /* Define your cpu_set bit mask. */
CPU_ZERO(&my_set);       /* Initialize it all to 0, i.e. no CPUs selected. */
CPU_SET(7, &my_set);     /* set the bit that represents core 7\. */
sched_setaffinity(0, sizeof(cpu_set_t), &my_set); /* Set affinity of tihs process to */
                                                  /* the defined mask, i.e. only 7\. */ 
```

有关更多信息，请参阅[http://linux.die.net/man/2/sched_setaffinity](http://linux.die.net/man/2/sched_setaffinity)和[http://www.gnu.org/software/libc/manual/html_node/CPU-Affinity.html](http://www.gnu.org/software/libc/manual/html_node/CPU-Affinity.html)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-05-01T13:55:23.837

**最小可运行示例**

在这个例子中，我们获取了affinity，修改它，并检查它是否已经生效[`sched_getcpu()`](https://stackoverflow.com/a/16574301/895245)。

主程序

```
#define _GNU_SOURCE
#include <assert.h>
#include <sched.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

void print_affinity() {
    cpu_set_t mask;
    long nproc, i;

    if (sched_getaffinity(0, sizeof(cpu_set_t), &mask) == -1) {
        perror("sched_getaffinity");
        assert(false);
    }
    nproc = sysconf(_SC_NPROCESSORS_ONLN);
    printf("sched_getaffinity = ");
    for (i = 0; i < nproc; i++) {
        printf("%d ", CPU_ISSET(i, &mask));
    }
    printf("\n");
}

int main(void) {
    cpu_set_t mask;

    print_affinity();
    printf("sched_getcpu = %d\n", sched_getcpu());
    CPU_ZERO(&mask);
    CPU_SET(0, &mask);
    if (sched_setaffinity(0, sizeof(cpu_set_t), &mask) == -1) {
        perror("sched_setaffinity");
        assert(false);
    }
    print_affinity();
    /* TODO is it guaranteed to have taken effect already? Always worked on my tests. */
    printf("sched_getcpu = %d\n", sched_getcpu());
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/linux-kernel-module-cheat/blob/4aff114c4c654014a97ef23b1513dda5409e79f3/userland/linux/sched_getaffinity.c).

编译并运行：

```
gcc -ggdb3 -O0 -std=c99 -Wall -Wextra -pedantic -o main.out main.c
./main.out 
```

样本输出：

```
sched_getaffinity = 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
sched_getcpu = 9
sched_getaffinity = 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
sched_getcpu = 0 
```

意思就是：

*   最初，我的所有 16 个内核都已启用，并且该进程在内核 9（第 10 个）上随机运行
*   在我们将亲和性设置为仅第一个核心后，进程必然移动到核心 0（第一个）

通过以下方式运行此程序也很有趣`taskset`：

```
taskset -c 1,3 ./a.out 
```

这给出了形式的输出：

```
sched_getaffinity = 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 
sched_getcpu = 2
sched_getaffinity = 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
sched_getcpu = 0 
```

所以我们看到它从一开始就限制了亲和力。

这是因为亲和性是由子进程继承的，即`taskset`分叉：[如何防止子分叉进程继承 CPU 亲和性？](https://stackoverflow.com/questions/8336191/how-to-prevent-inheriting-cpu-affinity-by-child-forked-process)

`nproc`默认情况下，请`sched_getaffinity`参见：[How to find out the number of CPUs using python](https://stackoverflow.com/questions/1006289/how-to-find-out-the-number-of-cpus-using-python/55423170#55423170)

**蟒蛇：`os.sched_getaffinity`和`os.sched_setaffinity`**

请参阅：[如何使用 python 找出 CPU 的数量](https://stackoverflow.com/questions/1006289/how-to-find-out-the-number-of-cpus-using-python/55423170#55423170)

在 Ubuntu 16.04 中测试。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-04T16:24:27.213

不要使用 CPU_SETSIZE 作为 sched_[set|get]affinity 的 cpusetsize 参数。这些名称具有误导性，但这是错误的。宏 CPU_SETSIZE 是（引用 man 3 cpu_set）“一个比可以存储在 cpu_set_t 中的最大 CPU 数量大一的值。” 你必须使用

```
sched_setaffinity(0, sizeof(cpu_set_t), &my_set); 
```

反而。

# php - 雅虎财经历史日报数据到mysql日报

> ID：10490758
> 
> 赞同：0
> 
> 时间：2012-05-08T00:00:09.283
> 
> 标签：php, mysql

另一个雅虎财经问题。

我需要一个 php 函数来检查数据库是否是最新的（意味着没有新信息要下载），如果没有下载所需的信息（我已经可以完成这部分）。

我已经拥有的：

我可以手动下载信息。当我说手动时，我的意思是我可以在一天结束时下载它并“手动”调用我的脚本。所以，我不需要帮助。

我需要帮助的是：

```
//Checking if the DB is up-to-date & if not, then update it 
```

如果有帮助，我将从 html 表单中的复选框调用该函数，该复选框将具有复选框更新数据库。这样做是因为它驻留在本地盒子上并且不会一直在线。

但是，如果更容易简单地托管它并通过 cron 作业来完成它，那也是一个考虑因素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:27:56.313

什么决定了数据库是否是最新的？如果是上次更新的时间，那么你需要将上次更新的时间存储在某个地方，然后检查它。如果是数据本身，则需要下载数据进行检查。

设置 cron 作业或计划任务似乎是一个单独的问题。

# r - 水平条形图中边距的自动调整

> ID：10490763
> 
> 赞同：14
> 
> 时间：2012-05-08T00:00:59.267
> 
> 标签：r, labels, margins, string-length

我需要制作一系列水平分组条形图。barplot 函数不会自动调整绘图的边距，因此文本会被截断。

```
 graphics.off()      # close graphics windows
   test <- matrix(c(55,65,30, 40,70,55,75,6,49,45,34,20), 
                  nrow =3 , 
               ncol=4, 
               byrow=TRUE,
               dimnames = list(c("Subgroup 1", "Subgroup 2", "Subgroup 3"),
                               c(
                                 "Category 1 Long text",
                                 "Category 2 very Long text",
                                 "Category 3 short text",
                                 "Category 4 very short text"
                                 )))
  barplot(test, 
       las=2,
       beside = TRUE,
       legend=T,
       horiz=T) 
```

![在此处输入图像描述](../Images/ff40336db11d1214af1b95ec01d6e0ea.png)

我找不到自动将绘图向右移动的选项，就像 R dotchart 函数那样（（SAS中的条形图程序也会自动调整边距）。显然，我总是可以使用 par 函数手动调整边距.

```
 par(mar=c(5.1, 13 ,4.1 ,2.1)) 
```

将情节向右移动

![在此处输入图像描述](../Images/da350ebb2fcbbd99cef58bc1cfb3f7c2.png)

是否可以根据文本的长度自动将绘图向右移动（即调整边距）？

我可以想到 2 个相关的应用程序以编程方式进行：1）计算最长文本字符串的长度并相应地调整左边距 2）为数据创建一个点图，以某种方式捕获边距并在条形图中使用相同的边距.

有更简单的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-08T00:28:39.463

我认为您的第一个想法可能是最合适的。像这样的东西似乎工作正常，不需要太多的东西。

```
ylabels <-  c(  "1oooooooooooo",
            "2",
            "3",
            "4"
)

test <- matrix(c(55,65,30, 40,70,55,75,6,49,45,34,20), 
                  nrow =3 , 
               ncol=4, 
               byrow=TRUE,
               dimnames = list(c("Subgroup 1", "Subgroup 2", "Subgroup 3"),
                               ylabels))

# adjust to the maximum of either the default 
# or a figure based on the maximum length
par(mar=c(5.1, max(4.1,max(nchar(ylabels))/1.8) ,4.1 ,2.1))

barplot(test, 
       las=2,
       beside = TRUE,
       legend=T,
       horiz=T) 
```

检查后`dotchart`，更通用的解决方案也可能是使用：

```
linch <-  max(strwidth(ylabels, "inch")+0.4, na.rm = TRUE)
par(mai=c(1.02,linch,0.82,0.42)) 
```

# actionscript-3 - Flash Builder：移动 AS3 项目还是移动 Flex 项目？

> ID：10490764
> 
> 赞同：1
> 
> 时间：2012-05-08T00:01:06.400
> 
> 标签：actionscript-3, flash, apache-flex, mobile

这个月我开始玩 Flash Builder，因为我没有 Mac 来创建原生 iPhone 应用程序。

我制作了一个 Flex Mobile 项目和一个 AS3 Mobile 项目。两者几乎完全相同，并且我发现操作速度存在很大差异（AS3 版本要快得多）。当我部署项目时，AS3 版本的大小也小于 Flex 版本的大小。

但有一件事让我失望，部署的 AS3 应用程序 (Android) 的大小仍然约为 8MB。我认为这对于一个简单的应用程序来说是相当大的，还是正常的？我没有测试 iOS 版本，因为我不是 Apple Developer 成员（部署带有假证书的 iOS 应用程序是否有技巧）？

我在应用程序中使用的资源：

*   两张图片约。35kb 大小
*   一个 StageWebView

我想知道：

*   当一个简单的应用程序是一个原生应用程序（apk 文件）时，它的平均大小是多少？
*   除了重用的库之外，AS3 应用程序和 Flex 应用程序有什么区别？
*   AS3 应用程序是否转换为 C 或其他语言？
*   为什么 apk 如此庞大（IMO）？
*   部署带有假证书的 iOS 应用程序有技巧吗？（仅用于测试）

感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:21:22.273

> *   当一个简单的应用程序是原生应用程序（apk 文件）时，它的平均大小是多少？

我不知道。当您比较尺寸时；您是否导出了发布版本或调试版本？我的应用程序的完整版；使用 Captive Runtime 为 12MB。这包括所有嵌入的图像。我认为大约 8MB 是嵌入式运行时的大小。当然，如果您不使用 Captive Runtime，那么应用程序会更小；但它会依赖于安装了运行时的用户。

> *   除了使用的库之外，AS3 应用程序和 Flex 应用程序有什么区别？

出于所有意图和目的，什么都没有。Flex 框架将需要执行代码来设置框架等。从理论上讲，这种“影响”被框架带来的价值所抵消。

```
- Is the AS3 app converted to C or other language? 
```

不适用于 Android 或 Playbook。它依赖于 Mobile AIR 运行时——我假设它是以某种方式编写为本机应用程序。对于 iOS，发生了更深入的转换；但没有人知道确切的魔法酱；但它的过程比 Android 或 Playbook 更密集，人们认为您的代码和 AIR 运行时以某种方式转换为 Objective C 而不违反 Apple 许可协议。

> *   为什么 apk 如此庞大（IMO）？

巨大的解释是开放的。没有看到您的完整应用程序代码；很难判断。

> *   部署带有假证书的 iOS 应用程序有技巧吗？（仅用于测试）

我不这么认为；尽管在未锁定的设备上可能存在这种可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T03:03:04.403

当您为 Android 导出时，您可以选择在应用程序中嵌入 air 框架，这样您的用户就不必下载 air。您可以在没有 air embed 的情况下导出应用程序，这将导致应用程序更轻巧，但是您的用户将需要下载 air runtime。 [http://cookbooks.adobe.com/post_How_do_I_create_an_AIR_application_for_Android_tha-19299.html](http://cookbooks.adobe.com/post_How_do_I_create_an_AIR_application_for_Android_tha-19299.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:13:02.570

如果您希望`Mobile AS3 Project`您的应用程序更小并且您的 GUI 主要包含矢量图形，并且`Mobile Flex Project`如果您更喜欢使用与 Flex 框架一起提供的标准 GUI 控件，但由于它附带的控件而增加了大小开销，则您想使用它。

至于其他问题：

*   应用程序的大小在移动平台上是不同的。典型的 iOS 应用程序大约为 2MB - 20MB。这实际上取决于您使用应用程序存储的资源。对您来说重要的是不要在不需要时克服 20MB，因为 20MB 以上的应用程序需要下载 Wi-Fi 连接。（但是，您应该`release`仅按照 www.Flextras.com 的说明导出构建版本）
*   AS3 和 Flex 应用程序之间没有根本区别——它们都编译为在目标移动平台上执行的相同指令。
*   据我所知（我自己是 iOS 开发人员）没有解决方法来部署 iOS 应用程序。您需要使用 Mac 并成为 Apple Developer 才能使用有效证书进行部署。
*   要使您的应用程序更小，请尝试特别注意您添加到项目中的资源。尽管我相信由于框架本身的原因，尺寸如此之大，但在使用 Flash/Flex 编译应用程序时，您希望使用更多矢量图形而不是位图。

# java - 如何将十六进制字符串存储在android的整数变量中？？？

> ID：10490767
> 
> 赞同：2
> 
> 时间：2012-05-08T00:01:43.393
> 
> 标签：java, android, image-processing, rgb

在下面的代码中，intArray[i] 以十六进制格式存储像素的 RGB 值（例如：0xffff0000）...。方法 hsvToRgb() 为 bak 提供了 RGB 的整数值（例如：15777252），但我需要返回 rgb 值更改后的原始十六进制格式。第二行给了我，但它是一个字符串....我该怎么做才能将此字符串值存储回数组中？... 请帮我。

```
 int disco = hsvToRgb(hsv);

       hexColor = String.format("0x%06X", (0xffffff & disco));
       intArray[i] = Integer.valueOf(String.valueOf(disco), 16); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T00:08:45.260

没有“十六进制格式”整数与“十进制格式”整数之类的东西。值的位/字节表示是相同的。例如，十进制值`15,777,252`是十六进制值`0xF0BDE4`。（您可以使用谷歌转换：[搜索“15777252 in hex”](http://www.google.com.au/search?q=15777252+in+hex)）。

您可以`disco`直接使用该值。如果要以十六进制表示形式打印出来，请使用[`Integer.toHexString()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#toHexString%28int%29).

关于格式。可以这样想……计算机将值表示为一系列位。举例来说，让我们选择一个随机数并使用 8 位表示它：`01110101`. 使用位串来表示更大的数字会很快变得很长，因此经常使用十六进制。十六进制等效项是：`65`. 按照惯例，我们通常在值之前是`0x`十六进制的。这给了我们`0x65`。然而，非程序员倾向于以 10 为基数（而不是 16 基数）更自然地处理。以 10 为底的相同数字是`101`。

您可以通过一些代码看到这一点：

```
final int value = 0x65;                            // we can declare it in hex
final int sameValue = 101;                         // or in decimal

System.out.println(value);                         // output in base 10; prints "101"
System.out.println(Integer.toHexString(value));    // output in base 16; prints "65"
System.out.println(Integer.toBinaryString(value)); // output in base 2; prints "1100101"

System.out.println(""+(value == sameValue));       // prints "true" 
```

# delphi - 如何使用 Delphi-Mocks 框架在 Delphi 的子类中使用模拟

> ID：10490776
> 
> 赞同：4
> 
> 时间：2012-05-08T00:02:43.173
> 
> 标签：delphi, mocking, delphi-mocks

好的，我一直在使用优秀的[Delphi-Mocks 框架](https://github.com/VSoftTechnologies/Delphi-Mocks)，只是遇到了一个问题。假设我有以下接口：

```
IDepartment = Interface
   ['{F4915950-8F32-4944-A3B6-8E08F6C38ECC}']
   function getID() : Integer;
   function getName() : String;
   property ID: Integer read getID;
   property Name: String read getName; 
end;

ISale = Interface
   ['{F4915950-8F32-4944-A3B6-8E08F6C38E77}']
   function getAmmount() : Currency;
   function getDepartment() : IDepartment;
   property Ammount: Currency read getAmmount;
   property Department : IDepartment getDepartment;
end; 
```

现在，我正在尝试使用 DUnit 和 Delphi-Mocks 测试 Sale 界面，并按如下方式使用它：

```
procedure TMyTest.Test_Sale_HasDepartment;
var
   mckDepartment : TMock<IDeparment>;
   mckSale : TMock<ISale>;
begin
   mckDepartment := TMock<IDepartment>.Create;
   mckDepartment.Setup.WillReturn('My Department').When.Name;
   mckDepartment.Setup.WillReturn(1).When.ID;

   // Create a sale Mock
   mckSale := TMock<ISale>.Create;
   mckSale.Setup.WillReturn(100).When.Ammount;
   //** Here´s there is where I don´t know how to add a "child mock"** 
   mckSale.Setup.WillReturn(TValue.From<IDepartment>(mckDepartment)).When.Department;

  // What I am trying to get is the following:
  WriteLn(mckSale.Instance.Department.Name); // Should return "My Department" but fails with an AV. 
end; 
```

所以我的问题是：如何将子模拟添加到现有的模拟接口并调用其方法和属性？

谢谢！PS我正在使用Delphi XE2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T02:35:06.500

mckSale.Setup.WillReturnDefault('getDepartment', TValue.From(mckDepartment));

# php - 带有标头的PHP cURL代理？

> ID：10490781
> 
> 赞同：2
> 
> 时间：2012-05-08T00:03:13.497
> 
> 标签：php, image, curl, proxy, header

我正在制作一个 PHP 图像代理脚本。我不仅需要它来回显它请求的图像的内容，而且还需要同样地再现图像请求的标头。

我见过一个，另一个，但不是两者都在一起......这些 cURL 选项让我感到困惑。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T02:47:26.820

抱歉，我不确定你想要什么。

这是从图像 url、echo 标头获取并将图像保存到文件的示例。

但是，如果你想要一个代理，你应该使用网络服务器（Nginx、Apache 等），不需要 PHP

```
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://img3.cache.netease.com/www/logo/logo_png.png");
curl_setopt($ch, CURLOPT_HEADER, 1);
curl_setopt($ch, CURLOPT_REFERER, "http://www.163.com/");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_BINARYTRANSFER, 1);
$return = curl_exec($ch);
curl_close($ch);

list($header, $image) = explode("\r\n\r\n", $return, 2);

echo $header;

file_put_contents("/tmp/logo.png", $image); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T01:02:44.797

您可以使用以下方式获取所有标题（不是原始文本）`getallheaders()`

*   [http://www.php.net/manual/en/function.getallheaders.php](http://www.php.net/manual/en/function.getallheaders.php)

然后将它们串在一起：

```
$headers = "";
foreach (getallheaders() as $name => $value) {
    $headers = "$name: $value\r\n";
}
$headers .= "\r\n"; // Double newline to signal end of headers (HTTP spec) 
```

然后我认为最好的方法是使用套接字连接，而不是像这样的 CURL：

```
$response = '';
$fp = fsockopen('example.org', 80);
fputs($fp, $headers);
while (!feof($fp)) {
    $response .= fgets($fp, 128);
}
fclose($fp); 
```

请注意，您可能需要修改主机/请求标头（因为这是一个相同的副本，正如您所要求的那样），并且您可能需要实现重定向跟踪。

# apache-commons - encodeBase64URLSafeString 和 encodeBase64URLSafe 的区别

> ID：10490782
> 
> 赞同：1
> 
> 时间：2012-05-08T00:03:24.090
> 
> 标签：apache-commons

我想知道以下两个函数之间的实际区别是什么： encodeBase64URLSafeString encodeBase64URLSafe

apache文档说不同之处在于 encodeBase64URLSafe 不会将输出分块，而 encodeBase64URLSafeString 会！但是，这是什么意思 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T04:12:56.343

分块只是在每 ~74 个字符后添加一个换行符（因此它可以用于电子邮件）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-12T15:19:34.713

返回类型不同：

```
public static byte[]  [More ...] encodeBase64URLSafe(byte[] binaryData) {
    return encodeBase64(binaryData, false, true);
}

public static String  [More ...] encodeBase64URLSafeString(byte[] binaryData) {
    return StringUtils.newStringUtf8(encodeBase64(binaryData, false, true));
} 
```

你的意思是分块和非分块有什么区别，你的问题不是很清楚......

# c# - 鼠标移动速度

> ID：10490785
> 
> 赞同：2
> 
> 时间：2012-05-08T00:03:52.410
> 
> 标签：c#, mouseevent, mousemove

> **可能的重复：**
> [C# 真实地移动鼠标](https://stackoverflow.com/questions/913646/c-sharp-moving-the-mouse-around-realistically)

我可以将鼠标移动为：

```
[DllImport("user32.dll")]
public static extern void mouse_event(int dwFlags, int dx, int dy, int dwData, int dwExtraInfo);

// move relative from where the cursor is
public static void Move(int xDelta, int yDelta)
{

    mouse_event(0x0001, xDelta, yDelta, 0, 0);
} 
```

无论如何，我想平滑地移动鼠标，以便用户可以看到它。我想为它制作动画并花 1 秒时间将其移动到新位置。因此，我正在寻找一种可以用作以下方法的方法：

```
 public static void Move(int xDelta, int yDelta, int timeInMiliseconds)
 {
    // i will like to move the mouse to 
         (mouse.getCurentPos().x+xDelta, mouse.getCurentPos().y+yDelta) 
    // in timeInMiliseconds miliseconds

 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:12:59.670

**编辑**以支持负增量。

这是流畅且无需额外调用的完美组合`mouse_event`。

```
public static void Move(int xDelta, int yDelta, int timeInMilliseconds, bool async = false)
{
    // No need to move the mouse at all.
    if (xDelta == 0 && yDelta == 0) return;

    // No need to move smoothly.
    if (timeInMilliseconds <= 0)
    {
        Move(xDelta, yDelta);
        return;
    }

    // Set direction factors and then make the delta's positive
    var xFactor = 1;
    var yFactor = 1;

    if (xDelta < 0)
    {
        xDelta *= (xFactor = -1);
    }

    if (yDelta < 0)
    {
        yDelta *= (yFactor = -1);
    }

    // Calculate the rates of a single x or y movement, in milliseconds
    // And avoid dividing by zero
    var xRate = xDelta == 0 ? -1 : (double)timeInMilliseconds / xDelta;
    var yRate = yDelta == 0 ? -1 : (double)timeInMilliseconds / yDelta;

    // Make a thread that will move the mouse in the x direction
    var xThread = new Thread(() =>
    {
        // No need to move in the x direction
        if (xDelta == 0) return;

        var sw = Stopwatch.StartNew();
        var c = 1;

        for (var i = 0; i < xDelta; i++)
        {
            // Wait for another "rate" amount of time to pass
            while (sw.ElapsedMilliseconds / xRate < c)
            {
            }

            c++;

            // Move by a single pixel (x)
            Move(xFactor, 0);
        }
    });

    // Make a thread that will move the mouse in the y direction
    var yThread = new Thread(() =>
    {
        // No need to move in the y direction
        if (yDelta == 0) return;

        var sw = Stopwatch.StartNew();
        var c = 1;

        for (var i = 0; i < yDelta; i++)
        {
            // Wait for another "rate" amount of time to pass
            while (sw.ElapsedMilliseconds / yRate < c)
            {
            }

            c++;

            // Move by a single pixel (y)
            Move(0, yFactor);
        }
    });

    // Activate the movers threads
    xThread.Start();
    yThread.Start();

    if (async)
    {
        return;
    }

    // Wait for both to end (remove this if you want it async)
    xThread.Join();
    yThread.Join();
} 
```

# android - 使用 OAuth 协议的浏览器不需要的行为

> ID：10490786
> 
> 赞同：1
> 
> 时间：2012-05-08T00:03:58.847
> 
> 标签：android, android-activity

所以我有一个使用 OAuth 协议进行授权操作的软件。在主菜单中，我有一个启动活动的按钮：

```
Intent i = new Intent(this, HattrickOAuth.class);
this.startActivityForResult(i,OAUTH_ID); 
```

在**HattrickOAuth**`onCreate(Bundle savedInstanceState)`类的方法中，我们需要启动浏览器将用户重定向到授权页面。我用：

 **```
Intent browser = new Intent(Intent.ACTION_VIEW, Uri.parse(authUrl));                    browser.addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);
browser.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
this.startActivity(browser); 
```

在 onResume() 中，我完成了授权并返回结果调用

```
setResult(RESULT_OK);
finish(); 
```

问题是这会回到浏览器而不是菜单上。有什么我想念的吗？要返回，我在清单中使用以下**方案：**

```
<activity
    android:label="@string/oauth_name"
    android:name=".hattrick.HattrickOAuth"
    android:theme="@style/MainStyle" >
    <intent-filter >
        <action android:name="android.intent.action.VIEW" />

        <category android:name="android.intent.category.DEFAULT" />
        <category android:name="android.intent.category.BROWSABLE" />

        <data
            android:host="hattrick"
            android:scheme="h4m-app" />
    </intent-filter>
</activity> 
```**

# java - AsyncTask 正在抛出 InvocationTargetException

> ID：10490789
> 
> 赞同：2
> 
> 时间：2012-05-08T00:04:11.217
> 
> 标签：java, android

我有一个使用 AsyncTask 的简单 Activity

```
EditText txt;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder()
            .detectNetwork().permitAll().build();
    StrictMode.setThreadPolicy(policy);

    txt = (EditText) findViewById(R.id.edit_message);
    setContentView(R.layout.main);
}
public void connectToNetwork(View view)
{
    String address = "https://www.google.com";
        new DownloadWebpageText().execute(address);

}
private class DownloadWebpageText extends AsyncTask<String, Void, String>
{
    @Override
    protected String doInBackground(String... params)
      {
       return params[0] + ",Some thing";

      }

   @Override
   protected void onPostExecute(String result)
      {
       txt.setText(result); //this is an EditText

      }

} 
```

为了简洁起见，我简化了代码，但是它抛出了 InvocationTargetException 并且没有执行 onPostExecute 方法。调试时我无法理解任何内容。有什么帮助吗？

Logcat 错误：

```
05-08 00:16:44.045: E/AndroidRuntime(537): FATAL EXCEPTION: main
05-08 00:16:44.045: E/AndroidRuntime(537): java.lang.NullPointerException
05-08 00:16:44.045: E/AndroidRuntime(537):  at myApp.src.MyAppActivity$DownloadWebpageText.onPostExecute(MyAppActivity.java:162)
05-08 00:16:44.045: E/AndroidRuntime(537):  at myApp.src.MyAppActivity$DownloadWebpageText.onPostExecute(MyAppActivity.java:1)
05-08 00:16:44.045: E/AndroidRuntime(537):  at android.os.AsyncTask.finish(AsyncTask.java:602)
05-08 00:16:44.045: E/AndroidRuntime(537):  at android.os.AsyncTask.access$600(AsyncTask.java:156)
05-08 00:16:44.045: E/AndroidRuntime(537):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:615)
05-08 00:16:44.045: E/AndroidRuntime(537):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-08 00:16:44.045: E/AndroidRuntime(537):  at android.os.Looper.loop(Looper.java:137)
05-08 00:16:44.045: E/AndroidRuntime(537):  at android.app.ActivityThread.main(ActivityThread.java:4424)
05-08 00:16:44.045: E/AndroidRuntime(537):  at java.lang.reflect.Method.invokeNative(Native Method)
05-08 00:16:44.045: E/AndroidRuntime(537):  at java.lang.reflect.Method.invoke(Method.java:511)
05-08 00:16:44.045: E/AndroidRuntime(537):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-08 00:16:44.045: E/AndroidRuntime(537):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-08 00:16:44.045: E/AndroidRuntime(537):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:49:47.783

您不需要设置内容视图然后查找视图吗？

```
setContentView(R.layout.main);
txt = (EditText) findViewById(R.id.edit_message); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T00:24:22.383

鉴于您`NullPointerException`来自 ( `onPostExecute()`) 的位置，`txt`显然是`null`.

# css - 我发现 css 布局非常不直观；我可以使用一个好的拖放工具吗？

> ID：10490798
> 
> 赞同：1
> 
> 时间：2012-05-08T00:05:27.833
> 
> 标签：css, user-interface, layout

我发现 css 布局非常不直观；表格布局更有意义，但不受欢迎。是否有一篇好的简单文章或拖放工具可以让我一劳永逸地为我澄清这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:28:34.577

[Artisteer](http://www.artisteer.com/)不一定是所见即所得的 CSS 编辑器，而是一个可以生成非常好的 CSS 的好模板工具

除此之外，一如既往，熟能生巧。我花了一段时间从基于表格的布局过渡到基于 CSS 的布局，但值得付出努力。我的 HTML 现在精简了很多。重新设计要容易得多，因为 HTML 与页面/站点的视觉设计几乎没有任何关系。在此期间，有许多混合使用表格和 CSS 的混合设计，但有时仍然需要表格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T15:35:03.197

我不喜欢它，但总是有[Adob​​e Muse](http://www.adobe.com/products/muse.html) ...

帮自己一个大忙，然后学习 CSS！

# php - 如何实现实时表单编辑，如 Google Docs

> ID：10490799
> 
> 赞同：3
> 
> 时间：2012-05-08T00:05:38.737
> 
> 标签：php, javascript, mysql, ajax, jquery

我正在尝试将 Google Docs 具有的实时协作功能添加到 HTML 中的可编辑文本区域。例如，这将允许 2 或 3 个用户可以协作编辑同一个文本区域。一个人将如何解决这个问题，或者是否有一个可以使用的 JavaScript 库？（我使用 PHP、mySQL 和 JavaScript/AJAX/jQuery）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-08T00:16:01.023

为了促进多个 Web 客户端之间的实时更新，您需要使用一种技术，通过使用 Comet 或 Websockets 解决方案来利用 Web 的请求/响应周期。

要保持 textarea 更新，您需要从所有 3 个客户端建立到服务器的长期 HTTP 连接或 Websocket 连接。每个 textarea 都需要一个 keyup 或 keypress 处理程序，当被调用时，将字符通过流发送到服务器。当您的服务器检索此数据时，它需要向其他 2 个连接的客户端返回响应。

然后需要通过使用最新数据更新 textarea 的 value 属性来处理响应。

我看到你正在使用 PHP，我知道它支持彗星。您需要设置 comet（或 Websockets）才能实现这样的解决方案。

话虽如此，更基本的替代方法是使用轮询来达到预期的效果。这将涉及所有 3 个客户端定期向服务器发出请求以检索更新。可以想象，轮询速度越快，应用程序的实时性就越高。但是，轮询速度越快，您的应用程序就会消耗更多的带宽和资源。

对于 3 个客户端，这可能是可行的，但对于任何涉及大量使用的严肃应用程序，您肯定会想要研究 Websockets 或 Comet。

要回答有关 JavaScript 库的问题，请查看[Dojo Cometd](http://dojotoolkit.org/reference-guide/1.7/dojox/cometd.html)库以获取客户端的 Comet 解决方案。

# c# - 将鼠标光标绑定到 WPF 中的按钮属性

> ID：10490800
> 
> 赞同：1
> 
> 时间：2012-05-08T00:05:41.253
> 
> 标签：c#, wpf, binding

我有一个按钮需要很长时间才能完成其功能，并且由于长时间等待（5 秒），该应用程序似乎已停止。因此，在我放置了长时间运行的函数之前，在我放置`Cursor = Cursors.Wait`了函数之后`Cursor = Cursors.Arrow`，一切正常。

但我认为这是一种非常糟糕的方式来做这样的事情。

这就是为什么我想知道是否可以将光标绑定到按钮的属性，以便在按钮执行其功能时光标会发生变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-04-20T14:30:52.280

好吧，六年后。1\. 看看 async-await 构造，它很简单，你的硬任务将在非 UI 线程中执行。2\. 由于您逐步完成了前一个，您可以将一些 bool 属性放入您的模型中，例如`actionExecuting`在您完成任务之前/之后设置/取消设置它。然后在视图中，您可以将`Cursor`主容器的属性绑定到`actionExecuting`. 要制作这个技巧，您需要实现`IValueConverter`. 例如（查看命名空间）：

```
namespace YourApp.Util.Converters
{
    [ValueConversion(typeof(bool), typeof(Cursor))]
    public class BoolToCursorConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter,
            System.Globalization.CultureInfo culture)
        {
            var val = (bool)value;
            if (val)
                return Cursors.WaitCursor;
            return Cursors.Arrow;
        }

        public object ConvertBack(object value, Type targetType, object parameter,
            System.Globalization.CultureInfo culture)
        {
            throw new NotSupportedException();
        }
    }
} 
```

然后，您要添加此转换器以`Window.Resources`在您的资源字典中查看，例如：

```
<Window x:Class="YourApp.MainWindow"
        <!-- other namespaces -->
        xmlns:c="clr-namespace:YourApp.Util.Converters">

<Window.Resources>
        <c:BoolToCursorConverter x:Key="BoolToCursorConverter"></c:BoolToCursorConverter>
    </Window.Resources> 
```

而且你可以像使用它一样

```
<Grid Cursor="{Binding actionExecuting, Converter={StaticResource BoolToCursorConverter}}"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T00:10:33.077

为什么不使用后台工作人员来执行长时间运行的功能（可能是生产/消费者模式）？在我看来，这是最好的方式。您还可以通过进度条通知用户他的请求状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T01:26:11.960

我能想到的最简单的事情是创建一个实现 IDisposable 的类并在构造函数中更改等待光标，然后在 Dispose 方法中将其恢复。这确保如果在它包装的代码正在执行时引发异常，则光标不会作为等待光标卡住......

```
public class WaitCursor : IDisposable
{
    private Cursor m_defaultCursor = null;
    public WaitCursor()
    {
        m_defaultCursor = Cursors.Current;
        Cursors.Current = Cursors.WaitCursor;
        Application.UseWaitCursor = true;
    }

    public void Dispose()
    {
        Cursors.Current = m_defaultCursor;
        Application.UseWaitCursor = false;
    }
} 
```

然后你可以用 using 语句包装你长时间运行的代码......

```
using (var waitCursor = new WaitCursor())
{
    // some long running code...
} 
```

这让未来的开发人员清楚地知道，打包的代码也可能需要一段时间

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T03:51:17.977

理论上，您可以在某处创建一个依赖属性，该属性在按钮状态更改时设置鼠标光标。但是，如果您确实在按钮单击处理程序内部进行工作，则它不太可能做任何事情，因为您的 UI 线程需要调度依赖对象以更新。此外，如果您阻塞 UI 线程，则在任务完成之前，您不会在视觉上看到按钮“松开”。另外，您如何将它绑定到一个打开的、可能正在更改的按钮集？这听起来不是一个令人满意的解决方案。

我认为在 WPF 应用程序中处理此类场景的最佳方法是在后台线程（或线程池）中运行长时间运行的任务，当它完成时会将其结果发布回 UI 线程。发生这种情况时，您可以同时保持 UI 完全交互，或者使用等待光标（并明确禁用您的 UI），或者使用“正在进行的工作，请等待 [取消按钮]”对话框阻止它，如果你想给一个取消选项。

在后台线程中执行操作也有助于让您的 WPF 应用程序窗口响应窗口管理操作，例如移动/最小化/最大化。

# c# - LINQ to XML - 按父元素分组

> ID：10490801
> 
> 赞同：0
> 
> 时间：2012-05-08T00:05:42.357
> 
> 标签：c#, web-services, linq-to-xml

这是我第一次使用 LINQ to XML，请多多包涵。我正在解析 Web 服务生成的 XML 文件，以便将值插入 SQL Server。XML 数据如下所示：

```
...
    <row>
        <value>912EOE01L0K0</value>
        <value>4369     </value>
        <value>PTO   </value>
        <value>PTO03 </value>
        <value>3 Days PTO     </value>
        <value>1</value>
        <value>0</value>
        <value>0</value>
        <value>1</value>
        <value>0</value>
        <value>0</value>
        <value>7.36</value>
        <value>0</value>
        <value>0</value>
    </row>
    <row>
        <value>912EOE01L0K0</value>
        <value>4369     </value>
        <value>SICK  </value>
        <value>SCK07 </value>
        <value>7 Sick Days    </value>
        <value>2.34</value>
        <value>0</value>
        <value>0</value>
        <value>2.34</value>
        <value>0</value>
        <value>0</value>
        <value>35.979999</value>
        <value>0</value>
        <value>0</value>
    </row>
... 
```

进行解析的 C# 类需要是动态的，以处理每行中可变数量的行和值，尽管我确实知道一旦开始解析，每行中将有多少值。我想将一行中的所有值分组（透视？）到一个对象中，如果可能的话，字符串和逗号分隔。我知道我可以通过将所有值拉到一个列表中来做到这一点，然后遍历它们并将每个 X 分组到一个“行”对象中，其中 X 是每行中的值的数量，但感觉应该有更多LINQ-y 的方式来做到这一点。是否有针对每一行的 LINQ 查询，将所有值分组到一个对象中？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:17:54.960

这是一个很棒的 Linq-to-Xml 应用程序。将 XML 加载到 XDocument 中后，您可以这样编写：

```
XDocument MyXDoc;
// TODO, load or parse MyXDoc

string[] CsvList = MyXDoc.Root.Elements("row")
    .Select(row => 
        String.Join(", ", row.Elements("value").Select(val => (string)val).ToArray() )
     )
    .ToArray(); 
```

This will give you an array of each row with the values represented as a CSV string.

# ruby-on-rails - 为什么我的 Rails 应用程序每次都重新加载 application.html.erb

> ID：10490805
> 
> 赞同：0
> 
> 时间：2012-05-08T00:06:16.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个提供静态内容的 Rails 应用程序（目前）。

每次我更改视图时，它都会重新加载 application.html.erb 内容，这会使页眉和页脚闪烁并且看起来很难看。

我有另一个不这样做的 Rails 应用程序。我不清楚该机制是如何工作的，可能是对单个视图内容的某种 ajax 调用。

我的 route.rb 如下

```
Zode64::Application.routes.draw do

  get "contact/index"
  get "about/index"
  get "home/index"

  root :to => 'home#index'

  match "home" => "home#index"
  match "about" => "about#index"
  match "contact" => "contact#index"
end 
```

我的链接是这样的

```
<li><%= link_to "home", "home" %></li> 
```

我遇到问题的应用程序在这里[http://www.zode64.com](http://www.zode64.com)我看到 application.html.erb 没有加载的应用程序在这里[http://whatsthebeef.org/blog](http://whatsthebeef.org/blog)。

我需要做些什么来防止这种闪烁？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:18:44.783

不，只有你。闪烁是浏览器呈现页面的方式、互联网连接或应用程序/服务器的响应时间。（鉴于您注意到两者之间的差异，它可能不是第一个。）

两个站点上都没有加载 AJAX 页面，它们都完全呈现页面并将页面发送到每个请求的浏览器。

例如，我在*两个*站点上都几乎看不到闪烁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T07:17:44.773

它也是一个缓存问题。如果您的图像和网页被缓存，您不需要从服务器重新加载整个页面，而是从您的硬盘驱动器。闪烁确实来自加载时间的差异。

一个糟糕的选择是为您的布局结构使用框架。

但是，只要您相信访问者激活了 Javascript，使用 Ajax 可能是一个可行的解决方案。

# python - 动态生成列表名称时迭代列表

> ID：10490807
> 
> 赞同：0
> 
> 时间：2012-05-08T00:06:30.180
> 
> 标签：python

如何遍历名称将动态生成的列表？

```
boneList_head =['def_neck', 'def_armbase']#hard coded list
itemType='head'# result of a user button press
...
def selectBones():
    global itemType
    bones =('boneList_'+itemType)# evaluates as a string , not name of a list
    for bone in bones:
        cmds.select(bone, tgl=True) 
```

问题是当我需要它作为列表名称进行评估时，*骨骼被评估为字符串。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T00:10:44.037

动态生成变量名几乎总是一种不好的方法。使用字典！

```
bonedict = {'boneList_head': ['def_neck', 'def_armbase']}
itemType='head'

def selectBones(itemType):
    bones = bonedict['boneList_' + itemType]
    for bone in bones:
        cmds.select(bone, tgl=True) 
```

请忽略我之前的答案（在我的编辑历史中可见），这是愚蠢的——甚至是愚蠢的。但我将其愚蠢归咎于动态变量名称生成！

让我详细说明为什么动态变量名称生成是一个坏主意。

1.  因为动态变量生成掩盖了变量名称定义。很难分辨哪些已定义，哪些未定义，因此很容易意外地重新定义变量。这是潜在错误的主要来源。

2.  因为动态变量操作将状态变化隐藏在另一层混淆之下。在某种程度上，无论何时创建字典或列表都是如此。但是人们*希望*列表和字典需要一些额外的思考。另一方面，变量名应该非常简单。当变量定义和重新定义需要深入思考才能理解时，就会出现问题。

3.  因为动态变量生成会污染命名空间。如果你有这么多变量，你必须自动生成它们，那么它们应该存在于自己的命名空间中，而不是在函数的局部变量中，*绝对*不是在全局命名空间中。在他的 linux 内核风格指南中，Linus Torvalds 建议如果一个函数有超过 5-10 个局部变量，[那么你做错了什么](https://computing.llnl.gov/linux/slurm/coding_style.pdf)。

4.  因为动态变量生成会导致[高耦合](http://en.wikipedia.org/wiki/Coupling_(computer_programming))，这是一件坏事。如果您将值分配给字典，则可以来回传递该字典，直到奶牛回家，而任何人都只需要知道该字典。如果您在模块的全局命名空间中动态创建变量名，那么如果另一个模块想要访问这些变量名，它必须知道它们的生成方式、该模块中定义了哪些其他变量等等。此外，传递变量变得更加复杂——您必须传递对模块本身的引用，可能使用`sys.modules`或其他有问题的构造。

5.  因为动态变量生成是丑陋的。`eval`看起来干净整洁，但实际上并非如此。它可以做*任何事情*。可以做任何事情的函数是不好的，因为你无法一眼看出它们在*这里*做什么。定义明确的函数只做一件事，而且做得很好；这样，每当您看到该功能时，您就可以确切地知道发生了什么。当您看到时`eval`，实际上*任何事情*都可能发生。从这个意义上说，`eval`就像`goto`。[问题](https://stackoverflow.com/questions/46586/goto-still-considered-harmful)不`goto`在于您无法正确使用它；就是为了每一种可能的正确使用`goto`，有 500,000,000 种可怕的错误使用方法。我什至不会在这里讨论安全问题，因为归根结底，这不是`eval`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T00:21:14.473

我同意其他评论，即您的方法可能不是最好的。但以下应该有效：

```
bones = eval('boneList_' + itemType) 
```

这将在“boneList_head”上运行 python 解释器，并返回列表。

注意：正如 Adam Mihalcin 在评论中提到的，您应该非常小心，只对您信任或已验证的数据运行 eval。恶意用户可以将任意代码注入 itemType 变量以访问操作系统等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:16:21.957

这是一个丑陋的黑客，但它有效......（当然，你需要得到正确的模块）

```
import sys
boneList_head =['def_neck', 'def_armbase']
itemType='head'
...
def selectBones():
    global itemType
    bones=vars(sys.modules["__main__"])['boneList_'+itemType]
    for bone in bones:
        cmds.select(bone, tgl=True) 
```

但是，这确实与其他人所说的没有什么不同-我们正在使用`vars`构建字典来获取所需的列表-为什么不首先将字典（或正确的列表）传递给函数 selectBones地方？

# sql - 显示 SQL Server 中将发生的所有错误

> ID：10490811
> 
> 赞同：0
> 
> 时间：2012-05-08T00:07:19.817
> 
> 标签：sql, sql-server, sql-server-2008

我有一个巨大的批量插入导致错误：

```
DECLARE @row_terminator CHAR;
SET @row_terminator = CHAR(10); -- or char(10)

DECLARE @stmt NVARCHAR(2000);

SET @stmt = '
  BULK INSERT accn_billed_procedures
   FROM ''F:\2011-Dec\accn_billed_procedures_201112062112.txt.gz''
   WITH 
      (
        firstrow=2,
FIELDTERMINATOR = ''|''  ,
ROWS_PER_BATCH=10000
   ,ROWTERMINATOR='''+@row_terminator+'''
   )'
exec sp_executesql @stmt;
SET @stmt = '
  BULK INSERT accn_billed_procedures
   FROM ''F:\2011-Dec\accn_billed_procedures_201112072112.txt.gz''
   WITH 
      (
        firstrow=2,
FIELDTERMINATOR = ''|''  ,
ROWS_PER_BATCH=10000
   ,ROWTERMINATOR='''+@row_terminator+'''
   )'
exec sp_executesql @stmt;
SET @stmt = '
  BULK INSERT accn_billed_procedures
   FROM ''F:\2011-Dec\accn_billed_procedures_201112082112.txt.gz''
   WITH 
      (
        firstrow=2,
FIELDTERMINATOR = ''|''  ,
ROWS_PER_BATCH=10000
   ,ROWTERMINATOR='''+@row_terminator+'''
   )'
exec sp_executesql @stmt;
SET @stmt = '
  BULK INSERT accn_billed_procedures
   FROM ''F:\2011-Dec\accn_billed_procedures_201112092112.txt.gz''
   WITH 
      (
        firstrow=2,
FIELDTERMINATOR = ''|''  ,
ROWS_PER_BATCH=10000
   ,ROWTERMINATOR='''+@row_terminator+'''
   )'
exec sp_executesql @stmt;
SET @stmt = '
  BULK INSERT accn_billed_procedures
   FROM ''F:\2011-Dec\accn_billed_procedures_201112102112.txt.gz''
   WITH 
      (
        firstrow=2,
FIELDTERMINATOR = ''|''  ,
ROWS_PER_BATCH=10000
   ,ROWTERMINATOR='''+@row_terminator+'''
   )'
exec sp_executesql @stmt; 
```

我想知道导致的所有错误（或至少很多错误）。

如果它需要我运行所有内容以获取错误列表，对我来说并不重要。

**我只想知道是否可以显示 sql 语句将在 sql server 2008 中生成的所有错误？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T01:33:05.553

[http://msdn.microsoft.com/en-us/library/ms175976.aspx](http://msdn.microsoft.com/en-us/library/ms175976.aspx)

```
BEGIN TRY
    -- Table does not exist; object name resolution
    -- error not caught.
    SELECT * FROM NonexistentTable;
END TRY
BEGIN CATCH
    SELECT 
        ERROR_NUMBER() AS ErrorNumber
        ,ERROR_MESSAGE() AS ErrorMessage;
END CATCH 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:25:10.363

`BULK INSERT`有一个 ERRORFILE 参数。( [http://msdn.microsoft.com/en-us/library/ms188365.aspx](http://msdn.microsoft.com/en-us/library/ms188365.aspx) )

# .net - 如何 wcf 服务可以发现其他正在运行的服务

> ID：10490815
> 
> 赞同：1
> 
> 时间：2012-05-08T00:07:55.553
> 
> 标签：.net, wcf, c#-4.0, named-pipes

我想创建这样的服务。当一个服务启动时，它可以在同一台机器上找到其他正在运行的服务，比如 p2p。我想使用 WCF 的 NetNamedPipeBinding。

以及，如何实施？

**更新'** 我试试这个。

开始服务'

```
 private void ActionInitService()
    {
        try
        {
            _host = new ServiceHost(this, new Uri(ADDRESS_PIPE_BASE));

            var binding = new NetNamedPipeBinding();
            _host.AddServiceEndpoint((typeof (IClientService)), binding, Address.ToString());
            // ** DISCOVERY ** //
            _host.Description.Behaviors.Add(new ServiceDiscoveryBehavior());
            _host.AddServiceEndpoint(new DiscoveryEndpoint(binding, new EndpointAddress(ADDRESS_PIPE_BASE)));
        }
        catch (Exception ex)
        {
            Debug.WriteLine("exp: " + ex);
        }
    } 
```

寻找服务'

```
public ObservableCollection<string> FindRunningClient()
    {
        var endpoints = new ObservableCollection<string>();
        try
        {
            var binding = new NetNamedPipeBinding();
            var address = new EndpointAddress(ADDRESS_PIPE_BASE);
            var discoveryClient = new DiscoveryClient(new DiscoveryEndpoint(binding, address));

            FindResponse rk2Clients = discoveryClient.Find(new FindCriteria(typeof(IClientService)));

            discoveryClient.Close();

            if (rk2Clients.Endpoints.Count != 0)
            {
                foreach (EndpointDiscoveryMetadata endpoint in rk2Clients.Endpoints)
                {
                    endpoints.Add(endpoint.Address.ToString());
                }
            }

            return endpoints;
        }
        catch (Exception e)
        {
            return endpoints;
        }
    } 
```

但问题是，它只能找到第一个启动的服务。我能做些什么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:11:26.860

查看[WCF 发现协议](http://msdn.microsoft.com/en-us/library/dd456782.aspx)。

# python - 如何使用 Unicode 编码创建临时文件？

> ID：10490816
> 
> 赞同：20
> 
> 时间：2012-05-08T00:08:06.630
> 
> 标签：python, unicode, temporary-files

当我`open()`用来打开文件时，我无法编写 unicode 字符串。我了解到我需要使用`codecs`和打开带有 Unicode 编码的文件（请参阅[http://docs.python.org/howto/unicode.html#reading-and-writing-unicode-data](http://docs.python.org/howto/unicode.html#reading-and-writing-unicode-data)）。

现在我需要创建一些临时文件。我尝试使用该`tempfile`库，但它没有任何编码选项。当我尝试在临时文件中写入任何 unicode 字符串时`tempfile`，它会失败：

```
#!/usr/bin/python2.6
# -*- coding: utf-8 -*-
import tempfile
with tempfile.TemporaryFile() as fh:
  fh.write(u"Hello World: ä")
  fh.seek(0)
  for line in fh:
    print line 
```

如何在 Python 中使用 Unicode 编码创建临时文件？

编辑：

1.  我正在使用 Linux，我收到的此代码的错误消息是：

    ```
    Traceback (most recent call last):
      File "tmp_file.py", line 5, in <module>
        fh.write(u"Hello World: ä")
    UnicodeEncodeError: 'ascii' codec can't encode character u'\xe4' in position 13: ordinal not in range(128) 
    ```

2.  这只是一个例子。在实践中，我正在尝试编写一些 API 返回的字符串。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-08T00:59:29.517

其他人的答案都是正确的，我只想澄清发生了什么：

`'foo'`字面量和字面量的区别在于`u'foo'`前者是字节串，后者是Unicode对象。

首先，了解Unicode是字符集。UTF-8 是编码。Unicode 对象与前者有关——它是一个 Unicode 字符串，不一定是 UTF-8 字符串。在您的情况下，字符串文字的编码将是 UTF-8，因为您在文件的第一行中指定了它。

要从字节字符串中获取 Unicode 字符串，请调用以下`.encode()`方法：

```
>>>> u"ひらがな".encode("utf-8") == "ひらがな"
True 
```

同样，您可以在调用中调用您的 string.encode`write`并达到与仅删除`u`.

如果您没有在顶部指定编码，假设您正在从另一个文件读取 Unicode 数据，那么您将指定它在到达 Python 字符串之前的编码。这将决定它如何以字节表示（即`str`类型）。

那么，您得到的错误仅仅是因为`tempfile`模块需要一个`str`对象。这***并不***意味着它不能处理 unicode，只是它希望您传入一个字节字符串而不是 Unicode 对象——因为如果不指定编码，它就不会知道如何将其写入临时文件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-05-07T13:31:06.007

tempfile.TemporaryFile[在 Python 3 中具有编码选项](https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryFile)：

```
#!/usr/bin/python3
# -*- coding: utf-8 -*-
import tempfile
with tempfile.TemporaryFile(mode='w+', encoding='utf-8') as fh:
  fh.write("Hello World: ä")
  fh.seek(0)
  for line in fh:
    print(line) 
```

请注意，现在您需要指定 mode='w+' 而不是默认的二进制模式。另请注意，字符串文字在 Python 3 中是隐式的 Unicode，没有*u*修饰符。

如果你坚持使用[Python 2.6，临时文件](https://docs.python.org/2.6/library/tempfile.html#tempfile.TemporaryFile)总是二进制的，你需要在将 Unicode 字符串写入文件之前对其进行编码：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-
import tempfile
with tempfile.TemporaryFile() as fh:
  fh.write(u"Hello World: ä".encode('utf-8'))
  fh.seek(0)
  for line in fh:
    print line.decode('utf-8') 
```

Unicode 指定字符集，而不是编码，因此无论哪种情况，您都需要一种方法来指定如何对 Unicode 字符进行编码！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-20T10:31:24.487

由于我正在使用应该在 Python 2 和 Python 3 中运行的 TemporaryFile 对象的 Python 程序，因此我发现手动编码所有编写为 UTF-8 的字符串并不令人满意，就像其他答案所暗示的那样。

相反，我编写了以下小的 polyfill（因为我在六个中找不到类似的东西）来将二进制文件类对象包装成一个 UTF-8 文件类对象：

```
from __future__ import unicode_literals
import sys
import codecs
if sys.hexversion < 0x03000000:
    def uwriter(fp):
        return codecs.getwriter('utf-8')(fp)
else:
    def uwriter(fp):
        return fp 
```

它以下列方式使用：

```
# encoding: utf-8
from tempfile import NamedTemporaryFile
with uwriter(NamedTemporaryFile(suffix='.txt', mode='w')) as fp:
    fp.write('Hællo wörld!\n') 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-08T00:14:19.447

我想出了一个解决方案：创建一个不会自动删除的临时文件`tempfile`，关闭它并使用以下命令再次打开它`codecs`：

```
#!/usr/bin/python2.6
# -*- coding: utf-8 -*-

import codecs
import os
import tempfile

f = tempfile.NamedTemporaryFile(delete=False)
filename = f.name
f.close()

with codecs.open(filename, 'w+b', encoding='utf-8') as fh:
  fh.write(u"Hello World: ä")
  fh.seek(0)
  for line in fh:
    print line

os.unlink(filename) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T00:33:38.350

您正在尝试将 unicode 对象写入`(u"...")`应使用编码字符串的临时文件`("...")`。您不必显式传递`"encode="`参数，因为您已经在第二行中说明了编码`("# -*- coding: utf-8 -*-")`。只需使用`fh.write("ä")`而不是，`fh.write(u"ä")`你应该没问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-08T00:24:54.920

删除 u 使您的代码对我有用：

```
fh.write("Hello World: ä") 
```

我想这是因为它已经是 unicode 了。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-02-12T09:15:32.010

将 sys 设置为默认编码为 UTF-8 将解决编码问题

```
import sys
reload(sys)
sys.setdefaultencoding('utf-8') #set to utf-8 by default this will solve the errors

import tempfile
with tempfile.TemporaryFile() as fh:
  fh.write(u"Hello World: ä")
  fh.seek(0)
  for line in fh:
    print line 
```

# jquery-ui - jQuery Dialog 和 Datepicker 插件不能一起工作

> ID：10490819
> 
> 赞同：1
> 
> 时间：2012-05-08T00:08:32.697
> 
> 标签：jquery-ui, jquery, dialog, datepicker

我有两个页面，一个是`mange.aspx`，另一个`pop-up.aspx` 在 mange.aspx 我用 ajax 加载另一个页面并将其显示在`jquery ui Dialog`

*我的问题*是当我在该页面内部加载页面时`jquery ui Datepicker`不起作用

这是我的代码

```
$(function () {
     $("#datepicker").datepicker({
         showOn: "button",
         buttonImage: "../images/calendar-icon.png",
         buttonImageOnly: true
     });

     $('#Add').click(function () {
         var $dialog = $('<div id="MyDialog"></div').appendTo('body')
      .load("../Pop-up.aspx #pop-up")
      .dialog({
         position: 'center',
         width: 550 
           // code .....
      });
   });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:15:04.830

加载弹出窗口*后*，您需要创建日期选择器。之前创建日期选择器不会做任何事情。

```
function createDatePicker() {
    $("#datepicker").datepicker({
        showOn: "button",
        buttonImage: "../images/calendar-icon.png",
        buttonImageOnly: true
    });
}

$(function () {
    $('#Add').click(function () {
        var $dialog = $('<div id="MyDialog"></div').appendTo('body')
          .load("../Pop-up.aspx #pop-up", createDatePicker)
          .dialog({
             position: 'center',
             width: 550 
          });
        // code .....
    });
}); 
```

您的日期选择器创建代码现在位于其自己的函数中，并在加载弹出页面时设置为回调。这样，日期选择器将在页面加载后立即创建。

# php - Websockets 无法解决的“收到意外的延续帧”错误

> ID：10490820
> 
> 赞同：6
> 
> 时间：2012-05-08T00:08:38.047
> 
> 标签：php, firefox, google-chrome, websocket

我写了一个算法来处理 PHP 中的 Websockets 数据。从 Chrome/Firefox 解码很好，但我一直在将数据从服务器发送到客户端（Chrome 18、Websockets 13）时遇到问题。服务器例程在收到消息后自动以“已接收”响应。

![续帧错误。](../Images/93c84311e89c30060fd58b0f0ddeb809.png)

消息后面绝对没有其他字节，正如 STDOUT 指示和 WireShark 转储指示（通过 RawCap 检索的数据）。在 WireShark/RawCap 中，出于某种原因，服务器->客户端消息出现在“ACK”消息下方。

![标准输出](../Images/a27d6659590ef3b4416aec82dded06f0.png)

![线鲨](../Images/74de4d34dbde4e33d63519152d2f075a.png)

我真的很感激有人对此的见解。这让我疯狂。

达斯汀奥普雷亚

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T14:00:33.353

我得到了它。事实证明，我最初采用的代码在握手响应标头之后的换行符之后放置了一个 NULL 字符，而我没有注意到这一点。它看起来像 a) 浏览器将所有接收到的 websocket 消息通过一个字符缓冲区移动，一旦处理了身份验证响应，该缓冲区就会在前面留下单个 NULL 字符，并且 b) 在 -next- 消息之前它不是问题收到了。

流动：

1) 浏览器（Chrome 和 Firefox）收到一个握手响应，最后带有一个额外的 NULL。
2) 浏览器批准握手响应。
3）浏览器向服务器发送消息（在这种情况下，带有“文本”操作码，不一定重要）。
4) 服务器正确解码帧。
5) 服务器通过已建立的 websocket 会话发回消息。
6) 客户抱怨有一个意外的延续框架。

在某些情况下，我相信我能够操纵消息以抑制来自浏览器的错误，但仍然没有在浏览器中收到服务器消息。

作为上面的一个例子，我相信，最初，服务器正在发送“响应”的自动文本响应，并得到了上面的消息。后来我把它改成了“1234”，还是得到了上面的信息。但是，我将其更改为“123”，不再收到错误消息，但仍然没有收到 Javascript 中的消息事件。

达斯汀奥普雷亚

# fiddler - 请我想要 Fiddler 中的代码示例来修改错误消息

> ID：10490822
> 
> 赞同：-2
> 
> 时间：2012-05-08T00:08:46.840
> 
> 标签：fiddler

我只需要一个代码示例来修改或删除 Fiddler 在发生 dns 错误时处理的错误

通过使用“OnReturningError”事件或任何其他方式

fiddler 返回的错误信息

[Fiddler] “somesite.com”的 DNS 查找失败。没有这样的主机是已知的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T03:18:59.937

[瓦西里·阿尔恰科夫](https://stackoverflow.com/users/1394444/vasiliy-alchakov)的回答

```
FiddlerApplication.BeforeReturningError += delegate(Session oS)
{
  oS.utilSetResponseBody(oS.GetResponseBodyAsString().Replace("[Fiddler]", String.Empty).Trim());
}; 
```

# python - 正则表达式：捕获一组具有相同开头的行？

> ID：10490825
> 
> 赞同：1
> 
> 时间：2012-05-08T00:09:17.443
> 
> 标签：python, regex

我正在编写一个脚本来遍历产品数据库，其中产品描述格式不佳、格式不一致，以使其 HTML 统一。我遇到的一个问题是捕获和替换以相同方式格式化的代码行。例如，我想替换他们所有的

```
&bull; item 1
&bull; item 2
&bull; item 3 
```

和

```
<ul>
  <li>item 1</li>
  <li>item 3</li>
  <li>item 2</li>
</ul> 
```

用一行替换每一`&bull;`行`<li>content</li>`很容易，但我一生都无法弄清楚列表前后的正则表达式。我的想法是捕获以开头的所有内容，`&bull;`直到出现**不**以 .开头的换行符`&bull;`。这是我最近的尝试（python）：

```
In  : p = re.compile(
        r'&bull;.*(?!^&bull;)'
      )

In  : p.findall(text, re.MULTILINE, re.DOTALL)
Out : []

In  : p.findall(text, re.MULTILINE)
Out : ['&bull; item 1', '&bull; item 2', '&bull; item 3']

In  : p.findall(text, re.DOTALL)
Out : ['&bull; item 1', '&bull; item 2', '&bull; item 3']

In  : p.findall(text)
Out : ['&bull; item 1', '&bull; item 2', '&bull; item 3'] 
```

关于如何捕捉类似的任何想法`['&bull; item 1\n&bull; item 2\n&bull; item 3']`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:50:45.757

You will first have to change all the bullets to `<li>` elements, then on a second execution encompass them in `<ul>` element.

Here is a java example. Python also uses PCRE so it should work the same:

```
 String test = "&bull; item 1\r\n&bull; item 2\r\n&bull; item 3\r\n";
    test = test.replaceAll("&bull; (.*)(?!^&bull;)", "<li>$1</li>");
    System.out.println(test);
    test = test.replaceAll("(?s)(<li>.+</li>)+?", "<ul>\n$1\n</ul>");
    System.out.println(test); 
```

Output:

```
<li>item 1</li>
<li>item 2</li>
<li>item 3</li>

<ul>
<li>item 1</li>
<li>item 2</li>
<li>item 3</li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T01:04:52.743

这是一个非基于正则表达式的解决方案：

```
with open('/tmp/example.txt') as f:
  lines_in = f.readlines()

inside_block = False
lines_out = []

for line in lines_in:
  if line.startswith('&bull; '):
    if not inside_block:
      lines_out.append('<ul>\n')
      inside_block = True
    lines_out.append('<li>{}</li>\n'.format(line.strip().replace('&bull; ','')))
  else:
    if inside_block:
      lines_out.append('</ul>\n')
      inside_block = False
    lines_out.append(line)

print ''.join(lines_in)
print '-'*78
print ''.join(lines_out) 
```

测试运行：

```
[~/Desktop]
|7>run /tmp/spam.py
spam
&bull; item 1
&bull; item 2
&bull; item 3
and eggs

------------------------------------------------------------------------------
spam
<ul>
<li>item 1</li>
<li>item 2</li>
<li>item 3</li>
</ul>
and eggs 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:16:22.757

将内容读入字符串并在“•”上拆分。遍历元素，分别在每个元素之前和之后添加“<li>”和“<\li>”。

# process - 自己的基于 hydra (mpich) 的进程管理器

> ID：10490835
> 
> 赞同：0
> 
> 时间：2012-05-08T00:10:36.237
> 
> 标签：process, mpi, mpich

您如何根据 hydra (mpich) 的来源来评估编写自己的流程管理器的难度？即，对于比例 1 到 100？它将更改与分配给计算机的进程相对应的部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:24:05.327

这应该不会太难，但[Hydra 已经实现了几种等级分配策略](http://wiki.mcs.anl.gov/mpich2/index.php/Using_the_Hydra_Process_Manager#Process-core_Binding)，因此您甚至可能不需要编写任何代码。

您已经可以提供用户指定的排名分配。根据提供的配置，Hydra 可以使用[hwloc](http://www.open-mpi.org/projects/hwloc/)库获取硬件拓扑信息并将进程绑定到内核。

# cuda - 错误“external symbol _cublasDestroy_v2@4”是不是CUDA使用不当导致的？

> ID：10490839
> 
> 赞同：2
> 
> 时间：2012-05-08T00:11:18.987
> 
> 标签：cuda, cublas

当我尝试编译矩阵 CUBLAS 操作时出现这些错误：

```
1>ClCompile:
1>  All outputs are up-to-date.
1>executionU.cu.obj : error LNK2001: unresolved external symbol _cublasDestroy_v2@4
1>executionU.cu.obj : error LNK2001: unresolved external symbol _cublasSgemm_v2@56
1>executionU.cu.obj : error LNK2001: unresolved external symbol _cublasCreate_v2@4
1>../../bin/win32/Release//executionU.exe : fatal error LNK1120: 3 unresolved externals 
```

有谁知道这个错误是否可能是由于使用 4.1 版而不是新的 4.2 CUDA 引起的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T01:01:06.073

将 cublas.lib 添加到链接器依赖项中。

# javascript - javascript google maps api v3 标记和信息窗口

> ID：10490845
> 
> 赞同：0
> 
> 时间：2012-05-08T00:12:32.067
> 
> 标签：javascript, google-maps

我对 google maps api v3 和带有 infowindow 的标记有疑问。

跟随部分代码集标记，但无法通过单击访问信息窗口。

```
var infowindow = new google.maps.InfoWindow();
var marker, i;
function setMarker(){
 for (i = 1; i < 240; i++) {  
  marker = new google.maps.Marker({
    position: new google.maps.LatLng(line[i][0], line[i][1]),
    map: map2
  });
  google.maps.event.addListener(marker, 'click', function() {
    infowindow.setContent("Test");
infowindow.open(map,marker);
});
}
} 
```

我希望有一个人可以帮助我 ：）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:54:12.470

If everything else is alright then **variable scoping problem** and in `infowindow.open(map, marker)` should be `map2`

```
var infowindow = new google.maps.InfoWindow();
var marker, i;
for (i = 1; i < 240; i++) {  
  marker = new google.maps.Marker({
    position: new google.maps.LatLng(line[i][0], line[i][1]),
    map: map2
  });

  google.maps.event.addListener(marker, 'click', (function(marker) {
    return function() {
      infowindow.setContent("Test");
      infowindow.open(map2, marker);
    }
  })(marker));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T00:27:37.370

也许这就是问题所在：

```
infowindow.open(map2,marker); 
```

你在哪里声明`map2`？是什么`map`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-30T09:35:15.483

如果您有一系列位置，如下所示

```
var locations = [
    [33.890542, 150.274856],
    [36.923036, 152.259052],
    [38.028249, 154.157507]
]; 
```

那么您可以使用以下代码

```
function initialize() {
    var myLatlng = new google.maps.LatLng(locations[0][0], locations[0][1]);
    var myOptions = {
        zoom: 4,
        center: myLatlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    var map = new google.maps.Map(document.getElementById("map"), myOptions);

    for(var i=0;i<locations.length;i++)
    {
        var latlng=new google.maps.LatLng(locations[i][0], locations[i][1]);
        var marker = new google.maps.Marker({
            position: latlng,
            map: map,
            title: "marker : "+(i+1)
        });
    }     
}
google.maps.event.addDomListener(window, 'load', initialize); 
```

[工作示例](http://jsfiddle.net/nGrSR/1/)

# jquery - 如何强制infiniteScroll考虑通过jQuery.html调用添加的动态内容

> ID：10490847
> 
> 赞同：0
> 
> 时间：2012-05-08T00:12:50.230
> 
> 标签：jquery, jquery-masonry, infinite-scroll

我正在使用砖石 + 无限滚动，但是当我必须用来自另一个 ajax 调用的 HTML 替换 div 的内容时，滚动停止工作，即使很难导航元素也在那里。

因此，如果内容在页面首次加载时出现，则无限滚动有效，但如果在此页面中我用来自 ajax 调用并包含无限滚动元素的 HTML 替换 div 的内容，则无限滚动将停止工作。

任何想法

这是我的代码

```
$('#mainContainerHome').infinitescroll({
   navSelector  : '#page-nav',    // selector for the paged navigation
   nextSelector : '#page-nav a',  // selector for the NEXT link (to page 2)
   itemSelector : '.tile',     // selector for all items you'll retrieve
   loading: {
     finishedMsg: 'No more items.',
     img: 'http://i.imgur.com/6RMhx.gif'
     }
   },
   // trigger Masonry as a callback
   function( newElements ) {
     // hide new items while they are loading
     var $newElems = $( newElements ).css({ opacity: 0 });
     // ensure that images load before adding to masonry layout
     $newElems.imagesLoaded(function(){
     // show elems now they're ready
     $newElems.animate({ opacity: 1 });
     $('#mainContainerHome').masonry( 'appended', $newElems, true );
   });
}
); 
```

我需要有一种方法来告诉 infiniteScroll 重新开始并使用通过 jQuery..html('xxxxx'); 添加的代码；陈述。

因为在我用动态内容（它包含导航元素）替换 div 的内容后，无限滚动停止工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:26:01.010

我对这些插件不熟悉，但马上我想我看到了一些东西；尝试：

```
$('#mainContainerHome').append($newElems).masonry( 'appended', $newElems, true ); 
```

# ember.js - 如何在车把中引用子视图？

> ID：10490848
> 
> 赞同：0
> 
> 时间：2012-05-08T00:12:52.850
> 
> 标签：ember.js, collectionview

我有一个集合视图如下：

```
Ember.Widget.ParentView = Ember.CollectionView.extend({

    content: ['childView1', 'childView2'],

    fnameBinding: ChildView1.fname,
    lnameBinding: ChildView1.lname,

    ChildView1: Ember.View.extend({
        templateName: 'ChildView1',

        fname: 'David',
        lname: 'Johnson',
    }),

    ChildView2: Ember.View.extend({
        fnameBinding: '_parentView.fname',
        lnameBinding: '_parentView.lname',
    })
}); 
```

如果我想在 ChildView1.handlebar 中显示名称，我应该如何引用 fname？以下不起作用：

```
<script type="text/x-handlebars" name="ChildView1">
{{fname}}{{lname}}
</script> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T11:01:54.153

**使用 CollectionView ：**

`Ember.CollectionView`内容应该是对象的集合（参见Ember.CollectionView[文档](http://ember-docs.herokuapp.com/#doc=Ember.CollectionView&src=false)）：

> Ember.CollectionView 是 Ember.View 的后代，负责管理集合（数组或类似数组的对象），方法是维护数组中每个项目的子视图对象和关联的 DOM 表示，并确保子视图及其关联的渲染 HTML 是在添加、删除或替换数组中的项目时更新。

例如，您可以创建一个`App.Name`具有 fName 和 lName 属性的模型（此处默认设置为 null）：

```
App.Name = Ember.Object.extend({
  fName: null,
  lName: null
}); 
```

然后创建此模型的实例：

```
App.name1 = App.Name.create({fName: 'David', lName: 'Johnson'});
App.name2 = App.Name.create({fName: 'Stack', lName: 'Overflow'}); 
```

最后，在 CollectionView 中显示它们：

```
App.ParentView = Ember.CollectionView.extend({
  content: [App.name1, App.name2],
  itemViewClass: Ember.View.extend({
    template: Ember.Handlebars.compile('firstName: {{content.fName}}, lastName: {{content.lName}}')
  }),
}); 
```

你可以试试这个小提琴：http: [//jsfiddle.net/Ev3mR/](http://jsfiddle.net/Ev3mR/)

**使用视图：**

你也可以在这个小提琴中实现这一点：http: [//jsfiddle.net/y4FUr/](http://jsfiddle.net/y4FUr/)

# javascript - 使用 knockoutjs 绑定在 Firefox 中将多行文本显示为单行

> ID：10490851
> 
> 赞同：8
> 
> 时间：2012-05-08T00:13:05.003
> 
> 标签：javascript, firefox, knockout.js

我刚刚在使用 knockoutjs 绑定的 Firefox 中遇到了一个非常奇怪的多行文本行为。这是我的小提琴：http: [//jsfiddle.net/NznVZ/](http://jsfiddle.net/NznVZ/)。

我们有一个 textarea 和 span，其 value/text 绑定到同一个 observable。目前，Chrome 和 IE 确实在 span 元素中显示多行文本，但 firefox 没有（它只是将几行连接成 1）。

有人可以解释什么是/哪里有问题吗？也许有人已经遇到过这个问题并有解决方案？

提前致谢

PS 火狐 12、IE 9、Chrome 18

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-08T00:38:21.533

在跨度上设置`white-space: pre-wrap`样式将使其工作：http: [//jsfiddle.net/mbest/NznVZ/12/](http://jsfiddle.net/mbest/NznVZ/12/)

这里有一点背景。当使用 设置文本时， IE 和 Chrome 会将字符串中的换行符转换为`<br>`HTML 中的元素`innerText`，这就是 Knockout 使用的。Firefox 没有`innerText`so Knockout uses `textContent`，它不会对字符串进行任何转换。（有趣的是，当您使用该`white-space: pre-wrap`样式时，Chrome 会匹配 Firefox。）

IE：

```
<span>First line.<br>Second Line.<br>&nbsp;&nbsp;&nbsp;&nbsp; Third line preceded with 5 space characters.</span> 
```

Chrome（没有空格样式）：

```
<span>First line.<br>Second Line.<br>     Third line preceded with 5 space characters.</span> 
```

Firefox 和 Chrome（带有空白样式）：

```
<span>First line.
Second Line.
     Third line preceded with 5 space characters.</span> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-08T00:41:21.720

如果你想要一个 javascript 解决方案：http: [//jsfiddle.net/9KAQX/](http://jsfiddle.net/9KAQX/)

这里唯一的优点是跨度中不存在“\n”字符。

# haskell - 为什么 `>>` 的 list monad 方法没有定义为 `flip const`？

> ID：10490852
> 
> 赞同：3
> 
> 时间：2012-05-08T00:13:05.203
> 
> 标签：haskell, monads

Prelude 没有像这样定义列表单子有什么原因吗？（注意 的非标准实现`>>`。）

```
instance  Monad []  where
    m >>= k          = concat (map k m)
    m >> k           = k                 -- a.k.a. flip const
    return x         = [x]
    fail s           = [] 
```

我尝试根据单子定律检查这一点，但他们没有提到`>>`. `Monad`类定义是这样的：

```
m >> k = m >>= \_ -> k 
```

在这种`[]`情况下，这将转化为：

```
concat (map (\_ -> k) m) 
```

这当然不等同于——它们`flip const`产生明显不同的结果，例如，`[1..5] >> return 1`。但是我不清楚这个默认定义是实例必须遵守的*法律*，还是只是满足实现也会满足`Monad`的其他法律的默认实现。`flip const`

直观地说，鉴于 list monad 的*意图*`>>`（“非确定性计算”），由于修剪分支保证等于一个，它的替代定义似乎同样好，如果不是更好的话。或者另一种说法是，如果我们处理的是*集合*而不是*列表*，那么两个候选定义将是等价的。但是我是否在这里遗漏了一些使`flip const`列表的定义错误的微妙之处？

**编辑**：ehird 的回答与上述内容有一个非常明显的缺陷，即它得到了错误的预期结果`[] >> k`，应该是`[]`，不是`k`。不过，我认为这个问题可以修改为这个定义：

```
[] >> k = []
_ >> k = k 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-08T00:15:44.557

`a >> b`必须始终等价于`a >>= const b`; 它仅在`Monad`类中，以便您可以定义更有效（但在*语义上等效*）的版本。这就是为什么它不是 monad 法则的一部分：它实际上不是 monad 定义的一部分，只是类型类（如`fail`）。

不幸的是，我在基本包的文档中找不到明确说明这一点的任何地方，但我认为旧版本可能已`(>>)`在类型类之外定义`Monad`。

对于它的价值，您的定义`(>>)`打破了 list monad 用于非确定性计算的用途。由于`[]`用于表示失败，`[] >> m`必须始终为`[]`; 用尽所有可能的分支后，您将无法继续！这也意味着这两个程序：

```
do { m; ... }
do { _ <- m; ... } 
```

可能在行为上有所不同，因为前者用 脱糖，`(>>)`而后者用`(>>=)`. （参见[Haskell 2010 年报告](http://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-470003.14)。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T00:17:12.350

因为`ma >> mb`just*是*`ma >>= \_ -> mb`. _ 如果仅在列表的情况下`>>`定义，则如果`flip const`是列表，则*根本*`ma >> mb`不会运行计算，这将非常混乱。`ma` *`ma`*

 *至于为什么它没有被定义为`flip const` *general*，好吧，它的当前语义`>>`使它能够在您不关心其结果的情况下对效果进行排序，这通常很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T04:23:23.390

您的定义`>>`违反了`Monad`结合律：

```
newtype B a = B { unB :: [a] }

instance Monad B where
  m >>= f = B . concatMap (unB.f) $ unB m
  (>>) = flip const
  return a = B [a]

case1 = B [1,2,3] >>= (\_ -> B [4,5,6] >> return 1)
case2 = (B [1,2,3] >>= \_ -> B [4,5,6]) >> return 1

main = do
  print $ unB case1
  print $ unB case2 
```

上述两种情况的关联性不同，但产生的结果不同。*

# ruby-on-rails - 在使用 irb 在 Rails 中进行练习 db 迁移时，收到错误消息“NameError:uninitialized constant ActiveRecord”

> ID：10490858
> 
> 赞同：0
> 
> 时间：2012-05-08T00:14:01.443
> 
> 标签：ruby-on-rails, migration, irb

（见标题）这是代码，我正在使用 ms 命令提示符（irb）来执行此操作，这本身可能是错误的。

> C:\Users\davo\Desktop\RailsProjects\sqlite>irb
> 
> \<\lass CreateProducts < ActiveRecord::Migration
> 
> irb(main):002:1> def up
> 
> irb(main):003:2> create_table :products do |t|
> 
> irb(main):004:3* t.string:name
> 
> irb(main):005:3> t.text :description
> 
> irb(main):006:3> t.timestamps
> 
> irb(main):007:3> 结束
> 
> irb(main):008:2> 结束
> 
> irb(main):009:1> 结束
> 
> NameError: 未初始化的常量 ActiveRecord
> 
> ```
>  from (irb):1
> 
>    from C:/Ruby193/bin/irb:12:in `<main>' 
> ```
> 
> irb（主）：010：0>

我知道它不应该是 \<\lass 但这不是我输入的内容，我认为这不是问题，但我不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:26:40.197

你需要`require 'active_record'`。我同意您在尝试手动迁移时可能会遇到其他问题。

# php - PHP 内爆但将每个元素用引号括起来

> ID：10490860
> 
> 赞同：74
> 
> 时间：2012-05-08T00:14:30.813
> 
> 标签：php, implode

假设我有一个数组：

```
 $elements = array('foo', 'bar', 'tar', 'dar'); 
```

然后我想建立一个`DELETE IN`SQL 查询：

```
 $SQL = "DELETE FROM elements
               WHERE id IN ('" . implode(',', $elements) . "')"; 
```

问题是元素数组中的 id 没有单独引用。IE 查询看起来像：

```
 $SQL = "DELETE FROM elements
               WHERE id IN ('foo,bar,tar,dar'); 
```

解决这个问题的最好、最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2012-05-08T00:15:37.980

在通话中添加引号`implode`：（我假设您的意思是`implode`）

```
$SQL = 'DELETE FROM elements
           WHERE id IN ("' . implode('", "', $elements) . '")'; 
```

这会产生：

```
DELETE FROM elements WHERE id IN ("foo", "bar", "tar", "dar") 
```

防止 SQL 注入的最佳方法是确保您的元素被正确转义。

一个简单的事情应该可行（但我没有测试过）是使用`array_map`or `array_walk`，并转义每个参数，如下所示：

```
$elements = array();
$elements = array_map( 'mysql_real_escape_string', $elements); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-02-01T13:09:32.263

您可以使用[**`array_walk`**](http://php.net/manual/en/function.array-walk.php)迭代传递对元素的引用的数组中的所有元素，并按以下方式添加引号。

**php 7.4 或更新版本**

```
<?php

$arr = ['a','b','c'];

array_walk($arr, fn(&$x) => $x = "'$x'");

echo implode(',', $arr); // 'a','b','c' 
```

**php 7.3 或更早版本**

```
<?php

$arr = ['a','b','c'];

array_walk($arr, function(&$x) {$x = "'$x'";});

echo implode(',', $arr); // 'a','b','c' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-01T17:27:52.547

您可以运行一个简单的 array_map() 函数将字符串括在引号中，然后将其包裹在 implode() 周围以添加逗号：

```
$array = ["one", "two", "three", "four"];

implode(",", array_map(function($string) {
    return '"' . $string . '"';
}, $array)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-23T15:34:54.163

你也可以这样做

```
$elements = array('foo', 'bar', 'tar', 'dar');

$data = '"' . implode('", "', $elements) . '"';

echo $data; // "foo", "bar", "tar", "dar" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-27T21:36:16.003

`callable`只是在这里添加一点答案，即使您使用的是 MySQLi，也可以通过使用对象方法形式使用 array_map 调用 real_escape_string 。这是一个示例，假设`$conn`是您的 MySQLi 连接：

```
$elements = array('foo', 'bar', 'tar', 'dar');
$cleanedElements = array_map([$conn, 'real_escape_string'], $ids);
$SQL = 'DELETE FROM elements WHERE id IN ("' . implode('", "', $elements) . '")'; 
```

请注意，array_map 的第一个参数是一个数组，其中对象后跟方法名称。这与对数组中的每个项目执行以下操作相同：

```
$newItem = $conn->real_escape_string($item); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-02T20:33:58.847

我只想指出，最佳答案不会完全起作用。内爆结束时您将缺少一个元素。

所以而不是：

```
DELETE FROM elements WHERE id IN ("foo", "bar", "tar", "dar") 
```

你会得到：

```
DELETE FROM elements WHERE id IN ("foo", "bar", "tar", "dar) 
```

请注意，结尾元素 "dar 现在缺少引号。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-02T16:02:02.763

json_encode 怎么样？

```
$arr=array("foo","bar","tar","dar");
$str=json_encode($arr);
echo $str; 
```

结果：["foo","bar","tar","dar"]

# location - 基于位置的应用程序：经度和纬度值

> ID：10490864
> 
> 赞同：0
> 
> 时间：2012-05-08T00:15:37.217
> 
> 标签：location, latitude-longitude

我正在研究多维对象的索引（基于位置的服务：例如，long/lat/time）并尝试使用希尔伯特曲线。问题是，我拥有的 java 代码在 64 位上运行良好。例如：

值（长，纬度，时间）= H（位）

如果位数 > 64 ，则算法失败。

所以我只需要知道在现实世界的应用中我应该考虑的 long 和 lat 值的可行范围是多少？是：经度-180到180，纬度90到-90？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:27:24.810

是的，如您所说，通常将经度定义为 -180 到 180 之间，纬度定义为 -90 到 90 之间。我已经看到经度的范围是 0 到 360，但没有那么频繁。

重要的是您定义 360 度范围内的纬度和 180 度范围内的纬度，因为这可以让您找到地球上的任何点。

尽管我对希尔伯特曲线一无所知，也不知道您的任务涉及什么，但我建议您确保了解通常使用的纬度和经度值是大地测量的。因此，纬度是地球表面法线与赤道平面所成的角度。除非你在赤道，否则这条线不会穿过地球的中心。

# wordpress - 您如何根据页面的整个 url 而不仅仅是它们的 slug 来加载页面模板？

> ID：10490873
> 
> 赞同：0
> 
> 时间：2012-05-08T00:16:49.620
> 
> 标签：wordpress, templates

您如何根据页面的整个 url 而不仅仅是它们的 slug 来加载页面模板？

页面模板加载`page-{slug}.php`或`page-{id}.php`。

我真的希望它加载`page-{parent-slug}_{slug}.php`。

所以 url`/hello/world`会寻找模板`page-hello_world.php`。

这应该是递归的，因此页面 url 越长，模板文件名就越长。

API中没有**template_redirect**文档。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T01:46:23.157

这就是我想出的。它工作得很好，并将其添加到主题文件夹中的 functions.php 文件中：

```
function hierarchical_template() {
    global $post;       
    $permalink_array =
        array_filter(explode('/',str_replace(get_site_url(),'',get_permalink($post->ID))));     
    $template_redirect = false;     
    while ( count( $permalink_array ) ) {           
        $template = 'page-' . implode( '_', $permalink_array ) . '.php';            
        if(file_exists(TEMPLATEPATH . '/' . $template)){
            include (TEMPLATEPATH . '/' . $template);
            exit;               
        }           
        array_shift($permalink_array);
    }
}

add_action('template_redirect', 'hierarchical_template'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T00:54:32.150

在您的 page.php 文件中，您可以执行以下操作：

```
<?php
get_header();

$ancestors = get_ancestors(get_the_ID(), 'page');
$current_page = get_page(get_the_ID());
$top_page = $ancestors ? get_page(end($ancestors)) : false;
if($top_page && $file = locate_template('page-'.$top_page->post_name.'_'.$current_page->post_name.'.php'))
{
    include $file;
}
else if($file = locate_template('page-'.$current_page->post_name.'.php'))
{
    include $file;
}
else
{
    //DEFAULT HTML TO DISPLAY
}
?> 
```

这是未经测试的，但想法是让您的 page.php 搜索并包含匹配的“page-{parent-slug}_{slug}.php”文件。如果找不到匹配的文件，那么它将搜索“page-{slug}.php”。如果不存在，那么它将回退到 else 语句中的默认 HTML。

希望这可以帮助。

# php - 在 PHP 中始终使用 === 是否安全？

> ID：10490878
> 
> 赞同：3
> 
> 时间：2012-05-08T00:17:30.713
> 
> 标签：php

我是 PHP 新手，我刚刚遇到了一个浪费时间的错误，因为我没有意识到 PHP == 运算符确实键入了类似于 Javascript 的强制转换。

我知道 Douglas Crockford 建议不要将 == 运算符与 Javascript 一起使用，而始终使用 === 运算符。

如果我以从不假定类型强制的方式编码，我可以在 PHP 中使用相同的建议，并且从不使用 == 运算符吗？**始终**使用 === 运算符是否安全，或者是否有我需要注意的问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T00:18:26.297

您应该`===`默认使用（以避免刚刚遇到的问题）并`==`在需要时使用，以方便使用。

例如，您可能从`$_GET`或类似的参数中获取参数，并且参数可能是字符串`true`or `false`，与布尔值`true`or `false`。`==`就个人而言，我会检查所有内容，但如果您意识到这一点并谨慎使用，可能会有合法的用例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T00:20:25.193

`==`并且`===`, 由于特定原因而存在。正如您在帖子中已经提到的那样，`==`类型强制。

我来自强类型编程背景，因此从不需要类型强制，就像你一样。在这种情况下，始终使用`===`.

当然，当您确实需要强制时，请使用`==`.

如果输入您无法控制（GET/POST 参数、API 响应），您可以使用`==`或使用强制转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:33:15.717

`var_dump('1' == 1);`return`bool(true)`和`var_dump('1' === 1);`return`bool(false)`因为它们具有相同的值但类型不同。一个是字符串，另一个是整数。

仅`===`当您知道要检查的类型时才使用。

# sql - 'INDEX' 是有效的 SQL ANSI ISO 标准关键字/保留字吗？

> ID：10490879
> 
> 赞同：3
> 
> 时间：2012-05-08T00:17:36.390
> 
> 标签：sql, ansi-sql

我对 'INDEX' 是否是 ANSI SQL 中的关键字进行了一些研究，但我没有任何运气，特别是对于 2008 和 2011 标准。

有人确定这是否是有效的 ANSI ISO SQL 关键字吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T06:33:58.660

没有用于创建、更改或管理索引的 SQL 语言的 ANSI 标准。所以不，INDEX 不是 ANSI 标准的关键字（保留字）。

[Kevin Kline 在他的书SQL in a Nutshell](http://books.google.com/books?id=F4dzMjYmLRIC&pg=PA117&lpg=PA117&dq=ansi%20create%20index%20statement&source=bl&ots=X3k8YavJam&sig=Gvj2Gtwmn57dmpcXsyRJM9vXat8&hl=en&sa=X&ei=IruoT5HGBsGmiQKfubCdAg&ved=0CGMQ6AEwBg#v=onepage&q=ansi%20create%20index%20statement&f=false)中特别支持我。他指出这是创建索引的语法因供应商而异的原因之一。

作为进一步的间接证据，您还会注意到各种供应商在其 SQL 文档中提到有关 INDEX 的语句是对 ANSI 标准的扩展。例如，请参阅[此处的 IBM 文档以获取 ALTER INDEX](http://publib.boulder.ibm.com/infocenter/idshelp/v115/index.jsp?topic=/com.ibm.sqls.doc/ids_sqs_0228.htm)。

这也是一个[方便](http://developer.mimer.se/validator/sql-reserved-words.tml)的 ANSI SQL 保留字列表 - 但仅限于 2003 年。

* * *

作为旁注：我见过的关于索引的唯一一次提到的ANSI是在谈论唯一索引（通常只是一个唯一约束）如何处理空值时。根据 ANSI，null 不等于 null；因此，唯一索引应允许多个空值，因为根据 ANSI，它们彼此不相等。一些引擎遵循这个规则-其他的则没有。这种情况下的 ANSI 标准仅指两个空值是否相等或唯一……该标准与索引无关。可能还有其他 ANSI 标准对 INDEX 有类似的影响，但与围绕它们的 DDL 无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T10:21:00.550

SQL 标准特意省略了索引，因为并非所有可以使用 SQL 定位的数据源都支持任何“索引”概念。例如，在 MS Access SQL 中，可以使用`CREATE TABLE`语法创建一个新的 MS Excel 工作簿，其中包含 SQL 认为是“表”但 Excel 认为是“命名范围”的内容，并在 Excel 范围上创建 Access 表索引使得没有意义。

# c++ - 企业销售；访问带有链接器错误的私有静态变量

> ID：10490882
> 
> 赞同：0
> 
> 时间：2012-05-08T00:17:53.613
> 
> 标签：c++, static, linker, undefined

***编辑：这已经解决了。请查看我的第二个编码，了解为修复链接器错误问题而编辑的内容。如果可能，请关闭此线程。感谢您的回答/回复/反馈<3***

我正在尝试使用函数 getvalue() 访问我的私有静态变量以返回公司总销售额 (Year_Sales)。我正在尝试触发该功能

```
cout << DivisionSale[0].getvalue(); 
```

但我收到以下错误...

> [链接器错误] 未定义的引用；私有静态变量

**这是我的项目编码**

```
#include <iostream>

using namespace std;

// class declaration

class DivSales  // The 6 divisions will use this

{

      private:
              // Holds the total corporate sales for all divisions
              static int Year_Sales;

      public:
              static int Qtrsale[4]; // Elements for sale figures, 4 quarterly sales
              static void AddSales (int,int,int,int); // calculates annual ammount
              int Sales(int); // output
              static int getvalue() { return Year_Sales; } 

};

// This member function takes arguments and is copied into array holding sales data

// Year_Sales contains total of the 4 sales

void DivSales::AddSales(int sale1, int sale2, int sale3, int sale4)

{

      // arrays 0 through 3 store the quarterly sales
      Qtrsale[0] = sale1;
      Qtrsale[1] = sale2;
      Qtrsale[2] = sale3;
      Qtrsale[3] = sale4;

      // private variable access
      // combines the 4 arguments
      Year_Sales = Year_Sales + sale1 + sale2 + sale3 + sale4;

}

// returns values of quarterly sales for each division

// Used for table formatting in main

int DivSales::Sales(int n)

{

    // Qtrsale[n] holds value from input to return for output

    // returns sale(n) 

    int value = Qtrsale[n];
    return value;

}

// this function is triggered if user enters a negative quarterly sale value

void error()

{

     system("cls");
     cout << "You have entered a negative value. Restart program and try again";
     cout << "Press any key to restart program\n";
     system("pause");
     exit(0);

}

// Overload constructer

// Definition of the static member of DivSales class

// for access to the private static variable

int DivSales::Year_Sales = 0;

// Start main function

int main()

{

    // insurance for protecting the array storage(s)
    const int DS = 6;   
    DivSales DivisionSale[DS];  // 6 division with each of their own array
    int quarter, division; // quarter = 4; division = 6

    // This will pass quarter sales to AddSales
    for (division = 0; division < 6; division++)
    {
        // 4 quarters for array storage
        int Qrt1, Qrt2, Qrt3, Qrt4;

        int Q; // used to check for negative input

        // Prompts the user for quarter sales of each division
        // divisions 1 - 6
        cout << "Enter Sales of Division: " << division + 1 << endl;

        // Each quarter is assigned to Q which is used for error checking.
        // Error checking occurs when negative value is detected
        cout << "Enter Q1 Sales: ";
        cin >> Qrt1;
        Q = Qrt1;
        if (Q < 0)
           error();

        cout << "Enter Q2 Sales: ";
        cin >> Qrt2;
        Q = Qrt2;
        if (Q < 0)
           error();

        cout << "Enter Q3 Sales: ";
        cin >> Qrt3;
        Q = Qrt3;
        if (Q < 0)
           error();

        cout << "Enter Q4 Sales: ";
        cin >> Qrt4;
        Q = Qrt4;
        if (Q < 0)
           error();

        // passes Qrt1 through Qrt4 to AddSales
        DivisionSale[division].AddSales(Qrt1,Qrt2,Qrt3,Qrt4);
    }

    cout << "----------------------------------------\n";
    cout << "\t" << "Q1" << "\t" << "Q2" << "\t" << "Q3" << "\t" << "Q4" << endl;

    // table for quarterly sales of each division
    for (division = 0; division < 6; division++)
    {
        cout << "Div " << division + 1;
        for (quarter = 0; quarter < 4; quarter++)
        {
            // calling function Sales 6 times
            cout << "\t" << DivisionSale[division].Sales(quarter);
            cout << endl;
        }
    }

    cout << "----------------------------------------\n";
    cout << "\n Total All Division Sales for the Year: ";
    cout << DivisionSale[0].getvalue();       

    system("pause");
    return 0;

} 
```

**这是我需要做的：**

一家公司有六个部门，每个部门负责向不同的地理位置进行销售。设计一个 DivSales 类来保存部门的销售数据，其中包含以下成员：

• 一个包含四个元素的数组，用于保存该部门四个季度的销售数据

• 一个私有静态变量，用于保存全年所有部门的公司总销售额。

• 一个接受四个参数的成员函数，每个参数都假定为一个季度的销售额。应将参数的值复制到保存销售数据的数组中。四个参数的总和应添加到保存年度公司总销售额的静态变量中。

• 一个函数，它采用0 到3 范围内的整数参数。该参数将用作除法季度销售额数组的下标。该函数应返回具有该下标的数组元素的值。

编写一个程序，创建一个包含六个 DivSales 对象的数组。程序应要求用户输入每个部门四个季度的销售额。输入数据后，程序应显示一个表格，显示每个季度的部门销售额。然后该程序应显示该年度的公司总销售额。

*输入验证：仅接受季度销售数据的正值。*

链接器错误是唯一阻碍我的错误。我很清楚可能会有一些代码优化，但我确实需要修复链接器错误。

**编辑：修改了什么是静态的而不是静态的，并使用了 int DivSales::Year_Sales**

新编码：

```
#include <iostream>

using namespace std;

// class declartion

class DivSales  // The 6 divisions will use this

{

      private:
              // Holds the total corporate sales for all divisions
              static int Year_Sales;
              int Qtrsale[4]; // Elements for sale figures, 4 quarterly sales

      public:
              void AddSales (int,int,int,int); // calculates annual ammount
              int Sales(int); // output
              int getvalue() { return Year_Sales; }

};

// This member function takes arguments and is copied into array holding sales data

// Year_Sales contains total of the 4 sales

void DivSales::AddSales(int sale1, int sale2, int sale3, int sale4)

{

      // arrays 0 through 3 store the quarterly sales
      Qtrsale[0] = sale1;
      Qtrsale[1] = sale2;
      Qtrsale[2] = sale3;
      Qtrsale[3] = sale4;

      // private variable access
      // combines the 4 arguments
      Year_Sales = Year_Sales + sale1 + sale2 + sale3 + sale4;

}

// returns values of quarterly sales for each division

// Used for table formatting in main

int DivSales::Sales(int n)

{

    // Qtrsale[n] holds value from input to return for output
    // returns sale(n) 
    int value = Qtrsale[n];
    return value;

}

// this function is triggered if user enters a negative quarterly sale value

void error()

{

     system("cls");
     cout << "You have entered a negative value. Restart program and try again";
     cout << "Press any key to restart program\n";
     system("pause");
     exit(0);

}

// Overload constructer

// Definition of the static member of DivSales class

// for access to the private static variable

int DivSales::Year_Sales;

// Start main function

int main()

{

    // insurance for protecting the array storage(s)
    const int DS = 6;   
    DivSales DivisionSale[DS];  // 6 division with each of their own array
    int quarter, division; // quarter = 4; division = 6

    // This will pass quarter sales to AddSales
    for (division = 0; division < 6; division++)

    {

        // 4 quarters for array storage
        int Qrt1, Qrt2, Qrt3, Qrt4;

        int Q; // used to check for negative input

        // Prompts the user for quarter sales of each division
        // divisions 1 - 6
        cout << "Enter Sales of Division: " << division + 1 << endl;

        // Each quarter is assigned to Q which is used for error checking.
        // Error checking occurs when negative value is detected
        cout << "Enter Q1 Sales: ";
        cin >> Qrt1;
        Q = Qrt1;
        if (Q < 0)
           error();

        cout << "Enter Q2 Sales: ";
        cin >> Qrt2;
        Q = Qrt2;
        if (Q < 0)
           error();

        cout << "Enter Q3 Sales: ";
        cin >> Qrt3;
        Q = Qrt3;
        if (Q < 0)
           error();

        cout << "Enter Q4 Sales: ";
        cin >> Qrt4;
        Q = Qrt4;
        if (Q < 0)
           error();

        // passes Qrt1 through Qrt4 to AddSales
        DivisionSale[division].AddSales(Qrt1,Qrt2,Qrt3,Qrt4);

    }

    cout << "\n----------------------------------------\n";
    cout << "\t" << "Q1" << "\t" << "Q2" << "\t" << "Q3" << "\t" << "Q4" << endl;

    // table for quarterly sales of each division
    for (division = 0; division < 6; division++)

    {

        cout << "Div " << division + 1;
        for (quarter = 0; quarter < 4; quarter++)

        {

            // calling function Sales 6 times
            cout << "\t$" << DivisionSale[division].Sales(quarter);

        }

        cout << endl;

    }

    cout << "----------------------------------------\n";
    cout << "\nTotal corporate sales for the year: ";
    cout << "$" << DivisionSale[0].getvalue() << endl;      

    system("pause");
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:24:04.503

您只需要在某处定义变量即可：

```
int DivSales::Qtrsale[4]; 
```

您在类中有一个声明，但在项目的某处也需要有一个定义（在一个地方）。

这必须是 C++ 常见问题解答，但我现在懒得查。

# ruby-on-rails - 找不到关联：模型用户中的分配

> ID：10490883
> 
> 赞同：0
> 
> 时间：2012-05-08T00:17:54.700
> 
> 标签：ruby-on-rails, ruby

在 Rails 网站上创建 ruby​​ 并最近添加：

```
<% if (?can :manage, :table) %> 
<%= link_to 'New Table', new_table_path %>
<% end %> 
```

为了一些额外的安全性，现在它声明我不能这样做。我认为这可能与我的能力有关：

```
class Ability
  include CanCan::Ability
  def initialize(user)
       user ||= User.new
       can :read, :all
       if user.role? "admin" 
       can :manage, :all
  end
  def initialize(user)
       user ||= User.new
       can :read, :all
       if user.role? "coach" 
       can :manage, :all
  end
  def initialize(user)
       user ||= User.new
       can :read, :all
       if user.role? "captain" 
       can :manage, :tournaments
       can :manage, :results
  end
  def initialize(user)
       user ||= User.new
       can :read, :all
       if user.role? "teammember" 
       can :manage, :individualresults
  end
  end
end 
```

提前感谢您的帮助。如果您想要其他代码，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T04:22:48.927

[您的能力文件](https://github.com/ryanb/cancan/wiki/Ability-Precedence)应该如下所示：

```
class Ability
  include CanCan::Ability
  def initialize(user)
     user ||= User.new
     can :read, :all
     if (user.role? "admin" || user.role? "coach")
       can :manage, :all
     end
     if user.role? "captain" 
       can :manage, Tournament
       can :manage, Result
     end
     if user.role? "teammember" 
       can :manage, Individualresult
     end
  end
end 
```

[根据定义的 CanCan 规则检查用户操作，](https://github.com/ryanb/cancan/wiki/Checking-Abilities)如下所示：

```
if can?(:create, Table) 
```

# c# - 如何找到泛型类型派生自给定基类型的所有 DbSet？

> ID：10490885
> 
> 赞同：8
> 
> 时间：2012-05-08T00:17:59.547
> 
> 标签：c#, entity-framework, generics, reflection, entity-framework-4.1

如何获取`List`包含类型派生自的所有 DbSet `IncomingServiceOrderBase`？

我可以使用反射来获取所有 DbSet，但是如何将其过滤到仅包含派生类型的那些？

**语境**

```
public class MyContext : DbContext
{
    public DbSet<BuildingOrder> BuildingOrders { get; set; }
    public DbSet<DeliveryOrder> DeliveryOrders { get; set; }
    public DbSet<RetailAssemblyOrder> RetailAssemblyOrders { get; set; }
} 
```

**模型**

```
public class BuildingOrder : IncomingManufacturedProductOrderBase { }
public class DeliveryOrder : IncomingServiceOrderBase { }
public class RetailAssemblyOrder : IncomingServiceOrderBase { } 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-08T00:59:25.277

你可以这样做：

```
var sets =
    from p in typeof(MyContext).GetProperties()
    where p.PropertyType.IsGenericType
    && p.PropertyType.GetGenericTypeDefinition() == typeof(DbSet<>)
    let entityType = p.PropertyType.GetGenericArguments().First()
    where typeof(IncomingServiceOrderBase).IsAssignableFrom(entityType)
    select p.Name; 
```

（这将返回属性的名称；如果您想要实际的 DbSet 实例，请替换`p.Name`为`p.GetValue(context, null)`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T00:52:35.983

`typeof(BaseType).IsAssignableFrom(DerivedType)`. It'll return true/false. See [http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx)

To turn `DbSet<T>` into `T` (so you can do this comparison) take each property's type and do something like this:

```
 public static Type GetGenericBaseType( this Type Type ) {
        if ( Type == null ) {
            throw new ArgumentNullException( "Type" );
        }
        if ( !Type.IsGenericType ) {
            throw new ArgumentOutOfRangeException( "Type", Type.FullName + " isn't Generic" );
        }
        Type[] args = Type.GetGenericArguments();
        if ( args.Length != 1 ) {
            throw new ArgumentOutOfRangeException( "Type", Type.FullName + " isn't a Generic type with one argument -- e.g. T<U>" );
        }
        return args[0];
    } 
```

# c - 从 c 中 tftp 协议中的 ar/w 请求获取超时和 rexmut

> ID：10490886
> 
> 赞同：2
> 
> 时间：2012-05-08T00:18:04.367
> 
> 标签：c, timeout, tftp

我正在尝试实现一个 tftp 服务器。我有一个结构：

```
typedef struct {
    u_int16_t opcode;
    char filename[MAXPATH_STRLEN + 1];
    char mode[MAXMODE_STRLEN + 1];
    char timeout[MAXMODE_STRLEN];
    char rexmut[MAXMODE_STRLEN];

} tftp_rwq_hdr; 
```

我在 tftp 协议中接受 ar/w 请求。当我使用标准 tftp 放置文件，监听具有这种结构的请求时，我可以获得操作码、文件名和模式，但我无法获得超时，rexmut 也无法获得。

所以我的问题是从这样的请求中获取超时和 rexmut 的标准方法是什么。

# android - 如何在android中将下载的图像存储到sdcard

> ID：10490889
> 
> 赞同：-1
> 
> 时间：2012-05-08T00:18:16.293
> 
> 标签：android, image

我有以下代码可以很好地下载图像表单 url。我想通过单击按钮将加载在 imageview 中的图像保存到 sdcard。谁能帮助我如何将下载的图像保存到 SD 卡。

```
public class DownloadimageActivity extends Activity {
@Override  
public void onCreate(Bundle savedInstanceState) {  
     super.onCreate(savedInstanceState);  
     setContentView(R.layout.main);  
    }  
    public void downloadPicture(View view) {  
     final ProgressDialog dialog = ProgressDialog.show(this, "Snapshot",  
             "retriving image..");  
     dialog.show();  
     new Thread(new Runnable() {  
         @Override  
         public void run() {  
             try {  
                 final Bitmap downloadBitma = downloadBitmap("http://42.60.144.184:8081/snapshot.cgi?&user=admin&pwd=admin&resolution=8");  
                 final ImageView imageView = (ImageView) findViewById(R.id.imageView1);  
                 runOnUiThread(new Runnable() {  
                     @Override  
                     public void run() {  
                         imageView.setImageBitmap(downloadBitma);  

                     }  
                 });  

             } catch (IOException e) {  
                 e.printStackTrace();  
             } finally {  
                 dialog.dismiss();  
             }  
         }  
     }).start();  

 }  

 private Bitmap downloadBitmap(String url) throws IOException {  
     HttpUriRequest request = new HttpGet(url.toString());  
     HttpClient httpClient = new DefaultHttpClient();  
     HttpResponse response = httpClient.execute(request);  

     StatusLine statusLine = response.getStatusLine();  
     int statusCode = statusLine.getStatusCode();  
     if (statusCode == 200) {  
         HttpEntity entity = response.getEntity();  
         byte[] bytes = EntityUtils.toByteArray(entity);  

         Bitmap bitmap = BitmapFactory.decodeByteArray(bytes, 0,  
                 bytes.length);  

         return bitmap;  
     } else {  
         throw new IOException("Retrive failed, HTTP response code "  
                 + statusCode + " - " + statusLine.getReasonPhrase());  
     }

 }
 } 
```

我尝试使用以下代码，但它不起作用。

```
 ByteArrayOutputStream bytes = new ByteArrayOutputStream();
     downloadBitmap.compress(Bitmap.CompressFormat.JPEG, 40, bytes);
     //you can create a new file name "test.jpg" in sdcard folder.
     File f = new File(Environment.getExternalStorageDirectory()
                             + File.separator + "test.jpg");
     f.createNewFile();
     //write the bytes in file
     FileOutputStream fo = new FileOutputStream(f);
     fo.write(bytes.toByteArray()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:25:59.280

```
final Bitmap downloadBitma = downloadBitmap(...); 
```

您的位图名称末尾缺少“p”，因此这不起作用...

```
downloadBitmap.compress(Bitmap.CompressFormat.JPEG, 40, bytes); 
```

哦，不要给变量和方法同名——我什至不知道这在 Java 中是否合法。

# vim - 通过heredoc 给出exim 命令时设置了哪些选项？

> ID：10490898
> 
> 赞同：0
> 
> 时间：2012-05-08T00:20:04.253
> 
> 标签：vim

我有一个运行（类似于）以下命令的 bash 脚本：

```
vim -E <<EOT
call Myfunc()
EOT 
```

where`Myfunc()`在我的 .vimrc 中定义。我发现使用heredoc（而不是简单地调用它`-E`并手动输入命令）会导致vim跳过加载我的.vimrc，从而设置兼容模式（导致其他问题）。

如果必须，我可以手动加载我的 .vimrc，但我假设我不知道它在哪里，所以我想让 vim 完成这项工作。

使用 heredoc 是否使 vim 设置了一些其他选项（`-u NORC`例如），我可以取消设置以获得正常行为？

如果重要的话，我在 Vim 7.3 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T04:23:06.567

通过 heredoc 向 vim 提供参数相当于从 stdin 获取输入：

```
vim -E -
call Myfunc()
qa! 
```

这会以静默模式启动 vim（请参阅 参考资料`:help -s-ex`）并且只加载参数指定的插件`-u`。要加载所有插件，请将 ex 命令写入文件并使用该文件作为输入：

```
cat <<EOT > input.vim
call Myfunc()
qa!
EOT

vim -E input.vim 
```

（我添加`qa:`了强制vim在运行后退出`Myfunc()`。）

# algorithm - Paxos 共识算法中的“视图”是什么？

> ID：10490902
> 
> 赞同：1
> 
> 时间：2012-05-08T00:20:32.687
> 
> 标签：algorithm, distributed-computing, paxos, consensus

我在下面粘贴了 paxos 算法的伪代码，想知道是否有人能指出我正确的方向。我正在尝试实现下面的算法，但我对下面的“视图”到底代表什么感到困惑。我知道评论说它是“过去视图数字到值的映射”，但是如果有人可以向我解释这些“值”到底是什么以及“视图数字”是什么。

```
 state:
  num_h: highest proposal # seen in a prepare
  num_a, val_a: highest value and proposal # which node has accepted
  my_num: the last proposal # the node has used in this round of Paxos
  inst_h: highest view number we have accepted (round number)
  views: map of past view numbers to values
  done: leader says agreement was reached, we can start new view

on each view change, initialize state:
  num_a = 0
  num_h = 0
  my_num = 0
  val_a = () // empty list

Paxos Phase 1
  a node (maybe more than one...) decides to be leader (need not be in current view):
    my_num = max(num_h, my_num)+1, append node ID  // unique proposal number
    done = false
    sends prepare(inst_h+1, my_num) to all nodes in {views[inst_h], initial contact         node, itself}

  if node receives prepare(vid, n):
    if vid <= inst_h:
      return OLD_VIEW(vid, views[vid])  // views[vid] is the winner for vid
    else if n > num_h:
      num_h = n
      done = false
      return PROMISE(num_a, val_a)
    else:
      return REJECT()

Paxos Phase 2
  if leader gets OLD_VIEW(vid, v):
    views[vid] = v
    inst_h = vid
    view change
    restart paxos

  else if leader gets REJECT():
    delay and restart paxos

  else if leader gets PROMISE from majority of nodes in views[inst_h]:
    if any PROMISE(n_i, v_i) exists such that v_i is not empty:
      v = non-empty value v_i corresponding to highest n_i received
    else leader gets to choose a value:
      v = set of pingable nodes (including self)
    send ACCEPT(inst_h+1, my_num, v) to all responders

  else:
    delay and restart paxos

  if node gets ACCEPT(vid, n, v):
    if vid <= inst_h:
      return OLD_VIEW(vid, views[vid])
    else if n >= num_h:
      num_a = n
      val_a = v
      return ACCEPTED()
    else
      return REJECT()

Paxos Phase 3
  if leader gets OLD_VIEW(vid, v):
    views[vid] = v
    inst_h = vid
    view change
    restart paxos
  else if leader gets ACCEPTED from a majority of nodes in views[inst_h]:
    send DECIDE(inst_h+1, val_a) to all (including self)
  else:
    delay and restart paxos
  if node gets decide(vid, v):
    if vid <= inst_h:
      return OLD_VIEW(vid, views[vid])
    else:
      done = true
      primary is lowest-numbered node in v
      views[vid] = v
      inst_h = vid
      view change 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T05:00:06.383

视图对应于算法的轮次。它们被称为视图是因为算法中的每个节点都是异步的，因此每个节点对全局系统状态的理解可能已经过时了。节点使用视图来同步算法的执行。看评论说views = rounds。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T00:38:27.560

视图在论文[Paxos Made Practical](http://www.read.seas.harvard.edu/~kohler/class/08w-dsi/mazieres07paxos.pdf)中定义。“视图”是集群的特定状态，即一组机器以及指定的领导者。

我们关心视图的原因是您的集群状态可能会随着机器的来来去去而改变（例如，因为您想要重新配置集群，或者因为一台或多台机器发生故障）。

每个视图还与一个视图编号（也称为视图 ID）相关联，并且每次视图更改时，都会为新视图分配一个新的视图编号。与特定视图编号关联的值就是视图本身（集群中的机器列表）。所以“视图”可能看起来像这样：

```
{ view-number = 1 : value = { machine-01, machine-02, machine-03 },
  view-number = 2 : value = { machine-02, machine-03, machine-04 },
  view-number = 3 : value = { machine-01, machine-02, machine-04 } } 
```

您可以在论文中找到更多详细信息。

# mysql - 每个派生表都必须有自己的别名错误mysql

> ID：10490908
> 
> 赞同：1
> 
> 时间：2012-05-08T00:22:10.133
> 
> 标签：mysql, alias

我在 mysql 上运行这个查询

```
SELECT dranken.naam, evenement.waardeBonnetjes as drankPrijs  
       SUM(drankAantal1) as drankAantal from( 
           SELECT consumpties.aantal as drankAantal1 FROM consumpties, 
                  drankencategorie, consumptiebezoeker 
           WHERE drankencategorie.idCategorie = ? and
                 drankencategorie.idDranken = consumptiebezoeker.idEventDrank 
                 and consumpties.idConsumptieBezoeker = consumptiebezoeker.id 
       ), 
       SUM(totaalAantalBonnetjes1) as totaalAantalBonnetjes from( 
           SELECT dranken.aantalBonnetjes as totaalAantalBonnetjes1 from dranken,        
           evenementdrank, drankencategorie 
           WHERE dranken.id = evenementdrank.idDrank 
           and evenementdrank.idEvent = ? and drankencategorie.idCategorie = ? 
       )
FROM 
       evenement 
WHERE evenement.id = ? and drankencategorie.idCategorie = ? 
      and dranken.id = drankencategorie.idDranken 
```

它给出了错误：每个派生表都必须有自己的别名错误

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:25:27.917

```
( 
           SELECT consumpties.aantal as drankAantal1 FROM consumpties, 
                  drankencategorie, consumptiebezoeker 
           WHERE drankencategorie.idCategorie = ? and
                 drankencategorie.idDranken = consumptiebezoeker.idEventDrank 
                 and consumpties.idConsumptieBezoeker = consumptiebezoeker.id 
       ) t1 
```

第一个之外的每个选择都必须有一个别名（t1）或编译器可以引用/构建的东西。

或完整答案：

```
SELECT dranken.naam, evenement.waardeBonnetjes as drankPrijs  
       SUM(drankAantal1) as drankAantal from( 
           SELECT consumpties.aantal as drankAantal1 FROM consumpties, 
                  drankencategorie, consumptiebezoeker 
           WHERE drankencategorie.idCategorie = ? and
                 drankencategorie.idDranken = consumptiebezoeker.idEventDrank 
                 and consumpties.idConsumptieBezoeker = consumptiebezoeker.id 
       ) t1, 
       SUM(totaalAantalBonnetjes1) as totaalAantalBonnetjes from( 
           SELECT dranken.aantalBonnetjes as totaalAantalBonnetjes1 from dranken,        
           evenementdrank, drankencategorie 
           WHERE dranken.id = evenementdrank.idDrank 
           and evenementdrank.idEvent = ? and drankencategorie.idCategorie = ? 
       ) t2
FROM 
       evenement 
WHERE evenement.id = ? and drankencategorie.idCategorie = ? 
      and dranken.id = drankencategorie.idDranken 
```

# oauth - 从 YouTube ClientLogin 迁移到 OAuth 2.0

> ID：10490910
> 
> 赞同：5
> 
> 时间：2012-05-08T00:22:47.000
> 
> 标签：oauth, youtube, oauth-2.0

我有一个应用程序可以将视频上传到 YouTube 到特定的 YouTube 频道（意思是，不是到任何个人用户的频道，而是到一个频道，我有用户名和密码）。

在 ClientLogin 中，我的服务器端进程为 YouTube 提供了 U/P，一切都在进行。但是，这已被弃用，我希望升级到 OAuth 2.0（根据他们的建议），但是，文档坚持存在重定向 URI，用于用户登录时。它似乎没有解释如何绕过用户登录（因为用户没有任何东西可以登录，也没有任何凭据可以登录*with...该应用程序旨在获取他们的视频并将其上传到我们的频道）。因此，我需要绕过用户被询问任何内容，让 YouTube 简单地获取我的频道凭据并将令牌归还给我以供我上传。

我意识到这是一个完全标准且没有争议的程序，所以我*必须遗漏一些明显的东西，但我无法弄清楚那是什么。

所以，我的问题是，我如何跳过用户对话框-> 重定向，只为 youtube 提供凭据以使其接受，然后在 OAuth 2.0 中上传我的视频？

我真正想要的是在此处遵循 DirectUpload 方法： [https](https://developers.google.com/youtube/2.0/developers_guide_protocol#AuthSub_Authentication_Flow) ://developers.google.com/youtube/2.0/developers_guide_protocol#AuthSub_Authentication_Flow 并在幕后默默地检索用户令牌。

TIA

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T17:53:19.833

确实没有办法（我发现）完全绕过访问外部页面来授权 OAuth2.0 访问。我最接近的是在 code.google.com/apis/console 上创建一个“已安装的应用程序”项目并使用设备方法。您将收到一个客户 ID 和客户密码。这些将在以后使用。理想情况下，您会通过 code.google.com/apis/youtube/dashboard/ 生成开发人员密钥，但我认为此时不需要这样做

我对标头和响应使用 JSON 表示法，它应该很容易适应您选择的语言。

首先使用标头向 accounts.google.com/o/oauth2/device/code 发出 POST 请求

```
{
    'Content-Type': 'application/x-www-form-urlencoded',
    'Content-Length': post_data.length,
    'X-GData-Key': 'key=YOUR_DEVELOPER_KEY'
} 
```

以及包含以下内容的数据：

```
{
client_id: 'YOUR_CLIENT_ID',
scope: 'https://gdata.youtube.com'
} 
```

其中 YOUR_CLIENT_ID 是您为之前设置的 google apis 项目获得的客户端 ID。

你会得到这样的回应：

```
{
  "device_code" : "4/Pj8m71w5XuEMTT0ZwOJVgvlTfF4Q",
  "user_code" : "5wtw67wm",
  "verification_url" : "http://www.google.com/device",
  "expires_in" : 1800,
  "interval" : 5
} 
```

如果您在 30 分钟（每个“expires_in”响应字段 1800 秒）内没有访问 www.google.com/device（由“verification_url”字段定义），您将不得不再次执行第一个请求。在 www.google.com/device 页面上，如果您尚未登录，系统会要求您登录，然后输入验证码（由“user_code”响应字段定义）。您将看到授权应用程序的请求和应用程序请求的权限列表。您想（至少暂时）存储“device_code”字段的值。这将在请求访问令牌和刷新令牌时使用。

现在已授予权限，我们可以请求访问/刷新令牌对。这只需要在您存储刷新令牌后发生。要请求访问/刷新令牌对，您必须向 accounts.google.com/o/oauth2/token 发出带有标头的 POST 请求

```
{
    'Content-Type': 'application/x-www-form-urlencoded',
    'Content-Length': post_data.length,
    'X-GData-Key': 'key=YOUR_DEVELOPER_KEY'
} 
```

和数据

```
{
    client_id: 'YOUR_CLIENT_ID',
    client_secret: 'YOUR_CLIENT_SECRET',
    code: 'YOUR_DEVICE_CODE',
    grant_type: 'http://oauth.net/grant_type/device/1.0'
} 
```

响应将如下所示

```
{
  "access_token" : "YOUR_ACCESS_TOKEN",
  "token_type" : "Bearer",
  "expires_in" : 3600,
  "refresh_token" : "YOUR_REFRESH_TOKEN"
} 
```

这指定访问令牌在 3600 秒（60 分钟）后过期，以及您当前的访问令牌是什么以及刷新令牌是什么。您希望存储访问令牌以供当前会话使用，并存储刷新令牌以供将来的会话使用。

在发出 API 请求时，您将希望在 Authorization 标头字段中包含访问令牌，以及我们一直以来的开发人员密钥。为了上传视频，我使用了这些标题：

```
{
    'Authorization': 'Bearer YOUR_ACCESS_TOKEN',
    'X-GData-Key': 'key=YOUR_DEVELOPER_KEY',
    'Slug': 'video.mp4',
    'Content-Type': 'multipart/related; boundary="f897a6d"',
    'Content-Length': post_length,
    'Connection': 'close'
} 
```

您可以随时刷新您的访问令牌，而不仅仅是在旧令牌过期时。要刷新您的访问令牌，请向 accounts.google.com/o/oauth2/token 发出带有标头的 POST 请求

```
{
    'Content-Type': 'application/x-www-form-urlencoded',
    'Content-Length': post_data.length,
    'X-GData-Key': 'key=YOUR_DEVELOPER_KEY'
} 
```

和数据

```
{
    client_id: 'YOUR_CLIENT_ID',
    client_secret: 'YOUR_CLIENT_SECRET',
    refresh_token: 'YOUR_REFRESH_TOKEN',
    grant_type: 'refresh_token'
} 
```

你会得到这样的回应

```
{
  "access_token" : "YOUR_NEW_ACCESS_TOKEN",
  "token_type" : "Bearer",
  "expires_in" : 3600
} 
```

其中 YOUR_NEW_ACCESS_TOKEN 是您在未来请求中使用的新令牌。

# xml - 如何获取 Spring 中任何 XML 命名空间的底层 bean 配置等价物？

> ID：10490912
> 
> 赞同：0
> 
> 时间：2012-05-08T00:23:52.447
> 
> 标签：xml, spring, xsd, xml-namespaces

这是否遵循 XML 的通用名称空间设计模式，以便我可以准确推断出哪些 bean 属于哪个名称空间？如果没有，我如何检查底层 API 以便做出准确的评估？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T12:48:58.443

你可以找到，但你必须挖掘一些代码。处理命名空间的入口点是`org.springframework.beans.factory.xml.NamespaceHandler`. 此实现通常会设置许多`org.springframework.beans.factory.xml.BeanDefinitionParser`实现来处理该命名空间中的各种顶级元素。

`NamespaceHandler`实现通常根据它们支持的模式命名，但这并不能保证。要毫无疑问地确定哪个处理程序负责给定命名空间，您需要找到`spring.handlers`定义该命名空间处理程序的文件。该文件将位于包含 jar 的 META-INF 文件夹中。

例如：在 spring-tx-[version].jar 的 META-INF 文件夹中，有一个`spring.handlers`包含以下行的文件：

```
http\://www.springframework.org/schema/tx=org.springframework.transaction.config.TxNamespaceHandler 
```

也就是说，`tx`命名空间由`TxNamespaceHandler`. 如果您查看该处理程序的源代码，`init()`您将看到

```
registerBeanDefinitionParser("advice", new TxAdviceBeanDefinitionParser()); 
```

这意味着`<tx:advice>`您的 spring xml 中的语句由`org.springframework.transaction.config.TxAdviceBeanDefinitionParser`. 您可以以类似的方式`spring.handlers`深入研究任何内容。`NamespaceHandler`

# c# - 如何在运行时转换为从 String（= 类的名称）获得的类型？

> ID：10490913
> 
> 赞同：0
> 
> 时间：2012-05-08T00:23:55.587
> 
> 标签：c#, string, casting, runtime

我需要像这样投射：

```
/* Cast Brakets */                    
(Type.FromString(mystring))myObject.doSomething(); 
```

我需要获取我在运行时转换的类型，在这种特殊情况下，我不能使用通用的“T”类或方法。

尽管如果您有办法在运行时更改 T-generic Type（无需再次调用类或方法），那也会有所帮助。

这是我的问题的更具体版本：

我有一个列表组合列表，我的 GUI 可以在运行时添加新的组合框，这些将自动放入组合列表中。现在，comboList 中的每个 ComboBox 都有数据库表。我在每个 ComboBox 的 .Tag 字段中添加了每个数据库类的名称

（例如：combobox_users.Tag = "users_databaseClass"）

例如，现在在运行时我需要转换为 users_databaseClass 的类型，但在我看来这是不可能的。看来这根本不可能在运行时将类型放入强制转换括号以实际强制转换该类型。

非常感谢您的帮助，我已经尝试了几天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:50:14.877

To use the properties and methods of a wacky type, you'll need a reference to that type (e.g. `Type.GetType("string_name_of_type")`) and you'll need some pretty cool reflection (e.g. `theType.GetMethod("method_name")`). Your performance won't be great. See [http://msdn.microsoft.com/en-us/library/system.type.getmethod(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.type.getmethod(v=vs.71).aspx)

# database-design - 基于订阅的服务的数据模型

> ID：10490919
> 
> 赞同：2
> 
> 时间：2012-05-08T00:24:16.830
> 
> 标签：database-design

如果您愿意，我正在尝试对基于订阅的服务提供商进行建模并遇到“蒸汽锁”的情况。我定义了以下模型，其中用户订阅了各种服务的包 - 每个包级别包含一个或多个服务：

```
+---------------+     +-----------------+      +----------+
| Packages      |<--- | PackageServices | ---> | Services |
+---------------+     +-----------------+      +----------+
       ^
       |
+---------------+     +----------+
| Subscriptions |---> | Users    |
+---------------+     +----------+ 
```

但是，每个服务都有自己的用户定义设置 - 每个服务可能有一个关联的其他实体数组来存储服务数据。我可以为特定用户处理每个服务的数据实体，但我对设置表感到困惑。我曾想过创建一个键入用户和服务的“ServiceSettings”表格，但这似乎有点奇怪。这种方法给我留下了以下问题：

1.  如果他们升级套餐并获得新服务怎么办？
2.  如何将新的 ServiceSettings 设置或限制为仅用户已订阅的服务？
3.  如果我添加新服务怎么办？

我是在正确的轨道上，还是我似乎缺少另一种选择？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:41:24.880

我喜欢你的**ServiceSettings**；但仅用于定义每个服务的设置列表。这些服务设置的值必须存在于**SubscriptionServiceSettings**或**UserServiceSettings**中，具体取决于多个用户是否可以共享订阅但具有不同的服务设置。添加新服务时，您必须提供默认值，以便在添加时；用户首先获得这些默认值；但可以更改它们以适应他们的需要。和/或用户需要某种关于新服务设置的通知。

所以直接解决问题：

**如果他们升级套餐并获得新服务怎么办？** 使用 userServicesSettings 保留包设置，当他们订阅具有这些设置的包时，使用它们，否则忽略它们；但保留它们以供将来更改服务（又是一个业务问题）

**如何将新的 ServiceSettings 设置或限制为仅用户已订阅的服务？** 这只是订阅、包、包服务和服务设置之间的连接。（除非您想维护软件包版本；但这是完全不同的思路）

**如果我添加新服务怎么办？** 因此，您添加了新的 serviceSettings，UserServiceSettings 是默认设置（或向用户提供通知，以便他们可以填写他们想要的内容，或两者兼而有之），现在您有了所需的详细信息。默认值在动态环境中很有用，以防人们不做出您需要他们做出的决定。默认值说，除非你改变它，否则你会得到这个；导致人们接受违约或采取行动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-24T18:43:30.757

您的问题主要是关于随时间变化的。但是您的模型在时间上是静态的 - 它无法识别数据关联在过去或未来可能会有所不同。

此模型适用于仅关注当前部署的订阅的生产环境。但是为了能够进行基于时间的快照或管理服务转换，您必须至少将时间戳添加到 packageServices 表（服务到包关联的开始/结束日期），并且与订阅表类似。

**如果他们升级套餐并获得新服务怎么办？** 包需要独立于订阅而存在。如果包必须包含可选服务，那么您的模型需要一个带有时间戳的“每个客户服务配置”的附加子模式。因此，假设没有可选服务，上述模型将起作用：

1.  如果客户更换套餐，您将结束订阅并为新订阅创建新记录。

2.  如果重新配置现有包，则根据需要 enddate/ 创建新的 packageServices。

3.  请注意，定价也应该是它自己的子架构，带有时间戳，并带有指向用户的链接，因为计费总是随着时间而变化，并且必须能够进行历史查询。

**如何将新的 ServiceSettings 设置或限制为仅用户已订阅的服务？**

假设设置是用户特定的，那么您需要另一个带有时间戳的子模式将服务链接到用户。保持此子模式简单的一种方法是使其成为键/值对（serviceID、userID、SettingName、SettingValue、Begin/End Dates）

**如果我添加新服务怎么办？**

创建服务记录，将其与 packageServices 中的开始日期链接，将其与 ServiceSettingsUser 中的开始日期链接到用户。

# iphone - 使用 UIImagePicker 时如何去除从 UIImagePickerControllerEditedImage 返回的图像上的黑底

> ID：10490921
> 
> 赞同：3
> 
> 时间：2012-05-08T00:24:36.767
> 
> 标签：iphone, ios, uiimage, uiimagepickercontroller

使用 UIImagePicker 时，它允许进入编辑模式。然后对于以横向模式拍摄的图像，如果用户不在 UIImagePicker 中手动缩放它，则图像的顶部和底部会有黑色条纹/背景。有没有办法摆脱它并使图像的那部分透明？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T04:37:56.693

```
#pragma mark UIImagePickerControllerDelegate

- (void)imagePickerController:(UIImagePickerController *)picker  didFinishPickingMediaWithInfo:(NSDictionary *)info {

    UIImage *img = nil;

    CGRect cropRect = [[info valueForKey:UIImagePickerControllerCropRect] CGRectValue];

    if (cropRect.origin.y < 0) {

        img = [info objectForKey:UIImagePickerControllerOriginalImage];

    } else {

        img = [info objectForKey:UIImagePickerControllerEditedImage];

    }

} 
```

# jstree - JSTree 格式化问题 - jstree-icon 向右浮动

> ID：10490922
> 
> 赞同：0
> 
> 时间：2012-05-08T00:24:43.010
> 
> 标签：jstree

我在使用 JSTree 时遇到问题。我使用的是非常基本的示例，但`<ins class="jstree-icon">&nbsp;</ins>`它们一直浮动到树区域的右侧。

![在此处输入图像描述](../Images/0e910ef1daffc7f675f4b892b19dedca.png)

这是触发它的JS：

```
$('#adminMenuArea').jstree({
    "plugins" : ["html_data","ui","themes"]
}); 
```

这是我正在使用的 HTML：

```
<div id="adminMenuArea">
    <ul>
        <li><a id='menu-4' href='menu-4'>About Us</a></li>

        <li>
            <a id='menu-6' href='menu-6'>Services</a><!-- in -->

            <ul>
                <li><a id='menu-7' href='menu-7'>Service 1</a></li>

                <li><a id='menu-8' href='menu-8'>Service 2</a></li>

                <li>
                    <a id='menu-9' href='menu-9'>Service 3</a><!-- in -->

                    <ul>
                        <li><a id='menu-18' href='menu-18'>Sub Services1</a></li>

                        <li><a id='menu-17' href='menu-17'>Sub Services 2</a></li>
                    </ul>
                </li>
            </ul>
        </li>

        <li><a id='menu-13' href='menu-13'>Employment</a></li>

        <li><a id='menu-14' href='menu-14'>Contact Us</a></li>
    </ul>
</div> 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T15:42:02.010

问题是由于我系统中的一些其他 CSS，所有锚标记`<a>`都向左浮动。

# html - 继承父级的高度不起作用

> ID：10490933
> 
> 赞同：13
> 
> 时间：2012-05-08T00:26:34.420
> 
> 标签：html, css, jsfiddle

我希望`.cols`内部`.row`继承`.row`的高度并使其`.cols`固定在`.row`. 这是小提琴.. [http://jsfiddle.net/Hhf8R/](http://jsfiddle.net/Hhf8R/)

我的想法是让它像一张桌子，但使用 div。像这样：http: [//jsfiddle.net/hhUtb/](http://jsfiddle.net/hhUtb/)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-08T00:35:14.250

为了让 div 达到其父级高度的 100%，父级必须具有定义的高度。

浏览器无法计算 100%（或继承）尚未完全呈现的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T00:35:29.753

`height`如果您希望子代继承它，则需要在父代上设置CSS 属性。

如果您希望您的高度根据内容动态变化，那么不幸的是，使用 CSS 无法轻松实现这一点。有几种不同的方法；[这](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)似乎是一个不错的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T00:45:16.647

您需要在父`row`级上明确高度才能`inherit`有意义。

向您的行添加高度声明：

[http://jsfiddle.net/LzkgU/](http://jsfiddle.net/LzkgU/)

并且浮动列确实继承了父级的高度。

（旁注：会有人告诉你花车不能继承高度：

[CSS - 让 div 继承一个高度](https://stackoverflow.com/questions/5474951/css-make-divs-inherit-a-height)

但不一定如此。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-27T14:04:13.247

您可以通过检查可能改变您的内容的更改来修复 js 中内容的高度。

例如，我有一个 Html 编辑器，它使用 setTimeout 为光标设置动画。当光标动画时，如果需要，我会更改单元格的高度。

# apache - httpd.conf 和虚拟主机 SSL 的重写规则

> ID：10490936
> 
> 赞同：4
> 
> 时间：2012-05-08T00:26:43.787
> 
> 标签：apache, .htaccess, mod-rewrite, virtualhost, httpd.conf

我在 httpd.conf 中有两台虚拟主机，一台用于端口 443，一台用于端口 80：

```
<VirtualHost IPADDRESS:80>
</VirtualHost>

<VirtualHost IPADDRESS:443>
</VirtualHost> 
```

现在我想将每个请求重定向到我的服务器去，`https://www.mysite.com/`除了`http://www.mysite.com/blog/`我希望博客是非 SSL 的。我应该将 RewriteRules 放在哪个 virtualHost 指令中？我需要什么样的规则？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T02:10:32.650

在端口 80 VirtualHost 中，一条规则会将所有不是博客的内容重写为 SSL。在 443 主机中，它将博客请求重写为非 ssl（如果你想强制它们回到非 ssl）

```
<VirtualHost IPADDRESS:80>
  RewriteEngine On

  # Rewrite everything except the blog to SSL
  RewriteCond %{REQUEST_URI} !^/blog
  RewriteRule (.*) https://www.example.com/$1 [L,R,QSA]
</VirtualHost>

<VirtualHost IPADDRESS:443>
  RewriteEngine On

  # Rewrite the blog back to plain http
  # Leave this out if you don't care that https requests to the blog stay
  # on ssl
  RewriteRule ^(blog*) http://www.example.com/$1 [L,R,QSA]
</VirtualHost> 
```

# ruby-on-rails - rails 使用 current_user 和匹配的路由设计：id

> ID：10490937
> 
> 赞同：0
> 
> 时间：2012-05-08T00:27:01.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, ruby-on-rails-3.2, controllers

我在设计 current_user 时遇到问题，将我的模型的 :id 混淆为用户 :id。

路线：

```
match "/causes/:id/:slug" => "causes#show", :as => :cause, :via => 'get'
match "/causes/:id/:slug/edit" => "causes#edit", :as => :edit_cause, :via => 'get'
match "/causes/:id/:slug" => "causes#update", :via => 'put'

resources :causes, :only => [:index, :new, :create] 
```

在我的：原因控制器中：

```
before_filter :check_privileges, only: [:new, :create, :edit, :new, :update]

def check_privileges
    #when I use this code everyone can access edit, etc.
    redirect_to root_path unless current_user
end 
```

在我的 :causes 模型中

```
 belongs_to :user 
```

出于某种原因，当我完全使用 current_user 时，在这个控制器中，它总是认为 current_user 等于 /causes/:id/:slug/ 中的 id

我尝试将检查权限代码放在应用程序控制器中，

我什至尝试过分配这样的代码：

```
def check_privileges
    #when I use this code no one can access edit, etc
    @user = User.find_by_id(params[:id])
    redirect_to root_path unless @user
end 
```

我需要帮助，有人有建议吗？我想要做的就是验证用户是当前用户，所以不是每个人都可以编辑原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T13:40:04.747

你的帖子有点混乱。IIRC 设计将当前用户 id 存储在会话中，并且不会从 url 中获取它。

看到这是与特权相关的问题并推出您自己的解决方案。我强烈推荐一个替代方案。

[https://github.com/ryanb/cancan](https://github.com/ryanb/cancan)

这对设计很有用，应该可以解决您的问题

# android - Android：ActivityGroup——如何“弹出”视图

> ID：10490938
> 
> 赞同：1
> 
> 时间：2012-05-08T00:27:22.613
> 
> 标签：android, tabactivity, activitygroup

我在我的 TabView 中实现了一个 ActivityGroup。

我可以从选项卡中的活动成功地将视图添加到 ActivityGroup。

如何从堆栈中弹出这个新视图以返回原始视图？

在 ActivityGroup 中，我使用 Finsih() 处理 BackButton，但整个应用程序消失并显示主屏幕。请注意，该应用程序没有被杀死，它仍在运行。

（用 .NET 编写）

```
public override void OnBackPressed ()
    {
        int length = mIdList.Count;
        if (length > 1)
        {
            Activity current = LocalActivityManager.GetActivity (mIdList [length - 1]);
            current.Finish();
        }           
        base.OnBackPressed ();
    } 
```

（我来自iOS背景）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T14:19:28.680

First, I agree with aneal that you should try [Fragments](http://developer.android.com/training/basics/fragments/index.html) rather than activity groups. If you do, the following text from the Android [on-line training class](http://developer.android.com/training/basics/fragments/fragment-ui.html) appears to address the issue:

> Keep in mind that when you perform fragment transactions, such as replace or remove one, it's often appropriate to allow the user to navigate backward and "undo" the change. To allow the user to navigate backward through the fragment transactions, you must call addToBackStack() before you commit the FragmentTransaction.

When you add the view, call addToBackStack() before committing your "add fragment" transaction.

# java - 在 org.springframework.web.context.ContextLoaderListener 中使用 Spring 启动 Tomcat 服务器

> ID：10490941
> 
> 赞同：0
> 
> 时间：2012-05-08T00:27:26.063
> 
> 标签：java, eclipse, spring, apache, tomcat

我目前正在尝试启动并运行 Tomcat。看起来好像 Spring 出了问题。环顾四周，似乎我的 common-* 文件或类似文件有问题。但是，我没有发现任何东西似乎很有希望。

我理解的一些事情是我的 WEB-INF/ 文件夹中可能缺少 .jar 文件，或者我没有正确的 DBCP 版本。其他任何事情都超出了我的范围。

```
May 07, 2012 5:48:45 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
java.lang.VerifyError: Expecting a stackmap frame at branch target 249 in method com.expertwebdev.tribe.auth.AuthServiceImpl.loadUserByUsername(Ljava/lang/String;)Lorg/springframework/security/core/userdetails/UserDetails; at offset 0
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Unknown Source)
    at java.lang.Class.getDeclaredConstructors(Unknown Source)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:227)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:930)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:903)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:580)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)
    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:276)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:197)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4779)
    at     org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5273)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)

May 07, 2012 5:48:45 PM org.apache.catalina.core.StandardContext startInternal
SEVERE: Error listenerStart
May 07, 2012 5:48:45 PM org.apache.catalina.core.StandardContext startInternal
SEVERE: Context [/utero] startup failed due to previous errors
May 07, 2012 5:48:45 PM org.apache.catalina.core.ApplicationContext log
INFO: Closing Spring root WebApplicationContext
May 07, 2012 5:48:45 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
May 07, 2012 5:48:45 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["ajp-bio-8009"]
May 07, 2012 5:48:45 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 8901 ms 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T01:32:35.860

似乎您正在尝试在 JRE 7 JVM 上运行使用 java 6（spring 框架）编译的代码。

VerifyError[很](http://docs.oracle.com/javase/7/docs/api/java/lang/VerifyError.html)明显，该类`Class`希望找到 JRE 中不存在的一些本机方法`getDeclaredConstructors0(Native Method)`。`Class`因此， Spring 框架 jar 调用的实际类与 JVM 中可用的本机方法之间存在矛盾。

另外，请参阅[此答案](https://stackoverflow.com/questions/8958267/java-lang-verifyerror-expecting-a-stackmap-frame)，该答案在同一类`Class`方法中显示了类似的问题。这也是那里的问题。

简而言之，检查您的 spring jar 是否与您使用的 JRE 兼容。

# ms-access - 使用 MS Access 2007，

> ID：10490947
> 
> 赞同：-1
> 
> 时间：2012-05-08T00:28:00.660
> 
> 标签：ms-access, ms-access-2007

我正在 MS Access 2007 中做一个项目，我将计算每个学生的缺勤次数。这将是表格：

```
name of student | absent1 | absent2 | absent3 | absent4 | absent5 | total

ryan llorcanuada| 05-7-12 | 05-8-12 | 05-9-12 |________ | _______ | 3 
```

每个学生的最大缺勤次数为 5。因此，根据表格，该学生仅缺勤 3 次，其余字段为空白。假设，表格将在总计字段中显示 3。我要怎么做？如果学生没有缺勤怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:18:31.920

那么，问题是“设计一张桌子来存储缺勤的最佳方式是什么？” 还是“根据下表，您如何计算学生的缺勤次数？”

我问是因为显示的表格是构建数据库的一种非常糟糕的方式。要解决此结构的问题，您可能必须使用一系列 IIF 函数。请尝试一些东西并发布您尝试过的内容，然后人们可以帮助您解决您的问题。

# java - 来自joda-time DateTimeFormatter的模式字符串？

> ID：10490951
> 
> 赞同：16
> 
> 时间：2012-05-08T00:28:15.973
> 
> 标签：java, jodatime

是否可以从 joda-time DateTimeFormatter 获取模式字符串？

```
DateTimeFormatter formatter = DateTimeFormat.forPattern("yyyyMMdd");
String originalPattern = formatter. ??? 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-08T01:09:26.427

Joda Time 不提供从 DateTimeFormatter 获取原始模式的方法。一个原因可能是 DateTimeFormatter 不一定是从模式创建的。例如`DateTimeFormat.forStyle()`根本不使用模式。

但是，如果您总是使用模式，那么您可以包装`DateTimeFormat`类以在`DateTimeFormatter`构造 时记录模式。这样，您以后可以使用简单的静态方法查找它。例如：

```
public class ReversableDateTimeFormat {

  private static final Map<DateTimeFormatter, String> patternHistory = new HashMap<DateTimeFormatter, String>();

  public static DateTimeFormatter forPattern(String pattern) {
    DateTimeFormatter dateTimeFormatter = DateTimeFormat.forPattern(pattern);
    patternHistory.put(dateTimeFormatter, pattern);
    return dateTimeFormatter;
  }

  public static String getPattern(DateTimeFormatter dateTimeFormatter) {
    return patternHistory.get(dateTimeFormatter);
  }

} 
```

然后你可以这样做：

```
DateTimeFormatter formatter = ReversableDateTimeFormat.forPattern("yyyyMMdd");
String originalPattern = ReverseableDateTimeFormat.getPattern(formatter); 
```

# pentaho - 从子报表生成主报表中的列总计 - Pentaho

> ID：10490952
> 
> 赞同：1
> 
> 时间：2012-05-08T00:28:31.480
> 
> 标签：pentaho

我正在 pentaho 报表设计器中创建一个报表。我的主报告中有一个子报告，其中有一些值。我想在主报告中显示子报告中这些值的总和。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T05:25:51.170

或者更好的是，如果您只想在报表上显示它而不在任何其他功能中使用它，只需将您想要总计的字段拖到组页脚或报表页脚部分，单击向导聚合属性并设置总和。

如果您想以其他方式（即附加公式等）引用总数，则应使用该函数。因为这个“向导聚合”属性实际上只是一个显示属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T02:09:30.353

`Sum`通过右键单击`Functions`，然后单击 来使用该功能`Add Functions`。添加要在主报告中显示的值总和的字段（在字段名称下）。之后，只需将您制作的功能拖到报表上即可。

# c# - 如何在二进制网络流中分离消息？

> ID：10490954
> 
> 赞同：3
> 
> 时间：2012-05-08T00:28:47.600
> 
> 标签：c#, sockets, networking, buffer, networkstream

我正在使用套接字/networkStream 编码、发送和解码数据。但是我怎样才能有效地将消息彼此分开呢？

例如，当我使用 1024 字节缓冲区时，然后通过 networkStream 接收内容。然后我想将该缓冲区传递给我的解码器类，但我不确定下一条消息的一部分是否已经潜伏在缓冲区中。如果我的消息只有 50 个字节，我怎么知道该缓冲区中没有 20 条消息？或者更糟糕的是，我的缓冲区中是否有部分消息？

假设我的消息有 3000 个字节，缓冲区中是否有一条消息和第二条消息的开始？还是 networkStream 在发送时自动接收包中的消息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:29:55.140

一般有两种选择：

*   发送一个固定大小的标头，指定以下消息的确切长度。
*   发送后跟不能出现在消息中的终止符的消息。

通过套接字发送可变大小二进制数据的所有方法都是这两个主题之一的变体。

# python - 与服务器断开连接时出错

> ID：10490955
> 
> 赞同：1
> 
> 时间：2012-05-08T00:29:01.767
> 
> 标签：python, python-2.7

我不断得到这个：

```
 Traceback (most recent call last):
  File "C:\Users\T_Mac\Desktop\Rex's Stuff\PyNet\Client.py", line 14, in <module
>
    server.connect(ADDRESS)
  File "C:\Python27\lib\socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
  File "C:\Python27\lib\socket.py", line 170, in _dummy
    raise error(EBADF, 'Bad file descriptor')
socket.error: [Errno 9] Bad file descriptor 
```

当我使用此代码作为服务器运行“changeclient”时：

```
#  Server

from socket import *

PORT = 5000
BUFSIZE = 1024
ADDRESS = ('', PORT)        # '' = all addresses.
server = socket(AF_INET, SOCK_STREAM)

server.bind(ADDRESS)
server.listen(5)
# print stuff the user needs to know
print ''
print '  ____              _____     ___    _______    '
print ' /    \  |      |  /     \   /____\     |       '
print '|      | |      | |       | |           |       '
print ' \____/   \____/| |       |  \____/     |   v0.1'
print ' |              |                               '
print ' |              |                               '
print ' |              |                               '
print ' |        _____/                                '
print 'Contact Rex for any bug reports at rexploits@gmail.com'
print '\n'
print 'Please input the command when prompted with \'>\''
print 'The stdout stuff will be in this format: '
print '     (<stdout>, <stderr>)\n'

while True:
    END_SCRIPT = 0                                          #Setting command to something other than '1'
    print '\nWaiting for connections...'
    client, address = server.accept()
    print '...client connected from ', address[0], '\n'
    while True: 
        command = raw_input('> ')
        if command == 'quit':
            server.close()
            END_SCRIPT = 1
            break
        elif command == 'exit':
            server.close()
            END_SCRIPT = 1
            break
        elif command == 'changeclient':
            print 'Changing clients.....\n'
            client.send(command)
            break
        else:
            client.send(command)
            commandJazz = client.recv(BUFSIZE)
            print commandJazz
    if END_SCRIPT == 1:
        print 'Closing server......'
        print 'Goodbye!'
        break
server.close() 
```

这是我的客户：

```
#  client

from subprocess import *
from socket import *
import time
test = 0
PORT = 5000
IP = 'localhost'        #To change it to your ip, delete 'raw_input('> ')' and put your IP in its place.
BUFSIZE = 1024
ADDRESS = (IP, PORT)
server = socket(AF_INET, SOCK_STREAM)

while True:
    server.connect(ADDRESS)
    while True:
        command = server.recv(BUFSIZE)
        if command == 'changeclient':
            server.close()
            test = 1
            break
        else:
            executeIt = Popen(command, shell = True, stdin = PIPE, stdout = PIPE, stderr = STDOUT)
            commandJazz = executeIt.communicate()
            strCommandJazz = str(commandJazz)
            server.send(strCommandJazz) 
```

我运行我的服务器，然后运行我的客户端的两个实例。它连接良好，一切正常。我已经内置了一个名为 changeclient 的命令来断开当前客户端并连接到另一个客户端。每当我执行 changeclient 时，我都会在客户端上收到之前发布的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T02:34:46.200

当你关闭你的套接字时，不要重复使用它。创建一个新的：

```
server = socket(AF_INET, SOCK_STREAM)
server.connect(ADDRESS) 
```

现在您正尝试在同一个套接字实例上重新连接。

您还可以尝试使用一个标志来告诉套接字在您重新打开它而不是创建一个新端口时重用它。

```
server.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) 
```

# c# - 像“foreach（table.Rows 中的第 x 行）”之类的东西，但是对于日历控制天？

> ID：10490956
> 
> 赞同：0
> 
> 时间：2012-05-08T00:29:18.787
> 
> 标签：c#, asp.net, foreach, calendar, web-controls

我们有一个 ASP.Net 日历控件，在 DayRender 事件中，我们有以下代码：

```
protected void calminical1_DayRender(object sender, DayRenderEventArgs e)
{
    CheckBox mycb = new CheckBox();
    e.Cell.Controls.Add(mycb);
} 
```

这使得日历中的每一天都包含一个复选框。这背后的目的和想法是，员工可以通过简单地在日历中选择他/她想要休假的日子来申请休假。

问题是，我不知道如何遍历日历以找出用户检查的日期。

对于 GridViews，我经常使用：

```
foreach (Row x in table.Rows)
{
   //loop through all rows
} 
```

本质上我需要做同样的事情，但对于日历控件的“单元格”或“天数”。这些网络控件中的大多数都具有明显且直观的集合，即下拉列表和其他列表控件具有“项目”，表格和网格视图具有“行”，但我似乎无法找到日历控件的等价物。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T07:21:58.940

这是我最终用来实现我想要的代码的代码。也许其他人会发现它很有用：

```
protected void Calendar1_SelectionChanged(object sender, EventArgs e)
{
    AddToDates(Calendar1.SelectedDate);
}

private void AddToDates(DateTime newDate)
{
    DateTime selecteddate;
    ArrayList datelist;
    if (ViewState["SelectedDates"] != null)
    {
        datelist = (ArrayList)ViewState["SelectedDates"];
        for (int x = 0; x < datelist.Count; x++)
        {
            selecteddate = (DateTime)datelist[x];
            Calendar1.SelectedDates.Add(selecteddate);
        }
    }
    else
    {
        datelist = new ArrayList();
    }
    if (datelist.Contains(newDate))
    {
        Calendar1.SelectedDates.Remove(newDate);
        datelist.Remove(newDate);
    }
    else
    {
        Calendar1.SelectedDates.Add(newDate);
        datelist.Add(newDate);
    }

    ViewState["SelectedDates"] = datelist;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T00:41:21.843

也许您应该使用某种数据结构来保存应用程序的状态，而不是日历本身。

您可以注册 DateSelected-Event 以捕获选定的日期并保存它。之后，您可以循环浏览您保存的日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:46:38.030

我会这样做：

在 Javascript 中在您的 aspx 页面上创建一个数组

var 日期=新数组（）；

```
Sub ca_DayRender(sender As Object, e As DayRenderEventArgs)
   Dim d as CalendarDay
   Dim c as TableCell
   Dim datOrigin as Date = "1-1-2000"
   Dim strDayNum as String
   d = e.Day
   c = e.Cell
   strDayNum = CStr(DateDiff("d", datOrigin, d.date))
   If d.IsOtherMonth Then
     c.Controls.Clear
   Else
     c.Attributes.Add("OnClick", "dates.push(strDayNum);)
   End If
 End Sub 
```

然后，您可以在需要使用值时通过回发访问数组

"javascript:__doPostBack('ca','" & strDayNum & "')"

# javascript - 它在哪里记录了字符串下标产生一个字符？

> ID：10490959
> 
> 赞同：1
> 
> 时间：2012-05-08T00:29:55.293
> 
> 标签：javascript

当我这样做时，我很惊讶：

```
var s = "Cities of the Internet";
var strings = s.split(" ");
alert (s[2]); // shows t!!!!! 
```

当然我意识到我的意思是字符串[2]，但是为什么下标字符串会产生一个字符。我在阅读 JavaScript 书籍时是否遗漏了什么？我大概做到了。这是标准吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T00:35:00.303

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String#Character_access](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String#Character_access)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T00:48:07.097

如果你想要一个规范的参考，你应该寻找 ECMA-262 规范。有一个我觉得很方便的[HTML 版本。](http://ecma262-5.com/)

为了能够通过索引访问特定字符，第 15 节是我要开始的地方。我在那里看到了一些相关的材料。

**[§ 15.5.5](http://ecma262-5.com/ELS5_Section_15.htm#Section_15.5.5)字符串实例的属性**

> 名为属性的数组索引对应于字符串值的各个字符。一个特殊的 [[GetOwnProperty]] 内部方法用于指定数组索引命名属性的数量、值和属性。

这又指的是[§ 15.5.5.2](http://ecma262-5.com/ELS5_Section_15.htm#Section_15.5.5.2)，因为这是定义 [[GetOwnProperty]] 的地方。该规范相当密集且难以阅读，但如果您想要某种关于为什么会发生这种情况的规范描述，那就是它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:35:42.950

因为 s[2] 等于“互联网城市”[2]。正确的代码是：

```
var s = "Cities of the Internet";
var strings = s.split(" ");
alert (strings [2]); // shows the!!!!! 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-08T00:34:59.880

```
var s = "Cities of the Internet"; 
```

如我们所见，`s`是一个字符串。

```
var strings = s.split(" "); 
```

现在，`strings`是一个字符串数组`"Cities", "of", "the", "Internet"`，因为它是通过分割`s`一个空格创建的。

```
alert (s[2]); 
```

您正在提醒 string 的第三个字符（因为它们从 0 开始编号）`s`。

```
"Cities of the Internet"[2] == "t" 
```

这是“城市”一词中的“t”。您的困惑可能源于您想致电

```
alert (strings[2]); 
```

不，我不会为这样一件微不足道的事情指出一本书的章节。

# php - 在视图中使用 JSON 数据

> ID：10490960
> 
> 赞同：1
> 
> 时间：2012-05-08T00:29:56.243
> 
> 标签：php, ajax, json

我有一个非常复杂的 PHP/HTML 视图。但是，我最近更改了我的网站以使用 AJAX 自动刷新。它当前返回一个 JSON 数组，我需要使用该数据重现我的视图。

这是我的 AJAX：

```
$(function() {
    $( "#selectable" ).selectable({
        selected: updatefilters,
    });   
    function updatefilters(ev, ui){
        // get the selected filters
        var $selected = $('#selectable').children('.ui-selected');
        // create a string that has each filter separated by a pipe ("|")
        var filters = $selected.map(function(){return this.id;}).get().join("\|");
        $.ajax({
            type: "POST",
            url: 'updatefilters',
            dataType: 'json', 
            data: { filters: filters },
            success: function(data){
                var html = "<div id ='board'><table>";
                for (i=0 ; i< data.length ; i++)
                {
                     html += "<tr><td>" + data[i].subject + "</td><td>" + data[i].body + "</td></tr>";
                }
                html += "</table></div>";
                $('#board').html(html);
            }
        });
    }
}); 
```

这是我的 PHP 文件：

```
<div id='board'>
<?php
if ($threads)
    {
        $count = count($threads);
        $perpage = 17;
        $startlist = 3;
        $numpages = ceil($count / $perpage);
        if ($page == 'home') {$page = 1;}
        $threadstart = ($page * $perpage) - $perpage;
        $i = 0;
        echo "<table class='board'>
    <tr>
            <th width='5%'><img src='".base_url()."img/board/icons/category_icon.png' alt='category_icon'/></th>
            <th width='5%'>Tag</th>
            <th width='50%'>Subject</th>
            <th width='7.5%'>Author</th>
            <th width='7.5%'>Replies/Views</th> 
            <th width='15%'>Last Post</th>
    </tr>";
        foreach ($threads as $list) 
        {   $i++;
            $thread_owner = $this->thread_model->get_owner($list['owner_id']);
            $thread_id = $list['thread_id'];
            $query = $this->db->query("SELECT f.tag FROM filter_thread AS ft
                                        INNER JOIN filter AS f ON ft.filter_id = f.filter_id
                                        WHERE thread_id = $thread_id");
            $result = $query->result_array();
            $trunc_body = $this->thread_model->get_reply_summary($thread_id);
            $filter = "";
            $filter2 ="";
            $ent = "entertainment";
            foreach ($result as $string)
            {
                if ($string['tag'] == $ent) {
                    $filter2 .= "<div id='entertainment'><p>";
                    $filter2 .= "<img src='".base_url()."img/board/icons/entertainment_icon.png' title='Entertainment' alt='Entertainment'/>";
                    $filter2 .= "</p></div>";
                } else {
                $filter2 .= "<div id='misc'><p>";
                $filter2 .= "<img src='".base_url()."img/board/icons/misc_icon.png' title='Misc' alt='Misc'/>";
                $filter2 .= "</p></div>";
                $filter .= " [".$string['tag']."]";
                }
            }
            if (!$result) { $filter = "" AND $filter2 =""; }
            if ($i > $threadstart AND $i <= $threadstart + $perpage) 
            { 
                echo "<tr>";
                echo "<td>".$filter2."</td>";
                echo "<td>".$filter."</td>";
                echo "<td title='".$trunc_body['0']['body']."'><a href=".base_url()."main/thread/".$list['slug'].">".ucfirst($list['subject'])."<div id='filter'><p></p></div></a></td>"; 
                echo "<td><p>".$thread_owner."</p></td>";
                echo "<td align='right'>Replies: ".$list['replies_num']."<br>Views: ".$list['views']."</td>";
                $owner = $this->thread_model->get_owner($list['last_post_id']);
                echo "<td>".$owner." <br>".$list['replystamp'] ."</td></tr>";   
            }  
        }
        echo "</table>";
        echo "<br>";
        echo "Current Page: $page | ";    
        echo "Page: ";

        for ($n = 1; $n < $numpages+1; $n++) 
        {
            echo "<a href=".base_url()."main/home/$n>$n</a> | ";
        }
    }
?>
</div> 
```

有没有一种不太难的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T00:37:26.353

尝试`header("Content-Type: text/plain");`在 PHP 文件的顶部添加。

此外，将 移动`<div id='board'>`到脚本内的变量 - 在`header()`函数之后。

此外，将 all 更改`echo`为变量，将这些变量放入数组中，然后使用

```
json_encode($array); 
```

例子：

```
$output = "<div id='board'>";

$output .= "<table class='board'>
    <tr>
            <th width='5%'><img src='".base_url()."img/board/icons/category_icon.png' alt='category_icon'/></th>
            <th width='5%'>Tag</th>
            <th width='50%'>Subject</th>
            <th width='7.5%'>Author</th>
            <th width='7.5%'>Replies/Views</th> 
            <th width='15%'>Last Post</th>
    </tr>";

echo json_encode( array('output'=>$output) ); 
```

# php - 使用 SOCKS 代理在 php 中建立套接字连接

> ID：10490962
> 
> 赞同：2
> 
> 时间：2012-05-08T00:30:17.477
> 
> 标签：php, sockets, networking, socks

我正在尝试通过 socks 4/5 代理在 php 中建立套接字连接。我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T01:47:35.460

尽管我从未用 PHP 编写过任何可代理的代码（我在 Perl 中编写过），但您需要使用代理库来调用代理服务器，以便将它们中继到您的目的地。

这是一篇讨论 PHP 代理的文章。 [http://gdatatips.blogspot.com/2008/09/using-php-client-library-through-proxy.html?m=1](http://gdatatips.blogspot.com/2008/09/using-php-client-library-through-proxy.html?m=1)

希望这可以帮助。

# c++ - 用于在另一个文本中搜索长度超过 14 个字符的匹配子字符串的高效算法

> ID：10490963
> 
> 赞同：8
> 
> 时间：2012-05-08T00:30:28.293
> 
> 标签：c++, c, string, algorithm

我有一个长文本（大约 5 MB 文件大小）和另一个称为模式的文本（大约 2000 个字符）。

任务是从长文本中 15 个字符或更长的基因组模式中找到匹配的部分。

例子：

长文本： ACGTACGTGTCA *AAAACCCCGGGGTTTTA* **GTACCCGTAGGCGTAT 并且** 更长

 *模式： ACGGTATTGAC **AAAACCCCGGGGTTTA** TGTTCCCAG

我正在寻找一种高效（且易于理解和实现）的算法。

如果可能的话，奖金将是一种在 C++ 中仅使用字符数组来实现这一点的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T04:34:55.670

这是一种算法——我不确定它是否有名字。它需要一个“滚动散列” - 一个（非加密）散列函数，它具有给定序列散列的属性，`AB...C`计算序列的散列是有效的`B...CD`。

1.  计算序列`pattern[0..14]`, `pattern[1..15]`, `pattern[2..16]`... 的滚动哈希，并将每个索引存储`pattern`在哈希表中。

2.  计算滚动哈希，`haystack[0..14]`看看它是否在哈希表中。如果是，则与从哈希表中检索`haystack[0..14]`到的`pattern[pos..pos+14]`位置进行比较。`pos`

3.  从 的滚动哈希中`haystack[0..14]`，高效计算 的滚动哈希，`haystack[1..15]`看是否在哈希表中。重复直到到达终点`haystack`。

请注意，您的 15 个字符串只有 2 ^(30 个)可能的值，因此您的“哈希函数”可能是一个简单的映射到字符串的值，该字符串被视为 15 位 base-4 数字，计算速度很快，具有滚动哈希属性并且是独一无二的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-08T04:12:53.193

一种方法是获取[Aho-Corasick](http://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm)的实现并使用它来创建可以识别模式中任何 15 个字符块的内容，然后使用它来搜索文本。使用 Aho-Corasick 构建匹配器的成本和搜索成本都是线性的，所以这应该是实用的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-08T01:17:04.150

[退后一步](http://www.ourspacer.com/images/graphics/political/Stand-the-fuck-back,-I-got-this.jpg)，我要现场编码：

```
void match_substring(const char *a, const char *b, int n) // n=15 in your case
{
    int alen = strlen(a); // I'll leave all the null-checking and buffer-overrun business as an exercise to the reader
    int blen = strlen(b);
    for (int i=0; i<alen; i++) {
        for (int j=0; j<blen; j++) {
            for (int k; (i+k<alen) && (j+k<blen) && a[i+k]==b[i+k]; k++);
            if (k >= n)
                printf("match from (%d:%d) for %d bytes\n", i, j, k);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T01:15:39.903

如果您使用的是 C 库的良好实现（或者甚至是像 glibc 这样的平庸的库，恰好具有该函数的良好实现），`strstr`那么会做得很好。我听说有一种新算法对 DNA（小字母）特别有用，但我现在找不到参考。除此之外，2way（glibc 使用）是最佳的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T04:44:35.780

我强烈建议你去你的图书馆看看 Robert Sedgwick 和 Kevin Wayne 的“Algorithms 4th Edition”。他们有一整章专门讨论子字符串搜索。此外，可能值得查看书籍网站[algs4.cs.princeton.edu](http://algs4.cs.princeton.edu)。

TL;DR——如果你下定决心，你可以在保证时间与输入长度成线性关系时使用 char 数组进行子字符串搜索。书中和网上都有代码示例。没有比这更容易的了。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-11T05:16:03.307

我认为“后缀树”可以通过 O(log n) 的性能更好地解决它*

# github - 将分支与 GitHub for Mac 合并的问题

> ID：10490968
> 
> 赞同：4
> 
> 时间：2012-05-08T00:30:49.770
> 
> 标签：github, github-for-mac

我正在尝试使用 GitHub for Mac GUI 来掌握合并分支的窍门。我现在不确定是我还是客户....

我有一个包含 master、staging、生产分支的仓库。我在 master 中创建了一个名为 test.txt 的文件。然后我向它添加了一条测试线。我在主服务器中提交并同步。我使用gui从master合并到staging，然后点击merge。我还重新单击了“同步中的分支”以重新同步它们。新行显示在 GitHub 的 master 下，但不在 staging 下。在我的本地存储库中，它显示与最新提交同步。

我的计划是在 master 中进行编辑，合并到 staging 以进行部署和测试，冲洗，起泡并重复，直到它很好，然后合并到生产中（此时一切都应该同步）。

难道我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T00:41:24.853

这看起来像[GitHub for Mac 第 3 期](https://github.com/baldwindavid/github-for-mac-issues/issues/3)：

### 合并分支无法识别要同步的新更改

> 似乎**在合并接收分支的时候不承认新的更改可以与 Github 同步**
> 
> 执行的步骤
> 
> *   添加并签出“ `experimental`”分支
> *   添加/提交到`experimental`分支
> *   合并`experimental`分支到`master`
> *   `master`显示按钮“ `Branch in Sync`”，即使它不再同步 - 按下按钮什么也不做
> 
> 怎么修
> 
> *   直接添加一个新的提交`master`
> *   " `Sync Branch`" 出现并可以同步到 Github

* * *

[OP skinnygeek1010](https://stackoverflow.com/users/775600/skinnygeek1010)报告：

> 我找到了一个很好的解决方法：
> 
> 要将 master 与 staging 合并，请与 GUI 合并。
> 完成后，切换到暂存，然后转到下拉菜单：( `Repository > Synchronize`) `Cmd` `S`。
> 合并将立即显示在 GitHub 上（如果您在 master 中同步，则不会工作）

# c# - JSON.NET 忽略集合类型对象上的 ISerializable

> ID：10490969
> 
> 赞同：4
> 
> 时间：2012-05-08T00:30:50.510
> 
> 标签：c#, json.net

我有一个看起来像这样的包装列表：

```
[JsonObject(MemberSerialization.Fields)]
public class OrderManager : IEnumerable<Order>, ISerializable
{
    public OrderManager()
    { }

    private List<Order> orders = new List<Order>();

    public void AddOrder(OrderInfo orderInfo)
    {
        // do the work of making an order object from an OrderInfo.
        // Add the new order object to the private list of orders
        // orders.Add(order);
    }

    public IEnumerator<Order> GetEnumerator()
    {
        return orders.GetEnumerator();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return orders.GetEnumerator();
    }

    public OrderManager(SerializationInfo info, StreamingContext context)
    {
        // do custom serialization work here (never gets hit)
    }

    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        // do custom serialization work here (never gets hit)
    }
} 
```

我在这样的客户类中包含一个字段实例：

```
[JsonObject(MemberSerialization.Fields)]
public class Customer
{
    public Customer()
    { }

    private OrderManager _orders
        = new OrderManager();
    public OrderManager Orders
    {
        get { return _orders; }
        set { _orders = value; }
    }
} 
```

我可以序列化一个客户，但是上面的`ISerializable`接口`OrderManager`被忽略了。如果我从（可能是阻止使用的）中删除该`JsonObject`属性，则该属性将被视为一个数组，并且该接口仍然被忽略。`OrderManager``ISerializable``OrderManager``ISerializable`

我尝试使用`ICollection`而不是`IEnumerable`： [JSON.NET 无法反序列化包装的集合](https://stackoverflow.com/questions/10488351/json-net-cannot-deserialize-a-wrapped-collection)

由于我的包装集合是 type`Order`并且我的`AddOrder`方法接受了`OrderInfo`，因此公开它并没有真正起作用`ICollection<Order>`。无论哪种方式，`ISerializable`界面都被忽略了。

有什么解决方法吗？

*更新*

只是为了澄清我确实将 IgnoreSerializableInterface 设置为 false。

```
private JsonSerializer GetSerializer()
{
    var serializer = new JsonSerializer();

    serializer.TypeNameHandling = TypeNameHandling.Auto;
    serializer.TypeNameAssemblyFormat = System.Runtime.Serialization.Formatters.FormatterAssemblyStyle.Simple;

    var contractResolver = new DefaultContractResolver(true);
    contractResolver.IgnoreSerializableAttribute = false;
    contractResolver.IgnoreSerializableInterface = false;

    serializer.ContractResolver = contractResolver;

    serializer.PreserveReferencesHandling = PreserveReferencesHandling.All;
    serializer.ReferenceLoopHandling = ReferenceLoopHandling.Ignore;

    return serializer;          
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:52:56.050

这个答案可能会迟到，但是：

这是因为它在检查继承`IEnumerable`之前检查继承，`ISerializable`因此它将使用 Enumerable 接口首先拉出对象。

你可以通过实现你自己的合约解析器来覆盖这个行为，继承自`DefaultContractResolver`这个覆盖：

```
 protected override JsonContract CreateContract(Type objectType)
    {
        if (typeof(ISerializable).IsAssignableFrom(objectType))
            return CreateISerializableContract(objectType);

        return base.CreateContract(objectType);
    } 
```

最好使用一些更好的逻辑，但这从根本上会导致对象首先实现`ISerializable`并`IEnumerable`使用 ISerializable 实现。

# sql - 数据库中的死锁会影响其他数据库或挂起整个服务器吗？

> ID：10490973
> 
> 赞同：2
> 
> 时间：2012-05-08T00:32:10.710
> 
> 标签：sql, sql-server, deadlock

这听起来很奇怪，但是在我们在服务器中获得的一堆数据库中发生了，我们可以通过日志上的输出来判断，但这似乎正在影响另一个数据库，因为当死锁发生时系统会挂起.

我们已经确定了死锁事件中涉及的对象，但没有一个对象存在于我们正在使用的系统的数据库中。

我仍然需要查看程序主体，但这可能吗？来自其他数据库的进程进入死锁并挂起整个服务器或其他数据库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:42:36.337

死锁在 MS Sql Server 中不是致命事件（例如，在代码中不同）。这是因为 Sql Server 会定期扫描死锁，然后选择要杀死的进程之一。那是您收到日志消息的时候。

如果没有 Sql Server 错误（我从未遇到过），我认为更可能是顺序颠倒了 - 挂起的服务器/数据库阻止了查询的正常执行，导致死锁，因为过程需要更长的时间来执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T12:33:21.707

当两个处于死锁的进程也将对象锁定在 TempDB 中时，我已经看到了这种情况。

然后 tempdb 中的锁定对象阻止其他进程创建对象并因此挂起。

这是旧版本的 SQL Server (2000) 上的一个问题，但我不记得在更新的版本上看到过它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:34:41.270

有可能的。如果您的服务器无法对任何中断做出反应，它就无法（正确地）执行其他请求。

# c++ - 如何将数据存储在大型二维数组中

> ID：10490976
> 
> 赞同：0
> 
> 时间：2012-05-08T00:33:00.953
> 
> 标签：c++, arrays

我想在一个二维数组中分配 10^9*10^9 的内存，但这是不可能的。他们有什么出路吗？

我认为向量可以解决这个问题，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T00:35:17.290

您今天无法在任何计算机中分配 10 ^(18字节的内存（大约是一)*百万太字节*）。但是，如果您的数据大部分为零（即稀疏矩阵），那么您可以使用不同类型的数据结构来存储您的数据。这完全取决于您存储的数据类型以及它是否具有任何冗余特征。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-08T00:35:38.757

假设非零元素的数量远小于 10^18，您将需要阅读[sparse arrays](http://en.wikipedia.org/wiki/Sparse_array)。事实上，稀疏数组中的大多数元素都为零甚至不是必需的——它们只需要相同即可。基本思想是将非默认值保留在列表之类的结构中；列表中未找到的任何值都被假定为默认值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T01:08:44.103

> 我想在一个二维数组中分配 10^9*10^9 的内存，但这是不可能的。他们有什么出路吗？

这远远超出了当前的硬件能力，而且这么大的阵列不适合任何实际用途（您可以自由计算遍历每个元素需要多少几千年）。

您需要创建“稀疏”数组。仅将非零元素存储在内存中，提供类似数组的接口来访问它们，但在内部将它们存储在类似的东西中`std::map<std::pair<xcoord, ycoord>, value>`，对不在 map 中的所有元素返回零。只要您不做一些鲁莽的事情，例如尝试将每个元素设置为非零值，这应该是足够的数组替换。

所以....

你需要那么多内存做什么？

# installation - NSIS 脚本可以添加 2 个整数和“或”一个 StrCmp

> ID：10490982
> 
> 赞同：3
> 
> 时间：2012-05-08T00:33:42.270
> 
> 标签：installation, nsis

**是否可以在 Native NSIS 中将 2 个数字加在一起（不使用库）？**

```
Var hasVersion9    # values will either be 0 or 1
Var hasVersion10
Var hasVersion9Or10

IntCpy $hasVersion9Or10 hasVersion9+hasVersion10
(IntCmp $hasVersion9Or10 1 OR IntCmp $hasVersion9Or10 2) doThis doThat 
```

**是否也可以在字符串比较中执行“或”操作？**

```
StrCmp $myVar ("1" OR "11") doThis doThat 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T01:24:59.437

将[IntOp](http://anders_k.users.sourceforge.net/public/NSIS/2.46/Manual.html#intop)用于数字运算，将[logiclib](http://nsis.sourceforge.net/Include/LogicLib.nsh)用于 if/orif

# c++ - 没有更多工作时 MPI 从属进程挂起

> ID：10490983
> 
> 赞同：3
> 
> 时间：2012-05-08T00:34:00.617
> 
> 标签：c++, parallel-processing, mpi, master-slave

我有一个希望并行化的串行 C++ 程序。我知道 MPI、 、 等的基础知识`MPI_Send`。`MPI_Recv`基本上，我有一个数据生成算法，其运行速度明显快于数据处理算法。目前它们串联运行，但我想在根进程中运行数据生成，在从属进程上完成数据处理，然后从根向包含要处理的数据的从属发送消息。这样，每个从站处理一个数据集，然后等待下一个数据集。

问题是，一旦根进程完成生成数据，程序就会挂起，因为从属进程正在等待更多。

这是问题的一个例子：

```
#include "mpi.h"

#include <cassert>
#include <cstdio>

class Generator {
  public:
    Generator(int min, int max) : value(min - 1), max(max) {}
    bool NextValue() {
      ++value;
      return value < max;
    }
    int Value() { return value; }
  private:
    int value, max;

    Generator() {}
    Generator(const Generator &other) {}
    Generator &operator=(const Generator &other) { return *this; }
};

long fibonnaci(int n) {
  assert(n > 0);
  if (n == 1 || n == 2) return 1;
  return fibonnaci(n-1) + fibonnaci(n-2);
}

int main(int argc, char **argv) {
  MPI_Init(&argc, &argv);

  int rank, num_procs;
  MPI_Comm_rank(MPI_COMM_WORLD, &rank);
  MPI_Comm_size(MPI_COMM_WORLD, &num_procs);

  if (rank == 0) {
    Generator generator(1, 2 * num_procs);
    int proc = 1;
    while (generator.NextValue()) {
      int value = generator.Value();
      MPI_Send(&value, 1, MPI_INT, proc, 73, MPI_COMM_WORLD);
      printf("** Sent %d to process %d.\n", value, proc);
      proc = proc % (num_procs - 1) + 1;
    }
  } else {
    while (true) {
      int value;
      MPI_Status status;
      MPI_Recv(&value, 1, MPI_INT, 0, 73, MPI_COMM_WORLD, &status);
      printf("** Received %d from process %d.\n", value, status.MPI_SOURCE);
      printf("Process %d computed %d.\n", rank, fibonnaci(2 * (value + 10)));
    }
  }

  MPI_Finalize();
  return 0;
} 
```

显然，并非以上所有内容都是“良好做法”，但足以说明问题。

如果我`while(true)`从从属进程中删除 ，则程序会在每个从属进程退出时退出。我希望程序仅在根进程完成其工作并且所有从属进程都处理了已发送的所有内容后退出。

如果我知道将生成多少数据集，我可以运行那么多进程并且一切都会很好地退出，但这里不是这样。

有什么建议么？API中有什么可以做到这一点吗？可以通过更好的拓扑更好地解决这个问题吗？会`MPI_Isend`或`MPI_IRecv`做得更好吗？我对 MPI 还很陌生，所以请耐心等待。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-08T07:04:05.773

通常的做法是向所有工作进程发送一条带有特殊标记的空消息，指示它们退出无限处理循环。假设这个标签是 42。你会在工作循环中做类似的事情：

```
while (true) {
  int value;
  MPI_Status status;
  MPI_Recv(&value, 1, MPI_INT, 0, MPI_ANY_TAG, MPI_COMM_WORLD, &status);
  if (status.MPI_TAG == 42) {
    printf("Process %d exiting work loop.\n", rank);
    break;
  }
  printf("** Received %d from process %d.\n", value, status.MPI_SOURCE);
  printf("Process %d computed %d.\n", rank, fibonnaci(2 * (value + 10)));
} 
```

管理器进程会在生成器循环之后执行以下操作：

```
for (int i = 1; i < num_procs; i++)
  MPI_Send(&i, 0, MPI_INT, i, 42, MPI_COMM_WORLD); 
```

关于你的下一个问题。`MPI_Isend()`在主进程中使用会反序列化执行并提高性能。然而，事实是您发送的消息非常小，并且这些消息通常在内部缓冲（**警告 - 依赖于实现！**），因此您`MPI_Send()`实际上是非阻塞的，并且您已经具有非串行执行。`MPI_Isend()`返回`MPI_Request`您需要稍后处理的句柄。你可以等待它完成，`MPI_Wait()`或者`MPI_Waitall()`你也可以打电话`MPI_Request_free()`操作结束后自动释放。这通常在您想异步发送许多消息并且不关心发送何时完成时完成，但这是一个不好的做法，因为有大量未完成的请求会消耗大量宝贵的内存。至于工作进程 - 他们需要数据才能继续计算，因此`MPI_Irecv()`不需要使用。

欢迎来到 MPI 编程的精彩世界！

# ruby - 在 Ruby 中使用 Net::Http 编写自动登录

> ID：10490986
> 
> 赞同：0
> 
> 时间：2012-05-08T00:34:27.777
> 
> 标签：ruby

[http://ruby-doc.org/stdlib-1.8.7/libdoc/net/http/rdoc/Net/HTTP.html](http://ruby-doc.org/stdlib-1.8.7/libdoc/net/http/rdoc/Net/HTTP.html)

在仔细阅读文档后，我正在为我的程序的自动登录功能编写以下代码片段：

```
url = URI.parse('http://localhost/login.aspx')
req = Net::HTTP::Post.new(url.path)
req.basic_auth 'username' 
```

目标页面只询问正确的用户名，登录不需要密码，basic_auth方法需要两个参数，用户名和密码，如果我漏掉一个，我会得到错误，我试着写成这样这个“ *req.basic_auth '用户名*'，''”，但我仍然无法登录。

任何人都可以给我一个提示吗？

更多信息：我也尝试了 req.basic_auth 'username', ''，它似乎没有工作，我知道这一点，因为在这之后还有另一行，基本上是自动提交表单。x = Net::HTTP.post_form(URI.parse("http://localhost/NewTask.aspx"), params) puts x.body

并且 puts 结果与重定向到登录页面正文一起返回。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T02:52:34.710

您可以考虑使用[ruby​​ mechanize gem](http://mechanize.rubyforge.org/)。登录示例会简单得多（来自官方网站），对于这个，您不需要做代理证书和私钥的事情：

```
require 'rubygems'
require 'mechanize'

# create Mechanize instance
agent = Mechanize.new

# set the path of the certificate file
agent.cert = 'example.cer'

# set the path of the private key file
agent.key = 'example.key'

# get the login form & fill it out with the username/password
login_form = agent.get("http://example.com/login_page").form('Login')
login_form.Userid = 'TestUser'
login_form.Password = 'TestPassword'

# submit login form
agent.submit(login_form, login_form.buttons.first) 
```

# ios - 将内容添加到滚动视图的顶部

> ID：10490987
> 
> 赞同：0
> 
> 时间：2012-05-08T00:34:33.610
> 
> 标签：ios, uiscrollview

我正在尝试重新创建内置消息应用程序的视图。当我单击“加载上一个”时，我需要在底部添加对话气泡并在顶部添加它们。

我的主要问题是，当我将更多内容加载到顶部时，我不知道如何将其余的谈话气泡推下去。这对我来说是一场斗争。

我在 UIScrollView 的一个子类中工作，并在其中添加了一个“innerView”。

我所做的是将标签（气泡）添加到顶部的负值和底部的正值。我将最后的位置存储在“topLabelsPosition”和“bottomLabelsPosition”中

有人能帮忙吗？这是我的代码

```
CGFloat whereToScroll = 0.0;
CGFloat topOfContent = self.topLabelsPosition.origin.y;
CGFloat bottomOfContent = self.labelsPosition.origin.y;

CGFloat fullHeight = fabs(bottomOfContent)+fabs(topOfContent);

[innerView setFrame:CGRectMake(0,topOfContent,self.frame.size.width, fullHeight)];

if(is_adding_to_top) {
    whereToScroll = topOfContent;
} else {
    whereToScroll = bottomOfContent;
}

[self setContentSize:contentSize];
CGPoint point = {0, whereToScroll};
[self setContentOffset:point]; 
```

我的“innerView”在顶部并没有变大，但在底部 - 我可以通过背景颜色来判断。而且我的滚动视图不会像我想要的那样滚动到 -300.00 (topOfContent)。

我愿意重写任何东西，如果你愿意提供帮助，我会全力以赴。

非常感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:02:00.350

如果您仔细查看 Messages.app，它在顶部加载新气泡时不会滚动。他们只是眨眼。与滚动它们的底部出现新消息相反。

我相信他们并没有将它们添加到顶部，而是将它们添加到 (0,0) 然后将滚动视图中的所有内容向下移动到内容视图中。所以尽量不要添加到 -xxx y 而是 0+ y 并将已经在里面的所有内容的框架向下调整相同的数量。

希望这可以帮助。

# python - 在 .svg xml 中按 ID 选择元素

> ID：10490996
> 
> 赞同：2
> 
> 时间：2012-05-08T00:35:28.570
> 
> 标签：python, xml, elementtree

我使用 Inkscape 生成`.svg`图像（这是一个 xml 文件）。我将节点的 ID 设置为“mount-arm-r”。我想从该元素中读取属性“x”、“y”。我似乎无法选择`rect`元素。

python：我试过 XPath，或者一次手动一个深度。我想我想要：

```
def parse_xml():
    tree = ElementTree()
    tree.parse("torso-human.svg")                        
    for node in tree.findall('.//rect'): print 'n=', node 
```

xml:

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="125.39109"
   height="217.70497"
   id="svg3136"
   version="1.1"
   inkscape:version="0.48.1 "
   sodipodi:docname="torso-human.svg">
  <defs
     id="defs3138" />
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.7"
     inkscape:cx="134.17406"
     inkscape:cy="65.046531"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="false"
     fit-margin-top="0"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0"
     inkscape:window-width="678"
     inkscape:window-height="714"
     inkscape:window-x="149"
     inkscape:window-y="198"
     inkscape:window-maximized="0" />
  <metadata
     id="metadata3141">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-94.4375,-394.94334)">
    <path
       style="fill:#f7b42a;fill-opacity:1;stroke:#000000;stroke-width:6;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 123.77824,405.89569 c 10.24991,-3.38432 20.79684,-5.42837 31.38251,-7.00357 10.08459,-3.35769 18.78867,2.77879 26.91852,7.6971 11.31402,4.36385 16.77569,16.06584 23.028,25.60256 4.24045,8.35939 4.95844,18.18912 6.47883,27.32923 0.81646,12.84443 3.26716,25.52723 3.78171,38.41123 0.89978,12.5961 -0.39774,25.23801 1.24629,37.81448 1.02427,12.22291 -1.40473,24.93719 -8.43715,35.07825 -7.47966,16.13252 -19.54923,31.09303 -36.14012,38.36243 -9.64999,2.44233 -17.82857,-5.59005 -27.35583,-5.23341 -14.78262,-5.55 -28.81674,-15.655 -35.88284,-30.0959 -5.41188,-15.13741 -10.887811,-30.71753 -11.350781,-46.928 3.049751,-10.81513 3.565751,-21.8035 1.94578,-33.0368 1.513801,-9.31727 -2.45929,-18.6844 -0.0771,-27.86458 4.302571,-16.70927 8.728671,-33.70461 17.388141,-48.73973 2.49669,-3.69472 5.83731,-6.99007 7.074,-11.39329 z"
       id="path3757"
       inkscape:connector-curvature="0" />
    <rect
       style="fill:#ff0000;fill-opacity:1;stroke:#aa0000;stroke-width:2.06586957;stroke-linecap:square;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       id="mount-arm-r"
       width="24.593687"
       height="4.9187374"
       x="279.40387"
       y="403.92834"
       transform="matrix(0.96592583,0.25881905,-0.25881905,0.96592583,0,0)"
       ry="1.8705337" />
    <rect
       ry="2.0732613"
       transform="matrix(0.14071606,0.99004999,-0.99004999,0.14071606,0,0)"
       y="-109.61398"
       x="607.01672"
       height="5.4518275"
       width="27.259138"
       id="mount-leg-l"
       style="fill:#ff0000;fill-opacity:1;stroke:#aa0000;stroke-width:2.2897675;stroke-linecap:square;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       inkscape:transform-center-x="-10.607363"
       inkscape:transform-center-y="-7.3172785" />
    <rect
       inkscape:transform-center-y="-4.1491271"
       inkscape:transform-center-x="-9.047332"
       style="fill:#ff0000;fill-opacity:1;stroke:#aa0000;stroke-width:1.76860404;stroke-linecap:square;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       id="mount-leg-r"
       width="21.05481"
       height="4.2109618"
       x="585.27789"
       y="-149.50224"
       transform="matrix(-0.03269097,0.99946551,-0.99946551,-0.03269097,0,0)"
       ry="1.6013756" />
  </g>
</svg> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T07:35:09.043

您忘记了在根元素 ( `xmlns="http://www.w3.org/2000/svg"`) 上声明的 SVG 命名空间。因此，你想要这样的东西：

```
SVG_NS = "http://www.w3.org/2000/svg"

def parse_xml():
    tree = ElementTree()
    tree.parse("torso-human.svg")                        
    for node in tree.findall('.//{%s}rect' % SVG_NS):
        print 'n=', node 
```

有关更多详细信息，请参阅[http://effbot.org/zone/element-namespaces.htm 。](http://effbot.org/zone/element-namespaces.htm)