# StackOverflow 问答 11659000-11659999

# java - Cassandra-cli 无法连接到远程 cassandra 服务器

> ID：11659001
> 
> 赞同：9
> 
> 时间：2012-07-25T21:35:50.607
> 
> 标签：java, nosql, cassandra, thrift, thrift-protocol

我有一个在服务器（serv1）上运行的 cassandra 服务器。cassandra-cli 在 serv1 上运行时可以连接到它。但是，当我尝试通过其他服务器（serv2）连接到它时，出现以下异常：

```
org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused
    at org.apache.thrift.transport.TSocket.open(TSocket.java:183)
    at org.apache.thrift.transport.TFramedTransport.open(TFramedTransport.java:81)
    at org.apache.cassandra.cli.CliMain.connect(CliMain.java:80)
    at org.apache.cassandra.cli.CliMain.main(CliMain.java:256)
Caused by: java.net.ConnectException: Connection refused
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
    at java.net.Socket.connect(Socket.java:529)
    at org.apache.thrift.transport.TSocket.open(TSocket.java:178)
    ... 3 more
Exception connecting to jckstore/9160\. Reason: Connection refused. 
```

我查看了 cassandra.yaml，发现属性“listen_address”配置为“localhost”，并且严重不鼓励使用 0.0.0.0。我试图将 localhost 更改为 serv2，serv1 的 IP 地址，但没有任何效果。即使注释掉也无济于事。

有没有办法让我的 cassandra 服务器在不使用 0.0.0.0 的情况下监听所有 IP

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-25T22:45:58.733

我能够解决以下问题：

1.  将 cassandra.yaml 中的 rpc_address 属性更改为 0.0.0.0 而不是 localhost。
2.  将 cassandra.yaml 中的 broadcast_rpc_address 属性设置为 0.0.0.0 以外的值

然后我就可以访问了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T20:45:10.470

Cassandra cli 使用 thrift 连接到 Cassandra。rpc_address 决定 thrift 客户端如何连接到 Cassandra。将其设置为 0.0.0.0 将起作用，但将其设置为服务器的主机名然后使用相同的主机名进行连接也将起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T17:06:56.970

我也遇到了同样的问题，我一直很惊讶，因为它配置正确。最后，我发现这是权限问题：

```
chown -R cassandra: /var/lib/cassandra
chown -R cassandra: /var/log/cassandra 
```

希望能帮助到你 ：-）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-12T12:36:49.690

我有同样的问题。我通过更新 snappy temp dir VM 选项以指向正确的目录来解决此问题。

```
VM_OPTS="$JVM_OPTS -Dorg.xerial.snappy.tempdir=/home/users/local/user/cassandra_home/snap 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-02T01:00:18.180

我也有同样的问题“连接被拒绝”。将 rpc_address 从“localhost”更改为与 listen_address 相同的主机名对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-20T23:14:28.180

我也有同样的问题“连接被拒绝”。将 start_rpc: 更改为 true 为我修复了它。

# lisp - 可以订车！和设置-cdr！被实现为宏？

> ID：11659004
> 
> 赞同：4
> 
> 时间：2012-07-25T21:36:13.603
> 
> 标签：lisp, scheme, metaprogramming, abstract-syntax-tree

是否可以在 Scheme中使用宏来实现`set-car!`和`set-cdr!` *移植？*`set!`或者这是否需要对底层存储系统进行特殊访问？

我之所以问，是因为我正在实现自己的 Scheme 解释器，并且我希望尽可能多地使用方案代码。

我的第一次尝试`set-cdr!`是：

```
(define-syntax set-cdr!
  (syntax-rules ()
    ((set-cdr! location value)
     (set! location (cons (car location) value))))) 
```

这*主要*适用，但不适用于循环列表：

```
#; mickey> (define x (list 1 2))
#; mickey> x
(1 2)
#; mickey> (set-cdr! x x)
#; mickey> x
(1 1 2) 
```

包裹宏体`let`也对我没有帮助，因为当我这样做时`(set! (cons (car location) value)`， then`value`已经被评估为`'(1 2)`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T21:56:52.527

在

```
(set! location (cons (car location) value)) 
```

该表达式`(cons (car location) value)`分配一个*新*的对。

的目的`set-cdr!`是改变现有的对。

因此，实施`set-cdr!`确实需要对底层存储的“特殊”访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:13:13.893

下面是一个实现 Cons, Car, Cdr, Set-car 的例子！和设置-cdr！使用闭包。

```
(define (Cons x y)
  (lambda (message . val)
    (cond
      [(eq? message 'car) x]
      [(eq? message 'cdr) y]
      [(eq? message 'set-car!) 
       (set! x (car val))]
      [(eq? message 'set-cdr!) 
       (set! y (car val))]
      [else 'unknown-message])))

(define (Car pair)
  (pair 'car))

(define (Cdr pair)
  (pair 'cdr))

(define (Set-cdr! pair val)
  (pair 'set-cdr! val))

(define (Set-car! pair val)
  (pair 'set-car! val))

(define p (Cons 1 2))
(Car p)
(Cdr p)
(Set-car! p 3)
(Car p)
(Set-cdr! p 4)
(Cdr p) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-04T01:36:53.323

基本上你可以实现set！没有 set!，但我认为你不能实现 set-car!/set-cdr! 没有突变对或模拟对（如soegaard的例子）

既然你似乎在 Scheme 中实现你的 Scheme，我会使用 set-car!/set-cdr! 在解释器中实现它，或者根本不实现它们。我会从 define, if, quote, pair?, eq?, cons, car 和 cdr （类似于[LISP 的根](http://paulgraham.com/rootsoflisp.html)，但更诡计）开始有一个基本的最小实现开始，然后进一步增强它。

无论如何..你的实现，如果你实现它应该能够做到这一点：

```
(define odds (list 1 3 5 7 9 11))
(set-car! (cddr odds) #f)
odds
===> (1 3 #f 7 9 11) 
```

# virtualbox - 如何调整 VirtualBox vmdk 文件的大小

> ID：11659005
> 
> 赞同：561
> 
> 时间：2012-07-25T21:36:20.510
> 
> 标签：virtualbox

我的虚拟机磁盘空间不足，这是一个 vmdk，需要调整虚拟映像的大小。使用命令调整大小

```
vboxmanage modifyhd Machine-disk1.vmdk --resize 30720 
```

给出错误

```
Progress state: VBOX_E_NOT_SUPPORTED
VBoxManage: error: Resize hard disk operation for this format is not implemented yet! 
```

如何调整 vmdk 映像的大小？

* * *

## 回答 #1

> 赞同：832
> 
> 时间：2012-09-17T09:12:17.457

如果你想结束拥有一个 vmdk 硬盘（也许你也有兴趣在 vwmare 中使用该磁盘），完整的步骤是：

```
VBoxManage clonemedium "source.vmdk" "cloned.vdi" --format vdi
VBoxManage modifymedium "cloned.vdi" --resize 51200
VBoxManage clonemedium "cloned.vdi" "resized.vmdk" --format vmdk 
```

以上将调整硬盘大小至 50GB (50 * 1024MB)。

**要完成**您还需要调整驱动器大小的事情！为此，您可能需要下载[**gparted**](http://gparted.sourceforge.net/download.php) iso 并从该 iso 引导以调整驱动器大小（从 virtualbox 设置中选择 iso）。

PS 如果您的新尺寸太小，即使使用新的 vdi 文件，您也会收到相同的错误。

* * *

## 回答 #2

> 赞同：203
> 
> 时间：2012-07-25T21:39:44.843

我能够通过克隆它然后修改和调整大小来调整 vmdk 的大小。

```
vboxmanage clonehd "virtualdisk.vmdk" "new-virtualdisk.vdi" --format vdi
vboxmanage modifyhd "new-virtualdisk.vdi" --resize 30720 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2013-10-09T17:05:43.717

我在 Mac 主机上有一个 Windows 7 客户端，这篇文章非常有帮助。谢谢。

我要补充一点，我没有使用 gparted。我这样做了：

1.  启动新的放大 vmdk 映像。
2.  转到开始并右键单击计算机并选择管理。
3.  点击磁盘管理
4.  您应该在（在我的情况下）C 驱动器上看到一些灰色空间
5.  右键单击 C 驱动器并选择扩展卷。
6.  选择尺寸然后走

甜的！我更喜欢使用带有数据丢失警告的 3rd 方工具。

干杯!

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2013-02-07T13:19:09.037

**vmdk 的**：

*   *而是固定大小分配（步骤 1,2）。*
*   *即使在扩展之后，在 vmdk 的操作系统中也不容易使用（步骤 3、4、5）*

**脚步：**

**1）**首先转换为“.vdi” -`VBoxManage clonehd v1.vmdk v1.vdi --format vdi`

**2)**使用命令行扩展大小（参考：[tvial 的博客](http://tvi.al/resize-sda1-disk-of-your-vagrant-virtualbox-vm/)以获取分步信息）

或者

从VirtualBox 中的[虚拟媒体管理器](https://www.howtogeek.com/124622/how-to-enlarge-a-virtual-machines-disk-in-virtualbox-or-vmware/)展开。

[现在-在虚拟机内]

**3）**扩展驱动器的大小，使用新的分配（例如，对于在虚拟机上运行的 Ubuntu：使用[GParted](https://gparted.org/display-doc.php%3Fname%3Dmoving-space-between-partitions)） [![在此处输入图像描述](../Images/9445a896bf4ea92408f5f775575fc6a3.png)](https://i.stack.imgur.com/HFcxL.png) [![在此处输入图像描述](../Images/12658acec37709e14233bda4ebc47118.png)](https://i.stack.imgur.com/D3n2g.png)

**4）**扩展[文件系统](https://www.linuxtechi.com/extend-lvm-partitions/)-`lvextend -L +50G <file-system-identifier>`

插图：

```
$ lsblk
NAME                       MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
...
sda                          8:0    0   200G  0 disk 
└─sda1                       8:1    0   200G  0 part 
  ├─myfs-vg-cloud          253:0    0    99G  0 lvm  /
  └─myfs-vg-swap-1         253:1    0   980M  0 lvm  [SWAP]

$ lvextend -L +100G /dev/mapper/myfs-vg-cloud

$ lsblk
NAME                       MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
...
sda                          8:0    0   200G  0 disk 
└─sda1                       8:1    0   200G  0 part 
  ├─myfs-vg-cloud          253:0    0   199G  0 lvm  /
  └─myfs-vg-swap-1         253:1    0   980M  0 lvm  [SWAP] 
```

**5）**扩展[“/home”](https://www.linuxtechi.com/extend-lvm-partitions/) -`resize2fs <file-system-identifier>`

插图：

```
$ df -h /home/
Filesystem                        Size  Used Avail Use% Mounted on
/dev/mapper/myfs-vg-cloud         97G   87G  6.0G  94%   /

$ resize2fs /dev/mapper/myfs-vg-cloud

$ df -h /home/
Filesystem                        Size  Used Avail Use% Mounted on
/dev/mapper/myfs-vg-cloud         196G   87G  101G  47%  / 
```

您的系统现在必须准备好使用，并扩展分配！

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2013-10-16T15:53:06.787

实际上，只需要这些命令：

```
VBoxManage clonehd "source.vmdk" "cloned.vdi" --format vdi
VBoxManage modifyhd "cloned.vdi" --resize 51200 
```

然后，您可以在 Virtualbox GUI 存储中选择 cloned.dvi。

之后，启动虚拟窗口并将C盘扩展为Code Chops的方法。

无需将 *.vdi 文件转换回 *.vmdk 文件。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2015-09-26T19:58:55.773

由于这是一个 vmdk 文件，因此您可以使用 VMWare 的`vdiskmanager`，如果它适用于您的平台。[VMWare 在这里](http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1023856)有 x86 Linux、Windows 和 OS X 版本（参见右侧栏的“附件”）。

然后你就这样做：

```
1023856-vdiskmanager-windows-7.0.1.exe -x 30720M Machine-disk1.vmdk 
```

它避免了克隆，然后扩展磁盘。现在，缺点是您需要额外的工具，而 vmdk 是 VMWare 的磁盘格式，而您仍在使用 Virtualbox，因此可能存在不兼容问题。

`qemu-img`可能也可以，但我不确定它是否支持调整 vmdk 文件的大小。它看起来像：

```
qemu-img resize Machine-disk1.vmdk +8G 
```

只是提醒一下，在调整基础磁盘大小后，您仍然需要增加分区。所有这些工具本质上都是`dd if=/dev/old_disk of=/dev/new_disk bs=16M`.

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2018-06-28T22:44:27.970

在这里尝试了所有解决方案，但似乎没有任何效果。经过数小时的挖掘，我发现了这篇[博](http://learningdocker.com/resizing-boot2docker-disk-volumes/)文，并且一切正常。我不得不做一些小调整，所以这里是修改后的版本。使用 Docker 版本 17.06.0-ce 测试，构建 02c1d87。

一旦开发者真正开始容器化他们的应用程序，他们通常会生成大量的镜像，并迅速填满默认分配给 Docker 虚拟机的 20GB 硬盘空间。为了确保 Docker 虚拟机有足够的磁盘空间，我们应该将 /dev/sda1 的大小调整为更合理的数字。

1.  下载[GParted Live CD/USB/HD/PXE 可启动映像](https://gparted.sourceforge.io/download.php/download.php)。
2.  停止 Docker 虚拟机`docker-machine stop default`。

3.  Boot2Docker 软件包安装程序附带一个 VMDK 卷，VirtualBox 的本机工具无法调整其大小。为了调整 Docker 磁盘卷的大小，首先从默认 VMDK 卷克隆 VDI 卷`vboxmanage clonehd /full/path/to/disk.vmdk /full/path/to/disk_resized.vdi --format VDI --variant Standard`。

4.  将新克隆的 VDI 卷调整为所需的容量。我们建议至少 64GB `vboxmanage modifyhd /full/path/to/disk_resized.vdi --resize <size in MB>`。
5.  启动 VirtualBox 应用程序，选择`default`VM 并单击顶部的“设置”齿轮。[![VirtualBox 管理器](../Images/ed3e9aba95820b385e8f89d0b09943db.png)](https://i.stack.imgur.com/5uTdy.jpg)
6.  单击“存储”图标。删除默认 VMDK 卷。[![在此处输入图像描述](../Images/b0886ba3b77c94dbdad30b86a8074d2d.png)](https://i.stack.imgur.com/CxAbo.jpg)
7.  添加一个新的 IDE 控制器。[![IDE控制器](../Images/3c642028a1f0971e230c6939430bfa67.png)](https://i.stack.imgur.com/cgNuJ.jpg)
8.  通过“添加 CD/DVD 设备”选项安装 GParted ISO。[![添加 CD/DVD 设备](../Images/eadf96c92d8f7025c82315879c7192b1.png)](https://i.stack.imgur.com/bHEtf.jpg)
9.  通过“添加 CD/DVD 设备”选项挂载克隆的 VDI 卷。[![挂载卷](../Images/cd0e81aba006342bc9e746052b60c134.png)](https://i.stack.imgur.com/E40BW.jpg)
10.  如果您在具有固态硬盘驱动器的计算机上运行 Docker，请确保为克隆的 VDI 卷选择“固态驱动器”选项。[![固态硬盘](../Images/1379e8c8353b118b65d7bad3461503e4.png)](https://i.stack.imgur.com/UbfyY.jpg)
11.  单击“开始”图标启动 Docker 虚拟机，这将启动 GParted ISO。选择“GParted Live（默认设置）”。[![GParted Live（默认设置）](../Images/8e36fce5666fb9620c8253dee6e64173.png)](https://i.stack.imgur.com/9XZO0.jpg)
12.  将处理键盘映射的策略设置为“不要触摸键盘映射”。[![键盘映射](../Images/c40f0f7043c9621038e42e2499ec99ba.png)](https://i.stack.imgur.com/7yjnj.jpg)
13.  将语言偏好设置为选项“33”，该选项映射到“美国英语”。[![美国英语](../Images/8bae9f85d5b51bef72b30b465109095d.png)](https://i.stack.imgur.com/f2vEZ.jpg)
14.  选择选项“1”以运行“Forcevideo”并手动配置 X。[![强制视频](../Images/05cd9864a62659ec1244853a028bd905.png)](https://i.stack.imgur.com/NsaMd.jpg)
15.  选择选项“2”保持默认分辨率“1024×760”。[![1024×760](../Images/295a6467c8cacfc62dafa51ee31ec4bd.png)](https://i.stack.imgur.com/sRs1o.jpg)
16.  保留默认的“vesa”作为 VGA 卡。[![如果需要默认值，请留空](../Images/36e75afecdafbf88d85cab56756660bf.png)](https://i.stack.imgur.com/z9992.jpg)
17.  通过选择选项“0”保持默认颜色深度“24”。[![颜色深度](../Images/13e1c88ec0064c704acd9378feb849d8.png)](https://i.stack.imgur.com/jE74u.jpg)
18.  GParted 启动后，单击“调整大小/移动”图标。[![GParted](../Images/9db91ac439cda5f1f6e9851ce6743b14.png)](https://i.stack.imgur.com/FTcIp.jpg)
19.  通过拖动滑块将新磁盘卷大小设置为所需大小。在此示例中，最大大小为 127,035MB。单击“调整大小/移动”按钮开始该过程。[![磁盘卷大小](../Images/2a1c5b6485443ac0ce3bfc1d5c87c7db.png)](https://i.stack.imgur.com/lCZm0.jpg)
20.  单击“应用”按钮确认调整大小操作。[![烤吧](../Images/821522a8b4ce1a00359781e0f0d60b66.png)](https://i.stack.imgur.com/RHwbw.jpg)
21.  调整大小操作完成后关闭机器电源。[![硬重置，np :)](../Images/0d51f4ddf3459fc3bb4540b256b6354b.png)](https://i.stack.imgur.com/MNywy.jpg)
22.  删除 GParted ISO。[![你几乎完成了](../Images/1ad17fd546d50a017fca593ad3f55f36.png)](https://i.stack.imgur.com/TTSub.jpg)
23.  登录 Docker 虚拟机，通过启动机器验证卷大小调整是否成功`docker-machine start default`
24.  如果您遇到网络问题，请重新启动 docker-machine

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2014-01-08T10:47:34.560

您可以使用 Vmware 播放器来调整 vmdk 的大小。如果您想将其保留为 vmdk 格式，这将删除往返转换（在其他帖子中注明）。只需确保在将 vmdk 添加到 vmware 时，提示时不要单击升级格式，保留当前格式以防 VirtualBox 不接受。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2016-02-25T07:05:45.613

为了**缩小**图像大小，我使用以下步骤：

1.  在客户端机器上`cat /dev/zero > z;sync;sleep 3;sync;rm -f z`
2.  关闭客户端机器
3.  在主机上`VBoxManage clonehd "source.vmdk" "cloned.vdi" --format vdi`
4.  在主机上`VBoxManage modifyhd cloned.vdi --compact`
5.  在主机上`VBoxManage clonehd "cloned.vdi" "resized.vmdk" --format vmdk`

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2017-12-20T17:27:01.630

正如卢卡的[回答中提到的，所需的步骤是：](https://stackoverflow.com/a/12456219/8738113)

1.  将 VMDK 映像克隆为 VDI 格式

    `VBoxManage clonehd "source.vmdk" "cloned.vdi" --format vdi`

2.  调整 VDI 映像的大小

    `VBoxManage modifyhd "cloned.vdi" --resize 51200`

3.  克隆回 VMDK 格式

    `VBoxManage clonehd "cloned.vdi" "resized.vmdk" --format vmdk`

如果您可以改用 VDI 映像，则步骤 3 是可选的。

所有这些步骤也可以在 VirtualBox 图形用户界面中执行，位于`File -> Virtual Media Manager`. 选择要克隆的驱动器，然后选择`Copy`。将打开一个对话框，允许您选择磁盘格式和选项。`Properties`要调整 VDI 图像的大小，只需使用底部的滑块（如果不可见，请单击）。

最后，您可能还需要更改来宾操作系统中的磁盘大小：

4.  运行来宾操作系统并调整磁盘分区的大小。如果您正在运行 Linux，则可以使用`gparted`或`kparted`.

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2017-05-23T02:07:31.167

* * *

**适用于 Windows 的 VirtualBox**

***在保留**虚拟机设置的同时调整磁盘文件的大小！*

* * *

## 第 1 步 - 调整磁盘文件的大小

启动 cmd.exe

`cd`到 Oracle VM VirtualBox 的目录（在 64 位系统上 `"C:\Program Files\Oracle\VirtualBox\"`：）

运行这些命令（如上）：

```
VBoxManage clonehd "C:\path\to\source.vmdk" "C:\path_to\cloned.vdi" --format vdi
VBoxManage modifyhd "C:\path\to\cloned.vdi" --resize 51200 
```

Windows 资源管理器和通过地址栏“将地址复制为文本”应该可以帮助您获得所需的路径。

在 Windows 系统上，您用户下的 VirtaulBox VM 目录可能包含您为 VM 配置的设置的 XML 格式数据库文件。用扩展名重命名这个文件`.bak`（它有一个`.vbox`扩展名）。使用扩展名重命名原始`.vmdk`文件`.bak`以避免另一个错误。您现在可以安全地执行第三步，而不会出现将机器转换回`.vmdk`格式或“重复磁盘”错误的错误消息。

```
VBoxManage clonehd "C:\path_to\cloned.vdi" "C:\path_to\source.vmdk" --format vmdk 
```

您将看到一个**UID 令牌**。通过从 Windows Command Interpetor 窗口拖动突出显示并使用`Ctrl+C`键盘快捷键来复制此令牌。

在 Notepad++ 等文本编辑器中打开`.vbox.bak`文件。您将看到一个类似 XML 的数据库文件。寻找这些行：

```
<VirtualBox xmlns="http://www.virtualbox.org/" version="1.16-windows">
  <Machine uuid="{some uid}" name="source disk name" OSType="the_vbox_OS" snapshotFolder="Snapshots" lastStateChange="2043-03-23T00:54:18Z">
    <MediaRegistry>
      <HardDisks>
        <HardDisk uuid="{some uid}" location="C:\path_to\source.vmdk" ... 
```

在行上`<HardDisk uuid="{some uid}" location="C:\path_to\source.vmdk" ...`，**删除**括号之间的旧 UID 标记，然后**粘贴**您从命令窗口复制的那个。确保将支架留**在原位**！

保存此文件，然后退出您的文本编辑器。重命名`.vbox.bak`文件以将其恢复为预期的扩展名`.vbox`.

* * *

## 第 2 步 - 删除垃圾

现在可以安全地删除`.bak`目录中剩余的文件。剩下的是`.vmdk`使用更新的`.vbox`数据库调整大小，同时使用您之前保留的 VirtualBox Manager 设置。

* * *

## 第 3 步 - 调整磁盘分区的大小以填充可用空间

您现在可以启动 VirtualBox VM Manager 并执行您的 VM，使用适合操作系统的工具来填充新的可用空间。

对于**Windows 虚拟机**，使用`diskpart`从 Windows 恢复控制台（恢复分区）引导的命令提示符到`SELECT DISK 1`，`LIST PARTITION`并收集驱动器的分区号`C:\`，然后`SELECT PARTITION #`。您可以使用 将`EXTEND SIZE=mb`Windows C:\ 驱动器的大小调整为适当的值。确保为恢复和引导分区留出空间！由于卷影复制和 Windows 恢复文件，从新虚拟磁盘大小中减去 4096 MB 以获得此值是安全的。

对于**Linux VM**`.ISO` ，可以在以下位置找到可以使用 VM 磁盘文件启动的 gparted 直播：http: [//gparted.org/](http://gparted.org/) 它将让您直接进入基于图形用户界面的 gparted-gtk，您可以在其中填写你的自由空间。

对于**PPC / Mac VM**，`Disk Utility`Finder 将帮助您填充可用空间，但您可能需要考虑**gparted Linux 选项**，因为目前在 VirtualBox 中启动 MacOSX 的唯一方法是 hackintosh，并且您无法扩展您的卷在启动到 MacOSX 时。您可能还想暂时调整 VM 的设置`gparted`以使其启动。MacOSX 分区被 gparted 识别为`HFS`“堆文件系统”分区。

* * *

## 第 4 步 - 猫照片

因为互联网。;) 你完成了。`.vmdk`使用适用于 Windows 的 VirtualBox享受新调整大小的虚拟磁盘映像！

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2017-08-18T13:54:11.147

这是一种调整 VirtualBox 磁盘大小的方法，无论它是固定格式磁盘还是动态格式磁盘。具体来说，它可以防止您在磁盘为固定格式时遇到的错误。

* * *

> ⚠️ 备份虚拟磁盘。你永远不知道会出什么问题。

在您的主机上：

1.  打开一个终端窗口。

    > 在 Windows 上：打开命令提示符`cmd`。

2.  转到包含要调整大小的虚拟磁盘的目录。例如：

    ```
    cd "My VMs" 
    ```

3.  使用所需的文件名、大小（以兆字节为单位）和格式（`Standard`（动态）或`Fixed`）创建一个新的 VirtualBox 磁盘。例如，要创建一个名为 50 GB 的固定格式磁盘`MyNewDisk.vdi`：

    ```
    VBoxManage createmedium --filename "MyNewDisk.vdi" --size 50000 --variant Fixed 
    ```

    > 如果`VBoxManage`未被识别为命令，请指定它的完整路径。它可以在 VirtualBox 安装目录中找到。在 Windows 上，上述命令将变为：
    > 
    > ```
    > "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" createmedium
    >     --filename "MyNewDisk.vdi" --size 50000 --variant Fixed 
    > ```

4.  将原始磁盘复制到新磁盘。

    ```
    VBoxManage clonemedium "MyOriginalDisk.vdi" "MyNewDisk.vdi" --existing 
    ```

5.  调整大小完成！如果需要，您可以检查新磁盘的属性：

    ```
    VBoxManage showmediuminfo "MyNewDisk.vdi" 
    ```

6.  更改虚拟机以改用新磁盘。

接下来，在您的客户操作系统上，您需要调整分区大小以使用新的可用空间。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-12-19T15:28:00.927

我来到这里是因为我需要为我的 Docker (CoreOS) 开发环境调整磁盘大小。

CoreOS 文档说没有必要调整 OS 分区的大小——那是假的。调整虚拟磁盘的大小后，您应该按照以下说明通过 GParted 调整 OS 分区的大小：

[https://docs.docker.com/articles/b2d_volume_resize/](https://docs.docker.com/articles/b2d_volume_resize/)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2017-01-04T15:54:23.353

一个快速简单的选择：

1.  关闭机器
2.  创建具有所需大小的新虚拟盒磁盘
3.  将内容从旧磁盘移动到新磁盘内部：

    ```
    vboxmanage clonehd "source-disk.vmdk" "new-disk.vmdk" --existing 
    ```

4.  开机

5.  您可能需要调整 OS 中的分区大小以填充磁盘的其余部分

* * *

**警告**

如果新磁盘比源磁盘短，您将**丢失**源磁盘上新磁盘大小位置的数据。

您可以在步骤 1 之前在 OS 内源磁盘的末尾阻止此释放增量空间，其中 delta = size(source-disk) - size(new-disk)。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-10T12:36:27.257

使用这些简单的步骤来调整 vmdk 的大小。

1.  点击`File -> Virtual Media Player`

[![在此处输入图像描述](../Images/b37c9dc5b604d228228ad4b37324ef25.png)](https://i.stack.imgur.com/b1rC2.png)

2.  选择vdi文件并点击`properties`

[![在此处输入图像描述](../Images/bb310c20bbe4d104be12043b7cb99988.png)](https://i.stack.imgur.com/5ROBm.png)

您可以在此处增加或减少 vdi 大小。

# javascript - Javascript 奇怪 - 我一无所知

> ID：11659007
> 
> 赞同：0
> 
> 时间：2012-07-25T21:36:24.513
> 
> 标签：javascript, variables, for-loop, overriding

我正在研究这个菜单系统，它与操作系统的操作方式非常相似。使用 jquery 等。

我在 For 循环中有 2 条评论。它基本上是在 $(document).on('click')... 函数中输出每个索引的最后一个索引。但是在document.on之外它工作正常。

这可能只是一个明显的问题，但我已经花了大约一个小时来解决这个问题。提前谢谢！

```
 menu: function(title) {
        this.title = title;
        this.slug = slugify(title);
        this.icon = false;
        this.buttons = Object();
        this.num_buttons = 0;
        this.visible = false;
        this.timeout_id = null;
        this.is_hovering_dropdown = false;
        this.is_hovering_menu = false;

        this.render = function() {
            var that = this;
            var slug = that.slug;
            var str = '<li id="menu-' +slug +'"><a href="#" id="menu-toggle-' +slug + '">' + this.title + '</a>';

            if (this.num_buttons > 0) {
                str += '<ul id="menu-dropdown-' + slug + '" style="display: none;" class="dropdown">';
                for (var button in this.buttons) {

                    str += '<li><a href="#" id="menu-dropdown-' + slug + '-' +that.buttons[button]['slug'] +'">' +that.buttons[button]['title'] +'</a></li>'

                    alert(button) //new project, open project, save as etc.
                    $(document).on("click", "#menu-dropdown-" +slug + '-' + that.buttons[button]['slug'], function() {
                        $("#menu-dropdown-" + slug).hide("fade", 200);
                        that.visible = false;

                        alert(button);//save as, save as, save as, save as etc.
                    });
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:47:47.400

干得好：

由于操作顺序和作用域，所有按钮都通过引用*LAST*的值来保存`button`。

您要做的是将该分配放在立即调用函数中，并将按钮传递到该特定函数范围。

(function (button) { $(document). //...... }(button));

立即函数内部的所有内容都应该仍然可以访问立即函数范围之外的静态内容（即：）`that`，**并且**它还将具有对***当前***值的引用`button`，因为它在当时和那里被调用。

故事的更长版本是，您的按钮在创建时被赋予对 的*引用*，`button`而不是 的***值***，`button`因此，当稍后实际调用它们时，它们引用当前存在的按钮的值（即：它在循环中分配的最后一个值）。

# ios - OTA AdHoc 分发 - 如何从命令行构建 IPA？

> ID：11659009
> 
> 赞同：5
> 
> 时间：2012-07-25T21:36:26.210
> 
> 标签：ios, xcode, ad-hoc-distribution

我想编写我的构建过程。

但是 - 我需要为企业创建一个 IPA，以便为我的测试人员通过无线方式分发应用程序。

我按照[本文](http://altf.wordpress.com/2011/05/18/how-to-distribute-in-house-software-to-your-users-wirelessly/)的说明进行操作，我可以通过在 Xcode 中单击来创建 ipa 和 plist ;) 但是 - 我希望将其编写成脚本。真正的问题是如何正确创建 IPA（我需要在其中嵌入 .mobileprovision 文件，对吗？）以及如何生成 .plist 文件？

对于 plist，我应该手动执行此操作，还是如果问得好，xcode 会为我生成它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T21:44:48.017

你可以这样做：

```
xcodebuild -project "Your Project" -target "Your Scheme" -configuration Release

xcrun -sdk iphoneos PackageApplication -v "Some App.app" -o "Some App.ipa" --sign "iPhone Distribution: Your Signature\" --embed enterprise.mobileprovision 
```

从企业分发元数据 plist 的脚本角度来看，我创建了一个模板 plist，然后简单地对我的目标输出位置进行字符串替换。您可以变得更花哨，并以您选择的语言实际加载 plist 并遍历结构以实现您想要的，但由于只有几个值需要更改，我发现只需在plist 的原始字符串然后将其写回。

# android - JB 启动器存储库在哪里？为什么在 CM10 中 Trebuchet 的 src 文件夹是空的？

> ID：11659011
> 
> 赞同：-1
> 
> 时间：2012-07-25T21:36:36.030
> 
> 标签：android, launcher, cyanogenmod

github.com/android中没有Launcher2仓库，CM10中的目录Trebuchet/src是空的。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T05:19:57.657

Trebuchet needs to be re-written to work on JellyBean. I'm sure their working on it, though it might take a while

# javascript - 创建保存新模型时如何获取ID

> ID：11659012
> 
> 赞同：1
> 
> 时间：2012-07-25T21:36:35.580
> 
> 标签：javascript, backbone.js, marionette

在我的`Marionette.CompositeView`情况下，可以创建一个向服务器发出 put 请求的新模型（1）。
put 请求没问题，但是当我将新模型添加到集合中时，新模型会丢失服务器创建的 id。
我应该如何解决这个问题？

应该
1) POST 请求将 id 发送给客户端还是
2) 我必须从客户端发出另一个请求才能获取 id？

* * *

(1)

```
return Marionette.CompositeView.extend({

    submitForm: function (event) {
            this.textAreaElement = this.$el.find('[data-tid="announcement"]');
            this.messageModel = new MessageModel();
            this.messageModel.save({
                message: this.textAreaElement.val()
            }, {
                wait: true,
                success: this.onSuccess,
                error: this.onError
            });
   },

    onSuccess: function () {
        console.log(this.messageModel.get('id')); // undefined
        this.collection.add(this.messageModel); // I need to get also the id of the following model
                                                // which is created by the server
    }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T02:38:41.277

您的服务器需要使用代表已保存模型的 JSON 响应 POST，包括 ID（或只是 ID）。例如，return`{"id": "123"}`和backbone 将为您更新模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T00:26:31.260

在传递给 save() 的选项中，添加 wait:true。然后将模型的属性（包括 id）设置为服务器为此请求返回的任何 json 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T00:43:55.167

[Backbone-> Create](http://backbonejs.org/#Collection-create)，当然，就像@Robert 所说，您可以添加 wait:true 以便在服务器发回您的模型（包括 ID）之前不会更新您的视图

# ios - 如何在弹出框内调整导航控制器内的视图大小？

> ID：11659015
> 
> 赞同：0
> 
> 时间：2012-07-25T21:36:55.297
> 
> 标签：ios, ipad

我有一个弹出框，它为用户提供选项列表，当用户单击时，它将另一个视图推送到堆栈上。这适用于第一个视图，但是一旦打开一个较大的视图，当用户退出导航工作流程时，弹出窗口不会缩小到大小。我试过在子视图和导航视图上调用 sizeToFit ，但它似乎没有效果。

如何确保弹出框和导航控制器的大小适合当前显示的视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T00:03:00.483

通常在这种类型的工作流程中，假设您从 VC1 开始。在 VC1 中，您向用户呈现一个带有选择选项的弹出框。用户从列表中进行选择（表格视图等）然后您需要（从弹出窗口）对 VC1 进行回调，并将在这种情况下用户选择的任何数据传递回 VC1。VC1 然后关闭弹出框，然后使用该数据准备另一个视图控制器，并将新的视图控制器推送到显示/导航堆栈。这是我会使用的模式。

# facebook - 使用 Facebook API 自动删除 Facebook 页面喜欢

> ID：11659019
> 
> 赞同：2
> 
> 时间：2012-07-25T21:37:09.283
> 
> 标签：facebook, api, facebook-graph-api

正如我在 IT Security Stack Exchange 上的[帖子](https://security.stackexchange.com/questions/17574/facebook-page-receiving-improbable-amount-of-likes-from-unknown-users)中所详述的那样，我是一个页面的管理员，该页面有许多最近的未知（不受欢迎的）点赞。

有人建议我学习 Facebook API 并编写一个算法来根据阈值自动删除喜欢（例如：如果用户最近有可疑数量的喜欢，则删除一个喜欢）。

我知道许多其他帖子讨论了检索 Facebook 页面的点赞数的问题，但找不到任何讨论*删除*喜欢作为页面管理员的帖子。

这有可能实现吗？如果是这样，这将如何完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:59:15.887

尝试使用块方法。

```
PAGE_ID/blocked?uid=USER_ID_YOU_WANT_TO_BLOCK 
```

这应该与删除类似内容相同。我不确定取消阻止用户是否会重置类似（在 Twitter 上有效），因此您也可以`HTTP DELETE`在同一个电话中查看它。

据我所知，没有办法从页面中明确删除喜欢的内容。

有关更多信息，请参阅[http://developers.facebook.com/docs/reference/api/page/#blocked](http://developers.facebook.com/docs/reference/api/page/#blocked)

# android - Android 在加载新数据后更新 FragmentManager

> ID：11659021
> 
> 赞同：1
> 
> 时间：2012-07-25T21:37:17.723
> 
> 标签：android, android-fragments

我一生都无法弄清楚如何更新`Fragment`/entire `FragmentManager`。我正在使用`FragmentManager`SDK 附带的（滑动选项卡），其中一个是用于登录的表单。登录完成后（我已经想通了，它使用`AsyncTask`）我想重新更新整个`FragmentManager`部分。`FragmentTransaction`s 让我失望了（或者至少我无法让它们工作）所以我想知道刷新 UI 的最佳方法是什么。

另外，我有一个带有注销按钮的自定义菜单。当用户注销时，它还应该刷新 UI（选项卡会根据用户是否登录而改变）。

**TL;DR**如何从 Fragments 的内部和外部刷新/重新加载整个 Fragment 系统？

还有另一件事会有所帮助，如何在不同的`AsyncTask`完成后使用新信息（传递数组或 JSON 数组）进行片段更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:05:47.157

您必须粘贴一些代码才能查看 FragmentManager 出了什么问题。调用后应完成交易`<FragmentManager>.commit()`。

关于你的第二个问题：

为了让您`Fragment`更新新信息，您应该能够像往常一样添加一个方法`Fragment`并调用它。如果您从 调用该方法，请`AsyncTask`小心使用`Context`. 看看这个：

[如何从 ASyncTask 调用父活动函数？](https://stackoverflow.com/questions/5523438/how-to-call-parent-activity-function-from-asynctask)

# apache - htaccess 重定向错误 - 怎么了？

> ID：11659023
> 
> 赞同：0
> 
> 时间：2012-07-25T21:37:35.990
> 
> 标签：apache, .htaccess, redirect

在 localhost 中，我想进行重定向，但我不明白出了什么问题。

```
RewriteEngine on
RewriteCond %{REQUEST_URI} !/index.php$
RewriteCond %{REMOTE_HOST} !^127.0.0.1
RewriteRule $ namepage.php [R=302, L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T00:31:04.117

标志之间不能有空格，它会被解析为`RewriteRule`指令的单独参数：

```
RewriteRule $ namepage.php [R=302,L] 
```

# ios - iPad / iOS 5+：在 UITableViewCell 内，用于阿拉伯语和其他非拉丁（AZ 字符）语言的 UITextView 中的行间距错误

> ID：11659027
> 
> 赞同：0
> 
> 时间：2012-07-25T21:38:02.123
> 
> 标签：ios, uitableview, uitextview, arabic

iPad 的 iOS5+ 中存在一个非常奇怪的行间距错误：如果您使用 UITableView，其中每个 UITableViewCell 都是包含 UITextView 的自定义类型，那么包含来自非 AZ 语言（如阿拉伯语）的多行文本的单元格将与在模态视图中打开键盘后错误的行高。

*注意：虽然这似乎是 iOS 中的一个错误，但我正在寻找一种解决方法，以便我的应用程序向后兼容 iOS5+ 的版本。*

以下是如何复制错误：

**(1)(a)**在您的故事板中，创建一个 UIViewController（尽管创建您自己的子类），其中您有一个 UIToolbar 和一个 UITableView。在 UITableView 中，创建一个标识符为“CellIdentifier”的“Dynamic Prototype”单元格和一个标签为“1”且所有 AutoResize 属性打开的 UITextView（因此它占据了单元格的完整大小）。

![步骤 1a 的屏幕截图](../Images/8c8e385d091a32ce4c8a9ef5d341adb0.png)

**(1)(b)**在情节提要中，将 UIToolbar 链接到“toolbar”变量，将 UITableView 链接到“mainTableView”变量。将 UITableView“dataSource”和“delegate”设置为 UIViewController，并将 UITextView“delegate”设置为 UIViewController。

**(1)(c)**将以下代码添加到您的 UIViewController 子类中：

**MyViewController.h：**

```
#import <UIKit/UIKit.h>

@interface MyViewController : UIViewController <UITableViewDataSource, UITableViewDelegate, UITextViewDelegate>

// the toolbar at the top of the screen
@property (weak, nonatomic) IBOutlet UIToolbar *mainToolbar;

// the table view taking up the screen
@property (weak, nonatomic) IBOutlet UITableView *mainTableView;

@end 
```

**MyViewController.m：**

```
#import "MyViewController.h"

@interface MyViewController ()

// array to store text for cells
@property (strong, nonatomic) NSMutableArray *data;

// the number of rows to show
@property (nonatomic) NSInteger numberOfRowsToShow;

// when toolbar buttons are pressed
- (void)showModalViewButtonPressed;
- (void)redrawVisibleCellsButtonPressed;
- (void)insertButtonPressed;
- (void)deleteButtonPressed;

@end

@implementation MyViewController

@synthesize mainTableView;
@synthesize mainToolbar;
@synthesize data;

@synthesize numberOfRowsToShow;

- (void)viewDidLoad {
    [super viewDidLoad];
    // create data array for cell contents
    self.data = [[NSMutableArray alloc] initWithObjects:
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 @"سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام سلام",
                 nil];
    self.numberOfRowsToShow = 0;
    // set toolbar buttons
    [self.mainToolbar setItems:[NSArray arrayWithObjects:
                                [[UIBarButtonItem alloc] initWithTitle:@"Show Modal View" style:UIBarButtonItemStyleBordered target:self action:@selector(showModalViewButtonPressed)],
                                [[UIBarButtonItem alloc] initWithTitle:@"Redraw Visible Cells" style:UIBarButtonItemStyleBordered target:self action:@selector(redrawVisibleCellsButtonPressed)],
                                [[UIBarButtonItem alloc] initWithTitle:@"Insert" style:UIBarButtonItemStyleBordered target:self action:@selector(insertButtonPressed)],
                                [[UIBarButtonItem alloc] initWithTitle:@"Delete" style:UIBarButtonItemStyleBordered target:self action:@selector(deleteButtonPressed)],
                                nil] animated:YES];
}

- (void)viewDidUnload {
    [super viewDidUnload];
    // clean up
    self.data = nil;
    self.mainTableView = nil;
    self.mainToolbar = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return YES;
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    // only one section
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    // return the number of items in the data array
    return self.numberOfRowsToShow;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    // dequeue cell from storyboard
    UITableViewCell *cell = [self.mainTableView dequeueReusableCellWithIdentifier:@"CellIdentifier"];
    // get text view
    UITextView *cellText = (UITextView *)[cell viewWithTag:1];
    // set text using data array
    cellText.text = [self.data objectAtIndex:indexPath.row];
    // set large font
    cellText.font = [UIFont systemFontOfSize:20.0f];
    // set background color based on whether the line spacing is correct
    if (cellText.contentSize.height == 100.0f) {
        // correct height sets a green background
        cellText.backgroundColor = [UIColor greenColor];
    } else if (cellText.contentSize.height == 88.0f) {
        // wrong height sets a red background
        cellText.backgroundColor = [UIColor redColor];
    }
    return cell;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    // return constant height
    return 150.0f;
}

- (void)textViewDidChange:(UITextView *)textView {
    // get parent cell for text view
    UITableViewCell *parentCell = (UITableViewCell *)textView.superview.superview;
    // get parent cell indent path
    NSIndexPath *parentIndexPath = [self.mainTableView indexPathForCell:parentCell];
    // save new text to data array
    [self.data replaceObjectAtIndex:parentIndexPath.row withObject:textView.text];
}

#pragma mark - Other methods

- (void)showModalViewButtonPressed {
    // segue to modal view
    [self performSegueWithIdentifier:@"modalSegue" sender:self];
}

- (void)redrawVisibleCellsButtonPressed {
    // reload all visible cells in the table view
    [self.mainTableView reloadRowsAtIndexPaths:[self.mainTableView indexPathsForVisibleRows] withRowAnimation:UITableViewRowAnimationNone];
}

- (void)insertButtonPressed {
    // insert a cell in the table view (increments number of rows to show first)
    [self.mainTableView insertRowsAtIndexPaths:[NSArray arrayWithObject:[NSIndexPath indexPathForRow:self.numberOfRowsToShow++ inSection:0]] withRowAnimation:UITableViewRowAnimationNone];
}

- (void)deleteButtonPressed {
    // delete a cell in the table view (decrements number of rows to show first)
    [self.mainTableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:[NSIndexPath indexPathForRow:--self.numberOfRowsToShow inSection:0]] withRowAnimation:UITableViewRowAnimationNone];
}

@end 
```

**(2)(a)**在你的故事板中，创建一个 UINavigationController 和一个 UIViewController（它也是子类），并在其属性中将 UIViewController 设置为 UINavigationController 的根视图控制器。将带有“完成”按钮的 UIToolbar 添加到 UIViewController 以及 UITextField。向 UINavigationController 添加一个模态 segue，主视图控制器称为“modalSegue”。

![步骤 2a 的屏幕截图](../Images/6f33650d222d5e2969aa30dbd1de7260.png)

**(2)(b)**在您的故事板中，将“完成”按钮与 IBAction“closeButtonPressed”链接起来。

**(2)(c)**将以下代码添加到您的模态 UIViewController：

**MyModalViewController.h：**

```
#import <UIKit/UIKit.h>

@interface MyModalViewController : UIViewController

- (IBAction)closeButtonPressed:(id)sender;

@end 
```

**MyModalViewController.m：**

```
#import "MyModalViewController.h"

@implementation MyModalViewController

- (IBAction)closeButtonPressed:(id)sender {
    [self dismissModalViewControllerAnimated:YES];
}

@end 
```

**测试：**

**(1)**运行应用程序。当屏幕加载时， UITableView 将没有内容。

![步骤 1 的屏幕截图](../Images/b5ce22aa0c691b957ef38c117bc59419.png)

**(2)**点击工具栏中的“插入”按钮几次。两个单元格将以绿色添加。请注意，对于仅包含阿拉伯语和英语的行，此处的行间距要高 4 个像素（字体大小为 20）（您可以自己尝试在单元格中使用全英文文本）。在这个阶段，您会看到应用程序的正确行为。

![步骤 2 截图](../Images/6ad7212440d0acf5ff3f66d2e7d1e397.png)

**(3)**点击“显示模态视图”按钮，当模态视图打开时，点击 UITextField 内部以打开键盘。点击“完成”关闭模式视图。从这一点开始，该错误将发生在 UITableView 中（请参阅下一步）。

![第三步截图](../Images/5eeb031366f2c034f6eeeee9244eadac.png)

**(4)**再点几次“插入”。请注意，所有新单元格都是红色的。这是因为新单元格中的行间距是错误的——如果文本是全英文字母，它们是使用的间距，因为不再像以前那样为阿拉伯语添加额外的 4 个像素。

![步骤 4 的屏幕截图](../Images/ce13d2c4a09f7767854f28607c85bb01.png)

**(5)**要真正看到一些错误，请点击“Redraw Visible Cells”按钮，然后在重绘单元格时观察 UITableView 周围的颜色变化。

**讨论：**在模态视图中打开键盘后出列的新单元格似乎对阿拉伯语和其他非英语文本有错误的行高。这似乎与 UITableView 的缓存机制有关。挑战在于找到在所有情况下都加载适当行距的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:59:23.103

这不是一个完美的解决方案，而是一个黑客/解决方法。真正的解决方案将在 Apple 修复此错误时出现。

请注意：Apple Developer Support 推荐了此答案。

在 UITextField 或 UISearchBar 成为具有样式表的模态视图中的第一响应者之后，在 UITableViewCells 内的所有 UITextView 中都会导致此错误。

解决方法是：

1.  子类 UITextView 以创建您自己的 UITextField 和 UISearchBar 版本，而不是使用实际的控件。
2.  不要在 UITableViewCell 中使用 UITextView。相反，使用 Core Text 创建您自己的版本。

选项 1 更快，但在滚动方面有其自身的挑战。选项 2 效果很好，但需要很长时间。研究 EGOTextView 以获得良好的起点。

# lotus-notes - 过滤嵌套重复

> ID：11659028
> 
> 赞同：0
> 
> 时间：2012-07-25T21:38:06.777
> 
> 标签：lotus-notes, xpages, lotus

我的应用程序包含公司和客户的文件。这是多对多的关系；一个公司可以有任意数量的客户，一个客户可以是许多公司的客户。通过创建对公司的响应文档来存储关系，其中包含客户文档的 ID 字段。

我希望能够在公司的 XPage 上显示来自客户文档的字段，并且我一直在尝试使用重复控件来做到这一点。我创建了所有链接文档的视图，并使用它来创建重复，使用当前文档 ID 过滤它以收集当前公司拥有的所有链接。这允许我列出与该公司关联的客户文档的所有 ID。

我一直在尝试研究如何将此 ID 传递给嵌套在第一个控件中的重复控件，或者将其用作所有客户端文档视图的过滤器，或者直接将其用作数据源文档 ID。这可能吗？如果没有，我将如何在公司页面上显示来自客户文档的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T03:23:24.783

当您指定重复控件时，您指定包含实例值的变量。此变量名称对重复控件内的任何内容都是可见的。因此，您的变量将一次包含一个客户端文档的 UNID。例如你叫它`ClientDocID`。您在该重复控件内放置了一个面板。该面板可以有自己的 DominoDocument 数据源。数据源可以具有新建、显示或编辑作为默认操作。您选择需要提供 DocumentId 的“显示”。选择“计算”并简单地`ClientDocID`用作公式。

您可以抑制面板的 HTML 呈现（检查属性），因此它适合例如在`xp:tr`.

希望有帮助

# ruby-on-rails - 即使 user_signed_in? current_user 返回 nil？返回真

> ID：11659030
> 
> 赞同：2
> 
> 时间：2012-07-25T21:38:14.930
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, cancan

我已经安装了 devise 2.1.2 和 cancan 1.6.8。

devise的`current_user`助手在我的控制器中工作正常，但不能在视图模板中工作。我很困惑为什么会这样。我以前可以`current_user`在我的视图文件中使用。

我尝试添加 before_filter`authenticate_user!`并没有帮助。

更糟的是，我会在 application_controller 中添加一个 before 过滤器，上面写着`@current_user = current_user`但这看起来很傻。

`current_user`返回 nil 而`user_signed_in?`返回 true很奇怪。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T23:17:54.780

同时，`warden.authenticate(:scope => :user)`似乎返回了，`current_user`所以我只想将它添加到我的应用程序助手中。

# macos - 如何获得 DHCP 续订通知

> ID：11659034
> 
> 赞同：1
> 
> 时间：2012-07-25T21:38:40.487
> 
> 标签：macos, networking, notifications, dhcp

我想知道 OSX 中用于 DHCP 更新通知的 API。如果没有轮询，我希望在我的 mac 的 IP 地址发生变化时得到通知。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-26T01:56:48.377

这个问题毫无意义。DHCP 续订不会更改您的 IP 地址。

# r - R：将数据框中的值替换为 NAs 作为占位符

> ID：11659035
> 
> 赞同：2
> 
> 时间：2012-07-25T21:38:43.527
> 
> 标签：r, dataframe

鉴于第一个数据帧中存在一个值，我想用另一个数据帧中的值替换一个数据帧中的值。

第一个数据帧由 1 或 0 的值组成，NA 是占位符。

```
a <- structure(list(A.1 = c(1L, 0L, NA, 1L, 1L, 0L), A.2 = c(1L, 1L, 
1L, NA, 1L, NA), A.3 = c(0L, NA, NA, 0L, NA, NA), A.4 = c(NA, 
1L, 1L, NA, 0L, NA), A.5 = c(NA, NA, 1L, NA, NA, NA), A.6 = c(NA, 
NA, 1L, NA, NA, 1L)), .Names = c("A.1", "A.2", "A.3", "A.4", 
"A.5", "A.6"), class = "data.frame", row.names = c(NA, -6L)) 
```

第二个数据帧包含的值应该替换第一个数据帧中 NA 位置的 1 或 0

```
r <- structure(list(R.1 = c(45L, 33L, 44L, 24L, 32L, 22L), R.2 = c(33L, 
99L, 44L, 25L, 25L, 33L), R.3 = c(22L, 77L, 22L, NA, 26L, NA), 
    R.4 = c(NA, NA, 32L, NA, NA, NA)), .Names = c("R.1", "R.2", 
"R.3", "R.4"), class = "data.frame", row.names = c(NA, -6L)) 
```

目标是这样的：

```
d <- structure(list(D.1 = c(45L, 33L, NA, 24L, 32L, 22L), D.2 = c(33L, 
99L, 44L, NA, 25L, NA), D.3 = c(22L, NA, NA, 25L, NA, NA), D.4 = c(NA, 
77L, 44L, NA, 26L, NA), D.5 = c(NA, NA, 22L, NA, NA, NA), D.6 = c(NA, 
NA, 32L, NA, NA, 33L)), .Names = c("D.1", "D.2", "D.3", "D.4", 
"D.5", "D.6"), class = "data.frame", row.names = c(NA, -6L)) 
```

欢迎任何和所有建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T23:08:05.587

```
d <- t(a)
d[!is.na(d)] <- t(r)[!is.na(t(r))]
t(d)
     A.1 A.2 A.3 A.4 A.5 A.6
[1,]  45  33  22  NA  NA  NA
[2,]  33  99  NA  77  NA  NA
[3,]  NA  44  NA  44  22  32
[4,]  24  NA  25  NA  NA  NA
[5,]  32  25  NA  26  NA  NA
[6,]  22  NA  NA  NA  NA  33 
```

另外，请注意`t()`返回矩阵而不是 data.frame

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T23:07:13.323

```
d <- matrix(data=NA, ncol=ncol(a),nrow=nrow(a)) # Initialize matrix

replacements <- t(r) # Transpose R for na.omit()

# Replace
for (x in 1:nrow(a)) { 
  locations <- which(!is.na(a[x,]))
  d[x,locations] <- na.omit(replacements[,x])
  } 
```

# naming-conventions - 命名描述相同事物但类型不同的变量

> ID：11659036
> 
> 赞同：2
> 
> 时间：2012-07-25T21:38:51.553
> 
> 标签：naming-conventions

在处理不同类型但描述相同事物的变量时，变量命名中普遍接受的方法是什么？

```
private String  contentFolder    = "/tmp/";
private File    contentDirectory = new File(contentFolder); 
```

上面的看起来很草率。但是什么更好呢？

```
private String  contentDirectoryStr = "/tmp/";
private File    contentDirectory    = new File(contentDirectoryStr); 
```

看起来一样糟糕。

**您遵循什么惯例来描述不同类型的相同事物？**

认为你当然可以`String`从中得到`File`，就这个问题而言，假设你在课堂上合法地需要 a`String`和 a `File`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T21:41:55.167

我的第一个想法是使用相同的名称，但根据类型进行区分。

例子：

```
private String  contentDirStr  = "/tmp/";
private File    contentDirFile = new File(contentDirStr); 
```

当然最好不要有两个对象代表同一事物，但如果你真的需要，我会这样命名它们。

# sql - 左加入在“开”时返回语法错误

> ID：11659040
> 
> 赞同：-1
> 
> 时间：2012-07-25T21:39:09.173
> 
> 标签：sql, sql-server, sql-server-2008

```
Msg 156, Level 15, State 1, Line 107
Incorrect syntax near the keyword 'on'. 
```

我有一个相当大的查询，我将只提供其中的一小部分。我收到以下语法错误`ON SplitAddresses.Client_id=d_client.CLIENT_ID`：

```
...
left join
(SELECT  distinct
   T.MLIS_CLIENT_ADDRESS_1,T.Client_id,
   Left(T.MLIS_CLIENT_ADDRESS_1, IsNull(SplitAddresses.Pos - 1, 2147483647)) Address1,
   Substring(T.MLIS_CLIENT_ADDRESS_1, SplitAddresses.Pos + 1, 2147483647) Address2
FROM

      d_client
    T 
   OUTER APPLY (
      SELECT TOP 1 NullIf(PatIndex(Delimiter, T.MLIS_CLIENT_ADDRESS_1), 0) Pos
      FROM (
         VALUES ('% Suite %'), ('% Ste %'), ('% Bldg %'), ('% Building %'), ('%#%')
      ) SplitAddresses (Delimiter)
      WHERE T.MLIS_CLIENT_ADDRESS_1 LIKE SplitAddresses.Delimiter 
      ORDER BY Pos
   ) SplitAddresses
on 
SplitAddresses.Client_id=d_client.CLIENT_ID

WHERE... 
```

我是在语法上做了一些明显错误还是有更深层次的问题？非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T21:49:11.023

这是您的 SQL 的重新格式化，可能会使您的问题更加清楚：

```
left join
(
SELECT Distinct
    T.MLIS_CLIENT_ADDRESS_1,
    T.Client_id,
    Left(T.MLIS_CLIENT_ADDRESS_1, IsNull(SplitAddresses.Pos - 1, 2147483647)) Address1,
    Substring(T.MLIS_CLIENT_ADDRESS_1, SplitAddresses.Pos + 1, 2147483647) Address2
FROM
    d_client T 
        OUTER APPLY 
        (
            SELECT TOP 1 
                NullIf(PatIndex(Delimiter, T.MLIS_CLIENT_ADDRESS_1), 0) Pos
            FROM 
            (
                VALUES 
                    ('% Suite %'), 
                    ('% Ste %'), 
                    ('% Bldg %'), 
                    ('% Building %'), 
                    ('%#%')
            ) SplitAddresses (Delimiter)
            WHERE 
                T.MLIS_CLIENT_ADDRESS_1 LIKE SplitAddresses.Delimiter 
            ORDER BY Pos
        ) SplitAddresses
on SplitAddresses.Client_id=d_client.CLIENT_ID 
```

看起来你在 SplitAddresses 之前错过了第二个 ) ：

```
left join
    (
    SELECT Distinct
        T.MLIS_CLIENT_ADDRESS_1,
        T.Client_id,
        Left(T.MLIS_CLIENT_ADDRESS_1, IsNull(SplitAddresses.Pos - 1, 2147483647)) Address1,
        Substring(T.MLIS_CLIENT_ADDRESS_1, SplitAddresses.Pos + 1, 2147483647) Address2
    FROM
        d_client T 
            OUTER APPLY 
            (
                SELECT TOP 1 
                    NullIf(PatIndex(Delimiter, T.MLIS_CLIENT_ADDRESS_1), 0) Pos
                FROM 
                (
                    VALUES 
                        ('% Suite %'), 
                        ('% Ste %'), 
                        ('% Bldg %'), 
                        ('% Building %'), 
                        ('%#%')
                ) SplitAddresses (Delimiter)
                WHERE 
                    T.MLIS_CLIENT_ADDRESS_1 LIKE SplitAddresses.Delimiter 
                ORDER BY Pos
            ) SA
    ) SplitAddresses
    on SplitAddresses.Client_id=d_client.CLIENT_ID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T21:41:56.367

看起来您在声明中给出`d_client`了别名`T`而不是使用它`on`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T21:43:43.610

结束前的括号`on`结束`outer apply`，而不是`select`您要使用的。添加另一个结束括号。

# dynamic - Flexslider 项目在调整大小时消失

> ID：11659045
> 
> 赞同：4
> 
> 时间：2012-07-25T21:39:20.940
> 
> 标签：dynamic, slider, fluid-layout

我已经设置了一个 flexslider 作为流体宽度站点的产品轮播。当浏览器窗口打开到一定宽度时，产品项目有时会消失。详情如下：

[开发站点/演示](http://capefeargames.dev.crystalcommerce.com/)

这是关于称为“热门产品”的中心框。这是在我测试过的所有浏览器（FF、IE、Chrome、Safari）中复制我遇到的问题的方法

1.  关闭浏览器窗口，直到只显示 4 或 5 个项目
2.  点击右箭头，直到显示最后一个产品（目前是pro-mate黑袖）
3.  现在，将浏览器窗口调整得*更宽*，产品会在某个点消失。再次变小，它们会重新出现。

**可能有帮助的注意事项：**

*   如果您不在轮播中的最后一项并调整大小，则它可以正常工作并且可以根据需要进行拉伸

*   如果浏览器很宽并且最多显示 6 个产品，并且您转到轮播中的最后一项，然后再次调整大小，它也可以正常工作（因此只有在轮播较小时转到最后一项时才会中断宽度，然后变大）

*   对于滑块配置，我将 minItems 设置为 4，将 maxItems 设置为 6。

*   flexslider 的所有演示都只是图像......我还没有看到有人像我一样使用它在每个项目中显示 html，我也不知道它是否被设计为允许这样做。希望如果其他人也在做 html/multi-items insde flexslider，这将是他们已经看到的东西，或者如果我们解决它可以帮助他们。

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-08T16:39:52.133

Lauren 的修复是详细而完整的（除了已弃用的 $.broswer），但我发现在调整大小时简单地将轮播重置为幻灯片 0 对于响应式设计来说是简单而优雅的。由于测试，在构建站点时很容易关注调整事件的大小，但在现实世界中，人们不会在查看页面时不断调整浏览器的大小，而那些是非常小的边缘情况。所以这是我的解决方案：

```
$(window).bind("resize", function(){
    $('#flexslider').flexslider(0);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T18:45:23.467

这似乎适用于最新的 Chrome、Safari、Firefox 和 IE，但它很混乱（主要是因为我让它在 Chrome、Safari 和 Firefox 中运行，然后意识到 IE9 仍在使元素消失）：

```
/*
 * Flexslider BUG FIX:
 *   Summary: on window resize, ensure team scrollbar members are all visible
 *   Dependency: Flexslider v2.1 and its dependencies
 */
$(window).bind("resize", function(){
    //doesnt work well in IEs, so detect these browsers
    //var isIE9 = ($.browser.version == "9.0") && ($.browser.msie == true);
    var isIE = $.browser.msie == true;
    var tmpCurrentItem = $('#team').flexslider().data().flexslider.currentItem;
    // if current item isnt the 1st one, then resizing may mean that images will disappear
    if (tmpCurrentItem != 0) {
       // sometimes passing a number into flexslider doesn't work and returns nothing
       // in these instances, move to 0

       //if NOT IE
       if (isIE != true) {
         var tmpFlexValue = $('#team').flexslider(tmpCurrentItem);
         if (tmpFlexValue == undefined) {
            $('#team').flexslider(0);
         }
       }

       var tmpCurrentSlide = $('#team').flexslider().data().flexslider.currentSlide;
       var tmpPages = $('#team').flexslider().data().flexslider.pagingCount;

       //if IE
       //slide number (not item number) should ALWAYS be less than paging Count
       //otherwise, it needs to be reset to 0
       if (isIE == true){
          if (tmpCurrentSlide >= tmpPages) {
                $('#team').flexslider(0); //this triggers another resize event
           }
       }
    }
});
/* end flexslider bug fix
*/ 
```

# java - Servlet web.xml 过滤器——找不到类异常

> ID：11659047
> 
> 赞同：2
> 
> 时间：2012-07-25T21:39:57.740
> 
> 标签：java, web-services, jsp, servlets, web.xml

我在设置过滤器时遇到问题 - 我在 web.xml 中定义的过滤器看起来像这样

```
 <filter>
   <filter-name>Log</filter-name>
   <filter-class>test.log</filter-class> 
 </filter>
 <filter-mapping>
   <filter-name>Log</filter-name>
   <url-pattern>/*</url-pattern>
 </filter-mapping> 
```

但我收到以下错误 -

```
SEVERE: Exception starting filter Log
java.lang.ClassNotFoundException: test.log
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:532)
at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:514)
at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:133)
at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:256)
at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:382)
at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:103)
at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4650)
at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5306)
at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
at java.util.concurrent.FutureTask.run(FutureTask.java:166)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:722) 
```

我已经定义了类，但由于某种原因，我得到了 Classnotfoundexcetion。有人可以帮我吗？

编辑 - -

我有一个名为 test 的包和一个名为 log 的类。

```
 package test;
    import java.io.*;
    import javax.servlet.*;
    import javax.servlet.http.*;
    import java.util.*;

    // Implements Filter class
     public class log implements Filter  {
         public void  init(FilterConfig config) {

          }
         public void  doFilter(ServletRequest request, 
             ServletResponse response,
             FilterChain chain) 
             throws java.io.IOException, ServletException {

  // Get the IP address of client machine.   
  String ipAddress = request.getRemoteAddr();

  // Log the IP address and current timestamp.
  System.out.println("IP "+ ipAddress + ", Time "
                                   + new Date().toString());

  // Pass request back down the filter chain
  chain.doFilter(request,response);
  }
   public void destroy( ){
      /* Called before the Filter instance is removed 
      from service by the web container*/
  }
 } 
```

谢谢你，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-04-14T07:38:44.137

有趣的是，同样的问题今天刚刚发生在我身上，而它昨天还在工作。经过调查显示没有任何问题，我得出结论这是一个 Eclipse 环境问题：

*   停止 tomcat 服务器
*   清理项目（项目->清理...）
*   刷新整个项目（右键项目名称->刷新）
*   再次启动服务器。

问题没了！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T21:44:00.467

filter-class 参数需要是一个应该实现 Filter 接口的 Java 类。你能检查一下你的情况吗？

检查此示例以获取指导：

[http://viralpatel.net/blogs/tutorial-java-servlet-filter-example-using-eclipse-apache-tomcat/](http://viralpatel.net/blogs/tutorial-java-servlet-filter-example-using-eclipse-apache-tomcat/)

从上面的链接：

```
<filter>
    <filter-name>LogFilter</filter-name>
    <filter-class>
        net.viralpatel.servlet.filters.LogFilter
    </filter-class>
    <init-param>
        <param-name>test-param</param-name>
        <param-value>This parameter is for testing.</param-value>
    </init-param>
</filter>
<filter-mapping>
    <filter-name>LogFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

public class LogFilter implements Filter {

    public void doFilter(ServletRequest req, ServletResponse res,
            FilterChain chain) throws IOException, ServletException {...
    }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T21:53:04.873

对于一个简单的解决方案，请尝试将您的`log.class`文件放入此目录：

```
tomcat/webapps/[your app name]/WEB-INF/classes/test 
```

如果该目录不存在，则创建该目录。

* * *

**如何找到您的 .class 文件：**

大多数情况下，Eclipse 的默认设置会在您保存源文件 ( `.java`)`.class`时将其编译为文件，否则您可能必须按 CTRL-B（构建）来强制将其编译为`.class`文件。

完成后，您将能够`log.class`在 Eclipse 工作区中的以下位置找到该文件：`[your workspace name]/[your eclipse project name]/bin/test/`

工作区目录位置通常在您启动 eclipse 时可见。对于 Windows 7，我认为它默认为`Users`目录，WinXP 和 2000 它默认为用户的`Documents and Settings`文件夹。

交替：

您应该在 Eclipse 窗口的左侧有一个“Package Explorer”视图。它将`log.java`在包树中包含一个叶子。如果您右键单击该叶子，然后单击`Show In`> `Navigator`，这将在“导航器”视图中打开实际的文件结构。

该视图中应该有一个`bin`可见的节点。在里面你应该找到一个`test`节点，然后在里面你会看到`log.class`。您可以右键单击它来复制它，然后只需导航到我在顶部提供的目录并将其粘贴进去。

一切都应该很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-23T17:10:03.830

这在相关类的源代码中可能有问题。

最近我碰巧看到了同样的问题。经过长时间的艰苦调查，我发现异常是在类中编码的：

```
$ jad BaseController.class 
Parsing BaseController.class...The class file version is 51.0 (only 45.3, 46.0 and 47.0 are supported)
 Generating BaseController.jad
$ cat BaseController.jad 
// Decompiled by Jad v1.5.8e. Copyright 2001 Pavel Kouznetsov.
// Jad home page: http://www.geocities.com/kpdus/jad.html
...
import HttpServletRequest;
import HttpServletResponse;
import HttpSession;
...
public class BaseController
{
    public BaseController()
    {
        throw new Error("Unresolved compilation problems: \n\tThe import javax.servlet.http.HttpServletRequest cannot be resolved\n\tThe import javax.servlet.http.HttpServletResponse cannot be resolved\n\tThe import javax.servlet.http.HttpSession cannot be resolved\n\tHttpSession cannot be resolved to a type\n\tHttpServletRequest cannot be resolved to a type\n\tHttpSession cannot be resolved to a type\n\tHttpSession cannot be resolved to a type\n\tHttpServletRequest cannot be resolved to a type\n\tHttpServletRequest cannot be resolved to a type\n\tHttpServletResponse cannot be resolved to a type\n");
    }
... 
```

因此，在使用必要的库重新编译源代码后，问题就解决了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-25T14:44:18.267

曾经出现过问题，最后右键单击项目->**构建项目**帮助。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-25T21:50:13.723

我猜您没有将其正确复制并包含在 servlet 类路径中。

请参阅此处了解组成 servlet 类路径的内容：

[控制 servlet 中的类路径](https://stackoverflow.com/questions/264828/controlling-the-classpath-in-a-servlet)

# c++ - 如何在 OpenGL 3.3 中实现 3D 纹理

> ID：11659050
> 
> 赞同：0
> 
> 时间：2012-07-25T21:40:16.757
> 
> 标签：c++, opengl, 3d, textures

所以我刚刚意识到我正在为 3d 纹理编写的代码是用于 OpenGL 1.1 或其他东西的，并且在 OpenGL 3.3 中不再支持。没有glTexture3D还有另一种方法吗？也许通过我不知道的 OpenGL 3.3 中的库或其他函数？

编辑：我不确定我在哪里读到 3d 纹理是在较新版本中从 OpenGL 中取出的（今天一直在谷歌上搜索），但请考虑一下：

我一直在关注[这里](http://content.gpwiki.org/index.php/OpenGL%3aTutorials:3D_Textures)的教程/指南。该程序编译顺利。现在阅读文章中的以下引用：

> 程序运行的环境可能不支持 3D 纹理，这会导致我们返回一个 NULL 地址，并且尝试使用 NULL 指针是一件坏事，因此请务必检查它并做出适当的响应（提供的示例退出并出现错误）。

该引用是指以下功能：

```
glTexImage3D = (PFNGLTEXIMAGE3DPROC) wglGetProcAddress("glTexImage3D"); 
```

在我的计算机（具有 OpenGL 3.3）上运行我的程序时，相同的函数为我返回 null。当我的朋友在他的计算机（具有 OpenGL 1.2）上运行它时，它不会返回 null。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:48:38.713

自 OpenGL-1.2 以来，上传 3D 纹理的方式没有改变。用于此的函数仍被命名

*   `glTexImage3D`
*   `glTexSubImage3D`
*   `glCopyTexSubImage3D`

# python - 生成不同的空变量列表

> ID：11659052
> 
> 赞同：0
> 
> 时间：2012-07-25T21:40:37.063
> 
> 标签：python, initialization, mutable

我需要初始化一个默认字典列表。如果他们是，比如说，字符串，这将是整洁的：

```
list_of_dds = [string] * n 
```

...但是对于可变对象，您会直接使用这种方法：

```
>>> x=[defaultdict(list)] * 3
>>> x[0]['foo'] = 'bar'
>>> x
[defaultdict(<type 'list'>, {'foo': 'bar'}), defaultdict(<type 'list'>, {'foo': 'bar'}), defaultdict(<type 'list'>, {'foo': 'bar'})] 
```

我*想要*的是一个可迭代的新创建的不同默认字典实例。我可以做这个：

```
list_of_dds = [defaultdict(list) for i in xrange(n)] 
```

但我觉得在这里使用列表理解有点脏。我认为有更好的方法。在那儿？请告诉我它是什么。

编辑：

这就是为什么我觉得列表理解不是最理想的。我通常不是预优化类型，但我不能让自己忽略这里的速度差异：

```
>>> timeit('x=[string.letters]*100', setup='import string')
0.9318461418151855
>>> timeit('x=[string.letters for i in xrange(100)]', setup='import string')
12.606678009033203
>>> timeit('x=[[]]*100')
0.890861988067627
>>> timeit('x=[[] for i in xrange(100)]')
9.716886043548584 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T21:42:21.780

您使用列表理解的方法是正确的。为什么你觉得它很脏？您想要的是一个长度由某个基本集定义的事物列表。列表推导式基于某些基本集创建列表。在这里使用列表理解有什么问题？

编辑：速度差异是您尝试做的直接后果。 `[[]]*100`更快，因为它只需要创建一个列表。每次创建一个新列表都比较慢，是的，但是如果你真的想要 100 个不同的列表，你必须期望它会更慢。

（它不会每次在您的字符串示例上创建一个新字符串，但它仍然较慢，因为列表理解不能提前“知道”所有元素都将是相同的，所以它仍然必须每次都重新评估表达式。我不知道列表组合的内部细节，但可能还有一些列表调整开销，因为它不一定知道可迭代的索引的大小，所以它可以t 预先分配列表。此外，请注意，您的字符串示例中的一些减速是由于`string.letters`每次迭代都进行查找。在我的系统上，`timeit.timeit('x=[letters for i in xrange(100)]', setup='from string import letters')`改为使用 --- 只查找`string.letters`一次 --- 将时间减少了大约 30%。 )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T21:59:29.843

列表理解正是您应该使用的。

列表乘法的问题是创建了包含单个可变对象的列表，*然后*您尝试复制它。但是通过尝试从对象本身复制对象，用于创建它的代码不再相关。您对对象所做的任何事情都不会做您想做*的*事情，即运行用于创建它的代码 N 次，因为该对象不知道用于创建它的代码是什么。

你可以使用 copy.copy 或 copy.deepcopy 来复制它，但这会让你回到同一条船上，因为那时对 copy/deepcopy 的调用就变成了你需要运行 N 次的代码。

列表推导非常适合这里。它出什么问题了？

# ruby-on-rails - mod_passenger“无法连接到 Unix 套接字”错误

> ID：11659053
> 
> 赞同：1
> 
> 时间：2012-07-25T21:40:44.387
> 
> 标签：ruby-on-rails, apache, ubuntu, passenger

我正在尝试通过 mod_passenger 访问在 Apache 中运行的几个 Rails 应用程序（Redmine、toto），并在我的 Apache 错误日志中得到以下错误：

```
[ pid=11154 thr=3076008592 file=ext/apache2/Hooks.cpp:884 time=2012-07-25 17:25:02.921 ]: Unexpected error in mod_passenger: Cannot connect to Unix socket '/tmp/passenger.1.0.10257/generation-0/socket': Permission denied (13)
  Backtrace:
 in 'Passenger::ApplicationPool::Client* Passenger::ApplicationPool::Client::connect(const std::string&, const std::string&, const Passenger::StaticString&)' (Client.h:438)
 in 'Passenger::ApplicationPool::Client* Hooks::getApplicationPool()' (Hooks.cpp:286)
 in 'Passenger::SessionPtr Hooks::getSession(const Passenger::PoolOptions&)' (Hooks.cpp:312)
 in 'int Hooks::handleRequest(request_rec*)' (Hooks.cpp:585) 
```

这是我的 Apache Passenger conf 文件：

```
$ cat passenger.conf
<IfModule mod_passenger.c>
  PassengerRoot /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14
  PassengerRuby /usr/local/bin/ruby
  PassengerDefaultUser www-data
</IfModule>
$ cat passenger.load
LoadModule passenger_module /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.14/ext/apache2/mod_passenger.so 
```

我正在运行 Ubuntu 11.04、Apache 2.2.17、Ruby 1.9.1、Rails 3.2.6、Passenger 3.0.14。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:47:54.593

您唯一需要解决的是：

```
'/tmp/passenger.1.0.10257/generation-0/socket': Permission denied (13) 
```

但是 tmp 通常设置了粘性位，它限制了非所有者可以对文件执行的操作（使用 unix 套接字的一个重要原因是权限分离）。真的一个套接字根本不应该在 /tmp 中。/var 中的某个位置是更明智的位置。

是的，您对 /tmp 的权限是错误的，因此您会遇到其他奇怪的事情。

# node.js - 如何在 fs 回调方法中访问文件名？

> ID：11659054
> 
> 赞同：5
> 
> 时间：2012-07-25T21:40:44.920
> 
> 标签：node.js, asynccallback, fs

如何从回调中访问[`fs.read`, `fs.stat`...方法的参数？](http://nodejs.org/api/fs.html)

例如，如果我想根据文件的大小处理文件以下（coffeeScript）代码片段

```
#assuming test1.txt exists
filename = "./test1.txt"
fs.stat filename, (err, stats) ->
  data = filename:filename,size:stats.size
  console.log data
  #further process filename based on size
filename = "./test2.txt" 
```

印刷

```
{ filename: './test2.txt', size: 5 } 
```

因为文件名设置为“./test2.txt”。如果我在回调中使用文件名变量处理/读取文件 `fs.stat`，它将使用`test2.txt`不打算使用的文件。

我希望在回调中看到的是

```
{ filename: './test1.txt', size: 5 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-25T22:38:04.197

不要认为现在有办法做到这一点。在某些时候添加到节点可能是一件好事。如果你要经常这样做，你可以放入`fs.stat`一个友好的包装器。

```
var friendlyStat = function(filename, callback){
    fs.stat(filename, function(err, stats){
        stats.filename = filename

        if(err) {
            callback(err);
        } else {
            callback(err, stats);
        }
    })
}

friendlyStat('test1.txt', function(err, stat){ console.log(stat.filename);});
friendlyStat('test2.txt', function(err, stat){ console.log(stat.filename);}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-02T17:11:00.017

如果您负担得起，您可以使用同步`fs.statSync()`功能，这将有助于解决您的问题。

```
var filename = 'test1.txt';
var stat = fs.statSync(filename);
//code you were writing in callback comes here like the below:
console.log('Is ' + filename + ' a directory? ' + stat.isDirectory());
//Outputs 'Is test1.txt a directory? false' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-12T17:16:24.500

接受的答案效果很好，但是当我想遍历一组文件时，这是我想出的一个解决方案：

```
var files = [ 'path/to/file1.txt', 'path/to/file2.txt'],
    callback = function( filepath ) {
        return function( error, stat ) {
            console.log( filepath );
            console.log( error );
            console.log( stat )
        };
    };

    for ( var i = 0; i < files.length; i++ ) {
        fs.stat( files[ i ], callback( files[ i ] ) );
    } 
```

我们正在调用该`callback`函数并将文件名作为参数传递给它。然后该函数返回实际使用的回调函数`fs.stat`。

# c# - 单线程应用程序应该使用多少 CPU？

> ID：11659059
> 
> 赞同：0
> 
> 时间：2012-07-25T21:41:08.783
> 
> 标签：c#, cpu-usage

我有一个单线程控制台应用程序。

我对 CPU 使用率的概念感到困惑。一个好的单线程应用程序应该使用约 100% 的 cpu 使用率（因为它可用）还是不应该使用大量的 cpu 使用率（因为它会导致计算机速度变慢）？

我做了一些研究，但还没有找到解决我困惑的答案。我是一名学生，仍在学习，所以任何反馈都将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T21:59:08.730

这取决于程序需要 CPU 做什么。如果它必须做很多工作，通常会在一段时间内使用所有一个内核。如果它把大部分时间都花在等待输入上，它自然会减少使用 CPU 的频率。我说“不那么频繁”而不是“少”，因为：

在任何给定时间，单线程程序要么运行，要么不运行，因此它们总是使用一个 CPU 内核的 100% 或 0%。看起来只使用 50% 或 30% 或其他任何东西的程序实际上只是在平衡计算工作时间和等待输入时间。与 CPU 相比，硬盘驱动器等设备非常慢，因此从磁盘读取大量数据的程序将比处理大量数字的程序使用更少的 CPU 资源。

程序有时使用 100% 的 CPU 是正常的，通常甚至很长时间，但如果你不需要它（即忙循环）就使用它是不礼貌的。这种行为会排挤其他可能正在使用 CPU 的程序。

硬盘驱动器也是如此。人们忘记了硬盘也是一种有限的资源，主要是因为任务管理器没有按百分比计算硬盘使用率。与处理器不同，由于磁盘访问没有固定的速度，因此很难将硬盘驱动器的使用量占总数的百分比来衡量。但是，在磁盘上移动 1GB 数据比使用 CPU 在内存中移动 1GB 数据花费的时间要长得多，并且 HDD hogging 的性能影响与 CPU hogging 一样糟糕或更差（它们往往会变慢你的系统爬起来，看起来没有任何 CPU 使用正在发生。你可能以前见过）

您最初编写的任何小型学术程序都有可能在短时间内使用所有一个内核，然后等待。在命令提示符下提示输入数字等简单的事情是等待部分，之后对其进行任何操作和学术界的操作是活动部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T21:46:27.570

这取决于它在做什么。不同类型的操作有不同的需求。

没有非主观的方式来回答这个全面适用的问题。

唯一正确的答案是“它应该只使用完成这项工作所需的 CPU 数量，而不是更多。”

换句话说，尽可能多地优化并且合理。一般来说，CPU 越低越好，它的执行速度越快，崩溃的可能性也就越小，对用户的干扰也就越少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T21:49:16.103

通常，诸如预测天气之类的算法繁重的任务必须由操作系统管理，因为它需要所有的 cpu 运行时间与允许运行的时间一样长（直到它完成）。

另一方面，具有静态用户界面的图形应用程序，例如用于存储一些数据以进行记录保存的 Windows 窗体应用程序，应该需要非常低的 CPU 使用率，因为它主要是在等待用户做某事。

# html - H1、H2 等在 DL 中是否有效？

> ID：11659061
> 
> 赞同：2
> 
> 时间：2012-07-25T21:41:12.123
> 
> 标签：html, html-lists, html-heading

我可以在定义列表中包含标题元素吗？

例子：

```
<dl>
 <h4> heading </h4>

 <dt> title </dt> <dd> content </dd>
 <dt> title </dt> <dd> content </dd>
 <dt> title </dt> <dd> content </dd>

 <h4> heading </h4>

 <dt> title </dt> <dd> content </dd>
 <dt> title </dt> <dd> content </dd>
 <dt> title </dt> <dd> content </dd>

</dl> 
```

它似乎在我的浏览器中按预期工作:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T21:43:09.287

不; 在 a 中可能有效的*唯一*`dl`元素是`dd`和`dt`。

它可能看起来有效的原因是浏览器的错误处理，这是不可预测的，而且据我所知，大部分没有记录，因此*不*应该依赖。

有趣的是，正如 Šime Vidas 在评论中所指出的（如下），Firefox、Chrome、Safari、Opera 和 Internet Explorer 7 和 9 并没有更正结构并允许标题元素保留在`dl`. 这让我觉得很奇怪。

但是，尽管可以容忍，但它仍然无效。当然，您是否选择尊重该有效性是可选的。

参考：

*   [`dl`，在 W3.org 上](http://www.w3.org/TR/html401/struct/lists.html#edef-DL)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T21:48:02.393

FWIW，您可以在直接输入模式下使用[w3c 标记验证器](http://validator.w3.org/check)来检查代码片段。

浏览器非常容忍不良 html，并且不符合规则，即使它现在可以工作，可能意味着您的页面/布局会随着未来的浏览器更新而中断。

我添加了所需的其他元素来验证您的代码，如下所述。确切地抱怨大卫托马斯所说的。

```
 <!DOCTYPE html>
    <html>
        <head>
            <title>asdf</title>
        </head>
        <body>
            <dl>
                 <h4> heading </h4>

                 <dt> title </dt> <dd> content </dd>
                 <dt> title </dt> <dd> content </dd>
                 <dt> title </dt> <dd> content </dd>

                 <h4> heading </h4>

                 <dt> title </dt> <dd> content </dd>
                 <dt> title </dt> <dd> content </dd>
                 <dt> title </dt> <dd> content </dd>
            </dl>
        </body>
    </html>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-19T03:01:18.957

您可以添加 2 个 dt 标签，其中一个带有一个类

```
dt.heading {
  font-weight: bold
}
```

```
<dl>
  <dt class="heading">Heading</dt>
  <dt>milk</dt>
  <dd>white discharge</dd>
</dl>
```

让你有多个一个接一个，因为多个术语可以有相似的定义，如果不是相同的定义。同样，您可以有多个，因为一个术语可以有几个不同的含义。即使你正在通过 CSS 改变它的外观，这也不会是一个真正的标题，并且会被搜索引擎等跳过……也许有一个带有 seo 内容的隐藏 h1 标签

# c# - mvc4 资源路由上的 miniprofiler 返回 404

> ID：11659062
> 
> 赞同：14
> 
> 时间：2012-07-25T21:41:12.243
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, mvc-mini-profiler

我正在尝试从 nuget 和 mvc4 安装中设置 miniprofiler、miniprofiler.mvc3 和 miniprofiler.ef，目标是 .net 4.0

它注册了路由/mini-profiler-resources/{resourceName}，当我使用routedebugger时，这条路由就会出现。但是，对该路由的所有请求都以 404 形式返回。我不走运是因为我正在运行 mvc4 还是这很奇怪？

`<package id="MiniProfiler" version="2.0.2" targetFramework="net40" /> <package id="MiniProfiler.EF" version="2.0.3" targetFramework="net40" /> <package id="MiniProfiler.MVC3" version="2.0.2" targetFramework="net40" />`

来自 routedebugger（对格式感到抱歉，想象它是一张桌子！）

`All Routes Matches Current Request Url Defaults Constraints DataTokens False mini-profiler-resources/{filename} controller = MiniProfilerHandler, action = ProcessRequest controller = MiniProfilerHandler, action = ProcessRequest (null)`

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-13T03:24:57.697

以防万一您还没有解决这个问题以及其他任何人登陆这里......我有一个类似的问题（特别是/mini-profiler-resources/jquery.1.7.1.js?v=6cJT7lsVkH6SxAlFpQstk1/AgtUwMUApXN3pviVvaRE=）并找到以下相关线程，解决了我的问题。

[在 runAllManagedModulesForAllRequests 设置为 false 的情况下运行 MiniProfiler](https://stackoverflow.com/questions/10304611/running-miniprofiler-with-runallmanagedmodulesforallrequests-set-to-false)

```
<system.webServer>
...
  <handlers>
    <add name="MiniProfiler" path="mini-profiler-resources/*" verb="*" type="System.Web.Routing.UrlRoutingModule" resourceType="Unspecified" preCondition="integratedMode" />
  </handlers>
</system.webServer> 
```

# xcode - XCODE - 如何更新数组？

> ID：11659064
> 
> 赞同：0
> 
> 时间：2012-07-25T21:41:21.000
> 
> 标签：xcode, arrays, xcode4, nsmutablearray, logic

我对 Xcode/编程很陌生，并试图修改现有代码

我有一个小问题，我在某个特定时间在屏幕上有大量对象（敌人）并且无法重新定义它们的值。我将我的敌人设置为从屏幕上的 3 开始。

我的目标是根据当前分数改变敌人的数量。

我附上了下面的代码片段。

```
int numberOfEnemies;

if (self.score>=0) {
numberOfEnemies = 3
}

else if (self.score>=100) {
numberOfEnemies = 4
}

// Setup array 

enemyArray = [[NSMutableArray alloc] init];

for(int i = 0; i < numberOfEnemies; i++) {
    [enemyArray addObject:[SpriteHelpers setupAnimatedSprite:self.view numFrames:3
    withFilePrefix:@"enemyicon" withDuration:((CGFloat)(arc4random()%2)/3 + 0.5)
    ofType:@"png" withValue:0]];
}

enemyView = [enemyArray objectAtIndex:0]; 
```

当我的分数更新时，我需要做什么才能将新值解析`numberOfEnemies`到数组中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T08:32:24.553

我将把我们的谈话变成一个答案，因为我不希望它变得太冗长，我可以轻松地编辑和扩展它。

到目前为止，我们已经确定您遇到问题的原因是您在 viewDidLoad 函数中执行了上述代码，该函数在应用程序首次启动时至少会运行一次。问题在于您已经发现，您没有机会看到新分数，然后更新敌人的数量。

我知道 iOS 的游戏更新循环通常以以下结构完成，但我建议在线查找教程以获取可能更有效/正确的方法。

从您当前的结构中，我将采用您上面的代码并从中创建一个新函数：

```
-(void) updateDifficulty:(NSTimer *)gameTimer
{
    //This can be the code you have above for now
} 
```

之后，在您的 viewDidLoad 中，我将输入以下代码：

```
-(void) viewDidLoad:
{
    gameTimer = [NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(updateDifficulty:) userInfo:nil repeats:YES];
    [[NSRunLoop mainRunLoop] addTimer:gameTimer forMode:NSDefaultRunLoopMode];
} 
```

它的作用是声明一个计时器，该计时器将跟踪游戏时间，并根据它的声明方式，每 1 秒调用一次 updateDifficulty 方法。这是您想要的一般结构，但我再次强烈建议您查看 Ray Wenderlich 的游戏教程。

希望有帮助！

# selenium - 无法启动 Selenium Grid

> ID：11659066
> 
> 赞同：0
> 
> 时间：2012-07-25T21:41:23.323
> 
> 标签：selenium, selenium-grid

我刚启动硒网格集线器时遇到了麻烦。我正在使用以下命令：

java -jar selenium-server-standalone-2.25.0.jar -role hub

我收到以下消息：2012 年 7 月 25 日下午 1:26:26 org.openqa.grid.selenium.GridLauncher 主要信息：启动硒网格服务器

...但它永远不会过去，只是挂起。:4444 没有响应。

我的问题是： 1\. 这甚至是启动集线器的正确方法吗？我在互联网上看到了相互矛盾的信息，甚至 Selenium HQ 有时也已过时。2\. 有没有地方我可能会看到一些关于什么是崩溃的日志输出？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T09:43:21.280

正如 VolkerK 所说，[这](http://code.google.com/p/selenium/wiki/Grid2)是正确的做法。

非常适合我。

还有其他问题吗？

# python - python正则表达式重复组匹配

> ID：11659068
> 
> 赞同：3
> 
> 时间：2012-07-25T21:41:31.763
> 
> 标签：python, regex

> **可能重复：**
> [Python 正则表达式 - 如何从通配符表达式中捕获多个组？](https://stackoverflow.com/questions/464736/python-regular-expressions-how-to-capture-multiple-groups-from-a-wildcard-expr)

我无法访问以下正则表达式中第 3 或第 5 个元素的组：

```
>>> x = 'f 167 2958 335 3103 0'
>>> re.search('.(\s\d+){5}', x).group()
'f 167 2958 335 3103 0'
>>> re.search('.(\s\d+){5}', x).group(1)
' 0'
>>> # how do i access no 2958 and 3103 
```

我知道我可以通过 pattern = '.\s\d+\s(\d+)\s\d+\s(\d+)\s\d+' 实现上述目标，但这很蹩脚。

谢谢，阿米特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T21:49:33.040

你可以用`re.findall`这个。

```
result = re.findall('\s\d+', x)

print result[1]  # 2958
print result[3]  # 3103 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:43:29.670

如果这是一个一般性问题，那么`findall`是您最好的选择。

如果这是您要尝试做的实际事情，那`split`将更有意义：

```
>>> x = 'f 167 2958 335 3103 0'
>>> l = x.split()
>>> l[2]
'2958'
>>> l[4]
'3103' 
```

# python - 使用 django 光标保存转义字符时出错

> ID：11659074
> 
> 赞同：0
> 
> 时间：2012-07-25T21:42:01.437
> 
> 标签：python, mysql, django, cursor

我有一个 url，我想使用 django 提供的“光标”工具将其保存到 MySQL 数据库中，但我不断收到“格式字符串的参数不足”错误，因为这个 url 包含一些转义字符（非 ascii 字符） . 测试代码相当短：

# 测试.py

```
import os 
import runconfig #configuration file 
os.environ['DJANGO_SETTINGS_MODULE'] = runconfig.django_settings_module 
from django.db import connection,transaction 
c = connection.cursor() 
url = "http://www.academicjournals.org/ijps/PDF/pdf2011/18mar/G%C3%B3mez-Berb%C3%ADs et al.pdf"

dbquery = "INSERT INTO main_crawl_document SET url="+url 
c.execute(dbquery) 
transaction.commit_unless_managed() 
```

完整的错误信息是

```
Traceback (most recent call last):
  File "./test.py", line 14, in <module>
    c.execute(dbquery)
  File "/usr/local/lib/python2.6/site-packages/django/db/backends/util.py", line 38, in execute
    sql = self.db.ops.last_executed_query(self.cursor, sql, params)
  File "/usr/local/lib/python2.6/site-packages/django/db/backends/__init__.py", line 505, in last_executed_query
    return smart_unicode(sql) % u_params
TypeError: not enough arguments for format string 
```

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:45:54.340

您正在为可能的 SQL 注入敞开心扉。相反，请正确使用 c.execute() ：

```
url = "http://www.academicjournals.org/ijps/PDF/pdf2011/18mar/G%C3%B3mez-Berb%C3%ADs et al.pdf"
dbquery = "INSERT INTO main_crawl_document SET url=?" 
c.execute(dbquery, (url,)) 
transaction.commit_unless_managed() 
```

该`.execute`方法应该接受一个可迭代的参数以用于转义，假设它是普通的 dbapi 方法（它应该与 Django 一起使用）。

# c# - 使用 String.Format() 格式化字符串日期

> ID：11659077
> 
> 赞同：1
> 
> 时间：2012-07-25T21:42:13.330
> 
> 标签：c#, string, datetime

只是好奇......所以我知道如果我将日期的字符串版本转换为 DateTime 对象并将其传递给 String.Format() 方法，那么我将得到所需的结果。

```
String.Format("The date is {0:MMMM dd, yyyy}", DateTime.Parse("05-22-2012")); 
```

“日期是 2012 年 5 月 22 日”

但为什么这不起作用？

```
String.Format("The date is {0:MMMM dd, yyyy}", "05-22-2012") 
```

“日期是 2012 年 5 月 22 日”

对不起，如果这是一个愚蠢的问题，但我只是想了解它是如何工作的。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:30:32.800

这里的其他答案很重要，但让我们把它们放在一起来看看是如何`String.Format`工作的。

它有五个重载，但我们只讨论它们都重定向到的一个（这不是实际代码，如果您想使用 Reflector 或 ILSpy 来查看它，您可以在 参考资料中找到它`StringBuilder.AppendFormat`）。为了便于理解，这被简化了。

```
public static string Format(IFormatProvider provider, string format, params object[] args)
{
    StringBuilder sb = new StringBuilder();

    // Break up the format string into an array of tokens
    Token[] tokens = ParseFormatString(format);

    foreach (Token token in tokens)
    {
        switch (token.TokenType)
        {
            // A Text token is just some text to output directly
            case TokenType.Text:
                sb.Append(token.Text);
                break;

            // An Index token represents something like {0} or {2:format}
            //  token.Index is the argument index
            //  token.FormatText is the format string inside ('' in the first example, 'format' in the second example)
            case TokenType.Index:
                {
                    object arg = args[token.Index];

                    IFormattable formattable = arg as IFormattable;
                    if (formattable != null && token.FormatText.Length > 0)
                    {
                        // If the argument is IFormattable we pass it the format string specified with the index
                        sb.Append(formattable.ToString(token.FormatText, provider));
                    }
                    else
                    {
                        // Otherwise we just use Object.ToString
                        sb.Append(arg.ToString());
                    }
                }
                break;
        }
    }

    return sb.ToString();
} 
```

在您的问题中，您问为什么当您传递“05-22-2012”时格式字符串不被应用。正如 Guffa 所说，那不是 DateTime 对象，而是 String 对象。

正如 GSerjo 所说，字符串不是 IFormattable。字符串不可格式化，因为格式化是将某些内容转换为字符串的过程。字符串已经是字符串了！

所以你可以看到，当 Format 方法到达索引器时，`arg`它不会是 IFormattable，它只会调用`ToString`. 对字符串调用 ToString 只会返回自身，它已经是一个字符串。

总之，如果您的格式字符串包含带有内部格式字符串的索引（例如 {0:format}），则该内部格式字符串仅在关联的参数是`IFormattable`并且它知道如何处理您的格式字符串时应用给它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T21:45:33.843

自定义日期时间格式仅适用于`DateTime`值。如果您使用的是字符串，则格式将被忽略，因为只有一种方法可以输出字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T21:51:29.150

因为**“05-22-2012”**不是`IFormattable`，`DateTime.Parse("05-22-2012")`它是`DateTime`

请在此处查看更多示例

*   [日期时间的字符串格式](http://www.csharp-examples.net/string-format-datetime/)
*   [自定义日期和时间格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

# ios - iOS/iCal 通过 ICS 文件中的重复事件在夏令时切换时间

> ID：11659081
> 
> 赞同：0
> 
> 时间：2012-07-25T21:42:31.763
> 
> 标签：ios, icalendar, dst

我有一个使用 UTC 设置的事件，它在夏令时重复出现。夏令时切换后，时间移动一个小时。UTC 不使用 DST，因此时间应该保持不变。我可以在 DST 之后添加一个具有完全相同的 UTC 时间值的事件，并且日历显示正确的时间。我已经在下面发布了我的 ICS 文件，其中包含重复事件和之后发生的事件。有没有人遇到过这个？任何建议的修复或更改？

["BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//sethhill v1.0//NONSGML //EN\nCALSCALE:GREGORIAN\nMETHOD:PUBLISH\nBEGIN:VEVENT\nDTSTAMP:20120725T222602Z\nDTSTART:20120724T180000Z\nDTEND:20012072 nRRULE:FREQ=WEEKLY;UNTIL=20130707T180000Z\n摘要：第 4 类 - NODST\nBEGIN:VALARM\nTRIGGER:-PT45M\nACTION:DISPLAY\nDESCRIPTION:NODST\nEND:VALARM\nEND:VEVENT\nBEGIN:VEVENT\nDTSTAMP:20120725T222602Z\ nDTSTART:20121120T190000Z\nDTEND:20121120T193000Z\nRRULE:FREQ=WEEKLY;UNTIL=20130707T180000Z\n摘要:第 4 类 - TEST1DST\nBEGIN:VALARM\nTRIGGER:-PT45M\nACTION:DISPLAY\nEND:VALARM:nENDTEST1EVST nEND:VCALENDAR"]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:46:08.397

我对 DST 和 UTC 的工作方式有误。我在想，设置 UTC 时间意味着日历会将其读取为设置时间并自动显示正确的本地时间。如果其他人有点困惑，可以这样想：MST 是 UTC-07:00 MDT (DST) 是 UTC-06:00。如果您有一个设置为全年重复的日历事件并且它是 18:00 UTC，它将在 MDT 下午 12:00 或 MST 上午 11:00。对于 ICS 文件，您可以定义 STANDARD 时区和 DAYLIGHT 时区，或者将事件分成多个部分，每个部分使用正确的 UTC 时间。

我希望这可以为其他人解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T06:07:14.660

```
public static DateTime GetDSTStart(int year, TimeZoneInfo timeZone)
        {
            DateTime finder = new DateTime(year,3,8);
            finder = finder.AddHours(6);
            for (int i = 0; i < 7; i++)
            {
                if(timeZone.IsDaylightSavingTime(finder.AddDays(i))){
                    return (finder.AddDays(i).AddHours(-6));
                }
            }
            finder = DateTime.MinValue;
            return finder;
        }

public static DateTime GetDSTEnd(int year, TimeZoneInfo timeZone)
        {
            DateTime finder = new DateTime(year, 11, 1);
            finder = finder.AddHours(6);
            for (int i = 0; i < 7; i++)
            {
                if (!timeZone.IsDaylightSavingTime(finder.AddDays(i)))
                {
                    return (finder.AddDays(i).AddHours(-6));
                }
            }
            finder = DateTime.MinValue;
            return finder;
        } 
```

# ruby-on-rails - 在 Rails 中的资产管道中渲染部分

> ID：11659082
> 
> 赞同：1
> 
> 时间：2012-07-25T21:42:40.403
> 
> 标签：ruby-on-rails, ruby, asset-pipeline

有谁知道如何在 rails 的资产文件中渲染部分（或至少包含另一个文件）？我有一个模板/文件夹设置（其中包含静态 HTML 文件），这些文件中有一些我想在其他模板文件之间抽象和共享的点点滴滴。

该`render`方法不适用于任何资产管道文件。我确定我可以通过找到正确的模块以某种方式包含它，但我不确定这是否可行，因为渲染模块本身可能依赖于其他模块、方法、变量。

关于如何做到这一点的任何想法？或者如果可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T16:22:49.737

我想出了我自己的解决方案。

您在 lib 文件夹中创建一个帮助文件并调用它`assets_helper.rb`。asset_helper 中的代码如下：

```
def partial(name, args = {}, dir = 'app/assets/templates')
  require 'ostruct'
  namespace = OpenStruct.new(args)
  name += '.html'
  [name + '.erb', name].each do |n|
    n = File.join(dir, n)
    next unless File.exist?(n) 
    tpl = ERB.new(File.new(n).read)
    compiled = tpl.result(namespace.instance_eval { binding })
    return compiled
  end
end 
```

然后将该文件包含在您希望使用它的每个资产文件的顶部。在文件内部，您可以像这样使用部分命令。

```
<% require './lib/asset_helper.rb' %>

<!--- some HTML template --->
<%= partial('page/_partial', :var1 => true, :var2 => false) %>
<---- some other page ---> 
```

这行得通。但唯一的问题是 Rails 3.1 将缓存资产文件夹中的任何内容。**因此，如果您编辑部分内容，您将需要更新它所在的根文件，以便为该文件清除缓存**。

# dbix-class - DBIx::Class 结果集在没有选择的情况下创建相关数据

> ID：11659083
> 
> 赞同：1
> 
> 时间：2012-07-25T21:42:49.487
> 
> 标签：dbix-class, perl

我正在尝试做类似的事情：

```
$schema->resultset('Foo')->create({ Property => 1,
                                       Bar => { 
                                                Property => 'non-unique',
                                             },
                                      }); 
```

其中 Bar 是与另一个表 Bar 的 belongs_to 关系，具有自动递增的主键。

问题是，在幕后，dbix 总是在进行选择并在 Bar 中查找 Property = 'non-unique' 的现有行，并将该行的 PK 插入到 Foo 中。我希望它做的是每次使用新的自动生成的主键在 Bar 中创建一个新行。

有没有办法告诉 DBIx 不要先搜索匹配的相关行，而是强制它始终创建相关行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:43:17.770

[create_related()](http://search.cpan.org/dist/DBIx-Class/lib/DBIx/Class/Relationship/Base.pm#create_related) 或 new_reated() 后者创建相关对象，前者创建对象并将其保存在 DB 中。

所以，给定一个名为“bars”的 Foo->Bar 关系，更像：

```
 $foo = $schema->resultset('Foo')->create({ Property => 1 });
 $bardata = {Property => 'non-unique'};                            
 $foo->create_related('bars', $bardata); 
```

# jquery - jQuery 将 DOM 元素分配给对象

> ID：11659085
> 
> 赞同：0
> 
> 时间：2012-07-25T21:43:04.540
> 
> 标签：jquery, object

在给定的场景中，我如何将 DOM 对象分配给变量并调用它？在这个例子中，我试图获得“导航”元素的高度。现在它没有返回任何值，我认为这是因为在文档准备好之前调用了元素。

```
$(document).ready( function(){ 
    gbe.init();
});

var gbe = {

    navigation  : $("nav"),

    init    :   function() {
        gbe.nav.init();
    },

    nav     :   {

        init : function() {
            navHeight : gbe.navigation.height(); 
            console.log(gbe.nav.init.navHeight, gbe.navigation.height());
        }
    }

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:44:51.857

如果你这样做了怎么办：

```
$(document).ready( function(){ 
  gbe.navigation = $("nav");
  gbe.init();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:31:52.527

恕我直言，您应该通过 jQuery 将元素传递给 init 函数，并将其传递给 .ready() ，如下所示：

```
$(document).ready( function(){ 
    gbe.init($("nav"));
});

var gbe = {    

    init    :   function(el) {
        gbe.navigation : el,
        gbe.nav.init();
    },

    nav     :   {

        init : function() {
            navHeight : gbe.navigation.height(); 
            console.log(gbe.nav.init.navHeight, gbe.navigation.height());
        }
    }

}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T21:48:11.627

尝试将您的 $(document).ready 放在 gbe 的定义之下。只有你的 console.log 语句中的第二个条目会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T21:52:48.363

```
​$(document).ready(function() {
    var $nav = $("nav");
    var height = $nav.height();
    console.log(height);
});​ 
```

您是否正在尝试揭示模块模式？上面的代码是快速而肮脏的方式。

小提琴：http : [//jsfiddle.net/jhZSG/](http://jsfiddle.net/jhZSG/)

# android - 动作条 / 动作条 Sherlock 的奇怪错误，某种第二个阴影条

> ID：11659086
> 
> 赞同：1
> 
> 时间：2012-07-25T21:43:06.050
> 
> 标签：android, android-actionbar, actionbarsherlock

我似乎无法摆脱第二个栏，如下所示：http: [//i.imgur.com/RfR2J.png](http://i.imgur.com/RfR2J.png) （无法发布图片）

在横向视图中或在我的 10 英寸平板电脑上纵向视图时不显示。

我尝试了以下修复：

```
 android:uiOptions="none" 
```

在我的清单中

这是我的项目的代码：

```
 <item android:id="@+id/profile"     
    android:title="User Profile"
    android:layout_gravity="left"
    android:showAsAction="ifRoom|withText" ></item> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T21:56:43.093

第二个栏看起来像 Tab 操作栏，请尝试将其放在`getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);`代码中的某个位置（`onCreate()`例如`onStart()`）。

还要确保您安装了最新版本的 ActionBarSherlock。

# web2py - Web2py 应用程序版本控制

> ID：11659094
> 
> 赞同：1
> 
> 时间：2012-07-25T21:43:35.987
> 
> 标签：web2py

我想知道如何设置 Windows 环境来对 Web2py 应用程序进行版本控制

我有不止一个开发人员只在一个 web2py 应用程序中工作，但最大的问题是对代码的更改控制。

实际上，我们让每台 PC 都运行自己的 Web2py 服务器......

有人正在使用相同的设置吗？

有没有一种好方法可以将所有更改带到一个合并版本中？

提前致谢。

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:59:42.213

你在使用版本控制系统吗？这正是你所需要的。我不太喜欢在 Windows 上开发，但我认为 TortiseSVN 是 SVN（颠覆）的流行 GUI 界面，SVN 是更流行的修订控制系统之一。

基本上，您将拥有一个中央存储库，其中包含所有代码和您所做的所有更改。您可以回滚到任何版本，并且可以将来自不同开发人员的不同编辑组合到一个主代码库中。然后，如果需要，您可以让不同的 web2py 服务器签出不同的版本。

您必须弄清楚如何自行安装和设置存储库，但这应该让您开始：

TortiseSVN（客户端）：[http](http://tortoisesvn.tigris.org/) ://tortoisesvn.tigris.org/ <- 这允许您签入和签出代码 VisualSVN（服务器）： http: [//www.visualsvn.com/server/](http://www.visualsvn.com/server/) <- 这包含所有编码

# javascript - 使用 PEG.js 解析缩进级别

> ID：11659095
> 
> 赞同：10
> 
> 时间：2012-07-25T21:43:36.503
> 
> 标签：javascript, parsing, syntax, peg

[对于 Python 风格的缩进](https://stackoverflow.com/questions/4205442/peg-for-python-style-indentation)，我有与 PEG 基本相同的问题，但我想获得更多关于[这个答案](https://stackoverflow.com/a/10708913/711902)的方向。

答案成功生成了一个字符串数组，这些字符串是每行输入，行之间有“INDENT”和“DEDENT”。似乎他几乎使用 PEG.js 来标记化，但没有发生真正的解析。

那么我怎样才能扩展他的例子来做一些实际的解析呢？

例如，如何更改此语法：

```
start = obj
obj = id:id children:(indent obj* outdent)?
    {
        if (children) {
            let o = {}; o[id] = children[1];
            return o;
        } else {
            return id;
        }
    }
id = [a-z]
indent = '{'
outdent = '}' 
```

使用缩进而不是大括号来描绘块，并且仍然获得相同的输出？

（使用[http://pegjs.majda.cz/online](http://pegjs.majda.cz/online)通过以下输入测试该语法`a{bcd{zyx{}}}`：）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-28T11:16:18.213

解析器：

```
// do not use result cache, nor line and column tracking

{ var indentStack = [], indent = ""; }

start
  = INDENT? l:line
    { return l; }

line
  = SAMEDENT line:(!EOL c:. { return c; })+ EOL?
    children:( INDENT c:line* DEDENT { return c; })?
    { var o = {}; o[line] = children; return children ? o : line.join(""); }

EOL
  = "\r\n" / "\n" / "\r"

SAMEDENT
  = i:[ \t]* &{ return i.join("") === indent; }

INDENT
  = &(i:[ \t]+ &{ return i.length > indent.length; }
      { indentStack.push(indent); indent = i.join(""); pos = offset; })

DEDENT
  = { indent = indentStack.pop(); } 
```

输入：

```
a
  b
  c
  d
    z
    y
    x 
```

输出：

```
{
   "a": [
      "b",
      "c",
      {
         "d": [
            "z",
            "y",
            "x"
         ]
      }
   ]
} 
```

它无法解析空对象（last `x`），但是应该很容易解决。这里的技巧是`SAMEDENT`规则，当缩进级别没有改变时它会成功。`INDENT`并`DEDENT`更改当前缩进级别而不更改文本中的位置`pos = offset`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-07T20:54:50.147

# 2021 年更新

这是一个在[Peggy.js的](https://github.com/peggyjs/peggy)[在线游乐场](https://peggyjs.org/online.html)中运行的工作示例。Peggy.js 是积极开发中的 PEG.js 的一个分支。PEG.js 已被 David Maida 终止。

该示例显示了如何解析和规则`INDENT`，以及如何使用解析位置。检查控制台日志。`SAMEDENT``DEDENT`

它使用这些语法，其他解析器生成器可能不知道这些语法：

（文件顶部）

*   `{{...}}`（全局初始化程序）–`...`在解析器生成时运行。
*   `{...}`(Per-parse initializer) –`...`在解析器实例化时运行。

（在文件中）

*   `X = Y {...}`(action) –成功`...`时执行`Y`。初始化程序中的变量可用。如果`...`返回一些东西，它将取代返回的东西`Y`。
*   `$X`– 返回用 解析的文本`X`，而不是其结果。
*   `... @X ...`(pluck 运算符) – 将 的结果替换为`... X ...` 的结果`X`。
*   `&{...}`（谓词）——“而且`...`也必须是真的”。
*   `X = &(...)`– 如果`...`成功，则`X`成功。`...`不消耗任何输入。

有关更多信息，请参阅[文档](https://peggyjs.org/documentation.html#grammar-syntax-and-semantics-parsing-expression-types)。

```
{{
    console.clear()
    console.log('Parser generated')
}}

{
    let indentstack = []
    let indent = ''
    function found (what) {
        let loc = location()
        console.log(`[${loc.start.line}:${loc.start.column} - ${loc.end.line}:${loc.end.column}] found ${what}`)
    }
    console.log('Parser instantiated')
}

DOCUMENT = NEWLINES? @THINGS NEWLINES? _

THINGS = ( SAMEDENT @( OBJECT / LINE ) )*

OBJECT = key:KEY childs:(BLOCK / INLINE) {
    found(`object "${key}"`)
    let o = {}
    o[key] = childs
    return o
}

KEY = @$( [^ \t\r\n:]+ ) _ ':' _

BLOCK = NEWLINES INDENT @THINGS DEDENT

INLINE = line:LINE { return [line] }

LINE = text:$( (!EOL .)+ ) NEWLINES? {
    found(`line "${text}"`)
    return text
}

INDENT = &(
    spaces:$( [ \t]+ ) &{
        return spaces.length > indent.length
    } {
        indentstack.push(indent)
        indent = spaces
    }
) {
    found('indent')
}

SAMEDENT = spaces:$( [ \t]* ) &{
    return spaces === indent
} {
    found('samedent')
}

/* Because of this rule, results cache must be disabled */
DEDENT = &{
    indent = indentstack.pop()
    return true
} {
    found('dedent')
}

_ = [ \t]*
EOL = '\r\n' / '\n' / '\r'
NEWLINES = (_ EOL)+

/* Test with this input

H:
  a
  b
  c
  G:
    d
    e
    f

*/ 
```

* * *

# 旧答案

这是在 PEG.js v 0.10.0 中工作的@Jakub Kulhan 语法的修复。最后一行需要更改为，`= &{ indent = indentStack.pop(); return true;}`因为 PEG.js 现在不再允许`{...}`语法中的独立操作 ()。这行现在是一个谓词 ( `&{...}`)，它总是成功 ( `return true;`)。

我也删除了，`pos = offset;`因为它给出了一个错误`offset is not defined`。可能 Jakub 指的是旧版本 PEG.js 中可用的一些全局变量。PEG.js 现在提供了`location()`返回包含偏移量和其他信息的对象的函数。

```
// do not use result cache, nor line and column tracking

{ var indentStack = [], indent = ""; }

start
  = INDENT? l:line
    { return l; }

line
  = SAMEDENT line:(!EOL c:. { return c; })+ EOL?
    children:( INDENT c:line* DEDENT { return c; })?
    { var o = {}; o[line] = children; return children ? o : line.join(""); }

EOL
  = "\r\n" / "\n" / "\r"

SAMEDENT
  = i:[ \t]* &{ return i.join("") === indent; }

INDENT
  = &(i:[ \t]+ &{ return i.length > indent.length; }
      { indentStack.push(indent); indent = i.join(""); })

DEDENT
  = &{ indent = indentStack.pop(); return true;} 
```

从 v 0.11.0 开始，PEG.js 还支持[Value Plucking 运算符](https://github.com/pegjs/pegjs/blob/master/docs/grammar/parsing-expression-types.md#expression1-expression2---expressionn-1)，`@`这将允许更简单地编写此语法，但由于它目前不在在线解析器中，我将避免将其添加到此示例中。

# java - JMapViewer OSM 地图无法拖动

> ID：11659097
> 
> 赞同：3
> 
> 时间：2012-07-25T21:43:38.553
> 
> 标签：java, swing, openstreetmap, jmapviewer

我试图找出哪些映射工具最适合我的基于 java swing 的 OSM 映射。[早些时候，我在MapPanel](http://mappanel.svn.sourceforge.net/viewvc/mappanel/com.roots.map/src/com/roots/map/MapPanel.java?revision=37&view=markup)的基础上制作了一张功能地图。后来我几乎可以克隆应用程序，只需将 MapPanel 替换为[JMapViewer 即可](http://www.koders.com/java/fidC94F88CBDBF7178364503105DBA9941391242FC3.aspx?s=TileMap)使其正常工作。我更喜欢后者，因为它具有在地图上放置标记和多边形的功能。然而，缺点是由于某种原因我不能用鼠标拖动地图。在 JMapViewer 的包中有一个 Demo 类，它显示相同的行为。如何在 JMapViewer 中使 OSM 地图可拖动？

编辑：此代码将绘制一个可以在面板中显示的地图，并通过添加*和*使地图可拖动。`mapController``setMovementMouseButton()`

```
private JMapViewer drawOpenStreetMap(double lon, double lat, int zoom) {
    mapViewer = new JMapViewer();
    mapViewer.setZoom(zoom);
    mapViewer.setDisplayPositionByLatLon(lat, lon, zoom);
    mapViewer.repaint();
    DefaultMapController mapController = new DefaultMapController(mapViewer);
    mapController.setMovementMouseButton(MouseEvent.BUTTON1);
    mapViewer.addMapMarker(new MapMarkerDot(52, 5.5));
    return mapViewer;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T23:41:32.577

运行`Demo.java`时，按住 Control 单击或右键单击地图以平移视图。用于`setMovementMouseButton()`控制行为。

# django - 为什么 uWSGI 使用的内存比 Apache 多？

> ID：11659102
> 
> 赞同：3
> 
> 时间：2012-07-25T21:43:52.210
> 
> 标签：django, nginx, uwsgi

我决定为我的 Django 应用程序尝试 NGINX/uWSGI 而不是 Apache/mod_wsgi。我尝试这样做的原因是我听说 NGINX/uWSGI 使用更少的内存，在高流量情况下表现更好，而且 NGINX 非常适合提供静态内容。

但是我发现 uWSGI 使用的 RAM 几乎是 Apache 的 5 倍。

```
ubuntu@domU-12-31-39-0A-9C-1A:~$ sudo ps_mem.py
 Private  +   Shared  =  RAM used       Program

184.0 KiB +  31.5 KiB = 215.5 KiB       atd
220.0 KiB +  94.0 KiB = 314.0 KiB       upstart-socket-bridge
260.0 KiB + 101.0 KiB = 361.0 KiB       upstart-udev-bridge
340.0 KiB +  63.0 KiB = 403.0 KiB       cron
392.0 KiB +  82.0 KiB = 474.0 KiB       sudo
560.0 KiB +  14.0 KiB = 574.0 KiB       dhclient3
612.0 KiB + 189.0 KiB = 801.0 KiB       getty (6)
816.0 KiB +  35.5 KiB = 851.5 KiB       dbus-daemon
660.0 KiB + 359.0 KiB =   1.0 MiB       udevd (3)
960.0 KiB +  74.0 KiB =   1.0 MiB       rsyslogd
  1.1 MiB +  38.5 KiB =   1.2 MiB       redis-server
  1.1 MiB + 146.5 KiB =   1.2 MiB       init
  1.7 MiB +   1.1 MiB =   2.9 MiB       nginx (3)
  1.3 MiB +   1.8 MiB =   3.1 MiB       sshd (3)
  7.5 MiB +  69.5 KiB =   7.6 MiB       bash
 14.4 MiB +   5.7 MiB =  20.1 MiB       apache2 (6)
 23.6 MiB + 113.0 KiB =  23.7 MiB       mysqld
 95.5 MiB +   8.6 MiB = 104.1 MiB       uwsgi (7)
---------------------------------
                        169.7 MiB
================================= 
```

这是预期的吗？

我是否可能配置错误？（master=true，4 名工人）

您是否仅在服务器处于压力下时才看到好处？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T00:47:07.443

这一切都归结为配置。因为大部分内存来自胖 Python Web 应用程序，实际底层 WSGI 服务器内存使用通常贡献很小。

你应该去看我的 PyCon 演讲，我在其中讨论了这个特定的问题，以及人们是如何被不同 WSGI 服务器解决方案使用的默认值所欺骗的。

[http://lanyrd.com/2012/pycon/spcdg/](http://lanyrd.com/2012/pycon/spcdg/)

简而言之，Apache/mod_wsgi 将使用更多内存是一个错误的说法。以与其他解决方案类似的方式对其进行配置，并且它将为相同的 Python Web 应用程序使用类似的内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T16:49:05.723

将下一条规则添加到项目 uWSGI .ini

以 MB为单位[限制每个进程的内存](http://projects.unbit.it/uwsgi/wiki/Doc#limit-as)

```
limit-as=128 
```

[最大请求数](http://projects.unbit.it/uwsgi/wiki/Doc#max-requests)：达到 5k 个请求时回收进程

```
max-requests=5000 
```

# objective-c - 遵循 Apple 的“您的第一个 Mac 应用程序”教程时的语义问题“属性实现必须在接口中声明”

> ID：11659105
> 
> 赞同：0
> 
> 时间：2012-07-25T21:44:13.307
> 
> 标签：objective-c

我一直在使用 Xcode 4.4 (4F250)关注[Apple 的“Your First Mac App”教程。](https://developer.apple.com/library/mac/referencelibrary/GettingStarted/RoadMapOSX/books/RM_YourFirstApp_Mac/Articles/Introduction.html)

[为滑块创建出口](https://developer.apple.com/library/mac/referencelibrary/GettingStarted/RoadMapOSX/books/RM_YourFirstApp_Mac/Articles/ConfiguringtheWindow.html#//apple_ref/doc/uid/TP40012262-TP40012101-CH3-SW5)后，我无法再编译应用程序。存在语义问题：“属性实现必须在接口中声明。”</p>

Stack Overflow 上的类似问题似乎是由错误或缺失的`@property`声明引起的。但是，我对本教程进行了双重和三重检查。声明内容如下：

```
@property (weak) IBOutlet NSSlider *slider; 
```

我会很感激任何帮助，因为我完全被卡住了。我相信我一直在严格按照教程进行操作，但是出现了问题。这不是一个好的开始方式。：-/

如果它很重要，这里是头文件和实现的完整代码。

*AppDelegate.h*

```
#import <Cocoa/Cocoa.h>

@interface AppDelegate : NSObject <NSApplicationDelegate>

@property (assign) IBOutlet NSWindow *window;
@property (weak) IBOutlet NSSlider *slider;

- (IBAction)mute:(id)sender;
- (IBAction)takeFloatValueforVolumeFrom:(id)sender;

@end 
```

*AppDelegate.m*

```
#import "AppDelegate.h"

@implementation AppDelegate

@synthesize slider;

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
}

- (IBAction)mute:(id)sender {
}

- (IBAction)takeFloatValueforVolumeFrom:(id)sender {
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T22:08:34.643

看来我的问题只是 Xcode 的一些小问题。今天，我做了同样的事情，一切都解决了。

感谢所有试图帮助我的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:58:23.253

您的评论对我说，您没有将滑块属性与 xib 文件正确链接。您需要在正确的旁边有一个圆圈而不是感叹号。以我的经验，这通常会导致运行时错误......所以我不是 100% 肯定这会解决你的编译问题。

# regex - 正则表达式 - 从 Google 分析脚本中提取跟踪 ID

> ID：11659106
> 
> 赞同：0
> 
> 时间：2012-07-25T21:44:19.257
> 
> 标签：regex

我正在尝试使用正则表达式从以下 Google Analytic 中提取 UA-123456-7。我想我太接近了，但我不确定这是否可能。

```
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-123456-7");
pageTracker._trackPageview();
</script> 
```

这是我在[www.regular-expressions.info运行时得到的结果](http://www.regular-expressions.info/javascriptexample.html)

正则表达式：`^[<>%\w_\/.:;()\+-=?"]*(.*?)[<>\w_.;()]*$`

替换文字：`$1`

结果： `gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));var pageTracker = _gat._getTracker("UA-140422-1"`

有人可以阐明一下吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T21:52:15.103

为什么不使用子字符串？

查找字符串 "_getTracker(" -> Pos A 的位置

字符串 ")" 相同 -> Pos B

以及 Pos A 和 Pos B 之间的子串。

这有帮助吗？

# file - 我正在使用带有自定义文件夹的 mongodb 来保存数据，但该数据未与 github 同步，因为文件没有更改

> ID：11659110
> 
> 赞同：1
> 
> 时间：2012-07-25T21:44:39.363
> 
> 标签：file, github, mongodb

我使用 github 对我的文件进行版本控制，我也想对我的数据库进行版本控制，在这种情况下仅用于测试目的。

但是mongodb创建的数据库文件没有改变，文件更改数据是几周前的：s因此github有旧数据..

我真的不明白为什么如果我要更改数据库中的某些数据，mongodb 不会保存到文件中……或者至少文件必须以某种方式更改……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:07:04.490

MongoDB[预先分配数据文件](http://www.mongodb.org/display/DOCS/Excessive+Disk+Space#ExcessiveDiskSpace-DatafilePreallocation)，然后逐渐填充。也许这就是为什么没有正确获取更改的原因。

顺便说一句，在对 MongoDB 数据库进行版本控制的所有可能方法中，我不确定将 datadir 本身保存在 Git 存储库中是最好的方法。

替代方案：运行`mongodump`将导致`BSON`您的数据库或集合的 -dump，而运行`mongoexport`将导致`JSON`or `CSV`。两者都可以用`mongorestore`and读回`mongoimport`，请参阅[文档](http://www.mongodb.org/display/DOCS/Import+Export+Tools)。

然后可以使用您喜欢的工具对这些转储进行版本控制。就个人而言，在使用 Git 时，我会对 JSON 转储进行版本控制，例如

```
mongoexport --db mydatabase --collection mycollection > mycollection.json 
```

将生成一个 JSON 文件，其中包含所选集合的内容（如果需要，您可以转储整个数据库）。

额外的东西，如果你附加`--csv`and `--fields fieldname1,fieldname2`，你可以转储一个漂亮的 CSV 文件，用另一个程序读入。

# image - 使用 Henon 方程的图像加密

> ID：11659115
> 
> 赞同：0
> 
> 时间：2012-07-25T21:45:01.803
> 
> 标签：image, encryption, pixel

我想使用 henon 方程加密像素值：

Xi+2 = 1 - a*(Xi+1)*(Xi+1) + bXi （抱歉我不能发图）

> 其中 a=1.4, b=0.3, x0=0.01, x1=0.02,

使用此代码：

> k[i+2] =1-a*(Math.pow(k[i+1], 2))+b*k[i]

我可以从 henon 方程中得到随机值

> 1.00244, -0.40084033504000005, 1.0757898361270288, -0.7405053806319072, 0.5550494445953806, 0.3465365454865311, 0.99839222507778, -0.2915408854881054, 1.1805231444476698, -1.038551118053691, -0.15586685140049938, 0.6544223990721852,

. 之后我四舍五入随机值

使用此代码：

> inter[i]= (int) Math.round((k[i]*65536)%256)

我可以通过 XOR 与随机值（henon）加密像素值。

我的问题 ：

henon 有一些负随机值，因为我们知道没有负像素值。

> 那么我可以跳过负随机值（只保存正随机值）来加密原始像素值吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:14:55.527

您正在使用[Hénon 序列](http://en.wikipedia.org/wiki/H%C3%A9non_map)作为伪随机数的来源，对吗？

那么你当然可以选择丢弃负数（或者取绝对值，或者做一些其他花哨的事情）——只要你在加密和解密中做同样的事情。如果有规范，最好明确说明这一点。

也许您正在使用 Javascript 或其他`%`不是*模数*而是*余数*的语言。如果是这样，请参阅[此答案](https://stackoverflow.com/a/4467559/1307866)

* * *

另外三点需要注意：

*   仔细检查您是否正确。在我看来，您的计算应该是`k[i+1] =1-a*(Math.pow(k[i], 2))+b*k[i]`，因为[Hénon 序列](http://en.wikipedia.org/wiki/H%C3%A9non_map)只使用最后一个值。`
*   你真的需要存储过去的*k*值吗？如果没有，那么只需使用

    k =1-a*(Math.pow(k, 2))+b*k

甚至更好

```
k = 1 + k * (b - a *k) 
```

*   （剧透警告：这可能是练习的教学要点。）Hénon 序列是混乱的，浮点错误迟早会影响随机数。所以你的随机数生成器可能不像你想象的那么确定。

# eclipse - Eclipse 在 Mountain Lion 上运行良好？

> ID：11659116
> 
> 赞同：4
> 
> 时间：2012-07-25T21:45:03.890
> 
> 标签：eclipse, osx-lion

简单的问题。有没有人在 Mountain Lion 上运行 Eclipse 时遇到问题。更具体地说，我使用的是 Helios Service Release 2 和 Pydev。如果这会破坏，不想升级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:48:09.153

除了偶尔损坏的工作区之外，我在山狮上运行 eclipse 没有任何问题，但这通常发生在所有平台上的 eclipse 上。

# php - 解析 .srt 文件

> ID：11659118
> 
> 赞同：4
> 
> 时间：2012-07-25T21:45:10.583
> 
> 标签：php, parsing, srt

```
1
00:00:00,074 --> 00:00:02,564
Previously on Breaking Bad...

2
00:00:02,663 --> 00:00:04,393
Words... 
```

我需要用 php 解析 srt 文件并用变量打印文件中的所有子文件。

我找不到正确的 reg exp。这样做时，我需要获取 id、时间和字幕变量。并且在打印时不能没有 array() 等，必须与原始文件中的打印相同。

我的意思是我必须像这样打印；

```
$number <br> (e.g. 1)
$time <br> (e.g. 00:00:00,074 --> 00:00:02,564)
$subtitle <br> (e.g. Previously on Breaking Bad...) 
```

顺便说一句，我有这个代码。但它没有看到线条。它必须被编辑，但如何？

```
$srt_file = file('test.srt',FILE_IGNORE_NEW_LINES);
$regex = "/^(\d)+ ([\d]+:[\d]+:[\d]+,[\d]+) --> ([\d]+:[\d]+:[\d]+,[\d]+) (\w.+)/";

foreach($srt_file as $srt){

    preg_match($regex,$srt,$srt_lines);

    print_r($srt_lines);
    echo '<br />';

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-25T22:01:42.137

这是一个简短的状态机，用于逐行解析 SRT 文件：

```
define('SRT_STATE_SUBNUMBER', 0);
define('SRT_STATE_TIME',      1);
define('SRT_STATE_TEXT',      2);
define('SRT_STATE_BLANK',     3);

$lines   = file('test.srt');

$subs    = array();
$state   = SRT_STATE_SUBNUMBER;
$subNum  = 0;
$subText = '';
$subTime = '';

foreach($lines as $line) {
    switch($state) {
        case SRT_STATE_SUBNUMBER:
            $subNum = trim($line);
            $state  = SRT_STATE_TIME;
            break;

        case SRT_STATE_TIME:
            $subTime = trim($line);
            $state   = SRT_STATE_TEXT;
            break;

        case SRT_STATE_TEXT:
            if (trim($line) == '') {
                $sub = new stdClass;
                $sub->number = $subNum;
                list($sub->startTime, $sub->stopTime) = explode(' --> ', $subTime);
                $sub->text   = $subText;
                $subText     = '';
                $state       = SRT_STATE_SUBNUMBER;

                $subs[]      = $sub;
            } else {
                $subText .= $line;
            }
            break;
    }
}

if ($state == SRT_STATE_TEXT) {
    // if file was missing the trailing newlines, we'll be in this
    // state here.  Append the last read text and add the last sub.
    $sub->text = $subText;
    $subs[] = $sub;
}

print_r($subs); 
```

结果：

```
Array
(
    [0] => stdClass Object
        (
            [number] => 1
            [stopTime] => 00:00:24,400
            [startTime] => 00:00:20,000
            [text] => Altocumulus clouds occur between six thousand
        )

    [1] => stdClass Object
        (
            [number] => 2
            [stopTime] => 00:00:27,800
            [startTime] => 00:00:24,600
            [text] => and twenty thousand feet above ground level.
        )

) 
```

然后，您可以遍历 subs 数组或通过数组偏移量访问它们：

```
echo $subs[0]->number . ' says ' . $subs[0]->text . "\n"; 
```

要通过循环遍历每个子并显示它来显示所有子：

```
foreach($subs as $sub) {
    echo $sub->number . ' begins at ' . $sub->startTime .
         ' and ends at ' . $sub->stopTime . '.  The text is: <br /><pre>' .
         $sub->text . "</pre><br />\n";
} 
```

进一步阅读：[SubRip 文本文件格式](http://en.wikipedia.org/wiki/SubRip#SubRip_text_file_format)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T21:55:04.780

这不会匹配，因为您的 $srt_file 数组可能如下所示：

```
Array
([0] => '1',
[1] => '00:00:00,074 --> 00:00:02,564',
[2] => 'Previously on Breaking Bad...'.
[3] => '',
[4] => '2',
...
) 
```

您的正则表达式不会匹配任何这些元素。

如果您的意图是将整个文件读入一个长的 memory-hog-of-a-string，然后使用 file_get_contents 将整个文件内容放入一个字符串。然后使用 preg_match_all 获取所有正则表达式匹配。

否则，您可能会尝试遍历数组并尝试匹配各种正则表达式模式以确定该行是 id、时间范围还是文本并适当地执行操作。显然，您可能还需要一些逻辑来确保您以正确的顺序获取值（id，然后是时间范围，然后是文本）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T22:01:13.183

`file()`使用 将数组分组为 4 块[`array_chunk()`](http://php.net/array_chunk)，然后省略最后一个条目，因为它是一个空行，如下所示：

```
foreach( array_chunk( file( 'test.srt'), 4) as $entry) {
    list( $number, $time, $subtitle) = $entry;
    echo $number . '<br />';
    echo $time . '<br />';
    echo $subtitle . '<br />';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-14T21:36:10.007

我做了一个类来将 .srt 文件转换为数组。数组的每个条目都具有以下属性：

*   id：一个数字，代表字幕的id（2）
*   start：float，以秒为单位的开始时间（24.443）
*   end：float，结束时间，以秒为单位（27.647）
*   startString：人类可读格式的开始时间 (00:00:24.443)
*   endString：人类可读格式的结束时间 (00:00:24.647)
*   duration: 字幕的时长，单位 ms (3204)
*   text：字幕的文字（*孔雀统治公门城。*）

代码是php7：

```
<?php

namespace VideoSubtitles\Srt;

class SrtToArrayTool
{

    public static function getArrayByFile(string $file): array
    {

        $ret = [];

        $gen = function ($filename) {
            $file = fopen($filename, 'r');
            while (($line = fgets($file)) !== false) {
                yield rtrim($line);
            }
            fclose($file);
        };

        $c = 0;
        $item = [];
        $text = '';
        $n = 0;
        foreach ($gen($file) as $line) {

            if ('' !== $line) {
                if (0 === $n) {
                    $item['id'] = $line;
                    $n++;
                }
                elseif (1 === $n) {
                    $p = explode('-->', $line);
                    $start = str_replace(',', '.', trim($p[0]));
                    $end = str_replace(',', '.', trim($p[1]));
                    $startTime = self::toMilliSeconds(str_replace('.', ':', $start));
                    $endTime = self::toMilliSeconds(str_replace('.', ':', $end));
                    $item['start'] = $startTime / 1000;
                    $item['end'] = $endTime / 1000;
                    $item['startString'] = $start;
                    $item['endString'] = $end;
                    $item['duration'] = $endTime - $startTime;
                    $n++;
                }
                else {
                    if ($n >= 2) {
                        if ('' !== $text) {
                            $text .= PHP_EOL;
                        }
                        $text .= $line;
                    }
                }
            }
            else {
                if (0 !== $n) {
                    $item['text'] = $text;
                    $ret[] = $item;
                    $text = '';
                    $n = 0;
                }
            }
            $c++;
        }
        return $ret;
    }

    private static function toMilliSeconds(string $duration): int
    {
        $p = explode(':', $duration);
        return (int)$p[0] * 3600000 + (int)$p[1] * 60000 + (int)$p[2] * 1000 + (int)$p[3];
    }

} 
```

或者在这里查看：[https ://github.com/lingtalfi/VideoSubtitles](https://github.com/lingtalfi/VideoSubtitles)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-09T12:20:43.130

你可以使用这个项目：[https ://github.com/captioning/captioning](https://github.com/captioning/captioning)

示例代码：

```
<?php
require_once __DIR__.'/../vendor/autoload.php';

use Captioning\Format\SubripFile;

try {
    $file = new SubripFile('your_file.srt');

    foreach ($file->getCues() as $line) {
        echo 'start: ' . $line->getStart() . "<br />\n";
        echo 'stop: ' . $line->getStop() . "<br />\n";
        echo 'startMS: ' . $line->getStartMS() . "<br />\n";
        echo 'stopMS: ' . $line->getStopMS() . "<br />\n";
        echo 'text: ' . $line->getText() . "<br />\n";
        echo "=====================<br />\n";
    }

} catch(Exception $e) {
    echo "Error: ".$e->getMessage()."\n";
} 
```

样本输出：

```
> php index.php
start: 00:01:48,387<br />
stop: 00:01:53,269<br />
startMS: 108387<br />
stopMS: 113269<br />
text: ┘ç┘à╪د┘ç┘┌»█î ╪▓█î╪▒┘┘ê█î╪│ ╪ذ╪د ┌ر█î┘█î╪ز ╪ذ┘┘ê╪▒█î ┘ê ┌ر╪»┌ر x265
=====================<br />
start: 00:02:09,360<br />
stop: 00:02:12,021<br />
startMS: 129360<br />
stopMS: 132021<br />
text: .┘à╪د ┘╪ذ╪د┘è╪» ╪ز┘┘ç╪د┘è┘è ╪د┘è┘╪ش╪د ╪ذ╪د╪┤┘è┘à -
┌╪▒╪د ╪ا&lt;br />
=====================<br />
start: 00:02:12,022<br />
stop: 00:02:14,725<br />
startMS: 132022<br />
stopMS: 134725<br />
text: ..╪د┌»┘ç ┘╛╪»╪▒╪ز -
.╪د┘ê┘ ┘ç┘è┌┘ê┘é╪ز ┘à╪ز┘ê╪ش┘ç ╪▒┘╪ز┘┘à┘ê┘ ┘┘à┘è╪┤┘ç -<br />
=====================<br /> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-20T12:22:47.090

它可以通过使用 php 换行符来完成。我可以成功让我展示我的代码

```
$srt=preg_split("/\\r\\n\\r\\n/",trim($movie->SRT));
            $result[$i]['IMDBID']=$movie->IMDBID;
            $result[$i]['TMDBID']=$movie->TMDBID; 
```

这里 $movie->SRT 是在这个问题中发布格式的副标题。如我们所见，每个时间空间都是两个新行，希望您得到答案。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-04-11T17:00:56.633

# 简单、自然、琐碎的解决方案

srt subs 看起来像这样，并由两个换行符分隔：

```
3
00:00:07,350 --> 00:00:09,780
The ability to destroy a planet is
nothing next to the power of the force 
```

显然你想解析时间，使用`dateFormat.parse`Java中已经存在的时间，所以它是即时的。

```
class Sub {
    float start;
    String text;

    Sub(String block) {
        this.start = null; this.text = null;
        String[] lines = block.split("\n");
        if (lines.length < 3) { return; }

        String timey = lines[1].replaceAll(" .+$", "");
        try {
            DateFormat dateFormat = new SimpleDateFormat("HH:mm:ss,SSS");
            Date zero = dateFormat.parse("00:00:00,000");
            Date date = dateFormat.parse(timey);
            this.start = (float)(date.getTime() - zero.getTime()) / 1000f;
        } catch (ParseException e) {
            e.printStackTrace();
        }

        this.text = TextUtils.join(" ", Arrays.copyOfRange(lines, 2, lines.length) );
    }
} 
```

显然，要获取文件中的所有潜艇

```
 List<Sub> subs = new ArrayList<>();
    String[] tt = fileText.split("\n\n");
    for (String s:tt) { subs.add(new Sub(s)); } 
```

# python - 如何在不使用 html 表单的情况下将文件发布到 django

> ID：11659119
> 
> 赞同：1
> 
> 时间：2012-07-25T21:45:19.017
> 
> 标签：python, django, post, file-upload

我目前正在尝试将文件发布到用 django 编写的服务端点。

我可以找到一堆这样的例子（[从这里发挥](https://docs.djangoproject.com/en/dev/topics/http/file-uploads/?from=olddocs)）：

```
def upload_file(request):
    if request.method == 'POST':
        form = UploadFileForm(request.POST, request.FILES)
        if form.is_valid():
            handle_uploaded_file(request.FILES['file'])
            return HttpResponseRedirect('/success/url/')
     ........ 
```

但是我如何使用[测试客户端](https://docs.djangoproject.com/en/dev/topics/testing/?from=olddocs#module-django.test.client)或[urllib发出请求，](http://docs.python.org/library/urllib.html)*当它不是来自 HTML 表单时，它*可以将文件传递给服务器？ 我目前正在尝试将文件内容urlencode为json字符串，然后将其传递；但事实证明这很麻烦。

**除了下面的答案**：

1.  不要忘记让您的服务 csrf 豁免
2.  不要设置内容类型或将其显式设置为多部分。
3.  [有关如何在您的视图中处理传入文件的信息，请参阅此内容。](https://docs.djangoproject.com/en/dev/topics/http/file-uploads/?from=olddocs#handling-uploaded-files)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:59:30.717

正如 Goin 所说，使用[`Requests`](http://docs.python-requests.org/en/latest/index.html)，您可以这样做：

```
>>> r = requests.post('https://api.github.com/user', auth=('user', 'pass'))
>>> r.status_code
200
>>> r.headers['content-type']
'application/json; charset=utf8'
>>> r.encoding
'utf-8'
>>> r.text
u'{"type":"User"...'
>>> r.json
{u'private_gists': 419, u'total_private_repos': 77, ...} 
```

这`urllib2`将是：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import urllib2

gh_url = 'https://api.github.com'

req = urllib2.Request(gh_url)

password_manager = urllib2.HTTPPasswordMgrWithDefaultRealm()
password_manager.add_password(None, gh_url, 'user', 'pass')

auth_manager = urllib2.HTTPBasicAuthHandler(password_manager)
opener = urllib2.build_opener(auth_manager)

urllib2.install_opener(opener)

handler = urllib2.urlopen(req)

print handler.getcode()
print handler.headers.getheader('content-type') 
```

来源：[`github`](https://gist.github.com/973705)

在请求中发布多部分编码的文件很容易。来自官方文档：

```
>>> url = '/your/recieving/end'
>>> files = {'report.xls': open('report.xls', 'rb')}

>>> r = requests.post(url, files=files)
>>> r.text # response json 
```

# android - 重新打开关闭的对象错误 - Android

> ID：11659123
> 
> 赞同：0
> 
> 时间：2012-07-25T21:45:43.240
> 
> 标签：android, testing, sqlite

我正在使用 SQLite 数据库的应用程序上运行一些测试。我在创建默认活动时调用 open，然后 testSuite() 方法在完成测试后将其关闭。但是，同一行一直给我一个错误，告诉我该对象已关闭，我正在尝试重新打开它。我不知道这种关闭可能发生在哪里，而且我是那些不能经常校对自己的代码的人之一。有人介意向我指出为什么我会收到此错误吗？

```
public class SQLTest extends Activity
{
public SQLAdapter adapter;
public int[] bb_count;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    bb_count = new int[21];
    bb_count[0]++;
    setContentView(R.layout.activity_sqltest);
    adapter = new SQLAdapter(this);
    adapter.createDatabase();
    open();
}

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    bb_count[1]++;
    getMenuInflater().inflate(R.menu.activity_sqltest, menu);
    return true;
}

public SQLAdapter accessAdapter()
{
    bb_count[2]++;
    return adapter;
}

public void open()
{
    bb_count[3]++;
    adapter.open();
}

public void close()
{
    bb_count[4]++;
    adapter.close();
}

public long insert(String name, String field)
{
    bb_count[5]++;
    long id = adapter.insert(name, field);
    return id;
}

public long insert(int id, String name, String field)
{
    bb_count[5]++;
    id = (int) adapter.insert(id, name, field);
    return id;
}

public int delete(int id)
{
    bb_count[7]++;
    int rowsDeleted = adapter.delete(id);
    return rowsDeleted;
}

public int update(int id, String name, String field)
{
    bb_count[8]++;
    int rowsUpdated = adapter.update(id, name, field);
    return rowsUpdated;
}

public boolean get(Cursor cursor, int id)
{
    bb_count[9]++;
    try
    {
        bb_count[10]++;
        cursor = adapter.get(id);
        TextView tv = new TextView(this);
        String table = "";
        if (cursor.moveToFirst())
        {
            bb_count[11]++;
            table += "\n" + cursor.getString(0) + " " + cursor.getString(1) + " " + cursor.getString(2);
        }
        else
        {
            bb_count[12]++;
            table += "No hall found with ID: " + id;
            return false;
        }
        tv.setText(table);
        setContentView(tv);
    } catch (Exception e) {
        bb_count[13]++;
    }
    return true;
}

public boolean getAll(Cursor cursor)
{
    bb_count[14]++;
    try
    {
        bb_count[15]++;
        TextView tv = new TextView(this);
        String table = "";
        try
        {
            bb_count[16]++;
            cursor = adapter.getAll();
            if (cursor.moveToFirst())
            {
                bb_count[17]++;
                do
                {
                    bb_count[18]++;
                    table += "\n" + cursor.getString(0) + " " + cursor.getString(1) + " " + cursor.getString(2);
                } while (cursor.moveToNext());
            }
        } catch (Exception e) {
            bb_count[19]++;
        }
        tv.setText(table);
        setContentView(tv);
    } catch (Exception e) {
        bb_count[20]++;
        return false;
    }
    return true;
}

public String blockCoverage()
{
    String coverage = "";
    for (int x = 0; x < bb_count.length; x++)
        coverage += x + " " + bb_count[x] + "\n";
    return coverage;
}
}

public class SQLSuiteVer2 extends ActivityInstrumentationTestCase2<SQLTest>
{
SQLTest activity;

public SQLSuiteVer2()
{
    super(SQLTest.class);
}

protected void setUp() throws Exception
{
    super.setUp();
    setActivityInitialTouchMode(false);
    activity = getActivity();
}

public void testPreConditions()
{
    assertTrue(activity.accessAdapter() != null);
    assertTrue(activity.accessAdapter().accessHelper().checkDatabase());
}

public void testSuite() throws IOException
{
    int length = 100;
    Cursor[] cursors = new Cursor[5];
    for (int x = 0; x < 5; x++)
        cursors[x] = activity.accessAdapter().getAll();

    for (int x = 0; x < length; x++)
    {
        randomTest(cursors);
    }
    System.out.println( activity.blockCoverage()
            + activity.accessAdapter().accessHelper().blockCoverage());
    for (int x = 0; x < 5; x++)
        cursors[x].close();
    activity.close();
}

public void testInsert(Cursor cursor, String name, String field)
{

    int id = (int) activity.insert(name, field);
    assert (activity.get(cursor, id));
}

public void testDelete(Cursor cursor, int id)
{
    try
    {   
        activity.delete(id);
        assert (!activity.get(cursor, id));
    } catch (Exception e) {
        throw new Error("Row doesn't exist.");
    }
}

public void testUpdate(int id, String name, String field)
{
    Cursor cursor = activity.accessAdapter().get(id);
    activity.update(id, name, field);
    Cursor cursor2 = activity.accessAdapter().get(id);
    assertTrue(!(cursor.equals(cursor2)));
}

public void testGet(Cursor cursor, int id)
{
    assert activity.get(cursor, id);
}

public void testGetAll(Cursor cursor)
{
    assert activity.getAll(cursor);
}

public void testJoin(Cursor cursor, Cursor cursor2)
{
    String table = SQLAdapter.TABLE_OS;
    String sql = "CREATE TABLE Blah"
        + "_id INTEGER PRIMARY KEY AUTOINCREMENT, "
        + "OrderNo. INTEGER NOT NULL, "
        + "Item TEXT NOT NULL)";
    try
    {
        cursor = activity.accessAdapter().accessHelper().accessDatabase().rawQuery(sql, null);
    } catch (Exception e) {
        throw new Error("Could not make new 'Blah' table.");
    }
    sql = "SELECT * FROM " + table + " FULL JOIN Blah ON "
            + table + "._id=Blah._id";
    try
    {
        cursor2 = activity.accessAdapter().accessHelper().accessDatabase().rawQuery(sql, null);
    } catch (Exception e) {
        throw new Error("Could not join 'Blah' and '" + table + "' tables.");
    }
}

public void testJoinCopy(Cursor cursor, Cursor cursor2)
{
    String table = SQLAdapter.TABLE_OS;
    String sql = "SELECT * FROM " + table + " FULL JOIN " + table + "2 ON "
            + table + "._id=" + table + "2._id";

    cursor = activity.accessAdapter().getAll();
    try
    {
        cursor2 = activity.accessAdapter().accessHelper().accessDatabase().rawQuery(sql, null);
    } catch (Exception e) {
        throw new Error("Could not join '" + table +"' and its copy.");
    }

}

public void testJoinUnrelated(Cursor cursor, Cursor cursor2)
{
    String table = SQLAdapter.TABLE_OS;
    String sql = "CREATE TABLE Blah2"
            + "Name TEXT PRIMARY KEY, "
            + "OrderNo. INTEGER NOT NULL, "
            + "Item TEXT NOT NULL)";
    try
    {
        cursor = activity.accessAdapter().accessHelper().accessDatabase().rawQuery(sql, null);
    } catch (Exception e) {
        throw new Error("Could not make new 'Blah' table.");
    }

    sql = "SELECT * FROM " + table + " FULL JOIN Blah ON "
            + table + "._id=Blah._id";
    try
    {
        cursor2 = activity.accessAdapter().accessHelper().accessDatabase().rawQuery(sql, null);
    } catch (Exception e) {
        throw new Error("Could not join two tables without a similar '_id'.");
    }
}

public void testOverWrite(Random rand, String name, String field)
{
    int id;
    do
    {
        id = rand.nextInt();
    } while (activity.accessAdapter().get(id) == null);

    Cursor cursor = activity.accessAdapter().get(id);
    activity.insert(id, name, field);
    Cursor cursor2 = activity.accessAdapter().get(id);
    assertTrue(!(cursor.equals(cursor2)));
}

@SuppressLint("NewApi")
public void randomTest(Cursor[] cursors)
{
    String name = "", field = "";
    Random rand = new Random();
    int randOp = rand.nextInt(9);
    int randName, randField, id;

    Cursor cursor = activity.accessAdapter().getAll();
    cursor.moveToFirst();
    int start = Integer.parseInt(cursor.getString(0));
    cursor.moveToLast();
    int end = Integer.parseInt(cursor.getString(0));
    int range = (end - start) + 1;

    int cursorChoice = rand.nextInt(5);
    int cursor2Choice = rand.nextInt(5);

    switch (randOp)
    {
    case 0:
        randName = rand.nextInt(45);
        name = getRandomName(randName);
        int nullNotNull = rand.nextInt(2);
        switch (nullNotNull)
        {
        case 0:
            field = null;
            break;
        case 1:
            randField = rand.nextInt(24);
            field = getRandomField(randField);
            break;
        }
        testInsert(cursors[cursorChoice], name, field);
        break;
    case 1:
        id = rand.nextInt(range)+start;
        testDelete(cursors[cursorChoice], id);
        break;
    case 2:
        int selection = rand.nextInt(5);
        switch (selection)
        {
        case 0:
            randName = rand.nextInt(45);
            id = rand.nextInt(range)+start;
            name = getRandomName(randName);
            testUpdate(id, name, "");
            break;
        default:
            randName = rand.nextInt(45);
            name = getRandomName(randName);
            randField = rand.nextInt(24);
            field = getRandomField(randField);
            id = rand.nextInt(range)+start;
            testUpdate(id, name, field);
            break;
        }
        break;
    case 3:
        id = rand.nextInt(range)+start;
        testGet(cursors[cursorChoice], id);
        break;
    case 4:
        testGetAll(cursors[cursorChoice]);
        break;
    case 5:
        selection = rand.nextInt(5);
        switch (selection)
        {
        case 0:
            randName = rand.nextInt(45);
            name = getRandomName(randName);
            testOverWrite(rand, name, "");
            break;
        default:
            randName = rand.nextInt(45);
            name = getRandomName(randName);
            randField = rand.nextInt(24);
            field = getRandomField(randField);
            testOverWrite(rand, name, field);
            break;
        }
        break;
    case 6:
        testJoin(cursors[cursorChoice], cursors[cursor2Choice]);
        break;
    case 7:
        testJoin(cursors[cursorChoice], cursors[cursor2Choice]);
        break;
    case 8:
        testJoin(cursors[cursorChoice], cursors[cursor2Choice]);
        break;
    }   
}

 } 
```

这是我得到错误的地方：

```
java.lang.Error: Could not make new 'Blah' table.
at com.example.sql2.test.SQLSuiteVer2.testJoin(SQLSuiteVer2.java:99)
at com.example.sql2.test.SQLSuiteVer2.randomTest(SQLSuiteVer2.java:410)
at com.example.sql2.test.SQLSuiteVer2.testSuite(SQLSuiteVer2.java:43)
at java.lang.reflect.Method.invokeNative(Native Method)
at android.test.InstrumentationTestCase.runMethod(InstrumentationTestCase.java:214)
at android.test.InstrumentationTestCase.runTest(InstrumentationTestCase.java:199)
at android.test.ActivityInstrumentationTestCase2.runTest(ActivityInstrumentationTestCase2.java:192)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:190)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:175)
at android.test.InstrumentationTestRunner.onStart(InstrumentationTestRunner.java:555)
at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1584) 
```

一切正常，直到我添加了三种连接方法和一种覆盖方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:19:17.580

您的问题提到了重新打开封闭对象错误。然而你的 logcat 显示 java.lang.Error 异常。是哪个错误？

如果使用您的 logcat 作为指南。也许这是您第二次运行测试，表“Blah”已经存在？您不能使用相同的名称两次创建同一个表。解决此问题的一种方法是从“setUp”方法中删除所有表。这样您的测试就从空数据库开始。或者，如果已经存在，您可以使测试方法“testJoin”删除表“Blah”，然后重新创建它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:27:46.283

我自己解决了这个问题。我去尝试更深入地查看（我认为问题无法通过我添加的内容，考虑到代码在添加之前工作得很好）并发现了这一点：

```
public SQLAdapter open() throws SQLException
{
    try
    {
        helper.openDatabase();
        helper.close();
        database = helper.getWritableDatabase();
    } catch (SQLException e) {
        Log.e(TAG, " open >>" + e.toString());
        throw e;
    }
    return this;
} 
```

我认为这是问题的原因（帮助程序是我用来创建/复制和访问数据库的 SQLiteOpenHelper 的子类）。我删除了 helper.close() 部分，因为我的 SQLAdapter 类中已经有一个方法，所以稍后当我完成工作时会调用 helper.close() 方法。

# c# - SharpSvn GetFileVersions 修订范围，只返回一个文件版本

> ID：11659124
> 
> 赞同：0
> 
> 时间：2012-07-25T21:45:53.467
> 
> 标签：c#, svn, sharpsvn

我正在尝试使用 SharpSvn 读取文件的两个修订版的内容。当我运行以下代码时，该`fileVersions`集合仅包含一项..

```
var svnClient = new SvnClient();
var revisionInfo = new SvnFileVersionsArgs
    {
        Start = 80092,
        End = 80093
    };

Collection<SvnFileVersionEventArgs> fileVersions;
svnClient.GetFileVersions(
    new SvnUriTarget("https://DbDiff.svn.codeplex.com/svn/DbDiffCommon/DataAccess/SqlCommand11.xml"), 
    revisionInfo,
    out fileVersions); 
```

但是我希望它包括两个项目。使用 TortoiseSVN 我可以看到文件在修订版**80088**中发生了更改，所以我希望在使用`Start = 80092`..

![TortoiseSVN 日志消息](../Images/5bb4478c27ff3143e075104204fd6633.png)

使用`Start = 80091`也无济于事..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T12:54:41.747

问题不在于您的代码，而在于 codeplex 使用的 SvnBridge 软件。（它们将数据存储在 TFS 中，并通过网桥提供访问，而不是使用真正的 Subversion 后端）。

桥接软件未正确实现此 api。（我在几年前添加了一个问题，但据我所知，它从未修复过）。

Subversion 本身只将此 api 用于 'svn blame' (/praise/annotate)，所以我认为 SvnBridge 开发人员并没有足够关心来解决这个问题。

在 AnkhSVN 中，我检测到只接收一个文件的情况，然后使用 SvnClient.Write() 以慢速方式获取文件:(

# django - Bitnami Django 创建多个项目

> ID：11659126
> 
> 赞同：3
> 
> 时间：2012-07-25T21:45:57.660
> 
> 标签：django, amazon-ec2, project, bitnami

所以我有这个 Bitnami EC2 实例，它默认包含项目“Project”（位于 /apps/django/django_projects），所以我开始遵循 django 教程并完成了所有工作。我可以访问这个项目

```
http://myIp/Project/. 
```

因此，在完成教程后，我开始创建自己的项目。我使用创建了项目

```
django-admin.py startproject DoE 
```

在与项目'Project'相同的目录中（即/apps/django/django_projects），然后是

```
python manage.py runserver 0.0.0.0:8000 
```

但问题是当我去

```
http://myIp/DoE/ 
```

我收到此错误：

```
Not Found

The requested URL /DoE/ was not found on this server. 
```

任何帮助都感激不尽。提前致谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T15:30:49.923

我找到了解决这个问题的方法，它有点hacky，但它可以完成工作。我从这里得到它[http://wiki.bitnami.org/Components/Django](http://wiki.bitnami.org/Components/Django)。但他们暗示，如果你使用的是我不是的 apache 网络服务器，你只需要这样做。我正在使用 django 的开发服务器，但它仍然有效。

基本上我必须在 /home/bitnami/apps/django/conf 中创建一个 DoE.conf 文件，如下所示：

```
Alias /static "/opt/bitnami/apps/django/lib/python2.7/site-packages/django/contrib/admin/static"

<Directory '/opt/bitnami/apps/django/lib/python2.7/site-packages/django/contrib'>
Order allow,deny
Allow from all
</Directory>

WSGIScriptAlias /DoE "/opt/bitnami/apps/django/scripts/DoE.wsgi"

<Directory '/opt/bitnami/apps/django/scripts'>
Order allow,deny
Allow from all
</Directory> 
```

然后在 /home/bitnami/apps/django/scripts 中创建一个名为 DoE.wsgi 的文件，如下所示：

```
import os, sys
sys.path.append('/opt/bitnami/apps/django/django_projects')
sys.path.append('/opt/bitnami/apps/django/django_projects/DoE')
os.environ['DJANGO_SETTINGS_MODULE'] = 'DoE.settings'

import django.core.handlers.wsgi

application = django.core.handlers.wsgi.WSGIHandler() 
```

之后我必须包括

```
/opt/bitnami/apps/django/conf/DoE.conf 
```

在我的 httpd.conf 文件中，就我而言，这里是：/opt/bitnami/apache2/conf

在此之后，我重新启动了我的机器/服务器，一切都很好:)

# java - java - 如何比较从jTextfield输入的数据与通过Java驱动程序输入的Mongo数据库数据？

> ID：11659127
> 
> 赞同：-4
> 
> 时间：2012-07-25T21:46:07.453
> 
> 标签：java, mongodb

由于我想将用户在 jTextFields 中输入的用户 ID 和密码与我的 mongodb 文档中存在的用户 ID 和密码的值进行比较，因此 Mongodb 中的文档如下所示：

```
{ "_id" : ObjectId("500ee83ca5d4c30481aa2a13"),
 "User ID" : 10, 
 "Password" : "4554gf",} 
```

下面的代码在我的`Login`按钮上

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    int s1 = Integer.parseInt(jTextField1.getText()); //number entering in jtextfield 
    String s2 = jPasswordField1.getText(); //password enter by user  
    if(s1== UserId  &&  s2==password) {
        this.dispose();//this will dispose the login gui
        a.setVisible(true);//this will visible the nxt gui
    }
    else {
        asd.setText("invalid user"); // label that shows if userid and dont match
    } 
```

所以它不工作，所以请告诉怎么做？我希望你们都明白我的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T21:50:02.710

**永远不要**使用 == 来比较对象

始终使用`equals()`

== 仅当它们是相同的对象（相同的引用），具有相同值但创建方式不同的对象时才会起作用，它将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T22:49:36.410

我就是这样做的：

```
 private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    BasicDBObject view = new BasicDBObject();
    double id = 0;
    String pass = "";

    int s1 = Integer.parseInt(jTextField1.getText());
    String s2 = jPasswordField1.getText();
    view.put("Pateint ID", s1);
    DBCursor cur1 = Patient.coll.find(view);// cheeks in collection of specific id
    if (cur1.hasNext()) {
        DBObject o = cur1.next();//
        pass = (String) o.get("Password");//get password from mongodb
        id = (double) o.get("Pateint ID");// get pateintID from mongodb
    }

    if (s1 == id && s2.equals(pass))// matches id and password here 
   {
        this.dispose();

        a.setVisible(true);

    } else {
        asd.setText("invalid user");
    }

} 
```

# r - 如何使用 cast 或其他函数在 R 中创建二进制表

> ID：11659128
> 
> 赞同：4
> 
> 时间：2012-07-25T21:46:07.540
> 
> 标签：r, dataframe, casting, reshape

我正在尝试创建一个具有二元响应并一直在使用强制转换的因素列表。

```
DF2 <- cast(data.frame(DM), id ~ region)
names(DF2)[-1] <- paste("region", names(DF2)[-1], sep = "") 
```

我遇到的问题是响应是答案出现的频率，而我正在寻找它是否匹配。

例如我有：

```
id region
 1   2
 1   3
 2   2
 3   1
 3   1 
```

我想要的是：

```
id region1 region2 region3
1   0          1     1
2   0          1     0
3   1          0     0 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T21:59:53.020

**我更**喜欢`dcast`reshape2 ：

 **```
library(reshape2)
dat <- read.table(text = "id region
 1   2
 1   3
 2   2
 3   1
 3   1",header = TRUE,sep = "")

dcast(dat,id~region,fun.aggregate = function(x){as.integer(length(x) > 0)})

  id 1 2 3
1  1 0 1 1
2  2 0 1 0
3  3 1 0 0 
```

可能有更顺畅的方法可以做到这一点，但老实说，我并不经常施放东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-25T22:29:34.873

原始数据：

```
x <- data.frame(id=c(1,1,2,3,3), region=factor(c(2,3,2,1,1)))

> x
  id region
1  1      2
2  1      3
3  2      2
4  3      1
5  3      1 
```

将数据分组：

```
aggregate(model.matrix(~ region - 1, data=x), x["id"], max) 
```

结果：

```
 id region1 region2 region3
1  1       0       1       1
2  2       0       1       0
3  3       1       0       0 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-26T03:23:24.117

这是一种“棘手”的方法，可以在一行中使用`table`（括号很重要）。假设你`data.frame`的名字是`df`：

```
(table(df) > 0)+0
#    region
# id  1 2 3
#   1 0 1 1
#   2 0 1 0
#   3 1 0 0 
```

`table(df) > 0`给我们`TRUE`和`FALSE`; 添加`+0`将`TRUE`and转换`FALSE`为数字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-25T22:16:19.153

不需要专门的功能：

```
x <- data.frame(id=1:4, region=factor(c(3,2,1,2)))
x
   id region
1  1      3
2  2      2
3  3      1
4  4      2

x.bin <- data.frame(x$id, sapply(levels(x$region), `==`, x$region))
names(x.bin) <- c("id", paste("region", levels(x$region),sep=''))
x.bin

  id region1 region2 region3
1  1   FALSE   FALSE    TRUE
2  2   FALSE    TRUE   FALSE
3  3    TRUE   FALSE   FALSE
4  4   FALSE    TRUE   FALSE 
```

或者对于整数结果：

```
x.bin2 <- data.frame(x$id,  
    apply(sapply(levels(x$region), `==`, x$region),2,as.integer)
) 
names(x.bin2) <- c("id", paste("region", levels(x$region),sep=''))
x.bin2

  id region1 region2 region3
1  1       0       0       1
2  2       0       1       0
3  3       1       0       0
4  4       0       1       0 
```**

# template-engine - 带有“div”标签而不是“script”的车把模板

> ID：11659130
> 
> 赞同：3
> 
> 时间：2012-07-25T21:46:16.893
> 
> 标签：template-engine, handlebars.js

实际上问题在于主题...是否可以制作车把模板框架，以识别 div 标签内的模板而不是 script 标签？

例如我想用这个标记创建模板：

```
<style>
    div.text-x-handlebars {display:none;}
</style>
<div class="text-x-handlebars-template">
    <h2>I'm template</h2>
    <p>{{welcomeMessage}}</p>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T22:15:09.787

是的，您可以将模板放在`<div>`s 中而不是`<script>`s 中，例如：

> [http://jsfiddle.net/ambiguous/RucqP/](http://jsfiddle.net/ambiguous/RucqP/)

然而，这样做是充满危险的。如果您将模板放在 a中，那么浏览器会在您填写*之前*`<div>`将其解释为 HTML ；因此，如果您的模板的 HTML 直到被填写*后才*有效，浏览器可能会尝试更正它并把事情弄得一团糟。此外，如果您的模板中有属性，那么您最终会得到重复的 s（一个在模板中，并且在您放入 DOM 的填充模板中重复），这将导致各种奇怪而有趣的错误。浏览器还将尝试以**`id``id``<div>``<div>`，这可能是也可能不是问题（如果图像在其`src`属性中使用模板变量，甚至可能是可取的，但可能是不可取的）。**

 **基本上，你可以这样做，但你不应该这样做，你应该把你的模板放在`<script id="..." type="text/x-handlebars-template">`元素中。**

# javascript - 在 Javascript 中将函数应用于 Null

> ID：11659134
> 
> 赞同：7
> 
> 时间：2012-07-25T21:47:11.387
> 
> 标签：javascript, call

为什么以下工作：

```
function sum(a,b) { return a + b; }
var result = sum.call(null,3,4);     // 7 
```

为什么定义结果？我正在调用 sum 作为 null 的方法。但是 null 不是对象，不能有属性！

到底是怎么回事？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-25T21:49:16.203

for 的第一个参数`Function.prototype.call`是*context*，它定义了`this`被调用函数的执行上下文的值，仅此而已。

所以基本上，你说的`this`是指`null`（至少在 ES5 严格模式下），但由于你`this`无论如何都不能访问，所以没有区别。

在非严格模式下，`this`cannot be `null`，所以它被替换为*全局对象*。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-25T21:49:03.153

当你使用`.call`or`.apply`和`null`or时，如果不是在严格模式下`undefined`，默认`this`（通常）会自动使用。`window`

来自[MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)（重点是我的）：

> `thisArg`
> `this`为调用提供 的值`fun`。请注意，这可能不是方法看到的实际值：**如果方法是非严格模式代码中的函数，`null`将`undefined`被替换为全局对象**，原始值将被装箱。

如果您*处于*严格模式，它实际上将是`null`or `undefined`。

```
(function() {
    'use strict';

    return this;
}).call(null); // null 
```

```
(function() {
    'use strict';

    return this;
})(); // undefined 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-25T21:49:43.423

它不是。在这种情况下，NULL 指定`this`关键字绑定到的对象。在您的方法中，通过将其设置为 NULL ，它要么没有`this`变量绑定，要么绑定到函数本身或窗口。

由于您没有使用通过 访问`this`的任何变量或函数，因此无需使用 call 方法......您可以使用`sum(3,4)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-25T21:52:31.950

例如，如[MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)中所述，第一个参数是

> 为调用 [方法] 提供的 this 的值。请注意，这可能不是方法看到的实际值：如果方法是非严格模式代码中的函数，null 和 undefined 将被替换为全局对象，原始值将被装箱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-23T06:56:24.103

正如 MDN 解释的那样。

> 这个Arg
> 
> 这为有趣的呼吁提供了价值。请注意，这可能不是方法看到的实际值：如果方法是非严格模式代码中的函数，null 和 undefined 将被替换为全局对象，原始值将被装箱。

简单地说就是一小段代码。

```
<script >
        'use strict'
        function fun() {
            alert(this);
        }
        fun.call(null);

    </script> 
```

在严格模式下，这是空的。但在非严格模式下。这是窗口或全局对象。

# google-apps-script - Chrome 网上应用店：如何使用谷歌应用脚 本检查付款

> ID：11659135
> 
> 赞同：1
> 
> 时间：2012-07-25T21:47:12.540
> 
> 标签：google-apps-script, chrome-web-store

我们成功地将两个 Google Apps Script 网络服务放入 chrome 网上商店。一个是 fe [https://chrome.google.com/webstore/detail/aagmbfbgdjhkilafppdjihnafgcahpbc](https://chrome.google.com/webstore/detail/aagmbfbgdjhkilafppdjihnafgcahpbc)

现在我们要检查付款，如
[https://developers.google.com/chrome/web-store/docs/check_for_payment?hl=de中所述](https://developers.google.com/chrome/web-store/docs/check_for_payment?hl=de)

但是 1\. 如何获取当前用户的用户 ID（对应于 Google 帐户的 OpenID URL） 2\. 如何使用带有 Google Apps 脚本代码的 Licensing API 发出请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-15T21:16:28.230

您是否只使用验证付款方式：

```
 google.payments.inapp.getPurchases({
  'success': onLicenseUpdate,
  'failure': onLicenseUpdateFail
}); 
```

回应：

```
 {
  "response": {
    "details": [
      {
        "kind": "chromewebstore#payment",
        "itemId": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "sku": "giant_tv",
        "createdTime": "1387221267248",
        "state": "ACTIVE"
      }
    ]
  }
} 
```

[https://developer.chrome.com/webstore/payments-iap](https://developer.chrome.com/webstore/payments-iap)

# jquery - jQuery addClass 不会启动

> ID：11659136
> 
> 赞同：0
> 
> 时间：2012-07-25T21:47:15.980
> 
> 标签：jquery

我正在尝试向预先存在的元素添加一个类，并且我正在尝试最简单的代码。任何人都知道为什么这两个日志会返回完全相同的元素？

```
console.log($('.btn-group.archive'));
$('.btn-group.archive').addClass('open');
console.log($('.btn-group.archive')); 
```

可能值得一提的是，我正在使用 Twitter Bootstrap 的下拉菜单，所以我不知道那里是否有什么问题。

他们回来了：

```
<div class="btn-group archive">
    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        Select
    </a>
    <ul class="dropdown-menu"><!-- dropdown menu links -->
        <li><a href="#">Item #1</a></li>
        <li><a href="#">Item #2</a></li>
    </ul>
</div> 
```

`<div class="btn-group archive">`应该在哪里`<div class="btn-group archive open">`。

控制台正在正确记录，但该类不会添加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:56:38.943

所以我认为这只是时间问题，而且`console.log`命令会让你失望——但命令确实有效，并且*确实按照你指定的顺序发生*。

举个例子——[现场演示](http://jsfiddle.net/vAGdL/)

```
<div id="foo"></div>​

​$(function(){
    console.log($("#foo"));
    setTimeout(function(){
      $("#foo").addClass("bar");
      console.log($("#foo"));      
    },40);
});​​​ 
```

输出 -

```
[<div id=​"foo">​&lt;/div>​] 
[<div id=​"foo" class=​"bar">​&lt;/div>​] 
```

任何小于 40 毫秒的间隔都会为两次调用产生相同的输出`console.log`- 但这可能因机器和浏览器而异。

* * *

我不确定您是否熟悉缓冲输出的概念，而不是刷新所有输出的概念......但是这种行为可以在许多不同的语言中看到。我不是 JavaScript 专家，所以我不能 100% 确定这是怎么回事（输出被缓冲）......

# java - Java中策略模式的简洁表达

> ID：11659142
> 
> 赞同：0
> 
> 时间：2012-07-25T21:47:33.687
> 
> 标签：java, strategy-pattern

我想在 Java 中使用策略模式。但是，如果我将大量文件添加到代码库或编写冗长的代码，我的老板不喜欢它。似乎使用策略模式，我必须为接口创建一个文件，然后再创建五个附加文件，这样我就可以为我的五个可能策略中的每一个创建一个类。

有没有办法用更少的文件和更少的代码来表达 Java 中的策略模式？

我认为如果我的策略变体可以在一个 Enum 或一个易于组装的 Set 上表示，那将是理想的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:56:05.630

我认为你应该和你的老板坐下来，向他/她解释更少的文件！= 好的代码。至少尝试解释模式本身以及如何拥有多个类，每个类都有自己的特定目的，以便更好地进行测试、维护等......

就我个人而言，我发现代码更冗长，大量的 IF 语句散布在适当的多态性会使代码更容易理解的地方。

PS：是的，枚举可以通过使用匿名子类构造来产生行为：

```
public enum Foo {
   BAR() {
     public void baz() { ... }
   };

   public abstract void baz();
} 
```

虽然我不确定我是否会推荐使用它，除非你绝对必须这样做。

# join - 教义加入绕过延迟加载

> ID：11659145
> 
> 赞同：2
> 
> 时间：2012-07-25T21:47:47.693
> 
> 标签：join, orm, symfony, doctrine

我刚开始探索 Symfony2，我很惊讶它有这么多很棒的功能。[我开始在http://tutorial.symblog.co.uk/](http://tutorial.symblog.co.uk/)上写博客教程，
但使用的是 2.1 版而不是 2.0 版

我的问题是我有以下博客实体：

```
/**
 * @ORM\OneToMany(targetEntity="Comment", mappedBy="blog")
 */
protected $comments; 
```

以及 Comment 实体中的以下内容：

```
/**
 * @var string $blog
 *
 * @ORM\ManyToOne(targetEntity="Blog", inversedBy="comments")
 * @ORM\JoinColumn(name="blog_id", referencedColumnName="id")
 */
private $blog; 
```

我创建了获取最新博客并加入评论的功能，因此我不必为每个博客延迟加载评论并避免多次调用评论表，如下所示：

```
$qb = $this->createQueryBuilder('b')
            ->select('b')
            ->leftJoin('b.comments', 'c')
            ->addOrderBy('b.created', 'DESC'); 
```

但是当我在 twig 模板中运行时，该查询的结果为：`blog.comments` 我得到了第一个查询来检索正确的博客，并在其中加入，但随后我没有使用连接值进行评论，而是调用了每个评论表博客条目？对于这种情况，我如何绕过该功能但保持关系，以便我可以从查看博客页面获取博客的所有评论？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T21:56:04.977

您还需要将评论对象添加到选择结果中：

```
->select('b', 'c') 
```

# javascript - Javascript 最小化 使用精灵效应？

> ID：11659147
> 
> 赞同：5
> 
> 时间：2012-07-25T21:47:53.917
> 
> 标签：javascript, jquery, jquery-effects

我想最小化一个框，就像 Mac 上精灵效果中的弹出弹出框一样，我发现 jQuery Transfer[效果](http://jqueryui.com/demos/effect/)很接近，但还不够，它只画了一个轮廓，实际上并没有涂抹对象，有没有办法模仿 Mac 的精灵最小化效果？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T21:58:19.317

纯 DOM 操作无法实现这种效果。元素的流动和形状由浏览器的渲染引擎决定。您可以应用 CSS3 转换，但即使这也仅限于实现此外观所需的组合步骤的子集。但是，如果您可以将 Flash 作为此解决方案的一部分处理，那么您还有更多选择：

[http://wonderfl.net/c/qnTR](http://wonderfl.net/c/qnTR)

这个例子让我大吃一惊（有史以来最好的 Hello World！）：

[http://swingpantsflash.com/genie_transition/genietransition.html](http://swingpantsflash.com/genie_transition/genietransition.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:10:30.787

如果您使用画布库，您可以实现精灵效果。这是一个叫做[CAAT](http://hyperandroid.github.com/CAAT/)的。

尝试使用[animate.css](http://daneden.me/animate/)`fadeInUpBig`中的和`fadeOutDownBig`类

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T21:58:32.250

没有任何东西类似于精灵效应。如果您使用 CSS 变换（使用缩放和倾斜）和 jQuery 回调自己制作一些动画，您可以获得的最接近的动画。设置顶部、左侧、宽度和高度值的标准 CSS 属性不会让您获得想要的效果。

# c++ - DirectX 未解决的外部错误

> ID：11659157
> 
> 赞同：1
> 
> 时间：2012-07-25T21:48:23.703
> 
> 标签：c++, directx, external

所以我试图进入一些directX编程，所以我正在关注这本书名为“Beginning DirectX 11 Game Programming”，但我已经被第二个例子困住了。

我花了大约一个小时来寻找这个问题的解决方案，但找不到任何可以帮助我的东西。

所以我得到的错误代码是这样的：

```
Main.obj : error LNK2019: unresolved external symbol "long __stdcall WndProc(struct HWND__ *,unsigned int,unsigned int,long)" (?WndProc@@YGJPAUHWND__@@IIJ@Z) referenced in function _wWinMain@16 
```

这是代码 - 除了 LRESULT CALLBACK WndProc 之外，完全按照书中的方式编写

```
#include <Windows.h>

LRESULT CALLBACK WndProc( HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam );

int WINAPI wWinMain( HINSTANCE hInstance, HINSTANCE prevInstance, LPWSTR cmdLine, int cmdShow )
{
    UNREFERENCED_PARAMETER( prevInstance );
    UNREFERENCED_PARAMETER( cmdLine );

    WNDCLASSEX wndClass = { 0 };
    wndClass.cbSize = sizeof( WNDCLASSEX );
    wndClass.style = CS_HREDRAW | CS_VREDRAW;
    wndClass.lpfnWndProc = WndProc;
    wndClass.hInstance = hInstance;
    wndClass.hCursor = LoadCursor( NULL, IDC_ARROW );
    wndClass.hbrBackground = ( HBRUSH )( COLOR_WINDOW + 1 );
    wndClass.lpszMenuName = NULL;
    wndClass.lpszClassName = "DX11BookWindowClass";

    if( !RegisterClassEx( &wndClass ) )
        return -1;

    RECT rc = { 0,0,640,480 };
    AdjustWindowRect( &rc, WS_OVERLAPPEDWINDOW, FALSE );

    HWND hwnd = CreateWindowA( "DX11BookWindowClass", "Blank Win32 Window", WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, CW_USEDEFAULT, rc.right - rc.left,
                                rc.bottom - rc.top, NULL, NULL, hInstance, NULL );

    if( !hwnd )
        return -1;

    ShowWindow( hwnd, cmdShow );

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:06:37.313

*如果您不处理任何消息*`0`，则从`WndProc`回调中返回**是**一个糟糕的主意。所以你可以定义它来自己处理消息，或者简单地使用默认过程：

 *```
wndClass.lpfnWndProc = DefWindowProc; 
```

或者：

```
LRESULT CALLBACK WndProc( HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam ) { return DefWindowProc(hWnd, msg, wParam, lParam); } 
```

每当您不处理您的消息时，您应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T16:53:57.860

Defining your WndProc as `DefWindowProc` is not the solution when we're discussing DirectX. Plenty of users run their games in window mode which means you have program the possibility of updating your aspect ratio for your `XMMatrixPerspectiveFovLH`, changing the resolution of your buffers and updating your viewport if the window becomes resized. Also later on if you want to avoid DirectInput in itself you could just simply use the window messages `WM_MOUSEMOVE; WM_LBUTTONDOWN; WM_LBUTTONUP`, etc to manage your mouse and keyboard states - as many still detest dinput8.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T21:57:43.170

你从不定义

```
LRESULT CALLBACK WndProc( HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam ); 
```

任何地方。@RomanR。有一个完美的答案，我同意这是一个糟糕的解决方案。回到第一个练习，看看它是否没有实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T23:17:19.587

我在阅读同一本书时也犯了同样的错误，如果您在图 2.4 之后继续阅读，您会注意到它实际上为您回答了问题，并且有一个关于 Windows 回调过程的完整小节。*

# .htaccess - Htaccess 将 .pdf 重写为 php 文件不适用于 chrome

> ID：11659158
> 
> 赞同：0
> 
> 时间：2012-07-25T21:48:30.687
> 
> 标签：.htaccess, google-chrome, pdf

**.htaccess**

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^(.+)\.pdf$  viewer.php?pdf=$1 [L,NC,QSA] 
```

这适用于 Firefox，但 chrome 选择在浏览器嵌入/显示器中以自己的方式打开 pdf。如何使用 chrome 进行这项工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T21:56:13.530

与其使用 .htaccess 来设置 mime 类型，不如使用 viewer.php 设置在所有浏览器中都可以正常工作的适当标题时效果更好。

[在这里](https://stackoverflow.com/questions/364946/how-to-make-pdf-file-downloadable-in-html-link)查看第一个答案

# symfony - 在自定义 LoginSuccessHandler 中重定向到 default_target_path？

> ID：11659161
> 
> 赞同：3
> 
> 时间：2012-07-25T21:48:40.130
> 
> 标签：symfony

我有一个自定义成功登录处理程序，用于**在成功登录后自定义基于角色的重定向**。

`$specialRoles`当找到数组中的这些特殊角色时，将`RedirectResponse`返回一个新角色：

```
/** @DI\Service("handler.login_sucess_handler") */
class LoginSuccessHandler implements uthenticationSuccessHandlerInterface
{
    private $router;
    private $securityContext;

    /**
     * @DI\InjectParams({
     *     "securityContext"= @DI\Inject("security.context"),
     *     "router"         = @DI\Inject("router") })
     */
    public function __construct(SecurityContext $securityContext,
        I18nRouter $router)
    {
        $this->securityContext = $securityContext;
        $this->router          = $router;
    }

    public function onAuthenticationSuccess(Request $request,
        TokenInterface $token)
    {
        $specialRoles = array('ROLE_1', 'ROLE_2', 'ROLE_3');

        foreach($specialRoles as $specialRole)
        {
            if($this->securityContext->isGranted($specialRole))
            {
                $redirectUrl = $this->router->generate('manage_index');
                return new RedirectResponse($redirectUrl);
            }
        }
    }
} 
```

另一方面，我需要指定**如果用户没有特殊角色会发生什么**。我想让它更灵活，即：不对默认`/app/dashboard`路由进行硬编码。也就是说，从文件中读取`default_target_path`（如果有的话） ：`security.yml`

```
form_login:
    login_path:          /app/login
    check_path:          /app/login_check
    default_target_path: /app/dashboard
    success_handler:     handler.login_sucess_handler 
```

有没有办法做到这一点？

当然**保留代码原样**，当用户没有任何特殊角色时，会抛出异常：

> 可捕获的致命错误：传递给 Symfony\Component\HttpKernel\Event\GetResponseEvent::setResponse() 的参数 1 必须是 Symfony\Component\HttpFoundation\Response 的实例，给定 null。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T07:49:54.827

这就是我在我的一个项目中的做法：

```
if ($targetPath = $request->getSession()->get('_security.target_path')) {
    return new RedirectResponse($targetPath);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T05:50:21.690

为什么不简单地在`foreach`循环后添加带有所需路由的 return 语句？

```
 public function onAuthenticationSuccess(
        Request $request, 
        TokenInterface $token
    )
    {
        $specialRoles = array('ROLE_1', 'ROLE_2', 'ROLE_3');

        foreach($specialRoles as $specialRole) {
            if ($this->securityContext->isGranted($specialRole)) {
                $redirectUrl = $this->router->generate('manage_index');
                return new RedirectResponse($redirectUrl);
            } 
        }

        $redirectUrl = $this->router->generate('your_custom_route');
        return new RedirectResponse($redirectUrl);
    } 
```

当然，不要忘记在路由中定义您的自定义路由。

**编辑**：

您还可以在登录表单中设置`_referer`输入字段并将其与表单一起提交，然后通过`$request->get('_referer');`

另一种方法是尝试从标头中获取引用：`$request->headers->get('Referer');`

最后，您可以获得默认目标路径，它在 security.yml 中定义：`$request->getSession()->get('_security.target_path');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T00:14:10.927

你解决了重定向问题吗？这些解决方案根本不适合我，但是这个：

```
return new RedirectResponse($request->headers->get('Referer')); 
```

# objective-c - iOS设备和iPhone模拟器内存 组织的区别

> ID：11659163
> 
> 赞同：0
> 
> 时间：2012-07-25T21:48:47.643
> 
> 标签：objective-c, ios, memory-management, ios-simulator

我正在尝试使用 Xcode 4.3.3 和 iPhone 5.1 模拟器开发一个应用程序。

当我在模拟器上运行这个应用程序时，我没有收到任何警告，它运行得很好。但是，当我尝试在 iOS 设备上进行这项工作时，我收到一条警告消息，即**Received memory warnings**。当应用程序开始在屏幕上显示图像时，我收到了此警告消息。我正在使用github 中提供的[SDWebImage](https://github.com/rs/SDWebImage/)项目来显示图像。我认为这个问题与 iOS 设备和模拟器的内存组织方式不同有关。我看过这个问题[iOS 设备和模拟器的构建实际上有何不同？](https://stackoverflow.com/questions/10205654/how-does-building-for-ios-device-and-simulator-actually-differ?rq=1)了解 iOS 设备和模拟器的构建应用程序有何不同。但是，我对记忆组织的发现并没有让我满意。你们知道为什么会这样吗？

另一个问题：在内存管理的上下文中，应用程序是否有任何限制？我的意思是，例如，假设分配了 5MB 内存，我会收到任何指向此问题的消息吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:03:29.423

除非您自己创建它们（使用“模拟内存警告”选项），否则您永远不会在模拟器中收到内存警告。您可以访问 Mac 的整个内存，包括虚拟内存。你最好不要用移动应用程序...

如果您在设备上看到内存警告，则表示您使用的内存过多。确定您遇到问题的最佳工具是 Instruments，特别是 Allocations 工具。这将向您展示占用最多内存的内容以及您应该关注的地方。大多数内存警告是由于泄漏或保留循环引起的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T06:28:58.360

最好不要用模拟器调试，因为模拟器`s memory is the mac , but your device`的内存非常有限，模拟器的能力比较好。

# visual-studio-2010 - Windows Phone 和 Android App 项目的通用库

> ID：11659171
> 
> 赞同：1
> 
> 时间：2012-07-25T21:49:17.607
> 
> 标签：visual-studio-2010, windows-phone-7, xamarin.android

我正在开发一个 windows phone 应用程序和一个 android 应用程序。这两个应用程序都在一个 Visual Studio 2010 解决方案下。

我想在同一解决方案下包含第三个项目，其中包含 Windows 和 android 应用程序使用的通用功能。因此，为此，当我使用普通的“类库”并尝试在 Windows Phone 应用程序项目中引用它时，它会显示“无法添加选定的项目引用。项目引用必须是另一个相同的 Silverlight for Windows Phone 项目或更低版本”。

您建议哪种类型的项目，以便我可以使用它的 windows phone 和 android 项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:58:30.443

您将不得不使用两个不同的 csproj 文件 - 因为这两个平台的构建目标和其他部分会有所不同。在每个 csproj 中使用[此](https://stackoverflow.com/a/11620187/802203)递归包含从公共位置添加源。

您也可以尝试使用[Portable 类库](http://visualstudiogallery.msdn.microsoft.com/b0e0b5e9-e138-410b-ad10-00cb3caf4981/)扩展，但我不确定它是否会有所帮助。

# java - 从数组创建可变列表？

> ID：11659173
> 
> 赞同：101
> 
> 时间：2012-07-25T21:49:38.060
> 
> 标签：java, arrays, list, mutable

我有一个数组，我想将其转换为`List`，以便修改数组的内容。

Stack Overflow 有很多问题/答案可以解决`Arrays.asList()`，它如何只提供底层数组的 List 视图，以及如何尝试操作结果 List 通常会抛出一个`UnsupportedOperationException`用于操作列表的方法（例如`add()`，`remove()`等）是未由 提供的 List 实现实现`Arrays.asList()`。

但我找不到如何将数组转换为可变列表的示例。我想我可以遍历数组并将`put()`每个值循环到一个新列表中，但我想知道是否存在一个接口可以为我执行此操作。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-07-25T21:51:47.647

一种简单的方法：

```
Foo[] array = ...;
List<Foo> list = new ArrayList<Foo>(Arrays.asList(array)); 
```

这将创建一个可变列表 - 但它将是原始数组的*副本*。更改列表*不会*更改数组。当然，您可以稍后将其复制回来，使用`toArray`.

如果你想在数组上创建一个可变*视图*，我相信你必须自己实现它。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-10-11T13:11:11.340

如果您使用的是 google 集合 API（Guava）：

```
Lists.newArrayList(myArray); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-01-28T01:55:27.553

这个使用 Java 8 中包含的 Stream API 的简单代码创建了一个包含数组元素的可变列表（或视图）：

```
Foo[] array = ...;
List<Foo> list = Stream.of(array).collect(Collectors.toCollection(ArrayList::new)); 
```

或者，同样有效：

```
List<Foo> list = Arrays.stream(array).collect(Collectors.toCollection(ArrayList::new)); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-11-18T18:23:00.937

如果您使用的是[Eclipse Collections](http://www.eclipse.org/collections/)（以前称为[GS Collections](https://github.com/goldmansachs/gs-collections)），则可以使用`FastList.newListWith(...)`或`FastList.wrapCopy(...)`。

这两种方法都采用可变参数，因此您可以内联创建数组或传入现有数组。

```
MutableList<Integer> list1 = FastList.newListWith(1, 2, 3, 4);

Integer[] array2 = {1, 2, 3, 4};
MutableList<Integer> list2 = FastList.newListWith(array2); 
```

这两种方法的区别在于数组是否被复制。`newListWith()`不复制数组，因此需要恒定的时间。如果您知道数组可能在其他地方发生突变，则应避免使用它。

```
Integer[] array2 = {1, 2, 3, 4};
MutableList<Integer> list2 = FastList.newListWith(array2);
array2[1] = 5;
Assert.assertEquals(FastList.newListWith(1, 5, 3, 4), list2);

Integer[] array3 = {1, 2, 3, 4};
MutableList<Integer> list3 = FastList.wrapCopy(array3);
array3[1] = 5;
Assert.assertEquals(FastList.newListWith(1, 2, 3, 4), list3); 
```

**注意：**我是 Eclipse Collections 的提交者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-25T21:52:37.403

```
myNewArrayList = new ArrayList<>(Arrays.asList(myArray)); 
```

# .htaccess - .htaccess 重定向 404 错误

> ID：11659176
> 
> 赞同：1
> 
> 时间：2012-07-25T21:50:06.553
> 
> 标签：.htaccess

我已经尝试了 1 到 2 个小时来解决这个问题，寻找类似的问题并尝试解决方案。这可能又是答案非常明显的事情之一。

我正在尝试将所有访问*domain.com/title/what***和*domain.com/title/* *****anotherpage的人******重定向***到 PHP 脚本，但是当我尝试访问该页面时它给了我 404 错误。****

 ****我在我的 htaccess 文件中使用此代码：

```
RewriteEngine on
RewriteRule ^/plugins/(.*)$ /yourscript.php?plugin=$1 [L] 
```

这是我的 .htaccess 文件的完整副本。

```
ErrorDocument 404 /error/404.php

#Prevent full listing of files
Options -Indexes 

#Redirect plugins
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteRule ^/plugins/(.*)$ /foobar.php?plugin=$1 [NC,L]
</IfModule>

#Hide .php extension
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php [NC,L]
</IfModule>

#compress
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript 
```

我尝试将 foobar.php 脚本放在根文件夹和文件夹名称插件中。

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T00:39:55.740

看起来一切都在正确的位置，但您可能想尝试删除正则表达式中的前导斜杠（或至少使其成为可选）：

```
RewriteRule ^/?plugins/(.*)$ /yourscript.php?plugin=$1 [L] 
```

在 htaccess 文件中，apache 在将 URI 的前缀（前导斜杠）交给 htaccess 文件中的规则之前会删除它。

* * *

> domain.com/plugins/**任何**被正确重定向的东西。但是，domain.com/ **plugins**也会被定向到脚本。相反，我希望它指向文件夹名称“plugins”中的 index.php 文件

然后你需要把上面的规则改成：

```
RewriteRule ^/?plugins/(.+)$ /yourscript.php?plugin=$1 [L] 
```

（注意`*`更改为 a`+`以匹配至少 1 个字符）。只要是有效的索引，您可能不需要添加任何更多规则`index.php`，这意味着如果您只是转到`/plugins/`apache 将自动服务器 index.php 文件。****

# php - 用 is_category() 构造一个 if 语句；在archive.php (WordPress)

> ID：11659177
> 
> 赞同：-1
> 
> 时间：2012-07-25T21:50:12.593
> 
> 标签：php, wordpress, if-statement

我正在尝试将 if 语句与 is_category() 一起使用，以便稍后构建更大的代码。我无法让代码识别 if 语句。基本上在下面我已经发布了带有注释的 if 语句的编码。它可以在没有 if 语句的情况下工作，但如果我取消注释 if 语句（和右大括号），则会出现错误并且页面不会显示。我只是在类别页面上检查它，所以我认为它应该识别出它是一个类别页面并显示帖子（如果我在“标签”存档页面等上，我可以理解这是一个问题）。为什么显示会有问题？

## 编辑

我在相关代码 BTW 之前包含了一堆代码，所以有一个上下文。当应用于页面标题（即新闻类别的存档）时，条件`if (is_category())`有效，但再往下一点它就不起作用了......

（顺便说一句，我确实知道有一个 WordPress 堆栈交换站点，但我很少在那里得到我的问题的答案。我也在那里提交了这个问题，但我认为有人也可以在这里帮助我，因为答案与 PHP 相关。谢谢！）

```
 <?php $post = $posts[0]; // Hack. Set $post so that the_date() works. ?>
  <?php /* If this is a category archive */ if (is_category()) { ?>
    <?php _e('<p>Archive for the &middot;</p>', 'life-is-simple'); ?><h1><?php single_cat_title(); ?></h1><?php _e('<p>&middot; Category...</p>', 'life-is-simple'); ?>
  <?php /* If this is a tag archive */ } elseif( is_tag() ) { ?>
    <?php _e('<p>Posts tagged &middot;</p>', 'life-is-simple'); ?><h1><?php single_tag_title(); ?></h1><p>&middot;...</p>
  <?php /* If this is a daily archive */ } elseif (is_day()) { ?>
    <?php _e('<p>Archive for </p>', 'life-is-simple'); ?><h1><?php the_time('F jS, Y'); ?></h1><p>...</p>
  <?php /* If this is a monthly archive */ } elseif (is_month()) { ?>
    <?php _e('<p>Archive for </p>', 'life-is-simple'); ?><h1><?php the_time('F, Y'); ?></h1><p>...</p>
  <?php /* If this is a yearly archive */ } elseif (is_year()) { ?>
    <?php _e('<p>Archive for </p>', 'life-is-simple'); ?><h1><?php the_time('Y'); ?></h1><p>...</p>
  <?php /* If this is an author archive */ } elseif (is_author()) { ?>
    <?php _e('<p>Archive for the author &middot;</p>', 'life-is-simple'); ?><h1><?php echo $curauth->display_name; ?></h1><p>&middot;...</p>
  <?php /* If this is a paged archive */ } elseif (isset($_GET['paged']) && !empty($_GET['paged'])) { ?>
    <?php _e('<p>Blog archives...</p>', 'life-is-simple'); ?>
  <?php } ?>

<?php if (have_posts()) : ?>

<ul style="list-style-type:none;"> 
```

```
<?php
/*if (is_category()) {*/
if ($paged == 0)
  $offset = 0;
else
  $offset = ($paged - 1) * 11;
global $post;
$category = get_the_category($post->ID);
$category = $category[0]->cat_ID;
$myposts = get_posts(array('numberposts' => 11, 'offset' => $offset, 'category__in' => array($category), 'post__not_in' => array($post->ID),'post_status'=>'publish'));
foreach($myposts as $post) :
setup_postdata($post);
/*}*/
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T01:38:33.913

like itecedor said, there's nothing problematic about your conditional ( apart from the not-so-usual but irrelevant, space after the keyword if)

i've changed the syntax for the foreach to a more conventional syntax and the 500 error is gone:

```
foreach($myposts as $post) setup_postdata($post); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T02:21:48.873

问题是你没有终止你的 foreach。If、While 和 Foreach 语句可以设置为以下两种方式之一：

**不太常见的方法：**

```
<?php
if(true) :
    do_stuff();
endif;
while(true) :
    do_stuff();
endwhile;
foreach($arr as $var) :
    do_stuff();
endforeach;
?> 
```

**常用方法：**

```
<?php
if(true)
{
    do_stuff();
}
while(true)
{
    do_stuff();
}
foreach($arr as $var)
{
    do_stuff();
}
?> 
```

你应该像这样设置你的代码：

```
<?php
if (is_category())
{
    $offset = $paged ? ($paged - 1) * 11 : 0;
    global $post;
    $category = get_the_category($post->ID);
    $category = $category[0]->cat_ID;
    $myposts = get_posts(array('numberposts' => 11, 'offset' => $offset, 'category__in' => array($category), 'post__not_in' => array($post->ID),'post_status'=>'publish'));
    foreach($myposts as $post)
    {
        setup_postdata($post);
        the_title(); //JUST SO YOU KNOW IT'S WORKING
    }
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:09:37.830

问题不在于 if is_category() 检查。您可以通过简单地尝试验证自己：

```
if(is_category()) {
  echo "category!";
} 
```

当我尝试按原样运行您的代码时，我也“遇到了错误”。这种类型的超级错误意味着 PHP 格式错误，以至于 PHP 甚至无法告诉您在哪里寻找解决问题的方法。

这是我重写代码以使其运行的方式：

```
if ($paged == 0) {
  $offset = 0;
}
else {
  $offset = ($paged - 1) * 11;
}

global $post;
$category = get_the_category($post->ID);
$category = $category[0]->cat_ID;
$myposts = get_posts(array('numberposts' => 11, 'offset' => $offset, 'category__in' =>   array($category), 'post__not_in' => array($post->ID),'post_status'=>'publish'));
foreach($myposts as $post) {
  setup_postdata($post);
} 
```

# python - 静态文件的“pip install”和“setup.py install”有什么区别

> ID：11659179
> 
> 赞同：1
> 
> 时间：2012-07-25T21:50:13.827
> 
> 标签：python, pip, setuptools

我对 pip && setuptools 有疑问。我在这里有一个简单的项目：[https ://github.com/rmuslimov/rapidlog](https://github.com/rmuslimov/rapidlog)

如果我发出这些命令：

```
mkvirtualenv rtests
pip install git+file:///%path_to_this_project%
rapidagent # This my app in this project 
```

它可以正常工作并创建模板和静态文件。

如果我做：

```
mkvirtualenv rtests
cd %path_to_this_project%
python setup.py install
rapidagent 
```

它无法安装我的模板和静态文件数据。所以我无法启动我的应用程序。

这是我的 setup.py 文件的结尾：

```
entry_points={
    'console_scripts': [
        'rapidagent = rapidlog.web.webagent:main'
        ],
    },
include_package_data=True,
data_files=[('rapidlog/web/templates', ['rapidlog/web/templates/index.html']),
            ('rapidlog/web/static/css', glob('rapidlog/web/static/css/*')),
            ('rapidlog/web/static/images', glob('rapidlog/web/static/images/*')),
            ('rapidlog/web/static/js', glob('rapidlog/web/static/js/*')),
            ],
install_requires=[
    'pika>=0.9.5',
    'tornado>=2.3',
    'wsgiref>=0.1.2',
],
classifiers=[
    'License :: OSI Approved :: BSD License',
    'Programming Language :: Python'
    ] 
```

pip 调用了什么特殊命令？解决这个问题的更好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T13:29:36.530

我发现您的`os.path.join`调用与调用 python 的当前目录相关。所以，第一件事是：

```
web/webagent.py: Change os.path.join('templates') and os.path.join('static') to be absolute 
```

我刚刚向您发送了[包含此更改的拉取请求](https://github.com/rmuslimov/rapidlog/pull/1)。

用你的下一步更新我。

# mysql - Mysql Max 与 Group by 查询

> ID：11659182
> 
> 赞同：0
> 
> 时间：2012-07-25T21:50:25.750
> 
> 标签：mysql

我有一个可能是“经典”的 mysql max/group by question 这是我的基本表结构。

```
id | userid | username | date | score
1 | 1111 | joe | 2012-05-16 | 1000
2 | 2222 | john | 2012-03-17 | 2000
3 | 3333 | jill | 2012-02-11 | 3000
4 | 2222 | john | 2012-12-25 | 5000
5 | 3333 | jill | 2012-04-08 | 4000
6 | 1111 | joe | 2012-06-17 | 1000
7 | 1111 | joe | 2012-01-14 | 500
8 | 2222 | john | 2012-06-29 | 6000
9 | 4444 | bill | 2012-08-08 | 4000 
```

我想获得每个用户的最高分。每个用户在结果中应该只显示一个分数。

```
My desired result is
id | userid | username | date | score
8 | 2222 | john | 2012-06-29 | 6000
9 | 4444 | bill | 2012-08-08 | 4000
5 | 3333 | jill | 2012-04-08 | 4000
6 | 1111 | joe | 2012-06-17 | 1000 
```

如果用户的最高分多次出现（例如 id 1&6），则应显示最近的日期。

这是我当前的查询

```
select s.*
from scores as s
inner join (
    select userid, max(score) as max_score
    from scores
    group by userid
    ) t on s.userid = t.userid and s.score = t.max_score
order by score DESC, date DESC 
```

哪个返回不正确的结果

```
id | userid | username | date | score
8 | 2222 | john | 2012-06-29 | 6000
9 | 4444 | bill | 2012-08-08 | 4000
5 | 3333 | jill | 2012-04-08 | 4000
6 | 1111 | joe | 2012-06-17 | 1000
1 | 1111 | joe | 2012-05-16 | 1000 
```

关于如何解决这个问题的任何建议？

我还应该提到，用户标识和用户名之间的关系不是一对一的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:00:15.497

这应该会给你你正在寻找的结果。由于 MySql 没有`PARTITION`SQL SERVER 的功能，因此我使用了一种已知的解决方法。

```
SELECT tmp.id, tmp.userid,tmp.username,tmp.`date`,score FROM
   (SELECT *, IF(@prev<>userid, @rownum := 1, @rownum := @rownum+1 ) AS rank,
           @prev := userid
    FROM scores s0
    JOIN (SELECT @rownum := NULL, @prev := 0) AS r
    ORDER BY s0.userid, s0.score DESC, s0.`date` DESC
   ) AS tmp
WHERE tmp.rank=1
ORDER BY tmp.score DESC, tmp.`date` desc 
```

# css - 在响应式设计中使用 % 单位有什么意义？

> ID：11659183
> 
> 赞同：5
> 
> 时间：2012-07-25T21:50:27.480
> 
> 标签：css, responsive-design, media-queries

我正在重新设计我的网站，因为在不同的分辨率（除了设备）上看起来很糟糕，大多数指南和教程都依赖于`%`而`em`不是固定值。我还在学习这个，所以我正在阅读周围的一切。

认为这可以解决不同显示尺寸的问题，但同样：我们必须制作更多的 CSS 来解决一些特定问题。

如果我需要为额外的显示尺寸添加媒体查询，那为什么还要使用 % 呢？使用 % 真的可以减少编码吗？确定需要为某些尺寸添加一些额外的 css 还是我做错了什么？

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:01:51.887

使用`em`大小的目的是让您的设计基于用户选择的字体大小。我可能会使用较大的字体，因为我的显示器很大且视力不佳，而其他人可能更喜欢较小的字体。通过使用`em`单位，您的设计将适应我们的字体偏好并相应地调整大小，而不是将字体大小强制为给定标准（例如“12 点字体”）。

以类似的方式，百分比 (%) 单位允许您的设计响应不同的浏览器尺寸。与`em`单位一起使用，这将允许基于文本的元素响应任意字体大小选择，并允许布局元素响应任意浏览器大小。

为所有媒体类型设计一个响应式设计是完全可以接受的。当您希望在不同设备上使用不同的显示样式时，媒体查询旨在*“*[支持](http://www.w3.org/TR/css3-mediaqueries/)”不同的显示尺寸。一个例子是在印刷媒体上使用衬线字体，在显示媒体上使用无衬线字体，因为可用性研究表明，这些字体更适合这些类型的媒体。

 *此外，它还允许您为某些情况（例如移动设备）进行自定义样式，在这些情况下，您可能需要考虑用户的带宽有限，并且可能会减少额外的图像。或者，如果您想在某些手机提供的显微屏幕上以完全不同的布局显示您的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:05:37.927

戴安娜，

我很高兴我遇到了这个问题。我刚刚上传了我的第一个响应式设计，当涉及到字体大小和宽度时，它是基于百分比的 90%。

查看以下内容： [http ://www.noxinnovations.com/portfolio/responsive/](http://www.noxinnovations.com/portfolio/responsive/)

显然，它看起来并不令人惊奇，而且图像看起来很不合适......但请帮我一个忙，调整您的浏览器窗口的大小，慢慢地让它变得越来越小。我通过设置百分比宽度来做到这一点！

相信我，我试过用像素做这个响应式设计测试，结果并不好。百分比宽度确保无论分辨率和/或像素尺寸（本身）如何，设计都将始终迎合屏幕尺寸。此外，我不必使用一个 CSS3 媒体查询，但我强烈建议您仅在需要时使用 CSS3 媒体查询。

在我看来，我可能应该有一个更大屏幕的媒体查询。

我希望这对你有帮助，就像它对我有帮助一样！谢谢你，亚伦

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T22:01:33.057

例如。

您的网站标题宽度为 950 像素；但在移动设备中，它可能适合 450 像素；

因此，您使用 media-query 重新定位一些元素并处理一些大小问题并将标题宽度设置为 450px；

但是，如果您使用 % 值，则可以将标题 div 设置为在其父级中具有 100% 的宽度基数。所以你只能改变 body 或一些容器 div 的宽度，所有的孩子都会适应。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-25T21:59:55.630

`%`允许您的网站响应用户的查看方式。假设您有一个`div`at `100%`。它会填满整个部分，无论它是在手机上还是桌面上。

也可以为尺寸添加额外的 CSS。据我所知，您可以显示一些元素，一些元素`%`具有固定`px`值，尽管它们*可能会*根据页面的设置方式或正在查看的内容而发生冲突。*

# eclipse - 使用 svn.... IntelliJ 或 Eclipse 添加构建所需的额外文件

> ID：11659186
> 
> 赞同：0
> 
> 时间：2012-07-25T21:50:41.273
> 
> 标签：eclipse, svn, intellij-idea

好了朋友们，

我已经使用 svn 检查了一个项目，但我无法构建，因为我收到构建路径错误。我需要访问一个名为“common”的文件夹，其中包含我需要构建的其他资源，它是服务器上不属于项目的单独目录。如何包含该目录以便构建？对不起，我是 SVN 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:02:52.343

在 intellij 中，您可以打开“项目结构”并导航到您的模块。转到“来源”选项卡，您可以在那里添加其他路径。这是假设您可以从要构建的位置访问您的“公共”目录。

# android - 如何让我的应用程序向桌面程序发送消息？

> ID：11659190
> 
> 赞同：1
> 
> 时间：2012-07-25T21:51:19.270
> 
> 标签：android, iphone, http

我正在开发一个移动应用程序（Android 和 iOS）来接收餐厅的外卖订单。该应用程序允许用户从菜单中选择东西，当他完成后，我需要将他的订单发送到我将在餐厅的台式计算机上运行的程序。

**到目前为止，我的第一个也是唯一的想法是**：

1.  在我的服务器上有一个 HTML 页面，餐厅的桌面程序可以每秒检查一次是否有新订单。
2.  让应用程序将 HTTP POST 消息发送到我将在我的服务器上运行的 PHP 脚本。PHP 脚本收到消息后会在 HTML 页面上显示订单十分钟左右。
3.  在此期间，桌面程序将注意到新订单并将其显示给餐厅员工。

中间使用服务器是因为餐厅有两个分店，在不同的城市，所以使用服务器，两家餐厅可以检查相同的 HTML 页面，只在自己的城市挑选订单。

我的解决方案可行还是应该尝试其他方法？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:01:17.087

听起来您想实现一个可以向其发送请求的 API。在 Java 中，您可以执行以下操作来发送请求：

```
HttpURLConnection connection = (HttpURLConnection) new URl("yourURL").openConnection();
connection.setRequestMethod("POST");
connection.setDoOutput(true); // this allows you to send data
connection.getOutputStream().write(yourOutgoingData);
InputStream is = connection.getInputStream(); // this actually sends the request and fetches any return data 
```

显然，您必须在`Try/Catch`. 我还建议，而不是在中间使用服务器，是否不可能使用[DynDNS](http://dyn.com/dns/)或[No-IP](http://www.no-ip.com/)以便您可以将请求发送到正确的计算机？这些服务允许您将永久 URL (yourname.dyndns.org) “附加”到您更改的 IP 地址，只需在您餐厅的路由器中输入您的登录详细信息，当 IP 更改时，它将被发送到 DynDNS 或 No-IP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:16:49.877

我的建议是让网络服务器处理所有订单。因此，您将拥有您的移动设备，该设备将接受订单，然后将其发布到服务器的数据库中。这将需要一些包含数据库的 Web 界面。

然后我会编写一个单独的桌面客户端来轮询服务器以获取新的数据更改。发现更改后，它将下载该新条目并将其显示给员工。

所以它看起来像：

```
Phone ------>
Phone ------>              -------> Desktop Client
Phone ------> <Web server>
Phone ------>              -------> Desktop Client
Phone ------> 
```

# java - Java：开发应用程序（桌面）并使其只能在 Linux 上执行，而不能在其他平台上执行

> ID：11659192
> 
> 赞同：-2
> 
> 时间：2012-07-25T21:51:25.080
> 
> 标签：java, mono

但是这里有个奇怪的问题，但是我有一个使用 .net 框架开发的现有 Windows 产品，我想为 java 创建一个等价物 - 我不想使用单声道

Java实际上将在每个具有JVM的平台上执行，无论如何要锁定它？

例如，我不希望它可以在 Windows 上运行。

关于单声道，我没有什么反对意见，但 Java 似乎有更多兼容的库。有人对此有任何意见吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T21:54:13.173

您可以[`System.getProperty("os.name")`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#getProperty(java.lang.String))在 main 方法中使用来检测操作系统，如果它不是您所期望的，则退出应用程序。

# powershell - 从 Active Directory 用户对象中检索 RDN

> ID：11659196
> 
> 赞同：1
> 
> 时间：2012-07-25T21:51:33.627
> 
> 标签：powershell, active-directory, powershell-2.0

是否可以在属性完整的情况下检索 Active Directory 中用户对象的 RDN。

我对此进行了大量阅读，发现一个 AD 用户对象将 RDN 存储在一个名为“name”的属性中。假设 name (rdn) 属性的值应该类似于 name = "cn=Smith, Joe"。cn 属性是应该返回的内容的一部分。但是，每当我检索对象的名称属性时，“cn=”似乎总是丢失。例如

```
$foo = get-aduser -filter 'Name -like "Smith, Joe"' 
```

`$foo.name`

`"Smith, Joe"`不会返回`"cn=Smith, Joe"`。有没有办法查询并让完整的 RDN 返回？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-11T17:43:34.803

另一种方法是获取对象的完整 DN，拆分 DN，并显示结果数组中的第一个元素，这将是 RDN，CN= 或其他，取决于对象

```
$((foo.distinguishedname).split(","))[0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T03:32:51.530

不是真正的答案，而是信息：

**首先，RDN 属性的 attributeId 由模式固定：** 从 RDN 的角度来看，Active-Directory 继承自 X500 标准。也就是说你没有选择你想要创建RDN的属性（在其他LDAP目录中你可以）。在 Active-Directory 中，RDN 属性在类模式中由[rDNAttID 给出](http://msdn.microsoft.com/en-us/library/cc220795%28v=prot.10%29.aspx)，它指定 RDN 属性的 attributeId。如果您查看该类的架构，`user`它是`CN`.

所以你可以使用：

```
"CN=$((get-aduser 'Smith, Joe').Name)" 
```

**其次进行以下实验：** 在 OU 中创建一个名为“Mananegement”的用户，您现在有以下`CN=MAnagement,OU=MyOU,...`DN`OU=MAnagement,OU=MyOU,...`一个错误。这个错误让我相信 Active-Directory 以某种方式将“Mananegement”视为 RDN，而不是像其他目录那样将“CN=Mananegement”视为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-21T21:15:13.383

$current.Substring($current.IndexOf('OU='))

# android - 独立于屏幕方向的布局

> ID：11659201
> 
> 赞同：0
> 
> 时间：2012-07-25T21:52:04.517
> 
> 标签：android

我想从屏幕方向进行独立布局。

像这样的东西：

[![http://cs302715.userapi.com/v302715020/1953/RK2fHUV7svY.jpg](../Images/1a4613dbfbfa84039081799a7e6bd8fb.png)](https://i.stack.imgur.com/2vWCL.jpg)
[（来源：[userapi.com](http://cs302715.userapi.com/v302715020/1953/RK2fHUV7svY.jpg)）]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:36:10.363

你的意思是，你想拥有单独的纵向和横向视图布局文件？然后你应该在 res 下的 layout 和 layout-land 目录中创建两个不同的文件。

```
res
 |_ layout
 |_ layout-land 
```

Android 会根据设备配置调用相应的布局。

要保留数据，您可以使用

```
 @Override
    public Object onRetainNonConfigurationInstance() {
        Bundle bundle = new Bundle();       
        return bundle;
    } 
```

并在 onCreate() 中获取捆绑包

```
final Bundle savedBundle = (Bundle)getLastNonConfigurationInstance(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T19:09:32.723

好的，所以您想要的与横向模式无关，您只需要按钮文本，使其看起来处于横向模式。我可以建议一些有点像黑客的东西。

为此，您可以像往常一样让按钮具有更高的高度和更小的宽度，并将它们与屏幕的左右边缘对齐。

对于按钮文本，您需要制作文本的 .jpg 或 .png，旋转它并将其设置为按钮的背景。（如果您动态更改按钮文本，则需要其他文本快照）。这看起来不太好，但它是做你正在寻找的方法之一。

# java - GWT - 使用 ImageCell 的 CellTable/DataGrid

> ID：11659205
> 
> 赞同：2
> 
> 时间：2012-07-25T21:52:22.683
> 
> 标签：java, image, gwt, celltable

我想`ImageCell`在`CellTable`. 我的代码如下：

```
Column<Message, String> myColumn = new Column<Message, String>(new ImageCell()) {
    @Override
    public String getValue(Message details) {
        Image image =  new Image (ClientResources.of().image1());
        return image.getUrl();      
    }
}; 
```

当我运行它时，它会显示以下警告：

> [WARN] [adminportal] - URL 属性上下文中带有变量的模板：模板代码生成器无法保证模板的 HTML 安全性——请手动检查或使用 SafeUri 在 URL 属性上下文中指定参数

我的问题是如何安全地将 url 作为字符串值返回。之前看过一个关于使用imagecell的例子，返回值是字符串。我现在找不到了。谁能告诉我如何解决这个问题。

注意：如果我想在 celltable 中使用 imagecell 并且返回值是字符串，我只想知道如何解决这个问题。我知道如何使用`imageresourcecell`来达到相同的目标。另外，我知道我可以将类型`getValue()`从 string 更改为 safeHtml 以实现目标。但我真的很想知道如何通过使用 imagecell 和 string 类型来实现这一点，`getValue()`因为我之前看到过一个关于这个的例子并且我成功地尝试过。只是不记得我在这里做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T09:10:25.520

没有办法*解决*这个问题（删除警告）：使用 a`String`作为模板的一部分本质上是不安全的，GWT 会警告您。如果您绝对确定您的值的安全性，那么您可以放心地忽略警告，但它们仍会发出。

没有这些警告的唯一方法是使用 a `SafeUri`，即使用[`SafeImagecell`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/cell/client/SafeImageCell.html). 然后由您来保证您的 URL 的安全性，具体取决于您用于构建的方法`SafeUri`（查看`UriUtils`）

# jquery - 从未达到 JQuery Ajax 成功

> ID：11659206
> 
> 赞同：2
> 
> 时间：2012-07-25T21:52:27.497
> 
> 标签：jquery

我有这样的 AJAX 语句：

```
$.ajax({
            type: "POST",
            dataType: 'json',
            url: "DBDeleteList.php",
            data: {listID: listID},
            success: function(html){
                /* Succesfully Updated DB */
                alert( 'Saved!' );
                $(this).parents('li').remove();
                $('#sortableLoader').load('index.php #sortableMenu');
            }
}); 
```

它工作正常并触发 PHP 文件和所有内容，数据库修改工作正常。

唯一的问题是“成功：”部分永远不会触发，即使它是成功的。

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T21:59:17.020

你有一个你没有看到的返回错误。您正在正确地发布到 php，但是无论您在发布后返回什么，您的 ajax 调用都不喜欢。在你的成功函数之后包括这样的东西来调试：

```
error: function (jqXHR, exception) {
    if (jqXHR.status === 0) {
        alert('Not connect.\n Verify Network.');
    } else if (jqXHR.status == 404) {
        alert('Requested page not found. [404]');
    } else if (jqXHR.status == 500) {
        alert('Internal Server Error [500].');
    } else if (exception === 'parsererror') {
        alert('Requested JSON parse failed.');
    } else if (exception === 'timeout') {
        alert('Time out error.');
    } else if (exception === 'abort') {
        alert('Ajax request aborted.');
    } else {
        alert('Uncaught Error.\n' + jqXHR.responseText);
    }
} 
```

我也会使用萤火虫来帮助查看正在发生的事情

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:02:44.973

仍然不明白`$(this)`那个ajax函数调用里面指的是什么，也就是说我明白它指的是什么，但我怀疑它有没有父母？

`html`当您期望 json 数据时，为什么要在成功处理程序中为返回的数据使用变量。

您确定这不是格式错误的 json 导致解析错误的问题吗？

尝试省略数据类型并查看它返回的内容，并添加一个错误处理程序：

```
$.ajax({
    type: "POST",
    url: "DBDeleteList.php",
    data: { listID: listID },
}).done(function(html) {
     console.log(html);
}).fail(function(a,b,c) {
     console.log('error'+'-=-'+a+'-=-'+b+'-=-'+c);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:22:26.630

在ajax调用之前创建一个指向有问题的元素的指针，否则你成功中的“$(this)”是指xhr响应。确保响应是正确的内容类型（应用程序/json）。

```
var $el = $(this);
$.ajax({
        type: "POST",
        dataType: 'json',
        url: "DBDeleteList.php",
        data: {listID: listID},
        dataType:"json",
        contentType : 'application/json',
        processData:false,
        success: function(html){
            /* Succesfully Updated DB */
            alert( 'Saved!' );
            $el.parents('li').remove();
            $('#sortableLoader').load('index.php #sortableMenu');
        }
}); 
```

还要验证响应的 json 是否有效。如果其中任何一个不满足，在大多数情况下，它都会默默地失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-08T19:35:55.227

就我而言，问题是一个错字。我写了`success`但是`sucess`。

# internet-explorer - IE 错误，iframe 中的自动完成框位置

> ID：11659215
> 
> 赞同：5
> 
> 时间：2012-07-25T21:53:22.097
> 
> 标签：internet-explorer, iframe, textbox, autocompletebox

经过几个小时的谷歌搜索，我发现从大约 10 年前开始就存在自动完成框错误，直到现在，在 IE9 上，该错误仍然存​​在。

* * *

问题：
当我在 iframe 中有输入：文本时，自动完成框存在定位错误 - 在 IE8 兼容模式、IE8、IE9 上测试。

* * *

问题可能与 iframe 的父类有关（注意：可能不是样式，因为我在 IE9 控制台上测试过，禁用类样式不会解决问题；另一方面，给出相同的样式但删除类**部分解决**自动完成框定位错误，不幸的是仅在 IE9 上）。

在 IE8 和 IE8 兼容模式下，尝试了同样的方法，自动完成框 bug 的位置仍然存在：有时它位于 input:text 下方 50px 左右，有时它位于 input:text 底部上方 8px 左右（如 IE9 ）。

* * *

我从谷歌结果创建的解决方案，人们建议“位置：相对；左：0；上：0；”，经过测试，不起作用。

* * *

另一个人的类似问题：[http](http://forums.asp.net/t/1538225.aspx/1)

://forums.asp.net/t/1538225.aspx/1 感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T07:04:06.780

使用位置：用 iframe 固定，不可调整大小和可移动。在我的例子中，它是一个使用 iframe 的 jquery 对话框。

仍然存在一个问题，使用鼠标滚动时，自动填充框保持在原位。

# c# - 使用 C# 的 INF 文件安装 libusb 驱动程序

> ID：11659223
> 
> 赞同：3
> 
> 时间：2012-07-25T21:53:47.400
> 
> 标签：c#, installation, driver, libusb, inf

我想在 Windows 安装程序安装期间安装第三方 libusb 驱动程序。我使用 Visual Studio 2010 创建了这个安装。

我尝试使用 SetupAPI 和 DifXAPI 通过命令行安装此驱动程序，但没有任何反应。我希望会弹出一个窗口，说明它是未签名的驱动程序，您必须单击“确定”才能继续。弹出此窗口的唯一方法是，如果我使用 C# 控制台应用程序和[P/Invoke](http://en.wikipedia.org/wiki/Platform_Invocation_Services)从 DifXApi 调用驱动程序安装代码（指向看起来像是由 inf-wizard 生成的 INF 文件），并且需要为 x64 构建项目（我需要它也适用于 32 位安装程序）。单击确定后，驱动程序从未安装。

正确安装此驱动程序的唯一方法是，如果我通过 USB 插入硬件，右键单击未知设备，然后浏览到包含驱动程序 DLL 文件、sys 文件和 INF 文件的文件夹。Windows 如何确定如何安装驱动程序？

INF 文件包含 32 位/64 位/Itanium 的驱动程序部分，但 Windows 如何知道要安装哪个部分，以及 Windows 与我在命令行中的操作有何不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T00:43:57.093

我可以使用以下代码在 32 位和 64 位 Windows 上安装驱动程序，其中`infPath`是 INF 文件的路径，并且`devices`是与 USB 设备关联的所有设备 ID 的列表：

```
[DllImport("setupapi.dll")]
public static extern bool SetupCopyOEMInf(
    string SourceInfFileName,
    string OEMSourceMediaLocation,
    int OEMSourceMediaType,
    int CopyStyle,
    string DestinationInfFileName,
    int DestinationInfFileNameSize,
    int RequiredSize,
    string DestinationInfFileNameComponent
    );

[DllImport("newdev.dll")]
public static extern bool UpdateDriverForPlugAndPlayDevices(
    IntPtr hwndParent,
    string HardwareId,
    string FullInfPath,
    uint InstallFlags,
    bool bRebootRequired
    );

[STAThread]
static void Main() {
  if (SetupCopyOEMInf(infPath, null, 0, 0, null, 0, 0, null)) {
    foreach (string device in devices) {
      UpdateDriverForPlugAndPlayDevices(IntPtr.Zero, device, infPath, 0, false);
    }
  }
} 
```

# java - 多行 Java 字符串的任何未来计划

> ID：11659225
> 
> 赞同：8
> 
> 时间：2012-07-25T21:54:30.287
> 
> 标签：java, string, multiline

本着这个问题的精神： [https ://stackoverflow.com/questions/1886966/java-string-declaration-occupying-multiple-lines](https://stackoverflow.com/questions/1886966/java-string-declaration-occupying-multiple-lines)

在 Java 的任何未来版本中是否有任何计划允许在 Java 源代码中继续字符串？

```
String haveUeverSeenLorem =
  "Lorem ipsum dolor sit amet, \
  consectetur adipisicing elit, \
  sed do eiusmod tempor incididunt \
  ut labore et dolore magna aliqua."; 
```

一种方式或另一种方式，例如上面的例子。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-25T22:33:52.843

它被提议[包含在 Java 7 中](http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/000087.html)，但被拒绝了。

[它再次被提议用于 Java 8](http://mail.openjdk.java.net/pipermail/coin-dev/2011-August/thread.html#3306)，但没有进入最终版本。

[Java 9 的 JEP 213: Milling Project Coin](http://openjdk.java.net/jeps/213)也不包含任何关于多字符串的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-25T22:05:55.503

这似乎不太可能。[正如对Java 7 - Multiline strings](https://stackoverflow.com/questions/4581338/java-7-multiline-strings)的回答中所述，他们没有为 Java 7 做好准备

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-13T09:12:34.590

**2018 年 1 月更新：**

看看[JEP 326: Raw String Literals](http://openjdk.java.net/jeps/326)。

计划的语法将是：

```
String haveUeverSeenLorem = `Lorem ipsum dolor sit amet, 
consectetur adipisicing elit, 
sed do eiusmod tempor incididunt 
ut labore et dolore magna aliqua.`; 
```

也许它将被集成到 Java 的下一个版本中（2018 年 9 月的 Java 11 会很棒）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-09T20:58:13.373

**2020 年 4 月更新**

[JEP 326: Raw String Literals](https://openjdk.java.net/jeps/326)被撤回并被替换为

[JEP 368：文本块（第二次预览）](https://openjdk.java.net/jeps/368)。

**此功能作为Java 14**中的预览语言功能发布。

支持的语法是：

```
String json = """
              {
                 "id": 10,
                 "name": "Joe",
                 "birthday": "1970-01-01"
              }
              """; 
```

`"""`（胖定界符）用作多行字符串的定界符。

# database - 保持数据库连接打开是否昂贵？

> ID：11659228
> 
> 赞同：9
> 
> 时间：2012-07-25T21:54:41.873
> 
> 标签：database, session

我正在和几个软件开发人员开会，并被建议在我的应用程序代码中尽快关闭数据库连接？有人可以告诉我在应用程序中保持连接打开有什么危害。

我正在从数据库的单个表中读取数据

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T21:59:11.230

把它想象成公共汽车上的座位。

当您打开连接时，您会填满这些座位 - 最终，公共汽车已满并且不再接受乘客（或打开更多数据库连接）。任何时候公共汽车因为满员而不得不拒绝乘客，该乘客必须等待另一辆公共汽车过来。

通过在完成连接后关闭连接，您可以为更多连接腾出空间——这意味着更多需要与数据库交互的程序可以做他们需要做的事情，而无需等待连接释放。不关闭连接意味着数据库需要弄清楚如何处理周围的所有连接，如果您的数据库没有像打开新连接一样快地关闭连接，这可能会导致问题。

当您使用连接池时，这种情况会发生变化（请参阅下面的评论）；在这些情况下，您会希望您的池为您处理打开和关闭连接。如果您没有汇集您的连接，那么让它们保持打开的时间超过您需要的时间就是浪费资源。

# jquery - jQuery 可排序代码的行为不像我预期的那样

> ID：11659229
> 
> 赞同：0
> 
> 时间：2012-07-25T21:54:43.110
> 
> 标签：jquery

我正在使用 jQuery 允许在两个列表之间拖放，但我没有得到我期望的行为。

每个列表都有两对，id`teams_in_set<set-number>`和`teams_not_in_set<set-number>`，类的所有成员`connected-sortable`。页面上将有任意数量的这些配对，最后的集合编号为 0，表示正在创建一个新集合（与正在编辑的现有集合相反）。

我正在使用以下功能进行设置`$(document).ready`：

```
 var teams_in_set_pattern = /^teams_in_set(\d*)$/;
    $(function() {
        var connected_list = $(".connected-sortable");
        for (var i = 0; i < connected_list.length; i++) {
            var id = connected_list[i].id;
            if (teams_in_set_pattern.test(id)) {
                var set_num = id.match(teams_in_set_pattern)[1];
                var teams_in = "#teams_in_set" + set_num;
                var teams_out = "#teams_not_in_set" + set_num;

                if (set_num > 0) {
                    $(teams_in + ", " + teams_out).sortable({
                        revert: true,
                        connectWith: ".connected-sortable", 
                        cursor: 'move', 
                        receive: function(event, ui) {
                            update_teams(set_num);
                        } 
                    }).disableSelection();
                }
                else {
                    $(teams_in + ", " + teams_out).sortable({
                        revert: true,
                        connectWith: ".connected-sortable", 
                        cursor: 'move', 
                    }).disableSelection();
                }
            }
        }
    }); 
```

这个想法是，当一个团队从一个列表移动到另一个列表时，`update_teams(set_num);`会调用该行，触发一些更新数据库的 Ajax。问题是变量`set_num`；似乎不是保留`receive:`填充时的值，而是具有上次设置的值，最终始终为 0。

我有什么误解？我需要做什么才能获得我想要的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T02:03:17.090

这是异步 Javascript 中的常见问题。到 update_teams 运行时，循环已经运行。

参见类似的问题：[循环内的 JavaScript 闭包 – 简单实用的示例](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)

我通常将问题代码移到它自己的函数中，例如

```
function doIt(teams_in, teams_out, set_num) {
   if (set_num > 0) {
                $(teams_in + ", " + teams_out).sortable({
                    revert: true,
                    connectWith: ".connected-sortable", 
                    cursor: 'move', 
                    receive: function(event, ui) {
                        update_teams(set_num);
                    } 
                }).disableSelection();
            }
    else {
                $(teams_in + ", " + teams_out).sortable({
                    revert: true,
                    connectWith: ".connected-sortable", 
                    cursor: 'move', 
                }).disableSelection();
    }
} 
```

# visual-studio-2010 - Visual Studio 2010 - 更改依赖项目的 exe 文件名

> ID：11659231
> 
> 赞同：0
> 
> 时间：2012-07-25T21:54:54.257
> 
> 标签：visual-studio-2010

我在 VS2010 中有两个项目。第一个是依赖于第二个具有 DLL 的 GUI。我没有正确命名它们是一个错误。

现在我想更改两者的名称，我可以通过更改程序集来更改第二个项目的名称/dll 名称。但是当我改变第一个组件时，它不起作用。编译失败。如何更改两者的 exe 名称/原始文件名？

ActionLog 是我的第一个 GUI 项目，我正在尝试将其重命名为 ActionLog1。现在只是为了测试。用 xml 定义的 GUI。

```
 ------ Build started: Project: ActionLog, Configuration: Debug x86 ------
C:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml.cs(24,13): error CS0103: The name 'InitializeComponent' does not exist in the current context
C:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml.cs(26,18): error CS1061: 'ActionLog.MainWindow' does not contain a definition for 'SearchBox' and no extension method 'SearchBox' accepting a first argument of type 'ActionLog.MainWindow' could be found (are you missing a using directive or an assembly reference?)
C:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml.cs(27,18): error CS1061: 'ActionLog.MainWindow' does not contain a definition for 'AllContacts' and no extension method 'AllContacts' accepting a first argument of type 'ActionLog.MainWindow' could be found (are you missing a using directive or an assembly reference?)
C:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml.cs(74,91): error CS1061: 'ActionLog.MainWindow' does not contain a definition for 'SearchBox' and no extension method 'SearchBox' accepting a first argument of type 'ActionLog.MainWindow' could be found (are you missing a using directive or an assembly reference?)
C:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml.cs(89,13): error CS0103: The name 'ContactsList' does not exist in the current context
C:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml.cs(97,17): error CS0103: The name 'ContactsList' does not exist in the current context
C:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml.cs(121,13): error CS0103: The name 'ButtonClose' does not exist in the current context
C:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml.cs(126,13): error CS0103: The name 'ButtonClose' does not exist in the current context
c:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml(240,134): error CS1061: 'ActionLog1.MainWindow' does not contain a definition for 'Grid_MouseLeftButtonDown' and no extension method 'Grid_MouseLeftButtonDown' accepting a first argument of type 'ActionLog1.MainWindow' could be found (are you missing a using directive or an assembly reference?)
c:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml(241,134): error CS1061: 'ActionLog1.MainWindow' does not contain a definition for 'Grid_MouseLeftButtonDown' and no extension method 'Grid_MouseLeftButtonDown' accepting a first argument of type 'ActionLog1.MainWindow' could be found (are you missing a using directive or an assembly reference?)
c:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml(242,107): error CS1061: 'ActionLog1.MainWindow' does not contain a definition for 'ButtonClose_MouseLeftButtonDown' and no extension method 'ButtonClose_MouseLeftButtonDown' accepting a first argument of type 'ActionLog1.MainWindow' could be found (are you missing a using directive or an assembly reference?)
c:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml(242,92): error CS1061: 'ActionLog1.MainWindow' does not contain a definition for 'ButtonClose_MouseEnter' and no extension method 'ButtonClose_MouseEnter' accepting a first argument of type 'ActionLog1.MainWindow' could be found (are you missing a using directive or an assembly reference?)
c:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml(242,92): error CS1061: 'ActionLog1.MainWindow' does not contain a definition for 'ButtonClose_MouseLeave' and no extension method 'ButtonClose_MouseLeave' accepting a first argument of type 'ActionLog1.MainWindow' could be found (are you missing a using directive or an assembly reference?)
c:\Users\admin\Proj\project-7440\ActionLog\MainWindow.xaml(244,131): error CS1061: 'ActionLog1.MainWindow' does not contain a definition for 'Grid_MouseLeftButtonDown' and no extension method 'Grid_MouseLeftButtonDown' accepting a first argument of type 'ActionLog1.MainWindow' could be found (are you missing a using directive or an assembly reference?)

Compile complete -- 14 errors, 0 warnings 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:34:34.343

我不确定我是否完全了解您的情况，但这里有一个可以遵循的策略：

但是，在开始之前，请确保**备份整个解决方案**！（或者更好的是，使用版本控制。）

首先处理您的依赖项目：

1.  重命名项目。
2.  转到属性/应用程序并重命名“程序集名称”和“默认命名空间”以匹配您的项目名称。
3.  对整个项目进行查找/替换，用新命名空间替换原始命名空间的所有实例（使用“仅全词”和“匹配大小写”以确保安全）。
4.  编译。

现在处理您的 GUI 项目：

1.  在 References 文件夹中找到对原始依赖项目的引用并将其删除。
2.  重命名项目。
3.  转到属性/应用程序并重命名“程序集名称”和“默认命名空间”以匹配您的项目名称。
4.  右键单击 References 文件夹并将引用重新添加到重命名的依赖项目。
5.  为您的整个项目执行两次查找/替换操作：

    *   第一个应该用新的命名空间替换依赖项目的命名空间。

    *   第二个应该用新的命名空间替换您的 GUI 项目的命名空间。

6.  编译。

# jsp - 使用 Servlet 过滤器修改 HttpServletRequest 参数似乎不起作用

> ID：11659232
> 
> 赞同：3
> 
> 时间：2012-07-25T21:54:55.523
> 
> 标签：jsp, servlets

我需要删除/修改一些`HttpServletRequest`参数。我试图通过使用`Filter`基于我几天前发布的[问题来做到这一点。](https://stackoverflow.com/q/11304100/1391249)

在 中`Filter`，我试图`HttpServletRequest`通过继承`HttpServletRequestWrapper`类来包装 ，如下所示。

```
private final static class FilteredRequest extends HttpServletRequestWrapper {

    public FilteredRequest(ServletRequest request) {
        super((HttpServletRequest) request);
    }

    @Override
    public String getParameter(String paramName) {
        return super.getParameter(paramName);
    }

    @Override
    public String[] getParameterValues(String paramName) {
        return super.getParameterValues(paramName);
    }

    @Override
    public Map getParameterMap() {
        Map<Object, Object> parameterMap = new HashMap<Object, Object>();
        Map originalParameterMap = super.getParameterMap();

        for (Object o : originalParameterMap.entrySet()) {
            Map.Entry<Object, Object> pairs = (Entry<Object, Object>) o;
            parameterMap.put(pairs.getKey(), pairs.getValue());
        }
        return parameterMap;  //Returning a modifiable ParameterMap.
    }
} 
```

它是类中的内部`Filter`类。在`doFilter()`方法中，

```
chain.doFilter(new FilteredRequest(request), (HttpServletResponse)response); 
```

正在调用上述类的构造函数（包装请求）。

* * *

**现在，我希望在我的 Spring MVC 控制器类**中修改/取消设置任何请求参数。我正在尝试删除控制器类中的参数，如下所示。

```
Map requestMap=request.getParameterMap();
requestMap.remove("txt_country_name"); 
```

或者，

```
requestMap.put("txt_country_name", null); 
```

因此，请求参数`txt_country_name`应该从 中删除，`HttpServletRequest`但不会被删除（也不会引发任何异常，例如“*不允许对锁定的 ParameterMap 进行修改*”）。我在这里想念什么？我走错路了吗？

顺便说一句，*在整个应用程序中始终创建/使用请求属性似乎不是最好的解决方案*。

[我需要**在 Spring MVC 控制器类**中而不是在`Filter`自身中删除/修改请求参数]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:02:33.230

您的 remove 方法修改了由`getParameterMap()`. 但是下一次调用会`getParameterMap()`重建一个新的可变映射，其中包含包装查询的所有参数。

可变映射应该在构建时`FilteredRequest`构建，并且应该存储在实例字段中。

# objective-c - NSTokenField 选择

> ID：11659237
> 
> 赞同：1
> 
> 时间：2012-07-25T21:55:39.350
> 
> 标签：objective-c, cocoa, nstextfield, nstokenfield

我以前从未使用过 NSTokenFields，所以我查看了 Token Field 编程指南。我已经阅读了很多关于与单个令牌进行交互的内容，但是如果我想与多个令牌进行交互怎么办？我可以通过按住 shift 一次选择多个标记，但是当我右键单击时，只有一个标记被选中。有没有办法处理多项选择？

此外，即使我可以 shift_select 多个标记，如何在不同的位置选择多个标记（通过使用命令/ctrl？）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-18T08:20:25.683

您只能通过按住 shift 键来选择连续的标记。其他一切都不起作用，因为 NSTokenField 继承自 NSTextField，它不允许多个选择范围。

# c# - SharpSvn GetFileVersions 和 GetContentStream 抛出 InvalidOperationException

> ID：11659239
> 
> 赞同：1
> 
> 时间：2012-07-25T21:55:48.527
> 
> 标签：c#, sharpsvn

我正在尝试使用 SharpSvn 来获取特定版本的文件内容。我有以下代码：

```
var svnClient = new SvnClient();
var revisionInfo = new SvnFileVersionsArgs
    {
        Start = 80088,
        End = 80093
    };

Collection<SvnFileVersionEventArgs> fileVersions;
svnClient.GetFileVersions(
    new SvnUriTarget("https://DbDiff.svn.codeplex.com/svn/DbDiffCommon/DataAccess/SqlCommand11.xml"), 
    revisionInfo,
    out fileVersions);

var stream =  fileVersions[0].GetContentStream(); 
```

但是在最后一行我得到以下异常：

```
System.InvalidOperationException was unhandled
  Message=This method can only be invoked from the eventhandler handling this eventargs instance
  Source=SharpSvn
  StackTrace:
       at SharpSvn.SvnFileVersionEventArgs.GetContentStream(SvnFileVersionWriteArgs args) in g:\dist\src\sharpsvn\commands\fileversions.cpp:line 545
       at SharpSvn.SvnFileVersionEventArgs.GetContentStream() in g:\dist\src\sharpsvn\commands\fileversions.cpp:line 534
       at SharpSvnFileVersions.Program.Main(String[] args) in c:\temp\SharpSvnFileVersions\Program.cs:line 29
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

我应该如何在每次修订时获取文件的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:01:33.420

看起来我可以`SvnClient.Write()`用来抓取文件内容：

```
SvnClient svnClient = new SvnClient();
SvnUriTarget target = new SvnUriTarget("https://DbDiff.svn.codeplex.com/svn/DbDiffCommon/DataAccess/SqlCommand11.xml", 80088);

Stream stream = new MemoryStream();
svnClient.Write(target, stream); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-26T09:28:53.637

GetFileVersions 仅对特定场景有用。Subversion 本身使用它来实现责备。我碰巧为不同的场景创建了这个测试程序：将一个文件的所有修订版迁移到新的存储库。贴在这里供其他人使用。

```
using System;
using System.IO;
using SharpSvn;
using SharpSvn.UI;

class SvnDumpFileToRepository
{
    static void Main(string[] args)
    {
        Uri uri = null;
        if (args.Length < 2
            || !Uri.TryCreate(args[0], UriKind.Absolute, out uri))
        {
            Console.Error.WriteLine("Usage: SvnDumpFileToRepository URL PATH");
        }

        using (SvnRepositoryClient repos = new SvnRepositoryClient())
        {
            repos.CreateRepository(args[1]);
        }

        Uri reposUri = SvnTools.LocalPathToUri(args[1], true);

        using (SvnClient client = new SvnClient())
        using (SvnClient client2 = new SvnClient())
        {
            SvnUI.Bind(client, new SvnUIBindArgs());

            string fileName = SvnTools.GetFileName(uri);
            bool create = true;
            client.FileVersions(uri,
                delegate(object sender, SvnFileVersionEventArgs e)
                {
                    Console.Write("Copying {0} in r{1}", fileName, e.Revision);

                    using (MemoryStream ms = new MemoryStream())
                    {
                        e.WriteTo(ms); // Write full text to memory stream
                        ms.Position = 0;

                        // And now use 'svnmucc' to update repository
                        client2.RepositoryOperation(reposUri,
                            new SvnRepositoryOperationArgs { LogMessage = e.LogMessage },
                            delegate(SvnMultiCommandClient mucc)
                            {
                                if (create)
                                {
                                    mucc.CreateFile(fileName, ms);
                                    create = false;
                                }
                                else
                                    mucc.UpdateFile(fileName, ms);
                            });
                    }
                });
        }
    }
} 
```

# python - 如何在python中将字符串列表转换为复数？

> ID：11659243
> 
> 赞同：4
> 
> 时间：2012-07-25T21:56:14.747
> 
> 标签：python

我正在尝试编写在 Python 中导入和导出复数列表的代码。到目前为止，我正在尝试使用 csv 模块。我已使用以下方法将数据导出到文件中：

```
spamWriter = csv.writer(open('data.csv', 'wb')
spamWriter.writerow(complex_data) 
```

其中复数数据是由 complex(re,im) 函数生成的列表数字。前任：

```
print complex_data
[(37470-880j),(35093-791j),(33920-981j),(28579-789j),(48002-574j),(46607-2317j),(42353-1557j),(45166-2520j),(45594-232j),(41149+561j)] 
```

要在以后导入它，我尝试以下操作：

```
mycsv = csv.reader(open('data.csv', 'rb'))
out = list(mycsv)
print out
[['(37470-880j)','(35093-791j)','(33920-981j)','(28579-789j)','(48002-574j)','(46607-2317j)','(42353-1557j)','(45166-2520j)','(45594-232j)','(41149+561j)']] 
```

（请注意，这是一个列表列表，我只是碰巧只使用了一行作为示例。）

我现在需要把它变成复数而不是字符串。我认为应该有一种方法可以像在[这个问题](https://stackoverflow.com/questions/642154/how-to-convert-strings-into-integers-in-python)中那样使用映射来做到这一点，但我不知道如何让它发挥作用。任何帮助，将不胜感激！

或者，如果有任何更简单的方法可以导入/导出我不知道的复值数据，我很乐意完全尝试其他方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-25T22:00:57.813

只需将字符串传递给[`complex()`](http://docs.python.org/library/functions.html#complex)：

```
>>> complex('(37470-880j)')
(37470-880j) 
```

就像[`int()`](http://docs.python.org/library/functions.html#int)它需要一个复数的字符串表示并解析它。您可以使用[`map()`](http://docs.python.org/library/functions.html#map)列表来执行此操作：

```
map(complex, row) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-25T22:04:43.350

```
>>> c = ['(37470-880j)','(35093-791j)','(33920-981j)']
>>> map(complex, c)
[(37470-880j), (35093-791j), (33920-981j)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T22:01:34.147

```
complex_out = []
for row in out:
    comp_row = [complex(x) for x in row]
    complex_out.append(comp_row) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T22:03:22.307

CSV 文档说：

请注意，复数是用括号括起来的。这可能会导致其他读取 CSV 文件的程序出现问题（假设它们完全支持复数）。

这应该将“out”中的元素从字符串类型转换为复数，这是给定现有代码且易于处理非复杂条目的最简单的解决方案。

```
 for i,row in enumerate(out):
      j,entry in enumerate(row):
          try:
               out[i][j] = complex(out[i][entry])
          except ValueError:
               # Print here if you want to know something bad happened
               pass 
```

否则在每一行上使用 map(complex, row) 需要更少的行。

```
 for i,row in enumerate(out):
      out[i] = map(complex, row) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-28T14:20:19.887

我认为上面的每种方法都有点复杂

最简单的方法是这个

```
In [1]: complex_num = '-2+3j'

In [2]: complex(complex_num)
Out[2]: (-2+3j) 
```

# ruby-on-rails - 如何访问帮助规范中的 cookie？

> ID：11659244
> 
> 赞同：5
> 
> 时间：2012-07-25T21:56:18.203
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec

在测试我的辅助方法时，我不知道如何测试已设置 cookie。

假设的辅助方法：

```
def my_helper(k,v)
    cookies[k] = v
end 
```

测试：

```
it 'should set cookies' do  
  helper.my_helper("foo", "bar")
  helper.cookies["foo"].should == "bar" #nil
  helper.response.cookies["foo"].should == "bar" #nil
end 
```

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T00:12:48.163

如果您愿意，可以用一个简单的 rspec 模拟来代替 CookieJar 作品：

```
helper.stubs(:cookies => cookies = mock)
cookies.expects(:[]=).with('foo', 'bar')
helper.my_helper('foo', 'bar') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T00:43:35.393

我在 Rails 3.2 和 rspec 2.8 上。尽管[rspec 文档](http://relishapp.com/rspec/rspec-rails/docs/controller-specs/cookies)说以下内容在**请求**规范（即集成测试）中对我有用。

```
it 'should set cookies' do  
  cookies['foo'] = 'bar'
  visit "/"
  cookies['foo'].should == 'bar'
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:07:33.977

通过请求cookie

```
 helper.request.cookies[:awesome] = "something" 
```

# facebook - Facebook 的公共访问令牌，权限

> ID：11659257
> 
> 赞同：1
> 
> 时间：2012-07-25T21:57:28.197
> 
> 标签：facebook, facebook-graph-api

我是 Facebook Graph API 的新手！

我想显示来自我的公共 Facebook 页面的 5 个最新新闻提要项目。我知道您可以通过[https://graph.facebook.com/cocacola/feed/?limit=5](https://graph.facebook.com/cocacola/feed/?limit=5)做到这一点，但它需要访问令牌，但是[https://graph.facebook.com/cocacola](https://graph.facebook.com/cocacola)不需要。

当这些访问令牌通过 Facebook 的 Graph API Explorer 生成时，令牌被赋予了哪些权限？只是上面链接中已经显示的信息？

那么通过 cURL 的 PHP 使用访问令牌是否安全？我只需要读取权限。在源代码中显示访问令牌会不会不安全？我很困惑为什么后一个链接不需要访问令牌，而 /feed/ 需要访问令牌，即使它是一个公共的 Facebook 页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:01:04.107

当您在网站中使用您的应用程序时，有一个参数定义了您从用户那里获得的访问权限，您可以设置参数，例如电子邮件、照片流、朋友流等。当用户接受条件时，生成的 AUTH TOKEN 具有该范围的权限。

# javascript - 输入字段溢出移动包含 Div

> ID：11659261
> 
> 赞同：-3
> 
> 时间：2012-07-25T21:57:37.383
> 
> 标签：javascript, html, google-chrome, input, textfield

由于我最初编写问题的方式收到了一些反对票，并且该示例的链接不再包含该问题，因此我将描述我遇到的特定于 Chrome 的问题。

当在 chrome 的输入字段中突出显示溢出的文本时，如果我将鼠标拖到页面的右侧，包含的 div 会向左滑动。最初我认为这个问题是由输入字段引起的，但事实证明我在同一个容器内有一个单独的 div，它比容器宽。

```
#container {
    width: 100px;
}

#inputfield {
    width: 50px;
}

#otherthing {
    width: 300px;
} 
```

HTML：

```
<div id="container">
    <input type="text" value="Null" />
    <div id="otherthing"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:11:30.633

虽然您的问题格式看起来像垃圾邮件链接，但我还是点击了它。发生这种情况的原因是因为您有效地突出显示了该容器中的所有文本，该容器有一个溢出右手边界的元素。看一下`<div id="selection">`- 它比容器宽，因此将所有子项的总宽度推到边界框之外。浏览器试图通过自动滚动内容来帮助您，以允许您查看突出显示的内容。

简而言之：修复`#selection`元素的 CSS，使其不与容器重叠。

# iphone - 一个 UITableView 中有多个 UITableViewCell 类？

> ID：11659263
> 
> 赞同：7
> 
> 时间：2012-07-25T21:57:56.927
> 
> 标签：iphone, objective-c, ipad, uitableview

我正在组合一个 TableView，我需要在同一个表中使用多个单元格类。

例如，我将如何在我的方法中使用多个单元类`cellForRowAtIndexPath`？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...

    return cell;
} 
```

我知道我可以简单地`UITableViewCell`用我的自定义类替换并使用 if 语句来根据索引调整类，但这不是有点乱，什么是合理的，并且可能是最聪明的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-25T22:06:13.193

当然可以。只需创建自定义单元的新实例并给它们一个新的 CellId。

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
         cellForRowAtIndexPath:(NSIndexPath *)indexPath {

   if (condition1)
    {
        static NSString *CellIdentifier1 = @"Cell1";
        UITableViewCell *cell = 
         [tableView dequeueReusableCellWithIdentifier:CellIdentifier1];

        // TODO: if cell is null, create new cell of desired type.  
        // This is where you    create your custom cell that is 
        // derived form UITableViewCell.
    }
    else
    {
        static NSString *CellIdentifier2 = @"Cell2";
        UITableViewCell *cell = 
         [tableView dequeueReusableCellWithIdentifier:CellIdentifier2];

        //TODO: if cell is null, create new cell of desired type

    }
    // Configure the cell...

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-25T22:05:36.273

您可以通过将表格定义为在其 .xib 文件或 Storyboard 中包含多个原型单元格来实现此目的。请注意下面 Xcode 屏幕截图中表格视图的“动态原型”设置：

![在此处输入图像描述](../Images/4f1798695ce808eac76e9f3d4167d83f.png)

每个原型单元必须被赋予一个唯一的重用标识符。在这个例子中，第一个单元格类型有一个重用标识符`@"ScanCell"`，第二个`@"DetailCell"`。然后，在您的`-tableView:cellForRowAtIndexPath:`方法中，您只需通过选择传递给的重用标识符来选择要使用的单元格类别`-dequeueReusableCellWithIdentifier:`。

这是从我自己的一个应用程序中获取的示例：

```
- (UITableViewCell *)tableView:(UITableView *)tableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString * cellIdentifier = @"DetailCell";
    if ([indexPath section] == 0) {
        cellIdentifier = @"ScanCell";
    }
    UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier
                                                             forIndexPath:indexPath];
    if ([indexPath section] == 1) {
        CBPeripheral * peripheral = (CBPeripheral *)[self.appDelegate.peripherals objectAtIndex:[indexPath row]];
        cell.textLabel.text = [peripheral name];
        cell.detailTextLabel.text = [self.appDelegate.peripheralKeys objectAtIndex:[indexPath row]];
    }
    return cell;
} 
```

如果您希望原型单元具有不同的类，只需在 .xib 或 Storyboard 文件中设置它们的类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-25T22:06:51.447

在某些时候，您需要将不同的单元格类与数据源中的不同项目类型相关联。`if`声明可能是要走的路。您可以将其封装在一个单独的方法中，如下所示：

```
+(Class)cellClassForItem:(id)rowItem
{
    Class theClass = [ UITableViewCell class ] ;

    if ( [ rowItem isKindOfClass:[ ... class ] ] )
    {
        theClass = [ CellClass1 class ] ;
    }
    else if ( [ rowItem isKindOfClass:[ ... class ] ] )
    {
        theClass = [ CellClass2 class ] ;
    }

    return theClass ;
} 
```

或者，您可能让数据源中的每个项目都实现一个`protocol`：

```
@protocol DataSourceItem <NSObject>
-(Class)tableViewCellClass ;
@end 
```

现在，您的委托方法看起来像这样（假设第二种技术）

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    id<DataSourceItem> item = (id<DataSourceItem>)[ tableView itemForRowAtIndexPath:indexPath ] ;
    Class cellClass = [ item tableViewCellClass ] ;
    NSString * cellID = NSStringFromClass( cellClass ) ;

    UITableViewCell *cell = [ tableView dequeueReusableCellWithIdentifier:cellID ] ;
    if ( !cell )
    {
        cell = [ [ cellClass alloc ] initWithStyle:... reuseIdentifier:cellID ] ;
    }

    cell.value = item ;

    return cell;
} 
```

# asp.net - 如何让 log4net 解密来自 web.config 的加密连接字符串？

> ID：11659264
> 
> 赞同：3
> 
> 时间：2012-07-25T21:57:56.387
> 
> 标签：asp.net, web-config, log4net

我正在开发的 Web 应用程序使用 log4net 进行日志记录。该项目的一个要求是连接字符串应该被加密。如何告诉 log4net 使用解密后的值？

例如：

```
 <log4net>
    <root>
      <level value="Debug"/>
      <appender-ref ref="AdoNetAppender"/>
    </root>
    <appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender">
      <bufferSize value="1"/>
      <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
      <connectionString value="encryptedconnectionstringhere=="/> 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T15:29:29.213

在实现drumboog的答案时，由于无限递归的方法调用，我遇到了stackoverflow异常。这基本上是我最终使用的。

```
public class CustomAdoNetAppender : AdoNetAppender
{
    private string _connectionString;
    protected override string ResolveConnectionString(out string connectionStringContext)
    {
        if(string.IsNullOrEmpty(_connectionString))
        {
            var decrypt = new MyDecyptionLib();
            _connectionString = decrypt.MyDecryptionFunction(ConfigurationManager.AppSettings["Connection"]);
        }

        connectionStringContext = _connectionString;
        return connectionStringContext;
    }

} 
```

...在 log4net 配置部分

```
<appender name="AdoNetAppender" type="My.Name.Space.To.CustomAdoNetAppender"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-25T22:04:37.563

除了编写自定义附加程序之外，您还可以加密整个配置部分：

[http://msdn.microsoft.com/en-us/library/zhhddkxy.aspx](http://msdn.microsoft.com/en-us/library/zhhddkxy.aspx)

[以编程方式加密 .NET 中的配置文件](https://stackoverflow.com/questions/21965/programmatically-encrypting-a-config-file-in-net)

**编辑：**

log4net 是开源的，所以您也可以尝试查看他们的代码并自定义他们的 appender 以满足您的需求......也许是这样的：

```
public class DecryptConnectionStringAdoNetAppender : AdoNetAppender
{
    protected override string ResolveConnectionString(out string connectionStringContext)
    {
        string result = base.ResolveConnectionString(out connectionStringContext);
        if (String.IsNullOrEmpty(result))
        {
            return result;
        }
        else
        {
            Decrypt(result);
        }
    }

    private string Decrypt(string encryptedValue)
    {
        // Your code goes here.
    }
} 
```

`appender`然后更新配置文件中元素的 type 属性：

```
<appender name="AdoNetAppender" type="Your.Namespace.DecryptConnectionStringAdoNetAppender"> 
```

# android - ffmpeg 10.04 找不到编解码器参数

> ID：11659267
> 
> 赞同：28
> 
> 时间：2012-07-25T21:58:23.200
> 
> 标签：android, ffmpeg, ubuntu-10.04, x264

执行命令时出现错误 `ffmpeg -i /path/to/video.mp4`：

```
 ffmpeg version git-2012-07-24-93342de Copyright (c) 2000-2012 the FFmpeg developers
      built on Jul 24 2012 23:55:41 with gcc 4.4.3 (Ubuntu 4.4.3-4ubuntu5.1)
      configuration: --enable-libfaac --enable-libmp3lame --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libx264 --enable-gpl --enable-nonfree --enable-postproc --enable-swscale --enable-vdpau --enable-version3 --enable-libtheora --enable-libvorbis --enable-libvpx --enable-x11grab
      libavutil      51\. 65.100 / 51\. 65.100
      libavcodec     54\. 44.100 / 54\. 44.100
      libavformat    54\. 20.100 / 54\. 20.100
      libavdevice    54\.  2.100 / 54\.  2.100
      libavfilter     3\.  3.100 /  3\.  3.100
      libswscale      2\.  1.100 /  2\.  1.100
      libswresample   0\. 15.100 /  0\. 15.100
      libpostproc    52\.  0.100 / 52\.  0.100
    [mov,mp4,m4a,3gp,3g2,mj2 @ 0x2a1b240] Could not find codec parameters for stream 0 (Video: h264 (avc1 / 0x31637661), 1280x720): unspecified pixel format
    Consider increasing the value for the 'analyzeduration' and 'probesize' options
    /path/to/video.mp4: could not find codec parameters 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-25T22:13:25.467

### 调整`-probesize`和/或`-analyzeduration`。

我正在测试的文件实际上已损坏。但是，如果有人遇到这个问题，例如设置和`-probesize`设置`-analyzeduration`可能会有所帮助。`100``10000000`

**来自@DiverseAndRemote.com 的热门评论**

> 我的解决方案是
> 
> ```
> ffmpeg -analyzeduration 2147483647 -probesize 2147483647 -i /path/to/video.mp4 
> ```
> 
> 2147483647 是 max_int

# python - Python Mechanize select_form() - ParseError: SELECT 之外的选项

> ID：11659268
> 
> 赞同：5
> 
> 时间：2012-07-25T21:58:25.270
> 
> 标签：python, mechanize

我正在使用 Python 2.7 和 Mechanize 2.5。我正在尝试使用 select_form() 方法，但出现以下错误：

```
 File "C:\Python27\lib\site-packages\mechanize\_mechanize.py", line 499, in select_form
    global_form = self._factory.global_form
  File "C:\Python27\lib\site-packages\mechanize\_html.py", line 544, in __getattr__
    self.forms()
  File "C:\Python27\lib\site-packages\mechanize\_html.py", line 557, in forms
    self._forms_factory.forms())
  File "C:\Python27\lib\site-packages\mechanize\_html.py", line 237, in forms
    _urlunparse=_rfc3986.urlunsplit,
  File "C:\Python27\lib\site-packages\mechanize\_form.py", line 845, in ParseResponseEx
    _urlunparse=_urlunparse,
  File "C:\Python27\lib\site-packages\mechanize\_form.py", line 982, in _ParseFileEx
    fp.feed(data)
  File "C:\Python27\lib\site-packages\mechanize\_form.py", line 759, in feed
    _sgmllib_copy.SGMLParser.feed(self, data)
  File "C:\Python27\lib\site-packages\mechanize\_sgmllib_copy.py", line 110, in feed
    self.goahead(0)
  File "C:\Python27\lib\site-packages\mechanize\_sgmllib_copy.py", line 144, in goahead
    k = self.parse_starttag(i)
  File "C:\Python27\lib\site-packages\mechanize\_sgmllib_copy.py", line 302, in parse_starttag
    self.finish_starttag(tag, attrs)
  File "C:\Python27\lib\site-packages\mechanize\_sgmllib_copy.py", line 347, in finish_starttag
    self.handle_starttag(tag, method, attrs)
  File "C:\Python27\lib\site-packages\mechanize\_sgmllib_copy.py", line 387, in handle_starttag
    method(attrs)
  File "C:\Python27\lib\site-packages\mechanize\_form.py", line 736, in do_option
    _AbstractFormParser._start_option(self, attrs)
  File "C:\Python27\lib\site-packages\mechanize\_form.py", line 481, in _start_option
    raise ParseError("OPTION outside of SELECT")
ParseError: OPTION outside of SELECT 
```

这是我的代码：

```
cj = cookielib.LWPCookieJar()
br = mechanize.Browser()
br.set_cookiejar(cj)
br.set_handle_equiv(True)
br.set_handle_gzip(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(False)
br.set_handle_refresh(mechanize._http.HTTPRefreshProcessor(), max_time=1)
br.addheaders = [('User-Agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]
br.open("website_url_which_i_will_not_share")
br.select_form(nr=0) 
```

以下是我打开的网页上html的form部分

```
<html lang="en-us" xml:lang="en-us" xmlns="http://www.w3.org/1999/xhtml">
    <head> I omitted this section </head>
    <body class="login">
        <div id="container">
            <div id="header" style="background-color: #13397A;">
            <div id="content" class="colM">
                <div id="content-main">
                    <form id="login-form" method="post" action="/admin/">
                        <div style="display:none">
                            <input type="hidden" value="8a689f2e3d215a3465f1bb66e037d1a5" name="csrfmiddlewaretoken">
                        </div>
                        <div class="form-row">
                            <label class="required" for="id_username">Username:</label>
                            <input id="id_username" type="text" maxlength="30" name="username">
                        </div>
                        <div class="form-row">
                            <label class="required" for="id_password">Password:</label>
                            <input id="id_password" type="password" name="password">
                            <input type="hidden" value="1" name="this_is_the_login_form">
                            <input type="hidden" value="/admin/" name="next">
                        </div>
                        <div class="submit-row">
                            <label>&nbsp;</label>
                            <input type="submit" value="Log in">
                        </div>
                    </form>
                    <script type="text/javascript">
                </div>
                <br class="clear">
            </div>
            <div id="footer"></div>
        </div>
        <script type="text/javascript">
    </body>
</html> 
```

我已经在 stackoverflow 和 google 上对此进行了研究，但我找不到类似的问题，甚至找不到这个错误的描述。

如果有人能告诉我这个错误的含义并帮助我在这里找到问题所在，我将不胜感激。

谢谢

编辑：我一直在做很多表单提交，除了这个之外，每个站点都运行良好。这是一个数据库 API，我试图从中删除数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-14T09:10:59.670

我遇到了同样的问题（不幸的是还没有解决），我发现了这段有趣的代码，它可能会有所帮助

来自[http://comments.gmane.org/gmane.comp.python.wwwsearch.general/1991](http://comments.gmane.org/gmane.comp.python.wwwsearch.general/1991)

```
import   mechanize
from   BeautifulSoup   import  BeautifulSoup  

class SanitizeHandler(mechanize.BaseHandler):
    def http_response(self, request, response):
        if not hasattr(response, "seek"):
            response = mechanize.response_seek_wrapper(response)
        #if    HTML   used   get   it though  a    robust  Parser    like  BeautifulSoup

        if response.info().dict.has_key('content-type') and ('html' in response.info().dict['content-type']):
            soup = BeautifulSoup(response.get_data())
            response.set_data(soup.prettify())
        return response

br = mechanize.Browser()
br.add_handler(SanitizeHandler())

# Now    you get    good   HTML 
```

这应该覆盖 http_response 方法并“清理”您的 html。

# ios - 是否可以从 UIWebView 中的页面启动 iTunes？

> ID：11659273
> 
> 赞同：0
> 
> 时间：2012-07-25T21:58:57.243
> 
> 标签：ios, uiwebview

我正在尝试让 iTunes 从加载到`UIWebView`.

使用 Apple 文档中的示例

[http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/iTunesLinks.html#//apple_ref/doc/uid/TP40007896-SW1](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/iTunesLinks.html#//apple_ref/doc/uid/TP40007896-SW1)

```
 <a
 href="http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewAlbum?i=156093464&id=156093462&s=143441">
 <img height="15" width="61" alt="Randy Newman - Toy Story
- You&#39;ve Got a Friend In Me" src="http://ax.phobos.apple.com.edgesuite.net/images/
 badgeitunes61x15dark.gif"></img> </a> 
```

当我单击按钮 didFailLoadWithError: 将被调用`WebKitErrorDomain 101`。

（`shouldStartLoadWithRequest:`任何请求都返回 YES）

在浏览器中加载的相同 html 页面可以工作。

* * *

（该代码实际上还有另一个问题，请参阅此链接 [Remote image doesn't get displayed in html page shown in UIWebView](https://stackoverflow.com/questions/11659324/remote-image-doesnt-get-displayed-in-html-page-displayed-in-uiwebview)

但是在将其更改为此之后，它仍然无法在 UIWebView 中使用，但在浏览器中可以使用

```
 <a href="http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewAlbum?i=156093464&id=156093462&s=143441">
      <img height="15" width="61" src="Btn_Go.png""></img>
  </a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:24:46.507

[你会在这个问题](https://stackoverflow.com/questions/4299403/how-to-handle-app-urls-in-a-uiwebview)中找到你所寻求的。

答案使用`-webView:shouldStartLoadWithRequest:navigationType`和点击链接的 url 方案来确定该链接是应该由系统打开还是在 webview 中打开。

它还可以处理您提到的错误。（但只能忽略它..）

# php - 如果不为真，则使用 jquery 显示和隐藏 div

> ID：11659282
> 
> 赞同：0
> 
> 时间：2012-07-25T21:59:36.943
> 
> 标签：php, jquery, ajax

我有一个 php 函数可以像这样验证管理员登录

```
 if($vAdmin==1)
{
    $_SESSION['admin']="admin";
    header("location:index.php");
}
else
{
    $errMsg="Invalid Username or Password.";
} 
```

这项工作很完美，但我想显示显示错误消息的 div，所以我定义了这样的 div 及其隐藏的 div 样式。

```
 <div class="notification">Invalid username or password. (Type anything)</div> 
```

我已将上述功能更改为

```
 if($vAdmin==1)
{
    $_SESSION['admin']="admin";
    header("location:index.php");
}
else
{?>
$('div.notification').fadeIn();
setTimeout(function() {
$('div.notification').fadeOut('slow');
}, 3000);   
<?}
    ?> 
```

我的基本目的是在未验证时只显示 div 并将其隐藏。

但它不工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:02:49.327

您需要在脚本标签中输出 javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:05:41.460

将代码的 else 部分更改为以下内容：

```
else
{ 
echo <<<EOD
<script type="text/javascript">
$(document).load(function() {
$('div.notification').fadeIn();
setTimeout(function() {
$('div.notification').fadeOut('slow');
}, 3000); 
});  
</script>
EOD;
} 
```

我还假设您在添加此脚本标记之前的某处包含 jQuery 库。如果你不是，请确保你这样做。

# cuda - 在读取之前将数组转换为不同的数据类型会导致间歇性问题

> ID：11659284
> 
> 赞同：1
> 
> 时间：2012-07-25T21:59:40.363
> 
> 标签：cuda

我在全局内存中有一个 int 数组。为了减少从全局内存中读取的频率，我一直在尝试使用 64 位数据类型进行读取，然后根据需要使用高 32 位或低 32 位。例如，这会从数组中获取第 3 和第 4 个整数：

```
__device__ void func1(int* arr)
{
    unsigned long long int val = *((unsigned long long int *) &arr[3]);

    // Now operate on the individual ints
} 
```

使用这种方法来检索整数给了我未定义的行为，即使它看起来应该可行。当它起作用时，以这种方式读取值比单个整数读取要快得多。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:12:28.843

数量喜欢按大小排列。我不确定 cuda 如何处理你正在做的事情以及它可能是特定于环境的，但是你使用：

```
*((unsigned long long int *) &arr[3]) 
```

假设`arr`是 8 字节对齐，则采用 8 字节数量，即只有 4 字节对齐。这当然是因为：

```
arr = 8n           // n is an integer
sizeof(int) = 4

&arr[3] = 8n + 3*4 // simplifies to 8(n+1) + 4 
```

我知道如果您尝试在使用 32 位和 16 位整数的处理器上执行相同的操作（尽管我从未尝试过使用 64 位和 32 位整数），您会遇到问题。

您将需要自制某种访问器交易，以确定您尝试访问的数据在哪里。考虑以下情况，类似于您的情况：

```
int get32BitValueFrom(unsigned long long int longArray[], int index)
{
    // get the 64 bit int containing the 32 bit int we want
    unsigned long long int value = longarray[index >> 1];

    // if we wanted an odd index, return the high order 32 bits
    // otherwise return the low order 32 bits
    return (int) ((index & 1) ? (value >> 32) : (value));
} 
```

编辑：我知道您正在使用 cuda，并且我知道要避免分支，但我确信有一种方法可以使用某种按位或数学技巧来编写等效代码来完成相同的事情。

# java - 使用 esapi 验证 Web 表单中的输入文本

> ID：11659287
> 
> 赞同：2
> 
> 时间：2012-07-25T21:59:59.040
> 
> 标签：java, validation, esapi

如何使用 ESAPI 检查 Web 表单中的不安全输入文本？我的应用程序是使用 struts 1.X 构建的，所以我假设验证应该添加到 Actions 类中。您推荐的任何示例/教程？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T10:27:42.320

对于特定的东西，通常不会有很好的教程。

希望我对此错了，但由于缺乏良好的资源，我不得不建议他们的[维基。](http://code.google.com/p/owasp-esapi-java/wiki/Welcome?tm=6)

我正在为您寻找输入验证......似乎他们自己甚至没有。我也找不到任何关于它的信息。下面的视频可能有它，或者如果它没有提供真正好的答案，我会通过电子邮件发送给他们。他们应该能够将您引向正确的方向……如果您这样做，请帮我们一个忙，并要求他们更新他们的 wiki！

电子邮件：jeff.williams%owasp.org@gtempaccount.com（领导，所有者）

由于该电子邮件看起来不正确，但我也会检查这封电子邮件。

电子邮件：kevin.w.wall@gmail.com（所有者，加密库的编码器）

他们是这些 youtube 视频，可能会有所帮助。他们甚至提到他们没有很多好的资源来教你如何使用 ESAPI，但表示他们希望在这四个视频中解决这个问题。

1.  [http://www.youtube.com/watch?v=suphwAsb-To](http://www.youtube.com/watch?v=suphwAsb-To)
2.  [http://www.youtube.com/watch?v=13O9RyjuB3o](http://www.youtube.com/watch?v=13O9RyjuB3o)
3.  [http://www.youtube.com/watch?v=_B2kv2mSJhE](http://www.youtube.com/watch?v=_B2kv2mSJhE)
4.  [http://www.youtube.com/watch?v=mmW4fiUI5kQ](http://www.youtube.com/watch?v=mMW4fiUI5kQ)

希望它有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T08:26:14.810

表单字段的验证通常在 ActionForm 类中完成。有所有可用的输入值，所有验证都可以在那里完成。教程（许多可用的教程之一）可以在此处找到[Struts 表单验证和错误处理](http://www.laliluna.de/articles/posts/struts-form-validation-error-handling.html)。可以使用 google 找到更多信息（struts 验证）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-15T19:55:33.633

我已经使用 ESAPI 库几个月了。库不能做太多来验证您的输入，因为它不知道输入可能或应该是什么。当您考虑到合法用户输入中可能包含的所有国际字符时，尤其如此。

我们主要使用 ESAPI 库来编码服务器输出。目的是将用户（或可能的攻击者）输入以无法执行的方式发送回浏览器。相反，HTML 或 JavaScript 仅将其解释为文本。

这就是为什么我的验证和 ESAPI 的用户输入编码对于安全性都很重要。

# css - 强调

> ID：11659290
> 
> 赞同：6
> 
> 时间：2012-07-25T22:00:21.490
> 
> 标签：css, border

我试图在`h1`-title 下划线，但由于某种原因，它总是占用父 div 的整个长度。我能够这样做的唯一方法是`position: absolute`在css中添加-property ...

这是设计：
![在此处输入图像描述](../Images/34de4c9efdc07060eb45484cd1b32cc1.png)

这就是我得到的：
![在此处输入图像描述](../Images/1d4522c74f8c47671072537638aaec1a.png)

`h1`要点是使蓝线仅与父div下的灰色边框线一样宽。

**HTML：**

```
<div class="title">
    <h1>Contacteer ons</h1>
</div> 
```

**CSS：**

```
h1 {
    border-bottom: 8px solid #57c4d0;
    position: absolute; /* As I've said, adding this allowed me to do so, but the result was far from ideal! */
}

.title {
    border-bottom: 1px solid #dedede;
} 
```

我计划在整个网站上使用 HTML（每个网站`h1`的长度都不同，不能在每个标题上添加固定宽度），所以我正在寻找一个强大的解决方案。有人有建议吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-25T22:01:49.577

您可以更改`h1`为`display: inline-block;`

见一个活生生的例子（为了清楚起见添加`margin-bottom`了`.title`）：

[http://jsfiddle.net/P4BGC/](http://jsfiddle.net/P4BGC/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:09:47.683

看到[这个小提琴](http://jsfiddle.net/jtTwj/)。H1 是一个块元素，因此它会增长以填充其父元素。您可以设置`display: inline`，但我也建议将其放在自己的 div 中（或任何其他带有 的元素`display: block`），这样您就可以确保没有任何内容出现在旁边。

```
<div><h1>Hello, world</h1></div>
Lorem ipsum 
```

的CSS

```
​h1 {
  border-bottom: 3px solid red;
  display: inline;
}​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-05T12:06:55.687

您也可以使用 CSS 样式`text-decoration`。

html:

```
<div><h1>Hello, world</h1></div> 
```

CSS：

```
 h1 {
        text-decoration: underline;
    } 
```

# python - Python 中的 RFC 4648 (Base64) 实现

> ID：11659291
> 
> 赞同：3
> 
> 时间：2012-07-25T22:00:23.603
> 
> 标签：python, base64

Python中是否有[RFC4648](https://www.rfc-editor.org/rfc/rfc4648)（“Base16、Base32 和 Base64 数据编码”）的任何实现？请注意，我专门寻找 RFC 4648，而不是它的前身。只要不需要太长时间，其他脚本语言就可以工作。首选 Python。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:02:49.107

Python 有一个实现 RFC 3548（RFC 4648 的旧版本）的[base64模块。](http://docs.python.org/library/base64.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-08T17:59:06.400

`Base64#strict_decode64`Ruby 在和`Base64#strict_encode64`方法 中实现了 RFC 4648 。[资源。](http://ruby-doc.org/stdlib-2.0/libdoc/base64/rdoc/Base64.html#method-i-strict_decode64)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T12:40:03.067

Go 标准库有一个非常好的[base64 实现](http://golang.org/pkg/encoding/base64/)（如 RFC 4648 中所定义）。

* * *

相关源文件：

*   [base64.go](http://golang.org/src/pkg/encoding/base64/base64.go)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-14T06:15:38.897

base64 也有一个字符串操作数版本：

```
a_str = 'This is a string'
a_str.encode('base64', 'strict')
'VGhpcyBpcyBhIHN0cmluZw==\n' 
```

它和 base64.b64encode 一样，但我想我会把它作为一个选项扔在那里。

# 补丁：

您正在寻找的是常规 base64 模块的“扩展十六进制”，我记得我为 DNSSEC 项目安装了一段时间： http: [//bugs.python.org/issue16995](http://bugs.python.org/issue16995)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-08T18:38:18.290

在使用[https://golang.org/src/encoding/base32/base32.go时](https://golang.org/src/encoding/base32/base32.go)

我找不到 RFC 4648 所指的“带有扩展十六进制字母的 Base 32 编码”的 python 实现；所以我为python写了一个：

[https://gist.github.com/graham/d7845f00fce0690b65ab049d52c1ddcb](https://gist.github.com/graham/d7845f00fce0690b65ab049d52c1ddcb)

据我所知，如果您使用标准字符映射，RFC 3548 并没有什么不同，但我无法找到使用扩展十六进制字母表的标准方法。

随意复制粘贴，如果人们认为这是一个合理的解决方案，我会编写一些测试并创建一个 git repo。

# jquery - jQuery 在图像损坏时执行事件

> ID：11659292
> 
> 赞同：1
> 
> 时间：2012-07-25T22:00:24.573
> 
> 标签：jquery, image, typeerror, onerror

我发现这里之前提到的这个问题[jQuery/Javascript 来替换损坏的图像](https://stackoverflow.com/questions/92720/jquery-javascript-to-replace-broken-images)

这是最好的答案..我试过了，它工作正常

```
function ImgError(source){
   source.src = "/images/noimage.gif";
   source.onerror = "";
   return true;
}

<img src="someimage.png" onerror="ImgError(this);"/> 
```

但是当我尝试在前一个函数中执行其他事件时

```
function ImgError(source){
   source.hide(); // hide instead of replacing the image
   source.onerror = "";
   return true;
} 
```

我收到了这个错误

```
TypeError: 'undefined' is not a function (evaluating 'source.hide()') 
```

我尝试过的每个 jQuery 事件/方法都得到了 TypeError。

有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:02:26.800

因为`.hide()`是一个jQuery元素。

试试看：

```
function ImgError(source) {
   $(source).hide();
   source.onerror = "";
   return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:04:29.853

`hide()`是一个jQuery方法，是吗？

尝试`$(source).hide()`

:)

编辑：您可以尝试为所有图像添加全局错误处理程序，如下所示：

`$('img').error(function() { $(this).hide(); });`

见： [http ://api.jquery.com/error/](http://api.jquery.com/error/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:05:07.427

您是否尝试过以下操作：

```
source.style.visibility='hidden'; 
```

# c# - 在多个用户控件之间共享属性

> ID：11659299
> 
> 赞同：2
> 
> 时间：2012-07-25T22:01:09.687
> 
> 标签：c#, asp.net

我有几个共享一些公共属性的用户控件。例子：

```
private List<MyObject> Sample
        {
            get
            {
                return Session["MyObject"] as List<MyObject>;
            }
            set
            {
                Session["MyObject"] = value;
            }
        } 
```

我想将此分享给我项目中的所有用户控件。（当然，不是解决方案中的其他项目）。我要做的是创建一个单独的类并从该类继承。就像是：

```
public class SampleBase : Web.UI.UserControl
{
 protected List<MyObject> Sample
            {
                get
                {
                    return Session["MyObject"] as List<MyObject>;
                }
                set
                {
                    Session["MyObject"] = value;
                }
            }
} 
```

然后我的控件可以通过从该类派生来继承这些值：

```
partial class myControl : SampleBase 
```

我遇到的一个问题是，如果 control 已经继承了某些东西，我就不能从 base 派生：

```
partial class myControl : SomethingELSE 
```

否则它工作正常，但我不确定这是否是一个好方法，我正在寻找建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-30T20:51:43.973

如果我的理解是正确的，您只想摆脱用户控件的继承层次结构

另一种方法是使用[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

例如：

### 用于标记您的 USerControls 的界面

```
public interface IMyUserControlMark { } 
```

### 扩展

```
public static class MyUserClassExtensions
{
    public static List<object> GetSampleData(this IMyUserControlMark myUserControl)
    {
        if (HttpContext.Current.Session["MyObject"] == null)
        {
            return Enumerable.Empty<object>().ToList();
        }

        return HttpContext.Current.Session["MyObject"] as List<object>;
    }

    public static void SetSampleData(this IMyUserControlMark myUserControl, List<object> myObject)
    {
        HttpContext.Current.Session["MyObject"] = myObject;
    }
} 
```

### 用户控制

```
public partial class Content1 : System.Web.UI.UserControl, IMyUserControlMark
{
     ...
}

public partial class Content2 : System.Web.UI.UserControl, IMyUserControlMark
{
     ....
} 
```

现在您将能够从您的 UserControl 或从后面的 ASPX 代码中调用您的扩展方法，如下所示：

### 从用户控件

```
var myObject = this.GetSampleData();
this.SetSampleData(myObject); 
```

### 来自背后的 ASPX 代码

```
var myObject = this.uc1.GetSampleData();
this.uc1.SetSampleData(myObject); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:04:12.837

这是一个典型的例子，你需要“优先组合而不是继承”。

您持有对类实例的引用，而不是从类*继承。*然后，您提供简单的传递代码来访问类的方法/属性。

因此，对于您的示例：

```
public class SomeBehavior
{
    public List<MyObject> Sample
    {
        get { return Session["MyObject"] as List<MyObject>; }
        set { Session["MyObject"] = value; }
    }
}

public class MyControl : UserControl
{
    private SomeBehavior _someBehavior;

    public MyControl()
    {
        _someBehavior = new SomeBehavior();
    }

    public List<MyObject> Sample
    {
        get { return _someBehavior.Sample; }
        set { _someBehavior.Sample = value; }
    }   
} 
```

另一种选择是允许直接访问行为类：

```
public class MyControl : UserControl
{
    public SomeBehavior SomeBehavior { get; private set; }

    public MyControl()
    {
        SomeBehavior = new SomeBehavior();
    }
} 
```

这样做的好处是您不必编写传递代码。缺点是它违反[了得墨忒耳法则，](http://en.wikipedia.org/wiki/Law_of_Demeter)即你应该“只与你的直系朋友交谈”。如果你这样做，其他使用的类`MyControl`需要了解`SomeBehavior`. 遵循得墨忒耳法则可以提高代码的可维护性和适应性，但代价是大量的直通代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T21:14:46.463

除了以前的解决方案，也许是时候应用一些 MVC/MVP 模式了？对于 Web 表单，有一个很棒的框架叫做 WebFormsMVP：[link](http://webformsmvp.com/) 在库中有一个叫做 Cross Presenter Messaging 的机制，借助它，您可以使用发布/订阅模式在控件之间共享数据。为了更好的解释看[这里](http://www.ronaldwidha.net/2010/05/31/a-simple-example-of-the-webformsmvp-cross-presenter-messaging/)和[这里](http://wiki.webformsmvp.com/index.php?title=SC009)

我建议给图书馆一个机会:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T01:32:14.347

在 C# 中，您只能从一个类继承并实现多个接口。

这是允许的：

```
partial class myControl : SampleBase

partial class myControl : SampleBase, Interface1

partial class myControl : SampleBase, Interface1, Interface2, Interface3 
```

这是不允许的：

```
partial class myControl : SomethingELSE, SampleBase 
```

如果它满足您的设计，请尝试`SomethingELSE`继承。`SampleBase`如果没有，那么我建议将其封装`SampleBase`为每个需要它的控件的属性，因为它还建议@DanM。

# javascript - Chrome 扩展保存文件对话框

> ID：11659302
> 
> 赞同：1
> 
> 时间：2012-07-25T22:01:19.050
> 
> 标签：javascript, google-chrome, google-chrome-extension

请我是构建 Chrome 扩展程序的新手。用户安装扩展后，我希望他们通过指定应用程序可以保存文件的目录来配置它。我想通过打开一个保存文件对话框来做到这一点，这样他们就可以浏览到他们选择的文件夹。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T00:45:59.413

答案是 Chrome 扩展 API 中没有办法在 Chrome 提供的沙盒文件系统之外写入文件。理论上这可以通过在 C 中编写一个接口然后调用它来完成，但到目前为止我还没有看到一个成功的实现。

# sql - TSQL 按部分聚合过滤

> ID：11659303
> 
> 赞同：1
> 
> 时间：2012-07-25T22:01:31.343
> 
> 标签：sql, sql-server, tsql

SQL Server 2005+。

我有一个包含以下架构/数据的表：

```
Name   Slots    Date
---------------------
Bob     1       1/1/2010 
Bob     2       1/8/2010 
Joe     4       1/2/2010 
Nat     1       1/4/2010 
Nat     3       1/3/2010 
Nat     8       1/9/2010 
```

我需要做的是找到特定名称的行，该行导致该名称的插槽总和达到或超过任意值 - 比如说 3。

所以在上面的例子中，Bob 有两行。第二行，日期为 2010 年 1 月 8 日，将是我的匹配项，即 1 和 2 = 3 的总和。

乔只有一行，他会匹配，因为 4 已经大于 3。

Nat 有 3 行，在他的情况下，匹配行是日期为 2010 年 1 月 3 日的第 2 行，因为 1 和 3 之和为 4，并且 4 大于 3。

所以我的结果是：

```
Name   SlotsSum    Date
-------------------------
Bob     3       1/8/2010 
Joe     4       1/2/2010 
Nat     4       1/3/2010 
```

我知道我可以用光标来做到这一点，但我希望采用基于集合的方法。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:55:54.267

使用两种技术，我们可以做你想做的事。 `CROSS APPLY`计算运行总计，`ROW_NUMBER`因此我们可以选择超出限制的第一行。

```
declare @MyTable table (Name varchar(10), Slots int, Date date)
insert @MyTable values
('Bob',     1 ,      '1/1/2010'),
('Bob',     2 ,      '1/8/2010'), 
('Joe',     4 ,      '1/2/2010 '),
('Nat',     1 ,      '1/4/2010 '),
('Nat',     3 ,      '1/3/2010 '),
('Nat',     8 ,      '1/9/2010 ')

declare @Limit int = 3

;with cte as
(
    select Name, Slots, Date, RunningTotal,
    ROW_NUMBER() over (partition by Name order by Name, Date) as rn
    from @MyTable rsTable
    cross apply 
    (
        select SUM(Slots) as RunningTotal
        from @MyTable rsApply
        where Date <= rsTable.Date and Name = rsTable.Name
    ) rsRunningTotal
    where RunningTotal >= @Limit

)
select Name, RunningTotal, Date
from cte 
where rn = 1 
```

# c++ - C2071 非法存储类，在类中声明并在其他类中使用的外部向量

> ID：11659310
> 
> 赞同：1
> 
> 时间：2012-07-25T22:01:52.130
> 
> 标签：c++, visual-studio-2008, vector, extern

错误 C2071：“Lexicon::list”：非法存储类

我有一个类将一堆字符串读入内存，然后提供允许对这些字符串及其关系应用操作的函数。作为其中的一部分，我希望在启动一些操作的 main.cpp 和完成操作的类之间有一个共享内存。为此，在之前的帖子中，建议使用外部类型。但是，现在出现了错误。如何解决此错误并让多个类共享内存空间？

在词典.h

```
 #ifndef _lexicon_h
    #define _lexicon_h

    #include <string>
    #include <vector>

    using namespace std;

    class Lexicon {
    public:
    Lexicon();
    ~Lexicon();

    extern vector<vector<string>> list;

    void buildVectorFromFile(string filename, vector<vector<string>> &list, int v, int h);

    private:
    struct charT { char letter; nodeT *next;};
    };
    #endif 
```

在 main.cpp

```
#include <string>
#include <iostream>
#include <iomanip>
#include <fstream>
#include <vector>

#include "lexicon.h"  

void buildVectorFromFileHelper (Lexicon & lex)
    {
        vector<vector<string>> list;
        lex.buildVectorFromFile("ASCII.csv", list, 200, 2); //build 2x200 vector list
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:06:00.650

好的，我误解了您之前的问题（当您不发布完整代码时会发生这种情况）。在类内部，`extern`不使用：

在词典.h

```
#ifndef _lexicon_h
#define _lexicon_h

#include <string>
#include <vector>

using namespace std;

class Lexicon {
public:
Lexicon();
~Lexicon();

vector<vector<string>> list;

private:
struct charT { char letter; nodeT *next;};
};
#endif 
```

在 main.cpp

```
#include <string>
#include <iostream>
#include <iomanip>
#include <fstream>
#include <vector>

#include "lexicon.h"  

void buildVectorFromFileHelper (Lexicon & lex)
{
    vector<vector<string>> list;
    lex.buildVectorFromFile("ASCII.csv", list, 200, 2); //build 2x200 vector list
} 
```

这里的问题是`Lexicon`没有方法`buildVectorFromFile`，所以你怎么打电话`lex.buildVectorFromFile("ASCII.csv", list, 200, 2);`？

要分享相同`vector`的内容，如果它是会员，请制作`static`：

```
class Lexicon {
public:
Lexicon();
~Lexicon();

static vector<vector<string>> list;

private:
struct charT { char letter; nodeT *next;};
}; 
```

在`lexicon.cpp`：

```
vector<vector<string>>  Lexicon::list; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:49:35.543

[在这个daniweb 线程](http://www.daniweb.com/software-development/cpp/threads/131659/how-exactly-to-use-extern)中解释了外部记忆的规则；那里的评论是，是的，这应该很简单，但不知何故不直观。要点是在 .cpp 文件 A 中使用 extern 前缀全局声明内存，然后在 cpp B 中重用内存，在 .cpp 文件 B 中再次全局声明它。

我认为 Luchian_Grigore 和 @jahhaj 已经到了那里，但我们要么只是没有找到让我理解的词，要么他们仍在找到要解释的词。

# ios - 跟踪 Git 中通过引用 Xcode 中的项目添加的文件

> ID：11659316
> 
> 赞同：0
> 
> 时间：2012-07-25T22:02:31.513
> 
> 标签：ios, xcode, git

我有几个 iOS 项目都使用相同的介绍视频。视频文件不在任何项目文件夹中。当我通过引用 Xcode 项目添加它们时，我无法使用 Git 跟踪（添加？）它们。该文件是否需要位于项目文件夹的本地才能将它们添加到存储库中，或者有没有办法做到这一点？我通过引用添加它们，以便我可以对一个视频进行更改并将其反映在所有项目中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:52:06.310

对于这样的情况，我在项目之间共享代码，我创建一个包含公共代码的 git 子模块，其中 git 子模块基本上是该公共代码的 git 存储库的迷你克隆。

因此，对于共享的源，我可以在一个项目的子模块中使用它而不会影响其他项目，直到我对它感到满意并提交并将其推送到子模块的源/主模块，然后将其从那里合并到其他的项目。二进制也应该是一样的。

这样，跟踪确实会出现在 Xcode 中。

# ios - 远程图像未显示在 UIWebView 中显示的 html 页面中

> ID：11659324
> 
> 赞同：3
> 
> 时间：2012-07-25T22:02:54.120
> 
> 标签：ios, uiwebview

以下代码

```
<a href="http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewAlbum?i=156093464&id=156093462&s=143441">
<img height="15" width="61" alt="Randy Newman - Toy Story
- You&#39;ve Got a Friend In Me" src="http://ax.phobos.apple.com.edgesuite.net/images/
badgeitunes61x15dark.gif"></img>
</a> 
```

来自苹果的文档

[http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/iTunesLinks.html#//apple_ref/doc/uid/TP40007896-SW1](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/iTunesLinks.html#//apple_ref/doc/uid/TP40007896-SW1)

当包含该 href 的 html 页面加载到浏览器中时，图像会显示，但是当它加载到 UIWebView 中时，它不会显示。

ShouldStartLoadWithRequest：不为以下 URL 调用

```
http://ax.phobos.apple.com.edgesuite.net/images/
badgeitunes61x15dark.gif 
```

为什么它不被调用，为什么它在浏览器中有效，但在 UIWebView 中无效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T01:28:26.547

好吧，我刚刚用你的 HTML 构建了一个原型，它对我来说很好用。

但是，有几点想法：

*   首先，如果您`webView:shouldStartLoadWithRequest:navigationType:`在 Web 视图委托中实现，不要期望 HTML 页面中的每个项目都有回调。如果我没记错的话，它只调用顶级请求（例如整个页面）。所以，我不希望只为那个`img`资源获得回调。

*   由于我们已经确定实施`webView:shouldStartLoadWithRequest:navigationType:`不会做您想要的，您可能希望完全删除它。当我第一次懒惰地把它放在我的代码中时，我忘记了`return YES;`那个方法。由于 Objective-C 是一种相当松散的语言，因此应用程序构建并运行，但显然`NO`被认为是该方法的隐式返回值。 `NO`停止加载请求。如果图像是您拥有的示例页面中的唯一内容，您将看不到任何东西（并且可能错误地认为这只是因为 img 本身）。

*   我无法判断这是否仅存在于您在问题中发布的 HTML 中，或者是否也存在于真实代码中。但是，您的`img src`URL 中有空格，在`"images/"`. 那显然会打破这种局面。

*   在我的测试中，我还从一个没有缩放内容以适应的网页开始。该图像相当小，因此如果您不缩放 Web 视图以适应大小，并在 iPhone/iPod 上查看它，您可能不会注意到这么小的图像。

```
 webview.scalesPageToFit = YES; 
```

反正我能想到的就这么多了。就像我说的，它对我有用。这不是图像本身，也不是 Mobile Safari 与`UIWebView`.

仔细检查并报告:)

# c# - 可以提取 flv、mp3 .. 等 c# Windows 窗体

> ID：11659327
> 
> 赞同：-1
> 
> 时间：2012-07-25T22:03:22.507
> 
> 标签：c#, winforms, download, flv

**可以在使用 windows 窗体 c# 的站点上提取 flv、mp3 .. 等 c#？**

如果可能的话我该怎么办？

*提前感谢您的回答*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:09:51.010

是的 - 但是，不要尝试使用任何 Windows 工具来执行此操作。相反，使用 FFMPEG 的包装器： [Using FFmpeg in .net?](https://stackoverflow.com/questions/2527963/using-ffmpeg-in-net)

在我的测试中，FFMPEG 比 Windows Media 服务更有用，也更可靠。

# java - Jersey/JAX-RS：在响应标头中返回 Content-Length 而不是分块传输编码

> ID：11659330
> 
> 赞同：11
> 
> 时间：2012-07-25T22:03:40.637
> 
> 标签：java, rest, jaxb, jersey, jax-rs

我正在使用 Jersey 创建 RESTful API 资源并`ResponseBuilder`生成响应。

RESTful 资源的示例代码：

```
public class infoResource{
  @GET
  @Path("service/{id}")
  @Produces({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})
  public Response getCompany(@PathParam("id")String id) {
      //company is just a POJO.
      Company company = getCompany(id);
      return Response.status(200).entity(company).build();  
  }
} 
```

在响应中，它在响应标头中返回分块传输编码。“泽西世界”中让它返回`Content-Length`标头而不是`Transfer-Encoding: chunked`响应标头中的标头的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T13:01:01.067

选择`Content-Length`or`Transfer-Encoding`只是那些 Containers 的选择。这实际上是缓冲区大小的问题。

一种可能的解决方案是提供一种`SevletFilter`缓冲所有这些编组字节并设置`Content-Length`标头值的方法。

请参阅[此页面](http://docstore.mik.ua/orelly/xml/jxslt/ch08_04.htm)。

```
@WebFilter
public class BufferFilter implements Filter {

    @Override
    public void init(FilterConfig filterConfig) {
    }

    @Override
    public void doFilter(ServletRequest request,
                         ServletResponse response,
                         FilterChain chain)
        throws IOException, ServletException {

        final ByteArrayOutputStream buffer =
            new ByteArrayOutputStream();

        // prepare a new ServletResponseWrapper
        // which returns the buffer as its getOutputStream();

        chain.doFilter(...)

        // now you know how exactly big is your response.

        final byte[] responseBytes = buffer.toByteArray();
        response.setContentLength(responseBytes.length);
        response.getOutputStream().write(responseBytes);
        response.flush();
    }

    @Override
    public void destroy() {
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-01-26T10:19:13.007

在扩展 ResourceConfig 的类中，您可以设置缓冲区大小。超过此大小的响应将被分块，下面将具有 Content-Length。

```
public class ApplicationConfig extends ResourceConfig {

  public ApplicationConfig() {
    //your initialization
    property(CommonProperties.OUTBOUND_CONTENT_LENGTH_BUFFER, 2000000); 
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-18T14:02:17.890

例如，如果您的输入流是从本地文件系统读取的，只需添加：

```
response.header( "Content-Length", file.length() ); 
```

查看完整代码以获得更清晰的解释：

```
@Path("/files")
public class FileDownloadService {

    private static final String TXT_FILE = "C:\\your file";    
    @GET
    @Path("/txt")
    @Produces(MediaType.APPLICATION_OCTET_STREAM)
    public Response getTextFile() throws IOException {
        File file = new File(TXT_FILE);
        FileInputStream inStream = new FileInputStream(file);
        ResponseBuilder response = Response.ok((Object) inStream);
        response.header("Content-Disposition", "attachment; filename=\"filename\"");
        response.header( "Content-Length", file.length() );
        return response.build();
    }  
} 
```

客户端是 Apache HttpClient 代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-08T18:33:38.037

StackOverflow 上一个非常相似的问题的答案可以[在这里找到](https://stackoverflow.com/a/46121697/26510)

我已将其复制到此处以确保它不会转换为评论：

一个很好的示例过滤器，可以从项目中独立使用，这是来自github 上的[Carrot2项目的](https://github.com/arnaudsj/carrot2/)[ContentLengthFilter.java 。](https://github.com/arnaudsj/carrot2/blob/master/applications/carrot2-webapp/src/org/carrot2/webapp/ContentLengthFilter.java)

请注意，使用带有字节流的响应包装器来解决问题，因此这也确保`Transfer-Encoding: Chunked`不会被过滤器链中的其他过滤器/代码设置，并`Content-Length`在设置时覆盖您的标头。您可以通过使用更大的文件进行测试来验证这一点，因为它们通常会在响应中分块。

我还将在此处复制文件的内容，以确保它不会成为断开的链接：

```
/*
 * Carrot2 project.
 *
 * Copyright (C) 2002-2010, Dawid Weiss, Stanisław Osiński.
 * All rights reserved.
 *
 * Refer to the full license file "carrot2.LICENSE"
 * in the root folder of the repository checkout or at:
 * http://www.carrot2.org/carrot2.LICENSE
 */

package org.carrot2.webapp;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletOutputStream;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpServletResponseWrapper;

/**
 * Buffer the output from filters below and set accurate <code>Content-Length</code>
 * header. This header is required by flash, among others, to display progress
 * information.
 */
public class ContentLengthFilter implements Filter
{
    private final static class BufferingOutputStream extends ServletOutputStream
    {
        private final ByteArrayOutputStream baos = new ByteArrayOutputStream();

        @Override
        public void write(int b) throws IOException
        {
            baos.write(b);
        }

        @Override
        public void write(byte [] b) throws IOException
        {
            baos.write(b);
        }

        @Override
        public void write(byte [] b, int off, int len) throws IOException
        {
            baos.write(b, off, len);
        }
    }

    private final static class BufferingHttpServletResponse extends
        HttpServletResponseWrapper
    {
        private enum StreamType
        {
            OUTPUT_STREAM,
            WRITER
        }

        private final HttpServletResponse httpResponse;

        private StreamType acquired;
        private PrintWriter writer;
        private ServletOutputStream outputStream;
        private boolean buffering;

        public BufferingHttpServletResponse(HttpServletResponse response)
        {
            super(response);
            httpResponse = response;
        }

        @Override
        public ServletOutputStream getOutputStream() throws IOException
        {
            if (acquired == StreamType.WRITER)
                throw new IllegalStateException("Character stream already acquired.");

            if (outputStream != null)
                return outputStream;

            if (hasContentLength())
            {
                outputStream = super.getOutputStream();
            }
            else
            {
                outputStream = new BufferingOutputStream();
                buffering = true;
            }

            acquired = StreamType.OUTPUT_STREAM;
            return outputStream;
        }

        @Override
        public PrintWriter getWriter() throws IOException
        {
            if (acquired == StreamType.OUTPUT_STREAM)
                throw new IllegalStateException("Binary stream already acquired.");

            if (writer != null)
                return writer;

            if (hasContentLength())
            {
                writer = super.getWriter();
            }
            else
            {
                writer = new PrintWriter(new OutputStreamWriter(
                    getOutputStream(), getCharacterEncoding()), false);
            }

            acquired = StreamType.WRITER;
            return writer;
        }

        /**
         * Returns <code>true</code> if the user set <code>Content-Length</code>
         * explicitly.
         */
        private boolean hasContentLength()
        {
            return super.containsHeader("Content-Length");
        }

        /**
         * Push out the buffered data.
         */
        public void pushBuffer() throws IOException
        {
            if (!buffering)
                throw new IllegalStateException("Not buffering.");

            BufferingOutputStream bufferedStream = 
                (BufferingOutputStream) outputStream;

            byte [] buffer = bufferedStream.baos.toByteArray();
            httpResponse.setContentLength(buffer.length);
            httpResponse.getOutputStream().write(buffer);
        }
    }

    public void doFilter(ServletRequest req, ServletResponse resp, FilterChain chain)
        throws IOException, ServletException
    {
        final HttpServletResponse response = (HttpServletResponse) resp;
        final BufferingHttpServletResponse wrapped = 
            new BufferingHttpServletResponse(response);

        chain.doFilter(req, wrapped);

        if (wrapped.buffering)
        {
            wrapped.pushBuffer();
        }
    }

    public void destroy()
    {
        // Empty
    }

    public void init(FilterConfig config) throws ServletException
    {
        // Empty
    }
} 
```

# ruby-on-rails - 如何更新此文档结构中数组中的项目？

> ID：11659334
> 
> 赞同：0
> 
> 时间：2012-07-25T22:04:04.127
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, mongodb

我有以下文档结构：

```
{
  "_id" : "20120725/foobar/song/test-pg3-long-title-here-test-lorem-ipsum-dolor-lo",
  "live_daily_count" : 4,
  "metacontent" : { "date" : "20120725",
    "live_daily_statable_slug" : "test-pg3-long-title-here-test-lorem-ipsum-dolor-lo",
    "live_daily_statable_title" : "test pg3 long title here test lorem ipsum dolor lorem ipsume dolor long description here msam dfam sdfm asfa sfasfas df as f as fas f sa f",
    "live_daily_statable_type" : "Song",
    "url" : "foobar/songs/test-pg3-long-title-here-test-lorem-ipsum-dolor-lo",
    "user_slug" : "foobar" },
  "visits" : [
    { "country_name" : "UK",
      "iso_two_letter_country_code" : "UK",
      "referer" : "http://localhost:3000/",
      "minute" : 1121,
      "token_id" : "13432416893tlfsmmgh" },
    { "country_name" : "UK",
      "iso_two_letter_country_code" : "UK",
      "referer" : "http://localhost:3000/",
      "minute" : 1281,
      "token_id" : "13432512733xcqhhrqs" },
    { "country_name" : "UK",
      "iso_two_letter_country_code" : "UK",
      "referer" : "http://localhost:3000/",
      "minute" : 1285,
      "token_id" : "13432515303rwiaczcx" },
    { "country_name" : "UK",
      "iso_two_letter_country_code" : "UK",
      "referer" : "http://localhost:3000/",
      "minute" : 1288,
      "token_id" : "13432517303eusgjcgz" }
  ]
} 
```

如何找到访问`token_id` `13432515303rwiaczcx`并将其更新`minute`为 1234？

我可以`find`使用聚合框架（下面的代码）来处理数组中的项目，但是如何更新它呢？

```
 connection = Mongo::Connection.new
  database   = conn['foobar_development']

  query = {
    aggregate: 'live_daily_stats',
    pipeline: [
      { '$project' => {
        :visits => 1,
      } },
      { '$unwind' => '$visits' },
      { '$match' => { 'visits.token_id' => '13432515303rwiaczcx' } },
    ]
  }

  visit = database.command(query)['result'][0] 
```

返回：

```
{
       "_id" => "20120725/foobar/song/test-pg3-long-title-here-test-lorem-ipsum-dolor-lo",
    "visits" => {
                                      "country_name" => "UK",
                       "iso_two_letter_country_code" => "UK",
                                           "referer" => "http://localhost:3000/",
                                            "minute" => 1285,
                                          "token_id" => "13432515303rwiaczcx"
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:46:37.853

聚合框架并非旨在更新集合中的现有文档。正如 idefine 指出的那样，您可以使用位置运算符：

输入：

```
{
  "_id" : xyz
  "visits" : [
    {"minute" : 1281,
      "token_id" : 1 },
    { "minute" : 1285,
      "token_id" : 2 },
    { "minute" : 1288,
      "token_id" : 3 }
  ]
} 
```

更新：

```
db.collection.update({"visits.token_id":2}, {$inc:{"visits.$.minute":1}}) 
```

结果：

```
{
  "_id" : xyz
  "visits" : [
    {"minute" : 1281,
      "token_id" : 1 },
    { "minute" : 1286,
      "token_id" : 2 },
    { "minute" : 1288,
      "token_id" : 3 }
  ]
} 
```

# ruby-on-rails - Heroku 无法推送 'git@github.com:lgs/mongoid_taggable_with_context.git'

> ID：11659335
> 
> 赞同：1
> 
> 时间：2012-07-25T22:04:08.127
> 
> 标签：ruby-on-rails, ruby, deployment, heroku, cloud

Heroku 推送失败是由 Gemfile 中的以下 gem 引起的：

gem 'mongoid_taggable_with_context', :git => 'git@github.com:lgs/mongoid_taggable_with_context.git'

```
lsoave@ubuntu:~/rails/github/gitwatcher$ git push heroku +master
Counting objects: 233, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (196/196), done.
Writing objects: 100% (199/199), 286.76 KiB | 62 KiB/s, done.
Total 199 (delta 160), reused 2 (delta 2)

-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Using Ruby version: ruby-1.9.3
-----> Installing dependencies using Bundler version 1.2.0.rc
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment
       Fetching gem metadata from http://rubygems.org/.......
       Fetching gem metadata from http://rubygems.org/..
       Updating git://github.com/rweng/jquery-datatables-rails.git
       Fetching git@github.com:lgs/mongoid_taggable_with_context.git
       Host key verification failed.
       fatal: The remote end hung up unexpectedly
       Git error: command `git clone 'git@github.com:lgs/mongoid_taggable_with_context.git' "/tmp/build_1mck6mlqu6pko/vendor/bundle/ruby/1.9.1/cache/bundler/git/mongoid_taggable_with_context-cf14763a075f5ec09e40c360c8537afb67040db7" --bare --no-hardlinks` in directory /tmp/build_1mck6mlqu6pko has failed.
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app

To git@heroku.com:gitwatcher.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:gitwatcher.git'
lsoave@ubuntu:~/rails/github/gitwatcher$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:17:57.517

试过这个？

`gem 'mongoid_taggable_with_context', :git => 'git://github.com/lgs/mongoid_taggable_with_context.git'`

# matlab - Matlab中如何改变坐标轴的大小

> ID：11659336
> 
> 赞同：1
> 
> 时间：2012-07-25T22:04:08.187
> 
> 标签：matlab, plot

我有这样的情节 ![在此处输入图像描述](../Images/53ef852750d1b18e8a3cbb54577869f8.png)

如何将 y 轴的长度更改为 [0 20] 以获得更大的绘图大小。假设我想要 x 轴 [0 20] y 轴 [0 20]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:05:59.743

命令后立即`plot`：

```
set(gca, 'ylim', [0 20], 'xlim', [0 20]); 
```

# php - php打印出数组

> ID：11659339
> 
> 赞同：1
> 
> 时间：2012-07-25T22:04:16.283
> 
> 标签：php, html, arrays, forms

我有一个数组，无法真正缩小打印所有内容的正确方法。

大批：

```
$month = Array(
    "1" => "January",
    "2" => "February",
    "3" => "March",
    "4" => "April",
    "5" => "May",
    "6" => "June",
    "7" => "July",
    "8" => "August",
    "9" => "September",
    "10" => "October",
    "11" => "November",
    "12" => "December"
); 
```

我试过的：

```
function monthList() {
    require "config.php";
        echo '<select name="month" title="Choose A Month">';
    foreach ($month as $i => $value) {
        echo '<option value="'.the_month_#_here.'">'.$month[$i].'</option>';
    }
        echo '</select>';
} 
```

哪个可以很好地提取名称，但我将如何提取数组中与其关联的数字？这就是我需要的`option value`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:06:11.290

```
function monthList() {
    require "config.php";
        echo '<select name="month" title="Choose A Month">';
    foreach ($month as $i => $value) {
        echo '<option value="'.$i.'">'.$value.'</option>';
    }
        echo '</select>';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:06:24.957

采用

```
echo '<option value="'.$i.'">'.$value.'</option>'; 
```

代替

```
echo '<option value="'.the_month_#_here.'">'.$month[$i].'</option>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:08:29.623

试试这个希望这会有所帮助:)。

```
 function monthList() {
        require "config.php";
            echo '<select name="month" title="Choose A Month">';
        foreach ($month as $i => $value) {
            echo '<option value="'.$i.'">'.$value.'</option>';
        }
            echo '</select>';
    } 
```

祝你好运。

# sql - Oracle - 如何在不使用 GROUP BY 的情况下过滤掉重复的行

> ID：11659340
> 
> 赞同：0
> 
> 时间：2012-07-25T22:04:23.083
> 
> 标签：sql, oracle, oracle11g

我有以下查询：

```
select
   C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID, C.MODIFIEDDATE, V.NAME
from TPM_PROJECTCHANGES C
inner join TPM_PROJECTVERSION V ON C.PROJECTID = V.PROJECTID AND C.VERSIONID = V.VERSIONID
where C.MODIFIEDDATE BETWEEN TO_DATE('07/18/12', 'MM/DD/YY') and TO_DATE('07/25/12', 'MM/DD/YY') 
```

我想显示特定日期之间项目中的所有更改。这工作正常。但是，我有很多重复项（例如，如果有人在同一个项目上更改了 50 次相同的属性）。我想过滤掉那些，只显示项目中某个属性更改的最近时间。我可以做这样的事情：

```
select
   C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID, MAX(C.MODIFIEDDATE)
from TPM_PROJECTCHANGES C
having MAX(C.MODIFIEDDATE) BETWEEN TO_DATE('07/18/12', 'MM/DD/YY') and TO_DATE('07/25/12', 'MM/DD/YY')
group by C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID 
```

但是，现在我什么都不能`JOIN`进去。例如，如果我尝试：

```
select
   C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID, MAX(C.MODIFIEDDATE), V.NAME
from TPM_PROJECTCHANGES C
inner join TPM_PROJECTVERSION V ON C.PROJECTID = V.PROJECTID AND C.VERSIONID = V.VERSIONID
having MAX(C.MODIFIEDDATE) BETWEEN TO_DATE('07/18/12', 'MM/DD/YY') and TO_DATE('07/25/12', 'MM/DD/YY')
group by C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID 
```

我会得到错误：

> ORA-00979: 不是 GROUP BY 表达式

有没有更好的方法来过滤对同一项目的重复更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:15:33.740

您还可以使用分析函数：

```
select PROJECTID, VERSIONID, MODIFIEDATTRIBUTEID, MODIFIEDDATE, Name
from (select C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID, C.MODIFIEDDATE, V.NAME,
             row_number() over (partition by C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID, V.NAME
                                order by C.MODIFIEDDATE desc) as seqnum
      from TPM_PROJECTCHANGES C inner join
           TPM_PROJECTVERSION V ON C.PROJECTID = V.PROJECTID AND C.VERSIONID = V.VERSIONID
      where C.MODIFIEDDATE BETWEEN TO_DATE('07/18/12', 'MM/DD/YY') and
                                   TO_DATE('07/25/12', 'MM/DD/YY')
     ) t
where seqnum = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:08:13.537

`HAVING`应该是您查询的最后一行：

```
select
   C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID, MAX(C.MODIFIEDDATE), V.NAME
from TPM_PROJECTCHANGES C
inner join TPM_PROJECTVERSION V 
ON C.PROJECTID = V.PROJECTID AND C.VERSIONID = V.VERSIONID
group by C.PROJECTID, C.VERSIONID, C.MODIFIEDATTRIBUTEID, V.NAME
having MAX(C.MODIFIEDDATE) BETWEEN TO_DATE('07/18/12', 'MM/DD/YY') and TO_DATE('07/25/12', 'MM/DD/YY') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:17:14.677

*SQL 查询组合*的基本规则如下。将您的工作 SQl 查询包装在括号中，并将其内联为视图：

```
select
   V.NAME, IC.* 
from (/*working query against TPM_PROJECTCHANGES here*/ ) IC
inner join TPM_PROJECTVERSION V ... 
```

关于最后一个查询的语法，group by list 应该比你的 select 子句容纳更多的列，而不是更少（当然不包括聚合）。

# c++ - 将字符串转换为 int 失败

> ID：11659344
> 
> 赞同：-1
> 
> 时间：2012-07-25T22:04:36.407
> 
> 标签：c++

我正在尝试使用 stringstream 将字符串转换为 int，下面的代码可以工作，但是如果我使用的数字超过**1234567890**，比如**12345678901** ，那么它会返回**0** ...我不知道如何解决这个问题，请帮助我出去

```
std:: string number= "1234567890";

int Result;//number which will contain the result

std::stringstream convert(number.c_str()); // stringstream used for the conversion initialized with the contents of Text

if ( !(convert >> Result) )//give the value to Result using the characters in the string
    Result = 0;

printf ("%d\n", Result); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:06:53.880

int 可以包含的最大数量略大于 20 亿。（假设 ubiquitios 32 位整数）

它只是不适合 int！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:07:39.793

最大的 unsigned int （在 32 位平台上）是 2^32 (4294967296)，并且您的输入比这大，所以它放弃了。我猜你可以以某种方式从中获取错误代码。也许检查`failbit`或`badbit`？

```
int Result;
std::stringstream convert(number.c_str());
convert >> Result;
if(convert.fail()) {
    std::cout << "Bad things happened";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T22:09:00.603

如果您使用的是 32 位或 LP64 64 位系统，则 int 是 32 位，因此您可以存储的最大数字约为 20 亿。尝试使用 long 或 long long，并将“%d”适当地更改为“%ld”或“%lld”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-25T22:09:05.753

有符号整数的（通常）最大值是 2.147.483.647，因为它（通常）是一个 32 位整数，因此对于更大的数字它会失败。

如果你用它替换`int Result;`它`long Result;`应该适用于更大的数字，但仍然有一个限制。您可以使用`unsigned`整数类型将该限制扩大 2 倍，但前提是您不需要负数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-25T22:26:33.027

嗯，现有的四五个答案中有很多**虚假信息。**

An`int`最小为 16 位，对于常见的桌面系统编译器，它通常是 32 位（在所有 Windows 版本中）或 64 位。对于 32 位，它最多有 2 ^(32 个)不同的值，设置 K=2 ^(10) = 1024，是 4·K ³，即大约 40 亿。离您最近的计算器或 Python 提示符可以告诉您确切的值。

A`long`至少是 32 位，但这对您当前的问题没有帮助，因为在所有现存的 Windows 变体中，包括 64 位 Windows，`long`都是 32 位......

因此，要获得比 更好的范围`int`，请使用**`long long`**。它至少是 64 位，实际上，截至 2012 年，所有编译器都是 64 位。或者，只使用 a `double`，虽然不是整数类型，但最常见的实现（IEEE 754 64 位）可以精确地表示整数值，我记得大约 51 或 52 位 - 如果你想要准确的，请查看位数。

无论如何，请记住*检查流是否有转换失败*，您可以通过`s.fail()`或简单地执行此操作`!s`（更准确地说，这相当于`fail()`流的显式转换为`bool`返回`!fail()`）。

# vba - word VBA将表单字段更改为数字

> ID：11659349
> 
> 赞同：2
> 
> 时间：2012-07-25T22:04:59.387
> 
> 标签：vba, ms-word, formfield

我正在使用 Word VBA 创建一个表单域，然后在该域中插入一个值。

问题是我需要更改我创建的字段的数据类型。

代码：

```
 ActiveDocument.Bookmarks("Loan_Amount").Select
  ActiveDocument.FormFields.Add FFHere, wdFieldFormTextInput
  ActiveDocument.FormFields("Text1").Result = Value 
```

到处打猎，但找不到有关该主题的任何内容。更改字段书签的名称也很好（默认情况下称为“Text1”）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:59:48.353

> 更改字段书签的名称也很好（默认情况下称为“Text1”）。

像这样？

```
Sub Sample()
    Dim ff As FormField

    ActiveDocument.Bookmarks("Loan_Amount").Select

    Set ff = ActiveDocument.FormFields.Add(FFHere, wdFieldFormTextInput)
    ff.Name = "BlahBlah"
End Sub 
```

这是一个插入文本字段但将其更改为日期字段的示例

```
Sub Sample()
    Dim ff As FormField
    Set ff = ActiveDocument.FormFields.Add(FFHere, wdFieldFormTextInput)
    ff.Select
    With Selection.FormFields(1)
        '~~> Change Name Here
        .Name = "BlahBlah"
        '~~> Change Type here
        With .TextInput
            .EditType Type:=wdCurrentDateText, Default:="", Format:=""
            .Width = 0
        End With
    End With
End Sub 
```

您可以将其更改为的其他类型是

1.  `wdCurrentDateText`
2.  `wdCalculationText`
3.  `wdCurrentTimeText`
4.  `wdDateText`
5.  `wdNumberText`（这是您的问题所要求的）

**注意**：我假设这`FFHere`是一个有效范围

# android - 在 android ICS 错误中使用 webview 播放 youtube 视频：“OnBufferingUpdateListener 为空”

> ID：11659352
> 
> 赞同：2
> 
> 时间：2012-07-25T22:05:08.563
> 
> 标签：android, webview, youtube, android-4.0-ice-cream-sandwich

我正在使用 webview 和 google API for youtube (iframe) 播放 youtube 视频。只要我使用蜂窝，一切都很好，但是一旦切换到 ICS，我就会收到以下错误：错误：“OnBufferingUpdateListener 为空”

有没有人有同样的问题以及如何解决它？（我应该说，尽管出现错误，应用程序仍在继续工作。）

谢谢，

# css - 垂直对齐到父 div 的顶部和底部

> ID：11659353
> 
> 赞同：0
> 
> 时间：2012-07-25T22:05:14.990
> 
> 标签：css, vertical-alignment

我试图在不使用 javascript 和不使用表格的情况下实现以下布局：

页面上有很多行。每行由四个内容元素填充，其中最高的元素决定了行的高度。每个内容元素都有两个其他元素，在这种情况下，一个图像和一个标题。图像与行顶部对齐，而标题与底部对齐。

在 HTML 结构中，图像和标题必须在内容元素中保持在一起。

**我尝试过的一些解决方案：**

将每一行分成两部分：一行图像和一行标题，将图像与标题分开。

使用著名的[等高列](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)div 结构会产生一个丑陋的绝对定位的 Matryoshka Doll 排列的 div。

表格的问题在于，将来页面将变得更加动态（可重新排列的内容、流畅的布局、动态搜索、可变宽度的内容），而表格将非常烦人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:14:44.400

如果我正确地想象你的标记，也许这对你有用：

[http://jsfiddle.net/Puppies4Life/Fd94X/1/](http://jsfiddle.net/Puppies4Life/Fd94X/1/)

我将 .caption 绝对定位到 .row 的底部。由于 .content 的高度不同，我将 .caption 定位到 .row 而不是直接父级 .content 非常重要。图像保留在文档流中。我在 .row 的底部添加了一些额外的填充以说明文本并进行了简单清晰的修复（[我建议在您的生产代码中使用更好的选项](http://nicolasgallagher.com/micro-clearfix-hack/)）

希望这有助于解决您的问题或可能引发一两个想法！

# c# - 带返回值的 C# 委托方法

> ID：11659361
> 
> 赞同：1
> 
> 时间：2012-07-25T22:05:55.407
> 
> 标签：c#, multithreading, delegates, return

我正在制作一个运行 2 个线程的 C# 程序。主 UI 线程和我自己制作的单独网络线程。

我发现，如果我需要从网络线程更改 UI 中的某些内容，我将需要调用一个 deligate 方法，它工作得很好：

```
// Declared as a global variable
public delegate void ListBoxFirst();

//Then call this from the network thread
listBox1.BeginInvoke(new ListBoxFirst(InitListBox));

//Which points to this
public void InitListBox() {
     listBox1.SelectedIndex = 0;
} 
```

现在我需要能够从网络线程中读取 UI 值（listbox.selectedindex），但如果我以相同的方式尝试，它会显示错误“无法将类型'system.iasyncresult' 隐式转换为'int'”（当然用“int”代替“void”，并且在listbox1.begininvoke之前有一个“int a =”）。我用谷歌搜索了很多，但我对 C# 很陌生，所以我真的迷路了。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T08:38:15.737

我想到了：

```
public int ReadListBoxIndex()
    {
        int count = 0;
        listBox1.Invoke(new MethodInvoker(delegate
        {
            count = listBox1.SelectedIndex;
        }));
        return count;
    } 
```

Called with a regular

```
int count = ReadListBoxIndex(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:09:08.327

你需要打电话`EndInvoke()`才能得到结果。

一些代码：

```
 public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            listBox1.Items.AddRange(new[] { "AS","Ram"});           
        }

        protected override void OnLoad(EventArgs e)
        {
            listBox1.BeginInvoke(new Action(GetResult));
        }

        private void GetResult()
        {
            if (InvokeRequired)
            {
                Invoke(new Action(GetResult));
            }
            listBox1.SelectedIndex = 0;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-29T15:28:37.650

This works also, where `tn` is the treenode you want added to cross thread and `tnret` is the treenode that is returned.

`_treeView.Invoke(new Action(() => tnret = tn.Nodes.Add( name, name )));`

# python - 如何通过 Facebook Graph API 动态共享链接？

> ID：11659369
> 
> 赞同：-1
> 
> 时间：2012-07-25T22:06:28.440
> 
> 标签：python, facebook, facebook-graph-api

我正在尝试通过 facebook 发送独特的链接，但我希望可以选择将其作为消息发送、发布在我的墙上或发布在朋友的墙上。类似于发送按钮的东西，但具有更多功能并且能够指定我要发送的链接。如何使用 FB Graph？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-07-25T22:28:33.407

最简单的方法是使用[Dialogs使用](http://developers.facebook.com/docs/reference/javascript/FB.ui/)[Facebook JS SDK](http://developers.facebook.com/docs/reference/javascript/)

*   要作为消息发送，请将“方法”参数更改为“发送”
*   要在墙上发帖，请将 'method' 参数更改为 'feed'
*   要发布到朋友墙，请添加“to”参数，然后指定要发布到的朋友 ID。

# android - Android Ninepatch 工具源码

> ID：11659372
> 
> 赞同：2
> 
> 时间：2012-07-25T22:06:41.273
> 
> 标签：android, nine-patch

我在哪里可以找到 Android SDK 中存在的“ninepatch”工具的源代码？我假设它是一个java应用程序。我想让它更好地供我自己使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:25:19.323

您将在 AOSP 源代码中找到 NinePatch 工具`development/apps/NinePatchLab`。当然，如果您没有 AOSP 源，请不要担心，因为它可以位于[github 上](https://github.com/android/platform_development/tree/master/apps/NinePatchLab)，单个源文件。

# javascript - 如果 jQuery 元素 hasClass() 改变不同的元素链接文本

> ID：11659377
> 
> 赞同：1
> 
> 时间：2012-07-25T22:07:02.333
> 
> 标签：javascript, jquery, html

我正在使用 jQuery 函数向单击的元素添加/删除一个类，效果很好。但是，当单击该元素时，我正在尝试更改 HTML 链接的文本，但似乎无法使其正常工作。HTML 链接位于`<span>`页面下方的元素内。

当`<button id="people">`hasClass('user_view_active') 时，HTML 链接应显示“People”，而当`<button id="jobs">`hasClass('user_view_active') 时，HTML 链接应显示“工作”。

```
 <script type="text/javascript">
                $(document).ready(function() {
        $('button').click(function(){
            $('button').each(function(){
                $(this).removeClass('user_view_active'); 
            });
        $(this).addClass('user_view_active');
        });

        if ($('#people').hasClass('user_view_active')){
            $('.title').find("a").attr("href").text(text.replace('People'));
        }else{
            $('.title').find("a").attr("href").text(text.replace('Jobs'));
        }
    });
    </script>

</head>
<body>
<div id="container">

    <header>
            <img src="images/header-name.png" width="200px" style="display: inline; margin-bottom: -10px;"/>
            <button id="jobs" class="user_view"><a href="#">Jobs</a></button> 
            <button id="people" class="user_view_active user_view"><a href="#">People</a></button>

            <div class="header_search_wrapper">
                <form action="" method="POST">
                    <textarea class="header_search" name="app_search" placeholder="Search people, jobs, or companies" style="width: 430px;"></textarea>

                    <input type="submit" class="share_btn" value="Search">
                </form>
            </div>
    </header>

    <div id="main" role="main">
        <!--! begin app content -->

        <div class="right_sidebar">
        <span class="right_title">Connection Suggestions</title>

        </div>

        <span class="title">Recent Updates >> <a href="#">People</a></span> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:09:06.530

要替换链接中的文本，您可以使用[jQuery`.text()`函数](http://api.jquery.com/text/)。此函数还可以获取文本值并设置文本值 - 如下例所示 -

```
if ($('#people').hasClass('user_view_active')){
  $('.title').find("a").text('People'); 
}else{
  $('.title').find("a").text('Jobs'); 
} 
```

此代码必须包含在 click 事件的回调函数中才能工作 -

```
$(document).ready(function() {
  $('button').click(function(){
    $('button').removeClass('user_view_active'); 
    $(this).addClass('user_view_active');
    if ($('#people').hasClass('user_view_active')){
      $('.title').find("a").text('People');
    }else{
      $('.title').find("a").text('Jobs');
    }
  });
}); 
```

现在每次单击按钮时，您都可以检查元素`user_view_active`上是否存在类。`#people`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:25:37.010

好吗？

你确定这些是正确的标签吗？

```
<span class="right_title">Connection Suggestions</title> 
```

您确定`<a>`元素中的`<button>`元素是个好主意吗？

```
<button id="jobs" class="user_view"><a href="#">Jobs</a></button> 
```

`role="main"`不是一个有效的属性，但可能无论如何都会起作用。

这似乎更容易：

```
$(document).ready(function() {
    $('button').on('click', function(){
        $('button').removeClass('user_view_active');; 
        $(this).addClass('user_view_active');
        $("a", ".title").text(this.id);
    });
}); 
```

[小提琴](http://jsfiddle.net/8uWzg/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-17T06:42:36.320

**试试这个方法：**

```
$('#people').toggleClass('user_view_active').html($('#people').hasClass('user_view_active')?'People':'Jobs'); 
```

# mysql - fork 内联Mysql

> ID：11659387
> 
> 赞同：-2
> 
> 时间：2012-07-25T22:07:58.917
> 
> 标签：mysql

在mysql中可以在命令“SET”中创建一个fork吗？

像这样：

```
UPDATE `table`.`data` SET `hits` = (`hits`-1<0 ? 0:`hits`-1) WHERE `data`.`id`='15'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:09:00.230

使用[`IF`功能](http://dev.mysql.com/doc/refman/5.5/en/control-flow-functions.html#function_if)：

```
UPDATE `table`.`data`
SET `hits` = IF(`id` - 1 > 0, 0, `id` - 1)
WHERE `data`.`id`='15'; 
```

在这种特定情况下，您还可以使用[`LEAST`](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_least).

```
UPDATE `table`.`data`
SET `hits` = LEAST(`id` - 1, 0)
WHERE `data`.`id`='15'; 
```

不过，您的代码似乎是错误的。我几乎可以肯定你的意思是写这个：

```
UPDATE yourtable
SET hits = GREATEST(0, hits - 1)
WHERE id = 15; 
```

# html - 移动菜单导航（边距？）

> ID：11659388
> 
> 赞同：0
> 
> 时间：2012-07-25T22:07:59.190
> 
> 标签：html, css, styling

我需要将此导航菜单移动到内容框上方和徽标下方。换句话说，顺序应该是：（1）标志，（2）菜单，和（3）内容框。

我尝试了对 CSS 的各种边距调整，`#navigation`但无济于事。

我该怎么做呢？

网址：[http ://ec2-174-129-169-80.compute-1.amazonaws.com/](http://ec2-174-129-169-80.compute-1.amazonaws.com/)

看截图：

![截屏](../Images/b13b1b5ea9aa9ef7770ec81f9ab2bd98.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:12:12.817

您可以像这样添加`top: -57px;`到您的#navigation CSS：

```
#navigation {
    position: relative;
    top: -57px;
    clear: both;
    margin-bottom: 3em;
    display: none;
    font: 14px/14px sans-serif;
    border: 1px solid #D9D9D9;
    background: white;
    background: -webkit-gradient(linear, left top, left bottom, from(white), to(whiteSmoke));
    background: -webkit-linear-gradient(white, whiteSmoke);
    background: -moz-linear-gradient(center top, white 0%, whiteSmoke 100%);
    background: -moz-gradient(center top, white 0%, whiteSmoke 100%);
    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.03);
    -webkit-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.03);
    -moz-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.03);
    border-radius: 5px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:12:35.037

请制作一个 jsFiddle 或发布您的代码。在没有看到代码的情况下，首先想到的是您将其`#navigation`放入内容区域。如果是这样的话，那么：

```
#navigation { margin-top: -50px; } 
```

如果`#navigation`是绝对定位：

```
#navigation { top: -50px; } 
```

# java - 在 Java 中创建 XBRL 文档？

> ID：11659391
> 
> 赞同：1
> 
> 时间：2012-07-25T22:08:16.377
> 
> 标签：java, xbrl

我刚开始使用 XBRL。您使用什么 Java 库来创建 XBRL 文档？

我发现很难找到用于 XBRL 创建/操作的“开源”Java 库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:15:32.940

@edbras：查看 Arelle.org。它不是 Java，但它是免费的，它是 python 和一些 java，应该足够接近。如果您有兴趣，还有其他商业选择。

问候，

每索利

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T19:55:17.190

我使用 JAXB，似乎工作正常。我使用 jaxb ref 实现创建 java 代码并通过工厂使用它...

# soap - codeigniter2、nusoap、soap 服务器和示例

> ID：11659394
> 
> 赞同：0
> 
> 时间：2012-07-25T22:08:28.653
> 
> 标签：soap, codeigniter-2, nusoap

一个早上的谷歌搜索，我学到了一些东西。许多人希望使用他们的 CI2 安装来为其他应用程序创建一个肥皂服务器来与他们的应用程序通信。但是，我发现的每个论坛帖子都以“这在 CI2 中不起作用”或类似内容结尾。

我找到了这篇文章： http: [//phpmaster.com/web-services-with-php-and-soap-1/](http://phpmaster.com/web-services-with-php-and-soap-1/)

这是伟大的......但我不能让它在 CI2 中工作。

我已经将我的库放在适当的位置，并在需要的地方重命名，并且这段代码带来了许多错误。我还没有开始在客户端。

`肥皂类扩展 CI_Controller {

```
function __construct ()
{
    parent:: __construct ();
    $this->load->library('nusoap_base');
}

function index()
{
    $this->nusoap = new soap_server();
    $this->nusoap->register("getProd");
    $this->nusoap->service($HTTP_RAW_POST_DATA);
}

function getProd($category) {
    if ($category == "books") {
        return join(",", array(
            "The WordPress Anthology",
            "PHP Master: Write Cutting Edge Code",
            "Build Your Own Website the Right Way"));
    }
    else {
            return "No products listed under that category";
    }
} 
```

}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T18:42:30.333

受够了，改用 CI REST 库（干杯菲尔！）:)

# java - 将 jProgressBar 与 SaxParser 一起使用

> ID：11659396
> 
> 赞同：-1
> 
> 时间：2012-07-25T22:08:51.210
> 
> 标签：java, parsing, sax, saxparser, jprogressbar

我的问题解决了。这是代码：

SwingWorker 类：

```
package ths.turnier;

import javax.swing.SwingUtilities;

/**
* This is the 3rd version of SwingWorker (also known as
* SwingWorker 3), an abstract class that you subclass to
* perform GUI-related work in a dedicated thread.  For
* instructions on using this class, see:
* 
* http://java.sun.com/docs/books/tutorial/uiswing/misc/threads.html
*
* Note that the API changed slightly in the 3rd version:
* You must now invoke start() on the SwingWorker after
* creating it.
*/
public abstract class SwingWorker {
private Object value;  // see getValue(), setValue()
private Thread thread;

/** 
 * Class to maintain reference to current worker thread
 * under separate synchronization control.
 */
private static class ThreadVar {
    private Thread thread;
    ThreadVar(Thread t) { thread = t; }
    synchronized Thread get() { return thread; }
    synchronized void clear() { thread = null; }
}

private ThreadVar threadVar;

/** 
 * Get the value produced by the worker thread, or null if it 
 * hasn't been constructed yet.
 */
protected synchronized Object getValue() { 
    return value; 
}

/** 
 * Set the value produced by worker thread 
 */
private synchronized void setValue(Object x) { 
    value = x; 
}

/** 
 * Compute the value to be returned by the <code>get</code> method. 
 */
public abstract Object construct();

/**
 *           public void run() { finished(); } Called on the event dispatching thread (not on the worker thread)
 * after the <code>construct</code> method has returned.
 */
public void finished() {
}

/**
 * A new method that interrupts the worker thread.  Call this method
 * to force the worker to stop what it's doing.
 */
public void interrupt() {
    Thread t = threadVar.get();
    if (t != null) {
        t.interrupt();
    }
    threadVar.clear();
}

/**
 * Return the value created by the <code>construct</code> method.  
 * Returns null if either the constructing thread or the current
 * thread was interrupted before a value was produced.
 * 
 * @return the value created by the <code>construct</code> method
 */
public Object get() {
    while (true) {  
        Thread t = threadVar.get();
        if (t == null) {
            return getValue();
        }
        try {
            t.join();
        }
        catch (InterruptedException e) {
            Thread.currentThread().interrupt(); // propagate
            return null;
        }
    }
}

/**
 * Start a thread that will call the <code>construct</code> method
 * and then exit.
 */
public SwingWorker() {
    final Runnable doFinished = new Runnable() {
       public void run() { finished(); }
    };

    Runnable doConstruct = new Runnable() { 
        public void run() {
            try {
                setValue(construct());
            }
            finally {
                threadVar.clear();
            }

            SwingUtilities.invokeLater(doFinished);
        }
    };

    Thread t = new Thread(doConstruct);
    threadVar = new ThreadVar(t);
}

/**
 * Start the worker thread.
 */
public void start() {
    Thread t = threadVar.get();
    if (t != null) {
        t.start();
    }
}
} 
```

监控输入流：

```
/**
* A class that monitors the read progress of an input stream.
* 
* @author Hermia Yeung "Sheepy"
* @since 2012-04-05 18:42
*/ 
public class MonitoredInputStream extends FilterInputStream {
private volatile long mark = 0;
private volatile long lastTriggeredLocation = 0;
private volatile long location = 0;
private final int threshold;
private final List<ChangeListener> listeners = new ArrayList<ChangeListener>(4);

/**
* Creates a MonitoredInputStream over an underlying input stream.
* @param in Underlying input stream, should be non-null because of no public setter
* @param threshold Min. position change (in byte) to trigger change event.
*/
public MonitoredInputStream(InputStream in, int threshold) {
  super(in);
  this.threshold = threshold;
}

/**
* Creates a MonitoredInputStream over an underlying input stream.
* Default threshold is 16KB, small threshold may impact performance impact on larger streams.
* @param in Underlying input stream, should be non-null because of no public setter
*/
public MonitoredInputStream(InputStream in) {
  super(in);
  this.threshold = 1024*16;
}

public void addChangeListener(ChangeListener l) { if (!listeners.contains(l)) listeners.add(l); }
public void removeChangeListener(ChangeListener l) { listeners.remove(l); }
public long getProgress() { return location; }

protected void triggerChanged( final long location ) {
  if ( threshold > 0 && Math.abs( location-lastTriggeredLocation ) < threshold ) return;
  lastTriggeredLocation = location;
  if (listeners.size() <= 0) return;
  try {
     final ChangeEvent evt = new ChangeEvent(this);
     for (ChangeListener l : listeners) l.stateChanged(evt);
  } catch (ConcurrentModificationException e) {
     triggerChanged(location);  // List changed? Let's re-try.
  }
}

@Override public int read() throws IOException {
  final int i = super.read();
  if ( i != -1 ) triggerChanged( location++ );
  return i;
}

@Override public int read(byte[] b, int off, int len) throws IOException {
  final int i = super.read(b, off, len);
  if ( i > 0 ) triggerChanged( location += i );
  return i;
}

@Override public long skip(long n) throws IOException {
  final long i = super.skip(n);
  if ( i > 0 ) triggerChanged( location += i );
  return i;
}

@Override public void mark(int readlimit) {
  super.mark(readlimit);
  mark = location;
}

@Override public void reset() throws IOException {
  super.reset();
  if ( location != mark ) triggerChanged( location = mark );
}
} 
```

如何使用这个：

```
void updateProgressWknAdd(final int i)
{
Runnable doSetProgress = new Runnable() {
public void run() {
progressWknAdd.setValue(i);
}
};
SwingUtilities.invokeLater(doSetProgress);
}

   Object doWorkWkn(String pfad) {
// Code which reads file + setting the max of jprogressbar to file size. and:
final MonitoredInputStream mis = new MonitoredInputStream(fis);
        mis.addChangeListener( new ChangeListener() { @Override public void stateChanged(ChangeEvent e) {
        updateProgressWknRead((int) mis.getProgress()); 
        }});
} 
```

如何使用工人：

```
 SwingWorker worker = new SwingWorker() {
            public Object construct() {
                return doWorkWkn(pfad_zur_datei);
            }

            public void finished() {
                frame_progressbar.setVisible(false);
            }
        };
        worker.start(); 
```

swingWorker 运行 doWorkWkn 直到完成。之后，将 jFrame 设置为不可见。doWorkWkn() 读取文件并添加一个 changeListener，它会在每次更改时更新进度条。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T03:02:17.957

Swing**不是**线程安全的。

UI 不会更新，因为您在读取文件时阻塞了[EventDispatchingThread](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)。这会阻止进度条在屏幕上更新。

正如@LanguagesNamedAfterCofee 所建议的那样，您应该使用[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)来执行文件的实际读取并允许它的更新方法（`publish`和`setProgress`）来更新 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:15:22.873

在您使用的代码中的某处，您使用的`diamond operator`是`<>`您必须将其解析为匹配的泛型。

像转换`List<String> foo = new ArrayList<>();`为`List<String> foo = new ArrayList<String>();`

只需搜索`<>`事件并解决它。

# c# - 为什么 IEnumerable 每次都选择运行？

> ID：11659397
> 
> 赞同：0
> 
> 时间：2012-07-25T22:08:54.753
> 
> 标签：c#, linq

我花了一秒钟来看看为什么我的应用程序性能很差。我所做的只是暂停调试器两次，然后我找到了它。

它每次都运行我的代码有实际原因吗？我知道防止这种情况的唯一方法是在最后添加 ToArray() 。我想我需要修改所有代码并确保它们返回数组？

在线演示[http://ideone.com/EUfJN](http://ideone.com/EUfJN)

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
class Test
{

    static void Main()
    {
        string[] test = new string[] { "a", "sdj", "bb", "d444"};
        var expensivePrint = false;
        IEnumerable<int> ls = test.Select(s => { if (expensivePrint) { Console.WriteLine("Doing expensive math"); } return s.Length; });
        expensivePrint = true;
        foreach (var v in ls)
        {
            Console.WriteLine(v);
        }
        Console.WriteLine("If you dont think it does it everytime, lets try it again");
        foreach (var v in ls)
        {
            Console.WriteLine(v);
        }
    }
} 
```

输出

```
Doing expensive math
1
Doing expensive math
3
Doing expensive math
2
Doing expensive math
4
If you dont think it does it everytime, lets try it again
Doing expensive math
1
Doing expensive math
3
Doing expensive math
2
Doing expensive math
4 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:11:38.673

Enumerables 懒惰地评估（仅在需要时）。在选择之后添加一个 .ToList() ，它将强制评估。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T22:13:50.887

LINQ 有惰性求值方法，`Select`它就是其中之一。

问题是您使用`foreach`了两次，它会打印两次值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-25T22:11:42.613

*Select*导致迭代器被...迭代。

如果构建结果的成本很高，您可以 .ToList() 结果一次，然后继续使用该列表。

```
List<int> resultAsList = ls.ToList();
// Use resultAsList in each of the foreach statements 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T00:02:45.277

请参考文档[`Enumerable.Select`](http://msdn.microsoft.com/en-us/library/bb548891.aspx)

> 该方法是通过使用延迟执行来实现的。立即返回值是一个存储执行操作所需的所有信息的对象。在通过直接调用其 GetEnumerator 方法或使用 Visual C# 中的 foreach 或 Visual Basic 中的 For Each 枚举对象之前，不会执行此方法表示的查询。

通过迭代`Select`方法的结果，执行查询。 `foreach`是迭代该结果的一种方法。 `ToArray`是另一个。

* * *

> 它每次都运行我的代码有实际原因吗？

是的，如果结果没有被延迟，那么将执行比必要更多的迭代：

```
IEnumerable<string> query = Enumerable.Range(0, 100000)
  .Select(x => x.ToString())
  .Where(s => s.Length == 6)
  .Take(5); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-25T22:16:33.467

构建查询时

```
IEnumerable<int> ls = test.Select(s => { if (expensivePrint) { Console.WriteLine("Doing expensive math"); } return s.Length; }); 
```

它实际上并没有像您显然期望的那样执行和缓存结果。这称为“延迟执行”。

它只是构建查询。查询的执行实际上发生在`foreach`对查询调用语句时。

如果您在查询中调用`ToList()`or `ToArray()`or `Sum()`or `Average()`or 任何类型的运算符，它将立即执行它。

如果要保留查询结果，最好的办法是通过调用`ToList()`or将其缓存在数组或列表中，`ToArray()`并在此列表或数组上而不是在构造的查询上枚举。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-25T22:16:38.057

这是 Linq 的延迟执行。如果您需要简洁而完整的解释，请阅读以下内容：

[http://weblogs.asp.net/dixin/archive/2010/03/16/understanding-linq-to-objects-6-deferred-execution.aspx](http://weblogs.asp.net/dixin/archive/2010/03/16/understanding-linq-to-objects-6-deferred-execution.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-25T22:31:02.700

我建议您使用`.ToArray()`which will`return int[]`为您提供更好的性能

原因是`int[]`因为它会立即声明和创建，并且`List<T>`会在运行时一个一个地创建

```
int[] array = test.Select(s =>
{
   if (expensivePrint)
   {
     Console.WriteLine("Doing expensive math");
   }
   return s.Length;
}).ToArray(); 
```

# python - Python：从列表中，使用键：值比率而不是 1:1 构建字典

> ID：11659398
> 
> 赞同：1
> 
> 时间：2012-07-25T22:08:59.423
> 
> 标签：python, list, dictionary, list-comprehension

请原谅我没有找到更好的标题。

假设我有两个列表：

```
list1 = ["123", "123", "123", "456"]
list2 = ["0123", "a123", "1234", "null"] 
```

它描述了一个映射（见[这个问题](https://stackoverflow.com/q/11657471/1142160)）。我想`dict`从这些列表中创建一个，知道其中`list1`包含键和`list2`值。在`dict`这种情况下应该是：

```
dict1 = {"123":("0123", "a123", "1234"), "456":("null",)} 
```

因为`list1`告诉我们这`"123"`与三个值相关联。

我如何以编程方式生成这样的字典？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T22:11:10.117

```
from collections import defaultdict

dd = defaultdict(list)
for key, val in zip(list1, list2):
    dd[key].append(val) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T22:12:05.567

[`defaultdict()`](http://docs.python.org/library/collections.html#collections.defaultdict)是你的朋友：

```
>>> from collections import defaultdict
>>> result = defaultdict(tuple)
>>> for key, value in zip(list1, list2):
...    result[key] += (value,)
... 
```

这会产生元组；如果列表很好，请使用 Jon Clement 对相同技术的变体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T22:12:41.410

```
>>> from collections import defaultdict
>>> list1 = ["123", "123", "123", "456"]
>>> list2 = ["0123", "a123", "1234", "null"]
>>> d = defaultdict(list)
>>> for i, key in enumerate(list1):
...     d[key].append(list2[i])
... 
>>> d
defaultdict(<type 'list'>, {'123': ['0123', 'a123', '1234'], '456': ['null']})
>>> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-25T22:24:23.713

还有一个非defaultdict解决方案：

```
from itertools import groupby
from operator import itemgetter

dict( (k, tuple(map(itemgetter(1), v))) for k, v in groupby(sorted(zip(list1,list2)), itemgetter(0))) 
```

# javascript - 选择选项卡时调用javascript函数

> ID：11659405
> 
> 赞同：0
> 
> 时间：2012-07-25T22:09:12.230
> 
> 标签：javascript, html, tabs

是否可以使用 javascript 函数加载选项卡的内容，然后在单击选项卡标题时调用该函数，传递需要传递的任何参数，而不是为每个选项卡嵌入类似的 javascript 代码？我有 5 个不同的选项卡，每个选项卡我想使用图表软件显示图表。这个图表软件的关键是需要 javascript 在浏览器上呈现图像。

下面是渲染和显示 1 个图表所需的 2 个脚本的示例。每个脚本唯一改变的是 .xml 和 .swf。由于这段代码对于所有图表都是相似的，就像我之前所说的，如果可能的话，我想通过一个函数来调用它。

```
<div id="chartdiv">Chart Data.</div>
<div id="fcexpDiv" align="right">FusionCharts Export Handler Component</div>
<script type="text/javascript">
    var myChart = new FusionCharts("Column3D.swf", "myChartId", "500", "300", "0", "1");
    myChart.setXMLUrl("Data_EXPORT.xml");
    myChart.render("chartdiv");
</script>
<script type="text/javascript">
    var myExportComponent = new FusionChartsExportObject("fcExporter1", "FCExporter.swf");
    myExportComponent.Render("fcexpDiv");
</script> 
```

IE：如果您想知道，图表软件是 FusionCharts

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:12:26.003

使用 JS 库，如 jQuery，加上 UI，如[http://os.alfajango.com/easytabs/#tabs1-js](http://os.alfajango.com/easytabs/#tabs1-js)

# google-app-engine - 在谷歌应用引擎问题上使用亚马逊 ses

> ID：11659414
> 
> 赞同：-2
> 
> 时间：2012-07-25T22:09:46.660
> 
> 标签：google-app-engine, amazon-ses

嗨

我正在使用亚马逊简单的电子邮件服务，使用记录在以下位置的代码从 google app engine for java 发送电子邮件：

[http://docs.amazonwebservices.com/ses/latest/DeveloperGuide/SendingEmail.Formatted.html](http://docs.amazonwebservices.com/ses/latest/DeveloperGuide/SendingEmail.Formatted.html)

并获得以下异常：

```
Caused by: java.lang.NoClassDefFoundError: org/apache/commons/logging/LogFactory
at com.amazonaws.util.VersionInfoUtils.<clinit>(VersionInfoUtils.java:41)
at com.amazonaws.ClientConfiguration.<clinit>(ClientConfiguration.java:31)
at com.amazonaws.services.simpleemail.AmazonSimpleEmailServiceClient.<init>(AmazonSimpleEmailServiceClient.java:129)
at vik.sakshum.sakshumweb.server.common.CommonServiceCode.sendSubscriptionMail1(CommonServiceCode.java:965)
at vik.sakshum.sakshumweb.server.common.CommonServiceCode.handleSakshumMailingListSubscription(CommonServiceCode.java:937)
at vik.sakshum.sakshumweb.server.SubscribeServiceImpl.doSubscribe(SubscribeServiceImpl.java:33)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:43)
at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:569)
at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:449)
at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:455)
at com.google.tracing.TraceContext.runInContext(TraceContext.java:695)
at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:333)
at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:325)
at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:453)
... 1 more 
```

维克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T07:06:18.230

您是否具备 Amazon JAVA 开发工具包所需的所有预请求？

> 需要 Apache Commons (Codec, HTTP Client, and Logging) 第三方包，包含在 SDK 的第三方目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T20:38:02.113

最后点击 github [https://github.com/radomirml/aws-sdk-for-gaej](https://github.com/radomirml/aws-sdk-for-gaej)通过提供修补的 jars 来解决我的问题

# php - 在我的 php/jquery 脚本中获取为 foreach 提供的警告_无效参数

> ID：11659418
> 
> 赞同：0
> 
> 时间：2012-07-25T22:10:03.427
> 
> 标签：php, jquery, mysql, warnings

你好明智的stackoverflow用户

我目前正在使用 PHP 开发一个私人消息系统，并且我一直在制作一个删除多个选定消息的函数。就像现在一样，它正在工作，但我收到警告：

```
Warning: Invalid argument supplied for foreach() in /var/www/PM/delete.php on line 7 
```

我使用 jquery 将数据发送到另一个名为 delete.php 的 php 文件。

首先，我的复选框如下所示：

```
<input type="checkbox" class="message_checkbox" name="pms[]" value="<? echo $loadData['id']; ?>" id="<? echo $loadData['id']; ?>"> 
```

我的 jquery 脚本如下所示：

```
<script>
$(function(){
    $("a.delete").click(function(){
        var message = new Array();
        $("input[@name='pms[]']:checked").each(function() {
            message.push($(this).val());
        });

        $.ajax({
            type: 'POST',
            url: 'PM/delete.php',
            data: { id: message },
            success: function(html) {
                alert("all done");
            }
        });
    })
})
</script> 
```

我的 delete.php 如下所示：

```
<?php ob_start();
include("../config.php");

$rows2del = $_POST["id"];

foreach($rows2del as $id) /* Line 7*/
{
        mysql_query("UPDATE user_pm SET reciev_deleted = '1' WHERE id = '$id'") or die(mysql_error());
}   
?> 
```

谁能告诉我我做错了什么？
*注意：我在 jquery 和 javascript 领域非常新！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:18:37.140

您的选择器错误，您可能`$("input[@name='pms[]']:checked")`没有`@name`考虑 xpath 的属性。它应该只是`$("input[name='pms[]']:checked")`

因此，您在这里传递了一个空数组，`data: { id: message },`它不会将`id`参数添加到您的发布请求中，因此`$_POST["id"];`将为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:11:43.460

您必须将其作为 json 字符串传递到 post 变量中，然后在服务器端进行 json 解码。

```
 this is the correct way to push an value inside an json object array
 message.push({id: $(this).val()});

 pass it as string in the post
 data: 'message='+JSON.stringify(message), 
```

# c++ - LNK2019：从 C++ 控制台应用程序（无 CLR）调用 C dll 中的函数时无法解析外部

> ID：11659423
> 
> 赞同：0
> 
> 时间：2012-07-25T22:10:32.643
> 
> 标签：c++, c, visual-studio-2010

我试图从 C++ Win32 控制台应用程序的空 C dll 中调用函数 long *Test(int)。该 dll 称为 QSIWrapperUMeLt.dll。当我尝试构建控制台应用程序时，我得到以下输出：

```
 adding resource. type:MANIFEST, name:1, language:0x0409, flags:0x30, size:406
1>TestPlatform.obj : error LNK2019: unresolved external symbol _Test referenced in function _wmain
1>C:\Users\Deven Bryant\Desktop\temp version\TestPlatform\Debug\TestPlatform.exe : fatal error LNK1120: 1 unresolved externals
1>
1>Build FAILED. 
```

这是我为了从我的控制台应用程序调用我的 QSIWrapperUMeLt dll 所做的；在 dll 中，我在函数定义中包含了`extern "C"`and`__declspec(dllexport)`属性。dll 和控制台应用程序都设置为为 Win32 构建。我已确保在项目设置中将 dll 设置为编译为 c 代码。在控制台应用程序中，我已经`#include`d`QSIWrapperUMeLt.h`文件并更改`__declspec(dllexport)`为`__declspec(dllimport)`使用预处理器指令。我还使用 .dll 链接到 dll `#pragma comment(lib, "DLLTutorial.lib")`。QSIWrapperUMeLt 库文件、头文件和 dll 位于我的控制台应用程序的项目文件夹中。

下面我提供了 dll 的头文件、控制台应用程序 cpp 文件以及在 QSIWrapperUMeLt.dll 上运行时由 dumpbin 检测到的符号表和导出函数。

另外，我尝试了显式链接路由，但是当我调用加载库时，它返回一个空指针。

关于我做错了什么的任何想法将不胜感激。

**QSIWrapperUMELt.h**

```
#include <Windows.h>
//#pragma comment(lib, "DLLTutorial.lib")

#ifdef EXPORT
#define DECLSPEC __declspec(dllexport)
#else
#define DECLSPEC __declspec(dllimport);
#endif

#define BOOL int
#define TRUE 1
#define FLSE 0

typedef enum
{
    initialize = 0,
    setup,
    capture,
    temperature,
    close,
    getimagedata
} CallStates;

typedef struct ReturnedValues
{
    BOOL initialized, imagereadyflag, exposuredone;
    long** imagedata;
    double Temperature;
}ReturnedValues;

typedef struct CameraData
{
    short Mode;
    short Binning;
    int Exposure;
    int Top;
    int Left;
    int Height;  //ROIH
    int Width;   //ROIW
    int CoolerSetpoint;
    int Temperature;
}CameraData;

typedef void (*callFunction)(CameraData camdata, ReturnedValues *retvals);

DECLSPEC ReturnedValues *retvals;
callFunction pcallFunction;
HINSTANCE hlib;
CameraData camdata;

#ifdef __cplusplus 
extern "C"
{
#endif
DECLSPEC ReturnedValues entryPoint();
DECLSPEC long *Test(int length);
#ifdef __cplusplus
}
#endif 
```

**TestPlatform.cpp（控制台应用程序）** 我只是想从中调用 Test()

```
#include "stdafx.h"
#include <Windows.h>
#include <iostream> 
#include <conio.h>
#include <strsafe.h>
#define IMPORT
//#define EXPLICIT
using namespace std;
#ifndef EXPLICIT
#include "QSIWrapperUMeLt.h"
//#include "QSIAccessor.h"
#pragma comment(lib, "QSIWrapperUMeLt.lib")
//#pragma comment(lib, "QSIAccessorUMEmpty.lib")
#endif

#ifdef EXPLICIT
typedef long *(*Test)(int length);
HINSTANCE hinstlib;
Test pTest;
#endif

void ErrorExit(LPTSTR lpszFunction);

int _tmain(int argc, _TCHAR* argv[])
{
    int temp = 1;
    long *data;
#ifdef EXPLICIT
    hinstlib = LoadLibrary((LPCWSTR)"QSIWrapperUMeLt.dll");
    if(hinstlib)
    {
#endif
        int i;
        cout << "hinstlib was successfully initialized" << endl;
#ifdef EXPLICIT
        pTest = (Test)GetProcAddress(hinstlib, (LPCSTR)"Test");
        data = pTest(10000);
#else
        data = Test(1000);
        //callFunction(CameraData *camdata, ReturnedValues *retvals);
#endif
        for(i = 0; i < 20; i++)
        {
            cout << data[i] << endl;
        }
#ifdef EXPLICIT
    }
    else
    {
        ErrorExit(TEXT("LoadLibrary"));
    }
    FreeLibrary(hinstlib);
#endif
    getch();
    return 0;
}

void ErrorExit(LPTSTR lpszFunction) 
{ 
    // Retrieve the system error message for the last-error code

    LPVOID lpMsgBuf;
    LPVOID lpDisplayBuf;
    DWORD dw = GetLastError(); 

    FormatMessage(
        FORMAT_MESSAGE_ALLOCATE_BUFFER | 
        FORMAT_MESSAGE_FROM_SYSTEM |
        FORMAT_MESSAGE_IGNORE_INSERTS,
        NULL,
        dw,
        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
        (LPTSTR) &lpMsgBuf,
        0, NULL );

    // Display the error message and exit the process

    lpDisplayBuf = (LPVOID)LocalAlloc(LMEM_ZEROINIT, 
        (lstrlen((LPCTSTR)lpMsgBuf) + lstrlen((LPCTSTR)lpszFunction) + 40) * sizeof(TCHAR)); 
    StringCchPrintf((LPTSTR)lpDisplayBuf, 
        LocalSize(lpDisplayBuf) / sizeof(TCHAR),
        TEXT("%s failed with error %d: %s"), 
        lpszFunction, dw, lpMsgBuf); 
    MessageBox(NULL, (LPCTSTR)lpDisplayBuf, TEXT("Error"), MB_OK); 

    LocalFree(lpMsgBuf);
    LocalFree(lpDisplayBuf);
    ExitProcess(dw); 
} 
```

**QSIWrapperUMeLt 符号表**

```
 C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin>dumpbin /SYMBOLS "C:\Users\...\Desktop\temp version\C_C++libs\QSIWrapperUMeLt\Debug\QSIWrapperUMeLt.li
            b"
            Microsoft (R) COFF/PE Dumper Version 10.00.30319.01
            Copyright (C) Microsoft Corporation.  All rights reserved.

            Dump of file C:\Users\Deven Bryant\Desktop\temp version\C_C++libs\QSIWrapperUMeLt\Debug\QSIWrapperUMeLt.lib

            File Type: LIBRARY

            COFF SYMBOL TABLE
            000 009C766F ABS    notype       Static       | @comp.id
            001 00000000 SECT2  notype       External     | __IMPORT_DESCRIPTOR_QSIWrapperUMeLt
            002 C0000040 SECT2  notype       Section      | .idata$2
            003 00000000 SECT3  notype       Static       | .idata$6
            004 C0000040 UNDEF  notype       Section      | .idata$4
            005 C0000040 UNDEF  notype       Section      | .idata$5
            006 00000000 UNDEF  notype       External     | __NULL_IMPORT_DESCRIPTOR
            007 00000000 UNDEF  notype       External     | ¦QSIWrapperUMeLt_NULL_THUNK_DATA

            String Table Size = 0x62 bytes

            COFF SYMBOL TABLE
            000 009C766F ABS    notype       Static       | @comp.id
            001 00000000 SECT2  notype       External     | __NULL_IMPORT_DESCRIPTOR

            String Table Size = 0x1D bytes

            COFF SYMBOL TABLE
            000 009C766F ABS    notype       Static       | @comp.id
            001 00000000 SECT2  notype       External     | ¦QSIWrapperUMeLt_NULL_THUNK_DATA

            String Table Size = 0x25 bytes

              Summary

                      DB .debug$S
                      14 .idata$2
                      14 .idata$3
                       4 .idata$4
                       4 .idata$5
                      14 .idata$6 
```

**QSIWrapperUMeLt 出口**

```
 C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin>dumpbin /EXPORTS "C:\Users\...\Desktop\temp version\C_C++libs\QSIWrapperUMeLt\Debug\QSIWrapperUMeLt.dl
            l"
            Microsoft (R) COFF/PE Dumper Version 10.00.30319.01
            Copyright (C) Microsoft Corporation.  All rights reserved.

            Dump of file C:\Users\Deven Bryant\Desktop\temp version\C_C++libs\QSIWrapperUMeLt\Debug\QSIWrapperUMeLt.dll

            File Type: DLL

              Section contains the following exports for QSIWrapperUMeLt.dll

                00000000 characteristics
                500E089F time date stamp Mon Jul 23 19:29:51 2012
                    0.00 version
                       1 ordinal base
                       3 number of functions
                       3 number of names

                ordinal hint RVA      name

                      1    0 00011127 Test = @ILT+290(_Test)
                      2    1 0001102D entryPoint = @ILT+40(_entryPoint)
                      3    2 00017580 retvals = _retvals

              Summary

                    1000 .data
                    1000 .idata
                    2000 .rdata
                    1000 .reloc
                    1000 .rsrc
                    4000 .text
                   10000 .textbss 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T00:40:51.183

当未定义 EXPLICIT 时，我看不到您的问题的原因。但是，这是 LoadLibrary 参数中的问题：

```
(LPCWSTR)"QSIWrapperUMeLt.dll" 
```

ANSI 字符串“QSIWrapperUMeLt.dll”是一个字节数组，包含一堆单字节字符，以单字节 NUL 结尾。在函数参数等表达式中使用时，表达式将转换为指向第一个字符的指针，即 char* 或 LPSTR 类型的指针。

您将指针转换为类型 LPCWSTR。但是，指针仍然指向一堆单字节字符，以单字节 NUL 结束。

因为你想要一个 Unicode 字符串，你可以这样做：

```
L"QSIWrapperUMeLt.dll" 
```

或者在将来可能需要您的代码时与 ANSI 或 Unicode 兼容：

```
_T("QSIWrapperUMeLt.dll") 
```

# sql - 插入到带有列的命令中

> ID：11659425
> 
> 赞同：1
> 
> 时间：2012-07-25T22:10:43.570
> 
> 标签：sql, sql-server-2005

> **可能重复：**
> [SQL Server：如何从表中返回列名？](https://stackoverflow.com/questions/600446/sql-server-how-do-you-return-the-column-names-from-a-table)

我想知道是否有办法将表中的列名插入到另一个表中的字段中。

我有一个新表，其中旧表的列名现在是新表中的参数。

IE。

```
old table
[id] [name] [name2] [name3]
  1    x      x       x

new table
[id] [name type]
 1    name
 2    name2
 3    name3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:19:52.507

以下查询将返回指定表的列：

```
SELECT COL.COLUMN_NAME
FROM
    information_schema.columns COL
WHERE 
    (COL.TABLE_SCHEMA = 'schema_name') AND
    (CO.TABLE_NAME = 'table_name') 
```

您可以使用结果集并将其插入临时表中，或者将其用于您需要的任何内容。

**注意**：我在 SQL Server 2008 上运行它，但它也应该在 2005 上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:21:41.460

```
INSERT INTO NewTable
SELECT COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'OldTable' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T22:31:23.860

您可以`SELECT INTO`使用新表或临时表。下面的示例是一个临时表：

```
SELECT COLUMN_NAME
into #temp
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = 'yourSchema' AND
    TABLE_NAME = 'yourTable'

select *
from #temp

drop table #temp 
```

# ruby-on-rails-3 - Heroku运行命令不起作用

> ID：11659427
> 
> 赞同：0
> 
> 时间：2012-07-25T22:10:59.950
> 
> 标签：ruby-on-rails-3, heroku

当我使用“heroku run ...”执行任何操作时，我收到以下错误：

```
/Users/tony/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/exceptions.rb:48:in `<class:GemNotFoundException>': undefined method `errors' for nil:NilClass (NoMethodError)
from /Users/tony/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/exceptions.rb:40:in `<top (required)>'
from <internal:lib/rubygems/custom_require>:29:in `require'
from <internal:lib/rubygems/custom_require>:29:in `require'
from /Users/tony/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems.rb:1235:in `<top (required)>'
from <internal:lib/rubygems/custom_require>:29:in `require'
from <internal:lib/rubygems/custom_require>:29:in `require'
from /Users/tony/.rvm/gems/ruby-1.9.2-p290/bin/heroku:9:in `<main>' 
```

它之前工作正常。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:29:05.267

我重新安装了 ruby​​gems，下载了 .zip 并执行了 ruby​​ setup.rb，一切都已修复。

# html - 在 html 中显示标签不适用于 html 电子邮件模板

> ID：11659430
> 
> 赞同：1
> 
> 时间：2012-07-25T22:11:27.950
> 
> 标签：html, css, gmail, media-queries, email-templates

我正在为我的公司制作电子邮件模板。取决于它是移动设备还是浏览器，我正在尝试显示内容。

显示属性似乎不适用于 gmail，我无法在此处粘贴整个代码。这是我使用的媒体查询。

```
 @media only screen and (max-device-width: 380px) {
    .mobileWidth {
      width: 290px !important; 
    }

    img { 
    max-width: 130px !important;
    max-height: 130px !important;
    }   

    .right {
      width: 100% !important;         
      position: relative !important;
    }       

     .test {
       width: 290px !important;
       text-align: center !important;
     }

     .showMobile {
       display:inline !important;
     }

    .hideMobile {
      display: none;
    }           
  } 

<html>
  <body>
    <!-- this div block is intended to by default not show in the browser and show in the mobile -->
    <table>
      <tr>
        <td>
          <div class = "showMobile" style ="display:none;">
            <p> some text and image <p>
          </div>

          <!-- this div block is intended to be shown in the browser and not shown in the mobile -->

          <div class="hideMobile">
            <p> some other text and image </p>
          </div>
        </td>
      </tr>
    </table>
  </body>
</html> 
```

这在 iphone 邮件帐户中运行良好，但不适用于 gmail 浏览器和 iphone 的 gmail 应用程序。任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T20:57:51.590

正确，`display:none`将在 Gmail 中删除。解决此问题的最佳方法是使用将内联样式设置为`float:left, width:0px, height:0px, visibility:none, overflow:hidden`. 当您满足媒体查询的要求时，您会还原所有这些样式，因此您可以在媒体查询中设置`float:none !important, overflow:visible !important, width:(actual width or 100%) !important, height:(same as width) !important`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:36:15.850

对于 HTML 电子邮件，建议您不要按照自己的方式使用 css 样式。

您应该使用基于旧学校表格的布局和较旧（但仍然有效）的 html 标签等。

CS 样式应保持在最低限度，并且仅用作内联样式。

# scala - 从 Java 调用 Buffer 上的 foldLeft

> ID：11659432
> 
> 赞同：0
> 
> 时间：2012-07-25T22:11:30.303
> 
> 标签：scala

我想从 Java 代码调用`foldLeft`scala 上的方法：`Buffer`

```
 List<Integer> javaList = new ArrayList<>();
    javaList.add(1);
    javaList.add(3);
    javaList.add(5);

    Buffer<Integer> scalaBuffer = JavaConversions.asScalaBuffer(javaList);

    scalaBuffer.foldLeft(0, new Function2<Integer, Integer, Integer>() {
        @Override
        public Integer apply(Integer accumulator, Integer element) {
            return carry + element;
        }
    }); 
```

但我收到以下编译器错误：

```
Multiple markers at this line
- The type new Function2<Integer,Integer,Integer>(){} must implement the 
 inherited abstract method Function2<Integer,Integer,Integer>.apply$mcVDI
 $sp(double, int)
- The type new Function2<Integer,Integer,Integer>(){} must implement the 
 inherited abstract method Function2<Integer,Integer,Integer>.tupled$mcIDD$sp()
- The type new Function2<Integer,Integer,Integer>(){} must implement the 
 inherited abstract method Function2<Integer,Integer,Integer>.tupled$mcVJJ$sp()
- The type new Function2<Integer,Integer,Integer>(){} must implement the 
 inherited abstract method Function2<Integer,Integer,Integer>.apply$mcZDJ
 $sp(double, long)
    .
    .
    . 
```

基本上，我必须实现一大堆我不感兴趣的方法。

从 Java 调用单子上的 foldLeft 方法是否有简单的解决方案？

谢谢，约翰

（使用 Scala 2.10-M5 和 JDK 1.7）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:20:36.957

根据[这个 scala-lang 线程](http://www.scala-lang.org/node/10551)，适当的操作过程可能是扩展`scala.runtime.AbstractFunction2`而不是直接实现`Function2`。

该线程在scala时间上有点旧，但它可能指向一个解决方案。我承认我自己没有试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:20:37.767

您可以尝试扩展`AbstractFunction2`，而不是实施`Function2`.

对于 java 编译器，scala trait 只是接口，它不会自动让你实现那些在 trait 中没有抽象的方法。只看接口，所有的方法都是抽象的，就像从 java 中看到的那样。

# c++ - 使用 Poco C++ 库，如何将数据传递给线程？

> ID：11659436
> 
> 赞同：10
> 
> 时间：2012-07-25T22:11:56.403
> 
> 标签：c++, multithreading, argument-passing, poco-libraries

所以我的问题实际上有几个部分：

使用 Poco 线程库：

1.  将数据传递给线程的所有可能方法是什么（在线程调用和已经运行的线程中）。
2.  您更喜欢哪种方法，为什么？您能否提供有关您使用这些方法的经验的任何其他信息？
3.  Applied Informatics（Poco 的作者）推荐了哪些方法？Applied Informatics 是否提供了任何其他文档来概述将参数传递给线程？

我已经看过这里了：

*   [http://pocoproject.org/docs/package-Foundation.Threading-index.html](http://pocoproject.org/docs/package-Foundation.Threading-index.html)
*   [http://pocoproject.org/slides/130-Threads.pdf](http://pocoproject.org/slides/130-Threads.pdf)

提前致谢...

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-25T23:30:41.407

将参数传递给新线程的规范方法是通过 Runnable 子类，您需要将其创建为线程入口点。例子：

```
class MyThread: public Poco::Runnable
{
public:
    MyThread(const std::string& arg1, int arg2):
        _arg1(arg1),
        _arg2(arg2)
    {
    }

    void run()
    {
        // use _arg1 and _arg2;
        //...
    }

private:
    std::string _arg1;
    int _arg2;
};

//...

MyThread myThread("foo", 42);
Poco::Thread thread;
thread.start(myThread);
thread.join(); 
```

对于将数据传递给已经运行的线程，最佳解决方案是什么取决于您的要求。对于典型的工作线程场景，请考虑使用[Poco::NotificationQueue](http://pocoproject.org/docs/Poco.NotificationQueue.html)。可以在此处找到带有说明的完整示例：http: [//pocoproject.org/slides/090-NotificationsEvents.pdf](http://pocoproject.org/slides/090-NotificationsEvents.pdf)

# image - 电子邮件中的图像未在 IE 中显示

> ID：11659439
> 
> 赞同：1
> 
> 时间：2012-07-25T22:12:08.043
> 
> 标签：image, internet-explorer, html-email

我为客户创建了一个 HTML 电子邮件，然后他要求我将其发布到他们的服务器上以便在网络上查看。这是一个带有图像和一些链接的基本表格布局。

一切似乎都可以在所有主要的电子邮件客户端以及 Chrome、Safari 和 Firefox 中运行。但是，所有版本的 IE 根本不显示图像。您可以在此处查看该网站。

[http://poweredbyprofessionals.com/email/2012-10-MRF/](http://poweredbyprofessionals.com/email/2012-10-MRF/)

我验证了图像是 RGB 而不是 CMYK，并通过验证器运行它。似乎没有什么可以解决这个问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:18:10.090

# 解决方案

将`width="auto"`and替换`height="auto"`为实际的宽度和高度。

# 演示

[http://jsfiddle.net/yrVsL/1/](http://jsfiddle.net/yrVsL/1/)

# 代码修改

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
    </head>
    <body>
    <table style="border-collapse: collapse;" align="center" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td colspan="2" align="center"> 
                <font color="#005697" style="font-family:Arial, Helvetica, sans-serif; font-size:18px; line-height:36px;">
                        <strong> Join Us!! <br/></strong> 
                </font>
                <font color="#008754" style="font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px;">
                    <strong>Wings of Hope for Melanoma</strong><br />
                            a fundraising gala to benefit the <br />
                            Melanoma Research Foundation<br /><br />
                </font>
                <font color="#000" style="font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px;">

                    <strong> Thursday, October 11, 2012<br/>
                    6:00 PM to 10:00 PM<br />
                    Gotham Hall <br />
                    1356 Broadway, New York<br /><br />
                    </strong>

                    <strong><a href="http://poweredbyprofessionals.com/melanoma/Purchase.html">Click here for more                                 information, to purchase tickets or make a donation!</a></strong>
                </font>        
                </td>
            </tr>

            <tr>
                <td> 
                    <a href="http://www.poweredbyprofessionals.com/melanoma/Purchase.html" target="_blank">
                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-1.jpg" alt="Slice-1" width="550" height="257" />
                    </a>
                </td>
            </tr>

            <tr>
                <td> 
                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-2.jpg" alt="Slice-2" width="550" height="446" />
                </td>
            </tr>

            <tr>
                <td>
                    <table style="border-collapse: collapse;" align="center" border="0" cellpadding="0" cellspacing="0">    
                        <tr>
                            <td>
                                <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-4.jpg" alt="Slice-4" width="275" height="99" />
                            </td>
                            <td>
                                <a href="http://www.poweredbyprofessionals.com/melanoma/Purchase.html" target="_blank">
                                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-3.jpg" alt="Slice-3" width="275" height="99" />
                                </a>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>                    

            <tr>
                <td> 
                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-5.jpg" alt="Slice-5" width="550" height="319" />
                </td>
            </tr>

            <tr>
                <td> 
                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-6.jpg" alt="Slice-2" width="550" height="99" />
                </td>
            </tr>

            <tr>
                <td> 
                    <a href="http://www.poweredbyprofessionals.com/melanoma/Purchase.html" target="_blank">
                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-7.jpg" alt="Slice-1" width="550" height="99" />
                    </a>
                </td>
            </tr>                        

            <tr>
                <td>
                    <table style="border-collapse: collapse;" align="center" border="0" cellpadding="0" cellspacing="0">    
                        <tr>
                            <td>
                                <a href="http://www.poweredbyprofessionals.com" target="_blank">
                                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-8.jpg" alt="Slice-3" width="180" height="87" />
                                </a>                            </td>
                            <td>
                                <a href="http://www.melanoma.org" target="_blank">
                                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-9.jpg" alt="Slice-3" width="180" height="87" />
                                </a>
                            </td>
                            <td>
                                <a href="http://www.stanadler.com" target="_blank">
                                    <img style="display: block;" src="http://poweredbyprofessionals.com/email/2012-10-MRF/images/Slice-10.jpg" alt="Slice-3" width="180" height="87" />
                                </a>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>        

        </table>
    </body>
</html> 
```

# c# - 是否存在强制执行操作的 C# 属性？

> ID：11659441
> 
> 赞同：0
> 
> 时间：2012-07-25T22:12:15.317
> 
> 标签：c#, attributes

例如，这两种方法都需要更新`count`变量：

```
 public void AddFront(T data) {
            Node<T> newNode = new Node<T>(data, null, null); 
            if (count == 0) {
                head = tail = newNode;
            }
            else {
                newNode.Next = head;
                head.Previous = newNode;
                head = newNode;
            }
            // don't forget
            count++;
        }

        public void AddBack(T data) {
            Node<T> newNode = new Node<T>(data, null, null);
            if (count == 0) {
                head = tail = newNode;
            }
            else {
                newNode.Previous = tail;
                tail.Next = newNode;
                tail = newNode;
            }
            // don't forget
            count++;
        } 
```

我想知道是否有一个属性可以强制发生`operation`这样的事情？否则它会触发编译时错误消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:15:29.503

一个属性，没有。（虽然我会阅读@Michael建议的代码合同）

但是，您可以重构您的代码。有相当多的共性。也许创建一个单独的方法，该方法接受作为附加参数是否添加到头部或尾部。类似（未经测试）：

```
 private void Add(T data, bool front) {
        Node<T> newNode = new Node<T>(data, null, null);
        if (count == 0) {
            head = tail = newNode;
        }
        else if (front) {
            newNode.Next = head;
            head.Previous = newNode;
            head = newNode;
        else {
            newNode.Previous = tail;
            tail.Next = newNode;
            tail = newNode;
        }
        // don't forget
        count++;
    }

    public void AddFront(T data) {
        Add(data, true);
    }

    public void AddBack(T data) {
        Add(data, false);
    } 
```

# json - 如何使用 json 和 javascript/jquery 正确处理数据库时间值

> ID：11659445
> 
> 赞同：5
> 
> 时间：2012-07-25T22:12:28.110
> 
> 标签：json, timespan

有谁知道如何解析 json 时间跨度对象？我想将 UTC 时间跨度返回到我的视图，然后将其转换为本地客户端时间，但我还没有找到任何有关如何执行此操作的参考。

我正在使用 mvc，所以我有这个模型：

```
public class TimeSpanModel
{
    public TimeSpan StartTime { get; set; }

    public TimeSpanModel()
    {
        this.StartTime = DateTime.UtcNow.TimeOfDay;

    }
} 
```

在我的控制器中，我将此模型返回到我的视图中，如下所示：

```
public ActionResult GetTimeSpanInfo()
    {
        TimeSpanModel tsm= new TimeSpanModel ();
        return Json(tsm);
    } 
```

我正在从视图中拨打这样的电话：

```
$.ajax({
        type: 'POST',
        url: '@Url.Content("~/Controller/GetTimeSpanInfo")',
        success: function (data) {
        alert(data.StartTime);
        var dt = new Date(data.StartTime);
        alert(dt.toString());
        }
    }); 
```

但在第一个警报框中，我只看到：[object Object] 所以我尝试将时间跨度转换为日期，但在第二个警报框中，我得到无效日期。

我是否必须将时间跨度转换为字符串，然后将该字符串与我不需要的一些奇数日期连接起来以创建“有效”日期，然后将其转换为本地时间，然后从中提取时间?

或者是否有一种更简单、更优雅的方式来使用 TimeSpan，或者只是 datetime 值的 Time 部分？

谢谢你的帮助。

PS 仅将 UTCnow 时间转换为本地时间似乎很愚蠢，但我最终会从 db 表中获取此 UTC 时间值 - 类型 time(0)。我在上面发布的方法只是测试从数据库中获取该值然后在模型中设置该值后如何处理该值的一种更短的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T22:01:51.380

作为人类可读的文化独立方式的字符串：

**来自 Javascript**

```
var dateParam = aDate.toUTCString(); 
```

**到 C#**

```
DateTime aDate = DateTime.ParseExact(dateParam, "r", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None); 
```

**现在从 C#**

```
DateTime formattedDateFromCSharp = aDate.ToString("r"); 
```

**到 Javascript**

```
var aDate = Date.parse(formattedDateFromCSharp); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T10:09:55.580

`[object Object]`您看到的是因为 TimeSpan 没有 JSON 表示，所以最简单的解决方案是使用通用格式来传递它，即毫秒。

```
public ActionResult GetTimeSpanInfo()
    {
        TimeSpanModel tsm= new TimeSpanModel ();
        return Json(tsm.TotalMilliseconds.ToString());
    } 
```

并使用 Date 构造函数 Date(*毫秒*) 在 javascript 中解析，如下所示：

```
$.ajax({
        type: 'POST',
        url: '@Url.Content("~/Controller/GetTimeSpanInfo")',
        success: function (data) {
        alert(data);
        var dt = new Date(data);
        alert(dt.toString());
        }
    }); 
```

# php - 从 MySQL 数据库中识别（非精确）重复项

> ID：11659449
> 
> 赞同：1
> 
> 时间：2012-07-25T22:12:56.130
> 
> 标签：php, mysql, search, full-text-search, search-engine

是否有任何工具可以识别和合并 MySQL 表中的非精确重复项？

我有一个包含许多重复项的大型数据集，例如：

```
1348,  Auto Motors, 12 Long Road, etc
48264, Auto Mtors,  12 Log Road,  etc
82743, Ato Motoers, 12 Lng Road,  etc
83821, Auto Motors, 13 Long Road, etc
92743, Auto Motors, 11 Long Road, etc 
```

有许多表需要合并，例如：

*   公司
*   地址
*   电话号码
*   雇员

每行（连接表）上大约有 100,000 行和 30-40 列要匹配。

那么，有人知道解决这个问题的工具吗？我已经安装了 MySQL、PHP。如果他们有帮助的话，我之前有/可以使用（d）MongoDB 和 Solr。如果需要，我愿意安装其他软件。

* * *

或者，如果我找不到处理此问题的工具，我应该运行哪种查询。

一个简单`find all duplicates`的方法是行不通的，因为它们不准确。

对于我需要尝试的所有不同组合，进行通配符之类的搜索会非常慢。

使用[`Oliver`](http://php.net/manual/en/function.similar-text.php)or [(MySQL)](http://www.artfulsoftware.com/infotree/queries.php)可能会起作用，并且有太多数据需要提取到 PHP 中（也可能非常慢）。[`Levenshtein`](http://php.net/manual/en/function.levenshtein.php)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:44:04.827

您有需要按摩的数据。我不认为这是你可以完全在 sql 中完成的事情。

[Google Refine](http://code.google.com/p/google-refine/)是一个*很棒*的按摩工具。我会先在 Refine 中加载数据，清理它，然后导入到您的关系数据库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:46:23.957

> 对于我需要尝试的所有不同组合，进行通配符之类的搜索会非常慢。
> 
> 使用 Oliver 或 Levenshtein (MySQL) 可能会奏效，并且有太多数据需要提取到 PHP 中（也可能非常慢）。

你说这好像是事实，但这正是我所建议的。例如，将一行加载到 php 中。然后遍历所有其他行，匹配您认为合适的各种算法（Levenshtein 或您自己的停用词列表等）。这需要一段时间才能完成，但这大概是您可以一次性完成的任务，或者至少是定期任务（例如，每天一次）

# php - 更改帐户设置时检查用户当前密码

> ID：11659450
> 
> 赞同：0
> 
> 时间：2012-07-25T22:12:59.607
> 
> 标签：php, cakephp

我正在为登录用户构建一个表单，以更改他们的帐户设置（电子邮件和密码）。为此，他们需要能够确认他们当前的密码。这就是我构建表单的方式`settings.ctp`：

```
<div id="content-complex-image">
    <div id="sidebar">
        <ul>
            <li><a href="/account/images">Your images</a></li>
            <li><a href="/account/settings">Account settings</a></li>
        </ul>
    </div>
    <div id="content-inner">
        <p>Modify your account settings</p>
        <?php echo $this->Session->flash(); ?>
        <?php
            echo $this->Form->create('User');
            echo $this->Form->input('currentPassword', array('type' => 'password'));
            echo $this->Form->input('username', array('disabled' => 'disabled', 'value' => $username));
            echo $this->Form->input('email');
            echo $this->Form->input('password', array('type' => 'password'));
            echo $this->Form->end('Update');
        ?>
    </div>
    <div class="clear"></div>
</div> 
```

这是我的控制器动作：

```
public function settings() {
    $this->set('title_for_layout', 'Account Settings');

    $this->User->id = $this->Auth->user('id');
    if ($this->request->is('post')) {
        if($this->Auth->user('password') == $this->request->data['User']['currentPassword']) {
            if ($this->User->save($this->request->data)) {
                $this->Session->setFlash('Your details have been saved');
                $this->redirect(array('action' => 'settings'));
            } else {
                $this->Session->setFlash('Your details could not be updated. Try again.');
            }
        } else {
             $this->Session->setFlash('Invalid password. Try again.');
        }            
    }
} 
```

但是，`if()`密码检查始终评估为 false 并始终显示“无效密码”消息。我猜我没有正确检查密码，但我不知道正确的方法。

另外，我不希望用户能够更改他们的用户名。我知道我已将表单字段设置为禁用，但如果用户向我的设置操作发送发布请求，他们可以更改他们的用户名。如何阻止用户名被更新`$this->User->save()`？

编辑：看起来像两个问题，一个，我没有在比较之前散列密码，两个，`$this->Auth->user('password')`实际上是 NULL。这就提出了另一个问题，我如何从数据库中获取用户散列密码以便进行比较？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:30:36.457

如果密码没有以明文形式存储在数据库中，则密码检查将失败，因为您没有对从表单传递的数据进行编码/加密。一种简单的检查方法（请仅在测试机器上）将替换`$this->Session->setFlash('Invalid password. Try again.');`为

```
$this->Session->setFlash('The password should be ' . $this->Auth->user('password') . 'but it is actually ' . $this->request->data['User']['currentPassword']); 
```

或类似的东西。

希望能帮助到你

编辑：

如果密码是使用sha1存储的，可以这样检查

```
if($this->Auth->user('password') == sha1($this->request->data['User']['currentPassword']))
{
     //code for successful password here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:59:17.590

您对 Auth 组件没有在其数据中保存密码是正确的。试试这个代码：

```
public function settings() {
    $this->set('title_for_layout', 'Account Settings');

    if ($this->request->is('post')) {
        $user = $this->User->findById($this->Auth->user('id'));
        if($user['User']['password'] == AuthComponent::password($this->request->data['User']['currentPassword'])) {
            if ($this->User->save($this->request->data)) {
                $this->Session->setFlash('Your details have been saved');
                $this->redirect(array('action' => 'settings'));
            } else {
                $this->Session->setFlash('Your details could not be updated. Try again.');
            }
        } else {
             $this->Session->setFlash('Invalid password. Try again.');
        }            
    }
} 
```

我阻止他们更改用户名的建议是完全放弃该输入？您可以简单地为他们回显他们的用户名，而不是禁用输入框。

# windows - Windows 脚本 - 静默运行但等待完成/返回正确代码

> ID：11659456
> 
> 赞同：4
> 
> 时间：2012-07-25T22:13:13.507
> 
> 标签：windows, deployment, batch-file, scheduled-tasks, windows-scripting

**这是我的情况：**

*   我有一个 BAT 文件需要很长时间才能运行（1 分钟到 70 分钟）
*   我用 Windows 调度程序安排它每 10 分钟运行一次
*   如果它仍在运行时再次调度，则不会发生任何事情（这很好）

我的问题是我需要我的 BAT 静默运行，但它不需要。因此，我想使用如下的 Windows 脚本启动它：

```
Set WshShell = CreateObject("WScript.Shell") 
WshShell.Run chr(34) & "C:\Batch Files\syncfiles.bat" & Chr(34), 0
Set WshShell = Nothing 
```

不幸的是，当我安排这个脚本时，它完成了工作但**立即**返回，使 Windows 调度程序认为任务已经完成，而实际上 BAT 只是在某个地方自行运行。

因此，Windows 将在 10 分钟后再次重新安排作业并进行多次运行。

**我需要的：**

有没有办法告诉 Windows 脚本文件在继续/退出之前等待 .Run 命令的目标完成？基本上，我希望它的行为就像我启动了另一个线程，然后在其上调用了 join，所以它执行与 BAT 相同的操作，但不显示控制台窗口。

**其他解决方案**

告诉我任何其他方法可以让这个 BAT 静默执行（powershell 命令等），我也会接受它作为解决方案。只是不要告诉我围绕它写一个完整的 C++/C# 应用程序，那是矫枉过正 :)

* * *

**运行：** Windows Server 2008 R2

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T22:58:31.643

我认为对于可选的第三个参数，您只需要 TRUE

```
WshShell.Run chr(34) & "C:\Batch Files\syncfiles.bat" & Chr(34), 0, TRUE 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-25T23:20:29.293

疯狂的地方来了……

创建一个文件`invisible.vbs`：

```
CreateObject("Wscript.Shell").Run """" & WScript.Arguments(0) & """", 0, True 
```

然后在任务调度程序中，像这样调用你的脚本：

```
wscript.exe "C:\Batch Files\invisible.vbs" "C:\Batch Files\syncfiles.bat" 
```

我对其进行了测试，这确实有效：没有命令窗口，并且该任务被认为正在运行，直到批处理脚本结束。

归功于[https://superuser.com/a/62646/40362](https://superuser.com/a/62646/40362)。

* * *

For 2008 R2 make invisible.vbs 有这个内容，直接执行即可。它将静默运行 BAT 并等待完成。

```
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run "D:\IUpdateScript.bat", 0, true 
```

# php - 从 php curl post 请求中获取标头信息

> ID：11659460
> 
> 赞同：12
> 
> 时间：2012-07-25T22:13:38.017
> 
> 标签：php, curl

我已经搜索了几个小时，但找不到任何关于此的内容。我正在向 Sugarsync api 发出 php curl post 请求，它在我需要的标头中返回一个位置。我不知道如何获得这些信息。我必须将其保留为帖子，因为我将 xml 文件发布到他们的 api 并且他们所做的只是返回标头信息。我不知道如何访问标题中的位置。[根据他们](https://www.sugarsync.com/developer?ref=/dev/getting-started.html)的说法，我需要将其放入另一个 xml 文件并发布。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-25T22:17:12.510

如果您设置 curl 选项`CURLOPT_FOLLOWLOCATION`，cURL 将为您遵循位置重定向。

如果您想获取标头，请将选项设置`CURLOPT_HEADER`为 1，您返回的 HTTP 响应`curl_exec()`将包含标头。您可以让他们解析它们的位置。

```
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_HEADER, 1); // return HTTP headers with response
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); // return the response rather than output it

$resp = curl_exec($ch);

list($headers, $response) = explode("\r\n\r\n", $resp, 2);
// $headers now has a string of the HTTP headers
// $response is the body of the HTTP response

$headers = explode("\n", $headers);
foreach($headers as $header) {
    if (stripos($header, 'Location:') !== false) {
        echo "The location header is: '$header'";
    }
} 
```

查看[curl_setopt()](http://php.net/curl_setopt)中的所有选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:16:02.837

获取响应中的标头信息。

```
curlsetopt($ch,CURLOPT_HEADER,true); 
```

# regex - MVC3/ASP.NET 确保文件参数是本地的并且不尝试超出我的应用程序根目录的最佳实践？

> ID：11659461
> 
> 赞同：0
> 
> 时间：2012-07-25T22:13:49.763
> 
> 标签：regex, asp.net-mvc, security, filenames

另一位开发人员维护着大量水晶报表。我需要在我的 ASP.NET MVC3 页面上提供这些报表，而不需要完整的 Crystal Reports Server 产品。

当前的报告站点是一个经典的 ASP 页面，所有参数都通过了，例如 Prompt0&Prompt1...等

为此，我创建了一个位于我的 MVC 应用程序中的 aspx 页面，并从我的应用程序的目录中提供这些报告，如下所示：

公共部分类报告：System.Web.UI.Page {

```
 protected void Page_Load(object sender, EventArgs e)
    {
        iLogger logger = LoggingFactory.CreateLogger();

        ReportDocument rd = new ReportDocument();

        string fileName = Request.QueryString["reportfile"];

        if(!Regex.IsMatch(fileName,@"^[ 0-9a-zA-Z-_\\]+.rpt$"))
        {
      //log and throw
        }

        if(Path.IsPathRooted(fileName))
        {
           //log and throw
        }

        string rootPath = Server.MapPath("~/Reports/");

        string path = Path.Combine(rootPath, fileName);

        if (File.Exists(path))
        {
            rd.Load(path);
        }

        //get all keys starting with Prompt
        var prompts = Request.QueryString.AllKeys.Where(q => q.StartsWith("Prompt"));

        foreach (string promptKey in prompts)
        {
            //try to convert the rest of the string to an int  
            //yes, this should probably not just be a replace here...
                string withoutPrompt = promptKey.Replace("Prompt", "");

                int promptVal;
                if (int.TryParse(withoutPrompt, out promptVal))
                {
                    rd.SetParameterValue(promptVal, Request.QueryString[promptKey]);
                }
                //rd.SetParameterValue(promptKey, Request.QueryString[promptKey]);

        }

        CrystalReportViewer1.ReportSource = rd;

    }
} 
```

这对于工作量来说非常有效（报表设计者只需将报表/查询页面中的链接从例如 mywebserver.foo/Report1.rpt?Prompt....etc.etc 更改为 mywebserver.foo/mymvcreport/ report.aspx?Filename=report1.rpt&Prompt...等

太好了，我们可以快速转移到我们的 MVC 应用程序，而不必让 10 个站点出去购买 Crystal Server。

我明显担心的是，在文件名 arg 中，有人可以在其中放置任何内容，例如：“C:\foo\bar”或“../bla/blah”等。是否有一个最佳实践来转义这些文件名并确保它是我的应用程序的本地路径？

我希望能够采用例如以下参数：/Sales/Quarterly/Quarterly.rpt

我的第一个想法是只使用例如 [0-9a-zA-z-_\]+ 的正则表达式，以确保不能使用冒号或点字符。有关处理此问题的最完整方法的任何建议？

谢谢！

编辑：

更新了我放入的初步检查...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:03:11.267

只要您为应用程序池用户分配了正确的权限，这就是您不应该担心的事情。

# android - 缩小时android mapview图标在错误的位置

> ID：11659463
> 
> 赞同：1
> 
> 时间：2012-07-25T22:13:52.330
> 
> 标签：android, maps, zooming, android-mapview, animated

我试图弄清楚为什么当我缩小地图视图时我的图标会出现在海洋上，但是当我放大点时是正确的。

这是我的代码：

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.main);

    mapView = (MapView) findViewById(R.id.mapview1);
    mapView.setBuiltInZoomControls(true);
    MapController mapController = mapView.getController();

    //set up test points
    point = new GeoPoint(25982160, -80358564);
    showAnimatedMarker(point, "true");  
    point = new GeoPoint(34023084, -84781697);
    showAnimatedMarker(point, "Test");
    point = new GeoPoint(40759508, -73987061);
    showAnimatedMarker(point, "Yo YO YO");
    point = new GeoPoint(34152852, -118336107);
    showAnimatedMarker(point, "Boom shakalaka");
    point = new GeoPoint(-23564595, -46652759);
    showAnimatedMarker(point, "Testing having a real long name");

    mapController.setZoom(4);
    mapController.animateTo(point);
}

public void showAnimatedMarker(GeoPoint point, String locationName)
{
    //animate the marker
    RelativeLayout v = (RelativeLayout) View.inflate(this, R.layout.markerlayout, null);
    final ImageView marker = (ImageView) v.findViewById(R.id.marker);
    final TextView markerText = (TextView) v.findViewById(R.id.markerText);
    final String locName = locationName;
    marker.post(new Runnable() {
        @Override
        public void run() {
            markerText.setText(locName);
            AnimationDrawable markerImage = (AnimationDrawable)marker.getDrawable();            
            markerImage.start();
        }
    });
    mapView.addView(v, 0, new MapView.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT, point, MapView.LayoutParams.BOTTOM_CENTER));

} 
```

这是 2 张图片，显示了我的意思，1 张被缩小，1 张被放大到加利福尼亚的位置。

任何帮助将不胜感激。

![放大图像](../Images/db417a35a7317ca1f38def5ab57ca4d1.png)

![缩小图像](../Images/e2ea38b02ad8a299f9afa215036336ed.png)

编辑：

这是我更新的代码（我没有包含 myOverlays 类，因为它正是 Frohnzie 发布的）

```
 MapController mapController = mapView.getController();
    MyOverlay testOverlay;

     //set up test points
    point = new GeoPoint(25982160, -80358564);
    //showAnimatedMarker(point, "true");
    testOverlay = new MyOverlay(this,  mapView, point);
    mapOverlays.add(testOverlay);       

    point = new GeoPoint(34023084, -84781697);
    //showAnimatedMarker(point, "Test");
    testOverlay = new MyOverlay(this,  mapView, point);
    mapOverlays.add(testOverlay);   

    point = new GeoPoint(40759508, -73987061);
    //showAnimatedMarker(point, "Yo YO YO");
    testOverlay = new MyOverlay(this,  mapView, point);
    mapOverlays.add(testOverlay);   

    point = new GeoPoint(34152852, -118336107);
    //showAnimatedMarker(point, "Boom shakalaka");
    testOverlay = new MyOverlay(this,  mapView, point);
    mapOverlays.add(testOverlay);   

    point = new GeoPoint(-23564595, -46652759);
    //showAnimatedMarker(point, "Testing having a real long name");
    testOverlay = new MyOverlay(this,  mapView, point);
    mapOverlays.add(testOverlay);   

    mapController.setZoom(4);
    mapController.animateTo(point);
    mapView.invalidate();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T14:42:15.103

您是否考虑过使用过度功能？下面的叠加层将为地图上的标记设置动画。对于多个标记，您可以使用扩展 OverlayItem。

```
public class MyOverlay extends Overlay {
  private Drawable mMarker;
  private MapView mMapView;
  private int level;
  private Timer timer;
  Private GeoPoint mGeoPoint;

  public MyOverlay(Context context, MapView mapView, GeoPoint geoPoint) {
    mMapView = mapView;
    mGeoPoint = geoPoint;
    mMarker = context.getResources().getDrawable(R.drawable.position_anim);
    timer = new Timer();
    timer.schedule(new TimerTask() {
      @Override
      public void run() {
        level = (level + 1) % 2;
        mMapView.postInvalidate();
      }
    }, 1000, 1000);
  }

  @Override
  public void draw(Canvas canvas, MapView mapView, boolean shadow) {
    Projection projection = mapView.getProjection();
    Point center = new Point();
    projection.toPixels(mGeoPoint, center);

    int width = mMarker.getIntrinsicWidth();
    int height = mMarker.getIntrinsicHeight();

    mMarker.setLevel(level);
    mMarker.setBounds(center.x - width / 2, center.y - height / 2, center.x + width / 2, center.y + height / 2);
    mMarker.draw(canvas);
  }
} 
```

示例标记资源 (position_anim.xml)：

```
<level-list xmlns:android="http://schemas.android.com/apk/res/android" >
  <item android:maxLevel="0" android:drawable="@drawable/image1" />
  <item android:maxLevel="1" android:drawable="@drawable/image2" />
</level-list> 
```

# ios - ios - 向用户显示错误和消息的常规方法是什么？

> ID：11659464
> 
> 赞同：1
> 
> 时间：2012-07-25T22:13:53.477
> 
> 标签：ios, ios5

我是安卓用户，刚学ios，对一些UX细节不太熟悉。

如果一个应用程序有一个需要成功消息的表单，或者关于验证错误的消息，那么在 ios 中完成此操作的常规方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:21:10.143

展示成功的传统方式是什么都不展示。您可能会刷新数据或使用动画导航，但大多数情况下您应该让开。

轻松呈现错误的传统方法是使用[`UIAlertView`](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIAlertView_Class/UIAlertView/UIAlertView.html)，提供一个清晰、简洁的信息，说明出现了什么问题以及如何在可能的情况下修复它。

但是，不要将自己限制在易于使用的库存控制上。除了模态弹出框（警报视图就是这样）之外，还有许多其他更温和的方式来指示失败。看看推特机器人。他们使用非模态横幅视图来指示成功和失败，例如无法访问网络时。如果错误是暂时的，这是一个特别好的主意，因为它不需要用户交互来解除。

![Tweetbot 错误横幅的 CC-BY-SA 图像，由 Flickr 用户 Gustavo Pimenta 提供](../Images/490117f34cc5f717cf43cffa8f0e9ba3.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T22:20:37.887

验证错误通常由 UIAlertView 完成。

成功确认可以通过“烤面包机”通知来完成（如 Tweetbot 的 iPhone 应用程序所示，此处：[http](http://shawnblanc.net/images/tweetbot-notifications.jpg) ://shawnblanc.net/images/tweetbot-notifications.jpg ），但这需要自定义代码。

UIAlertViews 也可以用于成功消息，但由于它具有很强的干扰性，因此可能并不理想。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T22:21:22.497

我用`UIAlertView`了类。这是该课程中[Apple 文档的链接。](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIAlertView_Class/UIAlertView/UIAlertView.html)

# javascript - 返回真或返回假

> ID：11659468
> 
> 赞同：3
> 
> 时间：2012-07-25T22:14:10.200
> 
> 标签：javascript

我正在学习 Javascript，我正在尝试复习我迄今为止所学的所有内容。我试图弄清楚在使用 return 语句时如何像警报框一样获取消息。 `alert(Example(2,3));`有效，也使像这样的全局变量有效。 `var sum = Example(2,3); alert(sum);`. 但我敢打赌，有比我能想到的更好的方法。

```
function Example(x, y) {

    if (x * y === 108) {

        return true;

    } else {

        return false;

    }

}
Example(2, 3); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-25T22:16:13.617

您的功能可以简单得多。只需返回从比较中获得的布尔值：

```
function example(x, y) {
    return (x * y === 108);
} 
```

至于如何制作警报框，我建议*完全不要使用警报框*。

*   如果你想向用户展示一些东西，请使用纯 HTML、jQuery 或类似的东西。
*   如果要调试，使用`console.log`或类似。

警报非常烦人，并且会阻止与页面的交互。

如果由于某种原因您*必须*使用警报（例如，您被迫在没有开发人员工具的系统上进行调试），那么这将正常工作：

```
alert(example(2,3)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-25T22:16:36.913

有这种方式，:)

```
function Example(x, y) {
    return x * y === 108; 
}
Example(2, 3); 
```

# hadoop - 在地图中键入不匹配的键，正确使用 SequenceFileInputFormat

> ID：11659470
> 
> 赞同：2
> 
> 时间：2012-07-25T22:14:14.053
> 
> 标签：hadoop, mahout

我正在尝试运行电子书 Mahout in Action 中第 6 章（清单 6.1 ~ 6.4）中的推荐示例。有两个映射器/缩减器对。这是代码：

映射器 - 1

```
public class WikipediaToItemPrefsMapper extends 
        Mapper<LongWritable,Text,VarLongWritable,VarLongWritable> { 
```

private static final Pattern NUMBERS = Pattern.compile("(\d+)");

```
@Override
public void map(LongWritable key,
          Text value,
          Context context)
throws IOException, InterruptedException {

    String line = value.toString();
    Matcher m = NUMBERS.matcher(line);
    m.find();
    VarLongWritable userID = new VarLongWritable(Long.parseLong(m.group()));
    VarLongWritable itemID = new VarLongWritable();
    while (m.find()) {
        itemID.set(Long.parseLong(m.group()));
        context.write(userID, itemID);
    }
} 
```

}

减速机 - 1

```
public class WikipediaToUserVectorReducer extends 
        Reducer<VarLongWritable,VarLongWritable,VarLongWritable,VectorWritable> {
@Override
public void reduce(VarLongWritable userID, 
                    Iterable<VarLongWritable> itemPrefs,
                    Context context)
  throws IOException, InterruptedException {

        Vector userVector = new RandomAccessSparseVector(
        Integer.MAX_VALUE, 100);
        for (VarLongWritable itemPref : itemPrefs) {
            userVector.set((int)itemPref.get(), 1.0f);
        }

        //LongWritable userID_lw = new LongWritable(userID.get());
        context.write(userID, new VectorWritable(userVector));
        //context.write(userID_lw, new VectorWritable(userVector));
} 
```

}

reducer 输出一个 userID 和一个 userVector，它看起来像这样： 98955 {590:1.0 22:1.0 9059:1.0 3:1.0 2:1.0 1:1.0} 在驱动程序中使用了 FileInputformat 和 TextInputFormat。

我想使用另一对 mapper-reducer 来进一步处理这些数据：

映射器 - 2

```
public class UserVectorToCooccurenceMapper extends
Mapper<VarLongWritable,VectorWritable,IntWritable,IntWritable> {

@Override
public void map(VarLongWritable userID,
                VectorWritable userVector,
                Context context)
throws IOException, InterruptedException {

    Iterator<Vector.Element> it = userVector.get().iterateNonZero();
    while (it.hasNext()) {
        int index1 = it.next().index();
        Iterator<Vector.Element> it2 = userVector.get().iterateNonZero();
        while (it2.hasNext()) {
            int index2 = it2.next().index();
                context.write(new IntWritable(index1),
                                new IntWritable(index2));
        }
    }
} 
```

}

减速机 - 2

公共类 UserVectorToCooccurenceReducer 扩展 Reducer {

```
@Override
public void reduce(IntWritable itemIndex1,
          Iterable<IntWritable> itemIndex2s,
          Context context)
throws IOException, InterruptedException {

    Vector cooccurrenceRow = new RandomAccessSparseVector(Integer.MAX_VALUE, 100);
    for (IntWritable intWritable : itemIndex2s) {
        int itemIndex2 = intWritable.get();
        cooccurrenceRow.set(itemIndex2, cooccurrenceRow.get(itemIndex2) + 1.0);
    }
    context.write(itemIndex1, new VectorWritable(cooccurrenceRow));
} 
```

}

这是我正在使用的驱动程序：

```
public final class RecommenderJob extends Configured implements Tool { 
```

@Override public int run(String[] args) 抛出异常 {

```
 Job job_preferenceValues = new Job (getConf());
  job_preferenceValues.setJarByClass(RecommenderJob.class);
  job_preferenceValues.setJobName("job_preferenceValues");

  job_preferenceValues.setInputFormatClass(TextInputFormat.class);
  job_preferenceValues.setOutputFormatClass(SequenceFileOutputFormat.class);

  FileInputFormat.setInputPaths(job_preferenceValues, new Path(args[0]));
  SequenceFileOutputFormat.setOutputPath(job_preferenceValues, new Path(args[1]));

  job_preferenceValues.setMapOutputKeyClass(VarLongWritable.class);
  job_preferenceValues.setMapOutputValueClass(VarLongWritable.class);

  job_preferenceValues.setOutputKeyClass(VarLongWritable.class);
  job_preferenceValues.setOutputValueClass(VectorWritable.class);

  job_preferenceValues.setMapperClass(WikipediaToItemPrefsMapper.class);
  job_preferenceValues.setReducerClass(WikipediaToUserVectorReducer.class);

  job_preferenceValues.waitForCompletion(true);

  Job job_cooccurence = new Job (getConf());
  job_cooccurence.setJarByClass(RecommenderJob.class);
  job_cooccurence.setJobName("job_cooccurence");

  job_cooccurence.setInputFormatClass(SequenceFileInputFormat.class);
  job_cooccurence.setOutputFormatClass(TextOutputFormat.class);

  SequenceFileInputFormat.setInputPaths(job_cooccurence, new Path(args[1]));
  FileOutputFormat.setOutputPath(job_cooccurence, new Path(args[2]));

  job_cooccurence.setMapOutputKeyClass(VarLongWritable.class);
  job_cooccurence.setMapOutputValueClass(VectorWritable.class);

  job_cooccurence.setOutputKeyClass(IntWritable.class);
  job_cooccurence.setOutputValueClass(VectorWritable.class);

  job_cooccurence.setMapperClass(UserVectorToCooccurenceMapper.class);
  job_cooccurence.setReducerClass(UserVectorToCooccurenceReducer.class);

  job_cooccurence.waitForCompletion(true);

  return 0; 
```

}

```
public static void main(String[] args) throws Exception {
ToolRunner.run(new Configuration(), new RecommenderJob(), args); 
```

} }

我得到的错误是：

```
java.io.IOException: Type mismatch in key from map: expected org.apache.mahout.math.VarLongWritable, received org.apache.hadoop.io.IntWritable 
```

在谷歌搜索修复过程中，我发现我的问题类似于[这个问题](https://stackoverflow.com/questions/10266367/how-to-directly-send-the-output-of-a-mapper-reducer-to-a-another-mapper-reducer "StackOverFlow 问题")。但不同之处在于我已经在使用 SequenceFileInputFormat 和 SequenceFileOutputFormat，我相信是正确的。我还看到 org.apache.mahout.cf.taste.hadoop.item.RecommenderJob 或多或少做了类似的事情。在我的理解和[雅虎教程中](http://developer.yahoo.com/hadoop/tutorial/module4.html)

> SequenceFileOutputFormat 快速将任意数据类型序列化到文件中；对应的 SequenceFileInputFormat 会将文件反序列化为相同的类型，并以与前一个 Reducer 发出的相同方式将数据呈现给下一个 Mapper。

我究竟做错了什么？真的很感谢某人的一些指点。我花了一天时间试图解决这个问题，但一无所获:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T01:31:56.360

您的第二个映射器具有以下签名：

```
public class UserVectorToCooccurenceMapper extends 
        Mapper<VarLongWritable,VectorWritable,IntWritable,IntWritable> 
```

但是您在驱动程序代码中定义以下内容：

```
job_cooccurence.setMapOutputKeyClass(VarLongWritable.class);
job_cooccurence.setMapOutputValueClass(VectorWritable.class); 
```

减速器期望`<IntWritable, IntWritable>`作为输入，因此您只需将驱动程序代码修改为：

```
job_cooccurence.setMapOutputKeyClass(IntWritable.class);
job_cooccurence.setMapOutputValueClass(IntWritable.class); 
```

# assembly - x86 组装学习平台

> ID：11659477
> 
> 赞同：2
> 
> 时间：2012-07-25T22:15:01.043
> 
> 标签：assembly, x86, 64-bit, 32-bit, 6502

最近我一直在摆弄组装，我学到了很多东西。我正在使用[6502asm.com](http://6502asm.com/)。[6502asm.com](http://6502asm.com/)是 6502 汇编的 javascript 汇编器和仿真器。这就是我喜欢它的地方： 输入和输出非常简单易懂。它为您提供 32x32 像素的屏幕，地址空间从 0200 美元到 05 美元不等。更改像素的颜色就像在屏幕的一个地址中存储一个颜色值（在 $00 和 $0f 之间）一样简单（$0200 是左上角，$05ff 是右下角）。这很有趣乱七八糟，但它是 8 位的，而且 32x32 的屏幕没有太多空间。我想知道是否有像[6502asm.com这样的东西](http://6502asm.com/)用于 32/64 位汇编而不是 8 位。（它不必在浏览器中，只要是类似的就行。）另外，如果它使用 nasm，我会更喜欢，但这不是必需的。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-20T07:42:44.720

[Jasmin](http://www.lrr.in.tum.de/~jasmin/index.html)可以帮助您学习 x66 汇编，但它没有任何图形表示。但是您可以在执行 x86 代码时看到寄存器和内存的变化。

如果您觉得 6502asm.com 仅限于 32x32 像素，为什么不尝试“真实的东西”，这意味着您可以在模拟器上运行的 IDE 中的宏汇编器？

例如，以下组合：

*   [dasm](http://sourceforge.net/projects/dasm-dillon/)或[Kick Assembler](http://www.theweb.dk/KickAssembler/Main.php)，两个跨平台的 65xx 汇编器
*   [WUDSN IDE](http://www.wudsn.com/index.php/ide)，一个不错的 IDE，具有代码完成、错误突出显示，捆绑为 Eclipse 插件
*   [VICE](http://vice-emu.sourceforge.net/) , C64/128, VIC20 的仿真器...

当然，您需要了解您选择的目标 8 位机器的复杂性，但 IMO 更有趣。例如，在 C64 上，您可以获得 320x200 的图形、带有碰撞检测的精灵、40x25 的文本显示。如果您接触到实际的硬件，您甚至可以考虑在其上运行您的程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T07:41:52.843

在这里，您可以找到一个非常有趣的开源 JS 项目。

[http://sourceforge.net/projects/jsdosbox/](http://sourceforge.net/projects/jsdosbox/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T23:36:59.537

再谷歌搜索后，我找到了notch（我的世界的创造者）的新游戏，0x​​10c。这是一个太空游戏，你可以控制一艘宇宙飞船，飞船内部有一台名为 dcpu-16 的可编程计算机，你可以通过编程控制飞船的各个方面。该游戏尚未发布，但是已经为 dcpu-16 制作了几个仿真器和汇编器。我在[这里](https://github.com/DCPUTeam/DCPUToolchain)编译了一个，并组装并运行了一个测试程序（康威生命游戏），它运行良好！

# hibernate - Hibernate Session.load() 什么时候抛出异常

> ID：11659485
> 
> 赞同：5
> 
> 时间：2012-07-25T22:15:32.577
> 
> 标签：hibernate, session, exception, load

```
try {
   x = session.load(...); 
   y = x; 
 }
 catch(Exception e) {
    //do something
 } 
```

如果键不存在，将 load(...) 抛出异常

1.  马上
2.  稍后尝试从数据库中获取对象时会返回一个代理然后抛出异常？

另外，在上面的代码中，如果执行到了赋值y = x，是否保证此时x不为null？是否存在此时 x 可以为空的情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T22:55:26.933

**简而言之：**

*   `x`加载后不会为空，所以也不会`y`
*   `load()`如果对象不存在，可能有也可能没有例外
*   如果 from 没有异常`load()`，并且对象不存在，那么访问`x`or时就会出现异常`y`。

**详细说明：**

您是否试图确定密钥是否存在？或者你假设它是，但只是想处理异常？

请参阅[文档](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html#load%28java.lang.Class,%20java.io.Serializable%29)，特别是：

> 您不应使用此方法来确定实例是否存在（`get()`改为使用）。仅使用它来检索您假设存在的实例，其中不存在将是实际错误。

从关于使用 load() 的“hibernate in action”一书中：

> 应用程序可以检索对持久实例的有效引用（代理），而无需访问数据库来检索其持久状态。所以 `load()`在缓存或数据库中找不到持久对象时可能不会抛出异常；当访问代理时，稍后将引发异常。

**所以**：

如果您想知道该项目是否存在，请使用`get()`，而不是`load()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T23:56:29.660

添加到@Tass 的回复中，我发现（感谢同事）

1.  如果 @Proxy(lazy="false") 立即抛出异常
2.  如果 @Proxy(lazy="true") 不会抛出异常

# html - 在 a 中对齐图像，而不必是背景

> ID：11659487
> 
> 赞同：0
> 
> 时间：2012-07-25T22:15:34.723
> 
> 标签：html, css, html-table, position

我正在尝试使用 a 创建产品列表，`<table>`因为它基本上是一个包含行和列的表。

我想让其中一列列出项目状态是可用还是不可用，如果可用，我想用一个绿色的小图标表示这一点，否则用红色表示。我还希望该图标可以单击以更改它。

所以我用谷歌搜索，发现如果它是背景图像，我可能可以定位它，但我希望它可点击，所以这不好。

我已经尝试了所有的垂直对齐和居中等`<td>`。

清除一些东西：

我只想知道如何在`<td>`. 图像本身就是锚点，当它被点击时，页面会重新加载并且图标会改变。我已经尝试将此图像定位在`<td>`但不能。这就是我的问题：如何定位它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:45:46.097

不知道为什么在表格单元格中对齐图像有困难。表格包含许多有助于对齐的有用属性。这是一个示例表格，其中图像与表格单元格的中心对齐。

[http://jsfiddle.net/Puppies4Life/zka5Q/](http://jsfiddle.net/Puppies4Life/zka5Q/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:30:32.143

First of 表只能用于数据，产品列表不是数据。我建议使用普通的旧 div 或带有大量浮动 LI 元素的 UL。

对于您的图标，最好将其设为“A”标签，并将图标作为图像放在“A”标签中，或者将其作为“A”标签的背景。

要将其水平对齐，使其成为父容器 text-align:center。

我会假设每个产品都是一个图像并且是一个设定的高度？如果是这样，那么要垂直对齐它，只需将容器的 padding-top 设置为正确的高度以将其设置在中心。

希望以上内容对您有用:)

# jquery - 如何使用 jQuery 从 URL 显示来自 youtube 的视频？

> ID：11659488
> 
> 赞同：1
> 
> 时间：2012-07-25T22:15:45.533
> 
> 标签：jquery, youtube, each

我想阅读带有“yturl”类的 div 并从 youtube 替换为 iframe。

为什么我的源代码不起作用？

我有以下源代码：

HTML：

```
<div class="yturl">http://www.youtube.com/watch?v=mwVuURFNX0E</div> 
```

JS：

```
$("div.yturl").each(function(){
    var regex = /(\?v=|\&v=|\/\d\/|\/embed\/|\/v\/|\.be\/)([a-zA-Z0-9\-\_]+)/;
    var youtubeurl = $(this).text();
    var regexyoutubeurl = youtubeurl.match(regex);
    if (regexyoutubeurl) {
        $(this).html("<iframe width=\"420\" height=\"315\" src=\"http://www.youtube.com/embed/"+regexyoutubeurl[2]+" frameborder=\"0\" allowfullscreen></iframe>");
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:19:30.290

由于您犯了一个错字，它无法正常工作。

您的代码生成以下 html 代码（尝试在此处查找缺少的引号）：

```
<iframe width="420" height="315" src="http://www.youtube.com/embed/mwVuURFNX0E frameborder=" 0"="" allowfullscreen=""></iframe> 
```

更正的 JavaScript 代码：

```
$("div.yturl").each(function(){
    var regex = /(\?v=|\&v=|\/\d\/|\/embed\/|\/v\/|\.be\/)([a-zA-Z0-9\-\_]+)/;
    var youtubeurl = $(this).text();
    var regexyoutubeurl = youtubeurl.match(regex);
    if (regexyoutubeurl) {
        $(this).html("<iframe width=\"420\" height=\"315\" src=\"http://www.youtube.com/embed/"+regexyoutubeurl[2]+"\" frameborder=\"0\" allowfullscreen></iframe>");
    }
}); 
```

我建议您使用 Firebug 或 Webkit Web Inspector 来查看您动态生成的代码。

# javascript - 在自执行匿名函数中使用 undefined

> ID：11659489
> 
> 赞同：0
> 
> 时间：2012-07-25T22:15:52.837
> 
> 标签：javascript, coffeescript, global-variables, undefined, strict

我正在尝试使用 CoffeeScript 中的自执行匿名函数来实现命名空间：

[如何在 JavaScript 中声明命名空间？](https://stackoverflow.com/questions/881515/javascript-namespace-declaration)

[http://enterprisejquery.com/2010/10/how-good-c-habits-can-encourage-bad-javascript-habits-part-1/](http://enterprisejquery.com/2010/10/how-good-c-habits-can-encourage-bad-javascript-habits-part-1/)

我还想保护“未定义”不被重新定义，因为这是文章所建议的。

所以在 CoffeeScript 中，我可以这样做：

```
((skillet, $) ->
  skillet.fry ->
    alert('hi');
)( window.skillet = window.skillet || {}, jQuery); 
```

并接近文章中描述的格式：

```
(function(skillet, $) {
  return skillet.fry(function() {
    return alert('hi');
  });
})(window.skillet = window.skillet || {}, jQuery); 
```

但是当我尝试在...中添加未定义时，由于严格模式而出现编译错误：

[http://arcturo.github.com/library/coffeescript/07_the_bad_parts.html](http://arcturo.github.com/library/coffeescript/07_the_bad_parts.html)

“某些变量（例如 undefined）不再可写”

我想知道是否有解决方法？我想保持严格模式，因为使用它可能有我不完全了解的好处。但即使谷歌搜索关闭它的方法......我想出了零。

感谢您的关注！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:23:12.430

将你的 CoffeeScript 代码包装在一个自动执行的匿名中是没有意义的——编译器默认已经完成了。

```
alert "Foo" 
```

编译成

```
(function() {
  alert("Foo");
}).call(this); 
```

如果要确保例如`$`references `jQuery`，只需添加一个局部变量：

```
$ = window.jQuery
skilett = window.skilett ? {}
# ... rest of the code ... 
```

在使用严格模式时尝试保护也没有意义`undefined`，因为（如错误消息所述）`undefined`无论如何都是不可写的。

在“常规”模式下，您可以`undefined`像这样在代码顶部生成一个带有值的变量（并且只需使用它而不是“未定义”）：

```
undef = ((u) -> u)() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:23:07.630

> 我还想保护“未定义”不被重新定义

和

> 严格模式导致编译错误：“某些变量，如 undefined，不再可写”

那么你的问题是什么？不需要声明`undefined`参数，因为无论如何 CoffeeScript 都不会让你使用这个“变量”！

如果您真的（需要/想要）担心某些第三方脚本将值分配给`undefined`，请不要在您的代码中使用它。您始终可以使用`typeof`运算符或 CoffeeScripts 存在运算符。

只是别担心。我认为除了明确的恶意攻击之外，没有人遇到过这样的错误。

# android - ViewPager + PagerAdapter 在前两项后显示空白页

> ID：11659493
> 
> 赞同：6
> 
> 时间：2012-07-25T22:16:13.843
> 
> 标签：android, android-viewpager

**发生了什么**：前两个 ViewPager 页面加载良好（ViewPager 自动从当前页面加载 +-1）。当您滚动过去时，不会显示下一页。下面问题的 GIF 演示。

**调试信息**：页面*正在*实例化（参见下面的代码）并成功添加到 ViewPager `ArrayList<ItemInfo>mItems`（通过日志消息确认）。我`android.support.v4`使用 debug=true 设置（`mmm frameworks/support/v4/`在 aosp 中）重新编译了库，它显示一切正常，除了：

ViewPager 中的 onLayout 和 onMeasure 方法在前两个视图加载后停止调用。这意味着其他页面是黑色的，因为它们从未按应有的方式进行测量和排列。我尝试在不同的点添加不同的 requestLayout() 调用以强制布局树刷新无济于事。

**背景**：我有一个通过 inflater.inflate 实例化的 ViewPager，并通过 view.findViewById(R.layouy.myid) 找到。它直接替换了旧的 Gallery 视图，出于测试目的，PagerAdapter instantiateItem(collection, position) 只是这样做：

```
@Override
public Object instantiateItem(View collection, final int position) {
    final TextView tv = new TextView(collection.getContext());
    tv.setText("Looking at page " + position);
    tv.setTextColor(Color.WHITE);
    tv.setBackgroundColor(Color.rgb( (int)(Math.random()*100), (int)(Math.random()*100), (int)(Math.random()*100)));
    tv.setTextSize(22);
    ((ViewPager) collection).addView(tv);
    return tv;
} 
```

有任何想法吗？在我看来，PageView 的父母中的一些神秘设置以某种方式禁用了 onLayout PageView

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-30T20:36:26.403

发现了我的问题。在我看来，有人在没有调用的情况下`LinearLayout`继承和覆盖了父级。`requestLayout()``super.requestLayout()`

这打破了我的视图层次结构的刷新，并阻止了 onMeasure 和 onLayout 在我的 ViewPager 上被调用。在没有测量和布置页面的情况下，它们在 ViewPager 中显示为空白。

希望有一天这可以帮助其他人。我确实花了很长时间才弄清楚。

专业提示：**android-sdk/tools/hierarchyviewer**令人*难以置信*。谢谢安卓团队。每个人都应该至少运行一次它，它对于调试和设计任何 UI 都是非常宝贵的。

# c# - 如何在 C# 中嵌入 VBS 并运行它？

> ID：11659495
> 
> 赞同：3
> 
> 时间：2012-07-25T22:16:19.187
> 
> 标签：c#, .net, vbscript

我有一个运行良好的 VBScript。我有一个可以使用 cscript 程序运行 VBScript 的 C# 程序。

我想要做的是将 VBS 嵌入到 C# exe 中，因此它是一个文件并且能够运行 VBS 文件。有什么方法可以将嵌入式 VBScript 文件作为参数传递给 cscript 或以其他方式运行嵌入式 VBS 文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T22:23:31.257

```
Type scriptType = Type.GetTypeFromCLSID(Guid.Parse("0E59F1D5-1FBE-11D0-8FF2-00A0D10038BC"));

dynamic obj = Activator.CreateInstance(scriptType, false);
obj.Language = "vbscript";
string vbscript = "msgbox(\"test\")";
obj.Eval(vbscript); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T22:24:55.070

另一种方法是您可以通过子进程执行 CSCRIPT.EXE：

```
Process.Start("cscript.exe", "C:\\myscript.vbs"); 
```

但是，请记住，.NET 和 C# 与 VBS 脚本非常兼容。您可能只想将 VBS 代码直接重写为 C# 程序。

# c# - 子视图不会自动实例化它们的“视图模型”

> ID：11659498
> 
> 赞同：0
> 
> 时间：2012-07-25T22:16:31.697
> 
> 标签：c#, wpf, exception, view, prism

我在 PRISM 架构中有一个 WPF 应用程序。

我有一个用户控件（视图），里面有 2 个用户控件。

[这是想法：](http://s18.postimage.org/5i0vik8vr/SO_Question_6.png) [![这是一个想法：](../Images/a9276e8a7b56ca87a92414aea89d3e6b.png)](https://i.stack.imgur.com/3aWEY.png)

“搜索用户控件”位于其自己的用户控件中的原因是因为我计划在我的应用程序中重用它。

主用户控件（**黑色**）称为“MainView”，其中有 2 个用户控件： - 一个用户控件，有几个我可以过滤的文本框控件，以及一个“搜索”按钮 - 一个用户控件我显示结果的网格

这些用户控件中的每一个（以及父级“主视图”）都是“视图”并具有“视图模型”。

一切都显示得很好，除了“子”用户控件不会自动创建自己的“视图模型”这一事实。

在视图模型的类中，我有**“导出”**属性，在视图的代码隐藏中，我有这个片段：

```
[Import]
FilterFieldsViewModel ViewModel
{           
    set
    {
       this.DataContext = value;
    }
} 
```

设置“视图模型”**确实**发生在“主视图”中，但不会发生在子视图中......

我有一个绑定到“搜索用户控件”的“搜索”按钮的命令，当应用程序加载时 - 我在输出窗口中收到错误消息，说：

> BindingExpression 路径错误：在“对象”“MainWindowViewModel”（HashCode=22047425）上找不到“SearchCommand”属性。绑定表达式：路径=搜索命令；DataItem='MainWindowViewModel' (HashCode=22047425); 目标元素是“按钮”（名称=“搜索”）；目标属性是“命令”（类型“ICommand”）

出于某种原因，来自“子”用户控件的命令尝试绑定到主窗口视图模型中的视图模型，因为出于某种原因 - 子用户控件的视图模型未实例化。

为什么是这样 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T08:18:00.743

您的依赖注入容器 (MEF) 没有在子视图上注册导入，因为它们是由`MainView`而不是由 MEF 创建的。您可能想要做的是在您的 : 上创建一个属性`MainViewModel`：

```
[Import]
public FilterFieldsViewModel FilterFieldsViewModel {get; set; } 
```

然后在 XAML 中：

```
<UserControl ....>
   ...
   <SearchUserControl DataContext="{Binding FilterFieldsViewModel}" ... />
   ...
</UserControl> 
```

这使 MEF 能够`FilterFieldsViewModel`为您创建一个实例并将其发送到`SearchUserControl`.

这当然是基本概念，也许你会想要创建一个 ' `SearchViewModelBase`' 或具有`FilterFieldsViewModel`.

# css - CSS3 Flexbox 布局模块 - 当它是一个弹性项目时对齐内联元素

> ID：11659504
> 
> 赞同：0
> 
> 时间：2012-07-25T22:16:44.460
> 
> 标签：css, flexbox

鉴于我有这个 HTML 代码：

```
<div>
    <h2>What is Lorem Ipsum?</h2>
    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p>
    <a href="#">Read more</a>
</div> 
```

和 CSS：

```
div {
    display: flex;
    flex-direction: column;
    padding: 1em;
    border: 1px solid #DDD;
    border-radius: 10px;
}

div h2 {
    font-size: 1.2307em;
    text-align: center;
}

div p {
    flex: 1;
    margin: 0.7692em 0;
} 
```

如何设置锚的样式以使其水平居中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:58:31.003

一种方法是：

1.  使您的锚成为块元素（显示：块）
2.  给它一个宽度（即80px）和边距自动
3.  最后给它一个容器的宽度（即100％）

这是CSS

```
 div {
        display: flex;
        flex-direction: column;
        padding: 1em;
        border: 1px solid #DDD;
        border-radius: 10px;
        width:100%;
    }

    div h2 {
        font-size: 1.2307em;
        text-align: center;
    }

    div p {
        flex: 1;
        margin: 0.7692em 0;
    }

    div a{
        width:80px;
        margin:auto;
        display: block;
    } 
```

和html

```
 <div>
         <h2>What is Lorem Ipsum?</h2>
         <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p>
         <a href="#">Read more</a>
    </div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:59:39.627

在段落之外有一个像这样浮动的锚并不是好的标记。您应该在锚点周围放置第二个段落标签，然后将该段落居中。

您也可以像现在一样在代码上使用此 CSS：

```
a {
text-align: center;
display: block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:10:04.313

我发现“align-self” flex 属性有助于在交叉轴上对齐元素。但它只能应用于弹性项目，<a>、<span> 等内联元素不被视为弹性项目。所以我能想到的唯一解决方案是用像 <div> 或 <p> 这样的块级元素包装它并使用“text-align”属性。

```
<div><a href="#">Read more</a></div>

div a { text-align: center; } 
```

[http://www.w3.org/TR/css3-flexbox/#align-self](http://www.w3.org/TR/css3-flexbox/#align-self)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-09T01:38:09.890

设置`align-self: center`在`<a>`（当然，也具有特定于浏览器的属性版本）。内联元素确实会成为弹性项目，因此不需要块级包装器围绕`<a>`.

话虽如此，如果你打算使用 flexbox，你会很快发现它通常需要额外的 div 包装，所以你现在不妨习惯它。只要你不和他们一起发疯，这不是一件坏事。HTML5 规范甚至谈到了如何将 div 用于演示目的是合适的。因此，当您只需要添加一个时，不要为此感到内疚。

# ios - ios - 如何设置全局样式？

> ID：11659512
> 
> 赞同：0
> 
> 时间：2012-07-25T22:17:18.890
> 
> 标签：ios, ios5

我正在使用故事板，并且我在应用程序上有一些包含内容的页面。不是通过使用屏幕右侧的小颜色/字体编辑器手动创建标题和文本的样式，有没有办法只创建一个样式并在这些内容页面中使用它？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:39:04.197

由于您只希望样式影响您的某些标签，因此我建议`UILabel`为您想要的每种不同样式创建一个子类。在每个子类中，实现`awakefromNib`设置标签样式属性的方法。然后，对于您想要应用样式的每个标签，将界面生成器中的类设置为您的子类

![](../Images/8f991932e746d55b853a6f39489c6ae2.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:18:20.100

是的，但它需要您使用样式表框架。

例如，three20 有一个 TTStyle 框架，它非常擅长创建可以应用于标签、按钮和视图的样式类。

[http://three20.info/](http://three20.info/)

查看本教程： http: [//www.mattvague.com/three20-stylesheets-tutorial](http://www.mattvague.com/three20-stylesheets-tutorial)

我相信 Nimbus Kit 也有一个样式库，但我没有深入探索它：

[http://nimbuskit.info/](http://nimbuskit.info/)

# python - 如何使用python比较表的行

> ID：11659513
> 
> 赞同：1
> 
> 时间：2012-07-25T22:17:31.200
> 
> 标签：python, mysql-python

抱歉，如果标题具有误导性或描述性不强，但这是我想要的，我有一个包含 2 列的表格：

```
name|value
1.aaaa|132412
2.aaaa|234124
3.aaaa|542253
bbbb|234324
bbbb|342342 
```

所以我想基本上比较 name="aaaa" 我卡住的部分是如何比较所有行 name="aaaa"

```
sql="select value from table where name='aaaa'"
cursor.execute(sql)
result=cursor.fetchall()
for row in result:
  value=row[0] 
```

我该怎么走？

编辑：我想比较 1 和 2,1 和 3 的值，类似地 2 和 3 等等..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:30:51.910

您已经找到了获取所有结果的代码，然后听起来您想比较所有两项的值组合。

```
sql="select value from table where name='aaaa'"
cursor.execute(sql)
results=cursor.fetchall() # changed to results to better reflect the list structure
count = len(results)
for i in range(0, count):
  for j in range (i+1, count):
    print results[i][0], results[j][0] 
```

这将打印所有对。. . 显然你会想要解析它们，并在 print 语句所在的位置进行比较。

# java - 重写 toString 方法

> ID：11659515
> 
> 赞同：1
> 
> 时间：2012-07-25T22:17:48.047
> 
> 标签：java, tostring

我正在使用 .toString 返回对象的字符串表示形式，即

```
jcb.engineMove(move.toString()); 
```

将产生e2e4。

我要做的是将此对象（e2e4）的文本提取为字符串。谷歌搜索后，我遇到了覆盖 toString 方法，所以我想出了这个：

```
@Override
public String toString() {
    String s = "";
    int newRank = getRank();
    int newFile = getFile();
    final Move move = new Move(rank, file, newRank, newFile);
    s+="" + move;
    return s;
} 
```

我的问题是相当基本的：

1.  这是正确的方法吗
2.  尝试获取对象的文本时如何调用此例程？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T22:26:36.897

覆盖`Object.toString`是一个很好的方法。

*但是*，您当前的实现由于创建了一个新`Move`对象而犯了一个重大错误（见下文）。

要调用例程（一旦你修复它），完全按照你已经在做的事情：

`jcb.engineMove(move.toString());`

如果`toString()`应该只用于调试（如mre所说），您可以实现另一个名为的方法`getText`来做同样的事情。

**重要的提示：**

您**不应该**在其方法 内创建新`Move`对象。`toString`

这是一个非常糟糕的主意（正如其他人所提到的）。

您的`toString`方法应该简单地构建一个字符串并返回它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T22:29:21.533

这是在课堂上`toString()`实施的吗？`Move`如果是，那么我看到的是一个无限循环。而且......我真的不明白你为什么要创建一个`Move`类的新实例。

无论如何，要在`Move`类中生成字符串表示，请尝试使用以下内容：

```
public class Move {

  @Override
  public String toString() {
    StringBuilder builder = new StringBuilder();
    builder.append(rank).append(file);
    builder.append(newRank).append(newFile);
    return builder.toString();
  }

} 
```

然后，如果您想获得字符串表示，那么您实际上在做什么 ( `jcb.engineMove(move.toString());`) 并不是一个坏方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T22:18:54.863

的使用`Object#toString`应该仅限于调试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-25T22:35:20.173

我希望这不是类中的`toString()`方法代码`Move`。我担心的原因是您正在其中创建对象并通过（这与 相同）`Move`调用递归`toString()`方法。`s+="" + move;``s+=move.toString()`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-25T22:25:44.827

1.  覆盖 toString() 方法是实现对象的自定义文本表示的常见且正确的方法。您将在整个文献和文档中找到此过程。

2.  在 Java 中（就像在 C# 等其他语言中的情况一样），`toString()`方法是在对象类型中定义的，这意味着 Java 中的每个对象都有这个方法。如果您的自定义对象（从 class 继承`object`）覆盖了该`toString()`方法，那么您的基类提供了该方法的新实现，该实现隐藏/省略了`toString()`超类中的方法。

这意味着当您`toString()`在自定义类 A 中定义自定义方法时，调用该类型的实例（比如说它是 a）`a.toString()`将导致调用您的实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-25T22:27:14.127

1.  在这种情况下，我可能不会使用 toString() ，因为您似乎只是在重复 Move 类中的逻辑。为了添加任何其他细节，我有一个问题：您将此 toString() 方法添加到哪个类？

2.  您可以像调用任何其他方法一样调用此方法。首先，您需要一个对象实例来调用它：

    someObj.toString();

要提供更多详细信息，我需要回答上一个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-25T22:29:50.767

正如 mre 所说，您不应该将 toString() 用于您的代码所依赖的功能。现在，你想完成什么？你能给出这些类的任何代码吗？我认为您的 engineMove 方法应该采用 Move 对象，而不是 String。如果您可以提供更多详细信息，我们也许可以引导您朝着更好的方向前进。

另外，请注意您拥有的代码。为什么需要在 toString() 内部新建一个占用时间和资源的 Move 对象？toString() 应该对类的一个实例进行操作，因此您不需要创建一个新实例，但更重要的是，使用 s+="" + move; 将在新的 Move 对象上隐式调用 toString() ，这将在新的 Move 对象上再次调用它...

# javascript - JavaScript 翻转图片库在 Chrome 或 IE 中不起作用

> ID：11659519
> 
> 赞同：0
> 
> 时间：2012-07-25T22:18:09.730
> 
> 标签：javascript, jquery

我建立了一个小型图片库，可以使用 JavaScript Rollovers。我还添加了一些 jquery 来增加图像。我的问题是一切都在 Firefox 中完美运行，但在 IE 或 Chrome 中却不行。一切都将显示在 IE 和 Chrome 中，但是当您单击缩略图时，不会填充大图像。

当前页面代码：

```
<a href="#" onmouseup = "window.document.gallery.src = 'images/Gallery/Landscapes_Album/slides/Tern Lake Sunset.jpg'">
<img src="images/Gallery/Landscapes_Album/thumbs/Tern Lake Sunset.jpg" width="80" height="80" class="gallery-thumb" id="In"/></a> 
```

当前的jQuery代码：

```
// jQuery fade-in and fade-out

$(function() {
  // OPACITY OF BUTTON SET TO 50%
  $(".gallery-thumb").css("opacity","0.5");

  // ON MOUSE OVER
  $(".gallery-thumb").hover(function () {

    // SET OPACITY TO 100%
    $(this).stop().animate({
       opacity: 1.0
      }, "slow");
    },

    // ON MOUSE OUT
    function () {

    // SET OPACITY BACK TO 50%
    $(this).stop().animate({
      opacity: 0.5
    }, "slow");
  });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T01:39:04.033

The error in chrome is "cannot set attribute src of undefined". This is because the expression `window.document.gallery` does not evaluate to anything. As MrOBrian noted, I do not see how this works in any browser.

An alternative implementation of the html could be:

```
<a href="#" onmouseup="$(this).find('img').attr('src', 'yourimage.jpg')">
    <img src="http://placekitten.com/80/80" width="80" height="80" class="gallery-thumb" id="In"/></a>​ 
```

...although it would be more standard if you were just to do it somewhere in your javascript:

```
$(".gallery-thumb").parent().mouseup(function() {
    $(this).find('img').attr('src', 'yourimage.jpg');
}); 
```

I setup a jsFiddle for you to play around with it: [http://jsfiddle.net/ZfkeU/10/](http://jsfiddle.net/ZfkeU/10/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T02:51:18.413

使用 css 实现此效果：

```
<a href="#">
<img class="img1" .../>
<img class="img2" .../>
</a> 
```

的CSS：

```
a{position:relative;}
a img{position:absolute;top:T;left:L;}
a img.img1{ z-index:101;}
a img.img2{ z-index:100;}
a:hover img.img1{ display:none;} 
```

更简单，更清洁......

# php - 在第一个非字母字符处拆分字符串

> ID：11659524
> 
> 赞同：0
> 
> 时间：2012-07-25T22:18:37.427
> 
> 标签：php, string

如何从开头到第一个非字母字符获取字符串的一部分？

示例字符串：

*   `Hello World`
*   `Hello&World`
*   `Hello5World`

我想得到“你好”部分

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T22:21:43.270

您需要使用 preg_split 功能。

```
$str = 'Hello&World';
$words = preg_split('/[^\w]/',$str);

echo $words[0]; 
```

您可以通过 $words[0] 访问 Hello，通过 $words[1] 访问 World

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:20:58.207

您可以[`preg_match()`](http://php.net/preg_match)为此使用：

```
if (preg_match('/^([\w]+)/i', $string, $match)) {
    echo "The matched word is {$match[1]}.";
} 
```

如果您*不想*匹配或任何数字字符，请更改`[\w]+`为。`[a-z]+`*`5`*

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T22:21:38.487

使用[`preg_split`](http://php.net/manual/en/function.preg-split.php). 通过正则表达式拆分字符串

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-25T22:21:32.233

如果您只想要第一部分，请使用[`preg_match`](http://php.net/preg_match)：

```
preg_match('/^[a-z]+/i', $str, $matches);

echo $matches[0]; 
```

[这是一个演示。](http://codepad.viper-7.com/Ri4ySi)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-02T13:29:28.810

使用 preg_split 获取 alpha 的第一部分。
$array = preg_split('/[^[:alpha:]]+/', 'Hello5World'); 回声 $array[0];*

# rest - 在 Asp.Net Web API 的 DelegatingHandler 中编写 Pragma 标头

> ID：11659525
> 
> 赞同：1
> 
> 时间：2012-07-25T22:18:51.123
> 
> 标签：rest, asp.net-web-api

我已经向与此相关的[程序员提出了这个问题](https://softwareengineering.stackexchange.com/questions/158198/http-response-header-for-a-unique-request-id-for-rest-service)。我正在尝试找到一个合适的标头，该标头不太可能被剥离，即使它不发送正文，我也可以使用它为每个响应发送回一个唯一的请求 ID。

我考虑的标头之一是标`Pragma`头，从规范来看，它似乎不仅适用于额外的`no-cache`HTTP 1.0 向后兼容值，还适用于特定于应用程序的值，因此我应该能够使用它。例如，应该可以发送类似`no-cache; requestid=id`.

因此，`DelegatingHandler`我尝试用我的 ID 写信给它：

```
//HttpResponseMessage Response; 
Response.Headers.Add("pragma", "some_value"); 
```

但它到达客户端时`no-cache`; 总是。我认为 WebAPI 会自动发送与缓存关闭一致的缓存标头，其中包括`Pragma`一个。

那么，我如何确保我的价值得到维护而不被覆盖？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T08:38:22.603

我已经破解了，答案是确保您还在`CacheControl`HttpResponseMessage 上设置了标头，然后绕过了一些*稍微*可疑的逻辑`System.Web.Http.WebHost.HttpControllerHandler`（[我已经在 CodePlex 上对此进行了讨论](http://aspnetwebstack.codeplex.com/discussions/389092)；我认为需要更改逻辑） .

所以而不是

```
//HttpResponseMessage Response;
Response.Headers.Add("pragma", "some_value"); 
```

你所要做的：

```
Response.Headers.CacheControl = 
  new System.Net.Http.Headers.CacheControlHeaderValue() 
  { 
    NoCache = true 
  };
Response.Headers.Add("pragma", "some_value"); 
```

（我使用了 NoCache，因为当前的 API 默认是关闭所有响应的缓存）。

# c# - 如何创建返回实现接口的类的类型的方法的通用接口？

> ID：11659526
> 
> 赞同：2
> 
> 时间：2012-07-25T22:18:50.540
> 
> 标签：c#, generics, types, interface

我正在寻找一种在下面定义“MethodA”的方法，以便它返回一个类定义（System.Type），其中所述类型的实例实现“InterfaceB”

```
interface IMyInterface
{
  TType MethodA<TType, TInterface>() 
    : where TType : System.Type
    : where [instanceOf(TType)] : TInterface
} 
```

*（注意：instanceOf 不是真实的，当然……）*

我怀疑在编译时不可能得到这种验证。我希望有人能证明我错了。

提前感谢您的任何指导。

*编辑：我已经更新了这个，希望更具体地说，返回的是一个 System.Type，后面的代码可以执行它：*

```
var classType = myInterface.MethodA<(something, ISomeInterface)>();
ISomeInterface = new classType();  //--Assuming default constructor 
```

*我还没有真正专注于这部分，只是对我的主要问题的理论结构更加好奇。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:30:40.543

您的问题有两种解释；一个是微不足道的，一个是不可能的，所以我会继续介绍两者。

1.  您想返回一个同时实现[`System.Type`](http://msdn.microsoft.com/en-us/library/system.type.aspx)和的类型的实例`TInterface`。

    这很简单：只需使用`where TType : Type`and `where TType : TInterface`。

2.  您想返回一个[`System.Type`](http://msdn.microsoft.com/en-us/library/system.type.aspx)表示继承自 的类型的实例`TInterface`。

    这是不可能在 .NET（和 C#）类型系统中指定的。

    类型系统只能解析来自类型层次结构本身的信息，但不能强制执行“合同”，例如受限的运行时属性值。关于默认构造函数等有一些技巧，但据我所知，甚至无法测试现有方法（例如，与 C++ 模板不同，更不用说 Qi 等人了）。

*更新*

请查看[Michael Graczyk](https://stackoverflow.com/users/1301879/michael-graczyk)的评论。

另外：我刚刚发现.NET 有代码合同检查器（静态和运行时）：[Microsoft DevLabs Code-Contracts for .NET](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx)。我从未使用过它们，甚至对它们都不陌生，但这看起来很有趣！

但是，即使不看，我也很确定重载解析等将无法使用此类信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T00:08:32.853

在这个情况下：

```
// We have an interface...
interface InterfaceB {}

// And this class implements the interface.
class ImplementsB : InterfaceB {}

// But this class does not.
class DoesNotImplementB {} 
```

你可以定义`MethodA`为：

```
static Type MethodA<TClass, TInterface>()
    where TClass : TInterface
{
    return typeof(TClass);
} 
```

然后以下将起作用：

```
Type t = MethodA<ImplementsB, InterfaceB>(); 
```

但这会产生编译时错误：

```
Type t = MethodA<DoesNotImplementB, InterfaceB>(); 
```

> 类型“DoesNotImplementB”不能用作泛型类型或方法“MethodA<TClass,TInterface>()”中的类型参数“TClass”。没有从“DoesNotImplementB”到“InterfaceB”的隐式引用转换。

因此，通过这种方式，您可以确定 的结果`MethodA`是一个`Type`实现`TInterface`. 给定该`Type`对象，您可以稍后像这样实例化它：

```
public object Instantiate(Type type)
{
    // Call the default constructor.
    // You can change this to call any constructor you want.
    var constructor = type.GetConstructor(Type.EmptyTypes);
    var instance = constructor.Invoke(new object[0]);
    return instance;
} 
```

如果您知道您`Type`的接口与某些接口兼容`TInterface`，那么您可以使用这样的附加方法来避免强制转换：

```
public TInterface Instantiate<TInterface>(Type type)
{
    return (TInterface)Instantiate(type);
} 
```

但是，如果`type`是 a`Type`以某种方式无法实现`TInterface`，您将`InvalidCastException`在运行时得到 a 。没有办法限制`Type`为在编译时实现特定接口的类型。但是，在运行时您可以检查它以避免`InvalidCastException`异常：

```
public TInterface Instantiate<TInterface>(Type type)
{
    if (!typeof(TInterface).IsAssignableFrom(type))
        throw new Exception("Wrong type!");
    return (TInterface)Instantiate(type);
} 
```

请注意，这`typeof(TType)`是一个生成`Type`对象的表达式，因此在您看到的任何地方都`typeof()`可以用任何`Type`变量替换它，反之亦然。

这是你想知道的吗？

# java - 无法使用 JavaMail 连接到 Hotmail

> ID：11659527
> 
> 赞同：0
> 
> 时间：2012-07-25T22:18:53.903
> 
> 标签：java, jakarta-mail, hotmail

首先，如果这是一个重复的问题，让我申请一下。在过去的几个月里，我一直在尝试使用 JavaMail 发送电子邮件。通过我的 Hotmail 帐户。我已经使用了过去发布到该站点的有关此主题的大量提示和代码片段；但是，当我执行 Transport.connect 方法时，我仍然收到 java.net.ConnectException: Connection denied...

这是我的代码

```
String fromUserName = "testEmailAddress@hotmail.com";
String fromEMailAddress = "My Email Test <testEmailAddress@hotmail.com>";
String fromEmailPassword = "testEmailPassword";
String emailServerName = "smtp.live.com";
String emailServerPort = "587";
String toEMailAddress = "<TestDestinationEmailAddress@gmail.com>";      

Properties emailProps = System.getProperties();
emailProps.put("mail.smtps.host", emailServerName);
emailProps.put("mail.smtps.auth", "true");
emailProps.put("mail.transport.protocol", "smtps");
emailProps.put("mail.smtps.starttls.enable", "true");
emailProps.put("mail.smtps.ssl.enable","true");
emailProps.put("mail.smtps.port", emailServerPort);
emailProps.put("mail.debug", "true");

Authenticator localAuthenticator = new SMTPAuthenticator(fromUserName, fromEmailPassword);

Session emailSession = Session.getInstance(emailProps, localAuthenticator);

try {

    SMTPTransport emTransport = (SMTPTransport) emailSession.getTransport("smtps"); 
    emTransport.connect(emailServerName, Integer.parseInt(emailServerPort), fromUserName, fromEmailPassword);
    System.out.println("Ok, we connected ok.");

    MimeMessage emailMsg = new MimeMessage(emailSession);           
    emailMsg.addRecipient(Message.RecipientType.TO, new InternetAddress(toEMailAddress));
    emailMsg.setFrom(new InternetAddress(fromEMailAddress));
    emailMsg.setSubject("Automated Notification Number 1");
    emailMsg.setContent(getHtmlContent(), "text/html");
    emTransport.sendMessage(emailMsg, emailMsg.getAllRecipients());
    System.out.println("Sent Message#: 1");

} catch (Exception e) {
    e.printStackTrace();
} 
```

这是一个例外......

```
DEBUG JavaMail version 1.4.5
DEBUG successfully loaded resource: /META-INF/javamail.default.providers
DEBUG SMTP useEhlo true, useAuth true
DEBUG SMTP trying to connect to host "smtp.live.com", port 587, isSSL true
javax.mail.MessagingException: Could not connect to SMTP host: smtp.live.com, port: 587;
  nested exception is:
    java.net.ConnectException: Connection refused: connect
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1972)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:642)
    at javax.mail.Service.connect(Service.java:295)
    at com.acf.TestingClasses.EmailSendingGames.sendMail(Unknown Source)
    at com.acf.TestingClasses.EmailSendingGames.main(Unknown Source)
Caused by: java.net.ConnectException: Connection refused: connect 
```

有几件事：

*   我已经尝试过“smtp”和“smtps”......这似乎并不重要
*   我尝试过端口：25、465、587 和 995...仍然拒绝连接
*   我已经在许多计算机上尝试了相同结果的代码。
*   从 JavaMail 演示代码中剪切并粘贴代码，但仍然会出现错误。
*   该代码适用于 yahoo、at&t、gmail 和其他...但不适用于 Hotmail！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-26T19:06:34.893

我删除了所有“socketFactory”的东西，如[使用 javamail 从 hotmail 发送？](https://stackoverflow.com/questions/9086420/using-javamail-to-send-from-hotmail) 然后它工作得很好......

下面是函数：

```
private Properties _setProperties() {   
    Properties props = new Properties();   

    props.put("mail.smtp.host", _host);   

    if(_debuggable) {   
      props.put("mail.debug", "true");   
    }   

    if(_auth) {   
      props.put("mail.smtp.auth", "true");   
    }

    props.setProperty("mail.transport.protocol", "smtp");
    props.setProperty("mail.host", _host);
    props.put("mail.smtp.starttls.enable", "true");
    props.put("mail.smtp.port", _port);

    return props;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:41:40.213

想必您已经阅读过[这个 JavaMail FAQ entry](http://www.oracle.com/technetwork/java/javamail/faq/index.html#hotmail)。

[您是否也尝试过这里](http://www.oracle.com/technetwork/java/javamail/faq/index.html#condebug)的调试技巧？

从您发布的调试输出来看，您似乎有防火墙或阻止您连接到该站点的东西。

# ubuntu - 在 ubuntu 上精确找到 glib-2.0 库

> ID：11659530
> 
> 赞同：2
> 
> 时间：2012-07-25T22:19:02.237
> 
> 标签：ubuntu, glib

此时，我尝试将 glib-2.0 与 code:blocks 一起使用，但在我的 ubuntu 精确（12.04 LTS）上找不到共享 glib 有人对此有想法吗？此致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:48:16.073

我找到了我搜索的内容。在 ubuntu 终端上使用 'pkg-config --cflags --libs glib-2.0' 来查找所有要使用的头文件 glib 文件的目录。它给了我： /usr/include/glib-2.0 和 /usr/lib/i386-linux-gnu/glib-2.0/include 。我们在 code:blocks 上添加这两个文件夹（设置 -> 编译器和调试器 -> 搜索目录）。之后，我们必须指定与 glib-2.0 一起使用的共享库的 code:blocks。在 ubnutu 上它是“/lib/i386-linux-gnu/libglib-2.0.so.0.3200.3”所以转到代码：块：“设置->编译器和调试器->链接设置”和“链接库”粘贴它。

# google-maps - 路线 API 为某些 URL（而不是其他 URL）返回 INVALID_REQUEST

> ID：11659532
> 
> 赞同：1
> 
> 时间：2012-07-25T22:19:08.003
> 
> 标签：google-maps, google-maps-api-3

对于某些请求，我在为其他请求工作时收到 INVALID_REQUEST。例如，以下返回 INVALID_REQUEST

[http://maps.googleapis.com/maps/api/directions/json?origin=EC3N4AB&destination=EC4M8AD&sensor=false&mode=transit](http://maps.googleapis.com/maps/api/directions/json?origin=EC3N4AB&destination=EC4M8AD&sensor=false&mode=transit)

我还尝试了其他几种变体，如下所示：

[http://maps.googleapis.com/maps/api/directions/json?origin=EC3N4AB,UK&destination=EC4M8AD,UK&sensor=false&mode=transit](http://maps.googleapis.com/maps/api/directions/json?origin=EC3N4AB,UK&destination=EC4M8AD,UK&sensor=false&mode=transit)

同一段代码适用于英国的某些邮政编码，但为其他邮政编码返回 INVALID_REQUEST。如果您在谷歌地图网页界面（EC3N4AB 和 EC4M8AD）中搜索邮政编码，网页界面可以轻松提供方向。

想知道我的网址有什么问题吗？任何帮助将不胜感激。

干杯，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T08:53:53.070

Google对 API 请求做出`departure_time`或强制要求。`arrival_time`此网址有效：

```
http://maps.googleapis.com/maps/api/directions/json?origin=EC3N4AB&destination=EC4M8AD&sensor=false&mode=transit&departure_time=1343376768 
```

感谢大家的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T10:14:07.547

尝试使用区域参数：

```
http://maps.googleapis.com/maps/api/directions/json?origin=EC3N4AB&destination=EC4M8AD&sensor=false&mode=transit&region=uk 
```

另一个原因可能是不支持过境（尝试驾驶，工作良好;-)）

问候

学院派

# android - 如何在splash android上读取互联网状态

> ID：11659536
> 
> 赞同：3
> 
> 时间：2012-07-25T22:19:26.210
> 
> 标签：android, networking

我需要检测 Android 设备在启动时是否已连接或断开互联网...如果没有连接，应用程序将无法打开..我尝试了很多次..但我失败了..这是我启动的来源代码 ：

```
private Handler splashHandler = new Handler();
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Runnable r = new Runnable(){
        public void run(){
            Intent brain = new Intent(Splash.this, MainMenu.class);
            startActivity(brain);
            finish();
        }
    };
    setContentView(R.layout.splashscreen);
    splashHandler.postDelayed(r, 2000);
}

public void onResume(Bundle savedInstanceState){
    super.onResume();
} 
```

}

如果有人帮助我并给我一个源代码..告诉我我必须把它放在哪里..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:40:07.190

从此 SO 帖子：[检测 Android 上是否有可用的 Internet 连接](https://stackoverflow.com/questions/4238921/android-detect-whether-there-is-an-internet-connection-available)

这是您的代码应如下所示：

```
private Handler splashHandler = new Handler();
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Runnable r = new Runnable(){
        public void run(){
            Intent brain = new Intent(Splash.this, MainMenu.class);
            startActivity(brain);
            finish();
        }
    };
    setContentView(R.layout.splashscreen);
    if(isNetworkAvailable())
        splashHandler.postDelayed(r, 2000);
    else {
        //Notify user they aren't connected
        Toast.makeText(getApplicationContext(), "You aren't connected to the internet.", Toast.LENGTH_SHORT).show();
        //close the app
        finish();
    }
}

public void onResume(Bundle savedInstanceState){
    super.onResume();
}

private boolean isNetworkAvailable() {
    ConnectivityManager connectivityManager 
      = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo activeNetworkInfo = connectivityManager.getActiveNetworkInfo();
    return activeNetworkInfo != null;
} 
```

如上面的链接所述，您还需要添加：

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

到你的`AndroidManifest.xml`文件...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:41:33.573

看看[这个](http://www.androiddevblog.net/android/android-network-connectivity-broadcastreceiver)。这是一个`BroadcastReciver`附带动作`ConnectivityManager.CONNECTIVITY_ACTION.`，它允许系统在网络连接发生变化时进行更改。

我希望它有所帮助。

# sql - 执行“sp_executesql @sqlcommand”语法错误

> ID：11659540
> 
> 赞同：0
> 
> 时间：2012-07-25T22:20:01.100
> 
> 标签：sql, syntax

我正在设置一个 SQL 脚本，该脚本从变量名创建数据库，然后获取新创建的数据库并从 .bak 文件中恢复它。我在设置的一个命令中遇到了一些语法问题，想问是否有人可以帮助我发现我的语法错误？我只会粘贴我麻烦的代码片段及其声明，如果我是正确的，问题在于我声明文件名路径的方式。我尝试设置变量的路径，但由于撇号放置，我仍然收到错误。谢谢！！！

```
declare @DBname varchar(10), @sqlcommand Nvarchar(max)
set @DBname = 'testdb' 
```

创建数据库的代码，并将新数据库设置为单用户模式

```
--restore database
set @sqlcommand = N'Restore DATAbase ' + @DBname + ' from disk = ''C:/loc_smartz_db0_template.bak'' with move ' 
+ @DBname + ' to ''C:/ProgramFiles/Microsoft SQL Server/MSSQL/Data/TestDatabase1.mdf'', move ' +     @DBname + ' to ''C:/ProgramFiles/Microsoft SQL Server/MSSQL/Data/TestDatabase1.ldf'', Replace'
EXECUTE sp_executesql @sqlcommand 
```

将数据库设置回多用户并打印数据库已成功创建的代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T00:39:19.667

看起来以前的海报已经解决了您的问题，但是如果您以“最佳实践”方式使用动态 sql，则可能会避免这种情况。将字符串作为变量和字符串文字的混合连接在一起并不理想，因为它使使用撇号变得困难（如此处所示）。

更好的方法是将您的 sql 编写为

```
declare @DBname nvarchar(255) = 'testdb'
        ,@BakName nvarchar(255) = 'C:\loc_smartz_db0_template.bak'
        ,@MovemdfName nvarchar(255) = 'C:\Program Files\Microsoft SQL Server\MSSQL\Data\TestDatabase1.mdf'
        ,@MoveldfName nvarchar(255) = 'C:\Program Files\Microsoft SQL Server\MSSQL\Data\TestDatabase1.ldf'
        ,@sqlcommand nvarchar(max)
        ,@paramList nvarchar(max)

set @paramList = '@DBname nvarchar(255), @BakName nvarchar(255), @MovemdfName nvarchar(255), @MoveldfName nvarchar(255)'
set @sqlcommand = N'Restore DATAbase @DBname from disk = @BakName with move @DBname to @MovemdfName, move @DBname to @MoveldfName, Replace'

exec sp_executesql @statement = @sqlcommand
                  ,@params = @paramList
                  ,@DBname = @DBname
                  ,@BakName = @BakName 
                  ,@MovemdfName  = @MovemdfName 
                  ,@MoveldfName = @MoveldfName 
```

这样，您的 sql 命令就非常易于阅读和维护。请注意，如果您的路径名中有空格，您也不必在变量值中转义撇号。

它还具有允许 SQL Server 重用将提高性能的执行计划的优点（如果您在存储过程中有代码）。

请参阅[此处](http://msdn.microsoft.com/en-us/library/ms188001%28v=sql.90%29.aspx)了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:00:07.207

两件事情。

首先，您必须在数据库文件逻辑名称周围加上单引号，例如

从

```
...with move testdb to 'C:/ProgramFiles/Microsoft SQL Server/MSSQL/Data/TestDatabase1.mdf' 
```

到

```
...with move 'testdb' to 'C:/ProgramFiles/Microsoft SQL Server/MSSQL/Data/TestDatabase1.mdf' 
```

进行中

```
set @sqlcommand = N'Restore DATAbase ' + @DBname + ' from disk = ''C:\loc_smartz_db0_template.bak'' with move ''' 
 + @DBname + ''' to ''C:\ProgramFiles\Microsoft SQL Server\MSSQL\Data\TestDatabase1.mdf'', move '''
 + @DBname + ''' to ''C:\ProgramFiles\Microsoft SQL Server\MSSQL\Data\TestDatabase1.ldf'', Replace' 
```

其次，使用反斜杠`\`，而不是斜杠。（也许这有效，但在我的快速测试中没有。）

# database - 为什么建议尽快关闭休眠事务？

> ID：11659544
> 
> 赞同：0
> 
> 时间：2012-07-25T22:20:30.207
> 
> 标签：database, hibernate

建议我尽快关闭休眠事务。有人可以告诉我为什么推荐这个吗？

[请让这个问题与我之前的问题不同，因为在之前的问题中我本质上是在谈论会话连接，但现在我在谈论事务]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:24:06.713

多线程环境中共享状态/数据之间的任何交互都应尽可能短，以减少其他线程可能无法处理其工作的锁定保持时间。关闭事务可以释放这样一个锁（或多个锁），并允许程序执行在事务打开时无法执行的其他工作，因为事务在关闭之前可能会触及共享数据。

请注意，某些类型的事务（在抽象意义上）是无锁的，但这些可能不是您要处理的。

# perforce - 从 Perforce 更改列表中删除幻像文件？

> ID：11659549
> 
> 赞同：2
> 
> 时间：2012-07-25T22:20:40.620
> 
> 标签：perforce

P4 一直想要提交一些磁盘上不存在的文件：

`open for read: <Path to non-existent-file>: The system cannot find the path specified.`

知道如何让 P4 忘记它们吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:26:09.590

只需编辑您的更改列表并删除幻像文件。如果它们在默认更改列表中，请运行

```
p4 change 
```

从命令行，它会弹出一个编辑器；从“文件：”部分中删除您不想要的文件并保存。保存后，Perforce 将创建一个新的更改列表，您可以使用它提交：

```
p4 submit -c <changelist number> 
```

您还应该恢复丢失的文件，以便它们不会继续出现在您的默认更改列表中：

```
p4 revert <path to files> 
```

# ios5 - iOS 5 中的自定义 Container View Controller 需要 addSubView 添加子控制器吗？

> ID：11659558
> 
> 赞同：0
> 
> 时间：2012-07-25T22:21:37.903
> 
> 标签：ios5, uiviewcontroller

我有 1 个视图控制器充当 CustomViewContainer，它有 2 个子视图控制器，最初在启动时仅添加了 1 个。

`addChildViewController`从 Container 对子项调用，然后对子项进行后续调用，不会`didMoveToParentViewController`在屏幕上显示我的子视图。相反，我仍然看到父控制器的视图。

```
@implementation ContainerViewController // inherits from UIViewController
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    LOG_METHOD_SIG();    
    if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil])
    {
        // ChildViewController is a subclass of UIViewController
        _childController = [[ChildViewController alloc] initWithNibName:nil bundle:nil];
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self addChildViewController:_childController];

    // Expected the following line to display the child controller's view
    [_childController didMoveToParentViewController:self];
} 
```

如果我在`[self.view addSubview:_childController.view]`之后添加`'addChildViewController'`，则会显示视图。但我认为容器视图控制器的全部目的是避免直接视图操作。

在您添加第一个子视图控制器的情况下，您可以调用“transitionFromViewController”吗？如果可以，“从”视图控制器是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T06:33:10.370

`addChildViewController`就是这样做的：它添加了一个子视图控制器。它对它的观点没有任何作用。`transitionFromViewController:toViewController:duration:options:animation:completion`（或其他...）是魔法发生的地方。您的 fromViewController 可能是您最初添加的视图控制器，toViewController 是您的第二个视图控制器。

# jquery - phonegap 不会触发 jquery 点击事件

> ID：11659562
> 
> 赞同：0
> 
> 时间：2012-07-25T22:22:05.890
> 
> 标签：jquery, jquery-mobile, cordova, jquery-click-event

这个例子在这里[http://jsfiddle.net/V3qb9/57/](http://jsfiddle.net/V3qb9/57/)。它在桌面和 jsfiddle 上完美运行——每当我更改单选按钮时，都会弹出一个警报。但是当我在phonegap上尝试时，点击事件根本没有被触发。有什么想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:33:39.363

您是否正确绑定了设备上的操作准备就绪？我不认为 $(document) 在 Phonegap 中的工作方式与在浏览器中的工作方式不同。根据这个答案：

[Phonegap的“onBodyLoad()/onDeviceReady()”函数与Jquery的“$(document).ready()”的关系](https://stackoverflow.com/questions/5036703/the-relationship-between-phonegaps-onbodyload-ondeviceready-functions-and)

试试这个：

```
window.addEventListener('load', function () {
    document.addEventListener('deviceready', function () {
        alert("PhoneGap is now loaded!");
    }, false);
}, false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T06:20:52.120

我在body onload标签中phonegap使用的init方法中尝试了你的代码，`<body onload="init();">`我能够看到警报。

我使用了 phonegap 1.9.0 for android 附带的示例。

我在我的手机（果冻豆）上测试了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T11:28:17.813

采用

```
/* enter code here */ function onBodyLoad()
{       
    document.addEventListener("deviceready", onDeviceReady, false);
}function onDeviceReady()
{
    // do your thing!
    //navigator.notification.alert("Cordova is working")
} 
```

脚本的顶部。希望它会起作用

# javascript - 如何在 javascript 中向 div 添加 onclick 函数？

> ID：11659564
> 
> 赞同：2
> 
> 时间：2012-07-25T22:22:29.567
> 
> 标签：javascript

我有一段 javascript 旨在将 onclick 事件添加到 div。

div 看起来像这样：

```
<div id="deck0" class="deck"></div> 
```

我的javascript有：

```
var i = 1;
document.getElementById('deck0').SetAttribute("onclick", "begin("+i+")"); 
```

但我得到这个错误：

```
Uncaught TypeError: Object #<HTMLDivElement> has no method 'SetAttribute' 
```

我做得对吗，或者我想要实现的目标是不可能的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T22:30:03.730

不要使用*setAttribute*设置侦听器，并非所有浏览器都允许这样做。直接设置属性要好得多：

```
document.getElementById('deck0').onclick = begin; 
```

或使用*addEventListener*：

```
document.getElementById('deck0').addEventListener('click', begin, false); 
```

如果需要传递参数，则：

```
document.getElementById('deck0').onclick = function() {begin(i);}; 
```

*addEventListener*类似。

请注意，早期版本的 IE 不支持*addEventListener*，因此您需要一个跨浏览器功能来测试是否支持。在缺少的地方，测试*attachEvent*并回退到直接属性方法。搜索“addEvent”函数，例子很多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-25T22:24:41.683

Javascript 区分大小写。
那应该是`setAttribute`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:29:39.907

Javascript 区分大小写，您需要将其写成[小写](https://developer.mozilla.org/en/DOM/element.setAttribute)。

除此之外，要设置[事件侦听](http://www.quirksmode.org/js/introevents.html)器，不应使用任何[属性。](http://www.quirksmode.org/js/events_early.html)这将需要每次评估一个字符串 - 您可以从脚本中做得更好。相反，将函数分配给[`onclick`属性](http://www.quirksmode.org/js/events_tradmod.html)：

```
document.getElementById('deck0').onclick = function(event) {
    begin(1);
}; 
```

[高级事件注册](http://www.quirksmode.org/js/events_advanced.html)会更好，但更复杂，因为微软缺乏对标准的支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T22:30:20.943

还有其他方法可以将函数与`onclick`事件关联：

```
function deck0_onclick() {
    begin(i);
}

document.getElementById('deck0').onclick = deck0_onclick; 
```

或直接：

```
document.getElementById('deck0').onclick = function() {begin(i);} 
```

# org-mode - 自动对齐属性和缓冲区内设置

> ID：11659566
> 
> 赞同：1
> 
> 时间：2012-07-25T22:22:33.773
> 
> 标签：org-mode

如何启用属性、缓冲区内设置和类似内容的自动对齐？

我总是以这样的方式结束，然后必须手动对齐。

```
#+STARTUP: indent
#+PRIORITIES: A C B
#+COLUMNS: %ITEM %foo %bar

* section
  :PROPERTIES: 
  :foo: foo
  :barbaz: barbaz
  :END: 
```

但是我发现一些标志对齐应该自动发生。例如有这样的：

```
(defcustom org-property-format "%-10s %s"
  "How property key/value pairs should be formatted by `indent-line'.
When `indent-line' hits a property definition, it will format the line
according to this format, mainly to make sure that the values are
lined-up with respect to each other."
  :group 'org-properties
  :type 'string) 
```

是否有一个命令可以修复属性以尊重它？插入的属性不应该`org-set-property`遵循这种格式吗？`M-x org-indent-line`不为我做任何事情，`indent-line`也不存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T06:10:44.640

`org-indent-line`当属性关键字在行首正确时，没有做正确的事情。现在可以了。

此外，从新的 git pull 中，`C-M-\`在区域上使用会缩进该区域。

要格式化选项标题，您可以选择要对齐的区域并执行

`M-x align-regexp RET <space> RET`

# r - 有没有一种简单的方法可以在没有循环的情况下标准化表中的每一列（使用 R）？

> ID：11659568
> 
> 赞同：2
> 
> 时间：2012-07-25T22:23:01.060
> 
> 标签：r, loops, transform, normalize

我需要标准化数据框中除了一列之外的所有内容，我正在使用 knn。我知道我可以用循环来做到这一点，但似乎有一种更简单的方法，特别是因为我正在使用 200 多个列/因子，这些列/因子必须被重命名。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T22:37:10.043

是的。我假设您更愿意根据其名称来识别不进行缩放的变量，而不是通过它的列位置来识别它。如果没有玩具示例，我只能推测这正是您想要的。

```
x <- data.frame(replicate(10, rnorm(10)))
names(x) <- letters[1:10]

##let's say you don't want to scale "b"
scalevars <- setdiff(names(x), "b")
x.scaled <- data.frame(sapply(x[,scalevars], scale),b=x[,"b"])
x.scaled <- x.scaled[,names(x)] #to get the original order of variables 
```

# ajax - 斜线导航和 Jquery

> ID：11659569
> 
> 赞同：0
> 
> 时间：2012-07-25T22:23:02.230
> 
> 标签：ajax, url, jquery, hashchange

所以我一直想知道像 google plus 和 github 这样的网站是如何导航的。例如，当您访问 plus.google.com 然后单击个人资料时，它会将您带到 plus.google.com/112578301581290773086/posts 之类的内容，但不会重新加载整个页面。

我一直在使用 hashchange 和 $.load 但它不完全是我想要的并且不允许设置目录类型。

# scala - 反射：显示静态类型的字节码类型签名

> ID：11659570
> 
> 赞同：2
> 
> 时间：2012-07-25T22:23:03.057
> 
> 标签：scala, scala-2.10

是否可以使用新的反射库显示保存在字节码中的完整类型签名（带有已擦除的参数化类型）？

例如类型

```
Any => Unit 
```

应显示为

```
"scala.Function1<java.lang.Object,scala.runtime.BoxedUnit>" 
```

因为这是存储在字节码中的类型。可以用 显示这种类型`javap`。第一个需要编译一些代码`scalac`：

```
object X {
  def m(f: Any => Unit) = f
} 
```

命令`javap -c -s -l -verbose X$`显示：

```
...
const #25 = Asciz   (Lscala/Function1<Ljava/lang/Object;Lscala/runtime/BoxedUnit;>;)Lscala/Function1<Ljava/lang/Object;Lscala/runtime/BoxedUnit;>;;
...
public scala.Function1 m(scala.Function1);
  Signature: (Lscala/Function1;)Lscala/Function1;
... 
```

的输出`javap`有点奇怪，我更感兴趣的是获得“类似 Java”的输出。也许一个代表类型签名的字符串是一个更好的类型，可以很容易地生成这个字符串。

另一个例子：

```
package abc
object O {
  def x(i: Int)(j: Int) = i+j
}

// type of x should be displayed something like
"int abc.O$.x(int, int)" 
```

是否已经支持这样的东西，如果没有，如何为任何类型构建这样的输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T02:30:29.993

类型已经是完整的类型签名，但它们不包括完整的路径。为此，您必须前往符号并获取其所有者，或类似的东西。

关于新反思的每一个问题都在这样做，所以如果你能更具体一点，那会有所帮助。

```
scala> import scala.reflect.runtime.universe._
import scala.reflect.runtime.universe._

scala> typeOf[abc.O.type].member(newTermName("x")).typeSignatureIn(typeOf[abc.O.type])
res0: reflect.runtime.universe.Type = (i: scala.Int)(j: scala.Int)scala.Int 
```

# php - 表格在ie中不起作用

> ID：11659575
> 
> 赞同：0
> 
> 时间：2012-07-25T22:23:28.483
> 
> 标签：php, html, forms, post

我有一个在 chrome 中完美运行的表单，但在 ie 中根本无法使用。

实际表单的代码是：

```
<div id="launch">
    <form id="form1" name="form1" method="post" action="" > 
        <input type="image" src="images/transparent.png" width="100" height="100" name="Launch" id="Launch" value="insertvaluehere" />
    </form> 
</div> 
```

当按下表单时，我使用这个 if 语句来执行代码：

```
if (($_POST['Launch']) && ($available1 == 0))
{
//Code for what is done.
} 
```

所有帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:31:27.807

您可以将其更改为

```
<button type="submit" name="launch" id="Launch">Submit</button> 
```

然后使用

```
 #Launch{
        background-image:url(images/transparent.png); 
        width:100px; 
        height:100px; 
        dislay:block; 
        border:none; 
        color:transparent;
        background-color:none;
        cursor:pointer;
   } 
```

改变：

```
if ($_POST)
{
    //execute
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:56:15.170

输入类型的图片一般不提交值，而是提交用户点击图片的坐标（一般用作图片地图）。

如果您致力于使用图像提交，您有两个主要选择：

1.  `<input>`带有隐藏字段的常规提交类型，其中包含您想要的值（您可以使用 CSS 将提交样式设置为图像）
2.  一种`<button>`

# ruby-on-rails - Heroku cedar 没有升级到 ruby -1.9.3

> ID：11659576
> 
> 赞同：1
> 
> 时间：2012-07-25T22:23:30.870
> 
> 标签：ruby-on-rails, ruby, deployment, heroku

尝试将 Heroku cedar 从 Ruby 1.9.2 移植到 Ruby 1.9.3 失败：

```
2012-07-25T22:09:48+00:00 heroku[slugc]: Slug compilation started
2012-07-25T22:11:23+00:00 heroku[api]: Deploy abdaf18 by luca.soave@gmail.com
2012-07-25T22:11:23+00:00 heroku[api]: Release v244 created by luca.soave@gmail.com
2012-07-25T22:11:23+00:00 heroku[web.1]: State changed from up to starting
2012-07-25T22:11:24+00:00 heroku[deployhooks]: Notified New Relic about the deploy
2012-07-25T22:11:24+00:00 heroku[slugc]: Slug compilation finished
2012-07-25T22:11:26+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2012-07-25T22:11:27+00:00 app[web.1]: Exiting
2012-07-25T22:11:28+00:00 heroku[web.1]: Process exited with status 0
2012-07-25T22:11:28+00:00 heroku[web.1]: Starting process with command `bundle exec rails server thin -p 12558`
2012-07-25T22:11:29+00:00 app[web.1]: Your Ruby version is 1.9.2, but your Gemfile specified 1.9.3
2012-07-25T22:11:30+00:00 heroku[web.1]: Process exited with status 18
2012-07-25T22:11:30+00:00 heroku[web.1]: State changed from starting to crashed
2012-07-25T22:11:30+00:00 heroku[web.1]: State changed from crashed to starting
2012-07-25T22:11:36+00:00 heroku[web.1]: Starting process with command `bundle exec rails server thin -p 36407`
2012-07-25T22:11:37+00:00 app[web.1]: Your Ruby version is 1.9.2, but your Gemfile specified 1.9.3
2012-07-25T22:11:39+00:00 heroku[web.1]: Process exited with status 18
2012-07-25T22:11:39+00:00 heroku[web.1]: State changed from starting to crashed
2012-07-25T22:11:40+00:00 heroku[router]: Error H10 (App crashed) -> GET gitwatcher.herokuapp.com/ dyno= queue= wait= service= status=503 bytes=
2012-07-25T22:11:41+00:00 heroku[router]: Error H10 (App crashed) -> GET gitwatcher.herokuapp.com/favicon.ico dyno= queue= wait= service= status=503 bytes=
2012-07-25T22:11:41+00:00 heroku[router]: Error H10 (App crashed) -> GET gitwatcher.herokuapp.com/favicon.ico dyno= queue= wait= service= status=503 bytes= 
```

更新

我跟着`Heroku docs`有

```
ruby '1.9.3' 
```

进入我的 Gemfile 和`bundler --pre`：

```
lsoave@ubuntu:~/rails/github/gitwatcher$ gem list bundler

*** LOCAL GEMS ***

bundler (1.2.0.pre.1, 1.1.4)
lsoave@ubuntu:~/rails/github/gitwatcher$ 
```

更新

我遵循了heroku的建议：`If absent or not the first entry, add bin: to the config with heroku config:add.`但它不起作用：

```
lsoave@ubuntu:~/rails/github/gitwatcher$ heroku config -s | grep PATH
GEM_PATH=vendor/bundle/ruby/1.9.1
PATH=bin:vendor/bundle/ruby/1.9.1/bin:/usr/local/bin:/usr/bin:/bin
lsoave@ubuntu:~/rails/github/gitwatcher$ 
```

...这很奇怪，因为在控制台中运行 ruby​​ -v 会返回正确的版本：

```
lsoave@ubuntu:~/rails/github/gitwatcher$ heroku run:detached "ruby -v"
Running `ruby -v` detached... up, run.1
Use `heroku logs -p run.1` to view the output.
lsoave@ubuntu:~/rails/github/gitwatcher$ heroku logs -p run.1
2012-07-25T22:51:57+00:00 heroku[run.1]: Starting process with command `ruby -v`
2012-07-25T22:51:57+00:00 app[run.1]: ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]
2012-07-25T22:51:57+00:00 heroku[run.1]: State changed from starting to complete
2012-07-25T22:51:58+00:00 heroku[run.1]: Process exited with status 0
lsoave@ubuntu:~/rails/github/gitwatcher$ 
```

更新

...而且我做了：

```
heroku config:add RUBY_VERSION=ruby-1.9.3-p194
heroku config:add PATH=bin:vendor/bundle/ruby/1.9.1/bin:/usr/local/bin:/usr/bin:/bin
recompile ( change + git commit + git push heroku +master ) 
```

但没有，以这种方式重新编译后崩溃：

```
2012-07-25T23:18:47+00:00 heroku[router]: Error H10 (App crashed) -> GET gitwatcher.com/ dyno= queue= wait= service= status=503 bytes=
2012-07-25T23:18:47+00:00 heroku[nginx]: 93.34.152.105 - - [25/Jul/2012:23:18:47 +0000] "GET / HTTP/1.1" 503 601 "-" "Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:14.0) Gecko/20100101 Firefox/14.0.1" gitwatcher.com 
```

更新

**打开 Heroku 调用请求 #58410**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T21:37:49.747

这不是 ruby​​ 版本问题，事实上我在 heroku 编译期间注意到以下错误，即使它没有阻止部署并且推送完成而没有其他问题：

```
-----> Preparing app for Rails asset pipeline

      Running: rake assets:precompile

      rake aborted!

      Invalid CSS after "...nd-image:url(""": expected ")", was "/assets/twitter..."

      (in /tmp/build_19ypab978ku1z/app/assets/stylesheets/application.css)

      Tasks: TOP => assets:precompile:primary

      (See full trace by running task with --trace)

      Precompiling assets failed, enabling runtime asset compilation

      Injecting rails31_enable_runtime_asset_compilation

      Please see this article for troubleshooting help:

      http://devcenter.heroku.com/articles/rails31_heroku_cedar#troubleshooting 
```

然后更好地查看heroku日志，我也看到了这个：

```
psych/syntax_error.rb:5:in 'initialize': wrong number of arguments (1 for 6) (ArgumentError) 
```

和谷歌搜索结果[是类似](https://stackoverflow.com/questions/4980877/rails-error-couldnt-parse-yaml/5107098#5107098)的，我试过了，它有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:26:29.553

2012-07-25T22:11:29+00:00 app[web.1]：您的 Ruby 版本是 1.9.2，但您的 Gemfile 指定了 1.9.3

[https://devcenter.heroku.com/articles/ruby-versions](https://devcenter.heroku.com/articles/ruby-versions)

# c# - 可以在多线程应用程序中安全地使用事件吗

> ID：11659578
> 
> 赞同：2
> 
> 时间：2012-07-25T22:23:32.757
> 
> 标签：c#, multithreading, events

在下面的代码中，我有两个类，一个在单独的线程中运行并触发事件，另一个订阅此事件并从事件接收数据。我基于 Jon Skeet 的文章[http://csharpindepth.com/Articles/Chapter2/Events.aspx的事件代码](http://csharpindepth.com/Articles/Chapter2/Events.aspx)

在这篇文章[http://www.codeproject.com/Articles/37474/Threadsafe-Events](http://www.codeproject.com/Articles/37474/Threadsafe-Events)它说......

> 出于这个原因，我推荐 Jon Skeet 在 Delegates and Events 最后推荐的相同方法：“不要那样做”，即不要以多线程方式使用事件。如果对象上存在事件，那么只有一个线程应该能够订阅或取消订阅该事件，并且将引发该事件的同一线程。

现在显然我的设计打破了这一点，因为它在与它订阅的线程不同的线程上触发事件。我如何修改我的设计，使其遵守不以多线程方式使用事件的原则，或者这是不可能的？

我想到的另一种方法是将我的回调方法作为委托传递给B类并调用它而不是调用事件？

我可能有完全错误的一端，所以任何澄清将不胜感激。

注意：我知道 .Net 4.0 显然已经解决了这个问题，但是我仍然对在 .Net 4 之前是否有办法做到这一点感兴趣

```
public delegate void MyDelegate(int a);

class A
{
    void main()
    {
        B bObject = new B();
        bObject.MyEvent += new MyDelegate(NiceMethod);
        bObject.Run();
    }   

    void NiceMethod(int a)
    {   
        Console.Writeline({0}, a);  
    }
}

class B
{
    readonly object eventLock = new object();

    MyDelegate myDel;

    public event MyDelegate MyEvent
    {   
        add
        {
            lock (eventLock)
            {
                myDel += value;
            }
        }
        remove
        {
            lock (eventLock)
            {
                myDel -= value;
            }
        }
    }   

    //Assume this runs in a new thread and calls back data using MyEvent
    //Have ommited thread code for simplicity
    public void Run()
    {
        for (int i = 0; i < 100; i++)
        {
            Thread.Sleep(1000);
            MyDelegate handler;
            lock (someEventLock)
            {
                handler = myDel;
            }
            if (handler != null)
            {
                handler (i);
            }
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T10:40:17.407

引发事件或监听来自不同线程的事件没有任何问题。侦听器有责任处理从另一个线程调用的问题。正如 Marc Gravell 在他的评论中指出的那样，在来自不同线程的事件中添加和删除侦听器是（并且一直是）由编译器生成`add`和`remove`实现支持的。唯一的问题是以线程安全的方式引发事件，这可以通过生成`add`和`remove`使用的自旋锁同步对事件的访问来完成：

```
class B 
{  
    public event MyDelegate MyEvent;

    protected OnMyEvent(int p_Arg)
    {
        // Delegates are immutable and add/remove default
        // implementations always generate a new instance of the 
        // delegate. Therefore, tTmp (if not null) can be safely invoked
        var tTmp = 
            System.Threading.Interlocked
            .CompareExchange(ref MyEvent, null, null);
        if (tTmp != null) {
            tTmp(p_Arg);
        }
    }

    //Assume this runs in a new thread and calls back data using MyEvent 
    //Have ommited thread code for simplicity 
    public void Run() 
    { 
        for (int i = 0; i < 100; i++) 
        { 
            OnMyEvent(i);
        }    
    } 
} 
```

唯一可能发生的事情是侦听器在从事件列表中删除**后被调用。**恕我直言，侦听器必须能够处理这种情况，因为它处理从不同线程调用的蜜蜂......

# ruby-on-rails - 无法让模型在显示页面上用于提交和验证

> ID：11659581
> 
> 赞同：0
> 
> 时间：2012-07-25T22:24:20.510
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在做一个项目，我对 Rails 很陌生，

我无法弄清楚到底出了什么问题。我得到这个错误。

产品中的 NoMethodError#index

未初始化的常量 ProductsController::Offer

本质上，我有一个正在尝试实现的功能。

在我的产品表中，我有一个名为底价的列，我希望用户在产品页面上的表格上提交一个数字，然后验证它与底价，如果接受它会添加到购物车，如果不闪请输入更高的报价,

问题是我似乎无法弄清楚如何让模型和控制器协同工作。

我整个星期都在这，我仍然不知道。

我想知道是否有人可以查看我的代码并查看我在视图页面中缺少什么可以让它工作我可以快速完成其余的工作，但我不知道我错过了什么。

提供控制器.rb 类 OffersController < ApplicationController

attr_accessible :product, :offer , :reserve_price

def new @offer = Offer.new 结束

```
end 
```

报价模型.rb

```
 class Offer < ActiveRecord::Base 
```

属于_to :product has_many :reserve_prices

attr_accessible :product, :offer , :reserve_price

validates_presence_of :offer validate :ensure_meets_reserve_price

private def ensure_meets_reserve_price if amount < self.product.reserve_price errors.add(:amount, "does not meet reserve price") end end

私人 def reserve_price product.reserve_price end

def your_offer @your_offer = Offer.new

结尾

def new @offer = Offer.new = :your_offer end

```
 end 
```

产品索引视图文件

```
 class ProductsController < ApplicationController 
```

before_filter :authenticate, :except => [:index, :show]

# 获取 /products # 获取 /products.xml

def index @offer = Offer.new

```
@products = Product.search(params[:search_query])

respond_to do |format|
  format.html # index.html.erb
  format.xml  { render :xml => @products }
end 
```

结尾

# GET /products/1 # GET /products/1.xml def show

```
 @product = Product.find(params[:id])

respond_to do |format|
  format.html # show.html.erb
  format.xml  { render :xml => @product }
end 
```

结尾

# GET /products/new # GET /products/new.xml def new @product = Product.new

```
respond_to do |format|
  format.html # new.html.erb
  format.xml  { render :xml => @product }
end 
```

结尾

# GET /products/1/edit def edit @product = Product.find(params[:id]) end

# POST /products # POST /products.xml def create @product = current_user.products.new(params[:product])

```
respond_to do |format|
  if @product.save
    format.html { redirect_to(@product, :notice => 'Product was successfully created.') }
    format.xml  { render :xml => @product, :status => :created, :location => @product }
  else
    format.html { render :action => "new" }
    format.xml  { render :xml => @product.errors, :status => :unprocessable_entity }
  end
end 
```

结尾

# PUT /products/1 # PUT /products/1.xml def update @product = Product.find(params[:id])

```
respond_to do |format|
  if @product.update_attributes(params[:product])
    format.html { redirect_to(@product, :notice => 'Product was successfully updated.') }
    format.xml  { head :ok }
  else
    format.html { render :action => "edit" }
    format.xml  { render :xml => @product.errors, :status => :unprocessable_entity }
  end
end 
```

结尾

# 删除 /products/1 # 删除 /products/1.xml def destroy @product = Product.find(params[:id]) @product.destroy

```
respond_to do |format|
  format.html { redirect_to(products_url) }
  format.xml  { head :ok }
end 
```

结束结束

产品控制器.rb

```
class ProductsController < ApplicationController
  before_filter :authenticate, :except => [:index, :show]

  # GET /products
  # GET /products.xml
  def index
    @products = Product.search(params[:search_query])

    respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @products }
    end
  end

  # GET /products/1
  # GET /products/1.xml
  def show
    @product = Product.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @product }
    end
  end

  # GET /products/new
  # GET /products/new.xml
  def new
    @product = Product.new

    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @product }
    end
  end

  # GET /products/1/edit
  def edit
    @product = Product.find(params[:id])
  end

  # POST /products
  # POST /products.xml
  def create
    @product = current_user.products.new(params[:product])

    respond_to do |format|
      if @product.save
        format.html { redirect_to(@product, :notice => 'Product was successfully created.') }
        format.xml  { render :xml => @product, :status => :created, :location => @product }
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @product.errors, :status => :unprocessable_entity }
      end
    end
  end
 # PUT /products/1
 # PUT /products/1.xml
 def update
   @product = Product.find(params[:id])

   respond_to do |format|
     if @product.update_attributes(params[:product])
       format.html { redirect_to(@product, :notice => 'Product was successfully updated.') }
       format.xml  { head :ok }
     else
       format.html { render :action => "edit" }
       format.xml  { render :xml => @product.errors, :status => :unprocessable_entity }
     end
   end
 end

 # DELETE /products/1
 # DELETE /products/1.xml
 def destroy
   @product = Product.find(params[:id])
   @product.destroy

   respond_to do |format|
     format.html { redirect_to(products_url) }
     format.xml  { head :ok }
   end
 end
       end 
```

有什么帮助吗？

很高兴我已经有一段时间了，还没有弄清楚！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:59:28.683

如果我正确理解您的问题：

*   访问产品时显示错误#show
*   您想在产品#show 页面中包含报价单

在这种情况下，您需要在 ProductsController 显示操作中初始化 @offer 变量，如下所示：

```
@offer = Offer.new 
```

添加

到下一个问题： ProductsController::Offer 是未知的，它不应该是因为你有一个 Offer 模型。我刚刚尝试将您的 Offer 表单包含在一个 show 操作中，并且它显示它没问题，除了您使用新的 Offer 实例初始化该字段之外。（也许是一个数量？）。无论如何，我无法从您的代码片段中看到为什么 Offer 模型在您的控制器中不可用。你能提供完整的来源吗？

我首先怀疑你在Offer中奇怪的私有方法

```
 def your_offer
     @your_offer = Offer.new

   end

def new
  @offer = Offer.new = :your_offer
end 
```

是原因，但我已将它们包括在内，并且表单呈现良好。但我到底应该怎么做？

# ruby-on-rails - 使用 Ruby 在 HTML 中创建表格？

> ID：11659585
> 
> 赞同：2
> 
> 时间：2012-07-25T22:24:54.213
> 
> 标签：ruby-on-rails, ruby, erb

我正在尝试在每行上创建一个包含十个值的表格，从 1 开始到 100。

我的 Ruby 代码如下所示：

```
<table border="1">

  <% (1..100).each do |i| 
    d3 = (i % 3 == 0) 
    d5 = (i % 5 == 0)

    i = "<b>#{i}</b>" if d5
    i = "<i>#{i}</i>" if d3 %>

    <tr>
      <td><%= i %></td>
    </tr>

  <% end %>
</table> 
```

我如何将其放入 10 X 10 的 HTML 表格中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:42:26.810

使用 ERB：

```
<table>
<%10.times do |row|%>
  <tr>
    <%10.times do |col|%>
      <td><%=
        i = row*10+col+1
        if i%5==0
          "<b>#{i}</b>"
        elsif i%3==0
          "<i>#{i}</i>"
        else
          i
        end
      %></td>
    <%end%>
  </tr>
<%end%>
</table> 
```

使用 Haml：

```
%table
  - 10.times do |row|
    %tr
      - 10.times do |col|
        %td
          - i = row*10+col+1
          = i%5==0 ? "<b>#{i}</b>" : i%3==0 ? "<i>#{i}</i>" : i 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:40:17.083

```
<table border="1">

<% (1..100).each do |i| 
   d3 = (i % 3 == 0) 
   d5 = (i % 5 == 0)

   s = "#{i}"
   s = "<b>#{i}</b>" if d5
   s = "<i>#{i}</i>" if d3 %>

  <% if i % 10 == 1 %><tr><% end %>
    <td><%= s %></td>
  <% if i % 10 == 0 %></tr><% end %>

<% end %>
</table> 
```

基本上，您希望在元素 1、11、21 等之前开始一个表格行，并在元素 10、20、30 等之后结束一行。

# perl - 使用 AWK 或 Perl 转置

> ID：11659588
> 
> 赞同：1
> 
> 时间：2012-07-25T22:25:19.777
> 
> 标签：perl, unix, awk

嗨，我想使用 AWK 或 Perl 来获取以下格式的输出文件。我的输入文件是一个空格分隔的文本文件。这类似于我之前的问题，但在这种情况下，输入和输出没有格式。我的列位置可能会改变，所以会欣赏不参考列号的技术

输入文件

```
id quantity colour shape size colour shape size colour shape size
1 10 blue square 10 red triangle 12 pink circle 20
2 12 yellow pentagon 3 orange rectangle 4 purple oval 6 
```

期望的输出

```
id colour shape size
1 blue square 10
1 red triangle 12
1 pink circle 20
2 yellow pentagon 3
2 orange rectangle 4
2 purple oval 6 
```

我正在使用丹尼斯威廉姆森的这段代码。唯一的问题是我得到的输出在转置字段中没有空间分隔。我需要一个空格分隔

```
#!/usr/bin/awk -f
BEGIN {
col_list = "quantity colour shape"
# Use a B ("blank") to add spaces in the output before or
# after a format string (e.g. %6dB), but generally use the numeric argument

# columns to be repeated on multiple lines may appear anywhere in
# the input, but they will be output together at the beginning of the line
repeat_fields["id"]
# since these are individually set we won't use B
repeat_fmt["id"] = "%-1s "
# additional fields to repeat on each line

ncols = split(col_list, cols)

for (i = 1; i <= ncols; i++) {
    col_names[cols[i]]
    forms[cols[i]] = "%-1s"
}
}

# save the positions of the columns using the header line
FNR == 1 {
for (i = 1; i <= NF; i++) {
    if ($i in repeat_fields) {
        repeat[++nrepeats] = i
        repeat_look[i] = i
        rformats[i] = repeat_fmt[$i]
    }
    if ($i in col_names) {
        col_nums[++n] = i
        col_look[i] = i
        formats[i] = forms[$i]
    }
}
# print the header line
for (i = 1; i <= nrepeats; i++) {
    f = rformats[repeat[i]]
    sub("d", "s", f)
    gsub("B", " ", f)
    printf f, $repeat[i]
}
for (i = 1; i <= ncols; i++) {
    f = formats[col_nums[i]]
    sub("d", "s", f)
    gsub("B", " ", f)
    printf f, $col_nums[i]
}
printf "\n"
next
}

{
for (i = 1; i <= NF; i++) {
    if (i in repeat_look) {
        f = rformats[i]
        gsub("B", " ", f)
        repeat_out = repeat_out sprintf(f, $i)

    }
    if (i in col_look) {
        f = formats[i]
        gsub("B", " ", f)
        out = out sprintf(f, $i)
        coln++
    }
    if (coln == ncols) {
        print repeat_out out
        out = ""
        coln = 0
    }
}
repeat_out = ""
} 
```

输出

```
id quantitycolourshape
1 10bluesquare
1 redtrianglepink
2 circle12yellow
2 pentagonorangerectangle 
```

对于之前没有包含有关实际文件的所有信息，我深表歉意。我这样做只是为了简单，但它并没有满足我的所有要求。

在我的实际文件中，我希望为 NODE SITE CHILD 转置字段 n_cell 和 n_bsc

```
NODE SITE CHILD n_cell n_bsc 
```

[这是我正在处理的实际文件的链接](https://docs.google.com/open?id=0B0rMch-nfpzmbU1zRVluTzBpdFU)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:34:43.507

```
<>;
print("id colour shape size\n");

while (<>) {
   my @combined_fields = split;
   my $id = shift(@combined_fields);
   while (@combined_fields) {
       my @fields = ( $id, splice(@combined_fields, 0, 3) );
       print(join(' ', @fields), "\n");
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T09:50:28.177

您告诉我们，您的真实数据包含超过 5,000 列，并且其列位置可能会发生变化，恐怕这还不够。

因此，在没有任何适当信息的情况下，我写了这个，它使用标题行来计算数据集的数量和大小，`id`列在哪里，以及第一组从哪一列开始。

它适用于您的示例数据，但我只能猜测它是否适用于您的实时文件。

```
use strict;
use warnings;

my @headers = split ' ', <>;

my %headers;
$headers{$_}++ for @headers;

die "Expected exactly one 'id' column" unless $headers{id} // 0 == 1;
my $id_index = 0;
$id_index++ while $headers[$id_index] ne 'id';

my @labels = grep $headers{$_} > 1, keys %headers;
my $set_size = @labels;
my $num_sets = $headers{$labels[0]};

my $start_index = 0;
$start_index++ while $headers[$start_index] ne $labels[0];

my @reformat;

while (<>) {
  my @fields = split;
  next unless @fields;
  my $id = $fields[$id_index];
  for (my $i = $start_index; $i < @fields; $i+=$set_size) {
    push @reformat, [ $id, @fields[$i..$i + $set_size - 1] ];
  }
}

unshift @labels, 'id';
print "@labels\n";
print "@$_\n" for @reformat; 
```

**输出**

```
id colour shape size
1 blue square 10
1 red triangle 12
1 pink circle 20
2 yellow pentagon 3
2 orange rectangle 4
2 purple oval 6 
```

# image - Pygame 和 Tilesets，遵循使用说明，但出现“noneType”错误

> ID：11659589
> 
> 赞同：0
> 
> 时间：2012-07-25T22:25:22.933
> 
> 标签：image, graphics, pygame, nonetype

我的 Python 版本是 3.2，Pygame 是 1.9.1。

我遵循了此处找到的说明的第一部分：[http](http://wiki.sheep.art.pl/Tiled%20Map%20in%20PyGame) ://wiki.sheep.art.pl/Tiled%20Map%20in%20PyGame ，并进行了一些调整以适应我自己的图块集：

```
def load_tileset(filename, width, height):
   image = pygame.image.load(filename).convert_alpha()
   imageWidth, imageHeight = image.get_size()
   tileSet = []
   for tileX in range(0, 3):
      line = []
      tileSet.append(line)
      for tileY in range(0, 3):
         rect = (tileX*width, tileY*height, width, height)
         line.append(image.subsurface(rect))
if __name__=='__main__':

   pygame.init()
   screen = pygame.display.set_mode((WIDTH, HEIGHT))
   pygame.display.set_caption('Tiled Background')
   screen.fill((240, 240, 255))
   table = load_tileset('tableset.gif', 16, 16)
   for x, row in enumerate(table):
      for y, tile in enumerate(row):
         screen.blit(tile, (x*24, y*24))
   pygame.display.flip()
   while pygame.event.wait().type != pygame.locals.QUIT:
        pass 
```

我在`for x, row in enumerate(table):`*. 我尝试了各种方法，甚至移动了图块集本身，并更改了文件类型。我还尝试了其他代码，例如范围。

我过去曾设法加载图像，这只是我第一次尝试使用图块集。瓦片集有 9 个 16x16 瓦片，其中有一些透明度（因此是`convert_alpha()`）。

那么，谁能说出为什么我在`NoneType`这里得到错误？和图像有关系吗？（注意，“For tileX in range”中有 3 的原因是它不接受教程中设置的第四个计算，所以我自己做了数学。）

*   编辑：意外输入：`for x, row in range(table):`而不是`for x, row in enumerate(table):`描述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T17:05:18.460

您没有发布完整的代码，或者犯了一个错误：`for x, row in range(table)`上面的代码中没有一行。使用此特定代码，您似乎试图从`range`函数中提取两个变量，但它一次只返回一个值。

您可能打算输入`for x, row in enumerate(table)`. 在这种情况下，您需要在调用时返回一个对象，`table = load_tileset('tableset.gif', 16, 16)`因为除非将任何给定函数明确告知`return`对象，否则它将返回`None`，这就是该行给您带来麻烦的原因，因为`type`of`None`是`Nonetype`

这是一个函数返回`None`然后返回字符串的示例`a returned string`：

```
def thisFuncReturnsNone():
   pass

print 'what gets returned:', thisFuncReturnsNone()
>>> None

def thisFuncReturnsAString():
  return 'a returned string'

print 'what gets returned a second time:', thisFuncReturnsAString()
>>> a returned string 
```

# python - Python：简单循环程序

> ID：11659591
> 
> 赞同：0
> 
> 时间：2012-07-25T22:25:28.077
> 
> 标签：python, loops

所以我想做一个简单的循环程序，但我有一个问题：

```
def Lottery():
    Cash = 200
    YourNumber = randint(1, 10)
    while YourNumber != WinningNumber:
        Cash = Cash - 10
        if Cash < 0:
            print("You are out of money!")
            break
        YourNumber = randint(1, 10)
    else:
        Cash = Cash + 100
        Lottery() 
```

问题是，在 def 的最后一行中，“cash”会在重新启动循环时再次自动重置为 200。也许有一个非常简单的解决方案，但我已经用谷歌搜索并尝试过没有任何结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:32:51.703

同样的事情（无限循环，但如果你用完钱就会中断，没有递归调用），

```
def Lottery():
    Cash = 200
    YourNumber = randint(1,10)
    while 1:
        if YourNumber != WinningNumber:
            Cash = Cash - 10
            if Cash <= 0:
                print("You are out of money!")
                break

            YourNumber = randint(1,10)
        else:
            Cash = Cash + 100 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:28:24.617

`Cash`作为参数传递，设置默认值：

```
def Lottery(Cash = 200):
    YourNumber = randint(1,10)
    while YourNumber != WinningNumber:
        Cash = Cash - 10
        if Cash < 0:
            print("You are out of money!")
            break

        YourNumber = randint(1,10)
    else:
        Cash = Cash + 100
        Lottery(Cash) 
```

代码提示：您可以使用`+=`and`-=`作为加法/减法和赋值的快捷方式，以及其他一些更改：

```
def lottery(cash = 200):
    while randint(1, 10) != WinningNumber:
        cash -= 10

        if cash <= 0:
            print("You are out of money!")
            break
    else:
        lottery(cash + 100) 
```

# c# - 从 GAC 动态加载最新的程序集版本

> ID：11659594
> 
> 赞同：5
> 
> 时间：2012-07-25T22:26:06.060
> 
> 标签：c#, .net, gac, .net-assembly, system.reflection

我想使用反射在 GAC 中动态加载最新安装的程序集版本。

到目前为止，我已经找到了多种工作方法来实现这一点，但它们都有其特定的缺点。

最简单的解决方案是使用该[`Assembly.LoadWithPartialName()`](http://msdn.microsoft.com/en-us/library/12xc5368)方法。但这种方法自 .NET Framework 2 起就已过时：

```
var assembly = Assembly.LoadWithPartialName("Microsoft.WindowsAzure.ServiceRuntime"); 
```

另一种可能性是使用[`Assembly.Load()`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.load.aspx)（如过时警告所建议的那样）并在 try/catch 块中使用其完全限定的程序集名称调用不同的程序集版本，以获取最新的安装版本。这需要维护，看起来很脏：

```
Assembly assembly = null;

try
{
    assembly = Assembly.Load("Microsoft.WindowsAzure.ServiceRuntime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35");
}
catch (FileNotFoundException) { }

try
{
    assembly = Assembly.Load("Microsoft.WindowsAzure.ServiceRuntime, Version=1.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35");
}
catch (FileNotFoundException) { } 
```

最后但并非最不重要的一点是，我在 SO 上找到了 [另一个解决方案](https://stackoverflow.com/a/6131116/135441)[`Assembly.LoadFrom()`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.loadfrom)，使用该方法，然后基本上导入程序集管理器模块`fusion.dll`来计算最新版本的路径。对于这样一个“简单”的任务来说，这似乎太过分了。

如果不使用过时的方法、使用魔术字符串或调用非托管代码创建维护地狱，难道没有更好的解决方案来实现这一点吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T03:21:05.517

Fusion.dll ...呃。我会找到您的目标框架版本并枚举所有气体目录，然后根据根程序集名称简单地查询它们，这样您唯一的魔术字符串就是程序集名称。然后，使用 Assembly.ReflectionOnlyLoadFrom 静态方法比较版本，直到找到最新版本，然后使用带有适当文件路径参数的 Assembly.Load 方法。除非您给予应用程序适当的信任，否则使用单击一次下载可能会遇到问题。

```
// List of all the different types of GAC folders for both 32bit and 64bit
// environments.
List<string> gacFolders = new List<string>() { 
    "GAC", "GAC_32", "GAC_64", "GAC_MSIL", 
    "NativeImages_v2.0.50727_32", 
    "NativeImages_v2.0.50727_64" 
};

foreach (string folder in gacFolders)
{
    string path = Path.Combine(@"c:\windows\assembly", folder);
    if(Directory.Exists(path))
    {
        Response.Write("<hr/>" + folder + "<hr/>");

        string[] assemblyFolders = Directory.GetDirectories(path);
        foreach (string assemblyFolder in assemblyFolders)
        {
            Response.Write(assemblyFolder + "<br/>");
        }
    }
} 
```

请参阅[此处有关堆栈溢出的其他答案](https://stackoverflow.com/questions/1599575/enumerating-assemblies-in-gac)。我用它成功地枚举了 gac。

# spring - java.lang.NoSuchMethodError: org.springframework.web.portlet.context.ConfigurablePortletApplicationContext.setId(Ljava/lang/String;)V

> ID：11659596
> 
> 赞同：1
> 
> 时间：2012-07-25T22:26:10.037
> 
> 标签：spring, spring-mvc, jboss, nosuchmethoderror, jboss-portal

我试图在 jboss-portal-2.7.2 上部署我的应用程序，它给了我以下错误：

```
04:17:23,879 INFO  [DispatcherPortlet] FrameworkPortlet 'my_portlet': initialization started
04:17:23,882 ERROR [LifeCycle] Cannot start object
org.jboss.portal.portlet.container.PortletInitializationException: The portlet my_portlet threw an error during init
    at org.jboss.portal.portlet.impl.jsr168.PortletContainerImpl.start(PortletContainerImpl.java:292)
    at org.jboss.portal.portlet.impl.container.PortletContainerLifeCycle.invokeStart(PortletContainerLifeCycle.java:76)
    at org.jboss.portal.portlet.impl.container.LifeCycle.managedStart(LifeCycle.java:92)
    at org.jboss.portal.portlet.impl.container.PortletApplicationLifeCycle.startDependents(PortletApplicationLifeCycle.java:351)
...
    at org.jboss.deployment.scanner.URLDeploymentScanner.deploy(URLDeploymentScanner.java:421)
    at org.jboss.deployment.scanner.URLDeploymentScanner.scan(URLDeploymentScanner.java:610)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.doScan(AbstractDeploymentScanner.java:263)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.loop(AbstractDeploymentScanner.java:274)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.run(AbstractDeploymentScanner.java:225)
Caused by: java.lang.NoSuchMethodError: org.springframework.web.portlet.context.ConfigurablePortletApplicationContext.setId(Ljava/lang/String;)V
    at org.springframework.web.portlet.FrameworkPortlet.createPortletApplicationContext(FrameworkPortlet.java:345)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletApplicationContext(FrameworkPortlet.java:294)
    at org.springframework.web.portlet.FrameworkPortlet.initPortletBean(FrameworkPortlet.java:268)
    at org.springframework.web.portlet.GenericPortletBean.init(GenericPortletBean.java:116)
    at javax.portlet.GenericPortlet.init(GenericPortlet.java:107)
    at org.jboss.portal.portlet.impl.jsr168.PortletContainerImpl.initPortlet(PortletContainerImpl.java:417)
    at org.jboss.portal.portlet.impl.jsr168.PortletContainerImpl.start(PortletContainerImpl.java:256)
    ... 76 more 
```

有谁知道如何解决这一问题？

主控制器：

```
package myportlet.spring.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.portlet.bind.annotation.RenderMapping;
import org.apache.commons.lang.StringUtils;
import javax.portlet.PortletPreferences;
import javax.portlet.PortletRequest;
import javax.portlet.PortletSession;
import java.util.LinkedList;
import java.util.List;

@RequestMapping(value = "VIEW")
@Controller(value = "mainController")
public class MainController {

    @RenderMapping
    public String init(@RequestParam(value = "key", required = false) String key, Model model, PortletRequest request) throws Exception {
        PortletSession session = request.getPortletSession();

        /* Get Key from Portlet Preferences */
        PortletPreferences preferences = request.getPreferences();
        String preferencesKey = preferences.getValue(constants.KEY, constants.FACTORY);
        if(StringUtils.isEmpty(key)) {
            key = preferencesKey;
        }

        /* Save current KEY into session */
        session.setAttribute(constants.KEY, key, PortletSession.APPLICATION_SCOPE);

        model.addAttribute("entityList", getEntities());
        model.addAttribute("preferencesKey", preferencesKey);
        return "index";
    }
} 
```

[pom.xml](http://pastebin.com/35Efzzrc)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:54:51.337

```
Caused by: java.lang.NoSuchMethodError: org.springframework.web.portlet.context.ConfigurablePortletApplicationContext.setId(Ljava/lang/String;)V 
```

听起来您正在使用旧版本的 spring-context.jar [Spring Context API - Version 2.0.x](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/context/ConfigurableApplicationContext.html)。

尝试使用更高版本的[Spring Context API - 版本 3.0.x](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/context/ConfigurableApplicationContext.html)。

# php - 将查询放入 php 包括

> ID：11659598
> 
> 赞同：-2
> 
> 时间：2012-07-25T22:26:28.520
> 
> 标签：php, mysql

好的，所以我有一个包含一些查询的 php 包含，并且希望能够在需要时通过运行一个函数来调用它们。运行该函数时，我没有得到返回的查询。不确定我是否需要使用 return(); 在包含与否。

```
<?php
// include file with queries
function displayQueryOne(){
$q = "SELECT * FROM culturegrams.new_to WHERE edition = '$url' ORDER BY placement ASC";     
$results= mysql_query($q) or die('could not run Query '.mysql_error());
return($results);

}
?>

<?php
//PAGE # 2 page to display query results
require('queryfile.php');

//running function from the include file
$results = displayQueryOne()

//running indpendent php while loop that will generate hmtl

    while ($r = mysql_fetch_assoc($results)){

?>

    <div class="top_menu"><p class="menu_text"><?php echo $r['title'];?></p></div>
    <div class="mid_menu">      
        <p class="explore_text">
            <?php echo $r['text'];?>
        </p>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:28:16.603

是的，你需要让它像这样返回

```
function displayQueryOne(){
  $q = "SELECT * FROM culturegrams.new_to WHERE edition = '$url' ORDER BY placement ASC";     
  $results= mysql_query($q) or die('could not run Query '.mysql_error());
  return $results;
} 
```

然后你需要这样称呼它

```
$results = displayQueryOne(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:43:34.610

如果你的函数返回一个数组会更好，因为那是你真正要做的。

```
function displayQueryOne(){

$q = "SELECT * FROM culturegrams.new_to WHERE edition = '$url' ORDER BY placement ASC";     
$query = mysql_query($q) or die(mysql_error());
     if($query)
     {
        while($row = mysql_fetch_array($query))
        {
             $array[] = $row;
        }
        return $array;
     }else{ return 'Nothing';}
} 
```

# apache - RewriteCond expr "true" => 不匹配

> ID：11659601
> 
> 赞同：1
> 
> 时间：2012-07-25T22:26:32.830
> 
> 标签：apache, mod-rewrite

这是我的 mod_rewrite 配置：

```
RewriteEngine On
RewriteCond expr "true"
RewriteRule .? - [L]

RewriteRule ^(.*)$ $1 [QSA,L] 
```

这里是相关的日志输出：

```
RewriteCond: input='expr' pattern='true' => not-matched 
```

Apache文档说

> 语法：RewriteCond TestString CondPattern
> 
> 如果*TestString*具有特殊值`expr`，则*CondPattern*将被视为[ap_expr](http://httpd.apache.org/docs/current/expr.html)。
> 
> 在下面的示例中，`-strmatch`用于与`REFERER`站点主机名进行比较，以阻止不需要的盗链。
> 
> `RewriteCond expr "! %{HTTP_REFERER} -strmatch '*://%{HTTP_HOST}/*'"` `RewriteRule ^/images - [F]`

因此，如果*CondPattern*将被视为 ap_expr 并且 ap_expr 可以根据定义明确地被视为，`true`那么为什么最简单的可能的表达式适合该模式不起作用呢？确切地说，*没有*匹配的表达式对我有用。有没有人可以验证这种技术是否适用于任何人？

因为我实际上有一个非常复杂的表达式，它不能用传统的 mod_rewrite 条件完成，所以知道我是否可以使用这种方法对我来说非常重要。

编辑：

对于懒惰的人，这里直接从[这里](http://httpd.apache.org/docs/current/expr.html)复制了 ap_expr的[BNF](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)定义：

```
expr        ::= "true" | "false"
              | "!" expr
              | expr "&&" expr
              | expr "||" expr
              | "(" expr ")"
              | comp 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T17:11:43.970

你确定你使用的是 apache 2.4 吗？这些`ap_expr`东西都是 2.4 功能集的一部分而不是 2.2 的一部分的所有新功能。

# iphone - UIPageViewController 的预加载页面

> ID：11659604
> 
> 赞同：14
> 
> 时间：2012-07-25T22:26:37.637
> 
> 标签：iphone, ios, uipageviewcontroller

我找不到让 UIPageViewController 预加载周围 ViewControllers 的好的解决方案。

现在发生的事情是当用户开始翻页时，什么也没有发生，代码调用

```
- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController
       viewControllerAfterViewController:(UIViewController *)viewController 
```

并且一旦加载然后它就会显示动画。这需要太长时间并且不顺利。

有人有解决方案吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-25T22:47:15.513

创建一个可变容器，当你显示第一个视图时，创建两个 viewController，如果用户页面，一旦你有 viewController 对象询问它的​​视图（让它加载 nib 并调用控制器的“viewDidLoad” :" 方法。您需要找出一个识别 viewControlers 的系统，以便您可以检索所需的 viewController）。您可能可以在 dispatch_queue 的一个块中完成繁重的工作。

从那时起，当用户页面时，你首先在容器中查找viewController，如果没有找到，你必须实时进行。

您可能想要使用 dispatch_group 以便您可以等待待处理的块在分页之前完成。

每次用户页面时，您都会查看该页面周围的页面是否在容器中。您还可以预取更多的视图控制器——比如在显示的每个页面上两个前向两个反向。

# bash - 在 bash 脚本中使用 time 命令并重定向输出

> ID：11659608
> 
> 赞同：1
> 
> 时间：2012-07-25T22:27:05.310
> 
> 标签：bash, redirect, time

我正在尝试编写一个脚本

```
x =$ncore
numactrl -C $x ( time -p $exe ) > out.txt 2>&1 
```

在终端上（ time $ exe ）> out.txt 2>&1 按我的意愿工作（out.txt 包含时间和可执行文件的输出）

我使用的是红帽 6.2，时间不是 GNU 版本（我假设 -a -o 选项不起作用）

我希望 out.txt 有可执行文件的输出，最后有 time 命令的输出。

bash 脚本给我带来了问题 ( 所以我使用 ( time -p $exe )，现在 numactl 看到 ( 作为可执行文件。

有没有办法一起使用 numactl 和 time 命令并获得我想要的输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:04:18.870

如果`numactrl`想要一个命令，但你想使用一些 shell 功能，只需给它 shell 作为命令：

```
numactrl -C $x bash -c "( time -p $exe ) > out.txt 2>&1" 
```

当您`time -p $exe`从 bash 提示符或在 中运行时`bash -c`，您使用的是 bash 内置版本的 time。带有`-o`选项的是外部命令，因此要从 bash 中使用它，您必须指定`command time`or`/bin/time`或`/usr/bin/time`。

如果你运行，`numactrl -C $x time ...`那么它可能会运行外部命令，所以`-o`在这种情况下应该可以工作，但如果不是，那么你总是有`bash -c`方法。

请注意，不同版本的输出格式不同`time`。GNU coreutils 版本比 bash 内置版本打印更多信息。

# python - GUI 编程 Pyqt

> ID：11659609
> 
> 赞同：0
> 
> 时间：2012-07-25T22:27:05.837
> 
> 标签：python, qt, pyqt, pyqt4

我之前使用 Pyqt 制作了一个 gui。我在 Linux 的终端上完成了所有的编码。现在我要在 Pyqt 中做一个大项目。
是否有任何 sdk 可以帮助我克服编码部分，所以我可以拖放项目？我知道 qt 设计器，但我不知道我应该如何编写它并将其与 Python 集成。

您对为此使用什么程序有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T05:36:10.813

Qt Designer 与 PyQt4 结合时通常仅用于布局过程，而不是定义信号、伙伴等。您执行小部件的可视化布局，并保存`.ui`文件。

使用`pyuic4`，您可以编译`.ui`-> `.py`，并将其导入您的编码项目。

尽管此时使用 UI 可能有 3 种不同的方法，但我通常做的是多重继承。如果类`MyMainWindow`是 QMainWindow，那么我从 QMainWindow 和 UI 类继承我的类。

像这样的东西...

```
pyuic4 myMainWindow.ui -o myMainWindowUI.py 
```

**主文件**

```
from PyQt4 import QtGui
from myMainWindowUI import Ui_MainWindow

class MyMainWindow(QtGui.QMainWindow, Ui_MainWindow):

    def __init__(self, *args, **kwargs)
        super(MyMainWindow, self).__init__(*args, **kwargs)
        self.setupUi(self) 
```

该`setupUi`方法将您的整个 UI 设计应用于该类，您现在可以通过对象名称访问您设计的所有小部件。

```
win = MyMainWindow()
print win.listWidget
print win.button1
win.show() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:04:28.490

请参阅[使用设计器直观地创建界面](http://www.harshj.com/2010/04/18/pyqt-creating-interfaces-visually-with-designer/)

如果使用 pyqt4 使用`pyuic4`

如果使用 pyside 使用`pyside-uic`

这些将 QTDesigner 的输出编译成 python 文件。

您可以通过 Google 搜索来使用这些命令行工具，但[Riverbank](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/designer.html)通常是一个很好的参考

# advantage-database-server - 仅备份和恢复 Advantage 数据库中的某些表

> ID：11659614
> 
> 赞同：2
> 
> 时间：2012-07-25T22:27:27.153
> 
> 标签：advantage-database-server

在 Advantage 中进行备份时，我们只想备份一些包含一些结构数据的表。这些表可能会在数据库更新中发生变化，但大多数表不会。其他表包含大量的 blob 数据：可能是 10 多个演出。

如果数据库更新出现问题，并且我们想要恢复备份的表，我们有什么选择来保留原始的大表，但恢复选定的表？将它们还原到现有数据库，保留旧的大表？释放大表并将它们添加到新恢复的数据库中？

（注意：备份表和大表之间没有 RI 规则，但大表确实引用了备份表中的 autoincs。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T18:43:42.400

您可以使用包含列表来限制备份或恢复的表。例如，如果您使用 adsbackup.exe 命令行实用程序，您可以将备份限制为两个表：

```
adsbackup -i"table1,table2" test.add c:\mypath\backup\ 
```

然后通过还原，您还可以将其限制为特定文件：

```
adsbackup -r -i"table1,table2" c:\mypath\backup\test.add c:\mypath\restore\test.add 
```

请注意，当使用包含列表指定恢复操作时，仅当字典 (.add) 文件不存在时才会恢复它。因此，如果您使用包含列表还原到现有字典，它只会复制指定的表。

# jquery - JQuery Ajax .load 快速加载内容

> ID：11659615
> 
> 赞同：1
> 
> 时间：2012-07-25T22:27:30.773
> 
> 标签：jquery

我有一个由按钮单击触发的 Ajax 函数，如下所示：

```
$.ajax({
            type: "POST",
            dataType: 'json',
            url: "DBDeleteList.php",
            data: {listID: listID},
            success: refreshMenus($(this))
}); 
```

PHP 文件成功执行并更新数据库。

refreshMenus() 被调用，我调用 .load() 来重新刷新菜单以反映更新的数据库，但是加载函数似乎很快就会加载内容（在数据库更新注册之前）。

基本上发生的情况是，如果当我通过 Jquery .load 从页面加载内容时，它不会刷新。如果我手动刷新页面（例如 f5），数据库会更新并正确显示菜单。

这是刷新菜单（）：

```
 function refreshMenus( list ) {
    list.parents('li').remove();
    $('#sortableLoader').load(window.location.href + ' #sortableMenu');
 } 
```

Div ID sortableMenu 正在更新，我想它只是更新得太早了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:32:07.460

`refreshMenus($(this));`在 ajax 完成之前立即调用您并保存`$(this)`在 ajax 函数之外的变量中。所以试试这个

```
var el = $(this);
$.ajax({
    type: "POST",
    dataType: 'json',
    url: "DBDeleteList.php",
    data: { listID: listID }
    success: function(){ 
        refreshMenus(el);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:31:16.303

我认为你应该使用

```
success:function(){ refreshMenus($(this)); } 
```

如果我是正确的，实际发生的是 $.ajax 将*结果*作为`refreshMenus($(this))`其回调函数（如果您查看控制台，它甚至可能会引发错误）。这意味着它`refreshMenus($(this))`实际上是*在 AJAX 启动之前*调用的。此外，您需要使用 jQuery`context`或按照提到的其他一些答案进行操作，并将`$(this)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:31:34.227

使用完整的处理程序（总是）而不是成功（完成），并在必要时添加超时，但它不应该是因为服务器端应该在调用回调时完成：

```
var elem = $(this);
$.ajax({
       type: "POST",
       dataType: 'json',
       url: "DBDeleteList.php",
       data: { listID: listID }    
  }).always(function() {
       setTimeout(function() {
          refreshMenus(elem); //`this` will be out of scope
       }, 300); //or whatever you need    
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T22:33:37.430

尝试更改`refreshMenus($(this))`为`refreshMenus($('#listid'))`（当然，为您要刷新的列表使用正确的访问器:)

您遇到的问题是`$(this)`您传递给`refreshMenus`的元素不是您要更新的列表元素（或触发按钮，就此而言），它是 xhr（ajax）对象，所以 refreshMenus 方法不是获取它需要更新的元素。

另外，Cabloo 说的是好建议——

```
success:function(){ refreshMenus($('#listid')); } 
```

# android - 从 Android 中的 BroadcastReceiver 访问应用程序域逻辑的首选方法是什么？

> ID：11659616
> 
> 赞同：0
> 
> 时间：2012-07-25T22:27:41.153
> 
> 标签：android, singleton

我有一个 Android 应用程序，它使用 AlarmManager 来安排事件。当收到来自 AlarmManager 的 Intent 时，域逻辑必须做一些工作，包括访问数据库和广播意图。目前我使用单例从广播接收器（在清单中注册）以某种方式访问​​域逻辑：

```
public class AlarmReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        Singleton.getInstance().onAlarmFired();
    }
} 
```

这个 Singleton 以相同的方式用于活动和服务中。它工作得很好，但是 Singleton 被认为是一种反模式，我想用测试来覆盖代码，所以我正在寻找一个不同的解决方案。

现在的问题是使用 Service 而不是这个 Singleton 不是更好吗？像这样：

```
public class AlarmReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        startService(new Intent(intent.getAction());
    }
} 
```

有什么好处和坏处？从 Activity 与服务进行通信的最佳方式是什么？我正在考虑绑定到 MyApplication 中的服务，并使用 getApplication() 方法提供对活动和服务的引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:38:47.170

> 现在的问题是使用 Service 而不是这个 Singleton 不是更好吗？

是的，非常如此。涉及到的主要指令`BroadcastReceiver.onReceive()`是响应在方法中花费尽可能少的时间，因为该执行是在主线程上完成的，如果`BroadcastReceiver`它存活超过 10 秒，它很快就会成为死亡的候选者（[参见文档更多](http://developer.android.com/reference/android/content/BroadcastReceiver.html#onReceive%28android.content.Context,%20android.content.Intent%29)）。

相反，调用 a`Service`来完成工作是一个完美的替代实现，并且可以`onReceive()`很快返回。

根据您`Service`的操作，您可以将其绑定`Activity`到调用方法，或者只是继续使用`Intents`来来回发送数据（您可能需要查看`LocalBroadcastManager`支持库中的后一种情况）。

> 我正在考虑绑定到 MyApplication 中的服务并使用 getApplication() 方法提供对活动和服务的引用

我强烈反对这一点。在许多情况下，我会考虑使用`Application`该类也是一种反模式。关注它的生命周期并不比创建的 Singleton 更容易。相反，如果要绑定`Service`以使用它，请将其绑定到`Activity`当前处于前台时想要访问的任何对象。

**编辑：**关于系统服务的问题

系统服务和应用服务有很大不同；系统服务甚至根本不是服务（在 SDK 对这个词的定义中）。它们是在`system_server`进程内部运行的单例对象，它们在其中受到保护，不会被中断，并与您可以使用 AIDL 和 IPC 访问的管理器对象对话。

您的应用程序中的 Singleton 没有同样的奢侈。如果您的应用程序崩溃，Android 将无法帮助您重新启动对象。但更重要的是，由于它不是已注册的系统组件，如果您在后台执行代码，Android 将不会识别您的应用程序正在执行有效的后台工作，如果您的应用程序不是，您将更有可能成为低内存杀死的目标在前台。

因此，虽然在技术上使用 Singleton 是可行的，但将您的代码移动到传统的代码`Service`中被认为是最佳实践，并且将使您从平台本身中获得最大的收益。

# customization - alt+backspace 删除vim中的单词

> ID：11659618
> 
> 赞同：12
> 
> 时间：2012-07-25T22:27:54.900
> 
> 标签：customization, vim

如何重新映射`alt+backspace`以删除原生 *NIX 文本操作之类的单词？我检查了这个线程：[Using alt+backspace key in vim command line to delete by words](https://stackoverflow.com/questions/6039405/using-altbackspace-key-in-vim-command-line-to-delete-by-words)

像这样的例子：`cmap <a-bs> <c-w>`并且`:imap <A-BS> <C-W>`不做任何事情。并且接受的答案实际上是甚至不重新映射它，而是使用`ctrl+w`. 由于 VIM`alt+backspace`没有做任何事情，我宁愿将它重新映射到我习惯的东西。

我正在使用基于终端的 VIM（特别是在 iTerm 中）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T08:35:33.253

Alt/Meta 键在 Vim 和大多数终端中都有问题，请参阅[我的这个答案](https://stackoverflow.com/a/8224269/546861)以了解情况概述（情况与`Meta`和相同`Alt`）。

简而言之，Vim 根本不接收`Alt`：hit和 hit`Alt+Backspace`完全一样`Backspace`。

无论如何，从长远来看，学习和习惯 Vim 的默认键映射对你来说会更好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-11-30T15:01:09.927

在带有 iTerm2 的 macOS 上，我将选项键映射到 +Esc （像许多人一样），我发现按`Option`+`Backspace`实际上被 vim 解释为`Escape`按然后`Backspace`按，所以以下绑定对我来说非常有效；即使您的配置与我的不同，我也建议您尝试一下，以防万一它适合您！

```
:imap <Esc><BS> <C-w> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-23T15:01:12.717

如果您在 OSX 上，[macvim](https://code.google.com/p/macvim/)使用标准键绑定，因此按下`Alt+Backspace`将删除整个单词。`Alt+RightArrow`使用和在单词之间导航也是如此`Alt+LeftArrow`。

# ruby-on-rails-3.1 - Rails 应用程序仅指向默认的 Rails 索引页面

> ID：11659628
> 
> 赞同：0
> 
> 时间：2012-07-25T22:28:35.800
> 
> 标签：ruby-on-rails-3.1, nginx, capistrano, unicorn, ubuntu-12.04

所以我是部署到 Ubuntu 服务器（12.04）的新手。我安装了 nginx 和 unicorn。一切似乎都在工作，除了我不知道如何将它指向我的应用程序。目前我指向“home/administrator/apps/my_site/current/public”，但是我所有的文件都在“home/administrator/apps/my_site/app/views/”中。我目前只指向静态文件，例如错误 htmls 和默认的 rails index.html。如何让 nginx 指向我的视图/应用程序？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T07:48:40.863

如果您使用的是 Nginx + Unicorn，那么您不要将 Nginx 指向任何路径，而是在服务器上运行 unicorn，然后让 Nginx 代理它对 unicorn 实例的所有请求。我建议查看使用工头，然后它`foreman export upstart`会导出用于控制独角兽的 ubuntu upstart 脚本。

[此](http://sleekd.com/general/configuring-nginx-and-unicorn/)链接为您提供有关如何配置 nginx 站点的详细信息。

# python - Python：读取和写入 CSV 文件

> ID：11659630
> 
> 赞同：1
> 
> 时间：2012-07-25T22:28:41.807
> 
> 标签：python, csv

我正在尝试从 CSV 文件 (A) 中读取数据，提取数据，然后将其写入不同的 CSV 文件 (B)。在新文件 B 中，我想要两列。第 1 列列出文件 A 中第 1 列的名称，第 2 列列出文件 A 中第 1 列的计数。例如，如果文件 A 看起来像这样，没有 ':' （它们排成两列）：

```
Animal: Gender
Rabbit: Male
Dog: Male
Rabbit: Female
Cat: Male
Cat: Male
Dog: Female
Dog: Male
Turtle: Male 
```

我希望文件 B 中的输出看起来像这样（实际上在不同的列中再次没有'：'）：

```
Animal: Count
Cat: 2
Dog: 3
Rabbit: 2
Turtle: 1 
```

这是我第一次做这样的事情，这就是我到目前为止所做的事情，但是我未能在文件 B 中打印出数据并正确完成“计数”。有人可以帮我吗？

```
import csv
ReadData=csv.reader(open('C:\Users\..\FileA.csv','rb'), delimiter=',')

def column(ReadData, i):
    return [row[i] for row in ReadData]

for line in ReadData:
   WriteData=csv.writer(open('C:\Users\..\FileB.csv','wb'),
                        delimiter=' ', quotechar=':', quoting=csv.QUOTE_ALL)
   print column(ReadData,1) 
```

提前谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:51:44.433

要在 Python >=2.7 中进行计数，请参阅[此示例以获取`collections.Counter`](https://stackoverflow.com/a/3496860/1307866). 带一个`collections.defaultdict`，看[这里](https://stackoverflow.com/a/2161791/1307866)。

在您对 的调用中`csv.writer`，这`quotechar=':'`可能是一个错误（这会使`WriteData.writerow(['Hello World', 12345]`）发出“:Hello World: 12345”，就好像冒号是引号一样。

另请注意，您的功能`column(ReadData, i)`消耗`ReadData`; 随后对 ReadData 的调用可能会返回一个空列表（未经测试）。这对您的代码来说不是问题（至少现在不是）。

这是一个没有 CSV 模块的解决方案（毕竟这些文件看起来不太像 CSV）：

```
import collections

inputfile = file("A")

counts = collections.Counter()

for line in inputfile:
    animal = line.split(':')[0]
    counts[animal] += 1

for animal, count in counts.iteritems():
    print '%s: %s' % (animal, count) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:50:06.793

我会回答你问题的计数部分，也许你可以将它与你问题的 csv 部分结合起来。

```
l = [
    ('Animal','Gender'),
    ('Rabbit','Male'),
    ('Dog','Male'),
    ('Rabbit','Female'),
    ('Cat','Male'),
    ('Cat','Male'),
    ('Dog','Female'),
    ('Dog','Male'),
    ('Turtle','Male')
    ]

d = {}
for k,v in l:
    if not k in d:
        d[k] = 1
    else:
        d[k] += 1

for k in d:
    print "%s: %d" % (k,d[k]) 
```

我没有过滤你的标题行，这段代码的输出是：

```
Turtle: 1
Cat: 2
Rabbit: 2
Animal: 1
Dog: 3 
```

**编辑**：

你可以替换这个：

```
if not k in d:
    d[k] = 1
else:
    d[k] += 1 
```

有了这个：

```
d[k] = d.setdefault(k,0) + 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:57:06.270

看看[itertools](http://docs.python.org/library/itertools.html)模块和[groupby](http://docs.python.org/library/itertools.html#itertools.groupby)函数。例如：

```
from itertools import groupby

animals = [
    ('Rabbit', 'Male'),
    ('Dog', 'Male'),
    ('Rabbit', 'Female'),
    ('Cat', 'Male'),
    ('Cat', 'Male'),
    ('Dog', 'Female'),
    ('Dog', 'Male'),
    ('Turtle', 'Male')
    ]

def get_group_key(animal_data):
    return animal_data[0]

animals = sorted(animals, key=get_group_key)
animal_groups = groupby(animals, get_group_key)

grouped_animals = []
for animal_type in animal_groups:
    grouped_animals.append((animal_type[0], len(list(animal_type[1]))))

print grouped_animals

>>> [('Cat', 2), ('Dog', 3), ('Rabbit', 2), ('Turtle', 1)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T23:10:44.800

根据数据的大小和复杂性......您可能需要考虑使用[http://pandas.pydata.org/](http://pandas.pydata.org/)`pandas`上的 - info并在 PyPi 上可用。

但是请注意，这可能是过度杀戮，但我想我会把它混在一起。

```
from pandas import DataFrame

# rows is processed from string in the OP
rows = [['Rabbit', ' Male'], ['Dog', ' Male'], ['Rabbit', ' Female'], ['Cat', ' Male'], ['Cat', ' Male'], ['Dog', ' Female'], ['Dog', ' Male'], ['Turtle', ' Male']]

df = pandas.DataFrame(rows, columns=['animal', 'gender'])

>>> df.groupby('animal').agg(len)
        gender
animal        
Cat          2
Dog          3
Rabbit       2
Turtle       1

>>> df.groupby(['animal', 'gender']).agg(len)
animal  gender 
Cat      Male      2
Dog      Female    1
         Male      2
Rabbit   Female    1
         Male      1
Turtle   Male      1 
```

# vba - Visio VBA EMF 透明度

> ID：11659633
> 
> 赞同：0
> 
> 时间：2012-07-25T22:29:19.490
> 
> 标签：vba, visio

在 Visio VBA 中，可以设置形状的透明度，包括光栅图像。但是，导入的 EMF 形状不会响应其他形状所做的不同填充、线条或图像透明度单元格更改。

是否可以对导入的 EMF 图像形状应用透明度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:38:59.687

您可以取消组合 EMF 形状和取消组合操作后创建的各个形状中的设置值。

# javascript - 强制网络浏览器下载整个页面内容

> ID：11659638
> 
> 赞同：1
> 
> 时间：2012-07-25T22:29:39.690
> 
> 标签：javascript, jquery, caching, browser

我在整个网络都可以访问的服务器驱动器上有一个大的网页文件（大约 10mb）。不是每个人都会在打开它之前将其复制到他们的本地计算机上，这会使其速度更快。由于不是每个人都会这样做，我必须找出如何将网页的全部内容预加载到他们的浏览器中。目前它只下载活动块（可见块），并在需要时请求其他部分，因为它们是从 jquery 隐藏和显示中请求的。不过，这需要的时间太长了。我该怎么做才能让网络浏览器在显示之前获取整个页面？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:32:05.307

添加此元标记：

```
<meta http-equiv="Content-type" content="application/octet-stream" /> 
```

# c# - 在数据表c#中将行移到顶部

> ID：11659640
> 
> 赞同：0
> 
> 时间：2012-07-25T22:29:59.587
> 
> 标签：c#, asp.net

我有一个数据表，如果地址匹配，则将其中一行移动到数据表的顶部。我正在使用以下代码，但它不起作用。任何想法如何实现这一点。数据表中的数据是从 excel 文件中导入的。我已经尝试在 GridView 中使用相同的 if 语句来突出显示重复项并且有效，但我也想将它们移到顶部，因为数据有 1000 多行，并且很难一次又一次地上下移动以检查突出显示的内容排。

```
for (int row = 1; row < dtf1.Rows.Count; row++)
{
    for (int rowinner = 1; rowinner < dtf1.Rows.Count; rowinner++)
    {
        if (rowinner != row)
        {
            if (dtf1.Rows[row][addresscolno] == dtf1.Rows[rowinner][addresscolno].ToString())
            {
                DataRow newrow = dtf1.Rows[row];
                dtf1.Rows.RemoveAt(row);
                dtf1.AcceptChanges();
                dtf1.Rows.InsertAt(newrow, 1);
                dtf1.AcceptChanges();
                GridView1.DataSource = dtf1;
                GridView1.DataBind();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:38:19.173

所以你想重新排序`DataTable`. 具有给定地址的行应位于顶部。您可以使用`Linq-To-DataSet`对行进行排序并使用新顺序`CopyToDataTable`创建新`DataTable`的：

```
// assuming the address is a string in a variable address, to simplify matters
DataTable tblOrdered = dtf1.AsEnumerable()
    .OrderByDescending(r => r.Field<string>("addresscolno") == address)
    .ThenBy(r => r.Field<string>("addresscolno"))
    .CopyToDataTable(); 
```

然后，您可以将其用作 GridView 的数据源。

**编辑**：也[`DataTable.Rows.InsertAt`](http://msdn.microsoft.com/en-US/library/system.data.datarowcollection.insertat%28v=vs.100%29)试一试。

```
dtf1.Rows.InsertAt(dtf1.Rows[rowinner], 0); 
```

# javascript - 使用 jQuery 在 div 中选择一个主体

> ID：11659648
> 
> 赞同：1
> 
> 时间：2012-07-25T22:30:54.387
> 
> 标签：javascript, jquery, html

我有一个嵌套在 div 内某处的元素（例如，一个主体）。类似于：

```
<div class=wrapper>
..
..
<body>
</body>
</div> 
```

我将如何使用 jQuery 选择正文？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:31:54.310

> 正如其他人所说 - 这看起来不像有效的 HTML - 我将假设您只是将其作为示例，因为该技术可用于查找**任何**类型的元素。

这应该可以找到身体标签 -

```
$('div.wrapper').find('body') 
```

当您没有在选择器中指定您正在谈论类`.`或 id`#`属性时 - 整个字符串将与元素的类型匹配。

可以为 -

*   `<img>`标签——
    `$('div.wrapper').find('img')`
*   `<a>`标签——
    `$('div.wrapper').find('a')`
*   `<span>`标签——
    `$('div.wrapper').find('span')`
*   ETC...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:34:44.707

首先，您的 HTML 标记已关闭。

```
<body>
    <div class="wrapper">
        <div class="body">
            ..
            ..
        </div>
    </div>
</body> 
```

选择它`$('div.wrapper div.body')`

感谢 ClarkeyBoy 指出我的错误，修复了我的帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:32:42.063

它看起来不像是有效的 HTML，但试试这个：

```
$('div.wrapper body') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T22:33:31.190

当然，在 div 中包含 body 标记的 HTML 是不正确的吗？除非它在 ​​iframe 内？

但是，您可以使用它来选择正文标签...

```
jQuery("div.wrapper body").whatever(); 
```

# hadoop - 输出收集器 hadoop 中的空指针异常

> ID：11659650
> 
> 赞同：0
> 
> 时间：2012-07-25T22:31:02.873
> 
> 标签：hadoop, mapreduce

我在 reduce 类的 close 方法中有输出收集器。输出收集器的格式是`<Text, Text>`

我将 Text name_txt 作为键传递，将 Text val 作为值传递。

我发现 Text name_txt 和 Text val 通过打印它们都不为空，但是当我在输出中设置时，我在 output.collect(name_str, val); 处得到空指针异常；

为了清楚起见，我附上了下面的代码。请帮忙！

```
private OutputCollector<Text, Text> output;

public void close() throws IOException {          
  for(int i = 0; i<arraylist.size(); i++)
  {
    String name = arraylist.get(i).getToken();
    Text name_txt = new Text(name);
    System.out.println("name_txt: "+name_txt);
    Text val = new Text("hi");
    output.collect(name_txt, val);         
  }         
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T01:37:55.127

你在哪里设置输出的值？

我看到您使用的是旧 API（mapred），因此您没有设置方法的奢侈。相反，您可能必须在 map 方法中添加条件：

```
void map(K1 key, V1 value, OutputCollector<K2, V2> output, Reporter reporter)
  throws IOException {
  if (this.output == null) {
    this.output = output;
  }

  // your current map implementation goes here..
} 
```

# jboss7.x - ExceptionInInitializerError - JBoss 7.0.2

> ID：11659655
> 
> 赞同：1
> 
> 时间：2012-07-25T22:31:34.927
> 
> 标签：jboss7.x

最近，我们从 BO XI 3.1 迁移到 BO 4.0 和 JBoss 7.0.2 应用服务器。我目前收到以下异常：

```
14:53:44,256 ERROR [stderr] (Thread-25) Exception in thread "Thread-25" java.lang.ExceptionInInitializerError
14:53:44,256 ERROR [stderr] (Thread-25)         at com.businessobjects.bcm.BCM.<clinit>(BCM.java:1144)
14:53:44,271 ERROR [stderr] (Thread-25)         at com.crystaldecisions.enterprise.ocaframework.BCMInitializer.run(BCMInitializer.java:29)
14:53:44,271 ERROR [stderr] (Thread-25)         at java.lang.Thread.run(Thread.java:619)
14:53:44,271 ERROR [stderr] (Thread-25) Caused by: java.lang.SecurityException: Toolkit not encapsulated by a jar.
14:53:44,271 ERROR [stderr] (Thread-25)         at com.rsa.cryptoj.f.ug.d(Unknown Source)
14:53:44,271 ERROR [stderr] (Thread-25)         at com.rsa.cryptoj.f.ug.b(Unknown Source)
14:53:44,271 ERROR [stderr] (Thread-25)         at com.rsa.cryptoj.f.nd.b(Unknown Source)
14:53:44,271 ERROR [stderr] (Thread-25)         at com.rsa.cryptoj.f.nd.c(Unknown Source)
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1) 25 Jul 2012 14:53:44,271 TANL ERROR [http--0.0.0.0-7005-1] meta.AnalyticsMetaDataServiceImpl: Failed to connect to provider server: Could not initialize class com.businessobjects.bcm.BCM
14:53:44,271 ERROR [stderr] (Thread-25)         at com.rsa.jsafe.CryptoJ.isFIPS140Compliant(Unknown Source)
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1) java.lang.NoClassDefFoundError: Could not initialize class com.businessobjects.bcm.BCM
14:53:44,271 ERROR [stderr] (Thread-25)         at com.businessobjects.bcm.internal.BcmRsaLib.initialize(BcmRsaLib.java:214)
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1)      at com.crystaldecisions.sdk.framework.internal.TrustedPrincipal.getRandomString(TrustedPrincipal.java:253)
14:53:44,271 ERROR [stderr] (Thread-25)         at com.businessobjects.bcm.internal.BcmRsaLib.<clinit>(BcmRsaLib.java:289)
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1)      at com.crystaldecisions.sdk.framework.internal.TrustedPrincipal.getPassword(TrustedPrincipal.java:196)
14:53:44,271 ERROR [stderr] (Thread-25)         ... 3 more
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1)      at com.crystaldecisions.sdk.framework.internal.SessionMgr.logon_aroundBody22(SessionMgr.java:853)
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1)      at com.crystaldecisions.sdk.framework.internal.SessionMgr.logon(SessionMgr.java:1)
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1)      at com.crystaldecisions.sdk.framework.internal.SessionMgr.logon_aroundBody20(SessionMgr.java:821)
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1)      at com.crystaldecisions.sdk.framework.internal.SessionMgr.logon_aroundBody21$advice(SessionMgr.java:512)
14:53:44,271 INFO  [stdout] (http--0.0.0.0-7005-1)      at com.crystaldecisions.sdk.framework.internal.SessionMgr.logon(SessionMgr.java:1) 
```

这似乎是由于 JBoss 7.0.2 中类重载方法的变化。谁能提供我们如何在 JBoss 7.0.2 中实现类重载优先级？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T19:26:33.260

该错误是从 RSA 库中引发的。我可以通过使用 dswsbobje.war（BO 4.0 中的 Web 应用程序之一）作为示例向您展示如何解决此问题。以下是步骤：

1.  创建一个名为 com.rsa 的模块。[请参阅此链接](https://skydrive.live.com/redir?resid=A319CD0B6CD6903F!512&authkey=!AHHq8EzgUq9NWIU)中的模块示例 rsa_module.zip 。
2.  在 \modules\com 下创建一个 rsa\main 目录
3.  解压缩 rsa_module.zip 并将文件放在 \modules\com\rsa\main 下
4.  获取分解的 dswsbobje 并从 dswsbobje 中删除与 RSA 相关的 jar（其中 3 个）（它们是您在上述步骤中放入 ...\rsa\main 的那些）
5.  创建一个 jboss-deployment-structure.xml 文件（从步骤 1 中的链接获取此文件）并将其放在 dswsbobje 的 WEB-INF 目录下。
6.  重新创建 dswsbobje.war
7.  部署更新的战争文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-21T13:38:55.633

有一个更简单的解决方案。只需使用以下参数运行 JBoss： `-Djboss.vfs.forceCaseSensitive=true -Djboss.vfs.forceVfsJar=true`

# javascript - jquery转义html标签

> ID：11659656
> 
> 赞同：0
> 
> 时间：2012-07-25T22:31:47.867
> 
> 标签：javascript, jquery

真是一个简单的问题。我尝试使用 jquery 插入 html 表格行。我的行之一具有下标的值。所以我的问题是正确的方法是什么？以下是我损坏的代码：

```
$('<td><input type="text" size="5" name="a" value="<sub>b</sub>" id="id_a"/></td>').appendTo('.leslie tr:last') 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:35:27.887

`<input>`值不支持 HTML 标记。
这是完全不可能的。

你可以`contentEditable`改用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-25T22:37:24.543

试试这个：

```
$('.leslie tr:last').html($('.leslie tr:last').html()+'<td><input type="text" size="5" name="a" id="id_a"/><sub>b</sub></td>') 
```

# wso2 - 向 wso2 身份服务器发送请求

> ID：11659661
> 
> 赞同：0
> 
> 时间：2012-07-25T22:31:58.633
> 
> 标签：wso2, identity, wso2is

我正在尝试向身份服务器发送请求，但不知道该怎么做。我知道身份服务器可以通过在身份服务器内为您生成请求来帮助您测试您的策略，但我不知道如何在身份服务器之外执行此操作。所以我的问题是如何向身份服务器发送请求，以便让它根据策略检查请求并向我返回结果。我已经尝试了[http://hasini-gunasinghe.blogspot.com/2011/12/entitlement-service-xacml-pdp-as-web.html](http://hasini-gunasinghe.blogspot.com/2011/12/entitlement-service-xacml-pdp-as-web.html)上的博客，但它不起作用。谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T06:20:13.907

我尝试了博客文章中的代码，并且可以使用 localhost 中的 WSO2 Identity Server 4.1.0 的以下设置使其工作。不要忘记为 wso2carbon.jks 提供正确的路径。

```
import org.apache.axis2.AxisFault;
import org.apache.axis2.client.Options;
import org.apache.axis2.client.ServiceClient;
import org.apache.axis2.context.ConfigurationContext;
import org.apache.axis2.context.ConfigurationContextFactory;
import org.apache.axis2.transport.http.HTTPConstants;
import org.wso2.carbon.authenticator.stub.AuthenticationAdminStub;
import org.wso2.carbon.identity.entitlement.stub.EntitlementServiceStub;
import org.wso2.carbon.identity.entitlement.ui.client.EntitlementServiceClient;

public class EntitlementClient {

private static String serverUrl = "https://localhost:9443/services/";

private AuthenticationAdminStub authstub = null;
private static ConfigurationContext ctx;
private static String authCookie = null;
private static EntitlementServiceClient entitlementServiceClient;
private static EntitlementServiceStub stub;
//sample XACML request captured from TryIt tool of IdentityServer.  
private static String sampleRequest = "<Request xmlns=\"urn:oasis:names:tc:xacml:2.0:context:schema:os\"\n" +
        "         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n" +
        "    <Resource>\n" +
        "        <Attribute AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\"\n" +
        "                   DataType=\"http://www.w3.org/2001/XMLSchema#string\">\n" +
        "            <AttributeValue>ABCResource</AttributeValue>\n" +
        "        </Attribute>\n" +
        "    </Resource>\n" +
        "    <Subject>\n" +
        "        <Attribute AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\"\n" +
        "                   DataType=\"http://www.w3.org/2001/XMLSchema#string\">\n" +
        "            <AttributeValue>admin</AttributeValue>\n" +
        "        </Attribute>\n" +
        "        <Attribute AttributeId=\"http://wso2.org/claims/role\"\n" +
        "                   DataType=\"http://www.w3.org/2001/XMLSchema#string\">\n" +
        "            <AttributeValue>admin</AttributeValue>\n" +
        "        </Attribute>\n" +
        "    </Subject>\n" +
        "    <Action>\n" +
        "        <Attribute AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\"\n" +
        "                   DataType=\"http://www.w3.org/2001/XMLSchema#string\">\n" +
        "            <AttributeValue>read</AttributeValue>\n" +
        "        </Attribute>\n" +
        "    </Action>\n" +
        "    <Environment/>\n" +
        "</Request>";

public static void main(String[] args) {

    try {

        //set trust store properties required in SSL communication.
        System.setProperty("javax.net.ssl.trustStore",
                "/home/pushpalanka/Servers/wso2is-4.1.1/repository/resources/security/wso2carbon.jks");
        System.setProperty("javax.net.ssl.trustStorePassword", "wso2carbon");

        //initialize authentication admin stub
        EntitlementClient remoteEntitlementClient = new EntitlementClient();
        //login using authentication admin stub providing valid credentials
        remoteEntitlementClient.login("admin", "admin");
        //initialize entitlement service stub with obtained authentication cookie
        remoteEntitlementClient.initEntitlementClient();
        //invoke EntitlementService by passing the XACML request and obtain the authorization decision
        String decision = entitlementServiceClient.getDecision(sampleRequest);
        //print the authorization decision
        System.out.println(decision);

    } catch (Exception e) {
        e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
    }

}

public EntitlementClient() {
    try {
        ctx = ConfigurationContextFactory.createConfigurationContextFromFileSystem(null, null);
        String authEPR = serverUrl + "AuthenticationAdmin";
        authstub = new AuthenticationAdminStub(ctx, authEPR);
        ServiceClient client = authstub._getServiceClient();
        Options options = client.getOptions();
        options.setManageSession(true);
        options.setProperty(org.apache.axis2.transport.http.HTTPConstants.COOKIE_STRING, authCookie);
    } catch (AxisFault axisFault) {
        axisFault.printStackTrace();
    }
}

public String login(String username, String password) throws Exception {
    //String cookie = null;
    boolean loggedIn = authstub.login(username, password, "127.0.0.1");
    if (loggedIn) {
        System.out.println("The user " + username + " logged in successfully.");
        authCookie = (String) authstub._getServiceClient().getServiceContext().getProperty(
                HTTPConstants.COOKIE_STRING);
    } else {
        System.out.println("Error logging in " + username);
    }
    return authCookie;
}

public void initEntitlementClient() throws AxisFault {
    entitlementServiceClient = new EntitlementServiceClient(authCookie, serverUrl, ctx);
} 
```

}

参考 - [http://hasini-gunasinghe.blogspot.com/2011/12/entitlement-service-xacml-pdp-as-web.html](http://hasini-gunasinghe.blogspot.com/2011/12/entitlement-service-xacml-pdp-as-web.html)

# git - 使用 git-svn 推送到 subversion repo 时如何保留 git 作者身份和提交日期？

> ID：11659669
> 
> 赞同：4
> 
> 时间：2012-07-25T22:32:52.063
> 
> 标签：git, svn, git-svn, revision-history

我们从一个新的、空的 subversion 存储库和一个现有的 git 存储库开始，我想“推送”并保留所有历史记录和作者身份（如果可能的话，甚至只是用户名）。

使用“git svn dcommit”，我可以在 subversion repo 的历史记录中看到修订评论，但作者详细信息默认为我在 subversion 中的用户名，提交日期变为*今天*的日期，即推送日期，而不是 git 中的初始提交。

是否有方法可以像 BZR->SVN 一样覆盖这些感兴趣的属性，使用 bazaar.conf 覆盖和修改 pre-revprop-change 钩子，但这次是 Git？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T00:37:26.677

你不能使用 git-svn 保留作者和日期（你也不能保留忽略、匿名分支和使用它的复杂历史）。

为了将 Git 存储库转换为 SVN，保留所有使用[SubGit](http://subgit.com)项目：

```
$ svnadmin create svn.repo

$ subgit configure svn.repo

$ #edit svn.repo/conf/subgit.conf ('git.default.repository' option) 
to set path to your bare Git repository (the repository you on the server
or you can prepare new bare repository
with "git clone --bare <Git URL> path/to/bare/git/repo")

$ #optionally prepare svn.repo/conf/authors.txt file
to configure custom authors mapping

$ subgit install 
```

安装后 SubGit 会同步 SVN 仓库 svn.repo 和 Git 仓库 path/to/bare/git/repo 并保持同步，这样任何对 SVN 的提交都会导致 Git 提交，反之亦然（同步由钩子驱动，并发-safe，所以你仍然可以继续使用 Git）。

停止连续同步运行

```
$ subgit uninstall svn.repo 
```

# sql - SQL WHERE 子句需要是动态的

> ID：11659671
> 
> 赞同：1
> 
> 时间：2012-07-25T22:33:07.677
> 
> 标签：sql, tsql, where-clause

我正在研究一个存储过程来获取一个案例的帐户。如果`@accounts`参数是`NULL`，我想获取该案例的所有帐户。如果`@accounts`是`NOT NULL`，那么它将是一个逗号分隔的 accountid 字符串。我想要一个可以处理这个问题的 where 子句。如果说的话，那`@accounts`就是`NULL`抓住这个案子的所有账户。否则，使用`@accounts`参数并获取具有指定帐户 ID 的帐户。我想避免一个大语句，它要求我使用 2 个不同的子句`IF`进行两次查询。`WHERE`

```
DECLARE @caseId BIGINT,
    DECLARE @accounts VARCHAR(255)

    SELECT TOP 1 @userId = userId FROM TblTraceCur t
    WHERE caseId = @caseid
    ORDER BY processDate DESC

    SELECT    
              .... (select logic) ...
    WHERE     
              t.caseId = @caseID AND 
              t.userId = @userId AND
              t.shortStock = 0 AND
              ... (where I need the new logic) ...
    order by t.tracln ASC 
```

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:52:44.747

这对我有用。添加`(@accounts IS NULL OR @accounts LIKE ('%,' + CAST(t.caseId AS VARCHAR(255)) + ',%'))`您在帖子中指定的位置。当然，您必须确保@accounts 中的第一个字符和最后一个字符是逗号才能正常工作，但我认为这是最简单的。没有逗号会错误地返回 ID，例如：@accounts = 12 将返回 ID 1、2 和 12。使用逗号并确保它们是第一个和最后一个字符可以防止这种情况发生。

# javascript - html5文件上传器将相同的文件内容上传到服务器

> ID：11659673
> 
> 赞同：1
> 
> 时间：2012-07-25T22:33:11.173
> 
> 标签：javascript, filereader

我使用这个脚本[http://code.google.com/p/html5uploader/](http://code.google.com/p/html5uploader/)来显示文件上传的进度等。它工作得很好，除了那一刻如果你同时拖放几个文件，它会创建具有不同名称的文件，但是这些文件的内容将是相同的。因此，该脚本在所有情况下都只传递第一个加载文件的内容。如何解决这个问题？

# c++ - 如何在特定字符串之后读取一行的其余部分

> ID：11659675
> 
> 赞同：-2
> 
> 时间：2012-07-25T22:33:14.100
> 
> 标签：c++, string

请告诉我如何编写一个检查文件中每一行的函数，如果遇到某个字符串（例如“set cookie”），它将输出该行的其余部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:36:48.740

您可能想使用`strstr`. 首先，逐行读取变量（使用`cin.getline`），然后使用 . 检查给定的行[`strstr`](http://www.cplusplus.com/reference/clibrary/cstring/strstr/)。如果输出`strstr`is **not** `NULL`，则按照您认为合适的方式处理该行。

# install4j - install4j 可以忽略以前重新安装/升级默认目录的安装吗？

> ID：11659676
> 
> 赞同：1
> 
> 时间：2012-07-25T22:33:16.260
> 
> 标签：install4j

如何让我的 install4j 安装程序始终建议默认安装，而不是尝试使用以前的安装目录。

我将我的目录添加到媒体并在**安装位置屏幕上检查了****建议应用程序目录**，但我仍然遇到不良行为。

 **想要的行为：

*   用户安装 C:\Program Files\My App 1.0.0\
*   使用为 2.0 运行安装程序并提示 C:\Program Files\My App 2.0.0\

当前行为：

*   用户安装 C:\Program Files\My App 1.0.0\
*   使用为 2.0 运行安装程序并提示 C:\Program Files\My App **1.0.0** \

谢谢您的帮助

彼得

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T10:36:11.527

在安装程序->更新选项上，取消选中“检测以前的安装目录”复选框。**

# php - 在 PHP 中使用调度表

> ID：11659677
> 
> 赞同：0
> 
> 时间：2012-07-25T22:33:22.430
> 
> 标签：php, arrays, json

我有这段代码，一个示例是`$dispatch='TC_12'`：

```
foreach($this->dispatch as $dispatch){
   $data['$dispatch'] = $this->genericQuery($dispatch, '1');
} 
```

`$this->dispatch`是一个**调度表**数组。但是，我编写了`genericQuery()`生成动态生成查询的方法。一切正常，除了当我分析`JSON`返回的对象时，我看到：

```
`"$dispatch":["Hello world"]}` 
```

不过我想看看`"TC_12":["Hello world"]`。我怎样才能得到那个结果？我以为字符串会在`$data['$dispatch']`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:37:32.967

变量仅在双引号字符串中被替换。美元符号被视为单引号字符串中的文字。（请参阅[http://www.php.net/manual/en/language.types.string.php](http://www.php.net/manual/en/language.types.string.php)。）但是，在这种情况下，根本不需要引号。尝试这个：

```
foreach($this->dispatch as $dispatch){
   $data[$dispatch] = $this->genericQuery($dispatch, '1');
} 
```

# c# - 如何实现无限集类？

> ID：11659678
> 
> 赞同：12
> 
> 时间：2012-07-25T22:33:22.420
> 
> 标签：c#, set, set-theory

我正在为离散数学设计一个类库，但我想不出一种方法来实现[无限集](http://en.wikipedia.org/wiki/Infinite_set)。

到目前为止我所拥有的是：我有一个抽象基类 Set，它实现了 ISet 接口。对于有限集，我派生了一个类 FiniteSet，它实现了每个集合方法。然后我可以像这样使用它：

```
FiniteSet<int> set1 = new FiniteSet<int>(1, 2, 3);
FiniteSet<int> set2 = new FiniteSet<int>(3, 4, 5);
Console.WriteLine(set1); //{1, 2, 3}
Console.WriteLine(set2); //{3, 4, 5}

set1.UnionWith(set2);
Console.WriteLine(set1); //{1, 2, 3, 4, 5} 
```

现在我想代表一个无限集。我的想法是从集合 InfiniteSet 派生另一个抽象类，然后使用该库的开发人员必须从 InfiniteSet 派生来实现自己的类。我会提供常用的集合，例如 N、Z、Q 和 R。

但我不知道如何实现像 Subset 和 GetEnumerator 这样的方法——我什至开始认为这是不可能的。您如何以实用的方式枚举一个无限集，以便您可以将它与另一个无限集相交/联合？如何在代码中检查 N 是 R 的子集？至于基数问题。嗯，这可能是一个单独的问题。

所有这一切使我得出结论，我实现无限集的想法可能是错误的方法。我非常感谢您的意见:)。

编辑：为了清楚起见，我还想代表不可数的无限集。

Edit2：我认为重要的是要记住最终目标是实现 ISet，这意味着任何解决方案都必须提供（应该）实现所有[ISet 方法的方法](http://msdn.microsoft.com/en-us/library/dd412081.aspx)，其中最有问题的是枚举方法和 IsSubsetOf 方法.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-25T23:16:50.387

`ISet<T>`对于不可数的无限集，不可能完全实现。

这是一个证明（由 Bertrand Russell 提供）：

假设您创建了一个`MySet<T>`可以表示不可数无限集的类。现在让我们考虑一些`MySet<object>`对象。

`MySet<object>`如果出现以下情况，我们将其标记为`instance`“*异常*”：

`instance.Contains(instance)`返回真。

同样，如果出现以下情况，我们将标记`instance`为“*正常*”：

`instance.Contains(instance)`返回假。

请注意，这种区别对所有`instance`.

`MySet<MySet<object>>`现在考虑一个被调用的实例`paradox`。

我们将 定义`paradox`为`MySet<MySet<object>>`包含所有可能的*正常*实例`MySet<object>`。

应该`paradox.Contains(paradox)`返回什么？

如果它返回`true`，那么`paradox`是*异常*的，并且应该`false`在调用自身时返回。

如果它返回`false`然后`paradox`是*正常*的，并且应该`true`在调用自身时返回。

没有办法`Contains`解决这个悖论，所以没有办法完全实现`ISet<T>`所有可能的不可数集。

* * *

现在，如果您将 的基数限制`MySet<T>`为等于或小于连续统的基数 (|R|)，那么您将能够绕过这个悖论。

即使那样，您也将无法实现`Contains`或类似的方法，因为这样做相当于解决停机问题。（请记住，所有`C#`程序的集合的基数等于 |Z| < |R|。）

**编辑**

更彻底地说，这里是对我的断言的解释，即“这样做就等于解决停机问题”。

考虑`MySet<string>`由在有限时间内停止的所有 C# 程序（作为字符串）组成的（假设它们为任何输入而停止，准确地说）。调用它`paradox2`。该集合是 *recursively enumerable”，这意味着您可以`GetEnumerator`在其上实现（不容易，但它是可能的）。这也意味着它是明确定义的。但是，该集合不是“可确定的”，因为它的补码不是递归可枚举的.

定义一个 C# 程序，如下所示：

```
using ... //Everything;

public static class Decider {

    private MySet<string> _haltingSet = CreateHaltingSet();

    static void Main(string [] args) {
        Console.WriteLine(_haltingSet.Contains(args[0]));
    }
} 
```

编译上述程序，并将其作为输入传递给自身。怎么了？

如果您的`Contains`方法得到正确实施，那么您已经解决了停机问题。但是，我们知道这是不可能的，所以我们只能得出结论`Contains`，**即使对于可数无限集，也无法正确实现 。**

您也许可以限制您的`MySet<T>`班级适用于所有[可判定的集合。](http://en.wikipedia.org/wiki/Recursive_set) 但是，您仍然会遇到各种问题，因为您的功能*永远不会*在有限的时间内停止。

作为一个例子，假设我们有一个名为 的任意精度实数类型`Real`，让我们`nonHalting`成为它的一个实例，`MySet<Real>`它包括黎曼 Zeta 函数的所有非平凡零点（这是一个可判定的集合）。如果您可以正确实现`IsProperSubsetOf`on`nonHalting`在有限时间内返回实部为 1/2 的所有复数的集合（也是可判定的集合），那么您将赢得[千年奖。](http://en.wikipedia.org/wiki/Riemann_hypothesis)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T23:19:40.650

**表示不可数的无限集**

让我们在实践中如何完成这个声明。例如，当询问天气时，集合 A 是集合 Z（正整数）的子集，主题不是 Z。不分析 Z 中的每个数字。分析的是所讨论的集合 A。因为无法将 Ak（A sub k，其中 k 是 1 和 |A| 之间的数字）与 Z 的每个值（无限）进行比较，所以 A 的每个值都必须是与构成 Z 的属性相比。如果 A 中的每个值都满足 Z 的属性，则 A 是 Z 的子集。

**你怎么能在代码 R union N 中表示**

与上述相同的过程。R 的属性是“任何实数” - 在代码中这可能是“任何不引发异常的双精度数”（显然`Math.Pow(-1,.5)`会产生问题，因此不在 R 中）。N 的属性是“任何整数”——在代码中，它可以是 Math.Floor != Math.Ceiling 的任何数字。这两者的结合就是它们属性的结合。任何符合 R 或 N 属性的数字 - 在代码中，这将是任何不会引发异常以创建**或**Math.Floor != Math.Ceiling 的数字。

**概括**

要表示不可数的无限集，请使用它们的属性而不是它们的值。

* * *

*编辑*

**N ⊆ R ?**

让我们回到属性的想法，因为这是我要追求的主题。N是R的子集吗？如果 N 是 R 的子集，那么 N 的属性必须满足 R 的*所有*属性。属性列表需要准确。为了表示无穷大的数值，我建议使用一个包含可空 int 数和普通 int 符号的类。

```
public class Infinite
{
 public int? Number { get; set; }
 public int Sign { get; set; }
} 
```

类似的东西。Number.Value == null 意味着无限。符号可用于显示负数 (-1)、+- (0) 或正数 (1)。

回到 R 的 N 个子集的情况。除了前面列出的属性之外，N 还具有 Infinite.Number == null 和 Infinite.Sign == 0 作为其属性的界限。与 R 一样。因此，N 将能够满足边界属性。接下来是上面定义的属性。我真的被困在这里了。我不确定如何在代码中证明 .Floor == .Ceiling 的每个数字都不会导致异常。但是，由于这些类型的超集只有 9 种（有理、无理、整数、实数、复数、虚数、先验、代数、自然），您可以专门定义它们在无限尺度上的相互作用，然后使用更简单的有限实现比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T22:43:32.813

您将不得不概括您所说的 Set 的含义。

如果您将拥有一个无限集，您将无法获得有意义的枚举，因此您不会使用枚举操作来定义集合操作。

如果根据方法定义 a `Set<f>`，`bool IsMember(f obj)`它可以用于无限集。

您将两个集合的并集或交集定义为两个集合的 IsMember 方法的逻辑与或或。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T23:00:26.810

你到底打算用它做什么。你无法枚举它。

我想我把它当作通用集的后代。

我想我会从另一端开始

定义一个 Ismember 始终为 true 的通用集 如果 IsMember 是自然数 {1,2,3,4} 的表示，则其后代为 true 是 N 的进一步限制

反正一个想法

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T00:36:59.783

有很多限制是可能的，就像符号表达式处理一样。

这是一个小例子：

```
class IntSet
{
    int m_first;
    int m_delta;

    public IntSet(int first, int delta)
    {
        m_first = first;
        m_delta = delta;
    }

    public override string ToString()
    {
        StringBuilder sb = new StringBuilder();

        sb.Append('[');
        sb.Append(m_first);
        sb.Append(',');
        sb.Append(m_first + m_delta);
        sb.Append(',');
        sb.Append("...");
        sb.Append(']');

        return sb.ToString();
    }

    public IEnumerable<int> GetNumbers()
    {
        yield return m_first;

        int next = m_first;

        while (true)
        {
            next += m_delta;

            yield return next;
        }
    }
} 
```

# java - 使用优先队列计算中位数

> ID：11659690
> 
> 赞同：0
> 
> 时间：2012-07-25T22:33:59.847
> 
> 标签：java, collections

我正在为 coursera 相关课程做这个作业，并且是 Java、DS 和 Algo 的新手。我不会在这里粘贴我的整个代码。但下面是我在相关代码中面临的问题。

因此，要检索我正在使用的中位数`PriorityQueue`和`Comparator`接口。从下面的函数中，我尝试制作两个`PriorityQueue`s，例如对于 21 个元素，`hLow`优先级队列有 11 个最小的元素，而`hHigh`有 10 个最高的元素。

```
public static void addToStream (int k) {
    hLow.add (k);
    if (hLow.size() > (hHigh.size() + 1)) {
        hHigh.add(hLow.poll());
    }
} 
```

我写的比较器功能`hLow`是

```
hLComp = new Comparator <Integer> () {
        public int compare (Integer o1, Integer o2) {
            return o1.compareTo(o2);
        }   
    }; 
```

而对于`hHigh`是

```
hHComp = new Comparator <Integer> () {
        public int compare (Integer o1, Integer o2) {
            return -o1.compareTo(o2);
        }   
    }; 
```

我面临的问题是

```
hHigh.add(hLow.poll()) 
```

检索错误的值。例如，如果第一个值是 3000，那么这就是中位数，但是当第二个值出现时，例如是 6000。然后代码进入 if 条件，然后`hHigh.peek`显示 3000 并`hLow.peek`显示 6000。这与我的相反预计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T10:30:35.903

这是一个完整的班级，其中有一个寻找中位数的例子。

```
public class Median {

    static PriorityQueue<Integer> hHigh  = new PriorityQueue<Integer>(100, 
            new Comparator<Integer>() {
        public int compare (Integer o1, Integer o2) {
            return o1.compareTo(o2);
        }
    });

    static PriorityQueue<Integer> hLow  = new PriorityQueue<Integer>(100, 
            new Comparator<Integer>() {
        public int compare (Integer o1, Integer o2) {
            return -o1.compareTo(o2);
        }
    });

    public static void addToStream (int k) {
        if (hHigh.size() == 0 || k > hHigh.peek()){
            hHigh.add(k);
        }

        else {
            hLow.add(k);
        }

        if (hLow.size() > (hHigh.size() + 1)) {
            hHigh.add(hLow.poll());
        }
        if (hHigh.size() > hLow.size()){
            hLow.add(hHigh.poll()); 
        }
    }

    public static void main(String[] args) {
        addToStream(3104);
        addToStream(6185);
        addToStream(7818);
        addToStream(2106);
        addToStream(5480);
        System.out.println(hLow.peek());
    }
} 
```

该程序打印出：5480

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T07:47:05.667

上面的方法是有问题的。试试 5 4 3 你会看到的。该算法需要基本情况​​。这里解释得很好：

[从整数流中查找运行中位数](https://stackoverflow.com/questions/10657503/find-running-median-from-a-stream-of-integers)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:57:32.030

每个队列中的值将按照您实现比较器的方式进行排序。您实现的方式是添加功能，您只需在 hLow 中放置一个，而不是在 hHigh 中放置一个。

如果要将较大的一半保留在一个队列中，而将另一半保留在第二个队列中，则需要比较每个队列头部的值。根据结果​​，您可能需要在队列之间进行交换，就像您输入的数字一样。

试试这个添加功能：

首先，您需要将 hLow 比较器分配给 hHigh，反之亦然。然后在添加值后 hLow.peek() 给你中位数。

```
public static void addToStream (int k) {
    if (hHigh.size() == 0 || k > hHigh.peek()){
        hHigh.add(k);
    }

    else {
        hLow.add(k);
    }

    if (hLow.size() > (hHigh.size() + 1)) {
        hHigh.add(hLow.poll());
    }
    if (hHigh.size() > hLow.size(){
        hLow.add(hHigh.poll()); 
    }
} 
```

# javascript - Ember.Select contentBinding 在使用路由器的应用程序中

> ID：11659707
> 
> 赞同：2
> 
> 时间：2012-07-25T22:35:35.220
> 
> 标签：javascript, ember.js, ember-old-router

我有一个使用[Ember.Router 结构](http://emberjs.com/guides/outlets/)的 Ember.js 应用程序。

我的应用程序结构看起来像

```
window.App = Ember.Application.create {
    #Truncated idea of app, not including application controller or any of that
    MainController = Ember.Controller.extend()
    MainView = Ember.View.extend
        templateName: 'main-template' 
```

因此控制器和视图是*扩展*的，而不是*在*应用程序创建时创建的。然后有连接出口的路线

```
Router: Ember.Router.extend
    root: Ember.Route.extend
        main: Ember.Route.extned
            route: '/'
            connectOutlets: (router, event) ->
                router.get('applicationController').connectOutlet('main') 
```

我需要将`<select>`标签绑定到一组值。`Ember.Select`看起来是一个很好的方法，所以我为选择添加了一个控制器和视图扩展

```
MySelectController: Ember.ArrayController.extend
    contents: [{id:1,title:'test'},{id:2,title:'test2'}]
MySelectView: Ember.Select.extend
    contentBinding: this.get('controller')
    contentValuePath: 'id'
    contentLabelPath: 'title' 
```

这行不通。`this.get('controller')`当我尝试包含在视图中时，我收到一个错误`{{#view App.MySelectView}}`

我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T23:05:20.367

这是我将如何实现的示例：[jsfiddle](http://jsfiddle.net/Sly7/ZySzK/)

**车把模板：**

```
<script type="text/x-handlebars" data-template-name="application">
  <header>
    <h1>Ember Router Sample</h1>
  </header>
  {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="myForm">
  {{view view.mySelectView 
    selectionBinding="controller.selected" 
    contentBinding="view.controller.content.persons"
  }}
  {{view Ember.TextField valueBinding="controller.selected.name"}}
</script> 
```

**javascript:**

```
App = Ember.Application.create();

App.ApplicationController = Em.Controller.extend();
App.ApplicationView = Em.View.extend({
  templateName: 'application'
});

App.MySelectController = Em.ArrayController.extend();

App.MyFormController = Em.Controller.extend({
  selected: null,
});

App.MyFormView = Ember.View.extend({
  templateName: 'myForm',
  mySelectView: Em.Select.extend({
    optionLabelPath: 'content.name',
    optionValuePath: 'content.id'
  })
});

App.Router = Em.Router.extend({

  root: Em.Route.extend({

    index: Em.Route.extend({
      route: '/',
      connectOutlets: function(router, context) {
        router.get('applicationController').connectOutlet({
          name: 'myForm',
          context: Ember.Object.create({
              persons: [{id:0, name: "Wayne"}, {id: 1, name: "Gart"}]
          })
        });
      }
    })
  })
});
App.initialize(); 
```

​</p>

# matlab - RFC 4648 (Base[16,32,64]) 在 Matlab 中的实现

> ID：11659710
> 
> 赞同：2
> 
> 时间：2012-07-25T22:36:05.463
> 
> 标签：matlab, encoding, base64

Matlab中是否有[RFC4648](https://tools.ietf.org/html/rfc4648)（“Base16、Base32 和 Base64 数据编码”）的任何实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:47:59.553

在 MATLAB 中，您可以轻松使用嵌入式[Java 功能](http://www.mathworks.com/help/techdoc/matlab_external/f44062.html)。MATLAB 附带 Java 类路径上可用的[Apache Commons Codec](http://commons.apache.org/codec/)库。所以你可以这样做：

```
str = 'http://stackoverflow.com/q/11659710/';
encoder = org.apache.commons.codec.binary.Base64();
result = char(encoder.encode(str-0))'; 
```

输出：

```
>> result
result =
aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3EvMTE2NTk3MTAv 
```

# github - 可以自动提交/推送到 github 吗？

> ID：11659713
> 
> 赞同：6
> 
> 时间：2012-07-25T22:36:19.393
> 
> 标签：github, jekyll

我已将网站移至 Jekyll / GitHub Pages 设置，并拥有一个基于 iOS 的降价编辑器，可同步到 Dropbox。目前我正在研究弥合差距的方法，并让在旅途中创建的文件自动提交并推送到 GitHub 存储库，但不确定从哪里开始。这样的事情可能吗？

（我没有在 OSX 上使用 Automator 的经验，但似乎它可能是一种选择，尽管我不能保证机器会一直处于唤醒状态）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-13T07:37:49.067

使用 cron 应该可以解决问题。请注意，您需要为 git 设置基于密钥的身份验证，以便在推送时不会提示您输入密码。

（请注意，我在 Linux 中使用过这些工具，但它们应该也可以在 OS X 中使用。）

在某处创建脚本

```
#!/bin/sh
cd /path/to/git/repo
git commit -a -m "Automated commit message." # commit all changes
git push 
```

使脚本可执行
chmod + x script.sh

运行`crontab -e`以编辑您的 cron 文件，并添加`0 * * * * /path/to/script.sh`以每小时执行一次脚本。

这也假设这将是*唯一的提交*者。如果其他人从其他地方推送到 repo，您​​必须将这些更改合并到此克隆中，然后此脚本才能再次成功推送。

你也可以看看[Flashbake](http://boingboing.net/2009/02/13/flashbake-free-versi.html)！

# weka - 为 Weka 构建兼容的数据集以处理大型、不断发展的数据

> ID：11659715
> 
> 赞同：1
> 
> 时间：2012-07-25T22:36:28.520
> 
> 标签：weka

我有一个较大的数据集，我正在使用 Weka 进行探索。它是这样的：今天我将尽可能多地分析数据，并创建一个训练有素的分类器。我将此模型保存为文件。那么明天我将获取一批新数据，并想使用保存的模型来预测新数据的类别。这每天都在重复。最终我会更新保存的模型，但现在假设它是静态的。

由于这个任务的大小和频率，我想自动运行它，这意味着命令行或类似的。但是，我的问题也存在于资源管理器中。

我的问题与这样一个事实有关，即随着我的数据集的增长，属性的可能标签列表也会增长。Weka 说这样的属性列表不能改变，或者说训练集和测试集不兼容（见：[http ://weka.wikispaces.com/Why+do+I+get+the+error+message+%27training+and +test+set+are+not+compatible%27%3F](http://weka.wikispaces.com/Why+do+I+get+the+error+message+%27training+and+test+set+are+not+compatible%27%3F) )。但在我的世界里，我今天不可能知道下周我会偶然发现的所有属性标签。

为了纠正这种情况，建议我运行批量过滤（[http://weka.wikispaces.com/How+do+I+generate+compatible+train+and+test+sets+that+get+processed+with+ a+过滤器%3F](http://weka.wikispaces.com/How+do+I+generate+compatible+train+and+test+sets+that+get+processed+with+a+filter%3F) )。好的，这似乎意味着我需要每天使用重新过滤的训练数据重新构建我的模型。

在这一点上，整个事情似乎很困难，我担心我犯了一个可怕的、简单的新手错误，所以我寻求帮助。

细节：

该模型由

```
java -Xmx1280M weka.classifiers.meta.FilteredClassifier ^
    -t .\training.arff -d .\my.model -c 15 ^
    -F "weka.filters.supervised.attribute.Discretize -R first-last" ^
    -W weka.classifiers.trees.J48 -- -C 0.25 -M 2 
```

天真地，预测我会尝试：

```
java -Xmx1280M weka.core.converters.DatabaseLoader ^
    -url jdbc:odbc:(database) ^
    -user (user) ^
    -password (password) ^
    -Q "exec (my_stored_procedure) '1/1/2012', '1/2/2012' " ^
    \> .\NextDay.arff 
```

接着：

```
java -Xmx1280M weka.classifiers.trees.J48 ^
    -T .\NextDay.arff ^ 
    -l .\my.model ^ 
    -c 15 ^
    -p 0 ^ 
    \> .\MyPredictions.txt 
```

这产生：

```
java.lang.Exception: training and test set are not compatible
at weka.classifiers.Evaluation.evaluateModel(Evaluation.java:1035)
at weka.classifiers.Classifier.runClassifier(Classifier.java:312)
at weka.classifiers.trees.J48.main(J48.java:948) 
```

在 kdkeys.net/training-and-test-set-are-not-compatible-weka/ 上询问了一个相关问题

一个相关的问题是数据库提取的命令行版本需要生成一个临时的 .arff 文件，而 JDBC 生成的 arff 文件似乎不能正确处理“日期”数据。我的数据库生成 ISO-8601 格式“yyyy-MM-dd'T'HH:mm:ss”的日期，但资源管理器和从 JDBC 数据生成的 .arff 文件都将它们表示为 NOMINAL 类型。因此，标题中日期属性的标签列表非常非常长，并且从数据集到数据集永远不会相同。

我不是 java 或 python 程序员，但如果需要的话，我会去买一些书！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:00:23.993

看来你的计划也有更大的问题。如果您有第 1 天的数据并使用它来构建模型，那么您将它用于第 n 天的具有新的且从未见过的类标签的数据，因为没有训练数据，所以无法预测新标签为他们。同样，如果您有新属性，则无法将其用于分类，因为您的训练数据中没有一个将它们与类标签相关联。

因此，如果您想使用仅包含新数据属性/类的子集的数据训练模型，那么您不妨过滤新数据以删除新类/属性，因为即使您不会使用它们可以在两个不同的数据集上执行 weka 而不会出错。

如果它不在您的训练集中，请将其从测试集中排除。然后一切都应该工作。如果您需要能够对其进行测试/预测，那么您需要重新训练具有新类/属性示例的新模型。

在您的环境中执行此操作可能需要手动将数据库中的数据查询到 arff 文件中，以便仅查询训练集中的属性/类。研究 sql 和任何主要的脚本语言（例如 perl、python）来做到这一点，而不用大惊小怪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T09:23:31.833

我认为您可以使用增量分类器。但只有少数分类器可以支持此选项。与 SMO 一样，J48 分类器不支持这一点。因此，您将使用其他一些分类器进行分类。

要了解更多请访问

[http://weka.wikispaces.com/Classifying+large+datasets](http://weka.wikispaces.com/Classifying+large+datasets)

[http://wiki.pentaho.com/display/DATAMINING/Handling+Large+Data+Sets+with+Weka](http://wiki.pentaho.com/display/DATAMINING/Handling+Large+Data+Sets+with+Weka)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-24T11:26:37.480

维护 Weka 的大学还创建了 MOA（大规模在线分析）来分析和解决您的问题。他们所有的分类器都是可更新的，您可以比较分类器在一段时间内的数据流性能。它还允许您检测模型的变化（概念漂移/偏移）并随着时间的推移优化（即限制）您的数据窗口（忘记旧的数据机制......）。

一旦你完成了 MOA 的测试和调整，你就可以使用 Weka 的 MOA 分类器（有一个扩展来启用它）并批处理你的所有过程。

# c++ - 参考类c ++中的动态多维数组

> ID：11659718
> 
> 赞同：0
> 
> 时间：2012-07-25T22:36:43.443
> 
> 标签：c++, .net, arrays, c++-cli

如果有人告诉我应该如何在 ref 类中声明一个动态多维数组，我将不胜感激？有人可以发布示例代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:44:41.077

如果您负担得起数组重新分配，请使用该`array`类型。

您可以使用“数组数组”构造

```
/// Declaration
array<array<SomeType>^>^ arr;

/// Inititalization

arr = gcnew array<array<SomeType>^> (NumElts1);

for(int i=0 ; i < NumElts1 ; i++)
{
  arr[i] = gcnew array<SomeType> (NumElts2);
} 
```

或者只是多维的：

```
array<SomeType, NumDims> ^ Arr =
        gcnew array<SomeType, NumDims>(NumElts1, NumElts2, ....); 
```

一切都是垃圾收集的，因此您不必担心会破坏它们。

如果您真的需要“动态”数组，那么您可能会寻找`System.Collections.Generic.List<T>`并使用“列表列表”。列表具有 ToArray() 方法。

编辑：

C++/CLI 中的`array`类型是一个模板：

```
template<typename T, int NumDims = 1>
ref class array: System::Array
{
    // black magic here
} 
```

所以你可以将它用于没有第二个参数的一维数组。

```
array<SomeType>^ Arr = gcnew array<SomeType>(SizeOfThisArray); 
```

# node.js - Node.js 配置错误：没有可接受的 C 编译器

> ID：11659721
> 
> 赞同：10
> 
> 时间：2012-07-25T22:36:53.983
> 
> 标签：node.js

我正在通过 SSH 尝试安装和使用 node.js 在 hostgator linux 服务器上工作。我按照[github.com/joyent/node/wiki/Installation](https://github.com/joyent/node/wiki/Installation)上的说明进行操作，特别是本节。

> tar -zxf node-v0.6.18.tar.gz #从 nodejs.org 下载
> 
> cd节点-v0.6.18
> 
> 。/配置
> 
> 制作
> 
> 须藤使安装

当我输入 ./configure 时，我收到此错误。

> Node.js 配置错误：找不到可接受的 C 编译器！
> 
> 请确保您的系统上安装了 C 编译器和/或如果您将其安装在非标准前缀中，请考虑调整 CC 环境变量。

# jquery - jquery中$.each函数中形成Json数组

> ID：11659722
> 
> 赞同：0
> 
> 时间：2012-07-25T22:36:56.443
> 
> 标签：jquery, json

我需要创建一个数组，该数组需要在 jquery 每个函数中具有自定义索引和值。例如。我需要创建一个这样的数组 [4: 'sampleIndex1','test':'sampleIndex2'];

但是在使用每个函数时，jquery 需要 '4' 索引将是数组的第 4 个索引，剩余索引 0、1、2、3 会将值设置为空。我不需要数组中的 0 1 2 3 索引。非常感谢即时帮助！！！

提前致谢，

下面是示例代码，我需要为选择选项创建 div 元素。

```
<select name="question" id="myselect">
                            <option value="sample1">What is your father's name?</option>
                            <option value="sample2">What is your pets's name?</option>
                            <option value="sample3">What is your school's name?</option>
                        </select> 

$("#myselect").changeselect({width:400}); 
$.fn.changeselect=function(options){
    var defaults = {  
            width: 600 
    };      
    var options = $.extend(defaults, options); 
    var createhtml="";
var selectarr=new Array();
    $("option",this).each(function(k,v){
selectarr[$(this).attr('value')] = $(this).html();  
            createhtml +="<div id='"+k+"'>"+$(this).html()+"</div>";
    });
console.log(selectarr);
$(this).after(createhtml);

}; 
```

它显示 [] 空数组 它需要是这样的 [{"sample1":"What is your dad's name?", "sample2":"What is your pets's name?", "sample3":"What is your school's name ?"}]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:36:13.847

您正在寻找一个 javascript 对象。

```
(function () {

  var obj = new Object();

  $('#myselect option').each(function (index, option) {

    var option$ = $(option);

    $('<div/>').attr('id', option$.attr('value')).text(option$.html()).appendTo(/**/);

    obj[option$.attr('value')] = option$.html()

  });

  console.log(obj);

}).call(this) 
```

这是一个例子：http: [//jsbin.com/irohow/6/edit](http://jsbin.com/irohow/6/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:39:15.913

这不是一个有效的 javascript 数组。我认为您想要更多类似的东西：

```
[{4: 'sampleIndex1'}, {'test':'sampleIndex2'}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:39:35.753

你不能在一个数组中有字符串键 - 你应该为此使用一个对象 -

```
var a = new Object();
a['4'] = "Some Value";
a['5'] = "Another Value"; 
```

这会给你 -

```
{"4":"Some Value","5":"Another Value"} 
```

# visual-studio-2010 - 如何使用 Visual Studio 组织具有相同基本解决方案的多个站点？

> ID：11659727
> 
> 赞同：2
> 
> 时间：2012-07-25T22:37:32.493
> 
> 标签：visual-studio-2010, projects-and-solutions

我有一个用于多个网站的 MVC3 项目的 C#.Net 解决方案。站点之间的唯一区别是 Web.config 中的一些标识符数据和两个图像。

我不想在每次创建新站点时都制作基本解决方案项目的完整副本。

处理这种情况的一些首选方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:48:07.907

如果您想继续*开发一个*网站并多次*部署它*，我建议您只为该项目提供一个解决方案。要更新*web.config*和图像，您可以在 MSBuild 或您喜欢的任何内容中编写构建脚本。该脚本将执行以下操作：

*   XML-poking 以更新 web.config 的值
*   更新图像

这在类似和更复杂的情况下对我有用。

# php - php时间戳UTC

> ID：11659732
> 
> 赞同：3
> 
> 时间：2012-07-25T22:38:13.603
> 
> 标签：php, mysql, datetime, timestamp

我有一个 PHP MySQL 查询，它将一些数据插入到 MySQL 数据库中，它包含一个时间戳。

当前`INSERT`查询`NOW()`用于时间戳列，并以以下格式保存在数据库中：`2012-07-24 13:13:02`

不幸的是，服务器不在我的时区，它被列为 America/Los_Angeles，如图所示`print date_default_timezone_get();`

我希望做到以下几点：

```
date_default_timezone_set('Europe/London');
$timefordbLondonEU = date('Y-m-d H:i:s', time()); 
```

并简单地将;保存到数据库`$timefordbLondonEU`中`NOW()`

这是保存此类数据的好方法吗？

非常感谢，

理查德

**[添加文字]**

我将 MySQL 数据库中的类型更改为`DateTime`并执行了以下操作：

```
date_default_timezone_set('Europe/London');
$timefordbLondonEU = date('Y-m-d H:i:s', time()); 
```

它正在工作，但我仍然没有得到整体概念。

```
Assumptions based on your comments: 
```

1.  MySQL = 没有数据类型 UTC，您只需使用 INT 类型。
2.  Unix_TimeStamp() 会保存当前时间还是计数？UTC 格式，例如 1343247227。
3.  由于 UTC 是从一个常见的 0 点开始计算的，因此您可以从中获取任何时区。假设您不想要 1970 年参考 0 点之前的日期。

我的猜测和你所说的引导是最好的方法是将时间保存为 INT（1343247227）中的 UTC，然后从那里生成你想要的任何时区。再次假设您不需要在 1970 年参考 0 点之前存储日期。

同样，为什么不在已知时区存储为日期时间 YYYY-MM-DD HH:MM:SS，然后转换为 UTC 或其他时区。这一切似乎都很混乱=（

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-25T22:45:55.420

正如@Petah 在评论中所说，将您的时间存储在 UTC 中，并根据需要将它们隐藏在应用程序中。

Unix 时间戳采用 UTC，所以我通常将我的时间作为时间戳存储在数据库中。这避免了在选择时首先转换为 UTC 以插入，然后从 UTC 转换的头痛和困惑。

也就是说，将你的时间字段设为一个`INT`类型，并`UNIX_TIMESTAMP()`在插入时使用 MySQL 中的函数，或者使用该函数从 PHP 中获取时间戳[`time()`](http://php.net/time)。

当您从数据库中获取时间戳时，它将采用 UTC，但是当您使用 将其显示在 PHP 应用程序中`date()`时，它将显示在服务器时区或您设置的任何时间`date_default_timezone_set`。

因此，以下两个查询将起作用：

```
INSERT INTO `table` (id, time) VALUES(NULL, UNIX_TIMESTAMP());

// or

$time = time();

$query = "INSERT INTO `table` (id, time) VALUES(NULL, $time); 
```

如果你想从数据库中选择它作为一个`DATETIME`，你可以这样做：

```
SELECT *, FROM_UNIXTIME(time) as dt FROM `table` WHERE 1 
```

结果`dt`列的格式为`yyyy-MM-dd hh:mm:ss`.

您可以使用 PHP 格式化数字时间戳[`date()`](http://php.net/date)

如果您拥有的 PHP 版本是 64 位的，则不限于 1970 - 2036 年的范围，PHP 将支持 64 位时间戳，`BIGINT`在这种情况下请确保使用 MySQL 中的列。

希望有帮助。

# objective-c - Objective-C 切换视图控制器

> ID：11659735
> 
> 赞同：0
> 
> 时间：2012-07-25T22:38:25.033
> 
> 标签：objective-c, uiviewcontroller

我正在制作一个游戏，我有这样的视图控制器方案 1（菜单）--> 2（级别选择）-> 3 级（带有计时器等）---> 死亡或赢得 4 完成--> 再次 2。我所做的我创建了将所有这些视图控制器保存在数组中的单例类，并在需要时将它们设置为 rootViewControllers。但是我有以下问题：当我退出 3 并转到 4 时，我将 3 设置为`nil`但似乎 3 仍在工作（计时器正在控制台中打印消息）并且没有被释放。也许我不了解视图控制器，当您将另一个设置为 rootViewController 时会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:46:04.070

你真的不应该`rootViewControllers`这么频繁地切换。在大多数情况下，您将一个控制器设置为整个应用程序的根。您应该做的是使用 a`UINavigationController`来管理您的`UIViewControllers`. 一旦您将程序嵌入到 a 中`UINavigationController`，您所要做的就是推入和弹出导航控制器的堆栈。看看这几个方法：

```
- (NSArray *)popToRootViewControllerAnimated:(BOOL)animated

- (NSArray *)popToViewController:(UIViewController *)viewController animated:(BOOL)animated

- (UIViewController *)popViewControllerAnimated:(BOOL)animated 
```

类似地，您可以使用 push segue 将 View Controller 添加到堆栈中（通常从情节提要初始化（如果您正在使用））

您可以在此处了解更多信息：http `UINavigationController`: [//developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:48:58.573

在您的情况下，由于您对视图控制器（在数组中）有一个强引用，它的视图将被切换出来，但控制器仍然存在，所以如果您从该控制器启动了一个计时器，它将继续运行。至于计时器，我认为您应该在#3 视图控制器的 viewDidDisappear 方法中使其无效——这应该可以解决问题。

# javascript - 检索在 onchange javascript 事件中创建的 javascript 变量

> ID：11659738
> 
> 赞同：0
> 
> 时间：2012-07-25T22:38:30.363
> 
> 标签：javascript, jquery, ajax

我有以下简单的表单，用户可以从中选择一个状态来查看信息：

```
<form style="position:absolute; top:65px; left:650px">
    Select State to View:
    <select id="myList" onchange="load_state_data(); xml = getStateInfo();">
      <option selected="selected"></option>
        <?php
            foreach($stateNames as $state){
                echo('<option>'.$state.'</option>');
            }
        ?>
    </select>
</form> 
```

我的javascript如下：

```
function load_state_data() {
    var state_name = $("#myList option:selected").val();
    $.ajax({
        type: 'post',
        url: 'state_data.php',
        dataType: "xml",
        data: {
            state_name: $("#myList option:selected").val()
        },
        success: function (data) {
            //clear out previous values
            for (j = 0; j < 5; j++) {
                $('#top_name_' + j).html("");
                $('#top_score_' + j).html("");
            }

            $(data).find('TOP').each(function (index) {
                $('#top_name_' + index).html($(this).find('COMPANY_NAME').text());
                $('#top_score_' + index).html($(this).find('Q_SCORE').text());
            });

            //initialize my temp arrays for reverse ordering the results
            var botName = new Array();
            var botScore = new Array()

            //clear out previous values
            for (j = 0; j < 5; j++) {
                $('#bot_name_' + j).html("");
                $('#bot_score_' + j).html("");
            }

            $(data).find('BOTTOM').each(function (index) {
                //$('#bot_name_'+index).html($(this).find('COMPANY_NAME').text());
                //$('#bot_score_'+index).html($(this).find('Q_SCORE').text());
                botName[index] = $(this).find("COMPANY_NAME").text();
                botScore[index] = $(this).find("Q_SCORE").text();
                j = index;
            });
            var newOrderName = botName.reverse();
            var newOrderScore = botScore.reverse();
            for (i = 0; i < newOrderName.length; i++) {
                $('#bot_name_' + i).html(newOrderName[i]);
                $('#bot_score_' + i).html(newOrderScore[i]);
            }

            //clear the variables from memory
            delete botName;
            delete botScore;
            delete newOrderName;
            delete newOrderScore;

            //cycle through results and save my locations to an array of the map markers
            var inst_info = new Array();
            $(data).find('INST_MARKER').each(function (index) {
                inst_info[index] = [parseFloat($(this).find('LAT').text()),
                parseFloat($(this).find('LONG').text()),
                $(this).find('COMPANY_NAME').text(), $(this).find('Q_SCORE').text()];
            });

            $(data).find('INST_COUNT').each(function () {
                $('#num_total').html($(this).find('NUM_TOTAL').text());
                $('#num_null').html($(this).find('NUM_NULL').text());
            });
            return (inst_info);
        },
        error: function (data) {
            alert('There was an error. Please try again shortly.');
        }
    });
}; 
```

我需要在调用它的页面上访问此脚本中生成的 inst_info（参见上面的表格）。这可能吗？如果可以，怎么做？我曾尝试使用 inst_info = function load_state_data，但这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:45:22.427

这真的不可能。事件处理程序在某个时间点异步触发，并且没有“返回”值的代码。事件处理程序中发生的任何事情`load_state_data()`都与您的主 javascript 代码隔离，因为没有人知道它何时以及是否会发生。你必须在事件处理程序中做任何你想做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:49:46.307

> 我需要在调用它的页面上访问此脚本中生成的 inst_info（参见上面的表格）。这可能吗？如果可以，怎么做？

不会。是在*异步*请求`inst_info`成功事件的回调函数中创建的。从那里它可用，您将能够调用设置状态信息的函数。

 *所有这一切都将在您的`load_state_data`函数返回后发生。但是，您可能会为数据返回一个[Promise](http://api.jquery.com/category/deferred-object/)，在该数据上可以注册其他回调函数，以便在数据可用时立即执行。

* * *

```
 //clear the variables from memory
    delete ... 
```

此代码不起作用，这是对[`delete`operator](http://perfectionkills.com/understanding-delete/)的误用。无论如何你都不需要这样做，JavaScript 是一种垃圾收集语言。*

# joomla - Joomla分类列表显示文章图片

> ID：11659742
> 
> 赞同：0
> 
> 时间：2012-07-25T22:38:55.393
> 
> 标签：joomla, web

在我的主菜单中，我有一个类别列表。这可以正常工作并显示该类别中的每篇文章。

但是，当我单击菜单项并且类别列表显示每篇文章只有名称时，我希望它也显示每篇文章的图像。所以在文章属性中我设置了“介绍图片”。这不起作用。

如何为类别列表中显示的每篇文章显示文章图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T05:57:07.030

您可以使用 joomla 扩展“captifyContent” [http://www.joomlabamboo.com/joomla-extensions/captifycontent-beautiful-captions-for-your-content](http://www.joomlabamboo.com/joomla-extensions/captifycontent-beautiful-captions-for-your-content)

# html - 使用百分比宽度和边距让我的 CSS 框看起来正确。

> ID：11659744
> 
> 赞同：0
> 
> 时间：2012-07-25T22:39:09.127
> 
> 标签：html, css

所以，我试图让一些内容很好地适应另一个容器。

我的 CSS：（显示“测试”的框是 id='resultBox'）

```
#resultBox{
    display: block;
    position:absolute;
    width:20%;
    margin:0px;
    padding:0px;
} 
```

但这看起来很糟糕，都很狭窄，但是，我希望每行有 5 个框，有没有办法可以给一个边距，让它自动调整宽度%？

图片相关：上边是我想要的边距，下边是我想要的行为。 ![在此处输入图像描述](../Images/a370aa13df872729fb9fa8931eca0005.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:49:41.067

如果您只支持较新的浏览器，请使用`box-sizing: border-box`

这将包括宽度内的填充和边框。不要使用边距，使用边框使事物具有间距的外观。

参见：[https ://developer.mozilla.org/en/CSS/box-sizing](https://developer.mozilla.org/en/CSS/box-sizing)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:41:34.087

您可以使用以下方法模拟您想要的边距[`outline`](https://developer.mozilla.org/en/CSS/outline)：

```
#resultBox {
    ...
    outline: 1px solid white;
    ...
} 
```

这样，您将拥有每个块的视觉定义，而不会将最右边的块撞到下一行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T23:09:27.027

这个无表的表实现怎么样？

[http://jsfiddle.net/Wexcode/xKj8n/](http://jsfiddle.net/Wexcode/xKj8n/)

```
<div id="table">
    <div class="row">
        <div><span>Test</span></div>
        <div><span>Test</span></div>
        <div><span>Test</span></div>
        <div><span>Test</span></div>
        <div><span>Test</span></div>
    </div>
</table> 
```

**编辑：**

如果您愿意[牺牲与 IE8 的兼容性](http://caniuse.com/#feat=css-sel3)并使用`nth-child()`选择器（您始终可以使用 JavaScript 应用类），您也可以不使用行来执行此操作：

[http://jsfiddle.net/Wexcode/xKj8n/2/](http://jsfiddle.net/Wexcode/xKj8n/2/)

```
<div id="table">
    <div><span>Test</span></div>
    <div><span>Test</span></div>
    <div><span>Test</span></div>
    <div><span>Test</span></div>
    <div><span>Test</span></div>
</div>​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-25T22:53:10.057

您可以尝试`box-sizing: border-box`在右侧和底部使用 1px 边框，但您还需要使用`:nth-child`从最右侧的框中删除额外的 1px 边框。

```
.box
{
    width: 20%;
    float: left;
    border-radius: 3px;
    padding: 5px;
    border-right: solid 1px #fff;
    border-bottom: solid 1px #fff;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    -ms-box-sizing: border-box;
    box-sizing: border-box;
    background-color: #ccc;
}

.box:nth-child(5n)
{
    border-right: 0;
} 
```

[http://jsfiddle.net/Pf2LZ/](http://jsfiddle.net/Pf2LZ/)

这应该适用于合理的浏览器和 IE8+。仅 IE8（我认为）由于缺乏对`:nth-child`. 如果这是一个问题，你总是可以在每五个元素上添加一个额外的类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-25T22:54:49.213

如果您尝试显示表格数据，您真的应该使用表格。

```
td { 
    width: 20%;
    text-transform:uppercase; } 
```

HTML：

```
<table>
    <tr>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
    </tr>
    <tr>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
        <td>Test</td>
    </tr>
</table> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-25T22:51:09.763

不确定您的浏览器要求是什么，但您可以尝试新的 CSS3 Flexbox 模块：

[http://net.tutsplus.com/tutorials/html-css-techniques/an-introduction-to-css-flexbox/](http://net.tutsplus.com/tutorials/html-css-techniques/an-introduction-to-css-flexbox/)

# c++ - OpenHaptics 不编译

> ID：11659751
> 
> 赞同：0
> 
> 时间：2012-07-25T22:40:32.590
> 
> 标签：c++, lnk2019

所以我是 C++ 的新手，在过去的几天里，我一直在尝试编译一个程序。我为我的幻像 OMNI 下载了 OpenHaptics，并一直在尝试编译一个简单的球体程序。它给我的错误如下（我使用的是 Visual c++ 2010）

我认为问题在于它可能没有读取 glut32.dll 文件（基于互联网研究）我如何添加这个 .dll 文件以便编译器看到它，或者如果还有其他问题我该如何解决？

```
------ Build started: Project: Spheretest, Configuration: Debug Win32 ------
Sphereguts.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) void     __cdecl qhStart(void)" (__imp_?qhStart@@YAXXZ) referenced in function _main
Sphereguts.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: void __thiscall QHRenderer::tell(class Cursor *)" (__imp_?tell@QHRenderer@@QAEXPAVCursor@@@Z) referenced in function _main
Sphereguts.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall Cursor::Cursor(void)" (__imp_??0Cursor@@QAE@XZ) referenced in function _main
Sphereguts.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: void __thiscall QHRenderer::tell(class Sphere *)" (__imp_?tell@QHRenderer@@QAEXPAVSphere@@@Z) referenced in function _main
Sphereguts.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall Sphere::Sphere(void)" (__imp_??0Sphere@@QAE@XZ) referenced in function _main
Sphereguts.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: void __thiscall QHRenderer::tell(class DeviceSpace *)" (__imp_?tell@QHRenderer@@QAEXPAVDeviceSpace@@@Z) referenced in function _main
Sphereguts.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall DeviceSpace::DeviceSpace(void)" (__imp_??0DeviceSpace@@QAE@XZ) referenced in function _main
Sphereguts.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall QHGLUT::QHGLUT(int,char * * const)" (__imp_??0QHGLUT@@QAE@HQAPAD@Z) referenced in function _main
MSVCRTD.lib(crtexew.obj) : error LNK2019: unresolved external symbol _WinMain@16 referenced in function ___tmainCRTStartup
C:\Users\Ryan Grainger\Desktop\c++ test\Spheretest\Debug\Spheretest.exe : fatal error LNK1120: 9 unresolved externals 
```

========== 构建：0 成功，1 失败，0 最新，0 跳过 ==========

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:48:05.343

确保列出`.lib`要链接的库的文件。

另外...`main()`您的源代码中没有。或者，更确切地说，没有`Windows`特定的模拟被称为`WinMain()`- 并且链接器不喜欢它。

您需要提供`WinMain()`，或构建一个非`Windows`可执行文件（只是一个`console application`？），或将所有必要的文件包含到您的解决方案中（文件集必须包含其中包含`WinMain()`函数的文件）

# c# - 从 MVC 中的模型数据中选择的下拉列表项动态更改视图

> ID：11659756
> 
> 赞同：0
> 
> 时间：2012-07-25T22:41:34.610
> 
> 标签：c#, javascript, html, asp.net-mvc, asp.net-mvc-3

我不确定我是否正确地解决了这个问题，所以如果解释似乎缺乏，请耐心等待。我对 MVC-3 还是有点陌生​​。

我有一个 MVC 页面，我不确定从模型生成具有正确行为的视图的最佳方法是什么。该模型包含一个文本字段类列表，每个类包含一组要在视图中显示的文本字段（例如“HeadlineText”、“ButtonText”、“ColorText”等）。文本字段类列表用于用户设置的每种唯一语言，以便他们可以为每种不同的语言创建一组文本字段。

在视图中有一个下拉列表，其中包含文本字段类列表中的每种语言/对象，我想根据在下拉列表中选择的语言选项来更改视图中显示的文本字段-列表（并相应地动态更改）。

我最初的计划是从模型中为列表中的所有对象生成视图中的 html，并仅使用 javascript 来隐藏/取消隐藏不属于下拉列表中所选语言的文本字段集。我真的不喜欢在页面上生成一堆额外的 html 的想法，所以它们都可以通过 javascript 进行更改，但我没有看到任何其他方法可以在不重新加载/重新生成视图的情况下更新视图（我我试图让它看起来是异步的，没有回发）。

**更新：**

关于部分视图的建议似乎是我想要的，但我仍然想知道其他评论者没有输入的东西。也就是说，如果我想做部分视图，我仍然需要将文本字段绑定到父模型中的数据，并且（可能使用编辑器模板）仍然能够修改它们并在父视图/模型/时保存表单已提交保存。

我在 bit.ly/N5DY5a 和 bit.ly/SVYqdT 上阅读了其他一些内容。如果我理解正确，我应该能够将文本字段列表对象或父模型传递给部分视图，以便视图将为正确的字段生成编辑器模板并仍然将它们绑定到父模型，以便提交父表单时它们会被保存吗？我还没有得到任何工作，但我仍在努力......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T23:01:55.500

# 解决方案

首次使用视图呈现页面。

然后当您选择的值发生变化时，使用 ajax 获取新内容。

现在使用局部视图来呈现被修改的页面部分。

您的局部视图包含与您的视图相同的标记，但只是修改了部分。

# 例子

**在控制器中**：

```
//get data

if (!Request.IsAjaxRequest())
{
    return View(data);
}
else
{
    return PartialView("myPartialView", data);
} 
```

**在视图中**：

*HTML*：

```
...    
<div id="partialView"></div>
... 
```

*jQuery* :

```
<script type="text/javascript">
    $(function () {
        $('#myDropdownlist').change(function () {
            $.get('/controller/action' + $(this).find(':selected').val(), function (data) {
                $('#partialView').html(data);
            }
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:02:52.993

您可以使用带有 Ajax 的局部视图来完成此操作。

为每种语言创建一个局部视图，然后根据用户选择执行 Ajax 调用以使用局部视图更新/替换页面的 a 段。

[有关部分视图的更多信息](http://www.devcurry.com/2012/04/partial-views-in-aspnet-mvc-3.html)

# html - 对 div 的数量及其各自的悬停使用 z-index，同时在未悬停时保留原始分层

> ID：11659757
> 
> 赞同：0
> 
> 时间：2012-07-25T22:41:34.753
> 
> 标签：html, hover, z-index, opacity, overlap

**背景调查：** 1\. 刚接触基本的 html 和 css。2\. 不允许使用 Javascript。3\. 搜索了网站，没有找到匹配的主题（或无法理解）。4\. z-index和hover的模糊知识。5.离线页面。使用谷歌浏览器查看页面。使用记事本编辑。

**我想要什么：** 我需要将 5 张图像按水平顺序堆叠在一起。例如，在这段代码中，我希望 5 个国家标志（所有链接，大小相等，使用“left: px;”区分）在悬停时以 0.99999 链接不透明度和 1.0 不透明度的顺序相互重叠。当没有悬停时，图像应该回到它们原来的方式，而不是改变原始索引。

*由于知识限制，宁愿修改此代码而不是完全不同的替代方案。*

**我所做的：** 为每个图像使用 div 并为每个 div 及其各自的悬停创建 css [在为每个 img 创建 css 失败（保留 z-index 问题）之后]。现在这样做之后，悬停也不起作用。

***问题：*** 1.悬停/不透明度不起作用。2\. 悬停后z-index不保留。

PS 对这里的业余工作和问题表示歉意。

```
<html>
<head>
 <title>
  Europe: A never ending journey
 </title>
<style type="text/css">
div.mainRunner
  {
  position: absolute;
  }
div.transbox1
  {
   position: absolute;
   z-index: 1;
   top: 0px;
   left: 0px;
   opacity:0.99999;

  }
div.transbox1:hover
  {
  position: absolute;
  z-index: 1;
  top: 0px;
  left: 0px;
  opacity:1.0;
  }

div.transbox2
  {
   position: absolute;
   z-index: 2;
   top: 0px;
   left: 80px;
   opacity:0.99999;

  }
div.transbox2:hover
  {
   position: absolute;
   z-index: 2;
   top: 0px;
   left: 80px;
   opacity:1.0;
  }
div.transbox3
  {
   position: absolute;
   z-index: 3;
   top: 0px;
   left: 160px;
   opacity:0.99999;

  }
div.transbox3:hover
  {
   position: absolute;
   z-index: 3;
   top: 0px;
   left: 160px;
   opacity:1.0;
  }
div.transbox4
  {
   position: absolute;
   z-index: 4;
   top: 0px;
   left: 240px;
   opacity:0.99999;

  }
div.transbox4:hover
  {
   position: absolute;
   z-index: 4;
   top: 0px;
   left: 240px;
   opacity:1.0;
  }
div.transbox5
  {
   position: absolute;
   z-index: 5;
   top: 0px;
   left: 320px;
   opacity:0.99999;

  }
div.transbox5:hover
  {
   position: absolute;
   z-index: 5;
   top: 0px;
   left: 320px;
   opacity:1.0;
  }

</style>
</head>
<body leftmargin="0px" topmargin="0px" marginwidth="0px" marginheight="0px">
 <div class="mainRunner">
  <div class="transbox1">
   <a href="Italy.html"><img src="Italy.jpg" width="800" height="450"></a>
  </div>
 <div class="transbox2">
   <a href="France.html"><img src="France.jpg" width="800" height="450"></a>
 </div>
 <div class="transbox3">
  <a href="Germany.html"><img src="Germany.jpg" width="800" height="450"></a>
 </div>
 <div class="transbox4">
  <a href="Switzerland.html"><img src="Switzerland.jpg" width="800" height="450"></a>
 </div>
 <div class="transbox5">
  <a href="UnitedKingdom.html"><img src="United Kingdom.jpg" width="800" height="450"></a>
 </div>
 </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:23:37.383

将其发布为答案，因为它是答案（我正在尝试积累一些代表 =）：

将处于 :hover 状态的元素的 z-index 设置为大于您希望它显示在前面的元素的 z-index。

# c++ - 使用 STL、cs106l 的单字母替换加密

> ID：11659761
> 
> 赞同：2
> 
> 时间：2012-07-25T22:42:09.553
> 
> 标签：c++, stl

我在 CS106L 中做关于 STL 算法的练习，其中一个问题是关于使用 random_shuffle 进行替换加密。

问题是使用 random_shuffle 实现一个函数 MonoalphabeticSubstitutionEncrypt，它接受一个源字符串并用随机的 Monoalphabetic Substitution Cipher 对其进行加密。

这意味着一开始我有“AB..XYZ”，只是将 random_shuffle 调用到 AZ 并生成类似“KVDQ...MSB”的内容，然后进行加密原始字符串的映射。

我可以使用映射来完成，但应该只使用那些 STL 算法来完成。

有人有想法吗？谢谢！

我是这样做的，但似乎我没有使用 STL 算法的力量

```
string MonoSubsitutionEncrypt(string line){
    string original = "abcdefghijklmnopqrstuvwxyz";
    string excrypt = original;
    random_shuffle(encrypt.begin(), encrypt.end());
    map<char, char> m;
    for (int i = 0;i < original.length(); i++) 
        m.insert(make_pair(original[i],encrypt[i]));
    string result;
    for (int i = 0; i < line.length(); i++)
         result += m[line[i]];
    return result;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T00:17:14.687

我刚刚写了一个版本，它随机将字节混入其他字节。您必须经过一些步骤才能使其仅接受和输出 ascii 字符。我特别处理了空字符，因为它应该被保留以指示字符串的结尾。

我的算法的伪代码如下：

```
#include <algorithm>
#include <iostream>
#include <vector>
#include <string>

template class Filler (T)
    constructor Filler(T item)
        initial = item

    T operator () ()
        return initial++

    private T initial

template class Encryptor (T1, T2)
    constructor Encryptor(T1 mapping)
        cipher = mapping

    T2 operator () (T2 value)
        return cipher[value]

    private T1 cipher

int main (int c, char * v[])
    // stl class, big enough to hold each char
    vector<unsigned char> alphabet(256)       

    // creates a filler object described above
    Filler<unsigned char> filler(0)           

    // stl function, fills alphabet with one of each char
    generate_n(alphabet.begin(), 256, filler) 

    // stl function, shuffles alphabet (start at 1, leave NULL character at beginning)
    random_shuffle(alphabet.begin() + 1, alphabet.end())

    // creates a generator to be passed to transform
    Encryptor<vector<unsigned char>, unsigned char> e(alphabet)

    // get input value: either first parameter, or nothing if no parameters
    string input = c > 1 ? v[1] : ""

    // stl function, uses encryptor containing alphabet mapping to obfuscate input
    transform(input.begin(), input.end(), input.begin(), e)

    // printing the string yields garbled crap
    cout << input << endl; 
```

使用的 stl 类的文档： [字符串](http://www.cplusplus.com/reference/string/string/) [向量](http://www.cplusplus.com/reference/stl/vector/) [ostream](http://www.cplusplus.com/reference/iostream/ostream/)

使用的 stl 方法的文档：[generate_n](http://www.cplusplus.com/reference/algorithm/generate_n/) [random_shuffle](http://www.cplusplus.com/reference/algorithm/random_shuffle/) [变换](http://www.cplusplus.com/reference/algorithm/transform/)

如果这篇文章泄露太多，有人编辑它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T22:53:04.923

我将使用一个映射类，该类在创建时创建和打乱数组/向量，并重载`operator()`以返回输入的加密版本。为了发挥更大的作用，您还需要一个成员函数（或者可能是运算符）来检索打乱的字母表以用作解密的密钥。

有了这个，用`std::transform`.

# android - Android后台服务在主应用程序中触发事件

> ID：11659762
> 
> 赞同：0
> 
> 时间：2012-07-25T22:42:13.420
> 
> 标签：android, events, background-service

我正在尝试创建一个应用程序，它将某些应用程序（基于用户输入）列入黑名单，并在检测到列入黑名单的应用程序时，通过将主应用程序（或我的应用程序的其他部分）置于前台来阻止这些应用程序启动前景。

这将类似于 Smart App Protector，但具有额外的触发条件。

我的服务检测应用程序正常，但我无法让主要活动出现在前面。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:46:58.040

在没有通知的情况下突然将您的活动带到前台总是一个坏习惯。我们始终建议通过通知管理器发送通知，然后单击通知消息，它​​会使用待定意图运行您的活动。这是否满足您的需求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:23:39.830

当您检测到列入黑名单的应用程序时使用它：

```
Intent startupIntent = new Intent(context, ActivityToLaunch.class);
startupIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
context.startActivity(startupIntent); 
```

# php - 将 MySQL 的结果集创建为 CSV 字符串

> ID：11659770
> 
> 赞同：0
> 
> 时间：2012-07-25T22:43:19.127
> 
> 标签：php, mysql, csv

我如何使用 mysql_fetch_array / mysql_fetch_row 结果创建一个 csv 文件，其中每行记录为 csv，下一条记录在新行中。

我试过这个：

```
$query = "SELECT * FROM myTable DESC LIMIT 10";

$result = mysql_query($query, $conn);
$resultRows = mysql_num_rows($result);

if($resultRows < 1) {
    return array('query' => $query, 'NumberOfRows' => $resultRows, 'status' => 'failure');
};

$rowResult = mysql_fetch_array($result);
//var_dump($rowResult);exit;
foreach($rowResult as $row){

    $resultSet = $row['firstname'];
    $resultSet .= ',' . $row['lastname'];
    $resultSet .= ',' . $row['email'];
    $resultSet .= ',' . $row['phone'];
    $resultSet .= ',' . ($row['address1']);
    $resultSet .= '\n';
    //var_dump($resultSet);exit;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:47:04.093

我相信换行符必须用双引号引起来。

```
$resultSet .= "\n"; 
```

由于长度原因，可能只是从代码中省略了，但请确保您在 foreach 之后回显 $resultSet。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:55:40.337

如果您希望文件以 CSV 格式下载，则应包含以下标题

```
header("Content-type: application/x-msdownload");
header("Content-Disposition: attachment; filename=extraction.csv");
header("Pragma: no-cache");
header("Expires: 0"); 
```

然后对于 csv 部分，您将使用如下内容：

```
echo "FirstName,LastName,Email,Phone,Address\r\n"; //header
while($row = mysql_fetch_array($result)){
  echo "\"$row[firstname]\",\"$row[lastname]\",\"$row[email]\",\"$row[phone]\",\"$row[address]\"\r\n";
} 
```

但是，如果您只想创建一个文件，您可以使用如下内容：

```
$fp = fopen('file.csv', 'w');

while($row = mysql_fetch_array($result)){
   fputcsv($fp, $row);
}

fclose($fp); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:56:03.730

这是一个很好的资源： http: [//www.codehive.net/PHP-Array-to-CSV-1.html](http://www.codehive.net/PHP-Array-to-CSV-1.html)

用法：

```
$csv_data = array_to_scv($array, false);
print_r($csv_data); 
```

# iphone - 应用程序与 Xcode 和设备运行方式不同

> ID：11659772
> 
> 赞同：1
> 
> 时间：2012-07-25T22:43:26.820
> 
> 标签：iphone, xcode, ipad, debugging, ios6

我有一个正在调试的应用程序。我试图让它在 iOS 6 上运行。当我通过 Xcode 使用该设备作为我的“模拟器”运行应用程序时，它运行良好。但是当我从应用商店下载应用程序（完全相同的代码）时，我在加载菜单时遇到了问题。问题可能是什么？有什么我可以做的，还是只是 iOS 6 Beta 的问题？我不能太具体，因为该项目是针对我工作的公司的，但我会回答我可以回答的问题。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:04:22.037

在模拟器上正确运行的应用程序绝不意味着您认为它可以在真实设备上运行。如果您已经尝试从设备中删除应用程序、清理目标并重新安装，那么您可能需要返回代码并确保所有区分大小写的内容都正确大写。

`@"myXib"`例如，如果您放置并忘记大写“X”，则从名为 xib 的视图控制器实例化`@"myxib"`它将在模拟器上正常工作，但在真实设备上却不能正常工作，因为模拟器对真实设备的许多事情不区分大小写是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:31:24.630

事实证明，问题出在 iOS 6 的 Beta 版上。

# java - GCM 不是在做姜饼，而是在做冰淇淋三明治

> ID：11659784
> 
> 赞同：0
> 
> 时间：2012-07-25T22:44:28.290
> 
> 标签：java, android, eclipse

我正在编写一个使用 GCM 消息的游戏。当一名玩家进入回合移动到服务器时，服务器将向他们的对手发送 GCM 消息，让该客户端知道有额外的回合数据可用。这应该很简单。我尽可能地遵循示例 GCM 客户端代码。

我有两台设备进行测试： 带有 Ice Cream Sandwich 版本 4.0.4 的 Motorola Xoom 带有 Gingerbread 版本 2.3.5 的 Motorola X2

两台设备都有一个 Goggle 帐户设置（实际上是同一个帐户）。我可以从 Play Store 下载应用程序。当我收到新的 Google Talk 消息或 Gmail 消息时，我都会收到通知消息。他们都在我面前使用相同的 Wi-Fi 网络，所以我可以确认没有防火墙问题。我在两者上都安装了相同的游戏应用程序。我已经能够在两台设备上获得 GCM 注册 ID 号。除了 Android 操作系统版本之外，这两款设备几乎完全相同。但是，Xoom 将接收 GCM 消息而 X2 不会，或者至少这些消息没有被广播到我在 X2 上的应用程序。

这是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="myGame.app.main" android:versionCode="1" android:versionName="1.0">
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="16" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
<permission android:name="myGame.app.main.permission.C2D_MESSAGE" android:protectionLevel="signature" />
<uses-permission android:name="myGame.app.main.permission.C2D_MESSAGE" />

<application android:icon="@drawable/icon" android:name="myGameApp" android:label="@string/app_name" android:description="@string/description" android:theme="@style/GlobalTheme" android:killAfterRestore="false" android:allowTaskReparenting="false" android:persistent="false">

    ... Other Activities ...

    <receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >
        <intent-filter>
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
            <category android:name="myGame.app.main" />
        </intent-filter>
    </receiver>
    <service android:name=".GCMIntentService" android:enabled="true" />
    </application>
</manifest> 
```

这是我的 GCMIntentService 的代码：

```
package myGame.app.main;

import com.google.android.gcm.GCMBaseIntentService;
import com.google.android.gcm.GCMRegistrar;
import android.content.Context;
import android.content.Intent;
import android.os.PowerManager;
import java.util.logging.Logger;

public class GCMIntentService extends GCMBaseIntentService
{
    private static PowerManager.WakeLock sWakeLock;
    private static final Object LOCK = GCMIntentService.class;
    private static final String GCM_SENDER_ID = "... My Sender ID...";
    private static final String GCM_INTENT_FILTER = "myGame.app.main.GCM_MESSAGE";
    private static final String MESSAGE_TYPE = "Type";
    private static final String MESSAGE_CONTENT = "Body";
    private static Logger log = Logger.getLogger(GCMIntentService.class.getName());

    public GCMIntentService()
    {
        super(GCM_SENDER_ID);
    }

    static void runIntentInService(Context context,Intent intent)
    {
        synchronized(LOCK)
        {
            if (sWakeLock == null)
            {
                PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
                sWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,"sc_wakelock");
            }
        }
        sWakeLock.acquire();
        intent.setClassName(context,GCMIntentService.class.getName());
        context.startService(intent);
    }

    @Override protected void onRegistered(Context context,String registrationId)
    {
        log.warning("From GCMIntentService: Device successfully registered as "+registrationId);
        ... Other Code ...
    }

    @Override protected void onUnregistered(Context context,String registrationId)
    {
        log.warning("From GCMIntentService: Device successfully unregistered");
        ... Other Code ...
    }

    @Override protected void onMessage(Context context,Intent messageIntent)
    {
        log.warning("From GCMIntentService: Game update notice received");
        ... Other Code ...
    }

    @Override protected void onDeletedMessages(Context context,int total)
    {
        log.warning("From GCMIntentService: Server deleted "+Integer.toString(total)+" pending messages");
    }

    @Override public void onError(Context context,String errorId)
    {
        log.warning("From GCMIntentService: Error "+errorId);
        ... Other Code ...
    }

    @Override protected boolean onRecoverableError(Context context,String errorId)
    {
        log.warning("From GCMIntentService: Recoverable error "+errorId);
        return(super.onRecoverableError(context,errorId));
    }
} 
```

我什至用自己的 getGCMIntentServiceClassName() 函数创建了自己的 GCMBroadcastReceiver 类，并在那里放置了一条日志消息。在我尝试过的每个变体中，当应用程序在 Xoom 上运行时，我都会看到正确的 LogCat 消息，但我在 X2 上根本看不到任何 GCM 消息的证据。就好像 GCMBroadcastReceiver 和/或 GCMIntentService 根本不起作用，但我没有看到任何类型的错误消息。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:09:32.963

我为 GCM 消息编译了示例代码。我所做的唯一更改是使用我在游戏应用程序中使用的相同 API 密钥和发件人 ID。此应用程序可在两台设备上运行，因此我可以再次确认没有网络问题，并且我可以确认 X2 实际上可以接收 GCM 消息。

坏消息是 X2 仍然没有收到我的游戏的 GCM 消息。经过更多研究后，我发现当服务器尝试向 X2 发送 GCM 消息（仅适用于我的游戏应用程序）时，服务器会收到 ERROR_NOT_REGISTERED 结果。发送到 Xoom 时不会出现此类错误。我已确认服务器已成功接收注册 ID 号。我知道这很难说，但注册 ID 不会在传输过程中被破坏。

我尝试了一些关于如何从 GCM 服务器取消注册设备的不同已发布建议，但似乎没有一个有效。我总是再次收到相同的注册 ID。所以我完全卸载了我的游戏，然后在 X2 上重新安装了它。这迫使它获得一个新的注册 ID 号，从而解决了这个问题。我的游戏现在在两台设备上都能正常运行。我必须假设在我调试时，注册 ID 在游戏和 GCM 服务器之间以某种方式混淆了。

我只能希望这不会成为一个常规问题，因为除了卸载应用程序之外似乎没有成功的修复。

# iphone - 使用 ASIHTTPRequest 的链接问题

> ID：11659785
> 
> 赞同：4
> 
> 时间：2012-07-25T22:44:33.960
> 
> 标签：iphone, objective-c, ios5, asihttprequest

我正在开发一个 iPhone 应用程序（ios 5），我正在尝试使用 ASIHTTPRequest 来促进我的异步请求。在完全按照项目网站上的说明进行操作后，我无法构建我的项目[。](http://allseeing-i.com/ASIHTTPRequest/Setup-instructions)

看来我无法正确链接到这个库

> 体系结构 i386 的未定义符号：
> “_OBJC_CLASS_$_ASIFormDataRequest”，引用自：CreateUserViewController.o ld 中的 objc-class-ref：未找到体系结构 i386 的符号：错误：链接器命令失败，退出代码为 1（使用 -v查看调用）

这个项目正在使用 ARC，也许这就是问题所在？有没有人遇到过这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T22:54:16.530

是的，这是由于您的项目使用了 ARC。查看[这篇文章](https://stackoverflow.com/questions/8040629/ios5-arc-what-is-the-compiler-flag-to-exclude-a-file-from-arc)以从 ARC 中排除库文件。完成后它应该看起来像这样：

![在此处输入图像描述](../Images/9f4c3fed1bcaa25a487f437ce876a865.png)

# javascript - Chrome 中的 THREE.JSONLoader 错误

> ID：11659791
> 
> 赞同：0
> 
> 时间：2012-07-25T22:45:23.587
> 
> 标签：javascript, webgl

我转换了一个模型。对象。JS

当我尝试加载。带有 THREE.JSONLoader 的 Js 如下：

```
var loader = new THREE.JSONLoader();
loader.load( {model: "/modelos/modelos3D/Dragon.js", callback: agregarDragon } );

function agregarDragon( geometria )
{
    geometria.materials[0][0].shading = THREE.FlatShading;
    geometria.materials[0][0].morphTargets = true;

    var material = new THREE.MeshFaceMaterial();

    modeloDragon = new THREE.Mesh( geometria, material );
    modeloDragon.scale.set(50,50,50); 
    escena.add( modeloDragon );
} 
```

一些 Dragon.js：

```
{

"metadata" :
{
    "formatVersion" : 3,
    "sourceFile"    : "Dragon.obj",
    "generatedBy"   : "OBJConverter",
    "vertices"      : 3143,
    "faces"         : 11130,
    "normals"       : 10066,
    "colors"        : 0,
    "uvs"           : 1172,
    "materials"     : 3
},

"scale" : 1.000000,

"materials": [      {
    "DbgColor" : 15658734,
    "DbgIndex" : 0,
    "DbgName" : "Material__35"
    },

    {
    "DbgColor" : 15597568,
    "DbgIndex" : 1,
    "DbgName" : "Material__47"
    },

    {
    "DbgColor" : 60928,
    "DbgIndex" : 2,
    "DbgName" : "Material__83"
    }],

"vertices": [-0.696100,0.260000,0.408700,....]
.
.
} 
```

当我尝试使用 chrome 加载时会产生以下错误

```
 Uncaught SyntaxError: Unexpected token : 
```

并强调线条

```
"metadata" : 
```

和带有萤火虫的雷区：

```
 invalid label: Dragon.js(line 3, col 4 )
 "metadata" : 
```

为什么会产生这个错误？

怎么修？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T22:49:12.597

可能是由分号插入引起的。试试这个

```
 "metadata" : {
   //the rest of your json
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T14:40:07.800

我解决了问题，两件事

1.  正在使用版本 47，以及 49 的更改

2.  更改加载模型的方式

```
loader.load( '/modelos/modelos3D/Dragon.js',function( geometria )
{
        var mesh = new THREE.Mesh( geometria, new THREE.MeshNormalMaterial( {overdraw:true}  ));
        escena.add( mesh );
}); 
```

# ruby-on-rails - 模型的多个实例的属性添加的输出

> ID：11659793
> 
> 赞同：0
> 
> 时间：2012-07-25T22:45:46.117
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

销售我的基本设置：
我有一个用户模型，它与工作日模型具有 has_many/belongs_to 关系。
Workday 模型具有称为“销售”和“日期”的属性。

我想要做的是在给定的时间跨度内将不同工作日实例的销售属性相加。我首先尝试将该用户的所有销售额加起来，结果是

```
NoMethodError: undefined method `sales' for nil:NilClass 
```

代码如下所示：

```
def all_sales
  s = 0.to_f
  c = @user.workdays.count
  for i in (0..c)
    s += @user.workdays[i].sales
  end
end 
```

最优雅的方法是什么？

编辑 1：错字，是*user.workdays[i].sales*，而不是*.count*。对于那个很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T00:01:14.327

可以通过 Arel 完成

```
@user.workdays.sum(:sales) 
```

您也可以查询特定的时间间隔

```
@user.workdays.where("date BETWEEN ? AND ?",start_date, end_date).sum(:sales) 
```

# java - Java-检查是否正在按下控制键

> ID：11659801
> 
> 赞同：5
> 
> 时间：2012-07-25T22:46:39.803
> 
> 标签：java, swing

我有一个 Java 函数，我想在其中测试控制键是否被按住。我怎样才能做到这一点？

编辑：我正在使用swing for gui。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-04-19T22:34:57.907

使用“isControlDown()”布尔值：

```
public void keyPressed (KeyEvent e)
{
     System.out.println(e.isControlDown());
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-02T01:42:49.450

上面的代码只有在唯一按下的是控制键时才有效。如果他们有 ctrl 并且（可能）意外按下了其他按钮，它将不会捕获。

您可以仅检查 ctrl 键

```
// Are just the CTRL switches left on
if(evt.getModifiers() == InputEvent.CTRL_MASK) {
    System.out.println("just the control key is pressed");
} 
```

当模拟多个按键被按下时，您使用 or 位操作符。要模拟同时按住左键和 ctrl 键，请寻找这个。

```
// Turn on all leftButton and CTRL switches
int desiredKey = InputEvent.BUTTON1_MASK | InputEvent.CTRL_MASK; 
```

检查 ctrl 键是否按下时，您可以这样做

```
// If we turn off all switches not belonging to CTRL, are all the CTRL switches left on
if((evt.getModifiers() & InputEvent.CTRL_MASK) == InputEvent.CTRL_MASK) {
    System.out.println("Control Key is pressed and perhaps other keys as well");
} 
```

您还可以检查是否同时按下了左键和 ctrl 掩码

```
// If we turn off all switches not belonging to leftButton or CTRL, are all the leftButton and CTRL switches left on
if((evt.getModifiers() & desiredKey) == desiredKey) {
    System.out.println("left button and control keys are pressed and perhaps others as well");
} 
```

假设你有这个：

```
A | B 
```

你应该这样想。A 有一个控制面板，上面有一堆开关。B还有一个控制面板，上面有一堆开关。“| B”的工作是做最少的工作以确保所有 B 的开关都打开。

假设你有这个：

```
A & B 
```

“& B”的工作是做最少的工作来关闭任何不是 B 的开关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-25T22:53:58.677

这取决于几件事。

如果您将 Java 程序作为控制台程序（基于文本）运行，则必须测试接收到的字符中的适当位。

否则，您应该查看合适的 GUI 类的 InputEvents，例如[http://docs.oracle.com/javase/6/docs/api/java/awt/event/InputEvent.html](http://docs.oracle.com/javase/6/docs/api/java/awt/event/InputEvent.html)。

看看这个教程：[http ://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-25T23:17:33.407

我找到了一个解决我的问题的解决方案：我声明了一个全局变量

```
boolean controlStatus=false; 
```

然后在 jTextField 上的 keyPressed 事件中：

```
if(evt.getKeyCode()==KeyEvent.VK_CONTROL)
      controlStatus=true; 
```

在 keyReleased 事件中：

```
if(evt.getKeyCode()==KeyEvent.VK_CONTROL)
      controlStatus=false; 
```

然后我可以访问全局变量来检查控制键是否被按住。

# git - Git 和 windows 7 编码冲突？

> ID：11659802
> 
> 赞同：1
> 
> 时间：2012-07-25T22:46:55.203
> 
> 标签：git

由于某种原因，我从远程获取的文件导致我的存储库出现问题。正如您在更改中看到的那样，它带有一个未知字符，并且在我有这个坏字符的文件中，我什么也做不了，提交、恢复、接受我的或“其他”文件。

我已经尝试过重置 HARD 并重新拉取，重新克隆，直到现在都没有成功。我认为这是一些编码问题，但我不知道配置什么以及在哪里配置。

注意：我的存储库在 bitbucket 上。

有人可以帮助我吗？

![在此处输入图像描述](../Images/53ca74f443ee0d50c2948dcb033b9571.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T03:43:41.380

您的操作系统的默认编码是什么？我用 bitbucket`utf8`来存储 git 的东西。如果你的操作系统采用另一种编码，比如中文编码，你就会遇到这个问题。这是一个已知问题[git、msysgit、accents、utf-8、最终答案](https://stackoverflow.com/questions/5854967/git-msysgit-accents-utf-8-the-definitive-answers)。据我所知，最新的`git-gui`解决了这个问题。TortoiseGit 使用 msysgit 作为底层 git messenger，它遇到了文件编码问题。

# search - 基于位置的搜索

> ID：11659819
> 
> 赞同：0
> 
> 时间：2012-07-25T22:48:33.767
> 
> 标签：search

我们目前有一个可以按位置搜索对象的站点。我们有一个搜索框和我们国家的州下拉列表。每个对象都与一个状态有关系。

我们希望将此网站扩展到其他国家。我们的选择似乎是：

1/ 对于我们想要进入的每个国家，我们需要一份州列表，可能还需要邮政编码。这些对象与州和邮政编码相关联，并且在搜索框旁边提供了一个下拉列表。

2/ 将经度和纬度关联到每个对象，并让 google api 返回用户在搜索时键入的地址的经度和纬度。然后找到落在搜索地址的经/纬度一定半径内的对象。

选项 1 会表现良好但受到限制，因为在进入每个国家之前我们必须做很多工作（获取州/邮政编码列表）。

选项 2 似乎是最有弹性的，进入一个新国家没有限制。但是，如果做得不好，它可能会表现不佳。您将如何避免搜索表中的所有对象以找出其中 long/lat 落在搜索地址的 long/lat 的半径范围内？

我们喜欢 www.skillpages.com 的工作方式。非常快速和准确的搜索，如果我们选择选项 2，这是我们想要复制的内容。

任何关于如何最好地创建基于精确和弹性位置的搜索算法的建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:04:55.557

如果您希望允许用户搜索 x 英里半径内的项目，选项 2 听起来是最佳选择。如果您设置存储每个项目的 lat/lng 的索引列，则不应该有太多的数据库开销

假设基于 PHP/MySQL 的内容如下：

```
$radius = 0.15; // Would be calculated based on radius of the search
$user_lat = -0.134239; // Latitude of User Searching
$user_lon = 51.510238; // Longitude of User Searching

$query = mysql_query("SELECT * FROM `items` WHERE `lng`<'". ($user_lon + $radius) ."' AND `lng`>'". ($user_lon - $radius) ."' AND `lat`>'". ($user_lat - $radius) ."' AND `lat`<'". ($user_lat + $radius) ."'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T17:43:46.783

考虑将国家划分为地区、次地区、城市、地方。尽可能多的级别。不是实时运行 api 请求，而是存储城市中不同地区之间的距离（例如，一个城市有 100 个地区，这将导致一个城市的 100 X100 地区矩阵/表）。

根据用户输入的相应位置显示结果，所有结果都在一个城市中，可能按用户所在位置与所有其他位置之间的距离排序。有点像将市中心更改为用户的位置。

但是，这将导致城市的单独“位置表”，如果您超出某些城市数量，我只能推测会出现的问题。

我正在尝试为我的网站做同样的事情。

考虑是否将距离数据存储在 XML 或位图（这些在社交网络网站上创建社交图时被大量使用）会节省性能。

根据用户数量，实时调用 api + 计算距离应该会花费大量时间。无论如何，谷歌 api 调用也是有限的。

# java - 使用带条件的数据提供者

> ID：11659821
> 
> 赞同：1
> 
> 时间：2012-07-25T22:48:36.980
> 
> 标签：java, testng, testng-dataprovider

有没有办法根据特定条件从数据提供者那里获取数据？就像是..

```
@Test(dataProvider = "Data-Provider-Function" class="Randomclass.class")
public void parameterIntTest(Class clzz, String[] number) {
   System.out.println("Parameterized Number is : " + number[0]);
   System.out.println("Parameterized Number is : " + number[1]);
}

//This function will provide the parameter data
@DataProvider(name = "Data-Provider-Function")
public Object[][] parameterIntTestProvider(boolean evenOnly) {
            if(evenOnly)
                 return new Object[][]{};
            else
                 return new Object[][]{};
     } 
```

或类似的东西..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T01:58:59.070

数据提供者支持`@Parameters`注释，您可以在其中使用 testng.xml 中配置的一组固定值（主机名、事务隔离等）自定义它们

或者，您可以引入一个实用程序方法，该方法生成实际数据并使用两个不同的数据提供者使用不同的参数调用它。

[http://testng.org/doc/documentation-main.html#parameters-testng-xml](http://testng.org/doc/documentation-main.html#parameters-testng-xml)

# javascript - 使用 WinJS.UI.ListView，如何在 snapview 中禁用点击动画

> ID：11659825
> 
> 赞同：2
> 
> 时间：2012-07-25T22:48:55.717
> 
> 标签：javascript, windows-runtime

使用 vs2012 RC 中的“网格”示例，当您处于快照视图时，网格会变成 ListView。在我的应用程序中，我不希望在 snapview 中选择项目时调用 itemInvoked 页面方法。我也不希望项目上的动画让用户认为会发生某些事情。我知道如何禁用 iteminvoked（见下文），但不确定如何在选择（调用）项目时摆脱动画。

```
 itemInvoked: function (args) {
        if (appView.value != appViewState.snapped) {
            var listView = document.getElementById("groupdetaillistId").winControl; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T13:22:14.640

您可以更改以下 WinJS.UI.ListView 属性，它将使项目无法单击，同时删除“单击”动画：

```
selectionMode: 'none'
tapBehavior: 'none'
swipeBehavior:'none' 
```

[http://msdn.microsoft.com/en-us/library/windows/apps/br211851.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/br211851.aspx)

[http://msdn.microsoft.com/en-us/library/windows/apps/hh700733.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh700733.aspx)

[http://msdn.microsoft.com/en-us/library/windows/apps/hh700730.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh700730.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T06:58:51.230

问题是 WinJS 实际上对动画做了一些内联样式。没有办法使用 CSS 禁用它。但是，我们可以使用 JavaScript 的强大功能来重置函数的功能。

```
window.addEventListener("resize", handleResize);

var origFunc = WinJS.UI._SelectionMode.prototype.togglePressed;

function handleResize(evt) {

    var currentViewState = Windows.UI.ViewManagement.ApplicationView.value;

    if (currentViewState === 2) {
        WinJS.UI._SelectionMode.prototype.togglePressed = function (add) {};
    }
    else {
        WinJS.UI._SelectionMode.prototype.togglePressed = origFunc;
    }
} 
```

当我看到你的问题时，找到了这个链接，这就是我找到这个解决方案的原因。 [http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/847cefe9-30f6-4f05-96ad-26ece31b77c5](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/847cefe9-30f6-4f05-96ad-26ece31b77c5)

所有这些代码都在全局空间中。注册调整大小事件

```
window.addEventListener("resize", handleResize); 
```

将原始函数存储在变量中

```
var origFunc = WinJS.UI._SelectionMode.prototype.togglePressed; 
```

处理调整大小事件

```
function handleResize(evt) { 
```

获取当前视图状态

```
 var currentViewState = Windows.UI.ViewManagement.ApplicationView.value; 
```

如果我们处于快照模式，请将函数设置为空

```
 if (currentViewState === 2) {
        WinJS.UI._SelectionMode.prototype.togglePressed = function (add) {};
    } 
```

否则，将其设置回 WinJS 版本

```
 else {
        WinJS.UI._SelectionMode.prototype.togglePressed = origFunc;
    }
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-15T07:44:38.780

BZ 是在正确的道路上。ListView 具有处理此问题的本机机制，不需要 hacky Javascript。我会支持 BZ 而反对 Chad Carter，但我没有任何声望点。我想这就是你作为 StackOverflow 的一个沉默的、非订阅的观察者十年来得到的：/

# r - 在 R 中拆分后的子集列表

> ID：11659826
> 
> 赞同：1
> 
> 时间：2012-07-25T22:48:56.407
> 
> 标签：r, csv, split, dataframe

这是问题

我有一个我 read.csv() 的 csv 文件，并打印到：

```
 grp  b a  id d c
1 grp1  2 1 id3 3 2
2 grp1 -2 1 id1 3 2
3 grp0 -2 1 id4 3 2
4 grp0  1 1 id0 3 2
5 grp0  1 1 id2 3 2 
```

现在我想把它分成两个数据框，一个带有数据`grp1`，另一个用于`grp2`

```
groups <- split(raw, raw$grp); 
```

这产生了这个：

```
$grp0
   grp  b a  id d c
3 grp0 -2 1 id4 3 2
4 grp0  1 1 id0 3 2
5 grp0  1 1 id2 3 2

$grp1
   grp  b a  id d c
1 grp1  2 1 id3 3 2
2 grp1 -2 1 id1 3 2 
```

现在我只想要`a,b,c,d`这些列表中的每一个中的行，所以我需要将它们强制为要使用的数据框`subset()`，这意味着我需要：

```
for(i in 1:length(groups))
{
      x <- subset(as.data.frame(groups[i]), select = c(a,b,c,d));
      some_function(x); 
} 
```

问题是，当我这样做时，它说*column a doesn't exist*，当我打印这些东西时，这就是我们看到的：

```
 grp0.grp grp0.b grp0.a grp0.id grp0.d grp0.c
3     grp0     -2      1     id4      3      2
4     grp0      1      1     id0      3      2
5     grp0      1      1     id2      3      2
  grp1.grp grp1.b grp1.a grp1.id grp1.d grp1.c
1     grp1      2      1     id3      3      2
2     grp1     -2      1     id1      3      2 
```

因此，这些列不再只是 a、b、c、d，而是在拆分期间创建的名称前面加上它们的名称。他们是我可以避免这种情况发生的一种方式吗？或者有没有办法获取数据框的名称并将其添加到我正在设置子集的元素列表中？我只想得到看起来像这样的数据框，列名不必准确：

```
$grp0
       b  a  d c
    3 -2  1  3 2
    4  1  1  3 2
    5  1  1  3 2

$grp1
       b  a  d c
    1  2  1  3 2
    2 -2  1  3 2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:55:54.907

将来，请在您要呈现给我们的任何对象上使用 dput()，这样我们就不必手动输入您的示例来编写代码。

你是 SAS 程序员吗？您不需要在每行后加分号...

```
raw <- data.frame(
    grp=c("grp1","grp1","grp0","grp0","grp0"),
    b=c(2,-2,2,1,1),
    a=rep(1,5),
    id=c("id3","id1","id4","id0","id2"),
    d=rep(3,5),
    c=rep(2,5)
)
groups <- split(raw, raw$grp) 
```

你实际上非常接近。我建议阅读`?`[``和之间的区别`?`[[``。这是您更正的代码：

```
x <- list()
for(i in 1:length(groups)) {       
x[[i]] <- subset(as.data.frame(groups[[i]]), select = c(a,b,c,d));     
  } 
names(x) <- names(groups)
x 
```

话虽如此，请尝试学习 ?lapply 功能

```
lapply(groups, function(.groups) .groups[,c("a","b","c","d")]) 
```

# php - 平面文件中的数据库

> ID：11659827
> 
> 赞同：1
> 
> 时间：2012-07-25T22:49:00.687
> 
> 标签：php, database, file

我正在创建一个网络应用程序，我必须将所有数据存储在文件中（而不是 MySQL）。现在我有几个问题：

1.  哪种结构更好/更有效：DOM 结构（XML 文件）或普通文本文件（数据将由定义的分隔符分隔）。
2.  如果是文本文件，我应该使用哪些分隔符？
3.  如果我有很多文章，我应该将所有这些都保存在一个文件中，还是每篇文章一个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:59:09.803

这是我掌握的关于您的 3 个子问题的最佳信息。

1) XML 文件将允许您利用 XSLT 和 XPath 等其他工具来搜索和操作您的数据。它将以牺牲大小和性能为代价（如果大小是可管理的，这可能没什么大不了的。如果您想将新数据添加到后续行而不是重新处理旧数据（您可以在每行的开头使用格式版本号来实现这一点，但您的代码可能会很快变得丑陋）。

2) 坚持有效，CSV 得到了很好的[库的支持](http://opencsv.sourceforge.net/)

3）你有两个限制在这里考虑。

文件大小）文件的最大大小（取决于文件系统）以及大文件对以后备份或拆分数据的影响。

文件数量）一个文件夹中可以拥有的文件数量有上限（同样取决于文件系统，但有限制）

我倾向于每个资产 1 个文件。如果可以将数据拆分为可管理的块，则可以更轻松地解决许多其他问题。同样与 Mike 的回答一致，当您不需要 XSLT 或 XPath 之类的能力时，JSON 是一种更好的序列化形式。这很容易推理并且更小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T22:52:16.930

您可以考虑使用 JSON 作为文本文件中的序列化，因为它允许您存储更复杂的数据关系。

话虽如此。如果您希望您的系统有任何类型的负载，那么读取和写入文本文件将是疯狂的扩展。

如果您仅限于使用其他评论中提到的文件系统 SQLite 可能是您最好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T23:03:56.277

如前所述... JSON ...

除了复杂的数据，使用 JSON，您还可以使用 javascript（及其框架，如 jquery 或 extjs ）来处理客户端的数据......在我看来这是一个大目标

# android - SIP注册失败

> ID：11659834
> 
> 赞同：3
> 
> 时间：2012-07-25T22:50:08.460
> 
> 标签：android, sip

我遇到了 SIP API 的问题。我正在遵循 d.android.com 上的指南，并从[sip2sip.info](http://developer.android.com/guide/topics/connectivity/sip.html)获得了一个免费的 SIP 帐户来测试我的应用程序。*更新：*我试过 ekiga.net 并且我自己也设置了一个 Kamailio 服务器，但这些也没有帮助。

每当我尝试注册我的个人资料时，它都会失败并显示错误消息“0”。这是代码：

```
package com.mysys.mysip;

import java.text.ParseException;

import android.net.sip.SipException;
import android.net.sip.SipManager;
import android.net.sip.SipProfile;
import android.net.sip.SipRegistrationListener;
import android.os.Bundle;
import android.app.Activity;
import android.app.PendingIntent;
import android.content.Intent;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity {
    public SipManager mSipManager = null;
    public SipProfile mSipProfile = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        if (mSipManager == null) {
            mSipManager = SipManager.newInstance(this);
        }

        Button connectButton = (Button) findViewById(R.id.buttonConnect);
        connectButton.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                buildProfile();
                if (mSipProfile != null) {
                    openProfile();
                }
            }
        });
    }

    public void buildProfile() {
        try {
            SipProfile.Builder builder = new SipProfile.Builder("censored", "sip2sip.info");
            builder.setPassword("censored");
            mSipProfile = builder.build();
        } catch (ParseException e) {
            Log.e("SipProfile.Builder", "Parse error!");
            e.printStackTrace();
        }
    }

    public void openProfile() {
        Intent intent = new Intent();
        intent.setAction("com.mysys.sip.INCOMING_CALL");
        PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, intent, Intent.FILL_IN_DATA);

        SipRegistrationListener listener = new SipRegistrationListener() {
            @Override
            public void onRegistering(String localProfileUri) {
                Log.i("SIP Registration", "Registering.");
                updateStatus("Registering...");
            }

            @Override
            public void onRegistrationDone(String localProfileUri, long expiryTime) {
                Log.i("SIP Registration", "Done!");
                updateStatus("Registered! Yay!");
            }

            @Override
            public void onRegistrationFailed(String localProfileUri, int errorCode, String errorMessage) {
                Log.e("SIP Registration", "Failed! URI: " + localProfileUri + " Reason: " + errorMessage);
                updateStatus("Registration failed.");
            }
        };

        try {
            mSipManager.open(mSipProfile, pendingIntent, null);
            mSipManager.setRegistrationListener(mSipProfile.getUriString(), listener);
        } catch (SipException e) {
            e.printStackTrace();
        }
    }

    public void updateStatus(final String status) {
        this.runOnUiThread(new Runnable() {
            public void run() {
                TextView statusView = (TextView) findViewById(R.id.textViewStatus);
                statusView.setText(status);
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case R.id.menu_settings:
                Intent intent = new Intent(this, SettingsActivity.class);
                startActivity(intent);
        }
        return super.onOptionsItemSelected(item);
    }
} 
```

与 Android SDK 自己的演示相比，我检查了两次代码，但一无所获。在询问之前我也进行了搜索，我发现唯一相关的是将协议设置为 TCP，但它并没有解决我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T08:07:49.150

您可以尝试其他免费服务 sip，例如[https://www.linphone.org/eng/linphone/register-a-linphone-account.html](https://www.linphone.org/eng/linphone/register-a-linphone-account.html)并对其进行测试，它通过 sip 帐户 linphone 对我有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T05:15:58.700

您是否检查了以下函数是否返回 true：

`isVoipSupported()`和`isApiSupprted()`。还要检查您的 SIP 帐户是否正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-29T13:35:44.823

```
builder.setPort(5060);
builder.setProtocol("TCP");
builder.setOutboundProxy("proxy.sipthor.net");
me = builder.build(); 
```

# java - 基于逻辑构造对象类型——这可以做到吗？

> ID：11659838
> 
> 赞同：3
> 
> 时间：2012-07-25T22:50:59.777
> 
> 标签：java, object, subclass, abstract

我希望有人能引导我朝着正确的方向前进。我似乎无法在任何地方找到解决此问题的适当方法。

我有一个**名为***`Student`*. 三个外部类扩展了学生。这些被称为`Graduate`,`Undergraduate`和`PartTime`。在我的主要方法中，我想根据某些逻辑将对象构造为研究生、本科生或兼职。例如：

```
if (something) { Graduate student = new Graduate(); }
else if (something { Undergraduate student = new Undergraduate(); } 
```

如果我尝试这个，编译器（我正在使用 Netbeans）会抱怨对象 student 已经被定义。如果我试试这个：

```
Student student;
if (something) { student = new Graduate(); } 
```

学生无法访问特定于研究生的任何方法。

如果我让三个扩展类成为学生的内部静态类，会有什么改变吗？

希望问题很清楚。关于如何解决这个问题的任何建议？任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:57:59.680

你可以这样做：

```
Student student;
if (something) {
  Graduate graduate = new Graduate();
  graduate.visitMissisRobinson( );

  student = graduate;
}
else if (somethingElse) {
  Undergraduate undegradStudent = new Undergraduate();

  undegradStudent.declareMajor( );

  student = undegradStudent;
}

// now only do common methods of student
student.chargeTuition( ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:05:09.203

如果您想更深入地阅读有关该主题的内容，请查找一些工厂模式：

[工厂模式](http://www.allapplabs.com/java_design_patterns/factory_pattern.htm)

# php - 任何人都可以带我去定义正则表达式的断言文档吗？

> ID：11659841
> 
> 赞同：2
> 
> 时间：2012-07-25T22:51:11.173
> 
> 标签：php, regex, assertions

我偶然发现[了 nikic 的一篇不错的博客文章，](http://nikic.github.com/2012/06/15/The-true-power-of-regular-expressions.html)标题*为正则表达式的真正力量*。我看到他的正则表达式使用 DEFINE 断言创建一个正则表达式，以符合 RFC 的方式匹配电子邮件。命名的捕获很好，但我真正想知道的是关于 DEFINE 断言的一些文档。简化示例：

```
/(?(DEFINE)(?<NUM>[0-9]))^(?&NUM)$/ 
```

快速搜索我的*精通正则表达式*这本书并没有快速得出任何结果。谷歌让我空手而归，用 ideone 在线测试导致结果，即 DEFINE 很可能是定义断言的一些关键字，因为我不能用例如 FOOBAR 替换这个词。;-) 指向 ideone 测试的链接：[匹配](http://ideone.com/eNDqz)与[不匹配](http://ideone.com/plXWY)

非常感谢任何解释、搜索关键字、提示或指向一些不错的文档的链接。提前致谢。:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T00:02:10.453

`(DEFINE)`作为定义命名子模式的一种方式。在上面的示例中，您正在定义`NUM`子模式，然后使用它`(?&NUM)`。在 nikic 的链接示例中，一大堆命名的子模式是相互定义的，它们累积在`?&addr_spec`.

如您所见，搜索“定义”一词并不容易。我找到了一些参考资料来帮助您入门：

*   [Perl 语言参考](http://perldoc.perl.org/perlre.html#%28R%29)
*   [Perl 正则表达式教程](http://perldoc.perl.org/perlretut.html#Defining-named-patterns)
*   [Gnome 正则表达式详细信息](http://developer.gnome.org/glib/2.28/glib-regex-syntax.html#id394021)
*   [在正则表达式中定义语法](http://www.effectiveperlprogramming.com/blog/1479)

# c - 如何在 C 中的 8 个皇后程序的二维数组上放置一个字符

> ID：11659842
> 
> 赞同：1
> 
> 时间：2012-07-25T22:51:23.707
> 
> 标签：c, arrays, 2d

我正在尝试开发[8 个皇后谜题](http://en.wikipedia.org/wiki/Eight_queens_puzzle)的解决方案，其中 8 个皇后应该放在一个 8x8 棋盘上，这样没有两个皇后可以互相攻击。我可以打印出我的“#”板，但不知道如何在第一个位置放置一个皇后，并使所有水平、垂直和对角线点成为“x”。

这是我到目前为止所拥有的：

```
#include <stdio.h>
#include <ctype.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>

#define ROW 8
#define COL 8

// Make the chessboard

int main(int argc, char * argv[])
{
    char board[ROW][COL];
    int i, j;

    for(i = 0; i < ROW; i++)
    {
        for(j = 0; j < COL; j++)
        {
            board[i][j] = '#';
            printf(" %c", board[i][j]);
        }
        printf("\n");
    }
    return 0;
}

// Place queen on first '#'

int placeQueen(char board[ROW][COL])
{
    char queenSpace;
    int i, j;

    for(i = 0; i < ROW; i++)
    {
        for(j = 0; j < COL; j++)
        {
            queenSpace = 'Q';
            board[i][j] = queenSpace;
            printf(" %c", board[1][1]);
        }
        printf("\n");
    }
    return 0;
} 
```

现在的输出在左边，我需要它如右图所示：

```
# # # # # # # #            Q x x x x x x x
# # # # # # # #            x x # # # # # #
# # # # # # # #            x # x # # # # #
# # # # # # # #            x # # x # # # #
# # # # # # # #            x # # # x # # #
# # # # # # # #            x # # # # x # #
# # # # # # # #            x # # # # # x #
# # # # # # # #            x # # # # # # x 
```

这是我的算法：

1.  创建一个包含所有“#”的 8x8 数组。
2.  将皇后放在第一个可用的“#”上。
3.  将所有水平、垂直和对角方块从皇后位置更改为“x”。
4.  将另一个皇后放在第一个位置，即“#”。
5.  将所有水平、垂直和对角方块从新的皇后位置更改为“x”。
6.  重复步骤 4-5 直到没有更多可用的“#”。
7.  如果 > 7 个皇后，打印数组并再次运行。
8.  如果 <= 7 个皇后，则再次运行，但在第二个皇后的位置标有“#”并重复步骤 4-5。
9.  如果 > 7 个皇后，打印数组并再次运行。
10.  如果 <= 7 个皇后，重复第 8 步，直到第二个皇后行中不再​​有“#”。
11.  如果第二个皇后行中没有更多的“#”，则从该行释放内存。
12.  重复第 8 步，但要换到第 3 个皇后的位置。
13.  重复步骤 8 - 11，但对于第四个皇后的位置。等等。
14.  如果没有更多解决方案，请重复步骤 2-13，但在这次第一个皇后所在的位置标记“#”。
15.  重复第 14 步，直到第一行不再有“#”。

我从来没有使用二维数组做过任何工作或程序，所以任何帮助甚至示例代码都将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T00:18:36.630

一些提示。抽象您的主要数据类型：

```
#define ROW 8
#define COL 8
typedef char t_board[ROW][COL];
#define ItRows(Var) for (int Var = 0; Var < ROW; Var++)
#define ItCols(Var) for (int Var = 0; Var < COL; Var++)
#define EMPTY  '+'
#define QUEEN  'Q'
#define ATTACK '-'

#define bool int
#define true 1
#define false 0 
```

然后您可以简化要对数据类型执行的操作声明，并专注于单个步骤的逻辑：

```
void init(t_board board) {
   ItRows(r)
       ItCols(c)
           board[r][c] = EMPTY;
}
void show(t_board board) {
   ItRows(r) {
       ItCols(c)
           printf(" %c", board[r][c]);
       printf("\n");
   }
}
void assign(t_board target, const t_board source) {
   ItRows(r)
       ItCols(c)
           target[r][c] = source[r][c];
}
bool reserve(t_board board, int row, int col, char cell) {
    if (board[row][col] == QUEEN)
        return false;
    board[row][col] = cell;
    return true;
}
bool place_queen(t_board board, int row, int col) {
   ItRows(r)
       if (r != row && !reserve(board, r, col, ATTACK))
           return false;
    ItCols(c)
       if (c != col && !reserve(board, row, c, ATTACK))
           return false;

    #define AttackDiag(R, C) \
       for (int r = row + R, c = col + C; r >= 0 && c >= 0 && r < ROW && c < COL; r += R, c += C) \
          if (!reserve(board, r, c, ATTACK)) \
              return false;
    AttackDiag(+1, +1)
    AttackDiag(+1, -1)
    AttackDiag(-1, +1)
    AttackDiag(-1, -1)

    return reserve(board, row, col, QUEEN);
}
int main_queens(int argc, char **argv) {
    t_board b;
    init(b);
    assert(place_queen(b, 3, 2));
    show(b);
    return 0;
} 
```

# java - Jackson - 反序列化通用类变量

> ID：11659844
> 
> 赞同：30
> 
> 时间：2012-07-25T22:51:32.943
> 
> 标签：java, json, jackson, generics

我错误地发布了这个问题。我在这里正确地发布了问题......

我得到一个 json 字符串作为 HTTP 响应。我知道它的结构。如下：

```
public class Json<T> {
    public Hits<T> hits;
}
public class Hits<T> {
    public int found;
    public int start;
    public ArrayList<Hit<T>> hit;
}
public class Hit<T> {
    public String id;
    public Class<T> data;
} 
```

“数据”字段可以属于任何类。我只会在运行时知道它。我会把它作为参数。这就是我反序列化的方式。

```
public <T> void deSerialize(Class<T> clazz) {
    ObjectMapper mapper = new ObjectMapper();
    mapper.readValue(jsonString,  new TypeReference<Json<T>>() {});
} 
```

但我收到一个错误 -

无法从 java.lang.class 访问私有 java.lang.class.Class()。未能设置访问权限。无法使 java.lang.Class 构造函数可访问

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-27T19:27:44.637

`JavaType`如果泛型类型仅动态可用，则需要显式构建：

```
// do NOT create new ObjectMapper per each request!
final ObjectMapper mapper = new ObjectMapper();

public Json<T> void deSerialize(Class<T> clazz, InputStream json) {
    return mapper.readValue(json,
      mapper.getTypeFactory().constructParametricType(Json.class, clazz));
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-01-20T13:06:35.227

示例通用反序列化接口：

```
public interface Deserializable<T> {
    static final ObjectMapper mapper = new ObjectMapper();

    @SuppressWarnings("unchecked")
    default T deserialize(String rawJson) throws IOException {
        return mapper.readValue(rawJson, (Class<T>) this.getClass());
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T12:22:25.887

您正在将 Class 对象序列化和反序列化为 JSON？也许在 Hit 中将其保留为 String 并创建启动 Class.forName 的额外 getter，例如

```
public class Hit {
    public String id;
    public String data;
    public Class<?> getDataClass() throws Exception {
       return Class.forName(data);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-20T08:01:10.057

需要反序列化的 JSON 字符串必须包含有关参数的类型信息`T`。
您必须在可以作为参数传递`T`给类的每个类上放置 Jackson 注释，以便 Jackson可以从 JSON 字符串读取/写入`Json`有关参数类型的类型信息。`T`

让我们假设它`T`可以是任何扩展抽象类的类`Result`。

```
public class Json<T extends Result> {
    public Hits<T> hits;
}

@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.WRAPPER_OBJECT)
@JsonSubTypes({
        @JsonSubTypes.Type(value = ImageResult.class, name = "ImageResult"),
        @JsonSubTypes.Type(value = NewsResult.class, name = "NewsResult")})
public abstract class Result {

}

public class ImageResult extends Result {

}

public class NewsResult extends Result {

} 
```

一旦可以作为参数传递的每个类（或其公共超类型）都被注释，Jackson 将在 JSON 中`T` 包含有关参数的信息。`T`然后可以`T`在编译时不知道参数的情况下反序列化此类 JSON。
这个[Jackson 文档链接](https://github.com/FasterXML/jackson-docs/wiki/JacksonPolymorphicDeserialization)讨论了多态反序列化，但对于这个问题也很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-31T11:44:53.243

对我来说，这样的事情适用于类似的情况

```
public <T> T jsonToObject(String jsonContainsObject, Class<T> objectType) {
       ObjectMapper objectMapper = new ObjectMapper();
       try {
         return objectMapper.readValue(jsonContainsObject, objectType);
       } catch (JsonProcessingException e) {
         //Your exception handling
       }
    return null; 
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-26T16:26:49.460

> 反序列化通用类变量
> 
> ...
> 
> 我怎么告诉杰克逊？gson会做得更好吗？

[Gson 用户指南包含](https://sites.google.com/site/gson/gson-user-guide#TOC-InstanceCreator-for-a-Parameterized-Type)关于我理解您正在尝试完成的内容的部分，尽管该文档示例可能仍然不完整。

[在一篇博文中，我更详细地介绍了使用 Gson 1.7.1 的解决方案。](http://programmerbruce.blogspot.com/2011/07/gson-v-jackson-part-3.html#TOC-InstanceCreator-for-a-Parameterized) 下面是相关的代码示例。

使用 Jackson (1.8.2) 的类似（但涉及更多）解决方案也在同一篇博文中进行了演示和描述。（不同的方法和示例使用了数百行代码，所以我在这里省略了重新发布它们。）

```
public class GsonInstanceCreatorForParameterizedTypeDemo  
{  
 public static void main(String[] args)  
 {  
  Id<String> id1 = new Id<String>(String.class, 42);  

  Gson gson = new GsonBuilder().registerTypeAdapter(Id.class,  
    new IdInstanceCreator()).create();  
  String json1 = gson.toJson(id1);  
  System.out.println(json1);  
  // actual output: {"classOfId":{},"value":42}  
  // This contradicts what the Gson docs say happens.  
  // With custom serialization, as described in a  
  // previous Gson user guide section,   
  // intended output may be   
  // {"value":42}  

  // input: {"value":42}  
  String json2 = "{\"value\":42}";  

  Type idOfStringType=new TypeToken<Id<String>>(){}.getType();  
  Id<String> id1Copy = gson.fromJson(json2, idOfStringType);  
  System.out.println(id1Copy);  
  // output: classOfId=class java.lang.String, value=42  

  Type idOfGsonType = new TypeToken<Id<Gson>>() {}.getType();  
  Id<Gson> idOfGson = gson.fromJson(json2, idOfGsonType);  
  System.out.println(idOfGson);  
  // output: classOfId=class com.google.gson.Gson, value=42  
 }  
}  

class Id<T>  
{  
 private final Class<T> classOfId;  
 private final long value;  

 public Id(Class<T> classOfId, long value)  
 {  
  this.classOfId = classOfId;  
  this.value = value;  
 }  

 @Override  
 public String toString()  
 {  
  return "classOfId=" + classOfId + ", value=" + value;  
 }  
}  

class IdInstanceCreator implements InstanceCreator<Id<?>>  
{  
 @SuppressWarnings({ "unchecked", "rawtypes" })  
 public Id<?> createInstance(Type type)  
 {  
  Type[] typeParameters =   
    ((ParameterizedType) type).getActualTypeArguments();  
  Type idType = typeParameters[0];  
  return new Id((Class<?>) idType, 0L);  
 }  
} 
```

# php - 从 MS Tag Rest 保存标签图像

> ID：11659846
> 
> 赞同：0
> 
> 时间：2012-07-25T22:51:49.177
> 
> 标签：php, microsoft-tag

我正在尝试使用 MS Tag Rest Interface (http://tag.ws.suddenelfilio.net/) 创建一些 Microsoft 标签。我有一个 API 密钥并且能够创建标签，不幸的是我真的不知道如何将它保存为图像。我已将“生成条形码”请求的结果保存为图像，大约 280k 大。不幸的是，它似乎不是一个有效的 jped 文件，imagecreatefromstring() 也不起作用。imagecreatefromstring 返回一个

```
"Warning: imagecreatefromstring() [function.imagecreatefromstring]: Data is not in a recognized format". 
```

这是我返回的字符串的一小段：

```
/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAdyCA8DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQID 
```

有人搞定这个吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:02:40.723

这看起来是 base64 编码解码它（使用`base64_decode`），然后再将其传递给`imagecreatefromstring`，或者在解码后保存它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T10:43:12.717

所以在 Musa 的帮助下，我终于想出了如何做到这一点，这是工作代码

谢谢，这是解决这个问题的关键部分。这是我现在工作的代码：

```
$url = 'http://tag.ws.suddenelfilio.net/mstagrest.svc/GenerateQRcode?at={access-token}&cn=Main&tn=Test&it=jpeg&s=1&ht=true';

// Get page content with curl   
$ch = curl_init(); 
curl_setopt($ch, CURLOPT_POST, 0);
curl_setopt($ch, CURLOPT_URL, $url); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
$pagecontent = curl_exec($ch); 
curl_close($ch);

// Decode it    
$pagecontent = base64_decode($pagecontent);
// Create Image
$im = imagecreatefromstring($pagecontent);
// Save as jpeg
header('Content-Type: image/jpeg');
imagejpeg($im, 'image.jpeg');       

imagedestroy($im); 
```

# ruby-on-rails - Rails 和查询：匹配所有关联.attribute == true

> ID：11659849
> 
> 赞同：0
> 
> 时间：2012-07-25T22:52:02.287
> 
> 标签：ruby-on-rails

在 Rails 3 项目中：

我有很多比赛的比赛。每场比赛将有 2 场比赛，比赛正在进行中（真/假）。

我需要所有比赛都没有进行的比赛。

我可以得到一场比赛是假的比赛：

```
scope :confirmed, joins(:competitions).where("pending = ?", false) 
```

但这还不够好。

如果我需要显示更多代码，请告诉我。谢谢你的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T00:11:19.783

如果从对象域可行，您可以创建两个不同名称的 1:1 关联。

如果没有，您可以使用 sql 查询来查找 match_ids：

```
Match.find_by_sql(%q{SELECT * FROM "matches" WHERE id IN (SELECT "match_id" FROM "competitions"  WHERE ("pending" = 'f') GROUP BY "match_id" HAVING COUNT(*) > 1)}) 
```

但这也取决于每场比赛最多有 2 场比赛。

# javascript - JavaScript 的奇怪行为

> ID：11659851
> 
> 赞同：0
> 
> 时间：2012-07-25T22:52:07.623
> 
> 标签：javascript, jquery

如果取消注释`body.children().each(calc_deep(1));`然后我得到`TypeError: Object [object Window] has no method 'attr'`字符串`parseInt(deepest.attr('deep'))`，但没有取消注释你可以检查你可以调用的控制台`deepest.attr('deep')`。那是什么？

```
 var deepest;
    var calc_deep = function(i)
    {
        $(this).attr('deep',i);
        if(i>parseInt(deepest.attr('deep')))
            deepest=this;
        $(this).children().each(calc_deep(i+1));
    }
    var find_deepest = function()
    {
         body=$('body').children().eq(0);         
         body.attr('deep',0);
         deepest=body;
         //body.children().each(calc_deep(1));
    }
    find_deepest(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T22:55:06.873

`each`接受一个函数作为参数，你正在传递它`undefined`——因为你首先调用函数，然后它的返回值就是`each()`得到的。

改为使用`function() {calc_deep(1);}`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:04:09.010

第一个`deepest`是变量`body`，它是一个 jQuery 对象。后来，当你给 deepest 赋值时`this`，它是一个普通的 DOM 元素，没有任何`attr`功能。

你有一个更大的问题 -`this`没有指向你认为的元素。不带参数调用`$(this).children().each(calc_deep);`函数。要获得深度，只需从父级获取。您正在调用函数 calc_deep 并将（不存在的）返回值传递给`each`. 您想将函数本身传递给每个。

```
var deepest, index;
var calc_deep = function() {
    var $this = $(this); //cache jQuery this
    var i = $this.parent().data("deep") + 1;
    $this.data('deep', i);
    if (i > index) {
        deepest = $this;
        index = i;
    }
    $this.children().each(calc_deep);
}
var find_deepest = function() {
    body = $('body').children().eq(0);
    body.data('deep', 0);
    index = 0;
    deepest = body;
    body.children().each(calc_deep);
}
find_deepest(); 
```

[jsFiddle 演示](http://jsfiddle.net/y65Vw/1)

# ruby-on-rails - Formtastic 复选框提交带有空白条目的列表（除了选择的 id）

> ID：11659858
> 
> 赞同：3
> 
> 时间：2012-07-25T22:53:02.430
> 
> 标签：ruby-on-rails, ruby-on-rails-3, select, formtastic

我正在设置一个表格形式，其中许多字段需要“选择所有适用的”选项。（仅供参考，我使用 slim，但如有必要，我可以将其转换回普通导轨）。

例如。我定义了这个输入：

```
 = f.input :categories_list, :label => _("Commonly Found In"), :as => :check_boxes, :multiple => true, :collection => Category.all 
```

这会创建一堆复选框，并且只有存在的复选框才会出现。但是当我选择一个（或两个或三个）时，它会破坏我正在创建的模型的创建，我注意到 category_list 字段提交为：

```
 "categories_list"=>["", "1", "2"], 
```

而不是：

```
 "categories_list"=>["1", "2"], 
```

有人知道为什么吗？这是formtastic的错误吗？如果我应该发布更多相关代码，请告诉我。我真的很想知道如何使这项工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T06:28:52.717

这是为了允许清除所有选择。如果数组开头没有空白/空值，浏览器根本不会设置`categories_list`参数，并且现有的复选框将保持选中状态。

`categories_list`如果未设置，您将不知道用户的意图。

如果它不适合您，您只需要从控制器或模型中的参数中过滤掉这个空白选项（但我建议您在关闭它之前尝试在编辑时复制问题）。

# php - PHP 正则表达式删除 +X%

> ID：11659861
> 
> 赞同：0
> 
> 时间：2012-07-25T22:53:13.347
> 
> 标签：php, regex

我有像这样的字符串

```
+200% just string
+20% other string
+350% other etc .. 
```

我需要一个正则表达式来删除`+X%`并仅获取以下字符串。我试过了

```
echo trim(preg_replace("/[+][0-9][%]/","",$str)); 
```

但这给出了与 相同的输出`echo $str`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T22:54:23.587

你需要一个`+`after `[0-9]`，意思是“一个或多个”：

```
preg_replace("/[+][0-9]+%/", "", $str) 
```

# php - 将 2025 位转换为最短文件名

> ID：11659864
> 
> 赞同：1
> 
> 时间：2012-07-25T22:53:54.620
> 
> 标签：php

我有一些由 2025 位表示的信息。出于缓存目的，我需要创建一个唯一的文件名（当然不会太长，所以 fs 会处理这个），它将代表这些位。每组位都应该有唯一的文件名。

md5 适合这个吗？如果没有，我应该使用什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T22:57:24.313

退房[`uniqid()`](http://php.net/uniqid)。如果您是极端偏执狂，请将文件名生成放在一个循环中，检查它是否存在。

```
$prefix   = hash('sha256', $bits) . '-';
$filename = uniqid($prefix, true); 
```

这将创建位的 SHA-256 哈希作为文件的前缀，并用于`uniqid`创建唯一的文件名，文件的前缀是位的哈希，后跟`-`.

这应该生成一个唯一的文件名，您可以通过散列位来识别该文件名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:58:13.310

您可以使用位的[Base64 编码](http://en.wikipedia.org/wiki/Base64)。这将保证名称的唯一性。

# c# - SharpSVN SvnClient.Add() 中是否存在目录错误？

> ID：11659867
> 
> 赞同：1
> 
> 时间：2012-07-25T22:54:07.270
> 
> 标签：c#, .net, svn, sharpsvn

我正在尝试使用 SharpSVN 自动化 Subversion 签入，但我遇到了 SvnClient.Add() 方法的问题，我相信这可能是一个错误。本质上， .Add() 没有将路径视为工作副本，但是 SvnClient.GetUriFromWorkingCopy() 认为它很好。似乎 .Add() 看起来比它应该高 1 个目录，我似乎无法通过使用 .Add() 来欺骗 .Add() 。或者 ..

我的代码证明如下。通过将路径指向工作副本的顶层并运行来复制。任何帮助表示赞赏！

```
 static void Main(string[] args)
    {
        string PathToTest = @"C:\temp\sqlcompare";

        SvnClient client = new SvnClient();

        SvnAddArgs saa = new SvnAddArgs();
        saa.Force = true;
        saa.Depth = SvnDepth.Infinity;

        Console.WriteLine(PathToTest);
        Console.WriteLine(client.GetUriFromWorkingCopy(PathToTest));

        try
        {
            client.Add(PathToTest, saa);
            Console.WriteLine(@"Success");
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }

        Console.ReadKey();

    } 
```

这产生的输出：

```
C:\temp\sqlcompare
https://thisismycompanyname.svn.cvsdude.com/project/soltuionname/trunk/Database/
'C:\temp' is not a working copy 
```

添加尾部斜杠也不起作用：

```
C:\temp\sqlcompare\
https://thisismycompanyname.svn.cvsdude.com/project/soltuionname/trunk/Database/
'C:\temp' is not a working copy 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:40:55.897

在本地路径成为工作副本之前，您需要一个 .Checkout() 调用（或与另一个客户端进行一些结帐）。您只能将目录添加到现有工作副本。

SharpSvn 中这条规则的唯一小例外是 SvnClient.Import()，它实际上是 'svn import' (SvnClient.RemoteImport) 后跟 'svn checkout --force'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T14:01:42.017

`SharpSvn.SvnDepth`文档在这一点上还不清楚，但是如果您查看枚举，您可以做出一些有根据的猜测。目前没有办法调用`SvnClient.Add(targetPath)`并让它尝试添加 targetPath ( `targetPath/*`) 的所有子项。**为此应该有一个 SvnDepth。**

我的另一个烦恼是 Add 似乎没有应用工作副本的忽略列表。

所以为了做你想做的事，我建议如下：

```
private void RecursiveAdd(SvnClient client, string targetPath, List<string> ignoreList)
{
    foreach (var fileEntry in Directory.EnumerateFileSystemEntries(targetPath))
    {
        if (ignoreList.Any(fileEntry.Contains))
            continue;

        Runtime.ActiveLog.Info(fileEntry);
        client.Add(fileEntry, new SvnAddArgs()
                                    {
                                        Depth = SvnDepth.Empty,
                                        Force = true
                                    });

        if (Directory.Exists(fileEntry))
            RecursiveAdd(client, fileEntry, ignoreList);
    }
}

public AddPath(string targetPath)
{
    using (var client = new SvnClient())
    {
        var ignoreList = GetIgnore(targetPath);
        RecursiveAdd(client, targetPath, ignoreList);
    }
} 
```

它仍然需要错误处理和一般代码改进（例如围绕忽略列表），但它应该明白这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-02T18:35:42.867

这对我有用。它应该将您本地签出的文件夹与 SVN 中的文件夹同步：

```
string _localCheckoutPath = @"C:\temp\sqlcompare";
SvnClient client = new SvnClient();

Collection<SvnStatusEventArgs> changedFiles = new Collection<SvnStatusEventArgs>();
client.GetStatus(_localCheckoutPath, out changedFiles);

//delete files from subversion that are not in filesystem
//add files to suversion , that are new in filesystem

foreach (SvnStatusEventArgs changedFile in changedFiles)
{
    if (changedFile.LocalContentStatus == SvnStatus.Missing)
    {
        client.Delete(changedFile.Path);
    }
    if (changedFile.LocalContentStatus == SvnStatus.NotVersioned)
    {
        client.Add(changedFile.Path);
    }
}

SvnCommitArgs ca = new SvnCommitArgs();
ca.LogMessage = "Some message...";

client.Commit(_localCheckoutPath, ca); 
```

# android - 每天设置五个警报并通过单击按钮更新它们

> ID：11659869
> 
> 赞同：2
> 
> 时间：2012-07-25T22:54:16.797
> 
> 标签：android, android-alarms

如果这是一个菜鸟问题，请原谅。我已经尝试了每天从五个编辑文本中设置五个警报的所有可能性。但是没有任何效果！我还有一个按钮（此代码中未显示），它更新这些编辑文本（因此也应该更新警报时间）。这是我的代码：

```
for (int i = 0; i < 5; i++) {
            switch (i) {
            case 0:
                fajr.setText(result[i]);
                tFajr = new GregorianCalendar();
                tFajr.set(year, month, day,
                        Integer.parseInt(result[i].substring(0, 2)),
                        Integer.parseInt(result[i].substring(3, 5)));
                break;
            case 1:
                zuhr.setText(result[i]);
                tZuhr = new GregorianCalendar();
                tZuhr.set(year, month, day,
                        Integer.parseInt(result[i].substring(0, 2)),
                        Integer.parseInt(result[i].substring(3, 5)));
                break;
            case 2:
                asr.setText(result[i]);
                tAsr = new GregorianCalendar();
                tAsr.set(year, month, day,
                        Integer.parseInt(result[i].substring(0, 2)),
                        Integer.parseInt(result[i].substring(3, 5)));
                break;
            case 3:
                maghrib.setText(result[i]);
                tMaghrib = new GregorianCalendar();
                tMaghrib.set(year, month, day,
                        Integer.parseInt(result[i].substring(0, 2)),
                        Integer.parseInt(result[i].substring(3, 5)));
                break;
            case 4:
                isha.setText(result[i]);
                tIsha = new GregorianCalendar();
                tIsha.set(year, month, day,
                        Integer.parseInt(result[i].substring(0, 2)),
                        Integer.parseInt(result[i].substring(3, 5)));
                break;
            }
        } 
```

PS：fajr,zuhr,asr,maghrib,isha 是五个EditTexts。我尝试使用挂起的意图和警报管理器来触发警报，但它没有用。有没有人有好的建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T11:35:36.463

首先，您需要为每个警报声明一个待处理的意图。因此，如果您想要 5 个警报，则需要运行 5 次

```
PendingIntent sender = PendingIntent.getBroadcast(context,intent_code, intent, 0); 
```

并且intent_code 也应该改变。每次您注册一个新的时，您都必须使用不同的代码。在我的应用程序中，每次执行时都会生成一个随机数。您还可以使用 Intent 将数据传递到此处的通知槽。注意 Intent 和 PendingIntent 之间的区别。

```
Intent intent = new Intent(context, AlarmReceiver.class);
intent.putExtra("title", "some title");
intent.putExtra("notes","some notes");
Random r = new Random();
intent_code = r.nextInt();
PendingIntent sender = PendingIntent.getBroadcast(context,intent_code, intent, 0); 
```

之后，您需要注册您的闹钟。再次 5 次，每个要触发的警报一次。

```
AlarmManager am = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
am.set(AlarmManager.RTC_WAKEUP, Time_in_milis_from_now_till_your_alarm, sender); 
```

您需要一个 BroadcastReceiver 来接收您的警报并显示通知。我正在粘贴我的整个班级。这将在**Time_in_milis_from_now_till_your_alarm**中设置的时间之后触发。你可以在这里运行任何你喜欢的东西。我不知道你想要什么样的警报，就我而言，我正在使用通知。[您可以在此处](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)和[此处](http://developer.android.com/reference/android/app/Notification.html)找到有关通知的详细信息。

```
public class AlarmReceiver extends BroadcastReceiver {

    @Override
     public void onReceive(Context context, Intent intent) {
        Log.d("receiver", "received");
        NotificationManager mManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);
        Bundle b = intent.getExtras();

        int icon = R.drawable.icon; // icon from resources
        CharSequence tickerText = b.getString("title"); ; // ticker-text
        long when = System.currentTimeMillis(); // notification time
        CharSequence contentText = b.getString("notes");; // message text
        Toast.makeText(context, tickerText, Toast.LENGTH_SHORT).show();

        Intent notificationIntent = new Intent(context, AppDelegate.class);

        // notificationIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        PendingIntent contentIntent = PendingIntent.getActivity(context, 
                                                                0, 
                                                                notificationIntent,
                                                                Intent.FLAG_ACTIVITY_NEW_TASK);

        // the next two lines initialize the Notification, using the
        // configurations above
        Notification notification = new Notification(icon, tickerText, when);
        notification.setLatestEventInfo(context,tickerText, contentText, contentIntent);

        mManager.notify(12, notification);
     }

} 
```

最后，不要忘记在清单中声明您的广播，否则它将无法正常工作。这进入应用程序标签。

如果您对警报管理器方法有任何问题，您可以在[此处](http://developer.android.com/reference/android/app/AlarmManager.html)找到文档。

一切顺利！

**编辑**

要播放声音，请使用开发人员指南推荐的 MediaPlayer。将文件 mysound.mp3 保存在您的文件夹 /res/raw 中。您只需在 BroadcastReceiver 中调用以下方法！

```
public void playSound() {                
     MediaPlayer sound = MediaPlayer.create(this, R.raw.mysound);
     sound.setOnCompletionListener(new OnCompletionListener() {
     @Override
     public void onCompletion(MediaPlayer mp) {
            mp.release();
     }

     });

    quadrantChangeSound.start();
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:08:27.957

在我看来，您正在尝试`AsyncTask`按照@Rafael_T 的建议执行此操作。您需要做的是使用[`AlarmManager`](http://developer.android.com/reference/android/app/AlarmManager.html)它并在警报响起时发送广播供您处理。[这](http://justcallmebrian.com/?p=129)是一个关于如何做到这一点的好教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T00:34:37.407

我开发了一些类似的应用程序。

我使用了一个 AlarmManger 来解决这个问题，它工作得很好。为了设置起床日期，我创建了一个日历对象。如果您想设置第二天的闹钟，则必须添加 24 小时。

这是您获得时间的方式：

```
Calendar calNew = Calendar.getInstance();
        calNew.set(Calendar.HOUR_OF_DAY, hour);
        calNew.set(Calendar.MINUTE, minute);
        calNew.set(Calendar.SECOND, 0);

        Calendar calNow = Calendar.getInstance();
        // Get the AlarmManager service
        if (calNew.getTimeInMillis() < calNow.getTimeInMillis()) {
            calNew.add(Calendar.HOUR_OF_DAY, 24);
        } 
```

这就是设置 AlarmManager 的方式：

```
// INTENT AND ALARMMANAGER PLANING
    Intent intent = new Intent(context, AlarmReceiver.class);

    sender = PendingIntent.getBroadcast(context, INTENT_CODE, intent,
            PendingIntent.FLAG_UPDATE_CURRENT);

    am = (AlarmManager) getSystemService(ALARM_SERVICE);
    am.set(AlarmManager.RTC_WAKEUP, calNew.getTimeInMillis(), sender); 
```

# java - 如何将命令从 bash 发送到 java 程序？

> ID：11659873
> 
> 赞同：2
> 
> 时间：2012-07-25T22:54:36.473
> 
> 标签：java, bash

所以现在我`java -Xms${ram}M -Xmx${ram}M -jar craftbukkit.jar`用来运行craftbukkit.jar。

我想要做的是向`stop`正在运行的服务器发送一个命令。它在命令行中运行。

我试过做：

```
java -Xms${ram}M -Xmx${ram}M -jar craftbukkit.jar
stop 
```

`stop`但这只有在我手动输入并且服务器程序停止后才会执行。

我怎样才能让它将`stop`命令发送到服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:39:47.773

这应该可以解决问题：

```
echo stop | java -Xmx1024M -Xms1024M -jar craftbukkit.jar > /dev/null 
```

# java - Google App Engine 计费监视器

> ID：11659875
> 
> 赞同：1
> 
> 时间：2012-07-25T22:54:46.327
> 
> 标签：java, api, google-app-engine, monitoring, billing

我想为我的 GAE 应用程序构建一个简单的应用程序监视器，当我达到计费上限的某些标记（80%、85%、90%、95%、98% 和 100%）时，它会向我发送电子邮件。因此，如果我在某一天的账单上限是 50 美元，那么当我分别达到 40 美元、42.5 美元、45 美元、47.5 美元、49 美元和 50 美元时，我就会收到电子邮件。这个监视器的目的是（显然）提醒我，在我的应用程序关闭之前，我可能需要增加我的计费上限或为某种故障转移事件做准备。

在我开始编写自己的监视器之前，我想知道 GAE 是否具有开箱即用的这种功能。他们的文档中似乎没有任何内容表明他们这样做。

如果他们不提供这样的服务，GAE 是否会公开某种我可以访问的安全 API（例如`public double getPercentBillingCeiling()`，等）？如果没有，是否有任何 GAE 大师知道我可以使用什么来自动收集此类信息？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T00:25:51.210

目前没有允许您访问配额的程序化服务。然而，这听起来像是一个完全合理的功能请求（或一组功能请求）。您可能希望为[问题跟踪器](http://code.google.com/p/googleappengine/issues/list)中的任何现有功能加注星标（[这](http://code.google.com/p/googleappengine/issues/detail?id=655)可能符合要求），或者如果您的特定要求未得到满足，则提交一个新功能。

# compiler-construction - ocaml 的编译器文档

> ID：11659878
> 
> 赞同：1
> 
> 时间：2012-07-25T22:54:52.193
> 
> 标签：compiler-construction, ocaml

有没有人尝试为 ocaml 的编译器构建 ocamldoc 的文档？

最近阅读源代码树，我可以大致了解它是如何工作的，但是如果有一些文档会很棒，因为我担心我可能会错过一些东西。英语或法语对我来说都可以

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:18:00.057

[http://www.seas.upenn.edu/~hongboz/hongbo_zhang_files/typing.docdir/index.html](http://www.seas.upenn.edu/~hongboz/hongbo_zhang_files/typing.docdir/index.html) 代码被保留，所以你可以在旅行时阅读编译器的源代码树

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T08:24:33.273

我在源代码树中看到的唯一 ocamldoc 注释（它们以某些格式开头`(**`并遵循某些格式）位于 ocamlbuild/、ocamldoc/ 和 stdlib/ 中。

特别是在 asmcomp/, asmrun/, bytecomp/, parsing/...中没有这样的注释

因此，根据您对 ocaml 编译器的哪个部分感兴趣，ocamldoc 文档可能不存在。

这似乎很有趣：[http](http://rwmj.wordpress.com/2009/08/04/ocaml-internals/) ://rwmj.wordpress.com/2009/08/04/ocaml-internals/但适用于初学者，你可能不再是了。

# c - 理解一个函数。pcap 和 BPF

> ID：11659880
> 
> 赞同：0
> 
> 时间：2012-07-25T22:55:05.633
> 
> 标签：c, tcp, network-programming, pcap

在我尝试制作一个可以接收确认并创建连接的 TCP 程序时，我在一个示例程序中遇到了这个函数：

```
void *pth_capture_run(void *arg)
{
pcap_t *pd;
char *filter = "dst host 172.17.14.90 and ip";
char *dev = "fxp0";
char errbuf[PCAP_ERRBUF_SIZE];
bpf_u_int32 netp;
bpf_u_int32 maskp;
struct bpf_program  fprog;                  /* Filter Program   */
int dl = 0, dl_len = 0;

if ((pd = pcap_open_live(dev, 1514, 1, 500, errbuf)) == NULL) {
    fprintf(stderr, "cannot open device %s: %s\n", dev, errbuf);
    exit(1);
}

pcap_lookupnet(dev, &netp, &maskp, errbuf);
pcap_compile(pd, &fprog, filter, 0, netp);
if (pcap_setfilter(pd, &fprog) == -1) {
    fprintf(stderr, "cannot set pcap filter %s: %s\n", filter, errbuf);
    exit(1);
}
pcap_freecode(&fprog);
dl = pcap_datalink(pd);

switch(dl) {
    case 1:
        dl_len = 14;
        break;
    default:
        dl_len = 14;
        break;
}

if (pcap_loop(pd, -1, raw_packet_receiver, (u_char *)dl_len) < 0) {
    fprintf(stderr, "cannot get raw packet: %s\n", pcap_geterr(pd));
    exit(1);
}
} 
```

现在我收集到这个函数会打开一个 BPF 设备并设置数据包过滤器，然后等待数据包到达。然而，作为网络编程的新手，我对各种 pcap 函数并不熟悉，并且对于这个函数简单来说是做什么以及它是如何做的仍然有点不清楚。我已经完成了这个教程：http: [//yuba.stanford.edu/~casado/pcap/section1.html](http://yuba.stanford.edu/~casado/pcap/section1.html) 但我还是有点困惑。你们中的任何人都可以用更简单的术语解释一下吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:49:57.453

似乎您已经弄清楚了该功能，至少在逻辑上，对于第一个 if 语句，它会尝试打开您正在收听的设备并在失败时打印错误，第二个在它之后设置 pcap 过滤器已编译。

如果您想了解更多关于特定函数及其参数的信息，您应该只看一下手册页，例如

> 人 pcap_open_live

# regex - 机器人的通用 IP 重定向

> ID：11659891
> 
> 赞同：0
> 
> 时间：2012-07-25T22:56:08.353
> 
> 标签：regex, redirect, ip, rewrite

我帮助管理数百个网站，我们经常收到所有者的请求，以防止搜索引擎索引他们网站的 IP 地址。然后我们修改他们的重定向文件以包含以下内容（当然，自定义为他们自己的 IP 地址和域名），提供不允许文件，使其不会被索引：

```
RewriteCond %{HTTP_HOST} ^127\.0\.0\.1$ [NC] 
RewriteRule robots.txt robots_disallow.txt [I,O,L] 
```

这工作正常，但必须为每个 ip 配置，因为它是硬编码的。如何编写一个通用的重写条件以在输入的*任何*ip 地址上运行？我读过你可以进行正则表达式验证，但我还没有看到很多在线文档告诉如何对多个未知数字进行验证。

有人有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T00:55:20.343

您最好使用 301 重定向到站点的实际域名。这可以让蜘蛛了解它们正在抓取的资源的正确位置。所以我通常会在重写规则开始时做这样的事情：

```
RewriteCond %{HTTP_HOST} !^www\.yourdomain\.com$
RewriteRule ^(.*)$ http://www.yourdomain.com/$1 [R=301,L] 
```

这还具有对所有网络流量有用的好处，而不仅仅是蜘蛛。此外，它还将负责将流量引导到您的域.com 到 www.yourdomain.com

# iphone - 在 cocos2d 中通过 ccspritebatchnode 使用粒子效果

> ID：11659898
> 
> 赞同：4
> 
> 时间：2012-07-25T22:57:56.590
> 
> 标签：iphone, cocos2d-iphone, ccparticlesystem

我正在尝试为我的 cocos2d iOS 游戏添加粒子效果。我在向我的精灵添加粒子时遇到问题，因为我的所有精灵都使用 spritebatch 来提高性能。因此，我似乎不能轻易地在我的精灵上使用粒子效果。如果我只是将所有粒子效果保留在我的游戏层上，一切都会正常工作，但我宁愿让每个精灵都跟踪自己的粒子效果。这是我的代码，位于我的播放器类中：

```
-(void)loadParticles  
{    
    shieldParticle = [[CCParticleSystemQuad alloc] initWithFile:@"shieldParticle.plist"];
    shieldParticle.position = self.position;
    [self addChild:shieldParticle];  
} 
```

使用这种技术给我一个错误说

```
CCSprite only supports CCSprites as children when using CCSpriteBatchNode 
```

为了避免这种情况，我创建了一个单独的类particleBase。

在particleBase 类中，我从ccsprite 继承它并有一个iVar 用于跟踪粒子效果：

```
#import "cocos2d.h"
@interface particleBase : CCSprite
{
CCParticleSystem *particleEffect;
}

-(void)setParticleEffect:(NSString *)effectName;
-(void)turnOnParticles;
-(void)turnOffParticles;
@end

#import "particleBase.h"

@implementation particleBase

-(void)setParticleEffect:(NSString *)effectName
{    
    particleEffect = [[CCParticleSystemQuad alloc] initWithFile:effectName];
    particleEffect.active = YES;
    particleEffect.position = self.position;
    [self addChild:particleEffect];
} 
```

当使用这种技术时，我在我的播放器类中尝试了这个：

```
-(void)loadParticles
{    
    shieldParticle = [[particleBase alloc] init];
    [shieldParticle setParticleEffect:@"shieldParticle.plist"];
    [shieldParticle turnOnParticles];
    [shieldParticle setPosition:self.position];
    [self addChild:shieldParticle z:150];      
} 
```

这样做时，我没有收到错误，但粒子也没有显示。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T13:55:49.230

在 sprite 类中为粒子系统添加一个实例变量。然后，当您创建粒子效果时，不要将其添加到精灵本身，而是添加到更高级别的节点。这可能是主要的游戏层或场景，或者您可以简单地使用`self.parent.parent`它来为您提供精灵批处理节点的父节点。

然后在 sprite 类中安排一个更新方法。如果粒子系统不为零，则将其位置设置为精灵的位置。如果需要，加上偏移量。

瞧：

```
-(void) createEffect
{
    particleSystem = [CCParticleSystem blablayouknowwhattodohere];
    [self.parent.parent addChild:particleSystem];
    particleSystem.position = self.position;

    // if not already scheduled:
    [self scheduleUpdate];
}

-(void) removeEffect
{
    [particleSystem removeFromParentAndCleanup:YES];
    particleSystem = nil;

    // unschedule update unless you need update for other things too
    [self unscheduleUpdate];
}

-(void) update:(ccTime)delta
{
    if (particleSystem)
    {
        particleSystem.position = self.position;
    }
} 
```

# unit-testing - 单元测试 setUp/tearDown 是否适用于异步测试？

> ID：11659904
> 
> 赞同：3
> 
> 时间：2012-07-25T22:58:41.993
> 
> 标签：unit-testing, dart

我今天试图在与此类似的场景中使用它：

```
group('some group', (){
  //prints
  setUp(() => print('set up'));

  test('some test', (){
    window.requestLayoutFrame(
      expectAsync0((){
        Expect.isTrue(true);
      })
    );         
  });

  //doesn't print
  tearDown(() => print('tear down'));
}); 
```

在这个例子中，tearDown 回调似乎没有被调用。

当我在单元测试之前放置 tearDown() 函数时，它会被调用，但输出序列不是我所期望的：

```
group('some group', (){
  setUp(() => print('set up'));

  tearDown(() => print('tear down'));

  test('some test', (){
    window.requestLayoutFrame(expectAsync0((){
        print('in unit test');
        Expect.isTrue(true);
    }));     
  });
}); 
```

产量：

```
set up
tear down
in unit test
PASS: some group some test 
```

单元测试不应该在拆除之前输出吗？

SDK 构建 9881

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T02:05:51.227

漏洞。已解决：[http ://www.dartbug.com/4284](http://www.dartbug.com/4284)

# php - 表单隐藏字段贝宝 - 简单

> ID：11659911
> 
> 赞同：0
> 
> 时间：2012-07-25T22:59:20.723
> 
> 标签：php, forms, hidden-field

好的，所以我有一个包含多个字段的表单；公司名称、描述等填写完毕后，点击“预览”，您将进入预览页面，查看您的个人资料的外观，如果您满意，请点击“立即购买”，您将进入paypal 页面，您付款，（IPN 发送到 my/ipn.php 页面）然后返回我的站点/success.php，上面只显示“success blah blah etc”

我的问题是；如何在我的 ipn.php 页面中检索所有表单数据？

你可以用 Sessions 来做，但我确定有隐藏字段的方法，只是 paypal 支付页面妨碍了

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:12:16.517

您最好使用会话或将数据存储在数据库中。表单很容易丢失他们的信息，用户刷新页面并且您遇到麻烦，或者用户单击链接然后信息丢失（除非用户足够精明，可以单击返回，直到正确的页面再次可用）。

会话将允许您很好地操作数据并且您可以引用它。在会话中存储一个唯一的 ID 并将数据保存到数据库中可能会更好——而且你当然知道它不会走路......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:16:08.937

您只能将一个自定义变量传递给贝宝。您可以通过数据库中数据的唯一 ID 并在您的 IPN 侦听器中检索它。

# php - PHP 类打印为纯文本

> ID：11659912
> 
> 赞同：0
> 
> 时间：2012-07-25T22:59:21.737
> 
> 标签：php, pagination

我正在使用我在 Codecanyon 上找到的 Pagination 类，它在虚拟主机 ( XAMPP ) 上创造了奇迹。我刚刚将它上传到该站点的服务器，并且几乎整个类都呈现为包含它的纯文本，而不是被使用，可以这么说。

整个站点都是基于 PHP 的，并且运行良好，但是这个小类只是简单地打印为文本。我真的不知道为什么，我迫切需要尽快找到解决方案。

这是该类中显示的第一个纯文本；

```
phrase=array(); $this->setCurrentPage($currentPage); 
$this->setTotalResults($totalResults); 
$this->setResultsPerPage($resultsPerPage); 
$this->setLanguage($language); 
```

..然后就到了类文件的末尾。

这是类的构造函数中的第一行（并且在纯文本中省略了 $this-> 键..（？）。这是构造函数本身的第一行；

```
function __construct($currentPage,$totalResults,$resultsPerPage=25,$language='en',$pathToLanguageFile='../language/') 
    {
        $this->phrase=array();

        $this->setCurrentPage($currentPage);
        $this->setTotalResults($totalResults); 
```

这是作者在codecanyon上发布的课程链接；[http://codecanyon.net/item/scrolling-pagination-class/113230](http://codecanyon.net/item/scrolling-pagination-class/113230)

我确定这是一些服务器设置，但是哪个/在哪里/为什么？

（我没有发布整个分页课程，因为它已被购买，并且许可证阻止我这样做，尽管我无法想象这是班级的错）

我将非常感谢任何帮助和/或指示。谢谢你。

**编辑** 愚蠢的我没有注意到“<？” 是文件的第一行，而不是“< ?php”。感谢您的评论，对于不必要的问题，我真的很抱歉。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:11:03.947

标签“<？” 在文件的第一行，而不是 '< ?php'。这就是这一切的原因。

# active-directory - ASP.net C# 页面中的自定义 Windows Active Directory 身份验证

> ID：11659915
> 
> 赞同：0
> 
> 时间：2012-07-25T22:59:52.100
> 
> 标签：active-directory, windows-authentication, asp.net-authentication, custom-authentication

我有点希望能够进行混合窗口和表单身份验证。

```
//I want to check the browser the user is using
If(IE || chome)//I know IE and chrome can authenticate without a popup login box
{
    //check windows authentication
    if(generic AD account || AD user doesn't have permissions for this application)
    {
        //Redirect to login page
    }
    else
    {
        //Redirect to main page
    }
}
elsif(IPad || android || Firefox)
{
    //Redirect to login page
} 
```

有没有办法创建一些自定义代码来使用 javascript 获取 Windows AD 身份验证，或者我可以创建自定义 ashx 页面来检查身份验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T23:14:11.633

我没有在代码中找到任何方法来做到这一点。我最终遵循了这个方法 [http://msdn.microsoft.com/en-us/library/ms972958.aspx](http://msdn.microsoft.com/en-us/library/ms972958.aspx) 并稍微修改了它。它通过图形界面对 IIS 中的设置进行了一些更改。我也不想要表单身份验证，因此我将其更改为 None 进行身份验证，我在我的母版页中放置了一些代码来检查 cookie 并重定向到可以使用 javascript 检查浏览器类型的页面，然后重定向到自动登录或登录页面。我不喜欢这种方法，这意味着我必须在 IIS 中手动进行更改，因为当必须在新服务器上添加网站时，这会增加很多时间来设置网站，但这是我能找到的唯一方法。

到目前为止，这让我可以做我想做的所有事情，但不能使用正常的身份验证方法（添加会话倒计时计时器，检查服务中的会话变量，结合活动目录和自定义身份验证，如果他们通知用户从多个位置登录）但它需要比我想象的更多的编码和测试才能让它工作。我仍然会做更多的测试，然后我很高兴一旦真正的用户开始使用它就能正常工作。因此，如果有人对可以做到这一点的另一种方式有任何建议，我仍然会对其他可以做到这一点的方式感兴趣。

# ajax - 在 jquery 中设置数据不会在 $getJson 中触发

> ID：11659916
> 
> 赞同：0
> 
> 时间：2012-07-25T23:00:04.733
> 
> 标签：ajax, asp.net-mvc-3, jquery, asp.net-ajax

`$getJson`为什么设置数据在通话中不起作用。WTF 变量未在`getJson`调用中设置。另外，另一个问题是为什么`$(this).html()`不能设置里面`getJson`调用。我在全局范围内定义了 wtf 变量，但我没有从`getJson`函数中获取值，我想知道为什么数据无法访问。这是通过`ajax`函数 和解决的`async: seto to false`。我有我的解释，但我想要你的解释，所以提前谢谢。

```
<script type="text/javascript">
        $(function () { $('a[id=talentNaslov]').before(function () {
             var id = $(this).html();
             var data=null;            
             $.getJSON("url", { id: id  },function (talentNaziv) {  
                    data=talentNaziv; 
// data variable is not set still null and also $(this) is not set when i use it//  
                 });        
            $(this).html(data);
            });
         });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:47:24.387

> 为什么在 $getJson 调用中设置数据不起作用。在 getJson 调用中未设置 WTF 变量。

使用 getJson 设置数据应该可以正常工作，请尝试：

```
$.getJSON("url", { id: id  },function (data) {  
                  alert(data);
                 }); 
```

> 我在全局范围内定义了 wtf wariable，但它没有从 getJson 函数中获取价值，以及为什么数据不可访问。这可以通过 ajax 函数和 async: seto 来解决。

这是因为 getJson 是一个异步调用，这意味着 getJson 之后的代码，在你的情况下，`$(this).html(data);`不会等到你设置的 getJson 的回调`data`被执行。

所以发生的情况是发送了一个获取 JSON 的请求，并且没有等待响应，接下来的代码行就被执行了。这种行为很有帮助，因为整个程序在通过网络获取内容时不会等待相对较长的延迟。在您`$(this).html(data);`调用的情况下，只能保证发送了 JSON 请求，您仍然没有回复并且`data`仍然为空。

您尝试过的一种可能的解决方案是将 ajax 设置为 'synchronous' ，不建议这样做，而且 jQuery 看起来要弃用，因为它确实是一种糟糕的编程习惯。

话虽这么说，解决方案是将数据移入`call back function`of`getJson`​​或您正在使用的异步方法后需要完成的逻辑。

> 另一个问题是为什么 $(this).html() 不能在 getJson 调用中设置。

getJson 有一个回调函数作为它的最后一个参数，你指的是你`this`没有预料到的这个函数。

```
$.getJSON("url", { id: id  },function (talentNaziv) {  
                 //this?? 
                 }); 
```

> 在 JavaScript 中，this 总是指我们正在执行的函数的“所有者”，或者更确切地说，指的是函数作为方法的对象。

函数的所有者并不是`$('a[id=talentNaslov]')`你想象的那个jQuery Object，所以不要`this`指向它。

我仍然不明白为什么您以前以一种尴尬的方式使用它，可能是添加您的意图以及问题会给您提供更具体的答案或更优雅的方式来解决您的问题。

**更新**

从您对其他答案的评论看来，您正在寻找类似的东西：

```
$('a.beforeme').each(function(){
    var $ele = $(this);
    var id = $ele.html();//var id = $(this).html();
    $.getJSON('/echo/json/',{id: id},function(data){
        data = {msg: "this is it"}; // you will not need it
        console.log(data.msg);
        $ele.before(data.msg);
        });
}); 
```

小提琴[http://jsfiddle.net/PYhhS/1/](http://jsfiddle.net/PYhhS/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:10:44.167

设置数据不起作用，因为您试图将数据设置在响应范围之外。此外，作为提示，您可以使用井号通过 id 识别元素（见下文）。据我所知，我认为您正在寻找这样的东西：（将响应数据作为链接之前的元素插入 id 为 'talentNaslov'？

```
$.getJSON("url", { id: id  },function (data) {  
    $('a#talentNaslov').before(data));
}); 
```

$(this).html 不能在 getJson 调用中设置，因为“this”现在是对此范围内的 ajax (xhr) 对象的引用。

# javascript - 如何从javascript中字符串的开头删除特定模式

> ID：11659920
> 
> 赞同：0
> 
> 时间：2012-07-25T23:00:22.420
> 
> 标签：javascript, regex, substring

我的问题是我在 javascript 中有一个字符串，并且该字符串可能以也可能不以 `(d)`这种模式开头。其中 d 是一个随机数。

我正在寻找的是一种从字符串开头删除此模式的有效方法。

例如：

(3)Abcd 应转换为 Abcd，(412)abc 应转换为 abc，abcd 应保持 abcd

普通的子字符串对我不起作用，因为我不知道确切的位数。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:01:36.147

您可以使用[正则表达式](http://www.regular-expressions.info/)：

```
str = str.replace(/^\(\d+\)/, ""); 
```

这将匹配您的模式（字符串开头、左括号、一个或多个数字、右括号）并在找到时将其[替换](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace)为空字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:01:49.073

```
var result = str.replace(/^\(\d+\)/, ''); 
```

# python - 用python写文本文件返回奇怪的结果？

> ID：11659922
> 
> 赞同：0
> 
> 时间：2012-07-25T23:00:32.953
> 
> 标签：python

好的，我正在尝试简单地学习在 python 中读写文本文件。我可以读取文件等，但是当我尝试使用写入文件`write("my string")`然后去执行我的代码时，我得到了意想不到的结果，文件被写入，但是写入的第一行不会完全打印出来。这在带有 pymode 的 Vim 中以及从命令行和解释器中发生。这是代码：

```
#!/usr/bin/python

f = open('/Users/Desktop/data.txt', 'r+')

f.write("Test")

for lines in f:
    print lines

f.close() 
```

现在，当我执行此文件以写入`data.txt`输出时，将如下所示：

est <------ 测试中的“T”被完全切断。我希望这是有道理的，在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T23:07:32.143

我认为您的问题是您写入文件对象，然后立即从中读取。

尝试添加行

```
f.seek(0) 
```

在写入文件之后但在读取文件之前。这将重新定位文件中 Python 寻找开头的位置。

# php - 使用javascript获取服务器信息

> ID：11659923
> 
> 赞同：1
> 
> 时间：2012-07-25T23:00:39.133
> 
> 标签：php, javascript

我正在尝试将一段 PHP 代码重写为 JavaScript，理想情况下在两者之间传递尽可能少的变量。`$_SERVER`JavaScript 中是否有任何超级全局变量可以为 PHP数组提供类似的信息？

在 JavaScript 中，`location`似乎给了我一些有用的信息，但是 PHP 等价物`$_SERVER['HTTP_REFERER']`呢？我也有 jQuery 作为资源。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T23:08:11.993

`window.location`可以读取或设置，并带有诸如`.pathname`、`.search`、`.protocol`等属性——每个属性都将 URL 的特定方面作为只读值提供。

`document.referrer`将提供引用 URL 作为字符串。如果您希望域/路径/查询/等等相互分离，您需要自己做，或者使用提供它的库。

`document.cookie`将为您提供以分号分隔的用户/服务器设置的 cookie 列表。同样，将其转换为数组或对象是您自己的事。
您的 cookie 字符串也无法访问过期时间，也无法访问特定 cookie 设置的适用路径——安全性。

对于其余的大部分数据，您将不得不与服务器对话——浏览器喜欢将客户端脚本隐藏起来（例如用户的 IP、会话变量或其他任何内容）这可能会变成安全风险）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T23:05:12.987

这将为您提供推荐人-

```
document.referrer 
```

但是我认为您以错误的方式看待这一点-JavaScript和jQuery在客户端运行-如果您希望服务器变量可访问-您必须将它们传递给脚本-可能通过AJAX调用来实现。您说您有可用的 jQuery - 因此您可以使用该[`.ajax()`函数](http://api.jquery.com/jQuery.ajax/)来检索您需要的所有服务器数据。

# php - 为什么我会遇到解析错误？

> ID：11659924
> 
> 赞同：0
> 
> 时间：2012-07-25T23:00:48.123
> 
> 标签：php

我有一个 HTML 页面，上面有一个简单的表单，可以将数据提交到 login.php。在 login.php 里面我有这个代码。当我尝试执行此脚本时，我收到此错误：

解析错误：语法错误，第 13 行 /home/login.php 中的意外 T_VARIABLE

```
<?php

$username = $_POST['login'];
$password = $_POST['password'];

if ($username&&$password) {

    $connect = mysql_connect("localhost", "admin", "1455m") or die("Couldn't Connect");
    mysql_select_db("lr") or die("Couldn't find database!");

    $query = mysql_query("SELECT * FROM users WHERE username='$username'")

    $numrows = mysql_num_rows($query);

    if ($numrows!=0) {

        while ($row = mysql_fetch_assoc($query)) {

            $dbusername = $row['username'];
            $dbpassword = $row['password'];
        }

        if ($username==$dbusername&&$password==$dbpassword) {

            echo 'You are In!';

        } else {

            echo 'Incorrect Password!';
        }

    } else {
        die("That user doesn't exist.");
    }

} else {
    die("Please enter a username & password.");
}

?> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-25T23:02:23.950

你错过了一个分号：

```
$query = mysql_query("SELECT * FROM users WHERE username='$username'") 
                                                                      ^
                                                                      Here 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T23:02:45.117

该错误告诉您第 13 行的某些内容是意外的；在这种情况下是一个变量。所以通常最好检查它之前的代码并检查它的语法是否正确。

在这种情况下，您在第 13 行之前的行中缺少分号，因此第 11 行由于您的格式 - 就在您使用 mysql_query() 的地方！尝试这个...

```
$connect = mysql_connect("localhost", "admin", "1455m") or die("Coudn't Connect");
mysql_select_db("lr") or die("Coudn't find database!");

$query = mysql_query("SELECT * FROM users WHERE username='$username'"); // here!

$numrows = mysql_num_rows($query); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-25T23:07:36.340

您忘记在查询中添加连接：

```
$query = mysql_query("SELECT * FROM users WHERE username='$username'"); 
```

应该：

```
$result = mysql_query("SELECT * FROM users WHERE username='$username'", $connect); 
```

# opencv - 估计单目相机的运动

> ID：11659925
> 
> 赞同：3
> 
> 时间：2012-07-25T23:00:55.550
> 
> 标签：opencv, camera, rotation, translation, motion

我已经阅读了讲座和主题，并且几周以来一直在研究它，但是我找不到描述相机运动的方法。我不想重建 3D 世界。我正在使用 OpenCV。

我有一个单目相机和一个不知名的词。我有内在和失真参数。我有特征和通信。所以我正在寻找两帧之间的旋转和平移。我想将我的第一张图像视为 XYZ 轴的原点。

我使用基本矩阵和基本矩阵来找到外在参数（R，T），但我不相信。我有这些结果：

R [0.040437..., 0.116076..., -0.992416..., 0.076999..., -0.99063..., -0.112731..., -0.996211..., -0.071848.., -0.048994... ] T [0.6924183...; 0.081694...; -716885...]

我如何检查它们是否良好？

我计算了欧几里得距离以查看 3D 距离，但我的值有误。

拜托，谁能给我一些细节，或指导我？我希望我能很好地解释自己。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T08:16:31.270

基本上这种方式对于每个连续的帧你都会有未知的比例因子，所以你可以获得奇怪的 R 和 T 值。但是你可以使用一些初始化，比如已知的运动来执行场景的第一次三角测量。接下来，您可以使用 solvePnP 来计算下一个 [R|T]。

尝试阅读 PTAMM，它是单目 SLAM 最有趣的实现之一

[http://www.robots.ox.ac.uk/~bob/research/research_ptamm.html](http://www.robots.ox.ac.uk/~bob/research/research_ptamm.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:11:02.097

你说的是世界吗？这个问题也不是stackoverflow的真正主题，因为它处理的是理论而不是代码。

[https://stackoverflow.com/faq](https://stackoverflow.com/faq)

回答你的问题。如果你和 R 和 T 那么你可以计算每个点的 3D 坐标。从中，您可以将每个点重新投影到另一个相机上，并计算观察点和预测点之间的残差。如果错误在一个像素左右，那么它可能是有效的。

# python - 如何使用 Python 将多个 Javascript 文件连接到一个文件中

> ID：11659926
> 
> 赞同：2
> 
> 时间：2012-07-25T23:01:24.270
> 
> 标签：python, file

我想知道如何使用 Python 将多个 Javascript 文件连接到一个文件中。

我正在用 Javascript 构建一个基于组件的引擎，我想只使用一个文件来分发它，例如 engine.js。

或者，我希望用户获得具有文件和目录层次结构的整个源代码，并且使用整个源代码，他们应该获得一个 build.py Python 脚本，可以对其进行编辑以在其中包含各种系统和组件，它们基本上是 components/ 和 systems/ 目录中的 .js 文件。

如何加载列表（路径）中描述的文件并将它们组合成一个文件？

例如：

```
toLoad =
[
    "core/base.js",
    "components/Position.js",
    "systems/Rendering.jd"
] 
```

脚本应按顺序连接这些。

另外，这是一个 Git 项目。脚本有没有办法从 Git 读取程序的版本，然后在开头将其写为注释？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T23:05:32.400

这将连接您的文件：

```
def read_entirely(file):
    with open(file, 'r') as handle:
        return handle.read()

result = '\n'.join(read_entirely(file) for file in toLoad) 
```

然后，您可以根据需要输出它们，或者使用类似于以下的代码编写它们：

```
with open(file, 'w') as handle:
    handle.write(result) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:10:16.750

这样的事情怎么样？

```
final_script = ''
for script_name in toLoad:
    with open(script_name, 'r') as f:
        final_script += ('\n' + f.read())
with open('engine.js', 'w') as f:
    f.write(final_script) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T23:28:54.890

你可以自己做，但这是一个真正的问题，真正的工具正在更复杂地解决这个问题。考虑“JavaScript Minification”，例如使用[http://developer.yahoo.com/yui/compressor/](http://developer.yahoo.com/yui/compressor/)

# java - 我有几个在谷歌地球中打开的 .KMZ 文件。我需要将这些文件加载 到java中。我用Eclipse有没有办法？

> ID：11659930
> 
> 赞同：0
> 
> 时间：2012-07-25T23:01:56.840
> 
> 标签：java, eclipse, google-earth, kmz

我假设有某种 google api 用于此。我只是不知道在哪里可以找到任何帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:08:07.347

.kmz 只是一个标准的 zip 文件——解压它，里面会包含一个或多个 KML (xml) 文件。

# java - 对于 JSP 文件，document.getElementById("id") 的替代方法是什么？

> ID：11659931
> 
> 赞同：-1
> 
> 时间：2012-07-25T23:01:59.527
> 
> 标签：java, javascript, html, jsp

在 HTML 的情况下，我使用`document.getElementById("id");`它来检索我想要的`element/tag`.

如果是 JSP 文件（假设在函数内部），我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T23:13:24.447

我认为您混淆了 HTML、JSP 和 JavaScript 术语。`document.getElementById("id")`您在问题中提到的是一个 JavaScript 片段，我猜它包含在一个标签`<script type="text/javascript"></script>`中（顺便说一下，这是一个 HTML 标签）。

**HTML**是一种用于定义网页外观的标记语言（实际上是 CSS 负责外观，而 HTML 定义了页面布局）。

**JavaScript**是一种解释性语言，通常嵌入到 HTML 中，并在页面内容加载后由浏览器执行。

**JSP**是另一种基于 HTML 的标记语言，具有多项增强功能，可以创建动态网页。JSP 由服务器而不是浏览器执行，执行的结果是一个 HTML 文档。如果原始 JSP 有，那么生成的 HTML 将包含对 CSS 和 JavaScript 资源的引用。更重要的是，JSP 可以利用其生成“动态内容”的能力来生成“动态 JavaScript 片段”。

因此，答案是：***您可以在 JSP 中使用 JavaScript 片段，就像在 HTML 代码中一样，但您不能在嵌入在 JSP 中的 Java 方法中使用它，因为它们是由服务器而不是浏览器处理的***。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:10:32.077

您尚未指定如何在 JSP 中执行 javascript，因此我假设它是在后端 Java 服务器上运行的某个 javascript 引擎中。在那种情况下，既没有可用的“文档”，也没有获取文档的元素，因为这些是浏览器的工件。这些不是 javascript 的一部分。

如果适合您的情况，您可以为浏览器准备一些 onload 脚本

# php - 用于从表单发送电子邮件的 PHP 脚本

> ID：11659932
> 
> 赞同：1
> 
> 时间：2012-07-25T23:02:11.243
> 
> 标签：php

有人可以告诉我如何修复此脚本，以便将表单信息发送到正确的电子邮件（即，我的电子邮件......假设我的电子邮件是 username@mydomain.net）。我希望电子邮件也显示发送给我的用户的电子邮件地址。

```
<?php
$name = $_POST['fldName'];
$email = $_POST['fldEmail'];
$phone = $_POST['fldPhone'];
$comments = $_POST['fldComments'];
$isFormValid = false; 

if (strlen($name) && strlen($email) && strlen($phone) && strlen($comments)) $isFormValid = true; 

if ($isFormValid) 

{ 

$to      = 'username@mydomain.net'; 
$subject = 'Contact Us Form Comments'; 

$message = 'Name: '.$name."\r\n".'Email: '.$email."\r\n".'Comments: '.$comments; 

$headers = 'From: username@domain.net' . "\r\n" 
         . 'Reply-To: username@mydomain.net' . "\r\n"; 

mail($to, $subject, $message, $headers);

header("location: thankyou.html");

} 
else 
{ 

echo "Please fill in the required fields"; 

} 

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:09:27.037

与其使用原生 PHP mail() 自己做所有事情，不如使用一些有用的库，比如 swift mailer，它可以让你更轻松地发送邮件，而不必担心内部工作。

例如，要在 swift mailer 中发送邮件，您所需要做的就是。

```
$transport = Swift_SmtpTransport::newInstance('smtp.example.org', 25)
  ->setUsername('your username')
  ->setPassword('your password');
$mailer = Swift_Mailer::newInstance($transport);
// Create a message
$message = Swift_Message::newInstance('Wonderful Subject')
  ->setFrom(array('john@doe.com' => 'John Doe'))
  ->setTo(array('receiver@domain.org', 'other@domain.org' => 'A name'))
  ->setBody('Here is the message itself');
// Send the message
$result = $mailer->send($message); 
```

[您可以在官方网站http://swiftmailer.org/](http://swiftmailer.org/)中找到有关 swift mailer 的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:15:45.827

这`$headers = 'From: username@domain.net' . "\r\n"`将显示谁向您发送了电子邮件。它已经在你的脚本中了。你不需要添加任何额外的东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T23:03:17.430

更改`$headers`变量以使用发件人的电子邮件地址而不是您自己的。

# jakarta-ee - ejb拦截器可以在调用类获取之前更改方法的返回值吗？

> ID：11659936
> 
> 赞同：8
> 
> 时间：2012-07-25T23:02:28.993
> 
> 标签：jakarta-ee, ejb, ejb-3.0, aop, interceptor

如果我们在字段中有代码，该代码具有另一个产品调用的方法，并返回一个对象列表。而且我们需要对代码进行更改以使其在填充要返回的列表时更加灵活，我们是否可以在此期间为客户创建一个拦截器，在返回列表之前拦截该方法，并在之前从列表中删除项目调用该方法的产品获取列表。

例如

OurCode.search() 返回 foundObjects 的列表

其他产品调用 OurCode.search，收到 100 件商品

我们可以创建一个在 OurCode.search 返回之前拦截的拦截器，并更改 foundObjects 的列表，删除不必要的项目吗？这只是一个临时修复，直到未来的版本

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T06:17:50.157

虽然我不建议这样做（为了便于理解，并且根据我的经验，“临时修复”将成为永久性修复），但您可以使用拦截器来执行此操作。

```
@AroundInvoke
Object filterSearchResults(InvocationContext ctx) throws Exception {
    Object result = ctx.proceed();
    if ( result != null) {
        List<SearchResult> results = (List<SearchResult>)result;
        // do whatever you want to to with your results here
        return results;
    }
    return result;
} 
```

# php - 无法将字符串解析为 JSON 对象，无法从 javascript 显示警报框

> ID：11659940
> 
> 赞同：3
> 
> 时间：2012-07-25T23:02:46.167
> 
> 标签：php, javascript, html, json

编辑：已解决。使用以下任一解决方案，但 document.onload 需要更改为 window.onload。也可以在不需要 window.onload 函数的情况下工作。

这是我正在使用的 test.php 文件

```
<?php 
  include("conn.php");
?>

<!DOCTYPE html>
<html>
<head>
  <title>test</title>
</head>
<body>

    <script src="js/jquery.js"></script>
    <script type="text/javascript">
        document.onload = function (){
          var jsonString = '<?php echo json_encode($rowarr); ?>';
          var jsonObj = jQuery.parseJSON( jsonString );
          console.log(jsonObj);
          alert( jsonObj.Auckland );
    };

  </script>
</body>
</html> 
```

我已经在 Chrome 开发者工具中验证了 jsonString 的值是

```
'{"Auckland":37616,"Wellington":35357,"Christchurch":29818}' 
```

之后，我没有在控制台或任何警报框中获得任何日志。我也尝试过 JSON.parse 方法而不是 jQuery.parseJSON 无济于事。

我正在尝试将此 JSON 转换为用于[谷歌图表地理图表](https://developers.google.com/chart/interactive/docs/gallery/geochart)的数据表格式，看起来像这段代码

```
var data = google.visualization.arrayToDataTable([
    ['City',   'Population', 'Area'],
    ['Rome',      2761477,    1285.31],
    ['Milan',     1324110,    181.76],
    ['Naples',    959574,     117.27],
    ['Turin',     907563,     130.17],
    ['Palermo',   655875,     158.9],
    ['Genoa',     607906,     243.60],
    ['Bologna',   380181,     140.7],
    ['Florence',  371282,     102.41],
    ['Fiumicino', 67370,      213.44],
    ['Anzio',     52192,      43.43],
    ['Ciampino',  38262,      11]
  ]); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T23:09:02.467

如果你不把它作为一个字符串，它将是一个对象，你不必解析它

```
var jsonObj = <?php echo json_encode($rowarr); ?>; 
```

代替

```
var jsonString = '<?php echo json_encode($rowarr); ?>';
var jsonObj = jQuery.parseJSON( jsonString ); 
```

看起来 document.onload 没有触发/已经触发？你应该使用`window.onload`or`$(document).ready()`代替。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T23:08:58.073

由于您实际上是在实际 html 页面的标签内插入带有 php echo 的 JSON `script`，因此它在技术上成为对象文字。无需在 JavaScript 中进行额外的解析步骤。因此，在您的情况下，您分配给的值`jsonString`实际上已经是一个对象。

只有当它确实是字符串形式时，您才需要解析 JSON。所以发送到浏览器的实际脚本部分应该如下所示：

```
 var cities = {"Auckland":37616,"Wellington":35357,"Christchurch":29818};
      console.log(cities);
      alert( cities.Auckland ); 
```

您没有收到警告框，因为您的代码很可能会引发 JavaScript 错误，并在您尝试解析对象后停止执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T23:11:46.203

我猜处理函数永远不会被触发：文档对象上没有`load`事件（参见[window.onload vs document.onload](https://stackoverflow.com/q/588040/1048572)）。无论如何，您都不需要等待，因为处理程序中没有与 DOM 交互的任何内容 - 并且您在`<body>`标记的底部执行它（请参阅[当代码位于底部时是否需要“onload”？](https://stackoverflow.com/q/8717401/1048572)）。

* * *

由于 JSON 是 JavaScript 的子集，您可以直接将其作为对象字面量输出到脚本中：

```
var jsonObj = <?php echo json_encode($rowarr); ?>;
console.log(jsonObj);
alert( jsonObj.Auckland ); 
```

无需解析它。特别是，当您的 JSON 包含未转义的撇号时，这会破坏您的字符串文字。

# postgresql - PostgreSQL - 继续 unique_violation (plpgsql)

> ID：11659945
> 
> 赞同：9
> 
> 时间：2012-07-25T23:03:25.733
> 
> 标签：postgresql, plpgsql

我有一个 PostgreSQL 表，其中包含一些索引字段，并且这些字段必须是唯一的以防止重复。这要归功于插入所有字段并捕获 unique_violation 异常的 PLPGSQL 函数，尽管即使只有一个重复，它也会停止插入记录。

由于性能问题，我无法进行多次插入（其中一些以数百次完成），问题是即使只有一个重复，它也会停止所有过程，就像下面示例中最火的两个值一样。

```
CREATE OR REPLACE FUNCTION easy_import() RETURNS VOID AS
  $$
  BEGIN
    BEGIN
      INSERT INTO things ("title", "uniq1", "uniq2") VALUES
      ('title 1', 100, 102),
      ('title 2', 100, 102),
      ('title 3', 101, 102),
      ('title 4', 102, 102),
      ('title 5', 103, 102),
      ('title 6', 104, 102),
      ('title 7', 105, 102),
      ('title 8', 106, 102),
      ('title 9', 107, 102),
      ('title 10', 108, 102);
      RETURN;
    EXCEPTION WHEN unique_violation THEN
      -- do nothing
    END;
  END;
  $$
  LANGUAGE plpgsql; 
```

有没有办法只为一条记录忽略 unique_violation 并阻止它停止进一步的 INSERT？

谢谢你。

# 更新

*   唯一索引在“uniq1”和“uniq2”字段上有它，我很抱歉造成混淆。
*   虽然@cdhowie 的解决方案似乎是最好的，但它以某种方式忽略了这样一个事实，即如果您运行相同的查询，它将触发错误。这很奇怪，因为查询是`JOIN`有原因的。仍在努力。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T23:15:35.107

假设唯一约束是围绕 uniq1 和 uniq2 复合的，这将起作用：

```
INSERT INTO things

WITH new_rows (title, uniq1, uniq2) AS (VALUES
    ('title 1', 100, 102),
    ('title 2', 100, 102),
    ('title 3', 101, 102),
    ('title 4', 102, 102),
    ('title 5', 103, 102),
    ('title 6', 104, 102),
    ('title 7', 105, 102),
    ('title 8', 106, 102),
    ('title 9', 107, 102),
    ('title 10', 108, 102)
)

SELECT
    DISTINCT ON (n.uniq1, n.uniq2)
    n.title, n.uniq1, n.uniq2

FROM new_rows AS n

LEFT JOIN things AS t
ON n.uniq1 = t.uniq1 AND n.uniq2 = t.uniq2

WHERE t.uniq1 IS NULL; 
```

这实际上可能最终不如单个 INSERT 语句的性能，但它是唯一可以解决问题的事情。对每种方法进行基准测试，看看哪种方法最适合您。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-13T11:40:07.350

你的桌子是这样的：

```
CREATE TABLE t
(
  title text,
  uniq1 int not null,
  uniq2 int nut null,
  CONSTRAINT t_pk_u1_u2 PRIMARY KEY (uniq1,uniq2)
) 
```

所以让我添加一条规则：

```
CREATE OR REPLACE RULE ignore_duplicate_inserts_on_t AS ON INSERT TO t
   WHERE (EXISTS ( SELECT 1 FROM t WHERE t.uniq1 = new.uniq1 and t.uniq2 = new.uniq2))
   DO INSTEAD NOTHING; 
```

之后，您可以运行此查询：

```
insert into t(title,uniq1,uniq2) values 
    ('title 1', 100, 102),
    ('title 2', 100, 102),
    ...; 
```

如果你的桌子很大，这种方式是最佳的。我在大约 200 万行的表上进行了测试（对于这种方式和上面 cdhowie 先生提到的连接方式），结果是：

```
Rule way (mentioned in this comment): 1400 rows per second
Join way (mentioned in above comment): 650 rows per second 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T13:35:24.960

要获得您正在寻找的行为，只需将 INSERT 语句拆分为单独的语句，而不是在一个语句中包含多个值。与您的原始版本相比，性能应该没有任何明显的差异，因为一切仍然在一个事务中。

```
CREATE OR REPLACE FUNCTION easy_import() RETURNS VOID AS
$$
BEGIN
BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 1', 100, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 2', 100, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 3', 101, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 4', 102, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 5', 103, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 6', 104, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 7', 105, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 8', 106, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 9', 107, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

BEGIN
  INSERT INTO things ("title", "uniq1", "uniq2") VALUES ('title 10', 108, 102);
EXCEPTION WHEN unique_violation THEN
 -- do nothing
END;

RETURN;
END;
$$
LANGUAGE plpgsql; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T00:43:58.117

没有。

`BEGIN`...块是子事务，当`EXCEPTION`块内的语句失败时，子事务将回滚。要么全有，要么全无。

使用 cdhowie 的方法 -`JOIN`在`VALUES`.

# php - RGB 到 HSL 函数中的饱和度计算不正确

> ID：11659947
> 
> 赞同：6
> 
> 时间：2012-07-25T23:03:28.670
> 
> 标签：php, colors, rgb, hsl, color-palette

有人知道从 RGB 颜色中获取饱和度的正确公式吗？

我已经有一个功能可以做到这一点。我已经尝试过将它们发布在互联网上的大量内容，但只有这个似乎对我有用（第一次），除了饱和度偶尔会略微超出。

`rgb(204,153,51)`应该相等`hsl(40,60,50)`，而不是我有`hsl(40,75,50)`。正如你所看到的，我的色调和亮度是正确的，事实上，饱和度也大多是正确的，但有时不是，如果可以的话，我需要纠正它。

这是我到目前为止所构建的，因此我可以检查所有颜色值对于我的图像是否正确，然后再将它们存储在我的搜索引擎的数据库中。

![在此处输入图像描述](../Images/67e47534827a84c4875d3b20279163e6.png)

这是有问题的函数，我认为饱和度计算不正确：

```
function RGBtoHSL($red, $green, $blue)
{
    $r = $red / 255.0;
    $g = $green / 255.0;
    $b = $blue / 255.0;
    $H = 0;
    $S = 0;
    $V = 0;

    $min = min($r,$g,$b);
    $max = max($r,$g,$b);
    $delta = ($max - $min);

    $L = ($max + $min) / 2.0;

    if($delta == 0) {
        $H = 0;
        $S = 0;
    } else {
        $S = $delta / $max;

        $dR = ((($max - $r) / 6) + ($delta / 2)) / $delta;
        $dG = ((($max - $g) / 6) + ($delta / 2)) / $delta;
        $dB = ((($max - $b) / 6) + ($delta / 2)) / $delta;

        if ($r == $max)
            $H = $dB - $dG;
        else if($g == $max)
            $H = (1/3) + $dR - $dB;
        else
            $H = (2/3) + $dG - $dR;

        if ($H < 0)
            $H += 1;
        if ($H > 1)
            $H -= 1;
    }
    $HSL = ($H*360).', '.($S*100).', '.round(($L*100),0);
    return $HSL;
} 
```

关于为什么这不能 100% 起作用，我的一个线索是我首先将 HEX 颜色转换为 RGB，然后将 RGB 转换为 HSL。由于网络安全颜色，这是否会成为问题，或者您是否可以在函数中发现可能导致此问题的其他任何东西？或者这就是它的样子？

**更新 1**

尝试其他图像，它似乎主要是“米色”（近似）颜色，饱和度略有下降。使用颜色选择器，如果我将饱和度条移到它应该在的位置并没有太大的差异，所以我的搜索功能可能不会对此有太多了解。*不过，在*我对 500,000 张照片运行它之前解决它会很好。

**修复**

感谢下面的**OmnipotentEntity**，他注意到我的功能缺失了一部分。我变了：

```
$S = $delta / $max; 
```

到：

```
$S = $L > 0.5 ? $delta / (2 - $max - $min) : $delta / ($max + $min); 
```

现在产生 100% 正确的结果。

**友情提示**

如果有人想要生成此颜色表的代码，请询问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:37:44.870

[如果您的 luma > .5如此处 JavaScript HSL 代码所示，](http://web.archive.org/web/20130204191053/http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript)您似乎错过了饱和度计算。

```
var q = l < 0.5 ? l * (1 + s) : l + s - l * s; 
```

# php - 处理统计：根据页面请求或像素跟踪

> ID：11659948
> 
> 赞同：1
> 
> 时间：2012-07-25T23:03:34.657
> 
> 标签：php, statistics

我目前正在为我的页面开发一个统计模块。我目前正在考虑使用以下两种技术来启用特定于页面的统计信息：

1.  **根据请求直接查询数据库**。这将生成页面所需的时间增加了大约 100-200 毫秒，这**增加**了生成页面所需的**总时间**= bad。

2.  使用**[跟踪像素](http://en.wikipedia.org/wiki/Web_bug)**之类的技术。在我的内容底部插入一个 1x1 图像，确保在加载所有内容后加载它。这**不会**直接**影响页面生成时间。 `<img src="tracking.php?pageID=391" width=1 height=1 />`

我并不愚蠢——我确实意识到服务器在某个地方需要 200 毫秒来处理信息（收集、结构和插入），但是，这不应该影响用户。

通过使用方法一，我可以看到的一个好处是在提供内容之前更新统计信息，而不是方法二——这意味着半秒的访问也很重要。有时好，有时坏。

**处理统计**数据的**首选方式**、性能**和**平滑**度**是什么？我也对其他技术持开放态度。

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:11:07.183

我喜欢的方式： [Awstats](http://awstats.sourceforge.net/)。它使用 apache 日志文件来收集静态数据。但这真的取决于你想收集什么。

Awstats 将收集请求数量、时间、浏览器、IP 地址。apache 日志中的任何内容。最重要的是，它对页面加载的影响为零，并且不需要向您的页面添加额外的标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:11:18.977

我认为，在每次点击的基础上使用统计信息更新数据库的成本太高，不一定从加载时间的角度来看，而且在每次点击页面时都要进行额外的数据库调用。我想成本确实取决于您的预期流量，但我认为跟踪像素会好得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T23:14:36.537

使用异步监控。在每个页面上部署一个 javascript 侦听器，它可以触发对远程统计信息收集器的 ajax 调用，其中包含您想要捕获的所有详细信息。这不会影响页面加载时间。**

# wso2 - 在 WSO2 ESB 4.0.3 中验证 GET 请求参数时出错

> ID：11659957
> 
> 赞同：0
> 
> 时间：2012-07-25T23:04:27.253
> 
> 标签：wso2, wso2esb

我正在尝试验证 WSO2 ESB 4.0.3 中代理服务中的 GET 请求参数。我有以下代码逻辑

```
 <filter source="get-property('To')" regex="^(?=.*inSerialNr=).*$">
        <then>
           <send>
              <endpoint key="conf:/tqs/rma/ds_endpoint.xml" />
           </send>
        </then>
        <else>
           <log level="custom" separator=",">
              <property name="Missing-Input" value="Input validation failed...Missing Input Parameter - inSerialNr" />
           </log>
                <script language="js"><![CDATA[mc.setPayloadXML(<ERROR><DESCRIPTION>Input validation failed...Missing Input Parameter - inSerialNr</DESCRIPTION></ERROR>);]]></script>
           <property name="RESPONSE" value="true" scope="default" type="STRING" />
           <send>
              <endpoint key="conf:/tqs/tqsAnonymous.xml" />
           </send>
           <drop />
        </else>
     </filter> 
```

我希望在缺少参数“inSerialNr”时删除消息处理。它如何找不到作为客户端的“http://www.w3.org/2005/08/addressing/anonymous”端点。

即使我尝试执行 xslt 以将结果作为文本/纯文本并将其发送回，但它仍然找不到发送到匿名端点。由于它找不到终点，它会去外序并在那里执行代码。

get参数的错误处理是如何完成的？

请指教。谢谢阿比吉特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T13:29:15.730

请看这里[1]。这显示了如何从顺序中发送响应消息。

[1] [http://wso2.org/library/knowledge-base/generating-simple-response-using-wso2-enterprise-service-bus](http://wso2.org/library/knowledge-base/generating-simple-response-using-wso2-enterprise-service-bus)

# mysql - 通过 phpmyadmin 将 VBulletin mysql 数据库移动到新服务器时出错

> ID：11659959
> 
> 赞同：0
> 
> 时间：2012-07-25T23:04:30.420
> 
> 标签：mysql, phpmyadmin, vbulletin

我正在尝试将 vbulletin 论坛从 bluehost 服务器移至网络托管错误。我首先从旧服务器下载了 vb 文件夹并将其上传回新服务器。

对于数据库，我使用 bluehost.com 中的 phpmyadmin 导出我的数据库，当我尝试将其重新导入新服务器时，我收到此错误：

* * *

SQL查询：

```
DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <link rel="icon" href="./favicon.ico" type="image/x-icon" /> <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon" /> <title>phpMyAdmin  <link rel="stylesheet" type="text/css" href="phpmyadmin.css.php?server=1&amp;token=5739e47e2a94b96da71dc4213f69b5a4&amp;js_frame=right&amp;nocache=5344073683" /> <link rel="stylesheet" type="text/css" href="print.css" media="print" /> <link rel="stylesheet" type="text/css" href="./themes/pmahomme/jquery/jquery-ui-1.8.custom.css" /> <meta name="robots" content="noindex,nofollow" /> <script src="./js/cross_framing_protection.js?ts=1332953438" type="text/javascript"></script> <script src="./js/jquery/jquery-1.4.4.js?ts=1332953[...]

MySQL said: 

#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w' at line 1 
```

* * *

任何人都可以指导我解决问题吗？bluehost phpmyadmin 版本是 3.4.10.2 而 webhostingpad 是 3.4.10.1 这是问题的原因吗？如果是，解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:10:54.697

所以你已经从你的旧主机下载了一个导出文件？你下载的这个是什么格式的？只是 SQL 还是某种压缩版本？首先要做的应该是确定问题是出在您要上传到的主机还是您从中获取数据的主机上。我建议在本地打开导出的文件并查看它是否看起来是有效的 SQL 转储。

# c++ - 微软推荐使用什么原生 API 来渲染 2D 图形？

> ID：11659962
> 
> 赞同：5
> 
> 时间：2012-07-25T23:04:56.257
> 
> 标签：c++, windows, image, winapi

根据[MSDN 的列表](http://msdn.microsoft.com/en-us/library/windows/desktop/hh309470%28v=vs.85%29.aspx)，GDI 和 GDI+ 都是遗留的。那么在使用 Windows API 编写应用程序时，应该使用什么来渲染 2d 图形？

Direct2D、WIC、DirectComposition（这对我来说是新的）、GDI+、GDI？

注意：不是 2d 游戏 - 只是 2d 图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T23:12:07.373

GDI 或 GDI+ 都是满足基本需求的好选择。

操作系统仍然到处使用 GDI，所以我不太确定它们所说的“遗留”是什么意思。像这样的词通常没有意义，所以你不应该因为忽略它们而感到难过。将这些 API 标记为“遗留”的人可能是那些告诉你所有 Win32 都是遗留的人之一，却没有意识到他们如此喜爱的这些“现代”GUI 框架是建立在 Win32 之上的，并且不可能没有它就可以运行。

如果您需要 GDI+ 提供的额外功能（例如透明度等）和/或如果您使用 C++ 编程并且更喜欢 GDI+ 的基于类的 API 而不是 GDI 的平面 C 样式 API，请使用 GDI+。但请注意，如果您的应用程序使用 GDI+，您必须将`Gdiplus.dll`库重新分发给运行 Windows 2000 和更早版本的用户。基于 GDI 的应用程序将始终开箱即用。

这并不是说您不应该调查新的竞争者。据推测，Direct2D 旨在与 GDI 和 GDI+ 很好地互操作。唯一的问题是，许多开发人员无法要求他们的所有客户都升级到 Windows Vista 或更高版本。支持 XP 似乎仍然是一个有价值的目标（至少为这些用户提供最小的功能子集），如果您在 Direct2D 或其中一个新奇特的框架中编写整个 UI，这实际上是不可能的。对于标准的业务线应用程序，我还没有真正看到切换到 Direct2D 的优势（我确信游戏和其他需要 3D 效果的程序有优势）。您可能对[Direct2D 和 GDI 之间的以下比较感兴趣](http://msdn.microsoft.com/en-us/library/windows/desktop/ff729480.aspx)，它们都是二维的、硬件加速的图形 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T14:52:23.017

除非你*真的*必须支持 XP（让它死掉！），否则我强烈建议使用 Direct2D。*Direct2D 对所有新*开发都有意义的原因有很多：

*   通常更快的渲染（锯齿和抗锯齿渲染）
*   自从引入 Vista 以来，GDI 不是硬件加速非常糟糕（由于新的驱动程序模型）
*   与 Direct3D（如果需要）、DirectWrite、DirectComposition 等更好地集成。
*   更好地利用新的 GPU 功能
*   内置许多位图效果
*   Metro 风格应用不允许 GDI

因此，我建议任何正在开始使用 Direct2D 而不是 GDI/GDI+ 的新应用程序的人。

# java - 运行 EvoSuite 时出现 ExceptionInInitializerError（java 的自动单元测试生成）

> ID：11659963
> 
> 赞同：0
> 
> 时间：2012-07-25T23:05:01.933
> 
> 标签：java, exception

我有以下非常简单的、故意出错的 java 类：

```
import java.io.InputStream;
import java.util.*;
public class ArrayListError{

public ArrayListError(){
}
public static void makeArray(int i){
ArrayList list = new ArrayList(i);
}
public static void main(String[] args)
{
System.out.println("Enter a number to create arrayList:");
Scanner scanner =new Scanner(System.in);
int i= scanner.nextInt();
makeArray(i);
}

} 
```

在 evosuite cygwin( java -jar evosuite-20120511.jar -setup c:/Users/Eliezer\ Shindler/Desktop/myclasses) 上运行时，我得到：

de.unisb.cs.st.evosuite.setup.ScanProject.main(ScanProject.java:578) 的线程“主”java.lang.ExceptionInInitializerError 中的异常原因：com.thoughtworks.xstream.converters.ConversionException：无法构造de.unisb.cs.st.evosuite.callgraph.DistanceTransformer$ClassEntry 因为它没有无参数构造函数：无法构造 de.unisb.cs.st.evosuite.callg raph.DistanceTransformer$ClassEntry 因为它没有无参数构造函数----调试信息----消息：无法构造de.unisb.cs.st.evosuite.callgraph.Distanc eTransformer$ClassEntry，因为它没有无参数构造函数原因异常：com。 thinkworks.xstream.converters.reflection.ObjectAcces sException 原因消息：无法构造 de.unisb.cs.st.evosuite。callgraph.Distanc eTransformer$ClassEntry 因为它没有无参数构造函数类：java.util.HashSet 所需类型：de.unisb.cs.st.evosuite.callgraph.DistanceTransformer$Clas sEntry 路径：/set/de. unisb.cs.st.evosuite.callgraph.DistanceTransformer $ClassEntry

## 行号：2

```
 at com.thoughtworks.xstream.core.TreeUnmarshaller.convert(TreeUnmarshall           er.java:89)
    at com.thoughtworks.xstream.core.AbstractReferenceUnmarshaller.convert(A           bstractReferenceUnmarshaller.java:63)
    at com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnm           arshaller.java:76)
    at com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnm           arshaller.java:60)
    at com.thoughtworks.xstream.converters.collections.AbstractCollectionCon           verter.readItem(AbstractCollectionConverter.java:71)
    at com.thoughtworks.xstream.converters.collections.CollectionConverter.p           opulateCollection(CollectionConverter.java:68)
    at com.thoughtworks.xstream.converters.collections.CollectionConverter.u           nmarshal(CollectionConverter.java:61)
    at com.thoughtworks.xstream.core.TreeUnmarshaller.convert(TreeUnmarshall           er.java:82)
    at com.thoughtworks.xstream.core.AbstractReferenceUnmarshaller.convert(A           bstractReferenceUnmarshaller.java:63)
    at com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnm           arshaller.java:76)
    at com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnm           arshaller.java:60)
    at com.thoughtworks.xstream.core.TreeUnmarshaller.start(TreeUnmarshaller           .java:137)
    at com.thoughtworks.xstream.core.AbstractTreeMarshallingStrategy.unmarsh           al(AbstractTreeMarshallingStrategy.java:33)
    at com.thoughtworks.xstream.XStream.unmarshal(XStream.java:923)
    at com.thoughtworks.xstream.XStream.unmarshal(XStream.java:909)
    at com.thoughtworks.xstream.XStream.fromXML(XStream.java:853)
    at de.unisb.cs.st.evosuite.utils.Utils.readXML(Utils.java:301)
    at de.unisb.cs.st.evosuite.callgraph.Hierarchy.readFromDefaultLocation(H           ierarchy.java:113)
    at de.unisb.cs.st.evosuite.setup.TestTaskGenerator.<clinit>(TestTaskGene           rator.java:57)
    ... 1 more 
```

原因：com.thoughtworks.xstream.converters.reflection.ObjectAccessException：无法构造 de.unisb.cs.st.evosuite.callgraph.DistanceTransformer$ClassEnt ry，因为它在 com.thoughtworks.xstream 中没有无参数构造函数。 converters.reflection.PureJavaReflectionProvider.newInstance(PureJavaReflectionProvider.java:71) at com.thoughtworks.xstream.converters.reflection.AbstractReflectionConv erter.instantiateNewInstance(AbstractReflectionConverter.java:308) at com.thoughtworks.xstream.converters.reflection.AbstractReflectionConv erter .unmarshal(AbstractReflectionConverter.java:161) 在 com.thoughtworks.xstream.core.TreeUnmarshaller.convert(TreeUnmarshall er.java:82) ... 19 更多

我不明白这一点 - 任何人都可以帮忙 - 我多年来一直在努力解决这个问题。evosuite 文档可在 www.evosuite.org/documentation 获得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T22:50:39.840

我认为这是一个内部 evosuite 错误，由于某种原因，它是在 cygwin 中运行引起的。

# joomla - joomla + 不渲染模块

> ID：11659968
> 
> 赞同：0
> 
> 时间：2012-07-25T23:05:30.717
> 
> 标签：joomla

我为 joomla 2.5 开发了一个模块，它工作得很好，问题是我不希望在显示组件的某个视图但该视图不是菜单链接时呈现它，所以我不能告诉我模块在我不想渲染时不渲染。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:11:17.317

两种可能：

1.  将该视图分配给从未显示的菜单中的菜单项。您可以像往常一样隐藏模块。

2.  由于您有一个自定义模块，您可以修改模块以检查组件和视图，而不是在某些情况下呈现自身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T19:59:08.947

“检查组件并查看并且在某些情况下不呈现自身”可能会遇到的一个问题是，如果模块位于模块位置，当其中没有模块时应该“折叠”（例如，权限或左列），它不会折叠，因为模块仍然被分配（即使它没有渲染任何东西）。

问题在于决定在哪里显示模块。是模块本身决定何时渲染的问题，还是逻辑应该在其他地方，决定“在这个页面上，是否应该出现一个特定的模块？”。我建议后者。

一个很好的解决方案是[MetaMod Pro](http://extensions.joomla.org/extensions/style-a-design/modules-management/3391)，它允许您构建确定其他模块是否应该出现在页面上的条件。然后，您输入一段 PHP 代码来进行检测。

所以片段可能是：

```
if (! ($option == 'com_mycomponent' and $view == 'myview') ) return XXX;
// replace XXX with the module id of the module you want to disappear. 
```

即“如果我们不在带有 mycomponent 和 myview 的页面上，则显示模块 XXX”。

提示：如果不包含，专业版将允许模块完全消失。免费版本可能会留下一些 HTML。

# regex - 查找和替换以模式开头的行

> ID：11659970
> 
> 赞同：8
> 
> 时间：2012-07-25T23:05:32.633
> 
> 标签：regex, unix, sed

我在文件 file.txt 中有这样的文本

```
xxxxxxxxxxxxxxx
xxxxxxxxxxxxxxx
a    b   c // delimited by tab
xxxxxxxxxxxxxxx
xxxxxxxxxxxxxxx 
```

我知道使用`sed`我可以查找和替换文件中的文本。如果一行以 ab 开头（由制表符分隔），我需要用 de f 替换它。所以上面的文件将是

```
xxxxxxxxxxxxxxx
xxxxxxxxxxxxxxx
d    e   f // delimited by tab
xxxxxxxxxxxxxxx
xxxxxxxxxxxxxxx 
```

我可以这样做来查找和替换，我只想要那些以 ab 开头的实例并替换整行。

```
sed -i 's/a/\t/\b/\t\/c/REPLACED TEXT/g' file.TXT 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-25T23:10:45.847

使用一个`^`符号来表示一行的开始：

`sed -i 's/^a\tb.*$/REPLACED TEXT/g' file.TXT`

说明：

*   `^`表示*行首/输入*
*   `\t`表示*制表符*
*   `.`表示*任何字符*
*   `*`表示*前面的表达式的零个或多个*
*   `$`表示*行尾/输入*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:13:31.903

如果以 . 开头，则以下内容将替换整行`a<tab>b<tab>c`。使`.*$`匹配包括整行以进行替换。包含您的示例正则表达式`c`，但散文仅提到`a`and `b`，因此不清楚是否`c`需要。如果没有，则从正则表达式中删除`\tc`。

```
s/^a\tb\tc.*$/REPLACED TEXT/g 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T16:13:50.247

和`awk`

```
awk '/^a\tb/{$0="REPLACED TEXT"} 1' foo.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T08:29:38.693

这可能对您有用（GNU sed）：

```
sed -i '/^a\tb/c\replacement text' file 
```

# c# - 调试文件 WriteAllText

> ID：11659971
> 
> 赞同：0
> 
> 时间：2012-07-25T23:05:37.953
> 
> 标签：c#, macos, monomac

我创建的小实用程序构建得很好。但是当我去保存文件时，我得到一个调试异常：

> System.UnauthorizedAccessException 已被抛出，访问路径“/文件夹/文件被拒绝。

我试图将文件写入到的位置通常需要身份验证，但是当我单击保存时，我的实用程序不会要求它。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:23:20.897

通常，当您获得 时`UnauthorizedAccessException`，您没有执行操作所需的安全许可（权限）。[查看此答案](https://stackoverflow.com/a/130641/146622)中的代码，了解如何获得该权限。

# c++ - C++ 算法：根据特定条件从 2D 矩阵中选择 n 个数字

> ID：11659972
> 
> 赞同：1
> 
> 时间：2012-07-25T23:05:41.910
> 
> 标签：c++, c, algorithm

我有一个大小为 [3][x] 的二维矩阵，里面填充了数字。我想根据条件从这个矩阵中选择 x 个数字

1.  每列中只有一个数字。
2.  每行最多有 'm' 个数字（所有 3 行的总数应该是 x 个数字和 3m > x）

我想找到这些选定的 x 数字的最小总和。

我能够根据从矩阵中的上述条件找到“x”小数字的迭代方法来选择数字。但我的答案不是最优的。例如：

```
5 9 . . . . 
6 15 . . . .
7 19 . . . . 
```

假设最初选择了 5（所以现在不能选择 6 和 7）。稍后我们尝试选择 9，但如果行 (0) 的 m 个元素结束，我们将不得不选择 15。现在我们的解决方案将是 5+15 = 20，但我们可以使用 6+9 = 15 作为最佳解决方案。

我正在尝试优化我的解决方案并寻找更好的算法。有人可以为我提供一些最佳解决方案的好主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T23:46:42.350

这个问题让我想起了这个：[http ://projecteuler.net/problem=345](http://projecteuler.net/problem=345)

匈牙利算法可能有效：[http ://en.wikipedia.org/wiki/Hungarian_algorithm](http://en.wikipedia.org/wiki/Hungarian_algorithm)

# swig - 为 Openwrt 交叉编译 Gnu Radio

> ID：11659973
> 
> 赞同：4
> 
> 时间：2012-07-25T23:05:55.263
> 
> 标签：swig, cross-compiling, openwrt, gnuradio

我正在尝试在 OpenWRT“态度调整”（最新的主干资源）上安装 Gnu Radio。我已经交叉编译了 GR，一切似乎都已经编译和链接得很好。但是，在 Python 中导入模块会导致以下结果：

```
root@OpenWrt:/usr/lib/python2.7/dist-packages/gnuradio/gr# python
Python 2.7.3 (default, Jul 21 2012, 17:36:54) 
[GCC 4.6.3 20120201 (prerelease)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from gnuradio import gr
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/dist-packages/gnuradio/gr/__init__.py", line 43, in <module>
    from gnuradio_core import *
  File "/usr/lib/python2.7/dist-packages/gnuradio/gr/gnuradio_core.py", line 23, in <module>
    from gnuradio_core_runtime import *
  File "/usr/lib/python2.7/dist-packages/gnuradio/gr/gnuradio_core_runtime.py", line 26, in <module>
    _gnuradio_core_runtime = swig_import_helper()
  File "/usr/lib/python2.7/dist-packages/gnuradio/gr/gnuradio_core_runtime.py", line 22, in swig_import_helper
    _mod = imp.load_module('_gnuradio_core_runtime', fp, pathname, description)
ImportError: File not found
>>> 
```

请注意，已在包含 SWIG 库的目录中调用了 Python。这是`ldd _gnuradio_core_runtime.so`，在**目标**系统上运行：

```
checking sub-depends for '/usr/lib/libgnuradio-core-3.6.2git.so.0.0.0'
checking sub-depends for '/usr/lib/libgruel-3.6.2git.so.0.0.0'
checking sub-depends for '/usr/lib/libboost_date_time.so.1.49.0'
checking sub-depends for '/usr/lib/libboost_program_options.so.1.49.0'
checking sub-depends for '/usr/lib/libboost_filesystem.so.1.49.0'
checking sub-depends for '/usr/lib/libboost_system.so.1.49.0'
checking sub-depends for '/usr/lib/libboost_thread.so.1.49.0'
checking sub-depends for '/lib/libpthread.so.0'
checking sub-depends for '/usr/lib/libstdc++.so.6'
checking sub-depends for '/lib/libm.so.0'
checking sub-depends for '/lib/libgcc_s.so.1'
checking sub-depends for '/lib/libc.so.0'
checking sub-depends for '/usr/lib/libfftw3f.so.3'
checking sub-depends for 'not found'
checking sub-depends for '/lib/librt.so.0'
checking sub-depends for '/usr/lib/libvolk.so.0.0.0'
checking sub-depends for '/lib/libdl.so.0'
    libgnuradio-core-3.6.2git.so.0.0.0 => /usr/lib/libgnuradio-core-3.6.2git.so.0.0.0 (0x00000000)
    libgruel-3.6.2git.so.0.0.0 => /usr/lib/libgruel-3.6.2git.so.0.0.0 (0x00000000)
    libboost_date_time.so.1.49.0 => /usr/lib/libboost_date_time.so.1.49.0 (0x00000000)
    libboost_program_options.so.1.49.0 => /usr/lib/libboost_program_options.so.1.49.0 (0x00000000)
    libboost_filesystem.so.1.49.0 => /usr/lib/libboost_filesystem.so.1.49.0 (0x00000000)
    libboost_system.so.1.49.0 => /usr/lib/libboost_system.so.1.49.0 (0x00000000)
    libboost_thread.so.1.49.0 => /usr/lib/libboost_thread.so.1.49.0 (0x00000000)
    libpthread.so.0 => /lib/libpthread.so.0 (0x00000000)
    libstdc++.so.6 => /usr/lib/libstdc++.so.6 (0x00000000)
    libm.so.0 => /lib/libm.so.0 (0x00000000)
    libgcc_s.so.1 => /lib/libgcc_s.so.1 (0x00000000)
    libc.so.0 => /lib/libc.so.0 (0x00000000)
    libfftw3f.so.3 => /usr/lib/libfftw3f.so.3 (0x00000000)
    libfftw3f_threads.so.3 => not found (0x00000000)
    librt.so.0 => /lib/librt.so.0 (0x00000000)
    libvolk.so.0.0.0 => /usr/lib/libvolk.so.0.0.0 (0x00000000)
    libdl.so.0 => /lib/libdl.so.0 (0x00000000)
    ld-uClibc.so.0 => ld-uClibc.so.0 (0x00000000) 
```

这是**构建**系统`file _gnuradio_core_runtime.so`上的输出：

 **```
_gnuradio_core_runtime.so: ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), dynamically linked, not stripped 
```

目标系统在 Intel Atom 上运行。最后，我能想到的最后一条有用信息`PYTHONPATH`是设置为`/usr/lib/python2.7/dist-packages`. 我不知道问题出在哪里。我希望精彩的堆栈溢出社区可以帮助找到解决方案。提前感谢您的任何指点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T18:54:38.657

目标缺少`libfftw3f_threads.so`库。由于系统调用`dlopen()`无法解析 的依赖关系`_gnuradio_core_runtime.so`，它告诉 Python 找不到文件。我将库复制到目标，did`ldconfig`和 Python 正确加载了库。（解决方案归功于 Flexo）。**

# javascript - 使用 CouchDB 和 Backbone.js 提供忘记密码功能的最佳方式是什么？

> ID：11659974
> 
> 赞同：0
> 
> 时间：2012-07-25T23:05:58.517
> 
> 标签：javascript, backbone.js, couchdb

我有一个使用backbone.js 构建的ajax 应用程序，它连接到一个couchdb 实例。我正在尝试使用以下工作流程构建忘记密码的功能：

1) 用户输入他们的用户名 2) 我向他们发送一封包含链接的电子邮件 3) 用户访问该链接并输入新密码

但是，我不知道如何实际更新密码。出于安全原因，我不会将管理员凭据嵌入客户端，在我看来，用户必须先经过身份验证才能更改密码。

感谢您的时间和帮助。希望我只是忽略了一些愚蠢的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T00:36:59.430

我这样做：将唯一密钥保存到数据库，将包含该密钥的链接发送到访问者电子邮件，当然当他访问该链接时，您需要检查该密钥的可用性，也许考虑 15 分钟因为密钥是发送或拒绝他的重置请求

# sql - SQL：分解数组

> ID：11659976
> 
> 赞同：4
> 
> 时间：2012-07-25T23:06:00.310
> 
> 标签：sql, arrays, json, hive, explode

我有一个包含 JSON 对象的表。每个 JSON 对象都包含一个方括号中的数组，以逗号分隔。

如何使用 SQL 访问方括号数组中的任何元素，例如“Matt”？

```
{"str":
   [
     1,
     134,
     61,
     "Matt",
     {"action.type":"registered","application":491,"value":423,"value2":12344},
     ["application"],
     [],
     "49:0"
   ]
} 
```

我在 Hadoop 上使用“Hive”。如果您知道如何在 SQL 中执行此操作，那很好 :)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-29T09:05:59.680

您可以在 Hive 中执行此操作，如下所示：

首先你需要一个 JSON SerDe (Serializer / Deserializer)。我见过的最实用的是[https://github.com/rcongiu/Hive-JSON-Serde/](https://github.com/rcongiu/Hive-JSON-Serde/)。Peter Sankauskas 的 SerDe 似乎无法处理如此复杂的 JSON。在撰写本文时，您需要使用 Maven 编译 SerDe，并将 JAR 放在 Hive 会话可以访问的地方。

接下来，您将需要更改 JSON 格式。原因是 Hive 采用数组的强类型视图，因此混合整数和其他东西是行不通的。考虑切换到这样的结构：

```
{"str": { 
   n1 : 1,
   n2 : 134,
   n3 : 61,
   s1: "Matt",
   st1: {"type":"registered","app":491,"value":423,"value2":12344},
   ar1: ["application"],
   ar2: [],
   s2: "49:0"
} } 
```

接下来，您需要将 JSON 全部放在一行中。我不确定这是 Hive 还是 SerDe 的怪癖，但你需要这样做。

然后将数据复制到 HDFS 中。

现在您已准备好定义一个表并进行查询：

```
ADD JAR /path/to/jar/json-serde-1.1.2-jar-with-dependencies.jar;
CREATE EXTERNAL TABLE json (
    str struct<
       n1 : int, n2 : int, n3 : int,
       s1 : string,
       st1 : struct < type : string, app : int, value : int, value2 : int>,
       ar1 : array<string>,
       ar2 : array<string>,
       s2 : string
    >
 )
 ROW FORMAT SERDE 'org.openx.data.jsonserde.JsonSerDe'
 LOCATION '/hdfs/path/to/file'; 
```

有了这个，您可以运行有趣的嵌套查询，例如：

```
select str.st1.type from json; 
```

最后但并非最不重要的一点是，因为这是 Hive 特有的，所以值得更新问题和标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:11:21.993

除非您使用非常特定于您的数据库引擎的东西，并且您没有指定您正在使用的数据库引擎，否则您不能这样做。

“你不能”的原因是 SQL/RDBMS 不是为这种类型的存储而设计的。我建议根据您的需要使用适当的规范化或 NoSQL 解决方案。

# java - Java LinkedList 可以安全地在多线程中读取吗？

> ID：11659977
> 
> 赞同：3
> 
> 时间：2012-07-25T23:06:05.687
> 
> 标签：java

我希望多个线程遍历 LinkedList 中的元素。我不需要写入 LinkedList。这样做安全吗？还是我需要一个同步列表才能使其工作？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T23:10:32.030

他们可以安全地做到这一点，前提是：

*   它们与（所有）在开始迭代之前写入列表的线程同步，并且
*   在迭代期间没有线程修改列表。

* * *

第一点是必要的，因为除非在开始之前进行了适当的同步，否则有可能其中一个“写入”线程对本地缓存或寄存器中的列表数据结构进行了未刷新的更改，或者一个读取线程有缓存或寄存器中的陈旧列表状态。

（这是需要深入了解 Java 内存模型才能知道该场景是否真正线程安全的情况之一。）

* * *

> 或者我是否需要一个同步列表才能使其工作

你不一定需要走那么远。您需要做的就是确保在适当的时候存在“之前发生”的关系，并且有多种方法可以实现这一点。例如，如果列表是由写线程创建和写入的，然后写线程在调用`start()`它们之前将列表传递给读线程对象。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-25T23:10:25.613

从[Java 文档](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedList.html)：

请注意，此实现不同步。如果多个线程同时访问一个链表，并且至少有一个线程在结构上修改了链表，则必须对外同步。（结构修改是添加或删除一个或多个元素的任何操作；仅设置元素的值不是结构修改。）这通常是通过同步一些自然封装列表的对象来完成的。如果不存在这样的对象，则应使用集合“包装”列表。

换句话说，如果你真的**只是在**迭代，那么你就没事了，只是要小心。

# facebook - 将自定义 Facebook util 库迁移到 Yii 框架

> ID：11659980
> 
> 赞同：1
> 
> 时间：2012-07-25T23:06:43.313
> 
> 标签：facebook, yii

我有一个用纯 PHP 开发的 facebook 应用程序，我正在将该应用程序迁移到 YII 框架。

问题是我使用了一个名为“utilsFacebook”的类，其中我有对象 facebook（来自 fb sdk）以及我需要从 facebook、getUserId、getUserFriendList 等获取数据的所有方法。

我不知道如何使用 Yii 处理我在 utilsFacebook 中所做的所有操作。

创建一个具有 utilsFacebook 功能的控制器是正确的想法吗？每次我实例化控制器都会创建一个新的 Facebook 对象，我应该将该对象存储在 SESSION 中以获得更好的性能还是一个坏主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T04:38:33.417

> Q. 创建一个具有 utilsFacebook 功能的控制器是正确的想法吗？

在使用 yii 作为框架完成了一个 facebook 应用程序之后，我建议你将这个库作为一个组件或一个扩展。

但绝对**不要**将这些功能直接放在控制器中。每当控制器需要他们使用您的自定义 facebook util 类调用函数时。

组件可以放在文件夹：*projectrootfolder/protected/components*

扩展可以放在文件夹：*projectrootfolder/protected/extensions*

如果您不相信其中任何一个具有语义意义，您总是可以在*protected*中创建一个新文件夹，比如*utils*并将类放在那里。但是我认为扩展是最好的方法。

> 问：我应该将该对象存储在 SESSION 中以获得更好的性能还是一个坏主意？

我认为没有必要将对象存储在会话中，因为不会有明显的性能提升。此外，您将不必要地使您的代码复杂化。

我所做的是，创建了一个应用程序级别的组件，并在整个应用程序中使用该组件，在任何控制器中。

例子：

在您的应用程序的配置中，*protected/config/main.php*：

```
'components'=>array(
    'fbHelper'=>array( // gave the component this name
        'class'=>'ext.utils.FacebookHelper', // had stored the helper class in extensions/utils folder
        'parameter1'='somevalue',
        // more parameters
    ),

    // standard yii app components

), 
```

这将允许您像这样使用组件：`Yii::app()->fbHelper->getFriends();`

看看[facebook-opengraph](http://www.yiiframework.com/extension/facebook-opengraph "http://www.yiiframework.com/extension/facebook-opengraph")扩展，它可以帮助你，在路上。

# bash - 如何使用 getopts 创建标志以运行命令

> ID：11659981
> 
> 赞同：-2
> 
> 时间：2012-07-25T23:06:47.203
> 
> 标签：bash, shell, getopts

我需要有关我的 getopts 的帮助，我希望只有在传递标志（在本例中为 -d）时才能运行此命令（ mount 命令）。下面的输出是我的脚本中的内容，但它似乎不起作用。

```
检查安装=""

而 getopts ":d" 选择
做
  案例“$ opt”在

  d) CHECKMOUNT="true" ;;

      用法 >&2
      1号出口；；
    经社理事会
   完毕
  转移`expr $OPTIND-1`

FS_TO_CHECK="/dev"

如果 [ "$CHECKMOUNT" = "true" ]
然后
  如果猫 /proc/mounts | grep $FS_TO_CHECK > /dev/null; 然后
   # 文件系统已挂载
别的
   # 文件系统没有挂载
  菲
菲

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T23:40:32.457

你的脚本有很多问题。

这是使其正常工作的最小修复列表：

*   `While`不是 bash 控制语句，它是`while`. 案例**很重要**。
*   空格**很重要**：`if ["$CHECKMOUNT"= "true"]`不起作用，应该会导致错误消息。您需要在括号周围和 . 周围留有空格`=`，如下所示：`if [ "$CHECKMOUNT" = "true" ]`.
*   您的用法`getopts`不正确，我猜您在复制示例时输入错误：`While getopts :d: opt`应该是：`while getopts ":d" opt`。
*   你的用法`shift`不正确。这应该会导致错误消息。将其更改为：`shift $((OPTIND-1))`如果您需要转移`OPTIND`.
*   裸文本*unknocn 标志*看起来像一个注释，在它前面加上`#`，否则在使用未知选项时会出错。
*   没有`usage`功能。定义一个，或`usage`在您的`\?)`情况下更改为`echo`使用说明。

最后，如果您的脚本只需要一个可选参数，您也可以简单地自己处理它而不是使用`getopt`- 脚本的第一个参数存储在特殊变量中`$1`：

```
if [ "$1" = "-d" ]; then
    CHECKMOUNT="true"
elif [ "$1" != "" ]; then
    usage >&2
    exit 1
fi 
```

# haskell - 为什么 Data.Binary 的 encodeFile 不偷懒？

> ID：11659986
> 
> 赞同：6
> 
> 时间：2012-07-25T23:07:22.253
> 
> 标签：haskell

在 GHCI 中，我运行了这个简单的测试：

```
encodeFile "test" [0..10000000] 
```

这条线运行得非常快（<10 秒），但我的内存使用量在它完成之前飙升至 ~500MB。由于它使用 ByteString.Lazy，因此 encodeFile 不应该是惰性的吗？

* * *

编辑：罗马下面的答案很棒！我还想指出另一个问题的[答案](https://stackoverflow.com/questions/6205294/binary-serialization-for-lists-of-undefined-length-in-haskell)，这解释了为什么 Data.Binary 对列表进行严格编码并提供了一种稍微优雅的解决方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T08:08:09.717

以下是列表序列化的定义方式：

```
instance Binary a => Binary [a] where
    put l  = put (length l) >> mapM_ put l 
```

也就是先序列化列表的长度，再序列化列表本身。

为了找出列表的长度，我们需要评估整个列表。但是我们不能对它进行垃圾收集，因为第二部分需要它的元素，`mapM_ put l`. 所以整个列表必须在计算长度之后和元素序列化开始之前存储在内存中。

下面是堆配置文件的样子：

![轮廓](../Images/92846387ce2dff2e6c2fd1b5d7cf515a.png)

请注意它在构建列表以计算其长度时如何增长，然后在元素被序列化并可以被 GC 收集时如何减少。

那么，如何解决这个问题？在您的示例中，您已经知道长度。因此，您可以编写一个采用已知长度的函数，而不是计算它：

```
import Data.Binary
import Data.ByteString.Lazy as L
import qualified Data.ByteString as B
import Data.Binary.Put

main = do
  let len = 10000001 :: Int
      bs = encodeWithLength len [0..len-1]
  L.writeFile "test" bs

putWithLength :: Binary a => Int -> [a] -> Put
putWithLength len list =
  put len >> mapM_ put list

encodeWithLength :: Binary a => Int -> [a] -> ByteString
encodeWithLength len list = runPut $ putWithLength len list 
```

该程序在 53k 的堆空间内运行。

您还可以在其中包含一个安全功能`putWithLength`：在序列化列表时计算长度，并检查最后的第一个参数。如果不匹配，则抛出错误。

**练习**：为什么你仍然需要传递长度`putWithLength`而不是使用上面描述的计算值？

# python - 用装饰器替换宏样式的类方法？

> ID：11659988
> 
> 赞同：3
> 
> 时间：2012-07-25T23:07:34.913
> 
> 标签：python, decorator, with-statement, contextmanager

尽管阅读了许多关于该主题的文章（包括 [this][1] 非常流行的关于 SO 的文章），但我很难很好地掌握装饰器。我怀疑我一定是愚蠢的，但是由于愚蠢带来的所有固执，我决定尝试解决这个问题。

那，我怀疑我有一个很好的用例......

下面是我的一个项目中的一些代码，它从 PDF 文件中提取文本。处理涉及三个步骤：

1.  设置处理 PDF 文件所需的 PDFMiner 对象（样板初始化）。
2.  对 PDF 文件应用处理功能。
3.  不管发生什么，关闭文件。

我最近了解了上下文管理器和`with`语句，这对他们来说似乎是一个很好的用例。因此，我从定义`PDFMinerWrapper`类开始：

```
class PDFMinerWrapper(object):
    '''
    Usage:
    with PDFWrapper('/path/to/file.pdf') as doc:
        doc.dosomething()
    '''
    def __init__(self, pdf_doc, pdf_pwd=''):
        self.pdf_doc = pdf_doc
        self.pdf_pwd = pdf_pwd

    def __enter__(self):
        self.pdf = open(self.pdf_doc, 'rb')
        parser = PDFParser(self.pdf)  # create a parser object associated with the file object
        doc = PDFDocument()  # create a PDFDocument object that stores the document structure
        parser.set_document(doc)  # connect the parser and document objects
        doc.set_parser(parser)
        doc.initialize(self.pdf_pwd)  # pass '' if no password required
        return doc

    def __exit__(self, type, value, traceback):
        self.pdf.close()
        # if we have an error, catch it, log it, and return the info
        if isinstance(value, Exception):
            self.logError()
            print traceback
            return value 
```

现在我可以轻松地处理 PDF 文件，并确保它能够优雅地处理错误。理论上，我需要做的就是这样的：

```
with PDFMinerWrapper('/path/to/pdf') as doc:
    foo(doc) 
```

这很好，除了我需要在将函数应用于返回的对象**之前**检查 PDF 文档是否可提取`PDFMinerWrapper`。我目前的解决方案涉及一个中间步骤。

我正在使用我调用的一个类，该类`Pamplemousse`用作处理 PDF 的接口。反过来，`PDFMinerWrapper`每次必须对对象已链接到的文件执行操作时，它都会使用它。

下面是一些（删节的）代码，演示了它的使用：

```
class Pamplemousse(object):
    def __init__(self, inputfile, passwd='', enc='utf-8'):
        self.pdf_doc = inputfile
        self.passwd = passwd
        self.enc = enc

    def with_pdf(self, fn, *args):
        result = None
        with PDFMinerWrapper(self.pdf_doc, self.passwd) as doc:
            if doc.is_extractable:  # This is the test I need to perform
                # apply function and return result
                result = fn(doc, *args)

        return result

    def _parse_toc(self, doc):
        toc = []
        try:
            toc = [(level, title) for level, title, dest, a, se in doc.get_outlines()]
        except PDFNoOutlines:
            pass
        return toc

    def get_toc(self):
        return self.with_pdf(self._parse_toc) 
```

每当我希望对 PDF 文件执行操作时，我都会将相关函数`with_pdf`及其参数传递给该方法。`with_pdf`反过来，该方法使用该`with`语句来利用上下文管理器`PDFMinerWrapper`（从而确保优雅地处理异常）并在实际应用已传递的函数之前执行检查。

**我的问题如下：**

我想简化这段代码，这样我就不必显式调用`Pamplemousse.with_pdf`. 我的理解是装饰器在这里可能会有所帮助，所以：

1.  我将如何实现一个装饰器，其工作是调用`with`语句并执行可提取性检查？
2.  装饰器是否可以是类方法，或者我的装饰器必须是自由形式的函数或类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T00:30:54.233

我解释您的目标的方式是能够在您的`Pamplemousse`类上定义多个方法，而不必经常将它们包装在该调用中。这是它可能的真正简化版本：

```
def if_extractable(fn):
    # this expects to be wrapping a Pamplemousse object
    def wrapped(self, *args):
        print "wrapper(): Calling %s with" % fn, args
        result = None
        with PDFMinerWrapper(self.pdf_doc) as doc:
            if doc.is_extractable:
                result = fn(self, doc, *args)
        return result
    return wrapped

class Pamplemousse(object):

    def __init__(self, inputfile):
        self.pdf_doc = inputfile

    # get_toc will only get called if the wrapper check
    # passes the extractable test
    @if_extractable
    def get_toc(self, doc, *args):
        print "get_toc():", self, doc, args 
```

定义的装饰器`if_extractable`只是一个函数，但它希望用于您的类的实例方法。

曾经委托给私有方法的 decorated `get_toc`，如果它通过了检查，它只会期望接收一个`doc`对象和 args。否则它不会被调用并且包装器返回 None。

有了这个，你可以继续定义你的操作函数来期待一个`doc`

你甚至可以添加一些类型检查来确保它包装了预期的类：

```
def if_extractable(fn):
    def wrapped(self, *args):
    if not hasattr(self, 'pdf_doc'):
        raise TypeError('if_extractable() is wrapping '\
                        'a non-Pamplemousse object')
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T23:31:29.727

装饰器只是一个接受一个函数并返回另一个函数的函数。你可以做任何你喜欢的事情：

```
def my_func():
    return 'banana'

def my_decorator(f): # see it takes a function as an argument
    def wrapped():
        res = None
        with PDFMineWrapper(pdf_doc, passwd) as doc:
            res = f()
        return res
     return wrapper # see, I return a function that also calls f 
```

现在，如果您应用装饰器：

```
@my_decorator
def my_func():
    return 'banana' 
```

该`wrapped`函数将替换`my_func`，因此将调用额外的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T23:35:19.663

您可能想按照以下方式尝试：

```
def with_pdf(self, fn, *args):
    def wrappedfunc(*args):
        result = None
        with PDFMinerWrapper(self.pdf_doc, self.passwd) as doc:
            if doc.is_extractable:  # This is the test I need to perform
                # apply function and return result
                result = fn(doc, *args)
        return result
    return wrappedfunc 
```

当您需要包装函数时，只需执行以下操作：

```
@pamplemousseinstance.with_pdf
def foo(doc, *args):
    print 'I am doing stuff with', doc
    print 'I also got some good args. Take a look!', args 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T00:06:19.720

下面是一些演示代码：

```
#! /usr/bin/python

class Doc(object):
    """Dummy PDFParser Object"""

    is_extractable = True
    text = ''

class PDFMinerWrapper(object):
    '''
    Usage:
    with PDFWrapper('/path/to/file.pdf') as doc:
        doc.dosomething()
    '''
    def __init__(self, pdf_doc, pdf_pwd=''):
        self.pdf_doc = pdf_doc
        self.pdf_pwd = pdf_pwd

    def __enter__(self):
        return self.pdf_doc

    def __exit__(self, type, value, traceback):
        pass

def safe_with_pdf(fn):
    """
    This is the decorator, it gets passed the fn we want
    to decorate.

    However as it is also a class method it also get passed
    the class. This appears as the first argument and the
    function as the second argument.
    """
    print "---- Decorator ----"
    print "safe_with_pdf: First arg (fn):", fn
    def wrapper(self, *args, **kargs):
        """
        This will get passed the functions arguments and kargs,
        which means that we can intercept them here.
        """
        print "--- We are now in the wrapper ---"
        print "wrapper: First arg (self):", self
        print "wrapper: Other args (*args):", args
        print "wrapper: Other kargs (**kargs):", kargs

        # This function is accessible because this function is
        # a closure, thus still has access to the decorators
        # ivars.
        print "wrapper: The function we run (fn):", fn

        # This wrapper is now pretending to be the original function

        # Perform all the checks and stuff
        with PDFMinerWrapper(self.pdf, self.passwd) as doc:
            if doc.is_extractable:
                # Now call the orininal function with its
                # argument and pass it the doc
                result = fn(doc, *args, **kargs)
            else:
                result = None
        print "--- End of the Wrapper ---"
        return result

    # Decorators are expected to return a function, this
    # function is then run instead of the decorated function.
    # So instead of returning the original function we return the
    # wrapper. The wrapper will be run with the original functions
    # argument.

    # Now by using closures we can still access the original
    # functions by looking up fn (the argument that was passed
    # to this function) inside of the wrapper.
    print "--- Decorator ---"
    return wrapper

class SomeKlass(object):

    @safe_with_pdf
    def pdf_thing(doc, some_argument):
        print ''
        print "-- The Function --"

        # This function is now passed the doc from the wrapper.

        print 'The contents of the pdf:', doc.text
        print 'some_argument', some_argument
        print "-- End of the Function --"
        print ''

doc = Doc()
doc.text = 'PDF contents'
klass = SomeKlass()  
klass.pdf = doc
klass.passwd = ''
klass.pdf_thing('arg') 
```

我建议运行该代码以查看它是如何工作的。需要注意的一些有趣的点：

首先，您会注意到我们只传递了一个参数，`pdf_thing()`但是如果您查看该方法，它需要两个参数：

```
@safe_with_pdf
def pdf_thing(doc, some_argument):
    print ''
    print "-- The Function --" 
```

这是因为如果您查看我们所有功能的包装器：

```
with PDFMinerWrapper(self.pdf, self.passwd) as doc:
    if doc.is_extractable:
        # Now call the orininal function with its
        # argument and pass it the doc
        result = fn(doc, *args, **kargs) 
```

我们生成 doc 参数并将其与原始参数 ( `*args, **kargs`) 一起传入。这意味着使用此装饰器包装的每个方法或函数除了在其声明 ( )`doc`中列出的参数外，还会收到一个附加参数。`def pdf_thing(doc, some_argument):`

另一件需要注意的是包装器：

```
def wrapper(self, *args, **kargs):
    """
    This will get passed the functions arguments and kargs,
    which means that we can intercept them here.
    """ 
```

还捕获`self`参数并且不将其传递给被调用的方法。您可以通过以下方式修改函数调用来更改此行为：

```
result = fn(doc, *args, **kargs)
    else:
        result = None 
```

到：

```
result = fn(self, doc, *args, **kargs)
    else:
        result = None 
```

然后将方法本身更改为：

```
def pdf_thing(self, doc, some_argument): 
```

希望对您有所帮助，请随时要求更多说明。

编辑：

回答你问题的第二部分。

是的可以是一个类方法。只需放在`safe_with_pdf`上面`SomeKlass` **并**调用它，例如类中的第一个方法。

这里也是上述代码的简化版本，在类中有装饰器。

```
class SomeKlass(object):
    def safe_with_pdf(fn):
        """The decorator which will wrap the method"""
        def wrapper(self, *args, **kargs):
            """The wrapper which will call the method is a doc"""
            with PDFMinerWrapper(self.pdf, self.passwd) as doc:
                if doc.is_extractable:
                    result = fn(doc, *args, **kargs)
                else:
                    result = None
            return result
        return wrapper

    @safe_with_pdf
    def pdf_thing(doc, some_argument):
        """The method to decorate"""
        print 'The contents of the pdf:', doc.text
        print 'some_argument', some_argument
        return '%s - Result' % doc.text

print klass.pdf_thing('arg') 
```

# android - Android - IntelliJ 模拟器问题中的模拟位置

> ID：11659990
> 
> 赞同：0
> 
> 时间：2012-07-25T23:07:44.683
> 
> 标签：android, android-emulator, android-location

我对 Android 开发相当陌生，我正在尝试开发一个应用程序以跟上进度，我遇到了一个奇怪的问题。有时这个应用程序似乎可以正常工作，但大多数时候它不能。我正在尝试从应用程序中简单地设置设备的 GPS 纬度/经度；仅此而已。我利用了从其他帖子中收集的大量知识，但最后，我不确定我的应用程序是否由于模拟器怪癖而无法运行，或者它是否是我的代码。作为参考，我使用的是 IntelliJ，我的目标是 2.3.3，我确实在我的模拟器上启用了 GPS，并且我确实在我的清单中设置了适当的权限。

奇怪的是，当我打开模拟器时它有时工作正常，然后我通过终端远程登录并通过“geo fix”设置地理位置，然后返回应用程序，它显示我输入的 GPS 纬度/经度。但通常它根本不起作用。当我尝试通过代码中的模拟位置以编程方式执行此操作时，我得到了相同的结果。

这是我在 onCreate() 方法顶部的代码（locationManager 是一个类级字段）：

```
 locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);
    locationManager.addTestProvider(LocationManager.GPS_PROVIDER, false, false, false, false, false, true, true, 0, 5); 
```

..当用户在 UI 中输入纬度/经度并点击提交按钮时，在提取字段并完成一些轻度验证后调用以下代码：

```
Location mLocation = new Location(LocationManager.GPS_PROVIDER);
mLocation.setLatitude(Float.valueOf(inputLat));
mLocation.setLongitude(Float.valueOf(inputLong));
mLocation.setTime(System.currentTimeMillis());

locationManager.setTestProviderEnabled(LocationManager.GPS_PROVIDER, true);
locationManager.setTestProviderLocation(LocationManager.GPS_PROVIDER, mLocation);

refreshTheLocation(); 
```

作为参考， refreshTheLocation() 方法是：

```
public void refreshTheLocation() {
    LocationResult locationResult = new LocationResult(){
        @Override
        public void gotLocation(Location location){
            final Location finalLoc = location;

            if (location != null) {
                runOnUiThread(new Runnable() {
                    public void run() {
                        TextView gpsTextView = (TextView) findViewById(R.id.gps_label);
                        gpsTextView.setText("GPS DATA FOUND:\nLatitude: " + finalLoc.getLatitude() + "\nLongitude: " + finalLoc.getLongitude());
                     }
                });
            } else {
                runOnUiThread(new Runnable() {
                   public void run() {
                      TextView gpsTextView = (TextView) findViewById(R.id.gps_label);
                      gpsTextView.setText("GPS data not found");
                   }
                });
            }
        }
   };
   MyLocation myLocation = new MyLocation();
   myLocation.getLocation(this, locationResult);
} 
```

“MyLocation”类只是从这篇文章中最受好评的答案复制/粘贴：

[在 Android 上获取用户当前位置的最简单、最可靠的方法是什么？](https://stackoverflow.com/questions/3145089/what-is-the-simplest-and-most-robust-way-to-get-the-users-current-location-in-a)

关于我的问题可能是什么的任何想法？似乎大约有 1/5 的时间，它获取 GPS 坐标并显示它们，但其他 4/5 的时间，它没有。当它确实工作时，当我通过输入字段和按钮更改坐标时，它永远不会更新坐标。

请放轻松，因为我对这些东西还很陌生。;) 提前感谢你们提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T03:06:46.577

如果您的目标是 2.3.3 版本并且已经在 2.3.3 版本的 AVD 上进行测试，我建议您切换到 2.3.3 Google APIs 版本的 API，然后尝试模拟位置。

# c++ - 参数太多，函数指针中的参数太少

> ID：11659991
> 
> 赞同：0
> 
> 时间：2012-07-25T23:07:49.470
> 
> 标签：c++, function-pointers

我正在尝试从基础开始学习 c++，并且正在玩弄函数指针。考虑到这段代码：

```
#include <iostream>
#include <string>
#include <vector>

bool print(std::string);
bool print(std::string a) 
{
    std::cout << a << std::endl;
    return true;
}

bool call_user_function(bool(std::string), std::vector<std::string>);
bool call_user_function(bool(*p)(std::string), std::vector<std::string> args) {
    if (args.size() == 0)
        return (*p)();                    (*)
    else if (args.size() == 1)
        return (*p)(args[0]);
    else if (args.size() == 2)
        return (*p)(args[0], args[1]);    (**)
}

int main(int argc, char** argv) 
{
    std::vector<std::string> a;
    a[0] = "test";
    call_user_function(print, a);
    // ok
    return 0;
} 
```

它给了我：

> main.cpp:28 (*): error: too little arguments to function
> 
> main.cpp:32 (**): 错误：函数参数太多

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T23:10:56.133

`p`是类型`bool(*)(std::string)`。这意味着它是一个指向函数的指针，该函数具有一个类型的参数`std::string`并返回一个`bool`.

`p`可以指向`print`，因为`print`匹配的类型：它是一个函数，它有一个类型的参数`std::string`并返回一个`bool`.

您的第一个错误表达式 ,`(*p)()`尝试`p`不带参数调用。您的第二个错误表达式，`(*p)(args[0], args[1])`尝试`p`使用两个参数进行调用。

参数的数量必须与参数的数量相匹配，因此它们都是格式错误的，就像尝试`print`不带参数或带两个参数直接调用会导致编译错误一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T23:22:13.973

@JamesMcNellis 已经解决了代码的问题。

要完成这样的工作，您可能需要执行以下操作：

```
bool call_user_function(bool(*p)(std::string), std::vector<std::string> args) {
    bool ret = true;
    for (int i=0; i<args.size(); i++)
         ret &= p(args[i]);
    return ret;
} 
```

...或者，你可以使用 std::for_each （因为你没有使用它，我暂时忽略返回值）：

```
// avoid copying vector by passing reference to const vector.
void call_user_function(bool (*p)(std::string), std::vector<std::string> const &args) {
    std::for_each(args.begin(), args.end(), p);
} 
```

...但是，由于您只是打印出向量的内容，因此您应该使用的可能更像是这样的：

```
std::copy(a.begin(), a.end(), 
          std::ostream_iterator<std::string>(std::cout, "\n")); 
```

另请注意，您`a[0] = "test";`的无效。你想要`a.push_back("test");`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T23:12:54.827

`print`对于没有参数的调用没有重载。

`print`也没有两个`std::string`参数的重载。

# php - WordPress 页面库

> ID：11659992
> 
> 赞同：0
> 
> 时间：2012-07-25T23:07:56.723
> 
> 标签：php, wordpress

我正在尝试拥有一个 wordpress 页面画廊。

代码应该获取某个页面的所有子页面，并返回带有页面缩略图及其名称的结果。缩略图必须是可点击的链接。

我已经到了这一点，并且被卡住了：

```
 <?php $pages = get_pages(array('child_of' => 8)); ?>  

        <?php foreach ($pages as $page): ?> 
            <h1><?php echo $page['post_title'] ?></h1> 
            <a href="<?php echo $page['guid'] ?>"><img src="" /></a> 
        <?php endforeach; ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T00:33:58.443

欢迎来到堆栈溢出。第一件事是第一件事：如果您有任何未来的问题想在 SO 上提出，说“它不起作用”并不能告诉我们任何事情。如果你的车有问题，你会去维修店说“我的车坏了，告诉我怎么了”？

请记住这一点。

要回答您的问题，从 get_pages 或 get_posts （或任何标准 WP 查询对象）返回的项目不是关联数组。它们是对象。像这样访问它们：

```
<?php
$pages = get_pages(array('child_of' => 8));
foreach($pages as $page):
?> 
    <h1><?php echo $page->post_title; ?></h1> 
    <a href="<?php echo $page->guid; ?>"><img src="" /></a> 
<?php
endforeach;
?> 
```

**更新：**你正在做的事情并不坏，但它很草率。这也不是你的错，因为它发生在每个 Wordpress 的新手身上。

您所做的是基本上创建了一个没有内容的“空白”页面，并且您的意图是将其用作页面存档模板的一种外壳（每个页面都是绘画页面的子页面）。实际上，您甚至不需要这样做。

从主菜单中的类来看，您正在使用菜单对象（位于外观-> 菜单中）在页面顶部创建菜单栏。这非常好，并且是生成菜单的最佳方式。

至于以“Wordpress 友好”的方式生成您的绘画档案，您应该创建一个类别（帖子-> 类别），将其命名为“绘画”，然后单击添加新类别按钮。

然后，获取您已经创建的所有绘画页面，将它们移至新帖子，并为您创建的每个帖子选择“绘画”选项。

完成后，您可以在菜单对象中为绘画类别切换空的绘画页面（现在在类别选择器的左侧可用）。这将创建一个链接，告诉 Wordpress 和您的主题仅查询“绘画”类型的帖子并将结果汇​​总到一个页面上，这就是您想要的。

这样做的好处是，如果您想将每幅绘画进一步分类为不同的子类别，您也可以这样做。例如，您可以将名为“水彩”的新类别设为“绘画”的子类别，并使用该类别标记所有水彩文章。

您拥有的主题本身似乎并不坏。在尝试拆分或从头开始创建自己的代码之前，最好先习惯 Wordpress 流程和组织。

让我知道这是否有帮助。

# css - CSS/HTML - Internet Explorer 8 的问题（边框半径、图像覆盖和填充）

> ID：11659993
> 
> 赞同：0
> 
> 时间：2012-07-25T23:08:03.857
> 
> 标签：css, internet-explorer

我在 Internet Explorer 中查看我的网站时遇到问题。在下面的 CSS/HTML 中，图像应该是轮廓的、弯曲的半径，并被缩放以适应。但是 IE 8 不会缩放图像、弯曲角落，也不会出现轮廓。这是 jsfiddle： http: [//jsfiddle.net/pave4/](http://jsfiddle.net/pave4/) 这个页面在最新的 IE (IE8) 中很好，但是我需要确保它也适用于旧版本的 IE。

HTML：

```
<ul>
<li>
    <a href="/aboutme/">
    <span class="img-outline"><span class="page-img" id="aboutme"></span></span>
    <span class="page-title">About Me</span>
    </a>
</li>
</ul> 
```

​ CSS：

```
.page-title {
      text-align: center;
      display:block;
      text-decoration: none;
}

.img-outline {
  height: 100%;
  background: rgba(0, 0, 0, .3);
  padding: 5px;

  display: block;   
  margin-left: auto;   
  margin-right: auto;

  -webkit-border-radius: 18%;
  -moz-border-radius: 18%;
  border-radius: 18%;
}

.page-img {
  height: 100%;
  background: rgba(50, 50, 50, 1);
  background-size:115px 115px;
  background-repeat:no-repeat;

  display: block;   
  margin-left: auto;   
  margin-right: auto;

  -webkit-border-radius: 15%;
  -moz-border-radius: 15%;
  border-radius: 15%;
}

li,
li.current,
li.current:visited {
    margin-left: 1px;
    margin-right: 1px;
    width: 118px;
    height: 112px;
    display: block;
    float: left;
    position: relative;
    opacity: .6;
}

li:hover { opacity: 1; }

li .img-outline {
  width: 70px;
  height: 70px;
}

li .page-img {
    background-size:70px 70px;
}

li #aboutme {
    background-color: rgb(36, 112, 245);
    background-image: url('http://www.rasnickjewelry.com/images/uploads/900_Animals_300/901_Elephant_Head_Ring_side_R300.jpg');
} 
```

​</p>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T23:13:03.557

恐怕您正在使用许多 IE8 不支持的 CSS3 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T08:49:17.683

正如我在对您的原始问题的评论中所说，高达 8 的 IE 不支持 rgba 颜色。由于您不使用 alpha 通道，因此请`background-color: #323232;`改用。

IE8 也不支持标准`opacity`属性，您需要`filter: alpha(opacity=60);`代替（百分比值没有 %）。相关的可能是 IE 中的元素需要`layout`正确呈现：有很多文章涵盖了这个主题。一个好的是[On Have Layout](http://www.satzansatz.de/cssd/onhavinglayout.html)。

要了解支持的 CSS 属性和功能，请使用资源，例如[When Can I Use](http://caniuse.com)或[Quirksmode](http://www.quirksmode.org/compatibility.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T23:23:01.613

不要调整带有样式的图像大小，以精确的大小上传它们，这将节省您的加载时间。

关于边框半径等其他样式尝试使用此工具[http://css3pie.com/](http://css3pie.com/)

# magento - 如果系统配置数据存储在文件中，如何加载？

> ID：11659999
> 
> 赞同：1
> 
> 时间：2012-07-25T23:08:42.410
> 
> 标签：magento

我正在 magento 的管理后端设置系统配置，它当前将数据存储在文件中，我想让 Magento 从文件中获取数据以显示当前值。我应该重载什么方法来实现这一点？我以为是`load()`扩展后的功能`Mage_Core_Model_Config_Data`，但这是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T00:25:02.210

为了为您的管理员设置系统配置数据，您可以尝试在 sql 文件夹中的本地模块中编写升级脚本。下面是我为 Avalanche 设置系统配置值的一个示例。

```
 <?php
    $setup = new Mage_Eav_Model_Entity_Setup('core_setup');
    $setup->startSetup();
    $setup->setConfigData('avalanche_config/avalanche_design/avalanche_customcss','1');
    $setup->endSetup(); 
```

setConfig 数据的语法和用法

```
 ***setConfigData***
    access: public
    void setConfigData ( $path,  $value, [ $scope = 'default'], [ $scopeId = 0], [      $inherit = 0])
    $path
    $value
    $scope
    $scopeId
    $inherit 
```

您可以参考[http://codemagento.com/2011/02/install-scripts-and-upgrade-scripts/](http://codemagento.com/2011/02/install-scripts-and-upgrade-scripts/)编写升级脚本。

这是设置系统配置数据的解决方案之一，我不确定这是否适合您。无论如何，祝你好运。

斯瓦普纳