# StackOverflow 问答 000577000-000577999

# database - 使用其他数据库（例如 Oracle）时，Firebirds“开始于”的等价物是什么？

> ID：577005
> 
> 赞同：1
> 
> 时间：2009-02-23T09:25:55.380
> 
> 标签：database, oracle, firebird

我正在研究更新我们的应用程序以使用 Firebird 以外的数据库服务器的可能性。我们依靠“STARTING WITH”来访问我们的分层数据。没有它，我看不出我们如何在不进行认真的重新设计的情况下迁移到另一个数据库。

如果您不熟悉“STARTS WITH”，它只会检查字符串字段是否以特定字符串开头，例如...

```
WHERE 'This is a test' STARTS WITH 'This is' ... 
```

将返回 true。如果列被索引，则索引将用于比较。

其他数据库服务器（尤其是 Oracle/MSSQL）是否支持“STARTING WITH”（或“STARTS WITH”）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T09:29:09.040

实现这一点的标准 SQL 类似于 ... WHERE 'This is a test' like 'This is%';

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T09:32:19.080

一些数据库还支持 WHERE LEFT('This is a test', 7) = 'This is' （虽然我不记得这是否是 SQL 标准的一部分）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T09:42:24.623

Oracle 的 Select 有一个“Start With” http://www.oracle.com/pls/db10g/db10g.show_toc?which=main&partno=b10759&maxlevel=2§ion=&expand=41274">Oracle 文档 10g 用于分层查询。它是Oracle 多年（至少是 Oracle 8）。

不确定 SQL Server。

# c++ - 使用 g++ 在 Windows 上生成文件，链接库

> ID：577006
> 
> 赞同：6
> 
> 时间：2009-02-23T09:25:57.083
> 
> 标签：c++, windows, makefile, g++

我已经厌倦了 MSVC++6 以及每个人总是告诉我它是一个糟糕的编译器等等。

所以现在我决定尝试使用 vim 加上 g++ 和 makefile。这是我的问题；我有以下生成文件：

```
# This is supposed to be a comment..
CC = g++
# The line above sets the compiler in use..
# The next line sets the compilation flags
CFLAGS=-c -Wall

all: main.exe

main.exe: main.o Accel.o
    $(CC) -o main.exe main.o Accel.o 

main.o: main.cpp Accel.h
    $(CC) $(CFLAGS) main.cpp

Accel.o: Accel.cpp Accel.h
    $(CC) $(CFLAGS) Accel.cpp

clean:
    del main.exe *.o 
```

这在尝试时会出错`make`，因为我需要链接到一个名为 的 Windows 库`Ws2_32.lib`，这是`Winsock2.h`我`include`在我的一个`.h`文件中需要的。

那么我该怎么做呢？我已经尝试过这个`-l`选项，但我无法让它工作。它如何与有空格的路径一起工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T09:40:57.717

第一步：找到您要查找的库。对我来说，它在：

```
C:\Program Files\Microsoft Visual Studio\VC98\Lib 
```

第二步，使用 -L 传递该目录：

```
LINKFLAGS=-L"C:\Program Files\Microsoft Visual Studio\VC98\Lib" 
```

第三步，用-l（小写L）传递库的名称：

```
LINKFLAGS=-L"C:\Program Files\Microsoft Visual Studio\VC98\Lib" -lWs2_32 
```

然后使用它：

```
main.exe: main.o Accel.o
   $(CC) $(LINKFLAGS) -o main.exe main.o Accel.o 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T09:35:38.820

这不是您问题的答案，但我建议使用[cmake](http://www.cmake.org)。它是一个多平台多构建环境项目文件生成器。CMake 文件的语法非常简单（肯定比 Makefile 更简单），它会根据要求生成 Makefile 或 Visual Studio 项目。

手工编码的 Makefile 的问题在于，您的依赖关系树很快就会变得如此之大，以至于维护构建所需内容的所有规则变得非常繁琐。因此，有大量的 Makefile 生成器（autotools、CMake）或 Makefile 替代品（Scons、waf、bjam、....）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T09:39:07.423

用于`-L`指定[gcc 应在其中搜索库](http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Directory-Options.html#Directory-Options)的目录。使用`-l`（小写 ell）指定要从`-L`路径（和一些默认值）链接的库。

要使用空格转义路径，请根据 shell 的需要使用反斜杠、单引号或双引号。请参阅[GNU make 文档](http://www.gnu.org/software/make/manual/make.html#Commands)、[GNU bash 文档](http://www.gnu.org/software/bash/manual/bashref.html#Quoting)。[有关GNU makefile 其他部分中的空格的信息，](http://www.cmcrossroads.com/content/view/7859/268/)请参阅这篇文章。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T09:57:24.697

您应该链接到编译器提供的库。如果是 cygwin，您应该安装 win32 api 头文件和库文件，然后与 libws2_32 链接（编译器选项将类似于 -lws2_32）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T09:29:52.877

MSVC++6 有点进展，但你没有提到你是如何使用 MSVC++9 和 nmake 的（visual c++ express 2008）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-01T19:47:32.783

```
LIBS = -L"..\Microsoft SDKs\Windows\v6.0A\Lib" -lWS2_32

$(CC) ... -o ... ... $(LIBS) 
```

这种语法对我有用！

# apache-flex - Flex：关闭标题窗口后如何将值从标题窗口传递到主窗口？

> ID：577017
> 
> 赞同：0
> 
> 时间：2009-02-23T09:30:45.697
> 
> 标签：apache-flex

我一直在网上搜索这个，但我没有找到答案。我有来自标题窗口的数组数据，我需要在关闭标题窗口后直接传递给主窗口。

这是我在主窗口上的代码

```
 private function showWindow():void 
    {
    var dataCntnrsForTxt: Array = new Array;
    var ttlWindow:addQuest=addQuest(PopUpManager.createPopUp(this, addQuest, true));

    pointer.x=btnaddQuestion.x;
    pointer.y=btnaddQuestion.y;                
    pointer=btnaddQuestion.localToGlobal(pointer);
    ttlWindow.x=pointer.x-500;
    ttlWindow.y=pointer.y;

    ttlWindow.dataCntnrsForTxt= dataCntnrsForTxt;                      

    var i: int;
    for (i = 0; i < dataCntnrsForTxt.length; i++)
{
  var lblshow: Label = new Label;
      lblcntnrs.addChild(lblshow);
      lblshow.text = dataCntnrsForTxt[i];       
    }

   } 
```

我想在关闭标题窗口后自动将结果显示到主窗口

这是标题窗口上的代码

```
 [Bindable]
  public var dataCntnrsForTxt: Array = new Array;

  private function trythis():void
  {
  var i:int;
  for (i = 0; i < contnrs.numChildren; i++)
   {
    dataCntnrsForTxt.push(TextInput(contnrs2.getChildAt(i)).text);             
   }
  PopUpManager.removePopUp(this);
  } 
```

我是弹性编程的新手。预先感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T09:52:12.417

我建议在标题窗口关闭时调度一个事件。该事件还可以将要返回的值存储在属性中。然后，在您的主应用程序中处理该事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T10:27:34.330

正如另一个答案所说，事件是一种常见的方法，而且很好，因为它们将您的标题窗口与主窗口分离。它们是进入 Flex 的好习惯，值得付出努力，所以这可能是最好的答案。

使您的数组成为主窗口上的公共可绑定变量并从标题窗口填充它是第二种方法，但我不喜欢这种方法，因为这两个组件彼此了解太多，并且您依赖于数据绑定，即可能比您实际需要的更多（例如，如果您将主窗口中的控件绑定到同一个数组，它将在显示标题窗口时在后台忙于更新。这意味着您有一个繁琐的“取消”处理如果你需要一个）。

只是为了给您第三种方法，您可以将一个函数传递给您的标题窗口，该窗口在窗口关闭时被调用。例如，在您的标题窗口中，您有声明...

```
public var onClose:Function; 
```

在标题窗口上为自己编写一个处理程序，绑定到`close`调用外部函数并传递数组的事件......

```
private function doClose():void
{
    if (onClose != null) onClose(myArray);
} 
```

然后调用者必须有一个可以调用的函数......

```
private function handleTitleWindowClose(myArray:Array):void
{
    // do something in here
} 
```

然后在显示之前将其传递给 TitleWindow 类...

```
ttlWindow.onClose = handleTitleWindowClose; 
```

这可能不如事件好，但比共享魔术变量好。它不是一个清晰的 API，因为 onClose 的参数没有在任何地方记录，编译器不会在参数列表中发现错误，但了解它是有用的模式。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T09:42:31.473

```
var dataCntnrsForTxt: Array = new Array; 
```

这是一个局部变量，它的范围仅限于`showWindow()`函数。一旦你脱离了它，你就不应该玩它。或者，否则您可以从函数中返回它（而不是`void`使用数组）。

```
[Bindable]
public var dataCntnrsForTxt: Array = new Array; 
```

这个更好。您现在可以从任何地方访问它。请注意，如果要绑定它，**最好**使用 an 。`ArrayCollection`这是 Flex 3.2[文档](http://livedocs.adobe.com/flex/3/html/help.html?content=databinding_4.html)：

> 在定义使用数组作为数据绑定表达式源的数据绑定表达式时，数组应该是 ArrayCollection 类型，因为 ArrayCollection 类会在数组或数组元素发生更改以触发数据绑定时调度事件。例如，对 ArrayCollection.addItem()、ArrayCollection.addItemAt()、ArrayCollection.removeItem() 和 ArrayCollection.removeItemAt() 的调用都会触发数据绑定。

你可以试试`ArrayCollection`吗？

# iphone - 哪个 GUI 类似于 iphone 上的列表框？

> ID：577026
> 
> 赞同：2
> 
> 时间：2009-02-23T09:36:22.063
> 
> 标签：iphone, user-interface, listbox, interface-builder

我正在尝试将以前的应用程序从 windows mobile 移动到 iphone。Interface Builder中的GUI具有与列表框类似的功能有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T10:41:56.743

UITableView 适用于您有一个列表（可能是一个很长的列表）并且您想通过点击列表中的项目来导航层次结构的情况。

另请查看 UIPickerView，它类似于组合框上的下拉列表。它不适用于导航或长列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T16:59:53.317

如前所述，在 iPhone 上没有什么比这更好的了。UITableView，可能带有“搜索”字段，是长列表的常用解决方案。

内置邮件应用程序执行地址搜索的方式对于您使用组合框的大多数地方来说似乎非常有用。看看那个。

# css - 如何在 GWT 中浮动元素

> ID：577029
> 
> 赞同：3
> 
> 时间：2009-02-23T09:38:09.283
> 
> 标签：css, gwt

我在 GWT 中有一个元素。我希望它正确浮动。我试过`DOM.setStyleAttribute(element, "float", "right");`但没有工作。我不确定我是否使用了正确的属性（浮点数）。你有什么主意吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-09T12:12:24.627

浮动的正确方法是使用“cssFloat”属性：

```
DOM.setStyleAttribute(element, "cssFloat", "right"); 
```

“float”是 javascript 中的保留关键字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T09:43:25.887

好的，这引出了一个明显的问题......你为什么不使用 GWT 布局来做到这一点？这有点像 GWT 的意义在于（至少部分地）抽象 CSS 定位/布局。或者，更确切地说，使用更熟悉的桌面 GUI 布局模型（BoxLayout、GridLayout 等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T15:12:26.890

我的想法是您可以通过静态 XHTML 和 CSS 文件方法解决这个问题。然后，一旦它在那里工作，您就可以将其转换为 gwt 方法。

对于 GWT 方法，我仍然会提倡样式和表示的理念保留在 CSS 文件中，静态结构保留在宿主 HTML 文件中，而动态小部件放置发生在 GWT 代码中。

值得提醒（或提及）的是，当您将这些 DIV 和 SPAN 布局为使用 id 时，可以帮助您在 GWT 代码中定位该元素并使用动态控件填充它。当然，在元素定义中使用“类”来改进您将用来执行浮动的 CSS。

# iphone - 当应用程序在 iPhone 上崩溃时如何发送电子邮件？

> ID：577034
> 
> 赞同：2
> 
> 时间：2009-02-23T09:39:37.937
> 
> 标签：iphone, objective-c

前几天我正在使用一个崩溃的应用程序，但当它崩溃时还要求发送一封包含崩溃信息的电子邮件。

有谁知道这是怎么做到的？

也许它是代码中的一个异常处理程序，在它让应用程序死机之前，发送了电子邮件，但只是想知道 iphone sdk 中是否有任何 onCrash 类型的钩子。

谢谢，克里斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T09:53:18.983

[PLCrashReporter](http://code.google.com/p/plcrashreporter/)试图提供一个框架来做到这一点。我自己还没有使用它，但正在考虑它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T09:41:26.950

您基本上将整个应用程序包装在一个 try/catch 中，如果您发现错误，您可以提供电话回家并提供详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T10:35:00.440

在应用程序关闭之前似乎有这个钩子可用：

```
NSSetUncaughtExceptionHandler() 
```

> 设置顶级错误处理函数，您可以在该函数中在程序终止前执行最后一分钟的日志记录。

# c# - 当前上下文中不存在名称“loginrand”

> ID：577048
> 
> 赞同：1
> 
> 时间：2009-02-23T09:45:48.797
> 
> 标签：c#, .net

我只是尝试为 travian 创建机器人，我找到了一些登录代码

```
 //download html 
        WebClient client = new WebClient();
        client.Encoding = System.Text.Encoding.UTF8;
        string source = client.DownloadString(@"Http://" + server + "/login.php");
        source = source.Replace("\"", "");

        //search for user

        Regex rloginName = new Regex(@"name=login value=\w*");
        Match mloginName = rloginName.Match(source);
        if (mloginName.Success)
        {
            string loginName = mloginName.ToString().Replace(@"name=login value=", "");
        }

        //search for pass

        Regex rloginPassword = new Regex(@"type=password name=\w*");
        Match mloginPassword = rloginPassword.Match(source);
        if (mloginPassword.Success)
        {
            string loginPassword = mloginPassword.ToString().Replace(@"type=password name=", "");
        }

        Regex rloginUsername = new Regex(@"input class=fm fm110 type=text name=\w*");
        Match mloginUsername = rloginUsername.Match(source);
        if (mloginUsername.Success)
        {
            string loginUsername = mloginUsername.ToString().Replace(@"input class=fm fm110 type=text name=", "");
        }
        Regex rloginRand = new Regex(@"<p align=center><input type=hidden name=\w*");
        Match mloginRand = rloginRand.Match(source);
        if (mloginRand.Success)
        {
            string loginrand = mloginRand.ToString().Replace("<p align=center><input type=hidden name=", "");
        }

        string postString = @"w=1024:768&login=" + loginName + "&" + loginUsername + "=" + user + "&" + loginPassword + "=" + pass + "&" + loginrand + "=&s1.x=10&s1.y=10&s1=login";

        WebRequest req = WebRequest.Create(@"http://" + server + "/dorf1.php");
        req.ContentType = "application/x-www-form-urlencoded";
        req.Method = "POST";
        byte[] bytes = System.Text.Encoding.ASCII.GetBytes(postString);
        req.ContentLength = bytes.Length;
        req.ContentLength = bytes.Length;
        Stream os = req.GetRequestStream();
        os.Write(bytes, 0, bytes.Length);
        os.Close();
        WebResponse resp = req.GetResponse();
        StreamReader sr = new StreamReader(resp.GetResponseStream()); 
```

但是当我尝试运行时，我看到了这个错误，

Form1.cs(67,144): error CS0103: The name 'loginrand' does not exist in the current context error CS0103: The name 'loginPassword' does not exist in the current context error CS0103: The name 'loginUsername' does not exist in the current context当前上下文错误 CS0103：当前上下文中不存在名称“loginName”

有人可以帮忙吗

* * *

字符串登录和；if (mloginRand.Success) { loginrand = mloginRand.ToString().Replace("

但没有任何改变:(

> ```
> ------ Build started: Project: travian-ah, Configuration: Debug Any 
> ```
> 
> CPU ------ C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Csc.exe /noconfig /nowarn:1701,1702 /errorreport:prompt /warn:4 /define:DEBUG;TRACE /reference: C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Data.dll /reference:C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Deployment.dll /reference:C:\WINDOWS \Microsoft.NET\Framework\v2.0.50727\System.dll /reference:C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Drawing.dll /reference:C:\WINDOWS\Microsoft.NET\Framework \v2.0.50727\System.Windows.Forms.dll /reference:C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.Xml.dll /debug+ /debug:full /optimize- /out:obj\Debug \travian-ah.exe /resource:obj\Debug\travian_ah.Form1.resources /resource:obj\Debug\travian_ah.Properties.Resources.resources /target:winexe Form1.cs Form1.Designer.cs 程序。cs Properties\AssemblyInfo.cs Properties\Resources.Designer.cs Properties\Settings.Designer.cs C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\travian-ah\travian-ah\Form1.cs(33, 64): error CS0165: Use of unassigned local variable 'server' C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\travian-ah\travian-ah\Form1.cs(70,56): error CS0165:使用未分配的局部变量'loginName' C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\travian-ah\travian-ah\Form1.cs(70,74)：错误 CS0165：使用未分配的局部变量' loginUsername' C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\travian-ah\travian-ah\Form1.cs(70,96): error CS0165: Use of unassigned local variable 'user' C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\travian-ah\travian-ah\Form1.cs(70,109): 错误 CS0165: Use of unassigned local variable 'loginPassword' C:\Documents and Settings\My Documents\ Visual Studio 2005\Projects\travian-ah\travian-ah\Form1.cs(70,131): 错误 CS0165: Use of unassigned local variable 'pass' C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\travian- ah\travian-ah\Form1.cs(70,144)：错误 CS0165：使用未分配的局部变量“loginrand”使用未分配的局部变量 'pass' C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\travian-ah\travian-ah\Form1.cs(70,144)：错误 CS0165：使用未分配的局部变量 'loginrand'使用未分配的局部变量 'pass' C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\travian-ah\travian-ah\Form1.cs(70,144)：错误 CS0165：使用未分配的局部变量 'loginrand'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T09:49:20.893

1.  不要烦人并为在线游戏创建机器人。
2.  了解变量作用域，在 if 语句中声明变量意味着该变量在它之外不可用。

例如：

```
if (mloginPassword.Success)
{
    // variable defined here
    string loginPassword = 
        mloginPassword.ToString().Replace(@"type=password name=", "");
}
// variable not available here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T09:48:56.090

这些变量是在 IF 块中声明的，因此它们仅在该块中是已知的。在 if 块之前声明它们，例如：

```
string loginrand;
if (mloginRand.Success)
{
    loginrand = mloginRand.ToString().Replace("<p align=center><input type=hidden name=", "");
} 
```

也许在尝试调整一些代码之前阅读一本好的 C# 书籍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T09:49:58.583

您在围绕它们的 if 块范围内定义这些字符串。脱离如果，你也会掉线。

只需将这些声明移至代码顶部即可。

# iphone - iphone的用户语音，任何直接为iphone屏幕格式化的东西？

> ID：577051
> 
> 赞同：0
> 
> 时间：2009-02-23T09:47:08.920
> 
> 标签：iphone

有谁知道一个类似于[uservoice](https://web.archive.org/web/20090219112537/http://stackoverflow.uservoice.com:80/)的网站，它提供了一个特定于 iPhone 的 Web 前端？

计划是在我的 iphone 应用程序中有一个用于用户反馈的链接，这将在 uservoice 或类似网站上打开移动 safari？

也就是说，一个带有 iphone/mobile safari 调整的 bug 跟踪器？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-08-30T05:36:05.167

我听说 Crittercism ( [http://www.crittercism.com/](http://www.crittercism.com/) ) 效果很好，而且它是免费的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T01:15:52.943

我想知道，在 iPhone 中使用 UserVoice 有什么问题？它非常易读，每个人都知道如何使用它:)

[替代文字 http://img509.imageshack.us/img509/6899/photoxxz.jpg](http://img509.imageshack.us/img509/6899/photoxxz.jpg)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T22:08:28.510

您可以尝试[Jira](http://www.atlassian.com/software/jira/)，即使它是付费的，您也可以获得[个人或开源项目的免费许可证](http://www.atlassian.com/software/jira/licensing.jsp#nonprofit)。iPhone 应用程序由[Shaun Ervine](http://www.apptism.com/developers/shaun-ervine)开发，售价 8.99 美元。[Daniel Dickison](http://danieldickison.com/)还有一个项目，用于一个 Bugzilla 应用程序，但它仍然是原始的。

我不得不提一下，我还没有尝试过 Jira（这里是 GIT 粉丝），但看起来不错，虽然有点贵。

# silverlight-2.0 - Silverlight - 在没有工具栏的资源管理器中启动

> ID：577055
> 
> 赞同：0
> 
> 时间：2009-02-23T09:48:53.907
> 
> 标签：silverlight-2.0

谁能告诉我如何使用 silverlight 应用程序，以便当我单击链接时，它会以给定大小启动浏览器，而没有工具栏。我的 java 脚本技能在最好的时候是有限的，所以任何帮助都将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T17:39:21.280

假设您要打开一个包含 silverlight 应用程序的新窗口，请像这样编写您的链接：

```
<a href="#" onclick="window.open('SilverlightUrl', 'windowName', 'resizable,toolbar=no,location=no,scrollbars=no,width=480,height=320,left=0,top=0');return false;">Silverlight link</a> 
```

这是一篇关于使用 javascript 创建弹出窗口的好文章： [http ://www.accessify.com/features/tutorials/the-perfect-popup/](http://www.accessify.com/features/tutorials/the-perfect-popup/)

# actionscript-3 - TextField() - 如何防止鼠标选择

> ID：577060
> 
> 赞同：3
> 
> 时间：2009-02-23T09:50:55.337
> 
> 标签：actionscript-3, flex3

如何使用 Editable TextField() 防止鼠标选择（和移动插入符号），这在选择文本时似乎不能完全工作，但它会阻止点击。我想将光标保持在它要去的地方。

```
protected function handleMouseDEvent(evt:MouseEvent):void {
if (evt.type == MouseEvent.MOUSE_DOWN) {
var max : int;
max = this.text.length;
this.setSelection(max, max) // SET CURSOR POSITION  
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-21T16:11:43.913

如果您的意思是防止选择 TextField，请使用：

```
TextField.selectable = false; 
```

但是，如果您的意思是防止 TextField 阻止它后面的对象，请使用：

```
TextField.mouseEnabled = false; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T10:00:48.027

selectable="false" 怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T23:42:52.310

您是否尝试过以编程方式将文本字段从输入切换为动态？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T10:13:11.500

每当用户关注文本字段时，在文本字段顶部放置一个透明按钮，将按钮设置为不使用 handCursor

一旦用户没有关注文本字段，请删除透明按钮

# delphi - 如何使用Delphi获取网卡的MAC地址？

> ID：577071
> 
> 赞同：6
> 
> 时间：2009-02-23T09:56:13.577
> 
> 标签：delphi, networking, ethernet

如何使用 Delphi 获取网卡的 MacAddress？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-23T10:51:57.000

[从Project JEDI API Header Library](http://www.delphi-jedi.org/apilibrary.html)获取 Microsoft IP Helper Library 的 JEDI 转换- 文件为 IPHlpAPI.zip。解压文件，需要 IpTypes.pas 和 IpHlpApi.pas。然后你可以使用这样的东西：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  NumInterfaces: Cardinal;
  AdapterInfo: array of TIpAdapterInfo;
  OutBufLen: ULONG;
  i: integer;
begin
  GetNumberOfInterfaces(NumInterfaces);
  SetLength(AdapterInfo, NumInterfaces);
  OutBufLen := NumInterfaces * SizeOf(TIpAdapterInfo);
  GetAdaptersInfo(@AdapterInfo[0], OutBufLen);

  Memo1.Lines.Clear;
  for i := 0 to NumInterfaces - 1 do begin
    Memo1.Lines.Add(Format('%.2x:%.2x:%.2x:%.2x:%.2x:%.2x',
      [AdapterInfo[i].Address[0], AdapterInfo[i].Address[1],
       AdapterInfo[i].Address[2], AdapterInfo[i].Address[3],
       AdapterInfo[i].Address[4], AdapterInfo[i].Address[5]]));
  end;
end; 
```

（省略了所有错误处理，您当然应该添加它。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-17T09:51:24.003

GetAdaptersAddresses[函数](https://msdn.microsoft.com/en-us/library/windows/desktop/aa365915(v=vs.85).aspx)是自 2001 年以来使用 Windows XP 获取适配器信息的首选方式。

适配器的信息由参数在[IP_ADAPTER_ADDRESSES 结构中返回。](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366058(v=vs.85).aspx)`AdapterAddresses`

> 该`GetAdaptersAddresses`函数可以检索**IPv4**和**IPv6**地址的信息。
> 
> 调用该`GetAdaptersAddresses`函数的推荐方法是预先分配参数指向的15KB工作缓冲区`AdapterAddresses`。在典型的计算机上，这大大减少了`GetAdaptersAddresses`函数返回的机会`ERROR_BUFFER_OVERFLOW`，这需要`GetAdaptersAddresses`多次调用函数。

* * *

```
procedure TForm1.Button1Click(Sender: TObject);
const
  AF_UNSPEC = 0;
  GAA_FLAG_INCLUDE_ALL_INTERFACES = $100;
  WORKING_BUFFER_SIZE = 15000;
  MAX_TRIES = 3;
var
  pAddresses,
  pCurrAddresses: PIpAdapterAddresses;
  dwRetVal,
  outBufLen: Cardinal;
  i: Integer;
  macAddress: string;
begin
  Memo1.Lines.Clear;

  outBufLen := WORKING_BUFFER_SIZE;
  pAddresses := nil;
  i := 0;
  repeat
    if Assigned(pAddresses) then
      FreeMem(pAddresses);

    GetMem(pAddresses, outBufLen);
    if not Assigned(pAddresses) then
      raise Exception.Create('Memory allocation failed for IP_ADAPTER_ADDRESSES struct');

    dwRetVal := GetAdaptersAddresses(AF_UNSPEC, GAA_FLAG_INCLUDE_ALL_INTERFACES, nil, pAddresses, @outBufLen);
    Inc(i);
  until (dwRetVal <> ERROR_BUFFER_OVERFLOW) or (i = MAX_TRIES);

  try
    if NO_ERROR <> dwRetVal then begin
      if ERROR_NO_DATA = dwRetVal then begin
        MessageDlg('No addresses were found for the requested parameters', mtInformation, [mbOK], 0);
        Exit;
      end
      else
        raise Exception.Create(SysErrorMessage(dwRetVal));
    end;

    pCurrAddresses := pAddresses;
    while Assigned(pCurrAddresses) do begin
      if pCurrAddresses^.PhysicalAddressLength > 0 then begin
        Memo1.Lines.Add(pCurrAddresses^.FriendlyName);
        macAddress := '';
        for i := 0 to pCurrAddresses^.PhysicalAddressLength - 1 do begin
          if i > 0 then
            macAddress := macAddress + ':';
          macAddress := macAddress + Format('%.2X', [pCurrAddresses^.PhysicalAddress[i]]);
        end;
        Memo1.Lines.Add(macAddress);
        Memo1.Lines.Add('');
      end;
      pCurrAddresses := pCurrAddresses^.Next;
    end;

  finally
    if Assigned(pAddresses) then
      FreeMem(pAddresses);
  end;
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-06T17:04:17.997

如果您有 Indy，那么您可以使用 MB30（代码取自[https://www.swissdelphicenter.ch/en/showcode.php?id=651](https://www.swissdelphicenter.ch/en/showcode.php?id=651)）

```
uses classes, sysUtils, NB30;

function GetMACAdress: TStringList;
var
  NCB: PNCB;
  Adapter: PAdapterStatus;

  URetCode: PChar;
  RetCode: char;
  I: integer;
  Lenum: PlanaEnum;
  _SystemID: string;
  TMPSTR: string;

begin
  Result    := TStringList.create();
  _SystemID := '';
  Getmem(NCB, SizeOf(TNCB));
  Fillchar(NCB^, SizeOf(TNCB), 0);

  Getmem(Lenum, SizeOf(TLanaEnum));
  Fillchar(Lenum^, SizeOf(TLanaEnum), 0);

  Getmem(Adapter, SizeOf(TAdapterStatus));
  Fillchar(Adapter^, SizeOf(TAdapterStatus), 0);

  Lenum.Length    := chr(0);
  NCB.ncb_command := chr(NCBENUM);
  NCB.ncb_buffer  := Pointer(Lenum);
  NCB.ncb_length  := SizeOf(Lenum);
  RetCode         := Netbios(NCB);

  try
    i := 0;
    repeat
      Fillchar(NCB^, SizeOf(TNCB), 0);
      Ncb.ncb_command  := chr(NCBRESET);
      Ncb.ncb_lana_num := lenum.lana[I];
      RetCode          := Netbios(Ncb);

      Fillchar(NCB^, SizeOf(TNCB), 0);
      Ncb.ncb_command  := chr(NCBASTAT);
      Ncb.ncb_lana_num := lenum.lana[I];
      // Must be 16
      Ncb.ncb_callname := '*               ';

      Ncb.ncb_buffer := Pointer(Adapter);

      Ncb.ncb_length := SizeOf(TAdapterStatus);
      RetCode        := Netbios(Ncb);
      //---- calc _systemId from mac-address[2-5] XOR mac-address[1]...
      if (RetCode = chr(0)) or (RetCode = chr(6)) then
      begin
        _SystemId := IntToHex(Ord(Adapter.adapter_address[0]), 2) + '-' +
          IntToHex(Ord(Adapter.adapter_address[1]), 2) + '-' +
          IntToHex(Ord(Adapter.adapter_address[2]), 2) + '-' +
          IntToHex(Ord(Adapter.adapter_address[3]), 2) + '-' +
          IntToHex(Ord(Adapter.adapter_address[4]), 2) + '-' +
          IntToHex(Ord(Adapter.adapter_address[5]), 2);

        if (_SystemID <> '00-00-00-00-00-00') and (Result.IndexOf(_SystemID)=-1) then
         Result.add(_SystemId);
      end;
      Inc(i);
    until (I >= Ord(Lenum.Length));
  finally
   FreeMem(NCB);
   FreeMem(Adapter);
   FreeMem(Lenum);
  end;
end; 
```

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2009-02-23T10:33:36.450

在几乎不了解 delphi 的情况下，如何运行 %system32%\ipconfig.exe /all 并解析输出？

# winforms - 最顶层的窗体窃取焦点

> ID：577076
> 
> 赞同：2
> 
> 时间：2009-02-23T09:59:19.687
> 
> 标签：winforms, focus

我开发了一个窗口窗体应用程序，它在桌面的右上角显示类似 msn 警报的消息。我将表单的最顶层属性设置为 true，但在我处理它们时它会窃取其他应用程序的焦点。我不希望应用程序窃取令人讨厌的焦点。我怎么解决这个问题 。有什么建议吗？

此致。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T04:48:17.130

覆盖表单的 CreateParams 和 ShowWithoutActivation 属性，如下所示：

```
protected override CreateParams CreateParams
{
  get
  {
    CreateParams baseParams = base.CreateParams;

    // WS_EX_NOACTIVATE = 0x08000000,
    // WS_EX_TOOLWINDOW = 0x00000080,
    baseParams.ExStyle |= ( int )( 
      Win32.ExtendedWindowStyles.WS_EX_NOACTIVATE | 
      Win32.ExtendedWindowStyles.WS_EX_TOOLWINDOW );

    return baseParams;
  }
}

protected override bool ShowWithoutActivation
{
  get { return true; }
} 
```

# c# - 前序树遍历复制文件夹

> ID：577080
> 
> 赞同：1
> 
> 时间：2009-02-23T10:01:18.433
> 
> 标签：c#, sql, tree, copy, directory

我们有一个包含几棵树的数据库。这些树是使用“前序树遍历”原则构建的。这是一种非常强大的创建树的方法，但它有一个很大的缺点，即一次添加多个节点。

我们必须在我们的树中创建一个复制函数，复制单个（最低级别）节点非常容易，您可以在一次调用中完成此操作。但现在我们想一次复制整个文件夹。我们想知道是否应该在.net 中使用存储过程来执行此操作。我们必须确保事务正常工作，如果出现任何问题，都必须回滚，否则树会损坏。

谁能帮我解决这个问题？有关 PTT 的任何信息，您都可以在这里找到：[http ://en.wikipedia.org/wiki/Tree_traversal](http://en.wikipedia.org/wiki/Tree_traversal)

编辑：

显然需要更多信息。我有两棵树：

```
Root
Folder 1
    Item 
    Item
    Item
Folder 2
    Item
    Item
Folder 3
    Folder 4
        Item
        Item
    Folder 5
        Item

Root 2
    Folder 6 
```

我希望能够在文件夹 6 下复制文件夹 3。所以孩子们需要与所有项目一起复制。并且所有的左右都需要适当调整。如果某事失败，则需要完全回滚。希望这现在更清楚了。

编辑2：

我为此编写了一个存储过程。如果有人想要它只是问我会在今天晚些时候回到这个问题。如果你愿意，我会发布它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T10:19:19.387

你不能遍历整个树并将其插入到一个新的二叉树中吗？如果您有多个需要组合的数据集，您可以按任意顺序遍历每个数据集并让树自行重建。

您能否提供有关文件夹含义的更多信息？

我认为这个问题需要更多信息才能完全回答。

至于确保事务有效，请在未生产的数据库上进行测试！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T13:37:51.097

我从您对“左右”的引用中猜测您正在谈论树的[嵌套集表示](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)。在这种情况下，复制整个分支与添加一个节点并没有什么不同，过程基本上是：

*   在左右序列中为新节点打开一个空间
*   插入具有正确序列的新节点

因此，如果您的树编号如下：

```
根 (1, 27)
文件夹 1 (2, 8)
        项目 (3, 4)
        项目 (5, 6)
        项目 (6, 7)
文件夹 2 (9, 14)
        项目 (10, 11)
        项目 (12, 13)
文件夹 3 (15, 26)
        文件夹 4 (16, 21)
                项目 (17, 18)
                项目 (19, 20)
        文件夹 5 (22, 25)
                项目 (23, 24)

根 2 (1, 4)
    文件夹 6 (2, 3)

```

并且树在不同的表中，复制文件夹 6 下的文件夹 3 的代码在下面的块中。一些 SQL 结构，如 UPDATE ... FROM ... 在您的环境中可能在语法上略有不同，以下与 PostgreSQL 中使用的相同。我相信 MSSQL 要求正在更新的表包含在 FROM 子句中。

```
-- 将低于这一点的项目按顺序向下推，以适应新分支（在这种情况下不需要，但为了完整起见）
UPDATE tree2 SET leftsequence = leftsequence + (tree.rightsequence - tree.leftsequence)，rightsequence = rightsequence + (tree.rightsequence - tree.leftsequence)
 从树
 其中 tree2.leftsequence > 2 AND tree2.rightsequence = 3
  AND tree.leftsequence = 15;

-- 复制节点
INSERT INTO tree2（标签、左序列、右序列）
 选择标签，左序列 - (15 - 2) + 1，右序列 - (15 - 2) + 1
  从树
  WHERE leftsequence BETWEEN 15 AND 26;

```

# c - K&R 和 ANSI 函数输出之间的区别

> ID：577081
> 
> 赞同：2
> 
> 时间：2009-02-23T10:01:24.033
> 
> 标签：c

我运行了以下代码，发现了一些奇怪的输出。

```
 int
mean_ansi (int num1, int num2)
{
  printf ("In %s\n", __FUNCTION__);
  printf ("num1,num2 is %d,%d\n", num1, num2);
  return (num1 + num2) / 2;
}

int
mean_K_and_R (num1, num2)
     int num1, num2;
{
  printf ("In %s\n", __FUNCTION__);
  printf ("num1,num2 is %d,%d\n", num1, num2);
  return (num1 + num2) / 2;
}

int
main ()
{
  int i = 6;
  double f = 1.0;

  printf ("In %s\n", __FUNCTION__);
  printf ("[f,i] = [%f,%d]\n", f, i);

  /* deliberate mistakes */
  mean_ansi (f, i);
  mean_K_and_R (f, i);

  return 0;
} 

```

输出：

在主要

[f,i] = [1.000000,6]

在mean_ansi

num1,num2 是 1,6

在mean_K_and_R

num1,num2 是 0,1072693248

谁能解释这种行为。

我看到了大会，但看不清楚。

在这两种语法中，函数参数被压入堆栈的方式有什么不同吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T11:33:59.147

Dan Olson 的想法是正确的，Slartibartfast 解释了这些价值观的来源：

的定义`mean_K_and_R()`被视为像这样定义

```
int mean_K_and_R(); 
```

即该函数接受任何参数并且除了默认参数提升之外不进行任何转换。

如果使用 cdecl 调用约定，这意味着`mean_K_and_R(f, i)`将首先压入`i`堆栈，然后是 的高位，`f`然后是 的低位`f`。

但是该函数认为它接受了两个整数参数，这意味着`num1`现在将引用 的低位`f`和`num2`高位`f`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T10:50:39.250

我的猜测是，在第一种情况下，有一个 to 的隐式`double`转换`int`。在第二个中，代表 1.0 的 64 位被解释为两个整数。数字 1072693248 二进制表示为

```
00111111111100000000000000000000 
```

但是如果你看一下[这个页面](http://steve.hollasch.net/cgindex/coding/ieeefloat.html)，你会发现这实际上是数字 1 的双精度表示的上半部分。第一个 0 是符号，01111111111 是指数，其余的零是小数的高位。我唯一不明白的是分数的 1 去哪儿了？说了这么多，我希望输出为 1,1072693248。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T10:08:42.313

我做了一些挖掘，发现一个[线程](http://bytes.com/groups/c/215340-k-r-style-function-declarations-good-bad)表明 K&R 样式函数声明不创建原型，因此如果没有单独的原型，编译器可以根据需要自由地错误地处理参数。

我不确定这是多么真实，您可以通过快速插入原型并查看函数是否生成相同的值来验证它。

在任何情况下，K&R 风格的声明都非常过时，我相信你知道，应该避免使用。如果有的话，您的问题就是一个例子。

# php - 重构的成本是否超过了重写的成本？

> ID：577083
> 
> 赞同：9
> 
> 时间：2009-02-23T10:01:41.380
> 
> 标签：php, refactoring, frameworks, legacy

在我目前的工作地点，我们有一些非常令人震惊的代码被吹捧为下一代框架。

问题是，只有一个人持这种观点，而且是写了大部分观点的那个人。该部门的其他人认为它的编码很糟糕，需要调试的皮塔饼，一般来说有点糟糕。

写这篇文章的人在管理层有一个非常有影响力的职位，所以他们在阵营的那一边。

我们已经向管理层强调了（真正的）担忧，但显然他们不愿意将更多时间投入到一个不直接有助于底线的项目上。

该框架上部署了多个应用程序，因此任何重构都需要包含这些应用程序。

整个事情是如此交织在一起，以至于我们不能只是撕掉一个特定类的实现并以这种方式重写它，所以即使对核心 api 进行简单的更改也意味着一个大型项目。

然而，它确实有 3 年的实时部署和许多错误修复、极端情况和边界条件。

考虑到这将是几个大型项目，我们是部分重写并尝试重构它，随着时间的推移进行重构，这可能需要另外 3 年的时间才能形成，还是我们只是在现有的基础上重写我们的特定需求框架？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T10:12:48.203

重写一些东西几乎是一个普遍的坏主意——你花了几个月的时间工作，在你完成之前没有任何东西可以展示。并且假设您不会成为第二系统效应的牺牲品，并且您确实*完成*了。

重构几乎肯定是正确的答案。我没有任何重构 PHP 的经验（我做 C++ 和 C#），所以我不能提供任何具体的建议。你必须继续婴儿步骤。

*   首先，确定代码中最冒犯您的部分。对我来说，在 C++ 中，这是全局变量。
*   其次，进行小的重构以一次解决一个问题。为了避免破坏该代码的旧客户端，您可能需要放置一个外观。您可以在旧代码上放置新外观，也可以在新代码上放置旧外观。
*   第三，也是最重要的，除非你*真的*有信心，否则请确保你已经为你要重构的代码准备了一套可靠的单元测试。

但是：不要放弃一切来重写代码。逐步重构。它会让你慢一点，但你仍然会在你前进的过程中提供价值。

请参阅[这篇文章](http://blogs.construx.com/blogs/stevemcc/archive/2007/11/01/technical-debt-2.aspx)，它将帮助您向管理层解释技术债务。它还将解释为什么他们似乎不在乎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T11:00:52.643

重写的好处是你可以在分析阶段考虑所有新的东西，创建一个更适应当前需求的模型。另一方面，如果它只是糟糕的编码，而不是糟糕的设计，那么完全重写是没有意义的。只需清理/重构代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T10:15:57.587

这真是一个艰难的决定……

我在这里看到的问题是，该框架已使用并修复了很长时间，因此其中包含了很多知识，并且正在运行的项目的质量显然是可以接受的。所以如果你用你知道的所有要求从头开始重写它——你可以确定你会忘记一些已经工作的东西（很难向客户或你的老板解释这一点；））

重构它——它认为——也是一项艰巨的任务，因为只有一个人真正了解代码中的联系——他不想改变它……

有三个选项：

*   忍受它
*   说服那个人需要重构，这样每个人都可以使用/维护它，而不仅仅是他
*   说服管理层需要重写，但这会让反对重写/重构的人非常沮丧

不管你怎么说 - 这对每个人来说都是一个糟糕的情况......因为随着时间的推移，负责框架的人将不得不自己处理它，然后可能为时已晚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T11:23:02.433

在一个小的层面上，是的：提供一个新版本的函数，验证它是否适用于新版本以及旧版本，删除旧版本。这通常比重构函数本身要快得多。但在那个层面上，它正在重构:)

重写的**战略**成本几乎总是超过重构。

你不能交付。在开发新版本时，您必须维护旧版本。如果财务上说你必须终止重写项目，那么你一无所获——你的工作代码库处于糟糕的状态，就好像什么都没做一样。可能更糟糕的是，因为所有更改都被拼凑起来，因为“无论如何我们都会在重写完成时将其丢弃”。

* * *

是的，可以构建重写成本更低的场景：

*   原来的代码库过于混乱，以至于任何本地修改都会破坏看似无关的功能。
*   你有一个非常棒的新团队，比老家伙好多了，但是他们对现有的代码库没有经验，现有的代码库是一团糟，或者是他们不知道的语言，或者类似的东西。

* * *

尽管如此，经验表明代码不好是有原因的，而且并不总是编码人员，当你不识别和改变原因时，重写将是重复历史的练习。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T11:24:38.200

重写是非常危险的。您将用尚未调试的新代码替换调试良好的旧代码。这将引入大量错误，您必须修复它们。最好逐步重构 - 首先非常详细地了解某些部分的用途，然后重构它。通过这种方式，您可以替换更少的代码并降低引入太多新错误的风险。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T15:26:32.957

添加到已经说过的内容：尝试获得管理层的支持。重构时的底线*是有好处的——编程新功能的工时会随着时间的推移而减少而不是增加，从而导致工资成本和服务器成本的降低。*如果你的管理人员都不明白为什么重构是值得的并且会让你更快乐地工作，那么你在正确的地方工作吗？

# .net - 企业服务替代方案

> ID：577084
> 
> 赞同：2
> 
> 时间：2009-02-23T10:01:48.993
> 
> 标签：.net, com+

.NET 中是否有任何替代服务组件 (COM+) 的方法？

我正在寻找由操作系统托管并可以在本地访问（不需要远程连接）的按需（不像 Windows 服务那样始终运行）可管理组件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T11:16:48.797

如果您希望它由操作系统在进程外托管（即能够更改运行时标识等），那么 COM+ 是最合适的。除此之外...连接到本地 IIS 实例上的服务（例如 WCF 或 POX）？大量过度杀伤等......但在某些方面，更容易部署：一旦 IIS 应用程序存在，您可以将更新复制到文件夹（这不是 COM+ 的选项）。

除非我*需要*那种能力，否则我可能会在这里使用 COM+！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T19:43:26.313

不要忘记 MSMQ 触发！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T10:03:59.940

那不只是一个标准的dll吗？

托管是什么意思？

*** 编辑 *** 哦，进程外。我会通过企业服务（服务组件）在 IIS 中使用 WCF 服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T11:20:00.613

我认为您希望对进程生命周期激活和资源使用（CPU、内存、连接等）进行一些监督和控制，但不一定像自动强制执行资源使用上限之类的事情。

[MSDN 上](http://msdn.microsoft.com/en-us/library/ms730158.aspx)有一个很好的选项摘要。如果你碰巧有 WS2008，Windows Process Activation Service 是我期待已久的东西......

# actionscript-3 - textfield()——如何防止鼠标右键菜单

> ID：577088
> 
> 赞同：1
> 
> 时间：2009-02-23T10:04:27.300
> 
> 标签：actionscript-3, flex3

Textfield () - 如何防止鼠标右键菜单出现（具有复制、粘贴、全选等选项的菜单）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T11:50:56.623

您是否尝试过自定义[InteractiveObject.contextMenu](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/InteractiveObject.html#contextMenu)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T12:00:05.743

将字段`selectable`属性设置为 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T00:29:28.703

**FlashPlayers 默认菜单项。**

据我所知，您**无法**删除有意义的基本 FlashPlayer 项目（设置和关于）。

**FlashPlayers 内置项目**

您可以通过在编译时或在代码中指定它来删除顶部的（播放、暂停等）：

```
contextMenu.hideBuiltInItems(); 
```

或在全球范围内：

```
stage.showDefaultContextMenu = false; 
```

**TextField 相关菜单项**

TextFields 的复制/粘贴/选择也是内置的，您似乎无法隐藏它们。但是，您似乎真的想摆脱它们，这是一种**解决方法**。下面的示例说明了如何在 textField 上添加一个透明按钮来转移鼠标行为：

```
package  
{
    import flash.display.Sprite;
    import flash.display.Stage;
    import flash.events.MouseEvent;
    import flash.text.TextField;
    import flash.text.TextFieldType;
    import flash.ui.ContextMenu;        

    public class TestText extends Sprite 
    {

        private var textField:TextField;

        public function TestText()
        {
            // Removes the inbuit items from the contextMenu

            var contextMenu:ContextMenu = new ContextMenu();
            contextMenu.hideBuiltInItems();
            this.contextMenu = contextMenu;

            // Adds a simple input TextField

            textField = addChild(new TextField()) as TextField;
            textField.type = TextFieldType.INPUT;
            textField.text = "Test Text";

            // Covers the TextField with a transparent shape

            var shape:Sprite = addChild(new Sprite()) as Sprite;
            shape.graphics.beginFill(0, 0);
            shape.graphics.drawRect(0, 0, textField.width, textField.height);
            shape.mouseChildren = false;

            // Listens to a click on the mask to activate typing

            shape.addEventListener(MouseEvent.CLICK, eventClickHandler);
        }

        private function eventClickHandler(event:MouseEvent):void
        {
            // Sets the focus to the underlaying TextField and makes 
            // a full selection of the existing text.

            stage.focus = textField;
            textField.setSelection(0, textField.text.length);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-28T12:06:14.807

我找到了一种方法来隐藏**TextFields**的默认上下文菜单项！

只需设置一个自定义上下文菜单，并隐藏内置项目。现在，当您右键单击时，什么也没有发生！

```
 // hide cut/copy/paste
 var cm:ContextMenu = new ContextMenu();
 cm.hideBuiltInItems();
 textfield.contextMenu = cm; 
```

# c# - 用于编辑字典的 C# GUI 控件

> ID：577092
> 
> 赞同：2
> 
> 时间：2009-02-23T10:05:55.863
> 
> 标签：c#, user-controls, dictionary

是否有一个标准控件可以让用户编辑字符串到字符串字典的键值对？

如果没有，您将如何实施？我有一些想法，但没有一个看起来很棒。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-23T10:11:51.713

不，没有内置的。用于实现一个；2-column 怎么样`DataGridView`，实现`IDataErrorInfo`这样重复的键会导致红色错误 blob：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Windows.Forms;
class Pair : IDataErrorInfo
{
    internal IList<Pair> Parent { get; set; }
    public string Key { get; set; }
    public string Value { get; set; }

    string IDataErrorInfo.Error
    {
        get { return ""; }
    }

    string IDataErrorInfo.this[string columnName]
    {
        get
        {   
            if(columnName == "Key" && Parent != null && Parent.Any(
                x=> x.Key == this.Key && !ReferenceEquals(x,this)))
            {
                return "duplicate key";
            }
            return "";        
        }
    }
}

static class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        BindingList<Pair> pairs = new BindingList<Pair>();
        // todo: fill from StringDictionary
        pairs.AddingNew += (s,a) =>
        {
            a.NewObject = new Pair { Parent = pairs };
        };
        Application.Run(new Form {
            Controls = {new DataGridView {
                Dock = DockStyle.Fill,
                DataSource = pairs
            }}
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T10:13:15.923

只需制作一个列表并将它们数据绑定到网格。快速简单。

编辑：这是一个示例，假设您有一个带有 GridView 的表单。

```
Dictionary<string, string> d;
protected void Page_Load(object sender, EventArgs e)
{
d = new Dictionary<string, string>();
d.Add("key 1", 1);
d.Add("key 2", 2);
d.Add("key 3", 3);
d.Add("key 4", 4);
d.Add("key 5", 5);

GridView1.DataSource = d;
GridView1.DataBind();

} 
```

对于错误处理等，请查看 Marc 的答案。您可能还想对 DataBinding 进行更多研究。

# ruby - 为什么日期解析依赖于分隔符？

> ID：577095
> 
> 赞同：3
> 
> 时间：2009-02-23T10:06:52.600
> 
> 标签：ruby, date

举以下两个例子：

```
Date.parse("02/20/2009")
Date.parse("02-20-2009") 
```

在第一个示例中，假设订单为 MM DD YYYY，但在第二个示例中，由于（我假设）它尝试将其解析为 DD MM YYYY，因此引发了错误。

为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-23T10:26:33.363

“02/20/2009”是**仅**在***en_US***语言环境中的日期表示。“02-20-2009”不是，因此假定遵循一个标准。有两个流行的标准，除了美国以外的地方使用最多： *DD-MM-YYYY*或 ISO 8601，即*YYYY-MM-DD*。

[http://en.wikipedia.org/wiki/File:Date.png](http://en.wikipedia.org/wiki/File:Date.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T10:23:37.723

不同的语言环境在其日期中使用不同的分隔符，并为部分（年、月、日）使用不同的顺序。Ruby 将日期字符串传递给许多函数，这些函数逐渐尝试根据分隔符解析它。

# matlab - Matlab 符号工具箱：我的代码有什么问题？

> ID：577098
> 
> 赞同：2
> 
> 时间：2009-02-23T10:08:30.817
> 
> 标签：matlab, equation, symbolic-math

我正在尝试使用 Matlab 的符号工具箱求解未知数 x、y、z 中的三个联立非线性方程。以下代码有什么问题？

```
solve( '(x/4 + y/2 + z/4)*(1/(8*x) + 1/(16*y) + 1/(8*z))  = 0.5774',  ...
       '(x/4 + y/4 + z/2)*(1/(4*x) + 1/(16*y) + 1/(16*z)) = 0.5774',  ...
       '(x/2 + y/4 + z/4)*(1/(8*x) + 1/(8*y)  + 1/(16*z)) = 0.5774' ) 
```

我收到以下错误：

```
??? Error using ==> subsref
Index exceeds matrix dimensions.

Error in ==> sym.subsref at 16
  y = builtin('subsref',struct(x),a);

Error in ==> solve at 191
      S.(char(symvars(j))) = R(:,j); 
```

我正在使用 Matlab 版本 7.7.0.471。我对符号工具箱一点也不熟悉。我错过了什么？

我是否对符号引擎期望过高？或者，有没有更好的方法来解决上述方程？（数值解就可以了。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T10:46:18.137

您的语法是正确的，但我认为您的方程组没有解决方案。当我通过 Mathematica 推送它们时，它返回一个空列表，通常表明没有解决方案。

您使用的 MATLAB 版本使用 MuPad 作为符号计算引擎，但他们曾经使用 Maple。我有符号工具箱的 Maple 版本的最新版本，当我把你的表情放进去时，我得到了

```
Warning: Explicit solution could not be found.
 In solve at 140

ans =

[ empty sym ] 
```

所以我建议这个方程组没有解决方案，新的 Mupad 符号引擎根本不能很好地处理这个事实。

更新：无论我选择什么起始值，尝试在 Mathematica 中以数值方式解决这个问题都会导致对奇异雅可比行列式的抱怨。我根本不知道如何证明你的方程没有解，但我强烈怀疑是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:56:19.570

像这样写你的代码

```
solve ('x+y+1','x+2*y-5'); 
```

那会没事的。

```
 xx=[0:.1:5];
   yy=.2; 
   for i=1:50; 
       yy(i+1)= yy(i)+.1*yy(i)*(1-yy(i); 
   end; 
   plot(xx,yy) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T13:29:42.897

看起来它可能是一个错误。它看起来和这个一样：

[http://www.mathworks.com/support/bugreports/details.html?rp=501052](http://www.mathworks.com/support/bugreports/details.html?rp=501052)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T17:01:06.650

检查[Mike](https://stackoverflow.com/questions/577098/matlab-symbolic-toolbox-whats-wrong-with-my-code/577199#577199)建议的内容是否在您的代码中发生的一种方法是在solve 中的违规行设置一个断点并检查那里使用的变量的大小。很有可能，一个或多个的大小为 0。至于确定数学上是否真的没有解决方案，我无能为力。找一个数学研究生。

# c++ - mpeg 2 解码

> ID：577102
> 
> 赞同：5
> 
> 时间：2009-02-23T10:11:31.823
> 
> 标签：c++, c, video, codec, mpeg

我想了解视频和音频解码的工作原理，特别是时间同步（如何获得 30fps 视频，如何将其与音频耦合等）。我不想知道所有细节，只想知道它的本质。我希望能够编写实际视频/音频解码器的高级简化。

你能给我指点吗？MPEG2 视频/音频解码器的实际 C/C++ 源代码将是理解我认为的那些事情的最快方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T10:21:08.713

从有效的编解码器中读取源代码似乎是正确的方法。我建议如下：

[http://www.mpeg.org/MPEG/video/mssg-free-mpeg-software.html](http://www.mpeg.org/MPEG/video/mssg-free-mpeg-software.html)

鉴于它在 mpeg.org 网站上被提及，我想说你会在这里找到你需要的东西。

在过去，我有一些时间来解码 mpeg 视频（虽然没有音频），而且原理很简单。包括一些纯图像，一些中间图像相对于最接近的主要图像进行描述，其余的使用最接近的主/中间图像进行描述。

一个时间段，一个图像。但我猜最近的编解码器要复杂得多！

编辑：同步

我不是同步音频和视频方面的专家，但这个问题似乎是使用同步层处理的（参见[那里](https://mpeg.chiariglione.org/faq/which-layers-are-passed-mpeg-4-objects-are-composed)的定义）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T10:56:43.510

对于音频/视频同步，基本上，每个视频和音频帧都应该加上时间戳。时间戳通常称为 PTS（演示时间戳）。一旦视频/音频被解码器解码，音频/视频渲染器应该安排帧在正确的时间显示，以便音频/视频同步。

我想你可以参考[MPEG2教程的“](http://www.bretl.com/mpeghtml/MPEGindex.htm)[时序模型](http://www.bretl.com/mpeghtml/timemdl.HTM)”一章了解详细信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T10:21:09.243

[您可以浏览ffmpeg](https://git.ffmpeg.org/gitweb/ffmpeg.git)的源代码（可通过 svn 获得）或其[API 文档](https://ffmpeg.org/doxygen/trunk/index.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T10:36:28.193

根据您对 MPEG-2 格式的了解程度，您可能希望先阅读有关它的文章来获得广泛的概述。我的意思是这样的：

[MPEG-2 标准初学者指南](http://www.fh-friedberg.de/fachbereiche/e2/telekom-labor/zinke/mk/mpeg2beg/beginnzi.htm)

[MPEG-2 视频压缩](http://www.bbc.co.uk/rd/pubs/papers/paper_14/paper_14.shtml)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T11:56:08.343

@帕特里克和尼尔斯

所以你说有时间戳，嘿......我猜这些只是视频部分。对于音频，我猜标题中有足够的信息（例如“每秒样本数”）。这些时间戳多久需要一次？我想音频和视频数据包的隔行扫描确保视频数据总是领先于音频数据或其他什么？

编辑：找到我需要的东西： [http ://www.dranger.com/ffmpeg/tutorial01.html](http://www.dranger.com/ffmpeg/tutorial01.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T15:53:50.130

地狱通，

音频数据的时间戳仍然是必需的，因为音频和视频帧可能不会在同一位置对齐。例如：

V：1000 1040 1080 1120 ... A：990 1013 1036（丢失）1082

您可能需要补偿第一个视频/音频帧之间的偏移。此外，如果可能存在丢包（在视频流期间），您需要视频/音频的时间戳以保持准确同步。

# c# - C#解析网页的源代码

> ID：577104
> 
> 赞同：1
> 
> 时间：2009-02-23T10:11:32.730
> 
> 标签：c#, .net, asp.net, regex, data-mining

在作为页面来源的文本墙中；我需要得到不带引号的 video_id,l 和 t，所以对于这样的部分。

“video_id”：“lUoiKMxSUCw”，“l”：105，“sk”：“-2fL6AANk__E49CRzF6_Q8F7yBPWdb9QR”，“fmt_map”：“35/640000/9/0/115,34/0/9/0/115,5/ 0/7/0/0", "t": "vjVQa1PpcFMbYtdhqxUip5Vtm856lwh7lXZ6lH6nZAg=",

我需要以下

luoiKMxSUCw

105

vjVQa1PpcFMbYtdhqxUip5Vtm856lwh7lXZ6lH6nZAg=

有人告诉我使用“正则表达式”，但我不确定如何使用它们。你能帮忙的话，我会很高兴 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T10:19:39.200

我认为这个网站适合学习，但如果您希望代码完成您的工作，对不起..

这看起来是一个好的开始：[C# 中的正则表达式用法](http://www.c-sharpcorner.com/UploadFile/prasad_1/RegExpPSD12062005021717AM/RegExpPSD.aspx)

而且[这个网站](http://www.regular-expressions.info/dotnet.html)也很有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T10:46:03.193

要使用的正则表达式可以是：

```
\"video_id\":\s*\"(?<videoID>.*?)\"(?:.*?)\"l\":\s*(?<l>.*?),(?:.*?)\"t\":\s*\"(?<t>.*?)\" 
```

这里有一些示例代码可以帮助您启动和运行：

```
string sample = "\"video_id\": \"lUoiKMxSUCw\", \"l\": 105, \"sk\": \"-2fL6AANk__E49CRzF6_Q8F7yBPWdb9QR\", \"fmt_map\": \"35/640000/9/0/115,34/0/9/0/115,5/0/7/0/0\", \"t\": \"vjVQa1PpcFMbYtdhqxUip5Vtm856lwh7lXZ6lH6nZAg=\",";
string regPattern = "\\\"video_id\\\":\\s*\\\"(?<videoID>.*?)\\\"(?:.*?)\\\"l\\\":\\s*(?<l>.*?),(?:.*?)\\\"t\\\":\\s*\\\"(?<t>.*?)\\\"";
Regex reg = new Regex(regPattern, RegexOptions.Singleline);
if (reg.IsMatch(sample))
{
    Match m = reg.Match(sample);
    GroupCollection gColl = m.Groups;
    Console.WriteLine("VideoID:{0}", gColl["videoID"].Value);
    Console.WriteLine("l:{0}", gColl["l"].Value);
    Console.WriteLine("t:{0}", gColl["t"].Value);
} 
```

不要忘记导入“System.Text.RegularExpressions”。;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T10:36:50.563

如果顺序始终相同，则可以使用以下正则表达式：

```
"video_id"\s*:\s*"([^"]*)"\s*,\s*"l"\s*:\s*(\d+)\s*(?:,\s*"[^"]*"\s*:\s*"[^"]*"\s*)*,\s*"t"\s*:\s*"([^"]*)" 
```

否则，您应该抓取列表中的每个条目，然后选择您需要的条目。

# c# - 何时应从消息过滤器中删除 UserControl？

> ID：577113
> 
> 赞同：1
> 
> 时间：2009-02-23T10:13:05.470
> 
> 标签：c#, .net

我正在实施`UserControl`which implements `IMessageFilter`。它调用`Application.AddMessageFilter`其构造函数。我想在它的`Dispose(bool disposing)`方法中将它从消息过滤器中删除，但我不知道是否将调用`Application.RemoveMessageFilter`放在测试内部（所以它在`disposing`为真时被调用）或者我是否应该在测试之外调用它（所以每当调用该方法时都会调用它）。

哪种方法是正确的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T10:32:32.477

您只能在处置时调用其他托管对象，而不是在完成时调用，因为不能保证其他引用的对象尚未完成。这意味着您应该仅在`disposing`为 true 时调用 RemoveMessageFilter。

# python - 如何在完成解析之前退出模块？

> ID：577119
> 
> 赞同：6
> 
> 时间：2009-02-23T10:15:09.273
> 
> 标签：python, import, module

我有一个导入模块的模块，但在某些情况下，导入的模块可能不存在。导入模块后，有一个类继承自导入模块的类。如果我要在模块不存在的情况下捕获`ImportError`异常，我该如何阻止 Python 解析模块的其余部分？如果不可能，我愿意接受其他解决方案。

这是一个基本示例（selfaware.py）：

```
try:
    from skynet import SkyNet
except ImportError:
    class SelfAwareSkyNet():
        pass
    exit_module_parsing_here()

class SelfAwareSkyNet(SkyNet):
    pass 
```

我能想到的唯一方法是：

*   在导入`selfaware.py`模块之前，检查`skynet`模块是否可用，然后简单地传递或创建一个存根类。`selfaware.py`如果多次导入，这将导致 DRY 。
*   在块内`selfaware.py`定义类`try`。例如：

    ```
    try:
        from skynet import SkyNet
        class SelfAwareSkyNet(SkyNet):
            pass
    except ImportError:
        class SelfAwareSkyNet():
            pass 
    ```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T10:51:16.597

try: 支持 else: 子句

```
try:
    from skynet import SkyNet

except ImportError:
    class SelfAwareSkyNet():
        pass

else:
    class SelfAwareSkyNet(SkyNet):
        pass 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T10:34:43.297

你可以使用：

```
try:
   from skynet import SkyNet
   inherit_from = SkyNet
except ImportError:
   inherit_from = object

class SelfAwareSkyeNet(inherit_from):
    pass 
```

这仅在实现没有差异时才有效。

**编辑：**评论后的新解决方案。

# c++ - DDS 纹理加载

> ID：577125
> 
> 赞同：3
> 
> 时间：2009-02-23T10:18:19.373
> 
> 标签：c++, opengl, textures, directdraw

如何将 dds 纹理文件加载到 OpenGL 2dtexture 或立方体贴图纹理中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T10:25:54.193

我相信你使用 glCompressedTexImage2DARB 方法和它的朋友。

[此 PDF](http://www.oldunreal.com/editing/s3tc/ARB_texture_compression.pdf)似乎包含一些可能对您有帮助的有希望的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T07:17:59.190

根据您的需要，[DevIL](http://openil.sourceforge.net/)库可以负责为 OpenGL 提供 DDS 文件内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T13:31:45.837

如果 DDS 包含压缩纹理，则使用 glCompressedTexImage2DARB()，如果它包含未压缩数据，则应用通常的 glTexImage2D 过程。如果 DDS 文件包含 mipmap，则为每个 mipmap 级别一次，如果它是一个立方体贴图，则为每个立方体贴图面一次。

有关如何读取 DDS 文件中的标头和数据的信息，请在 MSDN 或 DirectX SDK 中查找它的文档。这是一种相当标准的容器格式，没有太多惊喜。

请注意，DDS 使用左上角图像原点，而 OpenGL 假定图像数据的左下角原点。这意味着您可能希望在加载 DDS 图像后对其进行垂直翻转。如果它们在 DXT1/3/5 中，您可以在不解压缩它们的情况下执行此操作，但这是一个稍微复杂的过程，涉及对每个 4x4 的内容进行位操作压缩块。

# asp.net - Response.Redirect - 使用异常进行流量控制？

> ID：577126
> 
> 赞同：2
> 
> 时间：2009-02-23T10:18:29.717
> 
> 标签：asp.net, exception, redirect, response.redirect

`Response.Redirect`有两个重载：

```
公共无效重定向（字符串网址）

参数：
url：目标位置。
```

```
公共无效重定向（字符串 url，bool endResponse）
参数：
url：目标的位置。
endResponse：指示当前页面的执行是否应该终止。
```

如果我调用第一个重载，或者使用`endResponse`set调用第二`true`个重载，`ThreadAbortException`则会抛出异常。

我为什么要使用这种方法？这不是使用异常处理程序流的例子吗？（因此是一件坏事）

如果我的重定向确实需要例外，那么我最好抛出一个包含重定向*原因的信息更丰富的异常吗？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T11:40:09.317

如果您将 endResponse 设置为“true”，您实际上是在说“我已完成此页面，忽略我之后的任何内容”。

引发“ThreadAbortException”的原因是为了触发您编写的所有 Finals/Catches 等，并且在发送到下一页之前正确清理资源。

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.threading.threadabortexception.aspx)：

> ThreadAbortException 是一个可以被捕获的特殊异常，但它会在 catch 块结束时自动再次引发。当引发此异常时，运行时会在结束线程之前执行所有 finally 块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T21:01:24.990

Zhaph 是对的，发生该异常是因为您在 try catch 块中重定向。

代替

```
try {
    ...
    Response.Redirect(url);
} catch {
    ...
} 
```

沿着这些思路做一些事情：

```
bool bSuccess = true;
try {
    ...
} catch {
    bSuccess = false;
    ...
}

if (bSuccess) {
    Response.Redirect(url);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T10:33:17.293

我认为其背后的理论是避免浪费马力。如果您决定在请求周期内进行 5 次深度函数调用以表明重定向是合适的，那么您需要某种方式向所有更高级别的函数发出信号“我们已经完成，不要再在此请求上浪费时间了” ，而 asp.net 本身也需要这样做。

我认为 asp.net 团队采用了这种方法，而不是 a) 使用函数的返回值（这意味着如果函数具有逻辑返回值，则必须通过 Ref/Out 参数来处理），或 b) 设置请求上的标志。当然，编写 ASP.Net 本身就是为了纪念这个标志，但是有多少初学者开发人员会认为他们应该检查它（在每次函数调用之后？），所以他们可能仍然会做一些重量级的工作，这将是浪费了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T11:44:18.043

有时异常是控制程序流程的最佳方式。

当然，*通常*情况并非如此。因此，如果您发现自己在控制流中使用异常，请仔细检查是否没有更好的替代方案。

Response.Redirect 的异常中止当前线程通常是一件好事，因为这正是您想要发生的事情。

# c# - Control.Contains 方法的搜索深度有多深？

> ID：577128
> 
> 赞同：2
> 
> 时间：2009-02-23T10:19:18.047
> 
> 标签：c#, .net, winforms

我需要检查一个控件是否是另一个控件的后代。会`Control.Contains`做这项工作，还是只搜索一级子控件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T10:23:56.740

Control.Contains 进行递归搜索。因此，对于这种情况，它将返回 true：

```
ctrl1.Contains(ctrl3); 
```

其中 ctrl1 包含 ctrl2，而 ctrl2 包含 ctrl3（例如）。

顺便说一句：[.NET Reflector](http://www.red-gate.com/products/reflector/)是找出这些东西的好工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T10:23:15.837

我刚刚对其进行了测试，看起来它确实进行了递归搜索。

# c# - 为什么 C# 集合属性在调用它们的属性时没有被标记为过时？

> ID：577132
> 
> 赞同：13
> 
> 时间：2009-02-23T10:19:40.680
> 
> 标签：c#, properties, obsolete

我试图将类上的集合属性标记为已过时，以查找所有出现的情况并在我的警告列表中保留要修复的缩小列表，因为我们需要用其他东西替换这个集合属性。

* * *

**编辑**：我已经通过 Microsoft Connect 提交了这个，[问题 #417159](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=417159)。

**编辑 16.11.2010**：验证现在在为 .NET 3.5 和 4.0 编译时，这在 C# 4.0 编译器中有效。我在发布的代码中收到 4 条警告，包括带有注释“不好？”的一条。

* * *

然而，令我惊讶的是，该列表仅包含一些事件，远远少于我所知道的，并且抽查告诉我，出于某种原因，该属性的使用并不总是被编译器在警告列表中标记为过时.

这是一个示例程序，可以在 Visual Studio 2008 中编译。

请注意末尾附近标有 #1-#4 的四行，其中，我希望他们所有人都报告使用的属性已过时，但 #3 不是，而且似乎如果我继续直接添加到集合属性或方法中，属性本身的使用不会被标记为过时。请注意，#3 和#4 引用相同的属性，并且#4 被标记为使用过时的属性，而#3 不是。测试表明，如果我在表达式中访问属性返回的集合的属性或方法，编译器不会抱怨。

这是一个错误，还是我不知道的 C# 编译器的“隐藏的宝石”？

```
using System;
using System.Collections.Generic;

namespace TestApp
{
    public abstract class BaseClass
    {
        [Obsolete]
        public abstract String Value
        {
            get;
        }

        [Obsolete]
        public abstract String[] ValueArray
        {
            get;
        }

        [Obsolete]
        public abstract List<String> ValueList
        {
            get;
        }
    }

    public class DerivedClass : BaseClass
    {
        [Obsolete]
        public override String Value
        {
            get
            {
                return "Test";
            }
        }

        [Obsolete]
        public override String[] ValueArray
        {
            get
            {
                return new[] { "A", "B" };
            }
        }

        [Obsolete]
        public override List<String> ValueList
        {
            get
            {
                return new List<String>(new[] { "A", "B" });
            }
        }
    }

    public class Program
    {
        public static void Main(String[] args)
        {
            BaseClass bc = new DerivedClass();
            Console.Out.WriteLine(bc.Value);             // #1 - OK
            Console.Out.WriteLine(bc.ValueArray.Length); // #2 - OK
            Console.Out.WriteLine(bc.ValueList.Count);   // #3 - Not OK?
            List<String> list = bc.ValueList;            // #4 - OK
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-17T02:20:16.967

这是一个真正的错误。不幸的是，由于错过了这种情况的重构清理。我为 VS 2010/NDP 4.0 中即将发布的 C# 4.0 编译器版本修复了这个问题，但现在没有计划在 Orcas 中修复它，不幸的是，我知道没有解决这个问题的方法。

我不想这么说，但是当 NDP 4 csc.exe 或 VS2010 可用时，您将需要升级到它们来解决此问题。

我正在考虑在我全新的 msdn 博客上发布一个关于此的条目。为重构如何破坏您的代码提供了一个很好的轶事示例。

伊恩·哈利迪

C# 编译器 SDE
Microsoft

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-23T10:26:25.690

嗯......对我来说看起来像一个编译器错误！它失败了以下（ECMA 334v4）：

> 24.4.3 Obsolete 属性 Obsolete 属性用于标记不应再使用的类型和类型的成员。如果程序使用了修饰了 Obsolete 属性的类型或成员，那么编译器将发出警告或错误以提醒开发人员，因此可以修复有问题的代码。具体来说，如果没有提供错误参数，或者如果提供了错误参数并且值为 false，编译器将发出警告。如果指定了 error 参数并且值为 true，编译器将发出编译时错误。

特别是，当标记为 true 时，它​​应该发出错误，但它不会。好发现！您可以在“连接”上报告它，或者如果您不想设置登录的痛苦，请告诉我，我会很乐意记录它（在此处引用您的帖子；不要试图“窃取”任何东西）。

（更新）

减少代码重现：

```
using System;
using System.Collections.Generic;
static class Program {
    static void Main() {
        int count = Test.Count;
    }

    [Obsolete("Should error", true)]
    public static List<string> Test {
        get {throw new NotImplementedException();}
    }
} 
```

请注意，mono 2.0 是正确的，MS C# 2.0 编译器也是如此。损坏的只是 MS C# 3.0 (.NET 3.5) 编译器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T10:32:11.323

我同意 Marc：它看起来像一个编译器错误。有趣的是，gmcs（Mono C# 编译器）做对了：

```
Test.cs(65,26): warning CS0219: The variable `list' is assigned but its value is never used
Test.cs(62,38): warning CS0612: `TestApp.BaseClass.Value' is obsolete
Test.cs(63,38): warning CS0612: `TestApp.BaseClass.ValueArray' is obsolete
Test.cs(64,38): warning CS0612: `TestApp.BaseClass.ValueList' is obsolete
Test.cs(65,36): warning CS0612: `TestApp.BaseClass.ValueList' is obsolete
Compilation succeeded - 5 warning(s) 
```

# c - C : pthread 数据特定的析构函数只调用一次

> ID：577133
> 
> 赞同：5
> 
> 时间：2009-02-23T10:20:32.707
> 
> 标签：c, pthreads, destructor

从[`pthread_key_create`](http://www.manpagez.com/man/3/pthread_key_create/)手册页：

> 可选的析构函数可以与每个键值相关联。在线程退出时，如果键值具有非 NULL 析构函数指针，并且线程具有与键关联的非 NULL 值，则以当前关联值作为其唯一参数调用指向的函数。如果线程退出时存在多个析构函数，则未指定析构函数调用的顺序。
> 
> 如果在所有非 NULL 值与关联的析构函数调用了所有析构函数之后，仍然有一些非 NULL 值与关联的析构函数，则重复该过程。如果在析构函数的至少 [PTHREAD_DESTRUCTOR_ITERATIONS] 次迭代调用杰出的非 NULL 值之后，仍然有一些非 NULL 值具有关联的析构函数，则实现停止调用析构函数。

我写了一个小例子，用一个简单的析构函数为非 NULL 线程特定值打印“Hello World”。据我所知，这个析构函数只被调用一次（至少在 linux fedora 和 mac os x 上），即使在第一次调用析构函数后线程特定的值仍然不是 NULL。

我错过了什么吗？！（在 glibc 上 PTHREAD_DESTRUCTOR_ITERATIONS = 4。）

这是我的小例子：

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>

#define NB_THREADS 1
#define NB_KEYS 1

static pthread_key_t keys[NB_KEYS];
static pthread_mutex_t mutex;

void destruction (void *arg)
{
  (int) arg ++;
  printf ("Destructor called! -- key value : %i\n", (int)arg);
}

void* startup_routine(void* argv)
{
  int i;
  int th = (int) argv;

  for (i = 0; i < NB_KEYS; i++)
    pthread_setspecific(keys[i], (void*) ((th + i)* 2));

  pthread_mutex_lock(&mutex);

  printf("Thread %i\n", th);

  for (i = 0; i < NB_KEYS; i++)
    printf ("\tkeys[%i] : %i\n", i, (int)pthread_getspecific(keys[i]));

  pthread_mutex_unlock(&mutex);

  return "End";
}

int main(int argc, char** argv)
{
  int i;
  void *result;
  pthread_t thread[NB_THREADS];

  for (i = 0; i < NB_KEYS; i++)
    pthread_key_create(&keys[i], destruction);

  pthread_mutex_init(&mutex, NULL);

  for (i = 0; i < NB_THREADS; i++)
    pthread_create( &thread[i], NULL, startup_routine, (void*)(i+1) );

  for (i = 0; i < NB_THREADS; i++)
  {
    pthread_join( thread[i], &result );
    printf("Return from the thread %i = '%s'\n", i, (char*)result );
  }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T14:00:33.647

似乎这里使用 pthread 的人并不多！

所以，再次，我会回答我自己的问题：

仅当在析构函数中完成调用时，才会多次调用`pthread_setspecific`析构函数，从而更改键的值。

这是因为在调用析构函数之前，将键指针设置为空，并将指针传递给析构函数。因此，如果我们希望键指针不为空，只需在`pthread_setspecific`其中调用即可。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-01-14T09:02:02.957

我不明白其中的奥秘。您只有 1 个线程特定的键，并且只有 1 个设置线程特定数据的线程。因此，析构函数应该只按预期执行一次。

如果您在 main() 中的 pthread_create() 之后的某处设置线程特定的数据，那么析构函数将被调用两次——一次用于子线程，一次用于与 main() 关联的线程。

# ajax - 在 GRAILS 中使用 ajax 检查用户名可用性

> ID：577139
> 
> 赞同：2
> 
> 时间：2009-02-23T10:23:12.250
> 
> 标签：ajax, grails, gsp

我正在 grails 中做一个 Web 应用程序。现在我正在制作注册页面。在注册页面中，我想通过 ajax 检查用户名可用性。我可以编写用于在控制器或服务中检查用户名可用性的代码。我对如何联系服务器感到震惊通过ajax从客户端。

我的示例 gsp 代码是

```
<g:form method="post" action="signup" controller="auth">
 <input type="text" name="name" >
 <input type="text" name="username" >
 <input type="password" name="password" >
 <input type="submit" value="signup">
 </g:form> 
```

在上面的代码中，如果用户名文本框失去焦点，它应该检查可用性。我做了一些谷歌搜索。但我无法得到我想要的。谁能为此提供帮助或好的教程？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-25T03:51:21.380

Grails 有一些很棒的内置 ajax 标签，但我更喜欢直接使用 javascript 库（即 jquery）...

1.  下载[jquery](http://jquery.com)并复制到 web-app/js/jquery.js

2.  在表单 gsp 或布局的头部添加：

    <g:javascript src="jquery.js"/>

3.  在您的表单 gsp 中，我建议您在用户名的输入字段中添加一个 id 属性，这样可以更轻松地通过 id 引用元素：

    <input type="text" name="username" id="username" value=""/>

4.  在您的控制器方法中，您可以检查您的域/服务/等以查看名称是否免费。下面是一个人为的示例，它以 JSON 形式返回响应，但您也可以返回 html 来填充 div，这取决于您希望如何提醒用户。

```
 `class UserController {
      def checkAvailable = {
        def available
        if( User.findByUsername(params.id) ) {
           available = false
        } else {
           available = true
        }
        response.contentType = "application/json"
        render """{"available":${available}}"""
    }` 
```

`5，在你的表格gsp的头部添加`

 ````
 `<script type="text/javascript">
    // wait for dom to load
    $(function(){
      // set onblur event handler
      $("#username").blur(function(){
        // if some username was entered - this == #username
        if($(this).length > 0) {
          // use create link so we don't have to hardcode context
          var url = "${createLink(controller:'user', action:'checkAvailable')}"
          // async ajax request pass username entered as id parameter
          $.getJSON(url, {id:$(this).val()}, function(json){
            if(!json.available) {
              // highlight field so user knows there's a problem
              $("#username").css("border", "1px solid red");
              // maybe throw up an alert box
              alert("This username is taken");
              // populate a hidden div on page and fill and display it..
              $("#somehiddendiv").html("*This ID is already taken*").show();
            }
          });
        }
      });
    });
    </script>` 
```

`当然有很多方法可以实现这一点，我只是碰巧更喜欢 jquery 而不是使用一些内置的 ajaxy 功能。`

 `* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-23T14:09:30.130

通过使用 [remoteFunction](http://www.grails.org/Tag+-+remoteFunction)方法，我们可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T12:45:44.077

您首先需要将一些事件绑定到用户名的输入框 - 我建议使用 JS 库，如 jQuery、mootools 或任何其他高质量的库。

[将一个事件](http://docs.jquery.com/Events/bind)，如 onblur，绑定到输入框，您可以编写一个向您的服务器发出[http GET 请求](http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback)的函数（例如，/register/checkAvailability?username=*此处的用户名*），并且响应将显示在某处（可能位于输入框旁边）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-31T10:14:24.163

通过这些更改开箱即用。

```
$("#username").bind("change paste keyup", function() { 
```

```
 $(function(){
        // set onblur event handler
        $("#username").bind("change paste keyup", function() { /*<<<<< !UPDATE THIS LINE!******/
            // if some username was entered - this == #username
            if($(this).length > 0) {
                // use create link so we don't have to hardcode context
                var url = "${createLink(controller:'user', action:'checkAvailable')}"
                // async ajax request pass username entered as id parameter
                $.getJSON( url, { id:$(this).val() }, function(json){
                    if(!json.available) {
                          // highlight field so user knows there's a problem
                          $("#username").css("border", "1px solid red");
                          // maybe throw up an alert box
                          alert("This username is taken");
                          // populate a hidden div on page and fill and display it..
                          $("#somehiddendiv").html("This ID is already taken").show();
                    }
                });
            }
        });
    }); 
```

# winforms - XNA - 在表单中嵌入 DirectX 控件？

> ID：577145
> 
> 赞同：4
> 
> 时间：2009-02-23T10:24:12.997
> 
> 标签：winforms, xna

我想将 DirectX（好吧，XNA）的东西渲染到 system.windows.forms 控件而不是整个窗口（所以我可以将它与按钮和东西配对）。

这可能吗？我会使用哪个控件？我该怎么做？我已经搜索了文档，但我不知道我打算使用哪些术语！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T10:27:12.847

是的，这是可能的。有一个[示例](http://creators.xna.com/en-US/sample/winforms_series1 "XNA网站")可以做到这一点。

# mysql - 在 openBSD 上 chrooted Apache+MsSQL；无法确定服务器的完全限定域名

> ID：577160
> 
> 赞同：0
> 
> 时间：2009-02-23T10:29:15.963
> 
> 标签：mysql, apache, database-connection, chroot, openbsd

php 使用第二台服务器上的数据库在 Web 服务器上生成 GIF。该页面显示 20 个 GIF，因此在短时间内有一些负载（多个连接）

* * *

某些 GIF 已加载，但有些未加载，在`/var/www/logs/error_log`

```
[2009 年 2 月 23 日星期一 10:05:56] [错误] PHP 警告：mysql_connect() [function.mysql-connect]：在“读取初始通信数据包”时丢失与 MySQL 服务器的连接，系统错误：/htdocs/ 中的 0。 ../myImage.php 在第 4 行
[2009 年 2 月 23 日星期一 10:05:56] [错误] PHP 致命错误：在“读取初始通信数据包”时丢失与 MySQL 服务器的连接，系统错误：第 4 行 /htdocs/.../myImage.php 中的 0
```

* * *

在`/var/www/logs/error_log`我发现的 MySQL 服务器上：

```
[警报] httpd：无法确定服务器的完全限定域名，使用 127.0.0.1 作为 ServerName
```

* * *

重新启动 MySQL 服务器“解决”了问题......几天。

两台服务器是运行 OpenBSD、chroot'ed Apache 和 MySQL + phpMyAdmin 的虚拟机。不幸的是，在不同的版本中（OpenBSD 4.2（web）和 3.9（mysql））

我的知识 `/var/www/conf/httpd.conf`和`my.cnf`（没有找到）非常有限。
有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T23:20:08.887

可以忽略“无法确定服务器的完全限定域名”错误，这是内部 apache 的事情。

根据[http://dev.mysql.com/doc/refman/5.0/en/error-lost-connection.html](http://dev.mysql.com/doc/refman/5.0/en/error-lost-connection.html)和[http://bugs.mysql.com/bug.php?id=28359](http://bugs.mysql.com/bug.php?id=28359)这听起来要么很慢网络，或无法足够快地响应连接的过载 mysql。

鉴于重新启动解决了这个问题，我猜你有一个缓慢的资源泄漏。可能像在mysql上运行的昂贵查询之类的东西。您应该能够通过随时间跟踪系统负载来验证这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T23:33:21.553

您是否尝试过将 resolv.conf 放入 chroot 中？如：

```
mkdir -p /var/www/etc/ && cp -p /etc/resolv.conf /var/www/etc/ 
```

如果您发现您的 Web 服务器时间与您的时区不同，您可能还希望对 /etc/localtime 执行相同的操作。

笔记：

*   不要使用符号链接，因为它不能通过 chroot 工作
*   不要使用硬链接，因为在 chroot 中修改文件会修改 /etc 中的文件！

# svn - 将未版本控制的文件添加到 subversion

> ID：577176
> 
> 赞同：10
> 
> 时间：2009-02-23T10:36:25.353
> 
> 标签：svn, version-control, sitecore

是否可以将不应该版本化的文件添加到 subversion？前任 需要编辑以匹配每个单独的环境的配置文件。当新程序员连接到项目时，他应该从 subversion 获取原始文件，但在编辑后不会提交，更新时不会被覆盖。

也许为整个原始项目创建一个标签是解决方案？首先下载标签然后从主干更新？

有任何想法吗？

* * *

澄清以下评论：该项目（Sitecore）由大约 30k 个不同的文件组成。我们需要对其中的 100 个进行版本化。如果我们应该在版本控制中包含所有文件，那么每次提交都需要永远（因为乌龟搜索所有文件夹）。今天我们创建一个包含所有未版本化文件夹的 zip 文件，在 svn 中将文件夹设置为忽略，然后添加 zip。问题是当我们需要更改 zip 中的一个或多个文件时，我们需要向 repo 提交一个新的 ~1GB-zip。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-23T10:41:48.850

我会将未版本控制的文件放在每个使用该项目的人都可以访问的网络或文件服务器上，并添加一个脚本以自动（`wget`/ `scp`/etc.）下载文件（如果需要，压缩）并将它们解压缩到[svnignored](http://svnbook.red-bean.com/en/1.1/ch07s02.html)文件夹中，以便它们不要被颠覆所接受。

如果您担心这些文件会发生变化，那么：不应该对它们进行版本控制吗？

[svn:externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)在这种情况下也可能有用。我*认为*如果情况允许，它们可以很容易地被忽略。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T11:35:26.693

在某些情况下，甚至不需要为每个开发人员创建 web.config，因为 .Net 配置格式允许通过 configSource 属性覆盖配置文件的特定部分。

configSource 属性指定一个文件名（当文件存在时）覆盖指定的块，当它不存在时，块按原样使用。

```
<?xml version="1.0"?>
<configuration>
  <connectionStrings configSource="connections.config">
      <add name="LocalSqlServer" 
           connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true"
           providerName="System.Data.SqlClient" />
  </connectionStrings>
</configuration> 
```

在开发者系统上，你可以只为他添加一个带有连接的connections.config，而其余的设置可以共享。

（所以这并不能解决模板的问题，但它可以帮助您管理一个大模板和许多小模板）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T10:38:20.433

我将创建一个在运行时生成配置文件的脚本。这样，您无需担心 SCM 会妨碍您。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-23T12:55:12.150

您需要重新考虑如何使用 subverion。Subversion 存储文件的版本信息；不多不少。您不能在 subversion 中存储未版本化的文件；没有任何意义。将 1GB 的 zip 文件存储到 subversion 中也无济于事。

您应该研究开发人员可以通过用户主目录中的个性化配置文件或环境变量来覆盖此文件中的设置的方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T10:39:27.687

只需为此使用模板文件。假设您的文件名为 config.txt。查看文件并在本地设置应该去的地方插入一些标记，将其重命名为 configTemplate.txt 并提交。然后每个开发人员都应该检查该文件，制作一份副本，删除文件名的模板部分（这样每个人都会得到正确的 config.txt），并将新文件添加到忽略列表中。然后要么让每个人简单地在模板文件中标记所在的本地设置中手动编辑，要么使用脚本为他们做这件事（如果可能的话）。

模板文件永远不会改变（当然，除非配置文件的格式有所不同）。

**回复您的编辑（和评论）：**

不是自动生成的图像、文档和二进制文件可能都应该置于版本控制之下。或者至少我看不出有什么好的理由让它们保持不受版本控制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T21:32:46.197

让每个程序员在他们自己的分支上工作，并让他们将他们的更改合并回主分支/主干。当然，您的团队成员需要在使用版本控制方面达到最新水平，并且能够使用的不仅仅是签出、更新和提交。

# visual-studio - 如何更改 Visual Studio 的标题栏文本

> ID：577188
> 
> 赞同：63
> 
> 时间：2009-02-23T10:42:53.027
> 
> 标签：visual-studio, visual-studio-2008

我们在同一代码的多个不同分支上工作，当同时在两个分支上工作时，可能会变得混乱和浪费时间。

目前，VS 标题栏有文字`<solution-name> - Visual Studio`.

我是否可以编写一个扩展来制作该文本`<solution-name>: <branch-name> - <Visual Studio>`？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2011-04-15T18:58:20.213

我刚刚创建了一个可以提供帮助的小型 Visual Studio 扩展：http: [//visualstudiogallery.msdn.microsoft.com/f3f23845-5b1e-4811-882f-60b7181fa6d6](http://visualstudiogallery.msdn.microsoft.com/f3f23845-5b1e-4811-882f-60b7181fa6d6)

> 只要两个 Visual Studio 实例正在运行，这个小扩展就会检测到并更改 Visual Studio 的窗口标题以包含解决方案的父文件夹名称。因此，它将 **SolutionFolder - Microsoft Visual Studio**更改为 **SolutionFolderParent\SolutionFolder - Microsoft Visual Studio**。
> 
> 这在对解决方案进行分支时特别有用：在两个解决方案名称相同的情况下，可以轻松识别您正在处理的分支。

官方页面在这里： [http ://erwinmayer.com/labs/visual-studio-2010-extension-rename-visual-studio-window-title/](http://erwinmayer.com/labs/visual-studio-2010-extension-rename-visual-studio-window-title/)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-04-29T08:29:33.713

查看最新版本的[VSCommands 2010 Lite](http://vscommands.squaredinfinity.com/)。它引入了一个名为 Friendly Solution Name 的功能，您可以在其中设置正则表达式模式以从文件夹结构中提取分支名称并将其放置在 Visual Studio 主窗口标题中。更多详细信息： http: [//vscommands.com/releasenotes/3.6.8.0](http://vscommands.com/releasenotes/3.6.8.0)和[http://vscommands.com/releasenotes/3.6.9.0](http://vscommands.com/releasenotes/3.6.9.0)

[MSDN 下载页面](http://visualstudiogallery.msdn.microsoft.com/d491911d-97f3-4cf6-87b0-6a2882120acf)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T17:12:40.563

尝试设置 MainWindow.Caption 会引发异常。您必须使用 Win32 SetWindowText 函数来更改标题，但请注意：Visual Studio 会立即重置标题栏文本，因此您应该实现一个 Timer 来继续设置所需的文本。加载项类中的以下代码`Connect`将永久（或者，只要加载项正在运行）将标题栏文本保持为“Hello World！”

```
public void OnConnection(object application, ext_ConnectMode connectMode, object addInInst, ref Array custom)
{
    _applicationObject = (DTE2)application;
    _addInInstance = (AddIn)addInInst;
    resetTitleTimer = new Timer(new TimerCallback(SetMainWindowTitle), "Hello world!", 0, 10);
}

[DllImport("user32.dll")]
private static extern bool SetWindowText(IntPtr hWnd, string lpString);
private void SetMainWindowTitle(object state)
{
    IntPtr hWnd = (IntPtr)_applicationObject.MainWindow.HWnd;
    SetWindowText(hWnd, "Hello World!");            
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T18:40:23.143

我添加了一个针对解决方案文件的具有不同名称的符号链接。打开带有符号链接的解决方案，窗口标题具有符号链接名称。

在 Windows 中：mklink BlawBranch.sln Blaw.sln

编辑：发现如果我们的源代码管理更新了目标 .sln 文件，硬链接会中断。符号链接没有同样的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-18T00:01:45.753

通过将其定义为表达式来更改 Visual Studio 标题栏的另一个扩展：http: [//visualstudiogallery.msdn.microsoft.com/2e8ebfe4-023f-4c4d-9b7a-d05bbc5cb239](http://visualstudiogallery.msdn.microsoft.com/2e8ebfe4-023f-4c4d-9b7a-d05bbc5cb239)

使用“标题表达式”的设置使这个插件非常灵活。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T09:43:17.693

老实说，我不确定我是否正确理解了您的问题，但我曾在 SO 上问过一个似乎与类似问题有关的问题：

[使用同一 Visual Studio 2005 解决方案的不同版本/分支](https://stackoverflow.com/questions/523637/working-with-different-versions-branches-of-the-same-visual-studio-2005-solution)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T16:49:06.720

也许更简单的解决方案是使用虚拟桌面？空间排列更容易记住，你可以将任何相关的窗口与对应的VS进行分组，切换会更简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-23T11:01:42.397

对于任何基于 Visual Studio 的 IDE，都有一个名为 AppName 的属性，这应该可以解决问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-14T21:43:32.837

从[http://www.helixoft.com/blog/archives/32](http://www.helixoft.com/blog/archives/32)将标题设置为当前文件名。它也适用于 Visual Studio 10

```
 Private timer As System.Threading.Timer
Private ideTitle As String = Nothing
Declare Auto Function SetWindowText Lib "user32" (ByVal hWnd As System.IntPtr, _
ByVal lpstring As String) As Boolean

'''<summary>Called when any window in VS gets activated.</summary>
'''<param name="GotFocus">Window that got focus.</param>
'''<param name="LostFocus">Window that lost focus.</param>
Private Sub WindowEvents_WindowActivated(ByVal GotFocus As EnvDTE.Window, ByVal LostFocus As EnvDTE.Window) Handles WindowEvents.WindowActivated
    Try
        If timer Is Nothing Then
            ' Create timer which refreshes the caption because
            ' IDE resets the caption very often
            Dim autoEvent As New System.Threading.AutoResetEvent(False)
            Dim timerDelegate As System.Threading.TimerCallback = _
                AddressOf tick
            timer = New System.Threading.Timer(timerDelegate, autoEvent, 0, 200)
        End If

        If GotFocus.Document Is Nothing Then
            ideTitle = Nothing
        Else
            ideTitle = GotFocus.Document.FullName
            showTitle(ideTitle)
        End If
    Catch ex As System.Exception
    End Try
End Sub

''' <summary>Dispose the timer on IDE shutdown.</summary>
Public Sub DTEEvents_OnBeginShutdown() Handles DTEEvents.OnBeginShutdown
    If Not timer Is Nothing Then
        timer.Dispose()
    End If
End Sub

'''<summary>Called by timer.</summary>
Public Sub tick(ByVal state As Object)
    Try
        If Not ideTitle Is Nothing Then
            showTitle(ideTitle)
        End If
    Catch ex As System.Exception
    End Try
End Sub

'''<summary>Shows the title in main window.</summary>
Private Sub showTitle(ByVal title As String)
    SetWindowText(New System.IntPtr(DTE.MainWindow.HWnd), title & " - " & DTE.Name)
End Sub 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-04T12:54:49.793

在 2012 年，您必须进行设置`System.Windows.Application.Current.MainWindow.Title`才能使其正常工作。这将更新 TaskBarItem 标题和 MainWindow 标题。

这只能从主线程中实现，并且由于 Visual Studio 会在不同点更新标题，因此您必须连接一些事件并将其重置为您想要的任何内容（在我的 AddIn 中，我使用了`EnvDTE.SolutionEvents`一些）。

希望这可以帮助。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-02-23T11:43:26.317

在 VS 自动化模型中有

```
_DTE.MainWindow.Capation 
```

你可以从它开始。

请参阅[http://msdn.microsoft.com/en-us/library/envdte._dte.mainwindow.aspx](http://msdn.microsoft.com/en-us/library/envdte._dte.mainwindow.aspx)

# perl - 如何使用固定连接条件建立 DBIx::Class 关系？

> ID：577190
> 
> 赞同：8
> 
> 时间：2009-02-23T10:43:44.180
> 
> 标签：perl, dbix-class

我们有一个可以在一侧处理多种类型的对象的链接表，但我不知道如何使用 has_many 从这些对象之一获取链接表。

示例：链接表包含：

> ```
> id link_id link_table resource_id
> 1  1       page       3
> 2  1       page       5
> 3  2       page       3
> 4  1       not_page   1 
> ```

从资源端建立关系很容易：

```
Resource->has_many(links => 'Link', 'resource_id'); 
```

但是我一直没能从页面端得到对应关系：

```
Page->has_many(links => 'Link', 'link_id'); 
```

会得到 not_page 链接

```
Page->has_many(links => 'Link', {'foreign.link_id' => 'self.id', 'foreign.link_table' => 'page'}); 
```

给出一个“无效的 rel cond val page”错误（这对我来说并不奇怪）。

```
Page->has_many(links => 'Link', {'foreign.link_id' => 'self.id', 'foreign.link_table' => '"page"'}); 
```

给出“无效的 rel cond val "page"”错误。扔反斜杠没有帮助。

[DBIx::Class::Relationship::Base](http://search.cpan.org/perldoc?DBIx::Class::Relationship::Base#add_relationship)说：

> 条件必须是表之间连接的[SQL::Abstract](http://search.cpan.org/perldoc?SQL%3A%3AAbstract)样式表示

我从那里尝试了各种不同的选择，例如：

```
Page->has_many(links => 'Link', {'foreign.link_id' => 'self.id', 'foreign.link_table' => {'=', 'page'}}); 
```

但根本没有任何成功。

如果我将另一个字段添加到始终包含值“页面”的页表中，我可以这样做

```
Page->has_many(links => 'Link', {'foreign.link_id' => 'self.id', 'foreign.link_table' => 'self.what_table_am_i'}); 
```

但这几乎不是最佳解决方案。

为每种类型将链接表拆分为单独的一个可能是可能的，但这是一个正在考虑适应 DBIx::Class 的现有项目，可能还有其他地方将一个表拆分为多个其他表更多比它的价值麻烦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T14:01:57.200

您应该只创建一个包装器方法来调用具有所需参数的关系：

```
Page->has_many(__all_links => 'Link', 'link_id');

sub links {
    shift->__all_links({link_table => 'page'});
} 
```

如果您有多个需要具有这种连接逻辑的表，这将很容易变成 DBIx::Class 组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-20T14:29:35.917

它可以在 has_many 调用中指定，如下所示：

```
Page->has_many(links => 'Link', 'link_id',
                    { where => { link_table => 'page'} }); 
```

请参阅：[DBIx::Class Cookbook](http://search.cpan.org/~frew/DBIx-Class-0.08123/lib/DBIx/Class/Manual/Cookbook.pod#Filtering_a_relationship_result_set "DBIx::课堂食谱")

# http - Cookie2 规范的当前状态是什么？

> ID：577191
> 
> 赞同：13
> 
> 时间：2009-02-23T10:43:58.050
> 
> 标签：http, cookies, http-headers

您是否有一些关于实现/计划实现这部分 HTTP 1.1 规范的浏览器的信息？此外，哪些框架已经实现了此功能。我已经完成了我的谷歌研究，但我想知道是否还有其他内容。

另外，你/你会使用它吗？你觉得它比 Cookie/Set-Cookie 实现更好吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-26T11:57:31.297

**更新**：Cookie2 规范从未流行起来，RFC 6265 现在宣布它已过时，这使得这个问题变得毫无意义——尽管讨论它失败的原因可能仍然很有趣。

下面的答案写于 2009 年。

* * *

我主要回答第二部分。

我最近对它进行了一些研究，现在我坚信不，它还没有准备好使用，我不会使用它。

很难在现有规范中找到适用于当前浏览器和代理的具体数据，因为 cookie 最初是作为专有浏览器扩展，并继续添加专有功能，例如最近的“http-only”标志。我认为，总的来说，业界继续使用这种与 RFC 2109 实现混合的准“Netscape 风格”，除了关于第三方 cookie 的更宽松的规则以及有时使用未引用的字符串的一些奇怪行为。

至于我是否觉得它更好，通读规范确实显示了它的好处 - 即，客户端现在将路径、域和端口参数作为“美元”参数传回，因此 Web 应用程序知道要使用哪些参数删除/覆盖该cookie。使用 cookie 存储评论的能力有一天会成为用户的胜利，因此他们有机会看到 cookie 用途的纯文本解释，但除非浏览器开始警告人们关于 cookie，否则谁会看到他们？

需要同时发送 set-cookie 和 set-cookie2 标头也让我很不爽，因为除了 Cookie 标头之外，客户端还需要发送 Cookie2 标头，当我查看它时，这似乎是不必要的。YMMV。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-08-09T10:14:42.310

阅读废弃 rfc 2965 的 RFC 6265。建议不要使用或实施 cookie2

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T12:07:26.920

目前的状态是大多数浏览器仅完全支持[Netscape 最初的 Cookie 规范](http://web.archive.org/web/20070805052634/http%3A//wp.netscape.com/newsref/std/cookie_spec.html)。

`Set-Cookie`/ `Cookie`per [RFC 2109](https://www.rfc-editor.org/rfc/rfc2109)仅受某些浏览器支持（我不知道是哪个）和`Set-Cookie2`/ `Cookie2`per [RFC 2965](https://www.rfc-editor.org/rfc/rfc2965)仅受 Opera 支持。

# sql - 提高 Sql Delete 的性能

> ID：577193
> 
> 赞同：6
> 
> 时间：2009-02-23T10:44:42.523
> 
> 标签：sql, database, sybase, query-optimization, database-optimization

我们有一个查询来根据 id 字段（主键）从表中删除一些行。这是一个非常简单的查询：

```
delete all from OUR_TABLE where ID in (123, 345, ...) 
```

问题是 id 的数量可能很大（例如 70k），因此查询需要很长时间。有没有办法优化这个？（我们正在使用 sybase - 如果这很重要）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T10:59:53.173

有两种方法可以使这样的语句执行：

1.  创建一个新表并复制除要删除的行之外的所有行。之后交换桌子（`alter table name ...`）我建议尝试一下，即使它听起来很愚蠢。一些数据库在复制时比在删除时快得多。

2.  对表进行分区。创建 N 个表并使用视图将它们合并为一个。将行排序到按删除条件分组的不同表中。这个想法是删除整个表而不是删除单个行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T10:55:40.813

我想知道解析包含 70K 项的 IN 子句是否有问题。您是否尝试过使用连接的临时表？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T14:35:23.577

考虑分批运行它。一次运行 1000 条记录的循环可能比一个执行所有操作的查询要快得多，此外，它不会让其他用户在一段时间内锁定表。

如果您有级联删除（并且许多外键表受到影响）或涉及触发器，您可能需要以更小的批次运行。您必须进行试验，看看哪个数字最适合您的情况。我有一些表格，我必须分批删除 100 个表格，而其他表格需要 50000 个表格（幸运的是，我正在删除一百万条记录）。

但在任何情况下，我都会将我打算删除的键值放入临时表并从那里删除。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T11:12:35.453

Sybase 可以处理 IN 子句中的 70K 参数吗？`IN`我使用的所有数据库对子句的参数数量都有一些限制。例如，Oracle 限制在 1000 左右。

您可以创建子选择而不是 IN 子句吗？这将缩短sql。也许这对 IN 子句中的大量值有帮助。像这样的东西：

```
 DELETE FROM OUR_TABLE WHERE ID IN 
        (SELECT ID FROM somewhere WHERE some_condition) 
```

如果数据库模型允许，可以通过对数据库进行一些干预来加快删除大量记录。以下是一些策略：

1.  您可以通过删除索引、删除记录和重新创建索引来加快速度。这将在删除记录时消除重新平衡索引树。

    *   删除表上的所有索引
    *   删除记录
    *   重新创建索引
    *   如果您与该表有很多关系，如果您绝对确定 delete 命令不会破坏任何完整性约束，请尝试禁用约束。删除会更快，因为数据库不会检查完整性。删除后启用约束。
    *   禁用完整性约束，禁用检查约束
    *   删除记录
    *   启用约束
    *   如果您有任何触发器并且您的业务规则允许，请禁用表上的触发器。删除记录，然后启用触发器。

    *   最后，按照其他建议做 - 制作包含不会被删除的行的表的副本，然后删除原始，重命名副本并重新创建完整性约束（如果有）。

我会尝试 1、2 和 3 的组合。如果这不起作用，那么 4。如果一切都很慢，我会寻找更大的盒子 - 更多的内存，更快的磁盘。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T11:30:08.873

找出是什么消耗了性能！

在许多情况下，您可能会使用提供的解决方案之一。但可能还有其他人（基于 Oracle 知识，所以在其他数据库上情况会有所不同。编辑：刚刚看到你提到了 sybase）：

*   你那张桌子上有外键吗？确保引用的 id 被编入索引
*   你在那个表上有索引吗？可能是在删除之前删除并在删除之后重新创建可能会更快。
*   检查执行计划。它是否使用全表扫描可能更快的索引？还是反过来？提示可能会有所帮助
*   而不是像上面建议的那样选择新表，因为选择可能会更快。

但请记住：首先找出消耗性能的原因。

当您使用 DDL 语句时，请确保您了解并接受它可能对事务和备份产生的后果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T11:59:30.207

尝试按照与表相同的顺序对传递到“in”中的 ID 进行排序，或者索引存储在其中。然后您可能会在磁盘缓存上获得更多命中。

将要删除的 ID 放入一个临时表中，该临时表的 ID 与主表的排序顺序相同，可以让数据库对主表进行简单的扫描。

您可以尝试使用多个连接并将工作吐出连接，以便使用数据库服务器上的所有 CPU，但是首先考虑将取出哪些锁等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-09T17:04:41.657

我也认为临时表可能是最好的解决方案。

但是，如果您要执行“从 .. 中删除 ID（从...中选择 ID）”，那么对于大型查询，它仍然会很慢。因此，我建议您使用连接删除 - 许多人不知道该功能。

所以，给定这个示例表：

```
 -- set up tables for this example
    if exists (select id from sysobjects where name = 'OurTable' and type = 'U')
        drop table OurTable
    go

    create table OurTable (ID integer primary key not null)
    go
    insert into OurTable (ID) values (1)
    insert into OurTable (ID) values (2)
    insert into OurTable (ID) values (3)
    insert into OurTable (ID) values (4)
    go 
```

然后我们可以编写我们的删除代码如下：

```
 create table #IDsToDelete (ID integer not null)
    go
    insert into #IDsToDelete (ID) values (2)
    insert into #IDsToDelete (ID) values (3)
    go
    -- ... etc ...
    -- Now do the delete - notice that we aren't using 'from'
    -- in the usual place for this delete
    delete OurTable from #IDsToDelete
       where OurTable.ID = #IDsToDelete.ID
    go
    drop table #IDsToDelete
    go
    -- This returns only items 1 and 4
    select * from OurTable order by ID
    go 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T10:58:17.407

our_table 是否有关于删除级联的参考？

# c# - SilverLight 2.0 的 C# 中的 Web 请求

> ID：577195
> 
> 赞同：1
> 
> 时间：2009-02-23T10:45:54.160
> 
> 标签：c#, silverlight, webrequest

我一直在使用以下代码从 SilverLight 中的 Apache 2.2 获取简单的 Web 响应，但无济于事。

```
 private void bDoIt_Click(object sender, RoutedEventArgs e)
    {
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(new Uri("/silverlight/TestPage2.html"));

        request.Method = "POST";
        request.ContentType = "text/xml";

        request.BeginGetRequestStream(new AsyncCallback(RequestProceed), request);
    }

    private void RequestProceed(IAsyncResult asuncResult)
    {
        HttpWebRequest request = (HttpWebRequest)asuncResult.AsyncState;

        StreamWriter postDataWriter = new StreamWriter(request.EndGetRequestStream(asuncResult));
        postDataWriter.Close();

        request.BeginGetResponse(new AsyncCallback(ResponceProceed), request);

    }

    private void ResponceProceed(IAsyncResult asuncResult)
    {
        HttpWebRequest request = (HttpWebRequest)asuncResult.AsyncState;

        HttpWebResponse responce = (HttpWebResponse)request.EndGetResponse(asuncResult);
        StreamReader responceReader = new StreamReader(responce.GetResponseStream());

        string responceString = responceReader.ReadToEnd();

        txtData.Text = responceString;
    } 
```

有没有人没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T10:50:56.503

你试过[`WebClient`](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.95).aspx)吗？这存在于 silverlight 上，可能会使生活更轻松。想必你会想要[`UploadStringAsync`](http://msdn.microsoft.com/en-us/library/system.net.webclient.uploadstringasync(VS.95).aspx).

另外-我相信您需要使用绝对网址；如果您不想硬编码（相当合理），您可以从以下位置获取主机：

```
string url = App.Current.Host.Source.AbsoluteUri; 
```

然后使用字符串/等方法制作正确的“ [http://yoursite/whatever/your.page](http://yoursite/whatever/your.page) ”；

请注意，silverlight 仅允许 (IIRC) 连接到主机站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T13:08:54.377

您可以将**BeginGetResponse**调用作为示例测试用例中的第一个调用，仅当您打算将一些 POST 数据传递到请求的页面时才需要调用**BeginGetRequestStream 。**

# pdf - 100 页后断开 PDF 文档

> ID：577197
> 
> 赞同：1
> 
> 时间：2009-02-23T10:46:08.323
> 
> 标签：pdf, jasper-reports, ireport

我正在使用 JasperReports 和 iReport 工具。客户想要的要求之一是将 PDF 文件生成为 100 页的文档。

请你帮助我好吗？如何生成 100 页的 PDF 文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-01-28T18:16:03.660

正如@WEG 在[JasperReport 大小限制](https://stackoverflow.com/questions/544581/jasperreport-size-limit)问题的答案中提到的那样，可以借助以下参数来完成：

*   [***`net.sf.jasperreports.governor.max.pages.enabled`***](http://jasperreports.sourceforge.net/config.reference.html#net.sf.jasperreports.governor.max.pages.enabled)- 指示检查报告是否超过指定页数限制的调控器是否打开的标志。启用此属性后，如果页数大于自定义给定值，JR 引擎将停止报告执行；
*   [***`net.sf.jasperreports.governor.max.pages`***](http://jasperreports.sourceforge.net/config.reference.html#net.sf.jasperreports.governor.max.pages)- 如果检查报告是否超过指定页数限制的调控器打开，此属性将指示允许运行的最大页数，以防止内存溢出错误。如果报表中的页数大于该值，报表执行将停止；
*   [***`REPORT_MAX_COUNT`***](http://jasperreports.sourceforge.net/api/net/sf/jasperreports/engine/JRParameter.html#REPORT_MAX_COUNT)- 一个允许限制数据源大小的整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:08:28.947

在 iReport 中，您可以找到一个内置变量 PAGE_COUNT。对于详细信息带中的每个元素，您可以将以下内容放在“表达式时打印”文本框中：

```
Boolean.valueOf($V{PAGE_COUNT}.intValue() < 100) 
```

这将在第 100 页后停止打印。

# wcf - 从 WCF 服务返回 NHibernate 映射类

> ID：577201
> 
> 赞同：3
> 
> 时间：2009-02-23T10:47:43.140
> 
> 标签：wcf, nhibernate

我有一个处理数据库访问的服务器和一个使用信息的客户端。从客户端到服务器的通信是通过 WCF 服务进行的。

当 NHibernate POCO 从服务返回时，对象图中的所有对象都被序列化了吗？如果是这样，有没有办法改变它？

我也在考虑不返回 NHibernate POCO，而是返回一个只包含基本信息的对象。

在这些情况下你会怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T10:52:08.747

使用数据传输对象将数据从服务器移动到客户端。您的业​​务（领域模型）对象不一定要暴露在应用程序的核心之外，而应该被视为受保护的资产。

您可以使用[AutoMapper](http://www.codeplex.com/AutoMapper)自动将业务对象转换为数据传输对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T01:38:17.213

是的，你可能需要一个 DTO。通常认为最好不要将数据对象传递给外部世界，但直接从服务中传递休眠对象也会给您带来一些奇怪的行为，尤其是当您延迟加载集合时。

# nhibernate - sql 探查器显示 nhibernate 运行查询两次？

> ID：577203
> 
> 赞同：0
> 
> 时间：2009-02-23T10:48:22.343
> 
> 标签：nhibernate, profiling, sql-server-profiler

我一直在对我正在开发的应用程序进行一些性能分析。该应用程序是基于 Web (asp.net) 的，在 MSSQL Server (2005) 上使用旧版本的 NHibernate (1.0)。

对应用程序运行分析器似乎显示了一些奇怪的东西，因为我们似乎查询了两次对象，一次作为直接查询，一次包装在 sp_executesql 中。例如：

```
从表中选择 col1、col2
exec sp_executesql N'SELECT col1, col2 FROM TABLE'

```

查看分析器中的统计信息，我可以看到它们是不同的事件（选择记录为事件 45 - SP:StmtCompleted，而对 sp_executesql 的调用记录为事件 10 - RPC:Completed）。

在此之前我没有过多地使用 NHibernate，但我无法想象这是正常行为。我是否误读了配置文件跟踪（在这种情况下我应该如何解释上述内容），或者有充分的理由吗？

如果上述情况和我想的一样糟糕，有没有办法关闭这种行为？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T11:08:41.343

您的查询不会运行两次。只是这两个事件是针对同一个语句触发的。

# java - 用 Java 构建树

> ID：577205
> 
> 赞同：0
> 
> 时间：2009-02-23T10:50:32.323
> 
> 标签：java, tree

我是Java的新手。我想用一个根节点和多个子节点构建一棵树，每个分支都有一些权重。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T11:01:26.417

示例代码：

```
class Node {
    public int weight;
    public List<Node> children = new ArrayList<Node> ();
}

Node root = new Node (); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T10:58:10.247

这只是一个让你开始的草图，可以改进很多。但是您的基本成员可能如下：

```
public class WeightedTree {
   private double weight;
   private List<WeightedTree> children;
} 
```

如果这是一个家庭作业问题，我不想写更多，但如果您有具体的跟进，请随时发表评论。

# sql-server-ce - 为什么 SQL Server CE 不支持 varchar？

> ID：577209
> 
> 赞同：16
> 
> 时间：2009-02-23T10:51:01.247
> 
> 标签：sql-server-ce

我在 SQL Server CE 中创建了一个表，并意识到它不支持 varchar。

查找此内容，我发现“不支持非 Unicode 文本列（varchar、char、text）和 smallmoney；尽管支持 nvarchar、nchar、ntext 和 money”，如[MSDN 所述](http://msdn.microsoft.com/en-us/library/aa275635(SQL.80).aspx)。

这是真的？这是为什么呢？看起来*紧凑*的数据库将支持需要*更少字节*来存储的数据类型......我假设它需要更多空间来保存 Unicode 字符。

这背后的原因是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-23T10:57:04.757

这可能是因为 Windows CE 完全基于 Unicode，并且它的所有字符串都以这种方式存储。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-16T05:46:09.487

我认为他们试图减少部署空间并简化界面。这可能是为了避免不得不部署更多版本的 DLL（unicode 与非 unicode 版本）。

是的，他们确实只支持 Unicode。

但这并不自动意味着需要 2 个字节来存储。您可以在数据库层对其进行编码，以便在不需要时基本上剥离第一个字节。许多数据库引擎将其作为 Unicode 压缩的一种手段。

这只是意味着任何确实使用两个字节集的条目都有一个额外的标记的轻微开销，告诉引擎该序列正在使用两个字节。否则，仍然可以将单个字节存储到磁盘，并作为 RowData 读取的一部分进行扩展。

大多数紧凑型数据库在实际将字节放入磁盘时总是使用一种运行长度压缩形式以节省空间。当它从引擎中出来时，您碰巧看到的格式很少与实际存储在磁盘上的格式相匹配。

# c# - 正则表达式 - 我只想匹配正则表达式中的开始标签

> ID：577210
> 
> 赞同：2
> 
> 时间：2009-02-23T10:51:10.560
> 
> 标签：c#, .net, html, regex, tags

我正在制作一个正则表达式，我只想匹配错误的标签，例如：`<p> *some text here, some other tags may be here as well but no ending 'p' tag* </p>`

```
 <P>Affectionately Inscribed </P><P>TO </P><P>HENRY BULLAR, </P><P>(of the western circuit)<P>PREFACE</P> 
```

在上面相同的文本中，我想得到结果， `<P>(of the western circuit)<P>`并且不应该捕获任何其他内容。我正在使用它，但它不起作用：

```
<P>[^\(</P>\)]*<P> 
```

请帮忙。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T10:59:00.540

对于 xml/html 类型的数据，Regex 并不总是一个好的选择。特别是属性、区分大小写、注释等都有很大的影响。

对于 xhtml，我会使用`XmlDocument`/`XDocument`和一个 xpath 查询。

对于“非 x” html，我会查看[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)和相同的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T11:00:23.407

匹配组之一：

```
(?:<p>(?:(?!<\/?p>).?)+)(<p>) 
```

匹配第二个`<p>`：

```
<P>(of the western circuit)<P>PREFACE</P> 
```

注意：我通常是这样说的人之一：“不要用正则表达式做 HTML，而是使用解析器”。但我不认为具体问题可以用解析器来解决，它可能只是忽略/透明地处理无效标记。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T12:09:28.890

我知道在这种情况下这不太可能（甚至 html-legal？）发生，但是通用的未封闭 xml-tag 解决方案将非常困难，因为您需要考虑嵌套标签会发生什么，例如

```
<p>OUTER BEFORE<p>INNER</p>OUTER AFTER</p> 
```

我很确定到目前为止给出的正则表达式会匹配`<p>`那里的第二个，即使它实际上不是一个未封闭的`<p>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T10:55:24.370

`*`与其使用最大匹配，不如使用`*?`最小匹配。

应该可以开始

```
<P>((?!</P>).)*?<P> 
```

这使用否定的前瞻断言来确保结束标记在“”匹配之间的每个点都不匹配`<P>`。

编辑：更正了断言（感谢评论者）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T16:12:00.117

到目前为止提供的所有解决方案都与第二个 <P> 匹配，但这是错误的。如果有两个连续的 <P> 元素没有结束标签怎么办？第二个将不匹配，因为第一个匹配吃了它的开始标签。你可以通过使用前瞻来避免这个问题，就像我在这里所做的那样：

```
@"<p\b(?>(?:[^<]+|<(?!/?p>))*)(?=<p\b|$)" 
```

至于其余部分，我使用“不是初始或不是其余”技术以及原子组来引导正则表达式尽可能有效地匹配（并且，更重要的是，如果它是尽可能快地失败即将）。

# sql-server-ce - 如何在 SQL Server Management Studio 中管理 SQL CE 数据库？

> ID：577222
> 
> 赞同：25
> 
> 时间：2009-02-23T10:55:59.707
> 
> 标签：sql-server-ce, ssms

我使用 Visual Studio 2008（添加/新项目/本地数据库）创建了一个 SDF (SQL CE) 数据库。

是否可以使用 SQL Server Management Studio 编辑此数据库？我尝试附加它，但它只提供 .mdf 并附加 .sdf 文件会导致“无法检索此请求的数据”。

如果是这样，是否也可以使用 Management Studio 创建 SDF 文件？还是我们停留在 Visual Studio 2008 数据库管理器的简单界面上？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-07-02T03:29:43.937

您可以使用 SQL Server 2008 Management Studio 创建 .sdf 文件。

在“文件”>“连接对象资源管理器”对话框中，将“服务器类型”下拉列表更改为 SQL Server Compact Edition。

然后在 Database File 下拉列表中选择 New Database.... 就可以开始了。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-06T21:38:27.983

*   Management Studio 2005 支持 SQL CE 3.0。
*   Management Studio 2005 SP2 最高支持 SQL CE 3.1。
*   Management Studio 2008 最高支持 SQL CE 3.5 SP1

我认为 Management Studio *Express* 2008 不支持 SQL CE 数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T02:00:51.107

您使用的是 Management Studio 2005 还是 2008？如果您创建 SQL CE 3.5 数据库，它应该在 2008 年工作......只是在 2005 年不行。

# visual-studio-2008 - 基于汇编平台使用Powershell在VS中实现post build

> ID：577228
> 
> 赞同：0
> 
> 时间：2009-02-23T10:58:23.537
> 
> 标签：visual-studio-2008, powershell, build-process

我正在尝试使用 Powershell 在 Visual Studio 中实现后期构建。我想根据程序集的目标平台（即x86或x64）在构建后将适当的dll复制到适当的目录中。有谁知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T20:51:12.763

为什么不使用 Visual Studio 自己的自定义构建步骤？重新发明轮子似乎很奇怪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T11:43:59.667

您可以在构建后事件中使用类似以下内容：

Powershell -File "$(SolutionDir)PostBuild.ps1" $(PlatformName)

然后可以在脚本 (PostBuild.ps1) 内的 $args[0] 中找到平台名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T11:34:30.050

您将需要显式启动 PSH。

就像是

```
    PowerShell -command &" *commands go here* "

```

假设（默认情况下）PSH 在用户的路径中。

# php - 使用 AJAX/Jquery 实时查找用户名

> ID：577231
> 
> 赞同：1
> 
> 时间：2009-02-23T10:58:58.933
> 
> 标签：php, javascript, jquery, ajax, dhtml

我想要一个这样的javascript函数：

```
function isUsernameAvailable(username)
{
   //Code to do an AJAX request and return true/false if
  // the username given is available or not
} 
```

这如何使用 Jquery 或 Xajax 来完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T11:31:30.820

使用 AJAX 的最大优势在于它是异步的。您要求进行同步函数调用。可以这样做，但它可能会在等待服务器时锁定浏览器。

使用 jquery：

```
function isUsernameAvailable(username) {
    var available;
    $.ajax({
        url: "checkusername.php",
        data: {name: username},
        async: false, // this makes the ajax-call blocking
        dataType: 'json',
        success: function (response) {
            available = response.available;
        }
     });
     return available;
} 
```

然后，您的 php 代码应检查数据库并返回

```
{available: true} 
```

如果名字没问题。

也就是说，您可能应该异步执行此操作。像这样：

```
function checkUsernameAvailability(username) {
    $.getJSON("checkusername.php", {name: username}, function (response) {
        if (!response.available) {
            alert("Sorry, but that username isn't available.");
        }
    });
} 
```

# sql-server - 存储过程执行时间过长时发出 SQL 警报

> ID：577233
> 
> 赞同：5
> 
> 时间：2009-02-23T10:59:08.217
> 
> 标签：sql-server, sql-server-2008, monitoring, notifications, alert

我想设置一个 SQL Server 2008 警报，以便在任何过程执行 1 秒或更长时间时通知我（仅作为示例）。

有任何想法吗？

编辑：

好吧，这似乎是不可能的。但是，只是为了让您转向另一个方向，我知道主数据库中有统计表，其中包含编译计数、调用次数和其他各种统计信息。我是否可以定期查询它们，然后以某种方式进行报告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T11:07:07.103

不，没有通知。您必须设置跟踪并不时对其进行轮询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T11:17:10.840

如果在 sqlservercentral 上找到这个（它可能适用于旧版本的 SQL Server，但仍可能与 2008 年相关）

长时间运行作业的警报程序 [http://www.sqlservercentral.com/scripts/Lock+and+Connection+Management/30144/](http://www.sqlservercentral.com/scripts/Lock+and+Connection+Management/30144/)

如果您无法访问，请在下方输入文字。

对于定期运行且只需要很短时间运行的作业，DBA 可能想知道作业何时运行了过多时间。在这种情况下，仅检查作业是否正在运行是行不通的；需要确保它没有长时间运行的能力。将作业 ID 与 sysprocesses 中的进程 ID 匹配需要重新安排作业 ID 以进行匹配。此脚本创建一个存储过程，该过程将接受作业名称、允许的最长运行时间和要通知的电子邮件地址。然后它将使用作业名称重新排列作业编号并检查 sysprocesses（基于作为程序名称一部分的进程 ID）以确定作业运行的时间量，然后在该时间结束时发出警报“时间允许”参数。

```
CREATE proc sp_check_job_running
    @job_name       char(50),
    @minutes_allowed    int,
    @person_to_notify   varchar(50)
AS  

DECLARE @var1           char(1),
    @process_id     char(8),
    @job_id_char        char(8),
    @minutes_running    int,
    @message_text       varchar(255)

select @job_id_char = substring(CAST(job_id AS char(50)),1,8) 
from  msdb..sysjobs
where name = @job_name

select @process_id =    substring(@job_id_char,7,2) + 
            substring(@job_id_char,5,2) +
            substring(@job_id_char,3,2) +
            substring(@job_id_char,1,2)

select @minutes_running = DATEDIFF(minute,last_batch, getdate())
from master..sysprocesses
where program_name LIKE ('%0x' + @process_id +'%')

if @minutes_running > @minutes_allowed
  BEGIN
    select @message_text = ('Job ' 
    + UPPER(SUBSTRING(@job_name,1,LEN(@job_name)))
    + ' has been running for '
    + SUBSTRING(CAST(@minutes_running AS char(5)),1,LEN(CAST(@minutes_running AS char(5))))
    + ' minutes, which is over the allowed run time of '
    + SUBSTRING(CAST(@minutes_allowed AS char(5)),1,LEN(CAST(@minutes_allowed AS char(5)))) 
    + ' minutes.')
    EXEC master..xp_sendmail 
    @recipients = @person_to_notify, 
    @message = @message_text,
        @subject = 'Long-Running Job to Check'
  END

--  Typical job step syntax for job to do the checking

execute sp_check_job_running
      'JobThatSHouldBeDoneIn5Minutes', 
       5, 
       'DBAdmin@mycompany.com' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-01T18:29:51.760

我想补充 Mladen Prajdic 的正确答案，并改进 SQL Server Central 的 kevchadders 答案。我在下面提出的解决方案使用 DBMail 而不是 SQLMail（SQLServerCentral 的解决方案通过 xp_sendmail 调用使用它）。本质上，SQLMail 使用 MAPI，更难设置，而 DBMail 使用 SMTP，更容易设置。这是有关两者之间差异的[更多信息。](http://blog.sqlauthority.com/2008/07/05/sql-server-difference-between-database-mail-and-sqlmail/)

我无法让 SQL Server Central 的解决方案在 SQL 2005 中工作，并且以下解决方案仅在我安装的 SQL 2005 - 基于版本的 YMMV 上进行了测试。

首先，您需要一个新的 UDF，它将作业 ID 转换为 JOIN 的进程 ID：

```
CREATE FUNCTION dbo.udf_SysJobs_GetProcessid(@job_id uniqueidentifier)
RETURNS VARCHAR(8)
AS
BEGIN
    RETURN (substring(left(@job_id,8),7,2) +
    substring(left(@job_id,8),5,2) +
    substring(left(@job_id,8),3,2) +
    substring(left(@job_id,8),1,2))
END 
```

然后是存储过程：

```
CREATE PROC sp_check_job_running 
    @job_name char(50),
    @minutes_allowed int, 
    @person_to_notify varchar(50) 

AS 

DECLARE @minutes_running int, 
    @message_text varchar(255)

SELECT @minutes_running = isnull(DATEDIFF(mi, p.last_batch, getdate()), 0)
FROM master..sysprocesses p
JOIN msdb..sysjobs j ON dbo.udf_sysjobs_getprocessid(j.job_id) = substring(p.program_name,32,8)
WHERE j.name = @job_name

IF @minutes_running > @minutes_allowed 
    BEGIN
      SELECT @message_text = ('Job ' + UPPER(SUBSTRING(@job_name,1,LEN(@job_name))) + ' has been running for ' + SUBSTRING(CAST(@minutes_running AS char(5)),1,LEN(CAST(@minutes_running AS char(5)))) + ' minutes, which is over the allowed run time of ' + SUBSTRING(CAST(@minutes_allowed AS char(5)),1,LEN(CAST(@minutes_allowed AS char(5)))) + ' minutes.') 
      EXEC msdb.dbo.sp_send_dbmail
        @recipients = @person_to_notify,
        @body = @message_text,
        @subject = 'Long-Running Job to Check' 
    END 
```

可以轻松地将这个存储过程安排为 SQL Server 代理作业或任何其他必要的方法。如果作业未运行或在指定参数内运行，则不执行任何操作。如果作业运行时间超过指定时间，它会发送电子邮件。

例如

```
EXEC sp_check_job_running 'JobNameGoesHere', 5, 'admin@mycompany.com' 
```

HT：[http ://www.sqlserverspecialists.co.uk/blog/_archives/2008/11/26/3996346.html](http://www.sqlserverspecialists.co.uk/blog/_archives/2008/11/26/3996346.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-18T12:51:18.587

您可以使用像[Nagios](http://www.nagios.org/)这样的监控软件来定期计算数据库中慢查询的数量。

我个人将以下查询与出色的[PRTG](http://www.paessler.com/prtg)一起使用。我将其设置为每当我有超过 5 个执行时间大于 3 秒的查询时，或者当最慢的查询时间超过 10 秒时向我发送一封电子邮件：

```
SELECT total_elapsed_time / execution_count / 1000000 avg_elapsed_time, execution_count, creation_time, last_execution_time, 
SUBSTRING(st.text, (qs.statement_start_offset/2) + 1, ((CASE statement_end_offset WHEN -1 THEN DATALENGTH(st.text) ELSE qs.statement_end_offset END - qs.statement_start_offset)/2) + 1) AS statement_text
FROM sys.dm_exec_query_stats AS qs
CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) st
WHERE total_elapsed_time / execution_count / 1000000 >= 3  -- filter queries that takes > 3 seconds
AND CHARINDEX('dm_exec_query_stats', st.text) = 0   -- In case this query is slow, we don't want it in the result set!
ORDER BY total_elapsed_time / execution_count DESC; 
```

免责声明：此查询基于[https://stackoverflow.com/a/820252/638040](https://stackoverflow.com/a/820252/638040)

现在，如果您想监视您的存储过程，那么只需使用`sys.dm_exec_procedure_stats`而不是`sys.dm_exec_sql_text`（也从选择中删除该字段`creation_time`并调整 SUBSTRING on `st.text`）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T11:43:29.170

您可以使用 SQL Profiler 记录运行缓慢的查询，但具体而言，这不会帮助您发出警报。（我想您可以登录到文件或数据库表，并让其他东西“监听”并发出警报）。

如果您不熟悉 SQL Profiler，请按照以下步骤操作：

您应该在服务器本身以外的其他东西上运行 SQL Profiler。

从 SQLProfilerTSQL_Duration 模板开始

设置过滤器：持续时间：“大于”到 1000（毫秒）

在过滤器中，您可以根据需要限制数据库、登录或类似内容。

在事件中，您可以限制为仅 SProcs（默认还包括 SQL 语句）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T12:00:38.537

如果您不是在寻找免费的解决方案，您可以查看[SQL Sentry](http://www.sqlsentry.com/)。它可以满足您的要求以及更多功能。

# python - Python“扩展”字典

> ID：577234
> 
> 赞同：586
> 
> 时间：2009-02-23T10:59:32.567
> 
> 标签：python, dictionary

`for`在避免使用循环的同时用另一个字典扩展字典的最佳方法是什么？例如：

```
>>> a = { "a" : 1, "b" : 2 }
>>> b = { "c" : 3, "d" : 4 }
>>> a
{'a': 1, 'b': 2}
>>> b
{'c': 3, 'd': 4} 
```

结果：

```
{ "a" : 1, "b" : 2, "c" : 3, "d" : 4 } 
```

就像是：

```
a.extend(b)  # This does not work 
```

* * *

## 回答 #1

> 赞同：867
> 
> 时间：2009-02-23T11:01:49.987

```
a.update(b) 
```

[最新的 Python 标准库文档](http://docs.python.org/library/stdtypes.html#dict.update)

* * *

## 回答 #2

> 赞同：227
> 
> 时间：2009-10-12T02:27:52.243

[在这个封闭的问题](https://stackoverflow.com/questions/1551666/how-can-2-python-dictionaries-become-1/1551878#1551878)中是一个美丽的宝石：

既不改变输入字典的“单线方式”是

```
basket = dict(basket_one, **basket_two) 
```

在此处了解[`**basket_two`(the `**`) 的含义](http://www.saltycrane.com/blog/2008/01/how-to-use-args-and-kwargs-in-python/)。

如果发生冲突，来自的项目`basket_two`将覆盖来自的项目`basket_one`。就单行而言，这是非常易读和透明的，我不会因为任何时候使用它而感到内疚这促使他或她学习`dict`和`**`形式的方式;-)。因此，例如，使用如下：

```
x = mungesomedict(dict(adict, **anotherdict)) 
```

在我的代码中相当频繁地出现。

[最初由Alex Martelli](https://stackoverflow.com/users/95810/alex-martelli)提交

***注意：*在 Python 3 中，只有当 basket_two 中的每个键都是`string`.**

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2018-07-03T13:47:53.603

您是否尝试过将字典理解与字典映射一起使用：

```
a = {'a': 1, 'b': 2}
b = {'c': 3, 'd': 4}

c = {**a, **b}
# c = {"a": 1, "b": 2, "c": 3, "d": 4} 
```

另一种方法是使用 dict(iterable, **kwarg)

```
c = dict(a, **b)
# c = {'a': 1, 'b': 2, 'c': 3, 'd': 4} 
```

[在 Python 3.9 中，您可以使用 union | 添加两个字典。操作员](https://www.python.org/dev/peps/pep-0584/)

```
# use the merging operator |
c = a | b
# c = {'a': 1, 'b': 2, 'c': 3, 'd': 4} 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-02-23T11:04:22.493

```
a.update(b) 
```

将从*b*到*a 的*键和值添加，如果键的值已经存在，则覆盖。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2012-10-02T19:48:15.403

正如其他人所提到的，`a.update(b)`对于某些 dicts`a`并将`b`达到您在问题中要求的结果。但是，我想指出，我多次看到`extend`映射/设置对象的方法希望在语法`a.extend(b)`中 ,`a`的值不应该被`b`' 的值覆盖。`a.update(b)`覆盖`a`的值，因此对于`extend`.

请注意，某些语言调用此方法`defaults`或`inject`，因为它可以被认为是一种将 b 的值（可能是一组默认值）注入字典而不覆盖可能已经存在的值的方法。

当然，您可以简单地注意`a.extend(b)`几乎与`b.update(a); a=b`. 要删除分配，您可以这样做：

```
def extend(a,b):
    """Create a new dictionary with a's properties extended by b,
    without overwriting.

    >>> extend({'a':1,'b':2},{'b':3,'c':4})
    {'a': 1, 'c': 4, 'b': 2}
    """
    return dict(b,**a) 
```

感谢 Tom Leys`dict`为`extend`.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-12-14T08:40:34.540

### 请注意，从**python3.9**开始，引入了更简单的语法（联合运算符）：

```
d1 = {'a': 1}
d2 = {'b': 2}

extended_dict = d1 | d2
>> {'a':1, 'b': 2} 
```

**注意**：如果第一个字典与第二个字典共享密钥，位置很重要！

```
d1 = {'b': 1}
d2 = {'b': 2}
d1 | d2 
>> {'b': 2} 
```

[链接](https://www.python.org/dev/peps/pep-0584/)到相关 PEP

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-04-25T09:28:53.143

您还可以使用python 3.3 中引入的python 的[collections.Chainmap 。](https://docs.python.org/3/library/collections.html#chainmap-objects)

```
from collections import Chainmap
c = Chainmap(a, b)
c['a'] # returns 1 
```

这有一些可能的优势，具体取决于您的用例。[此处](https://stackoverflow.com/a/23441777/9726179)对它们进行了更详细的解释，但我将简要概述一下：

*   链图仅使用字典的视图，因此实际上不会复制任何数据。这导致更快的链接（但更慢的查找）
*   实际上没有键被覆盖，因此，如有必要，您知道数据是来自 a 还是来自 b。

这主要使它对诸如配置字典之类的东西有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-30T12:11:37.440

如果您需要它作为*Class*，您可以使用*dict*扩展它并使用*update*方法：

```
Class a(dict):
  # some stuff
  self.update(b) 
```

# c++ - 有什么理由使用这个->

> ID：577243
> 
> 赞同：17
> 
> 时间：2009-02-23T11:03:43.540
> 
> 标签：c++

我用 C++ 编程很多年了，但我仍然对一件事有疑问。在其他人代码的许多地方，我看到如下内容：

```
void Classx::memberfunction()
{
    this->doSomething();
} 
```

如果我需要导入/使用该代码，我只需删除**this->**部分，我从未见过任何损坏或有副作用的东西。

```
void Classx::memberfunction()
{
    doSomething();
} 
```

那么，您知道使用这种构造的任何理由吗？

编辑：请注意，我在这里谈论的是成员函数，而不是变量。我知道当您想区分成员变量和函数参数时可以使用它。

编辑：明显重复： [有什么理由不使用“this”（“Self”，“Me”，...）？](https://stackoverflow.com/questions/333291/are-there-any-reasons-not-to-use-this-self-me)

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-02-23T11:15:50.860

它真正发挥作用的唯一地方是派生类中的模板：

```
template<typename T>
class A {
protected:
  T x;
};

template<typename T>
class B : A<T> {
public:
  T get() {
    return this->x;
  }
}; 
```

由于[C++ 编译器中名称查找的详细信息，](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.19)必须明确说明它`x`是类的（继承的）成员，最容易使用`this->x`. 但这是一个相当深奥的案例，如果您没有模板化的类层次结构，您实际上不需要显式使用`this`来访问类的成员。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-23T11:07:05.730

如果在同一范围内有另一个同名的变量，this-> 将消除歧义。

```
void Bar::setFoo(int foo)
{
    this->foo = foo;
} 
```

此外，它清楚地表明您指的是成员变量/函数。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-23T11:27:24.043

为了保证如果定义的宏可能与您的成员函数同名并且您不确定它是否可靠地未定义，则会触发编译器错误。

不开玩笑，我很确定出于这个原因我必须这样做！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-23T11:08:07.210

作为“代码原因”，将本地参数或值（优先）与成员区分开来：

```
class Foo
{
    int member;
    void SetMember(int member)
    {
       this->member = member;
    }
} 
```

但是，这从一开始就不好，通常可以在本地解决。

第二个原因是更多的“环境”：它有时会帮助 Intellisense 过滤我真正想要的东西。但是，当我使用它来查找我正在寻找的成员时，我也应该删除它。

所以是的，有充分的理由，但它们都是暂时的（从长远来看是不好的）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T11:06:20.600

我可以想到可读性，例如当您使用额外的括号来使事情变得清晰时。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-23T11:07:01.770

我认为这主要是对读者的帮助。它明确表明被调用的是对象上的方法，而不是普通函数。例如，在阅读代码时，知道被调用的函数可以更改当前对象中的字段会很有帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-23T11:07:58.180

这是你自己的选择。当你使用它时，我发现它更清楚。但如果你不喜欢它，你可以省略它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-23T11:08:20.253

这实际上是一种风格问题，适用于许多其他语言，例如 Java 和 C#。有些人喜欢看明确的`this`（或`self`，或`Me`，或其他），而其他人则不喜欢。只需遵循您的风格指南中的任何内容，如果这是您的项目，您就可以决定指南。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-23T11:09:22.373

这样做是为了明确说明所使用的变量是成员变量，而不是局部变量或全局变量。在大多数情况下，这不是必需的，但是如果您在更紧凑的范围内使用同名声明胜过变量，那么明确范围可能会有所帮助。

在我工作过的公司中，我们只是在成员变量前加上“m_”。有时它会很有帮助，我更喜​​欢使用“this->”。

编辑：添加到[GCC 文档](http://gcc.gnu.org/onlinedocs/gcc/Name-lookup.html)的链接，它解释了使用 this-> 是使非依赖查找正常工作所必需的情况。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-11-22T12:37:48.553

有很多好的答案，但没有一个提到在源代码中使用 this-> 可以更容易阅读，尤其是当您阅读一些长函数的代码时，即使是短函数，想象一下代码：

```
bool Class::Foo()
{
    return SomeValue;
} 
```

通过查看此代码，您无法清楚地知道 SomeValue 是什么。它甚至可以是一些#define 或静态变量，但如果你写

```
bool Class::Foo()
{
    return this->SomeValue;
} 
```

您清楚地知道 SomeValue 是同一类的非静态成员变量。

因此，它不仅可以帮助您确保函数或变量的名称不会与其他名称冲突，而且还可以让其他人更容易阅读和理解源代码，有时编写自文档源代码也很重要。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-07-13T06:42:31.503

另一种情况，在 C++11 之后出现在 lambdas 中`this`。

你可能有类似的东西：

```
class Example
{
  int x;
public:
  std::function<void()> getIncrementor()
  {
    return [this] () -> void
    {
      ++(this->x);
    }
  }
}; 
```

尽管您的 lambda 是在一个类中生成的，但它只能通过捕获局部变量（如果您的编译器使用 C++14）或捕获`this`. 在第二种情况下，在 lambda 的主体内，根本没有`x`，而只有`this->x`。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-23T11:06:58.227

我不认为它对编译器有影响，但我总是写 this-> 因为我相信它使代码自我记录。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-23T11:07:27.930

消歧：如果您在同一个命名空间中有另一个类似的命名函数/变量？我从未见过出于任何其他原因的使用情况。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-23T11:08:40.673

我也更喜欢没有明确的 this 指针。对于方法调用，它不会增加很多价值，但它有助于区分局部变量和成员变量。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-23T11:16:30.593

我不太记得确切的情况，但我见过（非常罕见的）我必须编写“this->membername”才能使用 GCC 成功编译代码的情况。我只记得它与歧义无关，因此我花了一段时间才找出解决方案。在 Visual Studio 中不使用 this-> 的情况下，相同的代码编译得很好。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-12-02T11:42:00.593

我将使用它来隐式调用运算符（下面的返回和参数类型只是组成代码的假人）。

```
struct F {
  void operator[](int); 
  void operator()();

  void f() {
    (*this)[n];
    (*this)();
  }

  void g() {
    operator[](n);
    operator()();
  }
}; 
```

我更喜欢`*this`语法。它的语义略有不同，因为 using`*this`不会隐藏与成员同名的非成员运算符函数。

# c# - 什么是腹胀控制

> ID：577248
> 
> 赞同：-1
> 
> 时间：2009-02-23T11:06:56.247
> 
> 标签：c#

什么是腹胀控制？谁能解释一下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T11:09:58.080

这是一个可用于描述各种事物的术语，例如，它通常被 ASP.NET WebForms 的批评者使用，如果您大量使用预构建的 WebControls，您几乎无法控制生成的 HTML，其中很多情况下出现“臃肿”（大）和“不干净”、“凌乱”等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T11:18:37.763

我不确定“腹胀”是否正是您的意思。一些控件可能被称为“臃肿”。

在这种情况下，这意味着某些控件提供了大量在大多数情况下不需要的功能。网格控件往往相当臃肿，因为它们公开了排序、过滤、绑定、模板等功能。但是您不太可能在网格的单个实现中使用所有这些功能，因此您占用的内存比您实际上需要这可能会导致性能问题。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T11:10:18.890

我猜人们指的是一些 GUI 控件非常大，因此有点难以理解/使用的事实。

# wpf - WPF 布局面板内绝对居中的内容

> ID：577254
> 
> 赞同：6
> 
> 时间：2009-02-23T11:07:38.040
> 
> 标签：wpf, layout, alignment

我需要找到一种在 WPF 中将 LayoutPanel 的内容绝对居中的方法。我有两个文本块元素，它们必须在面板的垂直和水平中心呈现，而不依赖于绝对高度和宽度。

这是我可以用单个元素轻松完成的事情，因为任何 ContentControl 都可以设置它的 verticalContentAlignment 属性，但是你只有一个子元素可以玩，我又回到了原点。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-23T11:14:11.283

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid VerticalAlignment="Center">
        <StackPanel HorizontalAlignment="Center">
            <TextBlock>First</TextBlock>
            <TextBlock>and the second</TextBlock>
        </StackPanel>
    </Grid>
</Window> 
```

您还可以编写自己的`Panel`子类来自动执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T11:09:06.740

按照我的要求修好了！

我需要做的是在 ContentControl 中放置一个 StackPanel 并将 StackPanels VerticalAlignment 设置为 Center。现在看起来很明显！

# tree - CRUD 脚手架和树木

> ID：577259
> 
> 赞同：0
> 
> 时间：2009-02-23T11:08:10.627
> 
> 标签：tree, crud

每次阅读 MVC Web 框架的介绍时，您都会遇到同样的事情：只需描述您的数据类和中提琴 - 您将获得自动生成的管理界面。甚至微软也终于发布了它的动态数据。

总的来说，这很棒。几年来我一直在制作（简单的）网站，而 CRUD 是客户最想要的。

但是，有时用户的故事包含“任意深度的嵌套生产类别”或类似的要求。在这种情况下，我将 parent_id 属性添加到数据类中，并可以过滤掉某个父项的数据项。

是否有开箱即用支持 Key-ParentKey 关系的 CRUD 接口示例？对此你们怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T11:11:36.127

CRUD 永远不会开箱即用地支持您需要的一切。你所能期望的最好的就是它会让你走到一半，从那时起你就靠自己了。

我正在处理一个项目，虽然 CRUD 将完成大部分魔法，但我必须编写自己的代码来处理其他方面，因为它们不是自动处理的。

基本上，您想要的是可以帮助您开发新应用程序的东西，但同时也会让您做自己必须做的事情。

# c++ - 在 C++ 中创建新异常

> ID：577270
> 
> 赞同：9
> 
> 时间：2009-02-23T11:09:29.860
> 
> 标签：c++, linux, exception, ubuntu

我有一个 C++ 类，我正在尝试在 Ubuntu 中运行它：

```
#ifndef WRONGPARAMETEREXCEPTION_H_
#define WRONGPARAMETEREXCEPTION_H_

#include <iostream>
#include <exception>
#include <string>

using namespace std;

#pragma once

class WrongParameterException: public exception
{
    public:
        WrongParameterException(char* message): exception(message) {};
        virtual ~WrongParameterException() throw() {};
}; 

#endif 
```

当我尝试编译它时，编译器给了我这个错误：

```
WrongParameterException.h: In constructor ‘WrongParameterException::WrongParameterException(char*)’:
WrongParameterException.h:14: error: no matching function for call to ‘std::exception::exception(char*&)’
/usr/include/c++/4.3/exception:59: note: candidates are: std::exception::exception()
/usr/include/c++/4.3/exception:57: note: std::exception::exception(const std::exception&) 
```

谁能告诉我我做错了什么？我尝试将消息变量更改为`string`或`const string`，`const string&`但没有帮助。

以下是我如何使用从 main 创建的新异常：

```
try
{
     if ((strToInt1 == -1) || (parameters[1] == NULL) || (strToInt3 == -1) || (parameters[3] != NULL))
     {
          throw WrongParameterException("Error in the config or commands file");
     }
}
catch(WrongParameterException e)
{
     log.addMsg(e.what());
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-23T11:29:09.283

首先，`#pragma once`是错误的做法，了解标头包含守卫。[SO上的相关问题](https://stackoverflow.com/a/34884735/13986)解释了为什么使用`#pragma once`是错误的方法。Wikipedia 解释了如何使用[include 守卫](https://en.wikipedia.org/wiki/Include_guard)，这些守卫具有相同的目的而没有任何缺点。

其次，您使用它不知道的参数调用 std::exception 的构造函数，在本例中是指向字符数组的指针。

```
#include <stdexcept>
#include <string>

class WrongParameterException : public std::runtime_error {
public:
    WrongParameterException(const std::string& message) 
        : std::runtime_error(message) { };
}; 
```

可能是你想要的。有关异常的更多信息，请查看有关异常的[C++ FAQ Lite 文章](http://www.parashift.com/c++-faq-lite/exceptions.html "例外")和 cplusplus.com 上的[异常文章](http://www.cplusplus.com/doc/tutorial/exceptions.html)。

祝你好运！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-23T11:14:49.690

std::exception 没有接受任何类型字符串的构造函数，只有一个返回异常描述的虚拟 what() 方法。

您必须自己存储字符串并从那里返回。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-23T11:41:38.393

我的建议是：

1.  继承自`std::runtime_error`。正如上面 X-Istence 所建议的那样。它在概念上是一个运行时错误，并且`std::runtime_error`构造函数也接受一个`std::string`作为参数来描述发生了什么。
2.  关于您发现异常。我会使用`catch(WrongParameterException const& e)` （注意 const 引用）而不是`catch(WrongParameterException e)`，因为首先，在您的情况下，异常通常是常量，而且，使用该引用，您可以捕获 的任何子类，`WrongParameterException`以防您的代码随着一些更精细的异常处理而演变。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-23T11:16:36.520

std::exception 的构造函数不接受字符串参数。你试图给它一个，这就是导致编译错误的原因。

您需要存储您的字符串，最好将其作为 std::string 而不是原始指针处理，然后从`what()`方法中返回它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T11:17:13.023

查看MS VS2K5中异常类的声明，你想要的构造函数是：

```
exception (const char *const&); 
```

所以尝试将您的构造函数更改为：

```
WrongParameterException (const char *const message) 
```

看看是否有帮助。否则，将指针存储在您自己的类中并实现所有相关方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T11:18:51.820

一个简单的解决方案是以不同的方式设计您的异常。这是一个简单的例子：

```
class MyException : public Exception
{
public:
   MyException(CString strError) { m_strError = strError; }

   CString m_strError;
}; 
```

然后，您可以随意使用您的异常消息。这是因为 Exception 没有除 String 之外的构造函数，因此您必须自己创建它。

# database-design - 为什么LDAP不流行？

> ID：577274
> 
> 赞同：6
> 
> 时间：2009-02-23T11:10:24.117
> 
> 标签：database-design, ldap, popularity, hierarchical

我们开始使用 LDAP，我想知道为什么 LDAP 不那么流行？我读到它的读取速度比数据库快，但写入速度较慢。

编辑：

这是我第一次使用 LDAP，并且我已经在企业中编程了一段时间。这就是为什么我认为它不受欢迎的原因，而且我在学校从来没有听说过它。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-23T12:56:44.173

我认为 OP 指的是使用 LDAP 类型的数据（阅读：分层数据库）作为应用程序数据的存储机制。
虽然很明显大多数网络登录都基于 LDAP，但确实绝大多数业务系统都基于关系数据模型，而很少有基于分层数据模型的。

假设这是这里的真正问题:)，我将提供一些部分答案，它们可能会完全回答您的问题：

*   复杂性和高门槛（正如[@Elijah](https://stackoverflow.com/questions/577274/why-ldap-is-not-popular/577355#577355)提到的）
*   正如您所提到的，它通常不在学校教授 - 因此很多人并不熟悉，因此不常用（这是递归，还是自我实现的预言？）
*   分层数据模型在设计上经过优化以*查找*特定数据，并且写入或更新新数据的成本非常高。大多数常见的业务应用程序都是基于 OLTP（事务）的，并且需要大量的写入（BI 类型的应用程序除外，稍后将涉及）。
*   更具体地说，构建分层模型是为了查找数据的**特定元素**，而不是执行 JOIN、大规模 SELECT、GROUP BY 等（我的意思是在逻辑 PoV 中，无论特定上下文如何）。
*   大多数数据都是**关系**的，或者最容易拟合关系模型。特别是对于 BI，您希望查看大量数据、执行比较等。
*   即使对于*不*相关的数据，我们的大脑似乎也被训练成比分层更容易思考“关系模型”（尽管这可能是我的第二点的结果——我们大多被教导这一点）。将数据分类为整齐的行和列只是“更容易”......

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-23T11:17:56.487

您如何得出 LDAP 不流行的结论？在我工作的每一家大公司中，他们都使用 LDAP 作为访问用户信息中央存储库的一种方式。

与数据库的比较有点奇怪。LDAP 是一个协议，而数据库是一个涵盖一大堆产品的术语。说 LDAP 比数据库快/慢就像说 HTTP 比网络服务器快/慢，特别是因为我希望在每个 LDAP 存储库后面找到某种数据库（甚至可能是关系数据库）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-23T11:45:02.053

LDAP 非常流行——它是 Windows Active Directory 使用的协议，它（这里是轻描淡写）相当普遍。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-23T11:20:38.587

LDAP 很棒，它是单点登录和内部工具的绝佳工具。

不确定比数据库更快的读取是什么意思，它通常从服务器运行，并且通过网络处理身份验证。

它在设计上是一个少写多读系统，但它确实为您提供的不仅仅是数据库中的一个简单的用户表，它为您处理身份验证，因此您可以将其插入您需要的任何系统。

在工作中，我们将它用于 ssh、NFS、Intranet 访问、内部工具等等。如果您使用数据库，则需要在许多不同的系统之间复制身份验证代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T11:37:13.443

我认为你说它不受欢迎有点离谱。如果它不受欢迎，您可能不会问这个问题。但是，我确实认为它的符号和使用有点复杂，并且为相对简单的任务创造了高门槛，这可能会影响其采用率。

# c# - WPF 图表控件

> ID：577278
> 
> 赞同：195
> 
> 时间：2009-02-23T11:12:02.600
> 
> 标签：c#, wpf, charts

我正在寻找一个非常简单的 WPF 图表，它应该有一个 2D 图形并且应该有平移和缩放功能。

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2010-11-19T16:59:49.283

支持平移/缩放的免费工具：

*   [实时图表](https://github.com/beto-rodriguez/Live-Charts)
*   [斯科特图](https://github.com/swharden/ScottPlot)
*   [DynamicDataDisplay](https://github.com/Microsoft/InteractiveDataDisplay.WPF) - 一个不错的开源数据可视化库。不幸的是，它自 2009 年 4 月 30 日以来没有更新。
*   [氧图](https://github.com/oxyplot/oxyplot/)

没有内置平移/缩放支持的免费工具：

*   [WPF 工具包](http://wpf.codeplex.com/releases/view/40535)。支持最重要的 2D 图表，您必须自己实现平移/缩放。
*   [WPF 工具包开发版本](http://blogs.msdn.com/b/delay/archive/2010/04/20/phone-y-charts-silverlight-wpf-data-visualization-development-release-4-and-windows-phone-7-charting-sample.aspx)。支持堆叠图表，相当于 Silverlight 版本。

具有内置平移/缩放支持的付费工具：

*   [Visiblox](http://www.visiblox.com/)图表（已停产）。支持最重要的 2D 图表，带有缩放和平移功能。免费版带有水印。（请参阅这篇关于使用缩放/平移[的博客文章）](http://www.visiblox.com/blog/2010/11/zooming-panning-in-silverlight-using-visiblox-charts)
*   [科学图表 WPF](https://scichart.com/wpf-chart-features)。支持 DirectX 加速 2D 和 3D 图表，带有缩放和平移、鼠标滚轮和缩放动画。（请参阅这篇关于在多个图表中使用缩放/平移的[博客文章）](https://www.scichart.com/documentation/v5.x/Synchronizing%20Multiple%20Charts.html)
*   [基础设施 xamDataChart](http://www.infragistics.com/dotnet/netadvantage/wpf/data-visualization/xam-data-chart.aspx#Overview)。支持最重要的 2D 图表、缩放和平移。请参阅[这篇](http://forums.infragistics.com/blogs/kiril_matev/archive/2010/04/20/a-fast-wpf-chart-featuring-zooming-panning-in-winforms.aspx)关于如何使用缩放的博客文章。
*   [Telerik RadChart](http://www.telerik.com/products/wpf/chart.aspx?gclid=CMOpoaHD8pgCFQqF3goddzFT1w)。支持大量 2D 图表，支持缩放和平移，你可能需要做一些工作。
*   [可视化](http://visifire.com/)。支持大量 2D 图表和无动画缩放，可能需要做一些额外的工作才能更平滑地缩放。（此服务不再可用）
*   [DevExpress 图表控件](https://www.devexpress.com/Products/NET/Controls/WPF/Charting/)。支持最常见的[2D 系列类型](https://documentation.devexpress.com/WPF/114223/Controls-and-Libraries/Charts-Suite/Chart-Control/Fundamentals/Series-Fundamentals/2D-Series-Types)，可以使用鼠标、键盘和触摸手势执行[缩放和平移（滚动）操作。](https://documentation.devexpress.com/WPF/11234/Controls-and-Libraries/Charts-Suite/Chart-Control/End-User-Features/End-User-Capabilities/Zooming-and-Scrolling-2D-XY-Charts)
*   [Syncfusion SfChart](https://www.syncfusion.com/products/wpf/sfchart)。支持多种[2D 系列类型](https://help.syncfusion.com/wpf/sfchart/series)，并提供支持触摸模式的[交互式缩放](https://help.syncfusion.com/wpf/sfchart/interactive-features#zoom-and-pan)功能。支持各种缩放类型（鼠标滚轮、捏合、选择）。

***完全披露：***我一直积极参与 Visiblox 的开发，因此我比其他人更详细地了解该库。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2012-05-14T08:53:41.773

另一个是[OxyPlot](http://oxyplot.codeplex.com)，它是一个开源的跨平台（WPF、Silverlight、WinForms、Mono）.Net 绘图库。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-02-23T11:59:25.480

[DynamicDataDisplay](http://www.codeplex.com/dynamicdatadisplay)非常出色，内置缩放和平移功能，并且在 CodePlex 上免费。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-23T11:15:01.407

您可以[在 WPF 上运行](http://blogs.msdn.com/llobo/archive/2008/11/18/silverlight-chart-control-running-in-wpf.aspx)Silverlight 图表控件，它们非常好（而且免费）。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-08-28T17:30:32.983

WPF 工具包可用。它是免费的 CodePlex。

可以在[这里](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=29117)下载。[这里](http://blogs.msdn.com/delay/archive/2009/06/25/wpf-charting-it-s-official-june-2009-release-of-the-wpf-toolkit-is-now-available.aspx)有一些评论。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-05-09T06:51:45.600

Sparrow Chart Toolkit 多平台最佳开源图表控件
-WPF
-Silverlight -WinRT -Windows phone
-Windows Forms -Mono

[https://sparrowtoolkit.codeplex.com/](https://sparrowtoolkit.codeplex.com/)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-06-06T09:46:55.437

WPF Toolkit 中的图表控件有一个可怕的错误：它永远不会忘记任何数据点。因此，如果您尝试实现浮动图表，您将在大约 3000 个 DataPoint 对象后耗尽内存。一年多前已向 MS 报告了此错误，但似乎没有人关心...

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-08-03T07:47:39.517

[Visifire](http://www.visifire.com/wpf_charts.php/)支持各种具有缩放和平移功能的 2D 和 3D 图表。

![带缩放功能的 Visifire 折线图](https://i.stack.imgur.com/MwIt6.png)

完全披露：我参与了 Visifire 的开发。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-23T11:22:28.533

[代码项目文章在这里](http://www.codeproject.com/KB/vista/swordfishcharts.aspx)。

商业产品：

1.  [软件FX](http://www.softwarefx.com/sfxNetProducts/ChartFX/WPF/)
2.  [泰勒里克](http://www.telerik.com/products/wpf/chart.aspx?gclid=CMOpoaHD8pgCFQqF3goddzFT1w)

我确定还有其他人

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-01-19T07:00:54.287

DevExpress 也有图表（参见[DevExpress.Com](http://devexpress.com/)）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-23T12:10:05.393

[aM Charts](http://wpf.amcharts.com/demo)也在制作 WPF 图表控件。目前他们只展示一个饼图，但他们将在短期内提供新的。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-02-21T22:12:56.320

试试 TechNewLogic 的 GraphIT，您可以在 CodePlex 上找到它：http: [//graphit.codeplex.com](http://graphit.codeplex.com)

**完全披露：**我是 GraphIT 的开发者和开发公司的所有者。

# java - 类加载器

> ID：577280
> 
> 赞同：0
> 
> 时间：2009-02-23T11:12:45.687
> 
> 标签：java

我遇到了类加载器的问题。每时每刻。

有时它起作用，有时它不起作用。

当我开始时，我已经测试过这个作品，但不是来自 *.jar：

URL url = AcAnalyzer.class.getResource("../stuff/resource");

//这甚至可以从jar文件中工作：

URL url = Acnalyzer.class.getResource("/stuff/resource");

URL url = AcAnalyzer.class.getClassLoader().getResource("stuff/resource");

//但是我遇到了tomcat的问题..当我需要将它部署到tomcat中时，我必须这样做：

URL url = Thread.currentThread().getContextClassLoader().getResource("something.xml");

something.xml 必须在 WEB-INF/classes/ 中

... url.getFile();

//问题是大部分时间它必须同时在jar内而不是在jar内工作。现在我已经测试了我的类在哪里获取资源，并且 jar 文件用于部署在 tomcat 下的一些项目中。不知何故它不想再工作了：

我对类加载器有点困惑 :) .. 如何获取此资源？并同时进行工作测试。

URL url = Thread.currentThread().getContextClassLoader().getResource("com/st/resource");

```
 FileInputStream inputStream = new FileInputStream(url.getFile()); 
```

java.io.FileNotFoundException: file:/home/aaa/.m2/repository/com/st/module-1.1-SNAPSHOT.jar!/com/st/resource （没有这样的文件或目录）

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T11:17:38.607

我不确定第一部分的确切问题是什么，尽管我建议不要在资源路径中使用“../”。

对于第二部分，如果你想加载一个资源，你不应该使用 FileInputStream - 你应该使用`getResourceAsStream()`而不是`getResource().getFile()`. 只需从中加载`InputStream`- 不会总是有一个单独的文件*可以*加载`FileInputStream`。

编辑：引用资源的两种方式是`ClassLoader.getResource`和（以及带有后缀`Class.getResource`的等价物）。`AsStream`它们之间的区别（我知道的唯一区别，尽管可能还有其他区别）是`Class.getResource`将给定路径视为相对于您调用它的类的包。所以

```
ClassLoader.getResource("foo/bar/baz/test.xml") 
```

相当于

```
foo.bar.SomeClass.class.getResource("baz/test.xml"); 
```

至于和之间的区别`Class.getClassLoader()`， `Thread.getContextClassLoader()`我不会声称有很好的理解-我建议您将其作为一个单独的问题提出。

# datetime - vb.net 中的日期时间选择器

> ID：577282
> 
> 赞同：0
> 
> 时间：2009-02-23T11:14:06.027
> 
> 标签：datetime

我正在使用以下语句：dim d as date d=format(datetimepicker1.value.date,"dd/MM/yyyy") 但是在执行应用程序时，返回以下错误：不是有效月份.. 为什么会这样所以？？请帮忙..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T11:24:51.337

值本身是 DateTime 对象，因此不需要格式化。从日期时间开始，选择日期 ->
d = datetimepicker1.value.date

# sql - 创建包含查找表的视图时出现问题

> ID：577296
> 
> 赞同：0
> 
> 时间：2009-02-23T11:17:11.823
> 
> 标签：sql, database, view

应该很简单，但它给我带来了几个问题。

我有一个类似于以下的数据集：

```
User
  UserID
  Name
  Age

UserPropertyValues
  UserID
  PropertyCodeValueID

PropertyCodes
  PropertyCodeID
  PropertyCodeName

PropertyCodeValues
  PropertyCodeValueID
  PropertyCodeID
  PropertValue 
```

现在让我们假设这些表包含以下数据：

```
1  John  25
2  Sarah  34

1  2
1  3
2  1
2  3

1  FavColour
2  CarMake
3  PhoneType

1  1  Blue
2  1  Yellow
3  2  Ford
4  3  Mobile
5  3  Landline 
```

现在，我希望创建一个视图来返回用户详细信息，以及属性代码 1 和 2 的属性值，如下所示：

```
John 25 Yellow Ford
Sarah 34 Blue Ford 
```

到目前为止，我尝试过的查询往往会返回重复的数据行：

```
John 25 Yellow
John 25 Ford
Sarah 34 Blue
Sarah 34 Ford 
```

任何帮助表示赞赏，在此先感谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T12:11:26.967

输入数据：

```
DECLARE @User TABLE (UserID INT, Name VARCHAR(10), Age INT)
INSERT INTO @User
SELECT 1,  'John',  25 UNION
SELECT 2,  'Sarah',  34
DECLARE @UserPropertyValues TABLE(UserID INT, PropertyCodeValueID INT)
INSERT INTO @UserPropertyValues
SELECT 1, 2 UNION
SELECT 1, 3 UNION
SELECT 2, 1 UNION
SELECT 2,  3
DECLARE @PropertyCodes 
  TABLE (PropertyCodeID INT, PropertyCodeName VARCHAR(10))
INSERT INTO @PropertyCodes
SELECT 1,  'FavColour' UNION
SELECT 2,  'CarMake' UNION
SELECT 3,  'PhoneType'
DECLARE @PropertyCodeValues TABLE (PropertyCodeValueID INT, 
  PropertyCodeID INT, PropertValue VARCHAR(10))
INSERT INTO @PropertyCodeValues
SELECT 1,  1,  'Blue' UNION
SELECT 2,  1,  'Yellow' UNION
SELECT 3,  2,  'Ford' UNION
SELECT 4,  3,  'Mobile' UNION
SELECT 5,  3,  'Landline' 
```

如果结果中只需要两个属性，并且每个用户都有这些属性，那么试试这个：

```
SELECT U.Name, U.Age, PCVFC.PropertValue, PCVCM.PropertValue 
FROM @User U
INNER JOIN @UserPropertyValues UPVFC ON U.UserID = UPVFC.UserID 
INNER JOIN @PropertyCodeValues PCVFC 
  ON UPVFC.PropertyCodeValueID = PCVFC.PropertyCodeValueID 
    AND PCVFC.PropertyCodeID = 1
INNER JOIN @UserPropertyValues UPVCM ON U.UserID = UPVCM.UserID 
INNER JOIN @PropertyCodeValues PCVCM 
  ON UPVCM.PropertyCodeValueID = PCVCM.PropertyCodeValueID 
    AND PCVCM.PropertyCodeID = 2 
```

**[编辑]** 但要处理可能的 NULL 值更好地使用这个：

```
SELECT U.Name, U.Age, FC.PropertValue, CM.PropertValue 
FROM @User U
LEFT JOIN (
  SELECT UserID, PropertValue FROM @UserPropertyValues  UPV
    INNER JOIN @PropertyCodeValues PCV 
      ON UPV.PropertyCodeValueID = PCV.PropertyCodeValueID 
        AND PCV.PropertyCodeID = 1
) FC ON U.UserID = FC.UserID
LEFT JOIN (
  SELECT UserID, PropertValue FROM @UserPropertyValues  UPV
    INNER JOIN @PropertyCodeValues PCV 
      ON UPV.PropertyCodeValueID = PCV.PropertyCodeValueID 
        AND PCV.PropertyCodeID = 2
) CM ON U.UserID = CM.UserID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T18:21:19.527

您真正需要的是尽快放弃这种类型的数据库设计。它永远不会是有效的。要获得三种类型的值，您必须加入表三次。一旦您拥有 30 或 40 种不同类型的信息，您将需要多次加入该表（并在那时留下联接）。此外，每当您需要任何信息时，您都需要加入此表。我认为这是在您的数据库中创建了一个主要的锁定问题。最初设计与我合作的其中一个数据库的人就是这样做的，当公司从一两个客户发展到我们行业中最大的客户时，它造成了巨大的性能问题。

如果属性是每个人可能只有一个 realted 记录的属性，请将它们放入 user 表中。如果他们有多个记录，那么为每种类型的信息创建一个单独的表（一个用于 hones，一个用于电子邮件，一个用于 cartype，等等）因为您最终想要收集的信息通常不仅仅是简单的值和每种类型的信息都不同，它们必须在单独的表中。然后，当您只需要查看一个值（例如电话号码而不是电子邮件）时，您就加入了该表，并且您不会干扰尝试访问电子邮件而不是电话号码的人。如果您有一辆黄色福特或白色本田，它将仅存储在汽车表中的一条记录中，而不是您设计中的两条属性记录中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T13:49:10.740

```
SELECT 
  u.[Name],
  u.Age,
  pcv1.PropertValue,
  pcv2.PropertValue
FROM 
  Users  u
  LEFT JOIN 
  ( UserPropertyValues upv1 
    JOIN PropertyCodeValues pcv1 ON 
    upv1.PropertyCodeValueID = pcv1.PropertyCodeValueID 
    AND pcv1.PropertyCodeID = 1
  )
  ON upv1.UserID = u.UserID
  LEFT JOIN (
    UserPropertyValues upv2 
    JOIN PropertyCodeValues pcv2 ON 
    upv2.PropertyCodeValueID = pcv2.PropertyCodeValueID 
    AND pcv2.PropertyCodeID = 2
  )
  ON upv2.UserID = u.UserID 
```

编辑：我将用户重命名为用户

Edit2：允许为空（未输入的值）

# c# - 如何修复 WPF 错误：“程序不包含适合入口点的静态 'Main' 方法”？

> ID：577298
> 
> 赞同：176
> 
> 时间：2009-02-23T11:17:16.487
> 
> 标签：c#, wpf

突然我的整个项目完全停止编译，显示以下消息：

> 程序 'path_to_obj_project_folder' 不包含适用于入口点的静态 'Main' 方法

我没有对项目属性进行任何更改，只是添加了一些类，将其他一些类移动到文件夹中。它是一个 WPF 应用程序项目，所以应该没问题。入口点是它应该在的地方，文件 App.xaml 根本没有被修改:(

我应该怎么做才能让它再次工作？

**注意**
*供参考*：如果重命名`App.xaml`可能会发生这种情况。正如OP所说，`App.xaml`没有改变；但是，这是为任何重命名`App.xaml`.

* * *

## 回答 #1

> 赞同：460
> 
> 时间：2009-02-23T11:22:59.187

检查*App.xaml*的属性。是`Build Action`静止的`ApplicationDefinition`吗？

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2010-12-01T08:31:45.390

也许项目的属性->应用程序中的“输出类型”必须是“类库”而不是控制台或Windows应用程序。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-08-23T16:09:05.277

以防万一有人遇到同样的问题......我收到了这个错误，结果是我`<Application.Resources>`在我的 App.xaml 文件中。我在资源字典标签之外有一个资源，这导致了这个错误。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-07-31T09:32:03.543

就我而言（在手动重命名应用程序命名空间之后），我必须在项目属性中重新选择 Startup 对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-21T20:17:02.327

如果您正在处理一个在 VS 2010（Beta 1）中启动，然后移至 VS 2008 的 WPF 项目，您也可能会遇到这种情况。

在项目属性下，.NET 框架版本未设置（因为 .NET 4.0 在 VS 2008 中无效），并且由于某种原因导致此错误。

如果您设置 .NET 框架（例如设置为 .NET 3.5），错误就会消失。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-05T13:06:59.877

以防万一有人仍然遇到同样的错误，即使有上述所有帮助：我遇到了这个问题，我尝试了这里给出的所有解决方案，我刚刚发现我的问题实际上是我的错误列表中的另一个错误（这是关于丢失的图像设置为我的初始屏幕。我只是将其路径更改为正确的路径，然后一切都开始工作）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-13T19:36:22.803

我遇到了同样的错误，但后来我发现我在 Main 方法中输入了小 m 而不是大写 M

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-07T10:56:03.233

项目属性\输出文件->选择类库:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-20T17:23:22.903

至于什么，我猜 pixparker 想说，但仍然不够清楚，至少对我来说，确保......**所有“其他项目”**都选择了**“类库”的****“输出类型”** ...... **只有“一个项目”**被选为**“窗口应用程序”**或**“控制台应用程序”**输出。

 ******* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-30T17:06:37.440

在处理 WPF/UPF 应用程序以及在项目的**.csproj**中使用错误的 SDK 即`<Project Sdk="Microsoft.NET.Sdk">`而不是`<Project Sdk="Microsoft.NET.Sdk.WindowsDesktop">`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-05T16:19:18.540

我在将 .net framework v4.7.2 更改为 .net core 3.1 时遇到了这个问题，并通过添加解决了

```
<PropertyGroup>
    <UseWPF>true</UseWPF>   
</PropertyGroup> 
```

在`.csproj`

# python - gtk TextView 小部件在功能期间不更新

> ID：577302
> 
> 赞同：0
> 
> 时间：2009-02-23T11:18:37.560
> 
> 标签：python, gtk, pygtk

我是使用 python 和 gtk 进行 GUI 编程的新手，所以这是一个初学者的问题。我有一个在按下按钮时调用的函数，它执行各种任务，还有一个 TextView 小部件，我在每个任务完成后写入。问题是 TextView 小部件在整个函数完成之前不会更新。我需要它在每项任务后更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T12:17:22.567

每次更新 TextView 调用后

```
while gtk.events_pending():
  gtk.main_iteration() 
```

您可以通过自定义函数进行更新：

```
def my_insert(self, widget, report, text):

  report.insert_at_cursor(text)
  while gtk.events_pending():
    gtk.main_iteration() 
```

来自 PyGTK 常见问题解答： [如何在长时间回调或其他内部操作期间强制更新应用程序窗口？](http://faq.pygtk.org/index.py?req=show&file=faq03.007.htp)

# sql-server - 可以使 SQL Server 2000 填充全文目录而不阻塞它正在读取的表吗？

> ID：577306
> 
> 赞同：0
> 
> 时间：2009-02-23T11:19:21.943
> 
> 标签：sql-server, blocking, full-text-search

我在 SQL Server 2000 上有一个数据库服务器（是的，我知道...），它的一些表上有全文目录。我目前在安静的时间过夜，我希望能够在白天更新目录，以便在搜索中考虑新数据。

我注意到的问题是，当增量填充运行时，会出现大量阻塞，这是由填充过程引起的。该数据库上的其他事务正在使用“未提交读”或脏读，以最大限度地减少延迟（我并不特别关心最新的准确数据），所以我不确定为什么人口，本身只是读取数据，阻止它们。

任何线索，提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T13:35:26.827

简短的故事：不，直到最近更新 SQL Server 2008，情况才好得多。2008 的 RTM 版本也有同样的问题，正如我们在此处记录的：

[http://www.brentozar.com/archive/2008/11/stackoverflows-sql-2008-fts-issue-solved/](http://www.brentozar.com/archive/2008/11/stackoverflows-sql-2008-fts-issue-solved/)

解决方法是使用对您的预算和工作负载有意义的最快存储子系统。全文目录需要位于与您的数据和日志不同的数组中，这样它们可以更快地完成填充。

您还提到您对阅读导致锁定感到惊讶。我们在 SQLServerPedia 上有文章解释了 SQL Server 的锁定过程，例如：

[http://sqlserverpedia.com/wiki/SQL_Server_Locking_Mechanism](http://sqlserverpedia.com/wiki/SQL_Server_Locking_Mechanism)

如果您想要更具体的答案，请在人群中观察您的服务器。运行 sp_who2，查看哪些查询被阻止，然后运行 ​​DBCC INPUTBUFFER(spid) 命令来找出它们的 T-SQL 是什么。这样你就可以准确地看到是什么类型的查询导致了它。如果您确定它正在使用未提交的读取，请上传您的查询执行计划的副本，我们可以帮助解释它以了解发生了什么。

# crystal-reports - 水晶报错

> ID：577307
> 
> 赞同：0
> 
> 时间：2009-02-23T11:19:28.883
> 
> 标签：crystal-reports

我正在开发一个 win 应用程序（在 .net 2005 中），我必须在其中使用水晶报告。但现在它生成了水晶查询引擎。然后我必须重新安装.net。有什么解决方法吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:04:21.290

这取决于您使用的 Crystal Reports 版本，但您可以使用 regsvr32 确保 crqe.dll 在您的计算机上正确注册。此外，如果您曾经在此计算机上安装过以前版本的 Crystal Reports，则问题也可能源于 DLL 版本冲突。

# c# - 我只想匹配正则表达式中的开始标签

> ID：577313
> 
> 赞同：-1
> 
> 时间：2009-02-23T11:21:20.470
> 
> 标签：c#, .net, html, regex, tags

我正在制作一个正则表达式，我只想匹配错误的标签，例如

`<p> *some text here, some other tags may be here as well but no ending 'p' tag* </p>`

```
 <P>Affectionately Inscribed </P><P>TO </P><P>HENRY BULLAR, </P><P>(of the western circuit)<P>PREFACE</P> 
```

就像在上面相同的文本中一样，我想得到结果， `<P>(of the western circuit)<P>`并且不应该捕获任何其他内容。我正在使用它，但它不起作用

```
<P>[^\(</P>\)]*<P> 
```

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-10-27T05:24:11.743

这是一个符合您需要的表达式：

```
[<]{1}\s*[pP]{1}\s*[>]{1}[()a-zA-Z0-9 ]+[<]{1}\s*[pP]{1}\s*[>]{1} 
```

您可以添加所有需要的字符 [()a-zA-Z0-9 ]。

# javascript - 图像超链接

> ID：577314
> 
> 赞同：1
> 
> 时间：2009-02-23T11:21:30.767
> 
> 标签：javascript, image, dom, hyperlink

我正在使用 JavaScript 来指定目标链接。它无法正常工作。我应该做哪些更改才能使其正常工作？

我的代码：

```
var link = create_element(cell, 'img');
link.setAttribute("src", "images/sub.png"); 
link.href = "http://localhost/"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T11:41:52.653

正如谢尔盖所​​说，你需要一个链接，里面有一张图片。以下是您的代码的扩展。虽然它完全未经测试，但根据您已经拥有的内容，您可以大致了解如何实现它。

```
var link = create_element(cell, 'a');
link.href = "http://localhost/";
var image = create_element(link, 'img');
image.setAttribute("src", "images/sub.png"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T12:03:31.913

您不能将 href 用于 img 标签。添加点击处理程序怎么样？

```
link.onclick = function(){top.location.replace("http://localhost");}; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T11:25:35.657

IMG 标签没有 href 属性。“A”标签有它。所以你应该用所需的 HREF 创建 A，然后在里面创建 IMG。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T12:28:13.383

对，就是这样。我们也可以这样写：

```
link.onclick = function() { document.location.href = "http://localhost"; }; 
```

# iphone - 在 iphone 上重新格式化一个简单的 html 页面

> ID：577315
> 
> 赞同：4
> 
> 时间：2009-02-23T11:22:15.523
> 
> 标签：iphone, html, webpage

我有一个名为 today.html 的 html，我在我的 iphone 上使用它，我必须放大以查看我的任务如何正确格式化它，以便它在 iphone 上的屏幕周围扭曲，并且文本大小合适

这是我的代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Tasks for today</title>
    <meta name="generator" content="TextMate http://macromates.com/">
    <meta name="author" content="sebastian stephenson">
<style type="text/css" media="screen">
    body {
        border: medium dashed #7979ff;
        background-color: #fff;
        margin: 0 auto;
    }

    body p{
        font: 2em "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;
        padding-left: 10px;
    }

    .todos {
        font: 1em"Lucida Grande", Lucida, Verdana, sans-serif;
        color: #7D1518;
        padding-left: 20px;
    }
    .todos p{
        font: 1em Arial;
    }
</style>
<!-- Date: 2008-08-24 -->
</head>

<body>
<p>a greeting</p>
<div class="todos">

<li>a task</li>

<li>a task with detail</li>
<p>detail</p>
<li>a task with muilple acitons</li>

<ul>

<li>an action</li>

<li>an action</li>

<li>an action</li>

<li>an action</li>

<li>an action</li>

<li>an action</li>

<li>an action</li>

</ul>

</div>
</body>
</html> 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T12:04:47.573

您是否尝试过将视口设置为适合 iphone 屏幕尺寸？

```
<meta name="viewport" content="width=320" /> 
```

在以下位置查看更多详细信息：[constrain-your-viewport-for-iphone-web-development](http://drinkingoatmealstout.com/2007/07/01/constrain-your-viewport-for-iphone-web-development/)
另请参阅[developer.apple.com](https://web.archive.org/web/20090701221013/http://developer.apple.com/webapps/designingcontent.php)了解有关 iPhone Web 开发的其他因素（例如调整文本大小以提高可读性）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T11:50:16.690

看看[这里](http://www.boutell.com/newfaq/creating/iphone.html)

引用：

> 如果您是 CSS 专家，您首先想到的是在您的 CSS 代码中使用“手持”媒体类型。例如，如果浏览器认为自己是手持设备，则此代码将隐藏属于导航 CSS 类的所有元素。如果您知道这些元素既方便又多余并且占用的空间比手持用户想要放弃的更多，那就很方便了：
> 
> ```
> @media handheld {
>     .navigation {
>        display: none;
>     }
> } 
> ```
> 
> 不幸的是，这不适用于 iPhone。为什么？因为 Apple 知道 iPhone 可以比大多数手持设备更好地显示页面。他们不希望 iPhone 以“低调”的方式显示所有网页。因此，iPhone 会查看“屏幕”媒体类型，就像您的桌面浏览器一样。
> 
> 有替代方案吗？是的！您可以指定一组 CSS 规则仅在屏幕小于某个分辨率时应用：
> 
> ```
> @media only screen and (max-device-width: 480px) {
>    .navigation {
>         display: none;
>    }
> } 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T11:59:24.640

尝试`font-size: 100%;`在 body 上设置，这样浏览器肯定会在应用您的尺寸之前从它的默认尺寸开始`em`。除此之外，尝试添加`-webkit-text-size-adjust: auto;`到您的页面。

本文深入探讨了移动 safari 开发的具体细节： [http ://www.evotech.net/blog/2007/07/web-development-for-the-iphone/](http://www.evotech.net/blog/2007/07/web-development-for-the-iphone/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T12:07:15.853

通过将 LI 放在 UL 中并去掉多余的 div，我已经稍微清理了你的 HTML。

您可以在任何块级元素上设置最大宽度，因此将其与@epatel 的媒体声明相结合，您可以获得以下内容。

玩弄宽度等等。我只是随机设置它们。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Tasks for today</title>
    <meta name="generator" content="TextMate http://macromates.com/">
    <meta name="author" content="sebastian stephenson">
<style type="text/css" media="screen">

    body {
        border: medium dashed #7979ff;
        background-color: #fff;
        margin: 0 auto;
    }

    body p{
        font: 2em "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;
        padding-left: 5px;
    }

    .todos {
        font: 1em"Lucida Grande", Lucida, Verdana, sans-serif;
        color: #7D1518;
        padding-left: 20px;
    }
    .todos p{
        font: 1em Arial;
    }
    ul {
        max-width:200px;
    }

    @media only screen and (max-device-width: 480px) {
        ul {
            max-width:480px;
        }
    }
    @media only screen and (max-device-width: 240px) {
        ul {
            max-width:240px;
        }
    }

</style>
<!-- Date: 2008-08-24 -->
</head>

<body>
<p>a greeting</p>

    <ul class="todos">
        <li>a task</li>

        <li>a task with detail
            <p>detail</p>
        </li>

        <li>a task with muilple acitons
            <ul>
                <li>an action</li>
                <li>an action</li>
                <li>an action</li>
                <li>an action</li>
                <li>an action</li>
                <li>an action</li>
                <li>an action</li>
            </ul>
        </li>

    </ul>

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-26T12:59:30.390

所选答案适用于 iphone，但对于测距设备的动态宽度，您可以在“ **head** ”标签中添加这段代码。
[参考](http://www.gyford.com/phil/writing/2010/07/06/web-page-iphone.php)

```
 <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"> 
```

# asp.net - ASP.Net TreeView 将所选节点滚动到视图中

> ID：577320
> 
> 赞同：2
> 
> 时间：2009-02-23T11:23:26.830
> 
> 标签：asp.net, treeview, scroll

有没有办法在回发后将 ASP.Net TreeView 的选定节点滚动到视图中？

在我的特殊情况下，每次回发后都会重新填充控件。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T12:42:56.920

我想到了。TreeView 控件在客户端上创建一个 javascript 对象。它被命名为附加了“_Data”的树视图。该对象使您可以获取对选定节点的引用。

下面的代码使用 ASP.Net Ajax 扩展。只要记住将 TreeView 名称更改为您的名称即可。

```
var name = myTreeView_Data.selectedNodeID.value;
var selectedNode = $get(name);

if(selectedNode)
{ 
selectedNode.scrollIntoView(true);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T07:26:57.493

这是当单击特定树节点时树视图的解决方案，它只是滚动到页面的关注标题（不重定向），为此我们有简单的 HTML 代码，现在我们看看它是什么......

`<html>`

`<body>`

```
 <div id="sidebar">
        <ul>
           <li><a href="#contacts" >Contact</a></li>

                /***here is the link*****/`
        </ul>
   </div> 
```

`<div style="height: 250px;" id="contacts">`

```
 /*here your content*/

       </div> 
```

`</body>`

`</html>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T19:25:42.043

我使用了保罗的方法，它对我有用。我`TreeView`在用户控件内的更新面板中有一个在每个`PreRender`. 构建完成后`TreeView`，我将运行以下命令。

```
if (Page.IsPostBack)
        {
            string s2 = @"var elem = document.getElementById('{0}_SelectedNode');
                          if(elem != null )
                          {
                                var node = document.getElementById(elem.value);
                                if(node != null)
                                {
                                     node.scrollIntoView(true);
                                }
                          }
                        ";
            ScriptManager.RegisterStartupScript(this, this.GetType(), "myscript", s2.Replace("{0}", tvOrgChart.ClientID), true);
        } 
```

归功于[保罗·金梅尔](http://www.developer.com/net/asp/article.php/3643956)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T08:49:01.160

您还可以使用以下代码：

```
 var elem = document.getElementById('TreeView1_SelectedNode');   
        if(elem != null )   
        {     
            var node = document.getElementById(elem.value);     
            if(node != null)     
            {       
                node.scrollIntoView(true);       
            }   
        } 
```

归功于[保罗·金梅尔](http://www.developer.com/net/asp/article.php/3643956)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-02T02:56:43.120

将此方法添加到您的代码后面。它对我有用。将 treeView 替换为您的 treeView 控件的 ID。

```
 protected override void OnPreRender(EventArgs e) {
        //return some code to run on the client
        string jsScript = @"
            <script language=javascript>
                function Tree_scrollIntoView() {
                    var data = " + treeView.ClientID + @"_Data;
                    if (!data) {
                        return;
                    }
                    if ((typeof(data.selectedClass) != ""undefined"") && (data.selectedClass != null)) {
                        var id = data.selectedNodeID.value;
                        if (id.length > 0) {
                            var selectedNode = document.getElementById(id);
                            if ((typeof(selectedNode) != ""undefined"") && (selectedNode != null)) {
                                selectedNode.scrollIntoView(true)
                            }
                        }
                    }
                }

                $(document).ready(function () {
                    Tree_scrollIntoView();
                });                    
            </script>";

        string jsScriptKey = "Scroll_treeview_to_selected";
        if (!Page.ClientScript.IsStartupScriptRegistered(this.GetType(), jsScriptKey)) {
            Page.ClientScript.RegisterClientScriptBlock(this.GetType(), jsScriptKey, jsScript);
        }

        base.OnPreRender(e);
    } 
```

# wpf - WPF 中的主题用户控件

> ID：577325
> 
> 赞同：8
> 
> 时间：2009-02-23T11:24:47.000
> 
> 标签：wpf, user-controls, themes

如何在 WPF 中创建具有基本默认样式但在需要时也可以轻松设置主题的 UserControl？

您是否有一些很好的指南、博客条目或示例来解释这个特定主题？

提前谢谢你，马可

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T12:15:45.987

在 WPF 中，主题只是一组 XAML 文件，每个文件都包含一个**ResourceDictionary**，其中包含适用于应用程序中使用的控件的**样式**和**模板定义。**主题文件可能如下所示：

```
<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:uc="clr-namespace:MyApp.UserControls">

  <!-- Standard look for MyUserControl -->
  <Style x:Key="Standard" TargetType="{x:Type uc:MyUserControl}">
    <Setter Property="Width" Value="22" />
    <Setter Property="Height" Value="10" />
  </Style>

</ResourceDictionary> 
```

必须通过向程序集添加以下属性来显式启用对 WPF 应用程序中的主题的支持：

```
[assembly: ThemeInfo(
  ResourceDictionary.None,
  ResourceDictionaryLocation.SourceAssembly
 )] 
```

这将指示 WPF 查找名为*theme\generic.xaml的***嵌入式资源**文件，以确定应用程序控件的默认外观。

 *请注意，当**特定于主题的字典包含与**应用程序程序集不同的文件时，样式和模板资源必须使用*复合键*，它告诉 WPF 哪个程序集包含样式/模板适用的控件。所以前面的例子应该修改为：

```
<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:uc="clr-namespace:MyApp.UserControls;assembly=MyApp">

  <!-- Standard look for MyUserControl in the MyApp assembly -->
  <Style x:Key="{ComponentResourceKey {x:Type uc:MyUserControl}, Standard}">
    <Setter Property="Width" Value="22" />
    <Setter Property="Height" Value="10" />
  </Style>

</ResourceDictionary> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T11:55:16.740

看这篇文章：http: [//msdn.microsoft.com/en-us/magazine/cc135986.aspx](http://msdn.microsoft.com/en-us/magazine/cc135986.aspx)

它讨论了如何编写可以使用 ControlTemplate 更改的控件，例如内置控件。

# c++ - MAP 文件分析 - 我的代码大小从何而来？

> ID：577330
> 
> 赞同：13
> 
> 时间：2009-02-23T11:25:58.260
> 
> 标签：c++, linker, code-size

我正在寻找一种工具来简化分析大型 C++ 项目 (VC6) 的链接器映射文件。

在维护期间，二进制文件稳定增长，我想弄清楚它来自哪里。我怀疑在不同 DLL 之间共享的库中存在一些过度热心的模板扩展，但是浏览地图文件并没有提供很好的线索。

有什么建议么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-19T11:09:32.323

[这](http://www.sikorskiy.net/prj/amap/index.html)是一个很棒的编译器生成的地图文件分析/浏览器/查看器工具。检查您是否可以浏览 gcc 生成的地图文件。

*amap ：分析 32 位 Visual Studio 编译器生成的 .MAP 文件并报告数据和代码使用的内存量的工具。此应用程序还可以读取和分析由 Xbox360、Wii 和 PS3 编译器生成的 MAP 文件。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T18:42:40.427

地图文件应该有每个部分的大小，您可以编写一个快速工具来按此大小对符号进行排序。还有一个 MSVC (undname.exe) 附带的命令行工具，您可以使用它来解开符号。

将符号按大小排序后，您可以根据需要每周或每天生成此符号，并比较每个符号的大小随时间的变化情况。

任何单个构建中的地图文件可能不会说明太多，但编译地图文件的历史报告可以告诉您很多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-14T01:00:10.137

您是否尝试过在 .obj 文件上使用 dumpbin.exe？

要寻找的东西：

*   使用大量的 STL？
*   很多带有内联方法的 c++ 类？
*   很多常数？

如果上述任何一项适用于您。检查它们是否具有广泛的可见性，即它们是否在您的应用程序的大部分中使用/看到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T18:33:03.677

没有对工具的建议，但猜测可能的原因：您是否启用了增量链接？这可能会导致后续构建期间的扩展...

如果您使用 /opt:ref 进行编译，链接器将删除未使用的符号，因此如果您使用它而不使用增量链接，我希望二进制文件的扩展只是添加实际新代码的结果。据我所知……希望对你有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-16T13:19:25.573

模板、宏、STL 通常都使用大量空间。BOOST 被誉为一个伟大的通用库，为项目增加了很多空间。BOOST_FOR_EACH 就是一个例子。它有数百行模板化代码，可以通过编写适当的循环句柄来避免，这通常只需要几个按键。

获取 Visual AssistX 以节省输入，而不是使用模板。还要考虑拥有您使用的代码。宏和内联函数扩展不一定会出现。

此外，如果可以的话，从 DLL 架构转向将所有内容静态链接到一个以不同“模式”运行的可执行文件中。使用相同的可执行映像多次使用绝对没有错，只需根据您希望它执行的操作传入不同的命令行参数即可。

DLL 是浪费空间和减慢项目运行时间的罪魁祸首。人们认为他们是节省空间的人，而实际上他们往往会产生相反的效果，有时会将项目规模扩大十倍！另外，它们增加了交换。使用固定代码段（无重定位段）来提高性能。

# c# - 在 LINQ to SQL 中，通过外键添加时是否需要 InsertOnSubmit()？

> ID：577332
> 
> 赞同：4
> 
> 时间：2009-02-23T11:26:18.510
> 
> 标签：c#, linq-to-sql, foreign-keys

在 LINQ to SQL 中，通过外键添加时是否需要 InsertOnSubmit()？

即，如果我有执行以下操作的代码，其中订单和订单行通过外键在 dbml 和数据库中链接：

*   创建订单。
*   将订单添加到数据上下文订单。
*   创建订单行。
*   添加到 order.Lines。

我还需要将订单行添加到 context.OrderLine 集合吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T11:49:55.270

不，在几乎所有情况下，如果您将其附加（分配给属性或添加到实体集合）它到附加对象（从数据库中提取），则不需要它。如果根对象已断开连接，但所有其他数据都与它相关，则只需插入根对象 :)

有点酷，嘿！

# asp.net - 更新 Access db 中表的 SINGLE 字段

> ID：577335
> 
> 赞同：1
> 
> 时间：2009-02-23T11:27:24.560
> 
> 标签：asp.net, visual-studio, visual-studio-2008, ms-access

如何使用 VisualStudio08 中的 asp.net 网站更新 Access 数据库中的单个字段。假设已建立连接，请逐步说明在设计视图中要执行的操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T21:18:09.523

假设您希望在某些回发事件（例如单击按钮）上完成此操作，则需要（这是从记忆中得出的，我面前没有它！）：

1.  单击按钮，显示其属性，然后单击事件选项卡。
2.  在 OnClick 空间中双击以创建新的事件处理程序（或直接输入名称）
3.  在代码窗口的事件处理程序中，调用一些类似的 SQL

    更新*表*集*字段*=*值*其中*字段 2* =*标识符*

（或者您可以使用等效的 LINQ）其中*table*、*field*、*field2*、*value*和*identifier*应替换为特定名称以适合您的数据库。

您可以创建一个[SqlCommand::ExecuteNonQuery](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery.aspx)实例来运行 SQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T22:47:57.890

这是一个控制台应用程序，向您展示如何使用 ADO.NET 更新 Access DB。另一种方法是使用 Linq。

您可以向您的 CodeBehind 添加一个执行类似操作的方法，并从您的 OnClick 事件处理程序中调用它。

```
Option Explicit On
Option Strict On

Imports System
Imports System.Data
Imports System.Data.OleDb

Public Class Program
    Public Shared Sub Main()

        Dim connectionString As String = GetConnectionString()
        Dim queryString As String = _
            "UPDATE Categories Set CategoryName = 'ABC' WHERE CategoryID = 1;"

        Using connection As New OleDbConnection(connectionString)
            Dim command As OleDbCommand = connection.CreateCommand()
            command.CommandText = queryString
            Try
                connection.Open()

                Dim rowsAffected As Integer = command.ExecuteNonQuery()

            Catch ex As Exception
                Console.WriteLine(ex.Message)
            End Try
        End Using
    End Sub

    Private Shared Function GetConnectionString() As String
        ' To avoid storing the connection string in your code,  
        ' you can retrieve it from a configuration file.
        ' Assumes Northwind.mdb is located in c:\Data folder.
        Return "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" _
           & "c:\Data\Northwind.mdb;User Id=admin;Password=;"
    End Function
End Class 
```

# mysql - 在 MySQL 中截断慢查询日志

> ID：577339
> 
> 赞同：13
> 
> 时间：2009-02-23T11:29:48.797
> 
> 标签：mysql, logging, truncate

在 MySQL 运行时截断 MySQL 慢查询日志（主要在 Linux 下，但 Windows 会很方便）的最安全方法是什么？

安全我的意思是：

*   不得导致任何权限问题
*   下次附加时不能跳回原来的大小

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-23T11:39:38.337

要截断文件，无论它是否由正在运行的应用程序打开，请执行以下操作：

```
> /var/logs/your.log 
```

在你的 shell 提示符下。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-07-30T17:41:15.267

从[这里](http://dev.mysql.com/doc/refman/5.0/en/log-file-maintenance.html)：

您可以移动打开的文件，然后告诉 mysqld 刷新日志，这将打开一个新日志。

```
shell> cd mysql-data-directory
shell> mv mysql.log mysql.old
shell> mv mysql-slow.log mysql-slow.old
shell> mysqladmin flush-logs 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T01:20:29.160

如果这将是一个持续的问题，你应该看看[logrotate](http://www.linuxcommand.org/man_pages/logrotate8.html)因为它可以为你做这件事。

我不知道`echo > file.log`，虽然它是有道理的。我一直用`cat /dev/null > file.log`。

另外，应该注意的是不要删除正在写入的日志文件，因为打开它的程序将继续写入该文件，这一点*非常重要。*很难弄清楚为什么你所有的硬盘空间都不见了！

# asp.net - ASP.Net - 管理大量项目的良好 UI 设计问题

> ID：577343
> 
> 赞同：1
> 
> 时间：2009-02-23T11:31:01.430
> 
> 标签：asp.net, user-interface

我们目前正在研究一种解决方案，该解决方案涉及为一个项目管理大量部件。在我们的数据库中，我们有一个项目表和一个零件表。这些部分可以分配给多个项目，反之亦然。这是通过链接表完成的。

我们对数据库方面很满意，它不会被改变，但是我们有点卡在如何以用户友好的直观方式显示 UI。

大约有 6000 个部件（...目前），我们需要能够轻松快速地从项目中分配/取消分配这些部件。

有没有人有这方面的好例子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T14:04:38.923

我一直发现实时过滤很容易使用并缩小范围。这可能要求您的用户具有一定的计算机知识......

此外，我会考虑 D&D。我会想象两个列表（一个包含项目，一个包含模块），我可以在其中一个列表上进行多选，并将另一个列表中的单个项目拖到该选择中。

And if it is going to be an interface that's going to be heavily/repeatedly used, consider good keyboard support. Me personally find that repetetive tasks can be done MUCH faster if they can be accessed by hotkeys.

Just thinking out loud ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T12:12:50.707

这有两个不同的部分。第一个是从数据库中选择零件和项目，第二个是将零件与项目相关联。您应该尽量避免在单个对话框中执行这两个操作。

从您的帖子中，似乎可以将部件分配给项目，并且可以将项目分配给部件。因此，向导方法可能有效：

```
 project or part?
              /                    \
select project                      select part
        |                               |
show list of parts                  show list of projects
        |                               |
add/remove parts to project         add/remove projects to part 
```

显示项目/部件列表时，请使用带有过滤框的简单排序列表。使用树或其他分类系统对用户来说可能是模棱两可的。例如，如果列表是食物，并且有水果和蔬菜的类别，你会把番茄放在哪里？店主可能会放入蔬菜，而植物学家会放入水果。因此，带有搜索框的简单排序列表（如 FF 的 about:config）的效果非常好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T11:51:37.653

**[我会尝试很多事情，从纯 UI 的角度来看，如果您的收藏自然地属于类别，我是级联列表](http://designinginterfaces.com/Cascading_Lists)**或可排序、可过**滤网格**的忠实粉丝。（或两者结合）

您的选择将取决于您的用户计算机知识以及空间或技术限制。

如果您可以节省空间，我认为两个列表，可能是左侧的选定项目，以及右侧带有复选标记或 >> << 按钮等可供性的项目集合。我可能会从**Excel**的书中拿出一页，它有一些这类事情的完美可行的例子。

我还花时间添加**多级撤消**，当您对简单的错误没有追索权时，使用大型数据集作为用户绝对是一件痛苦的事，理想情况下，它应该跟踪和处理用户需要进行的任何繁琐的交互。

# deployment - Salesforce - 如何在环境（沙盒、实时等）之间进行部署

> ID：577346
> 
> 赞同：25
> 
> 时间：2009-02-23T11:32:32.190
> 
> 标签：deployment, salesforce, apex-code

我们正在研究建立一个适当的部署过程。

从我读过的内容来看，似乎有 4 种方法可以做到这一点。

1.  复制和粘贴——我们不想这样做
2.  使用 Salesforce Web 界面中内置的“包”机制
3.  Eclipse Force IDE“部署到服务器”选项
4.  Ant Script（这个还没试过）

有没有人对各种方法的限制提出建议。

您可以将所有内容都包含在 Web Interface 包中吗？

我们正在寻找部署以下项目：

*   顶点课程

*   Apex 触发器

*   工作流程

*   电子邮件模板

*   MailMerge 模板——在 Eclipse 中似乎找不到这些

*   自定义字段

*   页面布局

*   RecordTypes（在网站或 Eclipse 中似乎找不到这些）

*   选择列表项目？

*   控制

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-23T18:38:55.553

我推荐[Force.com 迁移工具](https://developer.salesforce.com/docs/atlas.en-us.daas.meta/daas/meta_development.htm)。

以供参考：

*   [Force.com 迁移工具文档](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_deploying_ant.htm)
*   [迁移工具指南](http://wiki.apexdevnet.com/index.php/Migration_Tool)

迁移工具允许您使用 ant 目标在 salesforce.com 组织之间移动元数据。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-20T03:49:16.527

我可以从最近的痛苦经历中谈到这一点。

打包：这是一种非常古老的方法，早于 Ant 和 Eclipse 所依赖的元数据 API。根据我们的经验，打包的唯一好处是定义您的项目。如果您使用的是 Eclipse（我们这样做，我推荐），您可以将您的项目定义为基于特定包。只要你记得在你的包中添加新组件，你的项目就会挂在一起

顺便说一句，让我们感到困惑的一件事是 package.json 的多种用途。我们注意到以下几点：

已安装的软件包：这些软件包有托管和非托管两种类型，用 SFDC 板上最近的一篇文章的话来说，它们确实是 ISV 将他们的东西部署到“外面”的各种未知组织中。托管包和非托管包都有限制，因此它们不适合和不需要在组织内从开发部署到生产，或者在您进行自定义开发并且不打算将代码分发到大型匿名库的任何情况下。

未安装的包：这是您在 Web UI 中单击“包”时看到的内容。这些，我们有时称为“开发包”，似乎只是将项目定义放在一起的一种方便方式。

无论如何，我得出的结论是我们的团队（定制开发，而不是 ISV）不需要任何形式的包。

其他形式的部署，包括 Eclipse 和 Ant，都依赖于元数据 API。从理论上讲，它们能够做完全相同的事情。实际上，它们似乎是互补的。Force.com 迁移工具，内置于 Eclipse 的 Force.com IDE 中，使部署尽可能简单（这不是很容易），并让您很好地了解它打算部署的内容。另一方面，我们看到 Ant 做了一些 IDE 做不到的事情。因此，两者都值得学习。

我们倾向于将所有项目保留在 SVN 中，并使用 SVN 结构作为项目定义（Eclipse 将使用它并尊重它）。我们使用 Eclipse，有时还使用 Ant 进行迁移。任何地方都没有明显的包装需求。

顺便说一句，还有一件事需要注意——并非所有组件都是可迁移的。有些东西必须在目标环境中手动重新配置。一个例子是基于时间的工作流。我认为队列和组也需要手动创建。同样，元数据 API 不能直接处理字段删除，因此如果您在源中删除了字段，则需要在目标中手动将其删除。还有其他情况。

希望有用——

——史蒂夫·莱恩

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T22:12:52.097

从 Spring '09 开始，元数据中不支持邮件合并模板，但记录类型支持。您会在文件中找到记录类型作为它们所属对象的 XML 元素。您列表中的所有其他内容均受支持，但有一个小例外。在 Spring '09 中无法编辑标准字段的选项列表值。请继续关注 Summer '09 功能公告的新闻。

更新：标准对象上的标准选项列表现在公开了元数据（从 API v16 开始）： http: [//www.salesforce.com/us/developer/docs/api_meta/Content/meta_picklist.htm](http://www.salesforce.com/us/developer/docs/api_meta/Content/meta_picklist.htm)

否则，Steve Lane 的反应是相当准确的。使用非托管包（Steve 称之为非安装包）的优势在于，当您将元数据添加到包时，它所依赖的元数据将自动添加。因此，更容易获取包含所有依赖项的全套元数据。如果您反复将元数据从一个组织（沙盒）移动到另一个（生产），Steve 的方法可能是最好的方法，当然也是当今最常见的方法。我经常使用非托管的“开发人员”包将我在一个组织中开发的东西移动到另一个不相关的组织。出于我的目的，我喜欢在 org 中定义包，而不是 Eclipse 项目/SVN。但这可能不会

杰斯珀

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-28T23:44:42.027

如果要将元数据从沙盒移动到生产环境，另一种选择是使用[变更集。](https://login.salesforce.com/help/doc/en/changesets.htm)

当前对如何使用变更集有一些限制：

> 在两个组织之间发送更改集需要部署连接。目前，变更集只能在隶属于生产组织的组织之间发送，例如，生产组织和沙箱，或从同一组织创建的两个沙箱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-17T15:24:25.007

从文档：

**必须管理软件包才能在 AppExchange 上公开发布并支持升级**。一个组织可以创建一个可以由许多不同组织下载和安装的受管软件包。它们与非受管软件包的不同之处在于，某些组件被锁定，允许稍后升级受管软件包。非受管软件包不包括锁定的组件并且无法升级。此外，**托管包会混淆订阅组织上的某些组件（如 Apex），以保护开发者的知识产权。**

托管包的优势在于它允许您轻松地在多个 SFDC 组织中进行版本控制和分发。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-27T18:05:16.127

我自己仍在为此苦苦挣扎。Migration Tool的IDE都没有解决我面临的主要问题，如下：

1.  **已安装的包无法部署到 Developer Org**。您必须在 Dev Org 中手动安装它们。

    如果一个包无法安装在组织中（例如，因为它需要密码，如 [Marketo Sales Insight](https://salesforce.stackexchange.com/questions/3669/installing-marketo-sales-insight-app-in-developer-edition-org)，或者因为它已被弃用，如 [Salesforce for Google Adwords](http://appexchange.salesforce.com/listingDetail?listingId=a0N300000016Z6XEAU)）并且我们的应用程序依赖于它（如对对象中的字段的引用属于包），那么我们将无法部署该应用程序。

    **解决方法**：如果无法在 DEv Org 中手动安装包，则每个开发人员都需要自己的 Developer Sandbox。可以从 Salesforce 订购其他开发人员沙盒。*（不过，客户必须愿意为它们付费……）*

2.  当沙箱从生产中刷新并且我们从服务器**刷新我们的本地项目**（连接到 SVN）时，旧沙箱中但不在生产中的所有其他文件/代码将被移动到新沙箱。

    **解决方法**：生产中所做的所有更改都必须在沙盒和开发者组织中复制。*（有点痛，但还好……）*

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-09-07T06:47:08.787

在任何 Salesforce 生产部署中，元数据 API 都是更好的选择之一。有一些工具可以简化工作。查看这篇文章：[https ://www.deploypkg.com/deploy-to-production/](https://www.deploypkg.com/deploy-to-production/)

# xml - SSIS 输出参数和 XML

> ID：577349
> 
> 赞同：0
> 
> 时间：2009-02-23T11:34:27.147
> 
> 标签：xml, ssis, oledb

似乎在处理返回 xml 的存储过程时在 SSIS 中使用 OLE DB 命令时会出现问题：[查看错误描述](https://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=178760)

我必须使用以这种方式构建的过程并获取 xml，即使它只是一个字符串值。有没有人知道上面链接的错误的解决方法，不涉及更改程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T08:02:06.753

我认为您应该能够使用 CAST 运算符将存储过程的输出转换为常规字符串。

# c# - 以编程方式添加的用户控件不会创建其子控件

> ID：577353
> 
> 赞同：2
> 
> 时间：2009-02-23T11:36:46.550
> 
> 标签：c#, asp.net, user-controls

我的项目中有一个用户控件 (.ascx)，我在页面的 Page_Load 事件处理程序中以编程方式将其添加到页面中，如下所示：

```
Controls.Add(new MyProject.Controls.ControlWidget());
Databind(); 
```

当我尝试从控件本身访问控件的子控件时，它们不存在。

```
public override void DataBind()
{
  myrepeater.DataSource = GetDataSource(); 
  // throws an exception because myrepeater is null

  base.DataBind();
} 
```

如何访问用户控件的子控件？我尝试将 EnsureChildControls() 调用添加到我的 DataBind() 覆盖中，但这似乎没有什么区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T11:45:52.597

您需要使用 LoadControl 来加载它，而不仅仅是实例化类。LoadControl 在幕后执行“魔术”以将所有内容捆绑起来并实例化前端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T11:52:43.563

**编辑：**我误解了你的问题，

试试这个把你的 UserControl 添加到你的页面：

```
UserControl uc = new UserControl();
uc.LoadControl(Server.MapPath("MyUserControl.ascx");
this.Controls.Add(uc); 
```

# gtk - 林间空地 aboutDialog 没有关闭

> ID：577354
> 
> 赞同：5
> 
> 时间：2009-02-23T11:37:02.167
> 
> 标签：gtk, pygtk, gtk3, glade

我有一个`AboutDialog`空地制作的盒子，但关闭按钮不起作用。我不知道如何将此按钮连接到一个单独的功能，因为它位于一个名为`dialog-action_area`.

另一个问题是，如果我使用窗口管理器创建的关闭按钮，我无法再次打开它，因为它已被破坏。

我怎样才能改变它，让它隐藏起来？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T03:56:13.463

与任何其他对话框窗口一样，它们要求您

1.  使用运行方法。
2.  利用“响应”信号

第一个将阻塞主循环并在对话框收到响应后立即返回，这可能是单击操作区域中的任何按钮或按 Esc，或调用对话框的响应方法或“销毁”窗口，最后一个并不意味着窗口将被销毁，这意味着 run() 方法将退出并返回响应。像这样：

```
response = dialog.run() 
```

如果您使用调试器，您会注意到主循环一直停留在那里，直到您单击按钮或尝试关闭对话框。收到回复后，您可以随意使用它。

```
response = dialog.run()
if response == gtk.RESPONSE_OK:
    #do something here if the user hit the OK button 
dialog.destroy() 
```

第二个允许您在非阻塞的东西中使用对话框，然后您必须将对话框连接到“响应”信号。

```
def do_response(dialog, response):
    if response == gtk.RESPONSE_OK:
        #do something here if the user hit the OK button 
    dialog.destroy()

dialog.connect('response', do_response) 
```

现在，您注意到您必须销毁您的对话框

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T13:22:15.970

当您收到删除或取消信号时，您需要调用小部件的 hide() 方法：

```
response = self.wTree.get_widget("aboutdialog1").run() # or however you run it
if response == gtk.RESPONSE_DELETE_EVENT or response == gtk.RESPONSE_CANCEL:
  self.wTree.get_widget("aboutdialog1").hide() 
```

[您可以在 GTK 文档](http://www.pygtk.org/docs/pygtk/gtk-constants.html#gtk-response-type-constants)中找到响应类型常量

# java - 获取 TreeMap 键集子集的简单方法（在 Java 中）

> ID：577358
> 
> 赞同：-1
> 
> 时间：2009-02-23T11:39:13.283
> 
> 标签：java, treemap

是否可以从 TreeMap 中提取前 n 个（我使用 top 因为我相信 TreeMap 已排序）关键元素，而无需使用 Iterator 对象进行迭代。

我可以进行迭代，但必须检查空值等很乏味。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T11:42:29.983

为什么要检查空值？

如果您使用[Google Collections Library](http://code.google.com/p/google-collections/)，您可以使用[Iterables.limit](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/Iterables.html#limit(java.lang.Iterable,%20int))。

编辑：出于某种原因，GCL 页面不包含`limit`，但它在[Guava](http://guava-libraries.googlecode.com)中（它已经有效地取代了 GCL） - 它仍然是[`Iterables.limit`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#limit%28java.lang.Iterable,%20int%29).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T12:49:06.313

`.subMap(low,high).keySet()`您可以使用或轻松获取从一个键到另一个键的键子集`.headMap(high).keySet()`。

找出第*n*个正确的高键更难，因为没有直接的方法，迭代是唯一可靠的方法。

（此代码*未经测试*）

```
public <K,V> SortedMap<K,V> subMap(SortedMap<K,V> map, int n) {
  Iterator<K> it = map.keySet().iterator();
  for (int i = 0; i<n && it.hasNext(); i++) {
    it.next();
  }
  if (it.hasNext()) {
    return map.headMap(it.next());
  } else {
    return map
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T11:53:59.627

您可以使用：

[子图方法][1]

```
public NavigableMap<K,V> subMap(K fromKey,boolean fromInclusive,K toKey,boolean toInclusive) 
```

[1]: [http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html#subMap(K](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html#subMap(K) , boolean, K, boolean)

# java - 如何检查 IP 地址是否来自 Java 中的特定网络/网络掩码？

> ID：577363
> 
> 赞同：34
> 
> 时间：2009-02-23T11:42:06.660
> 
> 标签：java, networking, ip

我需要确定给定的 IP 地址是否来自某个特殊网络，以便自动进行身份验证。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2017-01-05T10:06:40.060

## 选项1：

使用[`spring-security-web`](https://mvnrepository.com/artifact/org.springframework.security/spring-security-web)的[IpAddressMatcher](http://docs.spring.io/spring-security/site/docs/3.2.8.RELEASE/apidocs/org/springframework/security/web/util/matcher/IpAddressMatcher.html#matches(java.lang.String))。与 Apache Commons Net 不同，它同时支持 ipv4 和 ipv6。

```
import org.springframework.security.web.util.matcher.IpAddressMatcher;
...

private void checkIpMatch() {
    matches("192.168.2.1", "192.168.2.1"); // true
    matches("192.168.2.1", "192.168.2.0/32"); // false
    matches("192.168.2.5", "192.168.2.0/24"); // true
    matches("92.168.2.1", "fe80:0:0:0:0:0:c0a8:1/120"); // false
    matches("fe80:0:0:0:0:0:c0a8:11", "fe80:0:0:0:0:0:c0a8:1/120"); // true
    matches("fe80:0:0:0:0:0:c0a8:11", "fe80:0:0:0:0:0:c0a8:1/128"); // false
    matches("fe80:0:0:0:0:0:c0a8:11", "192.168.2.0/32"); // false
}

private boolean matches(String ip, String subnet) {
    IpAddressMatcher ipAddressMatcher = new IpAddressMatcher(subnet);
    return ipAddressMatcher.matches(ip);
} 
```

* * *

## 选项 2（轻量级解决方案！）：

*The code in previous part works perfectly fine* but it needs `spring-security-web` to be included.

If you are not willing to include Spring framework in your project, you may use this class which is a slightly modified version of the [original class](https://github.com/spring-projects/spring-security/blob/master/web/src/main/java/org/springframework/security/web/util/matcher/IpAddressMatcher.java) from Spring, so that it has no non-JRE dependencies.

```
/*
 * Copyright 2002-2019 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import java.net.InetAddress;
import java.net.UnknownHostException;

/**
 * Matches a request based on IP Address or subnet mask matching against the remote
 * address.
 * <p>
 * Both IPv6 and IPv4 addresses are supported, but a matcher which is configured with an
 * IPv4 address will never match a request which returns an IPv6 address, and vice-versa.
 *
 * @author Luke Taylor
 * @since 3.0.2
 * 
 * Slightly modified by omidzk to have zero dependency to any frameworks other than the JRE.
 */
public final class IpAddressMatcher {
    private final int nMaskBits;
    private final InetAddress requiredAddress;

    /**
     * Takes a specific IP address or a range specified using the IP/Netmask (e.g.
     * 192.168.1.0/24 or 202.24.0.0/14).
     *
     * @param ipAddress the address or range of addresses from which the request must
     * come.
     */
    public IpAddressMatcher(String ipAddress) {

        if (ipAddress.indexOf('/') > 0) {
            String[] addressAndMask = ipAddress.split("/");
            ipAddress = addressAndMask[0];
            nMaskBits = Integer.parseInt(addressAndMask[1]);
        }
        else {
            nMaskBits = -1;
        }
        requiredAddress = parseAddress(ipAddress);
        assert  (requiredAddress.getAddress().length * 8 >= nMaskBits) :
                String.format("IP address %s is too short for bitmask of length %d",
                        ipAddress, nMaskBits);
    }

    public boolean matches(String address) {
        InetAddress remoteAddress = parseAddress(address);

        if (!requiredAddress.getClass().equals(remoteAddress.getClass())) {
            return false;
        }

        if (nMaskBits < 0) {
            return remoteAddress.equals(requiredAddress);
        }

        byte[] remAddr = remoteAddress.getAddress();
        byte[] reqAddr = requiredAddress.getAddress();

        int nMaskFullBytes = nMaskBits / 8;
        byte finalByte = (byte) (0xFF00 >> (nMaskBits & 0x07));

        // System.out.println("Mask is " + new sun.misc.HexDumpEncoder().encode(mask));

        for (int i = 0; i < nMaskFullBytes; i++) {
            if (remAddr[i] != reqAddr[i]) {
                return false;
            }
        }

        if (finalByte != 0) {
            return (remAddr[nMaskFullBytes] & finalByte) == (reqAddr[nMaskFullBytes] & finalByte);
        }

        return true;
    }

    private InetAddress parseAddress(String address) {
        try {
            return InetAddress.getByName(address);
        }
        catch (UnknownHostException e) {
            throw new IllegalArgumentException("Failed to parse address" + address, e);
        }
    }
} 
```

**NOTICE**: Notice that for using this option, it's your responsibility to carefully examine the [license](https://www.apache.org/licenses/LICENSE-2.0) to make sure by using this code, you are not in violation of any terms mandated by the aforementioned license. (Of course publishing this code to Stackoverflow.com by me is not a violation.)

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-02-23T17:34:50.120

[Apache Commons Net](http://commons.apache.org/net/)似乎`org.apache.commons.net.util.SubnetUtils`可以满足您的需求。看起来你做了这样的事情：

```
SubnetInfo subnet = (new SubnetUtils("10.10.10.0", "255.255.255.128")).getInfo();
boolean test = subnet.isInRange("10.10.10.10"); 
```

请注意，正如[carson](https://stackoverflow.com/users/25343/carson)所指出的，Apache Commons Net 有[一个错误](http://mail-archives.apache.org/mod_mbox/commons-issues/200902.mbox/%3C2039253761.1233796319684.JavaMail.jira@brutus%3E)，在某些情况下会阻止它给出正确的答案。Carson 建议使用 SVN 版本来避免这个错误。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-23T20:53:57.023

你也可以试试

```
boolean inSubnet = (ip & netmask) == (subnet & netmask); 
```

或更短

```
boolean inSubnet = (ip ^ subnet) & netmask == 0; 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-01-08T04:44:13.177

[The open-source IPAddress Java library](https://seancfoley.github.io/IPAddress/) will do this in a polymorphic manner for both IPv4 and IPv6 and handles subnets. Disclaimer: I am the project manager of that library.

Example code:

```
contains("10.10.20.0/30", "10.10.20.3");
contains("10.10.20.0/30", "10.10.20.5");
contains("1::/64", "1::1");
contains("1::/64", "2::1");
contains("1::3-4:5-6", "1::4:5");       
contains("1-2::/64", "2::");
contains("bla", "foo");

static void contains(String network, String address) {
    IPAddressString one = new IPAddressString(network);
    IPAddressString two = new IPAddressString(address);
    System.out.println(one +  " contains " + two + " " + one.contains(two));
} 
```

Output:

```
10.10.20.0/30 contains 10.10.20.3 true
10.10.20.0/30 contains 10.10.20.5 false
1::/64 contains 1::1 true
1::/64 contains 2::1 false
1::3-4:5-6 contains 1::4:5 true
1-2::/64 contains 2:: true
bla contains foo false 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-02-04T10:20:22.207

here is an Version that works with IPv4 and IPv6 one with Prefix and one with Network Mask.

```
/**
 * Check if IP is within an Subnet defined by Network Address and Network Mask
 * @param  ip
 * @param  net
 * @param  mask
 * @return
 */
public static final boolean isIpInSubnet(final String ip, final String net, final int prefix) {
    try {
        final byte[] ipBin   = java.net.InetAddress.getByName(ip  ).getAddress();
        final byte[] netBin  = java.net.InetAddress.getByName(net ).getAddress();
        if(ipBin.length  != netBin.length ) return false;
        int p = prefix;
        int i = 0;
        while(p>=8) { if(ipBin[i] != netBin[i] ) return false; ++i; p-=8; }
        final int m = (65280 >> p) & 255;
        if((ipBin[i] & m) != (netBin[i]&m) ) return false;

        return true;
    } catch(final Throwable t) {
        return false;
    }
}

/**
 * Check if IP is within an Subnet defined by Network Address and Network Mask
 * @param  ip
 * @param  net
 * @param  mask
 * @return
 */
public static final boolean isIpInSubnet(final String ip, final String net, final String mask) {
    try {
        final byte[] ipBin   = java.net.InetAddress.getByName(ip  ).getAddress();
        final byte[] netBin  = java.net.InetAddress.getByName(net ).getAddress();
        final byte[] maskBin = java.net.InetAddress.getByName(mask).getAddress();
        if(ipBin.length  != netBin.length ) return false;
        if(netBin.length != maskBin.length) return false;
        for(int i = 0; i < ipBin.length; ++i) if((ipBin[i] & maskBin[i]) != (netBin[i] & maskBin[i])) return false;
        return true;
    } catch(final Throwable t) {
        return false;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-01T19:42:49.330

I know this is very old question, but I stumbled upon this when I was looking to solve the same problem.

There is [commons-ip-math](https://github.com/jgonian/commons-ip-math) library that I believe does a very good job. Please note that as of May 2019, there hasn't been any updates to the library (Could be that its already very mature library). Its available on [maven-central](https://search.maven.org/artifact/com.github.jgonian/commons-ip-math/1.32/jar)

It supports working with both IPv4 and IPv6 addresses. Their brief documentation has examples on how you can check if an address is in a specific range for [IPv4](https://github.com/jgonian/commons-ip-math#ipv4-addresses) and [IPv6](https://github.com/jgonian/commons-ip-math#ipv6-addresses)

Example for IPv4 range checking:

```
 String input1 = "192.168.1.0";
        Ipv4 ipv41 = Ipv4.parse(input1);

        // Using CIDR notation to specify the networkID and netmask
        Ipv4Range range = Ipv4Range.parse("192.168.0.0/24");
        boolean result = range.contains(ipv41);
        System.out.println(result); //false

        String input2 = "192.168.0.251";
        Ipv4 ipv42 = Ipv4.parse(input2);

        // Specifying the range with a start and end.
        Ipv4 start = Ipv4.of("192.168.0.0");
        Ipv4 end = Ipv4.of("192.168.0.255");
        range = Ipv4Range.from(start).to(end);

        result = range.contains(ipv42); //true
        System.out.println(result); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-08-30T04:52:58.077

To check An IP in a subnet, I used isInRange method in SubnetUtils class. But this method have a bug that if your subnet was X, every IP address that lower than X, isInRange return true. For example if your subnet was 10.10.30.0/24 and you want to check 10.10.20.5, this method return true. To deal with this bug I used below code.

```
public static void main(String[] args){
    String list = "10.10.20.0/24";
    String IP1 = "10.10.20.5";
    String IP2 = "10.10.30.5";
    SubnetUtils  subnet = new SubnetUtils(list);
    SubnetUtils.SubnetInfo subnetInfo = subnet.getInfo();
    if(MyisInRange(subnetInfo , IP1) == true)
       System.out.println("True");
    else 
       System.out.println("False");
    if(MyisInRange(subnetInfo , IP2) == true)
       System.out.println("True");
    else
       System.out.println("False");
}

private boolean MyisInRange(SubnetUtils.SubnetInfo info, String Addr )
{
    int address = info.asInteger( Addr );
    int low = info.asInteger( info.getLowAddress() );
    int high = info.asInteger( info.getHighAddress() );
    return low <= address && address <= high;
} 
```

# python - Django - 我如何_not_调度信号？

> ID：577376
> 
> 赞同：5
> 
> 时间：2009-02-23T11:45:25.420
> 
> 标签：python, django, django-signals

我为我的模型编写了一些智能通用计数器和管理器（以避免`select count`查询等）。因此，我对 post_save 进行了一些繁重的逻辑。

我想防止在不需要时处理信号。我想完美的界面应该是：

```
instance.save(dispatch_signal=False) 
```

我怎样才能做到这一点？

* * *

**更新**

如果有人感兴趣，请提供有关我在做什么的更多信息：

1.  通用计数器存储在单独的表中
2.  每次 Django 对对象列表进行分页时，它都会调用我的自定义管理器的重写 count() 方法，该方法基本上检索适当对象类的静态计数器值。
3.  信号触发计数器更新的逻辑，这有点复杂，因为它检查相关模型的许多方面（即它必须基于嵌套类别树生成可见性属性）。我不能把这个逻辑放在 Model.save() 中，因为一个计数器依赖于许多不同的模型。我希望将这种逻辑整合在一起，而不是碎片散布。
4.  我正在对我的一些模型进行非规范化，因此我跨表重写（复制）某些值。
5.  出于测试目的，我运行我的小命令扩展 - [Dilla](http://code.google.com/p/dilla)来填充随机数据。
6.  我注意到触发了不需要的信号，因此我希望它们有条件地运行。

希望它足够清楚。请原谅我的语言错误。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-04T12:49:48.970

您可以断开并重新连接信号。尝试使用`with:`此实用程序类的语句：

```
class SignalBlocker(object):
    def __init__(self, signal, receiver, **kwargs):
        self.signal = signal
        self.receiver = receiver
        self.kwargs = kwargs

    def __enter__(self, *args, **kwargs):
        self.signal.disconnect(self.receiver)

    def __exit__(self, *args, **kwargs):
        self.signal.connect(self.receiver, **self.kwargs) 
```

您现在可以使用：

```
with SignalBlocker(post_save, my_post_save_handler):
    instance.save() 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-05-15T03:25:55.847

我找到了简单易行的解决方案：

```
MyModel.objects.filter(pk=instance.id).update(**data) 
```

这是由于（[https://docs.djangoproject.com/en/1.5/ref/models/querysets/#update](https://docs.djangoproject.com/en/1.5/ref/models/querysets/#update)）：

> 最后，请意识到 update() 在 SQL 级别进行更新，因此不会在模型上调用任何 save() 方法，也不会发出 pre_save 或 post_save 信号（这是调用 Model.save( ））。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-23T12:05:29.197

一个快速而肮脏的解决方案是：

```
from django.db.models.signals import post_save
from somewhere_in_my_app import my_post_save_handler

post_save.disconnect(my_post_save_handler)
instance.save()
post_save.connect(my_post_save_handler) 
```

但除此之外，我强烈建议将您的逻辑转移到`save()`模型的方法中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-14T10:39:02.690

您还可以在您的或信号处理程序中调用`instance.save_base(raw=True)`并检查`raw`参数：`pre_save``post_save`

```
def my_post_save_handler(instance, raw, **kwargs):
    if not raw:
        heavy_logic() 
```

您可以添加一些糖并获得完美的界面：

```
class MyModel:
    def save(self, dispatch_signal=True, **kwargs):
        self.save_base(raw=not dispatch_signal, **kwargs) 
```

请注意，这`save_base()`不是 Django 的公共 API 的一部分，因此它可能会在未来的版本中更改。

# java - 公司存储库出现“缺少工件”错误

> ID：577377
> 
> 赞同：2
> 
> 时间：2009-02-23T11:45:28.103
> 
> 标签：java, maven-2, dependencies, artifactory

我使用 artifactory 设置了一个公司的 Maven 存储库。我将我们的一个项目部署到存储库中。如果我现在指定对该工件的依赖项，则不会检索它。它应该这样做，因为我在我的 settings.xml 中声明了这一点：

```
<mirrors>
  <mirror>
    <id>company-internal</id>
    <name>company repository</name>
    <url>http://company.repository:8080/artifactory/repo/</url>
    <mirrorOf>*</mirrorOf>
  </mirror>
</mirrors> 
```

这适用于所有 3rdparty 依赖项。工件肯定在reposity中，手动我可以下载工件就好了。为什么maven不能下载？是否更有可能是maven（或那里的配置）的问题，还是工件中存在错误？在 SNAPSHOT 的情况下是否有不同的处理方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T14:27:58.543

您必须在[“存储库”元素](http://maven.apache.org/pom.html#Repositories)下添加您的公司存储库。

“mirrors”元素用于为“central”等存储库指定本地镜像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T11:48:21.030

它应该工作，你能提供更多信息吗？

*   用于获取工件的依赖项片段
*   存储库中工件的 pom.xml

# java - 上下文类加载器

> ID：577379
> 
> 赞同：5
> 
> 时间：2009-02-23T11:45:57.277
> 
> 标签：java

有什么区别？

Class.getClassLoader() 和 Thread.getContextClassLoader()？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T11:49:30.903

从[这个线程](http://coding.derkeiler.com/Archive/Java/comp.lang.java.programmer/2005-01/1404.html)：

> `Class.getClassLoader()`返回`ClassLoader`加载了调用它的类。
> 
> `Thread.getContextClassLoader()`返回`ClassLoader`集合作为调用它的上下文`ClassLoader`，如果调用了 Thread 的方法`Thread`，则它可能与`ClassLoader`加载 Thread 类本身的上下文不同。`setContextClassLoader(ClassLoader)`
> 
> 这可用于允许启动线程的对象指定`ClassLoader`在线程中运行的对象应使用的对象，但需要其中一些对象的合作才能使其工作。

所以如果你想知道为什么会有 3 个 API 调用

```
Thread<instance>.getContextClassLoader()
Thread<instance>.getClassLoader()
Class<instance>.getClassLoader() 
```

，你可以在这个[Find a way out the ClassLoader maze](http://www.javaworld.com/javaworld/javaqa/2003-06/01-qa-0606-load.html)中找到答案。

> 为什么线程上下文类加载器首先存在？它们在 J2SE 中被引入并没有大张旗鼓。Sun Microsystems 缺乏适当的指导和文档可能解释了为什么许多开发人员会感到困惑。
> 
> 事实上，上下文类加载器为 J2SE 中引入的类加载委托方案提供了一个后门。通常，JVM 中的所有类加载器都组织在一个层次结构中，这样每个类加载器（除了引导整个 JVM 的原始类加载器）都有一个父类。
> 
> `[...]`更糟糕的是，某些应用程序服务器将上下文和当前类加载器设置为不同的 ClassLoader 实例，这些实例具有相同的类路径，但作为委托父级和子级并不相关。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T11:48:37.147

Class.getClassLoader() 返回用于加载特定类的类加载器。

Thread.getContextClassLoader() 将 ClassLoader 设置为该线程的**上下文**，它将用于加载所需的类。

例如，这在 Tomcat 中有所不同。对于 java.lang.String 类加载器将是顶级 JVM 类加载器，它不会在您的类路径中包含所有类，但 Thread 上下文类加载器应该这样做。

# google-app-engine - 批量获取 db.get(keys) 是否保留键顺序？

> ID：577381
> 
> 赞同：1
> 
> 时间：2009-02-23T11:47:23.873
> 
> 标签：google-app-engine

Google App Engine 支持基于[google.appengine.ext.db.get( *keys* )](http://code.google.com/appengine/docs/python/datastore/functions.html)键列表的提取操作。

我很想知道是否有任何保证结果列表保留键的顺序（即 keys = [ `k_1`, `k_2`, `k_3`] 那么对于结果 [ `r_1`, `r_2`, `r_3`] 总是正确的`r_i`.key() == `k_i`） .

据我所知，API 通过内部为 IN 中的每个值发出 N 个子选择来执行 IN 选择。我希望这会发生`db.keys`，因此调用将保留键顺序。

无论如何，我不确定，我找不到任何`db.keys`与 IN 选择等效的参考，如果没有对其执行进行任何优化。否则，解决方法将非常简单（我会迭代并查询自己的每个键，因此我将保证我不依赖于`db.keys`实现）。

我进行了一些基本测试，结果表明：

1.  `db.get()`表现最好
2.  `db.get()`保留键顺序
3.  替代方案（始终保证结果的顺序）执行速度较慢`Model.`get_by_id``

虽然结果似乎证实了我的假设，但我想知道其他人是否对此进行了调查并得出了相似或不同的结论。

蒂亚，./亚历克斯

进行更多研究后，我发现了以下内容（两者的文档`db.get()`和`Model.get()`：

> 如果 ids 是一个列表，则该方法返回一个模型实例列表，当对应的 Key 不存在实体时，该方法具有 None 值。

即使它没有下划线，我认为很明显，订单是有保证的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T13:34:22.540

您是对的：db.get 以与您提供的键相同的顺序返回实体。您观察到的性能差异是因为它只需要对数据库进行一次往返而不是多次往返，并且因为它可以同时获取所有实体，而不是串行操作。但是，它不等同于'SELECT ... IN ...'，因为它基于Bigtable，并且您在主键上进行选择，因此它可以直接在表上进行查找。

在进行性能比较时要记住一件事：*始终*在生产服务器上进行这些操作，而不是在 dev_appserver 上。两者具有完全不同的性能特征。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T12:31:10.180

文档中的引用澄清了我的问题。

# spring - 动态实现的 Spring 介绍

> ID：577382
> 
> 赞同：0
> 
> 时间：2009-02-23T11:48:16.477
> 
> 标签：spring, aop, mixins

我正在尝试使用 Spring 框架为一个类（让我们称之为 C）动态实现一个特定的接口（让我们称之为 I）。在 Spring 中，这称为*引入*（其他语言中的 mixin）。在编译时，C 没有实现 I。使用 @DeclareParents 注释我可以在 AspectJ 语法中做到这一点。

问题是 I 的实际实现（我们称之为 IImpl）是独立的（不依赖于上下文）——我应该只在注释中提供 IImpl 类名。我想要实现的是以某种方式规定的实现。例如，我想为 IImpl 实例提供一个参数，比如封闭的 C 实例，以便 IImpl 中的逻辑会根据所引入的 CI 实例而有所不同。我需要一些方法来设置 IImpl 实例和引入的 C 实例之间的依赖关系。

目前我找不到办法做到这一点。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T12:00:57.507

恐怕您正在寻找的解决方案的“形式”是不可能的，因为 AJ 字节码编织器（编译或加载时间无关紧要）需要知道如何“实现”您的方法。但是，我认为委托人的形式可能会解决您的问题。基本上，您将告诉 C 使用 IImpl 实现接口 I 并使用 IImpl 作为委托器，这意味着 IImpl 会将所有方法调用委托给可以在运行时配置/更改的 IRuntimeImpl。IImpl 基本上是：

```
public class IImpl implements I {
    private I delegate;

    public void interfaceMethod() {
        delegate.interfaceMethod()
    }
} 
```

在运行时，您将能够将您为 I 选择的任何运行时实现传递给 IImpl。

./亚历克斯

# silverlight - 有没有人在向基于 Silverlight 的项目中添加键盘快捷键方面有任何经验？

> ID：577393
> 
> 赞同：2
> 
> 时间：2009-02-23T11:51:15.970
> 
> 标签：silverlight, xaml, keyboard-shortcuts

只是想知道是否有人可以就在基于 Silverlight 的项目中实现键盘快捷键的最佳方式给我一些建议。

这可以从 xaml 完成还是最好在后面的代码中实现等等......

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T12:58:21.860

我通过在我正在制作的 UserControl 上添加一个事件处理程序来做到这一点。其他控件未处理的键冒泡到 UserControl，然后您可以通过后面的代码在那里处理它。

您可以在 XAML 中定义您的事件处理程序，但您需要在后面的代码中实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T10:11:58.710

[一个不错的针对游戏](http://www.bluerosegames.com/silverlight-games-101/post/Keyboard-Input-for-Silverlight-2-Games.aspx)的键盘捕捉教程

# database - 实体关系

> ID：577396
> 
> 赞同：0
> 
> 时间：2009-02-23T11:52:21.987
> 
> 标签：database

我已经开始为机器性能管理系统开发数据库事实：
1.一台机器（platNo,model,name）可以在多个甘蔗田（fieldNo,fieldNo）上工作 - 机器与田地 2.许多机器可以在甘蔗田上工作 3.一台机器可以为许多用户部门做任务（deptId,deptName） ) 4.A userDept 需要多台机器来执行其活动{一个任务可以在多个甘蔗田上完成；耕地、整地等可以在田地 1、2、3...- 任务与田地之间完成，许多任务可以在田地上完成；在字段 1 上，犁地、耙地、...可以完成 - 任务与田地？/？} 5.一台机器可以为许多用户部门做；lpcd（使用它的机器）可以为种植、修复和扩建项目做相同类型的工作（例如：耕作）。- 任务与用户部门 6\. 用户部门可以完成多种类型的任务；耕地、耙地……可以为种植园任务与用户 7 完成。一台机器分三班工作（1 到 3）

问题：请帮助我设计 ER！谢谢，德杰内

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T02:11:19.467

我假设 platNo 可以用作机器的唯一标识符。根据您留下模糊不清的规则，有很多可能性 - 例如，可能不需要或可能需要修改以下某些关系：

MACHINE (platNo, model, name) -*代表每台机器*

FIELD (fieldNo) -*代表每个甘蔗田*

TASK (taskId, taskName) -*表示可以由任何机器完成的各种任务（例如犁地、耙地）*

USERDEPT (deptId, deptName) -*代表每个部门*

PROJECT (projId, projName, deptId) -*代表每个部门的每个项目（例如种植、修复、扩建）*

SHIFT (shiftNo) -*表示任何机器可能分配到的班次*

MACHINE_FIELD (platNo, fieldNo) -*表示特定机器可以在特定的甘蔗田上工作*

MACHINE_TASK (platNo, taskId) -*表示特定机器可以执行特定任务的事实*

PROJECT_REQUIREMENT (projId, taskId) -*表示特定项目（针对特定部门）需要特定任务的事实*

MACHINE_ASSIGNMENT (projId, taskId, shiftNo, platNo) -*表示特定机器已被分配在给定班次执行特定任务的事实*

# c# - microsoft C# .net 接口疑惑

> ID：577398
> 
> 赞同：0
> 
> 时间：2009-02-23T11:52:37.573
> 
> 标签：c#, interface

如何指定接口成员的访问说明符？

我们可以通过两种方式使用接口

1.  继承（IsA 关系）
2.  包含在另一个类中（有 A 关系）。

以这种实现方式

protected 访问说明符仅适用于具有继承关系 (IsA) 的事件。

公共访问说明符应用于通常用作 Has A 关系（包含）的属性。

thz.. 吃饭..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T11:57:11.367

所有接口成员都自动公开。

如果继承和受保护的成员是您的目标，请改为从基类继承。如果组合是您的目标，请使用接口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T11:57:38.077

接口成员与他们所在的接口具有相同的访问运算符，这就是拥有接口的意义所在。否则你会有一个公共接口 IFoo，它有一个内部成员 Bar，如果代码想要针对 IFoo 编程，这将是有问题的：它不能总是访问 Bar，尽管它可以使用 IFoo：实现 IFoo 的类型显然没有' t 在那时实施 Bar。

因此，例如，如果您想拥有一些内部元素，请为这些成员使用内部接口。

# .net - 商业混淆器如何实现使 .net Reflector 和 ILDASM 崩溃？

> ID：577403
> 
> 赞同：2
> 
> 时间：2009-02-23T11:54:24.603
> 
> 标签：.net, obfuscation, reflector

一些商业混淆[器声称它们可以使 ILDASM](http://www.remotesoft.com/salamander/obfuscator.html)（以及其他类似的工具，如 Reflector）崩溃

**关于他们如何实现这一目标的任何想法？**

正如这里的许多线程中所述，有足够动力/时间/技能的人总能找到一种方法来阅读您的代码（也就是如果它是可运行的，它就是可反编译的），但在我看来，大多数普通的代码读者都不会费心反编译我的如果反射器不能为他们做代码。

对我的知识产权的这种保护水平（即，除了那些可能会想办法绕过我向他们投掷的每一个诡计的铁杆家伙之外的任何人）对我来说绝对足够了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T12:04:55.063

有些很可能会引入 CLR 能够运行但 ILDASM 等无法处理的无效 IL。在我看来，这是一件坏事——CLR 将来可能会抱怨它。

其他的很可能会创建有效的 IL，但由于某种方式的意外，它恰好会触发 ILDASM 和 Reflector。作为一个愚蠢的例子，假设一个标识符包含一个不可打印的字符。据我记得，这是有效的，因为 CLR 将标识符视为不透明的 blob，但试图显示它们的东西很可能会失败。这可能只是暂时的帮助——虽然 ILDASM 不经常更新，但 Reflector 经常更新，我希望开发人员在发现这些问题时能够解决此类问题。

第三种有助于防止高级反编译而不是反汇编的方法是创建 IL，它在 C#/VB 中没有明显的类似物，但它是完全有效的。事实上，[迭代器块有时已经这样做了](http://csharpindepth.com/Articles/Chapter6/IteratorBlockImplementation.aspx)（请看文章底部附近）。

我希望任何合法并保证可运行的东西现在或至少在将来的某个时候都可以拆卸（呃）。现在（或者更确切地说，在撰写营销宣传时）崩溃反射器并不是未来崩溃的良好迹象。

# c# - 如何在 .NET 中找到 NumLock、CapsLock 和 ScrollLock 的状态？

> ID：577411
> 
> 赞同：39
> 
> 时间：2009-02-23T11:58:38.713
> 
> 标签：c#, .net, capslock

如何在 .NET 中找到 NumLock、CapsLock 和 ScrollLock 键的状态？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-23T12:02:51.323

导入 WinAPI 函数*GetKeyState*：

```
[DllImport("user32.dll", CharSet = CharSet.Auto, ExactSpelling = true, CallingConvention = CallingConvention.Winapi)]
public static extern short GetKeyState(int keyCode); 
```

然后你可以像这样使用它：

```
bool CapsLock = (((ushort)GetKeyState(0x14)) & 0xffff) != 0;
bool NumLock = (((ushort)GetKeyState(0x90)) & 0xffff) != 0;
bool ScrollLock = (((ushort)GetKeyState(0x91)) & 0xffff) != 0; 
```

它适用于框架 1.1。对于框架 2.0（及更高版本），您可以使用：

[`Control.IsKeyLocked`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.iskeylocked(VS.80).aspx)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2011-05-26T07:37:42.213

使用 Framework 2.0 及更高版本，您可以使用框架功能：

*[Control.IsKeyLocked(Keys) 方法](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.control.iskeylocked#System_Windows_Forms_Control_IsKeyLocked_System_Windows_Forms_Keys_)*

```
public static bool NumlockActive()
{
    return Control.IsKeyLocked(Keys.NumLock);
} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2015-04-21T15:35:49.030

如果有人在 WPF 中开发时遇到此线程，您可以使用 .NET 3.0 中引入的[Keyboard.IsToggled](https://msdn.microsoft.com/en-us/library/system.windows.input.keyboard.iskeytoggled(v=vs.110).aspx)方法：

```
var isNumLockToggled = Keyboard.IsKeyToggled(Key.NumLock);
var isCapsLockToggled = Keyboard.IsKeyToggled(Key.CapsLock);
var isScrollLockToggled = Keyboard.IsKeyToggled(Key.Scroll); 
```

如果还没有，您必须将以下`using`指令添加到您的类的顶部：

```
using System.Windows.Input; 
```

Internally, the [IsToggled()](http://referencesource.microsoft.com/#PresentationCore/Core/CSharp/System/Windows/Input/Keyboard.cs,22f8500adfc561fb) method checks to see whether or not the [`KeyStates.Toggled`](http://referencesource.microsoft.com/#PresentationCore/Core/CSharp/System/Windows/Input/KeyStates.cs,78ceabc4eeaa31fc) flag is set for the specified key.

```
[Flags]
public enum KeyStates : byte
{
    None = (byte) 0,
    Down = (byte) 1,
    Toggled = (byte) 2,
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-04-08T10:16:31.347

**Check State**

To check state of `CapsLock`, `NumLock` and `ScrollLock` keys you can use [`Control.IsKeyLocked`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.control.iskeylocked?WT.mc_id=DT-MVP-5003235&view=netframework-4.8) method:

```
var capsLockIsOn = Control.IsKeyLocked(Keys.CapsLock); 
```

**Actively Show The State in UI in status bar**

Since the lock keys can be turn on or turn off when your application doesn't have focus handling keyboard events of the form is not enough to detect changes on the key lock state and you should also put your logic in some other places like activation event of your form or you need to register a global keyboard hook.

As a simple and reliable solution you can check their status in [`Application.Idle`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.application.idle?WT.mc_id=DT-MVP-5003235&view=netframework-4.8) event. You must detach your idle event handler when your form closed.

```
public Form1()
{
    InitializeComponent();
    Application.Idle += Application_Idle;
}

void Application_Idle(object sender, EventArgs e)
{
    if (Control.IsKeyLocked(Keys.CapsLock))
        toolStripStatusLabel1.Text = "CapsLock is On";
    else
        toolStripStatusLabel1.Text = "";
}

protected override void OnFormClosed(FormClosedEventArgs e)
{
    Application.Idle -= Application_Idle;
    base.OnFormClosed(e);
} 
```

# c++ - 同行之间的 C++ 友谊是否健康？

> ID：577421
> 
> 赞同：3
> 
> 时间：2009-02-23T12:02:28.140
> 
> 标签：c++, class-design, friend

虽然阶级友谊是 C++ 的最后手段之一，但这种模式有意义吗？

```
class Peer
{
public:
    friend class Peer;
    void GetSecret(const Peer& other)
    {
        const std::string& secret = other.GiveSecret();
        std::cout << secret << std::endl;
    }

private:
    const std::string& GiveSecret() const
    {
        return "secrety stuff";
    }
};

int main(int argc, char* argv[])
{
    Peer peerA;
    Peer peerB;
    peerA.GetSecret(peerB);
    return 0;
} 
```

好的，这种模式的原因是因为 Peers 都是相同级别的，他们需要相互共享知识，但是这个知识是秘密的，因为除了 peer 之外没有人应该使用它，或者程序不再有效.

一个非常真实的例子是，当一个对等点从另一个对等点复制构建时，它需要从其源对等点访问秘密信息，但同样没有理由让其他任何人知道这些内部结构，只有对等点。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-23T12:11:10.757

在这种情况下，朋友是不必要的。一个类的对象可以访问任何其他同类型对象的私有成员。如果没有朋友声明，它应该可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T12:51:02.050

标准 c++ 说 private 子句具有类范围。这意味着每个 Peer 都可以访问任何其他 Peer 的私有部分。这不是特定于实现的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T14:27:37.527

虽然你已经发现在这种情况下不需要友谊，但我只想说，与上述观点相反，合作阶级之间的友谊原则上没有错。事实上，友谊可能实际上促进了它，而不是打破封装。

考虑为私有数据创建访问器方法的替代方法。如果你这样做了，那么你就可以有效地访问所有客户端的私有数据，而不仅仅是声明为朋友的有限的类/函数集。如果您的朋友类中只有一个方法要访问您的内部，则封装减少的数量与您提供公共访问器方法的数量完全相同。但是，提供公共访问器方法的结果将是更多的客户将使用方法。

对于我们编写的每个应用程序类，都有一个影子类，它是类单元测试。单元测试类是应用程序类的朋友，因为它经常需要调用类上的方法，然后检查类内部，或者调用私有方法。通过成为朋友类封装得以维护。

无论如何，为了进行良好的讨论，请参见此处： [http ://www.ddj.com/cpp/184401197](http://www.ddj.com/cpp/184401197)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T16:31:07.747

既然我已经说了我关于继承的文章，这里有一些可能有助于解决你真正的问题，即如何解决友谊的潜在问题。

我这样做的方法是创建一个纯界面来访问我想与我的“朋友”分享的数据。然后我私下实现这个接口，所以没有人可以直接访问它。最后，我有一些机制允许我将接口的引用仅传递给那些我想要允许的选择类。

例如：

```
// This class defines an interface that allows selected classes to
// manipulate otherwise private data.
class SharedData
{
public:
    // Set some shared data.
    virtual void SettorA(int value) = 0;

    // Get some shared data.
    virtual bool GettorB(void) const;
};

// This class does something with the otherwise private data.
class Worker
{
public:
    void DoSomething(SharedData & data)
    {
        if (data.GettorB() == true)
        {
            data.SettorA(m_id);
        }
    }

private:
    int m_id;
};

// This class provides access to its otherwise private data to
// specifically selected classes.  In this example the classes
// are selected through a call to the Dispatch method, but there
// are other ways this selection can be made without using the
// friend keyword.
class Dispatcher
    : private SharedData
{
public:
    // Get the worker to do something with the otherwise private data.
    void Dispatch(Worker & worker)
    {
        worker.DoSomething(*this);
    }

private:
    // Set some shared data.
    virtual void SettorA(int value)
    {
        m_A = value;
    }

    // Get some shared data.
    virtual bool GettorB(void) const
    {
        return (m_B);
    }

    int    m_A;
    bool   m_B;
}; 
```

在这个例子中，SharedData 是一个接口，它决定了可以对数据做什么，即可以设置什么，什么是只能获取的。Worker 是一个允许访问这个特殊接口的类。Dispatcher 以私有方式实现接口，因此访问 Dispatcher 实例不会让您访问特殊的共享数据，但 Dispatcher 有一个方法可以让 Workers 获得访问权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T12:05:16.293

不健康，它打破了封装的最佳实践

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T12:08:50.997

> 这种模式有意义吗

不多。你能详细说明吗？

*   您通常在不同的班级之间建立友谊。这在语法上是有效的。为什么 Peer 会成为 Peer 的朋友？
*   私有函数只能由成员函数使用。从客户端代码调用它们是错误的。

至于友谊是否打破封装的问题，请查看[FAQ](http://www.parashift.com/c++-faq-lite/friends.html#faq-14.2)。

对不起罗伯特，误读了名字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T12:34:48.203

> 不健康，它打破了封装的最佳实践

嗯，是的，也不是。

如果您不使用方法来访问您需要的数据，它只会破坏封装。

并不是说封装只是一种保护外部类的方法，以防您更改实现细节时必须重写。如果您碰巧更改了实现，那么无论如何您都必须重做您的课程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T15:58:12.787

首先我想说的是，通过继承，一个好的类层次结构不需要为了让诸如复制构造函数或运算符重载之类的东西工作而公开私有数据。例如：

```
class Sub
    : public Base
{
public:
    Sub(const std::string & name)
        : Base(),
          m_name(name)
    {
    }

    Sub(const Sub & src)
        : Base(src),
          m_id(src.m_name)
    {
    }

    Sub & operator=(const Sub & rhs)
    {
        if (&rhs != this)
        {
            Base::operator=(rhs);

            m_name = rhs.m_name;
        }

        return (this);
    }

protected:
    virtual Debug(void)
    {
        std::cout << "Sub [m_name = " << m_name << "]" << std::endl
                  << "+- ";

        Base::Debug();
    }

private:
    std::string m_name;
};

class Base
{
public:
    Base(int id)
        : m_id(id)
    {
    }

    Base(const Base & src)
        : m_id(src.m_id)
    {
    }

    Base & operator=(const Base & rhs)
    {
        if (&rhs != this)
        {
            m_id = rhs.m_id;
        }

        return (this);
    }

protected:
    virtual Debug(void)
    {
        std::cout << "Base [m_id = " << m_id << "]" << std::endl;
    }

private:
    int m_id;
}; 
```

在此示例中，子类能够在复制构造函数和赋值运算符中实例化其基成员。即使是过度设计的 Debug 方法也可以在无法访问基类的私有成员的情况下工作。

# c++ - 将数组值保存到双变量中

> ID：577423
> 
> 赞同：0
> 
> 时间：2009-02-23T12:03:31.167
> 
> 标签：c++, arrays, operators

大家好。编译包含以下函数的脚本时出现问题。发生三个错误，都在我将距离 += 设置为距离 [][] 的同一行上：

错误 C2108: 下标不是整数类型 错误 C2108: 下标不是整数类型 错误 C2297: '+=' : 非法，右操作数的类型为 'double (*)[15]'

援助将不胜感激。

```
double S_initial;

double distances [15][15]; 
double order [15];
void Initialize() 
{
    double x, y ,z;

    double distance = 0;

    for (int i = 0; i <= 14; i++)
    {
        x =  order [i];
        y =  order [i + 1];

        distance += distances [x][y];
    }

    S_initial = distance;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T12:11:50.943

好吧，数组下标`x`和`y`不是整数类型，例如`int`，而是类型`double`：

```
double x, y, z;
...
distance += distances[x][y]; 
```

像数组的第 1.46534 个元素这样的东西没有意义，所以编译器会抱怨。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T12:10:50.383

x 和 y 不是整数...您需要将整数作为数组下标传递。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T12:09:43.913

停止使用 double 并改用 int 。

或者，如果您必须在 order 数组中使用 double，则需要决定如何将可能找到的任何非整数值舍入为 int。Math.Floor、Math.Ceiling 等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T12:16:06.923

您不能使用浮点数来索引数组。使用 int 甚至更好的 size_t。

```
 for (int i = 0; i <= 14; i++)
{
    x =  order [i];
    y =  order [i + 1]; /* when i = 14, you invoke UB */

    distance += distances [x][y];
} 
```

进入第二部分：

```
double order [15]; 
```

未初始化，因此在使用时调用 UB。

# c# - 在c#中均匀划分

> ID：577427
> 
> 赞同：5
> 
> 时间：2009-02-23T12:03:44.473
> 
> 标签：c#

在 c# 中，我如何将 100 平均分为 7？

所以结果是

1.  16
2.  14
3.  14
4.  14
5.  14
6.  14
7.  14

下面的代码不正确，因为所有 7 个值都设置为 15（总共 105）。

```
 double [] vals = new double[7];
        for (int i = 0; i < vals.Length; i++)
        {
            vals[i] = Math.Ceiling(100d / vals.Length);
        } 
```

有没有一种简单的方法可以在 c# 中做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-23T12:13:49.813

要获得我建议的 15、15、14、14、14、14、14 的结果：

```
// This doesn't try to cope with negative numbers :)
public static IEnumerable<int> DivideEvenly(int numerator, int denominator)
{
    int rem;
    int div = Math.DivRem(numerator, denominator, out rem);

    for (int i=0; i < denominator; i++)
    {
        yield return i < rem ? div+1 : div;
    }
}

Test:

foreach (int i in DivideEvenly(100, 7))
{
    Console.WriteLine(i);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-23T12:48:04.817

干得好：

```
Func<int, int, IEnumerable<int>> f = (a, b) => 
 Enumerable.Range(0,a/b).Select((n) => a / b + ((a % b) <= n ? 0 : 1)) 
```

祝你好运在课堂上解释它:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-23T12:07:15.353

由于这似乎是作业，这里是一个提示，而不是完整的代码。

您正在执行 Math.Ceiling 并将 14.28 转换为 15。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T12:13:26.587

算法是这样的

1.  将 100 除以 7，将结果放入 X
2.  取 X 以下的最大偶数并将其放入 Y。
3.  将 Y 乘以 7 并将答案放在 Z 中。
4.  将 Z 从 100 移开。

答案是 6 手 Y 加上第 4 步的结果。

此算法可能仅适用于此特定实例。

我确定你可以用 C# 编写它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T12:16:08.500

不确定这是否正是你所追求的，但我认为如果你使用 Math.ceiling，你最终会得到太大的总数。Math.floor 会低估并留下您认为合适的差异，可以添加到您的作品中。

例如，通过这种方法，您最终可能会得到 14 的 7 手，剩下的 2。然后，您可以将这 2 放入您的一块中，给出您建议的答案，或者您可以将其平均拆分并添加 get两件 15 件（如其中一条评论中所建议的）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T12:19:00.893

不知道为什么你使用双打但想要整数除法语义。

```
 double input = 100;
    const int Buckets = 7;
    double[] vals = new double[Buckets];
    for (int i = 0; i < vals.Length; i++)
    {
        vals[i] = Math.Floor(input / Buckets);
    }
    double remainder = input % Buckets;
    // give all of the remainder to the first value
    vals[0] += remainder; 
```

例如具有更大灵活性的整数，

```
 int input = 100;
    const int Buckets = 7;
    int [] vals = new int[Buckets];
    for (int i = 0; i < vals.Length; i++)
    {
        vals[i] = input / Buckets;
    }
    int remainder = input % Buckets;
    // give all of the remainder to the first value
    vals[0] += remainder;

    // If instead  you wanted to distribute the remainder evenly, 
    // priority to first
    for (int r = 0; r < remainder;r++)
    {
        vals[r % Buckets] += 1;
    } 
```

值得指出的是，双重示例**可能在数值上不稳定**，因为某些输入值和存储桶大小可能会导致小数值泄漏。

# c# - 哪个PID在c＃中的给定端口上侦听

> ID：577433
> 
> 赞同：6
> 
> 时间：2009-02-23T12:05:29.507
> 
> 标签：c#, windows

获取侦听 C# 中给定端口的 PID 的最简单方法是什么？基本上，我想确保我的服务正在运行并监听我提供的端口。如果有比解析 netstat 输出更简单的方法，那就太好了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-23T13:37:48.100

从 win XP SP2 开始，您可以 P/Invoke 到[GetExtendedTcpTable](http://www.pinvoke.net/default.aspx/iphlpapi/GetExtendedTcpTable.html)

使用[This person's](http://convert.codes-sources.com/file2cs.aspx?ID=48860&f=YAPM%2FClasses%2FcNetwork.vb) kind work 来充实签名（PInvoke.net 规范不完整）这是一个（粗略且不擅长错误检查）示例

```
using System;
using System.Runtime.InteropServices;

public enum TCP_TABLE_CLASS : int
{
    TCP_TABLE_BASIC_LISTENER,
    TCP_TABLE_BASIC_CONNECTIONS,
    TCP_TABLE_BASIC_ALL,
    TCP_TABLE_OWNER_PID_LISTENER,
    TCP_TABLE_OWNER_PID_CONNECTIONS,
    TCP_TABLE_OWNER_PID_ALL,
    TCP_TABLE_OWNER_MODULE_LISTENER,
    TCP_TABLE_OWNER_MODULE_CONNECTIONS,
    TCP_TABLE_OWNER_MODULE_ALL
} 

[StructLayout(LayoutKind.Sequential)]
public struct MIB_TCPROW_OWNER_PID
{
    public uint state;
    public uint localAddr;
    public byte localPort1;
    public byte localPort2;
    public byte localPort3;
    public byte localPort4;
    public uint remoteAddr;
    public byte remotePort1;
    public byte remotePort2;
    public byte remotePort3;
    public byte remotePort4;
    public int owningPid;

    public ushort LocalPort
{
        get
        {
            return BitConverter.ToUInt16(
                new byte[2] { localPort2, localPort1}, 0);
        }
    }

    public ushort RemotePort
    {
        get
        {
            return BitConverter.ToUInt16(
                new byte[2] { remotePort2, remotePort1}, 0);
        }
    }
}

[StructLayout(LayoutKind.Sequential)]
public struct MIB_TCPTABLE_OWNER_PID
{
    public uint dwNumEntries;
    MIB_TCPROW_OWNER_PID table;
}

[DllImport("iphlpapi.dll", SetLastError=true)]
static extern uint GetExtendedTcpTable(IntPtr pTcpTable, 
    ref int dwOutBufLen, 
    bool sort, 
    int ipVersion, 
    TCP_TABLE_CLASS tblClass,
    int reserved);

public static MIB_TCPROW_OWNER_PID[] GetAllTcpConnections()
{
    MIB_TCPROW_OWNER_PID[] tTable;
    int AF_INET = 2;    // IP_v4
    int buffSize = 0;

    // how much memory do we need?
    uint ret = GetExtendedTcpTable(IntPtr.Zero, 
        ref buffSize, 
        true, 
        AF_INET, 
        TCP_TABLE_CLASS.TCP_TABLE_OWNER_PID_ALL,
        0);        
    if (ret != 0 && ret != 122) // 122 insufficient buffer size
        throw new Exception("bad ret on check " + ret);
    IntPtr buffTable = Marshal.AllocHGlobal(buffSize);

    try
    {
        ret = GetExtendedTcpTable(buffTable, 
            ref buffSize, 
            true, 
            AF_INET, 
            TCP_TABLE_CLASS.TCP_TABLE_OWNER_PID_ALL, 
            0);
        if (ret != 0)
            throw new Exception("bad ret "+ ret);        

        // get the number of entries in the table
        MIB_TCPTABLE_OWNER_PID tab = 
            (MIB_TCPTABLE_OWNER_PID)Marshal.PtrToStructure(
                buffTable, 
                typeof(MIB_TCPTABLE_OWNER_PID));
         IntPtr rowPtr = (IntPtr)((long)buffTable + 
             Marshal.SizeOf(tab.dwNumEntries));
        tTable = new MIB_TCPROW_OWNER_PID[tab.dwNumEntries];

        for (int i = 0; i < tab.dwNumEntries; i++)
        {
            MIB_TCPROW_OWNER_PID tcpRow = (MIB_TCPROW_OWNER_PID)Marshal
                .PtrToStructure(rowPtr, typeof(MIB_TCPROW_OWNER_PID));
            tTable[i] = tcpRow;
            // next entry
            rowPtr = (IntPtr)((long)rowPtr + Marshal.SizeOf(tcpRow));   
        }
    }
    finally
    {
        // Free the Memory
        Marshal.FreeHGlobal(buffTable);
    }
    return tTable;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T12:35:28.657

看看这个项目： http: [//www.codeproject.com/KB/IP/iphlpapi.aspx](http://www.codeproject.com/KB/IP/iphlpapi.aspx)

它使用 C# 中的 Interop 来访问底层的 GetTcpTable Win API 函数。因此可以为您提供您正在寻找的进程ID。

希望有帮助，亚历克斯

# visual-studio-2008 - TFS 不允许文件夹重命名，声称有锁

> ID：577443
> 
> 赞同：4
> 
> 时间：2009-02-23T12:11:16.170
> 
> 标签：visual-studio-2008, version-control, tfs, file-locking

在 Visual Studio 2008 中，由于名称中的拼写错误，我想重命名文件夹。我在解决方案结构中重命名它。文件夹和 .CSProj 文件现在已签出，我签入。

TFS 返回“Microsoft Visual Studio 目前无法执行源代码管理操作，因为该操作涉及的某些文件已锁定。请稍后重试该操作”。

查看源代码管理资源管理器，我可以确认文件夹和其中的文件根本没有被签出。.csproj 和 csproj.vspscc 由另一位用户“编辑”。

这里发生了什么？

如果我尝试撤消更改，我会收到相同的消息。在撤消更改之前，我必须强制获取最新版本。这也是怎么回事？

最终的解决方法是让所有其他用户签入 .csproj，然后在源代码管理资源管理器中重命名文件夹。在这一点上，它起作用了，尽管以前没有起作用。

重命名签入成功，并且在后续签入中清除了对旧名称的引用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T19:53:52.473

如果您正在重命名的文件夹中的某个文件已签出，则 TFS 无法将该文件移动到新位置。

对于任何文件夹重命名操作，每个人都必须退出项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T12:13:52.560

如果 Visual Studio 开始出现异常，请直接在 TFS 源代码管理中尝试。上周我遇到了类似的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-30T18:46:46.227

不要尝试在解决方案打开的情况下签入对象，而是打开没有 sln 的 Visual Studio，转到团队资源管理器并导航到目标解决方案的源代码管理文件夹。

从源代码管理资源管理器窗口签入。

您现在可以签入。享受。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T19:41:56.417

在撤消将其重命名为旧名称之前，它将更新 TFS 项目名称。之后撤消您的项目更改。用其他名称保存当前解决方案后，我遇到了类似的问题。它创建了一个新的解决方案，但同时它在 TFS 中检出旧解决方案，将其重命名为新解决方案，并且不允许撤消检出的重命名。为了解决它，我加载了新的（重命名的）解决方案，然后用旧名称将其保存回来。它将结帐解决方案更改为以前的名称，之后我可以分两步撤消它：

1.  撤消.sln，之后
2.  撤消.vssscc

BR

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T10:51:55.167

我也是，我在重命名文件夹时遇到问题。对我来说，建议的方法都不起作用。由于问题似乎只出在我的客户身上，而其他团队成员的客户都没有，这似乎是客户问题。所以我重命名了本地源目录并再次获取所有内容，但没有帮助。我重新安装了 TFS 客户端，也没有帮助。

但至少我找到了一种方法，即先关闭解决方案然后签入。这是我现在重命名任何文件夹的唯一方法。有谁知道为什么会这样以及我该如何解决？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-26T11:29:49.933

通过转到文件-> 关闭解决方案来关闭解决方案，然后尝试签入文件。这种方法对我有用

# ruby - 如何在 Ruby 中从 Berkeley DB 中检索所有记录

> ID：577447
> 
> 赞同：2
> 
> 时间：2009-02-23T12:12:29.973
> 
> 标签：ruby, berkeley-db

我希望能够使用来自[http://github.com/mattbauer/bdb/tree/master](http://github.com/mattbauer/bdb/tree/master)的 Ruby 绑定来获取存储在 Berkeley DB 中的所有键值，但我不确定如何继续。任何指针将不胜感激。

**更新**

这是一个循环遍历键并打印它们的小脚本。根据 Pax 的回答：

```
require 'rubygems'
require 'bdb'

env = Bdb::Env.new(0)
env.open('foo', Bdb::DB_CREATE,0)

db = env.db
db.open(nil, 'db1.db', nil, Bdb::Db::BTREE, Bdb::DB_CREATE,0)

db.put(nil, 'key',  'value',  0)
db.put(nil, 'key1', 'value1', 0)
db.put(nil, 'key2', 'value2', 0)

dbc = db.cursor(nil,0)
key,val = dbc.get(nil,nil,Bdb::DB_FIRST)
while key
  p key,val
  key,val = dbc.get(nil,nil,Bdb::DB_NEXT)
end
dbc.close
db.close(0)
env.close 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T05:46:34.543

您需要在 Berkeley DB 中使用游标来遍历整个键/值空间。

在 Berkeley DB 本身中，您将创建一个游标，然后将其与`DB_FIRST`标志一起使用，然后使用标志进行多次调用，`DB_NEXT`直到用完键/值对。您可以通过仅使用来简化代码，`DB_NEXT`因为如果您对新创建的游标执行此操作，则与使用`DB_FIRST`.

使用 Ruby 绑定，这似乎可以完成（基于我*对*Ruby 的基本知识 - 你应该能够清理它）：

```
dbc = db.cursor(nil,0)
key,val = dbc.get(nil,nil,Bdb::DB_FIRST)
while key != nil do
   # Process key and val as needed.
   key,val = dbc.get(nil,nil,Bdb::DB_NEXT)
   # or possibly .. (key,val,Bdb::DB_NEXT)
end
dbc.close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-21T10:57:20.267

[这对我有用](https://stackoverflow.com/questions/2214838/how-to-read-perl-db-files-in-ruby/2218182#2218182)：

```
require 'bdb'
db=BDB::Hash.open("test.db")
keyvalues=db.to_hash 
```

# c# - C# 中的事务

> ID：577449
> 
> 赞同：6
> 
> 时间：2009-02-23T12:12:59.147
> 
> 标签：c#, methods, transactions

除了这个问题：[Preorder tree traversal copy folder](https://stackoverflow.com/questions/577080/preorder-tree-traversal-copy-folder) 我想知道是否可以创建一个包含对数据库的不同调用的事务。

前任：

```
public bool CopyNode(int nodeId, int parentNode)
    { 
        // Begin transaction.
        try
        {
            Method1(nodeId);
            Method2(nodeId, parentNode);
            Method3(nodeId);
        }
        catch (System.Exception ex)
        { 
            //rollback all the methods
        }
    } 
```

我不知道这是否可能。我们正在使用亚音速进行数据库调用。这真的很重要，不仅对于树遍历问题，而且对于我们所做的其他一些事情。

主要思想是我们不能让我们的数据库被不完整的数据破坏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T12:16:23.380

[这是可能的，你可以在这里](http://www.knowdotnet.com/articles/transactions.html)找到一个例子

或者也许是一个事务范围......

[http://msdn.microsoft.com/en-us/library/ms172152.aspx](http://msdn.microsoft.com/en-us/library/ms172152.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-13T02:14:54.157

BeginTransaction 从 ADO.NET 集合对象中调用。Command 对象需要将此事务（SqlTransaction 对象）分配给它。Commit 和 Rollback 仅在外部方法中调用。

查看此代码。它通过重新使用 SqlConnection 和 SqlTransaction 对象来工作。这是经典的 Master>Details 类型的设置。主类型`ColumnHeaderSet`包含以下属性

> `List<ColumnHeader>`

，即细节（集合）。

希望这可以帮助。-JM

```
public static int SaveColumnHeaderSet(ColumnHeaderSet set)
      //save a ColumnHeaderSet
      {       
         string sp = ColumnSP.usp_ColumnSet_C.ToString();    //name of sp we're using
         SqlCommand cmd = null;
         SqlTransaction trans = null;
         SqlConnection conn = null;

         try
         {
            conn = SavedRptDAL.GetSavedRptConn();  //get conn for the app's connString
            cmd = new SqlCommand(sp, conn);
            cmd.CommandType = CommandType.StoredProcedure;
            conn.Open();
            trans = conn.BeginTransaction();
            cmd.Transaction = trans;   // Includes this cmd as part of the trans

            //parameters
            cmd.Parameters.AddWithValue("@ColSetName", set.ColSetName);
            cmd.Parameters.AddWithValue("@DefaultSet", 0);
            cmd.Parameters.AddWithValue("@ID_Author", set.Author.UserID);   
            cmd.Parameters.AddWithValue("@IsAnonymous", set.IsAnonymous);         
            cmd.Parameters.AddWithValue("@ClientNum", set.Author.ClientNum);
            cmd.Parameters.AddWithValue("@ShareLevel", set.ShareLevel);
            cmd.Parameters.AddWithValue("@ID_Type", set.Type);

            //add output parameter - to return new record identity
            SqlParameter prm = new SqlParameter();
            prm.ParameterName = "@ID_ColSet";
            prm.SqlDbType = SqlDbType.Int;
            prm.Direction = ParameterDirection.Output;
            cmd.Parameters.Add(prm);

            cmd.ExecuteNonQuery();
            int i = Int32.Parse(cmd.Parameters["@ID_ColSet"].Value.ToString());
            if (i == 0) throw new Exception("Failed to save ColumnHeaderSet");
            set.ColSetID = i; //update the object

            //save the ColumnHeaderList (SetDetail)
            if (ColumnHeader_Data.SaveColumnHeaderList(set, conn, trans)==false) throw new Exception("Failed to save ColumnHeaderList");
            trans.Commit();

            // return ID for new ColHdrSet
            return i;
         }
         catch (Exception e){
            trans.Rollback();
            throw e;
         }
         finally{
            conn.Close();
         }
      }

 public static bool SaveColumnHeaderList(ColumnHeaderSet set, SqlConnection conn, SqlTransaction trans)
      //save a (custom)ColHeaderList for a Named ColumnHeaderSet
      {
         // we're going to accept a SqlTransaction to maintain transactional integrity
         string sp = ColumnSP.usp_ColumnList_C.ToString();    //name of sp we're using 
         SqlCommand cmd = null;
         try
         {
            cmd = new SqlCommand(sp, conn);     // re-using the same conection object
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.Transaction = trans;            // includes the cmd in the transaction

            //build params collection (input)
            cmd.Parameters.Add("@ID_ColSet", SqlDbType.Int);
            cmd.Parameters.Add("@ID_ColHeader", SqlDbType.Int);
            cmd.Parameters.Add("@Selected", SqlDbType.Bit);
            cmd.Parameters.Add("@Position", SqlDbType.Int);

            //add output parameter - to return new record identity
            //FYI - @return_value = @ID_SavedRpt
            SqlParameter prm = new SqlParameter();
            prm.ParameterName = "@ID";
            prm.SqlDbType = SqlDbType.Int;
            prm.Direction = ParameterDirection.Output;
            cmd.Parameters.Add(prm);

            //Loop
            foreach (ColumnHeader item in set.ColHeaderList)
            {
               //set param values
               cmd.Parameters["@ID_ColSet"].Value = set.ColSetID; 
               cmd.Parameters["@ID_ColHeader"].Value = item.ColHeaderID; 
               cmd.Parameters["@Selected"].Value = item.Selected;
               cmd.Parameters["@Position"].Value = item.Position;

               cmd.ExecuteNonQuery();
               int i = Int32.Parse(cmd.Parameters["@ID"].Value.ToString());
               if (i == 0) throw new Exception("Failed to save ColumnHeaderSet");
            } 
            return true;
         }
         catch (Exception e)
         {
            throw e;            
         }

      } 
```

# c# - c#相当于php关联数组？

> ID：577460
> 
> 赞同：4
> 
> 时间：2009-02-23T12:16:35.720
> 
> 标签：c#, .net, php

> **可能重复：**
> [C# 关联数组](https://stackoverflow.com/questions/1915347/c-sharp-associative-array)

我最近决定学习 c#。我之前做过一些 php。我看到 c# 有字典。这相当于php中的关联数组对吗？据我所知，字典不会像 php 关联数组那样维护插入顺序，对吗？如果插入顺序很重要，我应该使用其他等价物吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T12:22:16.237

字典不*保证*保留插入顺序，所以不：你不能依赖它（尽管很难强迫它打破这个）。如果插入顺序很重要，您将需要创建一个混合类，可能`List<T>`为插入顺序封装 a ，`Dictionary<TKey,T>`为索引封装 a 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T12:22:49.637

您可能想查看[Power Collections](http://www.codeplex.com/PowerCollections)。我相信他们有满足您需求的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T14:40:47.123

命名空间中有一个[OrderedDictionary](http://msdn.microsoft.com/en-us/library/system.collections.specialized.ordereddictionary.aspx)类`System.Collections.Specialized`，但不幸的是它不是通用的。

没有保留插入顺序的内置通用字典类。如果插入顺序真的很重要，您将不得不自己推出或检查第三方实施（正如 Marc & Kent 建议的那样）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-01T21:19:22.430

PHP 关联数组被转换为 XmlRpcStruct 类型。请参阅[XML-RPC 规范。](http://www.xmlrpc.com/spec/)

在 C# 中，使用 XmlRpcStruct 或 struct 来表示 PHP 关联数组。

这是一个经过测试的解决方案，而不是临时建议。

# algorithm - 找出两个字符串的相似程度

> ID：577463
> 
> 赞同：37
> 
> 时间：2009-02-23T12:18:17.230
> 
> 标签：algorithm, string-matching

我正在寻找一种算法，它需要 2 个字符串，并会给我一个“相似性因素”。

基本上，我将有一个可能拼写错误的输入，有字母转置等，我必须在我拥有的可能值列表中找到最接近的匹配项。

这不适用于在数据库中搜索。我将有一个包含 500 个左右的字符串的内存列表来匹配，所有字符串都在 30 个字符以下，所以它可能相对较慢。

我知道它存在，我以前见过它，但我不记得它的名字了。

* * *

编辑：感谢您指出 Levenshtein 和 Hamming。现在，我应该实施哪一个？它们基本上测量不同的东西，两者都可以用于我想要的东西，但我不确定哪个更合适。

我已经阅读了算法，汉明似乎明显更快。由于两者都不会检测到两个字符被转置（即 Jordan 和 Jodran），我认为这将是一个常见错误，这对于我想要的更准确？有人能告诉我一些关于权衡的事情吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-23T13:00:51.090

好的，所以标准算法是：

1）[汉明距离](http://en.wikipedia.org/wiki/Hamming_distance) 只适用于相同长度的字符串，但非常有效。基本上它只是计算不同字符的数量。对于自然语言文本的模糊搜索无用。

2）[莱文斯坦距离](http://en.wikipedia.org/wiki/Levenshtein_distance)。Levenstein 距离根据将一个字符串转换为另一个字符串所需的“操作”数量来衡量距离。这些操作包括插入、删除和替换。计算 Levenstein 距离的标准方法是使用动态规划。

3）[广义Levenstein/（Damerau-Levenshtein距离）](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance) 这个距离也考虑了单词中字符的换位，可能是最适合手动输入文本模糊匹配的编辑距离。计算距离的算法比 Levenstein 距离要复杂一些（检测转置并不容易）。最常见的实现是对[bitap](http://en.wikipedia.org/wiki/Bitap_algorithm)算法的修改（如 grep）。

一般来说，您可能需要考虑在基于 kd 树的某种最近邻搜索中实现的第三个选项的实现

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T12:25:49.553

*   列文斯坦距离
*   汉明距离
*   声音
*   变音器

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T12:55:57.483

Damerau [-Levenshtein 距离](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)类似于 Levenshtein 距离，但也包括两个字符的换位。维基百科页面（链接）包含应该很容易实现的伪代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T12:23:00.650

您正在寻找[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)

# c++ - 在 C++ 中，我可以从结构派生一个类吗

> ID：577465
> 
> 赞同：30
> 
> 时间：2009-02-23T12:19:01.177
> 
> 标签：c++, data-structures

这个问题真的说明了一切。我是否允许从结构派生一个类，或者我应该创建一个嵌入我的结构并定义复制构造函数和 = 运算符以在两者之间移动的类？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-23T12:20:43.683

在 C++`struct`中（几乎）是 a 的同义词`class`（除了不同的默认访问级别），所以是的，你可以。

```
struct A {
// fields are public by default
};

class B: public A {
// fields are private by default
}; 
```

我不熟悉 MFC，但它看起来像是在尝试同时维护 C 和 C++ API。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-23T12:23:04.707

你当然是。关于继承的不同之处在于，如果您定义一个类，它将从其他类/结构继承私有。如果您定义一个结构并从一个类或结构派生它，则默认情况下它将是公共继承：

```
// the following two are equivalent except that one time class is 
// used and the other time struct
struct f : g { };
class f : public g { }; 
```

如果您想知道如何包装 C 结构 - 我会将它们作为成员嵌入到类中。因为 C 结构的设计不是为了继承自（想想 C 结构中的既不是受保护的也不是虚拟的析构函数——它们不能有一个）。它们是收集数据的简单聚合。并将它们作为成员使用它们（例如“一个点具有一对 x 和一个 y 坐标”）。

C 结构还公开了可能不应该在类中公开的成员。包含允许通过 get/set 函数精确控制公开的内容和不公开的内容，您仍然可以让它为您提供对包含的裸 C 结构对象的副本或引用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-23T15:52:05.203

是的。您可以从结构派生一个类。在 C++ 中，结构只是一个默认访问是公共而不是私有的类。从仅添加非虚拟成员函数和/或静态函数的结构派生类是提供 C++ 接口同时保持与 C 样式 API 的兼容性的有用技术。

这正是 MFC 用于许多 C 结构的方法（与您在问题中所说的相反）。

例如，CRect 类是从 struct tagRECT 公开派生的（更常用的名称 RECT 是 struct tagRECT 的 typededf）。因为 struct tagRECT 定义了所有数据成员，而 CRect 只添加了非虚拟成员函数，所以 CRect 和 RECT 的内存布局是相同的 - 您可以使用 CRect 作为任何预期为 RECT 的函数的参数，反之亦然。

# internet-explorer - 经典asp中的ie7和UTF8问题

> ID：577466
> 
> 赞同：1
> 
> 时间：2009-02-23T12:19:36.743
> 
> 标签：internet-explorer, asp-classic, utf-8

我遇到了 utf-8 在 ie7 中作为正方形出现的问题。它在 firefox、opera、camino 和 safari 中运行良好。

我尝试使用的众多字符之一是 ✱ - 即`&#10033;`. IE7 在此表示法中使用的字符或从数据库中提取的字符存在此问题（所有其他浏览器都正确显示字符）。

我的头包含以下元标记：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
```

我还在回复中发送了以下命令：

```
Response.CodePage = 65001
Response.CharSet = "utf-8" 
```

我似乎无法让它工作，不幸的是我最大的用户群正在使用 IE。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T12:49:55.780

听起来您的 IE7 版本有问题；）如果所有其他浏览器都可以正常工作而 IE7 不能...

顺便说一句，您在问题中提到的类似“明星”的角色在我机器上的 IE7 中看起来不错...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T00:36:09.237

值得仔细检查 IE7 设置为什么编码，您是否将其设置为自动还是设置为使用不同的字符集？有时只需将其重置为自动即可解决问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-16T12:31:09.693

您是否记得将文件保存为 UTF-8 格式？这也可能有所作为...

# python - 在 Windows 上结束时如何暂停脚本？

> ID：577467
> 
> 赞同：55
> 
> 时间：2009-02-23T12:20:26.820
> 
> 标签：python, windows, cmd, command-line

我从 Windows 任务栏运行命令行 Python 脚本，方法是使用指向 Python 解释器的快捷方式，并将实际脚本作为参数。

处理完脚本后，解释器终止并关闭输出窗口，这使得无法读取脚本输出。

在按下任何键之前保持解释器窗口打开的最直接方法是什么？

在批处理文件中，可以用暂停来结束脚本。我在 python 中找到的最接近这个的`raw_input()` *是次优的*，因为它需要按返回键（而不是任何键）。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-23T12:30:06.483

一种方法是`raw_input()`在末尾保留 a，以便脚本在终止之前等待您按 Enter。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2010-11-09T04:41:40.850

试试`os.system("pause")`——我用过它，它对我有用。

确保包含`import os`在脚本的顶部。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-23T12:29:39.153

关闭前无需等待输入，只需像这样更改您的命令：

```
cmd /K python <script> 
```

开关将执行随后`/K`的命令，但命令解释器窗口保持打开状态，相比之下`/C`，它执行然后关闭。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-03-06T17:44:46.080

最好的选择：`os.system('pause')`<-- 这实际上会显示一条消息，说“按任意键继续”，而添加只是`raw_input('')`不会打印任何消息，只有光标可用。

与答案无关：

`os.system("some cmd command")`是一个非常棒的命令，因为该命令可以执行任何批处理文件/cmd 命令。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-23T12:51:41.020

> 一种方法是在末尾保留 raw_input() ，以便脚本在终止之前等待您按 Enter 键。

使用 raw_input() 而不是 msvcrt.* 的好处是前者是标准 Python 的一部分（即绝对跨平台）。这也意味着双击脚本文件图标后，脚本窗口将处于活动状态，无需执行

```
cmd /K python <script> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-23T12:28:33.133

在 Windows 上，您可以使用该[`msvcrt`](http://docs.python.org/library/msvcrt.html#msvcrt-console)模块。

> *   [**`msvcrt.kbhit()`**](https://docs.python.org/3/library/msvcrt.html#msvcrt.kbhit)
>     `True`如果按键正在等待读取，则 返回。
>     
>     
> *   [**`msvcrt.getch()`**](https://docs.python.org/3/library/msvcrt.html#msvcrt.getch)
>     读取按键并将结果字符作为字节字符串返回。控制台没有回显任何内容。如果按键不可用，此调用将阻塞，但不会等待 Enter 被按下。如果按下的键是一个特殊的功能键，这将返回`'\000'`or `'\xe0'`; 下一次调用将返回键码。使用`Control-C`此功能无法读取按键。

如果您希望它也适用于类 Unix 系统，您可以使用[termios](http://docs.python.org/library/termios.html)和[fcntl](http://docs.python.org/library/fcntl.html)模块尝试[此解决方案。](http://pyfaq.infogami.com/how-do-i-get-a-single-keypress-at-a-time)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-01-19T01:15:24.260

至于按下什么键来关闭它的“问题”，我（以及成千上万的其他人，我敢肯定）只是使用`input("Press Enter to close")`.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-09-21T13:17:24.000

有一个简单的方法可以做到这一点，你可以使用键盘模块的`wait`功能。例如，您可以这样做：

```
import keyboard
print("things before the pause")
keyboard.wait("esc") # esc is just an example, you can obviously put every key you want
print("things after the pause") 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-11-09T04:49:09.253

让 python 以无缓冲的方式从终端读取单个字符有点棘手，但这里有一个方法可以做到：

[配方 134892：在 Windows 和 Unix（Python）上从标准输入读取类似 getch() 的无缓冲字符](http://code.activestate.com/recipes/134892-getch-like-unbuffered-character-reading-from-stdin/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-01-27T22:05:42.883

在`Windows 10`开始时插入：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*- 
```

奇怪，但它对我有用！（ `input()`当然还有最后）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-23T12:35:08.140

外部 WConio 模块可以在这里提供帮助：http: [//newcenturycomputers.net/projects/wconio.html](http://newcenturycomputers.net/projects/wconio.html)

```
import WConio
WConio.getch() 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-23T18:35:12.223

```
import pdb
pdb.debug() 
```

这用于调试脚本。打破也应该有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-04-08T20:44:16.503

如果你输入

```
input("") 
```

它将等待他们按下任何按钮，然后它将继续。您也可以在引号之间放置文本。

# authentication - CC.Net 认证

> ID：577477
> 
> 赞同：1
> 
> 时间：2009-02-23T12:23:42.880
> 
> 标签：authentication, cruisecontrol.net

我将 CruiseControl.Net 用于我的项目。是否可以配置身份验证？我希望只有注册用户才能强制构建。

问候基督徒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T17:46:52.110

不是现在。

我相信 CCNet 的下一个版本应该包括这个 - 1.5 版。在此处查看路线图：http: [//confluence.public.thoughtworks.org/display/CCNET/Roadmap](http://confluence.public.thoughtworks.org/display/CCNET/Roadmap)

# asp.net-mvc - 在 ASP.NET MVC 中绑定操作参数以请求 cookie - 发生了什么？

> ID：577481
> 
> 赞同：4
> 
> 时间：2009-02-23T12:27:42.653
> 
> 标签：asp.net-mvc

在 ASP.NET MVC 的几个早期预览中，控制器方法的参数将通过检查查询字符串、表单、cookie 和服务器变量集合来解析，如[Stephen Walther 的这篇文章中](http://stephenwalther.com/blog/archive/2008/07/08/asp-net-mvc-tip-15-pass-browser-cookies-and-server-variables-as-action-parameters.aspx)所述。

例如，这段代码曾经工作：

```
public class MyController : Controller {

    // This should bind to Request.Cookies["userId"].Value
    public ActionResult Welcome(int userId) {

        WebUser wu = WebUser.Load(userId);
        ViewData["greeting"] = "Welcome, " + wu.Name;
        return(View());
    }
} 
```

但是现在针对发布候选运行，它会引发异常，因为它找不到 userId 的值，即使 userId 肯定出现在请求 cookie 中。

发行说明中是否包含此更改？如果这是对框架的更改，那么现在是否有推荐的替代方法来以这种方式绑定 cookie 和服务器变量？

编辑：感谢迄今为止做出回应的人。我可能选择了一个不好的例子来证明这一点；我们的代码将 cookie 用于各种形式的“方便”但非必要的持久性（记住搜索结果的顺序，诸如此类），因此这绝不是纯粹的身份验证问题。依赖用户 cookie 的安全隐患有据可查；我对当前有关用于检索 cookie 值的灵活、易于测试的技术的建议更感兴趣。（我相信你会明白，上面的例子可能有安全隐患，但是非常非常容易测试！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T22:29:10.387

我不相信cookies被检查了，我不确定它是否是故意的。

在我最近编写的一个针对 RC 的应用程序中，我使用了[这篇文章中的 CookieContainer 代码](http://chwe.at/blog/post/2009/01/28/Testable-and-reusable-cookie-access-with-ASPNet-MVC-RC.aspx)和一个自定义的类授权属性，如下所示：

```
public class LoginRequiredAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        IAppCookies a = new AppCookies(new CookieContainer());
        return a.UserId != null; /* Better checks here */
    }
} 
```

我的 AppCookies.cs 只有这样的 UserId 方法（自动为您解析为 int/null）：

```
public int? UserId
{
    get { return _cookieContainer.GetValue<int?>("UserId"); }
    set { _cookieContainer.SetValue("UserId", value, DateTime.Now.AddDays(10)); }
} 
```

然后只需确保您的 web.config 设置为指向您的登录页面，如下所示：

```
<authentication mode="Forms">
<forms loginUrl="~/Login"/>
</authentication> 
```

这意味着在我的控制器中获取 UserId 我需要执行以下操作来检索我的 cookie：

```
[LoginRequiredAttribute]
public class RandomController : Controller
{
    BaseDataContext dbContext = new BaseDataContext();
    private readonly IAppCookies _cookies = new AppCookies(new CookieContainer());

    public ActionResult Index()
    {
        return View(new RandomViewData(dbContext, _cookies.UserId));
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T01:19:59.913

我相信是安全隐患说服他们把这些东西拿出来：

Stephen Walther 的帖子[ASP.NET MVC Tip 15](http://stephenwalther.com/blog/archive/2008/07/08/asp-net-mvc-tip-15-pass-browser-cookies-and-server-variables-as-action-parameters.aspx)中的评论导致 Phil Haack[在 Sheep's Clothing 中发布用户输入](http://haacked.com/archive/2008/07/08/user-input-in-sheep-clothing.aspx)，尤其是他的[评论](http://haacked.com/archive/2008/07/08/user-input-in-sheep-clothing.aspx#68218)：

> @Troy - 第一步是首先劝阻开发人员放弃这种思路。;) 第一步素数（并行）是我们在这种情况下消除这种思路的可能性。
> 
> 更重要的一点仍然存在，我们可以进行这种更改（在讨论之后，我们可能会这样做），但这并不意味着信任动作方法参数突然变得安全。

再加上如何从各种动作构建器类中调用这些方法的复杂性。

除了斯蒂芬的帖子之外，我似乎无法以一种或另一种方式找到任何关于控制器行为的明确文档，所以我猜它是“悄悄地放弃了”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T16:23:57.567

除了明显的[安全隐患](http://haacked.com/archive/2008/07/08/user-input-in-sheep-clothing.aspx)之外，为什么还要在路由中传递 cookie？

当然，您最好在操作上使用 Authorize 属性，指示在执行操作之前应该对用户进行身份验证。

归根结底，我认为（希望）微软已经关闭了这个，因为它是一个相当大的安全问题。如果是这种情况，您应该考虑重写您的应用程序以符合此要求。

# c# - 发生未处理的 ThreadAbortException - 有时

> ID：577491
> 
> 赞同：0
> 
> 时间：2009-02-23T12:31:39.303
> 
> 标签：c#, multithreading, exception, exception-handling

我有一个必须处理大量数据的对话框（该过程非常耗时 - 首先 ODBC 填充需要时间，然后数据处理开始），结果是表单变得无响应。这真的不是问题，只需在新线程中打开一个“加载屏幕”来通知用户该过程就足够了。

最近我发现，*有时*（它似乎是随机的）新线程会抛出一个未处理的 ThreadAbortException 导致出现崩溃报告对话框（或 JIT）。

我不明白为什么会抛出这个异常，或者为什么它会未被处理。以前有没有人处理过这个问题，或者任何人都可以指出我这种行为的可能原因吗？

谢谢！

编辑：万一这很重要，我打开加载屏幕是这样的：

```
//start of work load
Thread th = new Thread(new ThreadStart(MakeStep));    
th.Start();

...
//end of work or error occurance:
th.Abort(); 
```

//

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T12:41:59.263

您正在调用which在线程上`th.Abort()`注入 a 。如果该线程不处理异常，它将被报告为未处理的异常。`ThreadAbortException``th`

通常不建议以这种方式中止其他线程，因为您不知道线程是否会优雅地处理中止。更好的解决方案是在线程之间使用信号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T12:34:26.257

调用 Thread.Abort() 时会引发 ThreadAbortExceptions。看起来您或您正在使用的库正在试图杀死您的线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T12:44:17.963

如果您不知道它为什么会中止，最好放手而不是吞下异常。

话虽如此，您需要将 MakeStep 方法包装在 try/catch 中并记录异常（当然还有任何内部异常）。像这样的东西...

```
public void MakeStep()
{
  try
  {
    InnerMakeStep(); // may throw TAE or some other exception
  }catch(Exception e)
  {
    // log here k 
    throw; // in case it isn't a TAE
  }
} 
```

With the exception logged, the issue can be debugged. Right now, it could be a thousand things.

# outlook - 为什么 Outlook 2007 插件中的表单区域保持对基础对象的引用处于打开状态？

> ID：577494
> 
> 赞同：2
> 
> 时间：2009-02-23T12:32:12.297
> 
> 标签：outlook, vsto, outlook-2007, outlook-addin, outlook-form

我在 Visual Studio 2008 (SP1) 中创建了一个空的 Outlook 2007 插件项目。然后我添加了一个新的表单区域（联系人类型，已连接，否则为默认值），然后运行该项目。

Outlook 打开，我去一个联系人更改了几件事，然后单击关闭按钮。Outlook 询问我是否要保存，我选择否。

我的理解是，这应该重置我所做的所有更改。但是，如果我重新打开同一个联系人，我的所有更改仍然存在。如果我关闭整个 Outlook，它会重新提示我保存我更改的联系人。

这让我想到默认的表单区域模板实际上保留了对正在显示的联系人的引用，并且在表单区域关闭后不会处理它。这会导致触点在内存中，而不是在关闭表单后简单地设置。

任何人都可以复制，还是它是一个功能？有什么办法可以解决这个问题？

# silverlight - 如何在 Silverlight 中设置 Image.Source（后面的代码）

> ID：577502
> 
> 赞同：30
> 
> 时间：2009-02-23T12:38:44.997
> 
> 标签：silverlight

我通过 Silverlight 中的代码隐藏动态生成图像，显然图像源不接受字符串或 Uri 作为路径。

如何设置源？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-23T12:44:04.577

你是什​​么意思它不会接受字符串作为源？

你不能这样做吗？

或者您是说您的图像在内存中并且您不知道如何引用它？

```
this.MyImage.Source = new BitmapImage(new Uri("/MyNameSpace;images/someimage.png", UriKind.Relative)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-10-04T08:13:07.990

```
// create a new image
Image image = new Image();

// better to keep this in a global config singleton
string hostName = Application.Current.Host.Source.Host;                   
if (Application.Current.Host.Source.Port != 80)
    hostName += ":" + Application.Current.Host.Source.Port;

// set the image source
image.Source = new BitmapImage(new Uri("http://" + hostName + "/image111.jpg", UriKind.Absolute)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-14T18:02:10.883

我需要替换以下内容才能使解决方案工作：

```
this.MyImage.Source = new BitmapImage(new Uri("/MyNameSpace;components/images/someimage.png", UriKind.Relative)); 
```

MyNameSpace 对我不起作用，但 ExecutingAssemblyName 对我有用，所以：

```
Dim tmp As String() = Assembly.GetExecutingAssembly.FullName.Split(","c)
Dim path As String = "/" & tmp(0) & ";component/images/"
MyImage.Source = new BitmapImage(new Uri(path & "someImage.png")) 
```

# php - PHP 通过 SSH 发送电子邮件

> ID：577507
> 
> 赞同：0
> 
> 时间：2009-02-23T12:40:49.687
> 
> 标签：php, security, email

我们有一个网站，可以通过电子邮件将联系表的内容发送给我们的客户。我们想更改它以使其更加安全（敏感数据可以通过联系表格发送），我们已经使用 SSL 证书加密了页面，因此我们目前唯一的薄弱环节是电子邮件。

我们已经设置了与客户服务器的 SSH 连接，我想知道是否有人知道是否可以通过该连接发送电子邮件（可能带有附件）？

我们的网络服务器是一台 linux 机器，我们可以自己安装应用程序。客户的服务器是 unix 服务器，但是他们的电子邮件系统是 Microsoft Exchange。

我们已经讨论过 PGP，它不是我们的客户的选择，他们不会在他们的系统上安装它。

谢谢你的帮助。

彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T13:10:14.813

为了让我的答案更清楚，我在这里看到了三 (3) 个系统。

1.  运行 PHP 脚本的网络服务器；后来被称为WebServer
2.  在您的客户端站点上运行的 Unix 服务器；后来被称为UnixServer
3.  在您的客户端站点上运行的 Exchange 服务器；后来被称为ExchangeServer

您可以做的是使用[autossh](http://www.harding.motd.ca/autossh/)通过 UnixServer 服务器从 WebServer 建立连接，并在 ExchangeServer 上有一个端点。它不是端到端加密，因为您不会有从 UnixServer 到 ExchangeServer 的加密链接，它使您更接近目标。

可以在[此处找到有关 autossh 的完整文档](http://www.harding.motd.ca/autossh/README)

设置的基本步骤如下：

A.设置从 WebServer 到 UnixServer 的无[密码身份验证。](http://www.freebsdwiki.net/index.php/SSH:_Passwordless_authentication)您必须小心保护生成的 RSA 密钥，否则您只是在他们的系统上打开了一个大洞。理想情况下，在非特权用户下运行 autossh，并且在 UnixServer 上使用的帐户也是非特权用户。**确保在开始使用 autossh 之前测试连接**

B. 为 keepalive 设置 ssh 选项（autossh 是备用选项）。确保`~/.ssh/config`用于启动 autossh 的用户的文件具有以下选项设置：

```
TCPKeepAlive yes
ClientAliveInterval 60 
ServerAliveInterval 15 
ServerAliveCountMax 3 
```

C. 设置 autossh。Linux.com 作为关于它的文章[在这里](http://www.linux.com/feature/134133)和 debianadmin.com 作为一个[在这里](http://www.debianadmin.com/autossh-automatically-restart-ssh-sessions-and-tunnels.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T12:45:12.157

如果客户端的服务器配置为“[邮件](http://en.wikipedia.org/wiki/Mail_(Unix))”命令有效，您应该能够使用它。并且很容易测试：ssh in 并尝试一下。

否则，您可能希望[通过 SSL 使用 smtp 并](http://email.about.com/od/emailprogrammingtips/qt/et073006.htm)直接加密到他们的邮件服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T13:17:12.190

我倾向于将信息安全地存储在服务器上，并通过电子邮件向用户发送通知，然后该用户可以登录并在网页中查看此请求（以及所有其他最近的请求？）。

您不必为了确保电子邮件安全和使用不在您专业领域内的系统而四处乱窜，您可以正确地保护您的 PHP 应用程序，并利用浏览器中已经很容易获得的安全功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T21:33:39.673

ssh -L $LOCAL_LISTEN_PORT:$EXCHANGE_SERVER_IP:25 用户名@sshdserver

[http://www.ssh.com/support/documentation/online/ssh/adminguide/32/Port_Forwarding.html](http://www.ssh.com/support/documentation/online/ssh/adminguide/32/Port_Forwarding.html)

# xml - XSL：具有多种可能格式的十进制格式

> ID：577509
> 
> 赞同：1
> 
> 时间：2009-02-23T12:42:06.767
> 
> 标签：xml, xslt

我对 XSL 有一个有趣的问题。我们有一个 XML 输入文件，其中包含内容旁边的几个设置，这些设置定义了我们如何输出内容。目前我正在努力处理 XSL 文件中数字的格式。

以下格式是可能的：

*   1,234.5
*   1.234,5
*   1234,5
*   1234.5

我在我的 XML 文件中得到了上述这些格式：

```
<?xml version="1.0" encoding="UTF-8"?>
<document>
    <settings>
        <DefaultCurrency>EUR</DefaultCurrency>
        <DefaultDateFormat>DD.MM.YYYY</DefaultDateFormat>
    <DefaultNumberFormat>1.250,65</DefaultNumberFormat>
    <AllowOrdering>true</AllowOrdering>
</settings>
<productlist>
    <item>
        <product>
            <productid>Product1</productid>
            <weight>0.123</weight>
        </product>
        <customerprice>123.03</customerprice>
    </item>
    <item>
        <product>
            <productid>Product2</productid>
            <weight>12312.123</weight>
        </product>
        <customerprice>12.00</customerprice>
    </item>
    <item>
        <product>
            <productid>Product3</productid>
            <weight>12.123</weight>
        </product>
        <customerprice>13.23</customerprice>
    </item>
</productlist>
</document> 
```

我试图让这个与以下 XSL 文件一起工作，但我无法让它给我正确的结果（当 XML 中的 DefaultNumberFormat 更改时，格式也必须更改）。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:fn="http://www.w3.org/2005/xpath-functions">
    <xsl:decimal-format name="numberformat1" decimal-separator="." grouping-separator=","/>
    <xsl:decimal-format name="numberformat2" decimal-separator=","/>
    <xsl:decimal-format name="numberformat3" decimal-separator="," grouping-separator="."/>
    <xsl:decimal-format name="numberformat4" decimal-separator="."/>
    <xsl:template match="productlist">
        <xsl:apply-templates select="item"/>
    </xsl:template>
    <xsl:template match="item">
ItemID: <xsl:value-of select="product/productid"/>
Weigh: 
<xsl:choose>
            <xsl:when test="/document/settings/DefaultNumberFormat = '1,250.65'">
                <xsl:value-of select="format-number(product/weight, '#,##0.000', 'numberformat1')"/>
            </xsl:when>
            <xsl:when test="/document/settings/DefaultNumberFormat = '1250,65'">
                <xsl:value-of select="format-number(product/weight, '#,##0.000', 'numberformat2')"/>
            </xsl:when>
            <xsl:when test="/document/settings/DefaultNumberFormat = '1.250,65'">
                <xsl:value-of select="format-number(product/weight, '#,##0.000', 'numberformat3')"/>
            </xsl:when>
            <xsl:when test="/document/settings/DefaultNumberFormat = '1250.65'">
                <xsl:value-of select="format-number(product/weight, '#,##0.000', 'numberformat4')"/>
            </xsl:when>
        </xsl:choose>
    </xsl:template>
    <xsl:template match="settings/*"/>
</xsl:stylesheet> 
```

我希望有人可以在这里帮助我，我想我对如何结合格式数字和数字格式有一些想法......

谢谢，马丁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T13:45:11.763

在 XSLT 中，`format-number`是一个普通的 XPath 函数，它将字符串作为其第二个和第三个参数。这些字符串不需要在样式表中指定为常量——它们也可以在运行时从源文档中计算出来。

在最简单的情况下，让我们假设源文档实际上直接将参数指定为`settings/picture`“设置/格式名称”。如果是这样，你可以写：

```
<xsl:value-of select="format-number(product/weight,
                                    settings/picture,
                                    settings/formatname)"/> 
```

或者，如果文档使用不同的符号，需要进行翻译步骤，您可以重构样式表以使用 XSLT 变量，如下所示：

```
<xsl:variable name="picture">
  <!-- compute the picture string here, e.g. using <xsl:choose> and -->
  <!-- /document/settings/DefaultNumberFormat -->
</xsl:variable>

<xsl:variable name="formatname">
  <!-- compute the number format name here, e.g. using <xsl:choose> and -->
  <!-- /document/settings/DefaultNumberFormat -->
</xsl:variable>

<xsl:value-of select="format-number(product/weight, $picture, $formatname)"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T15:08:53.403

**以下转换计算要使用的数字格式**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:variable name="vDoc" select="/"/>

    <xsl:variable name="vDFormats">
        <dFormat spec="1,250.65" name="numberformat1"/>
        <dFormat spec="1250,65" name="numberformat2"/>
        <dFormat spec="1.250,65" name="numberformat3"/>
        <dFormat spec="1250.65" name="numberformat4"/>
    </xsl:variable>

    <xsl:variable name="vDefFormats" select=
     "document('')/*/xsl:variable
                      [@name='vDFormats']"/>

    <xsl:variable name="vtheFormatName" select=
     "string($vDefFormats/*
              [@spec = $vDoc/*/settings/DefaultNumberFormat]
                                   /@name
           )
   "/>

    <xsl:decimal-format name="numberformat1" 
         decimal-separator="." grouping-separator=","/>
    <xsl:decimal-format name="numberformat2" 
         decimal-separator=","/>
    <xsl:decimal-format name="numberformat3" 
         decimal-separator="," grouping-separator="."/>
    <xsl:decimal-format name="numberformat4" 
         decimal-separator="."/>

    <xsl:template match="productlist">
        <xsl:apply-templates select="item"/>
    </xsl:template>

    <xsl:template match="item">ItemID: <xsl:text/> 
        <xsl:value-of select="product/productid"/> Weigh: <xsl:text/> 
        <xsl:value-of select=
        "format-number(product/weight, 
                       '#,##0.000', 
                       $vtheFormatName)"/>
    </xsl:template>

    <xsl:template match="settings/*"/>
</xsl:stylesheet> 
```

**应用于以下 XML 文档时**：

```
<document>
  <settings>
    <DefaultNumberFormat>1,250.65</DefaultNumberFormat>
  </settings>

    <productlist>
      <item>
        <product>
          <productid>30</productid>
          <weight>2530.45</weight>
        </product>
      </item>
    </productlist>
</document> 
```

**产生了想要的结果**：

```
ItemID: 30 Weigh: 2,530.450 
```

# 4d-database - 4D - 有什么好处吗？

> ID：577516
> 
> 赞同：26
> 
> 时间：2009-02-23T12:44:29.680
> 
> 标签：4d-database

最近我发现我的一个朋友共同拥有的公司使用 4D，这是我以前从未听说过的。他们对此发誓，但他们是非技术性的，他们所说的听起来像是记忆中的营销宣传。不幸的是，[4D 网站](http://www.4d.com/)似乎也没有任何实际信息，而是充满了诸如“全面”、“解决方案”、“平台”和“集成”之类的词。

由于那东西相当昂贵，并且使用一种我没有太多意愿只为一个项目学习的自定义语言，所以我对此持谨慎态度，我想知道是否有人对此有任何经验？你会推荐它吗？到底有什么好处呢？作为程序员学习它或将它用作公司，我将获得什么竞争优势？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-23T13:25:29.690

4D 已经存在了很长时间（约 25 年），因此它比 MySQL 等老得多。将其视为 Microsoft Access 的专业版本：它拥有自己的受 Pascal 启发的宿主语言、自己的关系数据库引擎、用于快速 GUI 开发的非常成熟的 IDE 和允许真正“一次编写，随处运行”的自定义运行时（就是 Mac OS (X) 和 Windows）。如今，它也能理解 SQL，有服务器版本，甚至还有集成的 Web 服务器。它相当强大，因此与 Access 的比较可能并不公平。

今天，我相信它主要用于与 4D 一样古老的遗留应用程序。我认为我今天不会再学习它了，更不用说用它开始新项目了，因为你可以获得相同的功能，然后通过堆叠开源组件来获得一些功能。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-23T14:24:25.647

我曾经做过一些非常严肃的 4D 工作，[我编写](http://www.oofile.com.au/adsother/SearchAndReport.html)的其中一个系统在大约 16 年后仍然作为企业系统使用。我很沮丧，因为他们花了数年时间才推出*新*的面向对象版本的语言，而且我编写了数千行代码来使用第三方表格控件。

4D 使用专有服务器提供跨平台、非常高性能的客户端-服务器系统。数据库模型比 SQL 更面向集合，并将集合一直拉到核心语言中。它在向客户端交付代码方面做得很好，因为它将所有过程编译为本地代码，这些代码在本地缓存并在过期时按需更新。

语言和 GUI 环境有其怪癖，但另一方面是支持它作为一个遗留平台可能会过上好日子。如果您可以让其他人选择工具选项卡，这可能是您咨询工具箱的有用补充。您必须考虑有多少特定于业务的代码将用于具有如此悠久历史的独特产品！

一位我非常尊重的工程师最近被 4D 聘用，这充分说明了他们对未来的承诺，聘用了这样的人。

我最近一直在使用遗留系统，将旧 Mac 的东西移植到 WPF，Visual Studio 和旧 Mac 工具的大部分未使用的复杂性之间的对比让我想起了 4D。我还将[我的 OOFILE C++ 数据库和报告框架移植到 REALbasic](http://code.google.com/p/rbrw-core/) - OOFILE 面向集合的操作直接来自我对 4D 的喜爱，这也让我觉得我最初在这个答案中过于苛刻。

关于 4D 需要记住的一点是，它从一开始就是面向集合的（由一位数学家编写），并且在很多事情上比 SQL 更容易使用。4D Server 的部署模型是桌面应用程序和网络配置的完美结合——编译的组件缓存在服务器上，并在需要时自动发送到客户端。无需关闭或主动推送或部署更新。4D 的 GUI 模型令人沮丧，但看看今天的网站，他们已经解决了我多年前不得不使用第三方解决方案的大部分问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-05-04T20:51:43.100

像瘟疫一样避免它。我的公司使用它，它只是一种不断的挫折练习。它的表现远没有你相信的销售宣传那么好，而且文档要么不存在，要么没有帮助。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-04-27T16:59:00.680

在我看来，没有理由开始学习 4D，除非你想要一个简单的数据库应用程序并且无法或不愿意学习如何用更大的语言创建 GUI。4D 的主要优势是 UI 和数据库之间的内置功能可以处理大部分需要的内容。如果你想要一些快速、小型和内部的东西，你可以使用 4D，但如果你需要开发一个强大的商业应用程序，你会遇到一些困难。如果您需要 4D 无法自动提供的东西，那么*很难*让它发挥作用。

我认为这种语言完全过时。它适用于它的工作，但我们的产品已受到语言和数据库本身的限制。我们不断遇到奇怪的怪癖，不得不用我们的方式来解决它们。

我有 4D 2003 和 2004 的经验，但由于成本原因，我们还没有升级到最新版本。它非常昂贵。每个客户都需要为每台需要运行该软件的计算机购买许可证。由于许可证，我们的产品成本超过 1000 美元用于新办公室。当新版本的 4D 发布时，每个客户都必须付费升级他们的许可证。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-23T13:20:55.940

在查看[https://www.4duk.com/products/ataglance.html](https://www.4duk.com/products/ataglance.html)之后，我建议您保持清醒 - 它看起来像是那些无处可去的产品之一。

这让我想起了我被要求使用一个名为[Witango](http://www.witango.com)的开发平台的时候——使用起来绝对是一场噩梦，不久之后所有的应用程序都必须用 .NET 重写。

**花时间学习一些更主流/更实用的东西**。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-01-25T12:10:21.950

不惜一切代价避免。20 年前，4D 曾经是一个很好的 Mac 数据库，但今天已经过时了。部署成本极高且支持不佳。我已经使用它很多年了，后来我转向 Real Studio 进行跨平台数据库开发，它拥有更现代的语言和更活跃的开发者社区。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-23T12:58:32.127

我会警惕在这样的事情上投资太多。从好的方面来说，如果这就是你的公司使用的学习方式，它将带来回报。但是你学到的技能将很难在其他地方使用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-03-23T05:44:55.317

我认为这里有一半以上的回复是不准确的。我知道有超过 1000 名用户的 20 多家公司。我相信还有更多。

使用 4D v12.1 (www.4d.com)，您只需单击按钮即可轻松部署单用户、客户端服务器、Mac、Win。并且有易于设置的插件与 Flex、iPhone 和 Android 操作系统集成。他们的知识库和文档非常简洁和全面。

他们拥有一支优秀的工程团队，4D 和在线社区的支持非常棒。我使用 4D 已经好几年了，我没有任何抱怨。

正如其他人指出的那样，4D 为您提供了一个完全集成的后端数据库和前端。客户端服务器连接是有状态的，因此您无需担心记录处理和客户端服务器会话处理。

每年不到 1000 美元，它并不昂贵，您可以部署无限的单用户应用程序。哪个其他专有开发平台可以为您提供？

我确信 Real Software 也有其优点和缺点。现在有很多选择，给猫剥皮的方法也很多。

# .net - 敏捷文档框架（NTestDox？）

> ID：577518
> 
> 赞同：0
> 
> 时间：2009-02-23T12:45:23.700
> 
> 标签：.net, unit-testing, agile

我正在阅读这篇博文：[http](http://www.shakie.co.uk/ramblings/feature-driven-development-riding-the-waves-of-change/) ://www.shakie.co.uk/ramblings/feature-driven-development-riding-the-waves-of-change/并遇到了关于 TestDox 的部分：

直接报价（因此是 PHP）：

> 以下面的测试用例为例

```
class InvoiceTest extends PHPUnit_Framework_TestCase
{
    public function testValueIsInitiallyZero() {
        $invoice = new Invoice();
        $this->assertEquals(0.00, $invoice->getValue());
    }

    public function testWillCloseAutomaticallyIfWholeValueIsPaid() {
        $invoice = Invoice::getInvoiceById(1);
        $invoice->payAmount(100.00);
        $this->assertEquals(true, $invoice->isClosed());
    }
} 
```

> 在 TestDox 格式中，这将转换为：
> 
> **发票**
> 
> **[x] 值最初为零**
> 
> **[x] 如果全额支付，将自动关闭**

这对于我正在从事的一些更敏捷的项目来说会很棒。我一直在查看 TestDox 并试图追踪 NTestDox，因为我是一个 .NET 人。

这里有3个问题：

有人找到 NTestDox 的副本吗？（我看到谷歌唯一有用的结果中不存在页面）

*   [http://www.emxtechnologies.com/ntestdox](http://www.emxtechnologies.com/ntestdox)
*   [http://www.projectdistributor.net/projects/Project.aspx?projectId=87](http://www.projectdistributor.net/projects/Project.aspx?projectId=87)

从您的单元测试生成文档是一个好的计划吗？

有谁知道.NET 的任何其他框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T22:38:46.187

不幸的是，对于 NTestDox，我无法帮助您，但我还是想回答您的最后两个问题。

> 从您的单元测试生成文档是一个好的计划吗？

我不知道记录现有的单元测试是否对你有好处。然而，如果您打算开发测试驱动，那么将人类可读的规范作为测试框架的一部分是有价值的。看看[BDD](http://behaviour-driven.org/)和[ATDD](http://testobsessed.com/wordpress/wp-content/uploads/2008/12/atddexample.pdf)。

这就引出了你的第二个问题：

> 有谁知道.NET 的任何其他框架？

如果您寻找 BDD 的好处而不是从测试中生成文档，您可以看看[Cucumber](http://cukes.info/)。它应该可以与 .NET 一起使用（请参阅[此处](http://wiki.github.com/aslakhellesoy/cucumber/ironruby-and-net)的文档）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-02T13:14:27.157

我也找不到任何可用的 NTestDox 痕迹。

但是，我确实找到了 2010 年初[用于 .NET](http://www.testdox.com/)的 nAgileDox 和 TestDox。

尽管 Chris Stevenson 在 sourceforge 的[AgileDox 项目](http://agiledox.sourceforge.net/)的页面只提到了他从 2003 年开始为 JUnit 开发的 TestDox Java 程序，但该项目的[CVS 存储库](http://agiledox.cvs.sourceforge.net/viewvc/agiledox/)还包含带有控制台版本和 GUI 版本的 nAgileDox C# 程序。它的最后一次更新是从 2007 年开始。源代码和可执行文件可在[此目录](http://agiledox.cvs.sourceforge.net/viewvc/agiledox/nAgileDox/bin/)中的 nAgileSource.zip 和 nAgileComplete.zip 文件中找到。

.NET 的 nAgileDox 和 TestDox 都通过读取 .net 程序集来工作。

另请参阅[此相关问题](https://stackoverflow.com/questions/2430036/convert-c-unit-test-names-to-english-testdox-style)。

# sql-server - Sql Server 备份大小

> ID：577520
> 
> 赞同：1
> 
> 时间：2009-02-23T12:45:47.413
> 
> 标签：sql-server, compression, backup

有没有人在 Sql 2008 中有备份压缩的实际经验，我想知道与 Sql 2005 + winrar 相比它的性能如何。目前，当我备份时，我得到一个 14G 文件。使用 rar 将其缩小到 <400M，节省了大量资金。大多数数据都是相似的，都是来自股市的数据，所以我想这很容易压缩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T12:56:41.553

我看到的数据表明压缩比在 3 到 4.5 倍之间，这不如你为 rar 引用的数据好。请参阅[在 SQL Server 2008 中调整备份压缩的性能](http://sqlcat.com/technicalnotes/archive/2008/04/21/tuning-the-performance-of-backup-compression-in-sql-server-2008.aspx)。

另一方面，创建压缩备份更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T12:54:45.020

恢复时间对于备份来说很重要。如果您压缩备份，您将花费更多时间来恢复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T13:04:52.720

我有一个从 200GB 到 50GB 的，绝对没有 WinRar 给你的那么紧凑，但更方便。正如其他人所指出的，备份时间更快，但恢复时间（有点）长但仍然比 SQL2000 快。

# wpf - datatemplate 中只指定了一个用户控件实例

> ID：577522
> 
> 赞同：1
> 
> 时间：2009-02-23T12:48:38.140
> 
> 标签：wpf, user-controls, datatemplate

我已将 userControl 指定为 dataTemplate。

```
<TabControl IsSynchronizedWithCurrentItem="True" ItemsSource="{Binding Path=Pages}">
   <TabControl.ContentTemplate>
      <DataTemplate>
         <uc:ItemTemplateControl />
      </DataTemplate>
   </TabControl.ContentTemplate>
</TabControl> 
```

userControl 非常简单，只需绑定到一个字符串属性，效果很好。但奇怪的是，即使我有多个项目，也只创建了一个 userControl 实例（ctor 中的调试器只命中一次）...

如何为每个项目创建单独的 userControl 实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-01T15:15:35.180

当您直接在 tabControl 中指定 dataTemplate 时，它​​不起作用。您必须将 dateTemplate 指定为单独的资源。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-02-23T13:00:12.667

尝试将您的用户控件放在转发器控件中，并将转发器控件与您的数据源绑定。例如，

```
<asp:Repeater ID="repeatInfo" runat="Server">
 <ItemTemplate>
  <tr>
     <td>
        <Your control/>
     </td>
  </tr>
 </ItemTemplate>
</asp:Repeater> 
```

# silverlight - Silverlight 网页预览控件

> ID：577526
> 
> 赞同：0
> 
> 时间：2009-02-23T12:51:10.723
> 
> 标签：silverlight, webpage, preview

我正在制作一个 silverlight 应用程序，当用户将鼠标悬停在某些选项卡栏上时，他/她将看到它将链接到的页面的预览。进行此预览的原因是，仅拥有页面的视觉缩影通常足以为用户做出决定。我如何在 Silverlight 中制作一个仅显示网页的控件，最好按比例缩小？

干杯

尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T13:47:32.273

您可能知道，Silverlight 中存在一些与跨域边界相关的问题。[例如](https://stackoverflow.com/search?q=silverlight+cross+domain)，关于堆栈溢出的问题已经讨论过。

这是相关的，因为通常您无法在其他域中请求您需要在此处执行的 Web 资源。

我见过的解决此问题的一种方法是使用没有相同限制的 Web 服务。因此，您可以创建一个公开图像的 byte[] 的 Web 服务，并让 Web 服务执行调用以检索图像并将其发送回 Silverlight。

一旦你得到图像字节[]，你可以在异步调用中读取它，并像这样设置图像源。

```
BitmapImage thumb;
using (MemoryStream stream = new MemoryStream(imgArray))
{
    thumb = new BitmapImage();
    thumb.SetSource(stream);
} 
```

另一个问题是如何生成缩略图，你可以用[谷歌搜索](http://www.google.co.uk/search?q=website+thumb+generator++.net)，有一些项目会告诉你如何生成缩略图，还有一些公共网络服务可以为你做这件事。[亚马逊](http://aws.amazon.com/ast/)就是这样一个例子。

# asp.net - 区域设置 IIS6 和 ASP.Net 2 - {0:c} 在 gridview 中返回太多小数

> ID：577543
> 
> 赞同：0
> 
> 时间：2009-02-23T12:56:51.367
> 
> 标签：asp.net, iis-6, regional, machine.config

我目前正在将我的网站从现有的 Web 服务器移动到新机器上。

新机器是WIN Sever 2003，运行IIS6。该站点使用 ASP.Net 2。

我在 machine.config 文件的部分中添加了以下内容，`<system.web>`以使网站和任何未来的网站都使用南非区域设置而不是默认的美国设置。

```
<globalization culture="en-ZA" uiCulture="en-ZA"/> 
```

这主要是有效的 - 货币符号已经从 $ 更改为 R，但我在 gridview 中有一个列（绑定字段 - 数据库类型是货币），设置如下：

DataFormatString="{0:c}"

**[编辑]** - 已尝试使用 {0:C} 以及以下理查德的建议：仍然没有运气

这仍然返回 10000.0000 而不是 R 10,000.00，因为它在我的旧服务器上。

关于如何解决这个问题的任何想法？

谢谢！

**[编辑]** - 我开始认为这与实际的文化设置无关。

我有另一种形式可以正常工作：

```
<ItemTemplate>
    <asp:Label ID="Label2" runat="server" Text='<%# Bind("Balance", "{0:c}") %>'></asp:Label>
</ItemTemplate> 
```

不起作用的表单使用没有模板的gridview：

```
<asp:BoundField DataField="Amount" HeaderText="Amount" SortExpression="Amount" DataFormatString="{0:C}" >
    <ItemStyle CssClass="al-r" />
</asp:BoundField> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T14:33:40.650

在您的绑定字段上尝试设置 HtmlEncode="false"。

```
<asp:BoundField DataField="Amount" HeaderText="Amount" SortExpression="Amount" DataFormatString="{0:C}" HtmlEncode="false">
    <ItemStyle CssClass="al-r" />
</asp:BoundField> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T13:02:24.097

MSDN 显示货币的大写 C，而不是小写。

（格式说明符区分大小写。）

* * *

更新：现在在这里测试一下。

代码：

```
class Program {
    static void Main(string[] args) {
        decimal val = 1234567.89M;

        using (var file = new FileStream(args[0], FileMode.Create, FileAccess.Write))
        using (var output = new StreamWriter(file, Encoding.UTF8)) {
            output.WriteLine("Thread culture: " + Thread.CurrentThread.CurrentCulture.Name);
            output.WriteLine("Thread UI culture: " + Thread.CurrentThread.CurrentUICulture.Name);

            var cultures = new[] { "en-US", "en-GB", "af-ZA", "fr-FR", "fr-CA" };
            foreach (var culture in cultures) {
                var ci = new CultureInfo(culture);
                output.WriteLine(String.Format(ci, "{0,-10}: {1:C}", ci.Name, val));
            }
        }
    }
} 
```

给出输出：

```
线程文化：en-GB
线程 UI 文化：en-US
美国：1,234,567.89 美元
英文：£1,234,567.89
af-ZA：R 1,234,567.89
FR-FR : 1 234 567,89 €
法国-CA : 1 234 567,89 $

```

这对我来说看起来不错。

你是如何设置文化的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T15:18:01.993

感谢您对此的帮助。

我通过安装 ASP.Net 2.0 的 Service Pack 2 解决了这个问题 - 重新启动后，网格在 {0:C} 上运行良好。

此问题将在生产环境中自行修复，因为它将被设置为自动更新。目前我们在本地办公网络上有新服务器，我们的防火墙似乎限制了更新。

**经验教训：**始终确保所有服务器软件都是最新的！

# jquery - 如何从函数中禁用 jQuery 对话框中的按钮？

> ID：577548
> 
> 赞同：239
> 
> 时间：2009-02-23T12:58:44.450
> 
> 标签：jquery, jquery-ui

我有一个 jQuery 对话框，需要用户输入某些信息。在这种形式中，我有一个“继续”按钮。我希望这个“继续”按钮只有在所有字段都有内容时才启用，否则它将保持禁用状态。

我写了一个每次字段状态发生变化时调用的函数。但是，我不知道如何从此功能启用和禁用对话框按钮。我该怎么办？

哎呀，我忘了提到这些按钮是按如下方式创建的：

```
$(function() {
  $("#dialog").dialog({
    bgiframe: true,
    height: 'auto',
    width: 700,
    show: 'clip',
    hide: 'clip',
    modal: true,
    buttons: {
      'Add to request list': function() {
        $(this).dialog('close');
        $('form').submit();
      },
      'Cancel': function() {
        $(this).dialog('close');
      }
    }
  })
}); 
```

* * *

## 回答 #1

> 赞同：261
> 
> 时间：2009-02-23T13:04:06.900

你会想要设置[disabled 属性](http://www.w3schools.com/jsref/prop_select_disabled.asp)

```
 $('#continueButton').attr("disabled", true); 
```

**更新**：啊哈，我现在看到了复杂性。[jQuery 对话框](http://docs.jquery.com/UI/Dialog)有一行可以使用（在“按钮”部分下。

```
 var buttons = $('.selector').dialog('option', 'buttons'); 
```

您需要从对话框中获取按钮集合，循环查找您需要的按钮集合，然后设置 disabled 属性，如上所示。

* * *

## 回答 #2

> 赞同：194
> 
> 时间：2010-01-27T04:07:35.053

这很简单：

```
$(":button:contains('Authenticate')").prop("disabled", true).addClass("ui-state-disabled"); 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2010-12-19T00:35:25.593

你把一个简单的任务复杂化了；jQueryUI 对话框有两种设置按钮的方法是有原因的。

如果您只需要为每个按钮设置点击处理程序，请使用带`Object`参数的选项。要禁用按钮并提供其他属性，请使用带`Array`参数的选项。

以下示例将禁用按钮，并通过应用所有 jQueryUI CSS 类和属性来正确更新其状态。

**第 1 步 - 使用按钮创建对话框`Array`：**

```
// Create a dialog with two buttons; "Done" and "Cancel".
$(".selector").dialog({ buttons: [
    {
        id: "done"
        text: "Done",
        click: function() { ... }
    },
    {
        id: "cancel"
        text: "Cancel",
        click: function() { ... }
    }
] }); 
```

**第 2 步 - 创建对话框后启用/禁用“完成”按钮：**

```
// Get the dialog buttons.
var dialogButtons = $( ".selector" ).dialog("option", "buttons");

// Find and disable the "Done" button.
$.each(buttons, function (buttonIndex, button) {
    if (button.id === "done") {
        button.disabled = true;
    }
})

// Update the dialog buttons.
$(".selector").dialog("option", "buttons", dialogButtons); 
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2011-07-05T16:54:24.450

如果您创建一个为按钮提供 id 的对话框，

```
$("#dialog").dialog({ buttons: [ {
 id: "dialogSave",
 text: "Save",
 click: function() { $(this).dialog("close"); }
},
{
 id: "dialogCancel",
 text: "Cancel",
 click: function() { $(this).dialog("close"); 
}
}]}); 
```

我们可以使用以下代码禁用按钮：

```
$("#dialogSave").button("option", "disabled", true); 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2010-01-18T19:13:15.780

我希望能够按名称找到按钮（因为我的 jQuery UI 对话框中有几个按钮）。我在页面上也有几个对话框，所以我需要一种方法来获取特定对话框的按钮。这是我的功能：

```
function getDialogButton( dialog_selector, button_name )
{
  var buttons = $( dialog_selector + ' .ui-dialog-buttonpane button' );
  for ( var i = 0; i < buttons.length; ++i )
  {
     var jButton = $( buttons[i] );
     if ( jButton.text() == button_name )
     {
         return jButton;
     }
  }

  return null;
}

// create the dialog
$('#my_dialog').dialog( dialogClass : 'dialog1',
                        buttons: {
                                   Cancel: function() { $(this).dialog('close'); },
                                   Submit: function() { ... } 
                             } );

// now programmatically get the submit button and disable it
var button = getDialogButton( '.dialog1', 'Submit' );
if ( button )
{
  button.attr('disabled', 'disabled' ).addClass( 'ui-state-disabled' );
} 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-08-11T14:20:27.947

这会禁用一个按钮：

```
var firstButton=$('.ui-dialog-buttonpane button:first');
firstButton.addClass('ui-state-disabled'); 
```

如果页面上有多个对话框，则必须添加对话框 ID。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2011-04-23T15:52:18.260

这是修改后禁用按钮的问题示例：

```
$(function() {
    $("#dialog").dialog({
        bgiframe: true,
        height: 'auto',
        width: 700,
        show: 'clip',
        hide: 'clip',
        modal: true,
        buttons: {
            'Add to request list': function(evt) {

                // get DOM element for button
                var buttonDomElement = evt.target;
                // Disable the button
                $(buttonDomElement).attr('disabled', true);

                $('form').submit();
            },
            'Cancel': function() {
                $(this).dialog('close');
            }
        }
    });
} 
```

此外，以下问题也将对此有所帮助： [如何禁用 jQuery UI 对话框上的按钮？](https://stackoverflow.com/questions/3646408/how-can-i-disable-a-button-on-a-jquery-ui-dialog)

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2010-08-20T06:49:04.113

我找到了一种在对话框按钮上禁用（或执行任何其他操作）的简单方法。

```
 var dialog_selector = "#myDialogId";

    $(dialog_selector).parent().find("button").each(function() {
        if( $(this).text() == 'Bin Comment' ) {
            $(this).attr('disabled', true);
        }
    }); 
```

您只需选择对话框的父级并找到所有按钮。然后检查按钮的文本，您可以识别您的按钮。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2011-08-04T10:06:00.007

我使用[`.dialog("widget")`](http://jqueryui.com/demos/dialog/#method-widget)返回对话框 DIV 本身的方法来解决这个问题。如果您在对话框方法中：

```
$(this)
.dialog("widget")
.find("button")
.addClass("ui-state-disabled") // for the style
.attr("disabled", true); 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-09-08T10:31:40.450

从可用性的角度来看，通常最好让按钮保持启用状态，但如果有人尝试提交不完整的表单，则会显示错误消息。当我想单击的按钮被禁用并且不知道原因时，它让我发疯。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2010-09-03T23:21:13.070

试试这个：

```
$('button:eq(0)',$('#dialog_id').dialog.buttons).button('disable'); 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-12-13T13:08:41.587

这是我的 jQuery 对话框的 enableOk 函数：

```
function enableOk(enable)
{
    var dlgFirstButton = $('.ui-dialog-buttonpane').find('button:first');

    if (enable) {
        dlgFirstButton.attr('disabled', '');
        dlgFirstButton.removeClass('ui-state-disabled');
    } else {
        dlgFirstButton.attr('disabled', 'disabled');
        dlgFirstButton.addClass('ui-state-disabled');
    }
} 
```

“第一个”按钮是最右边的按钮。您既禁用按钮又设置对话框的禁用类，以获得适当的视觉效果。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2011-01-06T00:42:43.413

在旧的 jQuery UI（版本 1.7.3）中，我能够简单地使用

```
$('.ui-dialog-buttonpane button')[0].disabled=true; 
```

只是禁用 DOM 元素本身的按钮。现在我们已经升级到更新的 jQuery UI（版本 1.8.7），该方法不再适用于 Firefox，但我可以简单地调用 jquery UI 按钮特定的禁用和启用按钮 jquery 对象上的功能：

```
$('.ui-dialog-buttonpane button').eq(0).button('disable'); 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2012-10-01T09:35:06.780

哈哈，刚刚发现了一个有趣的方法来访问按钮

```
$("#dialog").dialog({

      buttons: {
        'Ok': function(e) { $(e.currentTarget).button('disable'); }

      }
 }); 
```

看来你们都不知道参数中有一个事件对象...

顺便说一下，它只是从回调中访问按钮，在一般情况下，添加一个 id 进行访问是很好的

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-02-23T23:51:01.090

我找到了一种可能适用于尝试做类似事情的人的解决方法。我没有禁用按钮，而是`if`在函数中添加了一个简单的语句来检查复选框是否被选中。

如果不是，它会显示一条简单的消息，说明在提交之前必须检查该框。

例如：

```
$("#confirmation-dialog").dialog({
    modal: true,
    autoOpen: false,
    width: 600,
    overlay: {
        backgroundColor: '#000',
        opacity: 0.5
    },
    close: function() {
        $('input[type="submit"]')
      .val('Record Reading')
      .attr('disabled', false);
    },
    buttons: {
        'Confirm Reading': function() {
            if($('#check-box').attr("checked")){
                $(this).dialog('close')
                $('form')
                .addClass('confirmed')
                .submit();
            }
            else {
                $('#please-check').show("slide");
            }
        }
    }
}); 
```

无论如何，我希望对某人有所帮助。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2010-05-04T22:50:32.113

如果你真的想禁用一个按钮，我发现你还需要调用它的 .unbind() 方法。否则按钮可能仍然处于活动状态，双击可能会导致多个表单提交。以下代码适用于我：

```
button = $(this).parent().find("button:contains('OK')");
button.unbind();
button.addClass('ui-state-disabled'); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2010-10-14T19:33:16.177

我创建了一个 jQuery 函数以使这项任务更容易一些。只需将其添加到您的 JavaScript 文件中：

```
$.fn.dialogButtons = function(name, state){
var buttons = $(this).next('div').find('button');
if(!name)return buttons;
return buttons.each(function(){
    var text = $(this).text();
    if(text==name && state=='disabled') {$(this).attr('disabled',true).addClass('ui-state-disabled');return this;}
    if(text==name && state=='enabled') {$(this).attr('disabled',false).removeClass('ui-state-disabled');return this;}
    if(text==name){return this;}
    if(name=='disabled'){$(this).attr('disabled',true).addClass('ui-state-disabled');return buttons;}
    if(name=='enabled'){$(this).attr('disabled',false).removeClass('ui-state-disabled');return buttons;}
});}; 
```

禁用“对话框”类对话框上的“确定”按钮：

```
$('.dialog').dialogButtons('Ok', 'disabled'); 
```

启用所有按钮：

```
$('.dialog').dialogButtons('enabled'); 
```

启用“关闭”按钮并更改颜色：

```
$('.dialog').dialogButtons('Close', 'enabled').css('color','red'); 
```

我希望这有帮助。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-09-26T11:06:38.623

只是为了记录，这篇文章帮助我解决了我的问题。简而言之，您必须将 disabled 属性设置为 disabled，而不是 false：

```
_send_button.attr('disabled','disabled'); 
```

这是所有代码的外观，我还添加了一些样式以使其看起来被禁用：

```
var _send_button = $('.ui-dialog-buttonpane button:contains(Send)');
var original_text = _send_button.text();
_send_button.text('Please wait...');
_send_button.addClass('ui-state-disabled');
_send_button.attr('disabled','disabled');
_send_button.fadeTo(500,0.2); 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2010-06-17T18:18:21.713

我认为它应该适用于所有人，

```
<script type="text/javascript">
    $(document).ready(function() {
        $('#dialog').dialog('open');
        $(function(){
            $('#dialog').dialog({
                autoOpen: true,
                width: 400,
                modal: true,
                overlay: {
                    opacity: 0.8,
                    background: "black"
                },
                resizable: false,
                show: 'slow',
                buttons: {
                    //"OK":function() {
                    //    window.location="index.php?view=list";
                    //},
                    "Cancel": function() {
                        $(this).dialog("close");
                        $(this).attr("class", "button");
                    }
                }
            });

            var dlgFirstButton = $('.ui-dialog-buttonpane').find('button:first');
            dlgFirstButton.addClass('button');
        });
    });
</script> 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2011-03-12T12:21:52.840

不幸的是，这里给出的解决方案没有适用于页面上的几个对话框。

问题还在于原始对话框本身不包含按钮窗格，而是它的兄弟。

所以我想出了这样的对话框ID选择：

```
 var getFirstDialogButton = function (dialogSelector) {
            return $('.ui-dialog-buttonpane button:first',
                    $(dialogSelector).parent()[0]);
        }; 
```

...

```
 $('#my_dialog').dialog({
            open: function(event, ui) {
                getFirstDialogButton("#my_dialog")
                 .addClass("ui-state-disabled").attr('disabled', 'disabled' );
            }, 
```

...

然后相同的 getFirstDialogBu​​tton() 函数可以稍后用于启用按钮，例如在成功验证之后。

希望它可以帮助某人。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2011-05-12T19:07:21.827

这是我刚刚使用分配按钮的 Array 方法实现的示例，然后允许我稍后使用 id 选择器 - 正如最初接受的答案所述 - 启用/禁用按钮，甚至完全显示/隐藏它们正在做。

```
$( "#dialog-form" ).dialog({
autoOpen: true,
height: 500,
width: 450,
modal: true,
buttons: [
{
    id: "submit_btn",
    text: "Make Apointment",
    click: function() { 
        //do ajax       
    }       
},
{
    id: "cancel_btn",
    text: "Cancel",
    click: function() {
       $( this ).dialog( "close" );
    }
},
{
    id: "ok_btn",
    text: "OK",
    click: function() {
       $( this).dialog('close');
    },
    disabled: "disabled"
}],
close: function() {
    allFields.val( "" ).removeClass( "ui-state-error" );
}
}); 
```

成功提交后，我禁用并隐藏了两个按钮，并启用了默认禁用的 OK 按钮。

```
$('#submit_btn, #cancel_btn').attr('disabled','disabled').addClass('ui-state-disabled').hide();
$('#ok_btn').attr('disabled','').removeClass('ui-state-disabled').show(); 
```

希望这可以帮助。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2011-08-24T11:50:50.733

我创建了一个类似于 Nick 所做的函数，但我的方法不需要设置 dialogClass，您将能够通过 id 获取特定对话框的按钮（如果您的应用程序中存在多个按钮）

```
function getDialogButton( dialog_id, button_name) {
    var target = '#'+dialog_id;
    var buttons = $(target).parent().find('button');
    for ( var i=0; i<buttons.length; ++i ) {
        var jButton = $( buttons[i] );
        if ( jButton.text() == button_name ) {
              return jButton;
        }
    }
    return null;
} 
```

因此，如果您像这样创建对话框：

```
$(function() {
    $("#myDialogBox").dialog({

      bgiframe: true, height: 'auto', width: 700, modal: true,
      buttons: {
        'Add to request list': function() {
                                     $(this).dialog('close');
                                     $('form').submit();
                               },
        'Cancel': function() {
                       $(this).dialog('close');
                  }
      }
}); 
```

您可以通过执行以下操作来获取按钮：

```
var addToRequestListBtn = getDialogButton('myDialogBox','Add to request list');
var cancelBtn           = getDialogButton('myDialogBox','Cancel'); 
```

要禁用：

```
addToRequestListBtn.attr('disabled', true).addClass( 'ui-state-disabled');
          cancelBtn.attr('disabled', true).addClass( 'ui-state-disabled'); 
```

启用：

```
addToRequestListBtn.attr('disabled', false).removeClass( 'ui-state-disabled');
          cancelBtn.attr('disabled', false).removeClass( 'ui-state-disabled'); 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2016-09-15T07:30:04.377

根据**文档**：

[https://api.jqueryui.com/dialog/#option-buttons](https://api.jqueryui.com/dialog/#option-buttons)

```
// Setter
$( ".selector" ).button( "option", "disabled", true ); 
```

为了能够简单地选择按钮，您可以向按钮添加自己的 CSS 类，应该启用/禁用。

```
// while initializing
$("#dialog").dialog({
...
buttons: [{
    disabled: true,
    text: "Add to request list",
    click: function (e: JQueryEventObject) {
        // Some logic
    },
    "class": "myDialogButton"
}]
...
}); 
```

然后启用/禁用将如下所示：

```
$(".myDialogButton" ).button( "option", "disabled", (SOME_CONDITION) ? true : false); 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2011-06-29T09:55:11.907

要禁用我的对话框中的保存按钮，请在您的函数中使用以下行。

```
$(".ui-dialog-buttonpane button:contains('Save')").attr("disabled", true).addClass("ui-state-disabled"); 
```

要更改按钮中的文本，请使用以下行（这会将取消按钮文本更改为关闭我）

```
 $(".ui-dialog-buttonpane button:contains('Cancel') span").text("Close Me"); 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2010-10-29T08:33:32.000

在 jQuery 世界中，如果你想从一组 DOM 元素中选择一个对象，你应该使用[eq()](http://api.jquery.com/eq/)。

**例子：**

> var button = $('button').eq(1);

或者

> var button = $('button:eq(1)');

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2011-06-29T10:15:49.933

@Chris您可以使用以下代码行来启用/禁用对话框按钮，直到您的复选框选中/取消选中

```
<div id="dialog-confirm" title="test">
    <label>Enable Confirm?<input type="checkbox" checked /></label>
</div>

    $("#dialog-confirm").dialog({
    resizable: false,
    height:240,
    modal: true,
    buttons: {
        Cancel: function() {
            $(this).dialog('close');
        },
        'Confirm': function() {
            $(this).dialog('close');
        }
    }
});

    $("#dialog-confirm :checkbox").change(function() {
        $(".ui-dialog-buttonpane button:contains('Confirm')")
           .button(this.checked ? "enable" : "disable");
    }); 
```

原文来源：http: [//jsfiddle.net/nick_craver/rxZPv/1/](http://jsfiddle.net/nick_craver/rxZPv/1/)

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2011-11-25T10:58:24.467

调用`.attr("disabled", true)`当然可以，但是使用 jQuery 你想以更“糖”的方式来做，所以我写了简单的扩展：

```
(function( $ ) {
  $.fn.disable = function(isDisabled) {
    var val = isDisabled;
    if (isDisabled === undefined)
        val = true;
    this.attr("disabled", val);
  };
  $.fn.enable = function(isEnabled) {
    var val = !isEnabled;
    if (isEnabled === undefined)
        val = false;
    this.attr("disabled", val); 
  }
})( jQuery ); 
```

现在你有了函数`enable()`and `disable()`，所以你可以这样完成你的工作：

```
$('#continueButton').disable(); 
```

这与

```
$('#continueButton').disable(true); 
```

和

```
$('#continueButton').enable(false); 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2012-03-07T12:26:15.237

这为我完成了工作：

```
$find("<%= btnPrint.ClientID %>").set_enabled(true); 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2013-12-09T23:41:01.860

如果有人希望在单击时用加载动画之类的东西替换按钮（例如，当“提交”按钮在对话框中提交表单时） - 您可以用您的图像替换按钮，如下所示：

```
...
buttons: {
    "Submit": function(evt) {
        $(evt.target).closest('button').replaceWith('<img src="loading.gif">');
    }
} 
```

[jQuery 替换文档](http://api.jquery.com/replaceWith/)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2014-09-25T19:06:59.607

要禁用一个按钮，在对话框打开时：

```
$("#InspectionExistingFacility").dialog({
    autoOpen: false, modal: true, width: 700, height: 550,
    open: function (event, ui) {
        $("#InspectionExistingFacility").parent().find(":button:contains('Next')").prop("disabled", true).addClass("ui-state-disabled");
    },
    show: { effect: "fade", duration: 600 }, hide: { effect: "slide", duration: 1000 },
    buttons: { 'Next step': function () { }, Close: function () { $(this).dialog("close"); } }
}); 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2014-10-16T11:15:18.240

我有一个按钮，我不想在触发点之前显示。

起初我尝试了这个有效的方法： -

```
$(":button:contains('OK')").hide(); 
```

但留下一行（因为他们都走了！），所以在我的 CSS 中添加了这个：-

```
.ui-dialog .ui-dialog-buttonpane {
display: none;
} 
```

这隐藏了所有按钮。

我可以在需要时通过以下方式重新启用：-

```
$('.ui-dialog .ui-dialog-buttonpane').css({"display":"block"}); //show button 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-08-17T23:44:40.263

jQuery 解决方案对我有用。

```
$('.ui-button').addClass("ui-state-disabled");$('.ui-button').attr("aria-disabled",'true');$('.ui-button').prop('disabled', true); 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2019-11-04T04:05:08.057

您可以简单地将 id 添加到按钮，它不在文档中，但它可以工作。

`$().dialog(buttons:[{id:'your button id'....}]);`

然后在你的函数中使用

```
$('#your button id') 
```

禁用它。

# c - 什么时候汇编比 C 快？

> ID：577554
> 
> 赞同：503
> 
> 时间：2009-02-23T13:03:26.950
> 
> 标签：c, performance, assembly

了解汇编程序的原因之一是，有时，它可以用来编写比用高级语言（尤其是 C 语言）编写代码性能更高的代码。但是，我也多次听到它说，尽管这并不完全错误，但**实际上**可以使用汇编程序生成更高性能代码的情况极为罕见，并且需要汇编方面的专业知识和经验。

这个问题甚至没有涉及汇编程序指令将是机器特定且不可移植的事实，或者汇编程序的任何其他方面。当然，除了这一点之外，了解汇编还有很多充分的理由，但这意味着这是一个征求示例和数据的特定问题，而不是关于汇编程序与高级语言的扩展讨论。

任何人都可以提供一些**具体**的例子，说明汇编比使用现代编译器编写良好的 C 代码更快，你能用分析证据支持这个说法吗？我非常有信心这些案例存在，但我真的很想知道这些案例到底有多深奥，因为这似乎是一些争论的焦点。

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2009-02-23T14:48:58.663

这是一个真实世界的例子：旧编译器上的定点乘法。

这些不仅在没有浮点的设备上派上用场，而且在精度方面表现出色，因为它们为您提供 32 位精度和可预测的错误（浮点只有 23 位，更难预测精度损失）。即在整个范围内统一的*绝对*精度，而不是接近统一的*相对*精度（`float`）。

* * *

现代编译器很好地优化了这个定点示例，因此对于仍然需要编译器特定代码的更现代示例，请参阅

*   [获得 64 位整数乘法的高部分](https://stackoverflow.com/questions/28868367/getting-the-high-part-of-64-bit-integer-multiplication/50958815#50958815)：使用 `uint64_t`32x32 => 64 位乘法的可移植版本无法在 64 位 CPU 上进行优化，因此您需要内在函数或`__int128`64 位系统上的高效代码。
*   [Windows 32 位上的 _umul128](https://stackoverflow.com/questions/46870373/umul128-on-windows-32-bits)：MSVC 在将 32 位整数相乘转换为 64 时并不总是做得很好，因此内在函数有很大帮助。

* * *

C 没有全乘运算符（来自 N 位输入的 2N 位结果）。在 C 中表达它的常用方法是将输入转换为更宽的类型，并希望编译器能够识别输入的高位不感兴趣：

```
// on a 32-bit machine, int can hold 32-bit fixed-point integers.
int inline FixedPointMul (int a, int b)
{
  long long a_long = a; // cast to 64 bit.

  long long product = a_long * b; // perform multiplication

  return (int) (product >> 16);  // shift by the fixed point bias
} 
```

这段代码的问题是我们做了一些不能直接用 C 语言表达的事情。我们想将两个 32 位的数字相乘，得到一个 64 位的结果，我们返回中间的 32 位。但是，在 C 中，这种乘法并不存在。您所能做的就是将整数提升为 64 位并执行 64*64 = 64 乘法。

但是，x86（以及 ARM、MIPS 等）可以在一条指令中进行乘法运算。一些编译器过去常常忽略这个事实并生成调用运行时库函数来进行乘法运算的代码。移位 16 也通常由库例程完成（x86 也可以执行此类移位）。

所以我们只剩下一两个库调用来进行乘法运算。这会产生严重的后果。不仅移位速度较慢，而且必须在函数调用中保留寄存器，而且它也无助于内联和代码展开。

如果您在（内联）汇编程序中重写相同的代码，您可以获得显着的速度提升。

除此之外：使用 ASM 并不是解决问题的最佳方式。大多数编译器允许你使用一些内在形式的汇编指令，如果你不能用 C 来表达它们。例如，VS.NET2008 编译器将 32*32=64 位 mul 公开为 __emul，将 64 位移位公开为 __ll_rshift。

使用内在函数，您可以以 C 编译器有机会了解正在发生的事情的方式重写函数。这允许内联代码、分配寄存器、消除公共子表达式和常量传播。通过这种方式，您将比手写的汇编代码获得*巨大的性能提升。*

供参考：VS.NET 编译器的定点 mul 的最终结果是：

```
int inline FixedPointMul (int a, int b)
{
    return (int) __ll_rshift(__emul(a,b),16);
} 
```

定点除法的性能差异更大。通过编写几行 asm 行，我对除法重定点代码的改进高达 10 倍。

* * *

使用 Visual C++ 2013 为两种方式提供相同的汇编代码。

2007 年的 gcc4.1 也很好地优化了纯 C 版本。（Godbolt 编译器资源管理器没有安装任何早期版本的 gcc，但可能即使是较旧的 GCC 版本也可以在没有内在函数的情况下执行此操作。）

[请参阅Godbolt 编译器资源管理器](https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:'//+compiled+with+gcc+-mregparm+so+args+are+in+regs,+like+when+inlining%0A//+Remove+-m32+to+see+x86-64+code-gen%0A%0A//+static+inline%0Aint+FixedPointMul+(int+a,+int+b)+%7B%0A++long+long+a_long+%3D+a%3B+//+cast+to+64+bit.%0A++long+long+product+%3D+a_long+*+b%3B+//+perform+multiplication%0A++return+(int)+(product+%3E%3E+16)%3B++//+shift+by+the+fixed+point+bias%0A%7D%0A%0A//+Modern+compilers+know+that+32-bit+integers+cast+to+64%0A//+still+only+have+32+significant+bits,%0A//+so+one+32-bit+signed+multiply+is+sufficient%0A%0A%23ifdef+_MSC_VER%0A%23include+%3Cintrin.h%3E%0A//+static+inline%0Aint+FixedPointMul_msvc+(int+a,+int+b)+%7B%0A++++return+(int)+__ll_rshift(__emul(a,b),16)%3B%0A%7D%0A%23endif%0A%0A%0A/*+Intrinsics+are+more+useful+for+extended+precision%0A+*+when+there+isn!'t+a+wide-enough+type.%0A+*+e.g.+128-bit+integer+on+compilers+without+__int128%0A+*/%0A'),l:'5',n:'0',o:'C%2B%2B+source+%231',t:'0')),k:32.75251522372254,l:'4',n:'0',o:'',s:0,t:'0'),(g:!((g:!((h:compiler,i:(compiler:g412,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'1',trim:'1'),lang:c%2B%2B,libs:!(),options:'-xc+-O3+-m32++-fomit-frame-pointer',source:1),l:'5',n:'0',o:'x86-64+gcc+4.1.2+(Editor+%231,+Compiler+%231)+C%2B%2B',t:'0')),k:34.10775747948107,l:'4',m:50,n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:arm710,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',trim:'1'),lang:c%2B%2B,libs:!(),options:'-xc+-O3+-mthumb+-mcpu%3Dcortex-m4',source:1),l:'5',n:'0',o:'ARM+gcc+7.2.1+(none)+(Editor+%231,+Compiler+%232)+C%2B%2B',t:'0')),header:(),l:'4',m:50,n:'0',o:'',s:0,t:'0')),k:33.91415144294414,l:'3',n:'0',o:'',t:'0'),(g:!((g:!((h:compiler,i:(compiler:clang30,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',trim:'1'),lang:c%2B%2B,libs:!(),options:'-xc+-O3+-m32',source:1),l:'5',n:'0',o:'x86-64+clang+3.0.0+(Editor+%231,+Compiler+%233)+C%2B%2B',t:'0')),k:33.33333333333333,l:'4',m:50,n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:cl19_2015_u3_32,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',trim:'1'),lang:c%2B%2B,libs:!(),options:'-Ox',source:1),l:'5',n:'0',o:'x86+MSVC+19+2015+U3+(Editor+%231,+Compiler+%234)+C%2B%2B',t:'0')),header:(),l:'4',m:50,n:'0',o:'',s:0,t:'0')),k:33.33333333333333,l:'3',n:'0',o:'',t:'0')),l:'2',n:'0',o:'',t:'0')),version:4)上的 x86（32 位）和 ARM 的 source + asm 。（不幸的是，它没有足够老的编译器从简单的纯 C 版本生成错误代码。）

* * *

**现代 CPU 可以做 C 根本没有操作符的事情*，*比如`popcnt`或位扫描来查找第一个或最后一个设置位**。（POSIX 有一个功能，但它的语义与 x86 /`ffs()`不匹配。请参阅[https://en.wikipedia.org/wiki/Find_first_set](https://en.wikipedia.org/wiki/Find_first_set)）。`bsf``bsr`

一些编译器有时可以识别一个循环，该循环计算整数中的设置位数并将其编译为`popcnt`指令（如果在编译时启用），但在 GNU C 或 x86 上使用它更可靠`__builtin_popcnt`，如果你只是使用 SSE4.2 定位硬件：[`_mm_popcnt_u32`来自`<immintrin.h>`](https://software.intel.com/sites/landingpage/IntrinsicsGuide/#text=_mm_popcnt&expand=4090).

或者在 C++ 中，分配给 a`std::bitset<32>`并使用`.count()`. （在这种情况下，该语言找到了一种通过标准库可移植地公开优化的 popcount 实现的方法，这种方式总是可以编译为正确的东西，并且可以利用目标支持的任何东西。）另见[https ://en.wikipedia.org/wiki/Hamming_weight#Language_support](https://en.wikipedia.org/wiki/Hamming_weight#Language_support)。

同样，`ntohl`可以在某些具有它的 C 实现上编译为`bswap`（x86 32 位字节交换以进行字节序转换）。

* * *

内在函数或手写 asm 的另一个主要领域是使用 SIMD 指令进行手动矢量化。`dst[i] += src[i] * 10.0;`编译器对简单的循环（如 例如，您不太可能得到类似[How to implement atoi using SIMD?](https://stackoverflow.com/questions/35127060/how-to-implement-atoi-using-simd) 由编译器从标量代码自动生成。

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2009-02-23T13:44:42.717

很多年前，我在教一个人用 C 编程。练习是将图形旋转 90 度。他返回了一个需要几分钟才能完成的解决方案，主要是因为他使用了乘法和除法等。

我向他展示了如何使用位移来重铸问题，在他拥有的非优化编译器上，处理时间缩短到大约 30 秒。

我刚刚获得了一个优化编译器，并且相同的代码在 < 5 秒内旋转了图形。我查看了编译器正在生成的汇编代码，从我所看到的那里决定，然后我编写汇编程序的日子结束了。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2009-02-23T14:27:22.067

几乎每当编译器看到浮点代码时，如果您使用的是旧的坏编译器，手写版本会更快。（**2019 年更新：对于现代编译器来说，这通常不是真的。** 尤其是在为 x87 以外的任何东西编译时；编译器更容易使用 SSE2 或 AVX 进行标量数学，或者任何具有平面 FP 寄存器集的非 x86，这与 x87 不同寄存器栈。）

主要原因是编译器无法执行任何稳健的优化。有关该主题的讨论，[请参阅 MSDN 的这篇文章。](http://msdn.microsoft.com/en-us/library/aa289157.aspx)这是一个示例，其中汇编版本的速度是 C 版本的两倍（使用 VS2K5 编译）：

```
#include "stdafx.h"
#include <windows.h>

float KahanSum(const float *data, int n)
{
   float sum = 0.0f, C = 0.0f, Y, T;

   for (int i = 0 ; i < n ; ++i) {
      Y = *data++ - C;
      T = sum + Y;
      C = T - sum - Y;
      sum = T;
   }

   return sum;
}

float AsmSum(const float *data, int n)
{
  float result = 0.0f;

  _asm
  {
    mov esi,data
    mov ecx,n
    fldz
    fldz
l1:
    fsubr [esi]
    add esi,4
    fld st(0)
    fadd st(0),st(2)
    fld st(0)
    fsub st(0),st(3)
    fsub st(0),st(2)
    fstp st(2)
    fstp st(2)
    loop l1
    fstp result
    fstp result
  }

  return result;
}

int main (int, char **)
{
  int count = 1000000;

  float *source = new float [count];

  for (int i = 0 ; i < count ; ++i) {
    source [i] = static_cast <float> (rand ()) / static_cast <float> (RAND_MAX);
  }

  LARGE_INTEGER start, mid, end;

  float sum1 = 0.0f, sum2 = 0.0f;

  QueryPerformanceCounter (&start);

  sum1 = KahanSum (source, count);

  QueryPerformanceCounter (&mid);

  sum2 = AsmSum (source, count);

  QueryPerformanceCounter (&end);

  cout << "  C code: " << sum1 << " in " << (mid.QuadPart - start.QuadPart) << endl;
  cout << "asm code: " << sum2 << " in " << (end.QuadPart - mid.QuadPart) << endl;

  return 0;
} 
```

以及我的 PC 上运行默认版本构建的一些数字^*：

```
 C code: 500137 in 103884668
asm code: 500137 in 52129147 
```

出于兴趣，我用 dec/jnz 交换了循环，这对时间没有影响——有时更快，有时更慢。我想内存有限的方面使其他优化相形见绌。（编者注：FP 延迟瓶颈更有可能足以隐藏`loop`. )

*哎呀，我运行的代码版本略有不同，它以错误的方式输出数字（即 C 更快！）。修复并更新了结果。*

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2009-02-23T13:17:06.997

在不提供任何具体示例或分析器证据的情况下，当您比编译器了解更多时，您可以编写比编译器更好的汇编器。

在一般情况下，现代 C 编译器更了解如何优化相关代码：它知道处理器管道是如何工作的，它可以尝试比人类更快地重新排序指令，等等 - 它基本上与一台计算机在棋盘游戏等方面与最佳人类玩家一样好或更好，仅仅是因为它可以比大多数人更快地在问题空间内进行搜索。虽然理论上你可以在特定情况下与计算机一样好，但你肯定不能以相同的速度做到这一点，这使得它在很多情况下都不可行（即，如果你尝试编写，编译器肯定会胜过你汇编程序中的多个例程）。

另一方面，在某些情况下，编译器没有那么多信息——我主要说的是在使用不同形式的外部硬件时，编译器对此一无所知。主要示例可能是设备驱动程序，其中汇编程序与人类对相关硬件的深入了解相结合可以产生比 C 编译器更好的结果。

其他人提到了特殊用途的指令，这就是我在上一段中所说的——编译器可能对这些指令知之甚少或根本不知道，从而使人类可以编写更快的代码。

* * *

## 回答 #5

> 赞同：54
> 
> 时间：2009-02-23T16:22:00.560

在我的工作中，我知道和使用汇编有三个原因。按重要性排序：

1.  调试——我经常得到有错误或不完整文档的库代码。我通过在装配级别介入来弄清楚它在做什么。我必须每周做一次。我还将它用作调试问题的工具，在这些问题中我的眼睛没有发现 C/C++/C# 中的惯用错误。看着组装就过去了。

2.  优化 - 编译器在优化方面做得相当好，但我的表现与大多数人不同。我编写的图像处理代码通常以如下所示的代码开头：

    ```
    for (int y=0; y < imageHeight; y++) {
        for (int x=0; x < imageWidth; x++) {
           // do something
        }
    } 
    ```

    “做某事”通常会发生数百万次（即 3 到 30 次）。通过在那个“做某事”阶段抓取周期，性能提升会被极大地放大。我通常不从那里开始 - 我通常首先编写代码以使其工作，然后尽我所能重构 C 以使其自然更好（更好的算法，更少的循环负载等）。我通常需要阅读汇编以了解发生了什么，并且很少需要编写它。我可能每两三个月做一次。

3.  做一些语言不允许我做的事情。这些包括 - 获取处理器架构和特定处理器功能，访问不在 CPU 中的标志（伙计，我真的希望 C 让您访问进位标志）等。我可能一年或两年这样做一次。

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2009-02-23T13:11:37.210

只有在使用某些特殊用途的指令集时，编译器才支持。

为了最大化具有多个管道和预测分支的现代 CPU 的计算能力，您需要以一种方式构建汇编程序，使其 a) 人类几乎不可能编写 b) 更不可能维护。

此外，更好的算法、数据结构和内存管理将为您提供至少一个数量级的性能，而不是您可以在汇编中进行的微优化。

* * *

## 回答 #7

> 赞同：39
> 
> 时间：2009-02-23T14:34:56.637

尽管 C 与 8 位、16 位、32 位、64 位数据的低级操作“接近”，但有一些 C 不支持的数学运算通常可以在某些汇编指令中优雅地执行套：

1.  定点乘法：两个 16 位数字的乘积是一个 32 位数字。但是 C 中的规则说两个 16 位数字的乘积是一个 16 位数字，两个 32 位数字的乘积是一个 32 位数字——在这两种情况下都是下半部分。如果您想要 16x16 乘法或 32x32 乘法的*上*半部分，则必须使用编译器玩游戏。一般的方法是转换为大于必要的位宽、乘法、下移和回退：

    ```
    int16_t x, y;
    // int16_t is a typedef for "short"
    // set x and y to something
    int16_t prod = (int16_t)(((int32_t)x*y)>>16);` 
    ```

    在这种情况下，编译器可能足够聪明，知道您实际上只是想获得 16x16 乘法的上半部分，并使用机器的本机 16x16 乘法做正确的事情。或者它可能是愚蠢的并且需要一个库调用来进行 32x32 乘法，这太过分了，因为你只需要 16 位的产品——但是 C 标准没有给你任何表达自己的方式。

2.  某些位移操作（旋转/进位）：

    ```
    // 256-bit array shifted right in its entirety:
    uint8_t x[32];
    for (int i = 32; --i > 0; )
    {
       x[i] = (x[i] >> 1) | (x[i-1] << 7);
    }
    x[0] >>= 1; 
    ```

    这在 C 中并不过分，但同样，除非编译器足够聪明地意识到你在做什么，否则它会做很多“不必要的”工作。许多汇编指令集允许您使用进位寄存器中的结果进行旋转或左移/右移，因此您可以在 34 条指令中完成上述操作：加载指向数组开头的指针，清除进位并执行 32 8-位右移，使用指针上的自动增量。

    再举一个例子，[线性反馈移位寄存器](http://en.wikipedia.org/wiki/Linear_feedback_shift_register)(LFSR) 可以在汇编中优雅地执行：取一块 N 位（8、16、32、64、128 等），将整个内容右移 1（见上文算法），那么如果结果进位是 1，那么你在一个代表多项式的位模式中进行异或。

话虽如此，除非我有严重的性能限制，否则我不会求助于这些技术。正如其他人所说，汇编比 C 代码更难记录/调试/测试/维护：性能提升伴随着一些严重的成本。

**编辑：** 3\. 在汇编中可以进行溢出检测（在 C 中不能真正做到），这使得一些算法更容易。

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2009-02-23T13:35:59.227

简短的回答？有时。

从技术上讲，每个抽象都有成本，而编程语言是 CPU 工作方式的抽象。然而，C 非常接近。几年前，当我登录我的 UNIX 帐户并收到以下幸运消息时，我记得大声笑了起来（当这样的事情很流行时）：

> C 编程语言——一种结合了汇编语言的灵活性和汇编语言的力量的语言。

这很有趣，因为它是真实的：C 就像可移植的汇编语言。

值得注意的是，无论您编写什么汇编语言都可以运行。然而，在 C 和它生成的汇编语言之间有一个编译器，这非常重要，因为**C 代码的速度与编译器的好坏有很大关系。**

当 gcc 出现时，使它如此流行的原因之一是它通常比许多商业 UNIX 风格附带的 C 编译器要好得多。它不仅是 ANSI C（这些 K&R C 都不是垃圾），而且更健壮并且通常生成更好（更快）的代码。不总是但经常。

我告诉你这一切是因为没有关于 C 和汇编程序速度的一揽子规则，因为 C 没有客观标准。

同样，汇编程序也因您运行的处理器、系统规格、使用的指令集等而有很大差异。历史上有两个 CPU 架构系列：CISC 和 RISC。CISC 中最大的参与者过去和现在仍然是 Intel x86 架构（和指令集）。RISC 主导了 UNIX 世界（MIPS6000、Alpha、Sparc 等）。CISC赢得了民心之战。

无论如何，当我还是一个年轻的开发人员时，流行的看法是手写 x86 通常比 C 快得多，因为架构的工作方式，它具有复杂性，这得益于人类这样做。另一方面，RISC 似乎是为编译器设计的，所以没有人（我知道）写过 Sparc 汇编器。我确信这样的人确实存在，但毫无疑问，他们现在都已经疯了，并且已经被制度化了。

即使在同一系列处理器中，指令集也是一个重要的点。某些英特尔处理器具有 SSE 到 SSE4 等扩展。AMD 有自己的 SIMD 指令。像 C 这样的编程语言的好处是有人可以编写他们的库，因此它针对您运行的任何处理器进行了优化。那是汇编程序中的艰苦工作。

您仍然可以在汇编程序中进行任何编译器无法进行的优化，并且编写良好的汇编程序算法将与 C 等效项一样快或更快。更大的问题是：值得吗？

最终，尽管汇编程序是其时代的产物，并且在 CPU 周期昂贵的时候更受欢迎。如今，制造成本为 5-10 美元的 CPU（英特尔凌动）几乎可以做任何人想做的任何事情。如今，编写汇编程序的唯一真正原因是用于低层次的东西，例如操作系统的某些部分（即使绝大多数 Linux 内核都是用 C 编写的）、设备驱动程序，可能还有嵌入式设备（尽管 C 往往在那里占主导地位）太）等等。或者只是为了踢球（这有点自虐）。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2011-04-05T21:05:27.303

我很惊讶没有人这么说。如果用汇编编写，该`strlen()`函数会快得多！在 C 中，你能做的最好的事情是

```
int c;
for(c = 0; str[c] != '\0'; c++) {} 
```

在组装时，您可以大大加快速度：

```
mov esi, offset string
mov edi, esi
xor ecx, ecx

lp:
mov ax, byte ptr [esi]
cmp al, cl
je  end_1
cmp ah, cl
je end_2
mov bx, byte ptr [esi + 2]
cmp bl, cl
je end_3
cmp bh, cl
je end_4
add esi, 4
jmp lp

end_4:
inc esi

end_3:
inc esi

end_2:
inc esi

end_1:
inc esi

mov ecx, esi
sub ecx, edi 
```

长度以 ecx 为单位。这一次比较 4 个字符，因此速度提高了 4 倍。并且认为使用 eax 和 ebx 的高位词，它会比之前的 C 例程*快 8 倍！*

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2009-02-23T13:44:14.217

第一点不是答案。
即使您从未在其中编程，我发现了解至少一个汇编指令集也很有用。这是程序员永无止境地寻求了解更多并因此变得更好的一部分。在进入您没有源代码并且至少大致了解正在发生的事情的框架时也很有用。它还可以帮助您理解 JavaByteCode 和 .Net IL，因为它们都类似于汇编程序。

当您有少量代码或大量时间时回答这个问题。最适用于嵌入式芯片，其中低芯片复杂性和针对这些芯片的编译器竞争不激烈可以使天平向有利于人类的方向倾斜。此外，对于受限设备，您通常会以难以指示编译器执行的方式权衡代码大小/内存大小/性能。例如，我知道这个用户操作不经常被调用，所以我的代码量很小，性能很差，但是这个看起来相似的另一个函数每秒都会使用一次，所以我会有更大的代码量和更快的性能。这是熟练的汇编程序员可以使用的一种权衡。

我还想补充一点，您可以在很多中间地带使用 C 编译代码并检查生成的程序集，然后更改您的 C 代码或调整和维护为程序集。

我的朋友从事微控制器工作，目前是用于控制小型电动机的芯片。他在低级 c 和汇编的组合中工作。他曾经告诉我在工作中度过了美好的一天，他将主循环从 48 条指令减少到 43 条。他还面临着选择，比如代码已经增长到填充 256k 芯片，而企业需要一个新功能，你呢？

1.  删除现有功能
2.  减少部分或全部现有功能的大小可能会以性能为代价。
3.  提倡转向成本更高、功耗更高、外形尺寸更大的更大芯片。

作为一名商业开发人员，我想补充一下，我从来没有觉得有必要深入编写程序集。我一直很感激我从中获得的知识。有时调试到它。

我知道我已经回答了“我为什么要学习汇编程序”这个问题，但我觉得这是一个更重要的问题，然后什么时候更快。

所以让我们再试一次你应该考虑组装

*   处理低级操作系统功能
*   在编译器上工作。
*   在极其有限的芯片、嵌入式系统等上工作

请记住将您的程序集与生成的编译器进行比较，以查看哪个更快/更小/更好。

大卫。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2009-02-23T13:50:31.267

一个可能不再适用但为了你的书呆子乐趣的用例：在 Amiga 上，CPU 和图形/音频芯片将争夺访问 RAM 的某个区域（具体来说是前 2MB 的 RAM）。因此，当您只有 2MB RAM（或更少）时，显示复杂的图形加上播放声音会降低 CPU 的性能。

在汇编程序中，您可以以一种巧妙的方式交错代码，使得 CPU 只会在图形/音频芯片内部繁忙时（即总线空闲时）尝试访问 RAM。因此，通过重新排序指令、巧妙地使用 CPU 缓存、总线时序，您可以获得一些使用任何高级语言根本无法实现的效果，因为您必须对每个命令进行计时，甚至在这里和那里插入 NOP 以保持各种从彼此的雷达中剔除。

这也是为什么 CPU 的 NOP（无操作 - 无操作）指令实际上可以使您的整个应用程序运行得更快的另一个原因。

[编辑] 当然，该技术取决于特定的硬件设置。这就是为什么许多 Amiga 游戏无法应对更快的 CPU 的主要原因：指令的时间不正确。

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2009-02-23T13:06:09.423

使用 SIMD 指令的矩阵运算可能比编译器生成的代码更快。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2009-10-15T17:07:57.893

根据我的经验举几个例子：

*   访问不能从 C 中访问的指令。例如，许多体系结构（如 x86-64、IA-64、DEC Alpha 和 64 位 MIPS 或 PowerPC）支持 64 位乘 64 位乘法产生 128 位结果。GCC 最近添加了一个扩展，提供对此类指令的访问，但在该程序集之前是必需的。在 64 位 CPU 上实现 RSA 之类的东西时，访问该指令可以产生巨大的影响——有时性能提高了 4 倍。

*   访问特定于 CPU 的标志。让我印象深刻的是进位标志。在进行多精度加法时，如果您无法访问 CPU 进位位，则必须比较结果以查看它是否溢出，每个分支需要多 3-5 条指令；更糟糕的是，这在数据访问方面是相当连续的，这会降低现代超标量处理器的性能。当连续处理数千个这样的整数时，能够使用 addc 是一个巨大的胜利（进位位也存在争用的超标量问题，但现代 CPU 可以很好地处理它）。

*   SIMD。即使是自动向量化编译器也只能处理相对简单的情况，因此如果您想要良好的 SIMD 性能，不幸的是通常需要直接编写代码。当然，您可以使用内在函数而不是汇编，但是一旦您处于内在函数级别，您基本上就是在编写汇编，只需将编译器用作寄存器分配器和（名义上）指令调度程序。（我倾向于为 SIMD 使用内部函数，因为编译器可以为我生成函数序言等等，所以我可以在 Linux、OS X 和 Windows 上使用相同的代码，而不必处理函数调用约定等 ABI 问题，但其他比 SSE 内在函数真的不是很好 - 尽管我对它们没有太多经验，但 Altivec 似乎更好）。[bitslicing AES](http://eprint.iacr.org/2009/129)或[SIMD 纠错](http://www.randombit.net/bitbashing/programming/forward_error_correction_using_simd.html)- 可以想象一个编译器可以分析算法并生成这样的代码，但在我看来，这样的智能编译器至少离现有的编译器还有 30 年的时间（充其量）。

另一方面，多核机器和分布式系统已经将许多最大的性能优势转移到另一个方向——在汇编中编写内部循环获得额外 20% 的加速，或者通过在多个内核上运行它们来提高 300%，或者通过 10000%在一组机器上运行它们。当然，在 ML 或 Scala 等高级语言中，高级优化（如期货、记忆等）通常比 C 或 asm 更容易实现，并且通常可以提供更大的性能提升。因此，与往常一样，需要做出权衡。

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2009-02-23T13:29:33.847

我不能给出具体的例子，因为那是太多年前的事了，但是在很多情况下，手写的汇编程序可以胜过任何编译器。原因：

*   您可以偏离调用约定，在寄存器中传递参数。

*   您可以仔细考虑如何使用寄存器，并避免将变量存储在内存中。

*   对于跳转表之类的事情，您可以避免对索引进行边界检查。

基本上，编译器在优化方面做得很好，而且几乎总是“足够好”，但在某些情况下（如图形渲染），你为每个周期付出高昂的代价，你可以走捷径，因为你知道代码，编译器不能，因为它必须是安全的。

事实上，我听说过一些图形渲染代码，其中一个例程，如画线或多边形填充例程，实际上会在堆栈上生成一小块机器代码并在那里执行，以避免持续决策关于线条样式、宽度、图案等。

也就是说，我希望编译器为我生成好的汇编代码，但不要太聪明，他们大多这样做。事实上，我讨厌 Fortran 的一件事是它扰乱代码以试图“优化”它，通常没有什么重要的目的。

通常，当应用程序出现性能问题时，这是由于设计浪费。这些天来，除非整个应用程序已经在其生命周期内调整过，仍然不够快，并且将所有时间都花在紧密的内部循环中，否则我永远不会推荐使用汇编程序来提高性能。

补充：我见过很多用汇编语言编写的应用程序，与 C、Pascal、Fortran 等语言相比，主要的速度优势是因为程序员在用汇编语言编码时要小心得多。他或她每天将编写大约 100 行代码，无论语言如何，并且使用相当于 3 或 400 条指令的编译器语言。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2014-03-15T13:41:19.447

比你想象的更多，C 需要做一些从汇编编码员的角度来看似乎不必要的事情，只是因为 C 标准是这样说的。

例如，整数提升。如果您想在 C 中移动一个 char 变量，通常会期望代码实际上会这样做，即一个位移位。

然而，这些标准强制编译器在移位之前将符号扩展为 int，然后将结果截断为 char，这可能会使代码复杂化，具体取决于目标处理器的体系结构。

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2009-02-23T13:09:46.450

如果您没有查看编译器生成的反汇编，您实际上并不知道您编写良好的 C 代码是否真的很快。很多时候你看它，发现“写得好”是主观的。

因此，没有必要用汇编程序编写以获得最快的代码，但出于同样的原因，了解汇编程序当然是值得的。

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2009-02-23T16:07:28.410

紧密循环，例如在播放图像时，因为图像可能包含数百万像素。坐下来弄清楚如何最好地利用有限数量的处理器寄存器可能会有所作为。这是一个真实的示例：

[http://danbystrom.se/2008/12/22/optimizing-away-ii/](http://danbystrom.se/2008/12/22/optimizing-away-ii/)

然后，处理器通常有一些深奥的指令，这些指令过于专业，编译器无法处理，但有时汇编程序员可以很好地利用它们。以 XLAT 指令为例。如果您需要在循环中进行表查找*并且*表限制为 256 字节，那真是太好了！

更新：哦，当我们谈到一般的循环时，想想什么是最关键的：编译器通常不知道有多少次迭代是常见的情况！只有程序员知道一个循环会被迭代很多次，因此为循环做一些额外的工作是有益的，或者如果它被迭代的次数很少以至于设置实际上比迭代花费的时间更长预期的。

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2017-06-30T18:37:07.007

我已经阅读了所有答案（超过 30 个）并没有找到一个简单的原因：如果您阅读并实践过[英特尔® 64 和 IA-32 架构优化参考手册](https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf)，汇编程序比 C 更快，**所以汇编的原因可能更慢的是写这么慢程序集的人没有阅读优化手册**。

在 Intel 80286 的过去，每条指令都以固定的 CPU 周期数执行。尽管如此，自 1995 年发布的 Pentium Pro 以来，英特尔处理器变得超标量，利用复杂流水线：乱序执行和寄存器重命名。在此之前，在 1993 年生产的 Pentium 上，有 U 和 V 管道。因此，奔腾引入了双流水线，如果它们不相互依赖，它们可以在一个时钟周期内执行两条简单的指令。然而，这与 Pentium Pro 中出现的乱序执行和寄存器重命名相比，根本算不上什么。Pentium Pro 中引入的这种方法现在在最新的 Intel 处理器上几乎相同。

让我用几句话解释一下乱序执行。最快的代码是指令不依赖于先前结果的地方，例如，您应该始终清除整个寄存器（通过`movzx`）以消除您正在使用的寄存器的先前值的依赖性，因此它们可以由 CPU 在内部重命名以允许指令并行执行或以不同的顺序执行。或者，在某些处理器上，可能存在错误依赖，这也可能会减慢速度，例如[对 Pentium 4 的错误依赖 inc/dec](https://stackoverflow.com/a/36510865/6910868)，因此您可能希望`add eax, 1`改用或`inc eax`删除对标志的先前状态的依赖。

如果时间允许，您可以阅读有关乱序执行和寄存器重命名的更多信息。互联网上有大量可用信息。

还有许多其他基本问题，例如分支预测、加载和存储单元的数量、执行微操作的门数、内存缓存一致性协议等，但要考虑的关键是乱序执行。大多数人根本不知道乱序执行。因此，他们编写类似于 80286 的汇编程序，期望他们的指令无论上下文如何都需要固定的时间来执行。同时，C 编译器知道乱序执行并正确生成代码。这就是为什么这些不知情的人的代码比较慢，但是如果你变得知识渊博，你的代码会更快。

除了乱序执行之外，还有很多优化技巧和窍门。只需阅读上面提到的优化手册 :-)

然而，汇编语言在优化方面有其自身的缺点。根据 Peter Cordes（见下面的评论）的说法，编译器所做的一些优化对于手写汇编中的大型代码库是不可维护的。例如，假设您使用汇编语言编写。在这种情况下，当内联函数（汇编宏）内联到一个调用它的函数时，您需要完全更改它，其中一些参数是常量。同时，C 编译器使其工作变得更加简单——并以不同的方式将相同的代码内联到不同的调用站点。您可以使用汇编宏执行的操作是有限度的。因此，为了获得相同的好处，您必须手动优化每个位置的相同逻辑，以匹配您拥有的常量和可用寄存器。

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2009-02-23T13:11:08.757

我认为汇编程序更快的一般情况是，当一个聪明的汇编程序员查看编译器的输出并说“这是提高性能的关键途径，我可以编写它以提高效率”，然后那个人调整该汇编程序或重写它从头开始。

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2009-02-23T15:37:10.230

[Walter Bright 的 Optimizing Immutable and Purity](http://www.drdobbs.com/architecture-and-design/optimizing-immutable-and-purity/228700592)可能值得一看，它不是一个分析测试，而是向您展示了一个很好的例子，说明了手写和编译器生成的 ASM 之间的区别。Walter Bright 撰写了优化编译器的文章，因此可能值得查看他的其他博客文章。

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2009-02-24T04:58:27.543

这完全取决于您的工作量。

对于日常操作，C 和 C++ 就可以了，但是有一些工作负载（任何涉及视频的转换（压缩、解压缩、图像效果等））几乎需要汇编才能发挥性能。

它们通常还涉及使用针对这些操作进行调整的 CPU 特定芯片组扩展（MME/MMX/SSE/其他）。

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2009-02-23T15:50:00.730

[LInux assembly howto](http://tldp.org/HOWTO/Assembly-HOWTO/doyouneed.html)，提出了这个问题并给出了使用程序集的优缺点。

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2009-05-24T15:28:46.703

我有一个需要完成的位转置操作，每个中断在 192 或 256 位上，每 50 微秒发生一次。

它通过固定的地图（硬件约束）发生。使用 C，大约需要 10 微秒来完成。当我把它翻译成 Assembler 时，考虑到这个映射的具体特性，具体的寄存器缓存，以及使用面向位的操作；执行时间不到 3.5 微秒。

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2009-11-22T21:22:26.650

简单的答案......一个对汇编*非常**了解*的人（也就是他旁边的参考资料，并且正在利用每一个小的处理器缓存和管道功能等）保证能够产生比*任何*编译器更快的代码。

 **然而，这些天的差异在典型应用程序中并不重要。

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2009-02-23T16:27:11.407

[http://cr.yp.to/qhasm.html](http://cr.yp.to/qhasm.html)有很多例子。

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2009-02-23T14:15:01.833

PolyPascal 的 CP/M-86 版本（Turbo Pascal 的同胞）的一个可能性是用机器语言例程替换“use-bios-to-output-characters-to-the-screen”设施，这在本质上是给定了 x 和 y，以及要放在那里的字符串。

这允许更新屏幕比以前快得多！

二进制文件中有空间可以嵌入机器代码（几百字节），还有其他东西，所以尽可能多地压缩是必不可少的。

事实证明，由于屏幕是 80x25，因此两个坐标都可以容纳在一个字节中，因此两者都可以容纳在一个双字节字中。这允许以更少的字节进行所需的计算，因为单个加法可以同时操作两个值。

据我所知，没有 C 编译器可以合并寄存器中的多个值，对它们执行 SIMD 指令，然后再将它们拆分出来（而且我不认为机器指令会更短）。

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2009-02-23T16:17:19.387

最著名的组装片段之一来自 Michael Abrash 的纹理映射循环（[在此处详细说明](http://chrishecker.com/images/5/5e/Gdmtex5.pdf)）：

```
add edx,[DeltaVFrac] ; add in dVFrac
sbb ebp,ebp ; store carry
mov [edi],al ; write pixel n
mov al,[esi] ; fetch pixel n+1
add ecx,ebx ; add in dUFrac
adc esi,[4*ebp + UVStepVCarry]; add in steps 
```

如今，大多数编译器将高级 CPU 特定指令表示为内在函数，即编译为实际指令的函数。MS Visual C++ 支持 MMX、SSE、SSE2、SSE3 和 SSE4 的内在函数，因此您不必担心下降到汇编以利用特定于平台的指令。Visual C++ 还可以通过适当的 /ARCH 设置利用您所针对的实际体系结构。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2009-02-23T16:24:53.067

给定合适的程序员，汇编程序总是可以比 C 对应程序更快（至少在一定程度上）。很难创建一个不能取出至少一条汇编程序指令的 C 程序。

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2009-05-24T15:14:32.677

gcc 已经成为一种广泛使用的编译器。它的优化一般不是那么好。比一般程序员写汇编要好得多，但对于真正的性能来说，并不是那么好。有些编译器生成的代码简直令人难以置信。因此，作为一般答案，您可以在很多地方进入编译器的输出并调整汇编器的性能，和/或简单地从头开始重新编写例程。

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2010-09-17T13:12:59.667

Longpoke，只有一个限制：时间。当您没有资源来优化对代码的每一次更改并花时间分配寄存器、优化少量溢出等等时，编译器每次都会获胜。您对代码进行修改、重新编译和测量。必要时重复。

此外，您可以在高级方面做很多事情。此外，检查生成的程序集可能会给人一种代码是垃圾的印象，但实际上它的运行速度会比您认为的更快。例子：

int y = 数据[i]; // 在这里做一些事情.. call_function(y, ...);

编译器将读取数据，将其推送到堆栈（溢出），然后从堆栈中读取并作为参数传递。听起来很鸡肋？它实际上可能是非常有效的延迟补偿并导致更快的运行时间。

// 优化版本 call_function(data[i], ...); // 毕竟没有那么优化..

优化版本的想法是，我们减少了套准压力并避免溢出。但实际上，“狗屎”版本更快！

看汇编代码，只看指令就得出结论：指令越多，越慢，会是误判。

这里需要注意的是：很多装配专家*认为*他们知道很多，但知道的很少。规则也会从架构更改为下一个。例如，没有灵丹妙药的 x86 代码，它总是最快的。这些天最好遵循经验法则：

*   内存很慢
*   缓存很快
*   尝试更好地使用缓存
*   你会错过多少次？你有延迟补偿策略吗？
*   您可以针对单个缓存未命中执行 10-100 条 ALU/FPU/SSE 指令
*   应用程序架构很重要..
*   ..但是当问题不在架构中时它没有帮助

此外，过于相信编译器会将考虑不周的 C/C++ 代码神奇地转换为“理论上最佳”的代码是一厢情愿的想法。如果您关心这个低级别的“性能”，您必须了解您使用的编译器和工具链。

对于初学者来说，C/C++ 中的编译器通常不太擅长重新排序子表达式，因为函数具有副作用。函数式语言不会受到这个警告的影响，但不能很好地适应当前的生态系统。有一些编译器选项允许宽松的精度规则，允许编译器/链接器/代码生成器更改操作顺序。

这个话题有点死胡同；对于大多数人来说，这无关紧要，而其余的，他们无论如何都知道自己在做什么。

这一切都归结为：“了解你在做什么”，这与知道你在做什么有点不同。

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2014-02-08T06:50:47.950

这个问题有点误导。答案就在您的帖子中。总是可以为特定问题编写汇编解决方案，其执行速度比编译器生成的任何问题都快。问题是您需要成为汇编专家才能克服编译器的限制。一个有经验的汇编程序员可以在任何比没有经验的人编写的程序执行得更快的 HLL 中编写程序。事实是，您总是可以编写比编译器生成的程序执行得更快的汇编程序。

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2015-04-19T10:26:15.773

**在运行时创建机器代码**怎么样？

 **我的兄弟曾经（大约在 2000 年）通过在运行时生成代码实现了一个极快的实时光线追踪器。我不记得细节了，但是有某种主模块在循环对象，然后它正在准备和执行一些特定于每个对象的机器代码。

然而，随着时间的推移，这种方法被新的图形硬件所取代，并且变得无用。

今天，我认为可能对大数据（数百万条记录）的一些操作，如数据透视表、钻取、即时计算等，可以使用这种方法进行优化。问题是：**努力​​值得吗？**

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2009-02-23T13:17:02.190

这很难具体回答，因为这个问题非常不具体：“现代编译器”到底是什么？

理论上，几乎所有手动汇编程序优化都可以由编译器完成 -通常不能说它是否真的完成，只能说特定编译器的特定版本*。*许多人可能需要付出很大的努力来确定它们是否可以在编译器编写者不理会的特定上下文中应用而没有副作用。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2009-02-24T11:55:42.033

在处理器速度以 MHz 为单位并且屏幕尺寸低于 1 兆像素的日子里，一个众所周知的加快显示速度的技巧是展开循环：对屏幕的每个扫描线进行写入操作。它避免了维护循环索引的开销！再加上屏幕刷新检测，效果还不错。
这是 C 编译器不会做的事情......（虽然您通常可以在速度优化或大小优化之间进行选择，但我想前者使用了一些类似的技巧。）

我知道有些人喜欢用汇编语言编写 Windows 应用程序。他们声称他们更快（难以证明）和更小（确实！）。
显然，虽然这样做很有趣，但可能是在浪费时间（当然，学习目的除外！），尤其是对于 GUI 操作...现在，也许某些操作，例如在文件中搜索字符串，可以通过以下方式进行优化精心编写的汇编代码。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2019-10-20T16:38:19.900

历史上的共鸣。

在我年轻得多的时候（1970 年代），根据我的经验，汇编程序对于代码的大小比代码的速度更重要。

如果高级语言中的模块是 1300 字节的代码，但模块的汇编版本是 300 字节，那么当您试图将应用程序放入 16K 或 32K 的内存时，1K 字节非常重要。

当时的编译器并不好。

在老式的 Fortran 中

```
X = (Y - Z)
IF (X .LT. 0) THEN
 ... do something
ENDIF 
```

当时的编译器执行了 SUBTRACT 指令，然后在 X 上执行了 TEST 指令。在汇编程序中，您只需检查减法后的条件代码（LT 零、零、GT 零）。

对于现代系统和编译器来说，这些都不是问题。

我确实认为理解编译器在做什么仍然很重要。当您使用高级语言编写代码时，您应该了解什么允许或阻止编译器进行循环展开。

当编译器执行“branch-likley”时，使用涉及条件​​的管道和前瞻计算

在执行高级语言不允许的操作时仍然需要汇编程序，例如读取或写入特定于处理器的寄存器。

但在很大程度上，普通程序员不再需要它，除了对如何编译和执行代码有一个基本的了解。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-02-23T14:31:10.467

我会说，当你在一组给定的指令方面比编译器更好时。所以我认为没有通用的答案

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2011-04-15T21:41:22.957

如今，考虑到像 Intel C++ 这样对 C 代码进行了极大优化的编译器，很难与编译器的输出竞争。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2014-08-19T15:09:15.827

实际上，您可以在大型模型模式下构建大型程序，段可能限制为 64kb 代码，但您可以编写很多段，人们反对 ASM，因为它是一种旧语言，我们不再需要保留内存，如果这就是为什么我们要用内存打包我们的 PC 的情况，我能找到的 ASM 的唯一缺陷是它或多或少基于处理器，因此大多数为英特尔架构编写的程序很可能不会在 AMD 架构上运行。至于 C 比 ASM 快，没有比 ASM 更快的语言，ASM 可以做很多 C 和其他 HLL 在处理器级别不能做的事情。ASM 是一门难学的语言，但一旦你学会了它，没有 HLL 能比你翻译得更好。如果您只能看到 HLL 对您的代码所做的一些事情，并了解它在做什么，您会想知道为什么更多人不使用 ASM 以及为什么不再更新汇编程序（无论如何供公众使用）。所以没有 C 不比 ASM 快。即使是经验丰富的 C++ 程序员仍然使用和编写代码块在 ASM 中添加到 C++ 代码中以提高速度。其他语言还有一些人认为已经过时或可能没有好处有时是一个神话，例如 Photoshop 是用 Pascal/ASM 编写的，souce 的第一个版本已提交给技术历史博物馆，而paintshop pro 仍然是用 Python 编写的， TCL 和 ASM ......“快速和伟大的图像处理器的共同点是 ASM，虽然 Photoshop 可能已经升级到 delphi 现在它仍然是帕斯卡。任何速度问题都来自帕斯卡，但这是因为我们喜欢这种方式程序看起来而不是他们现在所做的。我想在我一直在研究的纯 ASM 中制作一个 Photoshop 克隆，并且进展顺利。不是编码、解释、排列、重写等......只需编码并完成处理。

* * *

## 回答 #39

> 赞同：-3
> 
> 时间：2009-03-03T04:26:08.327

我曾经和一个人一起工作，他说“如果编译器愚蠢地弄清楚你正在尝试做什么并且无法优化它，那么你的编译器就坏了，是时候换一个新的了”。我确信在某些极端情况下汇编会击败您的 C 代码，但是如果您经常发现自己使用汇编程序来“赢得”您的编译器，那么您的编译器就会被破坏。

对于编写试图强制查询计划器执行操作的“优化”SQL 也可以这样说。如果您发现自己重新安排查询以让规划器做您想做的事情，那么您的查询规划器就被破坏了——换一个新的。

* * *

## 回答 #40

> 赞同：-3
> 
> 时间：2019-05-13T09:30:50.227

这个问题有点无意义，因为无论如何 c 被编译为汇编程序。但是，优化编译器产生的汇编程序几乎是完全优化的，所以除非你在优化特定汇编方面做了二十个博士学位，否则你无法击败编译器。

# javascript - Javascript变量范围问题

> ID：577564
> 
> 赞同：0
> 
> 时间：2009-02-23T13:08:14.630
> 
> 标签：javascript

如果我有这样的功能：

```
function validateSomething()
{
  var valid;
  $.post("something.php", {x:y},
  function(data)
  {
     if (isSomething(data))
       valid=true; 
       //Here referring to the valid variable 
       //set outside this function, in the
       // parent function
     else
       valid=false; 
  });
  return valid/
} 
```

是否可以`valid`在 Ajax 请求完成后调用的子函数中进行设置？如果没有，如何根据 ajax 请求的结果从父函数返回真/假？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T13:11:53.093

> 如果没有，如何根据 ajax 请求的结果从父函数返回真/假？

你不能；这不是[异步](http://en.wikipedia.org/wiki/Asynchrony)的工作方式。

AJAX 调用甚至可能永远不会返回！

父函数应该触发验证请求，然后假设它无效（例如，通过禁用提交按钮）或显示“我正在考虑”反馈（旋转指示器）。

然后 AJAX 返回处理函数将清理这些部分（通过启用按钮或将指示器更改为绿色复选标记或红色 X）。如果 AJAX 调用从未通过 - 它保持无效。如果它确实通过了，那就是清理发生的时候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T13:11:59.503

有效将被更新，是的。但是：AJAX-Call 是异步的，即。您的函数肯定会在父函数返回后被调用。没有办法等待异步过程完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T13:16:17.433

虽然您可以从内部函数设置变量，但由于一旦帖子异步完成就会调用内部函数，因此不会及时设置返回。根据您要执行的操作，您可以通过让回调函数简单地调用将根据返回值发生的操作来处理它。例如，如果你点击了一个链接，如果你的帖子成功了，你就可以从你的 validateSomething 函数中返回 false ，然后在成功的帖子中，从链接中获取 href 并使用它的值设置 location.href 来模拟效果被点击的链接（无需重新运行您的验证功能）。

# php - XML/SWF 图表的 PHP 包装器

> ID：577569
> 
> 赞同：1
> 
> 时间：2009-02-23T13:10:25.840
> 
> 标签：php, charts, xml-swf-charts

任何人都知道是否有用于 [XML/SWF 图表的最新版本 (5.X) 的 PHP 包装器](http://www.maani.us/xml_charts/index.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T13:36:07.747

[http://www.maani.us/charts/index.php](http://www.maani.us/charts/index.php)

*“从 5.0 版开始，这个图表工具没有专用的 PHP 界面。但是，PHP 或任何其他脚本语言仍然可以与 XML/SWF 图表（同一工具的 XML 版本）一起使用。”*

有一些示例如何将 XML 版本与 PHP 一起使用：

[http://www.maani.us/xml_charts/index.php?menu=Reference&submenu=Scripting](http://www.maani.us/xml_charts/index.php?menu=Reference&submenu=Scripting)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-06T14:47:38.240

作为另一个项目的一部分，我开发了一个开源 CodeIgniter 库，用于生成 XML/SWF 图表所需的 XML：http: [//milktek.com/XML-SWF-Charts-for-CI](http://milktek.com/XML-SWF-Charts-for-CI)

但是，查看这个库中的代码，我相信它也可以在 CodeIgniter 之外工作。只需创建一个新`Maani_xml_swf_charts`对象并调用各种可用方法。它应该可以工作，因为库中没有依赖 CodeIgniter 的代码。

```
$mxsc = new Maani_xml_swf_charts();
$mxsc->chart_type("stacked column");
$mxsc->chart_data(
                   array("sales","non-sales"),
                   array("Clothing","Food","Toys"),
                   array(
                          array("100","145"),
                          array("34","54"),
                          array("84","21")));
$mxsc->chart_label(array(
                          "shadow"=>'low',
                          "color"=>'ffffff',
                          "alpha"=>'95',
                          "size"=>'20',
                          "position"=>'inside',
                          "as_percentage"=>'true')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-03T07:47:27.647

我不知道XML/SWF图表软件，但是如果你喜欢手工编码，你可以使用PHP的XML类和Ming来动态创建图表。您只需解析文件中的 xml 数据，并将其传递给 Ming 对象进行处理。然后在完成后包括 swf。

简单的！

;-)

# java - 在java中使用关键字“this”

> ID：577575
> 
> 赞同：20
> 
> 时间：2009-02-23T13:11:57.897
> 
> 标签：java, keyword

我试图了解 java 关键字的`this`实际作用。我一直在阅读 Sun 的文档，但我仍然不清楚`this`实际做了什么。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-23T13:14:09.687

`this`关键字是对当前对象的引用。

```
class Foo
{
    private int bar;

    public Foo(int bar)
    {
        // the "this" keyword allows you to specify that
        // you mean "this type" and reference the members
        // of this type - in this instance it is allowing
        // you to disambiguate between the private member
        // "bar" and the parameter "bar" passed into the
        // constructor
        this.bar = bar;
    }
} 
```

另一种思考方式是，`this`关键字就像您用来指代自己的人称代词。其他语言对相同的概念有不同的词。VB 使用`Me`和 Python 约定（因为 Python 不使用关键字，只是每个方法的隐式参数）是使用`self`.

如果您要引用本质上属于您的对象，您会这样说：

> *我的**手臂*或腿

认为`this`只是一种类型说“我的”的方式。所以一个伪代码表示看起来像这样：

```
class Foo
{
    private int bar;

    public Foo(int bar)
    {
        my.bar = bar;
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-23T13:34:53.503

关键字`this`在不同的上下文中可能意味着不同的事物，这可能是您混淆的根源。

它可以用作引用当前方法被调用的实例的对象引用：`return this;`

它可以用作引用当前构造函数正在创建的实例的对象引用，例如访问隐藏字段：

```
MyClass(String name)
{
    this.name = name;
} 
```

它可用于从构造函数中调用类的不同构造函数：

```
MyClass()
{
    this("default name");
} 
```

它可用于从嵌套类中访问封闭实例：

```
public class MyClass
{
    String name;

    public class MyClass
    {
        String name;

        public String getOuterName()
        {
            return MyClass.this.name;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-23T13:13:55.350

“this”是对当前对象的引用。

[在此处](http://java.sun.com/docs/books/tutorial/java/javaOO/thiskey.html)查看详细信息

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-23T13:16:42.050

[关键字`this`是对当前对象的引用](http://java.sun.com/docs/books/tutorial/java/javaOO/thiskey.html)。最好用以下代码来解释：

```
public class MyClass {

    public void testingThis() 
    {
        // You can access the stuff below by 
        // using this (although this is not mandatory)

        System.out.println(this.myInt);
        System.out.println(this.myStringMethod());

        // Will print out:
        // 100
        // Hello World
    }

    int myInt = 100;
    string myStringMethod() 
    {
        return "Hello World";
    }

} 
```

除非您有代码标准告诉您使用`this`关键字，否则它不会被大量使用。它有一个常见用途，那就是如果您遵循代码约定，您的参数名称与您的类属性相同：

```
public class ProperExample {
    private int numberOfExamples;

    public ProperExample(int numberOfExamples) 
    {
        this.numberOfExamples = numberOfExamples;
    }
} 
```

this 关键字的一种正确用法是链接构造函数（使构造对象在整个构造函数中保持一致）：

```
public class Square {
    public Square() 
    {
        this(0, 0);
    }

    public Square(int x_and_y) 
    {
        this(x_and_y, x_and_y);
    }

    public Square(int x, int y)
    {
       // finally do something with x and y
    }
} 
```

此关键字在例如 C# 中的工作方式相同。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-23T13:16:25.797

更好地利用这个

```
public class Blah implements Foo {

   public Foo getFoo() {
      return this;
   }
} 
```

它允许您在当前上下文中专门“this”对象。另一个例子：

```
public class Blah {

   public void process(Foo foo) { 
      foo.setBar(this);
   }
} 
```

你怎么能做这些操作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-10T09:35:30.030

“this”关键字是指当前对象，由于该对象正在执行该方法。当实例变量和局部变量具有相同名称时，它还用于避免在方法中作为参数传递的局部变量与实例变量之间的歧义。

例子 ：：

```
public class ThisDemo1 
{
    public static void main(String[] args) 
   {
        A a1=new A(4,5);       
   }
}

class A
{
    int num1;
    int num2;

    A(int num1)
    {
        this.num1=num1; //here "this" refers to instance variable num1\. 
       //"this" avoids ambigutiy between local variable "num1" & instance variable "num1"

        System.out.println("num1 :: "+(this.num1));
    }

    A(int num, int num2)
    {
        this(num); //here "this" calls 1 argument constructor within the same class.
        this.num2=num2;
        System.out.println("num2 :: "+(this.num2)); 
       //Above line prints value of the instance variable num2.
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-23T13:27:37.640

关键字“ *this* ”指的是当前对象的上下文。在许多情况下（正如[Andrew](https://stackoverflow.com/users/34211/andrew-hare)指出的那样），您将使用明确的*this*来明确您指的是当前对象。

此外，从“[这个和超级](http://www.faqs.org/docs/javap/c5/s5.html)”：

*还有其他用途。有时，在编写实例方法时，需要将包含该方法的对象作为实际参数传递给子例程。在这种情况下，您可以将其用作实际参数。例如，如果您想打印出对象的字符串表示，您可以说“System.out.println(this);”。或者，您可以将 this 的值分配给赋值语句中的另一个变量。

事实上，你可以用它做任何你可以用任何其他变量做的事情，除了改变它的值。*

该站点还提到了“*超级*”的相关概念，这可能有助于理解这些如何与继承一起工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-23T13:37:59.817

它是同一类的方法中类的实际实例的引用。编码

```
public class A{
    int attr=10;

    public int calc(){
     return this.getA()+10;
   }
   /**
   *get and set
   **/    

}//end class A 
```

在*calc()*主体中，软件在当前分配的对象内运行一个方法。

对象的行为怎么可能看到自己？使用***this***关键字，完全正确。

实际上，*this*关键字不需要强制使用（如***super***），因为 JVM 知道在内存区域中调用方法的位置，但在我看来，这使代码更具可读性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-23T13:51:48.613

它也可以是访问当前上下文信息的一种方式。例如：

```
public class OuterClass
{
  public static void main(String[] args)
  {
    OuterClass oc = new OuterClass();
  }

  OuterClass()
  {
    InnerClass ic = new InnerClass(this);
  }

  class InnerClass
  {
    InnerClass(OuterClass oc)
    {
      System.out.println("Enclosing class: " + oc + " / " + oc.getClass());
      System.out.println("This class: " + this + " / " + this.getClass());
      System.out.println("Parent of this class: " + this.getClass().getEnclosingClass());
      System.out.println("Other way to parent: " + OuterClass.this);
    }
  }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-23T13:30:22.393

用英语来想，“这个对象”就是你当前拥有的对象。

```
WindowMaker foo = new WindowMaker(this); 
```

例如，您当前位于从 JFrame 扩展的类中，并且您希望为 JFrame 传递对 WindowMaker 对象的引用，以便它可以与 JFrame 交互。您可以通过将 JFrame 的引用传递给名为“this”的对象来传递对 JFrame 的引用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-26T11:30:49.050

每个对象都可以使用关键字 this 访问对自身的引用（有时称为 this 引用）。

首先让我们看一下代码

```
public class Employee  {

private int empId;
private String name;

public int getEmpId() {
    return this.empId;
}

public String getName() {
    return this.name;
}

public void setEmpId(int empId) {
    this.empId = empId;
}

public void setName(String name) {
    this.name = name;
} 
```

}

在上述方法中 getName() 返回实例变量名。现在让我们再看看类似的代码是

```
public class Employee  {

private int empId;
private String name;

public int getEmpId() {
    return this.empId;
}

public String getName() {

    String name="Yasir Shabbir";
    return name;
}

public void setEmpId(int empId) {
    this.empId = empId;
}

public void setName(String name) {
    this.name = name;
}

public static void main(String []args){
    Employee e=new Employee();
    e.setName("Programmer of UOS");

    System.out.println(e.getName());

} 
```

}

**输出** Yasir Shabbir

*   此运算符始终与实例变量（属于对象）而不是任何类变量（属于类）一起使用
*   这总是指类非静态属性而不是任何其他参数或局部变量。
*   这总是在非静态方法中使用
*   该运算符不能用于静态变量（类变量）

**注意：**当方法包含与类的字段同名的参数或局部变量时，通常是逻辑错误。在这种情况下，如果您希望访问类的字段，请使用引用 this - 否则将引用方法参数或局部变量。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-10-10T18:09:00.143

> 'this' 的作用非常简单。它保存当前对象的引用。

*   此关键字保存当前类实例的引用
*   此关键字不能在静态函数或静态块中使用
*   该关键字可用于访问实例的阴影变量
*   此关键字可用于在函数调用中将当前对象作为参数传递
*   该关键字可用于创建构造函数链

来源：http: [//javaandme.com/core-java/this-word](http://javaandme.com/core-java/this-word)

# c# - 使用带有 For 循环的计时器来停止执行

> ID：577583
> 
> 赞同：-2
> 
> 时间：2009-02-23T13:14:20.777
> 
> 标签：c#, .net, timer

```
for(int i=0; i<mylist.items.count; i++)
{
   if(i==myvalue[i])
   {
     //call Timer! Wait timer interval if timer is tick, continue for loop!
   }

   timer_click()
   {
   // application
   }
} 
```

`for`如果条件中的值是某个值，如何使用带有计时器的循环来暂停执行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T13:20:38.640

你不应该。你为什么要这样做，或者你想通过这个做什么？

如果您希望循环停止一段时间，请使用 Thread.Sleep()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T13:24:00.787

那么你可以使用 Thread.Sleep() 不是吗？但是你真的应该有充分的理由在服务器端放置一个计时器，[这不是一件好事](http://msmvps.com/blogs/peterritchie/archive/2007/04/26/thread-sleep-is-a-sign-of-a-poorly-designed-program.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T13:19:41.483

我不确定我是否理解这个问题，但你应该阅读秒表类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T13:36:31.877

你为什么要暂停执行某事？这肯定会导致糟糕的用户体验。在你使用它之前想一想......但就像其他人所说......它的

```
Thread.Sleep(some ms); 
```

# c# - C# 或滑动窗口枚举器中的成对迭代

> ID：577590
> 
> 赞同：55
> 
> 时间：2009-02-23T13:17:00.600
> 
> 标签：c#, .net, iterator, ienumerable

如果我有一个像这样的 IEnumerable：

```
string[] items = new string[] { "a", "b", "c", "d" }; 
```

我想遍历所有成对的连续项目（大小为 2 的滑动窗口）。这将是

```
("a","b"), ("b", "c"), ("c", "d") 
```

我的解决方案是这样

```
 public static IEnumerable<Pair<T, T>> Pairs(IEnumerable<T> enumerable) {
        IEnumerator<T> e = enumerable.GetEnumerator(); e.MoveNext();
        T current = e.Current;
        while ( e.MoveNext() ) {
            T next = e.Current;
            yield return new Pair<T, T>(current, next);
            current = next;
        }
    }

 // used like this :
 foreach (Pair<String,String> pair in IterTools<String>.Pairs(items)) {
    System.Out.PrintLine("{0}, {1}", pair.First, pair.Second)
 } 
```

当我编写这段代码时，我想知道 .NET 框架中是否已经有函数可以做同样的事情，而且不仅适用于对，而且适用于任何大小的元组。恕我直言，应该有一种很好的方法来执行这种滑动窗口操作。

我使用 C# 2.0，我可以想象使用 C# 3.0（w/LINQ）有更多（更好）的方法可以做到这一点，但我主要对 C# 2.0 解决方案感兴趣。不过，我也会欣赏 C# 3.0 解决方案。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2010-08-02T18:13:40.753

在 .NET 4 中，这变得更加容易：-

```
var input = new[] { "a", "b", "c", "d", "e", "f" };
var result = input.Zip(input.Skip(1), (a, b) => Tuple.Create(a, b)); 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-10-17T05:19:45.757

与其要求一个元组（对）类型，不如只接受一个选择器：

```
public static IEnumerable<TResult> Pairwise<TSource, TResult>(this IEnumerable<TSource> source, Func<TSource, TSource, TResult> resultSelector)
{
    TSource previous = default(TSource);

    using (var it = source.GetEnumerator())
    {
        if (it.MoveNext())
            previous = it.Current;

        while (it.MoveNext())
            yield return resultSelector(previous, previous = it.Current);
    }
} 
```

如果需要，它允许您跳过中间对象：

```
string[] items = new string[] { "a", "b", "c", "d" };
var pairs = items.Pairwise((x, y) => string.Format("{0},{1}", x, y));

foreach(var pair in pairs)
    Console.WriteLine(pair); 
```

或者您可以使用匿名类型：

```
var pairs = items.Pairwise((x, y) => new { First = x, Second = y }); 
```

**更新：**我刚刚在一个真实的项目中实现了这个，而是使用了[C# 7.0`ValueTuple`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/value-tuples)：

```
public static IEnumerable<(T, T)> Pairwise<T>(this IEnumerable<T> source)
{
    var previous = default(T);
    using (var it = source.GetEnumerator())
    {
        if (it.MoveNext())
            previous = it.Current;

        while (it.MoveNext())
            yield return (previous, previous = it.Current);
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-03-13T08:29:49.100

最简单的方法是使用 ReactiveExtensions

```
using System.Reactive;
using System.Reactive.Linq; 
```

并让自己成为一个扩展方法来组合 bash

```
public static IEnumerable<IList<T>> Buffer<T>(this IEnumerable<T> seq, int bufferSize, int stepSize)
{
    return seq.ToObservable().Buffer(bufferSize, stepSize).ToEnumerable();
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-10-23T15:26:26.267

为方便起见，这是@dahlbyk 答案的无选择器版本。

```
public static IEnumerable<Tuple<T, T>> Pairwise<T>(this IEnumerable<T> enumerable)
{
    var previous = default(T);

    using (var e = enumerable.GetEnumerator())
    {
        if (e.MoveNext())
            previous = e.Current;

        while (e.MoveNext())
            yield return Tuple.Create(previous, previous = e.Current);
    }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-02-08T22:30:09.110

派对有点晚了，但作为所有这些扩展方法的替代方法，人们可能会使用实际的“滑动”`Collection`来保存（并丢弃）数据。

这是我今天最终制作的一个：

```
public class SlidingWindowCollection<T> : ICollection<T>
{
    private int _windowSize;
    private Queue<T> _source;

    public SlidingWindowCollection(int windowSize)
    {
        _windowSize = windowSize;
        _source = new Queue<T>(windowSize);
    }

    public void Add(T item)
    {
        if (_source.Count == _windowSize)
        {
            _source.Dequeue();
        }
        _source.Enqueue(item);
    }

    public void Clear()
    {
        _source.Clear();
    }

    ...and just keep forwarding all other ICollection<T> methods to _source.
} 
```

用法：

```
int pairSize = 2;
var slider = new SlidingWindowCollection<string>(pairSize);
foreach(var item in items)
{
    slider.Add(item);
    Console.WriteLine(string.Join(", ", slider));
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-09-25T20:59:44.390

这是我使用堆栈的解决方案。它简短而简洁。

```
string[] items = new string[] { "a", "b", "c", "d" };

Stack<string> stack = new Stack<string>(items.Reverse());

while(stack.Count > 1)
{
  Console.WriteLine("{0},{1}", stack.Pop(), stack.Peek());
} 
```

您可以采用相同的概念并使用队列来避免反转项目的需要，并且更简单：

```
var queue = new Queue<string>(items);

while (queue.Count > 1)
{
   Console.WriteLine("{0},{1}", queue.Dequeue(), queue.Peek());
} 
```

关于性能的简短说明：

我相信重要的是要意识到，除非您知道某项任务正在导致您的实际应用程序出现瓶颈，否则可能不值得弄清楚真正最快的方法是什么。相反，编写为您完成工作的代码。另外，使用你能记住的代码，这样下次你需要它时它很容易从你手中流走。

不过，如果您关心 10.000.000 个随机字符串的一些性能数据：

```
Run #1
  InputZip             00:00:00.7355567
  PairwiseExtension    00:00:00.5290042
  Stack                00:00:00.6451204
  Queue                00:00:00.3245580
  ForLoop              00:00:00.7808004
  TupleExtension       00:00:03.9661995

Run #2
  InputZip             00:00:00.7386347
  PairwiseExtension    00:00:00.5369850
  Stack                00:00:00.6910079
  Queue                00:00:00.3246276
  ForLoop              00:00:00.8272945
  TupleExtension       00:00:03.9415258 
```

使用 Jon Skeet 的微型基准测试工具进行测试。

如果您想查看测试的源代码，请访问此处：[gist here](https://gist.github.com/Postlagerkarte/65fde9ea48b55e8dc6639d9b236bab97)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-23T13:50:42.453

通过显式使用传递的迭代器扩展[先前的答案](https://stackoverflow.com/questions/577590/pair-wise-iteration-in-c-or-sliding-window-enumerator/577612#577612)以避免 O(n ^(2 ) 方法：)

```
public static IEnumerable<IEnumerable<T>> Tuples<T>(this IEnumerable<T> input, int groupCount) {
  if (null == input) throw new ArgumentException("input");
  if (groupCount < 1) throw new ArgumentException("groupCount");

  var e = input.GetEnumerator();

  bool done = false;
  while (!done) {
    var l = new List<T>();
    for (var n = 0; n < groupCount; ++n) {
      if (!e.MoveNext()) {
        if (n != 0) {
          yield return l;
        }
        yield break;
      }
      l.Add(e.Current);
    }
    yield return l;
  }
} 
```

对于 C# 2，在扩展方法之前，从输入参数中删除“this”并作为静态方法调用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-03-30T07:21:31.443

像这样的东西：

```
public static IEnumerable<TResult> Pairwise<T, TResult>(this IEnumerable<T> enumerable, Func<T, T, TResult> selector)
{
    var previous = enumerable.First();
    foreach (var item in enumerable.Skip(1))
    {
        yield return selector(previous, item);
        previous = item;
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-08-25T05:18:20.513

如果我忽略了某些东西，请原谅我，但为什么不做一些简单的事情，比如 for 循环？：

```
public static List <int []> ListOfPairs (int [] items)
{
    List <int> output = new List <int>();
    for (int i=0; i < items.Length-1; i++)
    {
        Int [] pair = new int [2];
        pair [0]=items [i];
        pair [1]=items [i+1];
        output.Add (pair);
    }
    return output;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-23T13:27:22.320

C# 3.0 解决方案（对不起：）

```
public static IEnumerable<IEnumerable<T>> Tuples<T>(this IEnumerable<T> sequence, int nTuple)
{
    if(nTuple <= 0) throw new ArgumentOutOfRangeException("nTuple");

    for(int i = 0; i <= sequence.Count() - nTuple; i++)
        yield return sequence.Skip(i).Take(nTuple);
} 
```

这不是世界上性能最好的，但看起来确实令人愉快。

确实，唯一使它成为 C# 3.0 解决方案的是 .Skip.Take 构造，因此，如果您只是将其更改为将该范围内的元素添加到列表中，那么它对于 2.0 来说应该是黄金。也就是说，它仍然没有性能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-04T14:41:59.790

替代`Pairs`实现，使用最后一对来存储先前的值：

```
static IEnumerable<Pair<T, T>> Pairs( IEnumerable<T> collection ) {
  Pair<T, T> pair = null;
  foreach( T item in collection ) {
    if( pair == null )
      pair = Pair.Create( default( T ), item );
    else
      yield return pair = Pair.Create( pair.Second, item );
  }
} 
```

简单`Window`的实现（仅对私人使用安全，如果调用者不保存返回的数组；见注释）：

```
static IEnumerable<T[]> Window( IEnumerable<T> collection, int windowSize ) {
  if( windowSize < 1 )
    yield break;

  int index = 0;
  T[] window = new T[windowSize];
  foreach( var item in collection ) {
    bool initializing = index < windowSize;

    // Shift initialized window to accomodate new item.
    if( !initializing )
      Array.Copy( window, 1, window, 0, windowSize - 1 );

    // Add current item to window.
    int itemIndex = initializing ? index : windowSize - 1;
    window[itemIndex] = item;

    index++;
    bool initialized = index >= windowSize;
    if( initialized )
      //NOTE: For public API, should return array copy to prevent 
      // modifcation by user, or use a different type for the window.
      yield return window;
  }
} 
```

示例使用：

```
for( int i = 0; i <= items.Length; ++i ) {
  Console.WriteLine( "Window size {0}:", i );
  foreach( string[] window in IterTools<string>.Window( items, i ) )
    Console.WriteLine( string.Join( ", ", window ) );
  Console.WriteLine( );
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-01-10T18:01:28.423

F#`Seq`模块定义了成对函数 over `IEnumerable<T>`，但该函数不在 .NET 框架中。

如果它已经在 .NET 框架中，它可能会接受选择器函数，而不是返回对，因为 C# 和 VB 等语言不支持元组。

```
var pairs = ns.Pairwise( (a, b) => new { First = a, Second = b }; 
```

我认为这里的任何答案都没有真正改善您简单的迭代器实现，这对我来说似乎是最[自然](http://petemontgomery.wordpress.com/2009/03/30/the-ienumerable-pairwise-function-in-c/)的（从事物的外观来看，海报[dahlbyk](https://stackoverflow.com/questions/577590/pair-wise-iteration-in-c-or-sliding-window-enumerator#answer-1581482)！）也是。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-19T14:37:37.233

我在 @dahlbyk 的回答中创建了 2020 年末更新代码的略微修改版本。它更适合启用了可为空引用类型的项目 ( `<Nullable>enable</Nullable>`)。我还添加了基本文档。

```
/// <summary>
/// Enumerates over tuples of pairs of the elements from the original sequence. I.e. { 1, 2, 3 } becomes { (1, 2), (2, 3) }. Note that { 1 } becomes { }.
/// </summary>
public static IEnumerable<(T, T)> Pairwise<T>(this IEnumerable<T> source)
{
    using var it = source.GetEnumerator();

    if (!it.MoveNext())
        yield break;

    var previous = it.Current;

    while (it.MoveNext())
        yield return (previous, previous = it.Current);
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-01-19T13:22:23.543

新的 C# 语言允许执行以下操作：

```
 var pairlist = new (string, string)[] { ("a", "b"), ("b", "c"), ("c", "d") };

        foreach (var pair in pairlist)
        {
            //do something with pair.Item1 & pair.Item2 
```

# shell - 从 Cygwin 打开文件

> ID：577595
> 
> 赞同：112
> 
> 时间：2009-02-23T13:18:18.177
> 
> 标签：shell, cygwin

`open`cygwin 中是否有与 OSX 命令等效的命令。`open`使用该类型的默认应用程序打开一个文件。

我想做类似的事情

```
$ magic-command file.xls
#excel opens as if file.xls would have been double-clicked

$ magic-command file.txt
#notepad opens as if file.txt would have been double-clicked 
```

你明白吗？

基本上类似于“cygwin-双击”命令。

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2009-02-23T13:51:28.300

您还可以使用 cygwin 实用程序：

```
cygstart <your file> 
```

要制作类似 OSX 的东西，请将以下内容添加到您的 bashrc

```
alias open='cygstart' 
```

不要忘记查看 cygstart 的手册页。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-23T13:24:48.520

您可以像这样使用 CMD 中的*启动*命令：

```
 cmd /c start <your file> 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-03-26T22:20:52.867

```
explorer <your file> 
```

也可以。好的是

```
explorer . 
```

在当前目录中打开一个 Windows 资源管理器窗口。但是之后

```
 cygstart . 
```

做同样的事情，做的更多，但我发现“探险家”更容易记住。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-29T08:27:21.250

我在 Win7 中使用 Cygwin。我可以通过 ccygwin 命令行在 Windows 上运行文件。

```
 cygstart <your file> 
```

当您运行此命令时，您的文件将在 Windows 中打开。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T13:28:23.800

在 Windows 命令行解释器 (cmd.exe) 下，支持 start 命令。我知道有人在 cygwin 中实现了 start 。[你可以在这里](http://f1.aaa.livedoor.jp/~fexx/tools/start-en.html)找到关于它的页面。

您也可以简单地使用以下参数调用 cmd.exe（通常位于 /cygdrive/c/windows/system32/cmd.exe） cmd /c "start yourfile.file"

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-21T16:51:20.920

如果像我一样，您在 Windows 机器上使用 putty 本地 ssh 到 Cygwin，因为 cmd.exe 是一个糟糕的控制台，您可能需要更改您的 sshd 服务以允许它访问本地桌面（这只适用于某些windows 口味）在 sshd windows 服务登录属性下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-04T17:39:23.127

是的，有一个相当于 Windows，试试`xdg-open <your file>`

# php - PHP中除以余数

> ID：577599
> 
> 赞同：11
> 
> 时间：2009-02-23T13:21:08.030
> 
> 标签：php

我的代码中有一部分需要除以余数而不是十进制答案。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-23T13:39:56.473

```
$quotient = intval($dividend / $divisor);
$remainder = $dividend % $divisor; 
```

使用`intval`而不是`floor`将商舍入为零，当被除数为负时提供准确的结果。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-23T13:22:11.227

您可以使用“%”（模数）运算符执行您所描述的操作。下面的代码是一个用余数除法的例子。

```
$remainder=$num % $divideby;
$number=explode('.',($num / $divideby));
$answer=$number[0];
echo $answer.' remainder '.$remainder; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-23T14:00:46.390

正数和负数的解决方案：

```
$quotient = $dividend / $divison;
$integer = (int) ($quotient < 0 ? ceil($quotient) : floor($quotient));
$remainder = $dividend % $divisor; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-11-24T10:58:27.990

数学上的[正确答案](https://en.wikipedia.org/wiki/Euclidean_division)是：

```
remainder = dividend % divisor;
quotient = (dividend - remainder) / divisor; 
```

其余的验证条件`0 <= remainder < abs(divisor)`。

**不幸的是，从数学的角度来看，许多编程语言（包括 PHP）不能正确处理负数。**他们使用[不同的规则](https://en.wikipedia.org/wiki/Modulo_operation)来计算余数的值和符号。上面的代码在 PHP 中不会产生正确的结果。

如果您需要使用负数并使用 PHP 获得正确的数学结果，那么您可以使用以下公式：

```
$remainder = (($dividend % $divider) + abs($divider)) % abs($divider);
$quotient = ($dividend - $remainder) / $divider; 
```

*它们依赖于 PHP 使用负操作数计算模数的方式，如果将它们移植到不同的语言，它们可能无法提供正确的结果。*

这是一个[脚本](https://3v4l.org/GGBti)，它实现了这些公式，并根据上述数学正确答案中提供的示例值检查结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T14:09:16.183

如果需要查找，% 运算符称为 mod（或模数）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-07T10:20:16.747

使用这个函数 它是一个数组 描述数组`gmp_div_qr ( resource $n , resource $d [, int $round ] )`

```
The function divides n by d . 
```

参考： http: [//php.net/manual/en/function.gmp-div-qr.php](http://php.net/manual/en/function.gmp-div-qr.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-14T18:07:14.457

我不得不开发这种方法，因为我的分子是一个浮点值，而模数是四舍五入的结果。

[使用此处](https://stackoverflow.com/questions/17218312/how-do-i-get-a-float-value-when-dividing-two-integers-php#21313533)提供的 Raffaello 的方法来划分浮点数并从上面的 Sam152 解决方案中得出以下结论。

```
$a = 2.1;
$b = 8;
$fraction = $a / (float) $b;
$parts = explode('.', $fraction);                
$int = $parts[0];
$remainder = $score - ($int*$b) ; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-02T12:46:33.273

如果仅给出分钟/秒，则使用 floor() 和模数 (%) 显示 1 小时 6 分钟等字符串的示例：

```
$minutes=126;

if($minutes < 60) {
    $span= $minutes.' min.';
} else {
    $rem=$minutes % 60;
    $span=floor($minutes/60).' h. '. (($rem>0) ? $rem.' min.':'');
}

// echo 'Hello Jon Doe, we notify you that even will last for 2 h. 6 min.
echo 'Hello Jon Doe, we notify you that event will last for '.$span; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-19T05:47:01.703

这似乎是一个旧帖子，但对于那些可能对此感兴趣的人来说，这是一个可以满足您需求的非常轻量级的软件包：[https](https://github.com/romainnorberg/residue) ://github.com/romainnorberg/residue （欢迎反馈）

# c# - 您是否应该实现 IDisposable.Dispose() 以便它永远不会抛出？

> ID：577607
> 
> 赞同：56
> 
> 时间：2009-02-23T13:24:38.130
> 
> 标签：c#, .net, idisposable

对于 C++ 中的等效机制（析构函数），建议[它通常不应该抛出任何异常](http://www.parashift.com/c++-faq-lite/exceptions.html#faq-17.3)。这主要是因为这样做你可能会终止你的进程，这很少是一个好的策略。

在 .NET 中的等效场景中...

1.  抛出第一个异常
2.  由于第一个异常而执行 finally 块
3.  finally 块调用 Dispose() 方法
4.  Dispose() 方法引发第二个异常

...您的进程不会立即终止。但是，您会丢失信息，因为 .NET 毫不客气地将第一个异常替换为第二个异常。因此，调用堆栈上方某处的 catch 块将永远不会看到第一个异常。然而，人们通常对第一个例外更感兴趣，因为这通常会提供更好的线索来说明事情开始出错的原因。

由于 .NET 缺乏一种机制来检测是否在异常挂起时正在执行代码，因此 IDisposable 的实现方式似乎只有两种选择：

*   始终吞下 Dispose() 中发生的所有异常。不好，因为您最终可能还会吞下 OutOfMemoryException、ExecutionEngineException 等，我通常宁愿在它们发生时让进程终止，而没有另一个异常已经挂起。
*   让所有异常从 Dispose() 传播出去。不好，因为您可能会丢失有关问题根本原因的信息，请参见上文。

那么，两害相权取其轻？有没有更好的办法？

**编辑**：澄清一下，我不是在谈论是否主动从 Dispose() 抛出异常，我是在谈论让 Dispose() 调用的方法抛出的异常传播到 Dispose() 之外，例如：

```
using System;
using System.Net.Sockets;

public sealed class NntpClient : IDisposable
{
    private TcpClient tcpClient;

    public NntpClient(string hostname, int port)
    {
        this.tcpClient = new TcpClient(hostname, port);
    }

    public void Dispose()
    {
        // Should we implement like this or leave away the try-catch?
        try
        {
            this.tcpClient.Close(); // Let's assume that this might throw
        }
        catch
        {
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-23T13:41:36.500

[*框架设计指南*](https://rads.stackoverflow.com/amzn/click/com/0321545613)（第2版）的内容如下（第 9.4.1 节）^：

> **避免**在 Dispose(bool) 中引发异常，除非在包含进程已损坏（泄漏、不一致的共享状态等）的危急情况下。

评论[编辑]：

*   有指导方针，而不是硬性规定。这是一个“避免”而不是“不要”的指导方针。正如（在评论中）指出的那样，该框架在某些地方打破了这个（和其他）准则。诀窍是知道何时打破准则。在许多方面，这就是熟练工和大师之间的区别。
*   如果清理的某些部分可能失败，则应提供一个 Close 方法，该方法将引发异常，以便调用者可以处理它们。
*   如果你遵循 dispose 模式（如果类型直接包含一些非托管资源，你应该这样做），那么`Dispose(bool)`可能会从终结器中调用，从终结器中抛出是一个坏主意，并且会阻止其他对象被终结。

*我的*观点：从 Dispose 逃逸的异常应该只是那些，如指南中那样，具有足够的灾难性，以至于当前进程无法提供进一步的可靠功能。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-23T13:29:27.667

我会争辩说，在这种情况下，吞咽是两个弊端中较小的一个，因为最好提出*原来* `Exception`的警告：**除非**，也许不能干净地处理它本身就是非常关键的（也许如果一个`TransactionScope`不能处理，因为这可能表示回滚失败）。

有关这方面的更多想法，请参见[此处](http://marcgravell.blogspot.com/2008/11/dontdontuse-using.html)- 包括包装器/扩展方法的想法：

```
using(var foo = GetDodgyDisposableObject().Wrap()) {
   foo.BaseObject.SomeMethod();
   foo.BaseObject.SomeOtherMethod(); // etc
} // now exits properly even if Dispose() throws 
```

当然，您也可以做一些奇怪的事情，重新抛出一个包含原始和第二个 ( `Dispose()`) 异常的复合异常 - 但请考虑：您可能有多个`using`块......它很快就会变得难以管理。实际上，最初的例外是有趣的例外。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-23T13:31:17.897

`Dispose`应该设计做它的目的，处置对象。此任务**是安全的，并且大部分时间不会引发异常**。如果您看到自己从 中抛出异常`Dispose`，您可能应该三思而后行，看看您是否在其中做了太多事情。除此之外，我认为`Dispose`应该像对待所有其他方法一样对待：如果你能用它做某事，就处理它，如果你不能，让它冒泡。

编辑：对于指定的示例，我将编写代码以使*我的代码*不会导致异常，但清除`TcpClient`可能会导致异常，这在我看来*应该是有效的传播*（或作为更通用的处理和重新抛出例外，就像任何方法一样）：

```
public void Dispose() { 
   if (tcpClient != null)
     tcpClient.Close();
} 
```

但是，就像任何方法一样，如果您知道`tcpClient.Close()`可能会抛出一个应该被忽略（没关系）或应该由另一个异常对象表示的异常，您可能想要捕获它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-23T13:53:10.950

释放资源应该是一种“安全”的操作——毕竟我怎样才能从无法释放资源中恢复过来呢？所以从 Dispose 抛出异常是没有意义的。

但是，如果我在 Dispose 内部发现程序状态已损坏，最好抛出异常然后吞下它，最好现在粉碎然后继续运行并产生不正确的结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-16T23:02:38.247

微软没有为 Dispose 提供 Exception 参数太糟糕了，目的是将其包装为 InnerException 以防处理本身引发异常。可以肯定的是，有效使用此类参数需要使用 C# 不支持的异常过滤器块，但也许此类参数的存在可能促使 C# 设计人员提供此类功能？我希望看到的一个不错的变化是将异常“参数”添加到 finally 块，例如

```
  最后异常 ex: // 在 C# 中
  最后 Ex as Exception ' 在 VB

```

它的行为就像一个普通的 finally 块，除了如果 'Try' 运行完成，'ex' 将为 null/Nothing，或者如果没有，则保持抛出的异常。太糟糕了，没有办法让现有代码使用这样的功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-24T21:41:36.360

从方法中传播或吞下异常有多种策略`Dispose`，可能基于是否也从主逻辑中抛出了未经处理的异常。最好的解决方案是将决定权留给调用者，具体取决于他们的具体要求。我已经实现了一个通用的扩展方法，它提供：

*   `using`传播`Dispose`异常的默认语义
*   [Marc Gravell 关于](http://blog.marcgravell.com/2008/11/dontdontuse-using.html)总是吞下`Dispose`异常的建议
*   [maxyfc](https://stackoverflow.com/q/1654487/1149773)`Dispose`仅在主逻辑中存在异常时才吞下异常的替代方案，否则该异常将丢失
*   [Daniel Chambers](http://www.digitallycreated.net/Blog/51/c%23-using-blocks-can-swallow-exceptions)将多个异常包装到一个`AggregateException`
*   一种类似的方法，总是将所有异常包装到一个`AggregateException`（就像`Task.Wait`这样）

这是我的扩展方法：

```
/// <summary>
/// Provides extension methods for the <see cref="IDisposable"/> interface.
/// </summary>
public static class DisposableExtensions
{
    /// <summary>
    /// Executes the specified action delegate using the disposable resource,
    /// then disposes of the said resource by calling its <see cref="IDisposable.Dispose()"/> method.
    /// </summary>
    /// <typeparam name="TDisposable">The type of the disposable resource to use.</typeparam>
    /// <param name="disposable">The disposable resource to use.</param>
    /// <param name="action">The action to execute using the disposable resource.</param>
    /// <param name="strategy">
    /// The strategy for propagating or swallowing exceptions thrown by the <see cref="IDisposable.Dispose"/> method.
    /// </param>
    /// <exception cref="ArgumentNullException"><paramref name="disposable"/> or <paramref name="action"/> is <see langword="null"/>.</exception>
    public static void Using<TDisposable>(this TDisposable disposable, Action<TDisposable> action, DisposeExceptionStrategy strategy)
        where TDisposable : IDisposable
    {
        ArgumentValidate.NotNull(disposable, nameof(disposable));
        ArgumentValidate.NotNull(action, nameof(action));
        ArgumentValidate.IsEnumDefined(strategy, nameof(strategy));

        Exception mainException = null;

        try
        {
            action(disposable);
        }
        catch (Exception exception)
        {
            mainException = exception;
            throw;
        }
        finally
        {
            try
            {
                disposable.Dispose();
            }
            catch (Exception disposeException)
            {
                switch (strategy)
                {
                    case DisposeExceptionStrategy.Propagate:
                        throw;

                    case DisposeExceptionStrategy.Swallow:
                        break;   // swallow exception

                    case DisposeExceptionStrategy.Subjugate:
                        if (mainException == null)
                            throw;
                        break;    // otherwise swallow exception

                    case DisposeExceptionStrategy.AggregateMultiple:
                        if (mainException != null)
                            throw new AggregateException(mainException, disposeException);
                        throw;

                    case DisposeExceptionStrategy.AggregateAlways:
                        if (mainException != null)
                            throw new AggregateException(mainException, disposeException);
                        throw new AggregateException(disposeException);
                }
            }

            if (mainException != null && strategy == DisposeExceptionStrategy.AggregateAlways)
                throw new AggregateException(mainException);
        }
    }
} 
```

这些是已实施的策略：

```
/// <summary>
/// Identifies the strategy for propagating or swallowing exceptions thrown by the <see cref="IDisposable.Dispose"/> method
/// of an <see cref="IDisposable"/> instance, in conjunction with exceptions thrown by the main logic.
/// </summary>
/// <remarks>
/// This enumeration is intended to be used from the <see cref="DisposableExtensions.Using"/> extension method.
/// </remarks>
public enum DisposeExceptionStrategy
{
    /// <summary>
    /// Propagates any exceptions thrown by the <see cref="IDisposable.Dispose"/> method.
    /// If another exception was already thrown by the main logic, it will be hidden and lost.
    /// This behaviour is consistent with the standard semantics of the <see langword="using"/> keyword.
    /// </summary>
    /// <remarks>
    /// <para>
    /// According to Section 8.10 of the C# Language Specification (version 5.0):
    /// </para>
    /// <blockquote>
    /// If an exception is thrown during execution of a <see langword="finally"/> block,
    /// and is not caught within the same <see langword="finally"/> block, 
    /// the exception is propagated to the next enclosing <see langword="try"/> statement. 
    /// If another exception was in the process of being propagated, that exception is lost. 
    /// </blockquote>
    /// </remarks>
    Propagate,

    /// <summary>
    /// Always swallows any exceptions thrown by the <see cref="IDisposable.Dispose"/> method,
    /// regardless of whether another exception was already thrown by the main logic or not.
    /// </summary>
    /// <remarks>
    /// This strategy is presented by Marc Gravell in
    /// <see href="http://blog.marcgravell.com/2008/11/dontdontuse-using.html">don't(don't(use using))</see>.
    /// </remarks>
    Swallow,

    /// <summary>
    /// Swallows any exceptions thrown by the <see cref="IDisposable.Dispose"/> method
    /// if and only if another exception was already thrown by the main logic.
    /// </summary>
    /// <remarks>
    /// This strategy is suggested in the first example of the Stack Overflow question
    /// <see href="https://stackoverflow.com/q/1654487/1149773">Swallowing exception thrown in catch/finally block</see>.
    /// </remarks>
    Subjugate,

    /// <summary>
    /// Wraps multiple exceptions, when thrown by both the main logic and the <see cref="IDisposable.Dispose"/> method,
    /// into an <see cref="AggregateException"/>. If just one exception occurred (in either of the two),
    /// the original exception is propagated.
    /// </summary>
    /// <remarks>
    /// This strategy is implemented by Daniel Chambers in
    /// <see href="http://www.digitallycreated.net/Blog/51/c%23-using-blocks-can-swallow-exceptions">C# Using Blocks can Swallow Exceptions</see>
    /// </remarks>
    AggregateMultiple,

    /// <summary>
    /// Always wraps any exceptions thrown by the main logic and/or the <see cref="IDisposable.Dispose"/> method
    /// into an <see cref="AggregateException"/>, even if just one exception occurred.
    /// </summary>
    /// <remarks>
    /// This strategy is similar to behaviour of the <see cref="Task.Wait()"/> method of the <see cref="Task"/> class 
    /// and the <see cref="Task{TResult}.Result"/> property of the <see cref="Task{TResult}"/> class:
    /// <blockquote>
    /// Even if only one exception is thrown, it is still wrapped in an <see cref="AggregateException"/> exception.
    /// </blockquote>
    /// </remarks>
    AggregateAlways,
} 
```

样品用途：

```
new FileStream(Path.GetTempFileName(), FileMode.Create)
    .Using(strategy: DisposeExceptionStrategy.Subjugate, action: fileStream =>
    {
        // Access fileStream here
        fileStream.WriteByte(42);
        throw new InvalidOperationException();
    });   
    // Any Dispose() exceptions will be swallowed due to the above InvalidOperationException 
```

**更新**：如果您需要支持返回值和/或异步的委托，那么您可以使用这些重载：

```
/// <summary>
/// Provides extension methods for the <see cref="IDisposable"/> interface.
/// </summary>
public static class DisposableExtensions
{
    /// <summary>
    /// Executes the specified action delegate using the disposable resource,
    /// then disposes of the said resource by calling its <see cref="IDisposable.Dispose()"/> method.
    /// </summary>
    /// <typeparam name="TDisposable">The type of the disposable resource to use.</typeparam>
    /// <param name="disposable">The disposable resource to use.</param>
    /// <param name="strategy">
    /// The strategy for propagating or swallowing exceptions thrown by the <see cref="IDisposable.Dispose"/> method.
    /// </param>
    /// <param name="action">The action delegate to execute using the disposable resource.</param>
    public static void Using<TDisposable>(this TDisposable disposable, DisposeExceptionStrategy strategy, Action<TDisposable> action)
        where TDisposable : IDisposable
    {
        ArgumentValidate.NotNull(disposable, nameof(disposable));
        ArgumentValidate.NotNull(action, nameof(action));
        ArgumentValidate.IsEnumDefined(strategy, nameof(strategy));

        disposable.Using(strategy, disposableInner =>
        {
            action(disposableInner);
            return true;   // dummy return value
        });
    }

    /// <summary>
    /// Executes the specified function delegate using the disposable resource,
    /// then disposes of the said resource by calling its <see cref="IDisposable.Dispose()"/> method.
    /// </summary>
    /// <typeparam name="TDisposable">The type of the disposable resource to use.</typeparam>
    /// <typeparam name="TResult">The type of the return value of the function delegate.</typeparam>
    /// <param name="disposable">The disposable resource to use.</param>
    /// <param name="strategy">
    /// The strategy for propagating or swallowing exceptions thrown by the <see cref="IDisposable.Dispose"/> method.
    /// </param>
    /// <param name="func">The function delegate to execute using the disposable resource.</param>
    /// <returns>The return value of the function delegate.</returns>
    public static TResult Using<TDisposable, TResult>(this TDisposable disposable, DisposeExceptionStrategy strategy, Func<TDisposable, TResult> func)
        where TDisposable : IDisposable
    {
        ArgumentValidate.NotNull(disposable, nameof(disposable));
        ArgumentValidate.NotNull(func, nameof(func));
        ArgumentValidate.IsEnumDefined(strategy, nameof(strategy));

#pragma warning disable 1998
        var dummyTask = disposable.UsingAsync(strategy, async (disposableInner) => func(disposableInner));
#pragma warning restore 1998

        return dummyTask.GetAwaiter().GetResult();
    }

    /// <summary>
    /// Executes the specified asynchronous delegate using the disposable resource,
    /// then disposes of the said resource by calling its <see cref="IDisposable.Dispose()"/> method.
    /// </summary>
    /// <typeparam name="TDisposable">The type of the disposable resource to use.</typeparam>
    /// <param name="disposable">The disposable resource to use.</param>
    /// <param name="strategy">
    /// The strategy for propagating or swallowing exceptions thrown by the <see cref="IDisposable.Dispose"/> method.
    /// </param>
    /// <param name="asyncFunc">The asynchronous delegate to execute using the disposable resource.</param>
    /// <returns>A task that represents the asynchronous operation.</returns>
    public static Task UsingAsync<TDisposable>(this TDisposable disposable, DisposeExceptionStrategy strategy, Func<TDisposable, Task> asyncFunc)
        where TDisposable : IDisposable
    {
        ArgumentValidate.NotNull(disposable, nameof(disposable));
        ArgumentValidate.NotNull(asyncFunc, nameof(asyncFunc));
        ArgumentValidate.IsEnumDefined(strategy, nameof(strategy));

        return disposable.UsingAsync(strategy, async (disposableInner) =>
        {
            await asyncFunc(disposableInner);
            return true;   // dummy return value
        });
    }

    /// <summary>
    /// Executes the specified asynchronous function delegate using the disposable resource,
    /// then disposes of the said resource by calling its <see cref="IDisposable.Dispose()"/> method.
    /// </summary>
    /// <typeparam name="TDisposable">The type of the disposable resource to use.</typeparam>
    /// <typeparam name="TResult">The type of the return value of the asynchronous function delegate.</typeparam>
    /// <param name="disposable">The disposable resource to use.</param>
    /// <param name="strategy">
    /// The strategy for propagating or swallowing exceptions thrown by the <see cref="IDisposable.Dispose"/> method.
    /// </param>
    /// <param name="asyncFunc">The asynchronous function delegate to execute using the disposable resource.</param>
    /// <returns>
    /// A task that represents the asynchronous operation. 
    /// The task result contains the return value of the asynchronous function delegate.
    /// </returns>
    public static async Task<TResult> UsingAsync<TDisposable, TResult>(this TDisposable disposable, DisposeExceptionStrategy strategy, Func<TDisposable, Task<TResult>> asyncFunc)
        where TDisposable : IDisposable
    {
        ArgumentValidate.NotNull(disposable, nameof(disposable));
        ArgumentValidate.NotNull(asyncFunc, nameof(asyncFunc));
        ArgumentValidate.IsEnumDefined(strategy, nameof(strategy));

        Exception mainException = null;

        try
        {
            return await asyncFunc(disposable);
        }
        catch (Exception exception)
        {
            mainException = exception;
            throw;
        }
        finally
        {
            try
            {
                disposable.Dispose();
            }
            catch (Exception disposeException)
            {
                switch (strategy)
                {
                    case DisposeExceptionStrategy.Propagate:
                        throw;

                    case DisposeExceptionStrategy.Swallow:
                        break;   // swallow exception

                    case DisposeExceptionStrategy.Subjugate:
                        if (mainException == null)
                            throw;
                        break;    // otherwise swallow exception

                    case DisposeExceptionStrategy.AggregateMultiple:
                        if (mainException != null)
                            throw new AggregateException(mainException, disposeException);
                        throw;

                    case DisposeExceptionStrategy.AggregateAlways:
                        if (mainException != null)
                            throw new AggregateException(mainException, disposeException);
                        throw new AggregateException(disposeException);
                }
            }

            if (mainException != null && strategy == DisposeExceptionStrategy.AggregateAlways)
                throw new AggregateException(mainException);
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-23T13:40:07.627

我可能会使用日志记录来捕获有关第一个异常的详细信息，然后允许引发第二个异常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-09T16:17:44.867

这是一种相当干净地抓取由`using`或的内容引发的任何异常的方法`Dispose`。

原始代码：

```
using (var foo = new DisposableFoo())
{
    codeInUsing();
} 
```

然后这里是如果`codeInUsing()`抛出或`foo.Dispose()`抛出或两者都抛出时将抛出的代码，并让您看到第一个异常（有时包装为 InnerExeption，具体取决于）：

```
var foo = new DisposableFoo();
Helpers.DoActionThenDisposePreservingActionException(
    () =>
    {
        codeInUsing();
    },
    foo); 
```

这不是很好，但也不算太糟糕。

这是实现这一点的代码。我已将其设置为*仅*在未附加调试器时按描述工作，因为当附加调试器时，我更担心它会在第一个异常时在正确的位置中断。您可以根据需要进行修改。

```
public static void DoActionThenDisposePreservingActionException(Action action, IDisposable disposable)
{
    bool exceptionThrown = true;
    Exception exceptionWhenNoDebuggerAttached = null;
    bool debuggerIsAttached = Debugger.IsAttached;
    ConditionalCatch(
        () =>
        {
            action();
            exceptionThrown = false;
        },
        (e) =>
        {
            exceptionWhenNoDebuggerAttached = e;
            throw new Exception("Catching exception from action(), see InnerException", exceptionWhenNoDebuggerAttached);
        },
        () =>
        {
            Exception disposeExceptionWhenExceptionAlreadyThrown = null;
            ConditionalCatch(
                () =>
                {
                    disposable.Dispose();
                },
                (e) =>
                {
                    disposeExceptionWhenExceptionAlreadyThrown = e;
                    throw new Exception("Caught exception in Dispose() while unwinding for exception from action(), see InnerException for action() exception",
                        exceptionWhenNoDebuggerAttached);
                },
                null,
                exceptionThrown && !debuggerIsAttached);
        },
        !debuggerIsAttached);
}

public static void ConditionalCatch(Action tryAction, Action<Exception> conditionalCatchAction, Action finallyAction, bool doCatch)
{
    if (!doCatch)
    {
        try
        {
            tryAction();
        }
        finally
        {
            if (finallyAction != null)
            {
                finallyAction();
            }
        }
    }
    else
    {
        try
        {
            tryAction();
        }
        catch (Exception e)
        {
            if (conditionalCatchAction != null)
            {
                conditionalCatchAction(e);
            }
        }
        finally
        {
            if (finallyAction != null)
            {
                finallyAction();
            }
        }
    }
} 
```

# xaml - XAML 中的 .ToString() 怎么说？

> ID：577608
> 
> 赞同：1
> 
> 时间：2009-02-23T13:24:45.557
> 
> 标签：xaml, tostring

以下代码给了我错误（无法将类型 Object 添加到 Stackpanel）。

我如何在 XAML 中说 .ToString()？

```
<Window.Resources>
    <Style TargetType="{x:Type ListBoxItem}">
        <Setter Property="Content">
            <Setter.Value>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding Path=FirstName}"/>
                </StackPanel>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources>
<Grid>
    <ListBox x:Name="theCustomers"/>
</Grid> 
```

使用 ADO.NET 实体框架在代码隐藏中绑定：

```
MainEntities db = new MainEntities();
var customers = from c in db.CustomersSet
                select c;
theCustomers.ItemsSource = customers; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T13:37:23.373

您需要设置属性`ContentTemplate`，而不是`Content`.

尝试：

```
<Setter Property="ContentTemplate" >
   <Setter.Value>
      <DataTemplate>
         <StackPanel Orientation="Horizontal">
           <TextBlock Text="{Binding Path=FirstName}"/>
           <TextBlock Text=" "/>
           <TextBlock Text="{Binding Path=LastName}"/>
         </StackPanel>
      </DataTemplate>
   </Setter.Value>
</Setter> 
```

看[这篇文章](http://blogs.msdn.com/wpfsdk/archive/2007/01/05/styling-the-content-of-a-contentcontrol.aspx)

# java - 如何索引很多 txt 文件？(Java/C/C++)

> ID：577622
> 
> 赞同：4
> 
> 时间：2009-02-23T13:29:53.033
> 
> 标签：java, c++, c, full-text-search

我需要索引很多文本。搜索结果必须给我包含查询的文件的名称以及查询在每个文件中匹配的所有位置 - 因此，我不必加载整个文件来查找匹配部分。您可以推荐哪些库来执行此操作？

**更新**：已建议使用 Lucene。你能给我一些关于我应该如何使用 Lucene 来实现这一点的信息吗？（我见过搜索查询仅返回匹配文件的示例）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-23T13:37:06.760

对于 java 尝试[Lucene](http://lucene.apache.org/java/docs/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T13:37:17.117

这完全取决于您将如何访问它。当然，有多少人会访问它。阅读[MapReduce](http://labs.google.com/papers/mapreduce.html)。

如果你要自己动手，你需要创建一个索引文件，它是唯一单词和元组（文件、行、偏移量）之间的映射。当然，您可以考虑其他内存中的数据结构，例如[trie](http://en.wikipedia.org/wiki/Trie)（前缀树）、[Judy 数组](http://en.wikipedia.org/wiki/Judy_array)等......

[此处](http://en.wikipedia.org/wiki/Full_text_search#Text_retrieval_software)列出了一些第 3 方解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T13:37:42.187

[Lucene](http://lucene.apache.org/java/docs/) - Java

它也是开源的，因此您可以在您的应用程序中自由使用和部署。

据我所知，[Eclipse IDE](http://www.eclipse.org/)帮助文件由 Lucene 提供支持——它经过了数百万的测试

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T14:09:19.583

看看[http://www.compass-project.org/](http://www.compass-project.org/)它可以看作是 Lucene 之上的包装器，Compass 简化了 Lucene 的常见使用模式，例如 google 风格的搜索、索引更新以及更高级的缓存和索引分片（子索引）等概念。Compass 还使用内置优化来进行并发提交和合并。

概述可以为您提供更多信息 [http://www.compass-project.org/overview.html](http://www.compass-project.org/overview.html)

我很快就把它整合到了一个春季项目中。它非常易于使用，并为您的用户提供类似谷歌的结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T14:11:27.287

我相信你正在寻找的 lucene 术语是[highlighting](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/highlight/package-summary.html)。这是[关于 Lucene 突出显示的最新报告](http://www.lucidimagination.com/blog/2009/02/17/highlighting-highlighter-thoughts/)。您可能需要存储单词位置信息才能获得您正在寻找的片段。[令牌 API](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/analysis/Token.html)可能会有所帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-23T15:44:02.727

另请查看[Lemur Toolkit](http://www.lemurproject.org/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T13:45:04.353

为什么不尝试通过读取所有文件来构建状态机？状态之间的转换将是字母，状态将是最终的（某些文件包含考虑的单词，在这种情况下，列表在那里可用）或中间状态。

至于多词查找，您必须在与结果相交之前独立处理它们。

我相信[Boost::Statechart](http://www.boost.org/doc/libs/1_38_0/libs/statechart/doc/tutorial.html)库可能会对此有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T15:45:16.763

我知道您要求一个库，只是想向您指出[构建倒排索引](http://nlp.stanford.edu/IR-book/html/htmledition/a-first-take-at-building-an-inverted-index-1.html)的基本概念（来自Christopher D. Manning、Prabhakar Raghavan 和 Hinrich Schütze[的信息检索简介）。](http://www-csli.stanford.edu/~hinrich/information-retrieval-book.html)

# oracle - 与 Oracle 应用服务器集群实例的会话

> ID：577625
> 
> 赞同：0
> 
> 时间：2009-02-23T13:30:27.667
> 
> 标签：oracle, session, cluster-computing

我有两个集群在一起并复制会话的 Oracle 应用服务器 (OAS) 实例。每当我通过终止进程来终止其中一个实例时，另一个实例就会启动并包含该会话。一切都按预期工作。如果我正常关闭 OAS 的一个实例（使用 opmn stopall），则会触发 HttpSessionDestroyedEvent 事件并删除信息，从而导致应用程序无法正常故障转移。这是我第一次使用集群环境，我很好奇这是否常见。我知道并期望在服务器实例停止时在非集群环境中触发 HttpSessionDestroyedEvent 事件，但这里似乎不正确。如何在一台服务器上执行任何类型的维护？我正在使用 Spring Framework，这是 HttpSessionDestroyedEvent 事件的来源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T12:48:33.280

这似乎是集群和 Web 服务器的常见问题。基本上，当属于集群的单个节点正常关闭时，该节点将为属于该节点的所有会话触发会话销毁事件，即使集群中启动并运行了更多节点。这里还有一些描述我遇到的同样问题的链接。

[Tomcat 问题](http://www.mail-archive.com/users@tomcat.apache.org/msg42968.html)

[JBoss 问题](https://jira.jboss.org/jira/browse/JBSEAM-3172)

一种解决方法是在您侦听会话破坏事件的任何位置加载包含关闭标志的属性文件（请参阅 JBoss 链接）。这样做的一个缺点是系统管理员必须记住在重新启动之前和之后更新属性文件。

# javascript - 使用 Javascript + Ajax 验证和提交表单

> ID：577632
> 
> 赞同：1
> 
> 时间：2009-02-23T13:31:48.147
> 
> 标签：javascript, ajax, asynchronous

这就是我想要做的。

*   当在我的表单上单击“提交”表单时，javascript 函数将遍历表单的所有字段。

*   对于每个字段，将调用一个函数，该函数将返回`true`/`false`以指示它是否正确填写。

*   如果`false`返回 a，它会在该字段旁边显示一条错误消息。

*   如果所有字段都正确，则提交表单。如果没有，则不提交。

这是棘手的部分。虽然大部分验证是通过 javascript 完成的，但用户名和电子邮件需要通过 ajax 进行验证，以查看用户名/电子邮件是否已在使用中。

我目前用于这个 ajax 函数的结构类似于：

```
function validateSomething()
{
  var valid;
  $.post("something.php", {x:y},
  function(data)
  {
     if (isSomething(data))
       valid=true; 
       //Here referring to the valid variable 
       //set outside this function, in the
       // parent function
     else
       valid=false; 
  });
  return valid/
} 
```

但这目前不起作用。

我可以做些什么来使它工作，即我可以阻止 validateSomething() 函数返回一个值，直到它被内部函数设置为真/假？

像这样的工作：

```
function validateSomething()
{
  var valid="unset";
  $.post("something.php", {x:y},
  function(data)
  {
     if (isSomething(data))
       valid=true; 
       //Here referring to the valid variable 
       //set outside this function, in the
       // parent function
     else
       valid=false; 
  });
  //Loop without returning until valid is set to true or false
  while (valid=='unset')
  {
     //Do nothing?
  }
  return valid/
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T13:35:11.820

您可以使用 async: false 强制 ajax 调用等待。

像这样使用jquery：

```
function validateSomething() {
    var valid;
    $.ajax({
        url: "something.php",
        data: {x: y},
        type: "GET",
        async: false, // this makes the ajax-call blocking
        dataType: 'json',
        success: function (response) {
            valid= response.valid;
        }
     });
     return valid;
} 
```

然而，使用 AJAX 的最大优势在于它是异步的。此同步调用可能会在等待服务器时锁定浏览器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T13:35:56.497

你可能不想。（或者更恰当地说，“去做吧，但这样做时要小心。”）

通过 AJAX 进行验证既时髦又漂亮，而且很棒。但它不是验证服务器端的替代品。AJAx 验证不是服务器端验证。即使您检查以确保用户名未在“服务器上”使用，我也可以将您的函数返回为 false 并将其翻转为 true 并愉快地提交表单。Javascript 在客户端上运行，不能被信任。

当您实际提交表单时，您通过 AJAX 调用执行的任何验证都必须在服务器上重新完成。

如果你这样做了，那么，是的，AJAX 验证又是时髦、流畅和令人敬畏的。所以去吧。要使用 javascript 提交表单（例如在 AJAX 回调处理函数中），您会说：

```
 if(formwasValid)
 {
      document.getElementById('idOfForm').submit();

      $('#idOfForm').submit(); //jQuery
 }
 else
 {
      alert('Invalid text');
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T14:11:47.893

我停止在客户端进行广泛的表单验证，因为无论如何都必须在服务器端复制代码。

在客户端，我只是通过正则表达式对字段进行一些基本的语法检查。这些检查将在用户开始输入时立即触发，但它们只是在出现问题时给出视觉通知（红色边框，不同的背景颜色，字段旁边的红色“X”......）。

我不会阻止用户提交无效的表单：然后，带有更详细检查的服务器端代码开始工作，它可以轻松地重组表单以将有效字段与无效字段分开，并生成有关原因的深入解释检查失败。

# c# - 如何获得“友好”的操作系统版本名称？

> ID：577634
> 
> 赞同：69
> 
> 时间：2009-02-23T13:33:02.353
> 
> 标签：c#, .net, winforms, operating-system

我正在寻找一种优雅的方式来获取操作系统版本，例如：“Windows XP Professional Service Pack 1”或“Windows Server 2008 Standard Edition”等。

有没有一种优雅的方式来做到这一点？

我也对处理器架构（如 x86 或 x64）感兴趣。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2010-01-06T21:53:41.410

您可以使用 WMI 获取产品名称（“Microsoft® Windows Server® 2008 Enterprise”）：

```
using System.Management;
var name = (from x in new ManagementObjectSearcher("SELECT Caption FROM Win32_OperatingSystem").Get().Cast<ManagementObject>()
                      select x.GetPropertyValue("Caption")).FirstOrDefault();
return name != null ? name.ToString() : "Unknown"; 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-11-28T01:30:07.320

你真的应该尽量避免 WMI 用于本地使用。它非常方便，但在性能方面您要付出高昂的代价。这既快速又简单：

```
 public string HKLM_GetString(string path, string key)
    {
        try
        {
            RegistryKey rk = Registry.LocalMachine.OpenSubKey(path);
            if (rk == null) return "";
            return (string)rk.GetValue(key);
        }
        catch { return ""; }
    }

    public string FriendlyName()
    {
        string ProductName = HKLM_GetString(@"SOFTWARE\Microsoft\Windows NT\CurrentVersion", "ProductName");
        string CSDVersion = HKLM_GetString(@"SOFTWARE\Microsoft\Windows NT\CurrentVersion", "CSDVersion");
        if (ProductName != "")
        {
            return (ProductName.StartsWith("Microsoft") ? "" : "Microsoft ") + ProductName +
                        (CSDVersion != "" ? " " + CSDVersion : "");
        }
        return "";
    } 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-02-23T14:45:36.360

为什么不使用[`Environment.OSVersion`](http://msdn.microsoft.com/en-us/library/system.environment.osversion.aspx)？它还将告诉您这是什么操作 - Windows、Mac OS X、Unix 等。要确定您是在 64 位还是 32 位上运行，请使用[`IntPtr.Size`](http://msdn.microsoft.com/en-us/library/system.intptr.size.aspx)- 这将返回 32 位的 4 个字节和 64 位的 8 个字节。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-10-06T06:29:51.937

**尝试：**

```
new ComputerInfo().OSVersion; 
```

**输出：**

> 微软视窗 10 企业版

**注意：** 添加参考`Microsoft.VisualBasic.Devices;`

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-04-15T00:42:21.960

有点晚了，但我就是这样做的。将来可能会帮助某人。

```
using Microsoft.Win32;

RegistryKey registryKey = Registry.LocalMachine.OpenSubKey("Software\\Microsoft\\Windows NT\\CurrentVersion");
        string pathName = (string)registryKey.GetValue("productName"); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-01-07T07:08:55.107

样本输出：

```
Name = Windows Vista
Edition = Home Premium
Service Pack = Service Pack 1
Version = 6.0.6001.65536
Bits = 64 
```

示例类：

```
class Program
{
    static void Main( string[] args )
    {
        Console.WriteLine( "Operation System Information" );
        Console.WriteLine( "----------------------------" );
        Console.WriteLine( "Name = {0}", OSInfo.Name );
        Console.WriteLine( "Edition = {0}", OSInfo.Edition );
        Console.WriteLine( "Service Pack = {0}", OSInfo.ServicePack );
        Console.WriteLine( "Version = {0}", OSInfo.VersionString );
        Console.WriteLine( "Bits = {0}", OSInfo.Bits );
        Console.ReadLine();
    }
} 
```

OSInfo 类的源代码：[http](http://www.csharp411.com/determine-windows-version-and-edition-with-c/) ://www.csharp411.com/determine-windows-version-and-edition-with-c/但是代码有错误，需要替换“case 6”语句（就在#endregion NAME 之前）：

```
case 6:
    switch (minorVersion)
    {
        case 0:

            switch (productType)
            {
                case 1:
                    name = "Windows Vista";
                    break;
                case 3:
                    name = "Windows Server 2008";
                    break;
            }
            break;
        case 1:
            switch (productType)
            {
                case 1:
                    name = "Windows 7";
                    break;
                case 3:
                    name = "Windows Server 2008 R2";
                    break;
            }
            break;
    }
    break; 
```

如果你想更进一步，看看你的程序是在 64 位还是 32 位运行：

```
public static class Wow
{
    public static bool Is64BitProcess
    {
        get { return IntPtr.Size == 8; }
    }

    public static bool Is64BitOperatingSystem
    {
        get
        {
            // Clearly if this is a 64-bit process we must be on a 64-bit OS.
            if (Is64BitProcess)
                return true;
            // Ok, so we are a 32-bit process, but is the OS 64-bit?
            // If we are running under Wow64 than the OS is 64-bit.
            bool isWow64;
            return ModuleContainsFunction("kernel32.dll", "IsWow64Process") && IsWow64Process(GetCurrentProcess(), out isWow64) && isWow64;
        }
    }

    static bool ModuleContainsFunction(string moduleName, string methodName)
    {
        IntPtr hModule = GetModuleHandle(moduleName);
        if (hModule != IntPtr.Zero)
            return GetProcAddress(hModule, methodName) != IntPtr.Zero;
        return false;
    }

    [DllImport("kernel32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    extern static bool IsWow64Process(IntPtr hProcess, [MarshalAs(UnmanagedType.Bool)] out bool isWow64);
    [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    extern static IntPtr GetCurrentProcess();
    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    extern static IntPtr GetModuleHandle(string moduleName);
    [DllImport("kernel32.dll", CharSet = CharSet.Ansi, SetLastError = true)]
    extern static IntPtr GetProcAddress(IntPtr hModule, string methodName);
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-01-24T05:30:45.053

对我来说，下面的工作线给了我这样的输出： `Microsoft Windows 10.0.18362`

```
System.Runtime.InteropServices.RuntimeInformation.OSDescription 
```

它也可用于获取架构等信息 [https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.runtimeinformation?view=netframework-4.8](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.runtimeinformation?view=netframework-4.8)

特性

`FrameworkDescription`：返回一个字符串，该字符串指示运行应用程序的 .NET 安装的名称。

`OSArchitecture`：获取当前应用运行的平台架构。

`OSDescription`：获取一个字符串，该字符串描述了运行应用程序的操作系统。

`ProcessArchitecture`：获取当前运行的应用程序的进程架构。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-23T13:43:35.887

需要注意的一件事是这些信息通常是本地化的，并且会根据操作系统的语言以不同的方式报告。

[您可以从WMI](http://msdn.microsoft.com/en-us/library/aa394596(VS.85).aspx)中获取大量信息，查找[Win32_OperatingSystem](http://msdn.microsoft.com/en-us/library/aa394239(VS.85).aspx)类

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-23T13:44:04.183

请注意，处理器架构问题很复杂：

你的意思是（更高的数字需要更低的数字才能为真）：

1.  CPU 能够处理 64 位（在某种意义上它支持 AMD/intel x64 或 Itanium）
2.  操作系统是64位
    *   GPR 和指针是 64 位的，即 XP 64、Vista 64、64 位服务器版本或用于单声道的 64 位操作系统
3.  当前执行的*进程*是64位进程（例如在Wow64下不执行）

如果您很高兴所有 3 个都为真，那么

```
IntPtr.Size == 8 
```

表示三个都为真

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-07-11T22:14:51.140

您可以使用 Visual Basic 设备来获取版本信息。

**代码：**

```
using Microsoft.VisualBasic.Devices;

var versionID = new ComputerInfo().OSVersion;//6.1.7601.65536
var versionName = new ComputerInfo().OSFullName;//Microsoft Windows 7 Ultimate
var verionPlatform = new ComputerInfo().OSPlatform;//WinNT

Console.WriteLine(versionID);
Console.WriteLine(versionName);
Console.WriteLine(verionPlatform); 
```

**输出：**

> 6.1.7601.65536
> 
> 微软视窗 10 企业版
> 
> WinNT

**注意：** 您需要添加对`Microsoft.VisualBasic;`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-12-27T19:03:46.687

我知道这不是问题的直接答案，而且也有点晚了，但是对于那些只想确定操作系统是客户端操作系统还是服务器的人来说，有一种方法可以使用以下内容：(您需要包括 System.Management 参考）

```
 using System;
        using System.Management;

        ManagementClass osClass = new ManagementClass("Win32_OperatingSystem");
        foreach (ManagementObject queryObj in osClass.GetInstances())
        {

            foreach (PropertyData prop in queryObj.Properties)
            {

                if (prop.Name == "ProductType")
                {

                    ProdType = int.Parse(prop.Value.ToString());
                }
            }
        } 
```

而变量 ProdType 是之前初始化的整数。它将包含一个介于 1 和 3 之间的值，而 1 代表工作站，2 代表域控制器，3 代表服务器。

这取自[Accessing the properties of Win32_OperatingSystem](https://stackoverflow.com/questions/15406957/accessing-the-properties-of-win32-operatingsystem)并稍作更改...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-09-18T21:24:50.153

披露：发布此消息后，我意识到我依赖于一个名为 Nuget 扩展方法库`Z.ExntensionMethods`，其中包含`IndexOf()`

`using Microsoft.VisualBasic.Devices;`

```
string SimpleOSName()
{
    var name = new ComputerInfo().OSFullName;
    var parts = name.Split(' ').ToArray();
    var take = name.Contains("Server")?3:2;
    return string.Join(" ", parts.Skip(parts.IndexOf("Windows")).Take(take));
} 
```

更快的性能`using System.Management;`

```
string SimpleOSName()
{
    var name = new ManagementObjectSearcher("SELECT Caption FROM Win32_OperatingSystem")
        .Get().Cast<ManagementObject>()
        .Select(x => x.GetPropertyValue("Caption").ToString())
        .First();
    var parts = name.Split(' ').ToArray();
    var take = name.Contains("Server")?3:2;
    return string.Join(" ", parts.Skip(parts.IndexOf("Windows")).Take(take));
} 
```

输出示例：

> Windows 7的
> 
> 视窗服务器 2008

# iphone - iPhone - 何时调用视图控制器的 dealloc？

> ID：577635
> 
> 赞同：24
> 
> 时间：2009-02-23T13:33:04.820
> 
> 标签：iphone

我正在使用 UINavigationController 在视图之间移动。当我在视图中来回移动时，我的应用程序使用的内存不断增加。在将 NSLog 语句放在所有视图控制器的 dealloc 方法中时，我注意到它仅被一些视图控制器调用，而不是所有被弹出的视图控制器。

例如，这是推送视图的顺序 MainViewController -> viewcontroller1 -> viewcontroller2 -> viewcontroller3

现在在 viewcontroller3 中，如果我执行 popToViewController:mainController，则仅为 viewcontroller3 调用 dealloc。viewcontroller1 和 2 不调用它。

有人可以告诉我为什么会这样。

**发现了问题。如果视图控制器持有的任何引用仍在内存中，则不会调用 dealloc 方法。在我的情况下，它是未在 viewcontroller1 和 viewcontroller2 中释放的 MPMoviePlayerController 对象。**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-23T14:08:37.777

这是最后一个，第一个关闭的情况。因此，如果您想象您的第一个视图控制器是汉堡的底部面包，然后添加汉堡（第二个视图控制器），然后添加顶部汉堡（第三个视图控制器）。

如果你回到汉堡，你会取下顶部的面包（popViewController：调用弹出视图的 dealloc 方法）。如果你想回到底部的小圆面包，那么你必须弹出汉堡（每次弹出视图时都会调用dealloc）。

不知道为什么在pop to root时不会调用第二个视图控制器的dealloc..

唔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T09:07:34.200

在您导航控制器的地方，应该需要在 pushviewcontroller, [viewControllername release] 之​​后编写此行；那么它将调用每个视图控制器的 Dealloc 方法:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-12T15:24:29.943

您还应该记住，dealloc 并不总是保证运行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-08-25T12:38:42.873

使用类似 [self.navigationController popToRootViewControllerAnimated:YES]; 它对我有用......调用我的 10 个视图控制器的所有 dealloc 方法

# python - 旋转 glViewport？

> ID：577639
> 
> 赞同：2
> 
> 时间：2009-02-23T13:33:48.047
> 
> 标签：python, math, opengl

在“多点触控”环境中，显示在表面上的任何应用程序都可以旋转/缩放到用户的方向。实际的解决方案是在 FBO 上绘制应用程序，并在其上绘制一个带有纹理的旋转/缩放矩形。我觉得对性能不好，而且所有显卡都不提供FBO。

这个想法是在用户的方向上剪辑渲染视口。由于 glViewport 不能用于此，是否存在另一种实现方式？

（glViewport 使用（x，y，宽度，高度），我想要（x，y，宽度，高度，从中心旋转？））

PS：旋转模型视图或投影矩阵无济于事，我想“旋转由 glViewport 生成的裁剪计划”。（只是所有场景的一部分）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T13:42:21.413

如果您已经设置了渲染场景的代码，请尝试添加`glRotate()`对视图模型矩阵设置的调用，以在渲染场景之前“旋转相机”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T07:20:43.870

在 OpenGL 中没有办法旋转视口，你必须手动处理它。我看到以下可能的解决方案：

*   继续使用纹理，也许使用 glCopyTexSubImage 而不是 FBO，因为这是基本的 OpenGL 功能。如果您的目标平台是硬件加速的，那么性能应该没问题，具体取决于您办公桌上需要的视口数量，因为这是当今非常常见的用例。

*   如果没有纹理，您可以将 glViewport 设置为旋转视口 (rB) 的屏幕对齐边界矩形 (rA)（也设置适当的剪刀测试区域）。然后绘制一个遮蔽区域，可能仅在深度或模板缓冲区中填充（rA - rB）区域，这将阻止进一步绘制这些像素。然后正常绘制您的应用程序，使用 glRotate 调整您的投影矩阵，以便渲染根据 rB 正确定向。

# c# - .net/C# 是否具有类似 Java 中的 DWR 的等效 Javascript 对象代理/序列化？

> ID：577645
> 
> 赞同：0
> 
> 时间：2009-02-23T13:35:40.507
> 
> 标签：c#, .net, javascript, dwr

我在 Javascript 中有一些与[Java DWR](https://dwr.dev.java.net/)接口的旧代码。我正在寻找可能将后端移植到 .NET/C#，我只是想知道是否有一个等效的 AJAX 框架可以以与 Java 中的 DWR 框架相同的方式工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T13:36:57.790

[Jayrock](http://jayrock.berlios.de/)似乎很接近。

# ruby - Ruby 正则表达式中 \A \z 和 ^ $ 之间的区别

> ID：577653
> 
> 赞同：217
> 
> 时间：2009-02-23T13:36:56.980
> 
> 标签：ruby, regex

在我阅读的文档中：

> 使用 \A 和 \z 匹配字符串的开始和结束，^ 和 $ 匹配行的开始/结束。

我将应用正则表达式来检查用户提交的用户名（或电子邮件相同）。`validates_format_of`我应该在模型中使用哪个表达式？我无法理解其中的区别：我一直使用 ^ 和 $ ...

* * *

## 回答 #1

> 赞同：251
> 
> 时间：2009-02-23T13:43:22.690

如果您依赖正则表达式进行验证，您总是希望使用`\A`and `\z`。`^`并且`$`只会匹配到换行符，这意味着他们可以使用类似的电子邮件`me@example.com\n<script>dangerous_stuff();</script>`并仍然对其进行验证，因为正则表达式只能看到`\n`.

我的建议只是预先从用户名或电子邮件中完全删除新行，因为几乎没有正当理由。然后您可以安全地使用 EITHER`\A` `\z`或`^` `$`.

* * *

## 回答 #2

> 赞同：196
> 
> 时间：2011-05-12T14:34:30.483

根据[镐](http://ruby-doc.com/docs/ProgrammingRuby/html/language.html#UJ)：

> `^` 匹配一行的开头。
> 
> `$` 匹配行尾。
> 
> `\A` 匹配字符串的开头。
> 
> `\z` 匹配字符串的结尾。
> 
> `\Z` 匹配字符串的结尾，除非字符串以 a 结尾`"\n"`，在这种情况下，它匹配`"\n"`.

所以，使用`\A`和小写`\z`。如果您使用`\Z`某人可能会潜入换行符。我认为这并不危险，但可能会搞砸假设字符串中没有空格的算法。根据您的正则表达式和字符串长度限制，有人可以使用仅带有换行符的不可见名称。

JavaScript 的 Regex 实现将`\A`其视为文字`'A'`（[ref](http://www.regular-expressions.info/anchors.html#az)）。因此，请注意自己并进行测试。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-23T13:44:19.020

字符串的开头和结尾不一定与行的开头和结尾相同。想象一下，如果您使用以下内容作为测试字符串：

> 我
> 叫 安德鲁
> _

请注意，字符串中有很多行 -`^`和`$`字符允许您匹配这些行的开头和结尾（基本上将`\n`字符视为分隔符），同时`\A`允许`\Z`您匹配整个字符串的开头和结尾。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-08-20T20:20:30.240

示例差异

1.  `/^foo$/`匹配以下任何一项，`/\Afoo\z/`不匹配：

```
whatever1
foo
whatever2
```

```
foo
whatever2
```

```
whatever1
foo
```

2.  `/^foo$/`并且`/\Afoo\z/`都符合以下条件：

```
foo 
```

# tree - 树结构的真实世界示例

> ID：577659
> 
> 赞同：15
> 
> 时间：2009-02-23T13:37:45.853
> 
> 标签：tree, binary-tree, binary-search-tree

我正在寻找一些用于商业/自由软件项目的树结构示例，无论是现代的还是旧的。我可以在 wikipedia 上看到示例，但我正在寻找更具体的示例以及它们的使用方式。例如，数据库中的主键（根据我的阅读）存储在 BST 结构或 BST 的变体中（请随时纠正我）

我的问题不限于二叉搜索树 (BST)，它可以包括任何变体，例如红黑、AVL 等。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-23T13:40:50.057

如果这些示例有点通用，即与图形相关而不一定与树相关，可以吗？如果是，请继续阅读。

*   不用说大多数 XML/标记解析器都使用树。例如，参见 Apache Xerces。或者，Xalan XSLT 解析器。感谢[mathewsdave26](https://stackoverflow.com/users/59711/mathewsdave26)提醒我！

*   PDF 是一种基于树的格式。它有一个`root`节点，后跟一个`catalog`节点（它们通常是相同的），然后是一个`pages`具有多个子节点的`page`节点。生产者/消费者经常使用平衡树实现将文档存储在内存中。

*   计算机国际象棋游戏构建了一个巨大的树（训练），他们在运行时使用启发式方法对其进行修剪以达到最佳移动。

*   [Flare](http://flare.prefuse.org/)是一个用 AS 编写的可视化库。您可能想查看数据对象的映射方式。特别是该`flare.analytics`包大量使用了图形结构、生成树等。

*   社交网络是当前 CS 研究中的流行语。不用说，连接/关系非常自然地使用图形建模。通常，树用于表示/识别更有趣的现象。你如何回答诸如“哈利和莎莉有共同的朋友吗？”之类的问题？

*   一些非常成功的物理/游戏引擎会构建树木来准确模拟人体运动。在这种情况下，一棵树通常对应一组动作；上下文将确定采用哪条路径来呈现特定响应。

*   基于决策树的学习实际上形成了数据挖掘研究的一个强大领域。存在许多著名的方法，例如 bagging、boosting 和它们的修改，它们适用于树。此类工作通常用于生成预测模型。

*   生物信息学中的一个常见问题是搜索大型数据库以查找给定查询字符串的匹配项。尝试在那里很常见。

*   相当多的成功（股票）交易者在他们的日常交易中使用决策树——选择交易，退出交易。很多时候，这些并没有编入计算机程序，而是写在笔记本背面的某个地方。

欺骗。看到[这个](https://stackoverflow.com/questions/205945)和[这个](https://stackoverflow.com/questions/20734/red-black-trees)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-23T13:44:51.467

数据库索引 B* 树中的 B 代表平衡，而不是二进制。树保持在统一的深度以确保访问时间均匀。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-03T18:14:34.077

*   您的文件系统是一个树形结构。因此，请查看任何免费文件系统的源代码。

*   您的编译器会从您的源代码生成一个[AST](http://en.wikipedia.org/wiki/Abstract_Syntax_Tree)，作为中间阶段。因此，请查看任何免费编译器的源代码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-23T13:40:35.487

数据库索引通常存储为 B* 树的变体，尽管它们的名称不是二叉树。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-23T14:59:24.223

二叉树已被用于旧 3D 游戏中的空间分区和隐藏表面移除，我相信在游戏 Doom 中使用过二叉树。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-03T17:59:59.977

*   编写一个简单的递归下降解析器，并让它生成一个解析树。

*   制造中使用的材料清单结构（就像汽车由子组件组成，递归地，直到螺母和螺栓）。

*   符号表（在编译器中使用）。

*   项目管理中使用的会计科目表。一个整体项目有子项目，可以对其进行收费。

*   公司组织架构：事业部、部门等

*   文档的目录。

*   一个人的后裔，一个人的祖先。

*   任何 Lisp s 表达式，包括任何 Lisp 程序。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-03T20:31:47.273

软件中的自动完成功能（例如搜索引擎“建议”、IDE 类型/符号完成、电子邮件和地址簿名称等）通常作为树结构的 Tries 实现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-23T13:53:13.757

查看任何 Datawarehousing 产品，您都会发现存储和钻取树形维度的巧妙方法。您将获得位置（国家、地区、州、县、镇等）和时间（年、月、日、小时）的树结构。这两个维度在许多领域都很常见，但许多其他现实世界的数据也适用于树。

例如，在食品零售业中，在树的根部可以有杂货，可以深入到乳制品、水果和蔬菜等。只要一根线，你就可以拥有。豆罐头，在顶层，你会用卡车装载，然后你会下到托盘、盒子、罐头尺寸。所有不同的 SKU（库存单位）对商店或公司内的人都很重要。然后是不同类型的豆子、不同的供应商、制造商——所有相同维度的树的例子。

所有不同的产品形成一棵巨大的树，具有不同的切片和切丁方式。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-23T14:01:45.203

C++ 包含许多集合（set、multi_set、map、multi_map），它们通常实现为红黑树，一种平衡树。

（C++ 标准没有明确要求这种实现，但这是满足复杂性要求的最简单的设计。）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-26T13:13:21.503

在我以前工作的路由器/交换机地方，我们使用了一堆树结构，对于软件路由表，我们使用[基数树](http://en.wikipedia.org/wiki/Radix_tree)（IP 路由表的常见选择）。

我们的 OSPF 实现使用了[红黑树](http://en.wikipedia.org/wiki/Red-black_tree)，我们的 BGP 实现使用了[跳过列表](http://en.wikipedia.org/wiki/Skiplists)。

从技术上讲，skiplists 不是树结构，但它们在实践中非常相似，而且它们真的很酷。

我们确实在考虑它时使用了很多[堆](http://en.wikipedia.org/wiki/Heap_(data_structure))，自从我在那里工作已经有一段时间了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-02T21:49:22.853

DNS查询..任何使用地图的东西都使用AVL

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-03T16:35:39.587

[System.Collections.Generic.SortedList<T>](http://msdn.microsoft.com/en-us/library/ms132319.aspx)使用二叉搜索树作为底层实现。[System.Collections.GenericSortedDictionary<T>](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)也是如此。任何使用 SortedList<T> 或 SortedDictionary<T> 的代码都使用二叉搜索树。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-23T14:30:49.970

在我的项目中，一个调查/人口普查数据的编辑和估算系统，我们使用二叉决策树来决定记录的哪些变量要估算或不估算。二叉决策树允许我们有效地决定我们应该和不应该采取的树上的路径。

我认为这种方法（尽管可能不仅仅是二叉树）也用于人工智能应用程序

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-03T18:19:30.477

我们使用树结构来建模零件分类系统。零件被分类为具有父类的“类”等。顶级类驱动我们目录 UI 中选项卡的文本。类还用于应用定价规则，识别车辆上的“热点”，其中零件显示在“配置器”中，等等。我们使用 Joe Celko 的嵌套集在 SQL 中对树进行建模，并按需将它们加载到内存中以获得更好的效果表现。我们最常见的查询是“谁是我的后代”和“这个班级是我的祖先吗？”

非常便利

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-02-05T08:36:05.163

ActionScript 中实现了一个陷阱。资料来源：

*   [特雷普](http://code.google.com/p/as3-commons/source/browse/trunk/as3-commons-collections/src/main/actionscript/org/as3commons/collections/Treap.as)
*   [线程迭代器](http://code.google.com/p/as3-commons/source/browse/trunk/as3-commons-collections/src/main/actionscript/org/as3commons/collections/framework/core/TreapIterator.as)
*   [TreapNode](http://code.google.com/p/as3-commons/source/browse/trunk/as3-commons-collections/src/main/actionscript/org/as3commons/collections/framework/core/TreapNode.as)

treap 是[AS3Commons Collections 框架](http://sibirjak.com/blog/index.php/lite-collections/)的一部分。修改后的 treap 用于支持包含的 SortedSet 和 SortedMap 集合。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-02-05T08:43:20.220

**通常，对象的分类**通常使用树来完成。很多时候，图比树更合适，但是树比图有两个很大的优势：

*   它可以表示为（嵌套）列表。例如，在纸上（带有标题、副标题、段落和嵌套列表）或计算机屏幕上显示一棵大树比显示图表要容易得多。
*   您可以使用简单的路径字符串（或堆栈）指向树中的一个项目，例如“http/StackOverflow.com/Users/Dimitri C”，这在图中很难做到。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-04-29T17:48:16.910

Put yourself as the root of tree and now make your parents as children of tree and parents of parents as their children of tree and this can make a full use case of tree.

So implementing something where the complete hierarchy of family require you can use tree to implement that.

# apache - .htaccess 中的 Apache RequestHeader 指令

> ID：577668
> 
> 赞同：0
> 
> 时间：2009-02-23T13:41:02.587
> 
> 标签：apache, .htaccess, request-headers

我正在尝试在 Godaddy 共享主机帐户上使用以下 apache 配置：

```
<Files ~ ".*">
<IfModule mod_headers.c>
RequestHeader unset Host
RequestHeader append Host mydomain.com
</IfModule>
</Files> 
```

以上内容包含在 .htaccess 文件中。换句话说...对于所有文件和路径，将请求的主机设置为 mydomain.com

以上似乎不起作用。我在 Godaddy 的服务器上收到 500 错误。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-11T21:12:37.467

[Gumbo](https://stackoverflow.com/users/53114/gumbo)在上面的评论中提供了这个问题的答案

> 我宁愿认为您的模式不正确。如果在 .htaccess 文件中使用 mod_rewrite，则在应用于模式之前会删除路径前缀。从而将“/foo/bar”转换为“foo/bar”（如果.htaccess 文件位于根“/”中）。所以从模式中删除前导斜线。– 秋葵汤 2 月 23 日 14:29

# javascript - 如何使用 JQuery 将 HTML 表格转换为列表？

> ID：577669
> 
> 赞同：2
> 
> 时间：2009-02-23T13:41:05.113
> 
> 标签：javascript, jquery, list, listview, html-table

我将如何转换表格

```
<table>
    <tr>
        <td>Name</td>
        <td>Price</td>
    </tr>
    <tr>
        <td>Name</td>
        <td>Price</td>
    </tr>  
</table> 
```

到带有 jQ​​uery 的段落列表

```
<ul>
    <li>
        <p>Name</p>
        <p>Price</p>
    </li>
    <li>
        <p>Name</p>
        <p>Price</p>
    </li>  
</ul>

<p><a id="products-show-list">Toggle list view</a></p>

<script type="text/javascript">
    $("#products-show-list").click(function(){...});
</script> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-23T14:41:06.903

```
function convertToList(element) {
    var list = $("<ul/>");

    $(element).find("tr").each(function() {
        var p = $(this).children().map(function() {
            return "<p>" + $(this).html() + "</p>";
        });

        list.append("<li>" + $.makeArray(p).join("") + "</li>");
    });

    $(element).replaceWith(list);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T13:57:33.777

你可以试试：

```
function convertToList() {
  var list = $("<ul></ul>");
  $("table tr").each(function() {
    var children = $(this).children();
    list.append("<li><p>" + children[0].text() + "</p><p>" + children[1] + "</p></li>");
  }
  $("table").replaceWith(list);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-10T21:30:39.000

这还有一些工作要做，但这是我到目前为止要做的工作：

```
<script>
$(function(){
 t2l("uglytable");
});

function t2l(divname)
{ 
 var ulist  = $("<ul></ul>");
 var table  = "div." + divname + " table";
 var tr   = "div." + divname + " table tr";

 $(tr).each(function(){
  var child = $(this).children();
  ulist.append("<li>" + child.text() + "</li>");
 });
 $(table).replaceWith(ulist);
}

</script>

<div class="uglytable">
  <table border="1">
   <tr>
    <td>lakers</td>
   </tr>
   <tr>
    <td>dodgers</td>
   </tr>
   <tr>
    <td>angels</td>
   </tr>
   <tr>
    <td>chargers</td>
   </tr>
  </table>
 </div> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-09-10T17:30:08.627

我可以看到这在 SharePoint 中很有用，它喜欢使用一堆嵌套表来呈现一个更有效的简单列表，

*   ...

# web-services - 如何调试从 javascript 异步调用的 Web 服务？

> ID：577681
> 
> 赞同：0
> 
> 时间：2009-02-23T13:44:41.360
> 
> 标签：web-services, debugging

我有一个 ASP.NET Web 服务，用于将数据异步保存到我的数据库中。我的网页上有一个按钮，它调用一个 javascript 方法，该方法通过 dom 查看、收集数据并将其发送到服务。

我现在正在调试一个我认为该 Web 服务中发生的问题，并且我想在 Web 服务被调用时对其进行调试，但我不确定这是否可以完成，如果可以，如何？

该服务中发生了一些非常奇怪的事情，所以我希望能够逐步完成它并找出问题发生在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T13:49:43.330

您需要将调试器附加到托管 Web 服务的进程。这将是 IIS 5 中的 aspnet_wp、IIS 6 或 7 中的 w3wp，或者如果它在同一解决方案中运行，则可能是 Visual Studio 开发服务器。

附加调试器后，只需打开服务源并设置断点。如果您连接到正确的进程，那么断点将显示为实心圆圈；如果没有，它们将是带有警告图标的空心圆圈。将鼠标悬停在图标上以查看问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T13:46:20.357

您是否尝试过在 Web 服务的代码隐藏中放置断点？它对我来说很好......但也许我错过了一些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T13:48:10.930

Firebug 正是为客户端的这个任务[http://getfirebug.com/而制作的。](http://getfirebug.com/)

在服务器端，使用标准工具（调试器、记录器......）

# actionscript-3 - 如何通过 AS3 从加载器页面枚举对象标签参数？

> ID：577693
> 
> 赞同：1
> 
> 时间：2009-02-23T13:49:19.227
> 
> 标签：actionscript-3, flex3

我喜欢枚举的 HTML 页面中有一些对象参数，最简单的方法是什么？

我想使用 for 循环遍历每个参数并将它们插入到我自己的数组中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T14:00:49.650

如果您指的是`<object>`元素的参数（例如 allowfullscreen、wmode、quality 等），我认为在 AS3 中没有访问这些值的通用方法。要访问这些值，我猜您可能需要在 flash 之外使用某种机制来将这些参数传递给 flash 对象。例如，您可以使用[SWFObject](http://code.google.com/p/swfobject/)生成嵌入代码，并在 flashvars 参数中传递要用作参数的数组。

另一方面，如果您指的是 flashvars 参数的值，即那些要传递给 flash 对象的值，您可以通过`Applicaiton.application.paramaters`对象访问这些值（键是参数名称，值是对应的值） . 对于普通的 AS3 项目，可以通过`root.loaderInfo.parameters`.

高温高压

# xaml - 如何让多重绑定在 XAML ListBox 中工作？

> ID：577697
> 
> 赞同：2
> 
> 时间：2009-02-23T13:51:01.827
> 
> 标签：xaml, listbox

下面显示了 ListBox 中的 3 个“MultiTest.Model.Customers”（应该显示的每条记录一个）。

为了让它输出字段的*内容，我需要更改什么？*

```
<Window.Resources>
    <Style TargetType="{x:Type ListBoxItem}">
        <Setter Property="ContentTemplate" >
            <Setter.Value>
                <MultiBinding StringFormat="{}{1}, {0} ">
                    <Binding Path="FirstName" />
                    <Binding Path="LastName"/>
                </MultiBinding>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources>
<Grid>
    <ListBox x:Name="theCustomers"/>
</Grid> 
```

使用 ADO.NET 实体框架在代码隐藏中绑定：

```
MainEntities db = new MainEntities();
var customers = from c in db.CustomersSet
                select c;
theCustomers.ItemsSource = customers; 
```

## 回答：

谢谢，史蒂夫，这是我的 Window.Resources 格式的答案：

```
<Window.Resources>
    <Style TargetType="{x:Type ListBoxItem}">
        <Setter Property="ContentTemplate" >
            <Setter.Value>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock>
                            <TextBlock.Text>
                                <MultiBinding  StringFormat="{}{1}, {0} ({2})">
                                    <Binding Path="FirstName"/>
                                    <Binding Path="LastName"/>
                                    <Binding Path="ID"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </StackPanel>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources>
<Grid>
    <ListBox x:Name="theCustomers"/>
</Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T14:09:15.107

如果您特别想使用 MultiBinding，您应该能够使用带有 StringFormat 的 DataTemplate .. 类似于：

```
<ListBox.ItemTemplate>
    <DataTemplate>
        <StackPanel Orientation="Horizontal">
            <TextBlock>
                <TextBlock.Text>
                    <MultiBinding  StringFormat="{}{1}, {0}">
                        <Binding Path="FirstName"/>
                        <Binding Path="LastName"/>
                    </MultiBinding>
                </TextBlock.Text>
            </TextBlock>
       </StackPanel>
    </DataTemplate>
</ListBox.ItemTemplate> 
```

或者对于更复杂的事情，您可以使用 ValueConverter （或多重绑定变体）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T13:58:30.000

我以前从未使用过 MultiBinding。但是，我使用过 DataTemplates：

```
<ListBox.ItemTemplate>
    <DataTemplate>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Name}"></TextBlock>
            <TextBlock Text=" - "/>
            <TextBlock Text="{Binding Email}" Margin="5,0"></TextBlock>
        </StackPanel>
    </DataTemplate>
</ListBox.ItemTemplate> 
```

希望这可以帮助！

# database - 如何解析电子邮件并传输到数据库

> ID：577699
> 
> 赞同：0
> 
> 时间：2009-02-23T13:51:38.567
> 
> 标签：database, email

我看到一些网络应用程序允许我通过电子邮件将内容发送到一个特殊的 ID，然后它神奇地出现在我的帐户中。他们究竟是如何做到这一点的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T17:43:10.927

您可以在 python/php 或您知道的任何语言上编写一个简单的脚本。使其接收帐户“myName@mySite.com”的弹出邮件并将内容放入数据库。

这很容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T14:06:03.897

如果您没有给出您正在考虑的特定服务的示例，很难确切知道，但一种方法可能是：

*   您将您的电子邮件地址提供给这些网站之一，ee`magic-mail.com`

*   他们将其插入到他们的数据库中，并获取`id`该条目的数据库值（`12345`）

*   他们使用这个 id ( `12345@magic-mail.com`)给你一个地址

*   当收到邮件时`magic-mail.com`，他们会查找 之前的部分`@`，提取该 ID 的相关电子邮件地址，然后将邮件转发到您最初提供的地址 ( `toby@example.com`)

还有许多其他方法可以做到这一点，可能比上述更简单，但同样，如果没有示例，很难准确地告诉您您所考虑的站点是如何运行的。

* * *

**编辑**

在阅读问题时，我认为“我的帐户”是指您的邮件帐户。如果您的意思是您在该公司系统上拥有的帐户，则该过程将与上述相同，但将最后一步更改为：

*   当收到邮件时`magic-mail.com`，他们会查找 之前的部分`@`，提取该 ID 的关联电子邮件地址，并将邮件内容复制到与该 ID 关联的帐户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T17:45:25.320

您需要一种方法来监视邮件帐户中的新消息、读取消息格式、解析对您很重要的部分，然后执行插入。

监视邮件帐户需要在服务器上以指定的时间间隔运行脚本，否则唯一的其他方法是手动访问某个 URL，该 URL 将访问邮件帐户并执行所有必要的处理。

根据您的托管服务提供商和他们给您的自由程度，这可能会也可能不会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T17:47:38.310

捷径：
您需要编写一个脚本来连接到邮件服务器，获取邮件，解析它们然后放入数据库。
在 cron 作业中运行它，你就设置好了。

# iphone - 使用 Clang 进行调试

> ID：577702
> 
> 赞同：4
> 
> 时间：2009-02-23T13:52:06.117
> 
> 标签：iphone, objective-c, cocoa-touch, llvm, clang

我想在我的 Xcode iPhone 项目中使用 clang。然而，这是入门指南：

[http://clang.llvm.org/get_started.html](http://clang.llvm.org/get_started.html)

我已经使用 Xcode 工作了一年，但这对我来说远远不能理解！谁能用简单的英语解释如何在我现有的 iPhone 项目中安装和使用 Clang？我不熟悉从控制台加载东西。

谢谢！

担

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T15:54:46.460

Nikita Zhuk 将 Clang 封装在 GUI 中，并在[http://www.karppinen.fi/analysistool/](http://www.karppinen.fi/analysistool/)上提供。很有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T15:07:13.843

1.  下载 clang 发行版并将其解压缩到某个目录。可以选择将此目录添加到您的路径中，或者您可以稍后将其位置添加到命令行中。
2.  cd 到您的顶级项目目录（可能类似于**cd ~/Documents/yourprojectdirectory**）
3.  通过键入以下命令行，告诉 clang 实用程序使用您的 xcode 项目设置构建您的项目：**pathtoclangdirectory/scan-build -o ./clang_out xcodebuild**
4.  该实用程序在成功运行后应该会给您一条消息以运行**scan_view**实用程序。
5.  运行在构建结束时输出的命令。这将在您的机器上启动一个临时 Web 服务器，然后打开 Safari 并向您展示代码分析。您可能需要再次添加到您的 clang 目录的路径，如下所示：**pathtoclangdirectory/scan_view ...**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-07T15:32:53.583

直到我做了类似的事情以使 Clang 在 XCode 中更有用之后，我才看到这个问题：

[在 XCode 中使用 Clang 静态分析器](https://stackoverflow.com/questions/961844/using-clang-static-analyzer-from-within-xcode)

# silverlight - 在 Silverlight 中显示图像时出现问题

> ID：577708
> 
> 赞同：0
> 
> 时间：2009-02-23T13:54:19.557
> 
> 标签：silverlight, image

我正在尝试在 silverlight 中生成图像，但由于某种原因它没有显示。

这是我正在使用的代码

```
 Image fireBall = new Image();
            Uri imageUri = new Uri("/Yambushi;Images/Projectiles/Fireball.png", UriKind.Relative);
            fireBall.Source = new BitmapImage(imageUri);
            cnvGame.Children.Add(fireBall);
            fireBall.SetValue(Canvas.LeftProperty, Convert.ToDouble(100)); //(Doll left property)
            fireBall.SetValue(Canvas.TopProperty, Convert.ToDouble(100));
            fireBall.Height = 30;
            fireBall.Width = 30; 
```

Yambushi 是解决方案名称，而 cnvGame 是我要在其中显示图像的画布。 png 文件构建操作设置为 content

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T14:46:58.807

好的解决了这个问题......在我调试了我通过xaml实现的图像的sourceUri之后，源必须如下：

```
 Uri imageUri = new Uri("/Images/Projectiles/Fireball.png", UriKind.Relative);
            fireBall.Source = new BitmapImage(imageUri); 
```

# sql-server - 将带有数字的列的类型从 varchar 更改为 int

> ID：577712
> 
> 赞同：38
> 
> 时间：2009-02-23T13:58:03.590
> 
> 标签：sql-server, types

我们在当前类型为 varchar(16) 的数据库中有两列。问题是，它包含数字并且总是包含数字。因此，我们希望将其类型更改为整数。但问题是它当然已经包含数据。

有什么方法可以将该列的类型从 varchar 更改为 int，而不会丢失所有已经存在的数字？希望我们可以运行某种 sql，而不必创建临时列并创建 C# 程序或其他东西来进行转换等等......我想如果 SQL Server 有一些函数可以将字符串转换为数字，但我对 SQL**非常**不稳定。几乎只能使用 C# 并通过 LINQ to SQL 访问数据库。

**注意：**是的，首先将列设为 varchar 并不是一个好主意，但不幸的是，他们就是这样做的。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-02-23T14:00:33.257

唯一可靠的方法是使用临时表，但不会使用太多 SQL：

```
select * into #tmp from bad_table
truncate table bad_table
alter bad_table alter column silly_column int
insert bad_table
select cast(silly_column as int), other_columns
from #tmp
drop table #tmp 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-05-15T21:01:23.743

最简单的方法是：

```
alter table myTable alter column vColumn int; 
```

这将工作，只要

1.  所有数据都适合 int
2.  所有数据都可以转换为int（即“car”的值将失败）
3.  there are no indexes that include vColumn. If there are indexes, you will need to include a drop and create for them to get back to where you were.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-23T15:02:15.197

只需在 SQL Server Management Studio 中更改数据类型。

（您可能需要转到菜单*Tools* → *Options* → *Designers*，并禁用阻止保存重新创建表的更改的选项。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-27T17:17:02.220

我非常感谢以前的答案，但也认为更完整的答案会对其他搜索者有所帮助......

如果您在生产类型表上进行更改，有几个警告会有所帮助。

1.  如果您在表上定义了**标识**列，则必须`IDENTITY_INSERT`围绕重新插入数据进行设置。您还必须使用明确的列列表。
2.  如果您想确保不会杀死数据库中的数据，请使用`TRANSACTIONS`truncate/alter/reinsert 过程
3.  如果您有大量数据，那么尝试在 SQ Server Management Studio 中进行更改可能会因超时而失败，并且您可能会丢失数据。

要扩展@cjk 给出的答案，请查看以下内容：

注意：'tuc' 只是此脚本中真实表名的占位符

```
begin try 
  begin transaction

  print 'Selecting Data...'
  select * into #tmp_tuc from tuc

  print 'Truncating Table...'
  truncate table tuc

  alter table tuc alter column {someColumnName} {someDataType} [not null]
  ... Repeat above until done

  print 'Reinserting data...'
  set identity_insert tuc on
  insert tuc (
    <Explicit column list (all columns in table)>
  )
  select  
    <Explicit column list (all columns in table - same order as above)>
  from #tmp_tuc
  set identity_insert tuc off

  drop table #tmp_tuc
  commit
  print 'Successful!'
end try
begin catch
  print 'Error - Rollback'
  if @@trancount > 0
    rollback

  declare @ErrMsg nvarchar(4000), @ErrSeverity int
  select @ErrMsg = ERROR_MESSAGE(), @ErrSeverity = ERROR_SEVERITY()

  set identity_insert tuc off

  RAISERROR(@ErrMsg, @ErrSeverity, 1)
end catch 
```

# emacs - 为什么我不应该使用推送标记

> ID：577714
> 
> 赞同：5
> 
> 时间：2009-02-23T13:59:01.903
> 
> 标签：emacs, elisp

我实现了一个小函数，它解析 SQL INSERT 语句并在游标位于列名上时突出显示列值，反之亦然。

然后我想增加一种在列名和列值之间快速跳转的可能性。我在我的实现中使用了 push-mark，所以我可以使用 Cx Cx（交换点和标记）跳转。它也有效，唯一困扰我的是一个elisp doc，它说

> 新手 Emacs Lisp 程序员经常尝试将标记用于错误的目的。为了方便用户，该标记保存了一个位置。大多数编辑命令不应改变标记。

我对标记的使用 - 正确吗？或者有什么更好的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T15:14:19.897

考虑与点的位置进行类比：用户只希望在发出点移动命令时移动点。如果像字体锁定这样的随机操作移动了这一点，那将是非常烦人的。因此建议将函数体包装在`(save-excursion ...)`.

*如果您的函数为用户明确*设置标记，那很好。（在这种情况下，我建议调用您的函数`sql-mark-column-value`，以明确设置标记是它所做的事情之一。）您引用的文档的要点是命令不应该因为做某事而*偶然*设置标记别的。

如果您的函数恰好在用户将点放在 SQL 语句中的列名上时设置了标记，那可能不太方便。想象一下有人试图剪切或复制一段 SQL 语句的用例；每次他们试图在声明中移动点时，他们的标记都会被破坏！对于这个用例，您可能希望提供一个单独的命令，`sql-goto-column-value`而不是依赖于`exchange-point-and-mark`.

当然，如果这纯粹是为了您自己使用，任何事情都会发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T14:04:08.833

AFAIK，这是推送标记的正确用法。我认为文档不鼓励使用 push-mark 而不是 save-excursion 以在执行某些操作时保存缓冲区的状态。

# java - Trouble playing wav in Java

> ID：577724
> 
> 赞同：9
> 
> 时间：2009-02-23T14:02:07.947
> 
> 标签：java, wav, playback, javasound

I'm trying to play a

```
PCM_UNSIGNED 11025.0 Hz, 8 bit, mono, 1 bytes/frame 
```

file as described [here (1)](https://stackoverflow.com/questions/26305/how-can-i-play-sound-in-java/26311#26311) and [here(2)](https://stackoverflow.com/questions/26305/how-can-i-play-sound-in-java/26318#26318).

The first approach works, but I don't want to depend on `sun.*` stuff. The second results in just some leading frames being played, that sounds more like a click. Can't be an IO issue as I'm playing from a ByteArrayInputStream.

Plz share your ideas on why might this happen. TIA.

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-23T15:09:00.737

I'm not sure why the second approach you linked to starts another thread; I believe the audio will be played in its own thread anyway. Is the problem that your application finishes before the clip has finished playing?

```
import javax.sound.sampled.*;
import java.io.File;
import java.io.IOException;
import javax.sound.sampled.LineEvent.Type;

private static void playClip(File clipFile) throws IOException, 
  UnsupportedAudioFileException, LineUnavailableException, InterruptedException {
  class AudioListener implements LineListener {
    private boolean done = false;
    @Override public synchronized void update(LineEvent event) {
      Type eventType = event.getType();
      if (eventType == Type.STOP || eventType == Type.CLOSE) {
        done = true;
        notifyAll();
      }
    }
    public synchronized void waitUntilDone() throws InterruptedException {
      while (!done) { wait(); }
    }
  }
  AudioListener listener = new AudioListener();
  AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(clipFile);
  try {
    Clip clip = AudioSystem.getClip();
    clip.addLineListener(listener);
    clip.open(audioInputStream);
    try {
      clip.start();
      listener.waitUntilDone();
    } finally {
      clip.close();
    }
  } finally {
    audioInputStream.close();
  }
} 
```

# iphone - 不可变对象中的可变对象

> ID：577728
> 
> 赞同：2
> 
> 时间：2009-02-23T14:04:14.823
> 
> 标签：iphone, objective-c, cocoa-touch

在 NSDictionary 中有一个 NSMutableArray 是否可以接受？或者 NSDictionary 也必须是可变的？

NSMutableArray 将在运行时添加值，NSDictionary 将始终具有相同的 2 个 NSMutableArrays。

谢谢，

担

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T14:55:54.573

是的，这是完全可以接受的。请记住，数组的内容是**指向**您的 NSMutableArrays 的指针——这些是不可变字典结构中无法更改的内容。指针指向的内容可以改变你想要的一切。以机智：

```
NSMutableArray *arr = [[NSMutableArray alloc] init];
NSDictionary *dict = [NSDictionary dictionaryWithObject:arr forKey:@"test"];

[arr addObject:@"Hello"];
NSString *str = [[dict objectForKey:@"test"] objectAtIndex:0];
NSLog("%@", str); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T19:45:59.493

这是可以接受的。**但是**，正是这种设置表明您应该认真考虑将字典替换为 NSObject 子类，该子类具有两个用于访问数组的属性。

# c - 如何获得显示器的正确物理尺寸？

> ID：577736
> 
> 赞同：11
> 
> 时间：2009-02-23T14:07:15.987
> 
> 标签：c, windows, winapi, monitor

如何获得以厘米或英寸为单位的显示器尺寸？

此代码并不总是正常工作：

```
HDC hdc = CreateDC(_T("DISPLAY"),dd.DeviceName,NULL,NULL);
int width = GetDeviceCaps(hdc, HORZSIZE);
int height = GetDeviceCaps(hdc, VERTSIZE);
ReleaseDC(0, hdc) 
```

尤其适用于多显示器配置。

**更新：**我需要为具有恒定物理尺寸的普通显示器获取尺寸。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-23T21:31:39.927

我找到了另一种方法。显示器的物理大小存储在 EDID 中，Windows 几乎总是在注册表中复制其值。如果可以解析 EDID，则可以读取显示器的宽度和高度（以厘米为单位）。

**更新：**添加代码

```
BOOL GetMonitorDevice( TCHAR* adapterName, DISPLAY_DEVICE &ddMon )
{
    DWORD devMon = 0;

    while (EnumDisplayDevices(adapterName, devMon, &ddMon, 0))
    {
        if (ddMon.StateFlags & DISPLAY_DEVICE_ACTIVE &&
            ddMon.StateFlags & DISPLAY_DEVICE_ATTACHED) // for ATI, Windows XP
            break;

        devMon++;
    }

    if (ddMon.DeviceString[0] == '\0')
    {
        EnumDisplayDevices(adapterName, 0, &ddMon, 0);
        if (ddMon.DeviceString[0] == '\0')
            _tcscpy_s(ddMon.DeviceString, _T("Default Monitor"));
    }
    return ddMon.DeviceID[0] != '\0';
}

BOOL GetMonitorSizeFromEDID(TCHAR* adapterName, DWORD& Width, DWORD& Height)
{
    DISPLAY_DEVICE ddMon;
    ZeroMemory(&ddMon, sizeof(ddMon));
    ddMon.cb = sizeof(ddMon);

    //read edid
    bool result = false;
    Width = 0;
    Height = 0;
    if (GetMonitorDevice(adapterName, ddMon))
    {
        TCHAR model[8];
        TCHAR* s = _tcschr(ddMon.DeviceID, '\\') + 1;
        size_t len = _tcschr(s, '\\') - s;
        if (len >= _countof(model))
            len = _countof(model) - 1;
        _tcsncpy_s(model, s, len);

        TCHAR *path = _tcschr(ddMon.DeviceID, '\\') + 1;
        TCHAR str[MAX_PATH] = _T("SYSTEM\\CurrentControlSet\\Enum\\DISPLAY\\");
        _tcsncat_s(str, path, _tcschr(path, '\\')-path);
        path = _tcschr(path, '\\') + 1;
        HKEY hKey;
        if(RegOpenKeyEx(HKEY_LOCAL_MACHINE, str, 0, KEY_READ, &hKey) == ERROR_SUCCESS)
        {
            DWORD i = 0;
            DWORD size = MAX_PATH;
            FILETIME ft;
            while(RegEnumKeyEx(hKey, i, str, &size, NULL, NULL, NULL, &ft) == ERROR_SUCCESS)
            {
                HKEY hKey2;
                if(RegOpenKeyEx(hKey, str, 0, KEY_READ, &hKey2) == ERROR_SUCCESS)
                {
                    size = MAX_PATH;
                    if(RegQueryValueEx(hKey2, _T("Driver"), NULL, NULL, (LPBYTE)&str, &size) == ERROR_SUCCESS)
                    {
                        if (_tcscmp(str, path) == 0)
                        {
                            HKEY hKey3;
                            if(RegOpenKeyEx(hKey2, _T("Device Parameters"), 0, KEY_READ, &hKey3) == ERROR_SUCCESS)
                            {
                                BYTE EDID[256];
                                size = 256;
                                if(RegQueryValueEx(hKey3, _T("EDID"), NULL, NULL, (LPBYTE)&EDID, &size) == ERROR_SUCCESS)
                                {
                                    DWORD p = 8;
                                    TCHAR model2[9];

                                    char byte1 = EDID[p];
                                    char byte2 = EDID[p+1];
                                    model2[0]=((byte1 & 0x7C) >> 2) + 64;
                                    model2[1]=((byte1 & 3) << 3) + ((byte2 & 0xE0) >> 5) + 64;
                                    model2[2]=(byte2 & 0x1F) + 64;
                                    _stprintf(model2 + 3, _T("%X%X%X%X"), (EDID[p+3] & 0xf0) >> 4, EDID[p+3] & 0xf, (EDID[p+2] & 0xf0) >> 4, EDID[p+2] & 0x0f);
                                    if (_tcscmp(model, model2) == 0)
                                    {
                                        Width = EDID[22];
                                        Height = EDID[21];
                                        result = true;
                                    }
                                    else
                                    {
                                        // EDID incorrect
                                    }
                                }
                                RegCloseKey(hKey3);
                            }
                        }
                    }
                    RegCloseKey(hKey2);
                }
                i++;
            }
            RegCloseKey(hKey);
        }
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-23T14:21:42.003

无法确定 Windows 上视频设备的确切物理尺寸，因为这取决于很多变量（例如活动监视器配置文件、水平/垂直分辨率、像素大小等），其中一些不在计算机的控制。

以投影仪设备为例，其物理尺寸取决于无法通过编程方式确定的投影区域的距离，因为视频投影仪可以随时手动移动。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-11-26T21:21:23.550

直接导航注册表不仅不受支持，而且对于与您的设备不同的设备实际上会失败。（例如，我测试您的代码的那个）。

与这里的某些人所说的不同，有*一种*访问 EDID 密钥路径的官方方法：通过使用 Setup API，特别是[SetupDiOpenDevRegKey](http://msdn.microsoft.com/en-us/library/windows/hardware/ff552079%28v=vs.85%29.aspx)。

涉及一些繁琐的设置 -[示例代码在这里](http://thetweaker.wordpress.com/2011/11/13/reading-monitor-physical-dimensions-or-getting-the-edid-the-right-way/)。

* * *

[编辑：这里](http://ofekshilon.com/2014/06/19/reading-specific-monitor-dimensions/)处理多个监视器。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-23T14:57:47.657

您无法获得真正的确切尺寸 - 您可以获得取决于 Windows 中的 DPI 设置和屏幕分辨率的近似值，但您不能保证这是真实尺寸。

尤其是在具有不同显示器（例如 19 英寸 CRT 和 24 英寸 LCD）的多显示器情况下。此外，如果显示器是 CRT，则测量是管测量，而不是显示区域。

当程序过去完全需要这些信息时，它们会在屏幕上显示一个量规，并让用户将一张纸放在屏幕上并用量规测量纸张宽度。假设纸张是 8.5 英寸或 A4，那么您知道宽度，您可以使用他们输入的数字来计算给定显示器的真实 DPI。您可能需要让他们为多显示器设置中的每台显示器执行此操作。

-亚当

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-04-30T21:52:25.923

Windows Vista 及更高版本支持新功能 GetMonitorDisplayAreaSize() [http://msdn.microsoft.com/en-us/library/ms775210%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms775210%28VS.85%29.aspx)

更新：它不能正常工作

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T14:51:01.763

[您可以从GetDeviceCaps](http://msdn.microsoft.com/en-us/library/dd144877(VS.85).aspx)请求 LOGPIXELSX以获取显示器的 DPI，尽管它通常会返回 96。另请参阅这篇[MSDN 文章 on writing DPI-aware apps](http://msdn.microsoft.com/en-us/library/ms701681(VS.85).aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-04T18:41:32.080

您可以从注册表中获取 EDID。

# jquery - bgiframe 插件是否适用于 jQuery 1.3.x？

> ID：577739
> 
> 赞同：1
> 
> 时间：2009-02-23T14:08:43.127
> 
> 标签：jquery, bgiframe

使用 jQuery 1.2.6 我会做以下事情，一切都很好

```
$("#element").bgiframe(); 
```

但我见过的唯一使用 jQuery 1.3.x 的例子（如下所示）

```
$("#element").bgiframe = true; 
```

但以上不起作用......那么有没有人有一个新的插件来做这种事情？

编辑：我在 jQuery.UI 之外使用这个插件，我使用的版本是 2.1.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T20:11:12.820

我意识到如果我只是调整旧插件中的 js 代码，它可以与 jQuery 1.3.x 一起使用

下面是这个插件的最终版本 - 100% 使用 jQuery 1.3.1

由于名称冲突，我不得不将其重命名为 bbgiframe（而不是 bgiframe）

因此，当您调用它时，请执行以下操作：

```
$("#element").bbgiframe(); 
```

现在修改后的插件代码：

```
$.fn.bbgiframe = function(s) {
    // This is only for IE6
    if ( $.browser.msie && /6.0/.test(navigator.userAgent) ) {
        s = $.extend({
            top     : 'auto', // auto == .currentStyle.borderTopWidth
            left    : 'auto', // auto == .currentStyle.borderLeftWidth
            width   : 'auto', // auto == offsetWidth
            height  : 'auto', // auto == offsetHeight
            opacity : true,
            src     : 'javascript:false;'
        }, s || {});
        var prop = function(n){return n&&n.constructor==Number?n+'px':n;},
            html = '<iframe class="bbgiframe"frameborder="0"tabindex="-1"src="'+s.src+'"'+
                       'style="display:block;position:absolute;z-index:-1;'+
                           (s.opacity !== false?'filter:Alpha(Opacity=\'0\');':'')+
                           'top:'+(s.top=='auto'?'expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+\'px\')':prop(s.top))+';'+
                           'left:'+(s.left=='auto'?'expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+\'px\')':prop(s.left))+';'+
                           'width:'+(s.width=='auto'?'expression(this.parentNode.offsetWidth+\'px\')':prop(s.width))+';'+
                           'height:'+(s.height=='auto'?'expression(this.parentNode.offsetHeight+\'px\')':prop(s.height))+';'+
                    '"/>';
        return this.each(function() {
            if ( $('> iframe.bbgiframe', this).length == 0 )
                this.insertBefore( document.createElement(html), this.firstChild );
        });
    }
    return this;
}; 
```

# c# - DataGridViewComboBoxColumn - 下拉列表中的项目类型

> ID：577740
> 
> 赞同：1
> 
> 时间：2009-02-23T14:08:59.070
> 
> 标签：c#, .net, datagridview

我有一个具有 ComboBox 列的 DataGridView。**我用Field**类型的项目填充此列的列表：

```
DataGridViewComboBoxColumn fieldsColumn = argumentsDataGridView.Columns["field"] as DataGridViewComboBoxColumn;
            foreach (Field field in SessionData.Fields)
                fieldsColumn.Items.Add(field);
            fieldsColumn.DisplayMember = "Name"; 
```

然后在某些用户的操作之后，我在此列的单元格中输入了一个值，如下所示：

```
private void AddArgument(string argumentName, Field field)
        {
            int index = argumentsDataGridView.Rows.Count;
            argumentsDataGridView.Rows.Add(new DataGridViewRow());
            DataGridViewRow newRow = argumentsDataGridView.Rows[index];
            newRow.Cells["nameArg"].Value = argumentName;
            -> newRow.Cells["field"].Value = field;
        } 
```

如果我现在访问单元格的值，它的类型是**Field**。如果我从组合中选择不同的项目，则单元格的值将变为字符串。我该如何处理？我需要**Field**类型的项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T09:08:29.863

解决方案是在类**Field**中创建一个属性**Self**：

 **```
public Field Self
        {
            get { return this; }
        } 
```

并设置为组合框列的 ValueMember。
我认为没有指定 ValueMember*这*是一个默认的返回值，我错了。

# c# - 有没有办法强制 C# 类实现某些静态函数？

> ID：577749
> 
> 赞同：40
> 
> 时间：2009-02-23T14:11:21.763
> 
> 标签：c#, .net, interface, static-methods

我正在开发一组~~实现通用接口~~的类。我的库的使用者应该期望这些类中的每一个都实现一组特定的静态函数。无论如何我可以装饰这些类，以便编译器能够捕获其中一个函数未实现的情况。

我知道在构建消费代码时它最终会被捕获。而且我也知道如何使用一种工厂类来解决这个问题。

只是想知道是否有任何语法/属性需要类上的静态函数。

**Ed**删除了“接口”一词以避免混淆。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-23T14:16:43.483

不，C# 中没有对此的语言支持。我可以立即想到两种解决方法：

*   在运行时使用反射；交叉手指和希望...
*   使用单例/默认实例/类似来实现声明方法的接口

（**更新**）

实际上，只要您有单元测试，如果（像我一样）您来自严格的“静态类型”背景，第一个选项实际上并没有您想象的那么糟糕。事实是; 它在动态语言中运行良好。事实上，这正是我的[通用运算符](https://jonskeet.uk/csharp/miscutil/usage/genericoperators.html)代码的工作方式——它*希望*你拥有静态运算符。在运行时，如果你不这样做，它会以适当的嘲弄语气嘲笑你......但它无法在编译时检查。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-23T14:21:55.217

不，基本上听起来你在追求一种“静态多态性”。这在 C# 中不存在，尽管我提出了一种[“静态接口”概念，它在泛型方面可能很有用](http://codeblog.jonskeet.uk/2008/08/29/lessons-learned-from-protocol-buffers-part-4-static-interfaces/)。

您*可以*做的一件事是编写一个简单的单元测试来验证特定程序集中的所有类型是否符合您的规则。如果其他开发人员也将实现该接口，您可以将该测试代码放在某个公共位置，以便实现该接口的每个人都可以轻松地测试他们自己的程序集。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-07-22T20:30:24.170

这是一个很好的问题，也是我在项目中遇到的一个问题。

有些人认为接口和抽象类的存在只是为了多态性，而不是为了强制类型实现某些方法。就个人而言，我认为多态性是主要用例，而强制实现是次要用例。我确实经常使用强制实现技术。通常，它出现在实现模板模式的框架代码中。基类/模板类封装了一些复杂的想法，子类通过实现抽象方法提供了许多变体。一个实用的好处是抽象方法为实现子类的其他开发人员提供了指导。Visual Studio 甚至可以为您存根方法。当维护开发人员需要在数月或数年后添加新的子类时，这尤其有用。

缺点是在 C# 中没有对其中一些模板方案的特定支持。静态方法就是其中之一。另一种是构造函数；理想情况下，ISerializable 应该强制开发人员实现受保护的序列化构造函数。

最简单的方法可能是（如前所述）使用自动化测试来检查静态方法是否在所需类型上实现。已经提到的另一个可行的想法是实现静态分析规则。

第三种选择是使用面向方面的编程框架，例如[PostSharp](http://www.postsharp.org/)。PostSharp 支持方面的编译时验证。您可以编写在编译时反映程序集的 .NET 代码，从而生成任意警告和错误。通常，您这样做是为了验证方面的使用是否合适，但我不明白为什么您也不能使用它来验证模板规则。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-23T14:12:22.167

不幸的是，不，语言中没有这样的内容。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-23T14:41:47.633

虽然对此没有语言支持，但您可以使用静态分析工具来强制执行它。例如，您可以为 FxCop 编写一个自定义规则，该规则检测类上的属性或接口实现，然后检查某些静态方法的存在。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-26T12:01:48.087

单例模式并非在所有情况下都有帮助。我的例子来自我的一个实际项目。这不是人为的。

我有一个继承自第三方 ORM 中的类的类（我们称之为“Widget”）。如果我实例化一个 Widget 对象（因此在 db 中创建一行）只是为了确保声明了我的静态方法，那么我将比我试图清理的那个更混乱。

如果我在数据存储中创建这个额外的对象，我必须对用户、计算等隐藏它。

我在 C# 中使用接口来确保在一组类中实现通用功能。

实现这些功能的一些方法需要实例数据才能运行。我将这些方法编码为实例方法，并使用 C# 接口确保它们存在于类中。

其中一些方法不需要实例数据，因此它们是静态方法。如果我可以用静态方法声明接口，编译器可以检查这些方法是否存在于说它实现接口的类中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T14:21:45.000

不，这个功能没有意义。接口基本上是多重继承的缩小形式。它们告诉编译器如何设置虚函数表，以便可以在后代类中正确调用非静态虚方法。静态方法不能是虚拟的，因此，为它们使用接口是没有意义的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T14:57:15.867

正如 Marc Gravell 所建议的，使您更接近所需的方法是单例。

接口，除其他外，让您可以为您的类提供某种程度的抽象，这样您就可以使用给定的 API，而不管实现它的类型如何。但是，既然您确实需要知道静态类的类型才能使用它，那么为什么要强制该类实现一组函数呢？

也许您可以使用像 [ImplementsXXXInterface] 这样的自定义属性并提供一些运行时检查以确保具有此属性的类实际上实现了您需要的接口？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-04T21:14:25.703

如果您刚刚收到这些编译器错误，请考虑以下设置：

1.  在接口中定义方法。
2.  用抽象声明方法。
3.  实现公共静态方法，并让抽象方法覆盖简单地调用静态方法。

这是一些额外的代码，但你会知道何时有人没有实现所需的方法。

# iphone - 从分叉终端运行 xcodebuild

> ID：577750
> 
> 赞同：59
> 
> 时间：2009-02-23T14:11:22.137
> 
> 标签：iphone, xcode, xcodebuild

我正在尝试为 iPhone 应用程序设置自动构建服务器。我希望能够在夜间进行临时测试版构建，以便测试人员可以跟踪开发。

我已经成功设置了 xcode xcode 来执行临时构建，我还可以从命令行启动构建：

> xcodebuild -configuration AdHoc -sdk iphoneos2.2 clean build

我遇到的问题是以下行在分叉终端（使用 nohup 或 screen）上不起作用，并且因以下原因而失败

> CodeSign 错误：代码签名身份“iPhone 分发：XXXXX”与钥匙串中的任何代码签名证书都不匹配。添加到钥匙串后，触摸文件或清理项目以继续。

我在 shell 和 nohup 或 screen 中检查了我的环境变量，但没有找到任何线索。我想我的问题是分叉终端无法访问钥匙串，但我不知道如何允许它。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-02-24T08:59:49.430

我有一个错误**不允许用户交互**并通过首先解锁钥匙串来解决它

```
security unlock-keychain /Users/yannooo/Library/Keychains/login.keychain 
```

我还尝试将我的证书放入系统的钥匙串中并且它正在工作。*我的最终解决方案是使用Keychain Access*应用程序将我所有的 iPhone 相关证书放在一个名为 iPhone.keychain 的专用钥匙串中

```
security list-keychains -s /Users/yannooo/Library/Keychains/iPhone.keychain 
security unlock-keychain -p keychainpassword /Users/yannooo/Library/Keychains/iPhone.keychain 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-02-07T21:11:33.370

这有两个（可能是三个！）组件。一是钥匙链必须解锁。其次，钥匙串内部有一个访问控制列表，它告诉处于解锁状态的应用程序授予哪些权限。因此，即使您成功解锁了钥匙串，如果没有授予访问私钥并使用它签名的能力，`/usr/bin/codesign`那么您仍然会收到此消息。最后，如果您在 Mac OS Sierra 上，分配给密钥的默认分区 ID 不正确，以便与`codesign`二进制文件兼容。

解决方法如下：

1) 如果您有权访问 Keychain Access GUI，那么您可以手动授予每个程序或 /usr/bin/codesign 访问权限，方法是右键单击您的私钥，选择“访问控制”选项卡，然后选择“允许所有应用程序”访问此项目”单选或“始终允许这些应用程序访问”列表。

2) 如果您遇到此错误，则可能是您尝试`codesign`为非登录用户运行。在这种情况下，您显然无权访问“钥匙串访问”GUI。对于这些情况，您可以验证`sign`application 缺少的授权`<null>`，这显然意味着所有应用程序，或者特别`/usr/bin/codesign`是通过使用：

```
security dump-keychain -i login.keychain 
```

但是，由于某种原因，您不能在交互模式下添加或修改访问控制属性——只能删除！您实际上必须手动删除密钥并将其重新添加到指定`-T`标志的钥匙串中。

```
security import login.keychain -P "<password>" -T /usr/bin/codesign 
```

哪里`-T`指定

```
-T  Specify an application which may access the imported key (multiple -T options are allowed) 
```

3) 如果您使用的是 Mac OS Sierra，请修改分区 ID 以包含该`apple`分区。据推测，这是分配给的命名空间，`codesign`因为它是由 Apple 分发的。

`security set-key-partition-list -S apple-tool:,apple: -k "<password>" login.keychain`

*注意*：`apple-tool`分区是由工具插入的`security`，因此上面的命令会保留该分区。有关这方面的更多信息，请参阅：[http ://www.openradar.me/28524119](http://www.openradar.me/28524119)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-09-02T11:08:22.507

另一个解决方案：

*   打开钥匙串访问
*   右键单击私钥
*   选择“获取信息”
*   选择“访问控制”选项卡
*   单击“允许所有应用程序访问此项目”
*   点击“保存更改”
*   输入您的密码
*   享受

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-23T22:28:47.153

您可以`security list-keychains -s ${HOME}/Library/Keychains/login.keychain`在构建过程中使用将您的登录钥匙串显式添加到搜索列表中吗？从分叉的终端看来，构建过程看不到您的用户钥匙串。如果钥匙串搜索列表基于您当前的安全会话，这可能是有意义的——分叉的终端会话将离开登录会话，就像您`ssh`通过环回连接一样。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-04-06T07:46:14.987

**与 Jenkins 遇到类似问题的人的更新：**

如果您将 Mac 设置为通过 LaunchDaemons 启动 jenkins，则需要确保添加

```
<key>SessionCreate</key>
<true /> 
```

所以整个 ci.plist 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
 <key>Label</key>
 <string>Jenkins</string>
 <key>UserName</key>
 <string>user</string>
 <key>GroupName</key>
 <string>staff</string>
 <key>ProgramArguments</key>
 <array>
 <string>/usr/bin/java</string>
 <string>-Xmx512m</string>
 <string>-jar</string>
 <string>/path/to/jenkins/jenkins.war</string>
 </array>
 <key>RunAtLoad</key>
 <true/>
 <key>KeepAlive</key>
 <true/>
 <key>EnvironmentVariables</key>
   <dict>
     <key>JENKINS_HOME</key>
     <string>/path/to/jenkins/home</string>
   </dict>
 <key>SessionCreate</key>
 <true />
</dict>
</plist> 
```

我一直被上面许多人遇到的同样的问题所困扰。具体来说，我在从 Jenkins shell 脚本运行时遇到了这个问题，我得到了相同的 ** 不允许用户交互 ** 错误。从 ssh shell 运行时，我的脚本运行良好。

大多数人也看到的不同之处在于，如果您运行 **security list-keychain**您会得到：

```
$ security list-keychain
  "/Library/Keychains/System.keychain"
  "/Library/Keychains/System.keychain" 
```

但是在 ssh shell 中运行时，我会得到：

```
$ security list-keychain
    "/Users/<i>user_account_name</i>/Library/Keychains/login.keychain"
    "/Library/Keychains/System.keychain" 
```

大多数人将在用户帐户钥匙串中拥有所有密钥/证书等。就像一些人建议的那样，制作一个与用户密钥链不同的新密钥链很容易，并将其重新用于您的 XCode 签名内容。我最终把我的放在这里：/Library/Keychains/sysiphone.keychain

我认为问题在于，对于我的设置（也可能是您的设置），您在不同的安全首选项域（系统与用户）中运行。最后 - 这是我如何让我的 sysiphone.keychain 出现：

```
$ sudo security list-keychains -d system -s "/Library/Keychains/sysiphone.keychain"
Password: *****
$ security list-keychains -d system
    "/Library/Keychains/sysiphone.keychain" 
```

......神奇的事情开始在詹金斯建立。哇......这对我来说大约是 4 小时。叹。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-10-27T13:25:04.103

好的，对我来说问题是两件事，第一是解锁钥匙串；

```
security unlock-keychain login.keychain 
```

其次是（空）密码，

```
security import blahblahbackup.p12 -k login.keychain -T /usr/bin/codesign -P "" 
```

更新： A 后来有一个小问题，当脚本是从 web 脚本或某事触发时。像那样。它只看到 /Library/Keychains/System.chain。所以我找到了一个肮脏的解决方法（这可能会导致安全问题，但对我来说还可以）；

*   在我的情况下，设置 pubkey ssh 登录（从想要调用构建脚本的用户到拥有证书并将运行 xcodebuild 的实际用户），它是同一个用户。Apache 正在工作，`someuser`并且构建的所有内容都设置在`someuser`.
*   我的 php 脚本（用于触发构建）正在调用 ~/build-script。我已经改变了这样的：

    ssh someuser@localhost ~/build-script

所以它可以在真正的 tty 中工作，并且所有钥匙串都可以访问，一切正常。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-23T23:35:23.780

正如另一张海报所说，

```
security list-keychains -s  "~/Library/Keychains/login.keychain" 
```

但我认为您只有在登录时才能在 GUI 上下文中访问 login.keychain（我刚刚通过 SSH 和屏幕在系统上进行了测试，但我也碰巧通过 VNC 登录）。

显然可以使用 launchctl 来选择 GUI 上下文并运行程序，但我怀疑它也只适用于“登录用户”。

如果您尝试 ' `security show-keychain-info keychain-file`' 那么您将收到以下错误：

> 不允许用户交互

这是一个用于搜索更多信息的短语。另一种解决方案是将证书放入您的系统钥匙串！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-30T22:36:21.683

解锁登录钥匙串对我不起作用。使用 Keychain Access（称为 iOS）创建单独的钥匙串，然后将这些命令添加到构建中确实有效（当以我自己的用户身份运行 Jenkins 时）：

security -v list-keychains -d system -s ~/Library/Keychains/iOS.keychain; security -v unlock-keychain -p 密码 ~/Library/Keychains/iOS.keychain;

不过，这看起来更有希望：[https ://wiki.jenkins-ci.org/display/JENKINS/Xcode+Plugin#XcodePlugin-Userinteractionisnotallowed](https://wiki.jenkins-ci.org/display/JENKINS/Xcode+Plugin#XcodePlugin-Userinteractionisnotallowed)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-23T20:18:44.983

我查看了安全命令，似乎分配给我的终端的钥匙串在分叉时并不相同。如果我在终端中启动安全命令，我有：

```
$ security list-keychains
  "/Users/yannooo/Library/Keychains/login.keychain"
  "/Library/Keychains/System.keychain" 
```

而使用*屏幕*时，我有以下输出：

```
$ security list-keychains
    "/Library/Keychains/System.keychain"
    "/Library/Keychains/System.keychain" 
```

由于我的构建证书存储在登录钥匙串中，因此我的代码签名错误看起来很正常。

有谁知道我如何将钥匙串分配给终端？我试过这个没有成功

```
security login-keychain -s /Users/yannooo/Library/Keychains/login.keychain 
```

有任何想法吗？

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-04-19T09:28:40.280

我正在使用 Atlassian Bamboo 2.7 和 OS X 10.7.3 Lion，我已经尝试了线程中的所有方法，但我仍然收到“不允许用户交互”错误。

问题在于，在远程终端会话中（作为“超级用户”，例如在 Bamboo 或其他自动构建系统的情况下），需要解锁的包含签名证书的钥匙串与您通常看到的不同（例如如 Yann 在[此处](https://stackoverflow.com/a/579154/328948)所示）当您不是超级用户时。

最终对我有用的是执行以下操作：

1.  [如此处所述，](http://support.apple.com/kb/HT1528)以系统管理员身份登录
2.  创建仅签名的钥匙串（例如，`ios.keychain`）
3.  向其中添加签名证书（连同 WWDRCA 证书）

通过在终端上`su`运行来验证它。`security list-keychains`您应该在列表中看到 ios.keychain。（`sudo security list-keychains`不会显示相同的东西）：

```
sh-3.2# security list-keychains
"/private/var/root/Library/Keychains/login.keychain"
"/Library/Keychains/ios.keychain"
"/Library/Keychains/System.keychain" 
```

我发现您仍然需要在执行`unlock-keychain`命令之前将 ios.keychain 添加到您的搜索范围。在您的构建脚本中，运行以下行：

```
KEYCHAIN=/Library/Keychains/ios.keychain
# the -s option adds $KEYCHAIN to the search scope, while the -d option adds $KEYCHAIN to the system domain; both are needed
security -v list-keychains -d system -s $KEYCHAIN 
security -v unlock-keychain -p bambooiphone $KEYCHAIN 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-10-15T23:39:33.713

如果您正在运行`security list-keychains`并且看到您的自定义钥匙串出现在列表中的某个位置但它仍然不起作用，则可能是您遇到了我遇到的问题，即从搜索列表中按顺序检查钥匙串，并且因为我没有`login.keychain`在我的 SSH 会话中解锁，它会在那里失败，而不是移动到列表中的下一个钥匙串，这是我想要解锁的自定义钥匙串。

将搜索列表设置为您可以解锁的自定义钥匙串`security unlock-keychain`。使用 Yann 的回答中的这种方法也会从搜索列表中删除您的 login.keychain。

要保留 login.keychain：

```
security list-keychains -s ~/Library/Keychains/custom.keychain ~/Library/Keychains/login.keychain 
```

这样，当在机器上使用 GUI 会话时，您仍然可以访问`login.keychain`项目，但代码签名将首先检查自定义钥匙串，如果您已解锁它，则会成功。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-25T06:57:39.433

如果您以 root 身份执行 xcodebuild（当您使用 sudo 时），您需要以 root 身份登录并将您的签名证书放入 root 的钥匙串中。然后如上所述用安全性解锁钥匙串。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-04-16T08:32:59.543

我做了：

*   `login.keychain`从列表中删除

*   创建自己的钥匙串`$HOME/Library/Keychains/`

*   将其添加到钥匙串列表（我没有指定任何特定域）

*   将其设置为默认值

*   打电话`security unlock-keychain`给它

*   向其添加全局签名证书 (WWDRCA)

*   向其导入私钥以及开发和分发证书

如果有`login.keychain`，我仍然会收到“不允许用户交互”错误。因此删除`login.keychain`使用`security delete-keychain`终于有帮助！

# sql-server-2008 - 任何人都使用 SQl Server 2008 HierarchialID 类型来存储家谱数据

> ID：577756
> 
> 赞同：6
> 
> 时间：2009-02-23T14:14:50.820
> 
> 标签：sql-server-2008, hierarchyid, genealogy

我有一个家谱数据库（实际上是关于绵羊的），育种者使用它来研究遗传信息。在每条记录中，我存储父亲和母亲。在一个单独的表中，我存储了完整的“汇总”信息，这样我就可以快速了解任何动物的完整家谱，而无需遍历整个数据库......

最近发现了 SQL Server 2008 中内置的分层 ID 类型，表面上听起来很有希望，但我想知道是否有人已经使用它足以知道它是否适合我的应用程序类型（即两个父母，多个孩子)? 到目前为止，我发现/阅读的所有示例都涉及经理/员工类型的关系，其中给定的老板可以有多个员工，每个员工可以有一个老板。

我的应用程序的需求相似，但并不完全相同。

我相信无论如何我都会深入研究这项新技术，但如果有人已经知道它的设计方式并没有让我可以使用它，那么缩短我的研究会很好。

我也很好奇人们使用这种新数据类型与其他做同样事情的方法相比，看到了什么样的性能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-28T07:27:55.827

假设每只羊有一个父本和一个母本，并且没有一只羊可以是它自己的父本（导致 Ovine Temporal Paradox），那么使用两个 HierarchyID 怎么样？

```
CREATE TABLE dbo.Sheep(
    MotherHID hierarchyid NOT NULL,
    FatherHID hierarchyid NOT NULL,
    Name int NOT NULL
)
GO
ALTER TABLE dbo.Sheep 
ADD CONSTRAINT PK_Sheep PRIMARY KEY CLUSTERED (
    MotherHID,
    FatherHID
)
GO 
```

通过使它们成为联合 PK，您将唯一地将每只羊识别为其母系等级和父系等级的产物。

这里可能潜伏着一些固有的问题，因此请谨慎使用几个简单的原型——但最初它似乎对你有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T14:38:05.443

我看不出它是如何工作的；在常规层次结构中，根有一条链，因此它可以存储每个节点的路径（即二进制文件）**。**但是，如果有多个父母，这是不可能的：即使您将母权制和父权制分开，您仍然有 1 位母亲、2 位祖母、4 位曾祖母等（甚至没有进入一些更“有趣”的扫描仪可能，尤其是牲畜）。编码没有单一的逻辑路径，所以不：我认为这不适用于您的情况。

不过，我很高兴得到纠正。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-03T15:38:08.337

使用两个单独的 HierarchyID 来指示父亲和母亲会很好。

但是，您绝对不想将它们用作行的唯一指示符，因为它是 2 对多的情况。（两只羊可以有多个孩子。）

我认为使用 HierarchyId 作为祖先没有任何本质上的错误——至少对于 Sheep 而言。对人来说，关系比“这个人生那个人”要复杂得多，所以显然用途仅限于繁殖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-20T06:54:04.673

SQL Server hierarchyID 不是许多家谱分析问题的可靠解决方案。它基于 ORDPATH，我已经在族谱中使用了一段时间；但是家谱中有太多场景无法通过有向无环图的 ORDPATH 方法轻松解决。图数据库更加健壮，非常适合谱系学。我使用 Neo4j：[http](http://stumpf.org/genealogy-blog/graph-databases-in-genealogy) ://stumpf.org/genealogy-blog/graph-databases-in-genealogy 。

# python - 如何防止 Python 的 os.walk 穿过挂载点？

> ID：577761
> 
> 赞同：11
> 
> 时间：2009-02-23T14:16:59.520
> 
> 标签：python, linux, unix

在 Unix 中，所有磁盘都作为主文件系统中的路径公开，因此`os.walk('/')`会遍历，例如，`/media/cdrom`以及主硬盘，这对于某些应用程序来说是不可取的。

如何获得`os.walk`留在单个设备上的？

有关的：

*   [使用 os.walk 时，有没有办法确定子目录是否与 python 位于同一文件系统中？](https://stackoverflow.com/questions/530645/is-there-a-way-to-determine-if-a-subdirectory-is-in-the-same-filesystem-from-pyth/)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-23T14:39:56.767

来自`os.walk`文档：

> 当 topdown 为真时，调用者可以就地修改 dirnames 列表（可能使用 del 或 slice 赋值），并且 walk() 只会递归到名称保留在 dirnames 中的子目录；这可以用来修剪搜索

所以这样的事情应该有效：

```
for root, dirnames, filenames in os.walk(...):
  dirnames[:] = [
    dir for dir in dirnames
    if not os.path.ismount(os.path.join(root, dir))]
  ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T14:40:49.150

我认为[os.path.ismount](http://docs.python.org/library/os.path.html#os.path.ismount)可能对你有用。您的代码可能如下所示：

```
import os
import os.path
for root, dirs, files in os.walk('/'):
    # Handle files.
    dirs[:] = filter(lambda dir: not os.path.ismount(os.path.join(root, dir)), 
                  dirs) 
```

您可能还会发现[此答案](https://stackoverflow.com/questions/571850/adding-elements-to-python-generators)有助于构建您的解决方案。

*感谢您对`dirs`正确过滤的评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T14:31:05.587

`os.walk()`不能告诉（据我所知）它正在浏览不同的驱动器。你需要自己检查一下。

尝试使用`os.stat()`，或检查根变量 from`os.walk()`不是`/media`

# asp.net - 标题属性 - 对使网页可访问有用吗？

> ID：577764
> 
> 赞同：2
> 
> 时间：2009-02-23T14:18:22.730
> 
> 标签：asp.net, html, accessibility

我读过的关于使网页可访问的资料提供了关于“标题”属性是否真的有用的相互矛盾的信息。一些人声称，最好的做法是为 Web 控件提供一个包含比控件上的可见文本更详细的说明的标题属性。其他人声称大多数屏幕阅读器的默认设置是忽略标题属性，因此该属性在实践中是无用的（除了为有视力的读者提供工具提示）。那么，大家有什么推荐的呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T14:21:06.857

并非所有屏幕阅读器都会忽略标题，但有些会忽略。这是那些领域之一，但最好将它包括在内，因为那些*可以获得*该内容的人*会*。加上搜索引擎喜欢标题标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T14:25:27.877

实际上，我现在在[这个问题中遇到了另一个 Stack Overflow 用户的问题](https://stackoverflow.com/questions/545757/web-config-error-when-trying-to-use-forms-authentication)。具体来说，冗长标题的原因是：

*   一个好的标题可以向访问者传达有关页面内容的大量信息
*   `title`谷歌对标签内的文字赋予更高的权重

但是，当用户访问您的页面并且不知道发生了什么仅仅因为您决定玩搜索引擎时，他们就会失去这一点。以堆栈溢出为例。一个 50 字的标题可能对谷歌有好处，但如果这个问题有以下标题，作为用户你会有*什么感觉：*

* * *

## 我应该延长标题属性以在 Google 上获得更高的排名，还是应该缩短标题属性以使其易于访问且不会让我的用户发疯？

* * *

最后，虽然谷歌确实很重要；用户到达网站后，让他们留在您的网站上并不重要；更不用说冗长标题标签的好处在可访问性上丢失了。

这个网站有[一篇关于这个主题的精彩文章](http://www.smashingmagazine.com/2009/02/18/9-common-usability-blunders/)，他们写道：

> *[...]*第二个原因与 SEO 有关。搜索引擎需要不同的信息来对特定查询的结果进行排名。页面标题是他们用来衡量您的页面与特定搜索词的相关程度的更重要信息之一。这并不意味着您应该在标题中加载尽可能多的关键字——这违背了第一个好处——**但你应该确保每个标题都简洁地描述了页面的内容，包括你认为人们会搜索的几个词。** *（强调添加）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T14:25:58.687

我在我的网站的任何链接上使用标题，因为它是 WC3 根据可访问性指南 13.1 推荐的，请参阅[http://www.w3.org/TR/WAI-WEBCONTENT-TECHS/#tech-meaningful-links](http://www.w3.org/TR/WAI-WEBCONTENT-TECHS/#tech-meaningful-links)

对于许多这些可访问性问题，请记住，应用程序现在不使用的东西可能会在未来使用，所以最好不要做太多而不是做最少的事情。

# java - 偶尔会遇到长时间的垃圾收集延迟，为什么？

> ID：577773
> 
> 赞同：15
> 
> 时间：2009-02-23T14:21:16.153
> 
> 标签：java, garbage-collection

我很难处理 Java 垃圾收集问题并解释日志。

我的应用程序要求没有 GC 花费超过 2 秒，理想情况下少于 100 毫秒。

根据之前的一些建议，我正在尝试以下命令行选项：

```
 java -XX:MaxGCPauseMillis=100 -XX:NewRatio=9 -XX:+UseConcMarkSweepGC  -XX:+CMSIncrementalMode -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -server -Xmx9g -Xms9g 
```

该应用程序有大量长期存储的对象，这些对象保存在 ConcurrentLinkedHashMap 中。我看到偶尔的长时间停顿，在最坏的情况下长达 10 秒（这是下面 GC 日志的倒数第二个）！

这是我得到的一些输出：

```
16938.968: [GC 16938.968: [ParNew: 153343K->17022K(153344K), 7.8608580 secs] 6184328K->6122510K(9420160K) icms_dc=7 , 7.8614100 secs] [Times: user=0.63 sys=0.01, real=7.86 secs] 
16947.087: [GC 16947.087: [ParNew: 153342K->17022K(153344K), 7.2604030 secs] 6258830K->6198642K(9420160K) icms_dc=7 , 7.2609780 secs] [Times: user=0.44 sys=0.00, real=7.27 secs] 
16954.614: [GC 16954.614: [ParNew: 153342K->17024K(153344K), 8.4307620 secs] 6334962K->6274625K(9420160K) icms_dc=7 , 8.4313150 secs] [Times: user=0.62 sys=0.01, real=8.43 secs] 
16963.310: [GC 16963.310: [ParNew: 153344K->17023K(153344K), 6.2588760 secs] 6410945K->6350748K(9420160K) icms_dc=7 , 6.2594290 secs] [Times: user=0.48 sys=0.01, real=6.25 secs] 
16969.834: [GC 16969.834: [ParNew: 153343K->17022K(153344K), 6.0274280 secs] 6487068K->6425868K(9420160K) icms_dc=7 , 6.0279830 secs] [Times: user=0.50 sys=0.01, real=6.03 secs] 
16976.122: [GC 16976.123: [ParNew: 153342K->17022K(153344K), 11.7774620 secs] 6562188K->6503030K(9420160K) icms_dc=7 , 11.7780180 secs] [Times: user=0.43 sys=0.04, real=11.78 secs] 
16988.164: [GC 16988.164: [ParNew: 153342K->17024K(153344K), 10.9477920 secs] 6639350K->6579928K(9420160K) icms_dc=7 , 10.9483440 secs] [Times: user=0.37 sys=0.02, real=10.95 secs] 
16999.371: [GC 16999.372: [ParNew: 153344K->17023K(153344K), 9.8828360 secs] 6716248K->6655886K(9420160K) icms_dc=7 , 9.8833940 secs] [Times: user=0.42 sys=0.01, real=9.88 secs] 
17009.509: [GC 17009.509: [ParNew: 153343K->17023K(153344K), 5.0699960 secs] 6792206K->6727987K(9420160K) icms_dc=7 , 5.0705660 secs] [Times: user=0.55 sys=0.01, real=5.07 secs] 
17014.838: [GC 17014.838: [ParNew: 153343K->17023K(153344K), 6.6411750 secs] 6864307K->6790974K(9420160K) icms_dc=7 , 6.6417400 secs] [Times: user=0.37 sys=0.01, real=6.63 secs] 
17021.735: [GC 17021.735: [ParNew: 153343K->17024K(153344K), 8.0545970 secs] 6927294K->6856409K(9420160K) icms_dc=7 , 8.0551790 secs] [Times: user=0.34 sys=0.03, real=8.05 secs] 
17030.052: [GC 17030.053: [ParNew: 153344K->17023K(153344K), 7.9756730 secs] 6992729K->6922569K(9420160K) icms_dc=7 , 7.9762530 secs] [Times: user=0.34 sys=0.01, real=7.98 secs] 
17038.398: [GC 17038.398: [ParNew: 153343K->17022K(153344K), 12.9613300 secs] 7058889K->6990725K(9420160K) icms_dc=7 , 12.9618850 secs] [Times: user=0.39 sys=0.01, real=12.96 secs] 
17051.630: [GC 17051.630: [ParNew: 153342K->17022K(153344K), 6.8942910 secs] 7127045K->7059607K(9420160K) icms_dc=7 , 6.8948380 secs] [Times: user=0.56 sys=0.02, real=6.89 secs] 
17058.798: [GC 17058.798: [ParNew: 153342K->17024K(153344K), 10.0262190 secs] 7195927K->7126351K(9420160K) icms_dc=7 , 10.0267860 secs] [Times: user=0.37 sys=0.01, real=10.02 secs] 
17069.096: [GC 17069.096: [ParNew: 153344K->17023K(153344K), 10.0419500 secs] 7262671K->7195002K(9420160K) icms_dc=7 , 10.0425020 secs] [Times: user=0.40 sys=0.02, real=10.04 secs] 
17079.410: [GC 17079.410: [ParNew: 153343K->17022K(153344K), 13.5389040 secs] 7331322K->7264275K(9420160K) icms_dc=7 , 13.5394610 secs] [Times: user=0.30 sys=0.01, real=13.54 secs] 
17093.223: [GC 17093.224: [ParNew: 153342K->17023K(153344K), 10.5909450 secs] 7400595K->7330446K(9420160K) icms_dc=7 , 10.5915060 secs] [Times: user=0.33 sys=0.00, real=10.58 secs] 
17104.083: [GC 17104.084: [ParNew: 153343K->17024K(153344K), 5.8420210 secs] 7466766K->7392173K(9420160K) icms_dc=7 , 5.8425920 secs] [Times: user=0.57 sys=0.00, real=5.84 secs] 
```

我花了好几个小时浏览各种描述 Java GC 调优的网页，但没有一个真正让我能够解释上面的日志并提出行动方案。基于我提供的日志的任何具体建议将不胜感激。

**更新：**根据以下问题：

这台机器有 16G 的 RAM，下面是顶部的信息：Mem：总共 15483904k，已使用 15280084k，203820k 可用，155684k 缓冲区交换：2031608k 总共，1347240k 已用，684368k 可用，3304044k 缓存

它是一个不同的运行，但这是该过程的当前最高输出：

```
 PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
  1016 sanity   17   0 10.2g 6.5g 9464 S    1 44.2  10:24.32 java 
```

**更新 2：**一些更详细的日志记录，这看起来导致了 400 毫秒的延迟：

```
{Heap before GC invocations=1331 (full 1):
 par new generation   total 153344K, used 153343K [0x00002aaaae200000, 0x00002aaab8860000, 0x00002aaab8860000)
  eden space 136320K, 100% used [0x00002aaaae200000, 0x00002aaab6720000, 0x00002aaab6720000)
  from space 17024K,  99% used [0x00002aaab77c0000, 0x00002aaab885fff0, 0x00002aaab8860000)
  to   space 17024K,   0% used [0x00002aaab6720000, 0x00002aaab6720000, 0x00002aaab77c0000)
 concurrent mark-sweep generation total 7169664K, used 4258496K [0x00002aaab8860000, 0x00002aac6e200000, 0x00002aac6e200000)
 concurrent-mark-sweep perm gen total 21248K, used 13269K [0x00002aac6e200000, 0x00002aac6f6c0000, 0x00002aac73600000)
484.738: [GC 484.738: [ParNew: 153343K->17022K(153344K), 0.3950480 secs] 4411840K->4341689K(7323008K), 0.3954820 secs] [Times: user=0.49 sys=0.07, real=0.40 secs] 
Heap after GC invocations=1332 (full 1):
 par new generation   total 153344K, used 17022K [0x00002aaaae200000, 0x00002aaab8860000, 0x00002aaab8860000)
  eden space 136320K,   0% used [0x00002aaaae200000, 0x00002aaaae200000, 0x00002aaab6720000)
  from space 17024K,  99% used [0x00002aaab6720000, 0x00002aaab77bfb68, 0x00002aaab77c0000)
  to   space 17024K,   0% used [0x00002aaab77c0000, 0x00002aaab77c0000, 0x00002aaab8860000)
 concurrent mark-sweep generation total 7169664K, used 4324666K [0x00002aaab8860000, 0x00002aac6e200000, 0x00002aac6e200000)
 concurrent-mark-sweep perm gen total 21248K, used 13269K [0x00002aac6e200000, 0x00002aac6f6c0000, 0x00002aac73600000)
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-08T00:19:01.890

原来问题在于堆被换出到磁盘，延迟是 Java 的 GC 必须等待它被换回。

（大部分）通过将 Linux 的“swappiness”参数设置为 0 来解决。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-23T15:11:58.060

从时间上看，似乎 GC 实际上并没有一直运行（参见用户时间），所以大部分时间它都在等待。

只是一个疯狂的猜测：它不会交换吗？机器有多少内存？java进程得到了多少（驻留集大小）？

编辑：为什么要等待：

看看这个（来自你的成绩单）

```
[Times: user=0.39 sys=0.01, real=12.96 secs] 
```

这意味着（我猜从 GC 开始到结束），12（几乎 13）秒过去了。在这 13 秒中，0.39 秒用于在用户模式下运行，0.01 秒用于在内核模式下运行。如果时间收集方法没有完全缺陷（即数字确实代表 GC 进程/线程的运行时间），这意味着至少要等待 12 秒。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T14:56:55.493

通常，当您需要如此大的堆时，很难正确调整 GC。

话虽如此，大部分 GC 挂起时间是由在年轻垃圾收集中幸存的对象的内存复制引起的。

您的 ConcurrentLinkedHashMap 是否一次使用所有内存持久对象进行了初始化？还是随着应用程序的继续运行，它会慢慢变大？如果是后者，可能很难减少你的 GC 挂起时间，因为有些对象总是存在的。如果是前者，你需要将你的永久代的大小调整为持久对象的大小 + 20% 左右，并确保你的年轻代足够大，以跟上在创建过程中创建的瞬态对象。你的申请。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T14:39:26.953

可能 200ms 的性能限制太严格，需要自己管理垃圾回收？您是否尝试过更大的限制？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-27T14:17:13.380

我认为您遇到了这个[UseConcMarkSweepGC 和 NewRatio 错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6872335)。由于您的新空间远不及`-Jmx=9G`. 该错误包括一种解决方法（绝对大小为 NewSize）。

另一个可能对您非常重要的标志是`CMSInitiatingOccupancyFraction`. 它在 java6 中设置为 92%，在 java5 中设置为 68%。如果旧空间变大，CMS 线程池将开始工作。如果你有 CPU 可以使用，那么拥有高于初始分数的 live-set 是没有危险的。

如果您在修复内存分页问题后包含了 GC 统计信息，那就太好了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T15:17:52.320

如果您有严格的时间要求，也许您应该查看[Java Real-Time System](http://java.sun.com/javase/technologies/realtime/index.jsp)。

> RTSJ /Java RTS 提供：
> 
> API 集、语义 Java VM 增强和 JVM 到 OS 层的修改，使 Java 开发人员能够正确推理和控制 Java 应用程序的时间行为。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T15:19:16.093

您是否通过分析器运行您的应用程序，以查看您认为在内存方面发生的事情是实际发生的事情？

当我研究这个时，我做的一件事是使用 Netbeans 分析器（尽管任何分析器都应该给你这个）是查看活动字节（内存分配），看看是否有大量分配的字节和分配的对象是我所期望的，并且来自我期望的地方。

您也可以使用分析器查看调整的效果，在没有任何调整参数的情况下运行应用程序，然后添加调整参数并再次运行它，看看内存发生了什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T15:45:11.553

如果没有实际看到，并且在某些情况下对代码进行分析，可能很难分辨。

您是否为任何对象实现了 finalize() ？这将导致巨大的 GC 惩罚。看到一个可能有 6 Gigs 堆的测试运行也会很有趣，如果你在性能上得到了不成比例的改进，这将表明 GC 正在为内存而颠簸。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-23T20:56:25.517

我认为你的注意力可能有点误导。

花一点时间在分析器中查找您最大的分配热点。如果您的代码中只有少数几个地方发生了大部分分配，请尝试使用对象池而不是总是构造新对象。

集合类和 StringBuilders 非常适合池化。当您将它们返回到池中时，调用 collection.clear() 或 stringbuilder.setLength(0) 方法，以便在下一个调用者想要从池中检索它们时可以使用它们。

调整 GC 的最佳方法是创建更少的对象。消除分配的策略有很多，池化只是其中之一（尽管是我的最爱之一）。

更新：我写这个答案已经五年了，我对汇集的看法已经发生了很大变化。当我在 2009 年写这个答案时，我可以经常使用对象池（即使是像 StringBuilder 这样的简单对象）来加速具有大量分配的紧密内部循环。这些天来，很难找到合并不会使情况变得更糟的情况。除了线程或连接之外，我几乎从不使用池。尽管如此，即使您不经常使用它，它也是一个可供您使用的好工具。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T09:44:05.127

您可以发布/链接到 ConcurrentLinkedHashMap 实现的代码吗？如果这是我发布的实现，请在项目页面上开一张票，以便我们一起调试。如果没有，了解您的实施细节将有助于确定问题可能出在哪里。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-25T04:35:40.993

9 GB JVM！以前从未见过！我想你的 10 秒。停顿是很正常的。 [看到这个](http://www.devwebsphere.com/devwebsphere/2007/02/very_large_heap.html)（也许你已经读过了……）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-11-02T07:54:29.087

对我来说，问题是完整的幸存者空间。由于 CMS 不是压缩的，垃圾被直接提升到老一代。对于这么大的堆，这可能非常昂贵。需要增加 Survivor 空间和 MaxTenuringThreshold 以尽可能避免提升。

问候，亚历克斯

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-02-23T14:40:00.370

你见过这个吗？

[http://java.sun.com/docs/hotspot/gc5.0/gc_tuning_5.html](http://java.sun.com/docs/hotspot/gc5.0/gc_tuning_5.html)

还有，看看...

[http://java.sun.com/javase/6/docs/technotes/guides/visualvm/index.html](http://java.sun.com/javase/6/docs/technotes/guides/visualvm/index.html)

# macos - 如何通过文件 ID 打开 HFS+ 文件？

> ID：577777
> 
> 赞同：2
> 
> 时间：2009-02-23T14:21:55.373
> 
> 标签：macos

给定 HFS+/HFS 卷和文件的目录节点 ID (CNID)，应该可以打开该文件，技术说明[1150](http://developer.apple.com/legacy/mac/library/#technotes/tn/tn1150.html#//apple_ref/doc/uid/DTS10002989)描述了这样做的算法，但我在任何地方都找不到相应的 API 调用。

据我所知，整个 API 需要文件名或其父目录节点 ID。

是什么赋予了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T15:32:55.577

你见过沃尔夫吗？

旧文档：[技术问答 QA1113：“/.vol”目录和“volfs”](http://developer.apple.com/legacy/mac/library/#qa/qa2001/qa1113.html#//apple_ref/doc/uid/DTS10001661)

# python - Python Socket 帮助（语法错误）

> ID：577779
> 
> 赞同：0
> 
> 时间：2009-02-23T14:22:21.190
> 
> 标签：python

```
import socket

HOST = "swemach.se"
PORT = 21
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT)
data = s.recv(1024)
s.close()
print "%s" % data 
```

给我错误

```
File "main.txt", line 7
data = s.recv(1024)
  ^
SyntaxError: invaild syntax 
```

我怎么了？任何提示/解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T14:24:33.057

你忘了括号。

```
s.connect((HOST, PORT)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T14:24:58.393

```
(( HOST, PORT) 
```

^ 你去

# c++ - send()，返回 Winsock 错误 10038

> ID：577780
> 
> 赞同：0
> 
> 时间：2009-02-23T14:23:42.170
> 
> 标签：c++, windows, visual-studio-2008, multithreading, winsock

**问题：**

*   调用**send()** ，针对套接字句柄返回 Winsock 错误**10038**

**插图：**

```
acceptedSocket = accept (server, (sockaddr *)&sin, &len); 
```

*   **接受（）**，返回**0**
    *   为每个连接创建一个新**线程**
    *   **send()**，（在线程函数中）返回**10038**

**说明：** - 在线程函数中

```
//omitted
SOCKET RemoteSocket = (SOCKET) client;
//omitted
send (RemoteSocket, stringToSpend, strlen(stringToSpend), 0) 
```

**建议：**

*   可能，比赛条件？
*   可以使用 I/O 完成端口，但现阶段不能

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T14:43:27.070

accept() 为您返回一个新的特定于连接的套接字的句柄。对于服务器代码，它涉及 2 个以上的套接字：一个处于侦听状态，您正在调用 accept()，第二个是从 accept() 返回的一个 - 它是一个传入连接套接字。跟随 accept() 可以为第二个传入连接返回套接字等。如果 accept() 返回 0 它不是传入连接 - 这是一个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T14:52:19.777

问题不在于行吗

```
acceptedSocket = accept (server, (sockaddr *)&sin, &len) == INVALID_SOCKET) 
```

你做出`acceptedSocket`比较的结果，但你应该以某种方式存储从接受返回的实际套接字：

```
acceptedSocket = accept (server, (sockaddr *)&sin, &len);
isOK= acceptedSocket!=INVALID_SOCKET; 
```

虽然我对你帖子中不平衡的括号有点困惑，所以我可能是错的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T14:50:48.300

嗯，似乎你`send`在发生之前执行得太快`accept`了。因此，在 send 执行时，send 中使用的套接字无效。多线程令人讨厌的特性之一。您需要在线程处等待事件并在`send`发生接受时触发事件

# c# - 存储配置信息的位置

> ID：577782
> 
> 赞同：7
> 
> 时间：2009-02-23T14:24:13.357
> 
> 标签：c#, .net, configuration

我有一个控制台应用程序，我正在从 C 重建到 C#。此应用程序必须能够支持存储信息的传统方法，例如来自命令行的参数和来自文件的参数（称为系统参数），用于自定义每次运行。系统参数文件是纯文本格式，具有简单的键值结构。

## 我的问题是：

*   我应该将这些不同的参数组合成一个配置对象吗？
*   我如何从代码中调用这个配置对象来存储参数？
*   如何从代码中调用此配置对象来检索参数？
    *   这个对象应该是强类型的吗？
*   我需要从代码中很多不同的地方访问这个结构。在不到处传递对象本身的情况下检索对象中的值的最优雅的方法是什么？

我有一种感觉，它应该是一个单一的、强类型的对象，并且它应该是一个实例化的对象，该对象是从具有静态检索方法的存储库中检索出来的，但是我真的想要验证这个方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-28T10:27:19.373

我会使用一个配置对象，如下所示：

```
using System;
using System.IO;
using System.Reflection;
public sealed class Setting {
  public static int FrameMax { get; set; }
  public static string VideoDir { get; set; }
  static readonly string SETTINGS = "Settings.ini";
  static readonly Setting instance = new Setting();
  Setting() {}
  static Setting() {
    string property = "";
    string[] settings = File.ReadAllLines(SETTINGS);
    foreach (string s in settings)
      try {
        string[] split = s.Split(new char[] { ':' }, 2);
        if (split.Length != 2)
          continue;
        property = split[0].Trim();
        string value = split[1].Trim();
        PropertyInfo propInfo = instance.GetType().GetProperty(property);
        switch (propInfo.PropertyType.Name) {
          case "Int32":
            propInfo.SetValue(null, Convert.ToInt32(value), null);
            break;
          case "String":
            propInfo.SetValue(null, value, null);
            break;
        }
      } catch {
        throw new Exception("Invalid setting '" + property + "'");
      }
  }
} 
```

由于这是一个[单例](http://www.yoda.arachsys.com/csharp/singleton.html)，它会在第一次从对象`public static`中引用属性时创建一个且只有一个实例。`Setting`

创建对象时，它会从`Settings.ini`文件中读取。设置文件是一个纯文本文件，其`key : value`结构简单，可能如下所示：

```
FrameMax : 12
VideoDir : C:\Videos\Best 
```

该对象使用反射来发现每个属性并存储其初始值。在此示例中，定义了两个属性：

```
 public static int FrameMax { get; set; }
    public static string VideoDir { get; set; } 
```

代码作为编写的句柄`Int32`和`String`类型。`case`通过向语句添加额外的`switch`语句，您可以轻松地添加对 和 等类型的`Float`支持`Decimal`。

要更改设置，您可以使用以下内容：

```
Setting.FrameMax = 5; 
```

要检索设置，您可以使用以下内容：

```
if (Setting.FrameMax > 10) ... 
```

您会注意到所有属性都是强类型的。此外，您不必传递`Setting`对象，因为所有`Setting`属性在`static`任何地方都可用且始终可用。

我希望这个想法是有帮助的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-23T14:30:34.213

我喜欢使用[`Settings`](http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.aspx). 这些可以通过使用“*添加新文件”*对话框创建设置文件或通过从项目属性添加默认设置文件来自动生成。

每个设置都可能在用户或应用程序范围内，它控制用户是否可以更改它们或将它们限制为默认值。它们很容易使用该`Save()`方法保存并自动加载到静态`Default`属性中。

> 此类似乎适用于应用程序或基于用户的设置。我正在寻找每次运行的设置。在这种情况下，你还会推荐使用这个类吗？– x97mdr

是的。如果您同时拥有基于用户/应用程序的设置和每次运行设置，您应该使用两个不同的类 - 正常（已保存）设置和每次运行设置。

只要您不保存每次运行的设置，您就应该是安全的，并且设置仍然很容易使用。这些是静态设置。如果同一个应用程序运行需要多个实例 - 这是错误的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:53:08.790

我发现每当我必须处理旧系统时，坚持旧格式几乎总是效果最好。很多时候，其他人使用旧格式执行其他任务（例如应用程序的自动化），因此如果您重新编码应用程序处理输入的方式，您可能会破坏其他系统。

另一方面，如果您非常确信自己认识所有使用该系统的人，并且他们告诉您他们不在乎您是否更改这些类型的内容，那么我可能会将所有内容都迁移到 XML。除了从应用程序的角度来看 XML 的所有不错的特性（比如以 ASCII 格式，因此很容易被人类修改、自我记录等......），XML 还可以节省时间，因为您没有编写自己的 I/O 或解析器。已经有各种各样的库，特别是在 .NET 3.0/3.5 中，它们都做得很好。（当您转向 C# 时，我猜您已经在考虑这些方面了 :)

因此，最终，您必须根据实施成本做出决定：如果您通过迁移到 XML 或类似方式来降低*实施*成本，请确保您不会提高*其他人*迁移到新的实施成本应用框架。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T15:00:29.617

[XmlDocument - 您可以使用XSD.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)生成类定义

# c - CRC计算

> ID：577787
> 
> 赞同：4
> 
> 时间：2009-02-23T14:24:51.357
> 
> 标签：c, checksum, crc

我正在尝试与第 3 方系统交互，他们提供了一个代码示例来在发送文本数据时计算 CRC 值。

供应商提供的 C 代码如下所示：

```
#define CRCRES 0xf0b8  /* residue for good verify */ 
#define DEBUG 

unsigned crctbl[] = {0x0000, 0x1081, 0x2102, 0x3183, 
                     0x4204, 0x5285, 0x6306, 0x7387, 
                     0x8408, 0x9489, 0xa50a, 0xb58b, 
                     0xc60c, 0xd68d, 0xe70e, 0xf78f}; 

/* 
 * This uses a 32 byte table to lookup the crc 4 bits at a time. 
 * The CRC CCITT is used. 
 */ 

unsigned short calc_crc(unsigned char *ptr, unsigned length) 

{ 
  unsigned short crc; 
  unsigned short i; 
  unsigned char pos,ch; 

  crc = 0xffff;  /* precondition crc */ 
  for (i = 0; i < length; i++,ptr++) { 
    ch = *ptr; 
    pos = (crc ^ ch) & 15; 
    crc = ((crc >> 4) & 0x0fff) ^ crctbl[pos]; 
    ch >>= 4; 
    pos = (crc^ch) & 15; 
    crc = ((crc >> 4) & 0xffff) ^ crctbl[pos]; 
  } 
  crc = ~crc;  /* post condition */ 
  crc = (crc << 8) | (crc >> 8); /* bytewise reverse */ 
  return crc; 
} 

/* 
 * tests the block of code containing the crc to verify it's 
 * content.  This compares to the reversed and inverted 
 * residue. 
 */ 

int test_crc(unsigned char *ptr, unsigned length) 

{ 
  unsigned short crc; 
  unsigned char arr [] = {'X','Y','Z'}; 

  crc = calc_crc(arr,3); 
  printf("Calced crc of test to be %04x, (should be 470f)\n", crc); 
  return (crc == 0x470f); 
} 
```

我已经复制了这段代码并放入了一个示例 C 程序。test_crc 方法没有计算 CRC 为 470f（它计算为 DD7A）。

我希望有人可以验证此代码是否像供应商所说的那样不起作用，或者帮助我让 test_crc 返回正确的值。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T23:11:36.347

问题解决了。供应商的规格不正确。XYZ 的正确校验和是 DD7A。文档不正确。

再加上这样一个事实，即在他们解释要传递给 calc_crc 方法以获取实际消息的 crc 的数据之前的页面上也是不正确的，这使它成为一个棘手的项目。

谢谢您的帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T15:09:20.627

就其结果而言，计算并没有显示出我想到的任何错误。只需再次查看算法。特别是在寻找可能的问题时，请注意在算法的不同部分进行与运算的常数是`0x0fff`和`0xffff`。也许应该是`0x0fff`并且`0xfff0`更加对称......有时我们认为真正的问题可能来自另一个地方，而忘记仔细检查明显的事情...... :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T14:30:51.217

硬件平台是否相同？可能是你有不同的[字节顺序](http://en.wikipedia.org/wiki/Endianness)吗？（例如，您有 x86，他们有 68000 cpu。）

# php - 将数组传递给 PHP 中的 SOAP 函数

> ID：577795
> 
> 赞同：11
> 
> 时间：2009-02-23T14:26:17.173
> 
> 标签：php, soap, wsdl

问候，

我似乎找不到一种方法来创建以数组为参数的函数请求。例如，我如何使用 PHP SoapClient 发出这种请求：

```
<GetResultList>
  <GetResultListRequest>
    <Filters>
      <Filter>
        <Name>string</Name>
        <Value>string</Value>
      </Filter>
      <Filter>
        <Name>string</Name>
        <Value>string</Value>
      </Filter>
    </Filters>
  </GetResultListRequest>
</GetResultList> 
```

是否可以在不创建任何额外类的情况下调用此函数（仅使用数组）？如果不是，那么最紧凑的调用方式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T00:03:33.197

您可以使用此**-v**函数将数组转换为对象树：

```
function array_to_objecttree($array) {
  if (is_numeric(key($array))) { // Because Filters->Filter should be an array
    foreach ($array as $key => $value) {
      $array[$key] = array_to_objecttree($value);
    }
    return $array;
  }
  $Object = new stdClass;
  foreach ($array as $key => $value) {
    if (is_array($value)) {
      $Object->$key = array_to_objecttree($value);
    }  else {
      $Object->$key = $value;
    }
  }
  return $Object;
} 
```

像这样：

```
$data = array(
  'GetResultListRequest' => array(
    'Filters' => array(
      'Filter' => array(
        array('Name' => 'string', 'Value' => 'string'), // Has a numeric key
        array('Name' => 'string', 'Value' => 'string'),
      )
    )
  )
);
$Request = array_to_objecttree($data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-03T18:31:17.013

我有类似的问题，我不得不以这种结构发布数据。 **接受的答案对我不起作用**

```
$data = array(
  'GetResultListRequest' => array(
    'Filters' => array(
        array('Name' => 'string', 'Value' => 'string'),
        array('Name' => 'string', 'Value' => 'string'),
    )
  )
); 
```

如果接受的 answear 对您不起作用，也许它可能会对某人有所帮助

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-16T05:59:36.303

例如，你可以试试这个：

```
$data1 = new SampleStruct();  
$data1->title="Hello world";  
$data1->description="This is a sample description.";

$data2 = new SampleStruct();
$data2->title="Hello world 2";
$data2->description="This is a sample description 2.";

$client->__soapCall("sampleFunction", array(
   new SoapParam(new SoapVar(array($data1, $data2) , SOAP_ENC_ARRAY, 
       "SampleStruct_Array", "http://www.w3.org/2001/XMLSchema"), 
       "theSampleFunctionParamName")
)); 
```

# sql-server - 为什么在 SQL Server 上查询慢但过程快？

> ID：577796
> 
> 赞同：4
> 
> 时间：2009-02-23T14:27:16.420
> 
> 标签：sql-server, sql-server-2005

为什么如果我将查询作为参数化过程运行，它的运行速度会比我直接作为参数化查询运行快 10 倍？

在这两种情况下，我都使用完全相同的查询，无论我是从 Management Studio 调用还是从代码调用 SqlCommand 都没关系。

编辑：执行计划看起来不同。所以为什么？我用完全相同的一组参数来调用它。

编辑：经过更多测试后，似乎只有在从 SQL Management Studio 运行参数化查询时才会出现 10 倍的减速。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-23T14:32:41.853

我最近看到的一件事是，如果查询参数设置错误，可能会导致严重问题。

例如，假设您有一个索引 varchar 列的参数，并使用 SqlCommand 的`AddWithValue()`方法从 .Net 设置它。在这种情况下，您将陷入痛苦的世界。.Net 使用 unicode 字符串并将您的参数设置为 nvarchar 而不是 varchar。现在 sql server 将无法使用您的索引，并且您会看到显着的性能损失。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T14:30:01.250

找出它们是否使用相同的执行计划是在运行时显示它。在管理工作室中使用“包含实际执行计划”，看看有什么区别。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T14:41:20.507

在某些情况下，连接级别设置可能很关键，尤其是`ANSI NULLS`,`CONCAT NULL YIELDS NULL`等。特别是，如果您**计算**了持久索引列（包括提升的“xml”列），那么它不会信任预先计算的索引值，如果这些设置不兼容，并且将为每一行重新计算（即表扫描而不是索引查找）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T14:33:28.777

参数化查询有很多[优点](http://www.justsoftwaresolutions.co.uk/database/database-tip-use-parameterized-queries.html)，包括通常可以大幅提高性能。

*   查询缓存
*   字符串连接问题最小化
*   解决 SQL 注入
*   处理前不必将数据转换为字符串

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T15:25:38.417

参数嗅探可能会影响存储过程的性能。

[http://omnibuzz-sql.blogspot.com/2006/11/parameter-sniffing-stored-procedures.html](http://omnibuzz-sql.blogspot.com/2006/11/parameter-sniffing-stored-procedures.html)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-23T14:40:14.720

存储过程可以运行得更快，因为执行计划被 sql server 缓存。

但是 10 倍的性能是可疑的。清除存储的执行计划后，它第一次运行是否相同？您可以使用这些命令来清除缓存。但是他们清除了整个服务器的缓存，所以只在开发服务器上这样做。

```
DBCC FREEPROCCACHE
DBCC FLUSHPROCINDB (<dbid>) 
```

您是否直接在 SQL 服务器上运行这些以消除性能测试中的任何网络 I/O？

我的猜测是它第一次运行缓慢，然后一旦缓存它运行得更快。

# asp.net-mvc - 您是否有任何有关在 Amazon EC2 上设置 MVC 的教程的链接？

> ID：577818
> 
> 赞同：0
> 
> 时间：2009-02-23T14:35:15.700
> 
> 标签：asp.net-mvc, model-view-controller, amazon-ec2

请分享有关如何在 Amazon EC2 虚拟机上设置和运行 ASP.NET MVC 的教程链接。

我知道这是可能的，但我想跟随已经设置并运行它的其他人。很高兴知道已经设置了所有内容的 EC2 捆绑包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T18:45:55.770

[我制作了一个截屏视频](http://john-sheehan.com/blog/screencast-setting-up-windows-on-amazon-ec2/)，向您展示如何启动和运行 Windows，但它没有为 MVC 配置 IIS。但是，一旦实例启动并运行，配置 IIS 与任何其他 Windows Server 2K3 框相同。

# com - 如何在 COM RGS 文件中指定二进制数据

> ID：577822
> 
> 赞同：1
> 
> 时间：2009-02-23T14:36:12.827
> 
> 标签：com, registration, registry, rgs

我通过将 COM 对象添加到 rgs 文件，在注册 COM 对象期间将一些自定义数据数据添加到注册表。

添加一个 DWORD 值（由下面的 = d '3' 指定）会按预期输入到注册表中。

但是，对于二进制/十六进制数据，它没有正确输入到注册表中。谁能建议在 rgs 文件中输入二进制数据的正确语法是什么？

```
HKLM
{
   NoRemove SOFTWARE
   {
      NoRemove MyCompany
      {
         NoRemove Settings
         {
            val 'MyTestDword' = d '3'
            val 'MyTestBinaryData' = b '00 01 04'
         }
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T14:46:59.790

正确的语法是不要在十六进制值之间使用空格

```
val 'MyTestBinaryData' = b '000104' 
```

# python - PyQt：没有这样的插槽

> ID：577824
> 
> 赞同：1
> 
> 时间：2009-02-23T14:37:06.040
> 
> 标签：python, ruby, qt4, pyqt

我开始学习 Qt4 和 Python，遵循我在互联网上找到的一些教程。我有以下两个文件：

lcdrange.py：

```
from PyQt4 import QtGui, QtCore

class LCDRange(QtGui.QWidget):                        
    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)

        lcd = QtGui.QLCDNumber(2)

        self.slider = QtGui.QSlider()
        self.slider.setRange(0,99)
        self.slider.setValue(0)

        self.connect(self.slider, QtCore.SIGNAL('valueChanged(int)'),
                     lcd, QtCore.SLOT('display(int)'))
        self.connect(self.slider, QtCore.SIGNAL('valueChanged(int)'),
                     self, QtCore.SIGNAL('valueChanged(int)'))

        layout = QtGui.QVBoxLayout()
        layout.addWidget(lcd)
        layout.addWidget(self.slider)
        self.setLayout(layout)

    def value(self):
        self.slider.value()

    def setValue(self,value):
        self.slider.setValue(value) 
```

主要.py：

```
import sys
from PyQt4 import QtGui, QtCore

from lcdrange import LCDRange

class MyWidget(QtGui.QWidget):
    def __init__(self, parent=None):
        QtGui.QWidget.__init__(self, parent)

        quit = QtGui.QPushButton('Quit')
        quit.setFont(QtGui.QFont('Times', 18, QtGui.QFont.Bold))
        self.connect(quit, QtCore.SIGNAL('clicked()'), QtGui.qApp, QtCore.SLOT('quit()'))

        grid = QtGui.QGridLayout()
        previousRange = None

        for row in range(0,3):
            for column in range(0,3):
                lcdRange = LCDRange()

                grid.addWidget(lcdRange, row, column)
                if not previousRange == None:
                    self.connect(lcdRange, QtCore.SIGNAL('valueChanged(int)'),
                                 previousRange, QtCore.SLOT('setValue(int)'))
                previousRange = lcdRange

        layout = QtGui.QVBoxLayout()
        layout.addWidget(quit)
        layout.addLayout(grid)
        self.setLayout(layout)

app = QtGui.QApplication(sys.argv)

widget = MyWidget()
widget.show()

sys.exit(app.exec_()) 
```

当我运行它时，我收到以下错误：

```
Object::connect: No such slot LCDRange::setValue(int)
Object::connect: No such slot LCDRange::setValue(int)
Object::connect: No such slot LCDRange::setValue(int)
Object::connect: No such slot LCDRange::setValue(int)
Object::connect: No such slot LCDRange::setValue(int)
Object::connect: No such slot LCDRange::setValue(int)
Object::connect: No such slot LCDRange::setValue(int)
Object::connect: No such slot LCDRange::setValue(int) 
```

我读过 PyQt 插槽只不过是我定义的方法，那么我做错了什么？

我也在用 Ruby 学习 Qt4，这是这段代码的来源，我将它从 Ruby 翻译成 Python。在 Ruby 版本中，LCDRange 类定义如下：

```
class LCDRange < Qt::Widget
  signals 'valueChanged(int)'
  slots 'setValue(int)'

  def initialize(parent = nil)
  ... 
```

所以我的猜测是我必须以某种方式声明自定义插槽的存在？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T14:57:53.040

试试这个：

```
self.connect(lcdRange, QtCore.SIGNAL('valueChanged'), previousRange.setValue) 
```

# 有什么不同？

[PyQt 文档](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/pyqt4ref.html#signal-and-slot-support)有一个关于 PyQt 中信号/插槽的部分，它们的工作方式略有不同。

## 信号

`SIGNAL('valueChanged')`是一种叫做[短路信号](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/pyqt4ref.html#short-circuit-signals)的东西。它们仅适用于 Python 到 Python 方法，但它们更快更容易实现。

## 投币口

如果你有一个 python 插槽，你可以通过提示方法来指定它：`previousRange.setValue`. 这适用于 Python 可访问的所有方法。

如果您的插槽应该像 C++ Qt 插槽一样可访问，正如您在代码中尝试的那样，您必须使用特殊语法。您可以在 PyQt 网站上找到有关[pyqtSignature 装饰器的信息。](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/new_style_signals_slots.html#the-pyqtslot-decorator)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-17T18:55:25.060

你忘了放

```
 @Qt.pyqtSlot() 
```

上述方法您用作插槽。

例如，您的代码应如下所示

```
 @Qt.pyqtSlot('const QPoint&')
def setValue(self,value):
        self.slider.setValue(value) 
```

这是一个关于 pyqt 插槽装饰器的好页面：

[点击 ：-）](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/pyqt4ref.html#the-qtcore-pyqtslot-decorator)

再见

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-06T04:29:47.917

笔记

SIGNAL 中的“文本”必须与 c++ API 文档相匹配。

```
# This will work - its IDENTICAL to the documentation 
QtCore.SIGNAL('customContextMenuRequested(const QPoint&)')

# this wont
QtCore.SIGNAL('customContextMenuRequested(QPoint&)')

# and this wont
QtCore.SIGNAL('customContextMenuRequested(const QPoint)')

# Spot the bug 
QtCore.SIGNAL('selectionChanged(const QItemSelection,const QItemSelection&)')
                                                    ^ < missing & 
```

# c# - 常量与受保护的静态只读

> ID：577839
> 
> 赞同：2
> 
> 时间：2009-02-23T14:41:40.583
> 
> 标签：c#, .net

我有一个包装类，它封装了一条需要作为字节数组传输的信息。

这样，该类将必要的标头（带有 DATA_LENGTH 或 MESSAGE_TYPE 等字段）封装到相应的字节位置。为此，我想在常量中定义位置和长度，例如：

```
HEADER_DATA_LENGTH_IX = 0;
HEADER_DATA_LENGTH_LENGTH = 2; 
```

这意味着 DATA_LENGTH 从 0 开始，占用两个字节。

但到目前为止，我正在努力使它们成为常量或静态只读字段。Const 不能受到保护，因此如果使用它们，我将无法派生新类并更改常量，另一方面我可能会在派生类中声明新常量并使用它们。

你的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T14:49:45.977

如果要在派生类中更改这些参数的值，可以将它们[设为只读](http://msdn.microsoft.com/en-us/library/acdd6hb7.aspx)并在派生类的构造函数中更改它们

无论如何，我不会让它们成为[const](http://msdn.microsoft.com/en-us/library/e6w8fe1b.aspx)，因为它们不是......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T14:51:32.277

基本区别在于变量的初始化时间。'readonly' 在初始化时或在构造函数中设置，而 'const' 在编译时设置。

我认为最大的决定是您是否要继承该类并覆盖该值。如果你这样做，去只读。否则我认为这并不重要。

只读 C#ref：http: [//msdn.microsoft.com/en-us/library/acdd6hb7.aspx](http://msdn.microsoft.com/en-us/library/acdd6hb7.aspx)

常量 C# 参考：http: [//msdn.microsoft.com/en-us/library/e6w8fe1b.aspx](http://msdn.microsoft.com/en-us/library/e6w8fe1b.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:06:35.360

使用常量创建一个内部类。派生类随后可以覆盖内部类并根据需要更改常量。

例如基类：

```
public class Stuff
{
  public class HeaderInformation
  {
    public const int HEADER_DATA_LENGTH_IX = 0;
    public const int  HEADER_DATA_LENGTH_LENGTH = 2;
  }
} 
```

然后派生类可以这样做：

```
public class DerivedStuff : Stuff
{
  public new class HeaderInformation : Stuff.HeaderInformation
  {
    public new const int HEADER_DATA_LENGTH_IX = 10;
  }
} 
```

这样，您就有了灵活性。在`DerivedStuff`中，HeaderInformation 类具有基`Stuff.HeaderInformation`类中的所有常量，但可以更改它们中的任何一个，或保留它拥有的常量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T16:58:12.933

这个确切的问题由[msdn 上的官方 c# faq回答](http://blogs.msdn.com/csharpfaq/archive/2004/12/03/274791.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T14:46:32.553

我不会使这些常量，因为它们根本不是常量。将某事声明为 const 时，您应该问自己：这可以改变吗？您的消息长度可能有一天会改变，因此最好将它们设置为只读。

# java - 在 Java 中从 Codepage 1252 (Windows) 转换为 Java

> ID：577846
> 
> 赞同：3
> 
> 时间：2009-02-23T14:45:23.320
> 
> 标签：java, windows, unicode, codepages

我认为在 Windows 1252 代码页中有一些 Java 字符串（最初来自 Excel 表）。我希望它们转换为 Java 自己的 unicode 格式。Excel 文件是使用 JXL 包解析的，以防万一。

我要澄清一下：显然，从 Excel 文件中获取的字符串看起来很像它已经是某种 unicode。

```
WorkbookSettings ws = new WorkbookSettings();
ws.setCharacterSet(someInteger);
Workbook workbook = Workbook.getWorkbook(new File(filename), ws);
Sheet s = workbook.getSheet(sheet); 
row = s.getRow(4);
String contents = row[0].getContents(); 
```

这是内容似乎包含 unicode 的地方，åäö 是多字节字符，而 ASCII 是普通的单字节字符。它绝对不是Latin1。如果我用 printLn 打印“内容”字符串并将其重定向到 hello.txt 文件，我发现字母“ö”用两个字节表示，十六进制的 C3 B6。（十进制的 195 和 179。）

[编辑]

我已经尝试了下面给出的不同代码页等的建议，尝试从 Cp1252 等转换。有某种转换，因为我会得到一些其他类型的乱码。作为参考，我总是在源代码中打印一个手工编码的“ö”字符串，以验证我的终端或字体或任何东西没有问题。手动输入的“ö”始终有效。

[编辑]

我还按照评论中的建议尝试了 WorkBookSettings，但是我查看了 JXL 的代码，并且 characterSet 似乎被解析代码忽略了。我认为解析代码只是查看 XLS 文件应该使用的任何编码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T15:02:09.823

WorkbookSettings ws = new WorkbookSettings();

ws.setEncoding("CP1250");

为我工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-23T15:09:35.203

如果上面的答案都不能解决问题，那么技巧可能是这样的：

```
String myOutput = new String (myInput, "UTF-8"); 
```

这应该**解码**传入的字符串，无论其格式如何。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:04:33.633

当 Java 解析文件时，它使用某种编码来读取磁盘上的字节并在内存中创建字节。默认编码因平台而异。Java 的内部字符串表示已经是 Unicode，所以如果它使用正确的编码解析文件，那么你已经完成了；只需以您想要的任何编码写出数据。

如果您在 Java 中查看字符串时出现损坏，可能是因为您使用了错误的编码来读取数据。Excel 可能正在使用 UTF-16（我认为是小尾数），但我希望像 JXL 这样的库应该能够适当地检测到它。我查看了 JXL 的 Javadocs，它对字符编码没有任何作用。我想它会根据需要自动检测任何编码。

您只需要将已加载的字符串写入文本文件吗？如果是这样，那么类似以下内容将起作用：

```
String text = getCP1252Text(); // doesn't matter what the original encoding was, Java always uses Unicode
FileOutputStream fos = new FileOutputStream("test.txt"); // Open file
OutputStreamWriter osw = new OutputStreamWriter(fos, "UTF-16"); // Specify character encoding
PrintWriter pw = new PrintWriter(osw);

pw.print(text ); // repeat as needed

pw.close(); // cleanup
osw.close();
fos.close(); 
```

如果您的问题是其他问题，请编辑您的问题并提供更多详细信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T10:58:24.123

您需要在解析文件时指定正确的编码 - 一旦您有一个基于错误编码的 Java 字符串，就为时已晚。

JXL 允许您通过将[`WorkbookSettings`](http://jexcelapi.sourceforge.net/resources/javadocs/current/docs/jxl/WorkbookSettings.html)对象传递给工厂方法来指定编码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T14:55:35.933

JRE 不需要支持“windows-1252”/“Cp1252”，但 Sun （可能还有其他大多数）支持。请参阅 JDK 文档中的[“支持的编码”](http://java.sun.com/javase/6/docs/technotes/guides/intl/encoding.doc.html)。然后只需使用`String`,`InputStreamReader`或类似的方法将字节解码为字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T15:14:17.337

```
FileInputStream fis = new FileInputStream (yourFile);
BufferedReader reader = new BufferedReader(new InputStreamReader(fis,"CP1250")); 
```

和 reader 一起做任何你直接对文件做的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-07T16:14:29.347

您的描述表明编码是 UTF-8，实际上 C3 B6 是 'ö' 的 UTF-8 编码。

# c# - 用于手绘的 IDE 模块？

> ID：577853
> 
> 赞同：0
> 
> 时间：2009-02-23T14:47:02.753
> 
> 标签：c#, c++, qt, mono

我目前正在寻找**允许**我添加绘图模块到 IDE 应用程序。

该应用程序处于早期设计阶段：例如，我只是在估计我是否能够在业余时间处理它。我正在考虑使用**C#/Mono**或**C++/QT**作为 IDE 框架，但还没有决定。该应用程序将是开源的。

**一个单独的模块来处理绘图部分**将是一件好事 - 允许我专注于应用程序的另一个重要特性，而不是自己实现它。该模块将由用户实例化以创建或编辑图像（无需 Photoshop 功能）。然后该图像将由应用程序（使用其他数据）处理。

我在 Google、Sourceforge 和 code.google.com 上搜索了几个小时，但在 C# 或 C++/QT 中找不到类似的东西——只能通过代码库绘制。也许我搜索不正确......无论如何，欢迎任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T15:23:28.517

我认为您需要创建一个绘图模块。

我已经使用 Qt >4.3 中的 QGraphicsView 完成了一些绘图实用程序，这很容易。我会考虑的。

祝你好运！:D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T14:56:00.877

好吧，您是否正在寻找可以插入应用程序的控件库或活动 x 控件之类的东西？

我不确定您是否愿意接受商业软件，但这里很少

[http://drawing-activex.qarchive.org/](http://drawing-activex.qarchive.org/)

老实说，我没有搜索太多。但是你需要搜索一个activex或者一个控件库

# sql-server - 为什么这个 sproc 引用会找到要更新的正确表？

> ID：577854
> 
> 赞同：1
> 
> 时间：2009-02-23T14:48:05.700
> 
> 标签：sql-server, sql-server-2008

如果我有这样的表：

```
ImportSet1.Users
ImportSet2.Users
ImportSet3.Users 
```

然后在我的存储过程中我这样做：

```
CREATE PROCEDURE [ImportSet2].[UpdateUsers]

...
UPDATE Users
   set blah = 234
WHERE id = 234 
```

这似乎有效，但为什么呢？从什么时候开始，前缀 [ImportSet2] 表示表名的一部分？（在本例中为 ImportSet2）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T15:11:20.713

sproc 是在 ImportSet2 模式下构建的，因此，默认情况下，如果未指定模式名称，它将引用 ImportSet2 模式中的对象。

然而，我认为最好的做法是使用它们的模式名称来完全限定对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T15:31:34.783

要回答“从什么时候开始”，当然到 2000 年您可能拥有由 dbo 以外的所有者拥有的对象。自 2005 年以来，MS 将所有者和模式的概念分开。

我*相信*该功能出现在 SQL Server 的早期版本中，无论是 6.5 还是 7.0。所以它并不是什么新鲜事（尽管在 2005 年之前*使用该功能有相当大的痛苦）*

# unix - sed 阻塞了吗？

> ID：577865
> 
> 赞同：12
> 
> 时间：2009-02-23T14:53:40.210
> 
> 标签：unix, sed, pipe, netcat

我的印象 sed 没有阻塞，因为当我说：

```
iostat | sed 
```

`sed`在数据到达时处理数据，但是当我这样做时

```
iostat | sed | netcat 
```

然后`sed`块`netcat`。

我对吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-23T15:08:13.483

`sed`当它不打印到终端时，它将在缓冲模式下工作。这意味着默认情况下它会在进行任何处理和输出之前尝试填充其内部缓冲区。

这样做是为了增加吞吐量，因为通常在管道中您不关心时间，但希望在给定时间内处理尽可能多的数据。

传递`-u`给 sed 将告诉它无缓冲地工作，因此它的工作方式与输出到终端时的工作方式相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T15:12:43.113

除了@saua 所说的，`sed`它至少是面向行的，它读取一行，然后对其进行操作，因此它将始终缓冲至少一行。此外，`sed`可以在多行模式下工作。如果您使用的是多行模式，则`sed`无法输出它的当前缓冲区，直到它知道该模式不适用或该模式已被处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T15:06:31.320

我不知道我是否正确理解了这个问题，但在你的例子中，它应该是这样的：

*   sed 等待 iostat 发送数据
*   如果 sed 速度慢，iostat 将等待 sed 处理数据
*   netcat 等待 sed 发送数据
*   sed 将再次等待 netcat，如果它很慢

除此之外，sed 不需要读取其所有输入来产生输出。

您是否观察到任何无法解释的延迟和一些小的缓冲？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-10T14:50:49.130

`stdbuf`可以帮助更改标准 io 流的缓冲行为。你可以试试这个来改变缓冲行为：

```
... | stdbuf -oL -eL sed -e ... | ... 
```

# xcode - WxWidgets / GCC / MacOs X：如何正确构建和链接 WxWidgets 库？

> ID：577866
> 
> 赞同：1
> 
> 时间：2009-02-23T14:53:45.670
> 
> 标签：xcode, macos, gcc, wxwidgets

我正在尝试将基于 WxWidgets 2.8.9 的 Windows 应用程序移植到 MacOS X。我已经到了成功编译的地步，除了一些与 WxWidgets 相关的缺失符号。我尝试使用命令行和 XCode 编译 WxWidgets，并且尝试了几种不同的配置选项，但都没有正常工作。[WxWidgets Wiki 在这里](http://wiki.wxwidgets.org/Guides_%26_Tutorials#Mac_OS)有几篇关于此的文章，但大部分信息都已过时，没有一个能解决我的问题。

我得到的最接近的是通过在命令行编译 WxWidgets

```
./configure --enable-monolithic
make 
```

然后我通过将“wxMac-2.8.9/lib/libwx_mac-2.8.a”添加到我的 XCode 项目设置中的“其他链接器标志”来链接库。

但这给了我以下链接错误：

“wxOnAssert(char const*, int, char const*, char const*, char const*)”，引用自：wxStringBase::wxStringBase(wxStringBase const&) in MyFrame.o wxCloseEvent::Veto(bool) in MyFrame.o wxStringBase ::wxStringBase(wxStringBase const&)in TGameSettingsForm.o wxCheckBoxBase::DoSet3StateValue(wxCheckBoxState) in TGameSettingsForm.o wxCheckBoxBase::DoGet3StateValue() const in TGameSettingsForm.o wxStringBase::wxStringBase(wxStringBase const&)in NonoGameStates.o wxStringBase::wxStringBase( TWxInvalidRegCodeForm.o 中的 wxStringBase const&)

"_iconv_close"，引用自： wxMBConv_iconv::~wxMBConv_iconv() in libwx_mac-2.8.a(monolib_strconv.o) wxMBConv_iconv::~wxMBConv_iconv() in libwx_mac-2.8.a(monolib_strconv.o) wxMBConv_iconv::~wxMBConv_iconv()在 libwx_mac-2.8.a(monolib_strconv.o) 中 wxMBConv_iconv::~wxMBConv_iconv() 在 libwx_mac-2.8.a(monolib_strconv.o) 中

“wxAppConsole::OnAssert(char const*, int, char const*, char const*)”，引用自：vtable for CMyWxApp3_wxstaticAppin MyWxApp3-wxstaticApp.o

"_iconv"，引用自： wxMBConv_iconv::GetMBNulLen() const in libwx_mac-2.8.a(monolib_strconv.o) wxMBConv_iconv::WC2MB(char*, wchar_t const*, unsigned long) constin libwx_mac-2.8.a(monolib_strconv.o ) wxMBConv_iconv::WC2MB(char*, wchar_t const*, unsigned long) 约束 libwx_mac-2.8.a(monolib_strconv.o) wxMBConv_iconv::MB2WC(wchar_t*, char const*, unsigned long) 约束 libwx_mac-2.8.a(monolib_strconv 。

“wxAppConsole::OnAssertFailure(char const*, int, char const*, char const*, char const*)”，引用自：vtable for CMyWxApp3_wxstaticAppin MyWxApp3-wxstaticApp.o “_iconv_open”，引用自：wxMBConv_iconv::wxMBConv_iconv(char const*)在 libwx_mac-2.8.a(monolib_strconv.o) wxMBConv_iconv::wxMBConv_iconv(char const*)在 libwx_mac-2.8.a(monolib_strconv.o) wxMBConv_iconv::wxMBConv_iconv(char const*)在 libwx_mac-2.8.a( monolib_strconv.o) wxMBConv_iconv::wxMBConv_iconv(char const*)in libwx_mac-2.8.a(monolib_strconv.o) ld: 未找到符号 collect2: ld 返回 1 个退出状态

如果可能的话，我更喜欢动态链接，而不是上面使用的静态链接。但是，目前我很乐意让它运行起来。如果有人能给我（或指向我）一个关于如何编译和链接 WxWidgets 库的工作分步描述，我将非常感激。

谢谢，

阿德里安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T15:43:34.070

我没有在 MacOS 下构建 wx，但我确实在 Windows 和 Linux 下广泛使用它。您链接的页面上的说明与 Linux 下的说明非常相似，上面写着：

> 在 make 之后，您将在您的文件夹下找到构建的库（例如 build-release）。这也是对应的 wx-config 所在的位置。

Linux 下的 wx-config 脚本使构建项目变得轻而易举，您只需使用命令`wx-config --cxxflags`获取 gcc 所需的编译标志并`wx-config --libs`获取链接所需的所有库。在诸如 Code::Blocks 之类的构建环境下，您可以在项目设置中使用这些命令，但是我对 XCode 不熟悉 - 但最坏的情况是您只需要复制 wx-config 脚本列出的编译器和链接器选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-23T17:17:06.110

`wxOnAssert`- 相关错误意味着您在调试中构建库（已`__WXDEBUG__`定义，未定义`NDEBUG`），而 wxWidgets 库是在发布构建（`__WXDEBUG__`未定义）中构建的。解决方案很简单：不要这样做。

如果您需要构建调试版本，也可以使用`--enable-debug`configure 参数在调试模式下构建 wxWidgets 并使用`wx-config --debug ...`来获取适当的标志。

# java - 如何在 SVN 中运行更新而不会引起很多冲突

> ID：577868
> 
> 赞同：0
> 
> 时间：2009-02-23T14:54:07.463
> 
> 标签：java, svn

我正在使用 SVN 在一个四人团队中开发一些软件。

每当我更新我的工作副本时，它会产生比我预期的要多得多的冲突，其中很多冲突是这样的：

如果最初是

```
 import Class1 
```

我把它改成

```
import Class1
import Class2 
```

而另一个团队成员将代码更改为

```
import Class1
import Class3 
```

Subversion 不会合并所有三行。

我想这是因为 subversion 不知道代码的语义内容，所以无法决定何时/不适合这样做。

我得到的另一个冲突是如果我更换

```
processA();
processB(); 
```

和 ：

```
if(x){
  processA();
  processB();
} 
```

整个事情都被标记为一个变化，没有办法让它突出一个事实，即只有 if(x) 被添加到上面/下面。在这种情况下，我必须分析新块内的整行，并担心会丢失内部行的小变化。

问题是，在这些情况下，我的团队是否有更有效的方式使用 SVN，我的大部分时间都花在了合并上。

对不起，我的表达太啰嗦了，谢谢阅读。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T14:57:34.930

由于 SVN 不了解编程语言，因此如果它试图从变更集中推断语义意义将是非常危险的。因此它只能做相对简单的合并（即如果一个文件在两个完全不同的区域发生了变化）。

常见的解决方案是使用小提交。不要让大的变化堆积起来。经常提交。经常更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T14:58:19.810

如果您经常签入，您仍然会看到很大的变化（例如在“if”情况下），但您不会有太多的*合并*工作要做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:02:21.017

尽量让开发人员在项目的不相交部分上工作，以减少合并问题。如果开发人员确实重叠，请鼓励沟通以避免错误合并。此外，尝试尽早/经常提交以避免大规模合并，但不允许提交会使您的基线无法构建。持续集成系统会有所帮助。

# xml - 根据节点顺序从 XML 列 (SQL Server 2005) 中选择记录

> ID：577871
> 
> 赞同：0
> 
> 时间：2009-02-23T14:55:42.843
> 
> 标签：xml, sql-server-2005, xquery

我在 SQL Server 2005 表中有一个列定义为 XML 数据类型。有没有办法根据该列中两个节点的顺序从该表中选择记录？例如，我们的 XML 中有以下结构：

```
<item>
   <latitude/>
   <longitude/>
</item> 
```

我想看看是否有任何具有相反顺序的纬度/经度的记录，即`<longitude/>`then `<latitude/>`。我尝试了一些 XPath 表达式，但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T15:43:11.513

您可以检查 item 元素的第一个子元素是否是经度，

```
SELECT COUNT(1)
FROM tblFoo
WHERE xmlCol.value('local-name((/item/*)[1])', 'varchar(max)') = 'longitude' 
```

**测试脚本**

```
DECLARE @xml as xml
SET @xml = 
'<item>
   <longitude/>
   <latitude/>      
</item>
'
IF @xml.value('local-name((/item/*)[1])', 'varchar(max)') = 'longitude'
    PRINT 'first element is longitude'

--Output: first element is longitude 
```

PS 使用 SQL 2008 中的几何列来存储坐标是个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T15:06:38.807

好吧，您可以使用关联的 xsd 来*强制执行*该命令。我去看看 我可以方便*查询*...

（更新）我不确定你能不能......适当的轴都被禁用，位置（名称）和节点/位置（）也是如此

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T15:18:05.177

我们确实有一个与该列关联的 xsd，但它没有强制执行顺序。我们想强制执行顺序，但我们想在进行此更改之前查看是否有任何列的顺序相反。

# visual-studio - 加载项如何检测加载解决方案的时间？

> ID：577877
> 
> 赞同：5
> 
> 时间：2009-02-23T14:57:03.480
> 
> 标签：visual-studio, visual-studio-2008

我的加载项如何检测加载解决方案的时间？我知道在 DTE 模型的某个地方一定有一些事件，但我找不到它。我的加载项在 Visual Studio 加载时加载，但这取决于打开的解决方案。我不想让它成为解决方案插件，直到 MS 失去对 COM 的病态固定，因为解决方案插件必须是 COM 组件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-23T15:05:40.277

以下是使用 C# 注册事件处理的方法：

```
_solutionEvents = _applicationObject.Events.SolutionEvents;
_solutionEvents.Opened += new _dispSolutionEvents_OpenedEventHandler(SolutionOpened);
_solutionEvents.AfterClosing += new _dispSolutionEvents_AfterClosingEventHandler(SolutionClosed); 
```

另请注意，当用户通过双击解决方案文件打开 Visual Studio 时，您不会收到解决方案打开的事件。您应该检查 OnStartupComplete 方法中的 _applicationObject.Solution 是否不为空，以正确处理这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T15:06:13.753

[MSDN](http://msdn.microsoft.com/en-us/library/envdte.solutioneventsclass_events.aspx)上的 SolutionEvents 类包括事件：

打开：在打开解决方案或项目后立即发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T15:22:39.237

您在 DTE2 类中有一个称为`Events`它的属性，它提供了很多类型的事件，您需要使用的内容：

```
DTE2 _applicationObject
_applicationObject.Events.SolutionEvents.Opened+=new _dispSolutionEvents_OpenedEventHandler(SolutionEvents_Opened); 
```

# c - SO_REUSEADDR 的用例是什么？

> ID：577885
> 
> 赞同：23
> 
> 时间：2009-02-23T14:58:22.307
> 
> 标签：c, sockets, tcp, udp

我曾经`SO_REUSEADDR`让我的服务器被终止重新启动而没有抱怨套接字已经在使用中。我想知道是否还有其他用途`SO_REUSEADDR`？有没有人将套接字选项用于上述目的以外的用途？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-23T15:03:03.340

对于**TCP**，主要目的是在同一地址上重新启动关闭/终止的进程。

需要该标志，因为端口进入`TIME_WAIT`状态以确保所有数据都已传输。

如果两个套接字绑定到相同的接口和端口，并且它们是同一个多播组的成员，则数据将被传递到两个套接字。

我想另一种用途是尝试拦截数据的安全攻击。

（[来源](http://www.developerweb.net/forum/showthread.php?t=2941)）

* * *

对于**UDP**，`SO_REUSEADDR`用于多播。

> 如果前面有以下内容，则可以有多个进程绑定到同一个`SOCK_DGRAM`UDP 端口：`bind()`
> 
> ```
> int one = 1;
> setsockopt(sock, SOL_SOCKET, SO_REUSEADDR, &one, sizeof(one)); 
> ```
> 
> 在这种情况下，发往共享端口的每个传入的多播或广播 UDP 数据报都被传递到绑定到该端口的所有套接字。

（[来源](http://www.kohala.com/start/mcast.api.txt)）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-23T15:04:32.417

另一个主要用途是允许多个套接字连接到`bind()`UDP 上的同一端口。您可能不认为会出现这种情况，但有时多个应用程序可能希望使用给定端口号侦听广播/多播地址。它还允许绑定到通配符地址，同时也绑定到特定地址。例如，Apache 可能绑定到 *:80 和 10.11.12.13:80

# wpf - WPF 3D 模型绘图工具

> ID：577888
> 
> 赞同：4
> 
> 时间：2009-02-23T14:58:54.397
> 
> 标签：wpf, drawing, 3d, vector-graphics

是否有任何 3D 建模应用程序可以将成品输出到一组点（X、Y、Z），然后您可以将其导入 WPF 3D 模型？

IE：

```
<MeshGeometry3D Positions="0,0,0 10,0,0 0,10,0 10,10,0 0,0,10 10,0,10 0,10,10 10,10,10"
TriangleIndices="0,2,1 1,2,3 0,4,2 2,4,6 0,1,4 1,5,4 1,7,5 1,3,7 4,5,6 7,6,5 2,6,3 3,6,7" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T15:16:21.653

一个简单的[谷歌](http://www.google.ro/search?q=WPF+exporter&ie=utf-8&oe=utf-8&aq=t&rlz=1R1GGGL_en___RO315)搜索“WPF exporter”，我发现：

[Viewer3ds - 3ds 到 xaml 转换器](http://wpf-graphic.com/Viewer3ds.aspx)

> Viewer3ds 是一个 WPF 应用程序，可以读取 3ds 文件并将其转换为 xaml。它使用在运行时导入 3ds 文件的[Ab3d.Reader3ds库。](http://wpf-graphic.com/Reader3ds.aspx)

这可能是您需要的，因为几乎所有 3D 创作应用程序都能够导出为 .3ds 格式。

编辑：

您还可以尝试[Blender](http://www.blender.org/)和[XAML Exporter for Blender](http://www.codeplex.com/xamlexporter)来创建您的 3D 资产。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-02T12:12:27.883

你可以使用 google sketchup 和我写的 exporter。

[http://itaibh.blogspot.com/2009/09/google-sketchup-xaml-exporter.html](http://itaibh.blogspot.com/2009/09/google-sketchup-xaml-exporter.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-17T16:03:47.193

Viewer3ds 是一个转换器而不是一个建模工具。如果您正在寻找免费工具，Blender 是一个非常强大的 3D 建模应用程序（尽管 UI 和工作流程的学习曲线很高），它可以在[Blender 插件](http://www.codeplex.com/xamlexporter)的帮助下导出 .xaml 文件。

如果您不太关心免费，那么您可以使用其他应用程序，例如 Maya 或 3ds Max，也可以使用插件： http: [//max2xaml.codeplex.com/](http://max2xaml.codeplex.com/)

上面提到的所有工具都能够定义法线、平滑组、材质等，以及 WPF 支持的所有内容（当然还有更多）。

# c# - “数据按摩”是什么意思？

> ID：577892
> 
> 赞同：26
> 
> 时间：2009-02-23T15:00:42.783
> 
> 标签：c#, .net, asp.net, sql, database-design

我正在阅读，如果我的应用程序在发送到 SQL 之前不需要处理数据，我会避免使用 internalStore。什么是数据按摩？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-23T15:02:31.733

操纵、处理、改变、重新计算。简而言之，如果您只是移动原始数据，则无需使用 internalStore，但如果您在存储之前对其进行任何操作，那么您可能需要一个 internalStore。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-23T15:06:16.250

有时将移动数据的整个过程称为“ETL”，意思是“提取、转换、加载”。按摩数据是“转换”步骤，但这意味着您必须进行临时修复以消除您遇到的问题（就像按摩对您的肌肉所做的那样），而不是在众所周知的格式之间进行转换。

认为您可能对“按摩”数据进行的操作包括：

*   将源系统发出的格式更改为目标系统期望的格式，例如将日期格式从 d/m/y 更改为 m/d/y。
*   用默认值替换缺失值，例如在未给出数量时提供“0”。
*   过滤掉目标系统中不需要的记录。
*   检查记录的有效性，并忽略或报告如果您尝试插入它们会导致错误的行。
*   规范化数据以删除应该相同的变化，例如用小写替换大写，用“1”替换“01”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T15:02:45.290

清理、规范化、过滤……只是以某种方式将数据从原始输入更改为更适合您使用的形式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-21T13:29:53.430

最后，当他们没有给你想要的答案时，通过丢弃数据（或调整数字）来按摩数据的做法不太有趣。不幸的是，做统计分析的人经常对数据进行处理，以摆脱那些反驳他们理论的讨厌的异常值。由于这种做法将数据清理称为按摩数据是不恰当的。清理数据以使其可以进入您的系统（摆脱无意义的日期，例如 02/30/2009，因为其他人将它们存储在 varchar 中而不是日期，将名字和姓氏分隔到单独的字段中，修复所有大写数据，在未给出提供的数据时为需要数据的字段添加默认值等）是一回事 - 按摩数据意味着不适当地调整数据的做法。

还要评论如果您不更改任何数据就拥有内部存储是不好的想法，我强烈不同意这一点（多年来我已经从数百个来源加载了数千个文件。首先，几乎没有数据不需要至少检查以进行清理。如果第一次运行没问题并不能保证一年后它不会将垃圾放入您的系统中。加载任何文件不先将其放入暂存台并对其进行清洁是不负责任的。

此外，如果我们可以很容易地看到我们在临时表中加载的文件的内容，我们会发现更容易研究数据问题。然后我们可以准确地确定哪个文件/源向我们提供了有问题的数据，这解决了许多客户认为我们加载了他们实际发送给我们加载的错误信息的问题。事实上，我们总是使用两张临时表，一张用于来自文件的原始数据，一张用于清理后但加载到生产表之前的数据。因此，如果我不得不返回并搜索原始文件，我可以在几秒钟或几分钟内解决问题，而这将需要几个小时。因为您可以保证的一件事是，如果您正在导入数据，则有时该数据的内容会受到质疑。

# delphi - 检查变体值“Nothing”

> ID：577894
> 
> 赞同：6
> 
> 时间：2009-02-23T15:02:02.920
> 
> 标签：delphi, excel, automation, ms-office

这是我去年遇到的事情，SO 似乎是一个记录它的好地方 :)

问：当从 Delphi 自动化 Excel (/Word/...) 时，我如何检查 Excel 函数是否返回变体`Nothing`（在 VBA 中调用它）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T05:05:16.513

该[`VarIsClear`](http://docwiki.embarcadero.com/Libraries/en/System.Variants.VarIsClear)函数包括您的类型`varDispatch`和值的情况`nil`。它还包括空值和“未知”值，以及自定义变体类型。我在我的 Delphi 2005 源代码中看到它；我不知道它早在多少年前就被收录了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T15:02:16.710

`Nothing`奇怪的是，VBA与, or不同，所以你不能使用，例如*：*`Unassigned``Null``Empty`

```
// Worksheet is a TExcelWorksheet or OleVariant coupled to an open worksheet
MyRange := Worksheet.Range['MyRangeInTheWorksheet', EmptyParam]
if (MyRange = Null) then  // won't work!
  MsgBox('The range doesn''t exist!'); 
```

相反，请使用此功能：

```
function VarIsNothing(V: OleVariant): Boolean;
begin
  Result :=
    (TVarData(V).VType = varDispatch)
    and
    (TVarData(V).VDispatch = nil);
end;

// ...

if (VarIsNothing(MyRange)) then 
```

* * *

**更新**

显然，RTL 单元的来源`Variants.pas`在 Delphi 5 和 2007 之间发生了变化。根据@mghie（见评论），该功能`VarIsEmpty`可以在 D5 中完成工作。但是，在 D2007 中，情况似乎不再如此，因此您可能再次需要上述功能。

另外，请注意 VBA`Nothing`可能是一个非常特殊的情况。我认为人们不会经常在自动化中遇到它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T15:15:28.897

VarIsEmpty（与 VarIsNull 不同）不符合您的要求吗？

# c# - 我可以在 C# 中读取 Outlook (2003/2007) PST 文件吗？

> ID：577904
> 
> 赞同：73
> 
> 时间：2009-02-23T15:02:55.960
> 
> 标签：c#, outlook, outlook-2007, outlook-2003, pst

是否可以使用 C# 读取 .PST 文件？我想将其作为一个独立的应用程序，而不是作为 Outlook 插件（如果可能的话）。

如果看到与此类[似的](https://stackoverflow.com/questions/466716/reading-an-outlook-2003-ost-file)[其他](https://stackoverflow.com/questions/318727/pst-to-csv-file-conversion) [SO](https://stackoverflow.com/questions/486883/problem-in-releasing-memory-from-an-outlook-pst-file) [问题](https://stackoverflow.com/questions/235231/how-to-avoid-outlook-security-alert-when-reading-outlook-message-from-c-program) ，请提到[MailNavigator](http://www.mailnavigator.com/reading_ms_outlook_pst_files.html)，但我希望在 C# 中以编程方式执行此操作。

我查看了[Microsoft.Office.Interop.Outlook](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.aspx)命名空间，但这似乎仅适用于 Outlook 插件。[LibPST](http://alioth.debian.org/projects/libpst/)似乎能够读取 PST 文件，但这是用 C 语言编写的（对不起，Joel，我[在毕业前没有学习 C](http://www.joelonsoftware.com/articles/CollegeAdvice.html)）。

任何帮助将不胜感激，谢谢！

**编辑：**

谢谢大家的回复！我接受了 Matthew Ruston 的回复作为答案，因为它最终将我引向了我正在寻找的代码。这是我开始工作的一个简单示例（您需要添加对 Microsoft.Office.Interop.Outlook 的引用）：

```
using System;
using System.Collections.Generic;
using Microsoft.Office.Interop.Outlook;

namespace PSTReader {
    class Program {
        static void Main () {
            try {
                IEnumerable<MailItem> mailItems = readPst(@"C:\temp\PST\Test.pst", "Test PST");
                foreach (MailItem mailItem in mailItems) {
                    Console.WriteLine(mailItem.SenderName + " - " + mailItem.Subject);
                }
            } catch (System.Exception ex) {
                Console.WriteLine(ex.Message);
            }
            Console.ReadLine();
        }

        private static IEnumerable<MailItem> readPst(string pstFilePath, string pstName) {
            List<MailItem> mailItems = new List<MailItem>();
            Application app = new Application();
            NameSpace outlookNs = app.GetNamespace("MAPI");
            // Add PST file (Outlook Data File) to Default Profile
            outlookNs.AddStore(pstFilePath);
            MAPIFolder rootFolder = outlookNs.Stores[pstName].GetRootFolder();
            // Traverse through all folders in the PST file
            // TODO: This is not recursive, refactor
            Folders subFolders = rootFolder.Folders;
            foreach (Folder folder in subFolders) {
                Items items = folder.Items;
                foreach (object item in items) {
                    if (item is MailItem) {
                        MailItem mailItem = item as MailItem;
                        mailItems.Add(mailItem);
                    }
                }
            }
            // Remove PST file from Default Profile
            outlookNs.RemoveStore(rootFolder);
            return mailItems;
        }
    }
} 
```

***注意：****此代码假定已为当前用户安装并配置了 Outlook。它使用默认配置文件（您可以通过转到控制面板中的邮件来编辑默认配置文件）。此代码的一项主要改进是创建一个临时配置文件以代替默认配置文件，然后在完成后将其销毁。*

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-23T15:12:14.627

Outlook 互操作库不仅适用于插件。例如，它可以用来编写一个控制台应用程序，它只读取你所有的 Outlook 联系人。我很确定标准的 Microsoft Outlook 互操作库可以让您阅读邮件——尽管它可能会在 Outlook 中引发用户必须点击的安全提示。

**编辑**：实际上使用 Outlook 互操作实现邮件阅读取决于您对“独立”的定义是什么意思。Outlook 互操作库需要在客户端计算机上安装 Outlook 才能运行。

```
// Dumps all email in Outlook to console window.
// Prompts user with warning that an application is attempting to read Outlook data.
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Outlook = Microsoft.Office.Interop.Outlook;

namespace OutlookEmail
{
class Program
{
    static void Main(string[] args)
    {
        Outlook.Application app = new Outlook.Application();
        Outlook.NameSpace outlookNs = app.GetNamespace("MAPI");
        Outlook.MAPIFolder emailFolder = outlookNs.GetDefaultFolder(Microsoft.Office.Interop.Outlook.OlDefaultFolders.olFolderInbox);

        foreach (Outlook.MailItem item in emailFolder.Items)
        {
            Console.WriteLine(item.SenderEmailAddress + " " + item.Subject + "\n" + item.Body);
        }
        Console.ReadKey();
    }
}
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-23T19:12:36.563

正如您在链接的 SO 问题之一中已经提到的那样，我还建议使用[Redemption](http://www.dimastr.com/redemption/)库。我在商业应用程序中使用它来处理 Outlook 邮件并使用它们执行各种任务。它工作完美，可防止出现烦人的安全警报。这意味着使用 COM 互操作，但这不应该是一个问题。

该软件包中有一个名为 RDO 的库，它正在替换 CDO 1.21，它允许您直接访问 PST 文件。然后就像编写一样简单（VB6代码）：

```
set Session = CreateObject("Redemption.RDOSession")
'open or create a PST store
set Store = Session.LogonPstStore("c:\temp\test.pst")
set Inbox = Store.GetDefaultFolder(6) 'olFolderInbox
MsgBox Inbox.Items.Count 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-28T21:24:39.533

我经历了对子文件夹的重构

```
 private static IEnumerable<MailItem> readPst(string pstFilePath, string pstName)
    {
        List<MailItem> mailItems = new List<MailItem>();
        Microsoft.Office.Interop.Outlook.Application app = new Microsoft.Office.Interop.Outlook.Application();
        NameSpace outlookNs = app.GetNamespace("MAPI");

        // Add PST file (Outlook Data File) to Default Profile
        outlookNs.AddStore(pstFilePath);

        string storeInfo = null;

        foreach (Store store in outlookNs.Stores)
        {
            storeInfo = store.DisplayName;
            storeInfo = store.FilePath;
            storeInfo = store.StoreID;
        }

        MAPIFolder rootFolder = outlookNs.Stores[pstName].GetRootFolder();

        // Traverse through all folders in the PST file
        Folders subFolders = rootFolder.Folders;

        foreach (Folder folder in subFolders)
        {
            ExtractItems(mailItems, folder);
        }
        // Remove PST file from Default Profile
        outlookNs.RemoveStore(rootFolder);
        return mailItems;
    }

    private static void ExtractItems(List<MailItem> mailItems, Folder folder)
    {
        Items items = folder.Items;

        int itemcount = items.Count;

        foreach (object item in items)
        {
            if (item is MailItem)
            {
                MailItem mailItem = item as MailItem;
                mailItems.Add(mailItem);
            }
        }

        foreach (Folder subfolder in folder.Folders)
        {
            ExtractItems(mailItems, subfolder);
        }
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-04-01T09:54:14.620

您可以使用[pstsdk.net：PST 文件格式 SDK](http://pstsdknet.codeplex.com/)库的 .NET 端口，它是开源的，**无需**安装 Outlook 即可读取 pst 文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-03-03T01:31:50.263

尝试[Pstxy](http://pantilesoft.github.io/)。

它提供 .Net API 来读取 Outlook PST 和 OST 文件**，无需**安装 Outlook。

它有一个免费版本来提取邮件内容（文本、html 和 rtf）。plus 版本也支持附件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-26T06:22:34.437

**对于那些提到他们没有看到 Stores 集合的人：**

在 Outlook 2007 中添加了 Stores 集合。因此，如果您使用从早期版本创建的互操作库（试图独立于版本 - 这很常见），那么这就是您看不到 Stores 的原因收藏。

您获得商店的唯一选择是执行以下操作之一：

*   使用 Outlook 2007 的互操作库（这意味着您的代码不适用于早期版本的 Outlook）。
*   使用 Outlook 对象模型枚举所有顶级文件夹，提取每个文件夹的 StoreID，然后使用 CDO 或 MAPI 接口获取有关每个商店的更多信息。
*   枚举 CDO 会话对象的 InfoStores 集合，然后使用 InfoStore 对象的 fields 集合来获取有关每个存储的更多信息。
*   或者（最难的方式）使用扩展的 MAPI 调用（在 C++ 中）：IMAPISession::GetMsgStoresTable。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-16T11:47:38.330

我们将使用它来提供一个不依赖于 Outlook 的解决方案。

[http://www.independentsoft.de/pst/index.html](http://www.independentsoft.de/pst/index.html)

它非常昂贵，但我们希望这将缩短开发时间并提高质量。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-03-14T20:26:19.233

我直接从 Microsoft 找到了一些资源，这些资源可能有助于完成这项任务。[在 MSDN 上](http://social.msdn.microsoft.com/Search/en-US/?query=Outlook%20C#)的搜索显示以下内容。

*   [如何使用 Microsoft Outlook 对象库通过 Visual C# 从收件箱中检索邮件](http://support.microsoft.com/kb/310258)
*   [如何使用 Microsoft Outlook 对象库通过 Visual C# 检索约会](http://support.microsoft.com/kb/310259)

请注意，当您添加对 Microsoft.Office.Interop.Outlook 的引用时，[文档](http://msdn.microsoft.com/en-us/library/15s06t57.aspx)坚持要求您通过 .NET 选项卡而不是 COM 选项卡执行此操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-23T15:11:16.410

您正在寻找 MAPI API。不幸的是，它在 .Net 中不可用，所以恐怕您将不得不求助于调用非托管代码。

一个快速的谷歌揭示了几个可用的包装器，也许它们对你有用？

这也可能有帮助： http: [//www.wischik.com/lu/programmer/mapi_utils.html](http://www.wischik.com/lu/programmer/mapi_utils.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-23T15:12:20.137

[这个](http://www.codeproject.com/KB/cs/outlookconnector.aspx)Outlook 的 .NET 连接器可能会帮助您入门。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-12-03T17:27:58.890

是的，使用 Independentsoft PST .NET 可以读取/导出受密码保护和加密的 .pst 文件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-28T07:33:57.900

真正有用的代码。如果您有 pst 并将您的消息存储在其根目录中（没有任何目录），那么您可以在方法 readPst 中使用以下内容：

```
 MAPIFolder rootFolder = outlookNs.Stores[pstName].GetRootFolder();
 Items items = rootFolder.Items;
 foreach (object item in items)
 {
      if (item is MailItem)
      {
           MailItem mailItem = item as MailItem;
           mailItems.Add(mailItem);
      }
 } 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-02-23T15:17:43.337

是的，您可以使用 MS Access，然后导入您的 pst 内容或只是链接它（慢！）。

# solaris - 如何知道每个solaris zone 占用了多少磁盘空间？

> ID：577912
> 
> 赞同：3
> 
> 时间：2009-02-23T15:05:42.833
> 
> 标签：solaris

如果我使用 df 命令，我只能在 Solaris 服务器中看到有多少磁盘空间被用完。但我想知道一个特定的 solaris 区域占用了多少磁盘空间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T19:46:39.370

我发现这些解决方案的问题是它们没有考虑目录继承。是的，您会发现某个目录下有多少“空间”。但是，如果您想真正了解某个区域占用了多少额外空间，则必须采用不同的方法。做一个

```
zonecfg -z zonename info 
```

其中 zonename 是区域的名称。并查看每个 inherit-pkg-dir 行。

```
inherit-pkgdir-dir:
      dir: /lib
inherit-pkgdir-dir:
      dir: /sbin 
```

任何具有继承性的行都与区域硬链接。因此，如果您简单地执行

```
du -sh /zonepath/zonename 
```

`inherit-pkg-dir`基本上你只需要计算没有在任何行中列出的目录（不包括/proc，也许还有/tmp） 。

```
cd /zonepath/zonename/root

du -sh /bin /dev /etc /home /kernel opt /system /var etc.... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-24T17:31:19.397

是的 - 绝对是 su to root 来做到这一点。

我能够运行： /usr/xpg4/bin/du -sk -h -x /zonepath/zonename 以获取在区域的 UFS 根分区中使用的空间。

例如，/usr/xpg4/bin/du -sk -h -x /zonepath/zonename
返回以下内容： 3.5G /zonepath/zonename

评估文件大小时的 -x 选项仅评估与文件操作数指定的文件具有相同设备的那些文件。

-x 操作数似乎仅在使用以下路径调用 du 时才有效：/usr/xpg4/bin/du

这也可以显示区域中 zfs 连接驱动器的已用空间！我们将一个 zfs lun 挂载到路径 /zoneepath/zonename/data 并运行它匹配数据文件的“zfs list”输出：

# /usr/xpg4/bin/du -sk -h -x /zonepath/zoneneame/data
11G /zonepath/zoneneame/data

如果您运行 #/usr/xpg4/bin/du -sk -h -x /zonepath/zoneneame
那么您应该获得区域中已用空间的总和，例如：
53G /zonepath/zonename

它不包括 NFS 连接的驱动器，也不包括 root 不是所有者的目录。

我希望这有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T15:07:23.470

试试 du 命令

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T15:28:38.287

由于我尝试了 John 的解决方案和 Pierre-Luc 解决方案，所以对我有用的是：

*   列出所有区域（来自全局区域）

：

```
tcsh>zoneadm list -civ
  ID NAME             STATUS     PATH                           BRAND    IP
   0 global           running    /                              native   shared
   1 myZone1          running    /export/zones/myZone1          native   shared
   2 myZone2          running    /export/zones/myZone2          native   shared 
```

*   `du -sk`以 root 身份
    （由于无法从全局区域读取本地区域，因此我必须以`du -sk`root 身份访问它们）

：

```
 tcsh>s du -sk /export/zones/myZone1  
 9930978 /export/zones/myZone1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T07:40:51.370

如果您在 zfs 卷上安装区域，则可以使用 zfs 工具（“zfs 列表”）快速查看已使用了多少空间。

否则，您将不得不使用您已经发现的“du”（这会慢得多）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T15:13:55.077

根据[在 Solaris 10 容器中管理 ZFS 的 Solaris 操作系统](http://www.sun.com/software/solaris/howtoguides/zfshowto.jsp)，以下命令将为您提供所需的信息。

```
zfs list 
```

# c# - 如何在 C# 中设置服务类型位？

> ID：577933
> 
> 赞同：2
> 
> 时间：2009-02-23T15:11:39.247
> 
> 标签：c#, networking, tcp, header

我正在编写一个通过网络发送数据的应用程序，并且需要知道是否可以在 IP 数据包标头中设置服务类型 (ToS) 位。任何人都知道这是否受 C# 支持，如果是，我应该如何实现它？

我知道我可以使用原始套接字类型并指定我自己的标头，但我宁愿不必这样做，因为我只使用 TCP，所以创建一个完整的标头似乎有点没有意义，所以我可以设置三个位，当它可以在没有设置这些位的情况下自动创建时。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T21:27:51.167

这不行吗？（几乎直接来自 TcpClient.Client 帮助）

```
TcpClient client = new TcpClient();
Socket s = client.Client;

if (!s.Connected)
{
   s.SetSocketOption(SocketOptionLevel.IP, 
                     SocketOptionName.TypeOfService, 2);
} 
```

不确定您要将其设置为什么值，但这应该可以...

# delphi - 如何将按钮添加到 Windows 资源管理器。（不适用于 IE）

> ID：577934
> 
> 赞同：1
> 
> 时间：2009-02-23T15:11:46.097
> 
> 标签：delphi, api, windows-explorer

我想在 Win Exp 中添加一个按钮。工具栏并使用按钮运行脚本文件。我怎样才能在德尔福中做到这一点？或者可能是 Win API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T16:36:02.260

是的，您只需要为资源管理器编写一个工具栏:)。关于工具栏的实现有很多文章：
[一二](http://www.codeproject.com/KB/shell/dotnetbandobjects.aspx?fid=3788&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=301&select=1466953)[三四](http://www.add-in-express.com/programming-internet-explorer/video.php)[（在delphi中](http://indodelphi.wordpress.com/2007/10/28/add-a-button-to-the-internet-explorer-toolbar/)
[）](http://www.codeproject.com/KB/shell/IEToolbar.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T22:00:41.463

也许 Shell+ (ShellPlus) 组件可以帮助解决这个问题？（没有证明自己 - 只是一个研究的想法）。我相信他们会让你添加一个新的工具栏，至少，修改右键菜单。您需要运行什么样的脚本？

# sharepoint - 默认母版页上的 SharePoint 搜索

> ID：577937
> 
> 赞同：2
> 
> 时间：2009-02-23T15:11:59.340
> 
> 标签：sharepoint, search, master-pages

我正在尝试在我的默认母版页上启用搜索栏。在母版页的源代码中有以下内容：

```
<asp:ContentPlaceHolder id="PlaceHolderSearchArea" runat="server">
<SharePoint:DelegateControl runat="server" ControlId="SmallSearchInputBox"/>
</asp:ContentPlaceHolder> 
```

在设计模式下的页面呈现中，它显示 [DelegateControl]。当我发布页面时，我没有看到搜索框，我什么也看不到...有人可以指出如何在我的默认母版页上启用搜索的方向，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-23T21:10:20.107

我遇到了完全相同的问题，但最终找到了一个非常简单的解决方案。您只需要确保您的 asp:ContentPlaceHolder 在 html 表单中。我不知道为什么会这样，只是将您的代码更改为

```
<form id="Form1" runat="server">
 <asp:ContentPlaceHolder id="PlaceHolderSearchArea" runat="server">
  <SharePoint:DelegateControl runat="server" ControlId="SmallSearchInputBox"/>
 </asp:ContentPlaceHolder>
</form> 
```

应该解决问题。

我发现这个非常简单的 application.master 页面：http: [//blogs.microsoft.co.il/blogs/justguy/archive/2008/08/31/empty-application-master.aspx](http://blogs.microsoft.co.il/blogs/justguy/archive/2008/08/31/empty-application-master.aspx)

当搜索框使用这个简单的母版页工作时，我能够追踪问题并找到所需的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T15:44:00.527

您确定您的 MOSS Search 服务配置正确吗？

如果没有，请查看这篇文章： [http ://www.mysharepointblog.com/post/2008/10/Configure-Search-On-MOSS-2007-(Microsoft-Office-SharePoint-Server).aspx](http://www.mysharepointblog.com/post/2008/10/Configure-Search-On-MOSS-2007-(Microsoft-Office-SharePoint-Server).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T20:23:36.253

您是否从网站功能中激活了“Office SharePoint Server 标准网站集功能”？

# python - 如何让这个 Python 递归函数返回一个平面列表？

> ID：577940
> 
> 赞同：13
> 
> 时间：2009-02-23T15:12:37.670
> 
> 标签：python, recursion

看看这个简单的函数

```
def prime_factors(n):
    for i in range(2,n):
      if n % i == 0:
        return i, prime_factors(n / i)
    return n 
```

这是结果`prime_factors(120)`

```
(2, (2, (2, (3, 5)))) 
```

我希望它返回一个扁平元组或列表，而不是嵌套元组。

```
(2, 2, 2, 3, 5) 
```

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-23T15:17:03.353

```
def prime_factors(n):
  for i in range(2,n):
    if n % i == 0:
      return [i] + prime_factors(n / i)
  return [n] 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-23T15:16:14.620

```
def prime_factors(n):
    for i in range(2,n):
        if n % i == 0:
           yield i
           for p in prime_factors(n / i):
               yield p
           return
    yield n 
```

例子：

```
>>> tuple(prime_factors(100))
(2, 2, 5, 5) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-23T15:19:23.783

在不更改原始函数的情况下，来自[Python Tricks](http://kogs-www.informatik.uni-hamburg.de/~meine/python_tricks)：

```
def flatten(x):
    """flatten(sequence) -> list

    Returns a single, flat list which contains all elements retrieved
    from the sequence and all recursively contained sub-sequences
    (iterables).

    Examples:
    >>> [1, 2, [3,4], (5,6)]
    [1, 2, [3, 4], (5, 6)]
    >>> flatten([[[1,2,3], (42,None)], [4,5], [6], 7, MyVector(8,9,10)])
    [1, 2, 3, 42, None, 4, 5, 6, 7, 8, 9, 10]"""

    result = []
    for el in x:
        #if isinstance(el, (list, tuple)):
        if hasattr(el, "__iter__") and not isinstance(el, basestring):
            result.extend(flatten(el))
        else:
            result.append(el)
    return result 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-23T16:18:41.880

liw.fi 在[评论](https://stackoverflow.com/questions/577940/how-can-i-make-this-python-recursive-function-return-a-flat-list/577961#577961)中建议：

> 您可以将列表作为参数传递并附加到它，而不是为每个返回值创建一个新列表。如果列表变大，这可能会节省一些空间和时间。

这是 liw.fi 建议的实现。

```
def prime_factors(n, factors=None):
    if factors is None:
        factors = []
    for i in range(2,n):
        if n % i == 0:
            factors.append(i)
            return prime_factors(n / i, factors)
    factors.append(n)
    return factors 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-16T10:58:30.823

我不知道这有多相关，但这个函数可以帮助你展平深层嵌套列表（*使用递归*），并且也可以应用于手头的问题。虽然，它是用软管给雏菊浇水

```
def flatten(S):
    if S == []:
        return S
    if isinstance(S[0], list):
        return flatten(S[0]) + flatten(S[1:])
    return S[:1] + flatten(S[1:]) 
```

# ruby - 如何从 Rake 任务中运行 Rake 任务？

> ID：577944
> 
> 赞同：427
> 
> 时间：2009-02-23T15:13:16.637
> 
> 标签：ruby, rake

我有一个 Rakefile，它根据全局变量以两种方式编译项目`$build_type`，它可以是`:debug`or `:release`（结果放在单独的目录中）：

```
task :build => [:some_other_tasks] do
end 
```

我希望创建一个任务，依次使用两种配置编译项目，如下所示：

```
task :build_all do
  [ :debug, :release ].each do |t|
    $build_type = t
    # call task :build with all the tasks it depends on (?)
  end
end 
```

有没有办法像调用方法一样调用任务？或者我怎样才能达到类似的效果？

* * *

## 回答 #1

> 赞同：656
> 
> 时间：2009-08-17T20:05:41.667

### 如果您需要将任务用作方法，那么使用实际方法怎么样？

```
task :build => [:some_other_tasks] do
  build
end

task :build_all do
  [:debug, :release].each { |t| build t }
end

def build(type = :debug)
  # ...
end 
```

### 如果您宁愿坚持使用`rake`'s 成语，以下是您的可能性，从过去的答案编译而来：

*   这总是执行任务，但不执行其依赖项：

    ```
    Rake::Task["build"].execute 
    ```

*   这个执行依赖项，但它仅在尚未被调用的情况下执行任务：

    ```
    Rake::Task["build"].invoke 
    ```

*   这首先重置任务的 already_invoked 状态，然后允许任务再次执行，依赖关系和所有：

    ```
    Rake::Task["build"].reenable
    Rake::Task["build"].invoke 
    ```

*   请注意，除非重新启用，否则已调用的依赖项不会自动重新执行。在 Rake >= 10.3.2 中，您也可以使用以下命令重新启用它们：

    ```
    Rake::Task["build"].all_prerequisite_tasks.each(&:reenable) 
    ```

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2009-02-23T15:37:15.643

例如：

```
Rake::Task["db:migrate"].invoke 
```

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2009-04-29T12:35:15.900

```
task :build_all do
  [ :debug, :release ].each do |t|
    $build_type = t
    Rake::Task["build"].reenable
    Rake::Task["build"].invoke
  end
end 
```

那应该可以解决您的问题，我自己也需要同样的东西。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2018-09-09T20:39:30.607

```
task :invoke_another_task do
  # some code
  Rake::Task["another:task"].invoke
end 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-23T15:34:56.680

```
task :build_all do
  [ :debug, :release ].each do |t|
    $build_type = t
    Rake::Task["build"].execute
  end
end 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-07T17:35:16.793

如果您希望每个任务都运行而不考虑任何失败，您可以执行以下操作：

```
task :build_all do
  [:debug, :release].each do |t| 
    ts = 0
    begin  
      Rake::Task["build"].invoke(t)
    rescue
      ts = 1
      next
    ensure
      Rake::Task["build"].reenable # If you need to reenable
    end
    return ts # Return exit code 1 if any failed, 0 if all success
  end
end 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-09-11T22:51:15.643

我建议不要创建一般的调试和发布任务，如果项目真的是被编译的东西，因此会产生文件。正如您所说，您应该使用在您的示例中非常可行的文件任务，即您的输出进入不同的目录。假设您的项目只是使用 gcc 将 test.c 文件编译为 out/debug/test.out 和 out/release/test.out，您可以像这样设置您的项目：

```
WAYS = ['debug', 'release']
FLAGS = {}
FLAGS['debug'] = '-g'
FLAGS['release'] = '-O'
def out_dir(way)
  File.join('out', way)
end
def out_file(way)
  File.join(out_dir(way), 'test.out')
end
WAYS.each do |way|
  desc "create output directory for #{way}"
  directory out_dir(way)

  desc "build in the #{way}-way"
  file out_file(way) => [out_dir(way), 'test.c'] do |t|
    sh "gcc #{FLAGS[way]} -c test.c -o #{t.name}"
  end
end
desc 'build all ways'
task :all => WAYS.map{|way|out_file(way)}

task :default => [:all] 
```

此设置可以像这样使用：

```
rake all # (builds debug and release)
rake debug # (builds only debug)
rake release # (builds only release) 
```

这比要求的要多一点，但显示了我的观点：

1.  根据需要创建输出目录。
2.  仅在需要时才重新编译文件（此示例仅适用于最简单的 test.c 文件）。
3.  如果您想触发发布构建或调试构建，您可以轻松完成所有任务。
4.  这个例子包括一种方法来定义调试和发布版本之间的细微差别。
5.  无需重新启用使用全局变量参数化的构建任务，因为现在不同的构建具有不同的任务。构建任务的代码重用是通过重用代码来定义构建任务来完成的。看看循环如何不执行两次相同的任务，而是创建任务，以后可以触发（通过 all-task 或在 rake 命令行上选择其中一个）。

# c# - 当我尝试使用或返回枚举值时，我可以避免强制转换它吗？

> ID：577946
> 
> 赞同：31
> 
> 时间：2009-02-23T15:13:51.753
> 
> 标签：c#, .net, enums, casting, return-value

如果我有以下枚举：

```
public enum ReturnValue{
    Success = 0,
    FailReason1 = 1,
    FailReason2 = 2
    //Etc...
} 
```

我可以在返回时避免投射吗，如下所示：

```
public static int main(string[] args){
    return (int)ReturnValue.Success;
} 
```

如果不是，为什么默认情况下不将枚举值视为 int ？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-23T15:19:44.813

枚举应该是类型安全的。我认为他们并没有使它们隐含地铸造以阻止其他用途。尽管该框架允许您为它们分配一个常量值，但您应该重新考虑您的意图。如果您主要使用枚举来存储常量值，请考虑使用静态类：

```
public static class ReturnValue
{
    public const int Success = 0;
    public const int FailReason1 = 1;
    public const int FailReason2 = 2;
    //Etc...
} 
```

这让你可以做到这一点。

```
public static int main(string[] args){
    return ReturnValue.Success;
} 
```

**编辑**

当您*确实*想为枚举提供值时，就是您想将它们组合起来。请参见以下示例：

```
[Flags] // indicates bitwise operations occur on this enum
public enum DaysOfWeek : byte // byte type to limit size
{
    Sunday = 1,
    Monday = 2,
    Tuesday = 4,
    Wednesday = 8,
    Thursday = 16,
    Friday = 32,
    Saturday = 64,
    Weekend = Sunday | Saturday,
    Weekdays = Monday | Tuesday | Wednesday | Thursday | Friday
} 
```

然后可以使用按位数学来使用此枚举。有关某些应用程序，请参见以下示例。

```
public static class DaysOfWeekEvaluator
{
    public static bool IsWeekends(DaysOfWeek days)
    {
        return (days & DaysOfWeek.Weekend) == DaysOfWeek.Weekend;
    }

    public static bool IsAllWeekdays(DaysOfWeek days)
    {
        return (days & DaysOfWeek.Weekdays) == DaysOfWeek.Weekdays;
    }

    public static bool HasWeekdays(DaysOfWeek days)
    {
        return ((int) (days & DaysOfWeek.Weekdays)) > 0;
    }

    public static bool HasWeekendDays(DaysOfWeek days)
    {
        return ((int) (days & DaysOfWeek.Weekend)) > 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T15:20:32.923

没有隐式转换，因为枚举不必使用 int 作为基础类型。例如，如果您的枚举使用 uint 作为基础类型，则没有从 uint 到 int 的隐式转换。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T16:17:52.527

c# 枚举没用。

您可以通过创建密封类并提供隐式/显式转换运算符来避免从您的类型转换并限制可以显式转换为您的类型的值。

*   提供一个隐式运算符，用于从您的类型转换为通用 int，这样您就不必强制转换。
*   提供一个显式运算符用于从 int 转换为您的类型，如果整数不满足约束，则会引发错误，例如 (int x) => (x >= 0 && x <= 2)。

如果使用这种技术，请创建一个通用的不可变基类，例如`ConstrainedNumber<T>`，它有一个接受 T 值的构造函数和约束的委托：`delegate bool NumberConstraint<T>(T value)`。构造函数应该通过约束委托运行该值，如果不满足约束则抛出异常。基类还应该处理到 T 的隐式转换操作，并且应该通过重载 object.Equals(object) 和 object.GetHashCode()、为 type 定义 == 和 != 运算符`ConstrainedNumber<T>`以及实现`IEquatable<T>`and来处理相等`IEquatable<ConstrainedNumber<T>>`。我还建议为基类和所有派生类型定义一个复制构造函数。然后可以通过反射检索复制构造函数在基类中干净地实现克隆，但这完全是可选的。你可以弄清楚`ConstrainedNumber<T>`自己实现，除非我已经在某个地方的 stackoverflow 上发布了它。

您可以在派生的 ConstrainedNumber 中提供命名的静态只读值，以便您可以像访问枚举一样访问它们。

```
public sealed class ReturnValue: ConstrainedNumber<int>
{
    public static readonly NumberConstraint<int> constraint = (int x) => (x >= 0 && x < 3);

    public static readonly ReturnValue Success = new ReturnValue(0);
    public static readonly ReturnValue FailReason1 = new ReturnValue(1);
    public static readonly ReturnValue FailReason2 = new ReturnValue(2);

    private ReturnValue( int value ): base( value, constraint ) {}
    private ReturnValue( ReturnValue original ): base (original) {} //may be used to support IClonable implementation in base class
    public static explicit operator ReturnValue( int value )
    {
        switch(value) //switching to return an existing instance is more efficient than creating a new one and re-checking the constraint when there is a limited number of allowed values; if the constraint was more generic, such as an even number, then you would instead return a new instance here, and make your constructors public.
        {
            case 0: return Success;
            case 1: return FailReason1;
            case 2: return FailReason2;
        }
        throw new ArgumentException( "Value fails to meet the constraint defined for " + typeof(ReturnValue).FullName + ".", "value" );
    }

} 
```

您可以将此技术用于任何约束。例如，一个名为 EvenNumber 的类可能有一个约束，如果给定的数字是偶数则返回 true。在这种情况下，您只需公开您的构造函数，并简化您的静态转换运算符以仅返回一个新的 EvenNumber，而不是切换为返回有限的现有实例之一。

它可以这样使用：

```
EvenNumber x = (EvenNumber)2;
EvenNumber y = (EvenNumber)3; //throws exception "Value fails to meet the constraint defined for {namespace}.EvenNumber."  A c# enum would stupidly allow such a cast, creating an invalid EvenNumber, breaking the object-oriented model
int z = x; //implicit conversion, no cast necessary; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T15:15:59.097

根据规范，枚举和整数根本不能隐式转换（文字 0 除外，它允许用于比较测试/分配/等）。不过，只需要显式转换即可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T15:26:48.523

奇怪的是，这并非特定于 .NET Framework，而仅适用于 C#。正如其他评论者已经指出的那样，在 C# 中，这基本上是语言的规范。在 VB.NET 中情况并非如此。

查看 MSDN 参考页以了解[VB.NET 中的枚举](http://msdn.microsoft.com/en-us/library/8h84wky1.aspx)。请注意，您可以在 Enum 声明时指定枚举的数据类型。

这意味着，如果您*真的*不想将代码转换为 (int) 乱扔垃圾，您可以在 VB.NET 中编写枚举，将其声明为整数，然后使用 C# 中的该枚举。

还记得他们是如何告诉我们计算机会让我们的生活变得如此简单的吗？:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T15:16:17.893

不，你不能避免铸造；至于为什么没有隐式转换，我不知道，但没有。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T15:29:19.500

您可以将此行为归因于创建枚举背后的基本意图......创建一组命名常量，这些常量只能具有指​​定（或默认）值，具体取决于基础类型。

与您的问题相关，有两个单独的问题需要考虑：

1.  默认情况下不能将`Enum`值视为 int，因为这样您就可以提供**任何**整数，并且不会有编译时检查来验证所提供的整数确实作为枚举中的值存在。

2.  由于您试图从控制类型（`YourCustomEnum`从类派生的`System.Enum`类型）转换为基础类型，即`int`or`byte`等​​，因此强制转换变得必要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-18T13:02:39.070

冒着`Necromancer`一批风险，我仍然喜欢发布一个尚未出现的可能性：使用隐式转换`int`为`enum`类型的辅助类（resp.struct）：

```
internal struct AutoCaster<T1, T2> {

    private T1 Value1 { get; }
    private T2 Value2 { get; }

    public AutoCaster(T1 value1) {
        Value1 = value1;
        Value2 = (T2)(object)value1;
    }

    public AutoCaster(T2 value2) {
        Value1 = (T1)(object)value2;
        Value2 = value2;
    }

    public static implicit operator AutoCaster<T1, T2>(T2 input) {
        return new AutoCaster<T1, T2>(input);
    }

    public static implicit operator AutoCaster<T1, T2>(T1 input) {
        return new AutoCaster<T1, T2>(input);
    }

    public static implicit operator T1(AutoCaster<T1, T2> input) {
        return input.Value1;
    }

    public static implicit operator T2(AutoCaster<T1, T2> input) {
        return input.Value2;
    }

} 
```

由于 Main 需要一个修复返回类型（`int`或`void`），它在您的示例中看起来并不那么优雅，但对于其他目的，它工作得很好：

```
 public static int Main(string[] args) {
        return Main2(args);
    }

    private static AutoCaster<int, ReturnValue> Main2(string[] args) {
        return ReturnValue.FailReason2;
    } 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2015-10-01T19:01:49.383

使用类的静态成员怎么样？

```
//enum DocInfos { DocName, DocNumber, DocVersion};
public class DocInfos
{
    public static int DocName = 0;
    public static int DocNumer = 1;
    public static int DocVersion = 2;
} 
```

...

```
 Doc = new string[DocInfos.DocVersion];
            // Treffer
            Doc[DocInfos.DocName] = TrimB(HTMLLines[lineCounter + 2]) 
```

...

# apache-flex - 从命令行编译 Flex Builder 项目

> ID：577951
> 
> 赞同：17
> 
> 时间：2009-02-23T15:14:53.500
> 
> 标签：apache-flex, command-line, ant, flexbuilder

有没有一种简单的方法可以通过命令行构建在 FlexBuilder 中创建的项目？

我开始着手将几个 Flex 组件添加到我正在工作的项目中。目前，项目的其余部分（一些 java、一些 C++）是通过 ant 脚本构建的。我真的很希望能够将我正在处理的 Flex 组件的构建集成到该 ant 脚本中，但我不确定如何从命令行构建 Flex 项目。

有没有办法从命令行调用 flex 编译器，以便它使用 flex builder 的项目作为其配置？或者有没有办法修改 FlexBuilder 的编译，以便我可以为项目编写一个构建脚本，然后让它使用它（这样我只有一种构建方式，并且 ant 和 FB 都使用它，而不是分开构建过程）？

虽然 flex ant 任务更可取，但它并不是真正必要的，因为我可以很容易地从命令行应用程序创建自定义任务。

编辑：

我可能应该提到的另一件事。虽然我安装了 FlexBuilder，但运行该 ant 脚本的一些人没有安装。他们只需要普通的 Flex SDK。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T15:29:48.470

您可以使用 FB 中的 -dump-config 选项转储 FB 用于编译项目的 config.xml，然后将其（使用 -load-config 选项）与命令行构建一起使用。

我知道在常规的 Eclipse 中你可以从一个 ant 文件构建，我很确定你可以用 FB 做同样的事情。

尽管 flex ant 任务的 doc 有点臭，但它们工作正常。

[编辑]-我在评论中回复了，但我想充实我的回复。
Herms 在使用 -dump-config 和 -load-config 时遇到了问题，它指出了为什么 flex ant 任务更好。（我不想成为那个说“你为什么想做 X？”的人，所以我只是回答了这个问题）。

尽管他们的文档低于标准（imo），但它们更适合构建项目的任务。
使用 flex ant 任务有几个问题，但在大多数情况下，这不是脑部手术（实际上问题更多，因为 doc 很烂）。

当我开始为我们的项目进行自动化构建时，我发现了这个站点： http:
[//www.nabble.com/FlexCoders-f16212.html](http://www.nabble.com/FlexCoders-f16212.html)

成为无价之宝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T15:47:14.263

我写了一篇关于如何做到这一点的博客文章（使用 Ant 设置 Flex）并有一个示例构建文件。虽然我是为 Linux 编写的，但 Ant 部分与平台无关。（见步骤 4）：

[http://blog.apterainc.com/software/setting-up-a-flex-development-enviroment-in-gnulinux/](http://blog.apterainc.com/software/setting-up-a-flex-development-enviroment-in-gnulinux/)

如果您需要任何帮助，请发表评论，我可以解决您遇到的任何问题。

**编辑：** Flex 的 ant 任务的文档有点稀疏，但这里是 Adob​​e 的官方文档，足以让我上路： http: [//livedocs.adobe.com/flex/3/html/help.html ?content=anttasks_1.html](http://livedocs.adobe.com/flex/3/html/help.html?content=anttasks_1.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T16:31:04.207

Flex 3 带有用于从命令行构建 Flex 应用程序的 Ant 任务。文档可[在此处](http://livedocs.adobe.com/flex/3/html/help.html?content=anttasks_1.html)获得。此外，还有一个很棒的开源构建框架，称为[Antennae](http://code.google.com/p/antennae/)，它可以帮助从命令行组织和构建 Flex 应用程序（它是基于 Ant 的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-04T18:08:56.460

我从 Antennae 开始，当我意识到它不使用 Flex Ant 任务时非常失望。为了得到我需要的东西，我需要破解它传递给 mxmlc 的命令行参数......并且天线不支持模块以及其他更容易通过 Flex Ant 任务完成的东西。无论如何，我确实想出的是我在天线中发现的好的方面和这篇博客文章中构建文件的好的方面的混合：http: [//jvalentino.blogspot.com/2010/03/flex-ant -build-optimized-modules_24.html](http://jvalentino.blogspot.com/2010/03/flex-ant-build-optimized-modules_24.html)

# sunone - Sun 应用程序服务器错误：提交响应时出错 java.io.IOException：sun.nio.ch.FileDispatcher.write0 处的管道损坏（本机方法）

> ID：577958
> 
> 赞同：0
> 
> 时间：2009-02-23T15:16:25.133
> 
> 标签：sunone

有时我会在多次访问我的 Web 应用程序后遇到此错误我使用的是 Sun Application Server Platform Edition 8.2

遇到此错误的原因是什么以及如何解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T15:20:01.163

可能是文件系统权限问题。需要更多信息以获得更好的答案。

# c# - 表示百分比、概率或库存水平

> ID：577972
> 
> 赞同：1
> 
> 时间：2009-02-23T15:19:27.810
> 
> 标签：c#, .net, data-structures

在 .NET 3.5 中是否有一种简洁的方式来表示有界数值？

我的意思是一个值，例如百分比 (0 - 100) 概率 (0 - 1) 或库存水平（0 或更高）。

`ArgumentOutOfRangeException`如果尝试了超出范围的分配，我希望抛出一个（或等效的）。我还希望静态`MaxValue`和`MinValue`属性可用。

[在对另一个 SO 问题](https://stackoverflow.com/questions/575977/choosing-between-immutable-objects-and-structs-for-value-objects/576014#576014)的评论中建议这是对`struct`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T15:25:21.943

[我认为没有像 Ada "range" 关键字](http://en.wikibooks.org/wiki/Ada_Programming/Types/range)这样的内置方式，但是您可以轻松地创建像 RestrictedRange<T> 这样的类型，它具有最小值和最大值以及当前值：

```
public class RestrictedRange<T> where T : IComparable
{        
    private T _Value;

    public T MinValue { get; private set; }
    public T MaxValue { get; private set; }

    public RestrictedRange(T minValue, T maxValue)
        : this(minValue, maxValue, minValue)
    {
    }

    public RestrictedRange(T minValue, T maxValue, T value)
    {
        if (minValue.CompareTo(maxValue) > 0)
        {
            throw new ArgumentOutOfRangeException("minValue");
        }

        this.MinValue = minValue;
        this.MaxValue = maxValue;
        this.Value = value;
    }

    public T Value
    {
        get
        {
            return _Value;
        }

        set
        {
            if ((0 < MinValue.CompareTo(value)) || (MaxValue.CompareTo(value) < 0))
            {
                throw new ArgumentOutOfRangeException("value");
            }
            _Value = value;
        }
    }

    public static implicit operator T(RestrictedRange<T> value)
    {
        return value.Value;
    }        

    public override string ToString()
    {
        return MinValue + " <= " + Value + " <= " + MaxValue;
    }
} 
```

由于存在自动获取值的隐式转换，因此这将起作用：

```
var adultAge = new RestrictedRange<int>(18, 130, 21);
adultAge.Value++;
int currentAge = adultAge; // = 22 
```

另外，你可以做这样的事情

```
var stockLevel = new RestrictedRange<int>(0, 1000)
var percentage = new RestrictedRange<double>(0.0, 1.0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T15:23:50.403

事实上，这是在 MS Press 的 70-526 考试学习指南中用作“使用结构的地方”示例的事物类型。具有值语义的一小组数据（< 16 字节）最好设计为结构，而不是类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:28:06.227

我可能会创建一个类来表示有界值。

```
public class Percentage
{
    public static readonly double MinValue = 0.0;
    public static readonly double MaxValue = 100.0;

    private double value;
    public double Value
    {
       get { return this.value; }
       set
       {
            if (value < MinValue || value > MaxValue)
            {
                throw new ArgumentOutOfRangeException("...");
            }
            this.value = value;
       }
} 
```

但是，如果您的数据存储在数据库中，您通常可以避免这种情况，只需使用自然底层类型作为值，并对数据库和数据验证方法实施约束。如有必要，可以将最小值/最大值存储在配置中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T15:38:34.080

当然，您可以通过在 setter 中检查它们来强制限制类中的任何整数属性。但是，这无法将边界要求清楚地传达给该类的用户。我在这个问题中解决了一个类似的问题：
[如何向我的班级用户指示验证要求？](https://stackoverflow.com/questions/179295/how-do-i-indicate-a-validation-requirement-to-users-of-my-class)

基于该问题和此后获得的经验，我建议您创建一个新的 BoundedInteger 类。这个类将有一个值属性，它应该是不言自明的。它还将具有与整数的隐式转换，以使您的类的用户更容易。您还可以将 MinValue 和 MaxValue 项添加为只读属性，并将它们作为必需参数包含在类构造函数中。

一个重要的补充是，您可能并不*总是*希望在错误的分配上抛出异常，因为有时错误的分配可能并不是那么异常。根据上下文，当尝试进行错误分配时，您可以选择几种行为：

*   无论如何都允许分配（例如：某人可能真的想要 110% 的值）
*   保持以前的值
*   重置为零或其他一些“默认”值
*   将值设置为最接近的界限（即，如果他们尝试将 110 分配给百分比，则将其设置为 100）

根据属性的需要，任何这些行为也可能引发或不引发异常。根据您的问题领域，这可能都过大了，但在设计程序时值得牢记。

如果您决定确实需要这种灵活性，您可能希望在枚举中定义这些行为，以及用于保存该值的只读属性。然后，选择一个作为默认值，然后添加一个额外的构造函数，您可以在其中设置该实例的特定行为以及是否应引发异常。最后，如果您可能允许错误的分配，您可能需要提供一个 IsValid() 方法来测试边界属性。

# javascript - JavaScript 与 google flash 组件……可能吗？

> ID：577975
> 
> 赞同：0
> 
> 时间：2009-02-23T15:19:55.110
> 
> 标签：javascript, flash

我在 JavasSript 中，但不在 Flash 中，所以也许你可以帮助我解决这个问题。我已经使用 google 组件在页面上嵌入了一些音频，如下所示：

```
<embed type="application/x-shockwave-flash" src="http://www.google.com/reader/ui/3247397568-audio-player.swf?audioUrl=MP3_FILE_URL" width="400" height="27" allowscriptaccess="never" quality="best" bgcolor="#ffffff" wmode="window" flashvars="playerMode=embedded" /> 
```

我想做的（如果可能的话）是“查询”组件以了解它的时间位置，并根据时间线执行一些事件。是否可以只使用 JavaScript ？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T17:24:08.070

这将完全取决于 flash 组件是否提供外部 api。通常，允许 javascript 访问 Flash 组件是可能的。但是，它必须明确地设计到闪存组件中。

我会检查谷歌是否有任何关于使用这个 Flash 组件的文档。我还会检查它的嵌入位置，看看页面上是否有任何 javascript 正在访问它。

最后，如果您查看嵌入，它似乎有一个属性 allowscriptaccess="never"。这似乎相关:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T16:16:30.403

Adobe 提供了一个用于与 Flash 交互的 JavaScript API：

[http://www.adobe.com/devnet/flash/javascript_api.html](http://www.adobe.com/devnet/flash/javascript_api.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T19:53:04.500

看看[swfobject javascript 库](http://code.google.com/p/swfobject/)

# testing - 如何计算假设检验中的 p 值（线性回归）

> ID：577982
> 
> 赞同：1
> 
> 时间：2009-02-23T15:24:06.627
> 
> 标签：testing, statistics, awk, linear-regression

目前我正在编写一个`awk`脚本来对测量数据进行一些统计分析。我正在使用线性回归来获取参数估计值、标准误差等，并且还想计算零假设检验（t 检验）的 p 值。

到目前为止，这是我的脚本，知道如何计算 p 值吗？

```
BEGIN {
    ybar = 0.0
    xbar = 0.0
    n = 0
    a0 = 0.0
    b0 = 0.0
    qtinf0975 = 1.960 # 5% n = inf
}

{ # y_i is in $1, x_i has to be counted
    n = n + 1
    yi[n] = $1*1.0
    xi[n] = n*1.0
}

END {
    for ( i = 1; i <= n ; i++ ) {
        ybar = ybar + yi[i]
        xbar = xbar + xi[i]
    }
    ybar = ybar/(n*1.0)
    xbar = xbar/(n*1.0)

    bhat = 0.0
    ssqx = 0.0
    for ( i = 1; i <= n; i++ ) {
        bhat = bhat + (yi[i] - ybar)*(xi[i] - xbar)
        ssqx = ssqx + (xi[i] - xbar)*(xi[i] - xbar)
    }
    bhat = bhat/ssqx
    ahat = ybar - bhat*xbar

    print "n: ", n
    print "alpha-hat: ", ahat
    print "beta-hat: ", bhat

    sigmahat2 = 0.0
    for ( i = 1; i <= n; i++ ) {
        ri[i] = yi[i] - (ahat + bhat*xi[i])
        sigmahat2 = sigmahat2 + ri[i]*ri[i]
    }
    sigmahat2 = sigmahat2 / ( n*1.0 - 2.0 )

    print "sigma-hat square: ", sigmahat2

    seb = sqrt(sigmahat2/ssqx)

    print "se(b): ", seb

    sigmahat = sqrt((seb*seb)*ssqx)
    print "sigma-hat: ", sigma
    sea = sqrt(sigmahat*sigmahat * ( 1 /(n*1.0) + xbar*xbar/ssqx))

    print "se(a): ", sea

    # Tests

    print "q(inf)(97.5%): ", qtinf0975

    Tb = (bhat - b0) / seb
    if ( qtinf0975 > Tb )
        print "T(b) plausible: ", Tb, " < ", qtinf0975
    else
        print "T(b) NOT plausible: ", Tb, " > ", qtinf0975

    print "confidence(b): [", bhat - seb * qtinf0975,", ", bhat + seb * qtinf0975 ,"]"

    Ta = (ahat - a0) / sea
    if ( qtinf0975 > Ta )
        print "T(a) plausible: ", Ta, " < ", qtinf0975
    else
        print "T(a) NOT plausible: ", Ta, " > ", qtinf0975

    print "confidence(a): [", ahat - seb * qtinf0975,", ", ahat + seb * qtinf0975 ,"]"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T15:37:34.193

您可能正在尝试在方差相等的假设下进行配对 t 检验。我建议你在优秀的 MathWorld 网站上查看[相应的条目。](http://mathworld.wolfram.com/Pairedt-Test.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T10:12:06.747

好的，我找到了一个 javascript 实现并将其移植到`awk`这是用于计算 p 值的函数：

```
function statcom ( mq, mi, mj, mb )
{
    zz = 1
    mz = zz
    mk = mi
    while ( mk <= mj ) {
        zz = zz * mq * mk / ( mk - mb)
        mz = mz + zz
        mk = mk + 2
    }
    return mz
}

function studpval ( mt , mn )
{
    PI = 3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679 # thank you wikipedia
    if ( mt < 0 )
        mt = -mt
    mw = mt / sqrt(mn)
    th = atan2(mw, 1)
    if ( mn == 1 )
        return 1.0 - th / (PI/2.0)
    sth = sin(th)
    cth = cos(th)
    if ( mn % 2 == 1 )
        return 1.0 - (th+sth*cth*statcom(cth*cth, 2, mn-3, -1))/(PI/2.0)
    else
        return 1.0 - sth * statcom(cth*cth, 1, mn-3, -1)
} 
```

我已经像这样集成它们：

```
 pvalb = studpval(Tb, n)
    if ( pvalb > 0.05 )
        print "p-value(b) plausible: ", pvalb, " > 0.05"
    else
        print "p-value(b) NOT plausible: ", pvalb, " < 0.05"

    pvala = studpval(Ta, n)
    if ( pvala > 0.05 )
        print "p-value(a) plausible: ", pvala, " > 0.05"
    else
        print "p-value(a) NOT plausible: ", pvala, " < 0.05" 
```

# .net - 为什么会发生这种整数溢出？

> ID：577990
> 
> 赞同：3
> 
> 时间：2009-02-23T15:26:15.530
> 
> 标签：.net, integer-overflow

我已经包装了一个 dll 方法，它有一个整数作为 web 服务中的 out 参数。在测试中，我发现当我期待 -1 时，我得到了 65,535。我意识到 dll 使用的是 16 位整数，并且在我的代码中引用外部 dll 时我指定了标准的 .NET 32 位整数。通过指定一个 16 位整数很快就解决了这个问题，一切都很好。

我的问题是为什么会这样？如果我试图将 32 位整数放入 16 位整数中，我可以理解发生溢出，但我不太确定为什么会反过来发生这种情况。显然，我对类型之间的这种类型转换的理解有点缺乏，所以任何指导都将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T15:30:31.307

16 位整数“-1”设置了所有 16 位。如果设置 32 位整数的低 16 位，则值为 65,535。有关负整数的内部表示的解释，请查看[这篇文章](http://en.wikipedia.org/wiki/Two_complement)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T15:31:35.237

这是由于类型转换而发生的。

您实际上并没有在调用堆栈上发送 16 位整数——它们仍然是 32 位的。所以 DLL 返回的*确切*内容是：

```
0x0000ffff 
```

如果将其转换为 eg `sint16`，则为`-1`，但如果为 32 位，则为`65535`。

# xml - 任何熟悉集成 UPS Worldship 的人？

> ID：577994
> 
> 赞同：0
> 
> 时间：2009-02-23T15:26:53.313
> 
> 标签：xml, data-transfer, ups-worldship

我的老板刚刚要求我在一周内实施一种方法，让远程托运人能够访问我们的系统并获得他们需要处理的订单，并从 UPS Worldship 打印包装标签。

这个远程办公室不属于我们的业务；他们将通过网络前端（相当于外联网）访问我们的系统——在我们这一端，我们基本上必须标记他们需要运送的订单，并将其导出到批处理作业或他们可以下拉的东西插入他们的 Worldship 版本，但能够通过他们的订单号（我们分配的）查找订单。

现在，我从未对 Worldship 做过任何事情。我能想到的最好方法是为我们提供一个实用程序，将订单标记为从该位置发货，将订单数据转换为某种 XML 格式并将其写入服务器上的文件。在某些时候，需要将其传输（FTP？）到他们的服务器，他们必须启动导入/映射到 worldship。然后他们需要处理订单并将包含 UPS 跟踪号的 XML 文件返回给我们，以便我们将它们加载到我们的系统中。我完全不知道 Worldship 是如何工作的，或者我如何将字段映射到它，因为一个地址与多个订单相关联是完全可行的——我的老板希望他们能够使用 Worldship 来获取我们的订单信息订单号。

我真的不知道从哪里开始做这件事——从他所说的他想要完成的事情来看，这听起来不可能，但他是那种认为“做起来并不难”的人。

当前站点是用 VBScript 编写的，但如果我愿意，我也可以使用 .NET。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T16:58:30.490

我有一些世界观的经验。您需要做的第一件事是将它安装在您用于开发的某些机器上。

可能我能给出的最好的建议就是把它排除在外。可能有供应商通过了 UPS 认证。

您正在寻找的东西绝对是可行的，但在一周内开始在实时系统中工作可能是一个挑战。

据我所知，您似乎有正确的想法-您必须设置某种从 worldship 到导入/导出到系统的映射。

如果外包不是一种选择，我会将其分解为几个步骤。

您需要询问您的供应商/远程托运人他们需要您提供什么。然后您需要确定如何从 worldship 获取每个订单。您需要处理这些订单并将它们发送给您的远程托运人，他们需要将其发回给您或上传到 worldship

worldship里面有一些绘图工具，但很麻烦。一旦完成，它就相当简单了。据我所知，他们的技术支持还不错。

再一次，最好的建议是：把这个给一直这样做的人。这将是值得的。

编辑：

对于非常笼统的答案和缺乏细节，我深表歉意。几年前，我只使用了大约 2 周的时间，我记得它是一个巨大的应用程序，加载速度非常慢。它做了很多事情。但我唯一可以肯定地说的就是找一位专家/以前使用过它的人来设置你需要的东西。

您可以自己玩一会儿，但您可能不希望（或准备好）自己很快使用它进入生产系统。*************``