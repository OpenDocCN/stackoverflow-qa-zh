# StackOverflow 问答 12133000-12133999

# security - 升级到 GHC7 后，所有程序突然失败，提示“大多数 RTS 选项已禁用。使用 -rtsopts 链接以启用它们。”

> ID：12133000
> 
> 赞同：7
> 
> 时间：2012-08-26T19:00:24.387
> 
> 标签：security, haskell, ghc

无论命令行参数如何，在升级后的环境中编译的 Haskell 工具都会失败并显示此消息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-26T19:00:24.387

事实证明，RTS 选项可能会带来[安全问题](http://hackage.haskell.org/trac/ghc/ticket/3910)，因此可以在 GHC7 中禁用它们。然后，当将 RTS 选项传递给这样的程序时，它会失败。

问题是我设置了 GHCRTS 环境变量，它被添加到所有 Haskell 程序的 RTS 选项中。清除这个环境变量解决了这个问题。

# android - 将字符串发送到 toast

> ID：12133002
> 
> 赞同：0
> 
> 时间：2012-08-26T19:00:47.647
> 
> 标签：android, toast

我正在尝试读取 CSV 文件并将其显示为 Android 应用程序的基本列表。我正在使用 Kopfgeldjaeger[在此线程中](https://stackoverflow.com/questions/6057695/how-to-parse-the-csv-file-in-android-application)给出的方法。

如果代码管理（或未管理）正确加载 CSV 文件，我添加了几个“祝酒词”，它们在 Android 屏幕底部显示“成功”或“失败”。见下文：

```
 try {
      CSVReader reader = new CSVReader(new InputStreamReader(getAssets().open("file.csv")));
      for(;;) {
          next = reader.readNext();
          if(next != null) {
              list.add(next);
          } else {
              break;
          }
      }
      Toast.makeText(getApplicationContext(), "SUCCESS",
              Toast.LENGTH_SHORT).show();
  } catch (IOException e) {
      e.printStackTrace();
      Toast.makeText(getApplicationContext(), "FAIL",
              Toast.LENGTH_SHORT).show();
  } 
```

当我加载应用程序时，我收到“成功”消息，所以到目前为止一切都很好。现在，我想看看是否可以加载任何数据。在 Kopfgeldjaeger 的回答中，建议我可以使用以下代码访问字符串：

```
list.get(1)[1] 
```

因此，为了检查它是否有效，我尝试生成另一个 toast，如下所示：

```
 Toast.makeText(getApplicationContext(), list.get(1)[1],
              Toast.LENGTH_SHORT).show(); 
```

添加的 toast 会导致程序无法正确加载。问题是，我的 toast 语法错误，还是我的 CSV 文件没有正确加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T19:17:35.737

有几件事需要检查：

1.  确保您的 csv 文件的大小至少为 2 x 2 个条目，否则从行索引 1 和列索引 1 检索数据将不起作用。例如，打印或调试`list.size()`并`list.get(0).length`查看它们是否都至少为 2。
2.  确认您的 csv 文件实际上是*逗号*分隔的，而不是分号分隔的。我见过某些软件似乎选择自己的分隔符的情况。

作为建议：引用的 csv 阅读器是[ByteCode 的 OpenCSV 的](http://opencsv.sourceforge.net/#how-to-read)一部分。您可能希望包含该项目的最新源代码或 jar。它支持自定义分隔符，还提供了将所有 csv 数据解析为字符串数组列表的简写：

```
CSVReader reader = new CSVReader(new FileReader("yourfile.csv"));
List myEntries = reader.readAll(); 
```

# cocoa-touch - 将静态字符串分配给属性，然后释放它是否安全

> ID：12133003
> 
> 赞同：0
> 
> 时间：2012-08-26T19:00:48.213
> 
> 标签：cocoa-touch, ios5, memory-management, modalviewcontroller

我只是在更新我的一个应用程序，我发现了一些让我大吃一惊的旧代码。我的评论通常很冗长，但我没有向自己解释我为什么这样做。

我正在展示一个 ModalView 并更新标题和 UITextField，如下所示：

```
addStoryItem.placeholderText = @"Foo"; //The text is always a static string.
addStoryItem.modalTitleText  = @"Bar"; 
```

在模态中，为这两个值分配了属性：

```
@property (readwrite, assign) NSString *placeholderText;
@property (readwrite, assign) NSString *modalTitleText; 
```

然后在模态被解除后在模态的 dealloc 中释放：

```
[placeholderText release];
[modalTitleText  release]; 
```

这是安全/明智/好吗？我想我可能这样做是为了[避免保留周期](http://cocoawithlove.com/2009/07/rules-to-avoid-retain-cycles.html)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T19:29:15.950

你违反了几条规则：

1.  释放你所拥有的。（你不拥有 assign 属性。你只是侥幸逃脱，因为释放字符串文字是一个 nop）
2.  始终复制 NSString 属性。（分配在这里真的很危险，对象可能会消失。同样，不适用于文字。）

您可以通过避免保留周期来证明这一点。但是由于字符串（通常）不引用其他对象，因此循环在这里不是问题。

# java - 占用内存最少的 Java 对象

> ID：12133004
> 
> 赞同：7
> 
> 时间：2012-08-26T19:00:52.410
> 
> 标签：java, performance, memory, collections

这是一个愚蠢的问题，但它就在这里。

我有一个多线程程序和一个独特元素的“全局”集合。由于性能，我拒绝了 ConcurrentHashMap 的同步 Set 实现。我真的不需要 Map 的 Value 部分，所以我想在内存使用方面使用 java 中最小的 Object。我以不同的方式解决了这个问题（在 Map 中多次引用单个布尔对象），但我仍然很好奇 Java 中最小的对象是什么。我一直认为它是布尔值，但我认为这不是真的（[Java-布尔原始类型-大小](https://stackoverflow.com/questions/1907318/java-boolean-primitive-type-size)，[原始数据类型](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T19:05:43.930

实际上，这并不重要，因为每个关联的值部分都固定为参考。您甚至可以`null`在这里使用 as value，但任何其他（固定）对象引用都应该没问题（有时更方便）。我更喜欢`Boolean.TRUE`（或类似的“众所周知的”单身人士）。然后，您可以通过以下方式测试会员资格

```
if (myMap.get(someKey) != null) { ... } 
```

此外

```
if (myMap.containsKey(someKey)) { ... } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-26T19:09:22.927

如果你想要一个`Set<K>`由 a 支持的 a `ConcurrentHashMap`，你应该使用[`Collections.newSetFromMap`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#newSetFromMap%28java.util.Map%29)，例如

```
final Set<K> set = Collections.newSetFromMap(new ConcurrentHashMap<K, Boolean>()); 
```

* * *

现在，如果你真的想重新发明轮子，并且*非常*关心内存使用情况，我建议你只使用一个 plain`Object`作为你的值。由于 Java 中的每个对象都继承自`Object`（通用基类），**因此内存中任何对象的大小都必须大于或等于 plain 的大小`Object`**。您不能使用原语，因为泛型类型参数必须是`Object`s。

编辑：实际上，在这里分配一个特定对象用作您的值将比使用可能分配给任何情况的预先存在的对象占用更多的内存。您可以只使用对在 VM 初始化期间或多或少*总是*分配的对象的引用，例如`Object.class`. 不过，我**真的**建议您只使用第一个解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-26T20:40:44.520

对象的大小包括：

*   它持有的实例变量的大小
*   一个 8 或 16 字节的标头（取决于 Hotspot VM（32/64 位））
*   填充：它的大小总是填充为 8 字节的倍数。

例如（假设 32 位 JVM）：

```
public MyBoolObject {
  boolean flag;
} 
```

将占用`16 bytes`：（`8bytes`标题）+ `1byte`（实例变量）+ `7bytes`（填充）。
由于您对地图值不感兴趣，因此可以将它们设置为 null。这会消耗`4`或占用`8`堆栈中的内存（32/64 位）。

您还可以查看这个关于众所周知的 Java 数据结构的成本/元素的好列表： [http ://code.google.com/p/memory-measurer/wiki/ElementCostInDataStructures](http://code.google.com/p/memory-measurer/wiki/ElementCostInDataStructures)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T19:05:36.027

原始数据类型不是对象。

由于java中的所有对象都必须继承自超类Object。那么Java中最小的可以想象的对象将是您定义的没有成员的类。这样的课程将毫无用处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T19:10:41.127

该类`Object`是可实例化的，它的实例绝对是 Java 中最小的对象。但是，许多其他对象具有完全相同的占用空间，`Integer`并且`Boolean`是 64 位 VM 上的示例。这是由于堆内存对齐。

# php - compress.zlib 在 xml 字符串的末尾添加符号

> ID：12133006
> 
> 赞同：0
> 
> 时间：2012-08-26T19:01:16.733
> 
> 标签：php, javascript, gzip

我将以下 php 代码编写为：
1\. 下载一个 xml.gz 文件
2\. 解压缩文件并以字符串形式获取内容
3\. 将其保存为 xml 文件。

```
$data = file_get_contents('compress.zlib://'.$url);
file_put_contents($name, $data);
echo file_get_contents($name); 
```

除了一个恼人的错误之外，该代码工作得非常好。它生成的 XML 文件（解压缩后）在其末尾附加了几个符号，例如：

```
 qD�_}7 
```

我需要修复此错误，因为当我在 javascript 中解析此 XML 字符串以转换为 XML 对象时，它会出现以下错误 - “无效 XML”

请就问题提出更正或替代解决方案。

# java - 自定义“字符串”类

> ID：12133010
> 
> 赞同：1
> 
> 时间：2012-08-26T19:01:36.010
> 
> 标签：java, string, stringbuilder

我试图弄清楚java类是如何工作的。

当我创建一个`StringBuilder`：

```
StringBuilder testString = new StringBuilder("Hello World!); 
```

如果我想获取`testSting`包含引用的值，我可以简单地将其称为：`System.out.println(testString);`

这是很酷的行为，但我不确定如何在我制作的课程中复制它。

例如，如果我要尝试重新实现我自己的版本`StringBuilder`，我会采取的方法（作为初学者）是这样的：

```
class MyBuilder {
    char[] string; 

public MyBuilder(String s) {
    string = new char[s.length()];
    string = s.toCharArray();

} 
```

因此，要使字符串成为数组，我必须将其存储在类的数据字段中。但是，要在我的代码中访问它，我不能通过简单地调用变量名来打印它。我将不得不使用`.property`语法。因此，要复制上面的示例，我将不得不输入`System.out.println(testString.value);`“不太漂亮”。

如何在不手动访问数据字段的情况下创建一个类，使其行为类似于`String`or并返回其值？`StringBuilder`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T19:03:27.537

实现一个`toString`方法。

[`toString`](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#toString%28%29)是 on 的一个方法`Object`，所以每个 java 对象都继承一个。您继承的默认实现仅对获取类类型以及区分一个对象和另一个对象有用；格式为：*ClassName@HashCode*。您的实施没有独特的细节。

在您自己的类中，要获得您想要的描述，您需要覆盖该`toString`方法，以便在`String`预期 a 的上下文中，例如当您调用 时`System.out.println(myObject.toString());`，使用您自己的格式。

这样做通常是一个好主意，以便对您的对象进行更易读的描述。您始终可以调用`super.toString`以将默认输出 - *ClassName@HashCode* - 包含在您自己的输出中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:04:27.450

`Object.toString()`您可以在您的对象中覆盖`MyBuilder`。System.out.println 为使用的每个对象调用此方法。例如在这里，您可以使用：

```
@Override
public String toString() {
   return Arrays.toString(string);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T19:06:49.167

覆盖 toString 方法

```
private String value;

public MyClass(String value) {
    this.value = value;
}

public String toString() {
    return value;
} 
```

# azure - azure worker角色可以调用dnn存储过程吗

> ID：12133011
> 
> 赞同：0
> 
> 时间：2012-08-26T19:01:46.883
> 
> 标签：azure, dotnetnuke

我想知道是否可以从 Azure 工作进程将一些数据插入 Dotnetnuke DB。我需要做的是在 DNN 中创建一个用户，因此将插入到 DNN 上的 2 个表中。

那么，如何连接？可能吗？任何示例代码？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T01:32:56.307

所以...*工作进程*在 Windows Server 虚拟机中运行。您只需要连接到数据库并调用适当的存储过程（或执行适当的 T-SQL），就像在任何其他应用程序中一样。您只需要一个具有正确凭据的连接字符串。

请记住：工作角色的所有实例都部署了完全相同的代码。如果您尝试执行导致数据库调用的某种类型的后台处理，只需确保调用仅完成一次（可能通过使用 Azure 队列编写创建用户的请求，然后读取所有工作实例从队列中取出消息，然后收到消息的人创建新帐户）。

# html - 如何摆脱css上无用的滚动空间

> ID：12133015
> 
> 赞同：0
> 
> 时间：2012-08-26T19:02:22.277
> 
> 标签：html, css

好的，这是我的第一个 html/css/javascript 网站。我不确定出了什么问题，基本上我使用 css 使背景图像适合，然后我尝试使用添加图像链接

```
 <div id="project_button" style="position:relative; top: 1000px; left: 1000px" > 
```

结果是水平滚动条上有 1000 像素的滚动空间。当我尝试编辑位置时有类似的结果

```
 margin-left:1000px
    margin-top: 1000px 
```

除了它将是具有额外空间的垂直滚动条。

```
 <html>
          <head>
          <title>Home Page</title>
          <head>
          <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
          <meta http-equiv="Imagetoolbar" content="no">
          <SCRIPT LANGUAGE="JavaScript">
          <!--

          if (document.images) {

          var button1_up = new Image();
          button1_up.src = "project1.gif";

          var button1_over= new Image();
          button1_over.src = "project2.gif";
          }

          function over_button(){
           if (document.images) {
       document["buttonOne"].src = button1_over.src
      }
    }

          function up_button() {
               if (document.images) {
               document["buttonOne"].src = button1_up.src
          }
    }
    //-->
    </SCRIPT>
    <style type="text/css">
    html {height:100%;}

    body {height:100%; margin:0; padding:0;}

    #bg {position:fixed; top:0; left:0; width:100%; height:100%;}

    </style>
    <!--[if IE 6]>
    <style type="text/css">
    html {overflow-y:hidden;}
    body {overflow-y:auto;}
    #bg {position:absolute;
    padding-right:800px;
    margin-right:-800px;}

    #project_button {position:static;}
    </style>
    <![endif]-->
    </head>
    <body>
          <div id="page1" style='position: relative'>   
      <div id="bg"><img src="WebBacking.jpg" width="100%" height="100%" alt="">
          </div>
      <div id="project_button" style="position:relative; top: 1000; left: 1000" >
        <a href="projects.html" onMouseOver="over_button()"
                 onMouseOut="up_button()">
        <img src="project1.gif" alt="click me" 
        width="1800" height="200" name="buttonOne" 
        border=0>
        </a>
      </div>
          </div>

    </body>
    </html> 
```

这是我的代码的其余部分。任何帮助表示赞赏。

顺便说一句，当我垂直或水平滚动时，背景仍然适合，但由于图像的位置是静态的，它在滚动时会移动。我还应该提到，当我设置

```
 top: 0; left:0; 
```

滚动条被移除。这也适用于最高利润。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:06:42.230

如果您根本不想在某些元素中添加滚动条，请添加`overflow:hidden`到 css。这样，元素外的所有内容都将被剪裁，并且没有滚动条可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:10:46.630

也试试`overflow:auto`。仅在内容溢出时显示滚动条。

# html - 甚至影响无文本块的行高

> ID：12133024
> 
> 赞同：5
> 
> 时间：2012-08-26T19:03:58.503
> 
> 标签：html, css

我注意到 line-height 似乎会影响块。这对我来说很奇怪，我以前从未注意到这种令人不安的影响。

问题是它会影响块，即使它们根本不包含文本。

我[创建了一个 JSFiddle](http://jsfiddle.net/ATqRe/)来演示这个问题。如果将 line-height 设置为 0，灰色区域将不再超过容器内图像的灰色区域。

为什么会发生这种情况，有没有一种干净的方法来防止它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-26T19:25:57.987

即使没有文本，该`line-height`值也会影响渲染，因为“'line-height' 指定元素内行框的最小高度。最小高度由基线上方的最小高度和基线下方的最小深度组成，就像每个行框都以具有元素字体和行高属性的零宽度行内框开始一样。” （[CSS 2.1 关于`line-height`](http://www.w3.org/TR/CSS2/visudet.html#propdef-line-height)。）

但这真的不是这里的原因。默认情况下，图像是内联渲染的，这意味着它们充当大（或者可能是小）字母，位于文本的基线上。细节很复杂，但通过设置`line-height`比字体大小小得多，您可以将基线彼此靠近并且空间消失。

另一种消除干扰效果的方法是`display: block`在`img`元素上设置。然后元素将以不同的方式格式化。

还有一种方法是`vertical-align: bottom`在`img`元素上设置。

# algorithm - 亚马逊面试问题

> ID：12133026
> 
> 赞同：14
> 
> 时间：2012-08-26T19:04:03.760
> 
> 标签：algorithm

有一个大文件是动态变化的。我们不断地在其中添加一些词。您将如何跟踪每时每刻的前 10 个热门词汇？

我在博客中发现了这个问题，但我无法理解答案。答案是：hash table + min-heap

我明白为什么哈希表而不是最小堆部分，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T05:38:02.393

如果是，`top 10 trending words`那么您应该使用 a`max-heap`和 a `hash-table`。

当一个新词被添加到文件中时：

*   `Create``x`一个带有`x.key=word`和的新元素`x.count=1`。
*   `Add` `x`到`hash-table`. `O(1)`.
*   `Add` `x`到`max-heap`. `O(lgn)`.

当现有单词添加到文件中时：

*   `Find` `x`在`hash-table`. `O(1)`.
*   `Update` `x.count`到`x.count++`.

当需要检索`top 10 trending words`then 时：

*   `Extract`从 10 次`max-heap`。`10*O(lgn)=O(10*lgn)=O(lgn)`.

如您所见，所有需要的操作最多在`O(lgn)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T07:05:20.473

如果你只想保持前 10 名，那么使用最大堆就大材小用了。将 10 个条目保存在有序数组中会更简单、更快。

对于排序，只需使用从数组底部开始的插入排序。如果需要，您将必须检查候选人已经进入前十名并更新其位置的情况。

# javascript - 数组排序问题

> ID：12133029
> 
> 赞同：1
> 
> 时间：2012-08-26T19:04:24.033
> 
> 标签：javascript, jquery

我正在学习 javascript，但无法在下面的代码中找出问题所在。我想我误解了数组的实际工作方式。

问题是警报数组实际上没有排序。如果您对此有任何见解，我将不胜感激：

[这是一个现成的 jsFiddle](http://jsfiddle.net/F7Rbr/6/)。

HTML：

```
<html>
  <head>
    <title>
      Test 1
    </title>
    <script src="http://code.jquery.com/jquery-latest.js" type=
    "text/javascript">
</script>
  </head>
  <body>
    <div class="items">
      <ul>
        <li>
          <a href="#" id="1">Link 1</a>
        </li>
        <li>
          <a href="#" id="2">Link 2</a>
        </li>
        <li>
          <a href="#" id="3">Link 3</a>
        </li>
        <li>
          <a href="#" id="4">Link 4</a>
        </li>
      </ul>
    </div>
</body>
</html> 
```

Javascript：

```
var clickedLinks = [];
var passedItems = [];

// Collect clicked link IDs into an array and pass the array as an argument to shoplist()
$('.items a').click(function () {

if (clickedLinks.indexOf(this.id) != -1) {
    var linkIndex = clickedLinks.indexOf(this.id);
    clickedLinks.splice(linkIndex, 1);
} else {
    clickedLinks.push(this.id);
}

shoplist(clickedLinks);

});

function shoplist(ids) {
    passedItems.push(ids.slice());
    alert(passedItems.sort());
} 
```

**重现步骤：**

1.  点击链接 2
2.  点击链接 1

**预期结果：** 1、2、2

**实际结果：** 2、2、1

**我尝试过的事情：**

```
function shoplist(ids) {
    passedItems.push(ids.slice());
    var newpi = passedItems.slice();
    alert(newpi.sort());
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:08:51.157

我认为您使用错误的[排序功能](http://www.w3schools.com/jsref/jsref_sort.asp)。如果要以数字方式使用排序函数，则必须包含排序函数。如果你想对事物进行数字排序，你应该使用这个函数（在链接中提供）：

```
(function(a,b){return a-b}); 
```

因此，在您的 newpi 场景中，它看起来像这样：

```
newpi.sort(function(a,b){return a-b}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:10:54.513

您正在向另一个数组添加一个数组，即 , 的结果`ids.slice()`。这就是为什么排序不能按预期工作的原因。`concat`如果要将 的内容添加`ids`到`passedItems`数组中，请改用：

```
passedItems = passedItems.concat(ids); 
```

`ids`此外，您应该使用而不是向数组添加字符串`.push(parseInt(this.id))`，然后使用：

```
passedItems.sort(function (a, b) {
  return a - b;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T19:15:12.573

我希望这会奏效：

[http://jsfiddle.net/DZpDG/4/](http://jsfiddle.net/DZpDG/4/)

# java - 保存更新的野外游戏框架

> ID：12133032
> 
> 赞同：0
> 
> 时间：2012-08-26T19:04:37.900
> 
> 标签：java, playframework, playframework-1.x

这是一个非常基本的问题，但我似乎无法解决/找出问题，所以希望一些新的眼睛可以提供帮助。

我有一个具有用户名和密码的模型用户。我想允许用户更新他们的密码，所以我添加了 update() 方法，如下所示：

```
public static void update(User user) throws UserException {
    User record = User.getById(user.id);
    if (null == record) {
        throw new UserException(BaseException.invalidRecordMessageException(User.class.getSimpleName()));
    }

    if (!StringUtils.equals(record.username, user.username)) {
        throw new UserException(BaseException.unmodifiableFieldMessageException(User.class.getSimpleName(), "username"));
    }
    validatePassword(user.password);
    saveUser(user);
} 
```

这是我的 saveUser()：

```
private static void saveUser(User user) {
    user.password = encryptPassword(user.password);
    user.save();
    System.out.println("n: " + user.id);
    System.out.println("n: " + user.username);
    System.out.println("n: " + user.password);

    User r = User.getById(user.id);
    System.out.println("r: " + r.id);
    System.out.println("r: " + r.username);
    System.out.println("r: " + r.password);
} 
```

我添加了一个测试以确认该功能运行良好。

```
@Test
public void testUpdateUserPasswordWithValidPasswordShouldUpdateRecord() {
    try {
        User dummy = new User(DEFAULT_USERNAME, DEFAULT_RAW_PASSWORD);
        User.create(dummy);

        assertNotNull(dummy.id);
        User record = User.getById(dummy.id);
        assertEquals(DEFAULT_USERNAME, record.username);
        assertEquals(DEFAULT_RAW_PASSWORD, record.password);

        dummy.password = DEFAULT_RAW_PASSWORD + "_extra";
        User.update(dummy);

        User updatedRecord = User.getById(dummy.id);
        assertEquals(dummy.username, updatedRecord.username);
        assertEquals(dummy.password, updatedRecord.password);
    } catch (UserException ue) {
        fail("Test should not throw exception.");
    }
} 
```

但是，测试失败，因为记录似乎没有更新：

```
Test UserTest.testUpdateUserPasswordWithValidPasswordShouldUpdateRecord failed: expected:<$uP3rsecretpassword[_extra]> but was:<$uP3rsecretpassword[]> 
```

DEFAULT_PASSWORD = $uP3rsecretpassword

这是所有 System.out.println() 调用的输出：

--- 初始创建 ---
n: 1

n: 哞

n: $uP3rsecretpassword

r: 1

r: 哞

r: $uP3rsecretpassword

- - 更新 - -

n: 1

n: 哞

n: $uP3rsecretpassword_extra

r: 1

r: 哞

r: $uP3rsecretpassword

提前感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T19:45:32.447

我相信问题出在这一行：

```
 User record = User.getById(user.id); 
```

Hibernate 只保留*一个*特定 id 的对象。因此，在这里，您有效地用`user`数据库中当前的（旧）状态覆盖了对象中包含的更改。

至于您在那里进行的检查，无论如何它们似乎有点多余，因为您不信任自己的代码。

# visual-studio-2010 - Visual Studio：定义文件类型而不考虑文件扩展名

> ID：12133034
> 
> 赞同：2
> 
> 时间：2012-08-26T19:04:42.327
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012

在哪里定义，**Visual Studio 解决方案中特定文件的类型是什么？**

我观察到文件扩展名不一定与 VS 中的实际文件类型相关（在 Visual Studio 2010、2012 中观察到）。

例如：我有一个现有的 Visual Studio 解决方案。在另一个工具中，我创建了一个扩展名为 .html 的 HTML 文件。将其导入 Visual Studio 解决方案后，该文件无法获得 HTML 智能感知和代码完成功能。

另一方面，我可以通过以下方式在 Visual Studio 中创建 HTML 文件：**Visual Studio -> 文件 -> 新文件 -> HTML 页面**

该文件将获得其所有与 HTML 相关的代码高亮、智能感知和代码完成功能。然后我可以将其扩展名重命名为 .txt。该文件仍将保留其 HTML 属性，例如代码突出显示、智能感知等。

因此，我的问题是，我可以在哪里定义/更改特定文件的文件类型（HTML、CSS、JavaScript），无论其扩展名如何？这很重要，以便能够分配适当的智能感知、代码突出显示、代码完成功能。

# sql-server - SQL Server 插入性能

> ID：12133037
> 
> 赞同：1
> 
> 时间：2012-08-26T19:05:17.827
> 
> 标签：sql-server, database-performance, clustered-index, insert-statement, database-fragmentation

假设我有下表，列上有一个聚集索引（比如，a）

```
CREATE TABLE Tmp
(
    a int,
    constraint pk_a primary key clustered (a)
) 
```

然后，假设我有两组非常多的行要插入到表中。

*   第一组）值顺序增加（即，{0,1,2,3,4,5,6,7,8,9,..., 999999997, 999999998, 99999999}）
*   第二组）值按顺序递减（即 {99999999,999999998,999999997, ..., 3,2,1,0}

你认为在第一组和第二组中插入值会有性能差异吗？如果是这样，为什么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T21:43:22.543

SQL Server 通常会在插入之前尝试将大型插入排序为聚集索引顺序。

但是，如果插入的源是表变量，那么它将不考虑基数，除非在填充表变量后重新编译语句。如果没有这个，它将假设插入只会是一行。

下面的脚本演示了三种可能的情况。

1.  插入源的顺序已经完全正确。
2.  插入源的顺序正好相反。
3.  插入源的顺序正好相反，但`OPTION (RECOMPILE)`使用它是为了让 SQL Server 编译一个适合插入 1,000,000 行的计划。

### 执行计划

[![计划](../Images/76f499f8f3afd0bd9c2bbf275ebd41cd.png)](https://i.stack.imgur.com/T9k6m.jpg)

第三个有一个排序运算符，可以首先将插入的值按聚集索引顺序排列。

```
/*Create three separate identical tables*/
CREATE TABLE Tmp1(a int primary key clustered (a))
CREATE TABLE Tmp2(a int primary key clustered (a))
CREATE TABLE Tmp3(a int primary key clustered (a))

DBCC FREEPROCCACHE;

GO

DECLARE @Source TABLE (N INT PRIMARY KEY (N ASC))

INSERT INTO @Source
SELECT TOP (1000000) ROW_NUMBER() OVER (ORDER BY (SELECT 0)) 
FROM sys.all_columns c1, sys.all_columns c2, sys.all_columns c3

SET STATISTICS TIME ON;

PRINT 'Tmp1'
INSERT INTO Tmp1
SELECT TOP (1000000) N
FROM @Source
ORDER BY N

PRINT 'Tmp2'
INSERT INTO Tmp2
SELECT  TOP (1000000) 1000000 - N
FROM @Source
ORDER BY N

PRINT 'Tmp3'
INSERT INTO Tmp3
SELECT 1000000 - N
FROM @Source
ORDER BY N
OPTION (RECOMPILE)

SET STATISTICS TIME OFF; 
```

### 验证结果并清理

```
SELECT object_name(object_id) AS name, 
       page_count, 
       avg_fragmentation_in_percent, 
       fragment_count, 
       avg_fragment_size_in_pages
FROM 
sys.dm_db_index_physical_stats(db_id(), object_id('Tmp1'), 1, NULL, 'DETAILED') 
WHERE  index_level = 0 
UNION ALL 
SELECT object_name(object_id) AS name, 
       page_count, 
       avg_fragmentation_in_percent, 
       fragment_count, 
       avg_fragment_size_in_pages
FROM 
sys.dm_db_index_physical_stats(db_id(), object_id('Tmp2'), 1, NULL, 'DETAILED') 
WHERE  index_level = 0 
UNION ALL 
SELECT object_name(object_id) AS name, 
       page_count, 
       avg_fragmentation_in_percent, 
       fragment_count, 
       avg_fragment_size_in_pages
FROM 
sys.dm_db_index_physical_stats(db_id(), object_id('Tmp3'), 1, NULL, 'DETAILED') 
WHERE  index_level = 0 

DROP TABLE Tmp1, Tmp2, Tmp3 
```

### `STATISTICS TIME ON`结果

```
+------+----------+--------------+
|      | CPU Time | Elapsed Time |
+------+----------+--------------+
| Tmp1 | 6718 ms  | 6775 ms      |
| Tmp2 | 7469 ms  | 7240 ms      |
| Tmp3 | 7813 ms  | 9318 ms      |
+------+----------+--------------+ 
```

### 分片结果

```
+------+------------+------------------------------+----------------+----------------------------+
| name | page_count | avg_fragmentation_in_percent | fragment_count | avg_fragment_size_in_pages |
+------+------------+------------------------------+----------------+----------------------------+
| Tmp1 |       3345 | 0.448430493                  |             17 | 196.7647059                |
| Tmp2 |       3345 | 99.97010463                  |           3345 | 1                          |
| Tmp3 |       3345 | 0.418535127                  |             16 | 209.0625                   |
+------+------------+------------------------------+----------------+----------------------------+ 
```

### 结论

在这种情况下，他们三个最终都使用了完全相同的页数。然而`Tmp2`，99.97% 是分散的，而其他两个只有 0.4%。插入`Tmp3`花费的时间最长，因为这首先需要一个额外的排序步骤，但是需要根据未来扫描最小碎片表的好处来设置这一时间成本。

`Tmp2`从下面的查询中可以看出碎片如此严重的原因

```
WITH T AS
(
SELECT TOP 3000 file_id, page_id, a
FROM Tmp2
CROSS APPLY sys.fn_PhysLocCracker(%%physloc%%)
ORDER BY a
)
SELECT file_id, page_id, MIN(a), MAX(a)
FROM T 
group by file_id, page_id
ORDER BY MIN(a) 
```

在逻辑碎片为零的情况下，具有下一个最高键值的页面将是文件中的下一个最高页面，但这些页面的顺序与它们应该是完全相反的。

```
+---------+---------+--------+--------+
| file_id | page_id | Min(a) | Max(a) |
+---------+---------+--------+--------+
|       1 |   26827 |      0 |    143 |
|       1 |   26826 |    144 |    442 |
|       1 |   26825 |    443 |    741 |
|       1 |   26824 |    742 |   1040 |
|       1 |   26823 |   1041 |   1339 |
|       1 |   26822 |   1340 |   1638 |
|       1 |   26821 |   1639 |   1937 |
|       1 |   26820 |   1938 |   2236 |
|       1 |   26819 |   2237 |   2535 |
|       1 |   26818 |   2536 |   2834 |
|       1 |   26817 |   2835 |   2999 |
+---------+---------+--------+--------+ 
```

行以降序到达，因此例如值 2834 到 2536 被放入页面 26818，然后为 2535 分配一个新页面，但这是页面 26819 而不是页面 26817。

`Tmp2`插入时间比插入时间长的一个可能原因`Tmp1`是，由于行在页面上以完全相反的顺序插入，因此每次插入`Tmp2`意味着页面上的插槽数组需要重写，所有先前的条目都向上移动以腾出空间新品到货。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T19:24:36.880

要回答这个问题，您只需要查看聚类对数据的影响以及数据的逻辑排序方式。通过升序聚类，更高的数字被添加到表格的末尾；插入会非常快。反向插入时，会插入另外两条记录之间（分页时阅读）；这将导致插入速度变慢。这实际上还有其他负面影响（阅读填充因子）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:13:54.590

它与按顺序分配页面有关，就像对聚集索引所做的那样。有了第一个，他们自然会聚集在一起。但在第二种情况下，我认为您必须不断移动页面位置才能使它们按顺序上升。但是，我真的只在概念层面上了解 SQL Server，因此您必须进行测试。

# php - 向数据库添加一些数据后，php 更新代码非常慢？

> ID：12133038
> 
> 赞同：0
> 
> 时间：2012-08-26T19:05:18.543
> 
> 标签：php, performance

我有一个足球奇幻联赛的 php 脚本，有 20 支球队和 400 多名球员分配给球队，我有 500 个用户。

每周应该为每个球员分配一个积分，这样最终每个用户都会从他的阵型中获得一个总分，这将产生赛季的排名。

第一周点数正常添加，但第二周点数的 addpont 部分变得如此缓慢，第三周点数出现套接字超时错误。

这是我在向用户添加积分时使用的代码：

```
// Adding Point To the user player list
$sql_user="select * from ".$prev."user LIMIT 0, 100 ";  

$re_user=mysql_query($sql_user);  
while($d_user=mysql_fetch_array($re_user))  
{  
$userID=$d_user['id'];  

  $sql_addpointgroup="select * from ".$prev."addpoint group by weekno order by weekno";  
  $re_addpointgroup=mysql_query($sql_addpointgroup);  
  while($d_addpointgroup=mysql_fetch_array($re_addpointgroup))  
  {     
      $points=0;  
      $sql_addpoint="select * from ".$prev."addpoint where   weekno='".$d_addpointgroup['weekno']."'";  
      $re_addpoint=mysql_query($sql_addpoint);  
      while($d_addpoint=mysql_fetch_array($re_addpoint))  
      {  
        $points=$d_addpoint['points'];  
        $sql_weekstatistic="select * from ".$prev."weekstatistic where   weekno='".$d_addpointgroup['weekno']."' and userID='$userID' and playerID='".$d_addpoint['playerID']."'";  
        $re_weekstatistic=mysql_query($sql_weekstatistic);  
        if(mysql_num_rows($re_weekstatistic)>0)  
        {  
            $sql_update="update ".$prev."weekstatistic set points='$points' where weekno='".$d_addpointgroup['weekno']."' and userID='$userID' and playerID='".$d_addpoint['playerID']."'";  

            mysql_query($sql_update);  
        }  
      }  
}     
} 
```

我已将每次提交的用户数量限制为 100 个用户，即便如此代码仍然很慢。

缓慢仅与此代码有关，其他网站部分正常工作。

有没有办法以其他更快的方式编写代码，或者我还能做些什么？

提前谢谢了，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:41:32.590

```
select * from 
```

我希望您知道Query`*`中的含义。`SELECT`这意味着`ALL COLUMNS`。您不需要每行所有列的值。在您的查询中具体并仅选择您需要的列。

例如，这个查询：

```
$sql_weekstatistic="select * from ".$prev."weekstatistic where   weekno='".$d_addpointgroup['weekno']."' and userID='$userID' and playerID='".$d_addpoint['playerID']."'"; 
```

您已经拥有以下价值：

```
weekno @ $d_addpointgroup['weekno']
userID @$userID
playerID @$d_addpoint['playerID'] 
```

基于其他查询。

但是，您仍然使用`SELECT * FROM`.

这是我关于性能和 SQL 的小技巧。

顺便说一句，按照@lshikawa 的建议，使用`mysql_real_escape_tring()`, 或 ，甚至更好地移动到`mysqli`或来保护您的查询。`PDO`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:40:16.477

除了建议您遵循此线程中其他人的建议外，我不会提及 SQL 注入的问题。说真的 - 如果您要求人们提交个人数据以存储在您的数据库中，您应该保护他们不让这些数据被盗。

您的过程缓慢的原因可能是双重的。

首先，当只需要一个查询时，您使用了 5 个查询。您正在向数据库询问您用来向其提出更多问题的大量数据 - 在不了解您的架构的情况下，很难为您提供有效的替代品，但类似于：

```
update ".$prev."weekstatistic 
set      points   = ap.points 
from     weekstatistic ws, 
         addpoint      ap, 
         user          u
where    weekno   = //work out the current weeknumber 
and      userID   = u.userID 
and      playerID = ap.playerID' 
```

这应该实现相同，但仅在一个查询中；那应该快得多。

其次，您的表上可能没有正确的索引 - 这是“当我在我的表中获得更多数据时，我的查询变得更慢”的典型原因。阅读 EXPLAIN，并添加一些索引。

# objective-c - 需要在 ARC 中发布子视图吗？

> ID：12133042
> 
> 赞同：0
> 
> 时间：2012-08-26T19:05:41.397
> 
> 标签：objective-c, xcode, automatic-ref-counting

如果在 XCode 中创建一个使用 ARC 的 UIViewController，`viewDidUnload:`方法定义如下：

```
- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
} 
```

如果随后在 XIB 中创建一个按钮，则此代码会自动插入到方法的顶部：

```
[self setSomeButton:nil]; 
```

ARC是否需要这些代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:12:24.023

这不受 ARC 的影响。您仍然必须将强大的 IBOutlets 设置为 nil。

不过，它受 iOS 6 的影响。但这目前处于保密协议之下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T19:17:42.893

重要的是要记住，在大多数情况下，`viewDidUnload`永远不会调用。根据我的经验，只有当您的 VC 在导航堆栈中“高于”当前 VC 并且不在屏幕上**并且**内存不足时才会调用它。

据我了解，Apple 将代码放在那里是为了*提醒*您在这种情况下您的子视图*已经消失*。

请注意，他们没有将该代码放入 中`dealloc`，因为（正如您正确假设的那样）ARC*确实*为您负责清理工作（因为这些通常是*弱*指针）

# javascript - Javascript随机显示/隐藏不起作用

> ID：12133048
> 
> 赞同：0
> 
> 时间：2012-08-26T19:06:06.350
> 
> 标签：javascript, html, hide, show

我正在使用这个 javascript/jquery 来隐藏我的页面的一部分并显示一个新的部分。它昨天工作，然后我今天来了，它不工作。我进行了一些编辑，例如添加“下雪”javascript，以及通过单击按钮更改背景颜色的 javascript 代码，但我删除了我更改的所有内容，但它仍然无法正常工作......这是我的全部代码...

```
<html><head>

     <script src="http://code.jquery.com/jquery-latest.js"></script>
        <link href="http://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" type="text/css" >
<script type="text/javascript"> <!-- Hides something then shows something. -->
function friedrice(id, id2) {
     $('#' + id).hide(); 
     $('#' + id2).show(); 

}
</script>

<script type="text/javascript"> <!-- Show stuff with fade in -->
    function showStuff(id) {
        document.getElementById(id).style.display = 'block';
object = document.getElementById(id)

$(object).hide();
        $(object).fadeIn(1000);
    }
</script>

<script type="text/javascript"> <!-- Hides hidden stuff on load -->

$(document).ready(function(){ 
    $('#swf').hide(); 
    $('#surprise').hide();
}); 

</script>

<script type="text/javascript"> <!-- Shows stuff -->
function katana(id) {
     $('#' + id).show();

}
</script>

<script type="text/javascript"> <!-- Popup on exit -->
function box()
{
var r=confirm("Content") 
if (r==true)
  {
  window.location.href="russia.html";
  }
else
  {
  window.location.href="china.html";
  }
}
</script>

</head>
    <body onunload="box()";
    <div id="chopsticks"> <!-- This is the "main" content that is displayed before the last checkbox is checked -->
    <OBJECT id="swf" style="z-index:2; position:absolute; top:20%; left:15%;" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" WIDTH="90%" HEIGHT="70%" id="rice" ALIGN=""><PARAM NAME=movie VALUE="rice.swf"><PARAM NAME=quality VALUE=low><EMBED src="rice.swf" quality=low bgcolor=#EEEEEE WIDTH="90%" HEIGHT="90%" NAME="rice" ALIGN="" TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED> </OBJECT>

<center><h1>Logo Here!</h1><br>
</center>
                    <span id="a1" style="display: block;"><div class="texts" >
                                    <div class="title" >
                    <strong>Step 1</strong><br><br>
                </div>

<div class="rice">Content<br></div>
<label class="label_check" >
    <input name="sample_check1" id="sample_check1" value="1" type="radio" onclick="showStuff('a2')"  />
Done?
    </label></div></span>
<br>
                    <span id="a2" style="display: none;"><div class="texts">

                                    <div class="title" >
                    <strong>Step 2</strong><br><br>
                </div>

<div class="rice">Content<br></div>
<label class="label_check" >
    <input name="sample_check2" id="sample_check2" value="1" type="radio" onclick="showStuff('a3');" />
Done?
    </label>
                </div></span>
<br>
                    <span id="a3" style="display: none;"><div class="texts">

                                    <div class="title" >
                    <strong>Step 3</strong><br><br>
                </div>
                    <div class="rice">Content<br></div>
<label class="label_check" >
    <input name="sample_check3" id="sample_check3" value="1" type="radio" onclick="showStuff('stage');setTimeout(katana, 10000, 'swf');setTimeout(friedrice, 12000, 'chopsticks', 'surprise');" /> <!-- The showStuff function will show an image with a fade in. The katana function will show the swf, then 2 seconds later, the "friedrice" function will remove all of the the content on the page including the swf and show new "surprise" content. -->
Ready?
    </label>
                </div></span>

        <span id="stage" style="display:none;">
            <img src="images/dot.png" style=" position:absolute; left:44%; top:20%;"/>
        </span>

                    <script>
        $('body').hide();
        $('body').fadeIn(1000);
    </script>
</div>
<div id="surprise"> <!-- This is the "hidden" content that is displayed 12 seconds after the checkbox is checked -->
<center>
<p> i jo</p>
<embed src="scare.mp3" autoplay="true" loop="true" height="240" width="100" /></embed>
</div>
</center>
</body></html> 
```

这没有css，因为我认为没有必要。对重要部分进行了注释。请原谅草率和变量、函数等的名称。我通常不会把我的代码给出 xD。但我不知道发生了什么，我改变了一切，我改变了。希望有人可以提供帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:14:24.287

之后有一个`;`缺失`object = document.getElementById(id)`：

```
<script type="text/javascript"> <!-- Show stuff with fade in -->
   function showStuff(id) {
      document.getElementById(id).style.display = 'block';
      object = document.getElementById(id);
                                //this one^
      $(object).hide();
      $(object).fadeIn(1000);
}
</script> 
```

var在退出部分的弹出窗口`r=confirm("Content")`中也缺少 a`;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T19:10:12.483

尝试进入浏览器设置并清除缓存，这可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-10T11:26:22.463

我已经更改了您的一些代码，现在我没有收到错误消息：

```
<html>
<head>
<title>Page title</title>
<link href="http://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" type="text/css" >

<script src="http://code.jquery.com/jquery-latest.js"></script>

<script type="text/javascript"> <!-- Hides something then shows something. -->
function friedrice(id, id2) {
     $('#' + id).hide(); 
     $('#' + id2).show(); 
}
</script>

<script type="text/javascript"> <!-- Show stuff with fade in -->
function showStuff(id) {
    document.getElementById(id).style.display = 'block';
    object = document.getElementById(id)

    $(object).hide();
        $(object).fadeIn(1000);
    }
</script>

<script type="text/javascript"> <!-- Hides hidden stuff on load -->
$(document).ready(function(){ 
    $('#swf').hide(); 
    $('#surprise').hide();
}); 
</script>

<script type="text/javascript"> <!-- Shows stuff -->
function katana(id) {
    $('#' + id).show();
}
</script>

<script type="text/javascript"> 
function box(){ 
    var r = window.confirm("Content");
    if(r==true){
        window.location.href="russia.html";
    }
    else{
        window.location.href="china.html";
    }
}
</script>

</head>
    <body onUnload="box">
    <div id="chopsticks"> <!-- This is the "main" content that is displayed before the last checkbox is checked -->
    <OBJECT id="swf" style="z-index:2; position:absolute; top:20%; left:15%;" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" WIDTH="90%" HEIGHT="70%" id="rice" ALIGN=""><PARAM NAME=movie VALUE="rice.swf"><PARAM NAME=quality VALUE=low><EMBED src="rice.swf" quality=low bgcolor=#EEEEEE WIDTH="90%" HEIGHT="90%" NAME="rice" ALIGN="" TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED> </OBJECT>

<center><h1>Logo Here!</h1><br>
</center>
                    <span id="a1" style="display: block;"><div class="texts" >
                                    <div class="title" >
                    <strong>Step 1</strong><br><br>
                </div>

<div class="rice">Content<br></div>
<label class="label_check" >
    <input name="sample_check1" id="sample_check1" value="1" type="radio" onclick="showStuff('a2')"  />
Done?
    </label></div></span>
<br>
                    <span id="a2" style="display: none;"><div class="texts">

                                    <div class="title" >
                    <strong>Step 2</strong><br><br>
                </div>

<div class="rice">Content<br></div>
<label class="label_check" >
    <input name="sample_check2" id="sample_check2" value="1" type="radio" onclick="showStuff('a3');" />
Done?
    </label>
                </div></span>
<br>
                    <span id="a3" style="display: none;"><div class="texts">

                                    <div class="title" >
                    <strong>Step 3</strong><br><br>
                </div>
                    <div class="rice">Content<br></div>
<label class="label_check" >
    <input name="sample_check3" id="sample_check3" value="1" type="radio" onclick="showStuff('stage');setTimeout(katana, 10000, 'swf');setTimeout(friedrice, 12000, 'chopsticks', 'surprise');" /> 
Ready?
    </label>
                </div></span>

        <span id="stage" style="display:none;">
            <img src="images/dot.png" style=" position:absolute; left:44%; top:20%;"/>
        </span>

                    <script>
        $('body').hide();
        $('body').fadeIn(1000);
    </script>
</div>
<div id="surprise"> <!-- This is the "hidden" content that is displayed 12 seconds after the checkbox is checked -->
<center>
<p> i jo</p>
<embed src="scare.mp3" autoplay="true" loop="true" height="240" width="100"></embed>
</div>
</center>
</body></html> 
```

# jquery - 如何获得 2 个元素（中点）之间的距离？

> ID：12133049
> 
> 赞同：3
> 
> 时间：2012-08-26T19:06:12.413
> 
> 标签：jquery, math

我需要你的帮助！我在它们之间放置了随机数量的 div。

```
<div id="items">
    <div class="item">Item description</div>
    <div class="item">Item description</div>
    <div class="item">Item description</div>
    <div class="item">Item description</div>
</div> 
```

每个都有不同的高度，我必须计算它们之间的距离。距离每个项目的每个中间点非常重要。

提前致谢！

也许我的形象会比我可怕的英语解释得更好:) ![在此处输入图像描述](../Images/8383777a87c53477ce6c38dfc91ce04e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T19:10:15.013

你可以试试`offset`方法：

```
var $items = $('.item');
var fh = $items.eq(0).height();
var sh = $items.eq(1).height();
var first = $items.eq(0).offset().top + fh;
var two = $items.eq(1).offset().top;

var distance  = (two - first) + (fh/2) + (sh/2) ; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T19:24:50.360

天啊！有时它比您想象的要容易！

```
var currentCenterPoint = $('.current').outerHeight() / 2;
var nextCenterPoint = $('.current').next().outerHeight() / 2;

var amount = (currentCenterPoint + nextCenterPoint); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T19:22:05.530

而不是`<div>`尝试`<ul>`使用`<li>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T19:31:13.063

## *[jsBin 演示](http://jsbin.com/imefon/2/edit)*

```
$('.item').each(function(){

  if( $(this).next().is('.item') ){    
       var myHalf = $(this).outerHeight(true)/2;
       var nextHalf = $(this).next('.item').outerHeight(true)/2;
       $(this).text('distance in between: '+ (myHalf+nextHalf) ); // TEST  
  }

}); 
```

# java - 检索数据库中超过 5 分钟的元素

> ID：12133060
> 
> 赞同：0
> 
> 时间：2012-08-26T19:07:39.167
> 
> 标签：java

我正在使用播放框架版本 1.2.5，我想检索所有 5 分钟内未更新会话的连接用户，然后我想将他们的连接状态设置为“断开连接”。

这是我的模型：

```
@Entity
public class User extends Model {

    @Required
    public String name;

    public boolean isConnected;

    public Date lastConnectionDate;

} 
```

这是更新用户的作业：

```
Date fiveMinsAgo = new Date(new Date().getTime() - 5 * 60);
List<User> list = User.find("select u from User u where u.isConnected = true and u.lastConnectionDate < ?", fiveMinsAgo).fetch();

for (User user : list) {
    // We set these accounts as disconnected
    user.isConnected = false;
    user.save();
} 
```

此代码似乎不起作用。即使用户的*lastConnectionDate*不早于 5 分钟前，用户也被设置为“断开连接”。我做错什么了吗 ？

有没有更好的方法/代码来做我想做的事？（如 UPDATE 命令）

感谢您的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T19:13:32.007

Date.getTime() 返回毫秒。

试试这个：

```
Date fiveMinsAgo = new Date(new Date().getTime() - 5 * 60 * 1000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T19:15:19.080

Use the [Joda](http://joda-time.sourceforge.net/) time library. It avoids errors such as yours: `5 * 60` are 300 milliseconds. The time you are looking for would be something like `new DateTime().plusMinutes(-5)`.

# linux - 使用 *nix 中的 column 命令格式化列表

> ID：12133062
> 
> 赞同：14
> 
> 时间：2012-08-26T19:08:04.593
> 
> 标签：linux, bash, shell, unix, formatting

我正在尝试格式化 bash 中的条目列表，并且正在使用该`column`命令。但是，该`-t`选项默认使用任何空格作为分隔符，这不适用于我拥有的数据（它包含空格和制表符）。我不知道如何让`-s`标志指定换行符作为唯一的列分隔符。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-26T23:27:19.203

理论上，要指定换行符，您可以使用符号，除了它支持 C 样式的转义序列之外，它`$'...'`就像：`'...'`

```
column -t -s $'\n' list-of-entries.txt 
```

但是，我真的不明白这样做的目的。换行符是行分隔符，因此列分隔符`$'\n'`相当于根本没有任何列分隔符：

```
column -t -s '' list-of-entries.txt 
```

这意味着输入将被视为只有一列；所以这相当于根本不使用`column`：

```
cat list-of-entries.txt 
```

看起来你实际上*并不*想使用`-t`标志，因为标志的目的`-t`是确保每一行输入变成一行输出，听起来不像你想要的那样。我猜你想要这个：

```
column list-of-entries.txt 
```

这会将 的每一行`list-of-entries.txt`视为要放入`column`输出表的一个单元格中的值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T01:34:45.100

这可以输出制表符分隔文件的漂亮打印版本

```
column -t -s $'\t' list-of-entries.txt 
```

# css - 将 div 推送到页面边缘

> ID：12133064
> 
> 赞同：2
> 
> 时间：2012-08-26T19:08:41.980
> 
> 标签：css, html

我正在为一个包含来自各个城市的天际线的网站构建一个标题。为了方便更改显示的城市，我为每个城市设计了一个独特的 div，我可以直接放入标题中。我为每个 div 设置了背景图像，然后将它们一个接一个地放置，就像这样。

```
<header>
  <div class='skyline'>
    <div id='la'></div>
    <div id='seattle'></div>
    <div id='paris'></div>
    <div id='chicago'></div>
    <div id='london'></div>
  </div>
</header> 
```

我遇到的问题是最后一个将从页面中删除，在右边缘留下一个空白区域。我希望它们流过屏幕的边缘，这样用户就可以看到任何适合他们的窗口宽度的东西。我的CSS看起来像这样：

```
.skyline {
  background: #fff;
  background-position: 0px 0px;
  overflow: hidden;
  height: 113px;
  width: 100%;
}
.skyline div {
  display: inline-block;
  height: 113px;
  float: left;
  overflow: visible;
}
.skyline #la {
  width: 320px;
  background-image: url('/img/skyline/la.png');
} 
```

所有其他 div 具有相同的 css，只是源图像和宽度不同。

我把这个（修改过的）放在[jsfiddle 上来](http://jsfiddle.net/phoffer/xLwML/)演示我得到的行为。只需调整窗口大小即可演示正在发生的事情。

我能做些什么来解决这个问题？我愿意稍微更改 html 结构，但如果可以保持不变，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:21:20.190

您必须将包含元素设置`overflow: hidden;`为使其不显示水平滚动条，并且您必须为这些浮动 div 指定容器的总宽度，以便它们一直向右移动。否则他们会被推倒。您可以使用绝对位置来解决这个问题，但我认为这个解决方案更简单。

像这样 h [ttp://jsfiddle.net/xLwML/17/](http://jsfiddle.net/xLwML/17/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:14:53.227

尝试这个

```
.skyline {
  background: #fff;
  background-position: 0px 0px;
  height: 113px;
  width: 1000px; /* Changed from 100% & removed overflow */
} 
```

# javascript - 为 Google MAPS API v3 加载 JSON 数据

> ID：12133067
> 
> 赞同：1
> 
> 时间：2012-08-26T19:09:09.203
> 
> 标签：javascript, json, api, google-maps, google-maps-api-3

从以下示例代码开始（来自[https://google-developers.appspot.com/maps/documentation/javascript/overlays#SimpleIcons](https://google-developers.appspot.com/maps/documentation/javascript/overlays#SimpleIcons)）

```
 <!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map_canvas { height: 100% }
    </style>
    <script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCHgCs40BzMLmN2-GpJ-liYfcYsas-VVsI&sensor=false">
    </script>
    <script type="text/javascript">
function initialize() {
  var mapOptions = {
    zoom: 10,
    maxZoom: 12,
    center: new google.maps.LatLng(-33.9, 151.2),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  var map = new google.maps.Map(document.getElementById("map_canvas"),
                                mapOptions);

  setMarkers(map, beaches);
}

/**
 * Data for the markers consisting of a name, a LatLng and a zIndex for
 * the order in which these markers should display on top of each
 * other.
 */

 var beaches = (function () {
    var json = null;
    $.ajax({
        'async': false,
        'global': false,
        'url': data.php,
        'dataType': "json",
        'success': function (data) {
            json = data;
        }
    });
    return json;
    alert("OK, data loaded");
}); 

/*var beaches = [
  ['Stuttgart', 48.766700, 9.183330, 4],
  ['Coogee Beach', -33.923036, 151.259052, 5],
  ['Cronulla Beach', -34.028249, 151.157507, 3],
  ['Manly Beach', -33.80010128657071, 151.28747820854187, 2],
  ['Maroubra Beach', -33.950198, 151.259302, 1]
];
*/
function setMarkers(map, locations) {
  // Add markers to the map

  // Marker sizes are expressed as a Size of X,Y
  // where the origin of the image (0,0) is located
  // in the top left of the image.

  // Origins, anchor positions and coordinates of the marker
  // increase in the X direction to the right and in
  // the Y direction down.
  var image = new google.maps.MarkerImage('images/beachflag.png',
      // This marker is 20 pixels wide by 32 pixels tall.
      new google.maps.Size(20, 32),
      // The origin for this image is 0,0.
      new google.maps.Point(0,0),
      // The anchor for this image is the base of the flagpole at 0,32.
      new google.maps.Point(0, 32));
  var shadow = new google.maps.MarkerImage('images/beachflag_shadow.png',
      // The shadow image is larger in the horizontal dimension
      // while the position and offset are the same as for the main image.
      new google.maps.Size(37, 32),
      new google.maps.Point(0,0),
      new google.maps.Point(0, 32));
      // Shapes define the clickable region of the icon.
      // The type defines an HTML <area> element 'poly' which
      // traces out a polygon as a series of X,Y points. The final
      // coordinate closes the poly by connecting to the first
      // coordinate.
  var shape = {
      coord: [1, 1, 1, 20, 18, 20, 18 , 1],
      type: 'poly'
  };
  for (var i = 0; i < locations.length; i++) {
    var beach = locations[i];
    var myLatLng = new google.maps.LatLng(beach[1], beach[2]);
    var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        shadow: shadow,
        icon: image,
        shape: shape,
        title: beach[0],
        zIndex: beach[3]
    });
  }
}
    </script>
  </head>
  <body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>
  </body>
</html> 
```

我可以从外部文件加载点吗？使用此解决方案将[json 加载到变量](https://stackoverflow.com/questions/2177548/load-json-into-variable)中，我进行了以下操作：

```
var beaches = (function () {
    var json = null;
    $.ajax({
        'async': false,
        'global': false,
        'url': data.json,
        'dataType': "json",
        'success': function (data) {
            json = data;
        }
    });
    return json;
})(); 
```

但文件海滩列表似乎不是格式良好的 JSON 文件！文件数据.json：

```
beaches: [
  ['Bondi Beach', -33.890542, 151.274856, 4],
  ['Coogee Beach', -33.923036, 151.259052, 5],
  ['Cronulla Beach', -34.028249, 151.157507, 3],
  ['Manly Beach', -33.80010128657071, 151.28747820854187, 2],
  ['Maroubra Beach', -33.950198, 151.259302, 1]
]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T19:51:27.797

您当前的 JSON 存在一些问题：

*   您使用单引号而不是双引号。在 JSON 中，字符串必须用双引号括起来。
*   您的“海滩”属性也必须用引号括起来。
*   您必须通过将 JSON 包裹在大括号 ( `{}`) 中来使其成为对象。

尝试以下 JSON：

```
{
    "beaches": [
        [
            "BondiBeach",
            -33.890542,
            151.274856,
            4
        ],
        [
            "CoogeeBeach",
            -33.923036,
            151.259052,
            5
        ],
        [
            "CronullaBeach",
            -34.028249,
            151.157507,
            3
        ],
        [
            "ManlyBeach",
            -33.80010128657071,
            151.28747820854187,
            2
        ],
        [
            "MaroubraBeach",
            -33.950198,
            151.259302,
            1
        ]
    ]
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T20:56:40.083

似乎是澳大利亚的一项热门活动。见下文：

[使用自定义信息框从 Excel 批量上传标记](https://stackoverflow.com/q/17455936/1019635)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T19:41:23.567

这不是有效的[JSON](http://en.wikipedia.org/wiki/JSON)格式。看起来您需要通过将其包含在 {} 中来使其成为对象。

# python - 展平 Python 列表而不创建任何对象的副本？

> ID：12133070
> 
> 赞同：3
> 
> 时间：2012-08-26T19:09:32.230
> 
> 标签：python, arrays, list, multidimensional-array, flatten

所以我正在用 Python 编写一个游戏，而我试图解决的一个问题需要我将 2D 列表（即列表列表）转换为 1D 列表。我已经看到了几种方法来做到这一点，但我不知道它们中的任何一个是否创建了其中包含的任何对象的副本，或者只是新的引用。老实说，Python 标准库让我感到困惑，因为对象/序列是被复制还是只是被引用填充并不总是很明显。

这些是关于我的特殊情况的假设；

*   我们可以假设我的二维列表（如果表示为矩阵）是完美的矩形。
*   如果我能有一个上述假设不成立的解决方案，那就太好了，但目前不需要。
*   无需担心 3D+ 列表。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T19:22:46.630

虽然我不能代表您可能看到的所有方式，但由于 Python 的对象语义，通常不会制作副本。

```
>>> a = [[1,2.3,'3', object()], [None, [2,3], 4j]]
>>> b = [v for row in a for v in row]
>>> a
[[1, 2.3, '3', <object object at 0x1002af090>], [None, [2, 3], 4j]]
>>> b
[1, 2.3, '3', <object object at 0x1002af090>, None, [2, 3], 4j]
>>> [id(obj) for row in a for obj in row]
[4298185464, 4298195480, 4299558664, 4297781392, 4296523616, 4299692656, 4297773296]
>>> [id(obj) for obj in b]
[4298185464, 4298195480, 4299558664, 4297781392, 4296523616, 4299692656, 4297773296] 
```

这`v`并不意味着“某个新对象等于`v`”，它只是意味着`v`对象本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:24:30.700

关于您关于副本/引用的问题，Python 以不同的方式处理可变/不可变变量：对于不可变变量（int、float、string、tuples 等），您将获得副本，对于可变（其他所有）-“引用”。

关于 python 列表的扁平化：查看`itertools`模块。你可以这样做：

```
>>> from itertools import chain
>>> chain(*[[1,2,3], [4,5,6], [7,8,9]])
<itertools.chain object at 0x104ff5110>
>>> list(_)
[1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T19:42:29.100

[可能python文档](http://docs.python.org/extending/extending.html#reference-counts)中的这篇文章可以帮助您了解python的作用：

> 没有人“拥有”一个对象；但是，您可以拥有对对象的引用。对象的引用计数现在定义为拥有的对它的引用数。当不再需要引用时，引用的所有者负责调用 Py_DECREF()。引用的所有权可以转让。有三种方法可以处理拥有的引用：传递、存储或调用 Py_DECREF()。忘记处理拥有的引用会导致内存泄漏。

现在，这指的是在 C 代码中使用 python 对象，但是，由于解释器正是这样做的，因此您可以了解对象和引用在 python 中是如何管理的。

“没有人拥有一个对象”，所以当你把一个项目放在一个列表中时，这个列表不会*复制*这个项目，它只是拥有一个*引用*。实际上，它会复制一个指针并增加引用计数（并且可能还会减少被替换的其他对象）。

从python的角度来看，您不能访问对象，而只能引用对象。您可以放入变量中的任何内容实际上都是对对象的引用。因此`[1,2].append(3)`不会复制 3，而只是引用。

如果你想复制一个对象，那么你应该使用`copy`模块 或者，对于某些类型，使用对象作为参数调用类（例如`int(1234)`创建“1234”的副本，即使python将整数存储在一个小数组中 - 5 到 256 和小字符串，这样做`int(42)`不会复制“42”）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T19:29:22.627

您可以执行以下操作：

```
arr2d = [[1,2,3],[4,5,6],[7,8,9]]
arr1d = []
for x in arr2d:
   arr1d.extend(x) 
```

这不会创建副本，更改一维数组，它不会反映。对于未来的参考，如果你想确保它不被复制，导入`copy`模块，并使用`copy.deepcopy(array)`而不是 just `array`，你会很安全。

# ruby - 如何在没有任何外部 ruby 依赖项（即没有 gems）的情况下在 Mac/Linux 上生成唯一 ID？

> ID：12133071
> 
> 赞同：0
> 
> 时间：2012-08-26T19:09:41.220
> 
> 标签：ruby, uniqueidentifier, unique-key, identification, hwid

我正在尝试找到一种方法来生成唯一系统 ID (HWID)，而无需先添加任何其他 gem。

换句话说，我希望运行全新版本的 Mac/Linux 的人能够生成 ID，而无需安装其他任何东西。

我发现的唯一 ID 方法需要安装额外的 gem，所以这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T03:20:40.170

按照 Catnapper 的评论，uuidgen 可在包括 Darwin 在内的 Linux 系统上使用。

只需在 Ruby 脚本中调用它：

```
irb(main):001:0> `uuidgen`
=> "613C66FE-F609-4389-8A70-A59D245070AE\n" 
```

# php - 尝试在应用程序中发布图像

> ID：12133072
> 
> 赞同：2
> 
> 时间：2012-08-26T19:09:45.820
> 
> 标签：php, mysql, submission

如果我向 MySQL 数据库提交某些内容并且该对象获得了自动分配的 ID，我如何将数据提交到引用该 ID 的另一个表？如果第一个表自动增加新记录的 ID，我可以在提交后调用以获取该表的最大 ID - 但是如果多个用户在同一个应用程序上，这似乎很棘手并且容易出错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T22:06:01.887

你的帖子有点不清楚，但我认为你需要的是`mysql_insert_id()`，它将返回最后插入行的 id，使用`mysql_query`.

例子：

```
mysql_query("INSERT INTO `journal_post` (...) VALUES (...)"); //Insert proper code in ...
$pid = mysql_insert_id(); //Contains the ID of the just inserted journal_post
if (...) { //Some check to see if an image was attached
  mysql_query("INSERT INTO `img_details` (...) VALUES (...)");
} 
```

如果这不是您的意思，请提供代码示例来详细说明问题。

# python - 对熊猫系列进行排序

> ID：12133075
> 
> 赞同：29
> 
> 时间：2012-08-26T19:10:01.447
> 
> 标签：python, pandas, sorting, series

我试图弄清楚如何以一种智能的方式对由于 groupby 聚合而生成的 Series 进行排序。

我像这样生成我的 DataFrame 的聚合：

```
means = df.testColumn.groupby(df.testCategory).mean() 
```

这导致了一个系列。我现在尝试按值排序，但得到一个错误：

```
means.sort()
...
-> Exception: This Series is a view of some other array, to sort in-place you must create a copy 
```

然后我尝试创建一个副本：

```
meansCopy = Series(means)
meansCopy.sort()
-> Exception: This Series is a view of some other array, to sort in-place you must create a copy 
```

我怎样才能让这种工作正常？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-26T19:31:37.803

使用`sort_values`，即`means = means.sort_values()`。[***熊猫 v0.17+*** ]

* * *

### （非常老的答案，pre-v0.17 / 2015）

pandas 以前使用的`order()`方法：`means = means.order()`.

# java - 对象的创建——工厂方法

> ID：12133076
> 
> 赞同：0
> 
> 时间：2012-08-26T19:10:06.397
> 
> 标签：java, design-patterns

对于一个小型系统，我使用工厂方法创建相关对象（从父类继承），这样我就可以在不指定对象类型的情况下动态创建对象。我必须创建另一个没有子类的对象，并且该对象是用户类的实例。为了正确理解工厂方法模式，我不必为最后一个类创建工厂方法，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:19:19.993

工厂模式不仅仅关乎类型的灵活性。例如，Java`Integer.valueOf(int)`已经有了`new Integer(int)`. 工厂变体允许**缓存**：每次调用`Integer.valueOf(1)`将返回**相同的实例**。这适用于所有不可变对象。

另一个非常重要的考虑点是对象初始化：有一些初始化模式在对象正在构建时完成是不安全的。例如，调用任何可覆盖的方法。工厂模式也优雅地解决了这些情况。

我个人会主张第三个好处，但这对某些人来说可能是有争议的：我更喜欢编写没有`new`. 例如，`new OidableBinding(vb)`我不喜欢写`oidableBinding(vb)`. 这可以通过静态导入实现。所以附带说明：**不要命名您的工厂方法`getInstance`**或类似名称。将其命名为与类型名称相似，以便该方法在静态导入时看起来不错（并且不会与其他温和命名的工厂方法产生名称冲突）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T06:07:43.950

我认为如果您现有的工厂正在为相关对象提供服务，那么您可能想要创建另一个工厂。我认为即使您的工厂只创建一种类型的对象也可以。

# java - DownloaderClientMarshaller.Proxy 覆盖超类函数

> ID：12133077
> 
> 赞同：0
> 
> 时间：2012-08-26T19:10:06.787
> 
> 标签：java, android, eclipse

在谷歌生成的代码中，`google play APK expansion`我得到以下错误： ![问题](../Images/8329f2b7644f4ddd55a99ab3f95deb5d.png)

我没有碰过代码，所以我不认为这是我的错。有谁可以帮我离开这里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:33:00.857

您在 Eclipse 中的项目可能配置为使用 Java 1.5，但生成的类使用`@Override`接口方法的注释。在 Java 1.5`@Override`中，只能应用于覆盖超类方法的方法，而不是从接口实现的方法。

打开项目属性并将 java 编译器级别设置为 1.6，并确保在 Build Path > Libraries 选项卡上选择了 Java 1.6 库。

# apache - 在 RewriteRule 期间添加原始 url 作为标头或查询参数

> ID：12133079
> 
> 赞同：1
> 
> 时间：2012-08-26T19:10:12.490
> 
> 标签：apache, .htaccess, tomcat

我正在寻找一种在 RewriteRule 期间获取原始 URL 并将其作为附加参数附加到查询字符串或将其作为标头添加到请求的方法。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:23:34.530

将内容附加到查询字符串很简单（只需在问号后写入内容，不要忘记使用 QSA 标志来附加原始查询字符串）；而且，你可以捕获整个 URI 并附加它：

```
 RewriteRule (.*) test.php?uri=$1 [QSA] 
```

或者，您可以尝试提供有关请求信息的几个[服务器变量之一：](http://www.devhands.com/2008/11/mod_rewrite-server-variables-full-list/)

```
 RewriteRule .* test.php?uri=%{REQUEST_URI} [QSA] 
```

请注意，服务器变量的内容可能会因系统而异。

您也可以修改标题，但这并不那么简单。查看[这个问题](https://stackoverflow.com/questions/2272738/add-header-in-apache)的方法。

# php - PHP 命名空间和接口

> ID：12133081
> 
> 赞同：6
> 
> 时间：2012-08-26T19:10:17.843
> 
> 标签：php, namespaces

我正在尝试在 php 中使用带有一些类和接口的命名空间。

看来我必须为正在使用的接口和具体类型添加一个 use 语句。这肯定是违背了使用接口的目的吗？

所以我可能有

```
//Interface
namespace App\MyNamesapce;
interface MyInterface
{}

//Concrete Implementation
namespace App\MyNamesapce;
class MyConcreteClass implements MyInterface
{}

//Client
namespace App;
use App\MyNamespace\MyInterface  // i cannot do this!!!!
use App\MyNamespace\MyConcreteClass  // i must do this!
class MyClient
{} 
```

不是接口的全部意义在于具体类型是可互换的 - 这肯定与此相反。除非我没有正确地做某事

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T19:21:59.610

具体的实现是可以互换的，但是你需要在某个地方指定你想使用的实现，对吧？

```
// Use the concrete implementation to create an instance
use \App\MyNamespace\MyConcreteClass;
$obj = MyConcreteClass();

// or do this (without importing the class this time):
$obj = \App\MyNamespace\MyConcreteClass2(); // <-- different concrete class!    

class Foo {
    // Use the interface for type-hinting (i.e. any object that implements
    // the interface = every concrete class is okay)
    public function doSomething(\App\MyNamespace\MyInterface $p) {
        // Now it's safe to invoke methods that the interface defines on $p
    }
}

$bar = new Foo();
$bar->doSomething($obj); 
```

# c++ - 将随机数插入具有排序顺序 C++ 的数组中

> ID：12133084
> 
> 赞同：1
> 
> 时间：2012-08-26T19:10:34.277
> 
> 标签：c++, arrays, random, variable-assignment, sortedlist

您好，我正在尝试创建一个插入随机数的数组，但是当它插入时，数组保持在一个维护的顺序中。例如，如果数组包含 10 20 30 并且随机数是 11，则函数会将其放在 10 之后，并将 20 和 30 移到列表的下方。以下是该功能的要求。

*   insertNumber 将给定的随机数插入数组并保持顺序。
*   数据数组包含从索引 0 到大小 - 2 的排序顺序的整数。
*   randomNum 是要插入的整数
*   data 是包含排序整数的数组
*   size 是数组可以容纳的元素总数

到目前为止，这是我的代码。我的输出什么也没得到。

```
#include"utils.h" 

void insertNumber(int randomNum, int data[], int size)
{
    for(int i = 0; i < 10; i++)
    {
        randomNum = data[i];
        if (randomNum > data[i] && i < size - 2)
        {
            for ( int j = 0; j < 10; j--)
            {
                data[i+1] = data [i];
                i--;
            } 
        }
        data[i] = randomNum;
    }
}

void display(int data[],  int size)
{
    for (int i = 0; size < 10; i++)
    {
        cout << " " << data[i];
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T19:12:19.977

您可以使用算法`std::lower_bound`来获得插入位置，并使用`std::vector`容器来移动元素`insert`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:27:47.347

您可以使用 BinarySearch 搜索您的数组并查看随机数是否存在。如果它确实存在，那么您可以在现有的附近插入。

```
void binary_search(int A[], int key, int imin, int imax)
{
  if (imax < imin):
    // Insert key as the next element after imax
  else
    {
      // calculate midpoint to cut set in half
      int imid = midpoint(imin, imax);

      // three-way comparison
      if (A[imid] > key)
        // key is in lower subset
        binary_search(A, key, imin, imid-1);
      else if (A[imid] < key)
        // key is in upper subset
        binary_search(A, key, imid+1, imax);
      else
        // key has been found so insert it after imax
    }
} 
```

*   代码取自维基百科[http://en.wikipedia.org/wiki/Binary_search_algorithm](http://en.wikipedia.org/wiki/Binary_search_algorithm) *

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T19:24:07.410

这不是更好的实现方式吗？

```
#include <iostream>
#include <vector>
#include <algorithm>
#include <ctime>
#include <cstdlib>

int main() {
    std::vector<int> randomInts;
    srand(time(0));
    for(int i = 0; i < 10; i++)
        randomInts.push_back((rand()%30)+1); //Inserts random numbers 1-30.

    std::sort(randomInts.begin(),randomInts.end());
    for(auto i : randomInts)
        std::cout << i << " ";
} 
```

输出：`3 6 9 13 14 16 19 20 25 30`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-26T19:40:13.917

在你的函数中找到大于它的元素后插入你的随机数

```
for( i =0; i<size ;i++)
{
    if(data[i] > randomNumber)
    {
         valueToPush = data[i];
         data[i] = randomNumber;
         randomNumber = valueToPush;
    }
}
data[size] = randomNumber 
```

# python - 没有while循环的python检查时间

> ID：12133087
> 
> 赞同：-1
> 
> 时间：2012-08-26T19:10:49.370
> 
> 标签：python, time, while-loop, task

我正在尝试制作一个 python 程序，它会在某些时候弹出一个窗口框以提醒我必须做点什么。问题是，while循环使python崩溃，有没有办法让python在没有while循环的情况下检查时间？

```
while 1:
    gettime = time.strftime("%H:%M", time.localtime())
    gettime.replace(':','.')

    if gettime in tasks.keys():
        tasks[gettime] = dowat
        ctypes.windll.user32.MessageBoxW(0,u'ALERT!', dowat, 0)
        time.sleep(10)
        SendKeys.SendKeys("""
                {LWIN}
                l
                """) 
```

我尝试在循环结束时让 python 睡眠，但它仍然冻结。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:36:06.060

你以错误的方式去做......你不需要一个while循环。您需要做的是获取当前时间并计算出时差。然后你只需要调用 time.sleep*一次*。

这是我用来做类似事情的一些旧 python 代码。它周围有我必须清理/删除的东西，所以它可能无法 100% 工作。

```
import time
import datetime

CurrentTime = datetime.datetime.now()

exec_time = "18:00"

val = datetime.datetime.strptime(exec_time, "%H:%M")
val = datetime.datetime(year=CurrentTime.year, month=CurrentTime.month, day=CurrentTime.day, hour=val.hour, minute=val.minute)

if (val > CurrentTime):
    print "val = ", val
    val = datetime.datetime(year=CurrentTime.year, month=CurrentTime.month, day=CurrentTime.day, hour=val.hour, minute=val.minute) - CurrentTime #Calculate dif.

    time.sleep(val.seconds) #Sleep to next event 
```

# asp.net - 在每个 asp.net 响应中包含一个标头

> ID：12133091
> 
> 赞同：0
> 
> 时间：2012-08-26T19:11:25.990
> 
> 标签：asp.net

在 asp.net webforms 中，是否可以指定一个 http 标头，该标头应该出现在每个发送的响应中（图像等内容除外）？我正在尝试实现一个 CSRF 令牌方案，如果可能的话，它将在每个会话的基础上在某个 http 元标记中发送一个随机令牌。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T19:13:21.093

您可以使用 Http 处理程序来自定义您的标头

链接：http: [//msdn.microsoft.com/en-us/library/bb398986%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/bb398986%28v=vs.100%29.aspx)

# arduino - 在 ADK2012 中使用非 5v 模拟参考电压

> ID：12133093
> 
> 赞同：0
> 
> 时间：2012-08-26T19:12:06.007
> 
> 标签：arduino, adk, atmega

我有一个 ADK2012 类似 arduino 的设备。我正在使用 google 的 arduino 软件副本，我可以毫无困难地编译和运行各种草图。

我有一个连接到模拟输入的 LM35。默认情况下，参考电压为 5 伏。这似乎工作正常，但我想使用不同的模拟参考值，如此处所述：

[http://arduino.cc/en/Reference/AnalogReference](http://arduino.cc/en/Reference/AnalogReference)

不幸的是，我遇到了一些麻烦。当我使用`DEFAULT`或`EXTERNAL`喜欢这样：

```
analogReference(DEFAULT); 
```

我编译时得到这个：

```
AnalogReadSerial.cpp: In function 'void setup()':
AnalogReadSerial:12: error: invalid conversion from 'int' to 'eAnalogReference'
AnalogReadSerial:12: error: initializing argument 1 of 'void analogReference(eAnalogReference)' 
```

如果我尝试将其设置为`INTERNAL`、`INTERNAL1V1`或`INTERNAL2V56`，我会收到如下错误：

```
AnalogReadSerial.cpp: In function 'void setup()':
AnalogReadSerial:12: error: 'INTERNAL' was not declared in this scope 
```

我在这里有点死胡同。我对 Arduino 或 Wiring 不够熟悉，不知道这是否是所提供设备配置的问题，或者物理硬件的实际限制，或者内部的错误或不兼容。

不幸的是，我使用的硬件比较少见，而且似乎没有太多的文档。我很感激有关从哪里开始寻找解决此问题的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-06T23:54:04.060

似乎analogRefence() 需要一个类似枚举的东西作为参数

arduino.h 中的定义是 int

你有最新的 arduino ide (rev 1.0.1)

我已经为 arduino 制作了一个工具链，并将其链接到另一个 ide（netbeans）
，因此调试 arduino 核心非常简单。

还没有找到错误，（它适用于最新的arduino ide）；

无论如何，对于 arduino mega (ADK)，您可以在新 ide 中执行此操作，
如果可行，那么您选择了错误的板（工具>>板>>arduino mega2560 或 mega ADK）

```
analogReference(0); //EXTERNAL
analogReference(1); //DEFAULT
analogReference(2); //INTERNAL1V1
analogReference(3); //INTERNAL2V56 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T04:22:37.397

事实证明（现在 arduino 文档已经赶上，5 个月后）答案是：

这些设备本机工作电压为 3.3 伏，因此`analogReference`未启用该功能。

> Due 的模拟输入引脚从接地测量到最大值 3.3V。在 Due 的引脚上施加超过 3.3V 的电压会损坏 SAM3X 芯片。在 Due 上，analogReference() 函数被忽略。

[http://arduino.cc/en/Main/ArduinoBoardDue](http://arduino.cc/en/Main/ArduinoBoardDue)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-27T14:28:03.737

Arduino 2 不允许外部参考。您将在 SAM 库 (...sam\cores\arduino\wiring_analog.h ) 中找到它：

```
typedef enum _eAnalogReference
{
    AR_DEFAULT,
} eAnalogReference ; 
```

并且不允许外部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-11T21:54:34.377

µC 始终使用外部参考，但硬件连接到 3.3V，如果您想使用 AREF，您可以更改板上的 0 欧姆电阻。

# ruby - 绑定模型与 RoR 中的迁移

> ID：12133098
> 
> 赞同：0
> 
> 时间：2012-08-26T19:12:59.480
> 
> 标签：ruby, ruby-on-rails-3

我会对 Rails 中的模型和迁移有疑问。

让我们举个例子。我有一个会员模型：

```
class Member < ActiveRecord::Base
    attr_accessible :a, :b
end 
```

以及相应的迁移：

```
class CreateMembers < ActiveRecord::Migration
    def change
        create_table :members do |t|
            t.string :a
            t.string :b
        end
    end
end 
```

后来我意识到会员有车。所以，我必须创建汽车模型等......现在，我必须修改模型添加`belong_to`和`has_one`规则，但还要创建一个新的迁移并添加`car.integer :member_id`

我觉得它非常不切实际和多余。有没有什么技巧可以自动做到这一点？此外，与模型与数据库完全分离的 Symfony2 不同，这里我们需要通知一个 foreign_key 列。有没有办法写出类似的东西`car.member :member`而不是`car.integer :member_id`？这是一个细节，但我会很感激。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:33:10.443

Rails 提供了一些智能生成器：

尝试：

```
rails g model car member:references 
```

这将使用 member_id 作为外键（即使有索引）自动生成完整的迁移，并且该`belongs_to :member`行也已经添加到`Car`类中。

`rails g model car member:references`生成这个：

```
class CreateCars < ActiveRecord::Migration
  def change
    create_table :cars do |t|
    t.references :member

    t.timestamps
    end
    add_index :cars, :member_id
  end
end 
```

和这个：

```
class Car < ActiveRecord::Base
  belongs_to :member
end 
```

所以剩下要做的就是将这一行添加`has_one :car`到`Member`类中。

有关生成器的更多信息，请参阅：[Rails 命令行指南](http://guides.rubyonrails.org/command_line.html#rails-generate)

# mysql - 如何比较两列的重复值？

> ID：12133106
> 
> 赞同：3
> 
> 时间：2012-08-26T19:14:20.010
> 
> 标签：mysql, sql

我有一张表，上面有几个用户的 id 和他们各自的朋友 ID，我想看看谁有共同的朋友。

例如，1 是 Roger 的 ID，2 是 Matt 的 ID。

表友字段/值：

```
ID, FRIEND_ID, FRIEND_NAME

1, 34, DAMON

1, 17, RICHARD

1, 56, DANIEL

1, 65, CHARLIE

2, 15, PRISCILA

2, 17, RICHARD

2, 45, JOHN

2, 56, DANIEL 
```

我想创建一个 ID 为 1 和 2 的选择，这将返回具有共同 FRIEND_ID 的行（意味着 Roger 和 Matt 有共同的朋友），在这种情况下，它将返回带有friend_id RICHARD 和 DANIEL 的列，最好不要重复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T19:20:41.223

这应该工作，

```
Select f1.FRIEND_ID,f1.FRIEND_NAME from 
FRIENDS f1,FRIENDS f2 where f1.FRIEND_ID =f2.FRIEND_ID and 
f1.id=1 and f2.id=2 
```

这是示例： [http ://sqlfiddle.com/#!2/c9f36/1/0](http://sqlfiddle.com/#!2/c9f36/1/0)

如果你想让所有人都有共同的朋友，试试这个

```
Select f1.FRIEND_ID,f1.FRIEND_NAME,f1.id 'first person',f2.id as 'second person' from 
FRIENDS f1,FRIENDS f2 where f1.FRIEND_ID =f2.FRIEND_ID and 
f1.id<>f2.id and f1.id<f2.id 
```

这将返回每行有相同朋友的两个人：[http ://sqlfiddle.com/#!2/c9f36/2/0](http://sqlfiddle.com/#!2/c9f36/2/0)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T19:27:25.663

```
SELECT friend_id, friend_name
FROM friends
WHERE id IN (1, 2)
GROUP BY friend_id
HAVING COUNT(*) > 1 
```

**[演示](http://sqlfiddle.com/#!2/7cd2e/3)**。

# jquery - SCRIPT70：权限被拒绝 IE 9 - ajax 请求

> ID：12133110
> 
> 赞同：1
> 
> 时间：2012-08-26T19:14:58.983
> 
> 标签：jquery, ajax, permissions, internet-explorer-9

说明：jquery-1.3.2.min.js，第19行字符27021

行：J.open(G,M.url,M.async)

本地主机（denwer）上的网站。即 9。

Chrome、Opera、Safari、Mozilla 没有问题。

代码：

```
function myFunction() {
    $.ajax({
        type: "POST",
        url: "http://mysite.com/license/index.php",
        data: "key=<?php echo $c_hash; ?>",
        cache: true,
        success: function(response){
            if (response === '<?php echo $c_hash; ?>') {
                $("#thisdiv").html('<table><tr><td align="left"><a href="<?php echo str_replace("&", "&amp;", $back); ?>" class="button" style="text-decoration: none;"><span><?php echo $button_back; ?></span></a></td><td align="right"><a onclick="formSubmit();" class="button"><span><?php echo $button; ?></span></a></td></tr></table>');
            } else {
                $("#thisdiv").html('<div style="display: table;"><div><p style="margin: 0;">There is license check error.</p></div><div style="float: right;"><a href="<?php echo str_replace("&", "&amp;", $back); ?>" class="button" style="text-decoration: none;"><span><?php echo $button; ?></span></a></div></div>');
            }
        }, 
        error: function(){
                $("#thisdiv").html('<div style="display: table;"><div><p style="margin: 0;">There is license check error.</p></div><div style="float: right;"><a href="<?php echo str_replace("&", "&amp;", $back); ?>" class="button" style="text-decoration: none;"><span><?php echo $button; ?></span></a></div></div>');
        }
    });
};
myFunction(); 
```

有人可以帮忙吗？

# github - 控制谁推送到我的 github 存储库

> ID：12133115
> 
> 赞同：1
> 
> 时间：2012-08-26T19:15:53.113
> 
> 标签：github, repository, organization

我为我们几个人正在处理的代码设置了一个组织存储库。目前，我只添加了另一个存储库所有者。它没有其他成员。我想让它使除了所有者或成员之外的任何人都可以推送到存储库。当我的个人帐户中有存储库时，我必须添加一个 ssh 密钥才能推送到存储库；但是，我不必这样做来推送到组织存储库。我怎么能确定没有其他人可以推送到回购？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T17:29:06.157

显然，对存储库的推送访问是通过个人帐户控制的。我注意到我的 SSH 密钥仍在我的个人帐户中。当我推送到 github 存储库页面上提供的存储库的 ssh 链接时，会使用我个人帐户中的 SSH 密钥。不是存储库成员的人将没有推送访问权限。github 支持人员告诉我，尝试通过 http 链接推送会提示用户输入他们的 github 用户 ID 和密码。

# django - Django - 多对多作为隐藏字段？

> ID：12133116
> 
> 赞同：4
> 
> 时间：2012-08-26T19:16:04.703
> 
> 标签：django, django-forms

我已经实现了一个多图像上传方法，但我想知道使用哪些字段/小部件能够将图像 ID 与表单一起传递。

这些图像在填写表单时异步添加，并且在提交时，这些图像将被分配给表单正在添加/编辑的对象。我怎样才能传递这个隐藏字段数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T12:20:29.777

您可以在 CSS 中隐藏选择，并让您的 javascript 更新选择的选项。

这就是 django-autocomplete-light 小部件所做的，特别是在“远程自动完成”的情况下，就像你的情况一样：js 请求一个 django 视图，该视图创建一个对象并用它的 id 响应，js 用这个 id 创建选项.

# php - 对象通过对数组的引用传递（CodeIgniter，DataMapper）

> ID：12133117
> 
> 赞同：1
> 
> 时间：2012-08-26T19:16:05.490
> 
> 标签：php, codeigniter, codeigniter-datamapper

这是我的代码：

```
$get = $this->auth->current_user()->author->get_iterated();
foreach($get as $page) $pages[] = $page;

foreach($pages as $page) var_dump($page->title); 
```

现在，如果有 2 个用户是作者的页面，则后面的`foreach`-loop 将输出最后一页的标题 2 次。

我有理由不在第一个循环中输出标题。但是，我不想在这里粘贴整个代码，因为问题可以在上面的小代码中看到。

似乎`$page`是通过对数组的引用传递的`$pages`。是否可以*不*这样做，而是保存静态对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:38:43.027

查看`clone`关键字/魔术方法。这将创建对象的单独副本，您可以将其保存或传递到您需要的任何地方...

# mysql - 合并子查询

> ID：12133119
> 
> 赞同：0
> 
> 时间：2012-08-26T19:16:18.867
> 
> 标签：mysql, sql, subquery

我有两个`queries`知道鱿鱼日志的进出缓存

这是我的第一个查询

```
select SUBSTRING_INDEX(url, '/', 3),count(resultstatuscode) from squid where resultstatuscode like '%MISS%' group by SUBSTRING_INDEX(url, '/', 3); 
```

这是我的第二个查询

```
select SUBSTRING_INDEX(url, '/', 3),count(resultstatuscode) from squid  group by SUBSTRING_INDEX(url, '/', 3); 
```

我只想把我的第 2 分到`query`第 1`query`

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T19:26:53.027

最简单的解决方案：使用 url 子字符串连接两个查询，然后您可以计算比率。

```
SELECT a.url, a.codecount / b.codecount AS percentage
FROM
(SELECT SUBSTRING_INDEX(url, '/', 3) AS url,
        COUNT(resultstatuscode) AS codecount
FROM squid 
WHERE resultstatuscode LIKE '%MISS%' 
GROUP BY SUBSTRING_INDEX(url, '/', 3)) a
JOIN
(SELECT SUBSTRING_INDEX(url, '/', 3) AS url,
        COUNT(resultstatuscode) AS codecount
FROM squid
GROUP BY SUBSTRING_INDEX(url, '/', 3)) b
ON a.url = b.url 
```

只有一个子选择的替代解决方案“准备”用于百分比计算的数据：

```
SELECT t.url, SUM(t.miss) / SUM(t.total) AS percentage
FROM (SELECT SUBSTRING_INDEX(url, '/', 3) AS url,
      CASE WHEN resultstatuscode LIKE '%MISS%' THEN 1 ELSE 0 END AS miss
      1 AS total) t 
GROUP BY t.url 
```

# php - 即使在从命令行执行脚本时打开 ob_start() ，输出也会打印到终端

> ID：12133120
> 
> 赞同：3
> 
> 时间：2012-08-26T19:16:27.640
> 
> 标签：php, command-line-interface, output-buffering

我写了一个小命令行脚本来处理一个文档[一个带有 lilypond 乐谱插入的降价文件，只是为了完整起见]。

```
#!/usr/bin/env php
<?php    

$body = "";

...
// text gets processed here and stored in $body
...

ob_start();
include 'template.php';
file_put_contents(
    __DIR__ . '/' . str_replace('.md', '.html', $argv[1]),
    ob_get_flush() 
); 
```

**模板.php**

```
<!DOCTYPE html>
<html lang="en">
<head>
  ...
</head>
<body>
  <div id="wrapper">
  <?php echo Markdown($body); ?>
  </div>
</body>
</html> 
```

当我打电话时：

```
$ ./phlily source.md 
```

文件生成正确，但模板内容也打印到控制台：

```
GNU LilyPond 2.14.2
Processing `/Users/.../phlily/ly/4add05a74d249f34b3875ef6c3c1d79763927960.ly'
Parsing...
Converting to PNG...
<!DOCTYPE html>
<html lang="en">
<head>
...
</html> 
```

这很烦人，因为我想从 LilyPond 脚本中读取错误和警告，将它们埋在终端的 html 墙后面。

长话短说，是否可以在 CLI 环境中关闭输出缓冲区？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T19:32:20.287

我想你想要`ob_get_clean()`而不是`ob_get_flush()`：

[ob_get_clean](http://us.php.net/ob_get_clean)：

> ob_get_clean — 获取当前缓冲区内容并删除当前输出缓冲区

[ob_get_flush](http://us.php.net/manual/en/function.ob-get-flush.php)：

> ob_get_flush — 刷新输出缓冲区，将其作为字符串返回并关闭输出缓冲

在这种情况下，“flush”表示“发送到标准输出”。

```
file_put_contents(
    __DIR__ . '/' . str_replace('.md', '.html', $argv[1]),
    ob_get_clean() 
); 
```

# javascript - 来自小部件内的类的冒泡事件？

> ID：12133122
> 
> 赞同：1
> 
> 时间：2012-08-26T19:17:03.767
> 
> 标签：javascript, widget, yui, yui3, event-bubbling

我拼命尝试从我写的课程中触发一个事件。我在我的 YUI 小部件中使用这个类，我希望我的 YUI 小部件响应触发的事件。我知道事件冒泡是如何工作的，所以这里的代码工作得很好：

```
 YUI().use('event-custom', 'node', function (Y) {

function Publisher(bubbleTo) {
        this.addTarget(bubbleTo);
        this.publish("testEvent", {
            emitFacade: true
        });
        this.fire("testEvent");
}

function BubbleTarget() {

    this.on("testEvent", function (e) {Y.log("Bubbling in Test.js succeed!")});
    var newPublisher = new Publisher(this);
}
// To fire events or be a bubble target, augment a class with EventTarget
Y.augment(Publisher, Y.EventTarget);
Y.augment(BubbleTarget, Y.EventTarget);

var bubbleTarget = new BubbleTarget();}); 
```

但是，当我尝试将这个概念应用到我的 Widget 时，我非常失败。

```
YUI.add("SlideShow", function(Y) {

function SlideShow(config) {
    SlideShow.superclass.constructor.apply(this, arguments);
}

SlideShow.NAME = "SlideShow";

Y.extend(SlideShow, Y.Widget, {
    initializer: function() {   
        Y.log("Widget loaded!");
        this.on("testEvent", function () {
                Y.log("This should, but won't appear despite how hard I try!");
          });
    },

    renderUI: function(){
        var testSlide = new Slide("text", this);
    }
});

Y.SlideShow = SlideShow;

function Slide(sendTo)
{
this.addTarget(sendTo);
    this.publish("testEvent", {
        defaultFn: function(){Y.log('Event published.')},
        emitFacade: true
    });
    this.fire("testEvent");
}

Y.augment(Slide,Y.EventTarget, true, null, {emitFacade: true});
}, "0.0.1", {requires:["widget","event-custom","node","anim"]}); 
```

Chromium 中的对数输出为：

*   在 Test.js 中冒泡成功！
*   小部件已加载！
*   活动发布。

似乎我真的很怀念关于小部件的一些重要内容。请帮助我以便更好地理解这个主题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T13:18:23.627

我认为答案在 Mitch 的帖子中。您需要在气泡目标订阅上添加事件前缀。所以而不是：

```
this.on("testEvent", function () {
    Y.log("This should, but won't appear despite how hard I try!");
}); 
```

尝试：

```
this.on("*:testEvent", function () {
    Y.log("This should, but won't appear despite how hard I try!");
}); 
```

或者在你的 Slide 类上设置 .NAME （无论如何你都应该这样做）：

```
Slide.NAME = "Slide"; 
```

然后您的前缀使用该值：

```
this.on("Slide:testEvent", function () {
    Y.log("This should, but won't appear despite how hard I try!");
}); 
```

使用 Y.Base.create 将删除大量样板文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T09:18:05.107

有趣的问题！

所以我试图更深入地解耦这个问题。

首先，我测试了来自@Mitch 的示例——正如预期的那样，它有效！证明：http: [//jsfiddle.net/pqr7/hQBHH/3/](http://jsfiddle.net/pqr7/hQBHH/3/)

但是如果 Slide 是普通对象（不是从 Y.Base 扩展的）怎么办？我已经测试了来自@brian-j-miller 的示例，但它不起作用。证明：http: [//jsfiddle.net/pqr7/hQBHH/4/](http://jsfiddle.net/pqr7/hQBHH/4/)

然后我运行我的 firebug 并一步一步地研究 YUI 源代码。现在我知道它是如何工作的了！

让我们看看普通对象幻灯片[http://jsfiddle.net/pqr7/hQBHH/4/](http://jsfiddle.net/pqr7/hQBHH/4/)的示例 当我`this.fire("testEvent");`在普通对象幻灯片上做时，YUI 在内部调用了很多链中的函数并使用`type`字符串 = `"testEvent"`(I称它为“type”，因为在源代码中它总是保存在名为“type”的变量中）。我发现事件会像预期的那样冒泡并丰富您的目标（幻灯片的实例）。然后它检查 SlideShow 是否有一些事件订阅者`type`== `"testEvent"`？回答：没有！

如果您在 SlideShow 中订阅`this.on('testEvent', ...)`它实际上存储为字符串`type`==`"SlideShow:testEvent"`

如果您在 SlideShow 中订阅`this.on('*:testEvent', ...)`它实际上存储为字符串`type`==`"*:testEvent"`

如果您在 SlideShow 中订阅`this.on('Slide:testEvent', ...)`它实际上存储为字符串`type`==`"Slide:testEvent"`

但是冒泡的内容很简单`type`== `"testEvent"`，因此 SlideShow 实例中没有订阅者。

然后，YUI 使用 . 检查更复杂的规则`*:testEvent`。不幸的是我们的简单字符串`testEvent`与模式不匹配`*:testEvent` 这是原始代码[http://yuilibrary.com/yui/docs/api/files/event-custom_js_event-target.js.html#693](http://yuilibrary.com/yui/docs/api/files/event-custom_js_event-target.js.html#693)

`if (type.indexOf(PREFIX_DELIMITER) > -1) { /* make a magic to execute a subscriber */ }`

`type`这是我们的冒泡字符串`testEvent`，它不包含 PREFIX_DELIMITER（即冒号）

这就是您从 Y.Base 扩展 Slide 时的区别 - 触发的事件并不简单`testEvent`，但`Slide:testEvent`它计算了模式`*:testEvent`（http://jsfiddle.net/pqr7/hQBHH/3/）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T22:22:40.030

我不能告诉你为什么当一个普通的 JS-Object 和一个 Y.Widget 必须交互时它会失败，而它与两个普通的 JS-Objects 一起工作。

但是，扩展[Y.Base](http://yuilibrary.com/yui/docs/base/)将解决您的问题，同时让您充分利用 Y.Base 的强大功能：

```
function Slide(config)
{
    Slide.superclass.constructor.apply(this, config);
}

Slide.NAME = "slide";

Y.extend(Slide, Y.Base, {

    initializer : function() {
               this.publish("testEvent", {
                  emitFacade: true//you do not need to specify this, 
                                  //it will be set implicitly to true
                                  //when using Y.Base
                });
            },
    test : function(arg) {
        this.addTarget(arg);
        this.fire("testEvent");
    }
}); 
```

这里重要的是 NAME-Attribute - 它将成为您的小部件侦听的前缀：

```
Y.extend(SlideShow, Y.Widget, {
    initializer: function() {   
       Y.log("Widget loaded!");
       this.on("slide:testEvent", function () {
            Y.log("This will work!");
        });

       this.on("*:testEvent", function () {
            Y.log("This will work, too no matter what's the Event's prefix!");
        });

       this.on("Slide:testEvent", function () {
              Y.log("This won't work, since the prefix doesn't match the NAME-Attribute!");
        });
    },
    //rendering etc.
}); 
```

在 renderUI 你会调用：

```
renderUI: function(){
    var testSlide = new Slide();
    testSlide.on('testEvent', function(e) {
       Y.log('You can listen for testEvent without a prefix on a Slide-object.');
    });
    testSlide.test(this);//adds this Widget as the target for the testSlide. 
} 
```

# mysql - mysql过程语法错误

> ID：12133124
> 
> 赞同：1
> 
> 时间：2012-08-26T10:04:05.067
> 
> 标签：mysql

我的第一个 MySQL 程序有问题。我找不到语法错误。这是程序的主体：

```
DECLARE TerminId INT;

INSERT INTO `Termin` (`Beginn`, `Ende`, `Titel`, `Ganztaegig`, `Serie`, 
                      `Bemerkung`, `Tooltip`, `Ort`, `Gruppe`, `UserId`) 
VALUES (BeginnPara, EndePara, TitelPara, GanztaegigPara, SeriePara, 
        BemerkungPara, TooltipPara, OrtPara, GruppePara, UserIdPara);

SET TerminId = ( SELECT Distinct Id FROM Termin 
                 where Beginn = BeginnPara 
                       and Ende = EndePara 
                       and UserId = UserIdPara); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:28:57.890

删除简单报价

```
 DECLARE TerminId INT;

    INSERT INTO Termin(Beginn, Ende, Titel, Ganztaegig, Serie, Bemerkung, Tooltip, Ort, Gruppe, UserId) VALUES (BeginnPara, EndePara, TitelPara, GanztaegigPara, SeriePara, BemerkungPara, TooltipPara, OrtPara, GruppePara, UserIdPara);

    SET TerminId= (SELECT Distinct Id FROM Termin where Beginn = BeginnPara and Ende = EndePara and UserId = UserIdPara having row_number <= 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T05:38:47.113

尝试：

```
DECLARE TerminId INT;
INSERT INTO `Termin`(`Beginn`, `Ende`, `Titel`, `Ganztaegig`, `Serie`, `Bemerkung`, `Tooltip`, `Ort`, `Gruppe`, `UserId`) VALUES (BeginnPara, EndePara, TitelPara, GanztaegigPara, SeriePara, BemerkungPara, TooltipPara, OrtPara, GruppePara, UserIdPara);

SELECT Distinct Id INTO TerminId FROM Termin where Beginn = BeginnPara and Ende = EndePara and UserId = UserIdPara having row_number <= 1); 
```

问候。

# objective-c - OSX 应用程序中的 WebKit：将消息从 Javascript 传递到包装器应用程序？

> ID：12133129
> 
> 赞同：1
> 
> 时间：2012-08-26T19:17:58.263
> 
> 标签：objective-c, macos, webkit

在阅读 WebKit 文档时，我发现我可以[直接在嵌入式浏览器中评估 Javascript](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DisplayWebContent/Tasks/JavaScriptFromObjC.html#//apple_ref/doc/uid/30001214-BCIIEAFH)。伟大的！这处理将消息从本机 OSX 应用程序传递到网站。

但是，我还需要能够从我的 Javascript 传递消息以触发 OSX 应用程序中的一些代码。我知道如何在***iPhone UIWebView***上执行此操作：我将实现 UIWebViewDelegate 类，然后实现如下方法：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
     // Examine the request object and do whatever needs be done
     return NO;
} 
```

巧合的是，我看到[其他用户已经为 iOS 提出了这个解决方案](https://stackoverflow.com/questions/3742590/nsstring-in-webview-iphone-and-objective-c/3742635#3742635)。但是，我在 OSX WebKit 框架中没有看到等效的方法（例如，在[Frame Load Delegate](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DisplayWebContent/Tasks/LocationChanges.html#//apple_ref/doc/uid/20002027-CJBEHAAG)中）。

任何人都可以建议将消息​​从我的 Javascript 传递到我的 OSX 应用程序的最佳实践吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:53:24.240

看来我在问之前没有深入挖掘。在 WebKit 中，您可以通过暴露 Objective-C 类直接从 Javascript 调用 Objective-C 方法。查看此文档：http: [//developer.apple.com/library/safari/#documentation/AppleApplications/Conceptual/SafariJSProgTopics/Tasks/ObjCFromJavaScript.html](http://developer.apple.com/library/safari/#documentation/AppleApplications/Conceptual/SafariJSProgTopics/Tasks/ObjCFromJavaScript.html)

非常容易使用，而且超级有用。

*编辑* 为了完整起见：如果您正在寻找一种拦截（甚至阻止）页面加载调用的方法（就像我在上面的 UIWebView 示例中所做的那样），请查看[WebKit policyDelegate 的文档](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DisplayWebContent/Tasks/PolicyDecisions.html#//apple_ref/doc/uid/TP40001496-CJBEHAAG)。您可以选择忽略（或使用）某种类型的事件。

# php - while($row = mysqli_fetch_array($result)){ 选择多个表时

> ID：12133130
> 
> 赞同：3
> 
> 时间：2012-08-26T19:18:00.587
> 
> 标签：php, mysql

我正在用 PHP、javascript 和 mysql 创建这个搜索功能。

此代码按应有的方式工作。我在一个 html 搜索框中输入了一些数据，它将 %keyword% 发送到这个 PHP 函数，该函数根据我的需要返回数据。

```
$query = "SELECT id,fornavn,efternavn,adresse,postnr,city,tlf,kon,email,fodselsdag FROM kunde WHERE email LIKE '%$keyword%' OR fornavn LIKE '%$keyword%'";

$result = mysqli_query($dbc,$query);

if($result){
    if(mysqli_affected_rows($dbc)!=0){
      while($row = mysqli_fetch_array($result,MYSQLI_ASSOC)){
        listings($row['fornavn'],$row['efternavn'], $row['email'],$row['adresse'],$row['tlf'],$row['postnr'],$row['city'],$row['fodselsdag'],$row['id'],$bartype);
    } 
```

我有另一个表，上面的 SQL 中的 ID 与另一个 ID 相关。该表如下所示：

```
Table name: vip
Colmns: id, brugerid, barid 
```

现在我想在上面的代码中自定义 SQL，所以它只选择在 vip 表中也有关系的数据。

我这样做：

```
SELECT *, kunde.id as kundeid FROM kunde,vip WHERE  vip.brugerid = kunde.id AND vip.barid =1 AND email LIKE '%$keyword%' OR fornavn LIKE '%$keyword%'; 
```

实际上，每当我添加多个表时，php 代码就会停止工作.. 知道为什么会这样吗？我怎么能做到这一点？

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:32:30.847

[http://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html)

```
SELECT *, kunde.id as kundeid FROM kunde INNER JOIN vip ON (vip.brugerid = kunde.id) WHERE  kunde.id=1 AND email LIKE '%$keyword%' OR fornavn LIKE '%$keyword%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T19:21:50.990

我在这里看到不必要的逗号：`FROM kunde,vip, WHERE`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:36:50.643

此外，请考虑在您未来的开发中使用[PDO](http://www.php.net/manual/en/intro.pdo.php)，因为它与 mysqli 和 mysql_query 不同，是用于访问数据库的更一致的接口。

# java - Android仪表板布局不起作用

> ID：12133132
> 
> 赞同：1
> 
> 时间：2012-08-26T19:18:05.547
> 
> 标签：java, android, android-layout

根据 Google 设计模式，我一直在使用 Google 在 Google IO 应用程序中使用的[DashboardLayout.java文件来实现仪表板布局。](https://gist.github.com/882650)

当所有项目都可以适合屏幕时，这可以正常工作：[请参阅 screenshot](http://i46.tinypic.com/350j601.png)。但是，当有太多项目无法在屏幕上很好地显示时，[就会发生这种情况。](http://i50.tinypic.com/i5w32o.png) （imo，我认为google类会通过将3个项目放在一行来解决这个问题）

我不确定这是否是谷歌类文件中没有预见到的，还是我应该深入研究我的设置？（如果需要，我可以在此处发布）如果有人知道解决方法（尝试使用滚动视图但也搞砸了布局），那将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T21:24:04.910

如果按钮数量是偶数，仪表板布局才有效。因此，如果您有一个奇数，只需插入一个额外的按钮：

```
android:background="@null" or "#00000000"//transparent 
```

所以它会像一个额外的按钮一样处理它，但它是透明的。

# ios - UIBarButtonItem 的单击事件似乎在 MonoTouch 中不起作用

> ID：12133133
> 
> 赞同：1
> 
> 时间：2012-08-26T19:18:21.957
> 
> 标签：ios, xamarin.ios, uibarbuttonitem

我正在尝试创建一个自定义后退按钮，除了 Clicked 事件之外，一切似乎都有效。

我有 2 个屏幕要在它们之间移动。我们将它们称为 Screen1 和 Screen2。Screen1 中有一个按钮，单击该按钮可将我带到 Screen2。

以下代码是我尝试创建自定义背面的方式，该背面已放置在 Screen1 的 ViewDidLoad 和 ViewWillDisappear 中（以下是我在 ViewWillDisappear 中的内容）。两个函数中使用的代码是以下代码的最后两行。

```
protected override void ViewWillDisappear(bool animated) {
    base.ViewWillDisappear(animated);
    this.NavigationController.SetNavigationBarHidden(false, animated);
    UIBarButtonItem backBtn = new UIBarButtonItem("NewTitle", UIBarButtonItemStyle.Plain, delegate { Console.WriteLine("clicked"); });
    this.NavigationItem.BackBarButtonItem = backBtn;
} 
```

运行时，当我单击 Screen2 中的后退按钮时，控制台中永远不会出现“单击”一词。我也尝试通过调用隐藏默认值

```
this.NavigationItem.SetHidesBackButton(true, false); 
```

在创建按钮之前，但它没有影响任何东西。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T23:03:20.097

有时默认值`.ctor`不会像我们预期的那样工作。IOW 它调用`init`选择器，但并不*总是*提供完全初始化的实例（大多数时候会引发 ObjectiveC 异常）。

确保尝试使用以下代码：

```
UIBarButtonItem backBtn = new UIBarButtonItem ("NewTitle", UIBarButtonItemStyle.Plain, delegate {
   Console.WriteLine("clicked");
});
this.NavigationItem.BackBarButtonItem = backBtn; 
```

如果可行，请向[http://bugzilla.xamarin.com/](http://bugzilla.xamarin.com/)填写错误报告，并添加回此问题的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T23:43:24.130

经过大量研究和反复试验，我发现了以下帖子：[http](http://adrianhosey.blogspot.com/2009/06/why-wont-my-backbarbuttonitem-use-its.html) ://adrianhosey.blogspot.com/2009/06/why-wont-my-backbarbuttonitem-use-its.html （注意有一些粗口在文中）。似乎将变量 BackBarButtonItem 设置为自定义按钮不起作用；您可以更改文本，但似乎就是这样。

然而，这里的另一篇文章说它可以在推送控制器中工作，尽管它似乎对我不起作用：[MonoTouch 中的按钮问题](https://stackoverflow.com/questions/8552553/button-questions-in-monotouch)。

要解决此问题，以下代码对我有用：

```
public override void ViewDidLoad() {
    base.ViewDidLoad();
    this.NavigationItem.SetHidesBackButton(true, false);
    UIBarButtonItem backBtn = new UIBarButtonItem("Back", UIBarButtonItemStyle.Plain, delegate {
        Console.WriteLine("clicked");
        //one of the NavigationController pop functions to go back
    });
    this.NavigationItem.LeftBarButtonItem = backBtn;
} 
```

# dictionary - 列表理解以在字典列表中查找唯一键值

> ID：12133135
> 
> 赞同：0
> 
> 时间：2012-08-26T19:18:37.450
> 
> 标签：dictionary, list-comprehension

任何人都知道如何使用列表理解执行以下代码？由于 if 条件，我被卡住了，我不知道如何使用列表理解来应用。提前致谢。

```
x = [{'key':1},{'key':1},{'key':2}, {'key':2}]
y = []

for e in x:
    if e['key'] not in y:
        y.append(e['key'])

>>>print y
[1,2] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T19:34:10.643

对于这个特定的条件，您可以使用集合推导：

```
xs = [{'key':1},{'key':1},{'key':2}, {'key':2}]
y = {x['key'] for x in xs}

print y # {1,2} 
```

# objective-c - 为什么 arc4random 有时会返回负数？

> ID：12133136
> 
> 赞同：1
> 
> 时间：2012-08-26T19:18:40.213
> 
> 标签：objective-c, gnustep, arc4random

我`arc4random()`用来生成一定范围内的数字。但是，我会间歇性地收到负数。我没有做任何奇怪的事情：

```
if([aBug x] == -1) {
    x = arc4random() % columns;
}

if([aBug y] == -1) {
    y = arc4random() % rows;
} 
```

在这里，`x`有时`y`会设置为负值。`x`并且`y`都是 type `int`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T19:24:28.220

因为`arc4random()`总是积极的：

> arc4random() 函数返回 0 到 (2**32)-1 范围内的伪随机数

[^(^(^([资源])))](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man3/arc4random.3.html)

我将不得不推断`columns`或`rows`“任意”否定。用负数修改正数将返回负数。

行和列的数据类型是什么？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-26T19:42:07.570

听起来您想将 x 和 y 声明为 type`u_int32_t`而不是`int`. 即，您应该使用无符号变量而不是有符号变量。

或者，使用大于 32 位的有符号整数（例如`uint64_t`/ `long long`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-16T10:16:49.313

我遇到了同样的问题。我不知道为什么这会修复它但从

```
(int)arc4Random()%4 
```

至

```
(int)(arc4Random()%4) 
```

似乎对我有用。

# javascript - 页面加载后拒绝重新设置 href 属性

> ID：12133138
> 
> 赞同：0
> 
> 时间：2012-08-26T19:18:56.467
> 
> 标签：javascript, properties, href

在结束正文标记之前，我的页面底部有以下一小段代码：

```
var myAnchor = document.getElementById("tools").getElementsByTagName("a")[0];
var myHref = myAnchor.href;
myHref = "http://www.failblog.org";
alert(myHref); 
```

该页面按预期提示“http://www.failblog.org”，但实际上并没有更改锚点的 href 属性值。该链接顽固地保留其原始href。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:22:05.087

你做错了，试试这个：

```
 myHref = "http://www.failblog.org";
    var myAnchor = document.getElementById("tools").getElementsByTagName("a")[0];
    myAnchor.href = myHref;
    alert(myHref); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:21:45.767

设置时`var myHref = myAnchor.href;`， 的字符串值`myHref`将被设置为 的字符串值`myAnchor.href;`，变量不作为引用赋值，而是作为值的副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T19:24:27.620

将代码更改为：

```
var myHref = "http://www.failblog.org";
var myAnchor = document.getElementById("tools").getElementsByTagName("a")[0];
myAnchor.href = myHref; 
```

# android - setColorFilter() 和可变可绘制对象

> ID：12133139
> 
> 赞同：4
> 
> 时间：2012-08-26T19:19:01.727
> 
> 标签：android, bitmap, drawable, mutable

这段代码有什么问题？我一直在努力获得 dwb2 ColorFiltered 几个小时，按下此按钮时它只显示原始资源:(

```
public ButtonEx(Context context, AttributeSet attrs) {
        super(context, attrs);
        // TODO Auto-generated constructor stub

        Drawable dwb = getResources().getDrawable(R.drawable.mainboard_btn_pen_colour);
        Drawable dwb2 = new BitmapDrawable(BitmapFactory.decodeResource(getResources(), R.drawable.mainboard_btn_extra_time1)
                                                .copy( Bitmap.Config.ARGB_8888, true));
        dwb2.setColorFilter(getResources().getColor(R.color.mod_selected), PorterDuff.Mode.MULTIPLY);

        mLstDrawables.addState(new int[] {android.R.attr.state_pressed}, dwb2);
        mLstDrawables.addState(StateSet.WILD_CARD, dwb);

        setBackgroundDrawable(mLstDrawables);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:54:24.810

最终解决了这个问题：

```
 Drawable dwb = getResources().getDrawable(R.drawable.mainboard_btn_pen_colour);
    Bitmap immutable = BitmapFactory.decodeResource(getResources(), R.drawable.mainboard_btn_extra_time1);
    Bitmap mutable = immutable.copy(Bitmap.Config.ARGB_8888, true);
    Canvas c = new Canvas(mutable);
    Paint p = new Paint();
    p.setColor(getResources().getColor(R.color.mod_selected));
    p.setColorFilter(new PorterDuffColorFilter(getResources().getColor(R.color.mod_selected), PorterDuff.Mode.MULTIPLY));
    c.drawBitmap(mutable, 0.f, 0.f, p);
    BitmapDrawable dwb3 = new BitmapDrawable(getResources(), mutable);

    mLstDrawables.addState(new int[] {android.R.attr.state_pressed}, dwb3);
    mLstDrawables.addState(StateSet.WILD_CARD, dwb);

    setBackgroundDrawable(mLstDrawables); 
```

# javascript - 如何将变量传递给“window.open”？

> ID：12133140
> 
> 赞同：0
> 
> 时间：2012-08-26T19:19:19.197
> 
> 标签：javascript, variables, popup, size, window.open

我`window.open`在 JavaScript 中的操作遇到了一些问题，并且可以使用一些指针（我已经到处搜索了！）。我想将宽度和高度设置为我之前定义的变量的值（并根据现在的时间进行设置）。这是代码：

```
<head>
    <meta charset="utf-8" />
    <title>Untitled</title>
    <meta name="generator" content="BBEdit 10.1" />

    <script type = "text/javascript">

var d = new Date();
var h = d.getHours();
var m = d.getMinutes();

m = Math.round(parseInt(m)/5)*5;

var x;
var y;

function test() {getY(); getX(); alert(h); alert(m); alert(y); alert(x);}

function getX() {

if (m==0)
    {x=200;}
else if (m==5)
    {x=210;}

***CONTINUED DOWN TO:

else if (m==50)
    {x=290;}
else
    {x=300;}
}

function getY() {

if (h==0)
    {y=200;}
else if (h==1)
    {y=210;}

***CONTINUED DOWN TO:

else if (h==22)
    {y=420;}
else
    {y=430;}

}

var openWin = function(){window.open('','','width=x,height=y')};

</script>

</head>
<body onload="test()">
<input type="button" value="Open Window" onclick="openWin()" />
</body>
</html> 
```

我在加载时设置了一些警报，以检查变量是否设置正确，它们是……所以我不知道问题是什么！如果我在`window.open`语句中输入数字，它也可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:20:31.683

`'width=x,height=y'`是一个字符串。 `x`是一个字符，而不是一个变量。

您想将变量的*值*连接到字符串中：

```
"..." + x + "..." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T23:43:55.640

在尝试了您的代码后，我为您的问题找到了一种可能的解决方案。更改您的代码，以便该功能

> getX() 返回 x

和

> getY() 返回 y

然后更改函数的参数`window.open()`：

`var openWin = function(){window.open('','','width='+ getX(),'height=' + getY())};`

# c++ - 布尔函数不会从文本文件中读取所有输入

> ID：12133143
> 
> 赞同：1
> 
> 时间：2012-08-26T19:19:54.017
> 
> 标签：c++, class, fstream

嗨，我正在做一个学校项目，但我在使用特定功能时遇到了困难。我已经为此工作了一段时间，我将不胜感激任何类型的输入。

我们必须使用这个功能：

```
bool movieLibrary::readMovieInfo(ifstream& inFile)
{
    inFile>>rank>>year>>votes>>nationality;
    getline(inFile,nameMovie);

    if (rank < 1)
        return false;
    else
        return true;
} 
```

我的主要功能不断给出错误的输出：

```
#include "movieLibrary.h"
#include <iostream>
#include <fstream>

using namespace std;

int main()
{
movieLibrary myMovie[5];
ifstream inFile("myMovieLibrary.txt");

int i =0;

//my issue is here
while (myMovie[i].readMovieInfo(inFile))
{       
    i++;
    myMovie[i].readMovieInfo(inFile);   
}

for (int i=0;i<5;++i)
{
    myMovie[i].printMovieInfo("printList.txt");
}

return 0;
} 
```

这是输出，应该与输入相同，但这是我得到的：

```
3 2000 24446 b  Snatch
2 2008 1902 b  RocknRolla
5 2007 25510 a  American Gangster
-1 -858993460 -858993460 Ì 
-858993460 -858993460 -858993460 Ì 
```

这是输入：myMovieLibrary.txt

```
3 2000 24446 b Snatch
2 2004 2872 b Layer Cake
2 2008 1902 b RocknRolla
4 1999 7661 b Lock,Stock and Two Smoking Barrels
5 2007 25510 a American Gangster
-1
rank year votes Nationality (b:british; a:american) name 
```

这是 MovieLibrary 规范文件：

```
#include <string>

class movieLibrary
{
public:
movieLibrary();
~movieLibrary();

//void readMovieInfo(std::ifstream&);
bool readMovieInfo(std::ifstream&);
void printMovieInfo(char*);
char getNationality();
int getRank();
bool operator>=(movieLibrary) const;
bool operator<(movieLibrary) const;

private:
int rank; //rank I gave to the movie in my library
int year; //year the movie came out
int votes; //the number of votes that yahoo users gave the movie
std::string nameMovie; //the name of the movie
char nationality; //nationality of movie: b for british and a for american
}; 
```

和 MovieLibrary 的实现类：

```
#include "movieLibrary.h"
#include <fstream>
#include <string>

using namespace std; // here you can use that.

movieLibrary::movieLibrary()
{
}

movieLibrary::~movieLibrary()
{
}

bool movieLibrary::readMovieInfo(ifstream& inFile)
{
    inFile>>rank>>year>>votes>>nationality;
    getline(inFile,nameMovie);

    if (rank < 1)
        return false;
    else
        return true;
}

void movieLibrary::printMovieInfo(char* outFileName)
{
std::ofstream outFile;
if(!outFile.is_open()) 
    outFile.open(outFileName, std::ios::app);
outFile<<rank<<" "<<year<<" "<<votes<<" "<<nationality<<" "<<nameMovie<<std::endl;

}
int movieLibrary::getRank()
{
return rank;
}

char movieLibrary::getNationality()
{
return nationality;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T19:23:20.910

```
while (myMovie[i].readMovieInfo(inFile))
{       
    i++;
    myMovie[i].readMovieInfo(inFile);   
} 
```

此代码执行此操作：

```
myMovie[0].readMovieInfo(inFile); // loads Snatch into [0]
myMovie[1].readMovieInfo(inFile); // loads Layer Cake into [1]
myMovie[1].readMovieInfo(inFile); // loads RocknRolla into [1] 
myMovie[2].readMovieInfo(inFile); // loads Lock,Stock.. into [2]
myMovie[2].readMovieInfo(inFile); // loads Armerican Gangster into [2] 
// until it returns false 
```

readMoveInfo 的这种重复调用是导致您的程序覆盖每第二行的原因，例如 myMovie[1] 将首先包含“Layer Cake”，但在函数执行后将被“RocknRolla”覆盖`while()`。最简单的解决方案，正如已经指出的另一个答案，只是删除 readMovieInfo 的第二次调用，留下这个：

```
while (myMovie[i].readMovieInfo(inFile)) i++; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T19:24:57.753

由于您`readMovieInfo`在循环条件*以及*循环主体中调用，因此您将为除 0 之外的每个索引调用两次。

由于您在每次迭代中的第二次调用之前递增`i`，因此您将用第三个元素覆盖第二个元素，用第五个覆盖第四个元素，依此类推：您将丢失输入文件中的所有其他电影。这反映在您的输出中：第二和第四部电影消失了。

请记住，您的循环条件在*每次迭代*时都会进行测试，因此您需要小心条件测试的任何副作用。

您可以通过删除一个或其他调用来解决这个问题`readMovieInfo`（作为练习尝试两种方式进行），但我更希望看到您在`while`不调用`readMovieInfo`;的情况下写下您的条件 完成此操作后，请考虑*do/while*循环是否更好，以及为什么。

最后，请注意，您还应该检查您读取的元素是否超过了数组可以容纳的数量。当你这样做时，你的循环条件变得更加复杂。

# python - 以原生方式调用用户自定义函数 | Python

> ID：12133144
> 
> 赞同：1
> 
> 时间：2012-08-26T19:19:56.003
> 
> 标签：python, dynamic, load, user-defined-functions

我正在构建一个类似于 Mathwork 的 Simulink 或 Tanner-Spice 的系统，其中用户使用可用的运算符定义函数。然后我需要运行该函数并将响应返回给用户。我正在使用 Javascript 进行 UI 交互。在内部，用户定义函数 (UDF) 被捕获为 JSON 并传递到解析此 JSON 的 Python 服务器。

我的问题是，我现在如何运行这个 UDF？我不担心恶意用户利用这种能力进行黑客攻击，因为我所有的用户都是值得信赖的。

我认为的一种方法是将 UDF 作为 python 脚本写入磁盘，然后运行 ​​commands.getstatusoutput()。这里的问题是该函数可能需要多个输入，并且不可能传递这些输入。

我正在寻找的是能够动态加载新的 python 文件及其函数，并能够调用它们。

* * *

找到了一篇解释如何执行此操作的博客文章。我想问题是我没有使用正确的关键字进行搜索。

无论如何，David Janes 的博客[在这里](http://code.davidjanes.com/blog/2008/11/27/how-to-dynamically-load-python-code/)解释了如何动态加载 python 脚本。

如果有更好的方法来做我想做的事，我仍然会邀请你们发表评论并提出建议。

谢谢，尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T01:14:20.080

这是一个简单的类，它从代码字符串、文件或代码对象中创建类似模块的对象：

```
class DynamicModule(object):
    def __init__(self, code):
        exec code in self.__dict__ 
```

示例用法：

```
>>> mod = DynamicModule("""
... def foo(x, y):
...     print x**2 + y
... """)
>>> 
>>> mod.foo(10, 20) 
```

带有文件的示例（假设`/tmp/hello.py`包含一个名为 的函数`hello`）：

```
>>> mod2 = DynamicModule(open('/tmp/hello.py'))
>>> mod2.hello('World')
Hello, World! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T19:48:02.863

您可以为此使用该`exec`模块，因为输入是可信的。

`exec`文档：[http ://docs.python.org/reference/simple_stmts.html#exec](http://docs.python.org/reference/simple_stmts.html#exec)

文档摘录：

`This statement supports dynamic execution of Python code. The first expression should evaluate to either a string, an open file object, or a code object. If it is a string, the string is parsed as a suite of Python statements which is then executed (unless a syntax error occurs). [1] If it is an open file, the file is parsed until EOF and executed. If it is a code object, it is simply executed. In all cases, the code that’s executed is expected to be valid as file input (see section File input).`

但是，您应该注意，在使用时`exec`您不能在函数之外使用`return`or`yield`语句。

例子：

```
your_json_data="def example(arg1,arg2):    print arg1,arg2"
exec(your_json_data)
example("Hello","World")
##Output: "Hello World" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T02:35:02.693

要导入具有固定名称的 Python 文件，该文件位于`sys.path`：

```
import mod # it can import mod.py file

result = mod.some_function(*args) 
```

如果模块名称在字符串中，则导入模块：

```
import importlib

m = importlib.import_module("mod")
result = m.some_function(*args) 
```

如果您在字符串中包含模块的内容：

```
ns = {}
exec """

def some_function(a, b):
    return a + b

# other functions, classes or any code
""" in ns

result = ns['some_function'](1, 2)
print result # -> 3 
```

如果您不完全控制输入，那么您应该在受限环境中执行上述代码，例如，您可以将字符串发送到[沙盒 pypy 解释器](http://doc.pypy.org/en/latest/sandbox.html)。

### Python可以解析Python

有一个[`ast`模块](http://docs.python.org/dev/library/ast.html)可以帮助您以安全的方式解析和操作代码，例如：[Evaluating a math expression in a string](https://stackoverflow.com/a/9558001/4279)。

# cocos2d-iphone - 更改 CCMenuItem 图像？

> ID：12133145
> 
> 赞同：0
> 
> 时间：2012-08-26T19:20:01.350
> 
> 标签：cocos2d-iphone

我有一些复杂的菜单，每次都会根据州的不同而不同。

我有这个代码：

```
CCMenuItemSprite  *sign =  [CCMenuItemSprite itemWithNormalSprite:[CCSprite spriteWithFile:[NSString stringWithFormat:@"image%d.png",[memoryInstnace getCellImageNumber:i]]] selectedSprite:[CCSprite spriteWithFile:[NSString stringWithFormat:@"image%d.png",[memoryInstnace getCellImageNumber:i]]]];
CCMenuItemSprite  *playing =  [CCMenuItemSprite itemWithNormalSprite:[CCSprite spriteWithFile:@"playing.png"]
                                                              selectedSprite:[CCSprite spriteWithFile:@"playing.png"]];
            item2=[CCMenuItemToggle itemWithTarget:self selector:@selector(play:)items:sign,playing,nil];
            item2.position=pixels[i];
            item2.tag=i;

            Menu= [CCMenu menuWithItems: item2, nil]; 
```

这是一个切换按钮，所以当它在 A 上并被击中时，它会出现在 B 上，但我希望应用程序中的某个代表（而不是当有人击中它时）将它的 IMAGE 从 B 更改为 A 。

我不能`setNormalImage`对 item2 做。

我怎样才能做到这一点 ？谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:35:59.050

更改CCMenuItemToggle 项目的 selectedIndex 应该可以解决问题[。](http://www.learn-cocos2d.com/api-ref/latest_2.x/cocos2d-iphone/html/interface_c_c_menu_item_toggle.html#adca18155325c3693317fa1b472dc6078)这将通过否定当前 selectedIndex 来切换选定状态（即 0 变为 YES，因此 1 和 1 变为 NO，因此 0）：

```
item.selectedIndex = !item.selectedIndex; 
```

# box2d - AndEngine 物理 - 我的角色在移动时会颤抖

> ID：12133146
> 
> 赞同：1
> 
> 时间：2012-08-26T19:20:22.847
> 
> 标签：box2d, sprite, andengine, physics

我在 AndEngine 中遇到了物理问题。我的精灵在移动时会颤抖，有时还会跳跃。我制作了 32x32 的盒子“地板”，每个人都是另一个身体，所以我认为这是问题所在（与他们的角落或其他东西发生碰撞）。我尝试使用一种形状而不是那些盒子，但问题仍然存在。

看起来我的地板表面不是直的，而是不规则的......

我的问题是，如何让我的角色在这个表面上顺利移动？

顺便说一句，如何让我的角色更重？

我的整个代码在这里：

```
private final int CAMERA_WIDTH = 800;
private final int CAMERA_HEIGHT = 480;

enum PlayerAction {
    RUN,
    NONE,
    JUMP
}

enum Direction {
    RIGHT,
    LEFT,
    NONE
}

enum BodyId {
    PLAYER,
    BOX
}

Direction mPlayerDirection = Direction.NONE;
Direction mLastPlayerDirection = Direction.NONE;

private Camera mCamera;
private Scene mGameScene;

private PhysicsWorld mPhysicsWorld;

private BitmapTextureAtlas mBoxBitmapTextureAtlas;
private BitmapTextureAtlas mPlayerBitmapTextureAtlas;
private ITextureRegion mBoxTextureRegion;
private TiledTextureRegion mPlayerTextureRegion;

private AnimatedSprite mPlayer;
private Body mPlayerBody;

private BitmapTextureAtlas mOnScreenControlTexture;
private ITextureRegion mOnScreenControlBaseTextureRegion;
private ITextureRegion mOnScreenControlKnobTextureRegion;

private AnalogOnScreenControl mAnalogOnScreenControl;

@Override
public EngineOptions onCreateEngineOptions() {

    this.mCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);
    EngineOptions mEngineOptions = new EngineOptions(true, ScreenOrientation.LANDSCAPE_FIXED, new FillResolutionPolicy(), this.mCamera);
    mEngineOptions.getTouchOptions().setNeedsMultiTouch(true);

    return mEngineOptions;
}
@Override
public void onCreateResources(
        OnCreateResourcesCallback pOnCreateResourcesCallback)
        throws Exception {

    BitmapTextureAtlasTextureRegionFactory.setAssetBasePath("gfx/");
    this.mBoxBitmapTextureAtlas = new BitmapTextureAtlas(this.getTextureManager(), 32, 32, TextureOptions.BILINEAR);
    this.mBoxTextureRegion = BitmapTextureAtlasTextureRegionFactory.createFromAsset(this.mBoxBitmapTextureAtlas, this, "box.png", 0, 0);
    this.mBoxBitmapTextureAtlas.load();

    this.mPlayerBitmapTextureAtlas = new BitmapTextureAtlas(this.getTextureManager(), 256, 128, TextureOptions.BILINEAR);
    this.mPlayerTextureRegion = BitmapTextureAtlasTextureRegionFactory.createTiledFromAsset(this.mPlayerBitmapTextureAtlas, this, "player.png", 0, 0, 3, 4);
    this.mPlayerBitmapTextureAtlas.load();

    this.mOnScreenControlTexture = new BitmapTextureAtlas(this.getTextureManager(), 256, 128, TextureOptions.BILINEAR);
    this.mOnScreenControlBaseTextureRegion = BitmapTextureAtlasTextureRegionFactory.createFromAsset(this.mOnScreenControlTexture, this, "onscreen_control_base.png", 0, 0);
    this.mOnScreenControlKnobTextureRegion = BitmapTextureAtlasTextureRegionFactory.createFromAsset(this.mOnScreenControlTexture, this, "onscreen_control_knob.png", 128, 0);
    this.mOnScreenControlTexture.load();

    pOnCreateResourcesCallback.onCreateResourcesFinished();
}
@Override
public void onCreateScene(OnCreateSceneCallback pOnCreateSceneCallback)
        throws Exception {

    this.mGameScene = new Scene();

    initPhysics(this.mGameScene);

    for(int i = 0; i <= 50; i++) {
        Sprite sprite = new Sprite(i*32, this.mCamera.getHeight() - this.mBoxTextureRegion.getHeight(), this.mBoxTextureRegion, this.getVertexBufferObjectManager());
        createBody(sprite, BodyType.StaticBody, 1, 0, 0, BodyId.BOX);
        this.mGameScene.attachChild(sprite);
    }

    /* Calculate the coordinates for the face, so its centered on the camera. */
    final float playerX = (CAMERA_WIDTH - this.mPlayerTextureRegion.getWidth()) / 2;
    final float playerY = CAMERA_HEIGHT - this.mPlayerTextureRegion.getHeight() - 128;

    this.mPlayer = new AnimatedSprite(playerX, playerY, this.mPlayerTextureRegion, this.getVertexBufferObjectManager()) {

        @Override
        protected void onManagedUpdate(float pSecondsElapsed) {
            super.onManagedUpdate(pSecondsElapsed);
            switch (mPlayerDirection) {
            case RIGHT:
                if (!mPlayerDirection.equals(mLastPlayerDirection)) {
                    mLastPlayerDirection = Direction.RIGHT;
                    GameActivity.this.mPlayer.animate(new long[]{200, 200, 200}, 3, 5, true);
                }
                break;
            case LEFT:
                if (!mPlayerDirection.equals(mLastPlayerDirection)) {
                    mLastPlayerDirection = Direction.LEFT;
                    GameActivity.this.mPlayer.animate(new long[]{200, 200, 200}, 9, 11, true);
                }
                break;
            case NONE:
                mLastPlayerDirection = Direction.NONE;
                GameActivity.this.mPlayer.setCurrentTileIndex(6);
                GameActivity.this.mPlayer.stopAnimation();
                break;
            default:
                mLastPlayerDirection = Direction.NONE;
                GameActivity.this.mPlayer.setCurrentTileIndex(6);
                GameActivity.this.mPlayer.stopAnimation();
                break;
            }
        }
    };

    this.mPlayer.setScaleCenterY(this.mPlayerTextureRegion.getHeight());
    this.mPlayer.setScale(2);
    this.mGameScene.attachChild(this.mPlayer);

    this.mCamera.setChaseEntity(mPlayer);

    this.mPlayerBody = createMovingBody(this.mPlayer, BodyType.DynamicBody, 1, 0, 0, BodyId.PLAYER);

    this.mAnalogOnScreenControl = new AnalogOnScreenControl(32, CAMERA_HEIGHT - this.mOnScreenControlBaseTextureRegion.getHeight() - 32, this.mCamera, this.mOnScreenControlBaseTextureRegion, this.mOnScreenControlKnobTextureRegion, 0.1f, 200, this.getVertexBufferObjectManager(), new IAnalogOnScreenControlListener() {
        @Override
        public void onControlChange(final BaseOnScreenControl pBaseOnScreenControl, final float pValueX, final float pValueY) {

            GameActivity.this.mPlayerBody.setLinearVelocity(new Vector2(pValueX*10, GameActivity.this.mPlayerBody.getLinearVelocity().y));

            if (pValueX > 0)
                GameActivity.this.mPlayerDirection = Direction.RIGHT;
            else if (pValueX < 0)
                GameActivity.this.mPlayerDirection = Direction.LEFT;
            else
                GameActivity.this.mPlayerDirection = Direction.NONE;
        }

        @Override
        public void onControlClick(
                AnalogOnScreenControl pAnalogOnScreenControl) {
            GameActivity.this.mPlayerBody.setLinearVelocity(new Vector2(GameActivity.this.mPlayerBody.getLinearVelocity().x, -8.0f));
        }
    });

    this.mAnalogOnScreenControl.getControlBase().setBlendFunction(GLES20.GL_SRC_ALPHA, GLES20.GL_ONE_MINUS_SRC_ALPHA);
    this.mAnalogOnScreenControl.getControlBase().setAlpha(0.2f);
    this.mAnalogOnScreenControl.getControlBase().setScaleCenter(0, 128);
    this.mAnalogOnScreenControl.getControlBase().setScale(1.25f);
    this.mAnalogOnScreenControl.getControlKnob().setScale(1.25f);
    this.mAnalogOnScreenControl.refreshControlKnobPosition();

    this.mGameScene.setChildScene(this.mAnalogOnScreenControl);

    pOnCreateSceneCallback.onCreateSceneFinished(this.mGameScene);
}
@Override
public void onPopulateScene(Scene pScene,
        OnPopulateSceneCallback pOnPopulateSceneCallback) throws Exception {

    this.mEngine.registerUpdateHandler(new TimerHandler(3f, true, new ITimerCallback() {
        @Override
        public void onTimePassed(TimerHandler pTimerHandler) {
            // TODO Auto-generated method stub

        }

    }));

    pOnPopulateSceneCallback.onPopulateSceneFinished();
}

private void initPhysics(Scene pScene)
{
    mPhysicsWorld = new PhysicsWorld(new Vector2(0, SensorManager.GRAVITY_EARTH), false);
    pScene.registerUpdateHandler(mPhysicsWorld);
}

private Body createBody(Sprite pSprite, BodyType pBodyType, float pDensity, float pElasticity, float pFriction, BodyId pBodyId)
{
    final FixtureDef objectFixtureDef = PhysicsFactory.createFixtureDef(pDensity, pElasticity, pFriction);
    Body body = PhysicsFactory.createBoxBody(this.mPhysicsWorld, pSprite, pBodyType, objectFixtureDef);
    body.setUserData(pBodyId);
    return body;
}

private Body createMovingBody(Sprite pSprite, BodyType pBodyType, float pDensity, float pElasticity, float pFriction, BodyId pBodyId) {
    Body body = createBody(pSprite, pBodyType, pDensity, pElasticity, pFriction, pBodyId);
    mPhysicsWorld.registerPhysicsConnector(new PhysicsConnector(pSprite, body, true, false));
    return body;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T11:39:15.157

我认为这可能是由于 CPU 速度不足造成的。当处理器无法满足 Box2D 的需求时，模拟就会受到影响。身体可能会稍微落入地板占据的空间，并在下一个模拟循环中被向上推。当某些后台应用程序导致 CPU 负载激增时，也会发生这种情况。

尝试在速度更快的手机或没有其他应用程序在后台运行的手机上运行该应用程序。我使用伟大的 MaxStepPhysicsWorld 解决了类似的问题，可以在这里找到：[http ://www.andengine.org/forums/features/max-step-physics-to-avoid-choppyness-and-bad-simulation-t1271.html](http://www.andengine.org/forums/features/max-step-physics-to-avoid-choppyness-and-bad-simulation-t1271.html)

它的工作方式是，当引擎每秒无法执行足够的模拟步骤时，MaxStepPhysicsWorld 放弃实时性，而是每秒执行足够的模拟步骤，从而确保良好的模拟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T21:26:55.257

好的，我已经解决了！

如果有人感兴趣：我使用了[这里](http://www.andengine.org/forums/development/collision-side-t5156-10.html)的函数，因为我想检查我的身体从哪一侧与其他人发生碰撞。我更改了此功能以供使用，因此：

1.  我已经修改了它的`shrinkToFactor`值用法，所以它实际上并没有改变所有三角形的大小，而是在角落之间留出空间，所以如果你接触地面，你不会与 3 个三角形发生碰撞，而只会与其中一个发生碰撞。（但这是另一个故事，也许有人需要它或会觉得有用）
2.  我稍微“切割”了底部夹具的边缘，所以它在边缘上滑动而不是被它们挡住，这是我的底部夹具矢量定义：

    ```
     final Vector2[] vertices2 = { // DOWN
                new Vector2((wd2 - shrinkToFactor - 1) / P2M, (hd2 - 1) / P2M),
                new Vector2((wd2 - shrinkToFactor) / P2M, hd2 / P2M),
                new Vector2((-wd2 + shrinkToFactor) / P2M, hd2 / P2M),
                new Vector2((-wd2 + shrinkToFactor + 1) / P2M, (hd2 - 1) / P2M),
                new Vector2(0 / P2M, 0 / P2M)
        }; 
    ```

这是我的全部功能。

```
 public static Body createPlayerBody(final MaxStepPhysicsWorld pPhysicsWorld, final Sprite pSprite, final FixtureDef pFixtureDef, final float pPixelToMeterRatio, final BodyType bodyType, final float shrinkToFactor) {
        final BodyDef bodyDef = new BodyDef();
        bodyDef.type = bodyType;
        final float P2M = pPixelToMeterRatio;

        final float[] sceneCenterCoordinates = pSprite.getSceneCenterCoordinates();
        bodyDef.position.x = sceneCenterCoordinates[Constants.VERTEX_INDEX_X] / P2M;
        bodyDef.position.y = sceneCenterCoordinates[Constants.VERTEX_INDEX_Y] / P2M;

        final Body boxBody = pPhysicsWorld.createBody(bodyDef);

        final float wd2 = (pSprite.getWidth() / 2);
        final float hd2 = (pSprite.getHeight() / 2);

        final Vector2[] vertices1 = { // RIGHT
                new Vector2(wd2 / P2M, (hd2 - shrinkToFactor) / P2M),
                new Vector2(0 / P2M, 0 / P2M),
                new Vector2(wd2 / P2M, (-hd2 + shrinkToFactor) / P2M)
        };
        final Vector2[] vertices2 = { // DOWN
                new Vector2((wd2 - shrinkToFactor - 1) / P2M, (hd2 - 1) / P2M),
                new Vector2((wd2 - shrinkToFactor) / P2M, hd2 / P2M),
                new Vector2((-wd2 + shrinkToFactor) / P2M, hd2 / P2M),
                new Vector2((-wd2 + shrinkToFactor + 1) / P2M, (hd2 - 1) / P2M),
                new Vector2(0 / P2M, 0 / P2M)
        };
        final Vector2[] vertices3 = { // LEFT
                new Vector2(-wd2 / P2M, (hd2 - shrinkToFactor) / P2M),
                new Vector2(-wd2 / P2M, (-hd2 + shrinkToFactor) / P2M),
                new Vector2(0 / P2M, 0 / P2M)
        };
        final Vector2[] vertices4 = { // UP
                new Vector2((-wd2 + shrinkToFactor) / P2M, -hd2 / P2M),
                new Vector2((wd2 - shrinkToFactor) / P2M, -hd2 / P2M),
                new Vector2(0 / P2M, 0 / P2M)
        };

        PolygonShape poly = new PolygonShape();
        pFixtureDef.shape = poly;
        poly.set(vertices1);
        final Fixture f1 = boxBody.createFixture(pFixtureDef);
        f1.setUserData(BodyId.PLAYER);
        poly.set(vertices2);
        final Fixture f2 = boxBody.createFixture(pFixtureDef);
        f2.setUserData(BodyId.PLAYER_FOOT);
        poly.set(vertices3);
        final Fixture f3 = boxBody.createFixture(pFixtureDef);
        f3.setUserData(BodyId.PLAYER);
        poly.set(vertices4);
        final Fixture f4 = boxBody.createFixture(pFixtureDef);
        f4.setUserData(BodyId.PLAYER_HEAD);
        poly.dispose();

        return boxBody;
} 
```

# asp.net-mvc - 实体框架从两个不同模式中的两个表中选择数据

> ID：12133150
> 
> 赞同：0
> 
> 时间：2012-08-26T19:20:54.307
> 
> 标签：asp.net-mvc, database, entity-framework

我正在尝试使用实体框架为我的 mvc4 应用程序做一个简单的请求。我想从两个表中选择数据。

一张表在 Membership Provider 模式中，而另一张在我的主表中。SQL请求是：

```
select users.my_aspnet_users.name, invitations.sender from users.my_aspnet_users, invitations where invitations.sender = my_aspnet_users.id; 
```

我知道如何为一个表选择数据，但是在处理两个表时看起来会有所不同，尤其是当这些表不在同一个模式中时。

此外，我只为主架构生成了 .edmx 文件（即导入了架构）。Membership Provider shema 由`System.Web.Security`.

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T16:34:49.067

我认为你需要一个复杂的类型

# git - git-config(1) 说“仅当输出到终端时才使用颜色”是什么意思？

> ID：12133153
> 
> 赞同：7
> 
> 时间：2012-08-26T19:21:41.043
> 
> 标签：git, cygwin, msysgit, git-config, rxvt

我正在输出到终端，但 Git 没有正确检测到我正在输出到终端，以便为输出着色。我的问题是，当 git-config(1) 说“仅当输出到终端时才使用颜色”时，它的真正含义是什么（这个短语出现在多个配置描述的末尾，例如 color.ui 和 color 。分支）？换句话说，Git 如何决定它是否输出到终端，以及如何更改我的环境设置以通知 Git 我的终端确实是一个终端？

细节：
我在 Windows 上使用带有 Cygwin 的 rxvt 终端。我也安装了 MSysGit。当我进行 Git 配置设置时：

```
[color]
    ui = auto
    branch = auto
    status = auto 
```

我的终端输出中仍然没有颜色。但是，当我切换到

```
[color]
    ui = always
    branch = always
    status = always 
```

然后有正确的彩色输出。但是，为了正确处理实际的非终端情况，我需要切换回“自动”，而不是“始终”。因此，为了使“自动”正常工作：如何更改我的环境以使 Git 认识到我的 rxvt+Cygwin 是能够支持颜色的终端？

（PS。由于比这个相对较小的颜色问题更大的问题，我不能使用 Cygwin 版本的 Git。请不要回复告诉我切换到 Cygwin 版本。）

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:32:50.707

[这个问题](https://stackoverflow.com/questions/911168/detect-if-shell-script-is-running-through-a-pipe)可能值得一看，它涵盖了检测输出到终端（即 tty 会话）与将输出重定向到另一个进程之间的差异。我假设这就是 git 在“进入终端”的措辞中的意思，输出实际上是进入 tty 会话。

# html - 鼠标悬停在链接上时不出现 Css 菜单

> ID：12133156
> 
> 赞同：0
> 
> 时间：2012-08-26T19:21:56.777
> 
> 标签：html, css

这是我的 CSS 规则

```
<style type="text/css">
#navigation2 {

    font: 0.80em Arial, Helvetica, sans-serif;
    width:100%;
}

#navigation2 ul {
    margin:0; 
    padding:0;
    background-color:transparent;
}

#navigation2 li {
    list-style: none;
    background:#fff;
}

ul.top-category{
    display:none;   
}

ul.top-category li {
    border: #6092bc solid;
    border-width: 1px;
    margin-top:1px;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
}

#navigation2 a {
 color: #265d8c;
 cursor: pointer;
 display:block;                 
 text-decoration:none;
 margin-left:3%;
 margin-top:5%;
 margin-bottom:5%;
 width:100%;
}

#navigation2 li:hover {
 background: #ebf2f6;
 position: relative;
}

a.all-categories:hover ul.top-category{
     display:block;
}
</style> 
```

这是我的html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"         
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
    <a  href="#" class="all-categories" >  All Categories </a> 

                    <div id="navigation2">

                       <ul class="top-category">
                          <li><a href="#">Kategori1</a></li>
                          <li><a href="#">Kategori2</a></li>
                          <li><a href="#">Kategori3</a></li>
                          <li><a href="#">Kategori4</a></li>
                          <li><a href="#">Kategori5</a></li>
                       </ul>
                    </div> 
</body>
</html> 
```

我有一个 CSS 菜单，它在`display:block`. 我希望当鼠标悬停在链接上时菜单会打开，但我无法做出任何反应。你能解释一下我错过了什么吗？谢谢你的建议..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:35:29.247

试试这个[http://jsfiddle.net/yf4W8/4/](http://jsfiddle.net/yf4W8/4/)

你的问题在于这条线

```
a.all-categories:hover ul.top-category{
     display:block;
} 
```

这意味着 UL 是您的链接元素的子元素，但事实并非如此

```
a.all-categories:hover + #navigation2 ul.top-category{
     display:block;
} 
```

`+`用于选择`#navigation2`，这是您的链接的兄弟**，**然后我们选择 ，`ul`因为它是 的孩子`#navigation2`。如果你想进一步了解 CSS 选择器，你可能想看看[这个列表](http://net.tutsplus.com/tutorials/html-css-techniques/the-30-css-selectors-you-must-memorize/)。

通过更改代码以匹配上述内容，您将选择子菜单父容器并正确应用悬停样式

# c# - 在 C# 中拆分数组的最快（便携式）方法

> ID：12133163
> 
> 赞同：6
> 
> 时间：2012-08-26T19:22:38.587
> 
> 标签：c#, optimization

我正在编写一个完全托管的 Mercurial 库（将用于[Windows 的完全托管的 Mercurial Server](http://hglabhq.com/)，即将推出），我遇到的最严重的性能问题之一是，奇怪的是，将数组拆分为多个部分。

这个想法如下：有一个字节数组，大小从几百字节到一兆字节不等，我需要做的就是将它拆分为由字符分隔的部分，在我的特定情况下，`\n`字符。

现在 dotTrace 向我展示的是我的[“优化”版本](http://pastie.org/4592828)（`Split`代码*是*正确的，[这是我开始使用的幼稚](http://pastie.org/4592982)版本）在 2,300 次调用中占用了 11 秒（dotTrace 本身引入了明显的性能影响，但一切都取决于规模）。

以下是数字：

*   `unsafe`版本：`11 297`ms 用于`2 312`通话
*   托管（“天真”）版本：调用`20 001`毫秒`2 312`

所以这里是：在 C# 中拆分数组的最快（最好是可移植的，这意味着同时支持 x86 和 x64）方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T20:39:43.210

我相信问题是，你在循环中做很多复杂的操作。此代码删除了循环内除单次加法和比较之外的所有操作。只有在检测到拆分或在数组末尾时才会发生其他复杂的事情。

此外，很难判断您使用什么样的数据运行测试，所以这只是猜测。

```
public static unsafe Segment[] Split2(byte[] _src, byte value)
{
    var _ln = _src.Length;

    if (_ln == 0) return new Segment[] { };

    fixed (byte* src = _src)
    {
        var segments = new LinkedList<Segment>(); // Segment[c];

        byte* last = src;
        byte* end = src + _ln - 1;
        byte lastValue = *end;
        *end = value; // value-termination

        var cur = src;
        while (true)
        {
            if (*cur == value)
            {
                int begin = (int) (last - src);
                int length = (int) (cur - last + 1);
                segments.AddLast(new Segment(_src, begin, length));

                last = cur + 1;

                if (cur == end)
                {
                    if (lastValue != value)
                    {
                        *end = lastValue;
                    }
                    break;
                }
            }
            cur++;
        }

        return segments.ToArray();
    }
} 
```

**编辑**：固定代码，因此它返回正确的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T19:58:23.203

对于 Split，在 32 位机器上处理 ulong 真的很慢，所以一定要减少到 uint。如果你真的想要ulong，实现两个版本，一个是32位的，一个是64位的。

您还应该衡量一次处理字节是否更快。

需要剖析内存分配的成本。如果它足够大，请尝试在多个调用中重用内存。

其他：

ToString：使用 "(" + Offset.ToString() + ", " + Length.ToString() + ")" 更快；

GetHashCode：尝试固定（字节 * b = & 缓冲区 [偏移量]）

* * *

如果多次使用，这个版本应该非常快。关键点：内部数组扩展到合适大小后没有新的内存分配，最小的数据复制。

```
class ArraySplitter
{
    private byte[] m_data;
    private int    m_count;
    private int[]  m_stops;

    private void AddRange(int start, int stop)
    {
        // Skip empty range
        if (start > stop)
        {
            return;
        }

        // Grow array if needed
        if ((m_stops == null) || (m_stops.Length < (m_count + 2)))
        {
            int[] old = m_stops;

            m_stops = new int[m_count * 3 / 2 + 4];

            if (old != null)
            {
                old.CopyTo(m_stops, 0);
            }
        }

        m_stops[m_count++] = start;
        m_stops[m_count++] = stop;
    }

    public int Split(byte[] data, byte sep)
    {
        m_data  = data;
        m_count = 0;      // reuse m_stops

        int last = 0;

        for (int i = 0; i < data.Length; i ++)
        {
            if (data[i] == sep)
            {
                AddRange(last, i - 1);
                last = i + 1;
            }
        }

        AddRange(last, data.Length - 1);

        return m_count / 2;
    }

    public ArraySegment<byte> this[int index]
    {
        get
        {
            index *= 2;
            int start = m_stops[index];

            return new ArraySegment<byte>(m_data, start, m_stops[index + 1] - start + 1);
        }
    }
} 
```

* * *

测试程序：

```
 static void Main(string[] args)
    {
        int count = 1000 * 1000;

        byte[] data = new byte[count];

        for (int i = 0; i < count; i++)
        {
            data[i] = (byte) i;
        }

        Stopwatch watch = new Stopwatch();

        for (int r = 0; r < 10; r++)
        {
            watch.Reset();
            watch.Start();

            int len = 0;

            foreach (var seg in data.MySplit(13))
            {
                len += seg.Count;
            }

            watch.Stop();

            Console.WriteLine("MySplit      : {0} {1,8:N3} ms", len, watch.Elapsed.TotalMilliseconds);

            watch.Reset();
            watch.Start();

            ArraySplitter splitter = new ArraySplitter();

            int parts = splitter.Split(data, 13);

            len = 0;

            for (int i = 0; i < parts; i++)
            {
                len += splitter[i].Count;
            }

            watch.Stop();
            Console.WriteLine("ArraySplitter: {0} {1,8:N3} ms", len, watch.Elapsed.TotalMilliseconds);
        }
    } 
```

结果：

```
MySplit      : 996093    9.514 ms
ArraySplitter: 996093    4.754 ms
MySplit      : 996093    7.760 ms
ArraySplitter: 996093    2.710 ms
MySplit      : 996093    8.391 ms
ArraySplitter: 996093    3.510 ms
MySplit      : 996093    9.677 ms
ArraySplitter: 996093    3.468 ms
MySplit      : 996093    9.685 ms
ArraySplitter: 996093    3.370 ms
MySplit      : 996093    9.700 ms
ArraySplitter: 996093    3.425 ms
MySplit      : 996093    9.669 ms
ArraySplitter: 996093    3.519 ms
MySplit      : 996093    9.844 ms
ArraySplitter: 996093    3.416 ms
MySplit      : 996093    9.721 ms
ArraySplitter: 996093    3.685 ms
MySplit      : 996093    9.703 ms
ArraySplitter: 996093    3.470 ms 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-18T01:01:04.000

安东，

我不知道你是否还有兴趣优化这个，因为这个线程已经很老了，但是我看到你的代码在你的在线存储库中几乎是一样的，所以我想我会试一试。在评估您的 HgLab 应用程序时，我查看了您在 bitbucket.org 上的 HgSharp 代码。我使用本机构造重写了函数，大大简化了它。我的测试比你原来的程序节省了一半以上的时间。我通过加载一个几兆字节的源文件来测试它，并使用您的原始例程将时间与相同操作的性能进行比较。

除了重写基本逻辑之外，我决定使用`ArraySegment<>`框架内置的原生而不是您的自定义实现。唯一显着的区别是`ArraySegment<>`公开`Count`属性而不是`Length`属性。下面的代码不需要 unsafe 关键字，因为我没有使用指针，但是如果更改为这样做，似乎确实会有轻微的性能改进。

* * *

```
 public static ArraySegment<byte>[] SplitEx(this byte[] source, byte value) {
        var _previousIndex = -1;
        var _segments = new List<ArraySegment<byte>>();
        var _length = source.Length;

        if (_length > 0) {
            int _index;

            for (_index = 0; _index < _length; _index++) {
                var _value = source[_index];
                if (_value == value) {
                    _segments.Add(new ArraySegment<byte>(source, _previousIndex + 1, _index - _previousIndex));
                    _previousIndex = _index;
                }
            }

            if (--_index != _previousIndex) {
                _segments.Add(new ArraySegment<byte>(source, _previousIndex + 1, _index - _previousIndex));
            }
        }

        return _segments.ToArray();
    } 
```

# php - Facebook 页面选项卡，试图回显 Facebook 图形数据，但无法正常工作

> ID：12133165
> 
> 赞同：0
> 
> 时间：2012-08-26T19:22:50.040
> 
> 标签：php, facebook-graph-api, facebook-php-sdk, facebook-apps, facebook-page

我正在尝试为我的 facebook 页面选项卡创建一个应用程序实例。

我以前做过，但由于某种原因，我似乎无法检索任何用户图形信息，也无法在页面上回显任何图形信息。我已经尝试在多个用户帐户上查看我的页面选项卡进行测试，所有操作都相同。

所以我直接回到开头，使用 github 上 sdk 中的示例重新开始。但甚至不能让他们工作！

请查看我的应用程序实例（这直接取自：[https ://raw.github.com/facebook/facebook-php-sdk/master/examples/example.php](https://raw.github.com/facebook/facebook-php-sdk/master/examples/example.php)

我正在使用最新的 sdk：[https ://github.com/facebook/facebook-php-sdk](https://github.com/facebook/facebook-php-sdk)

```
<?php

require 'facebook-php-sdk-98f2be1/src/facebook.php';

$facebook = new Facebook(array(
  'appId'  => '----------------',
  'secret' => '---------------------------------',
));

$user = $facebook->getUser();

if ($user) {
  try {
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
  $loginUrl = $facebook->getLoginUrl();
}

?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>php-sdk</title>
  </head>
  <body>
    <h1>php-sdk</h1>

    <?php if ($user): ?>
      <a href="<?php echo $logoutUrl; ?>">Logout</a>
    <?php else: ?>
      <div>
        Login using OAuth 2.0 handled by the PHP SDK:
        <a href="<?php echo $loginUrl; ?>">Login with Facebook</a>
      </div>
    <?php endif ?>

    <h3>PHP Session</h3>
    <pre><?php print_r($_SESSION); ?></pre>

    <?php if ($user): ?>
      <h3>You</h3>
      <img src="https://graph.facebook.com/<?php echo $user; ?>/picture">

      <h3>Your User Object (/me)</h3>
      <pre><?php print_r($user_profile); ?></pre>
    <?php else: ?>
      <strong><em>You are not Connected.</em></strong>
    <?php endif ?>

  </body>
</html> 
```

不，由于某种原因，它要求我登录，当我已经登录时呢？

php 必须没有错误，因为它正在工作 - 但似乎永远不会工作让我连接以查看我的图表。

然后我点击登录，我只看到这个屏幕......

![在此处输入图像描述](../Images/72a6cc739cd1a2607e25a4140ccf855c.png)

这些是我在开发人员 Facebook 中的应用程序设置...

![在此处输入图像描述](../Images/10e36d7a1246072fcdfd22bd8e2def53.png)

显然，您可以看到我的任何 URL，但这些 100% 都是正确的凭据。

任何人都可以测试代码，看看他们是否得到相同的结果。我正在使用最新的 php SDK：[https ://github.com/facebook/facebook-php-sdk](https://github.com/facebook/facebook-php-sdk)

* * *

我正在尝试使用这个简单地回显当前的 facebook 用户“名称”，

但甚至可以做到这一点，所以回溯了 git hub 示例，看看我是否可以让示例应用程序实例工作，但它总是说“你没有连接”。

帮助或建议将非常感谢，我已经尝试了大多数事情..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T02:19:42.720

代码中的值存储在 $user_profile 变量下的数组中。因此，例如，名称将是 $user_profile['name']。这行代码：

```
$user_profile = $facebook->api('/me'); 
```

基本上是说，查询[http://graph.facebook.com](http://graph.facebook.com) ...然后将 /me 添加到 URL 的末尾，这是您应用程序的当前用户。如果你访问[http://graph.facebook.com/USER_ID](http://graph.facebook.com/USER_ID)，你会看到它都是一个数组，你可以看到你可以使用 $user_profile 访问哪些变量。

基本上添加一个数组值就可以了。

# r - 在 R 中创建变量列表以用于公式

> ID：12133168
> 
> 赞同：2
> 
> 时间：2012-08-26T19:21:54.700
> 
> 标签：r, regression

我有一个`dm`带有一些虚拟变量的数据框，`d1`, `d2`, `d3`。我想创建一个它们的列表`dummies`，并以简单的方式使用它，例如

```
lm(y~dummies+x,data=dm) 
```

可能吗？

我找到了两种方法，但我不喜欢它们：

1.  创建一个额外的数据框`dummies`。

2.  使用类似的东西`formula(paste('y~',dummies,...)`

第一种方法会吃掉内存，第二种方法很丑。有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T05:48:50.533

构造一个只包含感兴趣的变量的数据框，然后使用`y ~ .`，表示使用数据框中的所有列。

例如：

```
set.seed(1)
dm <- data.frame(
  y = rnorm(100),
  x = rnorm(100),
  d1 = sample(0:1, 100, replace=TRUE),
  d2 = sample(0:1, 100, replace=TRUE),
  d3 = sample(0:1, 100, replace=TRUE)
)

lm(y ~ ., dm)
lm(formula = y ~ ., data = dm)

Coefficients:
(Intercept)            x           d1           d2           d3  
  -0.089440    -0.012945    -0.006305     0.391576    -0.034225 
```

# facebook - OAuth 令牌过期时间因帐户而异

> ID：12133169
> 
> 赞同：0
> 
> 时间：2012-08-26T19:23:55.323
> 
> 标签：facebook, api, oauth

奇怪的问题，也许我在这里遗漏了一些东西。

在制作应用程序的过程中，当我使用我的凭据获得我的应用程序的许可时，我会获得一个 60 天的 OAuth 令牌。

但是当我的客户使用他的帐户为他的应用程序获取 OAuth 令牌时，他会获得一个 2 小时的令牌。[过期=6870]

我正在接受以下权限。

读取流、发布流、用户组

脚本保持不变，只是应用程序和帐户发生了变化。

我在这里错过了什么吗？？？

我看过他的应用程序设置，它是一样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T12:08:05.483

首先，忘记“offline_access”，该权限自几个月以来已被弃用。

其次，也许这会对你有所帮助，它在几周前的一个项目中对我有用： [How to extend access token validation since offline_access deprecation](https://stackoverflow.com/questions/8982025/how-to-extend-access-token-validity-since-offline-access-deprecation)

也许你有 60 天，因为你是应用程序的管理员，但我不确定。事实上，如今一个普通的访问令牌的有效期仅为 2 小时。

# javascript - $.width() 在使用自定义字体时返回不同的结果

> ID：12133171
> 
> 赞同：6
> 
> 时间：2012-08-26T19:23:59.663
> 
> 标签：javascript, jquery, html, css, fonts

情况如下：

```
$(document).ready(function(){
  // this will return different result
  alert($('#foo').width());
  // than this !!!
  setTimeout(function(){
    alert($('#foo').width());
  }, 1000);
}); 
```

CSS（`<head>`部分）：

```
<link href='http://fonts.googleapis.com/css?family=Headland+One' rel='stylesheet' type='text/css'>
... and
#foo {
    font-family: 'Headland One', serif;
} 
```

当我使用标准字体（例如 Arial）时，一切都很好（`.width()`在两种情况下都返回相同的结果）

`setTimeout`除了获得正确的`.width()`值并保留自定义字体之外，还有什么解决方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-26T19:32:22.680

因为它加载了一个遥远的字体。您应该使用`$(window).load()`而不是`$(document).ready()`：第一个将在所有远程字体/样式表/脚本和图像都已下载时触发​​，第二个仅在 DOM 准备好时触发。

# mysql - 复合外键

> ID：12133176
> 
> 赞同：0
> 
> 时间：2012-08-26T19:24:20.173
> 
> 标签：mysql, foreign-keys, composite-key

我正在尝试使用**复合外键**创建一个表。我不知道这个创作有什么问题：

```
CREATE TABLE Album( 
Name VARCHAR(30),  
Bandname VARCHAR(30), 
PRIMARY KEY(Name, Bandname),  
Erscheinungsjahr VARCHAR(30),
MusiklabelName VARCHAR(30),
BName VARCHAR(30),
BGründungsjahr INT(11),
BGründungsort VARCHAR(30),
FOREIGN KEY (BaName, BaGründungsjahr, BaGründungsort) REFERENCES Band
(Name, Gründungsjahr, Gründungsort)
)  
ENGINE=INNODB 
```

我可以告诉你，列“Name”、“Gründungsjahr”和“Gründungsort”作为**复合主键存在于引用的****表带**中：

 **![表带](../Images/2d7735f4a7e963bf4b91df4b3b70f965.png)

显示的非特定错误是：

> # 1005 - 无法创建表“band.album”（错误号：150）

我希望你们中的某个人会有一个想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:01:03.663

我认为这是一个字符转换问题。尝试将字段名称中的变音符号更改为元音。**

# jquery - jQuery SVG-object 标签加载事件

> ID：12133181
> 
> 赞同：9
> 
> 时间：2012-08-26T19:24:44.413
> 
> 标签：jquery, onload-event, object-tag

我有一个通过 jQuery 将 SVG 动态添加到页面的页面：

```
grid.append($('<object>')
.load(function () {
    // do stuff
    alert('loaded')
})
.attr({
    id: 'tile',
    type: 'image/svg+xml',
    width: Math.round(tile_w),
    height: Math.round(tile_h),
    data: 'map/base.svg'
})
); 
```

我需要访问 SVG 文档（将变量“推送”到 svg 脚本上下文中），但必须为此加载 SVG。我的问题是我没有让加载事件工作。不显示警报。

怎么做？

**编辑：**似乎 jQuery 只是阻止将“加载”事件绑定到非图像或文档元素，所以我只使用“官方”addEventListener() 函数（愚蠢的 IE 不支持，但这没问题为了我）：

```
grid.append($('<embed>')
    .attr({
        id: 'tile' + i,
        type: 'image/svg+xml',
        width: Math.round(tile_w),
        height: Math.round(tile_h),
        src: 'map/base.svg'
     })
    .css({
        position: 'absolute',
        left: Math.round(p.x),
        top: Math.round(p.y)
    }).each(function (i){
        this.addEventListener ('load', function (e) {
            alert('loaded')
        })
    })
); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-26T19:33:49.070

我不知道`grid`你的例子是什么，但如果它是一个普通的 dom 元素，那么`load`api 调用应该是 api 文档中定义的格式。目前，您似乎正在尝试加载一个没有任何意义的函数调用。

```
.load( url [, data] [, complete(responseText, textStatus, XMLHttpRequest)] ) 
```

所以

```
grid.append($('<object>').load('image.svg',
    function (response, status, xhr) {
        if (status == 'success') {
            // yay the load is ok
            alert('loaded');
        }
    })
); 
```

[http://api.jquery.com/load/](http://api.jquery.com/load/)

更新：我没有尝试使用 HTML 将 SVG 数据加载到浏览器中，但 W3C 文档没有提到该`<object>`标签可以用于此目的。他们的示例使用`<embed>`

```
<embed src="circle1.svg" type="image/svg+xml" /> 
```

你试过用那个代替`<object>`吗？

**更新 2：**

我认为上述解决方案也不会起作用，因为`onload`以下标签支持 JS 事件`<body>, <frame>, <frameset>, iframe, <img>, <input type="image">, <link>, <script>, <style>`- 我认为这是 jQuery 所挂钩的，因此它只适用于这些元素。jQuery 文档说事件处理程序由`images, scripts, frames, iframes`对象`window`支持。

所以确实如果这不起作用，那么我想你只需要使用`.load()`方法调用并处理结果。也许您可以将 svg 嵌入标签放入单独的 html 文件中，或者拥有一个生成 html 嵌入的脚本。

[http://www.w3schools.com/jsref/event_onload.asp](http://www.w3schools.com/jsref/event_onload.asp)

**更新 3：**

对于这个问题，似乎至少有两个正确的解决方案。

1.  jQuery SVG 插件[http://keith-wood.name/svg.html](http://keith-wood.name/svg.html)

2.  [此处](https://stackoverflow.com/questions/6802283/jquery-appending-to-ajax-loaded-svg-problem)详细介绍的 jQuery`ajax()`调用，包括有关加载后与 svg 画布交互的信息。

# android - Only one BroadcastReceiver per application?

> ID：12133187
> 
> 赞同：4
> 
> 时间：2012-08-26T19:25:36.917
> 
> 标签：android, google-analytics

The Google Analytics SDK documentation mentions the following:

> Only one BroadcastReceiver class can be specified per application. Should you need to incorporate two or more BroadcastReceivers from different SDKs, you will need to create your own BroadcastReceiver class that will receive all broadcasts and call the appropriate BroadcastReceivers for each type of Broadcast.

[https://developers.google.com/analytics/devguides/collection/android/devguide](https://developers.google.com/analytics/devguides/collection/android/devguide)

Is this still true as of ICS and higher? In my current application I actually do have two receivers already and that seems to work just fine.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T21:29:24.150

I'm assuming this means that you can not have more than one BroadcastReceiver that listens for the same specific broadcast Inent (via intent-filter). I'd have to try this to see if it works.

In any case, we've had applications with many BroadcastReceivers since Android 1.6, so it is definitely possible to have many BroadcastReceivers in a single Application.

# html - 保证金属性 %

> ID：12133192
> 
> 赞同：0
> 
> 时间：2012-08-26T19:26:27.473
> 
> 标签：html, css

w3c 规范指出

> % 指定包含元素宽度百分比的边距

我想知道这是否也适用于垂直边距。最初我认为它没有，但我有一个使用绝对位置的容器 div 和一个使用静态位置的包含 div。包含的 div 的垂直边距**正好是宽度 html**而不是容器 div 的垂直边距，除非我也将包含的 div 的位置更改为绝对。因此，我想知道边距是否受文档布局的影响，以及它是否只占用包含元素的宽度。

更新：

改变 div2 的位置会改变大小。

**CSS：**

```
body {
  height:100%;
}

div {
}

#div1
{
  height: 50%;
  background: #333;
  padding:1px;
}

#div2
{
background-color:#000;
height:50%;
//position:static;
position:absolute;
margin:25%;
} 
```

**HTML：** `<div id="div1"><div id ="div2">this</div> </div>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:30:21.123

在 CSS 中，`margin`s 的百分比值（垂直和水平边距——以及`padding`百分比值）总是相对于元素的包含框的**宽度**计算。作为参考，您可以查看**CSS2.1**规范中的这一段：[little link](http://www.w3.org/TR/CSS21/box.html#margin-properties)。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T19:29:48.877

是的，尽管看起来有悖常理，但垂直百分比边距是相对于包含元素的**宽度**，而不是高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T19:42:01.607

是的。起初可能看起来很奇怪，但它有两个合理的原因：

1.  如果您为水平和垂直边距提供相同的百分比，它会使其更像您可能想要的。
2.  如果内容在元素内流动，并且容器随之扩展，那么垂直边距取决于垂直大小将使其依赖于某些东西，而后者又取决于垂直边距的大小！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T19:44:31.853

CSS 2.1 规范说[：`margin`](http://www.w3.org/TR/CSS2/box.html#propdef-margin) “百分比：指包含块的宽度”（块，而不是元素）。[包含块](http://www.w3.org/TR/CSS2/visudet.html#x0)的定义有特殊的规则，但是绝对定位的容器仍然（通过它的边缘）为静态定位的子定义包含块，我的测试符合这一点。如果您的测试另有建议，请发布您的示例代码。

# wordpress - 如何在 wordpress 中创建“路线”？

> ID：12133200
> 
> 赞同：14
> 
> 时间：2012-08-26T19:27:23.727
> 
> 标签：wordpress, api, routes, hook

为了我自己的理智，我正在尝试为一个看起来像这样的 ajax api 创建一个路由：

```
/api/<action> 
```

我希望 wordpress 处理这条路线并使用`do_action`. wordpress 是否给了我一个实现这个的钩子？哪里有好地方？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-05-31T18:46:56.330

你必须使用[add_rewrite_rule](http://codex.wordpress.org/Rewrite_API/add_rewrite_rule)

就像是：

```
add_action('init', 'theme_functionality_urls');

function theme_functionality_urls() {

  /* Order section by fb likes */
  add_rewrite_rule(
    '^tus-fotos/mas-votadas/page/(\d)?',
    'index.php?post_type=usercontent&orderby=fb_likes&paged=$matches[1]',
    'top'
  );
  add_rewrite_rule(
    '^tus-fotos/mas-votadas?',
    'index.php?post_type=usercontent&orderby=fb_likes',
    'top'
  );

} 
```

这会创建`/tus-fotos/mas-votadas`and `/tus-fotos/mas-votadas/page/{number}`，这会更改我在 pre_get_posts 过滤器中处理的自定义查询变量的 orderby 查询变量。

也可以使用`query_vars`过滤器添加新变量并将其添加到重写规则中。

```
add_filter('query_vars', 'custom_query_vars');
add_action('init', 'theme_functionality_urls');

function custom_query_vars($vars){
  $vars[] = 'api_action';
  return $vars;
}

function theme_functionality_urls() {

  add_rewrite_rule(
    '^api/(\w)?',
    'index.php?api_action=$matches[1]',
    'top'
  );

} 
```

然后，处理自定义请求：

```
add_action('parse_request', 'custom_requests');
function custom_requests ( $wp ) { 

  $valid_actions = array('action1', 'action2');

  if(
    !empty($wp->query_vars['api_action']) &&
    in_array($wp->query_vars['api_action'], $valid_actions) 
  ) {

    // do something here

  }

} 
```

**请记住仅在需要时**`/wp-admin/options-permalink.php`通过访问或调用[flush_rewrite_rules](http://codex.wordpress.org/flush_rewrite_rules) 来刷新重写规则，因为这不是一个简单的过程。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-31T18:00:43.877

好像您正在寻找 wordpress [json-api](http://wordpress.org/plugins/json-api/)插件，这是我使用过的构建良好的插件之一，也很容易扩展。祝你好运。**

# php - 根据存储的 mysql 值选择 Select Option

> ID：12133207
> 
> 赞同：0
> 
> 时间：2012-08-26T19:28:11.233
> 
> 标签：php, mysql, forms

我有一个用户个人资料的编辑页面。一个选项是“国家”，所有国家都列在 php 文件中（国家不是从数据库中加载的）。在用户编辑个人资料页面上，我希望能够从列表中选择当前存储的选项值。

我可以这样做：

```
<option value="Afghanistan" <?php if ($results['country'] == 'Afghanistan') echo 'selected';?> >Afghanistan</option>
<option value="Albania" <?php if ($results['country'] == 'Albania') echo 'selected';?> >Albania</option>
<option value="Algeria" <?php if ($results['country'] == 'Algeria') echo 'selected';?> >Algeria</option>
<option value="American Samoa" <?php if ($results['country'] == 'American Samoa') echo 'selected';?> >American Samoa</option>
 // The rest of the countries here :(.. 
```

有没有更好（更清洁）的方法可以在不将所有国家都放入数据库的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:31:24.090

有，`$countries`使用循环迭代数组`foreach`，并生成选项，与国家值匹配以找到选定的。

例子：

```
$countries = array("Afghanistan", "Albania", "Algeria", "American Samoa");

foreach ($countries as $country) {
    echo "<option value='$country'";
    if ($country == $results["country"]) {
        echo " selected";
    }
    echo ">$country</option>\n";
} 
```

输出（对于`$results["country"] = "Albania"`）：

```
<option value='Afghanistan'>Afghanistan</option>
<option value='Albania' selected>Albania</option>
<option value='Algeria'>Algeria</option>
<option value='American Samoa'>American Samoa</option> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T19:33:29.583

如果我理解你想要什么，我建议使用`foreach`循环：

```
$countries = array(
    "Afghanistan",
    "Albania",
    "Algeria",
    "American Samoa"
    // ...
);

foreach($countries as $country) {
    echo '<option value="'.$country.'"';
    if($country == $results['country']) {
        echo ' selected="selected"';
    }
    echo '>'.$country.'</option>';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:27:12.247

In addition to the other answers if you can't store the countries in a DB you may consider storing them in a text file. Read them in and iterate over them. This will make it easier to add new countries without changing code. Just a thought.

# matlab - 使用matlab组合图像数量

> ID：12133208
> 
> 赞同：1
> 
> 时间：2012-08-26T19:28:13.320
> 
> 标签：matlab, combinations

我正在尝试在 matlab 中组合图像数量。组合图像的数量最多为四个。我希望它们根据图层的概念（如在 Photoshop 中）进行组合，而不是连接在一起。这意味着结果图像的大小将与每个组合图像的大小相同。是否有一个 matlab 函数可以正确完成该任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T06:38:54.273

尝试这个：

```
img1 = imread...
img2 = imread...
img3 = imread...
img4 = imread...

combined_img(:,1) = img1;
combined_img(:,2) = img2;
combined_img(:,3) = img3;
combined_img(:,4) = img4; 
```

现在您有一个 4 层图像，您可以通过 combine_img 的第三个索引访问它。以下命令将显示第一张图片：

```
imshow(combined_img(:,1)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T13:17:47.483

这就像你描述的那样：

```
function imgLayers

    % initialize figure
    figure(1), clf, hold on

    % just some random image (included with Matlab) to server
    % as the background
    img{1,1} = imresize(imread('westconcordaerial.png'), 4);    
    img{1,2} = [0 0];

    % rotate the image and discolor it to create another image
    img{2,1} = uint8(imresize(imrotate(img{1}, +12), 0.3)/2.5);
    img{2,2} = [150 20];

    % and another image
    img{3,1} = uint8(imresize(imrotate(img{1}, -15), 0.5)*2.5);
    img{3,2} = [450 80];

    % show the stacked image
    imshow(stack_image(img));

    %% create new image, based on several layers

    function newImg = stack_image(imgs)

        % every image contained at a cell index (ii) is placed 
        % on top of all the previous ones (0:ii-1)

        rows = cellfun(@(x)size(x,1),imgs(:,1));
        cols = cellfun(@(x)size(x,2),imgs(:,1));

        % initialize new image        
        newImg = zeros(max(rows(:)), max(cols(:)), 3, 'uint8');

        % traverse the stack
        for ii = 1:size(imgs,1)

            layer  = imgs{ii,1};
            offset = imgs{ii,2};

            newImg( offset(1)+(1:rows(ii)), offset(2)+(1:cols(ii)), :) = layer;

        end   
    end   

end 
```

不过要小心——没有足够的绑定检查等。所以你必须做一些自己的发展。但这应该足以让你开始:)

# linux - “/bin/bash cd ~”会导致“/bin/bash: cd: No such file or directory”，为什么？

> ID：12133209
> 
> 赞同：1
> 
> 时间：2012-08-26T19:28:15.743
> 
> 标签：linux, bash

问题在标题中。我在谷歌上找不到任何东西，所以我希望这里有人可以向我解释。

我使用的是 debian 6.0.5，分配给 /etc/passwd 文件中执行用户的 shell 是 /bin/bash

因此，只需编写`cd ~`作品并将我带到用户主目录。

`test -d "~/some_dir"`在 if 语句中返回 false ( some_dir exsits )

编辑：对不起，我应该更清楚我为什么要写`/bin/bash cd ~`而不是`cd ~`：我正在编写一个 bash 脚本，`#!/bin/bash`上面提到的 if 语句最终出现在 false 子句中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T19:32:49.347

尝试以下操作：

```
/bin/bash -c "cd ~" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T19:32:25.873

假设你做了

```
$ /bin/bash cd ~ 
```

您的 shell 解释`cd`为`/bin/bash`. 例如，该语法可用于调用 shell 脚本。

您最可能想要的是更改当前工作目录。在这种情况下，您所需要的只是

```
$ cd ~ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-26T19:33:26.840

任何命令行的选项在命令运行之前都会被扩展，即使是内部命令也是如此。无论您使用什么 shell 来运行`/bin/bash cd ~`，都可能是按字面意思解释波浪号，而不是扩展到您的主目录的特殊字符。

作为测试，尝试使用该名称创建一个目录，看看错误是否消失。

```
> mkdir ./~
> /bin/bash cd ~ 
```

请注意，该`cd`命令需要*在您正在运行的 shell*中完成才能有用。当您更改子 shell 的工作目录，然后子 shell 退出时，您会发现自己回到了开始的位置。

**更新**：

在 bash 脚本中，您应该能够使用`$HOME`环境变量，它应该始终包含您的主目录。我不知道什么条件会导致波浪号扩展失败，但我一直使用`$HOME`.

此外，在确定是否可以更改为特定目录时，您可以选择显式并返回有用状态：

```
unset err
if [[ ! -d "$somedir" ]]; then
  err="Can't find $somedir"
elif [[ ! -r "$somedir" ]]; then
  err="Can't read $somedir"
fi

if [[ -n "$err" ]]; then
  echo "$ERROR: $err" >&2
  exit 1
fi

cd "$somedir" 
```

或者，您可以尝试 CD 并查看其结果。

```
if ! cd "$somedir"; then
  echo "ERROR: $somedir not availble"
  exit 1
fi 
```

详细的错误报告很方便，但如果您不需要它们，保持代码小也有好处。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-26T19:47:55.683

不要使用引号`""` 示例：

```
$ test -d ~/.aptitude
$ echo $?
0
$ test -d "~/.aptitude"
$ echo $?
1 
```

`~`不在引号内展开`""`。采用`$HOME`

# javascript - 如何使用 external.IsSearchProviderInstalled 功能？

> ID：12133210
> 
> 赞同：3
> 
> 时间：2012-08-26T19:28:20.463
> 
> 标签：javascript, google-chrome

该功能`external.IsSearchProviderInstalled`是如何使用的？我已经尝试过类似的事情，`external.IsSearchProviderInstalled('http://www.google.com')`但我一直`Error`在 Chrome 中获得一个？

功能是什么`external.IsSearchProviderInstalled`？它应该如何在 Chrome 中使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T05:54:28.920

IsSearchProviderInstalled 的规范在这里：[http ://dev.w3.org/html5/spec-author-view/system-state-and-capabilities.html#dom-external-issearchproviderinstalled](http://dev.w3.org/html5/spec-author-view/system-state-and-capabilities.html#dom-external-issearchproviderinstalled)

您收到错误的最可能原因是“仅检查与调用此方法的脚本位于同一域的结果页面”。因此，您只能检查您的域上是否安装了提供程序。

例如，如果您访问[https://www.google.com](https://www.google.com)，打开 Javascript 控制台并说 `external.IsSearchProviderInstalled('https://www.google.com')`您将根据您的搜索提供商设置返回 0、1 或 2。

但是，如果您在不同的域上尝试相同的调用，则会引发错误。这是一个定义不明确的通用错误，但 Chromium 代码中有一个 FIXME 以响应更具描述性的内容（参见 ExternalExtensionWrapper::IsSearchProviderInstalled in src/chrome/renderer/external_extension.cc）

# jquery - 使用 jQuery 重置动态数组

> ID：12133220
> 
> 赞同：1
> 
> 时间：2012-08-26T19:29:29.563
> 
> 标签：jquery, arrays

我有一个函数，当我单击一个按钮时，它会将动态数量的数字推送到一个数组中，代码如下所示：

```
$('#calculate').click(function(e) {

var foo = $(".foo"),
    A = [],
    B = [];

    //Push values
foo.each(function(){
  var $t = $(this),
    num = $t.val(),
    xnum = num * 2.42;
  A.push(xnum);
  B.push(num);
});

//more stuff down here... 
//.ajax() to run and print a calculation 
```

我从`<select>`菜单中获取这些值，然后我有一个按钮，`<select>`使用该功能删除它附带的菜单`.empty()`......

我在计算时遇到问题，然后删除其中一个`<select>`菜单并重新计算......删除的值`<select>`仍然包含在我的计算中！

我认为重置数组的最简单方法是使用：

```
A.length = 0;
B.length = 0; 
```

但由于某种原因，这些并没有重置数组，旧值仍包含在新计算中......

在我开始将项目推入之前，有没有更好的方法可以完全清除阵列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:53:54.500

试试这个

```
$(document).on("click", "#remove", function() {
    $this=$(this);
    $this.parent('.foowrap').fadeOut(function() {
        $this.parent('.foowrap').empty();
    });
}); 
```

**更新：**使用 class`.remove`而不是 id `#remove`， id 意味着是唯一的。

[**演示**](http://jsfiddle.net/UFvu5/2/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:00:07.623

我会将另一个答案修改为更像这样：

```
$(".remove").click(function() {
  $(this).parent('.foowrap').fadeOut(function() {
    $(this).empty();
  });
}); 
```

注意，它避免了两次调用`parent`和全局变量，并添加了缺少的分号。

编辑：看到您有 2 个相同的元素，`id`因此更改了我的代码以假设您将更`remove`改为`class`.

# uibutton - 带有 UIButton 的 UIPickerView

> ID：12133221
> 
> 赞同：0
> 
> 时间：2012-08-26T19:29:37.550
> 
> 标签：uibutton, uipickerview

我的 UIPickerView 数据源和委托正在运行。当用户从选择器中选择一个选项然后按下一个按钮时，它应该在 UILabel 中说明他是正确还是错误。只有一个正确的答案，其余的都是错误的。我的代码如下所示：

```
- (NSInteger)selectedRowInComponent:(NSInteger)component

if (component == 0) {

return 2
[self.buttonDis setTitle:@"Correct!!!" forState:UIControlStateNormal];
} else {

return 1
[self.buttonDis setTitle:@"Wrong!!!" forState:UIControlStateNormal];
} 
```

我在 UIPicker 视图和一个组件中只有 2 个选项（行）。当我运行应用程序时，按下按钮时它不会显示正确或错误。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T19:35:36.230

看起来您在设置标题之前调用了 return 而没有使用；。即我会认为它应该阅读。

```
if (component == 0) 
{
    [self.buttonDis setTitle:@"Correct!!!" forState:UIControlStateNormal];
    return 2;
} 
else  
{
    [self.buttonDis setTitle:@"Wrong!!!" forState:UIControlStateNormal];
    return 1;
} 
```

# actionscript-3 - 如何检查鼠标是否在 MovieClip 上？

> ID：12133224
> 
> 赞同：1
> 
> 时间：2012-08-26T19:30:21.203
> 
> 标签：actionscript-3, mouseover, movieclip

**没有听众参与。**问题是，我可以使用**MOUSE_OVER**和**MOUSE_OUT**侦听器，但是如果您将鼠标拖到 MovieClip 上的速度足够快，则其中一个侦听器可能不会被激活。我已经试过好几次了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-26T20:17:21.403

我从来没有遇到过mouseOver 和mouseOut 的问题。

但是你可以使用 hitTestPoint：

```
function detectMouseOver(d:DisplayObject):Boolean
{
    var mousePoint:Point = d.localToGlobal(new Point(d.mouseX,d.mouseY));
    return d.hitTestPoint(mousePoint.x,mousePoint.y,true);
} 
```

如果您确定该属性可用并从您调用的位置设置，您也可以使用 stage.mouseX 和 stage.mouseY（而不是 localToGlobal）。

我还没有测试过代码，但我认为它应该可以工作。

（编辑）

但是，如果您想绝对确定鼠标是否经过了一个对象 - 即使您走得如此之快以至于完全跳过它，您也必须检查两帧鼠标点之间的点。

例如，这将使它：

```
d.addEventListener(Event.ENTER_FRAME, checkMouseOver);

var lastPoint:Point;
const MAX_DIST:Number = 10;

function checkMouseOver(e:Event):void
{
    var isOver:Boolean = false;

    var d:DisplayObject = e.currentTarget as DisplayObject;
    var thisPoint:Point = d.localToGlobal(new Point(d.mouseX,d.mouseY))

    if (lastPoint)
    while (Point.distance(thisPoint,lastPoint) > MAX_DIST)
    {
        var diff:Point = thisPoint.subtract(lastPoint);
        diff.normalize(MAX_DIST);
        lastPoint = lastPoint.add(diff);

        if (d.hitTestPoint(lastPoint.x,lastPoint.y,true))
        {
            isOver = true;
            break;
        }
    }
    if (d.hitTestPoint(thisPoint.x,thisPoint.y,true))
    isOver = true;

    lastPoint = thisPoint;

    //do whatever you want with isOver here
} 
```

您可以记住最后一个状态是否结束并在 isOver != wasOver 时发送自定义事件。如果您在 while 循环中执行此操作，您将获得高度准确的鼠标悬停检测。

但我敢打赌，shapeFlag = true 的 hitTestPoint 会占用大量 CPU，尤其是在一帧中大量使用的情况下。因此，在这种情况下，您可能希望将此 MAX_DIST 设置得尽可能高。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:16:55.253

那就用数学吧。

```
if(mouseX>mc.x-(mc.width/2) && mouseX<mc.x+(mc.width/2) && mouseY>mc.y-(mc.height/2) && mouseY<mc.y+(mc.height/2)){
     hovered = true;
     //do stuff..
}else{
     if(hovered){
           hovered=false;
           //do rollout stuff..
     }
} 
```

请注意，它取决于movieclip reg point...在这种情况下，reg point 位于movieclip 的中间。

另一种方法是`hitTestObject()`内置函数 with `shapeFlag = true;`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T07:08:03.433

您还可以收听舞台鼠标移动并检查鼠标下的剪辑：

```
stage.addEventListener(MouseEvent.MOUSE_MOVE , onMouseMove);
function onMouseMove(e:MouseEvent):void {
    trace(stage.getObjectsUnderPoint(new Point(e.stageX , e.stageY)));
} 
```

并检查您的 MovieClip 是否在数组中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-29T21:37:43.533

如果鼠标“足够快”地经过，那么操作系统可能首先没有将任何鼠标事件发送到屏幕的该部分的 Flash。将鼠标移动得比它的分辨率可以触发（或操作系统可以处理）快得多会产生你所看到的效果（事实是，屏幕的那部分没有处理任何鼠标事件），否则 MOUSE_OVER 肯定会触发（如果鼠标确实在影片剪辑上产生了至少一个移动事件）。

但是，由于各种操作系统或浏览器的安全限制，如果鼠标离开舞台区域（离开 Flash），则MOUSE_OUT 事件*可能不会触发。*

[要解决此问题，请为stage::flash.events.Event.DEACTIVATE](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/EventDispatcher.html#event%3adeactivate)和[stage::flash.events.Event.MOUSE_LEAVE](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Stage.html#event%3amouseLeave)注册侦听器，在每个 Sprite/MovieClip 中，您也在侦听 MOUSE_OUT，重用相同的处理函数。

mouseLeave 事件（由舞台触发）是专门为您的问题创建的：“当指针移出舞台区域时由舞台对象调度。如果按下鼠标按钮，则不会调度该事件。” 如果它触发，你应该像 MOUSE_OUT 一样处理任何处于 MOUSE_OVER “状态”的影片剪辑（假设你有这样的状态）。如果鼠标按钮在离开舞台区域时被按下，用户可能会在某个时候释放它，而 DEACTIVATE 将在舞台上触发。

# java - JDBC 类型 3 驱动程序

> ID：12133225
> 
> 赞同：0
> 
> 时间：2012-08-26T19:30:35.607
> 
> 标签：java, jdbc, jdbc-odbc

今天我在学习不同的 JDBC 驱动程序。我在下面的网站上找到

[http://www.javaworld.com/javaworld/jw-07-2000/jw-0707-jdbc.html?page=4](http://www.javaworld.com/javaworld/jw-07-2000/jw-0707-jdbc.html?page=4)

JDBC-ODBC 桥比包括 Type - 3 在内的其他驱动程序花费更多时间。但是当我查看 Type - 3 驱动程序时

[http://www.javaworld.com/javaworld/jw-05-2002/jw-0517-jdbcdriver.html?page=2](http://www.javaworld.com/javaworld/jw-05-2002/jw-0517-jdbcdriver.html?page=2)

据说它使用中间层与服务器通信。中间层使用 JDBC-ODBC 桥接器与服务器通信。如果这是架构，那么与 Type-1 相比，Type-3 需要更少的时间，因为 Type-3 本身使用 Type -1 。如果我错了，请澄清我并纠正我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:26:02.047

我想不出为什么有人会使用他们选择的数据库供应商提供的 IV 型 JDBC 驱动程序以外的任何东西。所有值得使用的都有驱动程序：MySQL、Oracle、Microsoft SQL Server。

2000 年以来很少有 Java 文章仍然值得引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:19:19.407

驱动程序的类型本身并不会影响其性能。驱动程序编写的好坏可能会产生巨大的差异，并且实际数据库的性能通常会覆盖驱动程序本身的任何性能影响。更不用说对于给定的数据库设置，您可能只能使用某些驱动程序类型（或能够找到某些实现类型）。长话短说，那些文章什么也没告诉你。根据您需要的工作负载类型测试您可用的驱动程序，并自行确定哪个驱动程序最有意义。

正如评论中提到的那样，这些文章在计算机方面是*古老的。*最重要的是，第二篇文章提到了一个特定的 jdbc 实现（文章的那个），它在实现中使用了 JDBC-ODBC 桥。因此，第一篇文章中的时间与第二篇文章中的实现完全无关。

然而，我要指出的是，与任何“真正的”jdbc 驱动程序实现（为特定数据库供应商设计的）相比，JDBC-ODBC 桥往往是性能最差的。

# css - 无图像 3d 内容框 - 这可能吗？

> ID：12133233
> 
> 赞同：1
> 
> 时间：2012-08-26T19:31:29.253
> 
> 标签：css

我正在尝试重新创建这两个堆叠在另一个没有图像的内容框 - [http://i.imgur.com/j9O9j.png](https://i.imgur.com/j9O9j.png)这是可能的还是必须将图像用于下部框？

![在此处输入图像描述](../Images/35af10bae2e228eaeaabe054a9585758.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T04:52:37.493

它可以很好地复制，在……几乎任何浏览器中使用最少的标记，真的。我做了两个版本，两者的**HTML**是一样的。

```
<div class='box box1'>
    <div class='box1-content'>Box 1 content goes here.</div>
</div>
<div class='box box2'>Box 2 content goes here.</div> 
```

第**一个版本**使用**CSS 3D 转换**，应该可以在 Safari、Chrome、Firefox 和 IE10 中使用。Opera 和 IE9（以及更早的版本）不支持 3D 变换，因此不适用于这些。

# [*演示*](http://dabblet.com/gist/4570533)

相关**CSS**：

```
html { background: linear-gradient(#165284, #3672a4) no-repeat; }
.box { position: relative; margin: 0 auto; width: 90%; }
.box1-content, .box2 { box-sizing: border-box; padding: 1%; min-height: 16em; }
.box1 { z-index: 2; margin-bottom:  1.6em; box-shadow: 0 1.4em 1em -1em; }
.box1:before, .box1:after {
    position: absolute;
    z-index: -1;
    top: .5em; right: .6em; bottom: .5em; left: .6em; 
    border-radius: .35em;
    box-shadow: 0 0 2em;
    content: '';
}
.box1:before { transform: skewX(5deg); }
.box1:after { transform: skewX(-5deg); }
.box1-content {
    border-radius: 0 0 .5em .5em;
    background: linear-gradient(-45deg, #e14f00, #f88d00);
}
.box2 { z-index: 1; background: gainsboro; perspective: 32em; }
.box2:before {
    display: block;
    position: absolute;
    bottom: 100%; left: 0;
    width: 100%; height: 5em;
    transform: rotateX(45deg);
    transform-origin: 50% 100% 0;
    background: linear-gradient(dimgrey, silver);
    content: '';
} 
```

* * *

第二**个版本**的**兼容性更好**，应该可以在 Chrome、Safari、Firefox、IE9+ 和 Opera 中完全工作（阴影 + 模拟 3D 效果）。IE8 中也应该模拟 3D 效果，即使阴影不存在。

# [*演示*](http://dabblet.com/gist/4570702)

相关**CSS**：

```
html {
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#165284',
            endColorstr='#3672a4', GradientType=0); /* fallback for IE9/8 */
    background: linear-gradient(#165284, #3672a4) no-repeat;
}
.box { position: relative; margin: 0 auto; width: 90%; }
.box1-content, .box2 { box-sizing: border-box; padding: 1%; min-height: 16em; }
.box1 {
    z-index: 2;
    margin-bottom:  1.6em;
    box-shadow: 0 1.4em 1em -1em; /* not supported in IE8 */
}
.box1:before, .box1:after {
    position: absolute;
    z-index: -1;
    top: .5em; right: .6em; bottom: .5em; left: .6em; 
    border-radius: .35em; /* not supported in IE8 */
    box-shadow: 0 0 2em; /* not supported in IE8 */
    content: '';
}
.box1:before { transform: skewX(5deg); } /* not supported in IE8 */
.box1:after { transform: skewX(-5deg); } /* not supported in IE8 */
.box1-content {
    border-radius: 0 0 .5em .5em;
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#e14f00',
            endColorstr='#f88d00', GradientType=1); /* fallback for IE9/8 */
    background: linear-gradient(-45deg, #e14f00, #f88d00);
}
.box2 { z-index: 1; background: gainsboro; }
.box2:before {
    position: absolute;
    bottom: 100%; right: 0; left: 0;
    border: solid 4em transparent;
    border-bottom: solid 5em silver;
    content: '';
} 
```

您可以尝试使用附加元素而不是伪元素来模拟 IE8/3D 效果的阴影和 IE7 的阴影，并对它们应用矩阵变换/阴影过滤器，但我认为这不值得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:47:36.810

花了一段时间，但我想我管理（有点）你想要的。唯一不能做的是侧面的“花式”阴影。

这是一个[**小提琴**](http://jsfiddle.net/BramVanroy/Lkp7G/2/)

## 笔记：

*   仅适用于 Chrome 和 Safari！
*   通读[this](http://www.w3schools.com/cssref/css3_pr_perspective.asp)和[this](http://www.w3schools.com/cssref/css3_pr_perspective-origin.asp)分别了解`perspective`和`perspective-origin`。
*   申请您​​自己的网站时需要进行调整！尤其是定位。
*   `z-index`阴影盒上需要负片。这可能会干扰您自己的网站。我知道这不是最实用和最方便的方法，但它是最直接有效的方法。

# cocoa - 自动创建冲突的 NSFileVersions

> ID：12133242
> 
> 赞同：6
> 
> 时间：2012-08-26T19:32:40.133
> 
> 标签：cocoa, conflict, icloud, foundation, nsfileversion

我编写了一个自定义冲突处理例程，它会自动启动以解决 NSFileVersion 的冲突版本。现在我想编写单元测试以确保它有效。这是问题：

> 如何在单元测试中导致/创建冲突版本？

这本质上归结为：如何在不通过 iCloud 手动执行的情况下引发冲突？由于这仅用于测试目的，我不在乎使用私有 API 或直接侵入系统——只要结果是从`NSFileVersion's +unresolvedConflictVersionsOfItemAtURL`. 任何建议将不胜感激！

最大限度

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T21:46:14.820

您可以`+unresolvedConflictVersionsOfItemAtURL`使用自己的版本进行修补，该版本返回一系列冲突的版本：

```
#import <objc/runtime.h>

static IMP __originalUnresolvedConflictVersionIMP = NULL ;
static NSArray * MyNSFileVersionUnresolvedConflictVersions( id self, SEL _cmd, NSURL * url )
{
    // this code just calls the original implementation... 
    // You can return an array of conflicting NSFileVersion objects instead...

    NSLog(@"%s called\n", __PRETTY_FUNCTION__ ) ;
    return (*__originalUnresolvedConflictVersionIMP)( self, _cmd, url ) ;
}

@implementation NSFileVersion (Test)

+(void)load
{
    __originalUnresolvedConflictVersionIMP = class_replaceMethod( objc_getMetaClass( "NSFileVersion") , @selector( unresolvedConflictVersionsOfItemAtURL: ), (IMP)MyNSFileVersionUnresolvedConflictVersions, "@@:@" ) ;
}

@end 
```

这足以继续吗？我可能会先在我的替代“方法”中尝试这个：

```
return [ [ self otherVersionsOfItemAtURL:url ] lastObject ] ; 
```

# java - 奇怪的行为，长的通用 ArrayList

> ID：12133247
> 
> 赞同：1
> 
> 时间：2012-08-26T19:33:15.467
> 
> 标签：java, generics, arraylist

我有`someMethod()`哪个回报`Collection<Long>`。

```
ArrayList<Long> results = (ArrayList<Long>) someMethod();
Long value = results.get(0); 
```

我明白了`ClassCastException: java.util.ArrayList cannot be cast to java.lang.Long`。事实上`System.out.println(results.get(0));`，它返回例如`[32]`。我不明白这个。这是长的 ArrayList！为什么`get(0)`退货`ArrayList`？

这有助于：

```
Object o = results.get(0);
ArrayList<Long> al = (ArrayList<Long>) o;
Long val = al.get(0); 
```

但为什么需要这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T19:41:18.680

显然`someMethod()`实际上是正在返回`Collection<List<Long>>`，违反了声明的返回类型。由于类型擦除，这是可能的。只要类类型正确，编译器就很高兴，可以忽略泛型类型（编译器只会发出警告）。基本上这是`someMethod()`.

# python - 如何在 Rhythmbox 中查询数据

> ID：12133250
> 
> 赞同：1
> 
> 时间：2012-08-26T19:33:20.393
> 
> 标签：python, gio, rhythmbox

我正在使用 ubuntu 12.04，我正在尝试编写一个 python 插件来查询 Rhythmbox 数据库。Rhythmbox 版本是 v2.96，但 v2.97 也会出现此问题。当我执行 python 查询时，Ubuntu 因分段错误而崩溃。

我需要确认以下内容是否正确，以及我是否发现了特定于 Ubuntu 的错误，或者我是否误解了如何正确查询。如果其他使用其他发行版的人可以确认 - 这将是最受欢迎的。

我已经就分段错误提交了关于 bugzilla的[错误报告。](https://bugzilla.gnome.org/show_bug.cgi?id=682294)但是，我的问题并不是严格意义上的——它专门试图确认正确的 python 代码来查询数据。

因此我的问题是：下面的代码片段对于查询 Rhythmbox 数据库是否正确，或者我是否需要安装一个额外的包来启用查询。

脚步：

1.  启用 python 控制台插件
2.  键入（或逐行复制并粘贴以下内容）

```
从 gi.repository 导入 RB、GLib

db = shell.props.db
query_model = RB.RhythmDBQueryModel.new_empty(db)
查询 = GLib.PtrArray()

db.query_append_params（查询，RB.RhythmDBQueryType.EQUALS，RB.RhythmDBPropType.ARTIST，'一些艺术家姓名'）
db.query_append_params（查询，RB.RhythmDBQueryType.EQUALS，RB.RhythmDBPropType.TITLE，'一些歌曲名称'）   

db.do_full_query_parsed(query_model, 查询)

对于 query_model 中的行：
    打印行[0].get_string(RB.RhythmDBPropType.ARTIST)
    打印行[0].get_string(RB.RhythmDBPropType.TITLE)

```

如果 ubuntu 12.04 在我输入此行时，Ubuntu 会因分段错误而崩溃

```
db.query_append_params( query, RB.RhythmDBQueryType.EQUALS, RB.RhythmDBPropType.ARTIST, 'some artist name' ) 
```

因此，我实际上是否正确使用了调用中的第一个参数 - 查询指针数组 (PtrArray) - 还是我的查询函数参数不正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:35:56.273

## 答案是……

好吧，这个问题确实是一个错误 - 但要回答我自己的问题，

**是**的，在 Rhythmbox 中查询数据的语法与问题中正确说明的一样。

*但是有一个...*

查询数据仅适用于 64 位 linux。

是的，真的 - 我一直在测试 Fedora 17 的 32 位 live-cd 以及 LMDE。两者都表现出与 Ubuntu 12.04 相同的分段错误问题。

共同点是我正在测试 Ubuntu 12.04/Fedora 17 和 LMDE 的 32 位版本。

在 64 位变体中测试所有三个都按预期工作。

32 位问题是一个错误 - 并且已在 bugzilla 上报告 - 但提出的问题已得到解答。

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T20:54:20.397

我也遇到了这个。我设法通过手动迭代库来解决它：

```
 for row in self.shell.props.library_source.props.base_query_model:
        entry = row[0]
        artist = entry.get_string(RB.RhythmDBPropType.ARTIST)
        if self.sanitize(artist) in similar_artists_map:
            self.qm.add_entry(entry, -1) 
```

# java - ArrayList 上的 Java 并发

> ID：12133257
> 
> 赞同：0
> 
> 时间：2012-08-26T19:34:20.210
> 
> 标签：java, concurrency

我一直在努力寻找答案，但我不知道我做错了什么。我正在学习如何使用 JAVA 线程。事情是我正在做一个太空飞船游戏。我有一种创建敌人的方法（这些敌人被添加到一个 ArrayList 中，该 ArrayList 被绘制以产生运动效果，效果很好）。我有另一种方法可以在这个 ArrayList 中查找那些已经死去的敌人（dead 是一个布尔值，如果敌人从屏幕上消失或被杀死，它就会变成真的），如果他们（死了）它会从 ArrayList 中删除那些（不再画）。我有一个使用 createEnemy 方法的线程（它工作正常）。现在问题来了，我需要使用这个 ereaseEnemy 方法，但它给了我和并发错误，我尝试在这两种方法上使用同步，但 ereaseEnemy 方法永远不会开始工作。不知道如何解决这个问题。我应该停止第一个线程（创建者）以使其他线程工作吗？我在这里错过了什么吗？谢谢！

删除敌人的代码

```
for (Enemigo enemigo1 : enemigos) {
    if (!enemigo1.isEstaVivo()) { enemigos.remove(enemigo1); }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T19:39:27.737

你真的应该发布有问题的代码，但我可以做出一个有根据的猜测：你正在迭代`ArrayList`你正在调用的循环和内部`list.remove(o)`。抛出的异常是`ConcurrentModificationException`. `List.remove()`迭代时不允许调用任何方法；你必须使用`Iterator.remove()`. 这排除了在这个用例中使用增强的 for 循环。将您的代码更改为

```
for (Iterator<Enemigo> iter = enemigos.iterator(); iter.hasNext();)
  if (!iter.next().isEstaVivo()) iterator.remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:49:06.207

两种可能的解决方案

1）在删除之前复制您的列表（如果大小太大，请注意性能问题）

```
ArrayList<enemigo> enemigosCopy= new ArrayList<enemigo>(); 
enemigosCopy.addAll(enemigos);
//Do your deleting thing on enemigosCopy 
```

2) 使用迭代器

```
 Iterator i =enemigos.iterator();
 while (i.hasNext()) {
   enemigo o = i.next();
   if (!enemigo1.isEstaVivo()) {    
     i.remove(o);      
   }             
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T19:37:53.293

您不应该尝试自己同步线程。让 Java 通过使用这些`java.util.concurrent`类来为您做到这一点。在您的情况下，我会查看`ConcurrentLinkedQueue`or`ConcurrentMap`以获得恒定的访问时间。您可以使用船舶 ID 作为地图的键。

您仍然需要控制`dead`在敌人上设置标志，以便多个线程正确处理它的访问。数据存储不会为您做到这一点，它只会确保所有线程的数据存储状态一致。

[http://docs.oracle.com/javase/6/docs/api/index.html?java/util/concurrent/package-summary.html](http://docs.oracle.com/javase/6/docs/api/index.html?java/util/concurrent/package-summary.html)

# android - Android应用强制关闭

> ID：12133259
> 
> 赞同：0
> 
> 时间：2012-08-26T19:34:27.527
> 
> 标签：android, forceclose

我正在开发一个 Android 应用程序，并尝试在我的手机和模拟器中运行它。但是，每次它都会强制关闭。这是日志。谢谢

```
08-26 15:30:04.807: D/AndroidRuntime(10580): Shutting down VM
08-26 15:30:04.807: W/dalvikvm(10580): threadid=1: thread exiting with uncaught exception (group=0x4001e568)
08-26 15:30:04.823: E/AndroidRuntime(10580): FATAL EXCEPTION: main
08-26 15:30:04.823: E/AndroidRuntime(10580): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.imhungry/com.example.imhungry.ImHungry}: java.lang.ArrayIndexOutOfBoundsException
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1586)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1680)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.os.Handler.dispatchMessage(Handler.java:99)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.os.Looper.loop(Looper.java:130)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.app.ActivityThread.main(ActivityThread.java:3703)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at java.lang.reflect.Method.invokeNative(Native Method)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at java.lang.reflect.Method.invoke(Method.java:507)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at dalvik.system.NativeStart.main(Native Method)
08-26 15:30:04.823: E/AndroidRuntime(10580): Caused by: java.lang.ArrayIndexOutOfBoundsException
08-26 15:30:04.823: E/AndroidRuntime(10580):    at com.example.imhungry.ImHungry.<init>(ImHungry.java:36)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at java.lang.Class.newInstanceImpl(Native Method)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at java.lang.Class.newInstance(Class.java:1409)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
08-26 15:30:04.823: E/AndroidRuntime(10580):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1578)
08-26 15:30:04.823: E/AndroidRuntime(10580):    ... 11 more
08-26 15:30:08.018: I/Process(10580): Sending signal. PID: 10580 SIG: 9 
```

这是我遇到问题的代码

```
package com.example.imhungry;

import java.util.Random;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;

public class ImHungry extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_im_hungry);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_im_hungry, menu);
        return true;
    }

    Random randomGenerator = new Random();
    int randomInt = randomGenerator.nextInt(8);
    String wordList[] = new String[8];
    {
        wordList[0] = "Mexican";
        wordList[1] = "American";
        wordList[2] = "Barbeque";
        wordList[3] = "Chinese";
        wordList[4] = "Indian";
        wordList[5] = "Italian";
        wordList[6] = "Thai";
        wordList[7] = "Viatnamese";
        wordList[8] = "Middle Eastern";

    }

 String wordToDisplay = wordList[randomInt];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:43:56.557

您在*8 字符串数组中添加了**9 个字符串*！删除这一行：

 *```
wordList[8] = "Middle Eastern"; 
```

或者让你的数组容纳*九个*字符串：

```
String wordList[] = new String[9]; 
```*

# c++ - 即使在链接后也将“未定义的引用”提升到系统

> ID：12133260
> 
> 赞同：3
> 
> 时间：2012-08-26T19:35:11.923
> 
> 标签：c++, eclipse, boost, eclipse-cdt

我在 eclipse cdt windows 的 boost 中包含以下库。

> 1.  libboost_filesystem-vc100-mt-1_51
> 2.  libboost_system-vc100-mt-1_51

从律师输出的顶部（下面）他们似乎连接得很好。但是我收到以下错误。

顾问输出/错误：

```
18:10:00 **** Incremental Build of configuration Debug for project Boost ****
Info: Internal Builder is used for build
g++ "-LC:\\Users\\Mike\\Desktop\\Lib\\boost_1_51_0\\stage\\lib" -o Boost.exe "src\\Boost.o" -llibboost_filesystem-vc100-mt-1_51 -llibboost_system-vc100-mt-1_51 
src\Boost.o: In function `_static_initialization_and_destruction_0':
C:/Users/Mike/Desktop/Lib/boost_1_51_0/boost/system/error_code.hpp:214: undefined reference to `boost::system::generic_category()'
C:/Users/Mike/Desktop/Lib/boost_1_51_0/boost/system/error_code.hpp:215: undefined reference to `boost::system::generic_category()'
C:/Users/Mike/Desktop/Lib/boost_1_51_0/boost/system/error_code.hpp:216: undefined reference to `boost::system::system_category()'
src\Boost.o: In function `ZN5boost10filesystem9file_sizeERKNS0_4pathE':
C:/Users/Mike/Desktop/Lib/boost_1_51_0/boost/filesystem/operations.hpp:447: undefined reference to `boost::filesystem::detail::file_size(boost::filesystem::path const&, boost::system::error_code*)'
src\Boost.o: In function `path<char [9]>':
C:/Users/Mike/Desktop/Lib/boost_1_51_0/boost/filesystem/path.hpp:139: undefined reference to `boost::filesystem::path::codecvt()'
src\Boost.o: In function `ZN5boost10filesystem11path_traits8dispatchISbIwSt11char_traitsIwESaIwEEEEvRKSsRT_RKSt7codecvtIwciE':
C:/Users/Mike/Desktop/Lib/boost_1_51_0/boost/filesystem/path_traits.hpp:174: undefined reference to `boost::filesystem::path_traits::convert(char const*, char const*, std::basic_string<wchar_t, std::char_traits<wchar_t>, std::allocator<wchar_t> >&, std::codecvt<wchar_t, char, int> const&)'
collect2: ld returned 1 exit status 
```

由此看来，系统库没有正确连接/链接。

我的代码：

```
#include <boost/filesystem.hpp>
#include <iostream>
#include <iterator>
#include <algorithm>

int main()
{
    using namespace boost::filesystem;
    file_size("test.txt");
    return 0;

} 
```

我错过了什么吗？我需要包含其他内容吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T21:58:41.883

每个 C++ 编译器都有自己的函数名修改规则和实现（将 C++ 函数名转换为 ASM 或类似 C 的函数）。
例如，MSVC 将 boost::system::generic_category 转换为 ?generic_category@system@boost@@YAABVerror_category@12@XZ，但在这种情况下，您使用的是使用 MSVC2010(vc100) 和 eclipse g++ 编译器构建的 DLL，该编译器具有不同的修改名称的规则，因此它期望在库中找不到其他内容，并生成链接器错误。

作为一般规则，使用从不同于您在项目中使用的编译器编译的 DLL 中的 C++ 对象是不合法的，甚至使用使用以前版本的编译器编译的 DLL 也是不合法的是 boost 将 vc100 添加到其 DLL 名称以通知您只能将其与 vc100 一起使用的原因（MSVC2010）

# windows - 远程关闭 Windows 机器

> ID：12133262
> 
> 赞同：1
> 
> 时间：2012-08-26T19:35:31.093
> 
> 标签：windows, shutdown

如何远程关闭或重新启动 Windows 机器？

*   它应该处理许多计算机（线程）
*   能够关闭所有计算机或仅关闭一台计算机
*   工作客户端/服务器...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T19:40:07.473

使用[`shutdown`](http://support.microsoft.com/kb/317371)命令：

```
shutdown /s /m \\computername
shutdown /r /m \\computername 
```

该`/s`开关用于关机、`/r`重启。

在我的 Windows 7 机器上关机的完整用法：

```
>shutdown /?
Usage: shutdown [/i | /l | /s | /r | /g | /a | /p | /h | /e] [/f]
    [/m \\computer][/t xxx][/d [p|u:]xx:yy [/c "comment"]]

    No args    Display help. This is the same as typing /?.
    /?         Display help. This is the same as not typing any options.
    /i         Display the graphical user interface (GUI).
               This must be the first option.
    /l         Log off. This cannot be used with /m or /d options.
    /s         Shutdown the computer.
    /r         Shutdown and restart the computer.
    /g         Shutdown and restart the computer. After the system is
               rebooted, restart any registered applications.
    /a         Abort a system shutdown.
               This can only be used during the time-out period.
    /p         Turn off the local computer with no time-out or warning.
               Can be used with /d and /f options.
    /h         Hibernate the local computer.
               Can be used with the /f option.
    /e         Document the reason for an unexpected shutdown of a computer.
    /m \\computer Specify the target computer.
    /t xxx     Set the time-out period before shutdown to xxx seconds.
               The valid range is 0-315360000 (10 years), with a default of 30.
               If the timeout period is greater than 0, the /f parameter is
               implied.
    /c "comment" Comment on the reason for the restart or shutdown.
               Maximum of 512 characters allowed.
    /f         Force running applications to close without forewarning users.
               The /f parameter is implied when a value greater than 0 is
               specified for the /t parameter.
    /d [p|u:]xx:yy  Provide the reason for the restart or shutdown.
               p indicates that the restart or shutdown is planned.
               u indicates that the reason is user defined.
               If neither p nor u is specified the restart or shutdown is
               unplanned.
               xx is the major reason number (positive integer less than 256).
               yy is the minor reason number (positive integer less than 65536). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-12T04:58:18.403

对于在网络中运行 cmd 的远程 PC 是

关机-m \192。***.*** .** -r -f -t 0 其中 -m 表示远程 1。“-r”表示重新启动远程计算机。2.“-f”标志告诉远程计算机重新启动并安全关闭所有打开的程序。3.“-t”标志表示-t之后的时间，即这里0秒。

# excel - 为什么标签在 VBA 中会出现类型不匹配错误，但组合框不会？

> ID：12133265
> 
> 赞同：3
> 
> 时间：2012-08-26T19:35:49.473
> 
> 标签：excel, vba

我正在运行 Excel 2003。我有以下 VBA 代码，对应于一个由控件和控件`UserForm`组成的简单代码。它通过保存工作，但在保存时会产生*类型不匹配*错误。`ComboBox``Label``ComboBox`*`Label`*

 *```
Private whatComboBox As ComboBox
Private whatLabel As Label

Private Sub UserForm_Initialize()
    Call SaveComboBox(SomeComboBox)
    Call SaveLabel(SomeLabel)
End Sub

Private Sub SaveComboBox(aComboBox As ComboBox)
    Set whatComboBox = aComboBox
End Sub

Private Sub SaveLabel(aLabel As Label)
    Set whatLabel = aLabel
End Sub 
```

[而且我很欣赏 VBA 与大多数其他语言相比是有限的。但我不会想到这是会出错的那种事情。]

谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:31:05.673

试试这个

```
Private whatComboBox As msforms.ComboBox
Private whatLabel As msforms.Label

Private Sub UserForm_Initialize()
    Call SaveComboBox(SomeComboBox)
    Call SaveLabel(SomeLabel)
End Sub

Private Sub SaveComboBox(aComboBox As msforms.ComboBox)
    Set whatComboBox = aComboBox
End Sub

Private Sub SaveLabel(aLabel As msforms.Label)
    Set whatLabel = aLabel
End Sub 
```

关于您的查询

> 它通过保存组合框起作用，但在保存标签时会生成类型不匹配错误。

您必须限定 Label 对象，因为 Excel 也有一个名为 Label 的对象

**选择**

```
Private whatComboBox As Control
Private whatLabel As Control

Private Sub UserForm_Initialize()
    Call SaveComboBox(SomeComboBox)
    Call SaveLabel(SomeLabel)
End Sub

Private Sub SaveComboBox(aComboBox As Control)
    Set whatComboBox = aComboBox
End Sub

Private Sub SaveLabel(aLabel As Control)
    Set whatLabel = aLabel
End Sub 
```*

# json - 使用 GWT 对 DataGrid 中的 JavaScriptObject 进行排序

> ID：12133268
> 
> 赞同：0
> 
> 时间：2012-08-26T19:37:11.913
> 
> 标签：json, gwt

我有一个作为 JSON 字符串检索的对象列表，如此处[所述](https://developers.google.com/web-toolkit/doc/2.1/tutorial/JSON)

在 DataGrid 中，我像这样进行排序（为简单起见，我只说明了一个列）

```
nameColomn.setSortable(true);
    final ListHandler<SomeObject> nameColomnSortHandler = new ListHandler<SomeObject>(dataProvider.getList());
    nameColomnSortHandler.setComparator(nameColomn, new Comparator<SomeObject>() {
        @Override
        public int compare(SomeObject o1, SomeObject o2) {
            return o1.getName().compareTo(o2.getName());
        }
    });
    dataGrid.addColumnSortHandler(nameColomnSortHandler); 
```

这是我的目标

```
public class SomeObject extends JavaScriptObject {

           //Other methods
           public final native String getName() /*-{ return this.n; }-*/;
    } 
```

排序不起作用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T15:00:49.760

它与 JavaScriptObject 无关，实际上我是在 DataProvider 中设置任何数据之前进行排序的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T00:22:26.573

您正在调用与示例代码`setComparator`中附加到的排序处理程序不同的排序处理程序。`DataGrid`

其他一切对我来说似乎都很好。当您说排序不起作用时，您是什么意思？什么都没有发生？有 JavaScript 错误吗？将鼠标悬停在列标题上时鼠标光标是否会改变？

# internet-explorer - 如何显示 IE7 特定内容？

> ID：12133269
> 
> 赞同：0
> 
> 时间：2012-08-26T19:37:11.937
> 
> 标签：internet-explorer, internet-explorer-7

我一直在尝试显示 IE7 特定标签，但它似乎不起作用。我知道这应该非常简单，所以希望有人能够提供帮助。这是我的代码：

```
<!--[if IE 7]> <div class="fb-comments" data-href="<?= FB_URL; ?>" data-num-posts="2" data-width="700"></div> <![endif]-->
<!--[if gt IE 7]><!--> <div class="fb-comments" data-href="<?= FB_URL; ?>" data-num-posts="8" data-width="700"></div> <!--<![endif]--> 
```

提前非常感谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-31T13:01:10.837

请您使用这些技术，如下所示。我给出了一些实施您的项目的示例：

1.  所有浏览器都支持 css 方法。

    .test { 字体颜色：红色；}

2.  此方法仅适用于ie7浏览器：

    .test { *字体颜色：红色；}

3.  此方法仅适用于ie7和ie8浏览器：

    .test { 字体颜色：红色\9；}

遵循这些技术，你就会得到结果。

# objective-c - Xcode 无法导入 tapku 或 kal 库

> ID：12133270
> 
> 赞同：2
> 
> 时间：2012-08-26T19:37:16.507
> 
> 标签：objective-c, ios, xcode, tapku

我无法导入 tapku 库（使用它提供的日历 api）。我也试过 Kal 遇到同样的问题。这是我导入它的方法（如果我遗漏了什么，请告诉我）（使用 Xcode 4.5）。

1.  转到文件 > 将文件添加到项目 > TapkuLibrary.xcodeproj > 未选中将项目复制到目标的组文件夹，选中创建文件夹引用，选中添加到目标“我的项目”。

2.  转到文件 > 将文件添加到项目 > TapkuLibrary.bundle > 与上述相同的设置。

3.  在构建设置下，在“标题搜索路径”下，将文件添加到tapku 库“src”文件夹（并保留左侧的框未选中）。**我在标题搜索路径中的项目中也使用了另一个来自不同 api 的项目。这有关系吗？**

4.  转到构建阶段，在目标依赖项下添加 Tapku Library，在 Link binary with libraries 下添加 libTapkuLibrary.a。

所以在这样做之后，当我转到我项目中的一个文件并尝试

```
#import <TapkuLibrary/TapkuLibrary.h> 
```

它说“找不到 TapkuLibrary.h 文件”

顺便说一句，Tapku 文件夹本身在我的桌面上，而不是在应用程序的根文件夹中。

如果我遗漏了什么或做错了什么，请告诉我。非常感谢！卢克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T12:02:37.843

对您列出的步骤使用相同的数字：

1) 正确 - 不要复制项目。

2）我通常不需要为包含的库执行此操作，但也许您需要此框架（我假设您已被告知要执行此操作）

3) 标头搜索路径必须与您从 shell 中使用的字符串相同，以便从项目所在的目录获取您想要查找的顶级文件夹（目录）。在您的情况下，它是一个文件夹 TapkuLibrary。您的路径可以相对于项目所在的目录：

```
./../../../Foo/Goop/TapkuLibrary 
```

或者它可以是绝对路径：

```
/Users/jfk/Desktop/TapuLibrary 
```

所以找出你认为正确的字符串，然后打开终端，cd 到你的项目文件所在的目录，然后输入“ls”，看看它是否列出了目录的内容。如果没有，那就弄清楚你做错了什么。

设置“递归”标志可能是个好主意 - 如果您双击标题搜索路径，您可以选择左侧的框（或者您可以在路径中输入“/**”后缀）。

4) 不要使用：

```
#import <TapkuLibrary/TapkuLibrary.h> 
```

这告诉 Xcode 这是一个系统文件夹（在 /usr/include 中）等。按照您使用它的方式，它应该是一个用户文件夹：

```
#import "TapkuLibrary/TapkuLibrary.h" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T14:57:23.653

我真的很难添加 Kal 和 Tapku。这几乎是一个完整的指南。

我要添加（对于以后走这条路的任何人）-您还需要转到“构建设置”转到“其他链接器标志”并输入 -all_load 。

如果没有那个小添加，我无法让它工作。

# mysql - 我的 MySQL CASE/WHEN 语法有什么问题？

> ID：12133272
> 
> 赞同：2
> 
> 时间：2012-08-26T19:37:25.417
> 
> 标签：mysql, mysql5

我正在尝试学习一些新的 MySQL 语法，但遇到了麻烦。这应该很简单...

我在这里跟随手册：http: [//dev.mysql.com/doc/refman/5.5/en/case.html](http://dev.mysql.com/doc/refman/5.5/en/case.html)

但我不断收到语法错误。这是我的日常：

```
# Drop anonymous accounts, if any
USE mysql;
CASE (SELECT COUNT(*) FROM user WHERE User = '' AND Host = 'localhost') 
 WHEN 1 THEN
  DROP USER ''@'localhost';
  FLUSH PRIVILEGES; 
END CASE; 
```

错误是：

> ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 'CASE (SELECT COUNT(*) FROM user WHERE User = '' AND Host = 'localhost') 附近使用的正确语法

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:48:04.867

在查看您关于固定语句但立即第二个问题的评论后，很明显您没有在存储过程或函数中使用它。文档[`flow control statements`](http://dev.mysql.com/doc/refman/5.5/en/flow-control-statements.html)非常巧妙地指出它们需要在存储过程/函数中。

将您的代码更新到一个过程中，然后调用该过程来执行：

```
USE mysql;

DROP PROCEDURE p;
DELIMITER |
CREATE PROCEDURE p() BEGIN
    CASE (SELECT COUNT(*) FROM user WHERE User = '' AND Host = 'localhost') 
        WHEN 1 THEN
            DROP USER ''@'localhost';
            FLUSH PRIVILEGES;
        ELSE
            SELECT 'no users found!';
    END CASE;
END;
|

CALL p(); 
```

另请注意，我添加了一个包罗万象的`ELSE`块；如果您没有捕捉到该值，`CASE`将抛出“未找到案例”警告 - 这可能是可取的，也可能不是可取的。

# java - 如何在 Java 中从系统托盘弹出 JFrame

> ID：12133273
> 
> 赞同：2
> 
> 时间：2012-08-26T19:37:31.410
> 
> 标签：java, windows, swing, jframe, system-tray

我能够在 Java 中创建系统托盘应用程序，但我在定位方面遇到了问题。该程序只需要处理一些输入/输出，所以我希望它易于访问。

我的问题是，当我单击应用程序的系统托盘图标时，如何将其优雅地设置在系统托盘上方？要求是无论显示设置（分辨率、多显示器等）和任务栏位置如何，它都会执行此操作。有没有办法告诉它在托盘附近打开，而不是完全定位它？

我希望它与 Windows 中的“网络”设置按钮完全一样。类似于以下内容：

![网络系统托盘图像](../Images/75feed0bced5c7daf332c8e7c4014a05.png)

这在Java中可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-26T20:01:29.080

正如 Vulcan 所指出的，是的，这是可能的。

此外，很可能会考虑放置弹出窗口的位置（与任务图标所在的位置相关）

![显示弹出窗口](../Images/3e1481163482fbb14e187b6904df15f7.png)

```
public class TestTrayIcon {

    protected static final PopupFrame POPUP_FRAME = new PopupFrame();

    public static void main(String[] args) {

        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {

                try {
                    TrayIcon trayIcon = new TrayIcon(ImageIO.read(new File("D:/DevWork/common/icons/iconex_v_bundle_png/iconexperience/v_collections_png/basic_foundation/16x16/plain/about.png")));
                    trayIcon.addMouseListener(new MouseAdapter() {
                        @Override
                        public void mouseClicked(MouseEvent e) {

                            Point pos = e.getLocationOnScreen();
                            Rectangle screen = getScreenBoundsAt(pos);

                            if (pos.x + POPUP_FRAME.getWidth() > screen.x + screen.width) {
                                pos.x = screen.x + screen.width - POPUP_FRAME.getWidth();
                            }
                            if (pos.x < screen.x) {
                                pos.x = screen.x;
                            }

                            if (pos.y + POPUP_FRAME.getHeight() > screen.y + screen.height) {
                                pos.y = screen.y + screen.height - POPUP_FRAME.getHeight();
                            }
                            if (pos.y < screen.y) {
                                pos.y = screen.y;
                            }

                            POPUP_FRAME.setLocation(pos);
                            POPUP_FRAME.setVisible(true);

                        }
                    });
                    SystemTray.getSystemTray().add(trayIcon);
                } catch (Exception ex) {
                    ex.printStackTrace();
                }
            }
        });
    }

    public static class PopupFrame extends JFrame {

        public PopupFrame() throws HeadlessException {
            setLayout(new BorderLayout());
            add(new JLabel("Hello world"));
            pack();
        }
    }

    public static Rectangle getScreenBoundsAt(Point pos) {
        GraphicsDevice gd = getGraphicsDeviceAt(pos);
        Rectangle bounds = null;

        if (gd != null) {
            bounds = gd.getDefaultConfiguration().getBounds();
            Insets insets = Toolkit.getDefaultToolkit().getScreenInsets(gd.getDefaultConfiguration());

            bounds.x += insets.left;
            bounds.y += insets.top;
            bounds.width -= (insets.left + insets.right);
            bounds.height -= (insets.top + insets.bottom);
        }
        return bounds;
    }

    public static GraphicsDevice getGraphicsDeviceAt(Point pos) {
        GraphicsDevice device = null;

        GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
        GraphicsDevice lstGDs[] = ge.getScreenDevices();

        ArrayList<GraphicsDevice> lstDevices = new ArrayList<GraphicsDevice>(lstGDs.length);

        for (GraphicsDevice gd : lstGDs) {
            GraphicsConfiguration gc = gd.getDefaultConfiguration();
            Rectangle screenBounds = gc.getBounds();

            if (screenBounds.contains(pos)) {
                lstDevices.add(gd);
            }
        }

        if (lstDevices.size() == 1) {
            device = lstDevices.get(0);
        }
        return device;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-26T19:46:37.073

对的，这是可能的。

要设置窗口相对于屏幕右下角的位置，您可以获取图形环境的最大窗口边界，然后执行简单的数学运算。

```
Rectangle screen = GraphicsEnvironment.getLocalGraphicsEnvironment()
        .getMaximumWindowBounds();
String os = System.getProperty("os.name");
if (os.contains("Windows")) {
    setLocation(screen.width - windowSize.width - 6, screen.height - windowSize.height - 6);
} else if (os.contains("Mac")) {
    setLocation(screen.width - windowSize.width + 6, 6);
} 
```

宽度和高度都考虑了窗口和任务栏之间的`- 6`小间隙，并且易于定制。

但是，使用这种方法请注意，位于顶部或左侧的 Windows 任务栏在窗口的右侧/底部仍然会有一个任务栏大小的间隙。我不相信仅从 Java API 就可以找到任务栏方向。

# php - 级联验证不适用于表单的第三层

> ID：12133279
> 
> 赞同：12
> 
> 时间：2012-08-26T19:38:19.807
> 
> 标签：php, symfony, symfony-forms, symfony-2.1

我有一个 3 层的表格：第一层是游戏的容器：

```
class GameListType extends AbstractType {

    public function buildForm(FormBuilderInterface $builder, array $options) {
        $builder->add('games', 'collection', array(
            'required' => false,
            'allow_add' => true,
            'prototype' => true,
            'by_reference' => false,
            'type' => new GameBetType(),
        ))
        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver) {
        parent::setDefaultOptions($resolver);
        $resolver->setDefaults(array(
            'cascade_validation' => true,
        ));
    }  
} 
```

第二层是游戏本身，因为我不打算改变游戏，但它的赌注，它只包括赌注的形式：

```
class GameBetType extends AbstractType {

    public function buildForm(FormBuilderInterface $builder, array $options) {   
        $builder->add('bet', new BetType());
    }

    public function setDefaultOptions(\Symfony\Component\OptionsResolver\OptionsResolverInterface $resolver) {
        parent::setDefaultOptions($resolver);
        $resolver->setDefaults(array(
            'data_class' => 'Strego\TippBundle\Entity\Game',
            'cascade_validation' => true,
        ));
    }  
} 
```

第三层是下注的形式：

```
class BetType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {

        $builder->add('scoreT1' , 'text')
                ->add('scoreT2' , 'text');
        ;
    }

        public function setDefaultOptions(\Symfony\Component\OptionsResolver\OptionsResolverInterface $resolver) {
        parent::setDefaultOptions($resolver);
        $resolver->setDefaults(array(
            'data_class' => 'Strego\TippBundle\Entity\Bet',
        ));
    }

} 
```

问题是，如果第三级存在验证约束，根表单始终有效，但如果我专门验证投注实体，我会在控制器中获得正确的违规列表：

```
// Form processing
$form = $this->createForm(new GameListType(), $entity);
$request = $this->getRequest();

if ($request->getMethod() == 'POST') {
    $form->bind($request);
    $entity = $form->getData();

    if ($form->isValid()) {
        foreach ($entity->getGames() as $game) {                  
            if($game->hasBet()){
                $bet = $game->getBet();
                $bet->setUser($user);
                $validator = $this->container->get('validator');
                $errors = $validator->validate($bet);
                var_dump($errors)  //<-- i see there are errors
                if(count($errors) == 0){
                    print($bet. ' gets persisted<br>');
                    $em->persist($bet);
                } 
            }             
        }
    $em->flush();
    }
} 
```

另一个问题是，即使我不调用`$em->persist($bet)`实体也会被持久化。我没有看到该行中描述的输出

```
print($bet.'gets persisted<br>'); 
```

但是表单输入仍然保存在数据库中。

所以我的两个问题：

1.  如果对表单的投注验证失败，我如何得到错误（我不希望整个表单无效，因为 3 个投注中只有 1 个无效）。

2.  为什么即使我不跟注，赌注仍然存在`$em-persist($bet)`，这是绑定发生的一些魔法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T22:55:31.300

要回答您的第二个问题，您可能已经声明了和实体之间的双向`OneToMany`关系并设置在关系的一侧。所以实体管理器会自动标记实体对象，以便在下一次操作中插入/更新。还将线移出循环。当方法发出数据库查询时，每次代码进入循环时它都会连接到数据库。而 if在循环之外，实体将查询一次，所有更改的 sql 都包含在单个事务中。`User``Bet``cascade={"persist"}``User``Bet``flush``$em->flush();``flush``$em->flush();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-12T03:31:22.393

您只是忘记添加`cascade_validation`到游戏`collection`类型

```
$builder->add('games', 'collection', array(
    'required' => false,
    'allow_add' => true,
    'prototype' => true,
    'by_reference' => false,
    'type' => new GameBetType(),
    'cascade_validation' => true
)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T12:21:22.173

我很确定您应该保留`game`实体而不是实体`bet`。

对于验证检查是否有一些验证组设置，这可能是它没有正确验证的原因。

# apache-flex - Flex - RemoteObject - 如何查看收到的原始数据？

> ID：12133286
> 
> 赞同：0
> 
> 时间：2012-08-26T19:39:50.903
> 
> 标签：apache-flex, flash-builder, fault, remoteobject

使用 flex 远程对象时，有没有办法查看从服务器返回的原始数据，例如字符串？

我在我的代码中设置了一个 faultHandler，偶尔会看到错误，但是 flex 中的错误描述非常模糊。例如，它可能会显示“Delivery In Doubt”或类似内容。

我只是想确定我是否从服务器收到任何数据，理想情况下，它是什么。可能如果我有服务器端错误，在这种情况下我可以在我的客户端日志中看到它。

注意这些故障不容易复现，我对fiddler等嗅探器比较熟悉。问题是最终用户偶尔会遇到故障，我一直在跟踪，但我希望获得更多信息以找出原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:42:14.830

> 使用 flex 远程对象时，有没有办法查看从服务器返回的原始数据，例如字符串？

是的，通常我会使用 ServiceCapture 来执行此操作。查尔斯是另一种选择；Flash Builder 甚至在 IDE 中内置了一些网络监视器功能。我看到您提到了 Fiddler，我认为它与其他工具类似。

我从未见过故障处理程序给出“交付有疑问”的消息。如果您在调试模式下停止代码；您可以在故障处理程序中放置一个手表并查看故障事件。从那里您应该能够深入了解实际错误。FaultEvent应该为您[提供](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/rpc/events/FaultEvent.html)您需要知道的一切。

您可以尝试查看 FaultEvent。[故障](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/rpc/events/FaultEvent.html#fault)。[实际返回文本的内容](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/rpc/Fault.html#content)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-25T14:25:38.063

您可以尝试以下方法：

```
private function handleFault(e:FaultEvent):void
{
    trace(ObjectUtil.toString(e.fault.content));
} 
```

# java - 数据结构 - 快速搜索

> ID：12133287
> 
> 赞同：1
> 
> 时间：2012-08-26T19:39:52.690
> 
> 标签：java, data-structures

存储作为特定类子类型的不同类型对象的最佳数据结构是什么。我将需要选择并打印相同类型的对象或属性设置为特定值的对象。因此，数据结构必须易于搜索。我想知道 ArrayList 是否会完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:54:35.637

这取决于您需要结果的“速度”。除非毫秒计数和/或您有数百万个条目，否则数组列表会很好。

所以我会保持简单，除非性能不够好（测量性能）。

在这种情况下，您可以使用哈希图，其中键是对象的类型，值是所有相应对象的数组列表（假设大多数时候您需要查询对象类型）。这将为您提供 O(1) 搜索。

如果您有不同类型的查询，所有这些都同样可能，您可以为每种查询类型维护一个映射 - 然后它成为速度和内存使用之间的折衷。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:42:49.210

我个人建议将`B+ tree`最顶层节点作为基类。

# java - 无法添加面板

> ID：12133290
> 
> 赞同：1
> 
> 时间：2012-08-26T19:40:40.787
> 
> 标签：java, swing, jpanel

我拥有的代码创建了一组按钮，但垂直对齐

![在此处输入图像描述](../Images/b50f52b03ef34f2e7173e35c48b20965.png)

现在我想做的是在这个面板中添加一个 JLabel，但是当我创建一个新的 JPanel 时，我在运行它时遇到错误，但代码不会给我任何冲突。如果可能的话，我想重新排列流程布局中的按钮。

我的完整代码：

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

public final class CharSearch extends Box {
    int i = 0;
    int error = 0;
    static JPanel panel;
    String original = "Dinosaur";
    String secret = new String(new char[original.length()]).replace('\0', '-');

    public CharSearch() {

        super(BoxLayout.Y_AXIS);
        for (char i = 'A'; i <= 'Z'; i++) {
            String buttonText = new Character(i).toString();
            JButton button = getButton(buttonText);
            add(button);
        }
        JLabel label = new JLabel(secret);
        JPanel panel = new JPanel();
        panel.add(label);
    }

    public JButton getButton(final String text) {
        final JButton button = new JButton(text);
        button.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                if (original.indexOf(text) != -1) {
                    JOptionPane.showConfirmDialog(null,
                            "Your word does contain" + text);
                } else {
                    JOptionPane.showConfirmDialog(null, "There is no" + text);
                }
                // If you want to do something with the button:
                button.setText("Clicked"); // (can access button because it's
                                            // marked as final)
            }
        });
        return button;
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(panel);
                frame.setContentPane(new CharSearch());
                frame.pack();
                frame.setVisible(true);
                new CharSearch();
            }
        });
    }
} 
```

这是我运行它时遇到的错误

![错误](../Images/b660a653534a3e4bff1e4bd6676f1c90.png) `Exception`是：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at java.awt.Container.addImpl(Unknown Source)
    at java.awt.Container.add(Unknown Source)
    at javax.swing.JFrame.addImpl(Unknown Source)
    at java.awt.Container.add(Unknown Source)
    at org.informatica.com.CharSearch$2.run(CharSearch.java:50)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$1.run(Unknown Source)
    at java.awt.EventQueue$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T19:51:53.827

您正在将一个未定义的 JPanel 对象添加到您的 JFrame 中，从而产生一个`NullPointerException`，如[`Container#add(Component)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Container.html#add%28java.awt.Component%29)文档中所述。

```
frame.add(panel); 
```

`panel`您必须在将其添加到 JFrame 的内容窗格容器之前进行实例化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T19:52:48.383

因为`NullPointerException`它是因为这条线：

```
frame.add(panel); 
```

虽然您创建了一个全局变量`panel`，但在将其添加到`frame`

# ios - 使用来自 Core Data 的 NSFetchRequest 来获取聚合关系计数？

> ID：12133296
> 
> 赞同：3
> 
> 时间：2012-08-26T19:41:29.240
> 
> 标签：ios, core-data, relationship, nsmanagedobject, nsfetchrequest

我无法理解如何最好地使用 Core Data 来解决这个问题，包括描述问题的正确术语。下面是问题的说明性示例（但不是我的实际对象）。假设您有一个音乐播放系统，其中艺术家有歌曲，并且每次在系统中播放歌曲时，都会记录时间戳。

**问题：**如何找到播放歌曲的艺术家数量？

这里是样本`NSManagedObject`

```
@interface MYArtist : NSManagedObject
@property (nonatomic, retain) NSString *name;
@property (nonatomic, retain) NSSet *songs;
@end

@interface MYSong : NSManagedObject
@property (nonatomic, retain) NSString *name;
@property (nonatomic, retain) MYArtist *artist;
@property (nonatomic, retain) NSSet *plays;
@end

@interface MYPlay : NSManagedObject
@property (nonatomic, retain) NSDate *playDate;
@property (nonatomic, retain) MYSong *song;
@end 
```

以下是艺术家、歌曲和播放的示例数据，包括播放日期：

```
A1 <-+-> S1_A1 <---> P1_S1_A1 (2012-08-31) 
     '-> S2_A1 <-+-> P1_S2_A1 (2012-08-31) 
                 '-> P2_S2_A1 (2012-09-01)
A2 <-+-> S1_A2
     '-> S2_A2 <---> P1_S2_A2 (2012-08-31) 
A3 <---> S1_A3 
```

使用下面的代码，我可以获取所有`MYPlay`对象并构建一组艺术家，然后在最后找到集合的大小。此示例数据和代码的结果集将是计数 = 2 的 [A1, A2]。但是，我希望某些`NSPredicate`语法或使用`countForFetchRequest`更有效，而不是迭代对象并将它们错误地放入内存中。

```
NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:@"MYPlay"];
NSArray *results = [managedObjectContext executeFetchRequest:fetchRequest error:&error];

NSMutableSet *set = [[NSMutableSet alloc] init];
for (id result in results) {
    MYPlay *play = (MYPlay *)result;
    [set addObject:play.song.artist];
}

NSUInteger count = set.count; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T20:43:08.590

记录不佳的`SUBQUERY`可能是一个很好的解决方案，您可以嵌套它们，以便检查关联的关联。

所以：

```
NSFetchRequest * request = [NSFetchRequest fetchRequestWithEntityName:@"MYArtist"]; 
request.predicate = [NSPredicate predicateWithFormat:@"(SUBQUERY(songs,$song,SUBQUERY($song.plays,$play,$play.playDate NOT NULL).@count > 0).@count >0)"]; // I'm assuming that songs with out a play have a nil playDate

NSUInteger count = [context countForFetchRequest:request error:&error]; 
```

我尚未测试该子查询字符串，但这应该可以帮助您入门。如果你用谷歌搜索，那里有一些很好的资源，但在 Apple 文档中并不多。[NSExpression](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSExpression_Class/Reference/NSExpression.html)的文档指出“子查询表达式的字符串格式是：”

> SUBQUERY(collection_expression, variable_expression, predicate);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T04:35:04.903

您可以试试这个：按播放次数超过 0 的唯一艺术家姓名获取歌曲。

```
 NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"MYSong"];
  NSPredicate *predicate = [NSPredicate predicateWithFormat:@"plays.@count > 0"];
  [request setPredicate:predicate];
  NSEntityDescription *entity = [NSEntityDescription entityForName:@"MYSong" inManagedObjectContext:context];
  NSDictionary *entityProperties = [entity propertiesByName];
  [request setReturnsDistinctResults:YES];
  [request setPropertiesToFetch:[NSArray arrayWithObject:[entityProperties objectForKey:@"artist"]]];

  NSError *error = nil;
  NSArray *result = [managedObjectContext executeFetchRequest:request error:&error]; 
```

查看更多获取唯一数据结果： [使用 Core Data 检索唯一结果集](https://stackoverflow.com/questions/2656227/retrieving-a-unique-result-set-with-core-data)

# c# - 如何等到一系列任务完成？

> ID：12133303
> 
> 赞同：2
> 
> 时间：2012-08-26T19:42:08.117
> 
> 标签：c#, task-parallel-library

我有一个`Task<T>`对象数组，并且想阻止直到所有对象都返回。我该怎么做？（这是在调试视图中，因此性能不是问题）。

基本上，相当于 jquery 的 $.when 的任务库是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-26T19:43:51.623

如果要阻止，可以使用`Task.WaitAll(yourTasks);`. 如果您想使用在全部完成后触发的延续（并且使用 .NET 4.5 或 .NET 4.0 的 AsyncTargetingPack），您可以使用`Task.WhenAll(yourTasks).ContinueWith(t => ...);`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-26T19:43:51.563

```
 Task.WaitAll(arrayOfTasks); ///..... 
```

# php - 交易错误

> ID：12133304
> 
> 赞同：0
> 
> 时间：2012-08-26T19:42:20.100
> 
> 标签：php, mysql, transactions

我需要帮助才能让这段交易代码按预期工作。看来我没有正确放置 BEGIN 和 COMMIT 。每当增加/减少金额时，余额应增加/减少，但事实并非如此。

```
<?php
require_once 'login.php';
$db_server = mysql_connect($db_hostname, $db_username, $db_password);
if (!$db_server) die("Unable to connect to MySQL: " . mysql_error());
mysql_select_db($db_database, $db_server)
or die("Unable to select database: " . mysql_error());

if(isset($_POST['amount']))
{
    if(isset($_POST['ADD']) && $number !="")  
    {
          mysql_query("BEGIN"); 
          $query="UPDATE accounts SET balance=balance+amount WHERE number='12345'"; 
    }
    else
    {
          $query="UPDATE accounts SET balance='balance-amount' WHERE number='12345'";
          mysql_query($query);     
    }

  if($query){
     mysql_query("COMMIT");
  }
  else{
    mysql_query("ROLLBACK");
  }

}

echo <<<_END
<form action='transaction.php' method="post"><pre>
Enter the amount: <input type="text" name="amount" />
<input type="submit" value="ADD VALUE" />   <input type="submit" value="SUBTRACT VALUE" />
</pre></form>
_END;

$query="SELECT balance FROM accounts WHERE number='12345'";
$result=mysql_query($query);
$rows=mysql_num_rows($result);

for($j=0; $j<$rows; ++$j)
{ 
   $row=mysql_fetch_row($result);
echo <<<_END
   <pre>
Your current balance is $row[$j]
   </pre>
_END;

}

echo <<<_END
<form action="transaction.php" method="post">
<input type="hidden" name="ADD" value="yes" />
<input type="hidden" name="SUBTRACT" value="yes" />
</pre></form>
_END;

mysql_close($db_server);

 ?> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:48:50.087

你的代码很丑陋，而且不好。例如，您没有`amount`在查询中设置，如果您发布`ADD`什么都不会发生，如果不是`ADD`，代码`'balance-amount'`不正常`balance-$amount`，`$number`没有在任何地方设置，等等......

请尝试使用 PDO，因为`mysql_*`不推荐使用功能...

```
$db = new PDO('mysql:host='.$db_hostname.';dbname='.$db_database, $db_username, $db_password, array(PDO::ATTR_EMULATE_PREPARES => false));

if(isset($_POST['amount']) && ($_POST['amount'] != '') && ($_POST['number'] != '')){

    if($_POST['type'] == 'ADD')  {
        $query = "UPDATE `accounts` SET `balance`=`balance`+:amount WHERE `number`=:number"; 
    } else {
        $query = "UPDATE `accounts` SET `balance`=`balance`-:amount WHERE `number`=:number";
    }

    try {

        $db->beginTransaction();

        $stmt = $db->prepare($query);
        $stmt->execute(array(':amount' => $_POST['amount'], ':number' => $_POST['number']));

        $db->commit();

    } catch(PDOException $ex) {
        $db->rollBack();
        echo $ex->getMessage();
    }
} 
```

另一个错误出现在您的表单中，您没有发送任何内容，请尝试以下操作：

```
echo <<<_END
<form action='transaction.php' method="post"><pre>
Enter the amount: <input type="text" name="amount" /> <br />
Number: <input type="text" name="number" value="12345" /><br />
Type: <select name="type"><option value="ADD">ADD</option><option value="SUBSTRACT">SUBSTRACT</option></select>
<input type="submit" value="Make changes" />
</pre></form>
_END; 
```

并获取信息：

```
$stmt = $db->query(SELECT `balance` FROM `accounts` WHERE `number`='12345');
$row = $stmt->fetch(PDO::FETCH_ASSOC);
echo "<pre>Your current balance is ".$row['balance']."</pre>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:47:44.063

查看分配和执行的顺序：

*   如果设置了 ADD，则执行 BEGIN，创建一个查询字符串，但从不执行它。
*   如果未设置 ADD，则不执行 BEGIN，但会创建并执行查询。

两者都有些错误。在所有情况下，`$query`设置为让您始终 ROLLBACK，但您并不总是启动事务。

你需要更多类似的东西：

```
if (isset($_POST['amount']))
{
    mysql_query("BEGIN"); 
    if (isset($_POST['ADD']) && $number !="")  
    {
        $query="UPDATE accounts SET balance=balance+amount WHERE number='12345'"; 
    }
    else
    {
        $query="UPDATE accounts SET balance='balance-amount' WHERE number='12345'";
    }
    mysql_query($query);     

    if (...query succeeded...)
    {
        mysql_query("COMMIT");
    }
    else
    {
        mysql_query("ROLLBACK");
    }
} 
```

我不确定您是如何检测到该查询有效的；您可能需要捕获并检查`mysql_query()`.

在某些时候，您将不得不重新考虑在设置 ADD 时从余额中减去金额但数字是空字符串的事实。但是您还需要同时修复重复`'12345'`的问题。如果未设置数字，您可能不应该在数据库中执行任何操作；您应该完全拒绝该请求。

* * *

PS：我认为这些`mysql_*`功能已被弃用。请改用 PDO。

记住要避免[SQL 注入](http://xkcd.com/327)`mysql_*`——使用函数比使用 PDO更难做到这一点。

# javascript - 何时以及为什么在 indexedDB 中调用 onupgradeneeded 方法？

> ID：12133306
> 
> 赞同：15
> 
> 时间：2012-08-26T19:42:39.287
> 
> 标签：javascript, html, indexeddb

我正在将[IndexedDB](http://www.w3.org/TR/IndexedDB/)用于测试项目。这是一些示例代码：

```
var indexedDB = window.indexedDB || window.webkitIndexedDB 
                ||window.mozIndexedDB||window.msIndexedDB;

  var request = indexedDB.open("mydb",2),    

  customerData=[
    {ssn:"444-44-4444",name:"Bill",age:35,email:"bill@company.com"},      
    {ssn:"555-55-5555",name:"Donna",age:32,email:"donna@home.org"}
  ];

  request.onerror = function(event){

  };
  request.onupgradeneeded = function(event) {

     var objectStore = db.createObjectStore("customers",{keyPath:"ssn"});
     objectStore.createIndex("name","name",{unique:false});
     objectStore.createIndex("email","email",{unique:true});

     for(var i in customerData){
        objectStore.add(customerData[i]);
     }
  };
  request.onsuccess = function(e) {

  }; 
```

我真正不明白的是我的请求对象何时运行`onupgradeneeded`而不是`onsuccess`（假设当然没有错误）。是在没有对象存储的时候吗？或者当创建一个新的数据库版本时？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-26T20:01:35.247

根据这个：[https://developer.mozilla.org/en-US/docs/IndexedDB/Using_IndexedDB?redirectlocale=en-US&redirectslug=IndexedDB%2FIndexedDB_primer](https://developer.mozilla.org/en-US/docs/IndexedDB/Using_IndexedDB?redirectlocale=en-US&redirectslug=IndexedDB%2FIndexedDB_primer)你已经有了正确的答案：

`onupgradeneeded`当您更改数据库版本时调用：从无数据库到第一个版本，第一个版本到第二个版本......

`onsuccess`每次发出新请求时都会调用它：即使数据库架构没有更改。

# python - Outlook 超链接的格式是什么？

> ID：12133310
> 
> 赞同：2
> 
> 时间：2012-08-26T19:43:27.040
> 
> 标签：python, hyperlink, outlook

我正在开发一个实用程序来获取一些（约 80 个）超链接并将它们转换为可以粘贴到 Outlook 电子邮件中的格式 - 导致 Outlook 仅显示链接 URL 中的参数。我们的错误跟踪系统中的超链接实际参考错误。超链接的区别仅在于 URL 末尾的错误编号参数。我的计划是让实用程序将 Outlook 格式的超链接推送到剪贴板上，以便将它们粘贴到 Outlook 中。我遇到的问题是：**Outlook 希望按照描述粘贴超链接的格式是什么——使用单个错误号作为链接的可见文本？** 作为参考，我打算用 Python 来做这一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T13:18:15.907

不确定[python 实现](http://code.activestate.com/recipes/474121-getting-html-from-the-windows-clipboard/)，但在 c# 中，您可以使用`System.Windows.Forms.Clipboard`为富文本编辑器复制 HTML 格式的文本。请参阅MSDN 上[的相关 SO 帖子](https://stackoverflow.com/a/4593519/175679)和[HTML 剪贴板格式](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649015%28v=vs.85%29.aspx)。也许使用[此参考链接](http://code.activestate.com/recipes/474121-getting-html-from-the-windows-clipboard/)- 您可以将其转换为基于 python 的方法。

```
private const string html = @"Version:0.9
StartHTML:<<<<<<<1
EndHTML:<<<<<<<2
StartFragment:<<<<<<<3
EndFragment:<<<<<<<4
SourceURL: {0}
<html>
<body>
<!--StartFragment-->
<a href='{0}'>{1}</a>
<!--EndFragment-->
</body>
</html>";

string link = String.Format(html, "http://www.stackoverflow.com", "StackOverflow");
Clipboard.SetText(link, TextDataFormat.Html); 
```

# google-maps - 谷歌地图 api 与浏览器检查元素一起使用

> ID：12133318
> 
> 赞同：4
> 
> 时间：2012-08-26T19:44:33.203
> 
> 标签：google-maps, google-maps-api-3, twitter-bootstrap

我一直在努力尝试在我的使用 twitter bootstrap 的应用程序中修复 google map canves 插件。

这张地图是满是灰色斑块的越野车，而且它从来都不是很好的中心。但我最近注意到的是，一旦我在包含插件的页面上单击“检查元素”，一切正常，地图工作正常。

这可能看起来很奇怪，但这就是我注意到的。Anyideas是什么问题以及如何解决它。

注意：我在 chrome 和 firefox 浏览器上测试过。

代码

触发模态的页面：[http](http://pastie.org/4594166) ://pastie.org/4594166 模态 html：[http](http://pastie.org/4594195) ://pastie.org/4594195 gmaps：`<script src='http://pastie.org/4595877.js'></script>`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T21:36:50.170

我猜你的地图默认不显示，但代码会有所帮助。听起来您需要在显示地图时触发调整大小。请参阅 Map 对象的事件下的调整大小：

[https://developers.google.com/maps/documentation/javascript/reference#Map](https://developers.google.com/maps/documentation/javascript/reference#Map)

[将此脚本添加到工作中]

```
$(document).ready(function () { 
  $('#mymodal').on('shown', function () { 
    google.maps.event.trigger(map, 'resize');  
  });   
}); 
```

# testing - Cabal 输出被重定向但未生成

> ID：12133320
> 
> 赞同：10
> 
> 时间：2012-08-26T19:44:46.417
> 
> 标签：testing, haskell, build, cabal

我有一个相当简单的haskell项目设置，我只想让框架在我真正开始编码之前进行测试等等。我在一个`/src`目录中有可执行文件的源文件（`/`项目的根目录在哪里），在一个`/testsuite`目录中有我的测试。`/testsuite`包含一个简单的测试文件，称为`TestSuite.hs`with`main = Test.Framework.defautMain tests`作为 main 的实现。问题是，当我跑步时

```
cabal clean && cabal configure --enable-tests && cabal build 
```

我收到警告

```
output was redirected with -o, but no output will be generated because there is no main module. 
```

当我不指定时，构建工作正常`--enable-tests`。我的阴谋文件是：

```
Name:                Example
Version:             0.1
Synopsis:            Synopsis
Description:
    Long description.
License:             GPL
License-File:        LICENSE
Author:              SeanK
Maintainer:          email@example.com
Category:            Development
Build-Type:          Simple
Cabal-Version:       >= 1.8

Test-Suite test
    Type:               exitcode-stdio-1.0
    Main-Is:            TestSuite.hs
    Build-Depends:      base >= 3 && < 5,
                        test-framework,
                        test-framework-quickcheck
                        -- QuickCheck
    Hs-Source-Dirs:     src,
                        testsuite

Executable example
    Main-Is:            Main.hs
    -- Other-Modules:       
    Build-Depends:      base >= 3 && < 5,
                        haskell98
    Hs-Source-Dirs:     src
    Ghc-Options:        -Wall 
```

我禁用了 QuickCheck，因为我目前没有使用 (==>)，这是我目前需要的唯一功能。其余的应该是直截了当的。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-26T20:43:25.433

您应该在`TestSuite.hs`文件中将模块名称定义为`Main`，例如[那里](https://github.com/selectel/bson-haskell/blob/master/tests/Tests.hs)。

引用[Haskell 98 报告](http://www.haskell.org/onlinereport/modules.html)：

> Haskell 程序是一组模块，按照惯例，其中一个必须称为 Main 并且必须导出值 main。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-06-16T16:55:48.213

`TestSuite`您可以添加一个 GHC 选项来将主模块的名称设置为 Cabal 文件，而不是像 Fedor 建议的那样重命名模块：

```
Test-Suite testFedor
    ghc-options:    -main-is TestSuite 
```

显然，Cabal`main-is`和 GHC`main-is`是不同的。我不知道以什么方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-26T03:34:14.410

如果您使用的是与[hpack](https://github.com/sol/hpack)兼容的系统，例如 Stack、cabal2nix 或只是该`hpack`工具，您可以`.cabal`从文件生成`package.yaml`文件。`executables:`对于in下的条目，`package.yaml`您可以指定以`main:`以下两种方式之一工作的键：

1.  给定一个`.hs`文件名，该文件名将直接复制到`main-is:`生成的 Cabal 文件的行中，提供 Cabal 语义。

2.  给定一个模块名称或模块和导出的定义名称（例如，`Foo`或`Foo.startup`），适当的`ghc-options: -main-is ...`将被添加到生成的 Cabal 文件中，并且`main-is:`将是从模块名称（例如`main-is: Foo.hs`）生成的文件名。

如果您不想使用 a`package.yaml`但难以让 Cabal 文件正常工作，则可能仍然值得设置一个临时的、最小的`package.yaml`并在其上运行`hpack`以查看它产生的输出并确认您是以同样的方式编写你的 Cabal 文件。

对于它的价值，这是我最近的一个项目中的一个`exectuables:`部分的示例：`package.yaml`

```
executables:
  hello:
    source-dirs: src/
    main: Hello.main 
```

以及我生成的`.cabal`文件中的相关代码片段：

```
executable hello
  main-is: Hello.hs
  hs-source-dirs:
    src/
  ghc-options: -main-is Hello 
```

# math - 30人组团

> ID：12133323
> 
> 赞同：1
> 
> 时间：2012-08-26T19:45:38.803
> 
> 标签：math

我想编写一个程序，可以提供 3 人的系列组，以便没有人与同一个人两次在组中。所以我们不能在两个不同的系列中有 123 和 124！

例如：9 人。最多可组成四次：
系列 1：
组 1： 1 2 3
组 2： 4 5 6
组 3： 7 8 9

系列 2：
第 1 组：1 5 9
第 2 组：2 6 7
第 3 组：3 4 8

系列 3：
第 1 组 3 5 7
第 2 组：1 6 8
第 3 组：2 4 9

第 4 组：
第 1 组：3 6 9
第 2 组：2 5 8
第 3 组：1 4 7

但是只有 12 个人，我觉得很难手工完成。可以组成 4-5 个 12 人的系​​列（绝对最大）。

我只是不知道如何编写这个程序。除了用笔和纸“尝试”之外，我找不到系统的方法。我想和30个人一起做。30人可组成13-14个系列。（绝对最大值）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:58:35.773

好的，这是一个使用 c++ 的回溯解决方案：

```
#include <stdio.h>

using namespace std;

int v[100], n;
int ma[100][100];

void init(int k)
{
    v[k] = 0;
}

bool solutionReached( int k ) 
{
    if (k == n + 1)
        return true;
    return false;
}

void printSolution( int k ) 
{
    for (int i = 1; i < k; i++)
    {
        printf("%i ", v[i]);
        if (i % 3 == 0)
        {
            printf("\n");
        }
    }

    for (i = 1; i < n; i++)
    {
        if (i % 3 == 1)
        {
            for (int j = i + 1; j < i + 3; j++)
            {
                ma[v[i]][v[j]] = 1;
                ma[v[j]][v[i]] = 1;
            }
        }

        for (int j = i + 1; j % 3 == 0; j++)
        {
            ma[v[i]][v[j]] = 1;
            ma[v[j]][v[i]] = 1;
        }
    }

    for (i = 1; i <= n; i++)
    {
        for (int j = 1; j <= n; j++)
        {
            //printf("%d ", ma[i][j]);
        }
        //printf("\n");
    }

    printf("\n");
}

bool hasSuccesor( int k ) 
{
    if(v[k] < n)
    {
        v[k]++;
        return true;
    }
    return false;
}

bool isValid( int k ) 
{
    for (int i = 1; i < k; i++)
    {
        if (v[i] == v[k])
        {
            return false;
        }

        /*if (ma[v[i]][v[k]] == 1)
        {
            return false;
        }*/
    }

    for (i = 1; i < k; i++)
    {
        if (i % 3 == 1)
        {
            for (int j = i + 1; j < i + 3; j++)
            {
                if (ma[v[i]][v[j]] == 1)
                {
                    return false;
                }
            }
        }

        for (int j = i + 1; j % 3 == 0; j++)
        {
            if (ma[v[i]][v[j]] == 1)
            {
                return false;
            }
        }
    }

    return true;
}

void bkt(int k)
{
    if(solutionReached(k))
        printSolution(k);
    else
    {
        init(k);
        while(hasSuccesor(k))
            if(isValid(k))
                bkt(k + 1);
    }
}

int main(int argc, char* argv[])
{
    n = 9;
    bkt(1);

    return 0;
} 
```

如果您想进行实验，请更改`n = 9`为除以 的任何数字`3`，例如`12, 15, 21`，但即使是很小的数字 (>15) 也会花费很多时间（这取决于计算机）。

编辑：我重做“没有人与同一个人在同一组中两次”，但我只能找到 3 个组而不是 4 个，9 个人。

例如： - 对于 9 个程序给出：

```
1 2 3 
4 5 6 
7 8 9 

1 4 7 
2 5 8 
3 6 9 

1 5 9 
2 6 7 
4 3 8 
```

对于 12 程序给出：

```
1 2 3 
4 5 6 
7 8 9 
10 11 12 

1 4 7 
2 5 10 
3 8 11 
6 9 12 

1 5 8 
2 4 12 
3 9 10 
7 6 11 
```

对于 15：

```
1 2 3 
4 5 6 
7 8 9 
10 11 12 
13 14 15 

1 4 7 
2 5 8 
3 10 13 
6 11 14 
9 12 15 

1 5 9 
2 4 10 
3 6 15 
7 11 13 
8 12 14 

1 6 8 
2 7 14 
4 12 13 
5 10 15 
11 3 9 
```

18 岁：（一分半钟后 - 所以还有更多 -）

```
1 2 3 
4 5 6 
7 8 9 
10 11 12 
13 14 15 

1 4 7 
2 5 8 
3 10 13 
6 11 14 
9 12 15 

1 5 9 
2 4 10 
3 6 15 
7 11 13 
8 12 14 

1 6 8 
2 7 14 
4 12 13 
5 10 15 
11 3 9 

1 2 3 
4 5 6 
7 8 9 
10 11 12 
13 14 15 
16 17 18 

1 4 7 
2 5 8 
3 6 9 
10 13 16 
11 14 17 
12 15 18 

1 5 9 
2 4 10 
3 7 11 
6 13 18 
8 15 17 
14 12 16 

1 6 8 
2 7 12 
3 4 13 
5 10 17 
9 14 18 
11 15 16 

1 10 14 
2 6 15 
3 5 12 
4 9 16 
7 13 17 
8 11 18 
```

如果要将它们保存到文件中，请包含 fstream 并将 printSolution 修改为：

```
 void printSolution( int k ) 
    {
        ofstream cout;
        cout.open("date.txt", ios::app);

        for (int i = 1; i < k; i++)
        {
            cout << v[i] << " ";
            if (i % 3 == 0)
            {
                cout << "\n";
            }
        }

        for (i = 1; i < n; i++)
        {
            if (i % 3 == 1)
            {
                for (int j = i + 1; j < i + 3; j++)
                {
                    ma[v[i]][v[j]] = 1;
                    ma[v[j]][v[i]] = 1;
                }
            }

            for (int j = i + 1; j % 3 == 0; j++)
            {
                ma[v[i]][v[j]] = 1;
                ma[v[j]][v[i]] = 1;
            }
        }
     } 
```

# asp.net - 构建输入文本区域以允许 HTML 但防止安全/脚本攻击

> ID：12133327
> 
> 赞同：4
> 
> 时间：2012-08-26T19:45:53.073
> 
> 标签：asp.net, asp.net-mvc, security

平台：ASP.NET 4.0 MVC 4 C# jQuery

这就是我想做的。

我正在为我的产品建立一个简单的论坛。我想给用户一个文本区域来输入他们的帖子或评论。

1.  我想允许基本的文本格式 HTML 和链接 - 比如 p、a、b、i
2.  不想要任何其他 html 样式 - 即 div、span 等。
3.  不想要任何脚本访问

有没有聪明的方法来做到这一点？例如，我可以允许不安全的文本并在服务器端对其进行检查，但我怀疑我是否能够正确清理它并且可能会打开安全漏洞。

最好避免使用重型插件。

谢谢！

（PS - 我最糟糕的后备是我只允许安全文本，即保持 ASP.NET 安全，然后对链接使用特殊标记 - 例如 [link] [b] [i]）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-05-23T16:19:25.157

**更新（2020 年 2 月）：** [Microsoft 的 AntiXSS 库](https://www.nuget.org/packages/AntiXSS/)在其 Sanitizer 类上包含一个名为 GetSafeHtmlFragment 的静态方法，这似乎是做生意的。（由[@exploring.cheerily.impresses](https://stackoverflow.com/users/3767420/exploring-cheerily-impresses)建议）

* * *

在 .NET 4.5+ 中或通过添加`System.Web.Security.AntiXss`到旧版本的 .NET 中，有一种解决此问题的好方法。我们可以`[AllowHtml]`和一个自定义注解属性一起使用。该方法应将字符串中的 HTML 标记列入白名单并验证请求。

这是此作业的自定义注释属性：

```
[AttributeUsage(AttributeTargets.Property | AttributeTargets.Field, Inherited = true, AllowMultiple = false)]
public sealed class RemoveScriptAttribute : ValidationAttribute
{
    public const string DefaultRegexPattern = @"\<((?=(?!\b(a|b|i|p)\b))(?=(?!\/\b(a|b|i|p)\b))).*?\>";

    public string RegexPattern { get; }

    public RemoveScriptAttribute(string regexPattern = null)
    {
        RegexPattern = regexPattern ?? DefaultRegexPattern;
    }

    protected override ValidationResult IsValid(object value, ValidationContext ctx)
    {
        var valueStr = value as string;
        if (valueStr != null)
        {
            var newVal = Regex.Replace(valueStr, RegexPattern, "", RegexOptions.IgnoreCase, new TimeSpan(0, 0, 0, 0, 250));

            if (newVal != valueStr)
            {
                var prop = ctx.ObjectType.GetProperty(ctx.MemberName);
                prop.SetValue(ctx.ObjectInstance, newVal);
            }
        }

        return null;
    }
} 
```

然后你应该使用 [AllowHtml] 和 [RemoveScript] 属性来装饰你想要在其中包含 HTML 的模型属性，如下所示：

```
public class MyModel
{
    [AllowHtml, RemoveScript]
    public string StringProperty { get; set; }
} 
```

这将只允许 <a>、<b>、<i> 和 <p> html 标记获取它。所有其他标签都将被删除，但它足够聪明，可以保留标签的内部文本。例如，如果您发送：

> “这是 <u>John Smith</u> 输入的<b>富文本<b>。”

你最终会得到这个：

> “这是由 John Smith 输入的<b>富文本<b>。”

将更多 HTML 标签列入白名单也很容易。例如，如果您想接受 <u></u>、<br /> 和 <hr />，请更改`DefaultRegexPattern`（全局影响）或将修改后的 regexPattern 传递给 的实例`RemoveScriptAttribute`，如下所示：

```
[AllowHtml]
[RemoveScript(regexPattern: @"\<((?=(?!\b(a|b|i|p|u|br|hr)\b))(?=(?!\/\b(a|b|i|p|u)\b))).*?\>")]
public string Body { get; set; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:20:33.420

无论您使用什么方法，您都需要假设输入该字段的所有内容都是恶意的，即不信任任何数据。

我不会为 JavaScript/jQuery 中的任何客户端验证操心太多。它会很复杂，只需要重做服务器端。

服务器端你想采取白名单的方法，即如果它不在名单上，它是无效的。您将无法使用 XML 处理器，因为用户的文本可能不会生成有效的 XML，相反您可能希望使用正则表达式。

我会定义一组有效的标签（你说过 p、a、b 和 i，但我会厌倦最后两个，因为你几乎永远不会在“狂野”的 html 中得到它们），然后我会定义是否以及哪些属性对这些标签有效。我猜你至少想要a上的href。

您可以删除标签中不匹配的任何文本......我的正则表达式技能不是很好，但这似乎可以找到您想要保留的所有标签，它需要被反转。

```
\<a\shref\=".[^\"]*\"\>|\</?[abip]\s?\> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T21:59:17.377

有大量在线编辑器可供您使用。我在 google 中输入了“免费在线文本编辑器”，并请来了一堆编辑器进行审查。

如果您必须在标记中使用 html，那么当您发现不“安全”的标签时，您将需要解析提交的文本以拒绝该文本。

仅供参考，您可能会对此感兴趣 [https://meta.stackexchange.com/questions/121981/stackoverflow-official-wmd-editor](https://meta.stackexchange.com/questions/121981/stackoverflow-official-wmd-editor)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T21:04:38.673

我将 joocer 的答案标记为“答案”，因为它帮助我形成了自己的观点（尽管他说的不是我最终所做的）

我决定了一个简单的规则 - 我将链接 http://.... 链接并禁止任何其他 html（这对我的应用程序来说很好）。这样，我让 ASP.NET 框架进行所有错误检查并禁止任何 HTML 标记。然后，当我在客户端上呈现文本时，我只识别并修改了 http:// 链接，通过标记装饰，而 HTML 安全编码其他所有内容。

# java - if 语句检查 null 但仍抛出 NullPointerException

> ID：12133328
> 
> 赞同：38
> 
> 时间：2012-08-26T19:46:00.640
> 
> 标签：java, nullpointerexception

在这段代码中。

```
public class Test {
     public static void testFun(String str) {
         if (str == null | str.length() == 0) {
             System.out.println("String is empty");
         } else { 
             System.out.println("String is not empty");
         }
     }
     public static void main(String [] args) {
         testFun(null);
    }
} 
```

我们将一个`null`值传递给函数`testFun`。编译得很好，但`NullPointerException`在运行时给出了一个，这是我没想到的。为什么它抛出异常，而不是评估`if`条件`true`并打印“字符串为空”？

* * *

假设传递给的实际参数的值`testFun`是从某个进程生成的。假设该`null`进程错误地返回了一个值并将其馈送到 testFun。如果是这种情况，如何验证传递给函数的值是否为空？

一种（奇怪的）解决方案可能是将形参分配给函数内部的某个变量，然后对其进行测试。但是如果有很多变量传递给函数，那可能会变得乏味且不可行。那么，在这种情况下如何检查空值呢？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-08-26T19:59:52.970

编辑准确地显示了有效代码和无效代码之间的区别。

此检查始终评估*这两个*`str`条件，如果为 null ，则抛出异常：

```
 if (str == null | str.length() == 0) { 
```

而这（使用`||`而不是`|`）是*短路的*- 如果第一个条件评估为`true`，则不评估第二个条件。

请参阅JLS 的第[15.24](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.24)[节以了解](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.22.2)对. 不过，第 15.24 节的介绍很重要：`||``|`

> 条件或运算符 || 运算符就像 | （§15.22.2），但仅当其左侧操作数的值为假时才评估其右侧操作数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-06-25T08:48:44.160

您可以使用`StringUtils`：

```
import org.apache.commons.lang3.StringUtils;

if (StringUtils.isBlank(str)) {

System.out.println("String is empty");

} else { 

System.out.println("String is not empty");

} 
```

也看看这里：[StringUtils.isBlank() vs String.isEmpty()](https://stackoverflow.com/questions/23419087/stringutils-isblank-vs-string-isempty)

`isBlank`例子：

```
StringUtils.isBlank(null)      = true
StringUtils.isBlank("")        = true  
StringUtils.isBlank(" ")       = true  
StringUtils.isBlank("bob")     = false  
StringUtils.isBlank("  bob  ") = false 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-26T19:50:55.950

这里的问题是，在您的代码中，如果传递给函数的参数为​​空，则程序正在调用未定义的“null.length()”。这就是抛出异常的原因。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-26T19:57:59.743

问题是您使用的是按位或运算符：`|`。如果您使用逻辑或运算符`||`，您的代码将正常工作。

另请参阅：
[http ://en.wikipedia.org/wiki/Short-circuit_evaluation](http://en.wikipedia.org/wiki/Short-circuit_evaluation)
[Java 中 & 和 && 的区别？](https://stackoverflow.com/q/7199666/758280)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-22T11:05:02.257

更改下一行

```
if (str == null | str.length() == 0) { 
```

进入

```
if (str == null || str.isEmpty()) { 
```

现在您的代码将正确运行。确保`str.isEmpty()`紧随其后，`str == null`因为调用`isEmpty()`null 会导致`NullPointerException`. 因为Java在为真时使用*短路评估*`str == null`，所以它不会评估`str.isEmpty()`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-04T07:23:08.323

该| 和 & 每次检查双方。

> if (str == null | str.length() == 0)

在这里我们很有可能得到 NullPointerException

逻辑 || && 仅在必要时检查右侧。

但有逻辑运算符

> 没有机会获得 NPE，因为它不会检查 RHS

# ios - Core Plot 1.0 如何实现 reloadData 方法？

> ID：12133332
> 
> 赞同：5
> 
> 时间：2012-08-26T19:46:51.940
> 
> 标签：ios, core-plot

我昨天问了这个问题，并从 Eric Skroch 那里得到了很大的帮助。但是，在查看了 Core Plot 网站上的所有文档以及一些示例后，我仍然有点困惑。因此，我将发布到目前为止的代码，看看是否有人可以帮助我更多。也许埃里克也能更容易地提供帮助。我的问题是我需要删除一个情节，然后在选项卡式应用程序中将其替换为另一个情节。Eric 和其他人说要使用 reloadData 方法。但是我看不到我可以在我的代码中的哪里使用它？这是我的头文件和实现文件。

```
#import <UIKit/UIKit.h>
#import "CorePlot-CocoaTouch.h" 

@interface GraphViewController : UIViewController <CPTPlotDataSource>

@property (nonatomic, strong) CPTGraphHostingView *hostView;
@property (nonatomic, strong) NSMutableArray *myData;
@property (nonatomic) float XAXISMIN;
@property (nonatomic) float XAXISMAX;
@property (nonatomic) float YAXISMIN;
@property (nonatomic) float YAXISMAX;
@property (strong, nonatomic) IBOutlet UILabel *noGraph;

@end 
```

和

```
#import "GraphViewController.h"
#import "MyVariables.h"  // a singleton class for my variables

@interface GraphViewController ()

@end

@implementation GraphViewController

@synthesize  hostView = _hostView;
@synthesize myData = _myData;
@synthesize XAXISMIN;
@synthesize XAXISMAX;
@synthesize YAXISMAX;
@synthesize noGraph;
@synthesize YAXISMIN;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // Custom initialization
}
return self;
}

- (void)viewWillAppear:(BOOL)animated
{
[super viewWillAppear:animated];
[noGraph setText:@""];
}

- (void)viewDidAppear:(BOOL)animated
{

[super viewDidAppear:animated];
MyVariables *sharedVariables2 = [MyVariables sharedVariables2];
float a = [sharedVariables2.AA floatValue];
MyVariables *sharedVariables3 = [MyVariables sharedVariables3];
float b = [sharedVariables3.BB floatValue];    
MyVariables *sharedVariables4 = [MyVariables sharedVariables4];
float c = [sharedVariables4.CC floatValue];

float d = (4.0f)*a*c;
float e = (b*b);
float f = (e - d);
float g = sqrtf(f);
float h = -b;
float i = h + g;
float ii = h - g;
float j = i/(2*a);
float k = ii/(2*a);

// Define x max and min with answers to quad
XAXISMIN = j - (5.0);
XAXISMAX = k + (5.0);

// Find range for the y axis  STILL NEEDS WORK!
// maybe if statement for negatives
float z = c - ((b*b)/((4.0f)*a));
YAXISMAX = z + 10.0f;
YAXISMIN = -z;

float inc = (XAXISMAX - XAXISMIN) / 100.0f;
float l = XAXISMIN;

if ((isnan(g))  || (a == 0))
{ 
    [noGraph setText:@"This is not graphable"];
    [_hostView setHidden:YES];
}
else 
{
    NSMutableArray *data = [NSMutableArray array];

    for (int i = 0; i < 100; i ++)
    {

        float y = (a * (l*l)) + (b * l) + c;

        NSString *str4 = [NSString stringWithFormat:@"%.3f", l];
        NSString *str5 = [NSString stringWithFormat:@"%.3f", y];

        NSLog(@"Our X and Y are : %@, %@", str4, str5);
        [data addObject:[NSValue valueWithCGPoint:CGPointMake(l, y)]];
        l = l + inc;

    }
    self.myData = data;  // put that data array into the array you synthesized
    [self initPlot];   
}
}

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view.
}

- (void)viewDidUnload
{   
[self setNoGraph:nil];
[super viewDidUnload];
// Release any retained subviews of the main view.
}

- (void)viewWillDisappear:(BOOL)animated
{
[super viewWillDisappear:animated];

}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (NSUInteger)numberOfRecordsForPlot:(CPTPlot *)plot
{
return [_myData count];  
}

- (NSNumber *)numberForPlot:(CPTPlot *)plot field:(NSUInteger)fieldEnum recordIndex:  (NSUInteger)index
{
if ([plot.identifier isEqual:@"Your data"])
{
    NSValue *value = [self.myData objectAtIndex:index];
    CGPoint point = [value CGPointValue];

    // FieldEnum determines if we return an X or Y value.
    if (fieldEnum == CPTScatterPlotFieldX) 
    {
        return [NSNumber numberWithFloat:point.x];
    }
    else    // Y-Axis
    {
        return [NSNumber numberWithFloat:point.y];
    }
}
return [NSNumber numberWithFloat:0];
}

- (void)initPlot
{
[self configureHost];
[self configureGraph];
[self configurePlots];
[self configureAxes];

}

- (void)configureHost
{
self.hostView = [(CPTGraphHostingView *) [CPTGraphHostingView alloc] initWithFrame:self.view.bounds]; 
self.hostView.allowPinchScaling = YES;
[self.view addSubview:self.hostView];
}

- (void)configureGraph
{
// 1 - Create graph
CPTGraph *graph = [[CPTXYGraph alloc] initWithFrame:self.hostView.bounds];
self.hostView.hostedGraph = graph;

// 2 - Set graph title
NSString *title = @"Your Quadratic";
graph.title = title;

// 3 - Create and set text style
CPTMutableTextStyle *titleStyle = [CPTMutableTextStyle textStyle];
titleStyle.color = [CPTColor whiteColor];
titleStyle.fontName = @"Helvetica-Bold";
titleStyle.fontSize = 16.0f;
graph.titleTextStyle = titleStyle;
graph.titlePlotAreaFrameAnchor = CPTRectAnchorTop;
graph.titleDisplacement = CGPointMake(0.0f, 10.0f);

// 4 - Set padding for plot area
[graph.plotAreaFrame setPaddingTop:30.0f];
[graph.plotAreaFrame setPaddingRight:30.0f];
[graph.plotAreaFrame setPaddingLeft:30.0f];
[graph.plotAreaFrame setPaddingBottom:30.0f];

// 5 - Enable use interaction for plot space
CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)graph.defaultPlotSpace;
plotSpace.allowsUserInteraction = YES;
}

- (void)configurePlots
{
// 1 - Get graph and plot spaces and set axis
CPTGraph *graph = self.hostView.hostedGraph;
CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *) graph.defaultPlotSpace;

float xAxisMin = XAXISMIN;
float xAxisMax = XAXISMAX;
float yAxisMin = YAXISMIN;
float yAxisMax = YAXISMAX;

plotSpace.xRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(xAxisMin) length:CPTDecimalFromFloat(xAxisMax - xAxisMin)];
plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(yAxisMin) length:CPTDecimalFromFloat(yAxisMax - yAxisMin)];

// 2 - Create the plot
CPTScatterPlot *quadGraph = [[CPTScatterPlot alloc] init];
quadGraph.dataSource = self;
quadGraph.identifier = @"Your data";
CPTColor *quadColor = [CPTColor blackColor];
[graph addPlot:quadGraph toPlotSpace:plotSpace];

// 4 - Create styles and symbols
CPTMutableLineStyle *quadLineStyle = [quadGraph.dataLineStyle mutableCopy];
quadLineStyle.lineWidth = 2.5;
quadLineStyle.lineColor = quadColor;
quadGraph.dataLineStyle = quadLineStyle;

CPTMutableLineStyle *quadSymbolLineStyle = [CPTMutableLineStyle lineStyle];
quadSymbolLineStyle.lineColor = quadColor;

CPTPlotSymbol *quadSymbol = [CPTPlotSymbol ellipsePlotSymbol];
quadSymbol.fill = [CPTFill fillWithColor:quadColor];
quadSymbol.lineStyle = quadSymbolLineStyle;
quadSymbol.size = CGSizeMake(6.0f, 6.0f);
quadGraph.plotSymbol = quadSymbol;

}

- (void)configureAxes
{
// 1 - Create styles
CPTMutableTextStyle *axisTitleStyle = [CPTMutableTextStyle textStyle];
axisTitleStyle.color = [CPTColor whiteColor];
axisTitleStyle.fontName = @"Helvetica-Bold";
axisTitleStyle.fontSize = 12.0f;
CPTMutableLineStyle *axisLineStyle = [CPTMutableLineStyle lineStyle];
axisLineStyle.lineWidth = 2.0f;
axisLineStyle.lineColor = [CPTColor whiteColor];
CPTMutableTextStyle *axisTextStyle = [[CPTMutableTextStyle alloc] init];
axisTextStyle.color = [CPTColor whiteColor];
axisTextStyle.fontName = @"Helvetica-Bold";    
axisTextStyle.fontSize = 11.0f;
CPTMutableLineStyle *tickLineStyle = [CPTMutableLineStyle lineStyle];
tickLineStyle.lineColor = [CPTColor whiteColor];
tickLineStyle.lineWidth = 2.0f;
CPTMutableLineStyle *gridLineStyle = [CPTMutableLineStyle lineStyle];
tickLineStyle.lineColor = [CPTColor blackColor];
tickLineStyle.lineWidth = 1.0f;

// 2 - Get axis set
CPTXYAxisSet *axisSet = (CPTXYAxisSet *) self.hostView.hostedGraph.axisSet;

// 3 - Configure x-axis
CPTAxis *x = axisSet.xAxis;
x.title = @"X Axis"; 
x.titleTextStyle = axisTitleStyle;    
x.titleOffset = 1.0f;
x.axisLineStyle = axisLineStyle;
x.labelingPolicy = CPTAxisLabelingPolicyEqualDivisions; //CPTAxisLabelingPolicyNone;
x.labelTextStyle = axisTextStyle;    
x.majorTickLineStyle = axisLineStyle;
x.majorTickLength = 4.0f;
x.tickDirection = CPTSignPositive; //CPTSignNegative;

// 4 - Configure y-axis
CPTAxis *y = axisSet.yAxis;    
y.title = @"Y Axis";
y.titleTextStyle = axisTitleStyle;
y.titleOffset = -40.0f;       
y.axisLineStyle = axisLineStyle;
y.majorGridLineStyle = gridLineStyle;
y.labelingPolicy = CPTAxisLabelingPolicyEqualDivisions;
y.labelTextStyle = axisTextStyle;    
y.labelOffset = 16.0f;
y.majorTickLineStyle = axisLineStyle;
y.majorTickLength = 4.0f;
y.minorTickLength = 2.0f;    
y.tickDirection = CPTSignNegative;

}

@end 
```

所以我希望有人可以让我知道在哪里清除我的数据/绘图，这样我一次在图表选项卡上只有一个图表。提前非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T21:46:30.927

您应该初始化和配置图形和托管视图（即调用`-initPlot`），`-viewDidLoad`以便它只发生一次。在`-viewDidAppear`中，执行您需要的任何数据处理，为图形做好准备，然后调用`-reloadData`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-27T22:14:40.690

好吧，对于任何关注这个问题的人，我已经找到了答案。在 Eric Skroch 的大力帮助和指导下，他带领我朝着正确的方向前进。至少我认为我做的是对的！由于我的图表仅是使用 viewDidAppear 方法创建的，因此我必须找到另一种使用 reloadData 的方法。所以我 NSLogged 几种方法来查看当视图消失时调用了哪个方法，我发现 viewWillDisappear 就是其中之一。因此，在这种方法中，我使用了以下方法；

`self.hostView.hostedGraph = nil;`

和

`[_myData removeAllObjects];`.

这将清除图表并为下一个做好准备，并清空我的 Array 以使其做好准备。我很想听听任何人对他们对我的解决方法的看法。不过，我会接受 Eric 的回答，因为没有他的帮助，我不会走到这一步。再次感谢！

# jquery - 如何更改 jquery datepicker 的父 div？

> ID：12133336
> 
> 赞同：1
> 
> 时间：2012-08-26T19:47:11.277
> 
> 标签：jquery, jquery-ui, jquery-ui-datepicker

我在滑块内有 jquery ui datepicker，它正在处理鼠标悬停/离开，每次我尝试选择一个日期时，它都会注册 mouseleave 事件，因为 datepicker 已附加到页面底部，而不是在触发悬停事件的 div 中. 所以我需要更改 datepicker 的目标 div ......知道怎么做吗？ [打开信息和定价栏，点击立即预订，然后尝试选择日期](http://www.bozioko.com/en/room/levandule)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-26T20:05:03.837

好的...我在 jqueryui-custom 文件中搜索了“body”，并将其替换为“#mainmenu”，这是我想要的 div 的 id。

# freeswitch - FreeSwitch/FusionPBX 转移到错误的分机

> ID：12133344
> 
> 赞同：1
> 
> 时间：2012-08-26T19:48:08.447
> 
> 标签：freeswitch

这是我的场景：

主叫拨打 PSTN 线路，该线路连接到 GrandStream GWX4108，注册为 freeswitch 网关。

1.  电话被 IVR--Welcome IVR (Exten: 5000) 接听。
2.  主叫按 1，转移到另一个 IVR--MainMenu-IVR-NP (Exten: 5001)。
3.  主叫按0，转至寻线组--FrontDesk Hunt。（扩展：6500）。
4.  分机 6002 的 FrontDesk Hunt 接线员接听电话。然后，她向分机 9999 进行盲转。

分机 9999 不振铃。令我惊讶的是，电话转到了另一个寻线组——支持寻线（Exten 6600）。

以下是用于调查和审查的日志副本。

[http://pastebin.com/vZ2z6bUH](http://pastebin.com/vZ2z6bUH)

**编辑#1**

除上述问题外，所有扩展均正常工作。例如，对于来自任何分机的呼出呼叫，我们可以毫无问题地将呼叫转移到任何分机。

**编辑#2**

**Exten 9999 的拨号方案**

/目录/默认/v_9999.xml

```
<include>
  <user id="9999">
    <params>
      <param name="password" value="secret"/>
      <param name="vm-password" value="user-choose"/>
      <param name="vm-enabled" value="true"/>
    </params>
    <variables>
      <variable name="toll_allow" value=""/>
      <variable name="accountcode" value=""/>
      <variable name="user_context" value="default"/>
      <variable name="effective_caller_id_name" value="CEO Line2"/>
      <variable name="directory-visible" value="true"/>
      <variable name="directory-exten-visible" value="true"/>
      <variable name="limit_max" value="5"/>
    </variables>
  </user>
</include> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T20:32:18.533

查看您的日志，您调用的不是目录用户 9999，而是 xml 拨号计划扩展 9999：

> 2012-08-25 20:11:15.575195 [通知] switch_ivr.c:1711 将 sofia/internal/9851187087@192.168.0.200 转移到 XML[9999@default]

请添加到您的 dialplan/default.xml：

```
<context name="default">
  <extension name="9999">
     <condition field="destination_number" expression="9999">
        <action application="bridge" data="user/9999"/> 
     </condition>
  </extension>
</context> 
```

或者更改您的拨号方案以重定向到 user/9999。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T17:13:03.900

FusionPBX-->拨号方案-->拨号方案管理器

编辑拨号方案“extension-intercom”，设置启用为真。

我们遇到了类似的问题，通过设置上述参数解决了。

希望这可以帮助。

# c++ - 包括查找编译器选项的外部头文件

> ID：12133353
> 
> 赞同：9
> 
> 时间：2012-08-26T19:49:27.377
> 
> 标签：c++, c, compilation, header-files

假设我在互联网上找到了一个非常好的开源库，现在我想将它用于我自己的项目。

我下载它，可能编译它并获取头文件和静态/动态库。

所以我开始编写自己的源文件，当然，当我想使用这个外部库中的功能时，我会将它的正确标头包含到我的源文件中。

现在我编译我的源文件，确保这个外部库的包含路径和链接器选项设置正确。

而且我得到了一堆错误，所有这些都来自外部标题。原来他们需要一些编译器标志。

**如何找出我必须设置的最小编译器标志（以便能够从外部库编译头文件）？**

到目前为止我的想法是：

1.  在源代码的构建脚本中查找它们（可能非常困难，因为有很多地方可以定义它们并且它们可能不是最小的标志，因为它们可能是所有标题一起需要的，但不是特定的我用）
2.  谷歌每条错误消息，希望能给出答案（很多错误消息可能很难，谷歌可能不知道答案，或者我可能不知道找到答案的正确关键字）
3.  也许以某种方式将外部库的构建脚本“包含”到我自己的项目中（可能非常困难，因为我可能想使用不同的构建系统，而且我可能必须自己完全理解构建系统，这可能很难对于更大的图书馆）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:32:08.383

任何表现良好的开源库都附带有关如何使用其开发文件的说明。在 GNU/Linux 系统上，通常将[pkg-config](http://pkg-config.freedesktop.org)文件 (*.pc) 一起安装到开发头文件和库中，在这种情况下，`pkg-config --cflags library-name`将说明所需的编译选项。

可以在哪里`pkg-config`使用，只需告诉构建系统您要导入哪些组件即可。例如在自动工具上。

```
PKG_CHECK_MODULES([DEPS], [libname]) 
```

然后在 .am 文件上使用`DEPS_CFLAGS`和变量。`DEPS_LIBS`

例如在 shell 命令行上：

```
$ gcc $(pkg-config --cflags libname) -c main.c
$ gcc $(pkg-config --libs libname) main.o -o test.exe 
```

无论如何，如果您可以发布有关所使用库的特定信息以及正在生成的错误，它会更有效率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:39:33.450

对于头文件，很少有关于编译器标志的错误，或者很容易在该头文件中解决它（例如使用#ifdef..#endif 或尝试使用more wel 重写部分代码已知模式）。

但更可能的错误是这样的：您直接包含标头，但该标头依赖于其他标头（可能来自系统或来自同一库）并且您忘记在主包含文件之前包含它们。（实际上这是忘记让他们的头文件独立的程序员，他们只是忘记在主包含文件中以正确的顺序包含他们文件的所有必需头文件）。

因此，为了测试此标准，请查看库的源代码（您说它已正确编译）。查看主要包含文件之前包含的内容，您可能会发现您的包含文件依赖于包含在它之前的包含文件。

例如，在 MSVC 和 GCC 中，您都可以使用预编译头文件，并且预编译头文件中的任何包含都将自动包含在包含它的所有源文件中，因此，如果您忘记在公共头文件之一中添加某些内容并将其包含在预编译头文件中标头您的代码将被正确编译，但如果有人包含您的公共标头会出错。

或者如果您`private_header_1.h`在公共标头中定义并使用它，然后在源文件中使用它（例如`impl.cpp`你说：#include "private_header_1.h" #include "public_header.h" 再次你的代码将被正确编译，但包含`public_header.h`在另一个代码中会引发错误

# ios - iOS 的 SQLite 事务语法

> ID：12133355
> 
> 赞同：2
> 
> 时间：2012-08-26T19:49:46.857
> 
> 标签：ios, sqlite, syntax, transactions, sql-update

我想遍历一个对象数组并根据 ID 更新 SQLite 数据库中的相应行。我想在一笔交易中做到这一点。我知道我可以使用：

```
sqlite3_exec(db, "BEGIN", 0, 0, 0);
sqlite3_exec(db, "COMMIT", 0, 0, 0); 
```

但是，我不确定如何在事务中编写更新语句。我需要将不同的变量绑定到语句。现在代码如下所示：

```
-(void)someUpdateMethod
{
    sqlite3 *db;

    //Establish connection to db
    if (sqlite3_open([[self dbFilePath] UTF8String], &db) == SQLITE_OK)
    {
        const char *query = "UPDATE Table SET Value1 = ?, Value2 = ?";

        sqlite3_stmt *compiledStatement = nil;

        sqlite3_exec(db, "BEGIN EXCLUSIVE TRANSACTION", 0, 0, 0);
        for (someObject *obj in uArray)
        {
            // Repeated statement - This is what I'm not sure of...
            if(sqlite3_prepare(db, query, -1, &compiledStatement, NULL) == SQLITE_OK)
            {
                sqlite3_bind_int(compiledStatement, 1, [obj value1]);
                sqlite3_bind_int(compiledStatement, 2, [obj value2]);
            }
            if (sqlite3_step(compiledStatement) != SQLITE_DONE) NSLog(@"DB not updated. Error: %s",sqlite3_errmsg(db));
            if (sqlite3_finalize(compiledStatement) != SQLITE_OK) NSLog(@"SQL Error: %s",sqlite3_errmsg(db));
        }
        if (sqlite3_exec(db, "COMMIT TRANSACTION", 0, 0, 0) != SQLITE_OK) NSLog(@"SQL Error: %s",sqlite3_errmsg(db));
        sqlite3_close(db);
    }
    else
    NSLog(@"sql-error: %s", sqlite3_errmsg(db));
} 
```

无论 Begin 和 Commit 语句如何，每次更新都会访问数据库。我很确定这是因为 step 语句，但如果我删除它，更新就不会发生。我希望一次编写所有更新。是否可以使用 sqlite3_exec 并且仍然为数组中的每个对象绑定变量？还是我应该以不同的方式准备声明？任何交易内部应该是什么样子的例子都会对我有很大的帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-27T01:59:57.813

你的方法会如你所愿；即使 sqlite 正在访问磁盘，在您提交之前，其他事务也看不到更新。因此，从这个意义上说，它们是“一次全部编写的”。

如果将 prepare 移到循环之外，您的代码可能会更有效率。如果这样做，请`sqlite3_reset`在循环内部和循环`sqlite3_finalize`之后使用。

```
 sqlite3_exec(db, "BEGIN EXCLUSIVE TRANSACTION", 0, 0, 0);
  if(sqlite3_prepare(db, query, -1, &compiledStatement, NULL) == SQLITE_OK)
  {
    for (someObject *obj in uArray)
    {
        sqlite3_bind_int(compiledStatement, 1, [obj value1]);
        sqlite3_bind_int(compiledStatement, 2, [obj value2]);
        if (sqlite3_step(compiledStatement) != SQLITE_DONE) NSLog(@"DB not updated. Error: %s",sqlite3_errmsg(db));
        if (sqlite3_reset(compiledStatement) != SQLITE_OK) NSLog(@"SQL Error: %s",sqlite3_errmsg(db));
    }
  }
  if (sqlite3_finalize(compiledStatement) != SQLITE_OK) NSLog(@"SQL Error: %s",sqlite3_errmsg(db));
  if (sqlite3_exec(db, "COMMIT TRANSACTION", 0, 0, 0) != SQLITE_OK) NSLog(@"SQL Error: %s",sqlite3_errmsg(db));
  sqlite3_close(db); 
```

# android - 意图服务启动新意图失败：未找到

> ID：12133356
> 
> 赞同：0
> 
> 时间：2012-08-26T19:49:51.537
> 
> 标签：android, android-intent, android-manifest, intentservice

我正在尝试在 intentservice 中下载 json 文件，下载完成后，我希望开始一个新活动。此活动有两个任务： - 显示带有两个选项的 alertDialog：重启/不 - 在 onsharedpreferences 中保存更新的时间戳

但我一直有一个错误：

```
08-26 21:31:06.162: W/ActivityManager(96): Unable to start service Intent { cmp=com.hera.ontdekdelft.RESTARTACTIVITY }: not found 
```

当然，我做了很多研究，发现很多人都有这个问题。我想我尝试了大多数给定的解决方案，但似乎没有一个对我有用。

*   我检查了我的清单，我的服务是在应用程序中声明的，而不是在活动中。
*   我尝试以不同的方式调用我的意图：完整路径（`com.hera.ontdekdelft.RESTARTACTIVITY`等），如下所示：`Intent restartIntent=new Intent(DownloadService.this, RestartActivity.class);`

还有一些事情，不起作用或只会使情况变得更糟。现在发生的情况是我没有弹出窗口，因此在下次重新启动后使用新数据（仅不保存时间戳，我需要检查可用更新）。没有崩溃，但没有真正工作。

任何人都知道这个问题/看到我失败的地方/有解决方案吗？谢谢！

我的服务：

```
> import java.io.File; import java.io.FileOutputStream; import
> java.io.IOException; import java.io.InputStream; import
> java.io.InputStreamReader; import java.net.URL;
> 
> import android.app.Activity; import android.app.IntentService; import
> android.content.Intent; import android.net.Uri; import
> android.os.Environment;
> 
> public class DownloadService extends IntentService {
> 
>   private int result = Activity.RESULT_CANCELED;   public String
> strfilename="DelftVenues";   public String foldername;
> 
>   public DownloadService() {
>     super("DownloadService");   }
> 
> 
>   @Override   protected void onHandleIntent(Intent intent) {    File
> dir = new File(Environment.getExternalStorageDirectory() +
> "/testOntdekDelftMap");
>       foldername = dir.toString();
>     
>     
>     
>     
>     Uri data = intent.getData();
>     String urlPath = intent.getStringExtra("urlpath");
>     String fileName = data.getLastPathSegment();
>     File output = new File(foldername,fileName);
>     if (output.exists()) {
>       output.delete();
>     }
> 
>     InputStream stream = null;
>     FileOutputStream fos = null;
>     try {
>         File filename = new File(foldername, strfilename);
>       URL url = new URL(urlPath);
>       stream = url.openConnection().getInputStream();
>       InputStreamReader reader = new InputStreamReader(stream);
>       fos = new FileOutputStream(filename);
>       int next = -1;
>       while ((next = reader.read()) != -1) {
>         fos.write(next);
>       }
>       // Sucessful finished
>       result = Activity.RESULT_OK;
> 
>     } catch (Exception e) {
>       e.printStackTrace();
>     } finally {
>       if (stream != null) {
>         try {
>           stream.close();
>         } catch (IOException e) {
>           e.printStackTrace();
>         }
>       }
>       if (fos != null) {
>         try {
>           fos.close();
>         } catch (IOException e) {
>           e.printStackTrace();
>         }
>       }
>     }
>     
>     System.out.println("result: "+ result);
>     Intent restartIntent=new Intent(DownloadService.this, RestartActivity.class);
>     this.startService(restartIntent);
>     
>     
>        } } 
```

我想开始的课程（restartActivity）

```
public class RestartActivity extends Activity{

     public String UPDATE_TIMESTAMP;
     AlertDialog restartDialog;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // XXX Auto-generated method stub
        super.onCreate(savedInstanceState);

        restartDialog= new AlertDialog.Builder(RestartActivity.this).create();  
        String title, text, button1,button2;
        String language =  Locale.getDefault().getISO3Language();
        if (language.equals("nld")){
            title= "Herstarten?";
            text= "De update is voltooid. Wilt u de applicatie nu opnieuw opstarten?";
            button1="Ja";
            button2="Nee";
        }else{
            title="Restart?";
            text= "The application has been updated. Do you wish to restart now?";
            button1="Yes";
            button2="No";
        }
        restartDialog.setTitle(title);  
        restartDialog.setMessage(text);  
        restartDialog.setButton(button1, new DialogInterface.OnClickListener() {  
          public void onClick(DialogInterface dialog, int which) {  
          // restart applicatino
                Intent intent = new Intent(RestartActivity.this, StartUp.class);
                // Create a new Messenger for the communication back
                startService(intent);
            }
        });
        restartDialog.setButton2(button2, new DialogInterface.OnClickListener() {  
              public void onClick(DialogInterface dialog, int which) {  
                   finish();
                  return;

              }
            });
        restartDialog.show();

        int timestampNow=(int) (System.currentTimeMillis()/1000);
        setLastUpdateTimeStamp(timestampNow);

    }

    // timestamp opslaan
    public void setLastUpdateTimeStamp(int timestamp){
         SharedPreferences savedTimeStamp = getSharedPreferences(UPDATE_TIMESTAMP, MODE_PRIVATE);
          SharedPreferences.Editor editor = savedTimeStamp.edit();
          editor.putInt("timestamp", timestamp);

          // Commit the edits!
          editor.commit();

    }

} 
```

我的一份清单：

```
// lot more activities

             <activity
    android:name=".RestartActivity"
    android:label="@string/app_name" >
    <intent-filter>
        <action android:name="com.hera.ontdekdelft.RESTARTACTIVITY" />
        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
</activity>

 <service android:name=".DownloadService" >
        </service>

    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:07:49.763

有了这个：

```
Intent restartIntent=new Intent(DownloadService.this, RestartActivity.class);
this.startService(restartIntent); 
```

您实际上是在说“将 RestartActivity 作为服务启动”。这不是你想要的。这解释了错误“**服务**意图...未找到”。

编辑：有关如何从服务启动活动的信息，请参阅此[问题。](https://stackoverflow.com/questions/3606596/android-start-activity-from-service)你会在`button1`回调中遇到类似的东西。你可以`startActivity(intent)`在那里使用。

还有一些偏离主题的提示：考虑给您的 ui 项目（即按钮）一个合理的名称，为什么不使用 strings.xml 的强大功能和 Android 的内置本地化？

# css - 如何将多级菜单添加到 Joomla！我正在制作的模板？

> ID：12133358
> 
> 赞同：0
> 
> 时间：2012-08-26T19:50:22.037
> 
> 标签：css, drop-down-menu, joomla, suckerfish

我创建了 Joomla！以前的模板，但依赖插件和模块来制作下拉式、吸盘式菜单。如何在不依赖插件和扩展的情况下创建一个作为模板的一部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T13:27:26.753

First step. Go into Joomla's module manager, make sure that the menu module is set to display all the levels that you want it to (eg, if you want just two levels down then it's set to "2", if you want it five levels down set it to "5".

Look at the output, copy that source code. If you want to skip a few steps that's your markup.

Style your menu as you would with with a text editor, using jQuery or whatever for animation if you want. Your markup will be pretty important, keep it clean. If you want to change the markup (say, swap out `<h3>` for `<li>` as one jQuery plugin does) then you'll need an [override for your menu](http://docs.joomla.org/How_to_override_the_output_from_the_Joomla!_core).

Your styling should all be in your css file. Just upload that to your server, make sure that it's linked in the head of your template, and it should work.

# javascript - Javascript HTML5 音频 - 在 addEventListner 中为歌曲引用哪个函数？

> ID：12133360
> 
> 赞同：1
> 
> 时间：2012-08-26T19:50:33.980
> 
> 标签：javascript, html5-audio, addeventlistener

```
function media () {
    var div = document.createElement("div");
    div.setAttribute("class", "container");
    foo.appendChild(div);

    var audio = document.createElement("audio");
    audio.setAttribute("controls", "controls");

    var source = document.createElement("source");
    source.setAttribute("src", "media/dimples.ogg");
    source.setAttribute("type", "audio/ogg");
    source.setAttribute("src", "media/dirty_feeling.ogg");
    source.setAttribute("type", "audio/ogg");
    source.setAttribute("src", "media/suzieq.ogg");
    source.setAttribute("type", "audio/ogg");
    source.setAttribute("src", "media/wear_my_ring.ogg");
    source.setAttribute("type", "audio/ogg");
    audio.appendChild(source);

    div.appendChild(audio);

    var ul = document.createElement("ul");
    ul.setAttribute("id", "playlist");

    var li = document.createElement("li");
    var a = document.createElement("a");
    a.setAttribute("href", "#song1");
    var text = document.createTextNode("Dimples");
    a.appendChild(text);
    li.appendChild(a);
    ul.appendChild(li);

    li = document.createElement("li");
    a = document.createElement("a");
    a.setAttribute("href", "#song2");
    text = document.createTextNode("Dirty Feeling");
    a.appendChild(text);
    li.appendChild(a);
    ul.appendChild(li);  

    li = document.createElement("li");
    a = document.createElement("a");
    a.setAttribute("href", "#song3");
    text = document.createTextNode("Suzie Q");
    a.appendChild(text);
    li.appendChild(a);
    ul.appendChild(li);  

    li = document.createElement("li");
    a = document.createElement("a");
    a.setAttribute("href", "#song4");
    text = document.createTextNode("Wear My Ring");
    a.appendChild(text);
    li.appendChild(a);
    ul.appendChild(li); 

    div.appendChild(ul);

    foo.lastChild.scrollIntoView();
    musicColors();
} 
```

这是我第一次尝试创建媒体播放器。它必须在 Javascript 中，我拒绝使用 jquery（请没有 jquery 建议）。

我有两个问题，拜托：1）所有的歌曲链接在一行中融合在一起。为什么这是因为每个 li 都是 ul 的孩子？2) 我打算为歌曲链接创建一个 addEventListner，但我不确定要引用哪个函数来实际播放歌曲？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-30T23:11:08.723

我有一个全局 ul = display: inline 我没有看到。

需要为每首新歌重新分配音频 src。我使用了 javascript Audio 对象，并为每首歌曲重用了该对象。

# android - android中的default.properties文件

> ID：12133361
> 
> 赞同：0
> 
> 时间：2012-08-26T19:50:43.860
> 
> 标签：android, eclipse

我正在开发 android 应用程序，一天后我在 eclipse 上打开了我的项目以继续我的工作，但 default.properties 文件被自动删除。

现在我在控制台上收到此错误。

```
project has no default.properties file! Edit the project properties to set one. 
```

请告诉我如何才能恢复它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:56:18.430

根据问题评论：

*   将`default.properties`文件从另一个项目复制到这个项目。
*   在运行之前清理项目。

# matlab - 使用校准相机从 4 点成像恢复平面

> ID：12133366
> 
> 赞同：1
> 
> 时间：2012-08-26T19:51:41.067
> 
> 标签：matlab, image-processing, computer-vision

我有一个相机和它的 K 矩阵（校准矩阵），我也有平面图像，我知道 4 个角的真实点和它们的对应像素。如果 z=0（H 是图像和真实平面之间的单应矩阵），我知道如何计算 H 矩阵。现在，我尝试使用旋转矩阵和平移向量来获取平面的实点（3D 点），我遵循本文：Calibrating an Overhead Video Camera by Raul Rojas 在第 3 - 3.3 节中。我的代码是：

```
ImagePointsScreen=[16,8,1;505,55,1;505,248,1;44,301,1;];

screenImage=imread( 'screen.jpg');
RealPointsMirror=[0,0,1;9,0,1;9,6,1;0,6,1]; %Mirror
RealPointsScreen=[0,0,1;47.5,0,1;47.5,20,1;0,20,1];%Screen
imagesc(screenImage);
hold on
for i=1:4
    drawBubble(ImagePointsScreen(i,1),ImagePointsScreen(i,2),1,'g',int2str(i),'r')
end

Points3DScreen=Get3DpointSurface(RealPointsScreen,ImagePointsScreen,'Screen');

figure
hold on
plot3(Points3DScreen(:,1),Points3DScreen(:,2),Points3DScreen(:,3));
for i=1:4
    drawBubble(Points3DScreen(i,1),Points3DScreen(i,2),1,'g',int2str(i),'r')
end

function [ Points3D ] = Get3DpointSurface( RealPoints,ImagePoints,name)
M=zeros(8,9);

for i=1:4

M((i*2)-1,1:3)=-RealPoints(i,:);
M((i*2)-1,7:9)=RealPoints(i,:)*ImagePoints(i,1);
M(i*2,4:6)=-RealPoints(i,:);
M(i*2,7:9)=RealPoints(i,:)*ImagePoints(i,2);   

end

[U S V] = svd(M);
X = V(:,end);
H(1,:)=X(1:3,1)';
H(2,:)=X(4:6,1)';
H(3,:)=X(7:9,1)';
K=[680.561906875074,0,360.536967117290;0,682.250270165388,249.568615725655;0,0,1;];

newRO=pinv(K)*H;
h1=newRO(1:3,1);
h2=newRO(1:3,2);

scaleFactor=(norm(h1)+norm(h2))/2;
newRO=newRO./scaleFactor;
r1=newRO(1:3,1);
r2=newRO(1:3,2);
r3=cross(r1,r2);
r3=r3/norm(r3);

R=[r1,r2,r3];

RInv=pinv(R);
O=-RInv*newRO(1:3,3);
M=K*[R,-R*O];
for i=1:4
   res=pinv(M)* [ImagePoints(i,1),ImagePoints(i,2),1]';
   res=res';
   res=res*(1/res(1,4));
   Points3D(i,:)=res';

end
Points3D(i+1,:)=Points3D(1,:);  %just add the first point to the end of the array for draw square

end 
```

我的结果是： ![在此处输入图像描述](../Images/4aa13855addfc2d7237b6d9c89504c6c.png)

现在我有两个问题：

1.点1在（0,0,0），这不是真正的位置

2.点是颠倒的

我在做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T23:06:44.433

单应性通常是平面在两个位置/旋转中的变换。平面的相机坐标中的位置通常称为位姿或外部参数

opencv 有一个[solvePnP()](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#bool%20solvePnP%28InputArray%20objectPoints,%20InputArray%20imagePoints,%20InputArray%20cameraMatrix,%20InputArray%20distCoeffs,%20OutputArray%20rvec,%20OutputArray%20tvec,%20bool%20useExtrinsicGuess,%20int%20flags%29)函数，它使用 Ransac 来估计已知平面的位置。

附言。抱歉，不知道等效的 matlab，但[Bouguet](http://www.vision.caltech.edu/bouguetj/calib_doc/)在他的网站上有一个 openCV 3D 函数的 matlab 版本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:30:15.993

我在论文中找到了答案：Calibrating an Overhead Video Camera by Raul Rojas 在第 3 - 3.3 节中。

开始： H=K^-1*H 给定图像中的四个点和它们在世界上的已知坐标，矩阵 H 可以恢复到一个比例因子 。我们知道旋转矩阵R的前两列一定是变换矩阵的前两列。让我们用 h1、h2 和 h3 表示矩阵 H 的三列。由于缩放因子，我们得到 xr1 = h1 和 xr2 = h2 因为 |r1| = 1，则 x= |h1|/|r1| = |h1| x = |h2|/|r2| = |h2|。因此，我们可以计算该因子并从恢复的矩阵 H 中消除它。我们只需设置 H'= H/x 这样我们就可以恢复旋转矩阵 R 的前两列。可以找到 R 的第三列，记住任何旋转矩阵中的列是其他两列的叉积（乘以适当的正号或负号）。特别是 r3 = r1 × r2 因此，我们可以从 H 中恢复旋转矩阵 R。我们还可以恢复平移向量（相机在场坐标中的位置）。只要记住 h'3 = -R^t 因此相机针孔 t 的位置向量由 t = -R^-1 h3 给出

# sql - INSERT INTO SELECT + 1 个自定义列

> ID：12133368
> 
> 赞同：3
> 
> 时间：2012-08-26T19:51:49.753
> 
> 标签：sql

我需要从原始表中复制数据并添加查询中指定的自定义列

原始表结构：`col1, col2, col3`

插入表结构：`x, col1, col2, col3`

```
INSERT INTO newtable 
   SELECT * 
   FROM original 
   WHERE cond 
```

我收到了这个错误

> *列计数与第 1 行的值计数不匹配*

如何`X`在这个单一查询中插入值？

我坚持这样的事情可以通过

```
INSERT INTO newtable 
   SELECT 'x' = NULL, *  
   FROM original 
   WHERE cond 
```

有任何想法吗？

可以使用`*`吗？因为该表有很多列并且`X`必须是第一个值

我知道这一切都很糟糕，但我必须用更糟糕的 php 代码编辑令人难以置信的丑陋数据库

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T19:54:43.967

第二个语句几乎是正确的，但不是 , 而是`'x' = null`使用`null x`（我假设您想将一个`null`值存储在名为 的列中`x`）；

```
INSERT INTO newtable 
SELECT null x, o.* FROM original o WHERE cond 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T19:53:18.227

```
Select Null as X, *
into newtable
from original
where ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T19:56:43.063

```
INSERT INTO newtable 
SELECT null as x, col1, col2, col3 FROM original WHERE cond 
```

# stack-trace - PLCrashReporter：创建人类可读的堆栈跟踪

> ID：12133371
> 
> 赞同：8
> 
> 时间：2012-08-26T19:52:10.107
> 
> 标签：stack-trace, crash-reports, plcrashreporter

我刚刚下载了编译后的 PLCrashReporter 并将其添加到我的应用程序中。我已经测试过了，它工作正常。项目文档中的[示例代码](http://plcrashreporter.googlecode.com/svn/tags/plcrashreporter-1.1-beta1/Documentation/API/example_usage_iphone.html)工作正常。

现在，我想生成一个堆栈跟踪，以便我可以看到应用程序崩溃的确切位置。如果您在将 iphone 连接到 xcode 时查看 iphone 设备日志，您会得到一些信息： ![来自 iphone 设备日志的示例崩溃报告](../Images/17346a590a7eef087c051ffd81e95730.png)

我该怎么做才能获得使用 PLCrashReporter 生成的如此好的堆栈跟踪？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-04T08:37:04.597

该框架包括一个文本格式化程序`PLCrashReportTextFormatter.h`：

```
NSString *humanReadable = [PLCrashReportTextFormatter stringValueForCrashReport:report withTextFormat:PLCrashReportTextFormatiOS];
NSLog(@"Report: %@", humanReadable); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-11T14:35:43.627

`symbolicatecrash`您需要使用作为 Xcode 一部分的工具来符号化崩溃报告。这需要创建崩溃报告的确切版本的 dSYM 包可用。StackOverflow 上有很多关于如何做到这一点的讨论。

还有 3rd 方服务可以自动为您执行此操作，包括收集崩溃报告并按相似性对其进行分组，还有带有 PHP 服务器部分的开源项目[QuincyKit](http://www.quincykit.net/)，可帮助您从自己的 Mac 收集崩溃报告和自动符号化.

# select - 带有 3 个 WHERE 子句的 MYSQL SELECT

> ID：12133373
> 
> 赞同：0
> 
> 时间：2012-08-26T19:52:21.287
> 
> 标签：select, mysqli, where-clause

我在使用此代码时遇到问题

```
$set = 'mycrazyemail@gmail.com'
$check_is_idk = $db->query("SELECT * FROM `ppl` WHERE `email` = '{$set}' AND `is` = 'idk' AND `belongs` = '{$id}'"); 
```

问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:59:07.160

您在第一行的末尾缺少一个分号，它当前会导致解析错误：

```
$set = 'mycrazyemail@gmail.com';
$check_is_idk = $db->query("SELECT * FROM `ppl` WHERE `email` = '{$set}' AND `is` = 'idk' AND `belongs` = '{$id}'"); 
```

# javascript - 如何从 DOM 元素中获取 Ext JS 组件

> ID：12133377
> 
> 赞同：5
> 
> 时间：2012-08-26T19:53:06.543
> 
> 标签：javascript, extjs4.1

尝试创建内联编辑表单。我有一个看起来像这样的表格：

```
var editPic = "<img src='https://s3.amazonaws.com/bzimages/pencil.png' alt='edit' height='24' width='24' style='margin-left: 10px;'/>";
var submitPic = "<img id='submitPic' src='https://s3.amazonaws.com/bzimages/submitPic.png' alt='edit' height='24' width='24'/>";

Ext.define('BM.view.test.Edit', {
extend: 'Ext.form.Panel',
alias: 'widget.test-edit',

layout: 'anchor',
title: 'Edit Test',
defaultType: 'displayfield',

items: [
    {name: 'id', hidden: true},

    {
        name: 'name',
        fieldLabel: 'Name',
        afterSubTpl: editPic,
        cls: 'editable'
    },
    {
        name: 'nameEdit',
        fieldLabel: 'Name',
        xtype: 'textfield',
        hidden: true,
        cls: 'editMode',
        allowBlank: false,
        afterSubTpl: submitPic
    }
]
}); 
```

控制器看起来像这样（很多事件）：

```
init: function() {
    this.control({
        'test-edit > displayfield': {
            afterrender: this.showEditable
        },
        'test-edit': {
            afterrender: this.formRendered
        },
        'test-edit > field[cls=editMode]': {
            specialkey: this.editField,
            blur: this.outOfFocus
        }
    });
},

outOfFocus: function(field, event) {
    console.log('Lost focus');
    this.revertToDisplayField(field);
},

revertToDisplayField: function(field) {
    field.previousNode().show();
    field.hide();
},

formRendered: function(form) {
    Ext.get('submitPic').on('click', function (event, object) {
        var field = Ext.get(object).parent().parent().parent().parent();
        var cmp = Ext.ComponentQuery.query('test-edit > field[cls=editMode]');
    });
},

editField: function(field, e) {
    var value = field.value;
    if (e.getKey() === e.ENTER) {
        if (!field.allowBlank && Ext.isEmpty(value)){
            console.log('Not permitted!');
        } else {
            var record = Ext.ComponentQuery.query('test-edit')[0].getForm().getRecord();
            Ext.Ajax.request({
                url: '../webapp/tests/update',
                method:'Post',
                params: {
                    id: record.getId(),
                    fieldName: field.name,
                    fieldValue: field.value
                },
                store: record.store,
                success: function(response, t){
                    field.previousNode().setValue(value);
                    t.store.reload();
                    var text = response.responseText;
                    // process server response here
                    console.log('Update successful!');
                }
            });

        }
        this.revertToDisplayField(field);

    } else if (e.getKey() === e.ESC) {
        console.log('gave up');
        this.revertToDisplayField(field);
    }
},

showEditable: function(df) {
    df.getEl().on("click", handleClick, this, df);

    function handleClick(e, t, df){
        e.preventDefault();
        var editable = df.nextNode();
        editable.setValue(df.getValue());
        editable.show();
        editable.focus();
        df.hide();
    }
}, 
```

我正在使用“afterSubTpl”配置添加编辑图标和接受图标。我设置了监听器来监听与它们有关的点击事件，但是在它们被点击后，我只有 Ext.get('submitPic') 创建的元素。现在我想访问 Ext 字段和围绕它的表单。父方法只带回其他 DOM 元素。我如何在它们之间建立联系？您可以在 formRendered 中看到我尝试过的内容。

我希望有人可以为我澄清这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T05:13:01.680

您可以通过 id 获取组件，但前提是您的组件及其 dom 元素具有相同的 id（它们通常会这样做）：

```
Ext.getCmp(yourelement.id) 
```

但这并不是一个好的做法——最好设置您的侦听器，以便处理程序方法已经具有对组件的引用。例如，在您的“submitPic”组件中，您可以像这样定义点击侦听器：

```
var me = this;
me.on({
    click: function(arguments){
         var cmp = me;
         ...

}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-07-10T14:14:30.773

遍历 DOM 树，直到找到元素 id 的组件：

```
 getCmpFromEl = function(el) {
    var body = Ext.getBody();
    var cmp;
    do {
        cmp = Ext.getCmp(el.id);
        el = el.parentNode;
    } while (!cmp && el !== body);
    return cmp;
} 
```

**正如我刚刚了解到的，自 ExtJS 6.5.0 以来，**Ext.Component.from(el)就是这样做的。**[文档](https://docs.sencha.com/extjs/7.0.0/classic/Ext.Component.html#static-method-from) [来源](https://docs.sencha.com/extjs/7.0.0/classic/src/ComponentManager.js.html#Ext.ComponentManager-method-from)**

# jquery - 如何使用 jquery 从 tinyMCE 文本框中获取值？

> ID：12133378
> 
> 赞同：1
> 
> 时间：2012-08-26T19:53:08.257
> 
> 标签：jquery, tinymce

我正在尝试获取使用 tinyMCE（jQuery 版本）的文本框的值，但是当我这样做时，我没有从文本框中获得任何内容。请参阅下面的代码；

```
var content = $( "#content_textarea" ).val();
alert(content); 
```

我也没有使用表单，代码是使用按钮激活的。

我也试过这段代码；

```
var content = tinyMCE.get('content_textarea').getContent();
alert(content); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-15T11:25:20.493

尝试：

```
var editor='content_textarea';
var content =tinyMCE.activeEditor.getContent();
alert(content); 
```

或者，如果你不喜欢这样，你可以这样做：

```
tinyMCE.triggerSave();
var content =$('#content_textarea').val();
alert(content); 
```

两者都为我工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T12:13:52.130

做就是了：

```
tinymce.get("original textarea id").getContent() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:42:32.270

根据此处的文档：

[http://www.tinymce.com/wiki.php/jQuery_Plugin](http://www.tinymce.com/wiki.php/jQuery_Plugin)

你应该使用：

```
// Gets the contents from a specific editor
alert($('#someeditor').html()); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-26T20:36:58.813

我对 ckeditor 也有同样的问题……也许这很有趣。

> CKEDITOR.instances['editor1'].getData();

帮了我....其中 editor1 是实例的名称

# c++ - C++：将 ifstream 与 getline() 一起使用；

> ID：12133379
> 
> 赞同：11
> 
> 时间：2012-08-26T19:53:15.480
> 
> 标签：c++, file-io, fstream, getline

检查这个程序

```
ifstream filein("Hey.txt");
filein.getline(line,99);
cout<<line<<endl;
filein.getline(line,99);
cout<<line<<endl;
filein.close(); 
```

文件 Hey.txt 中有很多字符。远超1000

但我的问题是为什么我第二次尝试打印行。它没有得到打印？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-08-26T19:56:22.327

从流中读取行的惯用方法是：

```
std::ifstream filein("Hey.txt");

for (std::string line; std::getline(filein, line); ) 
{
    std::cout << line << std::endl;
} 
```

笔记：

*   没有`close()`。C++ 在习惯使用时会为您处理资源管理。

*   使用 free `std::getline`，而不是流成员函数。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-26T20:18:46.100

根据 C++ 参考（[此处](http://en.cppreference.com/w/cpp/io/basic_istream/getline)），getline 设置`ios::fail`提取 count-1 个字符的时间。您必须在通话`filein.clear();`之间`getline()`打来电话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-21T18:21:27.307

```
#include<iostream>
using namespace std;
int main() 
{
ifstream in;
string lastLine1;
string lastLine2;
in.open("input.txt");
while(in.good()){
    getline(in,lastLine1);
    getline(in,lastLine2);
}
in.close();
if(lastLine2=="")
    cout<<lastLine1<<endl;
else
    cout<<lastLine2<<endl;
return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T20:22:03.403

正如Kerrek SB 正确所说，有两种可能性：1）第二行是空行2）没有第二行并且所有超过1000 个字符都在一行中，所以第二行`getline`没有什么可获取的。

# android - 开源/免版税的 android 控件的网站

> ID：12133381
> 
> 赞同：3
> 
> 时间：2012-08-26T19:53:48.997
> 
> 标签：android, controls

我正在寻找类似于[适用于 iOS 和 Mac OS X 的自定义 UI 控件的网站](http://www.cocoacontrols.com/)

哪些主机/源一些 amazin iOS 控件，但适用于 android 平台。

我见过几个这样的问题，但几年内都没有发布/更新。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T19:57:51.520

截至撰写本文时，没有直接的等效网站。可重用 Android 组件（包括自定义小部件）的两个较大的链接集合是：

*   [http://www.openintents.org/en/libraries](http://www.openintents.org/en/libraries)
*   [http://www.theultimateandroidlibrary.com/](http://www.theultimateandroidlibrary.com/)

请注意，并非这些网站上的所有内容都必须“开源/免版税”。

# passwords - 来自脚本的根访问

> ID：12133385
> 
> 赞同：0
> 
> 时间：2012-08-26T19:54:30.667
> 
> 标签：passwords

有没有办法在没有用户输入的情况下获得 root 访问权限？

我希望脚本自动查看存储的密码，然后使用该密码进行身份验证。有没有办法在没有用户输入的情况下做到这一点？我试过`man su`and `man sudo`，但这些不支持这一点。这可能吗？

PS：我知道python、sh和bash。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T19:58:29.813

看看这个链接。它解释了如何在 python 中执行此操作。[根访问 Python](http://forums.devshed.com/linux-help-33/run-script-as-root-without-typing-root-password-43815.html)

它的基础是改变脚本本身的权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T19:59:30.327

**选项 1 - 使用 cron**

如果脚本是一个 cron 作业，它可以由 root 的 crontab 启动。然后它会自动以 root 身份运行。不过要非常小心，因为您以 root 身份运行。任何可以更改您的脚本的人都刚刚成为 root。

**选项 2 - 设置新 ID**

如果该任务可以由非 root 用户完成，那么您实际上并不每次都需要 root。

# c# - 事务外键原因：“INSERT 语句与 FOREIGN KEY 约束冲突”

> ID：12133389
> 
> 赞同：1
> 
> 时间：2012-08-26T19:54:49.347
> 
> 标签：c#, sql, sql-server-2008, tsql

执行 SQL Server 事务时如何防止出现以下错误？

我正在尝试将 a`SupplierOrder`和 a添加`VehicleRecord`到一组两个数据库表中。我正在使用以下内容：

### 表 SQL 结构：

```
CREATE TABLE VSI_VehicleRecords
(
    VehicleRecordID INT IDENTITY(1,1) PRIMARY KEY,
    StockNumber INT NOT NULL,
    Status INT NOT NULL,
    Make VARCHAR(50) NOT NULL,
    Model VARCHAR(50) NOT NULL,
    Colour VARCHAR(50) NOT NULL,
    Spefication VARCHAR(255) NOT NULL
)

CREATE TABLE VSI_SupplierOrders
(
    SupplierOrderID INT IDENTITY(1,1) PRIMARY KEY,
    VehicleRecordID INT FOREIGN KEY REFERENCES VSI_VehicleRecords(VehicleRecordID) UNIQUE,
    Timestamp
) 
```

我编写了一个实用方法，它将一组 Sql 查询作为事务运行：

### C# 执行事务：

```
 SqlTransaction _Transaction;
    OpenConnection();

    _Transaction = __Connection.BeginTransaction();

    try
    {
        for (int i = 0; i < Commands.Length; i++)
        {
            Commands[i].Connection = __Connection;
            Commands[i].Transaction = _Transaction;
            Commands[i].ExecuteNonQuery();
        }
        _Transaction.Commit();
        return true;
    }
    catch (SqlException e)
    {
        _Transaction.Rollback();
    } 
```

### 上述函数要执行的SQL命令：

```
 SqlCommand[] _Commands = new SqlCommand[2];

    string _InsertVehicleQuery = "INSERT INTO VSI_VehicleRecords(StockNumber,Status,Make,Model,Colour,Spefication) VALUES (@StockNumber, @Status, @Make, @Model, @Colour, @Specification);";

    SqlCommand _InsertVehicleCommand = new SqlCommand(_InsertVehicleQuery);
    _InsertVehicleCommand.Parameters.AddWithValue("@StockNumber", __StockNumber);
    _InsertVehicleCommand.Parameters.AddWithValue("@Status", __Status);
    _InsertVehicleCommand.Parameters.AddWithValue("@Make", Make);
    _InsertVehicleCommand.Parameters.AddWithValue("@Model", Model);
    _InsertVehicleCommand.Parameters.AddWithValue("@Colour", Colour);
    _InsertVehicleCommand.Parameters.AddWithValue("@Specification", Specification);

    _Commands[0] = _InsertVehicleCommand;

    string _InsertSupplierOrderQuery = "INSERT INTO VSI_SupplierOrders(VehicleRecordID) VALUES (@VehicleRecordID);";
    SqlCommand _InsertSupplierOrderCommand = new SqlCommand(_InsertSupplierOrderQuery);
    _InsertSupplierOrderCommand.Parameters.AddWithValue("@VehicleRecordID", _VehicleRecordID);

    _Commands[1] = _InsertSupplierOrderCommand;

    DataUtility.NonQueryTransaction(_Commands); 
```

但是我收到以下错误：

> *INSERT 语句与 FOREIGN KEY 约束“FK__VSI_Suppl_ *Vehic* _5165187F”冲突。冲突发生在数据库“jack_test”、表“dbo.VSI_VehicleRecords”、列“VehicleRecordID”中。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T19:58:28.163

您需要从第一个查询中获取 VehicleRecordID - 您目前没有将 _VehicleRecordID 设置为任何值

为此，您需要`;SELECT Scope_Identity()`在插入 SQL 之后附加并通过执行命令`ExecuteScalar`

但是，创建一个存储过程可能更容易和更整洁，该存储过程接受两个查询的所有参数并在 SQL Server 上完成工作

例如

```
create proc CreateRecordAndSupplier
(
     @Stocknumber int,
     ... (etc)
)
as
begin
declare @VR int
      INSERT INTO VSI_VehicleRecords(StockNumber,Status,Make,Model,Colour,Spefication) 
      VALUES (@StockNumber, @Status, @Make, @Model, @Colour, @Specification);

      select @VR = Scope_Identity();

      INSERT INTO VSI_SupplierOrders(VehicleRecordID) VALUES (@VR) 
end 
```

# c++ - boost::enable_if MSVC

> ID：12133390
> 
> 赞同：0
> 
> 时间：2012-08-26T19:54:50.597
> 
> 标签：c++, boost, visual-studio-2012, boost-mpl, enable-if

我有代码，可以按预期编译和运行，`gcc`但不能编译`MSVC 2012 RC`，我无法解释原因，所以它是错误`MSVC`，或者我的代码不正确？

```
#include <boost/mpl/vector.hpp>
#include <boost/mpl/front.hpp>
#include <boost/mpl/is_sequence.hpp>
#include <boost/mpl/size.hpp>
#include <boost/utility/enable_if.hpp>
#include <vector>
#include <iostream>

namespace mpl = boost::mpl;

template<typename T,
typename = void>
struct Some
{
   typedef std::vector<T> type;
};

template<typename T>
struct Some<T, typename boost::enable_if_c<mpl::is_sequence<T>::type::value>::type> :
    public Some<typename mpl::front<T>::type>::type
{
};

int main()
{
   typedef mpl::vector<int, double> vect_t;
   typedef Some<vect_t> vector;
   vector vect;
   vect.push_back(1);
   std::cout << "int: " << vect.at(0) << std::endl;
} 
```

[http://liveworkspace.org/code/45d78872a2c7f30192277a81c655b471](http://liveworkspace.org/code/45d78872a2c7f30192277a81c655b471)

MSVC 说，`push_back`并且`at`不是`Some<vect_t>`.

**编辑。**

它看起来像 MSVC 2012 中的错误，因为

```
#include <boost/mpl/vector.hpp>
#include <boost/mpl/front.hpp>
#include <boost/mpl/is_sequence.hpp>
#include <boost/mpl/size.hpp>
#include <boost/utility/enable_if.hpp>
#include <vector>
#include <iostream>

namespace mpl = boost::mpl;

template<typename T, typename = void>
struct Some
{
    typedef std::vector<T> type;
};

template<typename T>
struct Some<T, typename boost::enable_if_c<mpl::is_sequence<T>::type::value>::type> :
    public std::vector<int>
{
};

int main()
{
   typedef mpl::vector<int, double> vect_t;
   typedef Some<vect_t>::type vector;
   vector vect;
   vect.push_back(1);
   std::cout << "int: " << vect.at(0) << std::endl;
} 
```

给出错误，我不能`push_back` `int`进入`std::vector<boost::mpl::vector<int, double> >`，所以它选择一般情况，而不是专业化......

**编辑。**

奇怪......但这按预期工作

```
template<typename T>
struct Some<T, typename std::enable_if<boost::mpl::is_sequence<T>::value>::type> :
    public std::vector<int>
{
}; 
```

所以，我无法解释为什么，但 MSVC 2012 不能与 enable_if 中的嵌套表达式一起使用（或者可能在模板参数中）。

```
template<typename T>
struct is_int : public std::integral_constant<bool, false>
{
};

template<>
struct is_int<int> : public std::integral_constant<bool , true>
{
};

template<typename T, typename = void>
struct Some
{
    typedef void type;
};

template<typename T>
struct Some<T, typename std::enable_if<is_int<T>::type::value>::type>
{
    static_assert(is_int<int>::type::value, "asserted");
    typedef T type;
};

int main()
{
    static_assert(is_int<T>::type::value, "ass");
    Some<int>::type t = 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:15:53.017

我在 MSVC 2010 中成功编译并运行了您的代码，所以这可能是 MSVC 2012 的 RC 版本中的一个错误。所以在 MSVC 2012 最终版中尝试它或等待 MSVC 2012 Express。

# c - 如何检测正在写入堆栈地址的线程？

> ID：12133393
> 
> 赞同：0
> 
> 时间：2012-08-26T19:55:15.843
> 
> 标签：c, linux, assembly, gdb

我看到传递给函数的变量的值在从函数返回后变为空。变量被推入堆栈，并在返回时弹出。我们有办法找到罪魁祸首吗？我可以保护那个堆栈位置吗？我确实检查了组件并且没有看到任何可能改变堆栈的 rbp 偏移量？

```
push   %rbp
mov    %rsp,%rbp
push   %rbx

.....................

add    $0x8,%rsp
pop    %rbx
leaveq 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T05:09:23.910

只需正常调试程序即可。你试图让事情变得比他们需要的更难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:02:42.313

我认为操作系统应该保护您的进程免受任何其他进程弄乱它的内存。您确定您的程序中没有内存损坏吗？你有多个线程吗？与另一个流氓进程相比，这些更可能是罪魁祸首。

# objective-c - 跨一对一关系的核心数据获取请求谓词过滤

> ID：12133396
> 
> 赞同：0
> 
> 时间：2012-08-26T19:55:48.727
> 
> 标签：objective-c, ios, core-data

我有以下模型图：

```
 +-----------+     +-----------+
                  | Container |     |   Group   |
                  +-----------+     +-----------+
                  |  groups   |<-->>| container |
                  +-----------+     +-----------+
                        ^                 ^
                        |                 |
+-----------+     +-----------+     +-----------+     +---------+
|   Owner   |     |  ToyBox   |     |  ToyType  |     |  Item   |
+-----------+     +-----------+     +-----------+     +---------+
|  toyBox   |<--->|   owner   |     |   items   |<-->>| toyType |
+-----------+     +-----------+     +-----------+     +---------+ 
```

在 UITableView 中，我要显示一个项目列表。在这种情况下，我只想显示属于特定所有者的项目。为此，我将使用 NSFetchedResultsController 来显示项目。这意味着我需要创建一个带有适当 NSPredicate 的 NSFetchRequest 以提供给 NSFetchedResultsController。

由于父实体，尝试使用 keypath 谓词会导致异常。这似乎是 Apple 的错误或不支持的决定。雷达已归档。此外，我不希望展平实体。

所以这让我尝试使用 SUBQUERY() 执行此操作，如下所示：

```
NSFetchRequest *itemsFetchRequest = [[NSFetchRequest alloc] initWithEntityName:@"Item"];
NSPredicate *itemsPredicate = [NSPredicate predicateWithFormat:@"SUBQUERY(toyItem, $g, SUBQUERY($g.container, $c, SUBQUERY($c.owner, $o, $o = %@).@count > 0).@count > 0).@count > 0", ownerObject]; 
```

这会导致以下异常：

```
Can't have a non-relationship collection element in a subquerySUBQUERY($c.owner, $o, $o == <MLMOOwner: ... 
```

我意识到，因为 Owner 和 ToyBox 之间的关系是一对一的，所以没有返回集合，这就是问题所在。所以我的问题是：

1）有没有办法强制返回子查询中的一对一关系的集合？
2）如果没有，还有另一种方法可以为获取请求创建这个谓词吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:05:47.280

似乎做你想做的事情应该简单得多。如果您想要拥有给定所有者的所有项目，请从所有者开始并使用密钥路径来获取关联的项目。你不需要谓词。如果你有 10 罐花生，你想取回罐子 2 中的花生，你不会从所有花生的集合开始，然后根据它们的罐子过滤它们，对吗？您首先得到 jar 2，然后查看其中包含的花生。所以这样做：

```
NSSet *groups = [ownerObject valueForKeyPath:@"toyBox.groups"]; 
```

这为您提供了 . 拥有的所有组`ownerObject`。您不能只使用单个键路径获取所有项目，因为`Group`实体没有`items`属性。`Group`您可以通过提供访问器让自己的生活更轻松`items`，即使它只返回一个空集。那会让你这样做：

```
NSSet *items = [ownerObject valueForKeyPath:@"toyBox.groups.items"]; 
```

如果您不想向 中添加`items`属性`Group`，则必须`groups`从第一个示例中过滤集合以仅挑选出那些是 ToyType 对象的对象。然后，您可以使用该`@"items"`集合上的密钥路径来获取您想要的项目列表。

你必须对实体继承有点小心。您刚刚看到了它如何使获取变得更加复杂。它还对数据的存储方式有影响，即[子实体的所有实例都存储在同一个表中](http://chanson.livejournal.com/149812.html)。因此，如果您有十几个派生自`Group`（例如`ToyType`）的实体，则所有这些实体的所有实例都存储在一起。

# jquery - 带有 jcarousel 的动态轮播

> ID：12133400
> 
> 赞同：0
> 
> 时间：2012-08-26T19:56:23.293
> 
> 标签：jquery, jcarousel

我已经在这里摸索了好几个小时，尝试使用带有动态生成内容的 jcarousel，这意味着，我得到了一个初始轮播，比如说，里面有 3 个项目，然后将另一个项目添加到轮播中。

我这样做基本上是这样的：

```
$('.actorslider .slides').jcarousel('add', index, html); 
```

问题是，索引是动态的，当用户在初始轮播上单击“下一步”时，我不知道我应该使用的下一个索引是什么，而当我尝试计算元素或增加最后一个元素时，轮播只会加倍。

[你可以在这里](http://www.haimshraga.co.il/?page_id=18)看到我的意思

按下图像下方的按钮一次，然后混乱开始。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T14:14:51.730

我敢肯定有一种更简洁的方法可以实现您的目标，但是与此同时，您始终可以创建一个全局索引变量，例如

```
var $i; 
```

并在每次动态加载幻灯片时增加它。

```
$i++; 
```

如果您删除所有幻灯片，请重置您的计数器。

```
$i=0; 
```

# c# - C# tabControl DrawFixed

> ID：12133401
> 
> 赞同：1
> 
> 时间：2012-08-26T19:56:28.367
> 
> 标签：c#, winforms, .net-3.5, tabs, tabcontrol

我正在使用 TabControl，并且我有 DrawFixed。我只想绘制标签而不是它下面的面板。

![选项卡控制面板](../Images/e3fdf17cd26a91afb64612fb0e455306.png)

我怎样才能删除它？

另外我想问一下，我可以更改标签大小吗？我有很长的文本，如果它被选中，我希望看到全部，但如果它不活跃，我希望看到它被裁剪。

我在绘图事件中关注，但它总是以相同的大小绘制选项卡。

```
if (e.State == DrawItemState.Selected)
{
    e.Graphics.FillRectangle(Brushes.White, e.Bounds.Left, e.Bounds.Top, e.Bounds.Width, e.Bounds.Height);
}
else
{
    e.Graphics.FillRectangle(Brushes.LightGray, e.Bounds.Left, e.Bounds.Top, e.Bounds.Width, e.Bounds.Height);
    text = text.Length > 10 ? text.Substring(0, 10) + "..." : text;
}

e.Graphics.DrawString(text, e.Font, Brushes.Black, e.Bounds.Left + 17, e.Bounds.Top + 3); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T23:15:42.307

在您的问题中按时间顺序排列，您已经问过如何摆脱顶部的那个栏。如果您坚持使用选项卡仅控制固定控件集的内容的“人造”选项卡页，那么将选项卡控件的高度缩小到不可见的点可能是一个可以接受的解决方案。我刚刚尝试过，经过一些调整，它看起来主要是我认为你所追求的。作为记录，我建议按预期实际使用选项卡页，即作为控件的主机，即使您制作了一个自定义控件，将所有您希望可见的控件汇集在一起​​。这将更适合标签范式。

对于第二点，您想调整选项卡的大小。不可能的。该框架为`DrawStyle`、 Normal 和`OwnerDrawFixed`. `Normal`允许 Windows 根据文本和字体设置选项卡大小，这`OwnerDrawFixed`意味着选项卡大小是完全固定的。对此没有更多的控制权。`OwnerDrawFixed`但是，您可以访问要`OnDrawItem`用于绘制选项卡本身的事件。

现在看来您已经咬紧牙关并将 UserPaint 设置为 True，这意味着您现在正在完成所有绘图。我建议此时设置`DrawStyle`回`Normal`，然后您可以混合一些幕后文本以让 Windows 自动控制选项卡宽度。我会警告这不会很健壮，因为每个人都有不同的字体设置和几个像素，并且什么都不会正确绘制。

所以在这里我要指出`TabControl.GetTabRect(index As Integer)`，你可以用来获取给定选项卡的边界矩形的方法。我在所有选项卡索引的循环中使用它，然后在每个选项卡提供的矩形内为选项卡执行我需要的所有绘图。这意味着我不需要使用`OwnerDrawFixed`来获得在其中绘制的边界。

然而，如果你想要更好的控制，你有 80% 的方法来实现你想要看到的任何控制，从`Control`或开始`UserControl`。类似的外观可以通过重叠按钮实现，并带有一些逻辑来绘制和布局它们。然后你也可以获得你想要的所有文本外观。我自己也考虑过，但没有因为我还在主持`TabPages`。既然你摆脱了它，那就更容易了......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T06:10:25.093

只需使用页面文本默认属性，它会根据文本的大小为您自动修复标签大小..然后自己绘制文本..如果您仍然需要额外的空间来绘制图像或其他东西，那么使用填充，这是选项卡控件的属性不是选项卡页。我希望它对你有帮助。

# javascript - 创建 XMLHttpRequest 的旧代码仍然有效吗？

> ID：12133402
> 
> 赞同：3
> 
> 时间：2012-08-26T19:56:35.830
> 
> 标签：javascript, xmlhttprequest

多年来，我使用相同的代码片段来创建`XMLHttpRequest`对象：

```
var tReq = (function () {
    var tAn;
    if (window.XMLHttpRequest) {
        tAn = new XMLHttpRequest();
    } else if (window.ActiveXObject) try {
        tAn = new ActiveXObject("MSXML2.XMLHTTP");
    } catch (ex) {
        tAn = new ActiveXObject("Microsoft.XMLHTTP");
    }
    return tAn;
}()); 
```

我使用该代码已经很长时间了，以至于我不知道它是否仍然是最新的。

这段代码是否仍然`XMLHttpRequest`在每个浏览器中创建或者现在有更有效的解决方案（***不***要求 jQuery）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T20:20:56.820

我记得大约四五年前使用过这个代码吗？当这项技术刚被开发出来并且仍在争论中（有人记得*不要禁用后退按钮的*说法吗？），它仍然得到了一些零散的支持。这将在 Firefox 1/2 左右。如果我记得，这起源于一个 MS Outlook 库，用于使 Outlook 客户端响应更快，最终该技术渗透到浏览器中。

话虽如此，最后两行是遗留的；所有现代浏览器都支持并且确实支持 plain `XMLHttpRequest`，最后两个无论如何仅适用于 IE。以后可能会缩短到`HTTP`or `AsyncRequest`or什么的，但事实是，除非你需要支持IE6，否则你真的只需要第一行。

以机智：

> 要支持 Internet Explorer 7 之前的 Windows Internet Explorer 版本，请使用以下函数获取 XMLHttpRequest 对象。

```
function getXMLHttpRequest()  {
    if (window.XMLHttpRequest) {
        return new window.XMLHttpRequest;
    }
    else {
        try {
            return new ActiveXObject("MSXML2.XMLHTTP.3.0");
        }
        catch(ex) {
            return null;
        }
    }
} 
```

[http://msdn.microsoft.com/en-us/library/ie/ms535874%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/ms535874%28v=vs.85%29.aspx)

所以，你真的不再需要它了。正如 Truth 所说，随着时间的推移，像 jQuery、Angular 和它们的同类库将把它纳入背景。但是直接访问它也不是问题。

还值得链接到[MSDN 的 About Native XMLHTTP](http://msdn.microsoft.com/en-us/library/ms537505%28v=vs.85%29.aspx)，由 RobW 在问题下的评论提供。其要点是组策略或个别 IE 策略可能会禁用 native `XMLHttpRequest`，因此启用它作为一种解决方法*可能*仍然有用`ActiveX`，尽管（至少在这一点上）禁用它似乎有点蜡笔锡纸，同时*允许*更多“有问题的”`ActiveX`子系统。对此的一个*可能*解释是带宽、并发连接或其他一些网络级别的问题。奇怪的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:15:02.603

实际上（我不敢相信我会这么说），jQuery 可能不是一个糟糕的解决方案。

事实上，jQuery 是为了解决浏览器异常而发明的，它是一种大规模适配器模式的形式。

从这个意义上说，jQuery 的`.ajax()`方法及其别名非常适合这项工作。

至于您目前拥有的解决方案，对我来说它看起来不错。应该适用于超过 IE7（包括）的所有浏览器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:25:23.950

你的方法没有错。如果有帮助，我会这样做。

```
var tReq = (function(window) {
    var a = window,
        b = a.XMLHttpRequest,
        c = a.ActiveXObject,

        if (!b && c) {
            try {
                return new c("MSXML2.XMLHTTP");
            } catch (e) {
                return new c("Microsoft.XMLHTTP");
            }
        }
        return new b();
})(this);​ 
```

# android - 实现 SectionIndexer 的 BaseExpandableListAdapter 中的 IndexOutOfBoundsException

> ID：12133404
> 
> 赞同：0
> 
> 时间：2012-08-26T19:56:42.640
> 
> 标签：android, expandablelistview

我创建了一个按字母顺序排列的适配器，灵感来自[这篇文章](https://stackoverflow.com/questions/7129069/how-to-show-alphabetical-letters-on-side-of-android-listview)，添加了标题和可扩展列表视图。我列表中的每一组都只有一个孩子。

有时，出于我不明白的原因，Android 使用 getPositionForSection 方法给我一个 IndexOutOfBoundsException。调用的部分超出了我的部分字符串数组的范围。我认为这是因为可扩展列表，但我不确定。你能帮助我吗 ？

```
public class AlphabeticalAdapter extends BaseExpandableListAdapter implements SectionIndexer{

private HashMap<String, Integer> alphaIndexer;
private String[] sections;
private HashMap<String, String> dictionnary;
private ArrayList<String> words;
private LayoutInflater inflater;

public AlphabeticalAdapter(Context context, HashMap<String, String> dictionnary){

    this.inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    this.dictionnary = dictionnary;
    this.words = new ArrayList<String>(this.dictionnary.keySet());
    Collections.sort(this.words, String.CASE_INSENSITIVE_ORDER);

    this.alphaIndexer = new HashMap<String, Integer>();
    for (int i = 0; i < this.words.size(); i++){
        String s = this.words.get(i).substring(0, 1).toUpperCase();
        if (!this.alphaIndexer.containsKey(s)){
            this.alphaIndexer.put(s, i);
        }
    }

    Set<String> sectionLetters = this.alphaIndexer.keySet();
    ArrayList<String> sectionList = new ArrayList<String>(sectionLetters);
    Collections.sort(sectionList);

    this.sections = new String[sectionList.size()];
    for (int i = 0; i < sectionList.size(); i++){
        this.sections[i] = sectionList.get(i);
    }

}

@Override
public int getSectionForPosition(int position){

    String currentFirstChar = this.words.get(position).substring(0, 1).toUpperCase();
    for (int section = 0; section < this.sections.length; section++){
        if (this.sections[section].equals(currentFirstChar)){
            return section;
        }
    }

    return 1;

}

@Override
public int getPositionForSection(int section){
    return this.alphaIndexer.get(this.sections[section]);   
}

@Override
public Object[] getSections(){
    return this.sections;
}

@Override
public Object getGroup(int groupPosition) {
    return this.words.get(groupPosition);
}

@Override
public Object getChild(int groupPosition, int childPosition) {
    return this.dictionnary.get(getGroup(groupPosition));
}

@Override
public int getGroupCount() {
    return this.dictionnary.size();
}

@Override
public int getChildrenCount(int groupPosition) {
    return 1;
}

@Override
public long getGroupId(int groupPosition) {
    return groupPosition;
}

@Override
public long getChildId(int groupPosition, int childPosition) {
    return childPosition;
}

@Override
public View getGroupView(int groupPosition, boolean isExpanded,
        View convertView, ViewGroup parent) {

    View view = (View) inflater.inflate(R.layout.glossary_word_row, null);

    TextView header = (TextView) view.findViewById(R.id.section);
    TextView rowText = (TextView) view.findViewById(R.id.textView);

    String currentWord = this.words.get(groupPosition);
    String currentFirstChar = currentWord.substring(0, 1).toUpperCase();

    rowText.setText(currentWord);

    if (groupPosition == this.alphaIndexer.get(currentFirstChar)){
        header.setVisibility(View.VISIBLE);
        header.setText(currentFirstChar);
    }

    return view;

}

@Override
public View getChildView(int groupPosition, int childPosition,
        boolean isLastChild, View convertView, ViewGroup parent) {

    View view = (View) this.inflater.inflate(R.layout.glossary_word_row, null);
    TextView rowText = (TextView) view.findViewById(R.id.textView);
    rowText.setText(this.dictionnary.get(this.words.get(groupPosition)));

    return view;

}

@Override
public boolean hasStableIds() {
    return false;
}

@Override
public boolean isChildSelectable(int groupPosition, int childPosition) {
    return false;
}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T18:40:51.500

我不明白为什么用错误的参数调用这个方法，但我在[官方的 Android 文档](http://developer.android.com/reference/android/widget/SectionIndexer.html)中看到了这个：

> 返回：该部分的起始位置。如果该部分超出范围，则必须裁剪该位置以落在列表的大小范围内。

所以我写了这个：

```
@Override
public int getPositionForSection(int section){
    if (section >= this.sections.length){
        return getGroupCount() - 1;
    }
    return this.alphaIndexer.get(this.sections[section]);   
} 
```

一切运行良好。问题解决了 ：-）

# android - Android TextView 中的 Unicode 显示

> ID：12133406
> 
> 赞同：0
> 
> 时间：2012-08-26T19:57:02.960
> 
> 标签：android, unicode

使用带有适当 TTF 文件的字体可以在 Android 中显示 Unicode 字符。怎么才能得到TTF文件对应的字符的映射呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:20:24.947

ttf 文件需要包含这些字符。您应该能够在例如 strings.xml 中使用任何 unicode。如果字符没有出现，则字体不支持该字符。

# mongodb - 极高的 QPS - DynamoDB 与 MongoDB 与其他 noSQL？

> ID：12133408
> 
> 赞同：10
> 
> 时间：2012-08-26T19:57:28.820
> 
> 标签：mongodb, nosql

我们正在构建一个系统，从第一天起就需要处理大量的小请求。“负载”是指每秒约 5,000 个查询。对于每个查询，我们需要从 noSQL 数据库中检索约 20 条记录。将有两次批量读取 - 首先是 3-4 条记录，然后立即读取 16-17 条记录（基于第一次读取的结果）。那将是每秒读取约 100,000 个对象。

到目前为止，我们一直在考虑为此使用 DynamoDB，因为它非常容易上手。

存储不是我担心的事情，因为这些物体非常小。我担心的是阅读成本。DynamoDB 每秒每 100 次最终一致（这对我们来说很好）读取的成本为每小时 0.0113 美元。如果所有对象的大小不超过 1KB，那么我们每小时 11.3 美元。根据 16 小时/天的平均使用量，这将是每月 5424 美元。

所以……**每月 5424 美元**。

我会考虑其他选择，但我担心维护问题、成本等。我以前从未使用过此类设置，因此您的建议将非常有价值。

对于这种读/写密集型应用程序来说，最具成本效益（但仍然无忧）的解决方案是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-26T21:09:02.477

根据您上面的描述，我假设您每秒 5,000 次查询完全是读取操作。这本质上就是我们所说的数据仓库用例。您的可用性要求是什么？它必须托管在 AWS 和朋友上，还是您可以购买自己的硬件在内部运行？你的数据是什么样的？使用这些数据的逻辑是什么样的？

您可能会觉得这里确实没有足够的信息来明确回答这个问题，但我至少可以提供一些建议。

首先，如果您的数据相对较小并且查询很简单，请省去一些麻烦，并确保您从 RAM 而不是磁盘进行查询。任何支持内存缓存/表空间的现代 RDBMS 都可以解决问题。Postgres 和 MySQL 都有这方面的特性。在 Postgres 的情况下，请确保您已经适当地调整了内存参数，因为开箱即用的配置旨在运行在相当微薄的硬件上。如果您*必须*使用 NoSQL 选项，则取决于您的数据结构，Redis 可能是一个不错的选择（它也主要在内存中）。然而，为了说明哪种类型的 NoSQL 可能最适合，我们需要更多地了解您正在查询的数据的结构，以及您正在运行的查询。

如果查询归结为`SELECT * FROM table WHERE primary_key = {CONSTANT}`- 不要打扰 NoSQL - 只需使用 RDBMS 并学习如何调整该问题。如果您可以在自己的硬件上运行它，那就更是如此。如果连接数很高，请使用读取从站来平衡负载。

**事后编辑（5/7/2013）**：我之前应该提到的：EC2 是一个非常糟糕的地方来衡量自我管理的数据库节点的性能。除非您付出高昂的代价，否则您的 I/O 性能将非常*糟糕*。您的选择是为预置的 IOPS 支付大笔费用，将一堆 EBS 卷组成 RAID，或者在将 WAL 同步到 S3 或类似设备的同时依赖临时存储。所有这些选项都很昂贵且难以维护。所有这些选项都有不同程度的性能。

我在最近的一个项目中发现了这一点，所以我切换到了 Rackspace。那里的性能得到了极大的提升，但我注意到当我真的只需要快速 I/O 时，我为 CPU 和 RAM 资源付出了很多。现在我在 Digital Ocean 主持。DO的所有存储都是SSD。与其他产品相比，它们的 CPU 性能有点糟糕，但我非常受 I/O 限制，所以我不在乎。在将 Postgres'`random_page_cost`降到 2 之后，我的表现非常好。

故事的寓意：简介，曲调，重复。问自己假设问题并不断验证您的假设。

**另一个长期的事实编辑（11/23/2013）**：作为我在这里描述的示例，查看以下文章以获取使用 MySQL 5.7 和 InnoDB memcached 插件实现 1M QPS 的示例：[http ://dimitrik.free.fr/blog/archives/11-01-2013_11-30-2013.html#2013-11-22](http://dimitrik.free.fr/blog/archives/11-01-2013_11-30-2013.html#2013-11-22)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:24:09.470

> “负载”是指每秒约 5,000 个查询。

啊，那不是那么多，即使是SQL也可以处理。因此，您已经很容易在大多数现代数据库可以处理的范围内。但是，他们只能通过以下权利处理此问题：

*   索引
*   查询
*   服务器硬件
*   大数据的拆分（您可能需要大量的分片，每个分片的数据相对较低，取决于这里，所以我说“可能”）

> 那将是每秒读取约 100,000 个对象。

现在这更像是一个高负载场景。您必须以如此支离破碎的方式阅读这些内容吗？如果是这样（如我所说），您可能需要考虑将负载分散到复制的分片中。

> 存储不是我担心的事情，因为这些物体非常小。

Mongo 在磁盘分配方面非常激进，因此即使是小对象，它仍然会预先分配大量空间，这是需要牢记的。

> 所以……每月 5424 美元。

哦，是的，亚马逊的计费惊险刺激`:\`。

> 我会考虑其他选择，但我担心维护问题、成本等。我以前从未使用过此类设置，因此您的建议将非常有价值。

现在你碰到了这一切的障碍。您可以设置自己的集群，但最终可能会为服务器、人员、管理员和您自己的维护时间支付那么多的金钱和时间（或更多）。这就是 DynamoDB 真正在这里大放异彩的原因之一。对于希望承担服务器管理的负载、痛苦和压力的大型设置（相信我，这真的很痛苦，如果你是开发人员，你不妨从现在开始将你的职位改为服务器管理员）离开公司。

考虑自己设置，您需要：

*   相当数量的 EC 实例（取决于数据和索引大小，但我会说接近 30 个？）
*   服务器管理员（可能是 2 个，也可能是自由职业者？）

两者都可能使您每年损失 100 万英镑，如果它符合您的需求和预算，我个人会打赌管理方法。当您的需求超出托管 Amazon DB 所能提供的范围时，您就可以迁移到您的基础设施。

## 编辑

我应该修正一下，成本效益是通过相当多的黑洞完成的，例如：

*   我不确定您拥有的数据量
*   我不确定写

这两个都有助于我放置一个场景：

*   大量写入（大约与您的阅读量一样多）
*   海量数据（手）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-29T08:45:06.837

这是我按顺序推荐的。

1.  确定您的用例并选择正确的数据库。我们定期针对各种工作负载（OLTP、分析等）测试 MySQL 和 MongoDb。在我们测试的所有情况下，MySQL 都优于 MongoDb，并且与 MongoDb 相比更便宜 ($/TPS)。MongoDb 还有其他优势，但那是另一回事了……因为我们在这里谈论的是性能。

2.  尝试在 RAM 中缓存您的查询（通过提供足够的 RAM）。

3.  如果您在 RAM 上遇到瓶颈，那么您可以尝试利用临时 SSD 的 SSD 缓存解决方案。如果您的工作负载对缓存友好，则此方法有效。您可以节省大量资金，因为云提供商通常不会向临时 SSD 收费。

4.  尝试 PIOPS/RAID 或组合为您的应用程序创建足够的 IOPS。

# python - 无法抓取推特热门话题

> ID：12133412
> 
> 赞同：1
> 
> 时间：2012-08-26T19:58:03.987
> 
> 标签：python, twitter

```
>>> import twitter
>>> twitter_search = twitter.Twitter(domain="search.twitter.com")
>>> trends = twitter_search.trends()

Traceback (most recent call last):
  File "<pyshell#2>", line 1, in <module>
    trends = twitter_search.trends()
  File "build\bdist.win32\egg\twitter\api.py", line 173, in __call__
    return self._handle_response(req, uri, arg_data)
  File "build\bdist.win32\egg\twitter\api.py", line 198, in _handle_response
    raise TwitterHTTPError(e, uri, self.format, arg_data)
TwitterHTTPError: Twitter sent status 404 for URL: trends.json using parameters: ()
details: ‹ 
```

我也通过更改域来尝试

```
>>> import twitter
>>> twitter_api=twitter.Twitter(domain="api.twitter.com", api_version='1')
>>> WORLD_WOE_ID = 1
>>> world_trends = twitter_api.trends._(WORLD_WOE_ID)
>>> [ trend for trend in world_trends()[0]['trends'] ]
[{u'url': u'http://twitter.com/search/?q=%2320CutestFollowers', u'query': u'%2320CutestFollowers', u'events': None, u'promoted_content': None, u'name': u'#20CutestFollowers'}, {u'url': u'http://twitter.com/search/?q=%23watkiestnl', u'query': u'%23watkiestnl', u'events': None, u'promoted_content': None, u'name': u'#watkiestnl'}, {u'url': u'http://twitter.com/search/?q=%23FelizCumplea%C3%B1osAmaia', u'query': u'%23FelizCumplea%C3%B1osAmaia', u'name': u'#FelizCumplea\xf1osAmaia', u'promoted_content': None, u'events': None}, {u'url': u'http://twitter.com/search/?q=%22Hi%20Boyfriend%22', u'query': u'%22Hi%20Boyfriend%22', u'events': None, u'promoted_content': None, u'name': u'Hi Boyfriend'}, {u'url': u'http://twitter.com/search/?q=%22Christina%20Legendtina%20Aguilera%22', u'query': u'%22Christina%20Legendtina%20Aguilera%22', u'events': None, u'promoted_content': None, u'name': u'Christina Legendtina Aguilera'}, {u'url': u'http://twitter.com/search/?q=%22Jeroen%20Pauw%22', u'query': u'%22Jeroen%20Pauw%22', u'events': None, u'promoted_content': None, u'name': u'Jeroen Pauw'}, {u'url': u'http://twitter.com/search/?q=%22Denmark%20Has%20%C3%86bleskiver%20Niall%22', u'query': u'%22Denmark%20Has%20%C3%86bleskiver%20Niall%22', u'name': u'Denmark Has \xc6bleskiver Niall', u'promoted_content': None, u'events': None}, {u'url': u'http://twitter.com/search/?q=Jide', u'query': u'Jide', u'events': None, u'promoted_content': None, u'name': u'Jide'}, {u'url': u'http://twitter.com/search/?q=T.O', u'query': u'T.O', u'events': None, u'promoted_content': None, u'name': u'T.O'}, {u'url': u'http://twitter.com/search/?q=Getafe', u'query': u'Getafe', u'events': None, u'promoted_content': None, u'name': u'Getafe'}] 
```

我得到了结果，但我无法理解。我是研究工作的新手，也是 python 和 twitterApi 的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T17:46:32.990

和以前一样，但是将您的列表理解分配给`trends`：

```
>>> import twitter
>>> twitter_api=twitter.Twitter(domain="api.twitter.com", api_version='1')
>>> WORLD_WOE_ID = 1
>>> world_trends = twitter_api.trends._(WORLD_WOE_ID)
>>> trends = [ trend for trend in world_trends()[0]['trends'] ] 
```

`trends`只是一个字典列表（您可以使用[`pprint.pprint`](http://docs.python.org/library/pprint.html#pprint.pprint)打印这样的结构，使其更易于阅读）

要获取趋势名称，您只需要访问`name`每个 dict 中的项目，如下所示：

```
>>> [cur['name'] for cur in trends]
[u'#20CutestFollowers', u'#watkiestnl', ...] 
```

或者：

```
for cur in trends:
    print cur['name'] 
```

# c# - 添加枚举值后排序停止工作

> ID：12133416
> 
> 赞同：0
> 
> 时间：2012-08-26T19:58:24.760
> 
> 标签：c#, sorting, enums

我的代码中有一个用于集合的排序方法，今天我发现了一些奇怪的东西。当我尝试向枚举添加新的枚举值时，排序方法因此错误而崩溃。

> 无法排序，因为 IComparer.Compare() 方法返回不一致的结果。一个值与自身比较不相等，或者一个值与另一个值重复比较会产生不同的结果。x：''，x 的类型：'Texture2D'，IComparer：'System.Array+FunctorComparer`1[Microsoft.Xna.Framework.Graphics.Texture2D]'。

这看起来真的很奇怪，现在排序依赖于早期结果，它应该做的就是在枚举索引之后排序，而不是字母顺序。

这是代码。

```
 availableTiles.Sort(CompareTilesToEnum);

    private static int CompareTilesToEnum(Texture2D x, Texture2D y)
    {
        int xValue = (int) (Enum.Parse(typeof(TileTyp), x.Name, true));
        int yValue = (int) (Enum.Parse(typeof(TileTyp), y.Name, true));
        if (xValue > yValue)
        {
            return 1;
        }
        else
        {
            return -1;
        }
    }

    public enum TileTyp
    {
        Nothing = -1,
        Forest,
        Grass,
        GrassSandBottom,
        GrassSandLeft,
        GrassSandRight,
        GrassSandTop,
        Mounten,
        Sand,
        Snow,
        Water,
        GrassSandTopLeft,
        GrassSandAll,
        GrassSandBottomLeft,
        GrassSandBottomRightLeft,
        GrassSandBottomRightTop,
        GrassSandBottomTopLeft,
        GrassSandRightLeft,
        GrassSandRightTop,
        GrassSandRightTopLeft,
        GrassSandBottomRight,
        GrassSandBottomTop
    } 
```

我添加的值是

```
 GrassSandBottomRight,
    GrassSandBottomTop 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T20:04:03.077

您的比较*永远不会*返回 0 - 即使值相等。你有什么理由不只是要求`int.CompareTo`比较这些值吗？

```
private static int CompareTilesToEnum(Texture2D x, Texture2D y)
{
    int xValue = (int) (Enum.Parse(typeof(TileTyp), x.Name, true));
    int yValue = (int) (Enum.Parse(typeof(TileTyp), y.Name, true));
    return xValue.CompareTo(yValue);
} 
```

更简单，更重要的是，它应该实际*工作*:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:03:58.483

正如错误明确指出的那样，您的比较器已损坏。

`0`如果值相等，则需要返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T21:47:18.220

任何比较方法都必须遵循一些规则：

1.  如果 A == B，则 B == A（两次都返回零）。
2.  如果 A < B 且 B < C，则 A < C。
3.  如果 A < B，则 B > A
4.  A == A（如果与自身比较，则返回零）。

（注意，`==`上面的意思是既不是`<`也不`>`是真的。允许两个对象在排序顺序中是等价的，而不是对应的`Equals`。我们可以有一个规则，将所有包含数字的字符串按数字顺序排序，把所有其他字符串和结尾，但不关心其他字符串的顺序）。

这些规则适用于任何语言（它们不是编程规则，它们是逻辑规则），也有一个特定于 .NET 的规则：

5：如果 A != null，则 A > null。

你违反了前四个规则。由于`Texture2D`是引用类型，因此您也有违反规则 5 的风险（尽管会引发不同的异常）。

你也很幸运 .NET 抓住了它。不同的排序算法很可能会因更令人困惑的错误而崩溃或陷入无限循环，因为它例如发现项目 6 被报告为大于项目 7 并交换它们，然后很快发现项目 6 被报告为大于项目7和交换了它们，然后很快就找到了......

```
private static int CompareTilesToEnum(Texture2D x, Texture2D y)
{
    //Let's deal with nulls first
    if(ReferenceEquals(x, y))//both null or both same item
      return 0;
    if(x == null)
      return -1;
    if(y == null)
      return 1;
    //Enum has a CompareTo that works on integral value, so why not just use that?
    return Enum.Parse(typeof(TileTyp), x.Name, true)).CompareTo(Enum.Parse(typeof(TileTyp), y.Name, true)));
} 
```

（这假设解析失败是不可能的，并且不必考虑）。

# php - 取消授权 URL 未被访问

> ID：12133420
> 
> 赞同：1
> 
> 时间：2012-08-26T19:58:38.613
> 
> 标签：php, facebook

我为 Facebook 设置了一个画布应用程序，到目前为止，一切都运行良好，并且符合预期，但取消授权回调 URL 除外。

可以从 Internet 上的其他人/机器访问该 URL。我的网址格式如下：`http://subdomain.domain.com/phpfile.php`. 此时有问题的 php 文件只是生成一个 debug.txt 文件，只是为了查看它是否正在被访问。debug.txt 文件出现在目录中，具有除 Facebook 假定的 Deauthorize ping 之外的所有访问形式。

我已经用 Facebook 的 URL 测试器 (http://developers.facebook.com/tools/debug) 对其进行了测试。使用此工具时，会生成我的 debug.txt 文件。

有什么建议么？

# c# - 给定字典，找到包含特定字符集和字符串的所有可能单词的最佳方法是什么

> ID：12133427
> 
> 赞同：0
> 
> 时间：2012-08-26T19:59:38.363
> 
> 标签：c#, words

我正在写一个文字游戏。我可以访问字典对象来验证单词。我需要找到包含一个单词和一组附加字符的所有可能单词。例如：假设单词是“MEN”，附加字符集是“WALOHTD”。我需要一种方法来查找诸如.... 1.MEND 2.WOMEN 3.MENTAL 4\. 之类的词。基本上，我们正在查看所有可能包含“MEN”和任何特定附加字符的词。

我当然可以编写可以遍历整个字典到包含子词的第一个词的代码，然后检查特定字符的存在，但这不是最佳的。它需要超过一秒钟。非常感谢对最佳解决方案的任何帮助。_rey

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:33:51.047

问题是常规语言和搜索数据结构的混合。

仅考虑第一个方面，我们倾向于使用正则表达式。您没有说我们是否可以重复“附加字符”。如果可以的话，这`[WALOTHD]*MEN[WALOTHD]*`对您的情况来说很容易，而且很容易适应。

如果我们不能重复，那么我们可以`[WALOTHD]{0,7}MEN[WALOTHD]{0,7}`从任何违反规则的内容开始并过滤掉（“ALLOTMENT”匹配该表达式，但重复 L 和 T）。

或者我们可以尝试构建一个更复杂的正则表达式，尽管我不确定更好的表达式所带来的收益是否会超过计算它的成本。

来自搜索字典的另一面，[DAWG](http://en.wikipedia.org/wiki/Directed_acyclic_word_graph)非常节省空间，并且使查找包含子字符串的匹配项相对高效。这不是这个难题的完全匹配，因为我们需要担心很多前缀和后缀的排列。如果没有测试，我猜如果我们不能从“附加”中重复，那将是相当不错的，如果可以的话，那将是可怕的。但这只是一个猜测。GADDAG 可能很值得一看，它比 DAWG 大，但对于这种搜索可能更快（GADDAG 用于解决拼字游戏，这与您在这里遇到的问题几乎相同）。

# c# - 在父对象内映射子对象

> ID：12133429
> 
> 赞同：0
> 
> 时间：2012-08-26T19:59:49.233
> 
> 标签：c#, mapping

我有点问题。我不太清楚如何处理这种情况，所以我只解释一个简化的场景，希望你能帮助我。

我正在尝试将父数据库对象映射到父 bll 对象。在这个父数据库对象中，有一个指向子 ID 的外键，在我的父 bll 对象中，我使用子 bll 对象（不仅仅包含一个 ID）。

所以这是我的 bll 对象：

```
public class Parent
{
    public int ID { get; set; }
    public Child Child { get; set; }
}

public class Child
{
    public int ID { get; set; }
    public string FirstName { get; set; }
} 
```

这是我的映射器类/方法：

```
public class ParentMapper
{
    public Parent MapFromSource(ParentDatabaseObject parentDO)
    {
        Parent parent = new Parent();
        parent.ID = parentDO.ID;
        parent.Child = ???;
        return parent;
    }
} 
```

在这种情况下，我认为 ParentDatabaseObject 的外观并不重要，我只想知道应该如何映射 parent.Child 对象。

我考虑了以下几点：

```
parent.Child = new Child();
parent.Child.ID = doParent.Child.Id;
parent.Child.FirstName = doParent.Child.FirstName; 
```

这感觉不对，因为我有点想把它放在我的 ChildMapper 中，这导致我采用第二种实现方式（假设我有一个单独的子映射器并有一个名为 childMapper 的实例）：

```
parent.Child = childMapper.MapFromSource(parentDO.Child); 
```

但我有种感觉，使用这种映射方式会使我的代码有点紧密耦合，因为我会在 ParentMapper 中使用 ChildMapper。

所以我想我的问题是：我应该如何实现这种映射。最后一种方法是正确的还是有更好的方法？我已经放弃了我尝试的第一件事。

谢谢你的帮助！

（我在发布这个问题之前做了研究，这是我能找到的最接近的： [Data Mapper for Child Objects](https://stackoverflow.com/questions/3402685/data-mapper-for-child-objects)，但我对那里的唯一答案并不满意）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:41:41.290

不应该更好吗——

```
parent.Child = childMapper.MapFromSource(parentDO.FoeignKeyToTheChild); 
```

我认为您应该有方法通过 Id 获取对象。

**编辑：**如果您的映射器没有`DataAccess`编码，那么您必须在您的`Repository`. 由于您`Repository`已经准备好 DataObjects，您可以通过以下方式进行操作 -

父映射器：

```
public class ParentMapper
{
    public Parent MapFromSource(ParentDo parentDo)
    {
        Parent parent = new Parent();
        parent.Id = parentDo.Id;
        return parent;
    }
} 
```

子映射器：

```
public class ChildMapper
{
    public Child MapFromSource(ChildDo childDo)
    {
        Child child = new Child();
        child.Id = childDo.Id;
        child.FirstName = childDo.FirstName;

        return child;
    }
} 
```

存储库：

```
public class Repository
{
    //you already have parentDo
    //you already have childDo

    public Parent GetParent()
    {
        Parent parent = parentMapper.MapFromSource(parentDo);
        parent.Child = childMapper.MapFromSource(childDo);
        return parent;
    }

    public Child GetChild()
    {
        Child child = childMapper.MapFromSource(childDo);
        return child;
    }
} 
```

否则，您`Mapper`必须有权访问`DataAccess`代码。

# javascript - 如何测试 response.location.id 是否已定义？

> ID：12133433
> 
> 赞同：0
> 
> 时间：2012-08-26T20:00:06.687
> 
> 标签：javascript, variables, testing, attributes, defined

我该如何测试：

```
response.location.id 
```

被定义为 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:02:08.723

```
if (response && response.location && typeof response.location.id !== "undefined"){

 // is defined

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:03:44.507

```
typeof response.location.id !== "undefined" 
```

如果您不能依赖于定义的其余部分，那么：

```
response && response.location && typeof response.location.id !== "undefined" 
```

如果您可以依赖它们，并且不必担心`null`，`false`或者`0`作为定义的值`id`，那么只需直接测试它（`if(response.location.id)`）。

# asp.net-mvc-3 - 如何将网络应用程序转换为 saas？

> ID：12133437
> 
> 赞同：3
> 
> 时间：2012-08-26T20:00:36.567
> 
> 标签：asp.net-mvc-3, saas

我有一个完整的 asp.net mvc 3 Web 应用程序，它依赖于 mysql 数据库和 mssql 身份验证/授权数据库。我应该如何将应用程序转换为软件即服务 - 特别是与拥有多个租户有关？数据库应该只根据租户 ID 隔离其表，还是应该每个租户有一个数据库？有什么书或好的资料可以参考吗？我只是想看看是否有最佳实践，或者我所做的是否是标准的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T22:12:56.437

**[软件即服务](http://en.wikipedia.org/wiki/Software_as_a_service)**是一个庞大的行业，并且正在迅速发展。主要的教育参与者正在积极投资包括有关 SaaS 的课程。这样的机构之一是加州伯克利大学。**[他们在 edx.org](https://www.edx.org/courses/BerkeleyX/CS169.1x/2012_Fall/about)**上提供了关于 SaaS 的免费在线课程。授课的两位教授都深受好评。该课程的书籍可以通过**[他们的网站](http://beta.saasbook.info/)**或通过**[amazon.com](https://rads.stackoverflow.com/amzn/click/com/0984881212)**购买。

注意：我绝不隶属于课程、大学、教授、任何免费在线教育网站，也没有参加课程。SaaS 上没有太多可用的内容，这是我能够找到的*唯一来源之一。*

**编辑**

关于数据库，要从单租户转换为多租户系统，必须使用抽象来分离内容。但是，不可否认，这会使内容量乘以表中的租户数量，从而导致查询时间变慢。在这方面，表必须按租户范围进行分区，并使用表示这些分区的视图。然后可以查询这些视图。

# ruby-on-rails - 一次提交即可将多行更改为模型

> ID：12133438
> 
> 赞同：0
> 
> 时间：2012-08-26T20:00:40.800
> 
> 标签：ruby-on-rails, forms, models

我正在尝试建立一个使用多种模型的 Rails 站点。一种是称为请求的模型，它接收与基本上单次购买相关的几条信息。另一种是在一个“订单”ID 下收集多个请求的模型。

问题是，我希望与请求关联的视图允许一次提交的多个请求条目，但我无法弄清楚。正如我目前所知道的，有人可以为单个“剪辑”提交单个请求，但我希望他们在单个页面上输入多个剪辑请求，一次提交。

我当前与视图关联的 _form 文档是：

```
<%= form_for(@request) do |f*| %>

  <div class="field">
    <%= f.label :cut %><br />
    <%= f.text_field :cut %>
  </div>
   <div class="field">
    <%= f.label :lbs %><br />
    <%= f.number_field :lbs %>
  </div>
  <div class="field">
    <%= f.label :notes %><br />
    <%= f.text_field :notes %>
  </div>
  <div class="field">
    <%= f.label "Order ID" %><br />
    <%= f.number_field :order_id %>
  </div>
  <div class="field">
    <%= f.label :status %><br />
    <%= f.number_field :status %>
  </div>

  <div class="actions">
    <%= f.submit %>
  </div>

<% end %> 
```

知道如何创建一个表单文档，允许我通过一次提交输入几个新的“行”请求吗？或者如何确保它们都具有相同的 order-id？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:11:44.700

试试 Ryanb 的这些截屏视频，我想它们会让你走得很远。

*   [http://railscasts.com/episodes/196-nested-model-form-part-1](http://railscasts.com/episodes/196-nested-model-form-part-1)
*   [http://railscasts.com/episodes/197-nested-model-form-part-2](http://railscasts.com/episodes/197-nested-model-form-part-2)

# python - 无法在python中从客户端接收文件

> ID：12133439
> 
> 赞同：1
> 
> 时间：2012-08-26T20:00:43.267
> 
> 标签：python, sockets

我正在尝试对编译服务器进行编程，该服务器编译客户端发送的 C 程序并返回一个目标文件，然后可以在客户端链接和执行该目标文件。这是我的客户端和服务器程序分别

客户端.py：

```
# Compilation client program

import sys, socket, string

File = raw_input("Enter the file name:") 
ssock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
ssock.connect(('localhost', 5000))

csock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
csock.connect(('localhost', 5001))

f = open(File, "rb")
data = f.read()
f.close()
ssock.send(File)                 #send filename
ssock.send(data)                 #send file
fd=raw_input("Enter a key to start recieving object file:") 

data=csock.recv(1024)            #receive status
if data=="sucess\n":
    File=File.replace(".c",".o") #objectfile name
    print "Object file, "+File+", recieved sucessfully"
else:
    print "There are compilation errors in " + File
    File="error.txt"             #errorfile name
    print "Errors are reported in the file error.txt"

fobj=open(File,"wb")
while 1:
    data=ssock.recv(1024)        # if any error in c sourcefile then  error gets                                         
                                 # eported in errorfile "error.txt" else objectfile is 
                                 # returned from server
    if not data:break
    fobj.write(data)
fobj.close()
ssock.close()
csock.close() 
```

* * *

服务器.py

```
#Compilation Server program

import subprocess
import socket, time, string, sys, urlparse, os
ssock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
ssock.bind(('', 5000))                   
ssock.listen(2)
print 'Server Listening on port 5000'
csock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
csock.bind(('', 5001))
csock.listen(2)
print 'Control server listening on port 5001'
client, claddr = ssock.accept()
controlsoc, caddr = csock.accept()

filename=client.recv(1024)        #receive filename
print filename
###############  This code is not working, i'm not getting the reason   #######
###############    I want to receive a file more than 1KB from client   #######
f = open(filename,"wb")           #receive file======
while 1:
    data = client.recv(1024)
    if not data: break
    f.write(data)
f.close()
###############
###############

data="gcc -c " + filename + " 2> error.txt"  #shell command to execute c source file 
                                             #report errors if any to error.txt    
from subprocess import call

call(data,shell=True)                        #executes the above shell command
fil = filename.replace(".c",".o")
if (os.path.isfile(fil))== True:             #test for existence of objectfile 
    data = "sucess\n"                        #no objectfile => error in compilation
    filename = filename.replace(".c",".o")
else:
    data = "unsucessful\n"
    print data+"hi"
    filename = "error.txt"

controlsoc.send(data)
f = open(filename,"rb")
data=f.read()
f.close()
print data

client.send(data)

client.close()
controlsoc.close() 
```

* * *

我无法接收多个 KB 的文件。我的代码中是否有任何缺陷，或者我应该如何修改我的代码以实现编写编译服务器的目标。请在这方面帮助我..在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:09:51.853

这里的问题是您假设这`ssock.send(File)`将导致`filename=client.recv(1024)`准确读取文件名而不是更多，但实际上接收方不知道文件名在哪里结束，您最终会获得文件名*和*`filename`变量中的部分数据。

TCP 连接是*双向的字节流*。它不知道您的消息的边界。一个`send`可能对应于`recv`另一侧的多个（反之亦然）。您需要在原始 TCP 之上的*应用程序级协议。*

在您的情况下，最简单的方法是将表单中的文本行`file-size file-name\n`作为标题发送。这样，您的服务器不仅可以将标头与文件数据分开（通过换行符），而且还可以知道需要多少字节的文件内容，并为多个文件重用相同的 TCP 连接。

# wpf - 重复绑定

> ID：12133451
> 
> 赞同：0
> 
> 时间：2012-08-26T20:02:40.510
> 
> 标签：wpf, multithreading, treeview, bind

您好有一个绑定到 ObservableCollectionEx 集合的 TreeView。我的应用程序是多线程的，有时我会在 TreeView 中看到重复的条目。

我的树视图看起来像这样：

```
<TreeView 
        ItemsSource="{Binding Titles}" 
        Margin="3"
        ScrollViewer.VerticalScrollBarVisibility="Auto" 
        ScrollViewer.HorizontalScrollBarVisibility="Auto"
        Style="{StaticResource TreeViewStyle}"
        > 
```

绑定项源如下：

```
ObservableCollectionEx<Title> 
```

实际上它发生在 Title 拥有的 Subtitle 类中：

```
ObservableCollectionEx<Subtitle> Subtitles 
```

标题更新通过委托进行

```
void Add_Title(object sender, TitleEventArgs e) { _titles.Add(e.Title); } 
```

我怎样才能防止物品被欺骗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T12:54:56.317

只需在添加之前添加检查以查看该项目是否已存在

```
void Add_Title(object sender, TitleEventArgs e) 
{ 
    if (!_titles.Contains(e.Title))
        _titles.Add(e.Title); 
} 
```

如果集合可以被多个线程访问，您可能需要在集合被修改时锁定集合。

# cocos2d-iphone - Cocos2d unsigned int 随处可见

> ID：12133453
> 
> 赞同：2
> 
> 时间：2012-08-26T20:02:57.157
> 
> 标签：cocos2d-iphone, updates, unsigned-integer

我不确定我做了什么 - 我正在愉快地编码。我认为这可能与将 Xcode 更新到 4.1.1 有关，但是突然之间，当我构建和运行我的项目时，以下编译器警告出现在大约 20 个不同的 cocos2d 模块中。

'格式指定无符号整数，但参数有['CCTimer']（或它所在的任何模块）

cocos2d 模块中有问题的行是：

```
return [NSString stringWithFormat:@"<%@ = %08X | target:%@ selector:(%@)>", [self class], self, [target class], NSStringFromSelector(selector)]; 
```

是导致问题的'%08X'..

由于这个错误，我无法在我的 iphone 上编译，尽管它在模拟器中运行良好。我将我的手机操作系统更新到最新版本，但它没有帮助..

其他人有这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:19:38.130

这是 cocos2d 中试图打印出指针值的众多格式字符串之一。虽然 %08X 工作的正确方法是使用 %p。因此，您可以将行更改为：

```
[NSString stringWithFormat:@"<%@ = %p | target:%@ selector:(%@)>", [self class], self, [target class], NSStringFromSelector(selector)]; 
```

您将不得不更改所有这些行，大约有十几个。

任何好奇差异的人的示例输出：

```
%08X: 0976DC80
%p:   0x976dc80 
```

PS：我最近在[Kobold2D](http://www.kobold2d.com)中修复了所有这些不正确的 cocos2d 日志。

# java - 你如何在 Jsoup 中发送复选框数据

> ID：12133455
> 
> 赞同：0
> 
> 时间：2012-08-26T20:03:16.190
> 
> 标签：java, jsoup

我正在尝试使用 Jsoup 发布复选框数据并且遇到了一些麻烦。I thought that when multiple checkboxes are selected, they are sent as an array to the server but maybe that is not the case?

这是我认为是正确的：

```
HashMap<String, String> postData = new HashMap<String, String>();
postData.put("checkbox", "[box1,box2,box3]");

Jsoup.connect("somesite").data(postData).post(); 
```

这似乎无法正常工作。但是，如果我只发送一个复选框，那么我会得到预期的结果，这让我相信我对复选框表单数据如何发送的理解是不正确的。

这有效：

```
postData.put("checkbox", "box2"); 
```

也许 HashMap 是使用错误的类型。根据 Jsoup[文档](http://jsoup.org/apidocs/org/jsoup/Connection.html#data%28java.lang.String,%20java.lang.String%29)，我可以多次调用 .data(key, value) 但我希望有比这更干净的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:08:11.743

如果您有多个复选框，那么大概每个复选框都有自己的`name`属性。然后，您应该调用`.data(name, value)`每个这样的名称。

AFAIK 没有办法将这些调用“折叠”`data`成一个调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-09T02:07:35.257

也许您可以尝试以下方法？

```
 HashMap<String,String> paramHM=new HashMap<String,String>();

 ArrayList<String> checkboxVal=new ArrayList<Strnig>();
 / .. put request.getParametersValues() in this arraylist

 org.jsoup.Connection jsoupConn=Jsoup.connect(web_api).data(paramHM);

 // Multiple Call that 
 for(String item:checkboxVal){
    jsoupConn=jsoupConn.data("checkbox",item);
 } 
```

# php - Ajax 调用不断返回 null

> ID：12133456
> 
> 赞同：0
> 
> 时间：2012-08-26T20:03:37.820
> 
> 标签：php, javascript, jquery, ajax

我的js：

```
$('#select').change(function() {
    var name = $(this).val();
    $.ajax({
        type: "POST",
        url: "data/grab.php",
        data: { type: "hops", name: name },
        dataType: "json",
        success: function(data) {
                    alert(data);
            var aa = data['aa'];
            $('#hops-aa').val(aa);
        }
    });
}); 
```

抓取.php

```
<?php

$type = $_POST['type'];
$name = $_POST['name'];

if ($type == 'hops') {
    $result = $name;
}

$result = json_encode($result);
return $result; 
```

我`alert()`在 ajax 调用中添加了 以仔细检查我从脚本返回的内容，它始终为空。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:05:42.047

您实际上需要`echo`或`print`. `$result`在 PHP 中使用`return`文件范围不会将返回值发送到输出流。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:05:13.167

您使用`echo`PHP 打印出结果，而不是`return`：

```
echo $result; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T20:08:30.950

（如先前的答案所述）您需要回显/打印 $result 变量。

```
<?php

$type = $_POST['type'];
$name = $_POST['name'];

if ($type == 'hops') {
    $result = $name;
}

$result = json_encode($result);
echo $result; // return $result;
?> 
```

# php - 基于 PHP 中当前目录的 URL

> ID：12133457
> 
> 赞同：0
> 
> 时间：2012-08-26T20:03:40.407
> 
> 标签：php, url

假设我有三个php页面，分别`Header.php`位于`Footer.php`以下`LeftSideBar.php`目录中

```
C:\wamp\www\zoomin\header_footer_sidebar 
```

和以下目录中的常用 php 页面。

```
C:\wamp\www\zoomin\www.zoomin.com 
```

我可以包括这三个页面如下。

```
<?php       
    require_once("../header_footer_sidebar/Header.php");
    require_once("../header_footer_sidebar/LeftSideBar.php");
    require_once("../header_footer_sidebar/Footer.php");
?> 
```

这可以正常工作，但是当我需要将页面保留在其他目录中时，如下所示，

```
C:\wamp\www\zoomin\www.zoomin.com\directoryA\directoryB\directoryC 
```

我需要将这三个页面复制到一个适当的目录中，因为`Header.php`,`Footer.php`并且`LeftSideBar.php` **可能包含一些 url**至少一些其他目录的一些图像 url 不能与前面的 url 一起使用。

我想保留`Header.php`,`Footer.php`并且`LeftSideBar.php`只保留在上面提到的以下目录中。

```
C:\wamp\www\zoomin\header_footer_sidebar 
```

无论我将网页保存在哪个目录中。在这种情况下，以下方法不起作用。

```
$protocol."://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']; 
```

或者

```
$protocol."://".$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF']; 
```

有没有办法满足这个要求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:13:34.510

检查你[`include_path`](http://ca2.php.net/manual/en/ini.core.php#ini.include-path)的 php.ini。

# php - 白页，Kohana 中没有错误

> ID：12133462
> 
> 赞同：0
> 
> 时间：2012-08-26T20:04:36.627
> 
> 标签：php, mod-rewrite, kohana, frame

我有一个用Kohana框架写的整个网站，不是我写的，我只是在很久以后帮助启动它，如果我是对的，它是在2009年写的。

所以，我上传了所有文件，插入了Mysql数据并进行了配置，我去网站：

adress.com 并重定向到 adress.com/index.php/lt

但后来我看到的只是白页，没有标题，什么都没有。Kohana 日志显示：

```
 2012-08-26 22:56:48 +03:00 --- debug: Auth Library loaded
2012-08-26 22:56:48 +03:00 --- debug: MySQL Database Driver Initialized
2012-08-26 22:56:48 +03:00 --- debug: Database Library initialized
2012-08-26 22:56:49 +03:00 --- debug: Global GET, POST and COOKIE data sanitized
2012-08-26 22:56:49 +03:00 --- debug: Session Cookie Driver Initialized
2012-08-26 22:56:49 +03:00 --- debug: Session Library initialized
2012-08-26 22:56:49 +03:00 --- debug: Auth Library loaded
2012-08-26 22:56:49 +03:00 --- debug: MySQL Database Driver Initialized
2012-08-26 22:56:49 +03:00 --- debug: Database Library initialize 
```

然后服务器日志显示：

```
[Sat Aug 25 12:51:47 2012] [error] [client 94.244.82.207] mod_rewrite: maximum number of internal redirects reached. Assuming configuration error. Use 'RewriteOptions MaxRedirects' to increase the limit if neccessary.
[Sat Aug 25 12:51:48 2012] [error] [client 94.244.82.207] mod_rewrite: maximum number of internal redirects reached. Assuming configuration error. Use 'RewriteOptions MaxRedirects' to increase the limit if neccessary. 
```

这是 .htaccess 文件：

```
# Turn on URL rewriting
RewriteEngine On

# Installation directory
RewriteBase /sporttv/

# Protect application and system files from being viewed
RewriteRule ^(application|modules|system) - [F,L]

# Protect .git files
RewriteRule ^.git - [F,L]

# Allow any files or directories that exist to be displayed directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Rewrite all other URLs to index.php/URL
RewriteRule .* index.php/$0 [PT,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:53:54.217

您的`.htaccess`文件中有错误。这是工作示例：

```
# Turn on URL rewriting
RewriteEngine On

# Installation directory
RewriteBase /sporttv/

# Protect hidden files from being viewed
<Files .*>
    Order Deny,Allow
    Deny From All
</Files>

# Protect application and system files from being viewed
RewriteRule ^(?:application|modules|system)\b.* index.php/$0 [L]

# Allow any files or directories that exist to be displayed directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Rewrite all other URLs to index.php/URL
RewriteRule .* index.php/$0 [PT] 
```

# php - 我希望在用户多次单击电子邮件激活链接时显示正确的消息

> ID：12133467
> 
> 赞同：1
> 
> 时间：2012-08-26T20:05:14.567
> 
> 标签：php, mysqli

我正在为我的 A-Level 做一个编程课程，但我遇到了一个问题。我希望你们中的一个可以帮助我。

我正在建立一个会员系统，目前我正处于电子邮件激活阶段。使用 php 和 mysqli 编码与连接的数据库，我已经能够设置电子邮件激活链接，以便当用户单击激活链接时，它通过将“活动”数据库字段设置为“0”来激活用户的帐户为“1”。

我唯一的问题是，如果用户再次点击电子邮件中的激活链接，因为用户已经处于活动状态，我希望它显示消息“此帐户已被激活”；。这样用户就无法再次激活该帐户。

但我无法让它显示此消息。即使用户已经激活了帐户，它也会继续显示消息“帐户已激活”。有谁知道我做错了什么？

下面是我的代码：

```
<?php
$user_to_be_activated  =   $_GET['user'];
$code_to_be_matched   =   $_GET['code'];
$code_activated = 1;

// don't use $mysqli->prepare here
$query = "SELECT TeacherUsername, Active, Code FROM Teacher WHERE TeacherUsername = ? AND Code = ? ";
// prepare query
$stmt=$mysqli->prepare($query);
// You only need to call bind_param once
$stmt->bind_param("ss",$user_to_be_activated, $code_to_be_matched);
// execute query
$stmt->execute(); 
// get result and assign variables (prefix with db)
$stmt->bind_result($dbTeacherUsername, $dbActive, $dbCode);
//get number of rows
$stmt->store_result();
$counting = $stmt->num_rows();

if($counting == '1')
{

    if($dbActive == '1')
    {
        echo "This Account has already been Activated";
    }
    else{

    $updatesql = "UPDATE Teacher SET Active = ? WHERE TeacherUsername = ? AND Code = ?";                                            
    $update = $mysqli->prepare($updatesql);
    $update->bind_param("sss", $code_activated, $user_to_be_activated, $code_to_be_matched);
    $update->execute();
    $update->close();

    echo "Account is Activated";
}
}
else
{
    echo "The Code and Username doesn't match! Account is not Activated.";
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:21:39.800

```
<?
$stmt->store_result();
$counting = $stmt->num_rows();

if($counting == '1')
{
    $stmt->fetch(); //added fetch here
    if($dbActive == '1')
    {
        echo "This Account has already been Activated";
    }
    else{

    $updatesql = "UPDATE Teacher SET Active = ? WHERE TeacherUsername = ? AND Code = ?";                                            
    $update = $mysqli->prepare($updatesql);
    $update->bind_param("sss", $code_activated, $user_to_be_activated, $code_to_be_matched);
    $update->execute();
    $update->close();

    echo "Account is Activated";
}
}
else
{
    echo "The Code and Username doesn't match! Account is not Activated.";
}
?> 
```

# c++ - c++ 从heredoc 读取标准输入

> ID：12133468
> 
> 赞同：1
> 
> 时间：2012-08-26T20:05:19.903
> 
> 标签：c++, stream, std

如果我有我的命令行，例如：

```
foo arg1 arg2 << HEREDOC
  line1
  line2
HEREDOC 
```

在 foo 中，我如何从 heredoc 中获得价值？

```
int main( char *argv[] )
{
  string arg1=argv[1];
  string arg2=argv[2];

  string heredoc= ?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:08:35.050

这里的文档是另一种进行 IO 重定向的方法。您的 shell 命令基本上是放入行`line1`，然后`line2`放入`stdin`您的程序。

所以你的代码应该是这样的：

```
int main(int argc, char *argv[])
// notice that your main declaration isn't conforming to C++ standard.
// it need additional argc parameter
{
  string arg1=argv[1];
  string arg2=argv[2];

  string heredoc_string1, heredoc_string2;
  getline(cin, heredoc_string1); 
  getline(cin, heredoc_string2);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:09:19.200

heredoc 只是将内容重定向到`stdin`. 所以你可以使用：

```
string str;
while (getline(cin, str))
    cout << str << endl; 
```

# documentum - DQL 获取默认组列表

> ID：12133469
> 
> 赞同：2
> 
> 时间：2012-08-26T20:05:26.910
> 
> 标签：documentum

有没有办法使用 dql 获取房间的默认组（所有者、贡献者、成员）列表`documentum 6.6`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T18:50:12.537

除了

```
select builtin_groups from dmc_room where object_name ="MYROOM" 
```

要列出房间和实际（仅限所有者和贡献者）组，请使用：-

```
select dg.group_name,dr.object_name from dm_group dg,dmc_room dr where group_name like 'room_%_%n%s' and dg.group_name IN dr.builtin_groups 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:07:21.933

```
select builtin_groups from dmc_room where object_name ="MYROOM" 
```

# android - 创建一个按钮

> ID：12133472
> 
> 赞同：1
> 
> 时间：2012-08-26T20:05:57.607
> 
> 标签：android, button

我正在尝试创建一个按钮来启动 randomGenerator。

```
Random randomGenerator = new Random();
    int randomInt = randomGenerator.nextInt(9);
    String wordList[] = new String[9];
    {
        wordList[0] = "Mexican";
        wordList[1] = "American";
        wordList[2] = "Barbeque";
        wordList[3] = "Chinese";
        wordList[4] = "Indian";
        wordList[5] = "Italian";
        wordList[6] = "Thai";
        wordList[7] = "Viatnamese";
        wordList[8] = "Middle Eastern";

    }

 String wordToDisplay = wordList[randomInt]; 
```

这是我的布局，我已经创建了我的按钮并标记了它。只是不知道如何从这里开始。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:padding="@dimen/padding_medium"
        android:text="@string/hello_world"

        tools:context=".ImHungry" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="@string/button1" />

</RelativeLayout> 
```

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:14:12.780

在 onCreate 方法中尝试这样的事情：

```
Button btnStart = (Button) findViewById(R.id.button1);
TextView tv = (TextView) findViewById(R.id.textview1);

btnStart.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(final View v) {
        tv.setText(wordToDisplay);
        }
    }); 
```

并且不要忘记在 TextView 中设置一个 id。IE

```
<TextView
    android:id="textview1"
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:10:49.037

```
Button mButton; 
TextView mTextView;
String wordList[] = new String[9];

public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    setContentView(R.layout.main); 

mButton = (Button)findViewById(R.id.button1); 
mTextView = (TextView) findViewById(R.id.textview1);
mButton.setOnClickListener(onClick); 

    {
        wordList[0] = "Mexican";
        wordList[1] = "American";
        wordList[2] = "Barbeque";
        wordList[3] = "Chinese";
        wordList[4] = "Indian";
        wordList[5] = "Italian";
        wordList[6] = "Thai";
        wordList[7] = "Viatnamese";
        wordList[8] = "Middle Eastern";

    }

    }

    private View.OnClickListener onClick= new View.OnClickListener() {
            // @Override
            public void onClick(View v) {

            Random randomGenerator = new Random();
         int randomInt = randomGenerator.nextInt(9);
         String wordToDisplay = wordList[randomInt];
        mTextView.setText(wordToDisplay);
        }

    }; 
```

***注意：***在您的代码中，您的 TextView 缺少 id 属性。确保添加它。

```
<TextView
    android:id="textview1"
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:11:32.087

如果我说对了，您应该将其添加到您的`onCreate()`：

```
 final Button button1 = (Button) findViewById(R.id.button1);
     button1.setOnClickListener(new View.OnClickListener() {
         public void onClick(View v) {
             // Perform action on click
             Random randomGenerator = new Random();
             int randomInt = randomGenerator.nextInt(9);
             String wordToDisplay = wordList[randomInt];

             // display in TextView
             TextView tv = (TextView) findViewById(R.id.textview1);
             tv.setText(wordToDisplay);
         }
     }); 
```

并添加`android:id="textview1"`到您的 TextView xml。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T20:11:35.457

你可以这样做：

添加`android:onClick="randomGenerator"`到您的按钮属性。然后在你的活动中。创建一个在单击按钮时将调用的函数。（我假设您想在单击按钮时执行随机生成代码。）

```
public void randomGenerator(View view){

    Random randomGenerator = new Random();
    int randomInt = randomGenerator.nextInt(9);
    String wordList[] = new String[9];
    {
        wordList[0] = "Mexican";
        wordList[1] = "American";
        wordList[2] = "Barbeque";
        wordList[3] = "Chinese";
        wordList[4] = "Indian";
        wordList[5] = "Italian";
        wordList[6] = "Thai";
        wordList[7] = "Viatnamese";
        wordList[8] = "Middle Eastern";

    }

    String wordToDisplay = wordList[randomInt];

} 
```

希望有帮助。

# c# - 使用组的简单 linq 查询以返回一对多关系

> ID：12133473
> 
> 赞同：1
> 
> 时间：2012-08-26T20:05:58.703
> 
> 标签：c#, asp.net, linq

我有一个用户数据表和另一个 user_ratings 表。这是一对多的关系，因此它们由 连接`UserId`，users 表是主键，user_ratings 具有外键关系。每个 user_ratings 都有一个名为 rating_value 的列，其中填充了一个整数，负数或正数，并且它被加在一起计算为用户的评级。我希望能够根据给定评级的日期为每个用户提取评级。这是我到目前为止的 linq 声明，但我认为它不正确。

```
var profiles = from userprofs in Ent.UserProfiles
               join userratings in Ent.UserRatings on userprofs.UserId equals userratings.UserId
               where userratings.DateAdded >= drm.Start
               group userprofs by userprofs.UserId into g
               select new { ... }; 
```

不太确定从这里去哪里，我不确定我是否正确使用了该组。我希望稍后能够遍历此集合，以便能够根据 user_ratings 的总和显示每个用户及其相关评分

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T21:26:03.997

如果您希望了解的有关评级的所有信息都是汇总信息（总和、平均值、计数等），那么您可以执行以下操作：

```
var profiles = from userprof in Ent.UserProfiles
  join userrating in Ent.UserRatings on userprofs.UserId equals userratings.UserId
  where userrating.DateAdded >= drm.Start
  group userrating by userprof into g
  select new {g.Key.UserID, g.Key.UserName, Count = g.Count(), Avg = g.Avg(r => r.RatingValue) }; 
```

请注意，我将复数名称更改为单数名称，因为我们根据每个单独的项目定义 linq 查询（UserProfiles 是复数，而 userprof 每个项目都“在”其中）。

这可以很好地直接转换为 SQL：

```
SELECT up.userID, up.userName, COUNT(ur.*), AVG(ur.ratingValue)
FROM UserProfiles up JOIN UserRatings ur
ON up.userID = ur.userID
WHERE dateAdded > {whatever drm.Start is}
GROUP BY up.userID, up.userName 
```

如果我们希望能够获得单独的评级，这与单个 SQL 查询不太匹配，我们可以这样做：

```
var profiles = from userprof in Ent.UserProfiles
  join userrating in Ent.UserRatings on userprofs.UserId equals userratings.UserId
  where userrating.DateAdded >= drm.Start
  group new{userrating.RatingValue, userrating.SomeThing} by new{userprof.UserID, userprof.UserName}; 
```

这将为我们提供一个`IEnumerable<Grouping<{anonymous object}, {anonymous object}>>`我们可以迭代的对象，在每次迭代中获得一个新的`Key.UserID`and `Key.UserName`，并能够依次迭代得到`item.RatingValue`and `item.SomeThing`（我添加用于演示，如果我们只想要它的值`IEnumerable<Grouping<{anonymous object}, int>>`）就像这个：

```
foreach(var group in profiles)
{
  Console.WriteLine("The user is :" + group.Key.UserName + " (id: " + group.Key.UserID ")");
  foreach(var item in group)
  {
    Console.WriteLine(item.SomeThing + " was rated " + item.RatingValue);
  }
} 
```

然而，这个问题是没有一个很好的单个 SQL 查询可以映射到。Linq 会尽力而为，但这意味着要执行几个查询，所以你最好帮助它：

```
var profiles = from item in (from userprof in Ent.UserProfiles
  join userrating in Ent.UserRatings on userprofs.UserId equals userratings.UserId
  where userrating.DateAdded >= drm.Start
  select new{userrating.RatingValue, userrating.SomeThing, userprof.UserID, userprof.UserName}).AsEnumerable()
  group new{item.RatingValue, item.SomeThing} by new{item.UserID, item.UserName} 
```

这与以前的输出相同，但转换为 SQL 允许进行单个查询，其余工作在内存中完成。99% 的情况下，像这样将一些工作拖到内存中会降低效率，但是因为之前没有可以映射到的单个 SQL 查询，所以这是一个例外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:18:18.310

如果我理解你的问题：

```
from userprofs in Ent.UserProfiles
join userratings in Ent.UserRatings on userprofs.UserId equals userratings.UserId
where userratings.DateAdded >= drm.Start
group new{userprofs,userratings} by userprofs.UserId into g
select new { userId=g.Key, userRating=g.Sum(i=>i.userratings.rating_value) }; 
```

`GroupBy`返回一个`IEnumerable`。`IGrouping`An`IGrouping`基本上是`IEnumerable`具有额外`Key`属性的 an，其中包含用于进行分组的属性。如果您`Sum`是`rating_value`该组的成员，那么您就在那里。

# macos - 如何在不停止进程的情况下使用 node.js 执行文件时关闭终端窗口？

> ID：12133475
> 
> 赞同：4
> 
> 时间：2012-08-26T20:06:26.563
> 
> 标签：macos, node.js, terminal

当我使用 node.js 执行文件时（通过键入“node example.js”，可能是 http 服务器），然后，当我关闭终端窗口（Mac OS X Lion）时，进程停止并且没有回答请求了。如果我输入“ctrl c”或“ctrl z”，也会发生同样的情况。如何在不停止进程的情况下关闭终端，以便我的服务器继续响应请求。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-26T22:19:03.413

使用`nohup`前缀命令（在终端关闭时防止进程被终止）和`&`后缀（在后台运行进程，以免占用终端）的组合： `nohup node example.js &`

您还应该研究[永远](https://github.com/nodejitsu/forever)或类似的工具，它们也会在服务器崩溃时自动重新启动服务器，以及[nodemon](https://github.com/remy/nodemon)会在您更改代码时自动重新启动它。

# c# - C#将文本文件中的行添加到列表框

> ID：12133476
> 
> 赞同：-2
> 
> 时间：2012-08-26T20:06:34.650
> 
> 标签：c#

我有一个包含文本行的文本文件，如果下一行满足例如条件，我正在尝试将某行添加到列表框中

如果该行以 # 开头，则添加该行，如果下一行以 @ 开头，之后的所有行以 @ 开头

```
#add this line
@add this line
@add this line
@add this line
#dont add because the next line is not a @
#dont add because the next line is not a @
#dont add because the next line is not a @
#dont add because the next line is not a @
#add this line
@add this line
@add this line
#dont add because the next line is not a @
#add this line
@add this line  
#add this line
@add this line 
```

希望这使场景任何帮助都会很棒

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:08:39.683

使用 String 的 StartsWith 方法[http://msdn.microsoft.com/en-us/library/system.string.startswith.aspx](http://msdn.microsoft.com/en-us/library/system.string.startswith.aspx)

你的整个功能就像

```
var lines = File.ReadAllLines(yourpath);
var resultLines = new List<string>();
bool adding = false;
for(int i=0;i<lines.Length;i++)
{
    var line = lines[i];
    if((line.StartsWith("#") && i < lines.Length-1 && lines[i+1].StartsWith("@"))
       || adding && line.StartsWith("@"))
        adding = true;
    else if(i < lines.Length-1 && !lines[i+1].StartsWith("@"))
        adding = false;
    if(adding)
        resultLines.Add(line);
} 
```

# ruby-on-rails - 从外部 Rails 引擎访问模型

> ID：12133478
> 
> 赞同：1
> 
> 时间：2012-08-26T20:07:09.217
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

嘿，我正在创建一个**rails 3 引擎**并尝试访问正在安装引擎的应用程序中的模型。

```
module MyEngine
  class UsersController < ApplicationController

    def index
      @users = User.all
    end 
```

如果我调用以下内容，那么它会给我错误：

**找不到表'my_engine_users'** - 如果模型在引擎内部，它会自动查找将存在的命名空间版本，但在这种情况下，它是在使用引擎的应用程序中定义的。

**如果我调用 ::User.all 而不是 User.all 那么一切正常**，但它看起来有点奇怪。这是有效的红宝石还是有更好的方法来获取对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T11:30:33.173

因此，如果我的问题正确，您的引擎中有一个模型，看起来像这样：

```
module MyEngine
  class User
  end
end 
```

如果上面的假设是正确的，你可以`table_name=` **在模型中设置表名**

```
module MyEngine
  class User
    self.table_name = 'users'
  end
end 
```

# memory - CUDA 在常量内存中复制数组

> ID：12133482
> 
> 赞同：1
> 
> 时间：2012-08-26T20:07:24.613
> 
> 标签：memory, cuda, constants

我有一个映射表，我知道可以通过执行以下操作将其复制到 CUDA 常量内存：

```
#define LENGTH 4
#define THREAD_BLOCKS 64

const int mapTable[LENGTH] = {0, 1, 3, 5};

int main()
{
  //..

__constant__ int dMapTable[LENGTH];
cudaMemcpyToSymbol( dMapTable , mapTable, size_t(LENGTH) * sizeof(int) , 0, cudaMemcpyHostToDevice );

  //..
} 
```

现在我要做的是在 CUDA 常量内存中创建该表的多个副本。我要创建的副本数量等于线程块 THREAD_BLOCKS 的数量。谁能建议我如何做到这一点并有效地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T00:13:49.330

如果您通过设置常量数据的多个副本看到内核性能有任何改进，我会感到非常惊讶。常量内存被缓存，所以你只会用重复的值来破坏缓存。

此外，值得注意的是，在计算能力 3.0 之前的所有设备上，恒定内存大小仅为 64KiB。

不过，如果您想检查性能，只需像往常一样设置多个副本，然后为内核计时。

# string - 无法将数组列表转换为字符串

> ID：12133484
> 
> 赞同：0
> 
> 时间：2012-08-26T20:07:32.723
> 
> 标签：string, arraylist

在下面的代码中，sBar 是一个数组列表。我正在尝试将其转换为字符串，然后将其写入文件。但是，我不知道我在这里做错了什么，因为我不断收到错误消息：
- NullPointerException - 线程“Thread-1”中的异常 java.lang.ClassCastException：java.lang.Long 无法转换为 java.lang。细绳

```
try{
   FileWriter writer = new FileWriter("stime.txt");
    for (Iterator it = sBar.iterator(); it.hasNext();) {
        String str = (String) it.next();
        writer.write(str);
     }
    }
 } catch (IOException e) {
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:09:14.723

正如错误明确指出的那样，您不能将 a 强制`Long`转换为 a `String`。
Java 强制转换只能用于将对象转换为它实际*存在*的类型；您不能使用强制转换将对象转换为不同的类型。

你可能想打电话`.toString()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:09:15.537

您不能通过强制转换将 long 转换为字符串。改变

```
String str = (String) it.next(); 
```

至

```
String str = it.next().toString(); 
```

* * *

另一种编写方法是使用 for each 循环：

```
for (Long val : sBar)
    writer.write(String.valueOf(val)); 
```

# python - Tweepy SSL错误

> ID：12133489
> 
> 赞同：9
> 
> 时间：2012-08-26T20:08:13.033
> 
> 标签：python, ssl, twitter, tweepy

我有一个 Django 管理命令，通过 supervisord 启动，它使用 tweepy 来使用 twitter 流 API。

该代理运行良好，但我注意到日志中每 10-15 分钟出现一次 SSLError，并且 supervisord 正在重新启动代理。

tweepy 包是最新的，1.11 版。服务器是 ubuntu 12.04 LTS。我已经尝试将 cacert 安装到下面链接中提到的钥匙链中，但没有运气。

[Twitter API SSL 根 CA 证书](https://dev.twitter.com/discussions/533)

有什么建议么？

```
[2012-08-26 19:28:15,656: ERROR] Error establishing the connection
Traceback (most recent call last):.../.../datasinks.py", line 102, in start
    stream.filter(locations=self.locations)
  File "/site/pythonenv/local/lib/python2.7/site-packages/tweepy/streaming.py", line 228, in filter
    self._start(async)
  File "/site/pythonenv/local/lib/python2.7/site-packages/tweepy/streaming.py", line 172, in _start
    self._run()
  File "/site/pythonenv/local/lib/python2.7/site-packages/tweepy/streaming.py", line 117, in _run
    self._read_loop(resp)
  File "/site/pythonenv/local/lib/python2.7/site-packages/tweepy/streaming.py", line 150, in _read_loop
    c = resp.read(1)
  File "/usr/lib/python2.7/httplib.py", line 541, in read
    return self._read_chunked(amt)
  File "/usr/lib/python2.7/httplib.py", line 574, in _read_chunked
    line = self.fp.readline(_MAXLINE + 1)
  File "/usr/lib/python2.7/socket.py", line 476, in readline
    data = self._sock.recv(self._rbufsize)
  File "/usr/lib/python2.7/ssl.py", line 241, in recv
    return self.read(buflen)
  File "/usr/lib/python2.7/ssl.py", line 160, in read
  return self._sslobj.read(len)
SSLError: The read operation timed out 
```

以下是代码的概要。

```
from tweepy import API, OAuthHandler
from tweepy.streaming import StreamListener, Stream
# snip other imports

class TwitterSink(StreamListener, TweetSink):

  def __init__(self):
    self.auth = OAuthHandler(settings.TWITTER_OAUTH_CONSUMER_KEY, settings.TWITTER_OAUTH_CONSUMER_SECRET)
    self.auth.set_access_token(settings.TWITTER_OAUTH_ACCESS_TOKEN_KEY, settings.TWITTER_OAUTH_ACCESS_TOKEN_SECRET)
    self.locations = '' # Snip for brevity

  def start(self):
    try:
        stream = Stream(self.auth, self,timeout=60, secure=True)
        stream.filter(locations=self.locations)
    except SSLError as e:
        logger.exception("Error establishing the connection")
    except IncompleteRead as r:
        logger.exception("Error with HTTP connection")

  # snip on_data()
  # snip on_timeout()
  # snip on_error() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-02T08:07:04.500

证书似乎不是问题。错误只是超时。对我来说，这似乎是 tweepy 的 SSL 处理的问题。[该代码](https://github.com/tweepy/tweepy/blob/master/tweepy/streaming.py#L118)可以处理`socket.timeout`和重新打开连接，但不是通过`SSLError`.

但是，查看`ssl`模块[代码](http://svn.python.org/projects/python/trunk/Modules/_ssl.c)（或[docs](http://docs.python.org/2/library/ssl.html)），我没有看到一个很好的方法来捕捉它。该`SSLError`对象在没有任何参数的情况下被引发，只是一个字符串描述。由于缺乏更好的解决方案，我建议在[tweepy/streaming.py 的第 118 行](https://github.com/tweepy/tweepy/blob/master/tweepy/streaming.py#L118)之前添加以下内容：

```
except SSLError, e:
  if 'timeout' not in exception.message.lower(): # support all timeouts
    exception = e
    break
  if self.listener.on_timeout() == False:
    break
  if self.running is False:
    break
  conn.close()
  sleep(self.snooze_time) 
```

为什么它首先超时是一个很好的问题。我没有什么比重复 Travis Mehlinger 的设置更高的建议更好的了`timeout`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T08:24:50.090

Github 上提供了另一种替代解决方案：

[https://github.com/tweepy/tweepy/pull/132](https://github.com/tweepy/tweepy/pull/132)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T20:41:54.997

这是我的方式（从这里修改解决方案[https://groups.google.com/forum/?fromgroups=#!topic/tweepy/80Ayu1joGJ4](https://groups.google.com/forum/?fromgroups=#!topic/tweepy/80Ayu1joGJ4)）：

```
l = MyListener()
auth = OAuthHandler(settings.CONSUMER_KEY, settings.CONSUMER_SECRET)
auth.set_access_token(settings.ACCESS_TOKEN, settings.ACCESS_TOKEN_SECRET)
# connect to stream
stream = Stream(auth, l, timeout=30.0)
while True:
    # Call tweepy's userstream method with async=False to prevent
    # creation of another thread.
    try:
        stream.filter(follow=reporters, async=False)
         # Normal exit: end the thread
         break
    except Exception, e:
         # Abnormal exit: Reconnect
         logger.error(e)
         nsecs = random.randint(60, 63)
         logger.error('{0}: reconnect in {1} seconds.'.format(
             datetime.datetime.utcnow(), nsecs))
         time.sleep(nsecs) 
```

# iphone - 如何使用 iCloud 访问 Xcode 项目

> ID：12133490
> 
> 赞同：4
> 
> 时间：2012-08-26T20:08:18.427
> 
> 标签：iphone, xcode, icloud

我最近买了一台 MacBook Pro，我将用它来开发 iPhone 应用程序。我希望能够在我的 Macbook 和 iMac 之间传输 Xcode 项目，就像使用 iCloud 传输 Word 文档一样。有没有一种安全的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-19T03:25:16.577

# iCloud 还是版本管理？

iCloud 对于同步 Xcode 项目听起来可能是个好主意，但它实际上会导致问题。您应该改用[git](https://en.wikipedia.org/wiki/Git_(software))。我建议使用免费的 bitbucket（在线 git repos）。您可以在 bitbucket 上托管私有或公共项目。因为免费的私人回购，我喜欢 bitbucket。GitHub 不提供免费的私有仓库！

## 易于分享

在一台机器上完成代码编辑后，您可以提交更改，然后将提交的更改推送到远程存储库。当您在另一台计算机上打开项目时，您必须从远程存储库中获取（拉取）它。

通过使用 git，您也可以轻松地与其他团队成员共享您的代码。

## 如何

在这里查看更多：

*   [启用对源代码存储库的访问](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/xcode_guide-continuous_integration/PublishYourCodetoaSourceRepository.html)

*   [保存项目更改](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/Xcode_User_Guide/085-Save_and_Revert_Changes_to_Projects/manage_project_changes.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:25:03.260

我正在使用[Dropbox](http://db.tt/Sr4Wu1O)在 2 个 Mac 上同步我的 xcode 项目。到目前为止我没有遇到任何问题，但我建议不要同时处理一个项目，因此请确保在一台机器上关闭它，然后再在另一台机器上打开它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-29T15:55:45.260

以下是我使用 iCloud Drive 作为远程 git 存储库的方法：

1.  例如，在本地目录中创建一个新的 Xcode 项目（打开 git 版本控制）`~/Xcode-Projects-Local/GiTest`
2.  将新的本地目录克隆到远程目录，例如 iCloud Documents：

    `git clone --bare --no-hardlinks ~/Xcode-Projects-Local/GiTest ~/Documents/Xcode-Projects/git/GiTest.git`

3.  将克隆的目录作为远程添加到本地存储库：

    `cd ~/Xcode-Projects-Local/GiTest`

    `git remote add -f iCloud ~/Documents/Xcode-Projects/git/GiTest.git`

4.  在另一台 Mac 上，将远程 repo 克隆到新的本地目录中：

    `git clone ~/Documents/Xcode-Projects/git/GiTest.git ./GiTest`

5.  享受！

对于现有项目，只需跳过步骤 1。请注意`--no-hardlinks`确保硬链接不会混淆 iCloud 驱动器的选项。

对于那些想知道“为什么不直接将项目目录直接放在 iCloud 驱动器上”的人：Xcode 一直存在并且——从 Xcode 10 开始——仍然存在问题，最终导致存储库损坏。

如果您计划在具有不同屏幕分辨率的机器上工作，例如 Macbook 和 iMac，您应该 git-ignore 名为`project.xcworkspace/xcuserdata`.

# html - 如何保持文本与文本区域的中间对齐？

> ID：12133492
> 
> 赞同：2
> 
> 时间：2012-08-26T20:08:33.273
> 
> 标签：html, css

```
<html>
<body>

This should be level with the middle of the box!
<textarea id="id" name="name" rows="9" cols="50">Text is in here!</textarea>

</body>
</html> 
```

[这最终看起来像什么的图片](http://gyazo.com/a62b9cadfb7732247917066da381d75c.png?1346011178)。

如何使框左侧的文本与框的中间保持水平，即使它被拖动也是如此？可以用 CSS 完成，还是需要 Javascript？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:11:33.270

最简单的方法（如果你想避免使用表格）是浮动标签并将其行高设置为等于 textarea 高度：

见[http://jsfiddle.net/pctVh/2](http://jsfiddle.net/pctVh/2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T20:29:07.593

您可以将`vertical-align`属性与`display: table-cell;`. 这是一个示例，HTML：

```
<div class = "wrapper">
    <div class = "text">
        I'm in the middle! Glee is awesome!
    </div>
    <textarea id="id" name="name" rows="9" cols="20">Text is in here!</textarea>
</div> 
```

CSS：

```
.wrapper {
    vertical-align: middle;
    display: table-row;    
}
.wrapper textarea {
    display: table-cell;
}
.text {
    display: table-cell;
    height: 100%;
    vertical-align: middle;
} 
```

还有一个小演示：[小链接](http://jsfiddle.net/aLecE/6/)。

我希望这有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-26T20:44:31.677

您需要将 text 和 textarea 都设置为`vertical-align: middle`. 示例 HTML：

```
.middletext {
  vertical-align: middle;
}

#id {
  vertical-align: middle;
}
```

```
<html>

<body>

  <span class="middletext">This should be level with the middle of the box!</span>
  <textarea id="id" name="name" rows="9" cols="50">Text is in here!</textarea>

</body>

</html>
```

If you want to set a width/height on the text, add `display: inline-block` to the `.middletext` class.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-26T20:26:12.503

这确实有效

```
<table>
<tr>
   <td valign="center">This should be level with the middle of the box!</td>
   <td>
         <textarea cols="40" rows="20">Text is in here!</textarea>
   </td>
</tr>
</table> 
```

# php - PHP 使用定义之前的变量

> ID：12133499
> 
> 赞同：0
> 
> 时间：2012-08-26T20:09:19.850
> 
> 标签：php, html, title

我有一个名为的文件`page.php`，它是这样的；

```
<? include "header.php"; ?>
<body>
...
</body>
<? include "header.php"; ?> 
```

在`<body>`标签之间，我运行一个 sql 查询并得到一个名为 as 的变量`$title`。我想将该变量显示为我的页面的 html 标题，该标题位于`header.php`.

我怎样才能做到这一点？

我只是尝试了我所说的，但它没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:11:38.860

在标签之前运行它`<body>`，将结果保存到一个变量中，然后在任何你想要的地方处理这个变量（作为标题和`<body>`标签中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:14:56.513

您应该尽量避免将 PHP 代码与 HTML 混合。在包含 header.php 之前运行 SQL 查询，将结果存储在变量中，并将标题存储在变量中。例如：

```
<?php
// SQL code here, store the data in e.g. $data and title in $title
include "header.php";
?>
<body>

<?php
// output page using $data
?>

</body>
<?php include "header.php"; ?> 
```

然后你的 header.php 将包含类似`<title><?php echo $title; ?></title>`

# android - FragmentActivity、AsyncTaskLoader、ListFragment 在重置/恢复时不加载/显示？

> ID：12133501
> 
> 赞同：0
> 
> 时间：2012-08-26T20:09:39.007
> 
> 标签：android, actionbarsherlock, android-fragmentactivity, asynctaskloader

替代标题：在清除后台内存后恢复时，不会绘制 ListFragment 内容。

您[可以试试](https://github.com/downloads/JakeWharton/ActionBarSherlock/actionbarsherlock-sample-fragments-4.1.0.apk)这个并[在此处查看源代码，](https://github.com/JakeWharton/ActionBarSherlock/blob/master/samples/fragments/src/com/actionbarsherlock/sample/fragments/LoaderCustomSupport.java)它是[Google 演示](http://developer.android.com/reference/android/content/AsyncTaskLoader.html)应用程序的 ActionBarSherlock 演示应用程序版本。

当您打开 ListFragment 并转到其他（使用应用程序的高内存）时。ActivityManager 将终止进程“不再需要......”如果您通过长时间按住 Home 按钮返回 Activity，则列表将重新加载，但随后出现“无应用程序”。

我找不到导致这种行为的任何原因，也许我是盲人，也许这是一个错误。我花了一些时间调试，在我看来应用程序已加载，但随后某些东西阻止它们显示。

在[第 469 行](https://github.com/JakeWharton/ActionBarSherlock/blob/master/samples/fragments/src/com/actionbarsherlock/sample/fragments/LoaderCustomSupport.java#L469)，我添加了一些调试消息。

```
 Log.d("onLoadFinished", data.get(0).getLabel()); 
```

在上述情况下，标签已正确记录，但出现“无应用程序”而不是列表。

有人可以向我解释一下，为什么会发生这种情况以及如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T23:05:37.980

该问题似乎与`SearchViewCompat`第 442 行有关。

当应用程序的内存在后台释放时恢复应用程序会触发`onQueryTextChange`带有过滤器的空适配器`null`，当加载器然后更新适配器时，项目仍然不会显示。

一种解决方法是打电话

```
mAdapter.getFilter().filter(null); 
```

`mAdapter.setData(data);`在之后`onLoadFinished`。

这可能是兼容性框架中的一个错误，我没有测试本机实现。

# c# - 使 GUI.Box 停留 3 秒

> ID：12133505
> 
> 赞同：1
> 
> 时间：2012-08-26T20:10:30.367
> 
> 标签：c#, user-interface, unity3d

我正在使用 C# 脚本在 Unity 中开发一个项目。GUI.Box 将出现在屏幕顶部。当玩家离开该地点时，该框将消失。玩家离开指定地点后，如何让盒子多停留 3 秒？

Danpe 的代码更正（工作代码）：

```
bool shown = false;

void OnGUI () {
if (car.transform.position.y>=43 && car.transform.position.y<=44)
{
    shown = true;
}
else if (shown)
{
    StartCoroutine(DisapearBoxAfter(3.0f)); 
}
if(shown) 
{
    GUI.Box(new Rect((Screen.width/2)-200,0,400,30) , "King of the hill");
}
}

IEnumerator DisapearBoxAfter(float waitTime) { 
// suspend execution for waitTime seconds
yield return new WaitForSeconds(waitTime);
shown = false;
}

void Update () {
    OnGUI ();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:17:55.963

```
bool shown = false;

void OnGUI () {
    if (car.transform.position.y>=43 && car.transform.position.y<=44)
    {
        shown = true;
    }
    else if (shown)
    {
        StartCoroutine(DisapearBoxAfter(3.0)); 
    }
    if(shown) {
        GUI.Box(new Rect((Screen.width/2)-200,0,400,30) , "King of the hill");
    }
}

IEnumerator DisapearBoxAfter(float waitTime) {
    // suspend execution for waitTime seconds
    return yield WaitForSeconds (waitTime);
    shown = false;
}

void Update () {
    OnGUI ();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T10:36:49.870

```
function Start ()
{
    ShowBox ();
}

function ShowBox ()
{
    // show label
    show = true;

    // cancel invoking method if already set to call after 3 seconds
    CancelInvoke("HideBox");

    // will call HideBox () after 3 sec
    Invoke ("HideBox", 3.0F);
}

function HideBox ()
{
   // dont show label
   show = false;
}

function Update ()
{
     if (car.transform.position.y>=43 && car.transform.position.y<=44)
     {
         ShowBox ();
     }
}

function OnGUI ()
{
     if(shown) 
     {
          GUI.Box(new Rect((Screen.width/2)-200,0,400,30) , "King of the hill");
     }
} 
```

# hibernate - em.persist 在具有现有但分离的 OneToOne 实体的新实体上的问题

> ID：12133508
> 
> 赞同：1
> 
> 时间：2012-08-26T20:10:51.940
> 
> 标签：hibernate, jpa, persistence

我在 JBoss AS 7.1 上使用 Hibernate，在创建新实体并将现有实体设置为 ManyToOne 关系时遇到问题。在使用以下代码之前查询现有实体（客户）：

```
TypedQuery<Customer> query = em.createNamedQuery("Customer.findByLastNameLike", Customer.class);
query.setParameter("lastName", "%"+lastName+"%");
return query.getResultList(); 
```

当我在设置为 order后`em.persist(order)`在新实体上执行时，会引发以下异常：`order``customer``order.setCustomer(customer)`

```
Caused by: org.hibernate.PersistentObjectException: detached entity passed to persist: erp.model.persons.Customer
    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:141)
    at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:717)
    at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:710)
    at org.hibernate.engine.spi.EJB3CascadingAction$1.cascade(EJB3CascadingAction.java:49)
    at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:380)
    at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:323)
    at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)
    at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:165)
    at org.hibernate.event.internal.AbstractSaveEventListener.cascadeBeforeSave(AbstractSaveEventListener.java:437)
    at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:266)
    at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:195)
    at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:138)
    at org.hibernate.ejb.event.EJB3PersistEventListener.saveWithGeneratedId(EJB3PersistEventListener.java:78)
    at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:208)
    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:151)
    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:78)
    at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:725)
    at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:701)
    at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:705)
    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:853) 
```

实体定义如下：

```
@Entity
public class Order extends AbstractEntity implements Serializable {

    private static final long serialVersionUID = -8061887078955032972L;

    @ManyToOne(cascade={CascadeType.MERGE, CascadeType.REFRESH, CascadeType.PERSIST}, optional = false)
    private Customer customer = null;

@Entity
@DiscriminatorValue("customer")
public class Customer extends Person implements Serializable {

    private static final long serialVersionUID = 2788107135840578322L;

    @OneToMany(cascade=CascadeType.ALL, mappedBy="customer")
    private List<Order> orders = null; 
```

在这种情况下有什么问题？

感谢您的任何提示...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:56:29.027

以下答案也回答了我的问题。我从使用更改`em.persist()`为`em.merge()`甚至用于新实体。现在我的整个对象图都成功地持久化了，无论是否混合了新实体。

[JPA 级联持续存在并且对分离实体的引用会引发 PersistentObjectException。为什么？](https://stackoverflow.com/questions/4294671/jpa-cascade-persist-and-references-to-detached-entities-throws-persistentobjecte)

此外，我删除了`CascadeType.PERSIST`

# .net - 在 Git 中，删除意外提交的 DLL 和 PDB 文件

> ID：12133510
> 
> 赞同：12
> 
> 时间：2012-08-26T20:11:04.573
> 
> 标签：.net, git

我有一个 git repo，我需要在没有冲突的情况下开始工作。它是 .net/c# mvc 存储库。问题是 dll 和 pdb 文件。这些文件被意外提交到了 repo，所以当我做我的初始时`git pull`，我得到了另一个开发人员提交的所有这些文件。

我已经设置了`.gitignore`这样的：

```
bin/
obj/
App_data/ 
```

从其他帖子中，我相信这就是我需要做的所有事情，但是，如果我构建我的项目并运行`git status`它，它会显示许多将要提交的 dll 和 pdb 文件。

这是因为当我克隆它时这些文件存在于仓库中吗？如果是这样，删除这些文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-26T20:19:24.917

您需要先删除这些文件 ( `git rm`)，然后才能看到您的`.gitignore`指令应用于您的 git 存储库。

如果要将这些文件保留在工作树上，则只能从索引中删除它们。

```
git rm -r --cached a.dll 
```

（参见“[`.gitignore`文件不忽略](https://stackoverflow.com/questions/1139762/gitignore-file-not-ignoring)”）

但是对于生成的文件，是否删除它们并不重要：您将在下一次编译时重新创建它们，但忽略它们，因为它们不再是索引的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-25T20:58:03.163

这是一个非常常见的问题，通常的答案是您无法清理过去的提交，但是有专门的工具可以解决这个问题。git 过滤器和更容易的 BFG repo 清洁器： [http ://rtyley.github.io/bfg-repo-cleaner/#usage](http://rtyley.github.io/bfg-repo-cleaner/#usage)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-30T12:49:05.093

您的 .gitignore 文件有错误。它应该是这样的：

```
bin
obj
App_data 
```

# dired - 如何在 IDO 模式下选择目录（不是文件），emacs-24

> ID：12133521
> 
> 赞同：23
> 
> 时间：2012-08-26T20:12:26.913
> 
> 标签：dired, emacs24, ido

IDO 模式很棒。了解基本快捷键非常重要，尤其是退出 ido 模式的逃生舱口 Ctrl-f ( [Introduction-to-ido-mode/](http://www.masteringemacs.org/articles/2010/10/10/introduction-to-ido-mode/) )。

实际上，如果我想将文件复制到目录，我似乎无法使用 ido 来选择目录，我什至不能使用我导航到的当前 ido 目录。应该有某种方式说“选择目录”或至少启用 ctrl-f 选项以使用 IDO 中的当前位置。有人知道怎么做这个吗？（是的，您可以为 dired 禁用 ido 模式，但这不是我想要做的）。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-16T13:34:41.260

您可以使用`C-j`, 它绑定`(ido-select-text)`并选择当前由提示命名的缓冲区，该缓冲区也可能是一个目录。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-09-06T08:42:12.650

您可以在 ido 模式下使用“Cd”，minibuffer

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-12-27T00:09:30.757

另一种方法是启用

```
(setq ido-show-dot-for-dired t) 
```

然后您可以通过打开文件来打开目录，该`.`文件将始终是您进入的目录的第一个条目。

# asp.net - css 复选框标签选择器

> ID：12133522
> 
> 赞同：3
> 
> 时间：2012-08-26T20:12:47.373
> 
> 标签：asp.net, asp.net-mvc-3, css, css-selectors

我正在开发一个 MVC3 应用程序，需要选择`checkboxes`标签。

在 ASP MVC3 中，您有创建部分代码的辅助方法。所以 a 的代码`checkbox`如下所示：

```
<input id="Jumping_successleicht" type="checkbox" value="true" name="Jumping_successleicht">
<input type="hidden" value="false" name="Jumping_successleicht">
<label for="Jumping_successleicht">
<span>leicht (4)</span>
</label> 
```

现在我想我可以使用以下代码来选择`label`：

```
input[type=checkbox] + label {
    background: url("../../Images/Controls/Checkbox.png") no-repeat scroll left center transparent;
    clear: none;
    cursor: pointer;
    margin: 0;
    padding: 5px 0 4px 24px;
} 
```

但它不起作用。它看起来像`label`并且`input`必须彼此相邻。

有没有人有解决方案如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T21:01:33.603

没有可用于`<label for="#">`普遍选择元素目标的 CSS 选择器。选择`+`器是“相邻兄弟”选择器。

有一些解决方法：

*   将`<input>`元素直接放在`<label>`元素中（这样就不需要`for=""`属性）。
*   看到每个都`<input />`需要`id=""`设置一个唯一的属性才能使用`<label for="">`，只需在样式表中通过它们的 ID 选择复选框。
*   为每个适当的输入分配类。
*   围绕每个输入及其标签创建包装器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T15:37:05.627

也许你可以试试这个？

```
 input[type="checkbox"] + label{
            background-color:red;
        } 
```

# couchdb - 如何还原couchdb中的更改？

> ID：12133523
> 
> 赞同：4
> 
> 时间：2012-08-26T20:12:55.337
> 
> 标签：couchdb

我在我的 couchdb 中对一堆文档进行了大规模编辑，但我犯了一个错误并且不正确地覆盖了一个字段。我可以看到以前的版本在那里。我如何恢复到它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:16:37.157

我目前的最佳猜测，~~基于此：~~

[http://guide.couchdb.org/draft/conflicts.html](http://guide.couchdb.org/draft/conflicts.html)

...是查找文档 ID 和修订 ID，然后为该文档发送删除，指定我想要删除的修订。

```
curl -X DELETE $HOST/databasename/doc-id?rev=2-de0ea16f8621cbac506d23a0fbbde08a 
```

我认为这将留下以前的修订。那里有更好的想法吗？

 ~~我不得不编写一些咖啡脚本（使用 underscore.js 和[jquery.couch](http://daleharvey.github.com/jquery.couch.js-docs/symbols/index.html)）来做到这一点。这不是真正的还原，因为我们正在获取旧版本并使用它创建新版本。仍在寻找更好的建议：

```
 _.each docsToRevert, (docToRevert) ->
        $.couch.db("databaseName").openDoc docToRevert.id,
          revs_info: true
        ,
          success: (doc) ->
            $.couch.db("databaseName").openDoc docToRevert.id,
              rev: doc._revs_info[1].rev #1 gives us the previous revision
            ,
              success: (previousDoc) ->
                newDoc = previousDoc
                newDoc._rev = doc._rev
                result.save newDoc 
```~~

# jquery - 如何将 jQuery 事件添加到所有当前和未来的元素？

> ID：12133525
> 
> 赞同：7
> 
> 时间：2012-08-26T20:13:02.583
> 
> 标签：jquery, binding, jquery-selectors, delegates

我刚刚注意到它`live()`在 jQuery 中已经被弃用了。我有一个快速的问题（只是为了确定哪种方法最有效、最快和最新）。我已经拥有`myfunction()`并且我想将`bind()`它用于所有当前和未来的元素`attr("title") == 'x'`。

这是我应该使用的：

```
jQuery("???").bind("mouseup", myfunction);
jQuery("???").bind("keyup", myfunction); 
```

或这个：

```
jQuery("???").delegate("???", "mouseup", myfunction);
jQuery("???").delegate("???", "keyup", myfunction); 
```

或这个：

```
jQuery("???").on("mouseup", "???", myfunction);
jQuery("???").on("keyup", "???", myfunction); 
```

我在指定正确的选择器时也遇到了问题——因为它们中的一些允许将事件附加到一件事（如正文或文档）上，并且它们允许第二个选择器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-26T20:16:44.007

[`.on()`](http://api.jquery.com/on/)改为使用属性[*等于选择器*](http://api.jquery.com/attribute-equals-selector/)：

```
$(document).on('mouseup', '[title="x"]', myfunction); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-26T20:15:10.720

替换的语法`.live()`是这样的：

```
$('#parent').on('keyup mouseup', '.children', myfunction); 
```

# latex - Ryacas 乳胶在 Knitr 中的表达

> ID：12133526
> 
> 赞同：3
> 
> 时间：2012-08-26T20:13:09.433
> 
> 标签：latex, knitr

我有以下 RYacas 表达式：

```
longrun_cost <- (c * mu) + h * ( lambda / (mu-lambda)) 
```

这个的latex表达式如下：

```
fmt <- sprintf("TeXForm(%s)", longrun_cost)
yacas(fmt, retclass = "unquote")

$c \mu  + \frac{h \lambda }{\mu  - \lambda } $ 
```

我希望能够以 knitr 可以理解的格式编写此方程式，但唯一的解决方案是将乳胶表达式复制到 knitr 为

```
$$c \mu  + \frac{h \lambda }{\mu  - \lambda } $$ 
```

当我组成​​一个 R 块时

```
```{r}
longrun_cost <- (c * mu) + h * ( lambda / (mu-lambda))
fmt <- sprintf("TeXForm(%s)", longrun_cost)
yacas(fmt, retclass = "unquote")

``` 
```

这没用。有任何想法吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-06-05T21:10:40.677

这里的挑战是处理字符串和引号。考虑以下`.Rmd`文件

```
---
title: "Ryacas \\LaTeX\\ Expression in Knitr"
output: pdf_document()
---

```{r, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

Set up chunk:
```{r} 
library(Ryacas)
longrun_cost <- expression((c * mu) + h * ( lambda / (mu-lambda)))
fmt <- sprintf("TeXForm(%s)", longrun_cost)
eqn_string <- sprintf("$%s$", yacas(fmt, retclass = "unquote"))
```

The next few chunks will show the different ways that the Ryacas expression
can be rendered.

# Chunk 1
A chunk with `results = "markup"`.
```{r}
eqn_string
```

# Chunk 2
A chunk with `results = "asis"`.
```{r, results = "asis"}
cat(eqn_string)
```

```{r}
print(sessionInfo(), local = FALSE)
``` 
```

产生以下输出：

[![在此处输入图像描述](../Images/2a77dc69d9041a990d6d1f1fa0da8759.png)](https://i.stack.imgur.com/oJibp.png)

# java - Java中超类数组中的子类

> ID：12133530
> 
> 赞同：2
> 
> 时间：2012-08-26T20:13:51.117
> 
> 标签：java, casting, arraylist

> **可能重复：**
> [是`List&lt;Dog&gt;`的子类`List&lt;Animal&gt;`吗？为什么 Java 的泛型不是隐式多态的？](https://stackoverflow.com/questions/2745265/is-listdog-a-subclass-of-listanimal-why-arent-javas-generics-implicit)

我有这个代码：

```
ArrayList<A> objects = new ArrayList<A>();

objects.add(new B()); 
```

`B`子类 o在哪里`A`。它给了我一个编译时错误，如下所示：

ArrayList 类型中的方法 add(A) 不适用于参数 (B)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-26T20:17:10.967

这编译并运行良好：

```
import java.util.ArrayList;

class A {
}

class B extends A {
}

class Test {
    public static void main(String[] args) {
        ArrayList<A> arraylist = new ArrayList<A>();
        arraylist.add(new B());
    }
} 
```

再看看你的代码。也许你把它倒过来并`A`延伸了`B`？

# javascript - 输入类型文本不允许输入或聚焦

> ID：12133535
> 
> 赞同：0
> 
> 时间：2012-08-26T20:14:08.563
> 
> 标签：javascript, html, textinput

**问题**

我有一个画布元素，在此之上我有一个带有文本输入的 div。文本输入将不允许我输入文本或显示光标或单击时成为焦点。

**我为自己解决问题而采取的步骤**

在探索了与此类似的其他问题后，我可以忽略以下原因：

*   div的z-index低于画布（我仍然可以看到输入框）

*   未正确设置定位（我已将 div 设置为 position: absolute）

*   在 css 中设置 select: none （我没有这个）

我无法粘贴所有代码，因为它太长了，但我可以发布相关部分：

setBuildingTileSet 是包含相关文本输入的 div。

**css**

```
#setBuildingTileSet {
    height: 200px;
    left: 50%; 
    bottom: 50%;
    margin: -100px 0 0 -200px;
    position: absolute;
    width: 400px;
    opacity: 0.7;
    background: #000;
    z-index:1;
    padding: 20px;
} 
```

**html**

```
<div id="container"></div>

<div id="setBuildingTileSet">
  <h1>Set Building TileSet </h1>
  <p><h2>Tileset name</h2></p>
  <input id="buildingTileSetName" type="text">
</div> 
```

**脚本**

```
canvas = document.createElement('canvas');
$('#container').append(canvas);
$('#container canvas')[0].id =('canvas');
context = canvas.getContext("2d");

canvas.width = 800;
canvas.height = 600; 
```

我完全卡住了，看不出为什么输入框不起作用。感谢您的帮助人们:)

**现在解决了 - 但解决方案会导致错误的原因仍然未知**

是的，经过大量使用我的代码后，我发现了“问题”。我有一个 mouseDown 事件侦听器，它在单击各种 UI 按钮时激活各种事物：

咖啡脚本

```
window.addEventListener 'mousedown', (e) =>
  button = e.which or e.button
  if button == 1 then @UIMouseDown(e) # Left mouse click
, false

UIMouseDown: (e) =>
  e.preventDefault() 
  ......etc 
```

**解决方案**我发现当我删除 e.preventDefault() 时，文本框允许我输入文本:)

**跟进问题** 有谁知道为什么 e.preventDefault() 会导致这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T09:46:25.480

要回答您的后续问题：

`e.preventDefault()`取消事件的默认行为。如果将其与其他事件进行比较，这是有道理的：

*   `click`：对于`<a href="...">`元素，浏览器不会*像默认*那样导航。
*   `submit`：对于元素，浏览器不会*像默认那样*`<form>`提交表单。
**   `mousedown`*: 浏览器不会像默认那样*进行mousedown过程（例如将焦点设置在鼠标光标当前所在的元素上）。*

# security - 防止指向不良域的超链接

> ID：12133538
> 
> 赞同：-1
> 
> 时间：2012-08-26T20:14:56.150
> 
> 标签：security, seo

我有一个论坛，用户可以发表评论，他们也可以启用/禁用和批准评论；但是，我不能总是相信用户会不赞成链接到不良域的评论。像这些：[http ://www.mywot.com/en/forum/3823-275-bad-domains-to-blacklist](http://www.mywot.com/en/forum/3823-275-bad-domains-to-blacklist)

我的问题分为两部分：

1.  如果用户确实像上面链接中那样超链接到“坏域”，我的论坛/论坛类别/论坛类别线程会受到惩罚，即使是这样，如果我在论坛线程中添加 no-follow链接？

2.  那里有免费的 API 服务，我可以请求获取坏域列表，然后我可以将它们从用户的帖子中过滤掉？

我可能是偏执狂，但这可能是因为我不太了解 SEO。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:38:04.380

实际的算法是不公开的，但这是我在“网络”中发现的。

1)[谷歌的网站管理员指南](http://support.google.com/webmasters/bin/answer.py?hl=en&topic=8522&answer=35769)说它可能会降低参与链接方案的网站的排名。作为链接方案的一个例子，他们给出了**“链接到网络垃圾邮件发送者或网络上的坏邻居”**。NoFollow 可能会或可能不会对它产生影响，但共识似乎是它不会。

2) 您可以使用[Google 的两个安全浏览 API](https://developers.google.com/safe-browsing/)中的任何一个来检查是否发现网站是网络钓鱼和/或恶意软件网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T10:33:54.843

如果您的网站链接到不良域名，那肯定会再次损害您的网站；它取决于传出链接比率。

我强烈建议从可以手动审核论坛帖子的活跃成员中招募论坛版主，并帮助您避免垃圾邮件。

我不确定，但许多论坛允许各种限制，例如： - 只有具有帖子数量的成员才能在论坛回复中保留链接 - 只有指定月/天的成员才能共享链接 - 论坛帖子中只允许特定数量的链接。

请检查可以帮助您限制用户的此类设施。

# php - 无法使用php上传文件

> ID：12133541
> 
> 赞同：-1
> 
> 时间：2012-08-26T20:15:08.130
> 
> 标签：php, file-upload

我正在尝试使用以下代码上传文件，但文件没有保存在所需的位置，也没有弹出错误。

php代码如下`

```
<?php

if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br />";
    echo "Type: " . $_FILES["file"]["type"] . "<br />";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";

    if (file_exists("upload/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],"upload/".$_FILES["file"]["name"]);

      echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
      }
    }
?> 
```

html代码是

```
<html>
<body>

<form action="index.php" method="post"
enctype="multipart/form-data">
<label for="file">Filename:</label>
<input type="file" name="file" id="file" /> 
<br />
<input type="submit" name="submit" value="Submit" />
</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:50:41.310

检查您要将文件存储到的文件夹的用户权限。

# android - 如何使新的 Activity 在 Android 中可见

> ID：12133547
> 
> 赞同：1
> 
> 时间：2012-08-26T20:15:30.943
> 
> 标签：android, android-activity

这可能看起来微不足道，但我不知道我的谷歌搜索中缺乏术语是如何产生的。我已经有一个主要活动，如下所示：

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Toast;

public class DroidPlayerActivity extends Activity {

    /**
     * Called when the activity is first created.
     */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    public void onClick(View v) {
        switch (v.getId()) {
            case R.id.all_songs:
                Toast.makeText(DroidPlayerActivity.this, "Pressed All Songs TextView", Toast.LENGTH_SHORT).show();
                new AllSongsActivity();//nothing shows up
                break;
            case R.id.recently_added:
                Toast.makeText(DroidPlayerActivity.this, "Pressed Recently Added TextView", Toast.LENGTH_SHORT).show();
                break;
            ...
        }

    }
} 
```

在我的`onClick(View v)`方法中，我检查了哪个`TextView`被按下并启动了一个新的实例`AllSongsActivity`，但是，什么都没有显示（活动不可见仍然显示我的主要活动）。这个`AllSongsActivity`类现在只是一个简单的*空白* `Activity`：

```
import android.app.Activity;
import android.os.Bundle;

/**
 *
 * @author David
 */
public class AllSongsActivity extends Activity{

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.all_songs);
    }

} 
```

因此，为了澄清我如何使`AllSongsActivity`我已经运行的可见`DroidPlayerActivity`（它是主要的）。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:18:52.080

您不会自己创建活动实例。相反，您调用`startActivity()`以启动活动：

```
startActivity(new Intent(this, AllSongsActivity.class)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:19:25.480

请查看有关 Intents 的文档。Intents 用于在 android 中启动另一个活动。

例如，

```
Intent intent = new Intent(this, AllSongsActivity.class);
startActivity(intent); // This will start AllSongsActivity activity 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T20:19:57.230

您必须向要启动的 Activity 发送 Intent，如下所示：

```
 Intent intent = new Intent(this, AllSongsActivity.class);
    startActivity(intent); 
```

编辑：已经回答！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-26T20:18:51.407

要从当前的 Activity 调用新的 Activity，您不能只实例化该 Activity 的类。您必须使用[意图](http://developer.android.com/reference/android/content/Intent.html)

像这样的东西：

[http://www.vogella.com/articles/AndroidIntent/article.html](http://www.vogella.com/articles/AndroidIntent/article.html)

您还应该查看 Android 官方文档，尤其是 API 指南，它为此类常见问题提供了大量信息：

[http://developer.android.com/guide/components/index.html](http://developer.android.com/guide/components/index.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T20:23:55.150

这是你应该做的：

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Toast;

public class DroidPlayerActivity extends Activity {

    /**
     * Called when the activity is first created.
     */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    public void onClick(View v) {
        switch (v.getId()) {
            case R.id.all_songs:
                Toast.makeText(DroidPlayerActivity.this, "Pressed All Songs TextView", Toast.LENGTH_SHORT).show();
                // ---- show next activity ----
                Intent intent = new Intent(DroidPlayerActivity.this, AllSongsActivity.class);
                startActivity(intent);
                break;
            case R.id.recently_added:
                Toast.makeText(DroidPlayerActivity.this, "Pressed Recently Added TextView", Toast.LENGTH_SHORT).show();
                break;
            ...
        }

    }
} 
```

# php - PHP+MYSQL编码，utf8_polish_ci

> ID：12133548
> 
> 赞同：0
> 
> 时间：2012-08-26T20:15:42.420
> 
> 标签：php, mysql, phpmyadmin

您好，我的脚本中的编码有问题。我的连接功能如下所示：

```
function connect()
{
    $conn = mysql_connect('192.168.1.127', 'mason_frik', 'difficultpassword');
    if (!$conn) 
    {
        die('Nie można się połaczyć!');
    }
    mysql_query("SET NAMES 'utf8'; COLLATE='utf8_polish_ci';");
    mysql_query("SET character_set_client = 'utf8'");
    mysql_query("SET character_set_results = 'utf8'");
    mysql_query("SET character_set_connection = 'utf8'");
    mysql_select_db('mason_konkursy');
} 
```

在我的数据库中，我到处都在使用 utf8_polish_ci。在我的脚本中，我从其他页面得到一些东西，我需要像这样在我的数据库中搜索它：//这个函数正在解析其他页面并获取 SPAN 的内部文本。

```
$question = GetSpanData($FirstQuestion, "dnn_ctr1975_ViewContestsContestNew_dc_question_lblQuestion");

$wyn = mysql_query('SELECT * FROM questions WHERE question="'.$question.'"'); 
$wynik = mysql_fetch_array($wyn, MYSQL_ASSOC); 
```

结果是布尔（假）。当我将查询复制到我的 phpmyadmin 并粘贴到 sql 时，它正在工作，但从我的脚本中却没有。你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:37:49.003

这一行是错误的：

```
mysql_query("SET NAMES 'utf8'; COLLATE='utf8_polish_ci';"); 
```

正确的[语法](http://dev.mysql.com/doc/refman/5.5/en/charset-connection.html)是：

```
SET NAMES 'charset_name' COLLATE 'collation_name' 
```

在您的情况下，代码将是：

```
mysql_query("SET NAMES 'utf8' COLLATE 'utf8_polish_ci';"); 
```

并阅读 egyal 发表的第一条评论：mysql_* 函数不应该再使用了，它们已被弃用，并将在未来的版本中从 PHP 中删除。

您可能在这行代码中错过了对 mysql_real_escape_string 的调用（我无法确定，这取决于函数的`GetSpanData`确切作用）：

```
mysql_query('SELECT * FROM questions WHERE question="'.$question.'"'); 
```

要正确转义数据，您必须使用[mysql_real_escape_string](http://php.net/mysql_real_escape_string)函数：

```
mysql_query('SELECT * FROM questions WHERE question="'.mysql_real_escape_string($question).'"'); 
```

# c# - C# 事件内存泄漏

> ID：12133551
> 
> 赞同：14
> 
> 时间：2012-08-26T20:15:58.590
> 
> 标签：c#, memory-leaks

这些未订阅的事件内存泄漏什么时候发生？我应该编写析构函数还是实现 IDisposable 来取消订阅事件？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-26T20:48:28.980

假设**A**引用**B**。此外，假设你认为你已经完成了**B**并期望它被垃圾收集。

现在，如果**A**是*可访问*的[1]，**B**将不会被垃圾收集，尽管“你已经完成了它”这一事实。从本质上讲，这就是*内存泄漏*[2]

如果**B**订阅了**A**中的事件，那么我们就会遇到同样的情况：**A**通过事件处理程序委托对**B**的引用。

那么，这是什么时候出现的问题呢？仅当引用对象可达时，如上所述。在这种情况下，当不再使用**Foo实例时****可能**会发生泄漏：

 **```
class Foo
{
    Bar _bar;

    public Foo(Bar bar)
    {
        _bar = bar;
        _bar.Changed += BarChanged;
    }

    void BarChanged(object sender, EventArgs e) { }
} 
```

**可能**存在泄漏的原因是在构造函数中传递的**Bar实例****可以**比使用它的**Foo**实例具有更长的生命周期。然后订阅的事件处理程序**可以**使**Foo**保持活动状态。

在这种情况下，您需要提供一种取消订阅事件的方法，以免发生内存泄漏。一种方法是让**Foo**实现**IDisposable**。这样做的好处是它清楚地向类消费者发出信号，他需要在完成后调用**Dispose()**。另一种方法是使用单独的**Subscribe()**和**Unsubscribe()**方法，但这并不能传达类型的期望——它们太可选了，无法调用和引入时间耦合。

我的建议是：

```
class sealed Foo : IDisposable
{
    readonly Bar _bar;
    bool _disposed;

    ...

    public void Dispose()
    {
        if (!_disposed)
        {
            _disposed = true;
            _bar.Changed -= BarChanged;
        }
    }

    ...
} 
```

或者：

```
class sealed Foo : IDisposable
{
    Bar _bar;

    ...

    public void Dispose()
    {
        if (_bar != null)
        {
            _bar.Changed -= BarChanged;
            _bar = null;
        }
    }

    ...
} 
```

另一方面，当引用对象**不可**访问时，**不会**有泄漏：

```
class sealed Foo
{
    Bar _bar;

    public Foo()
    {
        _bar = new Bar();
        _bar.Changed += BarChanged;
    }

    void BarChanged(object sender, EventArgs e) { }
} 
```

In this case any **Foo** instance will always outlive its composed **Bar** instance. When a **Foo** is unreachable, so will its **Bar** be. The subscribed event handler cannot keep the **Foo** alive here. The downside of this is that if **Bar** is a dependency in need of being mocked in unit testing scenarios, it can't (in any clean way) be explicitly instantiated by the consumer, but needs to be injected.

[1] [http://msdn.microsoft.com/en-us/magazine/bb985010.aspx](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx)

[2] [http://en.wikipedia.org/wiki/Memory_leak](http://en.wikipedia.org/wiki/Memory_leak)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-26T20:19:53.603

事件处理程序包含对声明处理程序的对象的强引用（在委托的`Target`属性中）。

直到事件处理程序被删除（或直到拥有该事件的对象不再被任何地方引用），包含该处理程序的对象才会被收集。

您可以通过在不再需要处理程序时（可能在 中`Dispose()`）删除处理程序来解决此问题。
终结器无济于事，因为终结器只有在它被收集后才会运行。**

# php - Varnish ESI 脚本可以获取位于（原始页面）上的页面吗？

> ID：12133554
> 
> 赞同：2
> 
> 时间：2012-08-26T20:16:18.657
> 
> 标签：php, varnish, esi

我有一个用 Varnish 缓存的 PHP 页面：[http://categories.php?name=NAME](http://categories.php?name=NAME)。它有一些 ESI 脚本，例如： < esi:include src="/esi.php" />

所有页面都有相似的页眉、页脚、侧边栏，所以我在进行 VCL 哈希时删除了 name=NAME，这样所有页面都可以获得相同的缓存。

问题是我想在 esi.php 脚本中知道哪个页面发出了 ESI 请求。是 categories.php?name=A 还是 categories.php?name=B ？

我怎样才能做到这一点？我在任何地方都没有找到这些信息。

我在想它可能在 HTTP REFERER 中，但事实并非如此。:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-24T08:01:39.363

同样的问题，同样的状态。为了解决这个问题，我将父 URL 作为参数添加到 ESI URL：

```
<esi:include src="/esi/content/?url=http://mysite.com/parent/page/" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-18T01:07:07.013

在 vcl_recv 中试试这个：

```
if (req.esi_level == 0) {
    set req.http.X-Esi-Parent = req.url;
} 
```

这将导致与此主请求相关的所有 esi 请求在名为“X-Esi-Parent”的请求标头中发送原始 url，该标头可以在后端读取。

**更新**

评论中的 Aleksandr 正确地指出这不起作用，因为在 vcl_recv 中设置的标头不会出现在后续的 esi 请求中——只有来自客户端的标头。一些人在 listserv 上提出了类似的问题，但没有得到回答：

[https://www.varnish-cache.org/lists/pipermail/varnish-misc/2012-February/021706.html](https://www.varnish-cache.org/lists/pipermail/varnish-misc/2012-February/021706.html)

[http://marc.info/?l=varnish-dev&m=135273366517518&w=2](http://marc.info/?l=varnish-dev&m=135273366517518&w=2)

因此，如果您想在所有查询字符串组合中缓存包含 esi 标签的响应，似乎没有办法做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-11T19:37:23.390

从[Varnish 4.1](http://www.varnish-cache.org/docs/4.1/reference/vcl.html#req-top)开始，您可以：

```
 if (0 < req.esi_level && req_top.url ~ "found/in/parent/url") {
     ...
 } 
```

# java - Java 小程序未加载；“开始：应用程序未初始化”

> ID：12133560
> 
> 赞同：0
> 
> 时间：2012-08-26T20:16:53.363
> 
> 标签：java, applet, awt, runtime-error

我不太明白这个。我下载了一个类，把它放在我的网站上，然后用基本的小程序标签创建了一个 HTML 页面，应用程序显示得很好。

但是当我下载源代码并自己编译时，我的网站上显示的只是一个空白小程序，浏览器底部出现错误“启动：应用程序未初始化”。

我尝试编写更简单的代码，例如

```
import java.awt.*; 
import java.applet.*;

public class GuiExamplar extends Applet { 
    Button okButton; 

    public void init() { 
    setLayout(null); 
        okButton = new Button("A button"); 
        okButton.setBounds(20,20,100,30); 
    add(okButton); 
    }
} 
```

它做同样的事情。它编译得很好，但没有显示在我的浏览器上。

实际上，我的任何浏览器。我尝试过 Opera、Firefox 和 Chrome。但小程序只显示一个空白的灰色方块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-19T17:06:56.707

此类不作为小程序启动，因为它不扩展 JApplet 或 Applet。

即使解决了这个问题，applet 客户端中也不会出现任何内容。小程序不调用 main 方法，而是调用 init。也不要为小程序组件创建新框架 - 将它们添加到小程序容器本身。

# javascript - 图书馆设计 | 多个开发人员的代码组织

> ID：12133566
> 
> 赞同：2
> 
> 时间：2012-08-26T20:17:57.133
> 
> 标签：javascript

我在一个名为 Foo.js 的文件中完成了一个个人项目

我的 JavaScript 的其余部分我想外包、众包等……

我该如何组织？

我熟悉 ANT（构建工具），但一开始想手动做一些没有任何预处理的事情。

从概念上讲，您如何组织来自多个人的代码？

最终的 Web 应用程序将有一个 .js 文件。如果使用/需要多个文件（作为答案的一部分），它们将被手动连接。

应用程序封装在 IIFE 中，模型、视图、控制器和支持模块在 IIFE 的本地范围内实现为对象。

伪代码是（用于主库/应用程序文件）Foo.js

```
// Foo.js
(function(){
    var Mo = {},
        Vi = {},
        Co = {},
        Su = {};
})() 
```

我目前计划做的是将每个开发人员与单个 .js 文件相关联，比如...`user.js`

伪-

```
// User.js
Mo.MyObject = {
}
Co.MyObject = {
}
.
. 
```

一旦所有代码都完成......连接（使用我自己的工具或手动），缩小它，然后压缩它。

我目前对使用任何工具或库不感兴趣。

我在找资料。关于如何在考虑可维护性、健壮性和可扩展性的情况下进行概念组织。

这是为 Web 应用程序组织 JavaScript 的好方法吗？

# jquery - base64编码的动画gif作为css背景？

> ID：12133577
> 
> 赞同：9
> 
> 时间：2012-08-26T20:19:11.393
> 
> 标签：jquery, css, animated-gif

我有一个动画 gif 编码到我的 css 中，如下所示：

```
.magicBg {
background-image: url(data:image/gif;base64,R0lGODlhAQBkAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0ND ...
} 
```

这个动画 gif 被编码为播放一次。

但是，一旦这个动画 gif 作为元素的背景播放一次，它就再也不会播放了。使用

```
$('body').removeClass( 'magicBg' );
$('body').addClass( 'magicBg' ) 
```

没有效果——我们从 gif 的最后一帧开始。每次添加课程时如何从一开始就进行此游戏的任何想法？

不幸的是，[另一个答案建议](https://stackoverflow.com/questions/7568855/restart-animated-gif-as-background-image)使用一些随机 url 参数从服务器重新加载 gif。las，这不适用于我的情况，因为我将图像编码到 css 本身。你可以为base64数据添加一个随机日期戳吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-01T14:55:46.730

您可以向数据 url 添加额外的虚假字段以强制重播动画 gif：

```
//use date timestamp to ensure no duplicates
url(data:image/gif;bogus:ABCDEF;base64,R0lGODlhA...); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-27T07:46:14.583

很高兴看到嵌入`base64`编码*加载 gif*的趋势正在起飞！

回到手头的问题，你的背景声明中有一个很常见的错字[，为你解决了这个问题](http://jsfiddle.net/ovfiddle/nfajy/16/)。以下：

~~`base64,R0lGODlhEAAQAOMAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkv/////////////////////...`~~

应该是

`base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwE...`

不过说真的，您可能只是对损坏的文件进行了编码（如果您使用的是在线编码工具，这并非不可能）。

为了解决这个问题，我首先下载了您嵌入的文件（在 Firefox 上*右键单击 > 查看背景图像 > 右键单击​​ > 另存为... ）。*该图像也无法正确渲染：![没有](../Images/594b1b7df0c5234ec1d929d05132f19f.png)

有趣的是，当我将它上传到[SO imgur](https://i.stack.imgur.com/3WkLY.gif)时，它在 Finder 文件预览中看起来还不错。破指数？文件上传过早终止？我对 GIF 格式的技术知识知之甚少，无法提供超出推测的见解，但我已经对固定文件进行了编码。

**注意：**不需要在`url()`

# c# - 项目符号列表超链接样式 Asp .net

> ID：12133578
> 
> 赞同：2
> 
> 时间：2012-08-26T20:19:18.257
> 
> 标签：c#, asp.net, css

```
<asp:BulletedList ID="BulletedList1" runat="server" DisplayMode="HyperLink" style="list-style :none" > 
```

我正在将列表项动态添加到上面的项目符号列表中。如何为每个列表的 href 添加样式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:34:37.120

您可以传递 css-class 属性：

声明式：

```
<style>   
    class1 {  text-decoration:none; font-weight:bold; color:#e00000; }
    ... 
</style>

<asp:BulletedList ID="BulletedList1" DisplayMode="HyperLink" runat="server">
  <asp:ListItem class="class1">a</asp:ListItem>
  <asp:ListItem class="class2">b</asp:ListItem>
</asp:BulletedList> 
```

以编程方式：

```
protected void Page_Load(object sender, EventArgs e)
{
   ListItem listItem = new ListItem("c");
   listItem.Attributes.Add("class", "class1");
   BulletedList1.Items.Add(listItem);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:36:30.780

如果您将列表项动态添加到 BulletList，那么您可以通过这种方式将样式添加到列表项的

```
listItem1.Attributes.Add("Class", "NameOfTheClass"); 
```

或者

```
listItem1.Attributes.Add("style", "YourInlineCss"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T22:17:07.093

我已经通过添加一个 jQuery 选择器事件来解决这个问题。

```
$("<%=BulletedList1.ClientID%> li a").each(function() { 
    $(this).addClass('ClassName')
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T20:56:40.260

尝试这个：

文件.css：

```
.href a:link a:visited
{
    color: Red;
}

.href a:hover
{
    color: Yellow;
    text-decoration: none;
}

.href a:active
{
    color: Green;
} 
```

代码.aspx：

```
<asp:BulletedList ID="BulletedList1" runat="server" 
        DataSourceID="SqlDataSource1" DataTextField="nome" DataValueField="id" 
        DisplayMode="HyperLink" CssClass="href">
    </asp:BulletedList> 
```

版本交互：

```
for (int i = 0; i < BulletedList1.Items.Count; i++)
{
        if (i % 2 == 0)
        {
            BulletedList1.Items[i].Attributes.CssStyle.Value = "href";
        }
        else
        {
            BulletedList1.Items[i].Attributes.CssStyle.Value = "other";
        }
} 
```

# c# - 处理游戏输入

> ID：12133579
> 
> 赞同：0
> 
> 时间：2012-08-26T20:19:18.210
> 
> 标签：c#, event-handling, keypress, slimdx

所以我在 SlimDX 中的基本 2d 游戏框架进展顺利。我创建了一个自定义 Sprite 对象，并且对渲染精灵有一些基本的掌握。我现在只需要移动它们。

我有一个基本的游戏循环设置，它基于一本旧的 C# 游戏编程书。设置好所有图形设备位和鲍勃，并在屏幕上绘制我的精灵后，我在我的 Game 类中输入了一个名为`Run()`. 这有以下内容：

```
public void Run()
{

    while( this.Created )
    {
        // Process one frame of the game
        ProcessFrame();
        Render();
        // Handle all events
        Application.DoEvents();
    }
} 
```

`ProcessFrame()`应该包含所有游戏逻辑，以响应事件。虽然我设置了一个简单的事件处理程序（基于 的覆盖`OnKeyDown`）来检测按键，但我想知道如何收集按键以便我可以在`ProcessFrame()`方法中处理对它们的响应。

关于这个主题的一些初步研究建议创建一个`HashSet<Keys>`. 我以前从来没有这样做过，所以我不确定我会怎么做。

可能有很多方法可以做到这一点，所以我想我会先看看人们会推荐什么，然后再跳进去。

提前谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:54:27.020

我不相信您需要手动捕获输入。这通常由直接输入键盘类处理。我个人自己还没有使用过 SlimDX，但由于它是 DirectX 的包装器（我已经涉足过），您只需要初始化一个变量来保存对键盘的引用，以便您可以轮询它以进行更改，然后对这些变化采取行动。

[http://slimdx.org/docs/#T_SlimDX_DirectInput_Keyboard](http://slimdx.org/docs/#T_SlimDX_DirectInput_Keyboard)

这样你就可以编写类似的代码

`if (myKeyboard.IsKeyDown(Keys.Escape)) { ProgramStatus = GameState.Title; }`

假设我的参考变量被称为 myKeyboard。

编辑：我可能还会提到，根据您使用的特定库，保存当前和以前的键盘状态可能是有益的。当您想确保程序只接受一次击键而不是多次击键时，这非常有用。

我记得 XNA 有一个用于控制器的 KEYDOWN 方法，用于测试按钮是否被按住。如果您需要在每次按下按钮时都输入一个输入。IE，如果您的库有 Keypress 方法，那很好，如果它仅捕获 KEYDOWN，您可能需要捕获当前和以前的方法。

 `````
 if (myMouse.LeftButton == ButtonState.Pressed && oldMouse.LeftButton == ButtonState.Released) 
`````

# javascript - 编写可测试的 JavaScript 代码

> ID：12133582
> 
> 赞同：2
> 
> 时间：2012-08-26T20:19:21.917
> 
> 标签：javascript, js-test-driver

我开始深入研究 JavaScript 的一些工作，并且试图了解我应该如何编写可测试的 JS 代码。我的背景主要是 Java，我很熟悉，但我没有 JavaScript 经验。经过一番阅读，我打算使用 js-test-driver 作为我的单元测试框架，但我也愿意接受这里的建议。在 Java 中，我的方法一直是将事物分解为接受某些内容并返回某些内容的小方法……在 JavaScript 中，我想我会采取类似的方法，将任何 DOM 操作和实际逻辑分离为 2 个单独的函数。例如：

```
function sumValues(valA, valB) {
return (valA + valB);
}

function displayResult(result) {
document.getElementById('result').innerHTML = 'result';
} 
```

因此，任何业务逻辑都可以轻松测试。

我是在正确的轨道上还是有更好的方法来做事？关于这个主题的任何推荐阅读是 JS 特定的？感谢您的任何想法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T08:07:23.160

当然，将代码分解为逻辑单元仍然适用于 JavaScript。至于您将如何准确地构建代码和组织可重用性，有许多不同的方法可供选择 - 太多无法在此处列出，也取决于个人喜好。从原型继承，到伪经典继承；使用框架，如[骨干](http://backbonejs.org/).js ，[angular.js](http://www.angularjs.org/)，[require.js](http://requirejs.org/)，[yui](http://yuilibrary.com/)，[google 闭包](https://developers.google.com/closure/)......

关于您的示例，您可能会开始将代码分成可单独测试的视图和控制器，并且只有视图操纵 DOM。我会查看[backbone.js](http://backbonejs.org/)了解更多信息。

一本真正帮助我开始使用 JavaScript 进行测试驱动开发（同时也学习 JavaScript）的书是Christian Johansen 的[Test-Driven JavaScript Development](http://tddjs.com/)。

我正在使用 JsTestDriver，它是一个很棒的软件，而且绝对好用。但在大规模使用它之前，我也会评估其他产品，因为最近 JsTestDriver 的开发进展非常缓慢[。Buster.JS](http://busterjs.org/)看起来很有希望。另一个有趣的运行程序是[Testem](https://github.com/airportyh/testem)，它允许您使用不同的测试框架，例如[Mocha](http://visionmedia.github.com/mocha/)和[Jasmine](http://pivotal.github.com/jasmine/)。

我也可以推荐[Sinon.JS](http://sinonjs.org/)作为模拟工具包。

# git - 在预提交挂钩期间运行 Git 的 shortlog 命令失败

> ID：12133583
> 
> 赞同：2
> 
> 时间：2012-08-26T20:19:22.653
> 
> 标签：git, shell

我正在尝试使用 Git 预提交挂钩来运行一些样式检查并自动生成一个 AUTHORS 文件，该文件使用 git shortlog 提取所有贡献者的名称。

我的预提交脚本包含以下内容：

```
#!/bin/sh
set -e

bin/update-authors.sh
... 
```

update-authors.sh 文件包含以下内容：

```
#!/bin/sh
set -e

# Get a list of authors ordered by number of commits
# and remove the commit count column
AUTHORS=$(git --no-pager shortlog -nse | cut -f 2-)
if [ -z "$AUTHORS" ] ; then
    echo "Authors list was empty"
    exit 1
fi

# Display the authors list and write it to the file
echo "$AUTHORS" | tee "$(git rev-parse --show-toplevel)/AUTHORS" 
```

后一个脚本可以直接从终端正常工作，但仅在预提交挂钩期间，它会因“作者列表为空”而出错。我无法弄清楚它为什么这样做 - 有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:43:42.583

我认为在执行`pre-commit`钩子时，git 将树保持在半分离状态，这就是为什么它什么也得不到。如示例 pre-commit 钩子中所示，您需要显式传递一些分支/提交，例如：

```
AUTHORS=$(git --no-pager shortlog -nse HEAD | cut -f 2-) 
```

# batch-file - 获取文件大小的命令

> ID：12133592
> 
> 赞同：3
> 
> 时间：2012-08-26T20:20:33.923
> 
> 标签：batch-file, windows-7, filesize

谁能告诉我一个适用于 Windows 7 的 shell 命令，该命令将文件路径作为参数并返回该文件的大小 - 类似于：

```
fileSize.cmd file.txt 
```

...这会给我`1KB`。

SO中的一个问题指出了 command `echo %~z1`，但为此，我必须编写一个单独的批处理文件并在其中使用此命令。我正在考虑修改我现有的 bat 文件并以某种方式合并此命令。我的批处理文件如下所示：

```
p4 diff //sources/j2cs/output.txt >> diff_out.txt 
```

我必须在现有的 bat 文件中添加上述命令才能找到`diff_out.txt`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-26T20:34:24.090

您不需要额外的批处理文件，您可以通过调用函数将文件名移动到 %1 中，或者您可以使用 FOR 循环。

```
call :getFilesize diff_out.txt
echo %fileSize%
exit /b

:getFilesize
set filesize=%~z1
exit /b 
```

或者

```
for %%A in (diff_out.txt) do set fileSize=%%~zA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T11:35:05.350

另一种变体：

```
@echo off

set file=c:\bookmarks.html

%1 %0 :: %file%
set len=%~z2
echo %len% 

pause 
```

或使用 wmic：

```
D:\>set wql="drive='g:' and filename='function2' and extension='txt'"

D:\>wmic path cim_datafile where %wql% get name,filesize
FileSize  Name
621       g:\function2.txt

D:\> 
```

或者：

```
set file=G:\function2.txt

echo set len=%%~z1 >_tmp.bat
call _tmp.bat %file% && del _tmp.bat
echo %len% 
```

# php - 在 HTML 字符串中回显 PHP 代码

> ID：12133593
> 
> 赞同：1
> 
> 时间：2012-08-26T20:20:35.577
> 
> 标签：php, codeigniter

我正在尝试通过模板变量显示一大段 HTML 文本，但它似乎没有处理 PHP。我目前在我看来使用它（这是codeigniter）

```
<?php dump($_SESSION); echo (isset($html) && !empty($html)) ? $html : show_404(); ?> 
```

HTML 包含几个带有 php 标签的位置，我希望在页面回显时加载这些位置。有没有办法做到这一点？

我需要它从我传入的 HTML 变量中工作的主要原因是因为这是页面创建者的一部分，我需要能够在其中插入不是每个页面中的 php 条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:25:53.920

有一种方法可以做到，但这很糟糕：`eval()`

```
echo (isset($html) && !empty($html)) ? eval($html) : show_404(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:37:56.213

我会亲自`ob`从一个文件中提取它，对其进行缓冲，然后使用它`get_ob_clean`来获取结果，如下所示：

```
 ob_start();
        include 'temp_file_with_html_in';
        $view = ob_get_contents();
    ob_end_clean(); 
```

笔记：

*   你的英语不清楚，所以我不确定你想要什么
*   这可能无法完全按照您的意愿工作

也许更好地解释什么`$html`是什么以及它的来源会有所帮助？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:37:21.547

*我能想到的最快方法（尽管如果我知道如何* 创建可能会找到更好的解决方案`$html`）是将内容放入 tmp 文件中，然后包含它。然而，这确实是一个警告标志，表明程序存在架构问题（例如，为什么在创建 $html 时不能进行 php 插值？）

```
$tmpFile = tempnam('/tmp', 'my_app_namespace');
file_put_contents($tmpFile, $html);
include $tmpFile;
unlink($tmpFile); // cleanup 
```

# 编辑，来自 Drupal 7

正如您在评论中暗示的那样，Drupal 7 确实包含我称之为技巧的东西：在您传递给的代码前添加一个 PHP*结束*`eval`标记，然后它将像常规 php 包含一样处理它：

从 Drupal 7 的 ./modules/php/php.module 中，大约第 79 行，做了一点修改：

```
ob_start();
print eval('?>' . $html);
$output = ob_get_clean(); 
```

# vim - VIM如何用偏移量代替

> ID：12133594
> 
> 赞同：1
> 
> 时间：2012-08-26T20:20:45.263
> 
> 标签：vim, offset, substitution

vim 中的搜索命令允许您相对于搜索结果放置光标。例如，`/hello/b+2`将光标放在第一个`l`.

如何使用替换命令执行此操作？

```
s/hello/b+2/_/ 
```

不起作用。

我需要它来替换不是整个搜索字符串，而只是替换其中的一部分（特别是，除了单词的第一个字符之外，将所有字符都删除）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-26T20:23:26.820

您通常有两个选择：类似于其他正则表达式引擎零宽度匹配（尽管使用不同的语法）：

```
:s/\(he\)\@<=llo/_/ 
```

或特定于 vim 的“在此处设置比赛的开始”：

```
:s/he\zsllo/_/ 
```

. 此外，还有一种解决方法，在几乎所有其他正则表达式引擎中看起来都相似：

```
:s/\(he\)llo/\1_/ 
```

：这会捕获应该不变的文本并让替换包含它。

# objective-c - 从服务器加载图像时为黑色

> ID：12133597
> 
> 赞同：0
> 
> 时间：2012-08-26T20:21:04.570
> 
> 标签：objective-c, ios

我的应用程序出现了奇怪的行为，从服务器加载了一张图片`UIView`：

```
[self.imageFrame addSubview:self.myImage]; 
```

myImage 是从`UIImageView`类扩展的类的实例。第一次加载图像很好，但第二次，我得到了黑色背景，第三次很好，第四次是黑色背景，依此类推。

我尝试在调试器中打印图像描述，所以第一次，当图像正确加载时，我得到了这个描述：

```
(EGOImageView *) $7 = 0x0c940e80 <CustomImageView: 0xc940e80; baseClass = UIImageView; frame = (8 5; 72 72); clipsToBounds = YES; opaque = NO; layer = <CALayer: 0xc940f80>> 
```

第二次，当我得到黑色图像背景时，我得到的描述是：

```
(EGOImageView *) $8 = 0x0c9bfec0 <EGOImageView: 0xc9bfec0; baseClass = UIImageView; frame = (8 5; 72 72); clipsToBounds = YES; opaque = NO; layer = <CALayer: 0x1043dea0>> 
```

描述和你看到的一样。但我不知道可能导致问题的原因。有什么建议吗？提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T11:52:08.660

在您的示例输出中，您的评论说两个日志消息都应该是 EGOImageView - 只是为了说明这一点 - 所以两个日志消息本质上是相同的。

根本问题是当你得到一个黑色视图时，你的代码没有设置 UIImageView 子类的图像属性。

我的建议是做几件事：

*   将 UIImageView 子类的背景颜色设置为某种定义的颜色（即红色、绿色、蓝色等）。如果您有不同的图像“类别”或设置图像的方式，请为每个图像使用不同的颜色。当你得到一个空白的 imageView 时，这可能会给你更多的线索。

*   在您的日志消息中记录图像属性。

编辑：

*   加载图像时，请确保 imageview 的框架具有适当的大小（并且至少具有一定大小）[我已经解决了几个问题，但设置了适当的框架）。

# vb.net - 不在 vb.net 中保存 .txt 文件

> ID：12133600
> 
> 赞同：0
> 
> 时间：2012-08-26T20:21:26.683
> 
> 标签：vb.net, text, streamwriter

切入正题：

```
Function Create(ByVal network, ByVal location, ByVal type, ByVal requirement1, ByVal requirement2, ByVal requirement3, ByVal name)
    Dim net As String = network
    Dim loc As String = location
    Dim typ As String = type
    Dim nam As String = name
    Dim req1 As String = requirement1
    Dim req2 As String = requirement2
    Dim req3 As String = requirement3
    Dim Mission As New System.IO.StreamWriter("C:\" & nam & ".txt")
    Mission.WriteLine("Name: " & net)
    Mission.WriteLine("Network: " & net)
    Mission.WriteLine("Location: " & loc)
    Mission.WriteLine("Type: " & typ)
    Mission.WriteLine("Requirement: " & req1)
    Mission.WriteLine("Requirement: " & req2)
    Mission.WriteLine("Requirement: " & req3)
    Mission.Close()
    Console.WriteLine("Written")
    System.Threading.Thread.Sleep(3000)
End Function 
```

没有出现错误，但文件路径中的文件也没有出现。我在调用函数时已经声明了所有内容，所以我知道这不是问题所在。帮助？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T05:52:16.880

```
Sub Create(ByVal network As String, ByVal location As String, 
    ByVal type As String, ByVal requirement1 As String, 
    ByVal requirement2 As String, ByVal requirement3 As String,
    ByVal name As String)

    Dim net As String = network
    Dim loc As String = location
    Dim typ As String = type
    Dim nam As String = name
    Dim req1 As String = requirement1
    Dim req2 As String = requirement2
    Dim req3 As String = requirement3
    If Not nam.EndsWith(".txt") Then
        nam &= ".txt"
    End If
    Dim Mission As New System.IO.StreamWriter(Path.Combine(
      System.Environment.GetFolderPath(
      System.Environment.SpecialFolder.Desktop), nam))
    Mission.WriteLine("Name: " & net)
    Mission.WriteLine("Network: " & net)
    Mission.WriteLine("Location: " & loc)
    Mission.WriteLine("Type: " & typ)
    Mission.WriteLine("Requirement: " & req1)
    Mission.WriteLine("Requirement: " & req2)
    Mission.WriteLine("Requirement: " & req3)
    Mission.Close()
    Console.WriteLine("Written")
    'System.Threading.Thread.Sleep(3000)
End Sub 
```

首先，朋友，您将参数作为对象传递！！，其次，除非您具有管理员权限，否则您无权保存到 c 根目录，第三，最后的线程部分完全没用，它会阻塞 UI，不要'没有任何好处。
最后但并非不重要。
祝你好运

# html - 将 video.js 与动态创建的视频标签一起使用

> ID：12133602
> 
> 赞同：3
> 
> 时间：2012-08-26T20:21:41.767
> 
> 标签：html, html5-video, video.js

我目前正在使用 video.js 来处理来自 html5 视频的 flash 回退。当用户单击我网站上的缩略图时，我会动态地（使用 js/jquery）创建所需的 html 并将其插入到 jquery ui 对话窗口中，然后使用 html5 或 flash 回退显示视频。以下是相关代码：

```
 //setup jquery ui dialog window 
    $( "div#video_box" ).dialog({
            autoOpen: false,
            modal: true,
            width: 'auto',
            resizable: false,
            draggable: true,
            close: function() {
                $("video").remove()
            }
         });

    //the following code runs after a video thumbnail click event.  
{
    var $videoBox = $("div#video_box"),
    url = VIDEOSTORAGE + id ,  //url to s3 storage bucket + id of the video/thumbnail that was clicked
    html ="";
    html += "<video id='downloadedVideo_"+id+"' class='video-js vjs-default-skin' width='320' height='240' controls preload='auto' width='640' height='264' poster='"+PHOTOSTORAGEMEDIUM + id'>";
    html += "<source src='"+url+".mp4' type='video/mp4' />";
    html += "</video>";
    $videoBox.html(html);
    $("#downloadedVideo_"+id).load();
    $videoBox.dialog( "open" );
    _V_("downloadedVideo_"+id);  //initialize video player
} 
```

首次单击视频缩略图时，此代码可在所有浏览器上完美运行。当用户点击他已经观看过的视频的视频缩略图时，我的错误就会触发。

在 FF 中，我在第二遍时收到“未找到支持的 mime 类型的视频”错误。chrome 和 safari 在第二遍加载和播放视频；但这样做使用他们的默认 html5 播放器而不是 video.js 播放器。

我认为我的问题是 video.js 必须使用唯一的视频标签 id 进行初始化，并且当用户第二次单击视频缩略图时，我的代码会尝试使用它已经使用过的视频标签 id 来初始化播放器。

有谁知道避免这个问题的干净方法？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T20:35:27.110

我通过只创建一个视频播放器实例（而不是为每个新视频创建一个新实例）解决了这个问题。然后，我使用 video.js 的 src 方法动态更改该播放器的 src 属性。

首先，我创建了一个初始化的全局变量来保存视频播放器实例 ( `var videoPlayer = _V_("downloadedVideo)`)。然后我用以下代码替换了旧的视频缩略图点击事件代码：

```
`           var $videoBox = $("div#video_box"),
                url = VIDEOSTORAGE + id + "/" + encodeURI(post.video_file_name.split(".")[0]);    
            $videoBox.dialog('option', 'title', post.video_file_name);
            $videoBox.dialog('option', 'position', ["center", 100]);
            $videoBox.dialog( 'open' );
            $(video).attr('poster', PHOTOSTORAGEMEDIUM + id + "/" + post.photo_file_name);
            videoPlayer.src({type: 'video/mp4', src: url + '.mp4'});` 
```

现在 video.js 正在所有现代浏览器上工作，除了移动 safari。由于某种我无法弄清楚的原因，移动 safari 不会加载/播放任何视频。我只是得到一个空白播放器，“加载”图像绕了一圈。它甚至不会在海报属性处加载图像。我可能会在今天晚些时候就此单独发表一篇文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T18:46:37.323

是的，看起来播放器仅在第一次呈现时才被识别，因此每次将播放器 HTML 加载到 DOM 时，您都需要您的代码来确认它是 videoJS 播放器。

查克好像有。除此以外：

我所做的是将播放器加载到 DOM 中一次，如果不需要则将其隐藏，在加载新的 src 以进行播放时显示它。

希望这可以帮助！

# facebook - Facebook iOS SDK 3.0：如何对现有 URL 进行评论？

> ID：12133603
> 
> 赞同：2
> 
> 时间：2012-08-26T20:21:52.410
> 
> 标签：facebook, facebook-graph-api, facebook-comments, facebook-ios-sdk

有没有人尝试使用新的 Facebook SDK 向 URL 发表评论？我尝试使用这样的 startForPostWithGraphPath （从 Scrumptious 项目中挑选的代码片段）：

```
id action = [FBGraphObject graphObject];
[action setValue:@"test from iOS app" forKey:@"message"];

// Create the request and post the action to my url path.
[FBRequestConnection startForPostWithGraphPath:@"XXXXXXXXXXXXXXXXXXX/comments"   
                                   graphObject:action
                             completionHandler:^(FBRequestConnection *connection,
                                                 id result,
                                                 NSError *error) {
                                 if (error)
                                 {
                                     NSLog(@"error: %@", error.localizedDescription);
                                 }
                                 else
                                 {
                                     NSLog(@"ok!!");
                                 }
                             }]; 
```

它在 Open Graph API 资源管理器中也不起作用。我收到的错误是“发生了未知错误”，代码 200。XXXXXXXX 网址是我有评论的页面的 ID，我可以阅读它们，但无法正确发布给它们。也许开放的图形路径是错误的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T09:08:18.763

嘿，朋友，这对你来说是个好消息。

我在 IOS 中使用 GraphAPI 发表评论和点赞

只需在下面写一些代码。

```
 NSMutableDictionary *res = [NSMutableDictionary dictionaryWithObjectsAndKeys:@"This is my comment", @"message", @"Your api's access Token",@"access_token",nil];
        [FBRequestConnection startWithGraphPath:@"XXXXXXXXXX/comments" parameters:res HTTPMethod:@"POST" completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
            if (error)
            {
                   NSLog(@"error: %@", error.localizedDescription);
            }
            else
            {
                   NSLog(@"ok!!");
            } 
        }];
        XXXXXXXXXX = Id where you want to comment. 
```

笔记：-

```
Please do not appent https://graph.facebook.com 
```

前

```
XXXXXXXXXX/comments 
```

# java - 转置数组

> ID：12133606
> 
> 赞同：3
> 
> 时间：2012-08-26T20:22:28.357
> 
> 标签：java, android, arrays, transpose

我正在使用以下代码读取 CSV 文件：

```
 String next[] = {};
  List<String[]> dataArray = new ArrayList<String[]>();

  try {
      CSVReader reader = new CSVReader(new InputStreamReader(getAssets().open("inputFile.csv")));
      for(;;) {
          next = reader.readNext();
          if(next != null) {
              dataArray.add(next);
          } else {
              break;
          }
      }
  } catch (IOException e) {
      e.printStackTrace();
  } 
```

这会将 CSV 文件转换为数组“dataArray”。我的应用程序用于字典类型的应用程序 - 输入数据的第一列是单词列表，第二列是这些单词的定义。这是加载的数组的示例：

```
Term 1, Definition 1
Term 2, Definition 2
Term 3, Definition 3 
```

为了访问数组中的字符串之一，我使用以下代码：

```
dataArray.get(rowNumber)[columnNumber] 
```

但是，我需要能够生成所有术语的列表，以便可以为字典应用程序显示它们。据我了解，访问列本身比访问行要漫长得多（我来自 MATLAB 背景，这很简单）。

似乎为了随时访问我的输入数据的任何行，我最好转置数据并以这种方式读取它；IE：

```
Term 1, Term 2, Term3
Definition 1, Definition 2, Definition 3 
```

当然，我可以首先提供一个转置的 CSV 文件——但 Excel 或 OO Calc 不允许超过 256 行，而我的字典包含大约 2000 个术语。

欢迎以下任何解决方案：

*   一种在读入数组后转置数组的方法
*   对上面发布的代码的更改，使其以“转置”方式读取数据
*   读取整个数组的整个列的简单方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:32:11.990

[使用 Map 数据结构（例如HashMap](http://developer.android.com/reference/java/util/HashMap.html)）可能会更好地为您服务：

```
String next[] = {};
HashMap<String, String> dataMap = new HashMap<String, String>();

try {
    CSVReader reader = new CSVReader(new InputStreamReader(getAssets().open("inputFile.csv")));
    for(;;) {
        next = reader.readNext();
        if(next != null) {
            dataMap.put(next[0], next[1]);
        } else {
            break;
        }
    }
} catch (IOException e) {
    e.printStackTrace();
} 
```

然后您可以通过以下方式访问第一列

```
dataMap.keySet(); 
```

第二列由

```
dataMap.values(); 
```

请注意这里的一个假设：输入数据的第一列都是唯一值（即，“术语”列中没有重复值）。

为了能够以数组的形式访问键（术语），您可以简单地执行以下操作：

```
String[] terms = new String[dataMap.keySet().size()];
terms = dataMap.keySet().toArray(terms); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:32:30.110

如果每一行都有两个值，第一个是术语，第二个是定义，你可以像这样构建[`Map`](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)它（顺便说一句，这个`while`循环和你的循环做的事情完全相同`for`）：

```
String next[] = {};
Map<String, String> dataMap = new HashMap<String, String>();

try {
    CSVReader reader = new CSVReader(new InputStreamReader(getAssets().open("inputFile.csv")));
    while((next = reader.readNext()) != null) {
        dataMap.put(next[0], next[1]);
    }
} catch (IOException e) {
    e.printStackTrace();
} 
```

然后，您可以通过以下方式从术语中获取定义：

```
String definition = dataMap.get(term); 
```

或所有这样的定义：

```
for (String term: dataMap.keySet()) {
    String definition = dataMap.get(term);
} 
```

# mysql - 命令删除数据库中具有前缀 test_ 的所有列以运行

> ID：12133608
> 
> 赞同：3
> 
> 时间：2012-08-26T20:22:58.850
> 
> 标签：mysql

如何在 phpMyAdmin 中运行命令，该命令将删除数据库中具有前缀的所有列`test_`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T20:49:33.907

要从表中删除列，请使用以下语法：

```
alter table <tablename> drop column <columnname> 
```

要查找数据库中以 test_ 开头的表中的所有列，请执行以下操作：

```
select column_name
from INFORMATION_SCHEMA.columns
where table_name = <table_name> and
      table_schema = <schema_name> and
      left(column_name, 5) = 'test_'  -- not using "like" because '_' is a wildcard char 
```

如果您手动执行此操作，我建议您运行以下查询，然后将结果粘贴到 mysql 查询界面：

```
select concat('alter table ', table_name, ' drop column ', column_name)
from INFORMATION_SCHEMA.columns
where table_name = <table_name> and
      schema_name = <schema_name> and
      left(column_name, 5) = 'test_' 
```

您可以在代码中执行类似的操作，方法是运行查询、返回结果，然后将每一行作为查询运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T20:48:07.510

如果你真的想从你的模式中*删除*列，你需要从 MySQL 的[信息模式表](http://dev.mysql.com/doc/en/information-schema.html)中动态生成必要的 SQL 命令。虽然可以在 MySQL 存储过程中使用[SQL Prepared statements](http://dev.mysql.com/doc/en/sql-syntax-prepared-statements.html)来做到这一点，我将在下面演示，但您可能会发现用您喜欢的开发语言（您在问题中没有提到）更容易实现/理解：

```
DELIMITER ;;

CREATE PROCEDURE dropMatchingColumns(IN pattern VARCHAR(64))
BEGIN
  DECLARE done INT DEFAULT FALSE;
  DECLARE cur CURSOR FOR
    SELECT   CONCAT(
                 'ALTER TABLE `', REPLACE( TABLE_NAME, '`', '``'), '` ',
               GROUP_CONCAT(
                 'DROP COLUMN `', REPLACE(COLUMN_NAME, '`', '``'), '`'
               )
             )
    FROM     INFORMATION_SCHEMA.COLUMNS
    WHERE    COLUMN_NAME LIKE pattern AND TABLE_SCHEMA = DATABASE()
    GROUP BY TABLE_NAME
  ;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

  OPEN cur;

  read_loop: LOOP
    FETCH cur INTO @sql;
    IF done THEN
      LEAVE read_loop;
    END IF;
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
  END LOOP;

  CLOSE cur;
END;;

DELIMITER ; 
```

定义此过程后，只需从当前数据库`CALL dropMatchingColumns('test\_%');`中删除所有前缀为 的列。`test_`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-25T11:59:27.940

如果您有 MySQl Workbench，那么您可以通过简单地进行批量选择并告诉工作台批量删除选定的列来删除多个列

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-20T11:16:59.697

我想为像我这样遇到问题的人解释或简化这个答案。

在我的数据库“演示”的所有表中删除名为“seq”的列时遇到问题。

您可以使用为每个表设置格式的命令创建选择，如下所示：

```
Select concat('alter table ', table_name, ' drop column ', 'seq;')
from (select table_name
from INFORMATION_SCHEMA.tables
where table_name = table_name and
table_schema = 'demo') as t 
```

这将为“演示”数据库中的每个表创建 alter table 命令。

您必须选择结果，复制它，然后将其粘贴回查询编辑器。

这是一个两步过程，但如果您必须多次执行此操作，请将命令保存在文本文件中以便稍后再次运行。

# python - 使用 PIL 自动旋转手机和加速度计拍摄的照片

> ID：12133612
> 
> 赞同：7
> 
> 时间：2012-08-26T20:23:33.013
> 
> 标签：python, django, python-imaging-library, django-models

我在网络应用程序中使用 Django + PIL + Amazon boto。用户发送图片，webapp 显示它。大多数情况下，人们发送从他们的手机拍摄的照片。有时，图像以错误的方向显示。有没有办法使用 PIL 或 Django 的 ImageField 从图像中获取元信息并使用它将图像旋转到正确的方向？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-13T16:06:51.910

我正在使用[django-imagekit](http://django-imagekit.readthedocs.org/en/latest/)处理图像，然后使用`imagekit.processors.Transpose`

```
from imagekit.models import ImageSpecField
from imagekit.processors import ResizeToFill, Transpose, SmartResize

class UserProfile(models.Model):
  avatar = models.ImageField(upload_to='upload/avatars', max_length=255, blank=True, null=True)
  avatar_thumbnail = ImageSpecField(
    source='avatar',
    processors = [Transpose(),SmartResize(200, 200)],
    format = 'JPEG',
    options = {'quality': 75}
  ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T21:13:06.627

试试这个来获取 EXIF 信息。注意：该`_getexif()`方法属于 JPEG 插件。它不会存在于其他类型的图像中。

```
import Image
from PIL.ExifTags import TAGS

im = Image.open('a-jpeg-file.jpg')
exifdict = im._getexif()
if len(exifdict):
    for k in exifdict.keys():
        if k in TAGS.keys():
            print TAGS[k], exifdict[k]
        else:
            print k, exifdict[k] 
```

对于我在硬盘上找到的随机图像，这产生了：

```
ExifVersion 0221
ComponentsConfiguration 
ApertureValue (4312, 1707)
DateTimeOriginal 2012:07:19 17:33:37
DateTimeDigitized 2012:07:19 17:33:37
41989 35
FlashPixVersion 0100
MeteringMode 5
Flash 32
FocalLength (107, 25)
41986 0
Make Apple
Model iPad
Orientation 1
YCbCrPositioning 1
SubjectLocation (1295, 967, 699, 696)
SensingMethod 2
XResolution (72, 1)
YResolution (72, 1)
ExposureTime (1, 60)
ExposureProgram 2
ColorSpace 1
41990 0
ISOSpeedRatings 80
ResolutionUnit 2
41987 0
FNumber (12, 5)
Software 5.1.1
DateTime 2012:07:19 17:33:37
41994 0
ExifImageWidth 2592
ExifImageHeight 1936
ExifOffset 188 
```

这是`Orientation`你想要的价值。它的含义可以在例如[exif 方向页面](http://sylvana.net/jpegcrop/exif_orientation.html)上找到。

原始 exif 数据可作为字符串从`Image.info['exif']`. `rotate()`使用该方法可以完成旋转。

除了更改原始数据之外，我不知道使用 PIL 更改 EXIF 数据的方法。

# html - 将奇怪的 iframe 添加到名为“rufous-sandbox”的正文标签中

> ID：12133617
> 
> 赞同：89
> 
> 时间：2012-08-26T20:24:38.613
> 
> 标签：html, wordpress

我在一个本地 WordPress 网站上工作，由于某种原因，`iframe`在开始`body`标签之后添加了一个使正文下降约 20 像素的标签。

谷歌在搜索时只返回了 1 个相关结果，我在那里读到的内容并没有多大帮助。可以在[这里](http://wordpress.org/support/topic/my-meny-is-jumping-down?replies=7)找到。

WordPress 站点没有安装插件，并且将其设置为`display: none;`不起作用。

这是Chrome的屏幕截图，您可以看到它：

![在此处输入图像描述](../Images/74d1547c90a1b9489657f9f9b967f4c4.png)

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-08-27T09:58:09.733

它似乎是由 Twitter 脚本添加的。如果删除它，iframe 将消失。看起来您确实以某种方式安装了 Twitter 插件，因为您可以看到它在 body 标记中显示 data-twttr-rendered="true"。

如果您删除代码-在我的情况下是下面的代码-它将消失

```
<script type="text/javascript">
  (function(){
    var twitterWidgets = document.createElement('script');
    twitterWidgets.type = 'text/javascript';
    twitterWidgets.async = true;
    twitterWidgets.src = '//platform.twitter.com/widgets.js';
    document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
  })();
</script> 
```

# asp.net-mvc-3 - ASP MVC - 如何保护我论坛中的帖子输入？

> ID：12133618
> 
> 赞同：0
> 
> 时间：2012-08-26T20:24:59.583
> 
> 标签：asp.net-mvc-3

我想知道安全地获取用户输入并将其呈现在我的论坛中的最佳做法是什么？我说的是用户可以在帖子中使用的富文本框和 html 标签。

# java - 从数据库到 JList 的数据

> ID：12133621
> 
> 赞同：-3
> 
> 时间：2012-08-26T20:25:15.827
> 
> 标签：java, swing, jlist

我创建了一个数据库，其中一个表名是 Location，它有 2 个名为 Stadium 和 City 的列。我希望每列中的数据都应该在 2 JList 中检索，但我不知道如何。你们能告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:30:09.830

从数据库中显示表的正常方式当然是`JTable`. 但是如果你想选择`JList`2s 而不是，它基本上是相同的原则。

根据数据库的内容创建一个模型（在本例中为 a `ListModel`）。你可能只是从`AbstractListModel`. 一旦你有了你的模型，`JList`只需在构造函数中传递模型就可以轻松地为它创建一个。

请参阅[*如何使用列表*](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)教程并特别注意该教程的*创建模型*部分

# facebook - 获取附近地点的访问令牌

> ID：12133623
> 
> 赞同：0
> 
> 时间：2012-08-26T20:25:28.637
> 
> 标签：facebook, facebook-graph-api, cordova, cordova-2.0.0

我正在开发 phonegap 应用程序，我想使用 facebook 显示附近地点的列表。
我知道我需要获取 access_token 才能使用图形 api，但是要求用户登录到 facebook 似乎很尴尬和奇怪，所以我可以获得与你无关的地方列表（我不是在寻找用户的地方喜欢/访问）。

还有另一种不要求用户登录的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T21:16:19.277

您可以使用[App Access Token](https://developers.facebook.com/docs/authentication/applications/)获取位置，这不需要用户登录。

祝你好运。使用 Facebook API 进行位置搜索具有挑战性。

您可能想查看[Factual API](http://developer.factual.com/)或其中一个 Mapping API 以获取地点数据。

# android - textwatch 是接口吗？

> ID：12133626
> 
> 赞同：1
> 
> 时间：2012-08-26T20:25:48.283
> 
> 标签：android, extends, implements

当我实现 textwatcher 时，发生错误

```
Syntax error on token "implements", extends expected 
```

我的代码是

```
import android.text.TextWatcher;
public interface Testing implements TextWatcher{

} 
```

为什么我需要使用扩展？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T20:28:11.483

您没有*实现* `TextWatcher`- 您正在创建一个扩展它的新接口。

所以你会写：

```
public interface Testing extends TextWatcher 
```

或者

```
public class Testing implements TextWatcher 
```

你还没有说出你真正想要做什么，所以我们无法判断你是否应该真正声明一个类，或者只是声明一个扩展的新接口`TextWatcher`。

有关声明一个接口以扩展另一个接口的更多详细信息，请参阅JLS 的[第 9.1.3 节。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-9.html#jls-9.1.3)

# objective-c - Apple App Store 以编程方式访问

> ID：12133630
> 
> 赞同：2
> 
> 时间：2012-08-26T20:26:18.660
> 
> 标签：objective-c, api, app-store, xcode4.4

我想在按钮或表单中显示来自 Apple AppStore 页面的与用户当前正在运行的应用程序相关的一些信息。

例如当前国家的价格或评论摘要。

是否有任何函数可以通过 xcode 调用来提取这些细节而不使用额外的外部库？

我指的是我创建的应用程序，所以我有所有的 ID...

谢谢A。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T03:45:31.123

此页面应包含您需要的信息：http: [//itunes.apple.com/lookup ?id=your_app_id](http://itunes.apple.com/lookup?id=your_app_id)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:35:41.610

他们是一个内置的 iOS API，用于访问应用内购买项目的价格。否则，您可能必须研究第 3 方库或将用户发送到 Safari 或 App Store URL 以获取信息。

# java - Scala getClass.getResource() 返回 null

> ID：12133632
> 
> 赞同：27
> 
> 时间：2012-08-26T20:26:24.877
> 
> 标签：java, scala, intellij-idea

我有这个代码：

```
val url: URL = getClass.getResource("com/mysite/main/test.fxml") 
```

它总是返回`null`（或`Unit`）。我在项目中只有两个文件：

```
MyProj/src/com/mysite/main/Test.scala
MyProj/src/com/mysite/main/test.fxml 
```

当我运行时，`Test.scala`该`url`值始终为空。

我刚刚尝试重建项目，我正在使用 IntelliJ IDEA。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-26T20:28:27.813

你有三个选择：

*   利用当前包的相对路径（在哪里`Test.class`）：

    ```
    getClass.getResource("test.fxml") 
    ```

*   您可以使用绝对路径：

    ```
    getClass.getResource("/com/mysite/main/test.fxml") 
    ```

*   或通过加载`ClassLoader`（注意它总是从根开始）：

    ```
    getClass.getClassLoader.getResource("com/mysite/main/test.fxml") 
    ```

在 IntelliJ IDEA 中，确保您已添加`;?*.fxml`到：

`Settings`（`Preferences`在 Mac 上）| `Compiler`| **资源模式**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-04T20:12:30.557

可能它没有从 src/ 目录复制到 bin/ 目录？这发生在重新编译时，但如果在程序编译后将其放入 src/ 目录，IDE 将不知道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-14T02:44:45.207

迟到的答案，但我也遇到了同样的问题。根本原因是我的 settings.gradle 中的 rootProject.name 条目不正确。一旦我修复了这个问题，清理并重建了我的资源，就可以使用 getClass().getResource() 加载。希望这可以帮助某人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-21T09:15:56.027

如果它不起作用，您可以尝试使用**ClassLoader**：

```
ClassLoader.getSystemResource("filename").getPath 
```

文件名应在同一目录层

# php - PHP：发布到自我，页面变量在硬刷新之前没有响应

> ID：12133637
> 
> 赞同：0
> 
> 时间：2012-08-26T20:27:20.793
> 
> 标签：php, wordpress, variables, global-variables

我正在向自己提交一个表格，`action=""`但奇怪的是我的变量在提交后正在更新。

```
<form action="" method="post">
<input type="text" name="username">
<input type="text" name="password">
<input type="submit">
</form> 
```

一旦提交并且用户成功登录，除非我硬刷新，否则页面的其余部分似乎不会响应更新的变量。

```
if ( isset($_POST['found_step_1']) ) {

global $wpdb;
// We shall SQL escape all inputs
$username = $wpdb->escape($_REQUEST['username']);
$password = $wpdb->escape($_REQUEST['password']);
$remember = $wpdb->escape($_REQUEST['rememberme']);

if ($remember) {
    $remember = "true";
} else {
    $remember = "false";
} 
$login_data = array();
$login_data['user_login'] = $username;
$login_data['user_password'] = $password;
$login_data['remember'] = $remember;
$user_verify = wp_signon( $login_data, true ); 

if ( is_wp_error($user_verify) ) {
    echo "Invalid username or password. Please try again!";
    $current_step = 1;
} else {
    //echo "<script type="text/javascript">window.location='". get_bloginfo('url') ."'</script>";
    $current_step = 2;
}

$wpdb->flush();

} 
```

当下面的页面呈现时......就像它正在呈现 POST 之前的内容......让它显示最新数据的唯一方法是硬刷新页面。这真的很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:39:35.743

已编辑

您需要将登录过程作为脚本首先要做的事情之一。我曾经遇到过类似的问题，然后发现我的脚本中的登录过程为时已晚。我将提出一个实际的伪示例，它不会按预期工作：

```
<?php
if (in_array("Maths",$Subjects) $MainSubject="Maths";

if ($_POST['name'] == "Admin" && $_POST['password'] == "MyCoolPassword!")
  {
  $Lang=en;
  $Subjects = array ("Maths","Physics","English");
  }

echo $MainSubject;
?> 
```

这是一个**太**简单的代码（并且会抛出一些错误），所以很容易发现错误。但是，如果您正在使用多个包含，在这里和那里调用函数并做很多这样的事情怎么办？那么同样的错误可能会大规模发生。只是一个想法，但如果没有来自 OP 的更多代码，我们无法真正回答，只需给出一些“也许就是这个”。

其他可能出错的事情是在完成解析 php 代码之后设置 cookie，而不是在代码中调用 setcookie() 的那一刻。可以在这里找到更完整的答案：[php set cookie issue](https://stackoverflow.com/questions/5936054/php-set-cookie-issue)

`what's odd is that my variables are updating after the submission.`我猜你的意思是你的变量在提交问题的其余部分后没有立即更新，这很不清楚。请发布更多代码，以便我们更好地帮助您。

# c# - 复制对象或具有复制属性的新对象？

> ID：12133638
> 
> 赞同：1
> 
> 时间：2012-08-26T20:27:34.127
> 
> 标签：c#, visual-studio-2010, oop

我正在使用配置文件制作一个文件备份程序来保存设置等。目前的结构是这样的：

有`MainForm`一个`ProfileHandler`有一堆配置文件对象

当您在程序中进行任何更改（将文件添加到列表、更改目标路径等）时 - 设置将保存在临时配置文件中。到现在为止还挺好...

但是当我想保存配置文件时，我真的无法决定要走哪条路。现在我将临时配置文件对象传递`AddProfile`给`ProfileHandler`. 然后该方法创建一个新的配置文件对象，使用临时配置文件对象的属性作为参数（a 除外`List<string>`，它只是使用 Addrange 复制内容）。

它有效，但它好吗？

```
public bool AddProfile(Profile tempProfile)
{
    if (tempProfile != null)
    {
        Profile profile = new Profile(tempProfile.Name, tempProfile.TargetPath);
        profile.Filelist.Clear();
        profile.Filelist.AddRange(tempProfile.Filelist);
        _profiles.Add(profile);
    }
    return (tempProfile != null);
} 
```

有没有更巧妙的方法？不知何故，我觉得必须有一种简单的方法来创建一个新的`Profile`对象实例，它是`tempProfile`. 在我的例子中，这个`Profile`类只有三个字段，这很容易，但是如果它有很多呢？

我希望我不是太不清楚。我对此有点陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:46:15.430

您可以制作您的深层**副本**`tempProfile`并保存。这是示例代码源代码[如何在 .NET（特别是 C#）中对对象进行深层复制？](https://stackoverflow.com/questions/129389/how-do-you-do-a-deep-copy-an-object-in-net-c-specifically)

```
public static T DeepClone<T>(T obj)
{
 using (var ms = new MemoryStream())
 {
   var formatter = new BinaryFormatter();
   formatter.Serialize(ms, obj);
   ms.Position = 0;

   return (T) formatter.Deserialize(ms);
 }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T20:51:39.813

只需创建一个接受 Profile 的构造函数并像这样进行复制：

```
public Profile(Profile profileToCreateFrom)
    : this(profileToCreateFrom.Name, profileToCreateFrom.TargetPath)
{
    FileList = profileToCreateFrom.FileList.Select(file => file).ToList();
} 
```

然后你添加新的：

```
_profiles.Add(new Profile(tempProfile)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T21:29:46.510

您可以查看受保护的[object.MemberwiseClone](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)方法。这种方法从早期就已经存在。

```
void Main()
{
    Profile p = new Profile("bob", @"c:\foo");
    p.FileList.Add("bar.txt");

    Profile copy = p.DeepCopy();
    copy.FileList.Clear();
    copy.FileList.Add("baz.log");

    p.Dump("p");
    copy.Dump("copy");
}

public class Profile
{
    public Profile(string name, string targetPath)
    {
        this.Name = name;
        this.TargetPath = targetPath;
        this.FileList = new List<string>();
    }

    public Profile DeepCopy()
    {
        Profile copy = (Profile)this.MemberwiseClone(); // this takes care of Name & TargetPath
        copy.FileList = new List<string>(this.FileList);
        return copy;
    }

    public string Name { get; private set; }
    public string TargetPath { get; private set; }
    public List<string> FileList { get; private set; }
} 
```

您可以将其`MemberwiseClone`视为进行浅按位复制。这通常适用于 int、double、float 等值类型，甚至适用于字符串等不可变引用类型。但是，您需要像`List<string>`在配置文件类中一样制作可变引用类型的副本，以便副本的突变也不会改变原始引用类型。就维护而言，这是一条细线——如果添加新的可变属性，则必须记住在克隆发生后在深复制方法中进行复制。

根据您的设计，可能还有其他内容，例如您可能不想复制的事件注册。您可以将这些视为瞬态。如果您的应用程序是多线程的，您也需要小心，在复制过程中，您必须像在其他地方一样付出同样的痛苦来维护对象的完整性（例如获取锁。）

我没有性能数据。无论如何，无论你采取什么建议，你最适合自己做一些性能测试，看看它是否足够快。

# python - __new__ 是检索 SQLAlchemy 对象的好方法吗

> ID：12133641
> 
> 赞同：1
> 
> 时间：2012-08-26T20:28:12.670
> 
> 标签：python, sqlalchemy, python-2.x

我正在使用 SQLAlchemy，我刚刚阅读了有关该`__new__`功能的信息。我还阅读了这里的其他帖子，`__new__`所以我知道它们的区别`__init__`、它们被调用的顺序、它们的目的以及对我来说主要信息是：*用于`__new__`控制新实例的创建*。

所以考虑到这一点，当我使用 SQLAlchemy 并想要检索一个实例（如果它不存在则创建一个实例，例如检索一个用户对象，我通常这样做：

```
user = DBSession.query(User).filter(User.id==user_id).first()
if not user:
    user = User() 
```

这将返回当前用户或给我一个新用户。现在有了我对魔法的新知识，我认为这样的事情可能是个好主意：

```
user = User(id=user_id) 
```

在我的数据库类中，我会调用：

```
def __new__(cls, id=0):
    if id:
        user = DBSession.query(User).filter(User.id==id).first()
    if not id or not user:
        user = super(User, cls).__new__(cls, id=id)
    return user 
```

现在这段代码只是一个草稿（例如缺少对 super 的调用），但它应该清楚地指出这个想法。

现在我的问题是：**这是一个好习惯还是我应该避免这种做法？**如果应该避免：为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T21:17:28.870

根据您的问题和评论，我建议您不要这样做，因为您似乎没有任何理由这样做，而且您似乎不明白自己在做什么。

你说你会放一定的代码`__new__`。但在`__new__`什么？如果你有这个：

```
class User(Base):
    def __new__(cls, id=0):
        if id:
            user = DBSession.query(User).filter(User.id==id).first()
        if not user:
            user = User()
        return user 
```

. . . 然后当你尝试创建一个`User`实例时，它`__new__`会尝试创建另一个实例，依此类推，导致无限递归。

使用`user = User.__init__()`解决不了任何问题。 `__init__`总是返回 None，所以你只是试图创建一个 None 对象。

适当的用例`__new__`是当您想要更改通过执行实例化类时返回的对象类型时`SomeClass()`。很少需要这样做。最常见的情况是当您想要创建一个模仿内置类型（例如 ）的用户定义类时`dict`，但即使这样您也可能不需要这样做。

如果您的代码在没有覆盖的情况下工作`__new__`，请不要覆盖`__new__`. 仅当您有无法以其他方式解决的特定问题或任务时才覆盖它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:42:30.503

据我所见和理解，没有理由不将您的代码放入`__init__`而不是`__new__`. 只有几个非常有限但有效的用例`__new__`，您应该真正知道自己在做什么。因此，除非您有充分的理由，否则请坚持使用`__init__`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T21:04:20.370

第一个示例（检查返回值）和第二个示例（立即使用构造函数）之间有一个非常明显的区别；那个区别是自由变量：`DBSession`.

在某些情况下，这种差异并不有趣。如果您仅将 sqlalchemy 映射对象用于数据库持久性；然后仅在`sqlalchemy.orm.scopedsession`允许的上下文中（每个线程恰好一个会话）。那么差异不是很有趣。

我发现这两种情况都成立是不寻常的，而且通常都不成立。

通过这样做，您可以防止对象在数据库持久性上下文*之外发挥作用。*通过断开模型与数据库的连接，您的应用程序可以回答诸如“如果该对象具有此属性怎么办？”之类的问题。除了诸如“这个对象有这个属性吗？”之类的问题。这就是为什么我们将数据库值映射为 python 对象的关键，这样它们就可以有有趣的行为，而不是仅仅作为`dict`属性包的 s。

例如，除了使用常规的数据库持久登录；您可能允许用户使用 OAuth 之类的方式登录您的网站。尽管您不需要将用户名和密码保存到数据库中，但您仍然需要*创建`User`对象*以使应用程序的其余部分正常工作（以便用户的头像出现在模板中）。

*默认情况下*隐式访问特定数据库上下文的另一个问题通常是一个坏主意。随着应用程序的增长，管理数据库方式的需求变得更加复杂。对象可以跨多个数据库主机进行分区；您可能在同一个线程中管理多个并发事务；出于缓存性能原因，您可能希望重用特定会话。sqlalchemy`Session`类的存在是为了解决所有这些特性；明确地管理它们，即使您只是使用最常见的模式；使处理偶尔的变化变得更加容易。

Web 应用程序中一个非常常见的例子是启动代码。有时，在应用程序准备好处理任何请求之前，需要从数据库中提取一些关键数据；但是既然没有请求服务，那么数据库连接是从哪里来的呢？启动完成后如何摆脱它？这些问题通常与明确管理的会话无关。

# c - 我应该在 Postgresql 的 C 函数中取消转义 bytea 字段吗？如果是，该怎么做？

> ID：12133644
> 
> 赞同：2
> 
> 时间：2012-08-26T20:28:35.587
> 
> 标签：c, postgresql, bytea

我为具有 bytea 参数的 Postgresql 编写了自己的 C 函数。该函数定义如下

```
CREATE OR REPLACE FUNCTION putDoc(entity_type int, entity_id int, 
        doc_type text, doc_data bytea) RETURNS text
     AS 'proj_pg', 'call_putDoc'
     LANGUAGE C STRICT; 
```

我`call_putDoc`用 C 编写的函数读取`doc_data`数据并将其传递给另一个函数，例如`file_magic`确定数据的 mime 类型，然后将数据传递给适当的文件转换器。

我从将文件内容加载到最后一个参数的 php 脚本中调用这个 postgresql 函数。所以，我应该用`pg_escape_bytea`.

当数据传递给`call_putDoc`C 函数时，它的数据是否已经转义，如果没有 - 如何对它们进行转义？

**编辑：**正如我所发现的，不，传递给 C 函数的数据不是未转义的。如何摆脱它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T21:31:55.927

在为 PostgreSQL 编写 C 函数时，文档解释了一些基础知识，但对于其余部分，通常是阅读 PostgreSQL 服务器的源代码。

值得庆幸的是，代码通常结构良好且易于阅读。我希望它有更多的文档评论。

一些用于浏览源代码的重要工具是：

*   一个好的IDE；或者
*   和`find`命令`git grep`。

在这种情况下，在查看之后，我认为您的`bytea`论点*正在*被解码 - 至少在 Pg 9.2 中，8.4 的行为可能（尽管不太可能）有所不同。服务器应该在调用您的函数之前自动执行此操作，我怀疑您在如何`putDoc`从 SQL 调用函数时遇到了编程错误。没有消息来源，很难说更多。

*   尝试使用您已验证为8.4 服务器正确编码的`putDoc`一些`psql`示例数据调用它`escape`
*   尝试设置断点`byteain`以确保在您的函数之前调用它
*   按照以下步骤验证我所说的是否适用于 8.4。
*   在你的函数中设置一个断点并使用 单步执行，在你检查变量`gdb`时使用该函数。`print`有很多 gdb 教程会教您所需的`break`, `backtrace`, `cont`, `step`, `next`, `print`, 等命令，所以我不会在这里重复所有这些。

至于出了什么问题：您可能正在对数据进行双重编码-例如，鉴于您的评论，我想知道您是否已对`base64`数据进行编码并将其传递给`Pg`set `bytea_output`to `escape`。然后 Pg 将对其进行解码......给你一个`bytea`包含字节编码的`bytea`表示`base64`，而不是原始字节本身。（**编辑**听起来可能不是基于评论）。

正确使用`bytea`见：

*   [http://www.postgresql.org/docs/current/static/runtime-config-client.html](http://www.postgresql.org/docs/current/static/runtime-config-client.html)
*   [http://www.postgresql.org/docs/current/static/datatype-binary.html](http://www.postgresql.org/docs/current/static/datatype-binary.html)

多说，我需要源代码。

这是我所做的：

* * *

`find -name bytea\*`在源代码树中快速定位`src/include/utils/bytea.h`. 那里的评论指出，函数定义在`utils/adt/varlena.c`- 结果实际上是`src/backend/util/adt/varlena.c`。

`bytea.h`您还会注意到 GUC 参数的定义，这`bytea_output`是您在.`SHOW bytea_output``SET bytea_output``psql`

让我们看一下我们知道的一个函数，它对`bytea`数据做一些事情，比如`bytea_substr`， in `varlena.c`。它太短了，我将在此处包含其声明之一：

```
Datum
bytea_substr(PG_FUNCTION_ARGS)
{
        PG_RETURN_BYTEA_P(bytea_substring(PG_GETARG_DATUM(0),
                    PG_GETARG_INT32(1),
                    PG_GETARG_INT32(2),
                    false));
} 
```

许多公共函数都是私有实现的包装器，因此私有实现可以与具有不同参数的函数或其他私有代码重用。就是这种情况；你会看到真正的实现是`bytea_substring`. 以上所做的就是处理SQL函数调用接口。它根本不会与`Datum`包含`bytea`输入的内容混淆。

在这种特殊情况下，真正的实现`bytea_substring`直接位于 SQL 接口包装器的下方，因此请继续阅读`varlena.c`。

实现似乎没有参考`bytea_output`GUC，基本上只是`DatumGetByteaPSlice`在处理一些边界情况后调用来完成工作。`git grep DatumGetByteaPSlice`向我们展示了`DatumGetByteaPSlice`在 中`src/include/fmgr.h`，并且是一个宏定义为：

```
#define DatumGetByteaPSlice(X,m,n)      ((bytea *) PG_DETOAST_DATUM_SLICE(X,m,n)) 
```

`PG_DETOAST_DATUM_SLICE`在哪里

```
#define PG_DETOAST_DATUM_SLICE(datum,f,c) \
            pg_detoast_datum_slice((struct varlena *) DatumGetPointer(datum), \
            (int32) (f), (int32) (c)) 
```

所以它只是解除数据并返回一个内存片。这让我想知道：解码是否在其他地方完成，作为函数调用接口的一部分？还是我错过了什么？

看一下`byteain`的输入函数`bytea`，表明它确实在解码数据。在该函数中设置一个断点，当您从 SQL 调用您的函数时，它应该会跳闸，表明`bytea`数据确实正在被解码。

例如，让我们看看`byteain`当我们调用时是否被调用`bytea_substr`：

```
SELECT substring('1234'::bytea, 2,2); 
```

如果您想知道如何`substring(bytea)`变成对 的`C`调用`bytea_substr`，请查看`src/catalog/pg_proc.h`映射。

我们将启动 psql 并获取后端的 pid：

```
$ psql -q regress
regress=# select pg_backend_pid();
 pg_backend_pid 
----------------
          18582
(1 row) 
```

然后在另一个终端中使用 gdb 连接到该 pid，设置断点并继续执行：

```
$ sudo -u postgres gdb -q -p 18582
Attaching to process 18582
... blah blah ...
(gdb) break bytea_substr
Breakpoint 1 at 0x6a9e40: file varlena.c, line 1845.
(gdb) cont
Continuing. 
```

在第一个终端中，我们在 psql 中执行：

```
SELECT substring('1234'::bytea, 2,2); 
```

...并注意它挂起而不返回结果。好的。这是因为我们在 gdb 中触发了断点，正如您在第二个终端中看到的那样：

```
Breakpoint 1, bytea_substr (fcinfo=0x1265690) at varlena.c:1845
1845            PG_RETURN_BYTEA_P(bytea_substring(PG_GETARG_DATUM(0),
(gdb) 
```

该命令的回溯`bt`不会显示`bytea_substr`在调用路径中，它都是 SQL 函数调用机制。所以 Pg`bytea`在将它传递给`bytea_substr`.

您现在可以使用`quit`. 这不会退出 Pg 后端，只会分离并退出调试器。

# javascript - 使用 span 和 javascript 创建 CSS 过渡

> ID：12133646
> 
> 赞同：0
> 
> 时间：2012-08-26T20:28:56.600
> 
> 标签：javascript, css, css-transitions

使用 javascript，我从 html div 标签中的文本中随机选择一个单词，并用 span 标签包围它。使用 span 标签的类，我尝试执行单词颜色从黑色到红色的 CSS 转换。然后我删除 span 标签以将单词改回黑色。我正在寻找的效果是“闪烁的文字”。

我设法让这个词改变颜色，但不能让平滑的 CSS 过渡工作。

我的问题是：为什么 CSS 过渡不起作用？

我的问题似乎类似于[这个问题](https://stackoverflow.com/questions/12088819/css-transitions-on-new-elements)，但我没有设法让“强制布局”的解决方案在我的情况下起作用。

我希望可以提供[我正在使用的测试代码](http://www.theonerose.com/colorchangetest.php)的工作链接，而不是在此处发布代码（此处为[javascript 文件](http://www.theonerose.com/scripts/colorChangerTest.js)）。如果没有，我当然会根据要求在这篇文章中添加代码。

先感谢您！我一整天都在努力解决这个问题，但没有成功。是时候承认我需要帮助了:-)

*编辑：添加代码。*

**HTML：**

```
<div id="message">
Some words here.
</div> 
```

**CSS：**

```
div#message span
{
    color: black;
}

div#message span.redtext
{
    transition: color 5s ease-out 0s;
    color: red;
} 
```

**Javascript：**

```
//Insert span around word
var newText = text.split(randomWord).join('<span>' + randomWord + '</span>');
$("#message").html(newText);

//Request property that requires layout to force a layout 
var x = $("#message").clientHeight;

//Add class to span
var newText = newText.split('<span>').join('<span class="redtext">');
$("#message").html(newText); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:49:01.923

给你的 span 一个类，这样你就可以使用 jquery 轻松获得对它的引用。然后使用 addClass 和 removeClass jquery 方法添加并随后删除赋予文本颜色的类。

这是一个工作示例：http: [//jsfiddle.net/sVMZJ/](http://jsfiddle.net/sVMZJ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T21:21:46.293

CSS 过渡适用于元素的样式更改。当新的 CSS 样式应用于元素时，您可以指定在该更改中使用的过渡。在您的示例中，您添加了一个使用红色文本样式创建的跨度。**span 元素在创建时具有红色文本样式**。您不是将元素从一种样式转换为另一种样式，您只是将其插入到 redtext 类样式中。

您需要做的是在其中添加一个带有黑色文本的跨度，然后将跨度的类从“blacktext”更改为“redtext”，然后将应用过渡。您可以在没有类的情况下插入它然后更改它，但我使用类“blacktext”使其更容易识别。

**看：**

[http://jsfiddle.net/n8zNW/](http://jsfiddle.net/n8zNW/)

# javascript - 将 iframe 中的 css 类应用于主文档

> ID：12133649
> 
> 赞同：1
> 
> 时间：2012-08-26T20:29:13.100
> 
> 标签：javascript, jquery, css, iframe

我正在尝试将在`head`an中定义的 CSS 类应用于`iframe`主文档中的元素。

有没有一种简单的方法 - 除了使用 Javascript 将类从 iframe 的头部复制到主文档的头部 - 来访问该类并将其应用于主文档？

在主文档中这样的东西（显然不起作用）会很棒：

```
<div class="#iframe.classtoapply">lorem ipsum</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:10:51.113

嘿，你可以这样做。假设你有一个 iframe，它看起来像这样，有 a 和 b 类。 **代码**

```
<head>

<style>
.a{color:red;}
.b{
color:blue;
}
</style>
</head> 
```

现在假设您有一个类似这样的包含该 iframe 的主页。您可以编写这样的代码。结帐。

```
 <head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
</head>
<body>
<iframe src="youriframe.html"></iframe>
<span class="a" >Hi</span>
<span class="b" >It Worked</span>
<script>
$(function() {
    $('head').append('<style/>');
    setInterval(function() {
        if(typeof($('iframe').contents().find('head>style').html())!='undefined') {
            $('head>style').eq(0).append($('iframe').contents().find('head>style').html());
        }
    }
    ,1);
}
);
</script>
</body> 
```

# c# - 匹配 XPath 表达式中的多个域

> ID：12133654
> 
> 赞同：1
> 
> 时间：2012-08-26T20:30:51.283
> 
> 标签：c#, xpath, html-agility-pack

目前我正在做这样的事情来获取页面中指向某个域的所有链接：

```
var links = entryNode.SelectNodes(".//a[contains(@href,'site.com')]"); 
```

我想修改它，以便我可以获得`a`指向我指定的任何域的元素。例如：

```
var links = entryNode.SelectNodes(".//a[contains(@href,'site.com') | contains(@href,'othersitesite.com') | contains(@href,'thirdsite.com')]"); 
```

有没有办法在一个 XPath 表达式中做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:17:09.423

**使用**：

```
.//a[contains(@href,'site.com')
   or
     contains(@href,'othersitesite.com')
   or
     contains(@href, 'thirdsite.com')
     ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T05:42:38.377

假设您需要*完全*匹配出现`//`在任何后续之后和之前的字符串部分`/`（即，您也想匹配子域），那么以下解决方案有效：

```
.//a[contains(' site.com othersitesite.com thirdsite.com ', 
             concat(' ', substring-before(substring-after(
                                          concat(@href, '/'), '//'), '/'), ' '))] 
```

这是有效的，因为您正在一个较大的字符串中寻找由空格包围的目标字符串，该字符串包含所有可能的目标字符串，每个目标字符串都被空格包围。

让我们用一个具体的例子。假设您有以下文档：

```
<r>
    <a href="http://google.com"/>
    <a href="http://yahoo.com/"/>
    <a href="http://bing.com"/>
    <a href="http://altavista.com"/>
</r> 
```

并且您想要匹配*google.com*、*yahoo.com*和*altavista.com*的锚点（相对于当前节点）。下面的表达式实现了这一点：

```
.//a[contains(' google.com yahoo.com altavista.com ', 
             concat(' ', substring-before(substring-after(
                                          concat(@href, '/'), '//'), '/'), ' '))] 
```

您可能没有上述要求。如果是这种情况，那么只需使用@Dimitre 的（好）答案。此解决方案仅作为一种可能的替代方案提供，它也可以帮助您进一步了解自己的需求。

# java - 为什么“while((String tmp=x))”不是有效的 Java 语法？

> ID：12133655
> 
> 赞同：8
> 
> 时间：2012-08-26T20:30:51.623
> 
> 标签：java, syntax

我对一些 Java 代码有一个澄清：

这些代码之间有什么区别，一个可以编译而另一个不能。

我对“如何修复错误”不感兴趣，因为我已经解决了它，但更多的是关于这个问题的解释：

## 在职的

```
public void  x(){
    HashMap<String , Integer> count= new HashMap<String, Integer>();
    Scanner scan= new Scanner("hdsh");

    String tmp;
    while((tmp=scan.next())!=null){
        if(count.containsKey(tmp)){
            count.put(tmp, 1);
        }
        else{
            count.put(tmp, count.get(tmp)+1);
        }
         tmp=scan.next();
    }

} 
```

## 不工作

```
public void  x(){
    HashMap<String , Integer> count= new HashMap<String, Integer>();
    Scanner scan= new Scanner("hdsh");

    while((String tmp=scan.next())!=null){
        if(count.containsKey(tmp)){
            count.put(tmp, 1);
        }
        else{
            count.put(tmp, count.get(tmp)+1);
        }
         tmp=scan.next();
    }

} 
```

## Eclipse的错误是：

此行有多个标记：

*   字符串无法解析为变量
*   标记“tmp”的语法错误，删除此标记
*   字符串无法解析为变量
*   标记“tmp”的语法错误，删除此标记

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-26T20:32:00.567

您不能在表达式内声明变量。`for`（循环的第一部分除外）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-26T20:44:55.833

[JLS §14.12](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.12)：

```
WhileStatement:
    while ( Expression ) Statement 
```

[JLS§15.27](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.27)

```
Expression:
    AssignmentExpression 
```

[JLS §15.26](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.26)

```
AssignmentExpression:
    ConditionalExpression
    Assignment

Assignment:
    LeftHandSide AssignmentOperator AssignmentExpression

LeftHandSide:
    ExpressionName
    FieldAccess
    ArrayAccess 
```

`LeftHandSide`不能是声明，所以不允许。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:44:49.450

您正在混合 for 和 while 语法。第二个块不起作用，因为您在条件内声明 tmp 变量。

`while((String tmp=scan.next())!=null)`

尝试这个：

`String tmp; while((tmp=scan.next())!=null)`

# maven - 为什么这只耳朵找不到他的依赖？

> ID：12133661
> 
> 赞同：0
> 
> 时间：2012-08-26T20:31:59.253
> 
> 标签：maven, ejb, war, ear

我刚刚做了一些项目。我之前使用过 ant，它具有以下结构：

MYPROJECT/ pom.xml (ear) MYPROJECT-EJB pom.xml MYPROJECT-WAR pom.xml

如果我构建 ejb 和 jar 项目，它就可以工作。如果我清洁所有东西并从耳朵开始，它不会。这是我从 jenkins 获得的“maven clean install”：

> [警告] be.valuya.myproject:myproject-ejb:jar:1.0-SNAPSHOT 的 POM 丢失，没有可用的依赖信息 [警告] be.valuya.myproject:myproject-war:war:1.0-SNAPSHOT 的 POM 是缺少，没有可用的依赖信息 [警告] be.valuya.myproject:myproject-ws:war:1.0-SNAPSHOT 的 POM 丢失，没有可用的依赖信息

顺便说一句，我不知道它应该如何找到这些依赖项，但这就​​是我想要的。

这是我耳朵的 pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>be.valuya.myproject</groupId>
    <artifactId>myproject</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>ear</packaging>

    <name>myproject</name>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <netbeans.hint.deploy.server>gfv3ee6</netbeans.hint.deploy.server>
    </properties>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.7</source>
                    <target>1.7</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-ear-plugin</artifactId>
                <version>2.6</version>
                <configuration>
                    <version>6</version>
                    <defaultLibBundleDir>lib</defaultLibBundleDir>
                    <applicationName>myproject</applicationName>
                </configuration>
            </plugin>
        </plugins>
    </build>
    <dependencies>
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>myproject-ejb</artifactId>
            <version>${project.version}</version>
            <type>ejb</type>
        </dependency>
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>myproject-war</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>myproject-ws</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>
    </dependencies>
</project> 
```

这是我的 ejb 模块的 pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>be.valuya.myproject</groupId>
    <artifactId>myproject-ejb</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>ejb</packaging>

    <name>myproject-ejb</name>

    <repositories>
        <repository>
            <id>EclipseLink Repo</id>
            <!-- note that ampersands in this URL are escaped because this is in an xml file -
                   un-escape them to use in browser 
            -->
            <url>http://www.eclipse.org/downloads/download.php?r=1&amp;nf=1&amp;file=/rt/eclipselink/maven.repo</url>
        </repository>         
    </repositories>

    <pluginRepositories>
        <pluginRepository>
            <id>maven-annotation-plugin</id>
            <url>http://maven-annotation-plugin.googlecode.com/svn/trunk/mavenrepo</url>
        </pluginRepository>
    </pluginRepositories>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.7</source>
                    <target>1.7</target>
                    <compilerArguments>
                        <endorseddirs>${endorsed.dir}</endorseddirs>
                    </compilerArguments>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-ejb-plugin</artifactId>
                <version>2.3</version>
                <configuration>
                    <ejbVersion>3.1</ejbVersion>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <version>2.1</version>
                <executions>
                    <execution>
                        <phase>validate</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <outputDirectory>${endorsed.dir}</outputDirectory>
                            <silent>true</silent>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>javax</groupId>
                                    <artifactId>javaee-endorsed-api</artifactId>
                                    <version>6.0</version>
                                    <type>jar</type>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <!--            <plugin>
                <groupId>org.bsc.maven</groupId>
                <artifactId>maven-processor-plugin</artifactId>
                <version>1.3.5</version>
                <executions>
                    <execution>
                        <id>process</id>
                        <goals>
                            <goal>process</goal>
                        </goals>
                        <phase>generate-sources</phase>
                        <configuration>
                            <compilerArguments>-Aeclipselink.persistencexml=src/main/resources/META-INF/persistence.xml</compilerArguments>
                            <processors >
                                <processor>org.eclipse.persistence.internal.jpa.modelgen.CanonicalModelProcessor</processor>
                            </processors>
                        </configuration>
                    </execution>
                </executions>
            </plugin>-->
        </plugins>
    </build>
    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <endorsed.dir>${project.build.directory}/endorsed</endorsed.dir>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.eclipse.persistence</groupId>
            <artifactId>javax.persistence</artifactId>
            <version>2.0.0</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.eclipse.persistence</groupId>
            <artifactId>org.eclipse.persistence.jpa</artifactId>
            <version>2.3.2</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.eclipse.persistence</groupId>
            <artifactId>org.eclipse.persistence.jpa.modelgen.processor</artifactId>
            <version>2.3.2</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.eclipse.persistence</groupId>
            <artifactId>org.eclipse.persistence.jpa.modelgen</artifactId>
            <version>2.3.2</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.10</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>net.sf.jasperreports</groupId>
            <artifactId>jasperreports</artifactId>
            <version>4.5.1</version>
        </dependency>
        <dependency>
            <groupId>org.apache.poi</groupId>
            <artifactId>poi</artifactId>
            <version>3.5-FINAL</version>
        </dependency>
        <dependency>
            <groupId>jfree</groupId>
            <artifactId>jfreechart</artifactId>
            <version>1.0.13</version>
        </dependency>
        <dependency>
            <groupId>jfree</groupId>
            <artifactId>jcommon</artifactId>
            <version>1.0.16</version>
        </dependency>
        <dependency>
            <groupId>javax</groupId>
            <artifactId>javaee-api</artifactId>
            <version>6.0</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T08:48:16.663

做了一个superpom。好多了，虽然仍然不完美（但我会问另一个问题）。

# c - Linux 中有哪些常用的 C 库来使用 CD 刻录设备？

> ID：12133670
> 
> 赞同：1
> 
> 时间：2012-08-26T20:33:27.090
> 
> 标签：c, libraries, iso, cd-burning

我对创建使用 CD 刻录设备的软件很感兴趣。我将在 Linux 下用 C 语言编写这段代码，并使用 GCC 进行编译。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T20:34:57.620

[顾名思义， libburn](http://libburnia-project.org) ;)（以及来自同一站点的其他朋友库）。它用于[brasero](http://projects.gnome.org/brasero/) (GNOME)、[xfburn](http://goodies.xfce.org/projects/applications/xfburn) (xfce) 和[cdw](http://cdw.sourceforge.net)。

好吧，*就是这样*。真的，我不知道还有更多的图书馆。

事实上，包装命令行（来自[cdrtools](http://cdrecord.berlios.de/private/cdrecord.html)或[cdrkit](http://cdrkit.org) *）*更为常见，但它们从未提供共享库；这只是运行外部可执行文件（然后解析它们的输出，*丑陋*）的一种古老的 unix 做法。AFAIK 它仍在[k3b](http://cdrecord.berlios.de/private/cdrecord.html)和一些小工具中使用，但总体趋势是向 libburn 迁移。`cdrecord`

# php - PHP __autoload 在输出缓冲区处理函数中不起作用

> ID：12133676
> 
> 赞同：1
> 
> 时间：2012-08-26T20:34:15.230
> 
> 标签：php, autoload, output-buffering

我有以下困境：

```
ob_start('processBuffer');

function processBuffer($buffer){

    $betterBuffer = SomeClass::doSomething($buffer);
    return $betterBuffer;

}

function __autoload($className){

    if($className == 'SomeClass'){ include_once 'some_class.php'; }

} 
```

如果必须第一次在 processBuffer 中加载 SomeClass 类，它不起作用，但如果必须在 processBuffer 函数执行之前加载它，它确实有效。这是为什么？目前，为了规避这个问题，我必须执行以下操作：

```
__autoload('SomeClass');
ob_start('processBuffer'); 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:49:56.133

这很可能是由于 PHP 内部的分层方式造成的。在输出阶段，在执行堆栈的末尾调用您的缓冲区处理函数。它在这种方式上类似于错误处理函数，它们更好地记录了它们能做什么和不能做什么。例如（虽然我没有测试过这个），我希望缓冲区处理函数也不能回显东西（嗯，它可以，但输出可能不会去任何地方）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T21:12:16.283

选项 1 - “完全面向对象”。

在这种情况下，所有缓冲过程都是从类内部控制的。

```
class SomeClass{
    public function __construct(){
        ob_start();
        //. . .
        return (0);
    }

    public function __destruct(){
        // . . . 
        ob_end_flush();
        return (0);
    }
} 
```

选项 2 - “ `__autoload()`”。

缓冲在类之外，但在 __autoload() 魔术函数内部开始。

```
function __autoload($class){
    ob_start();
    if($class == 'SomeClass'){ 
        include_once 'some_class.php'; 
    }
}

$c = new SomeClass();
// . . .
ob_end_flush(); 
```

正如您在[http://php.net/manual/en/function.ob-start.php](http://php.net/manual/en/function.ob-start.php)中看到的，`ob_start()`可调用函数将在`ob_end_flush()`.

# c++ - GLEW 链接错误

> ID：12133686
> 
> 赞同：4
> 
> 时间：2012-08-26T20:35:38.787
> 
> 标签：c++, opengl, glew

我试图从一个网站上整理一个 GLSL 示例程序，这样我就可以对着色器有所了解。

着色器示例程序来自[http://www.swiftless.com/tutorials/glsl/1_setup.html#DL](http://www.swiftless.com/tutorials/glsl/1_setup.html#DL)

```
1>------ Build started: Project: TheLightingExperiment2, Configuration: Debug Win32 ------

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewLinkProgram

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewAttachShader

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewCreateProgram

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewCompileShader

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewShaderSource

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewCreateShader

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewDeleteProgram

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewDeleteShader

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewDetachShader

1>shader.obj : error LNK2001: unresolved external symbol __imp____glewUseProgram

1>C:\Users\Shawn\Desktop\TheLightingExperiment2\Debug\TheLightingExperiment2.exe : fatal error LNK1120: 10 unresolved externals

========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

错误似乎来自 glew 未正确链接。但是我按照 glew 的文档链接 glew @ [http://glew.sourceforge.net/install.html](http://glew.sourceforge.net/install.html)

它仍然给我这些错误。我已将**glew32.lib**放入链接器->输入中。我已经把**glew32.lib**放到了VC lib 目录下，还有glew 包含在VC 的include 目录下。从谷歌搜索我的问题，这似乎是解决方案，但它对我不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-27T00:05:19.543

为自己省去*很多*麻烦，只需添加`glew.c`到您的项目中即可。确保你`#define GLEW_STATIC`，一切都会好起来的。尝试动态链接到 GLEW 是不值得的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-21T16:41:36.037

我使用 VS 遇到了同样的链接问题。

原来你应该使用 Win32 lib 而不是 x64 lib

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T10:31:03.613

使用 GLEW_BUILD 预处理器指令构建 glew（即 glew 项目设置 -> c/c++ -> 预处理器 -> 附加定义）

# java - 将访问 mysql 的 java 应用程序迁移到使用 SQL Server 的代码

> ID：12133688
> 
> 赞同：2
> 
> 时间：2012-08-26T20:35:42.783
> 
> 标签：java, mysql, sql-server, hibernate, struts

我有一个使用 mysql 的 java 应用程序——现在我已将数据库转换为 SQL Server——但我需要转换 java 应用程序的代码，以便它现在使用 SQL Server。

这个 java 应用程序使用 Struts 和 Hibernate

为了进行这种转换，我必须牢记什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:40:46.917

hibernate 应该让你无缝过渡。确保选择正确的驱动程序，因为某些驱动程序可能会有所不同。我个人喜欢[jtds](http://jtds.sourceforge.net/)。它有大量的文档。

在您的代码中查找本机查询，因为它们可能需要一些修改。

除此之外，我认为您不应该遇到任何问题。我有一个支持 oracle、SQL-Server 和 mysql 的应用程序，我们没有针对每一个的特定代码。

编辑：正如 maba 在评论中建议的那样，您需要稍微修改休眠配置（驱动程序、方言、url）。

对于更多休眠特定配置，我找到了一个[很好的stackoverflow答案](https://stackoverflow.com/q/3585544/1068746)

# android - GL 表面和可见性：消失

> ID：12133690
> 
> 赞同：8
> 
> 时间：2012-08-26T20:35:56.523
> 
> 标签：android, glsurfaceview

所以我的应用程序中有一个 GLSurfaceView 由 GLSurfaceView.Renderer 渲染并使用 JPCt 作为库。

表面处于不可见的 RelativeLayout（可见性：消失）中。当我将可见性更改为“可见”然后返回“已消失”时，布局会按预期显示和隐藏，但 GLSurfaceView 不会，它只会显示并且不会隐藏，即使我可以单击现在的项目“背后”。

这似乎是一些图形缓冲区问题，但我没有找到让它工作的方法......有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-26T21:03:53.353

`SurfaceView`（以及`GLSurfaceView`扩展）是 Android 中有趣的野兽。来自 Android javadoc 的引用：

> 表面是 Z 顺序的，因此它位于持有其 SurfaceView 的窗口后面；SurfaceView 在其窗口中打了一个孔以显示其表面。视图层次结构将负责正确地将 SurfaceView 的任何兄弟姐妹与 Surface 合成，这些兄弟通常会出现在其顶部

Android 有一个内置的窗口合成器（这里的窗口有一点不同的含义）。您的状态栏是一个窗口，您的活动有一个窗口。但是，如果您的活动包含表面视图，则会创建另一个窗口，只是为了保持表面，并且 android compositor 会在表面窗口上绘制带有您的视图的窗口。所以这`SurfaceView`实际上只是一个透明区域。当你隐藏它时，该区域不会被绘制，不会对触摸做出反应，但表面窗口仍然存在，android 不够聪明地隐藏窗口。

我会推荐两种解决方案

*   使您的表面半透明。然后，您可以在需要隐藏视图时渲染空表面（[Android，布局中的透明子 GLSurfaceView？](https://stackoverflow.com/questions/2498494/android-transparent-sub-glsurfaceview-in-layout)）
*   完全从视图层次结构中删除视图
*   另一种有点 hacky 的方法是子类化`GLSurfaceView`并`onDetachedFromWindow()`在可见性更改为`GONE`. 我没有对此进行测试，它可能无法正常工作。

# android - 我在哪里可以获得适用于 OS X 10.8.1 (Mountain Lion) 的英特尔硬件加速执行管理器 (HAXM) 驱动程序？

> ID：12133699
> 
> 赞同：2
> 
> 时间：2012-08-26T20:37:11.800
> 
> 标签：android, intel, avd, osx-mountain-lion, hardware-acceleration

我正在尝试从英特尔网站安装最新的驱动程序 - 版本 1.0.1 (R2)。它声明该驱动程序在带有 Mac OS X 10.6 及更高版本（32/64 位）的基于 Intel 的 Mac 上受支持。但是当我尝试安装它时，我收到一条错误消息，指出我的 Mac 不符合最低要求。

请注意，我有一台 2010 年中的 Macbook（白色），它支持 Intel VT-x 并已启用。当我的 Macbook 运行 Snow Leopard (10.6.x) 时，我也安装了这个驱动程序并在它上工作。所以，我猜这与英特尔没有用 Mountain Lion 测试他们的驱动程序有关：)

是否有人对安装此软件或联系英特尔提供此反馈有任何提示？

谢谢！

PS：想用“haxm”标签标记这篇文章，但不能。有更高代表的人可以标记它吗？蒂亚！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T09:37:37.110

HAXM 安装程序中似乎有一个小错误/错误/任何东西，导致检查要求的脚本报告错误结果。使固定：

1.  从[英特尔网站下载 DMG](http://software.intel.com/en-us/articles/intel-hardware-accelerated-execution-manager/)
2.  在 Disk Util 中打开 DMG 并将其转换为可写的磁盘映像
3.  安装 DMG
4.  打开终端，更改为`/Volumes/IntelHAXM_1.0.1/IntelHAXM_1.0.1.mpkg/Contents/Resources`（如有必要，更改路径）。
5.  将补丁（见下文）应用于文件`haxm-req.sh`。
6.  关闭终端，像往常一样运行安装程序包。

补丁：

```
--- haxm-req.sh.old 2012-10-09 11:26:35.000000000 +0200
+++ haxm-req.sh 2012-10-09 11:27:01.000000000 +0200
@@ -4,7 +4,7 @@
 "$fullpath/haxm-check"
 result=$?
 if ! [ $result -eq 0 ]; then
-   TRUE;
+   /usr/bin/true;
 else
-   FALSE;
+   /usr/bin/false;
 fi 
```

要应用补丁，`patch -p0 < haxm-req.patch`如果您将其保存在目录中的文件`haxm-req.patch`中，请运行`Resources`。

# android - 获取特定文本以显示在文本视图中

> ID：12133711
> 
> 赞同：1
> 
> 时间：2012-08-26T20:38:26.303
> 
> 标签：android, textview

这一直困扰着我，我是初学者，似乎无法弄清楚这一点。这是我的代码：

```
package com.example.imhungry;

import java.util.Random;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.Button;

public class ImHungry extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_im_hungry);

        final Button button1 = (Button) findViewById(R.id.button1);
        button1.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                // Perform action on click
                Random randomGenerator = new Random();
                int randomInt = randomGenerator.nextInt(9);
                String wordToDisplay = wordList[randomInt];
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_im_hungry, menu);
        return true;
    }

    Random randomGenerator = new Random();
    int randomInt = randomGenerator.nextInt(9);
    String wordList[] = new String[9];
    {
        wordList[0] = "Mexican";
        wordList[1] = "American";
        wordList[2] = "Barbeque";
        wordList[3] = "Chinese";
        wordList[4] = "Indian";
        wordList[5] = "Italian";
        wordList[6] = "Thai";
        wordList[7] = "Viatnamese";
        wordList[8] = "Middle Eastern";

    }

 String wordToDisplay = wordList[randomInt];

} 
```

基本上我试图让 wordToDisplay 出现在我的 textView 中，但我不知道该怎么做。

```
 <TextView

        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:padding="@dimen/padding_medium"
        android:text=""
        tools:context=".ImHungry" /> 
```

另外，很抱歉问了这么多问题，我是新手。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:43:50.680

要让您的测试出现在 TextView 中，您必须使用 进行设置`setText();`，所以基本上您必须分配您的 textview id 或标签（添加`android:id="@+id/mytextview`）然后获取该对象`TextView tv = (TextView)findViewById(R.id.mytextview); tv.setText("foo");`我还建议您阅读一些有关 android 基础知识的教程 - 会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:45:19.557

将 id 添加到 TextView：

```
 <TextView
    android:id="@+id/text_random_text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:padding="@dimen/padding_medium"
    android:text=""
    tools:context=".ImHungry" /> 
```

在代码中执行以下操作：

在按钮之后添加：

```
final TextView textView = (TextView) findViewById(R.id.text_random_text); 
```

将 wordToDisplay 设置为 onClick(View v) 方法中的文本

```
textView.setText(wordToDisplay); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:49:02.033

为了提高效率，试试这个：

```
public class ImHungry extends Activity {
    Random mRandomGenerator = new Random();
    TextView mTextView;
    String mWordList[] = new String[] { 
        "Mexican", "American", "Barbeque",
        "Chinese", "Indian", "Italian",
        "Thai", "Viatnamese", "Middle Eastern" };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_im_hungry);

        mTextView = (TextView) findViewById(R.id.textView);
        final Button button1 = (Button) findViewById(R.id.button1);
        button1.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                // Perform action on click
                mTextView.setText(mWordList[mRandomGenerator.nextInt(9)]);
            }
        });
    }
} 
```

您可以删除其余代码。

只需要创建一个随机数对象，如果只使用一次，则不需要将随机整数或对应的字符串保存在局部变量中。但是，如果您想提高可读性，可以将它们保存在局部变量中。

# ruby-on-rails - Rails 3中strftime的未定义方法错误

> ID：12133713
> 
> 赞同：0
> 
> 时间：2012-08-26T20:38:31.453
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, debugging

我刚开始学习 Rails，我在尝试格式化时间时遇到了麻烦。我有一个包含许多联系日志的票证模型，我想在视图中格式化 created_at 时间戳。当我使用此代码时：

```
<% @contacts.each do |contact| %>
  <p><%= contact.created_at.strftime("%B %e, %Y") %></p>
  <p><%= contact.author %></p>
  <p><%= contact.description %><p>
<% end %> 
```

要打印与工单关联的联系人，页面会显示错误：

```
undefined method `strftime' for nil:NilClass 
```

但是，当我使用

```
<% @contacts.each do |contact| %>
  <p><%= contact.created_at %></p>
  <p><%= contact.author %></p>
  <p><%= contact.description %><p>
<% end %> 
```

打印日期（类似于 2012-08-26 05:16:15 UTC），以及作者和描述的预期值。

我查看了数据库中联系人对象的所有时间戳值，除了时间之外，没有任何一个 created_at 值。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T21:17:36.093

也许您的一条记录已 created_at 设置为 nil，试试这个：

```
<p><%= contact.created_at.present? ? contact.created_at.strftime("%B %e, %Y") : contact.created_at%></p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T22:38:48.090

`created_at`不仅可以返回字符串。你试过这个： `<%= contact.created_at.to_s.strftime("%B %e, %Y") %>`？

# c - 将结构写入 .dat 文件

> ID：12133714
> 
> 赞同：1
> 
> 时间：2012-08-26T20:38:32.987
> 
> 标签：c

代码

```
struct Student
{
unsigned int ID;
char name[256];
int FileLocLeft;
int FileLocRight;
int FileLocParent;
};

void main()
{
Student CurStudent;

FILE* fp = fopen("d:\\students.bat", "w");
if(fp == NULL)
{
    printf("File not found\n");
}
else
{
    fseek(fp,0,SEEK_SET);
    CurStudent.FileLocLeft = 0;
    CurStudent.FileLocParent = 0;
    CurStudent.FileLocRight = 0;
    CurStudent.ID = 0;
    CurStudent.name = "Root";
    fwrite(CurStudent,sizeof(Student),1,fp);
}
} 
```

我遇到了两个错误，一个是我无法将“Root”（const char[15]）分配给名称（char[256]），并且在使用 fwrite 时，我得到“无法将参数 1 从 'Student' 转换为 'const空白'”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:40:37.647

您不能像在 C 中那样分配给一个数组并且`fwrite`需要一个指针，您不能传递一个结构。怎么样：

```
strcpy(CurStudent.name, "Root");
fwrite(&CurStudent, sizeof(CurStudent), 1, fp);
       ^ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:40:36.843

1.  字符串不过是`char`数组。C 中有一些特殊的函数可以`str`帮助处理这些问题。
2.  获取结构变量的地址，`fwrite`需要一个指向数据的指针。

# c# - MVC3如何使用@ 作为 html 辅助参数

> ID：12133716
> 
> 赞同：6
> 
> 时间：2012-08-26T20:38:47.807
> 
> 标签：c#, asp.net-mvc-3, lambda, html-helper

我对创建 MVC3 助手有点迷茫。我有我的助手，它只是创建一个带有作为参数传递的表达式的行。

我想像这样使用我的 htmlHelper：

```
@Html.AddTableFormField(model => model.UserName, @<text>
        @Html.EditorFor(m => m.UserName)<span class="warning">Use only letters</span>
    </text>) 
```

这是我的 HtmlHelper（删除了一些不相关的代码）：

```
public static MvcHtmlString AddTableFormField<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> property, Expression<Func<TModel>> customFormat = null)
    {
        var metadata = ModelMetadata.FromLambdaExpression(property, htmlHelper.ViewData);

        string displayName = metadata.DisplayName;

        var propName = metadata.PropertyName;

        if (string.IsNullOrWhiteSpace(displayName))
            displayName = propName;

        MvcHtmlString htmlCustomFormat = null;

        if (customFormat != null)
        {
            var deleg = customFormat.Compile();
            htmlCustomFormat = new MvcHtmlString(deleg().ToString());
        }
        else
            htmlCustomFormat = htmlHelper.EditorFor(property);

        return new MvcHtmlString(string.Format("<tr>"+
                "<td class=\"form-label\">"+
                    "<label class=\"editor-label\" for=\"{0}\">{1}<label>"+
                "</td>"+
                "<td class=\"form-data\">"+
                    "{2}"+
                "</td>"+
            "</tr>",
            propName, displayName, htmlCustomFormat));
    } 
```

我什至无法编译它，因为该*`@<text>...</text>`*参数对 HtmlHelper 无效，因为它是“lambda 表达式”，无法转换为 Expression>

任何人都可以帮助解决它？我只想将任何类型的内容传递`@<text></text>`给我的 HtmlHelper，它只是对其进行编译并将其 MvcHtmlString 放入格式化的返回中。

**解决方案：**

我在这篇文章中找到了我正在寻找的内容： [ASP.Net MVC3 - Pass razor markup as a parameter](https://stackoverflow.com/questions/9157772/asp-net-mvc3-pass-razor-markup-as-a-parameter)

的参数类型`@<text></text>`必须是`Func<object, HtmlHelper>`!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T23:26:06.103

我在这篇文章中找到了我正在寻找的内容： [ASP.Net MVC3 - Pass razor markup as a parameter](https://stackoverflow.com/questions/9157772/asp-net-mvc3-pass-razor-markup-as-a-parameter)

的参数类型`@<text></text>`必须是`Func<object, HelperResult>`!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:54:23.827

这`<text>...</text> or @:`是一个 Razor 语法（不是 C#）来避免 html 元素，所以我的建议是你使用字符串作为参数而不是`@<text>`

# ruby-on-rails-3.2 - Ruby on Rails 中的路由和命名空间

> ID：12133721
> 
> 赞同：1
> 
> 时间：2012-08-26T20:39:21.670
> 
> 标签：ruby-on-rails-3.2

Ruby on Rails 应用程序的一部分代码：

```
 #routes.rb
        namespace :admin do
              root :to => 'admin#index'
              resources :orders, :products
        end

  #controllers/admin/admin_contrller.rb
    class Admin::AdminController < ApplicationController
       def index

       end
    end 
```

该`index`视图位于`views/admin/index.html.haml`. 但是，它没有找到它（`http://localhost:3000/admin`，**缺少模板**）。只有当它位于`views/admin/admin/index.html.haml`.

我做错了什么？我应该怎么做才能找到视图`views/admin/index.html.haml`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T22:14:00.857

您已经创建了命名空间 :admin 并将根路径和订单资源放在那里。根路径指向`index`. `AdminController`有了这个配置，rails 将在第一个管理员是命名空间，第二个是控制器目录`index.html.haml`下查找视图。`views/admin/admin/index.html.haml`

你没有做错什么。这就是rails的工作方式。

我会建议，而不是试图找到视图`views/admin/index.html.haml`来简单地将`AdminController`名称更改为`DashboardController`并创建`BaseController`为`admin/`目录下所有控制器的基类。

应用程序/控制器/管理员/admin_controller.rb

```
class Admin::BaseController < ApplicationController
  #auth etc.
end 
```

应用程序/控制器/管理员/dashboard_controller.rb

```
class Admin::DashboardController < Admin::BaseController

end 
```

通过这种方式，您可以轻松添加身份验证、授权、不同布局等以及管理控制器所需的其他内容

但是，如果您真的想对您的解决方案感到厌烦，您可以`render admin/index`像这样简单地执行索引操作：

```
class Admin::AdminController < ApplicationController
  def index
    render "admin/index"
  end
end 
```

# xaml - 从 ScrollViewer 中的几个 GridView 准备 Windows 8 XAML HubPages 是好方法吗？

> ID：12133725
> 
> 赞同：0
> 
> 时间：2012-08-26T20:39:39.127
> 
> 标签：xaml, gridview, windows-runtime, microsoft-metro, winrt-xaml

我想在图片上看到效果：

![](../Images/e8d68328b3e36d3bfb16f4fa782e3b87.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T04:11:26.893

我不认为它是。GridView 本身已经有一个 ScrollViewer，所以它们中的多个没有意义。我会尝试将单个 GridView 与[GroupStyleSelector](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.itemscontrol.groupstyleselector.aspx) / [ItemContainerStyleSelector](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.itemscontrol.itemcontainerstyleselector.aspx) / [ItemTemplateSelector](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.itemscontrol.itemtemplateselector.aspx) implementations 和 DataTemplates 一起使用来定义每个项目。如果您将 GridView 绑定到某些组或其他面板以定义内容，则动态较少的版本可能只是 Style 设置为 Horizo​​ntalScrollViewerStyle、水平 StackPanel 和一些 VariableSizedWrapGrids 的 ScrollViewer。

[根据描述，这](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/966aa897-1413-46f0-bef7-663de36f9423)看起来像是一个很好的示例（尽管我似乎缺少图像）。

# android - 在 Android 中读取默认浏览器的 cookie

> ID：12133728
> 
> 赞同：0
> 
> 时间：2012-08-26T20:40:13.147
> 
> 标签：android

我正在构建一个可以使用默认浏览器从我的 Web 服务器下载的应用程序。当用户开始下载应用程序时，我实际上是在创建一个 cookie 并将其保存在他们的设备上。

出于某种原因，我只需要在他们首次启动安装应用程序后读取我为他们设置的 cookie。

因此，我需要一种方法来读取我之前为他们设置的浏览器 cookie 的值，当他们从我的服务器安装应用程序时。

如果它有助于解决问题，我不介意放置隐藏的 Web 视图。

所以回顾一下，我需要在我的应用程序中读取在默认浏览器中设置的特定 cookie 的值（假设我有 cookie 名称和网站 URL）。

请指教...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:52:39.387

> 我需要在我的应用程序中读取在默认浏览器中设置的特定 cookie 的值（假设我有 cookie 名称和网站 URL）

幸运的是，出于明显的隐私和安全原因，这是不可能的。应用程序无法从浏览器中读取 cookie。

# objective-c - 使用 iCloud UI 自定义 NSOpenPanel

> ID：12133730
> 
> 赞同：3
> 
> 时间：2012-08-26T20:40:14.880
> 
> 标签：objective-c, cocoa, icloud, nsopenpanel

我正在使用 iCloud 存储文档。因此，当用户选择“打开文件...”时，会显示带有 iCloud UI 的 NSOpenPanel。它包含“新建文档”按钮，但我的应用程序已注册为该扩展程序的查看器。如何自定义 NSOpenPanel 以隐藏此按钮。我没有为此找到任何api。例如，Apple Preview 不显示“新建文档”按钮...</p>

# iphone - 使用 cocos2d 显示一个网站

> ID：12133732
> 
> 赞同：1
> 
> 时间：2012-08-26T20:40:27.750
> 
> 标签：iphone, ios, uiwebview, cocos2d-iphone

我需要在一个 cocos 2d 游戏中加载一个网站。

例如，当单击 ccmenu 按钮时，我需要替换必须加载特定网站的场景。

请有任何想法，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T23:01:21.497

听起来您想从服务器获取游戏数据，对吗？在这种情况下，您可能不想加载 HTML 页面。相反，想出一种以更合适的文件格式存储相关游戏数据的方法。我不能肯定地说，因为我对您的游戏一无所知，但是将您的游戏数据保存为 XML 可能会很好。然后，当您需要使用服务器中的数据更新游戏时，请使用`NSURLRequest`或类似文件下载 XML 文件，然后您可以根据需要对其进行解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-07T06:03:33.173

查看 CCHttpRequest 或 CCHttpClient。

# android - 带有位图标记的 Android XML 可绘制圆角

> ID：12133735
> 
> 赞同：5
> 
> 时间：2012-08-26T20:40:37.733
> 
> 标签：android, xml, xml-drawable

我有下一个 XML 可绘制 blue_button

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
  <item>
    <layer-list>
      <item><bitmap android:src="@drawable/button_blue_bg" />
      </item>
      <item >
         <shape>
                <corners android:radius="50dip" />
                <stroke android:width="1dip" android:color="#ccffffff" />
                <solid android:color="#00000000" />
                <padding android:bottom="3dip" 
                         android:left="3dip"
                         android:right="3dip"
                         android:top="3dip" />
         </shape>
       </item>
     </layer-list>
  </item>
</selector> 
```

我有 1px 宽度的渐变图像 button_blue_bg。

当我设置按钮背景时，我得到下一张图片

![在此处输入图像描述](../Images/b67955b9b7132a3da5eeb3c27bff0f52.png)

如您所见，我的背景没有被圆形边框剪裁。

我如何需要修改 xml 以使背景渐变图像不在边框之外？

我理解它发生的原因，因为我使用了层——所以这就像三明治——但我也在目标 c 上编程，而且它也使用了层。但在苹果公司这很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T17:22:51.140

我用这个....首先是基本定义的图层，将此图层设置为布局的背景：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
  <item>
    <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle">
        <stroke android:width="0.2dp" android:color="@color/anycolor" />
        <corners android:radius="10dp" > </corners> 
    </shape>
  </item>
  <item>
      <bitmap android:src="@drawable/imgback" />
  </item>
 </layer-list> 
```

我使用此功能制作圆角：

```
 public static Bitmap getRoundedCornerBitmap(Bitmap bitmap) {

        Bitmap output = Bitmap.createBitmap(bitmap.getWidth(),
            bitmap.getHeight(), Config.ARGB_8888);
        Canvas canvas = new Canvas(output);

        final int color = 0xff424242;
        final Paint paint = new Paint();
        final Rect rect = new Rect(0, 0, bitmap.getWidth(), bitmap.getHeight());
        final RectF rectF = new RectF(rect);
        final float roundPx = 12;

        paint.setAntiAlias(true);
        canvas.drawARGB(0, 0, 0, 0);
        paint.setColor(color);
        canvas.drawRoundRect(rectF, roundPx, roundPx, paint);

        paint.setXfermode(new PorterDuffXfermode(Mode.SRC_IN));
        canvas.drawBitmap(bitmap, rect, rect, paint);

        return output ;
      } 
```

最后，活动中的代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.menu);
    // i use a Relative Layout  
    RelativeLayout rl = (RelativeLayout) findViewById(R.id.rlmenu);
    // Obtain then backgroud of RelativeLayout
    LayerDrawable layer = (LayerDrawable) rl.getBackground();
    // obtain the image set in the Layer
    BitmapDrawable bg = (BitmapDrawable) layer.getDrawable(1);
    // create a new BitmapDrawable from the function
    Drawable d =new BitmapDrawable(getRoundedCornerBitmap(bg.getBitmap()));
    // set the new roundcorner image in the layer
    layer.setDrawableByLayerId(1, d);
    rl.setBackgroundDrawable(d);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T20:46:34.027

[9 补丁](http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch)将非常适合您的情况

# c - 算术赋值运算符 - 左侧仅评估一次

> ID：12133739
> 
> 赞同：3
> 
> 时间：2012-08-26T20:41:13.117
> 
> 标签：c, variable-assignment

正如标题所说，我在一些 C 讲义中找到了这样一个句子。

我无法发明任何证明这句话的例子。

在我看来，每个赋值操作都会被评估一次，因为当我们希望它被多次评估时，我们会进入一个循环。那我错过了什么？

我已经搜索但在 SO 上找不到答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T20:43:37.677

C 说：

> （C99，6.5.16.2p3）“形式为 E1 op= E2 的复合赋值与简单赋值表达式 E1 = E1 op (E2) 的不同之处仅在于左值 E1 仅计算一次。”

以下是一些为什么重要的例子：

**示例 1：**

```
 a[i++] += 1; 
```

是相同的：

```
 a[i] = a[i] + 1; i++; 
```

因为 的左操作数`+=`被评估一次。

如果它没有被评估一次，它将与以下内容相同：

```
a[i++] = a[i++] + 1; 
```

这当然是不同的（顺便说一句未定义的行为）。

**示例 2：**

```
*foo() += 1; 
```

假设`foo`这里返回一个指向标量类型对象的指针并产生副作用（例如，它在终端上打印一个字符串）。使用复合赋值运算符，它将只打印一次字符串，而不是两次。

~~**示例 3：**~~

 ~~```
REG |= 0x01; 
```~~ 

~~假设`REG`这里是一个 IO 寄存器（类似于 `#define REG (*(volatile uint8_t *) 0x42)`），并且每次读取这个特定的 IO 寄存器都会触发一个硬件事件。使用复合赋值运算符将只读取一次寄存器，而不是两次。~~

**编辑**：跟随[@R。](https://stackoverflow.com/users/379897/r)评论我打了这个例子3。我认为大多数编译器不会在这个表达式中执行一次读取：`REG = 31`或使用这个表达式进行两次读取：`REG = REG | 0x01`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T21:03:02.500

通常`+=`操作符的引入方式如下：

```
x += y;
x = x+y; // does the same 
```

`=`但是，注释试图告诉您这实际上是不准确的，因为and的左侧`+=`可能是任何表达式。正如其他人所说，这可能导致不确定的行为，但这不是问题的核心。

例如：

```
char* f() {
  static char value = 'a';
  printf("%c\n",value);
  return &value;
}

void g() {
  *f() = 'b'; // assigns 'b' which was 'a'
  *f() += 2; // changes 'b' to 'd'
  *f() = 'b';
  *f() = *f() + 2; // changes 'b' to 'd'
} 
```

不同之处在于`f`在最后一行执行两次，而在第二行执行一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T20:45:53.753

您的问题非常不清楚且措辞不佳，但我怀疑您的注释所指的是算术+赋值运算符的组合允许您在不多次编写（并因此评估）左值表达式的情况下执行某些操作。例如，

```
*p++ += *q++;  /* p is incremented once, as desired */
*p++ = *p++ + *q++;  /* undefined behavior */ 
```

当您在宏中使用这些时尤其重要，例如：

```
#define ACCUM(d,s) (d)+=(s) /* good */
#define ACCUM(d,s) (d)=(d)+(s) /* dangerous */ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T20:59:12.457

没有任何东西可以方便地编译，但这里有一个有趣的花絮：

`var1 += var++`会将 var1 的值更改为`var1 + var`

然而

`var1 += ++var`会将 var1 的值更改为`var1 + (var + 1)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T20:59:22.527

C 中有一些复合**赋值操作**，例如**+=,-=, *=,/=,%=**

例如**i += 1**它像**i++一样将 i 的值增加****1 。**

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-12T19:31:58.157

有许多复合赋值运算符。例如。`+=,-=,*=,/=,%=`

`a+=b`更多`give a=a+b` 详情请[点击](http://csetips.sparkscoop.com/c-operators/)这里**

# javascript - 从气球弹出窗口中删除地标

> ID：12133744
> 
> 赞同：1
> 
> 时间：2012-08-26T20:42:24.730
> 
> 标签：javascript, dom-events, google-earth-plugin

我正在为我正在编写的应用程序尝试使用 Google 地球插件 API。我希望能够从地图中删除地标。我能想到的最简单的方法是创建一个带有“删除”链接的气球弹出窗口，但我一直无法弄清楚如何删除：

```
balloon.setContentString(
'Location: ' + event.getLatitude().toString() + ", " +
event.getLongitude().toString() + '<br />&nbsp;<br />' +
'<a href="#" onclick="ge.getFeatures().removeChild(event.getCurrentTarget())">Delete</a><br /><a href="#" onclick="prompt(\'Enter new name\', \'blah\'\)">Rename</a>'); 
```

这导致：

```
Uncaught TypeError: Object #<MouseEvent> has no method 'getCurrentTarget' earth2.html:1 onclick 
```

（如您所见，我也希望能够重命名，但大概在我想出删除时不会那么难弄清楚？）

整个代码可以在以下位置找到：

[http://chrishowells.co.uk:81/earth2.html](http://chrishowells.co.uk:81/earth2.html)

整个区块：

```
google.earth.addEventListener(ge.getWindow(), 'mousedown', function(event) {
if (event.getTarget().getType() == 'KmlPlacemark' &&
    event.getTarget().getGeometry().getType() == 'KmlPoint') {
  // don't show the default popup
  //http://code.google.com/apis/ajax/playground/?exp=earth#javascript_in_balloons
  event.preventDefault();

var balloon = ge.createHtmlStringBalloon('');
balloon.setFeature(event.getTarget());
//balloon.setMaxWidth(300);

balloon.setContentString(
  'Location: ' + event.getLatitude().toString() + ", " +
event.getLongitude().toString() + '<br />&nbsp;<br />' +
'<a href="#" onclick="ge.getFeatures().removeChild(event.getCurrentTarget())">Delete</a><br /><a href="#" onclick="prompt(\'Enter new name\', \'blah\'\)">Rename</a>');
ge.setBalloon(balloon);

var placemark = event.getTarget();

dragInfo = {
    placemark: event.getTarget(),
    dragged: false
  };
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T12:38:13.320

你得到的错误是告诉你到底是什么问题。

```
 Object #<MouseEvent> has no method 'getCurrentTarget' 
```

问题在于，在`onclick`锚点的事件处理程序中，`event`变量引用的是点击链接而不是点击地标。那是`event`一个 DOM 鼠标事件而不是 KmlMouseEvent。

此外，您需要调用以引用最初分派 KMLEvent 的对象的方法是`getTarget`.

请参阅 KmlEvent.getTarget 的 API 指南： [https ://developers.google.com/earth/documentation/reference/interface_kml_event#adfee4d0797ff7d437e77c649673f9ffc](https://developers.google.com/earth/documentation/reference/interface_kml_event#adfee4d0797ff7d437e77c649673f9ffc)

要解决这个问题，您需要做很多事情，首先定义一个全局变量来保存任何当前的地标点击事件。在定义变量的脚本顶部执行此操作，同时`ge`添加一个`currentEvent`变量。IE

```
var ge = null; 
var currentEvent = null; 
```

其次，您的`mousedown`侦听器应该被修改以允许气球中的 javascript 引用`currentEvent`您定义的变量。

最后，您应该使用该`currentEvent`变量来引用地标，以通过气球中的代码将其删除。

例如。

```
google.earth.addEventListener(ge.getWindow(), 'mousedown', function(event) {

    if (event.getTarget().getType() == 'KmlPlacemark' &&
    event.getTarget().getGeometry().getType() == 'KmlPoint') {
        currentEvent = event; // used in the balloon content string
        event.preventDefault();

        var balloon = ge.createHtmlStringBalloon('');
        balloon.setFeature(event.getTarget());

        balloon.setContentString(
        'Location: ' + event.getLatitude().toString() + ", " +
        event.getLongitude().toString() + '<br />&nbsp;<br />' +
        '<a href="#" onclick="ge.getFeatures().removeChild(currentEvent.getTarget());ge.setBalloon(null);">Delete</a><br /><a href="#" onclick="prompt(\'Enter new name\', \'blah\'\)">Rename</a>');
        ge.setBalloon(balloon);

        dragInfo = {
            placemark: event.getTarget(),
            dragged: false
        };
    }
}); 
```

我已经对此进行了全面测试，并且当您单击`delete`地标被删除并且当前气球关闭时，它可以正常工作。

# winforms - 以 en-US 文化保存的 dateTimeString 在解析 fr-FR 文化时引发格式异常

> ID：12133750
> 
> 赞同：0
> 
> 时间：2012-08-26T20:43:36.827
> 
> 标签：winforms, c#-2.0, globalization

我正在将 DateTime 转换为 en-US 文化中的字符串。

dateTimeString = dateTime.ToString();

但是，如果我在 fr-FR 文化中启动我的应用程序并尝试使用以下语句进行解析

DateTime.Parse(dateTimeString, CultureInfo.CurrentCulture);

它抛出 FormatException。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:59:09.897

是的，这将是一个问题。

DateTime 上的常规`ToString()`将生成这样的日期字符串，用于`en-US`：

```
"8/26/2012 8:54:16 PM" 
```

因为`fr-FR`它会生成这个：

```
"26/08/2012 20:54:16" 
```

因此，如果您尝试将第一个字符串（en-US）解析为 fr-FR 日期时间字符串，则 26 将被视为无效月份，并且`FormatException`预期为 a。

编辑：日期/时间可能有点痛苦。对于可移植性（跨文化格式和时区），如果您需要序列化为字符串，我建议以`ISO 8601`格式序列化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T21:03:56.023

正如[jglouie](https://stackoverflow.com/a/12133871/59303)所说，您无法解析不同文化中的日期时间字符串。

您将不得不使用“en-US”对其进行解析。

```
DateTime.Parse(dateTimeString, CultureInfo.CreateSpecificCulture("en-US")); 
```

没有其他方法可以绕过它。

最好的解决方案可能是在将 a 转换`DateTime`为 a`string`并将`string`back解析为 a 时使用不变的文化`DateTime`。无论运行应用程序的计算机的设置如何，这都会为您提供一致的结果。

# algorithm - 递归、记忆和动态编程有什么区别？

> ID：12133754
> 
> 赞同：63
> 
> 时间：2012-08-26T20:43:53.553
> 
> 标签：algorithm, recursion, dynamic-programming, memoization

> **可能的重复：**
> [动态编程和记忆：自上而下与自下而上的方法](https://stackoverflow.com/questions/6164629/dynamic-programming-and-memoization-top-down-vs-bottom-up-approaches)

我已经阅读了很多关于此的文章，但似乎无法理解。有时递归和动态编程看起来一样，而在其他时候，记忆化和动态编程看起来很相似。有人可以向我解释有什么区别吗？

PS 如果您可以在同一问题上使用三种方法向我指出一些代码，这也会很有帮助。（例如斐波那契数列问题，我认为我阅读的每篇文章都使用了递归，但将其称为动态规划）

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-08-26T22:18:04.910

考虑计算斐波那契数列：

纯递归：

```
int fib(int x)
{
    if (x < 2)
        return 1;

    return fib(x-1) + fib(x-2);
} 
```

导致调用次数呈指数增长。

带有记忆/DP的递归：

```
int fib(int x)
{
    static vector<int> cache(N, -1);

    int& result = cache[x];

    if (result == -1)
    {
        if (x < 2)
            result = 1;
        else
            result = fib(x-1) + fib(x-2);
    }

    return result;
} 
```

现在我们第一次有线性的调用次数，之后保持不变。

上述方法称为“懒惰”。我们在第一次被要求时计算较早的术语。

以下也将被视为 DP，但没有递归：

```
int fibresult[N];

void setup_fib()
{
    fibresult[0] = 1;
    fibresult[1] = 1;
    for (int i = 2; i < N; i++)
       fibresult[i] = fibresult[i-1] + fibresult[i-2];
}

int fib(int x) { return fibresult[x]; } 
```

这种方式可以被描述为“渴望”、“预缓存”或“迭代”。它总体上更快，但我们必须手动找出需要计算子问题的顺序。这对于斐波那契来说很容易，但对于更复杂的 DP 问题，它会变得更难，所以如果它很快，我们就会退回到惰性递归方法足够。

此外，以下既不是递归也不是 DP：

```
int fib(int x)
{
    int a = 1;
    int b = 1;
    for (int i = 2; i < x; i++)
    {
        a = a + b;
        swap(a,b);
    }
    return b;
} 
```

它使用恒定空间和线性时间。

为了完整起见，我还要提到斐波那契的封闭形式，它使用下界递归或 DP，它允许我们使用基于黄金比例的数学公式在恒定时间内计算斐波那契项：

[http://www.dreamincode.net/forums/topic/115550-fibonacci-closed-form/](http://www.dreamincode.net/forums/topic/115550-fibonacci-closed-form/)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-08-26T21:54:45.007

好吧，*递归+记忆*正是*动态编程*的一种特殊“风格” ：按照*自顶向下的*方法进行动态编程。

更准确地说，不需要专门使用*递归*。任何与记忆相结合的分治解决方案都是自上而下的动态编程。（递归是分治法的 LIFO 风格，而您也可以使用 FIFO 分治法或任何其他类型的分治法）。

所以更正确的说法是

```
divide & conquer + memoization == top-down dynamic programming 
```

此外，从非常正式的角度来看，如果您为不产生重复部分解决方案的问题实施分治解决方案（这意味着记忆化没有好处），那么您可以声称这种分治解决方案是“动态规划”的退化示例。

然而，*动态规划*是一个更普遍的概念。动态编程可以使用自下而上的方法，这与分治法+记忆法不同。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-08-26T20:56:07.847

我相信您可以在互联网上找到详细的定义。这是我简化事情的尝试。

递归再次调用自己。

动态规划是一种解决具有特定结构（最佳子结构）的问题的方法，其中问题可以分解为与原始问题相似的子问题。显然，可以调用递归来解决 DP。但这不是必需的。无需递归即可解决 DP。

记忆是一种优化依赖递归的DP算法的方法。重点不是再次解决已经解决的子问题。您可以将其视为子问题解决方案的缓存。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-08-26T23:09:24.587

它们是不同的概念。它们经常重叠，但它们是不同的。

每当函数直接或间接调用自身时，就会发生递归。这就是全部。

例子：

```
a -> call a
a -> call b, b -> call c, c -> call a 
```

[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)是指您使用较小的子问题的解决方案来解决较大的问题。这是最容易递归实现的，因为您通常会根据递归函数来考虑此类解决方案。不过，通常首选迭代实现，因为它需要更少的时间和内存。

Memoization is used to prevent recursive DP implementation from taking a lot more time than needed. Most times, a DP algorithm will use the same subproblem in solving multiple large problems. In a recursive implementation, this means we will recompute the same thing multiple times. Memoization implies saving the results of these subproblems into a table. When entering a recursive call, we check if its result exists in the table: if yes, we return it, if not, we compute it, save it in the table, and then return it.

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-08-26T20:46:02.723

递归与记忆和动态编程绝对无关；这是一个完全独立的概念。

否则，这是一个重复的问题：[动态编程和记忆：自下而上与自上而下的方法](https://stackoverflow.com/questions/6164629/dynamic-programming-and-memoization-top-down-vs-bottom-up-approaches)

# java - 如何使用 Google Guava 字典按对象字段迭代对象列表？

> ID：12133756
> 
> 赞同：2
> 
> 时间：2012-08-26T20:44:07.963
> 
> 标签：java, list, sorting, object, guava

就像是：

```
Ordering<Iterable<ImportXmlRecord>> comparator =
                Ordering.natural().lexicographical().onResultOf(); 
```

但是按 ImportXmlRecord 字段排序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T22:52:31.400

不完全的：

```
Ordering<Iterable<ImportXmlRecord>> comparator = Ordering.natural()
  .onResultOf(new Function<ImportXmlRecord, Whatever>() {
    public Whatever apply(ImportXmlRecord x) { return x.getWhatever(); }
  }.lexicographical(); 
```

# android - 向 Jelly Bean 中的通知添加操作时的灰色按钮

> ID：12133759
> 
> 赞同：10
> 
> 时间：2012-08-26T20:44:33.550
> 
> 标签：android, android-notifications, android-4.2-jelly-bean

我将两个按钮添加到我的应用程序中设置为 API 级别 8 的通知中。问题是这两个按钮显示为两个大的灰色按钮，与其余通知完全不合适。我已经在 Nexus 7 和 Galaxy Nexus 上对其进行了测试。

![在此处输入图像描述](../Images/0d8b33c53cf30d03abb5489e7b0896cf.png)

我见过的所有示例都有漂亮的黑色按钮，例如来电通知： [http ://www.androidng.com/wp-content/uploads/2012/07/android-jelly-bean-notifications.jpeg](http://www.androidng.com/wp-content/uploads/2012/07/android-jelly-bean-notifications.jpeg)

我想这很容易，但今天没有这样的运气。有谁知道我可能在哪里走错了路？下面是我的代码片段，它使用最新的支持库生成通知。

```
NotificationManager nm = (NotificationManager) this
            .getSystemService(Context.NOTIFICATION_SERVICE);
android.support.v4.app.NotificationCompat.Builder builder = new android.support.v4.app.NotificationCompat.Builder(this);
    builder.setContentIntent(contentIntent)
                .setSmallIcon(R.drawable.ic_stat_radio)                
                .setContentTitle(message)
                .setTicker(message) 
                .setPriority(android.support.v4.app.NotificationCompat.PRIORITY_HIGH)
                .setWhen(System.currentTimeMillis())
                .setAutoCancel(false)                   
                .addAction(android.R.drawable.ic_btn_speak_now, "Play", contentIntent)
                .addAction(android.R.drawable.ic_dialog_map, "Stop", contentIntent)
                .setContentText(message);

    Notification n = builder.build();

    //nm.notify(0, n);
    startForeground(1, n); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-27T22:37:46.873

之所以发生这种情况，是因为您的 AndroidManifest.xml 中的 targetSdk < 11。

我相信当你瞄准 11 时发生的兼容性变化是默认主题，因为 Holo。由于您（和我）的目标小于 11，因此它采用了一些适用于这些按钮的兼容性主题，即使它不应该这样做。我假设即使您的应用程序/活动设置为 Holo，它实际上并不适用于通知，因为它们处于不同的进程中。

这只是我的猜测。使用 CommonsWare 的通知演示并只需修改 targetSdk 即可显示此行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-24T14:03:28.477

我有同样的问题，使用`Android studio (0.8.11)`with`Gradle (0.13.0)`

```
compileSdkVersion 20
buildToolsVersion "20.0"

defaultConfig {
        applicationId "x.xx.xxxxxx"
        minSdkVersion 10
        targetSdkVersion 20
        versionCode x
        versionName "x.xx"
    } 
```

通过添加`uses-sdk`来解决它`Manifest`

```
<uses-sdk
        android:minSdkVersion="10"
        android:targetSdkVersion="20" /> 
```

我知道该`Manifest`值将被值**覆盖**`Gradle`。但这解决了它。

# jquery - 当一个类被添加到子类时，从父类中移除一个类

> ID：12133769
> 
> 赞同：0
> 
> 时间：2012-08-26T20:45:43.713
> 
> 标签：jquery

当输入不正确的密码时，错误类别会添加到输入字段。当输入正确的密码时，一个名为“Valid”的类被添加到包含密码输入标签的 li 中。当输入字段上出现错误类时，如何删除 li 上的有效类。

```
<li class="Valid">
        <input type="password" class="error" placeholder="Password" id="aim_Password" name="password"></input>
        </li> 
```

注意：我正在使用 jquery 验证插件将错误类添加到输入字段并寻找跨浏览器解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T22:38:32.717

试试这个！

您也可以使用 keyPress() 事件来检测输入的类是否在您键入时被修改：

```
$('#aim_Password').bind('keyPress',function(){
     var has_error_class = $(this).hasClass('error');
     if(has_error_class){
             $(this).parent().removeClass('Valid');
     }        
}); 
```

# regex - 如何在行首替换集合中的所有字符？

> ID：12133777
> 
> 赞同：0
> 
> 时间：2012-08-26T20:46:32.933
> 
> 标签：regex, perl, sed

我有这样的行：

```
,,,,,,,,,foo,bar
,,,,,x,,blabla, 
```

使用*regex*，是否可以仅用相同数量的*空格替换行首的**逗号*，如果可以，如何？

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T20:50:13.127

`sed`例子：

```
$ echo ',,,,,,,,,foo,bar
,,,,,x,,blabla,' | sed ':r;s/^\(,*\),/\1 /;tr'
         foo,bar
     x,,blabla, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T20:49:45.027

使用 Java，积极回顾：

```
String s = ",,,,,,,,,foo,bar";
System.out.println(s.replaceAll("(?<=^,+),", " "));
// '         foo,bar' 
```

使用 Python：

```
> import re
> s = ',,,,,,,,,foo,bar'
> re.sub("^,+", lambda m: len(m.group(0)) * ' ', s)
'         foo,bar' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T21:43:45.373

与`perl`：

```
perl -pe 's/^,+/q{ } x length $&/e' <<< ',,,,,,,,,foo,bar' 
```*

# c++ - mingw-w64-v2.0.6.tar.gz - 定义环境变量路径

> ID：12133780
> 
> 赞同：1
> 
> 时间：2012-08-26T20:47:13.093
> 
> 标签：c++, eclipse, environment-variables, eclipse-juno, mingw-w64

我下载了最新版本的 minGW - mingw-w64-v2.0.6.tar.gz 。然后我提取到`C:\MinGW`. 正如我在一些文章中看到的，现在我必须定义`path`环境变量。现在 `C:\MinGW`有 -

![在此处输入图像描述](../Images/940c6f0f09669521d3a8c1957fff1405.png)

我试图将路径的变量值设置为`C:\MinGW`，但是当我在 Eclipse Juno 中为某些项目构建路径时，我得到 -

```
make all 
Cannot run program "make": Launching failed

Error: Program "make" not found in PATH 
```

**编辑：**

我下载了 GCC+binutils 64 位，提取到`c:\mingw64`，更改路径`c:\mingw64\bin`并将构建命令更改为`mingw32-make`. 现在，当我构建项目时出现错误 -

```
mingw32-make all 
mingw32-make: *** No rule to make target `all'.  Stop. 
```

**第二次编辑：**

最后我通过选择成功运行了一个项目 -

![在此处输入图像描述](../Images/6fbfa9af4768c7a011c7b1934d19900c.png)

请注意，它必须取消选中`show project type and toolchians only if they are supported on the platform`否则不允许选择**Executable** Project type 。此外，构建命令应保持在“使用默认构建命令”上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T21:00:16.950

您下载了源代码包。

你需要一个工具链（GCC+binutils 可能还有 make/gdb）。这些位于此处：

*   [32 位](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/)
*   [64 位](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/)

我推荐我的（rubenvb）个人版本。它们整洁、功能齐全且是最新的。

在任何地方（例如 ）提取工具链后`D:\`，添加`D:\mingw64\bin`或`D:\mingw32\bin`到`PATH`. 或者双击我最新版本中包含的批处理脚本，它会为你完成。

请注意，您需要为 MinGW 编译设置 Eclipse，这意味着使用`mingw32-make`，而不是`make`.

最后，我还建议将来使用 MinGW-w64 的支持渠道（论坛和邮件列表；请在发布到 mingw-w64-public 之前订阅）。我和其他一般友善且乐于助人的人一起流连忘返。

# php - Wordpress 数组显示特定类别的帖子并显示帖子摘录和特色

> ID：12133784
> 
> 赞同：-3
> 
> 时间：2012-08-26T20:47:44.140
> 
> 标签：php, arrays, wordpress, post, wordpress-theming

大家好，正在寻找 Wordpress 帮助。我需要放置一个简单的查询/数组来显示来自某只猫的帖子，例如“新闻”，其中将包括帖子特色图片。

有人可以帮忙吗？

加里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:07:39.873

尝试这个

```
<?php
    $query = new WP_Query('category_name=News&posts_per_page=4');
    if($query->have_posts()) : while($query->have_posts()) : $query->the_post();
    if (has_post_thumbnail()) {
        ?>
            <a href="<?php the_permalink(' ') ?>" title="<?php the_title(); ?>"><?php the_post_thumbnail(); ?></a>
        <?php
    }
    ?>
    <h2><a href="<?php the_permalink(' ') ?>" title="<?php the_title(); ?>"><?php the_title(); ?></a></h2>
    <?php
    the_excerpt(); // or the_content(); for full post content
    endwhile;endif;
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T21:08:12.900

不要使用 query_posts()。其目的是修改默认的 Wordpress 循环，不应用于一般查询。请改用[WP 查询](http://codex.wordpress.org/Class_Reference/WP_Query)或[获取帖子](http://codex.wordpress.org/Template_Tags/get_posts)。

这是一些关于[Post Thumbnails的文档](http://codex.wordpress.org/Post_Thumbnails)

这是一个基于您向我展示的可能有效的小示例。请注意，“showposts”已更改为“posts_per_page”，因为 2.1 版已弃用“showposts”：

```
<?php
$q = new WP_Query(array('cat'=>8, 'posts_per_page'=>4));
if($q->have_posts()) : while($q->have_posts()) : $q->the_post();
    the_excerpt();
    if(has_post_thumbnail())
        the_post_thumbnail('thumbnail');
endwhile;endif;
?> 
```

**更新：**

根据您给我的示例，这应该可以帮助您入门：

```
<div id="slider2">
<div class="viewport">
    <?php
    $q = new WP_Query(array('cat'=>8, 'posts_per_page'=>4));
    if($q->have_posts()) : while($q->have_posts()) : $q->the_post();
    ?>
    <div class="newsPost">
        <div class="news-date"><?php the_date(); ?></div>
        <div class="newstitle"><?php the_title(); ?></div>
        <div class="news-des"><?php the_excerpt(); ?></div>
        <?php if(has_post_thumbnail()){ ?>
        <div class="newsimg"><?php the_post_thumbnail(); ?></div>
        <?php } ?>
        <p><a href="<?php the_permalink(); ?>">Read More...</a></p>
    </div>
    <?php endwhile;endif; ?>   
</div>
</div>​ 
```

# css - CSS：重叠边框

> ID：12133791
> 
> 赞同：9
> 
> 时间：2012-08-26T20:48:53.963
> 
> 标签：css

我只是偶然发现了一个问题，菜单栏和主内容框之间的共享边框不能正常进行（因为内容框太小）

图片：http: [//imgur.com/O3ra9](http://imgur.com/O3ra9)

代码：http: [//jsfiddle.net/gh55e/2/](http://jsfiddle.net/gh55e/2/)

所以我想知道是否有办法修复边界。也许通过给他们一个并使其重叠？只是不知道如何做到这一点，因为 margin -x 不起作用。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-26T21:38:04.867

给右边的元素一个边框，然后使用底片中的 margin-top 和 margin-left 属性使它们重叠。这是一个更新的jsfiddle：

[http://jsfiddle.net/gh55e/4/](http://jsfiddle.net/gh55e/4/)

CSS：

```
#right {
    width: 85px;
    float: right;
    background-color: #e1e1e1;
    padding: 0px 10px 10px 10px;
    margin-top: -54px;
}
​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T13:34:58.470

对于后来的访问者，这是最终修复它的 CSS。

```
#right {
    width: 385px;
    float: right;
    background-color: #e1e1e1;
    padding: 0px 10px 10px 10px;
    margin-left: -10px;
} 
```

你基本上留出 10 像素的边距并将其向后移动 10 像素

# ios - 即使在情节提要中设置为横向，为什么 UIView（在 iPad 上）默认为纵向

> ID：12133792
> 
> 赞同：1
> 
> 时间：2012-08-26T20:48:57.063
> 
> 标签：ios, ios5, storyboard, uiinterfaceorientation, uideviceorientation

*这个话题之前已经出现过（[iPad modal view controller 在纵向中起作用，即使它是横向的](https://stackoverflow.com/questions/9583297/ipad-modal-view-controller-acting-in-portrait-even-though-its-landscape)）但是我还没有找到一个明确的答案——所以我不知道这是否是重复的。*

在新的单视图项目中，我在 xcode 中将主视图设置为横向：

![在此处输入图像描述](../Images/58e7e4de953730304ab00bc3c465aebe.png)

并且 Property Inspector 确认了这一点（以及视图在情节提要中的显示方式）：

![在此处输入图像描述](../Images/d212a8edbafc29f26b427e710c6b38c4.png)

并且 ViewController 的方向属性设置为横向：

![在此处输入图像描述](../Images/b9732dd7bb3eb9636da7026bb13139a5.png)

然而，当我在“viewDidLoad”中检查视图框架时，它会报告纵向模式：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    CGRect theRect = self.view.frame;

    NSLog(@" frame %f  %f  %f  %f", theRect.origin.x,
          theRect.origin.y,
          theRect.size.width,
          theRect.size.height);
} 
```

> 2012-08-26 16:42:45.045 测试 [2320:f803] 单元格 0.000000 20.000000 768.000000 1004.000000

我还在 shouldAutorotateToInterfaceOrientation 中强制横向：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return UIInterfaceOrientationIsLandscape(interfaceOrientation);
} 
```

我以前遇到过很多次，不得不将框架显式设置为横向，但我从来不明白为什么所有故事板设置都没有效果。

我在这里缺少一些基本的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:03:59.433

iOS 中的每个应用程序最初都以纵向模式启动，即使您指定了支持的设备方向并在`shouldAutorotateToInterfaceOrientation:`. 它将始终以纵向开始，如果设备将旋转到横向。用户可能不会看到它，因为它的速度如此之快。`shouldAutorotateToInterfaceOrientation`因此，即使您唯一支持的方向是横向方向，您的应用程序也必须能够旋转。

因此，要在开始后获得横向方向，您应该：

*   在 Xcodes Interface Builder 中设置支持的界面方向
*   覆盖`shouldAutorotateToInterfaceOrientation`：

 **```
- (BOOL) shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)io {
    return (io == UIInterfaceOrientationLandscapeRight); 
} 
```

*   让界面有机会旋转并在之后进行视图配置

关于您关于视图控制器的 Xcode 配置到横向的问题：注意故事板中菜单的标题 - 它说：**模拟指标**
这意味着您在那里所做的每一次修改只是为了在故事板中模拟它。但是，除非您在代码中进行必要的修改以达到此状态，否则它将无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-22T14:19:06.733

在您的视图控制器中添加以下代码`swift 4.2`

```
override var shouldAutorotate: Bool {
    return true
}

override var supportedInterfaceOrientations: UIInterfaceOrientationMask {
    return .landscapeRight
} 
```**

# java - 删除默认 JButton 输入映射

> ID：12133795
> 
> 赞同：5
> 
> 时间：2012-08-26T20:49:17.117
> 
> 标签：java, swing, user-interface, applet

我在删除 java swing 应用程序中组件上的默认输入映射信息时遇到了一些麻烦。这就是我想要做的：

```
//List of keys to remove
public static final int[] OVERWRITTEN_KEYS = 
{
    VK_SPACE
};

//Get default input maps
InputMap[] im = { 
    (InputMap)UIManager.get("Button.focusInputMap"),
    (InputMap)UIManager.get("ToggleButton.focusInputMap"),
    (InputMap)UIManager.get("Slider.focusInputMap"),
    (InputMap)UIManager.get("RadioButton.focusInputMap"),
    (InputMap)UIManager.get("TextArea.focusInputMap"),
    (InputMap)UIManager.get("TextField.focusInputMap")
};

//Loop through input maps        
for(int i = 0; i < im.length; i++)
{
    //Loop through keys
    for(int j = 0; j < OVERWRITTEN_KEYS.length; j++)
    {
        if(im[i] != null)
        {
            //Overwrite press and release of button
            im[i].put(KeyStroke.getKeyStroke(OVERWRITTEN_KEYS[j],0,false), "none");
            im[i].put(KeyStroke.getKeyStroke(OVERWRITTEN_KEYS[j],0,true), "none");
        }
    }
} 
```

但是，由于某种原因，这没有效果。按空格键仍会触发 JButton 单击等。有人看到此代码块有问题吗？预先感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-27T04:39:39.073

我无法重现您描述的问题。我通常修改组件的`InputMap`，但`UIManager`实例具有默认绑定。在下面的示例中，

```
im.put(KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0), NIL); 
```

有效地阻止`Space`键调用按钮的`ActionListener`. 取消注释该行

```
button.getActionMap().put(NIL, nil); 
```

将`Space`键与有效的空操作相关联，如[*如何制作和删除键绑定*](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html#howto)`doNothing`中描述的操作中所示。[](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html#howto)

 *```
/**
 * @see http://stackoverflow.com/q/12133795/230513
 */
public class NilBindingTest extends JPanel {

    private static final String NIL = "none";
    private Action nil = new AbstractAction(NIL) {

        @Override
        public void actionPerformed(ActionEvent e) {
            System.out.println("\"" + e.getActionCommand() + "\"");
        }
    };
    private JButton button = new JButton(nil);
    //private InputMap im = button.getInputMap();
    private InputMap im = (InputMap) UIManager.get("Button.focusInputMap");

    public NilBindingTest() {
        this.add(new JButton("foo"));
        System.out.println(Arrays.toString(im.keys()));
        im.put(KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0), NIL);
        //button.getActionMap().put(NIL, nil);
        this.add(button);
    }

    private void display() {
        JFrame f = new JFrame("NilBindingTest");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(this);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new NilBindingTest().display();
            }
        });
    }
} 
```*

# android - 值超出范围的 Android 路径

> ID：12133797
> 
> 赞同：0
> 
> 时间：2012-08-26T20:49:23.423
> 
> 标签：android, android-canvas

我正在计算函数图并将它们放入`android.graphics.Path`对象中，然后用于`android.graphics.Canvas.drawPath()`绘制它。

这非常有效，除非绝对 y 值非常高（正或负）并且应用程序在某些设备上运行。然后，它可能根本不会绘制路径。何时发生这种情况的阈值似乎是随机的和特定于设备的。

有谁知道这里可能是什么问题？

[编辑：仅当目标 API 级别为 14 或更高时才会发生这种情况]

编辑：例如，看看`View.onDraw(Canvas canvas)`方法中的这段代码：

```
 Paint paint = new Paint();

    Path p1 = new Path();
    paint.setColor(Color.BLUE);
    for(float x = 0; x < getWidth(); x++)
        p1.lineTo(x, x);
    canvas.drawPath(p1, paint);

    Path p2 = new Path();
    paint.setColor(Color.GREEN);
    for(float x = 0; x < getWidth(); x++)
        p2.lineTo(x, x*x);
    canvas.drawPath(p2, paint); 
```

第一条路径应该是从左上角到右下角的一条线；第二条路径应该做同样的事情，但具有抛物线的形状（因此，你只能看到它的一部分）。

第一条路径绘制，第二条不绘制，显然是因为 y 值太高。很高兴知道“太高”是什么意思；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T14:49:37.403

我找到了解决方案。

问题是，从 API-Level 14 开始，所有绘图都是硬件加速完成的，[不支持所有功能](http://android-developers.blogspot.de/2011/03/android-30-hardware-acceleration.html)。

如本文所述，关闭硬件加速很简单：

```
view.setLayerType(View.LAYER_TYPE_SOFTWARE, null); 
```

[您将在此博客文章](https://groups.google.com/forum/#!topic/android-developers/HgGVSbSghpk)中找到更多信息。

# java - 消失的JPanel

> ID：12133800
> 
> 赞同：0
> 
> 时间：2012-08-26T20:49:46.700
> 
> 标签：java, swing, jpanel, layout-manager, boxlayout

我有这个`JPanel`（a）`BoxLayout`。

当我用and向它添加另一个`JPanel`(b) 时，它会很好地绘制在 (a) 上。但是，如果 I在 (b) 上，它根本不会被绘制。或者添加，我不能确定。`setPreferredSize()``setBackground()``setLayout(new BoxLayout(this, BoxLayout.PAGE_AXIS)`

如果我使用其他布局管理器（例如`BorderLayout`），它会再次出现。

有人愿意解释吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T11:12:49.587

我似乎添加到同一个父级的其他组件（具有空布局）妨碍了。为父组件的所有子组件设置一个不同于 null 的布局解决了这个问题，并使布局看起来好像它们都是 null 布局......

# r - R - 使用矩阵布局绘制多个栅格

> ID：12133804
> 
> 赞同：7
> 
> 时间：2012-08-26T20:50:22.887
> 
> 标签：r, layout, matrix, plot, raster

在 R (Win64) 中，我尝试使用 layout() 命令和定义布局的矩阵在单个绘图窗口中绘制光栅图像和直方图的组合。这是一些带有简化数据的示例代码：

```
library(raster)

r <- raster(ncols=5, nrows=5, xmn=1, xmx=5, ymn=1, ymx=5)
rast1 <- rasterize(expand.grid(1:5,1:5), r, rnorm(25))
rast2 <- rasterize(expand.grid(1:5,1:5), r, rnorm(25))
rast3 <- rasterize(expand.grid(1:5,1:5), r, rnorm(25))

layout(matrix(c(1,2,3,4,1,2,3,5,1,2,3,6), 3, 4, byrow=T))
layout.show(6)

plot(rast1, axes=F, ann=F, legend=F, box=F, useRaster=T)
plot(rast2, axes=F, ann=F, legend=F, box=F, useRaster=T)
plot(rast3, axes=F, ann=F, legend=F, box=F, useRaster=T)
hist(rnorm(100), ann=F, axes=F)
hist(rnorm(100), ann=F, axes=F)
hist(rnorm(100), ann=F, axes=F) 
```

如您所见，我正在尝试绘制三个光栅图像（rast1、rast2、rast3），每个图像跨越 1 列和 3 行，旁边有 3 个直方图，每个直方图跨越 1 列和 1 行。layout.show() 命令给出了这个想法。

当我运行此代码时，似乎第一个绘图（光栅）命令也重置了绘图窗口的布局，导致所有后续绘图都绘制在标准的 3x4 网格中（第 5 个绘图现在与第一个绘图重叠）。布局设置看起来不错，因为我可以在正确的布局中绘制六个直方图。但是光栅图把事情搞砸了。

我怀疑 {raster} 中的 plot() 命令与 layout() 命令有关，但我不知道为什么或如何。还有其他方法可以实现这种布局吗？另一个基于光栅的命令？有没有办法重置光栅图之间的布局？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-27T02:56:20.367

这里的 S4 方法和 layout() 之间可能存在问题。作为一种解决方法，用 image() 替换 plot() 似乎有效。代替 plot(rast1, axes=F, ann=F, legend=F, box=F, userRaster=T)，使用 image(rast1, axes=F, ann=F, asp=1) 来获得方形图像映射。

# javascript - 我怎样才能有几个 javascript 函数而没有每个都有 document.ready()

> ID：12133806
> 
> 赞同：0
> 
> 时间：2012-08-26T20:50:45.943
> 
> 标签：javascript, jquery

我的工作代码包括：

```
 $(document).ready(function() 
  { $("#num1").click(function() { $("li.elementsA").addClass("alerty"); 
     return false }); });
  $(document).ready(function() 
  { $("#num2").click(function() { $("li.element").addClass("ok"); 
     return false }); }); 
```

如果没有第二个中的 document.ready 部分，我怎么能同时拥有这两个功能。

我试过了

```
 $(document).ready(function() 
  { $("#num1").click(function() { $("li.elementsA").addClass("alerty"); 
    return false }); }
  { $("#num2").click(function() { $("li.element").addClass("ok"); 
    return false }); }); 
```

但它没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T20:53:38.437

在您的第二个示例中，DOM Ready 处理程序函数在最后 3 行的末尾关闭`}`，之后您会得到一个`SyntaxError: Unexpected token {`.

您只需将两个`click`处理程序都包装在 DOM 就绪处理程序中：

```
$(document).ready(function () {
    $("#num1").click(function () {
        $("li.elementsA").addClass("alerty");
        return false;
    });
    $("#num2").click(function () {
        $("li.element").addClass("ok");
        return false;
    });
}); 
```

我[美化](http://jsbeautifier.org/)了您的代码，使其更易于阅读。`=]`

以下是未美化的更改，使其相对于原始代码“更加”可见：

```
 $(document).ready(function() 
  { $("#num1").click(function() { $("li.elementsA").addClass("alerty"); 
    return false });
//↓Remove { here     ↑And } here
    $("#num2").click(function() { $("li.element").addClass("ok"); 
    return false }); }); 
```

# php - 从 PHP 和 MySQL 的 3 个随机数据中选择 4 列

> ID：12133808
> 
> 赞同：2
> 
> 时间：2012-08-26T20:50:57.820
> 
> 标签：php, mysql, sql, database

所以我使用的是`RAND() LIMIT 3`，但我在循环中使用它来获取 3 个随机行。

我需要在我网站的不同位置使用每一列。如何在不为每列运行不同查询的情况下获取数据？

我需要的数据不应该是有序的，例如：

```
$Title, will be the title of the page.
$price, will be the price of the service/product.
$description, will be the description of the service/product. 
```

显然，它们在 php 文件中并没有相互接近。

这两个答案听起来合乎逻辑，但我对 mysql 完全陌生，我无法让它工作。

这是我的 php 文件中的内容：

```
<?php
mysql_connect("localhost", "test", "test") or die (mysql_error ());
mysql_select_db("test") or die(mysql_error());
$strSQL = "SELECT name FROM UserId ORDER BY RAND() LIMIT 3";
$rs = mysql_query($strSQL);
while($row = mysql_fetch_array($rs)) {
  echo $row['name'] . "<br />";
 }
mysql_close();
?> 
```

它的作用是返回 3 行的随机“名称”列。该表具有“id”、“name”和“Age”。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T21:07:25.367

`$_SESSION`仅当它们不存在时才将它们存储在其中，并始终从`$_SESSION`.

```
// On  every page that uses these values:
session_start();
if (empty($_SESSION['rand_rows'])) {

   // DB connection code omitted...

   // This block will execute once per session only...
   // Get 3 random rows
   $strSQL = "SELECT name, id, age FROM UserId ORDER BY RAND() LIMIT 3";
   $rs = mysql_query($strSQL);
   if ($rs) {
     // Fetch all 3 rows and store them in $_SESSION:
     while ($row = mysql_fetch_assoc($rs)) {
       $_SESSION['rand_rows'][] = $row;
     }
   }
}

// Later, get them $_SESSION
// To get the name for example:
foreach ($_SESSION['rand_rows'] as $r) {
  echo $r['name'] . "<br />";
}

// Use the same looping pattern to get the id or age where you need them. 
```

目前尚不清楚您是否真的需要它在页面加载时持续存在。如果您只需要一个页面上的这些行，并且可以在其他页面或后续页面加载上获得 3 个不同的行，则无需`$_SESSION`将它们存储到数组中，而只需将它们存储到数组中：

```
// Array to hold all results
$results = array();
while ($row = mysql_fetch_assoc($rs)) {
  $results[] = $row;
} 
```

...并使用相同的`foreach`模式来迭代`$results`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T21:14:31.610

如果您将值放入变量中，例如`$title`,`$price`并且`$description`它们的值将在同一个文件中被记住，即使在使用包含时也是如此。

如果您尝试跨不同页面保存值，有不同的方法可以实现这一点，尽管我可能会建议使用`$_SESSION`跨页面存储此类信息。

如果您按照最初的建议进行操作，但没有运气，我将需要更多信息才能正确回答您的问题。一个小的代码示例可能会有所帮助。

* * *

编辑：

虽然@michael-berkowski 的答案功能齐全，但您不一定要使用它`$_SESSION`来实现您想要的。由于您说您只是在学习 PHP，因此我添加了一种不同的方法。虽然不像其他答案那么优雅，但它更快，并且我已经编辑了一些变量（这是一个好习惯，使用小写表名，变量相同）：

```
<?php
//Insert DB-connection code
$sql = "SELECT `name` FROM `user` ORDER BY RAND() LIMIT 3";
$rs = mysql_query($sql);
//We should check, if there are actually 3 rows, before doing anything else.
if (mysql_num_rows($rs) == 3) {
   $title = mysql_result($rs,0,0);
   $price = mysql_result($rs,1,0);
   $description = mysql_result($rs,2,0);
}
echo("Title: $title <br/>Price: $price <br/>Description: $description");
?> 
```

祝你学习 PHP 好运。

# algorithm - 非恢复除法算法

> ID：12133810
> 
> 赞同：8
> 
> 时间：2012-08-26T20:51:04.357
> 
> 标签：algorithm, binary, division, bits, addition

有谁知道使用非恢复除法划分无符号二进制整数的步骤？

在网上很难找到任何好的资源。

即如果`A = 101110`和`B = 010111`

我们如何找到`A divided by B`不可恢复的除法？每个步骤中的寄存器是什么样的？

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-05T16:30:23.140

（我的回答有点晚了。但我希望它对未来的访客有用）

下图给出了非恢复除法的算法：

![在此处输入图像描述](../Images/59e807335957ad2df7218a06eadd88f8.png)

在本题中，Dividend (A) = 101110，即 46，Divisor (B) = 010111，即 23。

初始化：

```
Set Register A = Dividend = 000000
Set Register Q = Dividend = 101110
( So AQ = 000000 101110 , Q0 = LSB of Q = 0 )
Set M = Divisor = 010111, M' = 2's complement of M = 101001
Set Count = 6, since 6 digits operation is being done here. 
```

在此之后，我们开始算法，我在下表中显示：

表中，`SHL(AQ) denotes shift left AQ by one position leaving Q0 blank`。

类似地，Q0 位置的方形符号表示，`it is to be calculated later`

![在此处输入图像描述](../Images/ed7c85fc3e72f2ee3ff6ffb7bde0f074.png)

希望表中的所有步骤都清楚！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-05T17:18:21.803

1) 将寄存器 A 的值设置为 0 (N 位)
2) 将寄存器 M 的值设置为除数 (N 位)
3) 将寄存器 Q 的值设置为被除数 (N 位)
4) 将 A 与 Q {A 连接,Q}
5) 重复以下“N”次（这里 N 是除数中的位数）：
  如果 A 的符号位等于 0，则将
   A 和 Q 组合左移 1 位并 从 A 中*减去*M，
  else 将 A 和 Q 组合左移 1 位*并将*M 添加到 A
  现在如果 A 的符号位等于 0，则将 Q[0] 设置为 1，否则将 Q[0] 设置为 0
6) 最后如果 A 的符号位等于 1 然后将 M 加到 A。
7) 将 A 赋值为余数，将 Q 赋值为商。

# javascript - 使用 Javascript 和/或 JQuery，如何根据类查找后代元素？

> ID：12133811
> 
> 赞同：2
> 
> 时间：2012-08-26T20:51:08.370
> 
> 标签：javascript, jquery, html, css

我无法修改此 HTML：

```
<li data-corners="false" data-shadow="false" data-iconshadow="true" data-rapperels="div" data-icon="arrow-r" data-iconpos="right" data-theme="c" class="ui-btn ui-btn-icon-right ui-li-has-arrow ui-li ui-btn-up-c">
    <div class="ui-btn-inner ui-li">
        <div class="ui-btn-text"> 
            <a class="make-inline ui-link-inherit" href="#"> 
                <h3 class="ui-li-heading"> Attending: 
                </h3> 
            </a> 

            <div class="ui-select">
                <a href="#" role="button" id="undefined-button" aria-haspopup="true" aria-owns="undefined-menu" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="arrow-d" data-iconpos="right" data-theme="c" data-inline="true" data-mini="false" class="ui-btn ui-btn-up-c ui-btn-inline ui-shadow ui-btn-corner-all ui-fullsize ui-btn-icon-right ui-disabled" aria-disabled="true">
                    <span class="ui-btn-inner ui-btn-corner-all">
                        <span class="ui-btn-text"> Maybe </span>
                        <span class="ui-icon ui-icon-arrow-d ui-icon-shadow">&nbsp;</span>
                    </span>
                </a>
                <select class="attending 310 mobile-selectmenu-disabled ui-state-disabled" data-inline="true" data-native-menu="false" tabindex="-1" disabled="disabled" aria-disabled="true">
                    <option value="2"> Yes </option>
                    <option value="0"> No </option>
                    <option value="1"> Maybe </option>
                </select>
            </div>
        </div>

        <span class="ui-icon ui-icon-arrow-r ui-icon-shadow">&nbsp;</span>

    </div>
</li> 
```

*select*标记包含 class= " attending"，这是该特定页面所独有的，因此我使用它来访问这部分代码。最终，我尝试使用 class="ui-icon-arrow-r"访问最后一个*span标签，这样我就可以设置它的样式。*我试过像这样使用jQuery：

```
$(".attending").parent().find(".ui-icon-arrow-r").css('background-color','yellow'); 
```

它不起作用。当我删除 find() 部分时，它会选择页面上的所有 li 元素。所以，我知道那部分正在工作。但是 find 部分不是，我不知道为什么不。如何选择这个元素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T20:58:58.250

尝试这个：

```
$(".attending").closest('div.ui-btn-inner').find(".ui-icon-arrow-r").css('background-color','yellow'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T21:04:08.453

这是我的做法：

1.  添加一个类（.my-li）到你的 li （因为我们想要一个基于类的选择器，而不是基于标签的选择器）

2.  使用jquery`parents`方法：

    ```
    $(".attending").parents('.my-li').find(".ui-icon-arrow-r").css('background-color','yellow')​ 
    ```

是的 - 这是你的情况解决：http: [//jsfiddle.net/Xfj5U/](http://jsfiddle.net/Xfj5U/)

**更新：**

对不起，我搞砸了你不能修改 html - 我的错 :(

您仍然可以使用这样的父母方法（使用标签选择器而不修改 html）：

```
$(".attending").parents('li').find(".ui-icon-arrow-r").css('background-color','yellow')​ 
```

[http://jsfiddle.net/ETpVL/](http://jsfiddle.net/ETpVL/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:55:46.520

您需要遍历两次`parent()`：

```
$(".attending").parent().parent().find('span:last-child').css( ... ) 
```

# django - django admin 将参数传递给表单

> ID：12133812
> 
> 赞同：1
> 
> 时间：2012-08-26T20:51:10.750
> 
> 标签：django, django-forms, django-admin

我想知道如何将参数传递给 django 模型表单自定义类

例如我有这样的事情：

```
class DealAdmin(admin.ModelAdmin):
    form = EscapeToRelaxForm 
```

我想做这样的事情：

```
class DealAdmin(admin.ModelAdmin):
    form = EscapeToRelaxForm(category='relax', region='NA') 
```

知道该怎么做..？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:06:45.927

覆盖`get_form`Admin 子类中的方法。

# php - 使调整大小的图像透明

> ID：12133814
> 
> 赞同：0
> 
> 时间：2012-08-26T20:51:30.610
> 
> 标签：php, upload, transparency

我使用此代码将图像上传到我的服务器。但由于某种原因，我的缩略图变成了黑色背景，而不是像原来那样透明。

我试过使用这个“指南”：[http ://www.akemapa.com/2008/07/10/php-gd-resize-transparent-image-png-gif/](http://www.akemapa.com/2008/07/10/php-gd-resize-transparent-image-png-gif/)

但没有成功。我不知道如何将那段代码实现到我使用的代码中。

如果有人可以提供帮助，请这样做:)

```
 <?php
    //define a maxim size for the uploaded images
    define ("MAX_SIZE","10240"); 
    // define the width and height for the thumbnail
   // note that theese dimmensions are considered the maximum dimmension and are not fixed, 
   // because we have to keep the image ratio intact or it will be deformed
 define ("WIDTH","200"); 
 define ("HEIGHT","200"); 

  // this is the function that will create the thumbnail image from the uploaded image
 // the resize will be done considering the width and height defined, but without deforming the image
 function make_thumb($img_name,$filename,$new_w,$new_h)
 {
    //get image extension.
    $ext=getExtension($img_name);
    //creates the new image using the appropriate function from gd library
    if(!strcmp("jpg",$ext) || !strcmp("jpeg",$ext))
        $src_img=imagecreatefromjpeg($img_name);

    if(!strcmp("png",$ext))
        $src_img=imagecreatefrompng($img_name);

    if(!strcmp("gif",$ext))
        $src_img=imagecreatefromgif($img_name);

        //gets the dimmensions of the image
    $old_x=imageSX($src_img);
    $old_y=imageSY($src_img);

     // next we will calculate the new dimmensions for the thumbnail image
    // the next steps will be taken: 
    //  1\. calculate the ratio by dividing the old dimmensions with the new ones
    //  2\. if the ratio for the width is higher, the width will remain the one define in WIDTH variable
    //      and the height will be calculated so the image ratio will not change
    //  3\. otherwise we will use the height ratio for the image
    // as a result, only one of the dimmensions will be from the fixed ones
    $ratio1=$old_x/$new_w;
    $ratio2=$old_y/$new_h;
    if($ratio1>$ratio2) {
        $thumb_w=$new_w;
        $thumb_h=$old_y/$ratio1;
    }
    else    {
        $thumb_h=$new_h;
        $thumb_w=$old_x/$ratio2;
    }

    // we create a new image with the new dimmensions
    $dst_img=ImageCreateTrueColor($thumb_w,$thumb_h);

    // resize the big image to the new created one  
    imagecopyresampled($dst_img,$src_img,0,0,0,0,$thumb_w,$thumb_h,$old_x,$old_y); 
    // output the created image to the file. Now we will have the thumbnail into the file named by $filename
    if(!strcmp("png",$ext))
        imagepng($dst_img,$filename);

    else
        imagejpeg($dst_img,$filename);
        imagegif($dst_img,$filename); 

    //destroys source and destination images. 
    imagedestroy($dst_img); 
    imagedestroy($src_img); 
 }

 // This function reads the extension of the file. 
 // It is used to determine if the file is an image by checking the extension. 
 function getExtension($str) {
         $i = strrpos($str,".");
         if (!$i) { return ""; }
         $l = strlen($str) - $i;
         $ext = substr($str,$i+1,$l);
         return $ext;
 }

// This variable is used as a flag. The value is initialized with 0 (meaning no error found) and it will be changed to 1 if an errro occures. If the error occures the file will not be uploaded.
 $errors=0;
 // checks if the form has been submitted
 if(isset($_POST['Submit']))
 {
 //reads the name of the file the user submitted for uploading
    $image=$_FILES['image']['name'];
    // if it is not empty
    if ($image) 
    {
        // get the original name of the file from the clients machine
        $filename = stripslashes($_FILES['image']['name']);

        // get the extension of the file in a lower case format
        $extension = getExtension($filename);
        $extension = strtolower($extension);
        // if it is not a known extension, we will suppose it is an error, print an error message and will not upload the file, otherwise we continue
        if (($extension != "jpg")  && ($extension != "jpeg") && ($extension != "png") && ($extension != "gif")) 
        {
            echo '<h1>Unknown extension!</h1>';
            $errors=1;
        }
        else
        {
            // get the size of the image in bytes
            // $_FILES[\'image\'][\'tmp_name\'] is the temporary filename of the file in which 
            //the uploaded file was stored on the server
            $size=getimagesize($_FILES['image']['tmp_name']);
            $sizekb=filesize($_FILES['image']['tmp_name']);

            //compare the size with the maxim size we defined and print error if bigger
            if ($sizekb > MAX_SIZE*10240)
            {
                echo '<h1>You have exceeded the size limit!</h1>';
                $errors=1;
            }

            //we will give an unique name, for example the time in unix time format
            $image_name=time().'.'.$extension;
            //the new name will be containing the full path where will be stored (images folder)
            $newname="../images/uploads/".$image_name;
            $copied = copy($_FILES['image']['tmp_name'], $newname);
            //we verify if the image has been uploaded, and print error instead
            if (!$copied) 
            {
                echo '<h1>Copy unsuccessfull!</h1>';
                $errors=1;
            }
            else
            {
                // the new thumbnail image will be placed in images/thumbs/ folder
                $thumb_name='../images/uploads/thumbs/thumb_'.$image_name;
                // call the function that will create the thumbnail. The function will get as parameters the image name, the thumbnail name and the width and height desired for the thumbnail
                $thumb=make_thumb($newname,$thumb_name,WIDTH,HEIGHT);
            }}  }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:36:46.630

尝试为 PNG包含[imagesavealpha()](http://www.php.net/manual/en/function.imagesavealpha.php)

```
if(!strcmp("png",$ext))
{
    $src_img=imagecreatefrompng($img_name);
    imagesavealpha($src_img, true);
} 
```

并读入GIF 文件的[imagecolortransparent()](http://php.net/manual/en/function.imagecolortransparent.php)以查看是否可以在这里找到解决方案，虽然很乱。

# java - 确定一个方法是否在运行时覆盖另一个方法

> ID：12133817
> 
> 赞同：14
> 
> 时间：2012-08-26T20:52:15.383
> 
> 标签：java, inheritance, reflection, overriding

我想知道是否有任何方法可以确定给定`java.lang.Method`对象表示的方法是否覆盖另一个`java.lang.Method`对象表示的另一个方法？

我正在研究[Stronlgy 类型的 javascript](http://st-js.sourceforge.net/)，我需要能够知道一个方法是否覆盖另一个方法，以便能够将它们都重命名为更短的名称。

在这种情况下，我谈论的是由`@Override`注解支持的覆盖的扩展定义，其中包括接口和抽象类方法的实现。

我会对任何涉及直接反射或使用任何已经这样做的库的解决方案感到满意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T21:20:29.860

您可以简单地交叉检查方法名称和签名。

```
public static boolean isOverriden(Method parent, Method toCheck) {
    if (parent.getDeclaringClass().isAssignableFrom(toCheck.getDeclaringClass())
            && parent.getName().equals(toCheck.getName())) {
         Class<?>[] params1 = parent.getParameterTypes();
         Class<?>[] params2 = toCheck.getParameterTypes();
         if (params1.length == params2.length) {
             for (int i = 0; i < params1.length; i++) {
                 if (!params1[i].equals(params2[i])) {
                     return false;
                 }
             }
             return true;
         }
    }
    return false;
} 
```

但是，由于您的目标是重命名方法，您可能希望使用字节码分析/操作库，例如[ASM](http://asm.ow2.org/)，如果方法返回 true，您可以在其中执行相同的测试以及轻松修改方法的名称。

# java - 在 IntelliJ Java 项目中引用 .class 文件

> ID：12133823
> 
> 赞同：19
> 
> 时间：2012-08-26T20:52:57.547
> 
> 标签：java, intellij-idea, .class-file

我刚开始玩 IntelliJ。我需要从我下载的类文件中调用一个函数，所以我需要在我的项目中引用一个 .class 文件。无法弄清楚如何将其添加到我的项目中。如果有人可以指导我，将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-26T21:11:21.620

使用“File->Project Structure”打开项目结构对话框，选择左侧的“Project Settings->Modules”，然后选择要修改其classpath的模块。在对话框右侧的“依赖项”选项卡上，您可以添加类文件的类路径根目录。

当然类文件必须在类的包对应的正确目录结构中，否则不起作用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-26T21:14:13.880

选择项目的根目录并按 F4。然后你会看到项目结构。选择左侧的“库”部分，然后单击加号以创建“新项目库”。选择“Java”并选择 .class 文件所在的目录。单击“确定”继续其余步骤。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-09-05T06:27:59.227

对于较新版本的 Intellij，按`Ctrl + Alt + Shift + s`打开项目设置，然后选择模块，在 Dependencies 选项卡下选择绿色`+`并添加文件所在的文件夹`.class`。在范围下，选择编译。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-16T19:42:55.670

要进入依赖项选项卡，请双击“src”文件夹，然后单击右上角的绿色加号按钮。单击“JAR 或目录”，然后添加 .class 文件的父文件夹。

# java - 添加字符以获取 ASCII 值的目的是什么？

> ID：12133825
> 
> 赞同：5
> 
> 时间：2012-08-26T20:53:09.267
> 
> 标签：java, char, ascii

测试时（使用以下代码）， ASCII 值为`char 'a'`10 **，** ASCII`char 'b'`值为**11**。*但是*，当连接`char 'a'`and时`char 'b'`，结果是**195**。

我的逻辑和/或理解中一定有错误......我*确实*知道字符不能连接为字符串，但是**195**的 ASCII int 值将代表什么？

*这样的结果有什么用？*

* * *

这是我的代码：

```
public class Concatenated
{
    public static void main(String[] args)
    {
        char char1 = 'a';
        char char2 = 'b';

        String str1 = "abc";

        String result = "";
        int intResult = 0;
        Concatenated obj = new Concatenated();

        // calling methods here
        intResult = obj.getASCII(char1);
        System.out.println("The ASCII value of char \"" + char1 + "\" is: " + intResult + ".");

        intResult = obj.getASCII(char2);
        System.out.println("The ASCII value of char \"" + char2 + "\" is: " + intResult + ".");

        result = obj.concatChars(char1, char2);
        System.out.println(char1 + " + " + char2 + " = " + result + ".");

        result = obj.concatCharString(char1, str1);
        System.out.println("The char \"" + char1 + "\" + the String \"" + str1 + "\" = " + result + ".");
    } // end of main method

    public int getASCII(char testChar)
    {
        int ans = Character.getNumericValue(testChar);

        return ans;
    } // end of method getASCII

    public String concatChars(char firstChar, char secondChar)
    {
        String ans = "";
        ans += firstChar + secondChar; // "+=" is executed last

        return ans; // returns ASCII value
    } // end of method concatChars

    public String concatCharString(char firstChar, String str)
    {
        String ans = "";
        ans += firstChar + str;

        return ans;
    } // end of method concatCharString
} // end of class Concatenated 
```

* * *

...打印到屏幕的结果如下：

```
The ASCII value of char "a" is: 10.
The ASCII value of char "b" is: 11.
a + b = 195.
The char "a" + the String "abc" = aabc. 
```

* * *

**-- 编辑： --**

正如@Marko Topolnik 在下面指出的那样，该方法`getASCII`应更改为此以返回正确的 ASCII 值（而**不是**UNICODE 值）：

```
public int getASCII(char testChar)
{
    // int ans = Character.getNumericValue(testChar); ...returns a UNICODE value!
    int ans = testChar;

    return ans;
} // end of method getASCII 
```

为了后代，我没有更改上面的代码来反映这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T21:01:49.287

您调用了错误的方法：`getNumericValue`将 char 解释为数字。例如，十六进制数字`A`的值为 10。

你应该做的只是直接使用你的 char 的值。例如，将其转换`int`为 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T21:00:23.790

`Character.getNumericValue()`返回指定 Unicode 字符表示的 int 值。根据`getNumericValue()`Javadocs：“大写和小写的 A tp Z 字母具有从 10 到 35 的数值。这与 Unicode 规范无关，Unicode 规范不为这些 char 值分配数值。”

但是，当您在`concatChars()`方法中添加它们时，添加的 2 个值是 ASCII 值 (97 + 98)。

# android - Android Jelly Bean 中通知栏图标上的触摸事件

> ID：12133830
> 
> 赞同：0
> 
> 时间：2012-08-26T20:53:53.790
> 
> 标签：android, notifications, tablet, touch-event, android-4.2-jelly-bean

我刚刚注意到 Jelly Bean 平板电脑通知栏上的“选择输入法”图标的一些有趣行为。如果您展开整个通知栏，它不会显示，但如果您只触摸图标，它会显示其自己的选项菜单。我想知道如何为我的图标做到这一点。我先在这里尝试过，但没有看到任何相关内容。

[http://developer.android.com/reference/android/app/Notification.Builder.html](http://developer.android.com/reference/android/app/Notification.Builder.html)

它在手机上不起作用，我没有 ICS 平板电脑来测试。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:59:15.170

不允许应用程序控制通知栏及其行为。所有通知生成器提供的功能仅适用于帮助您创建自己的通知。

# javascript - 在新的 dom 元素上自动调用 jQuery 函数

> ID：12133831
> 
> 赞同：9
> 
> 时间：2012-08-26T20:53:55.187
> 
> 标签：javascript, jquery, dom

是否可以自动对新匹配的项目调用 jQuery 函数？

例如我有以下代码：

```
$(document).ready(function(){
    $('[draggable]').draggable();
}); 
```

这会为每个匹配 [draggable] 的元素添加 'draggable'，但是当沿着道路进一步添加具有属性 'draggable' 的新元素时，那些不会调用 'draggable()' 函数。

是否可以监视 DOM 或其他东西，并在每个与选择器匹配的新 dom 项上调用此方法？

我知道对于“单击”事件等（jquery 委托方法）有类似的东西，但据我所知，我似乎无法在这种情况下使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T21:00:59.533

检查“[突变事件](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events)”有一个名为 DOMNodeInserted 的事件也许它可以帮助你

顺便检查一下：[JQuery - 使用带有 DOMNodeInserted 的元素](https://stackoverflow.com/questions/6814219/jquery-use-element-with-domnodeinserted)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-26T06:03:23.983

您可以使用我为完全相同的目的开发的[到达.js库（它在内部使用](https://github.com/uzairfarooq/arrive/)[MutationObserver](https://developer.mozilla.org/en/docs/Web/API/MutationObserver)）。用法：

```
document.arrive('[draggable]', function(){
    // 'this' refers to the newly created element
    $(this).draggable();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T20:57:28.137

jQuery有“.live()”，但我看到它已被弃用？*！*目前不要从“.live()”转换到新的“.on()”-方法，但是看看@你自己，也许在他们的论坛上问......这应该是正确的方法。 ..

[http://api.jquery.com/live/](http://api.jquery.com/live/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-26T21:30:49.287

[`.on()`](http://api.jquery.com/on/)如果您正在运行 jQuery 1.7 或更高版本，则需要。它将在元素添加到页面时运行，以及在调用时已经存在的元素上运行。如果您使用的是早期版本，请查看该[`.live()`](http://api.jquery.com/live/)方法，该方法已被弃用，但具有与添加元素相同的功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T20:58:15.463

根据您使用的 jQuery 版本，查看`.on()` [方法](http://api.jquery.com/on/)。如果我了解您在这里寻找的内容，它应该可以满足您的需求。

以前版本的框架中的等价物是`.live()`.

# c - 使用最少的 malloc 调用为 2D 数组分配内存

> ID：12133832
> 
> 赞同：3
> 
> 时间：2012-08-26T20:53:59.107
> 
> 标签：c, malloc, runtime-error

我正在使用下面的代码片段使用最少的`malloc()`调用次数为 2D 数组分配内存。

我想使用下标 p[i][j] 访问数组。

```
#define ROW 3
#define COL 2

int main()
{
    void **ptr = malloc( ROW*COL* sizeof(int) );

    int (*p)[COL] = ptr;

    int i, j;

    for( i = 0; i < ROW; ++i )
            for( j = 0; j < COL; ++j )
                    scanf("%d", &ptr[i][j]);

    for( i = 0; i < ROW; ++i )
    {
            for( j = 0; j < COL; ++j )
                    printf("%d ", p[i][j]);
            printf("\n");
    }

    return 0;
} 
```

无论输入是什么，程序都会正确输出。

但是，它显示 [Runtime error](http://ideone.com/t1nlL) 。为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T21:02:46.383

如果数组维度在编译时已知（如您的示例中所示），那么您确实可以在一次`malloc`调用中分配内存。但是您必须使用正确的指针类型来访问该内存。在您的情况下，这将是您的`p`指针。您`p`的指针已正确声明，但由于某种原因，您完全忽略了它的存在`scanf`并`ptr`改为使用。

停止尝试`ptr`用于阵列访问。使用`p`. 访问您的数组元素`p[i][j]`，它应该可以工作。

事实上，我会完全摆脱`ptr`并通过以下方式进行内存分配

```
int (*p)[COL] = malloc(ROW * sizeof *p); 
```

此外，由于*这两个*维度在编译时都是已知的，因此您实际上可以将其分配为

```
int (*p)[ROW][COL] = malloc(sizeof *p); 
```

但在这种情况下，您必须记住以`(*p)[i][j]`（注意`*`）访问数组。选择您喜欢的任何方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T21:10:05.100

试试这个：

```
#define ROW 3
#define COL 2

int main()
{
    int *ptr = (int*)malloc( ROW*COL* sizeof(int) );

    int *p[COL];
    int i, j;

    fot (i = 0; i < COL; i++)
        p[i] = ptr + ROW * i;

    for( i = 0; i < ROW; ++i )
        for( j = 0; j < COL; ++j )
            scanf("%d", &p[i][j]);

    for( i = 0; i < ROW; ++i )
    {
            for( j = 0; j < COL; ++j )
                    printf("%d ", p[i][j]);
            printf("\n");
    }

    free(ptr);
    return 0;
} 
```

# java - 在 Java 中准备动态语句的正确方法

> ID：12133833
> 
> 赞同：0
> 
> 时间：2012-08-26T20:54:00.757
> 
> 标签：java, sql, jdbc, prepared-statement, playframework-2.0

我正在从通过查询字符串传递的值准备 SQL 语句。（我正在使用 Play！框架。基本上我遇到的（不是真正的问题，只是我不太喜欢的东西）是当我想`?`在 SQL 字符串中使用并稍后使用动态值设置它们时。

这就是我所拥有的：

```
String sql = "SELECT * FROM foobar_table WHERE";

if ( foo != 0 )
    sql += " AND foo=?";
if ( !bar )
    sql += " AND bar=?";

try{
    PreparedStatement getStmt = con.prepareStatement(sql);
    if ( foo != 0 )
        getStmt.setInt(1,foo);
    if ( foo != 0 && !bar )
        getStmt.setBoolean(2, bar);
    else
        getStmt.setBoolean(1, bar);
} catch (SQLException e ){
    e.printStackTrace();
}
```

这确实有效，但正如您所见，它不是很直观。当有 2 个动态值时没关系，但是当你达到 5 或 6 个时，这会变得很荒谬。

有没有更简单的方法让它更灵活，以便我知道如何以`?`更好的方式填写所有内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T21:26:52.357

一个例子（评论太长了）：

```
String sql = "SELECT * FROM foobar_table WHERE 1 = 1 ";
ArrayList paramList = new ArrayList();

if ( foo != 0 ) {
    sql += " AND foo=?";
    paramList.add(foo);
}

if ( !bar ) {
    sql += " AND bar=?";
    paramList.add(bar);
}

try{

    PreparedStatement getStmt = con.prepareStatement(sql);

    int index = 1;

    for (Object param : paramList) {
        getStmt.setObject(index, param);
        index++;
    }

    // execute

} catch (SQLException e ){
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T21:31:53.000

可能是这样的（只是粗略的代码，但你明白了）：

```
 class Param{
        final int type;
        final Object value;         
        Param(int type, Object value){
            this.type = type;
            this.value = value;
        }
    }

    final List<Param> params = new ArrayList<>();

    final StringBuilder sql = new StringBuilder("SELECT * FROM bcu_venue_events WHERE 1=1");
    int foo = 0;
    boolean bar = true;             
    if (foo != 0){
        sql.append(" AND foo=?");
        params.add(new Param(Types.INTEGER, foo));
    }       
    if (!bar){
        sql.append(" AND bar=?");
        params.add(new Param(Types.BOOLEAN, bar));
    }
    try(Connection conn = null; PreparedStatement getStmt = conn.prepareStatement(sql.toString())) {            
        for(int i = 0; i < params.size(); i++){
            Param p = params.get(i);
            getStmt.setObject(i + 1, p.value, p.type);
        }
    } catch (SQLException e) {
        e.printStackTrace();
    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-26T21:06:34.303

这个怎么样：

```
String sql = "SELECT * FROM foobar_table WHERE 1=1";

if ( foo != 0 )
    sql += " AND foo=" + foo;
if ( !bar )
    sql += " AND bar=" + bar;

try{
    PreparedStatement getStmt = con.prepareStatement(sql);
} catch (SQLException e ){
    e.printStackTrace();
} 
```

# python - appcfg.py 更新不存储 cookie 并不断询问密码

> ID：12133840
> 
> 赞同：1
> 
> 时间：2012-08-26T20:54:56.013
> 
> 标签：python, google-app-engine, python-2.7, windows-8, mingw32

根据文档 appcfg.py 更新将第一次询问密码，然后将其存储在 cookie 中，随后不再询问。

这对我不起作用，我每次都必须输入密码。~/.appcfg_cookies 对我来说总是空的（我已经确认了它的写权限）。

我正在通过 Windows 8/amd 的 MinGW 在 Windows 上运行它。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T04:20:16.517

这更像是要提交到[http://code.google.com/p/googleappengine/issues/list](http://code.google.com/p/googleappengine/issues/list)的问题。

同时，我建议您使用 OAuth2，使用该`--oauth2`选项。有关详细信息，请参阅[使用 OAuth2 进行无密码登录。](https://developers.google.com/appengine/docs/python/tools/uploadinganapp#oauth)

# r - ggplot2：突出显示图表区域

> ID：12133846
> 
> 赞同：7
> 
> 时间：2012-08-26T20:56:31.893
> 
> 标签：r, ggplot2, xts, quantmod

我正在处理一些时间序列数据，并希望在某些条件成立时突出显示图表区域。例如：

```
require(ggplot2)
require(quantmod)
initDate <- "1993-01-31"
endDate <- "2012-08-10"
symbols <- c("SPY")
getSymbols(symbols, from=initDate, to=endDate, index.class=c("POSIXt","POSIXct"))
spy<-SPY$SPY.Adjusted
spy$sma<-SMA(spy$SPY.Adjusted,200)
spy<-spy[-(1:199),] 
spy<-as.data.frame(spy)
ggplot(spy,aes(x=index(spy),y=spy$SPY.Adjusted))+geom_line()+geom_line(aes(x=index(spy),y=spy$sma)) 
```

上面的代码绘制了数据，但是当 close 高于 sma 时，如何突出显示该部分？这个问题类似于[如何在绘图上突出显示时间范围？](https://stackoverflow.com/questions/4733182/how-to-highlight-time-ranges-on-a-plot)，但它是手动的。ggplot2 中是否有用于条件绘图的功能？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-26T21:43:50.413

基于[quantmod包的](http://cran.r-project.org/package=quantmod)[TA.R](https://r-forge.r-project.org/scm/viewvc.php/pkg/R/TA.R?view=markup&root=quantmod)文件中的代码，这里是用于查找矩形开始和结束的代码。`rle`

```
runs <- rle(as.logical(spy[, 1] > spy[, 2]))
l <- list(start=cumsum(runs$length)[which(runs$values)] - runs$length[which(runs$values)] + 1,
          end=cumsum(runs$lengths)[which(runs$values)])
rect <- data.frame(xmin=l$start, xmax=l$end, ymin=-Inf, ymax=Inf) 
```

将其与您链接到的问题的[已接受答案](https://stackoverflow.com/a/4733446/967840)中的一些`ggplot2`代码相结合：

```
ggplot(spy,aes(x=index(spy),y=spy$SPY.Adjusted))+geom_line()+geom_line(aes(x=index(spy),y=spy$sma))+geom_rect(data=rect, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), color="grey20", alpha=0.5, inherit.aes = FALSE) 
```

你得到：

![在此处输入图像描述](../Images/eb56df29ef863109458cd0f7fc3c5496.png)

如果您颠倒绘图顺序并`alpha=1`在其中使用`geom_rect`它可能（或可能不会）看起来更像您想要的：

```
ggplot(spy,aes(x=index(spy),y=spy$SPY.Adjusted))+geom_rect(data=rect, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), border=NA, color="grey20", alpha=1, inherit.aes = FALSE)+geom_line()+geom_line(aes(x=index(spy),y=spy$sma)) 
```

![在此处输入图像描述](../Images/8761bd88c72b05defe696ae0a34dadd4.png)

* * *

既然你有`xts`对象。您甚至可能不想转换为`data.frame`. 下面是如何使用Michael Weylandt 作为 Google Summer of Code[项目的一部分创建的](http://rwiki.sciviews.org/doku.php?id=developers:projects:gsoc2012:xts)[xtsExtra](https://r-forge.r-project.org/scm/viewvc.php/pkg/xtsExtra/?root=xts)包中的全新`plot.xts`方法来绘制它。

```
spy <- as.xts(spy)
require(xtsExtra)
plot(spy, screens=1,
     blocks=list(start.time=paste(index(spy)[l$start]),
                 end.time=paste(index(spy)[l$end]), col='lightblue'),                    
     legend.loc='bottomright', auto.legend=TRUE) 
```

![在此处输入图像描述](../Images/6b896c8d7e02216b27ab7a1bfee8dbbf.png)

# vb.net - 使用 vb.net 在循环中使用参数更新 MS Access 数据库

> ID：12133848
> 
> 赞同：0
> 
> 时间：2012-08-26T20:56:40.410
> 
> 标签：vb.net, ms-access, parameters

我试图更新一个名为“instock”的字段（数据库中的类型是双精度的），其中项目代码是一个值（类型是访问数据库中的长整数）。但是，当我尝试更新它们时，我收到一条错误消息，提示“此 oledbparamterCollection 的索引 2 无效，count=2。任何人都可以帮助我吗？

```
 strSQL = "UPDATE tblitem set instock = ? where itemcode= ? "
    Using cn As New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Application.StartupPath + "\\POS.mdb"), _
           cmd As New OleDbCommand(strSQL, cn)

        cmd.Parameters.Add("?", OleDbType.Double)
        cmd.Parameters.Add("?", OleDbType.integer)
        cn.Open()
        For Each ls As ListViewItem In ListItems.Items
            If Not (ls.SubItems(1).Tag(0) = "n") Then

                cmd.Parameters(1).Value = (ls.SubItems(1).Tag - ls.SubItems(1).Text)
                cmd.Parameters(2).Value = ls.Tag
                cmd.ExecuteNonQuery()
            End If
        Next ls
        cn.Close()
    End Using 
```

谢谢， + 我在执行此命令时收到此错误“没有为 double 类型找到默认成员”：

```
 strSQL = "UPDATE tblitem set instock = ? where itemcode= ? "
            Using cn As New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + Application.StartupPath + "\\POS.mdb"), _
                   cmd As New OleDbCommand(strSQL, cn)

                cmd.Parameters.Add("?", OleDbType.Double)
                cmd.Parameters.Add("?", OleDbType.Double)
                cn.Open()
                For Each ls As ListViewItem In SalesListItems.Items
                    If Not (ls.SubItems(1).Tag(0) = "n") Then

                        cmd.Parameters(0).Value = (CDbl(ls.SubItems(1).Tag) + CDbl(ls.SubItems(1).Text))
                        cmd.Parameters(1).Value = Integer.Parse(ls.Tag)
                        cmd.ExecuteNonQuery()
                    End If
                Next ls
                cn.Close()
            End Using 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:00:28.983

.NET 类库中的索引从 0 开始，包括 ADO.NET ¹

`Parameters(1)`表示“第二个参数”，`Parameters(2)`表示“第三个参数”（此处无效）。

* * *

¹这并非适用于*所有*集合，但它是当今最流行的惯例。例如，Outlook 对象模型中的集合，它是暴露给 .NET 的 COM，索引仍然是基于 1 的 ..

# java - 如何将参数传递给 Windward Reports？

> ID：12133850
> 
> 赞同：1
> 
> 时间：2012-08-26T20:56:50.153
> 
> 标签：java, reporting, windward

运行报表时，我需要将参数（变量）传递给我的报表模板。我该怎么做呢？我使用的是 Windward 的 Java 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:56:50.153

您通过将参数附加到每个数据源来传递参数。您可以为每个数据源设置一组不同的参数和值。

为此，您可以创建一个包含参数的 java.util.Map。键是带有变量名的字符串。该值可以是字符串、数字或日期。如果变量将用作选择中的参数，则值类型应与数据库列类型匹配。

这些是通过调用 DataSourceProvider.setMap() 在数据源中设置的。Dom4jDataSource 和 JdbcDataSource 都实现了 DataSourceProvider。

```
DataSourceProvider datasource = new JdbcDataSource("com.microsoft.sqlserver.jdbc.SQLServerDriver", "jdbc:sqlserver://localhost:1433;DatabaseName=Northwind", "username, "password");
Map map = new HashMap();
map.put("now", new Date());
datasource.setMap(map); 
```

请注意，如果将多个数据源应用于模板，则变量将跨数据源进行传输。如果在第一个数据源中设置了变量，而在第二个数据源中没有设置，它将保留第一个数据源的值。如果它是在第二个中设置的，那将覆盖保存的值。

# java - 如何区分 mouseDragged 和 mousePressed？

> ID：12133854
> 
> 赞同：2
> 
> 时间：2012-08-26T20:57:16.383
> 
> 标签：java, mouse, awt, mouselistener

我希望我的程序在用户按下组件时表现不同，并且当用户将鼠标拖到组件上时，问题是在鼠标单击时这两个方法都被调用（并且似乎 mouseDragged 在 mousePressed 之后被调用） ，那么我怎么知道用户是拖动鼠标还是按下鼠标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T21:08:49.903

正确的答案是使用 mouseClicked 而不是 mousePressed+mouseReleased 的组合，以防您想区分单击和拖动。

# python - 暂停系统功能，直到我的 python 脚本完成

> ID：12133857
> 
> 赞同：0
> 
> 时间：2012-08-26T20:57:45.717
> 
> 标签：python, linux, passwords

我编写了一个简单的 python 脚本，只要我的 linux 系统上的某个用户登录，它就会运行。它要求输入密码……但是问题是他们只是退出终端或将其最小化并继续使用计算机。所以基本上它是一个密码认证脚本。所以我很好奇的是如何让python脚本保持运行，在输入正确密码之前不让它们退出或做任何其他事情。是否有一些我需要导入的模块或一些可以暂停系统功能的命令，直到我的 python 脚本完成？

谢谢

我这样做只是出于兴趣，我知道很多事情可能会出错，但我认为这将是一件有趣的事情。它甚至可以保护 1 个特定的系统进程。我只是好奇如何暂停系统并让用户先执行 python 脚本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T21:20:16.843

用户总会有办法通过您的脚本。

让我们假设您实际上设法阻止了 X 服务器，而没有阻止对程序的输入（因此用户仍然可以输入密码）。用户可以从 X-server 到控制台的 alt-f1 并杀死“你奇怪的应用程序”。如果你也设法阻止它，他可以通过 ssh 连接到盒子并杀死你的应用程序。

肯定没有通用的方法来做这样的事情；这就是控制台的登录命令和图形显示的会话管理器（如 gdm）的用途：它们要求用户在给他某种形式的交互式会话之前输入他的密码。在那之后，你为什么还要另一个密码来做同样的事情？该系统旨在不允许用户在没有密码（或其他形式的身份验证）的情况下使用它，但没有 API 可以让程序在他们愿意时阻止系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T21:25:54.230

您想要等效于“模态”窗口，但这在多用户、多任务环境中（直接）是不可能的。

下一个最好的事情是阻止用户*访问*系统。例如，如果您创建一个与显示器一样大的不可见窗口，它将拦截任何鼠标事件，并且“后面”的任何内容都将无法访问。

此时，您遇到了阻止用户使用键盘来终止应用程序、切换到另一个应用程序或另一个虚拟控制台的问题（这可能是最困难的）。所以你需要访问和锁定键盘，不仅是“标准”键盘，还有低级键。

为此，您的应用程序需要具有管理权限，并在用户环境中运行。*除非您真的*知道自己在做什么，否则这开始看起来像是灾难的秘诀。

您想要做的事情应该通过与您的显示管理器集成的可插入身份验证模块 (PAM) 来完成。也许，您可以找到一些 PAM 模块来“外包”或“回调”一些外部程序，即您的 Python 脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T22:52:40.707

由于这只是为了好玩，所以这里有一个工作：如果用户在一段时间内忽略提示，或者关闭终端/终止进程，则让脚本将用户注销。以下是 gnome 的样子：

```
import os

def set_exit_handler(func):
    import signal
    signal.signal(signal.SIGHUP, func) # on closing the terminal
    signal.signal(signal.SIGTERM, func) # on killing the process

    import atexit
    atexit.register(func) # on Ctrl-C, Ctrl-D and other proper exits

if __name__ == "__main__":
    def on_exit(a=None, b=None):
        print "exit handler triggered"
        os.system("gnome-session-quit --logout --no-prompt")
    set_exit_handler(on_exit)

    print "Enter password:"
    raw_input()
    # ... some verification/timeout code ... 
```

如果用户现在将关闭终端或终止进程，他将立即注销:)

# c - ls | 使用 C 的 wc 不起作用

> ID：12133858
> 
> 赞同：0
> 
> 时间：2012-08-26T20:57:48.583
> 
> 标签：c, pipe

我编写了一个 C 程序，它使用多个管道来模拟 shell。问题是我可以运行大多数命令，例如`ls | cat`etc，但我无法使用`ls | wc`. 有没有什么情况下`wc`不工作？

```
int pipefd[4]; 
int p1 = pipe(pipefd);          // Open pipe 1
int p2 = pipe(pipefd + 2);      // Open pipe 2

pid_t pid;

for(i = 0; i < n_commands; i++)
{
    fflush(stdout);
    pid = fork();

    if(pid == 0)
    {
        int command_no = i;
        int prev_pipe = ((command_no - 1) % 2) * 2;
        int current_pipe = (command_no % 2) * 2;

        // If current command is the first command, close the
        // read end, else read from the last command's pipe
        if(command_no == 0)
        {
            close(pipefd[0]);
        }
        else
        {
            dup2(pipefd[prev_pipe], 0);
            close(pipefd[current_pipe]);
        }

        // If current command is the last command, close the
        // write end, else write to the pipe
        if(command_no == n_commands - 1)
        {
            close(pipefd[current_pipe + 1]);
        }
        else
        {
            dup2(pipefd[current_pipe + 1], 1);
        }

        int p = execvp(tokens[cmd_pos[command_no]], tokens + cmd_pos[command_no]);

        close(pipefd[current_pipe]);
        close(pipefd[prev_pipe]);
        close(pipefd[prev_pipe + 1]);
        close(pipefd[current_pipe + 1]);

        _exit(0);
    }
} 
```

`/usr/bin`如果它们不是管道中的第一个命令，那么它们似乎没有被执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:43:06.473

您连接管道不正确。

这个逻辑：

```
int prev_pipe = ((command_no - 1) % 2) * 2;
int current_pipe = (command_no % 2) * 2; 
```

不起作用 - 模数的结果将始终是`0`or `1`，因此`prev_pipe`并且`current_pipe`将是`0`or `2`...

好吧，除非我错过了一些隐藏的概念，因为您没有粘贴任何创建管道的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T04:16:14.190

这是从您的代码创建的一个非常简单的程序 - 猜测可能如何创建管道并`argv`稍微简化命令处理：

```
#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

static char *argv_ls[] = { "ls", 0 };
static char *argv_wc[] = { "wc", 0 };
static char **cmds[]   = { argv_ls, argv_wc };

int main(void)
{
    int n_commands = 2;
    int pipefd[2];

    pipe(&pipefd[0]);   // Error check!

    fflush(stdout);
    for (int i = 0; i < n_commands; i++)
    {
        int pid = fork();

        if (pid == 0)
        {
            int command_no = i;
            int prev_pipe = ((command_no - 1) % 2) * 2;
            int current_pipe = (command_no % 2) * 2;
            printf("cmd %d: prev pipe %d, curr pipe %d\n", i, prev_pipe, current_pipe);
            fflush(stdout);

            // If current command is the first command, close the
            // read end, else read from the last command's pipe
            if (command_no == 0)
            {
                close(pipefd[0]);
            }
            else
            {
                dup2(pipefd[prev_pipe], 0);
                close(pipefd[current_pipe]);  // Line 40
            }

            // If current command is the last command, close the
            // write end, else write to the pipe
            if (command_no == n_commands - 1)
                close(pipefd[current_pipe + 1]);  // Line 46
            else
                dup2(pipefd[current_pipe + 1], 1);

            execvp(cmds[i][0], cmds[i]);
            fprintf(stderr, "Failed to exec: %s (%d: %s)\n", cmds[i][0], errno, strerror(errno));
            _exit(1);
        }
    }

    return 0;
} 
```

当 GCC 4.7.1（在 Mac OS X 10.7.4 上）编译它时，它会警告：

```
pipes-12133858.c: In function ‘main’:
pipes-12133858.c:40:22: warning: array subscript is above array bounds [-Warray-bounds]
pipes-12133858.c:46:22: warning: array subscript is above array bounds [-Warray-bounds] 
```

当我运行它时，我得到输出：

```
Isis JL: pipes-12133858
cmd 0: prev pipe -2, curr pipe 0
cmd 1: prev pipe 0, curr pipe 2
Isis JL: wc: stdin: read: Bad file descriptor 
```

由于代码中的父级不等待子级完成，因此提示出现在来自 的错误消息之前`wc`，但打印的诊断数字表明存在各种问题（编译器能够发现一些问题） .

请注意，无需检查任何`exec*()`函数族的返回值。如果成功，则不返回；如果他们回来，他们就失败了。在调用之前也不需要关闭，`_exit(0);`因为系统无论如何都会关闭它们。此外，当您执行某项操作失败时，打印一条消息指示您未能执行的操作并以非零退出状态退出是很有礼貌的。

因此，正如[Michał Górny](https://stackoverflow.com/users/165333/michal-gorny)所说，您的问题的主要部分是您的管道处理代码至少是神秘的，因为您没有显示它并且可能是错误的。

我也可以肯定你的代码中没有足够的`close()`调用。作为指导，在每个打开了管道并将成为管道一部分的进程中，系统调用返回的所有文件描述符`pipe()`都应该在任何给定的子进程使用`exec*()`函数之前关闭。不关闭管道会导致进程挂起，因为管道的写入端是打开的。如果写入端打开的进程是试图从管道的读取端读取的进程，那么它不会找到任何要读取的数据。

# linux - 在没有 ``sudo`` 的情况下访问（树莓派的）GPIO

> ID：12133860
> 
> 赞同：20
> 
> 时间：2012-08-26T20:58:08.220
> 
> 标签：linux, sudo, raspberry-pi, gpio

当然，这个问题可能不是特定于树莓派的。另外，我对 Linux 比较陌生。

我想编写一个小库（在 node.js 中，如果重要的话）来使用 sysfs 访问树莓派的 GPIO。但是，访问 sysfs 需要 sudo 访问权限，这很糟糕，原因很明显。

[Quick2Wire](https://github.com/quick2wire/quick2wire-gpio-admin)似乎有解决方案，但我想更好地理解它，而不是盲目地使用它。他们当然使用过 C，但据我了解，代码并不复杂，可能只用 bash 就可以完成，即使不那么优雅。但是，最重要的是，我不确定它**为什么**会起作用。

任何帮助都会很棒。

编辑：感谢您的评论。很明显，我需要重新表述这个问题。这里有：一旦安装（作为root），应用程序不需要任何更多的root权限才能使用？在这种情况下，将某人添加到组有什么帮助？`/sys/devices/virtual/gpio`不是gpio sysfs可用的位置，那有什么诡计？我真的是一个n00b，所以这些问题可能是n00b-ish，所以请多多包涵。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-13T17:02:53.763

Rakesh，我一直在试图弄清楚完全相同的事情，我想我已经解决了。

您根本不需要了解很多makefile。重要的几行如下，运行时在bash中执行`sudo make install`

```
install: install-files
    groupadd -f --system gpio
    chgrp gpio $(DESTDIR)/bin/gpio-admin
    chmod u=rwxs,g=rx,o= $(DESTDIR)/bin/gpio-admin 
```

`groupadd -f --system gpio`创建一个名为 gpio 的系统组。`chgrp gpio $(DESTDIR)/bin/gpio-admin`将二进制文件组（C 文件 gpio-admin.c 编译成的）更改为 gpio。二进制文件的所有者仍然是 root（因为您以 root 身份运行 make。）`chmod u=rwxs,g=rx,o= $(DESTDIR)/bin/gpio-admin`做了两件重要的事情。首先，它让 gpio 组的成员运行 gpio-admin。其次，它在 gpio-admin 上设置 setuid 位。

当您将自己添加到 gpio 组时，您可以运行 gpio-admin，而无需使用 sudo，但 gpio admin 会像在 sudo 下运行一样。这允许它写入 /sys/class/gpio/export 文件。它还允许它更改创建的文件 /sys/class/gpio/gpio[pin number]/direction 等的所有者。

即使您将/sys/class/gpio/export 的组更改为gpio，并设置权限以允许您对其进行写入

```
sudo chgrp gpio /sys/class/gpio/export /sys/class/gpio/unexport
sudo chmod g+rwx /sys/class/gpio/export /sys/class/gpio/unexport 
```

您可以在没有超级用户权限的情况下导出 pin

```
echo 22 > /sys/class/gpio/export 
```

但是文件 /sys/class/gpio/gpio22/direction 等仍然会以 root 作为所有者和组创建，您需要使用 sudo 来更改它们。此外，每次重新启动后，导出和取消导出文件的所有权将恢复为 root。

# c++ - 为什么在使用时构建没有预编译头文件的 DLL 会导致奇怪的错误？

> ID：12133861
> 
> 赞同：5
> 
> 时间：2012-08-26T20:58:14.563
> 
> 标签：c++, c, visual-studio, dll, precompiled-headers

总结：今天我发现当一个 DLL 在没有预编译头的情况下构建时，当你尝试使用它时会出现一个奇怪的错误。

禁用预编译头文件时，构建 DLL 可以正常工作。但是，一旦附加了 DLL（编译时或运行时），就会导致错误“无效参数”。两种情况的实际错误代码不同。附加编译时弹出一个对话框，错误代码为 0xc000000d，调用`LoadLibrary()`它时返回一个`NULL`指针并`GetLastError()`返回 0x57。

编辑：

我发现禁用增量链接后问题就消失了。在运行附加到 DLL 编译时的客户端时，不知何故我错过了 Visual Studio 显示的以下错误：

```
'TestClient.exe': Loaded 'D:\Projects\PchDllTest2\Debug\TestClient.exe', Symbols loaded.
'TestClient.exe': Loaded 'C:\WINDOWS\system32\ntdll.dll', Cannot find or open the PDB file
'TestClient.exe': Loaded 'C:\WINDOWS\system32\kernel32.dll', Cannot find or open the PDB file
'TestClient.exe': Loaded 'D:\Projects\PchDllTest2\Debug\TestDll.dll', Symbols loaded.
SXS: RtlCreateActivationContext() failed 0xc000000d
LDR: LdrpWalkImportDescriptor() failed to probe D:\Projects\PchDllTest2\Debug\TestDll.dll for its manifest, ntstatus 0xc000000d
Debugger:: An unhandled non-continuable exception was thrown during process load
The program '[5292] TestClient.exe: Native' has exited with code -1073741811 (0xc000000d). 
```

根据要求，函数声明：

```
#ifdef __cplusplus
extern "C" {
#endif

MYTEST_API int MyTestFoo(int a);

#ifdef __cplusplus
}
#endif 
```

~~这是一个值得注意的一件事：当您使用向导（新项目 - > Visual C ++-> Win32-> Win32 Project）创建新的DLL时，向导会强制您在选择DLL作为应用程序类型时使用预编译标头。~~请参阅 ta.speot.is 的答案。

我彻底改变了这个问题，因为它看起来就像我认为它以某种方式记录了 DLL 项目需要 PCH。事实并非如此，它可能是一种奇怪的错误（希望不是）或者我可能正在做一些非常愚蠢的事情......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T08:40:13.760

> 为什么在构建 DLL 时需要预编译头文件？

他们不是。

> 总结：今天我发现如果不使用预编译的头文件构建它，就不可能制作一个（正常运行的）DLL。有谁知道这是什么原因？

发现这一点的原因是您误读了某些内容。

您可以制作没有预编译头文件的二进制文件就好了。

> 这是一个值得注意的一件事：当您使用向导（新项目 - > Visual C ++-> Win32-> Win32 Project）创建新的DLL时，向导会强制您在选择DLL作为应用程序类型时使用预编译标头。

也许在 Visual C++ 6 中，但我对 Visual Studio 的经验表明并非如此。如果您使用向导创建一个空项目，则不会获得预编译的头文件。

![向导](../Images/e71b4becc417e7eebb353f60abf6b7da.png)

除此之外，我在 Google 上查看了“对于它的清单，ntstatus 0xc000000d”，最终我在[这里](https://stackoverflow.com/questions/5850273/can-not-load-a-dll-file)结束了。最后一个答案表明您的 CRT 版本不匹配，如果您让 Visual Studio 为您创建项目并坚持默认设置，这将很难做到。

检查您是否在“主机”应用程序和库中链接到相同版本的 CRT 可能会有所帮助（例如，两者都是多线程调试）。

我能想到的唯一另一件事是您正在`TestDll.dll`进入`Debug`没有随附`TestDll.dll.manifest`文件的文件夹（如果有的话）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T12:15:22.280

我发现 DLL 有一个嵌入式清单资源，其中只包含一个 little-endian UTF-16 字节顺序标记。Windows DLL 加载程序在尝试加载此类 DLL 时崩溃并出现上述错误。

我确信这只是一个奇怪的错误：如果我使用 Visual Studio 或 MSBuild 构建 DLL，它会生成一个带有虚假清单资源的 DLL。如果我在命令行上手动执行 MSBuild 报告的命令，则 DLL 包含具有 UTF-8 BOM 的有效清单资源。

*   如前所述，在禁用 PCH 的情况下构建 DLL 会导致清单资源仅包含 UTF-16 LE BOM。
*   如果在启用 PCH 的情况下构建 DLL，则清单资源包含一个 UTF-8 BOM，后跟有效的 XML。
*   如果在禁用 PCH 和禁用增量链接的情况下构建 DLL，则清单资源仅包含 XML，根本不包含 BOM。

另一种选择是在构建完成后使用资源编辑器删除有问题的清单资源，这样错误也会消失。

这是非常可重现的，使用向导或者如果您创建一个空项目并自己做所有事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T08:38:37.130

使用“预编译”头文件，您可以有效地使用之前编译的代码。如果您稍后引入了错误，“预编译”将不会编译错误，而是使用较旧的无错误代码。

# delphi - Delphi XE2 Firemonkey 的 Align 属性设置为 alScale 对坐标系有何影响？

> ID：12133866
> 
> 赞同：2
> 
> 时间：2012-08-26T20:58:40.097
> 
> 标签：delphi, delphi-xe2, firemonkey

Delphi XE2 Firemonkey 的 Align 属性设置为 alScale 对坐标系有何影响？

我正在查看 Firemonkey 的画布绘图功能，并在组件的 Align 属性设置为 alScale 时遇到了坐标系统问题。以下演示程序（FM HD 应用程序）说明了该问题。编译并运行示例代码，画几行，然后更改表单的大小以开始奇怪。这些线不会出现在预期的位置。

任何建议和解释将不胜感激！提前致谢。

主窗体（LineDrawFormUnit.pas）：

```
unit LineDrawFormUnit;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.Classes, System.Variants,
  FMX.Types, FMX.Controls, FMX.Forms, FMX.Dialogs, FMX.Objects;

type
  TLineDrawForm = class(TForm)
    Image1: TImageControl;
    Panel1: TPanel;
    Label1: TLabel;
    Label2: TLabel;
    lX: TLabel;
    lY: TLabel;
    { These event handlers are set in the IDE's object inspector }
    procedure Image1MouseDown(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Single);
    procedure Image1MouseUp(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Single);

    { This event handler is set/unset with the MouseDown and MouseUp events to capture mouse moves when drawing }
    procedure ImageControl1MouseMove(Sender: TObject; Shift: TShiftState; X, Y: Single);
    procedure FormCreate(Sender: TObject);

  private
    FSaveBitmap: TBitmap;
    p1, p2: TPointF;    { Start and end points of lines to draw }
  end;

var
  LineDrawForm: TLineDrawForm;

implementation
{$R *.fmx}

procedure TLineDrawForm.FormCreate(Sender: TObject);
begin
  Image1.Bitmap.Create(Round(Image1.Width), Round(Image1.Height));
end;

procedure TLineDrawForm.Image1MouseDown(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X,
  Y: Single);
begin
  p1.X := X;
  p1.Y := Y;
  lX.Text := FloatToStr(X);
  lY.Text := FloatToStr(Y);
  FSaveBitmap := TBitmap.Create(Image1.Bitmap.Width, Image1.Bitmap.Height);
  FSaveBitmap.Assign(Image1.Bitmap); { Save the current canvas as bitmap }
  Image1.OnMouseMove := ImageControl1MouseMove; { Activate the MouseMove event handler}
end;

procedure TLineDrawForm.ImageControl1MouseMove(Sender: TObject; Shift: TShiftState; X, Y: Single);
begin
  p2.X := X;
  p2.Y := Y;
  lX.Text := FloatToStr(X);
  lY.Text := FloatToStr(Y);
  Image1.Bitmap.Assign(FSaveBitmap);
  Image1.Bitmap.Canvas.BeginScene;
  try
    Image1.Bitmap.Canvas.Stroke.Color := claGray;
    Image1.Bitmap.Canvas.StrokeThickness := 0.5;
    Image1.Bitmap.Canvas.DrawLine(p1, p2, 1.0);
  finally
    Image1.Bitmap.Canvas.EndScene;
    Image1.Bitmap.BitmapChanged;
  end;
end;

procedure TLineDrawForm.Image1MouseUp(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X,
  Y: Single);
begin
  p2.X := X;
  p2.Y := Y;
  lX.Text := FloatToStr(X);
  lY.Text := FloatToStr(Y);
  Image1.Bitmap.Canvas.BeginScene;
  try
    Image1.Bitmap.Canvas.Stroke.Color := claBlack;
    Image1.Bitmap.Canvas.StrokeThickness := 2;
    Image1.Bitmap.Canvas.DrawLine(P1, P2, 1.0);
  finally
    Image1.Bitmap.Canvas.EndScene;
    Image1.Bitmap.BitmapChanged;
  end;

  (Sender as TControl).OnMouseMove := nil;
  if FSaveBitmap <> nil then
    FSaveBitmap.Free;

end;

end. 
```

FMX 文件（LineDrawFormUnit.fmx）：

```
object LineDrawForm: TLineDrawForm
  Left = 0
  Top = 0
  Caption = 'Polygon Form'
  ClientHeight = 513
  ClientWidth = 650
  Visible = False
  OnCreate = FormCreate
  StyleLookup = 'backgroundstyle'
  object Image1: TImageControl
    Align = alScale
    Position.Point = '(18,21)'
    Width = 620.000000000000000000
    Height = 452.000000000000000000
    OnMouseDown = Image1MouseDown
    OnMouseUp = Image1MouseUp
    TabOrder = 0
  end
  object Panel1: TPanel
    Align = alBottom
    Position.Point = '(0,480)'
    Width = 650.000000000000000000
    Height = 33.000000000000000000
    TabOrder = 2
    object Label1: TLabel
      Position.Point = '(16,8)'
      Width = 25.000000000000000000
      Height = 15.000000000000000000
      TabOrder = 1
      Text = 'X:'
    end
    object Label2: TLabel
      Position.Point = '(384,8)'
      Width = 25.000000000000000000
      Height = 15.000000000000000000
      TabOrder = 2
      Text = 'Y:'
    end
    object lX: TLabel
      Position.Point = '(32,8)'
      Width = 313.000000000000000000
      Height = 15.000000000000000000
      TabOrder = 3
      Text = '0'
    end
    object lY: TLabel
      Position.Point = '(424,8)'
      Width = 209.000000000000000000
      Height = 15.000000000000000000
      TabOrder = 4
      Text = '0'
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T13:53:37.400

align 属性影响**TShapes**后代、**TControl**等，但不影响位图的内容。

您似乎在 TBitmap 上缓冲了一些自定义绘图，然后将其分配给控件。FMX 将无法重新对齐自定义图形，因为它们没有封装在可对齐的类中（它只是一些像素）。

您可以在调整控件大小时重新绘制“缓冲区”并将其重新分配给其“主机”以使绘图适应您的意愿。或者也许不要释放“缓冲图纸”并在调整表单大小时对其进行转换/重新分配。

但更好的方法是使用形状系统，这将与 FMX HD 的使用方式相匹配，对齐将是自动的。所以不要画一条线，而是在父对象内创建一个 TLine 并根据父控件分层这条新线的对齐方式。

# java - 施工期间的虚拟功能。为什么 Java 不同于 C++

> ID：12133875
> 
> 赞同：14
> 
> 时间：2012-08-26T21:00:04.063
> 
> 标签：java, c++

我今天有一个测试，其中一个问题是关于在 C++ 构造函数中使用虚拟方法。我没有通过这个问题，我回答应该没有任何问题，但是在阅读后[我](http://www.artima.com/cppsource/nevercall.html)发现我错了。

所以我知道不允许这样做的原因是因为派生对象没有完全初始化，因此调用它的虚拟方法可能会导致无效的后果。

我的问题是如何在 Java/C# 中解决？我知道我可以在我的基本构造函数中调用派生方法，我会假设这些语言有完全相同的问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-26T21:06:15.753

Java 具有与 C++ 非常不同的对象模型。在 Java 中，您不能拥有属于类类型对象的变量——相反，您只能拥有对（类类型）对象的*引用。*因此，类的所有成员（它们只是引用）一开始都是微不足道的，`null`直到整个派生对象都已在内存中设置完毕。只有这样构造函数才会运行。因此，当基构造函数调用虚函数时，即使该函数被覆盖，被覆盖的函数至少可以正确地引用派生类的成员。（这些成员自己可能还没有被*分配*，但至少他们*存在*。）

（如果有帮助，您还可以认为Java 中没有成员的*每个*类`final`在技术上都是可默认构造的，至少在原则上是这样：与 C++ 不同，Java 没有常量或引用（*必须*在 C++ 中初始化）之类的东西，并且实际上根本没有初始化列表。Java 中的变量根本不需要初始化。它们要么是以 0 开头的原语，要么是以 . 开头的类类型引用`null`。一个例外来自非静态`final`类成员，它不能被反弹，实际上必须通过在每个构造函数中的某个位置精确地“初始化”*一个*赋值语句[感谢@josefx 指出这一点！]。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T03:21:55.837

> 理解不允许这样做的原因是因为派生对象没有完全初始化，因此调用它的虚方法可能会导致无效的后果

错误的。C++ 将调用方法的基类实现，而不是派生类的实现。没有“无效后果”。避免该构造的唯一正当理由是该行为有时会出人意料。

这与 Java*不同*，因为 Java 调用派生类的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T21:06:42.180

每个 Java 构造函数都如下所示：

```
class Foo extends Bar {
  Foo() {
    super(); // creates Bar
    // do things
  }
} 
```

因此，如果您将在派生方法上工作的代码`do things`放在`super();`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-26T21:17:18.910

在 C++ 中，每个多态类（具有至少一个虚函数的类）在它的开头都有一个隐藏指针（通常命名为 v-table 或类似名称），它将被初始化为虚拟表（指向的函数数组）该类的每个虚函数的主体），当您调用虚函数时，C++ 只需调用`((v-table*)class)[index of your function]( function-parameters )`，因此，如果您在基类构造函数中调用虚函数，则 v-table 指向基类的虚拟表，因为您的类是基类并且它仍然需要一些初始化才能成为子函数，因此您将从基础而不是子函数调用函数的实现，如果这是一个纯虚函数，您将遇到访问冲突。
但是在java中这不是这样的，在java中整个类是这样`std::map<std::string, JValue>`的`JValue`是某种变体类型（例如联合或`boost::variant`）当您在 base 的构造函数中调用函数时，它会在映射中找到函数名称并调用它，它仍然不是来自孩子的值，但您仍然可以调用它，如果您更改了它`prototype`，因为原型在构造函数之前创建，您可以成功地从子函数调用函数，但如果函数需要从子构造函数进行一些初始化，您仍然会收到错误或无效结果。
所以一般来说，从基类中的子函数（例如虚函数）调用函数不是一个好习惯。如果您的类需要这样做，请添加一个初始化方法并从子类的构造函数中调用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T21:16:05.600

我认为 Java/C# 通过从派生类向后构造而不是在 C++ 中从基类向前构造来避免这个问题。

Java 在类构造函数中隐式调用 super()，因此当派生类构造函数中的第一行编写代码被调用时，所有继承类的所有构造函数都保证已被调用，因此新实例将已完全初始化.

我也认为在 C++ 中，一个类的新实例作为基类开始生命，并随着我们沿继承链向下移动而“升级”为最终类类型。这意味着当您在构造函数中调用虚函数时，您实际上将调用基类的该函数的版本。

在 Java 和可能的 C# 中，一个新实例作为所需的类类型开始生命，因此将调用正确版本的虚拟方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-26T22:44:07.817

Java 并没有完全避免这个问题。

从依赖于子类字段的超类构造函数调用的重写方法将在这些字段被初始化之前被调用。

如果您控制整个类层次结构，您当然可以确保您的覆盖不依赖于子类字段。但是不从构造函数调用虚方法更安全。

# java - 在 Android 应用中更新 Facebook 联系人列表的最佳选择

> ID：12133876
> 
> 赞同：2
> 
> 时间：2012-08-26T21:00:14.390
> 
> 标签：java, android, facebook

我正在开发一个应用程序来检索 Facebook 联系人列表，以便稍后使用它执行不同的操作（例如，打开聊天）。

我已经检索了该列表，但我怀疑哪个是保存并将其应用于发生的更改的最佳策略（例如，新联系人可以使用聊天）。

最好的方法是什么？作为第一个选项，我创建了一个 java 类并序列化了整个联系人列表（带有他们的个人资料图片）。在我保存在 SD 卡上并保留它以供以后需要时检索。但我在想也许最好在Android中创建一个服务来实例化一个存储联系人HashMap的类并将其留在内存中以观察它不断更新。

你怎么看待这件事？

谢谢

# javascript - 寻求帮助在 html5 中指定教科书格式，专门用于平板电脑，包括记笔记

> ID：12133880
> 
> 赞同：2
> 
> 时间：2012-08-26T21:00:54.907
> 
> 标签：javascript, html

我 9 岁的儿子视力非常低，1/10。目前，他学校的支持人员为他提供了教科书的 pdf 扫描件，并为他在 PC 上访问教科书提供了良好的培训。

但是，我认为这并不理想，原因有很多：

*   大文件（一本地理书是300Mb，做扫描的人不是技术人员）
*   文字大小只能通过缩放间接控制，我的男孩至少需要 40pt 文字
*   难以导航，即有很多滚动来回只是为了阅读一个短语，使整个阅读过程有点累。
*   无法记笔记和/或填写教科书中的答案区域。
*   无法访问目录/索引/
*   PC 问题（重量/功率/与平板电脑相比完全缺乏冷却）

所以，我认为 html5 的世界对我有一个答案。我希望走向的过程如下：

*   我扫描教科书并通过像 ABBY
    FineReader 这样的 OCR 程序运行它们。
*   这给了我原始文本和图像
*   将这些原始数据转换为 html5 格式，其结构类似于

    ```
    <div class="book">
        <div id="TOC"></div> (This TOC will be built dynamically)
        <div class="page" id="1"> (Important to keep the notion of pages to allow him to have the same reference as the rest of the class)
            <div class="text"></div>
            <div class="img"></div>
            <div class="answerzone"></div>
            <div class="footer"></div>
        </div>
    </div> 
    ```

*   接下来，javascript 启动并添加以下功能

    *   大的、半透明的左右箭头始终显示在屏幕底部角落
    *   大的、半透明的页码总是很明显，例如在右上角
    *   左上角的大半透明符号可访问以下功能
    *   访问目录
    *   增加/减少字体大小
    *   添加一个区域，他可以在其中从键盘或用手写笔在屏幕上书写文本。这个区域可以有一个图像作为背景，例如他需要在答案周围画圈。
    *   他添加的所有内容（文本/图像）都本地存储在平板电脑上

毕竟，这是问题部分。有没有人有类似要求的经验找到了解决方案？我可以做 javascript 的东西（我想我可以）到区域来添加文本/图像并在本地存储所有这些。有没有人可以指出可以满足我需要的现有 html5 解决方案？

此致，

科尔姆

PS我已经离开了整个epub，让我们面对现实吧，它只是html，为什么不使用浏览器而不是电子书阅读器解决方案呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T01:12:29.207

看看这篇文章：[使用 CSS3 构建书籍](http://www.alistapart.com/articles/building-books-with-css3/ "一个列表分开")

那是一篇很棒的文章，它有很多非常有用的技术。显然，您将不得不生成大量 HTML，但使用该文章中介绍的技术，您将不必生成几乎一样多的*无用*HTML。那篇文章确切地告诉你如何做页码和目录，并且使用 JavaScript 来创建左右箭头来改变页面并不难（当然也可以用 CSS 来设置样式）。

至于注释，我有点困惑你是想把它用于平板电脑还是 PC。如果是用于 PC，我建议使用预构建的工具，例如[Zotero](https://addons.mozilla.org/en-US/firefox/addon/zotero/)。如果它是用于平板电脑的，那么您可能需要稍微靠耳朵来玩，因为您能做或不能做的事情因平板电脑而异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:12:35.173

这是一个非常困难的问题。最大的问题是从 PDF 中获取智能文本。PDF 没有您将习惯使用 HTML 的结构。它本质上是一张打印到的电子纸。文本排列在视觉上排列的块中，但在文件中可能彼此没有太大关系。

我认为您最好的选择可能是使用[Calibre](http://calibre-ebook.com/)将格式更改为其他格式。结果远非完美，尤其是在像教科书这样复杂的东西中。当您转换一本书时，请确保进入 Heristic Processing 的选项并启用它。

如果 Calibre 不适合您，也可以使用一些库来执行此操作。
[itext](http://itextpdf.com/)可免费用于非商业用途，并具有文本提取功能。 [pdfbox](http://pdfbox.apache.org/)是免费的，并且还具有文本提取功能。 [pdfnet](http://www.pdftron.com/pdfnet/)是一个商业产品，但可能有一些你可以使用的东西。

我不确定您是否会获得令人满意的自动化结果。鉴于您只需要处理一个孩子的课程，而不是庞大的 PDF 库，可能值得花时间手动复制每一页。这样，您可以以智能的方式排列文本。

# java - 加载弹簧骆驼上下文时出错（类型不匹配）

> ID：12133883
> 
> 赞同：4
> 
> 时间：2012-08-26T21:01:04.103
> 
> 标签：java, spring, apache-camel, apache-servicemix

我在一个带有弹簧骆驼上下文、一条路线和一个测试的小项目上使用 Fuse IDE (Eclipse)。我放了一个额外的 xml 来定义测试执行环境。

当我运行测试时，加载上下文 bean 信息的类型不匹配失败（当实例化 bean 上下文的 PropertyDescriptor 类时，setter 类型是 org.apache.camel.spring.SpringCamelContext，getter 类型是 org.apache.camel.model。模型骆驼上下文...

原来的异常是：“java.beans.IntrospectionException：读写方法之间的类型不匹配”

测试代码是这样的：

```
public class TestDBRoute extends CamelSpringTestSupport {   

@DirtiesContext //reload context
@Test
public void testPoll() throws Exception {
    //context.start();
    System.out.println("comenzo");
    Thread.sleep(1000);
    System.out.println("termino");
    //context.stop();
    assertEquals("first", 1, 1);
}

@Override
protected AbstractApplicationContext createApplicationContext() {
    return new ClassPathXmlApplicationContext("classpath:/com/test-camel-context.xml");
}
} 
```

骆驼上下文代码是：

```
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="
   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
   http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

<camelContext xmlns="http://camel.apache.org/schema/spring">
        <packageScan>
            <package>com.test.fuse.routes</package>
        </packageScan>
</camelContext>
</beans> 
```

路由代码为空，它只扩展了 RouteBuilder 并覆盖了 configure 方法。

我在 ubuntu 上使用 OpenJDK 1.6.0_24。

如果您需要其他东西，请询问。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T19:25:44.847

我只是清理了工作区，并将 pom.xml 上的 spring 版本从 2.5.4 更改为 2.5.6，一切正常。

感谢 Claud Ibsen 和 Babak Vahdat 的帮助。

# git - IntelliJ Git rebase 错误

> ID：12133885
> 
> 赞同：1
> 
> 时间：2012-08-26T21:01:27.257
> 
> 标签：git, intellij-idea

我有以下情况：

1.  一个分支`master`；
2.  一个主题分支`x`；`master`
3.  我已经对 做出了承诺`master`，并且我也希望能够在其中使用`x`它。我的理解是我必须重新`x`建立基础`master`。

这就是我所做的：

1.  结帐`x`分支：`VCS -> Git -> Branches -> Local branches -> x -> Checkout`;
2.  去`VCS -> Git -> Rebase -> Select master in onto`。
3.  单击变基。

此时出现一个错误，告诉我检查 VC 控制台以获取详细信息。这是控制台显示的内容：

```
23:59:22.839: git rebase -i -v -m refs/heads/master
Cannot rebase: You have unstaged changes.
Additionally, your index contains uncommitted changes.
Please commit or stash them. 
```

任何地方的任何分支都没有挂起的更改。一切都已提交（如果有什么不同，则推送到 Bitbucket）。我这样做对吗？我怎样才能重新建立我的分支`master`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T03:10:28.960

发生错误是因为您有未暂存的更改，存储它们或提交它们将允许您执行 rebase 命令。

**但是，我认为你在这里做的是完全错误的。**

首先，您不应该在主分支上提交，您应该在主题分支上提交并将其与/在主分支上合并/变基。

其次，根据你想要做的，它是在 x 上重新定位 master，而不是在 master 上重新定位 x。

所以你应该

```
1, checkout master  --> git checkout master
2, rebase on x      --> git rebase x
3, do some merge job
4, continue the rebase --> git rebase --continue 
```

顺便说一句，您应该阅读[pro-git](http://git-scm.com/book)，它是免费的，而且是一本非常好的书。

**编辑：**

阅读您发布的网址后，我想我在这里有一些误解。

说你有这个：

```
$ git log --oneline --graph --decorate --all
* c85d8bd (HEAD, master) dev on master again
| * 431a9c6 (topic) dev on topic
|/
* 4ad2cc4 dev on master
* d576e88 init 
```

在这里我们将尝试两个变基命令：

**1、rebase master on topic**

```
git checkout master
git rebase topic 
```

这将使历史看起来像这样：

```
$ git log --oneline --graph --decorate --all
* 03021da (HEAD, master) dev on master again
* 431a9c6 (topic) dev on topic
* 4ad2cc4 dev on master
* d576e88 init 
```

**2、rebase topic on master**

```
git checkout topic
git rebase master 
```

你的历史将是这样的：

```
$ git log --oneline --graph --decorate --all
* adc93f1 (HEAD, topic) dev on topic
* c85d8bd (master) dev on master again
* 4ad2cc4 dev on master
* d576e88 init 
```

这都是关于你想要谁在谁身上:)

我以这种方式记住这一点：

```
merge with <branch>
rebase on <branch> 
```

但有一个例外，同时使用：

```
git rebase --onto 
```

[您可以在pro-git](http://git-scm.com/book)的第 3.6 章中找到这些详细信息

# frameworks - 敏捷工具包 addExpression 和 DSQL

> ID：12133890
> 
> 赞同：0
> 
> 时间：2012-08-26T21:01:48.807
> 
> 标签：frameworks, atk4, php

我一直在关注敏捷工具包提供的书，并且在这一部分： [http ://agiletoolkit.org/learn/app/logic](http://agiletoolkit.org/learn/app/logic)

不幸的是，dsql api 缺乏一些清晰度，并且该页面上的计算字段示例无法正常工作。

我尝试使用：

```
class Model_DVD extends Model_Table {

        public $table='dvd';

    function init(){
        parent::init();

        $this->hasOne('Movie');
        $this->addField('code');
        $this->addfield('is_rented')
            ->type('boolean')
            ->calculated(true);
    }

    function calculate_is_rented(){
        return $this->add('Model_Rental')
            ->dsql()
            ->field('id')
            ->where('rental.dvd_id=dvd.id')
            ->where('is_returned!=','Y')
            ->select()
            ;
    }
} 
```

这每次都返回 1，所以我尝试遵循： [计算字段总是返回 1 - atk 4.2](https://stackoverflow.com/questions/10286262/calculated-field-always-returns-1-atk-4-2)

现在我不确定如何正确创建它；我知道以下工作，但我在去的时候有点编造它并且不知道它为什么工作，以及为什么我需要 count() - 等等。

如何让计算字段工作？有人可以在这个例子中解释一下吗，我通过例子学得最好，所以我想坚持下去。

我不明白的工作代码：

```
class Model_DVD extends Model_Table {

    public $table='dvd';

    function init(){
        parent::init();

        $this->hasOne('Movie');
        $this->addField('code');

        $this->debug();

        $this->addExpression('is_rented')->set($this->add('Model_Rental')
                                                    ->addCondition('dvd_id', $this->_dsql()->getField('id'))
                                                    ->count()
                                                    ->where('is_returned!=','Y'))
                                                    ->datatype('boolean')
                                                    ->enum(array('Y', 'N'));
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T02:15:37.470

DSQL APP 教程适用于 Agile Toolkit 4.1。

请观看截屏视频[http://youtube.com/theagiletoolkit](http://youtube.com/theagiletoolkit)以获取更新和更广泛的教程。

# ruby-on-rails - Rails：在新选项卡中打开链接（使用“link_to”）

> ID：12133894
> 
> 赞同：154
> 
> 时间：2012-08-26T21:02:30.860
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有这个代码：

```
<%= link_to image_tag("facebook.png", :class => "facebook_icon", :alt => "Facebook", :target => "_blank"),                 
            "http://www.facebook.com/mypage" %> 
```

当用户单击链接时，如何使其在新选项卡中打开？

* * *

## 回答 #1

> 赞同：301
> 
> 时间：2012-08-26T21:11:49.227

`target: :_blank` 参数应该是 的参数， `link_to`而你把它放在`image_tag`参数中。像这样修改你的代码：

```
<%= link_to image_tag("facebook.png", class: :facebook_icon, alt: "Facebook"), "http://www.facebook.com/mypage", target: :_blank %> 
```

或者用一个块：

```
<%= link_to "http://www.facebook.com/mypage", target: :_blank do %>
  <%= image_tag("facebook.png", class: :facebook_icon, alt: "Facebook") %>     
<% end %> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-26T21:13:49.607

试试这个：

```
<%= link_to image_tag("facebook.png", :class => "facebook_icon", :alt => "Facebook"), "http://www.facebook.com/mypage", :target => "_blank" %> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-09-20T14:35:15.063

您也可以使用`target: :_blank`而不是`target: '_blank'`

```
<%= link_to image_tag("facebook.png", class: "facebook_icon", alt: "Facebook"), "http://www.facebook.com/mypage", target: :_blank %> 
```

**`link_to do`**

```
<%= link_to "http://www.facebook.com/mypage", target: :_blank do %>
  <%= image_tag "facebook.png", class: "facebook_icon", alt: "Facebook" %>
<% end %> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-25T22:00:48.837

如果您正在寻找如何在 html 中的新选项卡中打开链接（适用于来自 Google 的任何人），请点击此处：

```
<a href="http://www.facebook.com/mypage" target="_blank">Link name</a> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-03-04T20:35:57.540

要添加到先前的答案，以下格式是 rubocop 建议的格式。这可能会带来安全风险，因为加载的页面将控制前一页面，并且可能会更改其位置以进行网络钓鱼。

为了防止这种情况，需要在代码中添加“rel”属性。

```
rel: 'noopener' 
```

现在 link_to 应该是：

```
<%= link_to image_tag("facebook.png", class: :facebook_icon, alt: "Facebook"), "http://www.facebook.com/mypage", target: :_blank, rel: 'noopener %> 
```

[rubocop 文档](https://www.rubydoc.info/github/rubocop-hq/rubocop/master/RuboCop/Cop/Rails/LinkToBlank)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-07-29T15:36:01.603

我的理解是：你可以要求浏览器打开一个新标签页或者一个新站点。但这取决于用户设置。我认为这个问题得到了回答。

除非当有必要将链接选项与 html 选项分开时，我陷入了陷阱：

`link_to(name = nil, options = nil, html_options = nil, &block)`

例子：

```
link_to('Click me', { action: 'show', controller: 'blog', id: 1 }, { target: '_blank' }) 
```

# php - 在 Magento Grid 中添加自定义列，该列取自外部参照表

> ID：12133897
> 
> 赞同：0
> 
> 时间：2012-08-26T21:02:54.130
> 
> 标签：php, magento

在 Magento Grid 中，我需要添加一个自定义列（section_name），该字段是通过中间外部参照表从另一个数据库表中获取的。在 Grid.php 中，我尝试了以下代码：

```
protected function _prepareCollection() {
    $collection = Mage::getModel('module/items')->getCollection()
    ->getSelect()->join('section_name',
    'module/sections',
    'section_name',
    'table_sections.section_id=table_sections_items_xref.section_id',
    '{{table}}.item_id=table_sections_items_xref.item_id',
    'left'
    );

    $this->setCollection($collection);
    return parent::_prepareCollection();
}

$this->addColumn('section_name', array (
    'header' => Mage::helper('module')->__('Section Name'), 
    'type' => 'text',
    'index' => 'section_name',
)); 
```

# jquery - Slickgrid，如何将单元格复制粘贴到excel？

> ID：12133899
> 
> 赞同：1
> 
> 时间：2012-08-26T21:03:09.243
> 
> 标签：jquery, asp.net-mvc-3, excel, copy-paste, slickgrid

问题：

我正在使用 jqGrid 来显示表格。
但是，如果 Internet Explorer 9 和 8 必须显示超过 20 行，则性能不佳...

我已经尝试过 SlickGrid，它在 Internet Explorer 中的性能似乎对我来说要好得多。

我现在唯一阻止我切换到 SlickGrid 的问题是，使用 SlickGrid，您不能只是从 SlickGrid 复制粘贴一系列单元格以正确处理。

复制粘贴转置单元格，以便列是行，行是列（好吧，我知道你可以在 excel 中转回，但我不是普通的最终用户。此外，必须这样做是恼人的） ...

使用 jqGrid，这可以完美地工作。
请注意，我明确不想将数据输出为 CSV/XLS/XLSX 文件。

任何人都知道如何正确地将 SlickGrid 复制粘贴到 Excel（非转置）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T08:52:13.570

看到这个插件： http: [//labs.nereo.fr/slick.html](http://labs.nereo.fr/slick.html)

但它有3个问题，A.无法正确粘贴到excel，B.粘贴到SlickGrid时会破坏一个额外的单元格C.当源范围大于目标时出现错误

我做了一些改变来解决它们。见下文：

```
(function ($) {
  // register namespace
  $.extend(true, window, {
    "Slick": {
      "CellExternalCopyManager": CellExternalCopyManager
    }
  });

  function CellExternalCopyManager(options) {
    /*
      This manager enables users to copy/paste data from/to an external Spreadsheet application
      such as MS-Excel® or OpenOffice-Spreadsheet.

      Since it is not possible to access directly the clipboard in javascript, the plugin uses
      a trick to do it's job. After detecting the keystroke, we dynamically create a textarea
      where the browser copies/pastes the serialized data. 

      options:
        copiedCellStyle : sets the css className used for copied cells. default : "copy-manager"
        dataItemColumnValueExtractor : option to specify a custom column value extractor function

    */
    var _grid;
    var _self = this;
    var _copiedRanges;
    var _options = options || {};
    var _copiedCellStyle = _options.copiedCellStyle || "copy-manager";

    var keyCodes = {
      'C':67,
      'V':86
    }

    function init(grid) {
      _grid = grid;
      _grid.onKeyDown.subscribe(handleKeyDown);      
    }

    function destroy() {
      _grid.onKeyDown.unsubscribe(handleKeyDown);
    }

    function getDataItemValueForColumn(item, columnDef) {
      if (_options.dataItemColumnValueExtractor) {
        return _options.dataItemColumnValueExtractor(item, columnDef);
      }
      return item[columnDef.field];
    }

    function setDataItemValueForColumn(item, columnDef, value) {
      if (_options.dataItemColumnValueSetter) {
        return _options.dataItemColumnValueSetter(item, columnDef, value);
      }
      return item[columnDef.field] = value;
    }

    function _createTextBox(innerText){
      var ta = document.createElement('textarea');
      ta.style.position = 'absolute';
      ta.style.left = '-1000px';
      ta.style.top = '-1000px';
      ta.value = innerText;
      document.body.appendChild(ta);
      document.designMode = 'off';
      ta.focus();

      return ta;
    }
    function _decodeTabularData(_grid, ta){
      var columns = _grid.getColumns();
      var clipText = ta.value;
      var clipRows = clipText.split("\r\n"); 
     var clippeds = [];

      document.body.removeChild(ta);

      for (var i=0; i<clipRows.length; i++) {
        if (clipRows[i]!="") // get rid of the last ""
          clippeds[i] = clipRows[i].split(String.fromCharCode(9)); //  "\t" 
      }

      var selectedCell = _grid.getActiveCell();
      var activeRow = selectedCell.row + pageSize*pageNum;// getActiveCell.row starts from 0  for each page.
      var activeCell = selectedCell.cell;
      var desty = activeRow;
      var destx = activeCell;

      var data = _grid.getData().getItems();  

      for (var y = 0; y < clippeds.length; y++){
        for (var x = 0; x < clippeds[y].length; x++){
            var desty = activeRow + y;
          var destx = activeCell + x;
            if (desty < data.length && destx < grid.getColumns().length ) { 
                data[desty][columns[destx].field] = clippeds[y][x];
            if ( data[desty].hasOwnProperty('id')) 
              changedIds.push(data[desty].id);// record changed id used by saving function
          }
        }
      }

      _grid.invalidate();
    }

    function handleKeyDown(e, args) {
      var ranges;
      if (!_grid.getEditorLock().isActive()) {

        //ESC
        if (e.which == $.ui.keyCode.ESCAPE) {
          if (_copiedRanges) {
            e.preventDefault();
            clearCopySelection();
            _self.onCopyCancelled.notify({ranges: _copiedRanges});
            _copiedRanges = null;
          }
        }

        if (e.which == keyCodes.C && (e.ctrlKey || e.metaKey)) {    // CTRL + C
          ranges = _grid.getSelectionModel().getSelectedRanges();

          if (ranges.length != 0) {
            _copiedRanges = ranges;
            markCopySelection(ranges);
            _self.onCopyCells.notify({ranges: ranges});

            var columns = _grid.getColumns();
            var clipText = "" ;
            for (var rg = 0; rg < ranges.length; rg++){
                var range = ranges[rg];
                for (var i=range.fromRow; i< range.toRow+1 ; i++){
                    var dt = _grid.getDataItem(i);
                    for (var j=range.fromCell; j< range.toCell+1 ; j++){
                          if (j==range.fromCell) 
                            clipText = clipText.concat(getDataItemValueForColumn(dt, columns[j]));
                          else 
                          clipText = clipText.concat("\t",getDataItemValueForColumn(dt, columns[j]));
                    }
                    clipText = clipText.concat("\r\n");
                }
            }

            var ta = _createTextBox(clipText);

            $(ta).select();
            setTimeout(function(){
                document.body.removeChild(ta);
            }, 100);

            return false;
          }
        }

        if (e.which == keyCodes.V && (e.ctrlKey || e.metaKey)) {    // CTRL + V
            var ta = _createTextBox(''); 

            setTimeout(function(){ 
                _decodeTabularData(_grid, ta);
            }, 100);

            return false;
        }
      }
    }

    function markCopySelection(ranges) {
      var columns = _grid.getColumns();
      var hash = {};
      for (var i = 0; i < ranges.length; i++) {
        for (var j = ranges[i].fromRow; j <= ranges[i].toRow; j++) {
          hash[j] = {};
          for (var k = ranges[i].fromCell; k <= ranges[i].toCell; k++) {
            hash[j][columns[k].id] = true;
          }
        }
      }
      _grid.setCellCssStyles(_copiedCellStyle, hash);
    }

    function clearCopySelection() {
      _grid.removeCellCssStyles(_copiedCellStyle);
    }

    $.extend(this, {
      "init": init,
      "destroy": destroy,
      "clearCopySelection": clearCopySelection,

      "onCopyCells": new Slick.Event(),
      "onCopyCancelled": new Slick.Event(),
      "onPasteCells": new Slick.Event()
    });
  }
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-13T07:33:00.887

李东，谢谢！您的代码帮助了我，但我发现使用 labs.nereo.fr 版本的函数 handleKeyDown 更快。

```
(function ($) {
    // register namespace$.extend(true, window, {
        "Slick": {
          "CellExternalCopyManager": CellExternalCopyManager
        }
    });

function CellExternalCopyManager(options) {
/*
  This manager enables users to copy/paste data from/to an external Spreadsheet application
  such as MS-Excel® or OpenOffice-Spreadsheet.

  Since it is not possible to access directly the clipboard in javascript, the plugin uses
  a trick to do it's job. After detecting the keystroke, we dynamically create a textarea
  where the browser copies/pastes the serialized data. 

  options:
    copiedCellStyle : sets the css className used for copied cells. default : "copy-manager"
    dataItemColumnValueExtractor : option to specify a custom column value extractor function

*/
var _grid;
var _self = this;
var _copiedRanges;
var _options = options || {};
var _copiedCellStyle = _options.copiedCellStyle || "copied";
var _clearCopyTI = 0;

var keyCodes = {
  'C':67,
  'V':86
}

function init(grid) {
  _grid = grid;
  _grid.onKeyDown.subscribe(handleKeyDown);      
}

function destroy() {
  _grid.onKeyDown.unsubscribe(handleKeyDown);
}

function getDataItemValueForColumn(item, columnDef) {
  if (_options.dataItemColumnValueExtractor) {
    return _options.dataItemColumnValueExtractor(item, columnDef);
  }
  return item[columnDef.field];
}

function setDataItemValueForColumn(item, columnDef, value) {
  if (_options.dataItemColumnValueSetter) {
    return _options.dataItemColumnValueSetter(item, columnDef, value);
  }
  return item[columnDef.field] = value;
}

function _createTextBox(innerText){
  var ta = document.createElement('textarea');
  ta.style.position = 'absolute';
  ta.style.left = '-1000px';
  ta.style.top = '-1000px';
  ta.value = innerText;
  document.body.appendChild(ta);
  document.designMode = 'off';
  /* Изменяем фокус на select. Сделали это, чтобы после каждого копирования скорость таблицы не уменьшалась (см. ниже). 
  ta.focus();
  */
  ta.select()
  return ta;
}
function _decodeTabularData(_grid, ta){
  var columns = _grid.getColumns();
  var clipText = ta.value;
  var clipRows = clipText.split("\r\n"); 
 var clippeds = [];

  document.body.removeChild(ta);

  for (var i=0; i<clipRows.length; i++) {
    if (clipRows[i]!="") // get rid of the last ""
      clippeds[i] = clipRows[i].split(String.fromCharCode(9)); //  "\t" 
  }

  var selectedCell = _grid.getActiveCell();
  /* Переменную activeRow зануляем (что за переменные pageSize и PageNum - непонятно)
  var activeRow = selectedCell.row + pageSize*pageNum;// getActiveCell.row starts from 0  for each page.
  */
  var activeRow = null;
  var activeCell = selectedCell.cell;
  var desty = activeRow;
  var destx = activeCell;
  var changedIds = []; // Устанавливаем переменную changedIds
  var data = _grid.getData().getItems();  

  for (var y = 0; y < clippeds.length; y++){
    for (var x = 0; x < clippeds[y].length; x++){
        var desty = activeRow + y;
      var destx = activeCell + x;
        if (desty < data.length && destx < grid.getColumns().length ) { 
            data[desty][columns[destx].field] = clippeds[y][x];
        if ( data[desty].hasOwnProperty('id')) 
          changedIds.push(data[desty].id);// record changed id used by saving function
      }
    }
  }

  _grid.invalidate();
}

function handleKeyDown(e, args) {
  var ranges;
  if (!_grid.getEditorLock().isActive() || _grid.getOptions().autoEdit) {
    if (e.which == keyCodes.ESC) {
      if (_copiedRanges) {
        e.preventDefault();
        clearCopySelection();
        _self.onCopyCancelled.notify({ranges: _copiedRanges});
        _copiedRanges = null;
      }
    }

    if (e.which == keyCodes.C && (e.ctrlKey || e.metaKey)) {    // CTRL + C
      ranges = _grid.getSelectionModel().getSelectedRanges();
  if (ranges.length != 0) {
        _copiedRanges = ranges;
        markCopySelection(ranges);
        _self.onCopyCells.notify({ranges: ranges});

        var columns = _grid.getColumns();
        var clipText = "";
    for (var rg = 0; rg < ranges.length; rg++){
            var range = ranges[rg];

    var clipTextRows = [];
    if (clipText == "" && _options.includeHeaderWhenCopying) {
        var clipTextHeaders = [];
        for (var j = range.fromCell; j < range.toCell + 1 ; j++) {
            if (columns[j].name.length > 0)
                clipTextHeaders.push(columns[j].name);
        }
        clipTextRows.push(clipTextHeaders.join("\t"));
    }

            for (var i=range.fromRow; i< range.toRow+1 ; i++){
                var clipTextCells = [];
                var dt = _grid.getDataItem(i);

                for (var j=range.fromCell; j< range.toCell+1 ; j++){
                    clipTextCells.push(getDataItemValueForColumn(dt, columns[j]));
                }
                clipTextRows.push(clipTextCells.join("\t"));
            }
            clipText += clipTextRows.join("\r\n") + "\r\n";
        }
        var ta = _createTextBox(clipText);
        return false;
      }
    }
  }
}

function markCopySelection(ranges) {
  var columns = _grid.getColumns();
  var hash = {};
  for (var i = 0; i < ranges.length; i++) {
    for (var j = ranges[i].fromRow; j <= ranges[i].toRow; j++) {
      hash[j] = {};
      for (var k = ranges[i].fromCell; k <= ranges[i].toCell; k++) {
        // hash[j][columns[k].id] = true;
    // Применяем стиль для скопированных ячеек
    hash[j][columns[k].id] = _copiedCellStyle;
      }
    }
  }
  _grid.setCellCssStyles(_copiedCellStyle, hash);
  clearTimeout(_clearCopyTI);
  _clearCopyTI = setTimeout(function(){
    _self.clearCopySelection();
  }, 400);
}

function clearCopySelection() {
  _grid.removeCellCssStyles(_copiedCellStyle);
}

$.extend(this, {
  "init": init,
  "destroy": destroy,
  "clearCopySelection": clearCopySelection,

  "onCopyCells": new Slick.Event(),
  "onCopyCancelled": new Slick.Event(),
  "onPasteCells": new Slick.Event()
});
}
})(jQuery); 
```

# java - 在单个事务中更新表的同一行时获取“org.hibernate.StaleObjectStateException”

> ID：12133906
> 
> 赞同：1
> 
> 时间：2012-08-26T21:05:16.257
> 
> 标签：java, hibernate

我有一个名为 Employee 的表，它有一个复杂的主键，即它的 3 个列的组合

```
firstName : String
SecondName : String
bossId : foreingKey of other table named Boss ( auto generated database sequence) 
```

这是我的代码：

```
@Entity
@Table(name = "Employee")
@org.hibernate.annotations.Entity(optimisticLock = OptimisticLockType.ALL, dynamicUpdate = true)
public class Employee {

private EmployeePk employeePk;  

private int age;
private String status;

@EmbeddedId
public EmployeePk getEmployeePk() {
    return employeePk;
}
public void setEmployeePk(EmployeePk employeePk) {
    this.employeePk = employeePk;
}

@Override
public boolean equals(Object o) {
    if (this == o) return true;
    if (o == null ||
            !(o instanceof Employee)) {

        return false;
    }

    Employee other
    = (Employee)o;

    // if the id is missing, return false
    if (getEmployeePk() == null) return false;

    if( getEmployeePk().equals(other.getEmployeePk())) {            
        return true;
    } else {
        return false;
    }

}

@Override
public int hashCode() {
    if (getEmployeePk() != null) {
        return getEmployeePk().hashCode();
    } else {
        return super.hashCode();
    }
} 
```

}

```
@Embeddable
public class EmployeePk implements Serializable{

private static final long serialVersionUID = -7827123517392541880L;
private String firstName;
private String secondName;
private Boss boss;

@ManyToOne
@JoinColumn(name = "boss_id",insertable= false, updatable= false)
public Boss getBoss() {
    return boss;
}
public void setBoss(
        Boss boss) {
    this.boss = boss;
}

/* setters and getters of all with @column annotation */

@Override  
public boolean equals(Object obj) {  
    if (this == obj) {  
        return true;  
    }  
    if (!(obj instanceof EmployeePk)) {  
        return false;  
    }  

    EmployeePk other = (EmployeePk) obj;  

    if( getfirstname() != null && 
            getFirstName().equals(other.getFirstName()) &&
            getSecondName() !=null && 
            getSecondName().equals(other.getSecondName()) &&
            getBoss() != null &&
            getBoss().getId() == other.getBoss().getId())
        return true;

    return false;  
}  

@Override
public int hashCode() {
    if (getFirstName() != null &&
            getSecondName() != null && 
            getBoss() != null) {
        return getFirstName().hashCode() + 
                getSecondName().hashCode();
    } else {
        return super.hashCode();
    }
} 
```

}

现在，一切运行良好，我可以在 Employee 表中创建/更新/删除数据库行。

但是当我试图在一个事务中更新相同的行时，我得到了这个异常：

```
org.hibernate.event.def.AbstractFlushingEventLis
tener: Could not synchronize database state with session
org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect):
    at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1792)
    at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2435)
    at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2335)
    at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2635)
    at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:115)
    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:168)
    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
    at org.hibernate.event.def.DefaultAutoFlushEventListener.onAutoFlush(DefaultAutoFlushEventListener.java:64)
    at org.hibernate.impl.SessionImpl.autoFlushIfRequired(SessionImpl.java:996)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1141)
    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)
    at org.hibernate.impl.AbstractQueryImpl.uniqueResult(AbstractQueryImpl.java:835) 
```

我在另一个名为 Contractor 的表中遇到了类似的问题，但能够通过覆盖其 equals 和 hashCode 方法来解决这个问题。

问题是在那个表中只有一个名为“id”的主键，它是一个数据库自动生成的序列，因此没有那里的概念`EmbeddedId`。

我不确定我在哪里出错了。我花了几天时间来解决这个问题，并关注了几个链接，例如： http: [//onjava.com/pub/a/onjava/2006/09/13/dont-let-hibernate-steal-your-identity.html?页=1](http://onjava.com/pub/a/onjava/2006/09/13/dont-let-hibernate-steal-your-identity.html?page=1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:48:09.840

几个想法：

1) 使用optimisticLock = OptimisticLockType.ALL 让我怀疑。我自己从来没有使用过这个，但我怀疑它可能与你的错误有关。

2) 我认为 equals 方法不能处理任何属性为空的情况。即使两个实例相同，它也将始终返回 false。

3) Hibernate 真的更喜欢使用专用的 id（和版本，如果需要）列而不是自然键。根据我的经验，对复合/自然键的支持似乎很麻烦且有问题。

# objective-c - Objective-C 块，递归失败

> ID：12133907
> 
> 赞同：7
> 
> 时间：2012-08-26T21:05:23.133
> 
> 标签：objective-c, ios, closures, objective-c-blocks, block

伙计们，

我正在尝试做一个调用自身的函数，但将所有内容放在一个块上，

如您所见，以下函数旨在被无限次调用（直到 arcrandom 返回小于 50 的数字），并且您应该期望输出可变数量的“RUNNING”消息，具体取决于机会。

```
void (^_test_closure)(void) = ^ {
    NSLog(@"RUNNING");
    if(arc4random() % 100 > 50) {
        _test_closure();
    }
};

_test_closure(); 
```

但是，在运行它时，我得到一个 EXC_BAD_ACCESS 错误，我发现的原因是当代码尝试在闭包内调用 _test_closure 时，它​​基本上没有指向任何地方。

有谁知道如何使上述代码工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-26T21:12:33.803

您必须将块本身声明为块变量：

```
__block void (^_test_closure)();

_test_closure = ^{
    NSLog(@"Running...");
    if ((arc4random() % 100) > 50) {
        _test_closure();
    }
}

_test_closure(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-26T21:16:27.720

递归和块是棘手的。因为一个块捕获了所有传入的变量，所以变量`_test_closure`还没有初始化（并且clang应该给你一个警告：

> 块指针变量“_test_closure”在被块捕获时未初始化

）。

有几种方法可以解决这个问题，但最明显和最简单的是将块本身设为`__block`变量（@H2CO3 所说的）。这样就可以让块`weak-linked`差不多了，这样当你再次调用它的时候，它就被正确地初始化了。

您可以选择的另一个选项是将块设为全局或静态，如下所示：

```
// outside of 'main', thus being a global variable
void (^blockRecurse)(int) = ^(int level) {
    if (level < 0)
        return;
    NSLog(@"Level: %i", level);
    blockRecurse(--level);
};

int main()
{
    @autoreleasepool {
        blockRecurse(10);
    }
} 
```

这意味着它不会被块捕获，而是引用全局/静态变量，所有代码都可以平等地更改该变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-13T11:25:27.473

它适用于 XCode 5 - 没有警告，没有保留周期：

```
typedef void(^blockT)();

blockT block1;
blockT __block block1recursive;

block1recursive = block1 = ^(){
    block1recursive();
};

block1(); 
```

# mysql - 自动字段重置 MYSQL

> ID：12133910
> 
> 赞同：0
> 
> 时间：2012-08-26T21:06:11.730
> 
> 标签：mysql, sql

我需要自动重置表中的字段。

我有一个名为`USER`和 fields的数据库表`ID`，`NAME`并且`LIMIT`. 每个月我都需要自动将字段中的值重置`LIMIT`为 0。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T21:10:49.547

[MySQL Event Scheduler](http://dev.mysql.com/doc/refman/5.1/en/events.html)可能是答案。

# mysql - 如何转储 MySQL 列的子集？

> ID：12133921
> 
> 赞同：2
> 
> 时间：2012-08-26T21:07:44.113
> 
> 标签：mysql, mysqldump

我知道 mysqldump 的“--where”子句允许转储表行的选定子集，但是有没有办法只转储 MySQL 表列的子集？到目前为止，最好的解决方案似乎是将表作为一个整体转储，然后从该表执行 SELECT/INSERT 到具有我想要的列子集的新表，如下所述：

[如何在重命名某些表/列而不导入其他表/列时导入 mysql 转储？](https://stackoverflow.com/questions/3326581/how-to-import-a-mysql-dump-while-renaming-some-tables-columns-and-not-importing)

# c++ - 布尔后缀表示法

> ID：12133922
> 
> 赞同：0
> 
> 时间：2012-08-26T21:07:51.357
> 
> 标签：c++, c, math, abstract-data-type

我必须编写一个 ADT 字符堆栈来处理布尔值的后缀表示法。

这是后缀符号之一的示例。

TT && F || ！（这将是输入文本）

我知道这评估为假。

我的问题是。

这个符号最终在代码中看起来像什么。（一旦输入字符串被解析）

我的猜测是：

```
if ( !( true && true || false) )
    //do something;
else
    //do something else 
```

我很确定这是错误的，而且我离题了，我尝试了各种组合。我不能让它返回假。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T21:19:18.440

您通常以堆栈方式解释 RPN，二元运算符从堆栈中弹出两个参数和一元参数。

1.  `T T`— 将两个*真*值压入堆栈，堆栈为：`T T`,
2.  `&&`— 弹出两个值，push*和*: `T && T`，堆栈是: `T`,
3.  `F`— 将*false*压入堆栈，堆栈为：`T F`,
4.  `||`— 弹出两个值，push*或*: `T || F`，堆栈是: `T`,
5.  `!`— 弹出一个值，推送否定版本：`!T`，堆栈为：`F`。

所以你的最终结果是这些操作的结果（从下到上写）：

```
bool result = !(false || (true && true)); 
```

* * *

您只需要从头开始阅读即可；首先转换为前缀表示法（从下到上）可能会更容易一些：

```
! ( || ( F && ( T T ) ) ) 
```

然后你只需移动括号内的二元运算符：

```
! ( || ( F && ( T    T ) ) )
     -----> ----->
! (      F || ( T && T ) ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T21:17:45.360

您的主要问题应该是因为您返回的结果与`if`条件评估的相反（请参阅 ablm 评论）。但一般来说，您应该将每个评估的表达式括在括号中以确保正确的结果：

```
return !((true && true) || false); 
```

这样，即使您的目标语言 (C/C++) 中运算符的优先级与预期的计算顺序不同，表达式仍将按照您的意愿进行计算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T21:16:07.443

```
if ( !( true && true || false) ) <-- this is false
    return false; <-- this evaluates if expression inside if is true, which is not
else
    return true; <--- if expression inside if is false then this(true) is returned. 
```

因此，对于正确的返回类型，您需要交换返回。

```
if ( !( true && true || false) )
    return true;
else
    return false; 
```

# spring - Spring 安全特性

> ID：12133923
> 
> 赞同：0
> 
> 时间：2012-08-26T21:07:53.520
> 
> 标签：spring, security, jakarta-ee

Spring 提供了哪些 Java EE 规范尚未提供的安全特性？

在 Java EE 规范中，我们有：

1.  web.xml 中的一系列 sevlet 安全选项。大多数人会配置基本或基于表单的身份验证。他们将 Java EE 应用程序链接到 LDAP 服务器——存储用户/组。请求将被加密并通过 HTTPS 进入。
2.  可以注释任何 EJB 并且只允许某些角色执行某些方法
3.  能够以编程方式在运行时检查用户原则

那么 Spring 3.0 为我提供了哪些安全附加功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T09:23:19.387

即使您只需要一些相当简单的身份验证，Spring Security 也提供了对许多简单但有用的功能的支持（想想注销后的重定向，在所有 URL 上重定向到登录页面，记住我）。使用 Java EE，您最终将自己编写此代码，并且 - 可能 - 搞砸了，因此您将拥有一个不安全的应用程序。

Spring Security 适用于许多标准/协议/等。开箱即用（LDAP、JAAS、X.509）。还有更高级的东西，比如 SSO 或 ACL。如果标准功能不适合您，您可以相当轻松地自定义它，通常只需要一点代码。

我还喜欢它是相当非侵入性的，您的控制器/动作/...类通常不必参与。

也就是说，如果您是第一次使用它，则需要一些时间来设置 Spring Security 并习惯它。

（最后，这是他们自己的功能列表：[http](http://static.springsource.org/spring-security/site/features.html) ://static.springsource.org/spring-security/site/features.html ）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T06:47:37.357

一个杀手级功能是 ACL！

@参见：Spring Security Reference [Chapter 17\. Domain Object Security (ACLs)](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/domain-acls.html)

* * *

而且我感觉 Spring Security 更容易定制。例如，如果您需要一个用户管理，用户可以在此电子邮件地址得到确认后自行注册并获得一些有限的权限和其他一些权限。

# windows - 如何使用 Win32::TieRegistry 编辑密钥？

> ID：12133924
> 
> 赞同：1
> 
> 时间：2012-08-26T21:08:09.953
> 
> 标签：windows, perl, registry, key

我正在使用 Perl 编写脚本，但遇到了以下问题：我必须编辑 Windows 注册表中的键名。

我正在使用模块[Win32::TieRegistry](http://search.cpan.org/perldoc?Win32%3a%3aTieRegistry)并在文档中搜索任何功能，但没有找到。我知道这应该很容易，但找不到这样做的方法。任何提示？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T21:15:57.270

您不能更改散列中键的名称，但可以将值复制到新键并删除旧键。

```
$hash{new} = delete $hash{old}; 
```

假设实现是健全的，这对于绑定哈希应该是一样的。

# algorithm - 如何使用“指针数组”间接将 2D 矩阵条目映射到 1D 数组？

> ID：12133928
> 
> 赞同：1
> 
> 时间：2012-08-26T21:09:15.203
> 
> 标签：algorithm, sparse-matrix, adjacency-matrix

**[注意：我已经根据Keith Randall](https://stackoverflow.com/users/180090/keith-randall)和[Chiyou](https://stackoverflow.com/users/340457/chiyou)的有用反馈编辑了这个问题。**

我有一个想法，使用 1D 数组在特定处理上下文中缓存最常用的 2D NxM 矩阵条目。问题是，是否已经有大量的工作可以从中获得洞察力，或者是否只有*知道的*人。我将首先概述腿部工作，然后再提出问题。作为补充说明，[Chiyou](https://stackoverflow.com/users/340457/chiyou)已经提出了[空间填充曲线](http://en.wikipedia.org/wiki/Space-filling_curve)，它在概念上看起来是我所追求的东西，但不会轻易回答我的具体问题（即我找不到可以做我所追求的曲线） .

**腿部工作：** 目前*最常用的条目*被定义为循环和特殊的组合`pointer_array`（见下面的代码），它们组合产生最常用矩阵元素的索引。pointer_array 包含[范围](http://en.wikipedia.org/wiki/Interval_%28mathematics%29#Excluding_the_endpoints) **[0, max(N, M)]**中的数字（参见上面定义为 NxM 的矩阵维度）。

代码的目的是产生一个合适的（在程序的上下文中）索引组合来处理一些矩阵条目。有可能N = M，即方阵。遍历矩阵的代码 (C++) 如下所示

```
for(int i = 0; i < N; i++)
{        
    for(int j = i + 1; j < M; j++)
    {
        auto pointer1 = pointer_array[i];
        auto pointer2 = pointer_array[i + 1];
        auto pointer3 = pointer_array[j];
        auto pointer4 = pointer_array[j + 1];

        auto entry1 = some_matrix[pointer1][pointer3];
        auto entry2 = some_matrix[pointer2][pointer4];
        auto entry3 = some_matrix[pointer3][pointer4];
        auto entry4 = some_matrix[pointer1][pointer2];

        //Computing with the entries...
    }
} 
```

一些值得单独注意的事情：

1.  为了使这种缓存有价值，我认为它应该是密集的。也就是说，可以随机访问并在内存中连续布局的东西。即没有空间“浪费”（除非有许多单独的块）并且复杂性在 O(1) 中。这意味着缓存不能是与 1D 行/​​列主要有序数组完全排序的相同 2D 矩阵。**我觉得它应该适合长度为max(N, M)**的数组（参见上面的矩阵维度定义）。

2.  `some_matrix`在循环期间将忽略其中的许多条目。

3.  pointer_array 排序记录*了通过矩阵的路线*，因此它也用于其他地方。

4.  我在各种场合都遇到过这种需求，但这次我编写了一个[2-opt](http://en.wikipedia.org/wiki/2-opt)算法，我正在寻求改进它的内存访问模式。我知道还有其他方法可以编写算法（但请参阅我遇到的其他设置，现在想知道是否有通用解决方案）。

5.  跳出框框的想法是产生一种类似的索引组合，在概念上类似于访问 2D 矩阵，但更智能。一种选择是在循环期间缓存矩阵行/列。

6.  由于条目将被大量使用，因此`pointer_array`通过缓存 some_matrix 调用来替换间接会更理想，这样获取`entry*`循环中的值会更快，即从预加载的缓存而不是可能相当大的矩阵。这里的另一点是它会节省存储空间，这反过来意味着经常使用的值可以很好地适应更快的缓存。

**问题：**是否可以设计一种索引方案，使矩阵索引本质上变成

```
//Load the 2D matrix entries to some_1d_cache using the pointer_array
//so that the loop indices can be used directly...

for (int i = 0; i < N; i++)
{        
    for (int j = i + 1; j < M; j++)
    {           
        //The some_1d_cache((x, y) call will calculate an index to the 1D cache array...
        auto entry1 = some_1d_cache(i, j);
        auto entry2 = some_1d_cache(i + 1, j + 1);
        auto entry3 = some_1d_cache(j, j + 1);
        auto entry4 = some_1d_cache(i, i + 1);

        //Computing with the entries...
    }
} 
```

或者也许像下面这样的东西也可以

```
for (int i = 0; i < N; i++)
{        
    for (int j = i + 1; j < M; j++)
    {            
        auto pointer1 = pointer_array[i];
        auto pointer2 = pointer_array[i + 1];
        auto pointer3 = pointer_array[j];
        auto pointer4 = pointer_array[j + 1];

        //The some_1d_cache((x, y) call will calculate an index to the 1D cache array...
        auto entry1 = some_1d_cache(pointer1, pointer3);
        auto entry2 = some_1d_cache(pointer2, pointer4);
        auto entry3 = some_1d_cache(pointer3, pointer4);
        auto entry4 = some_1d_cache(pointer1, pointer2);

        //Computing with the entries...
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T00:06:01.187

您可以索引具有 1d 空间填充曲线的 2d 矩阵。数学上它是 H(x,y) = (h(x) * h(y))。它们也很有用，因为它们基本上可以细分、存储一些位置信息并重新排列平面。

# haskell - 数字作为乘法函数（奇怪但有趣）

> ID：12133932
> 
> 赞同：17
> 
> 时间：2012-08-26T21:10:21.307
> 
> 标签：haskell

[在Haskell 中的默认功能组合](https://stackoverflow.com/questions/12061176/tacit-function-composition-in-haskell)问题的评论中，人们提到为 制作一个`Num`实例`a -> r`，所以我想我会尝试使用函数符号来表示乘法：

```
{-# LANGUAGE TypeFamilies #-}
import Control.Applicative

instance Show (a->r) where   -- not needed in recent GHC versions
  show f = " a function "

instance Eq (a->r) where     -- not needed in recent GHC versions
  f == g = error "sorry, Haskell, I lied, I can't really compare functions for equality"

instance (Num r,a~r) => Num (a -> r) where
  (+) = liftA2 (+)
  (-) = liftA2 (-)
  (*) = liftA2 (*)
  abs = liftA abs
  negate = liftA negate
  signum = liftA signum
  fromInteger a = (fromInteger a *) 
```

请注意，fromInteger 定义意味着我可以写出`3 4`12 和`7 (2+8)`70 的值，正如您所希望的那样。

然后一切都变得奇妙，有趣而奇怪！如果可以的话，请解释这种奇怪：

```
*Main> 1 2 3
18
*Main> 1 2 4
32
*Main> 1 2 5
50
*Main> 2 2 3
36
*Main> 2 2 4
64
*Main> 2 2 5
100
*Main> (2 3) (5 2)
600 
```

[编辑：使用 Applicative 而不是 Monad，因为 Applicative 通常很棒，但它对代码没有太大影响。]

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-26T21:45:46.123

`2 3 4`在与您的实例类似的表达式中，两者`2`和`3`都是函数。`2`实际上也是如此，`(2 *)`并且有一个 type `Num a => a -> a`。`3`是一样的。`2 3`是 那么`(2 *) (3 *)`与 相同`2 * (3 *)`。以您为例，这`liftM2 (*) 2 (3 *)` 是 then `liftM2 (*) (2 *) (3 *)`。现在这个表达式可以在没有任何实例的情况下工作。

那么这是什么意思？好吧，`liftM2`因为函数是一种双重组合。特别`liftM2 f g h`是，与 相同`\ x -> f (g x) (h x)`。那么`liftM2 (*) (2 *) (3 *)`也是如此`\ x -> (*) ((2 *) x) ((3 *) x)`。稍微简化一下，我们得到：`\ x -> (2 * x) * (3 * x)`. 所以现在我们知道这`2 3 4`实际上是`(2 * 4) * (3 * 4)`.

那么，为什么`liftM2`for 函数会这样工作呢？让我们看一下 monad 实例`(->) r`（请记住，`(->) r`但`(r ->)`我们不能编写类型级运算符部分）：

```
instance Monad ((->) r) where  
    return x = \_ -> x  
    h >>= f = \w -> f (h w) w 
```

`return`也是如此`const`。`>>=`有点奇怪。我认为从`join`. 对于函数，`join`工作方式如下：

```
join f = \ x -> f x x 
```

也就是说，它接受两个参数的函数，并通过使用该参数两次将其转换为一个参数的函数。很简单。这个定义也是有道理的。对于函数，`join`必须将两个参数的函数变成一个函数；唯一合理的方法是使用该参数两次。

`>>=``fmap`紧随其后的是`join`。对于函数，`fmap`只是`(.)`. 所以现在`>>=`等于：

```
h >>= f = join (f . h) 
```

这只是：

```
h >>= f = \ x -> (f . h) x x 
```

现在我们只是摆脱`.`得到：

```
h >>= f = \ x -> f (h x) x 
```

所以现在我们知道了如何`>>=`工作，我们可以看看`liftM2`. `liftM2`定义如下：

```
liftM2 f a b = a >>= \ a' -> b >>= \ b' -> return (f a' b') 
```

我们可以简单的一点一点。首先，`return (f a' b')`变成`\ _ -> f a' b'`. 结合`\ b' ->`，我们得到：`\ b' _ -> f a' b'`。然后`b >>= \ b' _ -> f a' b'`变成：

```
 \ x -> (\ b' _ -> f a' b') (b x) x 
```

由于第二个`x`被忽略，我们得到：`\ x -> (\ b' -> f a' b') (b x)`然后减少到`\ x -> f a' (b x)`. 所以这给我们留下了：

```
a >>= \ a' -> \ x -> f a' (b x) 
```

同样，我们替换`>>=`：

```
\ y -> (\ a' x -> f a' (b x)) (a y) y 
```

这减少到：

```
 \ y -> f (a y) (b y) 
```

这正是我们`liftM2`之前使用的！

希望现在的行为`2 3 4`完全有意义。

# ruby-on-rails - 如何在仍然利用缓存的同时覆盖 ActiveRecord 关联方法？

> ID：12133933
> 
> 赞同：1
> 
> 时间：2012-08-26T21:10:37.637
> 
> 标签：ruby-on-rails, ruby

我想在某些情况下覆盖 ActiveRecord 的关联方法（与缓存间接`belongs_to`关系的外键有关。一个典型的例子是 a `QuoteStop`has a`Stop`和 a `Stop`has a`PostalCode`我也想`postal_code_id`在`QuoteStop`级别缓存。

对于这个例子，我想添加如下内容：

```
class QuoteStop
  attr_accessible :stop_id, :postal_code_id
  belongs_to :stop
  belongs_to :postal_code

  def postal_code_id
    self[:postal_code_id] or postal_code_id!
  end

  def postal_code_id!
    self.postal_code_id = stop.postal_code_id
  end

  def postal_code
    self[:postal_code_id] ? super : PostalCode.find(postal_code_id) if postal_code_id
  end

end

class Stop
  attr_accessible :postal_code_id
end 
```

问题是这似乎绕过了`postal_code`. 例如，以下将产生 n+1 个查询，而它应该只产生 2 个。

```
QuoteStop.includes(:postal_code).limit(n).collect { |qs| qs.postal_code.name } 
```

如何在不牺牲 ActiveRecord 缓存的性能增益的情况下使用此技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T22:34:10.607

我不确定您的代码是否正确，并且您的代码不会缓存任何内容。我会这样写：

```
def postal_code_id 
  @postal_code_id ||= stop.postal_code_id
end

def postal_code
  if self.postal_code_id
    @cached_postal_code ||= PostalCode.find(self.postal_code_id)
  else
    super
  end
end 
```

但我不确定这是否会有很大的改进。因为做 和做`PostalCode.find`完全一样`stop.postal_code`。

那么你认为缓存`postal_code_id`会如何改进缓存呢？除非您按照身份映射的思路进行思考：每个映射`PostalCode`只检索一次。但是，您需要在班级级别上做一些更详细的事情。因为`QuoteStop`它本身（实例）上的 any 永远不会知道`PostalCode`之前检索到的 a 。

希望这可以帮助。

# android - Android：按钮到新屏幕并显示 sql 数据

> ID：12133934
> 
> 赞同：1
> 
> 时间：2012-08-26T21:10:44.040
> 
> 标签：android, sql, android-activity, screen

我正在做一个项目。我有很多单词文本数据，不想为每个数据添加布局和类。我想使用 sqlite，但不知道如何。比如有一个按钮，id是cat。

单击猫按钮时，将打开一个新屏幕并显示猫的信息。一种布局，一种课程，但有很多屏幕。数据必须来自sql，因为动物太多。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:27:20.397

您自己已经给出了答案：SQL 数据库可能是您的朋友。自己完成[本教程](http://www.vogella.com/articles/AndroidSQLite/article.html)，看看它能给你带来多远。您必须从代码中操作 UI，这也是可行的。

您可能要考虑的另一种方法是将 XML 中的所有内容放入 strings.xml 文件中。这在一定程度上取决于数据的大小和结构。从代码中，您可以使用`getString( R.id.blah )`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T21:30:45.613

调用其他屏幕传递值。在按钮中单击执行：

```
startActivity(new Intent(this, SecondScreen.class).putExtra('Identify', 'Value')); 
```

在第二个屏幕中执行：

```
String value = getIntent().getStringExtra('Identify'); 
```

现在，获取该值并在 SqlLite 中进行查询并显示结果。

# ant - 如何从工作区外部在 Jenkins 中设置 ANT_PATH？

> ID：12133937
> 
> 赞同：0
> 
> 时间：2012-08-26T21:10:54.273
> 
> 标签：ant, mercurial, jenkins

我的文件结构包含带有项目源代码的 src/ 文件夹，这个文件夹是我想要在 jenkins 工作区中拥有的文件夹。

但是，我也有 apache ant 所需的 build 文件夹，它会随着每个“ant”命令的执行而改变。问题是这个文件夹的重量超过 200mb。每次运行“ant”命令时，我都不想最终将其推送到存储库。

如果阅读它的人对此有一些经验 - 最好的方法是什么？是否可以从 repo 中提取 src/ 文件夹，并从系统中提取 build/ 文件夹？但我想这是错误的，因为只有这样我才能执行 ant 命令......

设置它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T00:50:20.330

嗯？您放入`build`文件`.hgignore`，然后您将不会提交该目录或其中的内容。这是通常的设置，但也许我错过了你问题的一些细微差别。

# .htaccess - 使用 .htaccess 在内部将域重定向到子域

> ID：12133938
> 
> 赞同：1
> 
> 时间：2012-08-26T21:10:55.827
> 
> 标签：.htaccess

我想在内部将域 redacted.org 重定向到 redacted.redacted.org。因此，当人们访问 redacted.org 时，他们会看到 redacted.redacted.org 而没有在地址栏中更改地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:20:33.303

这个`.htaccess`文件应该放在 redacted.org 的根目录下：

```
RewriteEngine On
RewriteRule (.*) /path/to/redacted.redacted.org 
```

PS。看到有关该问题的评论，我不是唯一一个想知道您在发布之前为解决问题所做的尝试。

# string - 仅使用指定值 PHP 清理字符串？

> ID：12133945
> 
> 赞同：-1
> 
> 时间：2012-08-26T21:12:23.860
> 
> 标签：string, preg-replace, preg-match, str-replace

我在 PHP 中有这个

```
$string="Thisissomekindofstringiwantthislolipop"; 
```

我想要这样的新字符串

```
$string="iwantthis"; 
```

但我有更多类似的字符串

```
$string1="Thisissomekindofstrigqqqqqqqqqkokiki"; 
```

和新的字符串

```
 $string1="qqqqqqqqq"; 
```

开始时字母的值总是相同的，我总是需要具有相同字母数的新字符串，可以这样做吗？

提前 Txanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:44:10.773

如果你想剪切字符串，你应该看看[substr](http://php.net/manual/en/function.substr.php)。然后，您可以剪切不需要的部分：

```
<?php
$string="Thisissomekindofstringiwantthislolipop";
echo substr($string, 22, 9); // returns 'iwantthis'
?> 
```

由于您的评论而更新：

您还可以通过分隔符拆分字符串（此处：使用[explode](http://php.net/manual/en/function.explode.php)）。例如

```
<?php
$string = "vimeo.com/24076588";
$parts = explode("/", $string);
echo $parts[1]; // prints 24076588
?> 
```

甚至更好。[只需使用preg_match_all](http://php.net/manual/en/function.preg-match-all.php)使用正则表达式从 URL 中提取数字 id ：

```
<?php
$string = "http://vimeo.com/24076588";
preg_match_all('/[\d]+/i',$string, $result); 
print_r($result);  
?> 
```

这打印出来

```
Array
(
    [0] => Array
        (
            [0] => 24076588
        )

) 
```

# php - 获取数组的索引

> ID：12133948
> 
> 赞同：0
> 
> 时间：2012-08-26T21:12:42.143
> 
> 标签：php

我在从多维数组中检索数据时遇到了一些问题。我有这样的事情：

```
$Act[0] = array(
"Number" => 23,
"Local" => "woods",
"props" => "swords..."
.....

$Act[1] = array(
"Number" => 27,
"Local" => "castle",
"props" => "swords..."
.....
......

$Story[$day] = array(
                  "Date" => $SDate,
                  "Acts" => $Acts
                  ); 
```

我想要做的是从 Act 数组中获取所有数字并使用 implode 将其存储在 mysql db 中。我试过 array_keys 但它不适用于多维数组。我不知道它是否适合这个。所以基本上我想要一个包含 $Story[1]["Acts"] 的所有“Number”值的数组，所以它必须经过：

```
$Story[1]["Act"][0]["Number"]
$Story[1]["Act"][1]["Number"]
$Story[1]["Act"][2]["Number"]
... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T21:18:13.527

所以...

```
$numbers = array_map(function($act) {
    return $act["Number"];
}, $Story[1]["Acts"]);

# 23, 27, ... 
```

你问的是这个吗？

# c++ - 在 C++ 中创建 boost dynamic_bitset 的向量

> ID：12133950
> 
> 赞同：6
> 
> 时间：2012-07-06T23:32:46.090
> 
> 标签：c++, boost

我想创建一个dynamic_bitsets 数组。所以我创建了一个 dynamic_bitset 的向量，

`vector<boost::dynamic_bitset<>> v;`

如何指定每个动态位集的大小，即 v[0]、v[1] 等？就像在一般情况下，我们通过构造函数指定大小。

```
boost::dynamic_bitset<> x(3); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T23:57:49.163

这条线

```
vector<boost::dynamic_bitset<>> v; 
```

创建一个空向量。相反，您可以要求它填充所有具有相同值的默认条目，所以就像通常一样

```
vector<int> v(N, 1); 
```

创建一个包含`N`所有条目的向量 1 你可以做

```
vector<boost::dynamic_bitset<>> v( N, boost::dynamic_bitset<>(3) ) ; 
```

让它包含`N` `boost::dynamic_bitset<>`s 和 3 位。

如果您的向量包含足够的元素，您应该能够将其设置`v[i]`为不同的大小

```
v[i] = boost::dynamic_bitset<>( 100 ) ; 
```

或者，您可以像现在一样创建一个空向量，然后使用类似`v.push_back(boost::dynamic_bitset<>(42))`添加正确大小的元素。

# java - JPA 延迟初始化异常？

> ID：12133955
> 
> 赞同：0
> 
> 时间：2012-08-03T10:18:46.533
> 
> 标签：java, hibernate, jpa, lazy-initialization

我将 jQuery 用于 UI，将 Struts2 用作操作，将 JPA 用于数据访问层。

我面临的问题是`LazyInitializationException`当我尝试从数据库中检索值时遇到的问题。我得到下面的堆栈跟踪：

`org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.singpost.ctf.core.persistence.CtfTxn.ctfTxnAttribs, no session or session was closed`

默认情况下`Fetch="LAZY"`，代码工作正常。但是当我将`Fetch`类型更改为 时`EAGER`，我不知道我还需要做什么。我被困在中间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T10:36:05.523

如错误消息所述，当您尝试访问该集合时，休眠会话已关闭。解决方案是确保会话仍然打开（如果您使用 JTA，则在事务提交时会话将关闭），或者不使用延迟加载（正如您所发现的那样）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-12-18T21:35:06.207

`I don't know what I have to do further.`

我扩展了 Zareth 的答案，因为这是一个常见问题。

要做的一件事是理解，当`fetch=FetchType.LAZY`在 的映射上声明时`ctfTxnAttribs`，JPA 将加载代理对象的集合：每个对象看起来都是一个`ctfTxnAttrib`，但只是一个代理。

这似乎一切正常，直到您的网页或 bean 尝试访问该集合中的对象。然后你会得到，`lazyInitializationException`因为持久性提供者只找到代理。

正如 Zareth 指出的那样，您需要一个开放的持久性会话，以使用`ctfTxnAttrib`.

有多种方法可以实现这一点，这里有一篇关于该主题的非常好的文章，包括设计模式，`Open Session In View`：

[http://www.javacodegeeks.com/2012/07/four-solutions-to-lazyinitializationexc_05.html](http://www.javacodegeeks.com/2012/07/four-solutions-to-lazyinitializationexc_05.html)

# android - 如何在不指定颜色名称或资源 ID (R.color.name) 的情况下访问 colors.xml

> ID：12133960
> 
> 赞同：5
> 
> 时间：2012-08-26T21:14:17.143
> 
> 标签：android, xml, colors

包含颜色名称和十六进制代码的 XML 文件可供 Android 程序员使用，例如：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
 <color name="White">#FFFFFF</color>
 <color name="Ivory">#FFFFF0</color>
 ...
 <color name="DarkBlue">#00008B</color>
 <color name="Navy">#000080</color>
 <color name="Black">#000000</color>
</resources> 
```

我可以使用以下语法访问特定颜色：

```
TextView area1 = (TextView) findViewById(R.id.area);
area1.setBackgroundColor(Color.parseColor(getString(R.color.Navy))); 
```

或者

```
 area1.setBackgroundColor(Color.parseColor("Navy")); 
```

或者

```
Resources res = getResources();  
int rcol = res.getColor(R.color.Navy);  
area1.setBackgroundColor(rcol); 
```

如何将整个 xml 文件中的颜色读入颜色名称的 String[] 和颜色资源的 int[]（例如，R.color.Navy），而无需指定每个颜色名称或资源 ID？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T21:43:41.367

使用反射 API 非常简单（不久前我在 drawable-ids 上遇到过类似的问题），但是很多更有经验的用户说，“dalvik 上的反射真的很慢”，所以请注意！

```
//Get all the declared fields (data-members):
Field [] fields = R.color.class.getDeclaredFields();

//Create arrays for color names and values
String [] names = new String[fields.length];
int [] colors = new int [fields.length];

//iterate on the fields array, and get the needed values: 
try {
    for(int i=0; i<fields.length; i++) {
        names [i] = fields[i].getName();
        colors [i] = fields[i].getInt(null);
    }
} catch (Exception ex) { 
    /* handle exception if you want to */ 
} 
```

然后，如果你有这些数组，那么你可以从它们创建一个 Map 以便于访问：

```
Map<String, Integer> colors = new HashMap<String, Integer>();

for(int i=0; i<hexColors.length; i++) {
    colors.put(colorNames[i], hexColors[i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T21:42:24.860

我认为您必须将 color.xml 文件移动到 /asset 目录中。您将不得不“手动”解析 XML，并且无法使用 R.color.* 语法。（除非您选择复制文件）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T21:47:12.007

您可以使用自省`R.colors`来找出所有字段名称和相关值。

`R.colors.getClass().getFields()`会给你所有颜色的列表。

在每个字段上使用`getName()`将为您提供所有颜色名称的列表，并`getInt()`为您提供每种颜色的值。

# asp.net - 重定向到 MVC 中的内部页面

> ID：12133961
> 
> 赞同：0
> 
> 时间：2012-08-26T21:14:22.727
> 
> 标签：asp.net, asp.net-mvc, c#-4.0, asp.net-mvc-4, asp.net-mvc-routing

我有一个用 ASP.NET MVC 4.5 编写的网站，我有一个控制器`Products`，其中包含有关每个产品的视图。

我希望我们的一种产品在用户访问 www.website.com/ProductName 时重定向到 www.website.com/Products/ProductName。

我现在正在考虑这两种方法：

*   创建一个名为 like 的控制器`ProductName`并使用`RedirectToRoute()`
*   修改`RouteConfig.cs`文件并添加一个。

你最好的方法是什么，为什么？还有一个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:47:09.260

我和@rjovic 在一起，肯定会采用第二种方法并添加一条新路线。

第一种方法需要为每个产品创建一个新的控制器，这似乎违背了良好的设计原则；为什么要为行为相同的多个产品设置一个单独的类？路由正是为这种情况而设计的：将用户友好的 URL 方案映射到应用程序逻辑中的适当处理程序。

在这种情况下，设计路线有两种可能的方法：

1.  匹配任何 URL，例如 /{ProductName}。问题是这是一个贪婪的方案，所以你想把它放在路由列表的末尾附近，这样它只会在没有其他方案匹配的情况下使用。
2.  仅匹配与实际产品匹配的 /{ProductName} 等 URL。因此，您必须预先加载产品名称列表，并构造一个看起来像（例如）“[product1|product2|product3]”的约束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T21:55:52.213

看起来您在这里所做的只是一些重定向。您可能想查看使用 IIS Url Rewrite 模块并创建重定向规则，例如

```
<rewrite>
  <rules>
    <rule name="Redirect to Products/ProductName">
      <match url="^ProductName" />
      <action type="Redirect" url="Products/ProductName" />
    </rule>
  </rules>
</rewrite> 
```

[http://learn.iis.net/page.aspx/461/creating-rewrite-rules-for-the-url-rewrite-module/](http://learn.iis.net/page.aspx/461/creating-rewrite-rules-for-the-url-rewrite-module/)上有很多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T21:59:54.870

`www.website.com/products/productname`会更加RESTful。从长远来看，当您想添加网站的另一个部分时，将您的产品置于网站的根级别只会自找麻烦。即 www.website.com/about-us - about-us 是一种产品，还是它自己的页面？

创建一个 ProductsController 并具有一个默认操作，该操作采用一个作为产品名称的字符串。

# javascript - Javascript警报显示数据库字段 - asp

> ID：12133965
> 
> 赞同：0
> 
> 时间：2012-08-26T21:15:34.167
> 
> 标签：javascript, variables, asp-classic, database-connection

`alert`如果出现条件，我有一个显示在表单提交上的 javascript 。这很好，我可以使用以下内容：

```
alert("Name  You Must Agree To The Terms and Conditions / You have chosen an invalid saving amount"); 
```

`</head>`这在本节中被调用。但是，我想在从数据库调用的错误中包含一个值，该值在我的 asp 中进一步调用：

```
strErrorSavingsAmount = rs("ErrorSavingsAmount") 
```

有没有办法显示这个和/或如果 javascript 函数在头部并且与数据库的连接在代码中进一步下降，它会起作用吗？

为了提供帮助，这里有更多信息，这是我的完整 JavaAScript：

```
<script type="text/javascript"> 
function validate(str, chk, min, max) { 
  n = parseFloat(str); 
  return (chk && !isNaN(n) && n >= min && n <= max); 
} 

function validateForm() 
{ 
  if(!validate(document.forms["myForm"]["Amount"].value,  
     document.forms["myForm"]["agreesubmit"].checked, 5, 250)) { 
    alert("Name  You Must Agree To The Terms and Conditions / You have chosen an invalid saving amount"); 
    return false; 
  } 
} 

</script> 
```

我将在哪里声明变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:24:44.277

您正在做的是将服务器端变量传递给客户端代码。与数据库的连接发生在哪里并不重要，因为它*总是*在 JavaScript 执行之前发生。

我对 ASP 了解不多，但我知道代码插入的约定与 PHP 类似。用`<% %>`语法。

您所要做的就是创建一个包含服务器端变量值的 JavaScript 变量。我将举一个 PHP 的例子，希望你能明白我的意思 -

```
echo '<script type="javascript">';
echo 'var jsVariable = "' . $someServerVariable .'"';
echo '</script>'; 
```

请注意我如何用额外的引号包裹服务器变量，以便它与 JavaScript 兼容。

现在，在您完成此操作后，您的 JavaScript 将可以访问`jsVariable`在服务器上创建的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T06:14:22.040

您可以执行以下操作

1.  创建隐藏变量。
2.  将 rs("ErrorSavingsAmount") 值分配给该变量。
3.  在您的 javascript 中使用 document.getElementById 找到该隐藏字段

# asp.net - 如何将 javascript:__doPostBack 网址更改为完整网址

> ID：12133966
> 
> 赞同：0
> 
> 时间：2012-08-26T21:15:36.413
> 
> 标签：asp.net, seo

我是一名专业的 SEO，最近开发了一个数据库驱动的 ASP.NET 站点。我的网站的内部链接有问题。我的链接显示为`doPostBack`，但我希望它们显示实际 URL，以便搜索引擎可以抓取它们。

当前：这是我侧边栏中的链接模式。所有链接都是这种格式

```
<ul>
<li><a id="linkHome" href="javascript:__doPostBack(&#39;ctl00$linkHome& #39;,&#39;&#39">Home</a></li> 
```

这只是侧边栏中的一个链接。所有链接都是这种格式。我希望他们像

```
<li><a id="linkHome" href="http://www.example.com">Home</a></li> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T21:20:35.263

告诉您的开发人员对那些链接使用普通的href链接，而不是`asp:LinkButton`我认为他正在使用的链接。或者移动到 MVC 并使用 MVC 路由器。他正在使用服务器端控件（您告诉我）可以是客户端链接（标准锚标签）`asp:LinkButton`原因服务器端处理只是为了处理一个链接，如果可以直接访问页面而无需制作一个链接，这是愚蠢的服务器请求。

编辑：

有关更多详细信息，您的开发人员可能正在执行以下操作：

```
<asp:LinkButon runat="server" id="linkHome" OnClick="linkHome_OnClick" Text="Home" /> 
```

或者可能

```
<asp:HyperLink runat="server" id="linkHome" NavigateUrl="example.com" Text="Home" /> 
```

他应该做的只是：

```
<a href="example.com">Home</a> 
```

# python - 查看所有绑定，wxpython

> ID：12133973
> 
> 赞同：3
> 
> 时间：2012-08-26T21:16:19.637
> 
> 标签：python, wxpython, wxwidgets

有没有办法查看对象的所有绑定？

```
x=wx.Button(self,-1,"hi")
x.Bind(wx.EVT_BUTTON,self.Press)

###
print x.ShowAllBindingData()  #Function doenst exists
[['EVT_BUTTON','Press']] 
```

有没有这样的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T10:06:23.367

不，这是不可能的。请注意，如果可能的话，它不会很有用，因为即使您不调用`Bind()`对象本身，您仍然可以以不同的方式处理事件，例如通过在父窗口级别处理它（对于命令事件仅等）或通过在对象顶部推送自定义事件处理程序或（这可能仅是 C++）`ProcessEvent()`直接覆盖虚拟方法。

# iphone - 用于在网站上做广告的 iPhone 应用小部件

> ID：12133975
> 
> 赞同：0
> 
> 时间：2012-08-26T21:16:38.190
> 
> 标签：iphone, ios, ads

Apple 是否提供任何应用程序小部件或资源来在您自己的网站上为您的 iphone 应用程序创建广告？还是您自己创建图像/文本以在您的网站上宣传您的应用程序？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T21:40:08.133

他们提供[营销资源](https://developer.apple.com/appstore/resources/marketing/index.html)。您可以使用一些图形并根据自己对应用程序的特定需求进行更改。例如，在他们的设备中放置一些屏幕等。

# python - 在 App Engine 中实现“无限滚动”

> ID：12133976
> 
> 赞同：2
> 
> 时间：2012-08-26T21:17:00.017
> 
> 标签：python, ajax, google-app-engine, jinja2

本质上，我有一个个人资料页面，其中包含显示的评论。我想显示 10 个帖子，然后在用户滚动到页面底部（如 facebook）时再加载 10 个帖子。

我只是想知道最好的方法是什么？

我现在拥有的是一个 Query 对象：

```
 posts = db.GqlQuery("select * from Profile_Comments WHERE name_of_profile =:1 order by date_created desc", profile_id) 
```

我的 jinja 模板中还有一个 for 循环，用于获取帖子：

```
{% for post_tmp in posts %}

        {{post_tmp.post.replace('\r\n', '<br>') | safe }}

{%  endfor %} 
```

有谁知道该怎么做？谢谢！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T22:12:18.977

一种选择是使用像[这样](http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/)的工具/插件，它将通过查找上一个/下一个链接并在用户滚动足够远时在运行时自动加载和包含它们来“逐步增强”您的页面。

当然，你可以自己做。无论哪种情况，您都应该了解 App Engine 中的游标，这将允许您获取后续的结果页面，而无需数据存储区跳过已查看的结果。

# java - 如何使用 GNU NNTP 标记.DELETED 消息

> ID：12133977
> 
> 赞同：1
> 
> 时间：2012-08-26T21:17:00.977
> 
> 标签：java, email, jakarta-mail, gnu, nntp

我正在使用[GNU javamail](http://www.gnu.org/software/classpathx/javamail/)来阅读 NNTP 消息：

```
public List<Message> getMessages(Newsgroup newsgroup) throws MessagingException   {
    LOG.fine("fetching.." + newsgroup);
    folder = root.getFolder(newsgroup.getNewsgroup());
    folder.open(Folder.READ_ONLY);
    List<Message> messages = Arrays.asList(folder.getMessages());
    LOG.fine("..fetched " + folder);
    return Collections.unmodifiableList(messages);
} 
```

但是，我遇到了索引问题，因为我无法弄清楚如何只发送新消息或未读消息。

当然可以迭代文件夹中的消息，解析标题，并且只返回外部参照值高于某个阈值的消息。标题是这样的：

`Xref: dur.bounceme.net gwene.com.economist:594`

但是，对于非常大的文件夹，这样做[有点麻烦。](https://stackoverflow.com/questions/11928128/nntp-xref-header-for-article-message-number)

我当然已经看到这不是一个未知的问题，而且我肯定是在重新发明轮子。不幸的是，在这种情况下，我的轮子甚至不是圆形的，因为我无法确定如何修剪（删除）NNTP 服务器上的消息（在这种情况下，[Leafnode](http://leafnode.sourceforge.net/)在本地主机上运行）。

在不迭代整个文件夹的情况下，如何获取超过某个阈值的消息？或者，[我如何从文件夹](https://stackoverflow.com/a/1465130/262852)中删除消息，如果它们被删除，leafnode 会删除这些消息吗？

它很简单：

`message.setFlags(Flags.Flag.DELETED, true);`？？？

作为替代方案，我正在[尝试 GNU Mailman](https://askubuntu.com/questions/180801/illegal-list-name-mailman-configuration-with-fqdn)。

# mysql - 创建 Amazon RDS 数据库的本地副本

> ID：12133979
> 
> 赞同：5
> 
> 时间：2012-08-26T21:17:17.053
> 
> 标签：mysql, amazon-web-services, rds

如何将我的 AWS RDS 实例上的数据库 mysqldump 到 .sql 文件以供本地使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T17:11:19.240

这很简单：

```
mysqldump -H <RDS_URL> -u <user> -p<password> <db> > myfile.sql 
```

只要您添加`-H`正确的用户/密码凭据，就没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T07:32:33.393

或者，您可以使用 MySQL Work Bench 之类的客户端远程打开它，并随时将其导出为 .sql。

[http://www.mysql.com/products/workbench/](http://www.mysql.com/products/workbench/)

# php - 如何在测试 div 中显示 javascript 变量的实际值？

> ID：12133989
> 
> 赞同：0
> 
> 时间：2012-08-26T21:18:16.223
> 
> 标签：php, jquery

我有一个包含很多（不断变化的）变量的 2 人棋盘游戏。出于测试目的，我想在 testdiv 中显示所有这些 javascripts 变量，例如：

```
<div id="testdiv" style="margin-top:800px;background-color:yellow">
/** here the listing of js vars and arrays */
</div> 
```

这个棋盘游戏使用一个后端文件来更新游戏，但是当我试图跟随 javascript vars 发生的事情时我迷路了。我确实知道变量和数组的名称。轮换后，我刷新页面，但我想通过 ajax (jQuery) 更新页面。为了检查 playerturn，我已经使用了 jQuery 和 taconite 插件形式[http://www.malsup.com/jquery/taconite/](http://www.malsup.com/jquery/taconite/) 这个插件返回 xml，如下所示：

```
### Taconite output 
?><taconite> 
<?php 
echo $content_refresh; // refresh pagina indien nodig
echo $content_redirect;
echo $content_melding; // melding over verlaten tafel of afgewezen!
echo $content_inpartij; // tegenstander in partij??
echo $content_chataangevraagd; // chat door tegenstander aangevraagd?
echo $content_wachtopaanschuiven; // div leegmaken zodra 2e speler in partij is
echo $content_starttijd;
?>
</taconite> 
```

所有内容变量都是生成 xml，例如

```
## Taconite: refresh nodig??

if($refresh_needed == 'ja')
{
$content_refresh = '<eval><![CDATA[
                                 window.location="http://www.xxxxxxxx.nl/v45/partij.php?gameID='.$_GET['gameid'].'";
                    ]]> 
                    </eval>';
//$meta_refresh = '<replaceContent select="#refresh"><META HTTP-EQUIV="refresh"     CONTENT="0"></META></replaceContent>';
} 
```

因此，我不想刷新我只想更新棋盘游戏，但只是没有对所有（已知）当前 javascript 值的概述。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T21:27:33.557

我不熟悉您的插件，也没有列出您的服务器端技术（猜测 php），所以我想说看看[http://php.net/manual/en/book.json.php上 php 的 json 序列化能力](http://php.net/manual/en/book.json.php)

然后你应该在这里做的是在客户端的 javascript 中，像你一样发出 ajax 请求，但是使用 json 编写服务器端代码来发送代表必要更改或整个板状态的数据. 在客户端，JSON 对象将被接收并用作直接的 javascript 对象，然后您可以使用一种方法来处理它，以根据服务器发送的数据手动更新板状态。

编辑：

抱歉，忘记范围是在这里获取调试信息，因为渲染板更新的方法也应该将所述调试信息渲染到屏幕上某个单独的 div 中。如果您还没有，我会使用 jquery 作为 ajax，并且使用 jquery，您可以使用选择器来执行以下操作：

```
$("#debugDiv").text("Var a: " + boardState.VarA);
$("#debugDiv").append("Var b: " + boardState.VarB); 
```

看一眼：

[http://api.jquery.com/append/](http://api.jquery.com/append/)

[http://api.jquery.com/id-selector/](http://api.jquery.com/id-selector/)

[http://api.jquery.com/element-selector/](http://api.jquery.com/element-selector/)

[http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T22:02:20.117

在 javascript 中，您声明的变量`globally`通常附加到`window object`. 因此，如果您的变量在`global`Scope 中，您可以将它们签入`DOM tab`，`firebug`然后单击`window`。

问题是你会在那里看到很多其他变量。

如果您的变量在其他范围内，您只需检查特定范围内的内容。

如果你想在 div 中打印它们，你需要一些方法来区分你的变量和其他变量，然后使用`for in`循环和`hasOwnProperty`and `typeof`。

话虽如此，最好的方法是重组您的应用程序，使其至少对您透明。

# java - 在 jar 中包含 jar 文件

> ID：12133990
> 
> 赞同：1
> 
> 时间：2012-08-26T21:18:18.277
> 
> 标签：java, datasource, c3p0

我有一个带有[c3p0](http://www.mchange.com/projects/c3p0/) JAR 的 Java 保护。在 Eclipse 中编译我的项目是可行的。没有错误什么的。但是当我尝试运行我的应用程序时，它会显示以下内容：

`java.lang.NoClassDefFoundError: com/mchange/v2/c3p0/DataSources`

我需要从 c3p0 给 jar 文件另一个 jarfile 吗？或者我可以在启动应用程序时链接它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T21:51:30.737

注意：我已经理解您的问题是在Eclipse*之外运行时出现的。*

负责加载类的标准 Java 类加载器不理解 jar-files 中的 jar-files，因此您需要执行其他操作：

*   您可以将您使用的所有 jar 文件中的所有类合并到一个 jar 文件中。（**此时推荐给你，不是一般推荐**）
*   您可以将 jar 文件放在单个 jar 文件中，并使用可以理解这一点的特殊类加载器。
*   您可以将引用的 jar 放在包含类文件的单个 jar 文件的“旁边”，并让可运行的 jar 包含引用它们所需的必要 MANIFEST.MF voodo。

Eclipse 中的`File->Export->Runnable jar`选项可以根据您的选择完成所有三个操作。选择最适合您将课程提供给最终用户的方式。

我个人喜欢“生成的 jar 旁边的 jar”，因为它最接近 Java 开箱即用的支持，同时保留原始 jar 文件。最简单的最有可能合并所有类，但是当你更高级时你会发现它有一些缺点——此时你很可能不会遇到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T21:30:36.393

在eclipse中添加C3P0作为外部jar

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T21:37:05.857

运行示例时，您似乎没有在类路径中添加 c3p0。

但是，您可以使用 Maven 和 m2e 插件进行 Eclipse 并添加以下内容

```
 <dependency>
        <groupId>c3p0</groupId>
        <artifactId>c3p0</artifactId>
        <version>0.9.1.2</version>
 </dependency> 
```

除了您拥有的其他依赖项之外。

在 mvn eclipse: eclipse 之后，您的项目将具有正确的类路径。

# android - Android：将多个 .XML 和对象膨胀到一个 .XML 中

> ID：12133991
> 
> 赞同：3
> 
> 时间：2012-08-26T21:19:02.833
> 
> 标签：android, android-layout, view, viewgroup, layout-inflater

**对象：（** 运行 API 8）以编程方式，我试图将以下内容膨胀到单个布局*main.xml*

*   bg_content1.xml
*   bg_content2.xml
*   @+id/img_logo
*   @+id/str_username

**笔记：**

1.  @+id/img_logo 是位于 bg_c​​ontent3.xml 中的 ImageView 的 id
2.  @+id/str_username 是位于 bg_c​​ontent4.xml 中的 TextView 的 id
3.  请不要问我为什么必须将多个布局和对象膨胀到另一个布局上。我正在尝试优化我的布局以实现可维护性。

**主要的.xml**

```
<LinearLayout android:id="@+id/main">
</LinearLayout> 
```

**bg_content1.xml**

```
<LinearLayout android:id="@+id/bg_content1">
    <TextView
        android:text:"bg_content1 here"
        //other attributes omitted
    </TextView>
</LinearLayout> 
```

**bg_content2.xml**

```
<LinearLayout android:id="@+id/bg_content2">
    <TextView
        android:text:"bg_content2 here"
        //other attributes omitted
    </TextView>
</LinearLayout> 
```

**bg_content3.xml**

```
<LinearLayout android:id="@+id/bg_content2">
    <ImageView
        android:id:"@+id/img_logo"
        //other attributes omitted
    </TextView>
</LinearLayout> 
```

**bg_content4.xml**

```
<LinearLayout android:id="@+id/bg_content4">
    <TextView
        android:id:"@+id/str_username"
        //other attributes omitted
    </TextView>
</LinearLayout> 
```

**MainActivity.xml**

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    LinearLayout container = (LinearLayout) findViewById(R.id.main);
    LayoutInflater inflater = LayoutInflater.from(this);
    LinearLayout bg_content = (LinearLayout) inflater.inflate(
        R.layout.bg_content1, null);
    container.addView(bg_content);

    bg_content = (LinearLayout) inflater.inflate(
        R.layout.bg_content2, null);
    container.addView(bg_content);

    ImageView bg_img = (ImageView) inflater.inflate(R.id.img_logo, null);
    container.addView(bg_img);

    TextView bg_str = (TextView) inflater.inflate(R.id.str_username, null);
    container.addView(bg_str); 
```

}

**日志猫**

```
08-26 14:16:43.457: D/AndroidRuntime(1726): Shutting down VM
08-26 14:16:43.457: W/dalvikvm(1726): threadid=1: thread exiting with uncaught exception (group=0x40015578)
08-26 14:16:43.558: E/AndroidRuntime(1726): FATAL EXCEPTION: main
08-26 14:16:43.558: E/AndroidRuntime(1726): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.android/com.example.android.ExLayoutInflaterActivity}: android.content.res.Resources$NotFoundException: Resource ID #0x7f050000 type #0x12 is not valid
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.os.Looper.loop(Looper.java:130)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.app.ActivityThread.main(ActivityThread.java:3687)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at java.lang.reflect.Method.invokeNative(Native Method)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at java.lang.reflect.Method.invoke(Method.java:507)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at dalvik.system.NativeStart.main(Native Method)
08-26 14:16:43.558: E/AndroidRuntime(1726): Caused by: android.content.res.Resources$NotFoundException: Resource ID #0x7f050000 type #0x12 is not valid
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.content.res.Resources.loadXmlResourceParser(Resources.java:1874)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.content.res.Resources.getLayout(Resources.java:731)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.view.LayoutInflater.inflate(LayoutInflater.java:318)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at com.example.android.ExLayoutInflaterActivity.onCreate(ExLayoutInflaterActivity.java:26)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
08-26 14:16:43.558: E/AndroidRuntime(1726):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
08-26 14:16:43.558: E/AndroidRuntime(1726):     ... 11 more 
```

**@Ikaros 提供**的解决方案 我在下面修改了一些小的语法错误：

```
bg_content = (LinearLayout) inflater.inflate(
            R.layout.bg_content3, null);
container.addView(bg_content);

ImageView bg_img = (ImageView) bg_content.findViewById(R.id.img_logo);

bg_content = (LinearLayout) inflater.inflate(R.layout.bg_content4, null);
    container.addView(bg_content);

TextView bg_str = (TextView) bg_content.findViewById(R.id.str_username); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T21:28:13.340

例如在：

```
ImageView bg_img = (ImageView) inflater.inflate(R.id.img_logo, null);
container.addView(bg_img); 
```

你试图膨胀你的布局的孩子，我认为这是你的错误。您可以尝试以下方法：

```
LinearLayout linear_layout = (LinearLayout) inflater.inflate(R.layout.bg_content3.xml, null);
container.addView(linear_layout); 
```

如果您需要对 ImageView 的引用，可以将其称为：

```
(ImageView) bg_img = (ImageView) linear_layout.findViewById(R.id.bg_img); 
```

# google-analytics - 使用 jquery 中的事件处理程序进行 Google Analytics 异步事件跟踪

> ID：12133992
> 
> 赞同：1
> 
> 时间：2012-08-26T21:19:08.453
> 
> 标签：google-analytics, event-tracking

在我的*所有*网站页面上，我在结束 head 标记之前都有如下的谷歌分析异步代码设置......

```
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXX-X']);
_gaq.push(['_trackPageview']);

(function() {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();</script> 
```

然后在我的结帐页面上，我尝试使用事件跟踪来报告用户在各个页面上花费的时间作为谷歌分析事件的价值。

我通过使用 jQuery.ready 函数来记录“开始”时间并将事件处理程序添加到提交按钮，从而将用户带到结帐的下一步。此代码位于外部文件 common.js 中，如下所示...

```
 $(document).ready(function() {
        recordStartTime();
        if ($("#checkoutPage1").length) 
        {   
            if ($("#customerDetailsForm").length) 
            {   
            // Time spent
                $('.customerDetailsSubmitButton').click(function() {
                time = durationWholeSeconds();
                _gaq.push(['_trackEvent', 'Checkout', 'Timing', 'CustomerDetailsPage', time]);
                return true;
                });
            }
        } 
```

对于 jQuery.ready、#checkoutPage1、#checkoutPage2、#checkoutPage3 等中的其他步骤，我有类似的代码部分。

当我在我的浏览器 (Chrome) 上测试此代码时，一切都按预期工作并使用 ga.debug 插件，我可以看到 _trackEvent 参数被发送到谷歌分析。

我的问题似乎是这似乎并不总是在野外工作。在我的直播网站上，我看到间歇性事件正在发生。鉴于我非常准确地知道有多少“销售”，我在 GA 中应该预期的事件不匹配。通常，结帐步骤中的一些后面的事件会在没有记录较早的事件的情况下报告。

我的问题基本上是我可以使用 jQuery.ready 函数在需要的地方添加事件处理程序和跟踪代码吗？还有另一个我没有发现的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T21:43:06.937

您可以使用 jQuery.ready，但您必须记住，有时`jQuery.ready`不会触发。有时用户会在 DOM 准备好之前离开。

您没有发布您的功能`recordStartTime`和`durationWholeSeconds`. 如果他们出于某种原因在浏览器上引发异常，则该会话不会触发事件。也许你应该确保它们被 try catch 块屏蔽以触发事件，即使它们失败了。

我还建议您使用`$('.customerDetailsSubmitButton').mousedown`而不是`click`. `mousedown`首先开火，这里的时机很重要。如果浏览器在事件通过之前重定向，则它有可能被取消并且永远不会到达 GA。在我们使用 mousedown 的[测试](http://www.cardinalpath.com/experiment-onclick-vs-onmousedown-event-tracking-in-google-analytics/)中，我们看到的点击次数几乎是使用 click 的两倍。

# c# - MonoTouch：外观4.3安全吗？

> ID：12133998
> 
> 赞同：1
> 
> 时间：2012-08-26T21:19:51.633
> 
> 标签：c#, ios, mono, xamarin.ios, appearance

尽管如今 iOS 设备的 4.3 用户很少见，但我们是否需要在使用分配值给各种`Appearance`类之前进行检查，`MonoTouch 5.2.x`还是 MonoTouch 框架会优雅地忽略这些设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T13:46:32.130

MonoTouch（就像 Objective-C 一样）不在 API 内部进行版本检查。这将非常**昂贵**，并且在许多情况下，它不能可靠地完成（例如，一种新`PushSomething`方法）。

即使可以在运行时忽略，例如符合`UIAppearance`协议的类型，如果不支持（例如颜色选择），应用程序可能希望以不同方式调整自身。例如

```
if (UIDevice.CurrentDevice.CheckSystemVersion (5,0)) {
    UISlider.Appearance.BackgroundColor = UIColor.Black;
} else {
    // limited UI customization path
} 
```