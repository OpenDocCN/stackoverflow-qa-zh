# StackOverflow 问答 000511000-000511999

# python - 如何告诉 python 使用哪个版本的 libmysqlclient.so？

> ID：511011
> 
> 赞同：3
> 
> 时间：2009-02-04T11:48:54.440
> 
> 标签：python

我在共享托管服务器上运行 python 脚本，直到今天早上它都有 MySQL 版本 4。现在它有版本 5。我的 python 脚本无法再连接到 MySQL，因为它找不到 libmysqlclient_r.so.14：

```
$ python my_script.py
Traceback (most recent call last):
File "my_script.py", line 6, in ?
import MySQLdb
 File "/home/lib/python2.4/site-packages/PIL-1.1.6-py2.4-linux-i686.egg/__init__.py", line 19, in ?

 File "build/bdist.linux-i686/egg/_mysql.py", line 7, in ?
 File "build/bdist.linux-i686/egg/_mysql.py", line 6, in __bootstrap__
ImportError: libmysqlclient_r.so.14: cannot open shared object file: No such file or directory 
```

/usr/lib 中还有各种其他版本的 libmysqlclient：

```
/usr/lib/libmysqlclient.so.15
/usr/lib/libmysqlclient.so.14
/usr/lib/mysql/libmysqlclient.la
/usr/lib/mysql/libmysqlclient.so
/usr/lib/mysql/libmysqlclient_r.so
/usr/lib/mysql/libmysqlclient_r.a
/usr/lib/mysql/libmysqlclient_r.la
/usr/lib/mysql/libmysqlclient.a
/usr/lib/libmysqlclient.so
/usr/lib/libmysqlclient_r.so
/usr/lib/libmysqlclient_r.so.15
/usr/lib/libmysqlclient_r.so.15.0.0
/usr/lib/libmysqlclient.so.15.0.0 
```

所以我的问题是：如何告诉python（2.4.3版）使用哪个版本的libmysqlclient？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T12:16:53.260

您无法告诉动态链接器使用哪个版本的库，因为 SONAME（库的全名 + 接口）是二进制文件的一部分。

在您的情况下，您可以尝试将 libmysqlclient_r.so.14 上传到主机并进行`LD_LIBRARY_PATH`相应设置，因此在解析共享对象时告诉动态链接器在系统目录中另外搜索哪些目录。

您可以使用`ldd`它来查看它是否`LD_LIBRARY_PATH`有效：

```
$ ldd $path_to/_mysql.so
...
libmysqlclient_r.so.14 => $path_to_lib/libmysqlclient_r.so.14
... 
```

否则，将出现关于未解析共享对象的错误消息。

当然，这只能是临时修复，直到您重建 MySQLdb 以使用新库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T12:02:32.790

您将不得不重新编译 python-mysql（又名 MySQLdb）以使其链接到新版本的 libmysqlclient。

如果您的主机最初设置环境而不是您编译它，您将不得不纠缠他们。

> /usr/lib/libmysqlclient.so.14

这看起来像是旧 libmysqlclient 的残余，应该被删除。_r 和 .a （静态）版本已经消失，您并不真的想要混合库，它只会冒着混淆 automake 的风险。

虽然您*可以*创建从 libmysqlclient_r.so.14 到 .15 的符号链接，但只有在新版本的客户端碰巧具有与旧版本相同的 ABI 时，这才有效——这不太可能，因为这就是更改版本号的重点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T11:56:05.423

一种解决方案是将您的`PYTHONPATH`环境变量设置为具有一些本地目录，然后复制（或链接，我想）您想要的 mysql lib 版本。

# java - How to handle OutOfMemoryError in Java?

> ID：511013
> 
> 赞同：13
> 
> 时间：2009-02-04T11:49:09.977
> 
> 标签：java, memory-management

I have to serialize around a million items and I get the following exception when I run my code:

```
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
    at java.util.Arrays.copyOfRange(Unknown Source)
    at java.lang.String.<init>(Unknown Source)
    at java.io.BufferedReader.readLine(Unknown Source)
    at java.io.BufferedReader.readLine(Unknown Source)
    at org.girs.TopicParser.dump(TopicParser.java:23)
    at org.girs.TopicParser.main(TopicParser.java:59) 
```

How do I handle this?

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-04T13:06:19.447

我知道官方的 Java 回答是“哦，不！没有记忆！我放弃了！”。对于在内存不足不允许成为致命错误（例如，编写操作系统或为不受保护的操作系统编写应用程序）的环境中编程的任何人来说，这都是相当令人沮丧的。

放弃的意愿是必要的——你无法控制 Java 内存分配的每一个方面，所以你不能保证你的程序在低内存条件下会成功。但这并不意味着你必须不战而降。

不过，在战斗之前，您可以寻找避免这种需要的方法。也许您可以避免 Java 序列化，而是定义您自己的数据格式，这种格式不需要大量的内存分配来创建。序列化分配了大量内存，因为它保留了它之前看到的对象的记录，因此如果它们再次出现，它可以通过数字引用它们而不是再次输出它们（这可能导致无限循环）。但那是因为它需要是通用的：根据您的数据结构，您可能能够定义一些文本/二进制/XML/任何表示形式，这些表示形式只需写入流，几乎不需要存储额外的状态。或者您可以安排您需要的任何额外状态一直存储在对象中，而不是在序列化时创建。

如果您的应用程序执行一个使用大量内存的操作，但大部分使用的内存要少得多，特别是如果该操作是用户启动的，并且如果您找不到使用更少内存或提供更多内存的方法，那么它可能值得抓住 OutOfMemory。您可以通过向用户报告问题太大并邀请他们减少并重试来恢复。如果他们只是花了一个小时来解决他们的问题，你*不会*只想退出该计划并失去一切 - 你想给他们一个机会做点什么。只要错误在堆栈中向上捕获，多余的内存将在错误被捕获时未被引用，从而使 VM 至少有机会恢复。确保您在常规事件处理代码下方捕获错误（在常规事件处理中捕获 OutOfMemory 可能会导致繁忙循环，因为您尝试向用户显示对话框，但您仍然内存不足，并且您捕获另一个错误）。仅在您确定为内存占用的操作周围捕获它，以便您无法处理的来自内存占用以外的代码的 OutOfMemoryErrors 不会被捕获。

即使在非交互式应用程序中，放弃失败的操作可能是有意义的，但程序本身要继续运行，处理更多数据。这就是为什么 web 服务器管理多个进程，这样如果一个页面请求因内存不足而失败，服务器本身不会崩溃。正如我在顶部所说，单进程 Java 应用程序无法做出任何此类保证，但它们至少可以比默认设置更健壮一些。

也就是说，您的特定示例（序列化）可能不适合这种方法。特别是，用户在被告知有问题时可能想做的第一件事是保存他们的工作：但如果序列化失败，则可能无法保存。这不是您想要的，因此您可能必须在尝试序列化*之前*进行一些实验和/或计算，并手动限制您的程序允许多少百万个项目（基于它正在运行的内存量） 。

这比尝试捕获错误并继续更健壮，但不幸的是，很难计算出确切的界限，因此您可能不得不谨慎行事。

如果在反序列化过程中发生错误，那么您的立场就更加坚定：如果您可以避免，无法*加载文件不应该是应用程序中的致命错误。*捕获错误更可能是合适的。

无论你做什么来处理资源不足（包括让错误删除应用程序），如果你关心后果，那么彻底测试它真的很重要。困难在于你永远不知道代码中的哪一点会出现问题，所以通常有大量的程序状态需要测试。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-04T11:52:18.863

理想情况下，重组代码以使用更少的内存。例如，也许您可​​以流式传输输出，而不是将整个内容保存在内存中。

或者，只需使用该`-Xmx`选项为 JVM 提供更多内存。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-04T11:52:27.987

您不应该在代码中处理它。OutOfMemory 不应被捕获和处理。而是使用更大的堆空间启动 JVM

```
java -Xmx512M 
```

应该做的伎俩。

请参阅[此处](http://docs.sun.com/app/docs/doc/819-3681/abeii?a=view)了解更多详细信息

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-04T13:48:52.403

其他人已经介绍了如何给 Java 更多内存，但是因为“句柄”可能意味着捕获，所以我将引用 Sun 对[`Error`](http://java.sun.com/javase/6/docs/api/java/lang/Error.html)s 的评价：

> An`Error`是它的子类，`Throwable` 它指示合理的应用程序**不应尝试捕获**的严重问题。大多数此类错误是异常情况。

（强调我的）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-04T11:55:38.717

您收到 OutOfMemoryError 是因为您的程序需要的内存比 JVM 可用的内存多。您无法在运行时专门做任何事情来帮助这一点。

正如 krosenvold 所指出的，您的应用程序可能对内存提出了合理的要求，但碰巧 JVM 没有启动足够的内存（例如，您的应用程序将有 280MB 的峰值内存占用，但 JVM 仅以 256MB 开始）。在这种情况下，增加分配的大小将解决这个问题。

如果您觉得在启动时提供了足够的内存，那么您的应用程序可能会暂时使用过多的内存，或者存在内存泄漏。在您发布的情况下，听起来您一次持有对内存中所有数百万个项目的引用，即使您可能是按顺序处理它们。

检查您对“完成”项目的引用是什么样的——您应该尽快尊重这些，以便它们可以被垃圾收集。例如，如果您将一百万个项目添加到一个集合中，然后对该集合进行迭代，您将需要足够的内存来存储所有这些对象实例。看看您是否可以一次取一个对象，将其序列化，然后丢弃引用。

如果您在解决这个问题时遇到问题，发布一个伪代码片段会有所帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-04T12:10:30.667

除了提供给您的一些提示之外，还可以查看内存不足并使用更多内存 (-Xmx512M) 启动 JVM。看起来你有一个 OutOfMemoryError 导致你的*TopicParser*正在读取一个可能相当大的行（这是你应该避免的），你可以使用*FileReader*（或者，如果编码是一个问题，一个*InputStreamReader*包装一个*FileInputStream*）。使用它的 read(char[]) 方法和一个*合理*大小的 char[] 数组作为缓冲区。

最后还要调查一下为什么 OutOfMemoryError 您可以在 JVM 中使用 -XX:+HeapDumpOnOutOfMemoryError 标志来获取转储堆信息到磁盘。

祝你好运！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-04T14:12:31.527

有趣的是 - 您在 readline 上出现内存不足。猜测一下，您正在读取一个没有换行符的大文件。

与其使用 readline 将文件中的内容作为一个大长字符串从文件中取出，不如编写能够更好地理解输入的内容，并将其分块处理。

如果您只是*必须*将整个文件放在一个大长字符串中……那么，在编码方面做得更好。一般来说，试图通过将数据全部填充到单个字节数组（或其他）中来处理数千兆字节数据是一种很好的失败方式。

去看看 CharacterSequence。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-04T11:59:02.857

使用 transient 关键字标记序列化类中可以从现有数据生成的字段。实现 writeObject 和 readObject 以帮助重建瞬态数据。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-04T11:54:23.587

您可以使用 -Xmx 选项增加 java 使用的内存大小，例如：

```
java -Xmx512M -jar myapp.jar 
```

更好的是减少应用程序的内存占用。你序列化数以百万计的项目？您需要将所有这些都保存在内存中吗？或者你可以在使用它们之后释放它们中的一些吗？尽量减少使用的对象。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T13:27:24.693

在您遵循增加堆空间的建议（通过 -Xmx）但确保使用[JConsole](http://java.sun.com/javase/6/docs/technotes/tools/share/jconsole.html)或[JVisualVM](http://java.sun.com/javase/6/docs/technotes/tools/share/jvisualvm.html)来分析您的应用程序内存使用情况之后。确保内存使用量不会持续增长。如果是这样，您仍然会收到 OutOfMemoryException，它只需要更长的时间。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T11:51:12.297

使用 -Xmx 选项的较大值启动 java，例如 -Xmx512m

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T12:41:07.610

没有真正的方法可以很好地处理它。一旦它发生，你就在未知的领域。您可以通过名称 - OutOfMemory **Error**来判断。它被描述为：

> 当 Java 虚拟机因为内存不足而无法分配对象时抛出，并且垃圾收集器无法提供更多内存

通常 OutOfMemoryError 表明系统/方法存在严重错误（并且很难指出触发它的特定操作）。

通常它与普通的堆空间耗尽有关。使用 -verbosegc 和前面提到的 -XX:+HeapDumpOnOutOfMemoryError 应该会有所帮助。

您可以在[javaperformancetuning找到一个简洁明了的问题摘要](http://www.javaperformancetuning.com/news/qotm036.shtml)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-04T14:19:10.097

在采取任何危险的、耗时的或战略性的行动之前，您应该确定您的程序中究竟是什么占用了如此多的内存。你可能认为你知道答案，但在你有证据之前，你不知道。内存有可能被你没想到的东西使用了。

使用分析器。不管是哪一个，[都很多](https://stackoverflow.com/questions/14762/please-recommend-a-java-profiler)。首先找出每个对象使用了多少内存。其次，逐步完成序列化程序的迭代，比较内存快照并查看创建了哪些对象或数据。

答案很可能是流输出而不是在内存中构建它。但先拿证据。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-23T12:10:12.353

我发现了一种替代方法，尊重所有其他观点，我们不应该试图从异常中捕获内存，这是我最近学到的。

```
catch (Throwable ex){
 if (!(ex instanceof ThreadDeath))
 {
  ex.printStackTrace(System.err);
 }} 
```

供您参考：[OutOfMemoryError](http://avishekarang.weebly.com/2/post/2009/09/outofmemoryerror-oome.html) 欢迎任何反馈。

阿维舍克阿朗

# c++ - Mac OS X：对于捆绑交付的游戏，我应该在哪里存储游戏存档？

> ID：511019
> 
> 赞同：2
> 
> 时间：2009-02-04T11:50:15.107
> 
> 标签：c++, macos

我正在将 Windows 游戏移植到 Mac OS X。我想知道应该在哪里存储游戏数据，例如保存的游戏、用户配置文件等，以及如何在 C++ 中以编程方式检索该路径？

游戏将作为[此处指定的“现代捆绑包”交付](http://developer.apple.com/documentation/CoreFOundation/Conceptual/CFBundles/Concepts/BundleAnatomy.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T11:55:48.077

将其保存在 ~/Library/Application Support/Your Game Name/

其中“~”代表玩游戏的用户的主目录。

您可能想阅读一下：[http ://cocoadevcentral.com/articles/000084.php](http://cocoadevcentral.com/articles/000084.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T11:55:18.607

```
~/图书馆/应用程序支持/游戏名称

```

您可以使用 Objective-C++ 访问 Cocoa 对象，这可以通过将源代码的后缀更改为`.mm`这使您能够结合 Objective-C 和 C++。

您可以使用几个[文件系统类。](http://developer.apple.com/documentation/Cocoa/Conceptual/LowLevelFileMgmt/index.html#//apple_ref/doc/uid/10000055i)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T20:34:21.630

我知道您已经接受了一个答案，但让我对以前的答案提出投诉：~/Library/Application Support 不是非技术用户查找数据文件的地方之一。您可能至少要考虑将它们放在 Documents 目录中的一个新文件夹中；即，~/Documents/MyGame。

# javascript - IE7 Ext JS problem: Unspecified JS error on window.close()

> ID：511020
> 
> 赞同：0
> 
> 时间：2009-02-04T11:50:21.363
> 
> 标签：javascript, internet-explorer-7, extjs

I am using Ext JS to make a popup window, here is the code:

```
function popupImage(term, imageNumber){

    if(currentPopupWindow!=null){
        currentPopupWindow.close();
    }

    currentPopupWindow = new Ext.Window({
                layout      : 'fit',
                closeAction :'hide',
                plain       : true,
                constrain   : true,
                width: 300,
                border: false,
                html: "Blah blah content"<span onclick=\"currentPopupWindow.close();\">cerrar</span>"
            });

    currentPopupWindow.show(false, function(){
        var el = Ext.get("termimage");
        currentPopupWindow.setWidth(el.getWidth(true)+150);
    });

    currentPopupWindow.anchorTo(Ext.get("dictionarycontainer"), "tl");
} 
```

In firefox this works fine. In IE7 it works, but always produces a javascript error saying "unspecified error".

What am I doing wrong?

## EDIT

Removing the anchorTo line removes the error. I would still like to anchor to though so this isn't a great solution!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T16:08:53.307

这是解决方案，虽然很愚蠢：

创建相同的窗口，然后代替调用显示和锚定到：

```
 currentPopupWindow.render(document.body);
    currentPopupWindow.alignTo(diccon, "tl", [40, 80]);

                currentPopupWindow.show(false, function() {
            var el = Ext.get(termim);
            currentPopupWindow.setWidth(el.getWidth(true)+150);
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T18:40:02.047

奎是对的。问题在于anchorTo。使用 alignTo 并且异常消失。对不起，我试图“提高”你的回应，但没能做到。我没有任何名声。:)

阿泰莱

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T14:09:37.853

快速的 Google 搜索告诉我，您不是唯一遇到此问题的 extJS 用户。（有关三个示例，请参见[此处](http://extjs.net/forum/showthread.php?t=36498)、[此处](http://extjs.com/forum/showthread.php?t=24481)和[此处](https://www.extjs.com/forum/showthread.php?p=121796)。）最好在他们的[论坛](http://extjs.net/forum/)上发帖，以便他们可以修复他们的错误或解决 IE7 错误，无论是哪种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T15:38:53.227

这个好像有关系，不是我理解的。。

[http://weblogs.asp.net/rajbk/archive/2006/11/29/ie-6-7-unspecified-error-when-accessing-offsetparent-javascript.aspx](http://weblogs.asp.net/rajbk/archive/2006/11/29/ie-6-7-unspecified-error-when-accessing-offsetparent-javascript.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T16:34:36.077

对于您的第二个问题：删除 anchorTo 行会删除错误。我仍然想锚定，所以这不是一个很好的解决方案！

使用 alignTo 并监视滚动和鼠标滚轮事件并相应地更新位置，它与 anchorTo 相同。这是我找到的解决方法。

阿泰莱

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-22T15:10:06.807

尝试添加：

`shim: false`

弹出窗口参数列表。

# c# - 如何在 WinForms 窗口中显示 PDF 或 Word 的 DOC/DOCX？

> ID：511046
> 
> 赞同：11
> 
> 时间：2009-02-04T11:56:18.993
> 
> 标签：c#, winforms, ms-word

我想知道在我的 c#winforms 应用程序中显示 pdf/doc 文档的最佳选择是什么。

此控件应该只允许显示预览。应该禁止编辑文件。

我正在寻找免费的解决方案。

最好的选择是将几个单独的 *.dll 附加到解决方案中，但这不是必需的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-04T12:11:10.213

通过利用 WinForms 的 WebBrowser 控件，我编写了一些可以为 Word 文档执行此操作的东西。希望它可能对你有好处：

[http://codinglight.blogspot.com/2008/10/simple-docbrowser-control.html](http://codinglight.blogspot.com/2008/10/simple-docbrowser-control.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T17:32:04.100

考虑使用 Vista、Windows 7 的预览处理程序。我使用了 Brad Smith 提供的代码（从评论中进行了更正）。

[http://www.brad-smith.info/blog/archives/79](http://www.brad-smith.info/blog/archives/79) - 在 Windows 窗体应用程序中托管预览处理程序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T12:15:30.720

通常建议的解决方案是在查看 PDF 的表单内使用 webbrowser 组件： [MSDN](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/b8c7a504-562f-4424-9ac3-bda3c640ca86/)

另一种方法是使用 Adob​​e Acrobat Reader 附带的 ActiveX 控件，但因此您需要 Adob​​e 的许可证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T13:34:10.590

您可以使用预览处理程序。CodeProject 上有一篇[WPF 文章](http://www.codeproject.com/KB/WPF/wpf_vista_preview_handler.aspx "WPF 预览处理程序")，如果你需要的话，它应该很容易翻译成 WinForms。

# css - IE7 CSS继承不起作用

> ID：511066
> 
> 赞同：34
> 
> 时间：2009-02-04T12:03:45.203
> 
> 标签：css, internet-explorer, internet-explorer-7

我已经为 h2 标签设置了一些样式（颜色、字体大小等），但是当我把“A”标签放在里面时，样式变成了链接。我的html：

```
<h2>
  <a class="no-decor" href="http://localhost/xxx/">Link</a>
</h2> 
```

因此，如您所见，我创建了“无装饰”类。它应该继承 h2 的“a”标签样式。

```
a.no-decor {
  color:inherit;
  font-family:inherit;
  font-size:inherit;
  font-weight:inherit;
  text-decoration:inherit;
} 
```

在 Firefox 上一切正常，但 IE 仍然显示标记“a”样式（下划线文本装饰和蓝色）。我知道，我可以为“h2 a”设置一些样式，但也许可以在 IE7 上强制工作 CSS 继承值？

PS On IE6 也不支持。

PPS 有一些类似的例子：[http ://www.brunildo.org/test/inherit.html](http://www.brunildo.org/test/inherit.html)

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-04T12:18:02.227

不，IE 从未支持`inherit`任何属性 - 抱歉。这已在 >= IE8 中修复。

虽然您可以使用 JavaScript 修复将属性从 to 复制`h2`，`a`但将相同的样式规则应用于两个元素可能是最简单的：

```
h2, h2 a {
    font: something;
    color: black;
    text-decoration: none;
} 
```

无论如何，您都不需要设置`inherit`text-decoration ，因为装饰不会从父级继承到子级：下划线效果在父级上并*通过*子级；孩子无法删除它（模 IE 错误）。孩子身上的“文字装饰：无”是正确的，除非你想要*两个*下划线......

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-04-06T19:13:42.607

尝试

```
a.no-decor{
  color:inherit;
  //color:expression(this.parentNode.currentStyle['color']);
  text-decoration:none;
} 
```

这将摆脱你的蓝色和下划线。您可以对下划线使用类似的表达式，但最好只使用 text-decoration:none 因为这就是继承的 text-decoration 无论如何都会给您，并且在不是绝对必要时无需使用表达式（您'使用表达式时会受到性能影响）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T12:12:19.617

一个错误就是一个错误，除了变通方法之外，您无能为力。

[这里](http://www.brunildo.org/test/inherit.html)有一个继承支持的测试。

您还可以尝试使用像[ie7-js](http://code.google.com/p/ie7-js/)这样的脚本，它*“是一个 JavaScript 库，可以让 Microsoft Internet Explorer 的行为类似于符合标准的浏览器”*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-19T09:10:33.263

Internet Explorer <= 7 版本不支持和`inherit`以外的任何属性的值。`direction``visibility`

# django - 如何在 django 模板中重复“块”

> ID：511067
> 
> 赞同：139
> 
> 时间：2009-02-04T12:04:28.697
> 
> 标签：django, django-templates, dry

我想在同一个 django 模板中使用相同的**{% block %}**两次。我希望这个块在我的基本模板中出现不止一次：

```
# base.html
<html>
    <head>
        <title>{% block title %}My Cool Website{% endblock %}</title>
    </head>
    <body>
        <h1>{% block title %}My Cool Website{% endblock %}</h1>
    </body>
</html> 
```

然后扩展它：

```
# blog.html
{% extends 'base.html' %}
{% block title %}My Blog{% endblock %}

# pictures.html
{% extends 'base.html' %}
{% block title %}My Pictures{% endblock %}

# cats.html
{% extends 'base.html' %}
{% block title %}My Cats{% endblock %} 
```

我会得到一个例外，因为 Django 希望该块只出现一次：

> **/ 处的模板语法错误**
> 
> **名称为“title”的“block”标签多次出现**

一个快速而肮脏的解决方案是将块*标题*复制到*title1*和*title2 中*：

```
# blog.html
{% extends 'base.html' %}
{% block title1 %}My Blog{% endblock %}
{% block title2 %}My Blog{% endblock %} 
```

但这违反了[DRY](http://docs.djangoproject.com/en/dev/misc/design-philosophies/#don-t-repeat-yourself-dry)原则。这会很困难，因为我有很多继承模板，也因为我不想下地狱 ;-)

这个问题有什么技巧或解决方法吗？如何在模板中重复相同的块，而不复制所有代码？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-09-22T19:09:07.590

使用 Django 模板宏插件：

[https://gist.github.com/1715202](https://gist.github.com/1715202) (django >= 1.4)

或者

[http://www.djangosnippets.org/snippets/363/](http://www.djangosnippets.org/snippets/363/) (django < 1.4)

## django >= 1.4

```
# base.html
{% kwacro title %}
    {% block title %}My Cool Website{% endblock %}
{% endkwacro %}

<html>
    <head>
        <title>{% usekwacro title %}</title>
    </head>
    <body>
        <h1>{% usekwacro title %}</h1>
    </body>
</html> 
```

和

```
# blog.html
{% extends 'base.html' %}
{% block title %}My Blog{% endblock %} 
```

## django < 1.4

```
# base.html
{% macro title %}
    {% block title %}My Cool Website{% endblock %}
{% endmacro %}

<html>
    <head>
        <title>{% usemacro title %}</title>
    </head>
    <body>
        <h1>{% usemacro title %}</h1>
    </body>
</html> 
```

和

```
# blog.html
{% extends 'base.html' %}
{% block title %}My Blog{% endblock %} 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-04-27T14:35:24.957

我认为在这种情况下使用上下文处理器是一种矫枉过正。您可以轻松地做到这一点：

```
#base.html
<html>
    <head>
        <title>{% block title %}My Cool Website{% endblock %}</title>
    </head>
    <body>
        {% block content %}{% endblock %}
    </body>
</html> 
```

进而：

```
# blog.html
{% extends 'base.html' %}
{% block content %}
    <h1>{% block title %}My Blog{% endblock %}</h1>
    Lorem ipsum here...
{% endblock %} 
```

等等......看起来像DRY兼容。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-02-04T12:19:08.823

您可能实际上不想使用块，而只想使用变量：

```
# base.html
<html>
    <head>
        <title>{{ title|default:"My Cool Website" }}</title>
    </head>
    <body>
        <h1>{{ title|default:"My Cool Website" }}</h1>
    </body>
</html> 
```

然后通过上下文设置标题。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-09-27T14:39:41.623

这是我自己尝试做同样事情时发现的一种方法：

```
# base_helper.html
<html>
    <head>
        <title>{% block _title1 %}{% endblock %}</title>
    </head>
    <body>
        <h1>{% block _title2 %}{% endblock %}</h1>
    </body>
</html>

# base.html
{% extends "base_helper.html" %}

# Copy title into _title1 & _title2, using "My Cool Website" as a default.
{% block _title1 %}{% block _title2 %}{% block title %}My Cool Website{% endblock %}{% endblock %}{% endblock %} 
```

不幸的是，需要一个额外的文件，但不需要您从视图中传递标题。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-04T12:31:44.243

您可以`{% include subtemplate.html %}`多次使用。它与块不同，但可以解决问题。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-01-23T05:47:20.063

这里有一些讨论：http: [//code.djangoproject.com/ticket/4529](http://code.djangoproject.com/ticket/4529) 显然 django 核心团队拒绝了这张票，因为他们认为这不是一个常用的场景，但我不同意。

重复块是简单而干净的实现： [https ://github.com/SmileyChris/django-repeatblock](https://github.com/SmileyChris/django-repeatblock)

模板宏是另一个，但是作者提到它没有经过仔细测试： http: [//www.djangosnippets.org/snippets/363/](http://www.djangosnippets.org/snippets/363/)

我使用了重复块。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-10-03T06:01:00.257

作为遇到此问题的任何人的更新，我将上面提到的代码片段转换为模板标签库 django-macros，使宏更强大，并且还显式地实现了重复块模式：[django-macros](https://github.com/nalourie/django-macros)。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-01-10T22:34:22.533

这是一个类似于上述`do_set`和`do_get`模板标签答案的轻量级解决方案。Django 允许您将整个模板上下文传递到一个标签中，该标签可以让您定义一个全局变量。

base.html：

```
<!DOCTYPE html>
<html lang="en">
<head>
  {% block head %}
    <title>{{ title }}</title>
  {% endblock %}
</head>
<body>
  <h1>{{ title }}</h1>
</body>
</html> 
```

page.html：

```
{% extends "base.html" %}

{% block head %}
  {% define 'title' 'Homepage | title' %}
  {{ block.super }}
{% endblock %} 
```

自定义标签（在这里得到了想法：[https](https://stackoverflow.com/a/33564990/2747924) ://stackoverflow.com/a/33564990/2747924 ）：

```
@register.simple_tag(takes_context=True)
def define(context, key, value):
    context.dicts[0][key] = value
    return '' 
```

另外不要忘记`{% load %}`您的自定义标签或将它们添加到模板选项[内置](https://docs.djangoproject.com/en/1.10/ref/templates/builtins/)列表中，这样您就不必在每个模板中加载它们。这种方法的唯一限制是`{% define %}`必须从块标签内调用，因为子模板只呈现与父标签匹配的块标签。不确定是否有解决方法。还要确保`define`在您尝试明显使用它之前来电。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-01-08T18:34:17.493

根据 Van Gale 的建议，您可以通过将以下内容添加到您的 templatetags.py 文件来创建 get 和 set 标签：

```
register = template.Library()

Stateful = {}
def do_set(parser, token):
    _, key = token.split_contents()
    nodelist = parser.parse(('endset',))
    parser.delete_first_token()  # from the example -- why?
    return SetStatefulNode(key,nodelist)

class SetStatefulNode(template.Node):
    def __init__(self, key, nodes):
        Stateful[key] = nodes
    def render(self, context):
        return ''
register.tag('set', do_set)

def do_get(parser, token):
    tag_name, key = token.split_contents()
    return GetStatefulNode(key)

class GetStatefulNode(template.Node):
    def __init__(self, key):
       self.key = key
    def render(self, context):
        return ''.join( [x.render(context) for x in Stateful[self.key]] )

register.tag('get', do_get) 
```

然后通过在一个模板中设置值并在另一个模板中`{% set foo %}put data here{% endset %}`获取它们`{% get foo %}`。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-03-23T18:48:04.487

我也遇到了在我的模板文件中重复 {% block %} 的同样需要。问题是我希望在 Django 条件的任何一种情况下都使用 Django {% block %}，并且我希望 {% block %} 可以被可能扩展当前文件的后续文件覆盖。（所以在这种情况下，我想要的绝对是一个块而不是一个变量，因为我在技术上没有重复使用它，它只是出现在条件的两端。

**问题：**

以下 Django 模板代码将导致模板语法错误，但我认为在条件中重新使用定义的 {% block %} 是有效的“想要”（IE，为什么 Django 解析器在两端都验证语法的条件，它不应该只验证真实的条件吗？）

```
# This example shows a {{ DEBUG }} conditional that loads 
#   Uncompressed JavaScript files if TRUE 
#   and loads Asynchronous minified JavaScript files if FALSE.  

# BASE.html
{% if DEBUG %}
    <script src="{{MEDIA_URL}}js/flatfile.1.js"></script>
    <script src="{{MEDIA_URL}}js/flatfile.2.js"></script>
    <script src="{{MEDIA_URL}}js/flatfile.3.js"></script>
    <script type="text/javascript">
        {% block page_js %}
            var page = new $site.Page();
        {% endblock page_js %}
    </script>
{% else %}
    <script type="text/javascript">
        // load in the PRODUCTION VERSION of the site
        // minified and asynchronosly loaded
        yepnope([
            {
                load : '{MEDIA_URL}}js/flatfiles.min.js',
                wait : true,
                complete : function() {
                    {% block page_js %} // NOTE THE PAGE_JS BLOCK
                        var page = new $site.Page();
                    {% endblock page_js %}
                }
            }
        )];
    </script>
{% endif %}

# ABOUT.html
{% extends 'pages/base.html' %}
{% block page_js %}
var page = new $site.Page.About();
{% endblock page_js %} 
```

**解决方案：**

您可以使用 {% include %} 有条件地多次插入 {% block %}。这对我有用，因为 Django 语法检查器仅包含 TRUTHY {% include %}。看下面的结果：

```
# partials/page.js
{% block page_js %}
    var page = new $site.Page();    
{% endblock %}

# base.html
{% if DEBUG %}
    <script src="{{MEDIA_URL}}js/flatfile.1.js"></script>
    <script src="{{MEDIA_URL}}js/flatfile.2.js"></script>
    <script src="{{MEDIA_URL}}js/flatfile.3.js"></script>
    <script type="text/javascript">
        {% include 'partials/page_js.html' %}
    </script>
{% else %}
    <script type="text/javascript">
        yepnope([
            {
                load : '{MEDIA_URL}}js/flatfiles.min.js',
                wait : true,
                complete : function() {
                    {% include 'partials/page_js.html' %}
                }
            }
        )];
    </script>
{% endif %} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-01-19T21:30:24.907

我用[这个答案](https://stackoverflow.com/a/1179976/456550)来保持干燥。

```
{% extends "base.html" %}

{% with "Entry Title" as title %}
    {% block title %}{{ title }}{% endblock %}
    {% block h1 %}{{ title }}{% endblock %}
{% endwith %} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-04T12:20:05.703

有两个简单的解决方案。

最简单的方法是将您的标题放入上下文变量中。您将在视图中设置上下文变量。

如果您使用的是通用视图之类的东西，并且没有用于图片、猫等的 views.py，那么您可以采用[在 context 中设置变量的自定义模板标签](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/#setting-a-variable-in-the-context)的方式。

走这条路线将使您能够执行以下操作：

```
{% extends "base.html" %}
{% load set_page_title %}
{% page_title "My Pictures" %}
... 
```

然后在你的 base.html 中：

```
...
{% block title %}{{ page_title }}{% endblock %}
...
<h1>{{ page_title }}</h1> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-12-17T17:00:26.950

选定的答案暗示了一种简单的解决方法，即在子模板中将一个标签包装在另一个标签内，以赋予它们相同的值。我将它用于这样的社交图像。

子模板：

```
{% extends 'base.html' %}
...
{% block meta_image %}
{% block meta_image_secure %}
{% if object.cover_pic %}
{{ object.cover_pic.url }}
{% else %}
https://live-static.welovemicro.com/static/img/device-dark.png
{% endif %}
{% endblock %}
{% endblock %}
... 
```

然后在父母中`base.html`：

```
...
<meta property="og:image" itemprop="image" content="{% block meta_image %}https://live-static.welovemicro.com/static/img/device-dark.png{% endblock %}">
<meta property="og:image:secure_url" itemprop="image" content="{% block meta_image_secure %}https://live-static.welovemicro.com/static/img/device-dark.png{% endblock %}">
... 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2011-09-01T06:22:28.267

在[树枝](http://www.twig-project.org)中，您可以这样做：

```
# base.html
<html>
    <head>
        <title>{{ block('title') }}</title>
    </head>
    <body>
        <h1>{{ block('title') }}</h1>
    </body>
</html>

# blog.html
{% extends 'base.html' %}
{% block title %}My Blog{% endblock %}

# pictures.html
{% extends 'base.html' %}
{% block title %}My Pictures{% endblock %}

# cats.html
{% extends 'base.html' %}
{% block title %}My Cats{% endblock %} 
```

# drupal - 如何根据在 nodereference 内部对节点进行不同的主题化

> ID：511076
> 
> 赞同：0
> 
> 时间：2009-02-04T12:06:40.800
> 
> 标签：drupal, themes, cck

我正在创建一个通讯内容类型，它应该使用 nodereference 字段链接其故事。当故事出现在时事通讯中时，我有一个主题，而当它们出现在普通视图或他们自己的页面中时，我会为它们设置一个主题。

我有两个原因：

1.  稍后我想通过邮件发送时事通讯，我必须将所有样式设置为内联。
2.  我想删除出现在每个节点下方的某些链接，例如*添加评论*或*发送给朋友*，并将它们仅用于整个时事通讯。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-07T05:31:30.733

那么，您如何为时事通讯输出故事节点？您是在调用 node_view(node_load($story_nid)) 还是 newsletter.tpl.php 中的内容？如果你是，你可以向节点对象添加一个标志，然后你可以在 story.tpl 中检查，比如

```
$story_node_data = node_load($story_reference_nid);
// can't remember whcih way you would do this: either
$story_node_data->from_newsletter = true;
// or
$story_node_data['from_newsletter'] = true; 
```

然后在story.tpl

```
if ($node->['from_newsletter']){
  //do things
}else{
  //do other things 
```

# asp.net - 使用 ASP.NET Ajax 库向页面动态添加控件

> ID：511082
> 
> 赞同：1
> 
> 时间：2009-02-04T12:08:44.383
> 
> 标签：asp.net, javascript, ajax

是否可以使用 ASP.NET Ajax 库 (Sys....) 向页面添加控件。例如在 JQuery 中我会执行

```
$("#mydiv").append($("#anotherdiv input")); 
```

或类似的东西。如果可能的话，我想在不将所有内容包装在 UpdatePanel 中的情况下执行此操作，最好是通过客户端脚本。但我有一种感觉，这会混淆 ViewState。

注意这不是[这篇文章](https://stackoverflow.com/questions/113392/dynamically-added-controls-in-asp-net)的欺骗，这是关于不同的东西。

**我正在尽可能地关闭它，但是它很繁琐。ASP.NET AJAX in Action 的第 10 章稍微介绍了它。没有部分回发虽然这是不可能的**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T15:32:59.650

你的正确——据我所知，它会混淆视图状态，因为所有控件都需要在 OnInit() 方法期间或之前出现在页面上。

然而，您仍然可以使用一些 jQuery/Ajax 来拉回呈现的控件。例如，假设您有一个“帮助”页面“MyControlsOutput.aspx”，并且在该页面上，您将控件嵌入其中，即“”。然后，理论上，您可以使用 jQuery 查询 MyControlsOutput.aspx 页面，并将响应文本返回到您的页面。同样，它不会在您的 ASP.Net 页面的控件集合中，也不会对您的视图状态有任何线索。所以，这可能不是你要找的，但这只是一个想法。

...在编写上述内容时，我在 Google 上快速搜索了“asp.net ajax 加载控制”。看看这是否有帮助（你可能已经看过了，如果是这样的话，抱歉）：

[http://weblogs.asp.net/sanjeevagarwal/archive/2008/07/22/Dynamically-create-ASP.NET-user-control-using-ASP.NET-Ajax-and-Web-Service.aspx](http://weblogs.asp.net/sanjeevagarwal/archive/2008/07/22/Dynamically-create-ASP.NET-user-control-using-ASP.NET-Ajax-and-Web-Service.aspx)

这是一个类似的概念，但看起来他们正在使用 ASP.Net 的 ajax 调用，并将其加载到页面的控件集合中，并让它也使用页面的视图状态。不会受伤吧？:)

希望能有所帮助。祝你好运。

# sql - 按日期将文件从一个目录复制到另一个目录

> ID：511086
> 
> 赞同：3
> 
> 时间：2009-02-04T12:10:37.670
> 
> 标签：sql, sql-server, xp-cmdshell

我有这个 SQL 作业（在 SQL Server 2005 中）每六 (6) 小时创建一次备份，备份的文件名基于时间戳，因此它将创建一个唯一的文件名（dbname_yyyymmddhhmmss.bak），现在我的问题是，如何如果文件是三天前的并且基于我的脚本我想删除三天前的备份（.bak），我会知道使用 xp_cmdshell 吗？有人可以帮助我吗，在此先感谢。干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T14:04:57.847

我同意 xp_cmdshell 不是这项工作的最佳选择。如果你像我一样不喜欢/不信任维护计划，你可能可以编写一个 C# 控制台应用程序，其中文件系统支持比你在 DOS 中所做的要强得多（或使用 T-SQL 来解析输出） xp_cmdshell 'DIR ...'），然后将其安排在 Windows 计划任务中，这样您就不必担心 SQL Server 服务/代理帐户的权限升级。虽然把所有东西都放在一个包裹里很好，但你并不总是希望换油的人给你做一个乳蛋饼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T12:29:48.350

这并不是真正适合 xp_cmdshell 的任务。在 SQL Server 中启用此功能也有安全隐患。

您希望实现的目标更适合 SQL Server Integration Services (SSIS)。有可用于管理和执行备份的组件，以及可用于移动和删除数据的文件系统任务组件。

您可以使用文件系统任务、变量和表达式的组合来检索备份文件名、提取日期组件并确定文件的年龄。然后，您可以对文件采取适当的措施。

我希望这会有所帮助，但如果您需要更多信息，请随时提出更多问题。

干杯，约翰

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T12:33:51.617

这并不是您问题的真正答案，但您可以使用维护计划（对象资源管理器 -> 管理 -> 维护计划）直接在 SqlServer 2005 中执行此操作。

我通常会创建一个维护计划，其中包括两项任务：一项“维护清理任务”会在 x 天后删除旧备份，然后是一项“备份数据库任务”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T12:43:50.177

您可以编写一个 .NET 程序集并从 SQL Server 中调用它。编写它相当容易，以便表值函数返回某个目录中的所有文件，并带有文件名和文件日期戳。

# javascript - 使用 JavaScript 将光标放在文本输入元素中的文本末尾

> ID：511088
> 
> 赞同：364
> 
> 时间：2009-02-04T12:11:38.667
> 
> 标签：javascript

通过 JavaScript 将光标放在输入文本元素中的文本末尾的最佳方法（我认为是最简单的方法）是什么 - 在将焦点设置为元素之后？

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2012-05-14T00:46:51.700

有一种简单的方法可以让它在*大多数*浏览器中运行。

```
this.selectionStart = this.selectionEnd = this.value.length; 
```

然而，由于一些浏览器的 *quirks，一个更具包容性的答案看起来更像这样

```
setTimeout(function(){ that.selectionStart = that.selectionEnd = 10000; }, 0); 
```

**使用 jQuery** *（设置监听器，但没有必要）*

```
$('#el').focus(function(){
  var that = this;
  setTimeout(function(){ that.selectionStart = that.selectionEnd = 10000; }, 0);
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input id='el' type='text' value='put cursor at end'>
```

**使用 Vanilla JS （从** *[这个答案](https://stackoverflow.com/a/10150042/731314)**中借用`addEvent`函数）*

```
// Basic cross browser addEvent
function addEvent(elem, event, fn){
if(elem.addEventListener){
  elem.addEventListener(event, fn, false);
}else{
  elem.attachEvent("on" + event,
  function(){ return(fn.call(elem, window.event)); });
}}
var element = document.getElementById('el');

addEvent(element,'focus',function(){
  var that = this;
  setTimeout(function(){ that.selectionStart = that.selectionEnd = 10000; }, 0);
});
```

```
<input id='el' type='text' value='put cursor at end'>
```

* * *

## 怪癖

Chrome有一个奇怪的怪癖，焦点事件在光标移动到字段之前触发；这搞砸了我的简单解决方案。解决此问题的两个选项：

1.  您可以添加 0 毫秒的超时（将[操作推迟到堆栈清除](https://youtu.be/8aGhZQkoFbQ?t=15m13s)）
2.  您可以将事件从 更改`focus`为`mouseup`。除非您仍然跟踪焦点，否则这对用户来说会很烦人。我并不真正爱上这两种选择。

此外，@vladkras 指出，一些旧版本的 Opera 在有空格时会错误地计算长度。为此，您可以使用应该大于字符串的巨大数字。

* * *

## 回答 #2

> 赞同：188
> 
> 时间：2010-02-27T01:39:50.857

试试这个，它对我有用：

```
//input is the input element

input.focus(); //sets focus to element
var val = this.input.value; //store the value of the element
this.input.value = ''; //clear the value of the element
this.input.value = val; //set that value back. 
```

为了使光标移动到末尾，输入必须首先具有焦点，然后当值更改时，它将转到末尾。如果您将 .value 设置为相同，它不会在 chrome 中更改。

* * *

## 回答 #3

> 赞同：187
> 
> 时间：2009-04-10T00:16:15.273

我在 IE 中遇到了同样的问题（在通过 RJS/原型设置焦点之后）。当该字段已经有值时，Firefox 已经将光标留在了末尾。IE 将光标强制到文本的开头。

我得出的解决方案如下：

```
<input id="search" type="text" value="mycurrtext" size="30" 
       onfocus="this.value = this.value;" name="search"/> 
```

这适用于 IE7 和 FF3

* * *

## 回答 #4

> 赞同：100
> 
> 时间：2009-11-04T17:21:26.420

经过一番修改后，我发现最好的方法是`setSelectionRange`在浏览器支持的情况下使用该功能；如果没有，请恢复使用 Mike Berrow 答案中的方法（即用自身替换值）。

`scrollTop`如果我们处于垂直滚动状态，我也会设置为高值`textarea`。（使用任意高值似乎比`$(this).height()`在 Firefox 和 Chrome 中更可靠。）

我已经把它作为一个 jQuery 插件。（如果您不使用 jQuery，我相信您仍然可以轻松掌握要点。）

我在 IE6、IE7、IE8、Firefox 3.5.5、Google Chrome 3.0、Safari 4.0.4、Opera 10.00 中进行了测试。

它在 jquery.com 上作为[PutCursorAtEnd 插件](http://plugins.jquery.com/project/PutCursorAtEnd)提供。为方便起见，1.0 版本的代码如下：

```
// jQuery plugin: PutCursorAtEnd 1.0
// http://plugins.jquery.com/project/PutCursorAtEnd
// by teedyay
//
// Puts the cursor at the end of a textbox/ textarea

// codesnippet: 691e18b1-f4f9-41b4-8fe8-bc8ee51b48d4
(function($)
{
    jQuery.fn.putCursorAtEnd = function()
    {
    return this.each(function()
    {
        $(this).focus()

        // If this function exists...
        if (this.setSelectionRange)
        {
        // ... then use it
        // (Doesn't work in IE)

        // Double the length because Opera is inconsistent about whether a carriage return is one character or two. Sigh.
        var len = $(this).val().length * 2;
        this.setSelectionRange(len, len);
        }
        else
        {
        // ... otherwise replace the contents with itself
        // (Doesn't work in Google Chrome)
        $(this).val($(this).val());
        }

        // Scroll to the bottom, in case we're in a tall textarea
        // (Necessary for Firefox and Google Chrome)
        this.scrollTop = 999999;
    });
    };
})(jQuery); 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2011-09-16T13:27:22.993

```
<script type="text/javascript">  
    function SetEnd(txt) {  
      if (txt.createTextRange) {  
       //IE  
       var FieldRange = txt.createTextRange();  
       FieldRange.moveStart('character', txt.value.length);  
       FieldRange.collapse();  
       FieldRange.select();  
       }  
      else {  
       //Firefox and Opera  
       txt.focus();  
       var length = txt.value.length;  
       txt.setSelectionRange(length, length);  
      }  
    }   
</script> 
```

此功能适用于 IE9、Firefox 6.x 和 Opera 11.x

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2019-06-02T16:08:16.443

现在是 2019 年，上述方法都不适用于我，但这个方法有效，取自[https://css-tricks.com/snippets/javascript/move-cursor-to-end-of-input/](https://css-tricks.com/snippets/javascript/move-cursor-to-end-of-input/)

```
function moveCursorToEnd(id) {
  var el = document.getElementById(id) 
  el.focus()
  if (typeof el.selectionStart == "number") {
      el.selectionStart = el.selectionEnd = el.value.length;
  } else if (typeof el.createTextRange != "undefined") {           
      var range = el.createTextRange();
      range.collapse(false);
      range.select();
  }
}
```

```
<input id="myinput" type="text" />
<a href="#" onclick="moveCursorToEnd('myinput')">Move cursor to end</a>
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2012-01-10T14:55:59.297

我在 chrome 中尝试了以下方法并取得了相当大的成功

```
$("input.focus").focus(function () {
    var val = this.value,
        $this = $(this);
    $this.val("");

    setTimeout(function () {
        $this.val(val);
    }, 1);
}); 
```

快速概述：

它采用类焦点的每个输入字段，然后将输入字段的旧值存储在一个变量中，然后将空字符串应用于输入字段。

然后它等待 1 毫秒并再次输入旧值。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2019-06-22T23:42:05.247

`el.setSelectionRange(-1, -1);`

[https://codesandbox.io/s/peaceful-bash-x2mti](https://codesandbox.io/s/peaceful-bash-x2mti)

> 此方法在一次调用中更新 HTMLInputElement.selectionStart、selectionEnd 和 selectionDirection 属性。

[https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange](https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange)

在其他 js 方法`-1`中，通常意味着（到）最后一个字符。这也是这种情况，但我在文档中找不到明确提及这种行为。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2015-11-14T06:12:45.617

简单的。编辑或更改值时，首先放置焦点，然后设置值。

```
$("#catg_name").focus();
$("#catg_name").val(catg_name); 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2011-02-15T15:02:30.393

仍然需要中间变量，（请参阅 var val=）否则游标的行为很奇怪，我们最后需要它。

```
<body onload="document.getElementById('userinput').focus();">
<form>
<input id="userinput" onfocus="var val=this.value; this.value=''; this.value= val;"
         class=large type="text" size="10" maxlength="50" value="beans" name="myinput">
</form>
</body> 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2014-11-13T03:37:40.127

对于所有情况下的所有浏览器：

```
function moveCursorToEnd(el) {
    window.setTimeout(function () {
            if (typeof el.selectionStart == "number") {
            el.selectionStart = el.selectionEnd = el.value.length;
        } else if (typeof el.createTextRange != "undefined") {
            var range = el.createTextRange();
            range.collapse(false);
            range.select();
        }
    }, 1);
} 
```

*如果您需要从 onFocus 事件处理程序移动光标，则需要超时*

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2018-02-23T11:41:57.540

我非常喜欢接受的答案，但它在 Chrome 中停止工作。在 Chrome 中，要使光标走到末尾，输入值需要更改。解决方法如下：

```
<input id="search" type="text" value="mycurrtext" size="30" 
   onfocus="var value = this.value; this.value = null; this.value = value;" name="search"/> 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2020-05-11T08:21:51.090

试试这个适用于 Vanilla JavaScript。

```
<input type="text" id="yourId" onfocus=" let value = this.value; this.value = null; this.value=value" name="nameYouWant" class="yourClass" value="yourValue" placeholder="yourPlaceholder..."> 
```

在 Js 中

```
document.getElementById("yourId").focus() 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2021-02-19T06:14:10.600

```
const end = input.value.length

input.setSelectionRange(end, end)
//  scroll to the bottom if a textarea has long text
input.focus() 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2010-03-01T12:18:40.530

在 jQuery 中，这是

```
$(document).ready(function () {
  $('input').focus(function () {
    $(this).attr('value',$(this).attr('value'));
  }
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2016-03-03T13:51:06.990

这个问题很有趣。最令人困惑的是，我没有找到完全解决问题的解决方案。

+++++++ 解决方案 +++++++

1.  你需要一个 JS 函数，像这样：

    ```
    function moveCursorToEnd(obj) {

      if (!(obj.updating)) {
        obj.updating = true;
        var oldValue = obj.value;
        obj.value = '';
        setTimeout(function(){ obj.value = oldValue; obj.updating = false; }, 100);
      }

    } 
    ```

2.  你需要在 onfocus 和 onclick 事件中调用这个人。

    ```
    <input type="text" value="Test Field" onfocus="moveCursorToEnd(this)" onclick="moveCursorToEnd(this)"> 
    ```

它适用于所有设备和浏览器！！！！

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-10-09T17:56:46.900

我刚刚发现在iOS中，设置`textarea.textContent`属性每次都会将光标放在textarea元素中的文本末尾。该行为是我的应用程序中的一个错误，但似乎是您可以有意使用的东西。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-05-21T07:30:54.000

```
var valsrch = $('#search').val();
$('#search').val('').focus().val(valsrch); 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2016-10-29T21:23:11.000

采取一些答案..制作单行jquery。

```
$('#search').focus().val($('#search').val()); 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-07-27T15:10:34.033

如果输入字段只需要一个静态默认值，我通常使用 jQuery 执行此操作：

```
$('#input').focus().val('Default value'); 
```

这似乎适用于所有浏览器。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2017-04-16T20:47:19.040

虽然这可能是一个有很多答案的老问题，但我遇到了一个类似的问题，没有一个答案是我想要的和/或没有得到很好的解释。selectionStart 和 selectionEnd 属性的问题在于它们对于输入类型编号不存在（虽然问题是针对文本类型提出的，但我认为它可能会帮助其他可能需要关注其他输入类型的人）。因此，如果您不知道函数将关注的输入类型是否为类型编号，则无法使用该解决方案。

跨浏览器并适用于所有输入类型的解决方案相当简单：

*   获取输入的值并将其存储在变量中
*   聚焦输入
*   将输入的值设置为存储的值

这样光标就位于输入元素的末尾。
因此，您要做的就是这样（使用jquery，只要可以通过单击元素的“data-focus-element”数据属性访问希望聚焦的元素选择器，并且该函数在单击“.foo”后执行）元素）：

```
$('.foo').click(function() {
    element_selector = $(this).attr('data-focus-element');
    $focus = $(element_selector);
    value = $focus.val();
    $focus.focus();
    $focus.val(value);
}); 
```

为什么这行得通？简单地说，当调用 .focus() 时，焦点将被添加到输入元素的开头（这是这里的核心问题），忽略了输入元素已经有值的事实。但是，当输入的值发生更改时，光标会自动放置在输入元素内的值的末尾。因此，如果您使用先前在输入中输入的相同值覆盖该值，则该值将看起来未触及，但是光标将移动到末尾。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-01-03T19:30:40.147

```
document.querySelector('input').addEventListener('focus', e => {
  const { value } = e.target;
  e.target.setSelectionRange(value.length, value.length);
});
```

```
<input value="my text" />
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2011-05-19T09:33:23.777

单击文本区域时将光标设置到文本末尾...此代码的变体是...也有效！适用于火狐、IE、Safari、Chrome..

在服务器端代码中：

```
txtAddNoteMessage.Attributes.Add("onClick", "sendCursorToEnd('" & txtAddNoteMessage.ClientID & "');") 
```

在 Javascript 中：

```
function sendCursorToEnd(obj) {
    var value =  $(obj).val(); //store the value of the element
    var message = "";
    if (value != "") {
        message = value + "\n";
     };
    $(obj).focus().val(message);
    $(obj).unbind();
 } 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-06-05T21:42:02.770

如果先设置值再设置焦点，光标将始终出现在末尾。

```
$("#search-button").click(function (event) {
    event.preventDefault();
    $('#textbox').val('this');
    $("#textbox").focus();
    return false;
}); 
```

这是测试 [https://jsfiddle.net/5on50caf/1/的小提琴](https://jsfiddle.net/5on50caf/1/)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-08-14T16:28:02.187

我想将光标放在 contenteditable = true 的“div”元素的末尾，我得到了[Xeoncross 代码](https://jsfiddle.net/Xeoncross/4tUDk/)的解决方案：

```
<input type="button" value="Paste HTML" onclick="document.getElementById('test').focus(); pasteHtmlAtCaret('<b>INSERTED</b>'); ">

<div id="test" contenteditable="true">
    Here is some nice text
</div> 
```

这个函数很神奇：

```
 function pasteHtmlAtCaret(html) {
    var sel, range;
    if (window.getSelection) {
        // IE9 and non-IE
        sel = window.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();

            // Range.createContextualFragment() would be useful here but is
            // non-standard and not supported in all browsers (IE9, for one)
            var el = document.createElement("div");
            el.innerHTML = html;
            var frag = document.createDocumentFragment(), node, lastNode;
            while ( (node = el.firstChild) ) {
                lastNode = frag.appendChild(node);
            }
            range.insertNode(frag);

            // Preserve the selection
            if (lastNode) {
                range = range.cloneRange();
                range.setStartAfter(lastNode);
                range.collapse(true);
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }
    } else if (document.selection && document.selection.type != "Control") {
        // IE < 9
        document.selection.createRange().pasteHTML(html);
    }
} 
```

适用于大多数浏览器，请检查一下，此代码将文本放在 div 元素（不是输入元素）中文本的末尾

[https://jsfiddle.net/Xeoncross/4tUDk/](https://jsfiddle.net/Xeoncross/4tUDk/)

谢谢，至强克罗斯

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-09-28T06:42:47.653

我也面临同样的问题。最后这对我有用：

```
jQuery.fn.putCursorAtEnd =  = function() {

  return this.each(function() {

    // Cache references
    var $el = $(this),
        el = this;

    // Only focus if input isn't already
    if (!$el.is(":focus")) {
     $el.focus();
    }

    // If this function exists... (IE 9+)
    if (el.setSelectionRange) {

      // Double the length because Opera is inconsistent about whether a carriage return is one character or two.
      var len = $el.val().length * 2;

      // Timeout seems to be required for Blink
      setTimeout(function() {
        el.setSelectionRange(len, len);
      }, 1);

    } else {

      // As a fallback, replace the contents with itself
      // Doesn't work in Chrome, but Chrome supports setSelectionRange
      $el.val($el.val());

    }

    // Scroll to the bottom, in case we're in a tall textarea
    // (Necessary for Firefox and Chrome)
    this.scrollTop = 999999;

  });

}; 
```

我们可以这样称呼它：

```
var searchInput = $("#searchInputOrTextarea");

searchInput
  .putCursorAtEnd() // should be chainable
  .on("focus", function() { // could be on any event
    searchInput.putCursorAtEnd()
  }); 
```

它适用于 safari、IE、Chrome、Mozilla。在移动设备上我没有尝试过。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-03-13T01:34:55.190

## 检查此解决方案！

```
//fn setCurPosition
$.fn.setCurPosition = function(pos) {
    this.focus();
    this.each(function(index, elem) {
        if (elem.setSelectionRange) {
            elem.setSelectionRange(pos, pos);
        } else if (elem.createTextRange) {
            var range = elem.createTextRange();
            range.collapse(true);
            range.moveEnd('character', pos);
            range.moveStart('character', pos);
            range.select();
        }
    });
    return this;
};

// USAGE - Set Cursor ends
$('#str1').setCurPosition($('#str1').val().length);

// USAGE - Set Cursor at 7 position
// $('#str2').setCurPosition(7);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<p>Set cursor at any position</p>
<p><input type="text" id="str1" value="my string here" /></p>
<p><input type="text" id="str2" value="my string here" /></p>
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-04-30T18:22:35.797

超级简单（您可能必须专注于输入元素）

```
inputEl = getElementById('inputId');
var temp = inputEl.value;
inputEl.value = '';
inputEl.value = temp; 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2011-02-23T10:44:48.907

我之前尝试过这些建议，但没有一个对我有用（在 Chrome 中测试过），所以我编写了自己的代码 - 它在 Firefox、IE、Safari、Chrome 中运行良好......

在文本区域：

```
onfocus() = sendCursorToEnd(this); 
```

在 Javascript 中：

```
function sendCursorToEnd(obj) { 
var value = obj.value; //store the value of the element
var message = "";
if (value != "") {
    message = value + "\n";
};
$(obj).focus().val(message);} 
```

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2012-06-01T15:54:18.567

这是我的答案的[jsFiddle 演示](http://jsfiddle.net/MEPBA/)。该演示使用 CoffeeScript，但如果需要，您可以[将其转换为纯 JavaScript 。](http://coffeescript.org/#try%3amoveCursorToEnd%20%3D%20%28textField%29%20-%3E%0A%20%20endIndex%20%3D%20textField.value.length%0A%20%20if%20textField.setSelectionRange%0A%20%20%20%20textField.setSelectionRange%28endIndex%2C%20endIndex%29%0A%0AjQuery%20-%3E%0A%20%20%24%28%27.that-field%27%29.on%20%27click%27%2C%20-%3E%0A%20%20%20%20moveCursorToEnd%28this%29)

JavaScript 中的重要部分：

```
var endIndex = textField.value.length;
if (textField.setSelectionRange) {
   textField.setSelectionRange(endIndex, endIndex);
} 
```

我发布这个答案是因为我已经为有同样问题的其他人写了它。这个答案没有像这里的顶级答案那样涵盖尽可能多的边缘情况，但它对我有用，并且有一个你可以玩的 jsFiddle 演示。

这是来自 jsFiddle 的代码，因此即使 jsFiddle 消失，这个答案也会保留：

```
moveCursorToEnd = (textField) ->
  endIndex = textField.value.length
  if textField.setSelectionRange
    textField.setSelectionRange(endIndex, endIndex)

jQuery ->
  $('.that-field').on 'click', ->
    moveCursorToEnd(this) 
```

```
<div class="field">
    <label for="pressure">Blood pressure</label>:
    <input class="that-field" type="text" name="pressure" id="pressure" value="24">
</div>
<p>
    Try clicking in the text field. The cursor will always jump to the end.
</p> 
```

```
body {
    margin: 1em;
}

.field {
    margin-bottom: 1em;
} 
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2015-03-09T16:21:04.040

试试下面的代码：

```
$('input').focus(function () {
    $(this).val($(this).val());
}).focus() 
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2018-09-11T06:31:35.693

虽然我回答得太晚了，但对于将来的查询，它会有所帮助。它也适用于`contenteditable`div。

从哪里你需要在最后设置焦点；写下这段代码——

```
var el = document.getElementById("your_element_id");
placeCaretAtEnd(el); 
```

功能是 -

```
function placeCaretAtEnd(el) {
    el.focus();
    if (typeof window.getSelection != "undefined"
            && typeof document.createRange != "undefined") {
        var range = document.createRange();
        range.selectNodeContents(el);
        range.collapse(false);
        var sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
    } else if (typeof document.body.createTextRange != "undefined") {
        var textRange = document.body.createTextRange();
        textRange.moveToElementText(el);
        textRange.collapse(false);
        textRange.select();
    }
} 
```

* * *

## 回答 #33

> 赞同：-2
> 
> 时间：2012-01-18T01:34:20.663

```
input = $('input'); 
input.focus().val(input.val()+'.'); 
if (input.val()) {input.attr('value', input.val().substr(0,input.val().length-1));} 
```

* * *

## 回答 #34

> 赞同：-2
> 
> 时间：2012-04-24T19:27:29.980

好吧，我只是使用：

```
$("#myElement").val($("#myElement").val()); 
```

# c# - LINQ to SQL 中的多态关联

> ID：511092
> 
> 赞同：2
> 
> 时间：2009-02-04T12:12:45.687
> 
> 标签：c#, .net, linq, activerecord

LINQ to SQL 是否像 ruby​​ on rails 活动记录一样提供开箱即用的多态关联？如果没有，是否有任何解决方法来手动映射这些关联？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:23:41.633

同意。我发现没有办法做到这一点，也没有使用设计器，也没有手动附加类/方法属性。此外，多态关联不可能有外键约束。我放弃了这个选项，谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T12:39:19.220

**已编辑**

SQL Server 不允许您在不是主键或没有唯一约束（或索引）的列上具有外键关系。让多个表使用子表中的同一列作为外键似乎没有任何限制。DBML 设计器确实发现了这些关系，并将在您导入表时创建与两个父表的关联。然而，设计者生成的代码似乎只会为其中一个关联生成。也就是说，设计者正确地显示了关联，但除了其中一个之外，所有的代码都被省略了。此外，可扩展性方法和属性设置器似乎也没有在设计器生成的代码中正确定义。

如果您在设计器中手动添加关联，似乎也是如此。代码中只实现了一个实际关联，而另一个父类的代码似乎无法挽回。您可能可以使用部分类实现来添加所需的功能以匹配设计器将生成的功能，但我还没有尝试过。

此外，LINQ2SQL 不支持开箱即用的多对多关系。在不自己编写代码的情况下，您仅限于 1-1 和 1-many。

# c# - C# null-coalescing (??) 运算符的运算符优先级是什么？

> ID：511093
> 
> 赞同：22
> 
> 时间：2009-02-04T12:13:07.043
> 
> 标签：c#, null, null-coalescing-operator

我刚刚尝试了以下方法，其想法是将两个字符串连接起来，用一个空字符串代替空值。

```
string a="Hello";
string b=" World"; 
```

- 调试（有趣的是？是打印，并不完全有助于可读性......）

```
 ? a ?? "" + b ?? "" 
```

->“你好”

正确的是：

```
? (a??"")+(b??"")
"Hello World" 
```

我有点期待“Hello World”，或者如果 a 为空，则只是“World”。显然，这与运算符优先级有关，可以用括号来克服，是否有任何地方记录了这个新运算符的优先级顺序。

（意识到我可能应该使用 stringbuilder 或 String.Concat）

谢谢。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-04T12:56:43.880

除了您希望*优先*级是什么、根据 ECMA 是什么、根据 MS 规范是什么以及 csc 实际做什么之外，我还有一点建议：

**不要这样做**。

我认为写得更清楚*：*

```
string c = (a ?? "") + (b ?? ""); 
```

或者，鉴于字符串连接中的 null 最终只是一个空字符串，只需编写：

```
string c = a + b; 
```

编辑：关于记录的优先级，在[C# 3.0 规范](http://download.microsoft.com/download/3/8/8/388e7205-bc10-4226-b2a8-75351c669b09/CSharp%20Language%20Specification.doc)（Word 文档）和[ECMA-334](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-334.pdf)中，加法绑定比 ?? 更紧密，它比赋值更紧密。IMO，另一个答案中给出的 MSDN 链接是错误和奇怪的。2008 年 7 月在页面上显示的更改移动了条件运算符 - 但显然不正确！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T12:56:24.177

永远不要依赖运算符优先级。**始终**明确指定您希望代码如何运行。当您回到您的代码时，请帮自己和他人一个忙。

```
(a ?? "") + (b ?? "") 
```

这没有任何模棱两可的余地。歧义是错误的温床。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-04T12:17:07.690

运算符优先级记录在[MSDN](http://msdn.microsoft.com/en-us/library/6a71f45d.aspx)上。

然而，MSDN 上的优先级与来自 Microsoft的[可下载 C# 规范和](http://download.microsoft.com/download/3/8/8/388e7205-bc10-4226-b2a8-75351c669b09/CSharp%20Language%20Specification.doc)[ECMA 上的规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-334.pdf)的优先级相矛盾。这有点奇怪。

无论如何，正如 Jon Skeet 在他的回应中所说，最好不要依赖运算符的优先级，而是通过使用括号来明确。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T12:25:34.897

有趣的是[http://msdn.microsoft.com/en-us/library/6a71f45d.aspx](http://msdn.microsoft.com/en-us/library/6a71f45d.aspx)和[http://en.csharp-online.net/ECMA-334:_14.2.1_Operator_precedence_and_associativity](http://en.csharp-online.net/ECMA-334:_14.2.1_Operator_precedence_and_associativity)给 ?? 赋予了不同的优先级。

微博：

1.  有条件的
2.  任务
3.  空合并
4.  拉姆达

ECMA：

1.  空值合并
2.  有条件的
3.  任务

我认为msdn一定是错误的，考虑：

```
string a = null;
string b = a ?? "foo";
// What is b now? 
```

# actionscript - web service code in actionscript

> ID：511094
> 
> 赞同：1
> 
> 时间：2009-02-04T12:13:37.057
> 
> 标签：actionscript, service

im calling an actionscript class from my main mxml file. the actionscript class is responsible for calling a web service and handling the response, however im having trouble and keep getting the following error; (im new to flex btw)

```
Error #1009: Cannot access a property or method of a null object reference. 
```

my code goes as follows;

```
 public function getSites(argWsdl:String):void{
    ws = new WebService();
        ws.loadWSDL(argWsdl);
    ws.getSites.addEventListener(ResultEvent.RESULT,echoResultHandler); 
    ws.getSites();
}

    public function echoResultHandler(event:ResultEvent):void {
        var siteField:ArrayCollection = event.result as ArrayCollection;
        Application.application.setSiteField(siteField);
    } 
```

when i run the debugger the code never reaches the result hanlder and i see the #1009 error in the variable list.

any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:24:24.140

looks like you have it sorted, but just to add more information in case someone else comes along to this question, you generally see this error when you are trying to use something that hasn't been created yet. A lot of the time you will see it when trying to access UI components that have not yet been created (its good to rely on the creationComplete event for these sort of things), but in this case it looks like you are using the webservice before it is completely ready (the wsdl hasnt been loaded yet).

Just so you know, you can also define your webservices in mxml (mx:webservice) and specify the wsdl there or you can also load the wsdl later on from a configuration file afterwards just by referencing the ID.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:18:50.347

sorted it out,

i needed to created a loadEvent and loadhandler. Once loadWsdl is called the loadhandler specifies the laodHandler to use, inside the loadHandler i call the method name as seen in the wsdl

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T14:30:35.283

thanks Ryan,

the main reason im using a seperate actionscript class is so i can reuse the same web service calls across my components without having to retype the same code. I couldnt think of a better way to do this - maybe a could have done the same with a custom component

# javascript - 这个javascript语法是什么意思？

> ID：511096
> 
> 赞同：4
> 
> 时间：2009-02-04T12:14:09.223
> 
> 标签：javascript, syntax

我试图理解由 Asp.Net Ajax Toolkit 生成的脚本，该脚本当前给出了“预期对象”（如果我将 PopupControlExtender 放在更新面板中，错误就会消失）。

```
document.getElementById('ctl00_ValidationSummary1').dispose = function() {
    Array.remove(Page_ValidationSummaries, document.getElementById('ctl00_ValidationSummary1'));
}
(function() {var fn = function() {AjaxControlToolkit.ModalPopupBehavior.invokeViaServer('ctl00_c1_componentCategoryListUC_componentCategoryGrid_modalPopupExtender', true); Sys.Application.remove_load(fn);};Sys.Application.add_load(fn);})(); 
```

我在这里看到的是：

```
someobject.someevent = function() {
    dosth;
} /* Get ready, I am about to do sth crazy ... */
(function() { dosth; })(); /* you did what? */ 
```

这个语法是什么意思？

**编辑：**我特别好奇 (function () { ... })() 在另一个函数结束后立即出现}。

**编辑：**原来，ajax 家伙忘记在事件处理程序分配后放置分号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T12:23:32.420

这

```
(function() { dosth; })();
```

语法声明一个匿名函数，然后立即执行它。这相当于这样做：

```
 var myFun = (function() { dosth; });
 myFun();
```

但没有临时变量。

从广义上讲，这类似于只执行任何`dosth`内容；但是创建一个函数对象会为变量引入一个新的作用域（由于闭包），因此这通常用于解决作用域问题。

在您引用的特定情况下，我看不出有什么理由特别需要这样做。然而，它可以这样做有两个原因 - 最终的 Javascript 本身是由一些无法判断是否需要闭包的自动过程生成的；或者它是由一个决定总是将事物包装在函数中以确保安全的人编写的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T12:23:18.393

```
(function() { dosth; })(); 
```

在这里，创建了一个匿名函数，然后立即调用。

这是在 JavaScript 中创建本地范围的一种比较流行的习惯用法，其中只有函数有自己的范围。

本地范围允许您拥有私有变量并避免名称冲突。

在其他语言中，您可以编写类似

```
int a = 1;
{
   int b = 0;
   if (something){
       int c = 3;
   }
} 
```

并且这三个变量都在不同的范围内，但是在 JavaScript 中，您必须声明一个函数才能获得新的范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T12:22:07.897

```
(function() { dosth; })(); 
```

将 dosth 包装在一个匿名函数中，然后在页面加载后立即运行该匿名函数（这就是那些 final () 所做的）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T12:22:50.033

假设你的意思是：

```
(function() { dosth; })(); /* you did what? */ 
```

这在第一个括号块中声明了一个匿名函数，该函数将是第二个括号块执行的那个括号块的返回对象。

所以这定义并执行了任何“dosth”。

# apache-flex - 弹出弹性窗口

> ID：511098
> 
> 赞同：0
> 
> 时间：2009-02-04T12:15:03.293
> 
> 标签：apache-flex, flex3

当我点击按钮时，它应该会弹出我的模块，当我点击外部时它会隐藏或删除它。这是我的代码：

```
private var Showup:IFlexDisplayObject; 
Showup = PopUpManager.createPopUp(this, samplemodule, false);
Showup.addEventListener(FlexMouseEvent.MOUSE_DOWN_OUTSIDE, Removewindow); 

private function Removewindow(e:FlexMouseEvent):void
{
    PopUpManager.removePopUp(Showup);
} 
```

我的问题是，`samplemodule`我有很多按钮。当我单击任何按钮时，相应的模块应该加载到中间部分..但它没有加载。

请告诉我错误或替代选项！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-04T11:22:21.080

请加

```
mouseDownOutside="PopUpManager.removePopUp(this)" 
```

示例模块（弹出画布）内的标记主要将对象显示为标记。

当您移出弹出窗口并单击时，这将删除弹出窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-04T13:44:18.903

不太确定您遇到了什么问题，弹出窗口的关闭或居中。我认为是居中。如果是这样，请尝试添加：

```
 PopUpManager.centerPopUp(Showup); 
```

# javascript - 用于动态扩展文本区域的原型插件

> ID：511128
> 
> 赞同：1
> 
> 时间：2009-02-04T12:22:52.077
> 
> 标签：javascript, prototypejs, textarea, dhtml

有谁知道一个好的原型插件，它允许文本区域根据其中有多少文本自动扩展/收缩（例如，添加一条线，区域变大，删除一条线，它变得更小）？

我需要一个可以免费使用的（例如某种形式的 GPL 类型许可证）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T13:40:40.627

这使用原型：

```
<textarea id='t1' cols="40" rows="7" style='overflow:hidden;font-size:14px;font-family:"Times New Roman", Times, serif'></textarea>
<script type="text/javascript">
function activateResize(element) {
    Event.observe(element, 'keyup', function() {
      updateSize(element)
    });
    updateSize(element)
}

function updateSize(element) {
   //if scrollbars appear, make it bigger, unless it's bigger then the user's browser area.
    if(Element.getHeight(element)<$(element).scrollHeight&&Element.getHeight(element)<document.viewport.getHeight()) {
        $(element).style.height = $(element).getHeight()+15+'px'
        if(Element.getHeight(element)<$(element).scrollHeight) {
            window.setTimeout("updateSize('"+element+"')",5)
        }       
    }
}

activateResize('t1')
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T12:31:40.373

它不是插件，但不长： http: [//www.codelibary.com/JavaScript/Auto%20textarea%20resize.html](http://www.codelibary.com/JavaScript/Auto%20textarea%20resize.html)。

编辑：找到[这个](https://stackoverflow.com/questions/7477/autosizing-textarea)SO 线程

# c# - 在 Visual Studio 2005 中限制测试运行结果的数量

> ID：511132
> 
> 赞同：4
> 
> 时间：2009-02-04T12:24:35.427
> 
> 标签：c#, .net, visual-studio, unit-testing

我有一个 VS2005 单元测试的“套件”，它附加一个数据库作为初始化的一部分。测试相当大地修改数据库，因此需要在每次测试运行之前将其恢复到已知状态。

我将测试数据库部署到每个 TestResult 的“out”文件夹中，并将其附加到 MyClassInitialize 方法中。

DB 相当大，因此随着越来越多的 TestResults 创建，这会占用大量空间。

Visual Studio 中是否有任何方法可以限制存储的最大测试结果数？IE。最多存储 5 个 + 删除最旧的 5 个？

问候，

马特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-08-25T20:11:15.777

这适用于 VS2010（来自 MSDN）：

限制存储的测试运行次数 1.在 Visual Studio 中，单击“工具”菜单上的“选项”。

出现选项对话框。

2.展开测试工具并单击测试执行。

3.在测试结果管理下，选择要保留的测试运行次数。

4.单击确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T21:52:10.657

可以创建一种在测试初始化​​时运行的方法，该方法浏览到正确的位置，并且只使用文件操作来删除某个数字，但是如果多个用户尝试同时运行单元测试，您建议的方法可能会导致问题时间（取决于您的测试环境的设置方式）。

我通常使用的方法是在测试初始化​​时创建数据库的副本，然后在测试拆除以删除正在使用的副本时，我们通常将 guid 附加到数据库名称以确保唯一性。这种方法的最大问题是，如果您在调试期间中止测试，则数据库永远不会被删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T11:40:09.287

据我所知，您无法限制 Visual Studio 存储的测试运行结果的数量。

# c# - 对话框关闭后执行代码并且它不可见

> ID：511133
> 
> 赞同：2
> 
> 时间：2009-02-04T12:24:42.680
> 
> 标签：c#, winforms

我想在“Form1”中执行一些代码，但是在对话框关闭并且它不可见之后。我知道我可以在调用 ShowDialog() 后在对话框之外执行此操作，但我不喜欢它。

我在“FormClosed”中尝试过，但似乎在触发此事件时对话框仍然可见。此外，如果我将主对话框称为“隐藏（）”，它会被最小化 - 会发生一些有趣的事情

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T13:01:09.817

我会在对话框上创建一个静态方法，并在此方法中显示对话框，并在它关闭后执行任何需要执行的操作，例如

```
public static void ShowAndDoStuff()
{
  MyDialog dialog = new MyDialog();
  dialog.ShowDialog();
  dialog.DoStuff();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T13:06:03.207

您可以尝试关闭事件，隐藏方法也是一个好主意。我建议一个混合解决方案只使用一个布尔变量（即： sysclose ），默认值为 false

# c# - Windows 上的跨平台编程

> ID：511138
> 
> 赞同：4
> 
> 时间：2009-02-04T12:27:42.440
> 
> 标签：c#, .net, mono, cross-platform

两个问题：

1.  有没有办法在 Microsoft Visual Studio 上编写跨平台程序？

2.  如果没有，我可以在 VS2008 上编写一个 C# 应用程序并用 MonoDevelop 重新编译它并让它工作吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T12:36:17.463

1 - 我不这么认为。不是没有像 Mono 这样的东西。

2 - 是的，你可以，但是 Mono 并没有涵盖所有的框架——他们正在研究它。最好的办法是使用 Mono Migration Analyzer 进行检查。Mono Migration Analyzer (MoMA) 工具可帮助您识别在 Mono 上可能遇到的问题 - [http://mono-project.com/MoMA](http://mono-project.com/MoMA)。

我发现我的大部分 .NET 2.0 应用程序都可以转换，但您可能需要进行一些调整。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T12:34:53.643

您始终可以使用 C++ 和 QT。很快 QT 将以 LGPL 许可证（从 4.5 版开始）发布，这将提供更多自由。

使用免费 QT 许可证的唯一限制是您无法与 VS 集成。然而，这可以通过使用例如来处理。CMake（将生成 VS 解决方案文件）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T12:39:21.717

1.  是的，使用 Mono 编写代码、编译并在另一个平台上运行。编译时生成 IL，Mono 可以使用它。注意：某些功能在 Mono 上不可用。Delphi Prism 是 Visual Studio 的一个附加组件，它允许您从 VS 编写 Linux 和 Mac 代码，尽管使用的是对象 Pascal 语言。
2.  是的，请参阅与 1 中相同的问题

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T13:20:34.550

我同意[Joe90](https://stackoverflow.com/questions/511138/cross-platform-programming-on-windows/511169#511169 "乔90")的观点，只是他遗漏了一件事：MonoDevelop 可以编译 .sln 和 .csproj 文件，因为[它具有 MSBuild 实现](http://monodevelop.com/Release_notes_for_MonoDevelop_2.0_Alpha_1 "发行说明")。

因此，将 MoMA 指向您的代码，如果您获得绿灯，它应该在 MonoDevelop 中按原样编译。

作为一个 MSCLR 迷，我不得不承认 Mono 对某些关键功能（主要与加密有关）有一些“更好”的实现。您将从这些中获得更多的可用性。

另一件需要注意的是细微的逻辑错误。如果一个类在 Mono 中实现，并不意味着它的行为与 MSCLR 相同（Mono 是一种冷藏室实现，因此它们不使用原始源代码）。这确实是您将从经过良好单元测试的代码库中获得良好结果的地方。

[为了更好地说明您应该期待什么，我记得在AgsXMPP](http://www.ag-software.de/index.php?page=agsxmpp-sdk "银XMPP") [存储库](http://svn://svn.ag-software.de/agsxmpp "存储库")中看到了大量的#if MONO 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T12:35:45.513

理想情况下，您可以编写一个 C# 应用程序并让它在 Mono 平台上运行。但是，这将取决于已移植到 Mono 的 MS .NET 库。

以防万一，没有语言限制，您可以考虑使用其他语言，如 Java、Python、Ruby 等。

祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T13:21:17.433

正如许多其他人提到的那样，您的成功将取决于您使用的库。Mono 确实有 Winforms，但我建议您也将 GTK# [http://www.mono-project.com/GtkSharp](http://www.mono-project.com/GtkSharp "GTK#")作为您的窗口库。如果您使用 GTK#，您将使用未进行逆向工程的库（因为 Winforms 在 Mono 中）。

我的理解是，“非 gui”.NET 2.0 的东西与最新版本的 Mono 差不多

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T00:50:27.077

您不需要单声道开发，单声道的整个想法是您可以为 .net 开发并在单声道和 .net 上使用相同的程序集，前提是您只使用已在单声道中实现的东西。

不起作用的东西：pinvoke、wpf、linq to SQL

可以工作的东西：.net 2.0、c# 3.0（包括 linq to objects 和 linq to xml）、winforms

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-05T00:56:06.393

如果您在 Silverlight 中编写应用程序，任何拥有 Web 浏览器和 Silverlight 插件的人都可以访问您的应用程序。这与 .NET 一样是跨平台的。

# sql - MySQL - 需要帮助来确定多个连接

> ID：511140
> 
> 赞同：0
> 
> 时间：2009-02-04T12:28:13.407
> 
> 标签：sql, mysql

我正在使用以下查询从与用户进行的表中获取事务。然后我想检索 sender_id 和 recipient_id 的用户名。但是，我似乎只能为收件人 ID 或发件人 ID 获取它。任何人都有任何想法我怎么能得到这两个。

```
SELECT us.name, ta.amount, ta.recipient_id, ta.sender_id, ta.timestamp_insert
        FROM  `transactions` AS ta
        JOIN users AS us
        ON ta.recipient_id=us.u_id
        WHERE ta.sender_id =111111 OR ta.recipient_id = 111111
        LIMIT 0 , 10 
```

**交易表列：**

transaction_id
tw_id
tw
sender_id
recipient_id
金额
timestamp_insert
timestamp_start timestamp_complete transaction_status

**用户表列：**

u_id，名称

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T12:31:56.863

您需要加入两次，因此：

```
SELECT ta.amount, ta.recipient_id, ta.sender_id, ta.timestamp_insert, sender.name as Sender, recipient.name as Recipient
        FROM  `transactions` AS ta
        JOIN users AS recipient
        ON ta.recipient_id=recipient.u_id
        JOIN users AS sender
        ON ta.sender_id=sender.u_id
        WHERE ta.sender_id =111111 OR ta.recipient_id = 111111
        LIMIT 0 , 10 
```

# http - 如何指示网络浏览器不要缓存页面？

> ID：511144
> 
> 赞同：3
> 
> 时间：2009-02-04T12:29:58.787
> 
> 标签：http, caching, http-headers

我遇到了 Internet Explorer 6.0 的缓存问题，我想指示浏览器**不要**缓存他请求的页面。

更多信息：在我的页面中，有一个随机令牌可防止重新加载站点并两次或更多次发布相同的信息。

如果您现在将此页面添加为书签，则必须指示浏览器在每次请求时刷新站点。

Firefox 3.0.5 正确地做到了这一点，但 IE 6.0 将随机令牌保留在缓存中。

我在受影响的页面中包含以下元标记：

```
<meta http-equiv="cache-control" content="no-cache, must-revalidate">
<meta http-equiv="expires" content="0">
<meta http-equiv="pragma" content="no-cache"> 
```

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T12:36:38.710

这是一个相当有据可查的 googleable 问题，可能在这里被骗了好几次，但这是我的标准块（C#）：

```
Response.AppendHeader("Cache-Control", "no-cache"); //HTTP 1.1
Response.AppendHeader("Cache-Control", "private"); // HTTP 1.1
Response.AppendHeader("Cache-Control", "no-store"); // HTTP 1.1
Response.AppendHeader("Cache-Control", "must-revalidate"); // HTTP 1.1
Response.AppendHeader("Cache-Control", "max-stale=0"); // HTTP 1.1 
Response.AppendHeader("Cache-Control", "post-check=0"); // HTTP 1.1 
Response.AppendHeader("Cache-Control", "pre-check=0"); // HTTP 1.1 
Response.AppendHeader("Pragma", "no-cache"); // HTTP 1.0 
Response.AppendHeader("Expires", "Wed, 09 Jun 1993 00:00:00 GMT"); // HTTP 1.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T12:36:18.400

检查您的服务器发送的 HTTP 标头，这些标头可以覆盖 HTML 元部分中的内容。

# xml - 如何使“使用”属性（必需/可选）取决于另一个值？

> ID：511148
> 
> 赞同：2
> 
> 时间：2009-02-04T12:30:59.657
> 
> 标签：xml, xsd, schema

我正在尝试在 XSD XML Schema 中做一些特定的事情。我想将一个元素设置为`use="required"`，仅当另一个元素的属性具有特定值时。

例子：

```
<udi att1="all">
   <name att2="dsd"/>
   <phone att3="dsd"/>
</udi> 
```

我希望`phone`元素是必需的，只有当`att1`值是`all`.

有人告诉我 XPath 可以解决这个问题——或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T12:58:31.897

XML 不是关系的，它是分层的。模式旨在强制执行嵌套规则，而不是兄弟之间的规则。这根本不是你可以用 XSD 做的事情。

但是，您可以在解析或创建符合格式的文档时执行此操作。在这种情况下，当您解析 XML 文档时，您会强制执行您在问题中所述的约束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-12T16:45:02.847

对于后代：可以实现此要求：

(a) 通过使用 XSD 1.1 中的新特性（断言、条件类型分配）

(b) 通过使用 Schematron 与 XSD 一起进行验证。

# frameworks - 为什么使用此代码时 MSTest 和 TestDriven.NET 的行为会有所不同？

> ID：511176
> 
> 赞同：2
> 
> 时间：2009-02-04T12:37:42.890
> 
> 标签：frameworks, tdd, mstest, testdriven.net

看看这段代码：

```
internal static readonly Dictionary<Type, Func<IModel>> typeToCreator = new Dictionary<Type, Func<IModel>>();
protected static object _lock;        

public virtual void Register<T>(Func<IModel> creator)
{
    lock (_lock)
    {
    if (typeToCreator.ContainsKey(typeof(T)))
        typeToCreator[typeof(T)] = creator;
    else
        typeToCreator.Add(typeof(T), creator);
    }
} 
```

当我使用运行此测试中的代码时（测试框架是 MSTest）：

```
[TestMethod]
public void Must_Be_BasePresenterType()
{
     var sut = new ListTilbudPresenter(_tilbudView);
     Assert.IsInstanceOfType(sut, typeof(BasePresenter));
} 
```

...MSTest 通过它，而 TestDriven.NET 失败，因为 _lock 为空。

为什么 MSTest 没有通过测试？？？

# asp-classic - 经典 ASP：如何列出激活的会话？

> ID：511180
> 
> 赞同：4
> 
> 时间：2009-02-04T12:39:20.017
> 
> 标签：asp-classic

有没有办法在经典 ASP 中获得激活会话的列表？

我想限制同时激活的会话数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T12:52:34.467

这是一篇很好的文章，它展示了一种方法：[Josh Painter 的 Active User Count Without Global.asa](http://www.aspfree.com/c/a/asp-code/active-user-count-without-global-asa-by-josh-painter/)

我想你必须改变一些细节，但这是你可以解决问题的方式。作者不使用 global.asa。

一种更简单的方法是在 global.asa 中挂钩`Sesssion_OnStart`和`Session_OnEnd`事件，并从实现为应用程序变量的会话列表中添加/删除项目。

如果您只想要会话**数**，您可以简单地这样做：

```
Sub Session_OnStart
   Application.Lock
   Application("count") = Application("count") + 1
   Application.Unlock
End Sub

Sub Session_OnEnd
   Application.Lock
   Application("count") = Application("count") - 1
   If Application("count") < 0 then  ' Could only happen if some other function interfers
      Application("count")=0 
   End If
   Application.Unlock
End Sub 
```

在您的 ASP 文件中

```
<%
Response.Write "There are currently " & Application("count") & "active sessions>"
%> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T12:56:33.523

您不能从另一个会话访问一个会话，因此没有内置方法可以获取所有活动会话的列表。但是，您可以使用`Session_OnStart`和`Session_OnEnd`在 global.asa 中通过将相关会话信息保存到`Application`对象、日志文件、数据库等来跟踪会话（具体取决于您想要对信息做什么）。

我们倾向于跟踪`Application`对象中的活动会话数，以粗略了解在任何给定时间有多少人在使用一个站点（当然要记住，人们通常会在会话时间之前很久就离开该站点出去）。它不是 100% 准确，但它足够接近当前活动的指南。

如果只需要会话数，还可以使用 Perfmon 跟踪性能对象的`Sessions Current`计数器（和其他相关计数器） 。`Active Server Pages`显然，这假设可以访问服务器，在这种情况下可能不是您想要的。

有关某些选项的更多信息，请尝试这篇文章：[如何计算当前用户/会话的数量？](http://web.archive.org/web/20091219095226/http://classicasp.aspfaq.com/general/how-do-i-count-the-number-of-current-users/sessions.html)（存档版本）

# command-line - 全屏模式 (25*80) 命令行脚本

> ID：511186
> 
> 赞同：0
> 
> 时间：2009-02-04T12:41:51.307
> 
> 标签：command-line, vbscript, fullscreen

当您从 25*80（dos 提示符的全屏模式）运行脚本（例如 vbscript）并且您的脚本调用 Windows 应用程序（例如记事本）时，在操作结束时，焦点仍然在桌面上（尽管任务栏上的“命令提示符”最小化，只等待一个“{enter}”返回 25*80 全屏命令提示符）

我怎样才能做到这一点？（在调用窗口应用程序结束时返回全屏命令提示符。来自我的脚本）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T12:59:58.460

看shell命令START

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T04:02:25.080

通过设置属性和 dbl 单击它，将您的命令提示符快捷方式设置为全屏模式 (25*80)。

在提示符下 enter `start /b notepad`，然后按 enter 看看会发生什么。如何在全屏模式下返回命令提示符以及如何使其自动化？

# eclipse - 将已删除目录提交到 SVN 存储库时出现问题

> ID：511196
> 
> 赞同：12
> 
> 时间：2009-02-04T12:48:40.310
> 
> 标签：eclipse, svn, subversive

我正在使用带有 Subversive SVN 插件的 Eclipse Europa。

当尝试提交已删除的目录时，SVN 返回此消息：

```
Some of selected resources were not committed.
Item is out of date
svn: Commit failed (details follow):
svn: Item '/myProject/trunk/src/test/config' is out of date 
```

该文件夹的内容已被删除并提交。

我能做些什么来提交它？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-04T12:51:23.003

尝试先更新，*然后*删除并提交。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-09T03:36:33.540

也有这个问题。为我解决了以下问题

*   更新
*   删除文件夹内容
*   犯罪
*   更新
*   删除文件夹
*   犯罪

令人沮丧的是必须分 2 个阶段执行此操作！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-08T03:16:26.100

只需使用*Svn repository explore*删除文件夹，然后更新项目。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-19T20:40:23.883

只需右键单击更新到头部，然后为我提交它的工作

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-01T07:53:37.607

我可以看到这张票是旧的，但下面的步骤可能会帮助面临这个问题的人。

```
1\. Update the parent folder.
2\. Delete the folder you want to delete from the working repository.
3\. Commit the parent folder. 
```

我在 Eclipse 中使用 Subclipse 插件，它具有非常用户友好的 GUI 来支持 Subversion。如果有兴趣可以尝试 - [https://marketplace.eclipse.org/content/subclipse](https://marketplace.eclipse.org/content/subclipse)

谢谢

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-09T09:13:33.273

我也遇到了这个，但是我已经删除了该文件夹。更新和提交都不起作用，所以我不得不手动重新创建包含文件的文件夹，然后按照 Kurru 建议的步骤操作。

# proxy - nginx 作为邮件代理

> ID：511198
> 
> 赞同：1
> 
> 时间：2009-02-04T12:49:28.217
> 
> 标签：proxy, email, nginx

我正在尝试将 nginx 设置为邮件代理。我想要的只是让 nginx 接收邮件并将其转发到脚本。这套可能吗，还是我应该只使用 sendmail 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T03:16:28.080

我可以远程想象工作的唯一方法是让 nginx 在 smtp 端口上侦听并在该端口上运行 smtp 服务器 Web 应用程序。那时 nginx 基本上只会将外部端口连接到本地运行的应用程序。所以，是的，我认为使用像 sendmail 这样的真正的 smtp 服务器会更好。实际上，我建议您使用 postfix，因为它可以说做得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T00:57:26.723

缺乏文档，但从玩弄它看起来像 nginx 邮件选项用于创建代理以更轻松地向现有 MTA 添加自定义身份验证。

一个用例可能是使用 php 脚本使用网站的现有用户数据库对现有网站用户进行身份验证，而无需为他们创建系统用户或设置额外的数据库。

所以不，它不会将实际的电子邮件转发到脚本（在 MTA 中查找诸如 exim 之类的 'pipe_tansport' 之类的东西），但它会让您使用脚本将身份验证放在现有 smtp 服务器的前面。

# java - 尽管我们有 Swing，为什么我们还需要 JavaFX？

> ID：511202
> 
> 赞同：4
> 
> 时间：2009-02-04T12:51:38.913
> 
> 标签：java, swing, javafx

Swing 在很多方面都很好，那我们为什么需要 JavaFX？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T13:01:04.027

JavaFX 的技术部分可以帮助设计 UI，而语言部分可以使编写 UI 更容易。

JavaFX 技术带来了 2d 场景图和视频功能。Afaik 这些也将普遍提供给 java。它们是创建具有精美和交互式图形 UI 的客户端应用程序的良好进步。2d 场景图应该可以创建更多仍然响应的图形重应用程序。

JavaFX 语言是一种以编程方式创建 UI 的更好方法。Java Swing 代码可能会变得非常冗长，而相同的 JavaFX 代码会更小且更易于维护。闭包支持使创建事件处理程序更容易。设置的声明式分配使元素的配置更容易。本机列表语法使添加组件更容易。

请注意，我并没有真正写过任何 JavaFX，但我已经阅读了代码并注意了发生了什么。我建议自己尝试一下，看看是什么在烹饪。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T14:13:37.783

我认为 Staale 的回答是一个好的开始，但我会补充...

使用 JavaFX 如果

1) 如果您有兴趣为手机或电视开发应用程序（请注意尚未发布）

2) 如果您正在与在 Photoshop 中创建应用程序外观的平面设计师合作，并且您希望能够直接导入他们的外观。

3) 如果让 GUI 肮脏丰富对你很重要。（因此，如果您希望面板淡入或淡出，或根据需要滑动）

使用 Swing 如果

1）您正在创建一个主要用于桌面的应用程序。

2）性能很重要，你知道你在做什么（所以如果你正在编写一个 IDE，Swing 会是一个更好的选择）

3) 您正在寻找一个 RPC（富客户端平台）来构建。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-02-04T13:17:21.843

这与我们拥有 Java、C++、C#、Python、Perl、Ruby 的原因相同……尽管我们已经拥有 C。

# python - 如何在Python中不包含'\ n'打印字符串

> ID：511204
> 
> 赞同：18
> 
> 时间：2009-02-04T12:52:14.793
> 
> 标签：python, string

假设我的字符串是：

```
' Hai Hello\nGood eve\n' 
```

如何消除`'\n'`两者之间的内容并制作字符串打印，例如：

```
 Hai Hello Good eve 
```

?

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-04T12:55:43.383

如果您不想在 print 语句的末尾换行：

```
import sys
sys.stdout.write("text") 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-04T12:53:50.547

您可以使用以下`replace`方法：

```
>>> a = "1\n2"
>>> print a
1
2
>>> a = a.replace("\n", " ")
>>> print a
1 2 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-24T15:00:05.367

在 Python 2.6 中：

```
print "Hello.",
print "This is on the same line" 
```

在 Python 3.0 中

```
print("Hello", end = " ")
print("This is on the same line") 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-12-21T16:49:50.610

I realize this is a terribly old post, but I just ran into this also and wanted to add to it for clarity. What the original user is asking, I believe, is how to get the OS to interpret the string "some text\nsome more text" as:

> some text
> 
> some more text

Instead of just printing:

> "some text\nsome more text"

and the answer is it is already interpreting. In ubuntu I ran into the problem of it escaping the newline characters when putting it into the string without me asking it to. So the string:

> "some text\nsome more text"

is in fact

> "some text\\nsome more text"

All that is required is to use the `mystring.replace("\\\n", "\n")` and the desired output will be achieved. Hope this is clear and helps some future person.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-04T21:21:20.117

在“打印”之后添加一个逗号：

```
print "Hai Hello",
print "Good eve", 
```

在 Python 3.0 中，Altho “打印”消失了

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-05-19T18:45:20.247

很老的帖子，但似乎没有人成功回答你的问题。两个可能的答案：

首先，由于转义，您的字符串实际上正在`Hai Hello\\\\nGood eve\\\\n`打印。简单的解决方法是（参见[http://docs.python.org/reference/lexical_analysis.html#string-literals](http://docs.python.org/reference/lexical_analysis.html#string-literals)）`Hai Hello\\nGood eve\\n``\\\\``mystring.replace("\\\\n","\\n")`

或者，您的字符串不是字符串，也可能不是元组。当我认为我有一个字符串并且从未注意到它是如何打印的，因为它是一个长字符串时，我只是遇到了类似的错误。我的打印为：

> ("Lorem ipsum dolor sit amet, consectetur adipiscing elit.\nEtiam orci felis, pulvinar id vehicula nec, iaculis eget quam.\nNam sapien eros, hendrerit et ullamcorper nec, mattis at ipsum.\nNulla nisi ante, aliquet necminationum non, faucibus vel odio。\nPraesent ac odio vel metus condimentum tincidunt sed vitae magna。\n整数 nulla odio，sagittis id porta commodo，hendrerit vestibulum risus。\n...,"")

很容易错过开头和结尾的括号，只需注意 \n。打印`mystring[0]`应该解决这个问题（或者它在列表/元组等中的任何索引）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T13:10:24.133

```
>>> 'Hai Hello\nGood eve\n'.replace('\n', ' ')
'Hai Hello Good eve ' 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T08:12:09.453

不确定这是否是您所要求的，但您可以使用三引号字符串：

```
print """Hey man
And here's a new line

you can put multiple lines inside this kind of string
without using \\n""" 
```

将打印：

```
嗨，老兄
这是一条新线

您可以在这种字符串中放置多行
不使用 \n

```

# .net - .NET 字典：仅枚举线程安全吗？

> ID：511205
> 
> 赞同：5
> 
> 时间：2009-02-04T12:52:32.907
> 
> 标签：.net, multithreading, dictionary, thread-safety

简单地从多个线程中枚举一个 .NET 字典是否安全？

根本没有对字典进行任何修改。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T12:54:53.947

是的，在这种情况下，枚举是线程安全的，因为在`foreach`循环开始时，会通过隐式调用创建枚举器的新实例`GetEnumerator`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T12:56:18.547

是的......好吧几乎：

> Dictionary<(Of <(TKey, TValue>)>) 可以同时支持多个读取器，只要不修改集合即可。即便如此，通过集合枚举本质上不是线程安全的过程。在枚举与写访问竞争的极少数情况下，必须在整个枚举期间锁定集合。要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

（[参考](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)）

# c# - 为什么 Visual Studio 中的提取方法命令会创建静态方法？

> ID：511211
> 
> 赞同：29
> 
> 时间：2009-02-04T12:54:51.123
> 
> 标签：c#, visual-studio, refactoring

为什么 Visual Studio 在重构代码和选择提取方法时默认创建私有静态方法？

如果我正在重构一个非静态类并且该方法仅在类中可见，为什么它是静态的？

与非静态类中的非静态方法相比，在非静态类中调用私有静态方法是否有一些性能优势？

是否为了可读性而简单地表明该方法不依赖于类的任何成员变量？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-04T12:56:15.613

> 为什么 Visual Studio 在重构代码和选择提取方法时默认创建私有静态方法？

仅当您的方法不访问任何成员变量/方法/属性时，它才会这样做。这很好，因为它基本上是按照最少假设原则运行的：由于您不访问特定于实例的数据，因此不妨将方法`static`.

> 与非静态类中的非静态方法相比，在非静态类中调用私有静态方法是否有一些性能优势？

从理论上讲，可能有，但我对此表示怀疑。但是，将方法设为静态可以清楚地表明它不会访问或修改实例数据，我发现这是一个有用的提示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T12:57:30.493

创建静态方法可能被认为是性能增强，因为没有“this”指针作为变量传递。我使用 ReSharper，它总是建议在方法不引用类变量时将其转换为静态方法。

# linux - 在 debian 上缩短大型 CSV

> ID：511224
> 
> 赞同：1
> 
> 时间：2009-02-04T12:56:45.410
> 
> 标签：linux, text, large-files

我有一个非常大的 CSV 文件，我需要编写一个可以解析它的应用程序，但是使用 >6GB 的文件进行测试很痛苦，有没有一种简单的方法可以提取前一百或两行而无需加载整个文件进入记忆？

该文件位于 Debian 服务器上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T12:58:44.703

你试过这个`head`命令吗？

```
head -200 inputfile > outputfile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T13:01:35.260

*   头 -10 文件.csv > 截断的.csv

    将获取 file.csv 的前 10 行并将其存储在名为 truncated.csv 的文件中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T13:09:15.603

“该文件位于 Debian 服务器上。” - 这很有趣。这基本上意味着即使您使用'head'，head从哪里检索数据？破坏目的的本地内存（在文件被复制后）。

# html - 减少需要多少 HTML 的最佳 CSS 技巧是什么？

> ID：511232
> 
> 赞同：3
> 
> 时间：2009-02-04T12:58:38.527
> 
> 标签：html, css

让您使用更少 HTML 的最聪明的 CSS 技术是什么？

很好地使用 CSS 的优点之一是它可以让您简化 HTML，并完全在 CSS 中生成外观效果。起初，这只是用 CSS 替换已弃用的 HTML 表示标记和 spacer-GIF，但近年来出现了更多好的想法。

我正在寻找比以下内容不那么明显的东西。

*   将 HTML 替换`HR`为 CSS `border`，用于分隔已经是 DIV 的部分。
*   将 HTML 替换`IMG`为 CSS `background-image`，用于不是“内容”的图形。
*   将 HTML 文本替换为 CSS`:before`和`content`, 用于不是“内容”的文本。

我不是在寻找涉及添加 JavaScript 或更多 HTML 的技术，例如额外的 DIV 元素。

仅适用于特定浏览器和版本的技术是可以的，只要您说出哪些技术。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T13:10:59.890

可以通过不在 div 中嵌套元素来省略特殊性，而只是给元素本身提供唯一标识符。

```
<div id="mylist">
    <ul>
       <li>ListItem1</li>
       <li>ListItem2</li>
    </ul>
</div> 
```

用。。。来代替

```
<ul id="mylist">
    <li>ListItem1</li>
    <li>ListItem2</li>
</ul> 
```

这样你的 CSS 将从

```
div#mylist ul li { } 
```

到

```
ul#mylist li { } 
```

并且会有更少的 HTML。

**编辑**：在不必要的情况下:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T13:14:08.540

使用巧妙的 CSS 选择器而不是额外的类或 ID。

* * *

一个例子（导航列表似乎很流行）：

```
<ul class="nav">
    <li class="section">Section 1<ul class="subnav">
        <li class="subsection">Section 1.1</li>
        <li class="subsection">Section 1.2</li>
        ⋮
    </ul></li>
    <li class="section">Section 2<ul class="subnav">
        <li class="subsection">Section 2.1</li>
        <li class="subsection">Section 2.2</li>
        ⋮
    </ul></li>
    ⋮
</ul> 
```

更好的：

```
<ul id="nav">
    <li>Section 1<ul>
        <li>Section 1.1</li>
        <li>Section 1.2</li>
        ⋮
    </ul></li>
    <li>Section 2<ul>
        <li>Section 2.1</li>
        <li>Section 2.2</li>
        ⋮
    </ul></li>
    ⋮
</ul>

#nav {
    /* first level list */
}
#nav li {
    /* first level items */
}
#nav li ul {
    /* second level list */
}
#nav li ul li {
    /* second level items */
}
⋮ 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T15:00:43.583

我认为这个问题实际上是倒退的，我能提供的最好的技术是在编写标记时甚至不考虑 CSS。

无论如何，您的标记应该努力独立于样式，并且应该有效地最小化以准确包含传达其数据所需的内容并在其内部指示分类和身份。*然后*你认为 CSS 是孤立的。

这是一个无法实现的理想，但采用 OO 方法来标记和 CSS 是前进的方向。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T14:53:57.637

由于最近再次引发了争论，以下是使用 div 和表格进行 3 列布局的区别：

```
<table>
  <tbody>
    <tr>
      <td>Column 1</td>
      <td>Column 2</td>
      <td>Column 3</td>
    </tr>
  </tbody>
</table> 
```

相比：

```
<div>Column 1</div>
<div>Column 2</div>
<div>Column 3</div> 
```

和 CSS

```
div { float:left; width:33%; } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:01:37.607

首先，您应该计划和构建您的 HTML。

假设您的网站有 3 列布局，带有页眉和页脚。每个容器都有一个 ID，如 #mainColumn、#leftColumn、#rightColumn - 都在 #cointainer 中。这些在所有页面上都是相同的。

然后，假设您使用此布局构建了 3 个页面，并且内容的结构相似 - 标题、标题、文本和列中的一些列表。例子：

*   主要的
*   爱
*   恨
*   被石头砸死

如果您将 .love 设置在与#container 相同的 div 上，您将能够更改网站上所有编辑元素的颜色，这在 Love（粉红色）、Hate（黑色和红色）和 Stoned（很多颜色！）...

但是在主页上，您可能想要对所有类别进行总结，因此您可以将 .love、.hate 和 .stoned 类放在编辑内容块上，或者可能只是放在#rightCol、#leftCol 和#mainCol。

非常基本的示例，但关键是在您对键盘发疯之前先计划一下您网站的布局和结构。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T15:04:07.867

使用 CSS 可以减少对 HTML 的需求。您使用的越多，您对 HTML 的需求就越少。我对这个帖子中的每个答案都投了赞成票，因为它们都以自己的方式正确。

想想你的 HTML 结构的语义，以及什么是相关的。建立一长串选择器意味着您将缩小文档中的钩子。同样，您可以经常向已经存在的元素添加一个类来为自己保存一个`<div>`或`<span>`标记。

尽管如此，我最喜欢的技巧是巧妙地使用`background`属性来节省`<img>`标签

# mysql - 联合在 OBIEE 中被覆盖

> ID：511238
> 
> 赞同：0
> 
> 时间：2009-02-04T13:00:37.523
> 
> 标签：mysql, obiee

我使用“联合”来组合显示不同日期的两个报告。当我自己打开报告时，显示的两个日期可以正常工作。但是，当我在仪表板上从另一个钻取（联合）报告时，它只显示一个日期。是否有我可能需要取消应用的仪表板过滤器或是否有其他解释！？我似乎无法让报告按照演习的要求发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-06T03:22:35.927

很难回答 - 需要更多信息。一些可能性：

1.  您并没有真正钻研您认为的报告。通过查看日志以了解目标报告中发生的情况，您可以学到很多东西。
2.  您可能会从第一个报告中传递不包括第二个报告中的日期的值。检查目标报告中的过滤器。查看日志中生成的 WHERE 子句。直接对数据库运行 SQL。日期是否仍被排除？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:22:58.220

您首先要检查写入 nqquery.log 的物理 SQL。也可以直接在Answers中查看log获取。另一种方法是转到管理 > 发出 SQL，启用演示服务器缓存，将调试级别设置为 7，执行 SQL 并单击查看日志链接。物理 SQl 也可以针对实际数据库进行测试，如果那是您的数据的来源。检查两者 - 你的逻辑 SQL 和你的物理 SQL 可以解决很多小问题，包括这个。

# delphi - 如何将指针转换为泛型参数类型？

> ID：511247
> 
> 赞同：5
> 
> 时间：2009-02-04T13:03:29.607
> 
> 标签：delphi, generics, casting, delphi-2009

这是我在这里的第一个问题，很高兴找到这个网站。

我的问题涉及 Delphi 2009 中的新泛型功能。基本上我试图为现有的哈希映射实现编写一个泛型包装类。现有的实现存储 (String, Pointer) 对，所以在包装类中我必须在泛型参数类型 T 和 Pointer 类型之间进行转换，反之亦然。

```
type THashMap <T : class> = class
private
  FHashList   : THashList;
  ...

end; 
```

我想到了这样的演员表（价值：T）

```
Value := (TObject (Ptr)) as T 
```

但这不起作用。编译器告诉我“运算符不适用于此操作数类型”。

有人有一些提示吗？提前非常感谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T13:35:57.263

您需要获取泛型类型参数类型的位置地址，然后将此地址类型转换为指向所需类型的指针，然后取消引用此指针并分配到结果位置。例如：

```
PObject(@Value)^ := Ptr; 
```

您不能只对类型 T 的值进行类型转换（其中 T 不受约束）的原因是编译器不知道 T 的大小；通常，非数字类型转换只能将值转换为大小相同的类型。

不幸的是，编译器不够聪明，无法确定类类型约束意味着 T 保证与指针大小相同。

此外，当前的 Delphi 2009 泛型存在创建指向类型参数类型的指针的问题。编译器不支持通用指针，但编译器允许在类中使用这种语法：

```
type
  C<T> = class
  type
    PT = ^T; // UNSUPPORTED!
  end; 
```

这可能适用于某些场景 - 并且可能对您的特定问题有所帮助 - 但它只是偶然起作用并且通常不受支持。使用风险自负。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T13:33:47.237

试试这个：

```
Value := TObject (Ptr) 
```

无需强制转换，因为将 分配`TObject`给泛型类类型变量是有效的:)

但我不知道你为什么不能`T`首先用于铸造的原因......

# c# - 方法返回一个接口

> ID：511248
> 
> 赞同：13
> 
> 时间：2009-02-04T13:03:34.040
> 
> 标签：c#, .net, oop, interface

**大家好，**

我在想这行代码

```
IDataReader myReader = questDatabase.ExecuteReader(getQuest); 
```

我正在使用 DAAB，但我不明白 ExecuteReader(DbCommand) 方法返回 IDataReader 接口的方式和含义。

**任何人都可以解释，请**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-04T13:12:42.240

它允许您使用 DataReader 而无需知道您正在使用哪种类型的 DataReader（即`SqlDataReader, OleDbDataReader, EtcDataReader`），因此如果有一天您想更改正在使用的数据读取器，它不会影响您的逻辑，换句话说，它为您提供了抽象。例如 ：

您可以使用

```
IDbCommand command = GiveMeSomeCommand();
IDataReader r = command.ExecuteReader(); 
```

不知道您使用的是哪个提供商

有可能：

```
private static IDbCommand GiveMeSomeCommand()
{
    return new OleDbCommand();
} 
```

或者它可以是

```
private static IDbCommand GiveMeSomeCommand()
{
    return new SqlCommand();
} 
```

管他呢。

编辑：

您还可以使用 DBFactories。

```
DbProviderFactory factory = GiveMeSomeFactory();
IDbCommand command = factory.CreateCommand();
IDataReader r = command.ExecuteReader();

//and create more objects
IDataAdapter adapter = factory.CreateDataAdapter();
IDbConnection conn = factory.CreateConnection(); 
```

然后在其他层创建您的提供者

```
private DbProviderFactory GiveMeSomeFactory()
{
    if(something)
        return SqlClientFactory.Instance;
    else if(somethingElse)
        return OracleFactory.Instance;
    else if(notThisAndNotThat)
        return MySqlFactory.Instance;
    else
        return WhateverFactory.Instance;

} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T13:08:25.107

该方法将返回一个对象，它是一个类的实例，并且该类的类型将支持`IDataReader`.

关键是，对象的类型并不重要，重要的是类实现了接口。

如果您正在驾驶汽车，则无需知道是福特还是丰田，您以同样的方式驾驶汽车。

驾驶*界面*是一样的，只要车子支持这个界面，就可以驾驶了。

同上`IDataReader`，一旦返回的类支持该接口，您就可以使用它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-04T13:07:27.277

*“返回一个接口”*实际上意味着：

> 返回实现该接口的某个类的实例

在这种情况下，它返回一个与对象非常相似的`SqlDataReader`对象，它允许您执行类似`Read()`的方法并实现`IDisposable`和`IDataRecord`接口。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-04T13:04:56.580

它返回一个接口，因为接口的实现并不重要，只需要接口提供的 API。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-04T13:07:41.597

它本身不是返回一个接口，而是一个支持该接口的对象。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-04T13:08:42.453

它返回一个实现这个特定接口的对象，这就是你真正关心的。该对象是一个`IDataReader`，并且可以执行所有的方法`IDataReader`。

# c# - 如何以编程方式获取特定网站 IIS6 的应用程序池名称？C＃

> ID：511263
> 
> 赞同：4
> 
> 时间：2009-02-04T13:08:14.747
> 
> 标签：c#, iis, application-pool

如何使用 C# 以编程方式获取特定网站 IIS 6 的应用程序池名称

编辑：我已经使用了 DirectoryServices 命名空间的方法，但是应用程序池名称没有被正确检索，除非它是使用相同的代码显式设置的。这意味着如果您使用 iis 管理器手动添加网站并设置应用程序池，那么当我使用 sharepoint 创建应用程序并设置不同的 appPool 时，这些代码将不起作用（它将始终返回 DefaultAppPool），这些方法不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-19T11:50:30.743

我不同意你的看法。我编写了一个测试应用程序并从中获得了正确的 AppPool 名称，即使我使用 IIS 管理器手动设置了 AppPool。

为了确保，我已经测试过一次，name 没问题；然后，我弹出 IIS 管理器，更改 AppPool，执行`iisreset`并再次运行测试应用程序 - 我得到的 AppPool 名称再次正确。我不知道您的代码是什么样的，但我的代码是这样的：

```
using System;
using System.IO;
using System.DirectoryServices;

class Class
{
    static void Main(string[] args)
    {
        DirectoryEntry entry = FindVirtualDirectory("<Server>", "Default Web Site", "<WantedVirtualDir>");
        if (entry != null)
        {
            Console.WriteLine(entry.Properties["AppPoolId"].Value);
        }
    }

    static DirectoryEntry FindVirtualDirectory(string server, string website, string virtualdir)
    {
        DirectoryEntry siteEntry = null;
        DirectoryEntry rootEntry = null;
        try
        {
            siteEntry = FindWebSite(server, website);
            if (siteEntry == null)
            {
                return null;
            }

            rootEntry = siteEntry.Children.Find("ROOT", "IIsWebVirtualDir");
            if (rootEntry == null)
            {
                return null;

            }

            return rootEntry.Children.Find(virtualdir, "IIsWebVirtualDir");
        }
        catch (DirectoryNotFoundException ex)
        {
            return null;
        }
        finally
        {
            if (siteEntry != null) siteEntry.Dispose();
            if (rootEntry != null) rootEntry.Dispose();
        }
    }

    static DirectoryEntry FindWebSite(string server, string friendlyName)
    {
        string path = String.Format("IIS://{0}/W3SVC", server);

        using (DirectoryEntry w3svc = new DirectoryEntry(path))
        {
            foreach (DirectoryEntry entry in w3svc.Children)
            {
                if (entry.SchemaClassName == "IIsWebServer" &&
                    entry.Properties["ServerComment"].Value.Equals(friendlyName))
                {
                    return entry;
                }
            }
        }
        return null;
    }
} 
```

对不起我糟糕的英语。
希望我有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T13:16:54.293

[System.DirectoryServices 命名空间](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)中的类将帮助您获取该信息。

以 Rick Strahl的[这篇文章](http://www.west-wind.com/weblog/posts/10181.aspx)为例：

```
/// <summary>
/// Returns a list of all the Application Pools configured
/// </summary>
/// <returns></returns>
public ApplicationPool[] GetApplicationPools()
{           
    if (ServerType != WebServerTypes.IIS6 && ServerType != WebServerTypes.IIS7)
        return null;

    DirectoryEntry root = this.GetDirectoryEntry("IIS://" + this.DomainName + "/W3SVC/AppPools");
      if (root == null)
            return null;

    List<ApplicationPool> Pools = new List<ApplicationPool>();

    foreach (DirectoryEntry Entry in root.Children)
    {
        PropertyCollection Properties = Entry.Properties;

        ApplicationPool Pool = new ApplicationPool();
        Pool.Name = Entry.Name;

        Pools.Add(Pool);
    }

    return Pools.ToArray();
}

/// <summary>
/// Create a new Application Pool and return an instance of the entry
/// </summary>
/// <param name="AppPoolName"></param>
/// <returns></returns>
public DirectoryEntry CreateApplicationPool(string AppPoolName)
{
    if (this.ServerType != WebServerTypes.IIS6 && this.ServerType != WebServerTypes.IIS7)
        return null;

    DirectoryEntry root = this.GetDirectoryEntry("IIS://" + this.DomainName + "/W3SVC/AppPools");
    if (root == null)
        return null;

    DirectoryEntry AppPool = root.Invoke("Create", "IIsApplicationPool", AppPoolName) as DirectoryEntry;           
    AppPool.CommitChanges();

    return AppPool;
}

/// <summary>
/// Returns an instance of an Application Pool
/// </summary>
/// <param name="AppPoolName"></param>
/// <returns></returns>
public DirectoryEntry GetApplicationPool(string AppPoolName)
{
    DirectoryEntry root = this.GetDirectoryEntry("IIS://" + this.DomainName + "/W3SVC/AppPools/" + AppPoolName);
    return root;
}

/// <summary>
/// Retrieves an Adsi Node by its path. Abstracted for error handling
/// </summary>
/// <param name="Path">the ADSI path to retrieve: IIS://localhost/w3svc/root</param>
/// <returns>node or null</returns>
private DirectoryEntry GetDirectoryEntry(string Path)
{

    DirectoryEntry root = null;
    try
    {
        root = new DirectoryEntry(Path);
    }
    catch
    {
        this.SetError("Couldn't access node");
        return null;
    }
    if (root == null)
    {
        this.SetError("Couldn't access node");
        return null;
    }
    return root;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T13:33:40.453

简而言之，有两种方法可以做到这一点。

不太复杂的方法是知道，IIS6 的设置存储在 MetaBase 中，它只是一个 Xml 文件：

```
C:\WINDOWS\system32\inetsrv\MetaBase.xml 
```

您可以只使用 Linq2Xml 并解析 Xml 以查找站点名称或 Id，AppPoolId 属性包含 AppPool 的名称

正确的方法是使用 System.DirectoryServices

# iphone - 将用户数据（电子邮件+密码）保存到您的应用程序的最佳方式是什么？

> ID：511268
> 
> 赞同：0
> 
> 时间：2009-02-04T13:09:15.947
> 
> 标签：iphone, cocoa-touch

我有一个用户可以登录的应用程序，但我不希望用户每次想要使用该应用程序时都输入他的凭据。1 次就足够了，但是如何（以及最好的方法）保存 2 个字符串，我可以通过启动应用程序来恢复这些字符串。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T13:42:02.977

iPhone 有一个类似于 OS X 的[钥匙串 API](http://developer.apple.com/iphone/library/documentation/Security/Reference/keychainservices/Reference/reference.html)。或者你可以使用[NSUserDefaults](http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)来存储它们，这会更容易但不太安全。

# cocoa-touch - "scheduledTimerWithTimeInterval:" cocos2d 中的问题？

> ID：511270
> 
> 赞同：0
> 
> 时间：2009-02-04T13:09:30.470
> 
> 标签：cocoa-touch, cocos2d-iphone

我正在尝试使用 cocos2d 开发一个 iPhone 应用程序。我使用“scheduledTimerWithTimeInterval”来调用一个调用固定时间间隔的方法。但现在时间间隔逐渐增加。由于这个原因，时间逐渐变慢。这是我的代码：

```
- (void) methodTime: (id) sender{

    NSTimer *rat =[NSTimer scheduledTimerWithTimeInterval:(.5) target:self selector:@selector(rotation:) userInfo:nil repeats:YES]; 
}

- (void) rotation:(NSTimer *)theTimer{

    NSLog(@"I m  # %i", i);
    i=i+10;   // Here , i is a global int variable.
    i=i % 1440;
        if(i==0){
            [theTimer invalidate];

        }
        else {
         int rotationNum=i;
        Sprite *sp = [Sprite spriteWithFile: @"1.png"];
        sp.position=cpv(220,180.5);
        sp.rotation=rotationNum;
        [self add:sp];      
        }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T01:22:10.083

不要使用 NSTimer。查看[cocos2d 最佳实践](http://code.google.com/p/cocos2d-iphone/wiki/BestPractices)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T11:07:16.487

看起来每 0.5 秒你就会将一个精灵添加到一些精灵列表中。最终列表变得非常大，所有这些数据导致您的方法执行时间超过 0.5 秒。这会导致计时器尽可能快地触发，但这并不是那么快，因为它总是在等待您的方法完成。

在不了解您的代码的情况下，这是我最好的猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:02:20.403

如果您所做的只是不断地旋转对象，那么 CATransforms 和 Core Animation 可能是更好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T13:24:36.180

我很难理解你的问题。您甚至没有在“问题”中使用一个引号。

您的代码是否可能需要超过 0.5 秒才能执行？特别是因为在后台完成的工作量每次迭代都会增加。（更多精灵。）

尝试使此功能更快，例如将该 PNG 加载到内存中，并且不要每次都从文件中加载它。（无论如何，这对记忆更好。）

顺便说一句：那个循环看起来很危险，就像一个无限循环。（虽然可能是它的作品......）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T11:34:54.200

我会使用 Cocos2d-iphone 的内置间隔。

通过演示 cocos 项目，您将看到在 cocos 框架中如何“应该”完成这样的事情。

# c# - C# 控制台程序 - 阻止 STDIN 转到 STDOUT

> ID：511275
> 
> 赞同：2
> 
> 时间：2009-02-04T13:11:13.650
> 
> 标签：c#, .net-2.0, console, stdout, stdin

我正在用 C#、.NET 2.0 编写一个简单的控制台应用程序。它使用线程计时器启动新线程，同时解释主线程上的命令。

我目前采取三个命令： P - 暂停 C - 继续 Q - 退出

此功能运行良好，但不幸的是，当我键入 P、C 或 Q（或任何其他字符）时，该字符会转到 STDOUT。有没有办法可以以编程方式阻止它？知道我是否可以禁用和重新启用 STDIN -> STDOUT 也会很有用。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T13:15:16.870

听起来你正在使用

```
Console.ReadKey(); 
```

在文档中清楚地说明它打印到屏幕上，如果您不想输出到屏幕上，您应该使用重载版本

```
Console.ReadKey(true); 
```

哪个不输出。

# unit-testing - 你会在 10 分钟的 Grok 单元测试演讲中包括什么

> ID：511277
> 
> 赞同：7
> 
> 时间：2009-02-04T13:11:59.357
> 
> 标签：unit-testing, theory

我很快就会在我的公司做一个 10 分钟的关于单元测试的 Grok 演讲。我自己也一直在尝试，觉得肯定能给公司带来好处。我们已经在我们专门的 QA 团队中进行了 WebInject 测试，但我想尝试向开发人员出售单元测试。

所以只有 10 分钟，你会涵盖什么，为什么？

*   我们是 Microsoft Shop C# Web 应用程序，在我的经验中我使用过 NUnit。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-04T13:14:26.187

单元测试是关于**信心**的。

它使您确信您的代码是可靠的，并且其他人在编写自己的系统部分时可以依赖它。如果你能理解单元测试将有助于消除新系统首次发布时的恐惧，我希望你的听众很快就会变得非常感兴趣。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T13:27:40.463

我会从一个很多程序员可能熟悉的问题开始：那就是害怕对现有代码进行更改，因为害怕他们可能会破坏某些东西。这如何阻止工作发生，或阻止工作正确完成（因为他们害怕重构），因此导致必须每 x 年重写一次所有内容。

单元测试 -> 重构 -> 活代码。

**编辑：** 顺便说一句，我不会引用 Michael Feathers 的“所有没有单元测试的代码都是遗留代码”。当我第一次听到它时，它确实让我感到防御。当人们不再感到被冒犯时，10 分钟将结束:-)（我个人认为这句话更真实而不是有用）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T13:19:05.177

这是一个关于技术 X 的简短演讲的好格式：

*   为什么你决定先尝试 X
*   你个人从使用 X 中获得了什么
*   你注意到了哪些限制，X 没有解决的问题

**不要**“推销”或在理论上花费大量时间。**事先做好准备，将人们引向***您*认为最有帮助的书籍、文章或教程的 URL 。对您的演讲感兴趣的人可以在网上查找详细信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T13:15:38.443

试着简单谈谈测试驱动开发的方面：首先编写测试和接口，然后实现所有内容。

也许还有关于持续集成，这意味着一旦您将某些内容签入源代码控制系统，项目就会被编译并运行所有测试，因此开发人员可以立即知道他是否做错了什么。

如果听众中有任何项目经理，也请公平地告诉他们单元测试将使您的项目多花费 15-30% 的时间，但从长远来看这是值得的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T13:22:25.670

您可能会提到这将是一个艰难的学习曲线，并且会感觉生产力受到影响，但好处是值得的：

例如，有效地创建一个自动回归测试套件，这反过来又允许您对现有的进行更大的添加或修改，而不必担心您会破坏某些现有功能。

生产代码的创建速度会更慢，但这应该被更高质量的代码所抵消，即更少的错误，从长远来看，这意味着更高的整体生产力。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T13:31:22.313

**正如 Kent Beck 所强调的，问责制**是单元测试促进的另一个特征。[在IT 对话](http://itc.conversationsnetwork.org/shows/detail301.html)中收听他的播客。（他关于问责制的观点从 30:34 开始。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T13:47:15.947

我认为 10 分钟就足以展示一个简单的示例，说明单元测试如何为您节省时间。

实现一个类（如果你愿意，可以进行 TDD）并展示单元测试如何捕获破坏类的修改。

此外，如果您单独测试，您可以强调如何更快地开发组件（即您不需要启动您的 Web 应用程序、登录、转到您的功能、测试）；你可以运行你的测试。

您可能可以在您公司的一段代码上执行此操作 - 并且可能显示单元测试如何捕获您最近遇到的错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T13:59:11.710

如果您进行演示，请在每个人都熟悉的项目中的一段工作代码上进行演示。避免人为的例子。有关 TDD 的书籍已经充满了它们，而且它们并没有真正说明 TDD 如何在实际项目中发挥作用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-04T15:04:43.967

看在上帝的份上，强调单元测试是为了测试逻辑的“单元”。我讨厌看到没有人期望必须维护的 QA 套件 NUnit 测试，其中每个“单元测试”测试 150 个（二进制）输入文件的有效输出，然后如果一个失败，则自行拉屎，而不告诉你是哪一个。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-04T15:11:50.707

我会证明：

*   它对您生成的代码的信心
*   当您更改代码时它提供的信心，因为它通过了单元测试
*   代码覆盖的好处，不再是“哦，从未测试过 else 语句！”
*   在像 Hudson 这样的 CI 平台上为每个构建运行单元测试的好处

FWIW 我们通过 MSTEST 在我们的 Hudson 机器上运行糟糕的视觉工作室测试，我有一个 xslt，Hudson 使用它来将结果转换为 nunit 格式，以便 Hudson 可以破译它们。只是把它放在那里，以防他们希望你坚持使用 Microsoft 测试平台。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T13:24:22.577

从业务角度来看，您可能想要强调这样一个事实，即单元测试可以“降低”您对代码所做的任何更改的风险。一旦你有了一套单元测试，你就可以对代码库进行更改，并知道什么会中断，什么不会。

进行用户测试可能不是一个坏主意。如果您有一组好的测试，您可以在进行更改后将失败的测试带给用户，让他们验证新结果是否正确。此外，如果您让用户为您编写新的单元测试定义，您可以简化需求收集。他们不需要能够编码，但他们确实需要能够为您提供适当的输入和预期的输出（否则他们如何知道他们要求的更改是否有效？）。

Visual Studio 有一套非常好的单元测试工具，因此一两个示例可能有助于让您的团队了解单元测试在实践中是什么样的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T14:06:09.247

穿[这件 T 恤](http://www.cafepress.com/testdriven.87124879);-)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-04T14:16:18.633

精心准备的现场演示：

1.  在您的“应用程序”中查找“错误”
2.  编写一个涵盖此错误的单元测试。
3.  修复此错误
4.  显示，您的代码是绿色的。

所以你可以证明，没有办法，*这个*错误会再次发生！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-04T14:22:33.927

另一种方法：

提出一个可以通过创建算法来解决的问题。当然，一些相对简单的事情。接下来，在 DLL 项目中对该算法进行编码。尝试潜入一些弱点（i <= array.Length 总是一个好的）。接下来，询问他们将如何测试这个 DLL。

大多数开发人员运行他们的应用程序来测试它们。但是您不能运行 DLL。您可能会收到一些建议，建议您创建一个控制台应用程序来创建执行算法的方法。向他们展示如何设计单元测试来做到这一点。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-04T15:27:40.253

有一套很好的资源用于跟进/自主学习：

*   java/c#的实用单元测试是这方面的好书
*   肯特贝克关于单元测试的论文
*   使用选择的测试框架链接到任何更大的样本

# c++ - 是否有适用于 ICU 或其他强大的 Unicode 库的 STL 和 UTF-8 友好的 C++ Wrapper

> ID：511280
> 
> 赞同：24
> 
> 时间：2009-02-04T13:13:25.017
> 
> 标签：c++, unicode, stl, localization, icu

我需要一个好的 C++ Unicode 库。我需要：

1.  以 Unicode 敏感的方式进行转换。例如，以不区分大小写的方式对所有字符串进行排序，并获取它们的第一个字符作为索引。将各种 Unicode 字符串转换为大写和小写。在合理的位置拆分文本——也适用于中文和日文的单词。
2.  以区域设置敏感的方式格式化数字、日期（应该是线程安全的）。
3.  对 UTF-8（主要内部表示）的透明支持。

据我所知，最好的图书馆是 ICU。但是，我找不到带有示例的普通开发人员友好的 API 文档。此外，据我所知，它对现代 C++ 设计、使用 STL 等不太友好。像这样：

```
std::string msg;
unistring umsg.from_utf8(msg);
unistring::word_iterator wi;
for(wi=umsg.words().begin(),n=0;wi!=usmg.words().wi_end(),n<10;++wi,++n) 
  ;
msg=umsg.substr(umsg.words().begin(),wi).to_utf8();
cout<<_("Five 10 words are ")<<msg; 
```

是否有在开源许可下发布的对 STL 友好的 ICU 包装器？首选是许可许可，如 MIT 或 Boost，但其他许可，如兼容 LGPLv2，也可以。

有没有其他类似ICU的高质量图书馆？

平台：Unix/POSIX，不需要 Windows 支持。

**编辑：**不幸的是我没有登录，所以我不能接受答案。我自己附上了答案。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-11-09T17:44:51.693

这个问题是我很久以前就问过的。没有这样的图书馆。

所以我编写了 C++ 友好的[Boost.Locale](http://lists.boost.org/Archives/boost/2010/03/162952.php)库来包装 ICU。

*   文档：[http ://cppcms.sourceforge.net/boost_locale/html/](http://cppcms.sourceforge.net/boost_locale/html/)
*   来源：[https ://sourceforge.net/projects/cppcms/files/](https://sourceforge.net/projects/cppcms/files/)

**Edit** Now 是 Boost 的一部分：参见[Boost.Locale 文档](http://www.boost.org/doc/libs/release/libs/locale/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T13:20:39.823

[wxWidgets](http://www.wxwidgets.org/) GUI 工具包有一些相当不错的字符串类和 unicode 支持。如果您不想，则不需要构建/使用 GUI 类。有关详细信息，请参见[此处](http://docs.wxwidgets.org/stable/wx_wxstring.html#wxstring)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T13:44:32.350

这符合要求吗？

[http://www.codeproject.com/KB/string/utf8cpp.aspx](http://www.codeproject.com/KB/string/utf8cpp.aspx)

# web-services - 在 REST Web 服务中处理批处理操作的模式？

> ID：511281
> 
> 赞同：180
> 
> 时间：2009-02-04T13:13:34.503
> 
> 标签：web-services, rest

对于 REST 样式 Web 服务中的资源的批处理操作，存在哪些经过验证的设计模式？

我试图在性能和稳定性方面在理想和现实之间取得平衡。我们现在有一个 API，所有操作都可以从列表资源（即：GET /user）或单个实例（PUT /user/1、DELETE /user/22 等）中检索。

在某些情况下，您希望更新整组对象的单个字段。来回发送每个对象的整个表示来更新一个字段似乎非常浪费。

在 RPC 风格的 API 中，你可以有一个方法：

```
/mail.do?method=markAsRead&messageIds=1,2,3,4... etc. 
```

这里的 REST 等价物是什么？还是可以偶尔妥协。添加一些真正提高性能的特定操作是否会破坏设计？现在所有情况下的客户端都是 Web 浏览器（客户端的 JavaScript 应用程序）。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-10-27T13:44:24.430

批处理的简单 RESTful 模式是利用集合资源。例如，一次删除多条消息。

```
DELETE /mail?&id=0&id=1&id=2 
```

批量更新部分资源或资源属性稍微复杂一些。也就是说，更新每个markedAsRead 属性。基本上，不是将属性视为每个资源的一部分，而是将其视为放置资源的存储桶。已经发布了一个示例。我稍微调整了一下。

```
POST /mail?markAsRead=true
POSTDATA: ids=[0,1,2] 
```

基本上，您正在更新标记为已读的邮件列表。

您还可以使用它来将多个项目分配给同一类别。

```
POST /mail?category=junk
POSTDATA: ids=[0,1,2] 
```

执行 iTunes 风格的批量部分更新显然要复杂得多（例如，artist+albumTitle 但不是 trackTitle）。桶类比开始崩溃。

```
POST /mail?markAsRead=true&category=junk
POSTDATA: ids=[0,1,2] 
```

从长远来看，更新单个部分资源或资源属性要容易得多。只需使用子资源。

```
POST /mail/0/markAsRead
POSTDATA: true 
```

或者，您可以使用参数化资源。这在 REST 模式中不太常见，但在 URI 和 HTTP 规范中是允许的。分号将资源内的水平相关参数分开。

更新几个属性，几个资源：

```
POST /mail/0;1;2/markAsRead;category
POSTDATA: markAsRead=true,category=junk 
```

更新几个资源，只有一个属性：

```
POST /mail/0;1;2/markAsRead
POSTDATA: true 
```

更新几个属性，只有一个资源：

```
POST /mail/0/markAsRead;category
POSTDATA: markAsRead=true,category=junk 
```

RESTful 的创造力比比皆是。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-04T13:39:57.990

一点也不——我认为 REST 等价物（或至少一个解决方案）几乎完全一样——一个专门设计的接口可以适应客户端所需的操作。

我想起了 Crane 和 Pascarello 的《[Ajax in Action》](http://www.manning.com/crane/)一书中提到的模式（顺便说一句，这是一本很棒的书——强烈推荐），其中他们说明了实现**CommandQueue**类型的对象，该对象的工作是将请求排队成批并然后定期将它们发布到服务器。

如果我没记错的话，该对象基本上只是保存了一组“命令”——例如，为了扩展您的示例，每个记录都包含一个“markAsRead”命令、一个“messageId”以及可能对回调/处理程序的引用功能——然后根据一些时间表，或者根据一些用户操作，命令对象将被序列化并发布到服务器，客户端将处理随后的后处理。

我碰巧手头没有详细信息，但听起来这种命令队列是处理您的问题的一种方法；它会大大减少整体的闲聊，它会以一种你可能会发现更灵活的方式抽象服务器端接口。

* * *

**更新**：啊哈！我在网上从那本书中找到了一个片段，并附有代码示例（尽管我仍然建议拿起真正的书！）。 [看看这里](http://www.ajax-php.org/the-role-of-the-server/?bd=page039)，从第 5.5.3 节开始：

> 这很容易编码，但会导致服务器的流量非常小，效率低下并且可能令人困惑。如果我们想控制我们的流量，我们可以捕获这些更新并**在本地将它们排队** ，然后在空闲时将它们批量发送到服务器。一个用 JavaScript 实现的简单更新队列如清单 5.13 所示。[...]
> 
> 队列维护两个数组。`queued` 是一个数字索引数组，新的更新被附加到该数组。`sent` 是一个关联数组，包含那些已发送到服务器但正在等待回复的更新。

这里有两个相关的函数——一个负责将命令添加到队列（`addCommand`），另一个负责序列化然后将它们发送到服务器（`fireRequest`）：

```
CommandQueue.prototype.addCommand = function(command)
{ 
    if (this.isCommand(command))
    {
        this.queue.append(command,true);
    }
}

CommandQueue.prototype.fireRequest = function()
{
    if (this.queued.length == 0)
    { 
        return; 
    }

    var data="data=";

    for (var i = 0; i < this.queued.length; i++)
    { 
        var cmd = this.queued[i]; 
        if (this.isCommand(cmd))
        {
            data += cmd.toRequestString(); 
            this.sent[cmd.id] = cmd;

            // ... and then send the contents of data in a POST request
        }
    }
} 
```

那应该会让你继续前进。祝你好运！

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-03-13T00:53:05.377

虽然我认为@Alex 走的是正确的道路，但从概念上讲，我认为它应该与建议的相反。

该 URL 实际上是“我们的目标资源”，因此：

```
 [GET] mail/1 
```

表示从 id 为 1 的邮件中获取记录，并且

```
 [PATCH] mail/1 data: mail[markAsRead]=true 
```

表示修补 id 为 1 的邮件记录。查询字符串是一个“过滤器”，过滤从 URL 返回的数据。

```
 [GET] mail?markAsRead=true 
```

所以在这里我们请求所有已经标记为已读的邮件。因此，对这条路径的 [PATCH] 会说“修补**已**标记为 true 的记录”......这不是我们想要实现的目标。

所以一个批处理方法，按照这个思路应该是：

```
 [PATCH] mail/?id=1,2,3 <the records we are targeting> data: mail[markAsRead]=true 
```

当然，我并不是说这是真正的 REST（不允许批处理记录操作），而是它遵循 REST 已经存在并正在使用的逻辑。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-10-22T20:06:11.283

你的语言，“这*似乎*很浪费......”，对我来说表明过早优化的尝试。除非可以证明发送对象的整个表示会对性能造成重大影响（我们说用户不能接受 > 150ms），否则尝试创建新的非标准 API 行为是没有意义的。请记住，API 越简单，就越容易使用。

对于删除，请发送以下内容，因为服务器在删除发生之前不需要知道有关对象状态的任何信息。

```
DELETE /emails
POSTDATA: [{id:1},{id:2}] 
```

下一个想法是，如果应用程序遇到与对象批量更新有关的性能问题，则应考虑将每个对象分解为多个对象。这样，JSON 有效负载只是大小的一小部分。

例如，在发送响应以更新两封单独电子邮件的“已读”和“已归档”状态时，您必须发送以下内容：

```
PUT /emails
POSTDATA: [
            {
              id:1,
              to:"someone@bratwurst.com",
              from:"someguy@frommyville.com",
              subject:"Try this recipe!",
              text:"1LB Pork Sausage, 1 Onion, 1T Black Pepper, 1t Salt, 1t Mustard Powder",
              read:true,
              archived:true,
              importance:2,
              labels:["Someone","Mustard"]
            },
            {
              id:2,
              to:"someone@bratwurst.com",
              from:"someguy@frommyville.com",
              subject:"Try this recipe (With Fix)",
              text:"1LB Pork Sausage, 1 Onion, 1T Black Pepper, 1t Salt, 1T Mustard Powder, 1t Garlic Powder",
              read:true,
              archived:false,
              importance:1,
              labels:["Someone","Mustard"]
            }
            ] 
```

我会将电子邮件的可变组件（阅读、归档、重要性、标签）拆分为一个单独的对象，因为其他组件（收件人、发件人、主题、文本）将永远不会更新。

```
PUT /email-statuses
POSTDATA: [
            {id:15,read:true,archived:true,importance:2,labels:["Someone","Mustard"]},
            {id:27,read:true,archived:false,importance:1,labels:["Someone","Mustard"]}
          ] 
```

另一种方法是利用 PATCH 的使用。明确指出您打算更新哪些属性以及应忽略所有其他属性。

```
PATCH /emails
POSTDATA: [
            {
              id:1,
              read:true,
              archived:true
            },
            {
              id:2,
              read:true,
              archived:false
            }
          ] 
```

人们声明 PATCH 应该通过提供一组更改来实现，其中包含：操作 (CRUD)、路径 (URL) 和值更改。这可能被认为是一种标准实现，但如果您查看整个 REST API，它是一种非直观的一次性实现。另外，上面的实现是[GitHub 是如何实现 PATCH](https://willnorris.com/2014/05/go-rest-apis-and-pointers)的。

总而言之，可以通过批处理操作遵守 RESTful 原则，并且仍然具有可接受的性能。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-06-21T09:30:57.723

google drive API 有一个非常有趣的系统来解决这个问题（[见这里](https://developers.google.com/drive/v3/web/batch)）。

他们所做的基本上是将不同的请求分组到一个`Content-Type: multipart/mixed`请求中，每个单独的完整请求由一些定义的分隔符分隔。批处理请求的标头和查询参数被继承到单个请求（即`Authorization: Bearer some_token`），除非它们在单个请求中被覆盖。

* * *

**示例**：（取自他们的[文档](https://developers.google.com/drive/v3/web/batch)）

**要求：**

```
POST https://www.googleapis.com/batch

Accept-Encoding: gzip
User-Agent: Google-HTTP-Java-Client/1.20.0 (gzip)
Content-Type: multipart/mixed; boundary=END_OF_PART
Content-Length: 963

--END_OF_PART
Content-Length: 337
Content-Type: application/http
content-id: 1
content-transfer-encoding: binary

POST https://www.googleapis.com/drive/v3/files/fileId/permissions?fields=id
Authorization: Bearer authorization_token
Content-Length: 70
Content-Type: application/json; charset=UTF-8

{
  "emailAddress":"example@appsrocks.com",
  "role":"writer",
  "type":"user"
}
--END_OF_PART
Content-Length: 353
Content-Type: application/http
content-id: 2
content-transfer-encoding: binary

POST https://www.googleapis.com/drive/v3/files/fileId/permissions?fields=id&sendNotificationEmail=false
Authorization: Bearer authorization_token
Content-Length: 58
Content-Type: application/json; charset=UTF-8

{
  "domain":"appsrocks.com",
   "role":"reader",
   "type":"domain"
}
--END_OF_PART-- 
```

**回复：**

```
HTTP/1.1 200 OK
Alt-Svc: quic=":443"; p="1"; ma=604800
Server: GSE
Alternate-Protocol: 443:quic,p=1
X-Frame-Options: SAMEORIGIN
Content-Encoding: gzip
X-XSS-Protection: 1; mode=block
Content-Type: multipart/mixed; boundary=batch_6VIxXCQbJoQ_AATxy_GgFUk
Transfer-Encoding: chunked
X-Content-Type-Options: nosniff
Date: Fri, 13 Nov 2015 19:28:59 GMT
Cache-Control: private, max-age=0
Vary: X-Origin
Vary: Origin
Expires: Fri, 13 Nov 2015 19:28:59 GMT

--batch_6VIxXCQbJoQ_AATxy_GgFUk
Content-Type: application/http
Content-ID: response-1

HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
Date: Fri, 13 Nov 2015 19:28:59 GMT
Expires: Fri, 13 Nov 2015 19:28:59 GMT
Cache-Control: private, max-age=0
Content-Length: 35

{
 "id": "12218244892818058021i"
}

--batch_6VIxXCQbJoQ_AATxy_GgFUk
Content-Type: application/http
Content-ID: response-2

HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
Date: Fri, 13 Nov 2015 19:28:59 GMT
Expires: Fri, 13 Nov 2015 19:28:59 GMT
Cache-Control: private, max-age=0
Content-Length: 35

{
 "id": "04109509152946699072k"
}

--batch_6VIxXCQbJoQ_AATxy_GgFUk-- 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-05-16T21:34:13.317

从我的角度来看，我认为 Facebook 的实施最好。

单个 HTTP 请求使用批处理参数和一个令牌发出。

批量发送一个 json。其中包含“请求”的集合。每个请求都有一个方法属性（get / post / put / delete / etc ...）和一个 relative_url 属性（端点的 uri），另外 post 和 put 方法允许一个“body”属性，其中字段被更新被发送。

更多信息：[Facebook 批处理 API](https://developers.facebook.com/docs/graph-api/making-multiple-requests)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-03T19:04:16.083

很棒的帖子。几天来我一直在寻找解决方案。我想出了一个解决方案，使用以逗号分隔的一堆 ID 传递查询字符串，例如：

```
DELETE /my/uri/to/delete?id=1,2,3,4,5 
```

...然后将其传递给`WHERE IN`我的 SQL 中的子句。它工作得很好，但想知道其他人如何看待这种方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T14:22:11.947

我会尝试像您的示例中那样编写范围解析器的操作。

制作一个可以读取“messageIds=1-3,7-9,11,12-15”的解析器并不麻烦。它肯定会提高覆盖所有消息的一揽子操作的效率，并且更具可扩展性。

# delphi - TDictionary 中的内存泄漏 - 解决方法有问题吗？

> ID：511289
> 
> 赞同：3
> 
> 时间：2009-02-04T13:15:51.050
> 
> 标签：delphi, memory-leaks, delphi-2009

我只是考虑使用新的 TDictionary 类型。但是在 QualityCentral 上，我读到了由 TDictionary 引起的两个内存泄漏：

[http://qc.codegear.com/wc/qcmain.aspx?d=67355](http://qc.codegear.com/wc/qcmain.aspx?d=67355)

我刚刚实现了建议的解决方法，基本上是子类化 TDictionary，覆盖析构函数并手动释放导致泄漏的两个对象：

```
destructor TMemCorrectedDictionary.Destroy;
begin
  Values.Free;
  Keys.Free;
  inherited;
end; 
```

问题是，由于 Values 和 Keys 是 TDictionary 的只读属性，我不能将它们设置为 nil。好吧，为了清楚起见，现在一切正常，但我想知道如果 CodeGear 为泄漏发布补丁并在它们自己的析构函数中再次释放这两个对象会发生什么。这不会导致访问冲突吗？

提前感谢您的阅读（并希望能回答）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T13:23:20.753

您可以`inherited`先调用并检查属性是否仍然设置：

```
destructor TMemCorrectedDictionary.Destroy;
begin
  inherited;
  Values.Free;
  Keys.Free;
end; 
```

顺便说一句：`Free`不关心要释放的实例是否为`nil`，所以如果（但仅当）`inherited Destroy`将属性设置为 ，这将起作用`nil`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-27T08:48:10.317

我不知道以前版本的 Delphi 怎么样，但在 XE5 中有一个 TObjectDictionary 类负责释放所有子项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-22T03:23:29.217

创建字典时使用此参数，它将释放对象。

```
TObjectDictionary<string, TMyClass>.Create([doOwnsValues]); 
```

# python - Django 安装的应用程序位置

> ID：511291
> 
> 赞同：19
> 
> 时间：2009-02-04T13:15:59.973
> 
> 标签：python, django

我是第一次使用 Django 的经验丰富的 PHP 程序员，我觉得这太不可思议了！

我有一个包含很多应用程序的项目，所以我想将它们分组到一个应用程序文件夹中。

所以项目的结构是：

```
/project/
/project/apps/
/project/apps/app1/
/project/apps/app2 
```

然后在 Django 设置中我放了这个：

```
INSTALLED_APPS = (
    'project.apps.app1',
    'project.apps.app2',
) 
```

这似乎不起作用？

关于如何将所有应用程序放入单独的文件夹而不是项目根目录的任何想法？

非常感谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-04T13:41:41.730

确保 '__init__.py' 文件在您的应用程序目录中，如果它不存在，它将不会被识别为包的一部分。

所以这里的每个文件夹都应该有'__init__.py'文件。（空的很好）。

```
/project/
/project/apps/
/project/apps/app1/
/project/apps/app2 
```

然后，只要您的根“模块”文件夹在您的 PYTHONPATH 中，您就可以从您的应用程序中导入。

以下是有关 python 搜索路径的文档，供您阅读：

[http://docs.python.org/install/index.html#modifying-python-s-search-path](http://docs.python.org/install/index.html#modifying-python-s-search-path)

还有一个很好的简单解释 __init__.py 文件的用途：

[http://effbot.org/pyfaq/what-is-init-py-used-for.htm](http://effbot.org/pyfaq/what-is-init-py-used-for.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T13:33:40.997

只要您的应用程序在您的 PYTHONPATH 中，一切都应该正常工作。尝试将该环境变量设置为包含您的应用程序的文件夹。

```
PYTHONPATH="/path/to/your/apps/dir/:$PYTHONPATH" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T13:33:42.277

您的顶级`urls.py`（也在 your 中命名`settings.py`）必须能够使用简单的“导入”语句来获取您的应用程序。

`import project.apps.app1.urls`行得通吗？如果没有，那么您`PYTHONPATH`的设置不正确，或者您没有将项目安装在 Python 的`site-packages`目录中。

我建议使用`PYTHONPATH`环境变量，而不是安装到站点包中。Django 应用程序（对我来说，无论如何）在站点包之外似乎更容易管理。

我们执行以下操作：

*   Django 项目进入`/opt/project/`.

*   `PYTHONPATH`包括`/opt/project`.

*   我们`settings.py`使用`apps.this`and `apps.that`(请注意，`project`名称的一部分是 的一部分，而`PYTHONPATH`不是导入的一部分。

# .net - 我应该在我的应用程序中默认设置 Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture 吗？

> ID：511293
> 
> 赞同：6
> 
> 时间：2009-02-04T13:16:40.563
> 
> 标签：.net, localization, internationalization

我有一个面向全球市场的应用程序，需要本地化。在开发过程中，我遇到了一些问题，即使我更改了语言环境，我的附属程序集似乎也从未被拾取。经过一些研究，我现在明白了为什么会这样，并且能够通过在代码中设置 CurrentUICulture 进行测试，并验证事情是否按预期工作。

现在要打包应用程序以供发布，我不确定在我的应用程序启动时为当前线程设置 Thread.CurrentThread.CurrentUICulture = Thread.CurrentThread.CurrentCulture 是否是个好主意。从好的方面来说，我的应用程序可以通过更改区域设置来本地化（如果这是一个好的方面），但我担心这可能会带来不可预见的缺点。立即浮现在脑海的是，虽然我所做的一切都很好并且对我的线程有好处，但它不适用于（从我在这里和周围阅读的理解）到由我的应用程序创建的任何线程（除非我也将 CurrentUICulture 设置在那些上）或更糟的是我使用的任何可能创建自己的线程的组件。

会不会有其他问题？将 CurrentCultures 设置为与标准做法相同的东西还是令人不悦的东西？

在做出决定之前，我想掌握尽可能多的关于这起起伏伏的信息。

谢谢

山姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T20:58:07.480

山姆，除非你真的确定你在做什么，否则不要乱来。

我假设我们在这里谈论的是 WinForms。该框架从系统中获取可以说是最好的设置（由用户配置）。从您的问题来看，这可能只是一个测试问题。我经常在#if DEBUG 之后添加一些代码来选择用于测试目的的语言环境。

我自己的例子：我的语言环境是荷兰语（nl-NL），但我通常运行英文版的 Windows。如果你覆盖 CurrentUICulture 我会得到荷兰语版本（如果有的话），这通常是可以的。但我从经验中知道，某些控件/加载项将保留为英文（包括 ShowMessage 框和 std Dialogs）。组合很丑。

但也要考虑不添加与 CurrentCulture 匹配的卫星的情况。系统将回退到您程序中的默认设置，而用户 UI 文化可能是更好的选择。我不知道所有的后备规则，但你可能会得到类似的东西：

用户在 fr-FR 窗口上运行 fr-CA 设置。您的程序回退到 en-US，用户非常高兴。

我的建议：

*   做一些实地测试
*   如果您确实构建了覆盖，则使用 app.config 中的开关

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-14T01:46:32.600

老问题，但来自用户和开发人员的一些评论：

*   我是挪威人，但我有一个英文操作系统是有原因的。当应用程序以挪威语出现时，我讨厌它，因为我的区域设置是挪威语。
*   我以前用过`Thread.CurrentThread.CurrentCulture`，虽然一开始看起来效果很好......然后突然你有一些东西会触发一个新线程......（花了很长时间弄清楚为什么我在我的应用程序中得到了正确的数字格式，但是例如，不在我的报告中）

# sql - SQL Server 2005 - 如何为数据库的一次性备份创建新的备份集

> ID：511295
> 
> 赞同：2
> 
> 时间：2009-02-04T13:16:55.087
> 
> 标签：sql, sql-server, sql-server-2005

我想创建一个数据库的一次性备份，然后我可以在我的本地机器上恢复。我不想对当前的媒体集产生任何影响。我看到一个选项“备份到新的媒体集，并删除所有现有的备份集”。我真正想要的是“Bak up to new media set”。

# sql - 将表从一个数据库复制到另一个

> ID：511302
> 
> 赞同：0
> 
> 时间：2009-02-04T13:20:09.823
> 
> 标签：sql, db2

我正在尝试将我的一些表存档到同一服务器上的另一个数据库中。但是 INSERT INTO...SELECT...FROM 在构建时给了我一个错误（SQLSTATE = 42704）。该表存在于第二个数据库中。有人能帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T14:01:53.263

我们已经破解了！如果使用以下脚本，则它可以工作。LOAD 无需在复制的批次之间进行 COMMIT 即可工作。（'Transaction Log full...'错误问题也解决了）

连接到 LS2DB001；导出到“C:\temp\TIN_TRIGGER_OUT.IXF”的 IXF 消息“C:\temp\TIN_TRIGGER_OUT.EXM” SELECT * FROM LS2USER.TIN_TRIGGER_OUT; 连接复位；连接到 LQIFCOLD；从 IXF 消息“C:\temp\TIN_TRIGGER_OUT.IMM”的“C:\temp\TIN_TRIGGER_OUT.IXF”加载插入到 LS2USER.TIN_TRIGGER_OUT 复制无索引模式自动选择；犯罪; 连接复位；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T18:30:25.203

从您的问题中不清楚正在使用哪个版本的 DB2。我假设它是 Linux、Unix 和 Windows 版本。您看起来正在使用联合来链接两个数据库。

您的查询的 SELECT 部分是否适用于 LS2DB001？值得尝试确定您遇到问题的数据库。

假设问题出在 LS2DB001 上，如果您定义了联合链接的用户对查询中的基表具有权限，则还要检查他们是否对系统目录表具有权限。如果不是，他们将无法解析和验证您是否可以运行查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T21:14:25.027

我正在写这个回复作为另一个答案，所以我有更多的空间。

我只能建议将步骤分解为它们的组件，并通过查看错误发生的位置。同样，我假设您正在使用联合：

a）在您的 FROM 数据库中，以您用于联合链接的用户身份连接，您的选择是否有效？

b）在您的 TO db 中，使用链接，选择是否有效？

c）在您的 TO db 中，使用通过存储过程的链接，选择是否有效？

d) 在您的 TO db 中，使用 INSERT...values(x,y,z)，您可以插入到表中吗？

e) 在您的 TO db 中，通过存储过程，使用 INSERT...values(x,y,z)，您可以插入吗？

如果没有更多信息，这是我可以建议的最佳攻击方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T13:35:56.267

我在[http://www.connx.com/products/connx/Connx%208.6%20UserGuide/CONNXCDD32D/DB2_SQL_States.htm](http://www.connx.com/products/connx/Connx%208.6%20UserGuide/CONNXCDD32D/DB2_SQL_States.htm)上找到了这个：42704 未定义的对象或约束名称。修改 SQL 语法并重试。

如需更多帮助，请尝试更具体，例如粘贴完整的 sql 语句、表方案等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T13:38:10.100

你可以做

```
 Select 'insert into tblxxxx (blabla,blabal) values(' + fld1 + ',' + fld2 + ',' ...... + ')'

From tblxxxxxx 
```

将结果复制为文本脚本并在另一个数据库中执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T13:43:59.370

最好的方法是创建一个自定义脚本。根据表的大小（有多少记录），您可以选择所有数据到内存中，然后翻转它们，将它们插入到您首先创建的表的副本中，或者您可以将数据导出为一个 csv 文件或其他一些基于文本的文件，然后将其翻转以将数据插入到另一个表中。

如果您还没有某种正式的备份程序可以做到这一点，那么这将是您最好的选择。

注意：一些 db2 数据库，例如 iSeries 上的那些实际上没有“数据库”，它们有库。使用正确的用户配置文件，您可以同时访问两个库，将它们中的表连接在一起或执行

```
create table library/newFilename as 
(select * from originallibrary/originalfilename) with data 
```

但这仅适用于我相信的 iSeries。

# regex - 正则表达式查找包含某些字符的行并删除该行

> ID：511309
> 
> 赞同：5
> 
> 时间：2009-02-04T13:20:46.297
> 
> 标签：regex

我有一个文本文件，其中一行接一行地包含很多字符条目。我想找到所有以开头的行`::`并删除所有这些行。

执行此操作的正则表达式是什么？

-广告

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T13:26:03.603

正则表达式不“做”任何事情。它们只匹配文本。

你想要的是一些工具，它们使用正则表达式来识别一行，然后将一些命令应用于这些工具。

一种这样的工具是`sed`（还有`awk`许多其他工具）。你会这样使用它：

```
sed -e "/^::/d" < input.txt > output.txt 
```

“ `/^::/`”部分告诉`sed`将以下命令应用于以“::”开头的所有行，而“ `d`”仅表示“删除该行”。

或者最简单的解决方案（我的大脑由于某种奇怪的原因没有产生）：

```
grep -v "^::" input.txt > output.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T13:27:17.733

```
sed -i -e '/^::/d' yourfile.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T13:25:13.700

```
^::.*[\r\n]* 
```

如果您逐行阅读文件，则不需要该`[\r\n]*`部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T13:24:08.647

简单如：

```
^:: 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T20:48:18.823

这是我在 C# 中的贡献：

文本流：

```
string stream = :: This is a comment line 
```

句法：

```
Regex commentsExp = new Regex("^::.*", RegexOptions.Singleline); 
```

用法：

```
Console.WriteLine(commentsExp.Replace(stream, string.Empty)); 
```

或者，如果我想简单地获取包含注释的文本文件并生成没有注释行的完全相同的副本，我可以使用 type 和 findstr 命令行工具的简单但有效的组合：

```
type commented.txt | findstr /v /R "^::" > uncommented.txt 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T13:37:05.173

如果你没有 sed 或 grep，找到这个并用空字符串替换：

```
^::.*[\r\n] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T13:49:56.020

感谢指点：

以下事情对我有用。在“ **::** ”之后，文本文件中可能存在任何字符，所以我给出了：

^::[a-zA-Z0-9 我把所有的标点符号都放在这里]*$

-广告

# c# - 动态创建 IList 类型的新实例

> ID：511315
> 
> 赞同：2
> 
> 时间：2009-02-04T13:21:32.457
> 
> 标签：c#, .net, generics, reflection, ilist

我的应用程序正在处理 IList 的。不同用户定义类型的 IList。我在想我可以使用反射来查看 IList 包含什么类型的对象，然后创建该类型的新实例，然后将其添加到 IList 本身？

所以在任何时候我都可能在处理

```
IList<Customer> l; 
```

我想创建一个新的客户实例

```
Customer c = new Customer(0, "None") 
```

然后将其添加到列表中

```
l.Add(c); 
```

显然，在运行时动态地执行此操作是问题的症结所在。希望有人能给我一些指点。谢谢布伦丹

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T13:52:38.510

试试这个：

```
 public static void AddNewElement<T>(IList<T> l, int i, string s)
    {
        T obj = (T)Activator.CreateInstance(typeof(T), new object[] { i, s });
        l.Add(obj);
    } 
```

用法：

```
 IList<Customer> l = new List<Customer>();
    l.Add(new Customer(1,"Hi there ..."));

    AddNewElement(l, 0, "None"); 
```

**（编辑）：**

那么试试这个：

```
 public static void AddNewElement2(IList l, int i, string s)
    {
        if (l == null || l.Count == 0)
            throw new ArgumentNullException();
        object obj = Activator.CreateInstance(l[0].GetType(), new object[] { i, s });
        l.Add(obj);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T13:38:10.660

如果您可以使用无参数构造函数并在之后设置属性，那么您可以使您的方法成为通用方法，例如：-

```
 void Process<T>(IList<T> list, int x, string y) where T : MyBase, new()
    {
        T t = new T();
        t.X = x;
        t.Y = y;
        list.Add(t);
    } 
```

MyBase 是公开 int 和 string 属性的类的基础。如果需要，您可以使用接口而不是基类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T13:38:10.990

您可以使用该[`Activator.CreateInstance`](http://msdn.microsoft.com/en-us/library/wcxyzt4d.aspx)方法通过类的类型名称（作为字符串）或`System.Type`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T15:35:28.193

我认为你应该改变你的设计。您可以使用[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。使用反射会降低性能。

这是工厂的代码。

```
public abstract class MyStore {
    public abstract string Name { get; }
    public abstract void AddItem(int id, string name);
} 
```

如果您的抽象类没有代码，您可以考虑使用接口。

然后创建客户商店。

```
public class CustomerStore : MyStore, IEnumerable<Customer> {
    List<Customer> list = new List<Customer>();

    public override string Name { get { return "Customer Store"; } }
    public override void AddItem(int id, string name) {
        list.Add(new Customer(id, name));
    }
    public IEnumerator<Customer> GetEnumerator() {
        return list.GetEnumerator();
    }
} 
```

用法

```
foreach (MyStore store in List<MyStore>)
    store.AddItem(0, "None"); 
```

如果您想考虑商店的类型，请使用

```
switch (store.Name) {
case "Customer Store":
    SomeMethod((CustomerStore)store);
    break;
default:
    throw new WhatEverException();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T17:13:50.460

您可以使用 Type.GetGenericArguments 方法返回泛型类型 IList<T> 的类型参数。然后调用适当的构造函数。

```
 Type T = l.GetType ( ).GetGenericArguments ( ) [ 0 ];
  ConstructorInfo ctor = T.GetConstructor (
    new Type [ 2 ] { typeof ( int ), typeof ( string ) } );
  System.Diagnostics.Debug.Assert ( ctor != null );
  object instance = ctor.Invoke (
    new object [ 2 ] { 0, "None" } ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T13:31:52.657

这里最大的问题是：如果你不知道类型，你怎么知道如何制作一个新的？并非世界上的每种类型都有一个接受 int 和 string 的构造函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T13:35:03.867

是的，对不起，我应该提到我将要处理的对象集将有一个接受 int 和 string 的构造函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-12-27T06:34:48.600

获取 IList 类型的最佳方法是**查看索引器的属性类型**！

```
var collectionType = targetList.GetType().GetProperty("Item").PropertyType;
var constructor = collectionType.GetConstructor(Type.EmptyTypes);
var newInstance = constructor.Invoke(null); 
```

# java - 如何诊断无效的线程访问 SWTException？

> ID：511317
> 
> 赞同：2
> 
> 时间：2009-02-04T13:22:08.197
> 
> 标签：java, eclipse, eclipse-rcp

我们正在为客户定制一个基于 Eclipse RCP 的工具。他们在其中一台计算机上加载它时遇到了问题（它在其他计算机上工作）并提供了以下错误日志。

> !会话 2009-01-23 12:09:05.593 -------------------------------------------------- --------- eclipse.buildId=unknown java.version=1.5.0_12 java.vendor=Sun Microsystems Inc. BootLoader 常量：OS=win32, ARCH=x86, WS=win32, NL=en_GB 命令行参数：-os win32 -ws win32 -arch x86
> 
> !ENTRY org.eclipse.osgi 4 0 2009-01-23 12:09:07.500 !MESSAGE Bundle com.yantra.yfc.rcp.desktop.ri 未找到。
> 
> !ENTRY org.eclipse.osgi 4 0 2009-01-23 12:09:11.906 !MESSAGE 应用程序错误!STACK 1 org.eclipse.swt.SWTException: org.eclipse.swt.SWT.error (SWT. java:3374) 在 org.eclipse.swt.SWT.error(SWT.java:3297) 在 org.eclipse.swt.SWT.error(SWT.java:3268) 在 org.eclipse.swt.widgets.Display.error (Display.java:978) 在 org.eclipse.swt.widgets.Display.checkDevice(Display.java:638) 在 org.eclipse.swt.graphics.Device.dispose(Device.java:261) 在 com.yantra。 yfc.rcp.YRCApplication.run(YRCApplication.java:176) 在 org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78) 在 org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher .runApplication(EclipseAppLauncher.java:92) 在 org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher。开始（EclipseAppLauncher.java:68）在 org.eclipse.core.runtime.adaptor.EclipseStarter.run（EclipseStarter.java:400）在 org.eclipse.core.runtime.adaptor.EclipseStarter.run（EclipseStarter.java:177）在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) 在 java.lang.reflect.Method.invoke(Unknown Source)在 org.eclipse.core.launcher.Main.invokeFramework(Main.java:334) 在 org.eclipse.core.launcher.Main.basicRun(Main.java:278) 在 org.eclipse.core.launcher.Main.run (Main.java:973) 在 org.eclipse.core.launcher.Main.main(Main.java:948)core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177) 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown源）在 java.lang.reflect.Method.invoke（未知源）在 org.eclipse.core.launcher.Main.invokeFramework(Main.java:334) 在 org.eclipse.core.launcher.Main.basicRun(Main. java:278) 在 org.eclipse.core.launcher.Main.run(Main.java:973) 在 org.eclipse.core.launcher.Main.main(Main.java:948)core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:177) 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown源）在 java.lang.reflect.Method.invoke（未知源）在 org.eclipse.core.launcher.Main.invokeFramework(Main.java:334) 在 org.eclipse.core.launcher.Main.basicRun(Main. java:278) 在 org.eclipse.core.launcher.Main.run(Main.java:973) 在 org.eclipse.core.launcher.Main.main(Main.java:948)在 org.eclipse.core.launcher.Main.invokeFramework(Main.java:334) 在 org.eclipse.core.launcher.Main.basicRun 的 java.lang.reflect.Method.invoke(Unknown Source) 调用(Unknown Source) (Main.java:278) 在 org.eclipse.core.launcher.Main.run(Main.java:973) 在 org.eclipse.core.launcher.Main.main(Main.java:948)在 org.eclipse.core.launcher.Main.invokeFramework(Main.java:334) 在 org.eclipse.core.launcher.Main.basicRun 的 java.lang.reflect.Method.invoke(Unknown Source) 调用(Unknown Source) (Main.java:278) 在 org.eclipse.core.launcher.Main.run(Main.java:973) 在 org.eclipse.core.launcher.Main.main(Main.java:948)

我用谷歌搜索了这个例外，但这似乎主要发生在人们尝试使用不同线程开发应用程序时。由于我们在任何其他计算机上都没有看到这个问题，所以我不知道是什么原因造成的。

这一定是有问题的机器上的配置问题，因为代码来自供应商（所以可能经过良好测试）并且可以在我们测试过的所有其他机器上运行。

有没有人对那台计算机的问题背后有什么建议？或者关于可能揭示问题的调查路线的建议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T18:30:49.167

Eclipse 中只有一个 UI 线程。简而言之，规则是：

*   如果您作为 UI 操作（例如事件处理程序、视图初始化）的一部分被调用，则您处于 UI 线程中。
*   调用 UI 的所有其他操作（例如，需要显示对话框或将信息发送到修改小部件的视图的作业） - 需要与 UI 线程同步。

这基本上是这样完成的：

```
 Display.getDefault().syncExec( new Runnable() {  public void run() { } }); 
```

您的代码进入 run 方法。您也可以使用该`asyncExec`方法继续，而无需等待 UI 完成。

尝试使用上面的代码片段来包装有问题的代码。

**编辑**：片段中缺少 Runnable() 的结束括号。添加片段后工作正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T12:00:38.313

在我看来，应用程序线程中抛出了一个异常，这只发生在某些机器上。可能 RCP 应用程序中有代码在 GUI 上显示异常并带有一些对话框，但这是在错误的线程中完成的。这可以解释为什么它只发生在某些机器上。它还可以解释为什么这个问题没有被发现......它可能永远不会在开发人员的计算机中发生，所以他们从不费心检查 UI 访问是否使用正确的线程完成。我曾经遇到过类似的问题。

我的建议是仔细研究：

com.yantra.yfc.rcp.YRCApplication.run(YRCApplication.java:176)

由于代码是使用行号编译的，因此即使您没有源代码，也可以将调试器附加到该行，并尝试查看会发生什么。我很确定当你在有问题的机器上点击这个断点时，会抛出一个异常。那将是您的“真实”例外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T18:40:52.437

您还可以在[The Official Eclipse FAQs](http://wiki.eclipse.org/index.php/Eclipse_FAQs)中找到答案，特别是：[为什么我得到一个无效的线程访问异常？](http://wiki.eclipse.org/FAQ_Why_do_I_get_an_invalid_thread_access_exception%3F)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T02:06:57.990

如果查看 YRCApplication 第 176 行的源代码没有帮助（为什么它在即将启动时调用 Display.dispose()？），我会将外部调试器附加到该特定机器上运行的进程。查看[http://wiki.eclipse.org/Ninja#How_to_run_Eclipse_so_that_you_can_attach_an_external_debugger](http://wiki.eclipse.org/Ninja#How_to_run_Eclipse_so_that_you_can_attach_an_external_debugger)以获取说明；如果您尝试从远程计算机远程调试情况，则必须确保防火墙等没有阻止调试器使用的 TCP 连接。

# vb.net - VB.NET渐变填充表单上的透明控件背景？

> ID：511320
> 
> 赞同：1
> 
> 时间：2009-02-04T13:22:21.817
> 
> 标签：vb.net, winforms

我正在用漂亮的渐变填充（通过覆盖 OnPaint 事件）填充一些 VB.NET 2005 WinForms 表单的背景。这很好用，但即使在我将 BackColor 设置为 Color.Transparent 之后，表单上的各种标签等也会以纯色背景显示。设置表单本身的透明度键似乎会影响这一点，但我无法让标签具有真正透明的背景色，是否有一种简单的方法可以解决这个问题，或者我是否正在查看自定义控件等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T21:17:24.210

向您的项目添加一个新类并粘贴如下所示的代码。建造。将新控件从工具箱顶部拖放到表单上。

```
Public Class TransparentLabel
    Inherits Label

    Public Sub New()
        Me.SetStyle(ControlStyles.Opaque, True)
        Me.SetStyle(ControlStyles.OptimizedDoubleBuffer, False)
    End Sub

    Protected Overrides ReadOnly Property CreateParams() As System.Windows.Forms.CreateParams
        Get
            Dim cp As CreateParams = MyBase.CreateParams
            cp.ExStyle = cp.ExStyle Or &H20  ' Turn on WS_EX_TRANSPARENT
            Return cp
        End Get
    End Property
End Class 
```

闪烁可能很明显，没有修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T09:36:41.357

经过一些实验，我发现以下适用于渐变填充表单背景和保留标签透明度：

```
Protected Overrides Sub OnPaint(ByVal e As System.Windows.Forms.PaintEventArgs)

    Dim formGraphics As Graphics = e.Graphics
    Dim gradientBrush As New LinearGradientBrush(New Point(0, Height), New Point(0, 0), Me.AppSettings.FormGradiantFrom, Me.AppSettings.FormGradiantTo)

    formGraphics.FillRectangle(gradientBrush, ClientRectangle)

End Sub 
```

在表单加载事件中：

```
SetStyle(ControlStyles.AllPaintingInWmPaint Or ControlStyles.DoubleBuffer Or _
               ControlStyles.ResizeRedraw Or ControlStyles.UserPaint, True) 
```

# c# - 反序列化 XML 文件的最有效方法是什么

> ID：511322
> 
> 赞同：3
> 
> 时间：2009-02-04T13:22:48.697
> 
> 标签：c#, performance, xml-serialization, sgen

阿罗哈，

我有一个想要反序列化的 8MB XML 文件。我正在使用这段代码：

```
public static T Deserialize<T>(string xml)
{
    TextReader reader = new StringReader(xml);
    Type type = typeof(T);
    XmlSerializer serializer = new XmlSerializer(type);
    T obj = (T)serializer.Deserialize(reader);
    return obj; 
} 
```

这段代码运行大约一分钟，这对我来说似乎相当慢。我尝试使用 sgen.exe 来预编译序列化 dll，但这并没有改变性能。

我还有哪些其他选择来提高性能？

[编辑] 我需要反序列化创建的对象来执行（基本）转换。XML 是从外部 Web 服务接收的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T13:28:00.073

XmlSerializer 使用反射，因此如果性能是一个问题，则不是最佳选择。

`XmlDocument`您可以使用或类构建 XML 文档的 DOM`XDocument`并使用它，或者甚至更快地使用`XmlReader`. 但是，这`XmlReader`需要您自己编写任何对象映射（如果需要）。

哪种方法最好取决于您想对 XML 数据做什么。您只是需要提取某些值还是必须工作和编辑整个文档对象模型？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T15:46:04.957

是的，它确实使用反射，但性能是一个灰色区域。当谈论一个 8mb 的文件时......是的，它会慢得多。但如果处理一个小文件，它就不会。

我不会说读取文件小瓶 XmlReader 或 XPath 会更容易或真的更快。有什么比告诉某些东西将您的 xml 转换为对象或将您的对象转换为 XML 更容易...？不多。

现在，如果您需要细粒度控制，那么也许您需要手动进行。

个人选择是这样的。我愿意放弃一点速度来节省大量丑陋的代码。

就像软件开发中的其他一切一样，也有权衡取舍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T11:23:45.317

您可以尝试在“T”类中实现 IXmlSerializable 编写自定义逻辑来处理 XML。

# windows - OCX 的入口点

> ID：511329
> 
> 赞同：2
> 
> 时间：2009-02-04T13:24:04.293
> 
> 标签：windows, com, dll, activex

ocx 的入口点是什么？它们与 com dll 相同吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T13:44:53.177

是的，入口点是相同的。不过，OCX 上可能存在与 COM DLL 不同的其他约束。例如，COM DLL 包含一个类型库作为内置资源是很常见的（但不是必需的）。我见过的每个 OCX 都以这种方式内置了它的类型库，所以也许这就是 OCX 的要求？通常，OCX 中定义的 coclass（或至少其中一些）应该是 ActiveX 控件，这意味着它们应该实现某些特定的 COM 接口。一个普通的旧 COM DLL 没有这样的期望。

# ruby - 自动化脚本：点击 Ruby 警报窗口上的“取消”按钮

> ID：511335
> 
> 赞同：0
> 
> 时间：2009-02-04T13:24:45.323
> 
> 标签：ruby, selenium

我想知道有没有办法在警报窗口上选择（单击）取消按钮？

我用了：

```
@browser.choose_cancel_on_next_confirmation()
@browser.click("//td[text() = 'mailik@mm.com']/../td//a[text()='Delete']") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T20:05:10.067

Without knowing anything else and assuming you're now working with selenium webdriver 2...

I'm assuming @browser is the webdriver object...

You need to use the switch_to method to change focus to the alert box and dismiss it

```
alert = @browser.switch_to.alert
alert.dismiss 
```

[http://selenium.googlecode.com/svn/trunk/docs/api/rb/Selenium/WebDriver/Alert.html#dismiss-instance_method](http://selenium.googlecode.com/svn/trunk/docs/api/rb/Selenium/WebDriver/Alert.html#dismiss-instance_method)

# apache - 如何将字符从子域移动到 Apache mod rewrite 中的文件名？

> ID：511336
> 
> 赞同：2
> 
> 时间：2009-02-04T13:24:50.407
> 
> 标签：apache, mod-rewrite

我有这个网址：

```
http://hostX.site.com/some_path_here/filename.jpg 
```

并需要将其重写为：

```
http://host.site.com/same_path_here/filenameX.jpg 
```

你能告诉我这是否可能吗？基本上我试图将“ **X** ”（它是一个数字）从子域移动到文件名的末尾，就在扩展名之前。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T13:44:03.597

这样的事情应该这样做：

```
RewriteCond %{HTTP_HOST} ^host(\d)\.example\.com$
RewriteRule (.*)\.([^/.]+)$ http://host.example.com/$1%1.$2 
```

但是由于主机不同，这会导致外部重定向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T13:37:03.473

（未经测试，）这样的事情应该可以工作：

```
RewriteCond %{HTTP_HOST} host(\d).site.com
RewriteRule (.*)\.(.*) host.site.com/$1%1.$2 
```

您需要通过 RewriteCond 提取主机号。在 RewriteRule 中，您可以将数字与 %-modifier 一起使用

高温高压

# wpf - 绑定到动画属性 (WPF)

> ID：511345
> 
> 赞同：2
> 
> 时间：2009-02-04T13:26:53.477
> 
> 标签：wpf, data-binding, animation, properties

有谁知道，是否有办法使用动画属性作为绑定的源？据我所知，动画并没有“真正”设置属性的值，因此不会触发更改的事件，这是触发绑定所必需的。

蒂亚·马丁

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T14:22:38.060

我不知道你说的是不是真的。在下面的 XAML 中，TextBlock 将显示 Rectangle 的宽度。当您单击 Rectangle 时，Width 属性从 50 变为 300。随着每个增量，TextBlock 的值都会发生变化。我不明白你的问题吗？

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition Height="*" />
    <RowDefinition Height="Auto" />
  </Grid.RowDefinitions>
  <TextBlock Text="{Binding ElementName=Rect,Path=Width}" Grid.Row="0" />
  <Rectangle Grid.Row="1"
             Name="Rect"
             Height="30"
             Width="50"
             Fill="Blue"
             HorizontalAlignment="Left">
    <Rectangle.Triggers>
      <EventTrigger RoutedEvent="Rectangle.MouseLeftButtonDown">
        <EventTrigger.Actions>
          <BeginStoryboard>
            <Storyboard>
              <DoubleAnimation Storyboard.TargetProperty="Width"
                From="50"
                To="300"
                Duration="0:0:10"/>
            </Storyboard>
          </BeginStoryboard>
        </EventTrigger.Actions>
      </EventTrigger>
    </Rectangle.Triggers>
  </Rectangle>
</Grid> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T15:19:18.727

动画实际上确实改变了值，它确实调用了您传递给 DependecyProperty.Register 的属性更改回调，并且它确实导致需要布局/渲染传递 ID。

# c# - VB.NET 中的常见事件处理程序

> ID：511355
> 
> 赞同：0
> 
> 时间：2009-02-04T13:29:44.687
> 
> 标签：c#, vb.net, events, event-handling, this

我的表单上有大约 10 个按钮，我希望它们调用相同的 Click 事件处理程序。

但为此我需要通用事件处理程序，并且我们在 VB.NET 中没有“this”关键字来引用导致事件的控件。

如何在 VB.NET 中实现“this”关键字的功能？

我希望能够编写一个执行以下操作的事件处理程序：

```
Private Sub cmdButton1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdButton1.Click

    currentTag = this.Tag

End Sub 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T13:31:25.167

> 如何在 VB.NET 中实现“this”关键字的功能？

`this``Me`在VB中调用。但是，这与您的代码无关，而是指包含类，在您的情况下很可能是当前的`Form`. 您需要访问`sender`对象参数，将其转换为`Control`：

```
currentTag = DirectCast(sender, Control).Tag 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T13:31:10.550

在[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中，`Me`相当于 C# 的`this`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T13:31:16.760

我想你想要`Me`关键字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T19:50:45.910

在 VB.NET`this`中称为`me`，关于 VB.NET 处理程序的第二个问题的解决方案是：您可以在语句`Handles`末尾添加，例如：`Private Sub`

```
Private Sub cmdButton1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) _
    Handles cmdButton1.Click, 'cmdButton2.click, cmdButton3.click'

    currentTag = this.Tag

End Sub 
```

# javascript - 在 asp.net 中使用 doPostBack 函数

> ID：511358
> 
> 赞同：5
> 
> 时间：2009-02-04T13:30:14.810
> 
> 标签：javascript, asp.net

我想在我的链接中使用 doPostBack 功能。当用户单击它时，它不会重定向到另一个页面，页面将被回发。我正在使用此代码，但它不起作用。我错过了哪里？

```
< a id="Sample" href="javascript:__doPostBack('__PAGE','');">

 function __doPostBack(eventTarget, eventArgument)

  {
           var theform = document.ctrl2

           theform.__EVENTTARGET.value = eventTarget

           theform.__EVENTARGUMENT.value = eventArgument

           theform.submit()
       } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T13:35:35.627

__doPostBack 是一个自动生成的函数，可确保页面回发到服务器以维护页面状态。它不打算用于重定向......

您可以`window.location.href="yourpage.aspx"`在进行回发的页面上的服务器端使用 javascript 或 Response.Redirect("yourpage.aspx") 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T13:45:27.073

试试这个 ：

```
System.Web.UI.HtmlControls.HtmlAnchor myAnchor = new System.Web.UI.HtmlControls.HtmlAnchor();
string postbackRef = Page.GetPostBackEventReference(myAnchor);
myAnchor.HRef = postbackRef; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T13:52:48.870

为什么要手动进行回发？如果您的信息已过期，您可以考虑使用 AJAX 计时器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T13:53:01.020

好的，但我在我的数据网格中使用链接，当用户单击链接时，我只想回发数据网格内容（因此链接将更改数据网格内容，它不是列。它是像维基百科一样的简单文本。链接已创建在此代码的运行时，我正在使用 UpdatePanels）。

str = regex.Replace(str, "(look: <a href=""javascript:" & Page.GetPostBackEventReference(Me) & ">< font color=""#CC0000"">$1 </a> )")

如果我使用window.location.href，它将回发所有页面。我的目标是只回发数据网格（当然也将链接的文本作为输出）。我不使用框架，链接不是按钮。我该怎么做它？

# mysql - 如何在 mysql 中使用删除级联？

> ID：511361
> 
> 赞同：43
> 
> 时间：2009-02-04T13:31:20.783
> 
> 标签：mysql, sql, foreign-keys, cascade

我有一个组件数据库。每个组件都属于特定类型。这意味着组件和类型之间存在多对一的关系。当我删除一个类型时，我想删除所有具有该类型外键的组件。但是如果我没记错的话，级联删除会在删除组件时删除类型。有什么办法可以做我描述的吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-04T13:37:48.727

这是您要包含在组件表中的内容。

```
CREATE TABLE `components` (
    `id` int(10) unsigned NOT NULL auto_increment,
    `typeId` int(10) unsigned NOT NULL,
    `moreInfo` VARCHAR(32), 
    -- etc
    PRIMARY KEY (`id`),
    KEY `type` (`typeId`)
    CONSTRAINT `myForeignKey` FOREIGN KEY (`typeId`)
      REFERENCES `types` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) 
```

请记住，您需要使用 InnoDB 存储引擎：默认的 MyISAM 存储引擎不支持外键。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-07-25T08:14:29.583

使用这个 sql

DELETE T1, T2 FROM T1 INNER JOIN T2 ON T1.key = T2.key WHERE 条件

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-04T09:30:57.947

您必须将外键约束定义为 ON DELETE CASCADE。

**注意：**您需要使用 InnoDB 存储引擎，默认的 MyISAM 存储引擎不支持外键关系。

```
CREATE TABLE `table2` (
`id` int(11) NOT NULL auto_increment,
`name` int(11) NOT NULL,

PRIMARY KEY (`id`),
KEY `ids` (`ids`)
CONSTRAINT `foreign` FOREIGN KEY (`ids`)
  REFERENCES `table2` (`ids`) ON DELETE CASCADE ON UPDATE CASCADE
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-28T04:02:27.517

```
Step 1\. Create the buildings table:

CREATE TABLE buildings (
  building_no INT PRIMARY KEY AUTO_INCREMENT,
  building_name VARCHAR(255) NOT NULL,
  address VARCHAR(255) NOT NULL
);

Step 2\. Create the rooms table:

CREATE TABLE rooms (
  room_no INT PRIMARY KEY AUTO_INCREMENT,
  room_name VARCHAR(255) NOT NULL,
  building_no INT NOT NULL,
  FOREIGN KEY (building_no)
    REFERENCES buildings (building_no)
    ON DELETE CASCADE
);

Notice that the ON DELETE CASCADE  clause at the end of the foreign key constraint 
definition. 
```

# eclipse - 更新eclipse时出错

> ID：511367
> 
> 赞同：34
> 
> 时间：2009-02-04T13:32:14.590
> 
> 标签：eclipse, eclipse-plugin

我在 Eclipse 中单击更新，但出现错误，这是因为我不止一次更新了 Eclipse。有什么方法可以修复 eclipse 并能够使用更新？

```
收集要安装的项目时出错
  未找到包含以下内容的存储库：org.eclipse.jem/osgi.bundle/2.0.202.v200810282000
  找不到包含以下内容的存储库：org.eclipse.jem.workbench/osgi.bundle/2.0.102.v200810230530
  找不到包含以下内容的存储库：org.eclipse.jpt.core/osgi.bundle/2.1.0.v200812160210
  找不到包含以下内容的存储库：org.eclipse.jpt.doc.user/osgi.bundle/1.0.300.v200812110000
  找不到包含以下内容的存储库：org.eclipse.jpt.eclipselink.core/osgi.bundle/1.1.0.v200812110000
  找不到包含以下内容的存储库：org.eclipse.jpt.eclipselink.core.ddlgen/osgi.bundle/1.0.100.v200811030000
  找不到包含以下内容的存储库：org.eclipse.jpt.eclipselink.feature/org.eclipse.update.feature/2.1.0.v200812180210-318Y9oA55S8_795555
  找不到包含以下内容的存储库：org.eclipse.jpt.eclipselink.ui/osgi.bundle/1.1.0.v200812100000
  找不到包含以下内容的存储库：org.eclipse.jpt.feature/org.eclipse.update.feature/2.1.0.v200812180210-7979AgCYQCD4IRJdCEDC
  找不到包含以下内容的存储库：org.eclipse.jpt.ui/osgi.bundle/2.1.0.v200812080000
  找不到包含以下内容的存储库：org.eclipse.jst.common.frameworks/osgi.bundle/1.1.201.v200810161330
  找不到包含以下内容的存储库：org.eclipse.jst.ejb.doc.user/osgi.bundle/1.1.100.v200810092245
  找不到包含以下内容的存储库：org.eclipse.jst.ejb.ui/osgi.bundle/1.1.203.v200810010400
  找不到包含以下内容的存储库：org.eclipse.jst.enterprise_core.feature/org.eclipse.update.feature/3.0.3.v200810010400-42E_4_kE77c_FAP7X99
  找不到包含以下内容的存储库：org.eclipse.jst.enterprise_ui.feature/org.eclipse.update.feature/3.0.3.v200810010400-7Y7BFSrEPOwQPnUuwhYV60NEQtTn
  找不到包含以下内容的存储库：org.eclipse.jst.enterprise_userdoc.feature/org.eclipse.update.feature/3.0.3.v200810131754-52EFBAgI99mAV9oGIHb
  找不到包含以下内容的存储库：org.eclipse.jst/org.eclipse.update.feature/3.0.3.v200809250443-7U-9-9LJGGJebgG8HYgv5FBP0NUr
  未找到包含以下内容的存储库：org.eclipse.jst.j2ee/osgi.bundle/1.1.204.v200811130630
  找不到包含以下内容的存储库：org.eclipse.jst.j2ee.core/osgi.bundle/1.1.202.v200811111600
  找不到包含以下内容的存储库：org.eclipse.jst.j2ee.ejb/osgi.bundle/1.1.203.v200811060500
  找不到包含以下内容的存储库：org.eclipse.jst.j2ee.jca/osgi.bundle/1.1.203.v200811060900
  找不到包含以下内容的存储库：org.eclipse.jst.j2ee.navigator.ui/osgi.bundle/1.1.202.v200810222000
  找不到包含以下内容的存储库：org.eclipse.jst.j2ee.ui/osgi.bundle/1.1.204.v200811041823
  找不到包含以下内容的存储库：org.eclipse.jst.j2ee.web/osgi.bundle/1.1.202.v200811060500
  找不到包含以下内容的存储库：org.eclipse.jst.j2ee.webservice.ui/osgi.bundle/1.1.201.v200811062130
  找不到包含以下内容的存储库：org.eclipse.jst.jee/osgi.bundle/1.0.102.v200811060500
  找不到包含以下内容的存储库：org.eclipse.jst.jee.ejb/osgi.bundle/1.0.102.v200810230722
  未找到包含以下内容的存储库：org.eclipse.jst.jee.ui/osgi.bundle/1.0.103.v200811131900
  找不到包含以下内容的存储库：org.eclipse.jst.jee.web/osgi.bundle/1.0.101.v200810230738
  找不到包含以下内容的存储库：org.eclipse.jst.jsp.core/osgi.bundle/1.2.120.v200810301812
  未找到包含以下内容的存储库：org.eclipse.jst.jsp.ui/osgi.bundle/1.1.311.v200810210016
  找不到包含以下内容的存储库：org.eclipse.jst.server.core/osgi.bundle/1.1.2.v20080930
  未找到包含以下内容的存储库：org.eclipse.jst.server.tomcat.core/osgi.bundle/1.1.104.v20081006
  未找到包含以下内容的存储库：org.eclipse.jst.server_adapters.feature/org.eclipse.update.feature/3.0.3.v20081006b-787KEKFDUUEFDFrPa7AMQ
  找不到包含以下内容的存储库：org.eclipse.jst.server_core.feature/org.eclipse.update.feature/3.0.3.v20080930b-377Ap9oA55S5N_C35AC
  找不到包含以下内容的存储库：org.eclipse.jst.server_ui.feature/org.eclipse.update.feature/3.0.3.v20081001-79-EDn9wKSZRCCNQMfVnIG8BHD
  找不到包含以下内容的存储库：org.eclipse.jst.servlet.ui/osgi.bundle/1.1.203.v200810222000
  找不到包含以下内容的存储库：org.eclipse.jst.web_core.feature/org.eclipse.update.feature/3.0.3.v200810020322-7M7AEX2EFp_acwkiuz-bTpl
  找不到包含以下内容的存储库：org.eclipse.jst.web_ui.feature/org.eclipse.update.feature/3.0.3.v200810020322-7E4EArDgvY1en0e_Bm21-ljvz00c
  找不到包含以下内容的存储库：org.eclipse.jst.ws.axis.consumption.core/osgi.bundle/1.0.306.v200810082309
  未找到包含以下内容的存储库：org.eclipse.jst.ws.axis.consumption.ui/osgi.bundle/1.0.305.v200809301934
  找不到包含以下内容的存储库：org.eclipse.jst.ws.axis2.core/osgi.bundle/1.0.104.v200810151442
  找不到包含以下内容的存储库：org.eclipse.jst.ws.axis2tools.feature/org.eclipse.update.feature/1.0.2.v200810151341-77-E_ECYQCD4FdMjLXVW
  找不到包含以下内容的存储库：org.eclipse.jst.ws.consumption/osgi.bundle/1.0.306.v200810012118
  未找到包含以下内容的存储库：org.eclipse.jst.ws.consumption.ui/osgi.bundle/1.1.3.v200810012118
  找不到包含以下内容的存储库：org.eclipse.jst.ws.consumption.ui.doc.user/osgi.bundle/1.0.500.v200810082020
  找不到包含以下内容的存储库：org.eclipse.jst.ws.creation.ui/osgi.bundle/1.0.307.v200810012118
  找不到包含以下内容的存储库：org.eclipse.wst.command.env/osgi.bundle/1.0.307.v200810082309
  找不到包含以下内容的存储库：org.eclipse.wst.common.emf/osgi.bundle/1.1.203.v200811022047
  找不到包含以下内容的存储库：org.eclipse.wst.common.emfworkbench.integration/osgi.bundle/1.1.202.v200811131900
  未找到包含以下内容的存储库：org.eclipse.wst.common.frameworks/osgi.bundle/1.1.201.v200811060900
  找不到包含以下内容的存储库：org.eclipse.wst.common.frameworks.ui/osgi.bundle/1.1.201.v200810020330
  未找到包含以下内容的存储库：org.eclipse.wst.common.modulecore/osgi.bundle/1.1.204.v200811062000
  找不到包含以下内容的存储库：org.eclipse.wst.common.project.facet.core/osgi.bundle/1.3.4.v200810151458
  未找到包含以下内容的存储库：org.eclipse.wst.common.ui/osgi.bundle/1.1.302.v200810160107
  未找到包含以下内容的存储库：org.eclipse.wst.common_core.feature/org.eclipse.update.feature/3.0.3.v200809301154-7C7_EVIE_EkMNrTtU7X4h2
  找不到包含以下内容的存储库：org.eclipse.wst.common_ui.feature/org.eclipse.update.feature/3.0.3.v200809301154-7C78ELcE8VrRVouGlyiT4DsUuV8Y
  找不到包含以下内容的存储库：org.eclipse.wst/org.eclipse.update.feature/3.0.3.v200809250443-7A-8i8Qqcz0FaVgjXSD6brFQN64Z
  找不到包含以下内容的存储库：org.eclipse.wst.html.core/osgi.bundle/1.1.203.v200810291731
  找不到包含以下内容的存储库：org.eclipse.wst.html.ui/osgi.bundle/1.0.302.v200810291731
  找不到包含以下内容的存储库：org.eclipse.wst.jsdt.core/osgi.bundle/1.0.103.v200811042159
  未找到包含以下内容的存储库：org.eclipse.wst.jsdt.doc/osgi.bundle/1.0.103.v200810081720
  找不到包含以下内容的存储库：org.eclipse.wst.jsdt.feature/org.eclipse.update.feature/1.0.3.v200810020426-6-E73BcMAAwFIFUHpRJ
  找不到包含以下内容的存储库：org.eclipse.wst.jsdt.support.firefox/osgi.bundle/1.0.103.v200810021840
  找不到包含以下内容的存储库：org.eclipse.wst.jsdt.support.ie/osgi.bundle/1.0.103.v200810021840
  找不到包含以下内容的存储库：org.eclipse.wst.jsdt.ui/osgi.bundle/1.0.103.v200810301820
  找不到包含以下内容的存储库：org.eclipse.wst.jsdt.web.core/osgi.bundle/1.0.103.v200810021840
  找不到包含以下内容的存储库：org.eclipse.wst.jsdt.web.support.jsp/osgi.bundle/1.0.103.v200810081720
  找不到包含以下内容的存储库：org.eclipse.wst.jsdt.web.ui/osgi.bundle/1.0.103.v200810021840
  找不到包含以下内容的存储库：org.eclipse.wst.server.core/osgi.bundle/1.1.2.v20081020
  找不到包含以下内容的存储库：org.eclipse.wst.server.ui/osgi.bundle/1.1.3.v20080930
  未找到包含以下内容的存储库：org.eclipse.wst.server.ui.doc.user/osgi.bundle/1.1.100.v200810082048
  找不到包含以下内容的存储库：org.eclipse.wst.server_core.feature/org.eclipse.update.feature/3.0.3.v20080930b-20Al8s733I48671256
  未找到包含以下内容的存储库：org.eclipse.wst.server_ui.feature/org.eclipse.update.feature/3.0.3.v20080930b-791CO9vESQmvbHKYENNI76CH
  找不到包含以下内容的存储库：org.eclipse.wst.server_userdoc.feature/org.eclipse.update.feature/3.0.100.v200810082053-108Y7w311921193159
  找不到包含以下内容的存储库：org.eclipse.wst.sse.ui/osgi.bundle/1.1.3.v200810301815
  未找到包含以下内容的存储库：org.eclipse.wst.validation/osgi.bundle/1.2.3.v200811101716
  未找到包含以下内容的存储库：org.eclipse.wst.validation.ui/osgi.bundle/1.2.2.v200810221105
  找不到包含以下内容的存储库：org.eclipse.wst.web/osgi.bundle/1.1.205.v200811132030
  找不到包含以下内容的存储库：org.eclipse.wst.web_core.feature/org.eclipse.update.feature/3.0.3.v200810010400-7G2EAsAM214fK_RKaovH35PiPtaH
  找不到包含以下内容的存储库：org.eclipse.wst.web_ui.feature/org.eclipse.update.feature/3.0.3.v200810010400-7R0EOzE8Ks9uCz0nqrQF6yCFSQyI
  找不到包含以下内容的存储库：org.eclipse.wst.ws.explorer/osgi.bundle/1.0.308.v200811062250
  找不到包含以下内容的存储库：org.eclipse.wst.ws_core.feature/org.eclipse.update.feature/3.0.3.v200810012109-7H7QECgED69XqKg9nufm2_7C5J
  未找到包含以下内容的存储库：org.eclipse.wst.ws_ui.feature/org.eclipse.update.feature/3.0.3.v200810012109-7E2EFVC-2f_FDJhnGKZmULIbsTaU
  找不到包含以下内容的存储库：org.eclipse.wst.ws_userdoc.feature/org.eclipse.update.feature/3.0.2.v200810081944-34EDe9oA55S6I5S8KCS
  找不到包含以下内容的存储库：org.eclipse.wst.ws_wsdl14.feature/org.eclipse.update.feature/1.4.1.v200809302010-13-7w311917141518
  未找到包含以下内容的存储库：org.eclipse.wst.ws_wsdl15.feature/org.eclipse.update.feature/1.5.2.v200809302010-1407w311917141519
  找不到包含以下内容的存储库：org.eclipse.wst.wsdl/osgi.bundle/1.1.202.v200809291819
  找不到包含以下内容的存储库：org.eclipse.wst.wsdl.ui/osgi.bundle/1.2.103.v200810301738
  找不到包含以下内容的存储库：org.eclipse.wst.wsdl.ui.doc.user/osgi.bundle/1.0.501.v200810081958
  找不到包含以下内容的存储库：org.eclipse.wst.xml.core/osgi.bundle/1.1.306.v200810210016
  找不到包含以下内容的存储库：org.eclipse.wst.xml.ui/osgi.bundle/1.0.420.v200810220345
  找不到包含以下内容的存储库：org.eclipse.wst.xml_core.feature/org.eclipse.update.feature/3.0.3.v200810021802-7A7NEH0E7QYGHNIxPlGgVY
  找不到包含以下内容的存储库：org.eclipse.wst.xml_ui.feature/org.eclipse.update.feature/3.0.3.v200809292000-7F2ENZCwum8U9-9yPhHnPkSb2VAc
  找不到包含以下内容的存储库：org.eclipse.wst.xml_userdoc.feature/org.eclipse.update.feature/3.0.3.v200810090336-40EJs_kE77c8P_TALGS
  找不到包含以下内容的存储库：org.eclipse.wst.xmleditor.doc.user/osgi.bundle/1.0.500.v200810081958
  找不到包含以下内容的存储库：org.eclipse.wst.xsd.core/osgi.bundle/1.1.302.v200810020300
  找不到包含以下内容的存储库：org.eclipse.wst.xsd.ui/osgi.bundle/1.2.104.v200810020602
  找不到包含以下内容的存储库：org.eclipse.jpt.db/osgi.bundle/1.2.0.v200810300000
  未找到包含以下内容的存储库：org.eclipse.jpt.db.ui/osgi.bundle/1.1.0.v200808210000
  未找到包含以下内容的存储库：org.eclipse.jpt.gen/osgi.bundle/1.2.0.v200810080000
  找不到包含以下内容的存储库：org.eclipse.jpt.utility/osgi.bundle/1.3.0.v200811030000
  找不到包含以下内容的存储库：org.eclipse.jst.ws/osgi.bundle/1.0.306.v200810020426
  找不到包含以下内容的存储库：org.eclipse.jst.ws.axis2.consumption.core/osgi.bundle/1.0.104.v200810151442
  找不到包含以下内容的存储库：org.eclipse.jst.ws.axis2.creation.core/osgi.bundle/1.0.104.v200810151442

```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-04T13:41:02.090

你用的是什么版本的eclipse？

它已[在 3.4.1 中修复](https://bugs.eclipse.org/bugs/show_bug.cgi?id=251716)，但在您的情况下，它可能是[这个错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=236437)。

> 事实证明，原因是一个或多个工件存储库从已知存储库列表中丢失。
> 
> 解决方法是从列表中删除存储库并重新添加它。这将恢复丢失的工件存储库。

* * *

eclipse 3.4.1 中可能的解决方法：

1.  将更新站点列表导出到`bookmarks.xml`文件 ( `Software Updates->Manage sites->Export`)
2.  停止日食
3.  **删除`configuration/.settings/org.eclipse.equinox.p2.*.prefs`文件**
    （注意，正如[Fredrik](https://stackoverflow.com/users/207764/fredrik)在评论中提到的，对于 Eclipse3.5+，这将是
    `p2\org.eclipse.equinox.p2.engine\.settings`
    `p2\org.eclipse.equinox.p2.engine\profileRegistry\SDKProfile.profile\.data\.setti‌​ngs`：）
4.  开始日食
5.  导入在步骤 1 中导出的`bookmarks.xml`文件 ( )`Software Updates->Manage sites->Import`

正如[马克](https://stackoverflow.com/users/30453/mark)（此问题的作者）在此答案的评论中所提到的，该解决方法是解决他的问题的方法。

* * *

其他建议：

> [...] 解决方案始终是在我的 P2 UI 中`'/'`的*所有存储库 URL 后面附加一个尾随。*
> 我的感觉是，这个错误是由于未能构建到 repo 资源的可行 URL 造成的。有问题的代码没有检查 UI 中的 URL 字符串，并假设尾随 '/' 导致 404

最后一个解决方案在 Eclipse Indigo 和 Juno 中得到确认（在评论下方）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-12-14T16:35:43.820

另一个解决方案 -

而是导出所有托管站点并将它们导入回来，在每个选中的站点上单击“编辑”并在末尾添加“//”

如果您只添加一个“/”，则表示重复站点，因此“//”

一个精心设计的大型应用程序中的一个小错误如何难以调试但又很容易解决

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-23T09:15:14.533

*虽然这个问题得到了很久的回答，但想分享我的经验，认为它可能会节省一些时间:)*

有时，由于代理设置不正确，也可能出现这种情况。就我而言（Eclipse 3.6/Helios），Eclipse 首选项文件`$ECLIPSE_HOME$/configuration/.settings/org.eclipse.core.net.prefs`包含代理详细信息，

```
proxyData/HTTP/hasAuth=true
systemProxiesEnabled=true
proxyData/HTTP/host=proxy.domain.net
org.eclipse.core.net.hasMigrated=true
eclipse.preferences.version=1
proxiesEnabled=true
proxyData/HTTP/port=9119
nonProxiedHosts= 
```

当我在关闭 Eclipse 后删除文件时，然后我就可以下载插件了

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-20T09:41:09.657

我在 Ubuntu 64 位上使用 Eclipse Helios (3.6) 时遇到了同样的问题。

移除

[http://download.eclipse.org/tools/cdt/releases/helios](http://download.eclipse.org/tools/cdt/releases/helios)

来自 Eclipse 中的“可用软件站点”，然后再次添加它可以解决问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T11:19:18.800

我遇到了同样的问题（与我只是尝试安装 subclipse 非常相似）。VonC 的提示“其他建议”为我做到了。

1.  将网站导出到 bookmarks.xml
2.  编辑此文件并在每个 URL 缺失的末尾附加一个正斜杠。
3.  删除所有网站
4.  重新导入编辑的bookmarks.xml
5.  当它起作用时，松了一口气。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-12T15:44:07.697

导出的书签文件中的反斜杠为我修复了它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-23T10:37:16.997

我有同样的问题。导出和导入书签后，问题没有得到解决。但我开始收到错误“连接被拒绝”。

进一步思考后，我发现我的防病毒软件不允许 eclipse 与互联网对话。禁用防病毒软件使其工作。

桑迪普·金达尔

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-13T20:03:06.180

在过去的几个月里，我遇到了类似的问题，但直到今天我真的需要 PyDev 在我的笔记本电脑上工作时才忽略它。

我尝试了上面的解决方案无济于事，然后我发现了一些奇怪的东西：

在（Window->Preferences->Install/Update->Available Software）中，我注意到“PyDev Update Site”框和它正下方的另一个带有“file:/updates”位置的框都被选中，导致重复大多数或所有更新 URL。取消选中位置为“文件：/更新”的框后，我能够从（帮助->检查更新）进行更新，然后成功安装了最新版本的 PyDev。

此解决方案可能不适用于单独的 PyDev 更新，并有望帮助其他有类似问题的人。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-02T09:36:56.703

我刚刚遇到了同样的问题，我禁用了我的 ZoneAlarm 防火墙，它连接正常！

我需要在防火墙中添加某种规则以阻止它阻止日食吗？它从来没有这样做过，直到上周（2012 年 9 月 25 日（ish））发现一切正常

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-12T13:33:26.527

当我遇到类似问题时，我将以下存储库添加到我的可用更新站点。 [http://dist.springsource.com/release/TOOLS/update/e4.4/](http://dist.springsource.com/release/TOOLS/update/e4.4/)。

确保 URL 末尾的斜杠。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-09-09T17:23:24.513

这个问题有一个简单的解决方案，我在[https://marketplace.eclipse.org/content/ibm-websphere-mq-explorer/login-warning](https://marketplace.eclipse.org/content/ibm-websphere-mq-explorer/login-warning)上测试过，只需安装“Eclipse Tests, Examples, and Extras” - > 来自 Eclipse 项目更新存储库的“Eclipse 2.0 样式插件支持”

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-10T06:42:26.280

就我而言，问题是由**两个 STS 更新站点引起的，其中一个已过时且不再可用**。两者都存在并在安装/可用软件站点中进行了检查。

解决方案很简单：取消选中不可用的站点。此处列出了 sts 的可用更新站点：[https](https://spring.io/tools/sts/all) ://spring.io/tools/sts/all 。

# erlang - Erlang 中的进程平衡

> ID：511369
> 
> 赞同：4
> 
> 时间：2009-02-04T13:33:39.767
> 
> 标签：erlang, erlang-otp, load-balancing

有谁知道 erlang 标准库中是否有一种“负载平衡器”？我的意思是，如果我对一组非常大的数据进行一些非常简单的操作，那么为每个项目构建一个流程的开销将大于按顺序执行操作。但是如果我能在“正确数量”的过程中平衡工作，它会表现得更好，所以我基本上是在问是否有一种简单的方法来完成这项任务。

顺便说一句，有人知道 OTP 应用程序是否会进行某种平衡负载吗？我的意思是，在 OTP 应用程序中存在“工作进程”的概念（如 java-ish 线程工作程序）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-04T14:06:59.183

请参阅模块`pg2`和`pool`.

`pg2`实现了相当简单的分布式进程池。`pg2:get_closest_pid/1`返回“最近的”pid，即如果可用，则返回随机本地进程，否则返回随机远程进程。

`pool`实现以 module 开头的节点之间的负载平衡`slave`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T14:02:51.060

该[`plists`](http://code.google.com/p/plists/)模块可能会执行您想要的操作。它基本上是`lists`模块的并行实现，设计用作替代品。但是，您还可以控制它如何并行化其操作，例如通过定义应该产生多少工作进程等。

您可能会根据列表的长度或系统的负载等计算一些工人数量来做到这一点。

从网站：

> plists 是 Erlang 模块列表的替代品，使大多数列表操作并行。它可以在每个元素上并行操作、IO 绑定操作、并行子列表、利用 CPU 绑定操作的多核机器，以及跨 erlang 节点，在集群内进行并行化。它处理错误和节点故障。可以对其进行配置、调整和调整，以获得最佳性能，同时最大限度地减少开销。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T21:39:48.960

在我看来，otp 中没有有用的通用负载平衡工具。也许只有在特定情况下才有用。自己实现一个很容易。plists 在相同的情况下可能很有用。我不相信并行库可以替代真实的东西。如果您走这条路，Amdahl 将永远困扰您。

正确的工作进程数量等于调度程序的数量。这可能会有所不同，具体取决于系统上执行的其他工作。采用，

```
erlang:system_info(schedulers_online) -> NS 
```

获取调度程序的数量。

当用大量工作进程淹没系统时，开销的概念有些错误。新进程有开销，但没有 os-threads 那么多。主要开销是进程之间的消息复制，这可以通过使用二进制文件来缓解，因为只发送对二进制文件的引用。使用 eterms，结构首先被扩展，然后复制到另一个进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T14:16:16.107

没有办法如何机械地预测工作成本而不测量它，例如做它。有些人必须确定如何为某类任务分配工作。在负载均衡器一词中，我理解的内容与您的问题非常不同。

# .net-3.5 - .Net 静态方法及其对并发的影响？

> ID：511378
> 
> 赞同：3
> 
> 时间：2009-02-04T13:34:52.650
> 
> 标签：.net-3.5, concurrency, static-methods, performance

我目前正在构建一个将由 Web 服务使用的 API。

我想知道如果我使用大量**静态方法**构建我的 API 会遇到哪些性能问题。

最初的想法是构建充当服务的专家对象。

在单一用户环境中，这种方法很棒！但我很快需要将其移植到多/并发用户环境。

这种架构可能会遇到什么样的性能问题？

最好的祝福，

**编辑：**

静态方法不包含静态变量并且没有副作用。他们只是执行一个正常的例程，一切都被实例化。（即变量和对象）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T13:42:30.340

对并发没有特别的影响。同样的规则是正确的：同时改变共享数据是不好的。如果你有实例方法但它们不会改变任何东西，那你很好。

不过，一般设计有所不同 - 静态方法几乎总是应该是线程安全的（即您应该*使*它们成为线程安全的），而实例方法通常不必是（尽管您应该记录类的线程安全性）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T08:59:00.450

您不必担心静态方法中的局部变量。每个线程都有自己的堆栈，每次调用该方法都会在堆栈上创建局部变量的单独副本。例如，MS 在其应用程序块中提供的 SqlHelper 方法就使用了这种技术。

主要问题是静态变量。我几乎从不使用静态变量，我没有必要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T13:56:04.807

我不太关心性能问题（Knuth），我更关心多线程环境中的可测试性和管理状态问题，主要是为了降低编码和维护的复杂性，这可能会拖累项目比偶尔的性能问题。

您不能模拟静态，因此使用基于静态方法的 API 的代码相对无法测试恕我直言。不是您真正要问的，但请考虑将要使用您的 API 的人。

您应该将线程之间保存共享数据的点减少到绝对最小值。这减少了线程问题的机会。这样做您可能会损失一点效率，但您会在编码和维护方面获得很多好处。想象一下，如果所有页面都是静态的，那么编写和测试 ASP.NET 应用程序将是多么困难。这将是一场噩梦。随着您的 API 随着时间的推移获得功能，您可能会发现自己正在走这条路。

此外，使用一个体面的 DI 框架（我认为 Unity，可能是 P&P 中最好的东西）。

# sql - 区分字符数据库字段中的“AB”和“Ab”

> ID：511381
> 
> 赞同：3
> 
> 时间：2009-02-04T13:35:33.273
> 
> 标签：sql, sql-server, database, ascii

具体来说，Sql Server 2005/T-Sql。我有一个主要是一系列两个字符的字段，它们都应该是大写的，但是有一些旧数据早于当前的数据库/系统，我需要找出哪些记录违反了大写外壳契约。

我认为这会起作用：

```
select * from tbl where ascii(field1) <> ascii(upper(field1)) 
```

事实上，它还给了我一些记录。此后它们已被更正，现在该查询不返回任何数据。但是我有人告诉我数据库中仍然存在混合大小写数据，我刚刚找到了一个示例：“FS”和“Fs”都报告了相同的 ascii 值。

为什么这种方法有缺陷？有什么更好的方法来解决这个问题，或者我怎样才能修复这种方法以使其正常工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T13:41:27.380

如果所有日期都应该是大写的，那就做一个更新

```
update tbl
set field1 = upper(field1) 
```

但要回答您的原始问题，此查询应该会给您预期的结果：

```
select * from tbl
where field1 COLLATE Latin1_General_CS_AS <> upper(field1) 
```

编辑：刚刚注意到使用 COLLATE 的建议也是由[Ian发布的](https://stackoverflow.com/questions/511381/differentiating-between-ab-and-ab-in-a-character-database-field/511409#511409)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T13:41:50.950

ASCII 只比较第一个字母。您必须比较每个字母，或将数据库排序规则更改为区分大小写。

您可以在整个数据库级别更改排序规则，或者仅在特定查询的一列上更改排序规则，因此：

```
SELECT myColumn 
  FROM myTable  
  WHERE myColumn COLLATE Latin1_General_CS_AS <> upper(myColumn) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T13:40:05.290

如果您将多个字符串传递给 ascii() 函数，则它只会返回表达式中第一个字符的 ascii 编号。要进行您想要的比较，您需要查看单个字符，而不是整个字段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T13:40:32.920

ASCII() 函数只返回字符表达式最左边字符的 ASCII 码值。请改用 UPPER()。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T13:42:04.430

这可能有效：

```
select * from tbl 
where cast(field1 as varbinary(256)) <> cast(upper(field1) as varbinary(256)) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T13:47:28.007

[SQL Server 查询中区分大小写的搜索中](http://vyaskn.tripod.com/case_sensitive_search_in_sql_server.htm)描述的方法可能对您有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T13:49:17.410

根据[文档`ASCII()`](http://msdn.microsoft.com/en-us/library/ms177545.aspx)，它只返回最左边的字符。

我认为你做错了。你可以简单地：

```
select * from tbl where field1 <> upper(field1) 
```

如果排序规则设置正确，[那么为什么不修复排序规则](http://web.archive.org/web/20080811231016/http://sqlserver2000.databases.aspfaq.com:80/how-can-i-make-my-sql-queries-case-sensitive.html)呢？如果您无法永久更改它们，请尝试：

```
select * from tbl where
          (field1 collate Latin1_General_CS_AS)
  <> upper(field1 collate Latin1_General_CS_AS) 
```

# database - 如何使用 Perl 使我的数据库处于版本控制之下？

> ID：511386
> 
> 赞同：12
> 
> 时间：2009-02-04T13:36:45.547
> 
> 标签：database, perl, version-control, migration

我一直在寻找将我们的数据库模式置于版本控制之下的选项。似乎 Ruby 的人有[Rails Migrations](https://stackoverflow.com/questions/1607/mechanisms-for-tracking-db-schema-changes/1666#1666)，而 .NET 的人有一些选择（例如[this](https://stackoverflow.com/questions/173/how-do-i-version-my-ms-sql-database-in-svn/516#516)、[this](https://stackoverflow.com/questions/8033/database-migration-library-for-net/46783#46783)和[this](https://stackoverflow.com/questions/352785/how-do-you-track-database-changes-in-source-control/352813#352813)）。Perl 呢？

我在 PerlMonks 上看到了这个[线程，虽然它提到](http://www.perlmonks.org/?node_id=722975)[了 DBIX::Migration::Directories](http://search.cpan.org/perldoc?DBIx%3A%3AMigration%3A%3ADirectories)，但它并没有太多内容。是否有人实际使用此模块或其他模块？还是您推出自己的数据库迁移解决方案？

无偿详情：

*   大多数情况下我们**不**使用 DBIx::Class
*   我们使用 MySQL
*   我们使用 SVN

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T11:58:43.870

在工作中，我们使用[DBIx::Migration](http://search.cpan.org/dist/DBIx-Migration/)的修改版本（它有一些限制，例如不超过 10 次迁移）。然后，您有一个从数据库中转储的核心架构，当版本号太低时，您可以使用迁移架构目录中的迁移来升级数据库。

我还强烈推荐《[数据库重构](http://databaserefactoring.com/)》一书。除其他外，它将为您提供*安全*管理迁移的出色技术，以便在您需要回滚时不会丢失数据（例如，当您删除您认为不需要的列时）。

为了帮助它建议的自动弃用计划，我编写了[Devel::Deprecate](http://search.cpan.org/dist/Devel-Deprecate/)以便您无需记住何时进行弃用。您的代码会为您大声抱怨（并且仅在测试中，而不是在生产中）。

***重要提示***：您会定期发现您使用这种技术应用了如此多的数据库迁移级别，以至于您有时需要“提高”您的最小基本迁移，因为重建数据库需要很长时间。只需在所需的迁移级别上重新转储数据库并删除小于或等于该级别的所有迁移。

***更新***：快进几年，今天我推荐[sqitch](http://sqitch.org/)。它从头开始设计用于处理将数据库置于版本控制之下的情况，而无需将您绑定到特定的编程语言或 VCS。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T15:05:31.140

[Adam Kennedy 的ORLite::Migrate](http://search.cpan.org/perldoc?ORLite::Migrate)是一个非常有趣的项目，它可能还很年轻，但它的灵感来自 Rails 迁移。他在 use.perl.org[上写了一篇非常有趣的日记](http://use.perl.org/~Alias/journal/38087)，讲述了他的计划，我希望将来继续关注它。

看来这个包目前只适用于 SQLite，但我认为 Adam 计划在未来将其构建为与数据库无关。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T14:06:24.583

在[POPFile](http://getpopfile.org/)中，我们使用自己的解决方案。我们在数据库中存储模式版本号，如果程序检测到有更新的模式，它将相应地更新数据库。这并不是我们代码中最好和最有趣的部分。

老实说，如果您还没有使用 DBIx::Class，我看不到使用 DBIx::Migration::Directories 的优势。您必须提供 SQL 和版本号以及数据库句柄。您不妨提供更多代码来查找 sql 文件并将其提供给数据库。

当然，在版本控制中拥有架构是一个很大的好处。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-05T09:52:13.593

我们使用类似于 Manni 描述的系统。两大缺点是：

*   无法回滚架构更改（通常这种情况很少见，没有经过良好测试并且很难，因此必须手动进行 IMO 并不是什么大问题）。

*   当您在多个分支中进行开发时，使用顺序版本号会很痛苦——因为您使用的是 SVN，所以这不像您使用 git 那样可能是一个问题。:-)

我使用的脚本脚本在这里：[database_update](http://git.develooper.com/?p=combust.git;a=blob;f=bin/database_update;h=2a860ca389fda330cb70fe345fb65fac6e101bc5;hb=HEAD)并且有一个小的[示例数据文件](http://git.develooper.com/?p=combust.git;a=blob;f=sql/combust.update;h=b4a8102eb30d4d994aa15ef9c8d72f20ca36a42d;hb=HEAD)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-09-05T15:21:25.067

[斯奇奇](http://sqitch.org/)呢？它标榜自己是“数据库变更管理应用程序”，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-05T06:23:36.790

有一个有趣的 CPAN 模块（[Database::Migrator](https://metacpan.org/pod/Database::Migrator)）。我已经使用了它，并且可以正常工作以处理您的项目的迁移。

每个迁移都进入它自己的目录。迁移按排序顺序应用，通常以数字前缀开头。迁移目录可以包含带有 SQL 或 Perl 的文件。

# .net - ASP.NET MVC - 图片上传失败

> ID：511395
> 
> 赞同：0
> 
> 时间：2009-02-04T13:39:07.897
> 
> 标签：.net, asp.net-mvc, forms, image

得到一个简单的表格，发布到一个动作......该动作获取数据并在数据库中创建记录，并将图像复制到目录。在我的本地开发盒上运行良好。

将表格上传到我的主机，并且图像上传不起作用。表单表现得好像它未能通过 UpdateModel()，但不显示任何验证消息。

还有人经历过这个吗？需要的话我可以发代码...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T15:16:29.560

原来是权限。通过 Filezilla 设置文件夹权限不起作用。必须通过我的主机控制面板来设置权限。

现在工作正常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:42:33.153

在将表单的“enctype”属性设置为“multipart/form-data”之前，我在 ASP.NET MVC 中上传文件时遇到问题。

请参阅[此博客文章](http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx)形式的更多信息。

# .net - 当呼叫者不在域中时请求用户在 AD 中的角色

> ID：511396
> 
> 赞同：6
> 
> 时间：2009-02-04T13:39:57.147
> 
> 标签：.net, security, active-directory, directoryservices

我想在 ActiveDirectory 中获取用户的组成员身份，而不是在域中。当我在域内运行它时，一切都很好。

```
var context = new PrincipalContext(ContextType.Domain);
var principal = UserPrincipal.FindByIdentity(context, IdentityType.Name, "administrator");

foreach (var authorizationGroup in principal.GetAuthorizationGroups())
{
    Console.WriteLine(authorizationGroup.Name);
} 
```

但是，当我在域外运行时，我必须指定 PrincipalContext 谎言：

```
var context = new PrincipalContext(ContextType.Domain, "10.0.1.255", "DC=test,DC=ad,DC=be", "administrator", "password"); 
```

当我运行这段代码时，我在执行`principal.GetAuthorizationGroups()`. 我得到的例外是：

```
System.DirectoryServices.AccountManagement.PrincipalOperationException: Information about the domain could not be retrieved (1355).
at System.DirectoryServices.AccountManagement.Utils.GetDcName(String computerName, String domainName, String siteName, Int32 flags)
at System.DirectoryServices.AccountManagement.ADStoreCtx.LoadDomainInfo()
at System.DirectoryServices.AccountManagement.ADStoreCtx.get_DnsDomainName()
at System.DirectoryServices.AccountManagement.ADStoreCtx.GetGroupsMemberOfAZ(Principal p)
at System.DirectoryServices.AccountManagement.UserPrincipal.GetAuthorizationGroupsHelper()
at System.DirectoryServices.AccountManagement.UserPrincipal.GetAuthorizationGroups() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T13:53:57.760

看起来像一个DNS问题。

DC 定位器的工作原理是对 SRV 记录进行 DNS 查询，以在您当前的站点中找到适当的 DC。如果这些东西不在 DNS 中，DC 定位器将失败，这发生在您的堆栈跟踪中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T17:47:41.177

我只需要处理同样的问题。我希望这对其他人有帮助。

```
/*Argument*/
string username;

/*Global settings*/
string ADHost = "dc.a.b.c"; /*Or ip address*/
string ADUsername = "username";
string ADPassword = "password";
string ADDomain = "a.b.c";
string ADContainer = "DC=A,DC=B,DC=C"; /*I have a function to do the translation*/
/*Global settings*/

var list = new List<string>();

var path = "LDAP://" + ADHost + "/" + ADContainer;
var deDomain = new DirectoryEntry(path, ADUsername, ADPassword);
var ds = new DirectorySearcher(deDomain, "(&(objectClass=User)(sAMAccountName=" + username + "))");

ds.SearchScope = SearchScope.Subtree; /*Cascade*/
ds.ReferralChasing = ReferralChasingOption.All; /*Follow redirection*/

var usr = ds.FindOne();
if (null != usr)
{
    var deUsr = new DirectoryEntry(usr.Path, ADUsername, ADPassword);

    foreach (string groupDN in deUsr.Properties["memberOf"])
    {
        string[] parts = groupDN.Replace("CN=", "").Split(',');
        list.Add(parts[0]);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T14:11:37.317

可能是这样，我现在无法验证。

我尝试了以下方法：我使用 sysinternals 出色的 Active DirectoryExplorer。使用相同的凭据登录时：`10.0.1.255, "administrator", "password"`

现在我可以毫无问题地看到用户组

```
["memberOf"] = "CN=TestGroup,CN=Users,DC=test,DC=ad,DC=be" 
```

# python - 组合 Python 和 Ruby 扩展模块

> ID：511412
> 
> 赞同：8
> 
> 时间：2009-02-04T13:42:04.820
> 
> 标签：python, ruby, setuptools, newgem

我有一个 Python 的 C 扩展模块，我想让 Rubyists 可以使用它。

源代码有许多 C 模块，只有一个依赖于 Python。其余的仅依赖于彼此和标准库。`python setup.py build`我可以用通常的方式构建它。

我一直在尝试使用添加 Ruby 支持，`newgem`并且可以使用`rake gem`. 然而，合并后的源代码有一个丑陋的目录布局（混合了 Gem 风格和 Setuptools 风格的结构），并且构建过程很杂乱。

我不能只将所有源代码保存在同一个目录中，因为会`mkmf`自动选择依赖 Python 的模块并尝试构建它，并且用户不必安装 Python 来编译不会使用的模块。我目前的技巧是`extconf.rb`将独立于 Python 的源文件复制到与依赖于 Ruby 的扩展模块相同的目录中。

有没有更明智的方法可以使代码对两种语言都可用？我应该在单独的 Gem 中复制与 Python 无关的代码吗？我应该将独立代码作为使用 autotools 构建的单独库发布吗？有没有`mkmf`可以跳过不需要的模块的版本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T15:35:56.697

解决它的一种方法是创建三个不同的项目：

*   库本身，独立于 python & ruby
*   Python 绑定
*   红宝石绑定

这可能是最干净的解决方案，尽管在发布时需要做更多的工作，但它的优点是您可以发布新版本的 Ruby 绑定，而无需发布新的库/python 绑定版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T03:54:55.190

作为 Johan 所说的补充，感谢 swig，我在 Python 中使用了几个 c/c++ 支持库。您用 c/c++ 编写代码，然后为您想要支持的每种语言制作一个中间模板。它对 Python 来说相当轻松，但必须对 Ruby 进行一些考虑……即我认为 pthread 支持不会让 ruby​​ 满意，反之亦然。

[http://www.swig.org/](http://www.swig.org/) 它的学习曲线有些陡峭，因此最好找到一个示例项目来演示如何将包装器用于您的目标语言。

这绝对是一个有用的工具，因为它使您的代码更清晰，同时仍然提供与多种语言（PHP、Python、Ruby，我相信是 c#）的强大绑定

# jboss - 如何在 JBoss 中配置 IBM IMS 连接器

> ID：511415
> 
> 赞同：1
> 
> 时间：2009-02-04T13:43:25.940
> 
> 标签：jboss, ims-db, ims-tm

我有 IMS 连接器 RAR 文件。将它放在 JBOSS_INSTALL/server/default/deploy 目录中。创建了一个 ims-ds.xml 文件并将其放置在同一位置。看起来好像它正在使用以下消息进行部署：

21:40:02,800 INFO [RARDeployment] 存在所需的许可条款，在 .../deploy/ims225Connector.rar/ 中查看 META-INF/ra.xml

但随后它给出了以下错误：

--- MBean 是问题的根本原因 --- 对象名：jboss.web.deployment:war=MHAccountDetailsAXIS.war,id=258164183 状态：失败原因：org.jboss.deployment.DeploymentException：部署期间出错；- 嵌套的 throwable：（javax.naming.NamingException：resource-ref：eis/IMSCZ 没有有效的 JNDI 绑定。检查 jboss-web/resource-ref。）

ObjectName: jboss.jca:service=RARDeployment,name=IMS Connector for Java 状态: NOTYETINSTALLED 取决于我: jboss.jca:service=NoTxDS,name=eis/IMSCZ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T20:46:37.007

添加了 jboss-web.xml，它提供了 JNDI 和资源引用名称之间的映射，最终实现了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T17:11:00.280

在更正 IMS-ds.xml 文件后能够继续进行。接下来我得到：无法在对象'com.ibm.connector2.ims.ico.IMSManagedConnectionFactory@0'上调用setter方法'public void com.ibm.connector2.ims.ico.IMSManagedConnectionFactory.setMFSXMIRepositoryID(java.lang.String)' ; - 嵌套的 throwable: (java.lang.NoClassDefFoundError: org.eclipse.emf.ecore.resource.ResourceSet)

接下来我下载 eclipse jar 文件：org.eclipse.emf.common_2.4.0.v200808251517.jar 和 org.eclipse.emf.ecore_2.4.1.v200808251517.jar 并放置在与 IMS RAR 相同的位置并克服该错误.

我看到 JNDI 正在建立：12:02:28,082 INFO [ConnectionFactoryBindingService] Bound ConnectionManager 'jboss.jca:service=ConnectionFactoryBinding,name=eis/IMSCZ' to JNDI name 'java:eis/IMSCZ'

但后来我收到这个错误：12:02:28,941 WARN [ServiceController] Problem started service jboss.web.deployment:war=MHAccountDetailsAXIS.war,id=1972990498 org.jboss.deployment.DeploymentException: Error during deploy; - 嵌套的 throwable：（javax.naming.NamingException：resource-ref：eis/IMSCZ 没有有效的 JNDI 绑定。检查 jboss-web/resource-ref。）

我还应该定义什么来实现这一点？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-24T02:24:23.523

我能够在 JBOSS 上配置 IBM IMS TM 资源适配器。您可以在安装中使用其中一种方法。

一个。使用命令提示符

湾。使用网络控制台

[本地主机：9990/控制台](http://localhost:9990/console)

C。更改standalone.xml 配置文件。

我将第三种方法用于其他方法，请参阅链接 [配置 IMS TM 资源适配器](https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6/html/Administration_and_Configuration_Guide/Configure_a_Deployed_Resource_Adapter1.html)

以下是配置步骤

步骤 1：使用以下链接下载 IMS TM RA（您首先需要在 IBM 注册才能下载适配器） [IMS TM 资源适配器](https://www-01.ibm.com/marketing/iwm/iwm/web/reg/download.do?source=imscjd&lang=en_US&S_PKG=14&cp=UTF-8)

第 2 步：在以下文件夹中提取 ico1322.zip（您从第 1 步下载的）。

jboss-as-7.1.1.Final\modules

注意：部分IMS适配器已经是JBOSS安装的一部分，所以请交叉检查该适配器是否已经默认可用。

第 3 步：编辑 jboss-as-7.1.1.Final\standalone\configuration\standalone.xml 文件。

编辑以下部分并添加以下 XML

```
<subsystem xmlns="urn:jboss:domain:resource-adapters:1.0"> 
```

替换占位符 ${XXXXXXXXX}

```
<resource-adapters>
            <resource-adapter id="ims1322.rar">
            <archive>ims1321.rar</archive>
              <!--  <module slot="main" id="com.ibm.connector2"/>-->
                <transaction-support>LocalTransaction</transaction-support>
                <config-property name="threadContextPropagationRequired">
                    false
                </config-property>
                <config-property name="adapterID">
                    IMSTM
                </config-property>
                <config-property name="enableHASupport">
                    true
                </config-property>
                <connection-definitions>
                    <connection-definition class-name="com.ibm.connector2.ims.ico.IMSManagedConnectionFactory" jndi-name="java:jboss/ims/DAS_IMS_CONNECTION_FACTORY" enabled="true" use-java-context="false" pool-name="java:jboss/ims/DAS_IMS_CONNECTION_FACTORY">
                        <config-property name="CM0Dedicated">
                            FALSE
                        </config-property>
                        <config-property name="SSLEnabled">
                            FALSE
                        </config-property>
                        <config-property name="SSLEncryptionType">
                            Weak
                        </config-property>
                        <config-property name="DataStoreName">
                           ${XXXXXXXXX}
                        </config-property>
                        <config-property name="Password">
                         ${XXXXXXXXX}
                        </config-property>
                        <config-property name="UserName">
                         ${XXXXXXXXX} 
                        </config-property>
                        <config-property name="PortNumber">
                             ${XXXXXXXXX}
                        </config-property>
                        <config-property name="TraceLevel">
                            1
                        </config-property>
                        <config-property name="HostName">
                             ${XXXXXXXXX}
                        </config-property>
                        <pool>
                            <min-pool-size>0</min-pool-size>
                            <max-pool-size>10</max-pool-size>
                            <prefill>false</prefill>
                            <use-strict-min>false</use-strict-min>
                            <flush-strategy>FailingConnectionOnly</flush-strategy>
                        </pool>
                        <security>
                            <application/>
                        </security>
                        <validation>
                            <background-validation>false</background-validation>
                        </validation>
                   </connection-definition>
                </connection-definitions>
            </resource-adapter>
            </resource-adapters> 
```

第4步：

```
 <resource-adapter id="ims1322.rar"> 
```

上面的标签应该和我们在步骤 1 中下载的 rar 相同（如果你解压 ims1322.zip 文件，你会找到 ims1322.rar 文件）

第 5 步：以独立模式启动服务器。

```
jboss-as-7.1.1.Final\bin>standalone.bat 
```

步骤 6：检查控制台是否在配置文件中安装了适配器 --> 资源适配器链接

[本地主机：9990/控制台](http://localhost:9990/console)

# c# - 如何在 mshtml & c# 中启用多级撤消/重做

> ID：511424
> 
> 赞同：2
> 
> 时间：2009-02-04T13:44:43.300
> 
> 标签：c#, winforms, mshtml, undo-redo

我有一个托管在 Winforms 应用程序中的 System.Windows.Forms.Webbrowser 控件，并且正在加载一个 html 文档，该文档具有各种元素的 contentEditable 属性设置为 true。如何为文档启用多级撤消和重做？

TIA。

MB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T13:12:11.247

如果我错了，请纠正我，但我认为您可以应用在 codeplex 中找到的库[DejaVu 。](http://dejavu.codeplex.com/)

这是[博客链接](http://dejavu-codeplex.blogspot.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-28T17:21:10.903

撤消/重做是内置的，这是我之前使用的控件 [http://www.itwriting.com/htmleditor/](http://www.itwriting.com/htmleditor/)

# mysql - 与在服务器中运行的 C/C++ 程序相比，MySQL 的速度有多快？

> ID：511432
> 
> 赞同：2
> 
> 时间：2009-02-04T13:48:17.910
> 
> 标签：mysql, c, string, text

好的，我需要执行一些密集的文本操作操作。

就像连接巨大的（比如 100 页的标准文本），并在它们中搜索等等。所以我想知道 MySQL 是否会为这些特定操作提供更好的性能，与 C 程序做同样的事情相比？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T13:53:29.163

任何数据库总是比数据库外的平面文件程序慢。

数据库服务器具有读取和写入简单文件的程序所没有的开销。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T13:56:34.477

一般来说，数据库会比较慢。但很大程度上取决于您想要进行的处理类型、您可以用于编码的时间以及编码技能。如果数据库提供了开箱即用的工具和您需要的功能，那么为什么不试一试呢，这应该比编写自己的工具所花费的时间少得多。如果性能被证明是一个问题，那么请编写您自己的解决方案。

但我认为 MySQL 不会提供你想要的文本操作操作。在甲骨文世界中，有文本挖掘和甲骨文文本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T00:50:07.310

我投了几个很好的回应，但我认为这里有更多的考虑：

无论您采取何种方式：**索引**文本对于速度至关重要。没有办法解决它。唯一的选择是为空间限制和搜索查询功能创建索引所需的复杂程度。例如，简单的**b-tree**结构快速且易于实现，但会比**trie**结构使用更多的磁盘空间。

除非您真的了解所有问题，或者想将其作为学习练习，否则使用经过多年性能调整的应用程序会好得多。

这可能意味着像 MySQL 这样的关系数据库，即使全文是为行表和列表设计的数据库中的一个杂项。对于 MySQL，使用 MyISAM 引擎进行索引并在“blob”列上添加全文索引。（Afaik，InnoDB 引擎仍然不处理全文索引，所以你需要使用 MyISAM）。对于 Postgresql，您可以使用 tsearch。

尽管您会看到将[Xapian](http://xapian.org/)、[Hyper Estraier](http://hyperestraier.sourceforge.net/)或（也许）[Lucene](http://lucene.apache.org/java/docs/index.html)等索引应用程序集成到您的 C 程序中的最佳性能，但实现的难度更大。

除了更好的性能之外，这些应用程序还将为您提供 MySQL 全文搜索所缺少的重要功能，例如词干、短语搜索等，换句话说，真正的全文查询解析器不限于 SQL 思维方式.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T14:48:47.587

如果您正在谈论将纯文本存储在一个数据库字段中并尝试使用数据进行操作，那么 C/C++ 应该是更快的解决方案。简单来说，MySQL 应该比你的 C 程序大得多，所以在字符串操作等简单任务中它必须更慢:-)

当然，您必须使用正确的算法才能达到良好的效果。有一本关于字符串搜索算法的有用电子书，其中包括示例：[http ://www-igm.univ-mlv.fr/~lecroq/string/index.html](http://www-igm.univ-mlv.fr/~lecroq/string/index.html)

PS基准并给我们报告:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:24:47.780

感谢所有的答案。

我有点认为数据库也会涉及一些开销。但我在想的是，由于我的应用程序首先要求将文本存储在某个地方，那么从 DB 中提取文本、将其传递给 C 程序并将结果写回 DB 的整个过程将总体上比在数据库中处理它的效率低？？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T13:58:37.657

关系数据库通常不适合处理大型文本数据。现实数据库的性能优势在于索引和自动生成的查询计划。自由格式文本不适用于此模型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T15:35:38.710

使用 MySQL，您可以利用全文索引，这将快数百倍，然后直接搜索文本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T14:02:35.153

如果您实际上是在谈论连接字符串并进行正则表达式匹配，那么这听起来像是在 C/C++（或 Java 或 C# 或任何您最喜欢的快速高级语言）中值得做的事情。

数据库将为您提供其他功能，例如持久性、事务、复杂查询等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T15:48:31.723

MySQL 相当有效。您需要考虑编写自己的 C 程序是否意味着需要访问更多或更少的记录才能获得最终结果，以及是否需要通过网络传输更多或更少的数据才能获得最终结果。

如果任何一种解决方案都将导致访问相同数量的记录，并且通过网络传输相同数量的记录，那么这两种方法可能都不会有太大差异。如果性能很关键，那么尝试两者并对其进行基准测试（如果您没有时间对两者进行基准测试，那么您可能想要选择最容易实现的那个）。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-02-04T14:26:04.387

MySQL 是用 C 编写的，因此将其与 C 程序进行比较是不正确的。它本身就是一个 C 程序

# jquery - 使用 jQuery 验证插件自定义日期格式

> ID：511439
> 
> 赞同：85
> 
> 时间：2009-02-04T13:50:07.643
> 
> 标签：jquery, validation, datetime-format

如何指定要使用jQuery[验证插件验证的自定义日期格式？](http://docs.jquery.com/Plugins/Validation)

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-02-04T13:59:39.837

您可以使用该函数创建自己的自定义验证方法[`addMethod`](http://docs.jquery.com/Plugins/Validation/Validator/addMethod#namemethodmessage)。假设您想验证“dd/mm/yyyy”：

```
$.validator.addMethod(
    "australianDate",
    function(value, element) {
        // put your own logic here, this is just a (crappy) example
        return value.match(/^\d\d?\/\d\d?\/\d\d\d\d$/);
    },
    "Please enter a date in the format dd/mm/yyyy."
); 
```

然后在您的表单上添加：

```
$('#myForm')
    .validate({
        rules : {
            myDate : {
                australianDate : true
            }
        }
    })
; 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-02-04T14:49:47.973

nickf 的回答很好，但请注意，验证插件已经在 additional-methods.js 文件中包含了其他几种日期格式的验证器。在您自己编写之前，请确保有人尚未这样做。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2011-01-27T02:59:38.297

我个人使用非常好的[http://www.datejs.com/](http://www.datejs.com/)库。

Docco在这里：[http ://code.google.com/p/datejs/wiki/APIDocumentation](http://code.google.com/p/datejs/wiki/APIDocumentation)

您可以使用以下方法获取您的澳大利亚格式，并将验证闰日 29/02/2012 而不是 29/02/2011：

```
jQuery.validator.addMethod("australianDate", function(value, element) { 
    return Date.parseExact(value, "d/M/yyyy");
});

$("#myForm").validate({
   rules : {
      birth_date : { australianDate : true }
   }
}); 
```

我还使用掩码输入插件来标准化数据[http://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

```
$("#birth_date").mask("99/99/9999"); 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-06-30T17:07:15.967

下面是一个新验证方法的示例，它将验证几乎任何日期格式，包括：

*   dd/mm/yy 或 dd/mm/yyyy
*   dd.mm.yy 或 dd.mm.yyyy
*   dd,mm,yy 或 dd,mm,yyyy
*   dd mm yy 或 dd mm yyyy
*   dd-mm-yy 或 dd-mm-yyyy

然后，当您将值传递给 php 时，您可以使用[strtotime进行转换](http://php.net/manual/en/function.strtotime.php)

添加方法的方法如下：

```
 $.validator.addMethod("anyDate",
    function(value, element) {
        return value.match(/^(0?[1-9]|[12][0-9]|3[0-1])[/., -](0?[1-9]|1[0-2])[/., -](19|20)?\d{2}$/);
    },
    "Please enter a date in the format!"
); 
```

然后添加新的过滤器：

```
$('#myForm')
.validate({
    rules : {
        field: {
            anyDate: true
        }
    }
}) 
```

;

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-07-14T14:24:39.270

这是最近对我有用的特定代码示例：

```
// Replace the builtin US date validation with UK date validation
$.validator.addMethod(
    "date",
    function ( value, element ) {
        var bits = value.match( /([0-9]+)/gi ), str;
        if ( ! bits )
            return this.optional(element) || false;
        str = bits[ 1 ] + '/' + bits[ 0 ] + '/' + bits[ 2 ];
        return this.optional(element) || !/Invalid|NaN/.test(new Date( str ));
    },
    "Please enter a date in the format dd/mm/yyyy"
); 
```

我应该注意到这实际上取代了内置的日期验证例程，尽管我看不出这会导致当前插件出现问题。

然后，我使用以下方法将其应用于表单：

```
$( '#my_form input.date' ).rules( 'add', { date: true } ); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-08-07T14:06:40.110

这是我组合/修改以前的帖子以达到我想要的结果：

```
 // Override built-in date validator
        $.validator.addMethod(
            "date",
            function (value, element) {
                //Return            NB: isRequired is not checked at this stage
                return (value=="")? true : isDate(value);
            },
            "* invalid"
        ); 
```

在您的验证配置之后添加日期验证。即在调用 $(form).validate({ ... }) 方法之后。

```
 //Add date validation (if applicable)
        $('.date', $(frmPanelBtnId)).each(function () {
            $(this).rules('add', {
                date: true
            });
        }); 
```

最后将主要的isDate Javascript函数修改为UK Date Format

```
//Validates a date input -- http://jquerybyexample.blogspot.com/2011/12/validate-date-    using-jquery.html
function isDate(txtDate) {
    var currVal = txtDate;
    if (currVal == '')
       return false;

  //Declare Regex  
  var rxDatePattern = /^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/;
  var dtArray = currVal.match(rxDatePattern); // is format OK?

  if (dtArray == null)
      return false;

   //Checks for dd/mm/yyyy format.
   var dtDay = dtArray[1];
   var dtMonth = dtArray[3];
   var dtYear = dtArray[5];

  if (dtMonth < 1 || dtMonth > 12)
      return false;
  else if (dtDay < 1 || dtDay > 31)
      return false;
  else if ((dtMonth == 4 || dtMonth == 6 || dtMonth == 9 || dtMonth == 11) && dtDay == 31)
      return false;
  else if (dtMonth == 2) {
      var isleap = (dtYear % 4 == 0 && (dtYear % 100 != 0 || dtYear % 400 == 0));
      if (dtDay > 29 || (dtDay == 29 && !isleap))
          return false;
  }

  return true;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-03-08T15:17:07.477

乔恩，你有一些语法错误，见下文，这对我有用。

```
 <script type="text/javascript">
$(document).ready(function () {

  $.validator.addMethod(
      "australianDate",
      function (value, element) {
        // put your own logic here, this is just a (crappy) example 
        return value.match(/^\d\d?\/\d\d?\/\d\d\d\d$/);
      },
      "Please enter a date in the format dd/mm/yyyy"
    );

  $('#testForm').validate({
    rules: {
      "myDate": {
        australianDate: true
      }
    }
  });

}); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-06-01T08:03:44.023

```
$.validator.addMethod("mydate", function (value, element) {

        return this.optional(element) || /^(\d{4})(-|\/)(([0-1]{1})([1-2]{1})|([0]{1})([0-9]{1}))(-|\/)(([0-2]{1})([1-9]{1})|([3]{1})([0-1]{1}))/.test(value);

    }); 
```

你也可以`yyyy-mm-dd`输入`yyyy/mm/dd`

但无法判断月份的大小，即 2 月 28 日或 29 天。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-07-14T05:44:36.250

@blasteralfred：

我得到以下规则为我验证正确的日期（DD MM YYYY）

```
jQuery.validator.addMethod(
"validDate",
function(value, element) {
    return value.match(/(?:0[1-9]|[12][0-9]|3[01]) (?:0[1-9]|1[0-2]) (?:19|20\d{2})/);
},
"Please enter a valid date in the format DD MM YYYY" 
```

);

对于 DD/MM/YYYY

```
jQuery.validator.addMethod(
"validDate",
function(value, element) {
    return value.match(/(?:0[1-9]|[12][0-9]|3[01])\/(?:0[1-9]|1[0-2])\/(?:19|20\d{2})/);
},
"Please enter a valid date in the format DD/MM/YYYY" 
```

);

这不会验证 2017 年 1 月 13 日和 2017 年 1 月 13 日。

并且也不验证 50 12 2017 和 50/12/2017。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-02T02:48:10.053

**很简单，示例：*适用于 HTML5 自动 type="date"*。**

```
<script type="text/javascript" src="//ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/jquery.validate.min.js"></script>
<script type="text/javascript" src="//ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/additional-methods.min.js"></script>
<script type="text/javascript" src="//ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/localization/messages_es.js"></script>

$(function () {

        // Overload method default "date" jquery.validate.min.js
        $.validator.addMethod(
            "date",
            function(value, element) {
                var dateReg = /^\d{2}([./-])\d{2}\1\d{4}$/;
                return value.match(dateReg);
            },
            "Invalid date"
        );

     // Form Demo jquery.validate.min.js
     $('#form-datos').validate({
        submitHandler: function(form) {
            form.submit();
        }
    });

}); 
```

# sql-server - MS SQL Server 2008 空间索引 - 它有效吗？

> ID：511441
> 
> 赞同：1
> 
> 时间：2009-02-04T13:51:06.017
> 
> 标签：sql-server, gis, geospatial, spatial, geography

有没有人尝试过使用它并且可以说它是否实施得很好？

-- Assaf（过去几周他对 MySQL 的 OpenGIS 功能实现不足感到越来越沮丧，现在正在考虑切换到 MSSQL）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T20:33:31.847

是的，它有效，我在这里有一些示例代码 [SQL Server 2008 Proximity Search With The Geography Data Type](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-2008-proximity-search-with-th)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-06T22:58:35.760

是的。它们被正确实施。您还可以选择[PostgreSQL 的 PostGIS](http://postgis.refractions.net/documentation/)，即[Oracle Spatial](http://www.oracle.com/technology/products/spatial/index.html)。Informix 和 DB2 也有空间类型的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T20:28:03.190

是的，他们工作。

我刚刚将我的一个类从使用 ISpatialFilter 的基于 ESRI-ArcObject 的查询切换到返回相同数据的 SqlCommand。这是一个邻近搜索（返回点 x 1000 英尺内的任何记录）。

起初，ESRI 查询仍然更快，但那是由于 where 子句结构不佳，效率非常低（我仍在学习如何使用 SQLSVR2008 中的空间函数）。

经过一些调整，我的 SQL 方法比 ESRI 方法快，但并没有快多少。然后我将搜索距离提升到 10000 英尺，然后我看到了差异。SQL Server 2008 方法要快得多。

（ESRI）搜索附近客户经过时间（秒）：1.503（SQL2008）查询附近客户经过时间（秒）：0.925

虽然速度差异与索引无关，但与ESRI-ArcObjects有关。在我的 ESRI 方法中，我从 IProximityOperator 和 IPoint 获取距离 x 和 y。在 SQL2008 方法中，我让数据库完成所有工作：SHAPE.STX 为 X ，SHAPE.STY 为 Y ，SHAPE.STDistance（但 ArcObject 开发人员都知道这些开销）。

到目前为止我印象深刻。

# asp.net-ajax - 自定义 WebControl 中的 LinkBut ton 回发问题

> ID：511445
> 
> 赞同：0
> 
> 时间：2009-02-04T13:52:10.710
> 
> 标签：asp.net-ajax, modalpopupextender

我已经放弃尝试解决这个问题。
我的页面有一个 ModalPopupExtender，它显示了一个 asp:Panel，里面有我的自定义 WebControl。
我的自定义 WebControl 仅包含一个 LinkBut​​ton，并且位于 UpdatePanel 内。

**问题是，当点击 LinkBut​​ton 时，它会重新加载整个页面。**

使用常规输入按钮，这不会发生。LinkBut​​ton 拒绝按预期工作并重新加载整个页面:(
如果我在 UpdatePanel 内（而不是在我的自定义 WebControl 内）单独使用 LinkBut​​ton，一切正常。

我究竟做错了什么？！？
请，任何帮助将不胜感激！

在此先感谢，
费利佩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T01:52:59.070

答案就[在这里](http://forums.asp.net/p/1379865/2920158.aspx)。

[请将 LinkBut​​ton 注册为 AsyncPostBack 控件](http://weblogs.asp.net/wallym/archive/2006/09/26/Programmatically-adding-triggers-to-an-UpdatePanel-_2D00_-Microsoft-AJAX-Library-and-ASP.NET-2.0-AJAX-Extensions.aspx)。

# diff - 将差异工具与 Visual Studio 2003 集成

> ID：511446
> 
> 赞同：1
> 
> 时间：2009-02-04T13:52:36.903
> 
> 标签：diff, visual-studio-2003

我发现了一篇关于将不同的差异和合并工具与 Visual Studio 2005 和 2008 集成的精彩文章：http: [//blogs.msdn.com/jmanning/articles/535573.aspx](http://blogs.msdn.com/jmanning/articles/535573.aspx)。

有谁知道我如何以与 Visual Studio.Net 2003 相同的方式集成 KDiff3 之类的工具？当我在解决方案资源管理器中使用“比较版本...”菜单项时，我希望 KDiff3 成为默认的差异工具。

对于我们的源代码控制，我们使用 Team System 2005，使用 msscci 提供程序进行集成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:16:16.107

你用的是什么源代码控制系统？

对于某些系统，您可以指定要使用的差异工具。Perforce 有这个……我相信 VisualSVN 也可以让你选择什么差异工具。

如果你有 VSS ......我认为你不走运......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:41:24.200

谢谢你的问题和评论。它让我意识到比较来自 VS2005，即使我使用的是 VS2003，因为我用于源代码控制集成的 msscci 提供程序是 VS2005 版本。

因此，通过进入 VS2005 并使用“配置用户工具...”，它会强制 2003 使用相同的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-08T13:35:15.580

我知道[Devart CodeCompare](http://www.devart.com/codecompare/)在与 Visual Studio 的集成上显示出良好的结果。但是我不知道哪些VS版本与CodeCompare兼容。

# sql - SQL查询：大表之间的内连接优化

> ID：511452
> 
> 赞同：6
> 
> 时间：2009-02-04T13:54:09.130
> 
> 标签：sql, mysql, optimization, inner-join, bigtable

我在 MySQL 4.x DB 中有以下 3 个表：

*   主机：*（300.000 条记录）*
    *   id (UNSIGNED INT) 主键
    *   名称（VARCHAR 100）
*   路径：*（6.000.000 条记录）*
    *   id (UNSIGNED INT) 主键
    *   名称（VARCHAR 100）
*   网址：*（7.000.000 条记录）*
    *   host (UNSIGNED INT) PRIMARY KEY <--- 链接到 hosts.id
    *   path (UNSIGNED INT) PRIMARY KEY <--- 链接到paths.id

如您所见，模式非常简单，但问题在于这些表中的数据量。

这是我正在运行的查询：

```
SELECT CONCAT(H.name, P.name)
FROM hosts AS H
INNER JOIN urls as U ON H.id = U.host
INNER JOIN paths AS P ON U.path = P.id; 
```

此查询运行良好，但需要 50 分钟才能运行。有谁知道我如何加快查询速度？

提前致谢。尼古拉斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T13:56:48.143

也许您应该包含一个 WHERE 子句？还是您真的需要所有数据？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T14:09:41.347

在我看来，这就像过度使用代理键会减慢您的速度的情况。如果表格是：

*   主机：

    *   名称（VARCHAR 100）主键
*   路径：

    *   名称（VARCHAR 100）主键
*   网址：

    *   host (VARCHAR 100) PRIMARY KEY <--- 链接到 hosts.name
    *   path (VARCHAR 100) PRIMARY KEY <--- 链接到paths.name

那么您的查询将根本不需要连接：

```
SELECT CONCAT(U.host, U.path) FROM urls U; 
```

诚然，表 URLS 会占用更多磁盘空间——但这有关系吗？

**编辑：**再想一想，那 PATHS 表的意义何在？不同主机多久共享一次相同的路径？

为什么不：

*   主机：

    *   名称（VARCHAR 100）主键
*   网址：

    *   host (VARCHAR 100) PRIMARY KEY <--- 链接到 hosts.name
    *   path (VARCHAR 100) PRIMARY KEY <--- 没有链接到任何地方

**EDIT2：**或者如果您真的**需要**主机的代理键：

*   主机：

    *   id 整数 PRIMARY KEY
    *   名称（VARCHAR 100）
*   网址：

    *   主机整数 PRIMARY KEY <--- 链接到 hosts.name
    *   path (VARCHAR 100) PRIMARY KEY <--- 没有链接到任何地方

    SELECT CONCAT(H.name, U.path) FROM urls U JOIN hosts H ON H.id = U.host;

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T13:58:36.813

一方面，我不会在查询中执行 CONCAT。在外面做。

但实际上，您的查询运行缓慢，因为您要检索数百万行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T14:41:57.333

总体而言，最好的建议是跟踪和分析以查看真正占用时间的内容。但这是我对要查看的具体事物的看法。

(1) 我想说您要确保在执行此查询时不使用索引。由于您没有过滤条件，因此对所有表进行全扫描然后通过排序合并或哈希操作将它们连接在一起应该更有效。

(2) 字符串连接肯定需要一些时间，但我不明白为什么人们建议删除它。然后您可能需要在另一段代码中进行连接，这仍然需要大约相同的时间（除非 MySQL 的字符串连接由于某种原因特别慢）。

(3) 从服务器到客户端的数据传输可能花费大量时间，很可能超过服务器获取数据所需的时间。如果您有工具可以追踪这类事情，请使用它们。如果您可以增加客户端中的获取数组大小，请尝试不同的大小（例如，在 JDBC 中使用 Statement.setFetchSize() ）。即使客户端和服务器位于同一主机上，这也可能很重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T13:57:50.340

您是否已经在连接属性上声明了一些索引？

PS：有关MySQL 4.x 的索引，请参见~~[此处[断开的链接]](http://dev.mysql.com/doc/refman/4.1/en/mysql-indexes.html)~~

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T14:02:02.640

在运行查询之前尝试优化表：

```
optimize table hosts, paths, urls; 
```

它可能会为您节省一些时间，尤其是在已从表中删除行的情况下。（有关优化的更多信息，请参见[此处）](http://dev.mysql.com/doc/refman/4.1/en/optimize-table.htm)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T14:04:15.600

我会尝试用你想要的数据创建一个新表。这样做意味着您会丢失一些真实数据，但您会快速获胜。这个想法可能类似于 OLAP 或类似的东西吗？

当然，您必须（每天或其他）更新此表。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T14:33:21.033

我不是 MySQL 专家，但看起来 MySQL 主键是集群的——你需要确保你的主键是这样的；聚集索引肯定有助于加快速度。

不过有一件事——我不相信任何一张桌子上都可以有两个“主”键。由于这个原因，你的 urls 表在我看来相当可疑。最重要的是，您应该绝对确保 urls 表中的这两列被索引到了刀柄——每一个上都有一个数字索引应该没问题——因为你要加入它们，所以 DBMS 需要知道如何快速找到它们；这可能是你的情况。如果您正在对那么多行进行全表扫描，那么是的，您可能会在服务器尝试查找您要求的所有内容时坐在那里很长一段时间。

我还建议从 select 语句中删除该 CONCAT 函数，并查看它如何影响您的结果。如果这不是某种促成因素，我会感到惊讶。只需检索两列并在之后处理连接，然后看看情况如何。

最后，你有没有弄清楚瓶颈在哪里？只要表被正确索引，只需加入三个数百万行的表根本不需要太多时间（我预计可能需要一秒钟左右，只是盯着你的表和查询）。但是，如果您将这些行推送到速度较慢或已经固定的 NIC 上，推送到内存不足的应用服务器等，那么缓慢可能与您的查询完全无关，而是与查询后发生的情况有关。七百万行是相当多的数据，需要组装和移动，无论找到这些行需要多长时间。尝试只选择一行，而不是全部七百万，然后看看对比效果如何。如果速度很快，那么问题不在于查询，而在于结果集。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-04T15:15:55.753

由于您的结果集返回所有数据，因此根本无法进行优化。您正在扫描整个表，然后加入具有索引的其他表。

PrimaryKeys 是集群的吗？这样可以确保数据按索引顺序存储在磁盘上，从而避免在磁盘的不同部分反弹。

此外，您可以将数据分布在多个磁盘上。如果您在 PRIMARY 上有 URL，在 SECONDARY 上有 PATHS/HOSTS，那么您将从驱动器获得更好的吞吐量。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-06T06:28:02.413

您需要查看您的服务器配置。MySQL 的默认内存参数会削弱这种大小的表的性能。`key_buffer_size`如果您使用默认值，则需要至少提高`join_buffer_size`4 倍，甚至更多。查看文档；您还可以调整其他内存参数。

MySQL 有一个有趣的性能怪癖，如果您的表超过一定大小，查询将返回大部分数据，性能就会进入厕所。不幸的是，它无法告诉您何时达到该阈值。不过，在我看来，就像你一样。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T14:02:40.470

concat 肯定会减慢您的速度。我们可以看到一个mysql解释的结果吗？[文档链接](http://dev.mysql.com/doc/refman/4.1/en/explain.html)

最重要的事情是尝试只提取您需要的数据。如果您可以提取更少的记录，那么这将尽可能加快您的速度。但是 mysql 解释应该可以帮助我们查看是否有任何索引会有所帮助。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T14:26:55.587

我了解您需要完整的 url 列表 - 包含 700 万条记录。也许[正如 Mitch](https://stackoverflow.com/questions/511452/sql-query-inner-joins-optimization-between-big-tables/511461#511461)所建议的那样，您应该考虑使用 WHERE 子句来过滤您的结果。也许时间主要与显示记录的延迟有关

检查此查询的时间

```
select count(*)
FROM hosts AS H
INNER JOIN urls as U ON H.id = U.host
INNER JOIN paths AS P ON U.path = P.id 
```

如果这仍然很慢，我会去检查从 urls 中选择 count(*) 的时间

然后

```
select count(*) 
from urls u 
inner join hosts h on u.host = h.id 
```

然后

```
select count(*) 
from urls u 
inner join hosts h on u.host = h.id
inner join paths p on u.path = p.id 
```

只是为了找到减速的根源

有时重新排序您的查询也会有所帮助

```
SELECT CONCAT(u.host, u.path)
from urls u 
inner join hosts h on u.host = h.id
inner join paths p on u.path = p.id 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-04T14:28:20.903

我不能肯定地说 mySQL，但我知道在 SQL Server 中主键会自动创建索引，但外键不会。确保检查您的外键字段是否有索引。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-06T07:00:11.053

因为我不是 MySQL 的忠实粉丝，所以我想问一下你是否尝试过 PostgreSQL。在该数据库中，您需要确保您的 work_mem 设置相当高，但您可以使用 SET work_mem = 64MB 为每个数据库连接设置它。

另一个建议是研究使用重复的路径条目。有许多共享路径**的**URL。

另一件可能有用也可能没有帮助的事情是使用固定长度的文本字段而不是 varchars。它曾经会产生速度差异，但我不确定当前的数据库引擎。

如果您确实使用 PostgreSQL，它将允许您使用 JOIN USING 但即使在 MySQL 上我更喜欢它：在每个表中将您的 id 字段命名为相同。而不是主机中的 id 和 url 中的主机，将其命名为 host_id 两个地方。

现在再发表一些评论。:) 当您选择一小组行时，您在此处拥有的这种数据布局非常有用，可能是来自同一域的每个 URL。如果您的查询经常需要对 urls 表中存储的其他数据进行顺序扫描，它也会有**很大**帮助，因为扫描可以跳过大文本字段（除非这无关紧要，因为您的数据库通过指针存储文本无论如何都是一个链接表）。

但是，如果您几乎总是选择所有域和路径数据，那么将其存储在一个表中会更有意义。

# wpf - 如何将逻辑放入我的 DataTemplate，例如处理空白地址行？

> ID：511453
> 
> 赞同：0
> 
> 时间：2009-02-04T13:55:12.750
> 
> 标签：wpf, data-binding, datatemplate

我开始了解 XAML 数据绑定和使用 DataTemplate，它非常好。

采取下一步并将逻辑放入下面的代码中的最佳方法是什么，例如查看“Address2”中是否有任何内容，如果有则显示它，或者以不同的方式格式化外国地址等？

```
<Window.Resources>
    <DataTemplate x:Key="CustomersTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="35"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Rectangle Height="30" Width="30" Margin="0 4 0 0" Fill="LightGreen" Grid.Column="0" VerticalAlignment="Top"/>
            <StackPanel Margin="3 0 0 10" Orientation="Vertical" Grid.Column="1">
                <TextBlock Text="{Binding Path=ContactName}"/>
                <TextBlock Text="{Binding Path=CompanyName}"/>
                <TextBlock Text="{Binding Path=Address}"/>
                <TextBlock>
                    <TextBlock.Text>
                        <MultiBinding StringFormat="{}{0}, {1} {2}">
                            <Binding Path="City"/>
                            <Binding Path="Region"/>
                            <Binding Path="PostalCode"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </StackPanel>
        </Grid>
    </DataTemplate>
</Window.Resources>

<Grid>
    <ListBox Name="dataListBox" ItemTemplate="{StaticResource CustomersTemplate}"/>
</Grid> 
```

这是完整性背后的代码（Northwind 上自动生成的 LINQ to SQL 类）：

```
CustomerDataContext dc = new CustomerDataContext();
var query = from companyName in dc.Customers
            select companyName;
dataListBox.ItemsSource = query.ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T15:01:49.213

您正在寻找 WPF 转换器。查看这些[转换器示例](http://learnwpf.com/Posts/Post.aspx?postId=05229e33-fcd4-44d5-9982-a002f2250a64)，了解您可以执行的各种操作。本质上，您可以在绑定设置属性的值之前在对象上运行任何自定义逻辑。请参阅：[绑定转换器属性](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.converter.aspx)。

您还可以查看[Codeplex](http://www.codeplex.com/wpfconverters)的一些有用转换器的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T15:24:37.997

欢迎来到精彩的触发器世界，这里是从您的示例中删除空白地址行的代码：

我在地址文本块中添加了一个名称，并添加了一个 DataTrigger 以在地址为空时隐藏它

```
<Window.Resources>
    <DataTemplate x:Key="CustomersTemplate">
        <Grid>
 ... snip ...
                <TextBlock Name="AddressLine" Text="{Binding Path=Address}"/>
 ... snip ...
        </Grid>
        <DataTemplate.Triggers>
           <DataTrigger Binding="{Binding Path=Address}" Value="">
              <Setter TargetName="AddressLine" Property="Visibility" Value="Collapsed"/>
           </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>
</Window.Resources> 
```

# asp.net - 设置 HeaderText 时，GridView FindControl 返回 null

> ID：511459
> 
> 赞同：0
> 
> 时间：2009-02-04T13:56:25.850
> 
> 标签：asp.net, gridview, binding, findcontrol, headertext

我有一个网格视图...

```
<asp:GridView EnableViewState="true" 
                ID="grdResults" 
                runat="server" 
                CssClass="resultsGrid" 
                OnRowDataBound="grdResults_OnRowDataBound" 
                AutoGenerateColumns="false" 
                HeaderStyle-CssClass="header" 
                OnRowCommand="grdResults_OnRowCommand">
    <Columns>
       <asp:TemplateField>
           <ItemTemplate>
               <asp:Label ID="lblView" 
                           runat="server" 
                           Visible="false" 
                           Text="View">
               </asp:Label>
               <asp:HyperLink ID="hypEdit" 
                               runat="server" 
                               Visible="false" 
                               Text="(Edit)" 
                               CssClass="edit">
               </asp:HyperLink>
               <asp:LinkButton ID="btnDelete" 
                               runat="server" 
                               Visible="false" 
                               Text="(Delete)" 
                               CssClass="delete" 
                               CommandName="DeleteItem" 
                               OnClientClick="return confirm('Are you sure you want to delete?')">
               </asp:LinkButton>
               <asp:HyperLink ID="hypSelect" 
                               runat="server" 
                               Visible="false" 
                               Text="(Select)" 
                               CssClass="select">
               </asp:HyperLink>
           </ItemTemplate>
       </asp:TemplateField>
   </Columns>
</asp:GridView> 
```

这有一个包含标签、两个超链接和一个链接按钮的静态列，还有许多动态生成的列...

```
private void SetupColumnStructure(IEnumerable<string> columnNames)
{
    var columnNumber = 0;
    foreach (var columnName in columnNames)
    {
        var templateColumn = new TemplateField
                                 {
                                     ItemTemplate = new CellTemplate(columnName)
                                 };
       grdResults.Columns.Insert(columnNumber, templateColumn);
       columnNumber++;
    }
} 
```

作为 OnRowDataBound 处理程序的一部分，我检索静态列中的一个控件并在其上设置一些属性...

```
protected void grdResults_OnRowDataBound(object sender, GridViewRowEventArgs e)
{
    .
    .
    .
    var row = e.Row;
    var rowData = row.DataItem as Dictionary<string, object>;
    if (rowData != null)
    {
       if ((bool)rowData[displayEditLink])
       {
           var hypEdit = (HyperLink)row.FindControl("hypEdit");
           hypEdit.NavigateUrl = "~/Pages/Edit.aspx?action=Edit&objectType=" + rowData[objectTypeLiteral] + "&id=" + rowData[objectIdLiteral];
           hypEdit.Visible = true;
       }
   }
   .
   .
   .
} 
```

这一切都很好，但没有显示列名。所以我然后修改 SetupColumnStructure 方法，以便像这样在模板字段上设置 HeaderText...

```
private void SetupColumnStructure(IEnumerable<string> columnNames)
{
    var columnNumber = 0;
    foreach (var columnName in columnNames)
    {
        var templateColumn = new TemplateField
                                 {
                                     ItemTemplate = new CellTemplate(columnName),
                                     HeaderText = columnName
                                };
       grdResults.Columns.Insert(columnNumber, templateColumn);
       columnNumber++;
    }
} 
```

由于某种原因，这一额外的行更改导致 row.FindControl("hypEdit"); 调用 OnRowDataBound 处理程序以返回 null。任何人都可以在这里看到我缺少的东西，或者有人遇到过类似的问题吗？

**更新**

我确定我在这里指的不是页眉或页脚行。此外，如果我越过对象引用异常，DataSource 中的每个项目都会发生这种情况。

不确定这是否有帮助，但正如我所料，当我逐步执行代码时，表格已生成所有预期的列，但所有单元格（DataControlFieldCells）在设置 HeaderText 时不包含任何控件，但在未设置时所有预期的控件。

一切都很奇怪。让我知道你是否还能发现其他东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T17:51:11.623

这是因为您正在搜索的控件包含在另一个控件中。FindControl() 不查看控件的控件集合。您将需要编写一个 recursiveFindControl() 方法。

希望这有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T15:11:31.847

当您添加 HeaderText 时，一个新的 RowType 被添加到 gridview。您需要检查引发 OnRowDataBound 事件的行类型并采取适当的措施。在您的情况下，只需检查 e.Row.RowType 是否为 DataRow 即可解决您的问题：

```
protected void grdResults_OnRowDataBound(object sender, GridViewRowEventArgs e)
{
     if(e.Row.RowType == DataControlRowType.DataRow)
     {
          if ((bool)rowData[displayEditLink])
          {
           var hypEdit = (HyperLink)row.FindControl("hypEdit");
           hypEdit.NavigateUrl = "~/Pages/Edit.aspx?action=Edit&objectType=" + rowData[objectTypeLiteral] + "&id=" + rowData[objectIdLiteral];
           hypEdit.Visible = true;
          }
     }
} 
```

# linux - 监控目录的变化

> ID：511463
> 
> 赞同：22
> 
> 时间：2009-02-04T13:57:53.430
> 
> 标签：linux, unix, file-io, listeners

就像[类似的 SO question](https://stackoverflow.com/questions/112276/directory-modification-monitoring)一样，我正在尝试监视 Linux 机器上的目录以添加新文件，并希望在这些新文件到达时立即处理它们。关于实现这一点的最佳方法的任何想法？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-04T14:07:22.880

看看[inotify](http://en.wikipedia.org/wiki/Inotify)。

使用 inotify，您可以查看目录以创建文件。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-07-07T03:02:49.347

首先确保**`inotify-tools`**已安装。

然后像这样使用它们：

```
logOfChanges="/tmp/changes.log.csv" # Set your file name here.

# Lock and load
inotifywait -mrcq $DIR > "$logOfChanges" &
IN_PID=$$

# Do your stuff here
...

# Kill and analyze
kill $IN_PID
while read entry; do
   # Split your CSV, but beware that file names may contain spaces too.
   # Just look up how to parse CSV with bash. :)
   path=... 
   event=...
   ...  # Other stuff like time stamps?
   # Depending on the event…
   case "$event" in
     SOME_EVENT) myHandlingCode path ;;
     ...
     *) myDefaultHandlingCode path ;;
done < "$logOfChanges" 
```

或者，使用`--format`而不是`-c`on`inotifywait`将是一个想法。

只是`man inotifywait`为了`man inotifywatch`了解更多信息。

您还可以使用**`incron`**并使用它来调用处理脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T14:00:00.010

我想到的一种解决方案是创建一个“文件侦听器”和一个 cron 作业。我对此并不疯狂，但我认为它可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-24T06:54:40.440

[fschange（Linux File System Change Notification）](http://stefan.buettcher.org/cs/fschange/index.html) 是一个完美的解决方案，但它需要给你的内核打补丁

# php - PHPs fopen 函数是否实现了某种缓存？

> ID：511476
> 
> 赞同：3
> 
> 时间：2009-02-04T14:02:12.733
> 
> 标签：php, http, caching, fopen

我正在努力从网络服务器自动收集 PHP 脚本的数据。[有问题的文件](http://www.iac.ethz.ch/php/chn_meteo_roof/)包含气象数据，每 10 分钟更新一次。奇怪的是，网络服务器上的“文件修改”日期没有改变。

一个简单的[fopen](http://de.php.net/fopen) ('http://...') 命令尝试每小时获取此目录中最后一个文件的最新版本。但通常我最终会得到一个长达 4 小时的版本。这发生在 Linux 服务器上（正如我的系统管理员向我保证的那样）不使用任何类型的代理服务器。

PHP是否实现了自己的缓存机制？或者还有什么可能在这里干扰？

（我目前的解决方法是通过 exec('wget --nocache...') 来获取文件，它有效。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T14:06:07.873

由于您通过 HTTP 获取文件，我假设 PHP 将尊重服务器响应的任何缓存标头。

避免这种情况的一种非常简单且肮脏的方法是在每个请求中附加一些随机获取参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-02-15T00:46:07.467

Q 与观察到的 fopen('http://...') 访问的内容的缓存有关，发帖人想知道 PHP 是否实现了自己的缓存机制？其他答案包括一些猜测，但肯定最简单的找出方法是通过查看源代码进行检查，或者更容易检测系统调用以查看发生了什么？这在 Debian 系统上很简单，如下所示：

```
$ echo "Hello World" > /var/www/xx.txt
$ strace -tt -o /tmp/strace  \
> php -r 'echo file_get_contents("http://localhost/xx.txt");'
Hello World 
```

我在下面包含了 strace 日志的相关摘录，但这表明 PHP RTS 只是连接到**localhost:80**，发送一个“GET /xx.txt”，得到一个包含标题和文件内容的响应，然后它会回显到标准输出。

PHP RTS 中绝对不会发生客户端缓存，并且由于这是直接进行 HTTP 套接字对话，因此很难想象缓存会发生在客户端的什么位置。我们留下了服务器端或中间代理缓存的可能性。（注意，我默认为 txt 文件的 Access + 7 天过期）。

## 日志文件提取

```
00:15:41.887904 socket(PF_INET6, SOCK_STREAM, IPPROTO_IP) = 3
00:15:41.888029 fcntl(3, F_GETFL)       = 0x2 (flags O_RDWR)
00:15:41.888148 fcntl(3, F_SETFL, O_RDWR|O_NONBLOCK) = 0
00:15:41.888265 connect(3, {sa_family=AF_INET6, sin6_port=htons(80), inet_pton(AF_INET6, "::1", &sin6_addr), sin6_flowinfo=0, sin6_scope_id=0}, 28) = -1 EINPROGRESS (Operation now in progress)
00:15:41.888487 poll([{fd=3, events=POLLIN|POLLOUT|POLLERR|POLLHUP}], 1, 60000) = 1 ([{fd=3, revents=POLLOUT}])
00:15:41.888651 getsockopt(3, SOL_SOCKET, SO_ERROR, [0], [4]) = 0
00:15:41.888838 fcntl(3, F_SETFL, O_RDWR) = 0
00:15:41.888975 sendto(3, "GET /xx.txt HTTP/1.0\r\n", 22, MSG_DONTWAIT, NULL, 0) = 22
00:15:41.889172 sendto(3, "Host: localhost\r\n", 17, MSG_DONTWAIT, NULL, 0) = 17
00:15:41.889307 sendto(3, "\r\n", 2, MSG_DONTWAIT, NULL, 0) = 2
00:15:41.889437 poll([{fd=3, events=POLLIN|POLLPRI|POLLERR|POLLHUP}], 1, 0) = 0 (Timeout)
00:15:41.889544 poll([{fd=3, events=POLLIN|POLLERR|POLLHUP}], 1, 60000) = 1 ([{fd=3, revents=POLLIN}])
00:15:41.891066 recvfrom(3, "HTTP/1.1 200 OK\r\nDate: Wed, 15 F"..., 8192, MSG_DONTWAIT, NULL, NULL) = 285
00:15:41.891235 poll([{fd=3, events=POLLIN|POLLERR|POLLHUP}], 1, 60000) = 1 ([{fd=3, revents=POLLIN}])
00:15:41.908909 recvfrom(3, "", 8192, MSG_DONTWAIT, NULL, NULL) = 0
00:15:41.909016 poll([{fd=3, events=POLLIN|POLLERR|POLLHUP}], 1, 60000) = 1 ([{fd=3, revents=POLLIN}])
00:15:41.909108 recvfrom(3, "", 8192, MSG_DONTWAIT, NULL, NULL) = 0
00:15:41.909198 close(3)                = 0
00:15:41.909323 write(1, "Hello World\n", 12) = 12
00:15:41.909532 munmap(0x7ff3866c9000, 528384) = 0
00:15:41.909600 close(2)                = 0
00:15:41.909648 close(1)                = 0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T14:17:53.343

因此，如果我对您的理解正确，部分问题可能是 *.dat 文件始终具有 1:00 AM 的时间戳？您是否可以控制包含数据的服务器 ( `http://www.iac.ethz.ch/php/chn_meteo_roof/`)？如果是这样，您应该尝试找出为什么数据总是具有相同的时间戳。我必须相信它是故意设置的——操作系统会在文件被修改时更新时间戳，除非你不遗余力地让它不这样做。如果您不知道为什么将其设置为凌晨 1 点，您至少可以对文件执行“触摸”命令，这将更新其修改后的时间戳。

当然，这就是全部，假设您对提供文件的服务器有一定的访问权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T14:24:56.323

为什么不尝试使用[curl](http://ar2.php.net/curl)，我认为这是更合适的用途。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T14:29:46.830

也许这可以解决您的问题（据我所知，无法缓存 POST 请求）

```
$opts = array('http' =>
  array(
    'method'  => 'POST',
    'content'=>''
  )
);
$context  = stream_context_create($opts);
$resource = fopen ('http://example.com/your-ulr', 'r', false, $context);

/* or you can use file_get_contents to retrieve all the file 
   $fileContent = file_get_contents('http://example.com/your-ulr', false, $context);
*/ 
```

# c# - VB.net Shared vs C# Static 可访问性差异，为什么？

> ID：511477
> 
> 赞同：6
> 
> 时间：2009-02-04T14:02:18.897
> 
> 标签：c#, vb.net

这可能是一个愚蠢的问题 - 但是为什么在 VB.net 中的类型和实例上可以使用共享方法 - 我认为它们等同于 C# 静态方法是错误的吗？

IE

```
MyClass.MySharedMethod()

dim mc as new MyClass()
mc.MySharedMethod() 
```

为什么允许我这样做？这有什么可能的优势 - 我所看到的只是在使用智能感知时让人们感到困惑。我确信这与经典 VB6 的一些约定有关，为什么要麻烦把它带到 .NET 上——这对我来说似乎很糟糕。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-04T14:05:40.543

是的，它基本上是 VB6 的后遗症。Java 也允许您这样做，但我相信现在大多数 IDE 都会警告您。

是的，这是一个非常糟糕的主意。最明显的坏例子是 Thread.Sleep：

```
Dim t as new Thread(...)
t.Sleep(1000) 
```

哪个线程在休眠？当前的一个。嗬！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T14:05:07.673

> 这可能是一个愚蠢的问题 - 但是为什么在 VB.net 中的类型和实例上可以使用共享方法 - 我认为它们等同于 C# 静态方法是错误的吗？

他们是一样的。如果您尝试在实例上使用它们， VB*会*发出警告，但这不是被禁止的。这可能与动态类型和后期绑定有关。想象一下，您有一个后期绑定对象 ( `Object`)，但不知道它的确切类型。您将如何调用其类的静态方法？

据我所知，这在 C# 中是不可能的（不诉诸反射）。在 VB 中`Option Strict Off`，您可以简单地将其作为对象的实例方法调用。

# html - Safari (Mac 10.4) 中的网站无法加载图像

> ID：511478
> 
> 赞同：0
> 
> 时间：2009-02-04T14:02:33.827
> 
> 标签：html, image, macos, safari, osx-tiger

我的网站在 Mac Safari 上不显示图像时遇到问题

完全相同的网站位于专用服务器上并且运行良好。当我们将其移至负载平衡环境时，图像仅在 Mac Safari 中停止工作，但仍可在所有其他浏览器中工作，包括 windows safari 和存在原始问题的 Mac 上的 Firefox。

我们尝试了其他 Mac，但问题仅存在于运行 OS 版本 10.4.etc 的 Mac 上。问题出现在运行 10.4 的 Mac 上的所有版本的 safari 上，而在运行其他版本的 Mac 上的所有版本的 safari 上问题都消失了。

该网站建立在社区服务器上。

我做了一些谷歌搜索，发现各种论坛都提到了这个问题，但是它们都是从客户端的角度来看的，他们说这个问题只影响某些网站。我还没有找到任何与开发人员相关的材料来解释如何从代码方面修复它。

我正在联系 Mac 网站开发人员，因为我绝对不是 Mac 用户，而且我不知道如何继续。任何可以让我开始的链接或想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T14:10:28.443

您可以通过以下方式解决此问题

1.  确保 Safari 的代理设置正确

2.  刷新时绕过 Safari 的缓存

# vba - 在用户窗体上显示单元格范围；然后更新

> ID：511488
> 
> 赞同：0
> 
> 时间：2009-02-04T14:05:23.727
> 
> 标签：vba, excel

我一直在使用一种粗略的方法来帮助用户更新一些单元格——将它们放在一张表中。有什么方法可以在用户表单中一一显示各种范围，然后让用户更新它们，单击一个按钮并移动到下一个？

本质上，我可以让 Excel 根据范围自动生成输入表单吗？我可以做的更新和保存回工作表的过程；这是我做不到的正确形式的产生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T14:28:16.007

我不太确定您要查找的内容，但是您可以插入第二张纸并将其用作“表格”。另一种方式可能是带有输入字段的对话框。

无论哪种方式，您都可以使用 vba 函数呈现您希望用户一一更改的单元格。您实现了一个“上一个字段”和一个“下一个字段”按钮，因此用户可以逐步浏览单元格范围。如果用户点击“下一个字段”，则保存他的输入并从先前定义的单元格范围中获取下一个单元格。

您可以有一个“配置字段”，您可以在其中定义要更改的单元格范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T18:04:37.380

可以做到这一点，但我能想到的唯一方法是制作一个根据传入的范围自动填充自身的用户表单。这样，您可以在 Excel 中使用不同的宏来调用表单以根据不同的范围进行填充。我建立了一个概念证明 Excel 文件来尝试这个，它似乎有效，我能想到的唯一问题是你需要找出一种方法来告诉用户输入字段是什么。

我认为需要做的是以编程方式将控件添加到用户窗体（我将文本框命名为要填充的单元格地址），然后当表单关闭时，遍历所有文本框并使用文本框值填充单元格。

你可以看到我做了什么： [https ://my.syncplicity.com/share/uicgbs3rl0/InputForm.xls](https://my.syncplicity.com/share/uicgbs3rl0/InputForm.xls)

我认为您需要做的就是弄清楚如何为文本框添加标签，并确保根据您添加的控件调整表单的大小......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T02:20:00.733

这是相当粗略和过时的，但如果您有标准列表格式的数据 - 即范围的第一行中的列标题，然后下面每一行中的一个数据记录 - 然后选择范围内的一个单元格并`Data > Form`继续给你一个粗略的输入表单，大致上你需要的功能。

您也可以通过调用`ShowDataForm`相应工作表的方法在 VBA 中执行此操作。只需在您首先需要的任何范围内选择一个单元格。宏将保持暂停状态，直到用户关闭数据表单

# c# - 我应该如何处理 .NET 中的套接字断开连接？

> ID：511507
> 
> 赞同：2
> 
> 时间：2009-02-04T14:12:06.537
> 
> 标签：c#, .net, sockets

我正在构建一个（LAN）网络应用程序，因此由于各种可能的原因，连接总是有可能断开。我试图想出一个好的设计来处理这个问题，这样它就不会影响应用程序的其余部分。我写了一个快速的东西来尝试这样做，但我认为它可以增强很多。感谢您在处理此问题的最佳方式方面的帮助和经验。

这是我的第一次试验：

```
class ConnectionWrapper {
    NetworkStream stream;
    StreamReader reader;
    Endpoint endPoint;
    bool endOfStream;
    int maxRetries = 5;

    public void connect() {
        // ... code to initialize a (TCP) socket to endPoint
        this.stream = new NetworkStream(socket, true);
        this.reader = new StreamReader(stream);
    }

    string readNextMsg() {
        try {
            string msg = reader.ReadLine();
            if (msg == "EOF") endOfStream = true;
            return msg;
        }
        catch (IOException e) {
            Exception ex = e;
            while (maxRetries-- > 0) {
                try { connect(); ex = null; }
                catch (Exception e2) { ex = e2; }
            }
            if (x != null) throw ex;
        }
    }
} 
```

不是很优雅，也可能不是最好的。您能否分享您的经验，甚至可以建议现有的图书馆？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:31:07.220

我打算编辑我​​的帖子，但这应该与我的上一篇完全分开。

在我看来，你的逻辑都是错误的，你应该在 ConnectionWrapper 中有一个线程，它在 StreamReader 上旋转，提取消息并将它们放在队列中。然后，此队列将更改通知侦听器。然后侦听器自己去检索数据并决定需要对它们做什么。

```
class ConnectionWrapper {
    NetworkStream stream;
    StreamReader reader;
    Endpoint endPoint;
    bool endOfStream;
    int maxRetries = 5;
    ArrayList arr;

    public void connect() {
        // ... code to initialize a (TCP) socket to endPoint
        this.stream = new NetworkStream(socket, true);
        this.reader = new StreamReader(stream);
    }

    private void initReceiverThread() {
        String line;

        while(stream.isConnected() && (line = reader.readLine()) != null) {
           // notify observers of a change
           arr.add(line);
        }
    }
} 
```

这是我警告你的伪代码，我从来没有在 C# 中这样做过。典型的阅读器实际上*会等待*readLine 语句，因此 while 循环不会变得疯狂。最好将 initReceiverThread 代码放在一个线程中，这样它就不会阻塞应用程序的其余部分。通过通知观察者发生变化，他们可以通过执行 myConnectionWrapper.getMessages() 之类的操作来获取 ArrayList；这将返回一个 ArrayList，但同时也会清除 ArrayList，如下所示：

```
public ArrayList getMessages() {
     ArrayList temp = arr;
     arr.clear();
     return temp;
} 
```

这样您就可以获得所有消息并将它们从队列中清除。

我以前写过网络客户端，这是一个的一般设计。您将有两个线程不断旋转，一个用于接收消息，一个用于发送消息。

逻辑应该处理某种类型的管理器代码，以确定是否继续，或重新连接或任何你想做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T14:14:40.400

老实说，我认为您不应该让连接包装器包含处理其自己的连接策略的逻辑。我认为这应该在这个类之外完成，尤其是不要在 catch 语句中。有某种 ConnectionController 对象来处理连接失败后是否应重试。

# wpf - 如何从 LINQ 转移到 SQL 到“LINQ 到 WCF”？

> ID：511511
> 
> 赞同：7
> 
> 时间：2009-02-04T14:14:04.800
> 
> 标签：wpf, linq, wcf, linq-to-sql

我正在组合一个 WPF 应用程序，该应用程序最终将使用 WCF Web 服务作为其数据源。

在原型设计阶段，我在 SQL 2008 数据库上使用 LINQ to SQL，并开始欣赏我可以轻松地执行“添加新项目 | LINQ to SQL 类”并为表生成模型类，然后说话使用 LINQ 将其传递给我的 XAML UI，非常好。

但是当我们将数据源从 SQL Server 切换到 WCF Web 服务时会发生什么？为了继续使用 LINQ，我是否必须：

*   手动编写我自己的 LINQ-to-web-service 类（使用 IQueryable 等？）
*   是否有执行此操作的代码生成工具，例如“LINQ-to-WCF”（奇怪的是这个术语甚至在 Google 中都没有出现）
*   还是我必须从我的 Web 服务中低效地获取大量记录，从中创建对象，然后使用 LINQ-to-objects 来查询它们？

感谢您在这里提供的任何指导。

### 补充：感谢您的回答，非常有帮助，但导致了一些混乱：

*   这个[MSDN 教程](http://msdn.microsoft.com/en-us/library/cc907912.aspx)说“添加新项目 | **ADO.NET 实体数据服务**”
*   我有 VS2008，可以做“添加新项目 | **ADO.NET 实体数据模型**”
*   这个[MSDN 视频](http://msdn.microsoft.com/en-us/data/cc745968.aspx)说要使用我在 VS2008 中没有的**ADO.NET 数据服务**模板创建一个新项目
*   所有这些最常用的有什么区别？
*   从我目前所读到的内容来看，与“LINQ to Entities”有关的任何事情都需要成本，而“LINQ to SQL”是免费的，那么上面的“实体数据服务/模型”选项是否与 LINQ to Entities 有关？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T14:20:08.313

您可能需要[ADO.NET 数据服务](http://msdn.microsoft.com/en-us/data/bb931106.aspx)。您必须向实体添加[IUpdatable](http://msdn.microsoft.com/en-us/library/System.Data.Services.IUpdatable.aspx)接口实现，并且可以使用[LINQ to SQL](http://davidhayden.com/blog/dave/archive/2008/12/14/IUpdatableLINQToSQLADONETDataServicesUpdatedORMappers.aspx)、Entity Framework、[SubSonic](http://www.pnpguidance.net/Post/SubSonic3IUpdatableSupportADONETDataServicesDataAccessORMapper.aspx)或其他一些。我们正在使用[CodeSmith PLINQO 模板](http://code.google.com/p/codesmith/wiki/PLINQO)，它允许您将此功能添加到 LINQ to SQL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T14:44:08.470

通用 LINQ to WCF 可能没有意义。特别是，WCF 调用仅以非常特定的方式公开数据，这并不真正符合 LINQ 的处理方式。例如，我的服务可能有以下合同：

```
List<DAO> GetObjectsInDateRange(DateTime start, DateTime end);
void ExportObjectsToLegacySystem(List<DAO> data); 
```

您如何以 LINQ 格式表达。特别是当 start 和 end 不是 DAO 的成员时。表达它的唯一方法是让服务公开一个 IQueryable 接口，我不知道这有多大可能。

现在，您可以随时执行以下操作：

```
var data = from dao 
in wcfService.GetObjectsInDateRange(DateTime.Today,DateTime.Today.AddDays(50))
where dao.AmountOfStuff > 20
select dao; 
```

话虽如此，您当然可以创建为您自己的服务量身定制的 LINQ 接口。假设您的服务有一个方法：

```
List<DAO> GetObjects(DAOFilter filterObject); 
```

其中 DAOFilter 是一个指定所有“位置”条件的对象，您可以做的是编写一个 LINQ 提供程序，将所有表达式转换为此 DAOFilter 对象。这将是一个令人难以置信的一次性解决方案，需要大量工作，所以我建议不要这样做。

我同意看看[ADO.Net Data Services](http://msdn.microsoft.com/en-us/data/bb931106.aspx)的建议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T14:17:06.417

您是否看过[ADO.NET 数据服务](http://en.wikipedia.org/wiki/ADO.NET_Data_Services)。在这里，您可以使用 linq 语法通过网络查询数据存储。

您将保留 LINQ to SQL 数据上下文，但将其公开给 Web，并允许您的客户端在标准 LINQ 语句中查询上下文。您显然必须保护数据服务，以便只有授权的客户端可以连接，但基本上只需最少的工作，您就可以让您的数据上下文“客户端”可以这么说。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-15T21:08:01.667

您可以将 Linq to SQL 类直接添加到 WCF 项目中，并将 Linq to SQL 类上的序列化模式设置为单向。如果您这样做，这些类将显示在 WCF 服务上。

# flash - 如何通过 AMFPHP (AS3) 从 Flash 使用 Drupal 服务？

> ID：511513
> 
> 赞同：0
> 
> 时间：2009-02-04T14:14:18.170
> 
> 标签：flash, actionscript-3, drupal, amfphp

哪些库或示例代码将向我展示如何通过 AMFPHP 从 ActionScript 调用 Drupal 服务？理想情况下，它们应该与 Flash 兼容，而不仅仅是 Flex。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:14:43.053

[DrupalSite](http://thirdavedesign.com/drupalsite/)非常适合我！

# sql-server - SQL 服务器复制建议

> ID：511515
> 
> 赞同：3
> 
> 时间：2009-02-04T14:14:43.037
> 
> 标签：sql-server, scalability

我们有一个场景

一个主要的电子商务网站 - 目前吸引了大量访问者。

三个子“品牌特定”站点将挂起此站点 - 随着时间的推移，这些站点中的每一个都可能具有相同的流量水平。

客户要求每个品牌站点的订单处理在一个地方（即一个后台）进行。

我们应该选择什么样的拓扑？我们认为，也许拥有一个从后台读取和写入的主 sql 服务器，并将该数据复制到“品牌特定”的 sql 服务器实例可能会起作用。每个品牌特定站点都有自己的专用 sql 服务器用于 Frontoffice“读取”。我们执行的任何写入都将返回到主数据库以保持库存并发

有什么想法吗？未来的可扩展性是一个主要因素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T15:29:52.620

如果对应用程序的运行方式没有更详细的了解，就很难为您提供明确的方向。

您提出的具有支持读取和写入的中央服务器（发布者）的建议实现，以及一些仅用于读取的额外站点特定服务器（订阅者），当然是合理的。这样做的另一个好处是，您可以灵活地仅复制读取查询所需的表，即您的中央服务器可能会管理可能不需要推送给订阅者的供应商信息、账单等数据。

如果有的话，您的中央服务器可能会成为您的症结所在，因为所有其他服务器都会将写入活动引导回它。分布式站点的位置，即它们与中央服务器的距离也会影响复制环境的事务延迟。

如果您希望在分布式站点上将所有数据库数据显示为只读，那么您可能希望考虑为此使用日志传送。如果您的应用程序需要知道只能在本地服务器上处理读取活动并且所有写入活动都需要路由到中央服务器，则此实现的缺点。

我希望这会有所帮助，但请随时提出其他问题。

干杯，约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:34:12.687

不是您问题的具体答案，但[Youtube 缩放](http://video.google.com/videoplay?docid=-6304964351441328559)是一个关于 youtube 缩放的有趣视频。Prehaps它会给你一些想法。

# java - 将给定方法公开为 Web 服务的最简单方法 - 结果必须可在 Java 5 下的 Web 容器中运行

> ID：511523
> 
> 赞同：2
> 
> 时间：2009-02-04T14:16:38.977
> 
> 标签：java, web-services, jakarta-ee

我处于需要将 Java 方法公开为 Web 服务的情况，我需要选择技术来这样做，我基本上有点困惑。

要求是：

*   必须可在 IBM Java 5 中运行。
*   必须可作为 Web 应用程序部署在嵌入式 Jetty（当前版本 6）中
*   必须可以从 IDE 中分离（之前在 MyEclipse 5 中使用过 XFire，我想要一个独立版本）
*   必须得到很好的支持，速度相当快，最好是开源的。
*   如果它易于使用，那就太好了。

我已经看到了多种可能性，CFX（和 XFire）、Axis 1 和 2、Netbeans 6（想要 Glassfish）、JAX-WS（显然具有 Java 6 的特性，这些特性很好但可能不是一个选项，除非它可以被逆向编译)，JDeveloper 有一些东西，还有 Eclipse，我很难获得足够的信息来做出决定。

我会很感激指针、经验、建议和警告。

* * *

选择的方法是使用运行良好的 Metro 1.4。

* * *

我在[http://archive.midrange.com/java400-l/200902/msg00074.html](http://archive.midrange.com/java400-l/200902/msg00074.html)和更多详细信息在[http://archive.midrange.com/java400-l/200904/上告诉了其他人我的经验msg00071.html](http://archive.midrange.com/java400-l/200904/msg00071.html)

该信息适用于任何 Servlet 2.4 兼容容器（这可能是整个 Metro 项目恕我直言中做出的最重要的单一技术决策 :)）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T14:45:03.537

可以独立于 Glassfish 下载和使用JAX-WS [Metro](https://jax-ws.dev.java.net/)堆栈（与 J2EE 1.5+ 或 J2SE 6+ 一起提供的堆栈）。由于它使用@Webservice 注释，因此公开服务变得相当容易。

Metro 站点也有一个关于在 Eclipse 中使用它的[页面。](https://jax-ws.dev.java.net/guide/Developing_with_Eclipse.html)我还发现了[一篇](http://gorik.wordpress.com/2008/03/15/jax-ws-and-jetty/)关于让它与 Jetty 一起工作的博客文章......显然 Jetty Embedded[仍然可以](http://gorik.wordpress.com/2007/05/12/jax-ws-and-jetty-embedded/)与 jetty.xml一起使用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T16:03:05.300

我会投票支持使用 JSR-181 Web 服务注释的 Apache CXF：

[http://cwiki.apache.org/CXF20DOC/a-simple-jax-ws-service.html](http://cwiki.apache.org/CXF20DOC/a-simple-jax-ws-service.html)

最简单的例子：

```
@WebService
public class Hello {
    public String sayHi(String name) {
        return "Hello " + name;
    }
} 
```

您可以轻松使用基于注释的开发以及相当轻量级且非常便携的开源解决方案。如果您想在不部署到容器的情况下公开基于 CXF 的服务，它对使用嵌入式 Jetty 本身具有出色的支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T18:51:22.963

在大多数情况下，诸如“将 Java 方法公开为 Web 服务”之类的要求意味着需要某种远程访问，不一定是 Web 服务，使用臃肿的 SOAP、WSDL 最终会使解决方案变得比需要的更复杂. 如果目标是真正创建一个 Web 服务，那么您应该从 WSDL（合同优先）开始。[甚至 Spring 也建议这样做](http://static.springframework.org/spring-ws/sites/1.5/reference/html/why-contract-first.html)。

如果您可以控制客户端和服务器端并且两者都是 Java，那么我会推荐某种远程处理。我喜欢 Spring Remoting，特别是[Cauho 的二进制协议](http://static.springframework.org/spring/docs/2.0.x/reference/remoting.html#remoting-caucho-protocols)。互操作性非常简单，您将使用 Pojos，并且由于数据以二进制形式传输，因此性能也将优于使用 XML 的 Web 服务。

如果您无法控制客户端，那么我会选择 Simple XML 或 JSON over HTTP 服务，因为 XML 提供了互操作性。过去我曾成功使用[XStream](http://xstream.codehaus.org/)来创建 Java 对象的简单 XML 表示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T16:04:02.740

我正在使用 Spring Web 服务。它们让我远离 Axis、XFire 等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T16:32:57.063

我更喜欢轻量级、控制你自己的命运的方法。如果您控制通信的双方，那么选择您自己的简单、优化的传输方式。如果您不能控制双方，那么您可能会被所提供的建议（特别是基于 XML）所困扰。

我更喜欢使用非常轻量级的 Web 服务，这意味着不使用 XML 并且不使用大量的包装层（如 SOAP、Axis 等）。您真正需要的只是 HTTP 和共享数据表示。

关于 HTTP，您应该简单地执行一个 GET 来读取数据（没有副作用）和一个 POST 来提交操作（副作用），在适当的时候可能使用 PUT、DELETE 等。

至于数据表示，请记住，所有其他 Web 服务方法都假定了很多需求并增加了很多复杂性。他们中的大多数完全忽略了性能（例如，XML 是性能的地狱）。

如果您不需要 XML 来实现与第三方的互操作性，那么您可以省去很多心痛并重新获得性能。HTTP 是基于文本的，因此请将您的数据转换为简单的字符串。由于您使用的是 Java，因此如果您的数据非常复杂，请使用属性文件格式。如果您的数据更加复杂，例如包含详细信息的客户订单的完整对象图，请考虑使用 JSON。

使用 JSON 是我选择的所有未来努力的方向，除非特定要求迫使我使用 SOAP 或其他东西。JSON 使得通过 AJAX 使用 Web 服务变得很容易，并且很容易适应跨平台和语言的互操作性。JSON 还可以很好地处理简单的情况，例如传递单个数据值或类似属性文件的数据（简单的名称/值对集）。

当您确实需要性能但也需要互操作性和简单性时，另一个轻松传递数据的选择是 Google 的协议缓冲区。但是，我怀疑您的直接需求是否适合该选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T08:06:29.500

感谢所有回复的人。

不同的方法不是一个好主意。为“WSDL 合同”选择了 Web 服务，允许团队（来自不同供应商）之间的解耦开发，并且各种开销在这里不太相关。

在查看了所有建议之后，我决定我喜欢@WebService 方法，并且第一次尝试是让 Metro 在我们的场景中工作。CFX 包有非常多的依赖关系，Metro 被声明为兼容 servlet 2.4 并且应该在 Tomcat 上运行。不幸的是，Metro 要求某些 Java 6 版本的某些类位于引导类路径中，但这在我们的场景中应该是可以绕过的。

* * *

2009-02-19：事实证明，Metro 1.4 运行时库可以动态生成以前需要“apt”预处理和部署生成的工件的类。它在 Eclipse Java EE 透视图中的嵌入式 Jetty 6.1 Web 容器以及 Tomcat 6 和 Jetty 6 服务器上运行得非常好，允许轻松开发。

在我看来，仅部署带有 WebService 和 WebMethod 注释的原始类的方法是如何确保源在规范的未来实现中保持不变。希望即使没有重新编译。标记为已接受答案的建议。

# jquery - jQuery中的列表ID

> ID：511527
> 
> 赞同：0
> 
> 时间：2009-02-04T14:17:16.527
> 
> 标签：jquery, list

我需要提取列表 ID “first”、“second”和“final”。我的清单有：

```
<div id="wrapper">
    <ul id="testnav">
        <li> <a href="#">Page</a></li>
        <li> <a href="#">Page.</a>
            <ul id="subnav">
                <li id="first"><a href="#">Value1</a></li>
                <li id="second"><a href="#">Value2</a></li>
            </ul>
         </li>
    </ul>
    <ul id="navbelow">
        <li id="final"><a href="#">Next</a>
        </li>
    </ul> 
```

我的 jQuery 代码如下，它返回一个空警报。为了提醒列表 ID“第一”、“第二”和“最终”，我应该更改什么？

```
$("#testnav a").click(function(ev){
    var a=$(this).attr('id');
    alert(a); // Not working
    ev.preventDefault(); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:19:18.770

脚本中的“this”指的是锚点，而不是列表项。您没有锚点上的 id，因此在请求 .attr("id"); 时您将一无所获。

我建议使用[.parent()](http://docs.jquery.com/Traversing/parent#expr)来访问列表项，或者将您的点击事件放在列表项而不是锚点上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:20:50.980

如前所述，您指的是锚 (A) 元素而不是列表元素。您将需要使用类似的东西`$(this).prev('li')`而不是`$(this)`

# sql - 甲骨文 ORA-00600

> ID：511534
> 
> 赞同：4
> 
> 时间：2009-02-04T14:19:07.333
> 
> 标签：sql, oracle, plsql, ora-00600

我有返回的 SQL SELECT 语句：

```
 Error: ORA-00600: internal error code, arguments: [qerpfAllocateR], [], [], [], [], [], [], [] 
```

如果我通过在 WHERE 子句中再添加一个条件来缩小结果范围，那么一切正常。

有谁知道发生了什么？

编辑：

```
 select * from ( select tbl1.col1, ..., tbl1.points
    from table1 tbl1, table2 tbl2
    where tbl1.tbl2FK = tbl2.PK and
          tbl2.col1 = someNumber and
          tbl1.dateColumn = to_date('27-10-2008','dd-mm-yyyy')
    order by tbl1.points desc ) s where rownum <= 3 
```

编辑2：

我的数据库管理员建议了可行的解决方案：

```
select * from (select rank() over (order by tbl1.points desc) rank,
                  tbl1.col1, ..., tbl1.points
           from table1 tbl1, table2 tbl2
           where tbl1.tbl2FK = tbl2.PK and
                 tbl2.col1 = someNumber and
                 tbl1.dateColumn = to_date('27-10-2008','dd-mm-yyyy')) s
     where s.rank <= 3 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T14:29:20.683

ORA-0600 错误表示 Oracle 本身存在内部错误。您很可能遇到了 Oracle 错误。

如果您访问[http://metalink.oracle.com](http://metalink.oracle.com)，您可以通过将“参数”和完整堆栈跟踪粘贴到 ORA-0600 查找工具中来查找确切的错误（如果已知）。参见金属链接注释 153788.1。

如果该描述存在已知错误，则很可能已经有一个补丁可供您下载和安装。如果不是已知错误，请联系支持人员。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T14:22:11.290

什么是完整的查询？

[http://www.orafaq.com/wiki/ORA-00600](http://www.orafaq.com/wiki/ORA-00600)建议您应该向 oracle 报告错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T14:40:06.997

祝您好运，获得 Oracle 的支持...

说真的，每次我遇到这个问题时，重新排列查询通常会有所帮助。也许摆弄一下索引。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T04:01:50.650

ORA-00600 基本上意味着您已经使 oracle 服务器崩溃（不是实例，只是为您的请求提供服务的服务器）。

在您的 bdump 位置中几乎总会有一个跟踪文件。这可能不会对您有很大帮助，但对 Oracle 支持非常有帮助。

这通常是由 oracle 错误引起的，根据经验，除了通过 metalink 提出 SR（这是 Oracle 推荐的解决方案）之外，您对它们无能为力。他们将尝试复制该问题，如果运气好的话，如果它是一个错误，它最终会找到进入补丁的途径。

但在短期内（例如，几天 - 几个月），主要的现实解决方案是解决它。

虽然提高 SR 并不能真正帮助您，而且可能是一种令人沮丧的体验，但值得这样做，因为一旦修复了错误，它可能会节省其他人的时间。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T16:12:34.640

这些错误通常与优化器有关。我认为即使是查询中的最小更改（例如在 FROM 子句中切换 table1 和 table2 的顺序）也可能会迫使优化器选择不会遇到此错误的不同计划。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-01-23T03:23:29.610

我的解决方案：

问题

![在此处输入图像描述](https://i.stack.imgur.com/hHCTQ.png)

这个 DIDNT 工作出现错误 [0600]

```
SQL> shutdown abort
ORACLE instance shut down.
SQL> startup mount
ORACLE instance started.

Total System Global Area 1904054272 bytes
Fixed Size                  2404024 bytes
Variable Size             570425672 bytes
Database Buffers         1325400064 bytes
Redo Buffers                5824512 bytes
Database mounted.
SQL> recover database
Media recovery complete.
SQL> alter database open
  2
SQL> alter database open;
alter database open
*
ERROR at line 1:
ORA-00600: internal error code, arguments: [kcratr_nab_less_than_odr], [1],
[108], [615], [655], [], [], [], [], [], [], []` 
```

这是我的问题解决方案：

```
 SQL> Startup mount
ORA-01081: cannot start already-running ORACLE - shut it down first
SQL> shutdown abort
ORACLE instance shut down.
SQL>
SQL> startup mount
ORACLE instance started.

Total System Global Area 1904054272 bytes
Fixed Size                  2404024 bytes
Variable Size             570425672 bytes
Database Buffers         1325400064 bytes
Redo Buffers                5824512 bytes
Database mounted.
SQL> Show parameter control_files

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
control_files                        string      C:\APP\USER\ORADATA\ORACLEDB\C
                                                 ONTROL01.CTL, C:\APP\USER\FAST
                                                 _RECOVERY_AREA\ORACLEDB\CONTRO
                                                 L02.CTL
SQL> select a.member,a.group#,b.status from v$logfile a ,v$log b where a.group#=
b.group# and b.status='CURRENT'
  2
SQL> select a.member,a.group#,b.status from v$logfile a ,v$log b where a.group#=
b.group# and b.status='CURRENT';

MEMBER
--------------------------------------------------------------------------------

    GROUP# STATUS
---------- ----------------
C:\APP\USER\ORADATA\ORACLEDB\REDO03.LOG
         3 CURRENT

SQL> shutdown abort
ORACLE instance shut down.
SQL> startup mount
ORACLE instance started.

Total System Global Area 1904054272 bytes
Fixed Size                  2404024 bytes
Variable Size             570425672 bytes
Database Buffers         1325400064 bytes
Redo Buffers                5824512 bytes
Database mounted.
SQL> recover database using backup controlfile until cancel;
ORA-00279: change 4234808 generated at 01/21/2014 18:31:05 needed for thread 1
ORA-00289: suggestion :
C:\APP\USER\FAST_RECOVERY_AREA\ORACLEDB\ARCHIVELOG\2014_01_22\O1_MF_1_108_%U_.AR

C
ORA-00280: change 4234808 for thread 1 is in sequence #108

Specify log: {<RET>=suggested | filename | AUTO | CANCEL}
C:\APP\USER\ORADATA\ORACLEDB\REDO03.LOG
Log applied.
Media recovery complete.
SQL> alter database open resetlogs;

Database altered. 
```

终于成功了：

![在此处输入图像描述](https://i.stack.imgur.com/TXcoQ.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-01-23T09:57:45.830

ORA-00600 通常意味着有一些非常意外的东西，它可能与数据库损坏有关。症状可能是查询是否有效，具体取决于它的制定方式。

**生活举例：**

*   id=<ID> 的特定行的 LOB 字段更新出错
*   该行在 SELECT * FROM <table> 中不可见
*   但是：SELECT * FROM <table> WHERE id=<ID> 执行失败并给出 ORA-006000。

**（可能）用于上述示例的解决方案**

*   导出所有可访问的表格内容
*   删除表
*   重新导入内容

**祝你好运！**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T14:23:58.417

当表中有 XMLTYPE 列时，我使用 PL/SQL Developer 看到过这样的错误。如果我让 PL/SQL Developer 为我创建查询框架就不会发生这种情况，因为它会向 XMLTYPE 列请求添加一些语法，我不记得具体是什么。

# c# - Mageui.exe 中的 dll.manifest 上没有指定入口点

> ID：511536
> 
> 赞同：1
> 
> 时间：2009-02-04T14:19:12.077
> 
> 标签：c#, visual-studio-2008, dll, manifest

我正在尝试在 DLL 上使用 Visual Studio 2008 中包含的 MageUI.exe 来部署它。当我尝试保存应用程序清单时，每次都会收到“文件页面 - 未指定入口点”消息。如果我在“文件”选项卡上将 dll 设置为入口点，则它不是有效的入口点。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T17:50:46.550

你确定有一个有效的入口点吗？通常，入口点是`static void Main(string[] a) {...}`您希望针对包含运行 Main 的程序集或可执行文件的文件夹运行 Mage。除非它是一个 COM dll，在这种情况下它会变得有点复杂......

# language-agnostic - 修改前序树遍历 - 在没有指定父节点时确定“顶部”

> ID：511538
> 
> 赞同：1
> 
> 时间：2009-02-04T14:19:21.903
> 
> 标签：language-agnostic, modified-preorder-tree-t

我正在为网站上的类别树实现一个修改后的预排序树遍历类，但是我在一个场景中遇到了麻烦。通常在插入新类别时会指定顶级父级，其在树中的左值用于确定新类别在树中的位置。但是，有时可能没有指定父类，这意味着新类别必须进入树的顶部，位于树顶部的任何其他类别的右侧。

查看其他一些具有类似结构的应用程序，其中许多似乎在安装时在树中插入了一个“根”节点。我想知道这是不是这样他们就不必检测它是否是第一个插入，并且他们总是有一个左参考。任何想法或伪代码将不胜感激。如果重要的话，我会在 PHP 中执行此操作。我的树可能看起来像这样：

```
Electronics         Apparel         My New Category
    / \               / \
MP3     TVs    Shirts     Shoes 
```

我的想法是，在这种情况下，Apparel 的正确值将始终是表中最大的，但我不确定如何使用它来确定它是最后一个。任何帮助或提示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:58:39.240

在您提供的示例中，如果没有共同的父级，Electronics 和 Apparel 在技术上是两个独立的树。如果您添加“我的新类别”，它也是一棵新树。如果您尝试在 Electronics、Apparel 和 My New Category 之间进行遍历，您需要一个高于所有三个的值，例如“All”，即您的根节点。

有关枚举树和示例或数据库中实际存储的示例，请参阅[将分层数据存储在数据库中。](http://www.sitepoint.com/article/hierarchical-data-database/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T23:58:27.887

存储此类数据的另一种非常有效的方法是使用[嵌套集](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)，它只允许一个查询进行许多常见操作，并且无需递归其他方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-21T08:52:15.413

插入时。运行查询，按 LEFT 排序，取最后一个，即你的最后一个根类别，称之为 last_tree。插入新树时，给它一个左值 last_tree + 1 和右值 last_tree + 2。

在这里查看一个 cakephp 示例：

[http://bakery.cakephp.org/articles/view/modified-preorder-tree-traversal-component](http://bakery.cakephp.org/articles/view/modified-preorder-tree-traversal-component)

# javascript - 使用firebug，js错误显示在哪里？

> ID：511539
> 
> 赞同：1
> 
> 时间：2009-02-04T14:19:31.123
> 
> 标签：javascript, debugging, firebug

使用firebug，页面渲染时显示的js错误在哪里？（如果你有任何好的 js 调试链接 w/firebug 请按我的方式发送！）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T14:21:14.333

Javascript 错误将列在 Firebug 的控制台中。

您还可以将 Firebug 设置为在所有错误上中断，这有助于检测引发错误的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T14:23:54.563

正如您要求的一些链接：

1.  [Firebug 教程 - 日志记录、分析和命令行（第一部分）](http://michaelsync.net/2007/09/09/firebug-tutorial-logging-profiling-and-commandline-part-i)

2.  [Firebug 教程 - 日志记录、分析和命令行（第二部分）](http://michaelsync.net/2007/09/10/firebug-tutorial-logging-profiling-and-commandline-part-ii)

3.  [Firebug 教程 - 在 Firebug 中使用命令行 API](http://michaelsync.net/2007/09/15/firebug-tutorial-commandline-api)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T14:22:08.030

您需要为您正在查看的任何站点启用脚本面板。一旦你这样做了，它将在脚本选项卡下的下部窗格中显示“监视”、“堆栈”和“断点”选项卡。

# session - 跨域共享会话

> ID：511541
> 
> 赞同：6
> 
> 时间：2009-02-04T14:20:17.533
> 
> 标签：session, jboss, cross-domain

目前，我们面临跨子域共享相同会话的问题。我们正在使用 Jboss 服务器。

用户访问与其区域设置相对应的站点，例如具有唯一域名的 en_US。对应于域创建一个 cookie。允许用户转到具有不同域名的其他语言环境。问题是为另一个域创建了一个新的 cookie，它丢失了存储在前一个会话中的信息。我们需要跨域使用相同的会话 cookie。

防爆域：sample.au sample.co.uk sample.us

我要求研究 Iframe/p3p 解决方案。我对这个概念很陌生。你能指导我如何实现这一目标。

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T14:43:32.450

您需要的是[单点登录](http://en.wikipedia.org/wiki/Single_sign-on)服务。您可以通过拥有一个集中的站点 Z 来管理会话/登录，从而为您的站点 A..Y 滚动您拥有的站点。

*   用户到达站点 A，不提供任何会话 ID
*   站点 A 将用户重定向到站点 Z
*   站点 Z 可能在验证用户身份之后创建一个会话，并丢弃站点 Z cookie，将用户重定向回站点 A，其 URL 包含一个额外的有效负载，告诉站点 A 用户会话 ID 是什么
*   站点 A 丢弃会话 cookie 允许用户继续在 A 上使用他们的共享会话

现在当用户访问站点 B

*   站点 B 看不到会话，重定向到站点 Z
*   站点 Z 看到它已经为这个人建立了一个会话，用会话 ID 有效负载将他们直接引导回 B
*   站点 B 删除会话 cookie，一切都很好。

换句话说，您的信号登录服务为用户提供了他们可以挂起的东西（会话 cookie）以及他们可以传递给参与站点以证明他们已通过身份验证的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T14:23:54.033

Cookie 只能在对公共更高级别域有效的域中共享。所以`foo.example.com`并且`bar.example.com`可以共享一个为`example.com`. 请注意，cookie 的*Domain*参数值必须是`.example.com`（带前导点）才能完成此操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T14:25:33.217

您需要将 cookie 的域设置为以点开头的顶级域，例如对于 subdomain1.domain.com 和 subdomain2.domain.com，您将会话 cookie 的域设置为：.domain.com。

在 JBoss 中，您应该能够为 javax.servlet.http.Cookie 类中的所有子域覆盖它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-22T09:54:53.293

看

在域之间共享 Cookie

[http://www.15seconds.com/issue/971108.htm](http://www.15seconds.com/issue/971108.htm)

它似乎使用“重定向”来翻译域之间的 cookie。但它太复杂了。仅供参考。

# system-verilog - 为什么我应该在 System Verilog 中使用未打包的向量？

> ID：511542
> 
> 赞同：7
> 
> 时间：2009-02-04T14:20:47.860
> 
> 标签：system-verilog

跟进[这个](https://stackoverflow.com/questions/477646/packed-vs-unpacked-vectors-in-system-verilog "系统verilog中的打包与解包向量")关于 SV 中压缩向量和非压缩向量之间的区别的问题，我为什么要使用解压缩向量？
压缩向量具有未压缩向量所没有的这些优点：

*   您可以对它们执行按位操作
*   您可以对它们执行算术运算
*   你可以把它们切片
*   您可以将它们复制为一个整体矢量
*   您可以使用*未*打包的向量做任何事情（据我所知）

解压向量比打包向量有什么优势？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-08-06T00:58:01.850

我喜欢使用 unpacked 的还有另一个原因。解压后，不会有将整个数组名视为变量并进行错误赋值的诱惑（和偶然的可能性）。当您可能认为您正在访问元素 N 的 B 位时，也没有从一个元素到另一个元素的位流的可能性，但实际上您可能正在访问元素 N 的 K 位和元素 N+-1 的 BK 位。 .

我的理念是仅将属于一起的事物作为“信息单元”保留在打包维度中。未包装维度中的其他所有内容。默认思维应该是解包的，只打包你需要的。

例如，如果我有 9 个端口，每个端口都有 21 位信息，我想将其声明为：

```
input logic [20:0] p1 [9]; 
```

该`20:0`部分构成一个信息单元，一起分配和采样（名义上）。将这些位分开将破坏协议或端口的字符。另一方面，将端口数从 9 个更改为 16 个，不会影响每个端口中信息的性质，因此 9 个端口在我看来确实属于未打包维度。

希望这可能会给你一个思考的范式......在这个范式中，你会惊讶地发现有多少东西开始变得没有包装，而你一直认为它是包装好的！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-11T15:12:33.827

解压数组的存在有几个原因。

1) 压缩数组作为连续的位序列存储在内存中。解包数组可以让每个元素独立存储，从而产生更好的模拟性能。

2) 解包数组可以是不是位向量的类型。整数、字节、事件、结构、类等数组只能被解包。

3) 大多数数组操作方法仅适用于解包数组。

4）也许，只有解压的数组可以分配给使用数组文字。我不知道。

可能还有其他原因。

# java - 从不等待输入的套接字读取？

> ID：511552
> 
> 赞同：1
> 
> 时间：2009-02-04T14:22:10.323
> 
> 标签：java, sockets

我正在尝试在 Java 中进行一些 Socket 编程，并且正在使用 BufferedStreamReader.read(char[]) 方法。

Java 文档指出：

> 将字符读入数组。此方法将阻塞，直到某些输入可用、发生 I/O 错误或到达流的末尾。

只有它没有阻塞输入。

有人可以指出以下代码的问题吗？即使使用写入输出流的行，打印“RCVD：”的行也在打印，但在 RCVD 之后没有任何数据。

```
public class Main {

    /**
     * @param args the command line arguments
     */
         private static Socket tcpSocket;
    public static void main(String args[]) {
        try {
            tcpSocket = new Socket("localhost", 8080);
        } catch (UnknownHostException ex) {
            Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
        } catch (IOException ex) {
            Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
        }

        new Thread(new Runnable() {

            public void run() {
                try {

                    System.out.println("Starting listening");

                    char[] dataBytes = new char[9];
                    BufferedReader netStream = new BufferedReader(new InputStreamReader(tcpSocket.getInputStream()));
                    while (true) {
                        netStream.read(dataBytes);

                        System.out.println("RCVD: " + String.copyValueOf(dataBytes));
                    }
                } catch (UnknownHostException ex) {
                    Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
                } catch (IOException ex) {
                    Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        }).start();

        new Thread(new Runnable(){
            public void run() {
                System.out.println("Starting Writer");
               PrintWriter out = null;
                try {
                    out = new PrintWriter(tcpSocket.getOutputStream(), true);
                    for (int i = 0 ; i < 10 ; i++)
                    {
                      //  out.println("000000000");
                    }
                } catch (IOException ex) {
                    Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        }).start();

    }
} 
```

**附加信息**

我尝试更改端口号并且应用程序崩溃，也许我正在连接到机器上运行的其他东西。

此外，我正在接收稳定的字节流，所有这些字节看起来都是空格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:51:41.730

您需要查看[ServerSocket](http://java.sun.com/javase/6/docs/api/java/net/ServerSocket.html)。您的 Socket 目前实际上并没有“监听”，它正在尝试连接到 localhost:8080 但实际上并没有监听它！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T14:55:21.223

实际上，您正在连接到本地机器上的其他东西。

查看上面的代码，您似乎希望在套接字的输入流中接收您写入其输出缓冲区的数据。看起来好像您将套接字视为一段管子，输入流在管子的一端，输出流在另一端。

插座实际上是管子的*一端*，输入流可以让你听到从它下面传来的声音，而输出流可以让你对管子“说话”。

可能我对什么让你感到困惑感到困惑......以上有帮助吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T14:57:57.473

如果您认为您的读取没有阻塞，请捕获 read 方法的结果并打印它。如果你的假设是正确的，它应该是零。

```
int n = netStream.read(dataBytes);
System.out.println("Read " + n + " characters."); 
```

在任何情况下，您都需要知道读取了多少个字符才能`copyValueOf`正确调用——通常，只有部分数组会被上次读取的数据填充。而且，当然，返回值表示流结束（感谢 Darron！），因此您需要确定地检查它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T15:03:58.727

我已经运行了您的代码，并且能够从服务器接收和打印数据。测试您的服务器端以确保其正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-06T10:41:42.997

只需2c。我不是套接字专业人士，但是当我使用它时，我倾向于依赖下一行中更多的内容来阅读。

```
char[] dataBytes = new char[9];//tcpSocket.getReceiveBufferSize()

int result = 0;
while((result = is.read(inputData)) != -1)//check for eof, 
  //if(result > 0){//<- most probably the case anyways considering .read returned
  //display only what was received
    System.out.println("RCVD: " + String.copyValueOf(inputData,0,result));
  //}
} 
```

# saml - opensaml 2.0 的身份提供者实现

> ID：511559
> 
> 赞同：0
> 
> 时间：2009-02-04T14:23:11.583
> 
> 标签：saml

我们需要为我们的项目实现 opensaml2.0 的身份提供者实现。有没有人知道如何开始...非常感谢您的回复...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T19:05:16.963

I am currently using [OpenSAML](https://spaces.internet2.edu/display/OpenSAML/Home/) by "Internet2". I don't know much about them but we've been using their libraries for a while without any problems. The documentation on the OpenSAML1 version are non-existent ... but support for OpenSAML2 is much better.

You may also find some of the commercial product useful (taken from their site):

*   [Shibboleth](http://shibboleth.internet2.edu/)
*   [Globus Toolkit](http://www.globus.org/toolkit/)
*   [gLite](http://glite.web.cern.ch/glite/)
*   [VO Privilege Project](http://www.fnal.gov/docs/products/voprivilege/)
*   [Clarity Security's SSO Toolkit](http://code.crt.realtors.org/projects/websso)
*   [VOMS](https://twiki.cnaf.infn.it/cgi-bin/twiki/view/VOMS/WebHome)
*   [JBoss](http://labs.jboss.com/)
*   [CAS](http://www.ja-sig.org/products/cas/downloads/index.html)
*   [OpenPermis](http://www.openpermis.org/)
*   [Apache Rampart](http://ws.apache.org/rampart)
*   [OLAT](http://www.olat.org/website/en/html/index.html)
*   [eduGAIN](http://www.edugain.org/)
*   [openLiberty Wakame](http://www.openliberty.org/)
*   [OpenASelect](http://www.openaselect.org/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T17:08:28.157

这里有两个很好的链接，帮助我开始使用（现在这些链接对于已迁移到更新标准的 Google Apps 而言已被视为已弃用）

[https://developers.google.com/google-apps/sso/saml_reference_implementation](https://developers.google.com/google-apps/sso/saml_reference_implementation)

和

[https://developers.google.com/google-apps/sso/saml_reference_implementation_web](https://developers.google.com/google-apps/sso/saml_reference_implementation_web)

# mysql - mySQL 大文本比较性能...最佳实践？

> ID：511560
> 
> 赞同：2
> 
> 时间：2009-02-04T14:23:17.187
> 
> 标签：mysql, performance, indexing

我有一个较大的（约 150 万条记录）表，其中包含不同长度的文本字符串，我对其运行查询以查找匹配项：

```
CREATE TABLE IF NOT EXISTS `shingles` (
  `id` bigint(20) NOT NULL auto_increment,
  `TS` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
  `shingle` varchar(255) NOT NULL,
  `count` int(11) NOT NULL default '0',
  PRIMARY KEY  (`id`),
  KEY `shingle` (`shingle`,`TS`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1571668; 
```

我的问题是，当我对这个表进行比较时，我需要不断地添加和删除数据，所以维护索引很困难。

我正在寻找及时管理插入的最佳实践，同时最大限度地提高选择的吞吐量。这个过程每天 24 小时运行，并且需要尽可能快。

任何帮助表示赞赏。

**更新：** *为了澄清，我在“shingle”列上进行一对一的匹配，而不是在其中进行文本搜索。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T12:45:54.910

首先：您的 bigint 主键可能会在这里杀死您，这是一种尝试维护的非常昂贵的类型。150 万条记录远未接近 unsigned int 的限制（约 42 亿）。

在 InnoDB 中使用大 int 作为主键更糟糕，因为它针对每个其他索引中的每个条目存储 PK，因此可以部分解释尝试切换时的问题。一旦你从表中添加和删除，如果有很多并发事务，MyISAM 就会被搞砸。

避免字符串比较开销的一个技巧是存储 crc32(shingle) 以及 shingle。然后您索引此列，但不索引您的 varchar。下面是我的做法：

```
CREATE TABLE IF NOT EXISTS `shingles` (
  `id` int unsigned NOT NULL auto_increment,
  `TS` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
  `crc` int unsigned not null,
  `shingle` varchar(255) NOT NULL,
  `count` int(11) NOT NULL default '0',
  PRIMARY KEY  (`id`),
  KEY `crc` (`crc`)
)
insert into shingles (crc, shingle, count) values (crc32('testtest'),'testtest',1),(crc32('foobar'),'foobar',4);
select * from shingles where crc = crc32('foobar') and shingle = 'foobar'; 
```

如果您打算查询“ts”，则将其添加为 crc 索引的第二个组件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T04:14:46.943

对于初学者，使用 InnoDB 而不是 MyISAM。这将解决在进行插入时进行查询的问题。

您可能需要稍微调整一下 mysql 配置以将内存用于 innodb（innodb_buffer_pool_size 而不是 key_buffer_size）。

# optimization - 高效解释器中使用了哪些操作码调度策略？

> ID：511566
> 
> 赞同：10
> 
> 时间：2009-02-04T14:24:46.090
> 
> 标签：optimization, interpreter

哪些技术可以促进高效的操作码调度以实现快速解释器？是否有一些技术只能在现代硬件上运行良好，而其他技术由于硬件的进步而不再运行良好？必须在易于实施、速度和可移植性之间做出哪些权衡？

我很高兴 Python 的 C 实现终于超越了`switch (opcode) {...}`操作码分派的简单实现，转为作为编译时选项的间接线程，但我不太高兴他们花了 20 年才到达那里。也许如果我们在 stackoverflow 上记录这些策略，下一种语言会变得更快。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-07-29T16:10:59.490

有许多关于不同类型调度的论文：

M. Anton Ertl 和 David Gregg，[Optimizing Indirect Branch Prediction Accuracy in Virtual Machine Interpreters](http://www.complang.tuwien.ac.at/papers/ertl%26gregg03.ps.gz)，2003 年 ACM SIGPLAN 编程语言设计和实现会议论文集 (PLDI 03)，第 278-288 页，加利福尼亚州圣地亚哥，2003 年 6 月.

M. Anton Ertl 和 David Gregg，[高效虚拟机解释器在现代架构上的行为，](http://www.cs.tcd.ie/David.Gregg/papers/ertl-europar01.pdf)第 7 届欧洲并行计算会议论文集（Europar 2001），第 403-412 页，LNCS 2150，曼彻斯特，2001 年 8 月。

[石云和在他的博士论文](https://www.cs.tcd.ie/publications/tech-reports/reports.07/TCD-CS-2007-49.pdf)中提供了一个很好的总结。

此外，几年前[有人发现了一种新技术，它是有效的 ANSI C。](http://compilers.iecc.com/comparch/article/07-05-044)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T14:36:51.103

在你开始任何事情之前，请检查[Lua](http://www.lua.org)。

它很小 (150Kb)，纯 ANSI C，适用于任何具有 C 编译器的东西。非常快。

最重要的是 - 源代码干净易读。值得一试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T16:01:06.583

间接线程是一种策略，其中每个操作码实现都有自己`JMP`的下一个操作码。Python 解释器的补丁看起来像这样：

```
add:
    result = a + b;
    goto *opcode_targets[*next_instruction++]; 
```

`opcode_targets`将语言字节码中的指令映射到操作码实现的内存位置。这更快，因为处理器的分支预测器可以对每个字节码做出不同的预测，`switch`这与只有一条分支指令的语句相比。

编译器必须支持计算的 goto 才能工作，这主要意味着 gcc。

直接线程类似，但在直接线程中，操作码数组被替换为指向操作码实现的指针，如下所示：

```
goto *next_opcode_target++; 
```

这些技术之所以有用，是因为现代处理器是流水线的，并且必须在错误预测的分支上清除它们的流水线（慢）。处理器设计人员进行了分支预测以避免经常清理管道，但分支预测仅适用于更有可能采用特定路径的分支。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T14:28:30.997

[即时编译](http://en.wikipedia.org/wiki/Just-in-time_compilation)就是其中之一。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:05:15.337

一个巨大的胜利是以中间形式存储源代码，而不是在执行期间重做词法分析和解析。

这可以从仅存储令牌到 Forth 风格的线程代码一直到 JIT 编译。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T14:58:34.727

基准测试是一种在给定平台上快速做任何事情的好技术。测试，改进，再测试，改进。

我不认为你能得到更好的答案。制作口译员有很多技巧。但我给你一个提示，不要做权衡，选择你真正需要的东西并追求那些目标。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-11T17:33:01.840

我发现一篇关于线程解释器实现的博客文章很有用。

作者描述了基于 GCC 标签的线程，以及如何在 Visual Studio 中使用内联汇编器来实现这一点。

[http://abepralle.wordpress.com/2009/01/25/how-not-to-make-a-virtual-machine-label-based-threading/](http://abepralle.wordpress.com/2009/01/25/how-not-to-make-a-virtual-machine-label-based-threading/)

结果很有趣。他报告说使用 GCC 时性能提高了 33%，但令人惊讶的是，Visual Studio 内联汇编实现慢了 3 倍！

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-04T15:14:28.253

问题有点模糊。但是，您似乎在询问是否要编写解释器。

解释器通常使用传统的解析组件：词法分析器、解析器和抽象语法树 (AST)。这使设计人员能够阅读和解释有效的语法，并构建具有相关运算符、参数等的命令树结构。

一旦采用 AST 形式，整个输入就会被标记化，解释器可以通过遍历树开始执行。

有很多选择，但我最近使用[ANTLR](http://antlr.org)作为解析器生成器，它可以构建各种目标语言的解析器，包括 C/C++ 和 C#。

# .net - 数据行更新 .NET

> ID：511576
> 
> 赞同：0
> 
> 时间：2009-02-04T14:27:42.777
> 
> 标签：.net, datatable

我对数据行以及如何更新它有疑问...

我有一个包含两列的数据表，id 和 name。我执行以下操作：

```
 // data table has data at this point....

    myTable.Columns.Add("Fri");

    foreach(DataRow r in myTable.Rows) {
        r["Fri"] = 4;

    } 
```

我在这里要做的是添加一个新的列“Fri”。然后对于数据表中已经存在的每个条目，我希望将 Fri 列中的值设为 4。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:34:04.323

您列出的代码应该可以工作，但如果您想稍后将 Fri 值用作整数，您应该像这样声明列的数据类型：

```
myTable.Columns.Add("Fri", typeof(int)); 
```

# java - 在自动化回归测试中测量执行时间的最佳方法

> ID：511578
> 
> 赞同：6
> 
> 时间：2009-02-04T14:27:58.643
> 
> 标签：java, performance, testing, automated-tests, cpu-usage

我有一些代码，我想测量它在自动回归测试中连续运行时的速度。这样做的目的是提醒我对代码所做的更改会对性能产生负面影响。

在伪代码中，我想要这样的东西：

```
cpuTimer.start
runTest
cpuTimer.stop

diff = cpuTimer.getDuration

if diff > prevDiff // Perhaps to within a tolerance
    failTest 
```

我正在为此查看 ThreadMXBean#getCurrentThreadCpuTime() ，但关键问题是自动化测试将在各种不同的开发人员的电脑上运行，并且将自动外包以测试具有一系列不同硬件的服务器和能力。

这会奏效，还是数字会出错？

这个问题应该如何解决？有没有更好的办法？有这种雀跃的标准工具吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T15:03:33.173

您可以尝试查看[Perf4J](http://perf4j.codehaus.org/)。我还没有使用它，但它在我的调查清单上。

从他们的主页：

> Perf4J 对于 System.currentTimeMillis() 就像 log4j 对于 System.out.println()

[开发人员指南](http://perf4j.codehaus.org/devguide.html)是一个很好的介绍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:37:50.823

一种方法是分析在 maven 和 ant 中运行的 junit 输出的标准 xml 文件。这些包含您需要的所有数据。尽管有工具可以根据这些生成报告，但我不知道有任何聚合器/观察者。

如果你把它们放在一个包含主机名、测试名、执行时间和构建号字段的数据库表中，你应该能够做你需要的大部分事情。

# asp.net - 为什么我在尝试保存 PNG 时会在 GDI+ 中得到这个通用的、非描述性的错误？

> ID：511579
> 
> 赞同：2
> 
> 时间：2009-02-04T14:28:06.677
> 
> 标签：asp.net, vb.net, gdi+, png

我有一个功能可以动态地将文本添加到预先指定位置的图像中。最初我是用 jpegs 做的，它正在工作。我切换到PNG，因此图像质量会更好，因为原始的jpeg有点像素化。无论如何，这是我的代码。它执行到`oBitmap.Save()`，然后死于“GDI+ 中发生一般错误”。

```
Public Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
    context.Response.ContentType = "image/png"
    context.Response.Clear()
    context.Response.BufferOutput = True

    Try
        Dim oText As String = context.Server.HtmlDecode(context.Request.QueryString("t"))
        If String.IsNullOrEmpty(oText) Then oText = "Placeholder"
        Dim oPType As String = context.Server.HtmlDecode(context.Request.QueryString("p"))
        If String.IsNullOrEmpty(oPType) Then oPType = "none"

        Dim imgPath As String = ""
        Select Case oPType
            Case "c"
                imgPath = "img/banner_green.png"
            Case "m"
                imgPath = "img/banner_blue.png"
            Case Else
                Throw New Exception("no ptype")
        End Select

        Dim oBitmap As Bitmap = New Bitmap(context.Server.MapPath(imgPath))
        Dim oGraphic As Graphics = Graphics.FromImage(oBitmap)
        Dim frontColorBrush As New SolidBrush(Color.White)
        Dim oFont As New Font(FONT_NAME, 30)

        Dim oInfo() As ImageCodecInfo = ImageCodecInfo.GetImageEncoders
        Dim oEncoderParams As New EncoderParameters(2)
        Dim xOffset As Single = Math.Round((oBitmap.Height - oFont.Height) / 2, MidpointRounding.ToEven)
        Dim oPoint As New PointF(275.0F, xOffset + 10)

        oEncoderParams.Param(0) = New EncoderParameter(Encoder.Quality, 100L)
        oEncoderParams.Param(1) = New EncoderParameter(Encoder.ColorDepth,8L)

        oGraphic.TextRenderingHint = Drawing.Text.TextRenderingHint.AntiAlias
        oGraphic.DrawString(oText, oFont, frontColorBrush, oPoint)
        oBitmap.Save(context.Response.OutputStream, oInfo(4), oEncoderParams)
        context.Response.Output.Write(oBitmap)

        oFont.Dispose()
        oGraphic.Dispose()
        oBitmap.Dispose()  
        context.Response.Flush()
    Catch ex As Exception

    End Try
End Sub 
```

我从 jpeg 版本对此所做的唯一更改是：

*   `context.Response.ContentType = "image/jpeg"`变成`"image/png"`
*   将基础图像 ( `img/banner_green.jpg`, `img/banner_blue.jpg`) 更改为`.png`
*   添加了指定颜色深度的第二个编码参数
*   将`oInfo(1)`(jpeg) 更改为`oInfo(4)`(png)

我是否需要调整更多的东西才能让这个例程正确生成 PNG？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T15:17:59.663

根据[这篇文章](http://www.vbdotnetheaven.com/UploadFile/tcurry/PNGsUsingGDIplus04222005063702AM/PNGsUsingGDIplus.aspx)，Bitmap.Save 需要一个可搜索的流来保存为 PNG，而 HttpResponse.OutputStream 不是。您必须先将图像保存到 MemoryStream 中，然后将其内容复制到 Response.OutputStream，例如：

```
Dim tempStream as New MemoryStream
oBitmap.Save(tempStream, ImageFormat.Png, oEncoderParams)
Response.OutputStream.Write(tempStream.ToArray(), 0, tempStream.Length) 
```

另请注意，该行

```
context.Response.Output.Write(oBitmap) 
```

做一些与您可能期望的不同的事情。`HttpResponse.Output`是一个 TextWriter，您在此处使用的重载`TextWriter.Write(object)`只会在对象上调用 ToString 并将结果写入流中，在这种情况下会导致将“System.Drawing.Bitmap”写入输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:31:38.167

您在刷新响应之前处理位图？尝试翻转它。此外，看起来您正在将位图写入流两次。我不确定你为什么要这样做。将位图保存到输出流或使用 Response 对象的 Write 方法，但不能同时使用两者。

# mdx - MDX：过滤一个不存在的成员？

> ID：511589
> 
> 赞同：1
> 
> 时间：2009-02-04T14:30:06.407
> 
> 标签：mdx

我是 MDX 的新手，所以我认为这是一个新手问题。

**现有维度：**状态 **现有度量：**计数

**现有查询：**

```
SELECT 
  NON EMPTY [status].CHILDREN ON 0,
  NON EMPTY Measures.count ON 1
FROM [objects] 
```

我想计算 status='C' 的记录。但有时，没有符合该条件的记录。所以如果我这样做：

```
SELECT 
  NON EMPTY [status].[C] ON 0,
  NON EMPTY Measures.count ON 1
FROM [objects] 
```

我收到此错误：

```
*MDX object '[status].[C]' not found in cube 'objects'* 
```

在这种情况下，我想要一个返回 0 的查询。哪个是进行该查询的正确方法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T07:44:00.070

我从您的问题中假设您的数据源中实际上没有状态维度表。相反，您定义了一个使用 Fact 表中的列的维度。这很好用，但它不允许您为该维度定义一组固定的成员......您基本上被您所拥有的事实所困扰。

在我看来，解决方案是创建一个名为 DimStatus 的单独表，并使用事实可能使用的所有有效状态预先填充它，并让事实表引用状态维度表。

然后事情就会按照你想要的方式进行。您可以自动隐藏未使用的成员，也可以包括所有成员，或仅包含一组您想要的成员。

一个警告是，如果没有匹配的事实，它将显示 (null) 而不是 0。你可以用一个简单的 IIF(ISEMPTY()) 来解决这个问题：

```
WITH MEMBER
    [ZeroCount] AS
        IIF(ISEMPTY([Measures].[Count]), 0, [Measures].[Count])
SELECT [ZeroCount] ON COLUMNS,
[Status].Members on ROWS
FROM [MyCube] 
```

这将显示所有状态以及计数或零。不幸的是，它需要更改您的数据源和多维数据集，因此希望这是您的选择。

我玩了一些查询，但我认为不可能更容易地做到这一点。你不能创建一个包含无效成员的集合——这会创建无效的元组，并且没有任何东西可以正常工作。我也尝试了“hack”，但并没有按预期工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T04:17:31.230

大多数客户端应用程序所做的最好的想法是查询元数据以找出维度中存在哪些成员，然后仅对存在的成员发出查询。

以下文章列出了获取维度元数据[链接文本的各种方法](http://sqlblog.com/blogs/mosha/archive/2006/10/11/querying-dimensions-in-mdx.aspx)

另一个“黑客”可能是执行以下操作：

```
SELECT
  NON EMPTY StrToSet("[status].[C]") ON 0,
  NON EMPTY Measures.count ON 1
FROM [objects] 
```

但这仍然不会给你一个 0，而是会给你没有列的单元格集。这并不是我真正推荐的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-19T09:16:28.393

解决方案是使用动态集（CREATE DYNAMIC SET）。这些是根据用户权限进行评估的。

```
WITH DYNAMICS SET [MySet] {[status].[C]}    
SELECT
  NON EMPTY [MySet] ON 0,
  NON EMPTY Measures.count ON 1
FROM [objects] 
```

但是如上所述，这仅解决了过滤问题，您仍然会错过任何要显示的 o 轴 0 成员。

# asp.net - ASP.NET：制作类似于 Facebook 应用程序栏的东西

> ID：511606
> 
> 赞同：1
> 
> 时间：2009-02-04T14:36:13.663
> 
> 标签：asp.net, controls

是否有靠近 Facebook 底部应用程序栏的内置控件，或者只有通过使用 JavaScript/AJAX 才能获得这样的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T15:36:33.323

请记住，ASP.NET 是服务器端的，因此它控制在网页到达用户之前发生的所有处理。对于您所说的功能，您需要像 Javascript 这样的浏览器端巫术。所以...

1.  实际上需要Javascript。
2.  唯一可行的替代方案是 Flash。
3.  XML 不是必需的（甚至不一定是可取的）。

***不要*陷入将所有异步、Javascript 驱动的行为称为“AJAX”的陷阱，因为其中大部分不是。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-28T16:44:16.653

我刚刚在 ASP.NET 中构建了类似的东西。我最近发布了一篇关于如何做到这一点的博客。查看如何[在 ASP.NET 中构建 Facebook 应用程序栏](http://helpcentral.componentone.com/CS/blogs/webdev/archive/2010/01/26/popular-ui-volume-1-facebook-application-bar.aspx)。

我使用了 ComponentOne 中的两个控件来提供帮助，C1Menu 控件和 C1ToolTip 控件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T15:23:29.060

我想你的意思是：截图：[http](http://screencast.com/t/kqFPArcmYQ) ://screencast.com/t/kqFPArcmYQ 视频：[http ://screencast.com/t/X6IczIIv](http://screencast.com/t/X6IczIIv)

如果是这样的话，不，它不能单独使用 ASP.NET 来完成。您假设它需要 javascript，并且可能需要一些 AJAX 来进行这些异步调用是正确的。

您应该查看 javascript 库，例如 jQuery 和 jQuery UI，或 MooTools 等。它们为您提供了广泛的工具和插件来创建精彩/动态的 UI。

[http://jquery.com/（jQuery](http://jquery.com/) [UI](http://ui.jquery.com/demos/)演示 ）

[http://mootools.net/（MooTools](http://mootools.net/)[演示](http://demos.mootools.net/)） _

查看他们页面上的演示，看看是否符合您的想法。您绝对可以在 ASP.Net 中构建菜单的核心，然后使用 javascript 库来获得您正在寻找的动态感觉。

希望能有所帮助。

# web - 从网站捕获多媒体密钥？

> ID：511607
> 
> 赞同：5
> 
> 时间：2009-02-04T14:36:16.050
> 
> 标签：web, key, multimedia

有没有办法从网站捕获多媒体密钥？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:55:48.803

试试这个 jquery 插件（它支持所有的键）

[http://jshotkeys.googlepages.com/test-static-01.html](http://jshotkeys.googlepages.com/test-static-01.html)

如果可以找到它们，那么您会很幸运，但是我认为这行不通。

# programming-languages - 在工作中使用“边缘”语言的道德规范？

> ID：511612
> 
> 赞同：28
> 
> 时间：2009-02-04T14:36:56.330
> 
> 标签：programming-languages

只是想在这里征求一些意见。您如何看待使用一种在您所在地区并未广泛使用的语言（和/或框架）来为公司编写软件？例如，我住在一个以 .NET 为主的地区，偶尔会做一些 PHP 工作。假设我正在学习 Python，并决定用它来为我的工作编写软件（我是“一个团队”，所以我几乎可以使用任何我想要的东西）。

现在他们的软件是用该地区几乎没有人使用或知道的语言编写的。如果我要离开公司，除非他们聘请我担任顾问，否则他们基本上没有人可以维护/添加它。虽然这对我来说真的很好，但它似乎有点“歪曲”——当然，这就是商业世界的运作方式。

你怎么认为？

我应该提一下，这是一家很小的公司，我是唯一的 IT 人员，所以我完全可以选择我们的开发平台。我没有专门使用 Python，而是选择它作为示例，因为我的区域几乎完全基于 .NET；不过，我不再关心 .NET，这就是我不想考虑使用它的原因。此外，该公司.. 怎么说呢...*非常节俭*，不会购买 .NET 所需的资源（例如服务器许可证、SQL 许可证、Visual Studio、组件）。我个人有一个 MSDN 订阅，但我不能为他们使用它。

FWIW 还有**人**在该地区使用我正在考虑使用的语言（Ruby on Rails），但远没有 .NET 开发人员那么多。这不像我在使用只有我知道的东西。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-04T14:49:54.603

您可能认为这种方法对您有好处。但事实上，这一切只是把你画到一个角落里。在组织内获得晋升的最佳方式是让自己在当前职位上变得不必要。这似乎是无稽之谈，但实际上是真的。可以这样想，如果你继续维护你为他们写的python代码对公司来说是必不可少的，而且他们不能去找其他人来获得那个技能，那么他们会继续支付（也许有点高于市场价格）以维护该代码。

但是，如果您在 .net 中编写该代码，而您所在地区有大量供应，那么随着公司的扩张并且您编写的代码被证明是成功的，您将能够雇用人员来维护该代码并且您可以移动继续设计其他系统。或者转而管理一个 .net 编码员团队——如果你愿意的话。

即使你想离开，对你的职业生涯来说最好的事情就是获得最好的参考。为此，请为他们编写一些易于维护的代码。帮助他们雇人代替你来维护它。他们将不胜感激，并将您作为顾问推荐给他们的朋友。

编写一些深奥的代码——在你所在的地区几乎没有支持——他们会在高尔夫球场上对他们的朋友说“不，不要雇用那个人，他为我们编写了这个系统来完成这项工作，但没有人其他人可以维持。我们永远和他在一起，现在他太忙了，不能好好照顾我们！”

做对业务最有利的事情，而不是您可能最感兴趣的事情——或者表面上看起来是这样。从长远来看，你会赢。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-04T14:39:39.070

我认为你有责任决定最适合这份工作的语言。这包括对语言和框架优点的客观评估，它包括你自己对语言的个人技能（因为你是做这项工作的人），它包括其他人的可维护性。只有您和您的公司才能决定对每一项的重视程度。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-04T14:42:33.713

对于您自己的个人发展，如果您的领域以 .net 为主，您为什么不想跟上它而不是 Python 呢？

从道德的角度来看，我不会写一些别人不容易维护的东西。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-04T14:41:41.453

我认为使用 python 将是正确的做法，如果它能够满足客户的要求，并为他们节省金钱而不是替代方案。未来是否有各种各样的角色可以在应用程序上工作是无关紧要的，除非他们已将其指定为非功能性需求。

像往常一样，为手头的工作使用最好的工具将为您提供很好的服务。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-04T22:06:45.300

很多回答似乎都不适合这个问题。我们不是在谈论在具有现有标准的环境中使用未经批准的语言。我们谈论的情况是，海报是他公司的整个 IT 和开发部门。

牢记人才的可用性当然很重要，但如今 Ruby 几乎不是边缘语言。在只有一个开发人员的环境中，生产力也是一个非常重要的考虑因素。能够在没有大型团队的情况下快速轻松地构建和维护软件需要具有不同于大型团队可能需要的特性的工具。

我认为比使用 Ruby 还是（其他）更重要的是尝试选择尽可能通用的东西并将其用于所有事情，除非有*非常*好的理由使用其他东西。如果您使用 Ruby，请在实用程序脚本、cron 作业和那个小 GUI 应用程序中坚持使用 Ruby，当实习生花超过 5 分钟给他端咖啡时，老板想自动给他发短信。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-04T14:40:57.680

如果您仅将其用于此目的，那确实有点歪。

但是，如果您因为它是最好的解决方案而使用它，那么您就清楚了。

此外，他们可以雇佣其他了解 Python 的人。

我的职业道德不允许我做这样的事情只是为了让我继续做生意。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-04T14:41:26.900

我个人的意见是，你应该尽可能地尊重任何地方的工作实践——无论是缩进风格、命名约定、测试过程还是编程语言。

如果您强烈认为另一种语言更适合某项任务，请游说接受它（需要对其他人进行重新培训）。

IMO，故意留下一个其他人无法维护的应用程序是非常糟糕的职业行为。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-04T14:41:17.930

我们最近在我的商店招聘了一个糟糕的员工，他突然决定使用 Perl 而不是任何版本的 .NET 来完成一些简单的报告工作（这在 .NET 中也可以轻松完成）。这太残酷了。我会建议使用指定的平台，并与运行联合的人清除任何偏差......

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-04T15:32:27.357

很多答案都涉及到这一点，但这是我基于生产应用程序支持的看法。

我的公司有一个启动阶段，代码骗子会根据个人喜好或本周的风格提出解决方案。不利于可维护性和可支持性。

不过，只要保持一致，进行更改是可以的。如果 Python 要为未来铺平道路，那就去吧。不要忘记遗留的 .NET 和 PHP 代码在生命周期结束之前仍然需要得到支持。当你不在时，为自己构建一个平台和框架的大杂烩只会给你的工作和公司带来更多的困难。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-04T17:04:21.243

如果你觉得你的行为不诚实，那么你可能是。

没有人喜欢不诚实的人。这对你的名声不好。

尽你最大的努力根据实际最好的东西来选择，而不是满足一些卑鄙的动机。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-04T14:42:12.980

我做到了，在我的情况下是德尔福。我认为 Delphi 经常被使用，但是当我在找工作时....我一生中看到了 3 个 delphi 工作机会。我还看到了更多我记得的 java/j2ee/php 报价。我认为这是个坏主意，因为我浪费在学习高级 delphi 编程上的时间，我可以通过 j2ee 变得更好，并从更好的公司开始，也许现在可以赚更多的钱。

如果他们找不到人来维护应用程序，您将始终这样做，当您退出时，他们将不得不重新编写它。我认为顾问的东西不经常使用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-04T14:42:28.817

这取决于。我做了一些通常只是 bash 脚本的事情，用 Java 代替了一个地方。为什么？因为他们都是 Java 程序员，并且经常有实习生/合作伙伴通过，他们可能知道也可能不知道其他任何事情（并且可能对 Java 有那么好，也可能不那么好）。

不过，其他地方往往有更有经验的程序员，我希望他们能够不费力气地找出另一种语言。所以，我会选择最适合这个项目的东西。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-04T14:42:44.947

我同意 mquander 上面所说的，但您可能还必须准备好向您的开发经理证明为什么要使用这种其他语言。如果他/她随后同意，那么该语言可能会在公司内得到更广泛的采用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-04T14:43:40.343

考虑一下您现在和中期为公司带来的商业利益。

如果您可以使用不同的技术更快地交付一些东西，并且它仍然可以实现目标，我会去做 - 但我仍然会让其他人知道并尊重公司的最终决定。但是，如果这纯粹是为了自己，那么我可能会更加小心。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-04T14:44:03.867

我认为这是一个非常糟糕的主意。对您来说，这意味着如果您想休息一天（或一周），就没有备份。对他们来说，如果你离开或休假一天，就没有其他人了。这是一个众所周知的策略，老实说，这可能是不让你留在身边的理由。

然而，这也可能是一个将 Python 引入环境的机会。你可以教给其他人，并向管理层解释，同时它是一种很好的第三语言，可供团队使用。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-04T14:51:00.653

我曾经认为您应该始终为工作选择正确的语言。虽然我正在扭转我的观点。

当其他人选择您不想学习的语言时，问题就出现了。我担心我可能会选择别人不想学的语言。仅仅因为我认为 Erlang 可能是某事的正确选择并不意味着其他人都会想要学习 Erlang 或尊重我使用 Erlang 的决定。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-04T14:57:53.340

“如果我离开公司，他们基本上没有人可以维护/添加它，除非他们保留我作为顾问。”

你是说没有其他人可以学习 Python 吗？我觉得很难相信。

新技术通常由知识渊博的人在小项目中引入，并在组织中传播，因为小项目是成功的。

使用 Python。成功的。根据您的成功提出您的案例。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-04T15:13:13.513

我经常遇到同样的问题。巧合的是，你提到的这两种语言是：当我更喜欢使用 Python（以及其他语言）时，.NET 强加于我。可能是相反的，我不判断。

由于其他答案中已经提到的原因，我没有使用 Python。我做了我认为对公司最有利的事情。对于没有经验的 Python 程序员来说，使用 IronPython 不会使您的 Python 代码更易于维护。

然而，我离开了公司，现在我的工作更符合我的口味。我开心多了。在这个经济体中，你可能没有这个选择……但它会过去的。做正确的事。

干杯。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-04T15:38:27.843

“原型”或“一次性”代码与生产代码之间存在很大差异。对于原型设计，我使用最快的方法，但我很清楚它的状态。生产代码是在批准和支持的环境之一中编写的。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-04T15:44:20.767

道德是使用最好的工具来完成工作。如果有一个工具只花费你 20% 的时间来编写代码而不是其他选择，并且几乎不需要维护，并且易于重构，那么你有责任选择该工具，假设它可以根据你的需要进行扩展这生意。

如果您做得好，那么雇用未来的人并就您的工作场所*如何*开展业务进行培训应该是任何成长型企业的做法。如果他们是业务的合适人选，他们将能够学习代码。

在您的情况下，我不确定您是否要使用 Python，除非它具有本机 .NET 支持以允许您的 .NET 世界与之交互。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-04T16:15:08.817

其他海报提出了一些好的观点，但这是我没见过的：将情况传达给管理层并让他们决定。换句话说，和你的老板谈谈，告诉他/她你所在的地区目前有更多的.NET 开发人员，这样如果你明天被公共汽车撞到，就更容易找到其他人来维护你的代码；但是，您需要一些工具来更有效地完成工作，并且它们需要花钱（并告诉他们多少钱）。或者，您可以在 Python 或 RoR（或其他）中执行此操作并使用免费工具，但据您所知，目前该领域没有那么多人知道这些语言。我在这里使用了几次“当前”，因为这可能会随着时间的推移而改变。

在进行此对话之前，最好看看您是否可以找到您所在地区的替代技术的用户组，以及他们有多大。您也可以在列表服务器上询问是否有人知道您所在地区的替代方案。

当然，老板可能会告诉你在没有任何工具的情况下继续使用 .NET，但在这种情况下，他们决定自取其辱。（你决定是否要找一份新工作。）

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-05T00:50:44.250

关于所提出的问题，我认为没有任何不道德的地方，前提是：

1.  它是一种免费可用的语言。虽然我有点像 FOSS 党派，但这不是这个标准的重点。它需要是免费提供的（不一定是 FOSS），这样它才不会给公司带来成本，并且如果你需要被替换（或者如果他们想与你竞争），其他人将有机会学习它为你的工作）。
2.  您出于充分的理由更改语言，而不是为了创建供应商锁定（或者，如果您更愿意将其视为“工作保障”）。撇开道德不谈，你真的不想有一份他们讨厌你的工作，而是被你困住，因为你是唯一一个能够维持你所造成的混乱的人。

在您描述的特定情况下，我建议切换到 RoR 可能是更合乎道德的选择，因为如果需要仅付费的所需资源，则使用 .NET 绝对是不道德的（更不用说非法了）而且您的雇主太~~便宜~~了，无法为他们购买适当的许可证。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-05T01:16:46.227

在罗马时...像罗马人一样行事。

您可能不是长期维护此代码的人，也不是每个人都想学习一种“边缘语言”来进行错误修复或增强。

我将一些 VBA 的东西迁移到 Perl 以在之前的工作中进行处理，并将效率提高了几个数量级，但最终没有其他人愿意学习 Perl，所以我被困在这个任务上的时间比我想要的要长。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-02-04T14:55:57.243

我曾经在“为工作使用最好的工具”学校，但我改变了主意。*仅仅问“我*怎样才能最快地完成这项工作”是不够的。如果您认为您是唯一需要查看某些代码的人，那么您很可能错了。将一种新语言引入环境的总成本比您最初想象的要高。

如果你只需要产生一个结果，而不是一个程序，那么你可以使用任何你想要的东西。假设您需要一份报告，或者您需要处理一些文件。如果输出真的很重要，比如说你可以选择手工完成，你可以练习使用任何你想要的语言。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-02-04T14:56:08.943

随着 MVC 框架的发布，我也陷入了类似的道德困境。使用 WebForms 或切换到 MVC 框架来处理一切。答案真的是你必须做正确的事并使用公司的任何标准。如果你偏离标准，它会给人们带来很多问题。

想一想，当你多年来一直在做的都是 .Net 时，如果你在 VB6 上放弃了一个项目，你会有什么感受。所以这是我想出的两个解决方案。

1.  使用你有趣的语言来咨询你在旁边做的合同。确保客户知道你在做什么，如果他们同意就去做。
2.  尝试说服您当前的公司迁移到您正在使用的这种出色的新语言。

如果您遵循这些路线，您将学习您的语言，并且不会在此过程中惹恼任何人。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-02-04T15:07:32.027

我不会把新的语言/框架/任何东西带到这个地方，除非他们明白这就是我正在做的事情，如果我离开/被解雇/被公共汽车撞到，他们必须找到/培训某人一起工作它。

我有一些承包商拉东西的经验，只是因为他喜欢。在某些情况下，它们是完成这项工作的最佳工具（在其他情况下则不是），但在所有情况下，它们都不是必须维护代码的团队的最佳工具。在我的情况下，承包商是一个严重的混蛋，他并没有真正在乎其他任何人，我相信是试图让自己更难被取代。

在你的情况下，和你的老板谈谈。如果他们真的不想在 .NET 框架工具/库上花费所需的钱，那么从长远来看，切换到其他东西对他们来说可能是正确的做法。

而且，作为一个在职业生涯中进入其他人已经开始的中间项目的人 - 感谢您在添加新工具之前的思考。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-02-04T15:28:34.730

Ruby on Rails 肯定不是*边缘*语言。如果该公司太便宜而无法为 Microsoft 工具的适当许可支付费用，那么您将别无选择，只能寻找替代方案。RoR 肯定是一个合理的选择，如果也有助于推动您的职业发展，那么这对你们双方都是双赢的！

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-02-04T22:51:30.247

您可以使用免费工具充分开发 .NET；成本不是避免该平台的好理由。Ruby on Rails 正在成为构建数据驱动互联网网站的主流。你甚至没有告诉我们这是否是你正在构建的那种软件。

根据您提供的信息，任何人都无法给您一个正确的答案。

如果您问以公司依赖您的方式开展工作是否合乎道德，答案当然是否定的。如果您要问在 RoR 中开发是否合乎道德，那么答案是“我们不知道”——但我的观点是，如果它是适合这项工作的工具，可能会很好。

不要低估其他人支持您的工作或取代您的能力 - 如果您在解决方案到位后合理地完成工作，那么任何值得他们付出的程序员都应该能够很好地学习平台以维护它。例如，我调试、迁移和支持了一些 PHP 应用程序，但几乎没有学习过关于 PHP 的第一件事。我会迷失从头开始构建一个新的 PHP 应用程序，甚至永远不会尝试，但支持一个没有问题。我认为您提到的语言也是如此-它们具有临界质量，这意味着有很多书籍和论坛等。当然，如果用任何语言写得都不够好，那么可能很难支持无论任何人的语言技能...

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-02-05T00:23:20.267

对于如此明确的情况进行了如此多的讨论......

这不取决于你，取决于他们。如果他们没有足够的技术来打电话，看起来，那么你必须*真诚*地为他们打电话。任何事情都是不诚实的，我很确定这不在你的工作描述中；）

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-02-05T01:09:24.730

你在个人动机的丛林中四处游荡，把水搅浑了。对此的答案是，除非并且直到您为可能的决策制定了商业案例，否则您的个人动机是无关紧要的。如果您已经这样做了，但答案仍然不明确，那么可以肯定，选择您最喜欢的答案是能够首先做出技术决策的好处之一。

就实际问题而言，在我看来，如果技术上最合适的选择也是很少有人使用的选择，那么会发生以下两件事之一：a）这是一个不错的选择，使用它的人数是将在接下来的 18-24 个月内爆发（例如 Django），或者 b）我的分析有问题。技术可能处于边缘，因为人们采用它们的速度很慢，但这通常不是他们停留在边缘的原因。

如果你发现自己在想“我不能选择技术 X，那会让他们更容易取代我！” 你做错了工作。在几乎所有实际上并没有失败的企业中，让自己容易被替换的 IT 人员往往会转向更难、更有趣和更有利可图的工作。

# c# - 泛型类型不相等

> ID：511620
> 
> 赞同：3
> 
> 时间：2009-02-04T14:38:52.410
> 
> 标签：c#, .net, generics

下面的代码段打印出“类型不一样。”。为什么？我知道使用`interfaceOnMyType.GetGenericTypeDefinition()`将解决问题的事实，但我为什么要这样做呢？

```
class Program
{
    static void Main(string[] args)
    {
        var myType = typeof(Baz<>);
        var interfaceOnMyType = myType.GetInterfaces().SingleOrDefault();
        var exactType = typeof(IBar<>);
        if (exactType == interfaceOnMyType)
        {
            Console.WriteLine("The types ARE the same.");
        }
        else
        {
            Console.WriteLine("The types ARE NOT the same.");
        }
        Console.ReadLine();
    }
}

interface IBar<T>
{
}

class Baz<T> : IBar<T>
{
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T14:41:23.497

```
interfaceOnMyType.GetGenericTypeDefinition() 
```

返回与返回的类型不同的接口的封闭构造类型

```
typeof(IBar<>) 
```

[这是 MSDN 上的文章`GetGenericTypeDefinition`](http://msdn.microsoft.com/en-us/library/system.type.getgenerictypedefinition.aspx)，这里有一段很好的引述，解释了它是如何工作的：

> 给定一个`Type`表示此构造类型的对象，该`GetGenericTypeDefinition`方法返回泛型类型定义。

* * *

编辑（上面的答案在某些情况下是正确的，但在这个情况下是错误的）：

我想我现在可能已经找到了。类型比较失败的原因是因为`Type`返回的 from`myType.GetInterfaces()`与接口本身的类型接近但不相同。

根据[MSDN](http://msdn.microsoft.com/en-us/library/system.type.fullname.aspx)：

> 如果使用该`BaseType`属性获取 的基类型`Derived`，`FullName`则生成的 Type 对象的属性将返回`null`（在 Visual Basic 中为 Nothing）。要获取非 null `FullName`，您可以使用该`GetGenericTypeDefinition`方法获取泛型类型定义。

所以我认为这是你看到的问题。由于通过该调用检索到的任何类型来检索基本接口`GetInterfaces`，因此不会有`FullName`( [source](http://msdn.microsoft.com/en-us/library/system.type.basetype.aspx) )。由于它没有 a `FullName`，因此类型将在比较中失败。

如果您正在比较您不是的构造类型，那么我最初写的内容将是正确的。所以不幸的是，我的第一个答案是完全错误的——我把它留下了，这样留下的评论才有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T15:02:30.337

原因是`interfaceOnMyType.IsGenericTypeDefinition`返回假，而`myType.IsGenericTypeDefinition`两者`exactType.IsGenericTypeDefinition`都返回真。也就是说，仅仅因为您从泛型类型定义中检索非构造泛型类型并不意味着您检索的类型本身就是泛型类型定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T03:05:19.533

尝试以下

```
 Console.WriteLine("{0}", (null != exactType.FullName) ? exactType.FullName : "null");
            Console.WriteLine("{0}", (null != interfaceOnMyType.FullName) ? interfaceOnMyType.FullName : "null"); 
```

输出是：

test.Program+IBar`1
null

这支持了 Andrew Hare 在此处发布的调查结果。

# javascript - 当你通过我的身份证时如何获得身份证

> ID：511630
> 
> 赞同：0
> 
> 时间：2009-02-04T14:41:23.590
> 
> 标签：javascript, jquery

我有一个函数可以传递文档对象，例如：

```
toggle( $('username') );

function Toggle(id)
{
  ///  ??

} 
```

如何获取传递的对象的实际名称，即用户名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T14:44:56.143

如果我理解正确，你不能：

```
$(id).attr("id"); 
```

或者

```
$(id).attr("name"); 
```

还是我弄错了？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T14:46:19.777

无论是[乔纳森所说](https://stackoverflow.com/questions/511630/how-to-get-id-when-you-pass-my-id/511656#511656)的还是与

```
$(id).val(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T14:50:50.857

传入的对象是 jQuery 对象的一个​​实例，它包含一组元素（在本例中只有一个元素）。该文档位于[jQuery 文档站点上](http://docs.jquery.com/Core)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T15:06:04.463

返回的 jQuery 对象`$()`，包含一个*或多个*DOM 元素。
使用访问器`$().attr()`、`$().val()`和`$().text()`将`$().html()`作用于这些包装元素中的第一个。
如果您想退出 jQuery 模式以便可以使用原生 DOM 元素（有时很有用），请使用`$().get( index )`.

例如

```
var el = $('#mytextbox').get(0);
el.value = 'a new value';
alert(el.id);
etc... 
```

# c++ - Visual Studio 中用于 C++ 的免费 IntelliSense

> ID：511659
> 
> 赞同：2
> 
> 时间：2009-02-04T14:45:24.457
> 
> 标签：c++, visual-studio, ide, intellisense

这里有人知道任何可用于 C++ 的免费 IntelliSense 工具，它至少具有[Visual Assist X](http://www.wholetomato.com/)的 50% 的功能（当然不是免费的）？基本上我希望我的智能感知在不加载完整工作区/解决方案的情况下工作？我看过 Visual Assist，它提供了这个功能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T14:54:43.190

支持这些人，因为他们花了相当多的时间编写这个出色的工具并购买它。

对于免费的替代品，您可以查看[CTags](http://ctags.sourceforge.net/)和[VS 的插件](http://www.codeproject.com/KB/macros/dstags.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T23:05:19.077

将此粘贴到 Visual Studio 宏中的 EnvironmentEvents 模块中：

```
Dim curWord As String
Private Sub TextDocumentKeyPressEvents_AfterKeyPress(ByVal Keypress As String, ByVal Selection As EnvDTE.TextSelection, ByVal InStatementCompletion As Boolean) Handles TextDocumentKeyPressEvents.AfterKeyPress

    If (InStr("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_", Keypress)) Then

        curWord = curWord + Keypress

        If (curWord.Length > 2) Then
            'AutoCompleteFromFile()
            curWord = ""
            DTE.ExecuteCommand("Edit.CompleteWord")
        End If
    Else
        curWord = ""
    End If

End Sub 
```

# database - 在 Visual Studio 中定义多个外键

> ID：511661
> 
> 赞同：1
> 
> 时间：2009-02-04T14:46:12.023
> 
> 标签：database, visual-studio

我有一个基本的数据库模式如下（简化了，所以很容易阅读）：

```
[Staff]
StaffId (pk)
FirstName
LastName

[RosterEvent]
EventId (pk)
StartDate
EndDate

[StaffEvents]
StaffId (pk)
EventId (pk) 
```

好的，很多员工可以有很多 RosterEvents，这就是我添加 StaffEvents 表的原因。它解决了多对多的关系。但是我不知道如何定义外键。

在 Visual Studio 中，如何使用表设计器将这些定义为外键？如果我尝试使用外键关系对话框添加关系，我会收到错误消息“表 'StaffEvents' 中的列与现有主键或唯一约束不匹配”。即使 UNIQUE 约束已应用于每个表上的所有主键。

非常感谢您的帮助！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T00:35:44.937

每个表上的所有主键都标记为 PK 和 UNIQUE。它们也都是 int 类型。

这就是我目前试图建立这种关系的方式。

1.  从员工表中，我单击“关系”工具栏按钮。
2.  我点击“添加”
3.  我单击“表和列规范”属性中的 (...)。
4.  我选择“StaffEvents”作为主键表。
5.  我从下拉框中选择“StaffId”。

当我单击确定时，我收到错误消息“表 'StaffEvents' 中的列与现有主键或唯一约束不匹配”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T14:49:56.273

在表格设计器中，您可以单击所需两列侧面的行标题，然后单击工具栏上的主键图标。

您的 PK 是否实际上标记为主键或只是 UNIQUE？它们是相同的数据类型吗？

# reporting-services - HTML 渲染中的单页显示：SSRS

> ID：511666
> 
> 赞同：12
> 
> 时间：2009-02-04T14:48:24.310
> 
> 标签：reporting-services

我有一份 SSRS 报告。我正在使用分组，我的报告有 n 页。是否可以在没有分页符的单个页面中显示报告的 html 并且导出的版本（pdf、excel）有分页符）。任何想法。请分享一些想法。

提前感谢安娜

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-04T18:57:03.293

简短回答：设置**InteractiveHeight = 0**

[根据微软](http://msdn.microsoft.com/en-us/library/ms251701.aspx)：

> 软分页符由控件在运行时计算。尽管不建议这样做，但您可以通过将 **InteractiveHeight**设置为 0 来禁用软分页符。
> 
> **HTML 呈现扩展使用InteractiveHeight**和**InteractiveWidth** 来提供等效的 **PageHeight**和**PageWidth**。由于 HTML 输出格式会动态调整报表的大小以适应向下钻取、钻取和​​显示/隐藏功能，因此报表服务器使用不同的属性来支持动态页面上的分页。

**编辑评论答案：**
在布局模式下，打开**属性面板**。在属性面板的顶部是一个下拉菜单，用于选择您正在查看的控件属性，选择**报告**您将找到包含交互式高度属性的“交互式大小”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T14:54:10.353

什么版本的 SSRS？2008 允许您为交互式和常规纸张指定不同的页面大小（即 html 版本将呈现不同于 PDF 版本）。

# c# - 使用数据设置 GridView 的属性

> ID：511667
> 
> 赞同：0
> 
> 时间：2009-02-04T14:48:26.073
> 
> 标签：c#, webforms

我需要将 GridView 中 BoundField 的“ReadOnly”属性设置为记录集中由同一 GridView 显示的位字段的值。

我知道我可以在代码中实现这一点，但出于兴趣，我想知道是否可以使用 <% %> 片段在属性内以声明方式执行此操作？

干杯，

杰米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T15:01:42.787

是的，你可以这样做。创建一个 TemplatedField 并在绑定语句中使用

```
<%# ((Employee)Container.DataItem).IsApproved ? "yes" : "no" %> 
```

或者您可以使用代码隐藏中的方法

```
<%# FormatBool(((Employee)Container.DataItem).IsApproved) %> 
```

其中 FormatBool 是代码隐藏中的一个属性

```
protected string FormatBool(bool value)
{
   if (value)
      return "yes";
   return "no";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T14:59:01.467

如果您需要绑定到属性，我会使用 TemplateField，然后在那里设置行为。仅当您不能使用代码时才这样做，否则，这是您最好的选择。

我认为没有办法直接绑定 BoundColumn 的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T12:01:02.540

我无法找到一种方法来根据 DetailView 的数据以声明方式操作 BoundField 或 TemplateField 的属性。

Bendewey 非常仁慈地假设我正在绑定到一个业务对象，而实际上我是在这个实例中直接处理数据 - 很抱歉没有说清楚。

我在后面的代码中的解决方案如下：

```
 protected void DetailsView1_DataBound(object sender, EventArgs e)
    {
        DetailsView dv = (DetailsView)sender;

        if (dv.DataItemCount > 0)
        {
            DataRowView data = (DataRowView)dv.DataItem;
            bool isFixed = (bool)data["IsFixed"];

            if (isFixed)
            {
                dv.Rows[2].Enabled = false;
                dv.Rows[6].Enabled = false;
            }
        }
    } 
```

我很失望，我不得不引用我想按索引禁用的行。可能有一种方法可以通过它们的数据字段引用这些行，而无需遍历所有行，但乍一看我找不到。

谢谢您的帮助！

# sql - 访问将行连接成单行：需要额外的条件

> ID：511669
> 
> 赞同：2
> 
> 时间：2009-02-04T14:49:15.387
> 
> 标签：sql, ms-access, stored-procedures, ms-office

我正在使用 Access 数据库，我需要将不同的相关行连接成 1 行。我在[这里](https://stackoverflow.com/questions/230241/does-ms-access2003-have-anything-comparable-to-stored-procedure-i-want-to-run)找到了一个解决方案，并取得了巨大的成功。但是我需要为其添加额外的条件，只有在某些其他列也相等时才应该这样做。例如：

1 X 阿尔法

2 年测试版

1 X 伽玛

1 Z 三角洲

应该成为

1 X 阿尔法，伽玛

1 Z 三角洲

2 年测试版

有谁知道这样做，特别是对于像我这样的新手？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T15:32:54.113

看来您正在使用[MS access(2003) 中提供的代码是否具有与存储过程相当的内容。我想在 MS access 中运行一个复杂的查询](https://stackoverflow.com/questions/230241/does-ms-access2003-have-anything-comparable-to-stored-procedure-i-want-to-run)。

没有理由不应该在 sql 中输入两个字段作为一个字段，所以举个例子：

```
SELECT Number & Letter,
Concatenate("SELECT Letter & Alpha As FirstField FROM tblTable
     WHERE Number & Letter =""" & [Number] & [Letter] & """") as FirstFields
FROM tblT 
```

# user-interface - 相对百分比 UI 控件

> ID：511680
> 
> 赞同：0
> 
> 时间：2009-02-04T14:52:08.017
> 
> 标签：user-interface, custom-controls

我需要用户设置一些百分比值，这些百分比值应该总是加起来 100%。归档这个的标准方法是什么？我想出了以下内容：

1）为您需要设置的每个值都有一个标准滑块控件。移动一个滑块将自动调整所有其他滑块，因此总和始终为 100%。您可以使用旁边显示的复选框来修复单个滑块。只有剩余的“免费”滑块可以调整。

Pro：完全由用户已经知道的标准小部件组成

缺点：很多小部件，大量使用的屏幕空间，当你有很多滑块时看起来很丑，因此百分比值很低，标准化到 100% 并不是很明显。

2) 有一个带有多个滑动旋钮的滑块控件。

优点：归一化隐含明显，因为滑块的长度是固定的，相对权重一目了然

缺点：非标准，旋钮很容易相互重叠，旋钮不容易固定，没有明显的地方可以为每个间隔/百分比放置文本/数字表示

3) 显示标准饼图。

优点：归一化是隐含明显的，相对权重很容易看出

缺点：非标准的交互式使用，难以进行直观的切片大小调整工作，没有地方为每个切片放置文本/数字表示

4) ... ?

我对其中任何一个都不满意，因此我在这里提出问题。有更好的想法吗？我在富 Windows 客户端（即不是 Web）上处理 3-10 个单独的百分比值。

干杯，

```
Sören 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T14:56:13.123

垂直滑块呢？就像一个混音器。我认为它看起来比 10 个水平滑块的列表要好得多。

Or fixed width bar with several sliders on them, a bit like the gradient control of Photoshop if you know it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-25T14:04:07.903

Similar to the timeline idea, how about a slider like the partitioning interface in GParted or similar disk partitioning tools?

You could display the percentage values and actual numbers above the dynamically resizing bars to allow the user to edit them numerically instead of using the sliders if they want to configure it manually.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T14:56:20.613

How about a time line view; (gantt chart) kind of like in Microsoft Expression Blend or in flash where you have multiple layers for each action and each action can be within a range on the scale from 0 to 100.

# c# - MouseUp 事件中断？

> ID：511682
> 
> 赞同：0
> 
> 时间：2009-02-04T14:52:36.080
> 
> 标签：c#, visual-studio-2008, mouseevent

我正在使用面板制作自定义控件。我希望能够拖放它，所以我在我的控件的 MouseDown 事件中实现了它。但是我希望当你开始拖动时它会做出反应，给用户一些反馈。所以在 MouseDown 中，我什至改变了颜色。然后我想在 MouseUp 事件中把它改回来。

我的控件没有安装到 VS2008 中，而只是我编写的一个类，我在运行时实例化（我事先不知道我需要多少等等）。现在，我的控件公开了一个 MouseDown 事件以便能够被拖动。当我从父应用程序订阅此事件以实际执行拖放时，我的控件不会在其 MouseUp 事件上重新绘制！事实上，MouseUp 从未被调用过。另一方面，如果我没有订阅父应用程序中的事件，它会按预期工作。

这是怎么回事？父级是否中断了流程，以便在我的控制中永远不会触发 MouseUp 事件？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T15:15:36.000

我不确定您使用的是 Windows 窗体还是 WPF，但在 Windows 窗体中，我的意思是：

```
公共类 DerivedPanel : 面板
{
    受保护的覆盖无效 OnMouseDown(MouseEventArgs e)
    {
        base.OnMouseDown(e);
        捕获=真；
    }

    受保护的覆盖无效 OnMouseUp(MouseEventArgs e)
    {
        base.OnMouseUp(e);
        捕获=假；
        //在这里改变你的颜色或任何东西
    }
}

```

在 WPF 中有两种方法，CaptureMouse() 和 ReleaseMouseCapture() 来做同样的事情。当控件捕获鼠标时，即使光标不在控件上，它也会收到鼠标事件。这可能会导致您的问题。请参阅[MSDN 文章](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.capture.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T20:36:54.000

您是否在 mousedown 事件的自定义控件中捕获鼠标？尝试在 mousedown 上捕获并在 mouseup 上释放捕获。

# linux - bash：获取以给定字符串开头的命令列表

> ID：511683
> 
> 赞同：20
> 
> 时间：2009-02-04T14:53:04.893
> 
> 标签：linux, bash, scripting

是否可以使用 Bash 获取以某个字符串开头的命令列表？
我想在键入命令的开头后两次点击 <tab> 来获取打印的内容，例如，将其存储在变量中。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-04T15:19:04.577

您应该能够使用*compgen*命令，如下所示：

```
compgen -A builtin [YOUR STRING HERE] 
```

例如，“compgen -A builtin l”返回

```
let 
local 
logout 
```

您可以使用其他关键字代替“builtin”来获得其他类型的补全。Builtin 为您提供 shell 内置命令。“文件”为您提供本地文件名等。

这是一个操作列表（来自使用*compgen的**完整*BASH 手册页）：

 *```
 alias      Alias names.  May also be specified as -a.
  arrayvar   Array variable names.
  binding    Readline key binding names.
  builtin    Names  of  shell builtin commands.  May also be specified as -b.
  command    Command names.  May also be specified as -c.
  directory  Directory names.  May also be specified as  -d.
  disabled   Names of disabled shell builtins.
  enabled    Names of enabled shell builtins.
  export     Names of exported shell variables.  May also be specified as -e.
  file       File names.  May also be specified as -f.
  function   Names of shell functions.
  group      Group names.  May also be specified as -g.
  helptopic  Help topics as accepted by the help builtin.
  hostname   Hostnames, as taken from the file specified by the HOSTFILE shell
                 variable.
  job        Job  names, if job control is active.  May also be specified as
                 -j.
  keyword    Shell reserved words.  May also be specified as -k.
  running    Names  of  running  jobs,  if  job  control  is active.
  service    Service names.  May also be specified as -s.
  setopt     Valid arguments for the -o option  to  the  set builtin.
  shopt      Shell  option  names  as  accepted by the shopt builtin.
  signal     Signal names.
  stopped    Names  of  stopped  jobs,  if  job  control  is active.
  user       User names.  May also be specified as -u.
  variable   Names  of  all  shell  variables.   May also be specified as -v. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T22:48:23.747

一个有趣的方法是点击`M-*`（Meta 通常是左 Alt）。

例如，键入以下内容：

```
$ lo 
```

然后点击`M-*`：

```
$ loadkeys loadunimap local locale localedef locale-gen locate
  lockfile-create lockfile-remove lockfile-touch logd logger login
  logname logout logprof logrotate logsave look lorder losetup 
```

你可以阅读更多关于这方面的信息`man 3 readline`；这是`readline`图书馆的特色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T15:26:59.863

如果您想要确切地 bash 将如何完成

```
COMPLETIONS=$(compgen -c "$WORD") 
```

compgen 使用 bash 在 tabbing 时使用的相同规则完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T15:44:50.780

JacobM 的回答很棒。为了手动完成，我会使用这样的东西：

```
echo $PATH  | tr : '\n' | 
 while read p; do 
  for i in $p/mod*; do
   [[ -x "$i" && -f "$i" ]] && echo $i     
  done
 done 
```

输出之前的测试确保只显示可执行的常规文件。上面显示了所有以`mod`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:57:32.423

有趣，我不知道`compgen`。这是我用来执行此操作的脚本，它不检查非可执行文件：

```
#!/bin/bash
echo $PATH | tr ':' '\0' | xargs -0 ls | grep "$@" | sort 
```

将该脚本保存在您`$PATH`（我将其命名为`findcmd`）中的某个位置`chmod u+w`，然后像使用它一样使用它`grep`，传递您最喜欢的选项和模式：

```
findcmd ^foo   # finds all commands beginning with foo
findcmd -i -E 'ba+r'  # finds all commands matching the pattern 'ba+r', case insensitively 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T18:33:19.943

只是为了好玩，另一个手动变体：

```
find -L $(echo $PATH | tr ":" " ") -name 'pattern' -type f -perm -001 -print 
```

where`pattern`指定要使用的文件名模式。这将错过不可全局执行但您有权使用的命令。

[在 Mac OS X 上测试]

* * *

使用`-or`和`-and`标志构建此命令的更全面版本：

```
find -L $(echo $PATH | tr ":" " ") -name 'pattern' -type f
                                   \( \
                                       -perm -001 -or \
                                       \( -perm -100 -and -user $(whoami)\) \
                                   \) -print 
```

将获取您拥有权限的文件。我没有看到一个通用的方法来获得所有你可以通过组从属关系执行而不需要更多编码的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T14:58:06.413

遍历 $PATH 变量并对`ls beginningofword*`路径中的每个目录执行操作？

要使其完全等效，您需要仅过滤掉可执行文件并按名称排序（使用 ls 标志和 sort 命令应该很容易）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T14:58:55.537

点击时列出的是 PATH 中以该字符串开头的二进制文件。因此，如果您的 PATH 变量包含： PATH=/usr/local/bin:/usr/bin:/bin:/usr/games:/usr/lib/java/bin:/usr/lib/java/jre/bin： /usr/lib/qt/bin:/usr/share/texmf/bin:.

Bash 将在每个目录中查找，以便在您点击后向您显示建议。因此，要将以“ls”开头的命令列表放入变量中，您可以执行以下操作： MYVAR=$(ls /usr/local/bin/ls* /usr/bin/ls* /bin/ls*) 您当然可以添加我没有的所有其他目录。

# javascript - 旋转图像，如果最后一个图像则隐藏

> ID：511693
> 
> 赞同：0
> 
> 时间：2009-02-04T14:55:36.917
> 
> 标签：javascript, jquery

单击按钮时，我想旋转 3 张图像。

图像1，图像2，图像3。

如果图像位于 image1，则单击时应显示 image2（依此类推，按 image1、..、image3 的顺序）。

当我在 image3 时，它应该隐藏图像，即不显示它。

我需要一些关于 javascript 函数的帮助才能做到这一点，我已经有了按钮单击事件的代码。

我正在将 toggle() 函数传递给 jquery 对象`$('myImageID')`；

```
$(document).ready(
    function() 
    {

        $('#button1').click( function() { toggleSector( $('#sector1') ) }  ;            

    } 
);

function toggleSector(o)
    {     
         // help!
    }

<div id="sector1"></div>
<input type="button" id="button1" value="Sector 1" /> 
```

**更新**

`<div>`我必须以某种方式找到设置为我的图像所在位置的当前背景图像的名称 。

是否有背景属性来获取当前显示的图像名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:04:12.157

您可以通过[.css(name) 方法](http://docs.jquery.com/CSS/css#name)访问背景图像：

```
$("#sector1").css("background-image"); 
```

如果不以数组或其他方式管理图像列表，您将不得不检查每个背景图像以了解何时隐藏元素。这不是一种很好的工作方式，因为它不允许您在将来轻松添加新图像，如果您愿意的话。

也许类似于以下内容：

```
function toggle(el) {
  var whenToHide = "background3.jpg";
  var currBackground = $(el).css("background-image");
  /* ...code... */
  if (currBackground == whenToHide) {
    $(el).remove();
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T15:20:56.320

你必须使用背景图片吗？
如果没有，这里有一个我会做的小代码示例。

```
<html>
<head>
<style type="text/css">
    #imageRotater { list-style-type:none; }
    #imageRotater, .imageRotater li { margin:0px auto; padding: 0px; }
    #imageRotater img { display:none; }
</style>

<script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.1.min.js"></script>
<script type="text/javascript">
(function($) {
    $.fn.rotate = function() {
        return this.each(function() {
            var list = $(this).is('ul') ? $(this) : $('ul', this);
            list.find('img:eq(0)').show();

            $('img', list).click(function() {
                $(this).hide().closest('li').next().find('img').show();
            });
        });
    };
})(jQuery);

$(document).ready(function() {
    $("#imageRotater").rotate();
});

</script>

</head>
<body>
    <div id="sector1">
        <ul id="imageRotater">
            <li><img src="image1.png" alt="" /></li>
            <li><img src="image2.png" alt="" /></li>
            <li><img src="image3.png" alt="" /></li>
        </ul>
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:13:12.843

这是一个有效的方法。
每个叠加层最初都使用 CSS 隐藏。每次单击按钮时，都会隐藏所有叠加层，然后根据存储在按钮上的一些数据显示一个。如果数据达到最大叠加次数 + 1，则不显示任何数据并将数据重置为 0。

标记

```
<div id="container" style="background: yellow">
    <div class="overlay" style="background: red"></div>
    <div class="overlay" style="background: green"></div>
    <div class="overlay" style="background: blue"></div>
</div> 
```

风格

```
div{
    width: 100px;
    height: 100px;

}
.overlay{
    position: absolute;
    top: 0;
    left: 0;
    display: none;
}
#container{
    position: relative;
} 
```

脚本

```
$(function() {
    var b = $('#button1');
    b.data('next', 0);
    b.data('max', $('.overlay').size()+1 );
    b.click( function( e ) {
        var next = $(this).data('next');
        var o = $('.overlay');
        o.hide();
        o.eq(next).show();
        next = (next+1) % $(this).data('max');
        $(this).data('next', next);
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-24T20:05:33.300

为了回应上面Bendeway的回答，您需要在之前插入

```
list.find('img:eq(0)').show(); 
```

以下行：

```
list.find('img').hide(); 
```

这将在开始旋转之前隐藏所有图像。

# bash - 获取名称与特定模式匹配的变量列表

> ID：511694
> 
> 赞同：47
> 
> 时间：2009-02-04T14:55:40.130
> 
> 标签：bash, variables, scripting

在 bash

```
echo ${!X*} 
```

将打印名称以“X”开头的所有变量的名称。
是否可以使用任意模式获得相同的结果，例如获取名称在任何位置包含“X”的变量的所有名称？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-02-04T15:50:51.830

使用内置命令 compgen：

```
compgen -A variable | grep X 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-04T15:05:39.753

这应该这样做：

```
env | grep ".*X.*" 
```

编辑：对不起，它也在值中寻找 X。此版本仅在 var 名称中查找 X

```
env | awk -F "=" '{print $1}' | grep ".*X.*" 
```

正如 Paul 在评论中指出的那样，如果您也在寻找局部变量，则需要将 env 替换为 set：

```
set | awk -F "=" '{print $1}' | grep ".*X.*" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T15:08:12.587

最简单的可能是做一个

```
printenv |grep D.*= 
```

唯一的区别是它还打印出变量的值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-13T16:34:28.560

这将仅在变量名中搜索 X 并仅输出匹配的变量名：

```
set | grep -oP '^\w*X\w*(?==)' 
```

或为了更轻松地编辑搜索到的模式

```
set | grep -oP '^\w*(?==)' | grep X 
```

或者简单地说（也许更容易记住）

```
set | cut -d= -f1 | grep X 
```

如果要匹配变量名称中的 X，但以 name=value 形式输出，则：

```
set | grep -P '^\w*X\w*(?==)' 
```

如果你想在变量名中匹配 X，但只输出值，那么：

```
set | grep -P '^\w*X\w*(?==)' | grep -oP '(?<==).*' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:10:43.767

```
env | awk -F= '{if($1 ~ /X/) print $1}' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-04T07:49:38.683

增强 Johannes Schaub - litb 回答在现代 bash 中删除 fork/exec 我们可以做

```
compgen -A variable  -X '!*X*' 
```

即变量列表中任何位置的X。

# windows-installer - Wise Installation Studio：什么是 WiseCustomCall

> ID：511712
> 
> 赞同：0
> 
> 时间：2009-02-04T15:01:00.463
> 
> 标签：windows-installer, wise

我正在将旧的 Wise for Windows 安装升级到更新版本的 Wise Installation Studio，并且 WiseCustomCall 资源现在标记为 <unspecified>。.wsi 编译成 .msi 没有问题，但在运行时失败，无法找到“位置：WiseCustomCall，命令：g0”。

谁能提供一些有关 WiseCustomCall 的信息？它具体有什么作用？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T18:42:13.363

我相信 WiseCustomCall 是 Wise Installation 处理自定义动作脚本执行的处理程序。

你能确认你收到错误 172* 吗？（你收到什么错误？）

要解决此错误消息：

检查自定义操作的位置以确保文件在执行时可用。放置可在其余安装完成后运行的自定义操作的好位置是在 MSI 脚本中的立即执行序列中的 InstallFinalize 之后。通过在 Start > Run 提示符下使用以下命令行执行 .MSI 创建日志文件：

```
msiexec /i  <full path of MSI package> /l*v <path to log file>. 
```

有时，WiseCustomCall 操作已与自定义操作解除关联。转到 Installation Expert 中的资源页面，找到 WiseCustomCall 条目，然后浏览到 WiseDll.DLL。

# vb.net - 从代码隐藏动态创建和访问 RadioButtonLists

> ID：511718
> 
> 赞同：0
> 
> 时间：2009-02-04T15:01:58.417
> 
> 标签：vb.net, dynamic, radiobuttonlist

我的问题是：我有一个精简的`default.aspx`页面。除了一个元素，几乎所有的功能都必须在`aspx.vb`.

该程序从数据库中检索信息并将其与另一个表列表进行比较，两个列表的数量可能会有所不同。

所以我需要将动态数量的 RadioButtonLists “绑定”到`asp:table`元素控件，并且我需要为创建的每个 RadioButtonList 创建动态数量的 ListItems。稍后，我需要能够访问每个选定的值，以便决定数据库中的未来功能。

代码示例如下：

***.aspx 文件：***

```
<asp:table ID="table1" runat="server"> 
```

* * *

***aspx.vb 文件（代码隐藏）：***

```
Sub createHtmlTables()

    For i = 0 To productIndex.Count - 1

        ''//create a RadioButtonList for each i
        Dim row As New TableRow
        Dim cell As New TableCell

        For k = 0 To productTypeAmountIndex.Count - 1

            ''//create a ListItem(radiobutton)
            ''//for each k and include it in the RadioButtonList

            ''//assign a value (for example name) of the product as
            ''//the ListItems ID to retreive it later

        Next

        ''//add the RadioButtonList to cell.controls etc
        Table1.Rows.Add(row)

    Next
End Sub

Sub addToDb()
    For i = 0 To productIndex.Count - 1
        ''//get the RadioButtonList for each i
        ''//and return the value of the selected radiobutton
        ''//within the list to a variable

    Next

End Sub 
```

抱歉，如果这很长而且令人困惑，但由于我什至还不能正确地提出我的问题，所以我试图包含尽可能多的信息。基本上我只需要一个例子来说明如何以及使用哪些方法来使所有这些工作。

**更新：**

每个人都一直告诉我，从表格开始是一个错误，但是我发现的某个地方声称您不能像使用表格那样轻松地自定义数据网格的外观。我想我会从头开始整件事。

问题是 UI 应该尽可能图形化，使用表格我可以做各种整洁的事情，例如根据里面的信息为单元格着色等。

无论如何，谢谢，但不是我想要的，但我会尝试用 datagrid / gridview 重新制作这个东西，看看会发生什么。可能需要几天的时间，我才能学到足够多的东西来使用它们并回到这里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T15:20:37.023

与表格相比，使用真正的服务器控件（如 gridview 或 datagrid 或中继器）会更好。然后你可以在你的控件上连接数据源属性。

对于所有动态控件，请记住每次执行回发时都必须重新创建它们。这听起来可能很奇怪，但诀窍是对服务器的每个请求，包括回发，都使用页面类的不同实例。当该请求/回发完成时，用于该请求的页面实例被销毁。唯一保持活动状态的是会话和缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-18T09:00:23.533

这是我的 .aspx 代码。

```
<asp:Table ID="Questions" runat="server">

</asp:Table>
<asp:Button ID="SaveButton" runat="server" Text="Save" /> 
```

这是我在文件代码后面的代码。我添加了动态下拉列表。单击保存按钮时，我正在检索选定的值。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    Dim NewRow As New TableRow
    Dim NewCell As New TableCell
    Dim rblOptions As New RadioButtonList
    rblOptions.ID = "Option1"

    rblOptions.Items.Add(New System.Web.UI.WebControls.ListItem("1", "1"))
    rblOptions.Items.Add(New System.Web.UI.WebControls.ListItem("2", "2"))
    rblOptions.Items.Add(New System.Web.UI.WebControls.ListItem("3", "3"))

    NewCell.Controls.Add(rblOptions)
    NewRow.Cells.Add(NewCell)
    'Questions is a table
    Questions.Rows.Add(NewRow)

End Sub

Protected Sub SaveButton_Click(sender As Object, e As EventArgs) Handles SaveButton.Click
    If Page.IsValid Then
        Dim rbl As RadioButtonList = DirectCast(Questions.FindControl("Option1"), RadioButtonList)

        If rbl.SelectedValue.ToString = "ExpectedValue" Then

        End If
    End If
End Sub 
```

# php - 如何从 PHP 向 javascript 方法 Date.setTime() 提供值？

> ID：511721
> 
> 赞同：1
> 
> 时间：2009-02-04T15:02:36.107
> 
> 标签：php, javascript, time, clock

是时间（）吗？是 time().substr(microtime(), 2, 2) 吗？是 time().substr(microtime(), 2, 3) 吗？

下面的代码片段有点迷失了。

```
function updateClock ( ) {
    var timeStamp = <?php echo time().substr(microtime(), 2, 2);?>;
    var currentTime = new Date ( );
    currentTime.setTime( timeStamp );

    ...
    ...
} 
```

我的目标是使用服务器时间并在客户端浏览器窗口上从那里开始计时。上面的代码要么返回当前客户端计算机时间，要么返回 1973 年的某个时间。我想我没有得到正确的 setTime() 时间戳格式？

谢谢！

*   1000

我试过了，但是在我将 js.php（呈现 javascript 代码）上传到我的服务器后，网页仍然显示我的本地时间。我的服务器与我的时间相差大约 12 小时。我的猜测是 php 是否将客户端时间考虑到运行时间（）？我的意思是浏览器确实会向 apache 发送请求时间，对吗？

我从服务器上运行的网页中复制了 time() * 1000 返回值并将其粘贴到本地页面中：

```
<script type="text/javascript">

var d = new Date();
d.setTime(1233760568000);
document.write(d);

</script> 
```

这确实是我的当地时间。因此猜测。

有没有为 time() 指定时区？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:09:28.653

[Date.setTime](http://www.w3schools.com/jsref/jsref_setTime.asp)预计自 1970-1-1 以来的**毫秒**数。php 的[time 函数](http://php.net/time)产生自 1970-1-1 以来的**秒数**。因此，您可以只使用

```
var TimeStamp = <?php echo time()*1000;?> 
```

由于延迟问题（浏览器需要在启动 JavaScript 之前加载整个页面），时间通常会漂移一到几秒钟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T15:09:38.497

乘以 1000。JavaScript 需要毫秒，而 PHP 返回秒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T15:10:32.970

`Date.setTime()`想要自 Unix 纪元以来的毫秒数，并`time()`从那时起返回秒数。如果不需要绝对精度（鉴于您的方法，我认为不需要），只需将您获得的值`time()`乘以`1000`.

编辑：被打了两次——D'oh

# asp.net - VB中的事件和事件处理

> ID：511739
> 
> 赞同：0
> 
> 时间：2009-02-04T15:06:24.790
> 
> 标签：asp.net, vb.net, event-handling

我有一个 web 用户控件，其中我的 aspx 页面包含。在测试期间，我发现抛出了一个异常。（现有的一般规则是，当发生异常时，用户将被重定向到详细说明错误的异常页面）

一旦在我的用户控件中处理了异常，我想将它扔到可以安全地进行解析和重定向的页面。我在其他情况下通过使用 Global Asax、Application_Error 来处理重定向等来执行此操作。但是当我从用户控制中抛出异常时发生的所有事情都是我得到了一个带有异常消息的可怕的 javascript 类型对话框。

为了解决这个问题，我声明了一个事件，然后从用户控件引发，并将异常作为参数。我可以成功地将异常解析为所需格式并将用户重定向到异常页面。

我的问题是这些

1.  为什么从用户控件中抛出异常只会导致 javascript 对话框而不是 Global.asax 错误处理启动。

2.  有没有办法强制控件的消费者处理我的自定义错误事件？类似于“MustImplement”-----“MustHandle”之类的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T15:24:00.990

> 1.  为什么从用户控件中抛出异常只会导致 javascript 对话框而不是 Global.asax 错误处理启动。

因为在异步回发期间出现页面错误，这里有一篇关于[ASP.Net Ajax 应用程序中的错误处理](http://www.codedigest.com/Articles/ASPNETAJAX/115_Error_Handling_in_ASPNet_Ajax_Applications.aspx)的好文章。

> 2.有没有办法强制控件的消费者处理我的自定义错误事件？类似于“MustImplement”-----“MustHandle”之类的事情？

[这](http://vyasashutosh.blogspot.com/2008/11/error-handling-with-globalasax-and.html)解释了如何处理 Global.asax 中的异步回发错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T15:09:55.623

我不精通 ASP.NET，但我会试一试：

> 1.  为什么从用户控件中抛出异常只会导致 javascript 对话框而不是 Global.asax 错误处理启动。

错误在客户端引发，您的错误处理发生在服务器端。除非您实现一个在错误时触发的 AJAX-y 回调，否则服务器不会收到任何客户端错误的通知。这似乎不是 ASP.NET 中的默认行为。您可能会查看 Microsoft 的 AJAX 库，肯定他们已经为此类事情提供了机制。

> 2.  有没有办法强制控件的消费者处理我的自定义错误事件？类似于“MustImplement”-----“MustHandle”之类的事情？

简单的回答：没有。

# cocoa-touch - 如何返回第一视图

> ID：511741
> 
> 赞同：1
> 
> 时间：2009-02-04T15:06:34.603
> 
> 标签：cocoa-touch

这可能是一个愚蠢的问题，但是伙计们，我是 iPhone-sdk 的新手。

我走得很深 5 意见。现在，在视图#5 中完成了工作流，但是如何返回到第一个视图呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T15:58:55.277

你真的没有提供足够的信息。你在使用 UINavigationController 吗？如果是这样 - 在文档中，我可能会添加 - 是方法：

```
- (NSArray *)popToRootViewControllerAnimated:(BOOL)animated 
```

# redirect - 阻止外部盗链的道德规范

> ID：511748
> 
> 赞同：5
> 
> 时间：2009-02-04T15:08:53.600
> 
> 标签：redirect, hyperlink

我只是浏览了[谷歌提供的一些网站管理员统计数据](https://www.google.com/webmasters/tools/dashboard)，并注意到我们网站最常见的链接是我们以 PDF 格式发布的一些研究文章。这些文章也以 HTML 格式在网站上提供。

我正在查看链接到这些文章的网站（主要是论坛和博客），并认为点击链接的人实际上都不会看到我们的网站，而且我们正在免费赠送一些东西，甚至没有得到一些页面浏览量作为回报。

我想也许我可以更改我的服务器设置以将外部请求重定向到这些文件到 HTML 版本。通过这种方式，用户仍然可以获得相同的内容（尽管格式出人意料），我们会让这些人看到我们的网站，并希望更多地探索它。来自我的网站的请求应该通过 PDF 传递。虽然我还不知道如何设置它*（请留意此处的后续问题）*，但我确信这在技术上是可行的。唯一的问题是：**这是个好主意吗？**

您认为从外部来源重定向流量以使他们看到我们的网站而不仅仅是获取我们的内容的缺点是什么？它们是否超过了好处？

我能看到的唯一其他替代选项是让我们的品牌和 URL 在 PDF 文件本身中更加明显。有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T15:17:28.463

希望您的 PDF 具有相同的品牌，以便访问者感到有必要在您的网站中进一步搜索。这可能与让访问者在您的网站短暂停留一样重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T15:14:12.543

我通常反对所有对可用性有害的重定向。但是，在这种情况下，会发生基本的内容类型协商，这可能是可以接受的。但是，请确保这不会中断可能已在浏览器中禁用其引荐来源的用户的 PDF 文档下载（我这样做了）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T15:32:45.750

当然你可以切断它们，但有一个更大的问题在起作用：为什么这些人在找到这些moocher网站之前没有找到你？

可能的原因有：

a）他们确实找到了您的网站，但没有找到他们正在寻找的内容，即使它显然在那里，或者

b) 您的网站从未出现在他们的搜索结果中。

您可能需要考虑重新设计网站，以便在切断看似可靠的目标受众信息来源（对于您和从其他地方获取您的 PDF 的人）之前解决这些问题。

同时，我建议您允许流量，为您的所有 PDF 添加一个封面页，这基本上是您网站的整页广告，然后在每个页面的版权部分放大字体，以便作者身份非常突出. 你现在有一个固定的观众，他们只是还不知道。告诉他们来源在哪里。

最终，流量会来到您身边，并知道您是该信息的可靠来源。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T15:14:01.107

我会做。这是您的网站和您的数据。热链接器本质上是“客人”，您可以为客人制定规则。如果他们不喜欢它，他们不必链接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:13:38.050

我会在每篇文章的开头添加一个页面，其中包含有关网站的信息、当前文章以及指向您网站上其他文章的链接。

我发现它比将用户重定向到您网站上的页面更方便（这很烦人）。大多数人右键单击并下载 PDF 文件，当您重定向时会做什么；）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T15:28:57.613

我认为在这种情况下正确的做法是离开重定向。原因如下：

*   没有什么比期望去某个地方/得到一些东西而没有得到它更糟糕的了（负面影响会超过正面影响。）*   修改您的内容以添加页脚，例如：“就像您看到的一样，我们还有更多，请访问*www.url.com*查看我们”*   如果您的内容很好，用户会查看您的网站。这些是您想要的访问者，他们更有可能留下来并为您的网站提供价值（无论可能是什么）。您强迫的那些可能会为您提供一两次额外的点击，但您可能不会看到返还给您的网站的任何价值。*   看看其他免费赠送东西的成功网站：[Joel on Software](http://www.joelonsoftware.com/)、[Seth Godin](http://sethgodin.typepad.com/)、[Tim Ferriss](http://www.fourhourworkweek.com/blog/)、[37Signals](http://www.37signals.com/svn/)。长期将提供比短期更好、更一致的价值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T15:31:48.047

如果您选择此解决方案，如果有人在链接上使用“另存为”，请查看重定向到 HTML 版本是否也会更改浏览器显示的文件名，否则 HTML 页面将以 pdf 扩展名保存。除此之外，我看不出你不应该这样做的理由。

作为替代方案，看看您是否可以将指向您网站的链接添加到 pdf 文件的顶部。这样，即使其他人通过电子邮件将其发送给他们，他们也会被提醒它来自哪里。

# c# - 固定表格的位置

> ID：511752
> 
> 赞同：2
> 
> 时间：2009-02-04T15:09:44.127
> 
> 标签：c#, .net, winforms

我正在启动一个 winform 应用程序 [.NET 3.5, C#]，其中应用程序的主窗体从特定的指定位置开始。为此在构造函数中调用以下代码

```
 private void SetFormPosition()
    {
        this.StartPosition = FormStartPosition.Manual;
        this.Left = Screen.PrimaryScreen.WorkingArea.Right - this.Width;
        this.Top = Screen.PrimaryScreen.WorkingArea.Bottom - this.Height;            
    } 
```

应用程序启动后，我想在整个应用程序生命周期内保持表单的位置不变。

也许，我可以“点击”更改了 Location 事件，但不确定这是否会非常优雅。

请建议。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:19:35.730

我同意其他人的观点，您可能不应该这样做，但如果必须，请继续阅读。

您可以覆盖 SetBoundsCore 方法并阻止任何移动。我们使用它来防止在某些 UserControl 实现（例如包含 ComboBox 或其他固定高度控件的实现）上垂直调整大小，但它也负责位置更改。

以下内容应该可以帮助您入门：

```
 protected override void SetBoundsCore(
             int x, int y, int width, int height, BoundsSpecified specified)
    {
        x = this.Location.X;
        y = this.Location.Y;
        //...etc...
        base.SetBoundsCore(x, y, width, height, specified);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T15:20:54.760

您可以将 FormBorderStyle 设置为 None。这样做的另一个好处是移除了窗口顶部的栏，这会给用户一种他们应该能够移动窗口的错误感觉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-26T08:35:56.693

改变这个

`Location = new Point(this.Width,this.Height);`

# javascript - js函数从url获取文件名

> ID：511761
> 
> 赞同：68
> 
> 时间：2009-02-04T15:11:45.090
> 
> 标签：javascript, function

我有一个像[http://www.example.com/blah/th.html这样的网址](http://www.example.com/blah/th.html)

我需要一个javascript函数来给我'th'值。

我所有的网址都具有相同的格式（2 个字母文件名，扩展名为 .html）。

我希望它是一个安全的功能，所以如果有人传入一个空的 url，它不会中断。

我知道如何检查长度，但我应该检查 null 是否正确？

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2013-06-17T08:50:00.503

```
var filename = url.split('/').pop() 
```

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2016-04-20T22:56:12.803

为什么这么难？

`var filename = url.split('/').pop().split('#')[0].split('?')[0];`

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-02-04T15:24:35.783

使用匹配功能。

```
function GetFilename(url)
{
   if (url)
   {
      var m = url.toString().match(/.*\/(.+?)\./);
      if (m && m.length > 1)
      {
         return m[1];
      }
   }
   return "";
} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-03-19T20:09:37.107

与其他人类似，但是...我使用了 Tom 的简单脚本 - 一行，
然后您可以在任何地方使用文件名 var：
[http ://www.tomhoppe.com/index.php/2008/02/grab-来自窗口位置的文件名/](http://www.tomhoppe.com/index.php/2008/02/grab-filename-from-window-location/)

```
var filename = location.pathname.substr(location.pathname.lastIndexOf("/")+1); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-04-03T03:53:03.423

一个考虑 URL 查询和哈希标识符的正则表达式解决方案：

```
function fileNameFromUrl(url) {
   var matches = url.match(/\/([^\/?#]+)[^\/]*$/);
   if (matches.length > 1) {
     return matches[1];
   }
   return null;
} 
```

JSFiddle[在这里](https://jsfiddle.net/zoxyoymn/10/)。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2018-11-30T15:17:27.373

这应该适用于所有情况

```
function getFilenameFromUrl(url) {
  const pathname = new URL(url).pathname;
  const index = pathname.lastIndexOf('/');
  return (-1 !== index) ? pathname.substring(index + 1) : pathname;
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-07-18T17:59:30.810

因为使用自定义代码的案例往往会失败，所以我查看了 JavaScript`URL`类。唉，它在相对 URL 上窒息！此外，它没有获取文件名的属性。*不是史诗。*

*必须*有一个好的库来解决这个常见问题。[看 URI.js](https://github.com/medialize/URI.js/tree/master)。您只需要一个简单的语句，如下所示：

```
let file = new URI(url).filename() 
```

然后我们可以创建一个简单的函数来进行空检查并删除文件扩展名：

```
function fileName(url) {
   if (url === null || typeof url === 'undefined')
      return ''
   let file = new URI(url).filename() // File name with file extension
   return file.substring(0, file.lastIndexOf('.')) // Remove the extension
} 
```

这是一个包含测试用例的片段。除驱动器路径外，所有情况均通过。

```
test('Dots in file name without URL', 'dotted.file.name.png', 'dotted.file.name')
test('Dots in file name with URL', 'http://example.com/file.name.txt', 'file.name')
test('Lengthy URL with parameters', '/my/folder/filename.html#dssddsdsd?toto=33&dududu=podpodpo', 'filename')
test('URL with hash', '/my/folder/filename.html#dssddsdsd', 'filename')
test('URL with query strings', '/my/folder/filename.html?toto=33&dududu=podpodp', 'filename')
test('Hash after query string', 'http://www.myblog.com/filename.php?year=2019#06', 'filename')
 test('Query parameter with file path character', 'http://www.example.com/filename.zip?passkey=1/2', 'filename')
test('Query parameter with file path character and hash', 'http://www.example.com/filename.html?lang=en&user=Aan9u/o8ai#top', 'filename')
test('Asian characters', 'http://example.com/文件名.html', '文件名')
test('URL without file name', 'http://www.example.com', '')
test('Null', null, '')
test('Undefined', undefined, '')
test('Empty string', '', '')
test('Drive path name', 'C:/fakepath/filename.csv', 'filename')

function fileName(url) {
   if (url === null || typeof url === 'undefined')
      return ''
   let file = new URI(url).filename() // File name with file extension
   return file.substring(0, file.lastIndexOf('.')) // Remove the extension
}

function test(description, input, expected) {
   let result = fileName(input)
   let pass = 'FAIL'
   if (result === expected)
      pass = 'PASS'
   console.log(pass + ': ' + description + ': ' + input)
   console.log('  =>  "' + fileName(input) + '"')
}
```

```
<script src="https://cdn.jsdelivr.net/gh/medialize/URI.js@master/src/URI.js"></script>
```

**结果**

```
PASS: Dots in file name without URL: dotted.file.name.png
  =>  "dotted.file.name"
PASS: Dots in file name with URL: http://example.com/file.name.txt
  =>  "file.name"
PASS: Lengthy URL with parameters: /my/folder/filename.html#dssddsdsd?toto=33&dududu=podpodpo
  =>  "filename"
PASS: URL with hash: /my/folder/filename.html#dssddsdsd
  =>  "filename"
PASS: URL with query strings: /my/folder/filename.html?toto=33&dududu=podpodp
  =>  "filename"
PASS: Hash after query string: http://www.myblog.com/filename.php?year=2019#06
  =>  "filename"
PASS: Query parameter with file path character: http://www.example.com/filename.zip?passkey=1/2
  =>  "filename"
PASS: Query parameter with file path character and hash: http://www.example.com/filename.html?lang=en&user=Aan9u/o8ai#top
  =>  "filename"
PASS: Asian characters: http://example.com/文件名.html
  =>  "文件名&quot;
PASS: URL without file name: http://www.example.com
  =>  ""
PASS: Null: null
  =>  ""
PASS: Undefined: undefined
  =>  ""
PASS: Empty string: 
  =>  ""
FAIL: Drive path name: C:/fakepath/filename.csv
  =>  "" 
```

如果您懒得编写自定义代码并且不介意使用库为您工作，则此解决方案适合您。如果您想编写高尔夫解决方案，它不适合您。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-01-06T14:13:40.007

这些不适用于像
**“/my/folder/questions.html#dssddsdsd?toto=33&dududu=podpodpo”这样的长网址**

在这里我希望得到“questions.html”。所以一个可能的（慢）解决方案如下

```
fname=function(url) 
{ return url?url.split('/').pop().split('#').shift().split('?').shift():null } 
```

然后你可以测试在任何情况下你只得到文件名。

```
fname("/my/folder/questions.html#dssddsdsd?toto=33&dududu=podpodpo")
-->"questions.html"
fname("/my/folder/questions.html#dssddsdsd")
-->"questions.html"
fname("/my/folder/questions.html?toto=33&dududu=podpodpo")
"-->questions.html"

(and it works for null) 
```

（我希望看到更快或更智能的解决方案）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-02-01T03:30:10.460

此答案仅适用于浏览器环境。不适合节点。

```
function getFilename(url) {
  const filename = decodeURIComponent(new URL(url).pathname.split('/').pop());
  if (!filename) return 'index.html'; // some default filename
  return filename;
}

function filenameWithoutExtension(filename) {
  return filename.replace(/^(.+?)(?:\.[^.]*)?$/, '$1');
} 
```

这里有两个函数：

*   第一个从 url 获取文件名
*   第二个从完整文件名中获取不带扩展名的文件名

对于解析 URL，new 一个`URL`对象应该是最好的选择。另请注意，URL 并不总是包含文件名。

**注意：**此函数尝试从 URL 解析文件名。但它不保证文件名有效且适合使用：

*   某些操作系统不允许文件名中包含某些字符（例如`:`，在 Windows 中，`\0`在大多数操作系统中，...）；
*   某些文件名可能由操作系统保留（例如`CON`在 Windows 中）；
*   某些文件名可能会让用户不乐意处理它（例如，Linux 中名为“--help”的文件）

* * *

测试一下：

```
function getFilename(url) {
  const filename = decodeURIComponent(new URL(url).pathname.split('/').pop());
  if (!filename) return 'index.html'; // some default filename
  return filename;
}

function test(url) {
  console.log('Filename: %o\nUrl: %o', getFilename(url), url);
}

test('http://www.example.com');
test('http://www.example.com/');
test('http://www.example.com/name.txt');
test('http://www.example.com/path/name.txt');
test('http://www.example.com/path/name.txt/realname.txt');
test('http://www.example.com/page.html#!/home');
test('http://www.example.com/page.html?lang=en&user=Aan9u/o8ai#top');
test('http://www.example.com/%E6%96%87%E4%BB%B6%E5%90%8D.txt')
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2021-03-23T17:44:11.003

除了现有的答案，我建议使用[`URL() constructor`](https://developer.mozilla.org/en-US/docs/Web/API/URL)（在浏览器和 Node.js 中都可以使用），因为您可以确定您的 URL 是有效的：

```
const url = 'https://test.com/path/photo123.png?param1=1&param2=2#hash';

let filename = '';
try {
  filename = new URL(url).pathname.split('/').pop();
} catch (e) {
  console.error(e);
}
console.log(`filename: ${filename}`);
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-01-06T13:05:45.480

我会使用`substring`与`lastIndexOf`. 这将允许文件名中包含句点，例如，鉴于`http://example.com/file.name.txt`这给出`file.name`的答案与接受的答案不同`file`。

```
function GetFilename(url)
{
    if (url)
    {
        return url.substring(url.lastIndexOf("/") + 1, url.lastIndexOf("."));
    }
    return "";
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-04T19:17:13.083

将 jQuery 与[URL 插件](http://projects.allmarkedup.com/jquery_url_parser/)一起使用：

```
var file = jQuery.url.attr("file");
var fileNoExt = file.replace(/\.(html|htm)$/, "");
// file == "th.html", fileNoExt = "th" 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-06-10T00:45:21.373

对于节点和浏览器，基于@pauls 的回答，但解决了哈希问题和更具防御性的问题：

```
export function getFileNameFromUrl(url) {
  const hashIndex = url.indexOf('#')
  url = hashIndex !== -1 ? url.substring(0, hashIndex) : url
  return (url.split('/').pop() || '').replace(/[\?].*$/g, '')
} 
```

少数情况：

```
describe('getFileNameFromUrl', () => {

  it('absolute, hash and no extension', () => {
    expect(getFileNameFromUrl(
      'https://foo.bar/qs/bar/js-function-to-get-filename-from-url#comment95124061_53560218'))
    .toBe('js-function-to-get-filename-from-url')
  })

  it('relative, extension and parameters', () => {
    expect(getFileNameFromUrl('../foo.png?ar=8')).toBe('foo.png')
  })

  it('file name with multiple dots, hash with slash', () => {
    expect(getFileNameFromUrl('questions/511761/js-function.min.js?bar=9.9&y=1#/src/jjj?=9.9')).toBe('js-function.min.js')
  })
}) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-04-01T16:20:34.040

这应该可以处理你扔给它的任何东西（绝对 URL、相对 URL、复杂 AWS URL 等）。如果文件名和默认值都不存在，它包括一个可选的默认值或使用伪随机字符串。

```
function parseUrlFilename(url, defaultFilename = null) {
    let filename = new URL(url, "https://example.com").href.split("#").shift().split("?").shift().split("/").pop(); //No need to change "https://example.com"; it's only present to allow for processing relative URLs.
    if(!filename) {
        if(defaultFilename) {
            filename = defaultFilename;
        //No default filename provided; use a pseudorandom string.
        } else {
            filename = Math.random().toString(36).substr(2, 10);
        }
    }

    return filename;
} 
```

向@hayatbiralem 提供道具，用于确定[s](https://stackoverflow.com/q/511761#comment61576914_17143667)[的顺序`split()`](https://stackoverflow.com/q/511761#comment61576914_17143667)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-09-11T18:19:58.280

与@user2492653 所建议的类似，如果您想要的只是像 Firefox 给您的文件名，那么您需要 split() 方法，它将字符串分解为一个组件数组，然后您需要做的就是抓住最后一个指数。

```
var temp = url.split("//");
if(temp.length > 1)
 return temp[temp.length-1] //length-1 since array indexes start at 0 
```

这基本上会将 C:/fakepath/test.csv 分解为 {"C:", "fakepath", "test.csv"}

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-09-23T10:06:30.813

我的 2 美分

如果查询字符串包含“/”，则 LastIndexOf("/") 方法本身会失败

我们都知道它们“应该”被编码为，`%2F`但只需要一个未转义的值就会导致问题。

此版本正确处理查询字符串中的 /'s，并且不依赖 url 中的 .'s

```
function getPageName() {
    //#### Grab the url
    var FullUrl = window.location.href;

    //#### Remove QueryStrings
    var UrlSegments = FullUrl.split("?")
    FullUrl = UrlSegments[0];

    //#### Extract the filename
    return FullUrl.substr(FullUrl.lastIndexOf("/") + 1);
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-01-18T09:52:05.700

试试这个

```
url.substring(url.lastIndexOf('/')+1, url.length) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-02-16T22:03:48.633

```
function getFileNameWithoutExtension(url) {
  if (typeof url !== 'string') throw new Error('url must be a string');
  // Remove the QueryString
  return url.replace(/\?.*$/, '')
  // Extract the filename
  .split('/').pop()
  // Remove the extension
  .replace(/\.[^.]+$/, '');
} 
```

这`news`将从该 URL [http://www.myblog.com/news.php?year=2019#06](http://www.myblog.com/news.php?year=2019#06)返回。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-06-16T21:04:10.923

```
url? url.substring(url.lastIndexOf('/')+1, url.lastIndexOf('.')):'' 
```

*   安全如要求。当 url 是`null`或`undefined`结果是**`''`**.
*   删除所有带有“:”、点和任何符号的路径，包括最后一个“/”。
*   这给出了真正的答案**'th'**，而不是**'th.index'**。当然，让它发挥作用非常**重要。**
*   它允许文件名有几个句点！

*   未询问，但您也可以使用不带“/”和“.”的查询字符串

*这是 Abhishek Sharma 的正确答案，所以我给了他一个赞成票。如此天才和最小的单线 - 我在那里看到了:)*

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-08-25T08:19:57.863

### 基于 TypeScript 的 ES6 语法

实际上，标记的答案是正确的，但如果第二个`if`不满足函数返回`undefined`，我更喜欢这样写：

```
const getFileNameFromUrl = (url: string): string => {
  if (url) {
    const tmp = url.split('/');
    const tmpLength = tmp.length;

    return tmpLength ? tmp[tmpLength - 1] : '';
  }

  return '';
}; 
```

对于我的问题，我需要有文件扩展名。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2022-02-09T17:38:07.373

#### 简单函数（使用 RegEx 模式）

```
function pathInfo(s) {
    s=s.match(/(.*?\/)?(([^/]*?)(\.[^/.]+?)?)(?:[?#].*)?$/);
    return {path:s[1],file:s[2],name:s[3],ext:s[4]};
}

var sample='/folder/another/file.min.js?query=1';
var result=pathInfo(sample);
console.log(result);
/*
{
  "path": "/folder/another/",
  "file": "file.min.js",
  "name": "file.min",
  "ext": ".js"
}
*/
console.log(result.name);
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2016-07-15T12:58:22.747

从[如何使用 JavaScript 从完整路径获取文件名？](https://stackoverflow.com/questions/423376/how-to-get-the-file-name-from-a-full-path-using-javascript)

```
var filename = fullPath.replace(/^.*[\\\/]/, '') 
```

# model-view-controller - MVC 框架 - 服务器端 DOM 操作

> ID：511765
> 
> 赞同：3
> 
> 时间：2009-02-04T15:13:06.303
> 
> 标签：model-view-controller, oop, dom, frameworks

我正在构建一个 MVC 框架，并且我正在寻找本机解决方案/框架/标签库来完全借鉴或替换我的框架。

我对以下功能特别感兴趣：

*   服务器端 DOM 操作
*   服务器端事件（页面重新加载、表单提交、节点插入等）
*   使用 css 选择器遍历 DOM 树
*   验证 html 节点嵌套
*   验证 html 节点允许的属性
*   支持标签库/用户控件

几乎你用 JavaScript 得到的东西，但在服务器端和一些额外的东西。

任何解决方案都可以（即使是部分解决方案），任何语言都可以，任何指针都可以使用（即使来自客户端语言，只要可以检查源代码）。处理格式错误的 html**不是**先决条件。输出有效标记是一大优势。

* * *

请通过指出正在讨论的语言/框架以及它提供的功能（如果可能）来提供实用的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T22:52:30.187

你检查过aptana jaxer吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T15:19:22.283

如果您将页面加载到 DOM 解析器中，您将能够从那里修改它。然后将其输出到输出缓冲区似乎微不足道。

但是您需要将整个文档存储在内存中，这会影响性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T05:04:04.490

所以，jQuery 实现了一种选择器 API，我想我可以看看他们的源代码。此外，PHP 支持 XPath，这也有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-16T12:35:07.300

Fizzler 使用 HTMLAgility 包并添加了一个服务器端 queryselectorall 来提供 css 选择： [http ://code.google.com/p/fizzler/](http://code.google.com/p/fizzler/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-01T20:00:42.547

在这里找到了一个 php html dom 解析器，它也实现了一些 html 选择器：http: [//simplehtmldom.sourceforge.net](http://simplehtmldom.sourceforge.net)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-01-18T15:39:13.617

也许您正在寻找[ItsNat](http://www.itsnat.org)

# c++ - 如何像标准 C++ 流一样使用我的日志记录类？

> ID：511768
> 
> 赞同：15
> 
> 时间：2009-02-04T15:13:59.360
> 
> 标签：c++, logging, stream

我有一个工作记录器类，它将一些文本输出到一个富文本框（Win32，C++）。问题是，我总是这样使用它：

```
stringstream ss;  
ss << someInt << someString;  
debugLogger.log(ss.str()); 
```

相反，像流一样使用它会更方便，如下所示：

```
debugLogger << someInt << someString; 
```

有没有比将所有内容转发到内部字符串流实例更好的方法？如果这样做，我什么时候需要冲洗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-04T15:16:14.690

您需要`operator <<`为您的班级适当地实施。一般模式如下所示：

```
template <typename T>
logger& operator <<(logger& log, T const& value) {
    log.your_stringstream << value;
    return log;
} 
```

请注意，这处理（非`const`）引用，因为该操作会修改您的记录器。另请注意，您需要返回`log`参数才能使链接起作用：

```
log << 1 << 2 << endl;
// is the same as:
((log << 1) << 2) << endl; 
```

如果最里面的操作没有返回当前`log`实例，那么所有其他操作要么在编译时失败（错误的方法签名），要么在运行时被吞没。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-04T17:09:31.047

重载插入运算符<< 不是要走的路。您必须为所有 endl 或任何其他用户定义的函数添加重载。

要走的路是定义你自己的streambuf，并将它绑定到一个流中。然后，您只需要使用流。

下面是几个简单的例子：

*   [登录 C++](http://www.ddj.com/cpp/201804215)，Petru Marginean，DDJ，2007 年 9 月 5 日
*   [Rutger EW van Beusekom 的 logstream 类](http://lilypond.org/~janneke/vc/stream.cc/)，同时检查 .hpp 和这个文件

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-01-27T12:10:34.087

正如 Luc Hermitte 所[指出](https://stackoverflow.com/a/512303/)的，有一篇[“Logging In C++”](http://www.drdobbs.com/cpp/logging-in-c/201804215)文章描述了解决这个问题的非常巧妙的方法。简而言之，假设您具有以下功能：

```
void LogFunction(const std::string& str) {
    // write to socket, file, console, e.t.c
    std::cout << str << std::endl;
} 
```

可以编写一个包装器以在 std::cout 中使用它，如下所示：

```
#include <sstream>
#include <functional>

#define LOG(loggingFuntion) \
    Log(loggingFuntion).GetStream()

class Log {
    using LogFunctionType = std::function<void(const std::string&)>;

public:
    explicit Log(LogFunctionType logFunction) : m_logFunction(std::move(logFunction)) { }
    std::ostringstream& GetStream() { return m_stringStream; }
    ~Log() { m_logFunction(m_stringStream.str()); }

private:
    std::ostringstream m_stringStream;
    LogFunctionType m_logFunction;
};

int main() {
    LOG(LogFunction) << "some string " << 5 << " smth";
} 
```

（[在线演示](http://coliru.stacked-crooked.com/a/110d222fc4df1e0b)）

此外，斯图尔特提供了非常好的[解决方案。](https://stackoverflow.com/a/40424272/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-03-08T14:01:06.800

一个优雅的解决方案也解决了冲洗问题，如下所示：

```
#include <string>
#include <memory>
#include <sstream>
#include <iostream>

class Logger
{
    using Stream = std::ostringstream;
    using Buffer_p = std::unique_ptr<Stream, std::function<void(Stream*)>>;

public:
    void log(const std::string& cmd) {
        std::cout << "INFO: " << cmd << std::endl;
    }

    Buffer_p log() {
        return Buffer_p(new Stream, [&](Stream* st) {
            log(st->str());
        });
    }
};

#define LOG(instance) *(instance.log())

int main()
{
    Logger logger;
    LOG(logger) << "e.g. Log a number: " << 3;
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-04T15:16:11.040

在 Logger 类中，覆盖 << 运算符。

单击[此处](http://www.codersource.net/cpp_stream_operators.html)了解如何实现 << 运算符。

您还可以使用面向方面的编程来避免代码中的日志记录语句。

# .net - ASP.Net-mvc 中 ROR 闪存功能的可用性

> ID：511774
> 
> 赞同：1
> 
> 时间：2009-02-04T15:15:30.293
> 
> 标签：.net, ruby-on-rails, asp.net-mvc

Microsoft MVC 是否提供了一种类似于 RubyOnRails 内部存储容器（称为闪存）的机制？偏好不会使用 UpdatePanel 技巧。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T15:44:58.270

试试 TempData 对象。

# java - 3rd 方 jars 创建日志文件

> ID：511777
> 
> 赞同：2
> 
> 时间：2009-02-04T15:16:05.237
> 
> 标签：java, logging, log4j

所以我们今天遇到了一个有趣的问题。我们有一个使用一堆 3rd 方 jar 的 Java EE Web 应用程序。这包括休眠。

我们使用 SDK 附带的 Java logging api 进行日志记录。通常，我们在日志记录方面非常薄弱，但我们使用 log4j 创建它自己的日志文件的第 3 方 jar 之一遇到了这个问题。它不仅从自己的代码中记录语句，甚至开始为休眠代码编写调试，从而导致批处理作业立即记录 3 GB 的日志。

我有两个问题：

1.  我需要解决这个日志记录问题（如果可能的话，我不希望拉出或修改 3rd 方 jar 中的 log4j 配置）。除了修改或拉出第 3 方 jar 中的 log4j 配置，或者通过我自己的 log4j 配置覆盖第 3 方 jar 中的配置之外，是否还有一种好方法可以做到这一点？我不喜欢这两个选项中的任何一个，但我想做最好的。
2.  我想问一下，期望第 3 方图书馆愉快地注销是否符合规定？我认为这是一个糟糕的设计。我想了解社区对此的看法。

我想要第 3 方库记录错误。话虽如此，我认为这个第 3 方 jar 从它负责的包以外的包中记录 DEBUG 有点尴尬。例如，在我的情况下，这个第 3 方 jar 正在记录 Hibernate 调试，即使它甚至没有调用任何休眠方法。我们运行的批处理作业甚至没有调用这个 jar 中的 API。看起来让我自己的 log4j 配置覆盖其中的内容似乎是最好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T15:23:01.370

如果他们使用 log4j 或其他常用的日志框架，您可以通过在类路径中更早地提供另一个 lo4j.properties 来覆盖其配置。在我看来，第 3 方日志记录是一件好事，只要您可以轻松配置所需的日志记录级别，如果他们使用 log4j 就是这种情况。配置日志系统以输出更少的信息总是比使用第 3 方代码添加日志更容易！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T15:23:31.370

据我所知，您只需要在进行日志记录的 JAR 之前在类路径上提供您自己的 log4j 属性文件，这个文件就会被选中。深入内存，Hibernate 至少从其 JAR 的根目录中提取了这一点，因此您不需要打包您的属性。

作为一个更广泛的问题，是的，我绝对希望我的库进行日志记录——否则，如果没有日志，你怎么知道是否出了问题？

# filesystems - 非文件文件系统？

> ID：511781
> 
> 赞同：0
> 
> 时间：2009-02-04T15:16:32.757
> 
> 标签：filesystems, hard-drive

我一直在思考这个问题（你知道，程序员往往会做危险的事情）并且我一直在想，我们如此习惯的存储数据的方法真的那么高效吗？回答这个问题的麻烦在于我真的没有任何东西可以与之比较，因为它是我唯一使用过的东西。

我不是指 FAT 或 NTFS 或特定*类型*的文件系统，我指的是整个文件系统结构。我们只是习惯于在“文件夹”中考虑“文件”，就像我们的硬盘驱动器是一个巨大的文件柜。这是一个很好的类比，事实上，当我们这样想时，它会更容易学习，但它真的是描述程序及其各自部分的最佳方式吗？

我想知道是否有人可以想到（或知道）一种数据存储技术，该技术可用于存储数据以供操作系统使用，以不同的方式组织数据的各个部分。有什么……不同的东西存在吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T15:30:26.473

电子邮件通常存储在文件夹中。但是自从我迁移到 Gmail 后，我已经习惯于使用标签对我的电子邮件进行分类。

我经常想知道我们是否可以这样管理整个文件系统：您可以使用您喜欢的标签来标记文件，而不是将文件存储在文件夹中。文件标识符不会像这样：

```
/home/john/personal/contacts.txt 
```

但更像这样：

```
contacts[john,personal] 
```

嗯......只是深思熟虑（也许这已经存在！）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T15:21:50.890

例如，您可以拥有专门的解决方案，例如[Oracle Raw Partitions](http://download.oracle.com/docs/html/B13831_01/ap_raw.htm)。其他数据库支持类似的东西。在这些情况下，文件系统提供了不必要的开销并且可以省略 - 数据库软件将负责组织结构。

该问题似乎非常依赖于应用程序，并且文件/文件夹似乎是许多应用程序的合理折衷方案（并且人类很容易理解）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T15:22:22.027

大型机过去只是为程序员提供了许多“设备”来使用。该设备对应于驱动器或其分区，程序员负责组织其上的所有数据。当然，他们很快建立了库来帮助解决这个问题。

我认为唯一使用平面文件（如 UNIX）的常见分层排列的操作系统是[PICK](http://en.wikipedia.org/wiki/Pick_operating_system)。它使用一种关系数据库作为文件系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T15:25:01.693

微软最初计划为 windows vista 引入一个新的文件系统（WinFS - windows future storage）。这个想法是将所有内容存储在关系数据库（SQL Server）中。据我所知，这个项目从未（或尚未？）完成。

[维基百科](http://en.wikipedia.org/wiki/WinFS)上有更多关于它的信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:25:58.900

我认识一个人，他的博士论文写了一个带有自己文件系统的硬盘。它基于 SCSI 命令的扩展，允许通常的打开、读取、写入和关闭命令直接发送到磁盘，绕过操作系统的文件系统驱动程序。我认为结论是它不灵活，并且不会增加多少效率。

无论如何，我相信这个基于磁盘的文件系统仍然有一个类似文件夹的结构，所以我认为它对你来说并不重要；-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T15:21:13.683

好吧，总是有[Pick](http://en.wikipedia.org/wiki/Pick_operating_system)，其中操作系统和文件系统是一个集成的数据库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T15:25:10.447

如果您知道所需文件的名称（包括其路径），则传统文件系统已针对快速文件访问进行了优化。目录是将文件组合在一起的一种方式，如果您知道文件的属性但不知道其实际名称，则更容易找到它们。

如果您对文件知之甚少，传统文件系统*并不擅长查找文件，但是它们足够强大，可以在它们之上添加一层以帮助基于内容或元信息（如标签）检索文件。*这就是索引器的用途。

底线是我们需要一种方法来持久存储 CPU 需要执行的字节。所以我们有传统的文件系统，它们非常擅长组织顺序的字节集。我们还需要持久存储不直接执行但被执行的东西使用的文件字节。为什么要为相同的基本事物创建一个新系统？

除了存储和检索字节之外，文件系统还应该做什么？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T15:28:05.853

我会回应其他回应。如果我可以选择一种文件系统类型，我个人更愿意看到一种混合方法：子树的平面数据库，其中每个子树都被视为一个内聚单元，但如果您将子树本身视为离散单元，它们将没有层次结构，但是相反，可以有元数据 + 可以在该元数据上查询。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-04T15:31:31.603

文件的原因是人们喜欢将名称附加到他们必须使用的“事物”上。否则，就很难谈论或思考甚至区分它们。

当堆上的东西太多时，我们喜欢将堆分开。我们通过某种方式对其进行排序，并且我们喜欢构建层次结构，您可以在其中导航任意大小的事物。

因此，目录和文件只是映射了我们处理真实对象的自然方式。因为您可以将任何内容放入文件中。在 Unix 上，甚至硬件也被映射为“设备节点”到文件系统中，这些文件系统是特殊文件，您可以读/写这些文件以向硬件发送命令。

我认为这个比喻是如此强大，它会留下来。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-04T15:33:27.387

我花了一段时间试图提出一个自动版本控制的文件系统，它可以维护任何特定文件和/或目录结构的版本（和版本历史）。

这个想法是所有标准访问命令（例如 dir、read 等）都将具有一个可选的日期/时间参数，当文件系统查看该时间点时，可以传递该参数以访问文件系统。

我已经走了很远，但是当我不得不真正出去赚钱时，我不得不放弃它。从那以后，它一直处于次要地位。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-04T15:34:00.663

如果您查看操作系统的启动时间，应该清楚可以改进访问磁盘。我不确定更改应该在文件系统中还是在操作系统启动代码中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T16:16:51.073

就个人而言，我真的很抱歉 WinFS 没有飞起来。我喜欢这个概念。来自维基百科（[http://en.wikipedia.org/wiki/WinFS](http://en.wikipedia.org/wiki/WinFS)）：

> WinFS 包括一个用于存储信息的关系数据库，并允许在其中存储任何类型的信息，只要该类型有明确定义的模式。然后可以通过关系将各个数据项关联在一起，这些关系要么由系统根据某些属性推断，要么由用户明确说明。由于数据具有明确定义的模式，因此任何应用程序都可以重用数据；并且使用这些关系，可以有效地组织和检索相关数据。因为系统知道信息的结构和意图，所以它可以用来进行复杂的查询，从而可以对数据进行高级搜索，并通过利用它们之间的关系来聚合各种数据项。

# perl - 如何使用 Perl 获取文件的大小（以兆字节为单位）？

> ID：511785
> 
> 赞同：14
> 
> 时间：2009-02-04T15:18:14.780
> 
> 标签：perl, file-io, filesize, magic-numbers

我想以兆字节为单位获取磁盘上文件的大小。使用`-s`运算符给了我以字节为单位的大小，但我假设将它除以一个幻数是一个坏主意：

```
my $size_in_mb = (-s $fh) / (1024 * 1024); 
```

我应该只使用只读变量来定义 1024 还是有一种编程方式来获取以千字节为单位的字节数？

**编辑：**更新了不正确的计算。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-04T18:25:22.563

如果您想避免使用幻数，请尝试使用 CPAN 模块[Number::Bytes::Human](http://search.cpan.org/perldoc?Number::Bytes::Human)。

```
use Number::Bytes::Human qw(format_bytes);
my $size = format_bytes(-s $file); # 4.5M 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-03-16T09:43:33.660

这是一个老问题，已经得到了正确的回答，但以防万一您的程序受限于核心模块并且您不能在这里使用[Number::Bytes::Human](http://search.cpan.org/~dagobert/Number-Bytes-Human/Human.pm)，随着时间的推移，我收集了其他几个选项。我也保留了它们，因为每个都使用不同的 Perl 方法，并且是[TIMTOWTDI](http://en.wiktionary.org/wiki/TIMTOWTDI)的一个很好的例子：

*   示例 1：使用 state 避免每次都重新初始化变量（在 perl 5.16 之前您需要使用 feature state 或 perl -E）

[http://kba49.wordpress.com/2013/02/17/format-file-sizes-human-readable-in-perl/](http://kba49.wordpress.com/2013/02/17/format-file-sizes-human-readable-in-perl/)

```
 sub formatSize {
        my $size = shift;
        my $exp = 0;

        state $units = [qw(B KB MB GB TB PB)];

        for (@$units) {
            last if $size < 1024;
            $size /= 1024;
            $exp++;
        }

        return wantarray ? ($size, $units->[$exp]) : sprintf("%.2f %s", $size, $units->[$exp]);
    } 
```

*   示例 2：使用排序映射

.

```
sub scaledbytes {

    # http://www.perlmonks.org/?node_id=378580
    (sort { length $a <=> length $b 
          } map { sprintf '%.3g%s', $_[0]/1024**$_->[1], $_->[0]
                }[" bytes"=>0]
                ,[KB=>1]
                ,[MB=>2]
                ,[GB=>3]
                ,[TB=>4]
                ,[PB=>5]
                ,[EB=>6]
    )[0]
  } 
```

*   示例 3：利用 1 Gb = 1024 Mb、1 Mb = 1024 Kb 和 1024 = 2 ** 10 的事实：

.

```
# http://www.perlmonks.org/?node_id=378544
my $kb = 1024 * 1024; # set to 1 Gb

my $mb = $kb >> 10;
my $gb = $mb >> 10;

print "$kb kb = $mb mb = $gb gb\n";
__END__
1048576 kb = 1024 mb = 1 gb 
```

*   示例 4：使用 of`++$n and ... until ..`获取数组的索引

.

```
# http://www.perlmonks.org/?node_id=378542
#! perl -slw
use strict;

sub scaleIt {
    my( $size, $n ) =( shift, 0 );
    ++$n and $size /= 1024 until $size < 1024;
    return sprintf "%.2f %s",
           $size, ( qw[ bytes KB MB GB ] )[ $n ];
}

my $size = -s $ARGV[ 0 ];

print "$ARGV[ 0 ]: ", scaleIt $size; 
```

即使您不能使用 Number::Bytes::Human，也请查看源代码以了解您需要注意的所有事项。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-05T16:18:18.790

您当然可以创建一个函数来计算它。这是比在这种情况下创建常量更好的解决方案。

```
sub size_in_mb {
    my $size_in_bytes = shift;
    return $size_in_bytes / (1024 * 1024);
} 
```

不需要常量。将 更改`1024`为某种变量/常量不会使此代码更具可读性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-04T15:19:44.043

嗯，一个兆不是 1024 个字节，一个 K 有 1024 个字节，一个兆是 1024 K...

也就是说，1024 是一个安全的“神奇”数字，在您可以期望程序运行的任何系统中都不会改变。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-04T15:34:03.687

我会将其读入变量而不是使用幻数。即使幻数不会改变，比如 1 MB 中的字节数，使用命名良好的常量也是一种很好的做法，因为它使您的代码更具可读性。它让其他人立即明白你的意图是什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T15:20:51.047

1）你不想要 1024。这给了你千字节。你想要 1024*1024 或 1048576。

2）为什么除以一个幻数是一个坏主意？它不像一兆字节中的字节数会永远改变。不要想太多事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T15:21:57.253

不要误会我的意思，但是：我认为将 1024 声明为魔术变量有点过分，这有点像“$ONE = 1; $TWO = 2;” 等等

20 多年来，一千字节被错误地声明为 1024 字节，我严重怀疑操作系统制造商是否会纠正该错误并将其更改为 1000。

不过，可能有意义的是声明不明显的东西，比如“$megabyte = 1024 * 1024”，因为它比 1048576 更具可读性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T15:26:07.260

由于 -s 运算符以字节为单位返回文件大小，因此您可能应该执行类似的操作

```
my $size_in_mb = (-s $fh) / (1024 * 1024); 
```

如果您需要一个圆形，请使用 int() 。这不像 KB 或 MB 的尺寸会在不久的将来随时改变 :)

# c# - 如何说服 VS2005 msi 升级？

> ID：511789
> 
> 赞同：6
> 
> 时间：2009-02-04T15:19:19.227
> 
> 标签：c#, visual-studio-2005, installation, windows-installer, upgrade

我有一个使用 VS2005 用 C# 编写的 Windows 服务。

安装是通过一个向导调用 msiexec 来安装同样使用 VS2005 创建的 msi 文件。

我无法生成将从一个版本的服务升级到另一个版本的 msi 文件。向导程序处理当前安装版本的检测、停止服务、为 msiexec 提供适当的命令行，然后重新启动服务。

现有 msi 的版本属性为 1.1.02，新的为 1.1.03。产品代码和升级代码相同。

通过添加/删除程序手动卸载 1.1.02 可以正常工作，就像将 1.1.03 安装到“干净”系统上一样。

将 1.1.02 升级到 1.1.03 经历了一些动作，但最终结果是安装了 1.1.02。

向导用于升级的命令行是：

msiexec /qb /i "MyProduct.msi" REINSTALL="ALL" REINSTALLMODE="vos"

我哪里错了？我假设我一定错过了一些相当基本的东西......

备用位置是通知客户他们需要在运行向导安装 1.1.03 之前手动卸载 1.1.02，但我宁愿不必这样做。

编辑添加：

更改产品代码（正如 VS2005 也会提示您）实际上完全消除了升级的能力，因为如果以前没有安装过该产品代码，安装程序将不允许您重新安装。

然后它会让你做的就是安装（然后你会得到通常的“服务已经存在”类型的消息）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T20:33:28.157

如果您想自动删除以前的版本，需要做几件事来获得“升级”以与 MSI 一起使用。

首先是一些关于神秘“代码”的背景信息。有 3 个代码 (GUID) 与 MSI 相关联：

1.  **包代码**- 这标识了 MSI 安装程序的特定版本，并且不应该在构建之间重复使用。它必须始终更新。
2.  **产品代码**- 此标识符用于标识应用程序的特定版本。何时分配新产品代码由安装程序作者决定。
3.  **升级代码**- 这标识了应用程序，不应在其生命周期内更改

*升级代码*永远不会改变。升级scenerio，必须更改每个版本的产品代码。此外，正如您所提到的，您必须提高版本号。产品*代码*和*升级代码*可以通过选择您的安装项目并转到属性窗口来找到。包*代码*隐藏在 Studio 中，并且将始终更新。

您可能缺少的项目是您还需要将属性窗口中的 RemovePreviousVersions 设置设置为*true*。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-10-02T15:45:04.133

除了 mohlsen 的回答（对于 Visual Studio 2008）之外，还有一件事：

为了让您的主输出（您的 EXE！）正确升级，您必须增加 FILE VERSION

此设置可在项目属性中找到：应用程序选项卡 -> 装配信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-25T20:51:56.150

一种更简单的管理方法是从所有程序集中删除 AssemblyFileVersion，包括主可执行文件和所有托管 DLL。

在您的每个 AssemblyInfo.cs 文件中，如果您不关心版本号，但希望有一些可追溯性，我建议您执行类似的操作。

```
[assembly: AssemblyVersion("1.1.*")]
// don't need this [assembly: AssemblyFileVersion("1.0.0.0")] 
```

一切仍然可以正常编译，如果您没有定义 AssemblyFileVersion，那么安装程序会假定每次都不同（如果您将所有 DLL 安装在主 EXE 旁边，这可能很好）。

我花了很长时间才弄清楚这一点，特别是如果我不想手动增加任何东西！

# .net - 在 WCF 中，数据协定类可以相互继承吗？

> ID：511793
> 
> 赞同：24
> 
> 时间：2009-02-04T15:19:38.337
> 
> 标签：.net, wcf, contract

在 WCF 服务中，我有两个具有 [DataContract] 属性的类。其中一个类与另一个类具有“is-a”关系 - 因此类 B 可以从类 A 继承。但是，当我在这两个类之间配置继承时，都用 [DataContract] 属性表示，元数据无法加载在测试服务时。

这在 WCF 中可能吗？我是否缺少另一个属性？

```
[DataContract]
public class A
{        
    [DataMember]
    public MyCustomType AValue1{ get; set; }

    [DataMember]
    public MyCustomType AValue2 { get; set; }
}

[DataContract]
public class B: A
{       
   [DataMember]
   public double BValue1{ get; set; }

   [DataMember]
   public double BValue2 { get; set; }
} 
```

注意：自定义类型也是使用数据协定定义的。

**更新**：以下是错误：

> 错误：无法从[http://localhost:8002/GISDataServices/mex](http://localhost:8002/GISDataServices/mex)获取元数据如果这是您有权访问的 Windows (R) Communication Foundation 服务，请检查您是否已在指定地址启用元数据发布。有关启用元数据发布的帮助，请参阅位于[http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata](http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata) Exchange 错误 URI：[http://localhost:8002/GISDataServices/mex](http://localhost:8002/GISDataServices/mex)的 MSDN 文档 元数据包含无法解析的引用：' [http://localhost:8002/GISDataServices/mex](http://localhost:8002/GISDataServices/mex) '。 `Receivera:InternalServiceFault`由于内部错误，服务器无法处理请求。有关错误的详细信息，请在服务器上打开 IncludeExceptionDetailInFaults（来自 ServiceBehaviorAttribute 或来自 <serviceDebug> 配置行为）以便将异常信息发送回客户端，或者根据 Microsoft .NET Framework 打开跟踪3.0 SDK 文档并检查服务器跟踪日志。HTTP GET 错误 URI：[http://localhost:8002/GISDataServices/mex](http://localhost:8002/GISDataServices/mex) 下载“ [http://localhost:8002/GISDataServices/mex](http://localhost:8002/GISDataServices/mex) ”时出错。请求失败，HTTP 状态为 400：错误请求。

**更新 2：**请参阅下面的答案。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-04T15:26:44.827

是的，但是您需要使用 [KnownTypeAttribute] 来装饰基类，并使用派生类的类型构造它。例如：

```
[DataContract]
[KnownType(typeof(B))]
public class A
{
   [DataMember]
   public string Value { get; set; }
}

[DataContract]
public class B : A
{
   [DataMember]
   public string OtherValue { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T16:23:13.793

好的，我想通了这个问题。答案是……我是个白痴。它与继承无关。在基类中，我有一个没有“set”属性条款的数据合同成员——只有一个“get”。啊！！！放入“设置”条款使其像魅力一样工作。

对困惑感到抱歉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T15:29:43.603

基于此测试，它应该可以正常工作。这两个类都有默认构造函数吗？您是否使用自动属性。注意，在这个基本示例中，属性不是必需的。此外，正如 David Morton 提到的，根据您要返回的元素，您可能需要 KnownType 属性，我不是 100%，但已知类型可能必须遵守操作合同。

```
class Program
{
    static void Main(string[] args)
    {
        var serializer = new DataContractSerializer(typeof(Employee));

        var employee = new Employee() { Name="Joe", Salary=100000  };
        using (var ms = new MemoryStream())
        {
            serializer.WriteObject(ms, employee);

            ms.Position = 0;

            var newEmployee = serializer.ReadObject(ms) as Employee;
        }

        Console.ReadKey();

    }
}

[DataContract]
public class Employee : Person
{
    [DataMember]
    public decimal Salary { get; set; }
}

[DataContract]
public class Person
{
    [DataMember]
    public string Name { get; set; }
}

[ServiceContract]
interface IEmployeeService
{
    [OperationContract]
    Person GetPerson();

    [OperationContract]
    Employee GetEmployee();

    [OperationContract]
    [KnownType(typeof(Employee))]
    Person GetEmployeeAsPerson();
} 
```

# .net - 归档平面文件的理想选择

> ID：511797
> 
> 赞同：2
> 
> 时间：2009-02-04T15:20:47.130
> 
> 标签：.net, sql-server-2005, backup, archive, space-efficiency

我们目前每周收到数千个平面文件，我有一个系统可以运行这些文件并将它们导出为 PDF 格式供我们的人员处理和参考。

我目前将这些批量加载到数据库中，确保所有字段/格式都有效，导出它们，并在下次运行时截断表。

我想知道的是，每个人都认为存储可能 6 个月的批量加载纯文本数据最节省空间的方式是什么？

无论是以日常 SQL 备份的形式，还是压缩档案的形式，或其他形式，所以我总是能够重新加载旧数据以进行故障排除。

欢迎任何想法，我愿意接受任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:28:33.450

使用最新一代的压缩实用程序（7z 和 rar 压缩很棒）并在组织所有内容后压缩成包，以便于查找。

有适用于 7zip 的 SDK 可与 .net 一起使用以简化此操作。

-亚当

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T15:33:34.797

因此，您批量加载原始数据的平面文件，使用 SQL Server 2005 处理它们并获得一组单独的已处理平面文件，然后转储数据？

好吧，如果这是正确的，SQL 备份将无济于事，因为您似乎在说数据不会保留在数据库中。您唯一的选择是有效压缩输入和/或输出文件，并在目录中很好地组织批处理。

我会推荐一个积极的压缩程序，它具有预定的批处理功能，但请注意不要对您使用的程序进行深奥，以免被锁定在一个程序中......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T16:03:49.760

数据后分析有两种类型：

*   原始数据（通常非常大）
*   派生数据（通常较小）

在您的情况下，派生数据可能是您报告中的数据。对于您的原始数据，我只需根据日期和数据类型制作一个带有系统名称的巨大压缩存档文件。这样做的价值在于，如果您团队中的某个新手以某种方式完全删除了将您的原始数据导入数据库的代码，您可以从中恢复。如果派生数据很小，您可能会考虑将其复制到另一个数据库表中，或者将其保存在单独的平面文件中，因为您的一些问题可以通过获取派生数据来解决。

备份数据通常是一个棘手的问题，因为它取决于以下内容：

*   数据吞吐量
*   用于异地备份的可用空间
*   升级备份系统的价值，而不是在出现问题时让自己重新生成数据。

你的设置是什么样的？硬盘驱动器的增长速度是否足以容纳压缩版本的数据？您是否考虑过异地备份？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T15:30:02.637

构建适当组织文件的文件层次结构，压缩整个目录，并使用`-u`zip 上的标志添加新文件。归档后，您可以删除文件，但保留目录结构以供下一批添加。

如果文件名以某种方式（日期或其他）对版本进行编码或以其他方式是唯一的，则它不需要比signle 目录更花哨的东西。如果没有，您需要设置目录以让您恢复版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T16:26:24.753

压缩它们并将它们保存在数据库中的二进制字段中。然后你可以建立一个“重新加载数据集”按钮来引入你的数据集（我假设你跟踪你导入的每个数据集来替换它，等等）

这样，所有内容都存储在数据库中，并与数据库一起备份，正确索引和链接，同时压缩。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T15:59:20.500

您已表明您希望避免使用 SDK 并在远程系统上安装软件。

你的选择非常有限。

既然你使用的是windows电脑，为什么不使用一个简单的脚本呢？

这个问题提供了几个关于如何使用windows VBscript 压缩和解压文件的建议：
[Windows 的内置 ZIP 压缩可以脚本化吗？](https://stackoverflow.com/questions/30211/windows-built-in-zip-compression-script-able)

无需“安装”，无需 SDK。只需复制脚本，通过调度程序调用它，一切就绪。

-亚当

# mysql - "SELECT COUNT(*)" 很慢，即使有 where 子句

> ID：511820
> 
> 赞同：52
> 
> 时间：2009-02-04T15:25:50.053
> 
> 标签：mysql, performance, optimization

我试图弄清楚如何在 MySQL 中优化一个非常慢的查询（我没有设计这个）：

```
SELECT COUNT(*) FROM change_event me WHERE change_event_id > '1212281603783391';
+----------+
| COUNT(*) |
+----------+
|  3224022 |
+----------+
1 row in set (1 min 0.16 sec) 
```

将其与完整计数进行比较：

```
select count(*) from change_event;
+----------+
| count(*) |
+----------+
|  6069102 |
+----------+
1 row in set (4.21 sec) 
```

解释语句在这里对我没有帮助：

```
 explain SELECT COUNT(*) FROM change_event me WHERE change_event_id > '1212281603783391'\G
*************************** 1\. row ***************************
           id: 1
  select_type: SIMPLE
        table: me
         type: range
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 8
          ref: NULL
         rows: 4120213
        Extra: Using where; Using index
1 row in set (0.00 sec) 
```

好的，它仍然认为它需要大约 400 万个条目才能计数，但我可以比这更快地计算文件中的行数！我不明白为什么 MySQL 花了这么长时间。

这是表定义：

```
CREATE TABLE `change_event` (
  `change_event_id` bigint(20) NOT NULL default '0',
  `timestamp` datetime NOT NULL,
  `change_type` enum('create','update','delete','noop') default NULL,
  `changed_object_type` enum('Brand','Broadcast','Episode','OnDemand') NOT NULL,
  `changed_object_id` varchar(255) default NULL,
  `changed_object_modified` datetime NOT NULL default '1000-01-01 00:00:00',
  `modified` datetime NOT NULL default '1000-01-01 00:00:00',
  `created` datetime NOT NULL default '1000-01-01 00:00:00',
  `pid` char(15) default NULL,
  `episode_pid` char(15) default NULL,
  `import_id` int(11) NOT NULL,
  `status` enum('success','failure') NOT NULL,
  `xml_diff` text,
  `node_digest` char(32) default NULL,
  PRIMARY KEY  (`change_event_id`),
  KEY `idx_change_events_changed_object_id` (`changed_object_id`),
  KEY `idx_change_events_episode_pid` (`episode_pid`),
  KEY `fk_import_id` (`import_id`),
  KEY `idx_change_event_timestamp_ce_id` (`timestamp`,`change_event_id`),
  KEY `idx_change_event_status` (`status`),
  CONSTRAINT `fk_change_event_import` FOREIGN KEY (`import_id`) REFERENCES `import` (`import_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 
```

版本：

```
$ mysql --version
mysql  Ver 14.12 Distrib 5.0.37, for pc-solaris2.8 (i386) using readline 5.0 
```

我有什么明显的遗漏吗？（是的，我已经尝试过“SELECT COUNT(change_event_id)”，但没有性能差异）。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-04T15:56:53.517

InnoDB 使用聚集的主键，因此主键与数据页中的行一起存储，而不是在单独的索引页中。为了进行范围扫描，您仍然必须扫描数据页中所有潜在的宽行；请注意，此表包含一个 TEXT 列。

我会尝试两件事：

1.  运行`optimize table`。这将确保数据页按排序顺序物理存储。可以想象，这可以加快对集群主键的范围扫描。
2.  仅在 change_event_id 列上创建一个额外的非主索引。这将在索引页中存储该列的副本，这样扫描速度会更快。创建它后，检查解释计划以确保它正在使用新索引。

（如果 change_event_id 列从零递增，您也可能希望将其设为*无符号）*

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-04T15:57:18.883

以下是我建议的几件事：

*   将列从“bigint”更改为“int unsigned”。您是否真的期望此表中有超过 42 亿条记录？如果没有，那么您就是在浪费超宽领域的空间（和时间）。MySQL 索引在较小的数据类型上更有效。

*   运行“ [OPTIMIZE TABLE](https://dev.mysql.com/doc/refman/5.1/en/optimize-table.html) ”命令，然后查看您的查询是否更快。

*   您还可以考虑根据 ID 字段[对表进行分区](https://dev.mysql.com/doc/refman/5.1/en/partitioning-types.html)，特别是如果较旧的记录（具有较低 ID 值）随着时间的推移变得不那么相关。分区表通常可以比一个巨大的未分区表更快地执行聚合查询。

* * *

编辑：

仔细观察这个表，它看起来像一个日志样式表，其中插入了行但从未修改过。

如果这是真的，那么您可能不需要 InnoDB 存储引擎提供的所有事务安全性，并且您可以[切换到 MyISAM](https://stackoverflow.com/a/6796566/2228771)，这在聚合查询上效率更高。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-04T15:43:20.003

我以前在使用 IP 地理定位数据库时遇到过这样的行为。通过一些记录，MySQL 从基于范围的查询的索引中获得任何优势的能力显然消失了。对于地理定位数据库，我们通过将数据分割成足够合理的块来处理它，以允许使用索引。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T15:42:00.397

检查您的索引的碎片化程度。在我的公司，我们有一个夜间导入流程，它会破坏我们的索引，并且随着时间的推移，它会对数据访问速度产生深远的影响。例如，我们有一个 SQL 过程，在对索引进行碎片整理后需要 3 分钟才能运行一天，但需要 2 小时才能运行。我们使用 SQL Server 2005 生病寻找可以在 MySQL 上检查的脚本。

更新：查看此链接：[http ://dev.mysql.com/doc/refman/5.0/en/innodb-file-defragmenting.html](http://dev.mysql.com/doc/refman/5.0/en/innodb-file-defragmenting.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:34:45.387

在该表上运行“ `analyze table_name`”-索引可能不再是最佳的。

您通常可以通过运行“ `show index from table_name`”来判断这一点。如果基数是，`NULL`那么您需要强制重新分析。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-07T20:20:40.947

MySQL 确实首先说“使用 where”，因为它确实需要从索引数据中读取所有记录/值来实际计算它们。借助 InnoDb，它还试图“抓住”那 4 百万个记录范围来计算它。

您可能需要尝试不同的事务隔离级别：[http ://dev.mysql.com/doc/refman/5.1/en/set-transaction.html#isolevel_read-uncommitted](http://dev.mysql.com/doc/refman/5.1/en/set-transaction.html#isolevel_read-uncommitted)

看看哪个更好。

使用 MyISAM 会很快，但使用密集的写入模型会导致锁定问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-27T23:32:49.613

为了使搜索更有效率，虽然我建议添加 index. 我将命令留给您再次尝试指标

```
CREATE INDEX ixid_1 ON change_event (change_event_id); 
```

并重复查询

```
SELECT COUNT(*) FROM change_event me WHERE change_event_id > '1212281603783391'; 
```

-JACR

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-04T15:49:15.547

我会创建一个“计数器”表并将“创建行”/“删除行”触发器添加到您正在计数的表中。触发器应在每次插入/删除时增加/减少“计数器”表上的计数值，因此您无需在每次需要它们时都计算它们。

您也可以通过缓存计数器在应用程序端完成此操作，但这将涉及在每次插入/删除时清除“计数器缓存”。

如需参考，请查看此[http://pure.rednoize.com/2007/04/03/mysql-performance-use-counter-tables/](http://pure.rednoize.com/2007/04/03/mysql-performance-use-counter-tables/)

# msbuild - MSBuild - 如何复制可能存在或不存在的文件？

> ID：511829
> 
> 赞同：28
> 
> 时间：2009-02-04T15:27:05.963
> 
> 标签：msbuild, copy

我有一种情况，我需要在 MSBuild 脚本中复制一些特定文件，但它们可能存在也可能不存在。如果它们不存在也没关系，那么我就不需要它们。但是，`<copy>`如果标准任务无法找到列表中的每一项，则会引发错误......

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-04T15:38:50.137

对复制任务使用**存在**条件。

```
<CreateItem Include="*.xml">
  <Output ItemName="ItemsThatNeedToBeCopied" TaskParameter="Include"/>
</CreateItem>

<Copy SourceFiles="@(ItemsThatNeedToBeCopied)"
      DestinationFolder="$(OutputDir)"
      Condition="Exists('%(RootDir)%(Directory)%(Filename)%(Extension)')"/> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T15:50:29.397

最简单的方法是使用 ContinueOnError 标志[http://msdn.microsoft.com/en-us/library/7z253716.aspx](http://msdn.microsoft.com/en-us/library/7z253716.aspx)

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <ItemGroup>
        <MySourceFiles Include="a.cs;b.cs;c.cs"/>
    </ItemGroup>

    <Target Name="CopyFiles">
        <Copy
            SourceFiles="@(MySourceFiles)"
            DestinationFolder="c:\MyProject\Destination"
            ContinueOnError="true"
        />
    </Target>

</Project> 
```

但是，如果有其他问题，您将不会注意到它。因此，madgnome 的答案存在的条件会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-25T16:53:42.100

看起来您可以将 MySourceFiles 标记为 SkipUnchangedFiles="true" 并且如果文件已经存在，它将不会复制它们。

# excel - 如何在 Excel 中制作生命游戏？

> ID：511835
> 
> 赞同：2
> 
> 时间：2009-02-04T15:28:41.827
> 
> 标签：excel, conways-game-of-life

我对如何在 Excel 中制作宏知之甚少。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T16:08:09.377

你可以通过谷歌找到很多例子。

第一个结果是来自 David Gainer 博客的一篇文章，该文章使用 Conway 的生命游戏来教授循环引用公式和迭代（不涉及 VBA）：

[http://blogs.office.com/2007/11/02/iteration-conways-game-of-life](http://blogs.office.com/2007/11/02/iteration-conways-game-of-life)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-08T22:49:39.053

很久以前就应该这样做，但这是我在 Excel 中的康威生活版本。

这是代码的hack。绝不是一个完美的解决方案（没有花时间在这上面），但你也许可以从中挑选出一些东西。

```
Private arrGrid(100, 100) As Boolean
Private arrGridNextGeneration(100, 100) As Boolean

Private Sub PopulateParentArrayData()

For k = 1 To Sheet1.Range("C2:AM20").Cells.Count

If Sheet1.Range("C2:AM20").Cells(k).Interior.Color = Sheet1.Range("A1").Interior.Color Then

    arrGrid(Sheet1.Range("C2:AM20").Cells(k).Row, Sheet1.Range("C2:AM20").Cells(k).Column) = True
Else
    arrGrid(Sheet1.Range("C2:AM20").Cells(k).Row, Sheet1.Range("C2:AM20").Cells(k).Column) = False
End If
DoEvents
Next
End Sub

Private Sub ApplyParentArrayData()

For k = 1 To Sheet1.Range("C2:AM20").Cells.Count

If arrGrid(Sheet1.Range("C2:AM20").Cells(k).Row, Sheet1.Range("C2:AM20").Cells(k).Column) Then

    Sheet1.Range("C2:AM20").Cells(k).Interior.Color = Sheet1.Range("A1").Interior.Color
Else
    Sheet1.Range("C2:AM20").Cells(k).Interior.Color = Sheet1.Range("B1").Interior.Color
End If
    DoEvents
Next

End Sub

Private Sub ApplyNextGenerationArrayData()

For k = 1 To Sheet1.Range("C2:AM20").Cells.Count

    If arrGridNextGeneration(Sheet1.Range("C2:AM20").Cells(k).Row, Sheet1.Range("C2:AM20").Cells(k).Column) Then

        Sheet1.Range("C2:AM20").Cells(k).Interior.Color = Sheet1.Range("A1").Interior.Color
    Else
        Sheet1.Range("C2:AM20").Cells(k).Interior.Color = Sheet1.Range("B1").Interior.Color
    End If
    DoEvents
Next

End Sub

Private Function GetNeighbourCount(ByVal pintRow As Integer, ByVal pintColumn As Integer) As Integer

Dim intCount As Integer

intCount = 0

For r = pintRow - 1 To pintRow + 1

For c = pintColumn - 1 To pintColumn + 1

If r <> pintRow Or c <> pintColumn Then
If arrGrid(r, c) Then

    intCount = intCount + 1
End If
End If
Next c
Next r

GetNeighbourCount = intCount

End Function

Private Sub PopulateNextGenerationArray()

Dim intNeighbours As Integer

For r = 0 To 100
For c = 0 To 100

If r > Sheet1.Range("C2:AM20").Rows(0).Row Then
If r <= Sheet1.Range("C2:AM20").Rows(Sheet1.Range("C2:AM20").Rows.Count).Row Then
If c > Sheet1.Range("C2:AM20").Columns(0).Column Then
If c <= Sheet1.Range("C2:AM20").Columns(Sheet1.Range("C2:AM20").Columns.Count).Column Then

 intNeighbours = GetNeighbourCount(r, c)
If arrGrid(r, c) Then
    'A1 cell
    If intNeighbours < 2 Or intNeighbours > 3 Then
        arrGridNextGeneration(r, c) = False
    Else
        arrGridNextGeneration(r, c) = True
    End If

Else
    'B1 cell
    If intNeighbours = 3 Then
        arrGridNextGeneration(r, c) = True
    Else
        arrGridNextGeneration(r, c) = False
    End If
End If
End If
End If
End If
End If
DoEvents
Next c
Next r

End Sub

Private Sub ActionLogic()

'Application.ScreenUpdating = False

PopulateParentArrayData
PopulateNextGenerationArray
ApplyNextGenerationArrayData

'Application.ScreenUpdating = True
End Sub 
```

要使其正常工作，只需将单元格 A1 的背景设为黑色，将单元格 B1 的背景设为白色，然后在 C2:AM20 范围内添加一些黑色背景并运行 ActionLogic 方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T15:45:59.857

您将需要两个宏。第一个应该格式化游戏表，使单元格是方形的。

让用户运行此宏。之后，她应该为每个活着的单元格输入一个 1。使用条件格式将单元格完全变黑（如果值！= 0，则背景 = 黑色）

现在有第二个宏，它计算背景表（另一张表）中的下一步。使用相对单元定位（相对于 ActiveCell）和两个嵌套循环。完成后，将所有值从背景表复制到游戏表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T15:36:27.537

搜索它并查看他们的代码。很多人都把用 Excel 制作完整的游戏作为一种爱好。

例如：[http ://www.geocities.jp/nchikada/pac/](http://www.geocities.jp/nchikada/pac/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-24T19:13:41.963

为什么说 Excel 是错误的选择？

我认为 Excel 是解决此问题的最佳方法：

Excel 用 1 行解决了这个问题： IF(OR(SUM(B2:D4)-C3=3,AND(SUM(B2:D4)-C3=2,C3=1)),1,0)

*以上是返回单元格 C3 的下一代值的表达式。

这是演示： [https ://docs.google.com/open?id=0B4FcWULw3iQidlZSdG9GRDh0TXM](https://docs.google.com/open?id=0B4FcWULw3iQidlZSdG9GRDh0TXM)

如果您必须从头开始实现这类事情，那么函数式编程是最好的选择。否则，Excel 工作得非常好。为什么？因为 Excel 是一个强制你只输入纯函数的系统。你看，模拟这个生命游戏的关键是要认识到细胞的每个状态都是前一个状态的 PURE FUNCTION。Excel 自然会迫使你这样想。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-05T02:42:14.167

另一个关于 excel 循环引用的教程可以在这里找到：[http ://chandoo.org/wp/2009/01/08/timestamps-excel-formula-help/](http://chandoo.org/wp/2009/01/08/timestamps-excel-formula-help/)

这个解释了如何使用循环引用插入时间戳。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-04T15:36:43.060

Excel 绝对是此类问题的错误选择。至于怎么可能：首先了解[生活游戏，](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)然后在 Excel 中使用[Visual Basic 。](http://en.wikipedia.org/wiki/Visual_Basic)

# ajax - Django 最好的 AJAX 库是什么？

> ID：511843
> 
> 赞同：108
> 
> 时间：2009-02-04T15:29:53.820
> 
> 标签：ajax, django

哪个 AJAX 库最适合 django，为什么？
寻找一个包含大量教程、书籍和详细文档的数据库。
哪一个最容易使用？哪一个处于早期开发阶段，但对未来有很大的希望？

问候，
克里斯

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-02-04T15:37:02.963

我强烈推荐[jQuery](http://www.jquery.com/)。有几个关于如何实现它的教程。

[http://lethain.com/entry/2007/dec/11/two-faced-django-part-5-jquery-ajax/](http://lethain.com/entry/2007/dec/11/two-faced-django-part-5-jquery-ajax/)

[http://lethain.com/entry/2007/dec/01/using-jquery-django-autocomplete-fields/](http://lethain.com/entry/2007/dec/01/using-jquery-django-autocomplete-fields/)

[http://vincentxu.net/minimal-ajax-in-django-with-jquery-post](http://vincentxu.net/minimal-ajax-in-django-with-jquery-post)

**注意：** Microsoft 不久前还宣布 jQuery 将成为 ASP.NET MVC 的官方客户端框架，因此无论您使用什么服务器端框架，了解它都很好。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2010-03-07T17:53:47.463

我认为这可能是您正在寻找的：[django-dajax](https://github.com/jorgebastida/django-dajax)

相当有据可查。简单的api。非常干净漂亮。我计划在我的一些项目中更多地使用它。它与 JS 库无关，如果您愿意，它可以与 jQuery 一起使用。

更新：

其他类似于 dajaxice 的解决方案，但不是标准的 dajax。

*   [https://github.com/joestump/django-ajax](https://github.com/joestump/django-ajax) - Joe Stump 的解决方案，让从模型创建安静的端点变得非常简单。
*   [https://bitbucket.org/jespern/django-piston/wiki/Home](https://bitbucket.org/jespern/django-piston/wiki/Home) - 类似的想法，但更强大一些。您可以为端点定义数据格式（xml 与 json 等）。
*   [https://github.com/toastdriven/django-tastypie](https://github.com/toastdriven/django-tastypie) - 与活塞类似，但我对美味派的运气更好。

最后，他们大多工作相同。

*   定义/包括一些预定义的 URL 路由。
*   注册将用作数据源的模型/视图/函数。
*   享受。

日期2：

这个建议非常古老。可能应该研究其他解决方案。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-04T18:11:18.083

Django 并没有让任何库更容易或更好地与框架一起工作。只需使用最适合您大脑的那个。

话虽如此，我的感觉是 jQuery 在 Django 世界中更受欢迎，并且是我个人使用的。最值得注意的是，[Pinax](http://pinaxproject.com/)中的许多应用程序都需要 jQuery。Django 的其他一些共享应用程序和代码片段：

[http://www.djangosnippets.org/tags/jquery/](http://www.djangosnippets.org/tags/jquery/)
[http://code.google.com/p/django-ajax-validation/](http://code.google.com/p/django-ajax-validation/)
[http://code.google.com/p/django-todo/](http://code.google.com/p/django-todo/)
[http: //code.google.com/p/donita/](http://code.google.com/p/donita/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-05T20:55:15.037

还要记住，最新的 Django 书籍（[Python Web Development with Django](https://rads.stackoverflow.com/amzn/click/com/0132356139)，[Learning Website Dev with Django](https://rads.stackoverflow.com/amzn/click/com/1847193358)）在他们的教程中使用了 jQuery。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-01-13T18:12:08.290

结帐[达贾克斯](https://github.com/jorgebastida/django-dajax)：

> **达贾克斯项目**
> 
> 易于使用的 Django AJAX 库
> 
> 在您的 django 项目中实现 AJAX 的快速、简单和轻量级的库。5 分钟后即可使用。
> 
> Dajax 是一个强大的工具，可以使用 Python 轻松、超快速地在 Web 应用程序中开发异步表示逻辑，并且几乎没有 JS 源代码行。
> 
> 它最多支持四种最流行的 JS 框架：Prototype、jQuery、Dojo 和 mootols。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-08-07T03:02:57.070

我已经在不同的 django 项目中成功使用了 jquery、YUI 和 Dojo。没有什么能让它更好地与 django 一起使用。我同意 jpartogy 的观点，仅仅因为“pythonic”（类似扭曲的）API，mochikit 可能比其他任何人都更适合 django。这实际上取决于您在 ajax 框架中寻找什么。

就我个人而言，我喜欢 jQuery 可以用给定数量的代码做的事情，但编写 jQuery 代码的最大挑战是使其可读。

YUI 比其他框架更冗长，因为它设置了使用命名空间的约定，但是有编写更少代码的快捷方式，它避免了试图让 javascript 看起来像别的东西。

Dojo 试图让 javascript 看起来像 Java，根据我的经验，它的速度非常慢。它有一些不错的小部件和 django 模板语言的 javascript 实现（即使在 django 项目之外也非常有用）。

我个人避免使用原型和 mootools，因为它们会破坏其他 javascript 代码（反之亦然）。

如果您不熟悉 javascript 和 ajax，我会推荐 jQuery，因为它最容易上手。但我不希望任何 js 框架与 django 集成，主要是因为确实没有必要这样做。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-05T09:48:58.203

+1 给 Soviut 和 Daniel 以获得好的答案。Jquery 是一个不错的框架。除了 Pinax 之外，还有一些其他“大”的 Django 应用程序使用它：[Satchmo](http://www.satchmoproject.com/)和[Review Board](http://www.review-board.org/)（从另一个框架切换过来...... mootools IIRC）。

同样流行的是在不使用任何框架的情况下滚动您自己的 Javascript，例如 Django 管理员。

我可能会提出的唯一其他建议是，如果您是一个非常有经验的 Pythonhead，那么您可能会喜欢[mochikit](http://www.mochikit.com/index.html)，因为它过于“pythonic”而受到一些批评。它似乎是 Turbogears 的首选框架，但我个人还没有看到任何 Django 项目使用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-22T01:16:20.083

好吧，这可能是主观的，因为“最佳”的定义可能对每个人都有不同的含义。但是由于您使用的是 Django，这意味着您将掌握 Python 语法。[Mochikit](http://www.mochikit.com/)是一个著名的没有暴露太多的 Javascript 库。它的好处是它具有 Python 程序员熟悉的语法（因为创建者是 Python 程序员）。它也很好地写下了文档。TurboGears 开箱即用支持 Mochikit。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-20T15:29:12.537

如果您需要在您的 django 项目中使用 AJAX，只需很少的设置且易于使用，我的建议是：

**django-ajax** ( [Github](https://github.com/yceruto/django-ajax) , [Pypi](https://pypi.python.org/pypi/abalt-django-ajax) )

用于 django 项目的快速、灵活且易于使用的 AJAX 库。包含 ajax 装饰器、ajax 中间件、快捷方式等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-07T10:13:09.027

“最佳 AJAX 库”这个短语是高度主观的，取决于个人喜好、现有技术、工作要求等。

虽然我喜欢 jQuery（几乎）所有东西，但我知道有些人对 Dojo 或 ExtJS 发誓。可能存在您想使用 jQuery 但要求可能要求您使用 ExtJS 的情况。

都说。使用 jQuery。jQuery 摇滚 ;)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-10T04:37:33.563

Django 并没有真正与客户端联系在一起。使用任何你觉得舒服的东西。Django 可以很好地处理该领域的所有内容，因为您只需在模板中编写它。

# java - Swing 中的进度对话框

> ID：511857
> 
> 赞同：4
> 
> 时间：2009-02-04T15:33:17.760
> 
> 标签：java, multithreading, swing

如何使`JDialog`没有按钮的模式出现在一个实例完成的持续时间内，`Runnable`并让该实例更新该对话框上的进度条/消息？

显然意大利面条代码可能会起作用，但如果存在的话，我正在寻找一种干净的设计。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T15:39:00.947

您可能想查看[ProgressMonitor](http://docs.oracle.com/javase/6/docs/api/javax/swing/ProgressMonitor.html)。如果操作时间过长，它会自动弹出一个带有进度条的对话框；请参阅[如何使用进度监视器](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-10T17:22:48.270

查看以下 URL 中描述的项目：http: [//digilander.libero.it/carlmila/compmon/main.html](http://digilander.libero.it/carlmila/compmon/main.html)

它是 Swing ProgressMonitor 的免费 Java 库替代品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T15:37:31.357

使用带有全局实例的监视器类，并且您的代码保持最新（我正在开始，我正在工作，我在 xxx%，我已经完成了）。

然后，监视器可以决定显示对话框并使其保持最新状态。稍后，您可以简单地将对话框替换为状态栏中的进度条。使用监视器的接口（方法：start()、update()、end()、error()、isAborted()），这样你也可以用其他东西替换它。

如果有 end() 并且在这种情况下不显示对话框等，您可以扩展监视器以在 start() 之后等待 500 毫秒，等等。

这就是[Eclipse](http://www.eclipse.org/)的工作方式，并且运行良好。

# windows - 禁用列表框的字体颜色

> ID：511866
> 
> 赞同：0
> 
> 时间：2009-02-04T15:35:15.840
> 
> 标签：windows, listview, colors, listbox

我想绘制一些禁用的列表视图项目，并想模仿禁用的标准 Windows 列表框的外观。它使用哪些颜色？[我在参考图表](http://blogs.msdn.com/oldnewthing/archive/2007/12/12/6648399.aspx):-) 或 Google中找不到任何内容。

**编辑：**发布后不久，我突然想到了 - 它似乎是 COLOR_GRAYTEXT。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T15:40:47.607

我想你可以禁用它，它会显示浏览器默认值，我猜 IE 使用与 Windows 相同的样式（如果不是，截图会很好..）

```
<select disabled/><option... 
```

像这样：禁用选择

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-09T14:10:26.663

我正在回答我自己的问题以便能够关闭该问题（即接受答案）。

禁用的 Windows 列表框在 COLOR_WINDOW 上的 clWindow/COLOR_GRAYTEXT 上绘制 clGrayText。

# unit-testing - 在 ASP.net MVC Beta 1 中进行测试

> ID：511870
> 
> 赞同：0
> 
> 时间：2009-02-04T15:35:40.953
> 
> 标签：unit-testing, controller, asp.net-mvc-beta1

我正在为控制器编写单元测试，这是我的代码。

```
public void DocumentController_IndexMethod_ShouldReturn_Documents()
    {
        DocumentsController c = new DocumentsController(_repository);

        ViewResult result = (ViewResult)c.Index("1");

        DocumentsController.DocumentsData data = (DocumentsController.DocumentsData)result.ViewData;

        Assert.IsNotNull(data.Documents);
        Assert.IsTrue(data.Documents.Count() > 0);

        Assert.IsNotNull(result);
    } 
```

我基本上跟随 Rob Conery 的 asp.net 店面应用程序，并意识到我不能使用 RenderView 方法。如图所示，我尝试了 ViewResult 方法来创建视图的实例。我收到此错误：错误 1 ​​无法将类型“System.Web.Mvc.ViewDataDictionary”转换为“HomeOwners.Controllers.DocumentsController.DocumentsData”C:\Documents and Settings\drmarshall\My Documents\Visual Studio 2008\Projects\HomeOwners \HomeOwners.Tests\DocumentsControllerTests.cs 61 54 HomeOwners.Tests

我是在使用正确的替换方法还是遗漏了什么？

我想到了。

```
[TestMethod]
    public void DocumentController_IndexMethod_ShouldReturn_Documents()
    {
        DocumentsController c = new DocumentsController(_repository);

        ViewResult result = c.Index("1") as ViewResult;

        ViewDataDictionary dictionary = result.ViewData;

        DocumentsController.DocumentsData data = (DocumentsController.DocumentsData)dictionary["Documents"];

        Assert.IsNotNull(data.Documents);
        Assert.IsTrue(data.Documents.Count() > 0);

        Assert.IsNotNull(result);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-04T15:27:00.320

[TestMethod] public void DocumentController_IndexMethod_ShouldReturn_Documents() { DocumentsController c = new DocumentsController(_repository);

```
 ViewResult result = c.Index("1") as ViewResult;

    ViewDataDictionary dictionary = result.ViewData;

    DocumentsController.DocumentsData data = (DocumentsController.DocumentsData)dictionary["Documents"];

    Assert.IsNotNull(data.Documents);
    Assert.IsTrue(data.Documents.Count() > 0);

    Assert.IsNotNull(result);
} 
```

# sql - 返回数据计算结果的 SQL 语法

> ID：511872
> 
> 赞同：0
> 
> 时间：2009-02-04T15:36:02.437
> 
> 标签：sql, sql-server-2005, tsql

我正在尝试对从 SQL Server 返回的一些数据执行简单的计算：

```
SELECT  val1X, val1Y, val2X, val2Y FROM myTable 
```

我希望能够根据返回的值计算以下内容并只返回一个值 - 下面的计算结果（这最初是用 VB6 编写的）：

```
 If IsNull(val1X) Or IsEmpty(val1X) Then val1X = 0
    If IsNull(val1Y) Or IsEmpty(val1Y) Then val1Y = 0
    If IsNull(val2X) Or IsEmpty(val2X) Then val2X = 0
    If IsNull(val2Y) Or IsEmpty(val2Y) Then val2Y = 0

    res1 = (val1X ^ 2) + (val1Y ^ 2)
    res2 = (val2X ^ 2) + (val2Y ^ 2)

    ResultVal = Sqr(IIf(res1 > res2, res1, res2)) 
```

只是想知道最好的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T15:50:27.133

您可以在 SQL 中的一条语句中完成所有操作，但它看起来有点难看，因为您必须重复块：

```
SELECT 
  CASE WHEN 
    /* res1 */ Power(IsNull(val1X, 0), 2) + Power(IsNull(val1Y, 0), 2) 
    > /* res2 */ Power(IsNull(val2X, 0), 2) + Power(IsNull(val2Y, 0), 2)
  THEN
    /* res1 */ Power(IsNull(val1X, 0), 2) + Power(IsNull(val1Y, 0), 2)
  ELSE
    /* res2 */ Power(IsNull(val2X, 0), 2) + Power(IsNull(val2Y, 0), 2)
  END
FROM
  myTable 
```

使用用户定义的函数来包装 Power(IsNull(field, 0), 2) 会更简洁一些，这样您就不会重复太多，但我将把它作为练习留给您去做。:)

# sql - 使用 GROUP BY/HAVING 重构子查询？

> ID：511873
> 
> 赞同：0
> 
> 时间：2009-02-04T15:36:17.320
> 
> 标签：sql, mysql, refactoring, query-optimization

我正在构建一个 MySQL 查询以确定在给定日期范围内出现的几个类别中的每个类别中有多少项目。我最初的尝试是这样的：

```
select Title, 
  (select count(*) from entries where CategoryID=1
    and Date >= @StartDate and Date <= @EndDate) as Cat1,
  (select count(*) from entries where CategoryID=2
   and Date >= @StartDate and Date <= @EndDate) as Cat2,
  (select count(*) from entries where CategoryID is null
   and Date >= @StartDate and Date <= @EndDate) as UnkownCategory
from entries
  where Date >= @StartDate and Date <= @EndDate 
```

该表非常大，我想重构查询以加快速度，但我不确定如何使用 GROUP BY/HAVING 语句重写它，还是有另一种我遗漏的方法？

**编辑**：示例结果集 - 像这样：

```
Title | Category 1 Total | Category 2 Total | Unknown Category Total
ABC     1                  3                  0
DEF     2                  7                  2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T16:02:32.837

```
select Title, SUM(CategoryID=1) as Cat1, SUM(categoryID=2) as Cat2,
SUM(categoryID IS NULL) as UnknownCategory
FROM entries
WHERE Date BETWEEN @StartDate AND @EndDate
GROUP BY Title 
```

您可以在 sum() 函数中粘贴表达式：真值等于 1，假值等于 0。我还使用了速度更快的 BETWEEN 运算符。

一种会返回不同结果布局但在概念上更简单的替代方案：

```
select Title, CategoryID, count(*)
from entries
WHERE Date BETWEEN @StartDate AND @EndDate
group by Title, CategoryID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T15:41:17.277

```
Select COUNT(*), sTitle, CategoryID FROM entries 
WHERE Date >= @StartDate and Date <= @EndDate 
GROUP BY CategoryID, sTitle 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T15:51:13.967

如何按类别 id 分组，然后使用 have 语句过滤掉特定类别，例如：

```
select CategoryID, count(*) 
from entries 
where Date >= @StartDate AND Date <= @EndDate
group by CategoryID
having CategoryID = 1 or CategoryID = 2 or CategoryID is null 
```

如果每个类别有多个标题，您可以按两个字段分组：

```
select Title, CategoryID, count(*) 
from entries 
where Date >= @StartDate AND Date <= @EndDate
group by Title, CategoryID
having CategoryID = 1 or CategoryID = 2 or CategoryID is null 
```

# .net - 在 IIS6 上发布 MVC 应用程序时出现问题

> ID：511881
> 
> 赞同：2
> 
> 时间：2009-02-04T15:37:21.967
> 
> 标签：.net, asp.net-mvc, visual-studio-2008, model-view-controller, iis-6

我有一个可以在本地运行的小型 MVC 应用程序，但是当我将它发布到服务器（运行 IIS6）时，所有链接都搞砸了。

例如，在本地运行时的典型链接是：

```
http://localhost:3467/Exceptions?exdate=20090108 
```

但是，当我将它发布到我们的开发服务器时`\\deverserver\apps\MyProject`，请注意同一链接的 URL 中的重复项：

```
http://devserver/apps/MyProject/MyProject/Exceptions?exdate=20090108 
```

知道发生了什么吗？

注意：这些链接都是通过`Html.ActionLink()`.

更新：如果我在我的项目中指定特定端口和虚拟路径，我可以在本地复制它 | 网站 | 使用 Visual Studio 开发服务器：

*   具体端口：1234
*   虚拟路径：/apps/MyProject
*   结果网址：`http://localhost:1234/apps/MyProject/MyProject/Exceptions?exdate=20090108`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T20:55:55.787

您是否执行了所有步骤[（此处）](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)以在 IIS6 中部署 MVC 应用程序？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T16:28:29.693

IIS 文件夹是否设置为应用程序？它应该在 IIS 资源管理器中有一个 cog 图标。

# sql-server-2008 - SQL 2008 报告服务身份验证

> ID：511885
> 
> 赞同：3
> 
> 时间：2009-02-04T15:38:00.933
> 
> 标签：sql-server-2008, authentication, reporting-services, ssrs-2008

在 SQL 2005 报告服务中，我们能够在调用报告时欺骗用户。这在 2008 年似乎不起作用，而且似乎相关的 technet 文章似乎暗示如果您想向 Internet 公开报告，则需要创建一个单独的安全扩展（ [Technet 文章）。](http://technet.microsoft.com/en-us/library/ms160724.aspx)这是人们在生产中使用的吗？还是这比我想象的要简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T18:27:12.857

不确定“欺骗用户”是什么意思。

迄今为止，每个版本的 SSRS 都使用 Windows 身份验证作为默认（实际上是唯一的“开箱即用”）身份验证方案。如果您想做表单身份验证，您总是必须编写自己的自定义身份验证模块。

根据情况，我在生产环境中都做过，他们的示例是开始构建您自己的自定义身份验证模块的好地方

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-14T11:13:32.807

简单的解决方案

1.  在 rsreportserver.config 中添加 Windows 基本身份验证：
2.  在同一台机器上安装 apache >= 2.2（为 ReportServer 使用 80 以外的其他端口）或另一台机器上
3.  激活 mod_prox_http
4.  为报告服务创建浏览器用户（例如，密码为“this@yourMachinepassw0rd”的“reportusr”）
5.  在 http.conf 中定义

    ProxyPass http:///ReportServer ProxyPassReverse http:///ReportServer AuthBasicFake reportusr this@yourMachinepassw0rd Order deny allow Allow from all

现在，您无需身份验证即可通过 apache Webserver 访问报表服务器和所有报表，因为 AuthBasicFake 用户始终使用 BasicAuthentication 连接到报表服务器

# c# - 当我使用不同的功能做完全相同的事情时，为什么我的文本框不会更新？

> ID：511893
> 
> 赞同：0
> 
> 时间：2009-02-04T15:40:27.513
> 
> 标签：c#, multithreading, class, delegates, invoke

我的文本框不会更新！我将它用作日志来更新其他正在做的事情......

**表格 1 代码：**

```
using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using System.IO;
using System.Data.OleDb;
using System.Collections.Specialized;
using System.Text;

delegate void logAdd(string message);

namespace LCR_ShepherdStaffupdater_1._0
{
    public partial class Main : Form
    {
        public Main()
        {
            InitializeComponent(); 
        }

        public void logAdd(string message)
        {
            this.Log.Items.Add(message); // Doesnt add to textbox

            this.Log.Items.Add("This won't update the textbox!!! Why?"); // Doesnt add to textbox
        }

        private void exitProgramToolStripMenuItem_Click(object sender, EventArgs e) 
        {
            Application.Exit(); 
        }
        private void aboutToolStripMenuItem1_Click(object sender, EventArgs e)
        {
            Form aboutBox = new AboutBox1(); 
            aboutBox.ShowDialog(); 
        }

        private void settingsToolStripMenuItem_Click(object sender, EventArgs e)
        {
        }

        private void settingsToolStripMenuItem1_Click(object sender, EventArgs e)
        {
            settingsForm.settings.ShowDialog();
        }

        private void synchronize_Click(object sender, EventArgs e)
        {
            this.Log.Items.Add("This WILL update the textbox. It is exactly the same as the other one..."); // This will add to the textbox
            DatabaseHandling.createDataSet();
        }

    }

    public class settingsForm 
    {
        public static Form settings = new Settings();
    }

} 
```

**我的日志记录类代码：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace LCR_ShepherdStaffupdater_1._0
{
    public class Logging
    {
        static Main mainClass = new Main();
        static logAdd logAddDelegate;

        public static void updateLog(string message)
        {
            logAddDelegate = mainClass.logAdd;
            logAddDelegate(message);
        }
    }
} 
```

我完全被难住了......有谁知道我可以如何修复 logAdd 函数，以便我可以让我的文本框日志最终更新？

**编辑：**

我终于让它工作了，这里是修复：

**Form1 代码**

```
using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using System.IO;
using System.Data.OleDb;
using System.Collections.Specialized;
using System.Text;

delegate void logAdd(string message);

namespace LCR_ShepherdStaffupdater_1._0
{
    public partial class Main : Form
    {
        public Main()
        {
            InitializeComponent(); 
        }

        public void add(string message)
        {
            this.Log.Items.Add(message);
        }
        public void logAdd(string message)
        {
            Log.Invoke(new logAdd(add), new object[] { message });
        }

        private void exitProgramToolStripMenuItem_Click(object sender, EventArgs e) 
        {
            Application.Exit(); 
        }
        private void aboutToolStripMenuItem1_Click(object sender, EventArgs e)
        {
            Form aboutBox = new AboutBox1(); 
            aboutBox.ShowDialog(); 
        }

        private void settingsToolStripMenuItem_Click(object sender, EventArgs e)
        {
        }

        private void settingsToolStripMenuItem1_Click(object sender, EventArgs e)
        {
            settingsForm.settings.ShowDialog();
        }

        private void synchronize_Click(object sender, EventArgs e)
        {
            logAdd("this works");
        }

    }

    public class settingsForm 
    {
        public static Form settings = new Settings();
    }

} 
```

**记录代码：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
namespace LCR_ShepherdStaffupdater_1._0
{
    public class Logging
    {
        static Main mainClass = new Main();
        static logAdd logAddDelegate;

        public static void updateLog(string message)
        {
            logAddDelegate = mainClass.logAdd;
            logAddDelegate(message);
        }
    }
} 
```

嗯......我可以说这是一种非常糟糕的方法......但直到我找到一个真正的修复，只要它工作我很高兴。谢谢你们的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T15:49:00.290

从您发布的代码中，您的静态 Logger 类正在创建 Main 表单的新实例。这与您在 UI 上运行的不同。

总的来说，这不是一个很好的设计模式。如果您希望我详细说明并提供示例，请写评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T15:47:42.507

你从哪个线程调用`Logging.updateLog()`？如果不是 UI 线程，我可以看到 TextBox 在这种情况下不会更新。如果您尝试调用`logAdd()`from `synchronize_Click()`（假设这是根据名称从 UI 线程调用的），那么它可以工作吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T15:59:53.510

synchronize_click 在正在运行的主窗体的实例上运行。logadd 函数在您在日志记录代码中创建的单独主窗体上运行。为此，您需要将现有的主表单传递到日志代码中，以便它更新您可以看到的文本框，而不是您看不到的额外文本框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T15:47:10.917

我以前也遇到过类似的问题，`.Invalidate()`写完后在文本框上调用就解决了。

您还可以通过以下方式检查您的消息是否实际到达文本框：

```
debug.WriteLine( this.Log.Items( this.Log.Items.Count-1)); 
```

希望对您有所帮助。

# .net - LINQ to Entities 并创建实体的新实例

> ID：511894
> 
> 赞同：0
> 
> 时间：2009-02-04T15:40:43.940
> 
> 标签：.net, linq, ado.net, linq-to-entities, wcf-data-services

我正在尝试在我们的应用程序中创建客户实体的新实例，但遇到了一些问题。这个实体有几个导航属性，每个都有自己的导航。特性。例如，每个客户实体都有一个地址实体，每个地址实体都有一个电话号码实体等。我还没有弄清楚如何为所有这些实体获取新数据集。我尝试了以下方法：

```
context.Customers newCustomer = context.Customers.CreateCustomer(...);
newCustomer.FirstName = firstNameTextBox.Text;
newCustomer.Address.Street = streetTextBox.Text;   // this is where the error is thrown 
```

此时，我收到“对象引用未设置为对象的实例”错误，因为地址为空。我最初假设创建新的客户实体会自动为与之相关的每个实体创建一个新实例，但事实并非如此。有人可以提供一个代码示例来说明这应该如何工作吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T16:50:04.220

First, I would be remiss if I didn't note that an address is a value type; it doesn't have identity, and should not be an entity. The Entity Framework supports such types via the complex types feature. Unfortunately, the Entity Framework designer has zero support for this (**Edit:** Fixed in VS 2010), so the only way to use the feature is to edit the EDMX manually. As it happens, Address is the type used in most of examples, see you might want to consider this.

Nevertheless, I will actually answer the question you asked.

The simple solution would be:

```
newCustomer.Address = new Address()
    {
        Street = streetTextBox.Text,
        // etc.
    }; 
```

However, since Address is really a value type (in other words, two customers with the exact same street address should probably point to the same Address object), you may want to try and select an existing Address object from the context before you just go and new up a new one.

```
newCustomer.Address = (from Addresses in context where ...).FirstOrDefault();
if (newCustomer.Address == null)
{
    newCustomer.Address = new Address()
        {
            Street = streetTextBox.Text,
            // etc.
        };
} 
```

# key - 使用公钥示例签署 XML？

> ID：511898
> 
> 赞同：0
> 
> 时间：2009-02-04T15:41:57.400
> 
> 标签：key, private, public, saml, signedxml

我正在努力实施 SAML 服务。因此，我认为身份提供者应该使用服务提供者的公钥对 SAML 断言进行数字签名，然后再将断言发送给服务提供者（服务提供者使用他们的私钥进行验证）。但是，我很难找到任何使用 SignXML 对象（在 C# 中）使用公钥进行签名的示例。所有示例都使用私钥进行签名。

任何示例或建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T04:03:04.157

否 - 正确的行为是身份提供者使用自己的私钥签名，服务提供者使用身份提供者的公钥进行验证。

# apache-flex - 从 actionscript 调用自定义组件中的 mxml setter 方法

> ID：511902
> 
> 赞同：1
> 
> 时间：2009-02-04T15:43:49.877
> 
> 标签：apache-flex, actionscript-3

我试图从动作脚本类中调用我的自定义组件的动作脚本块中的设置器方法。

当它是我想通过使用调用的主要应用程序时，我可以做到这一点；

```
Application.application.methodName(); 
```

但是如何从自定义组件调用方法？我的组件在我的组件包中，我正在尝试以下操作

```
components.customComponent.methodName() 
```

但是它没有发生，有什么想法吗？

* * *

我的自定义组件的一个实例调用了 actionscript 类，所以我不想在 actionscript 中再次实例化自定义类，我只想调用一个 setter 方法......

还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T16:29:32.733

您不必将方法设为静态；这样做可能没用，因为您希望方法调用对组件的当前状态做一些事情，我猜——使用它的一些数据，改变它的外观等。你真正需要的是一个对象引用.

由于 Application.application 位于传说中的显示列表的顶部（或实际上非常接近顶部），因此您应该能够通过从该点开始然后[遍历显示列表](http://livedocs.adobe.com/flex/3/html/help.html?content=05_Display_Programming_09.html)来访问每个组件- 直到最终到达您的嵌套组件，调用其公开定义的方法。

然而，我必须说（非常尊重！）你正在冒险进入危险的 OO 水域，在这里。:) 做到这一点的正确方法实际上是想办法将自定义组件的引用传递给需要访问它的 ActionScript 类——例如，在你的 MXML 中：

```
<mx:Script>
    <![CDATA[

        private function this_creationComplete(event:Event):void
        {
            var yourObject:YourClass = new YourClass(yourCustomComponent);
        }

    ]]>
</mx:Script>

<components:YourCustomComponent id="yourCustomComponent" /> 
```

...然后在您的 ActionScript 类中：

```
public class YourClass
{
    private var componentReference:YourCustomComponent;

    public function YourClass(component:YourCustomComponent)
    {
        this.componentReference = componentReference;
    }

    private function yourMethod():void
    {
        this.componentReference.someMethodDefinedInYourComponent();
    }
} 
```

像这样的方法可能会更好地为您服务。是否有意义？我会留意我们的评论；回帖，我会尽我所能帮助你度过难关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T15:51:01.220

以这种方式引用组件需要方法是静态的。

如果要调用组件实例上的方法，请为其分配一个 ID，然后从定义该组件的视图中调用它。

```
<!-- component declaration -->
<comps:MyComponent id="myComp"/>

// inside a script block
myComp.mySetter(someObj) 
```

顺便说一句，ActionScript 中的“setter 方法”是使用以下语法定义的：

```
public function set myProperty(varName : String) : void { ... } 
```

它可以被“称为：”，就像你设置一个属性值一样：

```
myComp.mySetter = myObj; 
```

在许多其他语言中，除了命名约定之外，“setter 方法”就像任何其他方法一样。值得理解的是，AS3 中真正的 setter 方法是不同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T15:52:48.737

您需要确保您有对该组件的实例的引用，您试图从该实例中调用它。因此，在下面的示例中，您可以看到我在 A 类的构造函数中创建了 B 的实例。所以现在我有了 B 的实例。现在我可以从该实例调用 b.someMethod()

```
public class A
{
   public function A()
   {
      var b : B = new B();
      b.someMethod();
   }
}

public class B
{
   public function B()
   {
   }

   public function someMethod() : void
   {

   }
} 
```

您可以将 A 类视为您的 Application.mxml，将 B 类视为您的自定义组件。因此，无论您尝试调用它，都需要确保您的组件已创建。

# algorithm - 为 ipv6 实现最长前缀匹配的最佳方法是什么？

> ID：511903
> 
> 赞同：5
> 
> 时间：2009-02-04T15:43:51.517
> 
> 标签：algorithm, ipv6

ipv6 路由器将许多路由存储为`n`地址的第一位。2000 年，研究人员在 1500 条 ipv6 路由中仅发现了 14 个不同的前缀长度。传入数据包根据最长前缀匹配路由到不同的传出端口，因此如果数据包 x 的前 8 位匹配 8 位路由，但同一数据包的前 48 位匹配 48 位路由，则路由器必须选择48 位路由。

我的路由器正在处理如此多的数据包，以至于内存查找路由表的速度是一个限制因素。在我的路由表中找到最长匹配前缀的好算法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T19:00:13.303

使用[trie](http://en.wikipedia.org/wiki/Trie)或[基数树](http://en.wikipedia.org/wiki/Radix_tree)来存储“标准”前缀。后缀树/数组是不必要的过度杀戮；它们用于查找中**缀**之间的匹配（使用任何中缀都是后缀的前缀这一事实，如果您想在多个字符串之间找到匹配，请将它们相互连接），而不仅仅是在前缀之间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T20:56:12.847

我发现了[一篇关于这个主题的很酷](http://www.google.com/patents/US20100098081)的论文，叫做[Longest Prefix Matching using Bloom Filters](http://citeseer.ist.psu.edu/old/dharmapurikar00longest.html)。

> **摘要：**我们介绍了我们知道的第一个算法，它使用 Bloom 过滤器进行最长前缀匹配 (LPM)。该算法对布隆过滤器（一种用于成员查询的有效数据结构）执行并行查询，以确定按前缀长度排序的前缀集中的地址前缀成员资格。我们表明，将这种算法用于 Internet 协议 (IP) 路由查找会导致搜索引擎提供比基于 TCAM 的方法更好的性能和可扩展性。

他们的基本想法是使用存储在处理器的嵌入式 SRAM（快速）中的布隆过滤器来指导在较慢但更充足的内存中查找前缀哈希表。对于 IPv4 情况，他们调整算法以解释大多数路由表前缀都是 24 位的事实。对于 IPv6，他们在 1550 个 BGP 条目中仅发现 14 个唯一前缀长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:06:09.863

我相信通常计算最长公共前缀的最有效方法是[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)或[后缀数组](http://en.wikipedia.org/wiki/Suffix_array)（运行时与预处理后的前缀长度成线性关系）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T21:38:20.990

你有多余的内存吗？

做一个这样的结构：

```
typedef struct node {
  struct node* table[256];
  Port_type port;
} Node;
Node* root[256]; 
```

现在您可以像这样进行查找：

```
Node* table = root;
for (i=0; table != NULL; i++)
{
   node = table[address_byte[i]];
   table = node->table;
}
destination = node->port; 
```

# security - web应用攻击，必须有防御方法

> ID：511907
> 
> 赞同：6
> 
> 时间：2009-02-04T15:45:15.570
> 
> 标签：security, web-applications, defensive-programming

**对于XSS**、**Sql Injection**、**Denial of Service**等常见的Web 攻击，您必须具备哪些防御方法？

**编辑：我根据**[维基百科](http://en.wikipedia.org/)的描述收集了您的回复。我添加了一些额外的问题以获得完整的参考。

> **Sql 注入**
> 
> SQL 注入是一种代码注入技术，它利用应用程序数据库层中出现的安全漏洞。当用户输入被错误地过滤为嵌入在 SQL 语句中的字符串文字转义字符或用户输入不是强类型并因此意外执行时，就会出现此漏洞。它是一类更普遍的漏洞的一个实例，只要将一种编程或脚本语言嵌入到另一种中，就会发生这种漏洞。

*   不要相信用户输入并尽早验证它。
*   不要从原始用户输入构建 SQL，而是使用参数。

> **跨站脚本 (XSS)**
> 
> 跨站脚本是一种通常在 Web 应用程序中发现的计算机安全漏洞，它允许恶意 Web 用户将代码注入到其他用户查看的网页中。此类代码的示例包括 HTML 代码和客户端脚本。攻击者可以利用被利用的跨站脚本漏洞绕过同源策略等访问控制。

*   切勿逐字输出或执行用户提交的内容。
*   HTML 编码所有输出。

> **拒绝服务攻击**
> 
> 拒绝服务攻击（DoS 攻击）或分布式拒绝服务攻击（DDoS 攻击）是试图使其目标用户无法使用计算机资源。尽管 DoS 攻击的实施方式、动机和目标可能会有所不同，但它通常包括一个或多个人为阻止 Internet 站点或服务有效运行或完全暂时或无限期地运行而做出的恶意努力.

我知道以编程方式避免拒绝服务攻击似乎是不可能的，但你怎么看？

> **蛮力攻击**
> 
> 在密码分析中，蛮力攻击是一种通过系统地尝试大量可能性来击败密码方案的方法。例如，密钥空间中的大量可能密钥用于解密消息。在大多数方案中，暴力攻击的理论可能性是公认的，但它的设置方式使得它在计算上不可行。

*   每当登录尝试出错时锁定帐户。永远不允许无限制的重试。
*   当输入的密码错误时添加延迟。

**一些额外的问题：**

*   您如何看待尝试根据您的内容发布输入的网络机器人？例如，SO 正在使用图像验证。

*   您如何看待 javascript **eval**函数？

*   有没有办法访问服务器上未暴露于外部的内容。例如，我有一个向我的数据库插入一些重要记录的页面，只有我知道它的 url。有没有办法获得这种文件？我知道你可以设置一些安全规则。

（**注意：**目录列表已禁用，我托管此文件。）

感谢您的回复！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T15:57:26.667

你的问题涉及的范围很广。我会尽力给你一些指示。如果您更清楚地说明您的问题，我可以给您一些更具体的信息。

1.  **永远不要**相信用户输入。可以从外部操作的进入应用程序的所有内容都必须经过验证。
2.  **切勿**在数据库中以纯文本形式存储密码。仅存储哈希（加盐）。计算用户提供的密码的哈希值并比较哈希值。
3.  **每当登录尝试出错时**锁定帐户。**永远不允许无限制的重试。**
***   使用产品或框架时，请始终关注这些产品的邮件列表并**识别安全问题**。当您的底层框架存在安全漏洞时，请准备好升级计划。*   使用数据库时不要让每个人都可以完全访问数据库（即使您使用存储过程限制对数据库的访问）。如果某人只需要读取某些数据，请不要使用同样可以修改数据的 SQL 帐户。*   关于您的问题：“*有没有办法访问服务器上未暴露于外部的内容。例如，我有一个页面将一些重要记录插入到我的数据库中，只有我知道它的 url。有没有办法得到这种文件？我知道你可以设置一些安全规则*。
    您可能会认为某人无法访问您的页面只是因为他们不知道 URL。这是**通过默默无闻的安全性**，从长远来看永远不会奏效。Google 索引蜘蛛只会尝试遍历您的整个站点并索引它可以访问的每个页面。如果您有包含敏感信息的页面，请添加身份验证和授权机制。**

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T15:49:23.610

对于 XSS 和 SQL 注入：从不逐字输出或执行用户提交的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T17:10:51.903

*   尽早验证*一切。*
*   不要从原始用户输入构建 SQL，而是使用参数。
*   HTML 编码*所有*输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T16:01:03.900

我们使用名为 fortify 的工具来扫描我们的软件[http://www.fortify.com/](http://www.fortify.com/)（对不起，商业产品，但也许还有更多）

它捕获未经验证的用户输入、字符串连接而不是参数等等。

只需尝试此产品，您就可以学习如何安全地编程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T15:46:57.547

验证！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T15:47:40.773

最重要的是防止密码的暴力破解。这很简单，只需在输入的密码错误时添加延迟即可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-06T16:14:58.253

> 您如何看待尝试根据您的内容发布输入的网络机器人？例如，SO 正在使用图像验证。

图像验证称为 CAPTCHA。它可以防止自动机器人填写表格，并有助于验证人类是否确实在提交表格。这些通常用于您想要控制对表单的访问的任何地方。垃圾邮件机器人将尝试填写联系表格以绕过垃圾邮件过滤器，因此您可能需要对此类内容添加一些保护。在大多数情况下，表单滥用很少，但在某些情况下您会看到它。

> 您如何看待 javascript eval 函数？

这取决于你如何使用它。像其他任何事情一样，不要相信用户输入。如果您要通过 eval() 运行他们的输入，请确保它首先通过一个体面的卫生过程。如果您将他们的输入存储在数据库中并将其拉回显示以供其他用户查看，则这一点非常重要。这适用于 SQL、HTML 和 JavaScript。如果有人可以在对您的网站如何工作有足够了解的情况下执行 JS 代码，他们就可以做各种疯狂的事情并模仿登录的用户、更改他们的密码等。

> 有没有办法访问服务器上没有暴露在外面的内容？

正如其他人提到的，这将是通过默默无闻的安全性，不推荐。任何敏感的东西都需要放在安全的登录区域后面。不要只依赖“隐藏的 URL”。如果有人猜到了您的特殊 URL，或者它最终出现在 Google 可以访问的日志文件中，您可能永远不知道是否有人设法进入。围绕类似的东西进行一些身份验证。

# .net - 如何根据某些值计算组记录？

> ID：511909
> 
> 赞同：0
> 
> 时间：2009-02-04T15:45:23.137
> 
> 标签：.net, crystal-reports

我有一份报告，分为一组组，其中一组按“状态”分组。状态值为：S、R、V。

我需要创建两个总字段来获得 1- S 和 V 记录计数。2- R 记录计数。

有什么建议么？

仅供参考：我使用嵌入 VisualStudio.NET 2005 的 CrystalReport 设计器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T02:02:26.230

我通过使用运行总计来做到这一点。将仅选择适当记录的公式放入运行总计的评估选项中。您将有两个运行总计 - 一个用于 S 和 V 记录，另一个用于 R 记录。

# xcode - SVN 和 Xcode 的困境

> ID：511913
> 
> 赞同：4
> 
> 时间：2009-02-04T15:46:29.700
> 
> 标签：xcode, svn, version-control

我反复听说 Xcode 与 SVN 的集成缺乏，但看到我个人从未使用过它，我不禁想知道为什么。

现在我开始了一个新项目，SCM 又一次出现了。不过，这一次，我想我想更好地了解 Xcode 对 SVN 的作用和不正确的地方。

那么，有什么恐怖故事吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T17:10:05.053

完全没有回答你的问题，但是......

我是 Versions (www.versionsapp.com) 的忠实粉丝，它让我对任何 Xcode 与 SVN 的集成毫不关心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-29T12:47:15.450

没有可怕的故事：我已经使用 Xcode 3.1.2 和 SVN 快一年了，它已经足够好了。Xcode SCM（源代码控制管理器）非常基础，但很稳定。它唯一做得不好的是删除文件。

当你删除一个文件时，Xcode 也会提供从版本控制中删除该文件，但是当它提交时它会抱怨文件丢失。所以我通常从终端执行“svn rm”来删除文件，而不是从 Xcode 文件和组面板中删除它。如果我忘记了并且 svn 一直在大惊小怪，'svn cleanup' 通常会解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-29T12:53:11.660

它不会在提交或签出时显示您的进度。此外，如果存在项目文件冲突，那么您可以选择保留它或替换为最新副本。无论哪种方式，某人的更改都会丢失。

除了 SVN 集成非常有用 - 我们依赖它几个月。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-29T13:04:29.503

就个人而言，与我合作过的开发人员团队从不后悔切换`svn`到`git`（抱歉，Stack Overflow 不允许我输入链接）或`bzr`（[http://www.bazaar-vcs.org/](http://www.bazaar-vcs.org/)）。您可能会研究它们，尽管我对 Xcode 集成知之甚少。（我认识的每个人都是命令行迷——或者在 Windows 上使用过 TortiseBZR 等。）

# c# - 在 Model View Presenter 模式中，一个 Presenter 可以同时使用两个不同的视图界面吗？

> ID：511915
> 
> 赞同：2
> 
> 时间：2009-02-04T15:46:48.453
> 
> 标签：c#, design-patterns, model-view-controller, mvp

我很好奇你有一个用户控件想要在整个应用程序中重用的情况，但你也有一个页面或其他控件也需要演示者。

所以说我有一个上传视图和控制

```
public partial class UploadControlView : System.Web.UI.UserControl, IUploadView 
```

但我也有页面视图

```
public partial class ExcelProcessorView : System.Web.UI.Page, IExcelProcessorView 
```

上传控件将在 ExcelProcessor 页面上，以便用户可以上传文件，该文件被移交给一些 excel 处理业务逻辑。

所以我有一个主持人，

```
public class ExcelUploadAndProcessPresenter : IUploadPresenter 
```

在 ExcelProcessorView 中，我将按如下方式连接演示者：

```
protected void Page_Load(object sender, EventArgs e) 
    {
        ExcelUploadAndProcessorPresenter presenter = 
            new ExcelUploadAndProcessorPresenter(this, uploadControl);
        this.AttachPresenter(presenter);
        uploadControl.AttachPresenter(presenter);
        //init etc...
    } 
```

这是对 MVP 模式的正确使用吗？

我试图弄清楚处理一个演示者关系的多个视图的最佳实践是什么。MVP 能否以这种方式建立多对一关系。作为另一个问题，我还想知道 MVP 模式是否可以/应该处理您有许多演示者和许多视图（或者您应该只有一个演示者）的情况？

如果您发现我对 MVP 的总体解释有任何问题，请务必指出这一点。

谢谢阅读！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T18:01:31.567

您能否进一步解释您的视图和控件如何使用相同的逻辑？我无法想象我会遇到这个问题的场景。如果逻辑是分开的，我想你会使用两个演示者。

然而，没有理由一个演示者不能处理多个视图/控件，尽管我只会将演示者重用于显示相同模型的多个视图（例如 CRUD 屏幕）。如果一个视图托管来自同一个演示者的另一个视图，我想不出你*不应该*重用演示者的原因（例如，在列表屏幕底部创建屏幕）。

# php - 执行数据库约束：代码与 sql

> ID：511916
> 
> 赞同：0
> 
> 时间：2009-02-04T15:46:56.127
> 
> 标签：php, sql, postgresql

[这是对这个问题](https://stackoverflow.com/questions/510461/validating-data-in-database-sql-vs-code)的跟进。

这是我的架构

```
CREATE TABLE A(
     id serial NOT NULL,
     date timestamp without time zone,
     type text,
     sub_type text,
     filename text,
     filepath text,
     filesize integer,
     lock_status int
 ); 
```

在此数据库中，只要未设置“lock_status”，用户就可以更新类型、子类型、文件名、文件路径、文件大小。

因此，在网页代码 (php) 中，我可以在更新项目之前检查 lock_status。

但是，可能存在其他用户在第一个用户检查和更新之间的时间内更新了锁定状态的情况。

那么，SQL 中有没有办法在行更新之前检查锁定状态？

*   网页代码在php中
*   数据库是 PostgreSQL

**编辑**添加的类型，子类型到上面的可编辑字段列表

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T15:49:25.170

当然，使用`UPDATE ... WHERE lock_status = 0`. 或者，您可以尝试使用[存储过程](http://www.postgresql.org/docs/8.0/interactive/plpgsql.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T16:05:35.013

正如Potato Head 先生所说，最简洁的方法是简单地使用WHERE 子句来只影响lock_status = 0 的行。因为这是一条SQL 语句，所以它保证是原子的。然后，您可以查看是否有任何行受到影响（例如，使用@@rowcount）并做出相应的反应，或者无限期地重试，或者显示错误消息等。

分两步检查和更新的问题在于，除非您将它们包装在显式事务中（例如“BEGIN TRANSACTION ... COMMIT TRANSACTION”），否则它们**不能**保证是原子的，因此理论上您可以获得多个进程认为锁已关闭并继续。我说“理论上”是因为以这些语句的执行速度，除非你有一个巨大的并发环境，有大量（数千？）用户同时敲击这个东西，否则这种情况几乎不可能发生。这就是为什么像这样的错误经常被忽视，但后来却出现了奇怪的无法解释的错误。

要了解有关此类问题的更多信息，您可能需要阅读一本关于并发编程的书，例如：[Gregory Andrews 的并发编程](https://rads.stackoverflow.com/amzn/click/com/0805300864)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T15:52:19.330

您可能想研究行级锁定。看起来[Postgres](http://www.postgresql.org/docs/8.1/static/explicit-locking.html)有它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T15:58:42.640

我建议同时检查和设置该`lock_status`位。

发出一个`UPDATE A SET lock_status = 1 WHERE id = ... AND lock_status = 0`. 该查询是原子的，不需要显式事务。如果这不返回 1 个更新对象的计数，则无法应用锁定。然后你只需要确认你的主键仍然存在。如果您要从多个位置和/或多个表上调用它，您可能需要考虑将其移至存储过程。

*伪PHP：*

```
$result = pg_query_params($conn, "UPDATE A SET lock_status = 1 WHERE id = $1 AND lock_status = 0", $id);
$tuples = pg_affected_rows($result);

if ($tuples < 1) {
    // couldn't lock
} else {
    // lock applied
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T16:11:21.633

数据库端只有一个示例过程，带有触发器和 PL/Pgsql 函数：

```
CREATE OR REPLACE FUNCTION trgfn_ensure_unlocked() RETURNS TRIGGER AS $trig$
  DECLARE
  BEGIN
    IF (OLD.lock_status <> 0) THEN
      RAISE EXCEPTION 'Row is locked';
    END IF;
    RETURN NEW;
  END;
$trig$ LANGUAGE plpgsql;

CREATE TRIGGER trg_check_unlocked BEFORE UPDATE ON table_name
      FOR EACH ROW EXECUTE PROCEDURE trgfn_ensure_unlocked(); 
```

基本上，您是一个 plpgsql 函数，它将检查该行的旧（更新之前）版本中的 lock_status 是否为 0。如果不是，它将引发异常。

此函数由触发器调用，该触发器将在对该表执行 SQL UPDATE 时自动调用。

希望这可以帮助 ...

# visual-studio - 如何防止 VS 2008 在发布过程中发布 .svn 文件夹？

> ID：511917
> 
> 赞同：8
> 
> 时间：2009-02-04T15:46:56.563
> 
> 标签：visual-studio, visual-studio-2008, svn, version-control, publishing

在 Visual Studio 2008 中发布 asp.net 网站时，有没有一种方法可以强制它忽略本地工作副本中的 .svn 文件夹，这样我的目标文件夹就不会以 .svn 文件作为输出。

谢谢，

杰森

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T16:02:06.610

Visual Studio 在网站内的“.svn”文件夹存在问题。因此，您应该应用 subversion ASP.NET hack，它使用“_svn”目录而不是“.svn”。

使用 TortoiseSVN 时，这只是 TSVN 设置中的一个选项（参见“常规”页面）。使用 SVN 命令行客户端时，您必须设置环境变量（详情请参阅[此页面](http://subversion.tigris.org/svn_1.3_releasenotes.html)）。

应用此解决方法/hack 后，发布网站操作将按预期工作（忽略 _svn 文件夹）。

**更新：**

上述问题存在于 Visual Studio 2003（分别是它使用的首页扩展）。较新版本的 Visual Studio 应该没有问题。

所以关键似乎是简单地在颠覆文件夹（_svn 或 .svn）上设置隐藏标志。然后在发布网站时忽略这些文件夹。（我使用的是 TortoiseSVN，我猜它会自动在 subversion 文件夹上设置隐藏标志）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-07T11:11:14.773

bin 文件夹不应成为源代码管理的一部分，只需右键单击解决方案资源管理器中的 Bin 文件夹并“从项目中排除”即可。

现在使用 Windows 资源管理器，找到您的 bin 文件夹并删除 .svn 文件夹。

下次发布时（删除所有内容后），您将不会有 .svn 文件，而且，每次构建解决方案时，看起来都不需要签入更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T15:55:23.053

您可以右键单击 VS 中的文件夹并将其从项目中删除，或者您可以确保文件夹中包含的任何文件的 Build Action 设置为 None 并将 Copy to Output Directory 设置为 Do not copy

# java - 为什么 Math.floor 返回一个双精度值？

> ID：511921
> 
> 赞同：118
> 
> 时间：2009-02-04T15:47:30.807
> 
> 标签：java, math, types

官方 Javadoc[说](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#floor(double))`Math.floor()`返回 a “等于`double`数学整数”，但是为什么不应该返回 a`int`呢？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-02-04T15:49:13.563

根据同一个Javadoc：

如果参数是`NaN`无穷大或正零或负零，则结果与参数相同。不能用`int`.

最大值`double`也大于最大值`int`，所以它必须是 a `long`。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-04T15:53:12.340

是为了精准。double 数据类型有一个 53 位尾数。除其他外，这意味着双精度可以表示高达 2^53 的所有整数而不会丢失精度。

如果将如此大的数字存储在整数中，则会出现溢出。整数只有 32 位。

将整数作为双精度返回是正确的做法，因为它提供了比整数更广泛的有用数字范围。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-10-10T23:17:15.647

其他人已经告诉你原因，我将告诉你如何正确舍入，因为你想这样做。如果您只打算使用正数，那么您可以使用以下语句：

```
int a=(int) 1.5; 
```

但是， (int) 总是向 0 舍入。因此，如果你想做一个负数：

```
int a=(int) -1.5; //Equal to -1 
```

就我而言，我不想这样做。我使用以下代码进行舍入，它似乎可以很好地处理所有边缘情况：

```
private static long floor(double a)
{
    return (int) Math.floor(a);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T15:53:43.557

如果你给它一个比最大的 int 或 long 大的两倍，你希望它返回什么？

（诚​​然，如果它大于最大的 long 精度无论如何都会很低 - 它可能不是最接近的理论整数 - 但即便如此......）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-11T15:10:10.827

正如Java中有整数和浮点除法一样，也有整数和浮点数的方法来做地板：

```
double f = Math.floor(x); 
```

或者

```
int k = (int) x; 
```

但是您始终需要小心使用具有有限精度算术的下限：您对 x 的计算可能会产生类似 1.99999999 的结果，这两种形式都将下限为 1，而不是 2。有许多算法需要解决这个限制，以避免为某些输入值产生错误的结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T15:53:15.147

这样误差和其他非整数值就可以通过一系列计算正确级联。

例如，如果您将 Not a Number (NaN) 输入 Math.floor，它将传递它。

如果它返回整数，则无法传递这些状态或错误，并且您可能会从较早的计算中得到不好的结果，这些结果看起来不错，但在进一步处理后是错误的。

# sql - 当他触发 SQL 触发器时，有没有办法存储用户的 id？

> ID：511924
> 
> 赞同：0
> 
> 时间：2009-02-04T15:47:45.143
> 
> 标签：sql, tsql

当他/她在 T-SQL 2005 上触发删除触发器时，是否有任何方法可以跟踪用户的身份，例如使用 UNIQUEIDENTIFIER？如果我确实记录了 UNIQUEIDENTIFIER，我如何将其追溯到用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T15:50:53.170

您可以在触发时存储[@@SPID](http://msdn.microsoft.com/en-us/library/ms189535(SQL.90).aspx)并使用 sp_who 回溯到用户

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T15:53:00.750

看看 suser_sname() 或 user_name() 用于 windows/sql 登录，当然如果每个人都使用相同的登录名，这对你没有帮助

删除的伪表将包含所有要删除的行，因此在最坏的情况下，您可以将它们卸载到其他地方，以防您需要将它们取回

# sql - 使用 SQL UPDATE 自动生成排序顺序

> ID：511925
> 
> 赞同：8
> 
> 时间：2009-02-04T15:48:25.047
> 
> 标签：sql, sql-server-2005

我最近将大约 60k 条记录导入到一个表中，该表将一个表中的数据与另一个表中的数据相关联。但是，我的客户此后要求将排序顺序添加到所有 60k 记录中。我希望有一种干净的方式可以在 SQL 更新中自动生成这些排序顺序。完成的数据应如下所示：

```
item1ID  item2ID  sortOrder
1           123       1
1           12        2
1           45        3
1           22        4
1           456       5
2           5         1
2           234       2
2           56        3 
```

这可以做到吗？任何建议将不胜感激。

——安妮

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T15:54:05.690

您可以使用 [ROW_NUMBER][1] 并按 Item1ID 分区

```
UPDATE t1
SET t1.SortOrder = t2.SortOrder 
FROM @t t1
INNER JOIN
(SELECT Item1ID, Item2ID, ROW_NUMBER() OVER
    (PARTITION BY Item1ID ORDER BY Item1ID, Item2ID) AS SortOrder
from @t) t2
ON t1.Item1ID = t2.Item1ID 
AND t1.Item2ID = t2.Item2ID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T16:28:55.433

您在这里谈到了关系模型的一些基本内容。在整个数据库中，没有内在排序这样的东西。如果您想在查看表时对数据进行排序，则必须明确指定该顺序。

所以在*一般*意义上，你要求的是不可能的。您不能只是`UPDATE`一个表并自动排序您对其进行的任何查询。但是在*逐个查询的*意义上，您始终可以将“ ”放在您应用于表`ORDER BY item1ID, sortOrder`的任何语句中。`SELECT`

在 SQL Server 2005 中，您可以编写一个视图并将其呈现给您的客户端，使用这个旧技巧：

```
SELECT TOP 100 PERCENT
    item1ID, item2ID, sortOrder  -- and all the other columns
FROM YourTable
ORDER BY item1ID, sortOrder; 
```

有多种方法可以使此类视图可更新，但您需要自行研究。做起来并不难。

如果您永远不会在此表中插入或更改数据，并且愿意再次将数据重新导入表中，则可以使用标识定义表，然后以适当的顺序将数据插入表中. 然后，您将始终按一个标识列排序。如果您的客户总是在允许按单列排序的程序中查看数据，那将起作用。*（顺便说一句，永远不要为此目的使用该`IDENTITY`*功能*。它不起作用。）*

```
CREATE TABLE YourTable (
    SingleSortColumn  INT IDENTITY(1,1) NOT NULL,
    ...
);
INSERT INTO YourTable (
    item1ID, item2ID, sortOrder  -- everything except the SingleSortColumn
)
SELECT  -- all your columns
INTO YourTable
FROM yadda yadda yadda
ORDER BY item1ID, sortOrder; 
```

希望这会有所帮助。对不起，如果我是迂腐。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T15:55:36.453

理论上，你可以说：

```
update mytable 
  set sortOrder = row_number() 
     over (partition by item1id order by item1id, item2id) from mytable 
```

但是，这会给你一个错误信息：

```
Msg 4108, Level 15, State 1, Line 1
Windowed functions can only appear in the SELECT or ORDER BY clauses. 
```

因此，您实际上必须分两步进行 - 首先将值选择到临时表中，然后从临时表中更新您的原始值。

例如：

```
select 
    item1ID, 
    item2ID, 
    row_number() 
        over (partition by item1id order by item1id, item2id) as sortOrder 
  into #tmp 
  from mytable

update mytable 
  set sortOrder = T.sortOrder 
  FROM 
    mytable M 
    inner join #tmp T 
        on M.item1ID = T.item1ID 
        AND M.item2ID = T.item2ID

drop table #tmp 
```

# php - PHP 是否在定义函数时评估变量？

> ID：511935
> 
> 赞同：1
> 
> 时间：2009-02-04T15:50:34.840
> 
> 标签：php

我正在使用会话在 PHP 中创建一个多页表单。该`$stage`变量跟踪用户填写表单的进度**(UPDATE)，通常在表单的每个阶段在 $_POST 中设置。**

在第二页（第 2 阶段），表单的提交按钮的值如下所示：

```
echo '<input type="hidden" name="stage" value="';
echo $stage + 1;
echo '" />; 
```

效果很好 -`$stage + 1`如果我在第 2 页，则计算结果为 3。但由于我不止一次这样做，我决定将这段代码提取到我在代码顶部定义的函数中，之前`$stage`提到过.

在我之前使用上面代码的同一个地方，我调用了这个函数。我已经验证函数的代码是相同的，但现在`$stage + 1`计算为 1。

**PHP 是否在定义函数时而不是在调用它时评估我的变量？如果是这样，我该如何防止这种情况？**

### 更新 1

为了测试这个理论，我`$stage = 2`在定义我的函数之前进行了设置，但是当我调用函数时它仍然评估为 1。这是怎么回事？

### 问题解决了

感谢所有建议将变量范围作为罪魁祸首的人 - 我现在正在拍我的额头。**`$stage`是一个全局变量，我没有`$GLOBAL_stage`**像往常那样调用它来防止此类问题。

我添加`global $stage;`到函数定义中，它工作正常。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T15:58:29.880

不，PHP 将在调用函数时评估您的变量。但是您的函数具有局部[变量范围](http://de.php.net/global)，即没有看到您的函数，我猜您正在对局部变量进行操作。您可以将全局变量导入到您的函数中，尽管不鼓励这样做：

```
function myfunction() {
    global $stage;
    ...
} 
```

如果不了解您的代码，真的很难说，但我继续猜测您正在使用[“注册全局变量”](http://de.php.net/register_globals)将表单参数注入全局 PHP 变量（在本例中为 $state）。您可能要考虑`register_globals`关闭，因为它确实存在安全风险，并改用所谓的[超全局](http://de.php.net/manual/en/language.variables.superglobals.php)变量。

* * *

**编辑**

好的，所以您在 $_POST 数组中看到了您的阶段。仍在疯狂猜测您的功能，您可以尝试以下方法：

```
function my_insert_stage_param() {
    global $stage;
    echo '<input type="hidden" name="stage" value="';
    echo $_POST['stage'] + 1;
    echo '" />';
} 
```

像 $_POST 数组这样的子全局变量不需要用`global`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T15:56:14.843

如果没有更多代码，这真的很难回答。要检查的一件事是，您正在将阶段保存回会话中，然后再加载下一页。如果 stage 为 null、空或字符串，则 stage + 1 将为 1。

要调试会话，请将 print_r($_SESSION); 死; 在每一页的顶部。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T15:56:58.743

调试代码时，源代码会派上用场。

如何`$stage`定义或初始化？函数有自己的变量[作用域](http://en.wikipedia.org/w/index.php?title=Scope_%28programming%29)——函数中定义的内容保留在函数中。除非您在函数的开头将变量定义为全局变量，即 ( `global $foo;`)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T15:58:54.247

听起来好像您遇到了范围问题。

尝试放置：

```
global $stage; 
```

作为函数的第一行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T12:24:19.283

您确实应该将阶段值作为参数传递给函数，而不是依赖全局或超全局 ($_POST)。

```
function formNextStage($stage) {
    return formHidden('stage', $stage + 1);
}

function formHidden($name, $value = '') {
    return sprintf('<input type="hidden" name="%s" value="%s" />', $name, $value);
}
echo formNextStage($stage); 
```

我建议你完全转储 formStage 函数并使用 formHidden 像

```
echo formHidden('stage', $stage + 1); 
```

您可以在需要时使用可选属性作为数组、转义名称/值等来构建该函数。

```
function formHidden($name, $value = '', $attributes = array(), $escape = true) 
```

# javascript - 确保文本仅包含格式化为 $placeholder$ 的美元符号的 javascript 函数

> ID：511936
> 
> 赞同：0
> 
> 时间：2009-02-04T15:50:40.970
> 
> 标签：javascript, regex

我需要一个 javascript 函数，它获取一个字符串并在字符串包含时返回 false
- 任何未闭合的美元符号
- 或者一个闭合的美元符号，美元之间的东西不同于一系列字符

```
function validateFormat(text) {
// Do stuff
} 
```

例如，如果文本：

```
validateFormat("blab abalaba $something$ avava $affo$")  -> true
validateFormat("blab abalaba $something$ avava $ affo$") -> false because of the white space
validateFormat("blab abalaba $1so3mething$ avava $affo$") -> false because of the numbers
validateFormat("blab abalaba $something") -> false because of unclosed placeholder 
```

有人能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T15:58:33.233

```
// delete all valid placeholders
text = text.replace(/\$[a-z]+\$/gi, "");

// are there any "$" left?
if (text.search(/\$/) != -1) {
    return false;
}
return true; 
```

这是另一种解决方案：

```
matches = text.match(/\$[a-z]+\$|\$/gi);
if (matches) {
    for (var i = 0; i < matches.length; i++) {
        if (matches[i] == '$') { return false };
    }
}
return true; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T16:27:42.287

其他方式：

```
text.match(/\$/g).length/2 == text.match(/\$[a-z]+\$/g).length 
```

这会计算 的数量`$`并将其与 的数量进行比较。`$`*`foobar`*`$`

# asp.net - jQuery 的 ajax 导致 FireFox 中的整个页面刷新

> ID：511947
> 
> 赞同：16
> 
> 时间：2009-02-04T15:53:08.207
> 
> 标签：asp.net, jquery, ajax, firefox

我正在使用 jQuery 进行 ajax 调用。ajax 调用在 IE 7 中运行良好，但 FireFox 3 在进行此调用时总是会刷新整页。ajax 调用正在发布到 ASP.NET 页面方法。

jQuery 有问题还是我只是缺少一些设置？

```
$.ajax({
  async: false,
  type: "POST",
  url: "Default.aspx/DoSomething",
  data: "{" + parms + "}",
  contentType: "application/json; charset=utf-8",
  dataType: "json",
  cache: false,
  success: function(data) { succesfulPost(data); },
  error: function(XMLHttpRequest, textStatus, errorThrown) { 
    errorPost(textStatus, errorThrown);
  }
}); 
```

调用是通过一个 html 按钮 onclick 事件进行的。我尝试了 `return false;`进行此 ajax 调用的方法，但 FireFox 中的完全刷新仍在继续。

我试过设置 async = true，但这似乎不起作用。FireFox 只是继续运行，不会等待后端返回响应。FireFox（在 js 中）实际上是在 ajax 调用中产生错误。正如您在上面看到的，错误函数已定义，并且在我设置 async = true 时触发。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-04T15:59:38.847

你是如何调用 AJAX 方法的？如果它也将导致表单上的提交，它可能就像取消启动 AJAX 请求的事件一样简单。

```
<input type="submit" onclick="doAjaxSubmit();return false;" value="Update" /> 
```

添加“return false;” 将导致典型的提交操作被取消。如果它来自文本框，那么您需要将 e.preventDefault 添加到设置为执行 AJAX 的按键（或其他）处理程序的处理程序中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-04T16:35:20.490

return false 是您需要的，但是如果在您点击该行之前发生 javascript 错误，那么浏览器将继续愉快地执行链接单击或按钮单击事件。

您可以尝试使用 try/catch 块包围潜在的问题区域。

或者你可以试试这个：

`e.preventDefault`作为处理程序中的第一条语句。这应该阻止默认事件的发生，我认为你可以提前调用它......我只是没有尝试过。

编辑：我还想补充一点，ajax 错误：处理程序只捕获来自服务器的错误......比如 403 或 500。您仍然应该将 ajax 调用包装在 try/catch 中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T18:01:18.040

此外，如果您的输入是 type="submit"...您可以将其更改为 type="button"。然后它不是试图提交表单......只是做你的“点击”事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T15:57:36.590

这个调用是在点击事件中吗？如果是，请确保点击事件的结尾有一个“return false”。只是一个想法。我知道那很老套，但是，我想我还是要提一下。

否则，据我所知，您的电话看起来不错。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-11T01:27:22.947

我在使用 Ajax 的 Firefox 上遇到了类似的问题。我在一个表单标签中有几个输入元素。但是，表单标签导致页面刷新，即使我用按钮标签替换了我的标签。我用 div 替换了表单标签，问题就消失了。

如上所述，我还尝试了 e.preventDefault()。这也解决了问题，同时允许我继续使用表单标签。

# active-directory - 通过 SSH 隧道访问活动目录？

> ID：511958
> 
> 赞同：1
> 
> 时间：2009-02-04T15:55:37.670
> 
> 标签：active-directory

我可以使用 putty 隧道进入我的大学网络并连接到我大学的所有本地服务器。我也可以通过大学代理浏览互联网。我想知道是否有任何软件可以使用，它可以让我通过 SSH 隧道远程访问活动目录文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T22:16:18.087

我相信您在谈论使用 SSH 代理与您的大学 AD 服务器的连接？例如，通过 SSH 隧道在您的家庭计算机上运行诸如 Active Directory 用户和计算机之类的工具？ADUC 使用 RPC 与 DC 通信，我认为您很难通过 SSH 隧道获取所有 RPC 端口。

您最好使用 RDP 会话，通过 SSH 隧道连接到域控制器或环境中的另一台服务器。有关您尝试做什么的更多信息将对完成此答案非常有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T19:21:03.357

也许我走错了路，但[活动目录](http://en.wikipedia.org/wiki/Active_directory)是提供身份验证的“目录服务”，而不是文件。

您想访问“共享文件夹”上的文件吗？

为此，需要更多信息： - 你如何隧道？这是 VPN 连接吗？您是否尝试过 \\SERVERNAME.COMPLETELY.WRITTEN\foldername ？- 您是否直接通过 ssh 进入机器命令行？什么机器？

# jquery - 将文本从水平位置旋转到垂直位置

> ID：511960
> 
> 赞同：1
> 
> 时间：2009-02-04T15:56:27.043
> 
> 标签：jquery, html, css

是否可以在不使用闪光灯之类的东西的情况下将文本从水平位置旋转到单个点上的垂直位置？所以我通常会通过倾斜我的头来阅读相同的文本。

我在想你可以在 jquery 中做到这一点，但找不到插件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-25T10:00:13.750

我使用了纯 CSS，它对我来说非常好用，代码如下：

```
<div style="-webkit-transform: rotate(-45deg); -moz-transform: rotate(-45deg); z-index:inherit; float:left">Not at all</div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T16:02:32.913

我记得我自己调查过这个问题，发现它要么真的是 hack-y，要么就是不可能。

IE 允许

```
<div STYLE="writing-mode: tb-rl">Content rendered vertically</div> 
```

但是 AFAIK 它在其他任何地方都不起作用（当然在 FF 3 上不起作用）。

最好的解决方案似乎是使用图像（可能是动态生成的）。很抱歉不能提供更多帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-14T02:13:36.000

CSS将允许...

-webkit 转换：旋转（-90 度）；-moz 变换：旋转（-90 度）；过滤器： progid:DXImageTransform.Microsoft.BasicImage(rotation=3);

该元素还必须是 display:block。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T16:24:15.960

您可能不得不使用[SVG](http://tutorials.jenkov.com/svg/text-element.html)而不是 HTML - 当然，并非所有浏览器都支持 SVG，有些浏览器比其他浏览器做得更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T16:21:04.157

我不知道这是否有帮助，但您可以分两步完成：

*   使用 php 之类的服务器端解决方案将文本转换为图像
*   使用 jquery 插件旋转图像（例如 jquery-rotate）

问题是结果是图像，而不是文本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T16:43:11.600

webkit 提出了一些新的[CSS 规范。](http://webkit.org/blog/130/css-transforms/)它们目前仅在夜间和 Apple 的 Safari 4 开发者预览版中实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T12:15:06.493

我自己就这个主题问了几个问题......

您可以使用动态图像来执行此操作 - 尽管[这有其问题（C# 示例）](https://stackoverflow.com/questions/388677)。

您也可以使用 IE 中的 CSS 来完成此操作。

最新的 Safari、Chrome 和 FX 中的新 CSS 转换[也不太有效（包括示例）](https://stackoverflow.com/questions/716970)。

# sql - 在 SQL Server 中存储旧日期的最佳方法

> ID：511979
> 
> 赞同：11
> 
> 时间：2009-02-04T15:59:08.287
> 
> 标签：sql, sql-server, sql-server-2005, datetime, date

在 SQL Server 2005 中存储旧日期（1753 年之前）的最佳/最有效方法是什么？我不关心存储时间 - 只是日期。SQL Server 的 datetime 数据类型只能保存追溯到 1753 年 1 月 1 日的日期。MSDN 文档指出有 date 和 datetime2 数据类型，但 SQL Server Management Studio 似乎不支持它们（错误：无效数据类型）。

将日期存储为“YYYYMMDD”形式的字符串或整数会有多低效？我对表中的两个日期字段（StartDate 和 EndDate）进行了大量查询和排序。

更新：

下面有一些建议将年、月和日期存储在单独的字段中。将部分存储在不同的字段而不是单个整数字段有什么好处？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-04T16:10:53.020

该[`date`](http://msdn.microsoft.com/en-us/library/bb675168.aspx)类型绝对是您想要使用的。它的范围是“公元 1 月 1 日到公元 9999 年 12 月 31 日” 它也只存储日期信息，没有时间部分。

您是否使用 SSMS 2005 而不是 2008，或者连接到 2005 实例？该类型是[在 SQL Server 2008 中引入的](http://msdn.microsoft.com/en-us/library/bb675168.aspx)。如果你有能力使用 2008 年的数据库，我会认为它毫无疑问是要走的路。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T16:06:38.490

我从来没有这样做过，但也许你可以将日期存储为一个整数，代表天数，因为任何最小日期都适合你。然后，您可以创建一个将这些整数映射到年、月和日的查找表，或者您可以编写用户定义的函数来将整数转换为日期，反之亦然。

这在选择和排序方面应该是相当有效的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T16:07:06.070

字符串可能比仅存储年、月和日的整数效率低。这在您的查询中有点冗长，但它们可能会运行得更快，因为您可以以对您正在执行的查询类型有意义的方式对它们进行索引。

例如：

```
CREATE TABLE myOldDates (
  year INT,
  month INT,
  day INT,
  -- otherstuff ...
) 
```

然后查询都会像：

```
-- get records between 5/15/1752 and 3/19/1754
SELECT * FROM myOldDates
  WHERE 
    (year = 1752 AND ((month = 5 and day >= 15) or month > 5) OR year > 1752)
    AND (year = 1754 AND ((month = 3 and day <= 19) or month < 3) OR year < 1754) 
```

可以肯定的是，这很丑陋，但这与范围查询一样丑陋，所以一旦你第一次编写它，你就可以将它封装在一个函数中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T16:10:27.517

以 YYYYMMDD 格式存储日期的一个问题是，您最终可能会得到不存在的日期（例如 16000231 - 2 月 31 日不存在）。在将其输入数据库之前，您需要做一些验证客户端。

[正如Ian Varley](https://stackoverflow.com/questions/511979/best-way-to-store-old-dates-in-sql-server/512023#512023)所提议的那样，将日期存储在年、月和日整数中也是如此。但除此之外，我喜欢他的回答，只是希望我能想到它;-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T16:11:08.793

YYYYMMDD = 8 个字节。您可以使用 3 列使用 SMALLINT 和 TINYINT 将其减少到 4 个字节。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T16:15:47.800

使用 CodeMonkey1 建议的整数似乎是一个好主意，并且可以更容易地进行“日期数学”（例如，某些日期 + XX 天）。

编写一些 UDF（也按照 CodeMonkey1 的建议）来转换*int --> YYYYMMDD --> int*，您将拥有 Ian Varley 在他的回答中提到的灵活性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T17:09:46.180

一个想法——如果你有一些 .NET 知识，你可以创建一个 CLR 类型来存储日期，它本质上是一个日期时间。如果您使用日期而不是简单查询进行大量计算，则可能需要调查

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-15T16:54:15.613

存储早至公元前 4713 年 1 月 1 日（一直到现代）的日期的一种方法是使用*Julian Day*。这与儒略日期不同，它是一个整数，编码自公元前 4713 年 1 月 1 日以来的天数。

为简单起见，这里是从日期到儒略日以及返回的转换。请注意，如果儒略日超出 DATE 类型的范围，您仍然无法将其转换为 DATE，但正如 bdukes 上面所说，DATE 应该保留为 1/1/0001。

```
IF OBJECT_ID (N'dbo.ufn_JulianDayFromDate', N'FN') IS NULL
    exec('CREATE function [dbo].[ufn_JulianDayFromDate] () returns int As begin 
return 1 end;');
go

alter function dbo.ufn_JulianDayFromDate(@theDate as date) returns int
as 
begin
    declare @JulianDayBase int=693596;
    return @JulianDayBase + datediff(d, 0, @theDate);
end;
go 
```

和

```
IF OBJECT_ID (N'dbo.ufn_DateFromJulianDay', N'FN') IS NULL
    exec('CREATE function [dbo].[ufn_DateFromJulianDay] () returns int As begin return 1 end;');
go

alter function dbo.ufn_DateFromJulianDay(@JulianDay as int) returns date
as 
begin
    declare @JulianDayBase int=693596;
    return dateadd(d, @JulianDay-@JulianDayBase, '1/1/1900')
end;

go 
```

# sql - Linq-to-sql 一对多，最大值

> ID：511985
> 
> 赞同：2
> 
> 时间：2009-02-04T16:00:00.250
> 
> 标签：sql, linq, linq-to-sql, .net-3.5, join

我和这个玩得很开心。可能是睡眠不足……或者我只是变得愚蠢。

我有 2 个表：
a) Person {Key, Name, LastName}
b) LogEntry {Key, PersonKey, Log, EntryTime}

我正在尝试加入 Person 和 LogEntry，其中 LogEntry 是给定 Person 的最新 LogEntry。

我希望我不会在五分钟内回答“呃……”时，答案对我造成了沉重打击。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T16:27:37.433

如果你有 SQLServer 中的关系，你应该在类 Person 中有 Person.LogEntries 之类的东西。你可以这样做：

```
 LogEntry logEntry = 
Person.LogEntries.OrderByDescending(p => p.EntryTime).FirstOrDefault(); 
```

然后您可以检查 logEntry 是否为空，如果不是，我应该拥有该人的最后一个日志条目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T21:22:18.993

如果一个人没有建立关系，接受的答案可以通过以下方式完成：

```
var r = Person
    .GroupJoin(
        LogEntry,
        o => o.Key,
        i => i.PersonKey,
        (o,i) => new {o, Entry = i.OrderByDescending(x => x.EntryTime).First()}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T16:12:29.400

在 Person 的部分类上，创建一个类似于以下的新属性：

```
public partial Person
{
    public LogEntry RecentLogEntry
    {
        get
        {
            return LogEntries.OrderByDescending(l => l.EntryTime).FirstOrDefault();
        }
    }
} 
```

我相信这（或类似的东西）应该可以工作，尽管这是凭记忆。当然，这取决于你在场的关系。

如果您希望在选择记录时这样做，您可以试试这个：

```
var people = from p in context.People
             select new
             {
                 Person = p,
                 LatestLogEntry = p.LogEntries.OrderByDescending(l => l.EntryTime).FirstOrDefault()
             }; 
```

# c++ - 如何在 QA 计算机上捕获堆栈跟踪

> ID：511998
> 
> 赞同：1
> 
> 时间：2009-02-04T16:02:35.190
> 
> 标签：c++, debugging, qt, visual-c++

我正在编写一个 Qt/C++ 应用程序，直到本月我一直在使用 Mingw 进行编译，并使用 drmingw 从 QA 人员那里获取堆栈跟踪。

不过，我最近转换为 MSVC++ 9，以便可以使用声子框架。

缺点是现在来自 drmingw 的堆栈跟踪是无用的。别人用什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T16:41:51.897

您可以使用 Dr Watson 捕获未处理的异常并生成转储文件。只要您有符号文件，就可以在 Visual Studio 或 WinDBG 中打开转储以查看所有线程的堆栈。

[http://msdn.microsoft.com/en-us/library/cc265791.aspx](http://msdn.microsoft.com/en-us/library/cc265791.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:00:47.397

如果您想自己捕获调用堆栈，可以使用[dbghelp](http://msdn.microsoft.com/en-us/library/ms679267(VS.85).aspx)。[你可以在这里](http://www.codeproject.com/KB/threads/StackWalker.aspx)找到很好的示例代码。***