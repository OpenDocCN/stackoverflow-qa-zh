# StackOverflow 问答 000750000-000750999

# c# - IEnumerable 或 Enumerable 用于枚举复合对象

> ID：750005
> 
> 赞同：1
> 
> 时间：2009-04-15T01:57:04.847
> 
> 标签：c#

您好，我需要以下帮助：

我有一个包含许多 ListViewItems 的 ListView 控件，并且每个 ListViewItem 的标记属性都引用了一个域对象，例如 Customer 等。

在检索所选 listviewItems 的集合时，我想将 an`IEnumerable<Customer>`而不是传递`IEnumerable<ListViewItem>`给一个函数来处理它。

只有一个循环来实现这一目标的最佳方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T02:05:02.443

如果您不想使用 LINQ：

```
public IEnumerable<Customer> Customers() {
    foreach(ListViewItem item in listview)
        yield return (Customer)item.Tag;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T02:01:35.243

如果你在 C# 3 (.NET 3.5) 中，你可以使用这样的 Linq 语句：

```
var custs = listView1.Items.Cast<ListViewItem>().Select(i => i.Tag as Customer); 
```

... 当然 listView1.SelectedItems 也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T02:04:26.890

您可能必须进行某种转换，但您可以在这里使用 LINQ 来发挥您的优势。

```
int currentCustomerID = 134;
var listViewItems = customers.Select(c => {
                        ListViewItem i = new ListViewItem();
                        i.Name = c.Name;
                        i.Value = c.CustomerID;
                        i.IsSelected = c.CustomerID == currentCustomerID;
                        i.Tag = c;
                        return i;
                    }); 
```

这应该只使用一个循环将其转换为正确的集合

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T02:05:01.163

你可以用这样的转换函数来做到这一点

```
public static IEnumerable<TOut> ConvertEnumer<TIn, TOut>(IEnumerable<TIn> src, Func<TIn, TOut> converter) {
   foreach(var itm in src) {
      yield return converter(itm);
   }
} 
```

你会使用它：

```
var myCol = ConvertEnumer<ListViewItem, Customer>(listView1.Items, (itm) => itm.Tag as Customer); 
```

# c - 如何以编程方式编辑路由表

> ID：750006
> 
> 赞同：6
> 
> 时间：2009-04-15T01:57:05.410
> 
> 标签：c, linux, networking

我正在编写一个在嵌入式平台上运行的守护进程，它需要根据在给定时间连接的接口来更改设备的默认路由。我怎样才能以编程方式做到这一点？我知道我可以使用 system("route del default && route add default gateway blah"); 等等，但有更直接的方法吗？

更新：我通过发现允许 replacedefaultroute 选项的 pppd 补丁解决了我的特定问题。该补丁还包括用于以编程方式修改路由表的代码。它包含在这个 gentoo 错误报告[http://bugs.gentoo.org/227321](http://bugs.gentoo.org/227321)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T02:14:19.207

查看 SIOCADDRT/SIOCDELRT ioctls（Stevens 的“Unix 网络编程”将是一个很好的参考。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T02:17:07.827

我打了

```
man route 
```

因为我知道有时我可以在“另见”部分中获得有关如何以编程方式执行相同操作的提示。我看到第 4 页上有一个关于“路由”的手册页（路由（4）在另见部分）。所以试过

```
man 4 route 
```

它看起来很有希望做路由命令可以通过编程来做的事情。

**注意**我刚刚注意到这仅适用于 BSD 系统。这是一个带有手册页 [http://www.manpagez.com/man/4/route/](http://www.manpagez.com/man/4/route/)的 URL 。这可能有帮助，也可能没有帮助。也许你可以在这里搜索一些东西并添加“linux”这个词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T02:00:11.267

我建议只使用该路由命令。这就是它的用途，其他任何东西都只是一个黑客。

# canvas - 如何在 GDI+ 中擦除图形上的内容？

> ID：750009
> 
> 赞同：0
> 
> 时间：2009-04-15T01:59:27.947
> 
> 标签：canvas, gdi+

我在 c++ 中使用 gdi+。

```
Bitmap canvasImg = new Bitmap(400, 300, PixelFormat32bppARGB);
Graphics canvas = new Graphics(&canvasImg );

canvas.DrawImage(XXXX); 
```

有两个问题。

1.我发现canvasImg是黑色的。如何将颜色更改为白色？我的意思是我想要一块白色的帆布。

2\. 如果我在画布上画了一些东西，如何清除画布？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T02:05:16.997

这两个问题的答案是使用`canvas.Clear(Color.White)`或任何您想要的画布颜色。

# assembly - 如何访问 MIPS 中单词的各个位的状态？

> ID：750013
> 
> 赞同：6
> 
> 时间：2009-04-15T02:00:59.237
> 
> 标签：assembly, bit-manipulation, mips

我正在编写一个程序，我需要确定是否设置了第 3 位和第 6 位。我知道我可以旋转一个单词或左/右移动它。

但是我如何访问单个位的状态？我是否使用像 and/xor 这样的按位运算符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T02:06:03.297

您可以按位使用 0x08 和 0x40 （假设位 0 是最低位）。您将使用 andi 指令来执行此操作。

如果 $t0 是您要测试的值：

```
andi $t1, $t0, 0x08
andi $t2, $t0, 0x40 
```

如果设置了第 3 位，则 $t1 将非零，如果设置了第 6 位，则 $t2 将非零。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T02:10:12.257

是的，您使用的是按位运算符。您可以使用仅设置第 3 位和第 6 位的位掩码进行与操作。然后与零进行比较。

类似的东西（我很久没做过汇编了）：

```
and     r2, r1, 0x48  # r2 = r1 & 0x48
cmp     r2, 0x48
jz     zzzzzz   #jmp to zzzzz if bits 6 and 3 are set 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T02:34:54.337

One technique for testing a single bit in MIPS assembly is to shift the desired bit into the most-significant bit position and use bltz/bgez to test the state of the bit. This saves an instruction in cases where the andi instruction can't be used to select the desired bit.

# java - 如何在 Java 中处理关闭应用程序事件？

> ID：750026
> 
> 赞同：4
> 
> 时间：2009-04-15T02:04:50.600
> 
> 标签：java, events, listener

拥有一个控制台应用程序，一个接受来自客户端的多个连接的服务器，是否可以在关闭的应用程序上拥有一个侦听器或一个事件？在这种情况下，我想告诉所有连接的客户端在应用程序真正关闭之前轻轻断开连接。

有什么解决办法吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T02:14:48.813

您想使用关闭挂钩：

```
Runtime.getRuntime().addShutdownHook(theHookThread); 
```

所以线程会在 JVM 关闭时运行，详见[此处](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T02:12:51.253

如果关闭应用程序是指操作系统杀死服务器进程？

在这种情况下，服务器无法知道它正在被杀死。它将删除现有的连接。

如果通过关闭应用程序，您为系统管理员提供了一种手动关闭服务器的方法（可能通过在服务器控制台键入“exit”）。然后关闭事件将是一个自定义事件，您必须编写侦听器并通知每个人服务器正在关闭。在这种情况下是可能的。

尝试添加有关如何构建服务器或如何工作的更多详细信息。

# javascript - 在各种浏览器中以javascript在客户端读取文件内容

> ID：750032
> 
> 赞同：143
> 
> 时间：2009-04-15T02:06:14.327
> 
> 标签：javascript, html, file-io, sandbox

我正在尝试提供一种纯脚本解决方案，用于通过浏览器读取客户端计算机上的文件内容。

我有一个适用于 Firefox 和 Internet Explorer 的解决方案。它不漂亮，但我现在只是在尝试：

```
function getFileContents() {
    var fileForUpload = document.forms[0].fileForUpload;
    var fileName = fileForUpload.value;

    if (fileForUpload.files) {
        var fileContents = fileForUpload.files.item(0).getAsBinary();
        document.forms[0].fileContents.innerHTML = fileContents;
    } else {
        // try the IE method
        var fileContents = ieReadFile(fileName);
        document.forms[0].fileContents.innerHTML = fileContents;
    }
}       

function ieReadFile(filename) 
{
    try
    {
        var fso  = new ActiveXObject("Scripting.FileSystemObject"); 
        var fh = fso.OpenTextFile(filename, 1); 
        var contents = fh.ReadAll(); 
        fh.Close();
        return contents;
    }
    catch (Exception)
    {
        return "Cannot open file :(";
    }
} 
```

我可以打电话`getFileContents()`，它会将内容写入`fileContents`文本区域。

**有没有办法在其他浏览器中做到这一点？**

目前我最关心的是 Safari 和 Chrome，但我对任何其他浏览器的建议持开放态度。

**编辑：**针对这个问题，“你为什么要这样做？”：

基本上，我想在客户端将文件内容与一次性密码一起散列，以便我可以将此信息作为验证发回。

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2009-04-16T01:02:02.617

**编辑添加有关文件 API 的信息**

自从我最初编写此答案以来，[文件 API](http://dev.w3.org/2006/webapi/FileAPI/)已被提议为标准并[在大多数浏览器中实现](http://caniuse.com/#feat=fileapi)（从 IE 10 开始，它增加了对`FileReader`此处描述的 API 的支持，尽管还没有`File`API）。该 API 比旧的 Mozilla API 稍微复杂一些，因为它旨在支持文件的异步读取，更好地支持二进制文件和不同文本编码的解码。[Mozilla 开发者网络上](https://developer.mozilla.org/en/using_files_from_web_applications)有一些可用的文档以及在线的各种示例。您可以按如下方式使用它：

```
var file = document.getElementById("fileForUpload").files[0];
if (file) {
    var reader = new FileReader();
    reader.readAsText(file, "UTF-8");
    reader.onload = function (evt) {
        document.getElementById("fileContents").innerHTML = evt.target.result;
    }
    reader.onerror = function (evt) {
        document.getElementById("fileContents").innerHTML = "error reading file";
    }
} 
```

**原始答案**

在 WebKit（因此，Safari 和 Chrome）中似乎没有办法做到这一点。[File](http://trac.webkit.org/export/42566/trunk/WebCore/html/File.idl)对象具有的唯一键是`fileName`and `fileSize`。根据对 File 和 FileList 支持的[提交消息](http://trac.webkit.org/changeset/34702)，它们受到[Mozilla 的 File object](https://developer.mozilla.org/en/nsIDOMFile)的启发，但它们似乎只支持功能的一个子集。

如果您想更改此设置，您可以随时向WebKit 项目[发送补丁。](http://webkit.org/coding/contributing.html)另一种可能性是提议将 Mozilla API 包含在[HTML 5](http://www.whatwg.org/specs/web-apps/current-work/)中；[WHATWG](http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org)邮件列表可能是最好的地方。如果你这样做了，那么至少在几年内，更有可能会有一种跨浏览器的方式来做到这一点。当然，提交补丁或提案以包含在 HTML 5 中确实意味着需要为这个想法辩护，但 Firefox 已经实现它的事实为您提供了一些开始。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2017-03-03T15:46:41.853

为了读取用户选择的文件，使用文件打开对话框，您可以使用`<input type="file">`标签。您可以[从 MSDN 找到有关它的信息](https://msdn.microsoft.com/en-us/library/ms535263(v=vs.85).aspx)。选择文件后，您可以使用[FileReader API](https://developer.mozilla.org/en/docs/Web/API/FileReader)读取内容。

```
function onFileLoad(elementId, event) {
    document.getElementById(elementId).innerText = event.target.result;
}

function onChooseFile(event, onLoadFileHandler) {
    if (typeof window.FileReader !== 'function')
        throw ("The file API isn't supported on this browser.");
    let input = event.target;
    if (!input)
        throw ("The browser does not properly implement the event object");
    if (!input.files)
        throw ("This browser does not support the `files` property of the file input.");
    if (!input.files[0])
        return undefined;
    let file = input.files[0];
    let fr = new FileReader();
    fr.onload = onLoadFileHandler;
    fr.readAsText(file);
}
```

```
<input type='file' onchange='onChooseFile(event, onFileLoad.bind(this, "contents"))' />
<p id="contents"></p>
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2020-09-29T05:06:23.983

有一个现代的原生替代方案：[File](https://developer.mozilla.org/en-US/docs/Web/API/File)实现[Blob](https://developer.mozilla.org/en-US/docs/Web/API/Blob)，所以我们可以调用[Blob.text()](https://developer.mozilla.org/en-US/docs/Web/API/Blob/text)。

```
async function readText(event) {
  const file = event.target.files.item(0)
  const text = await file.text();

  document.getElementById("output").innerText = text
}
```

```
<input type="file" onchange="readText(event)" />
<pre id="output"></pre>
```

目前（2020 年 9 月）Chrome 和 Firefox 支持此功能，对于其他浏览器，您需要加载 polyfill，例如[blob-polyfill](https://www.npmjs.com/package/blob-polyfill)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-17T08:23:10.800

快乐编码！
如果您在 Internet Explorer 上遇到错误，请更改安全设置以允许 ActiveX

```
var CallBackFunction = function(content) {
  alert(content);
}
ReadFileAllBrowsers(document.getElementById("file_upload"), CallBackFunction);
//Tested in Mozilla Firefox browser, Chrome
function ReadFileAllBrowsers(FileElement, CallBackFunction) {
  try {
    var file = FileElement.files[0];
    var contents_ = "";

    if (file) {
      var reader = new FileReader();
      reader.readAsText(file, "UTF-8");
      reader.onload = function(evt) {
        CallBackFunction(evt.target.result);
      }
      reader.onerror = function(evt) {
        alert("Error reading file");
      }
    }
  } catch (Exception) {
    var fall_back = ieReadFile(FileElement.value);
    if (fall_back != false) {
      CallBackFunction(fall_back);
    }
  }
}
///Reading files with Internet Explorer
function ieReadFile(filename) {
  try {
    var fso = new ActiveXObject("Scripting.FileSystemObject");
    var fh = fso.OpenTextFile(filename, 1);
    var contents = fh.ReadAll();
    fh.Close();
    return contents;
  } catch (Exception) {
    alert(Exception);
    return false;
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-12T07:31:17.447

这工作正常

```
function onClick(event) {
    filecontent = "";
    var myFile = event.files[0];
    var reader = new FileReader();

    reader.addEventListener('load', function (e) {
      filecontent = e.target.result;

    });
    reader.readAsBinaryString(myFile);
  } 
```

# c# - 确定对象是否派生自集合类型

> ID：750039
> 
> 赞同：25
> 
> 时间：2009-04-15T02:08:02.403
> 
> 标签：c#, .net, reflection

我想确定泛型对象类型（“T”）方法类型参数是否是集合类型。我通常会将 T 作为 Generic.List 发送，但它可以是任何集合类型，因为它在辅助函数中使用。

我最好测试一下它是否实现了 IEnumerable<T>？

如果是这样，代码会是什么样子？

**[更新 14:17 GMT+10 可能在此处](http://www.devcurry.com/2009/03/determine-if-object-implements.html)扩展解决方案（但仅适用于 List<T>'s 而不是 IEnumerable<T>'s 如果 List 派生则应该这样做？）**

```
T currentObj;    
// works if currentObj is List<T>
currentObj.GetType().GetGenericTypeDefinition() == typeof(List<>)
// does not work if currentObj is List<T>
currentObj.GetType().GetGenericTypeDefinition() == typeof(IEnumerable<>) 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-15T04:47:38.760

这将是最简单的检查..

```
if(Obj is ICollection)
{
    //Derived from ICollection
}
else
{
    //Not Derived from ICollection
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-15T02:14:05.073

您可以将 Type.GetInterface() 与损坏的名称一起使用。

```
private bool IsTAnEnumerable<T>(T x)
{
    return null != typeof(T).GetInterface("IEnumerable`1");
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-15T02:14:31.017

为了在运行时获取 T 的实际类型，可以使用 typeof(T) 表达式。从那里开始，普通的类型比较运算符就可以解决问题

```
bool isEnumerable = typeof(IEnumerable<int>).IsAssignableFrom(typeof(T)); 
```

完整代码示例：

```
static bool Foo<T>()
{
  return typeof(IEnumerable<int>).IsAssignableFrom(typeof(T));
}

Foo<List<T>>();  // true
Foo<int>(); // false 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-06-05T12:03:54.190

就个人而言，我倾向于使用我自己编写的一种方法，称为`TryGetInterfaceGenericParameters`，我在下面发布了该方法。以下是在您的情况下如何使用它：

## 使用示例

```
object currentObj = ...;  // get the object
Type[] typeArguments;
if (currentObj.GetType().TryGetInterfaceGenericParameters(typeof(IEnumerable<>), out typeArguments))
{
    var innerType = typeArguments[0];
    // currentObj implements IEnumerable<innerType>
}
else
{
    // The type does not implement IEnumerable<T> for any T
} 
```

需要注意的是，您传入的是`typeof(IEnumerable<>)`，**而不是** `typeof(IEnumerable)`（这是一种完全不同的类型），**也不** `typeof(IEnumerable<T>)`是任何`T`（如果您已经知道`T`，则不需要此方法）。当然，这适用于任何通用接口，例如您也可以使用`typeof(IDictionary<,>)`（但**不是** `typeof(IDictionary)`）。

## 方法来源

```
/// <summary>
///     Determines whether the current type is or implements the specified generic interface, and determines that
///     interface's generic type parameters.</summary>
/// <param name="type">
///     The current type.</param>
/// <param name="interface">
///     A generic type definition for an interface, e.g. typeof(ICollection&lt;&gt;) or typeof(IDictionary&lt;,&gt;).</param>
/// <param name="typeParameters">
///     Will receive an array containing the generic type parameters of the interface.</param>
/// <returns>
///     True if the current type is or implements the specified generic interface.</returns>
public static bool TryGetInterfaceGenericParameters(this Type type, Type @interface, out Type[] typeParameters)
{
    typeParameters = null;

    if (type.IsGenericType && type.GetGenericTypeDefinition() == @interface)
    {
        typeParameters = type.GetGenericArguments();
        return true;
    }

    var implements = type.FindInterfaces((ty, obj) => ty.IsGenericType && ty.GetGenericTypeDefinition() == @interface, null).FirstOrDefault();
    if (implements == null)
        return false;

    typeParameters = implements.GetGenericArguments();
    return true;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-15T02:13:00.537

我会测试`IEnumerable`，因为集合类型只能实现`IEnumerable`，它不必实现`IEnumerable<T>`。

这还取决于：你对*集合类型*是什么意思？您可以在不实现任何这些接口的情况下拥有一个集合。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-15T02:29:51.307

另外，请记住，仅仅因为您使用的是泛型，不要忘记其他基本技术，在这种情况下，例如重载。我怀疑你正在计划这样的事情：

```
void SomeFunc<T>(T t)
{
    if (IsCollectionCase(t))
       DoSomethingForCollections()
    else
       DoSOmethingElse();
} 
```

这会更好地处理为：

```
void SomeFunc(IEnumerable t)
{
       DoSomethingForCollections()
}
void SomeFunc<T>(T t)
{
       DoSomethingElse()
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-11-18T17:57:29.610

虽然我不能确定原始发帖人的意图是什么，但对于投射到 IEnumerable 进行测试的效果，已经有几个回应。没关系，但是每个人都应该知道字符串实例通过了这个测试，这可能不是原作者想要的。我知道当我去寻找答案并找到这篇文章时我当然没有：

```
string testString = "Test";
Console.WriteLine(testString as IEnumerable != null);  // returns true 
```

我正在尝试编写一个使用反射来完成某些任务的自定义序列化程序。作为任务的一部分，我需要确定属性值是项目的集合/数组/列表还是单个属性值。特别烦人的是，几个 Linq 表达式实际上会产生一个可枚举的类型值，但 GetType().IsArray 对这些返回 false，并且将它们转换为 ICollection 也会返回 null，但将它们转换为 IEnumerable 会返回一个非 null 值。

所以......目前，我仍在寻找适用于所有情况的解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-04T03:59:34.020

为了简单和代码共享，我通常使用这种扩展方法：

```
public static bool IsGenericList(this object obj)
{
    return IsGenericList(obj.GetType());
}

public static bool IsGenericList(this Type type)
{
    if (type == null)
    {
        throw new ArgumentNullException("type");
    }

    foreach (Type @interface in type.GetInterfaces())
    {
        if (@interface.IsGenericType)
        {
            if (@interface.GetGenericTypeDefinition() == typeof(ICollection<>))
            {
                // if needed, you can also return the type used as generic argument
                return true;
            }
        }
    }

    return (type.GetInterface("IEnumerable") != null);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-08-12T21:21:19.677

如果您想对任何列表/集合/IEnumerable 进行检查并为真，但对字符串类型为假，则

```
 private static bool IsIEnumerable(Type requestType)
   {
      var isIEnumerable = typeof(IEnumerable).IsAssignableFrom(requestType);
      var notString = !typeof(string).IsAssignableFrom(requestType);
      return isIEnumerable && notString;
   } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-10T13:59:54.943

我喜欢泛型。在此方法`T`中必须有一个公共且无参数的构造函数，这意味着您不能使用`IList<object>`for `T`。你必须使用`List<object>`

```
public static T IsEnumerable<T>() where T : new() {
    if (new T() is IEnumerable) {
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-08T19:56:02.720

我在尝试将任何对象序列化为 JSON 格式时遇到了同样的问题。这是我最终使用的：

```
Type typ = value.GetType();

// Check for array type
if(typeof(IEnumerable).IsAssignableFrom(typ) || typeof(IEnumerable<>).IsAssignableFrom(typ))
{ 
    List<object> list = ((IEnumerable)value).Cast<object>().ToList();
    //Serialize as an array with each item in the list...
}
else
{
    //Serialize as object or value type...
} 
```

# c - 是否有另一种方法可以在 C 中释放动态分配的内存 - 不使用 free() 函数？

> ID：750060
> 
> 赞同：5
> 
> 时间：2009-04-15T02:15:40.437
> 
> 标签：c, memory, dynamic, allocation

我正在为考试而学习，我想知道这些是否等同于 free(ptr)：

```
 malloc(NULL); 

 calloc(ptr); 

 realloc(NULL, ptr); 

 calloc(ptr, 0); 

 realloc(ptr, 0); 
```

据我了解，这些都不起作用，因为 free() 函数实际上告诉 C ptr 之后的内存再次可供它使用。抱歉，这是一个菜鸟问题，但我们将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-15T02:25:09.243

实际上，最后一个相当于调用`free()`. 仔细阅读规范`realloc()`，你会发现它可以重新分配数据，或者改变分配的大小（特别是如果新的大小比旧的大，可能会移动数据），它可以释放内存也。实际上，您不需要其他功能；它们都可以用`realloc()`. 并不是说任何头脑正常的人都会这样做……但这是可以做到的。

有关函数族危险的完整剖析，请参阅 Steve Maguire 的“ [Writing Solid Code ”。](https://rads.stackoverflow.com/amzn/click/com/1556155514)`malloc()`有关阅读“编写可靠代码”的风险的完整剖析，请参见[ACCU](http://accu.org/)网站。我不相信它会像评论所说的那么糟糕——尽管它完全缺乏对它的处理`const`确实过时了（回到 90 年代初，当时 C89 还是新的并且没有被广泛实施）。

* * *

D McKee 关于 MacOS X 10.5 (BSD) 的笔记很有趣……

C99 标准说：

### 7.20.3.3 malloc 函数

> 概要

```
#include <stdlib.h>
void *malloc(size_t size); 
```

> 描述
> 
> malloc 函数为大小由 size 指定且值不确定的对象分配空间。
> 
> 退货
> 
> malloc 函数返回空指针或指向已分配空间的指针。

### 7.20.3.4 realloc 函数

> 概要

```
#include <stdlib.h>
void *realloc(void *ptr, size_t size); 
```

> 描述
> 
> realloc 函数释放 ptr 指向的旧对象，并返回一个指向具有 size 指定大小的新对象的指针。新对象的内容应与释放前旧对象的内容相同，直至新旧大小中的较小者。新对象中超出旧对象大小的任何字节都具有不确定的值。
> 
> 如果 ptr 是空指针，则 realloc 函数的行为类似于指定大小的 malloc 函数。否则，如果 ptr 与 calloc、malloc 或 realloc 函数先前返回的指针不匹配，或者如果空间已通过调用 free 或 realloc 函数被释放，则行为未定义。如果无法为新对象分配内存，则不会释放旧对象并且其值不变。
> 
> 退货
> 
> realloc 函数返回一个指向新对象的指针（它可能与指向旧对象的指针具有相同的值），如果无法分配新对象，则返回一个空指针。

* * *

除了由于额外的标头和功能而导致的编辑更改外，ISO/IEC 9899:2011 标准与 C99 相同，但在第 7.22.3 节而不是 7.20.3 节中。

* * *

realloc 的 Solaris 10 (SPARC) 手册页说：

> realloc() 函数将 ptr 指向的块指针的大小更改为 size 字节，并返回指向（可能已移动的）块的指针。内容将保持不变，直至新旧尺寸中的较小者。如果块的新大小需要移动块，则释放用于块的先前实例化的空间。如果新大小更大，则未指定块的新分配部分的内容。如果 ptr 为 NULL，则 realloc() 的行为与指定大小的 malloc() 类似。如果 size 为 0 且 ptr 不是空指针，则释放指向的空间。

这是一个非常明确的“它像 free() 一样工作”声明。

然而，MacOS X 10.5 或 BSD 所说的任何不同都再次证实了我第一段的“没有人头脑正常”部分。

* * *

当然，还有[C99 的基本原理](http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf)……它说：

### 7.20.3 内存管理功能

> 在这些函数的定义中对空指针和零长度分配请求的处理部分是出于支持这种范式的愿望：

```
OBJ * p; // pointer to a variable list of OBJs
    /* initial allocation */
p = (OBJ *) calloc(0, sizeof(OBJ));
     /* ... */
     /* reallocations until size settles */
 while(1) {
    p = (OBJ *) realloc((void *)p, c * sizeof(OBJ));
         /* change value of c or break out of loop */
 } 
```

> 据报道，这种编码风格不一定得到委员会的认可，但被广泛使用。
> 
> 一些实现已经为零字节的分配请求返回了非空值。尽管该策略具有区分“无”和“零”（未分配指针与指向零长度空间的指针）的理论优势，但它具有更引人注目的理论缺点，即需要零长度对象的概念。由于无法声明此类对象，因此它们存在的唯一方法是通过此类分配请求。
> 
> C89 委员会决定不接受零长度对象的想法。因此，分配函数可能会为零字节的分配请求返回空指针。请注意，这种处理并不排除上述范例。
> 
> C89 中的安静变化
> 
> 依赖于大小为零的分配请求返回非空指针的程序将表现不同。

[...]

### 7.20.3.4 realloc 函数

> 一个空的第一个参数是允许的。如果第一个参数不为null，而第二个参数为0，则调用释放第一个参数指向的内存，并且可能返回一个null参数；C99 与不允许零大小对象的策略一致。
> 
> *C99*的一个新特性：realloc函数被改变，明确指向的对象被释放，一个新的对象被分配，新对象的内容与旧对象的内容相同，直到更小两种尺寸。C89 试图指定新对象是与旧对象相同的对象，但可能具有不同的地址。这与标准中假定对象的地址在其生命周期内保持不变的其他部分相冲突。此外，在大小为零时支持实际分配的实现不一定会在这种情况下返回空指针。C89 似乎需要一个空返回值，委员会认为这太严格了。

* * *

[Thomas Padron-McCarthy](https://stackoverflow.com/users/15727/thomas-padron-mccarthy) [观察到](https://stackoverflow.com/questions/750060/is-there-an-alternative-way-to-free-dynamically-allocated-memory-in-c-not-usin/750075?noredirect=1#comment561534_750075)：

> C89 明确表示：“如果 size 为零且 ptr 不是空指针，则释放它指向的对象。” 所以他们似乎已经删除了C99中的那句话？

是的，他们删除了那句话，因为它被开头的句子所包含：

> realloc 函数释放 ptr 指向的旧对象

那里没有回旋的余地；旧对象被释放。如果请求的大小为零，那么您将返回`malloc(0)`可能返回的任何内容，这通常（通常）是一个空指针，但也可能是一个非空指针，也可以返回，`free()`但不能合法地取消引用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T02:21:22.277

```
realloc(ptr, 0); 
```

相当于`free(ptr);`（尽管我不建议这样使用它！）

另外：这两个调用彼此等价（但不是免费的）：

```
realloc(NULL,size)
malloc(size) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T02:22:25.333

最后一个`realloc(ptr, 0)`——接近了。它将释放任何已分配的块并用最小的分配替换它（我的 Mac OS X 10.5 联机帮助页说）。检查您的本地手册页以查看它在您的系统上的作用。

也就是说，如果`ptr`指向一个实体对象，您将取回它的大部分内存。

* * *

Debian Lenny 的手册页同意[Mitch](https://stackoverflow.com/questions/750060/is-there-an-alternative-way-to-use-the-free-function-in-c/750068#750068)和[Jonathan](https://stackoverflow.com/questions/750060/is-there-an-alternative-way-to-use-the-free-function-in-c/750075#750075) ... BSD 真的在这方面与 Linux 不同吗？

* * *

从有问题的手册页：

> realloc() 函数尝试将 ptr 指向的分配大小更改为 size，并返回 ptr。[...] 如果 size 为零且 ptr 不为 NULL，则分配一个新的、最小大小的对象并释放原始对象。

* * *

linux 和 solaris 手册页非常干净，'89 标准：`realloc(ptr,0)`像`free(ptr)`. 上面的 Mac OS 手册页和 Jonathan 引用的标准不太清楚，但似乎留下了打破等价的空间。

我一直想知道*为什么会有*差异：“像自由一样”的解释对我来说似乎很自然。我可以访问的两个实现都包含*一些*环境变量驱动的可调性，但 BSD 版本接受更多选项一些示例：

> ```
>  MallocGuardEdges             If set, add a guard page before and after
>                               each large block. 
> ```

```
 MallocDoNotProtectPrelude    If set, do not add a guard page before large
                              blocks, even if the MallocGuardEdges envi-
                              ronment variable is set.

 MallocDoNotProtectPostlude   If set, do not add a guard page after large
                              blocks, even if the MallocGuardEdges envi-
                              ronment variable is set. 
```

和

> ```
>  MallocPreScribble            If set, fill memory that has been allocated
>                               with 0xaa bytes.  This increases the likeli-
>                               hood that a program making assumptions about
>                               the contents of freshly allocated memory
>                               will fail. 
> ```

```
 MallocScribble               If set, fill memory that has been deallo-
                              cated with 0x55 bytes.  This increases the
                              likelihood that a program will fail due to
                              accessing memory that is no longer allo-
                              cated. 
```

`free`在正常模式下，“最小尺寸的对象”可能什么都不是（即等同于），*而是*有一些保护措施到位的东西。把它当作它的价值。

# html - Any advice for getting started in Web Programming/design

> ID：750064
> 
> 赞同：7
> 
> 时间：2009-04-15T02:19:20.723
> 
> 标签：html

A little backround:I'm a 22 yr old with just a high school degree and a lot of free time (college did not work out). I am completely new to web programming and I have taken a couple day classes in Photoshop, Illustrator, Dreamweaver, Fireworks, and InDesign. Seeing as these are only day classes, I am by no means a pro at any of them but I am getting more familiar with the Adobe programs. My teacher who was a freelance web designer told me that along with those Adobe programs, if I could learn HTML, XHTML, CSS, Flash, and Java that I would be in good shape regarding getting a job. She also told me if I could get good at both the design and programming sides, I could really get a good job.

I was just wondering if anyone has some advice or information for basically a noob who is starting from scratch and really wants to get into this profession. I've gotten on lynda.com to try and get going on the programming stuff and I'm just trying to turn some of these skills into a job. Best case scenario is that eventually I could be doing freelance and supporting myself...But that is obviously very far away. ANy advice would be greatly appreciated....

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-15T02:38:28.897

# Advice You Don't Want To Hear

1.  figure out what went wrong with college - at 22, you should have graduated by now, or close to it
2.  fix it!
3.  focus!
4.  go back to college with a new focus and resolve - you now have a goal

# If You Can Teach Yourself, You Can Graduate College

*   if the problem was boring general ed classes, look into CLEP tests to test out of them
*   if the problem was curriculum, take classes you are interested in first
*   if the problem was time, start part-time
*   if the problem was school choices, research different colleges - many online universities are now accredited
*   if the problem was self-discipline, then *freelancing is not a good career choice*

I'm not saying that you can't do what you asked about, but your chances of getting a good job are greatly increased with a degree, even a 2-year degree.

Obviously, this is not the only path, but it is arguably the easiest path. Marketing yourself when you have no degree and no experience is difficult, even if you are overflowing with talent and creativity. (It's easier now with the Internet, but by the same token the marketplace is that much more crowded.)

Good luck!

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-15T02:59:59.907

我目前是一名软件工程顾问。熟悉以下内容帮助我在大学毕业后就获得了面试和录取通知书。

注意：HTML、XHTML、CSS……这些只是标记语言，如果你把它们放在简历上，很可能他们几乎不会被看一眼。Flash（没那么多）和 Java 更令人印象深刻，但您可能需要研究以下其他主题/技术来真正为简历增添趣味：

*   熟悉 OO（面向对象）原则（继承、多态、抽象类与具体类、封装等）
*   Java 是一种很棒的开源初学者编程语言。我主要是 .NET 开发人员，所以我倾向于这样做，但我在大学时代就开始使用 Java，并且很快就掌握了它
*   .NET 2.0、3.5——C# 和 VB.NET（LINQ、lambda 表达式、匿名方法等）——您可以从 Visual Studio 的 Express 版本开始，但最终可能想要获得完整版本
*   继续学习更高级别的编程概念，例如设计模式（MVC/MVP、命令、外观、适配器，不胜枚举）——我推荐四人帮（Gang of Four）这本书（谷歌会告诉你它是哪本书）
*   数据库管理系统
    *   学习 SQL，熟悉 JOINing，使用 GROUP BY 和 HAVING 子句，熟悉聚合函数
    *   处理 DB 设计概念（尤其是关系建模）
    *   从免费的开始，比如 MySQL 或 PostgreSQL，然后......
    *   专注于 Microsoft SQL Server 或 Oracle（这些都是大猫）
    *   深入研究范式、数据仓库（OLAP、MOLAP、ROLAP、多维数据集等）
*   测试：研究单元测试和测试驱动开发
*   软件质量保证 - 缺陷预防技术等（这与下面提到的一些要点有关）
*   研究诸如瀑布、敏捷和 XP（极限编程）之类的方法，甚至可能是 PSP 和 TSP
*   学习使用源代码/版本控制系统，例如 CVS、SVN 和 VSS（微软，不幸的是不是免费的——前两个是）
*   您可能会非常疯狂并学习静态代码分析，但一定要研究代码审查和代码检查

**编辑：我想我会给你一些书来看看（没有特别的顺序）：**

1.  算法导论，第 2 版。Thomas H. Cormen、Charles E. Leiserson、Ronald L. Rivest 和 Clifford Stein，2002 年。
2.  人工智能：复杂问题解决的结构和策略，第 5 版。乔治·F·卢格，2005。
3.  Visual C++ 的第一本书。加里·布朗森，2000 年。
4.  使用 Java 进行面向对象编程的介绍，第 3 版 (Java 1.5) 更新。C. 托马斯·吴，2004 年。
5.  计算机科学的数学结构，第 5 版。朱迪思 L. Gersting，2003 年。
6.  掌握需求过程，第 2 版。苏珊娜·罗伯逊和詹姆斯·罗伯逊，2006 年。
7.  数据管理：数据库和组织，第 5 版。理查德·T·沃森，2006 年。
8.  软件质量工程：测试、质量保险和可量化的改进，第 1 版。杰夫田，2005 年。
9.  人工智能：一种现代方法，第 2 版。斯图尔特·罗素和彼得·诺维格，2003 年。
10.  实践中的软件架构，第 2 版。Len Bass、Paul Clements 和 Rick Kazman，2003 年。
11.  Java 中的单元测试：测试如何驱动代码，第 1 版。约翰内斯·林克和彼得·弗罗利希，2003 年。
12.  实用 PostgreSQL，第 1 版。约翰 C. 沃斯利和约书亚 D. 德雷克，2002 年。
13.  PSP：软件工程师的自我改进过程，第 1 版。瓦特 S.汉弗莱，2005 年。
14.  TSPi：团队软件过程简介，第 1 版。瓦特 S.汉弗莱，2000 年。

我想这就是我现在所拥有的。如果你能把这些事情搞定，你的技能应该相当扎实，你将朝着成为软件工程世界的另一个成员迈进。我不确定你自己做的任何事情都会给你与大学课程相同的知识水平，但我相信这是一个好的开始。这是一个庞大的清单；如果获得这些技能需要几年时间，请不要感到惊讶。

就您的图形设计技能而言，取决于您发现自己从事的工作类型，它们可能比您的编程技能更重要。在这两种技能组合之上，确保您的软技能得到打磨，并且您对自己的工作充满信心。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-15T02:40:42.763

1.  Don't create websites by exporting to web from your design programs. If you see yourself creating slices and mouseover effects in Fireworks STOP and hit yourself in the head with something heavy and blunt.
2.  Learn XHTML and CSS and learn them well. Try to be as semantic as possible.
3.  Pick an all inclusive framework and build yourself a web app like a blog. As much as I love ASP.NET it is not all inclusive. It is massive. It will throw you in every direction. The same can be said of Java. Try something simple like Django or Rails.
4.  Practice, practice, practice, and realize that all that you know is crap and that you need to get better.
5.  Go back to 4 and do it till you die.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-15T02:46:15.150

好吧，这可能不受欢迎——但我是从自己作为“自学”程序员的经验中得出的。在没有某种学位/认证/在职经验的情况下，作为“程序员/网络开发人员”在公司找到工作的底线大约是“0%”。

您可能已经注意到该声明的“问题”——没有学位或证书，您如何获得“在职经验”？欢迎来到真实的世界”。

我成为一名开发人员的道路始于“愿望”......并找到一份做其他事情的工作（如果你必须知道的话，半导体制造）。我自学编程是一种“爱好”，并不断寻找方法将其应用到我的工作任务中，以提高我的“工作绩效”。我最终申请了能让我更接近“编程”的职位，以更好地利用我不断增长的技能，直到我有足够的“工作经验示例”来申请程序员职位。

那花了“8年”。不管你对大学的看法如何，获得与计算机科学相关的“任何”学位都会减少一半。你可以自己做，但除非你有一些杰出的例子来说明你如何使用你的编程技能来解决“真正的商业”问题，否则你不会被认为比任何“刚毕业”学位的人都高。当你最终成功时，**你**会注意到那些不知道杰克解决“业务问题”的“刚毕业”的人可能会**从**比你更高的薪水开始。

现在的环境可能比我刚开始时（25 年前 - :-)）要好，但同样的一般原则适用 - 学位可能并不意味着你知道如何编程，但它会让你通过“人力资源”筛选过程，所以你可以得到这份工作。:-)

祝你好运 ...

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-15T02:31:53.297

Create a project that would actually be useful and non-trivial for you: A forum or message board, or a job posting site, for instance.

But here's the important part: **Give yourself a firm deadline.** You can do quite a lot in, say, 4 weeks, and if you keep to a schedule like

*   database backend in week 1
*   login system in week 2
*   messaging in week 3

and so on, you can broadly cover many related subjects. Your project won't be pretty, but if you start out being a perfectionist, you'll never finish it, and will end up knowing only the first half of the technology in your project really well.

As you get more experience, you can go back and polish things up or rewrite stuff you did wrong, and then you have a portfolio that accurately reflects your current skills.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-15T02:34:39.873

Learning HTML, XHTML, CSS, Flash, and Java plus several graphical programs is a pretty tall order. You'll overwhelm yourself trying to do that. Pick one and learn it then move onto the next. Grab a book or search the Stack Overflow archives for recommended online tutorials.

The best way to learn is to pick a project and just work on it. Then learn on demand as you find a need. The end product won't be the highest quality, but you'll learn how everything works together.

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-15T05:14:02.113

对于认真的 Web 开发人员来说，了解网站的内部运作方式非常重要。

当您从头开始时，我强烈推荐**[W3Schools](http://www.w3schools.com/)**。

通过这个网站，您可以从非常好的教程中学习，然后 **[自己尝试](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_intro)** 并 **[测试您的技能](http://www.w3schools.com/html/html_quiz.asp)**。

以下是绝对初学者的步骤：

1.  html
2.  css
3.  JavaScript（客户端脚本）
4.  PHP（服务器端脚本）
5.  SQL（数据库应用程序）
6.  [DOM](http://www.brainjar.com/dhtml/intro/)（文档对象模型）
7.  AJAX
8.  Drupal/Joomla/Plone（内容管理系统）

**注意：**键入代码而不是剪切粘贴或使用 Dreamweaver/FrontPage 之类的工具。只有在您对手动编码非常熟悉后才能使用这些工具。（相信我这很有帮助）

享受！！！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-15T02:24:44.580

The best I could suggest is that you create a fake need, for example create a simple file read / write app, or something that can toss information onto a database and retrieve it.

A more advanced project you could start on after would be a tagboard of sorts, with Create/Update/Read/Delete (CRUD) functionality, and add features to it in order to get practice with cookies, login, more database functionality, etc. You could also try using an image editor that just draws a clock showing the current server time the request was recieved as practice with images.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-15T02:35:01.777

I would recommend learning html and css first. That is the cornerstone of anything you'll do on the web. For graphics, learn photoshop. Once you can make basic html websites, I would then choose to pursue either asp.net or flash. There are good jobs in both fields. I would say pick asp.net if you like programming, and flash if you like the visual aspects of web development more. As an asp.net developer I would say 90% of my day is doing database related work with MS SQL server. Really focus on databases. Finally, if you develop with asp.net, you should program in C# rather than vb.net. I started as a vb.net programmer and had to switch to C#, simply because most of the professional world uses it, hence it will be easier getting a job.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-15T04:52:49.200

查看本地代码营地和用户组，创建一个项目并构建它，从学习 HTML、CSS 和 javascript 开始，然后看看学习 PHP 是一种很好的入门语言，用于在代码方面开始 Web 开发。

至于在没有学位的情况下找工作，从食物链的低端开始，我是从 QA 实验室开始的，从那里你可以学习开发方面的良好做法和注意事项。此外，作为 QA 人员，您可以快速了解谁是优秀的开发人员，而不是仅仅通过他们生产的工作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-04-22T06:54:50.327

[W 3 Schools](http://www.w3schools.com/)是一个简洁的初学者/新手参考和教程网站。该站点涵盖了 Web 开发中使用的大多数技术。

# mysql - 如何在保存之前清理用户输入以进行正确的内容编码？

> ID：750071
> 
> 赞同：12
> 
> 时间：2009-04-15T02:23:35.657
> 
> 标签：mysql, perl, encoding, user-input

我有一个应用程序，用户可以在其中将文本输入表单。

数据保存到 MySQL 数据库（排序规则：）`utf8_general_ci`，然后输出为 XML（编码：UTF-8）。

问题是人们倾向于从其他来源剪切和粘贴他们的信息，例如 Microsoft Word 文档或 PDF。

此输入文本通常包含不适合输出编码的字符，例如“智能引号”，这些字符来自[Windows-1252 编码的文档](http://en.wikipedia.org/wiki/Windows-1252)

这显然会在转换或以其他方式处理 XML 时导致问题，因为字符是非法的。

那么，如何清理输入呢？

以前，我使用了一些相当暴力的方法，例如[“de-moronize”脚本](http://www.fourmilab.ch/webtools/demoroniser/)，它包含一长串搜索和替换操作。

这仍然是最好的方法吗？还有其他方法吗？

我可以在表单上设置[accept-charset 属性](http://www.w3.org/TR/html401/interact/forms.html#adef-accept-charset)并让浏览器为我做吗？

如果是这样，哪些浏览器会这样做并且可能会出现任何问题？

另外，我的数据库怎么会接受这些字符，它们是 UTF-8 中的保留/控制字符？

如您所见，我对编码的了解足以知道我有问题，但我现在有点超出我的深度......

TIA

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T12:32:22.263

> 此输入文本通常包含不适合输出编码的字符，例如“智能引号”，这些字符来自 Windows-1252 编码的文档

“智能引号”（cp1252 中的字节 147 和 148）是完全有效的 Unicode 字符，U+201C 和 U+201D。您的应用程序应该能够无缝地处理它们；如果没有，你做错了什么，很可能所有非 ASCII 字符都会失败。

无论字符是来自输入它们的人还是来自 Word 粘贴的人，浏览器都应该将 UTF-8 编码的字符提交给您的应用程序，该应用程序应该将相同的 UTF-8 字节存储到数据库中。

如果浏览器未以 UTF-8 格式提交，您可能无法设置包含表单的 HTML 页面的字符集。这可以使用以下方法完成：

```
Content-Type: text/html;charset=utf-8 
```

HTTP 标头和/或：

```
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" /> 
```

<head> 中的元素。

> 我可以在表单上设置 accept-charset 属性并让浏览器为我做吗？

不，由于 IE，accept-charset 基本上没有用，IE 将其误解为“如果页面上的字符集无法编码我们想要的字符，请尝试使用此字符集”，而不是“始终使用此字符集”。这意味着如果您使用 accept-charset ，您最终可能会同时提交多种编码，而无法确定哪个是哪个。好的！

> 我的数据库怎么会接受这些字符，它们是 UTF-8 中的保留/控制字符？

在 MySQL 中，UTF-8 只是一个排序规则，用于比较和排序。它仍然将数据存储为字节，并不真正关心它们是否不是有效的 UTF-8 序列。

无论如何，最好在您的应用程序中解码和检查传入的 UTF-8 序列，因为在现代 Unicode 中无效的“短序列”可以隐藏“<” 旧浏览器仍可识别的字符（至少 IE6 pre-SP2、Opera 7）。

预计到达时间：

> 所以，我输入了一个包含字节 146 的字符串

不，您输入了一个 Unicode 字符 U+201B。浏览器处理 Unicode 字符，而不是字节，直到它必须将序列化的表单提交给服务器。然后它决定如何将字符转换为字节，如果页面被处理为 UTF-8，它将始终选择 UTF-8。

（如果不是 UTF-8，浏览器往往会以不符合标准的方式作弊：对于所有不适合编码的字符，它会将它们编码为 HTML 字符引用，例如 '&#8217;' . 这是错误的，因为您现在无法区分浏览器转义的 '&' 和真实的、用户键入的 '&'，而且这是非常错误的，因为如果您随后将引用作为未转义的 HTML 回显，它看起来就像您做对了一样，实际上您只是制造了一个很大的旧安全漏洞。）

> 它作为 146 进入数据库

真的，一个 '\x92' 字节，而不是 '\xC2\x92'、'\xE2\x80\x99' 或 '&#146;'？

> 它是在我生成（UTF-8 编码的）XML 时出现的，为 146。浏览器没有抱怨

然后它没有作为单个 146 字节出现。当在 XML 文件中给出一个裸露的 '\x92' 时，浏览器会报错。（不是 HTML 文件，其中无效的 UTF-8 序列作为缺失字符字形出现。）

我怀疑它会以“&#146;”的形式出现 字符引用，格式正确（尽管字符 U+0092 是 C1 控件集的一部分，因此不会呈现任何有用的内容）。如果这是正在发生的事情，那么您的表单页面毕竟没有被选择为 UTF-8，并且您正在遭受上述浏览器自动转义提交问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T03:01:40.870

你可以试试 Perl [Encode](http://search.cpan.org/dist/Encode)模块。它支持许多字符集之间的转换，当然包括 UTF-8。我刚刚检查了我的 Perl 安装，它还支持“cp1252”，根据 Wikipedia，这只是 Windows-1252 的另一个名称。您可以使用以下一种衬垫检查您自己的安装：

```
perl -MEncode -e 'print map {"$_\n"} Encode->encodings(":all");' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T02:48:17.510

“我可以在表单上设置 accept-charset 属性并让浏览器为我做这件事吗？”

仅当您准备好信任“浏览器”时-这可能适用于某些应用程序，但总的来说，它会让您对恶作剧敞开心扉（或更糟）。

（另见 bobince 关于 IE 的警告......）

伊恩

# iphone - fbConnect for iphone - Posting photos to news feed and automating a link to itunes app store

> ID：750077
> 
> 赞同：0
> 
> 时间：2009-04-15T02:26:39.473
> 
> 标签：iphone, sdk, photo, fbconnect

is there a way to make a fbConnection for iphone within an app environment on the iphone and post a Photo to your FB newsfeed after a secure login without leaving the iphone app environment?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T07:08:20.717

是的。Facebook 连接可用于 iPhone 和 iTunes URL 只是 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-06T11:32:32.977

ShareKit 为您提供以上所有以及更多功能 - 无需离开应用程序即可登录，将文本/链接/照片直接上传到您的墙上，支持许多社交网络等等！

[http://www.getsharekit.com/](http://www.getsharekit.com/)

# c++ - 分层组件存储结构

> ID：750087
> 
> 赞同：1
> 
> 时间：2009-04-15T02:34:15.337
> 
> 标签：c++, stl

几天来，我一直在脑海中解决这个问题，但没有得出任何令人满意的结论，所以我想我会向 SO 工作人员征求他们的意见。对于我正在开发的游戏，我正在使用[此处](http://cowboyprogramming.com/2007/01/05/evolve-your-heirachy/)和[此处](http://www.drizzle.com/~scottb/gdc/game-objects_files/frame.htm)所述的组件对象模型。它实际上运行得相当好，但我当前的存储解决方案被证明是有限的（我只能通过它们的类名或任意“家族”名称来请求组件）。我想要的是能够请求给定类型并遍历该类型的所有组件或从它派生的任何类型。

考虑到这一点，我首先实现了一个简单的 RTTI 方案，该方案按该顺序通过派生类型存储基类类型。这意味着例如 sprite 的 RTTI 将是：component::renderable::sprite。这使我可以轻松地比较类型，以查看类型 A 是否源自类型 B，只需比较 B 的所有元素：即 component::renderable::sprite 源自 component::renderable 但不是 component::timer。简单、有效且已经实施。

我现在想要的是一种以代表该层次结构的方式存储组件的方法。首先想到的是使用类型作为节点的树，如下所示：

```
 component
       /       \
  timer         renderable
  /              /      \
shotTimer   sprite      particle 
```

在每个节点上，我都会存储该类型所有组件的列表。这样，请求“component::renderable”节点将使我能够访问所有可渲染组件，而不管派生类型如何。问题是我希望能够使用迭代器访问这些组件，以便我可以执行以下操作：

```
for_each(renderable.begin(), renderable.end(), renderFunc); 
```

并让它从可渲染向下迭代整个树。我使用一个非常丑陋的地图/矢量/树节点结构和一个自定义前向迭代器来跟踪我去过的地方的节点堆栈。不过，在实施的过程中，我觉得必须有一种更好、更清晰的方法……我只是想不出一个:(

所以问题是：我是否不必要地过度复杂化了这个？我是否缺少一些明显的简化，或者我应该使用预先存在的结构？或者这只是一个复杂的问题，我可能已经做得很好了？

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T03:09:06.593

您应该考虑多久需要执行以下操作：

*   遍历树
*   从树中添加/删除元素
*   您需要跟踪多少个对象

哪个更频繁将有助于确定最佳解决方案

也许不是制作一个复杂的树，而是拥有一个所有类型的列表，并为它派生的每个类型添加一个指向对象的指针。像这样的东西：

```
map<string,set<componenet *>>  myTypeList 
```

然后对于类型为 component::renderable::sprite 的对象

```
myTypeList["component"].insert(&object);
myTypeList["renderable"].insert(&object);
myTypeList["sprite"].insert(&object); 
```

通过在多个列表中注册每个对象，对给定类型和子类型的所有对象执行某些操作变得容易

```
for_each(myTypeList["renderable"].begin(),myTypeList["renderable"].end(),renderFunc); 
```

请注意，std::set 和我的 std::map 构造可能不是最佳选择，具体取决于您将如何使用它。

或者也许是一种混合方法，只在树中存储类层次结构

```
map<string, set<string> > myTypeList;
map<string, set<component *> myObjectList;

myTypeList["component"].insert("component");
myTypeList["component"].insert("renderable");
myTypeList["component"].insert("sprite");
myTypeList["renderable"].insert("renderable");
myTypeList["renderable"].insert("sprite");
myTypeList["sprite"].insert("sprite");

// this isn't quite right, but you get the idea
struct doForList {
    UnaryFunction f;
    doForList(UnaryFunction f): func(f) {};
    operator ()(string typename) { 
       for_each(myTypeList[typename].begin();myTypeList[typename].end(), func);
   }
}

for_each(myTypeList["renderable"].begin(),myTypeList["renderable"].end(), doForList(myFunc)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T03:09:29.353

答案取决于您需要它们的顺序。您几乎可以选择预购、后购和有序。因此，在广度优先和深度优先搜索中有明显的类似物，通常你很难击败它们。

现在，如果您稍微限制问题，有许多老式算法用于将任意数据树存储为数组。在 FORTRAN 时代，我们经常使用它们。其中一个的关键技巧是将 A 的孩子（比如 A2 和 A3）存储在 index(A)*2,index(A)*2+1 处。问题是，如果你的树很稀疏，你会浪费空间，而且你的树的大小受数组大小的限制。但是，如果我没记错的话，您可以通过简单的 DO 循环以广度优先顺序获取元素。

看看 Knuth 第 3 卷，里面有很多这样的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T11:17:38.103

如果您想查看现有实现的代码，Cowboy Programming 页面中引用的 Game Programming Gems 5 文章附带了我们用于组件系统的代码的精简版本（我做了相当多的设计和实现该文章中描述的系统）。

我需要回去重新检查代码，我现在不能这样做，我们没有像你展示的那样在层次结构中表示事物。尽管组件在代码中存在于类层次结构中，但运行时表示是一个平面列表。组件只是声明了它们实现的接口列表。用户可以查询接口或具体类型。

因此，在您的示例中，Sprite 和 Particle 将声明它们实现了 RENDERABLE 接口，如果我们想对所有可渲染对象执行某些操作，我们只需遍历活动组件列表并检查每个组件。表面上看效率不高，但在实践中还不错。这不是问题的主要原因是它实际上并不是一个非常常见的操作。例如，可渲染对象之类的东西会在创建时将自己添加到渲染场景中，因此全局场景管理器维护自己的可渲染对象列表，并且永远不需要为它们查询组件系统。物理和碰撞组件以及类似的东西也是如此。

# c - 指向结构数组并获取内存的指针

> ID：750091
> 
> 赞同：4
> 
> 时间：2009-04-15T02:35:50.310
> 
> 标签：c, pointers

A`link`是指向节点的指针

```
typedef struct node * link; 
```

在 main() 中，我有以下代码（config->m 只是一些整数）：

```
// array of pointers to structs
link heads[config->m]; 

// make memory for head nodes
for(i = 0; i < config->m; i++)
  heads[i] = malloc(sizeof(struct node)); 
```

该代码有效（这很棒）。**但是有没有一种方法可以`config->m`在没有循环的情况下分配内存块？**我试过

```
link heads[config->m];
heads = malloc(sizeof(struct node) * config->m); 
```

但我友好的邻居编译器告诉我`incompatible types in assignment`

我知道我可以使用

```
struct node heads[config->m]; 
```

但我想用指针来做这些事情。

和往常一样，有人会问我这是否是家庭作业的一部分，答案是肯定的（有点）。但是这个特定的代码块与实际分配没有任何关系。这是为了我自己的启蒙。但是感谢您的询问：|

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T02:48:41.387

不，你需要循环。您的 head 数组本质上是一个二维数组。您至少需要两次分配。第一个是指针数组：

```
link * heads = (link*)malloc (config->m * sizeof (link)); 
```

第二个是heads数组的每个成员指向的内存：

```
link buf = (link)malloc(sizeof(struct node) * config->m);
for(i = 0; i < config->m; i++)
    heads[i] = &buf[i]; 
```

然后取消分配：

```
free(heads);
free(buf); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T02:45:46.430

```
link heads[config->m]; 
link buffer = malloc(sizeof(struct node) * config->m);

for(i = 0; i < config->m; i++)
  heads[i] = &buffer[i];

....
free(buffer); 
```

编辑时：实际上，您不需要`heads`. 首先，让我们摆脱`link`，因为（请参阅 Cannonade 答案中的评论）它只会混淆问题。

让我们假设一个结构节点是一个侵入式链表中的一个节点，看起来像这样：

```
 struct node {
        int val;
        int filler[10]; // this is pure filler, to make node big
        struct node* next;
      }; 
```

现在我们添加我们的包含和 config->m：

```
 #include <stdio.h>
  #include <stdlib.h>
  // your config->m
  const int m = 10 ; 
```

在 main() 中，我们打印节点的大小：

```
 int main() {

     printf( "sizeof( struct node ) = %i\n", sizeof( struct node) ); 
```

现在我们声明一个指向节点的指针：

```
 // na is a node pointer
     struct node* na; 
```

并 malloc 了*m*个节点。malloc 返回数组的地址，也就是数组中第一个节点的地址。我们将 na 设置为 malloc 返回的地址：

```
 na = malloc(sizeof(struct node) * m); 
```

现在我们将使用 na，一个指针，就好像它是一个数组一样。这是有效的，因为 C 定义`array[offset]`为`*(array + offset * sizeof(element))`

```
 int i;
     // we give the first node a val of zero
     na[0].val = 0;
     // and a null next pointer
     na[0].next = 0 ; 
```

现在我们将遍历数组的其余部分，并将每个节点的旁边设置为数组中的*PREVIOUS*节点：

```
 for(i = 1; i < m; i++) {
        na[i].val = i ;
        // na[ offset ] is *(na + offset)
        // we don't want to dereference, 
        // we want the address, so we use the 
        // address-of operator ("&")
        na[i].next = &na[ i - 1 ];
     } 
```

我们的头是数组中的最后一个节点`na[ m - 1]`。列表中的每个`next`都是数组中的前一个节点。同样，如果我们想要指针，我们使用 address-of 运算符，而不是指向的内容：

```
 struct node* current = &na[ m - 1 ]; 
```

我们将打印每个节点的地址。它应该是其`next`节点指针 +的地址`sizeof( struct node)`，因为每个节点都是（在数组中）其在列表中的下一个节点之后的节点（列表是“反转”的数组）。

我们将其转换为 char* 以获取以字节为单位的结果。如果我们不强制转换，我们会得到以`truct node*`（应该始终为 1）为单位的结果。

```
 while( current ) {
        printf( "val %i, address of current %p, ", current->val, current) ;
        printf( " address of current->next %p, ", current->next ) ;
        if( current->next ) {
           printf( " distance from next: ");
           printf( "in bytes %i, ", 
              ( (char*) current)  - (char*) current->next ) ;
           printf( " in struct nodes %i", current  - current->next ) ;
        }
        printf( "\n" );
        current = current->next;   
     }

     return 0;
  } 
```

在我的系统上，这给出了这个输出：

```
 sizeof( struct node ) = 48
  val 9, address of current 0x804a1b8,  address of current->next 0x804a188,  distance from next: in bytes 48,  in struct nodes 1
  val 8, address of current 0x804a188,  address of current->next 0x804a158,  distance from next: in bytes 48,  in struct nodes 1
  val 7, address of current 0x804a158,  address of current->next 0x804a128,  distance from next: in bytes 48,  in struct nodes 1
  val 6, address of current 0x804a128,  address of current->next 0x804a0f8,  distance from next: in bytes 48,  in struct nodes 1
  val 5, address of current 0x804a0f8,  address of current->next 0x804a0c8,  distance from next: in bytes 48,  in struct nodes 1
  val 4, address of current 0x804a0c8,  address of current->next 0x804a098,  distance from next: in bytes 48,  in struct nodes 1
  val 3, address of current 0x804a098,  address of current->next 0x804a068,  distance from next: in bytes 48,  in struct nodes 1
  val 2, address of current 0x804a068,  address of current->next 0x804a038,  distance from next: in bytes 48,  in struct nodes 1
  val 1, address of current 0x804a038,  address of current->next 0x804a008,  distance from next: in bytes 48,  in struct nodes 1
  val 0, address of current 0x804a008,  address of current->next (nil), 
```

# iphone - iphone app buyer information

> ID：750092
> 
> 赞同：-1
> 
> 时间：2009-04-15T02:36:47.497
> 
> 标签：iphone, sdk, itunes

do you get iphone app buyer information once your app is on the app store? like emails and such?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T02:47:31.590

你不可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T02:57:05.827

您确实会获得销售信息，重点是销售来自世界的哪个地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-03T20:51:32.710

有许多 iphone 应用程序库可提供详细的使用信息，并提供有关用户的更多详细信息。根据这些信息的可用性，其中一些库甚至提供至少部分用户的年龄和性别。

执行此操作的库之一是[pinchmedia](http://www.pinchmedia.com/)，但它们现在已被 Flurry 接管。我猜[flurry](http://www.flurry.com/)会提供同样的功能。移动广告提供商 AdMob 最近启动了他们[的“分析”测试版](http://analytics.admob.com/home/)，它应该提供类似的功能。

# python - find missing numeric from ALPHANUMERIC - Python

> ID：750093
> 
> 赞同：1
> 
> 时间：2009-04-15T02:36:48.077
> 
> 标签：python, list, filenames, alphanumeric

How would I write a function in Python to determine if a list of filenames matches a given pattern and which files are missing from that pattern? For example:

Input ->

```
KUMAR.3.txt
KUMAR.4.txt
KUMAR.6.txt
KUMAR.7.txt
KUMAR.9.txt
KUMAR.10.txt
KUMAR.11.txt
KUMAR.13.txt
KUMAR.15.txt
KUMAR.16.txt 
```

Desired Output-->

```
KUMAR.5.txt
KUMAR.8.txt
KUMAR.12.txt
KUMAR.14.txt 
```

* * *

Input -->

```
KUMAR3.txt
KUMAR4.txt
KUMAR6.txt
KUMAR7.txt
KUMAR9.txt
KUMAR10.txt
KUMAR11.txt
KUMAR13.txt
KUMAR15.txt
KUMAR16.txt 
```

Desired Output -->

```
KUMAR5.txt
KUMAR8.txt
KUMAR12.txt
KUMAR14.txt 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T02:59:26.710

您可以这样处理：

1.  将文件名转换为适当的整数。
2.  找出缺失的数字。
3.  将缺失的数字与文件名模板结合起来作为输出。

对于（1），如果文件结构是可预测的，那么这很容易。

```
def to_num(s, start=6):
    return int(s[start:s.index('.txt')]) 
```

鉴于：

```
lst = ['KUMAR.3.txt', 'KUMAR.4.txt', 'KUMAR.6.txt', 'KUMAR.7.txt',
       'KUMAR.9.txt', 'KUMAR.10.txt', 'KUMAR.11.txt', 'KUMAR.13.txt',
       'KUMAR.15.txt', 'KUMAR.16.txt'] 
```

您可以通过以下方式获取已知号码列表：`map(to_num, lst)`。当然，要寻找差距，你只需要最小值和最大值。将它与`range`函数结合起来，你会得到所有你应该看到的数字，然后删除你已经得到的数字。套装在这里很有帮助。

```
def find_gaps(int_list):
    return sorted(set(range(min(int_list), max(int_list))) - set(int_list)) 
```

把它们放在一起：

```
missing = find_gaps(map(to_num, lst))
for i in missing:
    print 'KUMAR.%d.txt' % i 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T02:46:38.427

假设模式是相对静态的，这很容易使用正则表达式：

```
import re

inlist = "KUMAR.3.txt KUMAR.4.txt KUMAR.6.txt KUMAR.7.txt KUMAR.9.txt KUMAR.10.txt KUMAR.11.txt KUMAR.13.txt KUMAR.15.txt KUMAR.16.txt".split()

def get_count(s):
    return int(re.match('.*\.(\d+)\..*', s).groups()[0])

mincount = get_count(inlist[0])
maxcount = get_count(inlist[-1])
values = set(map(get_count, inlist))
for ii in range (mincount, maxcount):
    if ii not in values:
        print 'KUMAR.%d.txt' % ii 
```

# javascript - 表上的更改事件在 IE 中失败

> ID：750095
> 
> 赞同：1
> 
> 时间：2009-04-15T02:38:16.963
> 
> 标签：javascript, jquery, events, delegation

我正在使用 jQuery 来捕获表上的更改事件。该表有很多行，每行有几个输入框和一个复选框。为此，我正在使用事件委托。我正在捕获 tbody 级别的任何更改。这是下面的代码

```
$j('#orderItems tbody').change(function (event) {
    var target = $j(event.target);
    var nodeName = $j(target).attr('nodeName').toLowerCase();
    if (nodeName == 'input') {
        if ($j(target).hasClass('partnum')) {
            var val = $j(target).attr('value');
            dsOrder.getItem(target);
            dsOrder.updateActiveIndex(target);
        }
        if ($j(target).hasClass('qty')) {
            var val = $j(target).attr('value');
            dsOrder.updateQty(target);
            dsOrder.updateActiveIndex(target);
        }
        if ($j(target).hasClass('unitprice')) {
            var val = $j(target).attr('value');
            dsOrder.updatePrice(target);
            dsOrder.updateActiveIndex(target);
        }
    }
}) 
```

此代码在 Firefox 中运行良好，但更改事件未在 IE 中捕获。我想使用事件委托来处理这个解决方案，而不是将每个事件附加到每个输入元素上。我还想避免使用 jQuery 来定位每个元素，因为表行是动态构建的，并且取消绑定/绑定事件似乎有点混乱（只是我的看法）

关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T12:19:45.210

您实际上是在使用冒泡来获取祖先元素上的事件，而不是捕获（IE 不支持且 jQuery 不使用）。不幸的是，虽然`onchange` [DOM 规范中有气泡，](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-htmlevents)但[IE 中没有](http://msdn.microsoft.com/en-us/library/ms536912(VS.85).aspx)。

我认为您只需要针对输入。（不幸的是，'live' 功能也不支持 onchange。）

# xml - 评估生成的 XML Schema 的准确性

> ID：750098
> 
> 赞同：0
> 
> 时间：2009-04-15T02:39:53.670
> 
> 标签：xml, xsd

我在网上找到了一些为给定 XML 数据实例生成 XML Schema 的工具。类似的东西 -[链接文本](http://www.xmlforasp.net/CodeBank/System_Xml_Schema/BuildSchema/BuildXMLSchema.aspx)

我也在考虑开发一个，但我对生成的模式的评估有点困惑。

如何评估生成的模式，即生成的模式确认给定数据？是否有任何方法可以制定某种准确度度量，表明生成的 XML 模式对于给定的 XML 数据正确率为 80% 或 90%？

请帮助我解决任何问题。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T10:12:16.560

我相信你要求的是不可能的。自动生成的模式（我使用[Examplotron](http://examplotron.org/)）永远不可能完全准确，因为生成工具没有足够的信息。

例如，如果`<foobar>`XML 文档中有一个元素，生成工具如何知道它是否是强制性的？如果接受多个值？在不知道原始模式的情况下，您无法判断生成的模式是否准确。（Examplotron 通过允许作者在 XML 文件中放置结构化注释来指导程序来解决这个问题。）

这是一个例子。使用此 XML 文件：

```
<data>
<foo>1</foo>
<bar>text</bar>
<baz/>
</data> 
```

Examplotron 生成了这个模式（有点编辑）：

```
start =
  element data {
    element foo { xsd:integer },
    element bar { text },
    element baz { empty }
  } 
```

注意`xsd:integer`元素中的`<foo>`。很好的推论，但是，它准确吗？可能`<foo>`应该是更通用的类型，例如`xsd:any`...

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-15T03:06:08.770

从现有 XML 文档生成的模式只会与原始 XML 一样好。如果您的示例 XML 是将要使用的 XML 的完整示例，那么您生成的模式将起作用。如果它不完整或形成不良，它不会。

# html - designing with tables

> ID：750101
> 
> 赞同：4
> 
> 时间：2009-04-15T02:40:55.990
> 
> 标签：html, css

I have been designing websites table-less for a while now. the problem is that it can take a very long time to finish the site. People who design using tables can finish much faster. What's a good tutorial or of related to do such a thing?

I know this is wrong but I've noticed a lot of clients don't really care and they want their site asap. doing it the div way, depending on the site can take forever.

PS: I've tried designing the site in say Photoshop or Illustrator then exported the design as a webpage, but when it comes to modifying the design, i cant wrap my head around getting the site to show correctly.. and usually i get pissed of and start hand coding it. i find hand coding alot easier then anything else. i think its a bad habit or can be. i take longer doing it by hand thought.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T03:15:00.603

基于表格的布局非常简单，至少在概念上是这样。表以 开头`<table>`和结尾`</table>`。里面有零个或多个行 ( `<tr>...</tr>`)，其中有零个或多个列 ( `<td>...</td>`)。还有一些其他标签（`thead`/ `tbody`/ `tfoot`，`th`用于标题单元格），但这实际上是您需要了解的有关表格的全部内容 - 无需教程。

表的主要优点是：

1.  表格的大小根据内容的大小进行调整
2.  列始终对齐，便于垂直排列内容
3.  易于编码 - 几行 HTML 就足以构成基本结构
4.  普遍支持 - 该表将在旧/奇怪的浏览器中正常显示和运行（我在看着你，IE！）

表格的缺点包括与 CSS 的“复杂”关系状态，`div`更不用说同行的蔑视了。表格不是`div`CSS 的完全替代品，但不要让任何人告诉你`div`CSS 也是表格的完全替代品。

在尝试为表格设计样式时，您可以使用一些东西来使其看起来像您想要的那样：

1.  `border`- 这定义了表格单元格周围和之间的边界
2.  `padding`- 这是内容和单元格边缘之间的填充量
3.  `text-align`- 单元格内内容的水平对齐
4.  `vertical-align`- 单元格内内容的垂直对齐（用于垂直居中！）
5.  `border-collapse`- 您可以折叠边框以删除单元格之间的任何间距

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T02:45:25.807

W3Schools 有一个很好的教程：

[http://www.w3schools.com/html/html_tables.asp](http://www.w3schools.com/html/html_tables.asp)

您可能需要花时间学习使用 DIV、CSS 等，因为从 Photoshop 和 Illustrator 导出网站只会在您需要进行小调整时让您头疼。（以及许多其他场景。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T02:48:37.203

如果您使用表格，那么当您尝试做任何花哨的 DHTML 时，您会更加头疼。表格元素不是块元素，它们不是盒子元素，它们是表格。

如果您只有一个没有 javascript 的静态 HTML 站点，那么您的问题就不会那么严重，但是无表格设计的一点是将设计和结构分开。这是值得学习css的麻烦。

例如，当您想稍后进行调整时，忘记查找表格布局设计的好处和无需头疼的问题，将所有设计规则放入 css 文件可减少客户端的后续下载，因为即使您的标记也会缓存您的 css页面是通过 PHP 动态生成的。这使您的网站加载速度更快。

无论如何，许多开发人员都可以创建 css 无表布局，就像其他人创建一些丑陋的 table + spacer.gif 网站一样快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T02:49:42.663

问题不就是 div 布局的教程吗？我刚刚阅读了一本关于 Web 可访问性的书，该书非常强烈地说明了对 div 布局的偏好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T02:56:55.813

您的论点是有效的，用表格编写网站的速度要快得多。表格的问题在于，从长远来看，它们更难维护。通过使用 div，您在将来调整样式或布局更改时将有一个更简单的时间。

如果您正在创建的网站将需要（非常）很少或不需要未来的维护，那么表格可以说是更好/更快。但是，如果您计划在未来对网站设计/布局进行更改（即使只是平均数量的更改/修复），以 div 为中心的设计将更有价值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T02:53:45.367

网上有很多可用的教程，但我将采取不同的方式来回答我的问题。

您创建这些页面是为了以正确的方式做事，还是出于商业目的而创建它们？

如果是前者，那么一定要尽可能多地了解 CSS 类型的解决方案。无论如何，您都应该这样做，但不要让它妨碍交付。

如果是后者，我怀疑客户是否关心代码背后的“纯粹”程度，只要它看起来还不错。他们主要关心的是交付速度和在所有主要浏览器上的良好渲染。

这就是为什么我仍然使用表格来布局我交付给客户的东西的原因。我也只在三个浏览器上测试它（我不会说哪个），因为这是我的客户所关心的。他们真的不在乎 iPhone 上的 Opera（例如）是否正确渲染，因为那不是他们的目标市场。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T02:54:50.153

也许我是一个[Luddite](http://en.wikipedia.org/wiki/Luddite)，但我认为使用表格进行页面布局没有任何问题。它无处不在，正如您所说，用户理所当然地不太在意。请注意，我说**的是一张**桌子；多个嵌套表站点是维护的噩梦。并且仅仅因为您使用表格作为线框并不意味着您不应该广泛使用 CSS 来设置它和您网站的其余部分的样式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T08:08:17.780

我所知道的最好的教程网站是[htmldog](http://www.htmldog.com)，尽管有这个名字，但它主要是关于 css 的。

还有两个使用 div 复制表样设计的宝贵站点是：

1.  [人造列](http://www.alistapart.com/articles/fauxcolumns/)（用于使 div 等高
2.  该站点将为您生成基本的跨浏览器页面布局 html 和 css：http: [//fu2k.org/alex/css/onetruelayout/example/interactive](http://fu2k.org/alex/css/onetruelayout/example/interactive)

坚持使用 div - 当你习惯它时，它会成为第二天性，甚至可能比表格更快

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T03:59:00.093

您可以通过使用正确的 HTML 标记获得两全其美，然后在 CSS 中使用属性的各种[不同的与表格相关的值](https://developer.mozilla.org/en/CSS/display#Values)`display`。

至于在*HTML*中使用表格，这是 W3C 所说的（参见[HTML 文档中的表格](http://www.w3.org/TR/1999/REC-html401-19991224/struct/tables.html#h-11.1)）：

> 表格不应纯粹用作布局文档内容的一种方式，因为这可能会在呈现到非可视媒体时出现问题。此外，当与图形一起使用时，这些表格可能会迫使用户水平滚动以查看在具有更大显示器的系统上设计的表格。为了尽量减少这些问题，作者应该使用样式表而不是表格来控制布局。

史蒂夫

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T06:29:08.640

如果您喜欢表格，了解表格并且它们不会对您造成错误，那么请坚持使用它，但是“使用 div”可能会非常自由。您确实需要了解定位，但我没有找到比以下更好的教程来教您如何定位 div

[http://www.barelyfitz.com/screencast/html-training/css/positioning](http://www.barelyfitz.com/screencast/html-training/css/positioning/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-18T03:28:32.593

在 HTML 网页创建中，页面上的表格创建被声明在内容的主体内，表格可以被声明 `<table>`并结束，`</table>`然后表格标题`<theader></theader>` 然后行已经初始化`<tr>content</tr>`表格数据使用`<td>content</td>`表格边框和宽度高度字体插入style 字体粗细背景在 css 中声明。

# asp.net - 有哪些好的 SQL Server 2008 w/ASP.NET 网站托管服务提供商？

> ID：750103
> 
> 赞同：3
> 
> 时间：2009-04-15T02:42:48.687
> 
> 标签：asp.net, sql-server, sql-server-2008, hosting

有哪些支持 SQL Server 2008 和 ASP.NET 2.0/3.5 的托管服务提供商？

我已经知道[DiscountASP.NET](http://www.discountasp.net/index.aspx?refcode=PIETSCH)（我用他们托管我的博客），但我想知道是否还有其他好的托管公司。[GoDaddy 托管](http://www.godaddy.com/gdshop/hosting/shared.asp?ci=8971)也不错，但它们还不支持 SQL 2008。

此外，我愿意寻找共享、专用和虚拟专用托管服务提供商。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T17:00:34.347

如果您是一家初创公司（基于软件的私有公司，成立不到 3 年，年收入不到 100 万美元），您可以加入 Microsft BizSpark。BizSpark 站点是[http://microsoft.com/bizspark](http://microsoft.com/bizspark)。

BizSpark 是一个为期三年的计划。在此期间，它包括修改后的 MSDN Premium 订阅以及在生产环境中托管您的应用程序的权利，而无需支付软件许可费用。该计划费用为 100 美元，在三年结束时支付。

有许多支持 BizSpark 计划的托管商，他们都支持 SQL Server 2008。BizSpark 站点将按国家/地区为您列出它们。以下是您将在美国看到的：

艾字节

去吧爸爸

GoGrid/ServePath

对等体1

互联网解决方案

运营商

导航网站

机架空间

维兹莫

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T03:31:26.027

两周前刚用[ServerBeach](http://www.serverbeach.com/servers/bizspark.php)站起来 Win2008/SQL2008 。印象非常深刻。他们还为符合条件的人提供了一个很棒且超级易于使用的 BizSpark 程序。

值得一提的是，Javier Enriquez（serverbeach dot com 的哈维尔）是我们指定的客户代表，非常乐于助人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T02:47:50.060

我们刚刚将几个网站切换到[WebHost4Life](http://www.WebHost4Life.com/default.asp?refid=garyray)

控制面板很直观，服务（24/7 实时和消息灵通的聊天支持）非常好。价格非常合理，在相同的托管计划下，您可以托管多个站点和数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T03:30:26.200

直到最近我才使用[HostMySite](http://www.hostmysite.com/)，体验很棒。通过聊天、电子邮件和电话提供 24/7 全天候支持。我使用聊天支持的几次他们都很棒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T03:38:04.200

使用 WebHost4Life ，成为他们的客户 8-9 个月了，到目前为止体验非常好。

# .net - 微软的 CCR 与任务并行库

> ID：750104
> 
> 赞同：6
> 
> 时间：2009-04-15T02:43:52.020
> 
> 标签：.net, ccr, task-parallel-library

Microsoft 至少有两种不同的方法来改进对并发操作的支持。

1) 是并发协调运行时 (CCR)，它是 Microsoft Robotics Studio 和[CCR & DSS Toolkit的一部分](http://www.microsoft.com/ccrdss/)

2) 任务并行库 ( [TPL](http://software.intel.com/en-us/blogs/2009/03/27/task-parallel-library-beta-1/) )（.NET 4.0 的一部分，现在处于 Beta 1 版本中）

我想知道是否有人对这两种不同的软件有经验并会比较和对比它们？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-20T20:21:24.510

总的来说，这两个框架具有互补但不同的目标。

CCR 提供了用于协调并发进程的原语。协调是使一堆进程作为一个整体工作的粘合剂——因此 CCR 提供了通过所谓的通道交换消息的原语。进程可以等待消息到达一个通道，或多个通道，或多个通道中的任何一个，等等。这是协调运行良好的并发进程的特殊范例。另请注意，它不是免费的 - 如果从 Microsoft 单独购买，您必须购买。

TPL 提供原语和基础设施以半自动地*并行化计算或算法。*最明显的原语之一是并行 for 循环 - 看起来有点像 for 循环，但尝试并行执行循环。

因此，如果您有一堆进程想要在比使用共享状态和锁更高的级别上进行协调，请使用 CCR。如果您希望在多核机器上高效运行计算密集型进程，请使用 TPL。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-21T16:39:08.010

这不是一个非此即彼的场景。CCR 是一个支持某些编程模式的库。您可以像这样混合 CCR 和 TPL 代码，这是一个 Parallel.For 在接收委托内部：

```
using System;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.Ccr.Core;

namespace Demo
{
    public class Program
    {
        public static void Main(string[] args)
        {
            Dispatcher dispatcher = new Dispatcher();
            DispatcherQueue taskQueue = new DispatcherQueue("Demo", dispatcher);
            Port<int> portInt = new Port<int>();
            portInt.Post(Int32.Parse(args[0]));

            Arbiter.Activate(
                taskQueue,
                portInt.Receive(delegate(int count)
                {
                    Parallel.For(0, count, i =>
                    {
                        Console.Write(i.ToString() + " ");
                    });
                }
            ));
        }
    }
} 
```

# c# - int[] to byte[], am i forgetting something?

> ID：750105
> 
> 赞同：2
> 
> 时间：2009-04-15T02:44:02.880
> 
> 标签：c#

This is untested as i need to write more code. But is this correct and i feel like i am missing something, like this could be better written. Do i need the c.lose at the end? should i flush anything(i'll assume no if i do close())?

```
Byte[] buffer;
using (var m = new MemoryStream())
{
    using (var binWriter = new BinaryWriter(m))
    {
        foreach (var v in wordIDs)
            binWriter.Write(v);
        binWriter.Close();
    }
    buffer = m.GetBuffer();
    m.Close();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T02:50:37.170

您不需要 .Close() 调用（使用块生成的自动 .Dispose() 会处理这些）。

此外，您需要在 MemoryStream 上使用 .ToArray()，而不是 .GetBuffer()。GetBuffer() 返回底层缓冲区，无论它使用了多少。ToArray() 返回一个完美长度的副本。

如果您使用它与另一个程序通信，请确保您和它就字节顺序（也称为字节顺序）达成一致。如果您使用网络字节顺序，则需要翻转字节顺序（使用类似 IPAddress.HostToNetworkOrder()），因为网络字节顺序是 big-endian，而 BinaryWriter 使用 little-endian。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T02:57:17.217

什么是 wordID，是枚举还是 Int32[]？如果它只是 Int32[]，则可以使用以下内容：

```
byte[] bytes = new byte[wordIDs.Length * 4];
Buffer.BlockCopy(wordIDs, 0, bytes, 0, bytes.Length); 
```

否则，如果 wordIDs 是您必须逐步完成的枚举，您需要更改的只是删除 m.Close（如前所述）并使用 MemoryStream.ToArray（如前所述）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T02:49:57.530

此处不需要关闭。using 语句将确保在退出时调用这些类型的 Dispose 方法，这与调用 Close 具有相同的效果。事实上，如果您查看反射器中的代码，您会发现在这两种情况下 Close 只是代理了两种类型的 Dispose 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T02:52:38.897

[飞碟](http://bytes.com/groups/net-c/265767-memorystream-binarywriter-buffering-question)这样说：

> 没有真正*需要*关闭 MemoryStream 或 BinaryWriter，但我认为使用 using 语句来处理两者是一种很好的形式 - 这样，如果您以后更改为使用*确实*需要处理的东西，它将适合进入相同的代码。

因此，您不需要 Close 或 using 语句，但 using 是惯用的 C#。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T03:39:34.260

JaredPar 和 Jonathan 的回答是正确的。如果您想要替代方案，请使用`BitConverter.GetBytes(int)`. 所以现在你的代码变成了这个

```
wordIDs.SelectMany(i => BitConverter.GetBytes(i)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T06:38:59.897

我不同意这里的飞碟。

虽然您可能*不需要*使用 using 来关闭，但您依赖 BinaryWriter 和 MemoryStream 的实现在 Dispose 方法中为您执行此操作。这对于框架类型来说是正确的，但是如果有人编写了一个不这样做的 Writer 或 Stream 怎么办？

添加 close 没有害处，并且可以保护您免受编写错误的类的影响。

# iphone - 如何更改索引 UITableView 中侧面字母的颜色？

> ID：750119
> 
> 赞同：47
> 
> 时间：2009-04-15T02:49:30.090
> 
> 标签：iphone, uitableview

我有一个带有字母索引的表格视图，并且正在使用侧面字母快速浏览列表。对于那些不熟悉的人，使用这个：

```
- (NSInteger)tableView:(UITableView *)tableView sectionForSectionIndexTitle:(NSString *)title atIndex:(NSInteger)index { 
```

我的问题是我的应用程序刚刚被涂成黑色。所以现在很难看到侧面的字母。

我不知道如何改变字母的颜色。如果可能的话，我希望它是“白色的”。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-08-14T04:21:30.880

如果您的最低 iOS 版本高于 6.0，则可以使用`sectionIndexColor` .`UITableView`

> 用于表格视图的索引文本的颜色。
> 
> @property(nonatomic, 保留) UIColor *sectionIndexColor
> 
> 讨论：
> 
> 表格视图可以在视图的侧面显示一个索引，使用户更容易快速浏览表格的内容。此属性指定用于在此区域中显示的文本的颜色。

* * *

**更新日期 2014.1.13**

我找到了一个开源第三方库：[GDIIndexBar](https://github.com/gdavis/GDIIndexBar)来帮助自定义索引外观。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-17T02:44:24.387

不幸的是，据我所知，无法自定义索引中显示的文本的颜色，我能做到的最接近的是能够修改索引的背景颜色和字体。

Erica Sadun 编写的 iPhone 开发者食谱中有一些代码显示了如何访问 UITableViewIndex 视图（一个未记录的类）。如果你有的话，你可以在本书的第 175 页找到它的参考资料。这可以访问背景颜色和字体。[您可以在此处](http://ericasadun.com/iPhoneDocs220/interface_u_i_table_view_index.html)查看与该课程相关的非官方文档。

**警告**这是对未记录类的未记录使用，因此您需要谨慎使用它。

这是食谱中的代码片段，稍作修改：

```
- (UITableViewCell *)tableView:(UITableView *)tv cellForRowAtIndexPath:(NSIndexPath *)indexPath {    

  for(UIView *view in [tv subviews])
  {
    if([[[view class] description] isEqualToString:@"UITableViewIndex"])
    {

      [view setBackgroundColor:[UIColor whiteColor]];
      [view setFont:[UIFont systemFontOfSize:14]];
    }
  }

  //rest of cellForRow handling...

} 
```

这说明了如何访问 UITableViewIndex 视图并在某些方面对其进行修改。看起来该视图没有任何子视图，因此它可能会使用索引标题数组进行一些自定义绘图。

它并不完美，但希望它会有所帮助。

保罗

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-06-25T10:22:50.217

这可以在 UITableView 的界面构建器中轻松更改 - 不需要使用未记录的类？

看下面的截图，你可以看到字体颜色和背景颜色也可以改变。乔布斯是个好人！

![](https://i.stack.imgur.com/ilc3m.png)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2015-09-09T16:07:21.840

对于 iOS7 或更高版本：

```
self.tableView.sectionIndexColor = [UIColor whiteColor];
self.tableView.sectionIndexBackgroundColor = [UIColor clearColor]; 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2011-10-25T10:14:22.087

我遇到了同样的问题，只是找到了一种方法，尽管这是使用未记录的类和方法，所以在尝试将其上传到 App Store 之前要多考虑一下。我应该说我只在 iOS5 上试过这个，所以我不知道它是否适用于以前的版本。

我借用并修改了 Erica Saunders 食谱示例，现在将文本颜色更改为红色：

```
- (UITableViewCell *)tableView:(UITableView *)tv cellForRowAtIndexPath:(NSIndexPath *)indexPath {    

  for(UIView *view in [tv subviews])
  {
    if([[[view class] description] isEqualToString:@"UITableViewIndex"])
    {
      [view performSelector:@selector(setIndexColor:) withObject:[UIColor redColor]];
    }
  }

  //rest of cellForRow handling...

} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-05-02T11:37:54.147

我们已经成功使用了以下代码：

```
for(UIView *view in [tableView subviews]) {
    if([view respondsToSelector:@selector(setIndexColor:)]) {
        [view performSelector:@selector(setIndexColor:) withObject:[UIColor whiteColor]];
    }
} 
```

效果很好 - 它与 Mooglas 的答案非常相似 - 但避免使用“UITableViewIndex”这个词。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-11-06T11:33:54.877

您可以为 tableView 设置色调颜色。

```
[[UITableView appearance] setTintColor:[UIColor purpleColor]]; 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2018-08-14T08:33:13.410

**斯威夫特 5：**

```
tableView.sectionIndexColor = .red
tableView.sectionIndexBackgroundColor = .clear 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-11-04T15:47:08.340

有一种方法可以更改索引 Alphabet 的颜色。

在你的头文件中，将你的 UITableView 声明为一个属性：

```
@property (weak, nonatomic) IBOutlet UITableView *mainTable; 
```

然后在您的实现文件的 viewDidAppear 中，使用以下行：

```
//Change the color of the UITableView index color
_mainTable.sectionIndexColor = [UIColor blackColor]; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-11-17T22:26:08.390

这是我找到的调整侧面索引栏背景颜色的最佳解决方案。它适用于 iOS7 并且可能适用于 iOS6。

将此添加到您的 viewDidLoad

```
if ([_tableView respondsToSelector:@selector(setSectionIndexColor:)]) {
    _tableView.sectionIndexBackgroundColor = [UIColor clearColor];
    _tableView.sectionIndexTrackingBackgroundColor = [UIColor whiteColor];
} 
```

第一个是默认颜色，第二个是滚动时的背景颜色。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-18T21:28:52.833

制作一个可变数组以包含备用标题标签 In

```
-(NSArray * )sectionIndexTitlesForTableView:(UITableView * )tableView 
```

返回一个 @" " 数组，其中引号之间的空格数决定了高亮滚动条的宽度。让“sectionIndexTitlesForTableView”调用更新标签函数。在该函数中，从它们的超级视图中删除您之前创建的数组中的所有标签然后创建并添加需要的标签。然后将它们添加到表的超级视图中。

这些是将标签放置在正确位置所需的行。

```
rect.origin.x = table.frame.origin.x+table.frame.size.width-rect.size.width-2;
rect.origin.y = 5+table.frame.origin.y+counter *(280-rect.size.height-([customIndexLabels count]-1))/([customIndexLabels count]-1);
if ([customIndexLabels lastObject]==thisLabel)
{
   rect.origin.y-=10;
} 
```

希望有帮助。不完美我只是懒得自己修。主要问题是最后一个标签的间距不均匀。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2015-09-17T08:37:15.907

用于未记录字体更改的 Swift 版本：

```
extension NSObject {

    class func objectClassName() -> String {

        let classLongName = reflect(self.self).summary;

        let tokens = classLongName.componentsSeparatedByString(".")

        if let typeName = tokens.last {

            return typeName
        }

        return NSStringFromClass(self.dynamicType)
    }
}

func changeSectionIndexFont(tableView: UITableView) -> Void {

        let realSubviews = tableView.subviews as! [UIView]

        for subview in realSubviews {

            if subview.dynamicType.objectClassName() == "UITableViewIndex" {

                subview.setValue(UIFont(name: "OpenSans", size: 10), forKey: "font")
            }
        }
    } 
```

# git-svn - git-svn fetch 时 RA 层请求失败

> ID：750120
> 
> 赞同：15
> 
> 时间：2009-04-15T02:49:33.240
> 
> 标签：git-svn

我使用 git svn 与 subversion repos 同步：

```
$ mkdir prj && cd prj
$ git svn init http://url/to/repos/branches/experimental
$ git svn fetch 
```

并收到错误消息：

```
RA layer request failed: OPTIONS of 'http://url/to/repos/branches/experimental':
Could not read status line: connection was closed by proxy server 
(http://url/to/repos) at /usr/bin/git-svn line 1352 
```

为什么以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-03-25T08:58:54.787

**通过代理**访问 SVN 存储库时我遇到了同样的问题。

我的解决方案是编辑`~/.subversion/servers`并将所需的代理添加到该`[globals]`部分。取消注释相关行（`http-proxy-host`、`http-proxy-port`、可选`http-proxy-username`和`http-proxy-password`）并在此处输入所需信息。

这是必需的，因为`git svn`使用存储在其中的设置`~/.subversion/servers`来访问 SVN 存储库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-08T18:59:23.923

这似乎是服务器上的超时问题。这是[一个错误报告](http://sourceforge.net/apps/trac/sourceforge/ticket/1576)（不幸的是，我无法访问与其重复的票证）。这对我来说发生了很多，但如果我再次尝试该命令，它会在再次超时之前变得更远。最终，我将拥有整个存储库，我希望不必再这样做了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-14T16:35:23.767

我亲眼目睹了类似的

> 无法读取响应正文：连接已被服务器关闭

我可以通过在 Apache 配置中将**Timeout**设置为 6000 来解决它。

# iphone - 如何在 iPhone 上优化 UIColor？

> ID：750124
> 
> 赞同：0
> 
> 时间：2009-04-15T02:50:33.067
> 
> 标签：iphone, uikit, core-animation, calayer

我正在创建一个由自定义滑块类型控件控制的简单颜色选择器。

我将一个浮点值从我的滑块传递到 UIColor 构造函数方法，并随着值的变化更新 CALayer 的背景颜色。

它在模拟器中运行非常流畅，但在设备上运行时会出现很多闪烁。

这仅仅是因为它对 GPU 过度征税吗？奇怪的是，当穿过蓝色时，这是最糟糕的。并且改变 alpha 值和亮度比改变饱和度和色调更容易闪烁。

我不应该在滑块值更改时传递任意浮点值吗？如果没有，我如何将其限制为更少的颜色以进行优化？

我想过禁用 CALayer 的 backgroundColor 属性的隐式动画，但我不知道该怎么做。

是否有任何优化 UIColor 更改的技巧。

**更新**

我没有使用 drawRect: 或 drawInRect:

我只是在更改 CALayer 的 backgroundColor 属性。每次调用 touchesMoved: 时，我都会抓取位置，创建一个 0.0 到 1.0 的浮点值，并向我的委托传递一条消息，告知该值已更改，然后调用 -(void)updateCurrentColor 方法。

这是我的实现示例：

```
@implementation MyCustomSliderView

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

    hueLocation = [[touches anyObject] locationInView:self];

    //Smoothing
    if ((hueLocation.x > previousHueLocation.x) && ((hueLocation.x - previousHueLocation.x) > 1.0) && (hueLocation.x - previousHueLocation.x) < 10.0) {
        hueLocation.x = previousHueLocation.x + 1.0;
    }   

    if ((hueLocation.x < previousHueLocation.x) && ((previousHueLocation.x - hueLocation.x) > 1.0) && (previousHueLocation.x - hueLocation.x) < 10.0) {
        hueLocation.x = previousHueLocation.x - 1.0;
    }   

    //Percentage of screen.
    hueValue = hueLocation.x/self.bounds.size.width;

    //Clip to 1.0 & 0.0
    if (hueValue > 1.0) {
        hueValue = 1.0;
    }
    if (hueValue < 0.0) {
        hueValue = 0.0;
    }

    NSLog(@"Value is: %f", hueValue);
    NSLog(@"Location %f", hueLocation.x);   

    previousHueLocation = hueLocation;

    if([delegate respondsToSelector:@selector(updateCurrentColor)]) {
        [delegate updateCurrentColor];
    }

}

@implementation MyViewController

- (void)updateCurrentColor {

    currentColor = [UIColor colorWithHue:hueSliderView.hueValue
                              saturation:saturationSliderView.saturationValue
                              brightness:brightnessSliderView.brightnessValue
                                   alpha:alphaSliderView.alphaValue];

    colorLayer.backgroundColor = currentColor.CGColor;  

} 
```

起初我认为这是由于触摸界面的不精确造成的跳跃值。平滑功能有所帮助，但它仍然会闪烁一些，尤其是在使用 alpha 值时，即使我的位置仅改变 1 个像素。我应该将其限制为有限数量的颜色/值，而不是仅仅传入任意浮点数吗？同样，在模拟器中运行良好，似乎只是一个性能问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T02:32:06.303

禁用隐式动画消除了闪烁。

我更新了颜色更改方法，以便在从 touchesBegan: 调用时背景颜色可以动画，但在从 touchesMoved 调用时不会隐式动画：

```
- (void)updateCurrentColorAnimated:(BOOL)animated {

    currentColor = [UIColor colorWithHue:hueSliderView.hueValue
                              saturation:colorView.saturationValue
                              brightness:colorView.brightnessValue
                                   alpha:alphaSlider.alphaValue];
    if (animated) {

        colorLayer.backgroundColor = currentColor.CGColor;

    }   

    if (!animated) {

        [CATransaction begin];

        [CATransaction setValue:(id)kCFBooleanTrue
                         forKey:kCATransactionDisableActions];

        colorLayer.backgroundColor = currentColor.CGColor;

        [CATransaction commit];

    }

} 
```

我滚动自己的滑块的原因是我可以跳转到新值，而不必完美地捕捉小滑块控件，我发现它的交互不是很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T12:05:57.100

在 iPhone 上绘图是双缓冲的。如果你开始闪烁，那是因为你在画一个东西然后另一个 - 这不是因为速度问题。

我猜你正在犯以下错误之一：

*   更新你的颜色值和绘制你的颜色方块不同步（所以当你drawInRect时颜色设置不正确：）
*   未能正确初始化/计算您的颜色（因此您显示无效颜色）
*   当你不应该擦除或重绘你的矩形

另一件事要检查... Cocoa 中的颜色是从 0 到 1 的浮点数。将整数值设置为 0 到 255（在 web 或 Windows 上使用）将导致严重的奇怪问题。如果您的颜色计算超过 0 到 255，则在设置 UIColor 之前除以 255.0。

# delphi - 将客户端应用程序迁移到 FB 2.1

> ID：750127
> 
> 赞同：2
> 
> 时间：2009-04-15T02:52:15.823
> 
> 标签：delphi, firebird, delphi-7

我将 Delphi 7 与 DBExpress 一起使用。我想将我的应用程序完全迁移到 firebird 2.1。我已经知道在服务器端该做什么，但在客户端并不确定。

在 TSQLConnection 组件中，我看到 vendorLib 属性指向 GDS32.dll。driverName 是 Interbase，getDriverFunc 是 getSQLDriverINTERBASE。

我不知道该怎么做才能使我的连接使用 fbclient.dll。我尝试在 vendorLib 中简单地将 gds32.dll 更改为 fbclient.dll，但它在我的应用程序中导致了一些访问冲突。

有小费吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T12:53:14.910

Interbase DBX 驱动程序不支持 Firebird 2.1（您会遇到某些字段类型的问题 - 例如 BLOB）。有传言称 D2010（即将进入[Beta 版](http://beta.embarcadero.com)）将支持 Firebird。

因此，您可以期待 Weawer 或购买商业 Firebird DBX 驱动程序（参见 Upscene 的网站或 DevArt/CoreLab 的网站）。

此外，也许更好的是，当您安装 Firebird 以检查“生成 gds32.dll 以确保与旧应用程序的兼容性” - 或类似的东西 - 我现在没有 FB 安装工具包。

HTH。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T12:38:46.287

使用 ZeosDB 组件访问 FireBird DB。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T12:54:52.397

也许您应该将 fbclient.dll 重命名为 gds32.dll 并替换它。阅读[这篇](http://www.firebirdfaq.org/faq356/)文章 - 这不完全是你的情况，但也许你应该尝试同样的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T21:44:07.803

在 \Misc\dbexpress 中的 UIB 中还有一些 Firebird 的 dbx 驱动程序

为了完成这个，我还知道 IBExpert 的 Delphi 2007/2009 的 dbx 驱动程序

[http://ibexpert.net/ibe/index.php?n=Main.News#news16](http://ibexpert.net/ibe/index.php?n=Main.News#news16)

和其他连接使用 Delphi 访问 Firebird [http://www.firebirdfaq.org/faq7/](http://www.firebirdfaq.org/faq7/)

# python - 返回函数的输出与打印它有何不同？

> ID：750136
> 
> 赞同：37
> 
> 时间：2009-04-15T02:53:39.190
> 
> 标签：python, return

在我之前的[问题](https://stackoverflow.com/questions/746774/basic-python-quick-question-regarding-calling-a-function)中，Andrew Jaffe 写道：

> 除了所有其他提示和技巧之外，我认为您还遗漏了一些重要的东西：您的函数实际上需要返回一些东西。当您创建`autoparts()`or`splittext()`时，想法是这将是一个您可以调用的函数，并且它可以（并且应该）回馈一些东西。一旦确定了希望函数具有的输出，就需要将其放入`return`语句中。

```
def autoparts():
    parts_dict = {}
    list_of_parts = open('list_of_parts.txt', 'r')

    for line in list_of_parts:
        k, v = line.split()
        parts_dict[k] = v

    print(parts_dict)

>>> autoparts()
{'part A': 1, 'part B': 2, ...} 
```

此函数创建一个字典，但它不返回任何内容。但是，由于我添加了`print`，因此在我运行该函数时会显示该函数的输出。`return`ing something 和ing it 有什么区别`print`？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-04-15T02:59:11.250

`print`只需将结构打印到您的输出设备（通常是控制台）。而已。要从您的函数中返回它，您将执行以下操作：

```
def autoparts():
  parts_dict = {}
  list_of_parts = open('list_of_parts.txt', 'r')
  for line in list_of_parts:
        k, v = line.split()
        parts_dict[k] = v
  return parts_dict 
```

为什么要回来？好吧，如果您不这样做，那么该字典就会死掉（被垃圾收集）并且一旦此函数调用结束就不再可以访问。如果你返回这个值，你可以用它做其他事情。如：

```
my_auto_parts = autoparts() 
print(my_auto_parts['engine']) 
```

看看发生了什么？`autoparts()`被调用，它返回`parts_dict`，我们将它存储到`my_auto_parts`变量中。现在我们可以使用这个变量来访问字典对象，即使函数调用结束，它也会继续存在。然后我们用 key 打印出字典中的对象`'engine'`。

要获得一个好的教程，请[查看深入研究 python](https://diveintopython3.problemsolving.io/)。它是免费的，而且很容易上手。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-15T03:01:10.293

print 语句将向用户输出一个对象。*函数完成后，*返回语句将允许将字典分配给变量。

```
>>> def foo():
...     print "Hello, world!"
... 
>>> a = foo()
Hello, world!
>>> a
>>> def foo():
...     return "Hello, world!"
... 
>>> a = foo()
>>> a
'Hello, world!' 
```

或者在返回字典的情况下：

```
>>> def foo():
...     print {'a' : 1, 'b' : 2}
... 
>>> a = foo()
{'a': 1, 'b': 2}
>>> a
>>> def foo():
...     return {'a' : 1, 'b' : 2}
... 
>>> a = foo()
>>> a
{'a': 1, 'b': 2} 
```

（执行完一行后什么都不打印的语句表示最后一条语句返回无）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T03:01:37.547

我认为您很困惑，因为您是从 REPL 运行的，它会在您调用函数时自动打印出返回的值。在这种情况下，无论你有一个创建值、打印它并丢弃它的函数，还是有一个创建值并返回它的函数，让 REPL 打印它，你都会得到相同的输出。

然而，这些并不是一回事，当你用另一个函数调用 autoparts 时，你会意识到这些函数想要用 autoparts 创造的价值做一些事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-15T02:58:33.640

你只需添加一个return语句......

```
def autoparts():
  parts_dict={}
  list_of_parts = open('list_of_parts.txt', 'r')
  for line in list_of_parts:
        k, v = line.split()
        parts_dict[k] = v
  return parts_dict 
```

打印输出仅打印到应用程序的标准输出（屏幕）。您还可以通过用逗号分隔它们来返回多个内容：

```
return parts_dict, list_of_parts 
```

使用它：

```
test_dict = {}
test_dict = autoparts() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-03-18T18:00:14.427

**主要区别：**

调用**print**将立即使您的程序写出文本供您查看。当您想向人类展示价值时，请使用 print。

return 是一个关键字。*当到达**return**语句时，Python 将停止当前函数的执行，将一个值发送到调用函数的位置。当您想将值从代码中的一个点发送到另一个点时，请使用 return。*

**使用 return 改变程序的流程。使用打印不会。**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-08-10T20:29:48.287

在基本层面上，函数是可以执行的代码块，不是在编写时执行，而是在调用时执行。假设我有以下代码，它是一个简单的乘法函数：

```
def multiply(x,y):
    return x * y 
```

所以如果我用 调用函数`multiply(2,3)`，它会返回值 6。如果我修改函数，它看起来像这样：

```
def multiply(x,y):
    print(x*y)
    return x*y 
```

...然后输出如您所料，打印数字 6。然而，这两个语句之间的区别在于，它`print`只是在控制台上显示一些东西，但`return`“返回一些东西”给任何调用它的东西，这通常是一个变量。然后在它调用的函数中为该变量分配返回语句的值。这是python shell中的一个示例：

```
>>> def multiply(x,y):
        return x*y

>>> multiply(2,3) #no variable assignment
6
>>> answer = multiply(2,3) #answer = whatever the function returns
>>> answer
6 
```

所以现在函数已经将调用函数的结果返回到调用它的地方，在这种情况下是一个名为'answer'的变量。

这不仅仅是简单地打印结果，因为您可以再次访问它。以下是使用 return 语句的函数示例：

```
>>> x = int(input("Enter a number: "))
Enter a number: 5
>>> y = int(input("Enter another number: "))
Enter another number: 6
>>> answer = multiply(x,y)
>>> print("Your answer is {}".format(answer)
Your answer is 30 
```

所以它基本上将调用函数的结果存储在一个变量中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-02T07:03:48.290

不幸的是，有一个字符限制，所以这将在很多部分。首先要注意的是 return 和 print 是语句，而不是函数，但这只是语义。

我将从一个基本的解释开始。print 只是向人类用户显示一个字符串，表示计算机内部正在发生的事情。计算机无法使用该打印。return 是函数返回值的方式。人类用户通常看不到这个值，但计算机可以在其他功能中使用它。

更广泛地说，打印不会以任何方式影响功能。它只是为了人类用户的利益而存在。它对于了解程序的工作原理非常有用，并且可用于调试以检查程序中的各种值而无需中断程序。

return 是函数返回值的主要方式。所有函数都会返回一个值，如果没有 return 语句（或 yield 但不要担心），它将返回 None。然后，函数返回的值可以进一步用作传递给另一个函数的参数，存储为变量，或者只是为了人类用户的利益而打印。考虑这两个程序：

```
def function_that_prints():
    print "I printed"

def function_that_returns():
    return "I returned"

f1 = function_that_prints()
f2 = function_that_returns() 
```

print "现在让我们看看 f1 和 f2 的值是什么"

打印 f1 ---> 无

print f2---->"我回来了"

当 function_that_prints 运行时，它会自动打印到控制台“我打印”。但是，存储在 f1 中的值是 None 因为该函数没有返回语句。

当 function_that_returns 运行时，它没有向控制台打印任何内容。但是，它确实返回了一个值，并且该值存储在 f2 中。当我们在代码末尾打印 f2 时，我们看到“我返回了”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-14T10:50:07.893

以下示例可能有助于理解：

```
def add_nums1(x,y):
    print(x+y)

def add_nums2(x,y):
    return x+y 

#----Function output is usable for further processing
add_nums2(10,20)/2
15.0

#----Function output can't be used further (gives TypeError)
add_nums1(10,20)/2

30
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-124-e11302d7195e> in <module>
----> 1 add_nums1(10,20)/2

TypeError: unsupported operand type(s) for /: 'NoneType' and 'int' 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-01-05T19:31:22.580

```
def add(x, y):
    return x+y 
```

这样它就可以成为一个变量。

```
sum = add(3, 5)

print(sum) 
```

但是，如果“添加”函数打印输出“总和”，则输出“总和”将为无，因为在分配后已经发生了操作。

# javascript - 使用 jquery 进行多个 javascript 变量迭代

> ID：750144
> 
> 赞同：1
> 
> 时间：2009-04-15T02:57:55.030
> 
> 标签：javascript, jquery, forms, iteration

我有一个表单，希望用户能够根据需要多次复制一组字段。对于一个组，它可以正确迭代，但是当我添加第二组时，“当前”变量会集体迭代，而不是每个组都是唯一的......我尝试将所有“当前”更改为“newFieldset.current”，但返回 NAN。 .. 有任何想法吗？

```
<script type="text/javascript">
$(document).ready(function() {
var current = 0;
    //Add New Fieldset with Button
    var newFieldset = {
        init: function(groupIndex) {
            current++;
            $newPerson= $("#Template"+groupIndex).clone(true);
            $newPerson.children("p").children("label").each(function(i) {
                var $currentElem= $(this);
                $currentElem.attr("for",$currentElem.attr("for")+current);
            });
            $newPerson.children("p").children("input").each(function(i) {
                var $currentElem= $(this);
                $currentElem.attr("name",$currentElem.attr("name")+current);
                $currentElem.attr("value",$currentElem.attr("value")+groupIndex+current);
                $currentElem.attr("id",$currentElem.attr("id")+current);
            });

            $newPerson.appendTo("#mainField"+groupIndex);
            $newPerson.removeClass("hideElement");
        },
        currentID: null,
        obj: null
    };
    $(".addButton").each(function() {
        $(this).click(function() {
            var groupIndex = $(this).attr("title");
            //newFieldset.obj = this;
            //var fieldIndex = $(this).attr("class");
            newFieldset.init(groupIndex);
        });
    });

    console.log('r');
});
</script>
<style>
.hideElement {display:none;}
</style>

<form name="demoForm" id="demoForm" method="post" action="#">
<div id="groupCtr1">
    <fieldset id="mainField1">
    <div id="Template1" class="hideElement">
    <p>
        <label for="firstname">Name</label> <em>*</em>
        <input id="firstname" name="firstname" size="25" /> <input id="lastname" name="lastname" size="25" />
    </p>
    <p>
        <label for="email">Email</label> <em>*</em><input id="email" name="email" size="25" />
    </p>
    </div>
    <div>
    <p>
        <label for="firstname1">Name</label> 
        <em>*</em> <input id="firstname1" name="firstname1" size="25" /> <input id="lastname1" name="lastname1" size="25" />
    </p>
    <p>
        <label for="email1">Email</label>  
        <em>*</em><input id="email1" name="email1" size="25" />
    </p>
    </div>
    </fieldset>
    <p>
    <input type="button" class="addButton" title="1" value="Add Another Person">
    </p>
</div>
<div id="groupCtr2">
    <fieldset id="mainField2">
    <div id="Template2" class="hideElement">
        <p>
            <label for="coname">Company Name</label> <em>*</em>
            <input id="coname" name="coname" size="25" />
        </p>
        <p>
            <label for="codesc">Description</label> <em>*</em><input id="codesc" name="codesc" size="25" />
        </p>
    </div>
    <div>
        <p>
            <label for="coname1">Company Name</label> 
            <em>*</em> <input id="coname1" name="coname1" size="25" />
        </p>
        <p>
            <label for="codesc1">Description</label>  
            <em>*</em><input id="codesc1" name="codesc1" size="25" />
        </p>
    </div>
    </fieldset>
    <p>
    <input type="button" class="addButton" title="2" value="Add Another Company">
    </p>
</div>
<input type="submit" value="Save">
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T03:04:15.280

如果您不使当前变量成为全局变量，它~~应该~~可以工作。试试这个：

```
var newFieldset = { 
                  current: 0,
                  init: function() {
                      this.current++; 
                      //rest of init code
                  },
                  //all your other fieldset code here
};
/* all other code */ 
```

**编辑：**重新阅读问题后，我会对您想要实现的目标采取完全不同的方法。上面的代码仍然会为您表现出相同的行为。如果问题没有得到成功回答，我回家后会写一篇更大的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T08:15:37.933

我会做这样的事情：

```
...
var currents = {};
var newFieldset = {
    init: function(groupIndex) {
        var current = 0;
        if (currents[groupIndex]) {
            current = currents[groupIndex];
        }
        ++current;
        currents[groupIndex] = current;
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T15:39:52.797

使用 jQuery 数据方法将值附加到元素。单击时将其递增，然后将其作为第二个参数传递给 newFieldset.init 方法。瞧！

```
$(document).ready(function() {
    //Add New Fieldset with Button
    var newFieldset = {
        init: function(groupIndex,current) {
                $newPerson= $("#Template"+groupIndex).clone(true);
                $newPerson.children("p").children("label").each(function(i) {
                        var $currentElem= $(this);
                        $currentElem.attr("for",$currentElem.attr("for")+current);
                });
                $newPerson.children("p").children("input").each(function(i) {
                        var $currentElem= $(this);
                        $currentElem.attr("name",$currentElem.attr("name")+current);
                        $currentElem.attr("value",$currentElem.attr("value")+groupIndex+current);
                        $currentElem.attr("id",$currentElem.attr("id")+current);
                });

                $newPerson.appendTo("#mainField"+groupIndex);
                $newPerson.removeClass("hideElement");
        },
        currentID: null,
        obj: null
    };
    $(".addButton").click(function() {
        var groupIndex = $(this).attr("title");
        var current = $(this).data('current');
        $(this).data('current',++current);
        //newFieldset.obj = this;
        //var fieldIndex = $(this).attr("class");
        newFieldset.init(groupIndex,current);
    }).data('current',0);

    console.log('r');
}); 
```

先生，祝你快乐。

# java - Park-Miller-Carta PRNG 随机生成器总是返回 2.33E-10

> ID：750145
> 
> 赞同：2
> 
> 时间：2009-04-15T02:58:11.707
> 
> 标签：java, actionscript-3, random

我正在尝试制作 Park-Miller-Carta PRNG 随机数生成器的 Java 实现。

下面是 ActionScript 3 中 Random 函数的[实现](http://www.gskinner.com/blog/archives/2008/01/source_code_see.html)。

```
return (_currentSeed = (_currentSeed * 16807) % 2147483647) / 0x7FFFFFFF
                                                          + 0.000000000233; 
```

我没有太多运气让它在Java中工作：

```
int seed = 20; //for example.

public double random() {
    seed = (seed * 16807) % 2147483647;
    return seed / 0x7FFFFFFF + 0.000000000233;
} 
```

这总是返回`2.33E-10`。任何想法我在 Java 中做错了什么？（AS3 代码返回`0.0001565276181885122`，然后`0.6307557630963248`是种子为 的前两个响应`20`）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T03:06:03.793

```
seed / 0x7FFFFFFF 
```

是一个整数运算，因为两个参数都是整数。整数除法总是向下舍入“真实”结果。在这种情况下，真正的结果是在 0 和 1 之间，所以操作总是返回 0。

要获得浮点结果，至少有一个参数必须是浮点数，可以这样实现：

```
return (double)seed / 0x7FFFFFFF + 0.000000000233; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T03:17:28.243

好的，所以基本问题是您需要进行浮点除法，而不是整数除法，正如其他人所指出的那样。

但我认为修复这个特定的代码有点无关紧要。为什么首先要打扰它？它使用的基本上是同一类算法是 java.lang.Random！

如果您想要一个快速生成器，请考虑使用[XORShift 生成器](http://www.javamex.com/tutorials/random_numbers/xorshift.shtml)。如果你想要一个高质量的生成器，你有[SecureRandom](http://www.javamex.com/tutorials/random_numbers/securerandom.shtml)开箱即用（虽然它要慢得多），请考虑 Numerical Recipes 算法（一个相当快的组合生成器），你可以在 Java 中实现如下：

```
public class HighQualityRandom extends Random {

  private Lock l = new ReentrantLock();
  private long u;
  private long v = 4101842887655102017L;
  private long w = 1;

  public HighQualityRandom() {
    this(System.nanoTime());
  }
  public HighQualityRandom(long seed) {
    l.lock();
    u = seed ^ v;
    nextLong();
    v = u;
    nextLong();
    w = v;
    nextLong();
    l.unlock();
  }

  @Override
  public long nextLong() {
    l.lock();
    try {
      u = u * 2862933555777941757L + 7046029254386353087L;
      v ^= v >>> 17;
      v ^= v << 31;
      v ^= v >>> 8;
      w = 4294957665L * (w & 0xffffffff) + (w >>> 32);
      long x = u ^ (u << 21);
      x ^= x >>> 35;
      x ^= x << 4;
      return (x + v) ^ w;
    } finally {
      l.unlock();
    }
  }

  protected int next(int bits) {
    return (int) (nextLong() >>> (64-bits));
  }

} 
```

这是从我需要它并发的一些代码中复制的；您原则上可以摆脱锁，或者只使用常规同步。

如果您绝对坚持使用 Park-Miller-Carta，我至少会将它包装在 Random 子类中，并让 java.util.Random 负责将 int 转换为双精度等 - 毕竟，这就是可扩展库中的面向对象语言用于...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T03:03:47.620

代替：

```
return seed / 0x7FFFFFFF+0.000000000233; 
```

和：

```
return (double)seed / 0x7FFFFFFF+0.000000000233; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T03:06:20.720

运算符优先级。

```
(seed / 0x7FFFFFFF)+0.000000000233; 
```

是你真正拥有的。是你的意思吗？

# objective-c - 你如何检查objective-c和cocoa的健全性？

> ID：750153
> 
> 赞同：1
> 
> 时间：2009-04-15T03:00:55.973
> 
> 标签：objective-c, cocoa, cocoa-touch

在objective-c和cocoa中检查理智的首选方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T07:47:47.687

在方法的顶部附近，`NSParameterAssert`没有必要的对象`nil`，索引在范围内等。有时您可以免费获得这些；例如，由数组支持的索引访问器可以让底层数组为它做断言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T03:52:08.410

```
NSAssert(thisShouldBeTrue, @"Error message"); 
```

# string - Matlab 交换

> ID：750159
> 
> 赞同：-1
> 
> 时间：2009-04-15T03:04:02.923
> 
> 标签：string, matlab, vector

如果给我一串字母`'abcd'`，并且我想将其转换为`V = [1,2,3,4]`与字母表中字母位置相对应的数字向量，我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T11:49:02.023

只需减去'a'。加一将“a”映射到 1。减法将结果发送到双精度数。

```
V = C - 'a' + 1; 
```

例如，

```
C = 'helloworld';
C - 'a' + 1
ans =
     8     5    12    12    15    23    15    18    12     4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T03:31:08.583

要将“a”映射到 1，将“b”映射到 2，等等，请使用[DOUBLE](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/double.html)函数将字符重新转换为其 ASCII 代码编号，然后将值移位：

```
V = double(charString)-96; 
```

**编辑：**实际上，您甚至不需要调用 DOUBLE。当您对另一个双精度数（MATLAB 变量的默认类型）执行任何算术运算时，字符将自动转换为双精度数。因此，以下是一个更简单的答案：

```
V = charString-96; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T03:26:19.143

使用`uint8`，然后减去 'a' 的 char 值，然后将其推送到向量上。[关联](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/matlab_prog/f2-47856.html&http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&q=matlab+string+manipulation+access+char&btnG=Search)

# java - 理解Goetz关于HttpSession的线程安全的文章

> ID：750165
> 
> 赞同：10
> 
> 时间：2009-04-15T03:06:05.603
> 
> 标签：java, multithreading, servlets, concurrency

参考 Brian Goetz 的文章[是否所有有状态的 Web 应用程序都损坏了？](http://www.ibm.com/developerworks/library/j-jtp09238.html)对于 IBM developerWorks，我想参考这段代码

```
HttpSession session = request.getSession(true);
ShoppingCart cart = (ShoppingCart)session.getAttribute("shoppingCart");
if (cart == null) {
    cart = new ShoppingCart(...);
    session.setAttribute("shoppingCart", cart);
}        
doSomethingWith(cart); 
```

据我所知，这段代码不是线程安全的，因为它使用了**check-then-act**模式。但我有一个疑问：

第一行中的创建或检索不是`HttpSession`完全原子的吗？原子，我的意思是如果两个线程调用`request.getSession()`，一个会阻塞。尽管两者都将返回相同的`HttpSession`实例。因此，如果客户端（移动/Web 浏览器）对同一个 Servlet（执行上面的代码片段）进行两次或调用，您将永远不会遇到不同线程看到不同值的情况`cart`。

假设我确信它**不是**线程安全的，那么如何使这个线程安全？会`AtomicReference`工作吗？例如：

```
HttpSession session = request.getSession(true);
AtomicReference<ShoppingCart> cartRef = 
     (<AtomicReference<ShoppingCart>)session.getAttribute("shoppingCart");
ShoppingCart cart = cartRef.get();
if (cart == null) {
    cart = new ShoppingCart(...);
    session.setAttribute("shoppingCart",
         new AtomicReference<ShoppingCart>(cart));
}
doSomethingWith(cart); 
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T04:06:01.060

您的代码仍然不是线程安全的：

```
ShoppingCart cart = cartRef.get();
if (cart == null) {
    cart = new ShoppingCart(...);
    session.setAttribute("shoppingCart",
         new AtomicReference<ShoppingCart>(cart));
} 
```

这是因为两个线程都可以得到一个`cart`null，创建新的购物车对象，并将它们插入到会话中。其中一个将“获胜”，这意味着一个将设置未来请求使用的对象，但另一个将——对于这个请求——使用完全不同的`cart`对象。

为了使这个线程安全，您需要按照您引用的文章中的习语做这样的事情：

```
while (true) {
    ShoppingCart cart = cartRef.get();
    if (cart != null) {
        break;
    }
    cart = new ShoppingCart(...);
    if (cartRef.compareAndSet(null, cart))
        break;
} 
```

使用上面的代码，如果两个使用相同的线程同时`HttpSession`进入`while`循环，就不会出现数据竞争导致它们使用不同的`cart`对象。

为了解决 Brian Goetz 在文章中没有解决的部分问题，即如何首先`AtomicReference`进入会话，有一种简单且*可能*（但不能保证）线程安全的方法来执行此操作。即，实现一个会话监听器并将空`AtomicReference`对象放入会话中的`sessionCreated`方法中：

```
public class SessionInitializer implements HttpSessionListener {
  public void sessionCreated(HttpSessionEvent event){
    HttpSession session = event.getSession();
    session.setAttribute("shoppingCart", new AtomicReference<ShoppingCart>());
  }
  public void sessionDestroyed(HttpSessionEvent event){
    // No special action needed
  }
} 
```

此方法将为每个会话调用一次，仅在创建时调用，因此这是进行会话所需的任何初始化的合适位置。不幸的是，Servlet 规范不要求在调用监听器和调用方法之间存在*发生前的*关系。所以这显然不能保证是线程安全的，并且在不同的 Servlet 容器之间的行为可能会有所不同。`sessionCreated()``service()`

因此，即使给定会话一次可以有多个请求在运行中的可能性**很小，这也是不够安全的。**最终，在这种情况下，您需要使用某种锁来初始化会话。你可以这样做：

```
HttpSession session = request.getSession(true);
AtomicReference<ShoppingCart> cartRef;
// Ensure that the session is initialized
synchronized (lock) {
    cartRef = (<AtomicReference<ShoppingCart>)session.getAttribute("shoppingCart");
    if (cartRef == null) {
        cartRef = new AtomicReference<ShoppingCart>();
        session.setAttribute("shoppingCart", cartRef);
    }
} 
```

上面的代码执行后，你的 Session 就被初始化了。`AtomicReference`保证在会话中，并且以线程安全的方式。您可以在同一个同步块中更新购物车对象（并省去`AtomicReference`所有这些 - 只需将购物车本身放入会话中），或者您可以`AtomicReference`使用上面显示的代码更新。哪个更好取决于您需要进行多少初始化，执行此初始化需要多长时间，在同步块中执行*所有*操作是否会对性能造成太大影响（最好使用分析器确定，而不是猜测） ， 等等。

通常，在我自己的代码中，我只使用同步块而不使用 Goetz 的`AtomicReference`技巧。如果我曾经确定同步在我的应用程序中导致了活性问题，那么我可能会通过使用类似技巧的技巧将一些更昂贵的初始化从同步块中移出`AtomicReference`。

另请参阅：[HttpSession 线程安全吗，设置/获取属性线程安全操作吗？](https://stackoverflow.com/questions/616601/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T05:07:36.263

> 第一行中 HttpSession 的创建或检索不是完全原子的吗？原子，我的意思是如果两个线程调用 request.getSession()，一个会阻塞。

即使`getSession`阻塞，只要一个线程与会话一起返回，锁就会被放弃。在创建新购物车时，其他线程能够获取锁，获得会话，并发现会话中还没有购物车。

所以，这段代码不是线程安全的。有一个竞争条件很容易导致`ShoppingCarts`为单个会话创建多个。

不幸的是，您提出的解决方案正在做完全相同的事情：检查会话中的对象，并在需要时发布一个对象，但没有任何锁定。session 属性是 an 的`AtomicReference`事实并不重要。

为了安全地做到这一点，您可以使用像[Goetz 的“清单 5”](http://www.ibm.com/developerworks/library/j-jtp09238.html#listing5)这样的东西，其中对会话属性的读取和写入是在公共锁上同步时执行的。

```
HttpSession session = request.getSession();
ShoppingCart cart;
synchronized (lock) {
  cart = (ShoppingCart) session.getAttribute(ATTR_CART);
  if (cart == null) {
    cart = new ShoppingCart();
    session.setAttribute(ATTR_CART, cart);
  }
} 
```

请注意，此示例假定它`ShoppingCart`是可变的和线程安全的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T03:54:54.830

因此，自从我在这里使用 Java Servlets 做任何事情以来已经有几年了，所以我从记忆中开始。

我希望这里的线程安全问题在于检查购物车==null。在查看线程问题时，必须了解的是线程可以在任意两条机器指令（不仅仅是任何代码行）之间中断。也就是说，即使

```
i += 1; 
```

不是线程安全的（如果 i 无论如何都是共享的），因为 i += 1 是（至少）两条指令：添加和存储。线程可以在 add 和 store 之间中断，并且只有一个 add 会存活。

在这个例子中也发生了同样的事情。假设有片刻，两个线程在同一个会话上发出请求（例如，正如 Goetz 从帧或 ajax 请求中建议的那样）。进入此代码部分，成功检索 HttpSession，然后尝试获取“shoppingCart”属性。但是，由于它尚不存在，因此返回 null。然后线程被另一个做同样事情的请求中断。它也为空。然后这两个请求以任意顺序进行，但是，由于当时尚未存储购物车，因此两个请求都检索了“shoppingCart”属性的空引用，因此两个线程都将创建一个新的购物车对象，并且都将尝试存储它。一个会松动，对购物车的这些更改将丢失。因此，此代码不是线程安全的。

至于你问题的后半部分，我对 AtomicReference 对象不熟悉。我快速查看了 AtomicReference 的 java API，它可能会起作用，但我不确定。任何状况之下。我能想到的最明显的解决方案是使用监视器。基本上，您要做的是对代码的 get-test-set 部分进行互斥。

现在，如果您的购物车对象是原子的（即，我们只需要保护它的获取和设置，我认为这样的事情可以工作：

```
public syncronized ShoppingCart atomicGetCart(HttpSession session){    
    ShoppingCart cart = (ShoppingCart)session.getAttribute("shoppingCart");
    if (cart == null) {
        cart = new ShoppingCart(...);
        session.setAttribute("shoppingCart", cart);
    }

    return cart;
}

HttpSession session = request.getSession(true);
ShoppingCart cart = atomicGetCart
doSomethingWith(cart); 
```

现在，我对 Java 监视器的性能了解不多，所以我不确定这会产生什么样的开销。此外，这必须是检索购物车的唯一位置。基本上，syncronized 关键字意味着一次只有一个线程可以进入方法 atomicGetCart。锁用于强制执行此操作（锁只是一个对象，一次只能由一个线程拥有）。这样你就不再有其他代码中的竞争条件了。

希望这会有所帮助，-丹尼尔

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-22T15:00:42.377

不想跨帖，但我对这篇文章发表了评论，但没有得到作者的答复。看看 Brian Goetz 在 IBM 网站上的其他文章，他似乎并不热衷于回答任何问题。

我认为他在文章清单 5 中提出的代码被破坏了。

假设当前的最高分数是 1000，并且有 2 个分数分别为 1100 和 1200 的并发请求正在进行中。两个请求同时检索最高分：

```
PlayerScore hs = (PlayerScore) ctx.getAttribute("highScore"); 
```

是什么让两个线程都将 hs 视为 1000。之后，其中一个线程进入同步部分，如果满足条件，则将新值（例如 1200）设置为 servletcontext 属性并且同步部分结束。然后第二个线程进入同步部分，它仍然看到以前的 hs 值 - hs 仍然是 1000。如果满足 contition（确保它是从 1100>1000 开始），则将新值 (1100 ) 设置为 servletcontext。不应该

```
PlayerScore hs = (PlayerScore) ctx.getAttribute("highScore"); 
```

属于同步部分？

# git - 如何在 Git 中更改多个提交的作者和提交者姓名和电子邮件？

> ID：750172
> 
> 赞同：2703
> 
> 时间：2009-04-15T03:09:24.207
> 
> 标签：git, version-control, git-filter-branch, git-rewrite-history

我正在学校计算机上编写一个简单的脚本，并将更改提交到 Git（在我的笔式驱动器中的一个存储库中，从我家的计算机克隆）。在几次提交之后，我意识到我是以 root 用户的身份提交的东西。

有没有办法将这些提交的作者更改为我的名字？

* * *

## 回答 #1

> 赞同：1741
> 
> 时间：2009-08-24T03:08:51.323

**注意：此答案会更改 SHA1，因此在已推送的分支上使用它时要小心。如果您只想修复名称的拼写或更新旧电子邮件，git 允许您执行此操作而无需使用`.mailmap`. 请参阅[我的其他答案](https://stackoverflow.com/a/9491696/161801)。**

### 使用交互式变基

你可以做

```
git rebase -i -p <some HEAD before all of your bad commits> 
```

然后在 rebase 文件中将所有错误提交标记为“编辑”。如果您还想更改第一次提交，则必须手动将其添加为 rebase 文件的第一行（遵循其他行的格式）。然后，当 git 要求您修改每个提交时，执行

```
 git commit --amend --author "New Author Name <email@address.com>" 
```

编辑或关闭打开的编辑器，然后执行

```
git rebase --continue 
```

继续变基。

您可以通过追加跳过在此处完全打开编辑器，`--no-edit` 以便命令为：

```
git commit --amend --author "New Author Name <email@address.com>" --no-edit && \
git rebase --continue 
```

### 单次提交

正如一些评论者所指出的，如果您只想更改最近的提交，则不需要 rebase 命令。做就是了

```
 git commit --amend --author "New Author Name <email@address.com>" 
```

这会将作者更改为指定的名称，但提交者将设置为您在`git config user.name`和中配置的用户`git config user.email`。如果您想将提交者设置为您指定的内容，这将同时设置作者和提交者：

```
 git -c user.name="New Author Name" -c user.email=email@address.com commit --amend --reset-author 
```

### 合并提交注意事项

我原来的回答有一点小瑕疵。`HEAD`如果在 current和 your之间有任何合并提交`<some HEAD before all your bad commits>`，那么`git rebase`会将它们展平（顺便说一下，如果您使用 GitHub 拉取请求，那么您的历史记录中将会有大量的合并提交）。这通常会导致非常不同的历史记录（因为重复的更改可能会“重新设置为基础”），并且在最坏的情况下，它可能会导致`git rebase`要求您解决困难的合并冲突（可能已经在合并提交中解决了） . 解决方案是使用`-p`标志 to `git rebase`，这将保留您的历史合并结构。手册页`git rebase`警告说使用`-p`and`-i`可能会导致问题，但在`BUGS`它说“编辑提交和改写他们的提交消息应该可以正常工作”部分。

我已经添加`-p`到上面的命令中。对于您只是更改最近提交的情况，这不是问题。

### 现代 git 客户端更新（2020 年 7 月）

使用`--rebase-merges`代替`-p`(`-p`已弃用并且存在严重问题)。

* * *

## 回答 #2

> 赞同：1453
> 
> 时间：2009-04-15T03:16:42.690

> 这个答案使用`git-filter-branch`，[文档](https://git-scm.com/docs/git-filter-branch)现在给出这个警告：
> 
> git filter-branch 有很多陷阱，这些陷阱可能会对预期的历史重写产生不明显的破坏（并且由于它的性能如此糟糕，因此您几乎没有时间调查此类问题）。这些安全和性能问题不能向后兼容修复，因此不建议使用它。请使用替代历史过滤工具，例如[git filter-repo](https://github.com/newren/git-filter-repo/)。如果您仍然需要使用 git filter-branch，请仔细阅读[安全](https://git-scm.com/docs/git-filter-branch#SAFETY)（和[性能](https://git-scm.com/docs/git-filter-branch#PERFORMANCE)）以了解 filter-branch 的地雷，然后尽可能合理地避免其中列出的许多危害。

更改作者（或提交者）将需要重写所有历史记录。如果您对此感到满意并认为值得，那么您应该查看[git filter-branch](http://schacon.github.com/git/git-filter-branch.html)。手册页包含几个帮助您入门的示例。另请注意，您可以使用环境变量来更改作者、提交者、日期等的名称——请参阅[git 手册页](http://schacon.github.com/git/git.html)的“环境变量”部分。

具体来说，您可以使用此命令修复所有**分支和标签的所有**错误作者姓名和电子邮件（来源：[GitHub 帮助](https://help.github.com/articles/changing-author-info/)）：

```
#!/bin/sh

git filter-branch --env-filter '
OLD_EMAIL="your-old-email@example.com"
CORRECT_NAME="Your Correct Name"
CORRECT_EMAIL="your-correct-email@example.com"
if [ "$GIT_COMMITTER_EMAIL" = "$OLD_EMAIL" ]
then
    export GIT_COMMITTER_NAME="$CORRECT_NAME"
    export GIT_COMMITTER_EMAIL="$CORRECT_EMAIL"
fi
if [ "$GIT_AUTHOR_EMAIL" = "$OLD_EMAIL" ]
then
    export GIT_AUTHOR_NAME="$CORRECT_NAME"
    export GIT_AUTHOR_EMAIL="$CORRECT_EMAIL"
fi
' --tag-name-filter cat -- --branches --tags 
```

使用替代的历史过滤工具[git filter-repo](https://github.com/newren/git-filter-repo/)，你可以先安装它并`git-mailmap`根据[gitmailmap](https://htmlpreview.github.io/?https://raw.githubusercontent.com/newren/git-filter-repo/docs/html/gitmailmap.html)的格式构造一个。

```
Proper Name <proper@email.xx> Commit Name <commit@email.xx> 
```

然后使用创建的邮件映射运行 filter-repo：

```
git filter-repo --mailmap git-mailmap 
```

* * *

## 回答 #3

> 赞同：691
> 
> 时间：2009-04-15T03:22:10.603

一个班轮，但如果您有一个多用户存储库，请小心 - 这会将*所有*提交更改为具有相同的（新）作者和提交者。

```
git filter-branch -f --env-filter "GIT_AUTHOR_NAME='Newname'; GIT_AUTHOR_EMAIL='new@email'; GIT_COMMITTER_NAME='Newname'; GIT_COMMITTER_EMAIL='new@email';" HEAD 
```

在字符串中使用换行符（这在 bash 中是可能的）：

```
git filter-branch -f --env-filter "
    GIT_AUTHOR_NAME='Newname'
    GIT_AUTHOR_EMAIL='new@email'
    GIT_COMMITTER_NAME='Newname'
    GIT_COMMITTER_EMAIL='new@email'
  " HEAD 
```

* * *

## 回答 #4

> 赞同：602
> 
> 时间：2009-05-15T19:15:44.667

你也可以这样做：

```
git filter-branch --commit-filter '
        if [ "$GIT_COMMITTER_NAME" = "<Old Name>" ];
        then
                GIT_COMMITTER_NAME="<New Name>";
                GIT_AUTHOR_NAME="<New Name>";
                GIT_COMMITTER_EMAIL="<New Email>";
                GIT_AUTHOR_EMAIL="<New Email>";
                git commit-tree "$@";
        else
                git commit-tree "$@";
        fi' HEAD 
```

请注意，如果您在 Windows 命令提示符下使用此命令，则需要使用以下命令`"`代替`'`：

```
git filter-branch --commit-filter "
        if [ "$GIT_COMMITTER_NAME" = "<Old Name>" ];
        then
                GIT_COMMITTER_NAME="<New Name>";
                GIT_AUTHOR_NAME="<New Name>";
                GIT_COMMITTER_EMAIL="<New Email>";
                GIT_AUTHOR_EMAIL="<New Email>";
                git commit-tree "$@";
        else
                git commit-tree "$@";
        fi" HEAD 
```

* * *

## 回答 #5

> 赞同：242
> 
> 时间：2012-02-16T09:46:05.487

当您没有`$HOME/.gitconfig`初始化时会发生这种情况。您可以将其修复为：

```
git config --global user.name "you name"
git config --global user.email you@domain.com
git commit --amend --reset-author 
```

使用 git 版本 1.7.5.4 进行测试。

请注意，这仅修复了最后一次提交。

* * *

## 回答 #6

> 赞同：198
> 
> 时间：2011-12-08T17:05:03.690

如果只有前几个提交的作者不好，您可以`git rebase -i`使用`exec`命令和`--amend`提交在内部完成所有操作，如下所示：

```
git rebase -i HEAD~6 # as required 
```

它为您提供了可编辑的提交列表：

```
pick abcd Someone else's commit
pick defg my bad commit 1
pick 1234 my bad commit 2 
```

`exec ... --author="..."`然后在所有作者不好的行之后添加行：

```
pick abcd Someone else's commit
pick defg my bad commit 1
exec git commit --amend --author="New Author Name <email@address.com>" -C HEAD
pick 1234 my bad commit 2
exec git commit --amend --author="New Author Name <email@address.com>" -C HEAD 
```

保存并退出编辑器（运行）。

这个解决方案的打字时间可能比其他解决方案长，但它是高度可控的——我确切地知道它命中了什么提交。

感谢@asmeurer 的启发。

* * *

## 回答 #7

> 赞同：190
> 
> 时间：2010-04-26T22:50:54.550

对于单个提交：

```
git commit --amend --author="Author Name <email@address.com>" 
```

（摘自 asmeurer 的回答）

* * *

## 回答 #8

> 赞同：116
> 
> 时间：2010-10-07T09:54:14.417

Github 有一个[不错的解决方案](http://help.github.com/changing-author-info/)，就是下面的 shell 脚本：

```
#!/bin/sh

git filter-branch --env-filter '

an="$GIT_AUTHOR_NAME"
am="$GIT_AUTHOR_EMAIL"
cn="$GIT_COMMITTER_NAME"
cm="$GIT_COMMITTER_EMAIL"

if [ "$GIT_COMMITTER_EMAIL" = "your@email.to.match" ]
then
    cn="Your New Committer Name"
    cm="Your New Committer Email"
fi
if [ "$GIT_AUTHOR_EMAIL" = "your@email.to.match" ]
then
    an="Your New Author Name"
    am="Your New Author Email"
fi

export GIT_AUTHOR_NAME="$an"
export GIT_AUTHOR_EMAIL="$am"
export GIT_COMMITTER_NAME="$cn"
export GIT_COMMITTER_EMAIL="$cm"
' 
```

* * *

## 回答 #9

> 赞同：84
> 
> 时间：2010-08-04T00:52:53.897

正如 docgnome 所提到的，重写历史是危险的，并且会破坏其他人的存储库。

但是如果你真的想这样做并且你在一个 bash 环境中（在 Linux 上没问题，在 Windows 上，你可以使用 git bash，它是 git 安装提供的），使用[git filter-branch](http://git-scm.com/docs/git-filter-branch)：

```
git filter-branch --env-filter '
  if [ $GIT_AUTHOR_EMAIL = bad@email ];
    then GIT_AUTHOR_EMAIL=correct@email;
  fi;
export GIT_AUTHOR_EMAIL' 
```

为了加快速度，您可以指定要重写的修订范围：

```
git filter-branch --env-filter '
  if [ $GIT_AUTHOR_EMAIL = bad@email ];
    then GIT_AUTHOR_EMAIL=correct@email;
  fi;
export GIT_AUTHOR_EMAIL' HEAD~20..HEAD 
```

* * *

## 回答 #10

> 赞同：82
> 
> 时间：2019-01-25T10:14:33.283

用于更改最后 N 次提交的作者的单个**命令：**

```
git rebase -i HEAD~N -x "git commit --amend --author 'Author Name <author.name@mail.com>' --no-edit" 
```

**笔记**

*   替换`HEAD~N`为参考，直到您要重写提交。这可以是哈希、`HEAD~4`分支名称、...
*   该`--no-edit`标志确保`git commit --amend`不要求额外确认
*   使用时`git rebase -i`，您可以手动选择更改作者的提交，

您编辑的文件将如下所示：

```
pick 897fe9e simplify code a little
exec git commit --amend --author 'Author Name <author.name@mail.com>' --no-edit
pick abb60f9 add new feature
exec git commit --amend --author 'Author Name <author.name@mail.com>' --no-edit
pick dc18f70 bugfix
exec git commit --amend --author 'Author Name <author.name@mail.com>' --no-edit 
```

然后，您仍然可以修改一些行以查看要更改作者的位置。这为您在自动化和控制之间提供了一个很好的中间地带：您会看到将要运行的步骤，一旦您保存，所有内容都会立即应用。

请注意，如果您已经使用 和 修复了作者信息`git config user.name <your_name>`，`git config user.email <your_email>`您还可以使用以下命令：

```
git rebase -i HEAD~N -x "git commit --amend --reset-author --no-edit" 
```

* * *

## 回答 #11

> 赞同：50
> 
> 时间：2012-08-01T23:09:12.633

您可以将其用作**别名**，以便执行以下操作：

```
git change-commits GIT_AUTHOR_NAME "old name" "new name" 
```

或最后 10 次提交：

```
git change-commits GIT_AUTHOR_EMAIL "old@email.com" "new@email.com" HEAD~10..HEAD 
```

添加到 ~/.gitconfig：

```
[alias]
    change-commits = "!f() { VAR=$1; OLD=$2; NEW=$3; shift 3; git filter-branch --env-filter \"if [[ \\\"$`echo $VAR`\\\" = '$OLD' ]]; then export $VAR='$NEW'; fi\" $@; }; f " 
```

来源：[https ://github.com/brauliobo/gitconfig/blob/master/configs/.gitconfig](https://github.com/brauliobo/gitconfig/blob/master/configs/.gitconfig)

希望它是有用的。

* * *

## 回答 #12

> 赞同：49
> 
> 时间：2016-03-23T22:23:11.657

当从另一个作者那里接管一个未合并的提交时，有一种简单的方法来处理这个问题。

`git commit --amend --reset-author`

* * *

## 回答 #13

> 赞同：42
> 
> 时间：2011-12-09T10:23:12.877

**这是@Brian 版本的更详细的版本：**

要更改作者和提交者，您可以这样做（在字符串中使用换行符，这在 bash 中是可能的）：

```
git filter-branch --env-filter '
    if [ "$GIT_COMMITTER_NAME" = "<Old name>" ];
    then
        GIT_COMMITTER_NAME="<New name>";
        GIT_COMMITTER_EMAIL="<New email>";
        GIT_AUTHOR_NAME="<New name>";
        GIT_AUTHOR_EMAIL="<New email>";
    fi' -- --all 
```

您可能会遇到以下错误之一：

1.  临时目录已经存在
2.  *以refs/original*开头的 Refs已经存在（这意味着之前已经在存储库上运行了另一个过滤器分支，然后在*refs/original*
    备份了原始分支引用）

 *如果您想在出现这些错误的情况下强制运行，请添加**`--force`**标志：

```
git filter-branch --force --env-filter '
    if [ "$GIT_COMMITTER_NAME" = "<Old name>" ];
    then
        GIT_COMMITTER_NAME="<New name>";
        GIT_COMMITTER_EMAIL="<New email>";
        GIT_AUTHOR_NAME="<New name>";
        GIT_AUTHOR_EMAIL="<New email>";
    fi' -- --all 
```

可能需要对该选项进行一些解释`-- --all`：它使过滤器分支适用于*所有参考*（包括所有分支）的所有修订。这意味着，例如，标签也被重写并且在重写的分支上可见。

一个常见的“错误”是使用`HEAD`，这意味着仅过滤*当前分支*上的所有修订。然后在重写的分支中将不存在任何标签（或其他参考）。

* * *

## 回答 #14

> 赞同：34
> 
> 时间：2012-02-28T23:57:32.817

我应该指出，如果唯一的问题是作者/电子邮件与您平时不同，这不是问题。`.mailmap`正确的解决方法是在目录的基础上创建一个名为的文件，其中包含如下行

```
Name you want <email you want> Name you don't want <email you don't want> 
```

从那时起，类似的命令`git shortlog`将认为这两个名称相同（除非您明确告诉他们不要这样做）。有关更多信息，请参阅[http://schacon.github.com/git/git-shortlog.html](http://schacon.github.com/git/git-shortlog.html)。

这具有此处所有其他解决方案的优势，因为您不必重写历史记录，如果您有上游可能会导致问题，并且始终是意外丢失数据的好方法。

当然，如果您以自己的身份提交了某些内容，并且确实应该是其他人，并且此时您不介意重写历史记录，那么更改提交作者可能是出于归因目的的好主意（在这种情况下，我将您引导至我的其他答案[在这里](https://stackoverflow.com/a/1320317/5253155)）。

* * *

## 回答 #15

> 赞同：25
> 
> 时间：2012-10-04T02:22:52.930

1.  跑`git rebase -i <sha1 or ref of starting point>`

2.  `edit`用（或`e`）标记所有要更改的提交

3.  循环以下两个命令，直到处理完所有提交：

    `git commit --amend --reuse-message=HEAD --author="New Author <new@author.email>"` ; `git rebase --continue`

这将保留所有其他提交信息（包括日期）。该`--reuse-message=HEAD`选项阻止消息编辑器启动。

* * *

## 回答 #16

> 赞同：24
> 
> 时间：2011-02-16T15:27:27.147

我使用以下内容重写整个存储库的作者，包括标签和所有分支：

```
git filter-branch --tag-name-filter cat --env-filter "
  export GIT_AUTHOR_NAME='New name';
  export GIT_AUTHOR_EMAIL='New email'
" -- --all 
```

然后，如[filter-branch 的 MAN 页面中](http://git-scm.com/docs/git-filter-branch)所述，删除所有备份的原始 refs `filter-branch`（这是破坏性的，首先备份）：

```
git for-each-ref --format="%(refname)" refs/original/ | \
xargs -n 1 git update-ref -d 
```

* * *

## 回答 #17

> 赞同：24
> 
> 时间：2020-04-22T15:03:24.820

git 的一个更安全的替代品`filter-branch`是`filter-repo`git docs [here](https://git-scm.com/docs/git-filter-branch#_warning)建议的工具。

```
git filter-repo --commit-callback '
  old_email = b"your-old-email@example.com"
  correct_name = b"Your Correct Name"
  correct_email = b"your-correct-email@example.com"

  if commit.committer_email == old_email :
    commit.committer_name = correct_name
    commit.committer_email = correct_email

  if commit.author_email == old_email : 
    commit.author_name = correct_name
    commit.author_email = correct_email
  ' 
```

上述命令反映了[此](https://web.archive.org/web/20200423060625/https://help.github.com/en/github/using-git/changing-author-info)脚本中使用的逻辑，但使用`filter-repo`而不是`filter-branch`.

选项后的代码主体`commit-callback`基本上是用于处理提交的 python 代码。你可以在这里用 python 编写你自己的逻辑。[在此处](https://github.com/newren/git-filter-repo/blob/c0c37a7656404dcefff55e55b8f7a9662f9d959d/Documentation/git-filter-repo.txt#L867)查看有关`commit`对象及其属性的更多信息。

由于`filter-repo`该工具未与 git 捆绑在一起，因此您需要单独安装它。

请参阅[先决条件](https://github.com/newren/git-filter-repo#prerequisites)和[安装指南](https://github.com/newren/git-filter-repo/blob/master/INSTALL.md)

如果你有一个 python env >= 3.5，你可以使用`pip`它来安装它。

```
pip3 install git-filter-repo 
```

**注意**`filter-repo`：强烈建议在新克隆上尝试工具。操作完成后，遥控器也会被移除。[阅读更多关于为何在此处](https://github.com/newren/git-filter-repo/issues/46)移除遥控器的信息。[另请阅读内部](https://htmlpreview.github.io/?https://github.com/newren/git-filter-repo/blob/docs/html/git-filter-repo.html#INTERNALS)部分下此工具的限制。

* * *

## 回答 #18

> 赞同：21
> 
> 时间：2011-02-04T22:46:26.560

我调整了这个[解决方案](http://lists.freedesktop.org/archives/portland/2010-October.txt)，它通过摄取一个简单的`author-conv-file`（格式与[git-cvsimport 相同](http://www.kernel.org/pub/software/scm/git/docs/git-cvsimport.html)）来工作。它通过更改`author-conv-file`所有分支中定义的所有用户来工作。

我们结合使用它`cvs2git`来将我们的存储库从 cvs 迁移到 git。

即样本`author-conv-file`

```
john=John Doe <john.doe@hotmail.com>
jill=Jill Doe <jill.doe@hotmail.com> 
```

剧本：

```
 #!/bin/bash

 export $authors_file=author-conv-file

 git filter-branch -f --env-filter '

 get_name () {
     grep "^$1=" "$authors_file" |
     sed "s/^.*=\(.*\) <.*>$/\1/"
 }

 get_email () {
     grep "^$1=" "$authors_file" |
     sed "s/^.*=.* <\(.*\)>$/\1/"
 }

 GIT_AUTHOR_NAME=$(get_name $GIT_COMMITTER_NAME) &&
     GIT_AUTHOR_EMAIL=$(get_email $GIT_COMMITTER_NAME) &&
     GIT_COMMITTER_NAME=$GIT_AUTHOR_NAME &&
     GIT_COMMITTER_EMAIL=$GIT_AUTHOR_EMAIL &&
     export GIT_AUTHOR_NAME GIT_AUTHOR_EMAIL &&
     export GIT_COMMITTER_NAME GIT_COMMITTER_EMAIL
 ' -- --all 
```

* * *

## 回答 #19

> 赞同：18
> 
> 时间：2012-04-23T08:46:54.910

我发现提供的版本具有攻击性，特别是如果您提交其他开发人员的补丁，这实际上会窃取他们的代码。

下面的版本适用于所有分支，并分别更改作者和提交者以防止这种情况。

感谢 leif81 的所有选项。

```
#!/bin/bash

git filter-branch --env-filter '
if [ "$GIT_AUTHOR_NAME" = "<old author>" ];
then
    GIT_AUTHOR_NAME="<new author>";
    GIT_AUTHOR_EMAIL="<youmail@somehost.ext>";
fi
if [ "$GIT_COMMITTER_NAME" = "<old committer>" ];
then
    GIT_COMMITTER_NAME="<new commiter>";
    GIT_COMMITTER_EMAIL="<youmail@somehost.ext>";
fi
' -- --all 
```

* * *

## 回答 #20

> 赞同：17
> 
> 时间：2016-12-14T15:01:26.633

1.  更改提交`author name & email`，`Amend`然后替换`old-commit with new-one`：

    ```
    $ git checkout <commit-hash>                            # checkout to the commit need to modify  
    $ git commit --amend --author "name <author@email.com>" # change the author name and email

    $ git replace <old-commit-hash> <new-commit-hash>      # replace the old commit by new one
    $ git filter-branch -- --all                           # rewrite all futures commits based on the replacement                   

    $ git replace -d <old-commit-hash>     # remove the replacement for cleanliness 
    $ git push -f origin HEAD              # force push 
    ```

2.  另一种方式`Rebasing`：

    ```
    $ git rebase -i <good-commit-hash>      # back to last good commit

    # Editor would open, replace 'pick' with 'edit' before the commit want to change author

    $ git commit --amend --author="author name <author@email.com>"  # change the author name & email

    # Save changes and exit the editor

    $ git rebase --continue                # finish the rebase 
    ```

* * *

## 回答 #21

> 赞同：17
> 
> 时间：2018-10-25T16:19:53.250

最快、最简单的方法是使用 git rebase 的 --exec 参数：

```
git rebase -i -p --exec 'git commit --amend --reset-author --no-edit' 
```

这将创建一个如下所示的待办事项列表：

```
pick ef11092 Blah blah blah
exec git commit --amend --reset-author --no-edit
pick 52d6391 Blah bloh bloo
exec git commit --amend --reset-author --no-edit
pick 30ebbfe Blah bluh bleh
exec git commit --amend --reset-author --no-edit
... 
```

这将自动工作，当你有数百个提交时工作。

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2010-08-04T09:41:51.647

如果您是此存储库的唯一用户，您可以使用（如[svick 所写](https://stackoverflow.com/questions/3401732/git-rewrite-author-in-history/3401835#3401835)）或/加过滤器脚本（如[docgnome answer](https://stackoverflow.com/questions/3401732/git-rewrite-author-in-history/3401801#3401801)中引用的文章中所述）或交互式[rebase](http://git-scm.com/docs/git-rebase)**重写历史记录**。但是其中任何一个都会从第一次更改提交开始更改修订；这对于任何将他/她的更改基于您的分支预重写的人来说都意味着麻烦。[`git filter-branch`](http://git-scm.com/docs/git-filter-branch)[`git fast-export`](http://www.kernel.org/pub/software/scm/git/docs/git-fast-export.html)[`git fast-import`](http://www.kernel.org/pub/software/scm/git/docs/git-fast-import.html)

***恢复***

如果其他开发人员的工作不是基于预重写版本，最简单的解决方案是重新克隆（再次克隆）。

或者，他们可以尝试`git rebase --pull`，如果他们的存储库中没有任何更改，这将快进，或者在重写的提交之上重新设置他们的分支（我们希望避免合并，因为它会永远保持重写前的提交）。所有这一切都假设他们没有提交工作；否则用于`git stash`隐藏更改。

如果其他开发人员使用功能分支，和/或`git pull --rebase`不工作，例如因为上游没有设置，他们必须在[*重写*](http://git-scm.com/docs/git-rebase)后提交之上重新调整他们的工作。例如，在获取新更改 ( `git fetch`) 之后，对于`master`基于 / forked from的分支`origin/master`，需要运行

```
$ git rebase --onto origin/master origin/master@{1} master 
```

这`origin/master@{1}`是预重写状态（获取之前），请参阅[gitrevisions](http://www.kernel.org/pub/software/scm/git/docs/gitrevisions.html)。

* * *

另一种解决方案是使用**refs/replace/**机制，从版本 1.6.5 开始在 Git 中可用。在此解决方案中，您可以替换具有错误电子邮件的提交；那么任何获取'replace' refs 的人（类似于`fetch = +refs/replace/*:refs/replace/*`refspec 在*他们* `.git/config`的适当位置）都会透明地获得替换，而那些不获取这些 refs 的人会看到旧的提交。

程序是这样的：

1.  查找所有带有错误电子邮件的提交，例如使用

    ```
    $ git log --author=user@wrong.email --all 
    ```

2.  对于每个错误的提交，创建一个替换提交，并将其添加到对象数据库

    ```
    $ git cat-file -p <ID of wrong commit> | 
      sed -e 's/user@wrong\.email/user@example.com/g' > tmp.txt
    $ git hash-object -t commit -w tmp.txt
    <ID of corrected commit> 
    ```

3.  现在您已经更正了对象数据库中的提交，您必须使用[`git replace`](http://www.kernel.org/pub/software/scm/git/docs/git-replace.html)命令告诉 git 通过更正的提交来自动透明地替换错误的提交：

    ```
    $ git replace <ID of wrong commit> <ID of corrected commit> 
    ```

4.  最后，列出所有替换以检查此过程是否成功

    ```
    $ git replace -l 
    ```

    并检查是否发生更换

    ```
    $ git log --author=user@wrong.email --all 
    ```

你当然可以自动化这个过程......好吧，除了使用`git replace`没有（还）批处理模式之外，你必须为此使用shell循环，或者替换“手动”。

**未测试！**YMMV。

^(请注意，您在使用`refs/replace/`机制时可能会遇到一些粗糙的角落：它是新的，尚未经过很好的测试)。

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2013-12-05T21:21:22.010

请注意，git 存储**了两个**不同的电子邮件地址，一个用于*提交*者（提交更改的人），另一个用于*作者*（编写更改的人）。

提交者信息不会在大多数地方显示，但您可以使用`git log -1 --format=%cn,%ce`（或使用`show`而不是`log`指定特定提交）来查看它。

虽然更改上一次提交的作者很简单`git commit --amend --author "Author Name <email@example.com>"`，但没有单行或参数可以对提交者信息做同样的事情。

解决方案是（临时或不）更改您的用户信息，然后修改提交，这会将提交者更新为您当前的信息：

```
git config user.email my_other_email@example.com 
git commit --amend 
```

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2011-09-30T18:04:00.783

如果您要修复的提交是最新的，并且只是其中的几个，您可以使用 和 的组合在配置正确的名称`git reset`和`git stash`电子邮件后再次返回提交它们。

序列将是这样的（对于 2 次错误提交，没有待处理的更改）：

```
git config user.name <good name>
git config user.email <good email>
git reset HEAD^
git stash
git reset HEAD^
git commit -a
git stash pop
git commit -a 
```

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2021-12-11T15:22:38.787

**将所有提交（包括第一次提交）重置为当前用户和当前时间戳：**

```
git rebase --root --exec "git commit --amend --no-edit --date 'now' --reset-author" 
```

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2011-08-24T17:54:19.353

如果您将 Eclipse 与 EGit 一起使用，那么有一个非常简单的解决方案。
假设：您在本地分支“local_master_user_x”中有提交，由于用户无效，无法将其推送到远程分支“master”。

1.  签出远程分支'master'
2.  选择“local_master_user_x”包含更改的项目/文件夹/文件
3.  右键 - 替换为 - 分支 - 'local_master_user_x'
4.  再次提交这些更改，这次作为正确的用户并进入本地分支“master”
5.  推送到远程“主人”

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2013-02-26T13:19:47.143

使用交互式变基，您可以在每次要更改的提交之后放置一个修改命令。例如：

```
pick a07cb86 Project tile template with full details and styling
x git commit --amend --reset-author -Chead 
```

* * *

## 回答 #28

> 赞同：5
> 
> 时间：2014-10-22T03:32:28.180

我们今天遇到了一个问题，作者姓名中的 UTF8 字符在构建服务器上造成了问题，因此我们不得不重写历史记录来纠正这个问题。采取的步骤是：

第 1 步：按照此处的说明更改您在 git 中的用户名以进行所有未来提交： [https ://help.github.com/articles/setting-your-username-in-git/](https://help.github.com/articles/setting-your-username-in-git/)

第 2 步：运行以下 bash 脚本：

```
#!/bin/sh

REPO_URL=ssh://path/to/your.git
REPO_DIR=rewrite.tmp

# Clone the repository
git clone ${REPO_URL} ${REPO_DIR}

# Change to the cloned repository
cd ${REPO_DIR}

# Checkout all the remote branches as local tracking branches
git branch --list -r origin/* | cut -c10- | xargs -n1 git checkout

# Rewrite the history, use a system that will preseve the eol (or lack of in commit messages) - preferably Linux not OSX
git filter-branch --env-filter '
OLD_EMAIL="me@something.com"
CORRECT_NAME="New Me"

if [ "$GIT_COMMITTER_EMAIL" = "$OLD_EMAIL" ]
then
    export GIT_COMMITTER_NAME="$CORRECT_NAME"
fi
if [ "$GIT_AUTHOR_EMAIL" = "$OLD_EMAIL" ]
then
    export GIT_AUTHOR_NAME="$CORRECT_NAME"
fi
' --tag-name-filter cat -- --branches --tags

# Force push the rewritten branches + tags to the remote
git push -f

# Remove all knowledge that we did something
rm -rf ${REPO_DIR}

# Tell your colleagues to `git pull --rebase` on all their local remote tracking branches 
```

快速概览：将存储库签出到临时文件，签出所有远程分支，运行将重写历史记录的脚本，强制推送新状态，并告诉所有同事执行 rebase pull 以获取更改。

我们在 OS X 上运行它时遇到了麻烦，因为它以某种方式弄乱了提交消息中的行尾，所以我们不得不在 Linux 机器上重新运行它。

* * *

## 回答 #29

> 赞同：5
> 
> 时间：2015-01-03T12:19:08.033

你的问题真的很常见。请参阅“[在 Git 中使用 Mailmap 修复作者列表](http://stacktoheap.com/blog/2013/01/06/using-mailmap-to-fix-authors-list-in-git/)”

为了简单起见，我创建了一个脚本来简化这个过程：[git-changemail](https://github.com/albfan/git-changemail)

将该脚本放在您的路径上后，您可以发出如下命令：

*   更改当前分支上的作者匹配

    ```
    $ git changemail -a old@email.com -n newname -m new@email.com 
    ```

*   更改 <branch> 和 <branch2> 上的作者和提交者匹配。传递`-f`给过滤器分支以允许重写备份

    ```
    $ git changemail -b old@email.com -n newname -m new@email.com -- -f &lt;branch> &lt;branch2> 
    ```

*   在 repo 上显示现有用户

    ```
    $ git changemail --show-both 
    ```

顺便说一句，在进行更改后，使用以下命令清理过滤器分支中的备份：[git-backup-clean](https://github.com/albfan/git-backup-clean)

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2020-05-05T14:51:48.093

如果您想（轻松）更改当前分支的作者，我将使用如下内容：

```
# update author for everything since origin/master
git rebase \
  -i origin/master \
  --exec 'git commit --amend --no-edit --author="Author Name <author.name@email.co.uk>"' 
```

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2017-09-28T14:15:37.357

我也想添加我的示例。我想**用给定的参数创建一个 bash_function。**

这适用于 mint-linux-17.3

```
# $1 => email to change, $2 => new_name, $3 => new E-Mail

function git_change_user_config_for_commit {

 # defaults
 WRONG_EMAIL=${1:-"you_wrong_mail@hello.world"}
 NEW_NAME=${2:-"your name"}
 NEW_EMAIL=${3:-"new_mail@hello.world"}

 git filter-branch -f --env-filter "
  if [ \$GIT_COMMITTER_EMAIL = '$WRONG_EMAIL' ]; then
    export GIT_COMMITTER_NAME='$NEW_NAME'
    export GIT_COMMITTER_EMAIL='$NEW_EMAIL'
  fi
  if [ \$GIT_AUTHOR_EMAIL = '$WRONG_EMAIL' ]; then
    export GIT_AUTHOR_NAME='$NEW_NAME'
    export GIT_AUTHOR_EMAIL='$NEW_EMAIL'
  fi
 " --tag-name-filter cat -- --branches --tags;
} 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2018-06-05T20:04:42.033

试试这个。它将执行与上述相同的操作，但交互方式。

```
bash <(curl -s  https://raw.githubusercontent.com/majdarbash/git-author-change-script/master/run.sh) 
```

参考：[https ://github.com/majdarbash/git-author-change-script](https://github.com/majdarbash/git-author-change-script)

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2010-08-04T00:40:57.563

如果您是此 repo 的唯一用户，或者您不关心可能会破坏其他用户的 repo，那么可以。如果您推送了这些提交并且它们存在于其他地方可以访问它们的地方，那么不，除非您不关心破坏其他人的存储库。问题是通过更改这些提交，您将生成新的 SHA，这将导致它们被视为不同的提交。当其他人试图拉入这些更改的提交时，历史就不同了，而且很疯狂。

此页面[http://inputvalidation.blogspot.com/2008/08/how-to-change-git-commit-author.html](http://inputvalidation.blogspot.com/2008/08/how-to-change-git-commit-author.html)描述了如何做到这一点。（我没试过这个所以YMMV）

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2020-01-04T04:14:19.073

我想为@Rognon 答案的修改做出贡献。如果所选答案或其他答案对您不起作用（在我的特定问题中就是这种情况），此答案只是另一种选择：

**目标：您将在所有历史中使用正确的作者修复一位或多位作者，并且您将获得没有重复的干净历史。此方法通过用“干净”分支替换“主”分支来工作（它不使用合并/变基）**

**注意：**使用“主”存储库的任何人都可能需要在推送之前再次检出它（在执行这些步骤之后），因为合并可能会失败。

我们将使用一个名为“clean”的新分支来执行操作（假设您要修复“master”）：

`git checkout -b clean`

（确保您在“干净”分支中`git branch`：）

修改以下脚本（替换电子邮件地址和姓名）。请注意，此脚本需要两个错误的电子邮件/作者（例如），因此如果您只需要修复一个作者，您可以删除条件的第二部分或保持原样（因为它将被忽略，因为它不会t 匹配）。

执行脚本。

```
#/bin/bash

git filter-branch --force --commit-filter '
        if [ "$GIT_COMMITTER_EMAIL" = "wrong1@example.com" -o "$GIT_COMMITTER_EMAIL" = "wrong2@example.com" ];
        then
                export GIT_COMMITTER_NAME="John Doe";
                export GIT_AUTHOR_NAME="John Doe";
                export GIT_COMMITTER_EMAIL="correct@example.com";
                export GIT_AUTHOR_EMAIL="correct@example.com";
        fi;
        git commit-tree "$@"
' --tag-name-filter cat -- --all 
```

它必须报告：`Ref 'refs/heads/clean' was rewritten`。如果它报告“未更改”，则脚本中输入的电子邮件可能是错误的。

通过以下方式确认历史记录已更正：`git log`

### 如果您使用的是**github/gitlab**（推荐 = 安全）：

1.  在远程创建“干净”分支：

`git push --set-upstream origin clean`

2.  将“干净”分支设置为默认分支
3.  删除“master”（在执行此操作之前确保一切都按预期进行）。
4.  在“clean”分支中创建一个新的分支“master”。
5.  确认一切正常后，您现在可以删除“干净”分支（或者您可以重命名它）。

### 如果**不使用 github/gitlab**或者您更喜欢通过命令执行此操作：

1.  从本地删除主分支：

`git branch -d master`

2.  重命名分支：

`git branch -m clean master`

3.  推它（确保你的“主人”不受保护）

`git push --force origin master`

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2021-09-27T16:56:22.463

对于所有提交，我的解决方案：

```
git rebase -i --root -x "git commit --amend --author 'bedorlan <bedorlan@gmail.com>' --no-edit" 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2016-12-07T22:53:50.563

```
git rebase -i YOUR_FIRTS_COMMIT_SHA^

while true; do git commit --amend --author="Name Surname <email@example.com>" --no-edit && git rebase --continue; done 
```

变基完成后按 ^C # （循环将不断更新最后一次提交）

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2019-08-30T20:19:20.010

上面的所有答案都重写了存储库的历史。只要多个作者没有使用要更改的名称，特别是如果存储库已共享并且提交是旧的，我更愿意使用`.mailmap`，记录在[https://git-scm.com/docs/git-短日志](https://git-scm.com/docs/git-shortlog)。它允许将不正确的名称/电子邮件映射到正确的名称/电子邮件，而无需修改回购历史记录。您可以使用以下行：

```
Proper Name <proper@email.xx> <root@localhost> 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2021-10-24T13:08:48.483

我试过上面的脚本对我不起作用，这解决了我的问题：

> 使用 Git 的“过滤器分支”命令。它允许您使用脚本批处理（可能很大）数量的提交。您可以在存储库中运行以下示例脚本（填写新旧电子邮件和名称的实际值）：

```
git filter-branch --env-filter '
WRONG_EMAIL="wrong@example.com"
NEW_NAME="New Name Value"
NEW_EMAIL="correct@example.com"

if [ "$GIT_COMMITTER_EMAIL" = "$WRONG_EMAIL" ]
then
    export GIT_COMMITTER_NAME="$NEW_NAME"
    export GIT_COMMITTER_EMAIL="$NEW_EMAIL"
fi
if [ "$GIT_AUTHOR_EMAIL" = "$WRONG_EMAIL" ]
then
    export GIT_AUTHOR_NAME="$NEW_NAME"
    export GIT_AUTHOR_EMAIL="$NEW_EMAIL"
fi
' --tag-name-filter cat -- --branches --tags 
```

[在此处](https://www.git-tower.com/learn/git/faq/change-author-name-email)查看更多详细信息

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2019-10-30T10:08:23.380

对于 windows 下的用户，也可以使用[git-rocket-filter](https://github.com/xoofx/git-rocket-filter)工具。

从[文档中](https://github.com/xoofx/git-rocket-filter#examples)：

*更改提交作者姓名和电子邮件：*

```
git-rocket-filter --branch TestBranch --commit-filter '
    if (commit.AuthorName.Contains("Jim")) {   
        commit.AuthorName = "Paul"; 
        commit.AuthorEmail = "paul@company.com"; 
    } 
```

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2016-12-15T15:04:56.247

这不是您问题的答案，而是您将来可以用来避免这种情况的脚本。它利用[Git 2.9 版](https://github.com/blog/2188-git-2-9-has-been-released)以来可用的全局挂钩来根据您所在的目录检查您的电子邮件配置：

```
#!/bin/sh
PWD=`pwd`
if [[ $PWD == *"Ippon"* ]] # 1)
then
  EMAIL=$(git config user.email)
  if [[ $EMAIL == *"Work"* ]] # 2)
  then
    echo "";
  else
    echo "Email not configured to your Work email in the Work directory.";
    git config user.email "youremail@youremail.com"
    echo "Git email configuration has now been changed to \"$(git config user$
    echo "\nPlease run your command again..."
    echo ''
    exit 1
  fi;
elif [[ $PWD == *"Personal"* ]]
then
  EMAIL=$(git config user.email)
  if [[ $EMAIL == "youremail@youremail.com" ]]
  then
    echo "";
  else
    echo "Email is not configured to your personal account in the Personal di$
    git config user.email "youremail@youremail.com"
    echo "Git email configuration has now been changed to \"$(git config user$
    echo "\nPlease run your command again..."
    echo ''
    exit 1;
  fi;
fi; 
```

它检查您当前的工作目录，然后验证您的 git 是否配置为正确的电子邮件。如果没有，它会自动更改它。[在此处](http://www.raphael-brugier.com/blog/git-verify-email-hook/)查看完整的详细信息。

# c++ - C/C++ 控制台 Windows WIN32

> ID：750174
> 
> 赞同：3
> 
> 时间：2009-04-15T03:09:32.990
> 
> 标签：c++

我知道如何“隐藏”它们。我知道 FreeConsole(); 然后找到句柄并更改它的属性。然而，使用这些方法，窗口仍然会弹出一秒钟而不是消失。我怎样才能阻止它完全出现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T03:16:27.277

您是否考虑过创建 Windows 应用程序（带有[windows 子系统](http://msdn.microsoft.com/en-us/library/fcc1zstk(vs.71,loband).aspx)）而不是控制台应用程序？那应该将控制台窗口全部隐藏起来。

尝试查看[WinMain](http://msdn.microsoft.com/en-us/library/ms633559(VS.85,loband).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T03:18:44.073

我相信您需要成为 GUI 应用程序才能不显示控制台。签出[/SUBSYSTEM:WINDOWS](http://msdn.microsoft.com/en-us/library/fcc1zstk.aspx)

# reporting-services - 报告服务

> ID：750177
> 
> 赞同：2
> 
> 时间：2009-04-15T03:12:21.920
> 
> 标签：reporting-services

我已经报告了当前月份运行的默认值，在报告本身上我创建了两个标签，称为 Prev 和 Next。如果我点击 Prev 标签，那么它应该创建一个 3 月份的报告，如果我点击 Next，它应该给出 5 月份的报告。我如何在报告服务中实现这一点。请帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T03:19:57.363

如果您还没有这样做，请确保报告接受一个日期参数（默认为今天的日期）并使用它来确定检索数据的月份。

其余的应该相对容易：

首先，右键单击“下一步”文本框并打开其属性对话框。那里有一个名为“导航”的选项卡。在导航选项卡上，您可以指定该文本框应链接到的报告（“跳转到报告”）。选择您当前正在处理的同一报告。

现在单击“参数”按钮以指定要传递给链接到的报告的参数。从可用参数列表中选择日期参数，并为其值使用如下表达式：

```
=dateadd("m", 1, Parameters!Date.Value) 
```

（我假设您的参数名称是“日期”。）

因此，您实际上链接到了同一份报告，但在它的运行日期上增加了一个月。显然，“Prev”文本框的工作方式相同，只是将 -1 传递给 dateadd 调用。

对于更多“.NET”表达式，您还可以尝试以下代码：

```
=CDate(Parameters!Date.Value).AddMonths(1) 
```

我相当肯定这将完成同样的事情，并且可能更具可读性。

您可能还希望设置这些 TextBox 的样式，使它们看起来像最终用户的超链接（蓝色/下划线，可能取决于您的标准）。

# c++ - typedef 指针是个好主意吗？

> ID：750178
> 
> 赞同：87
> 
> 时间：2009-04-15T03:14:18.720
> 
> 标签：c++, c, pointers, typedef, conventions

我查看了一些代码并注意到约定是将指针类型转换为

```
SomeStruct* 
```

进入

```
typedef SomeStruct* pSomeStruct; 
```

这有什么优点吗？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-04-15T03:28:56.093

当指针本身可以被视为一个“黑匣子”，即其内部表示应该与代码无关的一段数据时，这可能是合适的。

本质上，如果您的代码*永远不会*取消引用指针，而您只是将它传递给 API 函数（有时通过引用），那么 typedef 不仅会减少`*`代码中 s 的数量，而且还会向程序员建议指针应该真的不要被插手。

如果需要，这也使得将来更改 API 变得更容易。例如，如果您更改为使用 ID 而不是指针（反之亦然），现有代码不会中断，因为从一开始就不应该取消引用指针。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-04-15T03:17:01.770

不是我的经验。隐藏 ' `*`' 会使代码难以阅读。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-04-15T03:34:19.920

我在 typedef 中使用指针的唯一一次是在处理指向函数的指针时：

 ~~~~```
typedef void (*SigCatcher(int, void (*)(int)))(int); 
```~~  ~~```
typedef void (*SigCatcher)(int);

SigCatcher old = signal(SIGINT, SIG_IGN); 
```

否则，我发现它们比有用更令人困惑。

* * *

*删除的声明是指向`signal()`函数的指针的正确类型，而不是信号捕获器的指针。可以通过以下方式使其更清晰（使用`SigCatcher`上面更正的类型）：*

```
 typedef SigCatcher (*SignalFunction)(int, SigCatcher); 
```

或者，声明`signal()`函数：

```
 extern SigCatcher signal(int, SigCatcher); 
```

*也就是说， a`SignalFunction`是一个指向函数的指针，该函数接受两个参数（an`int`和 a `SigCatcher`）并返回 a `SigCatcher`。`signal()`它本身是一个函数，它接受两个参数（an和`int`a `SigCatcher`）并返回 a `SigCatcher`。*

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-04-15T03:52:14.947

这可以帮助您避免一些错误。例如在以下代码中：

```
int* pointer1, pointer2; 
```

pointer2 不是**int ***，它是简单的**int**。但是使用 typedefs 这不会发生：

```
typedef int* pInt;
pInt pointer1, pointer2; 
```

他们现在都是**int ***。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2017-04-09T21:40:45.200

我的回答是明确的“不”。

为什么？

好吧，首先，您只需将一个字符换成`*`另一个字符`p`。那是*零*收益。仅此一项就可以阻止您这样做，因为做多余的毫无意义的事情总是不好的。

其次，这也是重要的原因，**不好隐藏****的`*`**携带意义。如果我将某些东西传递给这样的函数

```
void foo(SomeType bar);

void baz() {
    SomeType myBar = getSomeType();
    foo(myBar);
} 
```

我不希望`myBar`通过将其传递给`foo()`. 毕竟，我是按价值传递的，所以`foo()`只能看到副本`myBar`对吗？不是 when`SomeType`被别名为某种指针！尤其是当该指针充当对某种对象的引用时，该对象的值基本上就是指针的含义：我不在乎指针本身不会改变（由于按值传递），我感兴趣的是对象是否改变（指针后面的对象）。

这适用于 C 指针和 C++ 智能指针：如果您隐藏它们是指向您的用户的指针这一事实，您将造成完全不必要的混淆。所以，请不要给你的指针起别名。

（我相信 typedefing 指针类型的习惯只是一种错误的尝试，试图隐藏一个程序员有多少颗星[http://wiki.c2.com/?ThreeStarProgrammer](http://wiki.c2.com/?ThreeStarProgrammer)。）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-15T03:19:51.747

这是风格问题。您在 Windows 头文件中经常看到这种代码。尽管他们更喜欢全大写版本，而不是以小写 p 为前缀。

我个人避免使用 typedef。让用户明确表示他们想要 Foo* 比 PFoo 要清楚得多。如今，Typedef 最适合使 STL 可读:)

```
typedef stl::map<stl::wstring,CAdapt<CComPtr<IFoo>> NameToFooMap; 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-15T04:45:15.753

它（就像很多答案一样）取决于。

在 C 中，这很常见，因为您试图将对象伪装成指针。您试图暗示这是您所有函数操作的对象（我们知道它是下面的指针，但它代表您正在操作的对象）。

```
MYDB   db = MYDBcreateDB("Plop://djdjdjjdjd");

MYDBDoSomthingWithDB(db,5,6,7);
CallLocalFuc(db); // if db is not a pointer things could be complicated.
MYDBdestroyDB(db); 
```

MYDB 下面可能是某个对象的指针。

在 C++ 中，这不再是必需的。
主要是因为我们可以通过引用传递东西，并且方法被合并到类声明中。

```
MyDB   db("Plop://djdjdjjdjd");

db.DoSomthingWithDB(5,6,7);
CallLocalFuc(db);   // This time we can call be reference.
db.destroyDB();     // Or let the destructor handle it. 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-04-09T19:52:09.890

^(*假设感兴趣的语言是 C 进行讨论。尚未考虑 C++ 的分支。*)

### 对未标记的结构使用 aa 指针 typedef

[定义为指针的结构](https://stackoverflow.com/questions/43304880/)的大小问题引发了关于使用`typedef`for (结构) 指针的有趣的侧面光。

考虑无标记的具体（非不透明）结构类型定义：

```
typedef struct { int field1; double field2; } *Information; 
```

成员的细节与本次讨论完全无关；重要的是这不是一个不透明的类型`typedef struct tag *tag;`（你不能通过没有`typedef`标签的 a 来定义这种不透明的类型）。

提出的问题是“你怎么能找到那个结构的大小”？

简短的回答是“仅通过类型的变量”。没有与 . 一起使用的标签`sizeof(struct tag)`。~~`sizeof(*Information)`~~例如，您不能有用地编写and`sizeof(Information *)`是指向指针类型的指针的大小，而不是结构类型的大小。

事实上，如果你想分配这样的结构，除了通过动态分配（或模拟动态分配的代理技术）之外，你无法创建一个。没有办法创建指针被调用的结构类型的局部变量，也没有办法创建结构类型的`Information`文件范围（全局或`static`）变量，也没有办法嵌入这样的结构（如与指向此类结构的指针相反）转换为另一个结构或联合类型。

你可以——必须——写：

```
Information info = malloc(sizeof(*info)); 
```

除了指针隐藏在 中之外`typedef`，这是一个很好的做法——如果类型发生`info`变化，大小分配将保持准确。但在这种情况下，它也是获取结构体大小和分配结构体的唯一方法。并且没有其他方法可以创建结构的实例。

### 这有害吗？

这取决于你的目标。

这不是一个不透明的类型——结构的细节必须在指针类型为`typedef`'d 时定义。

它是一种只能用于动态内存分配的类型。

这是一种无名的类型。指向结构类型的指针有名称，但结构类型本身没有。

如果您想强制执行动态分配，这似乎是一种方法。

不过，总的来说，它更容易引起混乱和焦虑，而不是启蒙。

### 概括

通常，使用`typedef`定义指向无标记结构类型的指针是一个坏主意。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-01-16T08:57:29.897

不。

混在一起的那一刻，它会让你的生活变得悲惨`const`

```
typedef foo *fooptr;
const fooptr bar1;
const foo *bar2 
```

`bar1`和`bar2`是同一类型吗？

是的，我只是在引用 Herb Sutter 的 Guru。她说了很多实话。;)

- 编辑 -

添加引用文章的链接。

[http://www.drdobbs.com/conversationsa-midsummer-nights-madness/184403835](http://www.drdobbs.com/conversationsa-midsummer-nights-madness/184403835)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-04-15T03:55:05.813

typedef 用于使代码更具可读性，但是将指针作为 typedef 会增加混乱。最好避免使用 typedef 指针。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-01-27T17:24:52.343

如果这样做，您将无法创建 const pSomeStruct 的 STL 容器，因为编译器会读取：

```
list<const pSomeStruct> structs; 
```

作为

```
list<SomeStruct * const> structs; 
```

这不是合法的 STL 容器，因为元素不可分配。

看到这个[问题](https://stackoverflow.com/questions/2148769/typedef-and-containers-of-const-pointers)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-15T03:42:21.413

Win32 API 对几乎所有结构（如果不是全部）都执行此操作

```
POINT => *LPPOINT
WNDCLASSEX => *LPWNDCLASSEX
RECT => *LPRECT
PRINT_INFO_2 => *LPPRINT_INFO_2 
```

它的一致性很好，但在我看来它并没有增加任何优雅。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-15T11:56:20.197

typedef 的目的是隐藏实现细节，但是 typedef 指针属性隐藏太多，使代码更难阅读/理解。所以请不要那样做。

* * *

如果你想隐藏实现细节（这通常是一件好事），不要隐藏指针部分。以标准`FILE`接口的原型为例：

```
FILE *fopen(const char *filename, const char *mode);
char *fgets(char *s, int size, FILE *stream); 
```

这里 fopen 返回一个*指向*某个结构的指针`FILE`（您不知道其实现细节）。也许`FILE`不是一个很好的例子，因为在这种情况下，它可以与一些隐藏它是指针的事实的 pFILE 类型一起工作。

```
pFILE fopen(const char *filename, const char *mode);
char *fgets(char *s, int size, pFILE stream); 
```

但是，这只会起作用，因为您永远不会弄乱直接指向的内容。根据我的经验，当您键入一些指针时，您在某些地方修改代码变得非常难以阅读。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-15T05:55:29.847

前段时间，我会对这个问题回答“不”。现在，随着智能指针的兴起，指针不再总是用星号'*'定义。因此，类型是否是指针没有什么明显的。

所以现在我想说：typedef 指针很好，只要非常清楚它是一个“指针类型”。这意味着您必须专门为它使用前缀/后缀。不，例如，“p”不是一个足够的前缀。我可能会选择“ptr”。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-11-30T21:58:53.223

一般来说，没有。在特定情况下，是的。

有一些其他答案暗示了一些结构，那就是*仅*指针类型。我想到了几个仅指针类型的构造。如果有人想到更多，我会将它们添加到列表中。

## 不透明类型

这些类型的实现对用户完全隐藏。您通常会在标头中看到一个结构 typedef，但没有该结构的实现。因此，您不能取消引用这些类型的值。对这种类型进行操作的所有函数都采用指向这些类型的指针。在这些情况下添加指向 typedef 的指针是合适的。您经常会看到这些称为“句柄”的类型。

```
typedef struct handle_ * handle;

handle get_handle(string s);
void mutate_handle(handle h, value v);
void release_handle(handle h); 
```

## 灵活的数组成员类型

另一种仅指针类型是使用灵活数组成员 (FAM) 定义的类型。FAM 类型中的最后一个成员是不受约束的数组。您打算为这些类型动态分配存储空间，并且灵活数组被视为与结构内联。您可以访问 FAM 类型中的字段，但不能取消引用整个对象。在这里添加指向 typedef 的指针也是合适的。

```
typedef struct string {
    size_t capacity;
    size_t length;
    char buffer[];
} * string;

string string_new(void);
size_t string_length(string s);
void string_append(string * s, char c);
void string_delete(string * s); 
```

# opengl - 阴影映射多纹理

> ID：750180
> 
> 赞同：3
> 
> 时间：2009-04-15T03:15:22.430
> 
> 标签：opengl, shadows

有这个关于阴影映射的教程：http: [//www.paulsprojects.net/tutorials/smt/smt.html](http://www.paulsprojects.net/tutorials/smt/smt.html)

好的，但我没有意识到如何制作具有多纹理的场景。

如果在阴影贴图的第三遍中需要绑定阴影贴图投影纹理进行深度比较，如果需要绑定阴影贴图纹理，如何绑定其他纹理？

我必须将阴影贴图设置为要绑定的单独纹理吗？像这样的东西：

1.  主动阴影贴图纹理
2.  活动纹理 1
3.  活动纹理 2

我试过了，但没有用（也许我做错了什么）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T20:10:11.747

澄清一下，你有一个预先存在的多纹理场景想要阴影贴图？

如果是这样，激活所有纹理单元应该可以工作（**如果**你有足够的，我认为 OpenGL 1.4/1.5 规范只需要至少两个；通过 glGetIntegerv() 检查 GL_MAX_TEXTURE_UNITS_ARB）。如果您没有足够的纹理单元，则必须使用多通道渲染/混合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T11:39:02.153

是的，对于深度比较通道，阴影贴图应该绑定在单独的纹理单元上。激活单元后不要忘记启用/禁用纹理。

# c# - 将 XDocument 转换为流

> ID：750198
> 
> 赞同：40
> 
> 时间：2009-04-15T03:30:10.333
> 
> 标签：c#, .net, xml, linq-to-xml

如何将 XDocument 中的 XML 转换为 MemoryStream，而不将任何内容保存到磁盘？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2011-12-05T17:40:29.747

在 .NET 4 及更高版本中，您可以将其保存到`MemoryStream`：

```
Stream stream = new MemoryStream();
doc.Save(stream);
// Rewind the stream ready to read from it elsewhere
stream.Position = 0; 
```

在 .NET 3.5 及更早版本中，您需要`XmlWriter`基于 a创建一个`MemoryStream`并保存到该文件，如[dtb 的答案](https://stackoverflow.com/a/750250)所示。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-15T03:56:12.457

看看[XDocument.WriteTo](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.writeto.aspx)方法；例如：

```
using (MemoryStream ms = new MemoryStream())
{
    XmlWriterSettings xws = new XmlWriterSettings();
    xws.OmitXmlDeclaration = true;
    xws.Indent = true;

    using (XmlWriter xw = XmlWriter.Create(ms, xws))
    {
        XDocument doc = new XDocument(
            new XElement("Child",
                new XElement("GrandChild", "some content")
            )
        );
        doc.WriteTo(xw);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-12T07:55:29.563

```
XDocument doc = new XDocument(
    new XElement(C_ROOT,
        new XElement("Child")));
using (var stream = new MemoryStream())
{
    doc.Save(stream);
    stream.Seek(0, SeekOrigin.Begin);
} 
```

# c# - 在循环中访问类似的命名属性

> ID：750204
> 
> 赞同：1
> 
> 时间：2009-04-15T03:32:25.337
> 
> 标签：c#, .net

我有一个 .Net 对象（在 C# 中），它具有名为 event1、event2 等的属性。

我必须对这些中的每一个做一些 if-else。有没有办法我可以循环这些。如果这些是控件，我可以使用控件集合，但这些是对象的属性。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T03:33:47.657

手动写出来可能是最清楚的。但是，可以使用反射来完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T03:38:29.753

使用[反射](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx)是你最好的选择，但对于你需要的东西来说它可能有点过分了。下面的代码片段取自 msdn：

```
 foreach (MemberInfo mi in t.GetMembers() )
            {                                  

                // If the member is a property, display information about the
                //    property's accessor methods.
                if (mi.MemberType==MemberTypes.Property)
                {
                    PropertyInfo pmi = ((PropertyInfo) mi);
                    foreach ( MethodInfo am in pmi.GetAccessors() )
                    {
                        Display(indent+1, "Accessor method: {0}", am);
                    }
                }
            } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T03:40:04.023

假设您知道要处理的属性数量

```
 for(int eventIndex = 0; eventIndex < NUM_EVENTS; eventIndex++)
    {
        PropertyInfo eventPropertyInfo = 
            this.GetType().GetProperty("Event" + eventIndex);

        if (eventPropertyInfo.GetValue(this, null) == yourValue)
        {
             //Do Something here
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T05:26:12.410

你这样做的理由是什么？是为了加快发展吗？您可以像许多人已经建议的那样使用反射，但是现在直接直接引用属性而不是在运行时降低性能会更有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T03:35:45.517

是的，您可以使用[反射](http://msdn.microsoft.com/en-us/library/f7ykdhsy(VS.71).aspx)来获取 PropertyInfo 对象、询问名称并获取您需要的数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T09:10:26.507

反射是一种简单的解决方案，但根据您的应用程序使用情况，它可能会很慢。

如果反射很慢，你可以通过[Emiting](http://msdn.microsoft.com/en-us/library/system.reflection.emit.ilgenerator.emit(VS.71).aspx) code 来加速。这不是一件容易的事，但最终结果与您手动编写每一行的结果相同。维护这样的代码也很困难。

# c# - WPF c#项目的sql server登录失败

> ID：750212
> 
> 赞同：2
> 
> 时间：2009-04-15T03:36:24.343
> 
> 标签：c#, sql-server, .net-3.5

我在我的 win xp 盒子上创建了一个安装的 sql server 2008，我正在我的笔记本电脑上开发我的 wpf web 应用程序。当我尝试使用代码创建连接时出现安全错误，我尝试使用笔记本电脑上的 managment studio 连接用户/密码组合，没有问题。这是我拥有的代码，在 con.Open() 处我收到错误消息，我已在代码上发布。

```
sql.SqlConnectionStringBuilder csb = new System.Data.SqlClient.SqlConnectionStringBuilder();
csb.DataSource = "mkitt.com";
csb.UserID = "user";
csb.Password = "password";
csb.InitialCatalog = "Investix";
sql.SqlConnection con = new sql.SqlConnection(csb.ConnectionString);
con.Open();

System.Security.SecurityException was unhandled by user code
  Message="Request for the permission of type 'System.Data.SqlClient.SqlClientPermission, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed."
  Source="mscorlib"
  StackTrace:
       at System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark& stackMark, Boolean isPermSet) 
```

...我切断了堆栈跟踪的其余部分...

在不确定原因/解决方案之前，我从来没有遇到过这个错误，有人知道这个问题吗？

在此先感谢您的帮助

马里奥斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T05:39:45.373

这通常是与信任相关的问题。您需要在 WPF 项目中设置安全属性以使用“完全信任”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T05:41:11.533

这是一个“代码访问安全策略”(caspol) 问题 - 即您的 WPF 应用程序没有在完全信任的情况下运行，并且没有引用的权限。

如果您使用 ClickOnce 进行部署，您可以在“安全”选项卡（项目属性）上分配您的应用应请求的权限。如果需要，您还可以请求完全信任。

# c# - 如何发布 ClickOnce 应用程序的测试版？

> ID：750216
> 
> 赞同：2
> 
> 时间：2009-04-15T03:38:09.770
> 
> 标签：c#, clickonce

我想在每次构建应用程序时发布它的 beta 版本，以便用户可以访问“beta”版本并在一般发布之前测试功能。

我尝试通过在将 ProductName 运行到 [product]-beta 时覆盖它来做到这一点。问题是发布过程仍然创建一个 [product].application 并且 ClickOnce 魔法似乎不知道一个 URL 上的 [product].application 和另一个 URL 上的 [product].application 之间的区别。

知道我将如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T04:17:31.233

我遇到了一个非常相似的问题，这是我想出的解决方案。

我将我所有的 GUI 表单放入一个 DLL 中，包括主启动表单。然后我创建了 2 个引用我的 GUI dll 的 EXE 项目。一个名称为 Product，另一个名称为 ProductBeta。
EXE 中的代码在两者之间几乎相同。即Application.Run(new MainForm())。

然后我将它们设置为发布到同一共享上的子目录。

这很烦人并且有一些开销，但结果非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T04:19:32.913

正如您所发现的，仅修改产品名称是不够的。您需要修改程序集名称。

详情来自[http://weblogs.asp.net/sweinstein/archive/2008/08/24/top-5-secrets-of-net-desktop-deployment-wizards.aspx](http://weblogs.asp.net/sweinstein/archive/2008/08/24/top-5-secrets-of-net-desktop-deployment-wizards.aspx)

> 最重要的是支持多个环境 - 这不是内置的，如果您尝试将具有相同部署名称的两个不同 ClickOnce 构建部署到不同站点，最新构建将优先并有效覆盖现有部署桌面。
> 
> 对此的修复相对简单——您需要为每个构建提供不同的部署名称。像这样——

```
<MSBuild 
   Projects="ClickOnce.csproj"
   Targets="Publish"
   Properties="
            MinimumRequiredVersion=$(MinimumRequiredVersion);
            ApplicationVersion=$(ApplicationVersion);
            ApplicationRevision=$(ApplicationRevision);
            CodeBranch=$(CodeBranch);
            DeployEnv=$(DeployEnv)
            AssemblyName=ClickOnce.$(DeployEnv);
            PublishUrl=$(PublishUrl);
            ProductName=ClickOnce $(CodeBranch) $(DeployEnv)" /> 
```

> 这种方法的一个限制是项目引用将不再起作用。使用基于文件的程序集引用，就可以了。

# database - SQL Server 2005，维护计划建议

> ID：750218
> 
> 赞同：2
> 
> 时间：2009-04-15T03:38:28.457
> 
> 标签：database, sql-server-2005, maintenance

我需要一些关于 SQL Server 2005 维护计划的建议，这里有一些问题：

1.  哪些任务适合日常维护，哪些适合每周/每月维护

2.  在某些任务中数据库是否需要离线，例如：重组/重建索引、收缩数据库等...（因为我们需要保持 90% 的正常运行时间）

3.  检查数据库完整性、重组/重建索引、清理历史记录可以多长时间？

4.  我们应该同时重组和重建索引吗？

5.  重组索引后是否需要更新统计信息？由于重建索引将自动更新统计信息

在我们的例子中，每周 7 天、每天 24 小时每 1 分钟输入一次数据（每分钟仅 200 条记录）。

有人可以建议我对这个数据库有什么好处的维护计划吗？

谢谢，
德尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T04:03:12.470

维护计划实际上取决于您的数据库进程。由于每分钟输入一次数据，您是否有任何 rollup 和 etl 进程在运行？

我可以告诉您的最重要的过程是您的数据和事务日志的每日备份（磁带和磁盘）。

使用查询计划分析器检查任何运行缓慢的查询，您可能需要根据需要每天或每周重新索引一些表。您可以在 SQL Server 2005 企业版中进行在线重新索引，这意味着您不需要离线。

通过创建维护计划来制定良好的流程，并通过创建计划作业尽可能地实现自动化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T06:13:30.987

两个字：灾难恢复

最好的计划是您已经测试过的计划。

计划灾难恢复，看看您可以从该计划中恢复多少现有系统。记下任何问题并找到解决方法，然后重新运行灾难恢复。您会发现这将帮助您做出决策并确定需求的优先级。

最好同时使用 O/S 还原和 SQL 服务器还原来执行此操作。

还有一些建议：设置一个 O/S 计划任务来执行 master、model、mssqlsystemresource 数据库的文件系统副本。这将为您省去烦恼，并且不必在单用户模式下运行 SQL 服务器来尝试从备份中恢复您的主数据库。

拥有备份一切都很好，但是如果您从不测试恢复，那么您的备份将毫无价值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-22T17:49:07.340

为了保持性能并确保数据库一致性，我通常每晚运行以下任务：

1)**备份数据库** （通常这是完整备份。但是，如果数据库非常大，则每周{周末}运行一次完整备份，每个工作日进行增量或差异备份）

2）**重建所有索引** （这也会自动重组所有索引，因此不需要重组步骤。）

3）**更新数据库统计信息** （仅需要列统计信息，因为其他统计信息由之前运行的索引重建自动更新）

4）**验证数据库完整性** （这是最重要的一步，因为它几乎可以被任何东西破坏并且仍然可以正常运行一段时间，同时所有数据都变得越来越损坏。）

5）通过电子邮件**通知操作员成功（您必须同时发送成功和失败。如果您只发送失败，那么服务器可能有另一个问题阻止发送失败电子邮件，然后他们永远不会知道。）**

6）**清理文件** （根据驱动器空间，您将需要删除旧备份。如果有空间，我会尝试至少保留几周，但随着数据库的增长，需要检查这一点，并可能将其减少到低至一两个完整备份。）

7)**清理历史记录** （维护计划日志历史记录不是很大，因此您可以保留很长的历史记录，而不必担心空间过多。当您遇到长时间失败的数据库时，有时会有所帮助。当它开始失败并用它来向监控它的人指出它没有被适当地监控成功。）

**注意：**确保从主数据库服务器上复制备份并将它们存储在异地。

# html - 选项卡式 html 应用程序

> ID：750220
> 
> 赞同：1
> 
> 时间：2009-04-15T03:38:45.213
> 
> 标签：html, iframe, tabs, object-tag

我正在编写一个复杂的基于选项卡的 Web 应用程序，其中每个选项卡在没有交互的意义上彼此无关。因此，为了便于开发，我希望每个选项卡都是一个单独的 html 页面，可以单独查看，在后期我可以通过选项卡组装它们，或者可能是菜单或树，所以问题是：

1.  我打算使用 iframe，是否所有主流浏览器都支持它们？
2.  iframe 是否会被弃用，那么有什么替代方案，例如所有主要浏览器都支持对象标签吗？
3.  也许我可以使用一些更好的策略而不是 iframe/object？

但我喜欢 iframe 的地方在于它可以完全模块化，因此每个页面都不知道其他页面。

注意：我选择了解释得很好的答案，但我仍然不确定为什么 iframe 问题[iframe 与 ajax](https://stackoverflow.com/questions/768222/iframes-vs-ajax)不能回答这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T06:03:02.883

1.  是的，所有主要的桌面浏览器都支持 iframe。许多移动浏览器也是如此，包括 iPhone 上的 IEMobile、Opera Mobile 和 Safari。我所知道的唯一*不*支持 iframe 的主要浏览器是黑莓浏览器。

2.  大多数浏览器都支持对象标签，但在各种浏览器中的实现极为不一致。

3.  仅仅拥有一个带有普通导航菜单的平面页面有什么问题？如果您一次只显示一个页面，并且唯一放置在 iframe 之外的界面元素是选项卡菜单，那么为什么不将选项卡集成到页面布局中并取消框架呢？

    任何类型的框架都会破坏人们熟悉的浏览器行为——比如前进和后退导航按钮。他们完全禁止使用书签。在构建网站时，您应该尽量不要限制或指示访问者如何允许他们浏览您的网站。如果用户想打开一个新选项卡的链接，他们不应该没有导航菜单。如果他们将浏览器窗口设置为特定大小，则页面内容应填充该区域，而不是 iframe 尺寸指定的预定区域。

    Frames are inherently user-unfriendly, which, unsurprisingly, makes them search-engine-unfriendly; which is why so few professional websites use frames/iframes. Cheap broadband is widespread enough these days that reloading a few extra kilobytes of navigational data makes no difference to the overall user experience.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T04:03:23.983

如果我是你，我会使用[jQuery UI Tabs](http://jqueryui.com/demos/tabs/)而不是我自己的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T03:59:40.497

看起来您的网站不是静态的，所以我不明白您为什么要使用纯 HTML 来做。

我会使用[ASP.NET](http://www.asp.net/)和 CustomUserControl 作为您的每个选项卡，它们的所有选项卡都是真正独立的，您可以在应用程序的任何地方重用它们

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T04:05:52.107

对于每个选项卡中的单独页面，您也可以使用服务器包含。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T05:02:27.867

要回答您的前 2 个问题：

1.  所有最新的网络浏览器都支持 iframe，但我不确定移动浏览器。Opera mobile 是的，现在不要谈论 iPhone。

2.  html 的下一个主要迭代由[WHATWG](http://www.whatwg.org/specs/web-apps/current-work/#the-iframe-element)领导，并且将支持 iFrame。[xhtml](http://www.w3schools.com/tags/tag_iframe.asp)也支持

至于不同的方法，这在很大程度上取决于您将使用选项卡做什么。如果每个选项卡上都有很多信息或需要一段时间才能加载，那么单独的 iFrame 可能是最好的。此外，如果您打算将代码作为独立页面重用，那么 iFrame 也是一个不错的选择。

# sql - 更新 sqlserver 中的数据子集

> ID：750224
> 
> 赞同：0
> 
> 时间：2009-04-15T03:43:00.710
> 
> 标签：sql, sql-server

我收到了以下请求。

请将每个销售人员注册的当前联系人的 7% 提供给新的销售人员（“彼得”）。

我决定做的是获取每个销售助理的总记录并计算 7% 的记录。

例如大卫有 200 200/7% = 14

```
SELECT TOP 14 ContactAssociate
FROM tb_Contact 
WHERE tb_Contact.ContactAssociate = 'David' 
ORDER BY NEWID() 
```

现在，我可以选择数据，但正在努力更新它们；我认为这会做到这一点，但没有快乐。

```
UPDATE tb_Contact
SET ContactAssociate = 'Peter'
IN
(
SELECT TOP 14 ContactAssociate
FROM tb_Contact 
WHERE tb_Contact.ContactAssociate = 'David' 
ORDER BY NEWID()
) 
```

任何想法，我哪里错了？任何帮助，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T03:55:45.750

试试这个：

```
UPDATE c
SET ContactAssociate = 'Peter'
FROM tb_Contact c
INNER JOIN (
  SELECT TOP 14 ContactAssociate FROM tb_Contact 
  WHERE tb_Contact.ContactAssociate = 'David' 
) q ON c.ContactAssociate = q.ContactAssociate 
```

如果你想尝试更新你想要的记录，你可以这样做：

```
SELECT c.*
FROM tb_Contact c
INNER JOIN (
  SELECT TOP 14 ContactAssociate FROM tb_Contact 
  WHERE tb_Contact.ContactAssociate = 'David' 
) q ON c.ContactAssociate = q.ContactAssociate 
```

如您所见，更新或检查之间的唯一变化是 FROM 子句之前的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T04:21:07.467

为什么不使用`TOP 7 PERCENT`or `TOP 7 PERCENT WITH TIES`？

```
DECLARE @sample int
SET @sample = 7

UPDATE tb_Contact
SET ContactAssociate = 'Peter'
where PK_Of_tb_Contact
IN
(
SELECT TOP (@sample) PERCENT PK_Of_tb_Contact
FROM tb_Contact 
WHERE tb_Contact.ContactAssociate = 'David' 
ORDER BY NEWID()
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T03:49:19.697

PK_Of_tb_Contact - tb_Contact 表中的主键

```
UPDATE tb_Contact
SET ContactAssociate = 'Peter'
where PK_Of_tb_Contact
IN
(
SELECT TOP 14 PK_Of_tb_Contact
FROM tb_Contact 
WHERE tb_Contact.ContactAssociate = 'David' 
ORDER BY NEWID()
) 
```

# objective-c - 实例化后设置 ViewController 的属性

> ID：750225
> 
> 赞同：1
> 
> 时间：2009-04-15T03:43:37.837
> 
> 标签：objective-c, properties

我正在创建一个 viewController 的实例，然后尝试在它的属性 UILabel 上设置文本。

```
BoyController *boyViewController = [[BoyController alloc] initWithNibName:@"BoyView" bundle:nil];
        NSString *newText = [astrology getSignWithMonth:month   withDay:day];
        boyViewController.sign.text = newText;
        NSLog(@" the boyviewcontroller.sign.text is now set to: %@", boyViewController.sign.text);
        [newText release]; 
```

我试过这个，但它没有用......

所以我尝试了以下方法：

```
BoyController *boyViewController = [[BoyController alloc] initWithNibName:@"BoyView" bundle:nil];
    UILabel *newUILabel = [[UILabel alloc] init];
    newUILabel.text = [astrology getSignWithMonth:month withDay:day];
    boyViewController.sign = newUILabel;
    NSLog(@" the boyviewcontroller.sign.text is now set to: %@", newUILabel.text);
    [newUILabel release]; 
```

但是没用。。

我不知道为什么我不能在boyViewController 中设置UILabel“sign”的文本属性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-06-01T11:11:18.683

这里的问题是初始化程序实际上并没有将 nib 文件加载到内存中。相反，加载 nib 会延迟到您的应用程序请求视图控制器的`view`属性。因此，`sign`当您访问控制器时，控制器的属性为空。

手动请求控制器的`view`属性将使您的示例工作......

```
BoyController *boyViewController = [[BoyController alloc] initWithNibName:@"BoyView" bundle:nil];

[boyViewController view]; // !!!: Calling [... view] here forces the nib to load.

NSString *newText = [astrology getSignWithMonth:month   withDay:day];
boyViewController.sign.text = newText;
// and so on... 
```

但是，我猜您真正想做的是创建和配置您的视图控制器，然后再将其自由地做自己的事情。（例如，也许以模态方式显示它。）`[... view]`手动调用不会是一个长期的解决方案。

更好的是在视图控制器上为标签文本设置一个单独的属性，然后实现`viewDidLoad`将其分配给标签：

```
@interface BoyViewController : UIViewController {
    IBOutlet UILabel *label;
    NSString *labelText;
}
@property(nonatomic, copy)NSString *labelText;
@end

@implementation
@synthesize labelText;

- (void)viewDidLoad
{
    [label setText:[self labelText]];
}

// and so on...

@end 
```

如果在内存不足事件期间清除视图，这具有重置标签文本的额外好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T03:57:11.487

您是否在 Interface Builder 中绑定了您的插座？

您似乎需要将第一个示例的**符号**出口绑定到 Interface Builder 中，以便将该文本实际设置为您想要的任何内容。

在 Interface Builder 中将您的插座绑定到实际的 UI 组件后，您应该能够执行以下操作：

```
NSString *newText = [astrology getSignWithMonth:month withDay:day];
[[boyViewController sign] setText:newText]; 
```

[这](http://developer.apple.com/documentation/developertools/Conceptual/IB_UserGuide/ConnectionsandBindings/ConnectionsandBindings.html)是您需要了解的有关绑定的信息。

你的第二个例子对我来说根本没有意义。

# endianness - 20年后的兼容性问题还会存在20年吗？

> ID：750226
> 
> 赞同：3
> 
> 时间：2009-04-15T03:44:10.957
> 
> 标签：endianness, directory, carriage-return

由于 CR/LF、不同的斜线类型或 Big Endian 与 Little Endian 错误，没有什么能比您生命中的第 43 天更重要的了。这些问题已经存在 20 年了，它们让我觉得人类仍然是穴居人。我们只是将这些旧问题替换为新问题吗？XML 提供了帮助，但这些问题不是让公司花费数百万的时间、金钱和精力吗？是否是一个促进供应商锁定的阴谋？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T03:48:12.507

是的。

但是我不认为这是一个阴谋。“永远不要把可以用无能来解释的事情归咎于恶意”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T03:51:16.697

我认为我们被旧问题困住了，而且每天我们也会遇到很多新问题。这与供应商锁定无关，更多的是我们的思维方式，实际上我们仍然是穴居人，我们的大脑在 20,000 年中没有太大变化，我们继续犯同样的错误。

您已经触及了比编码更大的哲学观察，它适用于人类生活的大多数方面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T03:48:18.123

2038 年左右总会有即将到来的 Unix 日期溢出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T03:47:55.597

与[令牌环网络](http://en.wikipedia.org/wiki/Token_Ring)等物理结构不同，软件和数据是无形的。我认为数据格式化问题 CR/LF 问题在未来仍会持续 20 年（尤其是考虑到现在还没有解决）。

您可以对每个项目进行判断。如果程序无法读取大端或小端，则数据将被转换并最终消失。但是，如果程序继续遵循[鲁棒性原则](http://en.wikipedia.org/wiki/Postel's_law)——诸如 CR/LF、Big Little Endian 和 HTML 的混杂之类的东西将持续很长时间。

# silverlight - 大数据服务 (Astoria) 有效负载：如何提高性能？

> ID：750229
> 
> 赞同：0
> 
> 时间：2009-04-15T03:48:11.460
> 
> 标签：silverlight, wcf-data-services

我有一个 silverlight 客户端通过 ado.net 数据服务访问数据。我的一个查询有许多扩展子句，并返回了相当多的条目。xml 响应是巨大的，我正在寻找提高效率的方法。

我努力了：

*   分页（不是此行为的选项）
*   Http 压缩（部分客户端电脑运行 IE6）
*   将扩展作为单独的查询进行并稍后加入实体（这稍微改进了一些事情）

是否可以将 JSON 用作 silverlight 客户端的传输格式？我在网上没有找到任何关于这个的...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T03:57:17.163

您可以在下面的链接中看到在 silverlight 中使用 JSON 的演示

[http://timheuer.com/blog/archive/2008/05/06/use-json-data-in-silverlight.aspx](http://timheuer.com/blog/archive/2008/05/06/use-json-data-in-silverlight.aspx)

我不确定使用 JSON 可以获得多少性能提升。我绝对记得 ado.net 服务处理 JSON。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T07:07:48.147

出色地。我有机会和 Tim Heuer 谈谈这件事，他非常棒地去向 Pablo Castro 找我。谢谢蒂姆！

Silverlight 客户端不能使用 JSON，但 Silverlight 3 默认使用二进制 xml 与 Web 服务通信。罗尔。

我为自己解决的另一件事是，使用 expand 有时会产生比执行多个请求更多的数据。如果您将几个查询一起批处理，然后将对象手工缝合在一起，您可以节省相当多的 xml。

# javascript - 自调用函数的括号符号在 Javascript 中是否有用？

> ID：750231
> 
> 赞同：11
> 
> 时间：2009-04-15T03:48:17.263
> 
> 标签：javascript, functional-programming, scope

当我在 Javascript 中看到自调用匿名函数的示例时，我感到很困惑，例如：

```
(function () { return val;}) (); 
```

此语法与以下语法是否有区别：

```
function() { return val;} (); 
```

如果有人能给我一个具体的区别，那将有助于解决困扰我多年的问题......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-15T03:55:26.420

Javascript 没有块作用域，因此这是一种创建不会污染全局命名空间的临时局部作用域的方法。括号有两个目的：

1.  如果缺少某些 javascript 实现，它们就会被淘汰。
2.  它向读者发出信号，表明正在发生与正常函数声明不同的事情。因此，作为一个约定，它表示这个函数被用作一个作用域。

见这里： http: [//peter.michaux.ca/articles/an-important-pair-of-parens](http://peter.michaux.ca/articles/an-important-pair-of-parens)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T03:54:17.467

在 Safari 4 中，以下代码（不带括号）会导致“SyntaxError: Parse error”：

```
function() { alert("Test"); }(); 
```

...但以下代码按预期工作：

```
(function() { alert("Test"); })(); 
```

**更新**：我还尝试了 Firefox 3 中的代码（通过 Firebug），它的行为就像 Safari。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T05:39:14.673

原因

```
function() { return val;} (); 
```

不起作用是因为它是一个函数**语句**，而不是一个**表达式**。这是一个很小的区别，但基本上，如果语句以 开头`function`，它就像一个 C 函数声明，你不能调用该函数，因为没有表达式值。

添加括号使函数定义成为表达式的一部分，因此它具有值并且可以被调用。

分配函数的返回值也消除了对括号的需要，因为函数定义不是整个语句。例如，这些工作：

```
var value = function() { alert("works"); return 0; }();
(function() { alert("works"); })(); 
```

但这不是：

```
function() { alert("doesn't work"); }(); 
```

我总是包含括号，即使它们不是必需的，因为这样更容易看到我正在调用函数，而不是将其分配给变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T03:55:15.267

据我所知，唯一的区别是后者有时不适用于某些类型的 ECMAScript（即 ActionScript，但可能还有其他）。

# javascript - 使用 jquery，如何像 Live Mail 处理电子邮件地址一样处理标签？

> ID：750238
> 
> 赞同：1
> 
> 时间：2009-04-15T03:52:50.263
> 
> 标签：javascript, jquery, textbox, richtextbox, tagging

我需要一个类似于标签的系统，该系统的运行方式与 Live Mail 处理电子邮件地址的方式非常相似。

对于那些不知道的人，Live Mail 提供了一个`textbox`您可以在其中输入电子邮件地址的功能。当您完成输入电子邮件地址时，Live Mail 会将地址从纯文本更改为具有边框并在其中包含文本的 div。如果要删除地址，请将鼠标悬停在地址上，右侧会出现一个十字。在地址被“标记”后，您将无法更改地址。如果要更改它，则需要将其删除并重新添加。

这是我需要的功能，除了我将使用标签而不是电子邮件地址来执行此操作。

我想知道是否有人知道以这种方式工作的 jquery 组件。

干杯，安东尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T00:08:05.683

我从来没有听说过这样的 JQuery 插件，但你自己完成它应该不会太难。但是，它当然需要一些关于 CSS 的知识才能获得实际外观。

```
// Code for replacing a textbox with a DIV on blur.
$('#textbox').blur(function () {
  var content = $(this).val();
  if (!content) return; // Don't make anything out of empty textboxes.
  // Create a DIV and make it a sibling to the textbox.
  $('<div>').html(content).appendTo($(this).parent());
  // Remove the textbox.
  $(this).remove();
}); 
```

顺便说一句，我还没有测试过这些，但这应该会让你走上正轨。

！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T00:15:22.263

[jquery facebook 自动完成](http://wharsojo.wordpress.com/2008/02/18/jquery-facebook-autocomplete/)（通过[Ajaxian](http://ajaxian.com/archives/facebook-style-input-box)）

有一本书是关于[Jquery 1.6 UI](http://www.packtpub.com/user-interface-library-for-jquery/book)的，它有一个自动完成的电子邮件，以及最后一个自动完成的例子（[书源代码](http://www.packtpub.com/support/book/user-interface-library-for-jquery)）。

# language-agnostic - 如何使用按位运算设置或清除前 3 位？

> ID：750240
> 
> 赞同：10
> 
> 时间：2009-04-15T03:53:30.840
> 
> 标签：language-agnostic, bit-manipulation

可以说我有一个像`0x448`. 在二进制中，这是`0100 0100 1000`.

如何使用逐位运算将位 1、2 和 3 设置为全 0 或全 1？当我说前三个时，我将最右边的位视为零位。

所以，例如

位为 1：

```
b12            b0 
  0100 0100 1110
            ^^^ 
```

位为 0：

```
b12            b0
  0100 0100 0000
            ^^^ 
```

我猜想将它们设置为 1 我使用按位或掩码为 14 (0x000e)？但如果是这种情况，我该如何做类似的事情来清除这些位？

* * *

有关的：

*   [如何在 C 中设置、清除和切换单个位？](https://stackoverflow.com/questions/47981/how-do-you-set-clear-and-toggle-a-single-bit-in-c/)（语法不同，但操作相同）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-15T03:59:22.823

您的位设置正确：`OR`使用您要设置的位的掩码。

位清除位非常相似：`AND`使用要清除的位的补码。

示例： 的词`0x0448`。

设置位 1、2 和 3 将是`Word OR 0x000e`：

```
 0000 0100 0100 1000 = 0x0448
 OR 0000 0000 0000 1110 = 0x000e
    ---- ---- ---- ----
  = 0000 0100 0100 1110 = 0x044e 
```

清除位 1、2 和 3 将是`Word AND 0xfff1`：

```
 0000 0100 0100 1000 = 0x0448
AND 1111 1111 1111 0001 = 0xfff1
    ---- ---- ---- ----
  = 0000 0100 0100 0000 = 0x0440 
```

详细说明补码，用于清除的 AND 模式是用于设置的 OR 模式的逻辑非（每位反转）：

```
 OR 0000 0000 0000 1110 = 0x000e
AND 1111 1111 1111 0001 = 0xfff1 
```

所以你可以使用你最喜欢的语言 NOT 操作，而不必找出两个值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T03:58:07.617

假设您有一个掩码 m，其中所有要设置或清除的位的位设置为 1，否则为 0：

*   清除位：x & (~m)
*   设置位：x | 米
*   翻转位：x ^ m

如果你只对一位感兴趣，在位置 p（从 0 开始），掩码很简单可以表示为 m = 1 << p

请注意，我使用的是 C 风格的约定，其中：

*   ~ 是 1 补码：~10001010 = 01110101
*   & 是按位与
*   | 是按位或
*   ^ 是按位异或
*   << 是左位移位：10001010 << 2 = 00101000

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T03:55:18.683

OR 与 1 始终为真；AND 与 0 总是错误的。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T03:56:29.833

假设您的 OR 0x14 是正确的，清除将是：

与（非 0x14）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T03:59:42.183

用于清除位使用 AND 与 0x440

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T04:01:57.700

```
number &= ~0xe 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-05T18:15:34.047

让我们确保位从 0 开始计数，从右侧或最低有效位开始，然后向左。然后观察：1 <

```
 1 <<3     = 00001000

 1 <<p - 1 puts 1 at all positions up to p, exclusive 
 1 <<3-1=00000111 
```

最后一步产生了一个掩码来清除从最高位到 p 位的位。您可以使用 tilda 将其反转以清除另一半。希望这可以帮助。

# javascript - Javascript 性能优化？

> ID：750255
> 
> 赞同：3
> 
> 时间：2009-04-15T03:58:44.913
> 
> 标签：javascript, optimization, profiling

只是想知道什么是真正检查 JS 脚本的最佳工具，并研究在大小和速度方面将整体性能提高到“最大程度”的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T04:04:16.743

我喜欢使用[Firebug](http://getfirebug.com/)的分析器来提高整体速度。它会告诉你每个函数被调用了多少次，执行时间（平均和总体），以及函数花费的总 JS 执行时间的百分比。我不是微优化的忠实拥护者，所以我不使用任何工具来从我的代码中获得“最大程度的”，但分析器有助于清除更大的问题。

至于大小，我使用[YUI 压缩器](http://developer.yahoo.com/yui/compressor/)来最小化我的 JavaScript 文件的大小。（还有其他 JavaScript 缩小工具，我只是最习惯 YUI 的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T04:05:50.123

如果您拥有 Safari 4，则可以在其[Web Inspector](http://www.apple.com/safari/features.html#developer)中使用 JavaScript Profiler 。

对于压缩代码，我喜欢 Dean Edwards 的[JavaScript Packer](http://dean.edwards.name/packer/)。

史蒂夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T04:07:14.363

我通常遵循以下步骤。

1.  使用 JSLint - [http://www.jslint.com/](http://www.jslint.com/)优化脚本。
    *   使用 YUI 压缩器。
    *   分析脚本。请参阅 Firebug 和 YSlow。

# printing - 使用 SHIMGVW.DLL 从命令行打印 EMF (WMF)

> ID：750256
> 
> 赞同：1
> 
> 时间：2009-04-15T03:58:51.310
> 
> 标签：printing, vector, xps, .emf, wmf

适用于 Windows XP / Windows Server 2003

我正在尝试从命令行使用 Windows 图片和传真查看器 (shimgvw.dll) 将 EMF（或 WMF）文件格式打印到虚拟打印机“Microsoft XPS Document Writer”。我希望生成的 XPS 是矢量格式，就像 WMF/EMF 一样。

它适用于除 WMF 和 EMF 之外的所有图像格式。XPS 打印机保存对话框出现，但保存的 XPS 文件为空。

如果我加载 WMF 并从 Windows 图片和 FaxViewer GUI（而不是从命令行）单击文件>打印，我可以做到这一点。此外，如果我在 Windows 资源管理器中右键单击 WMF 文件并单击“打印”，它将不允许打印所选的 WMF 文件（它会将 WMF 和 EMF 文件从列表中过滤掉）。

代码：
`ProcessStartInfo info = new ProcessStartInfo();
info.FileName = @"C:\WINDOWS\System32\rundll32.exe";
info.Arguments = @"C:\WINDOWS\System32\shimgvw.dll,ImageView_PrintTo /pt ""c:\vectorImage.emf"" ""Microsoft XPS Document Writer""";
Process.Start(info);`

不久前我读过很多关于 WMF 漏洞利用的文章，只能假设这些文件的直接打印已被删除？但是，如果我可以从 GUI 打印这些 WMF 文件，那么我看不到如何避免利用。

**我想要做的是以编程方式从 WMF/EMF 文件创建 XPS 矢量文件，无需用户交互。**我想我应该能够做到这一点，因为所涉及的所有格式都属于微软。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-14T23:59:22.077

查看以下 C 语言示例，了解如何将 GDI 命令放入 XPS 文档：http: [//blogs.msdn.com/fyuan/archive/2005/09/16/469076.aspx](http://blogs.msdn.com/fyuan/archive/2005/09/16/469076.aspx)

您要做的是创建打印机 DC，调用 StartDoc，调用 StartPage，然后设置放置 emf 的视口和窗口比例，调用 PlayEnhMetaFile()、EndPage、EndDoc。

Feng Yuan 提出的技巧是使用 StartDoc 的 DocInfo 参数来指定输出 XPS 文件名，我建议您将元文件内容播放到打印机 DC。

我相信 EMF 漏洞利用已被 Microsoft Update 关闭。您可能看到的问题是由于 GDI 和 XPS 打印路径是分开的，并且在这种极端情况下缺乏将它们连接起来的努力。

-杰森

# string - 将参数与第一个参数匹配

> ID：750265
> 
> 赞同：1
> 
> 时间：2009-04-15T04:04:16.383
> 
> 标签：string, pointers, arguments, iteration

好的，我必须编写一个接受 2 个或更多参数的程序，并在第二个和剩余的参数中搜索匹配的参数。
例如输出将是：

```
./a 3 h 4 9 3  
3 found 
```

或者

```
./a hsi and iash me 34 hsi  
hsi found 
```

到目前为止，我有这个，而且我很确定这里有很多垃圾，在这种情况下是无用的。提供的任何帮助将不胜感激！：

```
int linear_search (const char*A[], char*x, int v ){  
    int i;  
    i = 0;  
    while ( i < v - 1){  
        if  (A[i] == x){  
            return 1;  
        }  
        return 0;  
    }  
}  

int main (int argc, char*argv[]){  
    int size = argc - 1;  
    char*A[size];  
    char*x = argv [1];  
    int i;  
    int v = argc - 2;  

    i = 0;  
    while ( i < v ){  
        A[i] = argv [i + 1];  
        i = i +1;  
    }  

    if (linear_search (A, v, x)){  
        printf ("%s found\n", x);  
    } else {  
        printf ("%s not found\n", x);  
    }  
} 
```

每当我通过编译器运行程序时，我都会收到警告：从不兼容的指针类型传递 'linear_search' 的 arg 1。
警告：传递 'linear_search' 的 arg 2 使指针从整数而不进行强制转换。

这意味着什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T04:10:04.077

这就是我的做法。您不需要单独的线性搜索功能。

```
#include <stdio.h>
#include <string.h>
int main (int argCount, char *argVar[]) {
    int i;
    if (argCount < 3) {
        fprintf (stderr, "Usage: argfind <argToFind> <otherArg> ...\n");
        return 1;
    }
    for (i = 2; i < argCount; i++) {
        if (strcmp (argVar[1], argVar[i]) == 0) {
            printf ("'%s' found in argument %d\n", argVar[1], i);
            return 0;
        }
    }
    printf ("'%s' not found\n", argVar[1]);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T04:17:06.010

我认为问题出在线性搜索函数中……看起来您只是在比较指针以查看它们的字符串是否相同。

```
if (A[i] == x) 
```

C 不能那样工作。所做的只是检查指针地址是否相同。您需要使用 strcmp() 函数来检查实际字符串是否相同。

我还建议对变量进行更具描述性的命名，这会使事情更容易阅读。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T04:27:30.150

*   的调用`linear_search`与声明不匹配。如果不是彻底的错误，这至少应该给你警告。

    声明是：

    `linear_search (const char*A[], char*x, int v )`

    而调用是：

    `linear_search (A, v, x)`

    最后两个参数真的应该交换。

*   此外，您不能使用`==`运算符来匹配 C 中的字符串。您必须使用`strcmp`、`strncmp`或 `memcmp`. 之一

*   您可能需要开始复制，如果您打算`A`从索引中使用`2`而不是第一个（这`argv[ 1 ]`是您正在搜索的键，将其放入`A`将始终返回匹配项，即使它在参数的其余部分中不存在列表）。

*   注意在 C 中，您可以使用下标运算符将数组的一部分传递给函数，因此您不需要复制到数组`A`。您可以将其`&argv[ 2 ]`作为 的第一个参数`linear_search`。

# python - Emacs - 本地 Python 变量的制表符补全

> ID：750267
> 
> 赞同：30
> 
> 时间：2009-04-15T04:04:18.600
> 
> 标签：python, emacs, autocomplete

是否有一个好的 emacs 模式可以允许本地 python 变量的制表符完成？我设置了 ipython.el 但它只会在解释器范围内完成制表符。我正在寻找可以让我在函数或文件的本地命名空间中使用制表符完成标记的东西。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-15T08:02:33.580

M-/ 运行命令 dabbrev-expand 。这将在任何模式下完成本地名称。此外，我将 meta f1 绑定到嬉皮从所有开放缓冲区扩展。这对我来说非常有用。

```
;; Bind hippie-expand
(global-set-key [(meta f1)] (make-hippie-expand-function
                               '(try-expand-dabbrev-visible
                                 try-expand-dabbrev
                                 try-expand-dabbrev-all-buffers) t)) 
```

希望这是有用的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-19T13:09:35.023

我将 emacs-autocomplete.el（版本 0.2.0）与 yasnippet 一起使用。对我来说没问题，虽然它不像 eclipse+java 那样是一个完整的自动完成环境。但是对于像我这样的普通 emacs 黑客来说已经足够了 :)

[1）从这里](http://www.emacswiki.org/emacs/AutoComplete)（第一个链接）下载自动完成并将其放在您的加载路径目录中。同时下载你想使用的扩展（注意：Ruby 和 etags 扩展需要额外的东西）。把它们也放在你的加载路径目录中。

2) 下载[yasnippet](http://www.emacswiki.org/emacs/Yasnippet)并按照该页面上的说明进行安装（包括 (require ...) 部分）。

3）将这些行放在您的 .emacs 文件中并根据您的需要对其进行编辑（就像您要使用的所有扩展名一样）：

```
(require 'auto-complete)
(global-auto-complete-mode t)

(when (require 'auto-complete nil t)
  (require 'auto-complete-yasnippet)
  (require 'auto-complete-python)
  (require 'auto-complete-css) 
  (require 'auto-complete-cpp)  
  (require 'auto-complete-emacs-lisp)  
  (require 'auto-complete-semantic)  
  (require 'auto-complete-gtags)

  (global-auto-complete-mode t)
  (setq ac-auto-start 3)
  (setq ac-dwim t)
  (set-default 'ac-sources '(ac-source-yasnippet ac-source-abbrev ac-source-words-in-buffer ac-source-files-in-current-dir ac-source-symbols)) 
```

有关选项的更多信息，请参阅 auto-complete.el 文件。

4) 重新启动 emacs 或使用您的 .emacs 文件执行 Mx 加载文件。编写一些代码并按 TAB 键自动完成。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-15T09:24:11.777

可以 [在 Emacs 中的 Python 代码完成中](http://www.enigmacurry.com/2009/01/21/autocompleteel-python-code-completion-in-emacs/)找到描述您想要的选项卡完成类型的博客文章。有一些安装包、pymacs、[AutoComplete](http://www.emacswiki.org/emacs/AutoComplete)、rope、ropemacs、rope mode、yasnippet 和设置，但最后我希望它会得到回报。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-10T08:31:32.483

使用[绝地](https://github.com/tkf/emacs-jedi)！

它确实比任何其他自动完成库都更了解 Python：

*   内置
*   多重回报或收益
*   元组赋值/数组索引/字典索引
*   with语句/异常处理
*   *args / **kwargs
*   装饰器/lambdas/闭包
*   生成器/迭代器
*   一些描述符：属性/静态方法/类方法
*   一些神奇的方法：`__call__`, `__iter__`, `__next__`, `__get__`, `__getitem__`,`__init__`
*   list.append()、set.add()、list.extend() 等
*   （嵌套）列表推导/三元表达式
*   相对进口
*   getattr() `__getattr__`//`__getattribute__`
*   简单/通常的 sys.path 修改
*   isinstance 检查 if/while/assert

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-15T04:09:23.627

我认为您可能正在寻找类似的[东西](http://www.rwdev.eu/articles/emacspyeng)。它使用[Pymacs](http://pymacs.progiciels-bpi.ca/)和[python-mode](http://sourceforge.net/projects/python-mode/)来做你正在寻找的东西。

让我们知道它对您的效果如何？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-06-08T15:05:47.197

如果您只想轻松启动并运行它，请尝试使用[emacs-for-python](http://gabrielelanaro.github.com/emacs-for-python/)包。

快乐编码！

# language-agnostic - 如何为所有设备、PC、iphone、黑莓、windows mobile android 等创建一个网站？

> ID：750273
> 
> 赞同：1
> 
> 时间：2009-04-15T04:05:36.723
> 
> 标签：language-agnostic

我想为所有 PC、iPhone、Blackberry、Windows Mobile (IE Mobile)、Opera Mobile Browser 等创建一个网站。

什么事情需要考虑，避免。我知道移动浏览器不太支持 Javascript，iPhone 不支持 CSS 媒体手持设备。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T04:23:09.927

我建议您至少创建两种类型的网站，一种用于桌面浏览器，一种用于移动浏览器。对于桌面浏览器，我想您可能知道所有大多数现代浏览器在呈现标准 ACID 2 时都没有问题（我不知道为什么 IE8 在某些网站上一直失败，因为它完全支持 ACID 2）。

移动浏览器通常支持 HTML 4 和 XHTML 1.0 Basic，您可以根据浏览器支持考虑使用什么 DOCTYPE... 就我创建移动网站而言，我使用 XHTML 1.0 Basic 和 WCSS（移动浏览器的某种 CSS 扩展） ）。

到目前为止，Opera 在移动浏览器上是最好的，其次是 iPhone Safari，Pocket IE 最差，黑莓浏览器太旧（Storm 等新设备除外）。

通常要避免的事情 Javascript 和 CSS 2（最好坚持使用 CSS 1.x）不要使用过多的 CSS，尤其是定位和边框

我建议您阅读[http://mobiforge.com/上的一些文章](http://mobiforge.com/)

编辑（添加更多参考文章）：对于移动网页设计，您应该查看以下文章： http:
[//mobiforge.com/designing/story/effective-design-multiple-screen-sizes](http://mobiforge.com/designing/story/effective-design-multiple-screen-sizes)
[http://mobiforge.com/designing /story/mobile-app-design-getting-point-part-i](http://mobiforge.com/designing/story/mobile-app-design-getting-point-part-i)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T04:27:12.350

查看[http://www.phonegap.com](http://www.phonegap.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-19T13:25:31.043

试试这些人：

[http://www.wapple.net](http://www.wapple.net)

他们有一个在线程序，可以根据每部手机的功能完美呈现您的网站。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-12T01:47:15.887

我和你有同样的问题！但是你不能做一个手机和电脑网站。你可以有类似的东西：www.yoursite.com 和一个名为 www.m.yoursite.com 的手机，类似的东西。但我知道一些你不应该放在你的移动网站上的东西。•Flash～Flash 视频、(Youtube)Flash 游戏/动画(*.swf)...不应出现在您的移动网站中！•Javascript～大多数设备不能处理一些Javascript。（随着 Nintendo DSi 接受 Opera 9.5。）然而，DSi 的网站对所有内容都使用 Javascript。（如www.dsipaint.com 和www.dsicade.com） •大图片！～如果您放入大图片，页面可能无法正确加载。•Lots ah' Content～这就像大图一样。但是太多的内容可能会弹出一个错误屏幕，上面写着这样的内容：“页面包含太多内容。返回首页。“只要记住我的一些提示！（如果您需要一个好的移动网站示例，请尝试：在您的移动浏览器上使用 hach​​ibook.muf.mobi。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T04:10:54.917

任何支持 xhtml 的平台

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-04T20:31:38.780

通过使用 css，您可以拥有一页和两种样式，一种用于 pc，另一种用于移动为了制造这种情况，请按照此步骤 1 为 pc 制作页面 2 样式，例如 a.css 3 为移动设备设置样式，例如 b.css 4在标签中创建指向两个 css 文件的链接，但对于 pc 一个添加媒体属性并通过 =“screen”和移动 =“handheld”填充它的内容

# .net - 将 Sharepoint 与 ASP.NET 作为开发平台进行评估

> ID：750278
> 
> 赞同：7
> 
> 时间：2009-04-15T04:07:44.707
> 
> 标签：.net, asp.net, sharepoint, architecture

我正在评估 Sharepoint（不是 MOSS）与 ASP.NET 作为我们团队即将推出的解决方案的开发平台。我们将为跨各种环境的广泛（我们希望）部署开发解决方案。我正在确定类别以评估每个平台选择的优缺点。我选择了适用于我们的解决方案要求并且会影响开发人员/测试人员生产力的类别。谁能想到任何其他适合进行比较的类别？任何人都可以提供任何关于您在这两个平台上的任何类别的体验的详细信息吗？

其他一些信息，我们有短短两个月的时间来发布一些东西，所以我们正在优先考虑功能。我们将 Sharepoint 视为一种快速推出产品的方式，同时将 UI 框架用于基本 UI、安全性以及用于存储的列表和文档库。

冗余/复制/备份/恢复支持

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T04:12:10.920

我看不出成本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T04:20:53.723

您的解决方案是否与协作或 Web 内容管理有关？如果没有，将 SharePoint 添加到组合中并不是一个好主意。

使用 WSS 3.0 作为开发平台而不是 ASP.NET 需要一些严肃的理由，而且从您对解决方案的有限描述中无法判断您为什么会考虑这样做。

在您的所有测量方面，在 SharePoint 平台上创建开发会增加复杂性，因此会增加任何开发工作的成本。

**更新**

> 我将 Sharepoint 安全性、文档库、UI 框架以及无需构建和测试数据库视为伟大的生产力增强器。这些是我们可以从中受益匪浅的 Sharepoint 功能

SharePoint 对这些项目的好处远远超过了学习、编码和支持 SharePoint 的成本方面。ASP.NET 以更易于管理的方式为这些项目提供了简单的解决方案。使用过这两种产品后，您将希望继续使用 ASP.Net

请记住，SharePoint 列表不具有任何类型的关系完整性，因此在 SharePoint 中创建任何列表之间的关系，最终*将比*创建连接语句和一些存储过程更昂贵。

在不了解项目的更多细节的情况下，我不能完全排除 SharePoint 是一种解决方案。

虽然可以将 SharePoint 用作开发平台，但如果您没有 SharePoint 专家与您合作来回答您的问题，那么您的项目将没有足够的 SharePoint 技能来使其成功。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T04:23:18.490

可扩展性
许可证限制
可扩展
性 复杂性
概念完整性（域边界）
供应商锁定/开放系统支持
冗余/复制/备份/恢复支持

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T12:52:36.753

正式地，为了开发 WSS 解决方案，您的所有开发人员都需要*在*WSS 服务器上运行他们的开发环境。我认为这是负面的。

请参阅Somasegar[在 Visual Studio 中的 Sharepoint 工具支持](http://blogs.msdn.com/somasegar/archive/2009/02/19/sharepoint-tools-support-in-visual-studio.aspx)下的许多评论。

我想说，由于您的截止日期很短，您还考虑了一个事实，即 SharePoint 开发人员社区比 ASP.NET 社区小得多。比较 SO 上标记为“ASP.NET”的文章数量与标记为“SharePoint”的文章数量。

我会在短期内使用 ASP.NET，了解您可以重构您的应用程序以在长期内使用 SharePoint。使用类似于您在 SharePoint 中创建的列表或其他内容类型的数据库结构。保持类似的部署模型。随意使用工作流，但它应该与 SharePoint 的工作流功能平行。您甚至可以以类似的方式布置您的页面。这将使您在有更多时间时更容易迁移到 SharePoint。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T12:25:26.470

我们使用 SharePoint 作为我们构建的大多数应用程序的组件，因为它能够创建和管理列表和内容类型（以及自动 CRUD）、版本控制、权限模型和工作流工具。

我们开发了 SLAM，即 SharePoint 列表关联管理器，以克服 SharePoint 数据不是关系方面的明显限制。因为它将 SharePoint 数据推送到 SQL Server，它允许我们仅在“后端”使用 SharePoint，而前端仅使用 ASP.NET，这是我们经常使用的配置。

我们已将 SLAM 作为开源项目发布，因此开发社区的其他成员可以利用这种方法并帮助我们扩展它。

[http://slam.codeplex.com](http://slam.codeplex.com)

快乐的砰砰声！

艾伦

# jquery - 如何选择所有不包含 A 元素的 TD 元素？

> ID：750279
> 
> 赞同：2
> 
> 时间：2009-04-15T04:08:58.243
> 
> 标签：jquery, html-table

我正在尝试使用 JQuery 来选择其中**没有**标签的所有`TD`' 。（他们应该只有文字）。我怎样才能做到这一点？`table`**`A`**

 *** * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T04:13:04.257

```
$("td:not(:has(a))").doStuff(); 
```

# dll - 将 MFC Gui 应用程序包装到 .NET 互操作的 DLL（或其他东西）中

> ID：750284
> 
> 赞同：0
> 
> 时间：2009-04-15T04:11:05.853
> 
> 标签：dll, mfc, interop

听起来像个可怕的主意？是的，我也是这么想的。不用说我告诉我必须这样做。

情况：旧的基于 MFC 的 C++ gui 应用程序，它读取大量数据源并将其处理为内部数据结构，然后再将其显示给用户。

问题：我需要 .NET 中的数据结构，在 XML 中就可以了。

解决方案：

1.  在 MFC 应用程序中创建一个函数，将数据结构写入一个大的 XML 字符串（简单）。
2.  dll 导出此函数（或 COM？）（作为 C++ 或 C 函数或什么？）
3.  将 MFC GUI 应用程序编译成 dll（如何？）。
4.  ？？？
5.  从 .NET 和 P/Invoke 方法中引用 dll 以获得丰厚的利润。

这是疯了吗？是否可以从 GUI MFC 应用程序编译 dll 库而不更改它？这是一个可怕的想法吗？我的替代方案是什么？我很迷茫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T04:26:01.683

我将致力于在 MFC 应用程序中提取特定的业务逻辑代码并将这些内容粘贴到 DLL 中，而不是试图包装整个应用程序。

您可能会在这里做出错误的假设，即将 MFC 应用程序包装为 DLL（基本上删除所有 GUI 代码，添加 DLL 主程序并修改构建过程以生成 DLL）将花费您更少的精力，而不是工作量隔离业务逻辑代码并将其放入新的 DLL 项目中。

要将 GUI 封装为 DLL，您需要很好地理解业务逻辑代码的依赖关系以及 GUI 如何使用它，因此您不妨将这些内容删掉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T00:55:06.580

你能稍微改变一下 MFC 源吗？为什么不添加一些命令行参数以使应用程序将 XML 吐出到标准输出而不是启动 GUI？

在您可以通过[继承](http://www.codeguru.com/forum/showthread.php?t=386406)`CWinApp::InitInstance`来访问命令行参数。[`CCommandLineInfo`](http://www.codeguru.com/forum/showthread.php?t=386406)

从 .Net 客户端，启动进程并捕获输出。

# python - 检查变量是否在python中定义的简单方法？

> ID：750298
> 
> 赞同：48
> 
> 时间：2009-04-15T04:21:17.717
> 
> 标签：python

有没有办法检查是否定义了具有指定名称的变量（类成员或独立）？例子：

```
if "myVar" in myObject.__dict__ : # not an easy way
  print myObject.myVar
else
  print "not defined" 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-15T04:34:16.030

一种紧凑的方式：

```
print myObject.myVar if hasattr(myObject, 'myVar') else 'not defined' 
```

不过，htw 的方式更像 Pythonic。

`hasattr()`但与 不同`x in y.__dict__`：`hasattr()`考虑继承的类属性以及从 中返回的动态属性`__getattr__`，而`y.__dict__`仅包含作为实例属性的那些对象`y`。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-15T04:25:12.260

```
try:
    print myObject.myVar
except NameError:
    print "not defined" 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-15T04:30:09.643

Paolo 是对的，如果需要的话，你做事的方式可能有问题。但是，如果您只是在做一些快速而肮脏的事情，那么您可能并不关心[Idiomatic Python](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)，那么这可能会更短。

```
try: x
except: print "var doesn't exist" 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-04T08:43:24.860

要测试变量 myvar 是否已定义：

```
result = dir().count('myvar') 
```

如果定义了 myvar，则结果为`1`，否则为`0`。

这在 Python 3.1.2 版中运行良好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-08-28T11:18:43.833

在 python 中阅读和或技巧：locals() 中的 'a' 和 a

# sql-server - sql server 身份验证和 windows 身份验证有什么区别..？

> ID：750303
> 
> 赞同：44
> 
> 时间：2009-04-15T04:24:34.807
> 
> 标签：sql-server

sql server 认证和windows 认证有什么区别...有没有具体使用每个认证的情况？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-15T04:46:22.087

SQL Server 有自己的内置安全系统，涵盖登录名和角色。这与 Windows 用户和组是独立且平行的。您可以只使用 SQL 安全性，然后所有管理都将在 SQL Server 中进行，并且这些登录名和 Windows 用户之间没有任何联系。如果您使用混合模式，则 Windows 用户将被视为 SQL 登录。

每种方法都有许多特点 -

1) 如果你想使用连接池，你必须使用 SQL 登录，或者共享同一个 windows 用户——这不是一个好主意。

2) 如果您想跟踪特定用户在做什么，那么使用 Windows 身份验证是有意义的。

3）使用windows工具管理用户比SQL强大得多，但两者之间的联系很脆弱，例如如果你删除了一个windows用户，那么SQL中的相关数据就不会更新。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-08-27T07:35:44.513

**SQL 身份验证**

SQL身份验证是用于各种数据库系统的典型身份验证，由用户名和密码组成。显然，一个 SQL Server 实例可以有多个具有不同用户名和密码的此类用户帐户（使用 SQL 身份验证）。在不同用户应该有权访问不同数据库的共享服务器中，应该使用 SQL 身份验证。此外，当客户端（远程计算机）连接到运行客户端的计算机以外的其他计算机上的 SQL Server 实例时，需要 SQL Server 身份验证。即使您没有定义任何 SQL Server 用户帐户，在安装时也会使用您提供的密码添加一个 root 帐户 - sa。就像任何 SQL Server 帐户一样，这可用于本地或远程登录，但是如果应用程序是进行登录的应用程序，并且它应该只能访问一个数据库，强烈建议您不要使用 sa 帐户，而是创建一个具有有限访问权限的新帐户。总体而言，SQL 身份验证是要使用的主要身份验证方法，而我们在下面回顾的一种 - Windows 身份验证 - 更方便。

**Windows 身份验证**

当您从安装 SQL Server 的同一台计算机访问 SQL Server 时，不应提示您输入用户名和密码。如果您使用的是 Windows 身份验证，那么您不是。通过 Windows 身份验证，SQL Server 服务已经知道有人使用正确的凭据登录到操作系统，并使用这些凭据允许用户进入其数据库。当然，只要客户端与 SQL Server 驻留在同一台计算机上，或者只要连接的客户端与服务器的 Windows 凭据匹配，这就会起作用。Windows 身份验证通常用作登录到 SQL Server 实例而无需输入用户名和密码的更方便的方式，但是当涉及更多用户或正在与 SQL Server 建立远程连接时，

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T04:36:17.647

理想情况下，在 Intranet 类型的环境中工作时必须使用 Windows 身份验证。

而 SQL Server 身份验证可用于所有其他类型的情况。

这是一个可能有帮助的链接。

[Windows 身份验证与 SQL Server 身份验证](http://databases.about.com/od/sqlserver/a/authentication.htm)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-06-15T17:55:21.733

在授予用户访问数据库的权限时，需要考虑一些在可用性和安全性方面的优缺点。在这里，我们有两个选项用于对用户进行身份验证和授予权限。第一种是授予每个人 sa（系统管理员）帐户访问权限，然后通过保留可以根据需要授予或拒绝权限的用户列表手动限制权限。这也称为 SQL 身份验证方法。此方法存在重大安全漏洞，如下所示。第二个更好的选择是让 Active Directory (AD) 处理所有必要的身份验证和授权，也称为 Windows 身份验证。

使用 SQL 选项的主要安全问题是它违反了最小权限 (POLP) 原则，即只给用户他们需要的绝对必要的权限，而不是更多。通过使用 sa 帐户，您会出现严重的安全漏洞。违反 POLP 是因为当应用程序使用 sa 帐户时，它们可以访问整个数据库服务器。另一方面，Windows 身份验证遵循 POLP，仅授予对服务器上一个数据库的访问权限。

第二个问题是应用程序的每个实例都不需要拥有管理员密码。这意味着任何应用程序都是整个服务器的潜在攻击点。Windows 仅使用 Windows 凭据登录到 SQL Server。Windows 密码存储在存储库中，而不是 SQL 数据库实例本身，并且身份验证在 Windows 内部进行，而无需在应用程序上存储密码。

使用 SQL 方法产生的第三个安全问题涉及密码。如 Microsoft 网站和各种安全论坛上所述，SQL 方法不强制更改密码或加密，而是通过网络以明文形式发送。并且 SQL 方法在尝试失败后不会锁定，因此允许长时间尝试闯入。然而，Active Directory 使用 Kerberos 协议来加密密码，同时还采用密码更改系统并在尝试失败后锁定。

效率上也有缺点。由于您将要求用户每次想要访问数据库时都输入凭据，因此用户可能会忘记他们的凭据。

如果某个用户被删除，您将不得不从应用程序的每个实例中删除他的凭据。如果必须更新 sa 管理员密码，则必须更新 SQL 服务器的每个实例。这是耗时且不安全的，它留下了被解雇的用户保留对 SQL Server 的访问权限的可能性。使用 Windows 方法，这些问题都不会出现。一切都由 AD 集中和处理。

使用 SQL 方法的唯一优点在于它的灵活性。您可以从任何操作系统和网络访问它，甚至可以远程访问。一些较旧的遗留系统以及一些基于 Web 的应用程序可能只支持 sa 访问。

AD 方法还提供了节省时间的工具，例如组，以便更轻松地添加和删除用户，以及用户跟踪能力。

即使您设法纠正了 SQL 方法中的这些安全漏洞，您也将重新发明轮子。考虑到 Windows 身份验证提供的安全优势，包括密码策略和遵循 POLP，它是比 SQL 身份验证更好的选择。因此，强烈建议使用 Windows 身份验证选项。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-15T04:45:27.050

如果您希望针对 Windows 系统用户 [由管理员创建] 对用户进行身份验证，那么在这种情况下，您将在您的应用程序中进行 Windows 身份验证。

但是，如果您想根据应用程序数据库中可用的用户集对用户进行身份验证，那么在这种情况下，您将需要进行 SQL 身份验证。

确切地说，如果您的应用程序是 ASP.NET Web 应用程序，那么您可以使用依赖于 SqlMembershipProvider、SqlProfileProvider 等提供程序的标准登录控件。您可以配置您的登录控件和应用程序是否应该针对 Windows 用户或应用程序数据库用户进行身份验证。第一种情况称为 Windows 身份验证，后一种情况称为 Sql 身份验证。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-15T04:36:45.167

我不了解 SQLServer 以及其他 DBMS，但我认为其好处与 DB2 和 Oracle 相同。如果您使用 Windows 身份验证，您只需维护一组用户和/或密码，即 Windows 的用户和/或密码，这已经为您完成了。

DBMS 身份验证意味着拥有一组必须维护的单独用户和/或密码。

此外，Windows 密码允许为企业 (Active Directory) 集中配置它们，而 SQLServer 必须为每个 DBMS 实例维护一组。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T04:49:44.947

我认为主要区别在于安全性。

Windows 身份验证意味着身份作为 Windows 握手的一部分进行处理，现在密码永远“存在”以进行拦截。

SQL 身份验证意味着您必须自己存储（或提供）用户名和密码，使其更容易被破坏。为了使 Windows 身份验证非常健壮和安全，我们付出了很多努力。

我是否可以建议如果您确实实施 Windows 身份验证，请使用组和角色来执行此操作。Windows 中的组和 SQL 中的角色。当您只需设置组然后将每个用户添加到组中时，必须在 SQL 中设置大量用户是一件很痛苦的事情。（我认为无论如何都应该以这种方式完成大多数安全性）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-30T09:32:24.993

SQL Server 身份验证模式

SQL Server 2008 提供**两种身份验证模式选项**：

**Windows 身份验证**模式要求用户提供有效的 Windows 用户名和密码才能访问数据库服务器。在企业环境中，这些凭据通常是 Active Directory 域凭据。

**混合身份验证**模式允许使用 Windows 凭据，但使用管理员可以在 SQL Server 中创建和维护的本地 SQL Server 用户帐户对其进行补充。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-30T09:36:44.233

身份验证是确认用户或计算机身份的过程。该过程通常包括四个步骤： 用户通常通过提供用户名来声明身份。例如，我可能会通过告诉数据库我的用户名是“mchapple”来声明这一点。系统要求用户证明他或她的身份。最常见的挑战是要求输入密码。用户通过提供所请求的证明来响应挑战。在此示例中，我将向数据库提供我的密码 系统通过例如根据本地密码数据库检查密码或使用集中式身份验证服务器来验证用户是否提供了可接受的证明

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-20T21:07:49.153

在可能的情况下，Mssql 身份验证是非常可取的。它允许您与工作场所已经使用的现有 Windows 域保持一致，并且您不必知道用户的密码。

但是，似乎无法在服务器的机器**未**通过本地工作场所的 Intranet 进行身份验证的情况下使用。

如果您使用 sql 身份验证，安全性将完全取决于您。

如果您使用 microsoft 身份验证，则基本上会为您提供安全性，但您将处理额外的限制。

# ruby-on-rails - 您如何更改 Rails 应用程序数据？

> ID：750307
> 
> 赞同：12
> 
> 时间：2009-04-15T04:26:15.927
> 
> 标签：ruby-on-rails, ruby, activerecord, migration

我已经看到很多关于 ActiveRecord 迁移以及是否应该使用它们来更改应用程序中的数据的讨论，有些人说是，有些人说不。我的问题是，如果您不使用迁移来执行此操作，那么您使用的是什么？只是您编写的另一个脚本？

我正在寻求有关替代方法的建议，以及为什么它们可能比仅使用迁移更好。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-15T08:48:21.083

如果您使用提供的

```
rake db:reset 
```

和

```
rake db:schema:load 
```

任务，`schema.rb`用作设置数据库的基础。所以没有数据被加载，你被卡住了。

在[Agile Web Development with Rails, Third Edition](http://www.pragprog.com/titles/rails3/agile-web-development-with-rails-third-edition)中，你应该得到（如果 Ruby 书是“Pickaxe”书，这应该是“Hammock”书，顺便说一句？）如果你还没有这样做，DHH 说：

> ...迁移并不是真的要携带种子数据。它们本质上太短暂，无法可靠地做到这一点。迁移是为了将您从一个模式的版本带到下一个版本，而不是从头开始创建一个新的模式——我们为此提供了 db/schema.rb 文件。
> 
> 因此，一旦您真正开始使用真正的应用程序，人们在设置应用程序时就不会运行您的早期迁移。它们将从 db/schema.rb 中存储的任何版本开始，并忽略所有以前的迁移。这意味着迁移创建的任何数据都不会进入数据库，因此您不能依赖它。
> 
> 有许多替代方法可以获得更永久的种子数据。最简单的可能只是在 db/seed.rb 中创建一个新文件，其中包含那些将进行设置的 Product.create 调用。然后可以在 rake db:schema:load 创建初始模式后调用此文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T13:22:25.620

很多时候，迁移是最合适的，不能用单独的脚本代替。想象以下场景：应用程序已经在使用实时数据；code 列包含“name-zip_code”形式的代码（是的，我知道它很丑，但它确实发生了），并且您希望将其分成两列，“name”和“zip_code”，同时摆脱 '代码”栏。

```
 def self.up
  add_column :companies, :zip_code, :integer
  add_column :companies, :name, :string
  Company.reset_column_information
  Company.find(:all).each do |company|
    name, zip_code = company.code.split('-')
    company.update_attributes(:name => name, :zip_code => zip_code)  
  end
  remove_column :companies, :code
end 
```

在这种情况下，在将数据传输到名称和邮政编码列之前，无法删除代码列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:26:44.047

当我需要修改数据库中的一些数据时，我将创建一个运行一些库函数来完成工作的 Rake 任务。这样，数据操作将是可重复的，并且如果需要，也可以从迁移中运行。

# java - 如何打印单个 JPanel 的内容？

> ID：750310
> 
> 赞同：21
> 
> 时间：2009-04-15T04:27:09.510
> 
> 标签：java, swing, printing

我有一个`JPanel`带有两个带有图片的标签。我需要打印这些内容`JPanel`。请帮帮我。我怎样才能只打印 this`JPanel`的内容，因为我也有不同的组件，`JFrame`但我只需要打印**this** `JPanel`。

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-15T05:56:15.100

这是一个打印任何 Swing 组件的示例。

```
public void printComponenet(Component component){
  PrinterJob pj = PrinterJob.getPrinterJob();
  pj.setJobName(" Print Component ");

  pj.setPrintable (new Printable() {    
    public int print(Graphics pg, PageFormat pf, int pageNum){
      if (pageNum > 0){
      return Printable.NO_SUCH_PAGE;
      }

      Graphics2D g2 = (Graphics2D) pg;
      g2.translate(pf.getImageableX(), pf.getImageableY());
      component.paint(g2);
      return Printable.PAGE_EXISTS;
    }
  });
  if (pj.printDialog() == false)
  return;

  try {
        pj.print();
  } catch (PrinterException ex) {
        // handle exception
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T04:56:51.453

一种简单的方法是实现`Printable`接口 (in `java.awt.print`) 并添加指定的`print`方法（它的工作方式类似于`paint`— 在此处，您可以指定要在打印页面上绘制的组件）。当你想实际打印面板的内容时，获取一个`PrinterJob`实例并调用它的`setPrintable`方法，传递实现的对象`Printable`。

不过，这只是一个快速概述。我建议您查看[Sun 的打印教程以](http://java.sun.com/docs/books/tutorial/2d/printing/index.html)获取更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-21T10:40:59.187

只需编辑并输入框架名称、面板（jPanel1）和按钮（打印）。'this' 指的是 JFrame 类（即我的类扩展 javax.swing.JFrame ）只是把你的框架的引用而不是 'this'。

```
private void PritnActionPerformed(java.awt.event.ActionEvent evt) {
    // TODO add your handling code here:
    Toolkit tkp = jPanel1.getToolkit();
    PrintJob pjp = tkp.getPrintJob(this, null, null);
    Graphics g = pjp.getGraphics();
    jPanel1.print(g);
    g.dispose();
    pjp.end();
} 
```

# java - 用于泊松和均匀分布的 Java 生成器？

> ID：750325
> 
> 赞同：10
> 
> 时间：2009-04-15T04:37:19.847
> 
> 标签：java, distribution, generator, random, poisson

据我了解，标准生成器用于正态分布。我必须根据正态分布、均匀分布和泊松分布生成随机数，但我似乎找不到最后 2 个类。

我必须在 0 - 999999 的范围内生成它们。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-15T05:21:11.457

正如大卫所指出的，提供的伪随机数生成器使用均匀分布。

对于另外两个，我会使用[Cern Colt](http://acs.lbl.gov/~hoschek/colt/)库函数：

*   [泊松](http://dst.lbl.gov/ACSSoftware/colt/api/cern/jet/random/Poisson.html)
*   [正常/高斯](http://dst.lbl.gov/ACSSoftware/colt/api/cern/jet/random/Normal.html)

这些库函数很容易让您找到从每个分布中获取的随机数，而不是给您一个概率密度函数或累积密度函数并期望您自己推导出数字（这似乎是 Apache Commons-Math 方法）：

```
RandomEngine engine = new DRand();
Poisson poisson = new Poisson(lambda, engine);
int poissonObs = poisson.nextInt();

Normal normal = new Normal(mean, variance, engine);
double normalObs = normal.nextDouble(); 
```

此外，请记住，大 λ 的泊松分布 P(λ) 可以通过正态分布 N(λ, sqrt(λ)) 很好地近似。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T21:25:39.203

标准的 Java RNG ( [java.util.Random](http://java.sun.com/javase/6/docs/api/java/util/Random.html) ) 及其子类，例如[java.security.SecureRandom](http://java.sun.com/javase/6/docs/api/java/security/SecureRandom.html)，已经生成了均匀分布的值。

他们还有一个方法[nextGaussian](http://java.sun.com/javase/6/docs/api/java/util/Random.html#nextGaussian())，它返回正态分布的值。默认情况下，分布的均值为零，标准差为 1，但这只是微调。只需乘以所需的标准差并加上所需的平均值。因此，例如，如果您想要平均值为 6 且标准差为 2.5 的正态分布值，您可以这样做：

```
double value = rng.nextGaussian() * 2.5 + 6; 
```

泊松分布不受明确支持，但您可以通过与[Tom 的 Python 代码](https://stackoverflow.com/questions/750325/java-generator-for-poisson-and-uniform-distributions/750380#750380)相同的方法来伪造它。

或者，您可能对我的[Uncommons Math library](http://maths.uncommons.org)感兴趣，它为 Normal、Poisson 和其他分布提供实用程序类。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-15T04:59:13.210

实际上，[标准生成器](http://java.sun.com/javase/6/docs/api/java/util/Random.html)是为了均匀分布。任何语言/库中的基本随机数生成器将始终（在我知道的所有情况下）使用均匀分布，因为这是所有流行的伪随机数生成器算法的结果 - 基本上，均匀随机数是最简单的。

我看到 Eddie 已经向您指出了其他发行版的链接，所以我将跳过编写其余部分...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-15T05:08:07.183

让我以所有这些都不是真正随机的事实作为开头，我说的是伪随机数生成器。

我还要说，我从来没有为生产质量代码这样做过。不过，我已经在 Python 中为硬件分配做了这个。我模拟了泊松随机变量。

我这样做的方式利用了以下事实：

1.  泊松随机变量是指数随机变量的总和。
2.  我们可以使用逆变换方法来生成指数随机变量。[http://en.wikipedia.org/wiki/Inverse_transform_sampling](http://en.wikipedia.org/wiki/Inverse_transform_sampling)。

特别是，您可以使用以下事实：如果 X [1] , ..., X [n]是独立的*标准*指数随机变量，则 Z = min(k : X [1] + ... + X [k] < λ) - 1 是泊松(λ)。

因此，我在 python 中编写了以下代码来生成泊松值：

```
class Poisson:
    """Generate Poisson(lambda) values by using exponential
    random variables."""

    def __init__(self, lam):
        self.__lam = lam

    def nextPoisson(self):
        sum = 0
        n = -1
        while sum < self.__lam:
            n += 1
            sum -= math.log(random.random())
        return n 
```

该类的示例用法是：

```
# Generates a random value that is Poisson(lambda = 5) distributed
poisson = Poisson(5)
poisson_value = poisson.nextPoisson 
```

我在这里发布这个是因为很高兴知道存在这些类型的关系，并且这种逆变换方法为您提供了一种处理在特定连续分布之后生成随机值的通用方法。

# iphone - 使用 facebook connect for iPhone 上传照片的记录过程

> ID：750328
> 
> 赞同：1
> 
> 时间：2009-04-15T04:39:12.320
> 
> 标签：iphone, facebook

看了之后，我确实在 facebook 论坛上看到了这篇文章：

[关联](http://forum.developers.facebook.com/viewtopic.php?id=30467)

他们正在为 facebook 对象提供 UIImage。这似乎合乎逻辑，但这是在哪里记录的？API 文档适用于所有平台。iPhone 对参数及其数据类型的具体要求在哪里？

谢谢

*****更新***** 我仍然没有遇到任何与 Cocoa 相关的 API 文档。然而，我确实通过拼凑论坛信息、Facebook 示例代码和一些胶水来收集我需要的信息。

希望他们能在接下来的几个月里发布一些更具体的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-12-16T17:24:14.870

为了完整性：

下面解释了如何与 Facebook Connect 交互： [https ://developers.facebook.com/docs/guides/web/](https://developers.facebook.com/docs/guides/web/)

API 调用： [https ://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)

如果您需要扩展权限： [https ://developers.facebook.com/docs/guides/policy/examples_and_explanations/Extended_Permissions/](https://developers.facebook.com/docs/guides/policy/examples_and_explanations/Extended_Permissions/)

Mobile Orchard 上一个不错的 Obj-C 包装器： [http ://www.mobileorchard.com/marketing-in-code-part-2-setting-a-users-status-in-facebook-from-an-iphone-app-一个教程/](http://www.mobileorchard.com/marketing-in-code-part-2-setting-a-users-status-in-facebook-from-an-iphone-app-a-tutorial/)

以下是我对 SessionViewController 的实现：

```
#import "SessionViewController.h"
#import "FBConnect.h"
#import "FBFeedDialog.h"

///////////////////////////////////////////////////////////////////////////////////////////////////
// This application will not work until you enter your Facebook application's API key here:

static NSString* kApiKey = @"XXXXXXXXXXXXXXXXXX";

// Enter either your API secret or a callback URL (as described in documentation):
static NSString* kApiSecret = @"XXXXXXXXXXXXXXXXXX"; // @"<YOUR SECRET KEY>";

///////////////////////////////////////////////////////////////////////////////////////////////////

@implementation SessionViewController

@synthesize label = _label;
@synthesize anImage;

- (void)done:(id)sender{

    [self dismissModalViewControllerAnimated:YES];

}

///////////////////////////////////////////////////////////////////////////////////////////////////
// NSObject

- (id)init {
    if (self = [super init]) {
        _session = [[FBSession sessionForApplication:kApiKey secret:kApiSecret delegate:self] retain];
    }
    return self;
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
  if (self = [super initWithNibName:@"SessionViewController" bundle:nibBundleOrNil]) {
      _session = [[FBSession sessionForApplication:kApiKey secret:kApiSecret delegate:self] retain];

  }
  return self;
}

- (void)dealloc {
    [_session release];
    [anImage release];
    [super dealloc];
}

///////////////////////////////////////////////////////////////////////////////////////////////////
// UIViewController

- (void)viewDidLoad {
  [_session resume];
  _loginButton.style = FBLoginButtonStyleWide;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
  return NO;
}

///////////////////////////////////////////////////////////////////////////////////////////////////
// FBDialogDelegate

- (void)dialog:(FBDialog*)dialog didFailWithError:(NSError*)error {
  _label.text = [NSString stringWithFormat:@"Error(%d) %@", error.code,
    error.localizedDescription];
}

///////////////////////////////////////////////////////////////////////////////////////////////////
// FBSessionDelegate

- (void)session:(FBSession*)session didLogin:(FBUID)uid {
  _permissionButton.hidden = NO;
  _feedButton.hidden = NO;

  NSString* fql = [NSString stringWithFormat:
    @"select uid,name from user where uid == %lld", session.uid];

  NSDictionary* params = [NSDictionary dictionaryWithObject:fql forKey:@"query"];
  [[FBRequest requestWithDelegate:self] call:@"facebook.fql.query" params:params];
}

- (void)sessionDidLogout:(FBSession*)session {
  _label.text = @"";
  _permissionButton.hidden = YES;
  _feedButton.hidden = YES;
}

///////////////////////////////////////////////////////////////////////////////////////////////////
// FBRequestDelegate

- (void)request:(FBRequest*)request didLoad:(id)result {

    if([result isKindOfClass:[NSArray class]]){
        NSArray* users = result;
        NSDictionary* user = [users objectAtIndex:0];
        NSString* name = [user objectForKey:@"name"];
        _label.text = [NSString stringWithFormat:@"Logged in as %@", name];
    }  

}

- (void)request:(FBRequest*)request didFailWithError:(NSError*)error {
  _label.text = [NSString stringWithFormat:@"Error(%d) %@", error.code,
    error.localizedDescription];
}

///////////////////////////////////////////////////////////////////////////////////////////////////

- (IBAction)askPermissionForPhotoUpload:(id)target {
    FBPermissionDialog* dialog = [[[FBPermissionDialog alloc] init] autorelease];
    dialog.delegate = self;
    dialog.permission = @"photo_upload";
    [dialog show];
}
- (IBAction)publishPhoto:(id)target{

    NSMutableDictionary *args = [[[NSMutableDictionary alloc] init] autorelease];
    [args setObject:self.anImage forKey:@"image"];  
    FBRequest *uploadPhotoRequest = [FBRequest requestWithDelegate:self];
    [uploadPhotoRequest call:@"photos.upload" params:args];
}

- (void)askPermission:(id)target {
  FBPermissionDialog* dialog = [[[FBPermissionDialog alloc] init] autorelease];
  dialog.delegate = self;
  dialog.permission = @"status_update";
  [dialog show];
}

- (void)publishFeed:(id)target {
  FBFeedDialog* dialog = [[[FBFeedDialog alloc] init] autorelease];
  dialog.delegate = self;
  dialog.templateBundleId = 9999999;
  dialog.templateData = @"{\"key1\": \"value1\"}";
  [dialog show];
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-28T12:41:55.133

照片上传的 Graph Api 文档如下..

[https://developers.facebook.com/blog/post/498/](https://developers.facebook.com/blog/post/498/)

[https://developers.facebook.com/docs/reference/api/photo/](https://developers.facebook.com/docs/reference/api/photo/)

您可以在此处查看如何在 iPhone 中执行此操作。

[http://www.raywenderlich.com/1626/how-to-post-to-a-users-wall-upload-photos-and-add-a-like-button-from-your-iphone-app](http://www.raywenderlich.com/1626/how-to-post-to-a-users-wall-upload-photos-and-add-a-like-button-from-your-iphone-app)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-15T06:51:49.117

Joe Hewitt（Facebook iPhone 应用程序的作者）发布了 Facebook 应用程序的大部分内容作为他的 Three20 框架。它托管在[github 上](http://github.com/joehewitt/three20/tree/master)。

# pdf - 通过xml打开pdf的特定页面

> ID：750329
> 
> 赞同：1
> 
> 时间：2009-04-15T04:39:15.893
> 
> 标签：pdf

我正在尝试通过 xml 打开一个 pdf。它工作正常。这是它的 xml 标记：

```
<indexdata><key name="analyst">
    <topic name="analyst" url="folderName/pdfDocs/analyst.pdf"/>
</key></indexdata> 
```

它运作良好。但现在我想使用 xml 打开这个“analist.pdf”的特定页面（比如第 6 页）。

谁能帮我实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T04:49:33.123

```
#page=4 should work.

<indexdata><key name="analyst">
        <topic name="analyst" url="folderName/pdfDocs/analyst.pdf#page=4"/>
</key></indexdata> 
```

[http://www.adobe.com/devnet/acrobat/pdfs/PDFOpenParameters.pdf](http://www.adobe.com/devnet/acrobat/pdfs/PDFOpenParameters.pdf)

# http-headers - HTTP 响应中标头的顺序是否重要？

> ID：750330
> 
> 赞同：67
> 
> 时间：2009-04-15T04:39:25.097
> 
> 标签：http-headers

标题的顺序是否有意义

```
A: 1
B: 2 
```

对比

```
B:2
A:1 
```

我试图弄清楚是否可以使用字典来存储标题列表，或者它是否需要是某种列表或有序字典。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-04-15T04:44:48.063

不，对于不同名称的标题无关紧要。请参阅[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616)，第 4.2 节：

> 接收具有不同字段名称的头字段的顺序并不重要。但是，“好习惯”是先发送通用头字段，然后是请求头或响应头字段，最后是实体头字段。

但是，对于具有相同名称的多个标头，它确实很重要：

> 当且仅当该头字段的整个字段值被定义为逗号分隔列表[即，#(values)] 时，具有相同字段名称的多个消息头字段可能出现在消息中。必须可以将多个头字段组合成一个“字段名称：字段值”对，而不改变消息的语义，方法是将每个后续字段值附加到第一个字段值，每个字段值用逗号分隔。因此，接收具有相同字段名称的头字段的顺序对组合字段值的解释很重要，因此代理不能在转发消息时更改这些字段值的顺序。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-15T04:45:02.433

标题的顺序应该无关紧要。可能有“较弱”的 HTTP 标准实现，其中排序确实很重要，但一般来说不应该。

这是一个描述 HTTP 标头的链接：

[http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T04:42:57.693

HTTP 标头彼此独立，您可以使用字典来存储它们而不必担心它们的顺序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-29T00:18:45.267

`set-cookie`为同一个 cookie 指定多次时也很重要：

```
"Set-Cookie: COOKIE1=VALUE1; ...
"Set-Cookie: COOKIE1=VALUE2; ... 
```

在这种情况下，`COOKIE1`将设置为`VALUE2`，并且如果顺序更改：

```
"Set-Cookie: COOKIE1=VALUE2; ...
"Set-Cookie: COOKIE1=VALUE1; ... 
```

`COOKIE1`将设置为`VALUE1`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-20T21:07:00.740

[RFC 7230，第 3.2.2 节：字段顺序](https://www.rfc-editor.org/rfc/rfc7230#section-3.2.2)专门解决了这个问题。这里的引用来自规范的那个部分，重点是我添加的：

> 接收**具有不同字段名称**的标头字段的顺序**并不重要**。

它继续通过关于性能的良好实践的注释来限定这一点：

> 但是，最好先发送包含控制数据的标头字段，例如请求的主机和响应的日期，以便实现可以尽早决定何时不处理消息。

在某些情况下，允许消息包含多个具有相同名称的标头字段。在这种情况下，顺序确实很重要。

> 接收者可以将多个具有相同字段名称的头字段组合成一个“字段名称：字段值”对，而不改变消息的语义，方法是将每个后续字段值按顺序附加到组合的字段值上，用 a 分隔逗号。因此，接收**具有相同字段名称**的标题字段的顺序对于组合字段值的解释很**重要。**

# c++ - STL 向量是 realloc 的更好版本吗？

> ID：750336
> 
> 赞同：7
> 
> 时间：2009-04-15T04:43:20.750
> 
> 标签：c++, stl, vector, realloc

我相信在 C++ 中，处理重新分配的更好方法是使用 STL 向量，因为它保证了连续的存储位置。

我有几个问题要了解其中的区别：

1.  在任何情况下我需要更喜欢[realloc](http://en.cppreference.com/w/cpp/memory/c/realloc)而不是 vector ？
2.  还有什么（除了 vector ）相当于C++中的[realloc吗？](http://en.cppreference.com/w/cpp/memory/c/realloc)

谢谢，

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T04:49:40.253

只有`vector`，它保证有连续的内存。不是其他人。

`realloc`是一个 C 内存管理函数。在 C++ 代码中不鼓励使用它。Stroustrup 告诉你原因：[为什么 C++ 没有 realloc() 的等价物？](http://www.stroustrup.com/bs_faq2.html#renew)

> 但是，realloc() 只能保证在 malloc()（和类似函数）分配的数组上工作，这些数组包含没有用户定义的复制构造函数的对象。另外，请记住，与天真的期望相反，realloc() 偶尔会复制其参数数组。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-15T06:05:12.287

C 函数集（malloc、calloc、realloc、free）是原始内存操作。他们将在内存中创建/修改/释放给定的缓冲区，但内存将没有类型，也不会调用构造函数。

C++ 没有*realloc的等价物，但只有通过使用**new/new[]*和*delete/delete[]*的 malloc/free 的类型安全等价物。C++ 版本将从系统获取内存*并*通过调用适当的构造函数对其进行初始化。使用*delete*将调用对象的析构函数，然后释放内存。C 和 C++ 版本不兼容，如果您使用*malloc*获取内存（即使您在接收到的内存上调用就地构造函数），您不能使用*delete/delete[]*释放它，因为它是未定义的行为。

在 C++ 中使用*realloc*可能是不安全的，因为它会按位将对象从一个内存区域复制到下一个内存区域。有时您的对象无法正确处理内存移动（假设您的对象既有属性又有对它的引用，在按位移动它之后，引用将指向旧位置而不是真实属性）。在*vector*内部，每当内存需要增长时，都会使用*new[]*获取新内存，然后使用适当的 C++ 操作在新位置复制（或构造复制）所有对象，然后再删除旧元素。

每当*向量*的大小增加（保留大小，未使用大小）时，它将创建一个完整的新内存区域并*移动*所有对象。另一方面，如果指针后面没有足够的连续空间来*增长*它，realloc 只会将内存块移动到另一个位置。*向量*不会减小大小。绝不。当您清除元素时，保留的内存仍然保留。

最后，即使对于 POD 类型（可以安全地使用类 C 结构移动） ， *vector*中的抽象级别也比 realloc 中的更高。*与向量*等效的是一个结构，它保存指向内存缓冲区的指针、使用的元素计数和保留的（缓冲区大小）以及处理根据需要获取更多内存并使用每个操作更新索引的函数集。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-15T04:47:16.203

realloc 也保证了连续内存，所以这不是不使用它的理由。

但是，我更喜欢在 C++ 中使用向量，因为它处于更高的抽象级别，因此它使代码更容易编写。

我认为在数组类型场景中使用 realloc（通过向量）的唯一可能原因是原始速度。它*可能*会更快。我强调“可能”这个词——*衡量，不要猜测！*

但是，您必须处理自己的重新分配，这需要更多的工作。如果我可以交付它并更快地获得报酬，我宁愿让代码运行得慢一点（当然，假设它仍然运行得足够快）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-15T13:16:51.407

std::vector 的主要好处之一是，当它在内部从自然增长中重新分配自身时，它会选择比当前大小大 2 倍的大小（通常 - 但总是一个常数乘数）。这意味着 push_back 已经摊销了 O(1) 成本。

Realloc 将让您更好地控制分配内存的方式，但强大的功能带来了巨大的责任。如果您所做的一切相当于 push_back，并且每次添加元素时都重新分配，那么每次添加到数组时都*可能*进行 O(N) 操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T05:23:25.710

我想这只是一个向量。

我还没有看到有人建议在 C++ 中使用 realloc。

# mysql - MySQL 加入不存在的地方

> ID：750343
> 
> 赞同：89
> 
> 时间：2009-04-15T04:45:32.743
> 
> 标签：mysql, join, not-exists

我有一个连接两个表的 MySQL 查询

*   选民
*   家庭

他们加入`voters.household_id`和`household.id`。

现在我需要做的是修改它，将选民表连接到名为消除的第三个表，以及`voter.id`和`elimination.voter_id`。然而，问题是我想排除在淘汰表中有相应记录的选民表中的任何记录。

我如何制作一个查询来做到这一点？

这是我当前的查询：

```
SELECT `voter`.`ID`, `voter`.`Last_Name`, `voter`.`First_Name`,
       `voter`.`Middle_Name`, `voter`.`Age`, `voter`.`Sex`,
       `voter`.`Party`, `voter`.`Demo`, `voter`.`PV`,
       `household`.`Address`, `household`.`City`, `household`.`Zip`
FROM (`voter`)
JOIN `household` ON `voter`.`House_ID`=`household`.`id`
WHERE `CT` = '5'
AND `Precnum` = 'CTY3'
AND  `Last_Name`  LIKE '%Cumbee%'
AND  `First_Name`  LIKE '%John%'
ORDER BY `Last_Name` ASC
LIMIT 30 
```

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2009-04-15T05:20:18.900

我可能会使用 a `LEFT JOIN`，即使没有匹配也会返回行，然后您可以通过检查`NULL`s 仅选择不匹配的行。

所以，像：

```
SELECT V.*
FROM voter V LEFT JOIN elimination E ON V.id = E.voter_id
WHERE E.voter_id IS NULL 
```

这比使用子查询效率高还是低取决于优化、索引、每个选民是否可能有多个淘汰等。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-08T16:49:01.897

我会使用“不存在的地方”——正如你在标题中所建议的那样：

```
SELECT `voter`.`ID`, `voter`.`Last_Name`, `voter`.`First_Name`,
       `voter`.`Middle_Name`, `voter`.`Age`, `voter`.`Sex`,
       `voter`.`Party`, `voter`.`Demo`, `voter`.`PV`,
       `household`.`Address`, `household`.`City`, `household`.`Zip`
FROM (`voter`)
JOIN `household` ON `voter`.`House_ID`=`household`.`id`
WHERE `CT` = '5'
AND `Precnum` = 'CTY3'
AND  `Last_Name`  LIKE '%Cumbee%'
AND  `First_Name`  LIKE '%John%'

AND NOT EXISTS (
  SELECT * FROM `elimination`
   WHERE `elimination`.`voter_id` = `voter`.`ID`
)

ORDER BY `Last_Name` ASC
LIMIT 30 
```

这可能比进行左连接稍微快一点（当然，取决于您的索引、表的基数等），并且几乎可以肯定比使用 IN 快得多**。**

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-04-07T14:54:32.603

有三种可能的方法来做到这一点。

1.  选项

    ```
    SELECT  lt.* FROM    table_left lt
    LEFT JOIN
        table_right rt
    ON      rt.value = lt.value
    WHERE   rt.value IS NULL 
    ```

2.  选项

    ```
    SELECT  lt.* FROM    table_left lt
    WHERE   lt.value NOT IN
    (
    SELECT  value
    FROM    table_right rt
    ) 
    ```

3.  选项

    ```
    SELECT  lt.* FROM    table_left lt
    WHERE   NOT EXISTS
    (
    SELECT  NULL
    FROM    table_right rt
    WHERE   rt.value = lt.value
    ) 
    ```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-06-30T23:58:11.577

警惕“左”连接 - 左连接本质上是外连接。不同的 RDBMS 查询解析器和优化器可能会非常不同地处理 OUTER JOINS。以 MySQL 的查询优化器如何解析 LEFT (OUTER) JOINS 为例，以及它们可以评估每次迭代的结果执行计划的差异：

[https://dev.mysql.com/doc/refman/8.0/en/outer-join-simplification.html](https://dev.mysql.com/doc/refman/8.0/en/outer-join-simplification.html)

LEFT JOINS 就其本质而言始终是非确定性的。IMO - 它们不应在生产代码中使用。

我更喜欢首先以更“老派”的方法编写 JOIN 类型语句，而忽略任何特定的 JOIN 声明。让 RDBMS 查询解析器完成其设计的工作 - 分析您的语句并根据对索引统计和数据模型设计的评估将其转换为最佳执行计划。也就是说，查询解析器/优化器的构建甚至会出错，相信我，我已经看到它发生过很多次了。总的来说，我觉得首先采用这种方法通常会提供足够的基线信息，以便在大多数情况下做出明智的进一步调整决策。

为了说明 - 使用此线程中的问题查询：

```
SELECT `voter`.`ID`, `voter`.`Last_Name`, `voter`.`First_Name`,
       `voter`.`Middle_Name`, `voter`.`Age`, `voter`.`Sex`,
       `voter`.`Party`, `voter`.`Demo`, `voter`.`PV`,
       `household`.`Address`, `household`.`City`, `household`.`Zip`
FROM (`voter`)
JOIN `household` ON `voter`.`House_ID`=`household`.`id`
WHERE `CT` = '5'
AND `Precnum` = 'CTY3'
AND  `Last_Name`  LIKE '%Cumbee%'
AND  `First_Name`  LIKE '%John%'

AND NOT EXISTS (
  SELECT * FROM `elimination`
   WHERE `elimination`.`voter_id` = `voter`.`ID`
)

ORDER BY `Last_Name` ASC
LIMIT 30 
```

考虑在没有上述显式 JOIN 和 NOT EXISTS 语句的情况下重写它（假设 WHERE 子句中的非完全限定字段属于选民表）：

```
SELECT v.`ID`, v.`Last_Name`, v.`First_Name`,
       v.`Middle_Name`, v.`Age`, v.`Sex`,
       v.`Party`, v.`Demo`, v.`PV`,
       h.`Address`, h.`City`, h.`Zip`
FROM `voter` v, `household` h, `elimination` e
WHERE v.`House_ID` = h.`id`
AND v.`ID` != e.`voter_id`
AND v.`CT` = '5'
AND v.`Precnum` = 'CTY3'
AND  v.`Last_Name`  LIKE '%Cumbee%'
AND  v.`First_Name`  LIKE '%John%'
ORDER BY v.`Last_Name` ASC
LIMIT 30; 
```

尝试在语法上以两种方式编写一些未来的 SQL 查询，比较它们的结果，看看你的想法。以我上面建议的风格编写 SQL 还带来了更多与 RDBMS 无关的额外好处。

干杯!

# php - Mac OS X - PHP 和 fastcgi 的套接字位置？

> ID：750357
> 
> 赞同：2
> 
> 时间：2009-04-15T04:54:51.550
> 
> 标签：php, fastcgi

我在 Mac OS X 10.5.6 上运行。我在 /usr/local/php 构建了 PHP 5.2.9 并启用了 fast_cgi。我也使用 lighttpd 作为我的服务器。我对 php fastcgi 套接字存在的位置感到困惑。我的 lighttpd 服务器设置是：

```
fastcgi.server = ( ".php" =>
    ( "localhost" =>
        (
            "socket" => "/var/run/lighttpd/php-fastcgi.socket",
            "bin-path" => "/usr/local/php/bin/php-cgi"
        )
    )
) 
```

它是我不确定的“socket”=>“/var/run/lighttpd/php-fastcgi.socket”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T05:21:34.793

在 OS X 中，套接字通常位于

```
/private/var/run/ 
```

但在您的情况下可能会有所不同。再次确定，打开终端并尝试

```
php -i 
```

它应该告诉你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T05:00:56.810

检查你的 PHP 信息——我假设套接字的位置会列在那里。

```
<?php phpinfo(); ?> 
```

# javascript - 使用 jQuery，如何实现“页面加载”动画？

> ID：750358
> 
> 赞同：48
> 
> 时间：2009-04-15T04:55:36.290
> 
> 标签：javascript, jquery

当我使用 jQuery 提交表单时，我想显示动画图像（`load.gif`或`progressbar.gif`等）几秒钟。

如何在 jQuery 中显示 GIF 图像？

# excel - Excel VBA - 基于一个单元格中的更改的多个单元格更新

> ID：750361
> 
> 赞同：0
> 
> 时间：2009-04-15T04:57:37.143
> 
> 标签：excel, vba

当另一个单元格发生变化时，我想在 Excel 中填充一系列单元格。

我有一个宏，它可以根据项目编号从另一个主工作簿 (WB2) 中检索客户详细信息。项目编号在 WB1 中作为列表。当用户从 WB1 中选择项目编号时，我需要用客户详细信息填充 H9:H15（在 WB1 中）范围内的单元格。我正在使用 worksheet_change 事件来触发它。

```
Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Address = "$A$15" Then
        Call modInvoiceFiller.FillCustomerDetails
    End If
End Sub 
```

使用此代码，不会发生更新。如果我手动运行该过程，它会填写所需的详细信息。有人可以帮忙吗？

问候，帕布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T05:04:52.197

这对我来说很好。您确定宏附加到正确的工作表而不是工作簿（或更糟糕的是，在模块中）？

一个简单的判断方法是将其更改为：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    MsgBox Target.Address
    If Target.Address = "$A$15" Then
        MsgBox "XX " & Target.Address
    End If
End Sub 
```

并确保在更改任何单元格时弹出一条消息（包括您应该在 if 语句中检查的值），并确保在更改单元格 A15 时收到两条消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T05:05:35.987

有几件事要检查：

*   您是否在包含项目编号的工作表上实施了 Worksheet_Change？
*   如果您删除您的 modInvoiceFiller.FillCustomerDetails 代码并将其替换为 msgbox 调用，代码会被执行吗？

# string - VBA - 解析电子邮件文本以访问 2000 类实例

> ID：750383
> 
> 赞同：1
> 
> 时间：2009-04-15T05:09:55.743
> 
> 标签：string, ms-access, vba

我现在正在为客户维护一个旧版 VBA/Access 2000 应用程序。他们有一位客户通过电子邮件发送订单，其中包含如下文本

```
Contact: Peggy Hill
Company: Arlen Residential Mortgage Finance Co
Address: 43456 South 18939 West, Suite 47995
City: Arlen City
ContactState: TX
ContactZip: 88888
Phone: 8019990000
Email: peggy.hill@arlenmortgage.com

DateOrdered: 4/6/09
DateDue: 4/15/09 
```

ETC...

该应用程序有一个具有所有属性的 VBA 类，但无法将数据解析为适当的字段。我的客户想要一个表单，他们可以将文本从电子邮件中粘贴到该表单中，让它解析到字段进行验证，然后写入数据库。

问题/事实：

1.  每个值都使用 'ValueName:' 标记
2.  根据电子邮件客户端如何处理字符串，每行末尾可能有也可能没有 CrLf。
3.  缺失值将只有标记，没有“”或空格。

我想创建一个`CreateOrder(OrderText As String)`从表单中读取文本的函数，但我不知道如何处理 VBA 中的解析。
我开始使用预先输入的标记创建一个二维数组，但这似乎很笨拙，因为我必须读取数组中的下一项来确定何时停止接受前一个标记的数据。

建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T05:52:04.033

这是相当简约的；请添加您自己的错误检查。需要添加对“Microsoft Scripting Runtime”的引用

```
Public Function Parse(msg As String) As Dictionary
   Dim i As Integer, pos As Integer
   Dim line As Variant
   Dim lines() As String
   Dim dict As New Dictionary

   lines = Split(msg, vbCrLf)
   For Each line In lines()
      pos = InStr(1, line, ":", vbTextCompare)
      If pos <> -1 Then
        dict.Add Trim$(Left$(line, pos - 1)), Trim$(Right$(line, Len(line) - pos))
      End If
   Next

   Rem: Access values like this (with null checks):
   Rem:    dict("Contact"), dict("Address")

   Set Parse = dict

End Function 
```

我通过创建一个带有文本框和按钮的简单表单来使用它，并将其添加到按钮单击事件中：

```
Private Sub Command2_Click()
    Dim dict As Dictionary

    Text0.SetFocus
    Set dict = Parse(Text0.text)

    Debug.Print dict("Contact"), dict("Address")

    Rem clear up when done
    Set dict = Nothing

End Sub 
```

# visual-c++ - 断言错误

> ID：750395
> 
> 赞同：2
> 
> 时间：2009-04-15T05:17:00.297
> 
> 标签：visual-c++

在 vc++6.0 MFC 应用程序项目中，我不会得到编译错误，但是当我运行项目时，我会得到错误

```
调试断言失败！
程序：project.exe
文件：winocc.cpp
线路：345

有关您的程序如何导致断言的信息
失败，请参阅有关断言的 Visual C++ 文档。

（按重试调试应用程序）
```

它是什么错误以及为什么会发生这种类型的错误，如何调试此错误，请帮助任何机构，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T05:19:35.110

您可能会发现 winocc.cpp 中的第 345 行有一个断言。查看该源文件以查看它正在检查的内容（您不应该做的事情），然后停止这样做 :-)

如果您没有源代码，则必须：

*   联系写它的人并找出断言是什么；或者
*   阅读 API 文档，看看你是否做错了什么。

断言是一种*运行时*检查，编码器使用它来确保遵循规则或在造成任何实际损害之前发现意外情况。像双向链表这样的事情变得损坏（例如，像 assert (x->next->prev != x) 这样的事情，如果节点 A 的前一个节点没有节点 A 作为下一个节点，它将断言一个问题）。

就像是：

```
Assert (p1 == NULL); 
```

（在我的神话语言中，以防我的 C 语法错误）如果 p1 等于 NULL，则函数开头将引发断言。

网络搜索在第 345 行出现以下内容（请参见[此处](http://www.codeguru.com/forum/archive/index.php/t-44226.html)）：

> 断言（m_pCtrlSite！= NULL）；// 不是 OLE 控件（至少现在还不是）。

并且您尝试动态创建许可的 ActiveX 控件这一事实似乎是一个问题。该链接还包含一个 KB 编号 Q151804，表示它是设计使然（这意味着 MS 可能不会修复它） - 您需要使用有效的许可证字符串创建控件。

我发现的另一条评论指出：

> 仅仅创建一个 ActiveX 控件的实例是不够的。ActiveX 控件必须先正确托管，然后才能使用。你的不是。例如，您需要将其放在对话框中并创建该对话框的实例。

如果没有看到您的其余代码，很难判断这是否是您的具体问题，但如果*您的*第 345 行是我认为的那一行，那是有道理的 - 它抱怨控制站点为 NULL（即，控制是未托管）。

最后要注意的一件事：

如果您的 ActiveX 控件*在*对话框中，您是否尝试在调用对话框*之前*`DoModal()`对控件执行某些操作？

控件只会在您调用后初始化，`DoModal()`因此在此之前您无法使用控件。您应该在对话框中执行此操作`OnInitDialog()`- 此时，控件应该已完全初始化，您可以使用它做您想做的事情。

如果您尝试使用对话框构造函数中的参数来操作控件，则需要将它们存储在**对话框**中的某个位置并将它们传输到`OnInitDialog()`.

这些信息主要是从[这里](http://p2p.wrox.com/visual-c/35071-debug-assertion-about-m_pctrlsite.html)收集的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T05:23:24.367

“assert(...)”应该通过在运行时检查某些条件来帮助您发现 C++ 程序中的错误。您的程序中可能有一些未正确配置的内容导致此失败。就像 Pax 说的，看看你是否可以打开 winocc.cpp 并查看第 345 行以查看“断言”正在检查什么，看看你是否能找出它失败的原因。

通常，当您进行生产构建时，您将“编译”所有断言，这样它们就不会导致您的应用程序崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T05:42:36.537

断言用于在运行时检查代码中的前置条件/​​后置条件和中间结果。

最有可能的是，您在不考虑所有先决条件的情况下调用了一个函数/方法，这在运行时被检测到。

在 VC 中，断言是在 Debug 目标上的二进制文件中引入的，而不是在 Release 目标上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T06:12:30.630

如果它不是您控制的 dll（有时供应商会在调试库中留下断言），您可以显示反汇编并将断言的内存位置（中断的位置）从 3 更改为 90。这将更改您的 __asm int 3 到 __noop。有利于清除您可以摆脱的中断——至少对于那个调试会话来说是这样。:)

# sql - Linq2sql 查找热门订阅者问题

> ID：750404
> 
> 赞同：1
> 
> 时间：2009-04-15T05:21:06.183
> 
> 标签：sql, linq, linq-to-sql, join

由于军事义务（阿富汗，预备役），我已经有一段时间没有编写任何代码了，我对 linq 2 sql 有一个问题（见鬼，我现在会作为一个存储过程来做......我真的我生锈了）。

我有一个提要名称表，这些提要在另一个表中有订阅者（外键关联和所有爵士乐）。查找前五个提要的 Linq 代码是什么？在sql中，我在想类似的东西

```
select top(5) from tblFeeds f
inner join tblSubscribers s 
on f.id = s.FeedId
order by descending 
```

上面的代码可能是完全错误的，但我希望你能收集到我的意图。我正在尝试在 Linq2Sql 类型的结构中执行此操作。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T06:09:11.107

```
var feeds = (
   from f in myContext.tblFeeds
   order by f.Subscribers.Count() descending
   select f
   ).Take(5); 
```

假设您想要基于订阅者数量的热门订阅源:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T05:29:07.787

查看`Take`和`Skip`函数。它们也将被翻译成 SQL :)

# c - 不兼容的指针类型错误 [C]

> ID：750408
> 
> 赞同：2
> 
> 时间：2009-04-15T05:21:54.573
> 
> 标签：c, pointers, compiler-construction, types, arguments

我一直被告知在这行代码中从不兼容的指针类型传递参数。
这是代码行：

```
if (linear_search (size_of_A, argv[i])) 
```

这是什么意思，我该如何解决？这是整个程序：

```
int linear_search ( int size_of_A, char*argv[]){  
   int i;  
   i = 2;  
   while (i <= size_of_A - 1){  
      if (!strcmp (argv [1], argv[i])){  
      return 1;  
      }  
   }  
   return 0;  
}  

int main (int argc, char*argv []){  
   int size_of_A = argc - 2;  
   int i = 2;  
      if (linear_search (size_of_A, argv)){  
         printf ("%s not found\n", argv [1]);  
         return 1;  
      } else{  
         printf ("%s found\n", argv[1]);  
         return 0;  
      }  
      i = i + 1;  
   }  
} 
```

好的，这修复了警告，但是现在当我通过编译器运行程序时，什么也没有发生。它应该告诉我第一个参数是否重复。
例如，输出将如下所示：

```
./a 3 hso 8 3  
3 found 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T05:25:54.923

linear_search 需要一个数据类型“ `char **`”。您正在传递`argv[i]`，这只是一个`char*`. 尝试像这样传递“argv”：

```
if (linear_search(size_of_A, argv)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T05:41:58.597

你有一个逻辑错误`linear_search`。您有一个基于 的值的 while 循环`i`，但`i`永远不会改变。您可能缺少`i++;`说明。

另外（尽管这不会改变程序的行为）：变量`i`in`main`从未真正使用过。您可以删除它和`i = i + 1;`说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T05:25:54.860

您正在将参数（第二个）传递给与参数`linear_search`的预期类型不匹配的函数。argv[i] 的类型`char *`是 ，通常称为字符串，而`linear_search`函数 expects`char * []`是字符串数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T05:46:54.077

您的线性搜索函数仅将 argv[1] 与 argv[2] 进行比较，因为*i*永远不会增加。一个可能的解决方案（使用 for 循环而不是更常见的 while）是：

```
int linear_search ( int size_of_A, char*argv[]){  
   int i = 0;  // should always initialize in construction
   for ( i = 2; i < size_of_A; ++i ) {
      if (!strcmp (argv [1], argv[i])){  
        return 1;  
      }  
   }  
   return 0;  
} 
```

变量*i*从未真正在 main 中使用，您可以安全地删除处理它的两行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T18:42:35.647

**oldfart：**当心`strcmp`所有无限的字符串函数（如 strcpy——但要小心 strncpy：它不会添加尾随 NULL）。

**youngun：** 但没关系，因为`argv`有一堆以 NULL 结尾的字符串！

**of：**这种思维方式导致了缓冲区溢出的大量帮助。 `argv`用 NULLS 初始化。但从那以后它可能已经改变了。

**y：**但这是一个小程序，它永远不会发生。

**的：**当然。程序会增长，并且“从未”发生的频率比您想象的要多。

**y：**好的，偏执狂先生，我应该用多大的尺寸来限制我的`strncmp`？没有明显的数字可以使用！你是在建议我编造一些东西吗？

**of：**参见limits.h，尤其`ARG_MAX`是`_POSIX_ARG_MAX`可能的最大值。如果您愿意，可以使用较小的值。如果您这样做，请**记录下来**。

**y：**所以我应该写`strncmp( arg, target, 5000 )`？好吧，偏执狂先生。

**作者：**不要那样做！ `#define APP_MAX_ARG 5000`然后使用`strncmp( arg, target, APP_MAX_ARG )`. 不要让我开始使用魔术数字。现在的孩子。

**作者：**嘿，孩子，*离开我的草坪*。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T13:47:29.820

这似乎是使用以下事实的好地方`argv `is `NULL`-terminated. You don't need to pass the count of items in it, but just do like this:``

 `````
/* Searches through the NULL-aterminated array for the.
 * given needle string. Returns 1 if found, 0 if not.
*/
int linear_search (char **argv, const char *needle)
{
  int i;

  for(i = 0; argv[i] != NULL; i++)
  {
     if(strcmp(argv[i], needle) == 0)
       return 1;
  }
  return 0;
} 
````` 

``Btw, I recommend comparing the return value of strcmp()` nagainst literal 0, rather than using the ! notation, since the return value is in fact not boolean; it returns a int`表示比较元素之间的关系。

我实现了使用！这里很常见，几乎是惯用的，因为许多人认为 C 必须始终尽可能简洁，但是......我仍然建议不要这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T05:26:53.097

您的函数需要 a `char*[]`（在这种情况下应该等效于`char**`）。但是，通过调用它

```
linear_search (size_of_A, argv[i]) 
```

你只是传递一个`char*`as 参数（因为`[i]`取消引用一个指针）。根据我在您的代码中看到的内容，您可以尝试使用

```
linear_search (size_of_A, argv+i) 
```

但我不太确定这是否会产生预期的行为。理解 C 还为时过早 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T05:28:50.970

我不知道您的程序的逻辑，但编译器错误已解决。看到这个：

int main (int argc, char*argv []){

```
int size_of_A = argc - 2;  
int i = 2;  
if (linear_search (size_of_A, argv[])){  
     printf ("%s not found\n", argv [1]);  
     return 1;  
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T05:31:03.523

```
int linear_search ( int size_of_A, char*argv[]){ 
```

`char*argv[]`表示“指向字符数组的指针”；作为函数调用参数，与`char**`.

argv*是*a `char**`，但是`argv[i]`是 a `char*`，因为 C 定义`argv[i]`为`*(argv + i )`or，用英文“dereference (argv plus i)”定义。取消引用 a会给`char**`您留下 a `char*`，而这不是`linear_search`声明要采用的。

[如果您仍然感到困惑，](https://stackoverflow.com/questions/750091/pointer-to-an-array-of-structs-and-getting-memory-c/750108#750108)请看这里。
`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T05:33:35.623

您的 linear_search() 接受“字符串数组”（指向字符数组的指针），而您将其传递给“字符串”（argv [i]）。我认为您想要做的是将 linear_search 称为：

```
if (linear_search (size_of_A, (argv + i))) 
```

虽然我不完全理解你程序的逻辑......你是否试图在后面的参数中搜索 argv[1] ......？

# ruby-on-rails - 将 Rails 中的主键更改为字符串

> ID：750413
> 
> 赞同：27
> 
> 时间：2009-04-15T05:25:15.643
> 
> 标签：ruby-on-rails, ruby, activerecord

所以我有两个模型，State 和 Acquisition。状态 has_many 收购。我觉得 51 条记录的自动递增整数主键相当愚蠢。所以我将 State 的模型更改为 PK（State 是两个字母的缩写；我没有将实际的状态名称存储在任何地方：

```
class State < ActiveRecord::Base  
  self.primary_key = "state"  
  has_many :acquisition_histories  
end 
```

问题是当我创建我的 Acquisition 模型时，它将外键列 state_id 创建为整数。更具体地说，脚本/生成的迁移做了：

```
class CreateAcquisitions < ActiveRecord::Migration  
  def self.up  
    create_table :acquisitions do |t|  
      t.date :date  
      t.string :category  
      t.text :notes  
      t.references :state  
      t.timestamps  
    end
  end
end 
```

我假设 t.references 数据类型将其设置为 int。问题是我的 Acquisition 类上的 create 方法试图将 state 缩写放入 table 收购的 state_id 字段中（是的，它在数据库上称为 state_id，即使它在迁移脚本中显示 :state ）。该方法没有失败，但它确实在 state_id 字段中输入了一个 0，并且记录进入了以太。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2011-07-16T02:30:11.957

不过，我同意这可能比考虑在其他地方反对默认设置的额外努力[更麻烦，以防万一你](https://stackoverflow.com/questions/1200568/using-rails-how-can-i-set-my-primary-key-to-not-be-an-integer-typed-column)*真的*想做你所要求的：

创建状态迁移：

```
class CreateStatesTable < ActiveRecord::Migration  
  def change
    create_table :states, id: false do |t|
      t.string :state, limit: 2
      t.string :name
      t.index :state, unique: true
    end
  end
end 
```

状态模型：

```
class State < ActiveRecord::Base
  self.primary_key = :state
end 
```

请注意，在 Rails 3.2 之前，这`set_primary_key = :state`不是`self.primary_key=`参见： http: [//guides.rubyonrails.org/3_2_release_notes.html#active-record-deprecations](http://guides.rubyonrails.org/3_2_release_notes.html#active-record-deprecations)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-04-04T06:54:27.157

如果你发现自己在这里......尽快离开并转到： [使用 Rails，我如何将主键设置为不是整数类型的列？](https://stackoverflow.com/questions/1200568/using-rails-how-can-i-set-my-primary-key-to-not-be-an-integer-typed-column)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-01-04T00:25:23.930

在 Rails 5.1 中，您可以在创建时指定主键的类型：

```
create_table :states, id: :string do |t|
# ...
end 
```

从[文档中](http://api.rubyonrails.org/v5.1/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-create_table)：

> Symbol 可用于指定生成的主键列的类型。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-15T13:28:05.157

我正在开发一个使用 UUID 作为主键的项目，老实说，我不推荐它，除非你确定你绝对需要它。有很多 Rails 插件在未经修改的情况下无法与使用字符串作为主键的数据库一起使用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-27T21:49:27.047

**请注意，[mkirk 的回答](https://stackoverflow.com/a/6714889/72321)创建了一个假主键**。这就解释了为什么 ActiveRecord 需要被告知主键是什么。检查表显示

```
 Table "public.acquisitions"
 Column |         Type         | Modifiers
--------+----------------------+-----------
 state  | character varying(2) |
 name   | character varying    |
Indexes:
    "index_acquisitions_on_state" UNIQUE, btree (state) 
```

在实践中，这按预期工作，所以没有错，但它可能会更好。

* * *

我们可以保留该`id`列并将其类型更改为`string`*。迁移看起来像

```
class CreateAcquisitionsTable < ActiveRecord::Migration  
  def change
    create_table :acquisitions do |t|
      t.string :name
    end
    change_column :acquisitions, :id, :string, limit: 2
  end
end 
```

检查表会发现您有一个实际的主键，其中包含所有优点，例如唯一键约束（不需要唯一索引）、非空约束和自动递增键。

```
 Table "public.acquisitions"
 Column |         Type         |                     Modifiers
--------+----------------------+---------------------------------------------------
 id     | character varying(2) | not null default nextval('acquisitions_id_seq'::regclass)
 name   | character varying    |
Indexes:
    "acquisitions_pkey" PRIMARY KEY, btree (id) 
```

*而且*你不需要明确告诉 ActiveRecord 什么是主要的。

如果没有提供，您将需要考虑设置默认 id。

```
class MyModel < ActiveRecord::Base
  before_create do
    self.id = SecureRandom.uuid unless self.id
  end
end 
```

^(* 免责声明：除非您有充分的理由，否则不应更改默认主键)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T07:36:32.770

您想遵循 Rails 约定。额外的主键无论如何都不是问题。就用它吧。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T11:31:21.427

我对用作主键的字符串有一些经验，这对 *** 来说很痛苦。请记住，默认情况下，如果您想传递具有默认 :controller/:action/:id 模式的对象，则 :id 将是一个字符串，如果某些 id 格式奇怪，这可能会导致路由问题；）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-06T20:23:38.193

```
class CreateAcquisitions < ActiveRecord::Migration  
    def self.up  
        create_table :acquisitions, :id => false do |t|  
          t.date :date  
          t.string :category  
          t.text :notes  
          t.references :state  
          t.timestamps
        end
    end
end 
```

* * *

## 回答 #9

> 赞同：-28
> 
> 时间：2009-04-15T06:51:08.777

当您不反对默认设置时，Rails 工作得最好。在你的状态表上有一个整数主键有什么害处？

除非你受困于无法控制的遗留模式，否则我建议你坚持 Rails 的默认设置——约定优于配置，对吧？——并专注于应用程序的重要部分，例如 UI 和业务逻辑。

# visual-studio-2008 - VS2008 Pro Edition 90天试用的问题

> ID：750419
> 
> 赞同：1
> 
> 时间：2009-04-15T05:26:49.260
> 
> 标签：visual-studio-2008, windows-vista, installation

我有两台电脑。一台电脑是旧的 XP，另一台是新的 Vista。我已经下载并几乎测试了 VS2008ProEdition90dayTrialENUX1435622.iso 的安装，在 XP 计算机上没有任何问题。Vista 计算机（我需要在其中完成工作以及拥有所有硬盘空间等）非常多事——以一种糟糕的方式。似乎iso文件本身没有正确下载。所以我做了几次。当我运行安装程序时，它在第一步进行了某种文件提取（我记得有 71 个文件），它似乎死在同一个文件上。我的 Vista 电脑有一个全新的操作系统和一个全新的硬盘。我不明白为什么它给我带来这么多麻烦。最终，我使用 FTP 将 iso 文件连同从我的 XP 计算机中提取的所有文件一起传输到我的 Vista 计算机。然后我设法走得更远。但它仍然表现得很奇怪。我注意到的一件事是缺少许可协议。 ![替代文字](https://i67.photobucket.com/albums/h292/Athono/wtf.jpg) 这很奇怪。当我到达我应该开始安装的地步时，安装程​​序会亮起并显示错误。有这么多，我不知道从哪里开始。 ![替代文字](https://i67.photobucket.com/albums/h292/Athono/wtf2.jpg) 我从哪里开始？我尝试使用 DAEMON 工具集从虚拟驱动器运行 iso。这并没有什么不同。我试过以管理员身份运行。这并没有什么不同。我试过关闭所有程序，甚至卸载防病毒程序。这并没有什么不同。我使用 Windows DVD 刻录实用程序将文件刻录到 DVD 上并从那里运行。这并没有什么不同。

奇怪的事情还在继续。C:\Users...\AppData\Local\Temp\dd_error_vs_procore_90.txt 有错误消息显示从 F 驱动器复制时出现问题。好吧，我没有F盘。

到目前为止我什至已经创建了一个虚拟F驱动器，通过网络连接到自己指向的DVD驱动器。那也没有用。

有什么建议么？

是的，我已经向 Microsoft People 发布了这个问题。我在等一个答案。也许 StackOverflow 可以击败他们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T05:40:49.193

您可以尝试安装 MSI 4.5、.NET Framework 3.5 Service Pack 1，然后运行 ​​Visual Studio 2008 安装程序（以管理员身份） - 这样您将有机会获得更好的错误消息。

**编辑：**我正在使用[Virtual CloneDrive](http://www.slysoft.com/en/download.html)从 ISO 安装，到目前为止它工作得很好（在 windows xp 和 windows server 2003/2008 以及 Visual Studio 2008 试用版、Visual Studio 2008 SP1 和 MSDN 中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T05:43:06.927

有人看过微软对VS2008试用的要求吗？他们是：

*   具有 1.6 GHz 或更快处理器的计算机
*   384 MB RAM 或更多（Windows Vista 为 768 MB RAM 或更多）
*   2.2 GB 可用硬盘空间
*   5400转硬盘
*   1024 x 768 或更高分辨率的显示器
*   DVD-ROM 驱动器
*   附加功能可能需要访问 Internet。可能会收取费用。

“5400转硬盘”！不是“5400 RPM 或更快的硬盘”。这是否意味着我的 10K RPM grunters 无法工作？

无论如何，足够的咆哮。一些事情要尝试：

1/ 我不相信从 ISO 安装（您对 F 驱动器的评论指出 DAEMON 工具可能存在问题）。我也不相信微软刻录实用程序。尝试使用一个体面的程序进行刻录，看看是否有帮助。或者获取 7zip 并将所有文件从 ISO 解压缩到硬盘上的安装目录，然后从那里安装。

2/ 缺少许可证表明文件已损坏。这可能是下载的文件，也可能是您以 ASCII 模式通过 FTP 传输它的事实。

3/ 检查 ISO 的文件大小和 md5sum 与您在 XP 上成功安装的那个。

4/ 发布日志文件（或至少其中的错误），以便我们为您提供帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T06:09:27.347

好吧，我的电脑附带了一张 NERO 7 Essentials CD。我安装了这个产品，我注意到有一个选项可以“将现有图像刻录”到 cd 或 dvd 上。我这样做了。我运行新创建的 DVD，就好像它是一个新产品一样。

我第一个表明现在一切正常的迹象是产品许可证出现了。

现在整个安装运行顺利。

解决了

# java - SWT 中的 Java 编程

> ID：750434
> 
> 赞同：1
> 
> 时间：2009-04-15T05:36:39.767
> 
> 标签：java, swt

嗨..我在java中有这段代码......

```
import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.CTabFolder;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.events.SelectionAdapter;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.layout.FillLayout;
import org.eclipse.swt.layout.RowLayout;
import org.eclipse.swt.widgets.Button;
import org.eclipse.swt.widgets.Composite;
import org.eclipse.swt.widgets.Control;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Text;

public class testTabs {
    static int count;
    public static void main (String [] args) {
        Display display = new Display ();
        final Shell shell = new Shell(display);
        shell.setLayout(new FillLayout());
        shell.setText("SWT TabFolder Example");

        CTabFolder folder = new CTabFolder(shell,SWT.NONE);
        CTabItem item = new CTabItem(folder,SWT.UP);
        item.setText("First");

        CTabItem item1 = new CTabItem(folder,SWT.UP);
        item1.setText("First new");

//---------------------------------------------------   

        CTabFolder fold = new CTabFolder(folder,SWT.UP);
        CTabItem ite = new CTabItem(fold,SWT.UP);
        ite.setText("Second");
        final Composite test = new Composite(fold,SWT.NONE);
        test.setLayout(new RowLayout());
        Text tab1 = new Text(test,SWT.NONE);
        tab1.setText("Testing");
        tab1.setEditable(true);
        ite.setControl(test);
        item.setControl(fold);

        Button add = new Button(test,SWT.PUSH);
        add.setText("ADD");
        SelectionAdapter adap = new SelectionAdapter(){
            public void widgetSelected(SelectionEvent e){
                Composite newcomp = new Composite(test,SWT.BORDER_DASH);
                Text testtext = new Text(newcomp,SWT.BORDER_SOLID);
                testtext.setText("Inside new Comp");
                count++;
                System.out.println(count);
                Control array[] = shell.getChildren();
                System.out.println(array.length);
                shell.pack();
            }
        };

        add.addSelectionListener(adap);
        shell.open();
        while(!shell.isDisposed()){
            if(!display.readAndDispatch()){
                display.sleep();
            }
        }

    }
} 
```

当我运行它时，复合“newcomp”不可见..有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T06:24:34.220

如果我修改您的代码以仅添加一个布局，那么它可以工作：

```
public void widgetSelected(SelectionEvent e) {
    Composite newcomp = new Composite(test,SWT.BORDER_DASH);
    newcomp.setLayout(new RowLayout());
    .... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-02T13:17:00.633

尝试`test.layout()`在方法结束时使用`widgetSelected`。

让我们知道它是否有效。

# php - 推荐具有付费/高级内容支持的 PHP/MySQL CMS

> ID：750441
> 
> 赞同：1
> 
> 时间：2009-04-15T05:40:16.293
> 
> 标签：php, wordpress, drupal, content-management-system, expressionengine

我正在寻找一些解决方案来构建一个混合了免费和付费/高级内容的网站（不，它不是色情）。

我收集到 Drupal 有支持这个的高级插件。我也在看 Expression Engine，它似乎有一些内置的支持，尽管 Paypal 是唯一的支付选项。

我正在查看 aMember ( [http://www.amember.com/](http://www.amember.com/) )，它似乎是一个支持此功能的用户角色包，支持多种支付方式，并且具有与 Expression Engine 和 Wordpress 相关的插件。

坦率地说，我发现使用 Drupal 非常令人沮丧，所以我倾向于使用 EE 或 Worpress + aMember。我错过了任何其他好的选择吗？任何人都有使用这些软件包的经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T07:06:24.853

Expression Engine 很棒，在他们的论坛上有大量的支持。我敢肯定，有人已经找到了一种不仅仅使用贝宝的方法，只需在那里的论坛上询问，看看他们怎么说。但我推荐EE

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T06:00:51.690

Joomla 一直是此类网站的良好 CMS，我们可以看到社交网络、电子商务、订阅网站、新闻网站等

或者数据生命引擎 (DLE) 可能适合您（不是免费的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T01:13:50.540

在这里为 EE 投第二票！最初的学习曲线感觉有点陡峭，但它通过极其简单直观的模板系统弥补了这一点。但是，是的，一定要查看论坛和 EE wiki，看看还有哪些其他电子商务和支付处理程序插件/模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-28T20:57:05.880

绝对是这里给 EE 的一票。如果您稍微深入研究一下系统，您会发现会员功能允许在多个级别的用户之间使用广泛的功能。可以为不同的组用户分配不同级别的查看权限，甚至发布内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-18T07:00:07.403

好吧，如果你使用 WordPress，你可以有很多选择，但我认为 wordpress 最好的会员插件是[CMS Members](http://wpwave.com/plugins/cms-members/)。

# php - 州和国家选择框 - 最好的方法是什么？

> ID：750446
> 
> 赞同：1
> 
> 时间：2009-04-15T05:42:23.543
> 
> 标签：php, jquery, select, combobox, countries

这可能看起来微不足道，但我在我正在构建的个人资料表单页面上设置了一个国家和州选择框，这样当您选择美国或加拿大时，州框将显示所选国家的州，否则它会改为显示无适用。我的国家和州在数据库中，我正在从中填充我的选择 - 我想要一种简单而正确的方法来做到这一点 - 我注意到由于某种原因，所有浏览器都不支持禁用选择选项:( - 或者是有任何不错的在线免费片段我可以使用[也许我懒得在这里编码]

我在这里使用 JQuery 进行 javascripting。

* * *

已编辑

感谢您的回复-级联下拉菜单似乎可以满足我的需求，但我正在寻找基于 php 的解决方案。

主流网站是如何做到这一点的。因为我不想把它留给用户并以包括美国/加拿大州和非美国/加拿大国家的条目结束。

* * *

Ajax 的想法是我的想法，但问题是我正在构建的应用程序表单有一个部分，您可以在其中添加联系地址。它的构建使您可以将多个地址添加到同一个联系人。有一个添加按钮，它只是使用 javascript 函数复制地址输入，所以基本上当您提交表单时，您有如下数据：

_POST['address[]'], _POST['city[]'], _POST['state[]'],_POST['country[]']

事情是在创建时将此操作绑定到州和国家/地区的每个实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T05:51:23.100

将 onchanged 处理程序附加到 c]Country 下拉列表。在处理程序中，使用 Ajax 检索所选国家/地区的州/省列表，使用该列表填充州/省下拉列表并启用州/省下拉列表。

在静态 HTML 中，禁用州/省下拉菜单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T06:22:24.850

如果美国和加拿大都没有从国家选择器中选择，我想我什至不会显示州选择器。这种方法有两个优点，来自所有其他国家的用户不会被无意义的内容所困扰，您不必处理不需要的输入。

现在，我将通过 AJAX 保存国家/地区选择器的值，然后根据需要发送/激活带有响应的附加选择器 div。

编辑后：那你有多灵活？如果您被一些现有代码卡住，那么消除不必要的状态条目的 cron 作业可能是另一种方式。

我的意思是你也可以稍后在检索时处理状态，但我假设还有预先存在的代码创建地址，并且该代码不会检查状态是否有意义......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T05:58:15.657

看看[CascadingDropdown](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/CascadingDropDown/CascadingDropDown.aspx) Extender 是否可以满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T06:05:40.820

我在 ASP.NET 中执行此操作的方式是为国家下拉列表使用缓存的用户控件。此下拉列表附加了一个RequiredFieldValidator，初始值设置为“选择一个”。国家下拉列表可以包含在同一个用户控件中，并且可以基于基于国家下拉列表选择的 AJAX 请求来填充。（正如@tpdi 在他的回答中提到的）

# xml - 使用 PowerShell 将 xml 从 UTF-16 转换为 UTF-8

> ID：750449
> 
> 赞同：19
> 
> 时间：2009-04-15T05:45:07.047
> 
> 标签：xml, powershell, utf-8, utf-16

将 XML 从 UTF16 转换为 UTF8 编码文件的最简单方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-15T05:49:54.553

这可能不是最理想的，但它确实有效。只需加载 xml 并将其推回文件。但是xml标题丢失了，所以必须重新添加。

```
$files = get-ChildItem "*.xml"
foreach ( $file in $files )
{
    [System.Xml.XmlDocument]$doc = new-object System.Xml.XmlDocument;
    $doc.set_PreserveWhiteSpace( $true );
    $doc.Load( $file );

    $root = $doc.get_DocumentElement();
    $xml = $root.get_outerXml();
    $xml = '<?xml version="1.0" encoding="utf-8"?>' + $xml

    $newFile = $file.Name + ".new"
    Set-Content -Encoding UTF8 $newFile $xml;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-01-27T14:37:47.657

好吧，我想最简单的方法是不关心文件是否是 XML 并简单地转换：

```
Get-Content file.foo -Encoding Unicode | Set-Content -Encoding UTF8 newfile.foo 
```

这仅适用于 XML 时没有

```
<?xml version="1.0" encoding="UTF-16"?> 
```

线。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-07T13:37:52.550

尝试使用以下解决方案`XmlWriter`：

```
$encoding="UTF-8" # most encoding should work
$files = get-ChildItem "*.xml"
foreach ( $file in $files )
{
    [xml] $xmlDoc = get-content $file
    $xmlDoc.xml = $($xmlDoc.CreateXmlDeclaration("1.0",$encoding,"")).Value
    $xmlDoc.save($file.FullName)      
} 
```

您可能想查看`XMLDocument`更多关于`CreateXmlDeclaration`.

# silverlight - 为什么 Flash/Silverlight/Whatever 中没有所见即所得的富文本编辑器？

> ID：750456
> 
> 赞同：8
> 
> 时间：2009-04-15T05:52:01.197
> 
> 标签：silverlight, flash, wysiwyg, richtext

或者有吗？

从桌面软件开发人员的角度来看（可能与 Web 开发人员相反），富 Web 应用程序平台，例如 Flash 或 Silverlight，看起来是为 Web 进行所见即所得文本编辑器的更好工具。它们能够进行更复杂的输入/输出、数据表示等，并且它们在浏览器和平台上是一致的（好吧，也许还不是 Silverlight 和 Moonlight，但至少 Flash 似乎是）。

尽管如此，开发人员更喜欢使用 Javascript/DOM/HTML/CSS 以及它们所有的不兼容、差异、努力工作以解决每一个特定的怪癖并使用大量的 hack 来使这些技术做他们可能原本不应该做的事情能够做到。

有一些普遍接受的论点为什么不应该将 Flash 用于网站，还有一个普遍接受的例外：嵌入式视频播放器。富文本编辑器有何不同？“Flash 控件存在于其隔离的沙箱中”——WYSIWYG 编辑器普遍如此；“搜索引擎无法索引 Flash 控件的文本”——无论如何，谁关心索引编辑器中不断变化的未保存内容；“并非所有用户都可能安装了 Flash”——因此也不是所有用户都启用了 Javascript。

所以，问题来了：选择 Javascript 而不是 Flash 来实现 WYSIWYG 编辑器的优势是什么？选择其他方式会有什么缺点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-18T06:28:21.830

主要原因（我认为）是使用 JavaScript（设计模式）在浏览器中进行富 HTML 编辑的现成基础。这是由微软在 IE 5.5 中启动的（据我所知），然后被 Mozilla/Firefox、Opera 和 Safari 采用。浏览器将负责保存 HTML DOM 树，允许您导航和修改它等。您可以在几乎没有 javascript 代码的浏览器中创建一个基本的（并且完全延迟但仍然）HTML 所见即所得。然后您可以在此基础上构建功能（大多数现代 javascript 所见即所得所做的）。

在 Flash/Silverlight 中，开发人员必须从头开始并实现所有这些东西。在这方面很难与 Microsoft/Mozilla/Opera/etc 的团队竞争。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T06:17:41.400

与 Flash 相比，JavaScript 实现的 RTE 编辑器的主要优点是：

*   您不需要使用 Flash 播放器
*   大多数人没有关闭 JavaScript
*   他们通常更富有并且有更好的能力
*   可以提供嵌入式表格、图像和视频等附加功能
*   它们生成可用作 Web 内容的 HTML 输出

您想自己构建这个编辑器吗？因为一般来说，当今 javascript 中所见即所得编辑器可用的选择非常好。检查例如：[fckeditor](http://www.fckeditor.net/)和[tinymce](http://tinymce.moxiecode.com/)。它们都令人印象深刻，每个版本都在改进，可以应用于各种场景

在大多数现代浏览器中，通过 designmode/contenteditable div 和 iframe 提供了相当好的支持来构建这些东西。Flex 3 带有一个还不错的[RichTextEditor](http://livedocs.adobe.com/flex/3/langref/mx/controls/RichTextEditor.html)，它可以完成这项工作，但并不是那么好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T11:48:59.073

对于 Silverlight 看看这个

[http://www.vectorlight.net/controls/rich_textblock.aspx](http://www.vectorlight.net/controls/rich_textblock.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-18T06:52:25.687

对于 AS3，这是一个相当不错的免费版本。

[http://simplistika.com/as3-wysiwyg-rich-text-editor/](http://simplistika.com/as3-wysiwyg-rich-text-editor/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T04:12:46.503

从技术上讲，没有什么说明您不能执行此任务，因为大多数基本 RTF 功能（即视觉功能）都已到位。但是有一些限制，例如自动图像/文本重排（即，如果您分配图像并希望文本环绕它，这在某种程度上是数学+字符串+正则表达式操作的情况。不容易。

您还可以将 Silverlight 用于除渲染窗口本身之外的所有内容（工具栏等，这将有助于丢失图标并提供比 JS 现在提供的对异常处理更有限的控制）。因为这将使您能够使用 WYSIWYG 窗口（它实际上是利用浏览器渲染引擎本身）和 Silverlight 来满足所有其他需求。

我们正在研究如何在未来的版本中启用此功能，以免被置若罔闻。

**Scott Barnes / Rich Platforms 产品经理 / Microsoft。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-24T11:55:58.573

javascript 编辑器的主要优点是 javascript 为创建高级 html 元素（表格、水平线、有序列表和表单元素）提供了更多可能性。然而，这些编辑器中的大多数都是使用设计模式和 contenteditable iframe 创建的。这意味着代码的实际生成是由浏览器而不是 javascript 发生的。每个浏览器可能会生成不同的 html，这可能是不需要的。

Flash 编辑器功能较少且需要 Flash，但可能是 Flash 网站的完美解决方案。javascript 编辑器中的 html 差异可能非常烦人，并且 flash-html 不支持的功能不应该出现在该 javascript 编辑器中。Flash 还会生成其他没有在 html 中使用的标签，例如：该`<textformat>`标签仅在 flash-html/htmltext 中使用。

我遇到了这个问题，在没有 javascript 编辑器问题的情况下，我找不到生成所有可能的 flash-html 的编辑器。所以我自己创建了一个，可以在以下位置找到：
[http](http://www.flashcomponents.net/component/hcs-rich-text-editor.html)
://www.flashcomponents.net/component/hcs-rich-text-editor.html 它会生成 flash-html，如果需要也可以生成有效的 (x)html，没有任何区别在浏览器中。

所以简而言之，对于非基于 Flash 的网站，您可能需要一个 javascript 编辑器，因为它有更多的可能性。对于 Flash 网站，您需要一个基于 Flash 的富文本编辑器来生成带有特殊标签的 flash-html 代码，例如`<textformat>.`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-06T15:04:27.090

JavaScript RTE 将成为 Web 标准，因为 contentEditable 在 HTML 5 W3 规范中。JavaScript RTE 的当前方法是在文档的属性中将 designMode 设置为“on”。这样做的问题是整个文档变得可编辑，因此您会发现大多数 JavaScript RTE 通过 iFrame 加载编辑器，从而允许 iFrame 的文档将 designMode 设置为“on”而不是父文档。

当前可用的 JavaScript RTE 的一个缺点是修改用于插入图像的用户界面非常复杂（如果这对您很重要）。我个人并不关心很多内置接口，但据说如果你花足够的时间阅读文档，你可以随意修改它。例如，在他们的演示中查看 TinyMCE 的插入图像功能，然后启动 WordPress 并查看他们是如何修改它的。（WordPress 使用 TinyMCE）。

我没有运行任何测试，但它只是“感觉”就像在动作脚本文本区域中输入似乎更慢。我遇到的另一个问题是在文章中添加图像和移动它们的能力。即使在 Adob​​e AIR 中，据说它也使用 WebKit 渲染引擎，所以我尝试使用 JavaScript 制作 RTE，它在 Safari 浏览器（也使用 WebKit）上运行良好，但是通过 AIR 加载它时表现不同。

总的来说，没有很多真正好的解决方案，这与 contentEditable 不是大多数浏览器中的实现标准（目前）有很大关系，以及当前可用 RTE 的过于复杂的脚本。

对于 JavaScript RTE，请参阅：

TinyMCE、FCKEditor (CKEditor)、YUI 2 的编辑器，还有其他几个，如果你想自己动手，请寻找关于 execCommand() 的教程，它基本上是修改选定元素或将元素插入到 contentEditable 区域的 JavaScript 方法。

对于 Flash ......我不知道，没有很多好的实现，即使是 Flex 文本编辑器也有点基本和有限。这两个平台的主要缺点是修改和插入图像非常容易，因为像加粗文本或斜体这样的基本操作很简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T14:25:43.893

您在 Web 上发现大多数使用 Javascript 的主要原因主要是经济原因，大多数需要用户文本输入的网站（如博客、论坛或 stackoverflow）都是用 HTML/Javascript 构建的。所以当你有能力的 JS 程序员构建了 99% 的站点时，为什么还要请 Flash 程序员来构建另外 1% 的站点。

但这并不意味着它们不存在！快速搜索一个更受欢迎的股票闪存网站显示 3：

[第一站](http://flashden.net/item/rich-text-editor/551)| [RTE2](http://flashden.net/item/simple-text-editor/22783) | [RTE3](http://flashden.net/item/wysiwyg/31121)

那只是在FlashDen上。搜索 FlashComponents.net 或 UltraShock.com，或者甚至只是用谷歌搜索它，我向您保证，还有更多可供出售或免费下载。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-08-17T01:51:50.617

Mindscape 在这里为 Silverlight 制作一个所见即所得的富文本编辑器：

[http://www.mindscape.co.nz/products/SilverlightElements/controls/HtmlEditor.aspx](http://www.mindscape.co.nz/products/SilverlightElements/controls/HtmlEditor.aspx)

# cmake - Cmake的未定义参考链接错误

> ID：750459
> 
> 赞同：1
> 
> 时间：2009-04-15T05:54:27.680
> 
> 标签：cmake, qgis

我正在定制通过 cmake 构建的 qgis 源代码。

它有一个包含许多子目录的源代码树（其中也包含子目录）。

整个源代码树分为几个模块，如core，具有GIS核心组件，gui负责gui，app，负责主应用程序（包含main.cpp）和其他模块。

问题是我遇到了一个需要访问不同模块中的静态类成员的要求。准确地说是 Gui 模块中 QgisApp 类的一些成员。

因此，在 gui 模块的 .cpp 之一中正常包含 qgisapp.h 给了我对我想要访问的 mamber 的未定义引用。后来我将 .h 和 .cpp 包含在位于 Gui 内的 CMakeLists.txt 文件中模块的根目录，然后再次运行 cmake 以使 Makefile 具有正确的包含。但是如果未定义的引用很多，这实际上会增加数量（可能是因为我添加到 CMakeLists.txt 中的 .h 和 .cpp 本身包含其他 . h 和 .cpp 在应用模块自己的 CMakeLists.txt 中有引用）。

那么，如何在其他模块中使用某个模块的某个类的成员，这些模块是用放置在其各自根目录中的不同 CMakeLists.txt 集构建的？

这个问题与qgis没有特别的关系，但可以遇到与qgis类似的任何源代码树。所以它基本上是一个与Cmake相关的问题。

希望我能够解决我的问题。

帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-26T17:02:35.897

[**`target_link_libraries`**](http://www.cmake.org/cmake/help/cmake2.6docs.html#command:target_link_libraries)应该做你正在寻找的东西。如果这不起作用，您可以尝试发布一些示例 CMake 代码吗？

# c++ - 源代码中的注释

> ID：750464
> 
> 赞同：4
> 
> 时间：2009-04-15T05:56:47.517
> 
> 标签：c++, documentation, comments

如何保持源代码有据可查/注释？是否有工具可以为 C++ 的 Unix 平台上的注释生成框架？

一般来说，100 行左右代码的文件推荐多少行注释？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-15T06:02:16.710

一般来说，最好让代码本身解释**它**的作用，而注释是用来描述**为什么**会这样的。没有数字可以坚持。如果你的 100 行不言自明，请不要发表评论，或者只是在开头提供摘要。如果涉及的知识超出了代码的功能，请在评论中解释。

如果您的代码太复杂而无法自我解释，那么这可能是重构的原因。

这样，当您更改实现时，您也不需要更改注释，因为您的注释不会重复代码。由于设计的原因很少改变，为了清楚起见，将它们记录在注释中是安全的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-15T06:23:08.703

我个人认为骨架评论是一个可怕的想法。我知道有时保存几个击键并在评论中获得参数签名可能会很好......但是导致 n+1 空无用的评论（当编辑器添加了样板并且编码器保持原样时）只是更令人恼火。

无论如何，我确实认为需要注释——如果一个人写的代码太琐碎而无法解释，那么有问题的代码很可能是无用的（即可以是自动化的，不需要手写）。我倾向于合理地评论我的代码，因为我知道通常我自己首先需要它。其他人可以使用它们只是一个额外的好处。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-15T06:29:24.770

> 一般来说，100 行左右代码的文件推荐多少行注释？

足以说明您的意图并解释使用的任何不熟悉的成语。没有经验法则，因为没有两个 100 行代码是相同的。

例如，在 C# 中，可以为属性赋予 setter 和 getter，如下所示：

```
public int ID { get; set; } 
```

直到两周前加入 StackOverflow 之前，我什至没有见过任何 C#，但即使对我来说也不需要评论。用

```
// accessor and setter for ID property 
```

只是噪音。相似地，

```
for( int i = m ; i < n; ++i) { // "loop from m to n" is a pointless comment

char* p = getP() ; // set p to getP, pure noise.
if( p  ) // if p does not eqaul null, pure noise

int a &= 0x3; // a is bitwise or'd with 0x303, pure noise
              //  mask off all but two least significant bits, 
              //less noisy but still bad
              // get remainder of a / 4, finally a useful comment 
```

同样，任何称职的编码人员都可以阅读代码以查看它在做什么。任何具有基本经验的编码人员都知道这`if( p )`是 的常用习语`if( p != 0)`，无需解释。但除非你发表评论，否则没有人能读懂你的*意图。*

评论你想要做什么，你这样做的原因，而不是代码明显在做什么。

编辑时：您会注意到，11 天后，没有人在我的示例评论之一中评论故意错误。这只是强调该评论是纯粹的噪音。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-15T05:59:20.257

我认为这个问题对于类似的问题有很多很好的相关答案： [Self-documenting code](https://stackoverflow.com/questions/209015/self-documenting-code)

至于创建评论的工具，这取决于您使用的编辑器和平台。Visual Studio 会自动为评论创建空间，至少有时它会为 C# 提供。还有一些工具使用注释来生成文档。至于行数，我认为这无关紧要。尽可能简洁明了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-15T06:02:04.323

我认为一个很好的指导方针是评论每个类和方法，并对其用途进行一般描述，特别是如果您使用的是 HTML 文档生成工具。除此之外，我尝试将注释保持在最低限度 - 仅注释可能会令人困惑或需要解释意图的代码。尝试以不需要注释的方式编写代码。

我不认为真的有一个指标可以应用于注释/代码行，它只取决于代码。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-15T07:05:42.627

我个人的理想是写足够多的评论，这样仅仅阅读评论就可以解释如何以及为什么要使用一个函数。它是如何工作的，通常应该来自精心选择的变量名和清晰的实现。

至少在评论方面，实现这一目标的一种方法是从一开始就使用诸如[Doxygen](http://www.doxygen.org/)之类的工具。开始编写每个新功能的编码，说明它的用途和用途。

正确配置 Doxygen，将文档生成包含在构建步骤中，并阅读生成的文档。

唯一可能有用的评论模板是在 Doxygen 评论块的最简单的开头勾勒出草图，但即使这样也可能太多了。您希望生成的文档能够解释什么是重要的，而不是用永远不会被重写的无用占位符文本弄乱它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-15T06:31:41.567

这是一个可以走极端的主题（就像现在的许多事情一样）。恕我直言，在大多数情况下，执行强有力的政策有时可能会贬低这项工作（即为了评论而发表评论）。

有时一个过度的政策是有意义的（例如“所有公共函数必须有注释块”），但有例外——为什么要为生成的代码烦恼？

注释应该是自然而然的——应该在有意义的变量、属性和函数名称（等）旁边补充可读的代码。

我认为没有对每 Y 行代码的 X 条注释进行有用或准确的测量。您可能会通过同行评审获得良好的平衡感（例如“这里的代码应该有一个注释来解释它的目的”）。

我不确定 C/C++ 的自动注释工具，但 .Net 等价物必须是 GhostDoc。同样，这些工具仅有助于定义注释结构——含义仍然需要由开发人员添加，或者必须由必须解释代码或设计要点的人添加。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-15T07:34:12.633

如果您自动生成文档（我们使用[doxygen](http://www.doxygen.nl/)），注释代码是必不可少的。否则最好将其保持在最低限度。

我们为 .cpp 文件中的每个方法使用一个框架。

```
//**************************************************************************************************
//
/// @brief 
/// @details
/// @param  
/// @return
/// @sa 
//
//************************************************************************************************** 
```

但这纯粹是由于我们的文档需求

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-16T14:36:20.217

我尝试遵循的规则：

*   编写自动记录的代码：漂亮而清晰的变量名，抵制聪明的黑客攻击等。这个建议很大程度上取决于您使用的编程语言：使用 Python 比使用 C 更容易遵循。

*   在开头发表评论以引导读者，以便他们立即知道他们会期待什么。

*   注释代码中不明显的内容。如果您在编写一段代码时遇到问题，这可能意味着它值得评论。

*   库的 API 是一种特殊情况：它**需要** 文档（并且将其放入代码中通常是一个好主意，尤其是使用 Doxygen 之类的工具时）。只是不要将本针对用户的文档与对库维护者有用的文档混淆。

*   注释代码中不能包含的内容，例如解释事情为何如此的政策要求。

*   评论背景信息，例如对描述您使用的巧妙算法的科学文章的引用，或对您实现的网络协议进行标准化的 RFC。

*   评论黑客！每个人有时都被迫使用黑客或变通方法，但对未来的维护者很好，评论它。阅读“[技术债务](http://martinfowler.com/bliki/TechnicalDebt.html)”。

其余的不要评论。诸如“20% 的行必须是注释”之类的定量规则显然是愚蠢的，而且显然只适用于 PHB。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-15T06:27:53.747

我不知道有任何工具，但我觉得如果将来要由其他人维护，在代码中添加一些注释总是好的。至少，最好有类和方法的标题块，详细说明类的用途和方法的作用。但是，是的，尽可能减少评论是件好事。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-15T06:29:04.693

我更喜欢用评论来解释

1.  类\函数打算做什么，
2.  它不应该做的事情，
3.  我做出的类\函数的用户应该遵守的任何假设。

对于 vi 编辑器的用户，以下插件非常有用。我们可以为类注释、函数注释等定义模板。

[c支持插件](http://www.vim.org/scripts/script.php?script_id=213)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-15T06:40:20.877

在注释/代码比率方面没有好的规则。这完全取决于代码的复杂性。

关于评论，我确实遵循一个（也是唯一一个）规则（我喜欢保持灵活性）。

> 代码显示事情是如何完成的，注释显示完成了什么。

有些代码根本不需要注释，因为它很明显：这通常可以通过使用好的变量名来实现。大多数情况下，我将注释一个函数，然后用该函数注释主要块。

我认为这很糟糕：

```
// Process list by running through the whole list,
// processing each node within the list.
//
void processList (tNode *s) {
    while (s != NULL) {         // Run until reached end of list.
        processNode (s);        // Process the node.
        s = s->nxt;             // Move to next node.
    }
 } 
```

因为你在那里所做的就是三次编写代码。我更喜欢这样的东西：

```
// Process list (or rest of list if you pass a non-start node).
//
void processList (tNode *currentNode) {
    // Run through the list, processing each node.

    while (currentNode != NULL) {
        processNode (currentNode);
        currentNode = currentNode->nextNode;
    }
 } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-15T07:20:52.307

你们可能会争论，但我真的相信：

通常，您不必写评论。就这么简单。代码必须以自我解释的方式编写，如果它不能自我解释并且您必须编写注释，那么就有问题了。

但也有一些例外情况：

1.  你必须写一些非常神秘的东西才能获得性能。所以在这里你可能需要写一些解释。
2.  您为其他一些团体/公司提供了一个库，最好记录它的 API。
3.  您的组织中有太多的新手程序员。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-15T08:37:00.207

我不会这么粗鲁地说评论是像上面某些人那样糟糕的编程代码的借口，也不会说你不需要它们。

它还取决于您的编辑器以及您希望如何在其中**查看**您的代码，以及您希望其他人如何执行此操作。

例如，我喜欢在 C# 中创建区域。区域被命名为可折叠的代码区域，以某种方式注释代码容器。这样，当我查看编辑器时，我实际上是在查看伪代码。

```
#region Connect to the database
   // ....
#endregion

#region  Prepare tables

   #region Cache tables ...

   #endregion

   #region Fix column names ...

   #endregion

#endregion 
```

这种代码比我知道的任何其他代码都更具可读性，但当然，它需要编辑器支持*带有名称的自定义折叠。*（如 Visual Studio 编辑器、VIM...）。有人会说，如果将区域放入程序中，您可以实现类似的效果，但首先，您不能总是这样做，其次，您必须跳转到程序才能看到它的代码。如果您只是简单地设置热键来打开/折叠区域，您可以在滚动和阅读文本时快速查看其中的代码，并且通常可以快速移动区域的层次结构。

关于行注释，编写自动记录自身的代码会很好，但不幸的是，这通常不能这么说。这当然取决于项目、它的领域和它的复杂性。

最后一点，我完全建议通过**可移植**和独立于**语言**的工具进行代码内文档，例如[NaturalDocs](http://www.naturaldocs.org/)，它可以使用任何语言使用不包括 XML 或任何特殊格式的自然语法（因此名称）加上它不需要安装超过一次。

如果有人不喜欢评论，他总是可以使用一些简单的工具将其删除。我什至在我的编辑器中集成了这样的工具，评论通过简单的菜单点击消失了。因此，注释不能以任何无法快速修复的方式损害代码。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-15T07:22:39.870

我说通常评论是一种难闻的气味。但是内联代码文档很棒。我在[robowiki.net](http://robowiki.net)上详细阐述了这个主题：

[为什么评论不好](http://robowiki.net/cgi-bin/robowiki?WhyCommentsAreBad)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-15T07:59:49.967

我同意每个人关于自我记录代码的看法。我也同意在文档生成方面需要特别评论。每个方法/类顶部的简短注释很有用，特别是如果您的 IDE 可以将其用于代码完成中的工具提示（如 Visual Studio）。

我在这里没有看到的评论的另一个原因是 JavaScript 或 PHP 等类型不安全的语言。您可以通过这种方式指定数据类型，尽管匈牙利表示法也可以提供帮助（我认为这是正确使用它的罕见情况之一）。

此外，像 PHPLint 这样的工具可以使用一些特殊的类型相关注释来检查您的代码的类型安全性。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-15T08:37:39.737

没有可以明智地用于评论的指标。你永远不应该说 x 行代码必须有 y 注释，因为那样你最终会得到愚蠢无用的注释，这些注释只是重述代码，而这些会降低代码的质量。

*100 行代码应该有尽可能少的注释。*

就个人而言，过去使用过它们，我不会使用 doxygen 之类的东西来记录内部代码，直到每个函数和每个需要标记描述的参数的范围内，因为使用良好的分解代码你有很多函数和好名字，最常见的是这些标记的描述只说明参数名称本身。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-04-15T08:38:41.823

我的意见 - 源代码中的注释是邪恶的。代码应该是自我记录的。开发人员通常会忘记阅读和更新它们。
正如可悲的 Martin Fowler：“如果您需要对行块进行注释 - 只需创建新功能”（这不是引用 - 我记得这句话）。

最好为实用模块、项目的基本原则、库的组织、一些算法和设计理念保留单独的文档。

差点忘了：我曾经使用过代码注释。这是 MFC/COM - 项目，我在非平凡的解决方案/解决方法附近留下了来自 MSDN howto 文章的链接。

100 行源代码——如果不是应该可以理解的——它应该被分离或重组为几个功能——这将更容易理解。

> 是否有工具可以为 C++ 的 Unix 平台上的注释生成框架？

如果你真的需要的话，Vim 有插入 doxygen 注释模板的插件。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-08-01T12:45:19.560

源代码应始终记录在需要的地方。人们争论什么和不记录什么。但是，我想再添加一个注释。

假设我已经实现了一个返回 a/b 的方法

所以作为程序员，我是一个伟大的公民，我会提示用户期待什么。

```
/**
 * Will return 0 if b is 0, to prevent the world from exploding.
 */
float divide(float a, float b) {
    if (b == 0) return 0;
    return a/b;
} 
```

我知道，很明显没有人会创建这样的方法。但这可以反映在其他问题上，即 API 的用户无法弄清楚函数期望什么。

# javascript - 富文本编辑器[WYSIWYG] 使用 javascript 进行分页

> ID：750468
> 
> 赞同：4
> 
> 时间：2009-04-15T05:58:38.277
> 
> 标签：javascript, paging, richtextediting

是否可以在使用 JavaScript 的富文本编辑器中实现类似于 MS Word 的分页。

我需要使用包含页面文本的 JavaScript 来实现一个编辑器。如果我输入的文本超出了页面的限制，则会自动创建一个新页面，并且文本会溢出到新页面，格式不变。此外，如果我从另一个来源复制大文本，那么它应该根据文本长度计算页数，并将其分成具有原始文本所有格式的页面。

我需要仅使用 JavaScript、HTML 和 CSS 根据像素大小将文本分成几行。

如果我从页面内部删除内容，则应在当前页面中填充下一页的内容，如果删除页面中的所有内容，则应删除该页面。MS word 中几乎所有的分页功能都应该在这个中实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-23T05:24:34.477

请试试这个...

Javascript 代码 pagination.js 文件

```
function Pager(tableName, itemsPerPage) {
    this.tableName = tableName;
    this.itemsPerPage = itemsPerPage;
    this.currentPage = 1;
    this.pages = 0;
    this.inited = false;
    this.showRecords = function(from, to) {
        var rows = document.getElementById(tableName).rows;
        // i starts from 1 to skip table header row
        for (var i = 1; i < rows.length; i++) {
            if (i < from || i > to)
            rows[i].style.display = 'none';
            else
            rows[i].style.display = '';
        }
    }

    this.showPage = function(pageNumber) {
        if (! this.inited) {
            alert("not inited");
            return;
        }
        var oldPageAnchor = document.getElementById('pg'+this.currentPage);
        oldPageAnchor.className = 'pg-normal';

        this.currentPage = pageNumber;
        var newPageAnchor = document.getElementById('pg'+this.currentPage);
        newPageAnchor.className = 'pg-selected';

        var from = (pageNumber - 1) * itemsPerPage + 1;
        var to = from + itemsPerPage - 1;
        this.showRecords(from, to);
    }

    this.prev = function() {
        if (this.currentPage > 1)
            this.showPage(this.currentPage - 1);
    }

    this.next = function() {
        if (this.currentPage < this.pages) {
            this.showPage(this.currentPage + 1);
        }
    }

    this.init = function() {
        var rows = document.getElementById(tableName).rows;
        var records = (rows.length - 1);
        this.pages = Math.ceil(records / itemsPerPage);
        this.inited = true;
    }

    this.showPageNav = function(pagerName, positionId) {
        if (! this.inited) {
            alert("not inited");
            return;
        }
        var element = document.getElementById(positionId);

        var pagerHtml = '<span onclick="' + pagerName + '.prev();" class="pg-normal"> « Prev </span> | ';
        for (var page = 1; page <= this.pages; page++)
        pagerHtml += '<span id="pg' + page + '" class="pg-normal" onclick="' + pagerName + '.showPage(' + page + ');">' + page + '</span> | ';
        pagerHtml += '<span onclick="'+pagerName+'.next();" class="pg-normal"> Next »</span>';

        element.innerHTML = pagerHtml;
    }
} 
```

HTML 文件

```
<html version="-//W3C//DTD HTML 4.01 Transitional//EN">

<head>
<style type="text/css">
.pg-normal {
color: black;
font-weight: normal;
text-decoration: none;
cursor: pointer;
}
.pg-selected {
color: black;
font-weight: bold;
text-decoration: underline;
cursor: pointer;
}
</style>

<script type="text/javascript" src="pagination.js"></script>
</head>

<body>
<form action="" method="get" enctype="application/x-www-form-urlencoded">
<table id="results">
<tr>
<th>#</th>
<th>field</th>
</tr>
<tr>
<td>1</td>
<td>rajeev</td>
</tr>
<tr>
<td>2</td>
<td>ramesh</td>
</tr>
<tr>
<td>3</td>
<td>Rahul</td>
</tr>
<tr>
<td>4</td>
<td>Bala</td>
</tr>
<tr>
<td>5</td>
<td>Teamjhon</td>
</tr>
<tr>
<td>6</td>
<td>Robin</td>
</tr>
<tr>
<td>7</td>
<td>Sambha</td>
</tr>
<tr>
<td>8</td>
<td>Arjun</td>
</tr>
<tr>
<td>9</td>
<td>Satyan</td>
</tr>
<tr>
<td>10</td>
<td>Singapore</td>
</tr>
</table>
<div id="pageNavPosition"></div>
<div><input type="submit" onclick="alert('Hey this is just a sample!'); return false;" /> <input type="reset" /></div>
</form>

<script type="text/javascript"><!--
var pager = new Pager('results' 3);
pager.init();
pager.showPageNav('pager' 'pageNavPosition');
pager.showPage(1);
//--></script>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T06:08:38.847

当然有可能。一种实现可能是在考虑行高/字体大小的同时计算文本行数。

# java - java (1.6) 中如何知道文件复制是否“正在进行”/完成

> ID：750471
> 
> 赞同：14
> 
> 时间：2009-04-15T05:59:16.060
> 
> 标签：java, file-io

我正在 java(1.6) 中编写一个目录监视实用程序，使用`lastModified`长值作为更改指示以特定间隔进行轮询。我发现当我的轮询间隔很小（秒）并且复制的文件很大时，在文件复制实际完成之前会触发更改事件。

我想知道是否有一种方法可以找到文件的状态，例如传输中、完成等。

环境：Java 1.6；预计可以在windows和linux上工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T06:26:48.927

我过去使用过两种与平台无关的方法。

1/ 这是用于我控制放置内容的 FTP 传输，因此它可能不直接相关。

基本上，无论放置一个文件，当它完成时，也会放置一个名为（例如）`file.txt`的小（可能是零字节）虚拟文件。`file.txt.marker`

这样，监控工具只是寻找出现的标记文件，当它出现时，它就知道真正的文件是完整的。然后它可以处理真实文件并删除标记。

2/ 持续时间不变。

让您的监控程序等到文件未更改 N 秒（其中 N 可以合理地保证足够大以完成文件*）*。

例如，如果文件大小在 60 秒内没有更改，则很有可能已完成。

在因为没有任何活动而认为文件已完成与等待文件完成后才开始处理它之间存在平衡。对于本地复制来说，这比 FTP 的问题要小。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-03-02T16:35:20.257

This solution worked for me:

```
File ff = new File(fileStr);

if(ff.exists()) {

    for(int timeout = 100; timeout>0; timeout--) {
        RandomAccessFile ran = null;

        try {
            ran = new RandomAccessFile(ff, "rw");
            break; // no errors, done waiting
        } catch (Exception ex) {
            System.out.println("timeout: " + timeout + ": " + ex.getMessage());
        } finally {
            if(ran != null) try {
                ran.close();
            } catch (IOException ex) {
                //do nothing
            }

            ran = null;
        }

        try {
            Thread.sleep(100); // wait a bit then try again
        } catch (InterruptedException ex) {
            //do nothing
        }
    }

    System.out.println("File lockable: " + fileStr +
                 (ff.exists()?" exists":" deleted during process"));
} else {
    System.out.println("File does not exist: " + fileStr);
} 
```

This solution relies on the fact that you can't open the file for writing if another process has it open. It will stay in the loop until the timeout value is reached or the file can be opened. The timeout values will need to be adjusted depending on the application's actual needs. I also tried this method with channels and tryLock(), but it didn't seem to be necessary.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T06:10:07.517

你的意思是你在等待`lastModified`时间解决？充其量这将是一个有点命中注定。

尝试使用写访问权限打开文件怎么样（当然是追加而不是截断文件）？如果另一个进程仍在尝试写入它，那将不会成功。这有点难看，特别是因为它可能是使用异常进行流控制（ick）的情况，但我认为它会起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-28T02:28:25.517

我们曾经监控文件大小的变化以确定文件是否不完整。

我们使用 Spring 集成文件端点每 200 毫秒对目录进行轮询。

一旦检测到文件（不管它是否完整），我们有一个客户文件过滤器，它会有一个接口方法“accept(File file)”来返回一个标志，指示我们是否可以处理该文件。

如果过滤器返回 False，则此 FILE 实例将被忽略，并且将在下一次轮询期间为同一过滤过程拾取。

过滤器执行以下操作：

首先，我们得到它当前的文件大小。我们将等待 200 毫秒（可以更少）并再次检查大小。如果大小不同，我们将重试 5 次。只有当文件大小停止增长时，文件才会被标记为 COMPLETED。（即返回 true）。

使用的示例代码如下：

```
public class InCompleteFileFilter<F> extends AbstractFileListFilter<F> {

    protected Object monitor = new Object();
    @Override
    protected boolean accept(F file) {
    synchronized (monitor){

        File currentFile = (File)file;

        if(!currentFile.getName().contains("Conv1")){return false;}

        long currentSize = currentFile.length();
        try { Thread.sleep(200); } catch (InterruptedException e) { e.printStackTrace(); }
        int retryCount = 0;
        while(retryCount++ < 4 && currentFile.length() > currentSize){
            try { Thread.sleep(200); } catch (InterruptedException e) { e.printStackTrace(); }
        }

        if(retryCount == 5){
            return false;
        }else{
            return true;
        }
    }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T06:25:06.903

如果我正确理解了这个问题，您正在寻找一种方法来区分文件的复制是完成还是仍在进行中？

如何比较源文件和目标文件的大小（即 file.length()）？如果它们相等，则复制完成。否则，它仍在进行中。

我不确定它是否有效，因为它仍然需要轮询。但它“可能”起作用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T06:52:38.537

您可以使用进度条技术查看在线文件上传 - 他们使用 OutputStreamListener 和自定义编写器来通知侦听器有关写入的字节数。

[http://www.missiondata.com/blog/java/28/file-upload-progress-with-ajax-and-java-and-prototype/](http://www.missiondata.com/blog/java/28/file-upload-progress-with-ajax-and-java-and-prototype/)

[使用 Java 上传文件（带进度条）](https://stackoverflow.com/questions/254719/file-upload-with-java-with-progress-bar)

# javascript - 循环内的 JavaScript 闭包——简单实用的示例

> ID：750486
> 
> 赞同：3092
> 
> 时间：2009-04-15T06:06:20.460
> 
> 标签：javascript, loops, closures

```
var funcs = [];
// let's create 3 functions
for (var i = 0; i < 3; i++) {
  // and store them in funcs
  funcs[i] = function() {
    // each should log its value.
    console.log("My value: " + i);
  };
}
for (var j = 0; j < 3; j++) {
  // and now let's run each one to see
  funcs[j]();
}
```

它输出这个：

> 我的价值：3
> 我的价值：3
> 我的价值：3

而我希望它输出：

> 我的价值：0
> 我的价值：1
> 我的价值：2

* * *

当函数运行延迟是由使用事件监听器引起时，也会出现同样的问题：

```
var buttons = document.getElementsByTagName("button");
// let's create 3 functions
for (var i = 0; i < buttons.length; i++) {
  // as event listeners
  buttons[i].addEventListener("click", function() {
    // each should log its value.
    console.log("My value: " + i);
  });
}
```

```
<button>0</button>
<br />
<button>1</button>
<br />
<button>2</button>
```

… 或异步代码，例如使用 Promises：

```
// Some async wait function
const wait = (ms) => new Promise((resolve, reject) => setTimeout(resolve, ms));

for (var i = 0; i < 3; i++) {
  // Log `i` as soon as each promise resolves.
  wait(i * 100).then(() => console.log(i));
}
```

在`for in`和`for of`循环中也很明显：

```
const arr = [1,2,3];
const fns = [];

for(var i in arr){
  fns.push(() => console.log(`index: ${i}`));
}

for(var v of arr){
  fns.push(() => console.log(`value: ${v}`));
}

for(var f of fns){
  f();
}
```

这个基本问题的解决方案是什么？

* * *

## 回答 #1

> 赞同：2327
> 
> 时间：2009-04-15T06:18:17.527

好吧，问题在于`i`每个匿名函数内的变量都绑定到函数外的同一个变量。

# ES6 解决方案：`let`

ECMAScript 6 (ES6) 引入了新的`let`和`const`关键字，它们的作用域不同于`var`基于 - 的变量。例如，在具有`let`-based 索引的循环中，循环中的每次迭代都会有一个具有循环范围的新变量`i`，因此您的代码将按预期工作。有很多资源，但我推荐[2ality 的块范围帖子](http://www.2ality.com/2015/02/es6-scoping.html)作为重要的信息来源。

```
for (let i = 0; i < 3; i++) {
  funcs[i] = function() {
    console.log("My value: " + i);
  };
} 
```

但请注意，IE9-IE11 和 Edge 14 之前的 Edge 支持`let`但会出现上述错误（它们不会`i`每次都创建新函数，因此上述所有函数都会像我们使用 3 一样记录 3 `var`）。Edge 14 终于做对了。

* * *

# ES5.1 解决方案：forEach

随着`Array.prototype.forEach`函数相对广泛的可用性（在 2015 年），值得注意的是，在那些主要涉及对一组值进行迭代的情况下，`.forEach()`它提供了一种干净、自然的方式来为每次迭代获得不同的闭包。也就是说，假设您有某种包含值（DOM 引用、对象等）的数组，并且出现了为每个元素设置特定回调的问题，您可以这样做：

```
var someArray = [ /* whatever */ ];
// ...
someArray.forEach(function(arrayElement) {
  // ... code code code for this one element
  someAsynchronousFunction(arrayElement, function() {
    arrayElement.doSomething();
  });
}); 
```

这个想法是，与循环一起使用的回调函数的每次调用都`.forEach`将是它自己的闭包。传递给该处理程序的参数是特定于迭代的特定步骤的数组元素。如果在异步回调中使用它，它不会与在迭代的其他步骤中建立的任何其他回调发生冲突。

如果你碰巧在 jQuery 中工作，这个`$.each()`函数会给你类似的能力。

* * *

# 经典解决方案：闭包

您要做的是将每个函数内的变量绑定到函数外的一个单独的、不变的值：

```
var funcs = [];

function createfunc(i) {
  return function() {
    console.log("My value: " + i);
  };
}

for (var i = 0; i < 3; i++) {
  funcs[i] = createfunc(i);
}

for (var j = 0; j < 3; j++) {
  // and now let's run each one to see
  funcs[j]();
}
```

由于 JavaScript 中没有块作用域——只有函数作用域——通过将函数创建包装在一个新函数中，您可以确保“i”的值保持您的预期。

* * *

## 回答 #2

> 赞同：405
> 
> 时间：2009-04-15T06:10:50.947

尝试：

```
var funcs = [];

for (var i = 0; i < 3; i++) {
    funcs[i] = (function(index) {
        return function() {
            console.log("My value: " + index);
        };
    }(i));
}

for (var j = 0; j < 3; j++) {
    funcs[j]();
}
```

**编辑**（2014）：

就我个人而言，我认为@Aust[最近关于 using 的回答`.bind`](https://stackoverflow.com/a/19323214/918959)是现在做这种事情的最佳方式。`_.partial`当您不需要或不想弄乱`bind`'s时，还有 lo-dash/underscore's `thisArg`。

* * *

## 回答 #3

> 赞同：376
> 
> 时间：2013-10-11T16:41:56.673

另一种尚未提及的方法是使用[`Function.prototype.bind`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind)

```
var funcs = {};
for (var i = 0; i < 3; i++) {
  funcs[i] = function(x) {
    console.log('My value: ' + x);
  }.bind(this, i);
}
for (var j = 0; j < 3; j++) {
  funcs[j]();
}
```

**更新**

正如@squint 和@mekdev 所指出的，通过首先在循环外创建函数然后将结果绑定到循环内，您可以获得更好的性能。

```
function log(x) {
  console.log('My value: ' + x);
}

var funcs = [];

for (var i = 0; i < 3; i++) {
  funcs[i] = log.bind(this, i);
}

for (var j = 0; j < 3; j++) {
  funcs[j]();
}
```

* * *

## 回答 #4

> 赞同：285
> 
> 时间：2013-10-11T18:23:43.657

使用[Immediately-Invoked Function Expression](http://en.wikipedia.org/wiki/Immediately-invoked_function_expression)，最简单且最易读的方法来包含索引变量：

```
for (var i = 0; i < 3; i++) {

    (function(index) {

        console.log('iterator: ' + index);
        //now you can also loop an ajax call here 
        //without losing track of the iterator value:   $.ajax({});

    })(i);

}
```

这会将迭代器发送`i`到我们定义为的匿名函数中`index`。这将创建一个闭包，其中变量`i`被保存以供以后在 IIFE 中的任何异步功能中使用。

* * *

## 回答 #5

> 赞同：176
> 
> 时间：2015-04-10T09:57:07.557

聚会有点晚了，但我今天正在探索这个问题，并注意到许多答案并没有完全解决 Javascript 如何处理作用域，这本质上就是归结为什么。

正如许多其他人提到的，问题在于内部函数引用了相同的`i`变量。那么为什么我们不只是在每次迭代中创建一个新的局部变量，而是让内部函数引用它呢？

```
//overwrite console.log() so you can see the console output
console.log = function(msg) {document.body.innerHTML += '<p>' + msg + '</p>';};

var funcs = {};
for (var i = 0; i < 3; i++) {
    var ilocal = i; //create a new local variable
    funcs[i] = function() {
        console.log("My value: " + ilocal); //each should reference its own local variable
    };
}
for (var j = 0; j < 3; j++) {
    funcs[j]();
}
```

就像以前一样，每个内部函数输出分配给 的最后一个值`i`，现在每个内部函数只输出分配给 的最后一个值`ilocal`。但是每个迭代不应该有它自己的`ilocal`吗？

原来，这就是问题所在。每次迭代都共享相同的范围，因此第一次之后的每次迭代都只是覆盖`ilocal`。来自[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/block#No_block_scope)：

> 重要提示：JavaScript 没有块作用域。与块一起引入的变量的作用域是包含函数或脚本，并且设置它们的效果会持续到块本身之外。换句话说，块语句不引入范围。尽管“独立”块是有效的语法，但您不想在 JavaScript 中使用独立块，因为如果您认为它们在 C 或 Java 中执行类似块的操作，它们不会按照您的想法执行。

再次强调：

> ## JavaScript 没有块作用域。用块引入的变量的作用域是包含函数或脚本

我们可以通过`ilocal`在每次迭代中声明它之前检查来看到这一点：

```
//overwrite console.log() so you can see the console output
console.log = function(msg) {document.body.innerHTML += '<p>' + msg + '</p>';};

var funcs = {};
for (var i = 0; i < 3; i++) {
  console.log(ilocal);
  var ilocal = i;
}
```

这正是这个错误如此棘手的原因。即使您正在重新声明一个变量，Javascript 也不会抛出错误，而 JSLint 甚至不会抛出警告。这也是为什么解决这个问题的最佳方法是利用闭包的原因，这本质上是在 Javascript 中，内部函数可以访问外部变量的想法，因为内部作用域“包围”了外部作用域。

![闭包](https://i.stack.imgur.com/60fH9.png)

这也意味着即使外部函数返回，内部函数也会“保留”外部变量并使它们保持活动状态。为了利用这一点，我们创建并调用一个包装函数纯粹是为了创建一个新的作用域，`ilocal`在新作用域中声明，并返回一个使用的内部函数`ilocal`（下面有更多解释）：

```
//overwrite console.log() so you can see the console output
console.log = function(msg) {document.body.innerHTML += '<p>' + msg + '</p>';};

var funcs = {};
for (var i = 0; i < 3; i++) {
    funcs[i] = (function() { //create a new scope using a wrapper function
        var ilocal = i; //capture i into a local var
        return function() { //return the inner function
            console.log("My value: " + ilocal);
        };
    })(); //remember to run the wrapper function
}
for (var j = 0; j < 3; j++) {
    funcs[j]();
}
```

在包装函数中创建内部函数为内部函数提供了一个只有它可以访问的私有环境，即“闭包”。因此，每次我们调用包装函数时，我们都会创建一个新的内部函数，它有自己独立的环境，确保`ilocal`变量不会相互冲突和覆盖。一些小的优化给出了许多其他 SO 用户给出的最终答案：

```
//overwrite console.log() so you can see the console output
console.log = function(msg) {document.body.innerHTML += '<p>' + msg + '</p>';};

var funcs = {};
for (var i = 0; i < 3; i++) {
    funcs[i] = wrapper(i);
}
for (var j = 0; j < 3; j++) {
    funcs[j]();
}
//creates a separate environment for the inner function
function wrapper(ilocal) {
    return function() { //return the inner function
        console.log("My value: " + ilocal);
    };
}
```

**更新**

随着 ES6 现在成为主流，我们现在可以使用 new`let`关键字来创建块范围的变量：

```
//overwrite console.log() so you can see the console output
console.log = function(msg) {document.body.innerHTML += '<p>' + msg + '</p>';};

var funcs = {};
for (let i = 0; i < 3; i++) { // use "let" to declare "i"
    funcs[i] = function() {
        console.log("My value: " + i); //each should reference its own local variable
    };
}
for (var j = 0; j < 3; j++) { // we can use "var" here without issue
    funcs[j]();
}
```

看看现在多么容易！有关更多信息，请参阅[此答案](https://stackoverflow.com/a/16661498/1852456)，我的信息基于此答案。

* * *

## 回答 #6

> 赞同：164
> 
> 时间：2013-05-21T03:04:48.667

随着 ES6 现在得到广泛支持，这个问题的最佳答案已经改变。ES6 为这种情况提供了`let`and`const`关键字。`let`我们可以像这样设置循环范围变量，而不是搞乱闭包：

```
var funcs = [];

for (let i = 0; i < 3; i++) {          
    funcs[i] = function() {            
      console.log("My value: " + i); 
    };
}
```

`val`然后将指向一个特定于该特定循环转弯的对象，并将返回正确的值而无需额外的闭包符号。这显然大大简化了这个问题。

`const`类似于`let`变量名在初始赋值后不能重新绑定到新引用的附加限制。

浏览器支持现在针对那些针对最新版本浏览器的用户。`const`/`let`当前支持最新的 Firefox、Safari、Edge 和 Chrome。Node 也支持它，您可以利用 Babel 等构建工具在任何地方使用它。您可以在这里看到一个工作示例：http: [//jsfiddle.net/ben336/rbU4t/2/](http://jsfiddle.net/ben336/rbU4t/2/)

这里的文档：

*   [常量](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const)
*   [让](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let)

但请注意，IE9-IE11 和 Edge 14 之前的 Edge 支持`let`但会出现上述错误（它们不会`i`每次都创建新函数，因此上述所有函数都会像我们使用 3 一样记录 3 `var`）。Edge 14 终于做对了。

* * *

## 回答 #7

> 赞同：94
> 
> 时间：2009-04-15T06:48:43.727

另一种说法是函数中的`i`in 在执行函数时绑定，而不是在创建函数时绑定。

创建闭包时，`i`是对外部范围中定义的变量的引用，而不是创建闭包时的副本。它将在执行时进行评估。

大多数其他答案提供了通过创建另一个不会为您更改值的变量来解决问题的方法。

只是想我会添加一个解释清楚。对于解决方案，就个人而言，我会选择 Harto's，因为这是从这里的答案中最不言自明的方式。发布的任何代码都可以工作，但我会选择闭包工厂，而不是不得不写一堆评论来解释我为什么要声明一个新变量（Freddy 和 1800 的）或有奇怪的嵌入式闭包语法（apphacker）。

* * *

## 回答 #8

> 赞同：77
> 
> 时间：2009-04-15T06:25:08.790

您需要了解的是javascript中变量的范围是基于函数的。这与说 c# 有块范围的重要区别，只需将变量复制到 for 中的一个即可。

将它包装在一个评估返回函数的函数中，就像 apphacker 的答案一样，因为变量现在具有函数范围。

还有一个 let 关键字代替 var，这将允许使用块范围规则。在这种情况下，在 for 中定义一个变量就可以了。也就是说，由于兼容性，let 关键字不是一个实用的解决方案。

```
var funcs = {};

for (var i = 0; i < 3; i++) {
  let index = i; //add this
  funcs[i] = function() {
    console.log("My value: " + index); //change to the copy
  };
}

for (var j = 0; j < 3; j++) {
  funcs[j]();
}
```

* * *

## 回答 #9

> 赞同：64
> 
> 时间：2012-08-07T08:45:35.700

这是该技术的另一个变体，类似于 Bjorn 的 (apphacker)，它允许您在函数内部分配变量值，而不是将其作为参数传递，有时可能更清楚：

```
var funcs = [];
for (var i = 0; i < 3; i++) {
    funcs[i] = (function() {
        var index = i;
        return function() {
            console.log("My value: " + index);
        }
    })();
}
```

请注意，无论您使用什么技术，该`index`变量都会成为一种静态变量，绑定到内部函数的返回副本。即，在调用之间保留对其值的更改。它可以非常方便。

* * *

## 回答 #10

> 赞同：62
> 
> 时间：2013-04-20T09:59:57.620

这描述了在 JavaScript 中使用闭包的常见错误。

## 一个函数定义了一个新环境

考虑：

```
function makeCounter()
{
  var obj = {counter: 0};
  return {
    inc: function(){obj.counter ++;},
    get: function(){return obj.counter;}
  };
}

counter1 = makeCounter();
counter2 = makeCounter();

counter1.inc();

alert(counter1.get()); // returns 1
alert(counter2.get()); // returns 0 
```

每次`makeCounter`调用时，都会`{counter: 0}`创建一个新对象。此外，还会创建一个新副本`obj` 以引用新对象。因此，`counter1`和`counter2`是相互独立的。

## 循环中的闭包

在循环中使用闭包很棘手。

考虑：

```
var counters = [];

function makeCounters(num)
{
  for (var i = 0; i < num; i++)
  {
    var obj = {counter: 0};
    counters[i] = {
      inc: function(){obj.counter++;},
      get: function(){return obj.counter;}
    }; 
  }
}

makeCounters(2);

counters[0].inc();

alert(counters[0].get()); // returns 1
alert(counters[1].get()); // returns 1 
```

注意`counters[0]`和`counters[1]`不是独立*的。*事实上，它们的操作是一样的`obj`！

这是因为`obj`在循环的所有迭代中只有一个 shared 副本，可能是出于性能原因。即使`{counter: 0}`在每次迭代中创建一个新对象，相同的副本`obj`也只会使用对最新对象的引用进行更新。

解决方案是使用另一个辅助函数：

```
function makeHelper(obj)
{
  return {
    inc: function(){obj.counter++;},
    get: function(){return obj.counter;}
  }; 
}

function makeCounters(num)
{
  for (var i = 0; i < num; i++)
  {
    var obj = {counter: 0};
    counters[i] = makeHelper(obj);
  }
} 
```

这是因为函数作用域中的局部变量以及函数参数变量在进入时被分配了新的副本。

* * *

## 回答 #11

> 赞同：52
> 
> 时间：2013-06-25T14:21:53.770

最简单的解决方案是，

而不是使用：

```
var funcs = [];
for(var i =0; i<3; i++){
    funcs[i] = function(){
        alert(i);
    }
}

for(var j =0; j<3; j++){
    funcs[j]();
} 
```

警报“2”，持续 3 次。这是因为在 for 循环中创建的匿名函数共享相同的闭包，并且在该闭包中， 的值`i`是相同的。使用它来防止共享关闭：

```
var funcs = [];
for(var new_i =0; new_i<3; new_i++){
    (function(i){
        funcs[i] = function(){
            alert(i);
        }
    })(new_i);
}

for(var j =0; j<3; j++){
    funcs[j]();
} 
```

这背后的想法是，用[IIFE](https://en.wikipedia.org/wiki/Immediately-invoked_function_expression)（立即调用函数表达式）封装 for 循环的整个主体，并将`new_i`其作为参数传递并将其捕获为`i`. 由于匿名函数是立即执行的，因此`i`匿名函数内部定义的每个函数的值都是不同的。

该解决方案似乎适合任何此类问题，因为它需要对遭受此问题的原始代码进行最小的更改。事实上，这是设计使然，根本不应该成为问题！

* * *

## 回答 #12

> 赞同：34
> 
> 时间：2014-05-03T03:42:57.677

这是一个使用的简单解决方案`forEach`（可回溯到 IE9）：

```
var funcs = [];
[0,1,2].forEach(function(i) {          // let's create 3 functions
    funcs[i] = function() {            // and store them in funcs
        console.log("My value: " + i); // each should log its value.
    };
})
for (var j = 0; j < 3; j++) {
    funcs[j]();                        // and now let's run each one to see
}
```

印刷：

> ```
> My value: 0
> My value: 1
> My value: 2 
> ```

* * *

## 回答 #13

> 赞同：33
> 
> 时间：2013-09-19T14:20:24.317

## 试试这个更短的

*   没有数组

*   没有额外的 for 循环

```
for (var i = 0; i < 3; i++) {
    createfunc(i)();
}

function createfunc(i) {
    return function(){console.log("My value: " + i);};
} 
```

[http://jsfiddle.net/7P6EN/](http://jsfiddle.net/7P6EN/)

* * *

## 回答 #14

> 赞同：30
> 
> 时间：2014-03-05T23:03:24.267

OP 显示的代码的主要问题是`i`直到第二个循环才被读取。为了演示，想象一下在代码中看到一个错误

```
funcs[i] = function() {            // and store them in funcs
    throw new Error("test");
    console.log("My value: " + i); // each should log its value.
}; 
```

`funcs[someIndex]`在执行之前实际上不会发生错误`()`。使用相同的逻辑，很明显，`i`直到此时也没有收集 的值。一旦原始循环完成，`i++`将导致条件失败和循环结束`i`的值。此时，is等时使用，评价时，每次为3-。`3``i < 3``i``3``funcs[someIndex]()``i`

要克服这一点，您必须`i`在遇到它时进行评估。请注意，这已经以`funcs[i]`（其中有 3 个唯一索引）的形式发生。有几种方法可以获取此值。一种是将其作为参数传递给函数，该函数已经在此处以多种方式显示。

另一种选择是构造一个能够关闭变量的函数对象。可以这样实现

***[`jsFiddle Demo`](http://jsfiddle.net/QcUjH/)***

```
funcs[i] = new function() {   
    var closedVariable = i;
    return function(){
        console.log("My value: " + closedVariable); 
    };
}; 
```

* * *

## 回答 #15

> 赞同：24
> 
> 时间：2016-12-07T17:33:27.453

JavaScript 函数在声明时“关闭”它们可以访问的范围，并且即使该范围内的变量发生变化，仍保留对该范围的访问。

```
var funcs = []

for (var i = 0; i < 3; i += 1) {
  funcs[i] = function () {
    console.log(i)
  }
}

for (var k = 0; k < 3; k += 1) {
  funcs[k]()
}
```

上面数组中的每个函数都关闭了全局范围（全局，仅仅是因为那恰好是它们声明的范围）。

`i`稍后调用这些函数，记录全局范围内的最新值。这就是关闭的魔力和挫败感。

**“JavaScript 函数在它们声明的范围内关闭，并保留对该范围的访问，即使该范围内的变量值发生变化。”**

使用`let`而不是`var`通过在每次`for`循环运行时创建一个新范围来解决这个问题，为每个函数创建一个单独的范围以关闭。各种其他技术通过额外的功能做同样的事情。

```
var funcs = []

for (let i = 0; i < 3; i += 1) {
  funcs[i] = function () {
    console.log(i)
  }
}

for (var k = 0; k < 3; k += 1) {
  funcs[k]()
}
```

（`let`使变量块作用域。块用花括号表示，但在 for 循环的情况下，初始化变量，`i`在我们的例子中，被认为是在花括号中声明的。）

* * *

## 回答 #16

> 赞同：15
> 
> 时间：2014-07-14T14:42:00.293

在阅读了各种解决方案之后，我想补充一点，这些解决方案起作用的原因是依赖于**范围链**的概念。这是 JavaScript 在执行期间解析变量的方式。

*   每个函数定义形成一个作用域，该作用域由`var`及其声明的所有局部变量组成`arguments`。
*   如果我们在另一个（外部）函数中定义了内部函数，这将形成一个链，并将在执行期间使用
*   **当一个函数被执行时，运行时通过搜索作用域链**来评估变量。如果可以在链的某个点找到变量，它将停止搜索并使用它，否则它会继续直到到达属于的全局范围`window`。

在初始代码中：

```
funcs = {};
for (var i = 0; i < 3; i++) {         
  funcs[i] = function inner() {        // function inner's scope contains nothing
    console.log("My value: " + i);    
  };
}
console.log(window.i)                  // test value 'i', print 3 
```

当`funcs`被执行时，作用域链将是`function inner -> global`. 由于`i`找不到变量`function inner`（既没有声明使用`var`也没有作为参数传递），它继续搜索，直到`i`最终在全局范围内找到`window.i`.

通过将它包装在一个外部函数中，或者显式定义一个像[harto那样的辅助函数，或者像](https://stackoverflow.com/a/750506)[Bjorn](https://stackoverflow.com/a/750495)那样使用一个匿名函数：

```
funcs = {};
function outer(i) {              // function outer's scope contains 'i'
  return function inner() {      // function inner, closure created
   console.log("My value: " + i);
  };
}
for (var i = 0; i < 3; i++) {
  funcs[i] = outer(i);
}
console.log(window.i)          // print 3 still 
```

当`funcs`被执行时，现在作用域链将是`function inner -> function outer`. 这个时间`i`可以在外部函数的作用域中找到，它在 for 循环中执行了 3 次，每次都有`i`正确绑定的值。它不会使用`window.i`内部执行时的值。

更多细节可以在[这里](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Closures)
找到 它包括在循环中创建闭包的常见错误，以及我们为什么需要闭包和性能考虑。

* * *

## 回答 #17

> 赞同：13
> 
> 时间：2016-11-07T11:25:54.803

使用 ES6 块级作用域的新特性进行管理：

```
var funcs = [];
for (let i = 0; i < 3; i++) {          // let's create 3 functions
    funcs[i] = function() {            // and store them in funcs
        console.log("My value: " + i); // each should log its value.
    };
}
for (let j = 0; j < 3; j++) {
    funcs[j]();                        // and now let's run each one to see
} 
```

OP 问题中的代码被替换为**[`let`](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/let)**而不是**`var`**.

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2014-12-09T22:24:17.963

我很惊讶没有人建议使用该`forEach`函数来更好地避免（重新）使用局部变量。事实上，出于这个原因，我根本`for(var i ...)`不再使用。

```
[0,2,3].forEach(function(i){ console.log('My value:', i); });
// My value: 0
// My value: 2
// My value: 3 
```

// 编辑为使用`forEach`而不是地图。

* * *

## 回答 #19

> 赞同：10
> 
> 时间：2018-01-13T13:17:57.497

这个问题真的展示了 JavaScript 的历史！现在我们可以避免使用箭头函数的块作用域，并使用 Object 方法直接从 DOM 节点处理循环。

```
const funcs = [1, 2, 3].map(i => () => console.log(i));
funcs.map(fn => fn())
```

```
const buttons = document.getElementsByTagName("button");
Object
  .keys(buttons)
  .map(i => buttons[i].addEventListener('click', () => console.log(i)));
```

```
<button>0</button><br>
<button>1</button><br>
<button>2</button>
```

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2009-04-15T06:18:29.510

您的原始示例不起作用的原因是您在循环中创建的所有闭包都引用了同一帧。实际上，在一个对象上只有一个`i`变量有 3 个方法。他们都打印出相同的值。

* * *

## 回答 #21

> 赞同：8
> 
> 时间：2016-11-04T07:46:07.800

首先，了解这段代码有什么问题：

```
var funcs = [];
for (var i = 0; i < 3; i++) {          // let's create 3 functions
    funcs[i] = function() {            // and store them in funcs
        console.log("My value: " + i); // each should log its value.
    };
}
for (var j = 0; j < 3; j++) {
    funcs[j]();                        // and now let's run each one to see
} 
```

这里当`funcs[]`数组被初始化时，`i`正在递增，`funcs`数组被初始化并且数组的大小`func`变为 3，所以`i = 3,`. 现在，当`funcs[j]()`调用 时，它再次使用`i`已经递增到 3 的变量。

现在要解决这个问题，我们有很多选择。以下是其中的两个：

1.  我们可以`i`用初始化`let`或初始化一个新变量`index`，`let`并使其等于`i`。因此，在进行调用时，`index`将使用，并且其范围将在初始化后结束。而对于调用，`index`将再次初始化：

    ```
    var funcs = [];
    for (var i = 0; i < 3; i++) {          
        let index = i;
        funcs[i] = function() {            
            console.log("My value: " + index); 
        };
    }
    for (var j = 0; j < 3; j++) {
        funcs[j]();                        
    } 
    ```

2.  其他选项可以是引入一个`tempFunc`返回实际函数的：

    ```
    var funcs = [];
    function tempFunc(i){
        return function(){
            console.log("My value: " + i);
        };
    }
    for (var i = 0; i < 3; i++) {  
        funcs[i] = tempFunc(i);                                     
    }
    for (var j = 0; j < 3; j++) {
        funcs[j]();                        
    } 
    ```

* * *

## 回答 #22

> 赞同：8
> 
> 时间：2017-01-20T10:02:32.720

使用[闭包](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)结构，这将减少你额外的 for 循环。您可以在单个 for 循环中执行此操作：

```
var funcs = [];
for (var i = 0; i < 3; i++) {     
  (funcs[i] = function() {         
    console.log("My value: " + i); 
  })(i);
} 
```

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2018-01-16T14:29:57.130

> 我们将逐一检查您声明`var`时实际发生的情况。`let`

## **案例1**：**使用`var`**

```
<script>
   var funcs = [];
   for (var i = 0; i < 3; i++) {
     funcs[i] = function () {
        debugger;
        console.log("My value: " + i);
     };
   }
   console.log(funcs);
</script> 
```

现在按**F12打开您的****chrome 控制台窗口**并刷新页面。在数组中展开每 3 个函数。您将看到一个名为.Expand 的属性。您将看到一个名为 的数组对象，展开该对象。您会发现在对象中声明的属性值为 3。**`[[Scopes]]``"Global"``'i'`**

 **[![在此处输入图像描述](https://i.stack.imgur.com/f6I2J.png)](https://i.stack.imgur.com/f6I2J.png)

[![在此处输入图像描述](https://i.stack.imgur.com/kF3Yv.png)](https://i.stack.imgur.com/kF3Yv.png)

**结论：**

1.  当您在函数外部使用声明变量时`'var'`，它成为全局变量（您可以通过键入`i`或 `window.i`在控制台窗口中检查。它将返回 3）。
2.  您声明的匿名函数不会调用并检查函数内部的值，除非您调用这些函数。
3.  当您调用函数时，`console.log("My value: " + i)`从其`Global`对象中获取值并显示结果。

## **案例2：使用让**

现在替换`'var'`为`'let'`

```
<script>
    var funcs = [];
    for (let i = 0; i < 3; i++) {
        funcs[i] = function () {
           debugger;
           console.log("My value: " + i);
        };
    }
    console.log(funcs);
</script> 
```

做同样的事情，转到范围。现在您将看到两个对象`"Block"`和`"Global"`。现在展开`Block`object ，你会看到 'i' 被定义在那里，奇怪的是，对于每个函数，if 的值`i`都是不同的 (0 , 1, 2)。

[![在此处输入图像描述](https://i.stack.imgur.com/HGqXU.png)](https://i.stack.imgur.com/HGqXU.png)

**结论：**

当你`'let'`在函数外而是在循环内声明变量时，这个变量将不是一个全局变量，它会变成一个`Block`级别变量，只对同一个函数可用。这就是原因，我们得到`i`不同的值对于我们调用函数时的每个函数。

有关更紧密的工作原理的更多详细信息，请观看精彩的视频教程[https://youtu.be/71AtaJpJHw0](https://youtu.be/71AtaJpJHw0)

* * *

## 回答 #24

> 赞同：6
> 
> 时间：2019-05-02T11:57:47.303

直到 ES5，这个问题只能使用**闭包**来解决。

但是现在在 ES6 中，我们有了块级作用域变量。**将var**更改为**let** in first **for 循环**将解决问题。

```
var funcs = [];
for (let i = 0; i < 3; i++) {      // let's create 3 functions
  funcs[i] = function() {          // and store them in funcs
    console.log("My value: " + i); // each should log its value.
  };
}
for (var j = 0; j < 3; j++) {
  funcs[j]();                      // and now let's run each one to see
}
```

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2019-09-21T21:34:44.720

`while`如果您遇到循环而不是循环的此类问题`for`，例如：

```
var i = 0;
while (i < 5) {
  setTimeout(function() {
    console.log(i);
  }, i * 1000);
  i++;
}
```

关闭当前值的技术有点不同。`const`在块内声明一个块范围的变量`while`，并将当前分配`i`给它。然后，在异步使用变量的地方，`i`用新的块范围变量替换：

```
var i = 0;
while (i < 5) {
  const thisIterationI = i;
  setTimeout(function() {
    console.log(thisIterationI);
  }, i * 1000);
  i++;
}
```

对于不支持块作用域变量的旧浏览器，您可以使用一个名为的 IIFE `i`：

```
var i = 0;
while (i < 5) {
  (function(innerI) {
    setTimeout(function() {
      console.log(innerI);
    }, innerI * 1000);
  })(i);
  i++;
}
```

如果要调用的异步动作恰好`setTimeout`如上，还可以`setTimeout`用*第三个*参数调用来表示调用传递函数的参数：

```
var i = 0;
while (i < 5) {
  setTimeout(
    (thisIterationI) => { // Callback
      console.log(thisIterationI);
    },
    i * 1000, // Delay
    i // Gets passed to the callback; becomes thisIterationI
  );
  i++;
}
```

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2015-06-17T12:02:42.773

您可以将声明性模块用于数据列表，例如[query-js](https://github.com/runefs/query-js) (*)。在这些情况下，我个人发现声明式方法不那么令人惊讶

```
var funcs = Query.range(0,3).each(function(i){
     return  function() {
        console.log("My value: " + i);
    };
}); 
```

然后，您可以使用第二个循环并获得预期的结果，或者您可以这样做

```
funcs.iterate(function(f){ f(); }); 
```

(*) 我是 query-js 的作者，因此偏向于使用它，所以不要将我的话作为对所述库的推荐，仅用于声明性方法:)

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2015-12-17T14:14:56.857

我更喜欢使用`forEach`函数，它有自己的闭包来创建伪范围：

```
var funcs = [];

new Array(3).fill(0).forEach(function (_, i) { // creating a range
    funcs[i] = function() {            
        // now i is safely incapsulated 
        console.log("My value: " + i);
    };
});

for (var j = 0; j < 3; j++) {
    funcs[j](); // 0, 1, 2
} 
```

这看起来比其他语言的范围更丑，但恕我直言，没有其他解决方案那么可怕。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2016-05-05T11:48:51.130

还有另一个解决方案：不要创建另一个循环，只需将 绑定`this`到返回函数。

```
var funcs = [];

function createFunc(i) {
  return function() {
    console.log('My value: ' + i); //log value of i.
  }.call(this);
}

for (var i = 1; i <= 5; i++) {  //5 functions
  funcs[i] = createFunc(i);     // call createFunc() i=5 times
}
```

通过绑定***this***，也可以解决问题。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2016-11-04T08:58:29.117

您的代码不起作用，因为它的作用是：

```
Create variable `funcs` and assign it an empty array;  
Loop from 0 up until it is less than 3 and assign it to variable `i`;
    Push to variable `funcs` next function:  
        // Only push (save), but don't execute
        **Write to console current value of variable `i`;**

// First loop has ended, i = 3;

Loop from 0 up until it is less than 3 and assign it to variable `j`;
    Call `j`-th function from variable `funcs`:  
        **Write to console current value of variable `i`;**  
        // Ask yourself NOW! What is the value of i? 
```

现在的问题是，`i`调用函数时变量的值是多少？因为第一个循环是用 的条件创建的`i < 3`，所以当条件为假时它会立即停止，所以它是`i = 3`。

你需要明白，当你的函数被创建时，它们的代码都不会被执行，它只是被保存以备后用。因此，当它们稍后被调用时，解释器会执行它们并询问：“当前的值是`i`多少？”

因此，您的目标是首先保存`i`to 函数的值，然后才将函数保存到`funcs`. 例如，这可以通过以下方式完成：

```
var funcs = [];
for (var i = 0; i < 3; i++) {          // let's create 3 functions
    funcs[i] = function(x) {            // and store them in funcs
        console.log("My value: " + x); // each should log its value.
    }.bind(null, i);
}
for (var j = 0; j < 3; j++) {
    funcs[j]();                        // and now let's run each one to see
} 
```

这样，每个函数都有自己的变量`x`，我们将其设置为每次迭代中`x`的值。`i`

这只是解决此问题的多种方法之一。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2017-02-28T15:09:04.190

许多解决方案似乎是正确的，但他们没有提到它被称为[`Currying`](https://www.sitepoint.com/currying-in-functional-javascript/)这是一种功能编程设计模式，适用于像这里这样的情况。比绑定快 3-10 倍，具体取决于浏览器。

```
var funcs = [];
for (var i = 0; i < 3; i++) {      // let's create 3 functions
  funcs[i] = curryShowValue(i);
}
for (var j = 0; j < 3; j++) {
  funcs[j]();                      // and now let's run each one to see
}

function curryShowValue(i) {
  return function showValue() {
    console.log("My value: " + i);
  }
} 
```

查看[不同浏览器的性能提升](https://jsperf.com/bind-vs-curry)。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2018-07-13T08:02:09.890

```
var funcs = [];
for (var i = 0; i < 3; i++) {      // let's create 3 functions
  funcs[i] = function(param) {          // and store them in funcs
    console.log("My value: " + param); // each should log its value.
  };
}
for (var j = 0; j < 3; j++) {
  funcs[j](j);                      // and now let's run each one to see with j
} 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2019-04-15T10:37:39.027

使用 let(blocked-scope) 代替 var。

```
var funcs = [];
for (let i = 0; i < 3; i++) {      
  funcs[i] = function() {          
    console.log("My value: " + i); 
  };
}
for (var j = 0; j < 3; j++) {
  funcs[j]();                      
}
```

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2015-05-06T22:33:08.577

这是异步代码经常遇到的问题，变量`i`是可变的，并且在进行函数调用时，使用的代码`i`将被执行并且`i`会变异为其最后一个值，因此意味着在循环中创建的所有函数都将创建一个[闭包](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)，将等于 3（循环`i`的上限 + 1 。`for`

一种解决方法是创建一个函数，该函数将保存`i`每次迭代的值并强制复制`i`（因为它是一个原语，如果对您有帮助，请将其视为快照）。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2017-07-17T10:10:55.673

**计数器是一个原始的**

让我们定义回调函数如下：

```
// ****************************
// COUNTER BEING A PRIMITIVE
// ****************************
function test1() {
    for (var i=0; i<2; i++) {
        setTimeout(function() {
            console.log(i);
        });
    }
}
test1();
// 2
// 2 
```

超时完成后，它将为两者打印 2。这是因为回调函数根据[词法范围](https://stackoverflow.com/q/1047454/7032856)访问值，它是定义函数的地方。

要在定义回调时传递和保留值，我们可以创建一个[闭包](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)，以在调用回调之前保留该值。这可以按如下方式完成：

```
function test2() {
    function sendRequest(i) {
        setTimeout(function() {
            console.log(i);
        });
    }

    for (var i = 0; i < 2; i++) {
        sendRequest(i);
    }
}
test2();
// 1
// 2 
```

现在它的特别之处在于“原语是按值传递并复制的。因此，当定义闭包时，它们会保留前一个循环的值。”

**计数器是一个对象**

由于闭包可以通过引用访问父函数变量，因此这种方法与原语不同。

```
// ****************************
// COUNTER BEING AN OBJECT
// ****************************
function test3() {
    var index = { i: 0 };
    for (index.i=0; index.i<2; index.i++) {
        setTimeout(function() {
            console.log('test3: ' + index.i);
        });
    }
}
test3();
// 2
// 2 
```

因此，即使为作为对象传递的变量创建了闭包，也不会保留循环索引的值。这是为了表明对象的值在通过引用访问时不会被复制。

```
function test4() {
    var index = { i: 0 };
    function sendRequest(index, i) {
        setTimeout(function() {
            console.log('index: ' + index);
            console.log('i: ' + i);
            console.log(index[i]);
        });
    }

    for (index.i=0; index.i<2; index.i++) {
        sendRequest(index, index.i);
    }
}
test4();
// index: { i: 2}
// 0
// undefined

// index: { i: 2}
// 1
// undefined 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2018-09-05T13:00:37.397

只需将 var 关键字更改为 let。

var 是函数范围的。

let 是块作用域。

当您开始编写代码时，for 循环将迭代并将 i 的值分配给 3，这将在整个代码中保持为 3。我建议您阅读有关节点范围的更多信息（let、var、const 等）

```
funcs = [];
for (let i = 0; i < 3; i++) {      // let's create 3 functions
  funcs[i] =async function() {          // and store them in funcs
    await console.log("My value: " + i); // each should log its value.
  };
}
for (var j = 0; j < 3; j++) {
  funcs[j]();                      // and now let's run each one to see
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2016-11-11T09:43:17.493

让我们利用[`new Function`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function). 因此`i`不再是[闭包](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)的变量，而只是文本的一部分：

```
var funcs = [];
for (var i = 0; i < 3; i++) {
    var functionBody = 'console.log("My value: ' + i + '");';
    funcs[i] = new Function(functionBody);
}

for (var j = 0; j < 3; j++) {
    funcs[j]();
} 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2018-02-25T03:15:21.233

虽然这个问题很老并且已经回答，但我还有另一个相当有趣的解决方案：

```
var funcs = [];

for (var i = 0; i < 3; i++) {     
  funcs[i] = function() {          
    console.log("My value: " + i); 
 };
}

for (var i = 0; i < 3; i++) {
  funcs[i]();
} 
```

变化是如此之小，几乎很难看出我做了什么。我将第二个迭代器从 aj 切换到 i。这会以某种方式及时刷新 i 的状态，从而为您提供所需的结果。我这样做是偶然的，但考虑到以前的答案是有道理的。

我写这篇文章是为了指出这个很小但非常重要的区别。希望这有助于消除像我这样的其他学习者的一些困惑。

注意：我没有分享这个，因为我认为这是正确的答案。这是一个脆弱的解决方案，在某些情况下可能会中断。实际上，我很惊讶它真的有效。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2018-03-14T06:19:14.140

假设你不使用 es6；您可以使用 IFFY 功能：

```
var funcs = [];
for (var i = 0; i < 13; i++) {      
funcs[i] = (function(x) {
console.log("My value: " + i)})(i);} 
```

但它会有所不同。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2018-03-28T20:15:11.983

行。我通读了所有的答案。即使这里有一个很好的解释——我就是无法让它发挥作用。于是我就去网上找了。[https://dzone.com/articles/why-does-javascript-loop-only-use-last-value](https://dzone.com/articles/why-does-javascript-loop-only-use-last-value)的人有一个未在此处提供的答案。所以我想我会发布一个简短的例子。这对我来说更有意义。

总而言之，LET 命令很好，但现在才被使用。然而，LET 命令实际上只是一个 TRY-CATCH 组合。这可以一直追溯到 IE3（我相信）。使用 TRY-CATCH 组合 - 生活简单而美好。可能是 EMCScript 人决定使用它的原因。它也不需要 setTimeout() 函数。所以没有时间浪费。基本上，每个 FOR 循环都需要一个 TRY-CATCH 组合。这是一个例子：

```
 for( var i in myArray ){
       try{ throw i }
       catch(ii){
// Do whatever it is you want to do with ii
          }
       } 
```

如果您有多个 FOR 循环，则只需为每个循环放置一个 TRY-CATCH 组合。另外，就个人而言，我总是使用我正在使用的任何 FOR 变量的双字母。所以“ii”代表“i”等等。我在例程中使用此技术将鼠标悬停命令发送到不同的例程。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2018-08-01T09:32:05.987

这证明了关于“闭包”和“非闭包”如何工作的 JavaScript 是多么丑陋。

如果是：

```
var funcs = [];

for (var i = 0; i < 3; i++) {      // let's create 3 functions
  funcs[i] = function() {          // and store them in funcs
    console.log("My value: " + i); // each should log its value.
  };
} 
```

funcs[i] 是一个全局函数，'console.log("My value: " + i);' 正在打印全局变量 i

如果是

```
var funcs = [];

function createfunc(i) {
    return function() { console.log("My value: " + i); };
}

for (var i = 0; i < 3; i++) {
    funcs[i] = createfunc(i);
} 
```

由于 javascript 的这种扭曲的封闭设计，'console.log("My value: " + i);' 正在从外部函数“createfunc(i)”打印 i

这一切都是因为 javascript 不能像 C 编程语言那样在函数中设计像“静态”变量这样的体面的东西！

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2019-04-07T16:45:19.850

```
 asyncIterable = [1,2,3,4,5,6,7,8];

  (async function() {
       for await (let num of asyncIterable) {
         console.log(num);
       }
    })(); 
```

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2018-05-25T00:18:33.080

为什么不直接在创建后的第一个（也是唯一一个）循环中调用每个函数，例如：

```
 var funcs = [];
    for (var i = 0; i < 3; i++) {
    // let's create 3 functions
    funcs[i] = function() {
    // and store them in funcs
    console.log("My value: " + i); // each should log its value.
    };
    funcs[i]();// and now let's run each one to see
    } 
```

* * *

## 回答 #43

> 赞同：-1
> 
> 时间：2019-04-17T08:10:22.780

在 的支持下，最好的方法是针对这种情况`ES6`使用`let`和关键字。`const`所以`var`变量 get`hoisted`并且随着循环的结束，`i`所有...的值都会更新`closures`，我们可以使用`let`这样设置循环范围变量：

```
var funcs = [];
for (let i = 0; i < 3; i++) {          
    funcs[i] = function() {            
      console.log("My value: " + i); 
    };
} 
```

* * *

## 回答 #44

> 赞同：-2
> 
> 时间：2017-10-13T08:53:18.510

这个问题已经有很多有效的答案了。不过，使用函数式方法的人并不多。这是使用该`forEach`方法的替代解决方案，它适用于回调和闭包：

`let arr = [1,2,3];`

`let myFunc = (val, index) => { console.log('val: '+val+'\nindex: '+index); };`

`arr.forEach(myFunc);`

# java - getWriter() 如何在 HttpServletResponse 中起作用？

> ID：750488
> 
> 赞同：9
> 
> 时间：2009-04-15T06:07:23.093
> 
> 标签：java, servlets

在该方法`service()`中，我们使用

```
PrintWriter out = res.getWriter(); 
```

请告诉我它如何返回`PrintWriter`类对象，然后连接到浏览器并将数据发送到浏览器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T06:13:20.490

它没有连接到浏览*器*- 浏览器已经连接到服务器。它要么缓冲您在内存中写入的内容，然后在请求结束时传输数据，要么确保所有标头都已写入网络连接，然后返回`PrintWriter`将数据直接写入该网络连接的 a。

在缓冲场景中，可能有一个固定的缓冲区大小，如果超过这个值，到目前为止写入的数据将被“刷新”到网络连接。完全拥有缓冲区的最大优势是，如果中途出现问题，您可以更改对错误页面的响应。如果您在出现问题时已经开始编写响应，那么您可以做很多事情来清楚地指出错误。

（还有在任何内容之前传输内容长度的问题，以保持连接。如果您在完成响应之前用完缓冲区，我可靠地被告知响应将使用分块编码。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T11:16:19.713

一个相当简单的实现：

```
PrintWriter getWriter() throws java.io.IOException {
      return new PrintWriter(socket.getOutputStream());
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-15T08:11:24.870

另请注意，有几个可用的 Servlet API 开源实现。这使您可以看到它是如何完成的。

我相信官方实现也是开源的，并且包含在 Glassfish 服务器中。

# iphone - 是否可以在 iPhone 上流式传输 mms、ASX、RTSP 流？

> ID：750501
> 
> 赞同：7
> 
> 时间：2009-04-15T06:13:41.797
> 
> 标签：iphone, stream, core-audio, asx

我正在开发一个音乐流媒体应用程序。

[我可以使用此处](https://stackoverflow.com/questions/384900/streaming-audio-from-server-to-iphone)描述的方法流式传输 mp3 。有谁知道使用 Core Audio 或其他框架流式传输其他格式（ASX、RTSP 或 mms）的方法。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T23:05:20.710

mms、ASX 和 RTSP 在历史上是一些专有协议（特别是由 microsoft 和 real 提供），因此您可能很难找到官方的 Apple 实现。

这里有一个 mms 协议的 LGPL 实现：[https](https://launchpad.net/libmms) ://launchpad.net/libmms 或者您可以在此处从 microsoft 获取该协议的文档：http: [//download.microsoft.com/download/9/5/E/ 95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5BMS-MMSP%5D.pdf](http://download.microsoft.com/download/9/5/E/95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5BMS-MMSP%5D.pdf)

ASX 只是 XML 中的一种元数据格式；您将使用它来获取要从中流式传输的 mms 或 http URL。它的官方参考在微软的网站上：http: [//msdn.microsoft.com/en-us/library/bb249663.aspx](http://msdn.microsoft.com/en-us/library/bb249663.aspx)

RTSP 在这里有一个 LGPL 实现：[http](http://www.live555.com/liveMedia/) ://www.live555.com/liveMedia/ 这是一个标准协议（[RFC 2326](https://www.rfc-editor.org/rfc/rfc2326)和[RFC 3550](https://www.rfc-editor.org/rfc/rfc3550)），但显然经常与 Real 的 RDT 传输等专有扩展一起使用，所以它可能更容易如果可以的话，只使用图书馆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-10T01:43:12.273

FStream 适用于音频。您还可以使用 Streamer 进行视频流式传输。这是一个很好的应用程序，只是它根本不友好。在您的收藏夹中键入 URI mms://server/。然后点击它。你会发现一个按钮，上面写着：“暂停”。再次单击以阅读：“取消暂停”。然后等待 10-15 秒，然后视频将开始流式传输。确保您选择了一个您知道肯定有效的 URI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-11T23:25:09.997

试试可以处理 mms、asf、wmv、asx 和 ogg的免费 FStream iPhone 应用程序[http://www.sourcemac.com/?page=fstream](http://www.sourcemac.com/?page=fstream)

# php - 构建广泛的基于谷歌地图的应用程序

> ID：750503
> 
> 赞同：1
> 
> 时间：2009-04-15T06:16:49.467
> 
> 标签：php, javascript, google-maps

我现在在谷歌地图上工作，我正在尝试构建一些不是那么广泛的东西，而是像[http://wikimapia.org/](http://wikimapia.org/)那样的东西。好的，我不会构建整个应用程序，我手上没有那么多时间。但是，我正在开发的应用程序有用户注册，他们将能够在谷歌地图上定位和创建位置，这些位置将存储在我的后端数据库中。

此外，还有一个搜索选项，用户可以搜索特定地点，所有匹配条目列表将显示为地图的“覆盖”，所有地点都将在地图上突出显示。

此外，如果您注意到 wikimapia 的工作原理 - 您可以通过虚拟单击并拖动地图本身来添加地点，而不是在某些复杂的表格上添加坐标，并且搜索嵌入在地图中而不是在地图之外。

现在我有了一个整合基本谷歌地图的想法——没什么大不了的，但这不仅仅是一个简单的整合过程。有谁知道我需要在这里做什么。

我正在研究 Php 并使用 JQuery 进行 javascripting。

* * *

感谢您的回复 - 但是我的查询在这方面有所不同，因为我的应用程序是这样的，我们会让用户注册，他们会来点点并在地图上创建新位置，所以基本上它不是一个用户 - 所有坐标都会由用户以“在地图上单击您的位置”的方式输入，我们希望能够在地图上覆盖所有这些细节以及分类，比如让我们说 - 显示地图上的所有地方生日聚会，或在地图上显示所有网吧 - 即所有这些细节都是由用户输入的。

也许我在这里遗漏了一些东西 - 但我希望在这里制作一个简化的 wikimapia 淡化版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T06:28:33.120

如果您想与 Google Maps 集成，我认为最好的起点是来源：[http](http://code.google.com/apis/maps/) ://code.google.com/apis/maps/ ，特别是文档和 API 参考。给自己一把钥匙，将其中一个示例放入您的页面并开始调整。

对于您的观点，您基本上将存储坐标信息（纬度/经度），以及您想要显示的任何信息。您甚至可以拥有自定义地图图块（世界图片），或自定义地图叠加图块（显示世界的透明添加）。它确实是一个非常灵活的用于映射事物的 API。

当您遇到特定问题时，请询问。

# com - 如何在 C# 中使用 com dll 中的方法？

> ID：750511
> 
> 赞同：0
> 
> 时间：2009-04-15T06:23:01.247
> 
> 标签：com, dll

如何在 C# 中使用 com dll 中的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T06:24:41.367

[从 C# 访问 COM 对象的最佳方法](https://stackoverflow.com/questions/635839/best-way-to-access-com-objects-from-c)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T06:24:59.993

添加对 com dll 的引用，.net 将自动提供一个包装类，通过使用它，您可以调用 dll 中的函数。

# iphone - 是否可以在 iPhone 中缓存 UIWebView？

> ID：750522
> 
> 赞同：2
> 
> 时间：2009-04-15T06:27:02.453
> 
> 标签：iphone, caching

我正在使用 NYTimes iPhone 应用程序，当我注意到它缓存 UIwebview 即使我没有打开那篇文章时，我变得有点好奇。有人知道该怎么做吗？

NYTimes iPhone 应用程序如何进行离线阅读？

非常感谢任何帮助。

谢谢，

阿米特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-11-24T00:46:00.477

我编写了《纽约时报》应用程序。以下是您可以通过查看应用程序包获得的一些详细信息。

我下载了文章的 HTML，去掉了生产者塞进其中的任何不受支持的 HTML 和 JS 杂物，并将其缓存在后备存储中。

文章内容包含在一系列 P 标签（HTML 片段）中。我将其填充到应用程序附带的特殊 HTML 框架页面中。静态包装页面还包含用于正确显示文章和延迟加载图像的 CSS 和 JS。

图像加载真的很酷。当图像准备好时，Web 视图会收到通知。布局不受影响，因为我已经知道丢失图像的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T08:11:45.570

您可以使用 UIWebView 加载本地存储在 iPhone 上的 html 文件。

NYTimes 应用程序可能正在本地存储中缓存 html 和图像。

在谷歌上搜索“UIWebView local”，你会得到几个有用的结果。

我试过了，效果很好：

* * *

首先，创建一个“基于视图的应用程序”并将一个 UIWebView 添加到 NIB。

其次，将此代码添加到您的 UIViewController 代码中：

```
- (void)viewDidLoad 
{

    NSString *path = [[NSBundle mainBundle] pathForResource:@"index" ofType:@"html"];
    NSURL *url = [NSURL fileURLWithPath:path isDirectory:NO];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];

    [webView loadRequest:request];

    [super viewDidLoad];
} 
```

第三，在 xcode 中的“Resources”文件夹中添加一个名为“index.html”的文件，它将显示出来。

**更新：**

实际上，其中复杂的部分是下载网页的图像和样式表。[使用Simple HTML Parser](http://simplehtmldom.sourceforge.net/)（和 PHP）很容易做到这一点。只需将所有内容打包成一个 zip 并下载到您的 iPhone。

或者，您可以使用 C/C++/OBJC HTML 解析器在本地执行此操作（libxml2.2 在 iOS 上可用）。请参阅此 SO 问题[Parsing HTML on the iPhone](https://stackoverflow.com/questions/405749/parsing-html-on-the-iphone)。

这将是一个项目，祝你好运。

# javascript - Firefox 扩展中的 Google 搜索 API

> ID：750523
> 
> 赞同：2
> 
> 时间：2009-04-15T06:27:11.080
> 
> 标签：javascript, import, firefox-addon

我正在开发一个 firefox 扩展，我需要包含 Google Search API。但我在 google.load('search','1') 行中遇到错误。谁能告诉问题是什么

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T13:00:43.080

我有同样的问题，但根据我在 Google 的 JS 代码中看到的内容，它尝试将变量 'google' 添加到**window**，但是在还没有窗口时加载了扩展！所以不会有全局**google**变量，因此当您尝试触发 google.load() 时会发生错误。我认为解决方案是动态加载脚本。我刚刚找到了一个现有的音译插件：

https://addons.mozilla.org/pl/firefox/addon/8960

看看他们是如何解决问题的：

```
onPageLoad: function(event) {
var doc = event.originalTarget;
var ele = doc.createElement('script');
ele.setAttribute('type', 'text/javascript');
ele.setAttribute('src', 'h t t p : / / www.google.com/jsapi?key=internal'); 
```

}

onPageLoad 是在 DOMContentLoaded 事件发生时加载的，所以当页面的整个树被加载时（看起来它是一个相当于 onLoad 的 DOM）

（请原谅我在链接中插入空格，否则我将不被允许发布它们：]）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T06:43:05.533

如果您已经收集了所有 JavaScript 文件并将它们与您的 Firefox 扩展程序打包在本地，并且 google 的加载功能是为从服务器加载 JavaScript 而设计的，那么您的问题是您不能使用该库中的加载机制。而是使用 Components.utils.import 或 mozIJSSubScriptLoader，具体取决于您所针对的 Firefox 版本。

这可能需要编辑、扩展或覆盖 Google 库中的代码。

# performance - 为什么我的网站需要这么多时间来渲染？

> ID：750531
> 
> 赞同：1
> 
> 时间：2009-04-15T06:31:09.603
> 
> 标签：performance, firebug, website-metrics

缓存后，我的起始页面只需要加载一个元素（“根文档”） - 但它需要一些时间才能完全呈现：

[替代文字 http://www.walkner.biz/_temp/firebug_net.png](http://www.walkner.biz/_temp/firebug_net.png)

以下元素是通过 JavaScript 异步加载的内容。

两个问题：

1.  为什么从加载根文档到 DomContentLoaded 事件需要这么“长时间”？
2.  异步加载一些不那么重要的东西有意义吗？尽早拥有 DmoContentLoaded 事件是否重要？不幸的是，关于该事件的文档并不多，但我认为这不是显示页面的那一刻，是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T07:10:06.140

我不确定 YSlow 是否会帮助他，因为它会下载页面的所有元素并对其运行性能测试，而 swalkner 的问题是当所有其他元素（图像、CSS、等）被缓存。

至少我认为他是这么说的。

在您说的原始问题中，“以下元素是通过 JavaScript 异步加载的内容。” 但后来什么也没列出。加载了什么？

我建议首先检查 Javascript 错误。然后尝试一一删除一些异步加载调用，直到遇到瓶颈。事实上，把它们都去掉，下载的 HTML 需要多长时间才能渲染？花点时间从那里开始工作。

你的 HTML 文件很大吗？它是否使用了许多可能在 CSS 文件中的内联样式？

也许如果您发布了指向该站点的链接，那么人们会查看它。

# c# - 确保两个 char 数组不相同

> ID：750535
> 
> 赞同：1
> 
> 时间：2009-04-15T06:35:36.050
> 
> 标签：c#, .net

我随机生成一个字符网格并将其存储在一个 char[,] 数组中......

我需要一种方法来确保在将网格以二进制格式序列化到数据库之前我还没有生成网格……基于字节比较两个网格的最佳方法是什么？我要做的最后一件事是遍历它们的内容，因为我已经以字节形式从数据库中提取其中一个。

我在考虑校验和，但不确定这是否可行。

```
char[,] grid = new char[8,8];
char[,] secondgrid = new char[8,8];//gets its data from db 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T06:41:51.683

据我所知，您将*不得不*遍历内容（或至少是其中的一部分）；没有其他方法可以谈论数组内容。

好吧，作为一个快速的“绝对不一样”，您可以计算数组上的散列 - 即类似于：

```
 int hash = 7;
    foreach (char c in data) {
        hash = (hash * 17) + c.GetHashCode();
    } 
```

这有一些误报的风险（当它是唯一的时报告一个重复），但在其他方面非常便宜。有什么用？您可以将散列与数据库中的数据一起存储以允许快速检查 - 但如果这样做，您应该选择自己的散列算法`char`（因为不能保证保持不变） - 也许只需转换为 int，对于示例 - 或重新使用现有的实现：

```
 int hash = 7;
    foreach (char c in data) {
        hash = (hash * 17) + (c | (c << 0x10));
    } 
```

* * *

顺便说一句 - 对于 8x8，您总是可以只考虑 64 个字符的字符串，然后检查`==`. 这在数据库和应用程序中同样适用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T07:12:36.430

你不能让数据库来做吗？使网格列唯一。然后，如果您需要检测是否生成了重复的网格，执行此操作的方法可能涉及检查受操作影响的行数，或者可能测试错误。

此外，如果只是从 [0, 255] 中随机挑选每个字节，那么执行散列以获得 4 字节数字并不比从网格中取出前四个字节更好。碰撞的几率是一样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T06:44:40.320

我会使用校验和/哈希机制来捕获大部分匹配，然后在匹配时进行完整比较。

用于填充网格的字符范围是多少？如果您只使用字母（不混合大小写，或大小写不重要）和 8x8 网格，那么假设散列良好，您只是在问题空间内谈论每个项目可能发生 7 次左右的冲突（非常罕见的情况）功能。您可以执行以下操作：

1.  生成网格
2.  从数据库加载任何匹配的网格
3.  如果从 #2 中找到匹配项，则转到 1
4.  使用你的新网格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T12:56:41.893

试试这个（为每个矩阵调用 ComputeHash 并比较 guid）：

```
private static MD5 md5 = MD5.Create();
public static Guid ComputeHash(object value)
{
    Guid g = Guid.Empty;
    BinaryFormatter bf = new BinaryFormatter();
    using (MemoryStream stm = new MemoryStream())
    {
        bf.Serialize(stm, value);
        g = new Guid(md5.ComputeHash(stm.ToArray()));
        stm.Close();
    }
    return g;
} 
```

注意：生成字节数组可能会简单得多，因为您有一个 char 数组。

# c# - 在 c# 中将参数传递给 System.EventHandler

> ID：750541
> 
> 赞同：5
> 
> 时间：2009-04-15T06:41:43.400
> 
> 标签：c#

由于谷歌在过去 5-10 分钟内让我失望了，我有一个快速的问题。我希望将参数值传递给我从 button.click 事件处理程序调用的函数。该事件当前是使用添加的

```
MyButton.Click = new System.EventHandler(MyButton_click); 
```

但我希望函数接收：

```
private void MyButton_click(int ID)
{
...
} 
```

如何更改我的 EventHandler 声明以便完成此操作？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-15T06:44:37.653

`Button.Click`是按原样定义的，没有办法改变它。然而，

```
myButton.Click += delegate { MyButton_click(1); } 
```

将完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T06:45:10.070

您可以使用[CommandArgument 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.commandargument.aspx)，然后将事件处理程序中的发送方转换为 Button 类型以获取 CommandArgument 值

# ajax - MVC - 使用 Ajax 渲染局部视图

> ID：750543
> 
> 赞同：11
> 
> 时间：2009-04-15T06:42:07.503
> 
> 标签：ajax, asp.net-mvc, asp.net-mvc-partialview

我在 MVC 应用程序中有这个标记。

```
<div id="ingredientlistdiv">
    <% Recipe recipe = (Recipe)Model; %>
    <% Html.RenderPartial("IngredientsListControl", recipe.Ingredients); %>
</div>

<div id="ingrediententrydiv" align="left">
    <% using (Ajax.BeginForm("Add Ingredient", "Recipes/UpdateStep2", new AjaxOptions { UpdateTargetId = "ingredientlistdiv" }))
       { %>
    <p>
        <label for="Units">Units:</label><br />
        <%= Html.TextBox("Units", 0)%>
        <%= Html.ValidationMessage("Units", "*")%>
    </p>
    <p>
        <label for="Measure">Measure:</label><br />
        <%= Html.TextBox("Measure")%>
        <%= Html.ValidationMessage("Measure", "*")%>
    </p>
    <p>
        <label for="IngredientName">Ingredient Name:</label><br />
        <%= Html.TextBox("IngredientName")%>
        <%= Html.ValidationMessage("IngredientName", "*")%>
    </p>
    <p><a href="javascript:document.forms[0].submit()">Save Ingredient</a></p>
    <%= Html.Hidden("RecipeID", recipe.RecipeID.ToString())%>
    <% } %>
</div> 
```

当它运行时，IngredientsListControl.ascx 在浏览器中显示为一个新页面，并且不更新成分列表div。

这是我的控制器动作

```
[AcceptVerbs(HttpVerbs.Post)]
        public ActionResult UpdateStep2(FormCollection form)
        {
            var factory = SessionFactoryCreator.Create();

            using (var session = factory.OpenSession())
            {
                Recipe recipe = GetRecipe(session, Convert.ToInt32(form["RecipeID"]));

                Ingredient ingredient = new Ingredient();

                ingredient.UpdateFromForm(form);
                ingredient.Validate(ViewData);

                if (ViewData.ModelState.Count == 0)
                {
                    recipe.Ingredients.Add(ingredient);
                    session.Save(recipe);
                    return PartialView("IngredientsListControl", recipe.Ingredients);
                }

                return Content("Error");
            }
        } 
```

我在这条线上做对了吗？

```
return PartialView("IngredientsListControl", recipe.Ingredients); 
```

这就是我将控件呈现到 div 中的方式，因此它不会加载新页面。？？？

马尔科姆

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-07-12T11:12:24.537

当你使用这个：

```
<a href="javascript:document.forms[0].submit()"> 
```

...您应该知道它与

```
<input type="submit" /> 
```

它不会引发 onsubmit 事件，并且不会调用 MVC 的 AJAX 事件处理程序。

要确认这是问题，请添加

```
<input type="submit" /> 
```

在表格内并尝试一下。

最后，只需从您的链接中调用 onsubmit()

```
<a href="#" onclick="document.forms[0].onsubmit()"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:55:44.700

可能值得确保您在页面（母版页）中正确引用了 ajaxmvc 和 jquery 脚本。如果这些不正确，将显示一个新页面，而不是目标 div 中的正确输出。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-18T06:11:27.970

RenderPartial 采用动作名称，而不是用户控件的名称，因此将“IngredientsListControl”替换为“UpdateStep2”，即您的动作名称。

# java - StringTokenizer - 第一个字符串？

> ID：750557
> 
> 赞同：0
> 
> 时间：2009-04-15T06:47:53.573
> 
> 标签：java

我有这段代码来解析 url 字符串，例如“？var = val”，但是当“搜索”只是“var = val”时，这段代码失败了，如何让“var = val”也能正常工作？

```
 StringTokenizer st1 =
    new StringTokenizer(search, "?&;");
    while(st1.hasMoreTokens()){
        String st2= st1.nextToken();

        int ii = st2.indexOf("=");
        if (ii > 0) {
            int ib = st2.length();
            myparms.put( st2.substring(0,ii) , st2.substring(ii+1,ib) );
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T06:53:37.460

作为旁注，`StringTokenizer`已被弃用，现在仅作为遗留类包含，您应该查看[`String.split()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#split(java.lang.String)).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T06:50:11.353

```
 if (search.charAt(0)!= '?') search = "?"+search; 
```

# sql - 从 Excel 工作表将数据写回 SQL

> ID：750565
> 
> 赞同：16
> 
> 时间：2009-04-15T06:51:25.967
> 
> 标签：sql, excel

我知道可以将数据从 SQL 数据库获取到 Excel 工作表中，但我正在寻找一种方法来编辑 Excel 中的数据，并在编辑后将其写回 SQL 数据库。

看来这不是excel中的功能，谷歌并没有想出太多有用的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T20:20:28.833

如果您想让 Excel 文件完成所有工作（从数据库中检索；操作；更新数据库），那么您可以查看 ActiveX 数据对象 (ADO)。您可以在以下位置获得概览：

[http://msdn.microsoft.com/en-us/library/ms680928(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms680928(VS.85).aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T06:57:48.930

您需要 SQL Management Studio 中的导入/导出向导。根据您使用的 SQL Server 版本，打开 SSMS（连接到您想要的 SQL 实例），右键单击您要导入的数据库并选择任务..“导入数据”。

在向导中，单击下一步（经过介绍屏幕）并从数据源下拉列表中选择“Microsoft Excel”。您指定 Excel 电子表格的路径和文件名，无论您是否有列标题。然后按下一步。只需按照向导完成，它将设置目标（可以是 SQL Server 或其他目标）等。

[SQL Server 联机丛书和](http://msdn.microsoft.com/en-us/library/ms188032.aspx)[MSDN](http://msdn.microsoft.com/en-us/library/ms141209.aspx)的更多内容（演练）中提供了此过程的帮助。

如果您需要一些可部署/更强大（或更少向导驱动）的东西，那么您需要查看 SQL Server Integration Services（以获得更多“企业”和安全意识的方法）。不过，对于您想要完成的事情来说，这可能有点过头了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-17T13:35:38.487

有一个名为“MySQL for Excel”的新 Excel 插件：[http ://www.mysql.com/why-mysql/windows/](http://www.mysql.com/why-mysql/windows/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-03-15T01:08:16.720

我只是需要这样做，而这个线程已经安静了很长时间，所以我认为提供最近的数据点可能很有用。

在我的申请中，巡回销售人员使用 Excel 工作簿的副本来跟踪潜在客户通过贷款申请的进度。应用程序的当前阶段需要自动保存回远程 SQL 数据库，以便我们可以对其运行报告。

*从 Excel 更新数据库的拒绝方法：*

**SSIS**和**OpenRowSet**都是允许 SQL Server 从 Excel 中提取数据的方法，当 Excel 工作簿位于用户计算机上未定义的位置时效果不佳，当然当工作簿当前在 Excel 中打开时也不能很好地工作.

**ADO**现在即使没有真正被弃用，但看起来很长。此外，我希望解决方案在面对可能未连接到互联网的用户时保持稳健。

我还考虑在目标服务器上运行**Web API 。**Excel 工作簿中的宏连接到 Web API 以传输数据。但是，有时允许 Web API 与外界对话会很痛苦。此外，在互联网连接暂时中断的情况下，使其健壮的代码是痛苦的。

*采用的解决方案：*

我计划采用的解决方案是低技术含量的：**电子邮件**。Excel 将数据通过电子邮件发送到 Exchange 服务器上托管的地址。公司中的每个人都安装了 Outlook，因此电子邮件是通过以编程方式将它们添加到 Outlook 发件箱来发送的。Outlook 可以很好地处理用户离线时的情况。在服务器端，由任务计划程序定期启动的自定义 C# 可执行文件轮询收件箱并处理电子邮件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-30T06:15:58.460

您可以尝试使用这些加载项：

www.QueryCell.com（我创建了这个） www.SQLDrill.com www.Excel-DB.net

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T06:59:23.780

您可以使用 OPENROWSET 函数从 T-SQL 脚本操作 Excel 数据。示例用法是：

UPDATE OPENROWSET('Microsoft.Jet.OLEDB.4.0', 'Excel 8.0;DATABASE=c:\MySpreadsheet.xls', 'Select * from MyTable') SET Field1='Value1' WHERE Field2 = 'Value2'

# oracle - 动态 PL/SQL

> ID：750571
> 
> 赞同：0
> 
> 时间：2009-04-15T06:54:10.297
> 
> 标签：oracle, plsql

在 PL/SQL 中，我想将源模式和目标模式作为参数传递给存储过程。对于源，我们可以使用：

```
PROCEDURE select_from_schema( the_schema VARCHAR2)
IS
  TYPE my_cursor_type IS REF CURSOR;
  my_cursor  my_cursor_type;
BEGIN
  OPEN my_cursor FOR 'SELECT my_field FROM '||the_schema||'.my_table';

  -- Do your FETCHes just as with a normal cursor

  CLOSE my_cursor;
END; 
```

对于目标插入或更新语句，我们如何在该插入或更新语句中使用该模式....有谁知道我该怎么做？？？

PS对不起；我是初学者，必须快速编写一些函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T00:13:28.867

您可以对 INSERT 或 UPDATE 执行与 SELECT 相同的操作 - 使用如下动态 SQL：

`EXECUTE IMMEDIATE 'INSERT INTO '||target_schema||'.my_table (col1,col2...) VALUES(:val1, :val2...)' USING my_row.col1, my_row.col2...;`

# excel - Excel 智能标签

> ID：750572
> 
> 赞同：0
> 
> 时间：2009-04-15T06:56:09.450
> 
> 标签：excel, smart-tags

有人可以为我指出一个在 Visual Studio 中实现 Excel 智能标签的好教程吗？使用 C# 或 VB.NET。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T07:09:35.033

您需要 VSTO 才能减轻痛苦。更多[在这里](http://blogs.msdn.com/pstubbs/archive/2005/02/08/369245.aspx)

# c# - 如何在 C# 中获取可用或使用的内存

> ID：750574
> 
> 赞同：159
> 
> 时间：2009-04-15T06:57:00.400
> 
> 标签：c#, memory-management

如何获取应用程序使用的可用 RAM 或内存？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-04-15T07:05:33.437

您可以使用：

```
Process proc = Process.GetCurrentProcess(); 
```

要获取当前进程并使用：

```
proc.PrivateMemorySize64; 
```

获取私有内存使用情况。有关更多信息，请查看[此链接](https://msdn.microsoft.com/en-us/library/system.diagnostics.process.privatememorysize64(v=vs.110).aspx)。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-04-15T07:05:59.347

您可能需要检查[GC.GetTotalMemory](http://msdn.microsoft.com/en-us/library/system.gc.gettotalmemory.aspx)方法。

它检索当前认为由垃圾收集器分配的字节数。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-04-15T07:03:15.610

[System.Environment](http://msdn.microsoft.com/en-us/library/system.environment.aspx)具有[WorkingSet](http://msdn.microsoft.com/en-us/library/system.environment.workingset.aspx) - 一个 64 位有符号整数，包含映射到进程上下文的物理内存字节数。

在 .NET Core 3.0 及更高版本（也称为 .NET 5 及更高版本）中，您可以使用[`GC.GetGCMemoryInfo`](https://docs.microsoft.com/dotnet/api/system.gc.getgcmemoryinfo)来获取有关 GC 堆使用的内存以及 GC 认为可用的内存量的信息。.NET 在内部[使用此数据](https://github.com/dotnet/runtime/blob/a891aed8e03a225d8b31bbea0ae1a86972adc819/src/libraries/System.Private.CoreLib/src/System/Buffers/Utilities.cs#L38)来计算内存压力。内存压力[用于](https://github.com/dotnet/runtime/blob/a891aed8e03a225d8b31bbea0ae1a86972adc819/src/libraries/System.Private.CoreLib/src/System/Buffers/TlsOverPerCoreLockedStacksArrayPool.cs#L190)决定何时修剪 System.Buffers.ArrayPool。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-10-26T16:29:46.837

除了[@JesperFyhrKnudsen](https://stackoverflow.com/a/750595/1766014)的回答和[@MathiasLykkegaardLorenzen](https://stackoverflow.com/users/553609/mathias-lykkegaard-lorenzen)的评论，您最好在使用后`dispose`返回`Process`。

因此，为了处理`Process`，您可以将其包装在`using`范围内或调用`Dispose`返回的进程（`proc`变量）。

1.  `using`范围：

    ```
    var memory = 0.0;
    using (Process proc = Process.GetCurrentProcess())
    {
        // The proc.PrivateMemorySize64 will returns the private memory usage in byte.
        // Would like to Convert it to Megabyte? divide it by 2^20
           memory = proc.PrivateMemorySize64 / (1024*1024);
    } 
    ```

2.  或`Dispose`方法：

    ```
    var memory = 0.0;
    Process proc = Process.GetCurrentProcess();
    memory = Math.Round(proc.PrivateMemorySize64 / (1024*1024), 2);
    proc.Dispose(); 
    ```

现在您可以使用`memory`转换为兆字节的变量。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2012-06-21T08:11:21.810

[在这里](http://vivekcek.wordpress.com/2009/10/22/how-to-get-cpu-and-memory-usage-c-net/)查看详细信息。

```
private PerformanceCounter cpuCounter;
private PerformanceCounter ramCounter;
public Form1()
{
    InitializeComponent();
    InitialiseCPUCounter();
    InitializeRAMCounter();
    updateTimer.Start();
}

private void updateTimer_Tick(object sender, EventArgs e)
{
    this.textBox1.Text = "CPU Usage: " +
    Convert.ToInt32(cpuCounter.NextValue()).ToString() +
    "%";

    this.textBox2.Text = Convert.ToInt32(ramCounter.NextValue()).ToString()+"Mb";
}

private void Form1_Load(object sender, EventArgs e)
{
}

private void InitialiseCPUCounter()
{
    cpuCounter = new PerformanceCounter(
    "Processor",
    "% Processor Time",
    "_Total",
    true
    );
}

private void InitializeRAMCounter()
{
    ramCounter = new PerformanceCounter("Memory", "Available MBytes", true);

} 
```

如果您将值设为 0，则需要调用`NextValue()`两次。然后它给出了 CPU 使用率的实际值。[在此处](https://docs.microsoft.com/en-us/archive/blogs/bclteam/how-to-read-performance-counters-ryan-byington)查看更多详细信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-04T11:45:55.527

对于完整的系统，您可以添加 Microsoft.VisualBasic 框架作为参考；

```
 Console.WriteLine("You have {0} bytes of RAM",
        new Microsoft.VisualBasic.Devices.ComputerInfo().TotalPhysicalMemory);
        Console.ReadLine(); 
```

# php - 在php中将字符串值转换为html格式

> ID：750580
> 
> 赞同：1
> 
> 时间：2009-04-15T06:58:42.673
> 
> 标签：php

有人知道如何在php中将字符串值转换为html格式吗？例如：

```
$string = "Hello World!!
           How are you?" 
```

如果我回显 $string，它将显示如下：

```
Hello World!!How are you? 
```

代替：

```
Hello World!!
How are you? 
```

php 有什么办法可以将 $string 转换为 html 格式？如果我输入：

```
$string = "Hello World!!
           How are you?" 
```

php会将其转换为：

```
$string = "Hello World!!<br>How are you?" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T07:01:51.497

您正在寻找将 HTML 换行标记添加到每个物理换行序列（或）的[`nl2br`函数：](http://docs.php.net/nl2br)`<br />``\n``\r``\r\n`

```
\n    →  <br />\n
\r    →  <br />\r
\r\n  →  <br />\r\n 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-26T19:56:53.883

```
$string = "Hello World!!
       How are you?";
echo nl2br($string); 
```

# checkstyle - 用于 XML、文本、属性文件格式的 Checkstyle

> ID：750585
> 
> 赞同：1
> 
> 时间：2009-04-15T07:00:32.730
> 
> 标签：checkstyle

可以配置 checkstyle 来检查 xml、文本、属性文件格式。我有一个要求，我需要检查 java、xml、文本等文件格式中的某些关键字。例如，如果在文本文件中出现文本“danger”，那么我需要通知用户此行中出现文本危险，请将其删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T20:15:34.037

Checkstyle 有一个正则表达式检查，可以为您检查任何关键字。但我不知道如何让它检查非 java 文件。我认为这项工作的一个更好的工具是 grep。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-12T11:07:25.727

[PMD](http://pmd.sourceforge.net/)至少可以检查 XML。对于其他任何事情，您可能需要考虑为[Sonar](http://www.sonarqube.org/)[编写插件](http://www.beyondjava.net/blog/write-sonarqube-plug-in/)。

# svn - 如何使用 maven 获取当前的 subversion 修订号和 URL

> ID：750591
> 
> 赞同：4
> 
> 时间：2009-04-15T07:03:40.773
> 
> 标签：svn, maven-2, versioning

我从 subversion 存储库中检查了一些分支或标签，然后使用 maven 构建项目。

现在，我想将*当前*修订号和 URL 存储到某个文件。我怎样才能做到这一点？也就是说，我想获取我签出的任何分支/标签的修订号和 URL。

我知道[buildnumber-maven-plugin](http://mojo.codehaus.org/buildnumber-maven-plugin/)但我认为它不会这样做。它获取 pom.xml 中指定的分支的修订号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T10:15:12.607

您可以使用[maven-antrun-plugin](http://maven.apache.org/plugins/maven-antrun-plugin/)执行[svnversion](http://svnbook.red-bean.com/en/1.5/svn.ref.svnversion.html)。

```
<project>
  […]
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <executions>
          <execution>
            <phase>package</phase>
            <configuration>
              <tasks>
                <exec executable="sh">
                  <arg value="-c"/>
                  <arg value="svnversion &gt;version.txt" />
                </exec>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
  […]
</project> 
```

注意：我曾经`sh -c`运行过 svnversion，所以我可以将输出重定向到文件。我不*认为*您可以将输出转换为供 Maven 构建使用的属性。

您可以使用相同的方法来运行`svn info --url`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T13:20:55.320

如前所述，[Maven Build Number Plugin](http://mojo.codehaus.org/buildnumber-maven-plugin/)可用于查找修订版。

至于 URL：Maven 的做法是使用 <scm>-tag将其放入[POM中。](http://maven.apache.org/pom.html#SCM)如果您配置此权限一次，然后使用适当的 Maven 插件（[maven-scm-plugin](http://maven.apache.org/scm/plugins/)、[maven-release-plugin](http://maven.apache.org/plugins/maven-release-plugin/)）进行分支、标记、发布等，您可以确保 <scm>-tag 始终包含正确的 url .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T09:40:09.010

buildnumber-maven-plugin 仅在您的构建中注入当前版本，所以您是对的。为了获取 URL，我认为您应该编写一个使用[SVNKit](http://svnkit.com/)的 maven 插件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-04T17:00:14.383

在我看来，API 只支持执行“svn”命令，它是各种参数和开关。问题是在 subversion 中，使用不同的可执行命令来检索正确的详细版本号，即“svnversion”。使用此命令，我可以判断我是否有混合版本、修改版本等。例如：

```
[jim@localhost sb_rc1 993]$ svn info | grep Revision
Revision: 51159
[jim@localhost sb_rc1 994]$ svnversion
51159M
[jim@localhost sb_rc1 994]$ 
```

你猜怎么了？'svn info' 在这里对我撒谎。我的本地副本是从原始的 51159 修改的，这就是为什么 'svnversion' 报告带有 M 的版本号的原因。如果我正在试验一个包含混合版本的分支怎么办？'svnversion' 可以处理这个问题。'svn info' 不能。更糟糕的是，如上所示，它会提供误导性和潜在的灾难性信息，例如，如果我基于错误信息的发布。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-08T12:53:51.790

user2990242 公开的解决方案非常适合独立使用（感谢您的良好解释）。之后，您只需使用 maven-jar 插件（或 maven-war）在 manifest.mf 中添加信息。这里有一个完整的例子：

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>buildnumber-maven-plugin</artifactId>
            <version>1.3</version>
            <executions>
                <execution>
                    <phase>validate</phase>
                    <goals>
                        <goal>create</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <timestampFormat>{0,date,dd-MM-yyyy HH:mm:ss}</timestampFormat>
                <doCheck>false</doCheck>
                <doUpdate>false</doUpdate>
                <providerImplementations>
                    <svn>javasvn</svn>
                </providerImplementations>
            </configuration>
            <dependencies>
                <dependency>
                    <groupId>com.google.code.maven-scm-provider-svnjava</groupId>
                    <artifactId>maven-scm-provider-svnjava</artifactId>
                    <version>2.1.1</version>
                </dependency>
                <dependency>
                    <groupId>org.tmatesoft.svnkit</groupId>
                    <artifactId>svnkit</artifactId>
                    <version>1.8.5</version>
                </dependency>
            </dependencies>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.5</version>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                    </manifest>
                    <manifestEntries>
                        <Implementation-Build>${buildNumber}</Implementation-Build>
                        <Implementation-Title>${project.name}</Implementation-Title>
                        <Implementation-Vendor>ENTERPRISE</Implementation-Vendor>
                        <Implementation-Version>${project.version}</Implementation-Version>
                        <Built-By>${user.name}</Built-By>
                        <Built-OS>${os.name}</Built-OS>
                        <Build-Date>${timestamp}</Build-Date>
                        <SCM-Revision>${buildNumber}</SCM-Revision>
                    </manifestEntries>
                </archive>
            </configuration>
        </plugin> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-30T12:07:56.870

您已经说过这不能满足您的需求，但对于其他有类似问题的人来说，值得注意的是，您可以使用[Maven SCM API](http://maven.apache.org/scm/maven-scm-api/index.html)`scm`来针对POM 部分中配置的存储库调用任意 SCM 命令。例如，在[这个答案](https://stackoverflow.com/questions/1130365/maven-commit-single-artifact-to-svn-repository/1131279#1131279)中，我展示了如何在 Maven mojo 中提交单个文件。

您可以稍微修改该示例，改为向下转换`SCMProvider`to`SvnExeScmProvider`并调用其`info()`方法。这将返回`SvnInfoScmResult`包装 a 的 a `SvnInfoItem`。`svn info`该项目封装了通过标准 Subversion API运行命令的结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-16T16:38:31.340

为了完整起见，antrun 从 1.7 版本开始支持将 ant 属性导出到 mvn。请参阅[添加新参数以将 Ant 属性导出到 Maven 属性](http://jira.codehaus.org/browse/MANTRUN-158)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-29T14:45:35.873

这是一个老问题，但`buildnumber-maven-plugin`现在公开了一个`${scmBranch}`包含 SCM URL 的值。我已经简单地尝试过它，它似乎工作。要在资源过滤中使用它，您必须首先将其放入属性中，就像`timestamp`Maven 公开的值一样。

有关更多信息，请参阅[http://mojo.codehaus.org/buildnumber-maven-plugin/usage.html](http://mojo.codehaus.org/buildnumber-maven-plugin/usage.html)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-14T02:15:24.840

当插件配置中未指定“providerImplementations”时，Buildernumber-maven-plugin 依赖于您安装的 svn 客户端。当系统路径中没有定义svn执行路径，或者你的svn客户端版本不匹配时，插件无法正确调用svn命令行。

因此，添加 javasvn 客户端及其依赖项是一个好主意。

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>buildnumber-maven-plugin</artifactId>
            <version>1.2</version>
            <executions>
                <execution>
                    <phase>validate</phase>
                    <goals>
                        <goal>create</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <doCheck>false</doCheck>
                <doUpdate>false</doUpdate>
                <providerImplementations>
                  <svn>javasvn</svn>
                </providerImplementations>
            </configuration>
            <dependencies>
                <dependency>
                    <groupId>com.google.code.maven-scm-provider-svnjava</groupId>
                    <artifactId>maven-scm-provider-svnjava</artifactId>
                    <version>2.0</version>
                </dependency>
                <dependency>
                    <groupId>org.tmatesoft.svnkit</groupId>
                    <artifactId>svnkit</artifactId>
                    <version>1.7.8</version>
                </dependency>
            </dependencies>
        </plugin> 
```

# html - 页面可以呈现的最大字体大小

> ID：750594
> 
> 赞同：7
> 
> 时间：2009-04-15T07:05:24.920
> 
> 标签：html, browser, font-size

可以在网页中呈现的最大字体大小是多少？

它取决于机器还是应用程序（浏览器）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T08:19:47.470

它因浏览器而异。例如，Mac/IE4+ 不呈现指定 >255px 的字体。Opera 5 在 510px 之后出现异常。Mozilla 似乎能够处理高达 9362px 的值，这恰好也是 Netscape 4 的限制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T07:10:31.567

是的。

每个设备都有一些它支持的字体和字体大小。对于台式计算机，这两个集合都非常大，但对于电话或其他小型设备，集合可能相当有限。对于具有纯文本屏幕的设备，一种尺寸可能只有一种字体。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-27T00:52:05.777

在 Firefox 3.6 中，最大实际字体大小似乎是 2000 像素。计算出的高度/行高上限约为 2657 像素，进一步增加不会改变显示。

Safari 5 和 Chrome 6（Webkit 浏览器）似乎允许最大（但不包括）1,000,000 像素的大小，在此之后文本根本不会呈现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-10T18:03:46.770

如果您使用内联 SVG，Chrome 会将字体大小限制为 8000px 。以下代码将在 firefox (V 59) 内联工作。Chrome (V 66) 将呈现以下 inline-svg 不可读。

```
<svg id="diagrammChart"
           width="100%"
           height="100%"
           viewBox="-400000 0 1000000 550000"
           font-size="27559"
           overflow="hidden"
           preserveAspectRatio="xMidYMid meet"
>
<g class="hover-check">
    <text class="hover-toggle" x="-16800" y="36857.506818182" opacity="1" height="24390.997159091" width="953959" font-size="27559">
        <set attributeName="opacity" to="1" begin="ExampShow56TestBarRect1.touchstart"
             end="ExampShow56TestBarRect1.touchend">
        </set>
        <set attributeName="opacity" to="1" begin="ExampShow56TestBarRect1.mouseover"
             end="ExampShow56TestBarRect1.mouseout">
        </set>
        Heinz: -16800
    </text>
    <rect class="hover-rect" x="-16800" y="12466.509659091" width="16800" height="24390.997159091" fill="darkred">
        <set attributeName="opacity" to="0.1" begin="ExampShow56TestBarRect1.mouseover"
             end="ExampShow56TestBarRect1.mouseout">
        </set>
        <set attributeName="opacity" to="0.1" begin="ExampShow56TestBarRect1.touchstart"
             end="ExampShow56TestBarRect1.touchend">
        </set>
    </rect>
    <rect id="ExampShow56TestBarRect1" x="-384261" y="0" width="953959" height="48781.994318182"
          opacity="0">
    </rect>

</g>
</svg> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T07:09:14.053

大概两者兼而有之。它还取决于查看网页的显示器的大小。您想了解任何特定的应用程序吗？

# nunit - WatiN 与 Windows 的兼容性

> ID：750600
> 
> 赞同：7
> 
> 时间：2009-04-15T07:06:25.213
> 
> 标签：nunit, watin

我在 Windows XP 上成功运行测试，但在运行 Windows 2003 时甚至没有成功构建。

任何人都知道它是否兼容，正如我在某个网站上看到的那样，WatiN 在 XP 而不是其他 Windows 版本上经过全面测试。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-30T09:04:57.607

我通常会将其发布为对 Sam 的回答的评论，但我正在尝试使堆栈跟踪可搜索，所以这里......

```
WatiN.Core.Exceptions.IENotFoundException : Could not find an IE window matching constraint: Timeout while waiting to attach to newly created instance of IE.. Search expired after '30' seconds.
at WatiN.Core.IE.CreateIEPartiallyInitializedInNewProcess()
at WatiN.Core.IE.CreateNewIEAndGoToUri(Uri uri, IDialogHandler logonDialogHandler, Boolean createInNewProcess)
at WatiN.Core.IE..ctor(String url, Boolean createInNewProcess)
c:\...\WithVendorSite.cs(42,0): at WithVendorSite.VerifyCanLogIn(TargetSite target) 
```

我在 Windows 7 上针对 WatiN 2.0.10.928 开发了我的测试，但是`about:blank`当在具有最新 WU 的 Windows Server 2008 上运行时，测试一直卡在地址栏中的空白浏览器中，并且增强的安全配置关闭并运行提升的测试（以管理员身份运行）。

我的问题（感谢 Sam）是`Microsoft.mshtml.dll`bin 目录中没有（我`Interop.shdocvw.dll`从我在 Windows 7 端遇到的错误消息中发现这是必要的）。

添加后`Microsoft.mshtml.dll`，事情运行愉快， ESC 转回[但测试过程需要运行提升]。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T08:31:53.710

我在带有 IE6 的 Windows 2003 上运行我们的 WatiN 集成测试套件（数百个测试）。工作正常，没有做任何特殊的技巧。你得到什么异常？您确定在这台机器上正确注册了 mshtml.dll（windows 目录中某处的 COM dll）吗？您是否在与 WatiN.Core.dll 相同的目录中有 Microsoft.mshtml.dll（互操作程序集）和 interop.shdocvw.dll？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T07:22:28.637

**更新：**它的官方支持，来自[常见问题](http://watin.sourceforge.net/faq.html)

> 支持哪些 Windows 版本？
> 
> Windows 2000、Windows XP、Windows 2003 和 Windows 2008。

原帖：

我一直在vista上使用它。我还没有在 Windows Server 2003 上使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T09:48:17.983

我在 Windows XP 上使用 Watin 1.3，但在 Win 7 上也有问题.... 官方上，Watin 1.3 在 OS Xp 和更早的 Win XP 上工作

但 Watin 2.1 在 Win 7 和 XP 上运行良好。Watin 2.1 正式支持任何微软操作系统

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T11:13:00.920

您是否尝试过以交互方式登录到服务器并尝试手动运行测试？这可能是因为您的构建服务器正在运行的帐户或您设置的某些特定安全设置。您是否检查过 IE 是否因为该页面不在受信任的站点列表中而阻止您查看该页面？

# c++ - 在 C++ 中使用 Dtrace 设置我自己的探针

> ID：750601
> 
> 赞同：3
> 
> 时间：2009-04-15T07:06:48.207
> 
> 标签：c++, dtrace

我在 C 库中有一些自定义 dtrace 探针，当将库与 C 应用程序链接和使用时，我的探针工作正常，但是当与 C++ 链接时，它说找不到它们。原因似乎是因为 C++ 的修改，并且试图让它工作已成为一种追逐。

有任何想法吗？

注意：使用 gcc

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T07:08:34.927

到目前为止，我已经找到了这些“有用”的链接

[使用 DTrace 分析和调试 C++ 程序](http://developers.sun.com/solaris/articles/dtrace_cc.html)

[将 DTrace SDT 提供程序与 C++ 一起使用](http://zvrba.net/tips/c++_dtrace.html)

但他们还没有解决我的问题。

后来我发现了这些文章：

[用户土地跟踪变得越来越好](https://blogs.oracle.com/ahl/entry/user_land_tracing_gets_better)//这非常有帮助

[将开发人员定义的 DTrace 探测点放入应用程序中](http://blogs.oracle.com/barts/entry/putting_user_defined_dtrace_probe)

[Dtrace Using SDT probes](http://www.filibeto.org/~aduritz/truetrue/solaris10/sdtprobes.pdf) //pdf 这有助于理解一些细节，但信息是旧的

基本上这一切都归结为使用 dtrace -h 从那些 probes.d 到头文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T07:10:19.930

您`extern "C" { ... }`在声明 C 函数时尝试过吗？

# linux - 释放 TCP/IP 端口？

> ID：750604
> 
> 赞同：178
> 
> 时间：2009-04-15T07:08:37.360
> 
> 标签：linux, networking, tcp, port

`netstat -tulnap` 显示正在使用的端口。如何在 Linux 中释放端口？

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2009-04-15T07:55:25.237

正如其他人所说，您必须终止正在侦听该端口的所有进程。最简单的方法是使用`fuser(1)`命令。例如，要查看在端口 80 上侦听 HTTP 请求的所有进程（以**root**身份运行或使用`sudo`）：

```
# fuser 80/tcp 
```

如果你想杀死他们，那么只需添加`-k`选项。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2015-06-10T10:03:24.137

要在 Linux 中终止特定端口，请使用以下命令

```
sudo fuser -k Port_Number/tcp 
```

替换`Port_Number`为您占用的端口。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2016-06-29T04:46:26.230

在终端类型中：

`netstat -anp|grep "port_number"`

它将显示端口详细信息。转到最后一列。它将采用这种格式。例如：- PID/java

然后执行：

`kill -9 PID. Worked on Centos5`

对于 MAC：

```
lsof -n -i :'port-number' | grep LISTEN 
```

样本响应：

```
java   4744 (PID)  test  364u  IP0 asdasdasda   0t0  TCP *:port-number (LISTEN) 
```

然后执行：

```
kill -9 PID 
```

在 Macbook 上工作

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-02-27T16:45:45.913

您可以使用`tcpkill`（`dsniff`包的一部分）来终止您需要的端口上的连接：

```
sudo tcpkill -9 port PORT_NUMBER 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2019-07-15T11:55:01.500

检查所有端口：

```
netstat -lnp 
```

关闭一个打开的端口：

```
fuser -k port_no/tcp 
```

例子：

```
fuser -k 8080/tcp 
```

在这两种情况下，您都可以`sudo`根据需要使用该命令。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-04-15T07:31:36.777

`"netstat --programs"`假设您是`root`用户，该命令将为您提供进程信息。然后你将不得不杀死“冒犯”的进程，它很可能会再次启动只是为了惹恼你。

根据您实际尝试*实现的目标，*该问题的解决方案将根据持有这些端口的进程而有所不同。例如，您可能需要禁用服务（假设它们不需要）或将它们配置为使用不同的端口（如果您确实需要它们但您需要更多的端口）。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-15T07:12:07.727

终止正在侦听相关端口的进程。我相信 netstat 会向您显示进程 ID。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T09:36:45.197

如果你真的想立即杀死一个进程，你可以发送一个 KILL 信号而不是一个 TERM 信号（后者是一个停止请求，第一个将立即生效而无需任何清理）。这很容易做到：

```
kill -KILL <pid> 
```

但是请注意，根据您要停止的程序，这样做时其状态可能会严重损坏。您通常只想在正常终止不起作用时发送 KILL 信号。我想知道你试图解决的根本问题是什么，以及杀戮是否是正确的解决方案。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-15T07:12:37.960

我认为唯一的方法是停止打开端口的进程。

* * *

## 回答 #10

> 赞同：-6
> 
> 时间：2013-03-28T19:23:31.343

sudo killall -9 "进程名"

* * *

## 回答 #11

> 赞同：-14
> 
> 时间：2013-07-18T13:04:30.630

关闭计算机总是会杀死我的进程。

# gdi+ - 在另一个图像上绘制图像的最快方法是什么？

> ID：750615
> 
> 赞同：0
> 
> 时间：2009-04-15T07:12:00.300
> 
> 标签：gdi+, performance, drawimage

我有 3 个位图点。

```
Bitmap* totalCanvas = new Bitmap(400, 300, PixelFormat32bppARGB);  // final canvas
Bitmap* bottomLayer  = new Bitmap(400, 300,PixelFormat32bppARGB); // background
Bitmap* topLayer = new Bitmap(XXX); // always changed. 
```

**我将在底部图层上绘制复杂的背景。我不想一次又一次地在totalCanvas上重绘复杂的背景，所以我把它存储在bottomLayer中。**

TopLayer 经常更改。我想将bottomLayer 绘制到totalCanvas。哪种方式最快？

```
Graphics canvas(totalCanvas); 
canvas.DrawImage(bottomLayer, 0, 0);  step1
canvas.DrawImage(topLayer ,XXXXX);   step2 
```

我希望 step1 尽可能快。谁能给我一些样品？非常感谢！

感谢您放松的回答。我写了以下代码：

```
Graphics canvas(totalCanvas); 
for (int i = 0; i < 100; ++i)
{
canvas.DrawImage(bottomLayer, 0,0);
} 
```

这部分需要 968 毫秒……太慢了……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T16:27:45.960

If at all possible (and it looks like it from your code), using DrawImageUnscaled will be significgantly faster than DrawImage. Or if you are using the same image over and over again, create a TextureBrush and use that.

The problem with GDI+, is that for the most part, it is unaccelerated. To get the lightening fast drawing speeds you really need GDI and BitBlt, which is a serious pain in the but to use with GDI+, especially if you are in Managed code (hard to tell if you are using managed C++ or straight C++).

See this [post](https://stackoverflow.com/questions/58230/rendering-graphics-in-c) for more information about graphics quickly in .net.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T08:42:06.917

几乎所有的 GDI+ 操作都应该由驱动程序实现，以尽可能在 GPU 上运行。这应该意味着一个简单的 2D 位图复制操作将“足够快”，即使是“足够”的相当大的值。

我的建议是显而易见的：不要花时间寻找一种“最快”的方式来做这件事。您已经非常清楚地阐述了问题，所以只需按照您在问题中概述的方式尝试清楚地实施它。然后，您当然可以继续进行基准测试并决定继续寻找。

一个简单的例子：

> 32 bpp 400x300 位图的大小约为 469 KB。根据[这张方便的表格](http://en.wikipedia.org/wiki/Comparison_of_Nvidia_graphics_processing_units#GeForce_4_series)，2002 年的 Nvidia GeForce 4 MX 的理论内存带宽为 2.6 GB/s。假设复制是在纯“覆盖”模式下完成的，即没有混合现有表面（听起来不错，因为您的复制基本上是一种将帧“清除”到副本源数据的方式），并且开销因子为四为了安全起见，我们得到：
> 
> (2.6 * 2^30 / (4 * 469 * 2^10)) = 1453

这意味着您的副本应该以 1453 FPS 运行，我很高兴地认为它“足够好”。

# c# - 如何解决合并模块依赖项

> ID：750623
> 
> 赞同：3
> 
> 时间：2009-04-15T07:13:42.387
> 
> 标签：c#, windows-installer, merge-module

我正在尝试将合并模块添加到我的 windows 安装程序 3.1 项目中。事实证明，它依赖于另一个合并模块......我也添加了它。但似乎第一个模块没有注册这个新的合并模块已被添加，所以我仍然收到一条警告，上面写着：“无法找到带有签名的模块依赖项......”

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-02T05:56:36.683

首先，我假设您正在谈论添加了合并模块的 VS 部署项目，这些模块会生成 Windows Installer 3.1 msi。

事实证明，对于它引用的任何合并模块依赖项，在与添加的合并模块相同的目录中查找它太容易了。

相反，它会通过标准合并模块文件夹列表（例如 C:\Program Files\Common Files\Merge Modules）来查找依赖项合并模块。因此，您可以将依赖项合并模块复制到该文件夹​​中，并且只引用部署项目中最重要的依赖合并模块。然后它应该解决它的所有合并模块依赖项（它们也将出现在部署项目的“检测到的依赖项”部分中）。

但是，我有一个进一步的要求，即我希望这些合并模块在 SVN 中，并且不想要求管理员访问权限来运行脚本以将它们复制到该 Program Files 文件夹中。

解决方案 - 您可以扩展合并模块依赖项搜索文件夹以包含您自己的自定义文件夹。在部署项目上，调出 Properties 网格（不是右键单击 -> 属性窗口）并将包含依赖 Merge Modules 的文件夹添加到`SearchPath`属性中。它与部署项目相关，因此可以很好地满足我的 SVN 要求。

# iis - 在 IIS 中重新创建默认网站

> ID：750632
> 
> 赞同：89
> 
> 时间：2009-04-15T07:20:27.863
> 
> 标签：iis

我不小心删除了 IIS 中的默认网站；它不再显示在 IIS 管理器的树中，并且浏览“localhost”会返回 404 错误。

我已经重新安装了 IIS，但默认网站仍然不存在......是否可以重新创建默认网站，以便我可以在其中创建我的文件夹？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2015-05-06T17:04:32.183

其他答案基本上是正确的，多亏了他们，我才能恢复我的默认网站，他们只是遗漏了一些或多或少的重要细节。

这是在我的情况下恢复*默认网站*的完整过程（ Windows 7 64 位上的**IIS 7 ）：**

1.  打开**IIS 管理器**
2.  右键单击左侧*连接树中您机器下的**站点*节点，然后单击**添加网站**
****   输入“**默认网站**”作为*站点名称**   将*应用程序池*设置回**DefaultAppPool**！*   将*物理路径*设置为`%SystemDrive%\inetpub\wwwroot`*   保留*Binding*和其他所有内容***

 **** * *

**可能的问题**：

1.  如果新创建**的网站无法启动**并显示以下消息：

    > Internet 信息服务 (IIS) 管理器 - 该进程无法访问该文件，因为它正被另一个进程使用。（来自 HRESULT 的异常：0x80070020）

    ...**端口 80**可能已分配给另一个应用程序（在我的情况下为 Skype :)。*您可以通过右键单击Default Web Site*并选择*Edit Bindings...*和*Edit...*将绑定端口更改为例如 8080 。有关详细信息，请参阅[尝试在 IIS 7.0 中启动网站时出现错误 0x80070020](https://support.microsoft.com/en-us/kb/973094/)。当然，或者您可以关闭位于端口 80 上的应用程序。

2.  **某些应用程序要求*默认网站*具有 ID 1**。就我而言，它在重新创建后自动获得 ID 1。如果不是您的情况，请参阅[意外删除后在 IIS 中重新创建“默认网站”](http://girdharbisht.com/girdhar/?cat=47)。IIS 6 和 7 是不同的。

* * *

**注意**：我不得不重新创建*默认网站*，因为我什至无法在**Visual Studio**中打开配置为在 IIS 下运行的项目。我有一个解决方案，里面有几个项目。其中一个项目加载失败，并显示以下错误消息：

> Web 应用程序项目配置为使用 IIS。找不到Web 服务器“ [http://localhost:8080/ ”。](http://localhost:8080/)

在 IIS 管理器中重新创建*默认网站*后，我能够重新加载并打开该特定项目。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2011-11-15T16:38:42.800

做了同样的事情。无法直接重新创建默认网站 - 它一直抱怨该文件已经存在......

我固定如下：

1.  创建一个名为其他东西的新网站，例如。“默认”，指向“C:\inetpub\wwwroot”
2.  它应该使用 ID 1 创建（至少我的是）
3.  将网站重命名为“默认网站”

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-12-09T10:55:55.210

我想您想从 LAN 发布和访问您的应用程序/网站；可能作为默认网站下的虚拟目录。步骤可能会因您的 IIS 版本而异，但基本上归结为以下步骤：

恢复您的“默认网站”网站：

1.  创建一个新网站

2.  将“默认网站”设置为其名称

3.  在绑定部分（底部面板）中，在“IP 地址”编辑中输入您的本地 IP 地址。

4.  保持“主机”编辑为空

就是这样：现在，每当您在浏览器中输入您的本地 IP 地址时，您都会得到刚刚添加的网站。现在，如果您想从 LAN 访问任何其他 Web 应用程序/网站，只需在默认网站下添加一个虚拟应用程序，指向包含您已发布的应用程序/网站的目录。现在您可以键入：[http://yourLocalIPAddress/theNameOfYourApplication](http://yourLocalIPAddress/theNameOfYourApplication)从您的 LAN 访问它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-01T11:24:44.650

您可以尝试通过执行以下操作来恢复之前的状态：

1.  转到[**IIS 管理器**](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/b0c14479-83e3-435d-a935-819fe396e7d2.mspx?mfr=true)
2.  右键单击您的**本地计算机。**
3.  指向**所有任务**
4.  指向**备份/恢复配置**
5.  选择要恢复的配置
6.  等到配置应用

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-06-08T13:16:54.947

[在 SuperUser 上查看此答案：](https://superuser.com/a/705425/736638)

> 简而言之：重新安装 IIS 和 WAS。
> 
> 详细说明——
> 
> 步骤1
> 
> 转到“添加删除程序”“打开或关闭 Windows 功能”删除 IIS 和 WAS（Windows 进程激活服务）重新启动 PC 第 2 步
> 
> 转到“添加删除程序”“打开或关闭 Windows 功能”同时打开 IIS 和 WAS（Windows 进程激活服务） 注意：单独重新安装 IIS 无济于事。您必须重新安装 IIS 和 WAS

这种方法为我解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-28T09:50:20.400

按照以下步骤恢复您的“默认网站”网站：

1.  创建一个新网站
2.  将“默认网站”设置为其名称
3.  在绑定部分（底部面板）中，在“IP 地址”编辑中输入您的本地 IP 地址。
4.  保持“主机”编辑为空

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-07-30T14:35:21.590

我删除了 C:\inetpub 文件夹并重新安装了 IIS，它重新创建了默认网站和设置。

# c++ - 使用文本驱动程序的无 dsn 连接

> ID：750635
> 
> 赞同：0
> 
> 时间：2009-04-15T07:21:14.397
> 
> 标签：c++, odbc

我正在尝试使用 DSN-Less 连接（使用文本驱动程序）进行 ODBC 导入。有没有办法告诉 SQLDriverConnect 设置 COLNAMEHEADER=yes/no？或者我需要使用 schema.ini 来做到这一点？实际上我不想手动创建 schema.ini，我可以使用 SQLConfigDataSource 进行 dsn less 连接吗？我还没有找到任何关于此的文档。

在此先感谢， Manoj

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T07:34:20.717

在通过 SQLDriverConnect 打开文本文件之前，以编程方式创建 schema.ini。我看不到 SQLConfigDataSources 在这里如何为您提供帮助，因为它专门用于操作 DSN，而您没有。

# java - 调整 JFrame 大小时，JTextArea 行为异常

> ID：750637
> 
> 赞同：1
> 
> 时间：2009-04-15T07:21:46.317
> 
> 标签：java, user-interface, swing

我`JTextArea`在我的 Swing 应用程序中使用了一些。使用管理器将包围`JScrollPane`添加到一个。`JPanel``GridBagLayout`

```
// Pseudo Code ----

JTextArea area = new JTextArea();
area.setRows(3);

JScrollPane sp = new JScrollPane(area);

JPanel p = new JPanel(new GridBagLayout());
p.add(sp, new GridBagConstraints(
          0, 0, 1, 1, 1, 0, WEST, HORIZONTAL, new Insets(4, 4, 4, 4), 0, 0));

// ---------------- 
```

一切正常。在我调整`JFrame`. 然后**两者都`JTextArea`将折叠成一排**。然而，至少有一个足够的地方。

为什么元素折叠成一行？
有谁知道解决方案？有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T07:55:22.583

我相信这是因为您将 weighty 设置为 0（GridBagConstraints 构造函数的第 6 个参数）。如果您希望组件垂直增长，则需要增加此值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T08:15:11.147

还要确保在滚动窗格上设置“首选大小”属性。当未设置此属性时调整框架和面板的大小时，我有奇怪的行为（窗格/字段折叠/消失）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T12:35:40.320

如果我`BorderLayout`在我的元素周围使用 a ，它会起作用。
皮特，威格斯先生，谢谢你的帮助！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T22:13:05.117

我最近遇到了类似的问题，我有两个具有不同 GridBagConstraint.weighty 值的 JTextArea，并且都设置为 GridBagConstraint.fill = BOTH。当我更改 JTextAreas 中的文本时，它们会更改大小（如果设置了权重和填充值，我希望不会发生这种情况）。奇怪的是，我所要做的就是为围绕 JTexAreas 的 JScrollPanes 设置一个首选大小。首选尺寸尺寸可以是任何东西，因为“fill = BOTH”导致首选尺寸被忽略，但它确实解决了我的问题。

# php - 在 MySQLi 中选择 * FROM

> ID：750648
> 
> 赞同：23
> 
> 时间：2009-04-15T07:28:34.660
> 
> 标签：php, mysqli

我的网站相当广泛，而且我最近才切换到 PHP5（称我为大器晚成者）。

我之前的所有 MySQL 查询都是这样构建的：

```
"SELECT * FROM tablename WHERE field1 = 'value' && field2 = 'value2'"; 
```

这使它变得非常容易、简单和友好。

出于明显的安全原因，我现在正尝试切换到 mysqli，并且我很难弄清楚如何在需要特定参数`SELECT * FROM`时实现相同的查询。`bind_param`

这种说法是否已成为过去？

如果是，我如何处理涉及大量列的查询？我真的需要每次都打出来吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-06-08T20:06:58.967

我可能是错的，但对于你的问题，我觉得这`bind_param()`并不是真正的问题。您总是需要定义一些条件，直接在查询字符串本身中，`bind_param()`用于设置`?`占位符。这不是一个真正的问题。

我使用 MySQLi`SELECT *`查询时遇到的问题是其中的`bind_result()`一部分。这就是有趣的地方。我从 Jeffrey Way 看到了这篇文章：http: [//jeff-way.com/2009/05/27/tricky-prepared-statements/](http://jeff-way.com/2009/05/27/tricky-prepared-statements/)（此链接不再有效）。该脚本基本上循环遍历结果并将它们作为数组返回——无需知道有多少列，您仍然可以使用准备好的语句。

在这种情况下，它看起来像这样：

```
$stmt = $mysqli->prepare(
  'SELECT * FROM tablename WHERE field1 = ? AND field2 = ?');
$stmt->bind_param('ss', $value, $value2);
$stmt->execute(); 
```

然后使用网站上的代码片段：

```
$meta = $stmt->result_metadata();

while ($field = $meta->fetch_field()) {
  $parameters[] = &$row[$field->name];
}

call_user_func_array(array($stmt, 'bind_result'), $parameters);

while ($stmt->fetch()) {
  foreach($row as $key => $val) {
    $x[$key] = $val;
  }
  $results[] = $x;
} 
```

现在`$results`包含来自. `SELECT *`到目前为止，我发现这是一个理想的解决方案。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-04-15T07:45:47.507

```
"SELECT * FROM tablename WHERE field1 = 'value' && field2 = 'value2'"; 
```

变成

```
"SELECT * FROM tablename WHERE field1 = ? && field2 = ?"; 
```

传递给`$mysqli::prepare`：

```
$stmt = $mysqli->prepare(
  "SELECT * FROM tablename WHERE field1 = ? && field2 = ?");
$stmt->bind_param( "ss", $value, $value2); 
// "ss' is a format string, each "s" means string
$stmt->execute();

$stmt->bind_result($col1, $col2);
// then fetch and close the statement 
```

OP评论：

> 所以如果我有 5 个参数，我可能有“sssis”之类的东西（取决于输入的类型？）

对，准备好的语句中的每个`?`参数都有一个类型说明符，它们都是位置说明符（第一个说明符适用于第一个`?`，它被第一个实际参数（它是 的第二个参数`bind_param`）替换）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-15T08:31:15.010

在切换时，切换到 PDO 而不是 mysqli，它可以帮助您编写与数据库无关的代码，并为准备好的语句提供更好的功能。

[http://www.php.net/pdo](http://www.php.net/pdo)

[PDO 的绑定参数： http](http://se.php.net/manual/en/pdostatement.bindparam.php) ://se.php.net/manual/en/pdostatement.bindparam.php

```
$sth = $dbh->prepare("SELECT * FROM tablename WHERE field1 = :value1 && field2 = :value2");
$sth->bindParam(':value1', 'foo');
$sth->bindParam(':value2', 'bar');
$sth->execute(); 
```

或者：

```
$sth = $dbh->prepare("SELECT * FROM tablename WHERE field1 = ? && field2 = ?");
$sth->bindParam(1, 'foo');
$sth->bindParam(2, 'bar');
$sth->execute(); 
```

或将参数作为数组执行：

```
$sth = $dbh->prepare("SELECT * FROM tablename WHERE field1 = :value1 && field2 = :value2");
$sth->execute(array(':value1' => 'foo' , ':value2' => 'bar')); 
```

如果您希望您的应用程序将来能够在不同的数据库上运行，这对您来说会更容易。

我还认为，在使用 PDO 时，您应该花一些时间来使用 Zend Framwework 中的一些类。查看他们的[Zend_Db](http://framework.zend.com/manual/en/zend.db.html#zend.db.adapter.connecting.factory "Zend_DB_Factory")，更具体地说是 [Zend_Db_Factory][2]。您不必使用所有框架或将应用程序转换为 MVC 模式，但使用框架并阅读它是值得的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T07:33:14.727

> 这种说法是否已成为过去？

是的。不要使用`SELECT *`; 这是维护的噩梦。SO上有很多其他线程关于为什么这个结构不好，以及如何避免它会帮助你编写更好的查询。

也可以看看：

*   [不使用select *的原因是什么？](https://stackoverflow.com/questions/321299/what-is-the-reason-not-to-use-select)
*   [使用 SELECT * 时的性能问题？](https://stackoverflow.com/questions/487578/performance-issue-in-using-select/487612#487612)
*   [为什么使用“*”构建视图不好？](https://stackoverflow.com/questions/262450/why-is-using-to-build-a-view-bad)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T07:33:48.907

你仍然可以使用它（mysqli只是与服务器通信的另一种方式，SQL语言本身是扩展的，没有改变）。[不过，准备好的语句](http://dev.mysql.com/tech-resources/articles/4.1/prepared-statements.html)更安全——因为您不需要每次都经历正确转义值的麻烦。如果你愿意，你可以让它们保持原样，但如果你切换，SQL 捎带的风险会降低。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-09-27T07:01:58.027

你可以`get_result()`在语句上使用。

[http://php.net/manual/en/mysqli-stmt.get-result.php](http://php.net/manual/en/mysqli-stmt.get-result.php)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-01-23T15:05:26.627

我正在寻找一个很好且完整的示例，说明如何将多个查询参数动态绑定到任何 SELECT、INSERT、UPDATE 和 DELETE 查询。[Alec](https://stackoverflow.com/a/966717/1424613)在他的回答中提到了一种如何绑定结果的方法，对我来说，用于 SELECT 查询的 execute() 函数之后的 get_result() 工作得很好，并且能够将所有选定的结果检索到关联数组的数组中。

无论如何，我最终创建了一个函数，我可以在其中动态地将任意数量的参数绑定到参数化查询（使用 call_user_func_array 函数）并获得查询执行的结果。以下是该函数及其文档（请在使用前阅读 - 特别是[$paremetersTypes - 类型规范字符](http://php.net/manual/en/mysqli-stmt.bind-param.php)参数对于理解很重要）

```
 /**
     * Prepares and executes a parametrized QUERY (SELECT, INSERT, UPDATE, DELETE)
     *
     * @param[in] $dbConnection mysqli database connection to be used for query execution
     * @param[in] $dbQuery parametrized query to be bind parameters for and then execute
     * @param[in] $isDMQ boolean value, should be set to TRUE for (DELETE, INSERT, UPDATE - Data manipulaiton queries), FALSE for SELECT queries
     * @param[in] $paremetersTypes String representation for input parametrs' types as per http://php.net/manual/en/mysqli-stmt.bind-param.php
     * @param[in] $errorOut A variable to be passed by reference where a string representation of an error will be present if a FAUILURE occurs
     * @param[in] $arrayOfParemetersToBind Parameters to be bind to the parametrized query, parameters need to be specified in an array in the correct order 
     * @return array of feched records associative arrays for SELECT query on SUCCESS, TRUE for INSERT, UPDATE, DELETE queries on SUCCESS, on FAIL sets the error and returns NULL 
     */
    function ExecuteMySQLParametrizedQuery($dbConnection, $dbQuery, $isDMQ, $paremetersTypes, &$errorOut, $arrayOfParemetersToBind)
    {
        $stmt = $dbConnection->prepare($dbQuery);

        $outValue = NULL;

        if ($stmt === FALSE)
            $errorOut = 'Failed to prepare statement for query: ' . $dbQuery;
        else if ( call_user_func_array(array($stmt, "bind_param"), array_merge(array($paremetersTypes), $arrayOfParemetersToBind)) === FALSE)
            $errorOut = 'Failed to bind required parameters to query: ' . $dbQuery . '  , parameters :' . json_encode($arrayOfParemetersToBind);
        else if (!$stmt->execute())
            $errorOut = "Failed to execute query [$dbQuery] , erorr:" . $stmt->error;
        else
        {
            if ($isDMQ)
               $outValue = TRUE;
            else
            {
                $result = $stmt->get_result();

                if ($result === FALSE) 
                     $errorOut = 'Failed to obtain result from statement for query ' . $dbQuery;
                else
                    $outValue = $result->fetch_all(MYSQLI_ASSOC);
            }
        }

        $stmt->close();

        return $outValue;
    } 
```

用法：

```
 $param1 = "128989";
    $param2 = "some passcode";

    $insertQuery = "INSERT INTO Cards (Serial, UserPin) VALUES (?, ?)";
    $rowsInserted = ExecuteMySQLParametrizedQuery($dbConnection, $insertQuery, TRUE, 'ss', $errorOut, array(&$param1, &$param2) ); // Make sure the parameters in an array are passed by reference

    if ($rowsInserted === NULL)
        echo 'error ' . $errorOut;
    else
        echo "successfully inserted row";

    $selectQuery = "SELECT CardID FROM Cards WHERE Serial like ? AND UserPin like ?";
    $arrayOfCardIDs = ExecuteMySQLParametrizedQuery($dbConnection, $selectQuery, FALSE, 'ss', $errorOut, array(&$param1, &$param2) ); // Make sure the parameters in an array are passed by reference

    if ($arrayOfCardIDs === NULL) 
        echo 'error ' . $errorOut;
    else
    {
        echo 'obtained result array of ' . count($arrayOfCardIDs) . 'selected rows';

        if (count($arrayOfCardIDs) > 0) 
            echo 'obtained card id = ' . $arrayOfCardIDs[0]['CardID'];
    } 
```

# java - 从 Windows 命令行运行时如何请求 JVM 垃圾收集（不是来自代码）

> ID：750649
> 
> 赞同：15
> 
> 时间：2009-04-15T07:29:12.273
> 
> 标签：java, windows, command-line, garbage-collection

我如何从外部请求 Java 垃圾收集，从 JAR 启动程序（使用 Windows BAT）？

*   从Java代码我可以做到`System.gc()`
*   运行 JNLP 发行版时，我从控制面板/Java / ...打开了这个“Java 控制台”，这个 Java 控制台提供了手动垃圾收集。

但是......当我从命令行/ bat 运行 jar 时，java 控制台似乎没有打开。简短的谷歌搜索找不到帮助，也许有人在这里？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2016-03-29T15:05:17.010

对于纯粹的命令行方法，您应该能够使用[`jcmd`](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/jcmd.html). 我相信 jcmd 至少从 Java 1.7 开始就已成为标准 JDK 安装的一部分。该命令将是这样的：

```
jcmd <process-id> GC.run 
```

您可以获得 jcmd 为特定进程提供的可用诊断命令列表，如下所示：

```
jcmd <process-id> help 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-15T07:36:38.073

您可以使用[jconsole](http://java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html)连接到本地运行的 JVM - 这在 GUI 上提供了“执行 GC”按钮。

启动 java 进程时，您需要指定**-Dcom.sun.management.jmxremote 。**

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-15T08:07:19.623

如果您使用最新的 java 6，您还可以使用 jvisualvm 来补充和扩展 jconsole 功能。它们都是非常有用的工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T09:44:03.853

您通常不应该有任何理由强制垃圾收集。这样做会弄乱垃圾收集器算法（主要是它们的性能）。它还会在收集垃圾时减慢程序的速度。如果存在内存问题，您应该使用内存跟踪工具找出引用被保存在哪里？（听众是否未注册？）

与其他答案一样，您可以使用 jconsole 或 jvisualvm。您也可以使用 jmx 以编程方式执行此操作。

# c# - 架构的目标命名空间

> ID：750653
> 
> 赞同：1
> 
> 时间：2009-04-15T07:31:55.590
> 
> 标签：c#, xml, schema, namespaces, target

我想做 XML 验证来验证输入 XML 文件是否符合模式文件 (.xsd)。我的问题是我们什么时候需要指定目标命名空间参数以及目标命名空间参数的作用是什么？

我从以下 MSDN 页面得到了这个问题，

[http://msdn.microsoft.com/en-us/library/1hh8b082.aspx](http://msdn.microsoft.com/en-us/library/1hh8b082.aspx)

[http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemaset.aspx](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemaset.aspx)

更具体地说，我指的是类`Add`方法的第一个参数`XmlSchemaSet`。

**EDIT1：**我目前的困惑是，

1.  在XML schema 文件中，顶部有一个target namespace 属性，这个XML schema 文件中定义的所有元素都定义在target namespace 中；
2.  在检查方案的 XML 文档文件中，XML 文档可以使用 XML 模式文件的“目标命名空间”中定义的元素，也可以使用 XML 模式文件中定义的“目标命名空间”以外的其他命名空间中的元素;
3.  问题是，我们应该将“目标命名空间”添加到`XmlSchemaSet`类的 Add 方法中，还是将 XML 文档将使用的所有命名空间添加到类的`Add`方法中`XmlSchemaSet`？
4.  另一个问题是，我们是否可以在 XML 模式文件中定义多个“目标命名空间”？如果是，如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T07:41:42.943

如果您在 XML 文档中使用名称空间，则需要使用该参数 - 例如，如果您中的一些标签的格式为`<xx:TagName>`. 否则你可以传入一个空字符串`""`。

# regex - 这个正则表达式是如何工作的，我如何让它只重复 5 次？

> ID：750655
> 
> 赞同：1
> 
> 时间：2009-04-15T07:33:02.607
> 
> 标签：regex

这个正则表达式有什么作用？我知道它替换了文件名（但不是扩展名）

```
 Regex r = new Regex("(?<!\\.[0-9a-z]*)[0-9]");
    return r.Replace(sz, "#"); 
```

我如何让它只重复5次？使其将“1111111111.000”转换为“11111#####.000”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T09:16:54.353

~~我没试过这个但是~~ **已经**尝试过，**有效**：如何改变一般模式以使用积极的前瞻来代替？这样，它应该可以工作：

```
[0-9a-z](?=[0-9a-z]{0,4}\.) 
```

基本上，这会找到任何（字母数字）字符，后跟最多四个其他字母数字字符和一个句点。这可能只是为了连续匹配句点前面的最后五个字符。虽然它的效率非常低，而且它只适用于允许可变宽度前瞻模式的引擎。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T07:36:37.667

尝试将右括号后的星号更改为“ `{5}`”（无引号）。这在一定程度上取决于您的正则表达式环境的功能集，但这是一种常见的语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T09:08:20.413

正则表达式匹配前面没有点的字符（0 到 9），然后是 0 到 9 或 a 到 z 的任意数量。

替换行负责多次替换。因此，您想使用具有[额外参数 count](http://msdn.microsoft.com/en-us/library/aa332131(VS.71).aspx)的 Replace 方法。

所以代码看起来像：

```
 Regex r = new Regex("(?<!\\.[0-9a-z]*)[0-9]");
 return r.Replace(sz, "#", 5); 
```

# lucene - Lucene IndexSearcher 在重建时锁定索引导致 IOException

> ID：750656
> 
> 赞同：4
> 
> 时间：2009-04-15T07:33:06.630
> 
> 标签：lucene, lucene.net

我从阅读可用文档中了解到，应该在搜索之间共享 IndexSearcher 实例，以获得最佳性能，并且必须创建一个新实例才能加载对索引所做的任何更改。这意味着在创建了指向同一目录的 IndexSearcher 实例之后，索引是可写的（使用 IndexWriter）。但是，这不是我在 Lucene.Net 实现中看到的行为。我正在使用 FSDirectory。RAMDirectory 不是一个可行的选择。IndexSearcher 锁定一个索引文件（在我的实现中它是 _1.cfs 文件），使索引在 IndexSearcher 实例的生命周期内不可更新。

这是一种已知的行为吗？在使用重建之前创建的 IndexSearcher 实例时，我不能从头开始重建索引吗？是否只能修改索引而不能重建它？

下面是我创建 IndexSearcher 实例的方法：

```
// Create FSDirectory
var directory = FSDirectory.GetDirectory(storagePath, false);

// Create IndexReader
var reader = IndexReader.Open(directory);

// I get the same behaviour regardless of whether I close the directory or not.
directory.Close();

// Create IndexSearcher
var searcher = new IndexSearcher(reader);

// Closing the reader will cause "object reference not set..." when searching.
//reader.Close(); 
```

以下是我创建 IndexWriter 的方法：

```
var directory = FSDirectory.GetDirectory(storagePath, true);
var indexWriter = new IndexWriter(directory, new StandardAnalyzer(), true); 
```

我正在使用 Lucene.Net 2.0 版。

编辑：

升级到 Lucene.Net 2.1 (thx KenE) 并稍微修改我创建 IndexWriter 的方式解决了这个问题：

```
var directory = FSDirectory.GetDirectory(storagePath, false);
var indexWriter = new IndexWriter(directory, new StandardAnalyzer(), true); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T13:38:37.097

最新版本的 Lucene.Net (2.1) 似乎支持使用 create=true 打开 IndexWriter，即使有打开的阅读器：

[http://incubator.apache.org/lucene.net/docs/2.1/Lucene.Net.Index.IndexWriter.html](http://incubator.apache.org/lucene.net/docs/2.1/Lucene.Net.Index.IndexWriter.html)

早期版本不清楚它们是否支持这一点。我会尝试使用 2.1。

# ant - 使用 Ant 确保属性文件仅包含唯一条目

> ID：750658
> 
> 赞同：0
> 
> 时间：2009-04-15T07:33:48.080
> 
> 标签：ant, build-process, automation, internationalization, build-automation

Ant 中有没有一种方法可以检查指定的属性文件是否只包含唯一键？如果发现任何重复，构建失败将是必需的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T07:49:15.203

[rscbundlecheck](http://rscbundlecheck.sourceforge.net/)进行重复键检查和更多适合国际化的验证。从他们的网站上说：

> 用于检查 Java 资源包的 Ant 任务。它检查每个包中是否存在所有键、重复键、是否存在禁止字符（例如特殊字符，如变音符号）和占位符的连续使用。

蚂蚁脚本示例：

```
<taskdef name="resourceCheck" classpathref="build.classpath" classname="org.dyndns.fichtner.rsccheck.ant.RscBundleCheckTask"/>
<resourceCheck>
    <fileset file="my-properties-file.properties"/>
</resourceCheck> 
```

其中**build.classpath包含在**[此处](http://sourceforge.net/project/showfiles.php?group_id=212749&package_id=256018)可用的 resourceCheck 二进制 jar

# java - 如何编写java程序获取pid

> ID：750660
> 
> 赞同：0
> 
> 时间：2009-04-15T07:33:53.057
> 
> 标签：java, process, pid

如何编写java程序获取pid？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T07:45:41.093

[Java 应用程序如何发现其进程 ID (PID)](http://blog.igorminar.com/2007/03/how-java-application-can-discover-its.html)

不是很直接，但显然没有“官方”的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T08:13:30.933

您可以使用 JMX 执行此操作，但请注意。以下不是官方支持的机制，可能会发生变化。但是，我过去使用过它并且效果很好。

```
RuntimeMXBean rmxb = ManagementFactory.getRuntimeMXBean();
System.err.println("pid: " + rmxb.getName()); 
```

将打印 {pid}@hostname

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T07:48:42.210

我不相信这是 Java 提供的东西。首先，它打破了独立于平台的性质。我可以看到两种接近它的方法，都假设您在 UNIX 类型的系统下运行。

*   提供一个将调用`getpid()`并返回它的 JNI。
*   使用 system 或 Runtime 方法之一来运行一个外部程序，该程序将调用`getppid()`以获取其父级（即 Java）的 PI​​D，或者更糟糕的情况，沿着进程树向上走，直到找到 Java 本身。

# macos - 是否有关于在 OS X 中正确使用 Black HUD UI 的指南？

> ID：750665
> 
> 赞同：1
> 
> 时间：2009-04-15T07:36:07.387
> 
> 标签：macos, hud, hig

有谁知道 HIG 对 OS X 中黑色 HUD UI 的看法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T07:44:35.167

请参阅[Apple 人机界面指南的透明面板部分](http://developer.apple.com/documentation/UserExperience/Conceptual/AppleHIGuidelines/XHIGWindows/XHIGWindows.html#//apple_ref/doc/uid/20000961-SW24)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T08:01:51.553

基本上HIG说黑色HUD UI被命名为透明面板。

它的作用与标准面板相同，即提供与当前文档相关的一些控件的辅助窗口。

它的外观尽可能离散，特别是在高度可视化的应用中。

# javascript - 绕过 jQuery.autocomplete(1.02) 上的所有缓存

> ID：750670
> 
> 赞同：4
> 
> 时间：2009-04-15T07:37:11.223
> 
> 标签：javascript, jquery, caching, autocomplete, autofill

我在我的搜索框中使用**jQuery.autocomplete(1.02)**并且我想要**精确的**字符串和子字符串匹配。我不关心（还没有！）关于数据库负载，我很高兴它每次击键都会触发一个查询并完全绕过缓存 - 我只是不想错过任何东西。

为此，我尝试设置*cacheLength=1*，这是允许的最小值，但自动完成功能拒绝为每个键触发 GET 请求。

```
searchbox          GET_request

   'a'       ->    http://localhost/service_search_request?q=a
   'ar'      ->    http://localhost/service_search_request?q=ar
   'ars'     ->    http://localhost/service_search_request?q=ars 
```

相反，它发送了第一个和第三个而错过了第二个，给了我错误的“ar”结果：-/我已经清除了我的缓存和会话，但看起来某种缓存仍在进行中。AFAIK 我没有代理，我每次都在刷新。看起来这种行为可能来自 jQuery.autocomplete 本身。

**所以我的问题是...**

**A）**这看起来可能吗？即它是一个功能，还是一个错误？

**B）**如果是这样，有没有干净的方法？...

**C）**如果不是，您将使用什么自动完成功能？

自然*D）不，你只是在错误地使用它，你冲洗！*总是有可能的，实际上我更愿意花时间走这条路——假设它带有指向我未能找到/阅读的文档的链接！

干杯，

罗杰：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T07:48:36.297

我想知道为什么**cacheLength**不起作用，但自动完成也有问题。恕我直言，其中有错误。但是，在[options 列表中](http://docs.jquery.com/Plugins/Autocomplete/autocomplete#url_or_dataoptions)，您可以将**matchSubset**设置为 false。

**编辑：** 第 335 行附近的某处是一个名为“请求”的函数。您可以向其中添加一些调试消息，看看会发生什么：（注意：您需要安装[firebug](http://getfirebug.com/)否则“控制台”将是未知的）

```
function request(term, success, failure) {

    console.debug("ac request...");

    if (!options.matchCase)
        term = term.toLowerCase();

    var data = cache.load(term);

    console.debug("ac request 1, loaded data from cache: " + data + " term: " + term);

    // recieve the cached data
    if (data && data.length) {
        success(term, data);
    // if an AJAX url has been supplied, try loading the data now
    } else if( (typeof options.url == "string") && (options.url.length > 0) ){

        console.debug("ac request 2, data is not in the cache, request it"); 
```

“flushCache”可以很容易地用于您可以附加/设置为选项的功能。如果后端可能有更多数据，我使用它来清除缓存：

```
formatItem: function (data,i,n,value){
    if(i === (this.max -1)){
        console.debug("flushCache");
        jQuery(this).flushCache();
    }

    return data[1] + " (" + data[0] + ")";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T11:52:42.090

我有同样的问题。尽管我已将选项 cacheLength 设置为 1，但缓存不起作用。

使用您的解决方案在每个打印的术语之后调用 flushCache 函数。我无法使用：

```
if(i === (this.max -1)){ 
```

因为'i'在过滤后是例如1，但'this.max'仍然是25，因为原始后端查询导致25个返回行。

**但是**，此错误**仅**在键入包含瑞典语字符“å”、“ä”或“ö”的单词时出现。因此，兑现可能按预期工作，但不适用于这些特殊字符。

反正。我的解决方案是始终在 formatItem() 函数中调用 flushCache 控件：

```
function formatItem(row, position, n, term) {

    if($("#keywords-h").length > 0){
        $("#keywords-h").flushCache();
        }

        // format Item
        return "<span>" + row[0] + "</span>";
} 
```

希望这对某人有所帮助，如果有人对特殊字符有同样的问题，请回复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-15T08:23:08.223

显然已经到了这 18 个月，但是

> 缓存长度：0

在对我有用的选项中。那么也许最新版本已经修复了这个错误？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-17T10:17:11.540

这对我有用。

```
function requestData(q) {
   if (!options.matchCase) q = q.toLowerCase();

   //-- I turned off this line
   // var data = options.cacheLength ? loadFromCache(q) : null;

   //-- And added this line of code
   var data = null; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-22T22:32:57.257

有一个选项可以禁用子集匹配，例如

```
$("#query").autocomplete(
    url,
    {
        matchSubset: false
    }
) 
```

# branch - 如何处理无效的执行状态？

> ID：750675
> 
> 赞同：0
> 
> 时间：2009-04-15T07:41:55.893
> 
> 标签：branch, if-statement

假设您有以下代码块：

```
if (Light.On) {
    // do something...
} else if (Light.Off) {
    // do something else...
} else {
    // this state should never be reached
} 
```

现在假设应用程序逻辑规定在这部分代码中，永远不应达到最后一个状态，但这不是在编译时可以确定的。也许还有其他状态（例如`Light.Broken`）可以由应用程序的其他部分设置，但这里没有使用。

`else`你在最后一个块中添加了什么代码？

1.  不添加代码，因为无论如何都不应该达到它。
2.  添加一些日志记录功能，以便作为开发人员的您知道已达到某些非法状态。
3.  抛出异常，因为不能达到状态，如果无论如何都达到了，那么肯定有其他问题。

第一个选项对我来说似乎不合理，**希望**事情顺利似乎不是正确的选择。选项二的优点是您的应用程序不会立即崩溃，因此如果这种情况发生在测试中未发现的极少数情况下，客户可以继续使用该应用程序，并且会通知开发人员该问题。选项三导致应用程序崩溃，这显然不是您希望您的客户体验到的，但它确实很清楚地表明出了问题。

处理这种情况的最佳方法是什么？

**编辑，根据评论：**

引导讨论的一些额外考虑因素：

*   包含上述代码的方法的合约不允许在那时设置任何其他值，然后是 On 和 Off。
*   假设代码位于应用程序的不那么关键的部分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T07:45:50.407

在开发中 - 努力失败并快速失败。抛出某种运行时异常，或者只是 Assert(false)。

在一个版本中 - 优雅地关闭。您的应用程序处于无法使用的状态，并且您无法实现通常的任何操作，例如类不变量等。让用户有机会保存他们的工作，例如，尝试记录可能发送回的错误开发团队，然后关闭。

编辑：基于添加的评论。

如果函数的合同规定灯应该在函数进入时打开或关闭，那么任何其他状态都是错误的。根据我原始答案中概述的原则，该功能应该失败。

关于“非关键”方面 - 如果未满足功能前提条件，则意味着您的应用程序已损坏。无论是否在非关键代码段中检测到错误，这并不意味着问题本身是非关键的 - 您无法知道创建无效状态的错误也不会影响代码的关键区域.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T07:47:26.923

这要看情况。为布尔测试提供第三种情况会让我想哭。这只是噪音，增加了混乱，并告诉我开发人员至少和我感觉的一样困惑。

对于非布尔值，我想你可以做任何事情......如果`if`s 捕获与相关代码相关的状态，那么忽略其他情况并没有什么害处。如果将来很有可能需要更多案例，那么为了清楚起见，评论可能足以表明这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T08:24:13.263

如前所述，在开发阶段，您应该尽快使其可见。在发布阶段，这取决于达到这种无效状态的关键程度。

至少是为了调试目的发布日志。

然后，您可以尝试通过返回到先前的有效状态或转到新的有效状态来从该无效状态中恢复。

最后，如果不能做任何安全的事情，您可以终止执行（向用户发出警报并将日志发送给维护者）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T07:44:14.420

第三个选项是正确的，就好像对于该部分而言，任何其他状态都无效，因此它应该抛出异常并表示无效状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T07:54:24.363

不要做任何事。如果您只关心灯是否亮起：

```
if (Light.On) {
    // do some work
} else {
    // too darned dark to work
} 
```

否则，您应该枚举所有状态。

如果不允许其他状态，则应出错。如果它们被允许但无关紧要，请忽略它们。使用正确设计的代码，没有问题。

您的主要问题在于可以同时设置 Light.On 和 Light.Off 的设计。您应该使用状态 Light.State ，它设置为 {on, flickering, off, broken, unplugged, exploded, emitting_dangerous_gamma_rays} 等之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T08:06:10.843

抛出异常。

正如你所说，第三种情况永远不应该发生。如果确实发生了，那么就出了问题，你不知道还有什么问题。

您也不希望调用代码认为代码正常工作，而实际上它失败了。

此外，它使在发布之前发现问题变得更加容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T08:26:43.897

在开发版中，只要抛出一个异常。

在发布版本中：

*   抛出异常
*   如果可能，将用户的工作保存在一些临时文件中
*   保存故障转储并（使用小型帮助应用程序）为用户提供将其发送给您的选项，以便您识别和解决问题

# sqlite - sqlite，更新或替换

> ID：750676
> 
> 赞同：12
> 
> 时间：2009-04-15T07:42:40.040
> 
> 标签：sqlite

我做类似的事情

更新或替换 someTable SET a=1, b=2 WHERE c=3

我希望如果它不存在，它将被插入到数据库中。但没有任何反应，我没有收到任何错误。我如何插入数据，如果它已经存在则替换它并使用 where 作为条件（而不是替换唯一 ID 的 BC）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-11-23T07:49:36.613

小心，插入或替换没有“更新或替换”的预期行为。

如果您没有为所有字段设置值，则 INSERT OR REPLACE 将用默认值替换它们，而使用 UPDATE 您希望保留旧值。

例如，请参阅我的答案：[SQLite - UPSERT *not* INSERT or REPLACE](https://stackoverflow.com/questions/418898/sqlite-upsert-not-insert-or-replace/4253806#4253806)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-15T08:03:17.587

尝试

```
INSERT OR REPLACE INTO [someTable] (a,b) VALUES(1,2) WHERE c = '3' 
```

# vb6 - VB如何使文件可写？

> ID：750679
> 
> 赞同：5
> 
> 时间：2009-04-15T07:43:53.673
> 
> 标签：vb6, permissions

我正在寻找最简单的方法来测试文件是否可写，以及它是否是只读的以更改其访问权限以使其可写。

欢迎任何正确方向的建议或指示！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T08:01:44.253

文件不可写的原因有很多，例如：

*   它是写保护的
*   它位于只读介质（例如 CD-ROM）上
*   用于运行代码的用户帐户没有文件的写入权限
*   该文件位于不允许写入的文件共享上

您可以检查其中的一些，但唯一确定的测试方法是实际尝试打开文件进行写入。

您可以使用[GetAttr](http://msdn.microsoft.com/en-us/library/hds568h4.aspx)和[SetAttr](http://msdn.microsoft.com/en-us/library/a5wx7516.aspx)函数来查找和更改只读标志。

文件不可写的某些原因根本无法修复（如 CD-ROM 上的文件），或者无法从您的程序中修复。如果用户帐户没有对该文件的写入权限，则它不太可能具有更改权限的权限...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T15:21:18.273

**使用 GetAttr 和 SetAttr**

```
Dim attributes As VbFileAttribute

attributes = GetAttr("C:\foo.txt")
If (attributes And vbReadOnly) Then
  attributes = attributes - vbReadOnly
  SetAttr "C:\foo.txt", attributes
End If 
```

**使用 FileSystemObject**（需要对 Microsoft Scripting Runtime 的项目引用）

```
Dim fso As New FileSystemObject
Dim fil As File

Set fil = fso.GetFile("C:\foo.txt")
If (fil.attributes And ReadOnly) Then
  fil.attributes = fil.attributes - ReadOnly
End If 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-15T07:59:47.660

```
'Getting and Setting File Attributes

Declare Function SetFileAttributes Lib "kernel32" _
 Alias "SetFileAttributesA" (ByVal lpFileName As _
 String, ByVal dwFileAttributes As Long) As Long
Declare Function GetFileAttributes Lib "kernel32" _
 Alias "GetFileAttributesA" (ByVal lpFileName As _
 String) As Long

Public Function GetAttributes(Filename As String, _
 Archive As Boolean, Hidden As Boolean, _
 ReadOnly As Boolean, System As Boolean)

    'Dimension and setup some variables.
    Dim Data As Long
    Archive = False: Hidden = False: ReadOnly = False

    'Get Data and check for success.
    Data = GetFileAttributes(Filename)
    If Data = 0 Then GetAttributes = 0 Else GetAttributes = 1

    'Work out what it is.
    If Data = 128 Then Exit Function
    If Data - 32 >= 0 Then Archive = True: Data = Data - 32
    If Data - 4 >= 0 Then System = True: Data = Data - 4
    If Data - 2 >= 0 Then Hidden = True: Data = Data - 2
    If Data - 1 >= 0 Then ReadOnly = True: Data = Data - 1

End Function

Public Function SetAttributes(Filename As String, _
Archive As Boolean, Hidden As Boolean, _
ReadOnly As Boolean, System As Boolean)

    'Dimension a Variable.
    Dim Data As Long

    'Work out what Data should be.
    Data = 0
    If Archive = True Then Data = Data + 32
    If Hidden = True Then Data = Data + 2
    If ReadOnly = True Then Data = Data + 1
    If System = True Then Data = Data + 4
    If Data = 0 Then Data = 128

    'Set the attributes and check for success.
    SetAttributes = SetFileAttributes(Filename, Data)

End Function 
```

# java - 在 Vista 中将全局应用程序数据放在哪里？

> ID：750698
> 
> 赞同：3
> 
> 时间：2009-04-15T07:52:12.030
> 
> 标签：java, windows-vista, permissions, directory, global

我应该在 Windows (Vista) 系统中的什么位置放置每个人（即计算机的每个用户）都应该可读*和可写的数据？*Vista 的 C:\Users\xxx\AppData\something、C:\Program Files 和 C:\ProgramData 目录和 UAC 的概念有点混乱。

此外，是否有任何现成的解决方案可以使用 Java 确定这些位置？我想它需要与本机库进行一些交互，因为 System.getProperties 只有 user.home 和 user.dir，它们都不是全局可写的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T08:09:08.043

在 vista 中 c:\ProgramData 是这个位置，它取代了 XP 中的 C:\Documents and Settings\AllUsers\AppData。

我不确定在 java 中执行此操作的细节。但是，如果您能掌握它，ALLUSERSPROFILE 环境变量会为您提供路径。您应该始终使用它而不是硬编码路径，因为文件夹名称在不同的国际化版本的操作系统上会发生变化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-20T05:20:26.467

如果您需要允许没有管理员权限的用户修改全局设置，那么正确的方法是为应用程序创建一个安装程序，并在安装期间设置“通用应用程序数据”文件夹的权限，以便允许用户区域写给它。

看到这篇文章：[在哪里放置常见的可写应用程序文件？](https://stackoverflow.com/questions/147016/where-to-put-common-writable-application-files)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T08:55:12.067

除非数据真的很大，否则你可能想看看[Preferences API](http://java.sun.com/j2se/1.4.2/docs/guide/lang/preferences.html)；特别是[`Preferences.systemNodeForPackage`](http://java.sun.com/javase/6/docs/api/java/util/prefs/Preferences.html#systemNodeForPackage(java.lang.Class))。这为您提供了一个独立于平台、系统范围、后端不可知的存储设施，如果这就是您所追求的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T09:00:05.940

> 此外，是否有任何现成的解决方案可以使用 Java 确定这些位置？

您可以检查适当的环境变量，例如 %PROGRAMDATA%、%PROGRAMFILES% 等。

# python - 检索/打印执行上下文

> ID：750702
> 
> 赞同：3
> 
> 时间：2009-04-15T07:55:08.543
> 
> 标签：python

编辑：这个问题在 apphacker 和 ConcernedOfTunbridgeWells 的帮助下得到了解决。我已经更新了代码以反映我将使用的解决方案。

我目前正在编写一个群体智能模拟器，并希望为用户提供一种简单的方法来调试他们的算法。在其他输出中，我认为在算法的每个步骤开始时为用户提供执行上下文的打印输出是有益的。

以下代码实现了我所需要的。

```
import inspect

def print_current_execution_context():
    frame=inspect.currentframe().f_back #get caller frame
    print frame.f_locals #print locals of caller

class TheClass(object):
    def __init__(self,val):
        self.val=val
    def thefunction(self,a,b):
        c=a+b
        print_current_execution_context()

C=TheClass(2)
C.thefunction(1,2) 
```

这给出了预期的输出：

```
{'a': 1, 'c': 3, 'b': 2, 'self': <__main__.TheClass object at 0xb7d2214c>} 
```

感谢 apphacker 和 ConcernedOfTunbridgeWells 向我指出了这个答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T08:04:10.520

尝试：

```
class TheClass(object):
    def __init__(self,val):
        self.val=val
    def thefunction(self,a,b):
        c=a+b
        print locals()

C=TheClass(2)
C.thefunction(1,2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T08:04:29.100

您可以使用`__locals__`来获取本地执行上下文。有关可能相关的一些讨论，请参阅[此 stackoverflow 帖子。](https://stackoverflow.com/questions/541329/is-it-possible-to-programmatically-construct-a-python-stack-frame-and-start-execu)

# r - 在批处理模式下使用 R 抑制“空设备”输出

> ID：750703
> 
> 赞同：33
> 
> 时间：2009-04-15T07:55:21.197
> 
> 标签：r, bash, plot, suppress-warnings

我有许多 bash 脚本，它们调用 R 脚本来绘制东西。就像是：

```
#!/bin/bash
R --vanilla --slave <<RSCRIPT
cat("Plotting $1 to $2\n")
input <- read.table("$1")
png("$2")
plot(as.numeric(input[1,]))
dev.off()
RSCRIPT 
```

问题是尽管如此`--slave`，对`dev.off()`打印消息的调用`null device 1`。一旦完成了很多绘图，或者对于绘图到多个文件的更复杂的脚本，这将是一个真正的麻烦。

有什么方法可以抑制这个消息吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-15T07:59:03.777

我没有充分的理由知道`dev.off()`，与设备相关的函数不同，比如`png()`返回一个值：“新活动设备的编号和名称”。该值是回显到标准输出的值。

因此，只需将其放在某处即可实现抑制它，即

```
garbage <- dev.off() 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-15T11:45:36.180

R 的优点之一是您可以查看许多函数的源代码：

```
> dev.off
function (which = dev.cur()) 
{
    if (which == 1) 
        stop("cannot shut down device 1 (the null device)")
    .Internal(dev.off(as.integer(which)))
    dev.cur()
}
<environment: namespace:grDevices> 
```

所以它调用`.Internal(dev.off(...))`然后返回 dev.cur()，我想如果你有几个设备打开，这样你就知道哪个设备激活了，这会很有用。您可以`.Internal(dev.off(as.integer(dev.cur())))`在脚本中使用，甚至可以使用补丁`dev.off`来仅返回`dev.cur()`null 设备以外的值，并将补丁发送给 R 的维护者。

此外，`graphics.off()`调用`dev.off()`所有设备并且不返回任何内容。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-06-16T12:47:45.863

最近遇到了同样的问题，并注意到这里的答案中没有提到另一种可能性：

```
invisible(dev.off()) 
```

这将隐藏输出`dev.off()`并且不会创建其他变量，这与将输出分配给变量不同`garbage`：`garbage <- def.off()`会。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T08:51:01.157

另一种选择是使用`sink()`所有内容并将其输出到日志文件中，以便您可以根据需要检查绘图是否有效。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-23T13:18:21.290

您可以使用[littler](http://dirk.eddelbuettel.com/code/littler.html "更小")代替，这是 a) 编写 R 'scripts' 的一种更简单的方法，并且 b) 抑制输出，因此您可以得到 dev.off 保持沉默的副作用：

```
$ foo.r /tmp/foo.txt /tmp/foo.png
Plotting /tmp/foo.txt to /tmp/foo.png
$ cat /tmp/foo.r
#!/usr/bin/r
cat("Plotting", argv[1], "to", argv[2], "\n")
input <- read.table(argv[1])
png(argv[2])
plot(as.numeric(input[1,]))
dev.off()
$ 
```

Rscript 也可能会起作用；我倾向于更小。

# iphone - UITabBarController 和 UINavigationController

> ID：750706
> 
> 赞同：2
> 
> 时间：2009-04-15T07:55:34.940
> 
> 标签：iphone

我有一个 UITabBarController 应用程序，我想在其中一个选项卡中有一个 UINavigationController，所以我该如何实现这一点，谢谢提前帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-08T18:42:48.110

[http://www.cimgf.com/2009/06/25/uitabbarcontroller-with-uinavigationcontroller-using-interface-builder/](http://www.cimgf.com/2009/06/25/uitabbarcontroller-with-uinavigationcontroller-using-interface-builder/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-19T12:40:31.320

我更喜欢以编程方式进行这里是[如何使用 uinavigationcontroller 和 uitabbarcontroller的示例](http://www.ccsprite.com/ios/uinavigationcontroller-uitabbarcontroller-example-programmatically.html)

# java - 有没有办法为 SWT 组件启用双缓冲？

> ID：750709
> 
> 赞同：3
> 
> 时间：2009-04-15T07:57:44.527
> 
> 标签：java, swt, eclipse-rcp

在我正在构建的 Eclipse RCP 应用程序中，我注意到当我重建部分 GUI（通过添加/删除控件）时，GUI 会在每次修改后立即更新和重绘，这会导致闪烁效果。

有没有办法启用双缓冲，这样 GUI 刷新只会在事件分派周期结束时发生一次？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T18:15:07.663

尝试：

```
Control#setRedraw(false);
...
modify
...
Control#setRedraw(true); 
```

# oracle - Oracle 中的 REF CURSOR 与 TABLE 函数

> ID：750718
> 
> 赞同：5
> 
> 时间：2009-04-15T08:01:58.560
> 
> 标签：oracle

我有 PL-SQL 包，它在必须作为 CRUD 操作的一部分检索数据时返回 REF 游标。如果将这些游标替换为 TABLE 函数会更快吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T08:31:14.230

[如果您计划使用流水线表函数](http://www.akadia.com/services/ora_pipe_functions.html)，IMO TABLE 函数会更有用。它不会更快，因为 REF 只是对内存的引用。并且所有的工作（解析、执行、获取等）都将在返回 REF Cursor 的函数之外进行处理。REF 光标增加了灵活性，但不利于支持。这是“MacLochlainns 博客”中关于 REF 游标和流水线函数的另一篇文章 -[参考游标 - 为什么、何时以及如何？](http://blog.mclaughlinsoftware.com/tag/ref-cursor/)

# entity-framework - 多对多关系的实体 Sql

> ID：750719
> 
> 赞同：2
> 
> 时间：2009-04-15T08:02:11.600
> 
> 标签：entity-framework, linq-to-entities, ado.net-entity-data-model, entity-sql

考虑两个具有多对多关系的表 Bill 和 Product。如何使用 Entity Sql 获取特定产品的所有账单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T23:49:06.213

像这样的东西

```
SELECT B FROM [Container].Products as P
OUTER APPLY P.Bills AS B
WHERE P.ProductID == 1 
```

将为每个 Bill 生成一行

另一种选择是这样的：

```
SELECT P, (SELECT B FROM P.Bills)
FROM [Container].Products AS P
WHERE P.ProductID == 1 
```

这将为每个匹配的产品（在这种情况下只有一个）生成一行，并且该行中的第二列将包含一个包含该产品账单的嵌套结果集。

希望这可以帮助

亚历克斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T08:38:11.170

你需要像这样使用一些linq；

```
...
using (YourEntities ye = new YourEntities())
{
   Product myProduct = ye.Product.First(p => p.ProductId = idParameter);
   var bills = myProduct.Bill.Load();       
}
... 
```

这假设您已使用实体框架为您的数据构建模型。bills 变量将保存与您的产品对象相关的 Bill 对象的集合。

希望能帮助到你。

# sql-server - Char(4) 作为主键

> ID：750727
> 
> 赞同：2
> 
> 时间：2009-04-15T08:04:07.400
> 
> 标签：sql-server

经典的数据库表设计将包括一个`tableId int index(1,1) not null`导致自动增量 int32 id 字段的结果。

但是，为这些数字赋予一些含义可能会很有用，我想知道人们对将 Char(4) 字段用于包含可枚举的表的想法。

具体来说，我正在考虑一个包含以下数据的用户角色表；

```
"admn" - "Administrator"
"edit" - "Editor". 
```

然后我可以在我的代码中引用这些“代码”。

**更新**
在编写代码以查看 User.IsInRole("admin") 而不是 User.IsInRole(UserRoles.Admin) 时更有意义，其中 Admin 是一个 int，如果您重建数据库，则需要更新/同步。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T08:16:09.820

id 字段（与数据无关）称为代理键。他们有他们的优点和缺点。您可以在[此 Wikipedia 文章](http://en.wikipedia.org/wiki/Surrogate_key)中查看这些列表。我个人觉得人们过度使用它们并且已经忘记（或从未学会）如何正确[规范化数据库结构](http://en.wikipedia.org/wiki/Database_normalization)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T08:08:06.530

我总是倾向于在我的表中使用代理主键。即，在业务领域中没有任何意义的密钥。主键只是数据库所需的管理数据...

在这种情况下，使用“admn”作为主键有什么好处？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T08:19:57.970

不，不，不，不，不，不。

密钥不是数据。键没有意义。这样，当意义改变时，键不会改变。

键没有*编码*的含义。除非您有解码它的算法，否则编码的含义甚至可能没有用处。

既然没有查找就无法从“admn”到“Aministrator”，而且由于真正的含义，“Administrator”紧挨着 SEKRET ENKODED“有用”键，我为什么要查看键而不是表中的真实数据就在它旁边？

如果你想要一个缩写形式，一个类似枚举的名称，或者你有什么，那么*称之为*并意识到它是*data*。这是完全可以接受的。`create table( id int not null primary key, abbv char(4), name varchar(64));`

但它不是键，它不像整数键那样散列，它需要四个字符比较并查找空终止符以将其与“edtr”进行比较，而不是一个减法来比较两个整数。没有合适的方法来生成下一个密钥：序列中的下一个是什么（'admn'，'edtr'，？）？

因此，您失去了生成能力、易于比较、可能的大小（如果您可以使用 day、tinyint 作为您的键），以及所有没有实际用途的任意值。

使用合成密钥。如果您确实需要缩写，请将其设为属性列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T08:18:32.933

如果主键永远不会改变，它会更好。只要更新对它的所有引用，就可以更改主键，但这有点麻烦。

有时，表中没有自然不变的列，在这种情况下，代理项很有用。

但是，如果您有一个自然不变的值（例如从未回收过的员工 ID 或您从未期望更改的一组角色），那么最好使用它。

否则，您将引入复杂性以迎合发生可能性很小的事情。

这只是我的看法，我的名字不是 Codd 或 Date，所以不要把这当成福音。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T08:24:48.270

我想答案就在你的帖子里。您的 User.IsInRole("admin") 示例将始终返回 false，因为您的主键为 char(4) 并使用“admn”作为管理员的键。

我会选择一个永远不会改变的代理主键，并且可以选择“功能主键”来查询在代码中硬编码使用的某些角色。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T08:25:04.230

键本身最好没有任何特殊含义。条件往往会发生变化，因此如果键的含义发生变化，您可能必须更改键，而更改键不是您想要做的事情。

此外，当您可以放入密钥的信息量非常有限时，将其放在那里并没有多大意义。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T08:25:27.363

您正在比较自动增量与固定 char 键，但在这种情况下，您不需要自动增量 id。

有不同的路线可以走。一种是使用映射到 int id 的枚举。这些不是自动递增的，并且是表的主键。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T08:08:42.410

硬代码 => 数据库引用总是一个坏主意！（除非您在应用程序启动之前设置它们等）

除此之外：*来自 admn=>administrator 的映射真的应该在数据库中完成吗？*

而且您只能使用 varchar4 和 LATIN 23char 字母表存储***23^4-（关键字）条目。***

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T12:16:32.957

如果您使用不相关的数字作为主键，则称为代理键，并且有一类人认为这是最佳实践。

[http://en.wikipedia.org/wiki/Surrogate_key](http://en.wikipedia.org/wiki/Surrogate_key)

如果您使用“admn”作为主键，那么它被称为自然键，另一类开发人员认为这是最佳实践。

[https://en.wikipedia.org/wiki/Natural_key](https://en.wikipedia.org/wiki/Natural_key)

他们俩永远不会同意。这是一场古老的宗教战争（代理键与自然键）。因此，使用你最舒服的。只要知道对于每个不同意的人都有很多人支持您的观点——无论您选择哪一个。

# vb.net - 获取此项目在 cc.net 中没有任何测试错误

> ID：750732
> 
> 赞同：1
> 
> 时间：2009-04-15T08:06:20.670
> 
> 标签：vb.net, msbuild, nunit, cruisecontrol.net, watin

使用 cc.net 运行测试时收到以下警告

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Microsoft.Common.targets (,)：警告 MSB3245：无法解析此引用。找不到程序集“nunit.framework，Version=2.4.8.0，Culture=neutral，PublicKeyToken=96d09a1eb7f44a77，processorArchitecture=MSIL”。检查以确保该程序集存在于磁盘上。如果您的代码需要此引用，您可能会遇到编译错误。C:\srce\TP\ITTests\ITTests\ITTests\Tests.vb (1,)：警告 BC40056：在 Imports 'NUnit.Framework' 中指定的命名空间或类型不包含任何公共成员或找不到。确保命名空间或类型已定义并包含至少一个公共成员。确保导入的元素名称不使用任何别名。C:\srce\TP\ITTests\ITTests\ITTests\kingTests.vb (1,)：警告 BC40056：Imports 'NUnit.Framework' 中指定的命名空间或类型不包含任何公共成员或找不到。确保命名空间或类型已定义并包含至少一个公共成员。确保导入的元素名称不使用任何别名。

测试运行：0，失败：0，未运行：0，时间：0 秒
没有测试运行此项目没有任何测试

知道为什么吗？因为所有路径似乎都是正确的

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T08:33:21.777

您是否在 CC.NET 服务器上安装了 NUnit？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-15T01:54:18.850

首先要检查的是您的 CCNET 日志文件。（假设已启用）日志可以在与巡航控制程序相同的文件夹中找到。它可能表明您正在尝试测试一个不存在的 DLL。（也许您正在尝试测试 Debug DLL 而不是 Release DLL，反之亦然）

# asp.net - ASP.NET 文件上传和 AJAX

> ID：750746
> 
> 赞同：2
> 
> 时间：2009-04-15T08:13:29.687
> 
> 标签：asp.net, ajax, file-upload

我对 FileUpload 和 uploadpanels 有一点问题。

大多数人可能都知道，如果不强制回发，就不能使用 asp:FileUpload 控件。至少不是我所知道的，如果我错了，请告诉我。

现在我的问题是：我有一个带有 FileUpload 的用户控件和一个显示“Upload”的按钮。此 UserControl 被加载到 UpdatePanel 中。现在我想注册到用户控件内的上传按钮作为回发触发器。有没有办法做到这一点？

有谁知道在没有回发的情况下进行文件上传的方法？

最好的问候 真正的午睡者

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T09:05:35.753

解决了这个问题

如果有人遇到此挑战，则可以通过在 UserControl 中执行此操作来解决

```
ScriptManager sman = ScriptManager.GetCurrent(Page);
sman.RegisterPostBackControl(btn_addDocument); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T08:17:40.720

您需要向 UpdatePanel 控件添加触发器，以强制提交页面的按钮执行完整的回发。一个例子是：

```
<triggers>
        <asp:postbacktrigger controlid="btnSave" />
</triggers> 
```

# hibernate - 数据传输对象和事务服务方法

> ID：750757
> 
> 赞同：4
> 
> 时间：2009-04-15T08:18:03.467
> 
> 标签：hibernate, transactions, lazy-loading, dto, data-transfer-objects

在通过 Hibernate 支持的事务服务方法传递数据时，是否有任何真正实用的方法可以避免使用 DTO？换句话说，DTO 是避免延迟初始化问题的唯一非 hacky 解决方案吗？

我认为 DTO 的两种流行替代方案以及我不太喜欢它们的原因是：

1.  在视图模式中打开会话。这是我不喜欢的，因为我想让服务方法真正具有事务性（即，当方法退出时，Hibernate 会话被提交并关闭）。这主要是因为如果我以后需要将服务发布为 Web 服务，我不想担心事务。

2.  通过服务方法而不是 DTO 传递域/业务对象，并急切地获取所需的属性/属性。这要好一些。然而，在具有复杂实体关系的非平凡领域对象层次结构中，急切的获取必须在某处停止。当它发生时，我看不出这不会很快变成一个完整的hackaton，用整个地方的引用ID替换实体。

从可维护性的角度来看，我是否遗漏了什么或者 DTO 实际上是唯一可靠的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T11:05:14.063

存储库、服务和控制器应该是处理应用程序核心的地方（如果您愿意，Hibernate Session 当然可以用作整个存储库层）。

视图不应该处理您的应用程序核心，即域模型。他们不应该处理活动对象，而是处理活动对象的非活动、定制表示。视图应该只以他们需要的特定格式传递他们需要的数据。您应该为您的视图构建 DTO。这种模式也被称为视图模型，与领域模型形成对比。

为了让您的生活更轻松，可能有一些库或框架可以从您的域模型对象自动映射到您的视图模型对象，然后再返回。在 .NET 中，目前正在开发一个名为 AutoMapper 的开源框架；我不确定Java有什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:45:58.557

真正端到端使用实体的唯一方法是使用比 OpenSessionInView 更复杂的东西。根据我的经验，您将不得不在应用程序级别手动管理休眠会话。OpenSessionInView 只会为一个请求提供相同的会话。之后，您需要不断地重新连接到当前会话。看看 Seam 和对话，或者实现你自己的 Hibernate Session 管理。我们目前根据向导的开始和结束时间手动管理会话，并使用 Spring AOP 将会话及时附加到正确的线程（会话不是线程安全的，不能很好地与 AJAX 混合）

另一方面，WebServices 肯定需要某种形式的 DTO。我看不出有什么办法。实体可能看起来像 POJO，但实际上并非如此，序列化它们的范围从困难到几乎不可能。只需创建符合服务方法目标的 DTO 并完成它。

就我个人而言，我不认为 DTO 模式很糟糕，如果您只是在制作一个网站，那么与实体进行端到端是可行的，它甚至可以为您带来一些性能，但如果您想要更灵活的架构，请坚持DTO。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:56:35.550

如果您放宽关闭会话的要求，您仍然可以在视图中使用打开的会话，只需提交服务事务中的所有内容。该会话仍可用于延迟获取，但您的所有事务都将完成。但是，如果您要切换到 Web 服务，那么无论如何您都需要预先加载所有实体。DTO 只是迫使您有意识地急切加载并防止意外懒惰。

因此，最重要的是，如果您小心，您可以在两种环境中跳过 DTO，但我可能会坚持使用开放会话，并在 Web 服务真正成为要求时担心它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-19T16:49:07.917

我喜欢 DTO 的想法，但我一直觉得它们并没有被其他开发人员很好地接受或喜欢，因为正确地实现这种方法一直到数据库通常需要付出很多努力。这就是我创建[Blaze-Persistence 实体视图](https://github.com/Blazebit/blaze-persistence#entity-view-usage)的原因，它允许您将 DTO 建模为以有效方式映射到 JPA 实体模型的接口。您可以将实体视图应用于查询，并且查询将以仅获取实际需要的状态的方式进行调整，而不是获取所有状态并在 Java 中映射。

通过使用实体视图，您不需要在视图反模式中打开会话，因为所需的结构已被急切地加载。由于不涉及实体对象，因此也不会出现延迟加载问题。

由于实体模型在早期开发阶段通常与 DTO 模型非常相似，因此我经常看到开发人员只是跳过创建单独的 DTO 模型，因为他们试图避免麻烦。一旦实体模型中出现审计、统计或非规范化等横切关注点，或者实体模型中的数据量比实体用例实际需要的数据量大得多，开发人员就会遇到问题。

你肯定会喜欢我前段时间写的关于这件事的[博客文章。](https://blazebit.com/blog/2016/getting-started-with-blaze-persistence-entity-views.html)

# java - Eclipse 类设计器和设计<--> java 源绑定

> ID：750760
> 
> 赞同：3
> 
> 时间：2009-04-15T08:18:54.820
> 
> 标签：java, eclipse, rapid-prototyping

我正在大学辅导二/三年级学生的快速原型制作课程。

任何人都可以推荐一种（免费）方法来在 Eclipse 的 GUI 设计表面中设计类层次结构吗？

Eclipse Modeling Tools 中的 UML 设计表面几乎是完美的，但我找不到任何关于如何将它们绑定到 java 源文件的文档。

*撇开您关于软件应该如何设计的个人意识形态不谈，我们拥有一个可视化工具非常重要。*

我在视觉工作室中被双向设计师宠坏了，以进行源映射。我希望为我的学生提供类似的工具，但我需要一些建议来实现这一目标。

任何帮助是极大的赞赏。

**更新：**下学期我实际上不是在辅导 OOD，而是在快速原型设计和软件架构上。本主题的目的是教授一些利用设计模式的快速设计技术，使用 serverlet 交付网页等。*学习*OOD 的学生目前使用 BlueJ。本主题旨在通过真正的 IDE 加强并推动他们深入。

**更新**我正在使用带有 UML 插件的 NetBeans，它非常非常好。唯一的问题是它需要手动点击“生成代码”和“逆向工程代码”按钮。比Eclipse好得多。到目前为止，Netbeans 正在赢得这场战争。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T08:30:55.697

[BlueJ](http://www.bluej.org/about/what.html)是一个 GUI Java IDE，它允许学生从 UML 图转到代码。它是免费的，最近开源。

它还支持类似于流行的 Eclipse 扩展的扩展：PMD、checkstyle 等。

它专为教学而设计：

> BlueJ 环境是作为大学研究项目的一部分而开发的，该项目旨在向初学者教授面向对象。
> 
> BlueJ 的目标是为 Java 语言提供一个易于使用的教​​学环境，以促进 Java 对一年级学生的教学。特别强调可视化和交互技术，以创建鼓励实验和探索的高度交互环境。

它包括几个[教程](http://www.bluej.org/doc/documentation.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-30T18:42:46.103

当然，在开始学习 Java 时，BlueJ 可以提供很多很酷的东西，但是如果您必须将 Eclipse 用作更“真实”的 IDE，我会推荐 OmondoUML 插件，甚至更好的是 Soyatec 的 eUML 插件。两者都在 uml/建模基础设施上实现，并提供了非常好的前向和后向代码生成支持。

# windows - 网络共享文件夹上的 GIT 存储库中的并发性

> ID：750765
> 
> 赞同：52
> 
> 时间：2009-04-15T08:21:38.403
> 
> 标签：windows, linux, git, concurrency, network-share

我想在（Windows）网络共享上存储一个裸 git 存储库。我使用 linux，并使用 CIFS 安装了上述网络共享。我的同事使用 windows xp，并将网络共享自动挂载（从 ActiveDirectory，不知何故）作为网络驱动器。

我想知道我是否可以使用两台计算机上的 repo，而不会出现并发问题。

我已经测试过了，最后我可以克隆，但我担心如果我们都同时访问同一个仓库（推/拉）会发生什么。

在 git FAQ 中有一个关于使用网络文件系统的参考（以及 SMBFS 的一些问题），但我不确定网络/服务器/windows/linux 是否有任何文件锁定 - 我很确定有不。

那么，有没有人在网络共享上使用过 git repo，没有服务器，也没有问题？

谢谢你，
亚历克斯

PS：我想避免使用 http 服务器（或 git-daemon），因为我无权访问具有共享的服务器。另外，我知道我们可以从一个推/拉到另一个，但是出于备份原因，我们需要在共享上拥有代码/存储库。

**更新：**

我担心的不是网络故障的可能性。即便如此，我们将在本地拥有所需的分支，并且我们将能够编译我们的源代码。

但是，我们通常经常提交，并且需要经常变基/合并。从我的角度来看，最好的选择是在共享上建立一个中央存储库（这样可以确保备份），我们都将从该共享库中克隆，并使用它来变基。

但是，由于我们经常这样做，我担心**文件/repo 损坏**，如果碰巧我们同时推/拉。通常，我们每次访问远程仓库时都可以互相*大喊大叫*:)，但最好由计算机/网络保护它。

而且，GIT 可能有一个内部机制来执行此操作（因为有人可以在您处理它时推送到您的一个存储库），但我还没有发现任何结论性的东西。

**更新 2：**

共享驱动器上的存储库将是一个**裸**存储库，不包含工作副本。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-04-15T10:10:42.977

Git 需要最少的文件锁定，我认为这是在网络文件系统上使用这种共享资源时出现问题的主要原因。它可以逃脱的原因是 Git 存储库中的大多数文件——所有构成对象数据库的文件——都被命名为它们的内容摘要，并且一旦创建就不可变。因此，不会出现两个客户端尝试将同一文件用于不同内容的问题。

对象数据库的另一部分比较复杂——引用存储在“refs”目录下（或“packed-refs”）的文件中，并且这些文件确实会发生变化：尽管`refs/*`文件很小并且总是被重写而不是被编辑。在这种情况下，Git 将新 ref 写入临时“.lock”文件，然后将其重命名为目标文件。如果文件系统尊重`O_EXCL`语义，那是安全的。即使没有，可能发生的最坏情况也将是覆盖 ref 文件的竞赛。虽然遇到这种情况会很烦人，但它不应该导致损坏：可能只是您推送到共享存储库的情况，并且推送看起来成功了，而实际上其他人已经成功了。但这可以简单地通过拉（合并到另一个人中）来解决

总而言之，我不认为 repo 损坏是一个太大的问题 --- 确实由于锁定问题，事情可能会出错，但 Git repo 的设计会将损害降到最低。

（免责声明：理论上这一切听起来都不错，但我没有对 repo 进行任何并发锤击来测试它，并且只通过 NFS 而非 CIFS 共享它们）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-15T08:25:34.447

何苦？Git 是为分布式而设计的。只需在每台机器上都有一个存储库，并使用发布和拉取机制在它们之间传播您的更改。

出于备份目的，运行一个夜间任务将您的存储库复制到共享中。

或者，在共享上分别创建一个存储库并从中完成工作，但将它们用作分布式存储库，您可以从中提取变更集。如果您使用这种方法，那么构建等的性能将会降低，因为您将不断地通过网络访问。

或者，在您自己的计算机上分发存储库，并运行定期任务将您的提交推送到共享上的存储库。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-10T17:20:28.053

显然支持使用中央 git 存储库。大多数规定的用途表示 ssh 或 http 访问，两者都不能避免同时访问 repo。即使你在做完全分布式的使用，如果有两个以上的协作者在任何地方推送到同一个 repo，就会出现这个问题。到目前为止，没有任何回应回答了这个问题。git 的设计是否允许它同时处理 N 次推送到一个分支？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-15T08:29:53.623

听起来好像您更喜欢使用集中式版本控制系统，所以备份查询得到了满足。也许在两者之间使用 xxx2git 可以让您在本地工作。

# .net - 使用动态发送端口和 UNC 时出现 Biztalk FileAdapter 错误

> ID：750774
> 
> 赞同：1
> 
> 时间：2009-04-15T08:26:31.107
> 
> 标签：.net, biztalk

我在 Biztalk 2006 中使用动态发送端口，我正在尝试写入 Windows 共享 (UNC) 但得到“访问被拒绝”。

Biztalk 主机进程内用户获得了给定文件夹所需的所有权限。我可以在目标中手动创建一个新文件，但在使用 Biztalk 时不能。

FileAdapter 是否使用另一个主机用户？（我没有添加到 unc 文件夹的权限列表中）

错误： `Error details: The FILE send adapter cannot open file \int.company.as\Biztalk\CodeNA\ImageName_123456_20080227T230000_.xml for writing. Details: Access is denied.`

已编辑：解决方法是先在本地编写，然后使用 File.Move()，但我不明白为什么上述方法不起作用。它适用于我本地笔记本电脑上的共享..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T09:55:09.067

好吧，问题解决了……原因是文件适配器可以在另一个主机进程下运行。（并且这个其他主机进程没有特定文件夹的权限..）

我认为 FileAdapter 遵循了 Orchestration 的凭据，但没有......

# c# - ASP.NET 获取标签的原始文本

> ID：750778
> 
> 赞同：0
> 
> 时间：2009-04-15T08:29:00.943
> 
> 标签：c#, asp.net, vb.net

在文本被更改后，有什么方法可以从页面上的 Asp:Label 获取原始文本？

原始文本是指硬编码到 asp.net 标记中的文本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T08:59:34.490

没有标准的方法可以在一些更改后将其取回，但是您可以通过某些方式来做到这一点，例如将自定义属性添加到标签

```
textLabel.Attributes.Add("data", textLabel.Text); 
```

然后在您的页面上使用它。或者在页面启动时使用 js 代码缓存标签值或静态缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T16:23:03.033

创建一个包装文本分配的属性。在分配之前获取当前值并将其分配给隐藏输入或将其粘贴在会话或视图状态中。

创建一个从隐藏的输入或会话或视图状态中检索先前值的属性。

可以花哨并扩展标签以添加 PreviousValue 属性。不过，不确定这在实践中是如何工作的。

# html - 使用 CSS 无法完成的事情

> ID：750779
> 
> 赞同：12
> 
> 时间：2009-04-15T08:29:06.870
> 
> 标签：html, css

我在这个网站上看到了很多提倡使用表格进行设计的答案，因为它不能使用 CSS 和 Divs 来完成……而实际上它*可以*通过一些独创性来完成。

什么是真正无法完成的事情的例子？

我遇到的唯一一个是将一个盒子垂直对齐另一个盒子。

*编辑：我想我最感兴趣的是使用 CSS2 无法实现的布局

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T08:46:46.377

这个问题的答案取决于许多事情：

*   您需要向后兼容到什么程度？包含 IE6 会降低纯 CSS 的容量；和
*   您的网站有多少是固定宽度和/或固定高度的。在可变宽度和/或高度的情况下，CSS 中的某些事情即使不是不可能也变得困难。

并排内容是 CSS 的一个问题。您可以为此使用浮动，但如果宽度总和超过容器的宽度，尾端浮动将下降到下方。表格在这方面更有能力，因为它们会在可能的情况下挤压列以使内容适合，并且单元格永远不会被拆分到新行上。

你提到的垂直居中。在纯 CSS 中，它与表格无关，而且很难或不可能（取决于兼容性以及容器和项目的固定或可变高度）。

您可能还指悬停内容。IE6 仅支持锚点上的 :hover 伪元素。该浏览器需要 Javascript 才能执行 :hover-like 行为。

基本上，如果你需要做的事情可以用纯 CSS 相当简单地完成，那就去做吧。如果没有，尽管所有的反桌子狂热者（而且他们是狂热者）都惊恐地跳上跳下，但如果你不得不使用桌子，不要感到难过。

如果您想要一个相对简单的示例，请查看[您可以在不使用表格的情况下执行此 HTML 布局吗？](https://stackoverflow.com/questions/522928/can-you-do-this-html-layout-without-using-tables). 这是一个概念上简单的布局问题，对于表格来说是微不足道的，还没有人发布满足纯 CSS 要求的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T09:29:35.243

*   块或文本的垂直对齐。

*   具有可伸展到其内容宽度的弹性容器。

*   具有多个具有相同结构的“行”，其中“单元”在所有行中的宽度同步。

*   让几个“列”同步它们的高度（直到最长文本块的长度）。

这些是非常基本的设计师需求，甚至出现在基本的设计概念中。

如果考虑到 IE8，单元格/列的问题可能会用 CSS 解决，但它的广泛普及还需要很多年（即使 2-3 年内的 IE7 也没有达到预期的市场份额）。

至于“匠心”，在软件开发中可不是什么好东西。您的同事和您自己在几个月后将无法理解的技巧通常会构建每个人都害怕接触或决心完全重构/重写的代码库。

记住 KISS 原则。你这样做的最简单的方法，它会更可靠地工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T08:51:36.053

> “......实际上它可以通过一点独创性来完成。”

在 CSS 中很难做到“避免对独创性的需求”怎么样？

;)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T09:18:37.173

表格应该用于表格数据！我们应该始终尝试为要标记的给定内容使用正确的 HTML。所以不仅仅是 div（span、ul、li、dl、strong、em ... 等），这确保了内容不仅看起来正确而且正确（出于 SEO 和可访问性的原因）

通过不使用表格，它允许我们将内容从一种外观转换为另一种外观，而无需更改 HTML，请参阅[Zen Garden](http://www.csszengarden.com/)

目前，尽管使用当前浏览器可以完成 CSS 表格之类的布局，但很棘手。有一些技术可以解决许多问题，它们是通过具有背景图像的[全局包装器或](http://www.impressivewebs.com/easy-equal-columns-with-css/)[定位修复](http://24ways.org/2008/absolute-columns)来完成的……这两篇文章还提到使用 Javascript 逐步增强页面以获得您可能需要的那些附加类。

或者当然，如果从 CMS 进行处理，您可以使用一些 XSL 作为中间件来帮助进行格式化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T08:35:04.673

表格中的交替行颜色，无需手动（或借助脚本）为每行分配交替样式。

确定一个元素相对于另一个元素的位置。例如，您不能使用 CSS 来确定一个框在使用同一类的一堆浮动框中的哪个位置。例如，如果知道一个盒子是第一个浮动的盒子，还是第二个或最后一个盒子，那就太好了。

处理寡妇。寡妇是一个悬在段落末尾的单词，即一个单词从段落的最后一行开始。这是印刷设计的一个大难题，但在网络世界中却很难控制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T08:48:02.787

多列中的浮动元素，其中每个单元格中的文本可以扩展元素的高度，但如果发生这种情况，必须将下面的整行向下推。

```
 ---   ---   --- 
|AAA| |BBB| |CCC|
 ---   ---   --- 
 ---   ---   --- 
|AAA| |BBB| |CCC|
|   | |BBB| |   |
 ---   ---   --- 
 ---   ---   ---
|AAA| |BBB| |CCC|
 ---   ---   --- 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T08:37:23.060

图像不能放置在具有对齐属性的单元格的确切中心。可以通过一些蛮力来完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T08:46:59.607

听起来很明显，但您不能使用 CSS 更改内容，它只能用于样式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T11:50:03.487

罗里，我认为你是完全正确的。垂直对齐可以使用 line-height 来完成，并且在 CSS 中创建布局并不难。事实上，当使用绝对/相对定位和浮动时，它要灵活得多。

仍在使用表格进行设计的人们应该真正了解当前的标准。

继续话题，随着 CSS3 的出现，很难想到 CSS 不能做的事情。图像处理、内容处理、高级选择器，这一切都将成为可能。但是如果我不得不说出一件事，那就是使用 CSS 你不能（也不会）能够*旋转*元素。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T12:14:39.107

我无法使用透明度在所有页面上创建可变高度的文本区域。我相信这是不可能的。我最终只是编写了一个快速的 javascript 函数来在页面加载后重置高度，以使布局正常工作。请参阅[http://peterchristopher.com](http://peterchristopher.com)以了解我所说的文本区域的透明度是什么意思。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-04-15T08:43:33.967

表格绝对没有 CSS 做不到的事情。

似乎有一个普遍的误解，即 HTML 和 CSS 应该很容易。它不是。如果您发现自己想要使用表格，那么需要改进的是您的 CSS 技能而不是技术（尽管该技术显然有很多可以改进的漏洞）。

# database-design - RDBMS 密钥混淆

> ID：750781
> 
> 赞同：0
> 
> 时间：2009-04-15T08:30:35.977
> 
> 标签：database-design, primary-key, rdbms, normalization

我正在尝试整理我公司网站背后的数据库。

我们与站点和居民打交道。目前，站点引用作为外键包含在 Residents 表中，但显然，这仅在 1NF 中。

站点引用的格式为 nnnnn（例如 12345）。每个居民在 nnn 形式的站点中都有自己的参考（从 001 开始，到最大 999 结束）。

问题是，当我把它带到 2NF 时：

站点（参考、名称、费用）

驻留（站点参考，驻留参考，）

居民（参考，地址，用户名，密码）

居民参考永远不会唯一标识一个居民，如果有 2 个站点，那么将有 2 001。我不能使用用户名，因为这个字段只填充一次（如果！）他们已经注册了我们的网络服务。我只想为居民引入一个新的自动编号 ID，但我有些烦恼的是，有一个更优雅的解决方案。谁能建议它是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T08:58:32.307

您需要从站点“释放”驻留引用 - 例如，将其设为 ResidentID，并确保每个 ResidentID 在 Resident 表中是全局唯一的。每个站点还必须在站点表中具有全局唯一的站点 ID。

只有这样，您才能创建一个好的数据库模式。

Residency 表将提供居民（由其 ResidentID 唯一标识）和站点（再次 - 由其 SiteID 唯一标识）之间的链接。

马克

# database - 文本修订的数据库设计

> ID：750782
> 
> 赞同：8
> 
> 时间：2009-04-15T08:30:44.357
> 
> 标签：database, text, versioning

[这个问题](https://stackoverflow.com/questions/39281/database-design-for-revisions)包含一些关于如何为数字或多项选择字段等数据设计数据库历史/修订方案的优秀内容。

但是，对于大文本字段的讨论并不多，这在博客/问答/wiki/文档类型系统中很常见。

那么，在基于数据库的编辑系统中存储文本字段的历史记录被认为是一种好的做法？将其存储在数据库中是个好主意吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T08:51:59.670

我开发了一个 wiki 引擎，页面/文章修订存储在数据库表中。每个版本都有一个连续的版本号，而“当前”版本用 -1 标记（只是为了避免 NULL）。

修订文本按原样存储，而不是差异或类似的东西。

我认为性能不是问题，因为您不太可能经常访问旧版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T09:03:41.437

鉴于 HDD 技术的当前状态，尝试优化*文本*存储机制是不值得的：`Document (ID, Name)`表`DocumentRevision (ID, DocumentID, Contents)`将完成这项工作。`ID`in`DocumentRevision`也可以用作“存储库”范围的修订号。如果这不是您想要的行为，请`VersionID`为每个文档修订分配一个单独的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T08:54:50.273

通常，跟踪文档版本最明智的方法是跟踪对其所做的更改。然后，如果请求特定版本，则可以从当前文档和部分更改集重建它。

因此，如果您有一种描述文档更改类型的好方法（这在很大程度上取决于文档是什么以及它是如何使用的），那么一定要使用数据库来跟踪更改以及版本。

# r - 在命令行（终端）上使用 R 脚本的最佳方式是什么？

> ID：750786
> 
> 赞同：126
> 
> 时间：2009-04-15T08:31:35.773
> 
> 标签：r, bash, command-line, scripting

使用 R 脚本从命令行进行简单绘图非常方便。但是，从 bash 脚本运行 R 一点也不方便。理想可能是这样的

```
#!/path/to/R
... 
```

或者

```
#!/usr/bin/env R
... 
```

但我无法完成其中任何一项工作。

另一种选择是将脚本纯粹保留在 R 中，例如，并使用或类似方法`script.R`调用它。`R --file=script.R`但是，有时脚本会依赖于晦涩的命令行开关，此时部分代码存在于脚本之外。示例：通过本地 .Rprofile 将东西从 bash 偷偷带入 R，所需的开关就是`--vanilla`除`--no-init-file`.

另一种选择是一个 bash 脚本来存储 R 标志并且可以轻松执行，然后调用 R 脚本。问题在于，这意味着一个程序刚刚被拆分为两个文件，现在必须保持同步，一起转移到新机器上，等等。

我目前最不鄙视的选项是将 R 嵌入 bash 脚本中：

```
#!/bin/bash
... # usage message to catch bad input without invoking R
... # any bash pre-processing of input
... # etc
R --random-flags <<RSCRIPT
# R code goes here
RSCRIPT 
```

一切都在一个文件中。它是可执行的并且很容易处理参数。问题是，像这样结合 bash 和 R 几乎消除了任何 IDE 不会在其中一个或另一个上失败的可能性，并且让我的心非常痛。

我错过了一些更好的方法吗？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2009-06-09T12:03:40.747

内容`script.r`：

```
#!/usr/bin/env Rscript

args = commandArgs(trailingOnly = TRUE)
message(sprintf("Hello %s", args[1L])) 
```

第一行是[shebang line](https://en.wikipedia.org/wiki/Shebang_%28Unix%29)。最佳做法是使用`/usr/bin/env Rscript`而不是硬编码 R 安装的路径。否则，您可能会冒着在其他计算机上破坏脚本的风险。

接下来，使其可执行（在命令行上）：

```
chmod +x script.r 
```

从命令行调用：

```
./script.r world
# Hello world 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-15T11:37:36.170

尝试[更小](http://dirk.eddelbuettel.com/code/littler.html)。`littler`为 GNU R 提供 hash-bang（即以 #!/some/path 开头的脚本）功能，以及简单的命令行和管道使用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-02-11T08:09:30.323

米格尔桑切斯的回应是应该的。执行 Rscript 的另一种方式可能是运行系统范围的 RScript 的“env”命令。

```
#!/usr/bin/env Rscript 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-05T03:50:25.733

`#!/path/to/R`不会工作，因为 R 本身就是一个脚本，所以`execve`不开心。

我用`R --slave -f script`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-03-14T12:13:40.667

如果您有兴趣将命令行参数解析到 R 脚本，请尝试 RScript，它与 R 捆绑在一起，从 2.5.x 版本开始

[http://stat.ethz.ch/R-manual/R-patched/library/utils/html/Rscript.html](http://stat.ethz.ch/R-manual/R-patched/library/utils/html/Rscript.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-02-25T22:22:07.870

这行得通，

```
#!/usr/bin/Rscript 
```

但我不知道如果您的机器上安装了超过 1 个版本的 R 会发生什么。

如果你这样做

```
#!/usr/bin/env Rscript 
```

它告诉解释器只使用路径上首先出现的任何 R。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-15T22:07:38.807

如果您用来执行脚本的程序需要参数，您可以将它们放在 #! 的末尾。线：

```
#!/usr/bin/R --random --switches --f 
```

不知道 R，我无法正确测试，但这似乎有效：

```
axa@artemis:~$ cat r.test
#!/usr/bin/R -q -f
error
axa@artemis:~$ ./r.test
> #!/usr/bin/R -q -f
> error
Error: object "error" not found
Execution halted
axa@artemis:~$ 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-01-15T10:38:30.137

只是要添加到这篇文章的注释。后来的版本`R`似乎`Rscript`有些埋没了。对于 2015 年 1 月下载的 OSX 上的 R 3.1.2-1，我`Rscript`在

```
/sw/Library/Frameworks/R.framework/Versions/3.1/Resources/bin/Rscript 
```

`#! /sw/bin/Rscript`因此，我需要在脚本顶部使用以下内容，而不是类似的内容。

```
#! /sw/Library/Frameworks/R.framework/Versions/3.1/Resources/bin/Rscript 
```

`locate Rscript`可能对你有帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-17T20:35:26.933

您可能想使用 python 的 rpy2 模块。但是，执行此操作的“正确”方法是使用 R CMD BATCH。您可以修改它以写入 STDOUT，但默认是写入 .Rout 文件。请参见下面的示例：

```
[ramanujan:~]$cat foo.R
print(rnorm(10))
[ramanujan:~]$R CMD BATCH foo.R
[ramanujan:~]$cat foo.Rout

R version 2.7.2 (2008-08-25)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

 ~/.Rprofile loaded.
Welcome at  Fri Apr 17 13:33:17 2009
> print(rnorm(10))
 [1]  1.5891276  1.1219071 -0.6110963  0.1579430 -0.3104579  1.0072677 -0.1303165  0.6998849  1.9918643 -1.2390156
>

Goodbye at  Fri Apr 17 13:33:17 2009
> proc.time()
   user  system elapsed
  0.614   0.050   0.721 
```

注意：您需要尝试使用 --vanilla 和其他选项来删除所有启动垃圾。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-09-26T01:23:21.837

尝试使用 smallR 在命令行中编写快速 R 脚本：

[http://code.google.com/p/simple-r/](http://code.google.com/p/simple-r/)

（`r`目录中的命令）

使用 smallR 从命令行绘图将如下所示：

```
r -p file.txt 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-04-15T08:58:03.103

以下适用于我在 Windows 上使用 MSYS bash - 我的 Linux 机器上没有 R，所以不能在那里尝试。您需要两个文件 - 第一个名为**runr**的文件使用文件参数执行 R

```
# this is runr
# following is path to R on my Windows machine
# plus any R params you need
c:/r/bin/r --file=$1 
```

您需要使用**chmod +x runr**使这个可执行文件。

然后在你的脚本文件中：

```
#!runr
# some R commands
x = 1
x 
```

注意#! runr 行可能需要包含 runr 的完整路径，具体取决于您使用命令的方式、PATH 变量的设置方式等。

不漂亮，但它似乎确实有效！

# sql-server - 使用 SQL Server 2008 对靠近点的数据进行平均

> ID：750787
> 
> 赞同：1
> 
> 时间：2009-04-15T08:31:43.027
> 
> 标签：sql-server, sql-server-2008

我有一个应用程序，它从移动设备接收 GPS 数据以及接收坐标数据，它还提供来自 GSM 网络的信号强度。我正在尝试在地图上绘制点以显示信号强度好的区域和信号强度差的区域。当我有几个点时一切正常，从数据库中检索这些点，并围绕该点构建一个正方形，左上角距该点 0.5 公里。然后，我使用颜色编码在 VE 地图上显示方形形状以表示信号强度。问题是可能有成千上万的读数，我需要一种方法来平均那些相距不到 0.5 公里的读数，或者我需要在 SQL Server 中构建正方形（或圆形）并平均十字路口。我不知道从哪里开始，所以任何指向体面的文章或一些提示的指针都将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T04:55:30.073

一种简单但有些不准确的方法是降低数据的粒度。它甚至可能不是不准确的，这取决于您的 x、y 测量值的准确程度。

假设我们有以下数据：

```
x    y   signal_strenth
10.2 5.1 10
10.1 5.3 12
10.3 5.5 8 
```

如果我们对 x 和 y 值求底，我们得到：

```
x    y   signal_strenth    
10   5   10
10   5   12
10   5   9 
```

然后我们可以通过下限 x 和 y 对这些值进行平均，以表明我们在矩形 (10, 5) 到 (11, 6) 中具有平均信号强度。

这是SQL：

```
select 
 floor(x) as rectangle_xmin, 
 floor(y) as rectangle_ymin, 
 floor(x) + 1 as rectangle_xmax, 
 floor(y) + 1 as rectangle_ymax, 
 avg(signal_strength) as signal_strength
from table 
group by floor(x), floor(y); 
```

现在，诚然，理想情况下，您希望按点到点的距离对数据点进行分组，并将它们按从 1 到 square_root(2) =~1.44 的最大距离进行分组，将它们铺成矩形块。所以它不太*理想*。但它可能对您来说足够好，特别是如果地板/分组小于您的位置测量误差。

如果`floor()`粒度不够，可以使用`floor( x *`someweight `) /`someweight 来调整到你想要的粒度。当然，您可以使用`ceil()`或`round()`做同样的事情。

重点是将一堆附近的测量值*折叠*成一个“测量值”，然后取折叠值的平均值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T12:45:57.877

您可能想查看[Delaunay Triangulation](http://en.wikipedia.org/wiki/Delaunay_triangulation "德劳内三角测量")，您可以在其中将 X、Y、Z 坐标绘制成图表。可能在不确切知道点的情况下使用 X、Y 作为位置，然后将 Z 绘制为信号强度并创建尖峰图。我只看过 c++ 示例[CodePlex 示例](http://www.codeproject.com/KB/recipes/kazumi.aspx)，但它可能是您可以为其编写 SQL 函数的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T13:54:45.917

```
SELECT
geography::STPointFromText('POINT(' + CONVERT(varchar, AvgSignalReadings.rect_lngmin / 100) + ' ' + CONVERT(varchar, AvgSignalReadings.rect_latmin / 100) + ')', 4326) as Location,
AvgSignalReadings.lat / 100 as Latitude,
AvgSignalReadings.lng / 100 as Longitude,
AvgSignalReadings.SignalStrength
FROM
(
SELECT 
    FLOOR(l.Latitude * 100) as lat, 
    FLOOR(l.Longitude * 100) as lng, 
    AVG(l.SignalStrength) as SignalStrength,
    COUNT(*) as NumberOfReadings
FROM SignalLog l
WHERE l.SignalStrength IS NOT NULL AND l.SignalStrength <> 0 AND l.Location IS NOT NULL 
AND l.[Timestamp] > DATEADD(month, -1, GETDATE())
GROUP BY FLOOR(l.Latitude * 100), FLOOR(l.Longitude * 100))
AS AvgSignalReadings 
```

# java - 如何调试JVM资源加载？

> ID：750793
> 
> 赞同：14
> 
> 时间：2009-04-15T08:33:26.750
> 
> 标签：java, debugging, jvm, profiling, classloader

要在 JVM 中调试类加载，我们可以使用 param `-verbose:class`，但是... 任何人都知道如何调试资源加载（例如属性文件）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T08:47:43.770

我想你需要看看使用分析器。或者使用仪器接口的东西。

不确定它有多稳定，但是有[BTrace](https://github.com/jbachorik/btrace)，它是一种 Java 版本的 DTrace。

> BTrace 是用于 Java 平台的安全、动态跟踪工具。BTrace 可用于动态跟踪正在运行的 Java 程序。BTrace 动态检测目标应用程序的类以注入跟踪代码（“字节码跟踪”）。跟踪代码以 Java 编程语言表示。

如果您在开发机器上执行此操作，并且事件（正在加载的资源）的数量不是太频繁，您也可以在调试器中设置一个断点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T08:57:32.060

资源以`URL`s 形式提供。所以，我想在“纯”Java 中做到这一点：安装一个将 s`ClassLoader`复制`URL`到一个带有 custom 的版本的自定义`URLStreamHandler`. 将您的监控代码放在流处理程序中并转发到原始代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-19T22:10:34.507

您可以使用[InTrace](http://mchr3k.github.com/org.intrace/)来检测执行加载的 Classloader 类。

对于 Sun JVM，我建议使用以下 Include 模式来跟踪适当的类：

*   类加载器
*   URL类路径
*   装载机

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T10:55:56.707

在 Linux 环境中，您可以尝试：

```
lsof -p <jvm pid> 
```

它将为您提供一个列表，其中包含与指定 pid 关联的程序使用的描述符。

[更多信息](http://linux.die.net/man/8/lsof)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-04T08:40:33.067

有几种技术可以调试**类加载问题**。以下是**JRebel 创建者**总结这些技术的好幻灯片：[你真的得到类加载器吗？](http://www.slideshare.net/guestd56374/do-you-really-get-class-loaders)

# .net - 自动宽度和溢出 div

> ID：750794
> 
> 赞同：0
> 
> 时间：2009-04-15T08:33:31.853
> 
> 标签：.net, html, css, grid

我正在为一个项目创建某种网格。网格有一个特殊要求（这就是我们试图在内部创建一个的原因），中间的列必须是可滚动的。

想象一下情况：我们创建的网格或多或少是这样的：有一个 topcontainer div，其中包含 3 个其他 div 左中容器和右容器。左侧容器包含划分为 4 列的用户信息。中间的 div 包含 x 列（取决于经理选择的周数）和文本框，可以在其中输入某个员工的小时数，右侧的 div 有一些列用于总计和平均值。

回答我的问题：当我使用来自服务器 (asp.net 2.0) 的数据呈现控件或通过 javascript 添加一行并选择用户时，包含 userdata 的左列应该具有动态宽度，我想要在 leftcontainer 中留下列，以便在需要时自动水平调整大小，并且顶部容器中出现一个额外的滚动条（以避免我的 div 垂直分解）我认为第二个 topcontainer div 具有最大宽度，topcontainer div 溢出-x: scroll, + a width: auto 在我的列中应该可以解决问题，但这似乎不起作用。

谁能让我走上正轨？我希望我的解释是可以理解的。无论如何，我添加了一张图片 [图片][1] 基本上我希望我的左栏能够适应其内容的宽度并水平保持在同一水平面上。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T23:26:09.617

我是无表格 CSS 设计的大力倡导者，但如果您需要的是表格，请使用表格。

这是一些我认为我已经让你开始的代码。

我想将中间列设置为屏幕的 %，但它不会滚动。它扩展到内表的大小。

我希望您需要在 3 列中的每一列中添加内部表格以显示您的内容。

```
<html>
<head>
<style>
table {
    width: 100%;
}
.left {
    background: red;
    width: 100px;
}
.right {
    background: blue;
    width: 100px;
}
.middle {
    background: green;
    width: 800px;
    display: block;
    overflow: scroll;
}
.inner {
    width: 2000px;
    height: 100px;
    background: black;
    display: block;
}
</style>
<body>
<table>
<tr><th class="left">Left</th><th class="middle">Middle Central block<table class="inner">Inner table</table></th><th class="right">Right</th></tr>
</table>
</body>
</html> 
```

# asp.net - 如何在新窗口中显示数据网格（使用 callprint）但使用 CSS 格式？

> ID：750797
> 
> 赞同：0
> 
> 时间：2009-04-15T08:35:45.687
> 
> 标签：asp.net, javascript, datagrid

Datagrid 使用 javascript 函数 callprint 在新窗口中显示，但会丢失所有 css 格式。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T08:45:05.087

任何一个

*   不要调用数据网格在新窗口中显示。

或者

*   创建一个包含数据网格并包含 CSS 的页面，并使用 javascript 打开此窗口。

# delphi - Delphi 版本的完整定义列表

> ID：750801
> 
> 赞同：29
> 
> 时间：2009-04-15T08:37:27.693
> 
> 标签：delphi, version-detection

有谁知道我可以找到所有 Delphi 版本的完整版本列表的好地方，直到 Delphi 2009？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-15T08:58:57.017

一个非常非常好的 Delphi 版本包含文件[`jedi.inc`](http://wiki.delphi-jedi.org/wiki/JEDI_Help:Jedi.inc)来自 JEDI 代码库 ( **JCL** )。

它始终是最新的，并具有类似`DELPHI2009`or的指令，...并且它包括许多类似or`DELPHI14_UP`的“功能指令” 。`SUPPORTS_INT64``SUPPORTS_UNICODE_STRING`

这是[存储库的链接](https://github.com/project-jedi/jedi/blob/master/jedi.inc)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-03-08T12:56:57.450

这是我发现的一份清单，希望能保持最新：

[http://docwiki.embarcadero.com/RADStudio/en/Compiler_Versions](http://docwiki.embarcadero.com/RADStudio/en/Compiler_Versions)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-15T08:48:32.923

您可以使用[`GX_CondDefine.inc`](http://gexperts.svn.sourceforge.net/viewvc/gexperts/trunk/Source/Framework/GX_CondDefine.inc?view=markup)来自伟大的[gexperts](http://www.gexperts.org/)插件：

```
{$IFDEF CONDITIONALEXPRESSIONS}
  {$IFDEF BCB}
    {$DEFINE GX_BCB}
  {$ELSE}
    {$DEFINE GX_Delphi}
  {$ENDIF}

  {$IF CompilerVersion >= 14}
    {$DEFINE GX_VER140_up} // Delphi 6
    {$IFDEF LINUX}
      {$DEFINE GX_KYLIX}
      {$IF RTLVersion = 14.2}
        {$DEFINE GX_KYLIX2} // Kylix 2
      {$IFEND}
      {$IF RTLVersion = 14.5}
        {$DEFINE GX_KYLIX3} // Kylix 3
      {$IFEND}
    {$ENDIF}
    {$IF CompilerVersion >= 15}
      {$DEFINE GX_VER150_up}  // Delphi 7
      {$IF CompilerVersion >= 16}
        {$DEFINE GX_VER160_up}  // Delphi 8
        {$IF CompilerVersion >= 17}
          {$DEFINE GX_VER170_up}  // Delphi 9/2005
          {$IF CompilerVersion >= 18}
            {$DEFINE GX_VER180_up}  // BDS 2006
            {$IFDEF VER185}
              {$DEFINE GX_VER185_up}  // Delphi 2007
            {$ENDIF}
            {$IF CompilerVersion >= 19}
              {$DEFINE GX_VER190_up}  // Delphi .NET 2007
              {$IF CompilerVersion >= 20}
                {$DEFINE GX_VER200_up}  // RAD Studio 2009
              {$IFEND}
            {$IFEND}
          {$IFEND}
        {$IFEND}
      {$IFEND}
    {$IFEND}
  {$IFEND}
{$ELSE not CONDITIONALEXPRESSIONS}
  Sorry, but this version of GExperts does not support the IDE
  you are using. Please visit the GExperts web site at
  http://www.gexperts.org/ to obtain more information about
  support for your IDE.
{$ENDIF} 
```

# sql-server - Adobe PDF x64 ifilter

> ID：750807
> 
> 赞同：0
> 
> 时间：2009-04-15T08:39:51.760
> 
> 标签：sql-server, full-text-search, adobe, ifilter

在 x64 windows server 2003 上使用 64 位版本的 adobepdf ifilter for sql server 2005 x64 时出现奇怪的错误框。

确切的消息框内容：

**MessageBoxHeader：** MsFTEFD.exe - 无法找到组件

**MessageboxContent：** 此应用程序无法启动，因为找不到 adobepdfl.dll。重新安装应用程序可能会解决问题。

有谁知道在这里做什么？重新安装 ifilter 并没有解决问题（包括正确注册过滤器以使用 SQL 服务器所需的步骤），谷歌没有弹出任何解决方案。检查应用程序和系统日志没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T08:43:23.403

这与编程无关。但是，我会调查您是否正在运行 64 位 SQL 服务器，以及过滤器插件是 64 位还是 32 位。

# delphi - Delphi 和/或 FreePascal 代码最常见的文档块

> ID：750810
> 
> 赞同：8
> 
> 时间：2009-04-15T08:41:57.793
> 
> 标签：delphi, comments, freepascal, code-documentation, docblocks

我对 PHP dockblocks 非常熟悉，因为过去 15 年多来我一直在从事这项工作。

```
/**
  * Description
  *
  * @tag bla bla
  * @tag more bla bla
  */ 
```

我想了解的是是否有像 Delphi 和/或 FreePascal 这样的标准。

根据我对大量代码的分析，我从未见过任何代码，但我可能大错特错。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T09:49:34.557

# Delphi 文档工具

在 Delphi 2005 中使用 XMLDoc 工具获取 API 文档和 HelpInsight    [http://edn.embarcadero.com/article/32770](http://edn.embarcadero.com/article/32770)

Delphi 2006 中的 XML 文档   [http://tondrej.blogspot.com/2006/03/xml-documentation-in-delphi-2006.html](http://tondrej.blogspot.com/2006/03/xml-documentation-in-delphi-2006.html)

DelphiCodeToDoc    [http://dephicodetodoc.sourceforge.net/](http://dephicodetodoc.sourceforge.net/)

Doc-O-Matic    [http://www.doc-o-matic.com/examplesourcecode.html](http://www.doc-o-matic.com/examplesourcecode.html)

PasDoc    [http://pasdoc.sipsolutions.net/](http://pasdoc.sipsolutions.net/)

帕斯卡浏览器   [http://www.peganza.com/](http://www.peganza.com/)

Doxygen    [http://www.doxygen.nl/](http://www.doxygen.nl/)

Pas2Dox    [http://sourceforge.net/projects/pas2dox/](http://sourceforge.net/projects/pas2dox/)

JADD - 只是另一个 DelphiDoc    [http://delphidoc.sourceforge.net/](http://delphidoc.sourceforge.net/)

## Stackoverflow 讨论

是否有支持当前 Delphi 语法的 Delphi 代码文档？   [https://stackoverflow.com/questions/673248/is-there-a-delphi-code-documentor-that-supports-current-delphi-syntax](https://stackoverflow.com/questions/673248/is-there-a-delphi-code-documentor-that-supports-current-delphi-syntax)

delphi 的代码文档类似于 javadoc 或 c# xml doc    [delphi 的代码文档类似于 javadoc 或 c# xml doc](https://stackoverflow.com/questions/236047/code-documentation-for-delphi-similar-to-javadoc-or-c-xml-doc)

记录德尔福   [https://stackoverflow.com/questions/33336/documenting-delphi](https://stackoverflow.com/questions/33336/documenting-delphi)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T08:53:18.607

最新的 Delphis 支持解析 XML 文档。他们还在提示中使用此信息（例如，如果您将鼠标光标移动到方法名称上）。

我正在将此模板用于方法文档：

```
///<summary></summary>
///<param name=''></param>
///<returns></returns>
///<exception cref=""></exception>
///<since>2009-04-15</since> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T08:49:45.527

[看起来 doxygen 有一个工具](http://www.doxygen.nl/helpers.html)，可以结合使用来[记录 Pascal 和 Delphi 代码](http://sourceforge.net/projects/pas2dox/)。也许这会对你有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T09:18:43.053

在我目前正在进行的一个项目中，我们正在使用[DelphiCodeToDoc](http://dephicodetodoc.sourceforge.net/)，它工作得相当好。它的语法如下所示：

```
type
  {* This is an example class }
  TMyClass = class
  private
  protected
  public
    {* Does some twiddling with AParam, and returns the result as String
       @param AParam Input value
       @return AParam incremented by 2, as String
       @throws Exception 'Boo' if it's full moon }
    function MyFunction(AParam: Integer): String;
  end; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T17:14:27.343

我更喜欢源代码之外的文档（它总是变得混乱），并使用 FPC 附带的优秀 fpdoc。（FPC 自己的文档都写在里面）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T14:18:30.370

有几个标准，通常取决于所使用的文档工具。我们使用 PasDoc，因此我们主要遵循基于 JavaDoc的格式[http://pasdoc.sipsolutions.net/ 。](http://pasdoc.sipsolutions.net/)

或者，正如 gabr 指出的那样，还有 XMLDoc，还有很多其他工具，大多数具有相似的语法，但有细微的差别。

# jquery - 有什么办法可以提高 jQuery 中 SimpleModal 对话框的显示速度？

> ID：750823
> 
> 赞同：0
> 
> 时间：2009-04-15T08:46:51.150
> 
> 标签：jquery, simplemodal

我正在使用`SimpleModal`jQuery 中的插件。

当我使用动作事件时，模态对话框出现缓慢。

有什么办法可以提高模态对话框的速度，让它看起来更快？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T09:05:40.963

尝试模式主页上描述的 onOpen 回调：

```
data.modal({onOpen: function (dialog) {
  dialog.overlay.fadeIn('slow', function () {
    dialog.container.slideDown('slow', function () {
      dialog.data.fadeIn('slow');
    });
  });
}}); 
```

如果这改变了某些东西，请尝试对 fadeIn 函数使用不同的值，而不是使用缓慢的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-30T17:52:03.453

我让用户抱怨速度。对于模态来说，即使是快速淡入也可能有点慢（取决于谁在使用它）。我发现似乎有帮助的一件事就是用低数字调用 show 函数......

```
$(content).modal({onOpen: function (dialog) {
    dialog.overlay.show(10, function () {
        dialog.container.show(10, function () {
            dialog.data.show(10);
        });
    });
}); 
```

# apache-flex - Speex 或 nellymoser

> ID：750824
> 
> 赞同：4
> 
> 时间：2009-04-15T08:46:51.557
> 
> 标签：apache-flex, flash, audio, flash-media-server, codec

我正在开发一个语音应用程序，我有 2 个选项 speex 和 nellymoser 。为什么我应该在 flex 应用程序中使用 speex 而不是 nellymoser。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T08:51:24.243

这应该很清楚，flex 的两种编解码器的比较：http:
[//askmeflash.com/article/2/speex-vs-nellymoser](http://askmeflash.com/article/2/speex-vs-nellymoser)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-09T22:31:45.797

Speex 是开源的，针对语音进行了优化，并且似乎具有较低的带宽要求。然而，在 Flash/AIR 中，Speex 始终为 16 kHz，这与 Skype 般的声音清脆度不同。因此，我们目前正在考虑切换到“旧”的 Nellymoser，我们可以选择 22 甚至 44 kHz。

# security - Any known resources for Secured Socket Programming with Jetty?

> ID：750831
> 
> 赞同：0
> 
> 时间：2009-04-15T08:49:05.077
> 
> 标签：security, sockets, ssl, jetty

Do you guys know fine tutorials, sample codes for SSL socket programming with Jetty? I am going to implement some secured applications with Jetty.. :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T08:56:08.287

Have a look at the Jetty Ssl Socket Connector instead of the often use Socket Connector. [http://docs.codehaus.org/display/JETTY/Ssl+Connector+Guide](http://docs.codehaus.org/display/JETTY/Ssl+Connector+Guide) [http://docs.codehaus.org/display/JETTY/Embedding+Jetty?focusedCommentId=9241003#comment-9241003](http://docs.codehaus.org/display/JETTY/Embedding+Jetty?focusedCommentId=9241003#comment-9241003)

Its not that difficult. Just add the sslSocketConnector to your server (after configuring it) and after this your application should respond to https requests.

```
server.addConnector(sslConnector); 
```

# visual-studio - 使用 Saxon .NET XSLT 处理器不适用于 Visual Studio 中的智能感知

> ID：750841
> 
> 赞同：4
> 
> 时间：2009-04-15T08:53:36.033
> 
> 标签：visual-studio, xslt, saxon

我正在使用用于 .NET 的开源[Saxon XSLT 处理器](http://saxon.sourceforge.net/)来执行一些 2.0 转换。

我像引用任何其他 dll 一样引用 saxon9api.dll，并且可以针对它编译代码。但是，Visual Studio 没有显示任何智能感知功能，使 IDE 与记事本一样有用。

saxon9api.dll 使用[IKVM Java for .NET](http://www.ikvm.net/)平台，我想知道这是否是导致 VS 问题的原因。Reflector 可以毫无问题地检查 DLL，但我怀疑 VS 出于某种原因不高兴。

有任何想法吗？

**编辑：**

令人惊讶的是，没有人遇到过这种行为，因为 Microsoft[建议](http://blogs.msdn.com/xmlteam/archive/2007/01/29/xslt-2-0.aspx) *（链接现已失效）*在框架中缺少内置功能的情况下使用 Saxon。

我想我会将问题改写为关于在 IKVM 下运行的程序集没有显示智能感知，尽管我需要找到另一个基于 IKVM 的项目来证明首先是这种情况......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-06T13:52:47.823

要在 Visual Studio 中进行编译、运行和智能感知，您需要执行以下操作：

*   参考`saxon9api.dll`，就像你已经做过的那样
*   参考`IKVM.OpenJDK.Core.dll`
*   参考`IKVM.Runtime.dll`（不确定是否需要，但我总是包含它）

如果您*还*引用[`vjslib`](http://www.microsoft.com/en-us/download/details.aspx?id=4712)，则可能会遇到问题，因为它使用许多相同的命名空间和类名，从而导致歧义，从而导致 Visual Studio 的智能感知出现问题。也许存在其他显示相同命名空间冲突的库。在这种情况下，首先在一个新的项目上尝试这个，并一个一个地添加引用，首先从 Saxon 的依赖项开始。

执行此操作后，至少在[Visual Studio 2010](https://msdn.microsoft.com/en-us/library/dd831853%28v=vs.100%29.aspx)、[2012](https://msdn.microsoft.com/en-us/library/vstudio/dd831853%28v=vs.110%29.aspx)和[2013](https://www.visualstudio.com/en-us/news/vs2013-community-vs.aspx)中，您会发现上下文相关的帮助正在工作（图像是带有[R#](https://www.jetbrains.com/resharper/)的 VS 2012 ）：

[![IntelliSense 在 Visual Studio 中与 Saxon EE 一起工作](https://i.stack.imgur.com/nOGMQ.png)](https://i.stack.imgur.com/nOGMQ.png)

* * *

*注意：由于这篇文章很旧，它可能当时只适用于 Visual Studio 2008，我没有测试过，因为我不再使用它了。*

# asp.net - HttpContext.Current.Request.ApplicationPath 在开发服务器上解析为“/”

> ID：750842
> 
> 赞同：2
> 
> 时间：2009-04-15T08:53:39.433
> 
> 标签：asp.net, visual-studio

为了获得一些图像的路径服务器端，我使用 HttpContext.Current.Request.ApplicationPath 来建立正确的路径。

它适用于生产环境，但在VS2008提供的开发/调试服务器上被解析为“/”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T08:57:18.253

您可以使用

`HttpContext.Curent.Server.MapPath("/*****");`<- 这会给你正确的路径..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T08:57:25.430

只需使用`HttpServerUtility.MapPath("~/images")`. “~”表示应用程序根。

# php - 我可以使用什么软件在 PHP 中自动生成类图？

> ID：750849
> 
> 赞同：0
> 
> 时间：2009-04-15T08:57:25.977
> 
> 标签：php

我有一些源代码，我想在 PHP 中自动生成类图。我可以使用什么软件来做到这一点？

**复制**

*   [PHP UML 生成器](https://stackoverflow.com/questions/393603/php-uml-generator)
*   [用于 php 的 UML 工具](https://stackoverflow.com/questions/704957/uml-tool-for-php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T11:37:17.153

Doxygen 也可以做类图（如果我想的是“类图”:)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T08:59:25.393

[雨伞](http://uml.sourceforge.net/)可以做到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T08:59:39.840

看看[Instant Reverse](http://resource.visual-paradigm.com/tips_and_tricks/code_engineering/reverse_engineering_php_source_by_instant_reverse.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-18T05:52:23.353

此答案适用于访问 stackoverflow 以查找其查询答案的人。

[http://pear.php.net/package/PHP_UML/](http://pear.php.net/package/PHP_UML/)

我还没有彻底评估过 PHP UML 包，但它应该可以满足中小型项目的需要。

# .net - 带有接口和实现类的 XML 文档注释

> ID：750856
> 
> 赞同：7
> 
> 时间：2009-04-15T08:59:25.380
> 
> 标签：.net, documentation, chm, xml-documentation

我正在使用[XML Documentation Comments](http://msdn.microsoft.com/en-us/library/b2s063f7.aspx)记录一个程序集，将使用[Sandcastle](http://www.microsoft.com/downloads/details.aspx?familyid=E82EA71D-DA89-42EE-A715-696E3A4873B2&displaylang=en)从该程序集创建一个[chm](http://en.wikipedia.org/wiki/Microsoft_Compiled_HTML_Help)文件。

我的程序集包含各种接口，每个接口都由一个类实现（在我的场景中，这些是 WCF 服务）。

我已经在接口中添加了文档，有什么方法可以自动记录实现类的相关方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-03T18:39:07.930

*我有一个更好的答案：**FiXml**。*

使用 GhostDoc \ AtomineerUtils 克隆评论当然是可行的方法，但它有很大的缺点，例如：

*   当原始注释被更改时（在开发过程中经常发生），它的克隆不会。
*   你正在产生大量的重复。如果您使用任何源代码分析工具（例如 Team City 中的 Duplicate Finder），它将主要找到您的评论。

*如前所述，[Sandcastle](http://blogs.msdn.com/sandcastle/)`<inheritdoc>`中有标签*，但与 FiXml 相比，它几乎没有缺点：

*   Sandcastle 生成已编译的 HTML 帮助文件 - 它不会修改`.xml`包含提取的 XML 注释的文件。但这些文件被许多工具使用，包括 .NET Reflector 和 Visual Studio .NET 中的类浏览器\IntelliSense。因此，如果您只使用 Sandcastle，您将看不到继承的文档。
*   Sandcastle 的实现没有那么强大。例如，不是 `<see ... copy="true" />`。

有关详细信息，请参阅[Sandcastle 的`<inheritdoc>`描述](http://www.ewoodruff.us/shfbdocs/html/79897974-ffc9-4b84-91a5-e50c66a0221d.htm)。

FiXml 的简短描述：它是由 C#\Visual Basic .Net 生成的 XML 文档的后处理器。它是作为 MSBuild 任务实现的，因此很容易将其集成到任何项目中。它解决了一些与用这些语言编写 XML 文档相关的烦人案例：

*   **不支持从基类或接口继承文档。**即任何被覆盖的成员的文档都应该从头开始编写，尽管通常至少继承它的一部分是非常可取的。
*   **不支持插入常用的文档模板**，例如“这种类型是单例的 - 使用它的`<see cref="Instance" />`属性来获取它的唯一实例。”，甚至“初始化一个新的`<CurrentType>`类实例”。</li>

为了解决上述问题，提供了以下附加 XML 标记：

*   `<inheritdoc />, <inherited />`标签
*   `<see cref="..." copy="..." />``<see/>`标签中的属性。

这是[它的网页](http://wiki.dataobjects.net/index.php?title=FiXml)和[下载页面](http://www.x-tensive.com/Downloads/?Path=Freeware%5CXtensive.MSBuildTasks)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T09:12:52.197

当您使用它的键盘快捷键时，诸如[GhostDoc之类的工具可以生成有关实现类的文档。](http://www.roland-weigelt.de/ghostdoc/)这不是完全自动的，但可以帮助防止过多的复制粘贴。

也许它可以用脚本自动化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T09:42:08.350

Sandcastle 中似乎不支持这种自动文档化。[Sandcastle 帮助文件生成器](http://www.codeplex.com/SHFB)虽然实现了自定义的inheritdoc 标记。

从 SHFB 网站：

> 包含对 <inheritdoc /> 标记的支持，它允许您从基本类型/成员继承文档。这是通过独立工具实现的，因此其他第三方工具和构建脚本也可以使用它。此工具提供的功能超出了 Sandcastle 提供的构建组件中的功能。

**第二次更新：**根据[这个工作项](http://sandcastle.codeplex.com/WorkItem/View.aspx?WorkItemId=1595)，Sandcastle “支持”inheritdoc 是通过 SHFB 工具。我想底线是，SHFB 解决了你的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T22:00:39.403

AtomineerUtils 将为您自动生成注释，它会从重载和覆盖的基类中提取现有文档，从而为您在需要的地方复制信息省去大量麻烦。

[http://www.atomineer.com/AtomineerUtils.html](http://www.atomineer.com/AtomineerUtils.html)

# django - 如果没有明确的 SQL JOIN，我将如何做到这一点？

> ID：750859
> 
> 赞同：0
> 
> 时间：2009-04-15T08:59:41.603
> 
> 标签：django

我有一个名为 Question 的模型和另一个名为 Answer 的模型。

```
class Question(models.Model):
    text = models.CharField(max_length=140)

class Answer(models.Model): 
    user = models.ForeignKey(User)
    question = models.ForeignKey(Question)
    uncertain = models.BooleanField()
    text = models.CharField(max_length=30) 
```

现在我想要一个 QuerySet `questions`，它相当于`Question.objects.all()`但*包括当前登录的用户的 answers*。我几乎完全确定这可以通过显式`JOIN`SQL 来完成，但我确信使用 Django 的 ORM 有更好的方法来做到这一点。

那我该怎么做呢？

编辑：澄清一下，我希望能够遍历 QuerySet，例如`for q in questions`然后能够查看用户是否通过`q.answered`可能是布尔值或`q.answer`可能是 Answer 对象本身的东西来回答它（或`None`）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T09:09:51.313

你在寻找这样的东西吗？

```
[ item.question for question in Answer.objects.filter(user=request.user) ] 
```

或者也许你想做一个

```
questions = Question.objects.all()
for question in questions:
    question.answer = question.answer_set.filter(user=request.user) 
```

我想我不明白这个问题以及你想去哪个方向......

编辑：好的，根据您的编辑，也许是后者......您可以查看它是空列表还是附加 .count() 并查看该值是否大于 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T10:29:32.353

我觉得你多虑了。基本上你想知道的（据我所知——如果我错了，请纠正我）是给定用户回答了哪些问题，哪些问题没有回答（补充）。所以：

```
user_answered_questions = set([answer.question for answer in user.answer_set.all()]) 
```

然后未回答的问题就是其他一切。所以：

```
user_unanswered_questions = set(Question.objects.all()) - answered_questions 
```

这样做而不是uzi的解决方案的重点是，您应该尽早使用您所知道的东西。如果您按用户过滤每个问题的 answer_set，您的初始查询将选择这些表中的每个答案和每个问题。通过从已知数据（即用户）开始，我们只选择与该用户相关的答案和问题。

编辑：

因此，如果您想将这两个集合组合成一个列表，有很多方法可以做到这一点，例如创建一个元组列表：

```
questions = [(q, q in user_answered_questions) for q in Question.objects.all()] 
```

然后你可以迭代问题，保留查询集的顺序：

```
for q in questions:
    print "it is %s that this user answered the \"%s\" question" % (q[1], q[0]) 
```

这并不漂亮，但你明白了——你已经确定了你想要确定的内容，只需将其扭曲为你碰巧需要的任何数据结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T11:24:57.260

出什么问题了

```
Question.objects.filter(answer__user=current_user).select_related() 
```

# tfs - 使用 TFS 的软件过程

> ID：750861
> 
> 赞同：0
> 
> 时间：2009-04-15T09:00:13.847
> 
> 标签：tfs

我正在尝试使用 MSF for CMMI 实现软件流程，以使用 TFS 管理我公司中的所有软件项目。您是否知道某家公司的参考示例，该公司使用 VSTS 和 3rd 方工具进行相同的需求管理练习，实施配置管理和变更管理，为自动构建和 CI 定义策略，自动部署，自定义项目门户网站和报告。是否有一些东西可以通过 TFS 显示完整的生命周期流程实施和实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T10:07:23.077

不是直接的答案，但您可能想收听[Radio TFS #18](http://www.radiotfs.com/2009/03/25/AdoptingTeamSystemWithStevenBorg.aspx)，它涵盖了不同流程模型及其采用的主题。

# php - 使用 php 和 jquery 进行排序

> ID：750863
> 
> 赞同：0
> 
> 时间：2009-04-15T09:03:03.123
> 
> 标签：php, jquery, sorting

当用户单击表格标题时，我正在尝试重新排序 HTML 表格。这是我能做的，但仍然不起作用。

在 HTML 中：

```
// onClick on table header 
var par='ASC';
sort(par); 
```

来自：ajax.js

```
function sort(orderByType)
{
  $.ajax({
    url: "sort.php",
    type: "get",
    data: "orderby="+orderByType,
    success: function(data){
      alert(data);
      $("t1").text(data);
    }
  });
} 
```

排序文件

```
$con = mysql_connect("localhost","root","root");
if (!$con) {
  die('Could not connect: ' . mysql_error());
}

$orderBy = $_GET['orderby'];

mysql_select_db("icrisis", $con);

$result = mysql_query("SELECT * FROM messages,user  
                                        where user_id = from_user
                                        ORDER BY user_name".$orderBy);

while($row = mysql_fetch_array($result))
{      
  echo "<tbody><tr><td>"."&#8226;"."</td><td>".
       $row["Time_Date"]."</td><td>".
       $row["player_name"]."</td><td></td><td></td><tr><td></td><td colspan='4'>".
       $row["msg_desc"]."</td></tr></tbody>";
}

mysql_close($con); 
```

它没有看到`$orderBy`. 然后我想将新订单添加到我的页面 - 怎么做？

发送到函数排序的变量是否可以是动态的，即点击时为 ASC 或 DESC？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T09:11:54.523

您应该尝试：[tablesorter](http://tablesorter.com/docs/)用于对表格进行排序。而且您甚至不需要将 php 与此解决方案一起使用 jquery。希望它有用。

要回复您对 Daan 的 anwser 的评论，您可以使用 ajax 更新 tablesorter，如此[处](http://tablesorter.com/docs/example-ajax.html)所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T09:20:16.453

我不确定这是否是你的问题的原因，但我相信你错过了一个空间。

您查询的最后一行现在是：

```
ORDER BY user_name".$orderBy); 
```

但应该是：

```
ORDER BY user_name ".$orderBy); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T12:17:32.703

正如大安所说，你错过了空间，这可能是原因，但我会补充：

您可能应该检查 mysql_query() 调用的结果，因为目前您不知道这是否失败，这可能是您的问题的原因。例如：

```
$result = mysql_query('SELECT ...');
if (!$result) {
    die(mysql_error());
}

while($row = mysql_fetch_array($result)) {
//etc. 
```

此外，您不应该真正基于来自浏览器的字符串构建 SQL 语句，因为这些字符串不可信，并且当前可能有人将恶意 SQL 添加到您正在执行的内容中。请参阅[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

您可以先验证字符串，这会更安全，而且很容易，因为您只有两个可能的值，例如

```
if (isset($_GET['orderby']) && $_GET['orderby'] == 'DESC') {
    $orderBy = 'DESC';
} else {
    $orderBy = 'ASC';
} 
```

# python - 如何使用 Python 中的 Perl 库？

> ID：750872
> 
> 赞同：6
> 
> 时间：2009-04-15T09:09:59.330
> 
> 标签：python, perl, api

我已经编写了一堆 Perl 库（实际上是 Perl 类），我想在我的 Python 应用程序中使用其中的一些。有没有一种自然的方法可以在不使用 SWIG 或为 Python 编写 Perl API 的情况下做到这一点。我要求类似的 PHP 的 Perl[接口](http://devzone.zend.com/node/view/id/1712)方式。如果 Python 中的 Perl 没有这样的工作。在 python 中使用 Perl 类的最简单方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T16:14:35.800

就个人而言，我会通过 XML/RPC 或其他类似机制将 Perl 库作为服务公开。这样你就可以从你的 Python 应用程序中以非常自然的方式调用它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T16:42:56.980

我还没有尝试过，但是[Inline::Python](http://search.cpan.org/dist/Inline-Python/Python.pod)允许您从 Perl 调用 Python。

您应该能够使用少量 perl 来加载您的 python 应用程序，然后使用`perl`I::P 附带的 python 包来访问您的 Perl 对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T10:07:05.730

**“在 python 中使用 Perl 类的最简单方法是什么？”**

最简单的。将 Perl 重写为 Python 并完成它。严重地。只需选择一种语言——这是最简单的。将 Perl 抛在后面并不是什么大损失。将类重写为 Python 可能会让您有机会以小的方式改进它们。

没那么容易。[使用 Python 的subprocess](http://docs.python.org/library/subprocess.html)模块运行 Perl 应用程序。在 Perl 应用程序中使用 Perl 类没有问题。您可以轻松创建管道，以便 Perl 从 Python 获取输入并将输出生成到 Python

```
someApp.py | something.pl | finalStep.py 
```

这样做的好处是将您的应用程序分成三个并发进程，占用大量处理器资源并在 1/3 的时间内运行（有时）。

其他一切都不容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T09:31:32.617

您刚刚错过了在[Parrot VM](http://www.parrot.org/)上与 Perl 一起`Python`运行的机会。2009 年**4 月 1**日，[PEP 401](http://www.python.org/dev/peps/pep-0401/)发布，*FLUFL 的官方法案之一*如下：

 ***> *   认识到 C 是一种 20 世纪的语言，几乎被 30 岁以下的程序员普遍拒绝，CPython 实现将随着 Python 2.6.2 和 3.0.2 的发布而终止。此后，**Python 的参考实现将针对 Parrot 虚拟机**。Python 的替代实现（例如 Jython、IronPython 和 PyPy）被官方禁止但被容忍。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T09:12:20.747

查看[PyPerl](http://wiki.python.org/moin/PyPerl)。

警告：PyPerl 目前未维护，因此如果您需要稳定性，请不要使用它。

# sql-server-2005 - 在 sql 中更改列数据类型

> ID：750877
> 
> 赞同：4
> 
> 时间：2009-04-15T09:10:59.843
> 
> 标签：sql-server-2005

我正在尝试将列数据类型从 text 重命名为 ntext 但出现错误

```
Msg 4927, Level 16, State 1, Line 1
Cannot alter column 'ColumnName' to be data type ntext. 
```

我使用的查询如下：-

```
alter table tablename alter column columnname ntext null 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T09:21:27.807

不允许转换。将新列添加为 ntext，然后将转换后的数据复制到新列，然后删除旧列。如果它是一个大表，可能会消耗大量磁盘空间！您应该使用 NVARCHAR(MAX) 而不是 NTEXT，这在未来将不再受支持。

[消息 4927](http://www.sql-server-performance.com/faq/cannot_alter_column_is_p1.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T09:20:36.123

我希望您需要将数据复制出来 - 即添加一个临时列，填充它；删除旧列；添加新列，将数据复制回来，删除临时列：

```
ALTER TABLE TableName ADD tmp text NULL
GO
UPDATE TableName SET tmp = ColumnName
GO
ALTER TABLE TableName DROP COLUMN ColumnName
GO
ALTER TABLE TableName ADD ColumnName ntext NULL
GO
UPDATE TableName SET ColumnName = tmp
GO
ALTER TABLE TableName DROP COLUMN tmp 
```

* * *

为了在数据库范围内应用，您可以从 info-schema 中编写脚本（注意您应该过滤掉任何系统表等）：

```
SELECT 'ALTER TABLE [' + TABLE_SCHEMA + '].[' + TABLE_NAME+ '] ADD [__tmp] text NULL
GO
UPDATE [' + TABLE_SCHEMA + '].[' + TABLE_NAME+ '] SET [__tmp] = [' + COLUMN_NAME + ']
GO
ALTER TABLE [' + TABLE_SCHEMA + '].[' + TABLE_NAME+ '] DROP COLUMN [' + COLUMN_NAME + ']
GO
ALTER TABLE [' + TABLE_SCHEMA + '].[' + TABLE_NAME+ '] ADD [' + COLUMN_NAME + '] ntext ' +
    CASE IS_NULLABLE WHEN 'YES' THEN 'NULL' ELSE 'NOT NULL' END + '
GO
UPDATE [' + TABLE_SCHEMA + '].[' + TABLE_NAME+ '] SET [' + COLUMN_NAME + '] = [__tmp]
GO
ALTER TABLE [' + TABLE_SCHEMA + '].[' + TABLE_NAME+ '] DROP COLUMN [__tmp]'
FROM INFORMATION_SCHEMA.COLUMNS WHERE DATA_TYPE = 'text' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:44:29.323

在 MySQL 中，查询是：

ALTER TABLE [tableName] CHANGE [oldColumnName] [newColumnName] [newColumnType];

# java - 对“abc-def”使用扫描仪的分隔符功能

> ID：750881
> 
> 赞同：0
> 
> 时间：2009-04-15T09:11:49.000
> 
> 标签：java, regex, java.util.scanner, text-formatting

我目前正在尝试过滤包含用“-”分隔的单词的文本文件。我想数单词。

```
scanner.useDelimiter(("[.,:;()?!\" \t\n\r]+")); 
```

简单地出现的问题是：包含“-”的单词将被分开并计为两个单词。所以只是用 \- 转义不是选择的解决方案。

如何更改分隔符表达式，以便保留“foo-bar”之类的词，但单独的“-”会被过滤掉并忽略？

谢谢 ;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T10:16:24.447

好的，我在这里猜你的问题：你的意思是你有一个带有一些“真实”散文的文本文件，即实际上有意义的句子，用标点符号等分隔，对吧？

例子：

> 就我们所知，这种情况得到了改善，因为我们最信任的盟友 Vorgons 继续举办他们的诗歌大满贯比赛。敌人几乎没有动机去干涉，即使他们的 Mute-O-Matic 设备也是如此。

因此，您需要作为分隔符的东西是任意数量的空格和/或标点符号（您已经用您展示的正则表达式覆盖），或者每边至少被一个空格包围的连字符。“或”的正则表达式字符是“|”。在许多正则表达式实现中，空白字符类（空格、制表符和换行符）都有一个快捷方式：“\s”。

```
"[.,:;()?!\"\s]+|\s+-\s+" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T10:10:14.867

这不是很简单。要尝试的一件事是 {current-delimeter-chars}{zero-or-more-hyphens}{zero-or-more-current-delimeter-chars-or-hyphen}。

忽略扫描仪返回的完全由连字符组成的单词可能更容易

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:14:51.157

如果可能，请尝试使用预定义的类...使正则表达式更易于阅读。有关选项，请参见 java.util.regex.Pattern。

也许这就是你正在寻找的：

```
string.split("\\s+(\\W*\\s)?" 
```

读取：匹配 1 个或多个空白字符，可选地后跟零个或多个非单词字符和一个空白字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T10:59:30.147

```
Scanner scanner = new Scanner("one   two2  -   (three) four-five - ,....|");
scanner.useDelimiter("(\\B+-\\B+|[.,:;()?!\" \t|])+");

while (scanner.hasNext()) {
    System.out.println(scanner.next("\\w+(-\\w+)*"));
} 
```

**注意**

next(String) 方法断言你只得到单词，因为原始的 useDelimiter() 方法错过了“|”

**注意**

您已使用正则表达式 "\r\n|\n" 作为行终止符。java.util.regex.Pattern 的 JavaDocs 显示了其他可能的行终止符，因此更完整的检查将使用表达式 "\r\n|[\r\n\u2028\u2029\u0085]"

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T16:11:53.700

这应该很简单：`[^\\w-]\\W*|-\\W+`

*   但当然，如果它是散文，并且您想排除*下划线*：
    `[^\\p{Alnum}-]\\P{Alnum}*|-\\P{Alnum}+`
*   或者如果您不期望数字：
    `[^\\p{Alpha}-]\\P{Alpha}*|-\\P{Alpha}+`

**编辑：**这些是更简单的形式。请记住完整的解决方案，它将处理行首和行尾的破折号将遵循此模式。`(?:^|[^\\w-])\\W*|-(?:\\W+|$)`

# c# - 使用dataadpter如何更新数据库中的数据

> ID：750884
> 
> 赞同：-1
> 
> 时间：2009-04-15T09:12:04.163
> 
> 标签：c#, vb.net

使用dataadpter如何更新数据库中的数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T09:17:49.907

```
myDataAdapter.Update(myDataSet); 
```

一个模糊的问题充其量值得一个模糊的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T09:15:56.867

我假设您在谈论 SqlDataAdapter。如果是这样，请查看

[这](http://www.dotnetjohn.com/articles.aspx?articleid=106)

# java - 如何在运行时更改注释/休眠验证规则？

> ID：750890
> 
> 赞同：5
> 
> 时间：2009-04-15T09:15:57.227
> 
> 标签：java, annotations, runtime, hibernate-validator

如果有一个包含某些字段的 Java 类，我想使用 Hibernate Validator 进行验证。现在我希望我的用户能够在运行时配置进行哪些验证。

例如：

```
public class MyPojo {
    ...

    @NotEmpty
    String void getMyField() {
        ... 
    }

    ...
} 
```

假设我想删除支票或用or`NotEmpty`替换它，我该怎么做？甚至可能吗？我想这归结为在运行时更改注释......`Email``CreditCardNumber`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T12:26:00.867

你不能正常做。

这是我通过 Hibernate Validator 获得更多动态验证所做的工作。

1.  扩展`ClassValidator`类。
2.  覆盖`getInvalidVaues(Object myObj)`方法。首先，调用`super.getInvalidValues(myObj)`，然后将钩子添加到您的自定义验证中。
3.  实例化您的自定义验证器并调用`getInvalidValues`验证。任何休眠注释验证都将在此时开始，您的自定义动态验证（注释不支持的任何内容）也将开始。

例子：

```
public class MyObjectValidator extends ClassValidator<MyObject>
{
    public MyObjectValidator()
    {
         super(MyObject.class);
    }

    public InvalidValue[] getInvalidValues(MyObject myObj)
    {
        List<InvalidValue> invalids = new ArrayList<InvalidValue>();
        invalids.addAll(Arrays.asList(super.getInvalidValues(myObj)));

        // add custom validations here
        invalids.addAll(validateDynamicStuff(myObj));

        InvalidValue[] results = new InvalidValue[invalids.size()];
        return invalids.toArray(results);
    }

    private List<InvalidValue> validateDynamicStuff(MyObject myObj)
    {
        // ... whatever validations you want ...
    }

} 
```

因此，您的自定义验证代码可以包含诸如“执行此验证，如果用户配置它，否则执行该验证”等逻辑。您可能能够也可能无法利用支持休眠验证的相同代码，但无论哪种方式，您正在做的更多涉及休眠验证器的“正常”用例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-15T16:40:47.793

实际上在休眠验证器 4.1 中是可能的。只需阅读有关[程序约束创建](https://docs.jboss.org/hibernate/validator/4.1/reference/en-US/html/programmaticapi.html)的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T09:37:26.893

我认为您无法删除或更改注释，它是类定义的一部分。您可以构建一个新类，这在运行时是可能的，但涉及一点。Hibernate 可能支持对验证的编程访问并允许您覆盖注释，我不太了解 API。Hibernate 自己构建了一些运行时类......如果您有兴趣，这可能是学习如何做的好地方。

# c# - 将 Xml 读入 DataSet

> ID：750891
> 
> 赞同：0
> 
> 时间：2009-04-15T09:15:58.007
> 
> 标签：c#, xml, dataset

这是我的 XML 文件：

```
<?xml version="1.0" standalone="no" ?> 
<!-- This file represents The Details of the user and the responces: --> 
<Survey>
  <Clientdetails>
    <ClientName xmlns="yash" /> 
    <ClientCompanyName xmlns="lnt" /> 
    <ClientTelNo. xmlns="546" /> 
    <ClientMobileNo xmlns="56" /> 
    <ClientEMail xmlns="56" /> 
  </Clientdetails>
  <ClientResponces>
    <Question1>
      <responce>1</responce> 
    </Question1>
    <Question2>
      <responce>2</responce> 
    </Question2>
    <Question3>
      <responce>3</responce> 
    </Question3>
    <Question4>
      <responce>3</responce> 
    </Question4>
    <Question5>
      <Question5.1>
        <responce>3</responce> 
      </Question5.1>
      <Question5.2>
        <responce>3</responce> 
      </Question5.2>
      <Question5.3>
        <responce>2</responce> 
      </Question5.3>
      <Question5.4>
        <responce>3</responce> 
      </Question5.4>
      <Question5.5>
        <responce>3</responce> 
      </Question5.5>
      <Question5.6>
        <responce>3</responce> 
      </Question5.6>
      <Question5.7>
        <responce>3</responce> 
      </Question5.7>
      <Question5.8>
        <responce>2</responce> 
      </Question5.8>
      <Question5.9>
        <responce>1</responce> 
      </Question5.9>
      <Question5.10>
        <responce>2</responce> 
      </Question5.10>
      <Question5.11>
        <responce>0</responce> 
      </Question5.11>
      <Question5.12>
        <responce>0</responce> 
      </Question5.12>
      <Question5.13>
        <responce>0</responce> 
      </Question5.13>
      <Question5.14>
        <responce>0</responce> 
      </Question5.14>
      <Question5.15>
        <responce>0</responce> 
      </Question5.15>
      <Question5.16>
        <responce>0</responce> 
      </Question5.16>
      <Question5.17>
        <responce>0</responce> 
      </Question5.17>
    </Question5>
  </ClientResponces>
</Survey> 
```

我想将这些数据读入 DataSet。我只想要客户给出的回答，对于第 5 个问题，我想要其 17 个子问题的平均值。

例如，DataSet 应该只包含这个：

```
1
2
3
3
4 
```

如何在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T09:25:59.667

那个 xml 很……可怕。我的第一个建议是通过 xslt 转换运行它，使其变得更正常，可以加载`Load`. 目前，它正在**可怕**地滥用命名空间。

或者，忘记，并用或类似的方式`DataSet`解析它。`XmlDocument`

这是一种使用方法`XmlDocument`（并且仅出于平均目的使用 LINQ，以节省几行代码）：

```
XmlDocument doc = new XmlDocument();
doc.LoadXml(xml);
foreach (XmlElement el in doc.SelectNodes("//responce")) {
    Console.WriteLine(el.ParentNode.Name + "=" + el.InnerText);
}
XmlNodeList fiveAnswers = doc.SelectNodes(
      "/Survey/ClientResponces/Question5/*/responce");
double avg = fiveAnswers.Cast<XmlElement>()
     .Average(el => int.Parse(el.InnerText));
Console.WriteLine(avg); 
```

*以普通*xml为例：

```
<question num="1">
  <response>1</response>
</question>
...
<question num="5">
  <response num="1">1</response>
  <response num="2">3</response>
  ...
</question> 
```

或类似的东西。不要使用元素名称来推断身份。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T09:24:04.337

尝试

```
 XmlDataDocument doc = new XmlDataDocument();
doc.LoadXml(<your string>);
DataSet ds = doc.DataSet; 
```

然后，您可以使用 LINQ 从文档中进行选择。

**更新**

```
 foreach (XmlNode node in doc.SelectNodes("\\Survey\ClientResponses"))
  {
     string text = node.InnerText;
  } 
```

（未经测试！您的嵌套案例会很棘手！）

# .net - Mono/.NET 编程的简要介绍是什么？

> ID：750892
> 
> 赞同：4
> 
> 时间：2009-04-15T09:16:12.373
> 
> 标签：.net, mono

Mono 的特性给我留下了深刻的印象，尤其是库的可移植性。我想我迟早会试一试，我需要一些指导来找到 Mono/.NET 编程的介绍。你能帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T09:28:42.797

大多数情况下，Mono 编程与经典的 .NET 编程没有任何不同。

您只能以体面的方式使用 C#，而不是其他 .NET 语言。尽管 Mono 声称支持 VB.NET，但它远不是一个合理的编译器或合理的 IL 支持。VB.NET 主要是实验性的。

如果您的主要操作系统是 Windows 开始下载 Mono VmWare 的最简单方法 - [http://www.go-mono.com/mono-downloads/download.html](http://www.go-mono.com/mono-downloads/download.html) - openSuse

环境已准备好启动 Mono 开发。

尝试[Mono 开始页面](http://mono-project.com/Start)以获取提示

别忘了你不能使用 COM。

在 Mono 中进行编码的最佳方法（在 VS.NET 之后 IDE 很糟糕），然后将其移植到 Windows。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T13:04:37.910

斯劳的伟大推荐。我发现[Mono Getting Started Guide](http://mono-project.com/Start)和[Wikipedia page](http://en.wikipedia.org/wiki/Mono_(software))对于理解它的历史、它的工作原理以及如何开始非常有帮助：

*   [Mono Project 网站](http://mono-project.com/)，尤其是入门指南
*   [维基百科上的 Mono（软件）](http://en.wikipedia.org/wiki/Mono_(software))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:48:59.857

我发现 Petzold 的免费电子书[.NET Book Zero](http://www.charlespetzold.com/dotnet/DotNetBookZero11.pdf)作为 .Net 编程的介绍很有用。

# nunit - 等待页面 Waitforcomplete() 或 system.threading.thread.sleep() 上的元素的更好方法是什么

> ID：750893
> 
> 赞同：1
> 
> 时间：2009-04-15T09:16:53.450
> 
> 标签：nunit, cruisecontrol.net, watin

我在 watiN 中使用 WaitforComplete() 但它似乎效果不佳。即使您等待更长的时间，它也会执行下一条语句。我正在使用 thread.sleep() 来停止我的应用程序，直到它获得所需的页面或元素。但问题是页面是如此动态，有时它需要更长的时间，如指定的那样。

任何更好的解决方案。任何会捕获页面的东西都会动态返回，并且不会去执行应用程序中的下一个语句。

**代码示例**

```
 'Show Details page
    Assert.AreEqual("Confirmation", _internetExplorer.Title)

    If (_internetExplorer.Button(Find.ById(New Regex("btnFinish"))).Exists) Then
        _internetExplorer.Button(Find.ById(New Regex("btnFinish"))).Click()
    Else
        Assert.Fail("Could not Find Finish Booking Button on Confirmation Page")
    End If

    System.Threading.Thread.Sleep(100000) 
```

'显示预订摘要页面 Assert.AreEqual("显示预订", _internetExplorer.Title)

我想要动态检测页面返回的东西。而不是给出一些恒定的值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T08:26:27.123

WaitForComplete 仅在某些操作后有回发时才能正常工作。否则，您必须找到其他东西等待。以下是关于如何等待指定标题的示例：

```
_internetExplorer.Element("title", "Confirmation").WaitUntilExists(); 
```

我总是更喜欢使用 WaitXXX 方法之一而不是 Thread.Sleep 因为 WaitXXX 方法只会等到满足约束。睡眠等待您指定的时间。如果它太长，时间是腰部。如果它太短，就会出现问题。

HTH，杰伦

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-06T00:43:00.607

一旦浏览器将它的 readystate 设置为 comllete 并且将 busy 状态设置为 false，WaitForComplete 方法就会继续运行。

我通常做的是尝试访问您需要的内容，然后执行 thread.sleep 半秒钟，然后再试一次。我还有一个全局超时，说 10 秒后退出。

```
 int timeout = 20;
    bool controlFound = false;
    for (int i = 0; i < timeout; i++)
    {
        if (_internetExplorer.Button(Find.ById(New Regex("btnFinish"))).Exists)
        {
            _internetExplorer.Button(Find.ById(New Regex("btnFinish"))).Click();
            controlFound = true;
            break;
        }
        else
        {
            System.Threading.Thread.Sleep(500);
        }   
    }

   if (!controlFound)
   {
        Assert.Fail("Control not found");
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T09:20:58.463

如果它正在执行下一条语句，它应该正在寻找相应的元素。我建议发布您正在尝试的代码示例。

# asp.net - 我如何摆脱 __o 未声明？

> ID：750902
> 
> 赞同：54
> 
> 时间：2009-04-15T09:19:15.410
> 
> 标签：asp.net

我的母版页中有一些代码设置了一个带有一些上下文敏感信息的超链接

```
<%If Not IsNothing(Profile.ClientID) Then%>
<span class="menu-nav"> 
<a  target="_blank" 
    href=
"http://b/x.aspx?ClientID=<%=Profile.ClientID.ToString()%>&Initials=<%=Session("Initials")%>"       
    >
    Send
    <br />
    SMS
    <br />
</a>

</span>
<%End If %>

<span class="menu-nav"> <!-- Name __o is not declared Error is flagged here--> 
```

现在问题似乎出在 href 部分。如果我删除动态代码，错误就会消失。谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-04-15T10:11:56.640

我在.net 论坛上找到了[答案。](http://blogs.msdn.com/b/mikhailarkhipov/archive/2006/04/20/580165.aspx)它很好地解释了 ASP.Net 为何如此行事：

> 我们终于获得了可靠的复制品并确定了根本问题。一个简单的复制看起来像这样：
> 
> ```
>  <% if (true) { %>
>   <%=1%>
>   <% } %>
>   <%=2%> 
> ```
> 
> 为了在设计时在 <%= %> 块中提供智能感知，ASP.NET 生成对临时 __o 变量和语言（VB 或 C#）的赋值，然后为变量提供智能感知。这是在页面编译器看到第一个 <%= ... %> 块时完成的。但是在这里，块在 if 里面，所以在 if 关闭之后，变量就超出了范围。我们最终会生成这样的东西：
> 
> ```
>  if (true) { 
>         object @__o;
>         @__o = 1;
>    }
>    @__o = 2; 
> ```
> 
> 解决方法是在页面的早期添加一个虚拟表达式。例如 <%="" %>。这不会渲染任何东西，它会确保 __o 在任何潜在的“if”（或其他范围）语句之前在 Render 方法中声明为顶级。

另一种解决方案是简单地使用

```
<% response.write(var) %> 
```

代替

```
<%= var %> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-15T09:24:39.157

是的，在 ASPX 页面上使用服务器端结构的页面中，我偶尔会遇到同样的错误。

加班，我找到了一个修复它（对不起，我无法再次找到我在哪里找到这个信息。）修复是将以下代码放在错误`<%...%>`块之上：

```
<%-- For other devs: Do not remove below line. --%>
<%="" %>
<%-- For other devs: Do not remove above line. --%> 
```

显然，将上面的代码放在哪里对 VS.NET 产生了很大的影响，因此可能需要尝试几次才能使其正确。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-20T13:28:37.780

这是一个奇怪的解决方案，但对我来说，我设法通过简单地关闭 Visual Studio 中有问题的打开文件来解决这个问题。

在它们打开的情况下，我不规律地遇到了 __o 问题。

我一关闭它们，__o 问题就消失了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-15T23:04:59.877

经过几个小时的谷歌搜索和分析我当前项目中的一堆 aspx 后，我似乎找到了对我有用的解决方案。强烈建议避免使用 html 样式的注释：

`<!-- ... -->`

在aspx页面内。而不是使用 aspx 样式的注释

`<%-- ... --%>`

此外，它帮助我获得了 vs intellisense 和代码突出显示再次起作用，主要的事情 - 这个案例已经从它开始 - vs 现在可以在嵌入的 vb/cs 代码片段中命中断点！并且没有任何该死的“这不是断点的有效位置”消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-23T10:14:58.703

当我清理解决方案，重新启动 IIS 并且它仍然神秘地播放时，我发现这有时可能是由于将 ASPX 源文件的内容从另一个系统粘贴到 Visual Studio 中，这“有助于”更新代码，可能会更改一些 ID并打破页面。

将其粘贴到另一个编辑器（记事本++？）然后保存它会阻止 Visual Studio“提供帮助”并且页面再次工作。

# c++ - 在 Vista 上调用 RPC 调用时“不支持操作”

> ID：750903
> 
> 赞同：3
> 
> 时间：2009-04-15T09:20:12.567
> 
> 标签：c++, windows, windows-vista, rpc

我的应用程序使用 Microsoft RPC 进行进程间通信。当两个进程在同一台机器上运行并且一个进程尝试调用声明为（IDL 表示法）的方法时：

```
error_status_t rpcMethod( [in] pipe byte parameter ); 
```

此调用因 RPC_S_CANNOT_SUPPORT（“不支持请求的操作”）而失败，并且永远不会到达服务器端，并且永远不会调用所提供管道的 push()/pull() 原语。这仅在使用*ncalrpc*协议时才会在 Vista 上重现，否则不会。

我还在事件查看器日志中发现了以下内容：

*应用程序（“此处的我的程序 exe 文件名”\service）（PID：344）正在使用此版本的 Windows 中不存在的 Windows 功能。如需获取应用程序的更新版本，请联系应用程序供应商。需要传达给应用程序供应商的技术信息是：“已在具有唯一标识符（此处为实际 UUID）的协议序列 ncalrpc 接口上调用了使用同步管道的 RPC 方法。此协议序列上同步管道的使用和支持此版本的 Windows 已弃用。有关弃用过程的信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=36415](http://go.microsoft.com/fwlink/?LinkId=36415)。用户操作联系应用程序供应商以获取应用程序的更新版本*

消息文本中的链接重定向到可能不相关的页面。

除了更改协议序列或不使用管道之外，是否有解决此问题的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T15:05:48.510

您很可能使用了 Vista 中不支持的方法。

RPC_NOTIFICATIONS 枚举值，指定服务器从 RPC 请求的通知类型。

**Windows Vista：**目前仅支持 RpcNotificationClientDisconnect 和 RpcNotificationCallCancel。如果为此参数指定了任何其他值，则返回 RPC_S_CANNOT_SUPPORT 错误代码。

[见 MSDN](http://msdn.microsoft.com/en-us/library/aa378442(VS.85).aspx)

# python - 自动 __repr__ 方法

> ID：750908
> 
> 赞同：26
> 
> 时间：2009-04-15T09:21:58.147
> 
> 标签：python

我想有任何类的简单表示，比如`{ property = value }`，有 auto`__repr__`吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2016-07-23T10:43:09.777

最简单的方法：

```
def __repr__(self):
    return str(self.__dict__) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-15T09:36:03.450

是的，您可以创建一个“AutoRepr”类并让所有其他类扩展它：

```
>>> class AutoRepr(object):
...     def __repr__(self):
...         items = ("%s = %r" % (k, v) for k, v in self.__dict__.items())
...         return "<%s: {%s}>" % (self.__class__.__name__, ', '.join(items))
... 
>>> class AnyOtherClass(AutoRepr):
...     def __init__(self):
...         self.foo = 'foo'
...         self.bar = 'bar'
...
>>> repr(AnyOtherClass())
"<AnyOtherClass: {foo = 'foo', bar = 'bar'}>" 
```

请注意，上面的代码不会很好地作用于（直接或间接）引用自身的数据结构。作为替代方案，您可以定义一个适用于任何类型的函数：

```
>>> def autoRepr(obj):
...     try:
...         items = ("%s = %r" % (k, v) for k, v in obj.__dict__.items())
...         return "<%s: {%s}." % (obj.__class__.__name__, ', '.join(items))
...     except AttributeError:
...         return repr(obj)
... 
>>> class AnyOtherClass(object):
...     def __init__(self):
...         self.foo = 'foo'
...         self.bar = 'bar'
...
>>> autoRepr(AnyOtherClass())
"<AnyOtherClass: {foo = 'foo', bar = 'bar'}>"
>>> autoRepr(7)
'7'
>>> autoRepr(None)
'None' 
```

请注意，由于前面提到的原因，上述函数不是故意递归定义的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-01-06T12:47:38.243

好吧，我玩了一点其他答案，得到了一个非常漂亮的解决方案：

```
class data:
    @staticmethod
    def repr(obj):
        items = []
        for prop, value in obj.__dict__.items():
            try:
                item = "%s = %r" % (prop, value)
                assert len(item) < 20
            except:
                item = "%s: <%s>" % (prop, value.__class__.__name__)
            items.append(item)

        return "%s(%s)" % (obj.__class__.__name__, ', '.join(items))

    def __init__(self, cls):
        cls.__repr__ = data.repr
        self.cls = cls

    def __call__(self, *args, **kwargs):
        return self.cls(*args, **kwargs) 
```

您将其用作装饰器：

```
@data
class PythonBean:
    def __init__(self):
        self.int = 1
        self.list = [5, 6, 7]
        self.str = "hello"
        self.obj = SomeOtherClass() 
```

并`__repr__`开箱即用：

```
PythonBean(int = 1, obj: <SomeOtherClass>, list = [5, 6, 7], str = 'hello') 
```

这适用于任何递归类，包括树结构。如果您尝试在 class 中放置自引用`self.ref = self`，该函数将尝试（成功）解决它大约一秒钟。

当然，请记住你的老板——我的老板不喜欢这样的语法糖））

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-15T09:26:01.867

你的意思是

```
__dict__ 
```

?

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-02-06T03:14:13.190

```
class MyClass:
    def __init__(self, foo: str, bar: int):
        self.foo = foo
        self.bar = bar
        self._baz: bool = True

    def __repr__(self):
        f"{self.__class__.__name__}({', '.join([f'{k}={v!r}' for k, v in self.__dict__.items() if not k.startswith('_')])})"

mc = MyClass('a', 99)

print(mc)
# MyClass(foo='a', bar=99)
# ^^^ Note that _baz=True was hidden here 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-11-10T20:36:16.960

我使用这个辅助函数为我的类生成**repr**。在 unittest 函数中运行很容易，即。

```
def test_makeRepr(self):
    makeRepr(Foo, Foo(), "anOptional space delimitedString ToProvideCustom Fields") 
```

这应该会向控制台输出一些潜在的**代表**，然后您可以将其复制/粘贴到您的班级中。

```
def makeRepr(classObj, instance = None, customFields = None):
    """Code writing helper function that will generate a __repr__ function that can be copy/pasted into a class definition.

    Args:
        classObj (class):
        instance (class):
        customFields (string):

    Returns:
        None:

    Always call the __repr__ function afterwards to ensure expected output.
    ie. print(foo)

    def __repr__(self):
        msg = "<Foo(var1 = {}, var2 = {})>"
        attributes = [self.var1, self.var2]
        return msg.format(*attributes)
    """ 
    if isinstance(instance, classObj):
        className = instance.__class__.__name__
    else:
        className=classObj.__name__

    print('Generating a __repr__ function for: ', className,"\n")
    print("\tClass Type: "+classObj.__name__, "has the following fields:")
    print("\t"+" ".join(classObj.__dict__.keys()),"\n")
    if instance:
        print("\tInstance of: "+instance.__class__.__name__, "has the following fields:")
        print("\t"+" ".join(instance.__dict__.keys()),"\n")
    else:
        print('\tInstance of: Instance not provided.\n')

    if customFields:
        print("\t"+"These fields were provided to makeRepr:")
        print("\t"+customFields,"\n")
    else:
        print("\t"+"These fields were provided to makeRepr: None\n")
    print("Edit the list of fields, and rerun makeRepr with the new list if necessary.\n\n")

    print("repr with class type:\n")
    classResult = buildRepr( classObj.__name__, " ".join(classObj.__dict__.keys()))
    print(classResult,"\n\n")

    if isinstance(instance, classObj):
        instanceResult = buildRepr( instance.__class__.__name__, " ".join(instance.__dict__.keys()))
    else:
        instanceResult = "\t-----Instance not provided."
    print("repr with instance of class:\n")
    print(instanceResult,"\n\n") 

    if customFields:
        customResult = buildRepr( classObj.__name__, customFields)
    else:
        customResult = '\t-----Custom fields not provided'
    print("repr with custom fields and class name:\n")
    print(customResult,"\n\n")    

    print('Current __repr__')
    print("Class Object: ",classObj)
    if instance:
        print("Instance: ",instance.__repr__())
    else:
        print("Instance: ", "None")

def buildRepr(typeName,fields):
    funcDefLine = "def __repr__(self):"
    msgLineBase  = '    msg = "<{typename}({attribute})>"'
    attributeListLineBase = '    attributes = [{attributeList}]'
    returnLine = '    return msg.format(*attributes)'
    x = ['self.' + x for x in fields.split()]
    xResult = ", ".join(x)
    y = [x + ' = {}' for x in fields.split()]
    yResult = ', '.join(y)
    msgLine = msgLineBase.format(typename = typeName, attribute = yResult)
    attributeListLine = attributeListLineBase.format(attributeList = xResult) 
    result = "{declaration}\n{message}\n{attributes}\n{returnLine}".format(declaration = funcDefLine,
                                                                       message = msgLine,
                                                                       attributes = attributeListLine,
                                                                       returnLine =returnLine )
    return result 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-12T10:03:17.673

您可以将 voddan 的答案压缩为：

```
class data:
    def __init__(self, cls):
        cls.__repr__ = lambda obj : f"{obj.__class__.__name__}({', '.join([f'{prop}={value}' for prop, value in obj.__dict__.items()])})"
        self.cls = cls

    def __call__(self, *args, **kwargs):
        return self.cls(*args, **kwargs) 
```

使用示例：

```
@data
class X:
    def __init__(self, x, y):
        self.x = x
        self.y = y
        self.z = x ^ y

print(X(3, 2))
# X(x=2, y=3, z=1) 
```

# c# - 在 C# 3.0 中如何排列源代码元素？

> ID：750915
> 
> 赞同：0
> 
> 时间：2009-04-15T09:25:17.190
> 
> 标签：c#, .net, oop, c#-3.0

跟风好看吗？

编辑：选项本质上是通用的，就 C# 元素而言可能并不详尽。

单一源文件可以包含以下内容：

### 笔记：

文件可以成对出现 - 可编辑 + 生成的单个文件只能有一个命名空间。

## 文件：选项-1

*   每个文件一个部分或全部类
*   每个文件零个或多个枚举
*   每个文件零个或多个结构
*   每个文件零个或多个委托类型

## 文件：选项-2

*   每个文件一个或多个接口

## 文件：选项-3

*   每个文件一个静态类

## 类内：选项1

给定顺序将有以下部分。

枚举 - 字段 - 属性 - 事件 - 委托 - 方法

在每个部分中，元素将按可访问性排序，即公共方法将出现在私有方法之前。内部类型可以在任何两个部分之间有自己的部分。或者，可以将相关字段和属性组合在一起。

## 类内：选项2

对密切相关的元素进行分组，而不考虑可访问性级别。一定要使用区域。

## 类内：选项3

只是不在乎。让 VS 帮助你。

你们怎么想和怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T09:34:42.860

`element`我每个文件只有一个。如果您需要将事物组合在一起以整理它们，那么这就是命名空间的用途。

我也倾向于在类的顶部粘贴字段和属性，然后是构造函数，然后是方法。我通常将私有方法放在使用它们的公共方法旁边。

编辑：在任何情况下都不应使用区域！曾经。一点也不。如果您的班级太大，您需要折叠大部分班级，您需要担心更严重的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T09:56:37.597

我通常将类型放在单独的文件中。（枚举、结构、类和委托）嵌套类型与其父类型位于同一个文件中。部分文件仅用于生成的文件。

在一个文件中，主要结构是：

*   嵌套类
*   常量、字段、事件和委托字段
*   特性
*   演员
*   终结器
*   方法（相关的相互接近，不一定按可访问性分组。）

我对这些规则并不太严格。他们是指导方针...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T09:31:51.743

我使用 File: **Option-3**和 "Within class: Option-1" + **"Within class: Option-2** "取决于类类型。如果有明确的关系，那么我会选择选项 2，但大多数时候我坚持使用选项 1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T09:44:55.003

我通常对文件使用 Option-3，在类中使用 Option-1。类由以下区域构成：

*   嵌套类
*   常数
*   活动/代表
*   字段
*   建造/销毁/完成
*   特性
*   方法

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T10:04:31.260

我也会每个文件只放一个元素。如果元素在自己的文件中，则更容易找到它们，尤其是在大型项目中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T10:06:04.610

Robert C Martin 的书 Clean Code 在这方面提供了一些有用的指导 - 虽然内容是针对 Java 的，但我发现该指导仍然非常适用于 .NET。

最重要的是选择一种风格并坚持下去。StyleCop 对于执行这些规则非常有用。

# datagridview - 如何打印dataGridview

> ID：750916
> 
> 赞同：0
> 
> 时间：2009-04-15T09:25:41.277
> 
> 标签：datagridview

如何在 vb.net 中打印来自 datagridview 的所有数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T09:28:48.257

请参阅Codeproject 上优秀的[DataGridViewPrinter 类。](http://www.codeproject.com/KB/printing/datagridviewprinter.aspx)

# .net - .net 紧凑框架中的 HMACMD5

> ID：750919
> 
> 赞同：2
> 
> 时间：2009-04-15T09:26:59.400
> 
> 标签：.net, compact-framework, cryptography

如何在 .net 紧凑框架中实现 HMACMD5 算法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T09:44:16.427

[cfAES](http://www.mperfect.net/cfAes/)支持 HMACMD5 并且是为 .NET Compact Framework 编写的。

# unit-testing - 您如何组织 MVC 控制器测试？

> ID：750927
> 
> 赞同：2
> 
> 时间：2009-04-15T09:31:20.357
> 
> 标签：unit-testing, code-organization

我正在寻找有关人们如何组织控制器测试的整洁建议。

例如，以我的“地址”控制器的“添加”功能为例，

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Add()
{
    var editAddress = new DTOEditAddress();
    editAddress.Address = new Address();
    editAddress.Countries = countryService.GetCountries();

    return View("Add", editAddress);
}

[RequireRole(Role = Role.Write)]
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Add(FormCollection form)
{
    // save code here
} 
```

我可能有一个名为 的夹具`"when_adding_an_address"`，但是我需要在此标题下测试两个操作...

我不想在我的夹具中调用我的`Act()`方法中的两个动作，所以我将夹具分成两半，但是我该如何命名呢？

`"When_adding_an_address_GET"`和`"When_adding_an_address_POST"`？

事情似乎变得一团糟，很快。

此外，您如何处理控制器的无状态/无设置断言，以及如何安排上述这些？例如：

```
[Test]
public void the_requesting_user_must_have_write_permissions_to_POST()
{
    Assert.IsTrue(this.SubjectUnderTest.ActionIsProtectedByRole(c => c.Add(null), Role.Write));
} 
```

这是我知道的自定义代码，但你应该明白，它只是检查方法上是否存在过滤器属性。关键是它不需要任何`Arrange()`or `Act()`。

欢迎任何提示！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-12T08:17:30.870

在我看来，您应该忘记以您正在测试的方法命名您的测试。事实上，测试单一方法是一个奇怪的概念。您应该测试客户将使用您的代码执行的单一操作。因此，例如，如果您可以使用 POST 和 GET 进行添加，您应该按照您的建议编写两个测试。如果你想看看在某个特殊情况下会发生什么，你应该编写另一个测试。

我通常会选择能够告诉维护者他需要知道的 Java 内容的名称：

```
@Test public void shouldRedirectToGetWhenPostingToAdd(){
    //...
} 
```

您可以使用任何语言执行此操作，并根据需要选择任何 *DD 命名约定，但关键是测试名称应该传达期望和场景。这样你会得到非常小的测试，我认为这是一件好事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-27T08:59:12.203

好吧，13 个月后，没有答案。惊人的。

继承人我现在做什么：

```
/tests/controllers/address/add/get.cs
/tests/controllers/address/add/valid.cs
/tests/controllers/address/add/invalid.cs 
```

# ruby-on-rails - Rails 视图中有多少代码合适？

> ID：750930
> 
> 赞同：5
> 
> 时间：2009-04-15T09:32:03.507
> 
> 标签：ruby-on-rails, model-view-controller

我知道最好将代码保留在表示层之外。但是，我想知道有多少被认为是“可接受的”。例如，我用这行代码填充了一个 html 选择框。

```
CodesecureProject.find(:all,:order => 'name').collect {|project| [project.name, project.id] } 
```

现在我在表单中嵌入了这行代码。我想知道社区是否认为这是否是太多代码，它应该首先存储在控制器上的实例变量中，然后存储在表单中使用的变量中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T12:59:02.947

我不会说我永远不会这样做（我会撒谎），但给出的代码示例会让我感到紧张。我想我更倾向于将数据从我的控制器传递到选择框。如果我注意到我不止一次地做某事，辅助方法是另一种选择。我更有可能在控制器中看到重复而不是在不同的视图中看到。

如果我在多个视图中使用相同的 HTML 组件，那么我可能会发现自己正在使用部分内容或将整个内容包装在自定义帮助程序中：project_select() 或类似的东西。

我在 MVC 世界中工作的越多，我就越发现自己在视图中避免代码。我有一种感觉，如果我达到零代码状态，就会达到某种禅宗掌握，尽管除了哲学术语之外的任何东西的价值都值得商榷。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T17:04:40.877

我在站点模型中使用以下静态方法来实现类似的功能：

```
class Site
  def self.select_options
    Site.find(:all, :order => 'UPPER(name)').collect {|s| [s.name, s.id]}
  end
def 
```

然后在我的域视图中，我调用：

```
<%= f.select :site_id, Site.select_options %> 
```

这在这些情况下非常有效。

在您的情况下，您可以尝试：

```
class CodesecureProject
  def self.select_options
    CodesecureProject.find(:all, :order => 'name').collect {|p| [p.name, p.id]}
  end
end 
```

然后通过视图调用它：

```
<%= f.select :codesecure_project_id, CodesecureProject.select_options %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T12:24:22.093

我的项目中有很多相同的代码，除了我尽量不做任何发现。在您的情况下，我将创建一个命名范围

```
named_scope :order, lambda { |order| {:order => order}} 
```

并制作代码：

```
CodesecureProject.order(:name).collect {|project| [project.name, project.id] } 
```

它有点干净。

如果您有很多需要名称和 id 的选择框（有时我确实会这样做），您也可以尝试制作一个除 ModelName 之外的助手并返回您需要的数组。

```
def magic_for_select(model)
  model.all.collect{|instance| [instance.name, instance.id]}
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T16:26:36.053

我会比 Maran 走得更远一些。通常我会执行以下操作：

*   在模型中创建一个 named_scope 来执行查找。
*   从控制器调用 named_scope 并将结果存储在实例变量中。
*   仅将实例变量放在视图中。

如果绝对必要，我只会使用助手。稍后回顾您的代码时，如果您看到控制器设置视图所需的数据，而不是视图调用帮助程序（另一个要查看的文件），则更容易理解事物。

# crystal-reports - 将基于htm参数页面的水晶报表发布到内网

> ID：750932
> 
> 赞同：0
> 
> 时间：2009-04-15T09:33:30.383
> 
> 标签：crystal-reports, parameters, crystal-reports-server

有没有办法发布我的水晶报告并通过基于 html 的参数页面（最好是 jsp）将它们调用到我们的 Intranet？

我们已经使用 Crystal Reports 开发了报表，我们希望用户能够通过我们的 itnranet 通过基于 HTML 的页面调用这些报表。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T17:03:50.183

好吧，我看到你使用了“Crystal Reports Server”标签——它就在那里回答了你的问题。:-) 它提供 Web 查看、报告调度和各种漂亮的后端功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-03T00:57:45.233

您可能还需要考虑[http://www.reportalsoftware.com](http://www.reportalsoftware.com)上的 rePORTAL 之类的解决方案。它允许您通过 Intranet 或 Extranet 安全地发布报告以供 Web 访问。无需编码。

# sql - 时隙SQL查询

> ID：750934
> 
> 赞同：0
> 
> 时间：2009-04-15T09:34:03.703
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我正在尝试编写查询以查看工程师是否在约定的时间段内访问了他的工作。

[表格截图 http://img24.imageshack.us/img24/1156/capturebcn.jpg](http://img24.imageshack.us/img24/1156/capturebcn.jpg)

到目前为止，这是我的查询：

```
SELECT
  v.[VISITDATE], 
  CONVERT(VARCHAR, v.[STARTTIME], 105) AS 'Startdate', 
  CONVERT(VARCHAR, v.[STARTTIME], 108) AS 'StartTime', 
  CONVERT(VARCHAR, v.[bookeddate], 105) AS 'BookedDate', 
  CONVERT(VARCHAR, t.[starttime], 108) AS 'TimeSlotStart', 
  CONVERT(VARCHAR, t.[endtime], 108) AS 'TimeSlotEnd',
  v.[Status]        
FROM
  [tbl_repair_visit] v 
  INNER JOIN [ltbl_TimeSlots] t ON v.timeslot = t.[Slot] 
```

`'StartDate'`和`'StartTime'`是工程师去的日期和时间。

`'BookedDate'`是他应该去的日期，`'TimeSlotStart'`并且`'TimeSlotEnd'`定义了他应该开始工作的时间跨度。所以我需要一个 True/False 值的列来说明他是否在正确的时间进入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T10:02:56.803

```
SELECT
    CASE
        WHEN StartDate = BookedDate AND StartTime BETWEEN TimeSlotStart and TimeSlotEnd
            THEN 'True'
        ELSE 'False'
    END
FROM
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T10:16:20.640

为什么不简单：

```
WHERE Startdate = BookedDate AND StartTime <= TimeSlotEnd AND StartTime >= TimeSlotStart 
```

?

# .net - double.Epsilon 与 std::numeric_limits ::分钟（）

> ID：750941
> 
> 赞同：3
> 
> 时间：2009-04-15T09:37:16.037
> 
> 标签：.net, c++, floating-point

为什么`double.Epsilon != std::numeric_limits<double>::min()`？

在我的 PC 上： `double.Epsilon == 4.9406564584124654E-324`并且在 .NET 中定义 `std::numeric_limits<double>::min() == 2.2250738585072014e-308`

有没有办法从.NET 获得 2.2250738585072014e-308？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T09:49:45.493

它们是不同的，因为[`double.Epsilon`](http://msdn.microsoft.com/en-us/library/system.double.epsilon.aspx)返回最小的可*表示*值。[`numeric_limits<double>::min()`](http://msdn.microsoft.com/en-us/library/69bwfeks.aspx)返回最小的*标准化*值。

基本上`double.Epsilon`相当于`numeric_limits<double>::denorm_min()`.

在 .NET 中获得等价物的最简单方法可能是计算出最小标准化数的位模式并使用[`BitConverter.Int64BitsToDouble`](http://msdn.microsoft.com/en-us/library/system.bitconverter.int64bitstodouble.aspx).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T09:46:06.967

那么你可以使用 C++/CLI 来返回值：

```
double epsilon() { return std::numeric_limits<double>::min(); } 
```

你为什么要这样做？为什么它们必须相同？您应该尽量避免在浮点数的边缘滑行。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-15T09:48:54.293

Epsilon 是两个双打之间的最小可能差异。（编辑：不准确，在这种情况下，它是最小的正非零数）。

```
double.MinValue 
```

是你需要的。

# c# - .NET 唯一对象标识符

> ID：750947
> 
> 赞同：130
> 
> 时间：2009-04-15T09:39:39.697
> 
> 标签：c#, unique, hashcode, gethashcode

有没有办法获取实例的唯一标识符？

`GetHashCode()`对于指向同一个实例的两个引用是相同的。但是，两个不同的实例可以（很容易）获得相同的哈希码：

```
Hashtable hashCodesSeen = new Hashtable();
LinkedList<object> l = new LinkedList<object>();
int n = 0;
while (true)
{
    object o = new object();
    // Remember objects so that they don't get collected.
    // This does not make any difference though :(
    l.AddFirst(o);
    int hashCode = o.GetHashCode();
    n++;
    if (hashCodesSeen.ContainsKey(hashCode))
    {
        // Same hashCode seen twice for DIFFERENT objects (n is as low as 5322).
        Console.WriteLine("Hashcode seen twice: " + n + " (" + hashCode + ")");
        break;
    }
    hashCodesSeen.Add(hashCode, null);
} 
```

我正在编写一个调试插件，我需要获取某种 ID 用于在程序运行期间唯一的引用。

我已经设法获得了实例的内部地址，它是唯一的，直到垃圾收集器 (GC) 压缩堆（= 移动对象 = 更改地址）。

堆栈溢出问题*[Object.GetHashCode() 的默认实现](https://stackoverflow.com/questions/720177/default-implementation-for-object-gethashcode)*可能是相关的。

这些对象不受我的控制，因为我正在使用调试器 API 访问正在调试的程序中的对象。如果我可以控制这些对象，那么添加我自己的唯一标识符将是微不足道的。

我想要用于构建哈希表 ID -> 对象的唯一 ID，以便能够查找已经看到的对象。现在我这样解决了：

```
Build a hashtable: 'hashCode' -> (list of objects with hash code == 'hashCode')
Find if object seen(o) {
    candidates = hashtable[o.GetHashCode()] // Objects with the same hashCode.
    If no candidates, the object is new
    If some candidates, compare their addresses to o.Address
        If no address is equal (the hash code was just a coincidence) -> o is new
        If some address equal, o already seen
} 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-03-20T15:06:31.507

## 仅限 .NET 4 及更高版本

好消息，大家！

这项工作的完美工具内置于 .NET 4 中，名为[`ConditionalWeakTable<TKey, TValue>`](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.compilerservices.conditionalweaktable-2). 这节课：

*   可用于将任意数据与托管对象实例相关联，就像字典一样（尽管它*不是*字典）
*   不依赖于内存地址，因此不受 GC 压缩堆的影响
*   不会仅仅因为对象已作为键输入到表中而使对象保持活动状态，因此可以使用它而无需使进程中的每个对象都永久存在
*   使用引用相等来确定对象身份；此外，类作者不能修改这种行为，因此它可以*一致*地用于任何类型的对象
*   可以即时填充，因此不需要您在对象构造函数中注入代码

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-04-15T09:44:40.747

引用*是*对象的唯一标识符。我不知道有任何方法可以将其转换为字符串等。引用的值在压缩期间会发生变化（如您所见），但到目前为止，每个先前的值 A 都将更改为值 B就安全代码而言，它仍然是唯一的 ID。

[如果涉及的对象在您的控制之下，您可以使用弱引用](http://msdn.microsoft.com/en-us/library/system.weakreference.aspx)（以避免垃圾收集）从对您选择的 ID（GUID、整数等）的引用创建映射。然而，这会增加一定数量的开销和复杂性。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-04-15T10:58:53.487

检查了[ObjectIDGenerator](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.objectidgenerator.aspx)类？这可以完成您尝试做的事情，以及 Marc Gravell 所描述的事情。

> ObjectIDGenerator 跟踪先前识别的对象。当您询问对象的 ID 时，ObjectIDGenerator 知道是返回现有 ID，还是生成并记住一个新 ID。
> 
> ID 在 ObjectIDGenerator 实例的生命周期内是唯一的。通常，ObjectIDGenerator 的生命周期与创建它的 Formatter 一样长。对象 ID 仅在给定的序列化流中有意义，并用于跟踪哪些对象在序列化对象图中引用了其他对象。
> 
> 使用哈希表，ObjectIDGenerator 保留分配给哪个对象的 ID。唯一标识每个对象的对象引用是运行时垃圾收集堆中的地址。对象引用值在序列化期间可能会发生变化，但表会自动更新，因此信息是正确的。
> 
> 对象 ID 是 64 位数字。分配从 1 开始，因此 0 绝不是有效的对象 ID。格式化程序可以选择零值来表示其值为空引用的对象引用（在 Visual Basic 中为 Nothing）。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2009-04-15T09:44:48.890

`RuntimeHelpers.GetHashCode()`可能会有所帮助（[MSDN](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.runtimehelpers.gethashcode.aspx)）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-15T11:31:25.887

您可以在一秒钟内开发自己的东西。例如：

```
 class Program
    {
        static void Main(string[] args)
        {
            var a = new object();
            var b = new object();
            Console.WriteLine("", a.GetId(), b.GetId());
        }
    }

    public static class MyExtensions
    {
        //this dictionary should use weak key references
        static Dictionary<object, int> d = new Dictionary<object,int>();
        static int gid = 0;

        public static int GetId(this object o)
        {
            if (d.ContainsKey(o)) return d[o];
            return d[o] = gid++;
        }
    } 
```

您可以自行选择您希望拥有的唯一 ID，例如 System.Guid.NewGuid() 或简单的整数以实现最快的访问。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-10-22T22:03:41.707

这个方法怎么样：

将第一个对象中的字段设置为新值。如果第二个对象中的相同字段具有相同的值，则它可能是相同的实例。否则，以不同的方式退出。

现在将第一个对象中的字段设置为不同的新值。如果第二个对象中的相同字段更改为不同的值，则肯定是同一个实例。

不要忘记将第一个对象中的字段设置回退出时的原始值。

问题？

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-07-22T09:42:24.090

可以在 Visual Studio 中创建唯一的对象标识符：在监视窗口中，右键单击对象变量并从上下文菜单中选择“创建*对象 ID ”。*

不幸的是，这是一个手动步骤，我不相信可以通过代码访问标识符。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-15T09:44:52.557

您必须自己手动分配这样的标识符 - 在实例内部或外部。

对于与数据库相关的记录，主键可能很有用（但您仍然可以获得重复项）。或者，要么使用 a `Guid`，要么保留自己的计数器，分配 using `Interlocked.Increment`（并使其足够大，使其不太可能溢出）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-10-20T18:32:47.703

我知道这已得到解答，但至少要注意您可以使用：

[http://msdn.microsoft.com/en-us/library/system.object.referenceequals.aspx](http://msdn.microsoft.com/en-us/library/system.object.referenceequals.aspx)

这不会直接给你一个“唯一的 id”，但结合 WeakReferences（和一个哈希集？）可以给你一个跟踪各种实例的非常简单的方法。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-07-07T12:19:24.610

如果您在自己的代码中为特定用途编写模块，[majkinetor 的方法](https://stackoverflow.com/a/751279/1941881) **可能**有效。但也有一些问题。

**首先**，官方文档不**保证**返回`GetHashCode()`唯一标识符（参见*[Object.GetHashCode Method()](https://msdn.microsoft.com/en-us/library/system.object.gethashcode(v=vs.110).aspx)*）：

> 您不应该假设相等的哈希码意味着对象相等。

**其次**，假设您有非常少量的对象，因此`GetHashCode()`在大多数情况下都可以使用，此方法可以被某些类型覆盖。
例如，您正在使用某个类 C 并且它覆盖`GetHashCode()`始终返回 0。然后 C 的每个对象都将获得相同的哈希码。不幸的是`Dictionary`，`HashTable`和其他一些关联容器将使用此方法：

> 哈希码是一个数值，用于在基于哈希的集合中插入和标识对象，例如 Dictionary<TKey, TValue> 类、Hashtable 类或从 DictionaryBase 类派生的类型。GetHashCode 方法为需要快速检查对象相等性的算法提供此哈希码。

所以，这种方法有很大的局限性。

**更重要**的是，如果你想构建一个通用库怎么办？您不仅不能修改所用类的源代码，而且它们的行为也是不可预测的。

感谢[Jon](https://stackoverflow.com/a/9789370/1941881)和[Simon](https://stackoverflow.com/a/751146/1941881)发布了他们的答案，我将在下面发布代码示例和性能建议。

```
using System;
using System.Diagnostics;
using System.Runtime.CompilerServices;
using System.Runtime.Serialization;
using System.Collections.Generic;

namespace ObjectSet
{
    public interface IObjectSet
    {
        /// <summary> check the existence of an object. </summary>
        /// <returns> true if object is exist, false otherwise. </returns>
        bool IsExist(object obj);

        /// <summary> if the object is not in the set, add it in. else do nothing. </summary>
        /// <returns> true if successfully added, false otherwise. </returns>
        bool Add(object obj);
    }

    public sealed class ObjectSetUsingConditionalWeakTable : IObjectSet
    {
        /// <summary> unit test on object set. </summary>
        internal static void Main() {
            Stopwatch sw = new Stopwatch();
            sw.Start();
            ObjectSetUsingConditionalWeakTable objSet = new ObjectSetUsingConditionalWeakTable();
            for (int i = 0; i < 10000000; ++i) {
                object obj = new object();
                if (objSet.IsExist(obj)) { Console.WriteLine("bug!!!"); }
                if (!objSet.Add(obj)) { Console.WriteLine("bug!!!"); }
                if (!objSet.IsExist(obj)) { Console.WriteLine("bug!!!"); }
            }
            sw.Stop();
            Console.WriteLine(sw.ElapsedMilliseconds);
        }

        public bool IsExist(object obj) {
            return objectSet.TryGetValue(obj, out tryGetValue_out0);
        }

        public bool Add(object obj) {
            if (IsExist(obj)) {
                return false;
            } else {
                objectSet.Add(obj, null);
                return true;
            }
        }

        /// <summary> internal representation of the set. (only use the key) </summary>
        private ConditionalWeakTable<object, object> objectSet = new ConditionalWeakTable<object, object>();

        /// <summary> used to fill the out parameter of ConditionalWeakTable.TryGetValue(). </summary>
        private static object tryGetValue_out0 = null;
    }

    [Obsolete("It will crash if there are too many objects and ObjectSetUsingConditionalWeakTable get a better performance.")]
    public sealed class ObjectSetUsingObjectIDGenerator : IObjectSet
    {
        /// <summary> unit test on object set. </summary>
        internal static void Main() {
            Stopwatch sw = new Stopwatch();
            sw.Start();
            ObjectSetUsingObjectIDGenerator objSet = new ObjectSetUsingObjectIDGenerator();
            for (int i = 0; i < 10000000; ++i) {
                object obj = new object();
                if (objSet.IsExist(obj)) { Console.WriteLine("bug!!!"); }
                if (!objSet.Add(obj)) { Console.WriteLine("bug!!!"); }
                if (!objSet.IsExist(obj)) { Console.WriteLine("bug!!!"); }
            }
            sw.Stop();
            Console.WriteLine(sw.ElapsedMilliseconds);
        }

        public bool IsExist(object obj) {
            bool firstTime;
            idGenerator.HasId(obj, out firstTime);
            return !firstTime;
        }

        public bool Add(object obj) {
            bool firstTime;
            idGenerator.GetId(obj, out firstTime);
            return firstTime;
        }

        /// <summary> internal representation of the set. </summary>
        private ObjectIDGenerator idGenerator = new ObjectIDGenerator();
    }
} 
```

在我的测试中，当在循环`ObjectIDGenerator`中创建 10,000,000 个对象（比上面代码中的 10 倍）时，会抛出一个异常来抱怨对象太多。`for`

此外，基准测试结果是`ConditionalWeakTable`实现比`ObjectIDGenerator`实现快 1.8 倍。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-01-07T10:21:23.940

我在这里提供的信息并不是新的，我只是为了完整性而添加了这个。

这段代码的想法很简单：

*   对象需要唯一的 ID，默认情况下不存在。取而代之的是，我们必须依赖次优的事情，那就是`RuntimeHelpers.GetHashCode`为我们提供一种唯一的 ID
*   为了检查唯一性，这意味着我们需要使用`object.ReferenceEquals`
*   但是，我们仍然希望有一个唯一的 ID，所以我添加了一个`GUID`，根据定义它是唯一的。
*   因为我不喜欢在不必要的情况下锁定所有内容，所以我不使用`ConditionalWeakTable`.

结合起来，这将为您提供以下代码：

```
public class UniqueIdMapper
{
    private class ObjectEqualityComparer : IEqualityComparer<object>
    {
        public bool Equals(object x, object y)
        {
            return object.ReferenceEquals(x, y);
        }

        public int GetHashCode(object obj)
        {
            return RuntimeHelpers.GetHashCode(obj);
        }
    }

    private Dictionary<object, Guid> dict = new Dictionary<object, Guid>(new ObjectEqualityComparer());
    public Guid GetUniqueId(object o)
    {
        Guid id;
        if (!dict.TryGetValue(o, out id))
        {
            id = Guid.NewGuid();
            dict.Add(o, id);
        }
        return id;
    }
} 
```

要使用它，请创建一个实例`UniqueIdMapper`并使用它为对象返回的 GUID。

* * *

**附录**

所以，这里还有更多事情要做；让我写一点`ConditionalWeakTable`。

`ConditionalWeakTable`做几件事。最重要的是它不关心垃圾收集器，即：你在这张表中引用的对象无论如何都会被收集。如果你查找一个对象，它基本上和上面的字典一样。

好奇不？毕竟，当一个对象被 GC 收集时，它会检查是否有对该对象的引用，如果有，它会收集它们。那么如果有一个来自 的对象，那么`ConditionalWeakTable`为什么要收集引用的对象呢？

`ConditionalWeakTable`使用了一个小技巧，其他一些 .NET 结构也使用：它实际上存储了一个 IntPtr，而不是存储对对象的引用。因为这不是真正的引用，所以可以收集对象。

所以，此时有两个问题需要解决。首先，对象可以在堆上移动，那么我们将使用什么作为 IntPtr？其次，我们怎么知道对象有一个活跃的引用？

*   对象可以固定在堆上，并且可以存储它的真实指针。当 GC 命中要移除的对象时，它会取消固定并收集它。但是，这意味着我们获得了固定资源，如果您有很多对象（由于内存碎片问题），这不是一个好主意。这可能不是它的工作方式。
*   当 GC 移动一个对象时，它会回调，然后可以更新引用。从外部调用来看，这可能是它的实现方式`DependentHandle`——但我相信它稍微复杂一些。
*   不是指向对象本身的指针，而是存储来自 GC 的所有对象列表中的指针。IntPtr 是此列表中的索引或指针。该列表仅在对象更改世代时更改，此时简单的回调可以更新指针。如果您还记得 Mark & Sweep 是如何工作的，那就更有意义了。没有固定，删除和以前一样。我相信这就是它在`DependentHandle`.

最后一个解决方案确实要求运行时在显式释放它们之前不重新使用列表存储桶，并且它还要求通过调用运行时检索所有对象。

如果我们假设他们使用这个解决方案，我们也可以解决第二个问题。Mark & Sweep 算法跟踪收集了哪些对象；一旦它被收集，我们就知道了。一旦对象检查对象是否存在，它就会调用“Free”，这会删除指针和列表条目。对象真的没了。

在这一点上要注意的一件重要的事情是，如果`ConditionalWeakTable`在多个线程中更新并且它不是线程安全的，那么事情就会出现可怕的错误。结果将是内存泄漏。这就是为什么所有调用`ConditionalWeakTable`都会执行简单的“锁定”以确保不会发生这种情况。

另一件需要注意的是，清理条目必须偶尔进行一次。虽然实际对象将被 GC 清理，但条目不会。这就是为什么`ConditionalWeakTable`只会变大的原因。一旦达到一定的限制（由哈希中的碰撞机会确定），它就会触发 a `Resize`，检查对象是否需要清理——如果需要清理，`free`则在 GC 过程中调用，删除`IntPtr`句柄。

我相信这也是为什么`DependentHandle`不直接暴露的原因-您不想弄乱事物并因此导致内存泄漏。下一个最好的事情是 a `WeakReference`（它也存储一个`IntPtr`而不是一个对象） - 但不幸的是不包括“依赖”方面。

剩下的就是让你玩弄这些机制，这样你就可以看到依赖关系在起作用。确保多次启动并观察结果：

```
class DependentObject
{
    public class MyKey : IDisposable
    {
        public MyKey(bool iskey)
        {
            this.iskey = iskey;
        }

        private bool disposed = false;
        private bool iskey;

        public void Dispose()
        {
            if (!disposed)
            {
                disposed = true;
                Console.WriteLine("Cleanup {0}", iskey);
            }
        }

        ~MyKey()
        {
            Dispose();
        }
    }

    static void Main(string[] args)
    {
        var dep = new MyKey(true); // also try passing this to cwt.Add

        ConditionalWeakTable<MyKey, MyKey> cwt = new ConditionalWeakTable<MyKey, MyKey>();
        cwt.Add(new MyKey(true), dep); // try doing this 5 times f.ex.

        GC.Collect(GC.MaxGeneration);
        GC.WaitForFullGCComplete();

        Console.WriteLine("Wait");
        Console.ReadLine(); // Put a breakpoint here and inspect cwt to see that the IntPtr is still there
    } 
```

# jsp - .jsp 中的 href 错误

> ID：750948
> 
> 赞同：0
> 
> 时间：2009-04-15T09:39:50.227
> 
> 标签：jsp

我的 .jsp 文件中有这段代码：

```
<li><a href="${pageContext.request.contextPath}/pages/client_home.jsp" id="home">Home</a></li>
  <li><a href="${pageContext.request.contextPath}/pages/client_about.jsp" id="about">About</a></li> 
```

当我单击链接时，出现此错误：

> HTTP 状态 500 -
> 
> 类型异常报告
> 
> 信息
> 
> 描述 服务器遇到一个内部错误 () 阻止它完成这个请求。
> 
> 例外
> 
> org.apache.jasper.JasperException：javax.servlet.ServletException：找不到文件“/1920.14042009/pages/client_navbar.jsp” org.apache.jasper.servlet.JspServletWrapper.handleJspException（JspServletWrapper.java:522）org.apache.jasper .servlet.JspServletWrapper.service(JspServletWrapper.java:398) org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:337) org.apache.jasper.servlet.JspServlet.service(JspServlet.java:266) javax .servlet.http.HttpServlet.service(HttpServlet.java:803) ...

我还尝试将 ${pageContext.request.contextPath}... 替换为

```
http://localhost:8080/1920.14042009/pages/client_about.jsp. 
```

错误仍然存​​在。

请帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T09:58:59.993

问题不在于两行代码或使用`${pageContext.request.contextPath}`

该文件`client_navbar.jsp`在上下文中不可用，但由链接指向的 jsp 文件引用。请检查...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-18T18:57:11.013

这个文件“/1920.14042009/pages/client_navbar.jsp”是如何进入图片的，它是如何重定向到这个文件的，如果有的话，你能把重定向代码和包结构一起发布。

# java - Java 的简单 Web 服务器和 MVC 框架

> ID：750952
> 
> 赞同：9
> 
> 时间：2009-04-15T09:43:24.273
> 
> 标签：java, model-view-controller

有谁知道一个简单的 Web MVC 框架和用于 Java 的开源 Web 服务器？

这是一个简单的 Web 服务器和框架，供辅导班的学生使用。

重要的是，Web 服务器和 MVC 框架都很简单，OSS 让学生可以轻松地窥探底层，导师可以轻松地支持、学习和教授它。

**更新**我可以通过打开几个罐子并将它们加入一个来避免单个罐子问题的建议是一个很好的建议。我一定会接受的，因此放宽了单罐的要求

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T09:53:35.123

您可以看看[Stripes](http://www.stripesframework.org/)，它根本没有任何编译时依赖项（显然，除了它自己之外），并且只需要在运行时进行[COS](http://servlets.com/cos/)和[Commons Logging 。](http://commons.apache.org/logging/)

它也非常轻巧，很容易拿起。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T10:58:24.640

[这部剧](http://www.playframework.org/)给我留下了深刻的印象！我认为在 MVC 方面可以满足您的大部分要求的框架[。](http://www.playframework.org/)它很像 Rails 等，并且开箱即用地支持基于注释的 Hibernate 持久性。唯一值得一提的三个“奇怪”的事情是：

1.  我认为它有自己的内置属性实现（使用反射和字节码修改）
2.  它使用异常进行流量控制
3.  对于某些要求，它的模板可能有点基础，但总的来说，它适用于更简单的东西。

就快速创建一个好的网站而言，这些都不是一个很好的选择，但如果你想同时教 Java，第 1 点和第 2 点可能会让你望而却步。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-15T09:48:15.183

如果拥有一个 jar 对您很重要，您可以解压缩多个 jar，然后重新组合成一个 jar（注意任何重复或文件冲突）。

这可能比为了满足单罐需求而牺牲 MVC 选择更容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T10:45:25.763

如果它用于教授 MVC，为什么不通过在 Tomcat 上使用 JSP 和 Servlet 来解释它们。如果您想使用某些框架进行教学，那么在我看来，tomcat 上的 JSF 是最简单的，因为不需要太多配置，并且后端代码也只是纯 Java，没有特定于框架的 API。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T11:48:37.280

如果您正在教某人修理汽车，您当然可以从 Briggs & Stratton 割草机发动机开始，然后逐步提高。我建议以非常受欢迎的东西开始他们 - 在我们的比喻中，本田思域。

从一个非常流行的框架开始将产生更好的 Internet 资源，并将使之前遇到相同问题的许多其他人受益。此外，使用在现实世界中使用并会出现在职位发布中的东西对于创建开发社区的高效成员来说并不是一个坏方法。

我建议[Spring MVC](http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html)。如果你想隐藏 IoC，这也很容易做到。一个样品：

```
package samples;

public class SampleController extends AbstractController {

    public ModelAndView handleRequestInternal(
        HttpServletRequest request,
        HttpServletResponse response) throws Exception {

        ModelAndView mav = new ModelAndView("hello");
        mav.addObject("message", "Hello World!");
        return mav;        
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T01:40:44.130

试试超简单的基于 java 的 Web MVC 框架[VRaptor 2](http://www.vraptor.org/)。我**5 岁的侄女**能够编写一个简单的 web 应用程序并在**7 分钟**内启动并运行（当然还有一些指导）。不是开玩笑 ！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-16T23:48:07.300

大家觉得[威克特](http://wicket.apache.org/introduction.html)怎么样？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-31T07:49:04.407

> 有谁知道一个简单的 Web MVC 框架和用于 Java 的开源 Web 服务器？

请参阅[HybridJava](http://www.hybridjava.com/index.html)。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-07-09T13:12:16.527

简单的mvc

```
 package app.controllers;
    import mvc.*;
    class mycontroller implements Controller {
        public View Controller() {
            return new View("myview");
        }
    } 
```

# blackberry - Blackberry - 从应用程序资源将 mp3 文件添加到 sdcard 文件夹

> ID：750953
> 
> 赞同：2
> 
> 时间：2009-04-15T09:43:38.347
> 
> 标签：blackberry, file-io, java-me, resources, jsr75

我的黑莓应用程序有一些与应用程序捆绑在一起的 mp3 文件。我想通过程序将这些文件从应用程序添加到 sdcard 中的文件夹或手机内存中的文件夹中。

我怎样才能做到这一点？是否可以？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T13:38:29.747

可以将资源作为流打开：

```
String fileName = "/myPath/myFile.mp3";
InputStream inputStream = getClass().getResourceAsStream(fileName); 
```

然后读取流并将其写入文件：

```
String locator = "file:///SDCard"+fileName;
FileConnection saveFile = (FileConnection)Connector.open(locator);
saveFile.create();
OutputStream outputStream = saveFile.openOutputStream(); 
```

我确定您可以循环输入流以将其复制到输出流，然后关闭。

# c# - 在 ASP.NET 中将事件从页面发送到其母版页

> ID：750965
> 
> 赞同：1
> 
> 时间：2009-04-15T09:47:06.433
> 
> 标签：c#, asp.net, events, master-pages

如何在其母版页可以响应的内容页中引发事件？

例如，我有一个使用母版页的内容页。母版页包含网站导航栏。根据我所在的页面，我想向母版页发送一个事件，以更改导航栏中当前页面菜单项的 CSS 类。

我正在使用 Visual Studio 2008 和 ASP.NET 3.5 和 C#。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T09:53:28.680

如果事件发生在所有内容页面上，请使用 Kirtan 的 BasePage 解决方案。如果基本页面不合适，则在发生事件的每个页面中在页面加载时添加此页面。

```
thisPage.Event += (Page.Master as YourMasterPageClass).YourCustomEventHandler 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T09:55:20.533

编辑，根据您的要求，您实际上并不需要事件，您只想在主服务器上调用一个方法。在我的头顶上，在主人：

```
public void ChangeCss(string className)
{
    someObject.CssClass = className;
} 
```

然后在您的页面中：

```
(this.Master as MyMasterType).ChangeCss("myclass"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T09:49:54.477

创建一个基页类。为相同的创建相应的委托和事件。然后在母版页中，执行此操作 -

```
(Page as BasePage).Event += attach event handler here in the master page. 
```

页面类必须是这样的 -

```
public class MyPage : BasePage { } 
```

BasePage 类必须是这样的 -

```
public class BasePage : System.Web.UI.Page { } //This will go in the App_Code folder. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T10:04:04.520

事件似乎不是表明这一点的最佳方式，因为您需要母版页来理解您的页面，您很可能在页面上有一个标准属性来指示它们在导航中的“键”。

在您的母版页代码中：

```
protected override void OnInit(EventArgs e)
{
    base.OnInit(e);

    var navigatable = this.Page as INavigatable;

    if (navigatable != null)
        this.Navigation.ActiveKey = navigatable .NavigationKey;
} 
```

导航界面：

```
public interface INavigatable
{
    string NavigationKey { get; }
} 
```

页面实例：

```
public class AboutPage : Page, INavigatable
{
    public string NavigationKey
    {
        get { return "About"; }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-04T15:33:32.450

您可以使用称为 EventBubbling 的技术引发事件。

# sharepoint - SharePoint：如何获取用户的上次注销或上次会话的结束日期/时间

> ID：750971
> 
> 赞同：4
> 
> 时间：2009-04-15T09:49:16.163
> 
> 标签：sharepoint, moss

如何确定用户在 MOSS 2007 Web 应用程序上的最后登录日期/时间？直到现在我还没有在对象模型中找到这些信息。

我已经考虑过从 AD/LDAP 请求 lastLogonTimeStamp ，但这将非常不精确。

另一个想法是编写一些代码，以便在用户登录时将登录日期/时间存储在用户信息列表中。但直到现在我还不确定如何执行此操作。

那么，有人知道更好的解决方案吗？

**更新**

在做了一些测试和更多地思考我的问题之后，我意识到实际上我不需要最后一次登录的时间戳，而是最后一次会话结束的最后一次注销的时间戳。

由于现在可以通过对象模型获取上次登录的时间戳，因此我可以想象也无法获取上次会话的结束日期和时间。

那么我怎样才能得到这些信息呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T20:40:31.340

1.  使用 LastSessionID、LastSessionTime 扩展用户信息列表
2.  给你的主人添加一点 web 控件。如果 LastSessionID 不同，此 Web 控件会更新用户信息列表。并增加时间。
3.  当然在站点集合 RootWeb 上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T14:50:42.977

令人惊讶的是，似乎没有办法使用 SharePoint API 获取此信息。但是，您可以从 IIS 日志中检索此信息。我认为这样做会比从 AD 中获取更精确，因为用户无需访问 SharePoint 就可以登录系统。

另一种方法是使用 SharePoint 审核。据我所知，没有特定的登录审核事​​件，但您可以在用户阅读 SharePoint 欢迎页面时进行审核。使用SPAuditQuery，您可以检索一些详细信息。

# c++ - 使用 Boost 的 regex_match 编译 C++ 代码

> ID：750976
> 
> 赞同：0
> 
> 时间：2009-04-15T09:52:01.040
> 
> 标签：c++, regex, string, boost, matching

鉴于此代码：

```
#include <iostream>
#include <vector>
#include <fstream>
#include <sstream>
#include <boost/regex.hpp>
using namespace std;
using namespace boost;

int main  ( int arg_count, char *arg_vec[] ) {
    if (arg_count !=2 ) {
        cerr << "expected one argument" << endl;
        return EXIT_FAILURE;
    }

    string InputString = arg_vec[1];
    string toMatch = "FOO";

    const regex e(toMatch);
    if (const regex_match(InputString, e)) {// this is line 26
        cout << "Match" << endl;
    } else {
        cout << "No Match" << endl;
    }

    return 0;
} 
```

使用此命令编译：

```
g++ -I /home/foolishbrat/.boost/include/boost-1_37 test.cc -o test 
```

它给出了这个错误：

```
test.cc: In function `int main(int, char**)':
test.cc:26: error: syntax error before `)' token 
```

我的代码有什么问题？

如果我在第 26 行删除“const”并使用相同的命令进行编译。我会得到这个错误：

```
/misc/raid2/Melchior/foolishbrat/tmp/ccr3zzcH.o(.gnu.linkonce.t._ZN5boost11regex_matchIN9__gnu_cxx17__normal_iteratorIPKcSsEESaINS_9sub_matchIS5_EEEcNS_12regex_traitsIcNS_16cpp_regex_traitsIcEEEEEEbT_SD_RNS_13match_resultsISD_T0_EERKNS_11basic_regexIT1_T2_EENS_15regex_constants12_match_flagsE+0x61): In function `bool boost::regex_match<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<boost::sub_match<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, char, boost::regex_traits<char, boost::cpp_regex_traits<char> > >(__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, __gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::match_results<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<boost::sub_match<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >&, boost::basic_regex<char, boost::regex_traits<char, boost::cpp_regex_traits<char> > > const&, boost::regex_constants::_match_flags)':
: undefined reference to `boost::re_detail::perl_matcher<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<boost::sub_match<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, boost::regex_traits<char, boost::cpp_regex_traits<char> > >::match()'
/misc/raid2/Melchior/foolishbrat/tmp/ccr3zzcH.o(.gnu.linkonce.t._ZN5boost11basic_regexIcNS_12regex_traitsIcNS_16cpp_regex_traitsIcEEEEE6assignEPKcS7_j+0x27): In function `boost::basic_regex<char, boost::regex_traits<char, boost::cpp_regex_traits<char> > >::assign(char const*, char const*, unsigned)':
: undefined reference to `boost::basic_regex<char, boost::regex_traits<char, boost::cpp_regex_traits<char> > >::do_assign(char const*, char const*, unsigned)'
/misc/raid2/Melchior/foolishbrat/tmp/ccr3zzcH.o(.gnu.linkonce.t._ZN5boost9re_detail12perl_matcherIN9__gnu_cxx17__normal_iteratorIPKcSsEESaINS_9sub_matchIS6_EEENS_12regex_traitsIcNS_16cpp_regex_traitsIcEEEEEC1ES6_S6_RNS_13match_resultsIS6_S9_EERKNS_11basic_regexIcSD_EENS_15regex_constants12_match_flagsES6_+0xf2): In function `boost::re_detail::perl_matcher<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<boost::sub_match<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, boost::regex_traits<char, boost::cpp_regex_traits<char> > >::perl_matcher[in-charge](__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, __gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, boost::match_results<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<boost::sub_match<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >&, boost::basic_regex<char, boost::regex_traits<char, boost::cpp_regex_traits<char> > > const&, boost::regex_constants::_match_flags, __gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >)':
: undefined reference to `boost::re_detail::perl_matcher<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<boost::sub_match<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, boost::regex_traits<char, boost::cpp_regex_traits<char> > >::construct_init(boost::basic_regex<char, boost::regex_traits<char, boost::cpp_regex_traits<char> > > const&, boost::regex_constants::_match_flags)'
collect2: ld returned 1 exit status 
```

**更新：**

通过此编译和链接解决：

```
g++ -I ~/.boost/include/boost-1_37 test.cc -o test  /home/foolishbrat/.boost/lib/libboost_regex-gcc33-mt-1_37.a 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T10:04:20.793

您需要链接必要的 boost 库。添加`-l <path to libraries>`到构建命令

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T09:55:31.033

```
if (const regex_match(InputString, e)) {// this is line 26 
```

您不需要（实际上也不应该）`const`在这里说。只需删除这个词，至少这个错误应该消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T09:57:33.990

删除第`const`26 行的关键字。

# web-services - 为了在 HTML 中使用 javascript 使用 web 服务方法，我们需要在 web 目录中添加任何 htc 吗？

> ID：750978
> 
> 赞同：0
> 
> 时间：2009-04-15T09:52:25.143
> 
> 标签：web-services

为了在 HTML 中使用 javascript 使用 web 服务方法，我们需要在 web 目录中添加任何 htc 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T10:00:19.897

调用 Web 服务与调用网页基本相同（调用方法和“如何处理返回”部分有所不同），所以不，您不必更改任何内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T10:25:32.177

取决于你的策略。HTC 文件被认为是过时的并且在 Firefox 中不受支持，但是它们也是启动和运行的最快方法之一。

我会研究[jQuery 的 ajax](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)功能作为替代方案。

# c# - 求解密码的有效方法

> ID：750984
> 
> 赞同：5
> 
> 时间：2009-04-15T09:54:09.413
> 
> 标签：c#, python, solver, cryptarithmetic-puzzle

嗨，我遇到了这个难题，它是著名的基于单词和数字的难题的子集，称为[Cryptarithms](http://en.wikipedia.org/wiki/Verbal_arithmetic)。假设你有一个表达式

发送 + 更多 = 金钱

现在有趣的部分是，每个字母表代表一个从 0 到 9 的唯一数字。我想写一个通用求解器，但我最终为它写了一个蛮力解决方案。任何接受者，我该如何解决？

我认为可以使用谓词逻辑或集合论来解决。我对寻找基于 C# 或 Python 的解决方案特别感兴趣。任何人。？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T10:48:01.217

在 PyCon 2009 上，Raymond Hettinger 谈到了 Python 中的 AI 编程，并涵盖了密码算法。

整个演讲的视频可以在[这里](http://blip.tv/file/1947373/)看到，Python 2.6 解决方案的食谱可以在[这个链接](http://code.activestate.com/recipes/576615/)上找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T10:37:17.140

这是一个小问题，暴力解决方案不是一个坏方法。假设每个字母必须代表一个唯一的数字（即我们不允许解 S = 9、M = 1、* = 0），我们看到要尝试的组合数是*n！*，其中*n*是密码中唯一字母的数量。要评估的理论最大组合数是*10！= 3 628 800*，对于计算机而言，这确实是一个很小的数字。

如果我们允许多个字母代表同一个数字，则尝试组合的数量将受到*10^n*的限制，其中*n*是唯一字母的数量。假设只有大写英文字母，我们的理论最大组合数为*10^26*，因此对于理论上的最坏情况，我们可能需要一些启发式方法。大多数实用密码的唯一字母都少于 26 个，因此正常情况可能会以小于 10的*n为界，这对于计算机来说又是相当合理的。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T10:54:12.623

好吧，试着把它写成一个函数列表：

```
 SEND
 MORE
----+
MONEY 
```

如果我记得我的初中数学，这应该是：

```
Y = (D+E) mod 10
E = ((N+R) + (D+E)/10) mod 10
... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-10T15:40:27.027

这是一种有效的蛮力方法，它递归地遍历所有可能性，但也注意到特定问题的结构以简化问题。

每个方法的前几个参数代表每个分支的试验值，参数 v1、v2 等是尚未分配的值，可以按任何顺序传递。该方法是有效的，因为它最多有 8x7x5 个可能的试验解决方案，而不是 10!/2 个可能的暴力解决方案

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void MESDYNR(int m, int s, int e, int d, int y, int n, int r, int v1, int v2, int v3)
        {
            // Solve for O in hundreds position
            // "SEND" + "M?RE" = "M?NEY"
            int carry = (10 * n + d + 10 * r + e) / 100;
            int o = (10 + n - (e + carry))%10;

            if ((v1 == o) || (v2 == o) || (v3 == o)) 
            {
                // check O is valid in thousands position
                if (o == ((10 + (100 * e + 10 * n + d + 100 * o + 10 * r + e) / 1000 + m + s) % 10))
                {
                    // "SEND" + "MORE" = "MONEY"
                    int send = 1000 * s + 100 * e + 10 * n + d;
                    int more = 1000 * m + 100 * o + 10 * r + e;
                    int money = 10000 * m + 1000 * o + 100 * n + 10 * e + y;

                    // Chck this solution
                    if ((send + more) == money)
                    {
                        Console.WriteLine(send + " + " + more + " = " + money);
                    }
                }
            }
        }

        static void MSEDYN(int m, int s, int e, int d, int y, int n, int v1, int v2, int v3, int v4)
        {
            // Solve for R
            // "SEND" + "M*?E" = "M*NEY"
            int carry = (d + e) / 10;
            int r = (10 + e - (n + carry)) % 10;

            if (v1 == r) MESDYNR(m, s, e, d, y, n, r, v2, v3, v4);
            else if (v2 == r) MESDYNR(m, s, e, d, y, n, r, v1, v3, v4);
            else if (v3 == r) MESDYNR(m, s, e, d, y, n, r, v1, v2, v4);
            else if (v4 == r) MESDYNR(m, s, e, d, y, n, r, v1, v2, v3);
        }

        static void MSEDY(int m, int s, int e, int d, int y, int v1, int v2, int v3, int v4, int v5)
        {
            // Pick any value for N
            MSEDYN(m, s, e, d, y, v1, v2, v3, v4, v5);
            MSEDYN(m, s, e, d, y, v2, v1, v3, v4, v5);
            MSEDYN(m, s, e, d, y, v3, v1, v2, v4, v5);
            MSEDYN(m, s, e, d, y, v4, v1, v2, v3, v5);
            MSEDYN(m, s, e, d, y, v5, v1, v2, v3, v4);
        }

        static void MSED(int m, int s, int e, int d, int v1, int v2, int v3, int v4, int v5, int v6)
        {
            // Solve for Y
            // "SE*D" + "M**E" = "M**E?"
            int y = (e + d) % 10;

            if (v1 == y) MSEDY(m, s, e, d, y, v2, v3, v4, v5, v6);
            else if (v2 == y) MSEDY(m, s, e, d, y, v1, v3, v4, v5, v6);
            else if (v3 == y) MSEDY(m, s, e, d, y, v1, v2, v4, v5, v6);
            else if (v4 == y) MSEDY(m, s, e, d, y, v1, v2, v3, v5, v6);
            else if (v5 == y) MSEDY(m, s, e, d, y, v1, v2, v3, v4, v6);
            else if (v6 == y) MSEDY(m, s, e, d, y, v1, v2, v3, v4, v5);
        }

        static void MSE(int m, int s, int e, int v1, int v2, int v3, int v4, int v5, int v6, int v7)
        {
            // "SE**" + "M**E" = "M**E*"
            // Pick any value for D
            MSED(m, s, e, v1, v2, v3, v4, v5, v6, v7);
            MSED(m, s, e, v2, v1, v3, v4, v5, v6, v7);
            MSED(m, s, e, v3, v1, v2, v4, v5, v6, v7);
            MSED(m, s, e, v4, v1, v2, v3, v5, v6, v7);
            MSED(m, s, e, v5, v1, v2, v3, v4, v6, v7);
            MSED(m, s, e, v6, v1, v2, v3, v4, v5, v7);
            MSED(m, s, e, v7, v1, v2, v3, v4, v5, v6);
        }

        static void MS(int m, int s, int v1, int v2, int v3, int v4, int v5, int v6, int v7, int v8)
        {
            // "S***" + "M***" = "M****"
            // Pick any value for E
            MSE(m, s, v1, v2, v3, v4, v5, v6, v7, v8);
            MSE(m, s, v2, v1, v3, v4, v5, v6, v7, v8);
            MSE(m, s, v3, v1, v2, v4, v5, v6, v7, v8);
            MSE(m, s, v4, v1, v2, v3, v5, v6, v7, v8);
            MSE(m, s, v5, v1, v2, v3, v4, v6, v7, v8);
            MSE(m, s, v6, v1, v2, v3, v4, v5, v7, v8);
            MSE(m, s, v7, v1, v2, v3, v4, v5, v6, v8);
            MSE(m, s, v8, v1, v2, v3, v4, v5, v6, v7);
         }

        static void Main(string[] args)
        {
            // M must be 1
            // S must be 8 or 9
            DateTime Start = DateTime.Now;
            MS(1, 8, 2, 3, 4, 5, 6, 7, 9, 0);
            MS(1, 9, 2, 3, 4, 5, 6, 7, 8, 0);
            Console.WriteLine((DateTime.Now-Start).Milliseconds);
            return;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T10:04:18.920

[这](http://wiki.tcl.tk/3304)可能会有所帮助

编辑：您发布的 wiki 链接上的答案也很有用！

# csr - 为 quickbook 应用程序注册过程生成 CSR

> ID：750985
> 
> 赞同：0
> 
> 时间：2009-04-15T09:55:03.247
> 
> 标签：csr

我们正在将我们的 Web 应用程序与 Quick book 集成。我们正在使用托管模型。我们需要注册我们的网络应用程序。但是我们不能这样做，因为它要求 CSR 密钥。但我们不知道从哪里得到这个？

有什么答案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-04T12:54:54.430

在此 wiki 页面上有注册 QuickBooks Online Edition 应用程序的详细说明：[QuickBooks Online Edition 集成 wiki](http://wiki.consolibyte.com/wiki/doku.php/quickbooks_online_edition)

此 wiki 页面上有 QuickBooks Merchant Service 的详细说明：[QuickBooks Merchant Service 集成 wiki](http://wiki.consolibyte.com/wiki/doku.php/quickbooks_qbms_integration)

你并没有在你的问题中提供很多细节，但过程基本上是：

1.  填写初始申请注册信息
2.  使用以下命令在您的服务器上创建 CSR（证书签名请求）：

    openssl genrsa -out host.key 1024

    openssl req -new -nodes -key host.key -out host.csr

3.  保存 Intuit 发回给您的签名证书，以便在您发出的请求中使用。

如果您需要更多帮助，您将不得不发布您在此过程中的确切位置以及您到目前为止所做的事情。

# iis - 无 Cookie 会话和 IIS7 导致重定向循环

> ID：750997
> 
> 赞同：7
> 
> 时间：2009-04-15T10:00:05.280
> 
> 标签：iis, iis-7, cookieless, redirect-loop

我有一个使用 cookieless 会话的 ASP .NET 网站。当使用 url 向站点发出初始请求时，例如：

[http://localhost/站点](http://localhost/site)

IE 只显示标准的“Internet Explorer 无法显示网页”消息。Firefox 更有帮助，它会显示以下消息：

“超出此 URL 的重定向限制。无法加载请求的页面。这可能是由 cookie 被阻止造成的。”

我在 global.asax 中添加了一些跟踪，然后我进入了应用程序启动事件，但没有进入会话启动事件。

我没有用浏览器明确阻止任何 cookie，也没有设置任何 http 重定向规则。

该站点在我的开发服务器和 IIS6 下运行良好。

如果我关闭无 cookie 会话，那么 IIS7 中的一切都很好。

我可以用最简单的网站重现这一点，即在 Visual Studio 中，文件 > 新网站，然后只需设置 cookieless="true" web.config 设置。

我已经在同事工作站上对此进行了测试并且它可以工作，所以我猜它是 IIS7 某处的一些设置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T12:17:50.503

好吧，我发现了问题。

我定义了两个指向同一个 dll 的 ISAPI 过滤器：

%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_filter.dll c:\windows\Microsoft.NET\Framework\v2.0.50727\aspnet_filter.dll

我删除了第二个，一切都很好。我不知道是什么把副本放在那里，肯定不是我。

# .net - 托管 C++ 中的类型转换

> ID：750999
> 
> 赞同：0
> 
> 时间：2009-04-15T10:01:53.777
> 
> 标签：.net, c++-cli

嗨，在第二行尝试从对象转换为字符串数组时，它显示编译时错误为

'System::String ^' : 本机数组不能包含此托管类型

'initializing' : 无法从 'System::String ^' 转换为 'System::String ^[]'

**代码：**

```
RegistryKey ^rk = Registry::LocalMachine->OpenSubKey("SOFTWARE\\Microsoft\\Microsoft SQLServer");
String ^instances[] = (String^)rk->GetValue("InstalledInstances"); 
```

如何解决这个问题....提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T10:09:32.293

您声明`instances`为数组类型：

```
String ^instances[] = (String^)rk->GetValue("InstalledInstances"); 
```

相反，将其声明为字符串：

```
String ^instances = (String^)rk->GetValue("InstalledInstances"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T10:08:25.587

将最后一行更改为

```
String ^ instances = (String^)rk->GetValue("InstalledInstances"); 
```

（注意没有括号）。如果键包含多字符串，请使用

```
array<String^>^ instances
    = (array<String^>^)rk->GetValue("InstalledInstances"); 
```

有关详细信息，请参阅[RegistryKey.GetValue 的文档](http://msdn.microsoft.com/en-us/library/fdf576x1.aspx)。**********~~~~*