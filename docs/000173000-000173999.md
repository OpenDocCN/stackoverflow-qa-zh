# StackOverflow 问答 000173000-000173999

# php - 将 mysql TIME 从 24 HR 转换为 AM/PM 格式

> ID：173005
> 
> 赞同：15
> 
> 时间：2008-10-06T01:51:44.263
> 
> 标签：php, mysql, datetime, date, time

我想在我的网站上显示 mysql 表中的 TIME 字段，而不是显示 21:00:00 等，我想显示 8:00 PM。我需要一个函数/代码来执行此操作，甚至需要任何指向正确方向的指针。将带有一些代码的第一个回复标记为正确回复。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-06T02:00:08.973

看看这个：[http ://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html)

我想你会想要 date_format()。

示例：DATE_FORMAT($date, "%r")

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-03-05T11:35:40.687

使用以下示例以 AM/PM 格式显示日期和时间数据...

```
SELECT DATE_FORMAT(`t`.`date_field`,'%h:%i %p') AS `date_field` FROM `table_name` AS `t` 
```

或者

```
SELECT DATE_FORMAT(`t`.`date_field`,'%r') AS `date_field` FROM `table_name` AS `t` 
```

两者都正常工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T03:06:16.360

您还可以使用 MYSQL 的`UNIX_TIMESTAMP()`函数将该列选择为 unix 时间戳。然后用 PHP 格式化。IMO 这更灵活...

```
select a, b, c, UNIX_TIMESTAMP(instime) as unixtime; 
```

在 PHP 中使用`date()`函数并以任何你想要的方式格式化它。

```
<?php echo date('Y/m/d', $row->unixtime); ?> 
```

我喜欢这种方法而不是在 SQL 中格式化它的原因是 b/c，对我来说，日期的格式是一个显示决定&（在我看来）在 SQL 中格式化日期感觉不对......为什么将显示逻辑放在你的SQL？

现在 - 如果您没有在 PHP 中处理数据并且正在执行即席查询，那么`DATE_FORMAT()`就是要走的路。但是，如果您要让数据显示在网络上，我会使用`UNIX_TIMESTAMP()`PHP 进行格式化...

我的意思是...假设您想更改日期和时间在页面上的显示方式...是否必须修改您的 SQL 以进行显示调整？

我的 2 美分

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-10T12:00:14.793

我一直在尝试做同样的事情，并从谷歌搜索中返回了这个页面。我在 21:00:00 的时间解决了问题；

*   使用`DATE_FORMAT(<field>,'%l.%i%p')`返回 9.00PM

*   在它周围放置一个`LOWER()`函数以返回晚上 9 点

所以完整的代码是；`DATE_FORMAT(<field>,'%l.%i%p')`

对我来说工作正常...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T02:19:35.690

使用[DATE_FORMAT()](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_date-format)

DATE_FORMAT(<字段>,'%h:%i:%s %p')

或者

DATE_FORMAT(<字段>,'%r')

# apache - Apache：多个日志文件？

> ID：173008
> 
> 赞同：1
> 
> 时间：2008-10-06T01:55:12.900
> 
> 标签：apache, logging

文件是什么`access.log.*`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T01:56:31.447

我相信 Apache 会进行日志轮换。因此，这些将是较旧的日志文件，而 access.log 文件是当前文件。

# wpf - 如何使 WPF 滑块仅吸附到离散的整数位置？

> ID：173009
> 
> 赞同：127
> 
> 时间：2008-10-06T01:56:26.267
> 
> 标签：wpf, controls, slider

我经常想要一个 WPF 滑块，其行为类似于旧的 System.Windows.Forms.TrackBar。也就是说，我想要一个从 X 到 Y 的滑块，但只允许用户在离散的整数位置移动它。

由于 Slider 上的 Value 属性是双倍的，如何在 WPF 中执行此操作？

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2008-10-06T02:10:02.823

简单的答案是您利用**IsSnapToTickEnabled**和**TickFrequency**属性。也就是说，打开捕捉到刻度并将刻度频率设置为 1。

或者，换句话说......利用滴答声......但您不一定要显示您正在捕捉的滴答声。

查看以下 xaml：

```
<Slider
    Orientation="Vertical"
    Height="200"
    Minimum="0"
    Maximum="10"
    Value="0"
    IsSnapToTickEnabled="True"
    TickFrequency="1"
/> 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2008-10-06T02:10:51.293

如果您以正确的方式设置刻度线，则可以使用**IsSnapToTickEnabled**。这对我来说效果很好。有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.slider.aspx)。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2011-08-14T15:04:19.130

对于那些想要捕捉到*特定*位置的人，您还可以使用以下`Ticks`属性：

```
<Slider Minimum="1" Maximum="500" IsSnapToTickEnabled="True" Ticks="1,100,200,350,500" /> 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-12-19T23:36:49.847

snap 技巧很方便，但也有局限性，例如，如果您只想显示有效报价的子集。我已经通过两种选择取得了成功：绑定到整数或舍入新值。这是一个组合示例：

```
public int MyProperty { get; set; }

private void slider1_ValueChanged(object sender,
    RoutedPropertyChangedEventArgs<double> e)
{
    (sender as Slider).Value = Math.Round(e.NewValue, 0);
}

<Slider
    Name="slider1"
    TickPlacement="TopLeft"
    AutoToolTipPlacement="BottomRight"
    ValueChanged="slider1_ValueChanged"
    Value="{Binding MyProperty}"
    Minimum="0" Maximum="100" SmallChange="1" LargeChange="10"
    Ticks="0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100"/> 
```

我不知道两者的性能与快速技巧相比如何，但我没有遇到任何麻烦*。

*如果您*还将*滑块的值绑定到一种类型的文本字段，您将体验到，每隔一段时间，如果使用鼠标，文本字段将显示小数。如果您同时绑定到一个 int，则空字符串将导致引发转换异常，从而短暂地阻塞 UI。这些问题还不够严重，我无法寻找解决方案。

# java - 为什么 log4j 不能生成备份文件？

> ID：173017
> 
> 赞同：1
> 
> 时间：2008-10-06T02:04:54.267
> 
> 标签：java, windows, logging, log4j

我在 Windows 2003 服务器 R2 上运行一些 java 进程，我使用的是 Apache log4j-1.2.8。我的所有进程都通过一个具有不同参数示例的 jar 文件调用

```
 java -jar process.jar one 
    java -jar process.jar two
    java -jar process.jar three 
```

我配置 log4j.properties 跟随

```
#=============================== 
# Declare Variables
#===============================
logpath=${user.dir}/log/
simple_pattern=%d{yyyy-MM-dd HH:mm:ss.SSS}%-5x - %m%n
backup_pattern='.'yyyy-MM-dd

#===============================
# PROCESS & STANDARD OUTPUT
#===============================
log4j.logger.process.Process=NULL,proclog,procstdout
log4j.appender.proclog=org.apache.log4j.DailyRollingFileAppender
log4j.appender.proclog.File=${logpath}process.log
log4j.appender.proclog.DatePattern=${backup_pattern}
log4j.appender.proclog.layout=org.apache.log4j.PatternLayout
log4j.appender.proclog.layout.conversionPattern=${simple_pattern}

log4j.appender.procstdout=org.apache.log4j.ConsoleAppender
log4j.appender.procstdout.layout=org.apache.log4j.PatternLayout
log4j.appender.procstdout.layout.ConversionPattern=${simple_pattern}

#===============================
# ONE
#===============================
log4j.logger.process.log.One=NULL,one
log4j.appender.one=org.apache.log4j.DailyRollingFileAppender
log4j.appender.one.File=${logpath}one.log
log4j.appender.one.DatePattern=${backup_pattern}
log4j.appender.one.layout=org.apache.log4j.PatternLayout
log4j.appender.one.layout.conversionPattern=${simple_pattern}

#===============================
# TWO
#===============================
log4j.logger.process.log.Two=NULL,two
log4j.appender.two=org.apache.log4j.DailyRollingFileAppender
log4j.appender.two.File=${logpath}two.log
log4j.appender.two.DatePattern=${backup_pattern}
log4j.appender.two.layout=org.apache.log4j.PatternLayout
log4j.appender.two.layout.conversionPattern=${simple_pattern}

#===============================
# THREE
#===============================
log4j.logger.process.log.Three=NULL,three
log4j.appender.three=org.apache.log4j.DailyRollingFileAppender
log4j.appender.three.File=${logpath}three.log
log4j.appender.three.DatePattern=${backup_pattern}
log4j.appender.three.layout=org.apache.log4j.PatternLayout
log4j.appender.three.layout.conversionPattern=${simple_pattern} 
```

我第一次使用进程附加程序是单个记录器，现在我将它分成一个、两个和三个记录器。我的 Windows 进程每 1 分钟执行一次。

**所以。我遇到了大问题，我不知道为什么 log4j 无法生成备份文件。但是当我通过命令行执行手动时就可以了。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T02:25:51.637

当调度程序执行时，您的 log4j.properties 文件是否在类路径中？我过去也遇到过类似的问题，这是由于配置文件不在类路径中。

你可以将它包含在你的 process.jar 文件中，或者像这样指定它的位置：

> java -Dlog4j.configuration=file:///path/to/log4j.properties -jar process.jar 一

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T07:26:15.930

根据 javadocs，附加应该是默认设置，但值得在配置文件中指定它以消除歧义。运气好的话，它可能会解决你的问题

```
log4j.appender.three.Append=true 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-06T02:48:54.257

**非常感谢，我会再试一次你的解决方案。**

现在我的日程安排通过 bgprocess.bat 执行我的流程

**bgprocess.bat**

```
@echo off
set CLASSPATH=.;%CLASSPATH%
set path=C:\j2sdk1.4.2\bin;%path%
javaw -jar process.jar %1 
```

**process.jar manifest.mf**

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.6.2
Created-By: 1.4.2 (IBM Corporation)
Main-Class: process.Process
Class-Path: ./lib/Utility.jar ./lib/DB2LibRAD.jar ./lib/rowset.jar ./l
 ib/log4j-1.2.8.jar ./lib/com.ibm.mq.jar . 
```

**进程目录**

```
 - process.jar
   - bgprocess.bat
   - lib <dir>
               - log4j-1.2.8.jar
               - com.ibm.mq.jar
               - connector.jar
               - DB2LibRAD.jar
               - rowset.jar
               - Utility.jar                    
   - log <dir>
               - one.log
               - two.log
               - three.log
               - process.log 
```

并且所有日志文件正常工作，但是当经过备份时间时，它将**被截断**并在第一行开始新日志。

# java - 用于 IntelliJ IDEA 的类似 Ghostdoc 的插件

> ID：173018
> 
> 赞同：7
> 
> 时间：2008-10-06T02:05:23.597
> 
> 标签：java, automation, javadoc, ghostdoc

我晚年变得懒惰。对于我的 C# 工作，我非常依赖 Roland Weigelt 的 Visual Studio 优秀[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)插件。

有人知道 IntelliJ IDEA 中有类似的 Java 插件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T11:44:25.860

内置的 javadoc 补全完成了其中的一些工作 - 如果您键入 /** 并按下它，则将参数和返回类型放入骨架 javadoc。

与 Ghostdoc 不太一样，但方法名称上的 -q 会显示其 javadoc，并带有指向相关超类型文档的链接（如果适用）。

我想您已经查看了[插件存储库](http://plugins.intellij.net/)。

# web-applications - 谁能想到一些充分的理由*不*使用面向对象的 DBMS 来支持网站？

> ID：173040
> 
> 赞同：10
> 
> 时间：2008-10-06T02:18:36.067
> 
> 标签：web-applications, db4o, object-oriented-database

假设您正在编写某种 Web 应用程序。人们可以贡献内容的地方，例如一个简单的照片共享网站。

您能想到多少*不*使用面向对象数据库（例如 db4o）的充分理由？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T02:42:41.353

如果您只需要通过对象访问数据，则 OODBMS 会更好。如果您的解决方案需要额外的数据路径（例如，即席查询、报告、其他需要数据访问但不能使用您的对象的应用程序），那么传统的 RDBMS 系统会更好。

注意：OODBMS 在这方面做了很多改进。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T03:06:55.297

我不知道您的计划有多大，但是是否有经验丰富的技术人员可以雇用（或只是帮忙）会影响我的决定，以及关于所有插件的大量知识和数据库外。

Oracle 或 MySQL 有其缺陷，但如果您遇到问题，则很有可能有 100 个人有同样的问题，并且可以告诉您如何解决它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T04:04:38.160

我想说的是，如果您正在考虑类似 db4o 的东西，它们似乎没有为网站提供动力的企业示例，并且主要用于嵌入式应用程序。

请参阅我的另一篇文章。（[使用 db4o 的示例网站](https://stackoverflow.com/questions/171892/example-websites-using-db4o/172956#172956)）

这里没有技术上的障碍，似乎只是采用。然而，就开发速度、维护和设计灵活性而言，OODB 是无与伦比的。

如果需要，可以通过与关系后端同步来完成繁重的报告等，我知道 db4o 支持

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T03:17:00.863

这有点牵强，但套用 Joel 的帖子，为成功做好计划。如果您的应用程序变得非常流行怎么办？

例如，如果您在自己的机器上托管应用程序，但决定转到正式的托管站点，甚至是服务器场，该怎么办。他们支持 OODB 与 MySQL 的可能性有多大？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T02:23:51.920

如果您的应用程序设计非常非常非常面向对象，并且复杂性提出了对它的需求，我只会推荐使用 OODBMS。照片共享站点在 OO 方面听起来并不重，所以我看不出选择 db4o 的意义。

但是，如果您真的只是想从一个宠物项目中了解使用 OODBMS 的细节，那么使用它就可以了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T03:00:30.303

另一个很好的理由是相对长寿。db40 是一款出色的产品，但它的用户群很小，而且它的寿命不太可能比 SQL Server 之类的东西长。

当然，我也曾经说过 Java 无法生存。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T03:13:50.260

数据大小（如果我要处理数百万行，我会坚持我所知道的）

报告（在规范化数据库中通常足够困难，在 OO 数据库中更糟）

专业知识/经验的可用性（RDBMS 显然有更多的追随者）

大量 ETL（大多数人在平面文件中导入和导出，除非您正在获取/发送 XML，否则您说的是普通的旧表）

这些听起来都不是您项目的障碍

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T04:23:45.300

我个人的看法，哪里有数据……哪里有报告。

没有 OODB 会为您的数据提供适当的存储模型以供您的报告应用程序使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T04:23:55.297

当你只有一辆脚踏车时，你需要速度。场景包括数据捕获（例如日志记录），在事件发生后，捕获的数据通常在稍后阶段进行处理，并且无论如何都可能分解为其对象组成部分。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-13T07:50:26.583

也许你们也想查看这篇文章：

[http://microsoft.apress.com/asptodayarchive/74063/using-an-object-oriented-d](https://web.archive.org/web/20081021042606/http://microsoft.apress.com/asptodayarchive/74063/using-an-object-oriented-d)

Jim Paterson 的“在网站中使用 OODB”

最好的！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-07T01:17:13.577

对于具有适度数据需求的复杂应用程序，您无法击败 GLASS（Gemstone、Seaside 和 Smalltalk）。报告绝对是您想要在 Smalltalk 中做 OO 的事情。

# sql - 不存在与不存在

> ID：173041
> 
> 赞同：585
> 
> 时间：2008-10-06T02:19:05.033
> 
> 标签：sql, sql-server, notin

这些查询中哪个更快？

不存在：

```
SELECT ProductID, ProductName 
FROM Northwind..Products p
WHERE NOT EXISTS (
    SELECT 1 
    FROM Northwind..[Order Details] od 
    WHERE p.ProductId = od.ProductId) 
```

或不在：

```
SELECT ProductID, ProductName 
FROM Northwind..Products p
WHERE p.ProductID NOT IN (
    SELECT ProductID 
    FROM Northwind..[Order Details]) 
```

查询执行计划说他们都做同样的事情。如果是这样，推荐的形式是什么？

这是基于 NorthWind 数据库的。

[编辑]

刚刚发现这篇有用的文章： [http ://weblogs.sqlteam.com/mladenp/archive/2007/05/18/60210.aspx](http://weblogs.sqlteam.com/mladenp/archive/2007/05/18/60210.aspx)

我想我会坚持不存在。

* * *

## 回答 #1

> 赞同：746
> 
> 时间：2012-06-17T20:10:17.887

我总是默认为`NOT EXISTS`.

目前执行计划可能是相同的，但是如果将来更改任一列以允许`NULL`s`NOT IN`版本将需要做更多的工作（即使`NULL`数据中实际上不存在 s ）以及`NOT IN`if `NULL`s*的*语义存在无论如何都不太可能是你想要的。

当 none`Products.ProductID`或`[Order Details].ProductID`allow时`NULL`，`NOT IN`将被视为与以下查询相同。

```
SELECT ProductID,
       ProductName
FROM   Products p
WHERE  NOT EXISTS (SELECT *
                   FROM   [Order Details] od
                   WHERE  p.ProductId = od.ProductId) 
```

确切的计划可能会有所不同，但对于我的示例数据，我得到以下信息。

![都不是 NULL](https://i.stack.imgur.com/lCTsG.png)

一个相当普遍的误解似乎是，与连接相比，相关子查询总是“坏”的。当他们强制执行嵌套循环计划（逐行评估子查询）时，它们当然可以，但该计划包括反半连接逻辑运算符。反半连接不限于嵌套循环，也可以使用散列或合并（如本例所示）连接。

```
/*Not valid syntax but better reflects the plan*/ 
SELECT p.ProductID,
       p.ProductName
FROM   Products p
       LEFT ANTI SEMI JOIN [Order Details] od
         ON p.ProductId = od.ProductId 
```

如果`[Order Details].ProductID`is `NULL`-able 则查询变为

```
SELECT ProductID,
       ProductName
FROM   Products p
WHERE  NOT EXISTS (SELECT *
                   FROM   [Order Details] od
                   WHERE  p.ProductId = od.ProductId)
       AND NOT EXISTS (SELECT *
                       FROM   [Order Details]
                       WHERE  ProductId IS NULL) 
```

这样做的原因是正确的语义 if `[Order Details]`contains any `NULL` `ProductId`s 是不返回任何结果。请参阅额外的反半联接和行计数假脱机以验证已添加到计划中。

![一空](https://i.stack.imgur.com/mPYhd.png)

如果`Products.ProductID`也更改为`NULL`-able 查询则变为

```
SELECT ProductID,
       ProductName
FROM   Products p
WHERE  NOT EXISTS (SELECT *
                   FROM   [Order Details] od
                   WHERE  p.ProductId = od.ProductId)
       AND NOT EXISTS (SELECT *
                       FROM   [Order Details]
                       WHERE  ProductId IS NULL)
       AND NOT EXISTS (SELECT *
                       FROM   (SELECT TOP 1 *
                               FROM   [Order Details]) S
                       WHERE  p.ProductID IS NULL) 
```

这样做的原因是，**除非**子查询根本不返回任何结果（即表为空） ，否则`NULL` `Products.ProductId`不应在结果中返回a。在这种情况下应该。在我的示例数据计划中，这是通过添加另一个反半连接来实现的，如下所示。**`NOT IN``[Order Details]`**

 **![两者都为空](https://i.stack.imgur.com/8XAh1.png)

[Buckley 已经链接的博客文章](http://sqlinthewild.co.za/index.php/2010/02/18/not-exists-vs-not-in/)中显示了这种效果。在该示例中，逻辑读取的数量从大约 400 增加到 500,000。

此外，单个`NULL`可以将行数减少到零的事实使得基数估计非常困难。如果 SQL Server 假设这会发生，但实际上`NULL`数据中没有行，那么执行计划的其余部分可能会更糟，如果这只是较大查询的一部分，[不适当的嵌套循环会导致重复执行昂贵的子以树为例](https://dba.stackexchange.com/q/117306/3690)。

`NOT IN`然而，这并不是 a on a `NULL`-able 列唯一可能的执行计划。[本文展示了另一个](http://bradsruminations.blogspot.co.uk/2011/10/t-sql-tuesday-023-flip-side-of-join.html)针对`AdventureWorks2008`数据库的查询。

对于`NOT IN`on`NOT NULL`列或`NOT EXISTS`针对可为 null 或不可为 null 的列，它提供以下计划。

![不存在](https://i.stack.imgur.com/nahUD.png)

当列更改为`NULL`-able 时，`NOT IN`计划现在看起来像

![不在 - 空](https://i.stack.imgur.com/8o9PQ.png)

它在计划中添加了一个额外的内部连接运算符。这个装置[在这里解释](https://dba.stackexchange.com/a/14812/3690)。所有这些都可以将先前的单个相关索引搜索转换为`Sales.SalesOrderDetail.ProductID = <correlated_product_id>`每外行两次搜索。额外的一个是 on `WHERE Sales.SalesOrderDetail.ProductID IS NULL`。

由于这是一个反半连接，如果该连接返回任何行，则不会发生第二次搜索。但是，如果`Sales.SalesOrderDetail`不包含任何`NULL` `ProductID`s ，它将使所需的查找操作数加倍。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2012-05-09T12:23:38.247

另请注意，当涉及到 null 时，NOT IN 不等于 NOT EXISTS。

这个帖子解释的很好

[http://sqlinthewild.co.za/index.php/2010/02/18/not-exists-vs-not-in/](http://sqlinthewild.co.za/index.php/2010/02/18/not-exists-vs-not-in/)

> 当子查询返回一个空值时，NOT IN 将不匹配任何行。
> 
> 可以通过查看 NOT IN 操作实际含义的详细信息来找到其原因。
> 
> 假设为了说明的目的，表中有 4 行称为 t，有一个称为 ID 的列，其值为 1..4
> 
> ```
> WHERE SomeValue NOT IN (SELECT AVal FROM t) 
> ```
> 
> 相当于
> 
> ```
> WHERE SomeValue != (SELECT AVal FROM t WHERE ID=1)
> AND SomeValue != (SELECT AVal FROM t WHERE ID=2)
> AND SomeValue != (SELECT AVal FROM t WHERE ID=3)
> AND SomeValue != (SELECT AVal FROM t WHERE ID=4) 
> ```
> 
> 让我们进一步说 AVal 为 NULL，其中 ID = 4。因此 != 比较返回 UNKNOWN。AND 的逻辑真值表表明 UNKNOWN 和 TRUE 是 UNKNOWN，UNKNOWN 和 FALSE 是 FALSE。没有任何值可以与 UNKNOWN 进行 AND 运算以产生结果 TRUE
> 
> 因此，如果该子查询的任何行返回 NULL，则整个 NOT IN 运算符将评估为 FALSE 或 NULL，并且不会返回任何记录

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-06T02:21:46.137

如果执行计划者说它们是相同的，那么它们是相同的。使用任何一个会让你的意图更明显——在这种情况下，是第二个。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-10-06T02:40:33.120

实际上，我相信这将是最快的：

```
SELECT ProductID, ProductName 
    FROM Northwind..Products p  
          outer join Northwind..[Order Details] od on p.ProductId = od.ProductId)
WHERE od.ProductId is null 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-07-07T17:12:53.127

我有一个包含大约 120,000 条记录的表，只需要选择其他四个表中不存在的那些（与 varchar 列匹配），行数约为 1500、4000、40000、200。所有涉及的表都有唯一索引在相关`Varchar`栏目上。

`NOT IN`花了大约10分钟，`NOT EXISTS`花了4秒。

我有一个递归查询，它可能有一些未调整的部分，这可能有助于 10 分钟，但另一个选项需要 4 秒解释，至少对我来说，这`NOT EXISTS`要好得多，或者至少是这样`IN`，并且`EXISTS`不完全相同并且总是值得一试在继续代码之前检查。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-06T02:54:46.930

在您的具体示例中，它们是相同的，因为优化器已经确定您要尝试做的事情在两个示例中都是相同的。但有可能在非平凡的例子中优化器可能不会这样做，在这种情况下，有时有理由选择一个而不是另一个。

`NOT IN`如果您在外部选择中测试多行，则应该首选。可以在执行开始时评估语句中的子查询，并且可以根据外部选择中的每个值检查临时表，而不是像语句`NOT IN`所要求的那样每次都重新运行子选择。`NOT EXISTS`

如果子查询*必须*与外部选择相关联，那么`NOT EXISTS`可能更可取，因为优化器可能会发现一种简化，阻止创建任何临时表来执行相同的功能。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-06-13T15:02:31.620

我正在使用

```
SELECT * from TABLE1 WHERE Col1 NOT IN (SELECT Col1 FROM TABLE2) 
```

并发现它给出了错误的结果（错误的意思是没有结果）。因为 TABLE2.Col1 中有一个 NULL。

将查询更改为

```
SELECT * from TABLE1 T1 WHERE NOT EXISTS (SELECT Col1 FROM TABLE2 T2 WHERE T1.Col1 = T2.Col2) 
```

给了我正确的结果。

从那时起，我开始在每个地方都使用 NOT EXISTS。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-03-19T08:27:30.717

它们非常相似，但并不完全相同。

在效率方面，我发现**left join is null**语句更有效（当要选择大量行时）

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-01-28T10:27:43.583

## 数据库表模型

假设我们的数据库中有以下两个表，它们形成了一对多的表关系。

[![SQL EXISTS 表](https://i.stack.imgur.com/uD3tb.png)](https://i.stack.imgur.com/uD3tb.png)

该`student`表是父表，而`student_grade`是子表，因为它有一个 student_id 外键列引用学生表中的 id 主键列。

包含以下`student table`两条记录：

```
| id | first_name | last_name | admission_score |
|----|------------|-----------|-----------------|
| 1  | Alice      | Smith     | 8.95            |
| 2  | Bob        | Johnson   | 8.75            | 
```

并且，该`student_grade`表存储了学生获得的成绩：

```
| id | class_name | grade | student_id |
|----|------------|-------|------------|
| 1  | Math       | 10    | 1          |
| 2  | Math       | 9.5   | 1          |
| 3  | Math       | 9.75  | 1          |
| 4  | Science    | 9.5   | 1          |
| 5  | Science    | 9     | 1          |
| 6  | Science    | 9.25  | 1          |
| 7  | Math       | 8.5   | 2          |
| 8  | Math       | 9.5   | 2          |
| 9  | Math       | 9     | 2          |
| 10 | Science    | 10    | 2          |
| 11 | Science    | 9.4   | 2          | 
```

## SQL 存在

假设我们想让所有在数学课上获得 10 分的学生。

如果我们只对学生标识符感兴趣，那么我们可以运行如下查询：

```
SELECT
    student_grade.student_id
FROM
    student_grade
WHERE
    student_grade.grade = 10 AND
    student_grade.class_name = 'Math'
ORDER BY
    student_grade.student_id 
```

但是，应用程序有兴趣显示 a 的全名`student`，而不仅仅是标识符，因此我们还需要`student`表中的信息。

为了过滤`student`数学中分数为 10 的记录，我们可以使用 EXISTS SQL 运算符，如下所示：

```
SELECT
    id, first_name, last_name
FROM
    student
WHERE EXISTS (
    SELECT 1
    FROM
        student_grade
    WHERE
        student_grade.student_id = student.id AND
        student_grade.grade = 10 AND
        student_grade.class_name = 'Math'
)
ORDER BY id 
```

运行上面的查询时，我们可以看到只选择了 Alice 行：

```
| id | first_name | last_name |
|----|------------|-----------|
| 1  | Alice      | Smith     | 
```

外部查询选择`student`我们有兴趣返回给客户端的行列。但是，WHERE 子句将 EXISTS 运算符与关联的内部子查询一起使用。

如果子查询返回至少一条记录，则 EXISTS 运算符返回 true，如果未选择任何行，则返回 false。数据库引擎不必完全运行子查询。如果匹配单个记录，则 EXISTS 运算符返回 true，并选择关联的其他查询行。

内部子查询是相关的，因为表的 student_id 列`student_grade`与外部学生表的 id 列匹配。

## SQL 不存在

假设我们要选择所有成绩不低于 9 的学生。为此，我们可以使用 NOT EXISTS，它否定 EXISTS 运算符的逻辑。

因此，如果底层子查询没有返回记录，NOT EXISTS 运算符将返回 true。但是，如果单个记录被内部子查询匹配，NOT EXISTS 运算符将返回 false，并且可以停止子查询执行。

要将所有没有关联 student_grade 的学生记录与小于 9 的值匹配，我们可以运行以下 SQL 查询：

```
SELECT
    id, first_name, last_name
FROM
    student
WHERE NOT EXISTS (
    SELECT 1
    FROM
        student_grade
    WHERE
        student_grade.student_id = student.id AND
        student_grade.grade < 9
)
ORDER BY id 
```

运行上面的查询时，我们可以看到只有 Alice 记录匹配：

```
| id | first_name | last_name |
|----|------------|-----------|
| 1  | Alice      | Smith     | 
```

因此，使用 SQL EXISTS 和 NOT EXISTS 运算符的优点是，只要找到匹配的记录，就可以停止内部子查询的执行。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-06T07:57:08.677

如果优化器说它们是相同的，那么请考虑人为因素。我更喜欢看不存在:)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-10-06T02:32:34.087

这取决于..

```
SELECT x.col
FROM big_table x
WHERE x.key IN( SELECT key FROM really_big_table ); 
```

不会相对较慢，限制查询检查的大小以查看它们是否在其中。 EXISTS 在这种情况下会更可取。

但是，根据 DBMS 的优化器，这可能没有什么不同。

作为 EXISTS 何时更好的示例

```
SELECT x.col
FROM big_table x
WHERE EXISTS( SELECT key FROM really_big_table WHERE key = x.key);
  AND id = very_limiting_criteria 
```

# javascript - 有一个简单的 JavaScript 滑块吗？

> ID：173046
> 
> 赞同：43
> 
> 时间：2008-10-06T02:21:56.980
> 
> 标签：javascript, slider, controls, wmp

我需要为 WMP 对象创建一个自定义音量滑块。当前滑块的修改和使用很复杂，是否有一种简单的方法可以在 HTML 页面上生成滑块，可以将其值传递给 javascript 函数？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2011-12-05T12:38:28.633

嘿，我刚刚创建了自己的 JS 滑块，因为我已经受够了沉重的 Jquery UI 滑块。有兴趣听听人们的想法。已经玩了 5 个小时，所以真的很早。

[jsfiddle_slider](http://jsfiddle.net/LucP/BPdKR/2/)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-06T02:24:26.193

[jQuery UI 滑块](http://jqueryui.com/demos/slider/)（[API 文档](http://docs.jquery.com/UI/Slider)）

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-06T11:07:24.000

带有[Webforms 2的](http://www.whatwg.org/specs/web-forms/current-work/)[HTML 5](http://www.whatwg.org/specs/web-apps/current-work/)提供了一个`<input type="range">`可以让浏览器为您生成本机滑块的功能。不幸的是，并非所有浏览器都支持此功能，但是[google](http://code.google.com/p/webforms2/)已经使用 js 实现了所有 Webforms 2 控件。IIRC js 足够智能，可以知道浏览器是否实现了控件，并且只有在没有原生实现时才会触发。

从我的角度来看，尽可能使用浏览器原生控件应该被认为是最佳实践。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-02-01T10:27:22.827

一个简单的滑块：我刚刚在**纯 HTML5**中测试过这个，**非常简单**！

```
<input type="range"> 
```

它在 Chrome 上就像一个魅力。我还没有测试过其他浏览器。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-04-07T22:46:39.663

这是另一个似乎适合您需求的轻量级[JavaScript 滑块。](http://blog.ovidiu.ch/javascript-slider)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-06T10:38:46.603

[Yahoo UI 库](http://developer.yahoo.com/yui/)也有一个[滑块控件](http://developer.yahoo.com/yui/examples/slider/slider-ticks.html)...

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-06T03:02:12.280

script.aculo.us 有一个[滑块控件](http://github.com/madrobby/scriptaculous/wikis/slider)，可能值得一试。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-06T03:40:55.540

轻量级的 MooTools 框架有一个：[http ://demos.mootools.net/Slider](http://demos.mootools.net/Slider)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-11-02T05:31:26.717

我推荐Filament Group的Slider，它有很好的用户体验

[http://www.filamentgroup.com/lab/update_jquery_ui_slider_from_a_select_element_now_with_aria_support/](http://www.filamentgroup.com/lab/update_jquery_ui_slider_from_a_select_element_now_with_aria_support/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-06-25T18:50:45.350

有一个不错的 javascript 滑块，它很容易实现。您可以在此处下载 zip 包：[http ://ruwix.com/javascript-volume-slider-control/](http://ruwix.com/javascript-volume-slider-control/)

ps这里是上述脚本的简化版本：

![在此处输入图像描述](https://i.stack.imgur.com/lVDzF.png)

[**演示链接**](http://codepen.io/tazotodua/debug/wnDjq)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-12-11T14:53:00.577

这是一个简单的滑块对象，易于使用

[pagecolumn_webparts_sliders](http://www.pagecolumn.com/webparts/sliders.htm)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-03-30T17:03:08.627

Carpe Slider 也有更新的版本：
v1.5 [carpe_ambiprospect_slider](http://carpe.ambiprospect.com/slider/) v2.0b ...slider/drafts/v2.0/

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-04-30T21:51:13.087

下面的代码应该足以让您入门。在 Opera、IE 和 Chrome 中测试。

```
<script>
var l=0;
function f(i){
im = 'i' + l;
d=document.all[im];
d.height=99;
document.all.f1.t1.value=i;
im = 'i' + i;
d=document.all[im];
d.height=1;
l=i;
}
</script>
<center>
<form id='f1'>
<input type=text value=0 id='t1'>
</form>
<script>
for (i=0;i<=50;i++)
 {
 s = "<img src='j.jpg' height=99 width=9 onMouseOver='f(" + i + ")' id='i" + i + "'>";
 document.write(s);
 }
</script> 
```

# parameterized - 参数化的jsp：包括条纹动作？

> ID：173056
> 
> 赞同：1
> 
> 时间：2008-10-06T02:29:16.387
> 
> 标签：parameterized, stripes, jspinclude

我一直在努力解决这个问题，并且一直被卡住，所以我想我会问。

想象两个 ActionBean，A 和 B。

`A.jsp`里面有这个部分：

```
...
<jsp:include page="/B.action">
  <jsp:param name="ponies" value="on"/>
</jsp:include>
<jsp:include page="/B.action">
  <jsp:param name="ponies" value="off"/>
</jsp:include>
... 
```

根据“ponies”参数是否设置为打开或关闭，B ActionBean 会做一些非常有趣的事情。

当您调试请求时，参数字符串“ponies=on”*是*可见的，但这不是绑定到 B ActionBean 中的内容。相反，绑定的是原始 A.action 的参数。

有什么方法可以得到我想要的行为，还是我错过了一些基本的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T05:59:36.337

那么您是说`${ponies}`在您的 JSP 页面上的每种情况下都打印出“on”吗？

因为听起来您将 JSP 参数与 Stripes 操作 bean 混淆了。设置 JSP 参数只是在该 JSP 页面上设置一个参数，您可以如上所示引用该参数，它实际上并没有在条纹动作 bean 上设置任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T21:33:36.133

这不起作用的原因是我们的`HttpServletRequest`.

它适用于“正常”实现。

# php - 有人写过很长很复杂的 PHP 应用程序吗？

> ID：173057
> 
> 赞同：2
> 
> 时间：2008-10-06T02:31:49.253
> 
> 标签：php

我很难想象一个超过几百行代码的 php 脚本。看起来，对于非持久性环境，基于 Web 的脚本通常是小块完成的，用于将网站的一部分交付给最终用户。我想知道人们是否正在使用 php 开发任何类型的大型、持久性或复杂的应用程序，以及您正在做什么。我只为小型网站做过小项目，所以我不知道在更大的范围内可以完成什么。知道您正在使用哪些库以及您正在集成哪些其他技术也会很高兴。请启发我，这样我就可以开始梦想更大的事情了！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T02:45:00.177

我会看一些使用 PHP 的著名开源 Web 应用程序，以很好地了解可以完成什么，以及如何在每个应用程序中使用 PHP。优点是，由于它们都是开源的，因此您实际上可以查看 PHP 代码以了解各种功能是如何实现的。

一些很好的例子包括：

*   [WordPress](http://www.wordpress.org/)
*   [文本模式](http://www.textpattern.com)
*   [媒体维基](http://www.mediawiki.org/)
*   [PhpBB](http://www.phpbb.com) *有问题的代码质量
*   [糖CRM](http://www.sugarcrm.com/)
*   [Joomla](http://www.joomla.org)
*   [德鲁巴](http://www.drupal.org/)

还可以查看一些流行的框架，看看它们提供了什么样的功能（这应该让您很好地了解 PHP 最常用于哪些类型的事情）：

*   [Zend 框架](http://framework.zend.com)
*   [CakePHP](http://www.cakephp.org)
*   [代码点火器](http://www.codeigniter.com)
*   [Symfony](http://www.symfony-project.org)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T04:02:28.040

对于我的日常工作，我们在 PHP 中运行所有东西——我们的前端网站、代理和员工的后端、库存、服务器控制界面等。这些都是从漂亮的新的支持 AJAX 的 Zend 框架应用程序到我们拥有的遗留代码的一切还没移植。除此之外，我们还使用[Mantis](http://www.mantisbt.org/)（内置在 PHP 中的错误跟踪）、[Mediawiki](http://www.mediawiki.org/wiki/MediaWiki)和[phpMyAdmin](http://www.phpmyadmin.net/home_page/index.php)之类的东西。

唯一不是 PHP 的是供应商应用程序，因为供应商喜欢 Java。我们拥有的一个 ASP.NET 应用程序实际上在项目期间被供应商放弃了（并不是对 ASP.NET 的真正打击，该应用程序只是一个失控项目的完美定义，无论它用什么语言编写都会失败）。

[借助Zend Framework](http://framework.zend.com/)、[CodeIgnitor](http://codeigniter.com/)和[CakePHP](http://cakephp.org/)等成熟的框架，用 PHP 创建几乎任何东西都是可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T04:10:49.863

开发大型程序的最大问题肯定是保持它们的长期可维护性。最初，一个程序一开始就充满了理想的方法和想法，但在我看来，保持完整性，尤其是随着时间的推移，往往会失败。

此外，范围蔓延是您的敌人。你必须尽快控制它。

就大型项目而言，我工作的公司有一些内部项目正在不断开发中。一个例子是我们的专有网站引擎。这是一个非常大的代码库，包括十几个模块（用户管理、调查系统、博客、用户画廊等），使我们能够快速构建我们的客户网站。

我们还开发了我们自己的内部项目管理程序来管理我们的客户工作。

从长远来看，您绝对应该考虑规模。在我参与过的几乎每个项目中，都有一个供相关用户使用的权限/组元素。您可能想开始考虑其中涉及的可能性和问题，并着手处理更复杂的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T04:33:37.353

我的公司致力于教育软件。我们最近开始进行基于 Web 的内容交付，包括视频和音频，后端完全使用 MySQL 用 PHP 编写。我们有两个主要的应用程序，一个存在于我们的服务器上，一个是交付给客户的。一个时钟输入约 42,000 行代码（使用物理行数），一个时钟输入约 68,000 行代码。

我们广泛使用[PEAR](http://pear.php.net/)，最近开始的一个项目正在使用[Zend 框架](http://framework.zend.com/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T02:34:35.957

[MediaWiki](http://www.mediawiki.org/wiki/MediaWiki)是最大的公共 PHP 应用程序之一，它的代码非常好。. 我知道一些更大的，但它们非常糟糕，阅读它们你什么也学不到。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T02:37:25.043

有**很多**复杂的开源 php 应用程序。例如，Drupal CMS，它本身可以被认为是一个用于开发其他网站的平台。

您可以在线浏览源代码：http: [//cvs.drupal.org/viewvc.py/drupal/drupal/](http://cvs.drupal.org/viewvc.py/drupal/drupal/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T02:48:40.810

为 Wilco +1
我有一个软件供我的一些客户使用，它是一个 CMS、博客、电子商务野兽，代码库非常庞大，但一切都很好地相互配合。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-24T06:23:08.197

我们在我们公司使用 PHP。（我们做在线语言学习：[http](http://www.livemocha.com) ://www.livemocha.com 。你应该去看看这个网站。是的，这是一个无耻的插件，但它也很热门。:-)）

我不能给你确切的用户数量，但我们不久前发布了一份新闻稿，庆祝达到 300 万大关。随着网络应用的发展，这是一个相当大的规模。

我们建立在 CakePHP 框架上，该框架基于 MVC 架构……至少在理论上是这样。在实践中，他们为模型自动生成某些方法，这些方法往往会导致将一些模型代码（缓存，决定使用哪个数据库）推送到控制器中。他们在 1.2 中还有一些本地化问题，这让我认为框架的这一部分还没有真正成熟。也就是说，我发现 CakePHP 总体上使用起来很舒服，如果你正在考虑用 PHP 实现一个大型 Web 应用程序，你至少应该看看它。它也有一些优秀的文档可用（谷歌“CakePHP bakery”）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-08T05:57:24.203

获取 CodeIgniter 并重建 Amazon 或 Ebay。如果你能梦想它，你可以用 PHP 构建它，但你可能无法维护它，因为很容易创建有效的坏代码。PHP.net 是你的朋友。无论您使用什么框架，请确保您阅读了用户指南并让它指导您。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-08-24T05:34:42.793

我不敢相信还没有人提到 MVC 模式。IMO，它是你可以用来帮助你维护大型代码库的最好的东西之一。

# javascript - 2.9999999999999999 >> .5？

> ID：173070
> 
> 赞同：13
> 
> 时间：2008-10-06T02:42:28.497
> 
> 标签：javascript, bit-manipulation, precision

我听说您可以将数字右移 0.5 而不是使用 Math.floor()。我决定检查它的限制以确保它是合适的替代品，因此我检查了以下值并在 Google Chrome 中得到以下结果：

```
 2.5 >> .5 == 2;
2.9999 >> .5 == 2;
2.999999999999999 >> .5 == 2;  // 15 9s
2.9999999999999999 >> .5 == 3;  // 16 9s 
```

经过一番摆弄，我发现在 Chrome 和 Firefox 中，当右移 0.5 时，将产生 2 的最大可能值为 2.9999999999999997779553950749686919152736663818359374999999¯（重复 9）。IE中的数字是2.9999999999999997779¯。

我的问题是：数字 .0000000000000007779553950749686919152736663818359374 的意义是什么？这是一个非常奇怪的数字，它真的激起了我的好奇心。

我一直在尝试找到答案或至少某种模式，但我认为我的问题在于我真的不了解按位运算。我原则上理解这个想法，但是将位序列移动 0.5 对我来说根本没有任何意义。任何帮助表示赞赏。

为了记录，奇怪的数字序列随着 2^x 的变化而变化。以下数字中仍能正确截断的最高可能值：

```
对于 0：0.9999999999999999444888487687421729788184165954589843749¯
对于 1：1.9999999999999999888977697537484345957636833190917968749¯
对于 2-3：x+.99999999999999977795539507496869191527366638183593749¯
对于 4-7：x+.9999999999999995559107901499373838305473327636718749¯
对于 8-15：x+.999999999999999111821580299874767661094665527343749¯
...等等

```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-10-06T03:25:52.543

实际上，您只是在第一个操作数上执行了 floor() ，而没有进行任何浮点运算。由于左移和右移按位运算仅对整数操作数有意义，因此 JavaScript 引擎首先将两个操作数转换为整数：

```
2.999999 >> 0.5 
```

变成：

```
Math.floor(2.999999) >> Math.floor(0.5) 
```

这又是：

```
2 >> 0 
```

移位 0 位意味着“不进行移位”，因此您最终会得到第一个操作数，只需将其截断为整数。

SpiderMonkey 源代码有：

```
switch (op) {
  case JSOP_LSH:
  case JSOP_RSH:
    if (!js_DoubleToECMAInt32(cx, d, &i)) // Same as Math.floor()
        return JS_FALSE;
    if (!js_DoubleToECMAInt32(cx, d2, &j)) // Same as Math.floor()
        return JS_FALSE;
    j &= 31;
    d = (op == JSOP_LSH) ? i << j : i >> j;
    break; 
```

您看到某些数字的“四舍五入”是由于 JavaScript 引擎无法处理超出特定精度的十进制数字，因此您的数字最终会四舍五入到下一个整数。在浏览器中试试这个：

```
alert(2.999999999999999); 
```

您将获得 2.999999999999999。现在尝试再添加一个 9：

```
alert(2.9999999999999999); 
```

你会得到一个3。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-06T02:51:55.780

这可能是我见过的最糟糕的想法。它存在的唯一可能目的是赢得混淆代码竞赛。您发布的长数字没有任何意义——它们是底层浮点实现的产物，经过天知道有多少中间层过滤。移位字节数是疯狂的，我很惊讶它没有引发异常——但那是 Javascript，总是愿意重新定义“疯狂”。

如果我是你，我会避免使用这个“功能”。它的唯一价值是作为异常错误条件的可能根本原因。使用`Math.floor()`并同情下一个将维护代码的程序员。

* * *

确认我在阅读问题时的一些怀疑：

*   将任何小数右移任意小数`x`只会`y`简单地截断 truncate ，给出与彻底混淆读者`x`相同的结果。`Math.floor()`
*   2.999999999999999777955395074968691915...只是可以与“3”区分开来的最大数字。尝试自己评估它——如果你添加任何东西，它会评估为 3。这是浏览器和本地系统浮点实现的产物。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T03:35:42.370

如果您想更深入，请阅读“每个计算机科学家都应该了解的关于浮点运算的知识”：[http ://docs.sun.com/source/806-3568/ncg_goldberg.html](http://docs.sun.com/source/806-3568/ncg_goldberg.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-06T02:53:08.150

我不认为你的右移是相关的。您只是超出了双精度浮点常量的分辨率。

在 Chrome 中：

```
var x = 2.999999999999999777955395074968691915273666381835937499999;
var y = 2.9999999999999997779553950749686919152736663818359375;

document.write("x=" + x);
document.write(" y=" + y); 
```

打印出来：x = 2.9999999999999996 y=3

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-06T02:53:57.303

试试这个javascript：alert(parseFloat("2.9999999999999997779553950749686919152736663818359374999999"));

然后试试这个： alert(parseFloat("2.9999999999999997779553950749686919152736663818359375"));

您所看到的是简单的浮点不准确性。有关这方面的更多信息，请参见例如：[http](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems) ://en.wikipedia.org/wiki/Floating_point#Accuracy_problems 。

基本问题是浮点值可以达到表示第二个数字的最接近值大于或等于 3，而浮点值可以达到第一个数字的接近值严格小于 3。

至于为什么右移 0.5 可以做任何事情，似乎 0.5 本身只是预先转换为 int (0)。然后像往常一样，原始浮点数（2.999 ...）通过截断转换为int。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-06T02:59:10.943

右移运算符仅对整数（两侧）进行操作。因此，右移 0.5 位应该完全等同于右移 0 位。并且，左侧在移位操作之前被转换为整数，这与 Math.floor() 的作用相同。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-10T14:28:29.293

我怀疑将 2.9999999999999997779553950749686919152736663818359374999999 转换为它的二进制表示会很有启发性。它可能与真正的 3 仅相差 1 位。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-30T11:10:41.047

> 我怀疑将 2.9999999999999997779553950749686919152736663818359374999999 转换为它的二进制表示会很有启发性。它可能与真正的 3 仅相差 1 位。

猜得好，但没有雪茄。由于双精度 FP 数有 53 位，因此 3 之前的最后一个 FP 数实际上是（精确）：2.999999999999999555910790149937383830547332763671875

但为什么是 2.9999999999999997779553950749686919152736663818359375

（这是准确的，不是 49999 ......！）

哪个*高于*最后一个可显示单元？四舍五入。转换例程（字符串到数字）简单地被正确编程以将输入四舍五入到下一个浮点数。

2.999999999999999555910790149937383830547332763671875

.......（介于之间的值，增加）->向下舍入

2.9999999999999997779553950749686919152736663818359375

.......（介于之间的值，增加）-> 向上取整到 3

3

转换输入必须使用全精度。如果数字恰好是这两个 fp 数字之间的一半（即 2.9999999999999997779553950749686919152736663818359375），则舍入取决于设置的标志。默认舍入为四舍五入到偶数，这意味着该数字将四舍五入到下一个偶数。

现在

3 = 11。（二进制）

2.999... = 10.11111111111...（二进制）

所有位均已设置，数字始终为奇数。这意味着精确的半数将被四舍五入，所以你得到了奇怪的.....49999 句号，因为它必须小于精确的一半才能与 3 区分开来。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-06T02:54:06.180

为了补充约翰的答案，这比 Math.floor 性能更高的可能性微乎其微。

我不知道 JavaScript 是使用浮点数还是某种无限精度库，但无论哪种方式，你都会在这样的操作中遇到舍入错误——即使它定义得很好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-15T23:33:05.133

应该注意的是，数字“.0000000000000007779553950749686919152736663818359374”很可能是[Epsilon](http://en.wikipedia.org/wiki/Machine_epsilon)，定义为“满足 (1+E) > 1 的最小数字 E”。

# actionscript - Flash/Actionscript2 - 无法触发组合框“更改”事件

> ID：173079
> 
> 赞同：1
> 
> 时间：2008-10-06T02:46:42.700
> 
> 标签：actionscript, components

我正在尝试将组合框组件用于 Flash。我无法触发更改事件。我的代码几乎直接来自 adobe 网站（链接如下）。该框已填充，但更改值不会产生跟踪输出。我究竟做错了什么？

[http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/js/html/wwhelp.htm?href=00002149.html#3138459](http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/js/html/wwhelp.htm?href=00002149.html#3138459)

```
myCombo.addItem("hi1", "hi5");
myCombo.addItem("h2", "hi6");
myCombo.addItem("hi3", "hi7");
myCombo.addItem("h4", "hi8");

var form = new Object();
form.change = function(eventObj){
   trace("Value changed to " + eventObj.target.value);
}

myCombo.addEventListener("change", form); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T03:17:30.113

我将您的代码粘贴到 AS2 项目中，它按预期工作。没有其他输出？尝试在 addEventListener 之前和之后添加跟踪以确保它被调用。尝试为您的对象使用除表单以外的名称。尝试在调试中运行它并在更改函数中设置断点。

# c# - 使用 Visual Studio 2008 的 2.0 中的 C# .NET 3.0/3.5 功能

> ID：173080
> 
> 赞同：13
> 
> 时间：2008-10-06T02:47:28.160
> 
> 标签：c#, .net, visual-studio

升级到 Visual Studio 2008 后，可以在 .NET 2.0 中使用哪些特定于 C# 3.0/3.5 的新功能？另外，有哪些不可用的功能？

**可用的**

*   拉姆达斯
*   扩展方法（通过声明一个空的 System.Runtime.CompilerServices.ExtensionAttribute）
*   自动属性
*   对象初始化器
*   集合初始化器
*   LINQ to Objects（通过实现 IEnumerable 扩展方法，请参阅[LinqBridge](http://www.albahari.com/nutshell/linqbridge.aspx)）

**无法使用**

*   表达式树
*   WPF/Silverlight 库

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-06T03:18:24.573

您可以通过发出 2.0 兼容的 IL 来使用编译器处理的任何新的 C# 3.0 功能，并且不引用任何新的 3.5 程序集：

*   Lambdas (用作`Func<..>`, not `Expression<Func<..>>`)
*   扩展方法（通过声明一个空`System.Runtime.CompilerServices.ExtensionAttribute`）
*   自动属性
*   对象初始化器
*   集合初始化器
*   LINQ to Objects（通过实现`IEnumerable<T>`扩展方法，请参阅[LinqBridge](http://www.albahari.com/nutshell/linqbridge.aspx)）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T04:25:15.887

几乎所有东西！Daniel Moth[在此处](http://www.danielmoth.com/Blog/2007/05/using-c-30-from-net-20.html)和[此处](http://www.danielmoth.com/Blog/2007/05/using-extension-methods-in-fx-20.html)对此进行了介绍。这只留下运行时支持：LINQ-to-Objects 由[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)提供——它只留下更大的 API，如表达式支持，以及 LINQ-to-SQL 等工具。这些太大而无法合理地移植回 .NET 2.0，所以我会为这些使用 .NET 3.5。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-06T05:32:09.217

[我在我网站上的一篇文章中](http://csharpindepth.com/Articles/Chapter1/Versions.aspx)对此进行了介绍。

面向 .NET 2.0 时，几乎所有 C# 3.0 功能都可用。对于扩展方法，您需要定义一个额外的属性。表达式树根本不可用。查询表达式支持基于翻译后跟“正常”C# 规则，因此您需要一些东西来提供 Select、Where 等方法。[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)是事实上的标准“.NET 2.0 中的 LINQ to Objects”实现。您可能希望在`Func`和`Action`委托系列中声明委托，以便更轻松地使用 lambda 表达式 - 然后在您迁移到 .NET 3.5 时删除它们

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T02:51:08.277

要定义扩展方法，如果您的目标是 .NET 2.0，则需要提供以下类：

```
namespace System.Runtime.CompilerServices {
  [AttributeUsage(AttributeTargets.Method | AttributeTargets.Class | AttributeTargets.Assembly)]
    sealed class ExtensionAttribute : Attribute { }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T04:21:37.097

之前有一个关于类似内容的讨论，您可能也想阅读：

[针对 .NET Framework 3.5，使用 .NET 2.0 运行时。注意事项？](https://stackoverflow.com/questions/140239/targeting-net-framework-35-using-net-20-runtime-caveats)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-18T18:06:30.000

您可以使用完全支持 LINQ 和表达式树的 Mono 版本的 System.Core。我针对 .net 2.0 编译了它的源代码，现在我可以在我的 .net2.0 项目中使用它。这对于需要部署在 .net3.5 不可用的 win2k 上的项目非常有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T02:48:49.780

Lambda 和扩展方法完全由编译器处理，可以与 .Net 2.0 框架一起使用。

# date - J2ME 中的自定义日期格式

> ID：173085
> 
> 赞同：2
> 
> 时间：2008-10-06T02:49:06.143
> 
> 标签：date, java-me

我想格式化一个 J2ME Date 对象只显示日期部分，而不是日期和时间。最简单的方法是什么？可能需要包含一个外部库来执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T03:09:57.960

`java.util.Calendar`具有格式化日期输出所需的所有方法。

# file-format - 2008 年选举数据文件 - 如何知道哪位候选人收到了财政捐款？

> ID：173108
> 
> 赞同：2
> 
> 时间：2008-10-06T03:15:26.653
> 
> 标签：file-format

我试图以编程方式查看总统竞选捐款，以查看哪些 web 2.0 人员为哪些候选人做出了贡献。[您可以在网站http://www.fec.gov/finance/disclosure/ftpdet.shtml#a2007_2008](http://www.fec.gov/finance/disclosure/ftpdet.shtml#a2007_2008)上获取数据文件 indiv08.zip

我可以解析出谁贡献了以及他们贡献了多少，但我无法弄清楚**贡献给了谁**。似乎有一些 ID，但它与我能找到的任何其他文件中的候选 ID 都不匹配。如果您能对此提供帮助，我想我可以制作一个非常漂亮的页面，显示谁为哪个候选人做出了贡献。

*更新——我想知道我是否误解了这个贡献系统。也许候选人根本无法收到捐款，只有委员会？比如我看到“C00431445OBAMA FOR AMERICA”收到了很多投稿。这使得将这些委员会与候选人联系起来变得更加复杂。基本上我想知道谁支持奥巴马，谁支持麦凯恩。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T03:34:12.340

在您喜欢的页面顶部链接的教程的第 3 页上，包含列名称，包括“候选人识别”。

# javascript - mootools 或 javascript：$tmp 代表什么或它也属于什么

> ID：173115
> 
> 赞同：1
> 
> 时间：2008-10-06T03:18:49.157
> 
> 标签：javascript, mootools

我目前正在处理`Tips.js`from`mootools`库，并且我的代码在包含这些的行上中断`el.$tmp`，并且控制台说它是未定义的

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T03:55:23.873

我建议您提出问题并将其发布，并附上指向/或/和的页面链接：

[http://mooforum.net](http://mooforum.net)

[http://groups.google.com/group/mootools-users/topics](http://groups.google.com/group/mootools-users/topics)

那是与它蜂拥而至的社区。

现在至于在这里回答 - 我需要更多信息（代码示例？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T10:10:40.093

在 1.11 中（未在 1.2+ 中检查） $tmp 是对元素本身的引用，由垃圾收集器在内部创建和使用：

```
var Garbage = {

    elements: [],

    collect: function(el){
        if (!el.$tmp){
            Garbage.elements.push(el);
            el.$tmp = {'opacity': 1};
        }
        return el;
    },

    trash: function(elements){
        for (var i = 0, j = elements.length, el; i < j; i++){
            if (!(el = elements[i]) || !el.$tmp) continue;
            if (el.$events) el.fireEvent('trash').removeEvents();
            for (var p in el.$tmp) el.$tmp[p] = null;
            for (var d in Element.prototype) el[d] = null;
            Garbage.elements[Garbage.elements.indexOf(el)] = null;
            el.htmlElement = el.$tmp = el = null;
        }
        Garbage.elements.remove(null);
    },

    empty: function(){
        Garbage.collect(window);
        Garbage.collect(document);
        Garbage.trash(Garbage.elements);
    }

}; 
```

行`el.$tmp = {'opacity': 1};`（在上面的收集方法中）和`el.htmlElement = el.$tmp = el = null;`（在上面的垃圾方法中）是我可以找到的源中分配此属性的唯一位置，尽管它是由各种其他方法调用的，例如 Element.setOpacity 和 Element.getStyle （具体来说，只返回不透明度值），以及 Tips 类中的方法

1.2可能没有这个问题，但无论如何，希望能有所帮助，对不起，我无法提供更多帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T03:59:32.133

嗯。我不确定 el.$tmp 是 MooTools 中的引用，但一条消息指出“控制台未定义”可能是因为有人试图登录到 Firebug（或另一个）控制台，如果您不存在该对象没有 Firebug 和朋友。

如果您没有为 Firefox 安装 http://getfirebug.com'>Firebug，那么您可以试一试。看看能否找到控制台语句并将其删除。此外，如果您不使用 Firefox，您可以在 IE、Safari 或 Opera 中使用 Firebug Lite。

# c# - 如何重新解释将浮点数转换为整数？是否有用于“this”转换的非静态转换运算符或用户定义的赋值运算符？

> ID：173133
> 
> 赞同：13
> 
> 时间：2008-10-06T03:36:15.817
> 
> 标签：c#

1\. 如何重新解释将浮点数转换为 int（或将 double 转换为 long）？

```
float f = 2.0f;
int i = (int)f; // causes conversion 
```

我只想将位模式从复制`f`到`i`. 如何才能做到这一点？

2\. C#中的隐式和显式运算符使用一个中间对象，因为运算符函数是静态的

```
public static implicit operator MyClass(double s)
{
    return new MyClass(s);
} 
..
..
MyClass m = 2.2; // this code uses 'm' and one intermediate object. 
```

这对于引用类型来说很好，但是对于大的值类型（比如 20-30 字节），这将导致不必要的数据复制。我的理解正确吗？如果是，那么为什么 C# 没有非静态转换运算符或用户定义的赋值运算符，以便在“this”上进行转换/赋值？如果是这样，有什么方法可以做到吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T04:17:57.977

1：BitConverter（作为六个字母变量）是一个选项；和不安全的代码一样（不需要中间缓冲区）：

```
 float f = 2.0f;
    int i;
    // perform unsafe cast (preserving raw binary)
    unsafe
    {
        float* fRef = &f;
        i = *((int*)fRef);
    }
    Console.WriteLine(i);

    // prove same answer long-hand
    byte[] raw = BitConverter.GetBytes(f);
    int j = BitConverter.ToInt32(raw, 0);        
    Console.WriteLine(j); 
```

2：注意你应该限制结构的大小。我找不到它的引文，但数字“16 字节”（最大，作为建议）似乎一直在我脑海中。在此之上，考虑一个不可变的引用类型（类）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-15T15:11:16.670

除非代码不安全 - 这是我所知道的执行重新解释的最快方法：

```
 [StructLayout(LayoutKind.Explicit)]
    private struct IntFloat
    {
        [FieldOffset(0)]
        public int IntValue;
        [FieldOffset(0)]
        public float FloatValue;
    }
    private static float Foo(float x)
    {
        var intFloat = new IntFloat { FloatValue = x };
        var floatAsInt = intFloat.IntValue;
        ... 
```

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-06T03:41:44.103

1.  [BitConverter](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx)类可以检索任何原始类型的字节，然后您可以使用它来创建一个 int。如果您有大量的转换工作要做，另一种选择是[Buffer.BlockCopy 。](http://msdn.microsoft.com/en-us/library/system.buffer.blockcopy.aspx)

    ```
    float ff = 2.0f;
    int ii = BitConverter.ToInt32(BitConverter.GetBytes(ff), 0);

    float[] ff = new float[...];
    int[] ii = new int[ff.Length];
    Buffer.BlockCopy(ff, 0, ii, 0, ff.Length * 4); // byte-wise copy of ff into ii 
    ```

2.  不，C# 中没有其他选项，但是，我认为虽然您在制作副本的意义上是正确的，但任何足够简单的实现都会完成 JIT 优化，可能不需要复制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-07T01:32:46.720

这种方法虽然不安全，但可以作为通用解决方案

```
static unsafe TDest ReinterpretCast<TSource, TDest>(TSource source)
{
    var tr = __makeref(source);
    TDest w = default(TDest);
    var trw = __makeref(w);
    *((IntPtr*)&trw) = *((IntPtr*)&tr);
    return __refvalue(trw, TDest);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-21T14:47:40.063

这应该是最快和最干净的方法：

```
public static class ReinterpretCastExtensions {
   public static unsafe float AsFloat( this int n ) => *(float*)&n;
   public static unsafe int AsInt( this float n ) => *(int*)&n;
}

public static class MainClass {
   public static void Main( string[] args ) {
      Console.WriteLine( 1.0f.AsInt() );
      Console.WriteLine( 1.AsFloat() );
   }
} 
```

# php - 只允许包含 PHP 文件的最佳方法是什么？

> ID：173144
> 
> 赞同：12
> 
> 时间：2008-10-06T03:49:01.763
> 
> 标签：php

我想确保人们不能在 URL 中键入 PHP 脚本的名称并运行它。这样做的最佳方法是什么？

我可以在将包含此文件的文件中设置一个变量，然后检查正在包含的文件中的该变量，但有没有更简单的方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-06T04:35:07.663

在我接触过的一些开源应用程序中，包括 Joomla 和 PHPBB，它们在主包含文件中声明一个常量，然后验证每个包含项中是否存在常量：

```
// index.php
require_once 'includes.php';

// includes.php
define('IN_MY_PROJECT', true);
include 'myInc.php';

// myInc.php
defined('IN_MY_PROJECT') || die("No direct access, plsktnxbai"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T03:53:34.593

您可以检查 URI 并查看是否使用 ` 调用该文件

```
$_SERVER['SCRIPT_FILENAME'] 
```

或者您可以将文件移到公用文件夹之外，这是一个更好的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T04:23:58.527

除了在网络根目录之外可以直接查看的脚本之外，我一直保留所有内容。然后配置 PHP 以在路径中包含您的脚本目录。一个典型的设置是：

```
应用程序目录
  包括
  html
```

在 PHP 配置（全局 PHP 配置或目录中的`.htaccess`文件`html`）中添加：

```
include_path = ".:/path/to/appdir/include:/usr/share/php"
```

或（对于 Windows）

```
include_path = ".;c:\path\to\appdir\include;c:\php\includes"
```

请注意，此行可能已经在您的`php.ini`文件中，但可能会被注释掉以允许默认值工作。它还可能包括其他路径。一定要保留这些。

如果要将其添加到 .htaccess 文件中，则格式为：

```
php_value include_path .:/path/to/appdir/include:/usr/share/php
```

最后，您可以使用以下方式以编程方式添加路径：

```
$parentPath = dirname(dirname(__FILE__));
$ourPath = $parentPath . DIRECTORY_SEPARATOR . 'include';

$includePath = ini_get('include_path');
$includePaths = explode(PATH_SEPARATOR, $includePath);
// Put our path between 'current directory' and rest of search path
if ($includePaths[0] == '.') { 
    array_shift($includePaths);
}

array_unshift($includePaths, '.', $ourPath);
$includePath = implode(PATH_SEPARATOR, $includePaths);
ini_set('include_path', $includePath); 
```

*（基于工作代码，但经过修改，未经测试）*

这应该在您的前端文件中运行（例如`index.php`）。我把它放在一个单独的包含文件中，在修改上述内容后，可以将其包含在类似`#include '../includes/prepPath.inc'`.

我已经成功地使用了我在这里展示的所有版本。使用的特定方法取决于偏好以及项目的部署方式。换句话说，如果你不能修改`php.ini`，你显然不能使用那个方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T03:56:34.667

正如 Unkwntech 所建议的那样，Zend 框架建议您将文件保存在 Web 根目录之外。我会说这是最安全和最简单的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T03:58:54.710

从 PHP Nuke 模块：

```
<?php
if (!eregi("modules.php", $PHP_SELF)) {
   die ("You can't access this file directly...");
}
// more code ...
?> 
```

将 modules.php 替换为您的文件名，该文件无法直接调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T04:22:37.813

我见过很多的一种方法是创建一个必须存在于每个包含文件中的变量，并检查每个包含的第一件事：

```
if(!isset($in_prog)){
exit;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-07T09:22:19.790

我想最好的方法是将要包含的文件放在“ **/include** ”文件夹中，并将访问权限 700 放入该文件夹

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-08T19:56:58.693

这是一个老问题，但我发现这个单行非常有效：

```
$inc = get_included_files(); if(basename(__FILE__) == basename($inc[0])) exit(); 
```

**get_included_files()**返回一个数组，其中包含脚本中包含的文件。第一个位置是根文件，其他位置是包含文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-06T14:57:25.190

另一种方法是使用此代码：

```
// Prevent direct access, use exclusively as include only.
if (count(get_included_files()) == 1) {
    http_response_code(403);
    die();
} 
```

如果直接调用php文件，则包含文件数组中只有一项。

# c# - 基于类型的条件逻辑

> ID：173145
> 
> 赞同：2
> 
> 时间：2008-10-06T03:49:29.313
> 
> 标签：c#, .net, polymorphism

鉴于：

```
interface I
{
}

class B: I
{
}

class C: I
{
}

class A
{

    public void Method(B arg)
    {
    }

    public void Method(C arg)
    {
    }

    public void Method(I arg)
    {
       // THIS is the method I want to simplify.
       if (I is B)
       {
          this.Method(arg as B);
       }
       else if (I is C)
       {
          this.Method(arg as C);
       }
    }
} 
```

我知道有更好的方法来设计这种类型的交互，但由于细节需要太长时间来解释，这是不可能的。由于这种模式会被重复很多次，我想用一个我可以只使用一行的通用实现来替换条件逻辑。我看不到实现这个通用方法/类的简单方法，但我的直觉告诉我它应该是可能的。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-06T04:02:06.903

我会将方法放在接口中，然后让多态性决定调用哪个方法

```
interface I
{
   void Method();
}

class B : I
{
   public void Method() { /* previously A.Method(B) */}
}

class C : I
{
   public void Method() { /* previously A.Method(C) */ }
}

class A
{
   public void Method(I obj)
   { 
     obj.Method();
   }
} 
```

现在当你需要添加一个新类时，你只需要实现I.Method。您无需触摸 A.Method。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T06:57:27.047

您想要的是[双重调度](http://en.wikipedia.org/wiki/Double_dispatch)，尤其是[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T05:26:33.300

这有点难看，但它完成了工作：

```
public void Method(B arg)
{
  if (arg == null) return;
...
}
public void Method(C arg)
{
  if (arg == null) return;
...
}

public void Method(I arg)
{
  this.Method(arg as B);
  this.Method(arg as C);
} 
```

不过，我不认为我会这样做。看着真的很心疼。对不起，我强迫大家也看看这个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T22:11:33.117

```
interface I
{ 
} 

class B : I
{
}

class C : I
{
}    

class A 
{
    public void Method(B arg)
    {
        Console.WriteLine("I'm in B");
    }

    public void Method(C arg)
    {
        Console.WriteLine("I'm in C");
    }

    public void Method(I arg)
    {
        Type type = arg.GetType();

        MethodInfo method = typeof(A).GetMethod("Method", new Type[] { type });
        method.Invoke(this, new I[] { arg });
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T04:01:20.243

它不以 C# 的方便形式存在 -[请参阅此处](https://stackoverflow.com/questions/156467/switch-pattern-matching-idea)了解基于 F# 模式匹配的想法，这正是您想要的。您可以通过反射做一些事情来在运行时选择重载，但这会非常慢，并且如果有任何东西同时满足这两个重载，则会出现严重问题。如果您有返回值，则可以使用条件运算符；

```
return (I is B) ? Method((B)I) : ((I is C) ? Method((C)I) : 0); 
```

再次 - 不漂亮。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T05:28:41.860

简单的。在 Visual Basic 中，我一直使用 CallByName 来执行此操作。

```
Sub MethodBase(value as Object)
    CallByName(Me, "RealMethod", CallType.Method, value) 
```

这将调用与值的运行时类型最匹配的 RealMethod 的重载。

我相信您可以通过导入 Microsoft.VisualBasic.Interaction 或使用反射创建您自己的版本来使用 C# 中的 CallByName。

# c# - 从 Visual Studio 2008 中的 Crystal Report Viewer 中删除边框/背景

> ID：173149
> 
> 赞同：1
> 
> 时间：2008-10-06T03:52:25.237
> 
> 标签：c#, asp.net, visual-studio-2008, crystal-reports

有人可以解释一下如何在 Visual Studio 2008 中删除嵌入式 CrystalReportViewer 控件的背景/边框。

我正在尝试删除浅灰色（在“Crystal Report”标题下方），然后是下方的深灰色。我想只留下白盒子和里面的报告。

这是我目前得到的输出：

**[http://img411.imageshack.us/my.php?image=screenshotml3.jpg](http://img411.imageshack.us/my.php?image=screenshotml3.jpg)**

HTML 片段是：

```
<div>
 <h2>Crystal Report</h2>

    <CR:CrystalReportViewer ID="CrystalReportViewer1" runat="server" 
    AutoDataBind="true" DisplayToolbar="False" />
</div> 
```

C# 代码片段是：

```
string strReportName = "CrystalReport";
string strReportPath = Server.MapPath(strReportName + ".rpt");
ReportDocument rptDocument = new ReportDocument();
rptDocument.Load(strReportPath);
CrystalReportViewer1.HasCrystalLogo = false;
CrystalReportViewer1.HasDrilldownTabs = false;
CrystalReportViewer1.HasDrillUpButton = false;
CrystalReportViewer1.HasExportButton = false;
CrystalReportViewer1.HasGotoPageButton = false;
CrystalReportViewer1.HasPageNavigationButtons = false;
CrystalReportViewer1.HasPrintButton = false;
CrystalReportViewer1.HasRefreshButton = false;
CrystalReportViewer1.HasSearchButton = false;
CrystalReportViewer1.HasToggleGroupTreeButton = false;
CrystalReportViewer1.HasToggleParameterPanelButton = false;
CrystalReportViewer1.HasZoomFactorList = false;
CrystalReportViewer1.DisplayToolbar = false;
CrystalReportViewer1.EnableDrillDown = false;
CrystalReportViewer1.BestFitPage = true;
CrystalReportViewer1.ToolPanelView = CrystalDecisions.Web.ToolPanelViewType.None;
CrystalReportViewer1.BackColor = System.Drawing.Color.Red;
CrystalReportViewer1.BorderColor = System.Drawing.Color.Green;
CrystalReportViewer1.CssClass
CrystalReportViewer1.Height = 200;
CrystalReportViewer1.Width = 500;
CrystalReportViewer1.ReportSource = rptDocument; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-14T14:34:01.290

我有同样的问题。

它是由另一个 CSS 文件与控件的 CSS 文件冲突引起的。

一旦我为报告制作了一个主文件，没有所有站点的 CSS 文件引用，背景和任务栏就很好——它们有一个白色的背景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T23:02:14.083

您的代码在 Visual Studio 2008 中与 Crystal Reports XI Release 2 开发人员版（独立产品）一起为我工作。我没有可见的灰色条或背景。事实上，报告本身的空白区域显示为分配的背景色，红色。您是否使用 Visual Studio 2008 附带的捆绑 CrystalReportViewer？可能值得尝试将 BorderStyle 属性设置为 BorderStyle.None 以查看是否有任何效果。

MSDN 上有一个关于自定义 CrystalReportViewer 控件的教程：http: [//msdn.microsoft.com/en-us/library/ms227538.aspx](http://msdn.microsoft.com/en-us/library/ms227538.aspx)

这是 VS2008/.NET 3.5 的版本，但我不确定本教程与之前的版本相比有多少实际变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-20T21:51:53.940

尝试将 DocumentView 属性设置为 WebLayout 而不是 PrintLayout：

代码隐藏

```
CrystalReportViewer.DocumentView = CrystalDecisions.Shared.DocumentViewType.WebLayout 
```

网页配置

```
<configSections>
  <sectionGroup name="businessObjects">
    <sectionGroup name="crystalReports">
      <section name="printControl" type="System.Configuration.NameValueSectionHandler" />
      <section name="crystalReportViewer" type="System.Configuration.NameValueSectionHandler" />
    </sectionGroup>
  </sectionGroup>
</configSections>
<businessObjects>
  <crystalReports>
    <crystalReportViewer>
      <add key="documentView" value="weblayout" />
    </crystalReportViewer>
  </crystalReports>
</businessObjects> 
```

[SAP Note 1344534 - 如何更改 Crystal Report Web 查看器的 documentView](http://search.sap.com/notes?id=0001344534&boj=/sap/bc/bsp/spn/scn_bosap/notes.do?access=69765F6D6F64653D3939382669765F7361706E6F7465735F6E756D6265723D30303031333434353334)

# project-management - 你如何保持专注和交付项目？

> ID：173158
> 
> 赞同：5
> 
> 时间：2008-10-06T03:56:42.060
> 
> 标签：project-management

我发现需要参与的项目太多，可以使用多种语言（以及这些语言中有太多很酷的功能），以及需要阅读的书籍太多......

你们如何保持专注并实际完成任何事情，而不是留下部分完成的“实验”？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-06T04:47:01.447

似乎有两种类型的开发人员：修补匠和企业家。

修补匠想知道每一件小事是如何运作的。一旦他们掌握了某事的窍门，他们就会被他们不知道的一切分心。对于修补匠来说，科技世界是残酷的，因为要学习的东西太多了，而且每个新的一年都会创造更多。修补匠为他们的知识感到自豪。

企业家想知道足够多的知识来建立真正伟大的东西。他们从功能和最终用户体验的角度进行思考。你永远不会听到他们争论 Python 胜过 .NET 胜过 Java 胜过 C，因为他们根本不在乎。他们对语言的结果比语言本身更感兴趣。企业家为他们的用户群感到自豪。

听起来你正在为你的修补匠倾向而苦苦挣扎。我遇到了同样的问题，并且发现只有一件事有帮助 - 找到您完全尊重的 Entrepreneur 开发人员。当你把两者放在一起时，它是无与伦比的。Tinkerer 探究每一个技术细微差别的深度。他们让企业家在技术上保持诚实。反过来，企业家为修补匠创造焦点和机会。当他们发现您浏览 Scala 站点时（假设您不是 Scala 开发人员），他们揭示了您现有项目中的新挑战。不仅如此，他们更善于理解非修补匠想要什么。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-06T05:00:21.357

金钱，以及实际完成某事所带来的成就感。当我第一次考虑为自己工作时，我开始想出我将开发然后销售的软件的想法。当然，我真的不知道我正在做的东西是否真的会卖掉，所以很容易分心并跳出新的想法。

所以我决定成为一名承包商/顾问。当你知道你正在做的东西有买家，并且有人在等待它时，它会给你动力。如果这是一个有趣或具有挑战性的项目，那么完成它就会很匆忙。所以这增加了额外的动力，因为你越来越想要那种匆忙。

一旦我获得了相当稳定的雇佣项目流，我发现我可以更好地专注于我的副项目，因为我有动力练习良好的时间管理。我每天或每周给自己一定的时间来处理我的业余项目，这有助于我在花时间时保持专注。

当然，我仍然偶尔会去切线并开始新的副项目，但我最感兴趣的那些我一直能够坚持下去。

此外，在完成一些项目后，您会更好地了解从构思到完成实际需要什么，并且一次又一次地做这件事变得容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T04:05:34.883

我认为一个好的程序员可能会有很多未完成的“实验”，这是一件好事。

通常有一个好的经理，如果你的工作根本没有完成，你将被追究责任。不过，如果你是学生，那就更难了。我意识到要学习所有你想学习的东西是不可能的。

我限制自己每年只学习 1 或 2 种新语言，每月只学习 1 本书。这似乎是编程混乱和做好工作之间的一个很好的平衡。

感谢拥有良好的学习态度:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T05:15:22.993

可能最好的激励因素（对于团队或个人）是尽早并经常设定目标。

我在项目管理中观察到的最佳方法之一是引入“功能主题周”——团队（或个人）设定目标或可交付成果，这些目标或可交付成果在一般风格下保持一致，例如“客户功能”、“报告”和指标”等。这使团队/个人专注于交付/工作的一个领域。它还使与正在取得进展的客户沟通变得容易。

另外.. 尝试让您（或您的团队）的进步可见。如果您可以建立自动化构建过程（或其他一些机制）并在短时间内“发布”工作的增量实施，您通常可以获得牵引力和早期参与，这可以更快地推动结果（并有助于早期课程更正）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T04:07:34.207

1）我留下了一大堆未完成的东西，当然是所有的副业。
2）当我需要工作的动力时，我会打开我的钱包……这通常对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T04:12:38.037

我发现参与等式的“业务”方面有很大帮助。当您看到您的程序的实际用户可以从您对他们的问题的创造性解决方案中获得多少好处时 - 为他们提供这些解决方案是一种极端的动力。:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T04:23:43.443

我正在构建一个我计划出售的应用程序，并将其视为一种赚取额外收入或减少我为他人工作的时间的方式。

我妻子喜欢这个主意，她的鼓励使我比平时更专注，因为现在是“工作”而不是“玩耍”

# asp.net-mvc - ViewData 和 TempData 之间的区别？

> ID：173159
> 
> 赞同：101
> 
> 时间：2008-10-06T03:57:42.153
> 
> 标签：asp.net-mvc

我知道 ViewData 是什么并且一直在使用它，但是在 ASP.NET Preview 5 中，他们引入了一些新的东西，称为 TempData。

我通常强烈键入我的 ViewData，而不是使用对象字典方法。

那么，什么时候应该使用 TempData 而不是 ViewData？

有没有这方面的最佳实践？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-10-06T09:16:55.130

一句话：`TempData`就像 ViewData 有一个区别：它们只包含两个连续请求之间的数据，之后它们被销毁。您可以使用`TempData`传递错误消息或类似的东西。

虽然已经过时，[但这篇文章](http://www.squaredroot.com/2007/12/20/mvc-viewdata-vs-tempdata/)对生命周期有很好的描述`TempData`。

正如 Ben Scheirman[在这里](http://web.archive.org/web/20110808062247/http://flux88.com/2008/01/testing-tempdata-in-asp-net-mvc/)所说：

> TempData 是一个会话支持的临时存储字典，可用于单个请求。在控制器之间传递消息很棒。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-01-20T21:23:22.977

当操作返回 RedirectToAction 结果时，它会导致 HTTP 重定向（相当于 Response.Redirect）。在单个 HTTP 重定向请求期间，数据可以保存在控制器的 TempData 属性（字典）中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-06-14T19:34:11.157

**查看数据：**

*   `ViewData`是字典类型`public ViewDataDictionary ViewData { get; set; }`
*   它可用于将数据从控制器传递到视图，只有一种方式
*   它的生命只存在于当前的请求中
*   如果传递字符串，则无需进行类型转换
*   如果传递对象，那么您需要对其进行类型转换，但在此之前您需要检查它是否不为空
*   它是 on 的一个属性`ControllerBase`，它是类的父`Controller`级

**临时数据：**

1.  `TempData`内部使用`TempDataDictionary`：`public TempDataDictionary TempData { get; set; }`
2.  将数据保存到`TempDataDictionary`对象后：
    *   它保留在其中，可以从任何视图或任何控制器中的任何操作中读取
    *   只能读取一次；一旦读取，它就变为空
    *   它被保存到会话中，因此会话数据到期时会丢失。

此行为是 ASP.NET MVC 2 和更高版本的新行为。在早期版本的 ASP.NET MVC 中，中的值`TempData`仅在下一个请求之前可用。

3.  它是活动的，直到它被读取或会话过期并且可以从任何地方读取。

[详细看MVC中ViewData、ViewBag、TempData和Session的对比](http://www.advancesharp.com/blog/1114/viewdata-viewbag-tempdata-and-session-in-mvc)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-10-03T09:00:33.507

我发现这个比较很有用：http: [//www.dotnet-tricks.com/Tutorial/mvc/9KHW190712-ViewData-vs-ViewBag-vs-TempData-vs-Session.html](http://www.dotnet-tricks.com/Tutorial/mvc/9KHW190712-ViewData-vs-ViewBag-vs-TempData-vs-Session.html)

我遇到的一个问题是 TempData 值在默认情况下被读取后被清除。有一些选项，[请参阅 Msdn 上的方法 'Peek' 和 'Keep' 了解更多信息](https://msdn.microsoft.com/en-us/library/system.web.mvc.tempdatadictionary)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-22T11:34:50.703

当我们想将数据从控制器传递到相应的视图时使用视图数据。视图数据的寿命很短，这意味着它会在重定向发生时销毁。示例（控制器）：

```
public ViewResult try1()
    {
        ViewData["DateTime"] = DateTime.Now;
        ViewData["Name"] = "Mehta Hitanshi";
        ViewData["Twitter"] = "@hitanshi";
        ViewData["City"] = "surat";
        return View();
    } 
```

尝试1.cshtm

```
<table>
<tr>
    <th>Name</th>
    <th>Twitter</th>
    <th>Email</th>
    <th>City</th>
    <th>Mobile</th>
</tr>
<tr>
    <td>@ViewData["Name"]</td>
    <td>@ViewData["Twitter"]</td>
    <td>@ViewData["City"]</td>
</tr>
</table> 
```

TempData 在控制器之间或动作之间传输数据。它用于存储一次性消息，它的寿命很短。我们可以使用 TempData.Keep() 使其在所有操作中都可用或使其持久化。

示例（控制器）：

```
public ActionResult try3()
    {
        TempData["DateTime"] = DateTime.Now;
        TempData["Name"] = "Ravina";
        TempData["Twitter"] = "@silentRavina";
        TempData["Email"] = "Ravina12@gmail.com";
        TempData["City"] = "India";
        TempData["MobNo"] = 9998975436;
        return RedirectToAction("TempView1");
    }
    public ActionResult TempView1()
    {
        return View();
    } 
```

TempView1.cshtm

```
<table>
<tr>
    <th>Name</th>
    <th>Twitter</th>
    <th>Email</th>
    <th>City</th>
    <th>Mobile</th>
</tr>
<tr>
    <td>@TempData["Name"]</td>
    <td>@TempData["Twitter"]</td>
    <td>@TempData["Email"]</td>
    <td>@TempData["City"]</td>
    <td>@TempData["MobNo"]</td>
</tr>
</table> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-16T10:31:45.023

只是对 TempData 的一个旁注。*其中的数据在下一个请求*
之前不会存储，而是在调用**下一个读取操作之前存储！** 请参阅：[TempData 在第二次请求后不会销毁](https://stackoverflow.com/questions/12815739/tempdata-wont-destroy-after-second-request)

 ***# collision-detection - 有人可以解释每像素碰撞检测吗？

> ID：173199
> 
> 赞同：9
> 
> 时间：2008-10-06T04:24:53.363
> 
> 标签：collision-detection

有人可以解释它的优缺点以及与之相关的任何数学吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-06T05:06:18.847

对于 2D：你不需要任何数学来解决这个问题，你只需要一个自定义的 bitblit-routine。您将通过在此表面上绘制其碰撞掩码并检查您只想绘制的像素是否为 (pixel != 0) 将碰撞候选者blit 到隐藏表面。然后你会发生碰撞。当然，如果可能发生碰撞，您应该通过边界矩形进行预检查。

对于 3D：您将需要数学（很多）！

基本上，您将检查演员的每个表面与敌人的每个表面。这将通过计算平面射线相交来完成。这里有很多优化可能，但这取决于你的 3d 表示。**这也不是 Per-Pixel-Collision，而是 Per-Vertex-Collision**

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-14T19:20:14.337

我将从回答逐像素碰撞检测的优缺点开始，然后再考虑数学方面。

每像素碰撞检测，也称为像素完美碰撞检测，也许更准确地说是基于图像的碰撞检测，正在寻找表示为图像的碰撞对象之间的碰撞。这种空间方法与更多的几何方法形成对比，后者使用多边形和其他几何形状来表示碰撞对象。

对于 2D，通常有 3 种不同的选项：

*   基于图像
*   简单的几何形状（轴对齐的边界框、圆形）
*   复杂的几何形状（凸多边形、凹多边形、椭圆等）

基于图像的碰撞检测精确且易于使用和理解。对于使用图像进行绘图的游戏，使用基于图像的碰撞检测意味着每当屏幕上的精灵重叠时，它们也会在碰撞检测系统中重叠。它们对于需要可变形碰撞对象的游戏也很有用，例如可破坏地形的游戏，如 Worms 2D，因为通常很少涉及预计算。它们的主要缺点是与其他方法相比效率非常低，尤其是在旋转和缩放碰撞对象时。

简单的几何形状既易于使用又非常有效。如果不需要高精度，或者碰撞对象很适合简单的几何形状（例如，如果您的碰撞对象是球，圆形是完美的配合，有时甚至比图像更好）。它们的主要缺点是精度。对于基本形状不适合的高精度，您要么必须将简单形状组合成更复杂的形状，要么必须使用更通用和复杂的形状。在任何一种情况下，您都会采用第三种方法。

复杂的几何形状可能有些精确并且相对有效或低效，具体取决于用于表示碰撞对象的形状的复杂性。一个重要的缺点是易于使用。当碰撞对象不适合可用的几何形状时，要么精度受到影响，要么必须使用多个可能不同的形状来表示它，这需要时间。此外，有些形状很复杂，不容易创建，除非您可以从图像中自动生成它们。一个重要的优点是旋转和缩放通常是高效且容易的，尤其是与基于图像的碰撞检测相比。

基于图像的碰撞检测通常被视为一个糟糕的解决方案，因为它通常效率低下，尤其是在使用旋转和缩放时。然而，由于它如此灵活、精确且易于使用，我决定实现一个旨在解决效率问题的库。结果是[PoxelColl](https://github.com/Poxelcoll/Poxelcoll)，它使用自动预先计算的凸包来加速基于图像的碰撞检测。这提供了易用性、灵活性、精度和效率，并支持旋转和缩放。主要缺点是与纯几何解决方案相比，它并非在所有情况下都有效，并且它需要使用预计算，这意味着它对于可变形碰撞对象并不是非常低效。

对于 3D，选项和优势有些相似：

*   基于体积
*   简单的几何形状（轴对齐的边界框、圆形）
*   复杂的几何形状（凸多边形、凹多边形、椭圆等）

需要注意的是，Peter Parker 的回答对于 3D 是错误的；2D 中的像素（图片元素）对应于 3D 中的体素（体积元素）。

一些重要的区别是 3D 的空间方法比 2D 的少得多。一个可能的原因是，由于 3D 增加了额外的维度，空间解决方案的效率变得更低，而简单的几何解决方案仍然有效。而在游戏中，碰撞检测一般是在线操作，需要一定程度的效率，因此效率很重要。因此，体积更常用于不需要在线确定碰撞的非游戏应用程序中。

有关基于体积的碰撞检测的碰撞检测示例，请参见[可变形对象的体积碰撞检测](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.13.2297)，其中使用体积而不是几何形状意味着它们可以处理具有任意形状的封闭表面的可变形碰撞对象。

至于第二个问题，基于图像的碰撞所涉及的数学可以从简单到复杂。简单的情况基本上是对图像使用轴对齐的边界框，找到它们的交点，然后只检查交点中的图像。更复杂的解决方案包括我之前提到的库，其中需要凸多边形相交。对于 3D 案例，解决方案从简单到非常复杂。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T04:35:57.630

它比顶点（或命中框等）更准确。我假设您在这里谈论的是 2d（3d 将是盒模型与顶点）。每像素可以让你有详细的精灵，小东西（比如导弹）会更真实地碰撞。

它比传统方法更数学且更慢，传统方法是画一个盒子（或其他一些简单的数学形状，如圆形）并说“这是演员，这里的任何东西都是他”。然而，它更准确。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T05:45:40.280

在谈论利弊时，您还必须考虑碰撞响应。当检测到碰撞时你想做什么？如果您正在检测一个物体撞击另一个物体，结果是其中一个或两个物体被破坏，那么每像素碰撞检测是好的和准确的。如果您希望对象以其他方式做出反应，即靠墙滑动、弹跳等......那么您可能需要使用某种类型的边界矩形/圆形/椭圆形，这将使碰撞响应看起来更平滑和更多一致，卡住的机会更小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T05:38:50.280

优点已经提到：像素完美且公平，没有误报也没有误报。主要缺点是计算成本高，但如果你先做一个简单的边界框检查，这应该不是什么大问题。在 OpenGL 和 DirectX 时代还有一个问题：精灵数据通常是纹理，这意味着它们在 VRAM 中，您无法轻松地自己检查像素值。在 OpenGL 中，您可以使用该`glReadPixels`函数将两个精灵的相交部分返回 RAM 并检查碰撞，或者您可以使用[遮挡查询](http://kometbomb.net/2008/07/23/collision-detection-with-occlusion-queries-redux/). 遮挡查询方法应该具有更好的性能，因为您没有将数据从 GPU 移回，但并非所有地方都支持遮挡查询（即 OpenGL ES 不支持它们，如果我错了，请有人纠正我）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T02:29:24.933

考虑 OpenGL 和纹理案例：您可以预先计算图像的位矩阵并测试两个像素是否重叠。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-26T00:13:51.553

每像素碰撞检测是过去的遗物，当时图形很简单，2D 硬件包括精灵和背景之间的自由碰撞检查，因为即使是基本的距离计算在计算上也是昂贵的。虽然今天的 2d 图形更加复杂，但很少使用逐像素碰撞检查，尤其是因为对象可见形状和碰撞形状通常不同。大多数情况下，圆圈或方框就足够了。此外，由于基于 opengl 的图形硬件无法再进行碰撞检查，因此您必须编写额外的渲染代码，使用 CPU 来进行碰撞检查，同时将额外的位图数据保存在系统内存中，因为无法直接访问图形内存.

# shipping - 按时发布软件的最佳实践

> ID：173202
> 
> 赞同：16
> 
> 时间：2008-10-06T04:25:43.580
> 
> 标签：shipping

想象一下，您没有功能蔓延的问题，您有一个积极且稳定的团队，明确定义的问题要解决，并且您了解与您的项目相关的领域/语言/工具。

您如何*遵守时间表*并完成 1.0 里程碑？
您对*迭代运输*的方法是什么？

我想特别为一个很少或几乎没有沟通问题的小团队提供建议。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-06T04:32:28.057

1.  专注于功能而不是实现任务。
2.  以迭代方式工作（如每周或每两周一次）。
3.  按优先级顺序将工作功能发布到您的暂存环境。
4.  随时对您的代码进行单元测试，这样您就不会因为接近发布日期时呈几何级数增加的错误列表而减慢您的速度。
5.  准备从不太重要的功能中减少范围。东西总是比你想象的要花更长的时间。
6.  确保提前勾勒出 UI（如果有 UI），并将其展示给潜在用户。
7.  测试，测试，再测试一些。这似乎违反直觉，但它节省的时间多于花费的时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T04:37:44.240

这可能是一个乌托邦式的场景；-)。但无论如何，如果没有功能蔓延，非常好的团队和明确定义的需求，绝对没有沟通问题，那么按时交付产品的最佳方式可能是

1.  每周与团队开会以评估当前状态（PM 与团队，如果有 PM）
2.  团队负责人可以每天与团队成员举行一次小型会议，以评估他们对委派给他们的问题/要求的状态。如果有问题，那么他/她应该采取必要的步骤来解决问题。
3.  项目计划跟踪和工作委派（团队负责人需要了解每个团队成员的个人优势才能适当委派工作）。
4.  在技​​术允许的范围内，测试可以自动化。
5.  每个团队成员对工作的所有权。

归根结底，归根结底是一个人对工作的热情。

只是我的 2 派斯 ;-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T04:41:33.530

[问题：一个大型软件项目如何延迟一年？答：一天一天！](http://en.wikipedia.org/wiki/The_Mythical_Man-Month)

这并不能回答你的问题，但我认为它确实表明需要坚持你的日程安排——即使你落后一天，你也需要以某种方式赶上它。（不幸的是，神话人物月的其余部分都是关于在大多数项目中如何没有“不知何故”......）

[另外，请查看FogBugz](http://www.fogcreek.com/FogBugz/docs/60/topics/schedules/Evidence-BasedScheduling.html)等产品中的基于证据的调度。这将为您提供有关产品可能发货时间的最新估计——事实上，它提供了一个日期范围，以及每个日期的概率。如果您看到您可能的发布日期已超过截止日期，这将让您知道您需要对此采取一些措施——并希望有足够的时间来产生效果。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T05:11:22.067

以前的海报遗漏了一个小点。为了满足最后期限，首先应该定义现实的时间表。项目应该分解成小任务，这取决于项目的大小，但在我的世界中，项目大约需要 3-4 个月，我们试图将它们分成最多 2-3 天的任务。通过这种方式，时间估计大多是现实的，风险会提前计算并添加到建议的时间表中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T16:40:12.690

这个帖子里有很多很好的建议。我唯一要补充的是采用定期发布时间表。几年前我的公司改用了这个，一开始很痛苦，但它确实有很多好处，其中最大的好处是让人们可以轻松地推迟功能。

推迟功能是可以的，因为您知道您的功能可以使其进入下一个版本，并且您知道该版本何时发布。这意味着，与其在最后一分钟急于获得半生不熟的功能，您可以花更多时间在下一个版本开始时将其加入。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-26T03:40:47.907

除非销售/营销/管理的时间表不合理，否则您几乎已经排除了项目无法按时交付的所有原因。软件开发方法论的历史是一系列解决方法、减少影响和/或避免的方法：

*   定义不明确的范围
*   特征蠕变
*   缺乏领域知识
*   有沟通问题的大型团队
*   没有动力/不称职的开发人员

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-26T13:50:07.163

了解客户的关键任务功能。保护他们的进步。80% 的成功来自 20% 的工作，这通常是非常正确的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-26T04:04:31.480

为了产品团队的利益，使用当前接受的构建阶段***定期（每月？每周？）产品演练。***尽早开始这些。演示每个功能，无论它们当前的可用性如何；不要跳过那些落后的。

关键是让利益相关者清楚地了解项目过程中产品的当前状态。通过这种方式，决策者更有可能及时解决进度风险，而不是危及发货日期。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-27T01:39:45.980

我想说的是，您可以选择功能集或发货日期，但不能同时选择两者。

以下是一些个人想法： - 不要乐观 - 先做困难的部分 - 不要在不推迟进度的情况下添加功能 - 以这样的方式编写功能，以便您可以将它们放到计划中

[http://shipcamp.com](http://shipcamp.com)

# jquery - 从浮动图表中获取数据系列的颜色

> ID：173205
> 
> 赞同：8
> 
> 时间：2008-10-06T04:28:33.743
> 
> 标签：jquery, flot

在 stackoverflow 用户页面上看到酷炫的新“声誉”选项卡后，我受到启发，开始尝试使用 Flot 图表库。我有一个有数百个系列的折线图。在任何给定时间，这些系列中只有几个是可见的。我的数据系列分为几个“类别”，并根据该类别分配数字颜色索引。我希望能够看到 Flot 将什么实际颜色分配给特定颜色索引值，最终目的是创建一个将颜色与我的数据“类别”相关联的自定义图例。我怎样才能得到这些颜色值？

我看到我可以提供自己的颜色数组，但我不愿意这样做，因为在加载数据之前我不确定我会有多少类别。我想我可以创建一个太大的数组，但是如果可以问 Flot 每个系列是什么颜色，那似乎很浪费*。*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-06T04:46:38.623

[在http://flot.googlecode.com/svn/trunk/API.txt](http://flot.googlecode.com/svn/trunk/API.txt)的底部有一个例子就是这样做的。就像是：

```
var plot = $.plot(placeholder, data, options)
var series = plot.getData();
for (var i = 0; i < series.length; ++i)
   alert(series[i].color); 
```

# asp.net - JQuery 的 $ 与 ASP.Net MVC 中 StringTemplate.Net 的 $ 冲突

> ID：173207
> 
> 赞同：17
> 
> 时间：2008-10-06T04:30:25.440
> 
> 标签：asp.net, asp.net-mvc, templates, stringtemplate

我正在探索 ASP.NET MVC，我想添加 jQuery 以使站点具有交互性。我使用移植到 .Net 的 StringTemplate 作为我的模板引擎来生成 html 并发送 JSON。但是，当我查看该页面时，我看不到它。调试后，我意识到 StringTemplate 使用 $ 来访问属性等，jQuery 也使用它来操作 DOM。哎呀，我看过其他模板引擎，其中大多数都使用美元符号:(。

ASP.Net MVC 的任何替代模板引擎？我想保留 jQuery，因为 MSFT 宣布它将用于 Visual Studio（2008 年？）

提前致谢 ：）

**更新**

请转到[ASP.NET MVC 视图引擎比较问题中](https://stackoverflow.com/questions/1451319/asp-net-mvc-view-engine-comparison)[的答案](https://stackoverflow.com/questions/1451319/asp-net-mvc-view-engine-comparison/1451355#1451355)，以获取 ASP.NET MVC 模板引擎的完整列表，以及它们的优缺点

**更新 2**

最后，我将把包括 JQuery 在内的 JavaScript 代码放在一个单独的脚本文件中，因此我不会担心`$`模板文件中的混合。

**更新 3**

更改了标题以反映我需要解决的问题。毕竟“Y 中最好的 X”是非常主观的问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-14T20:13:26.300

您当然可以将 js 逻辑移动到 .js 文件中。但是，如果您希望它与您的 StringTemplate 视图内联，则可以使用 \$ 构造对其进行转义。

此外，如果您想避免转义语法，您可以简单地使用 jQuery("selector")，而不是 $("selector") 构造。

这是一篇关于[在 MVC 中使用 StringTemplate 作为视图引擎](http://websitelogic.net/articles/MVC/stringtemplate-viewengine-asp-net-mvc/)的好文章。

还有一个随附的[开源引擎，以及一些示例](http://code.google.com/p/string-template-view-engine-mvc/)。

此外，如上所述，您可以修改您的 Type Lexer。（使其成为 $ 的替代字符）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-08T16:19:49.610

我强烈推荐[Spark](http://dev.dejardin.org/)。我已经用 jQuery 使用它一段时间了，到目前为止还没有遇到过一个问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-22T02:18:22.497

JQuery 可以通过使用 jQuery 关键字来消除歧义，如下所示：

```
jQuery( 
```

而不是这个：

```
$( 
```

我认为这是一种最佳做法。它消除了与另一个库发生冲突的任何可能性，并使代码更具可读性。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-06T04:32:16.187

也许[jQuery.noConflict](http://docs.jquery.com/Core/jQuery.noConflict)会为你工作

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T19:50:10.560

看看 mvccontrib 项目。他们目前有 4 种不同的视图引擎，分别是 brail、nhaml、nvelocity 和 xslt。

[http://www.codeplex.com/MVCContrib](http://www.codeplex.com/MVCContrib)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-27T18:44:45.483

如果您想坚持使用 StringTemplate (ST)，[请参阅 ST wiki 中的这篇文章](http://www.antlr.org/wiki/display/ST/Setting+the+expression+delimiters)。您也可以通过编辑**Antlr.StringTemplate.Language\DefaultTemplateLexer.cs**并用您想要的替换“ **$ ”来完全改变行为。**

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-07-18T12:23:26.377

我真的很喜欢 Django 中的语法，所以我推荐 NDjango :)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-06T04:44:05.960

您是否尝试过 $$ 或 /$ 来转义字符串模板中的美元符号？我不确定 ST 的具体情况，但这就是大多数模板引擎的工作方式。

至于其他模板引擎，当我在项目中使用 nVelocity 时，我真的很喜欢它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-20T15:34:25.670

[JsonFx.NET](http://jsonfx.net/download)具有功能强大的客户端模板引擎，具有熟悉的 ASP.NET 样式语法。整个框架专为与 jQuery 和 ASP.NET MVC 一起工作而设计。您可以从以下网址获取有关如何构建真实 UI 的示例：[http ://code.google.com/p/jsonfx-examples/](http://code.google.com/p/jsonfx-examples/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-03-18T22:25:07.857

我一直在为 ASP.NET MVC 项目使用 ANTLR StringTemplate。但是，我所做的是扩展 StringTemplate 语法（template.g）以将“%”（aspx.template.g）识别为分隔符。如果您下载 StringTemplate.net 版本，您可以找到这些文件。我生成了相应的文件：AspxTemplateLexer.cs、AspxTemplateParser.cs、AspxTemplateParserTokenTypes.cs 和 AspxTemplateParserTokenTypes.txt。

此外，我更改了 StringTemplateLoader.cs 以识别 Visual Studio 识别的扩展名 .aspx 和 .ascx。这样我就不会被 .st 扩展名困住，客户也不知道其中的区别。

无论如何，在重建 StringTemplate 之后，我有我想要的行为。我喜欢 StringTemplate 的地方在于它不允许在模板中嵌入任何代码。看起来像 Spark 一样，默认的 ASP/MVC 模板是代码许可的，这使得模板的可移植性降低。

我更喜欢将 "<%" 和 "%>" 作为分隔符，但不幸的是，除非有人这样​​做，否则 ANTLR 语法似乎有些难以更改和脆弱。另一方面，StringTemplate 拥有强大的支持社区和出色的分离方法——这就是 MVC 的重点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-02T03:46:46.537

你可以试试[jsRepeater](http://jsrepeater.devprog.com/introduction.html)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-05-09T23:10:00.407

您可能需要这个[.NET 模板引擎](http://www.componentsoft.net/component/templateengine.net/)。如果您想使用 '$' 字符，只需使用 '$$'。请看下面的代码：

```
{%carName = "Audi R8"/}

{%string str = "This is an $carName$"/}

$str$
$$str$$ 
```

输出将是

```
This is an Audi R8
$str$ 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-05-11T10:16:43.610

`Template`如果我正确理解 StringTemplate 第 4 版，您可以在（或`TemplateGroup`）构造函数中定义自己的转义字符。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-11-06T18:47:09.753

发现 Mustache 是用于 .Net 项目（Web 和后端）的最简单、最易于使用、最轻量的全功能模板引擎

适用于 .Net 3.5（这意味着它不需要动态类型和 .Net 4.0 即可用于混合类型模型，如 Razor）。

我最喜欢的部分是能够在其中嵌套任意 ​​IDicts 并使引擎做正确的事情。这使得强制所有引擎重新装箱步骤超级简单：

```
var child = new {
    nested = "nested value"
};
var parent = new {
    SomeValue = "asdfadsf"
    , down = child
    , number = 123
};

var template = @"This is {{#down}}{{nested}}{{/down}}. Yeah to the power of {{number}}";

string output = Nustache.Core.Render.StringToString(template,parent);
// output:
// "This is nested value. Yeah to the power of 123" 
```

Mustache 最美妙的地方在于，完全相同的模板在纯 JavaScript 或任何其他 20 种左右受支持的语言中的工作方式完全相同。

# c# - 如何在简单的 Web 项目中连接到 .mdf（Microsoft SQL Server 数据库文件）？

> ID：173209
> 
> 赞同：10
> 
> 时间：2008-10-06T04:32:06.170
> 
> 标签：c#, asp.net, database, visual-studio-2008

具体来说，在 VS 2008 中，我想通过右键单击自动生成的 App_Data 文件夹（一个 .mdf“数据库”）连接到一个数据源。看起来很容易，而且一旦你知道怎么做。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-06T06:43:00.027

我一直保留的一个很好的资源是[connectionstrings.com](http://connectionstrings.com)。当您找不到示例时，查找这些连接字符串非常方便。

特别是[此页面](http://connectionstrings.com/?carrier=sqlserver2005)适用于您的问题

**在连接到本地 SQL Server Express 实例时附加数据库文件**

```
Driver={SQL Native Client};Server=.\SQLExpress;AttachDbFilename=c:\asd\qwe\mydbfile.mdf; Database=dbname;Trusted_Connection=Yes; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-06T04:40:40.817

所以这是来自 MSDN 的答案：

> 从“数据”菜单中选择[e]“添加新数据源”。[并按照连接向导]

很简单，只是我没有数据菜单。如果您没有数据菜单，请执行以下操作：

*   单击工具>>连接到数据库...
*   选择“Microsoft SQL Server Database File”，取默认的Data provider，点击OK
*   在下一个屏幕上，浏览到您的数据库文件，该文件将位于您的 VS 解决方案文件夹结构中的某个位置。

测试连接。会好的。如果要将字符串添加到 web.config，请单击高级按钮，然后复制数据源行（位于对话框底部），并将其粘贴到 web.config 中适当位置的连接字符串中文件。您必须添加“ `AttachDbFilename`”属性和值。例子：

高级面板中的原始文本：

```
Data Source=.\SQLEXPRESS;Integrated Security=True;Connect Timeout=30;User Instance=True 
```

web.config 中的实际条目：

```
<add name="SomeDataBase" connectionString="Data Source=.\SQLEXPRESS; 
AttachDbFilename=C:\Development\blahBlah\App_Data\SomeDataFile.mdf;
Integrated Security=True; Connect Timeout=30; User Instance=True" /> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T19:56:58.223

还有一个——我一直在我的桌面上保存一个 udl 文件，以便轻松创建和测试连接字符串。如果您以前从未这样做过 - 创建一个新的文本文件并将其命名为 connection.udl（ext 是唯一重要的部分）。打开文件，从 Provider 选项卡开始，然后逐步完成。对连接感到满意后，将文件重命名为 .txt 扩展名。打开文件并复制字符串 - 这相对容易，让您在使用之前测试连接。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-01-04T08:56:22.460

```
<add name="Your Database" connectionString="metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Expanse.mdf;Integrated Security=True;User Instance=True;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient"/> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-26T18:32:51.917

在您的 Login.aspx.cs （提交按钮单击事件中登录页面的代码隐藏文件）添加

```
string constr = @"Data Source=(LocalDB)\v11.0; AttachDbFilename=|DataDirectory|\myData.mdf; Integrated Security=True; Connect Timeout=30;";
using (SqlConnection conn = new SqlConnection(constr))
string constr =    ConfigurationManager.ConnectionStrings["myData"].ToString();

using (SqlConnection conn = new SqlConnection(constr))
{
sqlQuery=" Your Query here"
SqlCommand com = new SqlCommand(sqlQuery, conn);
com.Connection.Open();
string strOutput = (string)com.ExecuteScalar();
} 
```

# php - mysql_real_escape_string() 在 MySQL 中留下斜杠

> ID：173212
> 
> 赞同：12
> 
> 时间：2008-10-06T04:33:29.990
> 
> 标签：php, mysql, mysql-real-escape-string

我刚搬到一家新的托管公司，现在每当一个字符串被转义时，使用：

```
mysql_real_escape_string($str); 
```

斜线保留在数据库中。这是我第一次看到这种情况发生，所以我的脚本都没有使用

```
stripslashes() 
```

了。

这是在 CentOS 4.5 64 位上运行 php 5.2.6 作为 fastcgi 在 lighttpd 1.4 服务器上。我确保所有 magic_quotes 选项都关闭，并且 mysql 客户端 api 是 5.0.51a。

我的所有 6 个网络服务器都有相同的问题。

任何帮助，将不胜感激。

谢谢。

### 编辑：

### 魔术行情未开启。请不要建议关闭它。这不是问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-06T05:00:22.650

您移动的主机可能已`magic_quotes_runtime`打开。您可以使用 将其关闭`set_magic_quotes_runtime(0)`。

请关闭`magic_quotes_runtime`，然后更改您的代码以使用绑定变量，而不是使用字符串转义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-19T10:40:22.703

我可以想到许多可能导致这种情况的事情。但这取决于您如何调用 SQL 查询。如果您转而使用 PDO 之类的参数化查询，则不需要转义，这意味着调用`mysql_real_escape_string`添加了额外的斜杠。

如果您正在使用`mysql_query`等，那么必须有一些类似的代码`addslashes`正在执行此操作。这可能是在数据进入数据库之前或之后。

您还说您禁用了魔术引号...如果您还没有，只需使用以下代码仔细检查代码：

```
echo htmlentities($_GET['value']); // or $_POST, whichever is appropriate 
```

确保该值中没有斜杠，然后还要检查：

```
echo "Magic quotes is " . (get_magic_quotes_gpc() ? "ON" : "OFF"); 
```

我知道您多次说过这不是魔术引号，但对于我们这些试图提供帮助的人来说，我们需要确保您检查了实际的 PHP 输出，而不仅仅是更改配置（这可能不起作用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T06:50:39.933

听起来好像您打开了魔术引号。关闭它并不难：只需在你的根目录中创建一个名为的文件`.htaccess`并将此行放入其中：

```
php_flag magic_quotes off 
```

如果由于某种原因无法做到这一点，或者您想更改应用程序以处理魔术引号，请使用以下技术：

不要直接访问请求变量，而是使用函数。然后，该函数可以检查魔术引号是打开还是关闭，并相应地去除斜线。简单地在所有东西上运行 stripslashes() 是行不通的，因为你会摆脱你真正想要的斜线。

```
function getVar($key) {
    if (get_magic_quotes_gpc()) {
        return stripslashes($_POST[$key]);
    } else {
        return $_POST[$key];
    }
}

$x = getVar('x'); 
```

现在你已经知道了，你所有的传入变量都准备好再次被转义，并且`mysql_real_escape_string()`不会把它们塞满。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-11T09:12:16.060

> 斜线保留在数据库中。

这意味着您的数据被双重转义。

有2个可能的原因：

1.  尽管您有感觉，但魔术报价**仍在播放。**仔细检查一下

2.  您的应用程序中有一些代码，它们只是模仿魔术引号行为，转义所有输入。
    这是一个非常常见的误解，即拥有一个通用的转义功能来“保护”所有传入的数据。虽然它根本没有好处，但它也对这种情况负责。
    如此 - 只需找到该功能并将其清除即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T19:56:11.017

您可能必须打开魔术引号。弄清楚如何关闭它在 PHP 中可能是一件非常头疼的事情。虽然您可以使用 关闭魔术引号`set_magic_quotes_runtime(0)`，但这还不够——魔术引号此时已经更改了输入数据，因此您必须撤消更改。试试这个片段：[http ://talks.php.net/show/php-best-practices/26](http://talks.php.net/show/php-best-practices/26)

或者更好——禁用 .htaccess 中的魔术引号`php.ini`，以及它可能设置的任何 .htaccess 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-12T17:26:15.457

我不确定我是否正确理解了这个问题，但我遇到了同样的问题。无论我做什么，当字符串逃脱时，斜线就在那里。因为我需要插入的值与输入的格式完全相同，所以我使用了

```
htmlentities($inserted_value) 
```

这将使所有插入的引号不转义但无害。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-11T09:28:55.907

`mysql_real_escape_string()`您在同一个 var 上多次使用的问题（与我们有关）可能是什么问题。当您多次使用它时，它会添加斜杠。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-01T19:27:53.113

Function below will correctly remove slashes *before* inserting into the database. I know you said magic quotes isn't on but something is adding slashes so try the following page and see the output. It'll help figure out where. Call with page.php?var=something-with'data_that;will`be|escaped

You will most likely see number three outputting more slashes than needed.

*Change the db details too.

```
<?php

$db = mysql_connect('host', 'user', 'pass');

$var = $_REQUEST['var'];
echo "1: $var :1<br />";
echo "2: ".stripslashes($var)." :2<br />";
echo "3: ".mysql_real_escape_string($var)." :3<br />";
echo "4: ".quote_smart($var)." :4<br />";

function quote_smart($value)
{
    // Stripslashes is gpc on
    if (get_magic_quotes_gpc())
    {
        $value = stripslashes($value);
    }
    // Quote if not a number or a numeric string
    if ( !is_numeric($value) )
    {
        $value = mysql_real_escape_string($value);
    }
    return $value;
} 
```

?>

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2008-10-06T04:57:32.140

`mysql_real_escape_string($str);`应该正是这样做的。它旨在为特殊字符添加反斜杠，尤其是当您要将查询传递给 mysql 时。注意，它还考虑了mysql的字符集。

为了更安全的编码实践，最好编辑您的代码并用于`stripslashes()`读出数据并删除斜线。

# php - php-cgi 以 root 身份运行

> ID：173219
> 
> 赞同：1
> 
> 时间：2008-10-06T04:40:05.203
> 
> 标签：php, fastcgi, lighttpd

我在 lighttpd 1.4 下将 php 5.2.6 作为 cgi 运行，出于某种原因，它始终以 root 身份运行。里面的所有php-cgi进程都归root所有，所有写入文件系统的文件都归root所有。

我已经尝试将 lighttpd 中的用户设置为非特权用户，并确认它运行正常，只是 php 以 root 身份运行。

我将如何设置 php-cgi 以作为更安全的用户运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T07:50:22.620

1.  确保 ：

    ```
    server.username            = "nonprivuser"
    server.groupname           = "nonprivgroup" 
    ```

2.  停止 lighttpd。

3.  检查现有的 php 进程并杀死它们。
4.  启动 lig​​httpd
5.  检查 php 进程是否以非 priv 身份运行

如果 php 仍然以 root 身份运行，那么你可能有一个 SETUID 脚本加载它们（你真的不应该，但它是可行的）

如果是这种情况，请检查文件 'bin-path' 指的是没有任何时髦的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T04:47:18.807

您可能有一个以 root 身份在服务器上启动的 fastcgi 进程。如果是这种情况，那么 fastcgi 进程将继续运行从 lighttpd 调用的 php 进程。

我建议杀死服务器上的 fastcgi 进程并重新启动 lig​​httpd。

您可能还想查看可能启动 fastcgi 守护程序的任何启动脚本。

# css - 什么会导致 Internet Explorer 6 中的图像加载间歇性问题？

> ID：173224
> 
> 赞同：2
> 
> 时间：2008-10-06T04:45:15.210
> 
> 标签：css, image, internet-explorer-6, background-image

我正在处理的网站出现问题，其中图像和背景图像无法在 Internet Explorer 6 中加载。

以下是您可能会遇到此问题的页面示例：

[示例页面](http://www.infinitieurope.com/aboutinfiniti/environment/infiniti-environment.html)

到目前为止，我已经研究了以下可能的问题，并且几乎排除了它们：

*   图像文件中的 XML/无关数据（google photoshop 7 Internet Explorer）
*   损坏的图像文件

我没有排除无效标记。

我注意到在报告此问题的大多数页面中都存在验证错误，我正在努力在适当的情况下修复这些错误。

我看到的行为是页面将加载并且除背景图像之外的所有元素都会呈现。没有抛出 javascript 错误。使用 Fiddler 时，不会请求图像。如果浏览器直接指向背景图像，缓存被清除，然后浏览器指向 HTML 页面，背景图像将加载到 HTML 页面中。

是否有人对解决此问题的方法有任何其他建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T04:53:22.603

现在有两次有人遇到照片无法显示的问题，这是因为他们使用了不正确的色彩空间，使用 CMYK 而不是 RGB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T05:01:38.530

这是 IE6 的一个奇怪问题。我只需右键单击图像并选择“显示图片”即可正确加载图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T14:01:20.030

我正在 IE6 中查看此问题并尝试复制该问题，但我似乎无法让它发生 - 它似乎总是在加载。

尽管似乎还有另外两个背景被覆盖的类，但对要尝试的事情的一些想法是尝试在背景分配之后添加 !important ，因此：

```
div.gBodyContainer {
background-image:url(/etc/medialib/europe/about_infiniti/environment.Par.7366.Image.964.992.direct.jpg); !important
} 
```

另一件要尝试的事情是摆脱所有 . 在文件名中并减少它的长度，应该没关系，但它可能会导致一些问题，无论如何尝试它都没有坏处。

您可以尝试的另一件事是让 gBodyContainer 成为 ID 而不是类，或者给它一个 ID 和一个类并将背景分配给 ID。同样，这不重要，但尝试看看它是否有效也没有什么坏处，IE6 做了很多有趣的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T04:50:26.587

是只有ie6而不是ie7吗？IE 有时对 html 非常严格，而 firefox 则可以让您摆脱更多。不确定这是否有帮助，但我只是通过慢慢删除内容来调试奇怪的 IE6/7 错误。但如果它只是断断续续的，就像打开和关闭相同的代码那样，那真的很奇怪。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T12:49:31.767

问题是“IE6”部分;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-05T15:22:32.743

我认为在某些情况下，您可以通过在请求之前加载全尺寸图像并使用样式隐藏它来解决此问题，`display: none;`以便 IE6 将从缓存中加载图像。

# c - 应该包含什么库才能使用 TransparentBlt？

> ID：173241
> 
> 赞同：0
> 
> 时间：2008-10-06T05:05:57.257
> 
> 标签：c, winapi, linker, gdi, visual-studio-6

应该包含什么库才能使用 TransparentBlt？

这是链接到 Gdi32.lib 的 VC98 (Visual Studio 6)。（其他 GDI 函数，如预期的 BitBlt 链接），编译器编译时没有错误或警告。

即使包含 Gdi32.lib，链接器仍会返回此错误：

```
mtcombo.obj：错误 LNK2001：无法解析的外部符号 __imp__TransparentBlt@44
C:\Work\Montel\Targ2_12\guitest.exe : 致命错误 LNK1120: 1 unresolved externals

```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T05:12:48.617

AFAIK，您将需要 Msimg32.lib

[http://msdn.microsoft.com/en-us/library/ms532303(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms532303(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T05:13:24.590

Msimg32.lib

[仅供参考，您可以在http://msdn.microsoft.com/library](http://msdn.microsoft.com/library)上搜索函数，在底部它会告诉您您需要什么库。

# c# - 使用C#中断正在运行的进程后如何在命令行窗口中继续执行其他进程

> ID：173242
> 
> 赞同：-1
> 
> 时间：2008-10-06T05:06:04.073
> 
> 标签：c#, command-line

我已经编写了 C# 命令窗口应用程序。我在 main() 内的命令行上运行了一堆进程。例如

```
void main()
{
    process p1 = new process()
    set p1 properties
    p1.start()
 -->p1.StandardInput.WriteLine("start /WAIT cmd.exe /c BUILD -cZP");
} 
```

这一行将在一个新的命令窗口中执行一些程序。在执行最后一行时，我将使用 ctrl+c 中断此执行并将控制权返回给主程序的执行。

循环输出到执行窗口。

```
p1.StandardInput.WriteLine("Done some action"); 
p1.WaitForExit();
p1.Close(); 
```

上面三行没有执行。问题是 p1 永远不会关闭执行程序中的以下行。

```
process p2 = new process()
...
p2.waitforExit()
p2.close. 
```

对上述挑战的任何见解都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T05:13:05.853

如果我正确理解你（我承认我可能不理解你），我相信问题是当你按`CTRL`-`C`进入进程 p1 时，你实际上是在杀死那个进程。然后，您尝试将文本发送到刚刚被终止的进程的标准输入。由于该进程不再可用于接受您的输入，因此主程序挂起。这是我最好的猜测。

# php - 解析和生成 Microsoft Office 2007 文件（.docx、.xlsx、.pptx）

> ID：173246
> 
> 赞同：13
> 
> 时间：2008-10-06T05:07:19.250
> 
> 标签：php, python, perl, parsing, office-2007

我有一个 Web 项目，我必须从用户提供的文档中导入文本和图像，其中一种可能的格式是 Microsoft Office 2007。还需要生成这种格式的文档。

服务器运行 CentOS 5.2 并安装了 PHP/Perl/Python。如果必须，我可以执行本地二进制文件和 shell 脚本。我们使用 Apache 2.2，但一旦上线就会切换到 Nginx。

我有哪些选择？有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-06T06:10:41.340

Office 2007 文件格式是开放的并且[有据可查](http://msdn.microsoft.com/en-us/library/aa338205.aspx)。粗略地说，所有以“x”结尾的新文件格式都是 zip 压缩的 XML 文档。例如：

> 打开 Word 2007 XML 文件 创建一个临时文件夹，用于存储文件及其部分。
> 
> 将包含文本、图片和其他元素的 Word 2007 文档另存为 .docx 文件。
> 
> 在文件名末尾添加 .zip 扩展名。
> 
> 双击该文件。它将在 ZIP 应用程序中打开。您可以看到组成文件的部分。
> 
> 将部件提取到您之前创建的文件夹中。

其他文件格式大致相似。我还不知道有任何开源库可以与它们进行交互——但根据您的具体要求，阅读和编​​写简单的文档看起来并不难。当然，它应该比旧格式容易得多。

如果您需要阅读较旧的格式，OpenOffice 有一个 API，可以读取和写入 Office 2003 和较旧的文档，或多或少成功。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-30T12:13:58.640

python docx 模块可以从纯 Python 生成格式化的 Microsoft Office docx 文件。开箱即用，它处理标题、段落、表格和项目符号，但 makeelement() 模块可以扩展为处理任意元素，如图像。

```
from docx import *
document = newdocument()

# This location is where most document content lives 
docbody = document.xpath('/w:document/w:body',namespaces=wordnamespaces)[0]

# Append two headings
docbody.append(heading('Heading',1)  )   
docbody.append(heading('Subheading',2))
docbody.append(paragraph('Some text') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T06:30:25.823

我已在项目中成功使用[OpenXML 格式 SDK](http://msdn.microsoft.com/en-us/library/bb448854.aspx)通过代码修改 Excel 电子表格。这将需要 .NET，我不确定它在 Mono 下的效果如何。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T05:56:07.593

您可能可以检查[Sphider](http://www.sphider.eu/)的代码。他们提供文档和 pdf，所以我相信他们可以阅读。也可能会引导您走向其他 Office 格式的正确方向。

# iphone - 如何让我的临时 iPhone 应用程序的图标显示在 iTunes 中？

> ID：173247
> 
> 赞同：44
> 
> 时间：2008-10-06T05:07:32.730
> 
> 标签：iphone, icons, itunes, packaging, software-distribution

我有一个带有图标文件 Icon.png 的 iPhone 应用程序。

当应用程序位于手机本身时，此图标会正确显示，但不会显示在 iTunes 的应用程序窗格中。

我需要做什么才能让它正确显示？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-14T12:22:42.733

执行此操作的最简洁方法在 Apple 官方文档中的一个名为[Publishing Applications for Testing](http://developer.apple.com/iphone/library/documentation/Xcode/Conceptual/iphone_development/145-Publishing_Applications_for_Testing/user_testing.html#//apple_ref/doc/uid/TP40007959-CH10-SW7)的部分中进行了描述。以下是该页面上提供给您的确切说明：

* * *

您的测试人员看到的 iTunes 艺术作品应该是您的应用程序的图标。此作品必须是名为**iTunesArtwork**的 512 x 512 JPEG 或 PNG 文件。请注意，该文件**不得有扩展名**。

生成应用程序图标的文件后，按照以下步骤将其添加到您的应用程序中：

1.  在 Xcode 中打开您的项目。
2.  在组和文件列表中，选择资源组。
3.  选择“项目”>“添加到项目”，导航到您的 iTunesArtwork 文件，然后单击“添加”。
4.  在出现的对话框中，选择“复制项目”选项并单击添加。

* * *

请注意，PNG 或 JPEG 文件只是“iTunesArtwork”，没有后缀。

如果您在构建文件后尝试将文件复制到应用程序包中，则会破坏应用程序签名，并且在尝试将其同步到您的设备时会出现验证错误。确保艺术品文件包含在“复制捆绑资源”文件夹中，在 XCode 中的项目目标中（上面的第 4 步）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-28T02:29:50.707

为您的图标创建一个 512x512 png，将其命名为“iTunesArtwork”（无扩展名，无引号）并将其添加到资源下的项目中。然后构建。

更多细节在这里：

[http://developer.apple.com/library/ios/#documentation/Xcode/Conceptual/ios_development_workflow/000-Introduction/introduction.html](http://developer.apple.com/library/ios/#documentation/Xcode/Conceptual/ios_development_workflow/000-Introduction/introduction.html)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-27T17:44:08.240

为了让那些到达这篇文章的人更容易，这里是实际的说明（直接来自接受的答案链接的博客文章）。

* * *

推特上有一些关于如何为你的 iPhone 应用程序创建自己的 IPA 文件的讨论，所以我想我会给出我以前用来构建 IPA 的说明。享受。

1.  在桌面上创建一个名为“working”的文件夹。打开它并在其中创建另一个名为“Payload”的文件夹（区分大小写）
2.  将 iTunesArtwork 文件移动到“工作”文件夹，将 .app 移动到 Payload 文件夹。
3.  打开终端并运行以下命令： chmod -R 775 ~/Desktop/working/Payload
4.  进入 Payload 中的 ProgName.app 文件夹。
5.  双击 Info.plist 文件。确保有一个名为：SignerIdentity 的项目，其值为：Apple iPhone OS 应用程序签名。如果没有，添加它。
6.  全部拉上拉链。压缩 iTunesArtwork 和 Payload 文件夹。（所以压缩工作文件夹内的内容）
7.  将 zip 文件重命名为您想要的名称，以及 ipa 的扩展名。
8.  双击以使用 iTunes 安装

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-06T10:26:36.860

实际上，可以为临时发布的 iPhone 软件提供 iTunes 图标。有关更多信息，请参阅此[博客文章](http://codegenocide.com/2008/09/28/create-your-own-ipa-file/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-29T03:47:58.670

我只是补充一下我最近的经历。我试图让我的临时应用程序在 iTunes 中显示一个图标（严格来说是 iTunesArtwork）。最后，我确信我已按照“T”的说明进行操作，但它仍然不会出现在网格视图中。但是，我的作品在 Cover Flow 视图中正确显示。我从 iTunes 删除并重新安装了我的应用程序，但无济于事。然后我退出 iTunes 并重新启动 - 而且，瞧！- 我的作品在所有地方都是正确的。似乎有某种缓存未在网格视图中重置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-08T02:44:09.080

如果您在 iTunes 中看到一个黑色方块而不是您的图标，请确保 Xcode 中的 iTunesArtwork 文件类型不是“image.png”。如果是这样，在复制资源构建阶段，CopyPNGFile 将崩溃为 iOS 设备无效保存的文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-29T07:18:22.913

1.  在 Xcode 中打开您的项目。
2.  将 iTunesArtwork.png 文件复制到项目文件夹中。
3.  编辑 iTuneArtwork.png 文件并从 iTunesArtwork 中删除 .png。
4.  生成构建。

您可以在 iTunes 上看到图像。

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2008-10-06T05:32:01.980

如果您的应用程序是通过应用程序商店分发的，则应用程序图标只会显示在 iTunes 中。

我假设您正在询问开发人员或临时构建。那些获得默认的黑色“A”图标。

# id3 - 编写ID3v2 Tag解析代码，需要好的例子来测试

> ID：173257
> 
> 赞同：1
> 
> 时间：2008-10-06T05:20:20.643
> 
> 标签：id3

我正在编写软件来解析 Java 中的 ID3v2 标签。我需要找到一些带有很多不同帧的标签的好例子的文件。理想情况下，标签将包含嵌入的图片，因为这就是我现在最讨厌的东西。

有谁知道我在哪里可以找到一些好的免费（合法）ID3v2 标记文件（ID3v2.2 和 ID3v2.3）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T06:54:06.807

您可以自己创建带有标记器的示例文件。我是 Windows 免费软件标记器[Mp3tag](http://www.mp3tag.de/en/)的作者，它能够以 UTF-8 编写 ID3v2.3（UTF-16 和 ISO-8859-1）和 ID3v2.4 标记（都与 APIC 帧一起）。[您可以在此处](http://mp3tag.de/en/help/main_tags.html)找到支持的框架列表。

要创建 ID3v2.2 标签，我认为唯一的程序是 iTunes，它以自己的方式解释 ID3 规范并编写许多不在规范中的 iTunes 特定帧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T05:31:46.690

这可能是显而易见的，而不是您想要的，但是翻录一些合法获得的 CD 并使用 iTunes 编辑它们呢？iTunes 还允许您添加嵌入的图片。当然有很多开源程序也可以做到这一点。

# image-processing - 使用 DirectX 调整图像大小的示例代码

> ID：173258
> 
> 赞同：0
> 
> 时间：2008-10-06T05:21:00.830
> 
> 标签：image-processing, directx

我知道这是可能的，而且比使用 GDI+ 快得多。但是，我还没有找到任何使用 DirectX 调整图像大小并将其保存到磁盘的好例子。我在 GDI+ 中一遍又一遍地实现了这一点，这并不难。但是GDI+没有使用任何硬件加速，我希望通过接入显卡来获得更好的性能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T09:26:52.253

您可以将图像加载为纹理，将其纹理映射到四边形并在屏幕上以任意大小绘制该四边形。这将进行缩放。之后，您可以从屏幕上获取像素数据，将其存储在文件中或进一步处理。

这简单。可以调整 SDK 附带的基本纹理 DirectX 示例来执行此操作。

但是，它*很*慢。不是渲染本身，而是像素数据从屏幕到内存缓冲区的传输。

恕我直言，只需编写一小段代码，使用双线性缩放从一个缓冲区到另一个缓冲区来调整图像大小，会更简单、更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T09:30:47.957

你真的需要使用 DirectX 吗？GDI+ 在调整图像大小方面做得很好。在 DirectX 中，您实际上并不需要调整图像大小，因为您很可能会将图像显示为纹理。由于纹理只能应用于 3d 对象（三角形/多边形/网格），因此 3d 对象和视口的大小决定了显示的实际图像大小。如果您需要在 3d 对象内缩放纹理，只需播放纹理坐标或矩阵。

要操纵纹理，您可以使用 alpha 混合、遮罩和各种纹理操纵技术，如果这是您要寻找的。要像 GDI+ 那样操作单个像素，我仍然认为 GDI+ 是可行的方法。DirectX 从来没有被修补来进行图像处理。

# ms-word - Apache POI HWPF - 将表格输出到 Microsoft Word

> ID：173260
> 
> 赞同：3
> 
> 时间：2008-10-06T05:23:37.440
> 
> 标签：ms-word, apache-poi

我已经在谷歌上搜索了很长时间，但还没有找到明确的答案。是否可以使用 Apache POI 输出表？看起来它还没有实现，因为主要开发人员像 5 年前一样停止了它的工作。

是否有可以做到这一点的 POI 的开源替代品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T07:13:58.717

I think you're right in that Apache POI is dead in the water. Clearly it wasn't glamourous enough.

The only alternative that I'm aware of is [iText](http://itextdocs.lowagie.com/tutorial/rtf/index.php), which can generate RTF documents, which MS Word (and every other similar application) can read. It includes full table support.

And, of course, iText can generate PDF also.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T02:31:51.240

如果 docx 和 java 都适合您，请尝试[docx4j](http://dev.plutext.org)

# hook - 在 Windows 上从用户空间挂钩系统调用

> ID：173265
> 
> 赞同：2
> 
> 时间：2008-10-06T05:31:16.083
> 
> 标签：hook, code-injection, patch

我正在修补 connect() 以将网络流量重定向为库（[NetHooker](http://www.assembla.com/wiki/show/nethooker)）的一部分，这很好用，但它取决于 ws2_32.dll 保持不变并且如果直接使用系统调用则不起作用。所以我想知道是否有办法在没有驱动程序的情况下捕获系统调用本身。有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T19:37:15.857

科迪，

您可能希望考虑编写分层服务提供程序，而不是系统调用挂钩。

[http://www.microsoft.com/msj/0599/LayeredService/LayeredService.aspx](http://www.microsoft.com/msj/0599/LayeredService/LayeredService.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T23:04:09.030

Cody，也许你可以看看[http://research.microsoft.com/en-us/projects/detours/](http://research.microsoft.com/en-us/projects/detours/)

另外，我写了一些代码，给定 dll 导出的名称将通过修补内存中的图像将其重定向到另一个函数指针，如果你想要代码，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:06:31.297

除了[Detours](http://research.microsoft.com/en-us/projects/detours/)库，你还可以看看[easyhook](http://code.google.com/p/easyhook-continuing-detours/)库。这两个库都旨在修补内存中的图像。

# directx - Direct3D 相机纵横比/缩放问题

> ID：173269
> 
> 赞同：2
> 
> 时间：2008-10-06T05:33:01.900
> 
> 标签：directx, direct3d

我正在使用 SlimDX/C# 编写 Direct3D 应用程序。我按照文本框的方式配置了相机：

```
private float cameraZ = 5.0f;
camera = new Camera();
camera.FieldOfView =(float)(Math.PI/2);
camera.NearPlane = 0.5f;
camera.FarPlane = 1000.0f;
camera.Location = new Vector3(0.0f, 0.0f, cameraZ);
camera.Target = Vector3.Zero;
camera.AspectRatio = (float)InitialWidth / InitialHeight; 
```

`Matrix.RotationYawPitchRoll`画法和旋转法都不错`mesh.DrawSubset(0)`。其他一切看起来都很正常。

我的问题是我的 3d 网格（薄方形框），当从侧面看并垂直站立时，它看起来比水平时更厚。我试图将其更改`AspectRatio`为 1，情况更糟。所以通过反复试验，我发现它`AspectRatio`在 2.6 左右时看起来很正常。为什么会这样，可能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T07:18:16.430

我已经弄清楚了问题并回答了。

显然我确实缩放了网格，并匹配了纵横比，并在 Matrix.RotationYawPitchRoll 之后应用了 Matrix.Scaling。当我将网格面朝前旋转时，我才意识到无论垂直还是水平它看起来都一样，缩放正在横向拉伸它，而不管我如何旋转。交换 2 矩阵确实解决了我的问题。不管怎么说，还是要谢谢你

# c# - C#/.NET，看什么？

> ID：173272
> 
> 赞同：1
> 
> 时间：2008-10-06T05:35:19.663
> 
> 标签：c#

我看到很多 C#/.NET 程序员的招聘广告，所以我认为看看它可能是个好主意。

在看了一些教程后，我发现对我来说没有什么新东西。只是一种语法介于 Java 和 C++ 之间的语言（可以说比两者都好）。

那么，我应该特别关注哪些功能？有哪些特别之处？C#/.NET 这么大的原因是什么？有哪些杀手级功能，或者可能是一些非常邪恶的语言陷阱？

非常欢迎链接和代码示例。

我在 Linux 上使用 Mono 实现。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T05:40:01.883

.Net Framework 库比语言更重要。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-06T06:28:53.690

与Java相比：

*   “使用”语句（try/finally 在 C# 中很少显式）（C# 1）
*   代表作为一流的概念 (C# 1)
*   属性和事件作为一流的概念 (C# 1)
*   用户定义的值类型 (C# 1)
*   运算符重载（小心使用！）（C# 1）
*   迭代器块 (C# 2)
*   没有类型擦除的泛型 (C# 2)
*   匿名方法 (C# 2)
*   部分类型（适用于代码生成）（C# 2）
*   对象和集合初始化器 (C# 3)
*   Lambda 表达式 (C# 3)
*   扩展方法 (C# 3)
*   表达式树 (C# 3)
*   查询表达式（又名查询理解）（C# 3）
*   匿名类型（主要用于查询表达式）（C# 3）

无论如何，当我用 Java 编写时，它们是我在 C# 中错过的东西。（当然，这不是一个详尽的差异列表。）当然，哪些对您最重要是主观的。从简单的“完成工作”的角度来看，该`using`语句可能是最大的实用收获，即使它只为您构建了一个 try/finally 块。

编辑：有关 C# 2 和 3 功能的快速示例，您可能需要查看我[的 Bluffer's Guide to C# 2](http://csharpindepth.com/Articles/General/BluffersGuide2.aspx)和[C# 3 的等价物](http://csharpindepth.com/Articles/General/BluffersGuide3.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T06:38:21.907

杀手级功能：使用 Visual Studio 进行超快速 Windows 编程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T05:42:41.550

在 C# 3.0中[Linq](http://msdn.microsoft.com/en-us/netframework/aa904594.aspx)（语言集成查询）值得一看。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T06:19:03.507

异常处理、垃圾收集、反射、统一的类型系统、机器架构独立性和性能是 .NET CLR 的主要优势。基类库非常全面且易于理解。C# 和 VB.NET 都是在这个平台上构建应用程序的一流语言。考虑学习两者。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T05:47:40.607

你可以在这里找到一些不那么明显的功能

[C#的隐藏特性？](https://stackoverflow.com/questions/9033/hidden-features-of-c)

是的，框架是最大的卖点。

# python - 有没有办法防止从 sys.exit() 引发的 SystemExit 异常被捕获？

> ID：173278
> 
> 赞同：67
> 
> 时间：2008-10-06T05:40:13.943
> 
> 标签：python, exception, exit, systemexit

文档说调用 sys.exit() 会引发一个 SystemExit 异常，该异常可以在外部级别中捕获。我有一种情况，我想明确且毫无疑问地从测试用例内部退出，但是 unittest 模块捕获了 SystemExit 并阻止了退出。这通常很好，但我试图处理的具体情况是我们的测试框架检测到它被配置为指向非测试数据库。在这种情况下，我想退出并阻止运行任何进一步的测试。当然，由于 unittest 捕获了 SystemExit 并愉快地继续前进，它阻碍了我。

到目前为止，我想到的唯一选择是使用 ctypes 或类似于直接调用 exit(3) 的东西，但这对于应该非常简单的东西来说似乎是一个非常丑陋的 hack。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-10-06T06:24:53.900

可以调用[`os._exit()`](https://docs.python.org/library/os.html#os._exit)直接退出，不抛出异常：

```
import os
os._exit(1) 
```

这会绕过所有 python 关闭逻辑，例如`atexit`模块，并且不会运行您在这种情况下试图避免的异常处理逻辑。参数是将由进程返回的退出代码。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-12-05T12:23:15.827

正如杰鲁布所说，`os._exit(1)`这是你的答案。但是，考虑到它绕过*了所有*清理过程，包括`finally:`块、关闭文件等，应该不惜一切代价避免它。那么我可以提出一种更安全（-ish）的使用方式吗？

如果您的问题`SystemExit`在外部级别（即单元测试）被捕获，那么您***自己就是外部级别！***将您的主要代码包装在`try`/`except`块中，catch`SystemExit`并在那里调用`os._exit()`，*而且**只有**那里！*这样你就可以`sys.exit`在代码的任何地方正常调用，让它冒泡到顶层，优雅地关闭所有文件并运行所有清理，*然后*调用`os._exit`.

您甚至可以选择哪些出口是“紧急”出口。下面的代码是这种方法的一个例子：

```
import sys, os

EMERGENCY = 255  # can be any number actually

try:
    # wrap your whole code here ...
    # ... some code
    if x: sys.exit()
    # ... some more code
    if y: sys.exit(EMERGENCY)  # use only for emergency exits
    ...  # yes, this is valid python!

    # Might instead wrap all code in a function
    # It's a common pattern to exit with main's return value, if any
    sys.exit(main())

except SystemExit as e:
    if e.code != EMERGENCY:
        raise  # normal exit, let unittest catch it at the outer level
else:
    os._exit(EMERGENCY)  # try to stop *that*! 
```

至于`e.code`一些读者不知道的，它被[记录在案](https://docs.python.org/3/library/exceptions.html#SystemExit)，以及所有内置异常的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-20T21:18:30.267

您也可以使用退出，请参见下面的示例：

```
while True:
print('Type exit to exit.')
response = input()
if response == 'exit':
    quit(0)
print('You typed ' + response + '.') 
```

# python - python字典更新方法

> ID：173290
> 
> 赞同：18
> 
> 时间：2008-10-06T05:53:32.980
> 
> 标签：python, dictionary, variables

我有一个列表字符串标签。

我正在尝试使用键作为标记字符串和值作为数组索引来初始化字典。

```
for i, ithTag in enumerate(tag):
    tagDict.update(ithTag=i) 
```

以上返回我 {'ithTag': 608} *608 是第 608 个索引*

我的问题是，当 i 被解释为变量时，Python 将“ithTag”视为字符串而不是变量。

我很困惑，谷歌搜索这些具体问题有点困难。我希望我正确地措辞了这个问题的标题，

谢谢！

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-06T06:05:00.257

你实际上想要这样做：

```
for i, tag in enumerate(tag):
    tagDict[tag] = i 
```

.update() 方法用于使用另一个字典更新字典，而不是用于更改单个键/值对。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-06T06:41:44.507

如果你想变得聪明：

```
tagDict.update(map(reversed, enumerate(tag))) 
```

感谢布赖恩的更新。这显然比迭代版本快约 5%。

（编辑：感谢 saverio 指出我的答案不正确（现已修复）。可能最有效/Pythonic 的方式是 Torsten Marek 的答案，稍作修改：

```
tagDict.update((t, i) for (i,t) in enumerate(tag)) 
```

)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-07T15:22:22.300

这是一个单行：

```
tagDict = dict((t, i) for i, t in enumerate(tag)) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T06:05:05.470

我认为这是你想要做的：

```
d = {}
for i, tag in enumerate(ithTag):
   d[tag] = i 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T06:05:28.307

尝试

```
tagDict[ithTag] = i 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-12T20:24:27.337

我想你想要的是这样的：

```
for i, ithTag in enumerate(tag):
    tagDict.update({ithTag: i}) 
```

# .net - 右键单击以选择 datagridview 行

> ID：173295
> 
> 赞同：9
> 
> 时间：2008-10-06T05:58:55.763
> 
> 标签：.net, datagridview

如何在右键单击时选择 datagridview 行？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-02T12:38:51.863

让它的行为类似于鼠标左键？例如

```
private void dataGridView_CellMouseDown(object sender, DataGridViewCellMouseEventArgs e)
{
    if (e.Button == MouseButtons.Right)
    {
        dataGridView.CurrentCell = dataGridView[e.ColumnIndex, e.RowIndex];
    }
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-06T06:19:19.090

```
 // Clear all the previously selected rows
    foreach (DataGridViewRow row in yourDataGridView.Rows)
    {
      row.Selected = false;
    }

    // Get the selected Row
    DataGridView.HitTestInfo info = yourDataGridView.HitTest( e.X, e.Y );

    // Set as selected
    yourDataGridView.Rows[info.RowIndex].Selected = true; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-16T10:07:14.683

很酷的事情是在右键单击时添加一个菜单，例如“查看客户信息”、“验证最后一张发票”、“向该客户添加日志条目”等选项。

您只需要添加一个 ContextMenuStrip 对象，添加您的菜单项，然后在 DataGridView 属性中选择它的 ContextMenuStrip。

这将在用户右键单击所有选项的行中创建一个新菜单，然后您需要做的就是施展魔法:)

请记住，您需要 JvR 代码来获取用户所在的行，然后抓取包含客户端 ID 的单元格并传递该信息。

希望它有助于改进您的应用程序

[http://img135.imageshack.us/img135/5246/picture1ku5.png](http://img135.imageshack.us/img135/5246/picture1ku5.png)

[http://img72.imageshack.us/img72/6038/picture2lb8.png](http://img72.imageshack.us/img72/6038/picture2lb8.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-06T17:08:35.897

子类化`DataGridView`并为网格创建一个`MouseDown`事件，

```
 private void SubClassedGridView_MouseDown(object sender, MouseEventArgs e)
{
    // Sets is so the right-mousedown will select a cell
    DataGridView.HitTestInfo hti = this.HitTest(e.X, e.Y);
    // Clear all the previously selected rows
    this.ClearSelection();

    // Set as selected
    this.Rows[hti.RowIndex].Selected = true;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-10T03:27:35.643

从`@Alan Christensen`代码转换为 VB.NET

```
Private Sub dgvCustomers_CellMouseDown(sender As Object, e As DataGridViewCellMouseEventArgs) Handles dgvCustomers.CellMouseDown
    If e.Button = MouseButtons.Right Then
        dgvCustomers.CurrentCell = dgvCustomers(e.ColumnIndex, e.RowIndex)
    End If
End Sub 
```

我在 VS 2017 上进行了测试，它对我有用！！！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-07-31T09:24:13.153

```
If e.Button = MouseButtons.Right Then
            DataGridView1.CurrentCell = DataGridView1(e.ColumnIndex, e.RowIndex)
End If 
```

代码也适用于 VS2019

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T12:58:22.713

您可以在 DataGridView 的 MouseDown 事件中使用 JvR 的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T15:07:29.230

你必须做两件事：

1.  清除所有行并选择当前行。我遍历所有行并`i = e.RowIndex`为此使用布尔表达式

2.  如果您完成了第 1 步，您仍然有一个很大的陷阱：
    DataGridView1.CurrentRow 不会返回您之前选择的行（这很危险）。由于 CurrentRow 是只读的，你必须这样做

    `Me.CurrentCell = Me.Item(e.ColumnIndex, e.RowIndex)`

    ```
    Protected Overrides Sub OnCellMouseDown(
        ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs)

        MyBase.OnCellMouseDown(e)

        Select Case e.Button
            Case Windows.Forms.MouseButtons.Right
                If Me.Rows(e.RowIndex).Selected = False Then
                    For i As Integer = 0 To Me.RowCount - 1
                        SetSelectedRowCore(i, i = e.RowIndex)
                    Next
                End If

                Me.CurrentCell = Me.Item(e.ColumnIndex, e.RowIndex)
        End Select

    End Sub 
    ```

# java - 开始使用移动编程。什么是好的平台？

> ID：173298
> 
> 赞同：6
> 
> 时间：2008-10-06T06:01:45.040
> 
> 标签：java, android, c++

对于`c++`开发人员来说，什么是好的移动编程平台？

学习`android`是一个好的选择吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T08:46:15.643

If you already know C++ then Symbian has the largest install base, and isn't sandboxed like java/android vm/iphone.

Whilst the iPhone and Andriod may seem interesting, if you actually look at the figures Symbian really is the only option when looking at market share. Despite apple's advertising behemoth and cult following, it is far from being anywhere near the 200+ million Symbian smart phones out there. (there are approx 5 million iphone users).

Added to the fact that "java" on mobiles doesn't always mean the same thing. Different phones include different versions so unlike the PC environment, java on mobiles is not as "write once, run anywhere" as it makes out.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T07:19:59.733

[我已经开始使用最新的 SDK](http://code.google.com/android/download.html)玩 Android 了。由于Java的酷炫，android平台的丰富性和[eclipse IDE](http://www.eclipse.org/downloads/)非常易于使用，因此开发起来非常容易。我认为 Android 将在 moile 应用程序方面产生重大影响。

更新：现在您也可以选择 Windows Phone 7，这是我目前最喜欢的，因为我是多年的 .NET 开发人员。只需获取[WP7SDK](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=04704acf-a63a-4f97-952c-8b51b34b00ce&displaylang=en)并开始在您的 Visual Studio 中进行编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T06:19:51.740

[Java ME](http://java.sun.com/javame/index.jsp)将为您提供最广泛的部署选项和市场份额选择，因为大多数手机都支持它。从 C++ 到 Java 非常容易，因为 Java 的陷阱比 C++ 少。作为一个积极的副作用，您还将在一个平台上学习 Java，该平台的占用空间比[Java SE](http://java.sun.com/javase/)小得多且易于管理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T07:19:51.357

我建议使用[.NET Compact Framework](http://en.wikipedia.org/wiki/.NET_Compact_Framework)进行简单快速的开发。Visual Studio 中包含的模拟器使开发变得更加容易。

但我也认为这取决于您的预期应用程序，例如，我不建议使用紧凑的框架来编写具有要求图形的游戏。

使用 .NET Compact Framework 的缺点是您的目标硬件会受到限制，因为它只能在 Microsoft Windows CE 版本上运行（我认为是在 SymbianOS 上）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T09:53:47.770

在 Symbian 中，您可以使用所有电话功能 == 做一些非常酷的事情，但是当您尝试从头开始学习 Symbian 时，它就是个婊子——它很复杂。

JavaME - 流行、快速启动、轻量级 API，但沙盒化，对不同手机区域的访问因供应商和型号而异。您几乎可以在每部手机上执行诸如连接网络、绘制图形和显示菜单之类的操作，但访问电话簿、相机、短信的方式差异很大

有时需要时间让应用程序在不同型号的手机上运行完全相同（我不知道确切，但我认为这在所有移动平台上都是一个问题）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T06:40:25.960

就个人而言，我从 Windows Mobile 平台和 Microsoft Embedded C++ 开始。

这是一个自然的转变，因为我来自 MSVC 编译器/Visual Studio 6 环境，所以我已经非常熟悉编译器和 IDE 的各个方面。

事实上，因为我对其他工具非常熟悉，所以拿起模拟器和（特别是）使用 ActiveSync 的奇怪之处变得容易多了。我还发现操作系统易于使用（包括熟悉的文件资源管理器和系统设计）。

因此，为了更准确地回答您的问题，我认为这取决于您之前熟悉的平台以及您对可用工具的信心。特别是对于调试和仿真！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-08T10:40:36.323

我想建议你 android 是目前所有技术中最好的技术，现在 android 手机正在急剧增加，因此开发也在增加，它可以学习任何开发人员......在互联网上，有很多教程可以教你 android 编程.. ..所以我想建议你是 android 是最好的选择...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-22T12:35:11.187

您可以尝试使用 StartJava 来说明 Android 应用程序的创建。

[http://www.en.assoft.ru/startjava](http://www.en.assoft.ru/startjava)

[https://play.google.com/store/apps/details?id=com.assoft.StartJava](https://play.google.com/store/apps/details?id=com.assoft.StartJava)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-01T07:18:19.690

你肯定需要看看 Windows Phone 7，它是 C# 并且有很好的工具支持 VS2010 和 Expression blend 来开发快速的 Windows Phone 应用程序。这不仅会使您在电话中受益。相同的开发技能集可用于轻松制作 Silverlight 和 WPF 应用程序。

# qt - QTreeView中的Qt上下文菜单中断选择

> ID：173305
> 
> 赞同：1
> 
> 时间：2008-10-06T06:10:26.270
> 
> 标签：qt, user-interface, contextmenu, qtreeview

我有一个`QTreeView`安装了上下文菜单的类，如下所示：

```
m_ui.tree->setContextMenuPolicy(Qt::CustomContextMenu);
connect(m_ui.tree, SIGNAL(customContextMenuRequested(const QPoint&)),
        this, SLOT(ShowTreeContextMenu(const QPoint&)));
...
void ShowTreeContextMenu(const QPoint& point)
{
   m_treeContextMenu->exec(m_ui.tree->viewport()->mapToGlobal(point));
} 
```

但是，当显示上下文菜单时，`QTreeView`将不再响应鼠标单击。在`QTreeView`显示上下文菜单时单击项目将删除上下文菜单，但不会选择单击的项目。

当右键单击新项目时，这尤其令人迷惑，因为上下文菜单会在新项目上弹出，但是由于未选择该项目，因此上下文菜单的内容是指先前选择的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T07:39:07.463

我尚未验证的一个可能的解决方案是捕获右键单击的单击事件，在树视图中手动进行选择，然后调用父单击事件，这将反过来激活上下文菜单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T08:03:11.720

子类化 QTreeView 并添加受保护的方法 void contextMenuEvent(QContextMenuEvent *event); 在此方法中，您执行 QMenu：

```
class TreeView : public QTreeView{
  Q_OBJECT
public:
  TreeView(QWidget *parent);
  ~TreeView();
protected:
  void contextMenuEvent(QContextMenuEvent *event);
};

void TreeView::contextMenuEvent(QContextMenuEvent *event){
  QMenu menu(this);
  menu.addAction(action1);
  menu.addAction(action2);
  //...
  menu.addAction(actionN);
  menu.exec(event->globalPos());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T08:08:39.337

你没有说你使用的是哪个版本的 Qt，但我们在 Qt4.4.0 中发现了同样的问题，它在 4.3 中有效。我们将此作为错误[225615报告给 Trolltech](http://trolltech.com/developer/task-tracker/index_html?method=entry&id=225615)

这仍然被标记为待处理，所以同时我会按照 Shy 的建议拦截右键并自己进行选择。

# installation - 最佳 Windows 安装文件创建器？

> ID：173307
> 
> 赞同：29
> 
> 时间：2008-10-06T06:11:19.513
> 
> 标签：installation, windows-installer

我不是最好的程序员，所以我发现将程序编写为几个单独的可执行文件要容易得多，它们偶尔会相互调用。但是现在我需要一种简单的方法来实际运行它们，而无需编写像运行文件一这样的详细指令，等到它完成并且在运行文件二之前不再在进程管理器中，文件三可以在文件二创建后 15 秒执行。然后将密钥添加到您的注册表。等等。我认为那里一定有一个好的软件，我可以将所有的 exe 放入其中，告诉它何时运行它们，并输出一个文件供我的客户运行。有任何想法吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-06T07:02:10.767

[Inno Setup](http://www.innosetup.com/isinfo.php)易于使用、免费、开源且可根据需要编写脚本。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-06T06:27:07.140

我一直对[NSIS有很好的体验](http://nsis.sourceforge.net/Main_Page)

*   它是开源的
*   它有一个大社区（因此有很多插件）
*   对于简单的事情，其基于脚本的方法既好又简单
*   它轻巧快速

不利的一面是，如果你想做一些更复杂的事情，你需要使用一些看起来有点像汇编语言的东西——非常奇怪，而且不是特别令人愉快。感谢您对此的评论 - 我已经忘记了这一切！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-06T09:41:33.957

**[Inno Setup](http://www.innosetup.com/isinfo.php)**简单、轻量并且覆盖了很多领域。在过去的 5 年里，我已经将它用于 5-6 个应用程序，它从未让我失望。强烈推荐！

在此之前，我使用了 InstallShield，它是这些系统之一，它非常复杂，以至于它们“提供”您“利用”他们的“专业服务”来创建您的安装。换句话说，这是一种黑客行为，它只能在 Windows 的童年时期建立客户群，因为没有竞争。它有点像 747，运行起来像 Trabant。

到目前为止，我使用过的最糟糕的安装程序产品是“WISE for Windows Installer”。这让我沮丧地把鼠标砸在办公室地板上。这是（或至少*是*，4 年前）完全是废话，应该不惜一切代价避免。这正是那些讨厌的许可协议所适用的那种软件，否则出版商将被起诉而被遗忘......

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-06T06:39:54.853

是的，有两个想法：

*   如果您正在寻找一种在客户系统上静态放置文件、注册表项、开始菜单快捷方式等的方法，您应该寻找安装程序解决方案。其中许多存在，选择最好的主要归结为功能和定价。我碰巧喜欢 Caphyon 的[Advanced Installer](http://www.advancedinstaller.com/)，它确实有一个看起来可以满足您需求的[免费软件版本，](http://advancedinstaller.com/feats-list.html)*除了*在预定时间运行可执行文件的能力（这需要仅在企业版中找到的 Windows 任务计划程序支持，这是在超昂贵的价格范围内，可与 InstallShield 相媲美...）

*   如果控制客户系统上的事件流比获取系统上的可执行文件更重要，您可能需要研究[Automise](http://www.finalbuilder.com/automise-feature-tour.aspx)，它基本上是一个用于创建脚本的超友好 UI，它使[调度任务](http://www.finalbuilder.com/at-scheduling-projects.aspx)等事情变得非常容易。

无论如何，您可以下载这两种软件的试用版，看看哪一种（或可能两者兼有）能让您以最简单的方式做您想做的事，或者至少给您一些关于如何最好地为您的客户服务的想法。事实证明，只需添加一个新的“主管”可执行文件来处理注册表项、调度等，就可以在没有任何第三方附加组件的情况下解决问题……

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T09:19:55.560

[WixEdit](http://wixedit.sourceforge.net/)是一个使用 Microsoft 的 Wix Runtime 的开源（类似安装盾牌）创作工具。

[蜡教程](http://www.tramontana.co.hu/wix/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-06T06:44:37.463

如果您除了能够安装一些可执行文件之外没有任何特定要求，那么基本上任何人都会这样做。我推荐[NSIS](http://nsis.sourceforge.net/Main_Page)，不是因为它特别容易使用（它有一种繁琐的类汇编语言，在其中做更复杂的事情并不实用），而是因为它是免费的，有一个庞大而活跃的社区，并且它以非常低的开销生成快速安装程序。作为额外的奖励，您可以在 Linux 上运行编译器（即生成安装程序的工具）。

编辑： ...无论您做什么，都**不要**使用 InstallShield。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T07:06:12.133

The ones I've worked with are:

*   InstallShield
*   NSIS
*   INNO Setup
*   Custom created installer

My preference is INNO Setup. It's free, it's easy.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T21:17:30.223

你应该看看[InstallJammer](http://www.installjammer.com/)。它不仅是免费的，而且是跨平台的并且非常易于使用。最常见的操作根本不需要任何脚本，但在底层使用强大的脚本语言，您可以让安装做任何您想做的事情。

如果您只需要一个基本的安装程序来安装您的应用程序，那么您可以在第一次启动后的几分钟内构建它。如果你想要更强大的东西，功能和文档都很棒。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-29T23:02:31.273

绝对是维克斯。:)

Wix 允许您轻松完成大多数事情，而无需 hack 即可完成最困难的事情，它是免费和开源的。

您可以在 Visual Studio 中使用 Wix（使用 Votive），也可以使用 .Net SDK、MSBuild 和您最喜欢的 XML 编辑器来使用它。Wix 支持创建 MSI 安装程序、MSP 补丁、MSM 合并模块、Wix 库等等。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-06T06:37:15.013

I heart [wix](http://wix.sourceforge.net/)是 MSFT 的开源、基于声明性 (XML) 的工具包，用于构建 MSI。

是王牌

如果您想安装二进制文件，添加 reg 键，甚至运行“自定义操作”（在安装期间执行您自己的代码），您应该看看它。然后，您将获得一键式 (msi) 解决方案。好吗？

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-10-07T02:34:09.137

如果您不追求安装程序（这听起来不像您）为什么不写一个程序来做您需要的事情？

# ruby-on-rails - Rails 框架创建的 db 表是什么样的？

> ID：173309
> 
> 赞同：1
> 
> 时间：2008-10-06T06:13:00.210
> 
> 标签：ruby-on-rails, database, model

我没有设置 Rails 环境，实际上很难找到快速答案，所以我会问专家。

当 Rails 根据您设置的“模型”创建表时，Rails 是创建一个完全反映该模型的表，还是在表中添加更多字段以帮助它发挥其魔力？如果是这样，它还添加了哪些其他字段，为什么？也许您可以剪切并粘贴表格结构，或者简单地将我指向解决此问题的文档或教程部分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T07:32:16.977

如果您正在构建一个全新的应用程序，包括一个新数据库，那么您可以通过迁移构建整个后端。跑步

```
ruby script/generate model User name:string 
```

生成模型的 user.rb 文件和迁移：

```
class CreateUsers < ActiveRecord::Migration
  def self.up
    create_table :users do |t|
      t.string :name

      t.timestamps
    end
  end

  def self.down
    drop_table :users
  end
end 
```

您可以看到，默认情况下，生成脚本会为（创建和上次更新）添加“时间戳”，如果允许它们保持存在，它们会自动管理。

不可见但重要的是，创建了一个额外的列“id”作为单个主键。不过，这不是强制性的 - 您可以在模型中指定自己的主键，如果您使用的是旧模式，这很有用。假设您保留*id*作为键，那么 Rails 将使用任何可用于新键值的 RDBMS 特定功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T06:15:29.987

在 ActiveRecord 中，模型是从数据库表中创建的，而不是相反。

您可能还想研究迁移，这是一种从 Ruby 代码描述和创建数据库的方法。但是，迁移与模型无关；该模型仍然是在运行时根据数据库的形状创建的。

Rails 站点上有与 ActiveRecord 和 Migrations 相关的截屏视频：[http ://www.rubyonrails.org/screencasts](http://www.rubyonrails.org/screencasts)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T23:51:19.277

我有一些将遗留数据库迁移到 Rails 并从外部脚本访问 Rails 数据库的经验。这听起来像你正在尝试做的事情。我的经验是建立在 MySQL 之上的 Rails 数据库，所以你的里程可能会有所不同。

一个隐藏字段是最明显的——Rails 用作其默认主键的“id”字段（一个整数）。除非您另外指定，否则 Rails 中的每个模型都有一个“id”字段，它是一个唯一的、递增的整数主键。这个“id”字段将自动出现在 Rails 通过迁移生成的任何模型中，除非您告诉 Rails 不要这样做（通过指定不同的字段作为主键）。如果您从 Rails 本身之外使用 Rails 数据库，则应注意此值。

“id”字段是 Rails 魔法的关键部分，因为它用于定义 Rails 的关联。假设您将两个表关联在一起 --- Group 和 Person。Group 模型将有一个“id”字段，而 Person 模型应该有自己的“id”字段和关系的“group_id”字段。“group_id”中的值将引用关联组的唯一 ID。如果您以遵循 Rails 约定的方式构建模型，则可以通过说 Group 模型“has_many :people”和 Person 模型“belongs_to :group”来利用 Rails 的关联。

默认情况下，Rails 迁移还希望添加“created_at”和“updated_at”字段（所谓的“时间戳”），它们是日期时间字段。默认情况下，它们利用数据库中的“魔法”——而不是在 Rails 本身中——在创建或修改记录时自动更新。我认为这些列不会让您感到困惑，因为它们应该在数据库级别进行处理，而不是通过任何特殊的 Rails 魔法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T06:24:49.110

[这](http://api.rubyonrails.com/classes/ActiveRecord/Base.html)是 ActiveRecord 的官方文档。它同意布拉德的观点。您可能已经看到了不同的访问方法或迁移（这会改变表并因此改变模型）

# debugging - 您的实用工具包中有什么？

> ID：173328
> 
> 赞同：10
> 
> 时间：2008-10-06T06:27:23.303
> 
> 标签：debugging

我认识的一些最有效率的工程师、开发人员和 IT 专业人员通常会随身携带一个由有用程序、插件或实用程序组成的通用“工具包”，以帮助他们进行日常调试、开发或设计。

问题是：
*您的实用工具包中有什么……您离不开哪些工具？*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-06T06:33:04.540

[适用于 Windows 的 Unix 实用程序](http://unxutils.sourceforge.net)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T08:00:36.173

[确认](http://petdance.com/ack/)

它与 grep 类似，但更好、更快，并且可以执行更多您通常希望对大型源集合执行的操作。用 Perl 编写，因此完成了 PCRE。递归遍历是默认的，它智能地跳过不太可能使用文件类型标识匹配到快捷方式的文件。

（这意味着它会自动避免遍历`.svn/.hg/.git`目录，从而大大提高速度）

```
ack "function\s+foo\s*\(" --php     
# find the definition of "foo" in all php files
# decendant of the current directory 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T07:36:18.857

Total Commander (GREP, FTP, ZIP, 都在这里...我什至没有从这个开始)

记事本++

WinMerge

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-06T07:20:45.440

**蟒蛇**。严重地。我用它来做很多小东西。我还喜欢使用命令行模块来创建简单的小项目特定“shell”，我将这些“shell”放入常用查询等中（显示项目数据库中的所有表，搜索存储过程等 - 是的，做了很多-sql 最近...)

我倾向于在大型 c#/t-sql 项目中附带一个扩展`cmd.Cmd`类的小 Python 脚本，为我提供一小部分有用的查询等，我可以用它们在数据库中四处寻找。

此外，我经常使用 python 将输入数据（通常是 csv 文件，但任何垃圾文件都可以）修改为插入语句等。或者对这些数据进行合理性测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T08:06:01.153

我的 USB thumd 驱动器上有以下工具：

*   [SysInternals Suite](http://technet.microsoft.com/en-us/sysinternals/0e18b180-9b7a-4c49-8120-c47c5a693683.aspx)一次下载所有出色的故障排除工具，以防我可能需要以前没有下载过的工具
*   WireShark 设置
*   VNC 二进制文件（所以我可以直接从 USB 运行查看器）和设置
*   几个[便携式应用程序](http://portableapps.com/)：
    *   记事本++便携式
    *   腻子便携式
    *   FileZilla 便携版
    *   7-zip 便携式
    *   苏门答腊 PDF 便携版
    *   WinMerge 便携版

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T06:35:17.530

目前在我的拇指驱动器上（不是所有软件）：

*   记事本++
*   .NET 反射器
*   # 开发（以防我需要在另一台计算机上快速设置 IDE）

*   C# 默认键绑定 pdf
*   数学表.pdf
*   嘘入门 pdf
*   MSDN C# & VB 示例项目

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T06:35:47.140

我的实用工具包将具有： 1.) 十六进制编辑器 - XVI32 或任何其他 2.) 超越比较 - 文件比较 3.) Cygwin shell 可安装完整的 perl、gcc、gprof、gcov、gdb 和相关工具、bash、vim , 开发/调试工具 4.) *nix 平台的模型生成文件 5.) Winzip 实用程序 6.) Source insight 或任何其他优秀的代码浏览工具 7.) Ghostscript 和 GSView 8.) PDF 阅读器 9.) 良好的快速杀毒工具/可执行程序

-广告

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-06T06:44:29.930

目前在拇指驱动器\工具中。

“Edit Plus 3”——我使用多年的轻量级编辑器。

“F# - 1.9.6.2” - 非常适合当我需要将一些东西放在一起时，因为它可以在没有 IDE 的情况下使用，也是许多任务的好语言。

“伊达斯姆”

“Sysinternal Procmon” - 非常适合调试和了解机器实际在做什么。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-23T07:21:39.133

我使用/随身携带：

*   .Net 反射器
*   SysInternals
*   套件（特别是 Process Explorer、Debug View 等）
*   外窥镜
*   逆戟鲸（Windows 安装程序）
*   要看
*   间谍++ OleView
*   资源者
*   空灵
*   IE 开发工具栏
*   取决于.Net
*   文档视图
*   LDP（用于 LDAP）

仅举几个

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-28T03:33:14.353

我做了一个完整的cygwin安装。它为我提供了我需要的 95% 的东西，而且硬盘空间很便宜。安装所有东西要容易得多，然后获得 emacs、gcc、gdb、perl、grep 和 awk 等实用程序，更不用说它附带的服务器，如 Apache 和 MySQL，如果你想快速尝试的话。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-06T09:24:16.847

我似乎总是以某种形式或其他形式在我身上安装可引导的 Linux 发行版。无论是我一直连接到我的钥匙的可启动笔式驱动器，还是我用于各种“诊断”的大量 LiveCD - 我发现如果我处于某种情况下，一般来说，我需要某种工具。 . 重新启动到 Live 环境为我提供了我需要的几乎足够的一切，以及更多

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-05-25T06:18:55.207

1.  虚拟机
2.  VS2010 快递
3.  火狐+萤火虫

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-06T07:09:59.613

*   Notepad ++
*   FF + Firebug
*   Jquery + bunch of plugins
*   DBManager
*   Cygwin for error tracking
*   Google for help
*   Docs in CHM & Cheatsheets

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-06-20T23:57:13.507

ide: visual studio / netbeans (zip file!, almost portable)

editor: notepad++ (portable) with monaco font

file comparison: winmerge (portable)

source control: subversion, tortoise

ticket control: redmine

file manager: free commander (portable)

explorer: IE, FF (portable), chrome (portable), iron (chrom without google crap, also portable), qtweb, arora,

FF plugins: firebug, web developer, xmarks

imclient: pidgin

mail client: gmail

download manager: free download manager (portable)

sites: STACKOVERFLOW!!!, gotapi... and google, all the time...

miscelaneous: launchy (can't live without it!)

virtualization: virtual box (I have a machine image for every environment)

office: openoffice (portable)

lamp stack: xammp (portable!)

disk usage: windirstat (portable), scanner (portable)

pdf viewer: foxit (portable), sumatrapdf (portable)

uncompressor: 7-zip portable

M$ sql comparison tool: sql delta

M$ sql management: visual studio sql manager

mysql

mysql management: phpmyadmin, manager provided with mysql

uninstaller utility: revo unistaller (portable)

registry cleaner: ccleaner (portable)

ftp: filezilla (portable)

as you may have noticed, I have a special predilection for portable applications...

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-16T23:44:32.247

我使用的工具是因为您不必安装，只需放在系统上并使用：

*   [特工搜查](http://www.mythicsoft.com/agentransack/)
*   [7-zip](http://www.7-zip.org/)
*   [平板电脑](http://www.pspad.com/)
*   [Robocopy](http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en) : 需要从 Windows 2003 资源包中提取（只需获取 .exe）

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-04-14T05:51:10.317

以下是我用来制作 Sharepoint 解决方案的工具：

*   Visual Studio 团队套件 2008
*   VSTS 数据库版 GDR
*   沙堡
*   沙堡的 DocProject
*   .net 反射器
*   幽灵医生
*   CSS 远景
*   共享点检查器
*   共享点资源管理器
*   EditPadPro
*   CodeSmith 2.6 免费软件（带有我自己的 .net 3.5 SP1 gui）
*   靛蓝玫瑰微星工厂
*   蜡
*   地图
*   线鲨
*   提琴手
*   Adobe Photoshop CS3
*   Expresso（正则表达式工具）
*   VMRCPlus
*   Powershell 2 CTP
*   Quest PowerGui for Powershell
*   IIS 资源工具包
*   超级V

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-06T06:41:08.143

[grep](http://en.wikipedia.org/wiki/Grep)为您带来最大的收益。您可以使用它来搜索任何类型代码和多种形式的数据。它速度快，而且非常强大。在代码中，它可以在变量和函数名称中找到您要查找的内容，也可以在注释中找到。您还可以将结果通过管道传输到其中，从而增强现场可用的许多工具的实用性。

通过一些巧妙的提示，您可以轻松地使 grep 搜索特定类型的标识符。例如，“^function_name”通常会在 C 代码中找到函数的定义，因为这些定义以函数名称开头，位于行的开头。如果搜索模式为您提供了太多错误匹配，您可以通过 grep -v 将结果过滤掉。

许多年前，我在一台运行 OS/32 的 1970 年代 Perkin Elmer 机器上调试 COBOL 程序时陷入困境。这台机器缺乏编程工具，但有一个古老的 C 编译器（太老了，它可以接受 =+ 作为 += 运算符的原始形式）。我最终编写了一个基本的 grep 程序，这极大地提高了我的工作效率。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-28T14:02:54.613

*   [体育资源管理器](http://www.heaventools.com/ "体育资源管理器")
*   FAR Manager（出色的文件管理器，尤其是在处理大量 ftp 站点时）
*   FlexHex
*   伊达
*   OllyDbg

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-28T14:29:20.583

Emacs。这是我的“做事清单”工具，有助于快速计算和修改配置文件（我是一名网络工程师，有大量的配置要做，其中很多几乎都是用小片段生成的代码或谨慎使用键盘宏）。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-04-28T03:14:24.507

快速的图像查看器，已经存在了很长时间并被证明可以工作。

[IrfanView](http://www.irfanview.com/)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-06T07:22:46.123

WinRAR 和腻子。这就是我所需要的（我假设互联网不算数）。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-06T07:57:13.713

*   .Net 反射器
*   电源外壳
*   Stackoverflow.com

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-06T08:13:34.693

我喜欢用 Python 编程，所以我在拇指驱动器上创建了一个可移植的 Python 编程环境。

*   [可移植的 Python 1.0](http://www.portablepython.com/)
*   [SPE Python 编辑器](http://pythonide.blogspot.com)
*   wxPython in Action 电子书
*   Python 如何编程电子书
*   来自 O'Reilly 的几本 Python 电子书
*   各种我不常用的 Python 工具教程

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-04-17T00:06:32.520

我使用[Espresso](http://macrabbit.com/espresso/ "浓咖啡")（我通过[MacHeist](http://www.macheist.com/ "麦克海斯特")包获得了它！）和 Firebug 进行编码。如果我需要任何图像，我会使用 Photoshop。

[我用The Hit List](http://www.potionfactory.com/thehitlist/ "命中列表")管理我的项目。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-06T06:30:25.247

[系统救援光盘](http://www.sysrescd.org)

*   Live CD 上非常有用的实用程序集合

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-10-06T06:31:10.533

有两个工具我根本无法使用

1.  电源外壳
2.  GVim（或任何 vim 风格的程序）

这些工具在我的日常生活中根深蒂固，大大提高了我的工作效率。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-10-06T06:40:29.017

由于我经常在不同的工作站上工作，因此我养成了标记我安装在美味上的东西的习惯：

[http://delicious.com/DavidSchmitt/stdsw](http://delicious.com/DavidSchmitt/stdsw)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-10-06T06:42:35.597

wc.exe（来自[http://unxutils.sourceforge.net/](http://unxutils.sourceforge.net/)）非常方便。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-04-24T00:54:51.537

**开发工具**

*   颠覆
*   乌龟SVN

**有用的工具/实用程序**

*   虚拟 CD 控制工具
*   Linq 垫
*   反射器
*   颠覆提交监视器
*   BGInfo
*   SourceGear 差异合并
*   解锁器
*   MWSnap
*   油漆网
*   WinRar

**火狐附加组件**

*   萤火虫
*   ColorZilla

**Visual Studio 加载项**

*   幽灵医生

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-04-28T03:42:14.847

每个开发人员**都应该**在 Scott Hanselman 的以下链接中描述的实用工具包或工具列表：

[适用于 Windows 的 Scott Hanselman 的终极开发人员和高级用户工具列表](http://www.hanselman.com/blog/ScottHanselmans2007UltimateDeveloperAndPowerUsersToolListForWindows.aspx)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-12-03T11:27:02.563

[Architag XRay XML Editor](http://architag.com/xray) - 我用这个轻量级的工具测试 XSLT 片段。

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2008-10-06T09:19:28.133

这是我用于 .NET 软件开发项目[的工具、实用程序和 progs 的列表。](https://web.archive.org/web/20080914042228/http://rabdullin.com/development-software-requirements-for-the-xlim-2-solutions/)

# sql-server - 如何从 SQL Server 解密密码？

> ID：173329
> 
> 赞同：17
> 
> 时间：2008-10-06T06:27:29.917
> 
> 标签：sql-server, encryption, hash, passwords

我在 sql server 2000 中有这个查询：

```
select pwdencrypt('AAAA') 
```

它输出一个加密的“AAAA”字符串：

```
0x0100CF465B7B12625EF019E157120D58DD46569AC7BF4118455D12625EF019E157120D58DD46569AC7BF4118455D

```

**如何转换（解密）来自其来源（即“AAAA”）的输出？**

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-08-09T19:20:23.983

SQL Server 密码哈希算法：

```
hashBytes = 0x0100 | fourByteSalt | SHA1(utf16EncodedPassword+fourByteSalt) 
```

例如，散列密码*“正确的马电池订书钉”*。首先我们生成一些随机盐：

```
fourByteSalt = 0x9A664D79; 
```

然后将密码（以 UTF-16 编码）与盐一起散列：

```
 SHA1("correct horse battery staple" + 0x9A66D79);
=SHA1(0x63006F007200720065006300740020006200610074007400650072007900200068006F00720073006500200073007400610070006C006500 0x9A66D79)
=0x6EDB2FA35E3B8FAB4DBA2FFB62F5426B67FE54A3 
```

存储在**`syslogins`**表中的值是以下内容的串联：

> [标题] + [盐] + [哈希]
> `0x0100` `9A664D79` `6EDB2FA35E3B8FAB4DBA2FFB62F5426B67FE54A3`

您可以在 SQL Server 中看到：

```
SELECT 
   name, CAST(password AS varbinary(max)) AS PasswordHash
FROM sys.syslogins
WHERE name = 'sa'

name  PasswordHash
====  ======================================================
sa    0x01009A664D796EDB2FA35E3B8FAB4DBA2FFB62F5426B67FE54A3 
```

*   版本标题：`0100`
*   盐（四个字节）：`9A664D79`
*   哈希：`6EDB2FA35E3B8FAB4DBA2FFB62F5426B67FE54A3` *（SHA-1 为 20 字节；160 位）*

## 验证

您通过执行相同的哈希来验证密码：

*   从保存中获取盐`PasswordHash`：0x9A664D79

并再次执行哈希：

```
SHA1("correct horse battery staple" + 0x9A66D79); 
```

这将得出相同的哈希值，并且您知道密码是正确的。

## 曾经很好，现在很弱

1999 年 SQL Server 7 引入的散列算法适用于 1999 年。

*   密码哈希加盐很好。
*   最好将盐**附加**到密码中，而不是**预先**添加它。

但今天它已经过时了。它只运行一次哈希，它应该运行几千次，以阻止暴力攻击。

事实上，作为检查的一部分，Microsoft 的 Baseline Security Analyzer 会尝试暴力破解密码。如果它猜到了，它会将密码报告为弱密码。它确实得到了一些。

# 蛮力

为了帮助您测试一些密码：

```
DECLARE @hash varbinary(max)
SET @hash = 0x01009A664D796EDB2FA35E3B8FAB4DBA2FFB62F5426B67FE54A3
--Header: 0x0100
--Salt:   0x9A664D79
--Hash:   0x6EDB2FA35E3B8FAB4DBA2FFB62F5426B67FE54A3

DECLARE @password nvarchar(max)
SET @password = 'password'

SELECT
    @password AS CandidatePassword,
    @hash AS PasswordHash,

    --Header
    0x0100
    +
    --Salt
    CONVERT(VARBINARY(4), SUBSTRING(CONVERT(NVARCHAR(MAX), @hash), 2, 2))
    +
    --SHA1 of Password + Salt
    HASHBYTES('SHA1', @password + SUBSTRING(CONVERT(NVARCHAR(MAX), @hash), 2, 2)) 
```

## SQL Server 2012 和 SHA-512

从 SQL Server 2012 开始，Microsoft 转而使用 SHA-2 512 位：

```
hashBytes = 0x0200 | fourByteSalt | SHA512(utf16EncodedPassword+fourByteSalt) 
```

将版本前缀更改为`0x0200`：

```
SELECT 
   name, CAST(password AS varbinary(max)) AS PasswordHash
FROM sys.syslogins

name  PasswordHash
----  --------------------------------
xkcd  0x02006A80BA229556EB280AA7818FAF63A0DA8D6B7B120C6760F0EB0CB5BB320A961B04BD0836 0C0E8CC4C326220501147D6A9ABD2A006B33DEC99FCF1A822393FC66226B7D38 
```

*   版本：`0200` *（SHA-2 512 位）*
*   盐：`6A80BA22`
*   哈希（64 字节）：`9556EB280AA7818FAF63A0DA8D6B7B120C6760F0EB0CB5BB320A961B04BD0836 0C0E8CC4C326220501147D6A9ABD2A006B33DEC99FCF1A822393FC66226B7D38`

这意味着我们使用 salt 后缀对 UTF-16 编码的密码进行哈希处理：

*   SHA512( *"正确的马电池订书钉"* + `6A80BA22`)
*   SHA512( `63006f0072007200650063007400200068006f0072007300650020006200610074007400650072007900200073007400610070006c006500`+ `6A80BA22`)
*   `9556EB280AA7818FAF63A0DA8D6B7B120C6760F0EB0CB5BB320A961B04BD0836 0C0E8CC4C326220501147D6A9ABD2A006B33DEC99FCF1A822393FC66226B7D38`

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-06T06:33:03.290

我相信 pwdencrypt 正在使用散列，因此您无法真正反转散列字符串 - 该算法的设计是不可能的。

如果您要验证用户输入的密码，通常的技术是将其散列，然后将其与数据库中的散列版本进行比较。

这是您可以验证用户输入的表的方式

```
SELECT password_field FROM mytable WHERE password_field=pwdencrypt(userEnteredValue) 
```

将 userEnteredValue 替换为（大吃一惊）用户输入的值 :)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-06T08:11:12.187

你意识到你可能正在为自己的未来做一根棍子。pwdencrypt() 和 pwdcompare() 是未记录的函数，在 SQL Server 的未来版本中可能表现不同。

为什么不在访问数据库之前使用可预测的算法（例如 SHA-2 或更好的算法）对密码进行哈希处理？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-06T09:24:40.387

你真的不应该对密码进行解密。

您应该对输入应用程序的密码进行加密，并与数据库中的加密密码进行比较。

编辑 - 如果这是因为忘记了密码，则设置一个机制来创建新密码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T06:35:35.593

您无法再次解密此密码，但还有另一种名为“pwdcompare”的方法。这是一个如何将其与 SQL 语法一起使用的示例：

```
USE TEMPDB
GO
declare @hash varbinary (255)
CREATE TABLE tempdb..h (id_num int, hash varbinary (255))
SET @hash = pwdencrypt('123') -- encryption
INSERT INTO tempdb..h (id_num,hash) VALUES (1,@hash)
SET @hash = pwdencrypt('123')
INSERT INTO tempdb..h (id_num,hash) VALUES (2,@hash)
SELECT TOP 1 @hash = hash FROM tempdb..h WHERE id_num = 2
SELECT pwdcompare ('123', @hash) AS [Success of check] -- Comparison
SELECT * FROM tempdb..h
INSERT INTO tempdb..h (id_num,hash) 
VALUES (3,CONVERT(varbinary (255),
0x01002D60BA07FE612C8DE537DF3BFCFA49CD9968324481C1A8A8FE612C8DE537DF3BFCFA49CD9968324481C1A8A8))
SELECT TOP 1 @hash = hash FROM tempdb..h WHERE id_num = 3
SELECT pwdcompare ('123', @hash) AS [Success of check] -- Comparison
SELECT * FROM tempdb..h
DROP TABLE tempdb..h
GO 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T08:33:28.010

快速[谷歌](http://www.google.com/search?q=pwdencrypt)表明 pwdencrypt() 不是确定性的，您的语句 select pwdencrypt('AAAA') 在我的安装中返回不同的值！

另见这篇文章[http://www.theregister.co.uk/2002/07/08/cracking_ms_sql_server_passwords/](http://www.theregister.co.uk/2002/07/08/cracking_ms_sql_server_passwords/)

# html - 我应该如何在 HTML 中表达像 15/16ths 这样的分数？

> ID：173332
> 
> 赞同：27
> 
> 时间：2008-10-06T06:28:46.857
> 
> 标签：html

我知道 1/2、1/4 和 3/4 有 HTML 实体，但还有其他实体吗？像 1/3 还是 1/8？有没有编码任意分数的好方法？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-06T06:37:36.183

^(15) ⁄ [16]怎么样？(<sup>15</sup>⁄<sub>16</sub>)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-06T07:02:25.260

```
1/2 → &#189; or &frac12;
1/4 → &#188; or &frac14;
3/4 → &#190; or &frac34;
1/8 → &#8539; or &frac18;
3/8 → &#8540; or &frac38;
5/8 → &#8541; or &frac58;
7/8 → &#8542; or &frac78;
1/3 → &#8531;
2/3 → &#8532;
1/5 → &#8533;
2/5 → &#8534;
3/5 → &#8535;
4/5 → &#8536;
1/6 → &#8537;
5/6 → &#8538; 
```

...但您也可以将它们编码为小数：15/16 = 0.9375 ;)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-06T09:11:05.373

对于作为 Unicode 代码点的现有分数（由 HTML 实体映射到），请在[Unicode Character Names Index](http://www.unicode.org/charts/charindex3.html)中搜索“vulgar fraction” 。

现在，对于可以在 HTML 中使用但也可以在纯文本中使用的通用分数，请使用由[分数斜线](http://www.fileformat.info/info/unicode/char/2044/index.htm)字符分隔的上标和下标数字（请参阅[Unicode 代码点图表](http://inamidst.com/stuff/unidata/)，搜索“上标”） 。

您的示例如上实现：

# ¹⁵⁄₁₆

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T06:34:13.820

不是只有 15/16 可以吗？甚至是 15/16 ^(ths) ( `15/16<sup>ths</sup>`)？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T07:48:38.957

对于更复杂的场景，还有[MathML](http://www.w3.org/Math/)。对此的支持正在慢慢变好。Internet Explorer 在这方面似乎也落后了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T07:42:22.557

这将取决于您的确切需求和受众。对于大多数目的，许多方法都是合适的。15/16, 16 的 15 部分, 93.75%, ^(15) / [16] 都表示相同的意思，你甚至可以使用像 ++++++++++++++- 这样的符号

对于一些更复杂的场景，您将需要更复杂的解决方案，比如 LaTeX 而不是 html。我相信还有一些服务器端组件采用 LaTeX 描述并创建与浏览器兼容的图像，如下所述：http: [//www.fauskes.net/nb/htmleqII/](http://www.fauskes.net/nb/htmleqII/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T07:48:44.043

还有一个称为[MathML](http://www.w3.org/Math/)的标准。但不幸的是对于 XML。但是，如果您有更多表达式，您可能会考虑切换到基本 XML。

# sms - 短信提醒以更 快地响应错误情况

> ID：173338
> 
> 赞同：2
> 
> 时间：2008-10-06T06:30:12.033
> 
> 标签：sms, alerts

设置 SMS 警报系统以便在我的服务器没有响应或 GET 查询没有返回正确内容时收到通知的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T06:44:15.483

您可以完全外包监控和警报，例如订阅[Pingdom](http://pingdom.com/)。最基本的 Pingdom 计划将监控多达 5 个服务（包括使用带有可选内容模式匹配的 HTTP GET）并在可配置的停机时间后发送 SMS。

如果您想推出自己的解决方案，首先要做的就是监控软件。为此存在许多许多第三方解决方案，从[免费](http://www.nagios.org/)到[极其昂贵](http://welcome.hp.com/country/us/en/prodserv/software.html)的。当然，滚动您自己的“尝试 GET 并在它不起作用时做某事”脚本始终是一种选择，但与所有软件一样，功能蔓延可能意味着您很快就会重新实现现有的解决方案......

对于 SMS 通知，使用电子邮件到 SMS 网关可能对您有用，如果您位于此类服务服务良好的地区。例如，大多数美国提供商都提供免费网关，而在欧洲，它们往往由第三方运营并且只需要付费。正如已经建议的那样，谷歌在这里是你的朋友。此外，您的监控工具可能支持使用连接到监控服务器的手机/GSM 调制解调器直接发送通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T06:43:34.377

我经常发现您需要的是直接连接到监控服务器的 SMS 调制解调器。如果问题是网络连接怎么办？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T06:38:07.447

您可以获得类似[http://www.serviceuptime.com/](http://www.serviceuptime.com/)的服务，然后发送电子邮件至 your-number@a-domain-your-provider-gives 他们通常在各自的网站上为提供商提供确切的域，但您例如，如果您的提供商是 t-mobile，则可以尝试 @t-mobile.com。

如果您想编写自己的工具应该非常简单 - 如果您没有收到预期的响应，请发送 GET 请求发送电子邮件。您应该从 2 个不同 ISP 的 2 个不同位置运行它，因为如果存在路由问题并且请求没有通过，您将收到短信

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T06:39:34.557

你想要的是一个[SMS 网关](http://en.wikipedia.org/wiki/SMS_gateway)。您当地肯定有一些服务提供商。不幸的是，它们有点难找。试着问谷歌...

# database - 哪些数据库实现允许在单独的数据库中对用户进行沙盒处理？

> ID：173348
> 
> 赞同：1
> 
> 时间：2008-10-06T06:35:05.470
> 
> 标签：database

谁能告诉我是否有 RDBMS 允许我为每个用户创建一个单独的数据库，以便完全分离用户的数据？有吗？

我知道我可以将 UID 添加到每个表中，但此解决方案有其自身的问题（例如，不可能更改每个用户的数据库架构）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T06:41:18.953

难道 MySQL、PostgreSQL、Oracle 等等等等都允许你这样做吗？有控制 ACL 的授权语句

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T07:08:15.530

我想大多数（所有？）数据库都允许您创建一个用户，然后您可以授予数据库级别的访问权限？SQL 服务器当然可以。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T07:36:38.233

如果您不需要数据库庞大或可扩展，例如用于向学生教授 SQL 或让许多测试人员针对他们自己的数据库工作以隔离问题，那么另一个简单的解决方案是 SQLite，这样整个数据库就是一个文件（每个用户)，并且每个用户都不可能搞砸或干扰其他用户。

他们甚至可以将数据库邮寄给您，或将它们安装在任何地方，例如在家中和工作中，无需互联网。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T07:12:10.467

MS SQLServer2005 是一个可用于多个用户的版本。如果您有任何实例，可以创建一个实例，运行 previlegs 并为每个实例使用一个用户

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T07:35:46.940

Oracle 允许您为单个用户创建一个单独的模式（一组表、索引、函数等）。如果他们应该有单独的不同表，这很好。创建新用户可能是一项非常昂贵的操作，因为您将创建新表。更新也是一场噩梦，因为您需要为每个用户更新模型。

如果您希望每个人都拥有相同的表集，但只能查看自己的记录，那么您可以使用细粒度访问控制或虚拟专用数据库功能来做到这一点。

# javascript - 当关联的 Javascript 对象在 V8 中被垃圾收集时，如何释放包装的 C++ 对象？

> ID：173366
> 
> 赞同：24
> 
> 时间：2008-10-06T06:41:32.370
> 
> 标签：javascript, c++, v8

V8 的文档解释了[如何创建包装 C++ 对象的 Javascript 对象](http://code.google.com/apis/v8/embed.html#dynamic)。Javascript 对象持有指向 C++ 对象实例的指针。我的问题是，假设您在堆上创建了 C++ 对象，当 Javascript 对象被 gc 收集时，如何获得通知，以便释放堆分配的 C++ 对象？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-06T22:00:05.680

诀窍是创建一个`Persistent`句柄（链接到 API 参考中的第二个要点：“`Persistent`句柄不保存在堆栈上，只有在您专门删除它们时才会被删除。......当您需要保留一个对多个函数调用的对象的引用，或者当句柄生命周期不对应于 C++ 范围时。”），并调用`MakeWeak()`它，传递一个回调函数，该函数将进行必要的清理（“可以使持久句柄变弱，当对对象的唯一引用来自弱持久句柄时，使用`Persistent::MakeWeak`, 触发垃圾收集器的回调。” - 也就是说，当所有“常规”句柄都超出范围并且垃圾收集器即将删除目的）。

`Persistent::MakeWeak`方法签名是：

```
void MakeWeak(void* parameters, WeakReferenceCallback callback); 
```

where`WeakReferenceCallback`被定义为一个指向函数的指针，带有两个参数：

```
typedef void (*WeakReferenceCallback)(Persistent<Object> object,
                                      void* parameter); 
```

这些可以在与 V8 作为公共 API 一起分发的 v8.h 头文件中找到。

您希望传递给的函数`MakeWeak`清理`Persistent<Object>`对象参数，该参数将在作为回调调用时传递给它。该`void* parameter`参数可以被忽略（或者`void* parameter`可以指向包含需要清理的对象的 C++ 结构）：

```
void CleanupV8Point(Persistent<Object> object, void*)
{
    // do whatever cleanup on object that you're looking for
    object.destroyCppObjects();
}

Parameter<ObjectTemplate> my_obj(ObjectTemplate::New());

// when the Javascript part of my_obj is about to be collected
// we'll have V8 call CleanupV8Point(my_obj)
my_obj.MakeWeak(NULL, &CleanupV8Point); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T18:12:48.743

一般来说，如果垃圾收集语言可以保存对语言引擎之外的资源（文件、套接字或在您的情况下为 C++ 对象）的引用，您应该提供一个“关闭”方法来尽快释放该资源，没有必要等到GC 认为销毁你的对象是值得的。

如果您的 C++ 对象需要大量内存并且垃圾收集的对象只是一个引用，情况会变得更糟：您可能会分配数千个对象，而 GC 只看到几 KB 的小对象，不足以触发收集；而 C++ 方面正在与数十兆字节的陈旧对象作斗争。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T20:38:24.363

在某个封闭范围内（对象或函数）完成所有工作。然后，您可以在超出范围时安全地删除 C++ 对象。GC 不检查指针是否存在指向对象。

# c++ - 你如何处理 Boost 中的大依赖关系？

> ID：173374
> 
> 赞同：9
> 
> 时间：2008-10-06T06:42:48.810
> 
> 标签：c++, boost, dependencies

Boost 是一个非常大的库，具有许多相互依赖关系——编译也需要很长时间（对我来说这会减慢[**CruiseControl**](http://cruisecontrol.sourceforge.net/)的响应时间）。

我使用的 boost 的唯一部分是 boost::regex 和 boost::format。

是否有一种简单的方法可以仅提取特定 boost 子库所需的 boost 部分以加快编译速度？

编辑：回答关于我们为什么要重建提升的问题......

1.  解析 boost 头文件仍然需要很长时间。我怀疑如果我们可以只提取我们需要的东西，解析也会更快。
2.  我们的 CruiseControl 设置从头开始构建一切。如果我们更新我们正在使用的 boost 版本，这也会变得更容易。但是我会调查看看我们是否可以改变我们的构建过程，看看我们的构建机器是否可以在发生更改时构建 boost 并将这些更改提交给 SVN。（我公司有一项政策，所有出门的东西都必须在“构建机器”上构建。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T06:49:07.207

首先，您可以使用 bcp 工具（可以在 tools 子文件夹中找到）提取您正在使用的头文件和文件。但是，这对编译时间没有帮助。其次，您不必每次都重新构建 Boost。只需在每次版本更改时预先构建 lib 文件，并在构建时复制“stage”文件夹。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T06:47:37.473

除非您自己修补 boost 库，否则没有理由在每次构建时都重新编译它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T06:51:25.110

我们正在使用 Boost，但我们只包含我们实际使用的那些类型的目标文件。即，我们使用一堆本地实用程序构建自己的静态库，并包含我们认为有用的 Boost 部分。我们`CMakeLists.txt`看起来像这样（如果您相应地调整 SOURCES，您应该能够在 CMake 中加载它。）

```
project( MyBoost )

set(SOURCES 
  boost/regex/src/c_regex_traits.cpp
  boost/regex/src/cpp_regex_traits.cpp
  boost/regex/src/cregex.cpp
  boost/regex/src/fileiter.cpp
  boost/regex/src/icu.cpp
  boost/regex/src/instances.cpp
  boost/regex/src/posix_api.cpp
  boost/regex/src/regex.cpp
  boost/regex/src/regex_debug.cpp
  boost/regex/src/regex_raw_buffer.cpp
  boost/regex/src/regex_traits_defaults.cpp
  boost/regex/src/static_mutex.cpp
  boost/regex/src/usinstances.cpp
  boost/regex/src/w32_regex_traits.cpp
  boost/regex/src/wc_regex_traits.cpp
  boost/regex/src/wide_posix_api.cpp
  boost/regex/src/winstances.cpp
)

add_library( MyBoost STATIC ${SOURCES}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T06:49:33.117

预编译的头文件是当今的流行词！在预编译的头文件中包含您需要的 boost 头文件 - tada！

# offline - 有没有人构建了可以完全离线运行的网络应用程序？

> ID：173378
> 
> 赞同：11
> 
> 时间：2008-10-06T06:44:16.280
> 
> 标签：offline

我正在构建一个应用程序，作者将（希望）使用它来帮助他们，呃..*创作*东西。

把它想象成一个维基，但只为一个人服务，但更酷。我希望让我的（潜在的）崇拜者尽可能地使用它，所以我正在考虑将它变成一个网络应用程序。

当然不必如此，没有与其他网站的集成，没有社交功能。然而，它涉及在表单中输入信息，因此对于快速构建来说，网络可能是最好的。

但是，我真的不想自己主持。我买不起，但主要是使用它的人可能不希望他们的数据存储在其他地方。这是关于他们正在编写的内容的私人信息，我不希望他们相信我，因此我正在考虑将其作为一个胖客户端应用程序。

这就是问题所在，如何使主要关注表单数据输入的应用程序易于潜在用户（是的网络应用程序）使用，但也可以离线使用，以便他们知道他们可以完全控制自己的数据（是的厚客户端应用程序）。

我看到以下解决方案：

1.  将它构建为一个胖客户端 Java 应用程序，并在网络上运行一个精简版作为一个小程序，人们可以在下载完整的东西之前玩这个小程序。
2.  将其构建为用于在线的 Flex 应用程序和用于离线的 Air 应用程序（基本上相同的源不同的构建脚本）。
3.  将其构建为标准的网络应用程序（HTML、JS 等），但有一个可下载的版本，以某种方式**完全**在他们的计算机上运行该网站。它根本不会触网。

忽略 1 和 2（我正在分别研究它们），我认为 3 将涉及：

*   打包一个安装，其中包含一个微型网络服务器，上面有我的代码，准备运行。
*   将数据库从 mySQL 之类的东西重新映射到 SQLite 之类的东西。
*   创建某种运行服务器并将浏览器打开到正确位置的便利应用程序，可能使用诸如[Prism](https://wiki.mozilla.org/Prism)之类的东西来隐藏整个浏览器。

那么，**你以前做过这样的事情吗？**

如果是这样，**您遇到了什么问题？**

最后，**还有其他我没有想到的解决方案吗？**'

*（另外，[Joyent Slingshot](http://joyent.com/developers/slingshot/)是对另一个问题的建议，但它是 RoR（我没有经验），我 99% 确定它不能在 linux 下运行，所以它不适合我。）*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T08:19:10.597

我认为您应该查看[tiddlywiki](http://www.tiddlywiki.com/)以获取灵感。

这是一个用 JavaScript 编写的 wiki，完全独立于一个 html 文件中。您将其作为 file:/// URL 加载到浏览器中，因此不需要服务器。

我将其用作个人 wiki 来记录各种主题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T07:14:14.270

[Google Gears](http://en.wikipedia.org/wiki/Google_Gears)用于离线提供一些 google 应用程序（Google Reader、Gmail、Docs 等）。

什么是 Google Gears？

> Gears 是一个开源浏览器扩展，允许开发人员创建可以离线运行的 Web 应用程序。Gears 提供三个关键功能：
> 
> *   本地服务器，用于缓存和提供应用程序资源（HTML、JavaScript、图像等），无需联系服务器
> *   数据库，用于在浏览器中存储和访问数据
> *   工作线程池，使 Web 应用程序更具响应性
> 
> 通过在后台执行昂贵的操作
> 
> Gears 目前是早期访问开发人员的版本。目前，它还没有打算供实际用户在生产应用程序中使用。
> 
> 如果您是一名有兴趣在您的应用程序中使用 Gears 的开发人员，请访问[Gears 开发人员页面](http://code.google.com/apis/gears/)。
> 
> 如果您想在您的计算机上安装 Gears，请访问 Gears 主页。但请注意，Gears 尚未用于一般用途。

但正如你所读的，它仍处于早期阶段。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T07:04:25.817

还有一个附加选项，那就是使用新的 HTML5 离线应用程序功能，即应用程序缓存、客户端数据库和本地存储 API。

目前我相信 Safari 是唯一支持这些的浏览器，而且我相信它只支持客户端数据库和本地存储部分。[webkit nightlies](http://nightly.webkit.org)支持所有这些功能，firefox nightlies 支持其中的许多（也许现在全部？）

[编辑（olliej）：更正，Firefox 3 支持应用程序缓存，但不支持客户端数据库]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T06:52:40.163

我们正在使用类似于您的第三个选项的方法在本地测试我们的网站。工作得很好。

我们打包的网络服务器不够小，无法满足您的需求，但我们也没有试图保持它的小。如果您可以将您的网络服务器代码打包成一个足够小的包，我不明白为什么这种方法行不通。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-07T02:05:52.580

我认为AIR是要走的路..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T07:10:26.383

你检查过[谷歌齿轮](http://gears.google.com/)吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-14T09:56:31.687

解决方案 3 的一些提示：

*   对于 GUI 部分，[ExtJS](http://www.extjs.com/)看起来非常不错。

*   对于存储部分，有一个很好的 JavaScript 库，它抽象了不同的存储后端：[PersistJS](http://pablotron.org/?cid=1557)。

PersistJS 支持的后端：

1.  flash：Flash 8 持久存储。
2.  gears：基于 Google Gears 的持久存储。
3.  localstorage：HTML5 草稿存储。
4.  whatwg_db：HTML5 草案数据库存储。
5.  globalstorage：HTML5 草稿存储（旧规范）。
6.  即：Internet Explorer 用户数据行为。
7.  cookie：基于 cookie 的持久存储。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T07:17:10.673

另外，我认为[moin moin wiki](http://moinmoin.wikiwikiweb.de/)软件有一个[桌面版本](http://moinmoin.wikiwikiweb.de/DesktopEdition?highlight=(desktop))，其中包括它自己的网络服务器。这东西在 python 中很容易，因为[包括电池](http://docs.python.org/library/cgihttpserver.html)。

您可能想看看他们是如何做到的？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T07:32:34.357

您可以使用 Webkit 或 Firefox 的主干创建一个专用客户端。例如，某些游戏使用该解决方案进行 UI。

或者你可以制作一个小型网络服务器（我在 Lua 中有一个小型网络服务器，用于类似目的，只有几个带有库的大型服务器等等）。但是，如果您采用这条路线，要考虑的最大问题是您不希望您的网络服务器依赖于环境变量，而是希望它完全自主。您应该尝试将所有变量隔离到配置文件并完成它（捆绑样式）

或者您可以使用 Java 客户端应用程序来显示网页

或者 GoogleGears，但它（几乎）与 Flex+Air 相同。如果您熟悉，请选择 Flex+Air

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T07:58:05.210

您没有指定语言，但几年前我看过[Karigell 。](http://karrigell.sourceforge.net/)它是 Python Web 框架，类似于 Django 或 TurboGears，但它没有这些框架的开销。

从我弄乱它的角度来看，它似乎可以满足您的目的。它有一个内置的 Web 服务器（尽管您可以使用几乎任何您想要的服务器）并且您可以使用 Python 支持的任何数据库。

另外，Python 与 Linux 配合得很好。:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T08:09:14.127

如果您将应用程序制作为严重依赖客户端技术的常规 Web 应用程序（如前所述，使用 DHTML 和[Google Gears](http://gears.google.com)之类的离线存储数据），那么一旦打开，与服务器的交互并不多，您可能会将东西托管在一个基本的共享托管帐户上，这不会花费那么多。这可能是您最容易的起点，因为您不必担心桌面应用程序的所有问题，例如与不同操作系统的兼容性、打包安装等，但您也不需要大量的服务器资源。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-06T08:14:37.733

您可以在 Adob​​e AIR 中使用 HTML、JS 和其他任何内容，并且您也可以选择在本地保存数据。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-06T09:12:52.780

在 Java 世界中，您可以将 jetty 用作服务器，使用您最喜欢的框架实现 Web 应用程序并将 hsqldb 用作数据库——它完全存在于您的容器（jetty）中。您可以在网络上部署预览应用程序并打包可下载的离线版本。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-06T09:47:21.463

有一个可移植的 Apache/MySQL/PHP 发行版（放置在 USB 密钥上）：

[http://portableapps.com/apps/development/xampp](http://portableapps.com/apps/development/xampp)

这应该很容易适应您的需求。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-22T12:50:37.470

您也可以考虑使用 XULRunner 或 Prism

它们是 FireFox、Thunderbird 和 Joost 所基于的开源技术，允许您使用 XML 和 javascript 开发应用程序，基本上与 FireFox 本身拥有的相同的丰富 api 进行对比。当然这也是跨平台的，所以它可以在 Mac/Linux/Windows 上运行......

在这里查看更多信息： [https ://developer.mozilla.org/en/XULRunner](https://developer.mozilla.org/en/XULRunner)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-27T23:27:25.787

我正在考虑自己做这样的事情。我的计划是使用 django 编写应用程序并编写启动 django 的测试服务器并在指定端口上打开默认浏览器的脚本。我的计划是使用 SQLite ......

另外，将它打包到一个包中会很好，因此没有安装 django 的用户可以在没有任何依赖项的情况下运行应用程序...

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2008-10-06T07:12:35.130

正如您在上面指出的，我的建议是使用 Wiki 系统来解决您的问题。现在的问题可能是：哪一个？

您可以使用[Trac](http://trac.edgewall.org/)，它非常简单，您可以自定义它的 GUI。但是，如果你喜欢更高级的东西，请使用[MoinMoin](http://moinmo.in/)。我使用它多年，IMO 它是一个非常好的和强大的 wiki 系统。

拒绝你将选择的 wiki，忘记从头开始编写你的网络应用程序。根据你的问题，最好的方法是选择一些有效的东西并定制/修改它以满足你的需求。

# nhibernate - 单声道休眠 2.0.1

> ID：173389
> 
> 赞同：4
> 
> 时间：2008-10-06T06:52:14.437
> 
> 标签：nhibernate, mono

我已经在 Windows 机器上构建了我的 WinForm 应用程序，并且该应用程序运行正常。当我使用 nhibernate 1.2.1 时，该应用程序也可以在使用单声道的 linux 机器上运行，但是现在当我将应用程序升级到 nhibernate 2.0.1 时，它只能在 Windows 中运行。我收到错误：NHibernate.InvalidProxyTypeException：以下类型可能不能用作代理：xxxx.Data.Dao.Credit：方法 obj_address 应该是虚拟的......谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T04:08:25.693

您可以尝试禁用 NHibernate Config 代理验证器。它似乎不适用于单声道。

您可以通过 `<property name="use_proxy_validator">false</property>` 在 app/web.config nhibernate 部分添加：

有关具有此属性集的示例配置，请参见此处： http: [//www.mail-archive.com/nhusers@googlegroups.com/msg02109.html](http://www.mail-archive.com/nhusers@googlegroups.com/msg02109.html)

或修改：

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="hibernate-configuration"
             type="NHibernate.Cfg.ConfigurationSectionHandler, NHibernate" />
  </configSections>

  <hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
        <!--
      <property name="dialect">NHibernate.Dialect.MsSql2005Dialect</property>
      <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
      <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
      <property name="connection.connection_string">Data Source=YOUR_DB_SERVER;Database=Northwind;User ID=YOUR_USERNAME;Password=YOUR_PASSWORD;</property>
      <property name="connection.isolation">ReadCommitted</property>
      <property name="default_schema">Northwind.dbo</property>
          -->
        <!--
      <property name="dialect">NHibernate.Dialect.SQLiteDialect</property>
      <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
      <property name="connection.driver_class">NHibernate.Driver.SQLiteDriver</property>
      <property name="connection.connection_string">Data Source=nhibernate.db;Version=3</property>
      <property name="query.substitutions">true=1;false=0</property>
          -->
          <!-- mysql
      <property name="dialect">NHibernate.Dialect.MySQLDialect</property>
      <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
      <property name="connection.driver_class">NHibernate.Driver.MySqlDataDriver</property>
      <property name="connection.connection_string">Database=test</property>
          -->
          <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
          <property name="connection.driver_class">NHibernate.Driver.NpgsqlDriver</property>
          <property name="connection.connection_string">Server=localhost;database=test;User id=jrwren;password=yourpasswordhere.</property>
          <property name="dialect">NHibernate.Dialect.PostgreSQLDialect</property>
          <property name="use_proxy_validator">false</property>
      <!-- HBM Mapping Files -->
      <mapping assembly="Test.exe" />
    </session-factory>
  </hibernate-configuration>

</configuration> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T08:00:04.300

这可能很有趣：

[http://softwaredevscott.spaces.live.com/blog/cns!1A9E939F7373F3B7!251.entry](http://softwaredevscott.spaces.live.com/blog/cns!1A9E939F7373F3B7!251.entry)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T02:56:35.213

我也在尝试使用 NHibernate。大多数论坛似乎都说将字符串设置为虚拟可以解决问题，但这对我不起作用。奇怪的是我的错误几乎是一样的——

"" 方法 obj_address 应该是虚拟的

这让我觉得代理“地址”是为其他东西保留的。尝试更改此列的名称？

# java - java最好的安装工具是什么？

> ID：173392
> 
> 赞同：17
> 
> 时间：2008-10-06T06:53:00.333
> 
> 标签：java, installation

取决于你的经验，你能推荐一些东西吗？我用过[izpack](http://izpack.org/)，它是非常好的工具，还有其他更好的工具吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T10:06:02.847

在 MS Windows中， [NSIS](http://nsis.sourceforge.net/Main_Page)很棒而且它是免费的 & OSS

参考：[具有自动 JRE 安装的 Java 启动器](http://nsis.sourceforge.net/Java_Launcher_with_automatic_JRE_installation)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T07:02:45.133

对于 Windows，有[AdvancedInstaller](http://www.advancedinstaller.com/java.html)，它非常易于使用并创建了标准的 .msi 文件。它具有一些用于 Java 安装的额外功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T08:18:11.970

我对 install4j 很满意。（甚至从我的 ant 脚本中运行它）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-18T12:00:02.153

我想推荐我们的跨平台安装工具[BitRock InstallBuilder](http://bitrock.com)。虽然它不是基于 Java 的，但它通常用于打包 Java 应用程序。它可以很容易地与 Ant 集成，您可以从 Unix/Linux/Mac 构建 Windows 安装程序，反之亦然。因为生成的安装程序是本机的，所以它们不需要自解压步骤或捆绑 JRE，这意味着安装程序更小，并为您省去了一些麻烦。我还想提一下，我们有开源项目的免费许可证

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T08:03:39.130

我们正在使用 IZPack 一段时间，非常满意。您可以为几乎所有平台构建安装程序，它与您的构建工具（如 maven）很好地集成在一起。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T05:20:19.427

sun 推出了一个新版本：[https](https://openinstaller.dev.java.net/) ://openinstaller.dev.java.net/——这是开源的，sun 将使用它来启动他们的大部分服务器端产品/项目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T05:34:54.420

由于还没有人提到它，我将继续插入[InstallAnywhere](http://www.acresso.com/products/installation/installanywhere.htm)。我们在工作中将它用于我们所有的产品，我不能说我们真的遇到了任何问题（至少不是由我们自己的脚本中的错误引起的！）。这是一个跨平台的 GUI 安装程序，如果您希望使用不同的桌面环境，这是一个很好的功能，它还支持控制台安装程序、静默安装等。

我用谷歌搜索了一下，这里是对 InstallAnywhere的[评论，您可能会觉得有帮助。](http://www.mooreds.com/wordpress/archives/000280)它来自第一次用户，而不是出版物或隐晦的新闻稿，这可能会减少偏见，并更好地指示您使用它的体验可能是什么样的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T21:20:10.827

我建议[InstallJammer](http://www.installjammer.com/)。它不是用 Java 编写的，但它是跨平台的，并提供了在安装过程中处理基于 Java 的应用程序的功能。由于它不是基于 Java，它实际上不需要在目标系统上安装任何版本的 JRE，这很好，但您仍然可以使用安装程序中的操作来为您的 JRE 找到版本应用。安装程序很小且完全独立。

如果这对您很重要，它也是免费和开源的。对某些人来说确实如此。:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-30T02:01:09.090

我知道你说的是安装程序，但我认为值得一提的是 JSmooth。它是一个为 Windows 生成 exe 文件的启动器。值得一提的原因是它执行定位 JVM 的工作，并且还可以为用户下载和安装它。这通常留给安装人员去做。像这样动态地执行它会更好，因为 Java 经常更新，并且 JSmooth 将始终使用它可以找到的最新版本的 JVM（在您的参数内）。

# .net - 在 Microsoft.Sdc.Tasks 中使用 Service Exists MSBuild 任务的示例？

> ID：173393
> 
> 赞同：1
> 
> 时间：2008-10-06T06:53:31.393
> 
> 标签：.net, msbuild

我正在尝试使用`Microsoft.Sdc.Tasks.ServiceProcess.Exists`来检查服务是否存在。但是文档中没有使用它的示例。有人有吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T07:16:41.470

这就是我们如何检查服务是否存在，如果存在则停止它，做一些事情，然后再次启动服务（如果有并且它已经启动）。

辅助目标：

```
<target name="service_exists">
    <script language="C#">
        <references>
            <include name="System.ServiceProcess.dll" />
        </references>
        <code><![CDATA[
            public static void ScriptMain(Project project) {
                String serviceName = project.Properties["service.name"];
                project.Properties["service.exists"] = "false";
                project.Properties["service.running"] = "false";

                System.ServiceProcess.ServiceController[] scServices;
                scServices = System.ServiceProcess.ServiceController.GetServices();

                foreach (System.ServiceProcess.ServiceController scTemp in scServices)
                {
                    if (String.Compare(scTemp.ServiceName.ToUpper(), serviceName.ToUpper()) == 0)
                    {
                        project.Properties["service.exists"] = "true";
                        project.Log(Level.Info, "Service " + serviceName + " exists");
                        if (scTemp.Status.Equals(System.ServiceProcess.ServiceControllerStatus.Running))
                            project.Properties["service.running"] = "true";
                        project.Log(Level.Info, "Service " + serviceName + " is running: " + project.Properties["service.running"]);
                        return;
                    }
                }
                project.Log(Level.Info, "Service " + serviceName + " doesn't exist");
            }
        ]]></code>
    </script>
</target> 
```

用法：

```
<property name="service.name" value="Selection.Service" />
<call target="service_exists" />

<servicecontroller action="Stop" service="${service.name}" machine="${host}" timeout="60000" if="${service.exists}"/>

<!-- Do something -->

<servicecontroller action="Start" service="${service.name}" machine="${host}" timeout="60000" if="${bool::parse(service.exists) and bool::parse(service.running) == true}"/> 
```

希望我没有遗漏任何内容 - 我们的构建管理员将所有内容保存在一个 msbuild 文件中，该文件现在超过 3600 行：|

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T07:07:37.603

我自己实际上并没有在生产中使用它，我不确定你有哪个版本（我有一个版本 2.1.3155.0 的副本），根据随附的 .chm 帮助文件，任务具有以下属性：

*   DoesExist 如果指定的服务存在，则返回 TRUE
*   IsDisabled 如果服务被禁用，则返回 TRUE
*   ServiceName 向系统标识服务的短名称。

ServiceName 需要设置为“向系统标识服务的短名称，例如'W3SVC'”。

您可能想尝试使用众所周知的服务（例如 mssqlserver）并检查其他两个属性的结果（DoesExist/IsDisabled）。

更新：这是一个示例（作品）：

导入任务，然后调用（例如）

<Microsoft.Sdc.Tasks.ServiceProcess.Exists ServiceName="Server"> <Output TaskParameter="DoesExist" PropertyName="Exists" /> </Microsoft.Sdc.Tasks.ServiceProcess.Exists>

< Message Text="服务存在吗？$(Exists)" />

# php - 如何检查 PHP 数组是关联数组还是顺序数组？

> ID：173400
> 
> 赞同：864
> 
> 时间：2008-10-06T07:01:13.140
> 
> 标签：php, arrays

PHP 将所有数组视为关联数组，因此没有任何内置函数。谁能推荐一种相当有效的方法来检查数组是否仅包含数字键？

基本上，我希望能够区分这一点：

```
$sequentialArray = [
    'apple', 'orange', 'tomato', 'carrot'
]; 
```

还有这个：

```
$assocArray = [
    'fruit1' => 'apple',
    'fruit2' => 'orange',
    'veg1' => 'tomato',
    'veg2' => 'carrot'
]; 
```

* * *

## 回答 #1

> 赞同：711
> 
> 时间：2008-10-06T07:36:26.533

您问了两个不太等价的问题：

*   一、如何判断一个数组是否只有数字键
*   其次，如何判断一个数组是否有*顺序*的数字键，从0开始

考虑一下您真正需要哪些行为。（可能两者都可以满足您的目的。）

第一个问题（只需检查所有键都是数字[的）船长 kurO 回答得很好](https://stackoverflow.com/a/4254008/1709587)。

对于第二个问题（检查数组是否是零索引和顺序的），您可以使用以下函数：

```
function isAssoc(array $arr)
{
    if (array() === $arr) return false;
    return array_keys($arr) !== range(0, count($arr) - 1);
}

var_dump(isAssoc(['a', 'b', 'c'])); // false
var_dump(isAssoc(["0" => 'a', "1" => 'b', "2" => 'c'])); // false
var_dump(isAssoc(["1" => 'a', "0" => 'b', "2" => 'c'])); // true
var_dump(isAssoc(["a" => 'a', "b" => 'b', "c" => 'c'])); // true 
```

* * *

## 回答 #2

> 赞同：464
> 
> 时间：2010-11-23T08:24:18.317

仅检查数组是否具有非整数键（而不是数组是顺序索引还是零索引）：

```
function has_string_keys(array $array) {
  return count(array_filter(array_keys($array), 'is_string')) > 0;
} 
```

如果至少有一个字符串键，`$array`将被视为一个关联数组。

* * *

## 回答 #3

> 赞同：145
> 
> 时间：2008-11-05T13:36:30.230

当然，这是一个更好的选择。

```
<?php
$arr = array(1,2,3,4);
$isIndexed = array_values($arr) === $arr; 
```

* * *

## 回答 #4

> 赞同：78
> 
> 时间：2011-05-11T19:34:45.560

这个问题的许多评论者不了解数组在 PHP 中的工作原理。从[数组文档](http://www.php.net/manual/en/language.types.array.php)：

> 键可以是整数或字符串。如果键是整数的标准表示，它将被解释为这样（即“8”将被解释为 8，而“08”将被解释为“08”）。键中的浮点数被截断为整数。索引和关联数组类型在 PHP 中是相同的类型，既可以包含整数索引，也可以包含字符串索引。

换句话说，没有“8”的数组键这样的东西，因为它总是会（默默地）转换为整数 8​​。因此，没有必要尝试区分整数和数字字符串。

如果您想要最有效的方法来检查数组中的非整数键，而无需复制数组的一部分（如 array_keys() 所做的）或全部（如 foreach 所做的）：

```
function keyedNext( &$arr, &$k){
    $k = key($arr);
    return next($arr);
}

for ($k = key(reset($my_array)); is_int($k); keyedNext($my_array,$k))
    $onlyIntKeys = is_null($k); 
```

这是因为 key() 在当前数组位置无效并且 NULL 永远不会是有效键时返回 NULL（如果您尝试将 NULL 用作数组键，它会默默地转换为“”）。

* * *

## 回答 #5

> 赞同：41
> 
> 时间：2012-11-23T02:51:33.453

如[OP 所述](https://stackoverflow.com/q/173400/1402846)：

> PHP 将所有数组视为关联数组

*编写一个检查数组是否为关联*的函数是不太明智的（恕我直言）。所以首先要做的事情[是：PHP 数组中的键是什么](http://php.net/manual/en/language.types.array.php)？：

> *键*可以是**整数**或**字符串**。

这意味着有3种可能的情况：

*   案例1.所有键都是**数字**/**整数**。
*   案例2.所有键都是**字符串**。
*   案例 3\. 一些键是**字符串**，一些键是**数字**/**整数**。

我们可以使用以下功能检查每种情况。

### 情况1：所有键都是**数字**/**整数**。

**注意**：*此函数也为空数组返回**true**。*

```
//! Check whether the input is an array whose keys are all integers.
/*!
    \param[in] $InputArray          (array) Input array.
    \return                         (bool) \b true iff the input is an array whose keys are all integers.
*/
function IsArrayAllKeyInt($InputArray)
{
    if(!is_array($InputArray))
    {
        return false;
    }

    if(count($InputArray) <= 0)
    {
        return true;
    }

    return array_unique(array_map("is_int", array_keys($InputArray))) === array(true);
} 
```

### 情况2：所有键都是**字符串**。

**注意**：*此函数也为空数组返回**true**。*

```
//! Check whether the input is an array whose keys are all strings.
/*!
    \param[in] $InputArray          (array) Input array.
    \return                         (bool) \b true iff the input is an array whose keys are all strings.
*/
function IsArrayAllKeyString($InputArray)
{
    if(!is_array($InputArray))
    {
        return false;
    }

    if(count($InputArray) <= 0)
    {
        return true;
    }

    return array_unique(array_map("is_string", array_keys($InputArray))) === array(true);
} 
```

### 案例 3\. 一些键是**字符串**，一些键是**数字**/**整数**。

**注意**：*此函数也为空数组返回**true**。*

```
//! Check whether the input is an array with at least one key being an integer and at least one key being a string.
/*!
    \param[in] $InputArray          (array) Input array.
    \return                         (bool) \b true iff the input is an array with at least one key being an integer and at least one key being a string.
*/
function IsArraySomeKeyIntAndSomeKeyString($InputArray)
{
    if(!is_array($InputArray))
    {
        return false;
    }

    if(count($InputArray) <= 0)
    {
        return true;
    }

    return count(array_unique(array_map("is_string", array_keys($InputArray)))) >= 2;
} 
```

它遵循：

*   如果值**不是数组**，则**所有 3 个**函数都返回**false**。
*   如果该值是**一个空数组**，则**所有 3 个**函数都返回**true**
    （根据定义，如“[空集是任何集合*A*的子集，因为它的所有元素都属于*A*](http://en.wikipedia.org/wiki/Empty_set#Properties) ”）。
*   如果该值是**一个非空数组**，则**恰好 1 个**函数返回**true**。

* * *

现在，让一个数组成为我们都习惯的*“真正”数组，意思是：*

*   它的键都是**数字**/**整数**。
*   它的键是**连续**的（即按步骤 1 递增）。
*   它的键**[从零开始](http://en.wikipedia.org/wiki/Array_data_type#Index_origin)**。

我们可以使用以下功能进行检查。

### 案例 3a。键是**数字**/**整数**、**顺序**和**从零开始**。

**注意**：*此函数也为空数组返回**true**。*

```
//! Check whether the input is an array whose keys are numeric, sequential, and zero-based.
/*!
    \param[in] $InputArray          (array) Input array.
    \return                         (bool) \b true iff the input is an array whose keys are numeric, sequential, and zero-based.
*/
function IsArrayKeyNumericSequentialZeroBased($InputArray)
{
    if(!is_array($InputArray))
    {
        return false;
    }

    if(count($InputArray) <= 0)
    {
        return true;
    }

    return array_keys($InputArray) === range(0, count($InputArray) - 1);
} 
```

## 警告/陷阱（或者，关于 PHP 中数组键的更奇特的事实）

### 整数键

这些数组的键是**[整数](http://php.net/manual/en/language.types.integer.php)**：

```
array(0 => "b");
array(13 => "b");
array(-13 => "b");          // Negative integers are also integers.
array(0x1A => "b");         // Hexadecimal notation. 
```

### 字符串键

这些数组的键是**[字符串](http://php.net/manual/en/language.types.string.php)**：

```
array("fish and chips" => "b");
array("" => "b");                                   // An empty string is also a string.
array("stackoverflow_email@example.com" => "b");    // Strings may contain non-alphanumeric characters.
array("stack\t\"over\"\r\nflow's cool" => "b");     // Strings may contain special characters.
array('$tα€k↔øv∈rflöw⛄' => "b");                    // Strings may contain all kinds of symbols.
array("functіon" => "b");                           // You think this looks fine? Think again! (see https://stackoverflow.com/q/9246051/1402846)
array("ま말轉转ДŁ" => "b");                         // How about Japanese/Korean/Chinese/Russian/Polish?
array("fi\x0sh" => "b");                            // Strings may contain null characters.
array(file_get_contents("https://www.google.com/images/nav_logo114.png") => "b");   // Strings may even be binary! 
```

### 看起来像字符串的整数键

如果你认为 key in`array("13" => "b")`是一个*字符串*，那**你就错了**。从[这里](http://php.net/manual/en/language.types.array.php)的文档：

> 包含有效整数的字符串将被转换为整数类型。例如，键“8”实际上将存储在 8 下。另一方面，“08”不会被强制转换，因为它不是有效的十进制整数。

例如，这些数组的键是**整数**：

```
array("13" => "b");
array("-13" => "b");                        // Negative, ok. 
```

但是这些数组的关键是**字符串**：

```
array("13." => "b");
array("+13" => "b");                        // Positive, not ok.
array("-013" => "b");
array("0x1A" => "b");                       // Not converted to integers even though it's a valid hexadecimal number.
array("013" => "b");                        // Not converted to integers even though it's a valid octal number.
array("18446744073709551616" => "b");       // Not converted to integers as it can't fit into a 64-bit integer. 
```

更重要的是，根据[文档](http://www.php.net/manual/en/language.types.integer.php)，

> 整数的大小取决于平台，尽管通常值约为 20 亿的最大值（即 32 位有符号）。64 位平台的最大值通常约为 9E18，Windows 除外，它始终为 32 位。PHP 不支持无符号整数。

所以这个数组的键可能是**也可能不是***整数*——这取决于你的平台。

```
array("60000000000" => "b");                // Array key could be integer or string, it can fit into a 64-bit (but not 32-bit) integer. 
```

更糟糕的是，如果整数接近 2 ^(31) = 2,147,483,648 边界，PHP 往往会出现**错误（请参阅**[错误 51430](https://bugs.php.net/bug.php?id=51430)和[错误 52899](https://bugs.php.net/bug.php?id=52899)）。例如，在我的本地环境中（Windows 7 上 XAMPP 1.7.7 上的 PHP 5.3.8），给出^(`var_dump(array("2147483647" => "b"))`)

```
array(1) {
    [2147483647]=>
    string(1) "b"
} 
```

但是在[键盘上的这个现场演示](http://codepad.org/NK87Msp1)（PHP 5.2.5）上，同样的表达式给出了

```
array(1) {
    ["2147483647"]=>
    string(1) "b"
} 
```

因此，密钥在一种环境中是*整数*，但在另一种环境中是*字符串*，即使`2147483647`是有效的有符号 32 位*整数*。

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2011-08-06T17:39:10.800

**速度方面：**

```
function isAssoc($array)
{
    return ($array !== array_values($array));
} 
```

**内存方面：**

```
function isAssoc($array)
{
    $array = array_keys($array); return ($array !== array_keys($array));
} 
```

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2009-03-17T01:38:06.553

实际上最有效的方法是：

```
function is_assoc($array){
   $keys = array_keys($array);
   return $keys !== array_keys($keys);
} 
```

这是有效的，因为它将键（对于顺序数组始终为 0、1、2 等）与键的键（*始终*为 0、1、2 等）进行比较。

Laravel 使用[这种方法](https://github.com/laravel/framework/blob/8.x/src/Illuminate/Collections/Arr.php#L389)。

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2010-03-15T01:59:07.380

```
function checkAssoc($array){
    return  ctype_digit( implode('', array_keys($array) ) );
} 
```

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2010-10-07T15:47:47.193

我已经使用了两个`array_keys($obj) !== range(0, count($obj) - 1)`and `array_values($arr) !== $arr`（它们是彼此的对偶，虽然第二个比第一个便宜）但是对于非常大的阵列都失败了。

这是因为`array_keys`两者`array_values`都是非常昂贵的操作（因为它们构建了一个与原始大小大致相同的全新数组）。

下面的函数比上面提供的方法更健壮：

```
function array_type( $obj ){
    $last_key = -1;
    $type = 'index';
    foreach( $obj as $key => $val ){
        if( !is_int( $key ) || $key < 0 ){
            return 'assoc';
        }
        if( $key !== $last_key + 1 ){
            $type = 'sparse';
        }
        $last_key = $key;
    }
    return $type;
} 
```

另请注意，如果您不想区分稀疏数组和关联数组，您可以简单地`'assoc'`从两个`if`块中返回。

最后，虽然这看起来比这个页面上的许多“解决方案”要“优雅”得多，但实际上它的效率要高得多。几乎任何关联数组都会被立即检测到。只有索引数组会被彻底检查，上面概述的方法不仅会彻底检查索引数组，还会复制它们。

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2012-07-15T21:54:50.697

我认为以下两个函数是检查“数组是关联数组还是数字数组”的最佳方法。由于“数字”可能仅表示数字键或仅表示顺序数字键，因此下面列出了两个检查任一条件的函数：

```
function is_indexed_array(&$arr) {
  for (reset($arr); is_int(key($arr)); next($arr));
  return is_null(key($arr));
}

function is_sequential_array(&$arr, $base = 0) {
  for (reset($arr), $base = (int) $base; key($arr) === $base++; next($arr));
  return is_null(key($arr));
} 
```

第一个函数检查每个键是否是整数值。第二个函数检查每个键是否是整数值，此外还检查所有键是否从 $base 开始顺序排列，默认为 0，因此如果您不需要指定另一个基值，则可以省略。key($my_array) 如果读取指针移过数组末尾，则返回 null，这是结束 for 循环的原因，并且如果所有键都是整数，则 for 循环之后的语句返回 true。如果不是，则循环过早结束，因为键是字符串类型，并且 for 循环之后的语句将返回 false。后一个函数还在每次比较后向 $base 添加一个，以便能够检查下一个键是否具有正确的值。严格比较使其还检查键是否为整数类型。如果省略 $base 或确保仅使用整数调用它，则 for 循环第一部分中的 $base = (int) $base 部分可以省略。但由于我不能确定每个人，我把它留在里面。无论如何，该语句只执行一次。我认为这些是最有效的解决方案：

*   内存方面：不复制数据或键范围。执行 array_values 或 array_keys 可能看起来更短（代码更少），但请记住，一旦你进行了调用，后台会发生什么。是的，与其他一些解决方案相比，有更多（可见的）语句，但这并不重要，不是吗？
*   时间明智：除了复制/提取数据和/或密钥也需要时间这一事实外，此解决方案比执行 foreach 更有效。同样，对于某些人来说，foreach 似乎更有效，因为它的符号更短，但在后台 foreach 也调用 reset、key 和 next 来执行它的循环。但除此之外，它还调用 valid 来检查结束条件，由于与整数检查相结合，这里避免了这种情况。

请记住，数组键只能是整数或字符串，而严格的数字字符串如“1”（但不是“01”）将被转换为整数。如果您希望数组是连续的，那么除了计数之外，这就是检查整数键唯一需要的操作的原因。自然，如果 is_indexed_array 返回 false，则可以将数组视为关联数组。我说“看到”，因为事实上它们都是。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2020-09-07T15:52:28.640

### 这是另一个简单但强大的逻辑（伟大的 Laravel 框架也使用它的内部机制）

```
/**
 * Determines if an array is associative.
 * @param  array  $array
 * @return bool
 */
function isAssoc(array $array)
{
    $keys = array_keys($array);

    return array_keys($keys) !== $keys;
} 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2021-06-09T06:39:15.137

PHP 8.1 添加了一个内置函数来确定数组是否是具有这些语义的列表。功能是[`array_is_list`](https://wiki.php.net/rfc/is_list)：

```
$list = ["a", "b", "c"];

array_is_list($list); // true

$notAList = [1 => "a", 2 => "b", 3 => "c"];

array_is_list($notAList); // false

$alsoNotAList = ["a" => "a", "b" => "b", "c" => "c"];

array_is_list($alsoNotAList); // false 
```

[参考](https://stitcher.io/blog/new-in-php-81)

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2016-01-20T19:18:57.400

解决此问题的一种方法是搭载`json_encode`，它已经有自己的内部方法来区分关联数组和索引数组以输出正确的 JSON。

您可以通过检查编码后返回的第一个字符是`{`（关联数组）还是`[`（索引数组）来做到这一点。

```
// Too short :)
function is_assoc($arr) {
    ksort($arr);
    return json_encode($arr)[0] === '{';
} 
```

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2016-03-08T04:02:54.187

```
function array_is_assoc(array $a) {
    $i = 0;
    foreach ($a as $k => $v) {
        if ($k !== $i++) {
            return true;
        }
    }
    return false;
} 
```

快速、简洁、高效的内存。没有昂贵的比较、函数调用或数组复制。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2010-10-08T00:42:18.520

这个函数可以处理：

*   索引中有孔的数组（例如 1,2,4,5,8,10）
*   带有“0x”键的数组：例如，键“08”是关联的，而键“8”是连续的。

这个想法很简单：如果其中一个键不是整数，则它是关联数组，否则它是顺序的。

```
function is_asso($a){
    foreach(array_keys($a) as $key) {if (!is_int($key)) return TRUE;}
    return FALSE;
} 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2017-04-05T17:27:35.323

已经有很多答案了，但这是 Laravel 在其 Arr 类中依赖的方法：

```
/**
 * Determines if an array is associative.
 *
 * An array is "associative" if it doesn't have sequential numerical keys beginning with zero.
 *
 * @param  array  $array
 * @return bool
 */
public static function isAssoc(array $array)
{
    $keys = array_keys($array);

    return array_keys($keys) !== $keys;
} 
```

来源：[https ://github.com/laravel/framework/blob/5.4/src/Illuminate/Support/Arr.php](https://github.com/laravel/framework/blob/5.4/src/Illuminate/Support/Arr.php)

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2013-02-20T10:32:10.783

我注意到这个问题有两种流行的方法：一种 using`array_values()`和另一种 using `key()`。为了找出哪个更快，我写了一个小程序：

```
$arrays = Array(
  'Array #1' => Array(1, 2, 3, 54, 23, 212, 123, 1, 1),
  'Array #2' => Array("Stack", 1.5, 20, Array(3.4)),
  'Array #3' => Array(1 => 4, 2 => 2),
  'Array #4' => Array(3.0, "2", 3000, "Stack", 5 => "4"),
  'Array #5' => Array("3" => 4, "2" => 2),
  'Array #6' => Array("0" => "One", 1.0 => "Two", 2 => "Three"),
  'Array #7' => Array(3 => "asdf", 4 => "asdf"),
  'Array #8' => Array("apple" => 1, "orange" => 2),
);

function is_indexed_array_1(Array &$arr) {
  return $arr === array_values($arr);
}

function is_indexed_array_2(Array &$arr) {
  for (reset($arr), $i = 0; key($arr) === $i++; next($arr))
    ;
  return is_null(key($arr));
}

// Method #1
$start = microtime(true);
for ($i = 0; $i < 1000; $i++) {
  foreach ($arrays as $array) {
    $dummy = is_indexed_array_1($array);
  }
}
$end = microtime(true);
echo "Time taken with method #1 = ".round(($end-$start)*1000.0,3)."ms\n";

// Method #2
$start = microtime(true);
for ($i = 0; $i < 1000; $i++) {
  foreach ($arrays as $array) {
    $dummy = is_indexed_array_2($array);
  }
}
$end = microtime(true);
echo "Time taken with method #1 = ".round(($end-$start)*1000.0,3)."ms\n"; 
```

CentOS 上 PHP 5.2 程序的输出如下：

> 方法 #1
> 所用时间 = 10.745ms 方法 #2 所用时间 = 18.239ms

PHP 5.3 的输出产生了类似的结果。显然使用`array_values()`起来要快得多。

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2020-09-01T09:59:00.353

大多数答案具有次优的时间/空间复杂性或正在改变语义。因此，这是另一个**最快**且**功能最正确**的解决方案的答案：

```
function is_sequential_array(Array &$a) {
    $n = count($a);
    for($i=0; $i<$n; $i++) {
        if(!array_key_exists($i, $a)) {
            return false;
        }
    }
    return true;
} 
```

与其他答案相比，此答案具有以下优势：

1.  空间复杂度`O(1)`（这里的许多答案都使用`O(n)`空间！）
2.  不对键应用相等性（这是一个不需要且昂贵的操作）
3.  将输入数组视为不可变（许多答案通过应用变异函数隐式创建了一个副本）
4.  使用函数`array_key_exists`而不是`isset`（记住，`isset`另外检查“不为空”，从而改变语义）
5.  最坏情况时间复杂度是`O(n)`（这里的许多答案的最佳情况时间复杂度为`O(n)`）

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2013-07-10T23:29:21.160

我知道向这个庞大的队列添加答案有点毫无意义，但这是一个不需要复制任何值的可读 O(n) 解决方案：

```
function isNumericArray($array) {
    $count = count($array);
    for ($i = 0; $i < $count; $i++) {
        if (!isset($array[$i])) {
            return FALSE;
        }
    }
    return TRUE;
} 
```

不是检查键以查看它们是否都是数字，而是遍历数字数组中存在的键*并*确保它们存在。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2015-10-16T06:19:09.093

通过使用[xarray](https://github.com/c9s/xarray) PHP 扩展

你可以非常快地做到这一点（在 PHP 5.6 中大约快 30 倍以上）：

```
if (array_is_indexed($array)) {  } 
```

或者：

```
if (array_is_assoc($array)) {  } 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2018-01-14T08:36:46.540

经过一些本地基准测试、调试、编译器探测、分析和滥用 3v4l.org 以跨多个版本进行基准测试（是的，我收到停止警告）并与我能找到的每个变体进行比较......

我给你一个有机派生的**最佳平均最坏情况**关联数组测试函数，它在*最坏*的情况下大致与所有其他平均情况一样好或更好。

```
/**
 * Tests if an array is an associative array.
 *
 * @param array $array An array to test.
 * @return boolean True if the array is associative, otherwise false.
 */
function is_assoc(array &$arr) {
    // don't try to check non-arrays or empty arrays
    if (FALSE === is_array($arr) || 0 === ($l = count($arr))) {
        return false;
    }

    // shortcut by guessing at the beginning
    reset($arr);
    if (key($arr) !== 0) {
        return true;
    }

    // shortcut by guessing at the end
    end($arr);
    if (key($arr) !== $l-1) {
        return true;
    }

    // rely on php to optimize test by reference or fast compare
    return array_values($arr) !== $arr;
} 
```

来自[https://3v4l.org/rkieX](https://3v4l.org/rkieX)：

```
<?php

// array_values
function method_1(Array &$arr) {
    return $arr === array_values($arr);
}

// method_2 was DQ; did not actually work

// array_keys
function method_3(Array &$arr) {
    return array_keys($arr) === range(0, count($arr) - 1);
}

// foreach
function method_4(Array &$arr) {
    $idx = 0;
    foreach( $arr as $key => $val ){
        if( $key !== $idx )
            return FALSE;
        ++$idx;
    }
    return TRUE;
}

// guessing
function method_5(Array &$arr) {
    global $METHOD_5_KEY;
    $i = 0;
    $l = count($arr)-1;

    end($arr);
    if ( key($arr) !== $l )
        return FALSE;

    reset($arr);
    do {
        if ( $i !== key($arr) )
            return FALSE;
        ++$i;
        next($arr);
    } while ($i < $l);
    return TRUE;
}

// naieve
function method_6(Array &$arr) {
    $i = 0;
    $l = count($arr);
    do {
        if ( NULL === @$arr[$i] )
            return FALSE;
        ++$i;
    } while ($i < $l);
    return TRUE;
}

// deep reference reliance
function method_7(Array &$arr) {
    return array_keys(array_values($arr)) === array_keys($arr);
}

// organic (guessing + array_values)
function method_8(Array &$arr) {
    reset($arr);
    if ( key($arr) !== 0 )
        return FALSE;

    end($arr);
    if ( key($arr) !== count($arr)-1 )
        return FALSE;

    return array_values($arr) === $arr;
}

function benchmark(Array &$methods, Array &$target, $expected){    
    foreach($methods as $method){
        $start = microtime(true);
        for ($i = 0; $i < 2000; ++$i) {
            //$dummy = call_user_func($method, $target);
            if ( $method($target) !== $expected ) {
                echo "Method $method is disqualified for returning an incorrect result.\n";
                unset($methods[array_search($method,$methods,true)]);
                $i = 0;
                break;
            }
        }
        if ( $i != 0 ) {
            $end = microtime(true);
            echo "Time taken with $method = ".round(($end-$start)*1000.0,3)."ms\n";
        }
    }
}

$true_targets = [
    'Giant array' => range(0, 500),
    'Tiny array' => range(0, 20),
];

$g = range(0,10);
unset($g[0]);

$false_targets = [
    'Large array 1' => range(0, 100) + ['a'=>'a'] + range(101, 200),
    'Large array 2' => ['a'=>'a'] + range(0, 200),
    'Tiny array' => range(0, 10) + ['a'=>'a'] + range(11, 20),
    'Gotcha array' => $g,
];

$methods = [
    'method_1',
    'method_3',
    'method_4',
    'method_5',
    'method_6',
    'method_7',
    'method_8'
];

foreach($false_targets as $targetName => $target){
    echo "==== Benchmark using $targetName expecing FALSE ====\n";
    benchmark($methods, $target, false);
    echo "\n";
}
foreach($true_targets as $targetName => $target){
    echo "==== Benchmark using $targetName expecting TRUE ====\n";
    benchmark($methods, $target, true);
    echo "\n";
} 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2019-05-10T03:56:13.697

这里的很多解决方案都很优雅漂亮，但扩展性不好，而且是内存密集型或 CPU 密集型的。大多数人都在比较双方使用此解决方案在内存中创建 2 个新数据点。阵列越大，使用的进程和内存就越难、越长，您就会失去短路评估的好处。我用一些不同的想法做了一些测试。尽量避免使用 array_key_exists，因为它成本高昂，并且还避免创建新的大型数据集进行比较。我觉得这是一种判断数组是否是顺序的简单方法。

```
public function is_sequential( $arr = [] ){
    if( !is_array( $arr ) || empty( $arr ) ) return false;

    $i = 0;

    $total = count( $arr );

    foreach( $arr as $key => $value ) if( $key !== $i++ ) return false;

    return true;
} 
```

您在主数组上运行一个计数并存储一个整数。然后，您循环遍历数组并在迭代计数器时检查是否完全匹配。你应该从 1 开始计数。如果它失败了，它会短路，当它是假的时，它会给你带来性能提升。

最初我使用 for 循环并检查 isset( $arr[$i] ) 来执行此操作，但这不会检测到需要 array_key_exists 的空键，并且我们知道这是用于提高速度的最差函数。

通过 foreach 不断更新变量以检查迭代器永远不会超过它的整数大小让 PHP 使用它内置的内存优化、缓存和垃圾收集来保持非常低的资源使用率。

另外，我会争辩说，当您可以简单地运行 $key => $value 并检查密钥时，在 foreach 中使用 array_keys 是愚蠢的。为什么要创建新数据点？一旦你抽象出数组键，你就会立即消耗更多的内存。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2011-02-04T21:55:02.390

这可能是解决方案吗？

```
 public static function isArrayAssociative(array $array) {
      reset($array);
      return !is_int(key($array));
  } 
```

警告显然是数组游标被重置，但我想说可能在数组被遍历或使用之前使用了该函数。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2011-07-22T19:29:46.130

这是我使用的方法：

```
function is_associative ( $a )
{
    return in_array(false, array_map('is_numeric', array_keys($a)));
}

assert( true === is_associative(array(1, 2, 3, 4)) );

assert( false === is_associative(array('foo' => 'bar', 'bar' => 'baz')) );

assert( false === is_associative(array(1, 2, 3, 'foo' => 'bar')) ); 
```

请注意，这不考虑特殊情况，例如：

```
$a = array( 1, 2, 3, 4 );

unset($a[1]);

assert( true === is_associative($a) ); 
```

抱歉，不能帮你。它对于大小适中的数组也有一定的性能，因为它不会制作不必要的副本。正是这些小东西让 Python 和 Ruby 写得更好...... :P

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2012-05-16T08:16:26.050

```
<?php

function is_list($array) {
    return array_keys($array) === range(0, count($array) - 1);
}

function is_assoc($array) {
    return count(array_filter(array_keys($array), 'is_string')) == count($array);
}

?> 
```

这两个得分最高的例子都不能与像这样的数组一起正常工作`$array = array('foo' => 'bar', 1)`

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2012-06-21T11:14:58.860

这也可以（[演示](http://codepad.viper-7.com/AFSXXC)）：

```
function array_has_numeric_keys_only(array $array)
{
    try {
        SplFixedArray::fromArray($array, true);
    } catch (InvalidArgumentException $e) {
        return false;
    }
    return true;
} 
```

请注意，此答案的主要目的是告知您存在此类测试，`SplFixedArray`而不是鼓励您使用 Exceptions 进行此类测试。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2012-12-25T00:46:57.847

我认为标量数组的定义会因应用程序而异。也就是说，一些应用程序需要更严格地理解什么是标量数组，而一些应用程序需要更宽松的意义。

下面我介绍了 3 种不同严格程度的方法。

```
<?php
/**
 * Since PHP stores all arrays as associative internally, there is no proper
 * definition of a scalar array.
 * 
 * As such, developers are likely to have varying definitions of scalar array,
 * based on their application needs.
 * 
 * In this file, I present 3 increasingly strict methods of determining if an
 * array is scalar.
 * 
 * @author David Farrell <DavidPFarrell@gmail.com>
 */

/**
 * isArrayWithOnlyIntKeys defines a scalar array as containing
 * only integer keys.
 * 
 * If you are explicitly setting integer keys on an array, you
 * may need this function to determine scalar-ness.
 * 
 * @param array $a
 * @return boolean
 */ 
function isArrayWithOnlyIntKeys(array $a)
{
    if (!is_array($a))
        return false;
    foreach ($a as $k => $v)
        if (!is_int($k))
            return false;
    return true;
}

/**
 * isArrayWithOnlyAscendingIntKeys defines a scalar array as
 * containing only integer keys in ascending (but not necessarily
 * sequential) order.
 * 
 * If you are performing pushes, pops, and unsets on your array,
 * you may need this function to determine scalar-ness.
 * 
 * @param array $a
 * @return boolean
 */ 
function isArrayWithOnlyAscendingIntKeys(array $a)
{
    if (!is_array($a))
        return false;
    $prev = null;
    foreach ($a as $k => $v)
    {
        if (!is_int($k) || (null !== $prev && $k <= $prev))
            return false;
        $prev = $k;
    }
    return true;
}

/**
 * isArrayWithOnlyZeroBasedSequentialIntKeys defines a scalar array
 * as containing only integer keys in sequential, ascending order,
 * starting from 0.
 * 
 * If you are only performing operations on your array that are
 * guaranteed to either maintain consistent key values, or that
 * re-base the keys for consistency, then you can use this function.
 * 
 * @param array $a
 * @return boolean
 */
function isArrayWithOnlyZeroBasedSequentialIntKeys(array $a)
{
    if (!is_array($a))
        return false;
    $i = 0;
    foreach ($a as $k => $v)
        if ($i++ !== $k)
            return false;
    return true;
} 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2014-07-09T09:46:56.427

我的解决方案：

```
function isAssociative(array $array)
{
    return array_keys(array_merge($array)) !== range(0, count($array) - 1);
} 
```

`array_merge`在单个数组上将重新索引所有`integer`键，但不会重新索引其他键。例如：

```
array_merge([1 => 'One', 3 => 'Three', 'two' => 'Two', 6 => 'Six']);

// This will returns [0 => 'One', 1 => 'Three', 'two' => 'Two', 2 => 'Six'] 
```

因此，如果创建了一个列表（非关联数组），`['a', 'b', 'c']`然后删除了一个值，`unset($a[1])`然后`array_merge`调用，则该列表从 0 开始重新索引。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2014-08-08T14:45:24.670

[从源头](https://github.com/ephrin/structures/blob/master/Ephrin/Structures/ArrayStructure.php)再快一点。`json_encode`( 和`bson_encode`)的拟合编码。javascript 数组合规性也是如此。

```
function isSequential($value){
    if(is_array($value) || ($value instanceof \Countable && $value instanceof \ArrayAccess)){
        for ($i = count($value) - 1; $i >= 0; $i--) {
            if (!isset($value[$i]) && !array_key_exists($i, $value)) {
                return false;
            }
        }
        return true;
    } else {
        throw new \InvalidArgumentException(
            sprintf('Data type "%s" is not supported by method %s', gettype($value), __METHOD__)
        );
    }
} 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2016-07-04T11:42:15.487

答案已经给出，但是关于性能的虚假信息太多了。我编写了这个小基准脚本，它表明 foreach 方法是最快的。

免责声明：以下方法是从其他答案中复制粘贴的

```
<?php

function method_1(Array &$arr) {
    return $arr === array_values($arr);
}

function method_2(Array &$arr) {
    for (reset($arr), $i = 0; key($arr) !== $i++; next($arr));
    return is_null(key($arr));
}

function method_3(Array &$arr) {
    return array_keys($arr) === range(0, count($arr) - 1);
}

function method_4(Array &$arr) {
    $idx = 0;
    foreach( $arr as $key => $val ){
        if( $key !== $idx )
            return FALSE;
        $idx++;
    }
    return TRUE;
}

function benchmark(Array $methods, Array &$target){    
    foreach($methods as $method){
        $start = microtime(true);
        for ($i = 0; $i < 1000; $i++)
            $dummy = call_user_func($method, $target);

        $end = microtime(true);
        echo "Time taken with $method = ".round(($end-$start)*1000.0,3)."ms\n";
    }
}

$targets = [
    'Huge array' => range(0, 30000),
    'Small array' => range(0, 1000),
];
$methods = [
    'method_1',
    'method_2',
    'method_3',
    'method_4',
];
foreach($targets as $targetName => $target){
    echo "==== Benchmark using $targetName ====\n";
    benchmark($methods, $target);
    echo "\n";
} 
```

结果：

```
==== Benchmark using Huge array ====
Time taken with method_1 = 5504.632ms
Time taken with method_2 = 4509.445ms
Time taken with method_3 = 8614.883ms
Time taken with method_4 = 2720.934ms

==== Benchmark using Small array ====
Time taken with method_1 = 77.159ms
Time taken with method_2 = 130.03ms
Time taken with method_3 = 160.866ms
Time taken with method_4 = 69.946ms 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2018-09-05T22:42:04.153

或者你可以使用这个：

```
Arr::isAssoc($array) 
```

这将检查数组是否包含**任何非数字键**或：

```
Arr:isAssoc($array, true) 
```

检查数组**是否严格顺序** （包含自动生成的 int 键*0*到*n-1*）

使用[这个](https://github.com/minwork/array)库。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2019-10-02T13:41:40.493

当涉及到 php 数组时，这个问题实际上是无用的，因为根据 php 的性质，数组不应该是完全关联的或索引的，它可以是两者的组合，用户定义和分配数组值的方式可以是两者的结合。见下面的例子

```
$y= array(5);
$y["0x"]="n";
$y["vbg"]="12132";
$y[1] = "k";

var_dump($y); //this will output 4 element array

echo "</br>" .$y["0x"]."</br>".$y[0];

for($x=0;$x<sizeof($y);$x++){ // this will output all index elements & gives error after that
    echo "</br> index elements ".$y[$x];
} 
```

所以必须问的正确问题是，数组中的所有元素都是关联的还是索引的。如果您真的知道它只是关联或索引而不是这两者的组合，您可以简单地使用此方法来查找它是索引还是关联数组。

```
function AssocTest(&$arr){
    if(is_array($arr)){

        reset($arr); // reset pointer to first element of array

        if(gettype(key($arr)) == "string"){ //get the type(nature) of first element key 
            return true;
        }else{
            return false;
        }
    }else{
        return false;
    }
} 
```

您可以将其用作正常功能

```
echo(AssocTest($y)?  "Associative array": "Not an Associative array/ Not an array at all"); 
```

重要的是要记住，埃文你已经将一个数组初始化为关联数组，但是你给关联数组的名称只是数字，如果你没有明确给出字符串名称，它将在 php 读取时将其视为索引数组。看看下面的例子。

```
$y["0"]="n";
$y["1"]="12132";
$y["22"] = "k";

//both will get the same output
echo "<br/> s0 ".$y["22"];
echo "<br/> s0 ".$y[22];

for($x=0;$x<count($y);$x++){
   echo "<br/> arr ".$y[$x]; // this will output up to 2nd element and give an error after

} 
```

因此，如果您需要确保数组的所有元素都被精确索引或关联，没有其他办法，只能验证所有元素并通过生成的索引数组检查每个元素键，正如许多人在这里发布的那样。

```
function fullAssocTest(&$arr)
{
    if(is_array($arr)){
        return (array_keys($arr) !== range(0, count($arr) - 1));
    }
} 
```

它的编码较少，但这确实是过程密集型且真正不必要的工作。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2020-03-17T10:35:30.413

有时你可以只检查第一个数组的 Key 是否为 0。

`$isSequential = array_keys($arr)[0] === 0`

，或者，更快，但更详细的版本：

`reset($arr); $isSequential = key($arr) === 0`

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-10-06T07:06:15.487

除非 PHP 有一个内置函数，否则你将无法在小于 O(n) 的时间内完成它 - 枚举所有键并检查整数类型。实际上，您还想确保没有漏洞，因此您的算法可能如下所示：

```
for i in 0 to len(your_array):
    if not defined(your-array[i]):
        # this is not an array array, it's an associative array :) 
```

但是为什么要打扰呢？只需假设数组是您期望的类型。如果不是，它只会在你的脸上爆炸——这就是你的动态编程！测试你的代码，一切都会好起来的......

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-10-06T07:17:18.663

```
function is_associative($arr) {
  return (array_merge($arr) !== $arr || count(array_filter($arr, 'is_string', ARRAY_FILTER_USE_KEY)) > 0);
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-10-06T09:56:22.523

还有另一种方法来做到这一点。

```
function array_isassociative($array)
{
    // Create new Array,  Make it the same size as the input array
    $compareArray = array_pad(array(), count($array), 0);

    // Compare the two array_keys
    return (count(array_diff_key($array, $compareArray))) ? true : false;

} 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-05-15T15:04:49.200

我比较了数组的键和数组的 array_values() 结果的键之间的差异，这将始终是具有整数索引的数组。如果键相同，则它不是关联数组。

```
function isHash($array) {
    if (!is_array($array)) return false;
    $diff = array_diff_assoc($array, array_values($array));
    return (empty($diff)) ? false : true;
} 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2011-04-19T19:02:07.050

修改最受欢迎的答案。
这需要更多的处理，但更准确。

```
<?php
//$a is a subset of $b
function isSubset($a, $b)
{
    foreach($a =>$v)
        if(array_search($v, $b) === false)
            return false;

    return true;

    //less effecient, clearer implementation. (uses === for comparison)
    //return array_intersect($a, $b) === $a;
}

function isAssoc($arr)
{
    return !isSubset(array_keys($arr), range(0, count($arr) - 1));
}

var_dump(isAssoc(array('a', 'b', 'c'))); // false
var_dump(isAssoc(array(1 => 'a', 0 => 'b', 2 => 'c'))); // false
var_dump(isAssoc(array("0" => 'a', "1" => 'b', "2" => 'c'))); // false 
//(use === in isSubset to get 'true' for above statement)
var_dump(isAssoc(array("a" => 'a', "b" => 'b', "c" => 'c'))); // true
?> 
```

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2018-09-11T11:53:33.170

我想出了下一个方法：

```
function isSequential(array $list): bool
{
    $i = 0;
    $count = count($list);
    while (array_key_exists($i, $list)) {
        $i += 1;
        if ($i === $count) {
            return true;
        }
    }

    return false;
}

var_dump(isSequential(array())); // false
var_dump(isSequential(array('a', 'b', 'c'))); // true
var_dump(isSequential(array("0" => 'a', "1" => 'b', "2" => 'c'))); // true
var_dump(isSequential(array("1" => 'a', "0" => 'b', "2" => 'c'))); // true
var_dump(isSequential(array("1a" => 'a', "0b" => 'b', "2c" => 'c'))); // false
var_dump(isSequential(array("a" => 'a', "b" => 'b', "c" => 'c'))); // false 
```

*注意空数组不被视为顺序数组，但我认为这很好，因为空数组就像 0 - 不管它是加号还是减号，它都是空的。

与上面列出的一些方法相比，以下是此方法的优点：

*   它不涉及复制数组（此要点中提到的人[https://gist.github.com/Thinkscape/1965669](https://gist.github.com/Thinkscape/1965669)不`array_values`涉及复制 - 什么！？？**它肯定会 - 如下所示**）
*   更大的数组更快，同时对内存更友好

我使用了由[Artur Bodera](https://stackoverflow.com/users/181664/)提供的基准，我将其中一个数组更改为 1M 元素 ( `array_fill(0, 1000000, uniqid()), // big numeric array`)。

以下是 100 次迭代的结果：

```
PHP 7.1.16 (cli) (built: Mar 31 2018 02:59:59) ( NTS )

Initial memory: 32.42 MB
Testing my_method (isset check) - 100 iterations
  Total time: 2.57942 s
  Total memory: 32.48 MB

Testing method3 (array_filter of keys) - 100 iterations
  Total time: 5.10964 s
  Total memory: 64.42 MB

Testing method1 (array_values check) - 100 iterations
  Total time: 3.07591 s
  Total memory: 64.42 MB

Testing method2 (array_keys comparison) - 100 iterations
  Total time: 5.62937 s
  Total memory: 96.43 MB 
```

*方法是根据它们的内存消耗排序的

**我曾经`echo " Total memory: " . number_format(memory_get_peak_usage()/1024/1024, 2) . " MB\n";`显示内存使用情况

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2022-01-06T21:22:34.897

对于那些使用 Laravel 的人：

`Arr::isAssoc`如果给定数组是关联数组，则返回 true。如果一个数组没有以零开头的连续数字键，则该数组被认为是“关联的”：

```
use Illuminate\Support\Arr;

$isAssoc = Arr::isAssoc(['product' => ['name' => 'Desk', 'price' => 100]]);

// true

$isAssoc = Arr::isAssoc([1, 2, 3]);

// false 
```

[https://laravel.com/docs/8.x/helpers#method-array-isassoc](https://laravel.com/docs/8.x/helpers#method-array-isassoc)

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2022-02-25T14:11:20.857

只需加上我的两美分，我认为根据@nonsensei 的基准，它应该非常有效并且清晰易读：

```
function is_associative(array $array): bool
{
    foreach ($array as $key => $value)
    {
        if (!is_string($key)) return false;
    }
    return true;
} 
```

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2008-10-06T07:14:48.947

一种廉价而肮脏的方法是这样检查：

```
isset($myArray[count($myArray) - 1]) 
```

...如果您的数组是这样的，您可能会得到误报：

```
$myArray = array("1" => "apple", "b" => "banana"); 
```

更彻底的方法可能是检查密钥：

```
function arrayIsAssociative($myArray) {
    foreach (array_keys($myArray) as $ind => $key) {
        if (!is_numeric($key) || (isset($myArray[$ind + 1]) && $myArray[$ind + 1] != $key + 1)) {
            return true;
        }
    }
    return false;
}
// this will only return true if all the keys are numeric AND sequential, which
// is what you get when you define an array like this:
// array("a", "b", "c", "d", "e"); 
```

或者

```
function arrayIsAssociative($myArray) {
    $l = count($myArray);
    for ($i = 0; $i < $l, ++$i) {
        if (!isset($myArray[$i])) return true;
    }
    return false;
}
// this will return a false positive on an array like this:
$x = array(1 => "b", 0 => "a", 2 => "c", 4 => "e", 3 => "d"); 
```

* * *

## 回答 #43

> 赞同：-1
> 
> 时间：2011-09-03T13:02:15.053

几天前我再次遇到了这个问题，我想利用 array_merge 特殊属性：

> 如果输入数组具有相同的**字符串键**，则该键的后一个值**将覆盖前一个**值。但是，如果数组包含**数字键**，则**后面的值不会覆盖原始值，而是会被追加**。带有数字键的输入数组中的值将使用从结果数组中的零开始的递增键重新编号。那么为什么不使用：

```
function Is_Indexed_Arr($arr){
    $arr_copy = $arr;
    if((2*count($arr)) == count(array_merge($arr, $arr_copy))){
        return 1;
    }
    return 0;
} 
```

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2011-12-17T03:58:46.187

我的解决方案是获取如下数组的键并检查键是否不是整数：

```
private function is_hash($array) {
    foreach($array as $key => $value) {
        return ! is_int($key);
    }
    return false;
} 
```

获取如下哈希数组的 array_keys 是错误的：

```
array_keys(array(
       "abc" => "gfb",
       "bdc" => "dbc"
       )
); 
```

将输出：

```
array(
       0 => "abc",
       1 => "bdc"
) 
```

因此，将其与评分最高的答案中提到的一系列数字进行比较并不是一个好主意。如果您尝试将键与范围进行比较，它总是会说它是一个哈希数组。

* * *

## 回答 #45

> 赞同：-1
> 
> 时间：2012-06-27T23:17:52.737

实际上，我发现自己处于类似的情况，试图获取一个数组并将其解析为 XML。XML 元素名称不能以数字开头——而且我发现的代码片段不能正确处理具有数字索引的数组。

> **关于我的特殊情况的详细信息如下**

@null（http://stackoverflow.com/a/173589/293332）上面提供的答案实际上非常接近。我对它被否决感到沮丧：那些不了解正则表达式的人过着非常令人沮丧的生活。

无论如何，根据他的回答，这就是我的结论：

```
/** 
 * Checks if an array is associative by utilizing REGEX against the keys
 * @param   $arr    <array> Reference to the array to be checked
 * @return  boolean
 */     
private function    isAssociativeArray( &$arr ) {
    return  (bool)( preg_match( '/\D/', implode( array_keys( $arr ) ) ) );
} 
```

有关详细信息，请参阅[PCRE 转义序列](http://www.php.net/manual/en/regexp.reference.escape.php "是的_真的_：PerlRegularExpression_match 只需要一些练习")和[PCRE 语法](http://www.php.net/manual/en/reference.pcre.pattern.syntax.php)页面。

## 我的特殊情况

这是我正在处理的示例数组：

案例A

```
return  array(
    "GetInventorySummary"  => array(
        "Filters"  => array( 
            "Filter"  => array(
                array(
                    "FilterType"  => "Shape",
                    "FilterValue"  => "W",
                ),
                array(
                    "FilterType"  => "Dimensions",
                    "FilterValue"  => "8 x 10",
                ),
                array(
                    "FilterType"  => "Grade",
                    "FilterValue"  => "A992",
                ),
            ),
        ),
        "SummaryField"  => "Length",
    ),
); 
```

问题是`filter`密钥是可变的。例如：

案例B

```
return  array(
    "GetInventorySummary"  => array(
        "Filters"  => array( 
            "Filter"  => array(
                "foo"   =>  "bar",
                "bar"   =>  "foo",
            ),
        ),
        "SummaryField"  => "Length",
    ),
); 
```

### 为什么我需要 Assoc。数组检查器

如果我正在转换的数组类似于**Case A**，我想要返回的是：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<GetInventorySummary>
    <Filters>
        <Filter>
            <FilterType>Shape</FilterType>
            <FilterValue>W</FilterValue>
        </Filter>
        <Filter>
            <FilterType>Dimensions</FilterType>
            <FilterValue>8 x 10</FilterValue>
        </Filter>
        <Filter>
            <FilterType>Grade</FilterType>
             <FilterValue>A992</FilterValue>
        </Filter>
    </Filters>
    <SummaryField>Length</SummaryField>
</GetInventorySummary> 
```

...但是，如果我正在转换的数组类似于**Case B**，我想要返回的是：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<GetInventorySummary>
    <Filters>
        <Filter>
            <foo>bar</foo>
            <bar>foo</bar>
        </Filter>
    </Filters>
    <SummaryField>Length</SummaryField>
</GetInventorySummary> 
```

* * *

## 回答 #46

> 赞同：-1
> 
> 时间：2014-03-14T04:17:33.940

```
function is_array_assoc($foo) {
    if (is_array($foo)) {
        return (count(array_filter(array_keys($foo), 'is_string')) > 0);
    }
    return false;
} 
```

* * *

## 回答 #47

> 赞同：-1
> 
> 时间：2016-07-20T01:59:01.880

Mark Amery 的改进

```
function isAssoc($arr)
{
    // Is it set, is an array, not empty and keys are not sequentialy numeric from 0
    return isset($arr) && is_array($arr) && count($arr)!=0 && array_keys($arr) !== range(0, count($arr) - 1);
} 
```

这将测试变量是否存在、是否为数组、是否不是空数组以及键是否从 0 开始不连续。

查看数组是否关联

```
if (isAssoc($array)) ... 
```

看它是否为数字

```
if (!isAssoc($array)) ... 
```

* * *

## 回答 #48

> 赞同：-1
> 
> 时间：2017-06-28T03:46:25.850

检查数组是否具有所有关联键。使用`stdClass`& [get_object_vars](http://php.net/manual/en/function.get-object-vars.php) ^):

```
$assocArray = array('fruit1' => 'apple', 
                    'fruit2' => 'orange', 
                    'veg1' => 'tomato', 
                    'veg2' => 'carrot');

$assoc_object = (object) $assocArray;
$isAssoc = (count($assocArray) === count (get_object_vars($assoc_object)));  
var_dump($isAssoc); // true 
```

为什么？函数`get_object_vars`仅返回**可访问**的属性（请参阅有关转换`array`到`object` [此处](http://php.net/manual/en/function.get-object-vars.php)的更多信息）。然后，从逻辑上讲：如果**基本数组元素的**数量等于**对象可访问属性的数量**- 所有键都是关联的。

*几个测试*：

```
$assocArray = array('apple', 'orange', 'tomato', 'carrot');
$assoc_object = (object) $assocArray; 
$isAssoc = (count($assocArray) === count (get_object_vars($assoc_object)));
var_dump($isAssoc); // false 
//...

$assocArray = array( 0 => 'apple', 'orange', 'tomato', '4' => 'carrot');
$assoc_object = (object) $assocArray; 
$isAssoc = (count($assocArray) === count (get_object_vars($assoc_object)));
var_dump($isAssoc); // false 

//... 
$assocArray = array('fruit1' => 'apple', 
                    NULL => 'orange', 
                    'veg1' => 'tomato', 
                    'veg2' => 'carrot');

$assoc_object = (object) $assocArray;
$isAssoc = (count($assocArray) === count (get_object_vars($assoc_object)));  
var_dump($isAssoc); //false 
```

*等等。*

* * *

## 回答 #49

> 赞同：-1
> 
> 时间：2018-05-04T05:22:58.700

这是我的功能 -

```
public function is_assoc_array($array){

    if(is_array($array) !== true){
        return false;
    }else{

        $check = json_decode(json_encode($array));

        if(is_object($check) === true){
            return true;
        }else{
            return false;
        }

    }

} 
```

一些例子

```
 print_r((is_assoc_array(['one','two','three']))===true?'Yes':'No'); \\No
    print_r(is_assoc_array(['one'=>'one','two'=>'two','three'=>'three'])?'Yes':'No'); \\Yes
    print_r(is_assoc_array(['1'=>'one','2'=>'two','3'=>'three'])?'Yes':'No'); \\Yes
    print_r(is_assoc_array(['0'=>'one','1'=>'two','2'=>'three'])?'Yes':'No'); \\No 
```

@devios1 在其中一个答案中有一个类似的解决方案，但这只是使用 PHP 的内置 json 相关函数的另一种方式。与此处发布的其他解决方案相比，我尚未检查此解决方案在性能方面的表现。但它确实帮助我解决了这个问题。希望这可以帮助。

* * *

## 回答 #50

> 赞同：-1
> 
> 时间：2018-10-03T13:54:58.570

```
/*
iszba - Is Zero Based Array

Detects if an array is zero based or not.

PARAMS:
    $chkvfnc
        Callback in the loop allows to check the values of each element.
        Signature:
            bool function chkvfnc($v);
            return:
                true    continue looping
                false   stop looping; iszba returns false too.

NOTES:
○ assert: $array is an array.
○ May be memory efficient;
  it doesn't get extra arrays via array_keys() or ranges() into the function.
○ Is pretty fast without a callback.
○ With callback it's ~2.4 times slower.
*/
function iszba($array, $chkvfnc=null){

    $ncb = !$chkvfnc;
    $i = 0;

    foreach($array as $k => $v){
        if($k === $i++)
            if($ncb || $chkvfnc($v))
                continue;

        return false;
    }

    return true;
} 
```

• 没有回调，它比当前领先答案快约 30%，并且可能更节省内存。

• 只需否定答案即可知道数组是否应被视为关联。

* * *

## 回答 #51

> 赞同：-1
> 
> 时间：2020-09-04T15:20:43.410

我很惊讶没有人提到`array_key_first()`

对于您的测试用例：

```
$sequentialArray = array('apple', 'orange', 'tomato', 'carrot');
$isIndexedArray = is_int( array_key_first($sequentialArray) ); // true 
```

然而

```
$assocArray = array('fruit1' => 'apple', 
                'fruit2' => 'orange', 
                'veg1' => 'tomato', 
                'veg2' => 'carrot');

$isIndexedArray = is_int( array_key_first($assocArray) ); // false 
```

[在此处](https://www.php.net/manual/en/function.array-key-first.php)阅读有关此功能的更多信息。

* * *

## 回答 #52

> 赞同：-2
> 
> 时间：2008-11-05T13:53:34.597

```
function isAssoc($arr)
{
    $a = array_keys($arr);
    for($i = 0, $t = count($a); $i < $t; $i++)
    {
        if($a[$i] != $i)
        {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #53

> 赞同：-2
> 
> 时间：2011-06-24T01:51:56.233

另一个尚未显示的变体，因为它根本不接受数字键，但我非常喜欢 Greg 的变体：

```
 /* Returns true if $var associative array */  
  function is_associative_array( $array ) {  
    return is_array($array) && !is_numeric(implode('', array_keys($array)));  
  } 
```

* * *

## 回答 #54

> 赞同：-2
> 
> 时间：2011-08-01T03:43:28.613

检测关联数组（哈希数组）的最佳函数

```
<?php
function is_assoc($arr) { return (array_values($arr) !== $arr); }
?> 
```

* * *

## 回答 #55

> 赞同：-2
> 
> 时间：2011-08-13T10:43:47.300

简单且性能友好的解决方案，仅检查第一个键。

```
function isAssoc($arr = NULL)
{
    if ($arr && is_array($arr))
    {
        foreach ($arr as $key => $val)
        {
            if (is_numeric($key)) { return true; }

            break;
        }
    }

    return false;
} 
```

* * *

## 回答 #56

> 赞同：-2
> 
> 时间：2016-10-10T11:06:58.823

以简单的方式，您可以通过以下步骤检查数组是否关联

1.  通过使用将数组的所有键转换为一个数组`array_keys()`
2.  `array_filter()`使用and 从数组中过滤掉非数字键`is_numeric()`
3.  比较过滤数组和实际数组中的元素数，如果两个数组中的元素数不相等，则它是关联数组。

上述步骤的功能如下。

```
 function isAssociative(array $array)
    {
        return count(array_filter(array_keys($array), function($v){return is_numeric($v);})) !== count($array));
    } 
```

* * *

## 回答 #57

> 赞同：-3
> 
> 时间：2009-02-08T01:53:02.907

我只是使用 key() 函数。观察：

```
<?php
var_dump(key(array('hello'=>'world', 'hello'=>'world'))); //string(5) "hello"
var_dump(key(array('world', 'world')));                  //int(0)
var_dump(key(array("0" => 'a', "1" => 'b', "2" => 'c'))); //int(0) who makes string sequetial keys anyway????
?> 
```

因此，只需检查是否为假，您就可以确定数组是否是关联的。

* * *

## 回答 #58

> 赞同：-3
> 
> 时间：2021-07-26T13:58:42.060

```
 function is_assoc(array $array): bool
{
    foreach ($array as $iValue) {
        if (is_array($iValue)) {
            return  true;
        }
    }
    return false;

}

$d= is_assoc(["id",2,3]);

var_dump($d); 
```

* * *

## 回答 #59

> 赞同：-5
> 
> 时间：2008-10-06T08:39:15.347

如果您只寻找非数字键（无论顺序如何），那么您可能想尝试

```
function IsAssociative($array)
{
    return preg_match('/[a-z]/i', implode(array_keys($array)));
} 
```

# c - 如何在 C 中找到我的程序部分的执行时间？

> ID：173409
> 
> 赞同：16
> 
> 时间：2008-10-06T07:04:44.677
> 
> 标签：c, timing

我正在尝试找到一种方法来获取 C 中一段代码的执行时间。我已经从 time.h 尝试了 time() 和 clock()，但似乎 time() 返回秒和时钟() 似乎给了我毫秒（或厘秒？）不过我想要更精确的东西。有没有办法以至少微秒的精度抓住时间？

这只需要能够在 Linux 上编译。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-06T07:15:12.643

你提到`clock()`和`time()`- 你在找`gettimeofday()`吗？这将填充 a `struct timeval`，其中包含秒和微秒。

当然，实际分辨率取决于硬件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-06T16:33:35.480

对于它的价值，这里只是几个宏：

```
#include <time.h>
clock_t startm, stopm;
#define START if ( (startm = clock()) == -1) {printf("Error calling clock");exit(1);}
#define STOP if ( (stopm = clock()) == -1) {printf("Error calling clock");exit(1);}
#define PRINTTIME printf( "%6.3f seconds used by the processor.", ((double)stopm-startm)/CLOCKS_PER_SEC); 
```

然后只需使用它：

```
main() {
  START;
  // Do stuff you want to time
  STOP;
  PRINTTIME;
} 
```

来自[http://ctips.pbwiki.com/Timer](http://ctips.pbwiki.com/Timer)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-06T07:08:24.843

您需要一个[分析器](http://en.wikipedia.org/wiki/Profiler_(computer_science))应用程序。

在 SO 和搜索引擎上搜索关键字：linux profiling

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T07:14:26.327

查看[gettimeofday](http://www.opengroup.org/onlinepubs/009695399/functions/gettimeofday.html)、 [clock_*](http://www.opengroup.org/onlinepubs/009695399/functions/clock_getres.html)或[get/setitimer](http://www.opengroup.org/onlinepubs/009695399/functions/getitimer.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T07:08:46.790

试试[“bench.h”](http://pastebin.com/f38ba0fa9)；它可以让你放一个 START_TIMER；和 STOP_TIMER("name"); 进入您的代码，允许您任意对代码的任何部分进行基准测试（注意：仅推荐用于较短的部分，而不是花费数十毫秒或更长时间的事情）。它精确到时钟周期，尽管在极少数情况下它可以改变中间代码的编译方式，在这种情况下，最好使用分析器（尽管分析器通常更努力地用于特定的代码部分）。

它仅适用于 x86。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T07:07:22.003

您可能想在谷歌上搜索*仪器*工具。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T07:41:09.597

您不会找到可以让您超越平台时钟分辨率的库调用。要么按照另一张海报的建议使用分析器（man gprof），要么 - 快速而肮脏 - 在有问题的代码部分周围放置一个循环以多次执行它，并使用时钟（）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-10-22T06:39:40.913

`gettimeofday()`为您提供微秒的分辨率，而[`clock_gettime()`](http://linux.die.net/man/3/clock_gettime)为您提供纳秒的分辨率。

```
int clock_gettime(clockid_t clk_id, struct timespec *tp); 
```

`clk_id`标识要使用的时钟。`CLOCK_REALTIME`如果您希望所有进程都可以看到系统范围的时钟，请使用此选项。用于`CLOCK_PROCESS_CPUTIME_ID`每个进程的计时器和`CLOCK_THREAD_CPUTIME_ID`特定于线程的计时器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T09:49:49.010

如果您在 x86 或 x64 上进行开发，为什么不使用时间戳计数器：[RDTSC](http://en.wikipedia.org/wiki/RDTSC)。

它将比诸如 time() 或 clock() 之类的 Ansi C 函数更可靠，因为 RDTSC 是一个原子函数。为此目的使用 C 函数可能会带来问题，因为您无法保证它们正在执行的线程不会被切换出去，因此它们返回的值将不是您尝试测量的实际执行时间的准确描述.

使用 RDTSC，您可以更好地衡量这一点。您需要将滴答计数转换回人类可读的时间 H:M:S 格式，这将取决于处理器时钟频率，但谷歌搜索，我相信您会找到示例。

但是，即使使用 RDTSC，您也将包括代码停止执行的时间，而如果您需要精确测量，则比使用 time()/clock() 更好的解决方案，您将不得不求助于分析器来检测您的代码并考虑到您的代码由于上下文切换或其他原因而没有实际执行的情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-06T03:43:32.333

这取决于条件。分析器非常适合一般的全局视图，但是如果您真的需要准确的视图，我的建议是 KISS。只需在循环中运行代码，这样就需要一分钟左右才能完成。然后根据总运行时间和执行的迭代计算一个简单的平均值。

这种方法允许您：

1.  使用低分辨率计时器获得准确的结果。

2.  不会遇到仪器干扰靠近处理器的高速缓存（l2​​、l1、分支..等）的问题。然而，在紧密循环中运行相同的代码也可以提供可能无法反映现实世界条件的乐观结果。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-10-19T20:16:27.590

不知道您正在使用哪个环境/操作系统，但如果另一个线程、任务或进程在中间抢占了您的定时代码，您的时间可能不准确。我建议探索诸如互斥锁或信号量之类的机制，以防止其他线程抢占您的进程。

# .net - 为 Windows 开发计划任务

> ID：173431
> 
> 赞同：11
> 
> 时间：2008-10-06T07:14:14.003
> 
> 标签：.net, scheduled-tasks

我必须使用 C#.net 开发一个必须每天运行一次的应用程序。它最多只运行一分钟，所以开发一个 Windows 服务是大材小用，计划任务是合适的方式。

但是，我对应用程序如何传达其结果有一些疑问：

*   如何向任务调度程序指示任务已失败？这是通过程序的退出代码吗？
*   如何记录输出信息？控制台输出是自动捕获的，还是我必须明确写入事件查看器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T07:25:48.863

回答你的问题——

1.  如果任务因抛出未经检查的异常而失败，您将在计划任务查看器中看到，会有一个“最后结果”，其值类似于`0xe0434f4d`. 或者，如果您返回一个退出代码，该代码也将显示在 Scheduled Task 查看器的 Last Result 列中。

2.  例如，写入控制台`Console.WriteLine("blah");`不会出现在任何地方。您需要写入事件日志或日志文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T08:00:52.693

如果您采用*日志文件*方式，您仍然可以使用`Console.WriteLine("blah");`. 诀窍是重定向标准的*Out*和*Error*流：

```
 StreamWriter mylog = new StreamWriter("mylog.log");
        Console.SetOut(mylog);
        Console.SetError(mylog); 
```

您还需要经常刷新缓冲区，以确保日志文件包含当前信息。

```
 Console.Out.Flush(); 
```

这又快又脏，你真的应该使用*Windows 事件日志*或 [log4net](http://logging.apache.org/log4net/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T07:23:47.743

AFAIK 调度程序只是启动了一个进程。您可以使用事件日志或其他日志记录系统来记录您以后需要参考的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T08:25:32.940

[Log4net](http://logging.apache.org/log4net/)是一个非常好的、完整的日志框架。我可以强烈推荐它。

# dll - WinXP下如何修复DWMAPI.DLL延迟加载依赖？

> ID：173433
> 
> 赞同：27
> 
> 时间：2008-10-06T07:14:14.893
> 
> 标签：dll, windows-xp, dwm

我在 WinXP 下构建了一个 .dll，声称它在加载时找不到 DWMAPI.DLL。问题是这个 DLL 是一个 Vista DLL，对于安装了 IE7 的 XP 用户来说，这是一个已知问题。建议卸载 IE7 或通过添加/删除程序修复 .NET Framework。我做了修复，没有任何改变。我不打算卸载 IE7，因为必须有一个更好的解决方案，它不等同于“重新安装 Windows”。

我读过关于试图卸载 IE7 的人的坏消息，所以我不愿意走那条路。

我在 Visual Studio 2003 (7.1) 下使用 C++。我没有看到可能在应用程序启动时强制延迟加载的选项。我只是在创建 DLL 项目时使用了默认设置。我刚才确实找到了一个有趣的选项，Linker->Input->Delay Loaded DLLs，所以我把 DWMAPI.DLL 放在那里强制它被延迟加载。但是，我在链接时得到了这个：

```
LINK : warning LNK4199: /DELAYLOAD:dwmapi.dll ignored; no imports found from dwmapi.dll 
```

.. 尝试加载我的 DLL 时，它当然没有改变任何事情。为了它，我添加了导致 DWMAPI.DLL 的整个 DLL 树，我得到了相同的消息。（为了记录，它是foundation.dll->shell32.dll->shdocvw.dll->mshtml.dll->ieframe.dll->dwmapi.dll。）

为了更具体地了解我在做什么，我正在编写一个 Maya 插件并在脚本编辑器中获取总是有用的文本：

```
// Error: Unable to dynamically load : D:/blahblahblah/mydll.mll
The specified module could not be found.
 //
// Error: The operation completed successfully.
 //
// Error: The operation completed successfully.
 (mydll) // 
```

我最初使用 Dependency Walker 来追踪问题，这就是我找到 DWMAPI.DLL 的原因。这些是取决于给我的消息，而 DWMAPI.DLL 是唯一旁边有一个黄色问号的东西：

```
Warning: At least one delay-load dependency module was not found.
Warning: At least one module has an unresolved import due to a missing export function in a delay-load dependent module. 
```

杰拉德是对的。事实上，Maya 使用的 PATH 与 Dependency Walker 不同。我的插件加载了另一个 DLL（用于图像处理），它位于 Maya 插件目录中，并且依赖于没有问题地找到它，但 Maya 没有。我必须在 Maya.env 的 PATH 中添加“;plug-ins”。

鉴于这个问题毕竟与 DWMAPI.DLL 无关，但 DWMAPI 是一个常见问题，我将在 Novell 的网站上发布我找到的关于 DWMAPI 问题的最佳[链接](http://www.novell.com/communities/node/4372/handling-dwmapidll-dependency)。基本上大多数程序在depends.exe中都会有这个警告，但是如果旁边有延迟加载图标，并且你确定程序不会直接或间接调用DWMAPI，那就没问题了。问题在别处。如果延迟加载图标不存在，那么您必须查看 Visual Studio 中的 /DELAY 和 /DELAYLOAD 选项。依赖的事实给了我一个“警告”而不是“错误”，这是 DWMAPI 没有被自动加载这一事实的线索。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T21:40:39.417

根据您更新的问题，DWMAPI.dll 可能不是您的问题。每当您链接到 mshtml 时，Dependency walker 总是会给您该错误，因为它总是检查延迟加载的 DLL。

在这一点上，我最好的猜测是您的项目设置为动态加载运行时库，并且 Maya 正在更改 DLL 的搜索路径。因此它可能无法找到 MSVC 运行时 DLL。我已经很长时间没有开发 Maya 插件了，但是我最近在使用其他具有插件 DLL 的应用程序时遇到了这个问题。

尝试将 C/C++->代码生成->运行时库中的设置更改为多线程而不是多线程 DLL。

除此之外，您可以尝试摆弄 Dependency Walker 以使其使用与 Maya 相同的搜索路径，看看您是否可以提出另一个依赖问题。

作为最后的手段，您可以在调试器中启动 Maya 并在 LoadLibrary 上设置断点，然后找出没有以这种方式加载的库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T07:50:53.070

这是一个棘手的问题。确实有两种主要方式会导致此错误。

1）您将项目设置为强制延迟加载的 DLL 在应用程序启动时加载。DWMAPI.dll 是延迟加载的 DLL，因此通常不会加载，除非调用其中一个函数。除非您尝试在 DLL 中执行此操作，否则这不会在 XP 上发生。但是可以设置一个编译器选项来强制您的应用程序加载延迟加载的 DLL。如果您正在这样做，请不要这样做。

2) 当出现其他问题时，从depends.exe 得到的通常是错误的错误。通过dependency walker 运行你的DLL，看看是否有任何其他的依赖问题。如果一切都失败了，请尝试卸载 IE7 并查看问题是否仍然存在。如果是假错误，安装 IE7 后你会看到真正的错误。之后您可以再次安装 IE7。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-25T12:10:38.290

我正是这个问题。

需要数小时才能解决的鬼鬼祟祟的问题。

反正。我在发布机器上编译了我的托管 C++ 应用程序。收到无法运行它的客户的投诉，它在我们所有的机器上都像魅力一样工作。

事实证明，发布机器是在一个月前的一个晚上自动修补了 ATL 漏洞修复程序，所有其他机器也是如此，除了一台 XP 机器。

那台特定的 XP 机器也无法运行该应用程序。安装了 ATL 修复程序（见下面的链接），瞧，一切都像以前一样工作。

[http://www.microsoft.com/downloads/details.aspx?familyid=766A6AF7-EC73-40FF-B072-9112BAB119C2&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=766A6AF7-EC73-40FF-B072-9112BAB119C2&displaylang=en)

因此，吸取教训，始终检查您的中间清单（在调试或发布目录中找到），这将告诉您程序链接到的 DLL 版本。

希望它可以帮助任何人。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-17T05:41:08.047

尝试将 C/C++->代码生成->运行时库中的设置更改为多线程而不是多线程 DLL。

# visual-c++ - 转换为 Windows 库的 MinGW 库在 VC++6 中给出了奇怪的链接

> ID：173460
> 
> 赞同：2
> 
> 时间：2008-10-06T07:24:17.523
> 
> 标签：visual-c++, dll, mingw, gmp

我使用了 MinGW`.a`到 Windows的`.lib`转换过程，详见 gmp-discuss 列表中的一个线程，如下所示（针对使用 --disable-shared --enable-static 创建的库。）

```
cp libgmp.a gmp.a
ranlib gmp.a
mv gmp.a gmp.lib 
```

我现在有一个`.lib`文件，VC++6 似乎可以毫无困难地链接它。我现在担心的是我从链接阶段收到的警告消息：

```
LINK : warning LNK4049: locally defined symbol "___mb_cur_max" imported
LINK : warning LNK4049: locally defined symbol "__pctype" imported
LINK : warning LNK4049: locally defined symbol "__iob" imported 
```

在程序的这一点上，这些对我的 DLL（包装了某些 GMP 功能）的运行没有任何影响。但这足够好吗？将这三个符号从`libgmp.a`链接到我的 Windows DLL 最终会咬我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-21T02:17:02.777

其他人也有类似的问题，[修复](http://opensees.berkeley.edu/community/viewtopic.php?t=2267)相对简单。

# servlets - 从 glassfish 跟踪已完成的下载

> ID：173464
> 
> 赞同：4
> 
> 时间：2008-10-06T07:27:02.293
> 
> 标签：servlets, glassfish, download

我希望能够跟踪我的 glassfish 服务器提供的已完成下载。我找不到使用 servlet 生命周期侦听器的 100% 正确解决方案。有没有人有更好的主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T18:55:59.283

`try-catch`在`IOException`提供文件下载时戴上。如果它被抛出，则提供文件下载失败。

例如在自定义文件 servlet 中：

```
try {
    response.getOutputStream().write(...);

    // Success!
} catch (IOException e) {
    // Fail!

    throw e;
} 
```

或者在映射到相应 URL 模式匹配文件下载的 servlet 过滤器中：

```
try {
    chain.doFilter(request, response);

    // Success!
} catch (IOException e) {
    // Fail!

    throw e;
} 
```

# .net - 使用 Microsoft.Sdc.Tasks.ServiceProcess.ControlService 如何检查远程计算机上是否存在服务？

> ID：173466
> 
> 赞同：1
> 
> 时间：2008-10-06T07:27:19.657
> 
> 标签：.net, msbuild

`Microsoft.Sdc.Tasks.ServiceProcess.ControlService`我正在尝试使用该任务检查远程计算机上是否存在服务。

```
<ControlService  MachineName="$(TargetMachineName)" Action="Exists" ServiceName="w3svc">
    <Output PropertyName="W3ServiceExists" TaskParameter="ServiceExists" />
</ControlService> 
```

当我使用上述任务声明时，我会从 MSBUILD 获得此输出。

> `(42,54): error MSB4065: The "ServiceExists" parameter is not marked for output by the "ControlService" task.`

有没有办法使用 ControlService 类来获取远程机器上是否存在服务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T01:21:51.937

答案是提取代码并使用`ServiceExists`正确标记属性的`[Output]`属性重新编译。

建议找到此答案的任何人改为查看[MS Build Extension Pack](http://www.codeplex.com/MSBuildExtensionPack)，因为该问题在该组 MS Build 任务中不存在，并且开发得更加积极。

# c# - 学习 Windows 窗体与 Windows Presentation Foundation

> ID：173471
> 
> 赞同：11
> 
> 时间：2008-10-06T07:33:37.817
> 
> 标签：c#, .net, wpf, winforms

所以我一直在考虑去微软认证，我必须（现在）在 Windows 窗体和 WPF 之间做出选择来开发 Windows 应用程序。我对 Windows 窗体有很好的了解，但以前从未尝试过 WPF。此外，我居住的大多数职位发布似乎都是面向 WinForms 的。在接下来的几年里，这种情况可能会发生变化，所以我想知道我是应该开始学习 WPF 还是坚持使用久经考验的真正 Forms。

有什么见解吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T09:08:43.820

*   尽管当前大多数 dev.positions 将专注于 WinForms（或就此而言的 ASP.NET），但 WPF 开始被接受为一个“严肃”的平台。严肃地说，我的意思是人们开始考虑将它用于 LOB 应用程序。随着 Prism 的发布，很明显，微软开始以其他方式推广 WPF，而不仅仅是“吸引眼球”的功能。这意味着 WPF 很快就会作为 WinForms 的替代品出现。
*   学习 WPF 意味着您还将同时学习 Silverlight。因此，您可以使用两种现代技术。[已添加] -WPF 提供的不仅仅是视觉效果，您可以从中受益匪浅，而无需成为创意天才。API 很直观（而且很有趣），可以大大提高生产力。

简而言之，我想说如果你想“面向未来”学习 WPF。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T07:53:38.917

在“企业”编程中，我认为 WPF 开发没有迫切需要。原因如下：

1.  公司不是在最新的硬件上运行，而是倾向于迁移到远程桌面 (RDP/Citrix)。
2.  开发人员可以使用 Windows.Forms 控件设计一个体面的界面。在 WPF 中，您需要一个设计器。在大公司里有设计师，在我认识的大多数公司里，IT 部门都是程序员和系统工程师，没有设计师。

面向“本土市场”的软件是另一回事。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T08:46:03.133

If you want to go the certification route to learn then WPF is a good choice. It will take a few years before it will really take over from winforms but It's a safe bet it will so it's a good investment to learn.

If you're more of a self learner and just want to get certified to improve your chances on the job market then I'd go with winforms for the certification. You can pick up WPF when you need it. By the time you really need to have a WPF certification it will probably be easier for you because you've already used it.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T07:37:49.057

WPF 利用 XAML 来提供设计/视觉体验，这与 Silverlight 使用的技术相同，并且在未来将被 .NET 4.0 的其他方面大量利用，特别是 WCF（Web 服务）和 WF（工作流）。

如果您有周期，我强烈建议您学习它，但是出于认证目的，继续进行 WinForms 考试可能会更容易，因为 WPF 完全不同，并且根据我的经验，有一些学习曲线（因为不同它来自 WinForms）。

# html - 使用 CSS 定位 Flash 内容

> ID：173473
> 
> 赞同：1
> 
> 时间：2008-10-06T07:34:09.423
> 
> 标签：html, css, flash, actionscript, cs3

我有一个生成的 HTML 页面，其中包含 Flash 内容。我正在尝试重新定位 Flash 内容并使其“绝对”。我试图用 div 标签包装对象标签，但无济于事。谁能告诉我该怎么做？删除生成的定位属性不起作用。

请参阅下面的相关代码（它不是很整洁，但这就是它的生成方式。我已经删除了大多数不相关的代码）：

```
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>* welcome *</title>
<script language="javascript">AC_FL_RunContent = 0;</script>
<script src="AC_RunActiveContent.js" language="javascript"></script>
</head>
<body bgcolor="#000000">
<script language="javascript">
if (AC_FL_RunContent == 0) {
    alert("This page requires AC_RunActiveContent.js.");
} else {
    AC_FL_RunContent(
        'codebase', 'http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0',
        'width', '430',
        'height', '200',
        'src', 'bar',
        'quality', 'high',
        'pluginspage', 'http://www.macromedia.com/go/getflashplayer',
        'align', 'right',
        'play', 'true',
        'loop', 'true',
        'scale', 'showall',
        'wmode', 'transparent',
        'devicefont', 'false',
        'id', 'bar',
        'bgcolor', '#000000',
        'name', 'bar',
        'menu', 'true',
        'allowFullScreen', 'false',
        'allowScriptAccess','sameDomain',
        'movie', 'bar',
        'salign', ''
        ); //end AC code
}
</script>
<noscript>
<div style = "position: absolute">
    <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"          codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="430" height="200" id="bar" align="right">
    <param name="allowScriptAccess" value="sameDomain" />
    <param name="allowFullScreen" value="false" />
    <param name="movie" value="bar.swf" /><param name="quality" value="high" /><param name="wmode" value="transparent" /><param name="bgcolor" value="#000000" />
    </object>
</div>
</noscript> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T07:52:43.987

由于您的 div 包含在 noscript 中，因此仅在关闭 javascript 时才会显示，您确定这是您想要的行为吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T07:55:42.343

您应该将实际创建对象的 JS 脚本放在您的 div 中，而不是在它之前。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T08:00:49.167

@Fuzzy76 & @epeleg.blogspot.com 是对的

@pypmanetjies -> 你的代码必须是这样的（缩短）：

```
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>* welcome *</title>
    <script language="javascript">AC_FL_RunContent = 0;</script>
    <script src="AC_RunActiveContent.js" language="javascript"></script>
    </head>
    <body bgcolor="#000000">
<div style = "position: absolute">
    <script language="javascript">
    if (AC_FL_RunContent == 0) {
            alert("This page requires AC_RunActiveContent.js.");
    } else {
            AC_FL_RunContent(
...
); //end AC code
    }
    </script>
    <noscript>
          <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"          codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="430" height="200" id="bar" align="right">
        <param name="allowScriptAccess" value="sameDomain" />
        <param name="allowFullScreen" value="false" />
        <param name="movie" value="bar.swf" /><param name="quality" value="high" /><param name="wmode" value="transparent" /><param name="bgcolor" value="#000000" />
        </object>

    </noscript> 
</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T10:17:55.223

您可能还需要设置宽度和高度。

# python - 有没有人有 PyS60 移动开发经验

> ID：173484
> 
> 赞同：10
> 
> 时间：2008-10-06T07:37:30.493
> 
> 标签：python, mobile, pys60

在一个针对手机的项目中，我不得不在早期做出技术选择。我看到 S60 有一个 python 衍生产品，想知道是否有人可以分享经验，好的和坏的，并建议合适的 IDE 和模拟器。

请不要告诉我我应该在 Windows Mobile 上进行开发，我已经决定不这样做了，所以会记下这些答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-01T08:50:45.787

## PyS60——很酷:)

我在 PyS60 1.3 FP2 上做了很多工作。它是一种很好的语言，可以将您的应用程序移植到 Symbian Mobiles 和 Powerful 上。我在 PyS60 中完成了我的主要项目，这是一个用于 Symbian 手机的[GSM 定位器（它不是最新版本）应用程序。](http://sourceforge.net/projects/gsmlocator)

还有一个非常简洁的 py2sis 实用程序，可将您的 py 应用程序转换为可安装在任何 Sumbian 手机上的便携式 sis 应用程序。Python 脚本语言的易用性和一组适用于移动功能的经过变形的 API 让您能够非常整洁、快速地完成任何事情。

最新的视频和摄像头 API 让您可以做几乎所有可以用手机完成的事情。我建议您从一些非常好的资源开始

1.  [诺基亚论坛](http://www.forum.nokia.com/Resources_and_Information/Tools/Runtimes/Python_for_S60/)
2.  [诺基亚开源资源中心](http://opensource.nokia.com/projects/pythonfors60/)
3.  [一个很好的教程（适合初学者）](http://www.mobilenin.com/pys60/menu.htm)

只需访问这些，下载模拟器，然后开始使用 PyS60。我相信你会喜欢的。

PS：由于帖子太旧了，我相信你一定已经爱上了它或完成了它。但我就是忍不住回答。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T10:06:13.470

你查看过[移动 Python 书籍](http://www.mobilepythonbook.com/)吗？

> 这本实用的动手书有效地教授了如何在基于 Symbian OS 和 S60 平台的诺基亚智能手机上轻松编写自己强大而有趣的应用程序。

[![移动 Python 书籍封面](https://i.stack.imgur.com/zTC1X.png)](https://i.stack.imgur.com/zTC1X.png)
[（来源：[mobilenin.com](http://www.mobilenin.com/mobilepythonbook/book-cover.png)）]

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T13:49:52.690

我自己刚刚开始研究这个。我已经购买了上面的 Mobile Python 书。到目前为止看起来不错。

该站点也有一些教程： [http ://croozeus.com/tutorials.htm](http://croozeus.com/tutorials.htm)

我正在使用 putools 通过来自 linux 的蓝牙进行编码/同步：http: [//people.csail.mit.edu/kapu/symbian/python.html](http://people.csail.mit.edu/kapu/symbian/python.html)

S60 上的 python 开发有优点/缺点。显然，使用 Python 是一大优势。为了将您的应用程序构建成分布式形式，您需要一些额外的技巧，您不需要要求最终用户首先为他们的手机下载 python 运行时。

另一个缺点只是在 UI 中。您可以通过 appuifw API 获得三种形式的 ui。假设您想在屏幕上绘制图像并且在 ui 中有一个文本输入字段，您真的做不到。您必须将 ui 拆分为适合 python api 为您提供的部分。

至于 IDE/Emulator，我只是在 Ubuntu 上使用 VIM 和 putools 中的蓝牙同步工具。我已经看到您可以获得 C++ 或 Java 环境，然后在其中使用模拟器，但没有看到它是如何工作的，因为此时它似乎是一个仅限 Windows 的选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-29T10:25:53.913

我在这里看到了 pyS60 的移动 IDE ..

[http://circuitdesolator.blogspot.com/2010/12/ped-mobile-phyton-ide-for-pys60.html](http://circuitdesolator.blogspot.com/2010/12/ped-mobile-phyton-ide-for-pys60.html)

它被称为 PED，我在过去几个月里一直在使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T21:06:11.640

我写了一个我想拥有的计算器，并制作了一个简单的游戏。我直接在手机上写的。我在文本编辑器中写作，然后切换到 Python 并运行了一个脚本。这不是很舒服，但没关系。而且，我是在附近没有 PC 的时候写这些的。

这是一个很好的经验！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-28T18:22:38.017

我有一些 J2ME 经验，现在我决定为我的手机编写几个有用的应用程序，所以我决定顺便使用 PyS60 学习 Python :)

我不喜欢这个平台的一些事情是：

1.  您不能从非主线程调用任何图形函数（模块 appuifw）。
2.  Python 脚本模型不太适合 ui 应用程序，因为脚本必须包含显式的 while 循环或信号量以防止主线程退出
3.  sys.exit() 函数不可用。

同样，我是 PyS60 的新手，所以如果上面给出的问题确实有很好的解决方法，请不要犹豫将它们写为评论。我会很感激。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-29T17:49:54.703

有一个用于 S60 手机的名为[PED](http://code.google.com/p/ped-s60/)的不错的小 IDE ，它为您提供了一些额外的功能并使其更易于编码。它还不是很高级，但总比手动在文本编辑器和 python 之间切换要好。

高温高压

影

# java - 如果我更改 JNDI 端口，在 Eclipse 中关闭 JBoss 的问题

> ID：173487
> 
> 赞同：8
> 
> 时间：2008-10-06T07:38:31.833
> 
> 标签：java, eclipse, jboss, jboss-tools

# 第一阶段

由于我更改了 JBoss 的 JNDI 端口，因此在 Eclipse 下关闭正在运行的 JBoss 实例时遇到问题。当然，我可以从控制台视图关闭它，但不能使用停止按钮（它仍然在默认的 1099 端口搜索 JNDI 端口）。我期待任何解决方案。谢谢！

## 使用环境：

*   JBoss 4.0.2（使用*默认*）
*   日食 3.4.0。（使用 JBoss 工具 2.1.1.GA）

默认端口：1098、1099 更改的端口：11098、11099

我在 jbosspath/server/default/conf/jboss-service.xml 中更改了以下部分：

```
 <!-- ==================================================================== -->
   <!-- JNDI                                                                 -->
   <!-- ==================================================================== -->

   <mbean code="org.jboss.naming.NamingService"
      name="jboss:service=Naming"
      xmbean-dd="resource:xmdesc/NamingService-xmbean.xml">
      <!-- The call by value mode. true if all lookups are unmarshalled using
      the caller's TCL, false if in VM lookups return the value by reference.
      -->
      <attribute name="CallByValue">false</attribute>
      <!-- The listening port for the bootstrap JNP service. Set this to -1
        to run the NamingService without the JNP invoker listening port.
      -->
      <attribute name="Port">11099</attribute>
      <!-- The bootstrap JNP server bind address. This also sets the default
      RMI service bind address. Empty == all addresses
       -->
      <attribute name="BindAddress">${jboss.bind.address}</attribute>
      <!-- The port of the RMI naming service, 0 == anonymous -->
      <attribute name="RmiPort">11098</attribute>
      <!-- The RMI service bind address. Empty == all addresses
       -->
      <attribute name="RmiBindAddress">${jboss.bind.address}</attribute>
      <!-- The thread pool service used to control the bootstrap lookups -->
      <depends optional-attribute-name="LookupPool"
         proxy-type="attribute">jboss.system:service=ThreadPool</depends>
   </mbean>

   <mbean code="org.jboss.naming.JNDIView"
        name="jboss:service=JNDIView"
        xmbean-dd="resource:xmdesc/JNDIView-xmbean.xml">
   </mbean> 
```

## 日食设置：

![](https://i.stack.imgur.com/nOlhy.png "jndi端口到11099")

*关于我的 JBoss Tools 偏好：* 我有一个以前的版本，我遇到了这个问题，我读到了 JbossTools 中的一些错误修复，所以更新到 2.1.1.GA。现在按钮改变了，我有了一个新的偏好视图，但我不能修改任何东西......似乎也很不正常：

![](https://i.stack.imgur.com/Ocfcf.png)

## 错误对话框：

![](https://i.stack.imgur.com/uPPZ7.png "无法访问服务器")

## 堆栈跟踪：

```
javax.naming.CommunicationException: Could not obtain connection to any of these urls: localhost:1099 [Root exception is javax.naming.CommunicationException: Failed to connect to server localhost:1099 [Root exception is javax.naming.ServiceUnavailableException: Failed to connect to server localhost:1099 [Root exception is java.net.ConnectException: Connection refused: connect]]]
    at org.jnp.interfaces.NamingContext.checkRef(NamingContext.java:1385)
    at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:579)
    at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:572)
    at javax.naming.InitialContext.lookup(InitialContext.java:347)
    at org.jboss.Shutdown.main(Shutdown.java:202)
Caused by: javax.naming.CommunicationException: Failed to connect to server localhost:1099 [Root exception is javax.naming.ServiceUnavailableException: Failed to connect to server localhost:1099 [Root exception is java.net.ConnectException: Connection refused: connect]]
    at org.jnp.interfaces.NamingContext.getServer(NamingContext.java:254)
    at org.jnp.interfaces.NamingContext.checkRef(NamingContext.java:1370)
    ... 4 more
Caused by: javax.naming.ServiceUnavailableException: Failed to connect to server localhost:1099 [Root exception is java.net.ConnectException: Connection refused: connect]
    at org.jnp.interfaces.NamingContext.getServer(NamingContext.java:228)
    ... 5 more
Caused by: java.net.ConnectException: Connection refused: connect
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:305)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:171)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:158)
    at java.net.Socket.connect(Socket.java:452)
    at java.net.Socket.connect(Socket.java:402)
    at java.net.Socket.<init>(Socket.java:309)
    at java.net.Socket.<init>(Socket.java:211)
    at org.jnp.interfaces.TimedSocketFactory.createSocket(TimedSocketFactory.java:69)
    at org.jnp.interfaces.TimedSocketFactory.createSocket(TimedSocketFactory.java:62)
    at org.jnp.interfaces.NamingContext.getServer(NamingContext.java:224)
    ... 5 more
Exception in thread "main" 
```

# 第二阶段：

在文件/新/其他/服务器中创建新服务器后，它确实出现在首选项选项卡中。现在停止按钮正在工作（服务器在没有对 jndi 端口进行任何额外修改的情况下接收关闭消息 - 现在没有机会）但它仍然抛出错误消息，虽然不同，但它没有异常堆栈跟踪：“服务器JBoss 4.0 服务器未能停止。”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-03T01:52:05.960

这是针对此问题的详细修复： 重新映射 jndi 端口时，Eclipse WTP 服务器连接器不会关闭 JBoss。

这是因为默认服务器连接器配置文件不使用自己的 jndiPort 别名。eclipse.org 也讨论了这个问题：http: [//www.eclipse.org/forums/index.php? t=msg&goto=489439&S=0db4920aab0a501c80a626edff84c17d#msg_489439](http://www.eclipse.org/forums/index.php?t=msg&goto=489439&S=0db4920aab0a501c80a626edff84c17d#msg_489439)

解决方案来自 eclipse 中的 .serverdef 文件：

```
 <eclipse>\plugins\org.eclipse.jst.server.generic.jboss_1.5.105.v200709061325\servers\jboss*.serverdef 
```

他们为 jndi 端口声明了一个 xml 属性：

```
 <property id="jndiPort"
 label="%jndiPort"
 type="string"
 context="server"
 default="1099" /> 
```

这只需要在 serverdef 有 STOP 命令编码的地方使用：

所以这：

```
 <stop>
  <mainClass>org.jboss.Shutdown</mainClass>
  <workingDirectory>${serverRootDirectory}/bin</workingDirectory>
  <programArguments>-S</programArguments>
  <vmParameters></vmParameters>
  <classpathReference>jboss</classpathReference>
 </stop> 
```

变成这样：

```
 <stop>
  <mainClass>org.jboss.Shutdown</mainClass>
  <workingDirectory>${serverRootDirectory}/bin</workingDirectory>
  <programArguments>-s jnp://${serverAddress}:${jndiPort}</programArguments>
  <vmParameters></vmParameters>
  <classpathReference>jboss</classpathReference>
 </stop> 
```

可以通过与 jndi 连接的定义进行比较来验证其原理：

```
 <jndiConnection>
  <providerUrl>jnp://${serverAddress}:${jndiPort}</providerUrl>
<initialContextFactory>org.jnp.interfaces.NamingContextFactory</initialContextFactory>
  <jndiProperty>
   <name></name>
   <value></value>
  </jndiProperty>
 </jndiConnection> 
```

这个通用案例修复的灵感归功于：Moisa Laurentiu Florin。正是他们的贡献让我寻找一种方法来替换 ${jndiPort} 而不是硬编码的值。

此修复更正了两个普通的 Eclipse WTP 服务器连接器。我还在研究 JBOss IDE 连接器

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-24T15:02:38.743

打开 jboss-path\bin\shutdown.jar

示例：jboss-4.2.3.GA\bin\shutdown.jar

并打开 jboss-path\bin\shutdown.jar\jndi.properties

和改变

java.naming.provider.url=jnp://localhost:1099 到 java.naming.provider.url=jnp://localhost:11099

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T11:23:59.583

OK，你要做的是File->New->Other->Server，然后在那里设置你的JBoss服务器。然后它将出现在 Preferences->JBossTools->Servers 中。

令人费解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T08:06:27.860

在 MyEclipse 服务器配置中，您可以找到“Optional Shutdown Argument”字段，该字段填充了默认值

```
--shutdown 
```

将其更改为

```
-s jnp://localhost:11099 --shutdown 
```

编辑：

抱歉，这个答案与 MyEclipse 有关。但是，必须有一些地方也可以在您的环境中指定 JBoss 关闭命令。也许您看一下“运行...”配置？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T21:11:36.783

您应该在文件“/home/fmoisa/workspace/eclipse/plugins/org.eclipse.jst.server.generic.jboss_1.5.206.v20090115/servers/jboss42.serverdef”中修改：

org.jboss.Shutdown ${serverRootDirectory}/bin -S -Djboss.boot.loader.name=shutdown.bat jboss.shutdown

对此：

org.jboss.Shutdown ${serverRootDirectory}/bin -S -sjnp://localhost:11099 -Djboss.boot.loader.name=shutdown.bat jboss.shutdown

全部;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T10:08:13.690

使用 JBoss 工具提供的服务器适配器，而不是 Eclipse WTP 提供的默认适配器。

然后你可以简单地双击服务器，你可以编辑 JNDI 端口（顺便说一句，如果你不做任何事情，它会自动从 XML 配置中获取）。您还可以通过启动配置中的命令行参数来设置 JNDI 端口，但这比仅设置端口值更麻烦。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-11T08:58:12.187

这在 JBoss 6.0.0M3 中有所改变。

停止命令现在是：

> "-s 服务:jmx:rmi:///jndi/rmi://localhost:1090/jmxrmi"

请注意，端口也发生了变化：**不再是 JNDI 端口 1099**，而是**RMI/JMX 端口 1090**。因此，您将需要服务器定义中的另一个配置参数。

我不知道 JBoss 6.0.0M3 服务器是否需要“JNDI 端口”参数。

我在[http://www.cs.hs-rm.de/~knauf/public/](http://www.cs.hs-rm.de/~knauf/public/)有一个修改过的 Eclipse 插件，其中包含 6.0.0M3 的服务器定义，包括此更改。该站点还链接到 JBoss 论坛主题，其中包含有关此更改的更多详细信息。

最好的祝福

沃尔夫冈可耐福

# pdf - 使用 iText API 为 PDF 文件中的所有书签创建目的地

> ID：173495
> 
> 赞同：7
> 
> 时间：2008-10-06T07:42:34.477
> 
> 标签：pdf, pdf-generation, itext, bookmarks, tagged-pdf

我想编写一些（java）代码来获取 PDF 文档，并从所有书签中创建命名目的地。我认为 iText API 是最简单的方法，但我以前从未使用过该 API。

您将如何使用 iText API 编写此类代码？iText 可以自己进行操作现有 PDF 所需的解析吗？我正在考虑的那种操作是：

*   打开，
*   查找书签，
*   创建目的地，
*   节省，
*   关闭。

还是有其他更好的 API？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-07T04:17:45.043

跟进：几个月前我向 iText 提交了一个补丁（它现在已被接受并且是 HEAD 的一部分），它为 iText 添加了文本解析功能。PdfBox（下面提到）在阅读使用外部参照流而不是旧的外部参照表格式的新 PDF 时存在（有？）问题。

* * *

另一个非常擅长解析现有 PDF 文件的库是*PdfBox* [，](http://www.pdfbox.org/) 它也可以用于修改现有 PDF。仅供参考 - 这是 Lucene 使用的文本解析器。

我还要提一下，iText*确实*有解析 PDF 文件的能力，只是它不擅长解析每一页上的文本内容。如果您正在考虑访问用于存储书签等的 PDF 更高级别的结构（字典等），并且您不介意在阅读 PDF 规范时弄脏您的手，您可以绝对做你所要求的（我们自己做了很多）。

[PDF 规范](http://www.adobe.com/devnet/pdf/pdf_reference.html)很大，但大部分都是可读的，如果您要做的只是提取书签，您不必担心其中的大部分内容（针对实际页面内容和渲染）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T19:28:50.103

我只是提前警告你，你可能会对此感到失望。iText 并不是真的打算用作解析器。它确实更适合创建*全新的*PDF 文档，但您可以尝试一下。

首先，使用 iText，您将无法修改现有的 PDF 文档。但是，您*可以*做的是使用您想要的附加功能制作副本。（如果其他人知道得更好，*请*告诉我，这让我发疯。）

您要做的是从源文件的输入流创建一个 PdfReader 对象。然后为您的目标创建一个 PdfCopy 对象（它只是一个扩展的 PdfWriter，可以更方便地从现有源获取数据）。

据我所知，书签根本无法从 iText 获得。可能需要另一个库。我认为[jpedal](http://www.jpedal.org/javadoc/index.html)可能具有提取它们的能力（它可以将它们作为 XML 文档获取，然后您可能必须对其进行解析以获得所需的内容。）无论您得到它们，您都可以将它们添加到 java.util.List 中，并且将该列表设置为 PDFCopy 上的大纲。书签本身只是具有一组特定键的 HashMap。我不确定所有的值是什么，但它们包括“标题”、“动作”（这似乎是您指定这是一个命名目的地的地方，尽管我不知道该值是什么）和“URI”（如果这是一个外部链接，则使用它——我怀疑这将指定您链接到的命名目的地的名称）。同样，很难找到细节。

然后遍历阅读器的页面，将每个页面导入到 PdfCopy。 [此页面](http://itextdocs.lowagie.com/tutorial/general/copystamp/index.php)可能会对您有所帮助。

对不起，我对你没有更多的帮助。祝你好运。

PS 如果其他人知道 (L)GPL 或 BSD 许可的更好工具，我很想听听。

# syntax-highlighting - 用于在网页上发布代码的代码语法格式化程序

> ID：173496
> 
> 赞同：3
> 
> 时间：2008-10-06T07:46:35.107
> 
> 标签：syntax-highlighting

当您在网站上发布代码块（.net c#）时，是否有一个实用程序可以为代码块（.net c#）生成 html 或 css？

我见过几个网站的代码格式非常好，我不相信他们是手动完成的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T07:51:16.207

谷歌美化 -

[http://code.google.com/p/google-code-prettify/](http://code.google.com/p/google-code-prettify/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T09:12:37.790

我更喜欢[Syntax Highlighter](http://code.google.com/p/syntaxhighlighter/)实现（我正在为我的[博客使用](http://rabdullin.com/)[Wordpress 插件](http://thislab.com/2007/12/16/release-wordpress-plugin-syntaxhighlighter-plus/)实现）。

**好处**

*   它基于 JavaScript，并不关心你在服务器上拥有什么。
*   具有这种格式的帖子可以在不同的 RSS 提要上正确显示，并且可以复制到剪贴板。
*   扩展语法规则很简单。我用它来突出基于 Boo 的 DSL 中的自定义运算符（请参阅[示例帖子](http://rabdullin.com/implementing-exception-handling-application-block-with-photonnet/)）
*   开箱即用支持多种语言

[![用 Java Script 编写的免费语法荧光笔](https://i.stack.imgur.com/FYGej.png)](https://i.stack.imgur.com/FYGej.png)
[（来源：[googlecode.com](http://syntaxhighlighter.googlecode.com/files/Overview01.png)）]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T07:53:50.413

**CopySourceAsHtml**是 Microsoft Visual Studio 2005 的插件，它允许您将源代码、语法突出显示和行号复制为 HTML。

[http://copysourceashtml.codeplex.com](http://copysourceashtml.codeplex.com)

它是高度可配置的，并且比下载页面所期望的要好得多！不知道VS 2008是否有类似的东西

如果您没有能力添加 google prettifier CSS 参考，这将是一个更好的方法，因为您得到的是具有所需样式的完整 HTML。我一直在我们的开发者 wiki 上使用它，并且喜欢它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T07:58:54.350

您可以获得 JavaScript 语法高亮脚本，例如Dean Edwards 的[这个](http://dean.edwards.name/weblog/2005/06/star-light/)。

这也是一个显然基于它的[jQuery 版本，看起来不错。](http://blog.scriptia.net/wp-content/plugins/chili/chili-1.0-manual.txt)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T15:00:48.053

如果您不想安装任何东西，一个更好的解决方案是使用我编写的名为 BlogTrog CodeWindow 的小网络应用程序：

[http://www.blogtrog.com](http://www.blogtrog.com)

它很容易使用。只需粘贴您的代码并嵌入结果。

# c# - C# 开源 NMEA 解析器

> ID：173497
> 
> 赞同：10
> 
> 时间：2008-10-06T07:47:51.423
> 
> 标签：c#, nmea

我正在寻找 C# 开源 NMEA 解析器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T08:10:01.147

好吧，我自己不熟悉它，但是一些快速搜索在[CodeProject](http://www.codeproject.com/KB/cs/NMEAtoOSG.aspx)上显示了一个，它链接到其他 2 个，[这里](http://www.codeproject.com/KB/mobile/WritingGPSApplications1.aspx)和[这里](http://www.codeproject.com/KB/mobile/WritingGPSApplications2.aspx)。这些有帮助吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T14:28:31.973

查看[SharpGPS](http://www.codeplex.com/SharpGPS)。还有其他几个与 gps 和 nmea 相关的项目 o codeplex

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-30T21:33:31.237

FWIW，自己解析基本的并不难（10-40 LOC）。如果您发现需要这样做，[这里](http://www.gpsinformation.org/dale/nmea.htm)有一个包含一些有用信息的链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-04T20:19:34.080

另一种（支持多种设备） [http://www.codeproject.com/Articles/279647/NMEA-sentence-parser-builder](http://www.codeproject.com/Articles/279647/NMEA-sentence-parser-builder)

# php - 使用 PHP 获取 CSV 文件的第一行并使用数据创建 MySQL 表

> ID：173498
> 
> 赞同：2
> 
> 时间：2008-10-06T07:48:34.620
> 
> 标签：php, mysql, file-io, csv

我正在尝试获取一个相当大的 CSV 文件并将其插入 MySQL 数据库以在项目中引用。我想使用文件的第一行来创建使用正确数据类型的表，而不是每列的 varchar。最终目标是自动化这个过程，因为我有几个类似的文件，但每个文件在 CSV 文件中都有不同的数据和不同数量的“列”。我遇到的问题是 gettype() 为每一列返回“字符串”，而不是我想要的 int、float 和 string。

平台是 PHP 5，操作系统是 ubuntu 8.04

到目前为止，这是我的代码：

```
<?php

// GENERATE TABLE FROM FIRST LINE OF CSV FILE

$inputFile = 'file.csv';
$tableName = 'file_csv';

$fh = fopen($inputFile, 'r');
    $contents = fread($fh, 5120); // 5KB
fclose($fh);

$fileLines = explode("\n", $contents); // explode to make sure we are only using the first line.

$fieldList = explode(',', $fileLines[0]); // separate columns, put into array
echo 'CREATE TABLE IF NOT EXISTS `'.$tableName.'` ('."<br/>\n";
for($i = 0; $i <= count($fieldList); $i++)
{
    switch(gettype($fieldList[$i])) {
        case 'integer':
            $typeInfo = 'int(11)';
            break;
        case 'float':
            $typeInfo = 'float';
            break;
        case 'string':
            $typeInfo = 'varchar(80)';
            break;
        default:
            $typeInfo = 'varchar(80)';
            break;
    }
if(gettype($fieldList[$i]) != NULL) echo "\t".'`'.$i.'` '.$typeInfo.' NOT NULL, --'.gettype($fieldList[$i]).' '.$fieldList[$i]."<br/>\n";
}
echo '  PRIMARY KEY  (`0`)'."<br/>\n";
echo ') ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;'; 
```

示例第一行：1,0,0,0,0,0,0,0,0,0,0,0,0.000000,0.000000,0,0,0,,0,0,1,0,50,'召回词（旧）'，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T08:37:47.953

建立在[Nouveau](https://stackoverflow.com/questions/173498/using-php-to-take-the-first-line-of-a-csv-file-and-create-a-mysql-table-with-th#173526)的代码上，你可以做到这一点

```
for($i = 0; $i <= count($fieldList); $i++)
{
    if (is_numeric($fieldList[$i]))
    {
        if (strpos($fieldList[$i],'.') !== false){
            $fieldList[$i] = (int)$fieldList[$i];
        }else{
            $fieldList[$i] = (float)$fieldList[$i];
        }
    }

    switch(gettype($fieldList[$i])) {
        case 'integer':
            $typeInfo = 'int(11)';
            break;
        case 'float':
        case 'double':
            $typeInfo = 'float';
            break;

        case 'string':
            $typeInfo = 'varchar(80)';
            break;
        default:
            $typeInfo = 'varchar(80)';
            break;
    }
if(gettype($fieldList[$i]) != NULL) echo "\t".'`'.$i.'` '.$typeInfo.' NOT NULL, --'.gettype($fieldList[$i]).' '.$fieldList[$i]."<br/>\n";

} 
```

这可行，请注意在开关中添加了“case 'double':”，但可能有更好的方法来进行 int/float 检查，因为它们仅适用于标准的 uk/us 数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T07:59:46.593

尝试转换该值并将其与原始值进行比较：

```
define('DECIMAL_SEPARATOR', '.');

switch ($fieldList[$i])
{
    case (string)(int)$fieldList[$i]:
        $typeInfo = (strpos($fieldList[$i], DECIMAL_SEPARATOR) === false) ? 'int(11)' : 'float';
        break;
    case (string)(float)$fieldList[$i]:
        $typeInfo = 'float';
        break;
    default:
        $typeInfo = 'varchar(80)';
        break;
} 
```

另外，在第一种情况下检查是否存在小数分隔符以查找整数，但它们具有小数部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T08:44:29.593

```
<?php

// GENERATE TABLE FROM FIRST LINE OF CSV FILE

$inputFile = 'file.csv';
$tableName = 'file_csv';

$fh = fopen($inputFile, 'r');
    $contents = fread($fh, 5120); // 5KB
fclose($fh);

$fileLines = explode("\n", $contents);

$fieldList = explode(',', $fileLines[0]);
echo 'CREATE TABLE IF NOT EXISTS `'.$tableName.'` ('."<br/>\n";
for($i = 0; $i <= count($fieldList); $i++)
{

    if(strlen($fieldList[$i]) == 0) $typeInfo = 'varchar(80)';
    if(preg_match('/[0-9]/', $fieldList[$i])) $typeInfo = 'int(11)';
    if(preg_match('/[\.]/', $fieldList[$i])) $typeInfo = 'float';
    if(preg_match('/[a-z\\\']/i', $fieldList[$i])) $typeInfo = 'varchar(80)';

    echo "\t".'`'.$i.'` '.$typeInfo.' NOT NULL, -- '.gettype($fieldList[$i]).' '.$fieldList[$i]."<br/>\n";
}
echo '  PRIMARY KEY  (`0`)'."<br/>\n";
echo ') ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T08:43:38.817

使用正则表达式将为您提供灵活的解决方案。如果您需要检测日期字段，那么这是要走的路。

# php - 如何使用 Zend 框架生成 pdf 文件_with_ utf-8 多字节字符

> ID：173503
> 
> 赞同：5
> 
> 时间：2008-10-06T07:50:31.700
> 
> 标签：php, zend-framework, pdf, unicode

Zend Framework Zend_Pdf 类有一个“小”问题。从生成的 pdf 文件中去除多字节字符。例如，当我写 aąbcčdeę 时，它变成 abcd 并去掉了立陶宛字母。

我不确定它是特别是 Zend_Pdf 问题还是一般的 php。

源文本以 utf-8 编码，以及完成这项工作的 php 源文件。

预先感谢您的帮助 ;）

PS 我运行 Zend Framework v. 1.6 并使用 FONT_TIMES_BOLD 字体。FONT_TIMES_ROMAN 确实有效

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-27T17:33:14.223

`Zend_Pdf`Zend Framework 1.5 版本支持 UTF-8。但是，标准 PDF 字体仅支持 Latin1 字符集。这意味着您不能使用`Zend_Pdf_Font::FONT_TIMES_BOLD`或任何其他“内置”字体。要使用特殊字符，您必须加载包含来自其他字符集的字符的另一种 TTF 字体。

我使用 Mac OS X，所以我尝试了以下代码，它生成了一个包含正确字符的 PDF 文档。

```
$pdfDoc = new Zend_Pdf();
$pdfPage = $pdfDoc->newPage(Zend_Pdf_Page::SIZE_LETTER);

// load TTF font from Mac system library
$font = Zend_Pdf_Font::fontWithPath('/Library/Fonts/Times New Roman Bold.ttf');
$pdfPage->setFont($font, 36);

$unicodeString = 'aąbcčdeę';
$pdfPage->drawText($unicodeString, 72, 720, 'UTF-8');

$pdfDoc->pages[] = $pdfPage;
$pdfDoc->save('utf8.pdf'); 
```

另请参阅此错误日志： http: [//framework.zend.com/issues/browse/ZF-3649](http://framework.zend.com/issues/browse/ZF-3649)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T11:37:50.570

我相信 Zend_Pdf 在 1.5 中获得了 UTF-8 支持 - 你运行的是哪个版本的 Zend Framework？

另外 - 你想用什么字体渲染？您是否尝试过替代字体？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T01:56:48.980

您是否确定将字符编码设置为手册中的示例？

```
// Draw the string on the page
$pdfPage->drawText($unicodeString, 72, 720, 'UTF-8'); 
```

如果您不得不使用**粗体**字体，也许可以尝试其他粗体字体之一？

```
Zend_Pdf_Font::FONT_COURIER_BOLD
Zend_Pdf_Font::FONT_TIMES_BOLD
Zend_Pdf_Font::FONT_HELVETICA_BOLD 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T07:03:23.463

ZF v. 1.6，TIMES_BOLD（据我所知，这是使文本变粗的唯一方法？）

# glassfish - 为什么使用 Glassfish 而不是 Apache？它的优点和缺点是什么？

> ID：173504
> 
> 赞同：62
> 
> 时间：2008-10-06T07:50:37.160
> 
> 标签：glassfish

抱歉我在这里的无知，但是当我听到 webserver 这个词时，我立刻想到了 Apache，虽然我知道人们也使用微软的 IIS。然而，自从我在 Stackoverflow 上闲逛以来，我注意到很多人使用 Glassfish。

这让我想知道，我为什么要使用 Glassfish（从某种意义上说，我很感兴趣，但我真的不明白为什么它会让我的生活更轻松）。根据我的阅读，它是 Sun 的 Apache Tomcat 的开源衍生产品，因此我认为它是一款优质（或出色）的产品。但由于我不知道它的优缺点，我不知道何时选择 Glassfish 而不是另一台服务器是明智的。谁能详细说明？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-10-06T07:53:58.883

GlassFish 是一个应用程序服务器，也可以用作 Web 服务器（Http 服务器）。

Web 服务器意味着：处理 HTTP 请求（通常来自浏览器）。

Servlet 容器（例如 Tomcat）意味着：它可以处理 servlet 和 JSP。

应用服务器（例如 GlassFish）意味着：它可以管理 Java EE 应用程序（通常是 servlet/JSP 和 EJB）。

您应该将 GlassFish 用于 Java EE 企业应用程序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-06T08:54:33.007

在生产环境中最需要单独的 Web 服务器。您通常会发现应用程序服务器足以满足您的大部分开发需求。Web 服务器能够容纳更多的活动会话和连接，从而在没有性能成本的情况下提供必要的平衡。

如果您只使用 servlets/jsps，请坚持使用简单的 Web 服务器。还需要注意的是，在netbeans环境下，glassfish比其他App服务器有更好的支持。不过，在 eclipse 的上下文中，WSAD 和 JBoss 似乎是首选选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T09:16:06.333

Glassfish 将很快发布模块化内核。

这意味着您需要的容器可以根据需要启动和关闭。即没有部署EAR，EJB 容器不会启动。这似乎使它非常适合开发，因为它可以*非常*快速地启动和停止。这使它更接近于 Rails 等开发环境（重新部署是开发的重要组成部分）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-22T15:06:47.353

I have used GlassFish server for developing Web Services. It provides a very interactive Admin Console where admin can test the Web Services. I really find it helpful while developing Web Services

# vb.net - 如何更改 WinForms Treeview LabelEdit 中的 259 个字符限制？

> ID：173520
> 
> 赞同：1
> 
> 时间：2008-10-06T07:57:23.323
> 
> 标签：vb.net, treeview

我的 VB.Net Winforms 应用程序是一个工具，允许在树中编辑分层数据，然后将其存储在数据库中。我正在使用树视图控件。

内容从其他文档拖放到树节点上，或者可以直接编辑节点。

如果我直接编辑数据库字段，并输入一些内容（一千个字符或更多！），树视图会很高兴地显示它。但是，当我拖放时，数据被截断为 259 个字符。如果我直接编辑，最大编辑“窗口”也是 259 个字符。

259 似乎是一个非常奇怪的数字，所以我想知道 - 这个大小来自哪里，我可以通过编程方式更改它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T04:55:40.827

我建议采取不同的方法。您可能不想在他们的 TreeNode 中向您的用户显示文档的所有 10000 个字符或字符，因此请创建一个具有名称和内容等属性的自定义数据存储类来存储文档及其标题。将您的内容添加到 Content 属性和标题或对 Name 属性有意义的内容，然后将对象添加到 TreeNode 对象的 Tag 属性。

```
Dim mynode As New TreeNode
Dim SomeBigCustomObject as New MyContentStorageObject(name,content)
mynode.Text = SomeBigCustomObject.Name
mynode.Tag = SomeBigCustomObject
TreeView1.Nodes.Add(mynode) 
```

然后，您可以在选择节点（使用 AfterSelect 事件）时取回对象，如下所示：

```
dim ContentStorageObject As MyContentStorageObject = CType(e.Node.Tag,   MyContentStorageObject)
dim content as string = ContentStorageObject.Content 
```

如果您需要编辑文本，我会弹出一个编辑器对话框或将存储在内容中的数据发送到表单上的文本框进行编辑。您的用户可能会喜欢不必在树视图节点编辑器中输入所有内容。

That's a real quick and dirty explanation, but the essence is "use the .Tag property". Good luck.

# clone - 在现有数据库的基础上创建一个新的 rrd 数据库

> ID：173527
> 
> 赞同：4
> 
> 时间：2008-10-06T07:59:53.193
> 
> 标签：clone, reverse-engineering, rrdtool, rrd

我有一些旧的 rrdtool 数据库，其确切的创建方法早已丢失。我需要创建一个与当前数据库具有相同特征的新数据库。我已经转储了几个旧数据库并仔细研究了内容，但我不确定如何解释元数据。我认为它出现在以下节中

```
<cf> AVERAGE </cf>
<pdp_per_row> 360 </pdp_per_row> <!-- 1800 seconds -->
<xff> 5.0000000000e-01 </xff> 
```

有四个这样的节，这与我记得循环级联的设置方式相对应。有没有人已经这样做了，或者可以告诉我如何从现有的数据库中克隆一个新的空 rrd 数据库？或者告诉我我在文档中错过了这个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-09-19T19:45:31.980

我使用命令[rrdcreate](https://oss.oetiker.ch/rrdtool/doc/rrdcreate.en.html)。它可以基于现有的 rrd 创建一个新的 rrd。-t 参数指示现有的 rrd 作为模板。

rrdcreate new.rrd -t existing.rrd

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T08:08:35.923

rrdtools 的[rrdinfo](http://oss.oetiker.ch/rrdtool/doc/rrdinfo.en.html)是你的朋友！

它将告诉您如何创建 rrd 文件的数据源和存档。例子

```
$ rrdtool info random.rrd
filename = "random.rrd"
rrd_version = "0001"
step = 300
last_update = 955892996
ds[a].type = "GAUGE"
ds[a].minimal_heartbeat = 600
ds[a].min = NaN
ds[a].max = NaN
ds[a].last_ds = "UNKN"
ds[a].value = 2.1824421548e+04
ds[a].unknown_sec = 0
ds[b].type = "GAUGE"
ds[b].minimal_heartbeat = 600
ds[b].min = NaN
ds[b].max = NaN
ds[b].last_ds = "UNKN"
ds[b].value = 3.9620838224e+03
ds[b].unknown_sec = 0
rra[0].cf = "AVERAGE"
rra[0].pdp_per_row = 1
rra[0].cdp_prep[0].value = nan
rra[0].cdp_prep[0].unknown_datapoints = 0
rra[0].cdp_prep[1].value = nan
rra[0].cdp_prep[1].unknown_datapoints = 0 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-01T09:02:54.620

您可以尝试使用[此处描述的克隆脚本。](http://code.google.com/p/python-rrd-schema-parse/source/browse/rrdinfo-parser.py)这是非常基本的，但它适用于简单的 rrd 文件。我用它来找出由 munin 生成的模式。我需要将旧数据插入 munin，因此我对架构进行了逆向工程，将 --start 设置为旧数据开始之前的日期，并将数据重新导入 rrd。

```
$ python rrdinfo-parser.py -f test.rrd
rrdtool create test.rrd --start 920804400 --step 300 \
DS:speed:COUNTER:600:U:U \
RRA:AVERAGE:0.5:1:24 \
RRA:AVERAGE:0.5:6:10 \ 
```

# windows - 刷新磁盘写缓存

> ID：173560
> 
> 赞同：6
> 
> 时间：2008-10-06T08:12:48.707
> 
> 标签：windows, windows-xp, disk

当 Windows XP 和 Vista 中的磁盘策略设置为在硬盘上启用写入缓存时，有没有办法刷新刚刚写入的文件，并确保它已提交到磁盘？

我想在 C++ 中以编程方式执行此操作。

关闭文件确实会在应用程序级别执行刷新，但不会在操作系统级别执行。如果在关闭文件后、但在操作系统刷新磁盘写入缓存之前从 PC 上断电，则即使文件已关闭，文件也会丢失。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-07-18T22:22:25.197

.NET FileStream.Flush() 不会刷新该文件内容的 Windows 缓存；Flush() 仅刷新 .NET 内部文件缓冲区。在 .NET 4.0 中，Microsoft 通过向 Flush() 添加一个可选参数来解决此问题，如果设置为 true，则会调用 FlushFileSystemBuffers。在 .NET 3.5 及以下版本中，您唯一的选择是通过 pinvoke 调用 FlushFileBuffers。有关如何执行此操作，请参阅 MSDN 的[FileStream.Flush社区评论。](http://msdn.microsoft.com/en-us/library/2bw4h516%28v=VS.90%29.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-06T15:37:33.063

您不应该在关闭文件时修复此问题。Windows 将缓存，除非您打开传递`FILE_FLAG_WRITE_THROUGH`给 CreateFile() 的文件。

您可能还想通过`FILE_FLAG_NO_BUFFERING`；这告诉 Windows 不要在缓存中保留字节的副本。

根据 MSDN 上的 CreateFile 文档，这比 FlushFileBuffers() 更有效。

另请参阅MSDN 上的[文件缓冲](http://msdn.microsoft.com/en-us/library/cc644950%28VS.85%29.aspx)和[文件缓存](http://msdn.microsoft.com/en-us/library/aa364218%28VS.85%29.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T08:43:57.020

你还没有指定开发环境，所以：

# 。网

IO 流有一种`.Flush`方法可以满足您的需求。

# Win32 API

有一个`FlushFileBuffers`调用，它将文件句柄作为参数。

编辑（基于 OA 的评论）： FlushFileBuffers 不需要管理权限；只有当传递给它的句柄是卷的句柄，而不是单个文件的句柄时，它才会这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-06T14:58:23.577

您还应该注意，您的数据可能不会被刷新到**实际**磁盘，即使在调用框架 API 的刷新方法时也是如此。

调用 flush 方法只会告诉内核将其页面刷新到磁盘。但是，如果您打开了磁盘写入缓存，则可以无限期地延迟实际的写入过程。

为了确保您的数据被写入物理层，您必须关闭操作系统中的写入缓存。在处理大量小型 io 操作时，这通常会导致性能损失高达一到两个数量级。基于电池的支持 (UPS) 或接受命令以刷新磁盘写入缓存的磁盘是处理此问题的另一种选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T10:29:59.553

从 microsoft 文档中，您将使用[_flushall](http://msdn.microsoft.com/en-us/library/s9xk9ehd%28VS.71%29.aspx)并在 COMMODE.OBJ 中链接以确保所有缓冲区都已提交到磁盘。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-17T15:56:10.763

见这里：[https ://jeffpar.github.io/kbarchive/kb/066/Q66052/](https://jeffpar.github.io/kbarchive/kb/066/Q66052/)

当您最初使用 fopen 打开文件时，将“c”模式选项作为最后一个选项：

```
fopen( path, "wc") // w - write mode, c - allow immediate commit to disk 
```

然后当你想强制刷新到磁盘时，调用

```
_flushall() 
```

我们在打电话之前打了这个电话

```
fclose() 
```

我们遇到了您描述的确切问题，这种方法解决了它。

请注意，这种方法不需要管理权限，正如其他人所提到的那样，这`FlushFileBuffers` *确实需要。*

从上面的网站：

*“Microsoft C/C++ 7.0 版为 fopen() 函数引入了“c”模式选项。当应用程序打开文件并指定“c”模式时，运行时库将文件缓冲区的内容写入磁盘应用程序调用 fflush() 或 _flushall() 函数。"*

# isaserver - Open port 8080 (APACHE) in ISA Server 2006

> ID：173564
> 
> 赞同：0
> 
> 时间：2008-10-06T08:16:04.067
> 
> 标签：isaserver

Im using APACHE as my web server and using port 8080\. Ive create a site called (e.g. [http://test.domain.com:8080](http://test.domain.com:8080)). I have a Firewall (ISA Server 2006).

How am I suppose to establish "[http://test.domain.com:8080](http://test.domain.com:8080)"in ISA Server? Will I just add "[http://test.domain.com](http://test.domain.com)" as its public name or with this "[http://test.domain.com:8080](http://test.domain.com:8080)"?

any suggestion will be appreciated. Thanks. :D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T08:43:30.237

Create a rule and related listner rule to listen on port 80 for the domain test.domain.com Then on the bridging tab of the rule, redirect to port 8080.
(That's if you want users to use port 80 rather then 8080).

It's public name would be test.domain.com

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T09:20:38.460

非常感谢布拉瓦克斯！

这是我到目前为止所做的步骤......首先我创建了一个网络发布规则，它的公共名称是（例如 test.domain.com），然后在建立新的网络规则后，我转到它的属性并转到桥接选项卡...我将“重定向到 http 端口的请求”从 80 更改为 8080。

然后我创建了一个“访问规则”，打开了“Http8080”协议。

我做了正确的设置吗？

# asp.net - Is it possible to use the LoginView control in combitation with the server session in ASP.NET?

> ID：173567
> 
> 赞同：0
> 
> 时间：2008-10-06T08:18:11.177
> 
> 标签：asp.net, security

Is it possible to use the LoginView control in combitation with the server session in ASP.NAT?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T17:44:22.250

是的，它可以自动使用会话。您可以在会话中设置用户名字段或身份验证字段，以便您知道。像 Session("username") = curUser

或者你想做什么？

# c# - 如何在 C#/Vista 中将鼠标事件传递给我背后的应用程序？

> ID：173579
> 
> 赞同：5
> 
> 时间：2008-10-06T08:28:20.717
> 
> 标签：c#, events, windows-vista, mouse

我正在用 C# 编写一个非常专业的应用程序，它作为一个几乎透明的窗口漂浮在整个桌面上。我希望能够创建鼠标事件并将其传递给我背后的应用程序，并让它们看起来“正常”运行，以响应这些事件。如果窗口管理器可以响应，那也更好。

我不是 Windows 专家，我不确定如何最好地完成此任务。

从这个页面： [http ://bytes.com/forum/thread270002.html](http://bytes.com/forum/thread270002.html)

看起来 mouse_event 会很好，除了因为我的应用程序漂浮在其他所有东西上，我猜我生成的事件永远不会到达下面的其他应用程序。

似乎替代方案是 SendMessage，但这需要对窗口进行大量手动操作，并且生成的鼠标事件不是“真实的”。

对解决此问题的最佳方法有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T10:18:12.180

在查看了系统挂钩和其他低级解决方案后，我发现了一个更简单的方法。

首先，将表单的 TransparencyKey 和 BackColor 设置为相同。这对我来说没有任何视觉差异，因为我的表单在视觉上已经是透明的，但这将有助于让鼠标事件通过。

其次，下面的代码会让鼠标事件“落入”你的表单。

```
protected override CreateParams CreateParams
{
    get
    {
        CreateParams createParams = base.CreateParams;
        createParams.ExStyle |= 0x00000020; // WS_EX_TRANSPARENT

        return createParams;
    }
} 
```

最后，将 TopMost 设置为 true。

您的表单现在将在视觉上漂浮在所有内容之上，但会放弃对所有其他应用程序的关注。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T08:44:31.170

听起来你想做一些过滤用户输入的事情。

也许您只需要一个键盘/鼠标挂钩。

您可能想看看 Windows API 调用 SetWindowsHookEx。

还应该有足够的示例如何在 C# 中执行此操作，我发现的第一件事是[这个链接](http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx)（可能不是最好的文章，但应该给你一个想法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-17T15:08:45.437

如果禁用控件并返回，则可以将 MouseDown 事件传递给父级。

# ruby - 如何在 wxRuby 应用程序中恢复窗口大小和位置？

> ID：173581
> 
> 赞同：2
> 
> 时间：2008-10-06T08:29:13.057
> 
> 标签：ruby, wxruby

有谁知道在 wxRuby 中恢复窗口位置和大小的任何示例代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T14:12:08.433

YAML 将是序列化首选项的更好选择，但在这里我只是将逗号分隔的字符串存储在 prefs.txt 文件中。

```
require "rubygems"
require "wx"
include Wx

class MyApp < App
  def on_init
    left, top, width, height = *prefs
    position = Point.new(left, top)
    size = Size.new(width, height)
    main = Frame.new(nil, -1, "Title", position, size)

    #when the window closes, save the location
    main.evt_close do |event|
      save_window_location(event.get_event_object)
      event.skip
    end
    main.show()
  end

  private

  def save_window_location(frame)
    self.prefs = [
      frame.position.x,
      frame.position.y,
      frame.size.width,
      frame.size.height
    ]
  end

  #load the prefs and return them as an array
  def prefs
    location = []
    begin
      location = File.read(prefs_filename).split(',').map{|s| s.to_i}
    rescue Exception
      #file didn't exist, or read failed
    end
    location = [100, 100, 300, 300] if location.size != 4
    return location
  end

  #save the prefs as a comma-delimited string
  def prefs=(prefs_array)
    File.open(prefs_filename, 'w') do |prefs_file|
      prefs_file << prefs_array.join(",")
    end
  end

  def prefs_filename
    'prefs.txt'
  end
end

MyApp.new.main_loop 
```

# tfs - TFS: comparing shelveset files with local version

> ID：173582
> 
> 赞同：44
> 
> 时间：2008-10-06T08:33:06.590
> 
> 标签：tfs

When viewing files in a shelveset, I would like the option of comparing the files to my current local version. Unfortunately, the only options available are "With Unmodified", "With Workspace" (I guess this one would be the answer, if it wasn't disabled) and "With Latest".

Any ideas?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-12-03T22:58:37.577

使用 Team Foundation Sidekicks 将 Shelveset 导出到本地文件夹，并使用文件比较工具与本地版本进行比较。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-24T07:05:24.347

最多[我如何轻松区分/比较 TFS 中的 2 个搁置集？](https://stackoverflow.com/questions/2552955/how-can-i-easily-diff-compare-2-shelvesets-in-tfs)

使用 VS2013 ShelvesetComparer[或](http://visualstudiogallery.msdn.microsoft.com/1fa59764-efc6-457a-a5f3-81ca68e280e8)VS2012 ShelvesetComparer [，](http://visualstudiogallery.msdn.microsoft.com/33c521d4-73fc-48be-969d-fa68c511341f)将本地版本搁置到另一个搁置集中，然后在两个搁置集之间进行比较...

虽然这会产生另一个不需要的搁置集，并且您无法在文件比较编辑器中编辑本地。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-07-28T22:33:08.233

在 VS2015 更新 3 中：

1.  转到待定更改 > 操作 > 查找搁置集
2.  选择要比较的搁置集，右键单击并选择*查看搁置集详细信息*
3.  右键单击文件，选择*打开*
4.  右键单击选项卡，选择*复制完整路径*
5.  在解决方案资源管理器中，右键单击文件，选择*比较...*
6.  将完整路径粘贴到*Source Path*中，然后单击*OK*

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-14T09:28:46.883

尽管这不是理想的方法，但根据您的比较工具，您可以告诉它将搁置的版本与本地版本（工作区）进行比较。我使用 Beyond Compare，这允许您打开一个文件进行比较。因此，我从搁置集中与“最新”进行比较，然后将“最新”替换为我的本地工作区版本。

不幸的是，我刚刚检查了内置的比较工具，它没有提供这个选项。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T19:00:32.407

我认为无法将搁置的版本与 Visual Studio 中的本地版本进行比较，但我会非常高兴地纠正这个问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-25T21:57:33.573

这是一个有效的简单技巧：

1.  点击“取消搁置”
2.  选择合适的搁置
3.  单击“详细信息”按钮
4.  右键单击要比较的文件
5.  点击“查看”
6.  这将在您的文本编辑器中打开，将其保存到您的桌面或您喜欢的任何地方。
7.  打开您的文件差异程序并将保存的版本与您的本地版本进行比较。

简而言之，保存您从服务器检索到的搁置版本的副本，然后使用您的差异工具进行手动比较。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T10:21:13.603

这有点费力，但它可以完成工作：

1.  右键单击解决方案资源管理器中的任何文件，然后从上下文菜单中选择“Unshelve Pending Changes...”。

2.  双击取消搁置对话框中的相关搁置集。

3.  双击要比较的文件。这将在记事本中打开文件的 sheleveset 版本。

4.  将文件保存在本地计算机上的某个位置。

5.  关闭所有对话框。

6.  在解决方案资源管理器中右键单击文件的本地工作区版本，然后从上下文菜单中选择“比较”。

7.  将目标路径更改为您之前保存的文件的路径，然后单击确定。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-18T16:36:54.333

很长一段时间以来，我一直在寻找一种方法来做到这一点。我想知道创建一个 vs.net 插件来为你做这件事有多难。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-10-16T13:39:15.453

在 TFS 中，创建一个新的（临时）工作区，并将其映射到一个新的本地文件夹。将最新版本获取到新工作区中，然后将搁置集解开到新工作区中。这为您提供了应用了搁置集的源的临时本地副本。然后改回原来的工作区，点击file => source control => compare。然后输入原始工作空间和新临时工作空间的本地文件夹路径，将您的原始本地版本与 lcoal shelevest 版本进行比较。

# c# - How to catch Control-V in C# app?

> ID：173593
> 
> 赞同：6
> 
> 时间：2008-10-06T08:42:09.613
> 
> 标签：c#, message, keyevent

I've tried to override WndProc, but no message show up on paste event.

Then I tried to create custom filter and using method PreFilterMessage I was able to catch message with value 257 (KEYUP event), but that's not enough...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-06T08:50:33.187

Use:

```
 protected override void OnKeyDown(KeyEventArgs e)
 {
      if (e.KeyCode == Keys.V && e.Modifiers == Keys.Control)
      {
            MessageBox.Show("Hello world");
      }
      base.OnKeyDown(e);
  } 
```

Make sure your form KeyPreview = true.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T09:18:48.510

您可以通过以下方式做到这一点：

*   拦截表单的 KeyDown（或 KeyUp）中的`Ctrl`+`V`
*   在您的表单中创建一个菜单，其中包含一个带有`Ctrl`+`V`快捷方式的粘贴选项（这可能会更好，因为您会让用户寻找这些选项）
*   像您在问题中描述的那样拦截 KEYDOWN 消息并检查`Ctrl`当时是否按下（我认为这是所有 3 中最难的）。

我个人会选择使用菜单选项。

# windows-ce - 如何在对 XXX_IOControl 的调用结束后映射 Windows CE 设备驱动程序中的调用者内存？

> ID：173596
> 
> 赞同：1
> 
> 时间：2008-10-06T08:43:31.263
> 
> 标签：windows-ce, device-driver

我在 Windows CE 设备驱动程序中实现了一个 ioctl，它采用指向大量应用程序内存的指针来执行通过对 DeviceIoControl 的应用程序调用启动的异步 I/O。

使用 MapCallerPtr() 时，指针在 XXX_IOControl 函数返回时被取消映射；当指针在 IST 中使用时，它不再被映射导致崩溃。

将超出调用结束的指针映射到 XXX_IOControl 的最佳方法是什么？应用程序保证内存将保持有效，直到它从驱动程序收到驱动程序已完成它的指示。

这是在 Windows CE 5.0 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T09:06:49.597

回答我自己的问题：

在 XXX_IOControl 中，使用 MapPtrToProcess() 映射指针并使用 GetCurrentPermissions() 保存线程的权限。在将使用映射指针的线程中，使用从 GetCurrentPermissions() 保存的返回值调用 SetProcPermissions()，取消引用指针，然后在完成后恢复线程权限。

```
DWORD saved_perms = SetProcPermissions(caller_perms);
... Do stuff ...
SetProcPermissions(saved_perms); 
```

# unit-testing - 您如何在大型项目中构建 NUnit 测试？

> ID：173616
> 
> 赞同：9
> 
> 时间：2008-10-06T08:56:28.617
> 
> 标签：unit-testing, nunit

我有兴趣看看我是否可以改进我们在包含 30 多个项目的 Visual Studio 解决方案中使用 NUnit 的方式。

首先，您是否会为解决方案中的每个程序集提供一个测试程序集，或者您是否会尝试减少测试程序集的数量？我开始创建许多测试程序集，但我认为这在构建时间方面花费了我们很多。

其次，您使用什么策略来管理那些长时间运行或需要特殊环境配置的测试？我想编写一个 MSBuild 脚本来自动运行我们的单元测试，但它需要跳过那些需要太长时间或无法在构建机器上运行的测试。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T09:02:20.463

要回答您的第一个问题：

如果您想这样做，您可以使用[类别](http://www.nunit.org/index.php?p=category&r=2.4.8)将所有内容组织在一个程序集中。至于它是否会减少构建时间，我可能会冒险猜测，但我认为总体上不会是一个巨大的数字。

回答你的第二个：

你可以使用[category](http://www.nunit.org/index.php?p=category&r=2.4.8)和[`[Explicit]`](http://www.nunit.org/index.php?p=explicit&r=2.4.8)and[`[Ignore]`](http://www.nunit.org/index.php?p=ignore&r=2.4.8)属性来告诉 NUnit 哪些测试要运行，哪些测试你必须告诉它在它运行之前运行。您可能还想查看`[Platform]`或其他一些属性，具体取决于您对“环境”的确切要求。

例如，您可以为所有长时间运行的测试添加一个显式标签。然后你必须明确地运行这些测试，NUnit 不会自动运行它们。或者将所有这些测试添加到一个类别中，然后当您运行 NUnit 时，告诉它明确不运行该类别。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T09:10:53.190

对于您的情况，我将其归结为几个选项：

*   **将您现有的项目合并为更少的项目，从而为它们合并相应的测试项目**- 尝试考虑您是否真的需要 30 个项目（例如，30 个程序集），或者是否最好将它们简单地合并以减少依赖项的数量和构建时间。

*   **将您的测试放在相应的项目中**- 虽然这可能会引起激烈的反应，但请考虑一下：考虑到大量测试涉及获得稍大的装配的开销，可能值得减少管理两倍您实际项目数量的开销需要。

*   **将所有单元测试合并到几个项目中**- 如果您坚持保持每个程序集的清洁和独立，您可以选择合并所有单元测试，可能是在彼此相关的方面。

因此，您还可以制作不包括单元测试的解决方案配置 - 如果构建时间对您来说非常重要。如果您只是*按需*运行测试，这将特别有用。如果您使用的是持续集成，这应该不是问题：您可以拥有多个 CI 配置，其中一些包括构建测试，一些不包括。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T09:22:15.603

这是一个很好的问题，并引发了我对为长期运行的大型项目管理大量单元测试的一些担忧。

我的策略是为解决方案中与业务或框架相关的每个项目创建一个单元测试项目。单元测试不太适合测试项目的 UI 方面，我通常将其留给 scipted 测试。该项目是使用持续集成 (CI) 服务器构建的，每次开发人员提交大量工作时都会触发该服务器。CI 服务器还运行所有单元测试以及生成单元测试覆盖率统计信息。CI 环境使用 MSBuild 来构建解决方案。

随着时间的推移，值得评估您的所有单元测试是否都是必要的。许多回归测试工作将转向脚本测试，维护单元测试的开销可能会很昂贵。理想情况下，我希望在项目的整个生命周期内维护所有单元测试，但维护开销有时会令人望而却步。根据经验，单元测试是为业务规则和解决方案框架维护的，但不是为 UI、报告或工作流维护的。显然，这将取决于您的项目的具体情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T11:08:11.707

顺便说一句，我们发现[TestDriven.Net](http://testdriven.net/)是 NUnit 的优秀 VisualStudio 插件前端，免费供开源使用/学生使用。

# java - 从 Applet 调用 JS：MalformedURLException：未知协议：javascript

> ID：173617
> 
> 赞同：2
> 
> 时间：2008-10-06T08:57:52.453
> 
> 标签：java, javascript, url

我读到您可以通过调用从 Java Applet 调用 JavaScript 代码

```
JApplet.getAppletContext().showDocument( "javascript:alert('Hello World');" ); 
```

但是，当我这样做时，我收到以下错误：

```
java.net.MalformedURLException: unknown protocol: javascript 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T12:33:15.387

我得到与您相同的异常，因为 URL 类不接受 javascript: 作为有效协议。

不过有一种解决方法；为 URL 构造函数提供一个 URLStreamHandler。

例子：

```
final URLStreamHandler streamHandler = new URLStreamHandler() {

    @Override
    protected URLConnection openConnection(URL u)
        throws IOException {
        return null;
    }

};

try {
    getAppletContext().showDocument(
        new URL(null, "javascript:alert('It works!');", streamHandler));
} catch (MalformedURLException me) {
    //log or whatever
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T09:58:51.473

```
 try {
        this.getAppletContext().showDocument(new URL("javascript:alert('hello world');"));
    }catch(Exception e) {
        e.printStackTrace();
    } 
```

工作！

也许浏览器没有启用javascript..只是一个猜测

# c++ - 是否有可移植的等价于 DebugBreak()/__debugbreak？

> ID：173618
> 
> 赞同：73
> 
> 时间：2008-10-06T08:57:53.357
> 
> 标签：c++, portability, debugbreak

在 MSVC 中，[DebugBreak()](http://msdn.microsoft.com/en-us/library/ms679297.aspx)或[__debugbreak](http://msdn.microsoft.com/fr-fr/library/f408b4et.aspx)会导致调试器中断。在 x86 上它相当于写“_asm int 3”，在 x64 上它是不同的。使用 gcc（或任何其他标准编译器）编译时，我也想中断调试器。是否有独立于平台的功能或内在功能？我看到了关于这个的[XCode 问题](https://stackoverflow.com/questions/37299/xcode-equivalent-of-asm-int-3-debugbreak-halt)，但它似乎不够便携。

旁注：我主要想用它来实现 ASSERT，我知道我可以为此使用 assert()，但我也想在代码中写入 DEBUG_BREAK 或其他东西。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2011-04-06T03:07:32.107

一种可移植到大多数 POSIX 系统的方法是：

```
raise(SIGTRAP); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2018-03-02T23:47:34.307

我刚刚向可移植代码片段（可移植代码的公共域片段集合）添加[了](https://github.com/nemequ/portable-snippets/)一个[模块](https://github.com/nemequ/portable-snippets/tree/master/debug-trap)来执行此操作。它不是 100% 可移植的，但它应该非常健壮：

*   `__builtin_debugtrap`对于某些版本的 clang（用 标识`__has_builtin(__builtin_debugtrap)`）
*   在 MSVC 和英特尔 C/C++ 编译器上：`__debugbreak`
*   对于 ARM C/C++ 编译器：`__breakpoint(42)`
*   对于 x86/x86_64，组装：`int3`
*   对于 ARM Thumb，组装：`.inst 0xde01`
*   对于 ARM AArch64，汇编：`.inst 0xd4200000`
*   对于其他 ARM，组装：`.inst 0xe7f001f0`
*   对于 Alpha，组装：`bpt`
*   对于带有 GCC 的非托管 C（或伪装成它的东西），`__builtin_trap`
*   否则，包括`signal.h`和
    *   如果`defined(SIGTRAP)`（即 POSIX），`raise(SIGTRAP)`
    *   除此以外，`raise(SIGABRT)`

将来可移植片段中的模块可能会扩展到包含其他逻辑，我可能会忘记更新这个答案，所以你应该在那里寻找更新。它是公共领域（CC0），所以请随意窃取代码。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-06T09:05:26.477

如何定义一个基于#ifdef 的条件宏，该宏扩展为基于当前架构或平台的不同结构。

就像是：

```
#ifdef _MSC_VER
#define DEBUG_BREAK __debugbreak()
#else
...
#endif 
```

这将由预处理器根据编译代码的平台扩展正确的调试器中断指令。这种方式你总是`DEBUG_BREAK`在你的代码中使用。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-06T09:19:41.927

GCC 有一个名为的内置函数`__builtin_trap`，您可以[在此处](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/Other-Builtins.html#index-g_t_005f_005fbuiltin_005ftrap-2760)看到，但是假定一旦达到此代码执行就会停止。

你*应该*确保`__builtin_trap()`调用是有条件的，否则在它之后不会发出任何代码。

这篇文章由所有 5 分钟的测试推动，YMMV。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-10-03T08:26:26.043

这看起来像一个合适的兼容库[https://github.com/scottt/debugbreak](https://github.com/scottt/debugbreak)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-08-02T17:17:19.067

对于这个问题，这似乎是一个非常好的、可移植的解决方案： [https ://github.com/scottt/debugbreak](https://github.com/scottt/debugbreak)

引用的存储库 (debugbreak.h) 中提供的标头封装了 MSVC 的

```
 __debugbreak, 
```

和

```
 __asm__ volatile("int $0x03"); 
```

在 i386 和 x86_64 上，在 ARM 上实现

```
 __asm__ volatile(".inst 0xe7f001f0"); 
```

以及记录标题中指出的问题的一些解决方法，用于单步越过 GDB 中的断点，以及用于在*stepi*或*cont*卡住的平台上扩展 GDB 的 Python 脚本。该脚本将**debugbreak-step**和**debugbreak-continue**添加到 GDB。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T11:18:58.317

如果您认为`assert(x)`便携性足够，`assert(false)`似乎是解决您问题的明显便携解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-12T22:17:01.550

FWIW，这些解决方案都不适用于使用 NRF Connect SDK 的 nRF9160。那是一个 SEGGER Embedded Studio for ARM (Nordic Edition) 环境，使用`arm-none-eabi-gcc`编译器。

,和其他答案`debug-trap.h`中提到的都导致“未定义的操作码”和硬故障（或调试监视器故障，但结果相同），并且没有有用的程序计数器、堆栈帧或其他可调试信息。`debugbreak.h``__builtin_trap()`

最后，这个替代方案确实奏效了。我从其他一些神秘的北欧图书馆派生出来，它被称为`NRF_BREAKPOINT`：

```
#if defined(__GNUC__)
    __asm__("BKPT 0");
#else
    __BKPT(0)
#endif 
```

在构建时，它是`__GNUC__`包含在内的路径，因此`__asm__("BKPT 0")`也是必需的。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-12-26T22:33:00.343

如果您尝试调试与崩溃相关的情况，老式的 abort() 将在大多数平台上为您提供调用堆栈。缺点是您无法从当前的 PC 继续，您可能无论如何都不想这样做。

[http://www.cplusplus.com/reference/cstdlib/abort/](http://www.cplusplus.com/reference/cstdlib/abort/)

* * *

## 回答 #10

> 赞同：-6
> 
> 时间：2008-10-06T09:21:21.390

与其使用“正常”调试中断，不如使用以下方法之一，例如除以零：

```
int iCrash = 13 / 0; 
```

或取消引用 NULL 指针：

```
BYTE bCrash = *(BYTE *)(NULL); 
```

至少这在许多平台/架构上是可移植的。

在许多调试器中，您可以指定要对哪些异常执行什么操作，以便在遇到上述任何一项（如暂停执行，ala“int 3”指令）并生成异常时采取相应措施。

* * *

## 回答 #11

> 赞同：-7
> 
> 时间：2015-12-03T19:54:06.420

```
#define __debugbreak() \
do \
{       static bool b; \
        while (!b) \
                sleep(1); \
        b = false; \
} while (false) 
```

当进程处于睡眠状态时，您可以将调试器附加到进程，更改变量 b 以中断循环并执行您的操作。此代码可能无法在优化的构建中运行！

# branch - 是否可以在结帐时使 git svn “重新定位”分支文件？

> ID：173621
> 
> 赞同：1
> 
> 时间：2008-10-06T08:59:02.870
> 
> 标签：branch, git-svn

我们的 svn 存储库有很多分支，它们是子树的分支。这适用于 svn，因为我可以在我的工作副本的正确位置检查该子树。但是，如果我使用 git 检查同一个分支，我会得到一个只有分支子树的工作副本。是否可以让 git 重新定位分支，以便我的工作副本结构是相同的，无论我是在主干还是分支上？

我意识到我们的 svn 实践与 git 始终在整个树上工作的哲学相冲突。人们如何处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T21:14:41.653

如果可能，请在服务器端修复它：Subversion 在分支 ( ) 时不复制数据`svn copy`，它只是硬链接，所以真的没有明显的理由只分支出一个子树。

如果这不可行，你应该看看[http://help.github.com/subtree-merge/](http://help.github.com/subtree-merge/) - 它可能会成功，但我自己没有尝试过。他基本上是在描述 git 子模块的替代方案，您只需将远程（在本例中为您的 Subversion 分支）自动合并到子目录而不是存储库的根目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T20:57:54.653

我从来没有像这样使用过 svn，如果你得到的沉默是任何迹象，那么这是一种罕见的做法。您能否给出以这种方式做事的一些理由，也许是通过描述它解决了什么问题？这样我们就可以更好地判断什么是可接受的解决方案。

# java - 我在哪里可以找到 LWJGL 的示例用法？

> ID：173627
> 
> 赞同：4
> 
> 时间：2008-10-06T09:03:46.950
> 
> 标签：java, opengl, openal, lwjgl

我在 lwjgl.org 上看过官方演示，但我希望看到更多教程级别的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T09:28:14.780

谷歌“import org.lwjgl”可以找到很多示例，因为所有使用 LWJGL 的代码都必须包含该字符串才能导入包的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T12:01:28.983

如果它仍然重要： http: [//nehe.gamedev.net/](http://nehe.gamedev.net/)

所有教程也移植到 LWJGL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-23T18:20:39.857

[LWJGL wiki](http://lwjgl.org/wiki/index.php?title=Main_Page)包含几个带有解释的示例。由于 LWJGL 中的大多数工作都直接反映了 OpenGL（例如，'glBegin()'），因此您可以查找一些 OpenGL 教程。

# sql - 我应该在我的 MS SQL 服务器中安装什么 Oracle 驱动程序才能使用 DTS 将数据从 Oracle 服务器复制到 MS SQL 服务器？

> ID：173629
> 
> 赞同：0
> 
> 时间：2008-10-06T09:05:13.560
> 
> 标签：sql, oracle, odbc, driver, dts

我有一个**Oracle 服务器**（我相信是 9 版）和一个**MS SQL 服务器**（2000 版）。MS SQL 服务器正在运行**MS Windows Server 2003**。

**我想使用 DTS 从 Oracle 服务器中提取一些数据并将其倒入 MS SQL 服务器。**我在找出我应该在我的 MS SQL 服务器上安装什么驱动程序以使其能够与 Oracle 服务器通信时遇到问题。（我真的不在乎它是 ODBC 还是“本机”Oracle 驱动程序。）

当我不久前看到这个时，我被大量不同的 Oracle 驱动程序和版本惊呆了。**任何直接链接到推荐的确切 Oracle 驱动程序的帮助将不胜感激**，我也不介意您可以提供任何其他有用的提示。:) （除了升级服务器/操作系统，这不会很快发生......）

我知道这是我被推荐安装的即时客户端，但更具体地针对我的情况，在页面[http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/winsoft 上。 html](http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/winsoft.html)，这是我应该安装的**两个包吗？**

```
Version 11.1.0.6.0 
```

*因为是最新版本，应该可以连接Oracle 9。*

```
Instant Client Package - Basic: All files required to run OCI, OCCI, and JDBC-OCI applications 
```

*因为“所有安装都需要基本包”，根据 Oracle 网页底部的信息。*

```
Instant Client Package - ODBC: Additional libraries for enabling ODBC applications 
```

*因为我需要使用 ODBC。*

**我是否理解正确？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T12:17:55.777

我的第一选择是即时客户端：[http ://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/winsoft.html](http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/winsoft.html)

虽然这不适用于 9i，但 10g 客户端肯定会毫无问题地连接到 9i，而且 11g 可能也会。

# .net - 使用 TestDriven.Net 时如何查看 Debug.WriteLine 语句？

> ID：173641
> 
> 赞同：5
> 
> 时间：2008-10-06T09:13:25.493
> 
> 标签：.net, debugging, testdriven.net

我正在尝试使用 TestDriven.Net 不仅测试我的代码，而且在我的代码上调用一个函数，其目的是将代码的内部状态打印到调试窗口。

这是我正在尝试做的一个非常简化的示例..

```
<TestFixture()> _
Public Class UnitTest

    <Test()> _
    Public Sub TestDebug()
        Dim oClass1 As New Class1

        Assert.AreEqual(True, oClass1.IsTrue)

        Debug.WriteLine("About to call .PrintDebug()")
        oClass1.PrintToDebug()

    End Sub

End Class

Public Class Class1

    Private _IsTrue As Boolean = True

    Public ReadOnly Property IsTrue() As Boolean
        Get
            Return _IsTrue
        End Get
    End Property

    Public Sub PrintToDebug()
        Debug.WriteLine("Internal state of Class1: " & _IsTrue)
    End Sub

End Class 
```

我正在尝试测试 Class1 的公共接口，并以某种方式查看`Class1.PrintToDebug()`函数的输出。

我查看了[TestDriven.Net 快速入门](http://www.testdriven.net/quickstart.aspx)，它显示了在单元测试中使用的示例`Debug.WriteLine`，但奇怪的是这对我也不起作用——即我的“测试”窗口中的唯一输出是：

```
------ Test started: Assembly: ClassLibrary1.dll ------

1 passed, 0 failed, 0 skipped, took 1.19 seconds. 
```

我试过查看其他窗口（调试和构建），调试窗口启用了“程序输出”和“异常消息”选项。

我一直在寻找选项或偏好，但找不到任何！

谢谢你的帮助！

* * *

**编辑：**我正在使用 VB.Net 2.0、TestDriven.Net 2.14.2190 和 NUnit 2.4.8.0

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-06T09:17:14.723

我发现虽然 Debug.Writeline() 不适用于单元测试，但 Console.WriteLine() 可以。

原因是当您运行测试时，调试器进程没有被调用，并且 Debug.WriteLine() 被忽略。但是，如果您使用“使用调试器进行测试”，我认为（尚未尝试过）Debug.WriteLine() 将起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T09:36:53.450

**`Trace.WriteLine()`**似乎是答案:o)

这是我的问题示例的输出，使用`Trace`而不是`Debug`：

```
------ Test started: Assembly: ClassLibrary1.dll ------

Internal state of Class1: True

1 passed, 0 failed, 0 skipped, took 0.61 seconds. 
```

但是我发现了一件事..在第一个失败的单元测试断言处停止执行，这意味着如果上面`Trace`的语句失败，则不会执行语句。`Assert()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-03T12:57:30.103

尝试改用 Trace.WriteLine(...) 。只有在定义 DEBUG 时才会调用 Debug.WriteLine(...)。默认情况下，新的 Visual Studio 项目不再定义 DEBUG，但它们确实定义了 TRACE。

我真的应该将快速入门示例更改为使用 Trace。

问候，杰米。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T10:30:40.500

您可能想知道 2.16（当前的 beta 版本）包括：

> 1587：始终显示控制台输出/错误和测试运行器消息
> 
> 现在，在项目/解决方案中运行所有测试时，将显示测试运行程序生成的消息和控制台输出。
> 
> 1588：在项目/解决方案中运行所有测试时，可选择显示跟踪/调试输出
> 
> 默认情况下，在项目/解决方案中执行所有测试时，不会显示跟踪/调试输出。可以通过 TesDriven.Net 选项窗格修改此行为。

所以它似乎将在下一个版本中工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T09:45:19.847

IIRC，此输出仅在运行单个测试时显示在输出窗口中。尝试右键单击测试方法以运行该测试...？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T11:34:15.507

“运行测试...”选择您当前构建解决方案/项目所需的任何设置。

您必须确保将解决方案/项目的当前构建设置设置为“调试”而不是“发布”（否则编译器[有条件地删除 Debug.Write*() 调用）。](http://msdn.microsoft.com/en-us/library/aa664622(VS.71).aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-29T18:47:48.187

CTRL + ALT + I 显示即时窗口

# svn - 如何获取自某个日期以来已添加到 SVN 的文件列表？

> ID：173642
> 
> 赞同：2
> 
> 时间：2008-10-06T09:13:49.970
> 
> 标签：svn

我只想要自某个日期以来已添加的文件（不是已修改的文件）的列表。是否有捷径可寻？

**回答**：这就是我最终为我工作的东西，谢谢大家！

> svn log -v -r{2008-10-1}:HEAD svn://path.to.repo/ | grep "^ A" | grep ".java" | 排序 -u

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T09:23:57.563

```
svn log -v -r{2008-10-1}:HEAD | grep "^   A" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T12:32:06.780

如果你使用 'svn log -v -q' 你会得到文件名并且没有日志信息。这比 http:// 和 svn:// 快一点，因为日志消息不会传输给您。

svn log --xml -v -q 为您提供相同的信息，但易于解析 xml。（这将为您处理奇怪文件名的所有极端情况）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T09:24:46.143

就像是

`svn log -v -r {"2008-01-01"}:HEAD . | grep ' A ' | sort -u`

应该让你去...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-10T05:01:14.067

您可以尝试以下命令，

```
svn log -r '{2013-09-09}:HEAD' 
```

在这里，您可以获得自 2013 年 9 月 9 日以来的所有修订详细信息

# version-control - 视频编辑工作的版本控制

> ID：173643
> 
> 赞同：10
> 
> 时间：2008-10-06T09:14:03.060
> 
> 标签：version-control, video, image

我正在研究改进一组动画师使用的备份过程。目前，他们手动将工作备份到外部硬盘驱动器或 DVD 中，对所有内容进行完整复制。数据由数千张高分辨率图像、各种视频编辑软件的项目文件和声音文件组成。基本上所有内容都是二进制数据，在签入时不应合并任何内容。

我应该调查我将作为软件开发人员使用的版本控制系统（Subversion、GIT 等），还是有一类用于非软件数据的版本控制系统更适合这些需求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T12:42:49.770

您还可以查看[AlienBrain](http://www.softimage.com/products/alienbrain/ "外星人大脑")。它是专为艺术家设计的项目资产管理系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T11:10:25.383

如果您的范围只是“备份”，那么我会说坚持备份解决方案。

但是，如果您正在考虑动画师作品的整个生命周期，那么由于您提到的原因，使用类型通常属于[“数字资产管理”类别：庞大的数据量；](http://en.wikipedia.org/wiki/Digital_asset_management)二进制格式。

由于[版本控制](http://en.wikipedia.org/wiki/Software_configuration_management)(SCM) 软件通常是为可以区分和合并的文本文件设计的，因此它们往往不能很好地处理大容量的二进制格式。虽然您的平均网络图形不会成为（软件）版本控制工具的问题，但您提到了视频，这让您进入了另一个联盟。

坏消息（也许 - 取决于您的业务）是 DAM 由城镇的大端主导。@Atmospherian 提到[了 AlienBrain](http://www.softimage.com/products/alienbrain/)，它是为艺术家提供利基产品的一个很好的代表。另一方面，您拥有更多通用产品，例如[Oracle 的 UCM](http://www.oracle.com/products/middleware/content-management/digital-asset-management.html)（以前称为 Stellent）。确保你检查价格标签。

必须有可用的开源或低成本替代品——但我不知道，抱歉。

似乎很常见的是定制的内部解决方案。与管理代码不同，文件本身的更改具有其自身的意义，管理数字资产往往侧重于元数据（图像/视频只是一个关联的 blob）。而且由于许多商店都有自己特定的制作工作流程，这使得一些臭鼬工厂编程的领域变得成熟（如果这是你的意愿 - 去吧！）。

因此，虽然我不推荐任何特定产品，但我建议如果您在寻找解决方案时考虑“数字资产管理”而不是“版本控制”，您可能会找到更适合您需求的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T12:51:14.993

您的问题有点不清楚-您似乎将版本控制和备份混为一谈。

如果您想要的是版本控制，请查看维基百科上的列表：[版本控制软件的比较](http://en.wikipedia.org/wiki/Comparison_of_revision_control_software)。这显示了大多数广为人知的版本控制系统及其基本功能。您正在寻找可以设置它以强制用户在编辑之前结帐的东西。请注意，商业解决方案的价格范围从中等昂贵到“您想要多少？”

如果您想要的是备份软件，那么我将从维基百科[中的备份软件列表开始。](http://en.wikipedia.org/wiki/List_of_backup_software)备份软件领域有很多选择，而且价格点也很多。

无论哪种方式，都要考虑创建一个管理职位（如果你足够大，可以作为某人工作的一部分或完全是一个新人）。我使用过没有管理员的备份和版本控制系统，这是一个问题。要么没有人解决问题，要么每个人都把手伸进去，真的把事情搞砸了。无论哪种方式，使其成为某人工作的一部分（正式）是限制损害的最佳方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T09:59:54.417

我认为 Clearcase 会为你工作。原因是一切都是 VOB(VersionedObject)，不管它是什么！检查一次

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T12:36:50.700

根据您的描述，听起来您可以使用一些基本的备份软件（例如[Retrospect](http://www.emcinsignia.com/products/) ）做得很好。使用工作站的每日备份，只会备份更改的数据，如果需要，可以轻松回滚到文件的早期版本。

您无法从这样的设置中获得签出/签入文件并获得有关冲突的警告的能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T16:38:28.173

Vidyatel 有一个编辑软件，它可以编辑视频内容并找出视频版本之间的差异。结果在 - EDL/TC 中。

它可能会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-02T22:59:27.020

你应该看看[野猪](http://code.google.com/p/boar/)。这正是您想要的，“照片、视频和其他二进制文件的版本控制和备份”。它是为大型二进制文件设计的版本控制。

# java - 我可以定义 Eclipse 清理规则的例外吗？

> ID：173646
> 
> 赞同：10
> 
> 时间：2008-10-06T09:15:30.390
> 
> 标签：java, eclipse

大多数情况下，Eclipse 中的清理规则（Preferences > Java > Code Style > Clean Up）可以完美运行并创建漂亮的代码。

但有时，特别是对于注释和串联的字符串片段（如内联 SQL 查询），清理只会把事情搞砸，并破坏我的格式。

有没有办法对 Eclipse 说*“不要碰这块文本！我已经按照我喜欢的方式对其进行了格式化，而你会让它变得不那么可读”*？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-08-17T16:35:20.680

我假设您的意思并不是真正的“清理”，而是隐藏在其中的“格式化源代码”选项。它在 Preferences > Java > Code Style > Formatter 中配置。而且，确实有一个名为“开/关标签”的选项。可悲的是，默认情况下它是关闭的。你现在可以这样写：

```
// @formatter:off
StringBuilder sql = new StringBuilder()
    .append("SELECT whatever \n")
    .append("FROM some_table");
// @formatter:on 
```

在撰写本文时，接受的答案很可能是正确的，但是，如果我没记错的话，这是在 Eclipse 3.5 中引入的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T16:57:57.087

我遇到了同样的问题，虽然我没有解决方案，但我可以告诉你我是如何解决这个问题的。

由于格式化的工作原理，我故意避免使用过长的代码行。一般来说，当我保持简短的行时，它会更好地决定如何格式化代码。这甚至可以用于 SQL 语句，例如：

```
public static final String SELECT_SOMETHING = "SELECT"
        + "OBJECTID, THIS, THAT, THEOTHER, THING"
        + " FROM DBNAME.DBSCHEMA.TABLE_T"
        + " WHERE ID = ?"; 
```

该语句的格式合理，因为在可能的情况下将项目分开并连接在一起。当我不这样做时，我会得到不可预测的结果：

```
public static final String SELECT_SOMETHING = "SELECT OBJECTID, SOMETHING FROM DBNAME.DBSCHEMA.TABLE_T WHERE ID = ?"; 
```

对于注释，我尽可能将它们全部放在一行上，并在它进行格式化时允许它自动换行。

此外，可以使用代码格式化程序更改样式，以使事情更适合您的编码样式。您可能希望团队中的每个人都使用相同的格式，以避免冲突。因为使用您的源代码控制工具与其他开发人员或以前的版本比较更改更容易，即使它使您的部分代码可读性降低，使用格式化程序仍然是我的优势。

不过，当格式化程序做出错误决定时，我理解您的沮丧！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T17:41:36.560

对回答我自己的问题感到不确定，但我目前有一个解决方法（*注意：我有这些清理规则作为保存操作*）：

保存（使用 Ctrl/Cmd-S，不知道保存方式是否重要）代码，然后让 Eclipse 弄乱您的格式。然后只需按 Ctrl/Cmd-Z 即可撤消，并立即重新保存。格式恢复为原始格式，并且似乎按预期保存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-28T21:00:22.453

对于代码中的 SQL 语句，您可以在每行的末尾放置一个单行注释字符。然后格式化程序无法重新格式化它。它比不必这样做更难看，但比 Eclipse 格式化它更漂亮。

```
StringBuffer sql = new StringBuffer() //
   .append("SELECT whatever \n") //
   .append("FROM some_table"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T11:45:14.067

不。（据我所知，我也遇到过同样的问题，并且看起来很努力很长时间......）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T20:14:06.003

（仅适用于 Javadoc 注释）

如果我有一段文本的格式符合我的喜好，我会用 <pre></pre> 标记将它们括起来。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T13:33:26.470

如果您不希望某个字段成为最终字段（ii：因为您想在调试时更改它），您只需在构造函数中将其分配给自身。这将收到日食警告，但您的领域将保持非最终状态。

# wpf - 如何在我的 WPF 应用程序中为页面制作模式对话框？

> ID：173652
> 
> 赞同：26
> 
> 时间：2008-10-06T09:17:42.303
> 
> 标签：wpf, modal-dialog

我有一个 WPF 窗口，其中有一个包含一个框架的控件。在那个框架中，我显示不同的页面。有没有办法让对话框模式只显示一个页面？当我显示对话框时，应该无法单击页面上的任何控件，但应该可以单击不在页面上的同一窗口上的控件。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-06T10:05:15.563

如果我对您的信息的解释是正确的，那么您需要的东西类似于 [比利霍利斯在他的 StaffLynx 应用程序中演示的东西](http://www.dnrtv.com/default.aspx?showNum=115)。

我最近构建了一个类似的控件，结果证明这种想法在 WPF 中实现起来相对简单。我创建了一个名为 DialogPresenter 的自定义控件。在自定义控件的控件模板中，我添加了类似于以下内容的标记：

```
<ControlTemplate TargetType="{x:Type local=DialogPresenter}">
  <Grid>
    <ContentControl>
      <ContentPresenter />
    </ContentControl>
    <!-- The Rectangle is what simulates the modality -->
    <Rectangle x:Name="Overlay" Visibility="Collapsed" Opacity="0.4" Fill="LightGrey" />
    <Grid x:Name="Dialog" Visibility="Collapsed">
      <!-- The template for the dialog goes here (borders and such...) -->
      <ContentPresenter x:Name="PART_DialogView" />
    </Grid>
  </Grid>
  <ControlTemplate.Triggers>
    <!-- Triggers to change the visibility of the PART_DialogView and Overlay -->
  </ControlTemplate.Triggers>
</ControlTemplate> 
```

我还添加了一个`Show(Control view)`方法，它找到“PART_DialogView”，并将传入的视图添加到`Content`属性中。

然后，这允许我使用`DialogPresenter`如下：

```
<controls:DialogPresenter x:Name="DialogPresenter">
  <!-- Normal parent view content here -->
  <TextBlock>Hello World</TextBlock>
  <Button>Click Me!</Button>
</controls:DialogPresenter> 
```

对于按钮事件处理程序（或绑定命令），我只需调用`DialogPresenter`.

您还可以轻松地将 ScaleTransform 标记添加到 DialogPresenter 模板，以获得视频中显示的缩放效果。该解决方案具有整洁的自定义控件代码，以及为您的 UI 编程团队提供的非常简单的界面。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-30T20:29:32.217

我在[github](https://github.com/BenjaminGale/ModalContentPresenter)上有一个项目，它是一个自定义项目`FrameworkElement`，允许您在主要内容上显示模态内容。

该控件可以这样使用：

```
<c:ModalContentPresenter IsModal="{Binding DialogIsVisible}">
    <TabControl Margin="5">
            <Button Margin="55"
                    Padding="10"
                    Command="{Binding ShowModalContentCommand}">
                This is the primary Content
            </Button>
        </TabItem>
    </TabControl>

    <c:ModalContentPresenter.ModalContent>
        <Button Margin="75"
                Padding="50"
                Command="{Binding HideModalContentCommand}">
            This is the modal content
        </Button>
    </c:ModalContentPresenter.ModalContent>

</c:ModalContentPresenter> 
```

特征：

*   显示任意内容。
*   在显示模式内容时不禁用主要内容。
*   在显示模式内容时禁用鼠标和键盘访问主要内容。
*   仅对它所覆盖的内容是模态的，而不是整个应用程序。
*   可以通过绑定到`IsModal`属性以对 MVVM 友好的方式使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-12T10:43:19.520

为什么不使用嵌套消息泵来创建模态控件

[http://deanchalk.com/wpf-modal-controls-via-dispatcherframe-nested-message-pumps/](http://deanchalk.com/wpf-modal-controls-via-dispatcherframe-nested-message-pumps/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T09:42:43.330

您不是在这里寻找模态对话框。您需要一个功能来禁用“页面”控件，显示一个对话框，并在对话框关闭时重新启用它。

我不太确定您是否理解模态对话框的含义？

# windows - 如何在外部启动的应用程序中禁用右键菜单

> ID：173663
> 
> 赞同：0
> 
> 时间：2008-10-06T09:22:24.027
> 
> 标签：windows, mouse, external, right-click

**再会。**

我有一个启动外部应用程序的程序。该外部应用程序上有一个右键单击子菜单，我需要禁用它。是否可以（不修改外部应用程序）禁用右键单击？也许权限或组策略等。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T09:54:13.417

我不确定我是否想发帖，因为我在这件事上没有很大的范围，但这绝对是可能的。如果你有一个应用程序的句柄（如果没有，你可以得到一个），你可以使用它来禁用应用程序中的右键单击。

[http://www.codeguru.com/forum/showthread.php?t=190440](http://www.codeguru.com/forum/showthread.php?t=190440)

[http://support.microsoft.com/kb/318804](http://support.microsoft.com/kb/318804)

似乎是最有用的链接，它只是关于你应该如何挂钩然后忽略`WM_RBUTTONDOWN`和`WM_RBUTTONUP`.

稍后我会尝试用一个例子写出更好的东西。

更多链接/编辑

此链接可能很有用，因为它解释了您将需要使用非托管 c/c++ 来使用 setWindowsHookEx 进行挂钩。

[http://social.msdn.microsoft.com/Forums/en-US/clr/thread/8dd657b5-647b-443b-822d-ebe03ca4033c/](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/8dd657b5-647b-443b-822d-ebe03ca4033c/)

希望这可以帮助

[编辑]

我认为这实际上可以完全在 C# 应用程序中完成。今晚我会发布解决方案

[/编辑]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T09:50:30.990

这是一个 win32 api 常见问题解答。

见 news://194.177.96.26/comp.os.ms-windows.programmer.win32 经常讨论的地方

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T10:04:02.287

我知道 Windows 的残酷解决方案。钩住鼠标并过滤所有消息，转到外部程序窗口。虽然它可以减慢整个系统的速度。

没那么复杂。这是一个教程：[http:](http://win32assembly.online.fr/tut24.html) //win32assembly.online.fr/tut24.html 别介意汇编程序，它在任何语言中的工作方式都是一样的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-01T11:31:44.543

```
 <script type="text/javascript">
    $(function () {
        $(document).bind("contextmenu", function (e) {
            e.preventDefault();
        });
    });

</script> 
```

在脚本中使用此代码禁用右键单击

# .net - 为什么 .NET 中没有 RAII？

> ID：173670
> 
> 赞同：66
> 
> 时间：2008-10-06T09:25:16.500
> 
> 标签：.net, struct, destructor, raii, value-type

作为一名 C++ 开发人员，Java 和 .NET 中缺少[RAII（资源获取即初始化）](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)一直困扰着我。清理的责任从类编写者转移到其消费者（通过`try finally`.NET 的[`using`构造](http://blogs.msdn.com/cyrusn/archive/2005/05/10/415956.aspx)）这一事实似乎明显逊色。

我明白为什么在 Java 中不支持 RAII，因为所有对象都位于堆上，而垃圾收集器本身不支持确定性销毁，但在 .NET 中引入了值类型（`struct`）我们有（似乎） RAII 的完美候选人。在堆栈上创建的值类型具有明确定义的范围，并且可以使用 C++ 析构函数语义。但是，CLR 不允许值类型具有析构函数。

我的随机搜索发现了一个论点，即如果一个值类型被[装箱](http://www.csharphelp.com/archives/archive100.html)，它就属于垃圾收集器的管辖范围，因此它的销毁变得不确定。我觉得这个论点不够有力，RAII 的好处大到足以说明带有析构函数的值类型不能被装箱（或用作类成员）。

**长话短说，我的问题是**：是否有任何其他原因不能使用值类型来将 RAII 引入 .NET？（或者你认为我关于 RAII 明显优势的论点有缺陷吗？）

**编辑：**我一定没有清楚地表达这个问题，因为前四个答案没有抓住重点。我*知道*它的非确定性`Finalize`特征，我知道`using`构造，我觉得这两个选项不如 RAII。`using`类的消费者还必须记住一件事（有多少人忘记将 a`StreamReader`放在一个`using`块中？）。我的问题是关于语言设计的哲学问题，为什么它是这样的，可以改进吗？

例如，使用通用的确定性可破坏值类型，我可以使`using`and`lock`关键字变得多余（可通过库类实现）：

```
 public struct Disposer<T> where T : IDisposable
    {
        T val;
        public Disposer(T t) { val = t; }
        public T Value { get { return val; } }
        ~Disposer()  // Currently illegal 
        {
            if (val != default(T))
                val.Dispose();
        }
    } 
```

* * *

我不禁以我曾经看过但目前无法找到其来源的恰当报价作为结尾。

> 当我冰冷的死手超出范围时，您可以承担我的确定性破坏。——*匿名*

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-06T10:48:14.743

更好的标题是“为什么 C#/VB 中没有 RAII”。C++/CLI（托管 C++ 的流产演变）具有与 C++ 完全相同的意义上的 RAII。这只是其他 CLI 语言使用的相同终结模式的语法糖（C++/CLI 的托管对象中的析构函数实际上是终结器），但它就在那里。

您可能会喜欢[http://blogs.msdn.com/hsutter/archive/2004/07/31/203137.aspx](http://blogs.msdn.com/hsutter/archive/2004/07/31/203137.aspx)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T09:44:41.827

很好的问题，一个让我非常困扰的问题。似乎人们对 RAII 的好处的看法截然不同。根据我使用 .NET 的经验，缺乏确定性（或至少是可靠的）资源收集是主要缺点之一。事实上，.NET 已经多次迫使我使用整个架构来处理*可能*（但可能不需要）需要显式收集的非托管资源。当然，这是一个巨大的缺点，因为它使整体架构更加困难，并将客户的注意力从更中心的方面转移开。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-06T09:57:40.820

布赖恩·哈里 (Brian Harry) 有一篇关于[这里](http://blogs.msdn.com/brada/articles/371015.aspx)的基本原理的不错的帖子。

这是一段摘录：

> ## 确定性终结和值类型（结构）呢？
> 
> -------------- 我已经看到很多关于具有析构函数的结构等问题。这是值得评论的。为什么某些语言没有它们有很多问题。
> 
> (1) 组合 - 在一般情况下，由于上述相同的组合原因，它们不会为您提供确定的生命周期。任何包含一个的非确定性类都不会调用析构函数，直到它被 GC 最终确定。
> 
> (2) 复制构造函数——一个真正好的地方是在堆栈分配的局部变量中。他们将被限制在方法范围内，一切都会很好。不幸的是，为了让它真正起作用，您还必须添加复制构造函数并在每次复制实例时调用它们。这是关于 C++ 的最丑陋和最复杂的事情之一。您最终会在您不期望的地方执行所有代码。它会导致一堆语言问题。一些语言设计者选择远离这一点。
> 
> 假设我们创建了带有析构函数的结构，但添加了一系列限制以使它们的行为在面对上述问题时变得合理。限制将类似于：
> 
> (1) 只能将它们声明为局部变量。
> 
> (2) 你只能通过引用传递它们
> 
> （3）您不能分配它们，您只能访问字段并在它们上调用方法。
> 
> (4) 你不能把它们装箱。
> 
> (5) 通过反射（后期绑定）使用它们的问题，因为这通常涉及拳击。
> 
> 也许更多，但这是一个好的开始。
> 
> 这些东西有什么用？你真的会创建一个只能用作局部变量的文件或数据库连接类吗？我不相信有人真的会。相反，您要做的是创建一个通用连接，然后创建一个自动销毁的包装器以用作作用域局部变量。然后，调用者将选择他们想要使用的内容。请注意，调用者做出了决定，并且它并未完全封装在对象本身中。鉴于您可以使用类似于在几个部分中提出的建议之类的东西。

.NET 中 RAII 的替代品是 using-pattern，一旦您习惯了它，它几乎同样有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T09:27:57.073

您最接近的是非常有限的 stackalloc 运算符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T09:32:45.970

如果您搜索它们，则有一些类似的线程，但基本上归结为，如果您想在 .NET 上实现 RAII，只需实现 IDisposable 类型并使用“using”语句来获得确定性 Disposal。这样，许多相同的理念就可以以稍微冗长的方式实现和使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-14T04:16:09.583

恕我直言，VB.net 和 C# 需要的主要内容是：

1.  字段的“使用”声明，这将导致编译器生成代码以处理所有标记的字段。编译器的默认行为应该是让一个类实现 IDisposable（如果它没有实现），或者在许多常见 IDisposal 实现模式中的任何一个的主处置例程开始之前插入处置逻辑，或者使用属性来指定处置的东西应该以特定名称进入例程。
2.  一种通过默认行为（调用默认处置方法）或自定义行为（调用具有特定名称的方法）来确定性地处置其构造函数和/或字段初始值设定项引发异常的对象的方法。
3.  对于 vb.net，一种自动生成的方法来清空所有 WithEvent 字段。

所有这些都可以在 vb.net 中很好地组合在一起，而在 C# 中则不太好，但是对它们的一流支持会改进这两种语言。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-10-06T09:31:45.537

您可以使用 finalize() 方法在 .net 和 java 中执行某种形式的 RAII。在 GC 清理类之前调用​​ finalize() 重载，因此可用于清理绝对不应由类保留的任何资源（互斥锁、套接字、文件句柄等）。但它仍然不是确定性的。

使用 .NET，您可以使用 IDisposable 接口和 using 关键字确定性地执行其中一些操作，但这确实有限制（在确定性行为需要使用时使用构造，仍然没有确定性内存释放，不会在类中自动使用等）。

是的，我觉得 RAII 的想法可以引入 .NET 和其他托管语言，尽管确切的机制可能会无休止地争论。我能看到的唯一另一种选择是引入一个可以处理任意资源清理（不仅仅是内存）的 GC，但是当绝对必须确定性地释放所述资源时，你就会遇到问题。

# c++ - 函数内的字符串文字：自动变量还是在堆中分配？

> ID：173681
> 
> 赞同：3
> 
> 时间：2008-10-06T09:29:41.360
> 
> 标签：c++, c, memory, memory-management, memory-leaks

我们在函数内部使用的字符串文字是自动变量吗？或者它们是否分配在我们必须手动释放的堆中？

我的情况类似于下面显示的代码，其中我将字符串文字分配给类的私有字段（在代码中标记为 ONE）并稍后在我的程序中检索它并使用它（标记为 TWO）。我是否将堆栈中的变量分配给 ONE 中的字段？代码是否可以引用一个悬空指针，在这种情况下它可以工作，因为程序足够小？

我已经编译并运行了它，它运行良好，但是在我的实际程序中出现了奇怪的崩溃，我将字符串文字分配给这样的类的字段，我怀疑我上面提到的情况。

```
#include <iostream>

using namespace std;

class MemoryLeak
{
private:
    char *s;
public:
    MemoryLeak() {}

    void store()
    {
        s = "Storing a string"; // ONE
    }

    char *retrieve()
    {
        return s;
    }
};

int main()
{
    MemoryLeak *obj = new MemoryLeak();
    obj->store();
    cout << obj->retrieve() << endl; // TWO
    delete obj;
    return 0;
} 
```

我应该将变量“s”声明为 char 数组而不是指针吗？我打算使用std :: string，但我只是对此感到好奇。

一如既往，非常感谢任何指针或帮助:) 谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T09:31:29.937

字符串文字将由编译器放置在二进制文件的初始化数据或文本（代码）段中，而不是驻留在（运行时分配的）内存或堆栈中。因此，您应该使用指针，因为您将引用编译器已经为您生成的字符串文字。请注意，修改它（通常需要更改内存保护）将更改此文字的所有用途。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-06T09:49:58.167

修改字符串文字是未定义的行为，并且很可能是程序崩溃的原因（ISO C++：2.13.4/2）。该标准允许从字符串文字转换`char*`为向后兼容 C，并且只有在绝对需要时才应该在代码中进行这种转换。

如果您希望将字符串文字视为常量，则可以将成员的类型更改为`const char *`.

如果您的设计需要`s`可以修改，那么我建议将其类型更改为`std::string`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T10:30:07.383

谢谢科迪和理查德。

我找到了错误的原因。这是因为我正在对已经删除的对象进行删除。我在做：

```
if (obj != NULL) delete obj; 
```

我将其更改为：

```
if (obj != NULL)
{
    delete obj;
    obj = NULL;
} 
```

学习 C++ 绝对很有趣 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T09:48:23.177

也许崩溃的原因是你没有 0 终止字符串？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T16:20:25.023

让我们看看你的选择。
您还应该做几件事：

```
 /*
     * Should initialize s to NULL or a valid string in constructor */
        MemoryLeak()
        {
            store();
        }

        void store()
        {
            // This does not need to be freed because it is a string literal
            // generated by the compiler.
            s = "Storing a string"; // ONE

            // Note this is allowed for backward compatibility but the string is
            // really stored as a const char* and thus unmodifiable. If somebody
            // retrieves this C-String and tries to change any of the contents the
            // code could potentially crash as this is UNDEFINED Behavior.

            // The following does need to be free'd.
            // But given the type of s is char* this is more correct.
            s = strdup("Storing a string");

            // This makes a copy of the string on the heap.
            // Because you allocated the memory it is modifiable by anybody
            // retrieving it but you also need to explicitly de-allocate it
            // with free()
        } 
```

你正在做的是使用 C-Strings。这些不应与 C++ std::string 混淆。C++ std::string 自动初始化为空字符串。任何分配的内存都被正确地取消分配。它可以很容易地作为可修改和不可修改的版本返回。它也很容易操纵（**即**增长收缩变化）。如果你增加了一个 C 字符串，你需要重新分配内存并将字符串复制到新的内存等（这非常耗时，容易出错）。

为了应对动态分配您的对象，我将了解智能指针。
有关智能指针的更多详细信息，请参阅本文。
[智能指针或谁拥有你 宝贝](https://stackoverflow.com/questions/94227/smart-pointers-or-who-owns-you-baby)

```
std::auto_ptr<MemoryLeak> obj(new MemoryLeak());

obj->store();
std::cout << obj->retrieve() << std::endl; // TWO

// No need to delete When object goes out of scope it auto deletes the memory. 
```

# python - 是否可以将参数传递给事件绑定？

> ID：173687
> 
> 赞同：33
> 
> 时间：2008-10-06T09:31:40.980
> 
> 标签：python, events, wxpython

我还没有在其他地方找到答案，而且似乎还没有在 SO 上问过这个问题。

在 wxPython 中创建事件绑定时，是否可以向事件传递额外的参数？例如，这是正常的方式：

```
b = wx.Button(self, 10, "Default Button", (20, 20))
        self.Bind(wx.EVT_BUTTON, self.OnClick, b)
def OnClick(self, event):
        self.log.write("Click! (%d)\n" % event.GetId()) 
```

但是是否可以将另一个参数传递给该方法？这样该方法可以判断是否有多个小部件正在调用它但仍返回相同的值？

它将大大减少复制和粘贴相同代码但调用者不同的情况。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-06T09:38:08.597

您始终可以使用 lambda 或其他函数来包装您的方法并传递另一个参数，而不是特定于 WX。

```
b = wx.Button(self, 10, "Default Button", (20, 20))
        self.Bind(wx.EVT_BUTTON, lambda event: self.OnClick(event, 'somevalue'), b)
def OnClick(self, event, somearg):
        self.log.write("Click! (%d)\n" % event.GetId()) 
```

如果您想减少要键入的代码量，您还可以尝试一些自动操作，例如：

```
class foo(whateverwxobject):
    def better_bind(self, type, instance, handler, *args, **kwargs):
        self.Bind(type, lambda event: handler(event, *args, **kwargs), instance)

    def __init__(self):
        self.better_bind(wx.EVT_BUTTON, b, self.OnClick, 'somevalue') 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T10:33:33.383

最好的方法是制作事件处理程序的生成器，例如：

```
def getOnClick(self, additionalArgument):
    def OnClick(event):
        self.log.write("Click! (%d), arg: %s\n" 
                         % (event.GetId(), additionalArgument))
    return OnClick 
```

现在你绑定它：

```
b = wx.Button(self, 10, "Default Button", (20, 20))
b.Bind(wx.EVT_BUTTON, self.getOnClick('my additional data')) 
```

# visual-studio - 我可以更改 Visual Studio 文本编辑器的光标吗？

> ID：173695
> 
> 赞同：9
> 
> 时间：2008-10-06T09:38:52.837
> 
> 标签：visual-studio

Visual Studio 2005 编辑器中的小文本输入光标让我抓狂。理想情况下，我希望能够突出显示（例如黄色）我当前所在的整条线，但我会满足于让光标更大和/或不同的颜色。任何帮助都感激不尽！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T09:45:08.130

[CodeKana](http://www.codekana.com/)允许您在其他不错的功能中突出显示当前行。AFAIK Visual Studio 没有对突出显示或以其他方式使当前行明显的内置支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-28T01:45:25.183

在控制面板、个性化、选择鼠标指针下，为文本选择光标尝试不同的配色方案/指针，“Windows Inverted（系统方案）”似乎对我来说效果很好。

我在这里找到了这个解决方案：http: [//social.msdn.microsoft.com/forums/en-US/vssetup/thread/3b131a04-9a51-42c9-b69e-73e6e70c15a7](http://social.msdn.microsoft.com/forums/en-US/vssetup/thread/3b131a04-9a51-42c9-b69e-73e6e70c15a7)

# vb.net - 如何为纵向和横向显示格式进行开发？

> ID：173703
> 
> 赞同：0
> 
> 时间：2008-10-06T09:42:53.080
> 
> 标签：vb.net, windows-xp, landscape, portrait

我目前正在为运行 Windows XP Professional（不是 Tablet PC 版）的手持设备进行开发。该设备允许用户从标准的宽屏横向显示格式切换到纵向显示格式。我想知道是否有任何 VB.NET 代码片段可以帮助我完成这项任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T23:01:58.800

确定当前方向的方法是使用 `System.Windows.Forms.SystemInformation.ScreenOrientation`属性。

要获取屏幕的实际大小，请检查`System.Windows.Forms.Screen.PrimaryScreen.WorkingArea.Height`(和`.Width`)

您可以声明一个事件处理程序（使用`AddHandler`语句）`Microsoft.Win32.SystemEvents.DisplaySettingsChanged`作为您的应用程序可以响应的触发器，然后检查屏幕方向以查看是否需要调整 GUI 布局。

# xml - 如何使用 vbscript 删除 XML 文件中的特定节点

> ID：173706
> 
> 赞同：0
> 
> 时间：2008-10-06T09:44:57.583
> 
> 标签：xml, xpath, vbscript

我遇到的问题是我无法选择需要删除的特定 XML 节点。我已经尝试使用适用于某些 XML 文件的 XPath 来选择节点，但我无法为更复杂的文件中的节点找出正确的 XPath。

有谁知道可以加载 XML 文件的免费软件工具，以便用户可以选择特定节点并接收准确的 XPath，而无需在路径中进行枚举？

`/root/anything[2]`<-- 不幸的是，我不能使用这样的语句，因为元素的数量可能会改变。我需要一个基于属性的表达式。

如果没有用于此操作的免费软件工具，是否有人知道另一种方式我可以如何选择所需的节点？

**XML 示例：**

**根节点：** SmsFormData

**属性：** xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" FormatVersion="1.0" xmlns=" http://schemas.microsoft.com/SystemsManagementServer/2005/03/ConsoleFramework"

**子节点：**表格

**属性：** Id="some GUID" CustomData="Some data" FormType="some type" ForceRefresh="false"

**子/子节点：**页面

**子/子/子节点：**页面

**属性：** VendorId="VendorName" Id="some GUID" Assembly="dll 文件名" Namespace="some Namespace" Type="some Type" HelpID="">

我选择这个特定页面的 xPath 表达式现在是：

**xPath =** `/SmsFormData/Form/Pages/Page[@Id="some Guid"]`

要进行选择，我使用以下 vbscript 代码：

```
Set objDOM = CreateObject("Msxml2.DOMDocument.4.0") 
objDOM.async = false            
objDOM.load(file)       
set objNode = objDOM.selectSingleNode(xPath) 
```

现在的问题是`objNode`对象是空的。节点没有被选中，但是为什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T11:17:34.993

这是默认命名空间问题。加载 XML 后尝试包含以下代码：

```
objDom.SetProperty "SelectionNamespaces", "xmlns:cf=""http://schemas.microsoft.com/SystemsManagementServer/2005/03/ConsoleFramework""" 
```

`cf`然后在 XPath 中使用此前缀，例如：

```
objDom.SelectSingleNode("/cf:SmsFormData/cf:Form/cf:Pages/cf:Page[@Id='Some Guid']") 
```

虽然这可能看起来有点古怪，但这是故意的行为。查看[http://support.microsoft.com/kb/288147](http://support.microsoft.com/kb/288147)了解更多信息，您可能会发现[http://msdn.microsoft.com/en-us/library/ms950779.aspx](http://msdn.microsoft.com/en-us/library/ms950779.aspx)也很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T09:59:35.307

给定以下 XML：

```
<root>
  <anything foo="bar">value1</anything>
  <anything foo="qux">value2</anything>
</root> 
```

...您可以使用 XPath 表达式获取第二个任何节点的值：

```
/root/anything[@foo="qux"] 
```

（因此，您使用 @property="value" 作为选择器，而不是编号索引）。

至于自动生成这样的查询的工具，恰当命名的[Visual XPath](http://weblogs.asp.net/nleghari/articles/visualxpath.aspx)应该可以解决问题，而且它是免费的（它甚至带有 C# 源代码）。

编辑，在海报跟进之后：这种形式的 XPath 选择对于“简单案例”和最复杂的文档一样适用。当然，您*必须*确保您的 XPath 表达式是正确的，尽管 Visual XPath 确实会使用数字索引，但它至少为您提供了表达式的其余部分，您可以轻松地将 @property="value" 选择器替换为数，并测试结果。

给定上面的示例 XML，这个 VBscript：

```
objDOM.selectSingleNode("/root/anything[@foo=""qux""]/text()").nodeValue 
```

...返回字符串“value2”：根据您的需要，您可能需要稍微调整一下（同样，Visual XPath 之类的工具或任何好的[XPath 参考](http://www.w3schools.com/Xpath/xpath_functions.asp)都可以帮助您）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T10:27:58.137

感谢您的快速回复！这肯定适用于简单的情况，但这不适用于我的具体情况:(

因此，让我们进入细节：

**根节点：** SmsFormData

**属性：** xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" FormatVersion="1.0" xmlns=" http://schemas.microsoft.com/SystemsManagementServer/2005/03/ConsoleFramework"

**子节点：**表格

**属性：** Id="some GUID" CustomData="Some data" FormType="some type" ForceRefresh="false"

**子/子节点：** 页面

**子/子/子节点：**页面

**属性：** VendorId="VendorName" Id="some GUID" Assembly="dll 文件名" Namespace="some Namespace" Type="some Type" HelpID="">

我选择这个特定页面的 xPath 表达式现在是：

**xPath =** "/SmsFormData/Form/Pages/Page[@Id="some Guid"]"

要进行选择，我使用以下 vbscript 代码：

```
Set objDOM = CreateObject("Msxml2.DOMDocument.4.0") 

objDOM.async = false        
objDOM.load(file)       

set objNode = objDOM.selectSingleNode(xPath) 
```

现在的问题是 objNode 对象是空的。节点没有被选中，但是为什么呢？

哦，顺便说一句：感谢 Visual XPath 提示！我尝试过使用它，但不幸的是它采用了枚举方式：/

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T10:32:19.813

您需要将选择语言设置为 XPath 使用

objDOM.SetProperty "SelectionLanguage", "XPath"

一旦你设置了这个属性，你就可以使用完整的 XPath 来访问你想要的任何元素

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T10:33:21.730

如果您有 Firefox 浏览器，您可以简单地安装 DOM Inspector（仅 Firefox 3.0 需要）和 XPather 扩展。然后，您可以在 DOM Inspector 窗口中遍历到您想要的节点，相应的 XPath 将显示在同一窗口的 XPather 工具栏中。

DOM 检查员：[https ://addons.mozilla.org/en-US/firefox/addon/6622](https://addons.mozilla.org/en-US/firefox/addon/6622)

XPather：[https ://addons.mozilla.org/en-US/firefox/addon/1192?id=1192](https://addons.mozilla.org/en-US/firefox/addon/1192?id=1192)

XPather 似乎尽可能使用属性（而不是枚举）来识别节点（至少这是我在我的小实验中发现的......）。希望有帮助...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T11:09:14.107

嗯，...我的印象是问题必须基于文件。即使我为 SelectionLanguage 设置了属性，并且如果我使用枚举的 XPath（我通过使用 FireFox XPather 获得），节点对象仍然是空的。

有人知道可能出了什么问题吗？该 xml 文件带有 Microsoft 应用程序，因此应该是有效的。至少我在打开文件或在应用程序中使用它时没有任何问题，所以语法应该没问题。

或者也许有人有一个 vbscript 函数，它遍历整个 xml 文件以找到所需的节点以删除它？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T11:17:04.170

你的问题是你有一个默认的命名空间。XPaths 默认名称空间始终是“无名称”名称空间。

你需要：-

```
sNamespaces = "xmlns:cf='http://schemas.microsoft.com/SystemsManagementServer/2005/03/ConsoleFramework'"
objDOM.setProperty "SelectionNamespaces", sNamespaces 
```

现在您可以在 XPath 中使用：-

```
xPath = "/cf:SmsFormData/cf:Form/cf:Pages/cf:Page[@Id=""some Guid""]" 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T22:35:20.367

不确定它是否对您有用，但我遇到了类似的问题。

我有一个需要管理的应用程序生成的 XML 文件。它的格式为： `<LoginData> <GeneralData> <LoginMask>65537</LoginMask> </GeneralData> <UserData> <User> <Username>TEST0</Username> ... </User> <User> <Username>TEST1</Username> ... </User> </UserData> </LoginData>`

我需要匹配用户名并删除其他用户标签。

花了我（作为一个完整的 XML 菜鸟）的时间来解决它，但最后我在一个节点上匹配，并删除了父节点的子节点：

对于 oXmlDoc.documentElement.selectSingleNode("UserData").childNodes 中的每个 x 如果 x.getElementsByTagName("Username").item(0).text = "TEST1" 然后设置 exx = x.getElementsByTagName("Username").item (0) wscript.echo(x.getElementsByTagName("Username").item(0).text) wScript.echo(x.nodename & ": " & x.text) x.parentNode.removeChild(x) end if next

# .net - 设计时在 Winforms 文本框中进行内联编辑

> ID：173712
> 
> 赞同：1
> 
> 时间：2008-10-06T09:47:01.090
> 
> 标签：.net, winforms, forms, designer

我正在使用一个自定义的 winforms 2.0 设计器（即我的应用程序托管该设计器），该设计器用于一个小型内部项目。

到目前为止，所有控件都通过属性网格编辑了它们的属性-但我想通过允许内联编辑使其更加用户友好-有谁知道如何在其中实现内联编辑的示例Windows 窗体设计器（仅用于在此阶段输入纯文本）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T15:15:47.357

您将需要创建一个支持此行为的设计器。例如，使用 Reflector 查看设计器`ListView`调整其列大小的用途。这应该让您了解所涉及的工作以及您需要做什么。有一些关于这方面的[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.design.controldesigner.aspx)，但它并不像您希望的那样有用。

, `ListViewDesigner`in `System.Design.dll`, 通过将设计器中的鼠标操作转换为操纵底层列表视图的 Windows 消息来提供列大小。你的文本框设计器需要对键盘事件做类似的事情。

# sql - SQL Server：复制表中的列

> ID：173717
> 
> 赞同：24
> 
> 时间：2008-10-06T09:49:17.653
> 
> 标签：sql, copying

将表中的列中的所有值复制到同一表中的另一列的最简单方法是什么？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-10-06T09:50:53.920

使用单个语句（如果列具有相同的数据类型）

```
UPDATE <tablename>
SET <destination column name> = <source column name> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-06T09:50:06.310

此脚本将使用相应行中 field2 中的值更新 field1 中的所有值

```
UPDATE table SET field1 = field2 
```

# database - 数据库连接何时以及为何昂贵？

> ID：173726
> 
> 赞同：377
> 
> 时间：2008-10-06T09:52:19.473
> 
> 标签：database, performance, join, relational-database, denormalization

我正在对数据库进行一些研究，并且正在研究关系数据库的一些限制。

我知道大表的连接非常昂贵，但我不完全确定为什么。DBMS执行join操作需要做什么，瓶颈在哪里？
非规范化如何帮助克服这一开销？其他优化技术（例如索引）如何提供帮助？

欢迎亲身体验！如果您要发布资源链接，请避免使用 Wikipedia。我知道在哪里可以找到那个了。

与此相关，我想知道 BigTable 和 SimpleDB 等云服务数据库使用的非规范化方法。看到[这个问题](https://stackoverflow.com/questions/176131/pros-of-databases-like-bigtable-simpledb)。

* * *

## 回答 #1

> 赞同：500
> 
> 时间：2008-10-06T12:16:04.003

反规范化以提高性能？这听起来很有说服力，但它不成立。

与 Ted Codd 博士合作的关系数据模型的最初支持者 Chris Date 对反对规范化的错误论点失去了耐心，并使用科学方法系统地摧毁了它们：他获得了大型数据库并*测试*了这些断言。

我认为他在*Relational Database Writings 1988-1991*中写了这本书，但这本书后来被纳入*数据库系统简介的*第六版，这是关于数据库理论和设计*的*权威书籍，在我写的第八版中并且可能会保留印刷数十年。当我们大多数人还赤脚跑来跑去的时候，Chris Date 是这个领域的专家。

他发现：

*   其中一些适用于特殊情况
*   所有这些都无法用于一般用途
*   对于其他特殊情况，所有这些都明显更糟

这一切都归结为减少工作集的大小。涉及正确选择的键和正确设置的索引的连接很便宜，而不是昂贵，因为它们允许在行实现*之前对结果进行大量修剪。*

实现结果涉及批量磁盘读取，这是该练习中最昂贵的一个数量级。相比之下，执行连接在逻辑上只需要检索*键*。在实践中，甚至不获取键值：键哈希值用于连接比较，降低了多列连接的成本，并从根本上降低了涉及字符串比较的连接成本。不仅更适合缓存，还有更少的磁盘读取要做。

此外，一个好的优化器会选择最严格的条件并在执行连接之前应用它，非常有效地利用连接对高基数索引的高选择性。

诚然，这种类型的优化也可以应用于非规范化的数据库，但是那些*想要*对模式进行非规范化的人通常不会在（如果）设置索引时考虑基数。

重要的是要了解表扫描（在生成连接的过程中检查表中的每一行）在实践中很少见。仅当以下一项或多项成立时，查询优化器才会选择表扫描。

*   关系中的行数少于 200（在这种情况下，扫描会更便宜）
*   连接列上没有合适的索引（如果在这些列上连接有意义，那么为什么它们不被索引？修复它）
*   在可以比较列之前需要类型强制（WTF？！修复它或回家）**查看 ADO.NET 问题的尾注**
*   比较的参数之一是表达式（无索引）

执行一个操作比不执行它更昂贵。但是，执行*错误*的操作，被迫进行无意义的磁盘 I/O，然后在执行真正需要的连接之前丢弃渣滓，代价要高*得多。*即使预先计算了“错误”操作并且已合理应用索引，仍然存在重大损失。预先计算连接的非规范化 - 尽管需要更新异常 - 是对特定连接的承诺。如果您需要*不同*的加入，那么该承诺将使您付出*巨大*的代价。

如果有人想提醒我，这是一个不断变化的世界，我想你会发现在 gruntier 硬件上更大的数据集只会夸大 Date 的发现的传播范围。

对于所有在计费系统或垃圾邮件生成器上工作的人（为你感到羞耻）并且愤怒地把手放在键盘上告诉我你知道非规范化更快的事实，对不起，但你生活在一个特殊的地方案例 - 特别是您按顺序处理*所有*数据的情况。这不是一般情况，您的策略*是*合理的。

你*没有*理由错误地概括它。有关在数据仓库场景中适当使用非规范化的更多信息，请参阅注释部分的末尾。

我也想回复

> 连接只是带有一些唇彩的笛卡尔积

真是一堆废话。尽可能早地应用限制，首先应用最严格的限制。你读过这个理论，但你还没有理解它。连接*仅*被查询优化器*视为*“应用谓词的笛卡尔积” 。这是一种符号表示（实际上是规范化），以促进符号分解，因此优化器可以生成所有等效转换并按成本和选择性对它们进行排序，以便选择最佳查询计划。

 *让优化器生成笛卡尔积的唯一方法是不提供谓词：`SELECT * FROM A,B`

* * *

## 笔记

* * *

David Aldridge 提供了一些重要的附加信息。

除了索引和表扫描之外，确实还有许多其他策略，现代优化器会在生成执行计划之前将它们全部消耗掉。

一条实用的建议：如果它可以用作外键，则对其进行索引，以便优化器*可以使用索引策略。*

我曾经比 MSSQL 优化器更聪明。这在两个版本前改变了。现在它一般教*我*。在非常真实的意义上，它是一个专家系统，将许多非常聪明的人的所有智慧编入一个足够封闭的领域，以使基于规则的系统有效。

* * *

“胡说八道”可能是不圆滑的。我被要求不要那么傲慢，并提醒我数学不会说谎。这是真的，但并非数学模型的所有含义都必须按字面意思理解。如果您仔细避免检查它们的荒谬性（双关语）并确保在尝试解释方程之前将它们全部取消，则负数的平方根非常方便。

我如此野蛮地回应的原因是措辞上的声明说

> 联接*是*笛卡尔积...

这可能不是本意，但它*是*写的，而且绝对不真实。笛卡尔积是一种关系。连接是一个函数。更具体地说，连接是一个关系值函数。使用空谓词，它将产生一个笛卡尔积，并且检查它是否这样做是对数据库查询引擎的一种正确性检查，但实际上没有人编写无约束连接，因为它们在课堂之外没有实际价值。

我之所以这么说是因为我不希望读者陷入将模型与模型对象混淆的古老陷阱。模型是一种近似值，为方便操作而特意简化。

* * *

选择表扫描连接策略的截止点可能因数据库引擎而异。它受许多实现决策的影响，例如树节点填充因子、键值大小和算法的细微之处，但广义而言，高性能索引的执行时间为*k* log *n* + *c*。*C 项是一个固定开销，主要由设置时间组成，曲线的形状意味着在n*达到数百之前你不会得到回报（与线性搜索相比） 。

* * *

## 有时非规范化是个好主意

非规范化是对特定连接策略的承诺。如前所述，这会干扰*其他*连接策略。但是，如果您有大量磁盘空间、可预测的访问模式以及处理大部分或全部空间的倾向，那么预先计算连接可能非常值得。

您还可以找出您的操作通常使用的访问路径，并预先计算这些访问路径的所有连接。这是数据仓库背后的前提，或者至少是当他们是由知道他们为什么要做他们正在做的事情的人构建的时候，而不仅仅是为了符合流行语。

通过对标准化事务处理系统进行批量转换，定期生成设计合理的数据仓库。这种操作和报告数据库的分离具有消除 OLTP 和 OLAP（在线事务处理即数据输入和在线分析处理即报告）之间的冲突的非常理想的效果。

这里重要的一点是，除了定期更新之外，数据仓库是*只读*的。这使得更新异常的问题变得毫无意义。

不要犯非规范化 OLTP 数据库（发生数据输入的数据库）的错误。计费运行可能会更快，但如果您这样做，您将收到更新异常。曾经试图让读者文摘停止向你发送东西吗？

这些天磁盘空间很便宜，所以把自己搞砸了。但非规范化只是数据仓库故事的一部分。更大的性能提升来自预先计算的汇总值：每月总计，诸如此类。它*总是*关于减少工作集。

* * *

## 类型不匹配的 ADO.NET 问题

假设您有一个 SQL Server 表，其中包含一个类型为 varchar 的索引列，并且您使用 AddWithValue 传递一个参数来约束对该列的查询。C# 字符串是 Unicode，因此推断的参数类型将是 NVARCHAR，它与 VARCHAR 不匹配。

VARCHAR 到 NVARCHAR 是一个扩大的转换，所以它隐式发生 - 但告别索引，祝你好运找出原因。

* * *

## “计算磁盘命中数”（里克·詹姆斯）

如果一切都缓存在 RAM 中，`JOINs`则相当便宜。也就是说，归一化并没有太大的*性能损失*。

如果“规范化”模式导致`JOINs`大量磁盘命中，但等效的“非规范化”模式不必命中磁盘，则非规范化赢得了性能竞争。

> 原作者评论：现代数据库引擎非常擅长组织访问排序，以最大限度地减少连接操作期间的缓存未命中。上述内容虽然是正确的，但可能会被误解为暗示连接在大数据上必然存在问题昂贵。这将导致缺乏经验的开发人员做出糟糕的决策。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-10-06T12:48:38.930

大多数评论者没有注意到的是复杂 RDBMS 中可用的广泛连接方法，并且非规范化器总是掩盖维护非规范化数据的更高成本。并非每个联接都基于索引，并且数据库具有许多优化的联接算法和方法，旨在降低联接成本。

在任何情况下，连接的成本取决于其类型和其他一些因素。它根本不需要昂贵 - 一些例子。

*   散列连接（其中批量数据是等值连接的）确实非常便宜，而且只有当哈希表无法缓存在内存中时，成本才会变得显着。不需要索引。在连接的数据集之间进行等分区可能会有很大帮助。
*   排序合并连接的成本是由排序成本而不是合并驱动的——基于索引的访问方法实际上可以消除排序成本。
*   索引上的嵌套循环连接的成本由 b 树索引的高度和表块本身的访问权限决定。它很快，但不适合批量连接。
*   基于集群的嵌套循环连接要便宜得多，每个连接行所需的逻辑 IO 更少——如果连接的表都在同一个集群中，那么通过连接行的托管，连接变得非常便宜。

数据库被设计为连接，它们在如何连接方面非常灵活，并且通常非常高效，除非它们的连接机制错误。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-10-06T13:53:32.857

我认为整个问题是基于一个错误的前提。大型表上的联接*不一定*很昂贵。事实上，**有效地进行连接是关系数据库存在的主要原因之一**。大*集合*上的连接通常很昂贵，但您很少希望将大表 A 的全部内容与大表 B 的全部内容连接起来。相反，您编写查询时只使用每个表*的重要行*，并且连接保留的实际集合仍然较小。

此外，您还拥有 Peter Wone 提到的效率，因此只有每条记录的重要部分需要在内存中，直到最终结果集实现。此外，在具有许多连接的大型查询中，您通常希望从较小的表集开始，然后一直到较大的表集，以便保存在内存中的集尽可能地小。

如果操作得当，连接通常是比较、组合或过滤大量数据的*最佳方式。*

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-11-03T23:33:32.180

瓶颈几乎*总是*磁盘 I/O，更具体地说是随机磁盘 I/O（相比之下，顺序读取相当快，并且可以使用预读策略进行缓存）。

连接*可以*增加随机搜索 - 如果您正在阅读大表的一小部分内容。但是，查询优化器会寻找它并将其转换为顺序表扫描（丢弃不需要的行），如果它认为这样会更好。

单个非规范化表也有类似的问题 - 行很大，因此不太适合单个数据页。如果您需要远离另一行的行（并且大的行大小使它们之间的距离更远），那么您将拥有更多的随机 I/O。同样，可能会强制执行表扫描来避免这种情况。但是，这一次，由于行大小较大，您的表扫描必须读取更多数据。再加上您将数据从一个位置*复制到多个位置，RDBMS 有更多的内容要读取（和缓存）。*

使用 2 个表，您还可以获得 2 个聚集索引 - 通常可以索引更多（因为插入/更新开销更少），这可以大大提高性能（主要是因为索引（相对）小，可以快速读取磁盘（或缓存便宜），并减少需要从磁盘读取的表行数）。

连接的唯一开销来自于找出匹配的行。Sql Server 使用 3 种不同类型的连接（主要基于数据集大小）来查找匹配行。如果优化器选择了错误的连接类型（由于统计信息不准确、索引不足或只是优化器错误或边缘情况），它可能会严重影响查询时间。

*   对于（至少 1 个）小型数据集，循环连接非常便宜。
*   合并连接首先需要两种数据集。但是，如果您加入索引列，则索引已经排序，不需要做进一步的工作。否则，排序会有一些 CPU 和内存开销。
*   哈希连接需要内存（存储哈希表）和 CPU（构建哈希）。同样，这相对于磁盘 I/O 来说相当快。*但是*，如果没有足够的 RAM 来存储哈希表，Sql Server 将使用 tempdb 存储部分哈希表和找到的行，然后一次只处理部分哈希表。与所有磁盘一样，这相当慢。

在最佳情况下，这些不会导致磁盘 I/O - 因此从性能角度来看可以忽略不计。

*总而言之，在最坏的情况下 - 从 x 个连接表中读取相同数量的逻辑*数据实际上应该更快，因为它来自单个非规范化表，因为磁盘读取较小。要读取相同数量的*物理*数据，可能会有一些轻微的开销。

由于查询时间通常由 I/O 成本支配，并且数据的大小不会因非规范化而改变（减去一些非常微小的行开销），因此仅将表合并在一起并没有太大的好处。倾向于提高性能的非规范化类型 IME 是缓存计算值，而不是读取计算它们所需的 10,000 行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-06T09:58:51.877

加入表格的顺序非常重要。如果您有两组数据，请尝试以某种方式构建查询，以便首先使用最小的数据来减少查询必须处理的数据量。

对于某些数据库，这无关紧要，例如 MS SQL 在大多数情况下确实知道正确的连接顺序。对于某些人（如 IBM Informix）来说，顺序决定了一切。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-20T12:25:28.203

当您考虑连接的复杂性类别时，决定是去规范化还是规范化是一个相当简单的过程。例如，当查询为 O(k log n) 时，我倾向于使用规范化设计我的数据库，其中 k 与所需的输出幅度相关。

非规范化和优化性能的一种简单方法是考虑对规范化结构的更改如何影响非规范化结构。然而，它可能会出现问题，因为它可能需要事务逻辑来处理非规范化的结构。

由于问题非常广泛，因此关于规范化和非规范化的辩论不会结束。在许多问题中，自然解决方案需要这两种方法。

作为一般规则，我总是存储可以重构的规范化结构和非规范化缓存。最终，这些缓存节省了我的精力来解决未来的规范化问题。

* * *

## 回答 #7

> 赞同：-8
> 
> 时间：2008-10-06T11:09:55.870

详细说明其他人所说的，

加入只是带有一些唇彩的笛卡尔产品。{1,2,3,4}X{1,2,3} 会给我们 12 种组合 (nXn=n^2)。此计算集充当应用条件的参考。DBMS 应用条件（例如左右均为 2 或 3）为我们提供匹配条件。实际上它更优化，但问题是一样的。对集合大小的更改将成倍增加结果大小。消耗的内存量和 CPU 周期都以指数形式影响。

当我们去规范化时，我们完全避免了这种计算，想想在你的书的每一页上贴一个彩色的便签。您可以在不使用参考的情况下推断信息。我们付出的代价是我们损害了 DBMS（数据的最佳组织）的本质

# php - 如何将加密数据保存在 cookie 中（使用 php）？

> ID：173727
> 
> 赞同：1
> 
> 时间：2008-10-06T09:52:31.377
> 
> 标签：php, security, encryption, cookies

我想将数据保存在 cookie 中（用户名、电子邮件地址等），但我不想让用户轻松阅读或修改它。我需要能够读回数据。我怎么能用 php 5.2+ 做到这一点？

它将用于“欢迎回来鲍勃”类型的功能。它不能替代持久性或会话存储。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T10:02:40.170

我们在项目中使用 mcrypt 来实现加密。以下是基于互联网上找到的内容的代码示例：

```
<?php
class MyProjCrypt {

    private $td;
    private $iv;
    private $ks;
    private $salt;
    private $encStr;
    private $decStr;

    /**
     *  The constructor initializes the cryptography library
     * @param $salt string The encryption key
     * @return void
     */
    function __construct($salt) {
        $this->td = mcrypt_module_open('rijndael-256', '', 'ofb', ''); // algorithm
        $this->ks = mcrypt_enc_get_key_size($this->td); // key size needed for the algorithm
        $this->salt = substr(md5($salt), 0, $this->ks);
    }

    /**
     * Generates a hex string of $src
     * @param $src string String to be encrypted
     * @return void
     */
    function encrypt($src) {
        srand(( double) microtime() * 1000000); //for sake of MCRYPT_RAND
        $this->iv = mcrypt_create_iv($this->ks, MCRYPT_RAND); 
        mcrypt_generic_init($this->td, $this->salt, $this->iv);
        $tmpStr = mcrypt_generic($this->td, $src);
        mcrypt_generic_deinit($this->td);
        mcrypt_module_close($this->td);

        //convert the encrypted binary string to hex
        //$this->iv is needed to decrypt the string later. It has a fixed length and can easily 
        //be seperated out from the encrypted String
        $this->encStr = bin2hex($this->iv.$tmpStr);

    }

    /**
     * Decrypts a hex string    
     * @param $src string String to be decrypted
     * @return void
     */
    function decrypt($src) {
        //convert the hex string to binary
        $corrected = preg_replace("[^0-9a-fA-F]", "", $src);
        $binenc = pack("H".strlen($corrected), $corrected);

        //retrieve the iv from the encrypted string
        $this->iv = substr($binenc, 0, $this->ks);

        //retrieve the encrypted string alone(minus iv)
        $binstr = substr($binenc, $this->ks);

        /* Initialize encryption module for decryption */
        mcrypt_generic_init($this->td, $this->salt, $this->iv);
        /* Decrypt encrypted string */
        $decrypted = mdecrypt_generic($this->td, $binstr);

        /* Terminate decryption handle and close module */
        mcrypt_generic_deinit($this->td);
        mcrypt_module_close($this->td);
        $this->decStr = trim($decrypted);

    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T09:59:13.967

我建议您不仅要加密，还要对数据进行签名。如果您不签署数据，您将无法可靠地判断用户是否修改了数据。此外，为避免重播，您可能需要在数据中添加一些时间戳/有效期信息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T09:55:35.627

如果您不希望您的用户阅读它，请不要将其放入 cookie 中；取而代之的是使用 Session 的 cookie 来保留更长时间。这样，数据将保留在服务器上，而不是用户的计算机上。

[请参阅这篇关于持久会话的文章](http://www.paulsrichards.com/2008/07/29/persistent-sessions-with-php/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-06T10:00:45.867

[有关加密示例，请参阅http://www.osix.net/modules/article/?id=606](http://www.osix.net/modules/article/?id=606)中的“对称加密”部分。

为防止未经授权的修改，请使用 HMAC：[http://php.net/hash-hmac](http://php.net/hash-hmac)，以及关于 hmac 的一般性：[http](http://en.wikipedia.org/wiki/HMAC) ://en.wikipedia.org/wiki/HMAC、http : [//en.wikipedia.org/ wiki/Message_authentication_code](http://en.wikipedia.org/wiki/Message_authentication_code)

如果您不需要，请不要将敏感数据存储在 cookie 中，即使是加密的。您可能想阅读有关“数据间接”的更多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T09:59:50.673

如果您绝对必须这样做，那么您可以使用`mcrypt`.

[http://php.net/mcrypt](http://php.net/mcrypt)

# xml - 为什么 Installshield 2008 不回滚 XML 更改？

> ID：173739
> 
> 赞同：0
> 
> 时间：2008-10-06T09:57:10.337
> 
> 标签：xml, installshield

我正在使用 Installshield 2008 Premier 编辑一些已经在目标系统上的 XML 文件。此过程与“XML 文件更改”功能配合得很好。

我的问题是，Installshield 不会在卸载时删除这些更改。我在添加的元素中设置了“卸载时删除元素”复选框，但 InstallShield 似乎因此忽略了这一点。

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-31T14:29:48.867

不幸的是，它似乎无法解决。基本上，在安装实际完成之前，安装期间所做的 xml 更改似乎并未“最终确定”。因此，xml 文件似乎留下了“只读”和“隐藏”属性集。

根据我使用 IS2009 的经验，我不得不编写一个 installScript 来手动处理更改（和删除）。

在 IS 社区论坛上有很多人在讨论这个问题，但遗憾的是没有官方回答或确认..

# sql - 如何获取返回集中每行的空值列数？

> ID：173745
> 
> 赞同：2
> 
> 时间：2008-10-06T09:59:12.547
> 
> 标签：sql

我正在寻找一个查询，它将在我当前查询的末尾返回一个额外的列，该列是返回集中包含空列的所有列的计数。例如：

```
Col 1 - Col 2 - Col 3
A       B       0
A       NULL    1
NULL    NULL    2 
```

是否有一种简单的方法可以根据行值获取此返回集，而不必重新查询获取原始行的所有条件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T10:21:15.437

丑陋的解决方案：

```
select Col1, Col2,
       case when Col1 is null then 1 else 0 end
     + case when Col2 is null then 1 else 0 end
     as Col3
from (

select 'A' as Col1, 'B' as Col2
union select 'A', NULL
union select NULL, NULL

) z 
```

这返回

```
Col1 Col2 Col3
NULL NULL 2
A    NULL 1
A    B    0 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T12:23:13.397

Oracle 有一个函数 NVL2() 可以很容易地做到这一点。

```
select col1,
       col2,
       col3,
       ...
        NVL2(col1,0,1)
       +NVL2(col2,0,1)
       +NVL2(col3,0,1) coln
from   whatever 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T12:16:11.647

```
select count(*) - count(ColumnName) as NumberOfNulls from yourTable 
```

返回特定列中的空值数。如果您对每一列都执行此操作，您可以获得该数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-24T12:59:57.837

```
create table TEST
(
  a VARCHAR2(10),
  b VARCHAR2(10),
  c VARCHAR2(10)
);

insert into TEST (a, b, c)
values ('jas', 'abhi', 'shail');
insert into TEST (a, b, c)
values (null, 'abhi', 'shail');
insert into TEST (a, b, c)
values ('jas', null, 'shail');
insert into TEST (a, b, c)
values ('jas', 'abhi', null);
insert into TEST (a, b, c)
values ('jas', 'abhi', 'abc|xyz');
insert into TEST (a, b, c)
values ('jas', 'abhi', 'abc|xyz');
insert into TEST (a, b, c)
values ('jas', 'abhi', 'abc|xyz');
insert into TEST (a, b, c)
values (null, 'abhi', 'abc|xyz');
commit;

select sum(nvl2(a,null,1)),sum(nvl2(b,null,1)),sum(nvl2(c,null,1))  from test 
where a is null 
or b is null
or c is null
order by 1,2,3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-07T14:23:49.487

正如在类似的帖子中一样，SQL 不太适合在一行中的不同列上工作，但更适合跨行工作。

我建议将表格变成关于一行的“个人”事实，例如

```
select <key>, col1 as value From aTable
UNION
select <key>, col2 as value From aTable
UNION
... and so on for the other columns to be summed. 
```

这可以变成一个视图，即

```
create view aView as (select as above). 
```

那么正确答案就是

```
select key, count(*)
from aView
where value is null
Group By key 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T10:15:29.630

如果没有很好的理由需要在 SQL 中执行此操作，则应该只对结果集执行一个 for 循环，然后计算 NULL 值。

成本从 n^n 到 n..

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T10:41:08.313

您可以使用计算列：

```
CREATE TABLE testTable(
    col1 nchar(10) NULL,
    col2 nchar(10) NULL,
    col3  AS (case when col1 IS NULL then (1) else (0) end+case when col2 IS NULL then (1) else (0) end)
) 
```

这不是一个很好的解决方案，但应该可以。

如果您正在处理大量列并且其中许多列您希望为 NULL，那么您可以使用[稀疏列](http://msdn.microsoft.com/en-us/library/cc280604.aspx)（在 SQL Server 2008 中可用）。它将针对 NULL 进行优化，并且可以为表中的每一行数据自动生成 XML 表示。

# .net - 从 .NET 与 SQLite 对话的最佳/最简单方法是什么？

> ID：173747
> 
> 赞同：3
> 
> 时间：2008-10-06T09:59:19.787
> 
> 标签：.net, sqlite

问题说明了一切，真的。我的应用程序是一个时间跟踪器。它目前是作为电子表格编写的，但是数据太多了，我想在上面加上更多的结构。

[SQLite](http://sqlite.org/)似乎是一个很好的方法。
我也愿意接受其他建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T10:02:17.173

有一些提供程序可用：

[http://sqlite.phxsoftware.com/](http://sqlite.phxsoftware.com/)

[http://sourceforge.net/projects/sqlite-dotnet2](http://sourceforge.net/projects/sqlite-dotnet2)

根据这个章节，你可以在三分钟内启动并运行：

[http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins/](http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins/)

**2009 年 1 月 5 日更新：**我们实际上已将其推广到我们的共享（部分信任）托管环境中，并且根据早期的客户反馈，它运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-27T16:46:29.670

当前（2011 年 4 月）链接似乎在[这里](http://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki)System.Data.SQLite 1.0.70.0 (3.7.6)

但是安装程序似乎有一些问题。没有将 SQLite.Interop.dll 正确安装到 GAC。

我没有在 GAC 中安装它并使用绝对路径加载它，这对我来说很好。

刚刚注意到，[票](http://system.data.sqlite.org/index.html/tktview?name=54e52d4c6f)再次打开。检查那里的新工作和解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T10:05:50.740

如果您正在开发一个开源应用程序并想要一个轻量级的 SQLite 互操作层，那么可能会对 Media Portal 中的 SQLite 代码感兴趣（参见 SQLiteClient.cs）

# php - Apache 使用过多的 CPU

> ID：173757
> 
> 赞同：11
> 
> 时间：2008-10-06T10:01:17.910
> 
> 标签：php, mysql, performance, apache

我们经营一个中等规模的网站，每天有几十万的综合浏览量。直到上周末，我们在虚拟机上运行的负载通常低于 0.2。操作系统是 Ubuntu。

在部署我们应用程序的最新版本时，我们还在部署前进行了 apt-get dist-upgrade。部署后，我们注意到 CPU 上的负载急剧增加（有时达到 10 并停止响应页面请求）。

我们尝试从 PHP 中转储一整分钟的 Xdebug 分析数据，但仔细查看它只发现了一些有点慢的部分，但没有什么可以解释巨大的跳跃。

我们现在很确定我们网站的新版本中没有任何东西会引发问题，但我们无法确定。我们已经回滚了很多更改，但问题仍然存在。

在查看进程时，我们看到单个 Apache 进程在比严格必要的更长时间内使用相当多的 CPU。但是，当在受影响的进程上使用 strace 时，我们只看到

```
accept(3, 
```

在接收到新连接之前它会挂起一段时间，所以我们实际上看不到是什么导致了问题。

堆栈是 PHP 5、Apache 2（prefork）、MySQL 5.1。大多数事情都是通过 Memcached 运行的。我们已经尝试过 APC 和 eAccelerator。

那么，我们的下一步应该是什么？是否有任何我们忽略/不知道的分析方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-20T13:54:15.753

答案最终与 Apache 无关。如前所述，我们在虚拟机上。我们的用户会话非常大（想想每个活跃用户 500kB），所以我们有很多磁盘 IO。磁盘快满了，这意味着 Ubuntu 花了很多时间来移动东西（或者我们认为）。没有简单的方法来扩展磁盘（因为它没有为 VMWare 正确设置）。这完全扼杀了性能，Apache 和 MySQL 偶尔会使用 100% 的 CPU（在很短的时间内），并且系统更新 CPU 使用率表的速度非常慢，以至于它似乎卡在了那里。

我们最终设置了一个新的虚拟机（这也让我们有机会彻底记录服务器上的所有内容）。在新 VM 上，我们分配了大量磁盘空间，并将会话移到内存中（使用 memcached）。我们的负载在非高峰使用时下降到 0.2，在接近高峰使用时下降到大约 1（在 2-CPU VM 上）。将会话移到 memcached 会占用大量磁盘 IO（我们经常使用大约 2MB/s 的磁盘 IO，这非常糟糕）。

结论; 有时你只需要重新开始...... :)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T16:17:53.580

从您的 Apache 进程中看到 accept() 调用并不少见——那是网络服务器在等待新请求。

首先，您要确定负载的参数是什么。就像是

```
vmstat 1 
```

将向您展示您的系统在做什么。查看“swap”和“io”列。如果您在 'si' 和 'so' 列中看到除 '0' 以外的任何内容，则您的系统由于内存不足而正在交换。考虑减少正在运行的 Apache 子节点的数量，或者在您的服务器中投入更多的 RAM。

如果 RAM 不是问题，请查看“cpu”列。您对“us”和“sy”列感兴趣。这些显示了在用户进程或系统中花费的 CPU 时间百分比。较高的“我们”数字将矛头指向 Apache 或您的脚本——或者可能是服务器上的其他东西。

跑步

```
top 
```

将向您显示哪些进程最活跃。

你排除了你的数据库吗？我在生产 LAMP 堆栈上看到的意外高负载的最常见原因归结为数据库查询。您可能已经部署了包含昂贵查询的新代码；或者到了数据集中有足够的行导致以前便宜的查询变得昂贵的地步。

在高负载期间，做

```
echo "show full processlist" | mysql | grep -v Sleep 
```

查看是否有长时间运行的查询，或者同时运行大量相同的查询。其他 mysql 工具将帮助您优化这些。

您可能会发现为 Apache 配置和使用 mod_status 很有用，这将允许您查看每个 Apache 子进程正在处理的请求以及它已经执行了多长时间。

最后，建立一些长期的统计监测。像 zabbix 这样的东西配置起来很简单，并且可以让你随着时间的推移监控资源使用情况，这样如果事情变得缓慢，你就有历史基线可以比较，并更好地了解问题何时开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T10:13:09.260

也许您以前和现在不在哪里使用工人 MPM？

我知道 PHP5 不适用于 Worker MPM。在我的 Ubuntu 服务器上，PHP5 只能与 Prefork MPM 一起安装。PHP5 模块似乎与多线程版本的 Apache 不兼容。

我在这里找到了一个链接，它将向您展示如何使用[mod_fcgid获得更好的性能](http://ivan.gudangbaca.com/installing_apache2_and_php5_using_mod_fcgid)

要查看工人 MPM 是什么，请参见[此处](http://httpd.apache.org/docs/2.0/mod/worker.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T10:42:11.573

我会使用 dTrace 来解决这个谜......如果它在 Solaris 或 Mac 上运行......但由于 Linux 没有它，你可能想尝试他们的[Systemtap](http://sourceware.org/systemtap/)，但是我不能说它的可用性，因为我没用过。

使用 dTrace，您可以在一天内轻松找出罪魁祸首，并希望使用 Systemtap 会类似

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T11:26:53.557

我不能保证你会做任何好事的另一种选择，但它的努力是值得的。是阅读新版本的详细变更日志，并查看可能会远程影响您的更改。

浏览变更日志不止一次救了我。尤其是当一些配置选项发生变化并且某些东西被弃用时。最坏的情况是它会给你一些关于下一步看哪里的线索

# java - Java 静态分析的覆盖率

> ID：173763
> 
> 赞同：17
> 
> 时间：2008-10-06T10:02:33.617
> 
> 标签：java, static-analysis, coverity-prevent

我想从使用或评估过 Coverity 以静态分析 Java 代码的人那里获得评论。我知道它在 C/C++ 世界中很流行，但是否值得花钱进行 Java 分析，还是我最好使用 PMD、Findbugs 和其他开源工具？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-31T22:17:23.350

如果您今天不使用任何东西，我将从 Findbugs 和 PMD 开始。它们易于安装和使用。首先使用 Findbugs 专注于检查和修复正确性错误 - 他们建议从高和中等严重性正确性错误开始，因为检查器的误报率非常低，您将获得良好的时间回报。让开发人员使用 PMD 清理代码，并使用 Eclipse 中的 Findbugs 插件来审查新代码。渐进式工作将使开发人员了解并认同这些工具的有用性。

与 C/C++ 检查器相比，Coverity 的 Java 检查器仍然很弱。我们使用 Findbugs、PMD、Coverity 和 Klocwork，因为它们都有不同的优势，而且我们很偏执。如果你不是偏执狂，你可以坚持使用开源工具并获得很多价值。或者，如果您需要安全检查：那么 Klocwork 或特别是 Fortify 应该为您做更彻底的工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-07T03:41:11.903

我会提供一个有点相关的答案。我已经将 Klocwork 用于 Java 和 C 代码。Klocwork 是 Coverity 的紧密竞争对手……在成本方面它们大致相同（仔细看，在你真正购买所需的东西之前，Klocwork 看起来更便宜），而在功能方面它们来回竞争。

对于 C/C++，这很棒。对于 Java.... 嗯，它帮助找到了很多资源泄漏（#$@^#ing Java 开发人员似乎忘记了文件句柄等资源不是垃圾收集的），但它似乎并没有找到很多“关键”错误。这可能是因为语言本身确实有助于防止一些更基本但难以发现的错误（数组溢出、指针损坏等）。

让 Coverity 运行演示，他们非常乐意。看看他们找到了什么样的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T18:12:49.927

我将在前面的答案中添加一个有限的我，在某种程度上受到我所约束的 Coverity NDA 的限制。Coverity Prevent 在发现开源 C/C++ 代码中的错误方面有着令人印象深刻的公开记录，但他们的 Java 产品要更新得多。（Coverity 有一份关于我的前雇主的新闻稿，所以我可以说它确实帮助发现并修复了我们 C/C++ 代码中的许多错误，比我在之前的所有错误搜寻职业中发现的要多。） FindBugs 确实Java 代码方面令人印象深刻的工作，而且您无法击败价格。但重要的一点已经提出：在购买之前在*您的*真实代码上试用它们。现实是无可替代的，静态分析中的传统观点是，工具发现的内容几乎没有重叠。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-19T21:00:13.343

正如其他人所说，最好的决定方法是尝试所有这些工具。

Coverity 最近宣布了一个名为 Code Spotter ( [https://code-spotter.com/](https://code-spotter.com/) ) 的托管静态分析即服务产品，目前处于测试阶段。它使用与 Coverity 企业产品相同的分析引擎，但封装在不同的（简化的）用户界面中。由于这是一项托管服务，因此很容易使用它来了解 Coverity 分析功能。

在撰写本文时，Code Spotter 仅支持 Java，但其他 Coverity 支持的语言应该很快就会推出。

# .net - .NET 内存管理在托管代码中是否比在本机代码中更快？

> ID：173765
> 
> 赞同：11
> 
> 时间：2008-10-06T10:03:34.147
> 
> 标签：.net, performance, memory, clr, vm-implementation

我原以为托管代码中的内存分配是否比本机代码中的更快是明确的 -[但似乎存在一些争议](https://stackoverflow.com/questions/173591/what-myths-have-you-heard-about-regarding-the-net-framework)。由于没有对操作系统的上下文交换调用，虚拟机下的内存管理可能会更快，但后来我看到虚拟机本身需要定期调用操作系统以获得更多内存，并且它具有内存本身的管理开销而不是操作系统。

与其像我一样做出未经证实的断言，请提供指向支持您立场的参考资料的链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T10:12:44.813

阅读[http://msdn.microsoft.com/en-us/library/ms973852.aspx](http://msdn.microsoft.com/en-us/library/ms973852.aspx)

它详细介绍了 .NET 中内存分配的工作原理，并将其与 C++ 模型进行了简要比较。

总之，.NET 中的内存分配涉及获取当前堆栈点作为对象的地址并将对象的数据大小添加到堆栈指针。相比之下，C++ 必须在已释放指针列表中搜索足够大的堆区域以容纳对象。因此，在大多数情况下，.NET 会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T10:08:41.123

听听 Wintellect 的 Jeff Richter 的话，他是这方面的权威：

[http://www.dotnetrocks.com/default.aspx?showNum=361](http://www.dotnetrocks.com/default.aspx?showNum=361)

# java - 使用 Java 和 OpenGL 绘制 3D 树的方法有哪些？

> ID：173770
> 
> 赞同：6
> 
> 时间：2008-10-06T10:05:26.373
> 
> 标签：java, c++, c, opengl, procedural-generation

我知道如何使用 JOGL 或 LWJGL 绘制基本对象以连接到 OpenGL。我想要的是可以为树生成某种几何图形的东西，类似于 SpeedTree 的著名之处。显然，我不期望与 SpeedTree 具有相同的质量。

我希望树木看起来不重复。速度不是问题，我不希望屏幕上一次需要超过 100 棵树。

Java 中有免费的树形图库吗？还是示例代码或演示？有什么其他语言可以移植或学习的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T21:28:36.767

[http://arbaro.sourceforge.net/](http://arbaro.sourceforge.net/)

[http://www.propro.ru/go/Wshop/povtree/povtree.html](http://www.propro.ru/go/Wshop/povtree/povtree.html)

非Java：[http ://www.aust-manufaktur.de/austt.html](http://www.aust-manufaktur.de/austt.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T10:15:34.370

有成千上万种方法。一个更好的问题将以更严格的方式定义“最佳”。我们是否在谈论“最好”的绘图速度（适合数千或数百万棵树）？最好的和最好看的一样？等等

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T10:15:47.523

2D 还是 3D？
在 2D 中，一种常见的方法是使用 L 系统。
我还尝试了一种面向对象的方法，为树干、树枝、树叶定义对象，所有这些都扩展了一个抽象类并实现了一个基因型接口（以改变树的种类）。
不确定它是否有效（创建了很多对象，特别是如果我为树设置动画）但做起来很有趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T21:26:40.543

以下是一些可能有用的资源：

*   [关于该主题的 gamedev 线程](http://www.gamedev.net/community/forums/topic.asp?topic_id=157049)- 包含一些有用的建议/建议
*   [ngPlant](http://ngplant.sourceforge.net/) - 一个开源程序植物生成工具。它不是用 Java 编写的，但您也许可以在其算法中找到想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T11:14:16.717

如果您使用的是 eclipse/SWT，请尝试 Draw 2D。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T19:44:59.120

如果您真的想获得漂亮、快速的树，那么可以使用商业 C++ 库[SpeedTree](http://www.speedtree.com/html/speedtreert.htm)。许多大型游戏都使用它（例如，GTA、Elder Scrolls）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T12:27:48.503

OpenSceneGraph 和 SpeedTree 的组合对我有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-25T19:49:32.553

我知道有两个库可以在 java 中使用 OpenGL。

[LWJGL](http://lwjgl.org/)（轻量级 Java 游戏库），imo 是更好的一个，因为它的简单性和与使用 c/c++ 的 opengl 相似。

[JOGL](https://jogl.dev.java.net/)如果你想将 swing 组件与 opengl 混合使用，这可能是更好的选择，我从未使用过它，但几年前它被认为是相当有缺陷的，我不知道它是否从那时起成熟了。

至于画树，有很多方法可以像其他海报所说的那样，你可能想要更具体。

编辑：我想我有点误解了这个问题，哦，好吧：/您可以加载树的 3d 模型并显示它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T02:48:44.420

[http://www.codeplex.com/LTrees](http://www.codeplex.com/LTrees)有一些源代码。虽然它是 C++。

# svn - SVN 1.5 合并跟踪准备好迎接黄金时段了吗？

> ID：173775
> 
> 赞同：9
> 
> 时间：2008-10-06T10:06:23.873
> 
> 标签：svn, tortoisesvn, visualsvn-server, merge-tracking

我已经在使用 SVN 1.5，服务器（VisualSVN 1.5.1）和客户端（TortoiseSVN 1.5.1），但我们使用的是相当长的 SVN Branch-Merge 舞蹈。

SVN 1.5.x 的 Merge-Tracking 功能准备就绪了吗？是否可以从 TortoiseSVN 使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T11:15:19.650

Subversion 版本通常相当稳定，1.5 版已经开发了 2 年。话虽如此，总有一些[已知问题](http://subversion.tigris.org/svn_1.5_releasenotes.html#mt-known-issues)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T11:07:57.370

它是富有成效的。您可以在 Log-Dialog 中看到合并的修订，并且重新集成合并工作正常。

但是，修订图中没有合并的图形表示，并且根据 stephan Küng 的说法，由于性能原因，修订图中将没有合并信息。

合并算法将在未来的版本中改变以更好地捕捉一些边缘情况，但它工作得很好。

# web-services - 如何通过使用 web 服务的共享点列表递归迭代？

> ID：173784
> 
> 赞同：0
> 
> 时间：2008-10-06T10:12:08.217
> 
> 标签：web-services, sharepoint

在 sharepoint webservices 中，我可以使用 getListItems() 来获取列表的子元素。

在文档库中，有时元素是文件夹。

```
"ows_FSObjType = 1" 
```

有什么方法可以向 SP 索取这个文件夹的子元素吗？

使用文件夹 ID 使用 getListItems() 进行查询会给我一个 SOAP 异常。

编辑：

我发现这个网络服务有更多的方法

[站点数据网络服务](http://msdn.microsoft.com/en-us/library/ms774720.aspx)

有一个“枚举文件夹”方法，它有一个“isFolder”属性，但没有递归其内容的方法。

谢谢你，山姆。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T20:13:03.713

在 GetListItems 方法中，可选参数之一是名为“QueryOptions”的 XMLNode。您可以放入该节点的元素之一是`<Folder>`.

所以你应该能够传递类似的东西：

```
<QueryOptions>
    <Folder>/My/Path/Here</Folder>
</QueryOptions> 
```

我可能在语法上有点偏离（在发表这篇文章时没有尝试构建和运行查询），但总体思路应该是合理的。您可以在[MSDN GetListItems Reference](http://msdn.microsoft.com/en-us/library/lists.lists.getlistitems.aspx)中查看更多详细信息。

# iphone - 如何阻止 UIScrollView 水平弹跳？

> ID：173786
> 
> 赞同：18
> 
> 时间：2008-10-06T10:12:35.453
> 
> 标签：iphone, cocoa-touch

我有一个 UIScrollView 显示垂直数据，但水平组件不比 iPhone 的屏幕宽。问题是用户仍然可以水平拖动，并且基本上暴露了 UI 的空白部分。我试过设置：

```
scrollView.alwaysBounceHorizontal = NO;
scrollView.directionalLockEnabled = YES; 
```

这有点帮助，但仍然不能阻止用户水平拖动。当然有一种方法可以轻松解决这个问题？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-03-30T21:46:34.267

```
scrollView.bounces = NO; 
```

为我工作。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-06T16:04:29.270

这很奇怪，因为每当我在任一维度上的屏幕边界内创建具有框架和内容大小的滚动视图时，滚动视图都不会沿该方向滚动（或反弹）。

```
// Should scroll vertically but not horizontally
UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
scrollView.contentSize = CGSizeMake(320, 1000); 
```

您确定框架完全适合屏幕并且 contentSize 的宽度不大于滚动视图的宽度吗？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-19T11:01:19.783

故事板滚动视图中垂直反弹的复选框可以简单地帮助......

![在此处输入图像描述](https://i.stack.imgur.com/oqtYU.png)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-06T10:51:09.680

尝试将 scrollView.bounces 设置为 NO 并将 scrollView.alwaysBounceVertical 设置为 YES。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-11-10T20:49:51.450

这在 Swift 中对我有用：

```
scrollView.alwaysBounceHorizontal = false
scrollView.bounces = false 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-19T09:05:00.070

视图是否水平滚动（和反弹）取决于三件事：

*   内容大小
*   左右内容插图
*   滚动视图的宽度 -

如果滚动视图可以适合内容大小加上插图，则它不会滚动或反弹。

避免像这样的水平弹跳：

```
scrollView.contentSize = CGSizeMake(scrollView.frame.size.width - scrollView.contentInset.left - scrollView.contentInset.right, height); 
```

我添加了这个答案，因为之前的答案没有考虑 contentInset 。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T21:09:13.973

确保 UIScrollView 的 contentSize 不比 UIScrollView 本身宽。在我自己的应用程序中，这足以避免水平滚动，除非我在随机方向上非常疯狂地滑动（例如，在视图仍在减速时开始滚动）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-07T14:38:43.730

需要记住的一点：*您*知道水平方向没有什么可看的，但您的用户会知道吗？您可能需要一点水平反弹，即使没有额外的内容可以水平显示。这让用户知道他们的水平滚动尝试没有被忽略，他们看不到任何东西。但是，是的，通常你真的不想要反弹。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-08T12:51:44.653

我的 webViews 版本，一个常见的解决方案：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {

[webView.scrollView setContentSize: CGSizeMake(webView.frame.size.width, webView.scrollView.contentSize.height)];

} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-09T01:20:04.010

如果为 OS X 开发的任何人都在看这里，从 OS X 10.7 开始，解决方案是在滚动视图上将 Horizo [​​ntalScrollElasticity](https://developer.apple.com/reference/appkit/nsscrollview/1403540-horizontalscrollelasticity)属性设置为`false`/ ，如下所示：`NO`

迅速：

```
scrollView.horizontalScrollElasticity = false 
```

目标-C：

```
scrollView.horizontalScrollElasticity = NO 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-11-16T13:36:00.980

您可以像这样禁用水平反弹：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    if (scrollView.contentOffset.x < 0) {
        scrollView.contentOffset = CGPointMake(0, scrollView.contentOffset.y);
    } else if (scrollView.contentOffset.x > scrollView.contentSize.width) {
        scrollView.contentOffset = CGPointMake(scrollView.contentSize.width, scrollView.contentOffset.y);
    }
} 
```

它手动重置 contentOffset.x 并且不会影响垂直反弹。有用...

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-01-07T09:43:31.810

就我而言，我只需要设置这一行：

`collectionView.bounces = false`

# java - Java：序列化未知的数组大小

> ID：173790
> 
> 赞同：0
> 
> 时间：2008-10-06T10:14:19.523
> 
> 标签：java, serialization, objectsize

如果我保护一个数组并重新加载它，如果它未知，是否有可能获得它的大小？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T10:25:23.463

“未知”是什么意思？您可以使用长度字段获取任何 java 数组的长度。

```
int[] myArray = deserializeSomeArray();
int size = myArray.length; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T12:43:14.667

听起来您正在序列化并将单个对象存储在数组中（在行间大量阅读之后）。使用 ObjectOutputStream 来存储数组本身。如果存储在数组中的对象是可序列化的，它们也会被存储。当您反序列化时，您将完整地恢复整个数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T11:00:45.933

我认为您需要提供更多信息。你是如何保存数组的？使用对象输出流？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T11:03:58.143

不，因为数组的长度只是分配的内存大小除以存储在其中的对象的大小，并且由于没有对象的大小为 0，因此您将始终具有适当的长度（可能为 0）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T11:25:28.223

如果您使用 ObjectInputStream.readObject() 读取保存的数组，它将以适当的长度重新构成，您可以使用 array.length 读取大小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T12:29:51.947

试图在字里行间阅读......

如果您实际上是在读取数组，那么（与 C 不同）所有数组都知道它们的长度。Java 是一种安全语言，因此长度对于边界检查是必要的。

```
MyType[] things = (MyType[])in.readObject();
int len = things.length; 
```

也许您的困难在于您正在进行自定义（反）序列化并且正在写出数组的各个元素（提示：不要 - 使用数组）。如果您需要捕获 OptionDataException 来检测封闭对象的自定义数据的结尾：

```
private static final MyType[] NOTHING = new MyType[0];

private transient MyType[] things = NOTHING;

private void writeObject(ObjectOutputStream out) throws IOException {
    out.defaultWriteObject(); // Do not forget this call!
    for (MyType thing : things) {
        out.writeObject(thing);
    }
}
private void readObject(
    ObjectInputStream in
) throws IOException, ClassNotFoundException {
    in.defaultReadObject(); // Do not forget this call!
    List<MyType> things = new ArrayList<MyType>();
    try {
        for (;;) {
            things.add((MyType)in.readObject();
        }
    } catch (OptionalDataException exc) {
        // Okay - end of custom data.
    }
    this.things = things.toArray(NOTHING);
} 
```

如果你要做那种事情，最好在实际数据之前写出你要读取的对象数量作为 int。

# asp.net - 带有 TextBox 的 AutoPostback 失去焦点

> ID：173810
> 
> 赞同：7
> 
> 时间：2008-10-06T10:27:28.763
> 
> 标签：asp.net, textbox, focus, autopostback

A`TextBox`设置`AutoPostback`为更改值应导致重新计算和显示许多（仅显示）字段。
这很好用。

但是，当该字段退出时，焦点会短暂移动到下一个字段，然后在重新绘制页面时消失，因此任何地方都没有焦点。

我希望重点放在新字段上，而不是我刚刚更改的文本框。有没有办法确定哪个字段有焦点并在重绘页面时强制它再次拥有它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T10:31:15.650

这是“设计使然”。如果您使用的是 ASP.NET 2.0+，则可以在回发发生后尝试调用 TextBox 的 Focus 方法（最好在 TextBox 的 TextChanged 事件中）。

我不确定是否有任何内置的方法来跟踪焦点，但我在 CodeProject 中找到[了这篇文章，它应该可以解决问题。](http://www.codeproject.com/KB/aspnet/MainatinFocusASPNET.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T06:26:53.427

[您还可以考虑使用 AJAX UpdatePanel](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.aspx)刷新仅显示字段。这样你就不会失去对新领域的关注。

我还提出了基于*WebControl.Controls.TabIndex分析的纯服务器端*[解决方案](https://stackoverflow.com/questions/178473/linq-query-to-webcontrolcontrols) ，你可以使用它，如果你喜欢。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-24T11:49:07.173

这是正在发生的事情：

1) 字段上的 TAB - 客户端事件
2) 关注下一个字段 - 客户端事件
3) 回发 - 服务器事件
4) 页面重绘 - 客户端事件 新页面覆盖先前的客户端事件

您的问题的解决方案是：

**a)在回发之前**获取获得焦点的元素****

 **```
<script>
var idSelected;
 $("input").focusin(function () {
         idSelected = this.id;
    });
</script> 
```

**b）在回发之前将ClientID**（实际上在`var idSelected`）存储在**某处**（即隐藏的文本框，vith ViewState = true）

** b) 获取 ClientID ** (从隐藏的 TextBox 中提取并放入`var idSelected`) 回发后

**d) 使用 ClientID 获取元素并在**回发后设置焦点

```
<script>
$(document).ready(function () {
  if (idSelected != null) {
       $("#" + idSelected).focus();
       idSelected = null;
     });
});
</script> 
```

* * *

注意：此示例脚本使用**JQuery**。
请记住`Jquery.js`在您的页面中输入您的解决方案和参考

```
<form id="form1" runat="server" enctype="multipart/form-data" method="post">
   <asp:ScriptManager   runat="server" >
  <Scripts>
   <asp:ScriptReference Path="~/Scripts/jquery.js" ScriptMode="Auto" />
.... 
```

* * *

注意 2：此解决方案**无需 AJAX 即可**工作。
看看[这个答案](https://stackoverflow.com/questions/3586735/how-to-make-javascript-work-along-with-ajax-updatepanel/7582335#7582335)：要使 Javascript 在 Ajax 上工作，您必须使用如下代码：

```
<script type="text/javascript">
  Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequestHandler);

  function EndRequestHandler(sender, args)
  {
    MyScript(); 
  }   
</script> 
```

# visual-studio - 异常是否应该在不同的项目中

> ID：173813
> 
> 赞同：1
> 
> 时间：2008-10-06T10:29:05.840
> 
> 标签：visual-studio, exception, coding-style

在构建 Visual Studio 解决方案时，我倾向于将其构建为使各种组件位于不同的项目中（正如我假设大多数人所做的那样），我倾向于有一堆用户定义的异常。

问题是这些例外是否应该在（例如）模型类的单独项目中？

我倾向于将它们放在模型的子命名空间中，并将它们组织在模型项目中的目录中。但他们应该一起在一个单独的项目中吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T10:33:09.030

这取决于您想象它们的使用方式以及您如何部署应用程序。根据经验 - 永远不要创建比需要更多的包/程序集。

将异常和接口类放在他们自己的程序集中有一个强有力的案例，那就是当它们应该在不一定需要“完整”包的客户端之间共享时，一种常见的情况是在使用远程处理时，另一种情况是在构建插件架构时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T10:31:06.413

我猜这取决于它们的使用方式。如果异常仅限于单个项目，请将其放在那里。如果多个项目使用它，请将其放在单独的项目中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T11:19:25.537

只要消息字符串是可配置的（属性文件/xml），我就不会打扰。但是，如果异常跨越项目，那么拥有一个通用的顶级接口肯定会有所帮助。

# mysql - 使用 ALTER 删除 MySQL 中存在的列

> ID：173814
> 
> 赞同：108
> 
> 时间：2008-10-06T10:29:16.247
> 
> 标签：mysql, ddl, mysql4

如果该列存在，如何使用 ALTER 删除 MySQL 表中的列？

我知道我可以使用，但如果不存在`ALTER TABLE my_table DROP COLUMN my_column`则会引发错误。`my_column`是否有替代语法有条件地删除列？

我正在使用 MySQL 4.0.18 版。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-10-06T10:31:22.140

**对于 MySQL，没有：** [MySQL Feature Request](http://bugs.mysql.com/bug.php?id=10789)。

无论如何，允许这样做可以说是一个非常糟糕的主意：`IF EXISTS`表明您正在对具有（对您而言）未知结构的数据库进行破坏性操作。在某些情况下，这对于快速而肮脏的本地工作来说是可以接受的，但如果你想对生产数据运行这样的语句（在迁移等中），你就是在玩火。

但是，如果您坚持，首先在客户端中简单地检查是否存在，或者捕获错误并不难。

MariaDB 从 10.0.2 开始还支持以下内容：

```
DROP [COLUMN] [IF EXISTS] col_name 
```

IE

```
ALTER TABLE my_table DROP IF EXISTS my_column; 
```

但可以说，依赖仅由 MySQL 的几个分支之一支持的非标准特性是一个坏主意。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2010-01-22T20:57:03.920

MySQL 中对此没有语言级别的支持。这是 5.0+ 中涉及 MySQL information_schema 元数据的解决方法，但它不会解决您在 4.0.18 中的问题。

```
drop procedure if exists schema_change;

delimiter ';;'
create procedure schema_change() begin

    /* delete columns if they exist */
    if exists (select * from information_schema.columns where table_schema = schema() and table_name = 'table1' and column_name = 'column1') then
        alter table table1 drop column `column1`;
    end if;
    if exists (select * from information_schema.columns where table_schema = schema() and table_name = 'table1' and column_name = 'column2') then
        alter table table1 drop column `column2`;
    end if;

    /* add columns */
    alter table table1 add column `column1` varchar(255) NULL;
    alter table table1 add column `column2` varchar(255) NULL;

end;;

delimiter ';'
call schema_change();

drop procedure if exists schema_change; 
```

[我在博客文章](http://bitkickers.blogspot.com/2010/01/mysql-drop-column-if-exists.html)中写了一些更详细的信息。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2017-08-04T11:40:41.873

我知道这是一个旧线程，但是有一种简单的方法可以在不使用存储过程的情况下处理此要求。这可能会帮助某人。

```
set @exist_Check := (
    select count(*) from information_schema.columns 
    where TABLE_NAME='YOUR_TABLE' 
    and COLUMN_NAME='YOUR_COLUMN' 
    and TABLE_SCHEMA=database()
) ;
set @sqlstmt := if(@exist_Check>0,'alter table YOUR_TABLE drop column YOUR_COLUMN', 'select ''''') ;
prepare stmt from @sqlstmt ;
execute stmt ; 
```

希望这对某人有所帮助，就像我一样（经过大量试验和错误）。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2018-04-05T15:37:55.830

我刚刚构建了一个可重用的过程，可以帮助实现`DROP COLUMN`幂等性：

```
-- column_exists:

DROP FUNCTION IF EXISTS column_exists;

DELIMITER $$
CREATE FUNCTION column_exists(
  tname VARCHAR(64),
  cname VARCHAR(64)
)
  RETURNS BOOLEAN
  READS SQL DATA
  BEGIN
    RETURN 0 < (SELECT COUNT(*)
                FROM `INFORMATION_SCHEMA`.`COLUMNS`
                WHERE `TABLE_SCHEMA` = SCHEMA()
                      AND `TABLE_NAME` = tname
                      AND `COLUMN_NAME` = cname);
  END $$
DELIMITER ;

-- drop_column_if_exists:

DROP PROCEDURE IF EXISTS drop_column_if_exists;

DELIMITER $$
CREATE PROCEDURE drop_column_if_exists(
  tname VARCHAR(64),
  cname VARCHAR(64)
)
  BEGIN
    IF column_exists(tname, cname)
    THEN
      SET @drop_column_if_exists = CONCAT('ALTER TABLE `', tname, '` DROP COLUMN `', cname, '`');
      PREPARE drop_query FROM @drop_column_if_exists;
      EXECUTE drop_query;
    END IF;
  END $$
DELIMITER ; 
```

用法：

```
CALL drop_column_if_exists('my_table', 'my_column'); 
```

例子：

```
SELECT column_exists('my_table', 'my_column');       -- 1
CALL drop_column_if_exists('my_table', 'my_column'); -- success
SELECT column_exists('my_table', 'my_column');       -- 0
CALL drop_column_if_exists('my_table', 'my_column'); -- success
SELECT column_exists('my_table', 'my_column');       -- 0 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-01-28T16:03:50.480

Chase Seibert 的回答有效，但我要补充一点，如果你有几个模式，你想改变 SELECT ：

```
select * from information_schema.columns where table_schema in (select schema()) and table_name=... 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-01-03T06:39:37.300

## 你可以使用这个脚本，使用你的列、模式和表名

```
 IF EXISTS (SELECT *
                         FROM INFORMATION_SCHEMA.COLUMNS
                         WHERE TABLE_NAME = 'TableName' AND COLUMN_NAME = 'ColumnName' 
                                             AND TABLE_SCHEMA = SchemaName)
    BEGIN
       ALTER TABLE TableName DROP COLUMN ColumnName;
    END; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-27T20:18:43.493

也许解决这个问题的最简单方法（可行）是：

*   CREATE new_table AS SELECT id, col1, col2, ... （只有你在最终表中真正想要的列） FROM my_table;

*   将 my_table 重命名为 old_table，将 new_table 重命名为 my_table；

*   删除旧表；

或者，如果需要，保留 old_table 以进行回滚。

这将起作用，但不会移动外键。您必须稍后将它们重新添加到 my_table ；还必须修复引用 my_table 的其他表中的外键（指向新的 my_table）。

祝你好运...

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2011-06-23T12:01:44.653

我意识到这个线程现在已经很老了，但我遇到了同样的问题。这是我使用 MySQL Workbench 的非常基本的解决方案，但效果很好......

1.  获取一个新的 sql 编辑器并执行 SHOW TABLES 以获取表列表
2.  选择所有行，然后从上下文菜单中选择复制到剪贴板（未加引号）
3.  将名称列表粘贴到另一个编辑器选项卡中
4.  编写您的查询，即 ALTER TABLE `x`DROP `a`；
5.  做一些复制和粘贴，所以你最终对每个表都有单独的查询
6.  切换工作台是否应在发生错误时停止
7.  点击执行并查看输出日志

任何有该表的表现在没有任何没有在日志中显示错误的表

然后你可以找到/替换'drop `a`'将它更改为'ADD COLUMN `b`INT NULL'等并再次运行整个事情......

有点笨拙，但最后你得到了最终结果，你可以控制/监控整个过程，并记得保存你的 sql 脚本，以防你再次需要它们。

# c++ - 如何在调试字符串的函数中获取函数名称？

> ID：173821
> 
> 赞同：19
> 
> 时间：2008-10-06T10:31:52.980
> 
> 标签：c++, debugging, qt

我想在每次调用时输出函数名称，我可以轻松地复制和粘贴函数名称，但是我想知道是否有一个快捷方式可以为我完成这项工作？

目前我正在做：

```
SlideInfoHeader* lynxThreeFile::readSlideInfoHeader(QDataStream & in)
{
    qDebug("lynxThreeFile::readSlideInfoHeader");
} 
```

但我想要的是通用的东西：

```
SlideInfoHeader* lynxThreeFile::readSlideInfoHeader(QDataStream & in)
{
    qDebug(this.className() + "::" + this.functionName());
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-06T10:34:28.420

" `__FUNCTION__`" 受 MSVC 和 GCC 支持，应该为您提供所需的信息。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-06T16:28:37.753

我从您的示例中看到您正在使用[Qt](http://qt.nokia.com/)。在这种情况下，您最好的选择是使用`Q_FUNC_INFO`. `<QGlobal>`这是描述：

> 扩展为描述宏所在函数的字符串。该字符串的具体外观取决于编译器。对于 GNU GCC，它通常是函数签名，而对于其他编译器，它可能是行号和列号。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-06T17:31:41.573

如果您使用 gcc，您可能会发现`__PRETTY_FUNCTION__`更多您喜欢的内容。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-06T13:52:41.750

如果您查看 boost，则有一个可跨平台移植的宏 BOOST_CURRENT_FUNCTION。在 C99 标准中，有一个编译器变量`__func__`具有所需的效果。我相信已经被 C++0x 标准所接受。合理数量的编译器已经支持这一点。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-20T08:47:21.237

**`__func__`**是 c99 （这反过来意味着它可能不适用于视觉工作室 - 但嘿，它是标准的：o））

**`__FUNCTION__`**几乎无处不在

**`__PRETTY_FUNCTION__`**特定于 gnu 并返回带有（命名空间？）、类名、返回类型、函数名、参数列表的完整限定名

# javascript - JavaScript、输入流和 DIB？

> ID：173832
> 
> 赞同：0
> 
> 时间：2008-10-06T10:41:35.707
> 
> 标签：javascript, inputstream, dib

是否有任何有用的方法可以将 DIB 加载到输入流中并获取它的句柄以及 JavaScript (js) 中的所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T18:32:42.087

假设 DIB 表示设备独立位图...

如果 DIB 在浏览器中的客户端，那么我认为您不能仅使用浏览器中的 JS 来执行此操作。您将需要一些 java 或 flash 或其他东西，因为浏览器中的 javascript 无法从文件系统中读取内容。

如果 DIB 在服务器上，您可以使用 ajax 请求来获取它。在回调中，将返回的数据复制到一个对象中，然后您可以在其中根据需要操作数据。

处理完图像数据后，您可以使用画布或 img 标签来显示它。

[http://developer.mozilla.org/en/Canvas_tutorial/Using_images](http://developer.mozilla.org/en/Canvas_tutorial/Using_images)

在看到您的问题之前，我没有尝试过这个，但是带有数据 url 的 img 标签非常有趣。在 IE 中使用 img src 中的数据 url 不起作用，但在 FF 和 Opera 中可以。IE 没有画布标签，但它们确实有类似的东西。谷歌的一些聪明人编写了一个 JavaScript 库，通过翻译成 IE 可以理解的东西来启用 IE 中的 canvas 标签。

[http://code.google.com/p/explorercanvas/](http://code.google.com/p/explorercanvas/)

我希望这有帮助。如果没有，也许它至少很有趣。

# c# - 获取表的架构

> ID：173834
> 
> 赞同：7
> 
> 时间：2008-10-06T10:42:15.613
> 
> 标签：c#, sql, sql-server, ado.net, schema

给定一个 SQLConnection 对象，如何获得单个表的架构？

前几天我在尝试这个，我似乎能够从运行查询中获得的 DataSet 中获取模式，但是我可以从连接中获得的所有模式信息似乎都与可用的表有关而不是表格上的实际细节。

我确信有一种简单的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T11:01:51.937

此代码将执行您想要的操作（显然更改表名、服务器名等）：

```
using System;
using System.Collections.Generic;
using System.Text;

using System.Data;
using System.Data.SqlClient;
using System.Data.SqlTypes;

namespace ConsoleApp
{
    class Program
    {
        static void Main(string[] args)
        {
            string query = "SELECT * FROM t where 1=0";
            string connectionString = "initial catalog=test;data source=localhost;Trusted_Connection=Yes";

            DataTable tblSchema;

            using (SqlConnection cnn = new SqlConnection(connectionString))
            {
                using (SqlCommand cmd = cnn.CreateCommand())
                {
                    cmd.CommandText = query;
                    cmd.CommandType = CommandType.Text;
                    cnn.Open();
                    using (SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.KeyInfo))
                    {
                        tblSchema = rdr.GetSchemaTable();
                    }
                    cnn.Close();
                }
            }
            int numColumns = tblSchema.Columns.Count;
            foreach (DataRow dr in tblSchema.Rows)
            {
                Console.WriteLine("{0}: {1}", dr["ColumnName"], dr["DataType"]);
            }

            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-06T10:55:04.977

我认为从查询中访问模式（通过 GetSchemaTable）是唯一的方法。如果您只对架构感兴趣，则可以运行不返回任何行的查询（从 1=2 的表中选择 *）。

您应该使用 KeyInfo CommandBehaviour 来执行源查询，否则不能保证返回的所有信息都是准确的

```
Command.ExecuteReader(CommandBehavior.KeyInfo) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T11:04:46.020

SQL Server - 查询目录视图...如果 SQL 2000 或更早版本，则为 sysobjects、syscolumns 等...如果 SQL 2005 或更高版本，则为 sys.objects、sys.columns 等。（虽然旧视图仍然可用，但建议使用较新的视图）

此处完整参考：http: [//msdn.microsoft.com/en-us/library/ms189783.aspx](http://msdn.microsoft.com/en-us/library/ms189783.aspx)

例子：

```
select so.name, sc.*
from sys.objects as so
inner join sys.columns as sc on sc.object_id = so.object_id
where so.name='some_table' 
```

# javascript - 在 Spry XMLDataset 加载数据时显示加载器

> ID：173835
> 
> 赞同：0
> 
> 时间：2008-10-06T10:42:21.587
> 
> 标签：javascript, spry, xmldataset

我正在使用 Spry ( `SpryData.js,xpath.js`)

```
 var ds1 = new Spry.Data.XMLDataSet("_db/db.xml", "bildiriler/bildiri",{useCache:false});
 // load the xml tree 
```

……

```
<!-- use it in a loop - 
 Sometimes the page use "ds1.loadData();" to refresh the data -->
 <div spry:region="ds1" spry:repeatchildren="ds1">
 <a href="#">{author}</a></div> 
```

那么如何在加载 XML 数据时显示加载器动画或“加载文本”

（从慢速 CD 需要很长时间 - 大约 2 秒 -。我的 XML 文件很大 100KB ）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T10:54:02.187

我不太擅长 Spry，但你不能在 div 占位符 (<div spry:region="ds1" ...) 中添加 CSS 背景，它会一直显示（并且可能可以通过在加载行时设置占位符的背景图像的观察者）...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T13:38:32.323

是的。我找到了它（奇怪的是，不是来自[http://labs.adobe.com/technologies/spry](http://labs.adobe.com/technologies/spry)上的 Spry 文档）我是从这个例子中找到的 -> [http://www.infoaccelerator.net/blog/archives.cfm /日期/2006/7](http://www.infoaccelerator.net/blog/archives.cfm/date/2006/7)

我将此行放入 div 标签 (spry:region) ：

```
<p spry:state ="loading"> Loading ( text or an image ) </p> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-28T08:35:23.627

```
<div align="center" spry:region="dsmain" spry:state="loading" >
<img src="../icon/Loader/1.gif" />
<br />please wait ...
</div> 
```

# .net - 双滑块控制.net

> ID：173841
> 
> 赞同：5
> 
> 时间：2008-10-06T10:46:46.117
> 
> 标签：.net, winforms, controls, slider

有没有人见过一个很好的.Net（Win 表单或 WPF）双滑块控件。

我正在寻找可以让我从一组中选择一个范围的东西，因此第一个滑块将是范围的开始，第二个将是结束。

我记得看到过 Swing 双滑块，但那是 6 年前的事了，我这辈子都不记得是谁做的了。虽然它是开源的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T13:33:57.153

Devexpress 有一个很好的：

RangeTrackBarControl 控件扩展了 TrackBarControl 提供的功能，使最终用户能够选择一系列值。两个滑块可用于设置最小值和最大值：

[替代文字 http://www.devexpress.com/Help/XtraEditors/img/RangeTrackBarControl.png](http://www.devexpress.com/Help/XtraEditors/img/RangeTrackBarControl.png)

您可以从以下位置免费获得它们：

[http://www.devexpress.com/Products/Free/WebRegistration/](http://www.devexpress.com/Products/Free/WebRegistration/)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-30T20:19:05.530

出于某种原因，我无法评论之前的答案。DevExpress 似乎不再提供任何免费控件。只有 30 天免费试用。

# java - 如何在 Struts 2 中进行动态 URL 重定向？

> ID：173846
> 
> 赞同：28
> 
> 时间：2008-10-06T10:48:23.790
> 
> 标签：java, url, redirect, struts2

我试图让我的 Struts2 应用程序重定向到生成的 URL。在这种情况下，我希望 URL 使用当前日期，或者我在数据库中查找的日期。所以`/section/document`变成`/section/document/2008-10-06`

最好的方法是什么？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-10-07T16:15:35.173

我们是这样做的：

在 Struts.xml 中，有一个动态结果，例如：

```
<result name="redirect" type="redirect">${url}</result> 
```

在行动中：

```
private String url;

public String getUrl()
{
 return url;
}

public String execute()
{
 [other stuff to setup your date]
 url = "/section/document" + date;
 return "redirect";
} 
```

实际上，您可以使用相同的技术使用 OGNL 为 struts.xml 中的任何变量设置动态值。我们已经创建了各种动态结果，包括 RESTful 链接之类的东西。酷的东西。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-30T11:16:56.930

也可以使用`annotations`和 Convention 插件来避免 struts.xml 中的重复配置：

```
@Result(location="${url}", type="redirect") 
```

${url} 表示“使用 getUrl 方法的值”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-17T05:56:28.513

如果有人想直接重定向`ActionClass`：

```
public class RedirecActionExample extends ActionSupport {
HttpServletResponse response=(HttpServletResponse) ActionContext.getContext().get(ServletActionContext.HTTP_RESPONSE);

    url="http://localhost:8080/SpRoom-1.0-SNAPSHOT/"+date;
    response.sendRedirect(url);
    return super.execute(); 
} 
```

编辑：添加了一个缺少的报价。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T12:43:06.540

我最终继承了 Struts'`ServletRedirectResult`并在调用之前覆盖了它的`doExecute()`方法来执行我的逻辑`super.doExecute()`。它看起来像这样：

```
public class AppendRedirectionResult extends ServletRedirectResult {
   private DateFormat df = new SimpleDateFormat("yyyy-MM-dd");

  @Override
  protected void doExecute(String finalLocation, ActionInvocation invocation) throws Exception {
    String date = df.format(new Date());
    String loc = "/section/document/"+date;
    super.doExecute(loc, invocation);
  }
} 
```

我不确定这是否是最好的方法，但它确实有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-22T15:17:06.217

您可以使用注释重定向到另一个操作 -

```
@Result(
    name = "resultName",
    type = "redirectAction",
    params = { "actionName", "XYZAction" }
) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-03T13:07:58.483

可以直接从拦截器重定向，而无需考虑涉及哪个操作。

**在 struts.xml 中**

```
 <global-results>
        <result name="redir" type="redirect">${#request.redirUrl}</result>
    </global-results> 
```

**在拦截器中**

```
@Override
public String intercept(ActionInvocation ai) throws Exception
{
    final ActionContext context = ai.getInvocationContext();        
    HttpServletRequest request = (HttpServletRequest)context.get(StrutsStatics.HTTP_REQUEST);
    request.setAttribute("redirUrl", "http://the.new.target.org");
    return "redir";
} 
```

# php - 确定 PHP 脚本的命令行与 http 执行的规范方法是什么？

> ID：173851
> 
> 赞同：163
> 
> 时间：2008-10-06T10:51:04.267
> 
> 标签：php, http, command-line, command-line-interface

我有一个 PHP 脚本，需要确定它是通过命令行还是通过 HTTP 执行的，主要用于输出格式化目的。这样做的规范方法是什么？我原以为是要检查`SERVER['argc']`，但事实证明这是填充的，即使使用“Apache 2.0 处理程序”服务器 API 也是如此。

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2008-10-06T11:07:22.160

使用该[`php_sapi_name()`](http://php.net/php_sapi_name)功能。

```
if (php_sapi_name() == "cli") {
    // In cli-mode
} else {
    // Not in cli-mode
} 
```

以下是文档中的一些相关说明：

> **php_sapi_name** — 返回 Web 服务器和 PHP 之间的接口类型
> 
> 尽管并非详尽无遗，但可能的返回值包括 aolserver、apache、apache2filter、apache2handler、caudium、cgi（直到 PHP 5.3）、cgi-fcgi、cli、cli-server、continuity、embed、isapi、litespeed、milter、nsapi、phttpd、 pi3web、roxen、thttpd、tux 和 webjames。

在 PHP >= 4.2.0 中，还有一个预定义常量 ，`PHP_SAPI`它的值与`php_sapi_name()`.

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2010-12-08T22:08:38.547

这将始终有效。（如果 PHP 版本是 4.2.0 或更高版本）

```
define('CLI', PHP_SAPI === 'cli'); 
```

这使得在脚本顶部易于使用：

```
<?php PHP_SAPI === 'cli' or die('not allowed'); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-29T17:36:42.713

这是 Drupal 7 的实现：[drupal_is_cli()](http://api.drupal.org/api/drupal/includes!bootstrap.inc/function/drupal_is_cli/7)：

```
function drupal_is_cli() {
  return (!isset($_SERVER['SERVER_SOFTWARE']) && (php_sapi_name() == 'cli' || (is_numeric($_SERVER['argc']) && $_SERVER['argc'] > 0)));
} 
```

但是 Drupal 8[建议](https://www.drupal.org/node/2295037)使用`PHP_SAPI === 'cli'`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-06T10:53:32.190

我认为

```
$_SERVER['REMOTE_ADDR'] 
```

不会从 CLI 填充。

此外，$_SERVER 超全局变量中的所有 HTTP_* 键都不会从 CLI 中填充，或者按照刚才提到的正确方式进行操作 :-)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-08-05T18:51:14.570

`php_sapi`_name的文档页面清楚地说明了它是如何工作的：

> 返回描述 PHP 正在使用的接口类型（服务器 API、SAPI）的小写字符串。
> 
> 虽然并不详尽，但可能的返回值包括 aolserver、apache、apache2filter、apache2handler、caudium、cgi（直到 PHP 5.3）、cgi-fcgi、cli、continuity、embed、isapi、litespeed、milter、nsapi、phttpd、pi3web、roxen、 thttpd、tux 和 webjames。

我不确定为什么 hop 认为 PHP 不适合认真的程序员（我是认真的程序员，我每天都使用 PHP），但如果他想帮助澄清文档，那么也许他可以审核所有可能的 Web 服务器PHP 可以在其上运行并确定每个服务器的所有可能接口类型的名称。只要确保在添加新的 Web 服务器和接口时更新该列表即可。

此外，鲍比说：

> 我很好奇为什么是医生。示例检查前 3 个字符，而描述说明该字符串应完全为“CGI”

该示例的描述指出：

> 此示例检查子字符串 cgi，因为它也可能是 cgi-fcgi。

# jquery - jQuery：IE6 中的窗口控件存在问题

> ID：173866
> 
> 赞同：2
> 
> 时间：2008-10-06T10:59:15.093
> 
> 标签：jquery, internet-explorer-6, dialog, shim

我有一个包含选择框的网页。当我打开一个 jQuery 对话框时，它部分显示在选择框的后面。

我应该如何解决这个问题？我应该隐藏选择框还是 jQuery 提供某种“垫片”解决方案。（我用谷歌搜索但没有找到任何东西）

这是一些代码：

```
<!DOCTYPE html>
<html lang="en">
<head>
<title>testJQuery</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="GENERATOR" content="Rational Application Developer">

        <link rel="stylesheet" href="theme/smooth/theme.css" type="text/css" media="screen" />
</head>
<body>

    <a class="pop" href="nix">Click me</a>

    <p/>

    <select size="20">
        <option>s jl fjlkdjfldjf l*s ldkjsdlfkjsdl fkdjlfks dfldkfjdfkjlsdkf jdksdjf sd</option>
        <option>s jl fjlkdjfldjf l*s ldkjsdlfkjsdl fkdjlfks dfldkfjdfkjlsdkf jdksdjf sd</option>
        <option>s jl fjlkdjfldjf l*s ldkjsdlfkjsdl fkdjlfks dfldkfjdfkjlsdkf jdksdjf sd</option>
        <option>s jl fjlkdjfldjf l*s ldkjsdlfkjsdl fkdjlfks dfldkfjdfkjlsdkf jdksdjf sd</option>
        <option>s jl fjlkdjfldjf l*s ldkjsdlfkjsdl fkdjlfks dfldkfjdfkjlsdkf jdksdjf sd</option>
    </select>

    <div id="xyz" class="flora hiddenAsset">
        <div id="dialog" title="Edit Link">
            <p>Enter the link details:</p>
            <table width="80%" border="1">
                <tr><td>URL</td><td><input id="url" style="width:100%" maxlength="200" value="{url}"/></td></tr>
                <tr><td>Title</td><td><input id="title" style="width:100%" maxlength="200" value="{title}"/></td></tr>
                <tr><td>Target</td><td><input id="target" size="20" maxlength="200" value="{target}"/></td></tr>
            </table>
        </div>
    </div>

<script type="text/javascript" src="../script/firebug/firebug.js"></script>
<script type="text/javascript" src="jquery-1.2.6.js"></script>
<script type="text/javascript" src="jquery-ui-1.5.2.js"></script>
<script type="text/javascript" src="jqSOAPClient.js"></script>
<script type="text/javascript">
(function($){
    $(document).ready(function(){
        console.debug('ready');
        $('.hiddenAsset').hide();

        $('a.pop').bind('click', showDialog);
        console.debug('ready - done');
    });

    var showDialog = function(){
        console.debug('show');
        $('#dialog').dialog({
            modal: true,
            overlay: {
                backgroundColor: '#666',
                opacity: '.3',
                filter: 'alpha(opacity=30)'
            },
            width: '400px',
            height: '300px',
            buttons: {
                Ok: function() {
                    $(this).dialog('close');
                },
                Cancel: function() {
                    $(this).dialog('close');
                }
            }
        });
        console.debug('show-done');
        return false;
    };
})(jQuery);
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T11:09:29.473

这与 jQuery 没有任何关系。这是 IE 6 中的一个已知错误 - Windows 原生选择框总是出现在其他元素之上。您唯一能做的就是在选择框被遮盖时隐藏它们 - 通常用看起来像选择框的东西替换它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T14:17:01.530

我最终找到了一个有帮助的插件 - [bgiframe](http://plugins.jquery.com/project/bgiframe)奇怪的是它可以作为插件使用。为什么它没有集成在主 UI 中？！

试过了，但不幸的是，它搞砸了我的对话！对话框内容全部向左移动 30-40 像素 :-( 。下一个问题...

# php - 如何在 PHP 中获取文件的扩展名？

> ID：173868
> 
> 赞同：816
> 
> 时间：2008-10-06T11:00:02.957
> 
> 标签：php, file-extension

这是一个您可以在网络上随处阅读的问题，并提供各种答案：

```
$ext = end(explode('.', $filename));
$ext = substr(strrchr($filename, '.'), 1);
$ext = substr($filename, strrpos($filename, '.') + 1);
$ext = preg_replace('/^.*\.([^.]+)$/D', '$1', $filename);

$exts = split("[/\\.]", $filename);
$n    = count($exts)-1;
$ext  = $exts[$n]; 
```

等等

然而，总有“最好的方法”，它应该在 Stack Overflow。

* * *

## 回答 #1

> 赞同：1889
> 
> 时间：2008-10-06T11:03:24.493

来自其他脚本语言的人总是认为他们的更好，因为他们有一个内置函数可以做到这一点，而不是 PHP（我现在正在看 Pythonistas :-)）。

事实上，它确实存在，但很少有人知道。见面[`pathinfo()`](http://php.net/manual/en/function.pathinfo.php)：

```
$ext = pathinfo($filename, PATHINFO_EXTENSION); 
```

这是快速且内置的。`pathinfo()`可以为您提供其他信息，例如规范路径，具体取决于您传递给它的常量。

请记住，如果您希望能够处理非 ASCII 字符，则需要先设置语言环境。例如：

```
setlocale(LC_ALL,'en_US.UTF-8'); 
```

另外，请注意，这不考虑文件内容或 mime 类型，您只会获得扩展名。但这是你要求的。

最后，请注意这仅适用于文件路径，而不适用于使用 PARSE_URL 涵盖的 URL 资源路径。

享受

* * *

## 回答 #2

> 赞同：184
> 
> 时间：2008-10-06T11:02:33.590

[`pathinfo()`](http://uk.php.net/manual/en/function.pathinfo.php)

```
$path_info = pathinfo('/foo/bar/baz.bill');

echo $path_info['extension']; // "bill" 
```

* * *

## 回答 #3

> 赞同：117
> 
> 时间：2015-07-17T12:39:31.847

示例网址：**`http://example.com/myfolder/sympony.mp3?a=1&b=2#XYZ`**

A）*不要使用建议的 unsafe[**`PATHINFO`**](http://php.net/manual/en/function.pathinfo.php#example-2610)*：

```
pathinfo($url)['dirname']    'http://example.com/myfolder'
pathinfo($url)['basename']   'sympony.mp3?a=1&b=2#XYZ'         // <------- BAD !!
pathinfo($url)['extension']  'mp3?a=1&b=2#XYZ'                 // <------- BAD !!
pathinfo($url)['filename']   'sympony' 
```

B）使用[PARSE_URL](http://php.net/manual/en/function.parse-url.php#refsect1-function.parse-url-examples)：

```
parse_url($url)['scheme']    'http'
parse_url($url)['host']      'example.com'
parse_url($url)['path']      '/myfolder/sympony.mp3'
parse_url($url)['query']     'aa=1&bb=2'
parse_url($url)['fragment']  'XYZ' 
```

奖励：查看[所有原生 PHP 示例](https://stackoverflow.com/questions/6768793/get-the-full-url-in-php/26944636#26944636)

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2012-10-17T10:32:32.363

还有[`SplFileInfo`](http://php.net/SplFileInfo)：

```
$file = new SplFileInfo($path);
$ext  = $file->getExtension(); 
```

如果传递这样的对象而不是字符串，通常可以编写更好的代码。你的代码更有说服力。从 PHP 5.4 开始，这是一个单行代码：

```
$ext  = (new SplFileInfo($path))->getExtension(); 
```

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2020-04-07T11:34:49.777

## 做的更快！

换句话说，如果您只使用文件名，请停止使用 pathinfo。

我的意思是，如果你有一个*完整的 pathname*， pathinfo 是有意义的，因为它比仅仅查找点更聪明：路径可以包含点，而文件名本身可能没有。所以在这种情况下，考虑像 , pathinfo 这样的输入字符串`d:/some.thing/myfile`和其他配备齐全的方法是一个不错的选择。

但是如果你只有一个没有路径的*文件名*，那么让系统工作得比它需要的更多是毫无意义的。这可以为您**提供 10 倍的速度提升**。

这是一个快速的速度测试：

```
/*   387 ns */ function method1($s) {return preg_replace("/.*\./","",$s);} // edge case problem
/*   769 ns */ function method2($s) {preg_match("/\.([^\.]+)$/",$s,$a);return $a[1];}
/*    67 ns */ function method3($s) {$n = strrpos($s,"."); if($n===false) return "";return substr($s,$n+1);}
/*   175 ns */ function method4($s) {$a = explode(".",$s);$n = count($a); if($n==1) return "";return $a[$n-1];}
/*   731 ns */ function method5($s) {return pathinfo($s, PATHINFO_EXTENSION);}
/*   732 ns */ function method6($s) {return (new SplFileInfo($s))->getExtension();}

//  All measured on Linux; it will be vastly different on Windows 
```

Those nanosecond values will obviously differ on each system, but they give a clear picture about proportions. `SplFileInfo` and `pathinfo` are great fellas, but for this kind of job it's simply not worth it to wake them up. For the same reason, `explode()` is considerably faster than regex. Very simple tools tend to beat more sophisticated ones.

### Conclusion

This seems to be the Way of the Samurai:

```
function fileExtension($name) {
    $n = strrpos($name, '.');
    return ($n === false) ? '' : substr($name, $n+1);
} 
```

*Remember this is for simple filenames only. If you have paths involved, stick to pathinfo or deal with the dirname separately.*

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2008-10-06T14:23:33.620

E-satis 的响应是确定文件扩展名的正确方法。

[或者，您可以使用fileinfo](http://us2.php.net/fileinfo)来确定文件的 MIME 类型，而不是依赖文件扩展名。

这是处理用户上传的图像的简化示例：

```
// Code assumes necessary extensions are installed and a successful file upload has already occurred

// Create a FileInfo object
$finfo = new FileInfo(null, '/path/to/magic/file');

// Determine the MIME type of the uploaded file
switch ($finfo->file($_FILES['image']['tmp_name'], FILEINFO_MIME)) {        
    case 'image/jpg':
        $im = imagecreatefromjpeg($_FILES['image']['tmp_name']);
    break;

    case 'image/png':
        $im = imagecreatefrompng($_FILES['image']['tmp_name']);
    break;

    case 'image/gif':
        $im = imagecreatefromgif($_FILES['image']['tmp_name']);
    break;
} 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2012-08-11T12:42:33.573

只要它不包含路径，您也可以使用：

```
array_pop(explode('.', $fname)) 
```

文件名在哪里`$fname`，例如：`my_picture.jpg`. 结果将是：`jpg`

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2014-08-02T07:52:06.087

**1)**如果您使用的是**(PHP 5 >= 5.3.6)** ，您可以使用**[SplFileInfo::getExtension](http://php.net/manual/en/splfileinfo.getextension.php) — 获取文件扩展名**

示例代码

```
<?php

$info = new SplFileInfo('test.png');
var_dump($info->getExtension());

$info = new SplFileInfo('test.tar.gz');
var_dump($info->getExtension());

?> 
```

这将输出

```
string(3) "png"
string(2) "gz" 
```

**2)如果您正在使用****(PHP 4 >= 4.0.3, PHP 5)，**另一种获取扩展的方法是[**pathinfo**](http://php.net/manual/en/function.pathinfo.php)

示例代码

```
<?php

$ext = pathinfo('test.png', PATHINFO_EXTENSION);
var_dump($ext);

$ext = pathinfo('test.tar.gz', PATHINFO_EXTENSION);
var_dump($ext);

?> 
```

这将输出

```
string(3) "png"
string(2) "gz" 
```

// 编辑：删除了一个括号

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2012-11-01T18:11:18.010

有时不使用`pathinfo($path, PATHINFO_EXTENSION)`. 例如：

```
$path = '/path/to/file.tar.gz';

echo ltrim(strstr($path, '.'), '.'); // tar.gz
echo pathinfo($path, PATHINFO_EXTENSION); // gz 
```

另请注意，`pathinfo`无法处理一些非 ASCII 字符（通常它只是从输出中抑制它们）。在通常不是问题的扩展中，但意识到这一警告并没有什么坏处。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2015-05-13T06:44:32.500

在 PHP 中获取文件扩展名的最简单方法是使用 PHP 的内置函数[pathinfo](http://php.net/manual/en/function.pathinfo.php)。

```
$file_ext = pathinfo('your_file_name_here', PATHINFO_EXTENSION);
echo ($file_ext); // The output should be the extension of the file e.g., png, gif, or html 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2017-02-12T05:40:13.617

你也可以试试这个（它适用于 PHP 5.* 和 7）：

```
$info = new SplFileInfo('test.zip');
echo $info->getExtension(); // ----- Output -----> zip 
```

提示：如果文件没有扩展名，则返回一个空字符串

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2019-07-20T15:51:57.537

## 抱歉...“简短的问题；但不是简短的答案”

**PATH 示例 1**

```
$path = "/home/ali/public_html/wp-content/themes/chicken/css/base.min.css";
$name = pathinfo($path, PATHINFO_FILENAME);
$ext  = pathinfo($path, PATHINFO_EXTENSION);
printf('<hr> Name: %s <br> Extension: %s', $name, $ext); 
```

**URL 示例 2**

```
$url = "//www.example.com/dir/file.bak.php?Something+is+wrong=hello";
$url = parse_url($url);
$name = pathinfo($url['path'], PATHINFO_FILENAME);
$ext  = pathinfo($url['path'], PATHINFO_EXTENSION);
printf('<hr> Name: %s <br> Extension: %s', $name, $ext); 
```

示例 1 的输出：

```
Name: base.min
Extension: css 
```

示例 2 的输出：

```
Name: file.bak
Extension: php 
```

## 参考

1.  [https://www.php.net/manual/en/function.pathinfo.php](https://www.php.net/manual/en/function.pathinfo.php)

2.  [https://www.php.net/manual/en/function.realpath.php](https://www.php.net/manual/en/function.realpath.php)

3.  [https://www.php.net/manual/en/function.parse-url.php](https://www.php.net/manual/en/function.parse-url.php)

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2015-02-25T23:22:17.000

这是一个例子。假设 $filename 是“example.txt”，

```
$ext = substr($filename, strrpos($filename, '.', -1), strlen($filename)); 
```

所以 $ext 将是“.txt”。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2016-06-03T04:43:04.233

[pathinfo](http://php.net/manual/en/function.pathinfo.php)是一个数组。我们可以查看**目录名、文件名、扩展名**等：

```
$path_parts = pathinfo('test.png');

echo $path_parts['extension'], "\n";
echo $path_parts['dirname'], "\n";
echo $path_parts['basename'], "\n";
echo $path_parts['filename'], "\n"; 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2013-12-05T11:13:42.490

```
substr($path, strrpos($path, '.') + 1); 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2015-05-26T09:29:54.553

快速修复将是这样的。

```
// Exploding the file based on the . operator
$file_ext = explode('.', $filename);

// Count taken (if more than one . exist; files like abc.fff.2013.pdf
$file_ext_count = count($file_ext);

// Minus 1 to make the offset correct
$cnt = $file_ext_count - 1;

// The variable will have a value pdf as per the sample file name mentioned above.
$file_extension = $file_ext[$cnt]; 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2016-05-24T09:53:55.377

你也可以试试这个：

```
 pathinfo(basename($_FILES["fileToUpload"]["name"]), PATHINFO_EXTENSION) 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2015-01-20T20:40:36.697

我发现`pathinfo()`and`SplFileInfo`解决方案适用于本地文件系统上的标准文件，但是如果您使用远程文件，则可能会遇到困难，因为有效图像的 URL 可能具有`#`（片段标识符）和/或`?`（查询参数）在 URL 的末尾，这两种解决方案都将（不正确）视为文件扩展名的一部分。

`pathinfo()`我发现这是在第一次解析 URL 以去除文件扩展名后不必要的混乱之后在 URL上使用的可靠方法：

```
$url_components = parse_url($url); // First parse the URL
$url_path = $url_components['path']; // Then get the path component
$ext = pathinfo($url_path, PATHINFO_EXTENSION); // Then use pathinfo() 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2016-10-17T05:09:51.103

使用`substr($path, strrpos($path,'.')+1);`. 这是所有比较中最快的方法。

@Kurt Zhong 已经回答了。

让我们在这里检查比较结果：[https ://eval.in/661574](https://eval.in/661574)

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2019-07-16T22:24:51.273

```
ltrim(strstr($file_url, '.'), '.') 
```

> 如果您有像 name.name.name.ext 这样的文件名，这是最好的方法（丑陋，但有时会发生

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2015-01-15T10:12:23.017

这将起作用

```
$ext = pathinfo($filename, PATHINFO_EXTENSION); 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2016-05-04T05:35:14.460

您可以获取特定文件夹中的所有文件扩展名并使用特定文件扩展名进行操作：

```
<?php
    $files = glob("abc/*.*"); // abc is the folder all files inside folder
    //print_r($files);
    //echo count($files);
    for($i=0; $i<count($files); $i++):
         $extension = pathinfo($files[$i], PATHINFO_EXTENSION);
         $ext[] = $extension;
         // Do operation for particular extension type
         if($extension=='html'){
             // Do operation
         }
    endfor;
    print_r($ext);
?> 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2019-04-05T16:19:03.577

IMO，如果您有像 name.name.name.ext 这样的文件名（丑陋，但有时会发生），这是最好的方法：

```
$ext     = explode('.', $filename); // Explode the string
$my_ext  = end($ext); // Get the last entry of the array

echo $my_ext; 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-09-14T16:50:48.760

`$ext = preg_replace('/^.*\.([^.]+)$/D', '$1', $fileName);`

preg_replace 方法我们使用正则表达式搜索和替换。在 preg_replace 函数中，第一个参数是搜索的模式，第二个参数 $1 是对第一个 (.*) 匹配的任何内容的引用，第三个参数是文件名。

另一种方式，我们也可以使用 strrpos 来查找最后一次出现 '.' 的位置。在文件名中并将该位置增加 1，以便它将从 (.)

`$ext = substr($fileName, strrpos($fileName, '.') + 1);`

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-09-09T13:54:18.230

如果您正在寻找速度（例如在路由器中），您可能不想标记所有内容。许多其他答案将失败`/root/my.folder/my.css`

```
ltrim(strrchr($PATH, '.'),'.'); 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2018-08-05T15:33:57.667

尽管“最佳方式”值得商榷，但我相信这是最好的方式，原因如下：

```
function getExt($path)
{
    $basename = basename($path);
    return substr($basename, strlen(explode('.', $basename)[0]) + 1);
} 
```

1.  它适用于扩展的多个部分，例如`tar.gz`
2.  简短高效的代码
3.  它适用于文件名和完整路径

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-03-28T14:18:24.253

其实，我就是在找那个。

```
<?php

$url = 'http://example.com/myfolder/sympony.mp3?a=1&b=2#XYZ';
$tmp = @parse_url($url)['path'];
$ext = pathinfo($tmp, PATHINFO_EXTENSION);

var_dump($ext); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-01-07T13:14:08.690

I tried one simple solution it might help to someone else to get just filename from the URL which having get parameters

```
<?php

$path = "URL will be here";
echo basename(parse_url($path)['path']);

?> 
```

Thanks

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2012-11-28T12:05:26.560

采用

```
str_replace('.', '', strrchr($file_name, '.')) 
```

用于快速检索扩展名（如果您确定您的文件名有一个）。

# c++ - 为什么 c++ ifstreams 不能从设备读取？

> ID：173870
> 
> 赞同：3
> 
> 时间：2008-10-06T11:01:24.340
> 
> 标签：c++, macos, gcc, fstream

我知道我不应该开始使用 c++ io，整个“类型安全”论点是一个红鲱鱼（有人*真的*发现这是他们最紧迫的问题之一吗？）。无论如何，我做到了，并发现了 ifstreams 和 FILE*s 以及普通的旧文件描述符之间的一个奇怪区别：ifstreams 无法从设备中读取。谁能想到一个原因？

```
const char* path = "/dev/disk3";
char        b;

// this works
FILE* f= fopen(path, "rb");
int i = fread(&b, 1, 1, f);     // returns 1, success!

// this does not work
ifstream    cf(path, ios::binary);
cf.read(&b, 1);
bool        good = cf.good();   // returns false, failure. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T13:24:37.720

对我来说效果很好，这不是您认为的 C++ 流文件 I/O 固有的问题。

也许尝试添加`ios::in`到 openmode 标志。根据标准的 27.8.1.6，它需要或与 ios::in 一起使用，所以这可能不会做任何事情。

尝试检查实际设置了哪个位 - 而不是调用 good()，尝试分别检查 bad()、eof() 和 fail()。这可能会提供有关错误是什么的线索。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T01:15:43.307

该设备是无缓冲的，必须以 512 字节的倍数读取。ifstream 做它自己的缓冲并且奇怪地决定提前读取*1023*个字节，但由于“无效参数”而失败。有趣的是，这个 ifstream 是在 FILE* 之上实现的。但是，留给自己设备的 FILE* 使用更好、更圆的字节数进行预读。

感谢 dtrace 提供重要线索。我想我们永远不会知道那些认为他们知道答案但不想说的人是否正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T12:39:01.383

多年来，我在 C++ I/O 中发现了类似的随机问题。对我来说，这似乎是一种倒退。

我还没有尝试过，但你可能想看看 Boost 提供了什么：

[http://www.boost.org/doc/libs/1_36_0/libs/iostreams/doc/index.html](http://www.boost.org/doc/libs/1_36_0/libs/iostreams/doc/index.html)

# security - 你如何保护代码不泄露出去？

> ID：173875
> 
> 赞同：17
> 
> 时间：2008-10-06T11:03:16.023
> 
> 标签：security, project-management, source-code-protection

除了开源您的项目和立法之外，是否有办法防止或至少将代码泄露到您的公司/集团之外的损失降到最低？

我们显然不能阻止 Internet 访问（以防止通过电子邮件发送代码），因为程序员需要他们的参考。我们也不能阻止外围设备（USB、Firewire 等）

当代码具有一些专有算法和内部开发的知识时（与绘制 GUI、连接到数据库等的常规常规代码相反），代码最重要，但某些应用程序（如会计软件和 CRM）就是这样：复杂原则上易于开发的例程代码集合，但从头开始编写需要数年时间。这就是泄露代码对竞争对手有用的地方。

在我看来，防止泄漏几乎完全依赖于人的过程。你怎么看？您采取了哪些预防措施和措施？代码泄露之前有影响过你吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-06T11:09:09.740

你无法阻止它出来。所以有两个解决方案 - 阻止人们想要伤害你，并采取法律预防措施。为了阻止人们讨厌你，你要正确对待他们（说更多可能与堆栈溢出无关）。

我不是律师，但为了给自己提供法律保护，如果你相信它，请为这些想法申请专利，在代码中添加版权声明，并确保你的程序员的合同仔细指定了知识产权。

但归根结底，答案比竞争对手跑得更快。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-06T11:14:13.067

除非您正在使用高度机密的东西，并且鉴于您无法阻止电子邮件和 USB 设备，否则我猜您不会，即使源代码泄漏，也不会造成太大的损害。问题是，如果不了解代码的工作原理和周围的组织，代码或其中的部分价值是多少。

一般来说，“资源”的价值远低于通常吹捧的，基本上没有人员或组织的资源不值得竞争对手占用的存储空间。

此外，您错过了最有可能的攻击媒介，而且它也是您无论如何都无法阻止的攻击媒介。如果有人真的想知道你是如何创造魔法的，那么他们会试图雇佣你的开发人员，因为你无法阻止他们在他们的头骨中获取信息，即使他们交出所有的知识和领域专业知识与他们一起离开。基本上，员工保留和信任是唯一的方法。对不起。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-06T15:01:00.037

我不知道这会有多少实际帮助，但是：

1.  不要让你的程序员失望。不要让他们处于*想要*将资源提供给竞争对手的位置。大多数地方都低估了他们的开发商。鉴于你在哪里（SO），我想你不太可能。没有什么比看到销售人员出去打高尔夫球更让我感动的了——公司付了钱，而且还付了钱——而我们不得不每个月去争取一次披萨。

2.  真的，如果你的直接竞争对手*今天*拿到了你的代码，它会做什么？您的产品或垂直市场是否停滞不前，以至于您不会在他们做出反应之前发布更新、更好的版本？没有创新的空间吗？大多数公司高估了他们的“专有算法和内部开发的知识”。当然，它可能会减少一些时间，但这只是问题的 10% 左右。

3.  如果您获得了所有竞争对手产品的所有来源，那么实际使用量会是多少？我猜这会让你倒退几个月。不前进。后退。

**如果您有一个干净的系统，并且几乎没有外部/内部知识，那么您需要多长时间才能让自己的产品进入可构建状态？深入研究代码并确定发生了什么需要多长时间？**你会浪费多少时间和金钱来解决问题，而不是花时间和金钱来让*你的*产品更好地工作？

实际上，我一直处于拥有竞争对手产品的所有源代码（超过 100 万行代码）的位置。我们没有对它做任何事情——除了一点点闲逛然后删除它，这让我感到不舒服——但我希望我们会花几个月的时间来到达他们所在的地方然后。

所以我们对它进行了核爆，打了得到它的 id10t（是的，一个从另一家公司过来的开发人员/PM），并考虑如何让*我们的*产品踢得这么厉害，以至于他们做了什么并不重要。更好地利用时间。工作得也很好。我们有差异化因素，而不仅仅是以与他们相同的方式重新散列相同的特征。

抱歉，但你*无法*阻止人们把东西拿出来，并且仍然能够实际工作。你可以阻止他们*想*要这样做，或者让他们这样做对他们来说没有任何价值。

我们也担心人们反编译我们的代码。当我们意识到我们很难弄清楚与 MAPI/Exchange 对话的 500K+ 行 C#、C++ 和 HTML 代码中发生了什么时，我们就不再担心了。如果有人可以反编译并解决它，那么我们想雇用他们......

顺便说一句，为了清楚起见，考虑到我现在为谁工作，我应该指出这*不是*我现在的雇主。这是很久以前的事了。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-06T11:15:11.897

代码不会自行泄漏。它需要人们接受它。显然，您可能会使用一些安全措施，例如流量分析和存储库锁定，因此只有授权的开发人员才能连接到它。

但最终你最好的选择是确保没有人想从你那里偷东西。你的团队必须快乐，他们必须为为你工作而自豪，他们必须忠于公司和彼此。如果你有这样的团队，这是一个简单的问题，就是向每个人解释代码必须免受外人的影响。它不会阻止专门的痣，但会防止事故发生。

PS 是的，合同中的适当条款也不会造成伤害，至少他们会确保开发人员意识到将代码带到外面在道德上是错误的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-06T11:12:17.813

遵循这些准则，如果整个源代码存储库的内容都发布在 stackoverflow 上，这无关紧要：

[http://geocities.com/mdetting/unmaintainable.html](http://geocities.com/mdetting/unmaintainable.html)

哦，通过阻止对部分源代码的访问、扫描传出/传入的电子邮件等，向你的开发人员表明你不信任他们。这是让他们想要留下来的可靠方法………​​…没有什么改善士气就像在工作场所有点不信任。

另一种很酷的方法是告诉一半他们是“团队 a”，而将另一半命名为不值得信任的“团队 b”。然后反过来，对“b组”成员说同样的话。鼓励他们密切关注其他团队中的“坏人”，并向您报告任何不忠的迹象。撒上一些“冲突诱导剂”（例如告诉“Joe”：'*你知道 Ed 在你背后怎么说你吗？* '）等等。如果你让开发人员互相对抗并创建一些 [发明者-你] 冲突在这里和那里......

（嗯，不，我实际上不推荐上述任何一种。开玩笑。但我看到人们使用了上述所有策略。但它没有奏效。）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-06T16:45:22.267

好的，我将在这里有点实际。

*   对每个人都好，并希望他们不会伤害你是行不通的。

每个程序员从他加入公司的那一天起就知道他不会永远呆在那里。当他学会了足够多的东西以获得更好的机会时，他就会改变。

编写代码的程序员相信他们拥有代码的所有权，即使他们是在出租给其他人时编写代码的。他们中的许多人通常会尝试获取源代码，即使他们不打算伤害任何人。

一旦他们离开公司，随身携带源代码，与同事失去联系，良心安定下来，去度假，一段时间后，代码中的点点滴滴开始到处出现。

这就是我知道会发生的事情，因为我亲眼目睹了它发生在我的公司身上。

那么一个人做什么呢？

*   签署一份保密协议，特别提到他们的程序员不会复制。
*   在程序员之间分发您的产品，如果可能的话，让模块单独编码并由负责人集成，该负责人的职责是所有程序员都不会获得所有代码。
*   在终止时，得到编码员的书面承诺，即他们不拥有公司的任何知识产权，并且他们了解违规的处罚。
*   如果有人侵犯了您的 IP，请起诉该人！没有例外。它将作为当前团队的示例。

我听起来很极端吗？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-06T11:49:36.710

我记得 Valve 在开发 HL-2 时发生过这种情况。有趣的链接在这里：[http ://www.shacknews.com/onearticle.x/28619](http://www.shacknews.com/onearticle.x/28619)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-23T11:15:15.573

我曾在对这类事情有真正保密文化的地方工作过（从历史上看，曾经有很多次公司很小，“客户”滥用他们对我们产品的访问权）。

虽然高层管理人员非常保护，但我的看法略有不同。我认为我们的代码虽然并非完全无关紧要，但并不像您在软件公司中所期望的那样关键。

我们成功的原因是：

1）代码本质上是解决一堆问题的方法。如果你得到我们的代码，你就会得到那些解决方案，但我们仍然有解决这些问题的聪明人。他们比您更了解这些问题，并且能够比您更好地解决下一组问题。

2）因为他们真正了解问题（和解决方案），我们可以比竞争对手更快地做事，这意味着更便宜（或更有利可图）。

3）也因为这些人和公司内部的态度，我们向客户提供了良好的服务并提供了良好的支持。

4) 正因为如此，我们拥有良好的声誉和可参考的客户。

少数公司拥有真正值得保密的代码——专有算法之类的东西——但对于我们大多数人来说，我们的产品很容易被聪明的人复制。

我要说的是做基础——把它写进人们不能接受的合同，保证它的安全等等——但不要沉迷于它。除非您处于一个非常特定的市场，否则它不太可能真正使您的业务成功或失败。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-12-06T23:28:19.943

大多数答案都是基于道德和伦理价值观。我想知道谷歌、Facebook 等是否只是依靠员工的善意。让我休息一下，这完全是乌托邦式的。别傻了。现实点。

是的，可以防止代码泄漏：

使用托管虚拟机的虚拟服务器，程序员只能通过远程桌面在本地访问这些虚拟机（内联网）。存储库在本地管理。访问存储库需要私钥。 **从虚拟机复制/粘贴到客户端被禁用。只允许从客户端复制/粘贴到虚拟机。**

像脸书这样的公司就是这样做的。

仍然编码的唯一方法是对实际编码进行拍照，这完全不实用也不可行，而且由于到处都有监控摄像头，所以你必须去洗手间才能​​拍到那些照片。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T11:10:44.633

最好的一步是从重新吸引具有强烈道德行为的人开始。可以采取各种其他步骤，例如扫描所有通信。有些地方会扫描电子邮件和所有发出的信息。台式机/笔记本电脑没有硬盘或访问受到限制，所有工作都在网络文件夹上，即使在家工作，也必须连接到互联网。离线工作得到同步。USB 和驱动器已断开连接。

其他政策是仅根据需要提供访问权限。这些只会在一定程度上减慢和阻碍，但如果一个人非常坚定，他就会想办法解决这个问题。另一种方法是，如果代码真的很重要，那么让想法受到版权保护。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T11:18:09.033

老实说，这几乎是不可能的。如果我想建议一家很快会出现在 Daily WTF 上的公司会做什么：

1.  断开“工作计算机”与互联网的连接，因为他们需要互联网访问以供参考，所以请给每个人买一本 wbbook。

2.  用环氧树脂填充开发人员的 USB 插槽，并要求他们从中央服务器加载/卸载所有内容，该服务器会扫描通过它的所有数据以获取类似语法的代码。

或者你可以信任你的员工并让他们签署保密协议......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-06T11:20:52.087

我个人从未对任何真实案例进行过测试，但我建议使用代码碎片：

基本上，您将项目拆分为多个库，为每个库定义接口和单元测试，然后分离 SVN 存储库，以便每个组都可以访问您宝贵源代码的有限部分。

无论如何，这也是一种很好的做法，如果您在国外进行外包，这应该会有所帮助。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-06T12:05:06.007

之前的答案似乎都集中在建立信任和雇用有道德的人上。

另一种可能性可能是创建您自己的领域特定语言和工具。这将使任何泄露的代码更难使用。可能仍然可以从中窃取有用的想法，但除非整个工具链被泄露，否则不可能简单地编译竞争产品。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-06T16:44:52.033

相信你的开发者。人们往往会达到或低于预期。善待他们，记住忠诚是双向的。毕竟，如果你不能切断拇指驱动器，你就无法阻止任何人泄露代码，无论你多么不信任他们。

话虽如此，请为自己找一位具有商业秘密专业知识的律师，可能是知识产权法其他方面的专业知识，并询问如何合法地保护东西。你确实想确保，如果竞争对手得到你的东西，那么竞争对手从中受益是不合法的。

# java - 共享资源的 Java Web 应用程序的多个实例

> ID：173880
> 
> 赞同：1
> 
> 时间：2008-10-06T11:04:02.480
> 
> 标签：java, spring, jakarta-ee, weblogic

我有一个 Web 服务，它接受输入的 xml 消息，对其进行转换，然后将其转发到另一个 Web 服务。

出于性能和弹性原因，应用程序部署到两个 Web 逻辑应用服务器。

我想要一个允许两件事的网站监控页面

*   停止/开始转发消息的能力

*   能够监控过去一小时内消息数量的吞吐量等。进入 Web 服务的不同发件人的数量等。

我想知道实现这一点的最佳方法是什么。

我目前的想法是有一个内存数据库（例如 Debry 或 HSQL）复制数据，以便在我的应用程序的两个（或多个）实例之间共享信息，这些实例在应用服务器的不同实例中运行。我想我必须设置某种主/从配置。

我想要一个讨论如何解决这个问题的文章的链接。

（注意，这是一个使用spring MVC的简单spring应用）

谢谢，

大卫。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T12:15:01.463

这听起来很适合[Java 管理扩展 (JMX)](http://java.sun.com/javase/technologies/core/mntr-mgmt/javamanagement/)

*   JMX 允许您公开某些操作（例如：开始/停止转发消息）
*   JMX 允许您监控某些性能指标（例如：处理的消息的移动平均值）

Spring 很好地支持将 bean 公开为 JMX MBean。请参阅[此处](http://static.springframework.org/spring/docs/2.5.5/reference/jmx.html)了解更多信息。

然后您可以使用基于 Web 的开源 JMX 控制台，例如[jManage](http://www.jmanage.org/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T11:54:27.103

听起来您正在寻找消息队列、一些 MDB 和可配置的设计可以让您完成所有这些工作。如果我没记错的话，Spring 支持 JMS 队列

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-13T18:16:39.870

我认为您正在寻找消息队列。如果您需要额外的监控，使用 Web 服务作为端点可能是不够的 - 关于停止/启动或转发消息；监视对 Web 服务的 http 请求比跟踪消息到队列更麻烦（即使您可以做到）。

如果您将此服务公开给第三方，那么 Web 服务将位于消息队列的顶部并委托给它。

以我的经验，RabbitMQ 是一个很好的消息队列服务，学习曲线相对简单。

# javascript - JavaScript 中的 ParseFloat 函数

> ID：173884
> 
> 赞同：11
> 
> 时间：2008-10-06T11:06:31.257
> 
> 标签：javascript, floating-point, parsefloat

当我添加两个文本框值**1.001**和**0.001**然后我做一个`parseFloat`我得到**1.0019999999**。我想要它**1.002**。你能帮助我吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-06T12:15:39.870

Javascript [Number](http://www.w3schools.com/jsref/jsref_obj_number.asp)类有一个`toFixed()`函数可以让你得到你想要的。

所以你可以这样做`parseFloat("1.0019999").toFixed(3)`，这会给你**1.002**。

参数（本例中为 3）是小数点后显示的位数

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-06T11:21:21.790

0.002 不能准确地表示为以 2 为底的数字。类似于 1/3 不能以 10 为底表示的方式。

1/3 = 0.33333... 重复出现。要以 10 为基数准确表示数字，您需要无限多的十进制数字。

0.002 是一个可以精确地以 10 为底的数字（正如我们在此处看到的），但不能以计算机使用的以 2 为底。为了准确地表示这个数字，需要无限个二进制数字。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T11:09:46.023

这是一个已知问题：参见准确度[问题](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems) 和准确度问题的最小化：[最小化](http://en.wikipedia.org/wiki/Floating_point#Minimizing_the_effect_of_accuracy_problems)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-09T17:16:00.353

javascript 方法`Number.toFixed()`和`Number.toPrecision()`可以在这里提供帮助，但[它们返回一个`String`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number/toPrecision). 一个可能的解决方案如下：

```
var x = parseFloat(parseFloat("1.0019999999").toPrecision(3)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T11:23:45.013

如果你想快速修复，你可以四舍五入到最接近的千分之一

数学.round((1.001+0.001)*1000)/1000

# .net - 覆盖特定 .NET 类型的序列化

> ID：173886
> 
> 赞同：3
> 
> 时间：2008-10-06T11:06:57.870
> 
> 标签：.net, serialization, overriding

请考虑这个示例类：

```
[Serializable]
public class SomeClass
{
    private DateTime _SomeDateTime;

    public DateTime SomeDateTime
    {
        get { return _SomeDateTime; }
        set { _SomeDateTime = value; }
    }
} 
```

我想根据我自己的规则更改类中声明的任何 DateTime 的序列化。此类的成员会经常更改，我不想为每次更改都维护一个自定义序列化程序。此外，我希望这种行为由子类继承，而不是为每个子类编写自定义序列化程序。序列化由 Web 服务输出。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T11:08:42.860

您是否考虑过简单地使用 Nullable 日期时间

```
public DateTime? SomeDateTime {get; set;} 
```

这样，您实际上可以将 null 值作为类中的合法值。通常，您希望尽可能避免自定义序列化。一旦您进行了自定义序列化（例如实现**[ISerializable](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx)**），您就会坚持下去，并且所有其他派生类都坚持下去。

还记得必须始终为自定义异常覆盖 ISerializable 成员是多么痛苦吗？这是因为 System.Exception 实现了 ISerializable，因此如果您希望它们跨 AppDomains，所有派生的异常（这意味着一切）都必须实现这些成员。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T14:13:46.467

查看 OnSerializing 和 OnDeserializing 属性以在您的对象被序列化时调用自定义方法。您可以在其中执行一些自定义逻辑，并将序列化过程与实际数据类型分离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T11:14:44.737

好吧，您可以使用“bool ShouldSerializeSomeDateTime()”方法来启用/禁用单个成员的序列化，但我认为这不是您所需要的。另一个常见的选项是添加一个执行格式本身的成员：

公共字符串 SomeDateTimeFormatted { get { return theField == DateTime.MinValue ？"" : theField.ToString("R");} // 或任何格式设置 { ... 相反 ...} }

不过，如果可以的话，最好坚持使用内置序列化 - 部分是为了减少您需要编写的代码量。Josh 对可为空的 DateTime（DateTime？）的建议是一个很好的建议，尽管它可能仍然不是很空字符串与格式化字符串 - 我希望它会使用 xsi:nil 标记。

# c# - “new ReportDocument()”的性能问题

> ID：173893
> 
> 赞同：1
> 
> 时间：2008-10-06T11:08:12.237
> 
> 标签：c#, .net, performance, crystal-reports

我有一个 C# 应用程序，我在其中创建了一个 Crystal Reports ReportDocument，其中包含以下行

`CrystalDecisions.CrystalReports.Engine.ReportDocument document = new CrystalDecisions.CrystalReports.Engine.ReportDocument();`

此行需要 3-4 秒才能执行。这似乎很慢，尤其是因为

`document.Load(file)`

紧随其后的行（实际上是读取报告文件和创建报告对象模型的主要部分）执行得非常快。

我应该记住哪些可能会提高性能的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T14:38:16.120

不幸的是，根据[https://www.sdn.sap.com/irj/sdn/message?messageID=5898122](https://www.sdn.sap.com/irj/sdn/message?messageID=5898122) 3-4 秒，这个构造函数调用是“非常正常的”。

# xml - Checkstyle 的 PackageHtml 规则忽略 package-info.java

> ID：173897
> 
> 赞同：2
> 
> 时间：2008-10-06T11:09:14.590
> 
> 标签：xml, javadoc, checkstyle

我使用 checkstyle 来分析我的代码。一个有用的规则是 PackageHtml，它检查包是否包含 Javadoc 描述。但是对于较新的 java 版本，建议使用 package-info.java 而不是 package.html。问题是，checkstyle 忽略 package-info.java 并报告违反规则。如何将 checkstyle 配置为检查包文档，但接受 package.html**和**package-info.java？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T11:19:01.670

您使用的是哪个版本的 CheckStyle？

这似乎是一个2007 年底关闭的[旧错误。](http://myt.ag/URLWeb.aspx?email=steve%40fooworks.com&url=https%3a%2f%2fsourceforge.net%2ftracker%2f%3ffunc%3ddetail%26atid%3d397078%26aid%3d1228207%26group_id%3d29721&sn=)

实际上，文档提到 package-info 作为[默认值](http://checkstyle.sourceforge.net/config_javadoc.html)！...但仅适用于 CheckStyle 5.x，而不是 4.4

CheckStyle5.0 beta1 的公告[在这里](http://sourceforge.net/mailarchive/forum.php?thread_name=488F8212.2020106%40koedderitzsch.net&forum_name=checkstyle-announce)。
CheckStyle 4.4 是最后一个兼容 jdk1.4 的版本

# asp.net - 有人在 Mono 上运行生产 ASP.NET 站点吗？

> ID：173898
> 
> 赞同：10
> 
> 时间：2008-10-06T11:09:29.427
> 
> 标签：asp.net, performance, mono

我正在尝试对 Mono/Apache/Linux 是否真的“准备好”并且以任何方式与更传统的 .NET/IIS/Windows 堆栈相媲美的工作进行非正式的可行性研究。

任何性能比较都会有所帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-06T11:16:47.697

看看[使用 Mono 的公司](http://www.mono-project.com/Companies_Using_Mono)。

它甚至说[Wikipedia](http://en.wikipedia.org)使用 Mono 作为其搜索工具。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T22:18:56.593

[http://Fiducial.Biz](http://Fiducial.Biz)，法国的一家金融公司正在使用 ASP.NET 在 Mono 上运行

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T11:23:59.053

我们正在为我们的一位客户在 Mono/Apache/FreeBSD 平台上运行一个网站/一组 Web 服务。设置效果很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T12:35:04.497

要记住的一件事是 Mono 的 2.0 即将发布（我认为这周），而且现在更好。因此，如果您进行任何测试，请确保您至少使用 2.0 RC

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T11:19:57.207

我正在通过 Mono 运行 ASP.NET 的几个站点。我的目标是框架的 2.0。我没有 Digg 号码，但我也从来没有遇到过问题。

# python - 如何以编程方式闪烁/控制 Macbook 键盘 LED？

> ID：173905
> 
> 赞同：5
> 
> 时间：2008-10-06T11:11:05.913
> 
> 标签：python, macos, keyboard, blink

您知道如何在 Mac OS X（最好是 Tiger）下打开/关闭（闪烁）Macbook 键盘指示灯（大写锁定、数字锁定）吗？

我已经用谷歌搜索了这个，但没有得到任何结果，所以我正在寻求帮助。

我想将此功能添加为通知（例如，在 Adium 上收到新消息，收到新邮件）。

我更喜欢applescript、python，但如果不可能，任何代码都可以。

我将不胜感激任何形式的指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T11:15:02.427

[http://googlemac.blogspot.com/2008/04/manipulating-keyboard-leds-through.html](http://googlemac.blogspot.com/2008/04/manipulating-keyboard-leds-through.html)

# git - 是否有“git merge -s ours”的“他们的”版本？

> ID：173919
> 
> 赞同：1012
> 
> 时间：2008-10-06T11:16:43.217
> 
> 标签：git, git-merge

使用 将主题分支“B”合并到“A”`git merge`时，我遇到了一些冲突。我知道所有的冲突都可以使用“B”中的版本来解决。

我知道`git merge -s ours`。但我想要的是类似的东西`git merge -s theirs`。

为什么不存在？`git`与现有命令发生冲突合并后，如何获得相同的结果？（`git checkout`来自 B 的每个未合并的文件）

仅丢弃分支 A 中的任何内容（合并提交点到树的 B 版本）的“解决方案”不是我想要的。

* * *

## 回答 #1

> 赞同：1172
> 
> 时间：2010-07-29T15:58:58.037

一个类似的替代方案是`--strategy-option`(short form `-X`) 选项，它接受`theirs`. 例如：

```
git checkout branchA
git merge -X theirs branchB 
```

但是，这更等同`-X ours`于`-s ours`。主要区别在于`-X`执行常规递归合并，使用所选一侧解决任何冲突，而`-s ours`将合并更改为完全忽略另一侧。

在某些情况下，使用`-X theirs`而不是假设的主要问题`-s theirs`是删除文件。在这种情况下，只需`git rm`使用已删除文件的名称运行：

```
git rm {DELETED-FILE-NAME} 
```

之后，`-X theirs`可能会按预期工作。

当然，使用`git rm`命令进行实际删除将首先防止冲突发生。

* * *

## 回答 #2

> 赞同：237
> 
> 时间：2011-02-11T13:42:30.537

将分支 B 合并到我们签出的分支 A 中的一种可能且经过测试的解决方案：

```
# in case branchA is not our current branch
git checkout branchA

# make merge commit but without conflicts!!
# the contents of 'ours' will be discarded later
git merge -s ours branchB    

# make temporary branch to merged commit
git branch branchTEMP         

# get contents of working tree and index to the one of branchB
git reset --hard branchB

# reset to our merged commit but 
# keep contents of working tree and index
git reset --soft branchTEMP

# change the contents of the merged commit
# with the contents of branchB
git commit --amend

# get rid off our temporary branch
git branch -D branchTEMP

# verify that the merge commit contains only contents of branchB
git diff HEAD branchB 
```

要使其自动化，您可以使用 branchA 和 branchB 作为参数将其包装到脚本中。

此解决方案保留合并提交的第一个和第二个父级，就像您对`git merge -s theirs branchB`.

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2008-10-06T13:28:10.957

旧版本的 git 允许您使用“他们的”合并策略：

```
git pull --strategy=theirs remote_branch 
```

但这已被删除，正如[Junio Hamano](http://marc.info/?l=git&m=121637513604413&w=2)（Git 维护者）在此消息中所解释的那样。如链接中所述，您可以这样做：

```
git fetch origin
git reset --hard origin 
```

但请注意，这与实际的合并不同。您的解决方案可能是您真正需要的选项。

* * *

## 回答 #4

> 赞同：87
> 
> 时间：2014-12-07T00:04:21.393

目前尚不清楚您想要的结果是什么，因此在答案和他们的评论中对“正确”的执行方式存在一些混淆。我尝试给出一个概述并查看以下三个选项：

**尝试合并并使用 B 来解决冲突**

这*不是*“他们的版本`git merge -s ours`”而是“他们的版本`git merge -X ours`”（是 的缩写`git merge -s recursive -X ours`）：

```
git checkout branchA
# also uses -s recursive implicitly
git merge -X theirs branchB 
```

这就是例如[Alan W. Smith 的回答](https://stackoverflow.com/a/3364506/1347968)所做的。

**仅使用 B 中的内容**

这会为两个分支创建一个合并提交，但会丢弃来自`branchA`的所有更改，只保留来自`branchB`.

```
# Get the content you want to keep.
# If you want to keep branchB at the current commit, you can add --detached,
# else it will be advanced to the merge commit in the next step.
git checkout branchB

# Do the merge an keep current (our) content from branchB we just checked out.
git merge -s ours branchA

# Set branchA to current commit and check it out.
git checkout -B branchA 
```

请注意，合并提交的第一个父级现在是 from `branchB`，只有第二个是 from `branchA`。这就是例如[Gandalf458 的回答](https://stackoverflow.com/a/18682314/1347968)所做的。

**仅使用 B 中的内容并保持正确的父顺序**

这是真正的“他们的版本`git merge -s ours`”。它的内容与之前的选项相同（即只有 from `branchB`），但父母的顺序是正确的，即第一个父母来自`branchA`，第二个来自`branchB`。

```
git checkout branchA

# Do a merge commit. The content of this commit does not matter,
# so use a strategy that never fails.
# Note: This advances branchA.
git merge -s ours branchB

# Change working tree and index to desired content.
# --detach ensures branchB will not move when doing the reset in the next step.
git checkout --detach branchB

# Move HEAD to branchA without changing contents of working tree and index.
git reset --soft branchA

# 'attach' HEAD to branchA.
# This ensures branchA will move when doing 'commit --amend'.
git checkout branchA

# Change content of merge commit to current index (i.e. content of branchB).
git commit --amend -C HEAD 
```

这就是[Paul Pladijs 的回答](https://stackoverflow.com/a/4969679/1347968)所做的（不需要临时分支）。

**特别案例**

如果 , 的提交`branchB`是 , 的祖先`branchA`，`git merge`则不起作用（它只是退出并显示类似“ *Already up to date.* ”之类的消息）。

[`git commit-tree`](https://git-scm.com/docs/git-commit-tree)在这种或其他类似/高级的情况下，可以使用低级命令。

* * *

## 回答 #5

> 赞同：66
> 
> 时间：2012-11-03T12:51:12.777

从现在开始，我就使用了 Paul Pladijs 的答案。我发现，你可以做一个“正常”的合并，发生冲突，所以你做

```
git checkout --theirs <file> 
```

通过使用来自其他分支的修订来解决冲突。如果您对每个文件都执行此操作，您将获得与预期相同的行为

```
git merge <branch> -s theirs 
```

无论如何，努力比合并策略要多！（这是用 git 版本 1.8.0 测试的）

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2013-09-08T09:40:17.407

> 使用 git merge 合并“A”中的主题分支“B”时，我遇到了一些冲突。我>知道使用“B”中的版本可以解决所有冲突。
> 
> 我知道 git merge -s ours 。但我想要的是像 git merge >-s 他们的东西。

我假设您从 master 创建了一个分支，现在想要合并回 master，覆盖 master 中的任何旧内容。当我看到这篇文章时，这正是我想做的。

做你想做的事，除了先将一个分支合并到另一个分支。我刚做了这个，效果很好。

```
git checkout Branch
git merge master -s ours 
```

然后，checkout master 并合并你的分支（现在可以顺利进行）：

```
git checkout master
git merge Branch 
```

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2008-10-06T11:34:59.203

我解决了我的问题

```
git checkout -m old
git checkout -b new B
git merge -s ours old 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2012-04-12T19:17:23.857

如果您在分支 A 上，请执行以下操作：

```
git merge -s recursive -X theirs B 
```

在 git 版本 1.7.8 上测试

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2017-10-14T06:19:37.117

> 为什么不存在？

虽然我在“ [git command for making a branch like another](https://stackoverflow.com/a/4912267/6309) ”中提到了如何模拟`git merge -s theirs`，但请注意 Git 2.15（2017 年第四季度）现在更加清晰：

> 用于合并的 ' ' 的文档`-X<option>`被误导性地表明`-s theirs`存在“”，但事实并非如此。

请参阅[Junio C Hamano ( ) 的](https://github.com/gitster)[提交 c25d98b](https://github.com/git/git/commit/c25d98b2a730cbc63033ba3360df2519d43a40cd)（2017 年 9 月 25 日[）](https://github.com/gitster)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([4da3e23 提交中](https://github.com/git/git/commit/4da3e234f5a3989328c4dc8368cf5906f8679b30))^(，2017 年 9 月 28 日）)[`gitster`](https://github.com/gitster)
^([`gitster`](https://github.com/gitster))

> ## 合并策略：避免暗示“ `-s theirs`”存在
> 
> 合并选项的描述`-Xours`有一个括号告诉读者它与 有很大不同`-s ours`，这是正确的，但它后面的描述`-Xtheirs`不小心说“这是相反的`ours`”，给人一种读者也需要的错误印象需要注意的是，它与 非常不同`-s theirs`，实际上它甚至不存在。

`-Xtheirs`是应用于递归策略的*策略选项。*这意味着递归策略仍然会合并任何它可以合并的东西，并且只会`theirs`在发生冲突时回退到“”逻辑。

[最近在 2017 年 9 月的这个帖子中](https://marc.info/?l=git&m=150635053217381&w=2)`theirs`重新提出了关于合并策略是否相关的辩论。 它承认[较旧的（2008）线程](https://public-inbox.org/git/alpine.DEB.1.00.0807290123300.2725@eeepc-johanness/)

> 简而言之，前面的讨论可以概括为“我们不想要 ' `-s theirs`'，因为它会鼓励错误的工作流程”。

它提到了别名：

```
mtheirs = !sh -c 'git merge -s ours --no-commit $1 && git read-tree -m -u $1' - 
```

雅罗斯拉夫哈尔琴科试图再次倡导该策略，[但 Junio C. Hamano 补充道](https://marc.info/?l=git&m=150639760028942&w=2)：

> 我们的和他们的不对称的原因是你是你而不是他们——我们的历史和他们的历史的控制权和所有权是不对称的。
> 
> 一旦您决定他们的历史是主线，您宁愿将您的开发线视为一个分支并朝该方向进行合并，即结果合并的第一个父级是对他们历史的提交，第二个父母是你历史上最后一个坏人。因此，您最终会使用“ `checkout their-history && merge -s ours your-history`”来保持第一父母身份的合理性。
> 
> 到那时，使用“ `-s ours`”不再是缺少“ `-s theirs`”的解决方法。
> **它是所需语义的适当部分，即从幸存的规范历史线的角度来看，您希望保留它所做的，取消另一条历史线所做的**。

[正如Mike Beaton](https://stackoverflow.com/users/795690/mike-beaton)所评论的，Junio 补充道：

> `git merge -s ours <their-ref>`有效地表示“将`<their-ref>`其分支上的提交标记为永久忽略的提交”；
> **这很重要，因为如果您随后从其分支的后续状态合并，则将引入他们以后的更改，而不会引入忽略的更改**。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2013-10-30T14:47:43.637

要真正正确地进行*仅从*您要合并的分支中获取输入的合并，您可以这样做

`git merge --strategy=ours ref-to-be-merged`

`git diff --binary ref-to-be-merged | git apply --reverse --index`

`git commit --amend`

在我所知道的任何情况下都不会发生冲突，您不必创建额外的分支，它就像一个正常的合并提交。

然而，这对子模块并不好。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2013-05-13T15:48:20.233

请参阅[Junio Hamano 被广泛引用的答案](http://marc.info/?l=git&m=121637513604413&w=2)：如果您要丢弃提交的内容，只需丢弃提交，或者无论如何将其保留在主要历史记录之外。为什么将来要打扰每个人从没有提供任何东西的提交中阅读提交消息？

但有时有行政要求，或者可能是其他一些原因。对于那些您确实必须记录无贡献的提交的情况，您需要：

（编辑：哇，我以前有没有弄错这个。这个有效。）

```
git update-ref HEAD $(
        git commit-tree -m 'completely superseding with branchB content' \
                        -p HEAD -p branchB    branchB:
)
git reset --hard 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-04-22T19:18:40.450

这个使用 git 管道命令 read-tree，但会缩短整体工作流程。

```
git checkout <base-branch>

git merge --no-commit -s ours <their-branch>
git read-tree -u --reset <their-branch>
git commit

# Check your work!
git diff <their-branch> 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-05-14T15:43:33.837

'git merge -s theirs branchB' 的等价物（保持父顺序）

合并前：[![在此处输入图像描述](https://i.stack.imgur.com/6AFQ5.png)](https://i.stack.imgur.com/6AFQ5.png)

！！！确保您处于清洁状态！

进行合并：

```
git commit-tree -m "take theirs" -p HEAD -p branchB 'branchB^{tree}'
git reset --hard 36daf519952 # is the output of the prev command 
```

我们做了什么 ？我们创建了一个新的提交，其中两个父母是我们的和他们的，并且提交的内容是 branchB - 他们的

合并后：[![在此处输入图像描述](https://i.stack.imgur.com/XlMV5.png)](https://i.stack.imgur.com/XlMV5.png)

更确切地说：

```
git commit-tree -m "take theirs" -p HEAD -p 'SOURCE^{commit}' 'SOURCE^{tree}' 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-08-31T13:41:17.160

我认为你真正想要的是：

```
git checkout -B mergeBranch branchB
git merge -s ours branchA
git checkout branchA
git merge mergeBranch
git branch -D mergeBranch 
```

这看起来很笨拙，但它应该工作。我真正不喜欢这个解决方案的唯一想法是 git 历史会令人困惑......但至少历史将被完全保留，您不需要为已删除的文件做一些特殊的事情。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-05-29T21:17:52.603

这个答案是由 Paul Pladijs 给出的。为了方便起见，我只是接受了他的命令并做了一个 git 别名。

编辑您的 .gitconfig 并添加以下内容：

```
[alias]
    mergetheirs = "!git merge -s ours \"$1\" && git branch temp_THEIRS && git reset --hard \"$1\" && git reset --soft temp_THEIRS && git commit --amend && git branch -D temp_THEIRS" 
```

然后你可以通过运行“git merge -s theirs A”：

```
git checkout B (optional, just making sure we're on branch B)
git mergetheirs A 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-01-28T12:35:03.217

这会将您的 newBranch 合并到现有的 baseBranch

```
git checkout <baseBranch> // this will checkout baseBranch
git merge -s ours <newBranch> // this will simple merge newBranch in baseBranch
git rm -rf . // this will remove all non references files from baseBranch (deleted in newBranch)
git checkout newBranch -- . //this will replace all conflicted files in baseBranch 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2017-03-27T14:31:26.980

我最近才需要为共享共同历史的两个独立存储库执行此操作。我开始：

*   `Org/repository1 master`
*   `Org/repository2 master`

我希望将所有更改`repository2 master`应用到`repository1 master`，接受 repository2 将进行的所有更改。用 git 的话来说，这*应该*是一个叫`-s theirs`BUT 它不存在的策略。要小心，因为`-X theirs`它的命名就像你想要的那样，但它*不*一样（它甚至在手册页中这么说）。

我解决这个问题的方法是去`repository2`创建一个新的分支`repo1-merge`。在那个分支中，我跑了`git pull git@gitlab.com:Org/repository1 -s ours`，它融合得很好，没有任何问题。然后我把它推到遥控器上。

然后我回去`repository1`做一个新的分支`repo2-merge`。在那个分支中，我运行`git pull git@gitlab.com:Org/repository2 repo1-merge`它将完成问题。

最后，您要么需要发出合并请求`repository1`以使其成为新的主节点，要么将其保留为分支。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2018-10-05T06:44:35.623

一个简单直观（在我看来）的两步方法是

```
git checkout branchB .
git commit -m "Picked up the content from branchB" 
```

其次是

```
git merge -s ours branchB 
```

（将两个分支标记为合并）

唯一的缺点是它不会从当前分支中删除已在 branchB 中删除的文件。之后两个分支之间的简单差异将显示是否有任何此类文件。

这种方法还可以从之后的修订日志中清楚地看出做了什么 - 以及打算做什么。

# deployment - 为具有 windows ce 4.2 (VS 2003) 的设备显示桌面快捷方式

> ID：173921
> 
> 赞同：2
> 
> 时间：2008-10-06T11:17:03.450
> 
> 标签：deployment, windows-ce

我在 VS 2003 中开发了一个 Windows CE 4.2 应用程序。当我在具有 X86 处理器的设备中部署 CAB 文件时，在开始 >> 程序 >> 应用程序中创建应用程序的快捷方式。但我想要桌面上的应用程序的捷径。

我修改了 INF 文件以添加一个新的快捷方式，该快捷方式指向 windows 文件夹内的桌面文件夹，但它不起作用。此外，如果我将构建 CAB 文件时创建的默认快捷方式替换为桌面位置，它仍然会在程序中而不是在桌面上创建快捷方式。

有没有人对此有解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T16:46:33.287

我会查看链接：http: [//msdn.microsoft.com/en-us/library/ms938387.aspx](http://msdn.microsoft.com/en-us/library/ms938387.aspx)

这应该会让你顺利上路。基本上，CE 中的快捷方式只是以下格式的 ASCII 文件：

21#\Windows\solitare.exe

其中 21# 是该路径中的字符数。这是 MSDN 的另一个链接，其中包含更多信息：http: [//msdn.microsoft.com/en-us/embedded/aa731295.aspx](http://msdn.microsoft.com/en-us/embedded/aa731295.aspx)

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T22:59:37.323

修改INF文件后，如何重新生成CAB？您*不能*使用 Studio 中的菜单项（不记得 '03 是否有该选项），因为它会覆盖您的 INF。

如果您使用 CABWIZ 手动生成 CAB，请向我们展示您的 INF 文件，因为您可能在那里有问题。

# c++ - 在 C++ 软件中加入共享软件限制

> ID：173930
> 
> 赞同：12
> 
> 时间：2008-10-06T11:20:46.113
> 
> 标签：c++, time, restriction, shareware

我希望在共享软件的基础上实现我的软件，以便用户有最长（比如）30 天的试用期来试用该软件。在购买时，我打算为用户提供一个随机生成的密钥，当输入该密钥时，它会再次启用该软件。

我以前从未走过这条路，因此任何建议或反馈或指向如何完成此操作的“标准”方式的指针将不胜感激。

我预计用户不会通过更改系统日期或类似的方式作弊，尽管这可能值得考虑。抱歉，如果此主题以前出现过。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T11:30:41.850

对于随机生成的密钥，如果密钥实际上是随机的，您将如何验证密钥是否合法或密钥是否伪造？看看文章“[实现部分序列号验证系统](http://www.brandonstaggs.com/2007/07/26/implementing-a-partial-serial-number-verification-system-in-delphi/)”，因为它非常好并且很容易用任何语言实现。

关于时间试验，基本的解决方案是将您的主要可执行文件创建时间与当前系统时间进行比较并根据差异采取行动。这假设您的安装程序将文件创建时间设置为安装时间，而不是保留您编译它的时间！:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T11:38:23.987

如果您的软件真的很有用，那么在您看到第一个订单之前，您肯定会在 P2P 上找到破解副本。无论您要实施的许可证执行代码多么复杂，都会发生这种情况。

也就是说，只需将首次运行日期存储在某处（可能是注册表，如果在 Windows 上）并在 30 天后拒绝启动，或者只是打开一个提醒窗口。

不要担心作弊者，无论如何他们都会找到绕过你的限制的方法。担心你诚实的客户，尽量不要让**他们的**生活变得更艰难。

[Eric Sink在这里（第 4 节）](http://www.ericsink.com/bos/Transparency.html)写了更多关于此的内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T11:39:02.627

还要注意时间的急剧变化，如果当前日期神奇地小于安装日期等。

绕过这种类型的日期锁的一种方法是在安装之前将日期更改为未来几年。所以你应该检查今天的日期不小于安装日期。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T11:23:36.043

在第一次开始时，您可以将实际日期存储在某处。
每次启动后，您都会查找存储的日期，如果存在，则读取它，如果在第一次启动后超过 30 天，则停止程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T11:36:34.737

请参阅[此库](http://www.allworldsoft.com/software/2-791-1way.htm)。

描述：

> 将任何应用程序转换为限时共享软件。生成序列号进行注册。一个函数库，提供具有可靠加密的灵活锁定系统。易于实施。支持VB、C++、Delphi、其他语言。

# javascript - HTML 报纸栏目

> ID：173934
> 
> 赞同：15
> 
> 时间：2008-10-06T11:22:47.683
> 
> 标签：javascript, html, css

我正在尝试使用一块文本创建报纸风格的专栏。我希望文本均匀分布在 2 列中，这可以对文本长度的变化做出反应。

这是否可能仅使用 HTML/CSS，如果不能使用 javascript？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-06T11:29:26.657

两个注意事项：

*   适用于印刷媒体的东西不适用于显示媒体。必须向上滚动才能继续阅读对我来说似乎不是一个好主意。毕竟，网页没有长度限制......
*   你不能用 CSS2 做到这一点。我认为 CSS3 支持（不确定），我怀疑大多数浏览器都支持它。

所以我认为 JS 是你最好的选择，但它当然不适用于禁用 JS 的用户。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-20T18:21:08.507

如果您决定这样做，那么在 Mozilla 和 WebKit（以及[Prince](http://princexml.com/)）中已经可以仅使用 CSS：

```
selector {
  -moz-column-count: 2;
  -webkit-column-count: 2;
  column-count: 2;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-30T14:31:02.907

它在 CSS3 规范中，并且 Moz/Webkit 已经使用供应商前缀实现了它。使用`column-count`和`column-gap`属性：

```
#container {
  -moz-column-count: 2;
  -moz-column-gap: 20px;
  -webkit-column-count: 2;
  -webkit-column-gap: 20px;
  column-count: 2;
  column-gap: 20px;
} 
```

请注意，当然，任何人使用的任何版本的 IE 都不支持这些。CanIUse.com[声称 IE 10 将支持它作为 CSS3 的一部分](http://caniuse.com/#search=column-count)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-13T21:33:20.367

CSS3 提供了一种将任何 HTML 节点的内容转换为任意数量的列的方法。有用于控制列数及其宽度、相对高度（“填充”或如何在现有列中划分内容）、列之间的间距、“规则”（分隔线或边框）等的属性。

作为起点，请参阅[w3schools.com CSS3 多列](http://www.w3schools.com/css3/css3_multiple_columns.asp)参考页面。

但是，像往常一样，在广泛使用的浏览器中，仅 IE 不支持 column-CSS3 属性。

一种跨浏览器解决方案是[Columnizer jQuery 插件](http://welcome.totheinter.net/columnizer-jquery-plugin/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T11:27:31.200

CSS3 将允许您通过其[多列支持](http://www.w3.org/TR/css3-multicol/)来做到这一点，但目前，您可能无法依赖很多浏览器来支持它，因此您可能需要依赖另一种方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T15:50:22.543

As others have said - not something that's possible with vanilla CSS/XHTML (at least - not until we get widespread CSS3 :-)

However, wearing my user experience hat, I'd be interested in your use case for wanting this on a web page (assuming that it's a normal web page that you're targeting). Unlike print splitting a block of text over two columns can make it harder to read. If it's longer than a screen then the user has to do a lot of scrolling up and down to scan/read everything.

So - even if you can do it with some JS hacking - might be better to come up with an alternate design that doesn't need it.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T11:42:37.503

我同意 PhiLho 的观点。如果您仍然想尝试它，如果列具有固定宽度，则将您的内容分成两列的 js 代码非常简单。棘手的一点是决定在哪里拆分内容。您可能不想在单词等中间分裂。

您可以尝试以下场景：在您的页面中添加两列。将您的文本放入第一列（这允许非 js 浏览器仍然显示您的内容）。使用 js 获取文本（例如，来自 onload 事件）。查找“。”的下一个索引。（或者如果你有段落“< /p>”）从中间开始。使用该索引拆分文本并将第一部分放回第一列，依此类推...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T15:10:40.093

这是一个简单的（不是 CSS 友好的）javascript 函数，它将执行此操作：

```
function Newspaperize(elem)
{
    var halflength = elem.innerText.length / 2; 
    var col1 = elem.innerText.substring(0, halflength);
    var col2 = elem.innerText.substring(halflength);

    elem.innerHTML = '<TABLE WIDTH=100%><TR>' + 
        '<TD WIDTH=50% VALIGN=TOP>' + col1 + '</TD>' +
        '<TD VALIGN=TOP>' + col2 + '</TD>' +
        '</TR></TABLE>';
} 
```

将您的文本放在某个常规元素中，并在页面加载时调用 Newspaperize(yourelement)。

注意：此函数只是将文本分成两半。要真正正常工作，您需要找到最接近中点的空格或连字符并在那里拆分文本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T15:16:24.873

[IHT 很好地实现](http://www.iht.com/bin/3-col.php?id=16724539)了 3 列格式。然而，它似乎是在服务器端计算的，我猜是通过计算单词来计算的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-04-22T13:49:27.330

所以我一直在寻找这个问题的答案，可悲的是，起初我并没有真正找到答案，现在 3 小时后我找到了。

我找到了一个使用 css3 属性的 JavaScript 库（如果我理解正确，只是试图让它工作，它确实做到了，稍后会在 js 中读取）

库在这里找到：[http ://www.csscripting.com/wiki/index.php?title=CSS3_Multi_Column](http://www.csscripting.com/wiki/index.php?title=CSS3_Multi_Column)

唯一的缺点是你想要多列的文本必须在两个标签之间（我更喜欢使用`<p>`标签，因为它也支持多个`<p>`标签。）

在 ff 3.6 即 8、opera 10.51 和 chrome 4.1 中对其进行了测试。我无法测试旧版浏览器，所以我建议有人尽快这样做；P

干杯！

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-02-20T05:28:23.463

我设法做到了这样的事情，但同样，不是在 CSS 中，我使用 PHP 来计算单词并分割文本。不幸的是，计算单词是一种非常糟糕的方法，因为有些单词比其他单词长并且列不匹配。我的设计灵感来自 IHT 网站。在 PHP 中实现并不难。

# java - JRE 升级

> ID：173960
> 
> 赞同：2
> 
> 时间：2008-10-06T11:36:37.657
> 
> 标签：java

无论如何升级系统中安装的JRE？我们在 HP Unix 系统中安装了 1.5.0_08。我们必须将其升级到 1.5.0_15。有没有办法修补现有的 JRE 并升级到更新的版本。或者只能通过安装更新​​来实现JRE 并将其设置在系统 PATH 中。

谢谢你的时间。

问候， 维维克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T11:43:47.563

通常所做的是将多个 JRE 安装在单独的目录中（JRE_1_5_10、JRE_1_5_16、JRE_1_6_3、...），并使用一些符号链接作为 JRE_1_5 的引用，指向 JRE 1.5 的最新版本，对于 JRE_1_6 和最终的 JRE这将指向最新版本的 JRE。

这样做，您只需要在选择使用较新版本时更新符号链接，并始终参考“可升级”系统的符号链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T11:39:26.650

我总是只升级并更改路径中的那个。但是，如果它只是您需要的类库更改，而不是 JVM，您可以替换 lib 目录的内容。但这是自找灾难。

# svn - 如何使用新的 SVN 合并跟踪？

> ID：173974
> 
> 赞同：26
> 
> 时间：2008-10-06T11:39:54.013
> 
> 标签：svn, merge, merge-tracking

在我现有的（SVN 1.5 之前）合并策略中，我们在创建分支时创建了一个 Trunk 的副本（称为 BasePoint），以便稍后在合并期间进行引用。

当我们需要将一个分支合并回主干时，我们执行 2 个操作。

1.  从 BasePoint 合并到 LatestTrunk（Trunk 可能从原始分支开始移动）到 Branch 的工作副本，然后提交。

    此时我们通常会检查合并到分支中没有损坏任何东西

2.  从 LatestTrunk 合并到 LatestBranch 回到主干的工作副本，然后提交。

文档建议我在主干上使用新的重新集成合并，然后从分支合并。

**我是否需要先从主干合并到开发分支，或者这是否包含在新的重新集成选项中？**

换句话说，新`merge --reintegrate`功能是代表“我以前的每个合并”还是“整个操作”？

（FWIW 我使用的是 TortoiseSVN 1.5.1）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-06T14:11:53.427

简短的回答是，**您仍然必须执行这两个步骤。**

[SVN 书](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.branchmerge.basicmerging)将合并过程解释为：

1.  svn在分支工作副本中合并[http://trunk/path](http://trunk/path)
2.  svn merge --reintegrate [http://branch/path](http://branch/path)在主干工作副本中

请注意缺少修订号。这可能不像是一个巨大的胜利。新的酷炫之处在于能够在您在分支中编码时重新运行合并，从而使您可以使分支保持最新的主干更改（无需手动记录修订号！）。SVN 跟踪需要从主干合并的内容以及分支独有的更改。完成分支后，--reintegrate 使用该数据仅自动将分支更改合并回主干。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T13:10:06.907

我相信 reintegrate 实际上并没有执行这两个操作，而是用于从更新的分支合并回主干。您仍然需要首先执行第一组合并/提交操作来更新分支。

这是[Subversion Book](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.branchemerge.basicmerging.stayinsync)的链接。有可能以死树格式获得这本书。

从链接中，听起来使用 --reintegrate 处理了一些奇怪的情况，与仅使用直接补丁相比，可能就像合并通常所做的那样（阅读“为什么不使用补丁代替？”部分）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T03:21:07.840

一篇关于在 svn 中合并问题（以及 reintegrate 所做的事情）的好博文在[这里](http://blogs.open.collab.net/svn/2008/07/subversion-merg/)。

# c# - 抽象数据类型（有时）是个好主意吗？

> ID：173980
> 
> 赞同：2
> 
> 时间：2008-10-06T11:43:39.950
> 
> 标签：c#, design-patterns

有很多次你有一个接口，它接受具有单独域逻辑含义的类似类型参数：

```
public static class Database
{
   public static bool HasAccess(string userId, string documentId) { return true; }
} 
```

现在很容易让某人键入 documentId 而不是 userId，反之亦然。可以通过抽象参数的数据类型来防止这种情况：

```
public class UserId
{
   public string Value { get; internal set; }
   public static implicit operator string(UserId id) { return id.Value; }
}

public class DocumentId
{
   public string Value { get; internal set; }
   public static implicit operator string(DocumentId id) { return id.Value; }
}

public static class Database
{
    public static bool HasAccess(UserId userId, DocumentId documentId) { return true; }
} 
```

这样，如果您无序输入参数，您会收到一个很好的编译器警告：

```
UserId e = new UserId() { Value = "a" };
DocumentId d = new DocumentId() { Value = "b" };

Database.HasAccess(d, e); 
```

您还可以在不影响系统其余部分的情况下更改抽象类型，但这不太可能。抽象类型是获得更多类型安全的好主意吗？

该问题与 C# 解决方案有关，但欢迎使用其他语言进行简短描述。

编辑：从字符串中删除了隐式转换并将手指指向 C# 标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T11:45:27.107

我认为您回答了自己的问题-更好的数据完整性和验证，更好的系统

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T11:51:15.193

有趣，但我怀疑在许多情况下（特别是序列化/RPC API）这只会增加混乱/开销。另外 - 一个小的实现细节，但考虑到这种方法，我会让包装器完全不可变，而不仅仅是“内部集”不可变。

TBH - 我可能宁愿对大部分使用单元测试......有时简单就是美丽。另一个问题是，由于你有隐式运算符，它不会阻止你做更多的事情：

```
string user = "fred";
SomeMethodThatWantsADocument(user); 
```

那应该编译；隐式运算符会撤消您所有的好工作...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T11:53:35.983

这就是 typedef 在 C++ 中变得有用的地方。您可以将 UserID 和 DocumentID 作为 typedeffed 类型，因此在没有强制转换的情况下不可互换，但只需要向编译器快速说明“这应该是与其他类型不同的单独类型，即使它实际上只是键入 X'。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T12:07:57.467

在这种情况下，我觉得不值得。

您添加了 12 行，分布在两个额外的类中。在某些语言中，您正在考虑为此管理两个新文件。（在 C# 中不确定）。你引入了很多额外的认知负荷。每当您浏览班级列表时，这些班级就会出现；它们出现在您自动生成的文档中；它们在那里是代码库的新手在尝试学习时看到的东西，它们位于编译器的依赖关系图中等。程序员必须知道类型并在调用 HasAccess 时创建两个新对象.

为了什么？为了防止您在检查某人是否有权访问数据库时不小心混淆了用户名和文档 ID。在正常系统中，该检查可能应该写两到三遍。（如果你写了很多，你可能没有在你的数据库访问代码中得到足够的重用）

所以，我会说这是过度的航天。我的经验法则是类或类型应该封装变体*行为*，而不是被动数据的变体使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T11:48:37.583

是的，有时这是个好主意。但是，如果你太沉迷于此，你就会成为一名建筑宇航员。

至于类型安全论点 - 它确实增加了类型安全性，但许多语言在没有它的情况下都可以正常工作。

在我看来，最好的方法是把它作为一个 String 开始，然后当你发现自己重用接口时，在那时将重构为更抽象的类型。

预测未来太难了，不能浪费时间去尝试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T11:49:23.107

对于您的单元测试无论如何都应该防止的事情，似乎是很多开销，至少在这种情况下是这样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T12:42:27.740

您不问也不回答的是最能确定新类型是否重要的​​问题：

1.  该系统的预计实际寿命是多少？如果答案是 2 年以上，那么您应该对数据库和用户 ID 至少有一个抽象级别。换句话说，您的数据库应该是抽象的，而您的用户和凭据应该是抽象的。然后根据抽象定义实现数据库和用户 ID。这样，如果需求发生变化，您的更改将在最需要它的地方进行。

2.  拥有 userid 数据类型的收益和损失是什么？这个问题应该从可用性、表现力和类型安全的角度来回答。如果在可用性和表现力方面有明显的提升，那么创建的类或额外行的数量在很大程度上是无关紧要的——万岁，你赢了。让我给你一个明显损失的例子——我使用了一个类层次结构，它包含一个抽象基类和几个具体的子类型。他们没有为子类和适当的访问器提供构造函数，而是创建了一个工厂方法，该方法将 XML 字符串或流作为参数并从中构造适当的具体类。可用性的损失如此之大，以至于让这个库很痛苦——甚至他们的示例代码都散发着丢失的味道。虽然我可以建造他们提供的一切，

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T12:56:29.710

虽然在一天结束时，您可能不在乎，但抽象程度越高，维护就越困难（尤其是对其他人而言）。如果在六个月内您必须开始挖掘此代码以查找或修复错误，甚至添加新功能，那么您将花费更长的时间来记住您做了什么以及为什么。如果其他人正在这样做，请乘以该时间。当您编写新代码时，优雅的代码总是很好，但我总是喜欢权衡维护人员的需求。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T14:53:59.083

这对我来说就像一个 YAGNI 问题。如果您只是因为它可能有用而这样做，那么这通常不是额外复杂性的充分理由。此外，正如其他人所指出的，这是单元测试应该捕捉到的东西。

我试图记住的另一件事是抽象是否旨在保护程序员免受他们自己的伤害。是的，理论上很容易触发两个字符串参数。但说真的，几十年来，关注参数顺序一直是大多数语言编程的一个基本方面。这不是应该经常发生的事情，而且肯定是测试应该抓住的事情。如果这种类型的事情是您组织中的常见问题，我会说您需要担心更大的问题。

# c++ - （重新）将向量初始化为具有初始值的特定长度

> ID：173995
> 
> 赞同：7
> 
> 时间：2008-10-06T11:52:02.197
> 
> 标签：c++, stl, initialization

作为函数参数，我得到一个`vector<double>& vec`长度和值未知的（输出向量，因此是非常量）。我想将此向量初始化为全零的特定长度 n。

这将起作用

```
vec.clear();
vec.resize( n, 0.0 ); 
```

这也将起作用：

```
vec.resize( n );
vec.assign( n, 0.0 ); 
```

第二个效率更高（因为不涉及内存释放/分配）？有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-06T14:43:15.640

```
std::vector<double>(n).swap(vec); 
```

在此之后，保证 vec 的大小和容量为 n，所有值均为 0.0。

也许自 C++11 以来更惯用的方式是

```
vec.assign(n, 0.);
vec.shrink_to_fit(); 
```

第二行可选。`vec`在从多个元素开始的情况下`n`，是否调用`shrink_to_fit`是保持比所需更多的内存与执行重新分配之间的权衡。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-06T11:53:55.983

```
std::vector<double>(n).swap(vec); 
```

这也具有实际压缩向量的优点。（在您的第一个示例中，`clear()`不保证压缩您的向量。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T21:22:07.600

好吧，让我们完善一下方法:)

```
vec.swap(std::vector<double>(n));
std::vector<double>(n).swap(vec);
std::swap(vector<double>(n), vec);
std::swap(vec, vector<double>(n)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T05:29:40.000

您发布的代码片段都没有进行任何内存释放，因此它们大致相等。

其他人不断发布的交换技巧将需要更长的时间来执行，因为它会释放向量最初使用的内存。这可能是可取的，也可能不是可取的。*********