# StackOverflow 问答 000834000-000834999

# sql-server - 对日志传送数据库的限制

> ID：834001
> 
> 赞同：3
> 
> 时间：2009-05-07T10:53:23.283
> 
> 标签：sql-server, sql-server-2005

在 SQL 2005 中，您不应该**对**启用了日志传送（并且在完全恢复模式下运行）的数据库执行哪些操作？

我收集到将额外的事务日志备份安排到不同的位置会中断日志传送（因为完整的日志链不再到达辅助服务器）。

我还收集到 Truncate Table 可以使用日志传送（自 Sql 2000 起）。

是否有任何其他应避免的活动/命令？

编辑：例如数据库收缩或日志收缩好吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T11:34:15.197

你是对的。您不应在日志传送配置之外定义任何其他事务日志备份，以确保您维护自然日志序列。

但是，如果您希望执行 Ad-Hoc 事务日志备份，天堂禁止，因为您正在对生产数据库执行一些实时维护，那么您可以调用 Log Shipping 用来执行事务日志备份的 SQL Server 作业。它通常称为 LS_Backup。这将维护 LSN。

据我了解，使用此可用性技术不会限制正在日志传送的数据库的操作功能。

一些可能导致并发症的事情：

**加密**

如果您将日志传送到另一台服务器并使用 SQL Server 本机加密，那么您将无法访问日志传送数据库中的加密数据，除非 SQL Server 使用相同的服务主密钥。

**组件**

您可能会遇到访问日志传送数据库中的签名程序集的困难，因为您无法启用可信赖的属性。

**权限**

如果您打算提供对 Log Shipped 数据库的读取访问权限，那么 SQL Server 登录名将需要与源服务器中的 SID 相同，以便登录名能够自动正确映射。

希望这可以帮助。干杯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T17:58:53.740

数据库/日志增长/收缩很好，它们会被运送过来，备用数据库也会增长/收缩。我知道的唯一会破坏的事情是：

使用 TRUNCATE_ONLY 备份日志

更改恢复模式

使主数据库脱机（不确定这个，从未尝试过）

其他一切都很好，但是执行大量 REINDEXES 可以生成一些在大型数据库上难以处理的非常大的日志。

# regex - 包含除“~”和“,”之外的所有键盘字符的正则表达式

> ID：834002
> 
> 赞同：12
> 
> 时间：2009-05-07T10:53:51.800
> 
> 标签：regex

如何编写一个包含除“~”和“，”之外的所有键盘字符的正则表达式？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-07T10:56:02.107

你试过这个吗？

```
[^~,] 
```

现在要排除不在键盘中的字符，我相信您必须将它们全部包含在内。

```
[a-zA-Z0-9\t\n ./<>?;:"'`!@#$%^&*()\[\]{}_+=|\\-] 
```

这几乎涵盖了它（即使它看起来像是一种完成工作的疯狂方式）。也许问题定义可以帮助您在第一个列表中添加更多要排除的内容，而`[^~,]`不是尝试创建所有键盘字符的巨大列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T13:45:06.427

你没有说你正在使用什么语言/工具，但在 Java 中我会使用这个正则表达式：

```
"[\\p{Print}&&[^~,]]" 
```

这是两个集合的交集：所有打印的 ASCII 字符，以及所有不是波浪号或逗号的字符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-09T07:40:26.363

我必须这样做才能使正则表达式起作用：

```
"[^~,][^~,]*" 
```

因为`[^~,]`否定`~`和`,`

`[^~,]*``~`表示and的零个或多个副本`,`（这对我们的情况无用）

并且通过`[^~,][^~,]*`让你否定一个或多个副本`~`或`,`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-04-03T12:45:30.653

一个相关的。

我浪费了很多时间搜索，所以下面是我想出的答案。

* * *

我想要**所有键盘键（包括空格和制表符）**：

```
// all keys (including space and tab)
var allKeyboardKeysRegex = /^[a-zA-Z0-9~`!@#\$%\^&\*\(\)_\-\+={\[\}\]\|\\:;"'<,>\.\?\/  ]*$/;

// example tests
var nonShiftChars = "`1234567890-=  qwertyuiop[]\asdfghjkl;'zxcvbnm,./ "
var shiftChars = "~!@#$%^&*()_+{}|:\"<>? ";
var someAlphaNumeric = "aAbB12 89yYzZ";

// test with allKeyboardKeysRegex
allKeyboardKeysRegex.test(nonShiftChars);
allKeyboardKeysRegex.test(shiftChars);
allKeyboardKeysRegex.test(someAlphaNumeric); 
```

输出：

```
true
true
true 
```

* * *

如果要**排除某些字符**，则只需从第一行正则表达式行（allKeyboardKeysRegex）上方删除它们。

例子：

```
// removing '~' and ','
var allKeyboardKeysRegexMinusSome = /^[a-zA-Z0-9`!@#\$%\^&\*\(\)_\-\+={\[\}\]\|\\:;"'<>\.\?\/   ]*$/; 
```

希望这会帮助某人。

* * *

**更新**

所有字符的列表

```
"1234567890"
"abcdefghijklmnopqrstuvwxyz"
"ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"~`!@#$%^&*()_-+={[}]|\:;"'<,>.?/    " (last 2 are space & tab here)
"~`!@#$%^&*()_-+={[}]|\\:;\"'<,>.?/ \t\r\n   " (last 2 are space & tab here, all these chars are escaped with \) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-03T00:36:00.263

这对我有用：

```
[A-Za-z0-9-]+[ 0-9A-Za-z#$%=@!{},`~&*()'<>?.:;_|^/+\t\r\n\[\]"-]* 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-04T07:29:57.437

所有受支持的键盘字符的 Reg-Ex 都为我工作：

```
/^[a-zA-Z0-9.!@?#"$%&:';()*\+,\/;\-=[\\\]\^_{|}<>~` ]+$/ 
```

除了 '~' 和 ',' 字符：

```
/^[a-zA-Z0-9.!@?#"$%&:';()*\+\/;\-=[\\\]\^_{|}<>` ]+$/ 
```

# java - 编程决定 java 或 .Net，db 或无 db

> ID：834004
> 
> 赞同：2
> 
> 时间：2009-05-07T10:54:38.023
> 
> 标签：java, .net, sql-server, database, berkeley-db

我在做编程决定时被卡住了，

我是 .Net 开发人员，我目前正在为我的客户端构建一个应用程序，该应用程序从第三方应用程序接收数据，然后它必须对值执行操作并将其发送到 webservice/servlet，然后将数据显示到网页，这里的问题是网页上发送给用户的数据（投票选项，计数等）必须最迟每 2 秒更新一次，

我在做一些决定时有很多困惑，

1) 数据提供者（第三方应用程序）推荐 Java 但不强制执行，虽然我擅长 .Net(C#)，但你会建议用 C# 还是 Java 构建应用程序。在优化和速度方面，哪个更好？你们有什么推荐的？

2）从第三方收到数据后，我和我的同事有不同的想法，我希望一旦收到数据，我们应该将其写入数据库（因为它们每次只发送几个固定字段） ，然后让 webservice/servlet 检索数据然后对其进行计算，我的理由是，如果我们保存它，我们还将拥有跟踪和历史数据以及用户思维模式，而我的同事说保存它到 db 会大大延迟应用程序，我们应该直接从应用程序中轮询数据，他还认为 db 很快就会变得庞大且缓慢，我们尝试这样做但它会导致 8 秒延迟（出于某种原因 tomcat如果它是 web 应用程序，则仅在每 7 次尝试后检索数据，如果它是 java 控制台应用程序，则每秒保存一次。，) 我的想法是，如果我们保存到 db 并从那里检索，我们可以让控制台应用程序每秒写入应用程序，然后根据我们想要的每秒左右使用 web 服务检索数据。

在这个场景中，你们认为什么是好的方法，我们应该保存到数据库还是不保存到数据库？

3）说即使我们确实保存到数据库，您认为使用 berkeley 或 sqlserver 会有所作为吗？我更喜欢将 sqlserver 用于 .net 和 berkeley 用于 java

我知道这是一个很大的问题，而且会很无聊，但任何帮助/建议将不胜感激，请帮助我们更清楚地了解这些问题堆栈溢出。

谢谢你的时间！

问候。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T10:58:58.230

1.  你知道 C#，然后使用它。如果没有其他技术限制，请使用您最了解的技术。

2.  在您尝试过这两种情况之前，不要考虑性能。做一个概念验证，你的方式和你同事的方式，看看性能差异以及历史数据优势是否值得性能差异。

3.  将 SQL Server 用于 C#。您可能需要考虑许可（无论如何您都更了解项目的上下文）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T10:59:26.670

如果您对 .NET 感到满意，为什么还要花时间在 Java 上？我对 Java 的担忧是无关紧要的，但无论如何你都会花时间学习 Java，可能会陷入与任何初学者在使用任何工具或技术时都会陷入的相同陷阱。

我说，如果您对 .NET 感到满意，请使用 .NET。最终结果不会有太大不同，但你会更快到达那里。

然后，进行计算并将数据库用作“缓存”的一种形式与保存跟踪记录不同。您可以从第三方应用程序返回结果，并将历史记录存储在数据库中。如果太慢，请排队。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T11:40:31.877

1.  使用您最熟悉的语言，只要它适合您的客户。

2.  询问您的客户是否必须保留数据，如果不需要，则不保留它。如果您必须坚持它，您可以异步执行它而不影响在线处理。

3.  我不知道区别，但答案取决于你想对持久数据做什么（你想保留多久，你需要备份，你愿意为解决方案付费）......所以如果你知道你想要实现什么，你可以选择正确的工具，也许它不会是一个数据库......

# sql-server-2005 - 如何在 T-SQL 中执行之前解析动态 SQL？

> ID：834006
> 
> 赞同：5
> 
> 时间：2009-05-07T10:55:05.697
> 
> 标签：sql-server-2005, tsql, parsing, dynamic-sql

在执行之前，我需要知道如何解析查询以了解它是否构建良好。如果解析正确则执行它，如果不正确则丢弃它。

我无法使用 SET NOEXEC、SET PARSEONLY、TRY/CATCH 来完成此操作。

我在循环中使用*动态 sql 。*有时*动态sql*不正确不是因为我的错，而是因为数据库中存在的信息。出于这个原因，我想在执行之前对其进行解析。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T11:06:09.120

这可能通过一些 sp_executesql 技巧来实现：

```
-- The query you would like to parse
declare @sql nvarchar(max)
set @sql = 'select 1'

declare @testsql nvarchar(max)
declare @result int
set @testsql = N'set parseonly on; ' + @sql
exec @result = sp_executesql @testsql

-- If it worked, execute it
if @result = 0
    begin
    exec sp_executesql @sql
    end 
```

如果我使用了不正确的查询，例如“salact 1”，@result 值非零。

TRY/CATCH 似乎不能很好地与 sp_executesql 一起使用，所以我改为检查返回值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T11:03:35.943

尝试使用 SET FMTONLY ON 和 SET FMTONLY OFF。

SET PARSEONLY ON 你的代码 SET PARSEONLY OFF 应该适用于大多数人。

[MSDN FMTONLY](http://msdn.microsoft.com/en-us/library/ms173839.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T11:12:56.137

你想达到什么目的？

如前所述，除非查询是可解析的，否则 T-SQL 不会编译。

如果您只是想有一种方法来验证查询是否正常（例如，验证您没有忘记 where 语句左右），那么 showplan 可能会对您有所帮助

```
set showplan_xml on 
```

这将告诉 sql server 只解析查询（查询本身永远不会执行）并返回它的执行计划。它主要用于性能问题，但也可以用作指针，以防查询确实不正确。

# osgi - 动态插件管理/更新

> ID：834011
> 
> 赞同：2
> 
> 时间：2009-05-07T10:56:01.920
> 
> 标签：osgi, equinox

我的意思是如果一个插件将[下载并]复制另一个插件到适当的文件夹或制作链接文件，它是否可以在不重新启动的情况下将其与平台动态集成？

* * *

因此，看起来可以构建一个永远在线的服务器，它会随着时间的推移而发展，而无需重新启动。这是必需的（不确定这个词，英语不是我的母语）功能吗？我的意思是企业需要它还是重新启动更容易也可以？我看到的另一个好处是旧版本的兼容性......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T14:45:51.367

当然。使用 OSGi 控制台，您可以（无需重新启动任何东西）使用“安装文件：...”命令安装新包，并使用“开始”启动它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T11:12:26.813

通常，在不重新启动平台的情况下安装和启动新包是展示 OSGi 新可能性的好方法。

但在我看来，你不应该在生产环境中这样使用它，因为以一种使这个过程可靠的方式来开发你的应用程序并不容易。

当然，通过新的捆绑软件将新功能添加到正在运行的 OSGi 应用程序中通常没有问题，而无需重新启动。但是如果你真的需要一个“永远在线的服务器”，情况就完全不同了，因为你的包之间存在依赖关系，这使得动态改变加载的包有点困难。这并非不可能，但我不会指望它。

所以是的，当您将更改部署到应用程序时，重新启动会更容易也可以。

# java - 如何在谷歌上嵌入 Java Web Start (with jnlp) 应用程序？

> ID：834027
> 
> 赞同：1
> 
> 时间：2009-05-07T10:59:27.123
> 
> 标签：java, jnlp, java-web-start

我用 Java 创建了一些简单的应用程序，并在我的本地机器上使用 Java Web Start（和 jnlp）“部署”了它。现在我想把它放在网上，从不同的人那里得到一些反馈。
我正在考虑将我的应用程序嵌入 Google 基础架构（pages.google.com/sites.google.com/blogger.com - 随便）。

问题：我该怎么做？我要在我的 .jnlp 文件中更改什么（现在我有硬编码的本地路径 - 'jnlp codebase="file:/D:/Projects/SomeApp/dist"...'）？
如何将文件结构（/../dist/somefiles 和 /../dist/lib/somefiles）嵌入到（提到的）Google 基础架构中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T00:39:53.490

我一直在寻找答案，但在任何地方都找不到。也许每个人都在 sourceforge.net 上托管，或者 Java Web Start 根本不流行。首先，我在新闻组上发现帖子说在 code.google.com 上您可以直接从 SVN 调用 .jnlp 文件。这鼓励我使用sites.google.com，而且它看起来非常简单。
1) 创建页面并在其中嵌入所有文件——为此，“文件柜”页面类型将是最好的。所以你会有一个页面[http://sites.google.com/site/MyPage](http://sites.google.com/site/MyPage)附有一堆罐子。
2）在您的launch.jnlp文件中进行以下编辑：
对于代码库

```
<jnlp codebase="http://sites.google.com/site/MyPage" href="launch.jnlp" spec="1.0+"> 
```

对于任何引用的罐子：

```
<jar href="http://sites.google.com/site/MyPage/SomeLibrary.jar"/> 
```

3）将launch.jnlp附加到MyPage，仅此而已。
4) 单击启动文件将启动应用程序。
只要您记得更新 launch.jnlp 中的链接，以更有条理的方式组织所有内容不会破坏任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T12:22:17.720

Sun 有一个[教程](http://java.sun.com/docs/books/tutorial/deployment/webstart/deploying.html)，其中介绍了如何设置文件。

您的问题将是 Google 系统的限制。我不能承认对这些服务有深入的了解，但是看看你提到的那些，我看不到任何上传任意文件的方法——这会使部署 .jars 变得很棘手。

您可能不得不考虑获得正常的网络托管。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T12:57:18.803

如果您需要在 WAR 文件中部署所有内容，那么 JnlpDownloadServlet 系统可能正是您所需要的，因为它允许您执行此操作。

[http://java.sun.com/javase/6/docs/technotes/guides/javaws/developersguide/downloadservletguide.html](http://java.sun.com/javase/6/docs/technotes/guides/javaws/developersguide/downloadservletguide.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-02T00:21:23.133

这显然是一种不需要文件在下载中的方式，但在 svn 中需要为上传的 jnlp 设置“svn:mime-type”属性，否则链接将不起作用。

我认为这是可行的，因为 svn apache 模块（谷歌必须使用）如果找到此属性，则会设置正确的内容类型。

# javascript - JS对象到JSON字符串？

> ID：834030
> 
> 赞同：11
> 
> 时间：2009-05-07T11:00:07.137
> 
> 标签：javascript, json, jsp, text

如何在 JavaScript 函数中将 JavaScript 对象转换为 JSON 字符串？我需要将 JSON 字符串传递给 JSP 页面。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-07T11:26:44.590

Crockford 的库中有两个示例方法（由@Anonymous 提出）：

JSON字符串到对象：

```
var obj = JSON.parse('{ "property":"value" }');
alert (obj.property);

// value 
```

对象转 JSON 字符串：

```
var str = JSON.stringify({ "property":"value" })
alert (str);

//{ "property":"value" } 
```

在大多数主要框架中也有内置的方法来执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T11:05:43.020

Quoth Crockford ( [http://www.json.org/js.html](http://www.json.org/js.html) ):

> 要将 JSON 文本转换为对象，可以使用 eval() 函数。eval() 调用 JavaScript 编译器。由于 JSON 是 JavaScript 的真子集，因此编译器将正确解析文本并生成对象结构。文本必须用括号括起来，以避免在 JavaScript 语法中出现歧义。
> 
> var myObject = eval('(' + myJSONtext + ')');
> 
> eval 函数非常快。但是，它可以编译和执行任何 JavaScript 程序，因此可能存在安全问题。当来源受信任且有能力时，指示使用 eval 。使用 JSON 解析器要安全得多。...
> 
> 为了防止这种情况，应该使用 JSON 解析器。JSON 解析器将仅识别 JSON 文本，拒绝所有脚本。在提供原生 JSON 支持的浏览器中，JSON 解析器也比 eval 快得多。预计原生 JSON 支持将包含在下一个 ECMAScript 标准中。
> 
> var myObject = JSON.parse(myJSONtext, reviver);

然后他在本文的其余部分开发了 JSON 原型。

Firefox 3 和 3.5 中使用的 Gecko 版本本机支持 JSON ( [https://developer.mozilla.org/En/JSON](https://developer.mozilla.org/En/JSON) )，如果您的项目仅限于最近的基于 Gecko 的应用程序，这可能会很有用。

* * *

正如下面所指出的，关于文本生成器（不是解析器）的有趣部分位于[https://github.com/douglascrockford/JSON-js/blob/master/json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)并与

> JSON stringifier 则相反，将 JavaScript 数据结构转换为 JSON 文本。JSON 不支持循环数据结构，因此请注意不要将循环结构赋予 JSON 字符串化符。
> 
> var myJSONText = JSON.stringify(myObject, replacer);

没有有用序列化的循环数据结构和对象显然是唯一需要注意的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T11:25:35.670

值得一提的是，匿名者的链接（[http://www.json.org/js.html](http://www.json.org/js.html)）将为您指明正确的方向，因为该页面*还*包含有关如何将 JavaScript 数据结构字符串化为 JSON 文本的信息：

> JSON stringifier 则相反，将 JavaScript 数据结构转换为 JSON 文本。

特别是，在页面底部查找指向开源 JSON 解析器和 JSON 字符串化器的链接。

# sql - 将结果集 ö 与 o 一起排序

> ID：834041
> 
> 赞同：1
> 
> 时间：2009-05-07T11:02:55.897
> 
> 标签：sql, db2, ibm-midrange, sql-order-by

我想订购一个结果集。我想用于排序的列包含德语变音符号，如 ö、ü 和 ä。我想要这些排序的列数据和普通字母。例子：

此刻，结果集的排序如下： ABCOXYZÖ

我希望它像这样订购：ABCOÖXYZ

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T11:29:58.577

从 DB2 9 开始，有一个 COLLATION_KEY 函数用于在 ORDER BY 子句中指定排序顺序：

```
ORDER BY COLLATION_KEY(field,...) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:13:14.743

在运行 SQL 之前查看更改排序顺序 - 它是 STRSQL、RUNSQLSTM 或 CHGJOB 命令上的 SRTSEQ 参数。

# .net - .NET 第 0 代堆大小

> ID：834042
> 
> 赞同：16
> 
> 时间：2009-05-07T11:03:00.560
> 
> 标签：.net, garbage-collection

是否可以在 .NET 中设置第 0 代堆的最小大小？

我有以下情况。我有一个函数，它分配大约 20-30 MB 的 1KB 对象，对它们做一些事情，然后终止，让所有分配的对象都被 GC-ed。现在，在性能监视器中，我可以看到第 0 代堆大小为 5-6 MB，这不足以接受我需要的所有 20-30 MB 对象。当我开始分配时，在某个时刻 gen0 GC 开始运行，并且由于需要所有对象，因此它将它们提升为 gen1。下次 GC 开始运行时，这些对象在 gen2 中得到提升。所以最后大约 15MB 的对象最终在 gen2 堆中。根据我的逻辑，这些是临时对象，绝不应该出现在 gen2 堆中。我相信问题出在 gen0 堆大小的大小上。但我不确定。我知道在 Java 中可以设置代堆的最小大小。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T11:18:28.823

不同代的大小是一个实现细节，我不知道有任何方法可以为 .NET 应用程序调整它。如果我的记忆正确地为我服务，第 0 代和第 1 代共享一个段，在 Win32 中为 16 MB，所以如果你确实创建了很多对象，如果它们仍然被引用，其中一些将被提升到更高的代（就像你描述）。

我想限制第 0 代大小的想法是确保 g0 集合便宜。如果第 0 代可以增长到任何规模，您的整体性能很可能会受到影响。

编辑：我相信 Jeffrey Richter 的书对此有一些细节，所以你可能想看看。

EDIT2：Richter 声明（第 502-507 页）第 0 代的初始预算为 256 KB，第 1 代的初始预算为 2 MB。然而，这不是一代人的规模。预算会根据需要进行调整，并且会根据应用程序的内存使用情况增加和减少。

然而，Joe Duffy 的 Professional .NET Framework 2.0 指出，临时代（即第 0 代和第 1 代）共享一个段，通常为 16 MB（第 117 页）。只有第 2 代允许根据需要增长（我假设 LOH 也允许根据需要增长，但从文本中我并不清楚）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T11:07:42.360

您确定不再引用这些对象吗？GC***非常***擅长根据应用程序的需要调整自身，并且不会将对象提升到第 2 代，除非您在某处为这些对象提供了根。

我认为如果你弄清楚这些根在哪里并确保你真的不再在任何地方引用这些对象，那么 GC 将开始为这些对象释放内存并且永远不会将它们提升到第 1 代，更不用说第 2 代了。另外，如果你这样做然后 GC 将检测到您需要第 0 代更大，并代表您增加堆的大小。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T14:10:08.410

谢谢你们的帮助。

嗯，情况很有趣。我从来没有提到我将那些 30MB 的对象存储在一个大小为 100000 的数组中。我首先分配该数组，然后用对象填充它。由于该数组大于 85K，因此该数组存储在大对象堆中。事实证明，垃圾收集要收集该堆中的对象，它需要运行 gen2 收集，因此每次大对象堆中没有足够的空间时，它都会运行 gen2 收集器，这会破坏性能。这是一个不断调用 gen2 集合的简单示例。您需要在调试模式下运行它（因为编译器优化）。

```
static void Main(string[] args)
{
     while (true)
     {
         byte[] objects = new byte[100000];
     }
} 
```

这是否意味着每当我需要一个大小大于 85K 的临时数组时，该数组最终会出现在大对象堆中？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T11:35:14.820

第 0 代堆最初的大小与 CPU 的缓存大小相适应。这样一来，小型临时对象甚至不需要移动到主内存。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-29T09:14:34.130

在第一代 0 可能会增加和减少，但这些都在未来。当进程运行时，初始化的托管堆在第 0 代中具有固定大小 256 KB（这意味着 Richter），因为现代计算机有 256 个或更多内存用于 2 级 CPU 的现金。第二。安德鲁，你是对的。当某个对象太大时，它会立即进入 gen2。我可以假设您想减小 gen0 的大小以激发更频繁地调用 GC 以清除未使用的空间并保持您的应用程序更轻巧。我在 SilverLight 网站上遇到同样的问题并搜索解决方案。我认为如果代码创建了很多具有根的对象，并且当 gen0 已满时，CLR 调用 GC 将它们移动到 gen1，然后当对象增长更多时将它们移动到 gen2。假设所有 3 代都快满了。然后例如调用GC。它会做什么。只是清除 generation0 ？第一个和第二个如何。我认为保持记忆光亮的解决方案如下。首先创建小而多的对象，而不是大而少的对象。第二个对象的内部引用必须是单向的，并且相互之间没有混乱的引用。不是动态创建的静态对象，例如根据来自数据库的记录，需要保存在全局变量中，并且在代码调用它们时不会再次创建。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T11:16:42.400

+1 给安德鲁。GC 是**自我调整**的，它可以即时了解应用程序的内存需求模式。
在您的情况下，如果 GC 执行 Gen 0 的收集并发现很多对象幸存/没有很多内存被回收，垃圾收集器将自动增加 Gen 0 预算/配额。

查看[GC Type members](http://msdn.microsoft.com/en-us/library/system.gc_members%28VS.80%29.aspx)，似乎没有办法以编程方式配置 GC 生成预算/大小。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T11:38:34.487

我认为没有任何选项可以在 .NET GC 中设置这些值。

乍一看，这种特殊情况似乎证明了有必要拥有这样的*高级*选项，但如果这将是一个*静态*选项，它将影响你程序的整个生命周期。您可以在运行时设置的*动态*选项将是理想的。

另外，我认为这不会极大地影响程序的性能，尽管如果您能够增加 gen(0) 大小，您可以释放一些内存（并获得*一些*性能）。

因为 GC 是自我调整的，所以 gen(0) 会自动增加大小，*BIG*对象迟早会被垃圾回收。

# c# - C#中的滚动事件

> ID：834043
> 
> 赞同：2
> 
> 时间：2009-05-07T11:03:04.243
> 
> 标签：c#, .net, winforms

假设我有一个`DataGridView`显示指定表的大约 100 条记录的控件。每次用户向下滚动到最低点时，我都想`DataSet`在`DataGridView`.

我知道 DataGridView 控件有一个类似的滚动事件 `private void DataGridView_Scroll(object sender, ScrollEventArgs e)`，并且`ScrollEventArg`s 给了我`ScrollOrientation`和`ScrollEventType`. 但是我如何准确地确定滚动到达滚动条末端的时间呢？

坦克。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T11:13:07.713

听起来你可能想看看["virtual mode"](http://msdn.microsoft.com/en-us/library/ms171622.aspx)。数据绑定的工作方式不同，但它非常适合延迟数据获取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T11:15:03.183

每个 DataGridViewRow 都有一个“Displayed”属性，该属性指示该行当前是否显示在屏幕上。因此，您可以执行以下操作：

```
if(this.dataGridView1.Rows[this.dataGridView1.Rows.Count - 1].Displayed)
{
   //last rows is displayed, do what you gotta do
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T12:44:08.290

使用 DataReadear 读取一些记录。然后在 DataGridView 的 Scroll 事件中，检查属性 FirstDisplayedScrollingRowIndex 是否接近加载的记录数，再次使用 DataReader 获取另一串行等等。

# jquery - 切换手风琴菜单时更改背景图像

> ID：834048
> 
> 赞同：0
> 
> 时间：2009-05-07T11:04:17.890
> 
> 标签：jquery, image, background, accordion, toggle

我有一个手风琴菜单，每个菜单标题都有一个小箭头 img，当菜单向下和向上滑动时会发生变化。

这是到目前为止的代码：

```
 $(document).ready(function() {
    $("div.menu_body").hide();
    $("#menuheader div.menu_head div.detailsPanel").toggle(function() {
      $(this).addClass("detailsPanelSelected").parent(this).next("div.menu_body").slideToggle(300).siblings("div.menu_body").slideUp("slow");
    },
      function() {

 $(this).removeClass("detailsPanelSelected").parent(this).next("div.menu_body").slideUp("slow");
      }
    ); 
```

当我一次切换一个菜单项时，这很好用。

但是假设我展开一个菜单项，然后单击另一个菜单标题。发生的情况是第一个菜单项向上滑动，而新单击的菜单项向下滑动，就像预期的那样。但箭头 gif 不会在向上滑动的菜单上变回。发生这种情况是因为它的切换功能仍处于第一个状态，如果我再次单击它，从而删除“detailsPanelSelected”类，所发生的只是图像变回。查看代码，这是意料之中的。

所以我的问题是，当单击另一个菜单标题时，如何删除菜单项“detailsPanelSelected”？我可以以某种方式重置挂起的切换功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T20:15:43.697

尝试这样的事情：

$("#menuheader div.menu_head div.detailsPanel").toggle(function() {

$(".detailsPanelSelected").each(function(i){ this.removeClass("detailPanelSelected"); })

```
$(this).addClass("detailsPanelSelected").parent(this).next("div.menu_body").slideToggle(300).siblings("div.menu_body").slideUp("slow"); 
```

}

代码的重要部分是：

$(".detailsPanelSelected").each(function(i){ this.removeClass("detailPanelSelected"); })

它应该放在您添加更改箭头方向的类的代码上方......因此所有元素都回到它们的关闭状态，然后您的下一个函数“打开”正确的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-26T01:21:22.203

听起来你可以使用 Slidorion。它是图像滑块和手风琴的组合。检查一下，可能有用：

[http://www.slidorion.com](http://www.slidorion.com)

# asp.net-mvc - MVC - 让会员提供者工作

> ID：834060
> 
> 赞同：0
> 
> 时间：2009-05-07T11:07:49.363
> 
> 标签：asp.net-mvc

我有使用 VS2008 开发的 MVC 1.0 应用程序。勇敢的！

我安装了 SQL 2005 的开发人员版。

我运行了 aspnet_regsql.exe 以将成员身份架构添加到我的数据库中。

当我尝试注册用户时，出现此错误：

此版本的 SQL Server 不支持用户实例登录标志。连接将被关闭。

我已修改 machine.config 以指向我的服务器和数据库。还将 LocalSqlServer 连接字符串添加到 web.config 相同的错误。

任何想法为什么会发生此错误？

马尔科姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T15:32:48.900

这是配置错误。看起来正在使用的连接字符串正在尝试创建或使用不存在的数据库。确保您的连接字符串指向正确的数据库。默认情况下，应用程序服务（成员身份、配置文件、角色）使用项目 web.config 文件中的 ApplicationServices 连接字符串。

# asp.net-mvc - 网站安全陷阱，我可以在 ASP.NET MVC 中做什么来避免/减轻它们？

> ID：834061
> 
> 赞同：4
> 
> 时间：2009-05-07T11:08:15.447
> 
> 标签：asp.net-mvc, security

我刚刚开始着手实施我的第一个面向公众的网站。由于我是新手，我认为是否有必要列出常见陷阱，它们是什么以及如何避免它们。

我正在寻找类似的东西：

*   SQL 注入（我知道这个，但如果有人知道分析网站注入漏洞的工具，那将很有用）。
*   密码存储不正确。我知道我应该用盐。ASP.NET MVC 为我提供了哪些工具来执行此操作？
*   登录速率限制（Jeff 今天在 Coding Horror 中提到过）。我将如何在 ASP.NET MVC 中实现这一点？我可以使用标准的会员提供者实现来做到这一点吗？
*   XSS 到底是什么，ASP.NET MVC 工具箱中有哪些工具可以避免它？
*   等等

如果在另一个问题中处理了某个主题，那么快速总结和指向该问题的链接将是一个好主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T11:28:55.023

*   SQL 注入 - 使用参数化查询！如果您使用 StringBuilder 类或字符串连接来构建 SQL 查询，那么您很可能容易受到 SQL 注入的攻击。
*   XSS - 如果你使用 MVC 助手`=Html.Encode(yourPossibleCompromisedData)`来向你的页面呈现数据，你应该没问题。这些帮助程序旨在阻止在浏览器上执行注入的代码。ASP.NET 还具有表单保护功能，可以阻止恶意代码发布到您的操作中（这不是 MVC，而是 aspnet 本身）。
*   密码存储不正确。使用内置的 aspnet Membership 提供程序 - 它使用良好的模式（salt..）来存储密码等。
*   登录率限制 - 我相信有一些贡献项目可以缓解这种情况（如果内置提供程序还没有这样做）
*   XSS 到底是什么，ASP.NET MVC 工具箱中有哪些工具可以避免它？阅读：[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)。MVC 1.0`=Html.ValidationSummary()`为表单提供了隐藏字段，以减少跨站点脚本。

# php - 不需要的 mod_rewrite 行为

> ID：834066
> 
> 赞同：0
> 
> 时间：2009-05-07T11:09:59.983
> 
> 标签：php, apache, mod-rewrite, url-rewriting

我刚刚在 ubuntu 上重新安装了灯栈，并为我的默认网站启用了 mod_rewrite 模块。当整个查询字符串保存在一个变量中时，我想要的是类似于 drupal 的查询。为此，可以使用以下 mod_rewrite 代码：

```
RewriteRule ^(.*)$ home.php?q=$1 [L,QSA] 
```

当某个字符串以目录中已经存在的文件名开头时，问题就开始了；例如，如果我打开一个页面：`http://localhost/home/blablabla`- $_GET 的内容如下：

```
Array ( [q] => home.php ) 
```

我想看到的是：

```
Array ( [q] => home/blablabla ) 
```

我认为这是默认网站或 mod_rewrite 配置的东西，但我就是想不通......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T11:21:09.893

您必须排除`home.php`：

```
RewriteCond %{REQUEST_URI} !^/home\.php$
RewriteRule ^(.*)$ home.php?q=$1 [L,QSA] 
```

或者您排除每个现有文件：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ home.php?q=$1 [L,QSA] 
```

原因：该标志导致使用新的重写 URL[`L`进行内部重定向。](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)并且新的 URL`home.php`也由表达式匹配`^(.*)$`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T11:20:46.180

不*完全*是您问题的答案，但这不是 _SERVER["REQUEST_URI"] 和 _SERVER["REDIRECT_URL"] 的用途吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T00:53:59.707

看起来您可能需要最近添加的 [DPI] 标志来丢弃 PATH_INFO 并进行多次每个目录的重写。

# wpf - 部署 XBAP 应用程序？

> ID：834067
> 
> 赞同：0
> 
> 时间：2009-05-07T11:11:06.673
> 
> 标签：wpf, deployment, xbap, full-trust

我们有一个 WPF 应用程序，它有两种风格，具有一致的 UI 等，一种从 Windows 操作系统桌面运行，另一种应该作为 XBAP 应用程序运行。

目前我正在将 XBAP 应用程序发布到我的 localhost 机器 IIS（Windows XP Pro），而且我已经在我的场景中根据需要启用了完全信任（Microsoft .NET Framework 2.0 配置，URL 完全信任）+ pfx 文件（对于我的机器当另一台机器上的用户从其机器上的 IE 浏览器键入 URL 时，将安装该名称）。

假设我想将 XBAP 应用程序出售给客户，因为他想要一个集中式应用程序而不是桌面应用程序，那么我将如何去做呢？有 XBAP 部署经验的人可以告诉我吗？我是否应该进行设置以在他的 Web 服务器上设置应用程序，仅此而已？（假设 web 服务器有 .net 3.5 sp1）我应该告诉他这样做 pfx 和完全信任怎么样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T22:18:39.907

我曾在使用 ClickOnce 作为引擎将二进制文件部署为 XBAP 以及标准 WPF 的类似情况下工作。要在客户站点安装 XBAP 网站，我们将让安装程序在 IIS 中创建虚拟目录，然后运行自定义步骤来签署 ClickOnce 清单。此步骤是必要的，因为应用程序需要访问包含客户环境信息的生成配置文件。

下面是一些关于我在使用 XBAP 时遇到的问题的说明。

*   Framework v3.0 或更高版本对客户端工作站的依赖性。（处理 WPF 时的更多一般说明，因为除非您使用受控桌面，否则您可能还必须部署它）
*   莫名其妙地，用户的 ClickOnce 缓存将失效，要求用户必须使用以下命令清除缓存：rundll32 %windir%\system32\dfshim.dll CleanOnlineAppCache
*   错误安装 Framework v3.0/Internet Explorer 需要重新创建用户配置文件、重新安装 dotNet 框架或重新安装 Internet Explorer。
*   部署失败时来自 ClickOnce 的错误消息。很多时候它会报告一般的部署异常，并且修复将是上述步骤之一。
*   在网站前使用任何身份验证时，例如 ASP.Net 表单身份验证、受信任的 IIS（不在 Intranet 上）或类似 ISA 的代理，Microsoft 堆栈中存在一个问题，即 IE 无法将身份验证传递给ClickOnce 引擎。问题在于 IE 将成功进行身份验证，但无法将安全上下文传递给 ClickOnce。当 ClickOnce 尝试部署应用程序文件时，它将没有安全上下文，并且身份验证将失败。但是，如果您转到 Internet 选项--> 安全--> 选择“本地 Intranet”--> 单击“自定义级别...”，您将看到设置列表。滚动到列表底部并在用户身份验证下 --> 登录 --> 确保选择了“使用当前用户名和密码自动登录”选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T21:20:33.410

要运行 XBAP 应用程序，您的**客户端**还需要运行 .NET 框架。在未安装 .NET Framework 的情况下无法运行 XBAP。

默认情况下，仅向您的应用程序授予部分信任权限。要启用 FullTrust，您需要在客户端授予应用程序 URL 的权限：

```
caspol -m -ag 1 -url "http://server/app/*" FullTrust -exclusive on 
```

或者您可以将安全证书添加到客户端受信任的证书中。此处提供了分步指南：[如何将 WPF-XBAP 作为完全信任应用程序运行](http://blogs.microsoft.co.il/blogs/maxim/archive/2008/03/05/wpf-xbap-as-full-trust-application.aspx)。

# html - 如何避免 th 元素从 IE6/7 中的 tr 元素继承属性

> ID：834069
> 
> 赞同：0
> 
> 时间：2009-05-07T11:11:15.893
> 
> 标签：html, cross-browser, css

我有一个表，在表头上有一个重复的背景图像：

```
thead tr
{
   border-collapse:collapse;
   background: #D3D2D2 url(images/background-table-header.gif) repeat-x top;
} 
```

这在 Firefox 和 Internet Explorer 中都适用，但是如果我们希望某些列标题显示排序方向，我们使用 Sorted 类和 Direction 来装饰 th。并使用 css 添加方向图标。

```
 thead th.Sorted
  {
     background-repeat: no-repeat;
     background-position: center left;  
     padding-left: 0.6em;   
  }
  thead th.Sorted.Ascending
  {
     background-image: url(images/background-table-sorted-column-ascending.gif);
  }
  thead th.Sorted.Descending
  {
     background-image: url(images/background-table-sorted-column-descending.gif);
  } 
```

问题是在 Internet Explorer 6 和 7 中，来自 tr 的背景颜色被继承（使用 Internet Explorer 开发工具栏发现）到 th。这意味着 th`#D3D2D2`在 tr 背景上绘制颜色。Firefox、Chrome 和 IE8 没有这个问题，所以我怀疑这是一个 IE6/7 错误。我考虑过在 IE6/7 上使用 a `background-color:transparant`，`thead th.Sorted`但 IE6/7 只是绘制了主体背景（看起来它在主体和 th 之间的其他层上切了一个洞）。

它应该是这样的：

[![正确解释 css/html](https://i.stack.imgur.com/9Be7R.png)](https://i.stack.imgur.com/9Be7R.png)

这就是它在 IE6 和 IE7 中的样子：

[![IE6和IE7错误渲染](https://i.stack.imgur.com/vRRIh.png)](https://i.stack.imgur.com/vRRIh.png)

下面是我为这个问题创建的 HTML 片段。

```
 <table cellspacing='0'>
    <thead>
      <tr>
        <th>First column</th>
        <th>Second column</th>
        <th class="Sorted Ascending">Third column</th>
        <th>Fourth column</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Data</td>
        <td>Data</td>
        <td>Data</td>
        <td>Data</td>
      </tr>
    </tbody>
  </table> 
```

我怎么能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:50:37.100

似乎 IE 有一个错误 - 它将`tr`' 的背景图像呈现为单元格的背景图像，因此单元格的图像会覆盖行的图像。元素也存在相同的错误`thead`，但它似乎与 table 元素配合得很好。
因此，您可以将背景图像应用到表格而不是标题行：

```
table
{
   background: #D3D2D2 url(images/background-table-header.gif) repeat-x top;
} 
```

因为背景图片在桌子上，它可能会超出标题行，所以您可能还想设置 the`tbody`或其`tr`s 的背景颜色：

```
tbody
{
   background-color: #fff;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T11:30:35.440

这很奇怪......因为这很好用（虽然我没有使用图像，但它应该是一样的，不是吗？

```
<html>
<head>
    <style type="text/css">
    thead tr{
        background-color:#000;
                    color: #fff;
    }
    th.sorted.Ascending{
        background-color:#fff;
                    color: #000;
    }
    th.sorted.Descending{
        background-color:#AAA;
    }

    </style>
</head>
<body>
    <table>
        <thead>
          <tr>
            <th>First column</th>
            <th>Second column</th>
            <th class="Sorted Ascending">Third column</th>
            <th>Fourth column</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
            <td>Data</td>
          </tr>
        </tbody>
    </table>
</body>
</html> 
```

//编辑// 您可能想要这样做：

```
background: #FFFFFF url(http://www.tizag.com/pics/cssT/smallPic.jpg) no-repeat scroll 0 0; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T11:36:14.460

它看起来像 IE 中的一个错误。我在没有单元格背景图像的情况下尝试了它：

```
thead tr
{
   border-collapse:collapse;
   background-image:url(http://www.freefoto.com/images/1223/09/1223_09_1---Big-Blue-Sky--Montana--USA_web.jpg);
   background-color:gray;
}

  thead th.Sorted
  {
     background-repeat: no-repeat;
     background-position: center left; /** this line changes the position! */  
     padding-left: 0.6em;   
  } 
```

，并且背景图像被重新定位在该单元格上！我猜 IE 一次渲染行的背景一个单元格。
为此，您可能必须在单元格中添加另一个元素。

* * *

好的，另一个想法：如果您将背景图像放在元素
上，它似乎可以正常工作。也是越野车。您可以尝试通过添加规则来包含它们（table 和 tr）：`table``thead`

```
table
{
   background: #D3D2D2 url(images/background-table-header.gif) repeat-x top;
} 
```

# winforms - Clickonce 请求许可协议

> ID：834071
> 
> 赞同：8
> 
> 时间：2009-05-07T11:12:33.970
> 
> 标签：winforms, clickonce

是否可以为 Win Form 应用程序构建 ClickOnce 部署，在继续之前要求用户同意许可协议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T11:20:55.917

用户[Heath8041](http://social.msdn.microsoft.com/Forums/en-US/user?user=Heath8041)[来自 MSDN](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/301d7b68-914b-4a05-8f2b-d9aa53f69cca)的回答：

**在 VS2005 中为 clickonce 应用程序显示 EULA 的偷偷摸摸的方式**

*这是通过最终用户许可协议安装 clickonce 应用程序的方法。基本上，您构建了一个可再分发组件，该组件可以在发布窗口下的先决条件对话框中看到。如果您愿意，这提供了一种让您的所有应用程序重用相同协议的好方法。这很简单，在这种情况下，您只需要创建三个文件（“eula.txt”、“product.xml”和“package.xml”）和两个文件夹（“EULApackage”和“en”）。我在下面记录了我如何设置我的所有内容。效果很好。您唯一需要更改的是组件的名称，当然您需要将自己的最终用户许可协议保​​存为 eula.txt。组件需要放在以下路径：C:\Program Files\Microsoft Visual Studio 8\SDK\v2。0\BootStrapper\Packages 在此文件夹中，您应该会看到一些用于其他可再发行组件的子文件夹。首先为您的组件创建一个新的子目录。我打电话给我的 EULApackage。在这个新文件夹中，您需要以下内容。- 一个名为 product.xml 的文件和一个名为“en”（英语）的子文件夹，您可以使用 product.xml 文件做各种事情，但这是我的样子*

```
<?xml version="1.0" encoding="utf-8" ?>

<Product
  xmlns="http://schemas.microsoft.com/developer/2004/01/bootstrapper"
  ProductCode="EULA.Bootstrap.Component"
>
  <!-- Defines list of files to be copied on build -->
  <PackageFiles>
    <PackageFile Name="en/eula.txt"/>
  </PackageFiles>

  <Commands>
    <Command PackageFile="en/eula.txt"
      Arguments='' >

       <ExitCodes>
         <DefaultExitCode Result="Fail" FormatMessageFromSystem="true" String="GeneralFailure" />
       </ExitCodes>

    </Command>
  </Commands>
</Product> 
```

*在这种情况下，文件 eula.txt 是我的许可协议的文本文件。请注意，它不是 rtf 文件。Rtf 使用此方法无法正确显示。

现在在我的“en”子文件夹中，我放了 eula.txt 文件和另一个名为 package.xml 的 xml 文件，同样，这个 xml 文件可以用来做各种事情

这是我的版本的内容*

```
 <?xml version="1.0" encoding="utf-8" ?>

<Package
  xmlns="http://schemas.microsoft.com/developer/2004/01/bootstrapper"
  Name="DisplayName"
  Culture="Culture"
  LicenseAgreement="eula.txt">

    <PackageFiles>
        <PackageFile Name="eula.txt"/>
    </PackageFiles>

  <!-- Defines a localizable string table for error messages and url's  -->
  <Strings>
    <String Name="DisplayName">Texas Instruments End User License Agreement</String>
    <String Name="Culture">en</String>

    <String Name="CancelFailure">User Failed to Accept Texas Instruments End User License Agreement.</String>
    <String Name="GeneralFailure">A fatal error occurred during the installation of ELUA Component Execution</String>
    <String Name="AdminRequired">You do not have the permissions required to install this application.  Please contact your administrator.</String>
  </Strings>    
</Package> 
```

*注意：您在 DisplayName 字段中输入的任何内容都是用户在遇到 eula 文本时将看到的内容> 先决条件 您应该看到 DisplayName 字段。只需将此作为您应用的先决条件。当用户在 publish.htm 文件上单击安装时，它将在标准许可接受对话框中向用户显示您的 eula.txt 文件的内容。如果选择接受你的东西安装，如果他们拒绝，那么它会很好地退出并且他们的系统上没有安装任何东西。如果您弄乱了这两个文件中的任何一个的格式，或者如果您遗漏了“en”子文件夹，那么该组件将不会显示在先决条件对话框中（发布时）*

*附加说明：虽然这很好用，但它是一种关于方法的方法，它们是围绕 eula 的方法，例如，如果您的 publish.htm 文件允许他们直接运行应用程序（我猜没有启动引导程序）但是如果他们点击安装按钮它将运行。这还有一个好处，就是每次发布 clickonce 应用程序的更新时都不会运行。他们必须运行引导程序才能显示 eula（通过单击 publish.htm 上的安装按钮）我通过查看路径 C:\ \Microsoft Visual Studio 8\SDK\v2.0\BootStrapper\Packages。您可以查看那些其他组件 product.xml 和 package.xml 文件，看看他们用它们做了什么很酷的事情。祝你好运*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-03T19:05:25.157

对于任何试图这样做的人来说，它都可以工作......我正在使用 Visual Studio 2008，liek Coppermill 说，位置是“C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages\”

我还必须在 product.xml 中添加一些其他内容：

```
<?xml version="1.0" encoding="utf-8" ?>

<Product
  xmlns="http://schemas.microsoft.com/developer/2004/01/bootstrapper"
  ProductCode="EULA.Bootstrap.Component"
>
  <!-- Defines list of files to be copied on build -->
  <PackageFiles CopyAllPackageFiles="false">
    <PackageFile Name="en/Empty.exe"/>
  </PackageFiles>

  <Commands>
      <Command PackageFile="en/Empty.exe" Arguments='/silent' >
       <ExitCodes>
    <ExitCode Value="0" Result="Success"/>
         <DefaultExitCode Result="Fail" FormatMessageFromSystem="true" String="GeneralFailure" />
       </ExitCodes>

    </Command>
  </Commands>
</Product> 
```

我还必须创建一个“什么都不做”可执行文件，否则 elcu.txt 会在记事本中打开。不管怎样，祝你好运...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T11:16:15.473

我不认为有。

如果您从网页部署 click-once 应用程序，您可以让用户在安装应用程序之前接受该协议。效果将是相同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-19T06:16:19.233

如果我们使用 Visual Studio 2010，那么我们已经将它添加到`"C:\Program Files\Microsoft SDKs\Windows\v7.0A\Bootstrapper\Packages"`文件夹中。现在可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-12T20:43:39.807

我发布这个作为对 Yuki Izumi 帖子的回复。我没有使用批处理文件，而是添加了一个空的 vbs 文件并将 product.xml 修改为

```
<Command PackageFile="en/empty.vbs" Arguments='' > 
```

这是防止 eula.txt 在单击接受时打开的另一种方法。我还尝试了一个 rtf 文件。显示正确（VS 2015）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-27T11:03:30.223

您可以在此处检查通用引导程序路径：

```
Computer\HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\GenericBootstrapper 
```

MSDN：[https ://docs.microsoft.com/en-us/visualstudio/deployment/creating-bootstrapper-packages?view=vs-2017](https://docs.microsoft.com/en-us/visualstudio/deployment/creating-bootstrapper-packages?view=vs-2017)

# mysql - MySql：使用 IN 运算符选择语句

> ID：834074
> 
> 赞同：1
> 
> 时间：2009-05-07T11:13:03.407
> 
> 标签：mysql, select, csv

我有一个包含多个字段的表和一个包含 3 个逗号分隔值的字段

```
 Column 1 Column 2 
    1        1,2,3
    2        2,3,4
    3        6,7,8 
```

现在我想运行一个 SQL 查询来获取我作为输入发送的值的行。

就像上面的例子一样，如果我发送一个值 2 作为函数的输入，它必须返回第一 2 行。

我尝试使用 IN 运算符但失败了，因为它没有获取我作为 CSV 的第二个或第三个值发送的输入的行。在此示例中，它不返回第一行。

有人可以帮我解决这个问题吗？

提前致谢， 阿卡什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T11:18:00.230

您可以使用`FIND_IN_SET()`：

```
SELECT column1 FROM table WHERE FIND_IN_SET('2', column2) != 0 
```

`IN`运算符基本上是许多 OR 的快捷方式：

```
WHERE column2 = IN ('a', 'b', 'c') 
```

给出相同的结果

```
WHERE (column2 = 'a' OR column2 = 'b' OR column2 = 'c') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T11:18:44.347

如果我正确理解了您的问题，那么尝试如何 - 从表中选择 Column1，Column2 其中 Column1 <=

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T11:20:04.733

您应该可以使用 Like 来执行此操作，例如：

```
SELECT * FROM tablename WHERE [Column 2] LIKE ("%2%"); 
```

# python - 如何在 Ubuntu 8.04 LTS 64 位上安装 python-igraph？

> ID：834076
> 
> 赞同：4
> 
> 时间：2009-05-07T11:13:10.147
> 
> 标签：python, 64-bit, ubuntu-8.04, igraph

显然`libigraph`，并且`python-igraph`是地球上唯一无法通过`apt-get`或`easy_install`在 Ubuntu 8.04 LTS 64 位下安装的软件包。

从源代码从源代码安装似乎都很顺利......直到我尝试使用它们。

当我运行 python 时，我得到：

```
>>> import igraph
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "igraph/__init__.py", line 30, in <module>
    from igraph.core import *
 ImportError: No module named core 
```

或（如果我使用 python-igraph 的 easy_install 版本）

```
>>> import igraph
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "build/bdist.linux-x86_64/egg/igraph/__init__.py", line 30, in <module>
  File "build/bdist.linux-x86_64/egg/igraph/core.py", line 7, in <module>
  File "build/bdist.linux-x86_64/egg/igraph/core.py", line 6, in __bootstrap__
ImportError: libigraph.so.0: cannot open shared object file: No such file or directory 
```

我从这里抓住了来源

igraph 0.5.2 = [http://igraph.sourceforge.net/download.html](http://igraph.sourceforge.net/download.html)

python-igraph 0.5.2 = [http://pypi.python.org/pypi/python-igraph/0.5.2](http://pypi.python.org/pypi/python-igraph/0.5.2)

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T20:48:20.343

你是怎么编译的？您是否进行了 make install（如果有的话）。

至于easy_install版本中的“找不到库”错误，我会尝试以下方法：

1.  ' `sudo updatedb`' (更新定位数据库)
2.  ' `locate libigraph.so.0`' （查找此文件在您的系统上的位置。如果您进行了 make install，它可能会转到 /usr/local/lib ... 还是在 python lib 目录中？）
3.  查看当前 LD_LIBRARY_PATH (' `echo $LD_LIBRARY_PATH`') 中是否缺少此文件所在的目录。
4.  如果此目录不在此处，请将其添加尝试 ' `export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/yourdirhere`' （通过将其添加到 /etc/ld.so.conf 使其永久化）/ ' `ldconfig -n /yourdirhere`'

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-19T12:05:35.143

请注意，截至 2009 年 11 月 8 日，Launchpad 提供了 igraph 的官方 Ubuntu 软件包。有关说明，请参阅 Launchpad 上的相应[页面](https://launchpad.net/~igraph/+archive/ppa)。与早期的 Debian 软件包存储库不同，这应该适用于 32 位和 64 位架构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T11:18:36.483

libigraph.so.0 在哪里？它似乎不在 python 寻找的位置，例如 /usr/lib 、 /usr/local/lib 等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-30T06:38:41.477

我按照[http://socialsynergyweb.org/network/blog/install-python-igraph-ubuntu-904-64-bit](http://socialsynergyweb.org/network/blog/install-python-igraph-ubuntu-904-64-bit)中的步骤操作。为了运行实际的 igraph，我使用了脚本 python-igraph-0.5.2/scripts/igraph。现在我可以使用 igraph 了。如果我不使用脚本/igraph 脚本，我会遇到与您相同的错误。

# wpf - WPF TreeView：ExpandAll() 方法在哪里

> ID：834081
> 
> 赞同：45
> 
> 时间：2009-05-07T11:14:41.873
> 
> 标签：wpf, treeview

如何在 WPF 中展开所有 TreeView 节点？在 WinForms 中有一个 ExpandAll() 方法可以做到这一点。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2011-08-05T07:09:52.347

这可能会有所帮助

```
<TreeView>
    <TreeView.ItemContainerStyle>
        <Style TargetType="{x:Type TreeViewItem}">
            <Setter Property="IsExpanded" Value="True" />
        </Style>
    </TreeView.ItemContainerStyle>
</TreeView> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-03-11T19:21:53.520

使用 XAML Treeview 样式，您必须有一个像上面写的那样的属性设置器：

在 Cs 文件中，编写这样的方法，在我的示例中，我使用了一个按钮，我的树视图的名称是 myTV：

```
private void ExpandAll(ItemsControl items, bool expand)
    {
        foreach (object obj in items.Items)
        {
            ItemsControl childControl = items.ItemContainerGenerator.ContainerFromItem(obj) as ItemsControl;
            if (childControl != null)
            {
                ExpandAll(childControl, expand);
            }
            TreeViewItem item = childControl as TreeViewItem;
            if (item != null)
                item.IsExpanded = true;
        }
    }

    private void btnExpandAll_Click(object sender, RoutedEventArgs e)
    {

        foreach (object item in this.myTV.Items)
        {
            TreeViewItem treeItem = this.myTV.ItemContainerGenerator.ContainerFromItem(item) as TreeViewItem;
            if (treeItem != null)
                ExpandAll(treeItem, true);
            treeItem.IsExpanded = true;
        }
    } 
```

希望它可以帮助你。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-07T11:16:08.220

WPF TreeView 类没有 ExpandAll 方法。因此，您必须遍历节点并将它们的 IsExpanded 属性设置为 true。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-04-15T13:37:34.420

试试这个

```
private void btnExpandAll_Click(object sender, RoutedEventArgs e)
{
    foreach(var item in tvES.Items)
    {
        var tvi = item as TreeViewItem;
        if (tvi != null)
            tvi.ExpandSubtree();
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-05-24T09:55:15.833

@Pierre-Olivier 提供的答案很好。

就个人而言，我更喜欢使用堆栈而不是递归，例如在您不知道数据嵌套有多深的情况下。更好的是，它可以作为扩展函数提供：

```
public static void ExpandAll(this TreeViewItem treeViewItem, bool isExpanded = true)
{
    var stack = new Stack<TreeViewItem>(treeViewItem.Items.Cast<TreeViewItem>());
    while(stack.Count > 0)
    {
        TreeViewItem item = stack.Pop();

        foreach(var child in item.Items)
        {
            var childContainer = child as TreeViewItem;
            if(childContainer == null)
            {
                childContainer = item.ItemContainerGenerator.ContainerFromItem(child) as TreeViewItem;
            }

            stack.Push(childContainer);
        }

        item.IsExpanded = isExpanded;
    }
}

public static void CollapseAll(this TreeViewItem treeViewItem)
{
    treeViewItem.ExpandAll(false);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-06T15:40:33.997

除了 user2779123 的评论，我知道这早就得到了回答，但我也建议 Pierre-Olivier Pignon 的代码推送 treeItem.IsExpanded = true; 不仅被移动到空检查的范围内，而且通过将其移动到 ExpandAll 过程，因为它似乎是以允许扩展和折叠树结构的格式编写的，并且将它移动到那里会将根节点添加到这个功能设计。

按照下面的例子：

```
private void ExpandAll(ItemsControl items, bool expand)
{
    items.IsExpanded = expand;
    foreach (object obj in items.Items)
    {
        ItemsControl childControl = items.ItemContainerGenerator.ContainerFromItem(obj) as ItemsControl;
        if (childControl != null)
        {
            ExpandAll(childControl, expand);
        }
        TreeViewItem item = childControl as TreeViewItem;
        if (item != null)
            item.IsExpanded = true;
    }
}

private void btnExpandAll_Click(object sender, RoutedEventArgs e)
{

    foreach (object item in this.myTV.Items)
    {
        TreeViewItem treeItem = this.myTV.ItemContainerGenerator.ContainerFromItem(item) as TreeViewItem;
        if (treeItem != null)
            ExpandAll(treeItem, true);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-08T13:08:17.070

```
 /// <summary>
    /// Collapse the TreeView.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void _collapseTreeView_button_Click(object sender, RoutedEventArgs e)
    {
        _ordersParentChild_TreeView.UpdateLayout();
        if (_ordersParentChild_TreeView.Items.Count > 0)
        {
            var rootTreeViewItem = _ordersParentChild_TreeView.Items[0] as TreeViewItem;
            if (rootTreeViewItem != null)
            {
                rootTreeViewItem.IsExpanded = false;
            }
        }
    }
    /// <summary>
    /// Expand the TreeView.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void _expandTreeView_button_Click(object sender, RoutedEventArgs e)
    {
        _ordersParentChild_TreeView.UpdateLayout();
        if(_ordersParentChild_TreeView.Items.Count > 0)
        {
            var rootTreeViewItem = _ordersParentChild_TreeView.Items[0] as TreeViewItem;
            if (rootTreeViewItem != null)
            {
                rootTreeViewItem.ExpandSubtree();
            }
        }
    }
} 
```

# c# - 具有 AJAX 安全性的 Web 服务最佳实践

> ID：834083
> 
> 赞同：0
> 
> 时间：2009-05-07T11:15:22.293
> 
> 标签：c#, asp.net, web-services

我正在使用脚本管理器在客户端调用 Web 方法，但正如您所知，Web 方法无法通过用户控制工作，因此您必须创建一个 Web 服务来执行此操作。

这对我来说很好，但我有以下担忧

*   如果您在 ASPX 页面中使用 Web 方法，则代码对用户是不可见的，那么我如何阻止用户浏览我的服务并查看我的代码，而只让页面或用户控件调用 Web 服务。
*   无论如何，用户是否可以使用这种方法来劫持我的代码，例如跨站点脚本、Pinging 等。
*   使用这种方法，我用来调用服务或所有内容的 java 脚本代码块对客户端来说究竟是什么可见的？
*   任何额外的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T11:28:03.323

所有的 javascript 都是可见的，但这不是一个真正的问题。

将属性 EnableSession 添加到您的 web 方法将允许您使用与页面中相同的安全代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T11:33:44.997

无需进入 .NET 指定，因为那不是我的领域：

任何在客户端上运行的东西（例如 JavaScript）对用户来说都是可见的，用户可以在他们的系统范围内随意修改它。

任何在服务器上运行的东西对用户都是不可见的。

为了使用户能够单击按钮并在服务器上运行代码，浏览器必须向服务器发送 HTTP 请求。简单的方法是使用表格。这提供了一种[结构化数据的标准方法](http://www.w3.org/TR/html4/interact/forms.html#h-17.13.3)。

更复杂的方法涉及使用 JavaScript 显式构造请求（而不是让浏览器处理它）。这允许使用“访问新页面”以外的其他方法提交数据，这为 Ajax 提供了所需的灵活性。

使用任何方法，您基本上都定义了一个可通过 HTTP 访问的公共 API。

您需要防御两大类攻击（无论是否涉及 Ajax，它仍然是同一类型的 API）。

1.  直接攻击 - 健全地检查您的数据，不要让用户在未经身份验证的情况下编辑内容。
2.  间接攻击——第三方诱骗用户输入不良数据（例如，通过另一个站点上的链接要求他们的浏览器向您的站点发出 HTTP 请求）。防御措施包括要求客户端在提交数据之前请求一次性令牌（例如，通过在提供表单时生成隐藏输入以阻止第三方使用他们自己的带有恶意数据的表单并将用户提交到您的站点） JS）。

简而言之：**使用与不涉及 JS 时相同的防御措施。**

# iphone - 如何根据设置选择在标签栏视图中创建动态更新的视图？

> ID：834085
> 
> 赞同：0
> 
> 时间：2009-05-07T11:15:52.807
> 
> 标签：iphone, cocoa-touch, uitabbarcontroller

菜鸟问题....

我创建了一个标签栏应用程序。它有四个选项卡并且工作正常。每个视图都是使用 XIB 创建的，并且实际上是静态的。每个视图都接受用户输入并在屏幕上做出响应。

我需要做的是更改用户拥有的输入选项 - 实际上删除了一些 UITextFields，具体取决于用户在设置中选择的选项。

我已经创建了 root.plist 并创建了设置，没问题我还为更改后的 UI 创建了额外的 XIBS，但我不知道该怎么做，就是按需将这些调用到选项卡视图控制器中。实际上，标签一有 3 个可能的视图，标签二有 3 个可能的视图等。但我只希望显示与用户设置选择相关的那个？

说得通？

作为参考，如果我们调用不同的视图 - UIInputViewA1, ...A2,....A3 UIInputViewB1,....B2....B3 等。

希望有人能帮忙，整晚都在网上拖网试图让我明白这一点。开始 iPhone 开发圣经也无济于事。

如果您需要更多信息，请大声疾呼。

干杯

保罗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T13:47:36.767

为什么不根据设置以编程方式添加/删除控件，而不是将一个 xib 完全交换为另一个呢？只需确保您的 xib 中的所有控件都链接到文件所有者中的插座，这样您就可以从代码中访问它们。首先，只需将“隐藏”消息发送到要隐藏的控件即可。稍后，您应该学习如何在不再需要这些控件时正确删除和取消分配它们。

# regex - 具有最新预索引的大型源代码集的文本搜索工具？

> ID：834093
> 
> 赞同：4
> 
> 时间：2009-05-07T11:17:06.893
> 
> 标签：regex, full-text-search, code-search-engine

我正在维护一些中型 C++ 项目的分支（每个分支约 15k 个文件）。很多时候，我必须在所有项目文件中搜索给定的字符串或正则表达式。目前我正在使用 Total Commander，它具有我想要的所有功能（区分大小写、正则表达式、文件名掩码），但是这个工具每次都会扫描所有文件，所以它需要太多时间。

你知道任何文本搜索工具，它可以预先索引整个源代码树并允许快速查找模式吗？返回所有匹配的文件是必须的，预览找到的模式环境会很好。当然，当某些事情发生变化时，索引必须立即更新。

Visual Studio 搜索是不够的，它只扫描源文件（不是元数据或自定义资源）。

这种工具存在吗？我正在使用 Windows XP。

**编辑**：我找到了非常有用的工具，请参阅我自己的答案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T15:08:53.653

我在这里找到了非常有用的工具：[http ://code.google.com/p/ndexer/](http://code.google.com/p/ndexer/)

我把它推荐给了每一个人！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T11:27:56.883

cscope 能够索引 c 文件，在某种程度上也能够索引 c++。我个人使用的 KDE 前端 KScope 比 cscope 的 ui 用户友好。

除此之外，您可能想看看[OpenGrok](http://opengrok.github.io/OpenGrok/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T17:36:27.607

我不确定（我没有经验），但我会试试 Eclipse CDT。它为您的所有源编制索引以快速查找符号，类似于 Eclipse JDT（Java 工具）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T11:22:37.190

回避该问题的一种直接方法是将所有源代码放在 RAM 磁盘上。通过以这种方式加速文件 IO，您将看到性能的大幅提升，而无需更改您的工具链。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T13:39:29.657

请参阅 [http://aaron.oirt.rutgers.edu/myapp/docs/W1300.testAndDemo](http://aaron.oirt.rutgers.edu/myapp/docs/W1300.testAndDemo) 并点击“搜索演示”链接到代码树搜索演示。 这将完全满足您的要求，它是 WHIFF 的标​​准演示组件。您必须添加 Pygments 插件才能从二进制文件中提取感兴趣的字符串（或将整个文件读取为“文本”）——开箱即用的索引器将忽略 Pygments 无法识别的文件。有一个简单的技巧可以让它“吃掉所有东西”——如果你想了解更多信息，请告诉我。[](http://aaron.oirt.rutgers.edu/myapp/docs/W1300.testAndDemo)

用于搜索的安装和命令行界面在[http://aaron.oirt.rutgers.edu/myapp/docs/W1300_1000.search](http://aaron.oirt.rutgers.edu/myapp/docs/W1300_1000.search)中有描述。[](http://aaron.oirt.rutgers.edu/myapp/docs/W1300_1000.search)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T14:01:38.667

您可以尝试 Google 桌面搜索，或者将[Lucene](http://lucene.apache.org/java/docs/)或[clucene](http://sourceforge.net/projects/clucene/)（移植到 c++ 的 lucene）作为通用索引工具。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T17:50:28.553

我知道您不一定需要 webapp，但请尝试[Open Grok](http://opengrok.github.io/OpenGrok/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-07T17:53:14.430

Windows 索引服务似乎符合您的所有条件。

# asp.net - 使用“分页”创建动态文本框

> ID：834101
> 
> 赞同：0
> 
> 时间：2009-05-07T11:20:02.500
> 
> 标签：asp.net, dynamic, textbox, runtime, paging

基于此处的解决方案：[从“无限”动态控件将值输入数据库](https://stackoverflow.com/questions/827175/entering-values-into-database-from-unlimited-dynamic-controls)

我可以在运行时成功创建动态 asp.net 控件。所以如果用户输入 10，它会显示 10 个文本框，如果用户输入 50，它会显示 50。到目前为止还不错。但是 50 个文本框会使页面变得非常冗长。

我应该如何并排显示文本框？分页是个好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T11:54:23.090

可滚动的 div 将是一个更好的选择。

将所有文本框渲染为具有固定高度和宽度的 div 的子级，并将 oveflow 属性设置为 auto。

# xml - Delphi 是否有“Fast Infoset”XML 压缩库？

> ID：834104
> 
> 赞同：2
> 
> 时间：2009-05-07T11:20:17.930
> 
> 标签：xml, delphi, compression, fastinfoset, infoset

我想在一些企业应用程序中支持快速信息集，以减少 XML 和 SOAP 交换的网络流量。

正如 Wikipedia 上所记录的，C# 和 Java 有[Fast Infoset](http://en.wikipedia.org/wiki/Fast_Infoset)实现。

根据[OSS Fast Infoset Tools](http://www.oss.com/xml/products/fi.html)的说法，实现已经在多个平台上可用，包括 Microsoft .NET 和 .NET CF、Sun GlassFish、BEA WebLogic。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T11:57:01.353

看起来不像。所以如果你想在 Delphi 程序中使用它，你有两个选择。您可以通过 P/Invoke（或 Hydra）使用 .NET 版本，或者，如果任务不是太大（没有查看项目的大小），您可以尝试自己将其移植到 Delphi。如果 Java 和 C# 可以处理这个库，Delphi 几乎肯定可以将其变成“更快的信息集”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T15:36:34.953

如果您只关注传输（因此网络带宽），那么使用标准 HTTP 压缩将使您在不改变当前工具链中的任何内容的情况下减少 70-90% 的消耗。

为了充分利用 Fast Infoset，您的工具链还需要使用二进制表示来处理数据。如果您将它传递给 SOAP Delphi 层或标准 XML 处理器，则情况并非如此。

很高兴在 Delphi 中看到 Fast Infoset 支持，但它的域在 CPU/内存受限的设备中，这与我所知道的大多数 Delphi 用途并不完全一致。

# ruby-on-rails - 在 RubyOnRails 应用程序中生成图表

> ID：834105
> 
> 赞同：6
> 
> 时间：2009-05-07T11:20:41.160
> 
> 标签：ruby-on-rails, ruby, graph

我想知道其他人发现什么是 Rails 应用程序的最佳图形库/插件/宝石等。

当我说最好的时候，我想我的意思是易于实施和自定义图表的能力。

我以前使用过 openflashchart2 并且喜欢它的整体外观/效果，尽管根据需要自定义所有内容有时会很痛苦。您有经验或建议可以为我指明*更好*的方向吗？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T11:35:50.623

对于简单的本地生成图，请查看[Gruff](http://nubyonrails.com/pages/gruff)。

同样值得一看的是各种 Google Charts ruby​​ 库，[googlecharts](http://github.com/mattetti/googlecharts/)就是其中之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T13:57:48.457

我使用 protochart，它是一个原型图表库。我更喜欢它而不是服务器端的东西，因为它不会给服务器增加太多压力，而且我认为图表看起来更好，API 更容易使用。

[http://deensoft.com/lab/protochart/](http://deensoft.com/lab/protochart/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:26:25.357

[GoogleCharts](https://github.com/mattetti/googlecharts) looks like the best supported Google Charts ruby lib.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-04T12:42:17.190

gnuplot还有一个[ruby​​ gem](http://rgplot.rubyforge.org/)。虽然这可能不像 Gruff 或 googlecharts 那样易于使用，但它将为更科学的图表提供更大的灵活性。例如，我上次检查时，谷歌图表或 gruff 都没有提供对绘制置信区间的支持，而 gnuplot 提供了支持。

# visual-studio - TFS 查询（在 Visual Studio 中）以获取所有签到

> ID：834107
> 
> 赞同：28
> 
> 时间：2009-05-07T11:20:53.357
> 
> 标签：visual-studio, version-control, tfs

我正在尝试通过 Visual Studio Team Explorer 中的 TFS 查询编辑器获取所有签到的列表（限制/按日期排序）。

我可以查询列出所有错误、冲刺积压项目或产品积压项目，但我找不到实际签入。是否有可能或者我应该直接在数据库上进行（SQL）查询。

想法？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-07T11:33:12.737

只需打开 Team Explorer 窗口，展开 TFS 项目，然后双击那里的 Source Control 节点。

然后，您只需在 TFS 源代码管理中右键单击项目或目录并选择查看历史记录，然后您将获得所有提交。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-06-16T21:31:28.590

命令行[`tf`实用程序](http://msdn.microsoft.com/en-us/library/z51z7zy0.aspx)（可通过 VS2010 命令提示符获得）提供了一种检索指定文件或文件夹的所有签入历史记录的方法。

具体来说，该[`tf history`命令](http://msdn.microsoft.com/en-us/library/yxtbh4yh.aspx)允许按日期范围进行过滤。例如，要获取当前 6 月（即 6/1/11 - 6/30/11）的所有签到，然后使用`\version`带有日期选项 ( `D"[start date]"~"[end date]"`) 的参数：

```
tf history c:\MyProject /recursive /version:D"06/1/11"~D"06/30/11" 
```

这将启动一个交互式 GUI 窗口，显示在这些日期之间发生的所有签到。GUI 窗口相当于 Visual Studio 中显示的历史记录窗口。因此，您可以深入查看变更集详细信息，将文件与以前的版本进行比较等。

如果您只是想在没有 GUI 窗口的情况下查看历史列表，请添加参数`/noprompt`：

```
tf history c:\MyProject /recursive /version:D"06/1/11"~D"06/30/11" /noprompt 
```

这会将结果输出到命令提示符控制台窗口。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-10-02T19:54:21.023

```
USE TfsVersionControl    

select distinct top 100 c.CreationDate,c.Comment,u.DisplayName, v.Fullpath
from tbl_changeset as c
 join tbl_identity as u on u.Identityid = c.OwnerId
 join dbo.tbl_Version as v on v.Versionfrom = c.ChangeSetId 
Order by c.CreationDate desc 
```

这是我为查看最近的更改而制作的 sql 报告。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-17T15:18:47.083

这是我们使用的

```
USE [Tfs_DefaultCollection]   

SELECT distinct cs.CreationDate, cs.[ChangeSetId], c.DisplayPart, cs.[Comment] 
from [tbl_ChangeSet] AS cs 
left outer JOIN [tbl_Identity] AS i ON cs.[OwnerId] = i.[IdentityId] 
left outer JOIN [Constants] AS c ON i.[TeamFoundationId] = c.[TeamFoundationId] 
left outer join dbo.tbl_Version as v on v.Versionfrom = cs.ChangeSetId 
WHERE creationdate > '04/12/2012' 
and (v.fullpath like '%\Web%' 
or v.FullPath like '%\Databases%')
ORDER BY cs.[CreationDate] desc 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-07T11:42:39.763

查看[Attrice 的 TFS Sidekick](http://www.attrice.info/cm/tfs/index.htm)。这是一个非常好的免费工具，我经常使用。它有一个历史辅助工具，允许您在 UI 左侧选择的源树节点上按用户查询变更集。您可以按日期对结果进行排序。您还可以右键单击变更集以查看文件和工作项等详细信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-07T13:31:16.990

您可以通过右键单击解决方案资源管理器或源代码管理资源管理器窗口中的文件/文件夹来查看文件或文件夹的历史记录，然后如果您想要将其复制/粘贴到其他位置，则可以复制/粘贴历史记录的内容。

更有趣的是，在您似乎正在谈论的用例中，您实际上可以从 TFS 数据仓库中提取所有此类信息，并在 Excel 中对其进行自己的报告。请查看我在此主题上所做的以下博客文章以获取更多信息：

[TFS 数据仓库入门](http://www.woodwardweb.com/vsts/getting_started.html)

# eclipse - 历史：为什么 Eclipse 基金会选择了 OSGi？

> ID：834115
> 
> 赞同：1
> 
> 时间：2009-05-07T11:22:52.387
> 
> 标签：eclipse, osgi, history

当时有并发技术吗？与其他技术和本机（3.0 之前）技术相比，OSGi 的优势是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T11:31:42.520

也许 OSGi 的主要好处是能够拥有独立的独立包。这允许一个捆绑包对全局类加载器隐藏其依赖项。

很多时候，在构建大型系统时，一个组件需要某个库，而另一个组件使用同一库的不同但不兼容的版本。在这种情况下，选择一个版本的库而不是另一个版本会破坏另一个版本。

JAR 和 WAR 的单独类加载器是早期的尝试，它允许对单独和隔离组件的依赖关系进行一些模块化和管理。如果您查看旧版本的 WebLogic 等，您会注意到它们在 weblogic.* 下重新打包常用库（例如 Xerces），以免与您的应用程序可能希望包含的 Xerces 发生冲突。

使用 OSGI，每个包可能只公开一个包含内核接口的包。然后，每个包都可以使用自己的库，而不必担心上面描述的类路径类问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T11:34:44.777

请访问以下网站：

[Eclipse 3.0平台：采用OSGi技术](http://www.entrepreneur.com/tradejournals/article/133183815.html)

# iphone - 如何用 iPhone 制作指南针？

> ID：834117
> 
> 赞同：6
> 
> 时间：2009-05-07T11:23:08.580
> 
> 标签：iphone, navigation, gps, magnetometer

在谷歌上搜索后，我问自己：

是否可以使用 iPhone 3G 的 GPS 传感器构建指南针（简单显示航向/方向）？

我怀疑，这只有在设备移动时才有可能。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T12:09:07.580

用原来的 iPhone 和 iPhone 3G，没有。

iPhone 3GS 将于 2009 年 6 月上市，是的。它包括一个允许指南针应用的磁力计。

*   [http://www.apple.com/iphone/iphone-3g-s/maps-compass.html](http://www.apple.com/iphone/iphone-3g-s/maps-compass.html)
*   [http://www.google.com/search?q=iphone%20magnetometer](http://www.google.com/search?q=iphone%20magnetometer)

[核心位置框架](https://developer.apple.com/iphone/library/documentation/CoreLocation/Reference/CoreLocation_Framework/index.html#//apple_ref/doc/uid/TP40007123)在[CLHeading](https://developer.apple.com/iphone/library/documentation/CoreLocation/Reference/CLHeading_Class/Reference/Reference.html)类中提供了这些信息。您可以通过该键检查[设备是否支持](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedFeatures/AdvancedFeatures.html)该功能`magnetometer`。

正如其他人所说，使用 iPhone 3G 时，您可以在手机移动时分辨出移动的方向，但您无法分辨出手机的方向来向用户指示方向。当然可以指导用户以某种方式定位手机，结合移动可以准确地指示方向。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T11:29:51.497

是的，你是对的，这是唯一的方法。虽然我认为一旦你知道了方向，你就可以通过加速度传感器跟踪手机的小动作，并准确地绘制出方向，即使原来的动作停止了。

**注意：**这是过时的信息，在 3G 出来之前它是正确的。不幸的是，我无法删除已接受的答案，所以请看下面。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-13T21:22:59.013

作为对此的更新，iPhone 3GS 确实包含一个可用于应用程序的实际可用的数字罗盘。它使编写这样的应用程序变得微不足道。

查看`CLHeading`类和`magneticHeading`属性。

[http://developer.apple.com/iphone/library/documentation/CoreLocation/Reference/CLHeading_Class/Reference/Reference.html](http://developer.apple.com/iphone/library/documentation/CoreLocation/Reference/CLHeading_Class/Reference/Reference.html)

假设手机有时间在地理上定位自己，您还可以获得真正的北航向。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T11:50:25.470

通过扫描可用的应用程序，我得出结论，有两种方法可以为当前的 iPhone 3G 制作指南针。

1.  要求手机移动。使用 GPS 数据的差异来确定方向。
2.  要求用户将手机指向太阳。使用 GPS 和时间信息来确定方向。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-07T11:57:10.977

指南针只会显示您移动的方向。它不会告诉您 iPhone 所在的方向。因此，即使使用加速度计来跟踪 iPhone 是否已转动/移动，也不一定会让您在显示屏上指向北方。

（即，您不会知道它是侧向移动还是我们是否将 iPhone 倒置或其他任何东西。您只会知道您在哪里移动......）

**编辑 2010 年 12 月：** 由于撰写了这篇原始帖子，iPhone 3GS（于 09 年夏季推出）和更新的型号都有电子指南针。这个指南针可以在不移动时显示正确的方向......（这意味着指南针现在能够指向北方，无论 iPhone 持有或移动的方向如何。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-09-10T06:27:15.683

您只需要实现位置管理器功能即可找到您的 iPhone 指向的确切方向。

所以，你可以检查一下：

CLLocationManager *locationManager; [locationManager startUpdatingHeading];

并且每当您调用 startUpdatingHeading() 时，它都会调用您需要从位置管理器覆盖的“- (void)locationManager:(CLLocationManager *)manager didUpdateHeading:(CLHeading *)newHeading”方法。

就是这样，您可以通过 newHeading.magneticHeading 或 newHeading.trueHeading 找到 iPhone 3GS 指向的方向。

您会惊讶地发现，您可以得到与磁罗盘给出的完全相同的方向。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T08:59:59.430

附带说明一下，iphone 中的加速度计不会仅跟踪旋转，因此您无法对位置和方向进行正确的 6 轴惯性跟踪。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-07T11:28:58.190

我认为你的怀疑是正确的，GPS 位置是一个没有任何方向信息的单点。要确定方向，您需要两个点来创建方向向量。汽车导航系统的工作方式相同。如果汽车正在移动，它们只能显示方向矢量。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-07T12:21:36.957

如果您实现模拟时钟，则可以使用以下说明叠加罗盘表盘。

这可用于“校准”指南针并使用加速度计在手机移动时保持指向北方。

显然这不是超级准确......“高科技问题的低技术解决方案”

（指令取自[http://www.qwerty.co.za](http://www.qwerty.co.za/sundials/howto/truenorthw.html)）

**在北半球**，将手表放在平坦的地面上，将时针指向太阳的方向。南北线再次将时针和 12 点钟线之间的角度分成两半。

**在南半球**，将手表放在平坦的地面上，将数字 12 指向太阳。南北线是将时针与 12 点钟线之间的夹角分成两半的线。

# tfs - 如何从 TFS 中的 tbl_Content 表中获取文件

> ID：834118
> 
> 赞同：0
> 
> 时间：2009-05-07T11:23:28.920
> 
> 标签：tfs

这里的数据是压缩的，需要什么样的解压才能得到文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T13:27:19.967

答案是你不应该去那里。TFS 数据库的架构未记录在案，可能会发生更改，并且 Microsoft 不支持直接查询它。它实际上在服务包之间经历了非常大的变化，更不用说版本了。

那就是说。存储文件时，TFS 使用 zip 压缩的组合以及使用 Windows 用来处理 Windows 更新等的相同 delta 引擎存储文件修订之间的 delta。

要从 TFS 正常访问文件，您需要使用 .NET API 或 tf.exe 命令行与有效的服务器通信。

如果您想编辑您的问题以解释为什么您需要访问表格，这可能有助于为您指明正确的方向。您是否正在尝试从 TFS SQL 备份或其他东西中恢复数据？

# svn - Subversion 在添加后忽略 classes 目录（并链接到 src 目录）

> ID：834119
> 
> 赞同：1
> 
> 时间：2009-05-07T11:23:53.490
> 
> 标签：svn

我有一个现有的 JAVA subversion 存储库，其中已经添加了 classes 目录。由于某种原因，类目录指向存储库中的源目录，因为每次我们尝试忽略或删除类目录时，它都会对源目录应用相同的更改。我在 Windows Vista 上使用 TortoiseSVN。

如何忽略目录并终止链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T11:32:26.107

听起来您的工作副本混淆了。尝试删除它并重新检查它。您可以通过查看应该向您显示存储库 url 的属性（在您的 WC 中）来检查存储库中每个目录的签出位置。

如果不是这种情况，您是否在本地驱动器上设置了将 2 个目录关联在一起的连接？

# f# - 为什么这些记录类型会发生冲突？

> ID：834121
> 
> 赞同：1
> 
> 时间：2009-05-07T11:25:23.347
> 
> 标签：f#, record

考虑以下记录类型：

```
type drCode1Body = {DrCode : byte ; Name : string ; Timestamp : DateTime ; Size : uint32 ; Options : byte}
type drCode2Body = {DrCode : byte ; LastBlock : byte ; BlockNumber : uint16 ; BlockSize : uint16 ; BlockData : array<byte>}
type drCode4Body = {DrCode : byte ; Name : string ; Timestamp : DateTime ; Options : byte ; Size : uint16 ; Data : array<byte>} 
```

如果我尝试创建这样的实例（代码片段，而不是完整代码）：

```
{DrCode = 1uy ; Name = name ; Timestamp = timestamp ; Size = size ; Options = options}        

{DrCode = 2uy ; LastBlock = lastBlock ; BlockNumber = blockNumber ; BlockSize = blockSize ; BlockData = blockData}

{DrCode = 4uy ; Name = name ; Timestamp = timestamp ; Options = options ; Size = size ; Data = data } 
```

它不接受第一行有效。即使第一行中的大小是 uint32 值。它只是说“没有为字段'数据'分配任务”。

更改参数的名称也无济于事，我也尝试过：

```
 {new drCode1Body with DrCode = 1uy and Name = name and Timestamp = timestamp and Size = size and Options = options} 
```

然后我得到以下异常：

此表达式的类型为 drCode1Body，但此处与类型 drCode4Body 一起使用

虽然我在这里清楚地表明了我想要的记录类型。

这是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T11:38:20.447

你可以写例如

```
{drCode1Body.DrCode = 1uy ; Name = name ; ... 
```

当记录字段标签重叠时消除歧义。

（实际上，当 F# 开始读取标签时，它会向后搜索带有这些标签的第一个记录类型......一旦它看到 DrCode 和 Name，它就会认为“你肯定是指 drCode4Body！”......通过在第一个字段标签，您将类型推断引导到正确的方向。）

下面的代码在 F# 1.9.6.2 上编译：

```
#light
open System
type drCode1Body = 
  {DrCode : byte; Name : string; Timestamp : DateTime; Size : uint32; Options : byte}
type drCode2Body = 
  {DrCode : byte; LastBlock : byte; BlockNumber : uint16; BlockSize : uint16; BlockData : array<byte>}
type drCode4Body = 
  {DrCode : byte; Name : string; Timestamp : DateTime; Options : byte; Size : uint16; Data : array<byte>}
let name = ""
let timestamp = DateTime.Now 
let size = 0u
let size2 = 0us
let options = 0uy
let lastBlock = 0uy
let blockNumber = 0us
let blockSize = 0us
let blockData = [|0uy|]
let data = [|0uy|]
let r1 = {drCode1Body.DrCode = 1uy; Name = name; Timestamp = timestamp; Size = size; Options = options}        
let r2 = {DrCode = 2uy; LastBlock = lastBlock; BlockNumber = blockNumber; BlockSize = blockSize; BlockData = blockData}
let r3 = {DrCode = 4uy; Name = name; Timestamp = timestamp; Options = options; Size = size2; Data = data } 
```

# java - 是否可以从 csh 变量中的 java 程序中捕获 system.out.print？

> ID：834123
> 
> 赞同：1
> 
> 时间：2009-05-07T11:25:39.883
> 
> 标签：java, csh

我知道这是蹩脚的方式来做到这一点。我们需要在调用 shell 脚本中捕获一个在 Java 程序中动态生成的字符串，然后在以后使用它。

这也将在现有的 csh 文件中完成。

我们考虑了使用 putenv/setenv 将其导出到环境变量的选项......这是一个更好的选择吗？如果有怎么用？

网上似乎缺乏关于如何有效使用 sentenv() 或 putenv() 以及为此导入哪些库的示例代码。

具有 getenv() 方法的系统类不显示我的 putenv() 或 setenv()。非常感谢任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T11:30:53.647

您应该能够像在 bash 中一样使用反引号语法（在当今的 bash 中，建议使用更有用的 $-syntax ），只使用[命令替换。](http://www.mkssoftware.com/docs/man1/csh.1.asp#Command_Substitution)像这样：

```
$ set A=`java MyProgram`
$ echo $A 
```

或非常相似的东西

你不能使用环境；使用它无法“向后”交流；子进程不能改变父进程的环境。

**更新**：在示例中添加了“set”关键字，d'oh。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T11:49:46.907

从第一个答案扩展：

你可能想这样做： $ A= `java MyProgram | grep <something>` $ echo $A

假设 MyProgram 输出不止一行，您想捕获的内容在哪里。

如果java程序使用System.err.print...而不是System.out.print....则需要增强为$A=`java MyProgram 2>&1 | grep <something>`

希望能帮助到你 ：-）

# sql-server - ADO.NET 调用 T-SQL 存储过程会导致 SqlTimeoutException

> ID：834124
> 
> 赞同：31
> 
> 时间：2009-05-07T11:25:43.067
> 
> 标签：sql-server, tsql, ado.net, timeout, output-parameter

我有一个带有签名的 T-SQL 存储过程

```
CREATE PROCEDURE MyProc
@recordCount INT OUTPUT
@param1 INT
... 
```

当直接在 Sql Server 中执行时，该过程在 5 秒内运行，返回几个结果集，总计约 100 行。

使用 ADO.NET`SqlDataAdapter.Fill`方法调用此过程以填充 a`Dataset`会导致 a`SqlTimeoutException`在`SqlCommand`3 分钟后（指定的超时间隔）。

更改存储过程，使其不再具有输出参数，并将所需的输出值作为最后一个结果集返回，解决了问题，整个过程按预期在 5 秒内运行。

但为什么？

我不想在不了解我是否真的解决了问题的情况下浏览我的代码库并修改此类行为的所有实例。

另一件需要注意的是，这仅在一个特定的服务器上很明显，该服务器的数据集比我们运行的其他类似数据库要大。肯定不是 Sql Server 设置？

**更新**

进入框架源，问题似乎在于元数据检索。对象的`ConsumeMetaData`方法`SqlDataReader`无限期挂起。但是，我在其他数据库上运行了测试并且无法重现，因此当通过 ADO.NET 调用此过程时，这是一个特定于数据库的问题......太好了。

**更新二**

已确认如果我将代码更改为`OleDbDataAdapter`与 SQLOLEDB 或 SQLNCLI 提供程序类型一起使用，问题仍然存在。肯定跟关系有关。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-08T09:45:03.657

一旦我确定问题的根源是 ADO.NET 连接，这个[线程](https://stackoverflow.com/questions/250713/sqldataadapter-fill-method-slow)就会引导我找到答案。

基本上，默认情况下通过 Sql Server Management Studio (SSMS) 的连接具有 SET `ARITHABORT ON`。ADO.NET 连接没有。

直接通过 SSMS设置`ARITHABORT OFF`和执行查询给了我同样缓慢的响应时间。

使用或不使用此设置运行时的主要区别是为两个调用创建不同的查询计划。When `ARITHABORT`was `OFF`，SSMS 命令将使用 ADO.NET 连接正在使用的预编译缓存查询计划，因此会超时。

通过以管理员身份在数据库上运行以下命令，无论`ARITHABORT`设置如何，所有查询都会按预期运行。

```
DBCC DROPCLEANBUFFERS
DBCC FREEPROCCACHE 
```

我只能假设已编译的查询计划已损坏或无效。

我将在另一个[线程上将此作为解决方案（我已对答案投了赞成票）](https://stackoverflow.com/questions/250713/sqldataadapter-fill-method-slow)

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T11:34:34.930

我的立场是正确的 - 是的，你可以同时拥有 - 一个**OUTPUT**参数以及一组被返回的行。你每天学习新的东西 ：-）

至于为什么会发生超时 - 嗯....很难说。一个快速的小样本对我来说很好。你能发布你的存储过程（至少是它的相关部分）吗？

我们在谈论多少行，在这里返回？

在存储过程中的什么时候，您正在计算需要作为 OUTPUT 参数返回的行数？

如果您尝试将另一个参数添加`MaxRows`到您的 SProc 作为测试并对`SELECT TOP (@MaxRows).......`您的数据进行测试，该怎么办？这会很快回来吗？

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-24T16:15:46.477

简而言之 - 我通过强制 SQL Server 使用最合适的索引来限制 lob 逻辑读取来解决我的问题，因为它无法自行解决。

在长 -

在尝试了所有其他建议的答案后，我刚刚遇到了这个问题并以不同的方式解决了它。在 SSMS 中，查询在约 3 秒内运行，但在从 .Net MVC Web 应用程序调用时超时。

SSMS 中的统计信息 IO 输出告诉我，一张表上有超过 195,500,000 次 lob 逻辑读取（具有聚集列存储索引的 20M 行表，也有行索引，但没有“LOB”列）。我从执行计划中注意到，大部分负载 (76%) 来自对其中一个行索引的索引查找。我使用了以下内容：

```
from [table] with (index([clustered columnstore index name])) 
```

在我的查询中强制使用聚集列存储索引，我的查询减少到 <1s，lob 逻辑读取从 >195M 下降到 <6k，现在从 web 应用程序调用 SP 时，它是往返1.3 秒。

我尝试了选项重新编译，设置 arithabort，参数嗅探，最后 SQL Server 只是无法确定要使用哪个索引。顺便说一句，这也是一个极端情况，也是我唯一一次不得不在这个数据库中强制索引。

# iphone - Shark 用于分析 iPhone 应用程序

> ID：834135
> 
> 赞同：1
> 
> 时间：2009-05-07T11:29:32.370
> 
> 标签：iphone, xcode, shark

我正在使用 Shark 在 iphone 上分析我的应用程序。根据 [http://developer.apple.com/iphone/library/documentation/DeveloperTools/Conceptual/SharkUserGuide/SelectingExecutiontoSampleorTrace/SelectingExecutiontoSampleorTrace.html#//apple_ref/doc/uid/TP40005233-CH13-SW19中的 Shark 用户指南中的说明](http://developer.apple.com/iphone/library/documentation/DeveloperTools/Conceptual/SharkUserGuide/SelectingExecutiontoSampleorTrace/SelectingExecutiontoSampleorTrace.html#//apple_ref/doc/uid/TP40005233-CH13-SW19)

我能够为我的应用程序生成配置文件。但是我的应用程序中的大多数功能在符号标题下显示为未知。这是因为我使用的是应用程序的发布版本。用户指南建议可以使用符号化信息和应用程序的符号丰富的二进制生成符号信息。因此，首先我生成了保留调试信息的应用程序的调试版本，然后生成了发布版本并使用鲨鱼进行分析，然后使用 FILE/symbolicate 选项并从 Debug-iphoneOs 中选择了应用程序的调试版本。我得到错误符号化失败。任何人都可以提出一种方法来消除这个错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-02T06:39:35.317

如果你想使用 File->Symbolicate 来分析你的 iPhone 应用程序，我相信你需要在你的 iPhone 上分析调试版本，而不是发布版本。至少我过去是这样让它工作的。这样，当您使用 Debug-iphoneos 中的构建进行符号化时，您将引用相同的图像。

# java - 如何使映射字段继承自 JPA 中的超类瞬态？

> ID：834138
> 
> 赞同：11
> 
> 时间：2009-05-07T11:30:11.650
> 
> 标签：java, database, orm, jpa, mapping

我有一个无法更改的旧架构。我正在使用通用功能的基类，它包含一个嵌入式对象。有一个通常映射在嵌入对象中的字段，它只需要在一个（许多）子类的持久性 ID 中。我创建了一个包含它的新 id 类，但随后我收到该字段被映射两次的错误。下面是一些示例代码，为了保持读者的理智，这些代码被大大简化了：

```
@MappedSuperclass
class BaseClass {
    @Embedded
    private Data data;
}

@Entity
class SubClass extends BaseClass {
    @EmbeddedId
    private SubClassId id;
}

@Embeddable
class Data {
    private int location;

    private String name;
}

@Embeddable
class SubClassId {
    private int thingy;

    private int location;
} 
```

~~我已经尝试过@AttributeOverride，但我只能让它重命名该字段。我尝试将其设置为可更新 = 假，可插入 = 假，但这在 @AttributeOverride 注释中使用时似乎不起作用。~~有关此问题的解决方案，请参见下面的答案。

我意识到我可以更改基类，但我真的不想拆分嵌入对象以分隔共享字段，因为它会使周围的代码更加复杂并且需要一些丑陋的包装代码。我也可以为这种极端情况重新设计整个系统，但我真的不想这样做。

我使用 Hibernate 作为我的 JPA 提供程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T14:17:48.067

我找到了 AttributeOverride 不起作用的原因。注释类时，您必须在名称字段中包含嵌入对象的标识符。我正在这样做：

```
@Entity
@AttributeOverride(name = "location", column = @Column(name = "location", insertable = false, updatable = false)
class SubClass extends BaseClass { 
```

当它需要是这样的：

```
@Entity
@AttributeOverride(name = "data.location", column = @Column(name = "location", insertable = false, updatable = false)
class SubClass extends BaseClass { 
```

奇怪的是，更改@Column 的名称字段确实适用于第一个版本，但可插入和可更新字段被忽略了。我不知道这是 JPA 规范的错误还是微妙之处。

无论如何，这确实解决了如何使字段只读但它没有回答原始问题：是否可以从映射的超类瞬态创建字段？

# android - Android：无法更改出现在 AlertDialog 中的文本

> ID：834139
> 
> 赞同：7
> 
> 时间：2009-05-07T11:30:22.400
> 
> 标签：android, text, dialog

我创建了一个 AlertDialog 以在成功时向用户显示下一级挑战。所以，对应的代码是这样的。当游戏成功时调用 showDialog(R.id.display_success) 并执行以下代码。

所以，我希望在每次调用中都执行此代码。然而; 游戏只执行一次，并在其他所有执行中显示相同的 AlertDialog。我的意思是，就像在创建第一个实例之后没有创建实例一样，并且一直使用第一个实例。

```
case R.id.display_success:           
       updateGameSettings();
       message = formatLevel()
       + formatMission();
       return new AlertDialog.Builder(this)
       .setIcon(R.drawable.smiley_happy)
       .setTitle(R.string.dialog_success)
       .setMessage(message)
       .setPositiveButton(R.string.alert_dialog_newgame, new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog,     int whichButton) {
                       startANewGame();
               }
       })
       .setNegativeButton(R.string.exit, new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int whichButton) {
                     finish();
               }
       })
       .create(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-10-31T20:39:56.723

我想我已经修复了 onPrepareDialog 的不一致行为。最初创建对话框时（当它仍然是 AlertDialog.Builder 时），您必须将消息设置为初始状态（非空），否则 onPrepareDialog 不会用预期值覆盖消息。因此，当您创建对话框时，请执行以下操作以在消息中始终包含非空值。我为此苦苦挣扎了好几天，偶然发现了这个解决方案：

```
AlertDialog.Builder resultAlert = new AlertDialog.Builder(context);

if ( message == null ) {
    resultAlert.setMessage("");
} else {
    resultAlert.setMessage(message);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T11:49:39.340

显示对话框时调用 onPrepareDialog 方法。因此，最好通过覆盖此方法来更改文本或其他功能。

# c++ - c++意外静态链表

> ID：834142
> 
> 赞同：2
> 
> 时间：2009-05-07T11:31:07.060
> 
> 标签：c++, class, static

我有一个链表类，由于某种原因，当我在一个对象中增加一个 int 时，例如，linked1.size 由于某种原因，linked2.size 也会增加！

以及为什么会这样？我没有故意让它成为一个静态变量。

我的代码：

```
main()
{    
Vlist v1;  
v1.add(1,0);  
v1.add(2,0);  

Vlist v2;
} 
```

增加 size 成员变量发生在`add()`函数中，如下所示：

```
(*this).size++; 
```

结果应该是 v1.size==2 和 v2.size==0，而是 v2.size==2！

这个问题已经让我发疯了好几个小时——任何帮助都将不胜感激！

添加函数如下：

```
int Vlist::quietAdd(Vertex new_vertex, int i_loc)
{
Vnode* temp= first_node;
Vnode* newNode= NULL;

//check for unique

if (find(new_vertex)!=999)
return 0;

//check for non-negative i value
if (i_loc<0)
{
    cout<<"Invalid index."<<endl;
    return 0;
}
//and exit here?

else
{
    temp = find(i_loc);

    newNode= new Vnode();

    if (size==0)
        first_node= newNode;

    //assigning to the new vnode the new Vertex value
    (*newNode).updateVertex(new_vertex.getInt());

    //the nxt pointer now points to the value it's replacing or NULL
    (*newNode).updateNextPoint(temp);

    if ((temp==NULL)&&size!=0)
    {
        //size-1 is used to get the pointer to the last value on the list
        (*newNode).updatePrevPoint(find(size-1));
        (*find((size-1))).updateNextPoint(newNode);
    }

    if (temp !=NULL)
    {
        //the new vnode's prev pointer now points to correct location
        (*newNode).updatePrevPoint((*temp).getPrevPoint());

        if ((*temp).getPrevPoint()!=NULL)
            /*the vnode that used to point to the existing vnode now
            points to new vnode*/
            (*((*temp).getPrevPoint())).updateNextPoint(newNode);

        //the old one's prev pointer points back to the new value
        (*temp).updatePrevPoint(newNode);
    }

    /*if we've just put a new vnode at the start then it should be
     pointed to by the "first vnode" pointer*/
    if (i_loc==0)
        first_node=newNode;

    (*this).size++;

}
    return 1;
}

//Vlist class definition
class Vlist
{
private:
    int size;
    Vnode* first_node;

public:
    //copy constructor
    Vlist(const Vlist& vl2):size(vl2.size), first_node(NULL)
    {
        for (int i=0;i<size;i++)
            quietAdd(vl2.read(i),i);
    }

    Vertex getNext();
    Vlist (): size(0)  {   first_node=0;    }
    ~Vlist (){};//make deep!
    bool empty();
    Vnode* find(int i_loc) const;
    int find(Vertex target)const;
    void add(Vertex new_vertex, int i_loc);
    int quietAdd(Vertex new_vertex, int i_loc);
    Vertex remove(int i_loc);

    Vertex read(int i_loc) const;
    Vnode* getFirstNode() {return first_node;}
    int getSize() const { return size;}

    void setSize(int newSize) { size = newSize;}

    char* print() const;
    void delete_List();
};

class Vnode
{
private:
    Vertex vertex;
    Vnode* prev_node;
    Vnode* nxt_node;

public:

    Vnode ()
         : prev_node(0), nxt_node(0)
    {
        vertex.update(0);
    }
    ~Vnode (){}; //destructor
    Vertex getVertex(){return vertex;}

    int getVertexInt() { return vertex.getInt();}
    Vertex getNext(){return (*nxt_node).getVertex();}
    Vnode* getNextPoint()    {   return nxt_node;    }
    Vnode* getPrevPoint()    {   return prev_node;    }
    void updateNextPoint(Vnode* newP) { nxt_node = newP;}
    void updatePrevPoint(Vnode* newP)    {prev_node= newP;}
    void updateVertex(Vertex vertexVal)  {vertex.update(vertexVal.getInt());}
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T11:37:46.937

可能是这样，`linked1`并且`linked2`以某种方式指向相同的结构吗？你可以试试

```
printf("adress1 %p", &linked1)
printf("adress2 %p", &linked2)
printf("adress1/size %p", &linked1.size)
printf("adress2/size %p", &linked2.size) 
```

对于其他成员分别`Vlist`(&linked1.data?)

编辑：现在完整的代码是可见的（并且鉴于 add_quiet(...) 和 add(...) 原则上做同样的事情）我不认为“共享”大小类字段是问题。请务必使用调试器并跟踪列表的地址。这很奇怪，但我现在比以往任何时候都对解决方案感兴趣

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T11:35:49.780

没有看到更多代码，我不能确定，但​​是 v1 和 v2 是否可能实际上是对同一个链表对象的引用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T12:43:35.297

似乎调试器告诉我 v2 的值是什么，甚至在它出于某种原因被声明之前。（我正在使用代码块）。
最后，我决定在页面顶部声明这些变量，这个特殊问题得到了解决。
我希望能发现一些设计缺陷来解释一些其他问题，如果不将我的整个项目上传到这个网站上，这些问题很难描述。没有这样的运气。
至于我的程序的其余部分......*叹息*。

无论如何，感谢您的所有帮助。

# php - 为什么此邮件消息无法正确解码？

> ID：834152
> 
> 赞同：4
> 
> 时间：2009-05-07T11:33:30.580
> 
> 标签：php, zend-framework, email, mime, zend-mail

我有这个代码。它来自[Zend Reading Mail](http://framework.zend.com/manual/en/zend.mail.read.html)示例。

```
$message = $mail->getMessage(1);

// output first text/plain part
$foundPart = null;
foreach (new RecursiveIteratorIterator($mail->getMessage(1)) as $part) {
    try {
        if (strtok($part->contentType, ';') == 'text/plain') {
            $foundPart = $part;
            break;
        }
    } catch (Zend_Mail_Exception $e) {
        // ignore
    }
}
if (!$foundPart) {
    echo 'no plain text part found';
} else {
    echo $foundPart->getContent();
} 
```

我能得到的是消息，效果很好。但是试图将消息解码为可读的东西是行不通的。我尝试过 Zend_Mime、imap_mime 和 iconv，但没有成功。

这是我得到的一个例子`$foundPart->getContent();`

> 霍尔=F3 海姆=FAr

它应该说“Halló heimúr”

我想要的只是一些图书馆，我可以在实践中“按下按钮，接收培根”。我的意思是，我只想将库指向一个 POP3 电子邮件箱，并以可读形式（没有任何编码问题）和附件获取电子邮件。

`imap_mime_header_decode()`给我一个具有相同数据的数组。
`iconv_ mime_ decode()`做同样的事情

有谁知道为什么会发生这种情况，或者我可以将它抽象出来的某个库（PHP/Python 或 Perl）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-07-11T22:27:40.267

我在学习如何使用 Zend_Mail 阅读电子邮件时遇到了一些类似的问题。您将需要添加 Zend_Mail 未实现的附加逻辑，例如解码编码的电子邮件和转换字符集。这是我在找到纯文本部分后正在做的事情：

```
$content = $foundPart->getContent();

switch ($foundPart->contentTransferEncoding) {
    case 'base64':
        $content = base64_decode($content);
        break;
    case 'quoted-printable':
        $content = quoted_printable_decode($content);
        break;
}

//find the charset
preg_match('/charset="(.+)"$/', $foundPart->contentType, $matches);
$charset = $matches[1];

if ($charset == 'iso-8859-1') {
    $content = utf8_encode($content); //convert to utf8
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T12:24:02.957

这可能是因为 base64 编码。Zend_Mail 文档说（在“编码”下）：

> ...如果在 addAttachment() 调用中没有给出其他编码或稍后分配给 MIME 部分对象，则所有其他附件都通过 base64 编码。

尝试类似：

```
echo base64_decode($foundPart->getContent()); 
```

另外，请阅读： http: [//framework.zend.com/manual/en/zend.mail.encoding.html](http://framework.zend.com/manual/en/zend.mail.encoding.html)

希望以某种方式有所帮助。

# c# - c#.NET 和 java 中常见的 AES 加密填充是什么

> ID：834155
> 
> 赞同：2
> 
> 时间：2009-05-07T11:34:16.790
> 
> 标签：c#, java, .net, encryption, padding

我想知道 AES 加密的哪些填充模式在 java 和 C#.NET 中都很常见

谢谢巴皮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T13:59:31.837

无，PKCS7，零

Dotnet 与所有 JCE 提供程序一样支持这 3 个。

如果您正在寻找 java<->.net AES，我会推荐 Bouncy Castle，它们都有免费的库。

[http://www.bouncycastle.org/](http://www.bouncycastle.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:56:28.087

[Wikipedia](http://en.wikipedia.org/wiki/Padding_(cryptography))中概述了几种填充算法。我已经看到在一些重要的应用程序（例如 Oracle 客户端）中使用了 PKCS7。它的实现非常简单，因此如果任一平台不支持开箱即用，您不必担心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T07:53:54.597

我正在做一个课堂项目，并以艰难的方式弄清楚了一些细节。首先，Java 支持开箱即用的 PKCS7 填充，但名称不同。它被称为PKCS5。一些程序员使用 Bouncy Castle 是因为错误地认为 Java 不支持 PKCS7，但支持不同的（较旧的）填充类型。这应该不重要，除了 Bouncy Castle 原来有可怕的错误。我的项目依赖于他们对 AES 的实施。如果您使用单个 doFinal 一次加密所有数据，它会起作用，但加密块会出现可怕的错误，结果甚至会根据用于传递数据的缓冲区大小而变化。切换回 Sun 的实现使用相同的代码给出了正确的结果。不用说，这花费了我们几天的调试时间。

# javascript - 使用 Visual Studio 和 ASP.NET 应用程序进行浏览器兼容性测试

> ID：834162
> 
> 赞同：0
> 
> 时间：2009-05-07T11:35:26.740
> 
> 标签：javascript, visual-studio, cross-browser

我目前正在测试我最初为与 Firefox 一起使用而构建的应用程序与 IE7 的浏览器兼容性。当时我们组织内部的假设是我们可以让每个人都使用 Firefox，但这已经引起了质疑，所以我来了。因此，我使用了许多 Firefox 特定的功能和属性，我需要检查这些功能和属性并将其替换为等价物。为了做到这一点，我发现我需要广泛调试 javascript 以找到不兼容的区域。

我们在这里专门使用 Windows，所以我不需要测试其他操作系统的兼容性，至少现在不需要。

为了立即调试代码更改，我需要在本地运行测试，但如果我按 F5，它会在 Firefox 中打开，直到我更改默认浏览器。

Visual Studio 中是否有办法指定应在某个浏览器中打开调试会话，以及快速更改它的方法，或者是否有一些批处理或脚本可用于快速更改默认浏览器？

另外，还有其他浏览器兼容性测试的技巧吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T11:42:08.500

在“文件”菜单中，您有两个选项：

在浏览器中查看 (Ctrl+Shift+W) 使用 ... 查看（允许您选择浏览器）

当您准备好切换到 IE 时，您可以使用后者来设置您的默认浏览器。它还允许您设置浏览器尺寸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T11:42:42.493

您可以使用[Selenium](http://seleniumhq.org/)自动化浏览器测试，并且可以使用 IE 和 Firefox 来实现（您使用 FF 创建测试，然后在（几乎）任何浏览器中运行）

那将是我的方法。

# asp.net-mvc - 在 ASP.NET MVC 中实现自定义配置文件提供程序

> ID：834166
> 
> 赞同：6
> 
> 时间：2009-05-07T11:36:30.653
> 
> 标签：asp.net-mvc, profile-provider

我尝试了很多在 ASP.NET MVC 中实现自定义配置文件提供程序。我已经阅读了很多很多教程，但我找不到我的问题所在。[它与在 ASP.NET MVC](https://stackoverflow.com/questions/79129/implementing-profile-provider-in-asp-net-mvc)中实现配置文件提供程序非常相似。

但是我想创建自己的 Profile Provider，所以我编写了以下继承自的类`ProfileProvider`：

```
public class UserProfileProvider : ProfileProvider
{
    #region Variables
    public override string ApplicationName { get; set; }
    public string ConnectionString { get; set; }
    public string UpdateProcedure { get; set; }
    public string GetProcedure { get; set; }
    #endregion

    #region Methods
    public UserProfileProvider()
    {  }

    internal static string GetConnectionString(string specifiedConnectionString)
    {
        if (String.IsNullOrEmpty(specifiedConnectionString))
            return null;

        // Check <connectionStrings> config section for this connection string
        ConnectionStringSettings connObj = ConfigurationManager.ConnectionStrings[specifiedConnectionString];
        if (connObj != null)
            return connObj.ConnectionString;

        return null;
    }
    #endregion

    #region ProfileProvider Methods Implementation
    public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config)
    {
        if (config == null)
            throw new ArgumentNullException("config");

        if (String.IsNullOrEmpty(name))
            name = "UserProfileProvider";

        if (String.IsNullOrEmpty(config["description"]))
        {
            config.Remove("description");
            config.Add("description", "My user custom profile provider");
        }

        base.Initialize(name, config);

        if (String.IsNullOrEmpty(config["connectionStringName"]))
            throw new ProviderException("connectionStringName not specified");

        ConnectionString = GetConnectionString(config["connectionStringName"]);

        if (String.IsNullOrEmpty(ConnectionString))
            throw new ProviderException("connectionStringName not specified");

        if ((config["applicationName"] == null) || String.IsNullOrEmpty(config["applicationName"]))
            ApplicationName = System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath;
        else
            ApplicationName = config["applicationName"];

        if (ApplicationName.Length > 256)
            throw new ProviderException("Application name too long");

        UpdateProcedure = config["updateUserProcedure"];
        if (String.IsNullOrEmpty(UpdateProcedure))
            throw new ProviderException("updateUserProcedure not specified");

        GetProcedure = config["getUserProcedure"];
        if (String.IsNullOrEmpty(GetProcedure))
            throw new ProviderException("getUserProcedure not specified");
    }

    public override System.Configuration.SettingsPropertyValueCollection GetPropertyValues(System.Configuration.SettingsContext context, System.Configuration.SettingsPropertyCollection collection)
    {
        SettingsPropertyValueCollection values = new SettingsPropertyValueCollection();

        SqlConnection myConnection = new SqlConnection(ConnectionString);
        SqlCommand myCommand = new SqlCommand(GetProcedure, myConnection);
        myCommand.CommandType = CommandType.StoredProcedure;

        myCommand.Parameters.AddWithValue("@FirstName", (string)context["FirstName"]);

        try
        {
            myConnection.Open();
            SqlDataReader reader = myCommand.ExecuteReader(CommandBehavior.SingleRow);

            reader.Read();

            foreach (SettingsProperty property in collection)
            {
                SettingsPropertyValue value = new SettingsPropertyValue(property);

                if (reader.HasRows)
                {
                    value.PropertyValue = reader[property.Name];
                    values.Add(value);
                }
            }

        }
        finally
        {
            myConnection.Close();
            myCommand.Dispose();
        }

        return values;
    }

    public override void SetPropertyValues(System.Configuration.SettingsContext context, System.Configuration.SettingsPropertyValueCollection collection)
    {
        SqlConnection myConnection = new SqlConnection(ConnectionString);
        SqlCommand myCommand = new SqlCommand(UpdateProcedure, myConnection);
        myCommand.CommandType = CommandType.StoredProcedure;

        foreach (SettingsPropertyValue value in collection)
        {
            myCommand.Parameters.AddWithValue(value.Name, value.PropertyValue);
        }

        myCommand.Parameters.AddWithValue("@FirstName", (string)context["FirstName"]);

        try
        {
            myConnection.Open();
            myCommand.ExecuteNonQuery();
        }

        finally
        {
            myConnection.Close();
            myCommand.Dispose();
        }
    } 
```

这是我的控制器中的 CreateProfile 操作：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult CreateProfile(string Username, string Password, string FirstName, string LastName)
{
    MembershipCreateStatus IsCreated = MembershipCreateStatus.ProviderError;
    MembershipUser user = null;

    user = Membership.CreateUser(Username, Password, "test@test.com", "Q", "A", true, out IsCreated);

    if (IsCreated == MembershipCreateStatus.Success && user != null)
    {
        ProfileCommon profile = (ProfileCommon)ProfileBase.Create(user.UserName);

        profile.FirstName = FirstName;
        profile.LastName = LastName;
        profile.Save();
    }

    return RedirectToAction("Index", "Home");
} 
```

我的程序 usp_GetUserProcedure 没什么特别的：

```
ALTER PROCEDURE [dbo].[usp_GetUserProcedure] 
-- Add the parameters for the stored procedure here
@FirstName varchar(50)
AS
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

-- Insert statements for procedure here
SELECT * FROM dbo.Users WHERE FirstName = @FirstName
END 
```

还有我的 Web.Config 文件：

```
<profile enabled="true"
         automaticSaveEnabled="false"
         defaultProvider="UserProfileProvider"
         inherits="Test.Models.ProfileCommon">
<providers>
<clear/>
<add name="UserProfileProvider"
         type="Test.Controllers.UserProfileProvider"
         connectionStringName="ApplicationServices"
         applicationName="UserProfileProvider"
         getUserProcedure="usp_GetUserProcedure"
         updateUserProcedure="usp_UpdateUserProcedure"/>
</providers>
</profile> 
```

但我总是得到这个例外：

> 过程或函数“usp_GetUserProcedure”需要参数“@FirstName”，但未提供该参数。

关于我可能做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-03T19:44:31.747

最可能的原因是

```
myCommand.Parameters.AddWithValue("@FirstName", (string)context["FirstName"]); 
```

`(string)context["FirstName"]`是一个空值。即使您将参数传递给存储过程，如果所需参数的值为 null，您也会看到此错误。SQL Server（有效地）不区分未传递的参数和传递空值的参数。

您看到一个 SQL 错误。这与 MVC 无关，并且 MVC 并没有真正导致您的问题。确定 null 是否为有效值`context["FirstName"]`，如果是，请将您的函数更改为接受 null 值。如果不是，请找出为什么`context["FirstName"]`为空。

另外，我认为这一行不会正确添加您的参数名称（带有“@”前缀）。

myCommand.Parameters.AddWithValue(value.Name, value.PropertyValue);

此外，由于这是 MVC，请确保您在发布到的表单上有一个***名为FirstName 的控件：***

```
public ActionResult CreateProfile(string Username, string Password, string FirstName, string LastName) 
```

它根据名称读取字段，而不是 ID

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T17:49:57.947

是的，这是因为我为我的属性使用了一个类，即继承自 ProfileBase 的 ProfileCommon。

```
public class ProfileCommon : ProfileBase
{
public virtual string Label
{
    get
    {
        return ((string)(this.GetPropertyValue("Label")));
    }
    set
    {
        this.SetPropertyValue("Label", value);
    }
}

public virtual string FirstName
{
    get
    {
        return ((string)(this.GetPropertyValue("FirstName")));
    }
    set
    {
        this.SetPropertyValue("FirstName", value);
    }
}

public virtual string LastName
{
    get
    {
        return ((string)(this.GetPropertyValue("LastName")));
    }
    set
    {
        this.SetPropertyValue("LastName", value);
    }
}

public virtual ProfileCommon GetProfile(string username)
{
    return Create(username) as ProfileCommon;
}
} 
```

你可以看到我在 Web.Config 文件中使用了这个类：

```
<profile enabled="true"
     automaticSaveEnabled="false"
     defaultProvider="UserProfileProvider"
     inherits="Test.Models.ProfileCommon">
[...] 
```

使用 ASP.Net MVC，如果我在 Web.Config 中编写属性，我将无法再使用 Profile.PropertyName 访问它们。也许有办法，但我没有找到任何例子。

# vim - 在 Vim 中替换上一行的文本

> ID：834167
> 
> 赞同：1
> 
> 时间：2009-05-07T11:36:51.277
> 
> 标签：vim, vi

如何用上面一行的前十个字符替换这十个字符与特定模式匹配的行的前十个字符？

编辑：不清楚我是否要求替换匹配可能出现在该行中任何位置的前十个字符，所以如果它处理这种情况，可能会在你的答案中记下（将此情况称为 B 和预期的情况案例A？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T11:50:14.300

也许：

```
:%s/^\(.\{10}\)\(.*\n\)abcdefghij\(.*\)/\1\2\1\3/ 
```

其中 'abcdefghij' 是第 2 行的 10 个字符的字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T12:27:17.037

像这样的东西会起作用：

```
%s/^.\{10\}/\=strpart(get(getbufline("", line(".")-1), 0, ""), 0, 10)/ 
```

`^.\{10\}`你的实际模式在哪里。

```
%s/                      # substitute all lines matching…
^.\{10\}                 # your pattern
/                        # …with…
\=                       # an expression:
strpart(                 # gets the part of a string
  get(                   # gets an element of a list
    getbufline(          # gets a list of lines from the current buffer
      "", line(".")-1)   # getbufline() the line before the current line
  , 0, "")               # get() first line in buffer, default to ""
, 0, 10)                 # strpart() first ten characters
/                        # …end of substitution 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T12:35:08.763

```
:2,$g/<pattern>/s/^.\{10}/\=strpart(getline(line(".")-1),0,10) 
```

*   `2,$`是我们的范围（因为第一行没有上一行）
*   `g//`允许您在与给定模式匹配的行上运行命令。
*   `s/^.\{10}/`将替换一行的前 10 个字符
*   `\=`允许您将 vim 表达式的结果替换为`:s//`
*   `line(".")`是当前行号
*   `getline(line(".")-1)`是上一行的文本
*   `strpart(getline(line(".")-1),0,10)`是上一行的前 10 个字符

例如`2,$g/frog/s/^.\{10}/\=strpart(getline(line(".")-1),0,10)`会改变：

```
**我喜欢在炸**青蛙腿
之前**吃**芒果
**我希望我**有一只小狗
**她给了 D**一只青蛙 
```

 **对此：

```
我喜欢吃芒果
我喜欢吃青蛙腿
我希望我有一只小狗
我希望我有一只青蛙

```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T11:52:33.080

如果我有这样的复杂动作，我通常会使用`q`命令录制宏。类似（未经测试）：

```
/<pattern>
qq
10x
k
10yl
j
P
n
q 
```

然后重复地发出该宏作为`@q`可选的前缀计数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T11:50:13.193

您可以使用搜索和替换：

```
:7,9 s/foo/bar/c 
```

此示例从第 7 行到第 9 行搜索每次出现的 'foo'，并将其替换为 'bar'，要求对每次命中进行确认。如果您不想确认，请将 c 放在末尾。选择您认为合适的范围，这应该可以让您到达您想要的位置

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T11:53:31.953

仅使用 vim 的动作和拉/粘贴.. 给定文件内容..

```
1234567890abcdef
qwertyuiopasdfgh 
```

将光标放在 q, 上`10x`，文件变为：

```
1234567890abcdef
asdfgh 
```

将光标移动到第一行（使用`k`will 执行此操作），然后执行`10yl`（向右拉 10 个字符）

然后向下移动一行，`j`，并粘贴`P`（大写，粘贴在光标下），文件变为：

```
1234567890abcdef
1234567890asdfgh 
```

简而言之，从 q 上的光标开始：

```
10xk10yljP 
```

..您可以粘贴或分配[给宏](http://www.oreillynet.com/mac/blog/2006/07/more_vim_save_time_with_macros_1.html)

如果有明显的覆盖粘贴快捷方式会更短，但我找不到这样的东西

另一种选择是看起来非常晦涩的正则表达式搜索/替换..

Visual-line 选择两条目标线，然后运行以下搜索和替换：

```
:'<,'>s/\(\(.\{10\}\).*\)\n\(.\{10\}\)\(.*\)$/\1\r\2\4/ 
```

基本上它抓住了..

*   `\1`- 整个第一行
*   `\2`- 前 10 个字符（在嵌套组中）
*   换行符
*   `\3`- 第二行的前十个字符
*   `\4`- 第二行的其余部分

然后它将两行构造为`\1\n\2\4`- 完整的第一行，换行符，第一行的前 10 个字符，第二行的剩余部分

# data-binding - 如何为网格中的列设置两个值

> ID：834175
> 
> 赞同：0
> 
> 时间：2009-05-07T11:40:27.773
> 
> 标签：data-binding, advanceddatagrid, aspxgridview

我们正在为我们的 Web 应用程序使用 AspXGridView devXgrid。我必须为网格中的一列分配两个值（id，value）。我怎样才能做到这一点？

谢谢，P.Gopalakrishnan。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-05T14:50:54.037

这会打开一罐蠕虫。如果您启用了排序、分组和/或过滤，它们应该如何工作？

有很多方法可以做到这一点，这里有一个（忽略其他问题）......

```
protected void ASPxGridView1_Init(object sender, EventArgs e) {
    // Creates a column, customizes its settings and appends it to the Columns collection;
    GridViewDataTextColumn colTotal = new GridViewDataTextColumn();
    colTotal.Caption = "IdValue";
    colTotal.FieldName = "IdValue";
    colTotal.UnboundType = DevExpress.Data.UnboundColumnType.String;
    colTotal.VisibleIndex = ASPxGridView1.VisibleColumns.Count;
    ASPxGridView1.Columns.Add(colTotal);
}
// Populates the unbound column.
protected void ASPxGridView1_CustomUnboundColumnData(object sender, ASPxGridViewColumnDataEventArgs e) {
    if (e.Column.FieldName == "IdValue") {
        e.Value = e.GetListSourceFieldValue("Id") + " " +  e.GetListSourceFieldValue("Value");
    }
} 
```

[http://devexpress.com/Help/?document=ASPxGridView/CustomDocument3770.htm&levelup=true](http://devexpress.com/Help/?document=ASPxGridView/CustomDocument3770.htm&levelup=true)

# shareware - 万无一失的试用策略

> ID：834177
> 
> 赞同：3
> 
> 时间：2009-05-07T11:40:35.667
> 
> 标签：shareware, trialware, time-trial

我知道已经存在关于 SO 的类似问题。但我的问题更具理论性。

我想知道，是否可以设计一个万无一失的试用系统？我所说的万无一失是指即使破解者知道这种系统的算法也无法破解的系统？

抱歉，如果这不是编程问题。

**编辑：**我想我应该让我的问题更实用。我问的是整个系统，而不是独立的应用程序。系统由装有 Linux 操作系统的 PC 和一些与之连接的硬件组成。也许我可以使用硬盘加密？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T11:48:26.537

可能唯一的方法是基于 Internet 的“软件即服务”应用程序。如果您不提供访问权限，他们就没有使用该软件。如果它是基于桌面的应用程序，那么某些关键功能仍然必须位于某处的在线服务器上。

如果黑客在其本地机器上拥有整个应用程序，则可以对其进行逆向工程并以某种方式“破解”。克服这个问题的唯一方法是确保某些功能永远不会出现在他们的机器上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-05T17:06:00.053

拥有防破解软件的唯一（理论上）方法是拥有一个完全封闭的系统。如果您控制从硬件到操作系统再到应用程序和开发工具的所有内容，则可以防止篡改。

请注意我是如何说这是理论上的。不可避免地，你会找到一个硬件黑客，他会想办法修改硬件（参见[modchips](http://en.wikipedia.org/wiki/Modchip)）。从那里，他们可以加载他们想要的任何软件并修改已经存在的软件。

适用于物理安全（保险箱、保险库等）的相同模型也适用于软件。关键是使窃取/复制商品的成本高于通过合法方式获取商品的成本。您永远无法创建一个万无一失的系统，但您可以轻松地防止脚本小子和爱好黑客破解您的产品。另一方面，专业人士为破解而活。他们会找到方法的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T11:48:40.607

您可以将您的应用程序设计为依赖于除您之外的任何人都可以控制的远程服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T11:53:59.080

不。你可以让它变得非常困难，但你的问题相当于“我怎样才能让别人运行代码但不让他们运行代码”。

例如，您可以省略代码的一小部分但很关键，并要求从您控制的服务器下载该代码。这使您可以跟踪试用活动并关闭特定用户。但是，一旦他们收到代码，他们就可以捕获它并在足够的工作量下构建您的产品的无阻碍版本。

# c++ - WTF WTF 在 WebKit 代码库中代表什么？

> ID：834179
> 
> 赞同：92
> 
> 时间：2009-05-07T11:40:58.410
> 
> 标签：c++, webkit, chromium

我下载了[Chromium](https://github.com/chromium/chromium)的代码库并在[WTF 命名空间](https://github.com/chromium/chromium/tree/master/third_party/blink/renderer/platform/wtf)中运行。

```
namespace WTF {
    /*
     * C++'s idea of a reinterpret_cast lacks sufficient cojones.
     */
    template<typename TO, typename FROM>
    TO bitwise_cast(FROM in)
    {
        COMPILE_ASSERT(sizeof(TO) == sizeof(FROM), WTF_wtf_reinterpret_cast_sizeof_types_is_equal);
        union {
            FROM from;
            TO to;
        } u;
        u.from = in;
        return u.to;
    }
} // namespace WTF 
```

这是否意味着我认为的意思？可能是这样，如果不是[POD](http://en.wikipedia.org/wiki/Plain_Old_Data_Structures)并且不是（AFAIK）比内置的 C++ 更强大，`bitwise_cast`则此处指定的实现将无法编译。`TO``FROM``reinterpret_cast`

我在这里看到的唯一亮点是 Chromium 项目中似乎没有人使用`bitwise_cast`。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-05-07T12:00:42.340

它是 Web T emplate F ramework 的缩写**，****提供****了**整个WebKit 代码库中的常用功能。

 ***** * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-10T17:24:57.017

这是为了避免严格混叠优化问题：

[gcc、严格混叠和通过联合进行强制转换](https://stackoverflow.com/questions/2906365/gcc-strict-aliasing-and-casting-through-a-union)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T11:56:31.213

> 可能是这样，如果 TO 或 FROM 不是 POD，此处指定的 bitwise_cast 实现会产生未定义的行为

如果 FROM 或 TO 不是 POD 类型，则使用当前 C++ 标准编译将失败，因为您无法将它们合并。

# regex - 阿帕奇 正则表达式字段

> ID：834182
> 
> 赞同：1
> 
> 时间：2009-05-07T11:42:05.553
> 
> 标签：regex, apache

我似乎无法为指令正确设置正则表达式。

语法是：

```
<LocationMatch regex> ... </LocationMatch> 
```

我尝试了以下许多方法均无济于事：

```
<LocationMatch "^/(admin-media|connect|css|downloads|images|images-web|js)/.+$">
<LocationMatch "^/(admin-media|connect|css|downloads|images|images-web|js)/.+">
<LocationMatch "/(admin-media|connect|css|downloads|images|images-web|js)/.+$">
<LocationMatch "/(admin-media|connect|css|downloads|images|images-web|js)/."> 
```

基本上，我试图将与[http://mysite/css/anything](http://mysite/css/anything)匹配的地址的默认处理程序覆盖为 None ，但没​​有运气！

我可以尝试设置 <Location "/admin"> 等等，但这只是臃肿

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T14:47:18.917

您真的确定您的问题与 LocationMatch 指令有关吗？你所有的例子对我来说似乎都是完全有效的。我怀疑你在这里叫错树了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T06:43:24.700

您确定将正则表达式放在字符串（“”）中时实际执行还是将其视为文字？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T22:56:57.167

您是在 .htaccess 文件还是全局配置文件中设置它？.htaccess 文件无法进行 LocationMatch

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-07-20T23:34:46.877

您的 VirtualHost 指令中是否有“RewriteEngine on”？（并且启用了 mod_rewrite）

# reverse-engineering - 看不到Coda的源代码

> ID：834187
> 
> 赞同：0
> 
> 时间：2009-05-07T11:42:42.743
> 
> 标签：reverse-engineering, coda

我阅读了[Jeff 的博客文章](http://www.codinghorror.com/blog/archives/001072.html)，有人设法通过一个名为 Reflector 的程序看到了一个封闭的源代码。

我想看看 Coda 的源代码，它是一个共享软件应用程序。但是，我不确定我应该使用哪个应用程序。看来Reflector只能用于。网络应用程序。

**怎么看Coda的源代码？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T11:46:30.050

Reflector 仅适用于托管 .NET 程序集（CIL 二进制文件）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T12:00:07.273

你最好的机会是在[恐慌](http://www.panic.com)中找到一份软件工程师的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T11:49:34.117

我不认为 Coda 是共享软件。这是一个有试用期的商业应用程序。

# java - 在 GWT 中，如何单击并拖动大图像来更改正在查看的部分？

> ID：834189
> 
> 赞同：0
> 
> 时间：2009-05-07T11:43:10.247
> 
> 标签：java, gwt

在我的 GWT 应用程序中，我使用边框布局在添加到中心位置的面板中显示大图像。

我想单击并拖动图像以更改显示的图像部分。这相当于使用滚动条来移动屏幕上显示的图像部分。这类似于 Adob​​e Reader 允许您浏览 PDF 的方式。

我如何用 GWT 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T00:52:14.763

David Geary 的“Google Web Toolkit Solutions”一书描述了一个 ViewPort 面板的实现，它可以按照您的描述进行操作。基本上，您创建一个监听鼠标事件的 AbsolutePanel 的子类。根据这些鼠标事件，您将进行拖动计算并更新包含元素的位置（在您的情况下为大图像）。

要查看它的实际效果，请访问[http://coolandusefulgwt.com/](http://coolandusefulgwt.com/)并单击“示例”，然后单击“地图”。（请注意，缺少直接链接是为什么适当的历史支持对 gwt 应用程序很重要的一个很好的例子）。

# c# - 是否可以在家中创建交互式语音响应系统，如果可以，最好的解决方案是什么

> ID：834195
> 
> 赞同：6
> 
> 时间：2009-05-07T11:45:38.337
> 
> 标签：c#, vb.net, ivr

我正在尝试构建一个 IVR 并将其连接到我的网站，我可以通过哪些不同（便宜）的方式来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-31T17:51:31.903

我在短短几天内使用[Twilio](http://www.twilio.com)构建了一个 IVR 应用程序，这很愉快。它们有一个简单的 XML 语法（有很好的文档）、一个很棒的 REST API 和对小项目友好的每分钟定价，这让你可以专注于构建你的应用程序，而不是构建/托管电话基础设施。您甚至可以拨打国际电话或获取免费电话号码。它让我想起了这里提到的 Tropo 项目，但它们并不是 beta 版（即使标志上写着“beta”）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T11:51:00.803

我正在构建一个电话系统，正在学习由 voxeo 发布的这项新技术，它被称为 tropo。您可以使用 Groovy、JavaScript、PHP、Python 和 Ruby 构建电话应用程序。

[http://www.tropo.com/](http://www.tropo.com/)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-29T20:18:38.680

正如其他人所提到的，Twilio API 是一种可用于快速构建 IVR 的工具。我们有一个 REST API 用于进行出站呼叫，以及处理 IVR 的入站，在许多情况下，您只需要我们的 TwiML 标记语言。如果你想踢轮胎，我建议看一下“Hello Monkey”快速入门：http: [//www.twilio.com/docs/quickstart/twiml/hello-monkey](http://www.twilio.com/docs/quickstart/twiml/hello-monkey)

如果您需要任何帮助，请随时通过 help@twilio.com 给我们留言——我们可以为您提供示例代码和其他资源，以使该过程更加轻松。

干杯

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T11:50:35.690

星号是一个不错的选择。它是免费的，并且可以在 linux 上运行。你也可以试试 AsteriskNOW，它集成了 Linux。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-20T09:40:39.160

Twilio 是一个非常简单的工具，可用于构建 IVR。我设置了我的，即使我不知道如何通过在 GetSatisfaction 上托管他们的帮助论坛来做一些事情，也为我解决了所有问题。

他们有一个非常简单的示例应用程序，他们称之为“电话菜单”，它与 IVR 相同。您可以在 30 分钟内完成设置，因为他们拥有您需要的所有示例代码：http: [//www.twilio.com/docs/howto/phonemenu](http://www.twilio.com/docs/howto/phonemenu)

期待听到您认为有用的内容，以及是否有最好的内容。我很乐意使用某种托管解决方案，但似乎没有这么简单的东西 - 祝你好运！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T11:47:45.383

[Microsoft 语音应用程序 SDK](http://msdn.microsoft.com/en-us/library/ms986944.aspx)与 ASP.NET 无缝集成

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-07T11:48:58.687

我听说过[CallButler](http://www.codeplex.com/callbutler)，这是一个开源项目，看起来很容易设置，但我从未使用过它

至于网站集成......你想做什么？对于一些简单的事情，比如检查语音邮件，您可能只需设置一个简单的页面，其中包含跟踪语音邮件文件夹的登录信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-08T15:41:52.873

如前所述，有多种托管服务可以从极低成本和低端扩展到大容量高性能解决方案。之前提到的是：www.twilio.com 和 www.tropo.com

您可能感兴趣的其他内容包括：www.metaphorivr.com 和 www.angel.com。高端 IVR 托管服务提供商包括：www.tellme.com、www.xo.com、www.voxeo.com。

区分低成本供应商的关键因素之一是支持语音识别。例如，Twilio 仅支持按键输入，不支持自动语音识别。

微软在 IVR 和语音领域的开发技术很丰富，但也很混乱。提供了许多 API 和服务。今天，旗舰产品是 Office Communication Server (OCS) – (www.microsoft.com/communicationsserver)，旗舰开发人员 API 是统一通信托管 API 2.0 (msdn.microsoft.com/en-us/library/dd253340%28office .13%29.aspx)

它变得非常混乱，因为微软的 IVR 开发技术曾经是一个单独的产品，称为 Microsoft Speech Server。这现在被认为是 OCS 的一个组件，但在 OCS 的最后一个版本中尚未对其进行修订。因此，要构建 IVR 应用程序，Microsoft 仍然支持其旧版 Speech Server 2007。可以从 www.microsoft.com/downloads/details.aspx?FamilyId=BB183640-4B8F 下载 Speech Server 2007 组件的开发人员版本-4828-80C9-E83C3B2E7A2C&displaylang=en。SpeechServer 信息位于 msdn.microsoft.com/en-us/library/bb812662.aspx。

一些遵循 Microsoft 语音技术和 IVR 开发的博客： - gotspeech.net/blogs/marshallharrison/default.aspx - theucguy.wordpress.com/ - blogs.msdn.com/dszabo/archive/2008/07/04/microsoft-office -communications-server-2007-speech-server.aspx

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-29T20:47:44.720

我会使用 Twilio open vbx 它非常简单，易于定制且便宜

# perl - 如何从字符串中提取一堆数字？

> ID：834212
> 
> 赞同：1
> 
> 时间：2009-05-07T11:50:28.263
> 
> 标签：perl, string, extraction

这是示例测试文件：

```
 Barcode:*99899801000689811* 
  JSC4000I accountNumber:10006898Sequence Number:998 Envelopes: 1 
  LCD5010V Using jsl 'CUSOFF' for output page '6'
  Barcode:*99999901000673703* 
  LCD5010V Using jsl 'CUSOFF' for output page '4'
  LCD5005V Using job 'A' for current page '4' 
```

所以，在这个文件中，如何搜索单词 Barcode 并提取它的前五位数字，同时将它传递到一个数组中。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T11:58:48.227

尝试一个正则表达式，这样的东西应该可以工作：

> `Barcode:\*(\d{5})`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T12:17:20.790

正则表达式是一种方法。`index`但是，只是为了向您扔一些完全不同的东西，以下是使用and处理这些东西的方法`substr`：

```
my @array;
foreach my $line ( <$file> ) {
    if ( index( $line, 'Barcode:' ) == 0 ) {
        push @array, substr $line, 9, 5;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T20:15:01.207

我的解决方案与 Manni 的类似，但我建议使用`while`逐行读取文件。您可以像他一样使用 substr() ，但是带有锚且没有量词的正则表达式将非常快：

```
我的@barcodes；
而( <$fh> )
    {
    下一个除非 m/^Barcode:\*([0-9]{5})/;

    推@barcodes，1美元；
    }

```

根据我在做什么，我可能只使用地图。map 表达式在列表上下文中，因此 m// 运算符在任何括号中返回它匹配的事物的列表：

```
my @barcodes = map { m/^Barcode:\*([0-9]{5})/ } <$fh>; 
```

我怀疑任何现实生活中的答案都会有更多代码来警告您以开头`Barcode:`但缺少数字的行。我还没有遇到一个完美的输入文件:)

\G 锚在你离开的地方与同一字符串上的最后一个匹配项拾取正则表达式匹配，在这种情况下，就在冒号之后：

```
我的@barcodes；
而( <$fh> )
    {
    下一个除非 m/^Barcode:/;

    除非( m/\G\*([0-9]{5])/ )
        {
        warn "$ 行条码缺少数字。\n";
        下一个;
        }

    推@barcodes，1美元；
    }

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T20:18:01.917

数组上下文中的模式匹配将返回标记的值（由 '(' 和 ')'）作为列表。将此与循环修饰符 'g' 结合使用以保持重新匹配，您可以在一行中完成所有操作，我认为它非常易读。

```
my $string =<<'HERE';
Barcode:*99899801000689811* 
JSC4000I accountNumber:10006898Sequence Number:998 Envelopes: 1 
LCD5010V Using jsl 'CUSOFF' for output page '6'
Barcode:*99999901000673703* 
LCD5010V Using jsl 'CUSOFF' for output page '4'
LCD5005V Using job 'A' for current page '4'
HERE

my @array = $string =~ m!Barcode:\*([0-9]{5})[0-9]+\*!g;

# or

foreach my $barcode ($string =~ m!Barcode:\*([0-9]{5})[0-9]+\*!g)
{
    # do stuff with $barcode
} 
```

# sql - “丢失”的 SQL 服务器数据库

> ID：834217
> 
> 赞同：1
> 
> 时间：2009-05-07T11:52:27.090
> 
> 标签：sql, sql-server, database, configuration, connection-string

这是一个非常奇怪的问题。我正在使用 SQL Server Express 2005，并具有以下连接字符串（在 DotNetNuke web.config 中）：

**数据源=ELECTROMORPH\S15304561；集成安全=True；用户实例=True**

请注意，没有 AttachDbFilename 参数 - 所以我不确定 SQL 服务器是如何知道要连接到什么的。但它正在连接到某些东西，因为该网站可以运行并且可以更新！

我尝试在服务器上搜索所有 .mdf 文件，但看不到任何可能的候选者。系统数据库似乎不包含任何用户表。

有没有人知道是否有可能使用的“默认”数据库——也许是没有 .mdf 扩展名的数据库？

这显然是接受默认配置的奖励！我真的应该知道得更好，但我在这里完全被难住了，所以很感激任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T11:56:13.087

使用 Sql Server Management Studio 连接到数据源（[带有工具的 Sql Server Express](http://www.microsoft.com/express/sql/download/)免费提供。）右键单击数据库，它将显示文件的存储位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T12:00:20.797

也许这是对 SQL Server 实例的引用，因此使用默认目录，直到引用特定数据库，可能在运行时。

看

[http://msdn.microsoft.com/en-us/library/ms247257.aspx](http://msdn.microsoft.com/en-us/library/ms247257.aspx)

另请参阅：SQL Server Express 用户实例并阅读“用户实例如何工作”

[http://msdn.microsoft.com/en-us/library/ms254504.aspx](http://msdn.microsoft.com/en-us/library/ms254504.aspx)

使用以下查询来识别在默认 SQL Server Express 实例下运行的特定用户实例。

```
SELECT owning_principal_name, instance_pipe_name FROM sys.dm_os_child_instances 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T11:59:06.823

请参阅有关用户实例的[这一部分。](http://technet.microsoft.com/en-us/library/bb264564(SQL.90).aspx#sqlexpuser_topic3)至于`AttachDbFilename`，这个参数可以在运行时添加或在其他地方指定。`App_Data`在您的应用程序根目录中查找文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T12:06:10.283

数据库名称可以与物理文件名不同。
要在磁盘上查找文件，请使用 SQL Server Management Studio。

[管理工作室 2005](http://go.microsoft.com/fwlink/?linkid=65110)
[管理工作室 2008](http://go.microsoft.com/?linkid=9647069)

# java - Java String.replaceAll 正则表达式

> ID：834230
> 
> 赞同：9
> 
> 时间：2009-05-07T11:55:15.973
> 
> 标签：java, regex, string

使用 java 方法剥离 MY-CORP\ 部分输入字符串（如 MY-CORP\My.Name ）的正则表达式是什么，`String.replaceAll`所以我只能得到 My.Name 部分？

我试过

```
public static String stripDomain(String userWithDomain) {
    return userWithDomain.replaceAll("^.*\\", "");
} 
```

但我*在索引 4 附近遇到了意外的内部错误 ^。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-07T12:03:12.990

您的问题是反斜杠在 Java 字符串和正则表达式中都有特殊含义。因此，您需要在 Java 源代码中使用四个斜杠，将两个斜杠传递给正则表达式解析器以在正则表达式中获得一个字面值：

```
return userWithDomain.replaceAll("^.*\\\\", ""); 
```

# wpf - 滚动查看模式下的 FlowDocumentReader 滚动条可见性

> ID：834231
> 
> 赞同：1
> 
> 时间：2009-05-07T11:55:17.550
> 
> 标签：wpf, scroll, flowdocument

我需要显示带有字体大小滑块和搜索按钮的 FlowDocument。滚动查看模式下的 FlowDocumentReader 正是我想要的，除了它总是显示垂直滚动条，而我只需要在它启用时才显示它（内部 ReaderScrollViewer 的 VerticalScrollBarVisibility 是可见的，但我需要自动）。我怎样才能实现这样的观点？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-07T14:57:12.107

您可以使用 FlowDocumentScrollViewer ，而不是在滚动查看模式下使用[FlowDocumentReader](http://msdn.microsoft.com/en-us/library/system.windows.controls.flowdocumentscrollviewer.aspx)。FlowDocumentScrollViewer 具有[VerticalScrollBarVisibility](http://msdn.microsoft.com/en-us/library/system.windows.controls.flowdocumentscrollviewer.verticalscrollbarvisibility.aspx)属性。

# c# - Intelligencia.UrlRewriter

> ID：834234
> 
> 赞同：0
> 
> 时间：2009-05-07T11:56:17.953
> 
> 标签：c#, asp.net, friendly-url, urlrewriter

我在一个项目中使用 Intelligencia UrlRewriter。

重写输入浏览器的 url 工作正常。

例如，如果我输入

```
http://localhost/People 
```

这被正确地重写为：

```
http://localhost/People.aspx 
```

现在，问题是，当我在后面的代码中时，我需要访问友好的 URL，但 Request.ServerVariables 似乎只有不友好的 URL 可用。

有谁知道我是否可以在代码中访问这个原始的、友好的 URL？还是我太晚了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:33:09.110

明白了，伙计们。

@Nick Allen 和 Pure.Krome：感谢您的帮助！！

我在以下位置找到了一条数据：

```
HttpContext.Current.Request.RawUrl 
```

如果它存在于 ServerVariables 中，我看不到它，但总而言之，数据在那里，所以我不必哭着睡觉 :)

好的。再次感谢！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-03T16:50:58.027

```
Request.PathInfo
Request.QueryString 
```

您使用哪一个取决于您是否重写`default.aspx?myvar`或`default.aspx/myvar`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T12:07:44.633

我正在使用它，并且已经使用了 .. er .. 2 年了，我想。（感谢 gawd IIS7 和 MVC 在这里！）

无论如何，你可以检查所有这些的[IIS 服务器变量](http://msdn.microsoft.com/en-us/library/ms524602.aspx)并告诉我们你得到了什么......

1.  PATH_INFO
2.  网址
3.  SCRIPT_NAME

例如（这是我设置的页面的 PATH_INFO 片段，它转储所有请求变量）：-

> PATH_INFO：[/admin/Miscellaneous.aspx]

并得到它..

```
Request.ServerVariables["PATH_INFO"] 
```

随时通知我们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T12:11:18.557

Intelligencia 重写规则存储在可解析的 web.config 中。因此，您可以遍历 web.config 中的规则以找到匹配项并从那里使用匹配的值

显然，这不适用于模式匹配，只是显式规则，例如您的示例中的规则

# iphone - 使用objective-c自定义iphone中的键盘高度和宽度

> ID：834239
> 
> 赞同：-1
> 
> 时间：2009-05-07T11:57:51.273
> 
> 标签：iphone, cocoa-touch

我想要我在 iphone 中具有我想要的高度和宽度的自定义键盘。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T12:35:21.883

只有键盘的方向和类型（数字、字母数字等）是可定制的。**宽度和高度不是。**

有关您可以使用键盘进行的所有操作的更多详细信息，请阅读[iPhone 应用程序编程指南中关于键盘的部分](http://developer.apple.com/iPhone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/TextandWeb/TextandWeb.html#//apple_ref/doc/uid/TP40007072-CH20-SW3)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-10T21:29:38.947

键盘本身并不由用户直接管理。键盘由符合“UITextInputTraits”协议的对象发送消息，或由“观察者”使用“通知”做出反应。因此，键盘的类型是由给定的文本字段对象等请求的，更详细的信息可以在 Kriem 提供的链接中找到，这是我读过的关于该主题的最有用的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T12:33:31.700

为了获得一致的用户体验，据我所知，iPhone 键盘高度无法更改。

# c# - 在 TextBlock 的 DataValidation 中获取 UserControl 或 VisualTree

> ID：834240
> 
> 赞同：2
> 
> 时间：2009-05-07T11:57:58.777
> 
> 标签：c#, .net, wpf, validation, xaml

我在文本块的文本属性上设置了一个验证器。为了正确验证，我需要文本块的父用户控件，但验证器中唯一的东西是值对象（字符串）和文化（也无济于事）。

有谁知道在一个类/方法中获取某些用户控件的方法，我无法访问我的应用程序的任何类型的视觉或控制。

如果我可以给验证器用户控件或文本块作为参数，问题就可以解决，但我没有找到这样做的方法..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T13:06:49.420

You could try validating using two validation properties built into the `Binding` class: `ValidatesOnExceptions` and `ValidatesOnDataErrors`.

With `ValidatesOnExceptions`, the binding is invalid if an exception is thrown during the conversion process. In this case, you could create a custom converter, pass the user control as a parameter, and then throw an exception in the converter if the binding was invalid.

```
<Binding ValidatesOnExceptions="True"/> 
```

With `ValidatesOnDataErrors`, the binding is invalid if the source implements `IDataErrorInfo` and returns a non-null/empty string for the `IDataErrorInfo.Error` property. If your source does or could implement this interface, you could validate the data on the source side.

```
<Binding ValidatesOnDataErrors="True"/> 
```

# sql - 需要一些帮助来尝试通过一些简单的数据检查来执行简单的 SQL INSERT

> ID：834247
> 
> 赞同：0
> 
> 时间：2009-05-07T12:00:20.097
> 
> 标签：sql, insert

我在表格中有以下数据。

```
Name                LeftId    RightId
------------------------------------------
Cat                     1  
Cat                     2
Dog                     4
Dog                     5
Dog                               7
Dog                               69
Gerbil                  12        13 
```

我需要将它们插入到一个新表中...

```
Id         Name
-------------------------------
1          Cat
2          Cat
4          Dog
5          Dog
7          Dog
69         Dog
12         Gerbil    (or 13\. don't care which number out of the two) 
```

因此，LeftId 和 RightId 字段可以包含 NULLS 或 NVARHCAR 值（即使它们在上面列出为数字..它们将始终是数字..只是导入将字段创建为 nvarchar(255)。

如果需要，我可以修改源表字段。

任何人都可以帮忙吗？

我猜插入语句将有一个选择查询并使用 CASE 语句。不过，我只是不确定如何最好地做到这一点。

干杯:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T12:03:19.573

您可以使用 IsNull 轻松完成此操作：

```
INSERT INTO newtable (id,name)
SELECT IsNull(leftid,rightid), name
FROM oldtable 
```

# sql - SQL查询将可用插槽从预定插槽表中插入表（可用）

> ID：834252
> 
> 赞同：1
> 
> 时间：2009-05-07T12:01:53.353
> 
> 标签：sql, derby

我想要一个 sql 查询将可用槽插入到预定槽表中的表（可用）中。

我有两个表。我有一个带有 bookstarttime 和 bookendtime 列的 book 表。这些是时间戳对象。我有另一个表具有availstarttime 和availendtime。这些也是时间戳列。我必须在这些预订的插槽之间留下可用的插槽。我将从表单输入开始时间和结束时间。然后我想要一个 sql 查询来获取 starttime 和 endtime 的值之间的可用插槽

我正在使用数据库：apache derby

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T14:10:12.390

您可能需要检查下面列出的非常相似的问题。

此外，正如 Tomalak 所说，您几乎肯定不想在数据库中保留相同数据的两个副本。也许添加一个视图，让您从另一个角度查看数据，但不要保留相同信息的两个副本，因为它几乎肯定会发生冲突。

类似问题：[在预订系统中查找空闲位置](https://stackoverflow.com/questions/781221/finding-free-slots-in-a-booking-system/781679#781679)

# floating-point - 为什么在 SAS 中，科学计数法中的数字文字与明确写出的数字不同？

> ID：834253
> 
> 赞同：2
> 
> 时间：2009-05-07T12:02:40.667
> 
> 标签：floating-point, sas, scientific-notation

以下 SAS 代码：

```
data _null_;
  format t u best32.;
  t = 10000000000000000000000000;
  u = 1e25;
  put t u;
  if t ne u then put 'diff';
run; 
```

在我的 Windows 机器上打印出：

```
10000000000000000905969664 9999999999999998758486016
diff 
```

虽然我知道只有前 15-16 位数字是可信的，但为什么它们给出不同的基础数字呢？SAS如何计算1e25？

编辑：我被要求提供 10 到 1e25 的其他幂的输出。以下程序：

```
 %macro doit;
data _null_;
  format t u best32.;
%let t=1;
%do i=1 %to 25;
  %let t=&t.0;
  t = &t;
  u = 1e&i;
  put t u;
%end;
run;
%mend;
%doit; 
```

给出以下输出：

```
 10 10
100 100
1000 1000
10000 10000
100000 100000
1000000 1000000
10000000 10000000
100000000 100000000
1000000000 1000000000
10000000000 10000000000
100000000000 100000000000
1000000000000 1000000000000
10000000000000 10000000000000
100000000000000 100000000000000
1000000000000000 1000000000000000
10000000000000000 10000000000000000
100000000000000000 100000000000000000
1000000000000000000 1000000000000000000
10000000000000000000 10000000000000000000
100000000000000000000 100000000000000000000
1000000000000000000000 1000000000000000000000
10000000000000000000000 10000000000000000000000
99999999999999991611392 99999999999999991611392
999999999999999983222784 999999999999999983222784
10000000000000000905969664 9999999999999998758486016 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T12:35:04.600

看起来它实际上可能正在计算`1 * 10 * 10 ... * 10`，并且一旦超出底层浮点类型的大量位数，错误就会蔓延。

但我不相信 IEE754 类型的浮点/双精度会发生这种情况，因为它完全能够表示 1x10^(全范围)而不损失精度。

一种可能性是您遇到的问题与以低于允许的精度存储浮点数的能力有关（这可能会搞砸 1e25 计算） - 请参阅[http://www.uc.edu/sashtml/lrcon/z0695157。 htm#z0695187](http://www.uc.edu/sashtml/lrcon/z0695157.htm#z0695187)进行解释。

**更新1：**

好的，所以根据您的评论，您没有限制长度。下面的代码给了你什么？

```
t = 10;
u = 1e1;
put t u;
t = 100;
u = 1e2;
put t u;
t = 1000;
u = 1e3;
put t u;
: : :
t = 10000000000000000000000000;
u = 1e25;
put t u; 
```

基于该输出，我们可能可以推断出幕后发生的事情。

# c# - 需要正则表达式返回第一段或前 n 个单词

> ID：834256
> 
> 赞同：4
> 
> 时间：2009-05-07T12:03:21.477
> 
> 标签：c#, regex

我正在寻找一个正则表达式来返回段落中的前 [n] 个单词，或者，如果该段落包含少于 [n] 个单词，则返回完整的段落。

例如，假设我最多需要前 7 个单词：

```
<p>one two <tag>three</tag> four five, six seven eight nine ten.</p><p>ignore</p> 
```

我会得到：

```
one two <tag>three</tag> four five, six seven 
```

并且在包含少于请求的单词数的段落上使用相同的 RegEx：

```
<p>one two <tag>three</tag> four five.</p><p>ignore</p> 
```

只会返回：

```
one two <tag>three</tag> four five. 
```

我对这个问题的尝试导致了以下正则表达式：

```
^(?:\<p.*?\>)((?:\w+\b.*?){1,7}).*(?:\</p\>) 
```

但是，这只会返回第一个单词 - “one”。它不起作用。我觉得 。*？（在 \w+\b 之后）导致问题。

我哪里错了？任何人都可以提供一个可以工作的正则表达式吗？

仅供参考，我正在使用 .Net 3.5 的 RegEX 引擎（通过 C#）

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T12:47:10.123

好的，完成重新编辑以确认新的“规范”:)

我很确定你不能用一个正则表达式来做到这一点。最好的工具绝对是 HTML 解析器。我能用正则表达式得到的最接近的是两步法。

首先，隔离每个段落的内容：

```
<p>(.*?)</p> 
```

您需要设置`RegexOptions.Singleline`段落是否可以跨越多行。

然后，在下一步中，遍历您的匹配项并在每个匹配项上应用以下正则表达式一次`Group[1].Value`：

```
((?:(\S+\s+){1,6})\w+) 
```

这将匹配由空格/制表符/换行符分隔的前七个项目，忽略任何尾随标点符号或非单词字符。

但它会将由空格分隔的标签视为这些项目之一，即

```
One, two three <br\> four five six seven 
```

它只会匹配到`six`. 我想正则表达式，没有办法解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T12:42:25.207

1.  使用 HTML 解析器获取第一段，使其结构扁平化（即删除段落内的装饰性 HTML 标记）。
2.  搜索第 n 个空白字符的位置。
3.  将子字符串从 0 带到该位置。

*编辑：*我删除了第 2 步和第 3 步的正则表达式提案，因为它是错误的（感谢评论者）。此外，HTML 结构需要扁平化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-25T08:38:55.130

我遇到了同样的问题，并将一些 Stack Overflow 的答案合并到这个类中。它使用 HtmlAgilityPack，这是一个更好的工作工具。称呼：

```
 Words(string html, int n) 
```

得到 n 个单词

```
using HtmlAgilityPack;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace UmbracoUtilities
{
    public class Text
    {
      /// <summary>
      /// Return the first n words in the html
      /// </summary>
      /// <param name="html"></param>
      /// <param name="n"></param>
      /// <returns></returns>
      public static string Words(string html, int n)
      {
        string words = html, n_words;

        words = StripHtml(html);
        n_words = GetNWords(words, n);

        return n_words;
      }

      /// <summary>
      /// Returns the first n words in text
      /// Assumes text is not a html string
      /// http://stackoverflow.com/questions/13368345/get-first-250-words-of-a-string
      /// </summary>
      /// <param name="text"></param>
      /// <param name="n"></param>
      /// <returns></returns>
      public static string GetNWords(string text, int n)
      {
        StringBuilder builder = new StringBuilder();

        //remove multiple spaces
        //http://stackoverflow.com/questions/1279859/how-to-replace-multiple-white-spaces-with-one-white-space
        string cleanedString = System.Text.RegularExpressions.Regex.Replace(text, @"\s+", " ");
        IEnumerable<string> words = cleanedString.Split().Take(n + 1);

        foreach (string word in words)
          builder.Append(" " + word);

        return builder.ToString();
      }

      /// <summary>
      /// Returns a string of html with tags removed
      /// </summary>
      /// <param name="html"></param>
      /// <returns></returns>
      public static string StripHtml(string html)
      {
        HtmlDocument document = new HtmlDocument();
        document.LoadHtml(html);

        var root = document.DocumentNode;
        var stringBuilder = new StringBuilder();

        foreach (var node in root.DescendantsAndSelf())
        {
          if (!node.HasChildNodes)
          {
            string text = node.InnerText;
            if (!string.IsNullOrEmpty(text))
              stringBuilder.Append(" " + text.Trim());
          }
        }

        return stringBuilder.ToString();
      }

    }
} 
```

圣诞节快乐！

# .net - 任何指向最小 CLI 运行时的指针？

> ID：834257
> 
> 赞同：2
> 
> 时间：2009-05-07T12:03:43.973
> 
> 标签：.net, mono, runtime, jit

我正在寻找可能的最小 CLI 子集实现。

现在，即使是解释器也可以，但我真的在寻找 JITted 运行时。除了 System.Object 和 Enum 等核心类之外，我什至不需要标准运行时中的任何东西。它还需要可移植并且对底层系统的依赖最少。

我考虑过单声道，它很重。将单声道减少到我的要求是一项艰巨的任务。我想知道它是否已经完成了。我目前正在查看 pnet，其中包括一个“小型”构建。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T12:09:00.840

不确定它是否有你要找的东西，但微软最近开源了[.Net Micro](http://www.microsoft.com/netmf/) Framework，可能值得一看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T12:14:57.317

.NET Micro Framework 是一个 IL 解释器，非常小。然而，它并不是功能齐全的——你没有得到泛型，并且像属性这样的一些东西的工作方式不同（没有 PropertyInfo）。

其他：

*   紧凑的框架
*   银光

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T16:01:45.833

看看带有 mkbundle的 Mono [Linker 。](http://www.mono-project.com/Linker)它的想法是它只会链接您需要的 Mono 片段，而不是更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T12:06:38.317

试试[Silverlight](http://en.wikipedia.org/wiki/Silverlight)，虽然它有点“浏览器内”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T12:17:00.103

您的构建脚本可能会变成 PITA - 但[CrossNet](http://crossnet.codeplex.com/ "代码复合体")可能是个好主意。它将 MSIL 编译成 C++。

所以你可以完全没有CLR :)。

# reportingservices-2005 - 在 Reporting Services 中自动重新加载有关参数选择的报告

> ID：834259
> 
> 赞同：0
> 
> 时间：2009-05-07T12:03:57.747
> 
> 标签：reportingservices-2005

在 Microsoft Reporting Services 2005 中，我希望每次查看器更改 sql 参数的值时刷新我的报表。

那怎么办？更一般地说，如何强制刷新某些操作（通常是单击按钮）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T12:37:13.737

我发现刷新报告的最佳方法是执行以下操作：

1.  做一个 ReportViewer.Reset()
2.  再次在 ReportViewer 控件上设置 ReportDefinition。
3.  做一个 ReportViewer.RefreshReport()

您可以将上述逻辑写入一个函数，然后在事件发生时调用该函数。

# html - 多选选项 RTL 对齐问题

> ID：834261
> 
> 赞同：3
> 
> 时间：2009-05-07T12:04:12.520
> 
> 标签：html, html-select, right-to-left

我有一个多选元素。当我尝试将选项向右对齐时，我做不到。

我在网上搜索了很多文章，但我没有找到解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T00:12:56.887

你有没有尝试过：

```
select { direction: rtl; } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-07T13:26:47.533

所有你需要的是：

```
select { text-align: right; } 
```

# wpf - 有没有办法检查组合框或列表框是否在屏幕上可见？

> ID：834263
> 
> 赞同：0
> 
> 时间：2009-05-07T12:04:47.620
> 
> 标签：wpf, listbox, listboxitem, visible

如果列表框有很多项目，是否有办法（以编程方式）检查项目是否在屏幕上可见。

例如，列表框有 100 个项目，但屏幕上只显示前 24 个项目，有没有办法检查当前是否显示特定（比如列表 [75]）或者应该滚动查看它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T14:15:52.157

试试这个： [http ://social.msdn.microsoft.com/forums/en-US/wpf/thread/2d527831-43aa-4fd5-8b7b-08cb5c4ed1db/](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/2d527831-43aa-4fd5-8b7b-08cb5c4ed1db/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-07T22:06:28.910

检查[计算列表框中可见项目的数量](https://stackoverflow.com/questions/830272/calculating-number-of-visible-items-in-listbox/43837145)并在下面查找我的帖子。

我见过许多不正确的复杂答案。

**简短回答：（listBox1.Height/listBox1.ItemHeight）**

# javascript - JSON 可以序列化使用 *functions* 作为键的数组吗？

> ID：834264
> 
> 赞同：0
> 
> 时间：2009-05-07T12:05:37.557
> 
> 标签：javascript, json, semantics

我正在涉足语言学 Javascript 项目。我想使用对象来表示名词和函数来存储动词来构建它，因为这使得我的项目概念化变得不那么困难。我使用函数作为对象的键（我在下面编写了一个示例）。当需要保存数据时，是否可以使用 JSON 序列化它。

```
function verbFn() {
   //do something
}

var nouns = {};

nouns[verbFn] = 'some value'; 
```

在这个例子中，JSON 是否能够序列化“名词”？

* * *

呃......在反思了我最初的问题并阅读了评论后，我得出的结论是，试图以这种方式做事是非常错误和愚蠢的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T12:12:51.300

不，[JSON](http://json.org/)不能做到这一点。键必须是双引号字符串。

此外，看起来您实际上并没有将该函数用作键 - 它正在被转换为字符串：

```
<script>

var x = {};
x[window.open] = true;

for (var i in x)
    alert(typeof i + '\n' + i); // typeof i == string

</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T12:13:44.667

根据[标准](http://www.json.org/)，你不能。键必须是字符串

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T12:44:47.650

您并没有真正使用函数作为键 - 您正在使用函数的字符串转换作为键，这也隐含地依赖于这些字符串表示是唯一的。对于支持反编译函数的平台，这可以正常工作，但理论上可能存在只返回“[function]”的实现，这在你的情况下会非常糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T12:18:24.327

不，键应该始终是字符串，而不是其他任何东西。见[标准说明](http://www.json.org/)。

并且`nouns`不是数组，它是映射、哈希表、关联数组、“对象”，其中之一，无论您喜欢什么名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T12:31:31.970

JSON 是一种数据结构语法。函数不是数据，因此无法将其序列化为数据结构（键或其他）的一部分。无论语言，实现或其他任何东西。

# wpf - WPF TreeView 想要在选择父级时选择第一个子级

> ID：834267
> 
> 赞同：2
> 
> 时间：2009-05-07T12:06:29.457
> 
> 标签：wpf, treeview, treeviewitem

我正在使用演示模型在我的应用程序中使用`TreeView`控件实现导航。我`TreeViewItem`通过双向绑定将 的 IsSelected 属性绑定到我的视图模型。选择具有子节点的节点时，我希望选择该节点的第一个子节点，而不是单击的那个节点。当它在我的演示模型上设置 IsSelected 属性时，似乎`TreeViewItem`没有监听属性更改事件。第一个子节点被选中，但父节点没有取消选择。这是我的演示模型中的代码。

```
public bool IsSelected {
    get {
        return this._isSelected;
    }
    set {
        if(this._isSelected != value) {
            this._isSelected = value;
            if(this.Nodes.Count > 0) {
                this._isSelected = false;
                this.Nodes[0].IsSelected = true;
            }
            this.NotifyPropertyChanged("IsSelected");
        }
    }
} 
```

这是我的风格`TreeViewItem`：

```
<Style TargetType="{x:Type TreeViewItem}">
    <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
</Style> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-18T16:10:36.077

我遇到了一个非常相似的问题，我发现当我通过代码选择一个孩子时，我还需要将焦点放在 TreeViewItem 包装器上，这样父节点就会成为你所谓的“UnSelect”。所以在 xaml 我添加了一个事件处理程序：

```
<EventSetter Event="TreeViewItem.Selected" 
                    Handler="TreeViewItem_Selected" 
                        /> 
```

在部分类中：

```
Private Sub TreeViewItem_Selected(ByVal sender As System.Object, ByVal e As RoutedEventArgs)
            If CType(sender, TreeViewItem) IsNot Nothing Then
                CType(sender, TreeViewItem).Focus()
                e.Handled = True
            End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-19T06:00:56.033

另一种考虑的可能性：

TreeView 试图确保不可能同时选择树中的两个 TreeViewItem，因此它应该防止这种情况发生。也许这是 TreeView 中的一个错误，但也可能是您使用 TreeView 的方式的问题。

为了效率，TreeView 对如何找到它下面的 TreeViewItems 非常挑剔。该算法实际上是这样的（以增量方式完成）：

1.  在我的项目容器中查找 TreeView 对象
2.  在这些 TreeView 对象的项目容器中查找更多 TreeView 对象
3.  重复步骤 3，直到找不到更多 TreeView 对象

正因为如此，TreeView 只有在每一层 TreeViewItems 都在前一层的正下方时才能找到它的后代。

例如，这将起作用：

```
<TreeView>
  <TreeViewItem>
    <TreeViewItem />
  </TreeViewItem>
  ...
</TreeView> 
```

这也是这样：

```
<HierarchicalDataTemplate TargetType="{x:Type MyItemType"} ItemsSource="{Binding subItems}">
  ...
</HierarchicalDataTemplate>

<TreeView ItemsSource="{Binding items}" /> 
```

但如果插入了非 TreeViewItems，它将不起作用，如下所示：

```
<TreeView>
  <TreeViewItem>
    <Border>
      <TreeViewItem/>
    </Border>
  </TreeViewItem>
</TreeView> 
```

或这个：

```
<TreeView>
  <DockPanel>
    <TreeViewItem>
      <TreeViewItem/>
    </TreeViewItem>
  </DockPanel>
</TreeView> 
```

最后两种情况会显示得很好，但 TreeView 不会看到 TreeViewItems，因此它的选择代码将被禁用。这会导致你描述的症状。

我不知道这是否是你的情况，但我想我应该提一下以防万一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-30T13:33:00.020

这是 Amir 答案的 C# 版本：

```
 private void TreeViewItem_Selected(object sender, RoutedEventArgs e)
        {
            var treeViewItem = sender as TreeViewItem;
            if (treeViewItem != null)
            {
                treeViewItem.Focus();
                e.Handled = true;
            }
        } 
```

# visual-studio - Visual Studio 生成后事件 - 复制到相对目录位置

> ID：834270
> 
> 赞同：252
> 
> 时间：2009-05-07T12:07:00.627
> 
> 标签：visual-studio, visual-studio-2008, post-build-event

在成功构建时，我希望将输出目录的内容复制到同一**“基本”**文件夹下的不同位置。此父文件夹是一个相对部分，可能会因源代码管理设置而异。

我列出了一些可供我使用的宏值...

$(SolutionDir) = **D:\GlobalDir\Version\AppName** \Solution1\build

$(ProjectDir) = **D:\GlobalDir\Version\AppName** \Solution1\Version\ProjectA\

我想将输出目录内容复制到以下文件夹：

**D:\GlobalDir\Version\AppName** \Solution2\Project\Dependency

需要从上述宏之一中获取基本位置“D:\GlobalDir\Version\AppName”。但是，没有一个宏值**仅**列出父位置。

如何**仅**提取构建后复制命令的基本位置？

* * *

## 回答 #1

> 赞同：326
> 
> 时间：2010-09-15T15:19:13.230

这是您要放入项目的构建后事件命令行中的内容：

```
copy /Y "$(TargetDir)$(ProjectName).dll" "$(SolutionDir)lib\$(ProjectName).dll" 
```

编辑：或者如果您的目标名称与项目名称不同。

```
copy /Y "$(TargetDir)$(TargetName).dll" "$(SolutionDir)lib\$(TargetName).dll" 
```

* * *

## 回答 #2

> 赞同：207
> 
> 时间：2009-05-07T12:10:38.167

如果没有任何 TargetDir 或其他宏指向正确的位置，请使用“..”目录向后移动文件夹层次结构。

IE。用于`$(SolutionDir)\..\..`获取您的基本目录。

* * *

有关所有宏的列表，请参见此处：

[http://msdn.microsoft.com/en-us/library/c02as0cs.aspx](http://msdn.microsoft.com/en-us/library/c02as0cs.aspx)

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-05-07T12:09:36.750

你可以试试：

```
$(SolutionDir)..\..\ 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-12-30T19:51:07.420

我认为这是相关的，但是在直接使用`msbuild`命令行（从批处理文件）构建与从 VS 内部构建时遇到了问题。

使用类似以下内容：

```
<PostBuildEvent>
  MOVE /Y "$(TargetDir)something.file1" "$(ProjectDir)something.file1"
  start XCOPY /Y /R "$(SolutionDir)SomeConsoleApp\bin\$(ConfigurationName)\*" "$(ProjectDir)App_Data\Consoles\SomeConsoleApp\"
</PostBuildEvent> 
```

*（注意：`start XCOPY`而不是`XCOPY`用来解决阻止复制的权限问题）*

从批处理文件执行 msbuild 时`$(SolutionDir)`评估的宏导致命令失败。在 Visual Studio 中构建时，它可以正常工作。确认使用以查看评估的输出。`..\``XCOPY``/verbosity:diagnostic`

相反，使用宏`$(ProjectDir)..\`，这相当于同一件事，工作正常，并在两个构建场景中保留了完整路径。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-07T12:44:01.473

直接使用 msbuild 没有意义吗？如果您对每个构建都执行此操作，那么您可以在最后添加一个 msbuild 任务吗？如果您只想查看是否找不到 Visual Studio IDE 上未显示的另一个宏值，您可以将 msbuild 选项切换为诊断，这将显示您可以使用的所有变量，如以及它们的当前值。

要在 Visual Studio 中打开此功能，请转到工具/选项，然后将树视图向下滚动到名为项目和解决方案的部分，展开该部分并单击构建并运行，在右侧它们是指定构建输出详细程度的下拉菜单，将其设置为诊断，将显示您可以使用的其他宏值。

因为我不太清楚你想达到什么水平，以及你希望你的构建有多复杂，所以这可能会给你一些想法。我最近一直在做构建脚本，甚至在构建过程中执行 SQL 代码。如果您需要更多帮助甚至一些示例构建脚本，请告诉我，但如果它只是您想在构建结束时运行的一个小过程，那么完整的 msbuild 脚本可能有点过头了.

希望对日韩有帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-19T13:24:39.663

我通过重新安装 VS 解决了我的问题，然后下载了 .Net Core（3.x 和 2.x）sdk 包

# c# - 有没有办法检查 WPF 当前是否在设计模式下执行？

> ID：834283
> 
> 赞同：157
> 
> 时间：2009-05-07T12:10:27.637
> 
> 标签：c#, wpf, expression-blend

**有谁知道一些可用的全局状态变量，以便我可以检查代码当前是否在设计模式下（例如在 Blend 或 Visual Studio 中）执行？**

它看起来像这样：

```
//pseudo code:
if (Application.Current.ExecutingStatus == ExecutingStatus.DesignMode) 
{
    ...
} 
```

我需要这个的原因是：当我的应用程序在 Expression Blend 中以设计模式显示时，我希望 ViewModel 使用“设计客户类”，其中包含设计人员可以在设计模式下查看的模拟数据。

但是，当应用程序实际执行时，我当然希望 ViewModel 使用返回真实数据的真实 Customer 类。

目前我通过让设计师在他开始工作之前进入 ViewModel 并将“ApplicationDevelopmentMode.Executing”更改为“ApplicationDevelopmentMode.Designing”来解决这个问题：

```
public CustomersViewModel()
{
    _currentApplicationDevelopmentMode = ApplicationDevelopmentMode.Designing;
}

public ObservableCollection<Customer> GetAll
{
    get
    {
        try
        {
            if (_currentApplicationDevelopmentMode == ApplicationDevelopmentMode.Developing)
            {
                return Customer.GetAll;
            }
            else
            {
                return CustomerDesign.GetAll;
            }
        }
        catch (Exception ex)
        {
            throw new Exception(ex.Message);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2009-05-07T12:20:43.823

我相信您正在寻找[GetIsInDesignMode](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerproperties.getisindesignmode.aspx)，它需要一个 DependencyObject。

IE。

```
// 'this' is your UI element
DesignerProperties.GetIsInDesignMode(this); 
```

**编辑：**使用 Silverlight / WP7 时，您应该使用[`IsInDesignTool`](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerproperties.isindesigntool%28v=VS.95%29.aspx)因为`GetIsInDesignMode`在 Visual Studio 中有时会返回 false：

```
DesignerProperties.IsInDesignTool 
```

**编辑：**最后，为了完整起见，WinRT / Metro / Windows Store 应用程序中的等价物是[`DesignModeEnabled`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.designmode.designmodeenabled.aspx)：

```
Windows.ApplicationModel.DesignMode.DesignModeEnabled 
```

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2009-05-07T12:19:18.630

你可以这样做：

```
DesignerProperties.GetIsInDesignMode(new DependencyObject()); 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-11-14T13:39:51.743

```
public static bool InDesignMode()
{
    return !(Application.Current is App);
} 
```

随时随地工作。我用它来阻止数据绑定视频在设计器中播放。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-07-21T21:28:29.257

[如相关答案中所述，](https://stackoverflow.com/a/6697006/1174169)还有其他（可能是较新的）方法可以在 WPF 中指定设计时数据。

[本质上，您可以使用ViewModel 的设计时实例](http://msdn.microsoft.com/en-us/library/dd490796(VS.100).aspx)指定设计时数据：

```
d:DataContext="{d:DesignInstance Type=v:MySampleData, IsDesignTimeCreatable=True}" 
```

或通过[在 XAML 文件中指定示例数据](http://msdn.microsoft.com/en-us/library/ee823176(v=vs.100).aspx)：

```
d:DataContext="{d:DesignData Source=../DesignData/SamplePage.xaml}"> 
```

您必须将`SamplePage.xaml`文件属性设置为：

```
BuildAction:               DesignData
Copy to Output Directory:  Do not copy
Custom Tool:               [DELETE ANYTHING HERE SO THE FIELD IS EMPTY] 
```

我将它们放在我的`UserControl`标签中，如下所示：

```
<UserControl
    ...
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 

    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    ...
    d:DesignWidth="640" d:DesignHeight="480"
    d:DataContext="..."> 
```

在运行时，所有“d:”设计时标记都会消失，因此您只会获得运行时数据上下文，但您可以选择设置它。

**编辑** 您可能还需要这些行（我不确定，但它们似乎相关）：

```
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
mc:Ignorable="d" 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-07-27T15:37:25.693

当 Visual Studio 自动为我生成一些代码时，它使用了

```
if (!System.ComponentModel.DesignerProperties.GetIsInDesignMode(this)) 
{
    ...
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-11-12T13:26:05.427

如果您在大型**WPF / Silverlight / WP8 / WinRT应用程序中广泛使用**[Caliburn.Micro](https://caliburnmicro.com/) ，您也可以在视图模型中使用方便且**通用**的 caliburn静态属性（它在 Blend 中的工作与在 Visual Studio 中一样好）：****`Execute.InDesignMode`****

 ****```
using Caliburn.Micro;

// ...

/// <summary>
/// Default view-model's ctor without parameters.
/// </summary>
public SomeViewModel()
{
    if(Execute.InDesignMode)
    {
        //Add fake data for design-time only here:

        //SomeStringItems = new List<string>
        //{
        //  "Item 1",
        //  "Item 2",
        //  "Item 3"
        //};
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-08-16T07:41:23.623

接受的答案对我不起作用（VS2019）。

在检查了发生了什么之后，我想出了这个：

```
 public static bool IsRunningInVisualStudioDesigner
    {
        get
        {
            // Are we looking at this dialog in the Visual Studio Designer or Blend?
            string appname = System.Reflection.Assembly.GetEntryAssembly().FullName;
            return appname.Contains("XDesProc");
        }
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-08-26T12:04:20.757

我只用 Visual Studio 2013 和 .NET 4.5 对此进行了测试，但它确实成功了。

```
public static bool IsDesignerContext()
{
  var maybeExpressionUseLayoutRounding =
    Application.Current.Resources["ExpressionUseLayoutRounding"] as bool?;
  return maybeExpressionUseLayoutRounding ?? false;
} 
```

尽管 Visual Studio 中的某些设置可能会将此值更改为 false，但如果发生这种情况，我们可能会导致仅检查此资源名称是否存在。那是`null`我在设计器之外运​​行我的代码的时候。

这种方法的好处是它不需要特定`App`类的明确知识，并且可以在整个代码中全局使用。专门用虚拟数据填充视图模型。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-10-08T16:10:37.593

如果您的类不需要空的构造函数，我有一个想法。

这个想法是创建一个空的构造函数，然后用 ObsoleteAttribute 标记它。设计者忽略了过时的属性，但是如果你尝试使用它，编译器会报错，所以你自己没有意外使用它的风险。

（[请原谅我的视觉基础](https://en.wikipedia.org/wiki/Pardon_my_French)）

```
Public Class SomeClass

    <Obsolete("Constructor intended for design mode only", True)>
    Public Sub New()
        DesignMode = True
        If DesignMode Then
            Name = "Paula is Brillant"
        End If
    End Sub

    Public Property DesignMode As Boolean
    Public Property Name As String = "FileNotFound"
End Class 
```

和 xaml：

```
<UserControl x:Class="TestDesignMode"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:AssemblyWithViewModels;assembly=AssemblyWithViewModels"
             mc:Ignorable="d" 
             >
  <UserControl.Resources>
    <vm:SomeClass x:Key="myDataContext" />
  </UserControl.Resources>
  <StackPanel>
    <TextBlock d:DataContext="{StaticResource myDataContext}" Text="{Binding DesignMode}" Margin="20"/>
    <TextBlock d:DataContext="{StaticResource myDataContext}" Text="{Binding Name}" Margin="20"/>
  </StackPanel>
</UserControl> 
```

[![上述代码的结果](https://i.stack.imgur.com/dLAyn.png)](https://i.stack.imgur.com/dLAyn.png)

*如果您真的*需要空构造函数来做其他事情，这将不起作用。

# c# - Best Fit a document in Richtextbox

> ID：834287
> 
> 赞同：0
> 
> 时间：2009-05-07T12:11:13.517
> 
> 标签：c#, wpf, richtextbox

Using C# How can I show a document in richtextbox without scrollbars, But I need like a bestfit mode? I mean what we are seeing like a preview.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T12:17:31.053

If you set the **Multiline** property to **true**, the contents should word wrap. That will take care of your horizontal scroll bars.

# php - 如何在 CodeIgniter 中扩展 Helper？

> ID：834291
> 
> 赞同：13
> 
> 时间：2009-05-07T12:12:12.143
> 
> 标签：php, codeigniter

我想在文件夹`string`中找到的核心助手中添加一些新功能。`system/helpers`我认为有一种“正确”的方法可以使用`MY_String_helper`或类似的东西来做到这一点。我不记得它是如何完成的。对这个问题有什么想法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-07T12:37:50.943

我找到了。在目录中创建一个名称如下的`application/helpers`文件：

```
MY_xx_helper.php 
```

例如：

```
MY_string_helper.php 
```

然后你可以打电话

```
$this->load->helper('string'); 
```

它应该加载所有现有的辅助函数以及您添加的新函数。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-17T14:58:41.883

这样做不仅可以添加新功能，还可以替换现有的辅助功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-06T00:25:23.390

对于主要来源，以防将来发生变化，[CodeIgniter 用户指南的 Helpers 页面](http://www.codeigniter.com/user_guide/general/helpers.html)有一个部分描述了如何扩展帮助程序。

# user-interface - 用户界面设计工具

> ID：834296
> 
> 赞同：6
> 
> 时间：2009-05-07T12:12:59.583
> 
> 标签：user-interface

我需要找到一些设计 UI 的好工具。我只需要设计部分，我不需要任何代码生成或类似的东西......找到一些免费软件会很好;）

蒂亚

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T12:25:14.873

我用过[Balsamiq Mockups](http://www.balsamiq.com/products/mockups)并且对它非常满意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T12:16:37.420

迄今为止我发现的最好的免费软件是[Pencil](http://www.evolus.vn/Pencil/)，它可以作为独立应用程序或 Firefox 插件安装。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T13:03:37.353

这取决于你所说的“设计”到底是什么意思。

如果您的意思是图形设计，例如您想为您的 UI 制作漂亮的精美图形，然后将其分割和集成，那么我个人总是使用Adob​​e 的[Fireworks](http://www.adobe.com/products/fireworks/)（最初是 Macromedia 产品）。它是一个基于矢量的图形工具，所以我发现它比 Photoshop 或 Illustrator 更易于使用。不过不是免费的。

如果您的意思是设计 UI 元素并尝试不同的想法，例如原型设计，那么笔和纸是最好的工具！使用便签或白板来模拟状态变化，很容易迭代和与用户一起制作原型。甚至有一[本](http://www.paperprototyping.com/)书写在上面。如果您需要数字但低保真的东西，那么[Baclsamiq Mockups](http://www.balsamiq.com/products/mockups)是一个不错的选择，或者任何可以让您绘制简单形状的东西（油漆！）。

（预览搞砸了超链接，我希望发布后效果会更好......）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T12:15:40.277

看看[http://www.lovelycharts.com](http://www.lovelycharts.com)关键是简单，这样您在创建 UI 时就不会被设计细节所困扰

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-07T12:21:18.673

我发现[Mockup Screens](http://www.mockupscreens.com/)真的很有用。

有关此主题的更多帖子：

[https://stackoverflow.com/questions/156937/do-you-know-an-alternative-to-balsamiq-mockups](https://stackoverflow.com/questions/156937/do-you-know-an-alternative-to-balsamiq-mockups) [https://stackoverflow.com/questions/54606/what-software-can-i-use-to -create-ui-mockups](https://stackoverflow.com/questions/54606/what-software-can-i-use-to-create-ui-mockups) [https://stackoverflow.com/questions/5672/what-are-you-using-for-web-ui-layout-design](https://stackoverflow.com/questions/5672/what-are-you-using-for-web-ui-layout-design)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T12:23:10.290

我使用过[Microsoft Expression](http://www.microsoft.com/expression/)。它是一个很棒的 UI 设计工具。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T12:29:17.547

您可以尝试[ForeUI](http://www.foreui.com)，非常方便并满足您的要求，他们现在提供免费许可证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-12T09:21:08.447

最伟大的高视觉设计 - Adob​​e Photoshop | 表情设计 | Gimp[免费] Prototype - Expression Blend, PPT

这是我的博客 - [http://artsmaths.blogspot.com/2009/03/tool-for-doing-ui-mockups.html](http://artsmaths.blogspot.com/2009/03/tool-for-doing-ui-mockups.html)

# sql - 找出在 SQL Server 上的查询中获得了哪些锁？

> ID：834300
> 
> 赞同：8
> 
> 时间：2009-05-07T12:13:42.717
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我的应用程序中有一条 SQL 语句。我想知道该语句获得了哪些锁；我怎样才能用 SQL 服务器做到这一点？该声明已陷入僵局，我正在尝试对其进行分析；我无法重现死锁。我在 MS SQL Server 2005 上运行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T12:37:08.120

您可以在事务中运行语句，但不能提交事务。由于锁将一直保留到事务提交，这使您有时间检查锁。（不是无限期的，但默认为 5 分钟。）

像：

```
BEGIN TRANSACTION
select * from table 
```

然后打开 Management Studio 并检查锁。它们位于管理 -> 活动监视器 -> 按对象锁定或按进程锁定。完成后，运行：

```
COMMIT TRANSACTION 
```

释放锁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T12:36:01.820

我建议您首先打开死锁检测跟踪标志，而不是无限期地运行 Profiler Trace。

这样，事件详细信息将记录到 SQL Server 错误日志中。

有关各种跟踪标志的详细信息，请查看以下联机丛书参考。您需要使用 1204 和/或 1222

[http://msdn.microsoft.com/en-us/library/ms188396(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms188396(SQL.90).aspx)

确保启用具有服务器范围的跟踪标志，而不仅仅是当前会话。例如使用：

```
DBCC TRACEON(1222,-1) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T23:55:42.857

这是一个查询，它将显示所有活动锁、谁拥有它们以及它们在什么对象上。我从几年前的一篇技术网文章或其他东西中提取了这个。它适用于 SQL 2000 和 2005（在 2005 年将 sysobjects 更改为 sys.objects。）如果要将 WHERE 子句限制为仅此数据库，请取消注释，并且仅使用“EXCLUSIVE”锁。

```
select 'Locks' as Locks,
    spid, nt_username, name, hostname, loginame, waittime, open_tran,
    convert(varchar ,getdate() - last_batch, 114) as TimeSinceLastCommand,
    case req_mode
    when  0 then 'Not granted'
    when  1 then 'Schema stability'
    when  2 then 'Schema modification'
    when  3 then 'Intent shared'
    when  4 then 'Shared intent update'
    when  5 then 'Intent shared shared'
    when  6 then 'Intent exclusive'
    when  7 then 'Shared Intent Exclusive'
    when  8 then 'Shared'
    when  9 then 'Update'
    when 10 then 'Intent insert NULL'
    when 11 then 'Intent shared exclusive'
    when 12 then 'Intent update'
    when 13 then 'Intent shared-update'
    when 14 then 'Exclusive'
    when 15 then 'Bulk operation'
    else str(req_mode) end as LockMode
from master..syslockinfo
    left join sysobjects so on so.id = rsc_objid
    left join master..sysprocesses sp on sp.spid = req_spid
--where rsc_dbid = (select db_id()) and ltrim(req_mode) in (6,7,11,14) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T12:19:46.103

在分析器中运行跟踪（选择空白模板），选择死锁图事件，然后在出现的新选项卡（事件提取设置）上，将每个（检查分别保存死锁 XML 事件）保存在自己的文件中。在 xml 查看器中打开这个文件，很容易知道发生了什么。每个进程都包含在内，还有一堆过程调用等，所有的锁也都在里面。

让这个跟踪一直运行到死锁再次发生，信息只在死锁发生时记录，所以开销不大。如果它再也不会发生，那么它已经解决了，如果没有，你已经捕获了所有信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T14:23:15.977

您可以在您的开发箱上运行探查器跟踪以进行查询，并准确查看使用了哪些锁。这通常是大量数据，但其中大部分是您可以浏览的模式。例如，对于已提交的读取隔离，您将在执行表或索引扫描时看到一连串的锁被获取和释放（每行在读取之前必须被锁定，并且在读取后立即释放）。

你在什么隔离下运行？什么样的查询是死锁的？您是在使用包含多个更新的显式事务，还是它们是单个语句死锁？

最典型的死锁情况是具有序列（更新表 x，更新表 y）的事务，以及具有序列（更新表 y，更新表 x）的第二个事务。常见的解决方案是确保跨查询使用相同的更新序列。

让我们知道它们是什么类型的查询，不同类型的交易有不同的常见问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-19T13:59:20.333

解决死锁问题：

[http://blogs.msdn.com/bartd/archive/2006/09/09/747119.aspx](http://blogs.msdn.com/bartd/archive/2006/09/09/747119.aspx) [http://blogs.msdn.com/bartd/archive/2006/09/13/751343.aspx](http://blogs.msdn.com/bartd/archive/2006/09/13/751343.aspx)

重现死锁：

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/01/01/reproduce-deadlocks-involving-only-one-table.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/01/01/reproducing-deadlocks-involving-only-one-table.aspx)

# c - TiffLib 泄漏无效文件的句柄

> ID：834302
> 
> 赞同：1
> 
> 时间：2009-05-07T12:14:19.733
> 
> 标签：c, libtiff

如果我尝试用 . 打开无效的 TIFF 文件`TIFFOpen()`，函数将返回`NULL`. 由于某种原因，没有调用错误处理程序。但是，该文件仍处于打开状态，因此我无法从同一进程中删除/覆盖它。

我尝试使用`TIFFFdOpen()`，以便我可以自己关闭句柄，但由于某种原因，它在有效 TIFF 上给了我这个错误：**“无法读取 TIFF 标头”**。这次错误是通过错误处理程序传递的。

我该如何解决这些问题中的任何一个？

更新：我说的是问题`TIFFOpen()`本身，而不是稍后调用的函数。例如，如果 TIFF 文件的大小为零，它们可能会发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T12:30:02.770

也许你有一个旧的或损坏的 libtiff？我尝试使用 libtiff-3.8.2，它似乎工作正常：

```
$ head -c 1000000 sample.tif > broken.tif
$ tiffinfo broken.tif
TIFFReadDirectory: broken.tif: Can not read TIFF directory count.
$ strace tiffinfo broken.tif 
...
open("broken.tif", O_RDONLY)            = 3
...
write(2, "broken.tif: Can not read TIFF dir"...
...
close(3)                                = 0
exit_group(0)                           = ? 
```

IE。有一个正常的错误并且没有泄漏（在退出前明确关闭）。我用自己的代码得到了同样的行为。

# php - PHP中的startsWith()和endsWith()函数

> ID：834303
> 
> 赞同：1646
> 
> 时间：2009-05-07T12:14:27.567
> 
> 标签：php, string

如果它以指定的字符/字符串开头或以指定的字符/字符串结尾，我如何编写两个接受字符串并返回的函数？

例如：

```
$str = '|apples}';

echo startsWith($str, '|'); //Returns true
echo endsWith($str, '}'); //Returns true 
```

* * *

## 回答 #1

> 赞同：1791
> 
> 时间：2009-05-07T12:24:25.640

## PHP 8.0 及更高版本

从 PHP 8.0 开始，您可以使用

`str_starts_with` [手动](https://www.php.net/manual/en/function.str-starts-with) 和

`str_ends_with` [手动的](https://www.php.net/manual/en/function.str-ends-with)

##### 例子

`echo str_starts_with($str, '|');`

## 8.0 之前的 PHP

```
function startsWith( $haystack, $needle ) {
     $length = strlen( $needle );
     return substr( $haystack, 0, $length ) === $needle;
} 
```

```
function endsWith( $haystack, $needle ) {
    $length = strlen( $needle );
    if( !$length ) {
        return true;
    }
    return substr( $haystack, -$length ) === $needle;
} 
```

* * *

## 回答 #2

> 赞同：1085
> 
> 时间：2012-05-06T18:22:36.923

您可以使用[`substr_compare`](https://www.php.net/manual/en/function.substr-compare.php)函数来检查开头和结尾：

```
function startsWith($haystack, $needle) {
    return substr_compare($haystack, $needle, 0, strlen($needle)) === 0;
}
function endsWith($haystack, $needle) {
    return substr_compare($haystack, $needle, -strlen($needle)) === 0;
} 
```

* * *

^(这应该是 PHP 7（[基准脚本](https://gist.github.com/salmanarshad2000/99ce15b5be1bd12d7523939397eec20c)）上最快的解决方案之一。针对 8KB 干草堆、各种长度的针以及完整、部分和不匹配的情况进行了测试。`strncmp`对于starts-with来说是一个更快的触摸，但它不能检查ends-with。)

* * *

## 回答 #3

> 赞同：258
> 
> 时间：2011-08-24T00:07:50.803

2016 年 8 月 23 日更新

# 职能

```
function substr_startswith($haystack, $needle) {
    return substr($haystack, 0, strlen($needle)) === $needle;
}

function preg_match_startswith($haystack, $needle) {
    return preg_match('~' . preg_quote($needle, '~') . '~A', $haystack) > 0;
}

function substr_compare_startswith($haystack, $needle) {
    return substr_compare($haystack, $needle, 0, strlen($needle)) === 0;
}

function strpos_startswith($haystack, $needle) {
    return strpos($haystack, $needle) === 0;
}

function strncmp_startswith($haystack, $needle) {
    return strncmp($haystack, $needle, strlen($needle)) === 0;
}

function strncmp_startswith2($haystack, $needle) {
    return $haystack[0] === $needle[0]
        ? strncmp($haystack, $needle, strlen($needle)) === 0
        : false;
} 
```

# 测试

```
echo 'generating tests';
for($i = 0; $i < 100000; ++$i) {
    if($i % 2500 === 0) echo '.';
    $test_cases[] = [
        random_bytes(random_int(1, 7000)),
        random_bytes(random_int(1, 3000)),
    ];
}
echo "done!\n";

$functions = ['substr_startswith', 'preg_match_startswith', 'substr_compare_startswith', 'strpos_startswith', 'strncmp_startswith', 'strncmp_startswith2'];
$results = [];

foreach($functions as $func) {
    $start = microtime(true);
    foreach($test_cases as $tc) {
        $func(...$tc);
    }
    $results[$func] = (microtime(true) - $start) * 1000;
}

asort($results);

foreach($results as $func => $time) {
    echo "$func: " . number_format($time, 1) . " ms\n";
} 
```

# 结果（PHP 7.0.9）

（从快到慢排序）

```
strncmp_startswith2: 40.2 ms
strncmp_startswith: 42.9 ms
substr_compare_startswith: 44.5 ms
substr_startswith: 48.4 ms
strpos_startswith: 138.7 ms
preg_match_startswith: 13,152.4 ms 
```

# 结果（PHP 5.3.29）

（从快到慢排序）

```
strncmp_startswith2: 477.9 ms
strpos_startswith: 522.1 ms
strncmp_startswith: 617.1 ms
substr_compare_startswith: 706.7 ms
substr_startswith: 756.8 ms
preg_match_startswith: 10,200.0 ms 
```

[开始于_benchmark.php](https://gist.github.com/mnpenner/9a941ab830a457ed0358#file-startswith_benchmark-php)

* * *

## 回答 #4

> 赞同：145
> 
> 时间：2009-05-13T21:23:43.593

到目前为止，所有答案似乎都做了很多不必要的工作，`strlen calculations`,`string allocations (substr)`等。`'strpos'`and`'stripos'`函数返回第一次出现`$needle`in的索引`$haystack`：

```
function startsWith($haystack,$needle,$case=true)
{
    if ($case)
        return strpos($haystack, $needle, 0) === 0;

    return stripos($haystack, $needle, 0) === 0;
}

function endsWith($haystack,$needle,$case=true)
{
    $expectedPosition = strlen($haystack) - strlen($needle);

    if ($case)
        return strrpos($haystack, $needle, 0) === $expectedPosition;

    return strripos($haystack, $needle, 0) === $expectedPosition;
} 
```

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2009-05-07T12:15:48.263

```
function startsWith($haystack, $needle, $case = true) {
    if ($case) {
        return (strcmp(substr($haystack, 0, strlen($needle)), $needle) === 0);
    }
    return (strcasecmp(substr($haystack, 0, strlen($needle)), $needle) === 0);
}

function endsWith($haystack, $needle, $case = true) {
    if ($case) {
        return (strcmp(substr($haystack, strlen($haystack) - strlen($needle)), $needle) === 0);
    }
    return (strcasecmp(substr($haystack, strlen($haystack) - strlen($needle)), $needle) === 0);
} 
```

**信用**：

[检查一个字符串是否以另一个字符串结尾](http://snipplr.com/view/13213/check-if-a-string-ends-with-another-string/)

[检查一个字符串是否以另一个字符串开头](http://snipplr.com/view/13214/check-if-a-string-begins-with-another-string/)

* * *

## 回答 #6

> 赞同：51
> 
> 时间：2020-06-03T09:13:18.473

# PHP 8 更新

PHP 8 包括新[`str_starts_with`](https://www.php.net/manual/en/function.str-starts-with.php)的[`str_ends_with`](https://www.php.net/manual/en/function.str-ends-with.php)函数，它们最终为这个问题提供了一个高性能和方便的解决方案：

```
$str = "beginningMiddleEnd";
if (str_starts_with($str, "beg")) echo "printed\n";
if (str_starts_with($str, "Beg")) echo "not printed\n";
if (str_ends_with($str, "End")) echo "printed\n";
if (str_ends_with($str, "end")) echo "not printed\n"; 
```

此功能的[RFC](https://wiki.php.net/rfc/add_str_starts_with_and_ends_with_functions)提供了更多信息，并讨论了明显（和不那么明显）用户空间实现的优点和问题。

* * *

## 回答 #7

> 赞同：45
> 
> 时间：2016-01-06T08:59:32.017

这个问题已经有了很多答案，但在某些情况下，您可以选择比所有答案都简单的答案。如果您要查找的字符串是已知的（硬编码），则可以使用正则表达式而无需任何引用等。

检查字符串是否以 'ABC' 开头：

```
preg_match('/^ABC/', $myString); // "^" here means beginning of string 
```

以“ABC”结尾：

```
preg_match('/ABC$/', $myString); // "$" here means end of string 
```

在我的简单情况下，我想检查一个字符串是否以斜杠结尾：

```
preg_match('#/$#', $myPath);   // Use "#" as delimiter instead of escaping slash 
```

优点：由于它非常简短，因此您不必定义`endsWith()`如上所示的函数（例如 ）。

但同样——这不是每个案例的解决方案，只是这个非常具体的解决方案。

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2009-06-19T16:11:51.463

上面的正则表达式函数，但上面还建议了其他调整：

```
 function startsWith($needle, $haystack) {
     return preg_match('/^' . preg_quote($needle, '/') . '/', $haystack);
 }

 function endsWith($needle, $haystack) {
     return preg_match('/' . preg_quote($needle, '/') . '$/', $haystack);
 } 
```

* * *

## 回答 #9

> 赞同：30
> 
> 时间：2018-07-24T06:05:43.220

### 最快的 endsWith() 解决方案：

```
# Checks if a string ends in a string
function endsWith($haystack, $needle) {
    return substr($haystack,-strlen($needle))===$needle;
} 
```

### 基准：

```
# This answer
function endsWith($haystack, $needle) {
    return substr($haystack,-strlen($needle))===$needle;
}

# Accepted answer
function endsWith2($haystack, $needle) {
    $length = strlen($needle);

    return $length === 0 ||
    (substr($haystack, -$length) === $needle);
}

# Second most-voted answer
function endsWith3($haystack, $needle) {
    // search forward starting from end minus needle length characters
    if ($needle === '') {
        return true;
    }
    $diff = \strlen($haystack) - \strlen($needle);
    return $diff >= 0 && strpos($haystack, $needle, $diff) !== false;
}

# Regex answer
function endsWith4($haystack, $needle) {
    return preg_match('/' . preg_quote($needle, '/') . '$/', $haystack);
}

function timedebug() {
    $test = 10000000;

    $time1 = microtime(true);
    for ($i=0; $i < $test; $i++) {
        $tmp = endsWith('TestShortcode', 'Shortcode');
    }
    $time2 = microtime(true);
    $result1 = $time2 - $time1;

    for ($i=0; $i < $test; $i++) {
        $tmp = endsWith2('TestShortcode', 'Shortcode');
    }
    $time3 = microtime(true);
    $result2 = $time3 - $time2;

    for ($i=0; $i < $test; $i++) {
        $tmp = endsWith3('TestShortcode', 'Shortcode');
    }
    $time4 = microtime(true);
    $result3 = $time4 - $time3;

    for ($i=0; $i < $test; $i++) {
        $tmp = endsWith4('TestShortcode', 'Shortcode');
    }
    $time5 = microtime(true);
    $result4 = $time5 - $time4;

    echo $test.'x endsWith: '.$result1.' seconds # This answer<br>';
    echo $test.'x endsWith2: '.$result4.' seconds # Accepted answer<br>';
    echo $test.'x endsWith3: '.$result2.' seconds # Second most voted answer<br>';
    echo $test.'x endsWith4: '.$result3.' seconds # Regex answer<br>';
    exit;
}
timedebug(); 
```

### 基准测试结果：

```
10000000x endsWith: 1.5760900974274 seconds # This answer
10000000x endsWith2: 3.7102129459381 seconds # Accepted answer
10000000x endsWith3: 1.8731069564819 seconds # Second most voted answer
10000000x endsWith4: 2.1521229743958 seconds # Regex answer 
```

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2009-12-15T08:53:34.900

如果速度对你很重要，试试这个。（我相信这是最快的方法）

仅适用于字符串，如果 $haystack 只有 1 个字符

```
function startsWithChar($needle, $haystack)
{
   return ($needle === $haystack[0]);
}

function endsWithChar($needle, $haystack)
{
   return ($needle === $haystack[strlen($haystack) - 1]);
}

$str='|apples}';
echo startsWithChar('|',$str); //Returns true
echo endsWithChar('}',$str); //Returns true
echo startsWithChar('=',$str); //Returns false
echo endsWithChar('#',$str); //Returns false 
```

* * *

## 回答 #11

> 赞同：21
> 
> 时间：2013-08-02T07:40:01.687

这里有两个不引入临时字符串的函数，这在针很大时可能很有用：

```
function startsWith($haystack, $needle)
{
    return strncmp($haystack, $needle, strlen($needle)) === 0;
}

function endsWith($haystack, $needle)
{
    return $needle === '' || substr_compare($haystack, $needle, -strlen($needle)) === 0;
} 
```

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2009-09-17T02:50:51.293

我意识到这已经完成了，但是您可能想查看[strncmp](http://us.php.net/manual/en/function.strncmp.php)因为它允许您放置要比较的字符串的长度，所以：

```
function startsWith($haystack, $needle, $case=true) {
    if ($case)
        return strncasecmp($haystack, $needle, strlen($needle)) == 0;
    else
        return strncmp($haystack, $needle, strlen($needle)) == 0;
} 
```

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2017-11-10T13:59:15.213

这是已接受答案的多字节安全版本，它适用于 UTF-8 字符串：

```
function startsWith($haystack, $needle)
{
    $length = mb_strlen($needle, 'UTF-8');
    return (mb_substr($haystack, 0, $length, 'UTF-8') === $needle);
}

function endsWith($haystack, $needle)
{
    $length = mb_strlen($needle, 'UTF-8');
    return $length === 0 ||
        (mb_substr($haystack, -$length, $length, 'UTF-8') === $needle);
} 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2015-05-12T12:36:21.353

您可以使用[**`strpos`**](http://php.net/manual/en/function.strpos.php)和[**`strrpos`**](http://php.net/manual/en/function.strrpos.php)

```
$bStartsWith = strpos($sHaystack, $sNeedle) == 0;
$bEndsWith = strrpos($sHaystack, $sNeedle) == strlen($sHaystack)-strlen($sNeedle); 
```

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2011-06-28T22:40:33.320

没有正则表达式的简短且易于理解的单行语句。

startsWith() 是直截了当的。

```
function startsWith($haystack, $needle) {
   return (strpos($haystack, $needle) === 0);
} 
```

endsWith() 使用了稍微花哨和缓慢的 strrev()：

```
function endsWith($haystack, $needle) {
   return (strpos(strrev($haystack), strrev($needle)) === 0);
} 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2013-07-28T14:00:16.147

关注startswith，如果你确定字符串不为空，在第一个字符上添加一个测试，在比较之前，strlen等，加快速度：

```
function startswith5b($haystack, $needle) {
    return ($haystack{0}==$needle{0})?strncmp($haystack, $needle, strlen($needle)) === 0:FALSE;
} 
```

它以某种方式更快（20％-30％）。添加另一个字符测试，如 $haystack{1}===$needle{1} 似乎并没有加快速度，甚至可能减慢速度。

`===`似乎比`==` 条件运算符`(a)?b:c`快`if(a) b; else c;`

* * *

**对于那些问“为什么不使用 strpos？”的人。称其他解决方案为“不必要的工作”**

* * *

strpos 速度很快，但它不是这项工作的正确工具。

为了理解，这里以一个小模拟为例：

```
Search a12345678c inside bcdefga12345678xbbbbb.....bbbbba12345678c 
```

**计算机在“内部”做什么？**

```
 With strccmp, etc...

    is a===b? NO
    return false

    With strpos

    is a===b? NO -- iterating in haysack
    is a===c? NO
    is a===d? NO
    ....
    is a===g? NO
    is a===g? NO
    is a===a? YES
    is 1===1? YES -- iterating in needle
    is 2===3? YES
    is 4===4? YES
    ....
    is 8===8? YES
    is c===x? NO: oh God,
    is a===1? NO -- iterating in haysack again
    is a===2? NO
    is a===3? NO
    is a===4? NO
    ....
    is a===x? NO
    is a===b? NO
    is a===b? NO
    is a===b? NO
    is a===b? NO
    is a===b? NO
    is a===b? NO
    is a===b? NO
    ...
    ... may many times...
    ...
    is a===b? NO
    is a===a? YES -- iterating in needle again
    is 1===1? YES
    is 2===3? YES
    is 4===4? YES
    is 8===8? YES
    is c===c? YES YES YES I have found the same string! yay!
    was it at position 0? NOPE
    What you mean NO? So the string I found is useless? YEs.
    Damn.
    return false 
```

假设 strlen 不迭代整个字符串（但即使在这种情况下），这根本不方便。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2013-10-18T13:01:23.217

我希望以下答案可能有效且简单：

```
$content = "The main string to search";
$search = "T";
//For compare the begining string with case insensitive. 
if(stripos($content, $search) === 0) echo 'Yes';
else echo 'No';

//For compare the begining string with case sensitive. 
if(strpos($content, $search) === 0) echo 'Yes';
else echo 'No';

//For compare the ending string with case insensitive. 
if(stripos(strrev($content), strrev($search)) === 0) echo 'Yes';
else echo 'No';

//For compare the ending string with case sensitive. 
if(strpos(strrev($content), strrev($search)) === 0) echo 'Yes';
else echo 'No'; 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2015-01-23T03:53:12.740

这些天我通常最终会使用像[underscore-php](http://anahkiasen.github.io/underscore-php/#String-endsWith)这样的库。

```
require_once("vendor/autoload.php"); //use if needed
use Underscore\Types\String; 

$str = "there is a string";
echo( String::startsWith($str, 'the') ); // 1
echo( String::endsWith($str, 'ring')); // 1 
```

该库充满了其他方便的功能。

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2016-09-21T14:31:07.207

mpen的[回答](https://stackoverflow.com/a/7168986/3404298)[非常](https://stackoverflow.com/users/65387/mpen)彻底，但不幸的是，所提供的基准有一个非常重要且有害的疏忽。

因为 needles 和 haystacks 中的每个字节都是完全随机的，所以 needle-haystack 对在第一个字节上不同的概率是 99.609375%，这意味着平均而言，100000 对中的大约 99609 个在第一个字节上会不同. 换句话说，基准测试严重偏向于`startswith`显式检查第一个字节的`strncmp_startswith2`实现。

如果测试生成循环按如下方式实现：

```
echo 'generating tests';
for($i = 0; $i < 100000; ++$i) {
    if($i % 2500 === 0) echo '.';

    $haystack_length = random_int(1, 7000);
    $haystack = random_bytes($haystack_length);

    $needle_length = random_int(1, 3000);
    $overlap_length = min(random_int(0, $needle_length), $haystack_length);
    $needle = ($needle_length > $overlap_length) ?
        substr($haystack, 0, $overlap_length) . random_bytes($needle_length - $overlap_length) :
        substr($haystack, 0, $needle_length);

    $test_cases[] = [$haystack, $needle];
}
echo " done!<br />"; 
```

基准测试结果讲述了一个稍微不同的故事：

```
strncmp_startswith: 223.0 ms
substr_startswith: 228.0 ms
substr_compare_startswith: 238.0 ms
strncmp_startswith2: 253.0 ms
strpos_startswith: 349.0 ms
preg_match_startswith: 20,828.7 ms 
```

当然，这个基准可能仍然不是完全无偏的，但它也测试了在给定部分匹配针时算法的效率。

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2012-04-19T20:50:42.567

简而言之：

```
function startsWith($str, $needle){
   return substr($str, 0, strlen($needle)) === $needle;
}

function endsWith($str, $needle){
   $length = strlen($needle);
   return !$length || substr($str, - $length) === $needle;
} 
```

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2016-07-26T20:02:45.550

### 做得更快：

```
function startsWith($haystack,$needle) {
    if($needle==="") return true;
    if($haystack[0]<>$needle[0]) return false; // ------------------------- speed boost!
    return (0===substr_compare($haystack,$needle,0,strlen($needle)));
} 
```

那条额外的行，比较字符串的第一个字符，可以使错误的情况*立即*返回，因此使您的许多比较快得多（当我测量时快 7 倍）。在真正的情况下，您几乎不会为那条线路付出任何性能代价，所以我认为它值得包括在内。（此外，在实践中，当您针对特定起始块测试许多字符串时，大多数比较都会失败，因为在典型情况下您正在寻找某些东西。）

*注意：@Tino 下面评论中的错误已经修复*

### 至于字符串与整数

如果您想强制进行字符串比较（即，您希望 startsWith("1234",12) 为真），则需要进行一些类型转换：

```
function startsWith($haystack,$needle) {
    if($needle==="") return true;
    $haystack = (string)$haystack;
    $needle   = (string)$needle;
    if($haystack[0]<>$needle[0]) return false; // ------------------------- speed boost!
    return (0===substr_compare($haystack,$needle,0,strlen($needle)));
} 
```

我认为没有必要，但这是一个有趣的边缘案例，会引发诸如“布尔值是否以 at 开头？”之类的问题。- 所以你决定，但要确保你决定好。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2013-06-04T08:51:39.067

这可能有效

```
function startsWith($haystack, $needle) {
     return substr($haystack, 0, strlen($needle)) == $needle;
} 
```

来源：[https ://stackoverflow.com/a/4419658](https://stackoverflow.com/a/4419658)

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2012-02-21T11:52:55.553

该`substr`函数可以`false`在许多特殊情况下返回，所以这是我的版本，它处理这些问题：

```
function startsWith( $haystack, $needle ){
  return $needle === ''.substr( $haystack, 0, strlen( $needle )); // substr's false => empty string
}

function endsWith( $haystack, $needle ){
  $len = strlen( $needle );
  return $needle === ''.substr( $haystack, -$len, $len ); // ! len=0
} 
```

测试（`true`表示好）：

```
var_dump( startsWith('',''));
var_dump( startsWith('1',''));
var_dump(!startsWith('','1'));
var_dump( startsWith('1','1'));
var_dump( startsWith('1234','12'));
var_dump(!startsWith('1234','34'));
var_dump(!startsWith('12','1234'));
var_dump(!startsWith('34','1234'));
var_dump('---');
var_dump( endsWith('',''));
var_dump( endsWith('1',''));
var_dump(!endsWith('','1'));
var_dump( endsWith('1','1'));
var_dump(!endsWith('1234','12'));
var_dump( endsWith('1234','34'));
var_dump(!endsWith('12','1234'));
var_dump(!endsWith('34','1234')); 
```

另外，`substr_compare`功能也值得一看。 [http://www.php.net/manual/en/function.substr-compare.php](http://www.php.net/manual/en/function.substr-compare.php)

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2012-06-30T03:49:27.743

为什么不是以下？

```
//How to check if a string begins with another string
$haystack = "valuehaystack";
$needle = "value";
if (strpos($haystack, $needle) === 0){
    echo "Found " . $needle . " at the beginning of " . $haystack . "!";
} 
```

输出：

> 在valuehaystack开头找到值！

请记住，`strpos`如果在大海捞针中没有找到针，则返回 false，并且当且仅当在索引 0（也称为开头）处找到针时，才会返回 0。

这里是endsWith：

```
$haystack = "valuehaystack";
$needle = "haystack";

//If index of the needle plus the length of the needle is the same length as the entire haystack.
if (strpos($haystack, $needle) + strlen($needle) === strlen($haystack)){
    echo "Found " . $needle . " at the end of " . $haystack . "!";
} 
```

在这种情况下，不需要函数 startsWith() 为

```
(strpos($stringToSearch, $doesItStartWithThis) === 0) 
```

将准确返回 true 或 false。

看起来很奇怪，所有狂野的功能都在这里泛滥成灾，这么简单。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2014-10-07T13:27:04.547

我会这样做

```
 function startWith($haystack,$needle){
              if(substr($haystack,0, strlen($needle))===$needle)
              return true;
        }

  function endWith($haystack,$needle){
              if(substr($haystack, -strlen($needle))===$needle)
              return true;
        } 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2009-10-30T00:17:34.113

根据 James Black 的回答，这里是它的 endsWith 版本：

```
function startsWith($haystack, $needle, $case=true) {
    if ($case)
        return strncmp($haystack, $needle, strlen($needle)) == 0;
    else
        return strncasecmp($haystack, $needle, strlen($needle)) == 0;
}

function endsWith($haystack, $needle, $case=true) {
     return startsWith(strrev($haystack),strrev($needle),$case);

} 
```

注意：我已经将 if-else 部分换成了 James Black 的 startsWith 函数，因为 strncasecmp 实际上是不区分大小写的 strncmp 版本。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2013-12-06T19:45:39.063

以前的许多答案也同样有效。但是，这可能会尽可能短，并让它做你想做的事。您只需声明您希望它“返回真实”。所以我已经包含了返回布尔真/假和文本真/假的解决方案。

```
// boolean true/false
function startsWith($haystack, $needle)
{
    return strpos($haystack, $needle) === 0 ? 1 : 0;
}

function endsWith($haystack, $needle)
{
    return stripos($haystack, $needle) === 0 ? 1 : 0;
}

// textual true/false
function startsWith($haystack, $needle)
{
    return strpos($haystack, $needle) === 0 ? 'true' : 'false';
}

function endsWith($haystack, $needle)
{
    return stripos($haystack, $needle) === 0 ? 'true' : 'false';
} 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2019-08-28T13:28:09.500

无复制和无内部循环：

```
function startsWith(string $string, string $start): bool
{
    return strrpos($string, $start, - strlen($string)) !== false;
}

function endsWith(string $string, string $end): bool
{
    return ($offset = strlen($string) - strlen($end)) >= 0 
    && strpos($string, $end, $offset) !== false;
} 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2010-12-22T14:40:13.150

您还可以使用正则表达式：

```
function endsWith($haystack, $needle, $case=true) {
  return preg_match("/.*{$needle}$/" . (($case) ? "" : "i"), $haystack);
} 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2011-04-19T05:05:02.267

这是 PHP 4 的有效解决方案。如果在 PHP 5 上使用`substr_compare`而不是`strcasecmp(substr(...))`.

```
function stringBeginsWith($haystack, $beginning, $caseInsensitivity = false)
{
    if ($caseInsensitivity)
        return strncasecmp($haystack, $beginning, strlen($beginning)) === 0;
    else
        return strncmp($haystack, $beginning, strlen($beginning)) === 0;
}

function stringEndsWith($haystack, $ending, $caseInsensitivity = false)
{
    if ($caseInsensitivity)
        return strcasecmp(substr($haystack, strlen($haystack) - strlen($ending)), $haystack) === 0;
    else
        return strpos($haystack, $ending, strlen($haystack) - strlen($ending)) !== false;
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-04-03T14:58:57.397

您可以为此使用[fnmatch](https://www.php.net/manual/en/function.fnmatch.php)函数。

```
// Starts with.
fnmatch('prefix*', $haystack);
// Ends with.
fnmatch('*suffix', $haystack); 
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2015-08-25T17:31:17.257

```
$ends_with = strrchr($text, '.'); // Ends with dot
$start_with = (0 === strpos($text, '.')); // Starts with dot 
```

# path - 无法理解根目录下的基本路径

> ID：834308
> 
> 赞同：0
> 
> 时间：2009-05-07T12:16:04.740
> 
> 标签：path

我试图整理我的 Mac 数据。我的根目录中有许多 rc 文件，例如 .vimrc、.srceenrc 和 .bashrc。

我想将这些文件放到特定文件夹中，例如 .vimrc 和 .screenrc 到 ~/bin/coding 和 .bashrc，然后再放到 ~/bin/shells。

**您如何确定这些 rc 文件必须在哪里？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T12:21:01.433

说真的，你应该把它们留在原地。应用程序将在特定位置查找它们（顺便说一下，可能是您的 $HOME 目录*不是*根目录，或者不应该是根目录）。这是一个非常古老的 UNIX 约定，只有在您完全理解其后果时才应该尝试更改它。

听起来没有居高临下的意思，但是您将主目录命名为根目录的错误似乎表明您对这一切如何运作的知识水平低于理解这些后果的水平（如果冒犯了您，我深表歉意，我为最好的怎么说呢——我的意思是你应该小心行事）。

如果您移动它们，则必须确保运行使用它们的应用程序并完全指定其路径，并且某些应用程序可能不允许您这样做。

它们都`"."`以对普通`ls`命令隐藏的方式开始，如果您使用的是图形文件浏览器，那么也应该有一种方法可以将它们隐藏在那里（例如 Gnome 文件管理器`CTRL-H`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T12:27:39.813

程序的配置是在系统级和用户级定义的，您可以调整驻留在家中的用户级配置，以帮助您满足您的需求。

无需像您所说的那样将它们分组到子文件夹中：将它们留在家中（而不是 root）遵循每个人都使用的约定，rc-files 通常在程序被卸载后保留在那里，所以如果有一天你重新安装你'将找到您离开时配置的应用程序。

此外，通过将它们留在家中，您可以将自己的主文件夹带到另一个系统并根据需要设置环境。

# ms-access - 对齐 microsoft access 查询

> ID：834309
> 
> 赞同：1
> 
> 时间：2009-05-07T12:16:13.350
> 
> 标签：ms-access

每次我必须从控件的 [记录源] 属性中复制来自 MSAccess 的查询并粘贴到记事本中以对齐它，以便我可以阅读它。

我曾经使用 Ctrl+R 将逗号替换为换行符，但现在忘记了换行符是什么。你以前用过这个，如果是这样，我怎样才能得到换行符？

更好的是，是否有一个工具可以从 MSAccess 或任何 Microsoft 数据库工具中自动对齐 SQL。

干杯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T12:22:58.887

此在线服务“漂亮”为您格式化 SQL[漂亮的 SQL 格式化程序](http://www.dpriver.com/pp/sqlformat.htm)，或者您可以尝试使用[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)替换记事本；这包括搜索和替换“扩展”字符并用换行符替换它们的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-07T21:55:57.737

在我的[AccdbMerge](https://www.db-merge-tools.net/microsoft-access-diff-merge-overview.html)工具中，有一个函数“Indent SQL text”，它对最常见的查询类型执行此技巧。即使这是一个 diff&merge 工具，即使您只打开一个文件，此功能也可以使用，并且它在免费版本中可用。

# php - PHP ltrim() 和 rtrim() 函数

> ID：834311
> 
> 赞同：1
> 
> 时间：2009-05-07T12:16:39.870
> 
> 标签：php, string

我需要两个函数，它们接受一个字符串和从左右两侧修剪并返回的字符数。例如：

```
$str = "[test]";
$str = ltrim($str, 1); // Becomes 'test]'
$str = rtrim($str, 1); // Becomes 'test' 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T12:21:59.933

```
function my_rtrim($str, $count) {
  return substr($str, 0, -$count);
}

function my_ltrim($str, $count) {
  return substr($str, $count);
} 
```

见[substr()](http://www.php.net/manual/en/function.substr.php)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-07T12:23:02.880

[`substr`](http://php.net/substr)：

```
substr("abcdef", 0, -1);     // 'abcde'
substr("abcdef", 1);         // 'bcdef' 
```

但这不是函数通常工作`ltrim`的方式。`rtrim`它们使用子字符串而不是索引进行操作。

而且很明显

```
substr('abcdef', 1, -1) 
```

一口气做你想做的事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T12:28:03.697

我相信[substr()](http://ch.php.net/manual/en/function.substr.php)可以完成这项工作。$start 和 $length 参数都可以是负数。

# c++ - 我应该在基类中声明所有虚拟函数吗？

> ID：834314
> 
> 赞同：11
> 
> 时间：2009-05-07T12:17:00.290
> 
> 标签：c++

当我声明一个基类时，我应该将其中的所有函数声明为虚拟函数，还是应该有一组虚拟函数和一组我确定不会被继承的非虚拟函数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T12:26:08.833

仅当派生类将以不同的方式实现该函数时，函数才需要是虚拟的。

例如：

```
class Base {
public:
  void setI (int i)  // No need for it to be virtual
  {
    m_i = i;
  }

  virtual ~Base () {}         // Almost always a good idea

  virtual bool isDerived1 ()  // Is overridden - so make it virtual
  {
    return false;
  }

private:
  int m_i;
};

class Derived1 : public Base {
public:
  virtual ~Derived () {}

  virtual bool isDerived1 ()  // Is overridden - so make it virtual
  {
    return true;
  }
}; 
```

因此，除非您事先知道您打算覆盖它或直到您发现您需要该行为，否则我会错误地认为没有任何虚拟内容。唯一的例外是析构函数，在这种情况下，您*几乎*总是希望它在基类中是虚拟的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T13:11:08.740

您应该只使您打算和设计的功能被覆盖为虚拟的。使方法虚拟化在维护和性能方面都不是免费的（维护是更大的问题恕我直言）。

一旦方法是虚拟的，就很难推理任何使用该方法的代码。因为不是考虑一个方法调用会做什么，而是必须考虑 N 个方法调用在那种情况下会做什么。N 表示覆盖该方法的子类的数量。

该规则的一个例外是析构函数。它们在任何打算派生的类中都应该是虚拟的。这是保证在释放期间调用正确的析构函数的唯一方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-07T14:02:53.983

非虚拟接口习惯用法（C++ 编码标准第 39 条）说基类应该具有非虚拟接口方法，允许基类保证不变量，以及用于通过派生类自定义基类行为的非公共虚拟方法. 非虚拟接口方法调用虚拟方法来提供可覆盖的行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T12:19:59.330

我倾向于只把我想要的东西变成虚拟的。如果我最初对要覆盖的内容的假设是错误的，我会返回并更改基类。

哦，如果您正在处理将继承的东西，显然总是让您的析构函数虚拟化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T12:24:42.143

如果您正在创建一个基类（您确定有人派生了该类），那么您可以执行以下操作：

*   使析构函数虚拟（基类必须）
*   定义应该派生的方法并使它们成为虚拟的。
*   定义不需要（或不应该）派生为非虚拟的方法。
*   如果函数仅适用于派生类而不适用于基类，则将它们标记为受保护。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T12:49:50.587

当基类型的指针调用虚函数时，编译器不知道将运行哪段实际代码。所以实际运行的代码需要在运行时根据基类指针指向的对象进行评估。因此，如果函数不会在继承的类中被覆盖，请避免使用虚函数。

TLDR 版本：“你应该有一组虚函数和一组你确定不会被继承的非虚函数。” 因为虚函数会导致运行时性能下降。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T12:18:49.490

一般来说，接口功能应该是虚拟的。提供固定功能的函数不应该。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-07T12:24:30.663

为什么要声明一些虚拟的东西，直到你真正覆盖它？我相信这不是确定与否的问题。遵循事实：它是否在某处被覆盖？不？那么它一定不是虚拟的。

# javascript - 如何将大型 UTF-8 字符串转换为 ASCII？

> ID：834316
> 
> 赞同：4
> 
> 时间：2009-05-07T12:17:20.320
> 
> 标签：javascript, utf-8, character-encoding, ascii

我需要将大型 UTF-8 字符串转换为 ASCII。它应该是可逆的，理想情况下是一种快速/轻量级的算法。

我怎样才能做到这一点？我需要**源**代码（使用循环）或**JavaScript**代码。（不应依赖于任何平台/框架/库）

**编辑：**我知道 ASCII 表示看起来不正确并且会比它的 UTF-8 对应物更大（就字节而言），因为它是 UTF-8 原始的编码形式。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T13:02:21.710

您可以使用 Douglas Crockford 的 json2.js 引用函数的纯 ASCII 版本。看起来像这样：

```
 var escapable = /[\\\"\x00-\x1f\x7f-\uffff]/g,
        meta = {    // table of character substitutions
            '\b': '\\b',
            '\t': '\\t',
            '\n': '\\n',
            '\f': '\\f',
            '\r': '\\r',
            '"' : '\\"',
            '\\': '\\\\'
        };

    function quote(string) {

// If the string contains no control characters, no quote characters, and no
// backslash characters, then we can safely slap some quotes around it.
// Otherwise we must also replace the offending characters with safe escape
// sequences.

        escapable.lastIndex = 0;
        return escapable.test(string) ?
            '"' + string.replace(escapable, function (a) {
                var c = meta[a];
                return typeof c === 'string' ? c :
                    '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
            }) + '"' :
            '"' + string + '"';
    } 
```

这将生成一个有效的纯 ASCII、javascript 引用的输入字符串

例如`quote("Doppelgänger!")`将是“Doppelg\u00e4nger！”

要恢复编码，您可以评估结果

```
var encoded = quote("Doppelgänger!");
var back = JSON.parse(encoded); // eval(encoded); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-07T12:20:53.073

任何可逆转换为 ASCII 的 UTF-8 字符串已经是 ASCII。

UTF-8 可以表示任何 unicode 字符 - ASCII 不能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-07T12:31:42.267

正如其他人所说，您无法在不删除数据的情况下将 UTF-8 text/plain 转换为 ASCII text/plain。

您可以将 UTF-8 文本/纯文本转换为 ASCII 其他/格式。例如，HTML 允许使用[字符引用](http://www.w3.org/TR/html4/intro/sgmltut.html#h-3.2.3)在 ASCII 数据文件中表示 UTF-8 中的任何字符。

如果我们继续这个例子，在 JavaScript 中，[charCodeAt](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/String/charCodeAt)可以帮助使用 HTML 字符引用将字符串转换为它的表示。

[URLs](https://www.rfc-editor.org/rfc/rfc1738#section-2.2)采用另一种方法，并在 JS 中作为[encodeURIComponent](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Functions/encodeURIComponent)实现。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T13:11:07.460

你的要求很奇怪。

将 UTF-8 转换为 ASCII 会丢失有关 Unicode 代码点 > 127 的所有信息（即所有不属于 ASCII 的信息）。

[但是，您可以尝试以 ASCII 兼容的编码（例如UTF-7](http://en.wikipedia.org/wiki/UTF-7)）对您的 Unicode 数据（无论何种源编码）进行编码。这意味着生成的数据可以合法地解释为 ASCII，但它实际上是 UTF-7。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-07T12:43:26.887

如果字符串被编码为 UTF-8，那么它就不再是字符串了。它是二进制数据，如果要将二进制数据表示为 ASCII，则必须将其格式化为可以使用有限的 ASCII 字符集表示的字符串。

一种方法是使用 base-64 编码（C# 中的示例）：

```
string original = "asdf";
// encode the string into UTF-8 data:
byte[] encodedUtf8 = Encoding.UTF8.GetBytes(original);
// format the data into base-64:
string base64 = Convert.ToBase64String(encodedUtf8); 
```

如果要将字符串编码为 ASCII 数据：

```
// encode the base-64 string into ASCII data:
byte[] encodedAscii = Encoding.ASCII.GetBytes(base64); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-23T13:38:40.903

**将**UTF-8 字符串转换为 ASCII 是不可能的，但可以将Unicode**编码**为与 ASCII 兼容的字符串。

可能您想使用[Punycode](http://en.wikipedia.org/wiki/Punycode) - 这已经是一种标准的 Unicode 编码，可以将所有 Unicode 字符编码为 ASCII。对于 JavaScript 代码检查这个[问题](https://stackoverflow.com/questions/183485/can-anyone-recommend-a-good-free-javascript-for-punycode-to-unicode-conversion)

请编辑您的问题标题和描述，以防止其他人对其投反对票 - 不要使用术语转换，使用编码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T13:14:27.220

您想去除所有非 ascii 字符（斜线将它们替换为“？”等）还是将 Unicode 代码点存储在非 Unicode 系统中？

首先可以在循环中检查大于 128 的值并替换它们。

如果您不想使用“任何平台/框架/库”，那么您将需要编写自己的编码器。否则我只会使用 JQuery 的 .html();

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-23T13:35:32.430

这是将 UTF8 重音转换为 ASCII 重音（àéèî 等）的函数是 ASCII 字符。

我在 javascript 软件中使用它来将数据发送到以 ASCII 码工作的微控制器。

```
convertUtf8ToAscii = function (str) {
    var asciiStr = "";
    var refTable = { // Reference table Unicode vs ASCII
        199: 128, 252: 129, 233: 130, 226: 131, 228: 132, 224: 133, 231: 135, 234: 136, 235: 137, 232: 138,
        239: 139, 238: 140, 236: 141, 196: 142, 201: 144, 244: 147, 246: 148, 242: 149, 251: 150, 249: 151
    };
    for(var i = 0; i < str.length; i++){
        var ascii = refTable[str.charCodeAt(i)];
        if (ascii != undefined)
            asciiStr += "%" +ascii;
        else
            asciiStr += str[i];
    }
    return asciiStr;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-17T21:55:45.340

```
function utf8ToAscii(str) {
    /**
     * ASCII contains 127 characters.
     * 
     * In JavaScript, strings is encoded by UTF-16, it means that
     * js cannot present strings which charCode greater than 2^16\. Eg:
     * `String.fromCharCode(0) === String.fromCharCode(2**16)`
     *
     * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMString/Binary
     */
    const reg = /[\x7f-\uffff]/g; // charCode: [127, 65535]
    const replacer = (s) => {
        const charCode = s.charCodeAt(0);
        const unicode = charCode.toString(16).padStart(4, '0');
        return `\\u${unicode}`;
    };

    return str.replace(reg, replacer);
} 
```

## 更好的方法

参见[Uint8Array to string in Javascript](https://stackoverflow.com/questions/8936984/uint8array-to-string-in-javascript)也。您可以使用`TextEncoder`和`Uint8Array`：

```
function utf8ToAscii(str) {
    const enc = new TextEncoder('utf-8');
    const u8s = enc.encode(str);

    return Array.from(u8s).map(v => String.fromCharCode(v)).join('');
}
// For ascii to string
// new TextDecoder().decode(new Uint8Array(str.split('').map(v=>v.charCodeAt(0)))) 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-07T13:10:14.187

该`quote()`功能的实现可能会做你想做的事。我的版本[可以在这里找到](https://bitbucket.org/cggaertner/js-hacks/raw/master/quote.js)

您可以使用`eval()`反转编码：

```
var foo = 'Hägar';
var quotedFoo = quote(foo);
var unquotedFoo = eval(quotedFoo);
alert(foo === unquotedFoo); 
```

# c# - .net 页面事件触发顺序更改

> ID：834319
> 
> 赞同：0
> 
> 时间：2009-05-07T12:17:45.670
> 
> 标签：c#, .net, controls, postback, custom-server-controls

好的，这是一个非常烦人的错误，我整个早上都遇到了问题！

我有一个自定义控件，我们在许多项目中都使用了该控件，该控件具有由调用页面 onload 设置并存储在 Viewstate 中的属性。该控件使用自定义控件的 CreateChildControls() 方法上的属性设置子控件。

通常像往常一样在回发时触发 Page_Load 事件，然后触发页面上控件的 CreateChildControls 方法。

奇怪的是，我们在网站上有一个登录系统（自定义成员资格提供程序），当用户登录时，相反的情况首先会触发 CreateChildControls() 方法，然后触发 Page_Load，因此控件属性是错误的（从之前的回发中设置） )

事件如何以不同的顺序触发？我认为无论如何所有页面事件都以相同的顺序发生，而且我看不到登录会如何改变该顺序。

**更新：**似乎问题是我没有调用 EnsureChildControls() 但我不确定应该在哪里调用它？如果在用于设置子控件的控件上设置了多个属性，我应该何时调用 EnsureChildControls()，我想我不完全理解 EnsureChildControls() 的作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T12:29:31.600

每当 ASP.NET 页面需要它们时，就会调用 CreateChildControls。在页面周期中没有特定的点。它可以发生在 Init 事件中，也可以发生在 Load 事件中。如果要确保子控件可用，请调用控件的 EnsureChildControls() 方法。您可以在控件的 Init 事件中执行此操作，以确保您在整个生命周期中都有子控件，或者您可以在需要引用其中一个子控件时执行此操作 - 例如，在控件属性的 getter/setter 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T15:28:23.467

在创建需要访问包含的子控件的服务器/用户控件的属性时，我使用以下内容：

```
public Whatever SomeProperty
{

    get
    {
        EnsureChildControls();
        <more code here>
    }
    set
    {
        EnsureChildControls();
        <more code here>
    }
} 
```

这确保您的控件使用者可以在页面生命周期的各个阶段自由地使用您的控件。

# visual-c++ - 如何在 MFC 中将按钮标题设为粗体？

> ID：834320
> 
> 赞同：1
> 
> 时间：2009-05-07T12:17:46.870
> 
> 标签：visual-c++, mfc

我在 MFC 对话框上有一个按钮。如何使文本加粗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-07T12:37:54.390

```
class CYourDialog : CDialog
{
public:
   virtual BOOL OnInitDialog(); // override

private:
   CButton m_button;
   CFont m_font;
};

BOOL CYourDialog::OnInitDialog()
{
      __super::OnInitDialog();

      CFont* font = m_button.GetFont();

      LOGFONT logFont;
      font->GetLogFont(&logFont);
      logFont.lfWeight = FW_BOLD;

      m_font.CreateFontIndirect(&logFont);
      m_button.SetFont(&m_font);

      return TRUE;  // => system will set input focus to the first control item in the dialog box; (0 => you set the focus to a control of your choice)
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T12:30:34.830

您可以创建一个新的 CFont 并在按钮上调用 WM_SETFONT。像这样的东西：

```
// note: m_font is a class variable of type CFont
m_font.CreateFont(10, 0, 0, 0, FW_BOLD, 0, 0, 0, 0, 0, 0, 0, 0, "Arial")
GetDlgItem(IDC_BUTTON1)->SendMessage(WM_SETFONT, WPARAM(HFONT(font)), 0); 
```

# apache-flex - Flex - nativeApplication.icon 如何工作？

> ID：834326
> 
> 赞同：0
> 
> 时间：2009-05-07T12:19:36.993
> 
> 标签：apache-flex, actionscript-3, air, flash

```
NativeApplication.nativeApplication.icon.bitmaps = bitmapData(); 
```

我正在尝试编辑系统托盘图标的位图，但出现错误：

> 将 flash.display:BitmapData 类型的值隐式强制转换为不相关的 Array 类型。

我犯了什么错误，或者你能告诉我这个错误的含义吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T12:42:48.107

[Icon.bitmaps](http://livedocs.adobe.com/flex/3/langref/flash/desktop/Icon.html#bitmaps)是一个 BitmapData 数组，每个大小都有一个 BitmapData 实例。您必须重新分配整个数组：

```
NativeApplication.nativeApplication.icon.bitmaps = new Array(bitmapData); 
```

或者，正如 livedocs 所提到的，您可以指定所有位图大小：

```
NativeApplication.nativeApplication.icon.bitmaps = 
    new Array(icon16x16.bitmapData, icon128x128.bitmapData); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T12:33:44.523

我认为您需要在那里进行类型转换，例如：

SystemTrayIcon(NativeApplication.nativeApplication.icon).bitmaps

我相信 SystemTrayIcon 是一个特定于 Windows 的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T19:02:20.907

这是 Adob​​e 对此主题的讨论：

[http://livedocs.adobe.com/flex/3/html/help.html?content=taskbar_1.html](http://livedocs.adobe.com/flex/3/html/help.html?content=taskbar_1.html)

# sql-server - SQL Server 2008 Reporting Service 2008 导出到 Excel 时未设置页边距

> ID：834327
> 
> 赞同：0
> 
> 时间：2009-05-07T12:19:42.890
> 
> 标签：sql-server, reporting-services

`Report Properties`使用新的 SQL Server 2008 Reporting Service 时，我在>中指定的页边距`Page Setup`在导出时似乎没有流入 Excel？无论我在报告中将它们设置为什么，
它们似乎总是设置为`Top & Bottom: 2.5cm`, 。`Left & Right: 1.9cm`

这在 2005 版本中运行良好。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:36:23.857

验证您是否还设置了 Interactive Size 属性以匹配您在上面提供的值。

希望这可以帮助，

账单

# java - 你如何坚持一个tomcat会话？

> ID：834330
> 
> 赞同：4
> 
> 时间：2009-05-07T12:20:15.977
> 
> 标签：java, tomcat

我有一个每 1 分钟刷新一次的 JSP 网页。每次刷新时，都会检查会话对象的有效性。当 tomcat web 服务器重新启动时，会话消失......当页面刷新时，它显示“无效”。有人可以解决我的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T12:31:27.853

查看 Tomcat 配置文件中的配置。该文档位于[http://tomcat.apache.org/tomcat-6.0-doc/config/manager.html](http://tomcat.apache.org/tomcat-6.0-doc/config/manager.html)查找关于持久管理器的部分...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T12:39:40.640

您必须确保您在 Session 中存储的所有对象都是可序列化的。如果其中之一不是（或不满足可序列化的要求），您将失去在 web 应用程序重新加载或 tomcat 重新启动时的会话。

EG：以下对 Servlet 有效：

```
public class MainServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException
    {
        HttpSession session = request.getSession();
        Date date = (Date) session.getAttribute("date");
        if (date == null) {
                date = new Date();
                session.setAttribute("date", date);
        }
        response.setContentType("text/plain");
        PrintWriter pw = response.getWriter();
        pw.println("New Session? " + session.isNew());
        pw.println("Date : " + date);
        pw.flush();
    }

} 
```

# c# - 访问客户端添加的列表框项目

> ID：834339
> 
> 赞同：3
> 
> 时间：2009-05-07T12:21:39.093
> 
> 标签：c#, asp.net

1.  我有一个带有 runat=server 的列表框
    2.  使用 javascript 将项目添加到客户端的此列表框中
    3.  我想通过单击按钮来检索服务器端的项目

问题出在按钮的服务器端单击处理程序中，我看不到添加到列表框中的新项目。仅显示 page_load 上的项目。我如何完成我想做的事

# 编辑 1

我的代码是这样的

```
 protected void Page_Load(object sender, EventArgs e)
    {

        if (!IsPostBack)
        {
            if (ViewState["gameID"] == null)
            {
                //Populate Listbox
                //Set gameid in viewstate
            }

            //Add javascript handlers to buttons
            btnSomeButton.Attributes.Add("onclick", "aJavaScriptFunction"); 

        }
    }
    protected void btnSave_Click(object sender, EventArgs e)
    {
        ListItemCollection x = ListBoxRanks.Items;
        //Here items is has just those items that are added to the listbox on page load

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T12:47:28.143

啊当抽象韭菜:)

Web 服务器控件在发送响应之前被序列化以查看状态，在回发时重新创建控件，并且所有选项都从视图状态中恢复。

当您在客户端添加选项项时，它们不会添加到视图状态。唯一的方法是使用您自己的隐藏字段来序列化客户端添加并在回发或ajax服务器端读取它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T12:23:02.007

`Page.IsPostBack`仅在is时才绑定到 ListBox `false`。这将允许您查看在客户端添加的任何项目。

如果您在每次加载时都绑定到控件，则您正在从请求中清除 ASP.NET 加载的任何现有项。通过仅在回发未触发当前页面加载时进行绑定，您将允许加载请求中的所有项目，包括在客户端添加的任何项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T13:02:37.467

您应该使用 ajax 将项目添加到下拉列表中。它将确保您的视图状态与服务器端下拉控件同步。

# applescript - 如何在查找器中检索所选项目的服务器路径

> ID：834343
> 
> 赞同：1
> 
> 时间：2009-05-07T12:22:28.500
> 
> 标签：applescript

有没有办法用applescript在finder中检索所选项目的服务器路径名？

我已经尝试了属性 URL 和 POSIX 路径，但它们只是指向本地文件系统而不是服务器路径，例如：smb://server/folder1/folder2/filename

到目前为止的代码：

```
tell application "Finder"
    set selectedItem to the selection as alias
    URL of selectedItem --ouput: file://localhost/Volumes/server/folder1/folder2/filename
    POSIX path of selectedItem --output: /Volumes/server/folder1/folder2/filename
end tell 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-17T11:56:44.040

I think this has to do with the way directories work in OS X (and every *nix). AFAIK there are no UNC style paths on a mac. So the only workaround is to make a database of the available windows shares, look up the name of the volume of the file and spit out a 'file://some/server/path' style URL based on that.

At least that's what I did when I had the same problem. Note that smb:// urls won't work for most web apps.

[this](http://discussions.apple.com/message.jspa?messageID=4426253) and [this](http://forums.macnn.com/90/mac-os-x/212081/mac-to-mac-equivalent-unc-path/) shed some light on to it.

# ruby-on-rails - ActiveRecord：删除关联记录

> ID：834346
> 
> 赞同：6
> 
> 时间：2009-05-07T12:22:50.103
> 
> 标签：ruby-on-rails, activerecord

我没有得到的东西......

我的模型中有这个：

```
class Model < ActiveRecord::Base
    has_many :model_options # a link table for many to many
    has_many :options, 
             :through => :model_options, 
             :dependent => :destroy, 
             :foreign_key => 'model_id'
end 
```

我尝试这样做：

```
model = Model.find(id)
model.options.delete # also tried model.options.delete_all 
```

但这不是从数据库中删除记录。相反，我必须这样做：

```
model.options.each do |option|
   option.delete
end 
```

...这不是最好的方法。
那么，请问最好的方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-07T12:34:27.080

```
model.options.clear 
```

[参考](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#M001789)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T13:57:24.993

加里是对的：model.options.clear

但是，如果它符合您的需要，您可以更进一步并将其与模型回调相关联

```
class Model < ActiveRecord::Base
has_many :model_options # a link table for many to many
has_many :options, 
         :through => :model_options, 
         :dependent => :destroy, 
         :foreign_key => 'model_id'

# Clear options records before destroy
before_destroy :clear_options

protected
  def clear_options
    options.clear
  end
end 
```

或者，您可以使用[此插件](http://agilewebdevelopment.com/plugins/foreign_key_migrations)从数据库中强制执行 FK 关系，适当地添加数据库触发器（如果您的特定数据库风格支持它们）。

我希望这可以帮助你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-02T23:11:13.383

在 Rails 3 中，您所要做的就是`:dependent => :destroy`ActiveRecord 会处理剩下的事情

# c++ - VS2008 Express 版本和资源

> ID：834347
> 
> 赞同：0
> 
> 时间：2009-05-07T12:22:54.737
> 
> 标签：c++, visual-studio, resources

我想在 VC++ 2008 EE 中将资源（例如图标）添加到基于 WinAPI 的程序中，并且正在苦苦挣扎。由于IDE没有捆绑资源编辑器，这可能吗？

我的 Google 搜索似乎都与 C# 或其他托管环境有关。

谢谢大家，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:04:49.363

恐怕速成版没有资源编辑器。（编辑）我在官方网站上找不到特征矩阵，但[维基百科](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio_Express#Visual_C.2B.2B_Express)这么说，所以一定是对的；-)

您可以查看 3rd 方工具 - 快速的网络搜索将[ResEdit](http://www.resedit.net/)作为可能的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:26:48.297

曾经有一个矩阵会明确指出 EE 没有这样的功能，但我也找不到它了。

不幸的是，您无法使用 Visual Studio 2008 EE 以图形方式编辑 *.rc 文件。只有“标准版”及更高版本捆绑了本机资源编辑器。使用 Express Edition，您只能通过 WYSIWYG 编辑 Windows 窗体。

正如 Steve Haigh 所说，您可以使用 ResEdit 或任何其他文本编辑器构建这样的文件，然后将这个生成/写入的文件添加到您的项目中。VC2008EE 将能够编译 *.rc 文件，尽管缺少图形编辑器。

# database - 监控摄像头位置数据库

> ID：834352
> 
> 赞同：5
> 
> 时间：2009-05-07T12:23:13.910
> 
> 标签：database, geolocation, artificial-intelligence, machine-learning, surveillance

为了更多地了解 django 编程，我计划创建一个 google maps mashup，它可以找到从 A 到 B 的路线，但会避开穿过公共监控摄像头视角的街道/路口。因此，我将创建一个数据库（可能基于 Postgres，因为它的 GIS 功能）包含

*   监控类型（监控摄像头、测速摄像头、路费摄像头等）
*   地理位置
*   超时（主要用于测速相机）

然后，这些数据当然可以由用户自由编辑。但是，首先，我需要一些数据才能开始运行。是否有任何此类公开可用的数据库包含（可能是近似的）监控摄像机的地理位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-25T17:32:12.600

在[openstreetmap](http://www.openstreetmap.org/)中是由 openstreetmap 社区的用户映射的监控摄像头。此地图并不详尽，但将涵盖其他数据库中没有的相机。我不知道 API 在获取此相机的位置等方面有多好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T12:35:35.270

英国有一个测速相机数据库：

[http://www.speedcamerasuk.com/locationsdatabase.htm](http://www.speedcamerasuk.com/locationsdatabase.htm)

每个委员会都提供闭路电视摄像机的位置，谷歌搜索应该会找到它们：

[http://www.google.co.uk/search?hl=en&q=cctv+camera+location&btnG=Search&meta=cr%3DcountryUK|countryGB](http://www.google.co.uk/search?hl=en&q=cctv+camera+location&btnG=Search&meta=cr%3DcountryUK|countryGB)

尽管它们通常按街道名称列出，而不是正确的地理位置

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-17T19:48:33.463

您可以使用 OpenStreetMap 来映射闭路电视监控摄像机： [http ://wiki.openstreetmap.org/wiki/Tag:man_made%3Dsurveillance](http://wiki.openstreetmap.org/wiki/Tag:man_made%3Dsurveillance)

添加它们后，闭路电视摄像机将在此地图上可见：http: [//osmcamera.tk/](http://osmcamera.tk/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T02:54:41.993

你对位置有什么偏好吗？ [http://www.mediaeater.com/cameras/](http://www.mediaeater.com/cameras/)有纽约市的相机列表；尽管它们列出了文本位置而不是纬度/经度坐标，但它们确实发布了 PDF 地图，因此如果您问得好，这些数据可能是可用的。

# c# - 移动（重绘）表单后按钮上的动画 gif 停止

> ID：834353
> 
> 赞同：2
> 
> 时间：2009-05-07T12:23:42.490
> 
> 标签：c#, winforms, gif, animated-gif

我在按钮上放置了一个动画 gif。它的动画效果很好（大多数时候：P），但是当窗口被重绘（重绘）时，动画停止了。我在处理 Paint 事件时尝试刷新按钮 (button.Refresh() )，但它没有解决问题。\

任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-02T13:15:20.197

也许我错了，但我认为问题在于它不是在重绘表单时停止动画，而是当动画对象被另一个窗口遮挡时。这是预期的行为；错误在于，在 Windows Vista 和 Windows 7 中，显示是合成的，因此即使窗口被“遮挡”，它也从未真正被遮挡，并且在未遮挡时它永远不会收到绘制消息，这将重新启动动画。

此错误似乎会影响任何带有动画对象的 ButtonBase 派生控件。

问题在于 Control.IsWindowObcured 函数。它将返回 true。您可以在 ButtonBase.cs 文件的 System.Windows.Forms.ButtonBase.OnFrameChanged 中看到，最后有一行代码显示：

```
if (IsWindowObscured) {
 StopAnimate();
 return;
} 
```

这就是问题所在。

仅供参考，从 ImageAnimator 线程调用 OnFrameChanged。这是在 ImageAnimator.Animate(image, eventhandler) 中指定的回调。ButtonBase 在私有 void Animate(bool animate) 函数中设置它。ImageAnimator 线程每 50 毫秒轮询一次，并检查是否需要为它正在监视的任何图像添加新帧；如果是这样，它会设置一个标志以使控件无效并绘制新框架。

由于这是我们无法访问的，我认为我们对此无能为力。作为一种解决方法，我在我的表单中实现了一个计时器，该计时器每 500 毫秒使控件无效，因此如果之前已停止，它将强制它重新启动。我们无法覆盖甚至访问它，这很烦人。恐怕唯一的解决方案是上面的hack，或者创建或使用您自己或第三方创建的控件。

澄清一下——这只是使用桌面组合的 Windows Vista 或 Windows 7 上的问题。问题是窗口永远不会真正被遮挡，就像不使用桌面组合时一样。它们总是由窗口管理器缓冲。（Windows 2000+ 中有特殊的分层窗口，但暂时忽略它）。以前，如果窗口的某些部分不在屏幕上或被另一个窗口遮挡，则它们不可用。当它们重新出现时，通过改变焦点或位置等，系统将通知该区域重新绘制自己。但是，当使用桌面合成时，从不需要重新绘制，因为窗口的实际内容在其他地方缓冲。这就是为什么窗口预览在任务栏中工作的原因，例如 Flip-3d。副作用是，希望在被遮挡后再次可见时获得绘制消息的代码将失败。ButtonBase 代码希望在返回视图后收到一条绘制消息，这将再次启动动画。因此，这种优化成为了一个错误。

该问题应在 Microsoft Connect 中报告，但不太可能得到解决。

# c - 高效的网络服务器设计示例，用 C 编写

> ID：834375
> 
> 赞同：7
> 
> 时间：2009-05-07T12:28:41.447
> 
> 标签：c, linux, performance, multithreading, network-programming

我有兴趣学习如何编写极其高效的网络服务器软件，而且我不介意用指针、套接字和线程来弄脏我的手。我说的是能够处理数千个并发连接的服务器。每个客户端处理的不多，但是一点点。

**您知道真正高效的网络服务器的任何代码示例吗？**

可选地指向跨平台的小型、有据可查的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T12:37:07.137

[您会在 Dan Kegel 的C10K 问题](http://www.kegel.com/c10k.html)页面上找到很多关于构建高度可扩展的网络服务器的很好的参考资料和讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T20:14:02.550

看看一些流行的高性能 http 服务器的[nginx](http://nginx.net/)、[lighttpd](http://www.lighttpd.net)和[varnish 。](http://varnish.projects.linpro.no/)

顺便说一句，我目前正在将边缘触发的 epoll 与多线程（加上用户级交换上下文样式的线程/纤维）结合起来 - 请参阅[http://svn.cmeerw.net/src/nginetd/trunk/](http://svn.cmeerw.net/src/nginetd/trunk/)一些工作中的代码（虽然这个是用 C++ 编写的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T12:31:52.860

这可能不是您想要的，但我简要回忆了几年前看过 Space Tyrant 并认为它听起来很酷。

[http://librenix.com/?inode=6240](http://librenix.com/?inode=6240)

希望能帮助到你！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T12:35:07.033

读这个

[http://www.evanmiller.org/lxr/http/source/](http://www.evanmiller.org/lxr/http/source/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T12:48:53.553

ldap 服务器每秒处理大量事务

[http://de.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol](http://de.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-25T05:39:17.060

ACE 是一个明智的选择。

# c++ - throw-catch 导致联动错误

> ID：834378
> 
> 赞同：0
> 
> 时间：2009-05-07T12:29:57.497
> 
> 标签：c++, visual-studio-2008, templates, try-catch, linker-errors

我收到以下类型的链接错误：

> Festival.obj：错误LNK2019：函数__catch$中引用的未解析外部符号“public：void __thiscall Tree::add(class Price &)”(?add@?$Tree@VPrice@@@@QAEXAAVPrice@@@Z)？ AddBand@Festival@@QAE?AW4StatusType@@HHH@Z$0

我曾经认为它与 try-catch 机制有关，但后来被告知并非如此。这是问题的更新版本。

我正在使用 Visual Studio 2008，但我在 g++ 中有类似的问题。

相关代码：

在 Festival.cpp

```
#include "Tree.h"
#include <exception>

using namespace std;

class Band{
public:
    Band(int bandID, int price, int votes=0): bandID(bandID), price(price), votes(votes){};
...
private:
...

};

class Festival{
public: 
    Festival(int budget): budget(budget), minPrice(0), maxNeededBudget(0), priceOffset(0), bandCounter(0){};
    ~Festival();
    StatusType AddBand(int bandID, int price, int votes=0);
    ...

private: 
    Tree<Band> bandTree;
    ...

};

StatusType Festival::AddBand(int bandID, int price, int votes){
    if ((price<0)||(bandID<0)){
        return INVALID_INPUT;
    }
    Band* newBand=NULL;
    try{
        newBand=new Band(bandID,price-priceOffset,votes);
    }
    catch(bad_alloc&){return ALLOCATION_ERROR;}
    if (bandTree.find(*newBand)!=NULL){
        delete newBand;
        return FAILURE;
    }
bandTree.add(*newBand);
....
} 
```

在 Tree.h 中：

```
template<class T>
class Tree{
public:
    Tree(T* initialData=NULL, Tree<T>* initialFather=NULL);
    void add(T& newData);
....
private:
....
}; 
```

有趣的是，当类型 T 是像 int 这样的原始类型时，当我尝试使用 Tree 函数时，我没有出现链接错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T14:26:10.230

有 Tree.cpp 吗？如果有，也许你忘了链接它？Tree::add 的实现在哪里？此外，我看不到您在哪里调用 Tree::add。我想它应该在 try 语句中，就在 new 之后？

只是提醒：

对于大多数编译器（即那些进行单独编译的编译器），模板类的成员函数的实现必须在使用模板类的源文件的编译期间可见。通常人们通过将成员函数的实现放在头文件中来遵循此规则。

也许 Tree::add 不在标题内？那么在讨论的情况下，一个可能的解决方案是将 Tree::add 实现放在头文件中。

常规类和模板类之间存在差异，因为模板类不是“真正的”类——嗯，它是一个模板。如果您将 Tree 类定义为常规类，编译器可能会立即使用您的代码。在模板的情况下，编译器首先为您“编写”真正的类，用您提供的类型替换模板参数。现在，编译器将 cpp 文件一一编译。他不知道其他 cpp 文件，并且不能使用其他 cpp 文件中的任何内容。假设您的 Tree:add 实现如下所示：

```
void Tree::add(T& newData)
{
    newData.destroyEverything();
} 
```

只要你的 T 有方法 destroyEverything，它就是完全合法的。当编译器编译 Class.cpp 时，它想确保您不对 T 做任何它不知道的事情。例如`Tree<int>`不会工作，因为 int 没有destroyEverything。编译器将尝试使用 int 而不是 T 编写代码，并发现代码无法编译。但由于编译器只“看到”当前 cpp 及其包含的所有内容，因此它无法验证 add 函数，因为它位于单独的 cpp 中。

不会有任何问题

```
void Tree::add(int& newData)
{
    newData.destroyEverything();
} 
```

在单独的 cpp 中实现，因为编译器知道 int 是唯一可接受的类型，并且可以“依靠自己”，当他开始编译 Tree.cpp 时，他会发现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T12:37:10.163

您确定`try`/`catch`与它有什么关系吗？如果您简单地注释掉`try`和`catch`行，保留其余代码原样并构建它，会发生什么？

可能只是您缺少`Tree::add(class Price &)`从链接行定义的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T14:22:46.197

更新：使用原始类型的树函数不会导致链接错误。我根据所说的一些事情更新了我的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T14:42:05.060

您收到链接错误，而不是编译器错误。这告诉我们编译器知道函数`Tree::add()`是什么类型，但没有定义。在 Tree.h 中，我看到了 add() 函数的声明，但没有看到定义。我觉得这很奇怪；有人知道 Tree.h 来自哪里吗？

通常一个模板类在包含文件中带有成员函数定义，因为函数必须在某个地方实例化，最简单的事情是编译器在使用时实例化并让链接器对其进行排序。如果定义在 Tree.h 中，我希望一切都按计划进行。

因此，我将冒险并建议将定义放在单独的文件中，而不是链接到其中，并且在其他地方有用于实例化基本类型（如`Tree<int>`. 这大概是为了简化编译，因为通常这些东西是在多个地方编译的，这需要时间。

在这种情况下，您需要做的是找到`Tree<int>`实例化的位置，并为您的类添加实例化。

我在这里可能有点离谱，但我的解释确实符合你给出的事实。

**在第一条评论后编辑**：

模板比普通函数要复杂一些，这通常不是真正的问题。如果所有调用的定义都在 Tree.h 中，那么 Festival.cpp 将能够实例化`Tree<Band>`，一切都会很酷。这是通常的技术，你遇到这个问题是因为你没有使用它。

当你编写一个函数时，它会被编译，链接器会找到它。任何调用该函数的例程都需要知道函数原型，因此它将知道如何调用它。当您编写模板时，您不会编写任何直接进入程序的内容，但对模板的任何使用都算作编写所有函数。

因此，必须`Tree<Band>`在程序中的某个地方使用一些函数，才能`Tree<Band>::add()`编译出一个函数。的定义`Tree<T>::add`必须在实例化时对编译器可用`Tree<Band>`，否则编译器不知道要编译什么。在这种情况下，它正在生成函数调用，确信您将确保该函数在其他地方编译。

`Tree<Band>`因此，您必须在可以访问 和 的定义的文件中进行实例`Tree<T>`化`Band`。这可能意味着一个文件是或包含 Tree.cpp 并包含 Festival.h。

链接器已经在使用 Tree.cpp，但是 Tree.cpp 并没有在`Tree<Band>`其中定义，所以它对链接器来说毫无意义。模板仅对编译器有用，链接器仅对编译器从模板生成的内容进行操作。

解决这个问题的快速方法是从 Tree.cpp 中获取定义并将它们放入 Tree.h。不幸的是，这可能会增加编译和链接时间。另一种技术是在 Tree.cpp 中实例化所有使用的模板，以便在那里编译它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T14:50:44.977

正如其他人所说，您需要展示 Treee::add() 的实现并告诉我们您如何链接它。

在不相关的一点上，如果您使用的结构如下：

```
 Band* newBand=NULL;
    try{
        newBand=new Band(bandID,price-priceOffset,votes);
    }
    catch(bad_alloc&){return ALLOCATION_ERROR;} 
```

在您的整个代码中，坦率地说，您是在浪费时间。在现代操作系统中，您达到内存耗尽点的可能性很小，并且您在它发生后做任何有用的事情的可能性几乎为零。你最好简单地说：

```
Band * newBand = new Band ( bandID, price - priceOffset, votes ); 
```

不可能：

```
Band newBand( bandID, price - priceOffset, votes ); 
```

在这种情况下忘记了异常处理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T14:51:24.163

你在评论中写道：

> 我考虑过这一点，但该函数是 Tree.h 的一部分，我确实包含了它。定义的函数是：template void Tree::add(T& newData); 我们这样称呼它：priceTree.add(*newPriceNode); 而 priceTree 是 Tree，两者都在相关的 cpp 文件中定义。

代替：

```
priceTree.add(*newPriceNode); 
```

尝试：

```
priceTree.add(newPriceNode); //no "*" before "newPriceNode" 
```

add() 引用节点，而不是指向节点的指针（根据您对树的定义）。

# javascript - 使用 javascript 和 css 自定义下拉框

> ID：834380
> 
> 赞同：1
> 
> 时间：2009-05-07T12:30:21.320
> 
> 标签：javascript, html, css, dhtml, html-select

是否可以使用 javascriit 和 css 创建自定义下拉框。

为此，我需要使用 javascript 为下拉框放置背景图像

如果是或否？如果是 。给点建议？

不使用 JQuery

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T12:34:58.657

您可以查看[jQTransform](http://www.dfc-e.com/metiers/multimedia/opensource/jqtransform/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-01T00:56:33.110

[这是一个关于创建自定义下拉菜单](http://tympanus.net/codrops/2012/10/04/custom-drop-down-list-styling/)的好教程。

JQTransform（由 Olafur 建议）对我来说就足够了。但是如果您需要更多控制，例如添加图标，则值得查看教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T00:05:20.617

这可能有点矫枉过正。但是[SproutCore](http://www.sproutcore.com/)为您提供由图像而不是原生 HTML 元素组成的输入元素。可能还有其他框架可以做类似的事情。

正如 CrazyJugglerDrummer 建议的那样，基本思想是创建一个 div 或其他东西，并在其上放置点击处理程序。处理程序设置动画以模仿选择元素。当您的一个伪选择项被选中时，您使用 JavaScript 将该值发送到隐藏的实际选择或输入元素。

# c++ - C++11：一种新语言？

> ID：834383
> 
> 赞同：31
> 
> 时间：2009-05-07T12:31:15.030
> 
> 标签：c++, c++11

最近我开始阅读（只是一点点）未来 C++11 标准的[当前草案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2857.pdf)。

有很多新功能，其中一些已经通过 Boost Libs 提供。当然，我对这个新标准非常满意，我想尽快使用所有新功能。

无论如何，与一些朋友、长期 C++ 开发人员谈论这个草案时，出现了一些担忧。所以，我问你（回答他们）：

**1) 语言本身**

这个更新是巨大的，对于单个标准更新来说可能太大了。对于编译器供应商（即使他们中的大多数已经开始实现某些功能）以及最终用户来说都是巨大的。

特别是，我的一个朋友告诉我“*这是一种新语言*”。

*   我们可以在这次更新之后将它视为一种全新的语言吗？
*   您打算切换到新标准还是跟上“旧”标准？

**2) 语言知识**

*   新标准将如何影响学习曲线？
*   教语言会更难吗？
*   有些功能虽然非常棒，但对我来说似乎有点“学术”（我的意思是定义）。我错了吗？
*   掌握所有这些新增功能可能是一场噩梦，不是吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-07T15:16:21.093

简而言之，不，我们不能认为这是一种新语言。这是相同的语言，新功能。但是，如果您使用支持 0x 标准的编译器，它们现在将成为标准包含，而不是通过使用 Boost 库来固定。

*在*使用支持新标准的编译器时，不必使用新标准。但是，如果正在开发的软件存在某些限制，则必须学习和使用新标准，但这是任何软件努力的限制。我认为 0x 标准带来的新功能*将使*某些事情变得更容易，更不容易出错，因此了解新功能是什么以及它们将如何改进未来工作的设计策略对一个人来说是有利的。人们还必须学习它，以便在使用它开发的软件时，他们会了解正在发生的事情，而不是大吵大闹。

至于我是否会“*切换到新标准*”，如果这意味着我将学习新标准并在适用的地方使用它并提高我的生产力，那么是的，我当然打算*切换*。但是，如果这意味着我将*仅限*于使用 0x 标准的新功能，那么不，因为我的大部分工作都涉及在标准之前编写的代码，重新设计所有内容以使用新功能将是一项艰巨的任务特征。不仅如此，它还可能引入新的错误和性能问题，我没有经验就不会意识到这些问题。

学习 C++ 一直是程序员可以承担的更具挑战性的旅程之一。向语言添加新特性不会改变学习其语法以及如何有效使用它的难度，但方法会改变。人们仍将了解指针及其工作方式，但他们还将了解智能指针及其管理方式。在某些情况下，人们会以与以前不同的方式学习事物。例如，人们仍然需要学习如何初始化事物，但现在他们将学习统一初始化和初始化列表作为做事的主要方式。在某些情况下，通过为范围添加新的 for 语法或在函数声明中添加自动返回类型，可能会更容易理解事物。我认为总的来说，

掌握一门语言是一个长期的目标，不可能一蹴而就。认为一个人可以快速掌握像 C++ 这样复杂的东西是愚蠢的。需要实践、经验和调试代码才能真正做到。学术学习是一回事，但运用这些知识是完全不同的怪物。我认为如果一个人已经掌握了C++语言，新的概念不会造成太大的负担，但是一个新来的人可能有一个优势，他们不会费心去学习一些更过时的做事方式.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-07T12:55:26.640

**1) 语言本身**

据我所知，C++'03 和 C++'0x 之间确实没有重大变化。我在这里能想到的唯一一个与 `auto`用作存储类说明符有关，但由于它没有语义意义，我不认为这是一个问题。

该标准还有许多其他学术修复非常必要，例如对成员数据布局的更好描述。最后，随着多核/cpu 架构成为常态，修复内存模型是必须的。

**2) 语言知识**

就个人而言，我认为对于 99.9% 的 C++ 开发人员来说，新的语言会更容易使用。我特别考虑诸如 auto、lambda 和 constexpr 之类的功能。这些功能确实应该使使用该语言更加愉快。

在更高级的级别上，您还有其他功能，例如可变参数模板等，可以帮助更高级的用户。

但是这里并没有什么新鲜事，我仍然对没有使用（甚至听说过）STL 的日常 C++ 开发人员的数量感到惊讶。

从个人的角度来看，我在新标准中唯一有点担心的特征是概念。由于这是一个如此大的变化，模板出现的相同问题（即完全破坏的实现）是一个真正的危险。

**更新发布 FDIS 投票：**

碰巧的是，C++ 0x 放弃了“概念”，而 C++ 1x 将再次使用“概念”。最后，除了可能会破坏您的代码之外，还有*一些*更改`auto`可能会破坏您的代码，但实际上它们可能非常罕见。主要区别可在[FDIS (pdf)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3290.pdf)的附录 C.2 中找到。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-07T15:19:52.410

对我来说，最重要的一项将是：

**unique_ptr + std::move() ！**

想象：

1.  没有任何开销的智能指针：

    *   没有引用计数操作
    *   参考计数器变量没有额外的存储空间
2.  可以**移动**的智能指针，即。移动时没有析构函数/构造函数调用

这给了你什么？**异常安全，便宜（指针..）容器，无需任何成本**。容器将能够仅 memcpy() unique_ptrs，因此不会因智能指针包装常规指针而导致性能损失！所以，再一次：

1.  您可以使用指针
2.  这将是安全的（没有内存泄漏）
3.  它不会花费你任何东西
4.  您将能够将它们存储在容器中，并且它们将能够廉价地使用它们进行“大规模”移动（类似于 memcpy）。
5.  这将是异常安全的

:)

另一个角度来看：

1.  实际上，当您使用 copy() 移动一组对象时，每个对象实例都会调用构造函数和析构函数。当你复制 1000 个 1kb 大小的对象时，至少会有一个 memcpy() 和 2000 个函数调用。
2.  如果您想避免数千次调用，则必须使用指针。
3.  但是指针是：危险的，等等。实际的智能指针对你没有帮助，它们解决了其他问题。
4.  **目前没有解决方案。您必须不时为 C++ RAII/指针/值变量设计付费。但是对于 C++0x，使用 unique_ptr 将允许对对象（是的，实际上是对象，因为指针将是智能的）进行“大量”移动，而无需“大量”构造函数/析构函数调用，并且没有使用指针的风险！**对我来说，这真的很重要。

这就像放宽 RAII 概念（因为使用指针）而不会失去 RAII 的好处。另一方面：包裹在 unique_ptr() 中的指针在很多方面都会表现得类似于 java 引用对象变量。不同之处在于 unique_ptr() 一次只能存在于一个范围内。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-07T12:45:13.013

您的朋友部分正确，但大部分错误：它是具有额外功能的*相同语言。*

好消息是，您不必掌握所有新功能。标准机构的主要任务之一是不破坏现有代码，因此您将能够继续，愉快地以您的旧风格进行编码（即使我使用“C++”应用程序，我仍然主要是 C 编码器： -)。

只有当您想查看新功能时，您才需要了解这些更改。如果需要，这是一个可以延长数年的过程。

我的建议是从高层次上了解所有新功能（如果只是在工作面试中听起来知识渊博），但要慢慢学习细节。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-07T14:07:38.543

在某些方面，C++0x 应该比当前的 C++**更容易**教授/学习：

*   循环通过容器 - 新`for`语法比`for_each`+ functor 或使用迭代器手动循环容易得多
*   初始化容器：我们将能够使用与数组相同的语法来初始化序列
*   内存管理：out godgy old `auto_ptr`, in 定义`unique_ptr`明确`shared_ptr`

Lambdas 虽然必然比其他语言的等价物更复杂，但比 C++98 在不同范围内定义函数对象的过程更容易学习。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-07T13:18:43.230

*您打算切换到新标准还是跟上“旧”标准？*

一年前，我正在编写严格的 C89，因为所讨论的产品可以积极地移植到嵌入式平台上，其中一些编译器的编译器对于 C99 的哪些部分值得支持有着完全不同的想法。所以一个有 20 年历史的标准仍然没有被它 10 年的继任者完全取代。

所以我不指望能够很快摆脱 C++03。

我确实希望在适当的情况下使用 C++0x 功能。就像我在 C 代码中使用 C99 功能，在 C 和 C++ 中使用 gcc 扩展一样（并且会使用 MSVC 扩展，尽管我从来没有在微不足道的时间内处理过仅 MSVC 的代码）。但我希望它是“很高兴拥有”而不是基线，几乎无限期。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-05-24T08:14:24.023

你说得有道理，但情况一直如此。有很多 C++ 代码仍然没有包含 '98 标准中的任何内容，这仅仅是因为一些编码人员天生的保守主义。我们中的一些人还记得命名空间之前的一段黑暗时期`std::`（实际上是命名空间之前），当时每个人都编写了自己的字符串类，而指针一直光着身子走来走去。我们谈论“现代 C++ 风格”是有原因的——为了区别于早期的风格，因为有些人仍然需要维护或更新这种风格的代码。

任何语言都必须进化才能生存，任何进化的语言都会有一个分裂的用户群，这仅仅是因为人们在估计将新语言功能应用于自己的工作的机会成本方面的态度不同。

随着 C++0x 在编译器中的出现，这种对话将在世界各地的开发团队中一遍又一遍地进行：

年轻人：我刚刚发现了这些叫做 lambdas 的东西！而且我正在寻找很多方法来使用它们来使我们的代码更具表现力！看，我重写了你以前的 Foo 类，不是更整洁吗？

OLDSTER：我的旧 Foo 课程没有任何问题。您只是在寻找不必要地使用“酷”新功能的借口。为什么你一直试图让我的生活变得如此复杂？为什么我必须不断学习新事物？我们需要另一场战争，这就是我们需要的。

年轻人：你太固执己见了，老头，这些天我们甚至不应该使用 C++……如果由我决定的话——

OLDSTER：如果由我来决定，我们会坚持使用 PL/1，但不……我的妻子不得不投票给 Carter，现在我们被所有这些面向对象的废话所困。没有什么是你可以做的，`std::transform`而 lambdas 是我不能用一个`goto`和几个标签做的。

等等

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-05-07T13:18:56.413

您的编程生涯将始终涉及学习和再学习。您不能期望 c++ 在您退休之前保持不变，并且使用与 40 年前相同的方法和实践。技术不断发展，而且发展迅速。跟上它是你的工作。当然，您可以忽略这一点，并继续按照您现在的方式工作，但是在 5 到 10 年的时间里，您将变得如此过时，以至于当您尝试换工作时，您将被迫学习所有内容. 那些年以前在工作中学习会容易得多:)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-07T14:37:39.233

几个月前，我听到[Bjarne Stroustrup](http://www2.research.att.com/~bs/)发表了题为***50 years of C++***的演讲。诚然，我不是 C++ 程序员，但在我看来，他当然不认为 0x 是一门新语言！

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-07T13:52:42.697

无论我们是否可以将其视为“新语言”，我认为这是语义。这没什么区别。它向后兼容我们当前的 C++ 代码，而且它是一种更好的语言。我们是否认为它是“同一种语言”并不重要。

关于学习语言，请记住许多新功能使语言*更易于*学习和使用。大多数增加复杂性的功能仅适用于库开发人员。他们可以使用这些新功能来制作更好、更高效、更易于使用的库，然后您可以在不了解这些功能的情况下使用这些库。其中一些更改实际上简化并概括了现有功能，使新手*更容易*学习。

是的，这是一个重大更新，但它以十年来使用当前 C++ 标准的经验为指导。每一个变化都在那里，因为经验表明它是必要的。事实上，委员会非常谨慎和保守，并拒绝了大量其他语言改进。这里添加的只是1）每个人都可以达成一致的基础，2）可以及时指定，不会延迟新标准。

这不仅仅是几个语言设计师坐下来集思广益他们想尝试的新功能。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-05-07T14:51:20.717

概念和概念图将大大增加模板框架的可理解性。如果你曾经倾注过 Boost 源，你就会明白我的意思。您不断地从源代码转到文档，因为该语言没有表达模板概念的工具。希望 Concepts + Duck Typing 能给我们两全其美，模板库的入口点可以显式声明需求，但在编写通用代码时仍然具有 Duck Typing 提供的自由度。

C++0x 中有很多好东西，但它们大多是改进或扩展现有想法的进化变化。我认为这不足以证明将其称为“新语言”是合理的。

# java - 如何在 Servlet 中获取用户角色？

> ID：834388
> 
> 赞同：2
> 
> 时间：2009-05-07T12:31:53.577
> 
> 标签：java, authentication, jboss

我正在使用 Jbos AS 5 和 DatabaseServerLoginModule 进行授权。我将我的应用程序策略定义为（仅举例，不是实际代码）：

```
<application-policy name = "jbossmq">
  <authentication>
    <login-module code = "org.jboss.security.auth.spi.DatabaseServerLoginModule"
       flag = "required">
       <module-option name = "unauthenticatedIdentity">guest</module-option>
       <module-option name = "dsJndiName">java:/MyDatabaseDS</module-option>
       <module-option name = "principalsQuery">SELECT PASSWD FROM JMS_USERS WHERE USERID=?</module-option>
       <module-option name = "rolesQuery">SELECT ROLEID, 'Roles' FROM JMS_ROLES WHERE USERID=?</module-option>
    </login-module>
  </authentication>
</application-policy> 
```

成功授权用户后，如何从我的 servlet 中检索用户角色？在上面的代码片段中，角色是从数据库中选择的，但是它们存储在哪里？在会话中！？如果是，在哪些会话变量下？

另外，是否可以在 JBoss 中结合使用 Ldap 身份验证和数据库授权？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T13:12:12.997

Clinton is basically right, the

```
boolean HttpServletRequest.isUserInRole(String role) 
```

method can be used to check if a user has a certain roles assigned. **However**, this method is intended to check for the J2EE roles defined byt the application (in EAR's descriptor, the application.xml).

During deploy, or by packaing an AS-specific descriptor within your EAR file, you need to specify mapping of the application server's user roles (these you set to principals in your login module) to the J2EE app. roles.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T13:03:40.897

我知道方法：

```
boolean HttpServletRequest.isUserInRole(String role) 
```

我知道这并没有给你一个所有角色的列表，但它会达到你的目的吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-14T14:15:42.310

如果容器与 JACC 兼容，则以下代码段可能有效（至少对 Glassfish 3.1.x 上的我而言）

```
Subject subject = (Subject) PolicyContext.getContext("javax.security.auth.Subject.container");
for (Principal principal : subject.getPrincipals()) {
    LOG.debug("In subject: " + principal.getName());
} 
```

第一个命中（通常）是您的用户主体，其他的往往是组主体。请注意，如果您碰巧知道组主体类名称，则可以通过调用`getPrincipals(Class<T> c)`来过滤它。

# c# - asp:RadioButtonList 添加 RadioButton 到新行

> ID：834389
> 
> 赞同：3
> 
> 时间：2009-05-07T12:31:56.417
> 
> 标签：c#, asp.net

问题是：我有水平 asp:RadioButtonList，有 3 个按钮，我以编程方式添加 C# 代码问题是第三个按钮必须在第二行。除了创建一个新的 asp:RadioButtonList，我还能怎么做？我尝试将 br 和 \r\n 添加到标题中，但这对我没有帮助。

```
ListItem _item1 = new ListItem("1", "1");
ListItem _item2 = new ListItem("2", "2");
ListItem _item3 = new ListItem("3", "3");
rbl.Items.Add(_item1);
rbl.Items.Add(_item2);
rbl.Items.Add(_item3); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T12:37:40.007

使用RepeatColumns 属性？将其设置为 2，第三个应该会向下移动一条线。这将创建一个列方法。如果标签很长，唯一的缺点是它可能看起来不正确。

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.radiobuttonlist.repeatcolumns.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.radiobuttonlist.repeatcolumns.aspx)

如果标签真的很长，那么我建议您使用中继器或列表视图并自己滚动。您可以在项目模板中使用占位符控件，并在 itemdatabound 事件中添加基于计数或索引的单选按钮，并使用 mod 来决定何时放置中断元素。绝对是一个黑客。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:19:47.580

您可以考虑使用[CssAdapters](http://www.asp.net/CssAdapters/)，它们为调整控件布局提供了很大的灵活性。

# wpf - 我可以使用 XAML 设置控件的嵌套属性（属性值的属性）吗？

> ID：834391
> 
> 赞同：9
> 
> 时间：2009-05-07T12:33:01.687
> 
> 标签：wpf, data-binding, properties, nested

我有一个 WPF 控件，它通过只读属性公开它的一个子项（来自它的 ControlTemplate）。目前它只是一个 CLR 属性，但我认为这没有任何区别。

我希望能够从我正在实例化主控件的 XAML 中设置子控件的属性之一。（其实我也想绑定它，但我觉得设置它会是很好的第一步。）

这是一些代码：

```
public class ChartControl : Control
{
    public IAxis XAxis { get; private set; }

    public override void OnApplyTemplate()
    {
        base.OnApplyTemplate();

        this.XAxis = GetTemplateChild("PART_XAxis") as IAxis;
    }
}

public interface IAxis
{
    // This is the property I want to set
    double Maximum { get; set; }
}

public class Axis : FrameworkElement, IAxis
{
    public static readonly DependencyProperty MaximumProperty = DependencyProperty.Register("Maximum", typeof(double), typeof(Axis), new FrameworkPropertyMetadata(20.0, FrameworkPropertyMetadataOptions.AffectsRender, OnAxisPropertyChanged));

    public double Maximum
    {
        get { return (double)GetValue(MaximumProperty); }
        set { SetValue(MaximumProperty, value); }
    }
} 
```

这是我能想到的在 XAML 中设置嵌套属性的两种方法（都不编译）：

```
<!-- 
    This doesn't work:
    "The property 'XAxis.Maximum' does not exist in XML namespace 'http://schemas.microsoft.com/winfx/2006/xaml/presentation'."
    "The attachable property 'Maximum' was not found in type 'XAxis'."
-->
<local:ChartControl XAxis.Maximum="{Binding Maximum}"/>

<!-- 
    This doesn't work: 
    "Cannot set properties on property elements."
-->
<local:ChartControl>
    <local:ChartControl.XAxis Maximum="{Binding Maximum}"/>
</local:ChartControl> 
```

这甚至可能吗？

如果没有它，我想我只需要在绑定到子级的主控件上公开 DP（在模板中）。我猜还不错，但我只是想避免主控件上的属性爆炸。

干杯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T16:50:33.907

您不能这样做...您可以通过绑定中的路径访问嵌套属性，但不能在定义属性值时访问。

你必须做这样的事情：

```
<local:ChartControl>
    <local:ChartControl.XAxis>
        <local:Axis Maximum="{Binding Maximum}"/>
    </local:ChartControl.XAxis>
</local:ChartControl> 
```

# python - Python ASCII 图形绘图

> ID：834395
> 
> 赞同：29
> 
> 时间：2009-05-07T12:33:34.307
> 
> 标签：python, graph, ascii

我正在寻找一个库来用 Python 绘制 ASCII 图形（用于控制台）。该图非常简单：它只是管道的流程图。

我看到了 NetworkX 和 igraph，但没有看到输出到 ascii 的方法。

你有这方面的经验吗？

非常感谢！

帕特里克

编辑 1：我实际上找到了一个库做我需要的，但它在 perl [Graph::Easy](http://bloodgate.com/perl/graph/manual/output.html)中。我可以从 python 调用代码，但我不太喜欢这个想法......仍在寻找 python 解决方案:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-31T00:47:32.937

[ascii-plotter](http://www.algorithm.co.il/blogs/index.php/ascii-plotter/)可能会做你想做的事......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T13:12:33.060

When you say 'simple network graph in ascii', do you mean something like this?

```
.===.   .===.   .===.   .===.
| a |---| b |---| c |---| d |
'==='   '==='   '---'   '===' 
```

I suspect there are probably better ways to display whatever information it is that you have than to try and draw it on the console. If it's just a pipeline, why not just print out:

```
a-b-c-d 
```

If you're sure this is the route, one thing you could try would be to generate a decent graph using [Matplotlib](http://matplotlib.sourceforge.net) and then post the contents to one of [the many image-to-ascii converters](https://www.ohloh.net/tags/ascii/python) you can find on the web.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T12:41:18.720

它不是直接基于 Python，但你应该看看 emacs 的艺术家模式

*   [艺术家模式视频](http://www.youtube.com/watch?v=LDbi56U5qRw)
*   [艺术家模式网站](http://www.lysator.liu.se/~tab/artist/)

[您可以使用pymacs](http://www.lysator.liu.se/~tab/artist/)从 python 控制 emacs ，也可以查看 lisp 代码并从中汲取灵感。

# scripting - 如何将 wiki 从 FogBugz 6 导出到（几乎）任何其他 wiki（最终目的地：Confluence）？

> ID：834399
> 
> 赞同：11
> 
> 时间：2009-05-07T12:34:28.390
> 
> 标签：scripting, export, wiki, fogbugz, confluence

我们安装了 FogBugz 6，其中包含大量 wiki 内容。我们正在过渡到使用 Atlassian 产品（JIRA 和 Confluence），因此我们希望将 wiki 内容导入 Confluence。你会如何处理这个问题？

不幸的是，FogBugz 似乎没有提供任何类型的 wiki 导出功能，而 Confluence 也没有提供任何 FogBugz wiki 导入。

FogBugz 确实有一个[API](http://support.fogcreek.com/help/topics/advanced/API.html)，但它对访问 wiki 内容的细节有点了解。我们并不真正关心页面的过去修订（只是内容、链接和图像/附件），所以不清楚 API 是否能让我们更进一步，而不是使用 wget 或其他东西抓取 FB wiki，并使用 HTML 和来自那里的图像/附件。

Confluence 有一个非常全功能的[内容导入实用程序](http://confluence.atlassian.com/display/CONFEXT/Universal+Wiki+Converter)，它支持许多源 wiki：

*   维基
*   维基百科
*   多库维基
*   媒体维基
*   莫因莫因
*   Jotspot
*   提基维基
*   维基百科
*   共享点
*   维基
*   维基百科
*   XWiki
*   追踪

那里没有 FogBugz 选项，但如果我们可以将 FogBugz wiki 内容导出到上述 wiki 之一，那么我们可能会从那里使用 Confluence 多 wiki 导入器。

或者，我们可以使用 wget 抓取 FogBugz wiki 内容，然后找到一种方法将静态 HTML + 图像 + 附件放入 Confluence 或上述其他 wiki 之一，作为 Confluence 的垫脚石。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-06T16:27:30.847

一位同事最终弄清楚了这一点，并且该过程最终普遍适用于我们也想引入 Confluence 的其他 Web 内容。概括地说，该过程涉及：

1.  使用 wget 从 FogBugz 中吸取所有内容（配置为正确下载图像和附件，并正确关联到它们和其他页面的链接）。
2.  使用简单的 XSLT 转换来去除围绕每个页面主体的“模板”内容（例如徽标、控制/导航链接等）。
3.  （可选）使用[perl 模块](http://search.cpan.org/~diberri/HTML-WikiConverter-Confluence-0.01/lib/HTML/WikiConverter/Confluence.pm)将生成的 HTML 片段转换为 Confluence 的标记格式
4.  使用[Confluence 命令行界面](http://confluence.atlassian.com/display/CONFEXT/Confluence+Command+Line+Interface)推送所有页面、图像和附件数据。

请注意，我在上面的#3 中说“可选”。这是因为 Confluence CLI 有两个相关选项：它可以用于直接创建新页面，在这种情况下它已经需要 Confluence 标记，或者它可以用于使用 HTML 创建新页面，它会将其转换为 Confluence 标记本身。在某些情况下，Confluence CLI 可以很好地转换 HTML；对于其他数据源，我们需要使用 perl 模块。

# outlook - 有没有办法在 Outlook 2007 中用 VSTO CustomTaskBar 替换阅读窗格？

> ID：834424
> 
> 赞同：1
> 
> 时间：2009-05-07T12:38:38.117
> 
> 标签：outlook, vsto, outlook-2007, outlook-addin

我在 VSTO 中为 Outlook 2007 制作了一个自定义任务窗格，但它需要相当多的屏幕空间才能正常工作。我想接管阅读窗格的位置，因为当此插件处于活动状态时，它实际上并不需要。这也是一个非常棒的地方，因为这个插件依赖于从邮件文件夹拖放到这个任务窗格，而且我越靠近文件夹窗格越好。

有什么方法可以替换阅读窗格，或者至少切换它的可见性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T15:02:25.667

我认为 OOM 中没有办法做到这一点。不过，我可以更改区域的大小。

我已经看到它使用 add-in-express 工具[http://www.add-in-express.com](http://www.add-in-express.com)完成了，但要更改为该模型可能需要 2 项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T04:45:26.237

查看替换或替换所有表单区域选项。这两个选项都允许替换表单区域的显示。

Replacement 表单区域让您可以构建自己的自定义首页。Replace All 表单区域让您构建所有表单页面。

这些不是简单的选项，因为您必须提供用户期望的所有 Outlook 功能。这就是为什么相邻表单区域选项是受欢迎的选择的原因。

你可以在这里阅读更多：

*   [http://msdn.microsoft.com/en-us/library/office/dd492010(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/office/dd492010(v=office.12).aspx)
*   [http://msdn.microsoft.com/en-us/library/vstudio/bb206784.aspx](http://msdn.microsoft.com/en-us/library/vstudio/bb206784.aspx)

# c# - 类型转换或转换方法？

> ID：834429
> 
> 赞同：1
> 
> 时间：2009-05-07T12:40:22.387
> 
> 标签：c#, oop, single-responsibility-principle

我有一个容器类，其参数来自不同类型的配置文件（例如文本或 xml）。

所以我为 textConfigurationFiles 创建了一个类，为 xmlConfigurationFiles 创建了一个类（我想我稍后会为此实现一个接口 IConfigFile）。

我的容器类的初始化如下所示：

```
ContainerClass myContainer = new ContainerClass();
myTextConfig = new TextConfig(textFile);
myContainer.ParameterA = myTextConfig.ParameterA;
myContainer.ParameterB = myTextConfig.ParameterB;
myContainer.ParameterC = myTextConfig.ParameterC; 
```

或用于 xml

```
ContainerClass myContainer = new ContainerClass();
myXMLConfig = new XMLConfig(xmlFile);
myContainer.ParameterA = myXMLConfig.ParameterA;
myContainer.ParameterB = myXMLConfig.ParameterB;
myContainer.ParameterC = myXMLConfig.ParameterC; 
```

但是我不想分配每个值，而是进行某种转换。现在我不知道我是否应该实现一个类型转换或只是一个返回 ContainerClass 对象的简单方法？

```
myContainer = myTextConfig.ConvertToContainer(); 
```

或者

```
myContainer = (ContainerClass)myTextConfig; 
```

你的建议是什么？

因为我正在尝试实现单一职责原则，所以我希望我的 ContainerClass 代表一个简单的 Container。所以我想像

```
ContainerClass myContainer = new ContainerClass(configFile); 
```

会与 SRP 决裂吗？

也许我应该提一下，我的 ContainerClass 是由文本**或**xml 文件初始化的；这并不是说参数来自文本**和**xml 文件。

* * *

**[编辑：附加信息]**

ContainerClass 表示具有数据库配置信息（路径、名称等）的容器。

textFile 表示数据库配置。

xmlFile 也包含一个数据库配置，但比我的 textFile 具有更多（数据库配置）参数。

我在想某事。喜欢：

```
IConfig        config    = new TextFileConfig(fileName);
ContainerClass container = config.ConverToContainer(); 
```

或者

```
IConfig        config    = new TextFileConfig(fileName);
ContainerClass container = (ContainerClass)config; 
```

在文本文件配置中：

```
public class TextFileConfig : IConfig
{
    ContainerClass container;

    //
    // Constructor
    //
    public TextFileConfig(string fileName)
    {
        //
        // Initialize all values from file fileName
        //
        ...

        //
        // Initialize container with standard values
        //
        container = new ContainerClass();

        //
        // Merge container with values from textFile
        //
        ...

        //
        // Now container contains all values from textFile,
        // all missing parameters are initialized with
        // standard values.
        //
    }

    public ContainerClass ConvertMethodOrTypecastThatsTheQuestion()
    {
        return container;
    }
} 
```

那么我应该更喜欢转换方法，类型转换还是两者兼而有之？

一开始我会考虑性能、最佳用法和个人习惯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T13:01:50.400

我想我会按照这些思路做一些事情：

*   创建一个代表您的配置的类型：`IConfig`
*   创建一个代表你的配置加载器的类型`IConfigLoader`
*   创建返回实例的不同配置加载器实现（`XmlConfigLoader`、`TextConfigLoader`等） 。`IConfig`
*   选择加载器实现以动态使用、配置或硬编码等。例如，您可以使用抽象工厂或 IoC 容器。
*   将加载的`IConfig`实例传递给`ContainerClass`构造函数，并让它自己初始化。

关于您的问题，我不确定将配置对象传递给容器会破坏 SRP。至少，您可以为您的容器建立一个工厂，该工厂将获取并读取配置以实例化和初始化容器。它可能是过度设计的——我猜这取决于容器创建任务的复杂程度。

# c# - 如何获取应用程序的活动 ChildWindow？

> ID：834437
> 
> 赞同：3
> 
> 时间：2009-05-07T12:42:48.590
> 
> 标签：c#, winapi, user32, childwindow

我有这个问题：我有一个特定应用程序的主窗口的处理程序，我想在那个应用程序上模拟一个按键......

我正在使用 sendMessage/postMessage api 调用来执行此操作。我不使用 .Net SendKeys 函数或 win32 api 的 keybd_event 的原因是它们在全局级别模拟按键。在我的情况下，目标应用程序不是最活跃的应用程序（其他应用程序可能运行在更高的 z 级别，因此覆盖了目标应用程序）。

sendMessage 和 postMessage 的问题在于，您必须传递要按下键的确切子窗口的处理程序。例如，在记事本中，如果我将密钥发送到主窗口的处理程序，什么也没有发生，我必须将密钥发送到子窗口的处理程序，该子窗口基本上由您可以编写的白色画布组成。

获取活动子窗口的处理程序是问题所在。一开始，我使用 GetTopWindow 或 GetWindow(GW_CHILD) api 调用，因为它返回最活跃的子窗口。我正在做的是继续调用 GetWindow(GW_CHILD)，直到我得到一个没有更多 childWindows 的 childwindow。这适用于记事本或绘画等某些应用程序。但是，在某些情况下（例如 Firefox），它不起作用。原因是父窗口有整个firefox区域，而它的子窗口有打开的网页（如google）。所以，当我询问主窗口最活跃的子窗口时，它返回它拥有的唯一子窗口，也就是网页区域对应的那个。它仅在活动窗口是那个窗口时才有效（例如，如果用户在某个页面的文本框上写东西）。

我实际上找到了一种方法，使用 GetGUIThreadInfo api调用，使用以下代码：

```
 // get thread of the main window handle of the process
    var threadId = GetWindowThreadProcessId(firefox.MainWindowHandle, IntPtr.Zero);

    // get gui info
    var info = new GUITHREADINFO();
    info.cbSize = (uint)Marshal.SizeOf(info);
    if (!GetGUIThreadInfo(threadId, out info))
        throw new Win32Exception();

    // send the letter W to the active window
    PostMessage(info.hwndActive, WM_KEYDOWN, (IntPtr)Keys.W, IntPtr.Zero); 
```

而且效果很好：如果地址栏处于活动状态，它会向地址栏发送一个“W”字母。如果谷歌的搜索文本框处于活动状态，它会向它发送“W”字母......完美！但是，我不能使用这种方法，原因很简单：如果目标应用程序不是操作系统的活动窗口，则 ThreadInfo 结构为空。例如，如果我的目标是 firefox，如果 firefox 处于活动状态（最顶层的应用程序，聚焦/活动的应用程序），它就可以工作，但是如果，比如说，记事本位于 firefox 之上，它就不起作用，它无法获取活动窗口处理程序。

我知道我可以通过使用 setForegroundWindow api 调用来激活目标应用程序然后捕获活动子窗口的处理程序来解决这个问题，但我不想将目标应用程序带到前台。

我还尝试了其他技术，例如 AttachThreadInput() 和 GetFocus() api 调用，它们也可以工作，但有同样的问题：如果目标应用程序不是活动的 Windows 应用程序，它就不起作用。

所以基本上我需要找到某种方法将处理程序获取到应用程序的活动子窗口，即使该应用程序不是最活跃的应用程序。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T14:09:32.903

您可能想查看[EnumChildWindows](http://msdn.microsoft.com/en-us/library/ms633494(VS.85).aspx)函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T05:21:51.497

如果一切都失败了，这里有另一个想法：您可能要考虑使用 WH_CBT 或 WH_CALLWNDPROC 挂钩来监视目标线程的哪个子窗口最后被聚焦。

安装 CBT 挂钩 (WH_CBT) 并收听 HCBT_SETFOCUS 通知。或者使用 WH_CALLWNDPROC 钩子并监听 WM_SETFOCUS 消息。

不要在 hook proc 中做太多事情，否则你会占用系统资源。只需保存所需的信息并为自己发布一条自定义消息以供以后处理。

# oracle - 用于 Oracle 查询开发的 SQL 工具和 Toad IDE 的替代方案

> ID：834439
> 
> 赞同：1
> 
> 时间：2009-05-07T12:43:21.427
> 
> 标签：oracle, toad, sqltools

使用 SQL Tools 和 TOAD 为 Oracle DB 编写存储过程和查询是否有更好的选择？

在能够调试大型查询和存储过程的意义上更好。

欢迎任何指点！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T12:47:15.677

我建议使用[Oracle SQL Developer](http://www.oracle.com/technology/products/database/sql_developer/index.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T12:46:34.883

我们公司使用[PL/SQL Developer](http://www.allroundautomations.nl/plsqldev.html)。我不熟悉 SQL 工具或 TOAD，但这个工具在调试方面对我们来说效果很好。

# perl - 在字符串中查找多个子字符串并记录位置

> ID：834442
> 
> 赞同：1
> 
> 时间：2009-05-07T12:43:43.237
> 
> 标签：perl

以下是在字符串中查找连续子字符串的脚本。

```
use strict;
use warnings;

my $file="Sample.txt";
open(DAT, $file) || die("Could not open file!");

#worry about these later
#my $regexp1 = "motif1";
#my $regexp2 = "motif2";
#my $regexp3 = "motif3";
#my $regexp4 = "motif4";

my $sequence;

while (my $line = <DAT>) {
    if ($line=~ /(HDWFLSFKD)/g){
        {
        print "its found index location: ",
        pos($line), "-",  pos($line)+length($1), "\n";        
        }
        if ($line=~ /(HD)/g){
                print "motif found and its locations is: \n";
                pos($line), "-", pos($line)+length($1), "\n\n";
                }
                if ($line=~ /(K)/g){
                        print "motif found and its location is: \n";
                        pos($line), "-",pos($line)+length($1), "\n\n";
                        }
                        if ($line=~ /(DD)/g){
                                print "motif found and its location is: \n";
                                pos($line), "-", pos($line)+length($1), "\n\n";
                                }
}else {
        $sequence .= $line;
        print "came in else\n";
    }
} 
```

它将 substring1 与 string 匹配并打印出 substring1 匹配的位置。问题在于找到其余的子字符串。对于 substrings2 它再次从字符串的开头开始（而不是从找到 substring1 的位置开始）。问题是每次计算位置时，它都是从字符串的开头开始，而不是从先前找到的子字符串的位置开始。由于子串是连续的子串1、子串2、子串3、子串4，它们的位置必须分别出现在前一个之后。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T19:47:45.713

# 试试这个 perl 程序

```
use strict;
use warnings;
use feature qw'say';

my $file="Sample.txt";
open( my $dat, '<', $file) || die("Could not open file!");

my @regex = qw(
  HDWFLSFKD
  HD
  K
  DD
);

my $sequence;

while( my $line = <$dat> ){
  chomp $line;

  say 'Line: ', $.;

  # reset the position of variable $line
  # pos is an lvalue subroutine
  pos $line = 0;

  for my $regex ( @regex ){
    $regex = quotemeta $regex;

    if( scalar $line =~ / \G (.*?) ($regex) /xg ){
      say $regex, ' found at location (', $-[2], '-', $+[2], ')';
      if( $1 ){
        say "    but skipped: \"$1\" at location ($-[1]-$+[1])";
      }
    }else{
      say 'Unable to find ', $regex;

      # end loop
      last;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T13:00:47.097

你真的应该读

*   [`perldoc`](http://perldoc.perl.org) [`perlre`](http://perldoc.perl.org/perlre.html)
*   [`perldoc`](http://perldoc.perl.org) [`perlreref`](http://perldoc.perl.org/perlreref.html)
*   [`perldoc`](http://perldoc.perl.org) [`perlretut`](http://perldoc.perl.org/perlretut.html)

如果需要位置，则需要特殊变量 @- 和 @+。无需尝试自己计算它们。

```
#!/usr/bin/perl

use strict;
use warnings;

use List::MoreUtils qw( each_array );

my $source = 'AAAA   BBCCC   DD  E      FFFFF';
my $pattern = join '\s*', map { "($_+)" } qw( A B C D E F );

if ( $source =~ /$pattern/ ) {
    my $it = each_array @-, @+;

    $it->(); # discard overall match information;

    while ( my ($start, $end) = $it->() ) {
        printf "Start: %d - Length: %d\n", $start, $end - $start;
    }
} 
```

```
Start: 0 - Length: 4
Start: 7 - Length: 2
Start: 9 - Length: 3
Start: 15 - Length: 2
Start: 19 - Length: 1
Start: 26 - Length: 5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T16:54:34.570

我不是 perl 专家，但您可以使用 $- 和 $+ 来跟踪找到的最后一个正则表达式匹配的索引位置。
下面是在您的代码之上构建的代码，用于解释这一点。

```
use strict;
use warnings;

my $file="sample.txt";
open(DAT, $file) || die("Could not open file!");

open (OUTPUTFILE, '>data.txt');

my $sequence;
my $someVar = 0;
my $sequenceNums = 1;

my $motif1 = "(HDWFLSFKD)";
my $motif2 = "(HD)";
my $motif3 = "(K)";
my $motif4 = "(DD)";

while (my $line = <DAT>) 
{
    $someVar = 0;
    print "\nSequence $sequenceNums: $line\n";
    print OUTPUTFILE "\nSequence $sequenceNums: $line\n";
        if ($line=~ /$motif1/g)
        {
                &printStuff($sequenceNums, "motif1", $motif1, "$-[0]-$+[0]");
                $someVar = 1;
        }

        if ($line=~ /$motif2/g and $someVar == 1)
        {
                &printStuff($sequenceNums, "motif2", $motif2, "$-[0]-$+[0]");
                $someVar = 2;
        }

        if ($line=~ /$motif3/g and $someVar == 2)
        {
                &printStuff($sequenceNums, "motif3", $motif4, "$-[0]-$+[0]");
                $someVar = 3;
        }

        if ($line=~ /$motif4/g and $someVar == 3)
        {
                &printStuff($sequenceNums, "motif4", $motif4, "$-[0]-$+[0]");
        }

        else 
        {
            $sequence .= $line;

            if ($someVar == 0)
            {
                &printWrongStuff($sequenceNums, "motif1", $motif1);
            }
            elsif ($someVar == 1)
            {
            &printWrongStuff($sequenceNums, "motif2", $motif2);
            }
            elsif ($someVar == 2)
            {
            &printWrongStuff($sequenceNums, "motif3", $motif3);
            }
            elsif ($someVar == 3)
            {
            &printWrongStuff($sequenceNums, "motif4", $motif4);
            }
        }
        $sequenceNums++;
}

sub printStuff
{
            print "Sequence: $_[0] $_[1]: $_[2] index location: $_[3] \n";
            print OUTPUTFILE "Sequence: $_[0]  $_[1]: $_[2] index location: $_[3]\n";
}

sub printWrongStuff
{
            print "Sequence: $_[0] $_[1]: $_[2] was not found\n";
            print OUTPUTFILE "Sequence: $_[0] $_[1]: $_[2] was not found\n";    

}

close (OUTPUTFILE);
close (DAT); 
```

样本输入：

MLTSHQKKF *HDWFLSFKD* SNNYN *HD* S *K* QNHSIK *DD* IFNRFNHYIYNDLGIRTIA MLTSHQKKFSNNYNSKQNHSIKDIFNRFNHYIYNDLGIRTIA MLTSHQKKFSNNYNSK *HDWFLSFKD* QNHSIKDIFNRFNHYIYNDL

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:01:36.830

像这样的构造的结果

```
$line=~ /(HD)/g 
```

是一个列表。用于`while`逐步浏览热门歌曲。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T13:13:26.380

To match where the last match left off, use `\G`. [perldoc perlre](http://perldoc.perl.org/perlre.html) says (but consult your own installation's version's manual first):

> The "\G" assertion can be used to chain global matches (using "m//g"), as described in "Regexp Quote-Like Operators" in perlop. It is also useful when writing "lex"-like scanners, when you have several patterns that you want to match against consequent substrings of your string, see the previous reference. The actual location where "\G" will match can also be influenced by using "pos()" as an lvalue: see "pos" in perlfunc. Note that the rule for zero-length matches is modified somewhat, in that contents to the left of "\G" is not counted when determining the length of the match. Thus the following will not match forever:
> 
> ```
> $str = 'ABC';
> pos($str) = 1;
> while (/.\G/g) {
>     print $&;
> } 
> ```

# php - 使用 PHP 的当前页面截图

> ID：834445
> 
> 赞同：1
> 
> 时间：2009-05-07T12:44:13.267
> 
> 标签：php, mysql

复制：

> [使用php的网站截图](https://stackoverflow.com/questions/757675/website-screenshots-using-php/757721)

是否可以使用 PHP 截取当前页面的屏幕截图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T12:49:35.860

PHP 不会渲染页面，浏览器会。

[这是一个工具列表，](http://mashable.com/2007/08/24/web-screenshots/)可让您做自己想做的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T12:49:00.993

不*

*   PHP 在 Web 服务器上运行，而不是在浏览器所在的客户端上运行，并且无法远程控制浏览器或操作系统的其他部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-30T09:34:51.143

*您可以在您的服务器上*安装[webkit2png](http://github.com/paulhammond/webkit2png/) ，然后从您的 PHP 脚本执行。这将为您提供 Webkit 呈现页面的方式的屏幕截图。要在 Linux 上安装，[请参阅此](http://www.blogs.uni-osnabrueck.de/rotapken/2008/12/03/create-screenshots-of-a-web-page-using-python-and-qtwebkit/).*`webkit2png http://yourpage.example.com`*

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T12:52:35.790

理论上，您可以编写一个 HTML 布局引擎作为 PHP 扩展，然后使用它……但是，不，PHP 中已经没有任何东西可以满足您的需求。

您可以使用[这样的命令行实用程序](http://cutycapt.sourceforge.net/)并从 PHP 中调用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T12:56:08.450

如果你在窗户上。有[imagegrabscreen()](http://is.php.net/manual/en/function.imagegrabscreen.php)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T13:46:18.377

这是一个简洁的 Firefox 插件：[Screengrab！](https://addons.mozilla.org/en-US/firefox/addon/1146)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-05T03:29:13.237

如果您使用的是 Windows 平台，您可以安装 ACA WebThumb ActiveX： [http ://www.acasystems.com/en/web-thumb-activex](http://www.acasystems.com/en/web-thumb-activex)

一个简单的演示：

```
 <?php
  // PHP html to image.
  // This script shows how to convert the google.com homepage to a PNG image file.
  $WebThumb_Maker = new COM('ACAWebThumb.ThumbMaker')
    or die("Start ACAWebThumb.ThumbMakerfailed");

  $WebThumb_Maker->SetURL("http://www.google.com"); 
  if ( 0 == $WebThumb_Maker->StartSnap() )
  {
    // Tanke snapshot successful, call SetImageFile() to save the image as a PNG file.
    echo "Take snapshot successful." ;
    $WebThumb_Maker->SaveImage("google.png");
  }
?> 
```

# php - 如何从 mysql 查询中识别字段的源表

> ID：834446
> 
> 赞同：0
> 
> 时间：2009-05-07T12:44:47.353
> 
> 标签：php, mysql

我有两个动态表（tabx 和 taby），它们是通过 php 界面创建和维护的，可以在其中添加、删除、重命名列等。我想像这样从两个表中同时读取所有列；-

select * from tabx,taby where ... ;

我希望能够从查询结果中判断每列是来自 tabx 还是 taby - 有没有办法强制 mysql 返回完全限定的列名，例如 tabx.col1、tabx.col2、taby.coln 等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T19:47:50.113

在 PHP 中，你可以从结果中获取字段信息，就像这样（从我很久以前写的一个项目中偷来的）：

```
/*
Similar to mysql_fetch_assoc(), this function returns an associative array
given a mysql resource, but prepends the table name (or table alias, if
used in the query) to the column name, effectively namespacing the column
names and allowing SELECTS for column names that would otherwise have collided
when building a row's associative array.
*/
function mysql_fetch_assoc_with_table_names($resource) {
    // get a numerically indexed row, which includes all fields, even if their names collide
    $row = mysql_fetch_row($resource);
    if( ! $row)
        return $row;

    $result = array();

    $size = count($row);    
    for($i = 0; $i < $size; $i++) {
        // now fetch the field information
        $info = mysql_fetch_field($resource, $i);
        $table = $info->table;
        $name = $info->name;
        // and make an associative array, where the key is $table.$name
        $result["$table.$name"] = $row[$i];  // e.g. $result["user.name"] = "Joe Schmoe";
    }

    return $result;
} 
```

然后你可以像这样使用它：

```
$resource = mysql_query("SELECT * FROM user JOIN question USING (user_id)");
while($row = mysql_fetch_assoc_with_table_names($resource)) {
    echo $row['question.title'] . ' Asked by ' . $row['user.name'] . "\n";
} 
```

所以要直接回答你的问题，表名数据总是由 MySQL 发送的——由客户端告诉你每列来自哪里。如果您真的希望 MySQL 明确地返回每个列名，您将需要修改查询以显式执行别名，如 @Shabbyrobe 建议的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:03:59.477

```
select * from tabx tx, taby ty where ... ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T13:04:20.707

Does:

```
SELECT tabx.*, taby.* FROM tabx, taby WHERE ... 
```

work?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:26:08.237

撇开任何关于您为什么要这样做以及为什么要在这里进行交叉连接的任何问题，这是我能想到的最好的方法。

您可以尝试对每个表执行 EXPLAIN 并根据结果以编程方式构建 select 语句。这是一个糟糕的脚本示例，它将为您提供一个动态生成的带有别名的字段列表。这将增加您执行的查询数量，因为动态生成的查询中的每个表都会导致 EXPLAIN 查询被触发（尽管这可以通过缓存相当容易地缓解）。

```
<?php
$pdo = new PDO($dsn, $user, $pass, array(PDO::ATTR_ERRMODE=>PDO::ERRMODE_EXCEPTION));
function aliasFields($pdo, $table, $delim='__') {
    $fields = array();
    // gotta sanitise the table name - can't do it with prepared statement
    $table = preg_replace('/[^A-z0-9_]/', "", $table);
    foreach ($pdo->query("EXPLAIN `".$table."`") as $row) {
        $fields[] = $table.'.'.$row['Field'].' as '.$table.$delim.$row['Field'];
    }
    return $fields;
}
$fieldAliases = array_merge(aliasFields($pdo, 'artist'), aliasFields($pdo, 'event'));
$query = 'SELECT '.implode(', ', $fieldAliases).' FROM artist, event';
echo $query; 
```

结果是一个如下所示的查询，表名和列名由两个下划线分隔（或任何您喜欢的分隔符，请参见 aliasFields() 的第三个参数）：

```
// ABOVE PROGRAM'S OUTPUT (assuming database exists)
SELECT artist__artist_id, artist__event_id, artist__artist_name, event__event_id, event__event_name FROM artist, event 
```

从那里，当您迭代结果时，您可以使用相同的分隔符对每个字段名称进行分解，以获取表名称和字段名称。

* * *

John Douthat 的回答比上面的要好得多。仅当数据库未返回字段元数据时它才有用，因为 PDO 威胁可能是某些驱动程序的情况。

这是一个简单的片段，说明如何使用 PDO 而不是 mysql_*() 来执行 John 建议的操作：

```
<?php

$pdo = new PDO($dsn, $user, $pass, array(PDO::ATTR_ERRMODE=>PDO::ERRMODE_EXCEPTION));

$query = 'SELECT artist.*, eventartist.* FROM artist, eventartist LIMIT 1';
$stmt = $pdo->prepare($query);
$stmt->execute();

while ($row = $stmt->fetch()) {
    foreach ($row as $key=>$value) {
        if (is_int($key)) {
            $meta = $stmt->getColumnMeta($key);
            echo $meta['table'].".".$meta['name']."<br />";
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T13:35:48.883

我想知道您要完成什么。首先，在表中添加和删除列是一种奇怪的做法；这意味着您的数据架构在运行时正在发生变化。

此外，要同时从两个表中查询，它们之间应该存在某种关系。一个表中的行应该以某种方式与另一个表中的行相关联。如果不是这种情况，最好执行两个单独的 SELECT 查询。

您的问题的答案已经给出： SELECT tablename.* 从给定表中检索所有列。如果两个表中都有同名的列，这可能会也可能不会正常工作；您应该在文档中查找。

你能给我们更多关于你试图解决的问题的信息吗？我认为你很有可能以错误的方式解决这个问题。

# active-directory - 是否可以通过 LDAP 查询一组组共有的用户

> ID：834448
> 
> 赞同：2
> 
> 时间：2009-05-07T12:44:55.683
> 
> 标签：active-directory, ldap

我需要使用我们的 Active Directory 的单个 LDAP 查询来列出已知组集合的所有通用用户的列表。从我们目前的阅读来看，这似乎是不可能的，但我认为最好问问蜂巢的头脑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:01:40.137

试试这个：

```
(&(objectCategory=Person)
    (&
        (memberOf=CN=group1,dc=company,dc=local)
        (memberOf=CN=group2,dc=company,dc=local)
        (memberOf=CN=group3,dc=company,dc=local)
    )
) 
```

这类似于[我的问题](https://stackoverflow.com/questions/823069/active-directory-a-script-to-find-all-users-that-arent-in-a-set-of-groups)，除了我想要所有不是组成员的用户。您需要删除所有空格才能使大多数查询工具正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T22:16:18.903

是的，可以使用属性范围查询。它需要 W2K3 AD 或更高版本，但会为您提供具有特定属性的所有用户，即某个组的成员资格，或者在您的情况下为多个组（组的交集）。最好的例子之一是来自 Joe Kaplan 和 Ryan Dunns 的书“目录服务编程的 .NET 开发人员指南”，对于 AD 工作来说，很难击败第 179 页来进行深入了解。

**警告**：此时，您已经完成了 AD 中的琐碎搜索，并且许多事情变得越来越重要，例如搜索根、范围和搜索您想要的项目的一些潜在的巨大数据集的效果。查看 50 或 60K 用户以查找组成员确实会对性能产生影响，并准备在数据集很大的情况下执行分页结果或类似结果。Kaplan/Ryan 在脚踏实地的工作方面做得非常出色，可以将您带到您需要的地方。也就是说，我已经在两个广告项目中使用了它们，并取得了巨大的成功。能够在没有递归查询的情况下从 AD 中检索数据是非常值得的，我发现只要我控制数据集的大小，它就很快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T13:07:40.823

如果您的组包含嵌套组，则不可能在单个查询中进行。

您需要编写一些代码来递归解析组成员，并对结果执行“内部联接”的逻辑等效，从而生成所有原始组共有的用户列表。

# c# - sqlite3.dll 和 system.data.sqlite.dll

> ID：834453
> 
> 赞同：8
> 
> 时间：2009-05-07T12:45:42.280
> 
> 标签：c#, sqlite

大家好，我一直在努力在我的 C#2.0 应用程序中使用 sqlite，我终于决定摆脱假设并提出非常基本的问题。

当我使用表用户创建数据库说 iagency 时，从外部工具（如 firefox 插件和另一个 sqladmin 工具）我无法从它显示的 vs2005 中的 sqlicommand 查询它`System.Data.SQLite.SQLiteException:Sqlite Error no such table users`，请放心，我已经参考了`system.data.sqlite`使用 SQLite-1.0 安装。 61.0-设置

当我做相反的事情时，例如从 VS 服务器资源管理器和 VS 数据库 gui 工具创建数据库和表时，它既不能被查询，但可以被其他工具看到，但是通过使用 stringbuilder 从 VS 查询创建的表，例如 create table bla bla . 它可以显示在数据网格中，但没有任何工具可以查看和显示该表。

> 我需要什么才能使 SQLITE 在我的应用程序中正常工作？

我尝试添加`sqlite3.dll`从 sqlite 站点下载的 sqlitedll-3_6_14.zip 部分下的 windows 预编译二进制文件作为对我的应用程序的引用，但它失败了`make sure it's accessible an it's a valid assembly or com component`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-12T22:33:52.103

我下载了这个[SQLite-1.0.61.0-setup.exe 运行](http://sourceforge.net/projects/sqlite-dotnet2/)安装然后我写了这个来访问 firefox 收藏夹 sqlite db。

```
using System.Data.SQLite;  // Dont forget to add this to your project references
                           // If the installation worked you should find it under
                           // the .Net tab of the "Add Reference"-dialog

namespace sqlite_test
{
    class Program
    {
        static void Main(string[] args)
        {
            var path_to_db = @"C:\places.sqlite"; // copied here to avoid long path
            SQLiteConnection sqlite_connection = new SQLiteConnection("Data Source=" + path_to_db + ";Version=3;New=True;Compress=True;");

            SQLiteCommand sqlite_command = sqlite_connection.CreateCommand();

            sqlite_connection.Open();

            sqlite_command.CommandText = "select * from moz_places";

            SQLiteDataReader sqlite_datareader = sqlite_command.ExecuteReader();

            while (sqlite_datareader.Read())
            {
                // Prints out the url field from the table:
                System.Console.WriteLine(sqlite_datareader["url"]);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T13:10:17.387

Try opening up the database in the command line SQLite tool (from [SQLite.org](http://www.sqlite.org/)), and check the schema.

You can check the schema in this way:

```
.schema 
```

This will dump out all the SQL necessary to create the tables in the database. Make sure the table is there, with the name you assume it should have.

You do not need the .dll file from SQLite.org, all you need is the assemblies from [System.Data.SQLite](http://sqlite.phxsoftware.com/).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-21T20:09:02.653

对我来说 -[这个](http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins/)链接在开始时很有帮助。

更难获得亚音速工作，通过网络应用程序访问数据库 -
但这是另一回事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:24:04.200

您可以尝试将程序集和数据库的位置添加到 Path 环境变量中。SQLite 程序集包含合并在一起的 .Net 和本机代码，因此您不需要 C dll。（他们包含的用于执行此操作的 mergebin 工具非常有趣）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-30T12:55:32.177

我也尝试将位置添加到*Path 环境变量*，但没有成功。

最后，我将其复制`System.Data.SQLite.dll`到`System.Data.SQLite.lib`其他程序集所在的 Web 应用程序的 bin 文件夹中，并且应用程序可以正常工作。

# jsf - 用于手持设备的丰富面孔树控件

> ID：834474
> 
> 赞同：0
> 
> 时间：2009-05-07T12:50:49.773
> 
> 标签：jsf, jboss, tree

目前，我有一棵按预期工作的富树；但是，树本身不适合使用手指进行导航的小型设备。表示子节点及其扩展的箭头太小。有什么办法可以改变那个图形，或者增加它的大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T17:24:34.433

我发现我必须更改rich-tree-node-handleicon-expanded 和rich-tree-node-handleicon-collapsed 的样式。

.rich-tree-node-handleicon-expanded {
背景位置：左上角；
背景重复：不重复；
宽度：32px；
高度：32px；
}

.rich-tree-node-handleicon-collapsed {
背景位置：左上角；
背景重复：不重复；
宽度：32px；
高度：32px；
}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T09:18:15.623

试试treeNode的icon属性

# c# - String 或 StringBuilder 返回值？

> ID：834479
> 
> 赞同：19
> 
> 时间：2009-05-07T12:52:10.393
> 
> 标签：c#, string, return-value, stringbuilder, return-type

如果我在方法中使用 StringBuilder 对象构建字符串，是否有意义：

返回 StringBuilder 对象，让调用代码调用 ToString()?

```
return sb; 
```

或通过自己调用 ToString() 返回字符串。

```
return sb.ToString(); 
```

我想如果我们返回小字符串或大字符串会有所不同。在每种情况下什么是合适的？提前致谢。

编辑：我不打算进一步修改调用代码中的字符串，但好点 Colin Burnett。

主要是返回StringBuilder对象还是字符串更有效？会返回对字符串的引用还是副本？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-07T12:55:00.450

如果要进一步修改字符串，则返回 StringBuilder，否则返回字符串。这是一个 API 问题。

关于效率。由于这是一个没有任何细节的模糊/一般性问题，所以我认为可变与不可变比性能更重要。可变性是让您的 API 返回可修改对象的 API 问题。字符串长度与此无关。

那就是说。如果您使用 Reflector 查看 StringBuilder.ToString：

```
public override string ToString()
{
    string stringValue = this.m_StringValue;
    if (this.m_currentThread != Thread.InternalGetCurrentThread())
    {
        return string.InternalCopy(stringValue);
    }
    if ((2 * stringValue.Length) < stringValue.ArrayLength)
    {
        return string.InternalCopy(stringValue);
    }
    stringValue.ClearPostNullChar();
    this.m_currentThread = IntPtr.Zero;
    return stringValue;
} 
```

您可以看到它可能会创建一个副本，但是如果您使用 StringBuilder 对其进行修改，那么它将创建一个副本（这就是我可以告诉 m_currentThread 的重点是因为 Append 会检查它并在它与当前线程不匹配时将其复制） .

我想这件事的结束是，如果你不修改 StringBuilder ，那么你就不会复制字符串，长度与效率无关（除非你达到第二个 if）。

**更新**

System.String 是一个类，这意味着它是一个引用类型（而不是值类型），所以“string foo;” 本质上是一个指针。（当您将字符串传递给方法时，它传递的是指针，而不是副本。） System.String 在 mscorlib 内部是可变的，但在它外部是不可变的，这就是 StringBuilder 操作字符串的方式。

因此，当调用 ToString() 时，它通过引用返回其内部字符串对象。此时您无法修改它，因为您的代码不在 mscorlib 中。通过将 m_currentThread 字段设置为零，StringBuilder 上的任何进一步操作都将导致它复制字符串对象，以便可以修改它**而不**修改它在 ToString() 中返回的字符串对象。考虑一下：

```
StringBuilder sb = new StringBuilder();
sb.Append("Hello ");

string foo = sb.ToString();

sb.Append("World");

string bar = sb.ToString(); 
```

如果 StringBuilder 没有复制，那么最后 foo 将是“Hello World”，因为 StringBuilder 修改了它。但既然它确实做了一个副本，那么 foo 仍然只是“Hello”，而 bar 是“Hello World”。

这是否澄清了整个返回/参考的事情？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-07T12:55:30.353

我认为性能不应该是这个问题的一个因素。无论哪种方式，都会有人调用 sb.ToString() 所以你会在某个地方受到打击。

更重要的问题是方法的意图和目的是什么。如果此方法是构建器的一部分，您可能会返回字符串构建器。否则我会返回一个字符串。

如果这是公共 API 的一部分，我会倾向于返回字符串而不是构建器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T12:55:32.757

我会说该方法应该返回 sb.ToString()。如果围绕创建 StringBuilder() 对象的逻辑应该在未来发生变化，对我来说，在方法中更改它是有意义的，而不是在调用该方法然后继续做其他事情的每个场景中

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T13:05:08.380

`StringBuilder`是您的方法的实现细节。您应该返回字符串，直到它成为性能问题，此时您应该探索另一种模式（如[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)），它可以帮助您引入间接并保护您免受内部实现决策的影响。

字符串始终存储在堆中，因此如果返回类型为字符串，您将返回一个引用。但是，您不能指望两个相同的字符串具有相同的引用。通常，将字符串视为值类型是安全的，即使它实际上是引用类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T12:55:55.220

这取决于您计划对输出做什么。我会亲自返回一个字符串。这样，如果您需要在以后更改方法以不使用字符串生成器，则可以，因为您不会将其作为返回值。

想了一会儿，答案就清楚多了。问哪个应该返回的问题确实回答了这个问题。返回对象应该是一个字符串。原因是，如果您问这个问题，“是否有理由在字符串可行时返回 StringBuilder 对象？” 那么答案是否定的。如果有原因，那么返回字符串是不可能的，因为需要 stringbuilder 的方法和属性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T12:56:21.333

我认为这取决于您在离开方法后对字符串执行的操作。如果您要继续附加到它，那么您可能需要考虑返回一个 stringbuilder 以提高效率。如果您总是要在其上调用 .ToString() ，那么您应该在方法内部执行此操作以更好地封装。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-07T12:57:36.340

在几乎所有情况下，我都会返回 a `string`，特别是如果该方法是公共 API 的一部分。

如果您的方法只是更大的私有“构建器”进程的一部分，并且调用代码将进行进一步的操作，则例外情况。在那种情况下，我可能会考虑返回一个`StringBuilder`.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-07T13:01:04.600

既然你不会再修改它了

```
return sb.ToString(); 
```

应该是最有效的

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-07T13:03:41.473

返回 sb.ToString()。您的方法应该只专注于手头的东西（在这种情况下为我构建一个字符串）而不是返回以进一步操作 IMO，您可能会遇到各种问题，因为它没有被处理。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-07T12:55:40.213

如果您需要向字符串附加更多内容并使用其他与字符串生成器相关的功能，请返回字符串生成器。否则，如果您只是使用字符串本身，请返回该字符串。

还有其他更多的技术考虑，但这是最高级别的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-07T13:16:08.870

该方法被赋予了一个具体的任务，应该期望它完成它并返回不需要进一步处理的完成结果。仅在您真正需要时才返回 StringBuilder。在这种情况下，还要在方法名称中添加一些内容以表明您正在返回一些特殊的内容。

# php - 在php中创建超全局变量？

> ID：834491
> 
> 赞同：61
> 
> 时间：2009-05-07T12:55:36.470
> 
> 标签：php

有没有办法创建我自己的自定义超全局变量，如 $_POST 和 $_GET？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-07T13:58:44.803

静态类变量可以被全局引用，例如：

```
class myGlobals {

   static $myVariable;

}

function a() {

  print myGlobals::$myVariable;

} 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2014-05-13T17:35:34.043

是的，这是可能的，但不能使用所谓的“核心”PHP 功能。您必须安装一个名为[runkit7](https://www.php.net/manual/en/book.runkit7.php)的扩展： [安装](https://www.php.net/manual/en/runkit7.installation.php)

之后，您可以在 php.ini 中设置自定义超全局变量，如下所述： [ini.runkit.superglobal](https://www.php.net/manual/en/runkit7.configuration.php#ini.runkit.superglobal)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-07T14:20:34.347

我想你已经有了它——你在全局空间中创建的每个变量都可以使用`$GLOBALS`超全局来访问，如下所示：

```
// in global space
$myVar = "hello";

// inside a function
function foo() {
    echo $GLOBALS['myVar'];
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-05-08T13:58:27.557

```
 Class Registry {
 private $vars = array();
 public function __set($index, $value){$this->vars[$index] = $value;}
 public function __get($index){return $this->vars[$index];}
}
$registry = new Registry;

function _REGISTRY(){
    global $registry;
    return $registry;
}

_REGISTRY()->sampleArray=array(1,2,'red','white');

//_REGISTRY()->someOtherClassName = new className;
//_REGISTRY()->someOtherClassName->dosomething();

class sampleClass {
    public function sampleMethod(){
        print_r(_REGISTRY()->sampleArray); echo '<br/>';
        _REGISTRY()->sampleVar='value';
        echo _REGISTRY()->sampleVar.'<br/>';

    }
}

$whatever = new sampleClass;

$whatever->sampleMethod(); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-09-23T18:23:02.450

解决此问题的另一种方法是使用静态类方法或变量。

例如：

```
class myGlobals {

   public static $myVariable;

} 
```

然后，在您的函数中，您可以像这样简单地引用您的全局变量：

```
function Test()
{
 echo myGlobals::$myVariable;
} 
```

不像其他一些语言那样干净，但至少你不必一直声明它是全局的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-07T12:59:56.693

并不真地。虽然如果你不介意它的丑陋，你可以滥用那里的那些。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-09-25T18:12:55.233

**不**

[本手册](http://php.net/manual/en/language.variables.superglobals.php)中仅列出了内置的超全局变量

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-07T15:59:06.713

您还可以使用服务器的环境变量，并在 PHP 中访问这些变量如果您拥有并专门使用服务器，这可能是存储全局数据库访问权限的好方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-12-23T10:14:33.490

可能的解决方法**`$GLOBALS`**：

**文件.php：**

```
$GLOBALS['xyz'] = "hello"; 
```

**any_included_file.php：**

```
echo $GLOBALS['xyz']; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-03-15T23:18:13.167

一种解决方案是在一个单独的 php 文件中创建您的超全局变量，然后使用该`auto_prepend_file`指令在每个 php 调用中自动加载该文件。

重新启动您的 php 服务器后，这样的事情应该可以工作（您的 ini 文件位置可能不同）：

**/usr/local/etc/php/conf.d/load-my-custom-superglobals.ini**

```
auto_prepend_file=/var/www/html/superglobals.php 
```

**/var/www/html/superglobals.php**

```
<?php
  $_GLOBALS['_MY_SUPER_GLOBAL'] = 'example'; 
```

**/var/www/html/index.php**

```
<?php
  echo $_MY_SUPER_GLOBAL; 
```

# winforms - 如何绑定动态加载的 DataGridViews？

> ID：834512
> 
> 赞同：0
> 
> 时间：2009-05-07T12:59:29.987
> 
> 标签：winforms, datagridview, datasource

我正在 VS2008 中开发一个 Windows 窗体应用程序。我想在表单上显示一个未知但数量很少的 DataGridView，使用如下代码：

```
foreach (QueryFilter f in Query.Filter)
{                    
    DataGridView grid = CreateGridView(String.Format("GridView{0}", filters.Count));
    grid.Location = new System.Drawing.Point(3, 9 + (filters.Count * grid.Height + 9));
    BindingList<QueryFilterNode> nodes = new BindingList<QueryFilterNode>();
    foreach (QueryFilterNode node in f)
        nodes.Add(node);
    grid.DataSource = nodes;
    panel1.Controls.Add(grid);
    filters.Add(nodes);                    
} 
```

网格被添加到面板中，但不显示里面的数据。我的猜测是设置 DataSource 属性实际上并没有绑定网格，因为（例如） dataGridView_ColumnAdded 事件没有被触发。

QueryFilter 和 QueryFilterNode 只是 POCO，当然包含数据。

为了完整起见，DataGridView 的构造：

```
private DataGridView CreateGridView(string name)
{
    DataGridView grid = new DataGridView();
    grid.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;            
    grid.Name = name;
    grid.Size = new System.Drawing.Size(484, 120);
    grid.ColumnAdded += new System.Windows.Forms.DataGridViewColumnEventHandler(this.dataGridView_ColumnAdded);
    return grid;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T15:01:42.187

嗯，看来是我自己的错。用作数据源 ( `BindingList<QueryFilterNode>`) 的 QueryFilterNode 不是 POCO，而是数据合约。片段：

```
[DataContract(Name = "QueryFilterNode")]
public class QueryFilterNode
{
  [DataMember(IsRequired = true)]
  public string FieldCode; 
```

由于某种原因，这些不能是数据绑定的。我在我的 BindingList 中使用了一个像这样的简单类，它就可以工作了。

```
class QueryFilterNodeSimple
{

  public string FieldCode
  { get; set; } 
```

# documentation - 记录 XSD 的简便方法？

> ID：834516
> 
> 赞同：1
> 
> 时间：2009-05-07T13:00:32.510
> 
> 标签：documentation, xsd

我们最近开始通过 XML 向客户提供数据提取。我们有一个定义此 XML 结构的模式 (XSD)。我想在架构本身中包含元素和属性的文档。我唯一发现的是非常繁琐的“注释”和“文档”标签。

因此，您需要像这样简单易读的东西：

```
<xs:element name="TransactionType" type="xs:string"  /> 
```

最后得到这个丑陋的烂摊子：

```
<xs:element name="TransactionType" type="xs:string">
    <xs:annotation>
        <xs:documentation>
            Type of transaction
        </xs:documentation>
    </xs:annotation>
</xs:element> 
```

有更好的吗？说这样的话：

```
<xs:element name="TransactionType" type="xs:string" description="Type of transaction"  /> 
```

PS：我们已经以简单的固定长度文件和 CSV 格式提供了此摘录。一个客户请求了 XML，而我们现在有第二个客户想要使用 XML。我被要求提供文件。我们最初为其开发 XML 版本的第一个客户只是想要一个 XSD。因此，我希望只向第二个客户发送一份文档——带有描述元素的简单注释的 XSD。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T13:39:52.853

您是否知道您可以轻松地将您的 XSD（即使使用繁琐的注释和文档标签）转换为可读性相当好的 HTML 文档文件？

魔术被称为[xs3p](http://xml.fiforms.org/xs3p/)，它是一个相当大的 XSLT 文件，可以将您的 XSD（毕竟它只是另一个 XML）转换为结构良好、非常有用的文档 HTML。

它是免费的，它可以工作 - 太棒了！:-)

当然 - 您仍然必须将注释/文档添加到您的 XSD，但它可能是比拥有 XSD 和单独的文档文件更好的解决方案（很可能迟早会不同步...... )

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T13:03:00.820

不，那里没有。`<xs:annotation><xs:documentation>`就是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T13:04:48.553

XSD 提供您提到的文档标签。我同意你的看法，它们很麻烦，会使你的文件更大。

不幸的是，这就是我们所拥有的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:32:21.200

是的，这很麻烦，但不幸的是，它是唯一的文档机制。但是，提供注释标签是为了满足许多需求。你可以把计算机处理指令放在那里，你可以把人类可读的文档放在那里。

我认为 XSD 的设计更多是为了有效地将信息传递给计算机程序。例如，如果您从模式运行代码生成器，则代码生成器可以在代码自文档中包含注释元素信息，例如 JavaDoc 或其他语言的等效项。

此外，注释文档标签可以包括任意长度的文本。它可以包含 HTML 标记，实际上可以包含任意 XML。这就是为什么它不是一个属性，而是一个元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T13:43:17.400

我有一个建议 - 你为什么不按照你建议的方式编写模式，即

```
<xs:element name="TransactionType" type="xs:string" description="Type of transaction" /> 
```

并通过 XSLT 将其转换为完整格式

```
<xs:element name="TransactionType" type="xs:string"> 
 <xs:annotation> 
  <xs:documentation> Type of transaction </xs:documentation> 
 </xs:annotation> 
</xs:element> 
```

您将转换后的 XSD 分发给客户，在内部使用紧凑版本。

# c# - 如何在 C# ASP.NET 中生成 .zip 文件并将其发送给用户？

> ID：834527
> 
> 赞同：12
> 
> 时间：2009-05-07T13:02:07.780
> 
> 标签：c#, asp.net, file, zip

我需要构建一个 zip 并将其发送给用户。

我已经看到了做一个或另一个的例子，但不是两者兼而有之，并且很好奇是否有任何“最佳实践”或任何东西。

对困惑感到抱歉。我将为网络用户即时生成 zip，并在 HTTP 响应中将其发送给他们。不在电子邮件中。

标记

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-07T13:17:36.977

[我会支持SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)创建 Zip 文件的投票。然后，您需要将响应标头附加到输出以强制下载对话框。

[http://aspalliance.com/259](http://aspalliance.com/259)

应该给你一个很好的起点来实现这一点。您基本上需要添加响应头，设置内容类型并将文件写入输出流：

```
Response.AppendHeader( "content-disposition", "attachment; filename=" + name );
Response.ContentType = "application/zip";
Response.WriteFile(pathToFile); 
```

如果您不想保存到临时文件，最后一行可以更改为 Response.Write(filecontents) 。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-08T16:54:49.607

[DotNetZip](http://dotnetzip.codeplex.com)让您可以轻松完成此操作，而无需写入服务器上的磁盘文件。您可以将 zip 存档直接写入响应流，这将导致下载对话框在浏览器上弹出。

[DotNetZip 的示例 ASP.NET 代码](http://cheeso.members.winisp.net/DotNetZipHelp/Example-ASPNET.htm)

[DotNetZip 的更多示例 ASP.NET 代码](http://code.msdn.microsoft.com/DotNetZip/Wiki/View.aspx?title=ASP.NET%20Example)

剪辑：

```
 Response.Clear();
    Response.BufferOutput = false; // false = stream immediately
    System.Web.HttpContext c= System.Web.HttpContext.Current;
    String ReadmeText= String.Format("README.TXT\n\nHello!\n\n" + 
                                     "This is text for a readme.");
    string archiveName= String.Format("archive-{0}.zip", 
                                      DateTime.Now.ToString("yyyy-MMM-dd-HHmmss")); 
    Response.ContentType = "application/zip";
    Response.AddHeader("content-disposition", "filename=" + archiveName);

    using (ZipFile zip = new ZipFile())
    {
        zip.AddFiles(f, "files");            
        zip.AddFileFromString("Readme.txt", "", ReadmeText);
        zip.Save(Response.OutputStream);
    }
    Response.Close(); 
```

或在 VB.NET 中：

```
 Response.Clear
    Response.BufferOutput= false
    Dim ReadmeText As String= "README.TXT\n\nHello!\n\n" & _
                              "This is a zip file that was generated in ASP.NET"
    Dim archiveName as String= String.Format("archive-{0}.zip", _
               DateTime.Now.ToString("yyyy-MMM-dd-HHmmss"))
    Response.ContentType = "application/zip"
    Response.AddHeader("content-disposition", "filename=" + archiveName)

    Using zip as new ZipFile()
        zip.AddEntry("Readme.txt", "", ReadmeText, Encoding.Default)
        '' filesToInclude is a string[] or List<String>
        zip.AddFiles(filesToInclude, "files")            
        zip.Save(Response.OutputStream)
    End Using
    Response.Close 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T13:05:32.577

我相信其他人会推荐[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)

你打算如何“发送”它。.NET 内置了通过 SMTP 发送电子邮件的库

**编辑**

在这种情况下，您需要从 SharpZipLib 捕获输出流并将其直接写入响应。只需确保您在响应标头（应用程序/zip）中设置了正确的 Mimetype，并确保您没有 Response.Write 任何其他内容给用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:18:47.117

同意上面的[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)，用于在 .NET 中创建 .zip 文件，这似乎是一个非常流行的选择。

*至于“发送”，如果您的意思是通过 SMTP/电子邮件，您将需要使用 System.Net.Mail 名称空间。[System.Net.Mail.Attachment](http://msdn.microsoft.com/en-us/library/system.net.mail.attachment.aspx) Class 文档有一个如何通过电子邮件发送文件的示例*

从头开始，当我发布此内容时，我看到您的意思是通过 HTTP 响应返回。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-06T15:34:59.817

一个问题是您将流式传输到客户端的文件的大小。如果您使用 SharpZipLib 在内存中构建 ZIP，则无需清理任何临时文件，但如果文件很大并且许多并发用户正在下载文件，您很快就会遇到内存问题。（当 ZIP 大小达到 200 MB+ 范围时，我们经常遇到这种情况。）我通过临时文件到磁盘来解决这个问题，将其流式传输给用户，然后在请求完成时将其删除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-26T13:28:23.417

DotNetZip 创建流时不会在服务器上保存任何资源，因此您无需记住删除任何内容。正如我之前所说，它的编码快速直观，实现高效。

摩西

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-09T18:38:57.603

我修改了一些代码如下，我使用 System.IO.Compression

```
 public static void Zip(HttpResponse Response, HttpServerUtility Server, string[] pathes)
    {
        Response.Clear();
        Response.BufferOutput = false;         

        string archiveName = String.Format("archive-{0}.zip",
                                          DateTime.Now.ToString("yyyy-MMM-dd-HHmmss"));
        Response.ContentType = "application/zip";
        Response.AddHeader("content-disposition", "filename=" + archiveName);

        var path = Server.MapPath(@"../TempFile/TempFile" + DateTime.Now.Ticks);
        if (!Directory.Exists(Server.MapPath(@"../TempFile")))
            Directory.CreateDirectory(Server.MapPath(@"../TempFile"));

        if (!Directory.Exists(path))
            Directory.CreateDirectory(path);
        var pathzipfile = Server.MapPath(@"../TempFile/zip_" + DateTime.Now.Ticks + ".zip");
        for (int i = 0; i < pathes.Length; i++)
        {
            string dst = Path.Combine(path, Path.GetFileName(pathes[i]));
            File.Copy(pathes[i], dst);
        }
        if (File.Exists(pathzipfile))
            File.Delete(pathzipfile);
        ZipFile.CreateFromDirectory(path, pathzipfile);
        {
            byte[] bytes = File.ReadAllBytes(pathzipfile);
            Response.OutputStream.Write(bytes, 0, bytes.Length);
        }
        Response.Close();
        File.Delete(pathzipfile);
        Directory.Delete(path, true);
    } 
```

此代码获取一些包含文件列表的列表，将它们复制到临时文件夹中，创建临时 zip 文件，然后读取该文件的所有字节并在响应流中发送字节，最后删除临时文件和文件夹

# wpf - Making a WPF TabControl ignore Ctrl+Tab

> ID：834548
> 
> 赞同：2
> 
> 时间：2009-05-07T13:05:54.743
> 
> 标签：wpf, tabcontrol, keydown

I'm writing an app that uses the "tabbed browsing" metaphor, with a TabControl the full size of the window, and other stuff inside the tabs. Sometimes those tabs will themselves contain other TabControls.

(Tabs inside tabs can be confusing, so I'll re-style the inner TabControl so it doesn't look like a TabControl. I'll probably style it to use ToggleButtons at the top instead of tabs.)

I want this UI to behave like you would expect the tabbed-browsing metaphor to work: `Ctrl`+`Tab` should always switch tabs on the outer TabControl (the one that looks like a TabControl), even if keyboard focus is inside the inner TabControl (which doesn't look like a TabControl, and therefore shouldn't be expected to respond to `Ctrl`+`Tab`). But, of course, the inner TabControl gets the key event first and handles it itself.

What's the best way to keep the inner TabControl from responding to the `Ctrl`+`Tab` and `Ctrl`+`Shift`+`Tab` key events, so those events can bubble up to the outer TabControl?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T13:37:21.300

WPF TabControl 似乎通过 OnKeyDown 方法管理键盘导航功能。我建议创建一个从 TabControl 继承的自定义控件，并覆盖 OnKeyDown 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T16:18:16.670

作为[此处](https://stackoverflow.com/a/834685/1163)建议的创建自定义控件的替代方法，您可以创建一个“附加行为”来封装它：

```
namespace WpfApplication1
{
  using System.Windows;
  using System.Windows.Input;

  public static class IgnoreCtrlTabBehaviour
  {
    //Setter for use in XAML: this "enables" this behaviour
    public static void SetEnabled(DependencyObject depObj, bool value)
    {
      depObj.SetValue(EnabledProperty, value);
    }

    public static readonly DependencyProperty EnabledProperty =
        DependencyProperty.RegisterAttached("Enabled", typeof(bool), 
        typeof(IgnoreCtrlTabBehaviour), 
        new FrameworkPropertyMetadata(false, OnEnabledSet));

    static void OnEnabledSet(DependencyObject depObj, DependencyPropertyChangedEventArgs args)
    {
      var uiElement = depObj as UIElement;
      uiElement.PreviewKeyDown += 
        (object _, System.Windows.Input.KeyEventArgs e) => 
        {
          if (e.Key == Key.Tab && 
              (Keyboard.Modifiers & ModifierKeys.Control) == ModifierKeys.Control)
          {
            e.Handled = true;
          }
        };
      }
    }
  } 
```

像这样在 XAML 中使用：

```
<Window x:Class="WpfApplication1.MainWindow"
    ...
    xmlns:local="clr-namespace:WpfApplication1"

...
<TabControl local:IgnoreCtrlTabBehaviour.Enabled="True">
  <TabItem Header="tab1">
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T13:46:04.490

您可以在内部 TabControl 上处理 PreviewKeyDown 事件并设置 e.Handled = true 以防止它处理关键事件。然后，您可以找到父 TabControl（可能通过 ((TabControl)sender).Parent 递归）并以编程方式更改其 SelectedIndex。

将其包装在自定义控件中将使其保持相当干净。

# user-interface - Large fields on ScrolledComposite results in too much scrolling

> ID：834556
> 
> 赞同：1
> 
> 时间：2009-05-07T13:07:51.213
> 
> 标签：user-interface, scroll, swt

I have a ScrolledComposite which is a bit like an spreadsheet. It works mostly without problems, but I sometimes have a large field that fills almost an entire row (the rightmost part).

When focus is on this field, and setShowFocusedControl(true) has been called, swt insists on showing the rightmost part of the field, which has the same effect as scrolling all the way to the right on a big spreadsheet - it is very annoying for the user, as the field rarely has very much text in it.

So the strategy chosen in the code is to setShowFocusedControl on and off all the time, which is very bug-prone.

Can someone suggest a better strategy? Can I make swt show the leftmost part of the focussed field?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T13:16:03.050

you can use setOrigin(Point) or setOrigin(int, int) on the ScrolledComposite to set the origin of the scrolled content at the top left.

# ajax - AJAX + Hebrew letters

> ID：834558
> 
> 赞同：2
> 
> 时间：2009-05-07T13:08:49.930
> 
> 标签：ajax, hebrew

I send by XMLRequest Hebrew letters to Servlet, at xmlRequest it's still Hebrew, in servlet I receive weird letters,.Java works on Unicode how to convert letters from textarea to Unicode t send to servlet

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T13:12:30.890

Does your XMLRequest specify charset? That's a common source of character mangling.

```
Content-Type: text/xml; charset=utf-8 
```

# windows - 从“ncalrpc”切换到“ncacn_np”可能出现的问题

> ID：834560
> 
> 赞同：1
> 
> 时间：2009-05-07T13:09:40.070
> 
> 标签：windows, windows-vista, rpc

我有一个使用 RPC 进行进程间通信的应用程序。事实证明，在 Vista 上不允许使用与“ncalrpc”协议序列一起使用的同步 RPC 管道。我想切换到“ncacn_np”并使用带有 RPC_IF_ALLOW_LOCAL_ONLY 标志的 RpcServerRegisterEpEx()。

有没有人尝试过同样的方法？这种过渡是否存在任何可能的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T14:57:48.267

您已经看到了有关标志使用的信息：

[...注册此接口标志后，RPC 运行时拒绝远程客户端进行的调用。所有使用 ncadg_* 和 ncacn_* 协议序列的本地调用也会被拒绝，但 ncacn_np 除外。仅当调用不是来自 SRV 时，RPC 才允许调用 ncacn_NP。来自 ncalrpc 的调用总是被处理...](http://msdn.microsoft.com/en-us/library/aa373954(VS.85).aspx)

本地 RPC 真正使用 LPC（Microsoft Windows Internals 4 ed，来自第 802 页）：
本地 RPC 可用于位于同一系统上的两个进程之间的通信，并且 RPC 运行时 DLL 使用本地过程调用 (LPC) 工具在内核模式下作为本地网络 API。

[已编辑]
更多帮助[如何解决由 RPC 客户端协议注册表项引起的连接问题](http://support.microsoft.com/kb/325930)

# nhibernate - 如何使用 NHibernate 创建多列索引或唯一约束

> ID：834565
> 
> 赞同：15
> 
> 时间：2009-05-07T13:10:57.510
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

如何使用 NHibernate 映射或 Fluent NHibernate 创建多列索引和/或唯一约束。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-07T13:26:53.290

将索引/唯一约束名称分配给多个属性

```
<property name="A" index="AB" />
<property name="B" index="AB" /> 
```

* * *

理论上，它也适用于在同一实体上拥有多个索引：

```
<property name="A" index="AB, ABC" />
<property name="B" index="AB, ABC" />
<property name="C" index="ABC" /> 
```

[但是有一个错误。](http://216.121.112.228/browse/NH-1487)我还写了一个补丁。如果您对此感兴趣，请为该错误投票或添加评论或其他内容。

**编辑**：刚刚检查了发生了什么[错误](http://216.121.112.228/browse/NH-1487)。它已在 2.1.0 版本中修复，因此现在应该可以完美运行。非常感谢伟大的 NHibernate 开发团队！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-08-18T01:52:10.177

旧的，但我有一些东西要补充，因为我遇到了同样的问题：

[Stefan Steinegger](https://stackoverflow.com/users/27343/stefan-steinegger)正确回答了*非*唯一多列索引，但省略了*唯一*多列索引的代码。对于那些你可以使用：

```
<property name="A" unique-key="AB" />
<property name="B" unique-key="AB" /> 
```

因此，本质上相同，但属性名称不同。

* * *

需要注意的一件有趣的事情是，对于唯一索引，NHibernate 会为键生成自己的名称，但对于非唯一索引，它会使用您提供的任何名称。

例如，上面的代码不会生成一个名为“AB”的唯一索引，而是生成类似`UQ__TableName__7944C87104A02EF4`.

这记录在NHibernate 文档的[第 19.1.1 节中：](http://nhforge.org/doc/nh/en/index.html#toolsetguide-s1-2)

> 一些标签接受一个`index`属性来指定该列的索引名称。属性可`unique-key`用于对单个单元键约束中的列进行分组。目前，unique-key 属性的指定值*不*用于命名约束，仅用于对映射文件中的列进行分组。

但是以下内容：

```
<property name="A" index="AB" />
<property name="B" index="AB" /> 
```

只会生成一个名为“AB”的索引。

# iphone - How can I invoke a method automatically 20 times per second?

> ID：834566
> 
> 赞同：0
> 
> 时间：2009-05-07T13:10:57.617
> 
> 标签：iphone, cocoa-touch, uikit

From JavaScript I am used to create an interval and specify the delay for re-calling the function, until I stop the interval. Is there something similar available on the iPhone? Any good links are highly appreciated. This goes to community wiki.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T13:17:55.260

```
//create and start timer

[NSTimer scheduledTimerWithTimeInterval: 0.05 target: self selector: @selector(timerMethod:) userInfo: nil repeats: YES];

// method works 20 times per second
-(void) timerMethod: (NSTimer*)theTimer {
NSLog(@"timer is working");
} 
```

# python - How to do fuzzy string search without a heavy database?

> ID：834570
> 
> 赞同：7
> 
> 时间：2009-05-07T13:11:30.533
> 
> 标签：python, database, full-text-search, fuzzy-search

I have a mapping of catalog numbers to product names:

```
35  cozy comforter
35  warm blanket
67  pillow 
```

and **need a search that would find misspelled, mixed names like "warm cmfrter"**.

We have code using edit-distance (difflib), but it probably won't scale to the 18000 names.

I achieved something similar with Lucene, but as [PyLucene](http://lucene.apache.org/pylucene/) only wraps Java that would complicate deployment to end-users.

SQLite doesn't usually have full-text or scoring compiled in.

The [Xapian bindings](http://www.xapian.org/docs/bindings/python/) are like C++ and have some learning curve.

[Whoosh](http://whoosh.ca/) is not yet well-documented but includes an abusable spell-checker.

What else is there?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-03T20:46:04.457

显然，快速进行模糊比较的唯一方法是减少它们；）

我们现在保留一个单词索引，而不是编写另一个 n-gram 搜索或改进 Whoosh 中的搜索，检索与查询至少有一个（正确拼写）单词的所有条目，并使用 difflib 对它们进行排名。在这种情况下工作得很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T14:23:58.347

使用 SOUNDEX 实施会得到太多误报。只有 26,000 个（最多）可能的 SOUNDEX 代码。

虽然 Metaphone 算法是为英文姓氏设计的，但它对于拼写错误的效果非常好；我在分支定位器中使用过一次，非常成功。

添加一个带有 Metaphone 翻译的字段，如果没有找到完全匹配，则与之匹配。您仍然会得到误报，但使用其他算法时会更少。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T13:30:32.627

[Nucular](http://nucular.sourceforge.net) 具有全文搜索功能，但不支持开箱即用的拼写错误匹配。您可以尝试向每个条目添加一个附加字段，该字段索引术语的 [SOUNDEX](http://code.activestate.com/recipes/52213/)翻译，然后使用用户输入的 soundex 翻译进行搜索。我真的不知道这会有多好...

看看advas[http://advas.sourceforge.net/news.php](http://advas.sourceforge.net/news.php)有一个很好的演示，比较了各种类似 soundex 的方法：

```
advas/examples Aaron$ python phonetic_algorithms.py 
                    soundex       metaphone           nyiis      caverphone 
====================================================================================================
 schmidt :             S253           sxmtt          sssnad      SKMT111111
  schmid :             S253            sxmt          sssnad      SKMT111111
 schmitt :             S253            sxmt         sssnatt      SKMT111111
   smith :             S530            sm0h           snatt      SMT1111111
  smythe :             S530           smy0h           snatt      SMT1111111
 schmied :             S253            sxmt         sssnaad      SKMT111111
   mayer :             M600             myr           naaar      MA11111111
   meier :             M600              mr           naaar      MA11111111
.... 
```

我不知道它们中的任何一个是否适合您的未命名语言...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T08:20:32.283

计算两个字符串之间的编辑距离的常用方法是一种相当昂贵的算法（如果我没记错的话，它的时间复杂度是二次的）。也许如果您使用不同的字符串相似度指标，那么您的问题就会消失。

我最喜欢的模糊字符串匹配方法之一是[trigrams matching](http://en.wikipedia.org/wiki/N-gram#n-grams_for_approximate_matching)。使用这种方法比较两个字符串具有线性时间复杂度，这比提到的编辑距离要好得多。[你可以在Github](http://github.com/ryszard/python-ngrams/tree/master)上找到我的 Python 实现。还有一个 PostgreSQL [contrib 模块](http://www.postgresql.org/docs/8.3/static/pgtrgm.html)正是为此而生的。让它适应 SQLite3 应该不会太难。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T15:02:52.170

[Sybase SQL Anywhere](http://www.sybase.com/products/databasemanagement/sqlanywhere)有一个免费的 Web 版/开发者版，并带有全文索引/搜索和一个 FUZZY 运算符（以及一些实现约束）。

从文档中引用：

```
Specifying 'FUZZY "500 main street"' is equivalent to 
'500 OR mai OR ain OR str OR tre OR ree OR eet'. 
```

另一种方法是对全文搜索使用评分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-17T02:58:38.690

sqlite3 支持 python 回调函数。Matthew Barnett 的正则表达式 (http://code.google.com/p/mrab-regex-hg/) 现在支持近似匹配。

所以，像这样：

```
try:
    import regex
except ImportError:
    sys.stderr.write("Can't import mrab-regex; see http://pypi.python.org/pypi/regex\n")
    sys.exit(1)

def _sqlite3_regex(expr, item):
    return (not (not regex.search(expr, item)))

def main():
    ...
    database = sqlite3.connect(dbfile)
    database.create_function("regexp", 2, _sqlite3_regex)
    pattern = '(?:%s){e<=%d}' % (queriedname, distance)
    print [x for x in database.cursor().execute(
         "SELECT * FROM products WHERE (productname regexp '%s')" % pattern)] 
```

# php - How can access the root directory of a folder

> ID：834572
> 
> 赞同：2
> 
> 时间：2009-05-07T13:11:51.453
> 
> 标签：php

recently i worked in a project. the project has one root directory named "Project".the "Project" directory has also two sub-directory named "project_a" and "project_b". the "project_b" directory has two more sub-directory named "project_b_1" and "project_b_2". when i am on a page which is contains "project_b_2" directory then how can i access a file which is exists in the "project_a" directory. all code must be php code.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T13:34:36.983

Using`$_SERVER['DOCUMENT_ROOT']`将始终引用根在您定义的站点/虚拟主机等中的位置。
因此使用这样的东西应该可以工作：

```
fopen($_SERVER['DOCUMENT_ROOT'].'/projectA/subfileB.html'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T14:16:15.823

在“project_b_2”中找到“project_a”相对于脚本的路径：

```
$path = realpath( dirname( __FILE __ ) . '/../../project_a/' ); 
```

找到“project_a”相对于 webroot 的路径：

```
$path = $_SERVER['DOCUMENT_ROOT'] . '/Project/project_a/'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T13:29:08.290

您应该能够在目录树中上去：

```
#when you are in project/project_b/project_b_2
$dir = "../../project_a"; 
```

这是我通常遵循的方式，虽然你可以使用

```
$_SERVER["SITE_HTMLROOT"] 
```

这应该带您到网站的根目录

# eclipse - Eclipse 的最小主题

> ID：834575
> 
> 赞同：28
> 
> 时间：2009-05-07T13:12:27.503
> 
> 标签：eclipse, user-interface, themes, skin

我刚刚设置了一个新的 10" 上网本，并且刚刚安装了 Eclipse 进行一些开发。即使在大屏幕上，我也发现 Eclipse 的 GUI 非常笨重且难以使用，而现在在小屏幕上，真正的留给实际编码的空间非常小。是否可以将主题或皮肤应用到 Eclipse 以使其更小？你知道小屏幕有什么好的主题吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-07T13:28:32.817

如果我最大化编辑器 (Ctrl-M) 并使用[Eclipse 全屏插件](http://code.google.com/p/eclipse-fullscreen/)，我会发现 Eclipse 在我的 10" 上网本上非常有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-07T13:54:36.530

如果可以的话，请让我在[我的博客文章中添加一个关于在 Eee PC 901 上运行 Eclipse](http://devblog.coobird.net/2008/12/10/using-eclipse-on-an-asus-eee-pc/)的插件，它有一个 8.9 英寸的屏幕，分辨率为 1024 x 600。

我有一些关于如何最大化屏幕空间以便能够在屏幕上显示尽可能多的源代码的技巧。

要点是：

*   竖屏空间是有限的，所以尽量想办法减少窗口的垂直传播。
*   使用减少垂直空间使用量的操作系统主题。例如，在 Windows XP 中使用 Windows 经典主题，以便比默认主题节省 8 个像素。
*   减少 Eclipse 工具栏中的行数。
*   使用 Windows 任务栏的自动隐藏功能在垂直方向再挤压 30 个像素。

应用提示后，1024 x 600 屏幕上的 Eclipse 如下所示：

[![日食屏幕](https://i.stack.imgur.com/Cc0wB.png)](https://i.stack.imgur.com/Cc0wB.png)

（链接到[全尺寸图片](http://coobird.net/img/eclipse-on-eee/eclipse-on-eee-1024-600.png)）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-07T13:27:56.080

我希望这会有所帮助 - [Eclipse 的扩展 VS 演示插件](http://andrei.gmxhome.de/skins/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T13:42:37.557

您可以在 General -> Appearance 下尝试更紧凑的“Eclipse 2.1 Style Presentation”。在同一个地方，您可以将“透视切换器”放在左侧。

但是任何主题都无法改变这样一个事实，即 10" 屏幕对于像 eclipse 这样的多视图 IDE 来说太小了。解决这个问题的唯一方法是更像传统编辑器一样使用它，即消除所有视图，除了编辑器到[快速视图栏](http://cfblog.com/cgriefer/index.cfm/id/my_eclipse_perspective)并尽可能多地学习使用[热键，例如 Ctrl-O 代替单独的大纲视图，F5、F6 和 F7 代替调试视图中的图标等。](http://gwt.org.ua/en/blog/2008/03/24/eclipse-hotkeys/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-07T07:00:41.220

我使用基于 Eclipse 的 SpringSource Tool Suite。我在 9" 笔记本上运行它。我放弃了尝试寻找插件来改善视图，但我所做的是右键单击停靠在主编辑区域右侧、左侧和底部的每个窗口并选择 "快速查看”。这会将这些窗口最小化为屏幕最底部工具栏上的图标，将大部分屏幕空间留给编辑器窗口。它似乎工作正常。如果我需要访问包资源管理器等。我只需单击图标来显示它，然后再次隐藏它。我觉得它非常有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-14T10:36:04.467

我刚刚在我的 lenovo s10-3t 上网本上设置了一个新的 Ubuntu 分区并在上面安装了 Eclipse。

鉴于稀缺的屏幕空间，我正在尝试的一件事是**将所有字体大小减少**到 7/8/9。不过，这显然是对眼睛的一种压力。

Linux中的系统字体，系统->首选项->外观-> Eclipse中的字体，窗口->首选项->常规->外观->颜色和字体

# jquery - 如何使背景可点击

> ID：834579
> 
> 赞同：3
> 
> 时间：2009-05-07T13:12:35.740
> 
> 标签：jquery, html, css

我被要求为我们的一个网站制作赞助背景（网站接管），并且出现了我是否可以使平铺背景中的徽标可点击的问题。

我最初的想法是“不”，但我越想越觉得如果我使用 JavaScript 使 body 元素可点击，或者将背景图像伪装成内容下方的图层并制作那个可点击的。

以前有没有人通过这些方法中的一种或不同的方法成功地做到了这一点？

jQuery：

```
$('body').click() 
```

HTML：

```
<body>
  <div id="sponsors-div" style="position:fixed;z-index:0;"><a style="display:block;height:100%" href="http://sponsors.url"></a></div>
  <div id="site-container" style="position:relative;z-index:1;">... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T13:50:28.507

您需要注意 IE 和 Mozilla 之间的事件顺序（事件捕获与冒泡）差异。如果您有一个元素的 onClick 事件基本上占据了整个页面，然后在其“顶部”有其他可点击元素，则单击其中一个元素可能会触发 BOTH 事件，这可能不是预期的功能。

[PPK](http://www.quirksmode.org/js/events_order.html)比我解释得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:15:30.603

为什么不把背景图片做成图片地图，给每个区域绑定一个点击事件：

```
$('#area51').click(function() {... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T13:17:39.053

赞助商 div 上的点击事件应该可以工作。将它放在正文上可能会影响页面的其他部分（正文的子元素）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T15:31:53.287

您可以制作一个非常大的锚标记并强制正文隐藏溢出，如下所示：

```
html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
} 
```

从这个网站获得一些灵感：http: [//newline.dk/index.aspx](http://newline.dk/index.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-01T22:04:34.993

我为此写了一个解决方案，因为我找不到一个完整的跨浏览器。它旨在托管和显示跨站点网络的可点击赞助商背景。

将此代码放入 js 文件并将其托管在中央域上：

```
$(function () {
//** change these values to your own
var bg_ad_css = "url(http://cdn.my-domain.com/sponsor-bg.jpg) no-repeat center top #ffffff";
var bg_ad_url = "http://www.sponsor-website.com/";
//**
var bg_ad_anchor = $(document.createElement("a"));
bg_ad_anchor.css({ display: "block", position: "absolute", "z-index": 0, top: 0, left: 0, width: $(window).width(), height: $(window).height() });
bg_ad_anchor.attr("target", "_blank").attr("href", bg_ad_url);
$(window).resize(function () {
    if (bg_ad_anchor) {
        bg_ad_anchor.css({ width: $(window).width(), height: $(window).height() });
    }
});
if (window._bg_ad) {
    for (var i = 0; i < _bg_ad.contentWrappers.length; i++) {
        var element = _bg_ad.contentWrappers[i];
        $(element.selector).css({ position: "relative", "z-index": element.zIndex == undefined ? 1 : element.zIndex });
    }
}
$("body").css({ "background": bg_ad_css }).append(bg_ad_anchor); 
```

});

然后在一个或多个网站中使用它：

```
<script type="text/javascript">
    var _bg_ad = {
        //These should be content areas that need to be above the banner link
        //You may only need one element in this array, customize at will
        contentWrappers: [{ selector: "#top_bar", zIndex: 2 }, { selector: "#wrapper" }, { selector: "#footerBottom" }]
    };
</script>
<script type="text/javascript" src="http://www.my-domain.com/js/bg-ad.js"></script> 
```

# java - 远程 JMX 连接

> ID：834581
> 
> 赞同：103
> 
> 时间：2009-05-07T13:12:39.813
> 
> 标签：java, jmx, jconsole

我正在尝试打开与远程机器上运行的 java 应用程序的 JMX 连接。

应用程序 JVM 配置有以下选项：

*   com.sun.management.jmxremote
*   com.sun.management.jmxremote.port=1088
*   com.sun.management.jmxremote.authenticate=false
*   com.sun.management.jmxremote.ssl=false

我可以`localhost:1088`使用 jconsole 或 jvisualvm 进行连接。但我无法使用`xxx.xxx.xxx.xxx:1088`远程机器进行连接。

服务器之间或操作系统上没有防火墙。但是为了消除这种可能性`telnet xxx.xxx.xxx.xxx 1088`，我认为它是连接的，因为控制台屏幕变成空白。

两台服务器都是 Windows Server 2008 x64。尝试使用 64 位 JVM 和 32 位，均无效。

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-05-07T13:31:17.163

如果它在 Linux 上，问题将是*localhost 是环回接口*，您需要应用程序绑定到您的*网络接口*。

您可以使用 netstat 确认它没有绑定到预期的网络接口。

您可以通过使用系统参数调用程序来完成这项工作`java.rmi.server.hostname="YOUR_IP"`，无论是作为环境变量还是使用

```
java -Djava.rmi.server.hostname=YOUR_IP YOUR_APP 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2012-07-25T16:24:48.217

我花了一天多的时间试图让 JMX 在本地主机之外工作。似乎 SUN/Oracle 未能提供有关这方面的良好文档。

确保以下命令返回一个真实的 IP 或 HOSTNAME。如果它确实返回 127.0.0.1、127.0.1.1 或 localhost 之类的内容，它将不起作用，您将不得不更新`/etc/hosts`文件。

```
hostname -i 
```

这是即使从外部启用 JMX 所需的命令

```
-Dcom.sun.management.jmxremote 
-Dcom.sun.management.jmxremote.authenticate=false 
-Dcom.sun.management.jmxremote.ssl=false 
-Dcom.sun.management.jmxremote.port=1100
-Djava.rmi.server.hostname=myserver.example.com 
```

如您所料， myserver.example.com 必须与`hostname -i`返回的内容匹配。

显然，您需要确保防火墙不会阻止您，但我几乎可以肯定这不是您的问题，问题是未记录的最后一个参数。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2016-10-05T18:14:04.857

在我对 Tomcat 和 Java 8 的测试中，除了为 JMX 指定的端口之外，JVM 还打开了一个临时端口。以下代码修复了我；如果您的 JMX 客户端出现问题（例如[VisualVM](https://visualvm.github.io)未连接），请尝试一下。

```
-Dcom.sun.management.jmxremote.port=8989
-Dcom.sun.management.jmxremote.rmi.port=8989 
```

另请参阅[配置 JMX 时为什么 Java 会打开 3 个端口？](https://stackoverflow.com/questions/20884353/why-java-opens-3-ports-when-jmx-is-configured/21552812#21552812)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-09-08T21:04:18.133

[http://blogs.oracle.com/jmxetc/entry/troubleshooting_connection_problems_in_jconsole](http://blogs.oracle.com/jmxetc/entry/troubleshooting_connection_problems_in_jconsole)

如果您尝试访问位于 NAT 后面的服务器 - 您很可能必须使用该选项启动服务器

```
-Djava.rmi.server.hostname=<public/NAT address> 
```

这样发送到客户端的 RMI 存根包含服务器的公共地址，允许客户端从外部访问它。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-06-18T10:27:36.083

看起来你的结束语来得太早了。它应该在最后一个参数之后。

这个技巧对我有用。

我注意到一些有趣的事情：当我使用以下命令行启动我的应用程序时：

```
java -Dcom.sun.management.jmxremote.port=9999
     -Dcom.sun.management.jmxremote.authenticate=false
     -Dcom.sun.management.jmxremote.ssl=false 
```

如果我尝试使用 jconsole 从远程计算机连接到此端口，则 TCP 连接成功，在远程 jconsole 和部署了我的 MBean 的本地 jmx 代理之间交换了一些数据，然后 jconsole 显示连接错误消息。我执行了一次wireshark 捕获，它显示了来自代理和jconsole 的数据交换。

因此，这不是网络问题，如果我执行带有或不带有 java.rmi.server.hostname 系统属性的 netstat -an，我有以下绑定：

```
 TCP    0.0.0.0:9999           0.0.0.0:0              LISTENING
 TCP    [::]:9999              [::]:0                 LISTENING 
```

这意味着在这两种情况下，在端口 9999 上创建的套接字都接受来自任何地址的任何主机的连接。

我认为这个系统属性的内容是在连接的某个地方使用的，并与代理用于与 jconsole 通信的实际 IP 地址进行比较。如果这些地址不匹配，则连接失败。

使用 jconsole 从同一主机连接时，我没有遇到此问题，仅从真正的物理远程主机连接。所以，我认为只有当连接来自“外部”时才进行此检查。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-12-02T09:01:22.047

对我有用的是设置 /etc/hosts 将主机名指向 ip 而不是环回接口，然后重新启动我的应用程序。

猫 /etc/hosts

```
127.0.0.1      localhost.localdomain localhost
192.168.0.1    myservername 
```

这是我的配置：

```
-Dcom.sun.management.jmxremote.port=1617 
-Dcom.sun.management.jmxremote.ssl=false 
-Dcom.sun.management.jmxremote.authenticate=false 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-03-11T14:42:49.873

非常感谢，它的工作原理是这样的：

java *-Djava.rmi.server.hostname* = **xxx.xxx.xxx.xxx** -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false - Dcom.sun.management.jmxremote.port=25000 -jar **myjar** .jar

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-09-18T18:12:38.320

我知道这个线程已经很老了，但是还有一个额外的选项会很有帮助。见这里：[https ://realjenius.com/2012/11/21/java7-jmx-tunneling-freedom/](https://realjenius.com/2012/11/21/java7-jmx-tunneling-freedom/)

`-Dcom.sun.management.jmxremote.rmi.port=1099`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-10T20:13:53.253

我有同样的问题，我将任何与本地主机名匹配的主机名更改为 0.0.0.0，在我这样做之后它似乎工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-12-04T08:36:24.260

要启用 JMX 远程，请将以下 VM 参数与 JAVA 命令一起传递。

```
 -Dcom.sun.management.jmxremote 
    -Dcom.sun.management.jmxremote.port=453
    -Dcom.sun.management.jmxremote.authenticate=false                               
    -Dcom.sun.management.jmxremote.ssl=false 
    -Djava.rmi.server.hostname=myDomain.in 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-29T00:14:51.030

试试这个，我测试了在 docker 容器中访问 JMX

> -Dcom.sun.management.jmxremote=true -Djava.rmi.server.hostname=localhost -Dcom.sun.management.jmxremote.port=16000 -Dcom.sun.management.jmxremote.rmi.port=16000 -Dcom.sun .management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false

然后

$ jconsole 本地主机：16000

* * *

## 回答 #12

> 赞同：-12
> 
> 时间：2009-05-07T13:25:21.500

尝试使用高于 3000 的端口。

# sql - SQL 中的 WHILE 循环

> ID：834582
> 
> 赞同：2
> 
> 时间：2009-05-07T13:13:12.870
> 
> 标签：sql, tsql

我有两个表：Holdings 和 Transactions

持股数据如下所示：

```
2009 年 6 月 30 日，A，100
2009 年 6 月 30 日，B，1200
2009 年 6 月 30 日，C，100
2009 年 6 月 30 日，D，100

```

交易数据如下所示：

```
A，2009 年 6 月 5 日，100
B，2009 年 6 月 2 日，400
B，2009 年 6 月 13 日，400
B，2009 年 6 月 28 日，400
C，2009 年 6 月 17 日，100
D，2009 年 6 月 30 日，100

```

我需要完成的是通过持有表并对它们单独存在的交易进行计算。

我能够将所有事务放入临时表并使用 WHILE 循环来处理它们。

```
declare @count int,
        @loopcount int
declare @tblTransactions TABLE
(
ID int identity(1,1),
trtype varchar(10),
trdate datetime,
trvalue int
)
insert into @tblTransactions
select * from Transactions
select @count=@@rowcount
set @loopcount=1
WHILE @loopcount<=count
BEGIN
     select * from @tblTransactions where ID=@loopcount
     set @loopcount=@loopcount+1
END 
```

这一切都很好，但问题是：如果同一控股`trtype`列有多个交易，我需要对“ `trvalue`”进行累计。

不知道如何在不进行第二次循环的情况下进行操作。

帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T13:17:07.213

你试过加入吗？像：

```
select <yourcalculation>
from holdings h
left join transactions t on h.holdingid = t.holdingid 
```

如果您只对事务的聚合感兴趣，则可以使用 GROUP BY：

```
select h.name, sum(t.trvalue)
from holdings h
left join transactions t on h.holdingid = t.holdingid
group by h.holdingid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:21:46.483

使用 GROUP BY 子句来获取您的摘要信息，如果您正在以复杂的方式处理任何其他列，您可以为这些流程使用用户定义的函数。

# java - 用于删除 Java 中的注释的脚本

> ID：834584
> 
> 赞同：1
> 
> 时间：2009-05-07T13:14:25.567
> 
> 标签：java, ant, build-automation

有谁知道如何（或处理）在构建时从 Java 类文件中删除注释？当使用 Ant 构建项目时，我想对项目中的特定包执行此操作。任何 ANT 脚本或一些自定义代码都非常受欢迎。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-07T13:17:39.817

`.class`编译后的文件中没有注释。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-07T13:16:43.640

我相信 Java 编译器已经为您完成了这项工作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-07T13:21:48.370

类文件没有注释，它们被编译器删除。如果你想从源文件中去掉注释，你可以使用 Ant [ReplaceRegExp](http://ant.apache.org/manual/Tasks/replaceregexp.html)任务。但我很好奇你为什么要这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T14:34:50.443

要缩小 Java jar 文件，您可以[取消设置 -g 标志](http://www.devdaily.com/blog/post/java/use-javac-g-none-reduce-java-class-file-size/)以消除调试符号，并且可以运行[代码混淆](http://proguard.sourceforge.net/)器。代码混淆在 J2ME 世界中很常见，以最大限度地减少手机的无线下载时间。这些步骤的缺点是它使调试变得更加困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T14:29:29.893

.class 文件通常不包含评论（您实际上可以在其中存储有关评论的其他信息......但 AFAIK 没有人这样做）。

经常出现的是调试信息，其中包含原始变量名称、源文件信息和行号信息以及字节码。这可以通过 javac 的 -g 开关或 ant javac 任务的调试属性来控制。

# c# - 隐式运算符？

> ID：834587
> 
> 赞同：5
> 
> 时间：2009-05-07T13:15:16.017
> 
> 标签：c#, .net, casting, operator-overloading, implicit

我需要帮助。我正在创建一个这样的 SelectItem 类：

```
public class SelectItem<T> where T : class
{
    public bool IsChecked { get; set; }
    public T Item { get; set; }
} 
```

我希望以下代码有效

```
SelectItem<String> obj = new SelectItem<String> { Item = "Value" };

obj.IsChecked = true;

String objValue = obj; 
```

而不必这样做：

```
String objValue = obj.Item; 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-07T13:16:57.620

```
public static implicit operator T(SelectItem<T> obj) {
    return obj.Item;
} 
```

# javascript - 为什么 jQuery 会删除我的元素？

> ID：834588
> 
> 赞同：1
> 
> 时间：2009-05-07T13:15:30.150
> 
> 标签：javascript, jquery, jquery-plugins

单击链接后，我正在使用带有 BlockUI 插件的 jQuery 来阻止页面。当页面被阻止时，我还使用 DOM 元素来显示消息。

下面是使用的代码的一个简单示例：

```
<a id="testme" href="#">Click Me</a>

<script type="text/javascript">
    $(document).ready(function() {
        $('#testme').click(function() {
            // Set our message in the message panel....
            $('#progressMessage').text('Please wait!');
            $.blockUI({
                message: $('#progressWidget')
            });
        });
    }
</script>

<div id="progressWidget" style="display:none" align="center">
    <div class="modalUpdateProgressMessage">
        <div id="progressMessage" />
        <img src="spinbar.gif" />
    </div>
</div> 
```

我遇到的问题是，当我设置元素时，`.text()`元素似乎被删除了。我已经验证这实际上是使用 Firebug 发生的。`<div id="progressMessage" />``<img src="spinbar.gif" />`

我也尝试过使用 a`<span>`而不是`<div>`for`progressMessage`但结果是一样的。

谁能解释为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T14:01:32.333

不要做一个自动关闭的DIV，它是无效的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T14:05:09.687

自闭是问题

```
$("#selector").append("<div>"); //fail

$("#selector").append("<div/>"); //fail

$("#selector").append("<div></div>"); //SUCCESS! 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:04:21.310

分配文本时，div id="progressMessage" 会覆盖 img。`<div id="progressMessage"></div>`改为使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:59:46.033

您可以使用 .append 添加文本

```
$('#progressMessage').text('Please wait!'); 
```

[。附加（）](http://docs.jquery.com/Manipulation/append#content)

# perl - Why would I use Perl anonymous subroutines instead of a named one?

> ID：834590
> 
> 赞同：19
> 
> 时间：2009-05-07T13:15:32.770
> 
> 标签：perl, anonymous, subroutine

I'm just curious why one would choose to use an anonymous subroutine, versus a named one, in Perl. Thanks.

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-07T13:20:52.697

*   您可以将匿名 subs 存储在数组、散列和标量中。
*   您可以在运行时构建它们
*   您可以将它们作为参数传递给其他函数。
*   您可以将变量保留在周围范围内。

最后一点可能是最重要的，因为它通常是 Perl 中命名子例程与匿名子例程最出人意料的方面。例子：

```
sub outer
{
  my $a = 123;

  sub inner
  {
    print $a, "\n";
  }

  # At this point, $a is 123, so this call should always print 123, right?
  inner();

  $a = 456;
}

outer(); # prints 123
outer(); # prints 456! Surprise! 
```

但是将“内部”从命名子例程更改为对匿名子例程的引用，并且它的工作方式并不令人惊讶：

```
sub outer
{
  my $a = 123;

  my $inner = sub
  {
    print $a, "\n";
  };

  # At this point, $a is 123, and since the anonymous subrotine 
  # whose reference is stored in $inner closes over $a in the 
  # "expected" way...
  $inner->();

  $a = 456;
}

# ...we see the "expected" results
outer(); # prints 123
outer(); # prints 123 
```

（当然，每个人的期望都不一样，所以“期望”周围的“恐吓引号”。）

这是一个在实际代码中使用的示例（尽管应该注意，该`File::Find`接口通常被认为是一个糟糕的接口——由于它使用全局变量，而不是使用匿名子例程）：

```
sub find_files
{
  my @files;

  my $wanted = sub
  { 
    if($something)
    {
      push @files, $File::Find::name;
    }
  };

  # The find() function called here is imported from File::Find
  find({ wanted => $wanted }, $directory);

  return @files;
} 
```

将命名子例程作为`wanted`参数值传递将需要使用只能使用一次的例程来污染名称空间，并且在子例程中定义命名子例程*将*`find_files()`表现出前面演示的“意外”行为。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-07T13:27:38.513

回调和生成器浮现在脑海中。一个例子：

```
#!/usr/bin/perl

use strict;
use warnings;

sub generate_multiplier {
    my ($coef) = @_;

    return sub { 
        my ($val) = @_;
        $coef * $val;
    }
}

my $doubler = generate_multiplier(2);
my $tripler = generate_multiplier(3);

for my $i ( 1 .. 10 ) {
    printf "%4d%4d%4d\n", $i, $doubler->($i), $tripler->($i);
}

__END__

C:\Temp> v
    1   2   3
    2   4   6
    3   6   9
    4   8  12
    5  10  15
    6  12  18
    7  14  21
    8  16  24
    9  18  27
   10  20  30 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-09T19:56:52.513

我讨论了匿名子例程以及为什么要在[Mastering Perl](http://oreilly.com/catalog/9780596527242/)中使用它们。简而言之，您开始将行为视为另一种形式的数据，就像您考虑字符串或数字一样。当您对这个想法感到满意时，您可以做一些非常了不起的事情，因为您可以将很多决定推迟到程序的最后阶段，并且您不必为了提前处理所有情况而扭曲代码设计可能会出现。

您可以在知道要运行子程序的情况下编写代码，只是您还不知道是哪一个。您相信前面的步骤可以为您解决这个问题。一旦你能做到这一点，你就处于另一个编程水平，感觉就像你正在编写代码来为你创建程序。通过这种方式，一些编程问题变得更容易解决。

而且，与其他所有功能一样，您可能会做得过火或不恰当地使用它。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-07T14:27:10.383

“匿名”子例程与常规的命名子例程非常相似，只是它们没有绑定到符号表中的名称。

```
sub Foo { stuff() }

BEGIN { *Foo = sub { stuff() } }  # essentially equivalent 
```

在第二种情况下，“匿名”子例程被创建，然后绑定到当前命名空间中的名称“Foo”。BEGIN 块使它在编译时发生，就像处理命名子例程一样。（它有点复杂，因为第一种情况给它一个名称，该名称将显示在堆栈跟踪中。）

当您想在运行时创建函数时，匿名子例程很有用。这对于“闭包”特别有用——“记住”其词法上下文的函数。例如，将列表转换为迭代器：

```
use 5.010;
use strict;
use warnings;

sub make_iterator {
  my @list = @_;
  return sub { shift @list }; # new sub that 'remembers' @list
}

my $iter1 = make_iterator( 0 .. 10 ); 
my $iter2 = make_iterator( 'a' .. 'z' );

say $iter1->();  # '0'
say $iter1->();  # '1'
say $iter2->();  # 'a' 
```

关于为什么匿名子程序有用的更多信息，我推荐《[高阶 Perl](http://hop.perl.plover.com/book/) 》一书，它描述了 Perl 中函数式编程的各种技术和应用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-07T13:42:56.463

匿名子程序的规范答案通常是数组的数字排序：

```
my @sorted_array = sort { $a <=> $b } @array; 
```

`{ $a <=> $b }`代表一个匿名子例程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T13:29:32.923

第一：子事物是子。我的 $thing=sub... 是存储在变量中的子引用。

第二：有一个微妙的用法差异：

```
use strict;
use warnings;

sub xx {
  my $zz=1;

   sub yy {
      print $zz;
   }
}

perl tmp.pl
Variable "$zz" will not stay shared at tmp.pl line 8. 
```

将 [ ...]更改`sub yy`为 [ `my $yy = sub {`...] 或 [ `local *yy = sub{`...]，投诉就会消失。

而且，老实说，对子的引用更容易处理，就像@x=(1,2,3) 与 $x=[1, 2, 3] 一样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T18:17:16.447

### 这是我[重写 Nasm 的 version.pl的一个例子](http://repo.or.cz/w/nasm/perl-rewrite.git?a=blob;f=perl/version.pl)

```
# jump table to subroutines / variables
my %jump = (
  id     => 'id',
  xid    => 'xid',
  hex_id => 'xid',

  h      => \&h,
  mac    => \&mac,
  sed    => \&sed,
  make   => \&make,
  nsis   => \&nsis,

  perl   => \&perl,
  dump   => \&perl,
  yaml   => \&yaml,
  yml    => \&yaml,
  json   => \&json,
  js     => \&json,

  help   => \&help,
  usage  => sub{
    require Pod::Usage;

    Pod::Usage::pod2usage(
      "run perldoc $0 or pod2text $0 for more information"
    );
  }
); 
```

基本上我能想到的唯一原因是回调或跳转表。

# c# - 从不知道期望多少的流中读取 [c#]

> ID：834605
> 
> 赞同：1
> 
> 时间：2009-05-07T13:18:31.173
> 
> 标签：c#, arrays, stream

当我事先不知道会有多少数据进入时，如何从流中读取？现在我只是选择了一个偏高的数字（如下面的代码），但不能保证我不会得到更多。

所以我在循环中一次读取一个字节，每次都调整数组大小？听起来调整大小太多了：-/

```
TcpClient tcpclnt = new TcpClient();
tcpclnt.Connect(ip, port);

Stream stm = tcpclnt.GetStream();

stm.Write(cmdBuffer, 0, cmdBuffer.Length);

byte[] response = new Byte[2048];
int read = stm.Read(response, 0, 2048);

tcpclnt.Close(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T13:25:01.267

MemoryStream 是你的朋友

```
http://msdn.microsoft.com/en-us/library/system.io.memorystream 
```

构造没有默认大小，它将自动调整大小。然后按照您的建议循环，每次读取合理数量的数据。我通常至少选择 MTU 作为默认缓冲区大小。

要获取它创建的底层 byte[] 数组，请调用

```
memoryStreamInstance.GetBuffer() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T13:34:17.687

把它们放在一起，假设你没有得到大量（超过内存）的数据：

```
TcpClient tcpclnt = new TcpClient();
tcpclnt.Connect(ip, port);
Stream stm = tcpclnt.GetStream();
stm.Write(cmdBuffer, 0, cmdBuffer.Length);
MemoryStream ms = new MemoryStream();
byte[] buffer = new Byte[2048];
int length;
while ((length = stm.Read(buffer, 0, buffer.Length)) > 0)
    ms.Write(buffer, 0, length);
tcpclnt.Close();
byte[] response = ms.ToArray(); 
```

如前所述， `MemoryStream`将为您处理动态字节数组分配。并将`Stream.Read(byte[], int, int)`返回在此“读取”中找到的字节的长度，或者`0`是否已到达末尾。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T13:39:04.867

您是否尝试过 StreamReader 类？我不确定它是否适用于这种情况，但我过去曾使用 StreamReader 来读取 HttpWebResponse 响应流。非常容易使用。

```
StreamReader reader = new StreamReader(stm);
String result = reader.ReadToEnd(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T13:22:40.553

```
int count;
while ( (count = stm.Read(buffer, 0, buffer.Length)) > 0 ) {
   // process buffer[0..count-1]
   // sample:
   // memoryStream.Write(buffer, 0, count);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T13:22:56.777

代码：

```
byte[] buffer = new byte[1024];
int amt = 0;
while((amt = stm.Read(buffer, 0, 1024) != 0)
{
   // do something
} 
```

取决于您收到的内容，如果只是纯文本，您可以将其存储在字符串构建器中，如果大量二进制数据，则将其存储在内存流中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T13:25:38.520

我想这取决于您将如何处理数据？

如果您一次不需要它，您可以在循环内执行读取操作吗？

# c# - 如何从 C# 中的水晶报表中获取子报表的名称？

> ID：834610
> 
> 赞同：2
> 
> 时间：2009-05-07T13:19:40.280
> 
> 标签：c#, crystal-reports

如何在 C# 中获取子报表名称？
我有一份主报告和一份子报告。在我的 C# 代码中，我需要获取 subreportName。

```
rptDynamicReport rpt = new rptDynamicReport();  // CrystalReport
//i need somethig like this
string reportName = "Multiple";// Where multiple is the sub report name 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T13:42:54.843

```
using CrystalDecisions.CrystalReports.Engine;
//snip

//Where report is the parent rpt of type ReportDocument (or a subclass of ReportDocument)
foreach(ReportDocument subreport in rpt.Subreports)
{
    if(subreport.Name = "Multiple")
    {
        //Not the most elegant solution, but should work
        SubreportObject subrpt = (SubreportObject)subreport;
        subrpt.Height = 0;
    }
} 
```

根据您的要求，我添加了隐藏功能，我没有对此进行测试，也没有亲自对子报表进行任何隐藏。我认为这应该有效。我找不到任何“可见”属性或类似的东西。

# tsql - TSQL 插入难题

> ID：834611
> 
> 赞同：0
> 
> 时间：2009-05-07T13:19:45.427
> 
> 标签：tsql, sql-server-2000

我有一张桌子。该表需要存储一个位置的数值，所以最初我只有两列没有递增列，给出以下内容：

```
RefID | TypeID
    1 | 1
    1 | 3
    1 | 6
    2 | 3
    3 | 5
    3 | 6 
```

其中第一列是位置的参考，第二列是实际值。

问题是我如何决定给第一列哪个值。我的想法是添加一个自动递增字段来生成这些值，因此我将拥有以下数据：

```
ID | RefID | TypeID
1  | 1   | 1
2  | 1   | 3
3  | 1   | 6
4  | 4   | 3
5  | 5   | 5
6  | 5   | 6 
```

因此，自动编号列（第 1 列）充当参考列的种子。

所以我有两个问题 - 将标识列值复制到引用列，并将引用值返回给应用程序，以便在位置有多个值时可以使用它。

我想出了这个存储过程：

```
CREATE PROCEDURE [dbo].[AddCaseType]
(
    @TypeID INTEGER,
    @CaseID INTEGER = NULL OUT 
)
AS
BEGIN

    INSERT INTO
        dbo.CaseTypeList(RefID, TypeID)
    VALUES
         ( ISNULL(@CaseID,SCOPE_IDENTITY()), @TypeID)

    Set @CaseID =  SCOPE_IDENTITY()
END
GO 
```

ISNULL 检查 CaseID 上的 NULL 以及是否为 null 以使用该`SCOPE_IDENTITY()`值。然而`SCOPE_IDENTITY`，在插入之前评估，因此返回生成的最后一个身份，而不是新的身份。

我不能使用相关表中的唯一值，因为如果用户编辑值，我需要完全跟踪。

所以我知道我想做什么，但只是没有知识或经验去做。

所以封装：**如何为集合的第一项生成唯一值并返回该值，以便我可以将其重用于该集合的其余部分？**

如果有另一种更简单的方法，您也可以回答。请记住 - 我是 SQL 方面的新手，所以我需要了解为什么会发生某些事情，因为我将来可能需要更改它。

**更新**：喝完咖啡后，我注意到我的代码中有一个错误 - 更改为三列的结果，因此 [ID] 在 INSERT 语句的第一部分变为 RefID。这也使一些代码无效，从而部分改变了我的问题的性质。很抱歉这可能造成的混乱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T13:25:44.430

插入包含`identity`列的表时，您无需为该`identity`列指定任何内容：

```
DECLARE @ERR INT

INSERT INTO CaseTypeList (TypeID, CaseID) --Column1 is auto-number, skip it
VALUES (@TypeID, @CaseID)

-- capture error var and last inserted identity value
SELECT @ERR = @@ERROR, @ID = SCOPE_IDENTITY()

-- IF @ERR <> 0 handle error, otherwise return 
```

除非您想明确控制数字，否则您不需要身份插入或类似的东西。在这种情况下，您不会将其设置为`identity`.

另外，我有点猜到你的专栏了。

* * *

编辑：好的，所以看起来您实际上根本*不需要*标识列。相反，如果没有提供，您需要生成序列中的下一个数字。在这种情况下，您可以将标识列保留在那里——它不会有任何伤害，但如果您想要一个唯一的键，以后可能会有所帮助：

```
CREATE PROCEDURE [dbo].[AddCaseType]
(
    @RefID     INTEGER = NULL OUT,
    @TypeID    INTEGER
)
AS

BEGIN TRANSACTION

  IF @RefID IS NULL BEGIN
    SELECT @RefID = MAX(RefID)+1 FROM CaseTypeList
  END

  IF @@ERROR <> 0 BEGIN ROLLBACK; RAISERROR('Could not get ID', 16, 1) END

  INSERT INTO
    CaseTypeList(RefID, TypeID)
  VALUES
    (@RefID, @TypeID)

  IF @@ERROR <> 0 BEGIN ROLLBACK; RAISERROR('Could not insert', 16, 1) END

COMMIT TRANSACTION 
```

注意：如果不能重复，您可能应该在 RefID 和 TypeID 上有一个唯一键约束。

# c++ - 清空字符串流的最佳方法？

> ID：834622
> 
> 赞同：40
> 
> 时间：2009-05-07T13:22:59.273
> 
> 标签：c++, stl, stringstream

其中一种可能性是：

```
somestringstream.str(""); 
```

但它是最优化的吗？有没有办法保留 stringstream 内部缓冲区，以便后续 operator<<() 调用不需要再次保留内存？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-07T13:25:29.797

我一直这样做：

```
s.clear();//clear any bits set
s.str(std::string()); 
```

@litb[更详细地](https://stackoverflow.com/questions/624260/how-to-reuse-an-ostringstream/624291#624291)介绍了如何查找流的开头并结合 std::ends 您可以保持分配的大小。

# c# - .NET 中的 Windows 7 x64 和外部 Web 服务问题

> ID：834624
> 
> 赞同：0
> 
> 时间：2009-05-07T13:24:02.047
> 
> 标签：c#, .net, web-services

我遇到了一个奇怪的问题。我有一个简单的 C# 控制台应用程序，它调用在我的 VS 2008 .NET 解决方案中引用的外部 Web 服务。根据供应商规范，Web 服务被定义为服务引用。该服务要求将登录凭据作为 SOAP 标头的一部分发送。

在 Vista x64/XP 下它可以正常运行。我可以使用凭据调用 Web 服务并获得有效响应。

但是，在**Windows 7 x64（内部版本 7100）**下运行的**完全相同的 exe**返回 HTTP 错误，“远程服务器返回了意外响应：(411) 长度要求”。

 **我没有大量调用 Web 服务的经验，尤其是在服务引用下，但这个问题让我很困惑。

似乎我可以通过在 SOAP 标头中设置内容长度来解决“问题”，但我没有看到从生成服务代理中暴露出来。或者，可能存在需要更改的 Windows 7 安全设置。我不知道。

任何帮助/建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-30T13:21:47.547

看起来win7上创建的http请求包与vista/xp中的不同。你可以运行[netmon](http://blogs.technet.com/netmon/)来检查从 vista/xp 和 win7 机器发送的请求有什么区别吗？这应该给出此失败的确切原因。

# filesystems - 文件系统分析

> ID：834630
> 
> 赞同：-1
> 
> 时间：2009-05-07T13:25:27.490
> 
> 标签：filesystems, analysis

所以，试图找到一些实用程序来给我们关于这件事的统计信息。

例如，在过去 30、60、90 天、6 个月等中创建了哪些文件。它们的大小是多少？

带有可排序报告的东西会很好。

我知道我们可以使用 ls 和使用 du 的各种命令行开关来做一些事情，但是这些并不能完全创建我正在寻找的报告......你知道任何合适的实用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T13:50:33.497

*find*是你的朋友，它有一个非常灵活的查询语言。结合 ls 你可以收集你想要的所有信息。

以下命令将为您提供过去 90 天内更改的所有文件及其大小： find 。-ctime -90 -exec ls -ks {} \;

接下来，使用[GnuPlot](http://www.gnuplot.info/)生成您的报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:42:53.720

你可以看看 Nagios。它更像是一个完整的系统监控工具，而不是文件系统审计工具。但是它有很多可用的插件。

# c# - 将任何 XML 文档绑定到 WPF TreeView

> ID：834632
> 
> 赞同：7
> 
> 时间：2009-05-07T13:25:30.563
> 
> 标签：c#, wpf, xml, treeview, typeconverter

我想使用 TypeConverter 将任何 XML 文档绑定到 WPF TreeView。

我最初的解决方案是使用递归，但是当文档很大时，UI 会被严重占用。

以下链接讨论了 TypeConverter，但针对特定的节点/元素组合： [http ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/edd843b7-b378-4c2d-926f-c053dbd7b340](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/edd843b7-b378-4c2d-926f-c053dbd7b340)

如果不知道 XML 文档是什么样的怎么办？由于这仅用于显示目的，我现在不太关心功能，我只想将 XML 绑定到 TreeView。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-04-28T16:39:24.320

它适用于其他节点类型，只需进行一些简单的修改。首先，HierarchicalDataTemplate.ItemsSource Binding XPath 必须更改为“child::node()|attribute::*”以允许任何子节点和任何属性。然后，为其他 NodeTypes 添加 DataTriggers。下面的例子对我有用。请注意，我为各种 NodeType 添加了图标，您可能想要删除它们：

```
 <HierarchicalDataTemplate x:Key="NodeTemplate">
        <StackPanel Orientation="Horizontal">
        <Image x:Name="icon" VerticalAlignment="Center" Margin="1,1,4,1"/>
        <TextBlock x:Name="name" Text="" />
        <TextBlock x:Name="inter" Text="" />
        <TextBlock x:Name="value" Text="" />
        </StackPanel>
        <HierarchicalDataTemplate.ItemsSource>
            <Binding XPath="child::node()|attribute::*" />
        </HierarchicalDataTemplate.ItemsSource>
        <HierarchicalDataTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=NodeType}" Value="Element">
                <Setter TargetName="icon" Property="Source" Value="icons/element.png"></Setter>
                <Setter TargetName="name" Property="Text" Value="{Binding Path=Name}"></Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=NodeType}" Value="Text">
                <Setter TargetName="icon" Property="Source" Value="icons/text.png"></Setter>
                <Setter TargetName="value" Property="Text" Value="{Binding Path=Value}"></Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=NodeType}" Value="Attribute">
                <Setter TargetName="icon" Property="Source" Value="icons/attribute.png"></Setter>
                <Setter TargetName="name" Property="Text" Value="{Binding Path=Name}"></Setter>
                <Setter TargetName="inter" Property="Text" Value=": "></Setter>
                <Setter TargetName="value" Property="Text" Value="{Binding Path=Value}"></Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=NodeType}" Value="CDATA">
                <Setter TargetName="icon" Property="Source" Value="icons/cdata.png"></Setter>
                <Setter TargetName="value" Property="Text" Value="{Binding Path=Value}"></Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=NodeType}" Value="Comment">
                <Setter TargetName="icon" Property="Source" Value="icons/comment.png"></Setter>
                <Setter TargetName="value" Property="Text" Value="{Binding Path=Value}"></Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=NodeType}" Value="ProcessingInstruction">
                <Setter TargetName="icon" Property="Source" Value="icons/pi.png"></Setter>
                <Setter TargetName="value" Property="Text" Value="{Binding Path=Value}"></Setter>
            </DataTrigger>
        </HierarchicalDataTemplate.Triggers>
    </HierarchicalDataTemplate> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T14:22:23.490

所以我问了一个问题，关于如何通过以下方式将任何 XML 文档绑定到树视图而不考虑架构： 1\. 通过 XML Provider 和 HierarchicalDataTemplate 将 XML 文档绑定到 WPF TreeView。2\. 显示 XML 文档的所有节点，包括具有以下格式的子节点的节点：

>节点1

节点 1 内容

```
 >ChildNode1

       ChildNode1 Contents

            >ChildNode1'sChildNode

              ChildNode1'sChildNode Contents 
```

>节点2

```
 Node2 Contents 
```

问题是我的 TreeView 将每个 XmlNode 名称属性绑定到 TreeItem。在文本 XmlNode 的情况下，它会将#text 绑定到不是我想要的 TreeItem。

因此，通过 MSDN 论坛上的帖子，我得到了答案： [http ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cbdb2420-1403-436f-aa7f-b1e3b1acb398/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/cbdb2420-1403-436f-aa7f-b1e3b1acb398/)

所以诀窍是使用触发器根据遇到的节点类型设置值。

需要注意的是，其他类型的节点将被忽略，并且 XML 文档可能包含不同的元素，因此这可能不适用于遇到的每种类型的节点。

这是 XAML：

```
<Window x:Class="WpfApplication1.Window1" 
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication1"
    Title="Window1" Height="250" Width="450">

<Window.Resources>
    <HierarchicalDataTemplate x:Key="NodeTemplate">
        <TextBlock x:Name="text" Text="?" />
        <HierarchicalDataTemplate.ItemsSource>
            <Binding XPath="child::node()" />
        </HierarchicalDataTemplate.ItemsSource>
        <HierarchicalDataTemplate.Triggers>
            <DataTrigger Binding="{Binding Path=NodeType}" Value="Text">
                <Setter TargetName="text" Property="Text" Value="{Binding Path=Value}"></Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=NodeType}" Value="Element">
                <Setter TargetName="text" Property="Text" Value="{Binding Path=Name}"></Setter>
            </DataTrigger>
        </HierarchicalDataTemplate.Triggers>            
    </HierarchicalDataTemplate>
    <XmlDataProvider x:Key="xmlDataProvider"></XmlDataProvider>
</Window.Resources>

<Grid >
    <TreeView Name="treeView1"
              Background="AliceBlue"
              ItemsSource="{Binding Source={StaticResource xmlDataProvider}, XPath=*}"
              ItemTemplate= "{StaticResource NodeTemplate}"/>
</Grid> 
```

```
public Window1()
{
InitializeComponent();
XmlDataProvider dataProvider = this.FindResource("xmlDataProvider") as XmlDataProvider;
        XmlDocument doc = new XmlDocument();
            // Testdocument        doc.LoadXml(
            @"<root>
                <child1>text1<child11>text11</child11>
                </child1>
                <child2>text2<child21>text21</child21>
                    <child22>text22</child22>
                </child2>
              </root>");
        dataProvider.Document = doc;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-23T07:44:04.863

看看我在以下线程上的回答 - 将[XML 数据绑定到 WPF 树视图控件](https://stackoverflow.com/questions/714239/binding-xml-data-to-wpf-treeview-control/8224122#8224122)我相信这正是您正在寻找的内容。线程中的链接指向一个帖子，它为您提供了一个带有选项的分步示例下载源代码。示例以将**任何**XML 文档绑定到 WPF 树视图的方式编写

# wpf - 在 WPF 中创建 MDI 弹出窗口的最佳方法是什么？

> ID：834637
> 
> 赞同：0
> 
> 时间：2009-05-07T13:25:54.227
> 
> 标签：wpf, software-design

我需要创建一个原型来测试 WPF 执行以下操作的能力：

*   一个基础窗口作为应用程序的基础
*   在此窗口中，用户可以单击（例如“添加客户”）并弹出一个新窗口
    *   弹窗亮
    *   背景中的主窗口变暗
*   如果用户点击主窗口
    *   主窗口变亮
    *   弹出窗口变暗并进入后台
*   一个窗口中的任何更改，我们需要立即在所有窗口中生效，无论是明亮的还是暗淡的

**问题：**

1.  子窗口应该是用户控件还是窗口？
2.  有什么我可以利用的“MDI框架”吗
3.  是否有什么特别需要考虑以确保所有窗口都不断更新，例如使用 ObservableCollections 等？
4.  我应该将所有全局变量作为属性存储在主窗口中，以便子窗口可以访问它们吗？
5.  您将如何在 WPF 中“使窗口变暗”或“使窗口模糊”？

欢迎任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T13:35:05.343

1.  子窗口应派生自 Window，然后在类的实例上调用 Show() 以显示无模式对话框。
2.  从来没听说过。
3.  使用 WPF 数据绑定使所有内容保持最新 - 您的数据类应该实现 INotifyPropertyChanged 并像您所说的那样通过 ObservableCollection 公开集合。主窗口和弹出窗口应该具有相同的 DataContext 对象，这样如果一个屏幕更改对象的属性，另一个屏幕将自动更新。
4.  使用模型视图 - 视图模型模式来保持数据和 UI 清晰分离。试试这个工具包：http: [//blogs.msdn.com/ivo_manolov/archive/2009/05/03/9584900.aspx](http://blogs.msdn.com/ivo_manolov/archive/2009/05/03/9584900.aspx)
5.  没有真正的“暗淡”功能，但您可以执行以下操作：

代码：

```
<Window>
  <Grid x:Name="dimElement">
    <Grid Background="Gray" Opacity="0.5" Visibility="Collapsed"/>
    <Grid>
      main content goes here
    </Grid>
   </Grid>
</Window> 
```

当您想要使窗口变暗时，将 dimElement 上的 Visibility 设置为“Visible”并将其设置为“Collapsed”以适当地取消变暗。

希望有帮助！

# asp.net - 用户控件未在 IE 中回发

> ID：834645
> 
> 赞同：0
> 
> 时间：2009-05-07T13:27:56.173
> 
> 标签：asp.net, user-controls, umbraco

我正在使用 Umbraco CMS 创建一个新站点。我为联系表单添加了一个 .NET 用户控件。但是，单击提交时，页面不会在 IE 中回发，而是在 FF 中工作。

我想不出为什么会这样。我试图关闭所有验证控件，但问题仍然存在。

任何建议都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T10:09:18.213

嘿 Ryan，我怀疑这是 Umbraco 特有的问题。但是您是否调试过用户控件并单步执行代码以查看发生了什么？

我建议您附加到流程，看看到底发生了什么。

沃伦:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:29:34.733

确保 IE 没有抛出阻止回发的 Javascript 错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-05T11:04:31.007

这可能有帮助，也可能没有帮助，但我最近遇到了类似的问题。原来我使用了一个 ImageButton，并且没有正确引用该图像。单击 FF 中显示的文本时，它工作正常，但 IE 卡住了。

因此，请确保它的 ImageButton 图像路径是否正确。

# c# - 我在我的应用程序中更改了一个值，但不在我的数据库中更新

> ID：834646
> 
> 赞同：1
> 
> 时间：2009-05-07T13:28:16.220
> 
> 标签：c#, database

我在我的项目中编写了这段代码，但是当我在我的应用程序中更改一个值时，出现了一个异常并且不更新我的数据库，这段代码适用于新的，但不适用于删除和编辑数据。

代码 ：

```
private void btnLecOk_Click(object sender, EventArgs e)
    {
            DataRow dr = (lecturesBindingSource.Current as DataRowView).Row;
            dr["Section_ID"] = Convert.ToInt32(cmbLec_Section_Name.SelectedValue);
            dr["Lecture_Type_ID"] = Convert.ToInt32(cmbLec_Lecture_Type.SelectedValue);
            dr["Practicable_Unit"] = numLec_Practicable_Unit.Value;
            dr["theoretical_Unit"] = numLec_Theoretical_Unit.Value;
            dr["Term"] = numLec_Term.Value;

            lecturesBindingSource.EndEdit();
            lecturesTableAdapter.Update(dsSchedule.Lectures);
            EnableLectureControls();
    } 
```

例外 ：

> System.Data.DBConcurrencyException 未处理 Message="并发冲突：UpdateCommand 影响了预期的 1 条记录中的 0 条。" 源=“系统。数据”行数=1

Sql 查询敌人更新：

> 更新讲座集 Lecture_Code = @Lecture_Code, Section_ID = @Section_ID, Lecture_Type_ID = @Lecture_Type_ID, Lecture_Name = @Lecture_Name, Practicable_Unit = @Practicable_Unit, theory_Unit = @theoretical_Unit, Lecture_Capacity = @Lecture_Capacity, Term = @Term WHERE (Lecture_Code = @Original_Lecture_Code) AND (Section_ID = @Original_Section_ID) AND (Lecture_Type_ID = @Original_Lecture_Type_ID) AND (Lecture_Name = @Original_Lecture_Name) AND (Practicable_Unit = @Original_Practicable_Unit) AND (theoretical_Unit = @Original_theoretical_Unit) AND (Lecture_Capacity = @Original_Lecture_Capacity) AND (Term = @Original_Term)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:54:55.890

我曾经遇到过同样的问题，我记得它在更改受影响的数据库表中的关系属性后起作用。我将插入和更新规范更改为级联，问题再也没有出现。虽然它可能不是完美的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:19:28.700

您的更新查询包含一个 WHERE 子句，它确保数据库中的行仅在同时没有从其他来源更新时才被更新或删除。

I suspect you used the autogenerated sql queries provided by the strongly typed datase/tableadapters?
When specifying the SELECT query for the tableadapter, go to "Advanced Options". In the appearing window there is an option "Use optimistic concurrency". Uncheck this to allow the overwriting of values that have changed in the database since the data was loaded into the application. You will notice that the WHERE-clause of the update statement will become much smaller.

# c# - 应用程序在 Windows 启动时找不到 app.config 文件

> ID：834650
> 
> 赞同：2
> 
> 时间：2009-05-07T13:29:10.273
> 
> 标签：c#, setup-project

最近，我在我的应用程序中添加了一个设置项目。在安装项目中，我向 HKLM\Software\Microsoft\Windows\CurrentVersion\Run 键添加了一个注册表值，该值将在 Windows 启动时启动我的应用程序。当应用程序从该位置运行时，它会因 System.NullReference 异常而崩溃（它找不到我的 app.config 文件，该文件会在应用程序加载时在方法中读取）。我可以从开始菜单或已安装的文件夹完美地运行该应用程序。如何让我的应用程序在启动时运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:32:23.633

我相信它将以系统文件夹作为工作文件夹运行。将配置文件放在系统文件夹中或确保设置工作文件夹应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-02T07:14:19.233

行。我知道这是一个老问题，但我认为解决方案有点缺乏清晰度。我遇到了同样的问题，您不必将 app.config (your.exe.config) 放入系统文件夹中。如果你想保持你的程序可移植并且没有 MSI，你可以简单地在表格中输入一些行。

```
APP_PATH = Application.ExecutablePath.ToString();
Environment.CurrentDirectory = Path.GetDirectoryName(APP_PATH); 
```

在您的表单课程中尽早执行此操作，它将起作用。

# mysql - MySQL 子选择在 ON DUPLICATE KEY

> ID：834651
> 
> 赞同：1
> 
> 时间：2009-05-07T13:29:14.437
> 
> 标签：mysql

是否可以在 ON DUPLICATE KEY UPDATE 的 IF 语句中进行选择？

假设我想按邮政编码设置运费，如果输入的邮政编码重复，我想应用最高费率来申请。

我的数据库有一张运费表和一张邮政编码表。邮政编码表有一个引用运费的外键，以及具有唯一索引的邮政编码。

当有重复键时，我想将运费 ID 设置为更高的费率。像这样的东西：

`INSERT INTO ZipCodes (ShippingRateID, Zip) VALUES (11, '13754') ON DUPLICATE KEY UPDATE ShippingRateID = IF((SELECT Rate FROM ShippingRates sr WHERE sr.ShippingRateID = ShippingRateID) > [current rate], ShippingRateID, VALUES(ShippingRateID))`

当我尝试执行此查询时，MySQL 告诉我“子查询返回了多个记录”。由于 ShippingRates 表中只有一条匹配记录，我不明白如何返回多条记录。实际发生的是，在子选择中，ShippingRateID 总是引用 ShippingRates 表，而插入的 ShippingRateID 没有被使用。因此，如果不使用 LIMIT，所有运费都会被退回。如果我确实使用 LIMIT 1，那么我总是会得到第一名，这是错误的。

如何告诉子选择使用插入中的 ShippingRateID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:38:05.197

```
INSERT INTO ZipCodes
(ShippingRateID, Zip)
VALUES (11, '13754')
ON DUPLICATE KEY
UPDATE ShippingRateID = 
    (SELECT IF(Rate > [current rate], ShippingRateID, VALUES(ShippingRateID))
        FROM (
            SELECT ShippingRateID AS AltID, Rate
            FROM ShippingRates
        ) AS sr
        WHERE sr.AltID = ShippingRateID
        LIMIT 1
    ) 
```

# wordpress - 记录开发电子邮件

> ID：834663
> 
> 赞同：0
> 
> 时间：2009-05-07T13:31:39.767
> 
> 标签：wordpress, project-management, bug-tracking, issue-tracking

我在 IT/开发部门，通知代码更改的唯一方法是向小组 (development@company.com) 发送电子邮件。所以我们有很多电子邮件。

我想设置电子邮件组，以便发送到该组的所有电子邮件都存储在一个地方。我们使用 Exchange，所以我想将它们自动存储在 Exchange 在线文件夹中。遗憾的是，有人告诉我那些交换文件夹不再是最新版本的 Exchange。

我的第二个选择是一个内部博客，比如 Wordpress，所有的电子邮件都被发布、标记和访问以供搜索。

*   有没有人用博客软件记录群组邮件？
*   您还使用了哪些其他方法来记录这些电子邮件？

请注意：我正在建立一个错误跟踪器，但我相信需要很长时间才能激励开发人员使用它。同时，我需要这种其他方法。

## 更新

请注意：

*   我们没有源代码控制（也没有机会做到这一点）
*   我们没有错误/问题跟踪，但我希望在今年年底之前有一个。
*   我工作的人太习惯于通过电子邮件通知他们所做的更改。将这些电子邮件存储在一个地方以进行搜索将是理想的选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T13:37:40.330

不能设置一个新的电子邮件，例如 developmentcodechanges@company.com，并且该邮箱是共享的，因此任何开发人员都可以查看该邮箱，但不会阻塞每个开发人员的个人邮箱？在我工作的地方，我们有一个以这种方式使用的“应用程序日志”邮箱，这样不同的人就可以了解正在发生的事情，同时它不会阻塞任何人的个人邮箱。

除了查看源代码控制之外，我们还有几种方法可以相互通知代码更改：

1) 持续集成机器构建 - 当有人签入新代码时，会触发构建，这可能是我们开发人员使用 CCTray 之类的东西看到的东西。

2) Messenger - Twitter 或 Microsoft Office Communicator 之类的东西是一种向其他人发送通知的方式，说明某些事情发生了变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T17:41:03.630

您最大的问题是缺少配置管理系统。这意味着源代码版本控制（例如 Subversion）以及控制更改、集成和发布的流程。这样一来，您就不会有人在最终构建之前添加未经测试的代码，也不会因为 Bill 将他的更改保存在 Joe 已经进行的更改之上而丢失了修复。说“没有机会得到一个”是对责任的放弃。这是您提高质量和效率的首要任务。围绕当前非系统的成本和风险构建业务案例，并将其提交给高级管理层。

然后给自己一个像样的问题跟踪系统。与 CM 系统一样，周围有很多免费的。电子邮件不会扩展。

有了问题跟踪器后，通过在每个增量的注释字段中输入适当的问题编号，将您的 CM 系统绑定到其中。然后您可以编写一个 Perl 脚本来告诉您在任何分支中已修复了哪些问题，并使用它的报告来更新跟踪器中的问题。只有当你这样做了，你才会知道你的下一个版本有什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T13:40:53.270

好吧，大多数电子邮件列表包（邮递员等）都具有归档功能和浏览档案的方式，以及管理用户的方式。

也许其中一个与交换一起工作，并免除交换管理器管理列表突变的责任

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T13:39:12.230

冒着听起来俗气的风险……高音扬声器不能成为这个选择吗？

不是您在 tweeter 上的个人帐户，而是某种商业服务，开发人员可以在其中快速而简短地通知正在发生的事情。

我一直在为我们的小组考虑这个问题——只是为了让每个人都能了解人们正在做什么，以及他们是否面临问题或陷入困境

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T13:46:20.903

问题：为什么要通知人们有关代码的更改？开发人员对这些信息有何用处？

我已经看到这样做了，开发人员可以订阅源代码控制树的特定部分中的更改，这是有道理的。我不确定为什么您需要在应用程序的每个部分中的每个签入时都通知每个人。

此外，如果通知方法都来自您的源代码控制系统，并且如果源代码控制系统已经拥有所有更改的列表，那么您为什么需要记录源代码控制系统已经跟踪的更改所产生的电子邮件?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-03T16:57:16.253

> 我们没有源代码控制

您的开发人员如何在没有源代码控制系统的情况下共享代码？他们是通过电子邮件发送补丁还是更改文件？他们能否在不给每个人造成巨大痛苦的情况下做到这一点？

> （并且没有机会做到这一点）

我理解改变根深蒂固的工作实践是多么困难，但是版本控制和错误跟踪软件是健全的开发环境的两个“必备”。

如果您的开发人员可以访问公共网络共享，请尝试[Mercurial](http://www.selenic.com/mercurial)。设置只需几分钟，如果您有网络文件访问权限，则不需要服务器进程。Joel Spolsky 在这里写了一个很棒的教程：[hginit](http://hginit.com/)。

电子邮件被提交时的日志消息所取代。

如果您真的无法阻止您的开发人员通过电子邮件发送代码更改，那么您至少可以让他们通过电子邮件发送包含 Mercurial 更改集的补丁。最终他们会发现，从 Mercurial 共享中提取更容易，并且您将成功地通过隐形引入代码控制。

> 有没有人用博客软件记录群组邮件？您还使用了哪些其他方法来记录这些电子邮件？

在 20 多年的软件开发生涯中，我从未在任何使用电子邮件而不是源代码控制系统的地方工作过。

# c# - 从管理 UI 控制列表的排序顺序

> ID：834664
> 
> 赞同：0
> 
> 时间：2009-05-07T13:32:06.583
> 
> 标签：c#, .net, algorithm, sorting

我有一个用户可以控制排序顺序的数据列表。

它看起来像这样

```
Apples     /\  \/
Oranges    /\  \/
pears      /\  \/
banana     /\  \/
Pineapples /\  \/
etc        /\  \/ 
```

/\ 和 / 是向上和向下箭头

当用户单击时，我想检索当前的排序顺序并从中取走一个（因此它具有较小的值并且在排序顺序中会更高。

当用户单击时，我会做相反的事情

我想我还需要确定列表中是否已经存在具有我要分配的新值的其他内容，并以相反的方向调整该项目的排序顺序

这似乎是实现这一目标的好方法吗？

还是有更聪明的方法？

任何人都有任何示例代码。我正在使用 .net 3.5，所以 linq 可以

该列表存储在内存缓存中 -`IList<mycustomobj>`

感激地收到任何建议

编辑：我担心的问题是最初没有排序顺序 - 一切都将为零。我建议的算法有一个隐含的假设，即排序顺序总是连续的。但是当一行被删除时会发生什么？排序顺序列表中会有一个空白，因此简单地添加 1 和删除 1 可能没有任何区别 - 我该如何处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T13:52:06.677

这是一种方法。在我的应用程序中，我们要么使用拖放，要么使用一个向上箭头和一个向下箭头来向上/向下移动所选元素。

如果您有一些确定排序顺序的属性，当用户单击向上箭头时，您只需将当前元素的排序位置与前一个元素的排序位置置换，除非它是第一个元素（在这种情况下什么也不做）。对向下箭头使用相反的逻辑...

编辑：

如果您的项目还没有排序位置，您可以浏览您的列表并分配一个从 1 到 n 的排序位置。如果删除了行，则将所有后续项目的排序位置减一。

# c++ - 在 3D 渲染二进制文件中嵌入 Flash

> ID：834665
> 
> 赞同：2
> 
> 时间：2009-05-07T13:32:08.440
> 
> 标签：c++, flash, user-interface, embed

我想在我的 3D 游戏 C++ 应用程序中嵌入 Flash (2D GUI)，它必须是可移植的。渲染 Flash 是不够的，我需要用户操作回调。

我为 Ogre3D 找到[了 Hikari](http://code.google.com/p/hikari-library/wiki/Introduction)，但我猜它所基于的技术仅适用于 Windows？（它使用 OLE。）此外，据我所知（未经证实）CryEngine 使用 Flash。

差点忘记了一个显而易见的问题：我该如何做生意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T17:18:50.720

我知道有几个游戏开发者正在使用[Scaleform](https://www.scaleform.com/products/clik)中间件，它允许您在 Flash 中创作 UI 并将它们导出到控制台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:17:23.053

回答我自己的问题：一位同事推荐了[这个](http://tulrich.com/geekstuff/gameswf.html)库。听起来很自由，对我来说很有趣，我想我会调查一下。

# java - Java EE 与 .NET 集成以进行身份 验证

> ID：834667
> 
> 赞同：1
> 
> 时间：2009-05-07T13:32:23.197
> 
> 标签：java, .net, iis, authentication, integration

我有一个 Java Enterprise Edition Web 应用程序，一个标准的 WAR。我想将它与运行 IIS 的现有 .NET 基础结构集成。具体来说，我需要能够以某种安全的方式在两个应用程序之间共享用户会话。

有这样做的“标准”方式吗？

编辑：我不需要完整的会话共享，很抱歉没有指出这一点。我需要做的是检查用户在连接到 Java EE 应用程序时是否通过 .NET 应用程序进行了身份验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:42:04.860

创建一个 .NET Web 服务（当然使用 WCF）来返回用户是否经过身份验证。然后从 Java EE 应用程序调用该 Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-16T09:19:51.237

这个开源库[http://spnego.sourceforge.net](http://spnego.sourceforge.net)将使您的 Java 应用程序能够进行透明/集成的 Windows 身份验证。

它作为 servlet 过滤器安装，因此您无需编写任何代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T14:11:43.650

如果它们将在同一台服务器上运行，您将需要一个 isapi 重定向过滤器，例如 Tomcat 附带的 isapi_redirect.dll。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:33:32.260

很可疑。

您必须将会话状态持久化到第三个组件，例如数据库。我怀疑这两种基础设施的内置提供程序是否完全相似（就模式等而言）；所以你想必须创建自己的。

这听起来不像是一件有趣的事情。

# .net - IIS7/2008 Sql/服务连接问题

> ID：834676
> 
> 赞同：0
> 
> 时间：2009-05-07T13:34:42.257
> 
> 标签：.net, windows-server-2008, tcp

在尝试让 2008 服务器连接到 sql 服务器时，我注意到 2008 IP 堆栈发生了变化，这让我有点摸不着头脑。我正在寻找一种操作系统方式来覆盖它，或者在.NET 中寻找一种编程方式来覆盖它。

为了这个论点，假设我有一个具有多个 IP 地址的 Web 服务器来服务器多个站点，连接到防火墙后面的多个资源（Web 服务、sql 等）。

```
SERVER IP:   10.10.10.1
SITE1 IP:    10.10.10.10
SITE2 IP:    10.10.10.11

SQL SERVER:  10.10.10.2
WEB SERVICE: 10.10.10.15 
```

防火墙自然设置为拒绝所有，只允许需要的。换句话说：

```
ALLOW FROM 10.10.10.1 TO 10.10.10.2
ALLOW FROM 10.10.10.1 TO 10.10.10.15
DENY ALL 
```

在 Windows 2008 之前，Windows 2000/2003 在请求网络资源时总是使用机器基础 IP (10.10.10.1)。因此，满足防火墙规则并授予访问权限。在 2008 年，它似乎选择了最接近的匹配：

连接到 10.10.10.2 来自 IP 10.10.10.1。防火墙很高兴。连接到 10.10.10.15 来自 IP 10.10.10.11，防火墙拒绝连接。

当然，从 NIC 中删除所有虚拟 IPS 会使一切正常，因为每个 IPS 都会来自 10.10.10.1

现在，我稍微了解这台机器有两个 NIC，这是有道理的，因为实现 RFC3484 和 IPv6（[http://support.microsoft.com/kb/968920](http://support.microsoft.com/kb/968920)）和强/弱主机模型开始发挥作用，但是对于我的生活，我不明白为什么这会改变 IP 与单个 NIC 卡一起工作的方式。

我有一个支持案例打开，但我无处可去。我听到“只需打开防火墙以允许来自 10.10.10.11 的连接”的喃喃自语。这不切实际。这意味着为 Windows 2008 的多宿主单 nic 机器上的每个 ip 地址添加一个允许规则。我不敢相信只为 2008 年代的 ip 堆栈在防火墙中戳更多漏洞是一个很好的答案。

有没有办法在机器级别在 2008 年禁用此“功能”？有没有办法在机器级别在 .NET 中禁用它？有没有办法禁用每个连接（SqlConnection，WebClient）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T13:56:37.413

您会看到 Automatic Route Metric 计算的副作用。当多个地址具有到一个地址的路由并且启用了自动度量（在 TCP 下的高级...设置中）时，Windows 将使用尝试并预测到该地址的“最快”路径。

我怀疑您的两个接口（虚拟或其他）都具有相似的路由指标，因此选择是不确定的。*您可以通过在.10/* .11 地址上设置更高的路由度量来鼓励它使用您的“后端”地址。禁用自动指标后，您还可以使用 10.10.10.1 地址指定显式静态路由。

有关 TechNet 的更多详细信息 - 在页面上搜索自动指标。

```
http://technet.microsoft.com/en-us/library/bb727001.aspx 
```

无论好坏。如果两个接口都通告具有相同度量的路径 - 任何一个接口都可以获胜。过去的行为是不确定的——它已经改变了。

最好的方法是`route`在命令行中使用在 .1 和 .2 之间以较低或最低成本创建静态持久 TCP 路由。交替增加 .14 和 .15 地址上每条路线的成本。我会使用前者，因为维护更少，对其他通信的副作用也更少。

# javascript - 如何在关闭的弹出窗口中提供（在 IE 和 Firefox 中）二进制文件下载？

> ID：834677
> 
> 赞同：5
> 
> 时间：2009-05-07T13:34:58.917
> 
> 标签：javascript, internet-explorer, firefox, popup, download

我需要针对以下用例的跨浏览器解决方案：用户单击我们其中一个页面上的“导出”按钮，这会打开一个带有表单的弹出窗口。在提交表单时，用户应该会收到一个二进制文件下载（例如 CSV 文件），并且弹出窗口应该在不更改父窗口的可见内容的情况下关闭。

我们不能使用超时来关闭弹出窗口，因为在下载文件之前通常会有一个对话框询问用户如何处理文件，并且无法知道用户处理这个对话框需要多长时间。

我们最初在弹出窗口中有一个脚本，它将 window.location 设置为下载文件的 URL。这使弹出窗口未关闭。

因此，我尝试在父窗口中放置一个隐藏的 iFrame，并在调用 self.close() 之前让弹出窗口将 iFrame 的 src 设置为下载 URL。这在 Firefox 中完美运行，但 IE 完全破坏了它的安全限制。

有正确的方法吗？在 IE 上工作的方式怎么样？

* * *

更新 - 问题已解决

这里提出的答案并不太远，但我的问题比 JavaScript 问题要复杂一些。我遇到了 IE 和 Excel 的错误（因为下载文件是 CSV），并且弹出窗口正在做一个表单发布。

如果不将表单数据附加到 URL（对于 GET 而不是 POST），我无法解决问题，并且我必须在 IE 中将站点设置为受信任（这是一个企业应用程序，所以这是一个合理的请求用户）。

单击表单按钮时，弹出窗口调用 window.opener 上的函数，传入表单及其操作 URL。然后弹出窗口调用 window.close()。该函数将表单数据附加到 URL 并将 window.location 设置为新 URL（iFrame 的想法在 IE 中从来没有很好地工作，显然没有必要）。

在对表单 URL 的响应中，请求头包括 Content-Type: application/octetstream and Content-Disposition", "attachment; 文件名=文件名.csv"。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T14:50:10.780

您是否尝试过在 iframe 解决方案中实际调用父窗口内的方法，从而设置 iframe 的位置？我问是因为它在我的测试中有效：

**父窗口**

```
<html>
<head>
<script type="text/javascript">
var w;

var download = function() {
    document.frames[0].location = "test.php";
    w.close();
};

var o = function() {
    w = window.open("test2.html", "window_name");
    return false;
};
</script>
</head>
<body>

<a href="#" onclick="return o();">open</a>

<iframe></iframe>

</body>
</html> 
```

**弹出窗口**

```
<html>
<head>
<script type="text/javascript">
var download = function() {
    window.opener.download();
    return false;
};
</script>
</head>
<body>

<a href="#" onclick="return download();">download</a>

</body>
</html> 
```

**test.php**只是一个强制下载文件的页面，请注意，上面的代码是 IE 特定的，因为我使用的是 document.frames 对象，但它可以很容易地跨浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T14:09:36.633

这可能是解决问题的一种方法。

1）弹出表单 onsubmit 执行 window.open 到第三个窗口，该窗口打开一个页面，该页面是一个空白页面，仅返回下载的文件。

2）在弹出表单上的javascript中，在您执行window.open之后，立即调用关闭弹出提交表单的父窗口（第一个窗口）方法。

3）在第三页上，这只是返回文件的页面，你的头文件中的内容配置只返回文件而不是其他任何东西，所以页面不会真正打开。

这是您可能需要的有关标题的一些信息。代码在 Classic prehistoric ASP 中，但你应该能够看到你需要的东西。

[http://classicasp.aspfaq.com/general/how-do-i-prompt-a-save-as-dialog-for-an-accepted-mime-type.html](http://classicasp.aspfaq.com/general/how-do-i-prompt-a-save-as-dialog-for-an-accepted-mime-type.html)

希望有帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-23T11:48:05.323

没有任何完美的解决方案。当在 IE 中下载文件时它的弹出窗口和在 firefox 中它直接下载

# performance - 仅在 I/O 负载低时运行线程

> ID：834679
> 
> 赞同：3
> 
> 时间：2009-05-07T13:35:36.810
> 
> 标签：performance, delphi, delphi-2009, backgroundworker, io

我有一个执行 I/O 操作的后台线程（使索引保持最新）。但除此之外，还有几个客户端访问服务器的硬盘，我希望这些访问尽可能快。所以我想，如果索引线程仅在 I/O 负载较低时运行，那就太好了。

有没有办法解决这个问题？

我也愿意接受其他建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T14:10:05.650

使用性能计数器获取磁盘的 I/O 活动。一旦达到阈值的低端，就让线程运行。在决定停止阈值的高端值时，不要忘记考虑您将添加的 I/O 负载。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-07T13:46:33.243

将线程优先级设置为空闲就足够了。

* * *

**编辑**

你说得对，线程的优先级不会影响 IO 优先级。
查看[Windows Vista](http://download.microsoft.com/download/a/f/7/af7777e5-7dcd-4800-8a0a-b18336565f5b/Priorityio.doc)中的 I/O 优先级以获取详细说明。

# c# - 排队线程是否会影响同一类中的非线程安全对象？

> ID：834688
> 
> 赞同：0
> 
> 时间：2009-05-07T13:38:10.627
> 
> 标签：c#, .net, vb.net, multithreading, clr

如果我使用 ThreadPool.QueueUserWorkItem 生成一个线程并且该线程没有引用不是线程安全的对象，它会损害该非线程安全对象吗？

[编辑] 非线程安全对象是指可编程逻辑控制器的第三方接口，它无法打开同时连接或并发支持。

我想我只是想确保通过在与我对该对象的引用相同的类中排队线程，我不会以某种我没有意识到的方式损害它的线程安全性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:39:25.710

线程不是魔术。如果他们不引用某些数据，那么他们就不会影响它。

* * *

**编辑：**如果您有监视新线程创建的代码，并监视 QueueUserWorkItem，并且如果监视器修改了这些非线程安全对象，那么是的，会有影响。

否则，没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:41:41.583

只要新线程不直接或间接引用非线程安全对象，就不会对其产生影响。

小技术点。调用 ThreadPool.QueueUserWorkItem 不一定会产生一个新线程。相反，它确保提供的委托将在不同的线程上运行。这可能会导致创建线程，或者更可能的情况是它将使用已分配给线程池的现有线程。

# visual-studio - 在 Visual Studio 2008 中自动将设计视图与源视图同步

> ID：834689
> 
> 赞同：1
> 
> 时间：2009-05-07T13:38:17.520
> 
> 标签：visual-studio

是否可以将设计视图与源视图自动同步，而不必在每次更改后按 Ctrl+S 或单击黄色栏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T12:34:13.017

自 VS 2008 起没有任何自动化

# regex - 如何用编号组进行正则表达式替换？

> ID：834690
> 
> 赞同：1
> 
> 时间：2009-05-07T13:38:26.723
> 
> 标签：regex

我正在尝试替换所有字符串实例，例如

```
PageLocalize("Texts", "R73") 
```

有类似的东西

```
Texts.R73.Localise() 
```

我有一个匹配这些字符串的正则表达式：

```
PageLocalize\("([A-Za-z]+)", "([A-Za-z0-9]{0,6})"\) 
```

和一个替换字符串：

```
$1.$2.Localise() 
```

但是[正则表达式教练](http://www.weitz.de/regex-coach/)说我的替换结果是

```
$1.$2.Localise() 
```

我需要对我的正则表达式做什么才能使编号分组起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:42:17.557

它在测试应用程序中运行良好：

```
var r = new Regex(
    "PageLocalize\\(\"([A-Za-z]+)\", \"([A-Za-z0-9]{0,6})\"\\)");
var s = r.Replace("PageLocalize(\"Texts\", \"R73\")", "$1.$2.Localise()");
Console.WriteLine(s); 
```

这导致：

```
Texts.R73.Localise() 
```

AmitK 在 Regex Coach 中找到了正确的方法，它使用 \1 而不是 $1。事实证明，RegexCoach 不是一个 .NET 应用程序，所以它没有使用 .NET 正则表达式！

另外，您知道[命名组](http://www.knowdotnet.com/articles/regereplacementstrings.html)吗？它们更容易维护，尤其是当您向正则表达式添加新组时。无法让 Stackoverflow 显示没有空格的命名组正则表达式，所以这里有空格：

( ? < group_name > yourregex )

在替换文本中：

```
${group_name} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T13:48:03.783

我没有使用过 RegexCoach，但是一些 Regex 引擎要求您使用反斜杠指定反向引用，如下所示：

```
\1.\2.Localise() 
```

仅当 $1 未被识别为对 Group 1 的反向引用时，您获得的结果才有可能。

**编辑：**

我刚刚检查了一下，[RegexCoach](http://www.weitz.de/regex-coach/)似乎使用 Perl Regex 语法。如果是这样，那么`$1`将是对第 1 组的有效反向引用。那么引擎似乎无法匹配这些组。

# asp.net - C# Asp.Net 2.0 - 如何根据活动目录密码检查密码？

> ID：834694
> 
> 赞同：0
> 
> 时间：2009-05-07T13:39:20.390
> 
> 标签：asp.net, security, active-directory, asp.net-2.0, c#-2.0

我正在重写一个内部应用程序，它目前使用自己的用户名/密码组合。人们永远忘记它，或者没有更改默认密码，所以我想使用单点登录并使用我们的域。

我正在使用 .Net2.0，但在 3.5 之外找不到任何方法。

如何获取当前用户的登录名，然后根据 AD 中的密码检查输入的密码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T13:48:59.010

还有 ActiveDirectoryMembershipProvider：

[http://msdn.microsoft.com/en-us/library/ms998360.aspx](http://msdn.microsoft.com/en-us/library/ms998360.aspx)

# sql - 使用 Row_Number、order by 和 where 子句的 SQL 查询

> ID：834702
> 
> 赞同：3
> 
> 时间：2009-05-07T13:40:56.517
> 
> 标签：sql, oracle, select, oracle10g, row-number

我有以下 SQL 查询：

```
select
     ID, COLUMN1, COLUMN2
from
     (select ID, COLUMN1, COLUMN2, row_number() over (order by 2 DESC) NO from A_TABLE)
where
     NO between 0 and 100 
```

我要做的是选择查询的前 100 条记录

```
select ID, COLUMN1, COLUMN2 from ATABLE order by 2 DESC 
```

以下是问题：

1.  显然，该`order by`条款不起作用。我注意到我必须在`order by 2 DESC`之后添加另一个子句`(...) from ATABLE`才能使我的查询正常工作。有什么我做错了吗？还是预期的行为？

2.  如何添加`where`子句？假设我只需要选择表的前 100 条记录`where COLUMN1 like '%value%'`。我尝试在之后添加 where 子句，`(...) from ATABLE`但它产生了错误......

帮助？谢谢。

PS：我使用的是 Oracle 10g R2。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T13:57:10.830

rownum 是一个伪列，在应用 where 子句 *后计算结果集中的行数。*

这是你想要得到的吗？

```
SELECT *
FROM ( 
    SELECT id, column1, column2
    FROM atable ORDER BY 2 DESC
) 
WHERE ROWNUM < 100; 
```

因为它是一个伪列，严格来说是由 where 子句产生的行的计数器，所以它不允许您进行分页（即在 200 和 300 之间）。

这可能是您正在寻找的：

```
SELECT *
FROM
 (SELECT a.*, rownum rnum FROM
     (SELECT id, column1, column2 FROM atable ORDER BY 2 DESC) a WHERE rownum <= 300)
WHERE rnum >= 200; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T14:00:10.807

[查看此 Oracle 常见问题解答](http://www.orafaq.com/faq/can_one_retrieve_only_rows_x_to_y_from_a_table)。特别是这部分：

```
 SELECT * 
  FROM (SELECT a.*, rownum RN 
      FROM (SELECT * 
                         FROM t1 ORDER BY key_column) a
         WHERE rownum <=7)
 WHERE rn >=5 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T14:23:25.073

要回答您的第一个问题：不要在 order by 子句中使用列号，而是使用列名。我不完全理解您的第二个问题，因为在您最内部的 SELECT 中添加 WHERE 应该可以解决问题：

```
select ID
,      COLUMN1
,      COLUMN2
from  (select ID
       ,      COLUMN1
       ,      COLUMN2
       ,      row_number() over (order by COLUMN1 DESC) NO
       from   A_TABLE
       where  COLUMNX LIKE '%SOME VALUE%'
      )
where  NO between 0 and 100 
```

PS（to willcodejavaforfood）我认为当您希望对行进行排序时，使用 row_number() 会更好。它保存了内部视图（可读性的巨大胜利）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:49:25.530

你为什么不使用

```
Select top 100 ID, Column1, Column2
From A_Table
where Column1 like '%value%'
order by Column2 desc 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-16T08:06:30.337

在这里，您将从 oracle 数据库中获取有限的记录，而无需使用`rownum`

```
select * from 
    ( select ,column1,column2,row_number() over (order by columnName) as rnum 
      from table_name) 
where rnum between 5 and 10; 
```

# sql - 为什么 Perl 的 DBI 会抱怨“在未打开的光标上尝试获取”？

> ID：834712
> 
> 赞同：1
> 
> 时间：2009-05-07T13:42:40.537
> 
> 标签：sql, perl, informix, dbi, dirtyread

这是我的脚本：

```
$db_handle=DBI->connect("$dbstr", "", "",
{RaiseError => 0, AutoCommit => 0, PrintError => 1}) 
|| die "Connect error: $DBI::errstr" ;
$result=$db_handle->selectrow_array("set isolation to dirty read"); 
```

注意：`$dbstr`是一个有效的数据库名称。

我不是数据库程序员。我做错了什么导致 Perl 脚本失败说：

> DBD::Informix::db selectrow_array 失败：SQL：-400：在未打开的游标上尝试获取。

如果我编写一个简单的脚本来连接数据库`$dbstr`并显示表格内容，它可以正常工作，但上面的代码不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T14:09:31.440

该`selectrow_array`方法旨在与返回结果集的语句一起使用。SET ISOLATION 语句不是这样的语句 - 它会失败。

错误 -400 是否是可能的最佳错误有点值得商榷 - 有时我会看看是否可以做任何事情。但是，IIRC，该`selectrow_array`方法是由 DBI 而不是 DBD::Informix 提供的，因此 DBI 从较低级别的原语构建它。因此，这些原语不能提供高级函数可以提供的验证，因为它们也必须单独工作。

编写该代码的正确方法是：

```
$db_handle->do("set isolation mode to dirty read"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T14:16:26.307

您正在执行的语句中没有结果可供您获取：

```
set isolation to dirty read 
```

`selectrow_array()`错误的调用方法也是如此。改用[$dbh->do(...)](http://search.cpan.org/dist/DBI/DBI.pm#do)：

```
$db_handle->do('set isolation to dirty read'); 
```

以下是对 -400 错误的详细解释：

> -400 在未打开的游标上尝试获取。
> 
> 此 FETCH 语句命名一个从未打开或已关闭的游标。查看程序逻辑，并检查它是否会在此之前打开光标，而不是意外关闭它。除非游标声明为 WITH HOLD，否则它会由 COMMIT WORK 或 ROLLBACK WORK 语句自动关闭。

正如 Jonathan 指出的那样，这可能不是最明显的错误，但一旦您了解发生了什么，它确实是有道理的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T13:54:30.010

请阅读[DBD::Informix](http://search.cpan.org/perldoc?DBD::Informix)的文档，尤其是“CONNECTING_TO_A_DATABASE”部分。连接到 Informix 数据库所需的最少代码似乎是：

```
$dbh = DBI->connect("dbi:Informix:$database"); 
```

因此，您必须提供的不仅仅是数据库的名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T15:10:24.663

`set isolation to dirty read`不是查询，而是语句。只有查询进入`selectrow_array`。你需要`do`：

```
#!usr/bin/perl

use strict;
use warnings;

use DBI;

my $dbi = "dbi:Informix:dbname";

my $dbh = DBI->connect(
    $dbi,
    "",
    "",
    {
        RaiseError => 1,
        AutoCommit => 0,
        PrintError => 1,
        ChopBlanks => 1,
    }
) or die "Connect error: $DBI::errstr";

my $result = $dbh->do("set isolation to dirty read");

$dbh->disconnect; 
```

# silverlight - 如何将调试程序集添加到我的 Silverlight 2 应用程序？

> ID：834717
> 
> 赞同：3
> 
> 时间：2009-05-07T13:43:02.517
> 
> 标签：silverlight, assemblies, debugging

所以我现在知道调试程序集被有意地排除在 Silverlight 运行时之外以节省空间。出于这个原因，我在安装了 Silverlight SDK 的本地计算机上收到了详细的错误消息，但我不在只有运行时的计算机上。我得到无处不在的“调试资源字符串不可用”。

不幸的是，我的要求有点独特。我需要包含调试程序集（还不确定是哪一个），它将为我提供正则表达式错误的详细信息。因此，如果可以的话，基本上我想将 dll 包含在 xap 中。

问题是我似乎无法做到这一点。我尝试将调试 dll 添加为引用并将它们设置为“复制本地”。我已经尝试将它们作为内容添加到项目中。但事实上，无论使用哪种方法，xap 的大小都几乎不会增长，错误消息也不会改变。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T02:23:20.083

您仍然需要安装实际的 Silverlight Developer Runtime（因此您会在安装了 SDK 的机器上遇到错误等）。无法将调试程序集添加到生产解决方案中并通过非开发人员运行时访问它。

**Scott Barnes / Rich Platforms 产品经理 / Microsoft。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T22:33:50.310

所以我对这个问题的解决方案基本上是放弃我正在尝试做的事情。相反，我现在在正则表达式周围发生异常时调用 Web 服务。该 Web 服务有一个我创建的名为 GetRegexError 的函数。

这是它的代码：

```
<WebMethod()> _
Public Function GetRegexError(ByVal strRegex As String, ByVal _regexOptions As RegexOptions) As String
    Try
        Dim _regex As New Regex(strRegex, _regexOptions)
    Catch ex As Exception
        Return ex.Message
    End Try

    Return ""
End Function 
```

这现在在[Regex Hero](http://regexhero.net/)中实现。谢谢斯科特的帮助。

# python - Mapping a database table to an attribute of an object

> ID：834722
> 
> 赞同：0
> 
> 时间：2009-05-07T13:43:41.890
> 
> 标签：python, database, orm, sqlalchemy

I've come across a place in my current project where I have created several classes for storing a complicated data structure in memory and a completed SQL schema for storing the same data in a database. I've decided to use SQLAlchemy as an ORM layer as it seems the most flexible solution that I can tailor to my needs.

My problem is that I now need to map an entire table to just an array attribute in memory and am struggling to find out if this is possible and, if it is, how to do it with SQLAlchemy. It is still possible for me to change the data structures in code (although less than ideal) if not, but I would prefer not to.

The table in question is created using the following SQL:

```
CREATE TABLE `works` (
 `id` BIGINT NOT NULL auto_increment,
 `uniform_title` VARCHAR(255) NOT NULL,
 `created_date` DATE NOT NULL,
 `context` TEXT,
 `distinguishing_characteristics` TEXT,
 PRIMARY KEY (`id`),
 INDEX (`uniform_title` ASC),
 INDEX (`uniform_title` DESC)
) ENGINE = InnoDB DEFAULT CHARSET = utf8 ;

CREATE TABLE `variant_work_titles` (
 `id` BIGINT NOT NULL auto_increment,
 `work_id` BIGINT NOT NULL,
 `title` VARCHAR(255) NOT NULL,
 PRIMARY KEY(`id`),
 INDEX (`work_id`),
 INDEX (`title` ASC),
 INDEX (`title` DESC),
 FOREIGN KEY (`work_id`)
  REFERENCES `works` (`id`)
  ON DELETE CASCADE
  ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ; 
```

This is just a small part of the complete database and the same thing is going to be required in several places.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T15:07:41.830

It seems you want something like

```
work_instance.variants = [<some iterable of variants>] 
```

If not please clarify in your question.

Ideally you should have 2 mappings to these 2 tables. It doesn't matter if you won't access the second mapping anywhere else. `work` mapping should have a one-to-many relationship to `variant` mapping. This would give you a list of `variant` instances associated with a particular `work` on whichever attribute you define your relationship.

# null - 当显示只是噪音时， /dev/null 等效于 DISPLAY

> ID：834723
> 
> 赞同：22
> 
> 时间：2009-05-07T13:44:26.413
> 
> 标签：null, xserver

我正在运行一个 java 应用程序，它创建了它正在做的一些事情的视觉显示，同时它正在做这件事。但是，我想在一个没有要附加的显示器的脚本中运行它。在当前环境中，甚至没有设置 DISPLAY 环境变量。我试图简单地将我的 DISPLAY 设置为：0.0。但这不存在。我真的不关心显示器。我只想让应用程序静默处理文件。

因为我不能只关闭显示器（不是我的应用程序），所以我只能试图绕过显示器的需要。

有没有我可以将 DISPLAY 发送到的黑洞？相当于 /dev/null?

我在网上搜索了一下，但我能想到使用的词：“显示”“空”“忽略”等都是让我得到答案的两个通用词。

这是一个较大脚本的中间部分，因此我希望输出到 stdout 的其余部分可用。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-07T13:58:42.230

有一个名为[Xvfb](https://en.wikipedia.org/wiki/Xvfb)的无头 X 服务器。它基本上是您所需要的，因为它接受 X 客户端，但基本上对来自它们的数据不做任何事情。从那个链接的页面（稍微解释一下）：

> `Xvfb`X虚拟帧缓冲区，是一个实现X11显示服务器协议的显示服务器。
> 
> 与其他显示服务器相比，`Xvfb`在内存中执行所有图形操作而不显示任何屏幕输出。
> 
> 从客户端的角度来看，它的行为与任何其他 X 显示服务器完全一样，为请求提供服务并根据需要发送事件和错误。但是，没有显示输出。
> 
> 此虚拟服务器不需要运行它的计算机具有屏幕或任何输入设备。只需要一个网络层。

如果您找不到，那么另一种可能性是使用安装了完整 CygWin 的备用 PC。CygWin 带有一个成熟的 X 服务器，您可以将应用程序连接到它（并且忽略它）。您甚至可以将其设置为企业 /dev/null DISPLAY。

但我会先研究 Xvfb。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-04-07T20:48:20.160

简短的回答，使用：

```
xvfb-run JAVA_COMMAND_LINE 
```

根据您的 Linux 版本和风格，[您可能需要在 xvfb-run 中更改](https://bugzilla.redhat.com/show_bug.cgi?id=624510)一行代码才能运行所有内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T14:16:09.007

如果它是一个 java 程序，您可以使用无头模式来运行应用程序。

尝试使用`-Djava.awt.headless=true`参数运行它，如果它是 jar 文件，则如下所示：

`java -Djava.awt.headless=true -jar jarfile.jar`

[更多关于无头模式...](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/headless/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T14:11:52.323

如上所述，您可以使用 Xvfb。这样，您将永远看不到输出（不过，您可以使用工具截屏）。

[http://en.wikipedia.org/wiki/Xvfb](http://en.wikipedia.org/wiki/Xvfb) [http://packages.debian.org/sid/xvfb](http://packages.debian.org/sid/xvfb)

或者你可以设置一个 VNC 服务器。在 Linux 下，VNC 服务器被实现为可以通过 VNC 访问的特殊 X 服务器，而不是显示在本地监视器上。这为您提供了一个无头 X 服务器，另外还有一个好处是您可以通过 VNC 连接到它，以防万一您*确实*需要查看正在发生的事情。

[http://www.tightvnc.com/vncserver.1.html](http://www.tightvnc.com/vncserver.1.html)

vncserver 是（紧密）VNC 的一个很好的包装脚本，它使启动 VNC 服务器变得轻而易举。大多数发行版应该默认安装它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-10-06T17:41:25.607

我一直在使用 Xvfb，并且可以很好地运行需要在 ssh 会话中使用 X 服务器的应用程序。

为了补充之前的答案，我使用两种主要方式来运行 Xvfb：

1.  `Xvfb`在特定端口中运行并配置终端以使用此端口：

    ```
    Xvfb :10
    export DISPLAY=:10 
    YOUR_COMMAND 
    ```

2.  使用`xvfb-run`：

    ```
    xvfb-run YOUR_COMMAND 
    ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T14:07:13.160

你能在目标机器上运行虚拟机吗？然后你可以将你的 DISPLAY 设置为那个。或者您可以尝试 vnc （目前在不允许这样做的机器上，或者我会尝试......）。

# winapi - 当前 Windows 版本中的 Win32 API 是否仍然“原生”？

> ID：834724
> 
> 赞同：4
> 
> 时间：2009-05-07T13:44:33.323
> 
> 标签：winapi, windows-7, windows-vista, windows-xp

如果我的程序主要使用 win32 API，我的 API 调用是否在 Windows XP/Vista/7 中模拟？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T14:44:41.293

它下面有 Windows NT 内核，原生 NT 应用程序使用（大部分未记录的）NT API 与其交互。

`csrss.exe`，即“客户端/服务器运行时子系统”，是一个提供用户模式 ​​Win32 子系统和`win32k.sys`内核模式 Win32 子系统的原生 NT 应用程序。如果不加载这两个，Win32 应用程序将无法运行。

`smss.exe`，“会话管理子系统”，是启动期间要执行的第一个应用程序。作为其任务之一，它启动 Win32 子系统。

你认为什么是“本地人”？内核根本不理解 Win32——所有 Win32 API 调用都由运行时处理`csrss`，最终归结为 NT API 调用。但是你永远不会在没有 Win32 子系统的情况下运行 Windows。

* * *

还存在用于 Windows 的 OS/2 和 POSIX 子系统。我不相信它们是常用的。

* * *

如果您熟悉 UNIX，这里有一个粗略的类比：是[`syslog(3)`](http://linux.die.net/man/3/syslog)原生 API 吗？

POSIX 要求它的存在。它可能由`libc`运行时库实现为“连接到套接字/管道并发送消息”。`syslogd`除非守护程序正在运行，否则这将无法工作。守护程序由`syslogd`init 脚本启动。

这不是一个完美的类比。许多应用程序不依赖于`syslog(3)`，通常可以停止和重新启动`syslogd`守护程序而不会对系统的操作产生不利影响（与`csrss.exe`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T14:16:55.087

Jared 对命名的看法。不确定这是否是您所得到的，但如果您在 64 位操作系统上运行 32 位进程，则有一个允许它们运行的​​仿真（或“thunking”）层。这适用于所有 64 位版本的 Windows。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T13:46:06.317

不，Win32 API 的名称有点不对。它可能应该被命名为 Windows API。除非您的代码实际上在其中一种仿真模式下运行，否则它不会被仿真。

# iphone - OpenGL ES 中的小问题。什么是正确的实现？

> ID：834730
> 
> 赞同：1
> 
> 时间：2009-05-07T13:46:06.410
> 
> 标签：iphone, optimization, opengl-es

我正在使用 OpenGL ES 在 iPhone 上制作游戏。**不幸的是，我看到了小的（和不规则的）打嗝。**

我使用带睡眠的计时器，每 60 秒调用一次绘图函数，以保证稳定的帧速率。我试图改变定时器从睡眠中唤醒的时间，让绘图函数有更多时间执行。一旦给绘图功能更多时间，打嗝就会减少。8 毫秒，动画几乎是流畅的。我的发现是：

1.  显然，给 GPU 更多时间来执行实际绘图，会产生（几乎）完美的流畅动画。
2.  在我的框架的确切末端绘图会导致口吃、打嗝等等。

现在我知道了，**我不确定如何进行**。关于这种行为的原因，我有两个相互矛盾的想法：

1.  **首先，会不会是 OpenGL 命令干扰了前一帧的绘制？**据我了解，情况并非如此，因为命令已存储并且仅在给出绘图命令时才会执行。
2.  **其次，绘图命令的波动时间会导致计时器跳过一个刻度吗？**

**那么哪种解释更有可能呢？或者两者都不是？**当然，我可以尝试将绘图功能放在单独的线程中，看看是否能解决我的问题。但我希望更多地了解OpenGL。

这是被调用的函数，并解释了我正在做什么：

```
- (void) drawView
{
    // measure time with mach_absolute_time

    // gameEngine update    
    // OpenGL commands (translate, rotate, drawArrays etc.) 

    // end measure time with mach_absolute_time
    // usleep(animationInterval - duration  - constant) 
    // constant is the time to start executing

    // draw
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);
    [context presentRenderbuffer:GL_RENDERBUFFER_OES];    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T15:19:08.993

您可能想阅读[这篇关于游戏循环](http://dewitters.koonsolo.com/gameloop.html)的文章，其中解释了很多。一般来说，最好的解决方案是在一个单独的线程内的无限循环中调用绘图例程（参见[这个问题](https://stackoverflow.com/questions/96265/what-is-a-better-way-to-create-a-game-loop-on-the-iphone-other-than-using-nstimer)），并根据自上次更新以来经过的时间来更新底层游戏模型。这会给你流畅的动作。

编辑：至于“打嗝”的来源，它们可能与 OpenGL 无关。在 60 fps 时，我们说的是每帧 1/60 秒 ≈ 17 毫秒。这是一个很容易错过的紧凑计划，因为设备上正在运行其他进程。Safari 或 Mail.app 在后台唤醒，设备思考了一会儿，现在你的帧需要 30 毫秒甚至更多。如果您的模型期望完全稳定的帧速率，这很容易发现。解决方案是根据经过的实时更新模型，正如我在上面所写的。链接的文章彻底解释了这一切。

# svn - ClearCase 到 SVN 的迁移

> ID：834731
> 
> 赞同：4
> 
> 时间：2009-05-07T13:46:07.703
> 
> 标签：svn, migration, clearcase

好吧，我对 SVN 导入器工具有一个问题，该工具用于迁移具有悠久历史的 ClearCase VOB 之一。我们考虑通过提取 10 -15 个基准版本的代码并将其导入 SVN 来做到这一点。因此，为此我认为用户必须一一给我特定的版本。所以现在他问我如何在clearcase中指向特定版本并导出它？？.这里的想法是给我作为tar球的代码......这样我就可以在我的桌面上分解它然后将它导入到SVN。....!!!! 我不知道如何在 SVN 中的所有这些基线中导入/分层......这是否类似于 SVN。你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-06-27T08:00:31.367

另一种选择是 Migrate2SVN。开发人员 (Clearvision) 刚刚发布了 v2.0，它似乎对 Polarion 软件和上述其他方法进行了许多改进。

[http://www.clearvision-cm.com/clearcase-subversion-migration.html](http://www.clearvision-cm.com/clearcase-subversion-migration.html)

希望对与我登陆同一页面的任何 Google 员工有所帮助 :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T08:15:58.253

我自己做了一些clearcase迁移：这是我的想法：

1.  不要使用 Gary Ray 建议的导入器，因为它不是很成熟**。**它缺少许多您想要的功能，例如目录版本控制、带有旧文件名的正确标签、已删除文件的历史记录等。此导入器仅适用于您真正需要文件**内容**并且可能会丢失的小规模迁移整体**结构**变化

2.  创建要导出的标签列表

3.  编写一个脚本来为标签列表中的每个标签生成 clearcase config-spec

4.  替代方案：如果您无法在第 3 步中成功，则为每个标签创建一个配置规范列表

5.  tar 并压缩您的 clearcase 视图并复制在您的 SVN 机器上收集它

6.  将每个 zip 解压缩到一个文件夹

7.  用于`svn_load_dirs.pl`导入 SVN，您可能还想在 SVN 中创建标签

8.  使用下一个标签转到 6

请注意，这也适用于多个项目。但是，如果您有共享模块（SVN 中的弱点之一），您将需要一个特定的 repo 结构，并且导入到 SVN 可能会更复杂（可能使用 svn:externals）。你真的应该自动化这个过程，因为大多数时候你会多次导入，因为你的配置规范缺少文件，你的 SVN 结构会改变等等。所以编写解决方案并自动运行一切，这将更多灵活，直到所有迁移结束。您可能还需要查看迁移结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:17:24.540

我没有使用它，但我听说[SVNImporter](http://www.subversionary.org/projects/svnimporter)将导入您的 ClearCase VOBS，包括历史记录。

听起来您的用户真正要求的是一次从 CC 导出几个版本，以基本上“折叠”现有历史记录。例如，假设您有一个具有数千个修订版和数百个标签的大型 VOB，并且您希望仅将最近 5 个主要版本作为您的历史记录在新的 subversion 存储库中。您可以从 CC 导出所需的最早版本，导入 SVN 并创建工作副本。然后，您将从 CC 中导出一些更高版本并复制到您的工作副本中并进行更新。起泡、冲洗、重复，直到您从 CC 获得最新信息。

您从 CC 获得的版本由视图配置规范控制。要仅获取与特定标签关联的文件（希望它们具有标签...），请将配置规范更改为：

```
element /vob/MyPath/… DESIRED_LABEL 
```

要获取与标签关联的版本以及与您使用的该标签无关的任何内容的当前版本：

```
element /vob/MyPath/… DESIRED_LABEL
element /vobs/MyPath/… /main/LATEST 
```

有关更多信息，请参阅[IBM/Rational config_spec 文档](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/config_spec.htm)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T16:27:39.313

注意：如果“基线”指的是“UCM 基线”，对于给定的组件（Vob 中的文件树），这将变得更简单。

创建一个带有单个集成流和动态视图的 UCM 项目，然后：

```
ct lsbl -s component:myComponentToExport@\myPVob 
```

将为您提供要导出的基线列表。

```
ct rebase -bas myIntStream@\myPVob aBaseline 
```

在动态视图中会将视图设置为导出源。
（对每个基线重复，对于您要导入到最新的最旧的）

* * *

但是，如果您使用的是用 base-ClearCase（而不是 UCM）标记的数据，请注意这个问题：

base-ClearCase 标签可以放在任何文件上。像加里建议的那样规则

```
element /vob/MyPath/... DESIRED_LABEL 
```

可以很好地最终选择0个文件，只是因为标签' `DESIRED_LABEL`'没有放在根目录' `MyPath`'上！

* * *

此外，没有“时间线”修订的概念（如 Subversion 中的修订）。
如果标签被证明太不可靠（因为没有放在*所有*文件上），解决方案可能是将标签的日期与基于[时间的规则](https://stackoverflow.com/questions/634509/clearcase-loading-older-version-of-a-specific-directory/635282#635282)结合起来。

```
element /vob/MyPath/... DESIRED_LABEL
element /vob/MyPath/... .../myBranch/LATEST -time (date_Of_The_Label_Put) 
```

' `date_Of_The_Label_Put`' 是标签在至少一个元素上的应用日期。
如果某些元素没有被标记，它们仍然会以正确的版本被选择，即标签被部分应用于一组文件*时的版本。*

# wpf - NullReferenceException 从 DataTemplate 中的控件调用 RegisterName()

> ID：834739
> 
> 赞同：0
> 
> 时间：2009-05-07T13:47:46.420
> 
> 标签：wpf, binding, datatemplate

我创建了一个自定义 WPF 控件，它在动态创建的对象上执行一些动画。我使用 SetTargetName() 设置动画目标。（我知道 SetTarget()，但我需要支持没有 SP1 的 .NET 3.5。）显然在此之前我需要使用 RegisterName() 注册对象名称。当我的控件作为对象正常放置在窗口或页面中时，一切正常。

但是，当我将控件添加到 DataTemplate 时，我在调用 RegisterName() 时收到 NullReferenceException。

堆栈跟踪的顶部看起来像这样

> 在 System.Windows.TemplateNameScope.System.Windows.Markup.INameScope.RegisterName（字符串名称，对象 scopedElement）
> 在 System.Windows.FrameworkElement.RegisterName（字符串名称，对象 scopedElement）

我传递给 RegisterName 的两个参数都不为空，我调用它的对象也不为空。所以其他东西在内部必须为空，我不知道该怎么做。任何地方都没有关于 TemplateNameScope 的信息。

任何指针都受到高度赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T18:47:31.397

我今天经历了这一点。我的控件没有*直接*引用数据模板的绑定，所以我得到了这个异常。添加对绑定的令牌引用可解决此问题。例如，在我的自定义控件的 DataTemplate xaml 中：

DataContext="{绑定}"

# java - Java 反射等于问题

> ID：834743
> 
> 赞同：1
> 
> 时间：2009-05-07T13:48:45.890
> 
> 标签：java, reflection, equals

这是那些日子之一，有人可以帮我解决这个问题。

我有 2 个库存对象，我想在运行时比较它们的属性。一个实例是缓存实例，另一个是刚刚交付到我的系统的新库存实例，它可能等于也可能不等于缓存实例。见下文，其中 m 是 Stock 类的方法，stock 是 Stock 的实例

```
try {

// I want to compare these two objects, return type of m may vary
Object result = m.invoke(stock);
Object cacheResult = m.invoke(stockCache.get(ticker));

// The return type of m may vary but is known at runtime
Class returnType = m.getReturnType();

// I assume I need to cast before .equals() will work correctly
if(result.equals(cacheResult)) {
    // Will this work or do I need to cast
}

  }catch (Exception ex) {
 } 
```

编辑：对于那些询问我为什么使用反射的人，我正在使用反向 ajax 框架 DWR，并且我正在尝试将 html id 属性映射到我的对象属性，从而允许我使用它们关联的 HTML id 值来注释我的属性。将对象推送到 UI 时，此方法将允许我仅推送已更改的属性，而不是整个对象。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T13:50:35.900

你不应该需要投射。Java 会自动选择正确的`equals`方法。我建议您调试该行以查看`Class`每个对象是什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T13:56:36.853

不，你不需要投射。通常，equals 方法看起来像

```
@Override
public boolean equals(Object o){

   if (! o instance of ThisClass){
      return false;
   }

   //other equality tests based on members
 } 
```

如果您的缓存只保存一个类对象（即不缓存派生类），它应该可以工作。看起来您将对象存储在 StockCache 中。也许这有点太笼统了，缩小到某个基类（也许是 StockClass）会是一个更好的选择。然后，您的 getter 将在您的缓存类中定义为：

```
StockObject getStockObject(KeyType key); 
```

除此之外，反射似乎有点过头了（如果你已经有了想要比较的对象，为什么还要使用反射？）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T14:04:14.837

铸造在这里不会有任何影响。结果完全取决于如何在 Stock 类中实现 equals() 方法。

但是你为什么要为此使用反射呢？这很可能不是正确的做法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-29T15:32:05.317

看看这个：

[http://code.google.com/p/simplestuff](http://code.google.com/p/simplestuff)

# c# - 如何将非表数据导入 SQL Server Reporting Services？

> ID：834746
> 
> 赞同：12
> 
> 时间：2009-05-07T13:49:23.970
> 
> 标签：c#, sql, web-services, reporting-services

给定：加载对象模型的 AC# 计算引擎，处理大量数字，并将结果保存到 SQL Server 中的几个巨大的索引数据库表中。这些表为 Web 界面、其他软件模块和 SQL Server Reporting Services 2005 报告提供数据。

我设法在最新版本的软件中使引擎更快，速度*足够*快，现在它可以根据请求提供数据 - 有时甚至比查询数据库以获取预先计算的数字所花费的时间还要快。我对此感到非常高兴。

这一突破意味着我们可以根据 Web 界面和其他软件模块的请求生成数据。但是缓存表还不能消失，因为它们被 SSRS 报告（或者更具体地说，被查询表并向 SSRS 提供数据的存储过程所消耗）。

缓存表是一种痛苦，就像在软件世界中任何缓存都是一种痛苦一样。没有过多的细节，他们有同步问题，锁定问题等。如果我不必担心保持那些该死的表是最新的，该软件会更好地工作。

但是我还能如何将数据输入 SSRS？我做了相当多的研究，没有什么看起来太有希望的：

*   我们可以通过 Web 服务提供数据并使用 SSRS XML DPE。但这看起来有点可怕——我说得对吗，你必须自己解析你的 SOAP 信封？！而且它不支持 XPath，而是专有的 XPath-y 方言？我们的报告编写者了解 T-SQL，而这正是他们最擅长的。
*   使用 SQL CLR 来托管我们的 API 是不可取的——它是一个大应用程序，如果不创建应用程序对象并登录等，您将无法做任何事情。
*   使用 SQL CLR 联系 Web 应用程序上的 Web 服务 - 这是迄今为止最有前途的（这篇文章很有帮助[http://www.simple-talk.com/sql/sql-server-2005/practical-sql- server-2005-clr-assemblies/](http://www.simple-talk.com/sql/sql-server-2005/practical-sql-server-2005-clr-assemblies/)。）有人尝试过这种方法吗？性能好不好，能提供大数据集吗？OTOH 我被我们必须在客户端数据库服务器上进行的额外设置关闭了。
*   任何其他建议将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-07T15:57:51.290

如果我理解正确，您正在构建关于非 SQL 数据的报告。您将数据存储在表格中的特定目的是使其可报告。

我可以想到两种解决方案。第一个是使用[报告部分](http://www.codeproject.com/KB/dotnet/microsoftreporting.aspx)扩展您的 C# 计算引擎。Microsoft.Reporting.WinForms 和 Microsoft.Reporting.WebForms 命名空间可用于在任何数据源上构建报表，而不仅仅是 SQL Server。如果最终用户将您的应用程序用作客户端，您可以即时生成数据和报告。

二是使用SQL CLR。您可以使用 CLR 存储过程作为报告的基础（输入“exec mysp”作为数据源。）此 CLR 过程是 C# 代码，可以将计算引擎作为库包含在内。这将允许您即时生成报告，同时仍使用 Report Server 用户界面。

有趣的问题，我希望更多知识渊博的人可以提供更好的答案:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T12:03:06.690

我之前遇到过类似的情况，并尝试了 SSRS XML 数据源和 Andomar 提到的报告扩展。我的建议是使用 SSRS XML 数据源功能。如果 Web 服务返回的数据结构很简单，那么 XPath 也很简单。我还发现它更容易调试。需要注意的主要事情是超时。

使用 Web 服务的好处是它们很容易被许多不同的技术所使用，因此无论如何它们都可以变得非常方便。

此外，这是个人选择，但尽管有 SQL CLR 功能，但我仍然对将代码放入数据库感到不舒服。通过在 SSRS 中使用 XML 数据源，根本不需要涉及自定义 CLR 代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T18:03:46.290

您可以将数据包装在[ADO.NET 数据集中并将其用作 Reporting Services 数据源。](http://msdn.microsoft.com/en-us/library/aa902651(SQL.80).aspx).

我从来没有亲自使用过这个，所以我不能给你更多的信息。但是，我知道您可以从我参加的 SSRS 课程中做到这一点。当您在“现实世界”示例中执行此操作时，讲师给我的示例是如果您需要连接来自两个不同数据源的数据。例如，如果您想将来自 SQL Server 和 Oracle 的数据关联到一个报表中，您可以这样做。

我知道这不是您想要做的，但听起来它会提供您需要的相同抽象层。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T18:34:08.783

您是否考虑过在计算引擎之上编写自己的自定义数据库驱动程序？然后，您可以将报告服务指向它。尽管这可能是一项复杂的任务，但这将使事情保持快速。我过去曾考虑将它用于我正在开发的专有数据仓库软件，但从未着手构建驱动程序。

顺便说一句，很好的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T23:08:58.077

> 使用 SQL CLR 联系 Web 应用程序上的 Web 服务

这是我推荐的方式 - 我这样做是为了通过他们的 Web 服务访问 SharePoint 列表数据。如果可以修复数据模式，则 SQL CLR TVF 可能非常适合并产生最大的灵活性。如果您需要在执行时确定架构，那么您需要 SQL CLR 存储过程，因为它没有绑定到架构。

您需要的关键是：

```
-- enable CLR on the server
sp_configure 'clr_enabled', 1
GO
RECONFIGURE
GO

-- allow your db to execute clr code marked EXTERNAL or UNSAFE
alter database mydb set trustworthy on 
```

然后创建一个 VS sql clr 项目（您不必这样做，但它有助于部署和调试它），将权限级别设置为“外部”。如果您在 VS 项目中使用“添加 Web 引用”，则必须在构建/部署后打开序列化程序集的生成和 CREATE ASSEMBLY 以加载它。

这现在有点摇摆不定——老实说，我已经这样做了——我稍后会添加更多细节。上个月我做了一个关于 SQL CLR 的演讲。我的[示例代码](http://arizona.sqlpass.org/LinkClick.aspx?fileticket=yKSimKY9rrc%3d&tabid=1231&mid=2024&forcedownload=true)具有调用 Web 服务 (Fibonnaci) 的 GetFibs 项目，该项目也包括在内。

也看看这里： http: [//footheory.com/blogs/bennie/archive/2006/12/07/invoking-a-web-service-from-a-sqlclr-stored-procedure.aspx](http://footheory.com/blogs/bennie/archive/2006/12/07/invoking-a-web-service-from-a-sqlclr-stored-procedure.aspx)和[http:// www.codeproject.com/KB/database/SQLCLR.aspx?display=Print](http://www.codeproject.com/KB/database/SQLCLR.aspx?display=Print)

> 性能好不好，能提供大数据集吗？

是的，它似乎表现良好。通过一些额外的工作，您可以以更加面向流的方式构建它，它不会消耗整个集合的内存。查看 Range 示例或[此处](https://stackoverflow.com/questions/58429/sql-set-based-range/59657#59657)的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T16:15:15.083

我肯定会走[ADO.NET DPE 之路](http://msdn.microsoft.com/en-us/library/aa902651%28SQL.80%29.aspx)。如果您的数据源可以实时提供必要的数据，那将是最有意义的。您将为自己节省 1,2 或 3 层，这肯定会提高整体性能。并且不谈每一层代码的维护。将经过处理的数字数据公开为 ADO.NET 数据集并让您的报告服务直接查询它，在我看来是最好的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-20T08:25:03.573

In SQL 2008 you can use a SQL SSIS package as a datasource. Write a SSIS package to execute your calculation engine on the fly and output an in-memory .net dataset (DataReaderDestination). This can then be used for reporting.

# gcc - gcc makefile错误：“没有规则来制作目标......”

> ID：834748
> 
> 赞同：429
> 
> 时间：2009-05-07T13:49:54.637
> 
> 标签：gcc, makefile

我正在尝试将 GCC (linux) 与 makefile 一起使用来编译我的项目。

我收到以下错误，在这种情况下似乎无法破译：

```
"No rule to make target 'vertex.cpp', needed by 'vertex.o'.  Stop." 
```

这是生成文件：

```
a.out: vertex.o edge.o elist.o main.o vlist.o enode.o vnode.o
    g++ vertex.o edge.o elist.o main.o vlist.o enode.o vnode.o

main.o: main.cpp main.h
    g++ -c main.cpp

vertex.o: vertex.cpp vertex.h
    g++ -c vertex.cpp

edge.o: edge.cpp edge.h
    g++ -c num.cpp

vlist.o: vlist.cpp vlist.h
    g++ -c vlist.cpp

elist.o: elist.cpp elist.h
    g++ -c elist.cpp

vnode.o: vnode.cpp vnode.h
    g++ -c vnode.cpp

enode.o: enode.cpp enode.h
    g++ -c node.cpp 
```

* * *

## 回答 #1

> 赞同：505
> 
> 时间：2009-05-07T13:53:10.120

这通常是因为您没有可以`vertex.cpp`制作的文件。检查：

*   该文件存在。
*   当你制作时，你在正确的目录中。

除此之外，我没有太多建议。也许您可以给我们一个该目录的目录列表。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2012-04-23T14:36:53.450

根据我的经验，此错误通常是由**拼写**错误引起的。

我今天收到了这个错误。

> make[1]: *** 没有规则来制作目标`maintenaceDialog.cpp', needed by`maintenaceDialog.o'。停止。

就我而言，错误只是拼写错误。MAINTENANCE 这个词缺少它的第三个 N。

还要检查文件名的拼写。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-08-24T06:52:28.440

打印此消息的更常见原因是您忘记包含源文件所在的目录。结果，gcc“认为”这个文件不存在。

您可以使用 -I 参数将目录添加到 gcc。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-06-24T17:17:49.590

在我的例子中，我使用逗号作为分隔符。要使用您的示例，我这样做了：

```
a.out: vertex.o, edge.o, elist.o, main.o, vlist.o, enode.o, vnode.o
    g++ vertex.o edge.o elist.o main.o vlist.o enode.o vnode.o 
```

将其更改为等效于

```
a.out: vertex.o edge.o elist.o main.o vlist.o enode.o vnode.o
    g++ vertex.o edge.o elist.o main.o vlist.o enode.o vnode.o 
```

修复。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-05-07T13:54:23.753

是这样吗？请记住，Makefile 语法可以识别空格，并且需要制表符来缩进操作下的命令。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-02-11T19:14:58.187

我发现的问题比其他人提到的还要愚蠢。

我们的 makefile 获得了要构建的东西的列表。有人添加`TheOtherLibrary`到其中一个列表中，如下所示。

```
LIBRARYDIRS = src/Library
LIBRARYDIRS = src/TheOtherLibrary 
```

他们应该这样做：

```
LIBRARYDIRS = src/Library
LIBRARYDIRS += src/TheOtherLibrary 
```

如果他们以第二种方式完成，他们就不会消灭`Library`构建。加号`+=`非常重要。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-07-03T23:48:26.473

一个常见的错误可能是**另一个文件名**中的拼写错误。

您的示例非常简单，但有时可能会令人困惑的是`make`其本身的消息。让我们考虑一个例子。

我的文件夹内容是：

```
$ ls -1
another_file
index.md
makefile 
```

而我的`makefile`样子

```
all: index.html

%.html: %.md wrong_path_to_another_file
    @echo $@ $< 
```

虽然我确实有`index.md`它应该在的地方并且它的名称没有错误，但来自的消息`make`将是

```
make: *** No rule to make target `index.html', needed by `all'.  Stop. 
```

老实说**，这个消息令人困惑**。它只是说，没有规则。事实上，这意味着规则是错误的，但由于通配符（模式）规则`make`无法确定究竟是什么导致了问题。

让我们稍微改变`makefile`一下，也就是说用显式规则替换模式：

```
index.html: index.md wrong_path_to_another_file 
```

现在我们得到的信息将是：

```
make: *** No rule to make target `wrong_path_to_another_file', needed by `index.html'.  Stop. 
```

奇迹！可以得出以下结论：

*   的消息`make`取决于规则，并不总是指向问题的根源

*   `makefile`与此消息指定的不同，您可能存在其他问题

现在我们提出了**检查规则中的其他依赖**项的想法：

```
all: index.html

%.html: %.md another_file
    @echo $@ $< 
```

只有这样才能为我们提供所需的结果：

```
$ make
index.html index.md 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-06-06T12:41:49.470

在我的情况下，这是由于 Makefile 中的多行规则错误。我有类似的东西：

```
OBJS-$(CONFIG_OBJ1)            += file1.o file2.o \
                                  file3.o file4.o \
OBJS-$(CONFIG_OBJ2)            += file5.o 
OBJS-$(CONFIG_OBJ3)            += file6.o
... 
```

规则中文件列表末尾的反斜杠`CONFIG_OBJ1`导致此错误。它应该是这样的：

```
OBJS-$(CONFIG_OBJ1)            += file1.o file2.o \
                                  file3.o file4.o
OBJS-$(CONFIG_OBJ2)            += file5.o
... 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-05-01T18:22:37.593

如果您尝试构建 John the Ripper “bleeding-jumbo” 并收到类似“make: *** No rule to make target 'linux-x86-64'”的错误。尝试运行此命令：`./configure && make`

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-12-24T17:35:07.960

就我而言，错误消息引用了一个旧文件名，该文件名不再存在，因为它已被重命名。原来，过时的信息不是来自 Makefile，而是来自目录中的`.deps`文件。

将文件从一台机器复制到另一台机器后，我遇到了这个错误。在那个过程中，我假设时间戳处于不一致的状态，这在并行运行多个作业时混淆了“make”（类似于[这个错误报告](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=45118)）。

顺序构建`make -j 1`不受影响，但我花了一段时间才意识到，因为我使用了别名 ( `make -j 8`)。

为了清理状态，我删除了所有`.deps`文件并重新生成了 Makefile。这些是我使用的命令：

```
find | grep '.deps' | xargs rm
find | grep '.deps' | xargs rmdir
autoreconf --install # (optional, but my project is using autotools) 
./configure 
```

在那之后，建筑再次工作。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-07-08T08:26:10.463

在我的情况下，这是由于我创建了文件，`MakeFile`而不是它应该是`Makefile`.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-12-31T00:05:05.273

另一个奇怪的问题及其解决方案的例子：

这：

```
target_link_libraries(
    ${PROJECT_NAME}
    ${Poco_LIBRARIES}
    ${Poco_Foundation_LIBRARY}
    ${Poco_Net_LIBRARY}
    ${Poco_Util_LIBRARY}
    ) 
```

给出：`make[3]: *** No rule to make target '/usr/lib/libPocoFoundationd.so', needed by '../hello_poco/bin/mac/HelloPoco'. Stop.`

但是，如果我将其删除`Poco_LIBRARIES`，则可以：

```
target_link_libraries(
    ${PROJECT_NAME}
    ${Poco_Foundation_LIBRARY}
    ${Poco_Net_LIBRARY}
    ${Poco_Util_LIBRARY}
    ) 
```

我在 Mac 上使用 clang8，在 Linux 上使用 clang 3.9 这个问题只出现在 Linux 上，但在 Mac 上有效！

我忘了提：`Poco_LIBRARIES`错了 - 它不是由 cmake/find_package 设置的！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-01-08T10:24:17.347

在我的情况下，路径未在 VPATH 中设置，添加后错误消失了。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-05-17T15:42:40.217

此错误有多种原因。

我遇到此错误的原因之一是在为 linux 和 windows 构建时。

我有一个大写的文件名 BaseClass.h SubClass.h Unix 维护有区分大小写的文件命名约定，而 windows 不区分大小写。

[C++ 为什么人们不在头文件名中使用大写？](https://stackoverflow.com/questions/30503532/c-why-people-dont-use-uppercase-in-name-of-header-files)

如果您正在使用 gmake，请尝试使用 gmake clean 编译干净的构建

某些文本编辑器具有默认设置以忽略区分大小写的文件名。这也可能导致同样的错误。

[如何在 Qt Creator 中添加名称以大写字母开头的 c++ 文件？它会自动使它变成小写字母](https://stackoverflow.com/questions/34792511/how-to-add-a-c-file-in-qt-creator-whose-name-starts-with-capital-letters-it)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-09-14T20:58:02.860

这条信息可以清楚地表明很多事情。

就我而言，它是使用多个线程进行编译的。一个线程需要另一个线程尚未完成的依赖关系，从而导致错误。

并非所有构建都是线程安全的，因此如果您的构建通过了其他测试（例如上面列出的测试），请考虑使用一个线程进行慢速构建。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-10-27T03:15:06.080

我的案子失踪了`$`：

代替：

```
(LINK_TARGET): $(OBJS) 
```

应该：

```
$(LINK_TARGET): $(OBJS) 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-10-31T09:14:33.733

**就我而言，此错误的原因是文件夹名称有空格，重命名文件夹解决了问题**

* * *

例子：

```
~/foo bar/mymoduledir 
```

将文件夹重命名`foo bar`为`foo_bar`：

```
~/foo_bar/mymoduledir 
```

解决问题

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-06-02T19:57:14.680

就我而言，源文件和/或旧目标文件被半崩溃的 IDE 或停止正常工作的备份云服务锁定（只读）。重新启动与文件夹结构关联的所有程序和服务解决了该问题。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-09-26T18:22:39.523

当我忘记将新文件添加到我的 git 存储库时，我在 Travis 内部发生了这个错误。愚蠢的错误，但我可以看到它很常见。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-11-27T08:53:26.987

在我的情况下，在删除一些头文件和 .c 文件并且项目没有编译后，问题突然出现了。

运行**clean**然后**build**编译项目

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2014-12-06T21:25:30.027

就我而言，这是由于我调用了 Makefile: MAKEFILE (all caps)

# forum - 如何阻止不良用户和垃圾邮件发送者在论坛中插入不需要的数据？

> ID：834749
> 
> 赞同：2
> 
> 时间：2009-05-07T13:50:13.467
> 
> 标签：forum, spam-prevention

我想避免垃圾邮件发送者将广告和诅咒[放入论坛]。最好的方法是什么？“验证码”是 100% 可靠的好方法吗？阻止 IP 地址是个好方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T13:53:25.817

没有 100% 的方法。您唯一的希望是结合一堆方法，并手动监控您的站点，因为有人会找到绕过您所有方法的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T15:09:56.723

我发现以下组合效果很好：

*   适度。您可能永远不会幸运地阻止 100% 的不良内容
*   主持的帐户激活。虽然这需要您或其他版主的输入，但它可以防止机会主义黑客进行“偷偷摸摸”的破坏。您还可以查看他们的个人资料，看看他们是否包含营销链接作为他们的主页/签名等。我发现许多垃圾邮件发送者试图以这种方式注册
*   [用recaptcha](http://recaptcha.net/)替换内置（易受攻击的）验证码
*   禁止一次性电子邮件地址。有不少来自 10minutemail 等公司的域名。如果您想吸引回头客，没有人应该使用一次性电子邮件帐户
*   禁止 IP 地址，而不是用户名。如果您遇到垃圾邮件发送者，请禁止他们的 IP 地址以防止重新注册。phpBB 和其他流行的论坛软件对此有支持
*   如果存在，请使用论坛的关键字审查工具。如果您正在运行面向家庭的论坛，这对于防止脏话特别有用。再说一次，我知道 phpBB 有这个功能，要么是内置的，要么是通过 mod 提供的
*   在用户发布 x 条消息（通常为 1-5 条）之前，不允许发布链接。大多数垃圾邮件发送者都是机会主义的，并且会转向更容易的目标。或者，对他们的第一条消息强制执行审核（并且不要事先告诉他们！）
*   跟踪您的活跃用户。停用例如 12 个月没有贡献的老用户。如果他们要求，您可以随时重新激活它们

请注意，以上都没有真正正面解决这个问题，这永远不会真正起作用。我认为最好在用户发布之前对其进行管理，而不是在用户发布之后进行清理。

祝您的解决方案好运。即使不受欢迎的人有时会让您的生活陷入困境，主持论坛可能会非常有益！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:11:37.083

为其他用户实施该功能以报告滥用行为。可能在 10 次报告后隐藏消息，在 50 次报告后共同阻止用户。只允许经过验证的用户（可能注册 30 天）提交报告。

处理这种虐待的唯一方法是人类智慧与临界数量的参与者相结合，以克服“坏人”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T14:10:44.713

有很多自动化技巧；在谷歌输入“论坛垃圾邮件预防”，你会得到很多阅读材料。但保罗是对的：人类的节制是无可替代的。自动化技巧所能做的最好的事情就是将垃圾邮件的数量控制在管理员可以管理的水平。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T14:20:46.420

在消息阻止之上分层的一种微妙方法是*不*阻止原始海报的消息。张贴者会认为破坏行为/手推车正在通过，但没有人真正关心。

# javascript - 页面加载上的 AJAX 不是一件坏事吗？

> ID：834751
> 
> 赞同：7
> 
> 时间：2009-05-07T13:50:27.303
> 
> 标签：javascript, ajax

我在[书呆子晚餐](http://nerddinner.codeplex.com)和其他网站上看到过这个。在页面加载时（在 JavaScript 中，通过浏览器），AJAX 请求将发出以从呈现初始页面的同一服务器获取一些数据。数据会很小，并且没有任何技术限制会阻止他们从一开始就提取这些数据。

这不是一件坏事吗？这似乎是在浪费 AJAX 调用，因为他们可以将这些数据作为 JavaScript 与页面的其余部分一起呈现。

我的银行使用 AJAX 提取信息以构建“转账”表单的表单元素。该信息只有几千字节，那里的 AJAX 请求似乎有点过头了。

在书呆子晚餐中，至少在我看到的[MIX09 视频中，他们正在查询（通过 AJAX）一组晚餐，以便在页面加载时在地图控件上呈现。](http://videos.visitmix.com/MIX09/T49F)

我可以理解如果我们谈论的是大量数据，否则这些数据需要很长时间才能拉下来，但如果它低于 10-15kb，那么用标记拉下数据不是更好吗？他们这样做是为了避免缓存数据吗？

编辑：我的提议是，与其打开对服务器的 AJAX 调用以在客户端 onload 上下拉 json 数据，不如让 asp.net（或其他任何东西）在呈现其他所有内容时呈现页面内容中的 json . 我只是觉得有必要指出这一点，因为实际的客户端代码将完全相同，除了 json 变量的来源。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-07T13:54:27.840

一般来说，根据我的经验，您希望尽可能避免页面上的任何 Javascript。我的意思是，如果你可以在服务器端而不是使用 Javascript 来做，那么你应该这样做。您的页面将加载得更快，您将获得更好的用户体验。

有时这可能需要更多的工作，特别是如果稍后在页面期间使用相同的加载 AJAX 调用。您可能会通过在服务器端执行代码来复制代码。所以在性能和你想写多少代码之间有一个权衡。

另一个方面是 Javascript 有时用于防御机器人、爬虫、恶意软件（如密钥嗅探器等）等，以确保您和网站的安全。这可能意味着，例如，使用 Javascript 加载页面元素仅仅是因为它更难被破解或抓取。不是不可能，只是更难。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-07T15:41:19.940

## 返回键

如果用户点击后退/前进，服务器将不会再次被调用，因为它会将内容拉出缓存。但是，通过客户端页面加载的 ajax 调用，服务器将始终被调用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T14:10:10.533

我会编写初始页面服务器端以包含第一个可能的 AJAX 调用，然后再使用实际的 AJAX 进行任何操作。您希望自己做更多的工作，以使最终用户更快。

我见过一个使用 AJAX 作为主要内容的网站。当侧面加载时，它会显示导航栏，然后再过 5 秒钟你什么都看不到，因为它加载了 AJAX 调用，你已经失去了排队的位置。真烦人。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T14:13:32.117

我在加载时使用 AJAX 主要是为了避免重复工作并保持简单 - 如果无论如何我需要进行客户端渲染以进行更新，最好使用相同的代码进行初始渲染。

由 javascript 生成的所有内容确实对搜索等有影响，但只要您在设计页面时意识到这一点，这并不是什么大问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-07T14:21:06.013

一般来说你是对的，如果你最初是从服务器上拉页面，为什么还要再去获取更多数据呢？但是，如果数据很大，那么您最好让页面加载，以便最终用户可以看到一些东西，然后提取数据。

数据可能会以 Ajax 方式提取，因为页面上经常使用类似的数据检索方法。如果您要进行一些 Ajax 加载，为什么还要为初始加载编写单独的数据拉取机制。

另外，永远记住演示就是这样，演示。与其他优先事项相比，Nerd Dinner 的人可能更感兴趣的是展示如何将 AJAX 与 MVC 结合使用。

无论如何，很好的收获。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-07T14:25:06.503

只是我可以看到这样做的一个原因：

执行 AJAX 调用以加载初始数据可以作为验证 Javascript 是否已打开以及后续 AJAX 调用是否应该工作的一种方式。否则会发生什么，客户端使用 JavaScript 对服务器的第一次调用不起作用，用户可能会因为这不起作用而感到沮丧，而没有意识到他们的安全设置是原因。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-07T22:59:35.813

我同意亚当的观点。如果您有一个大型复杂页面，可能需要服务器一段时间才能呈现，但其中只有少量动态内容，那么您可以通过积极缓存 HTML 并使用 Ajax 加载动态内容来获得巨大的性能优势。

作为一个例子，想象一个站点的主页应该在角落里显示用户的名字。每个访问您网站的人都会点击该页面，因此您可以为 HTML 管理的缓存越多越好。通过使用 Ajax 填写用户名，您可以为每个人提供相同的可缓存 HTML 版本，并分别提供更小的动态内容。

如果您使用的服务器技术不是特别快，那么可缓存性就变得更加重要——可能是 Ruby on Rails。您可以通过代理（例如 Varnish 或 Squid）提供页面来获得不错的服务器端速度提升，该代理保留所服务的每个页面的缓存副本。对同一资源的后续请求将由代理的缓存而不是您的服务器代码提供服务，直到缓存变得陈旧。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-07T14:08:03.033

我不知道请求/响应的大小在这里有什么相关性。是否使用 AJAX 更多的是可用性问题，这里的一个因素是渲染初始页面的时间。用户不想等待。如果您只需要 2 秒就可以在服务器端计算一个页面元素，那么您绝对应该考虑先发送没有该元素的页面，然后通过 ajax 获取该元素。即使该页面元素只有几个字节。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-07T14:19:36.737

页面加载时的 AJAX 调用是为了保持表示与内容/数据的分离。

浏览器可以缓存演示文稿（HTML 页面），并且 AJAX 调用仅检索数据以更新 UI。

这可以导致非常干净的分离以及一些性能优势。实际上，您通过网络传输的信息更少，因为您没有传递 HTML 标签汤 - 只是您拥有数据的任何表示形式。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-07T14:20:49.667

主要问题不是大小，而是可用并行请求槽的额外请求延迟/阻塞。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-07T16:10:52.460

在页面加载时反对 Ajax

*   在您的服务器上使用额外的可用连接来处理 AJAX 请求。
*   在尝试完成通话时可以让您的页面处于空闲状态。
*   不能被搜索引擎索引。

对于页面加载的 Ajax

*   方便的。将数据保留在页面之外。
*   使数据更容易更改。
*   能够实现 Ajax 响应的缓存。
*   创建许多“小部件”，每个小部件都有自己的调用。

其中很多也取决于您的建筑所在的位置。您要小心较大的网站，不要在页面加载时依赖大量的小 Ajax 调用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-07T16:58:22.063

这样做的最佳理由是为内容提供**单一来源**：现在每个实例都来自 Ajax，而不是嵌入页面中的第一个实例和来自 Ajax 的更新实例。

换句话说：按照自己的方式去做是双重工作，有可能（由于错误）两个版本的行为不同。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-10-30T15:57:56.387

最好的解决方案似乎是在服务器端调用 Ajax 函数并在页面加载时加载 json 内容。这使事情保持一致并避免启动时的额外连接。

# php - 处理存储在配置文件中的变量的最佳实践是什么？

> ID：834756
> 
> 赞同：3
> 
> 时间：2009-05-07T13:51:16.430
> 
> 标签：php

如果我使用配置文件来存储例如站点名称、数据库主机等。处理此问题的最佳做法是什么？

1.  `$sitename="stackoverflow.com";`然后在函数中设置全局 $sitename
2.  `DEFINE(_SITENAME,"stackoverflow.com")`
3.  `function vars(){return array(sitename=>"stackoverflow");}`
4.  ?

我想要一个关于为什么我应该选择一个而不是另一个的技术解释。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T14:04:01.500

**将应用程序级**配置指令保存在单独的配置文本或 XML 文件中通常被认为是“更好”的做法。您可以创建一个作为单例实例加载的类，该实例解析文件并为您提供所需的内容，例如：

```
$config->get('DB_HOSTNAME'); 
```

看看[Zend_Config](http://framework.zend.com/manual/en/zend.config.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T14:39:46.220

我倾向于将 define() 用于“环境”配置，因为引用常量*应该*比调用新函数更快。它在概念上也符合我正在做的事情：

```
/**
 * Set the application mode. Valid options are "development" and "production"
 */
define('APP_MODE', 'development');

// Database Host
define('DB_HOST', 'localhost'); 
```

另一种选择是使用 ini 文件（确保它们**不在**web 根目录中）和`parse_ini_file()`函数，尽管您应该只运行一次，然后使用单例访问变量。（真的，您应该延迟加载它，仅在发出第一个请求时解析文件。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:38:42.790

您可以使用函数`parse_ini_file`或`parse_ini_string`. 您的配置将以与 php.ini 相同的格式存储。

*   [http://us.php.net/manual/en/function.parse-ini-file.php](http://us.php.net/manual/en/function.parse-ini-file.php)
*   [http://us.php.net/manual/en/function.parse-ini-string.php](http://us.php.net/manual/en/function.parse-ini-string.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T14:44:52.510

我喜欢使用定义，因为它可以防止您以后意外更改常量。它还可以更容易地在您的代码中告诉您正在使用常量。

其他人提到使用配置文件 - 这是一个好主意，但在大多数语言中这样做的主要原因是您可以更改配置文件而无需重新构建/部署应用程序。由于 PHP 不是一种编译语言，我认为在 PHP 中使用 ini 或 XML 配置文件并没有太大的实际好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T10:30:58.133

我喜欢使用符合 karim79 建议的全局单例对象，并让单例类的实现使用 parse_ini_file 从一组 .ini 文件中读取配置。为每个服务器环境设置单独的 .ini 文件也是一种很好的做法，例如

production.ini testlab.ini demoserver.ini

然后，您可以根据当前主机名自动选择要加载的正确配置。处理这个问题的所有逻辑都应该放在单例实现中。

# javascript - 为什么 getDay 返回不正确的值？(javascript)

> ID：834757
> 
> 赞同：13
> 
> 时间：2009-05-07T13:51:17.240
> 
> 标签：javascript, datetime

我试图用Javascript`getDay()`中的对象的功能来获取一周中的哪一天。`Date`理论上它工作正常，但有时输出会有延迟，所以如果函数应该返回“4”，它会返回“1”。

例如

```
var date= new Date("2009","04","30");
alert(date.getDay()); // the function returns 6, should return 4

var date= new Date("2009","05","01");
alert(date.getDay()); // the function returns 1, should return 5 
```

我真的不知道为什么会这样。这个例子来自 IE8。FF 3 的行为相似，但返回的值不同。第一个是 7，而不是 4。第二个就像在 IE8 中一样。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-07T13:59:13.413

因为月份编号是从零开始的，而不是从一开始的。

`new Date("2009","04","30")`**为 5 月 30 日而**不是 4 月 30日创建一个`Date`对象。

 **（它基于零的原因可能是历史性的，即它的行为与过去不同系统中的某些方法相同......）

# java - 在 JTextfield 中保留键盘布局？

> ID：834758
> 
> 赞同：3
> 
> 时间：2009-05-07T13:51:23.450
> 
> 标签：java, swing, keyboard-layout

简单示例： 2 `JTextFields`，一个用于西班牙语单词，另一个用于翻译。有没有办法保留键盘布局，`JTextField`以便用户不必来回切换？

TIA。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T14:40:18.980

是的，此演示代码使用每个文本字段中所选语言环境的键盘布局：

```
public class InputMethodTest {

  public static void main(String[] args) {
    final InputContext en = InputContext.getInstance();
    en.selectInputMethod(Locale.UK);
    final InputContext es = InputContext.getInstance();
    es.selectInputMethod(new Locale("es", "ES"));
    JTextArea english = new JTextArea() {
      @Override
      public InputContext getInputContext() {
        return en;
      }
    };
    JTextArea spanish = new JTextArea() {
      @Override
      public InputContext getInputContext() {
        return es;
      }
    };

    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.getContentPane().setLayout(new GridLayout());
    frame.getContentPane().add(new JScrollPane(english));
    frame.getContentPane().add(new JScrollPane(spanish));
    frame.setSize(600, 400);
    frame.setVisible(true);
  }
} 
```

在安装了 EN 和 ES 键盘布局的 Windows XP Home 上进行了测试（通过控制面板 > 区域和语言选项 > 语言 > 详细信息...）。有关更多详细信息，请参阅[Java 输入法框架](http://java.sun.com/javase/6/docs/technotes/guides/imf/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T13:58:43.790

不，键盘布局由操作系统或桌面环境管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T14:38:11.840

如果您确切知道相关西班牙语键盘的布局，理论上您可以自己处理 KeyEvent，将它们翻译成适当的字符。然而，这并不是一件容易的事。您最终可能会自己在文本字段中插入字符。

# sdk - API 和 SDK 的区别

> ID：834763
> 
> 赞同：193
> 
> 时间：2009-05-07T13:52:20.140
> 
> 标签：sdk, terminology

我试图向非开发人员解释 API 和 SDK 之间的区别。我需要解释为什么商业指纹软件供应商可能不会提供 SDK，尽管他们肯定使用过。

设备供应商和软件供应商都可以而且应该公开定义良好的 API。此 API 允许（写入）其他软件程序与供应商自己的软件组件或硬件设备进行互操作。

如果有人有更多想法可以清楚地解释这一点，我将非常感谢这些建议。我想强调，**目标是向不懂开发人员术语的非程序员解释这些概念**。

具体来说，在指纹传感器与软件进行注册/验证的背景下，我试图解释它：

> 如果我是指纹设备/传感器制造商而不是编写软件业务，我可以更好地推销我的产品的方式是：
> 
> 1.  确保我的设备驱动程序可安装在各种操作系统上
> 2.  定义并提供 API 供软件开发人员编写程序（例如，用于注册、验证）以“交谈”或使用我的设备
> 3.  开发并提供 SDK（超越 API 的一步），让软件开发人员更轻松、更快捷地编写适用于我的设备的程序。SDK 可以提供帮助代码库、参考应用程序、文档等。

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2009-05-07T13:59:19.187

小菜一碟：

*   API 是一个**接口**。这就像电话系统的规格或您家中的电线。只要知道如何接口，任何东西*都可以使用它。您甚至可以购买现成的软件来使用特定的 API，就像您可以购买现成的电话设备或插入您家中交流电线的设备一样。
*   SDK 是**实现工具**。它就像一个套件，允许**您构建定制的东西以连接到电话系统或电线。

*任何东西都可以使用 API。一些 API 具有要求许可证密钥、身份验证等的安全规定，这可能会禁止在特定情况下完全使用 API，但这只是因为特定的身份验证/授权步骤失败。任何提供正确凭据（如果需要）的软件都可以使用该 API。

**从技术上讲，如果 API 有详细记录，则您不需要 SDK 来构建您自己的软件来使用该 API。但是拥有 SDK 通常会使该过程变得更加容易。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2013-03-07T11:44:56.163

**API**就像一些令人费解的游戏的积木，孩子们可以用它来连接不同形状的积木并构建他们能想到的东西。

**另一方面，**SDK是一个合适的工作室，所有的开发工具都可用，而不是预成型的构建块。**在工作室中，您拥有实际的工具，并且您不仅限于积木，因此可以制作自己的积木，或者可以在没有任何积木的情况下创建一些东西。**

 *****没有 SDK 或 API****的编码就像在没有车间的情况下从头开始制作一样 - 你甚至必须制作自己的工具*

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2010-06-24T03:20:18.610

假设公司 C 提供产品 P 并且 P 以某种方式涉及软件。然后 C 可以向驱动 P 的软件系统的软件开发人员提供一个库/一组库。

该库/库是一个**SDK**。它是 P 系统的一部分。它是软件开发人员用来修改、配置、修复、改进 P 的软件部分的工具包。

如果 C 想将 P 的功能提供给其他公司/系统，它会使用**API**来实现。

这是 P 的接口。外部系统与 P 交互的一种方式。

如果您从实现的角度考虑，它们看起来会非常相似。尤其是现在互联网已经成为一个大型分布式操作系统。

但是，在目的上，它们实际上是截然不同的。

您使用 SDK 构建一些东西，然后使用 API 使用或消费一些东西。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-03-15T23:33:34.453

**应用程序编程接口**是一组例程/数据结构/类，它指定与目标平台/软件（如 OS X、Android、项目管理应用程序、虚拟化软件等）交互的方式。

虽然**软件开发工具包**是 API/s 的包装器，但它使开发人员的工作变得容易。

例如，Android SDK 便于开发人员与整个 Android 平台进行交互，而平台本身是由通过 API 通信的复合软件组件构建的。

此外，有时会构建 SDK 以促进使用特定编程语言进行开发。例如，[Selenium Web 驱动程序](http://docs.seleniumhq.org/projects/webdriver/)（内置于 Java）提供 API 来原生驱动任何浏览器，而[capybara](https://rubygems.org/gems/capybara)可以被认为是一个 SDK，方便 Ruby 开发人员使用 Selenium Web 驱动程序。但是，Selenium Web 驱动程序本身也是一个 SDK，因为它将与各种本机浏览器驱动程序的交互组合到一个包中。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-07T13:59:45.270

我不确定这两个术语是否有任何官方定义。我理解 API 是一组记录在案的可编程库和支持源，例如头文件或 IDL 文件。SDK 通常包含 API，但通常会添加编译器、工具和示例。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-12-12T18:22:31.033

API 是关于如何做某事的规范，一个接口，例如“铁轨相距 4 英尺，金属条宽 1 英寸” 现在您有了 API，您现在可以构建适合这些铁路的火车如果您想去任何地方，请跟踪。API 只是有关如何构建代码的信息，它不做任何事情。

SDK是一些已经担心规范的实际工具包。“这里有一列火车、一些煤和一个维修工。用它来从一个地方到另一个地方” 使用 SDK，您不必担心细节。SDK是实际的代码，它自己可以用来做一些事情，但是当然，火车不会自发启动，你仍然需要一个列车员来控制火车。

SDK 也有自己的 API。“如果你想给火车提供动力，把煤放进去”，“拉动蓝色的杠杆来移动火车。”，“如果火车开始表现得不好，打电话给维修工”等。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-03-20T16:20:15.493

API =可用单词及其含义的字典（以及组合它们所需的语法）

SDK = 一个文字处理系统……适用于 2 岁的婴儿……根据想法写作

虽然你可以在几年后上学并成为你的语言的大师，但使用 SDK 将帮助你立即写出整个有意义的句子（请原谅，在这个例子中，作为一个婴儿你还没有得到学习任何其他语言至少要学习使用 SDK。）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-11-17T23:51:39.940

怎么样...就像您想在家里安装家庭影院系统一样。使用 API 就像获取所有的电线、螺钉、钻头和零件。可能性是无穷无尽的（仅受您收到的作品的限制），但有时势不可挡。SDK 就像获得一个工具包。你仍然必须把它放在一起，但这更像是为宜家书架准备预裁片和说明书，而不是一盒螺丝。

# svn - 带有历史记录的 Subversion 存储库更新

> ID：834764
> 
> 赞同：2
> 
> 时间：2009-05-07T13:52:21.667
> 
> 标签：svn, repository, history

我有一个旧但非常重要的 Subversion 存储库，我没有从通常的结构开始创建它：主干、分支、标签。所以我在这个存储库中的所有文件都驻留在根目录中。

我知道如何创建新文件夹并将我的所有文件移动到主干中，但如果我这样做，我将失去我的项目历史 3 年，因为“主干”是一个新文件夹。那么有没有一种解决方案可以将我的整个项目的历史从根目录移动到主干文件夹？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T14:13:48.060

是的。您可以使用 svnadmin dump 将存储库与历史记录一起转储到文件中。然后，您可以使用 svnadmin load 将转储文件加载到主干文件夹中。完成后，从根目录中删除文件。

```
svnadmin dump REPOS_PATH [-r LOWER[:UPPER]] [--incremental]
svnadmin load REPOS_PATH 
```

转储文档：[http](http://svnbook.red-bean.com/en/1.1/re31.html) ://svnbook.red-bean.com/en/1.1/re31.html 加载文档：[http ://svnbook.red-bean.com/en/1.0/re36.html](http://svnbook.red-bean.com/en/1.0/re36.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T15:00:37.120

您可以使用

```
svn copy http://my.server/svn/repos/ http://my.server/svn/repos/trunk/ \
     -m "Copied" 
```

创建从存储库根目录 (^/) 到 trunk/ (^/trunk) 的副本，保留所有历史记录，包括根目录的历史记录。

之后，您可以在下一次提交中删除旧位置中的文件和子目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T05:54:37.267

如果您使用 svn mv 文件，您不会丢失历史记录。历史将被保留。因此，您可以使用 svnadmin load -parent-dir 主干重做您的存储库，但您需要重新检查所有内容，因为您应该在新存储库中有一个新的 UUID。

```
svn co http://example.com/repos/
cd repos
svn mkdir trunk tags branches
svn mv a trunk/a
svn mv b trunk/b
svn ci -m 'Moving project into trunk' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T14:10:00.033

诚然，这不是一个理想的解决方案，但为什么不创建一个全新的存储库，其内容是旧存储库中的所有代码，但很好地格式化为主干等。保持旧存储库完全独立，但使其只读。

不得不记住，在日期 X 之前，如果您需要了解项目的历史记录，您需要查看旧存储库而不是新存储库，这无疑是一件痛苦的事情。

# visual-studio - 每当我单击工作项时出现“无法加载”错误

> ID：834767
> 
> 赞同：2
> 
> 时间：2009-05-07T13:52:44.880
> 
> 标签：visual-studio, tfs

我最近在我的一台安装了 Visual Studio 2008 SP1 的机器上安装了 Team Explorer。但是知道每当我单击工作项或尝试打开团队查询时，我都会收到以下错误：

**无法从程序集“Microsoft.TeamFoundation.WorkItemTracking.Client，版本=9.0.0.0，文化=中性，PublicKeyToken=b03f5f7f11d50a3a”加载类型“Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemTypeDeniedOrNotExistException”**

我什至修复了 Team Explorer 2008 的安装，但它并没有解决我的问题。有谁知道我怎样才能摆脱这个错误？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T14:51:31.353

我最近在某处阅读了一篇博文，其中指出您必须在 SP1 之前安装 Team Explorer，否则您必须在安装 Team Explorer 后再次重新安装 SP1。

找到[博客文章的链接](http://blogs.msdn.com/kristol/archive/2009/05/04/installing-the-visual-studio-2008-development-stack-in-the-right-order.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T13:59:23.913

这几乎总是会发生，因为 Visual Studio RTM 和 SP1 二进制文件的版本不匹配。我找到了以下适合我的作品。

1.  卸载团队资源管理器
2.  修复 Visual Studio 安装
3.  安装 Team Explorer（来自网络）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-12T10:35:31.887

1 - 下载[Visual Studio 2008 团队资源管理器](http://www.microsoft.com/downloads/details.aspx?FamilyID=0ed12659-3d41-4420-bbb0-a46e51bfca86&displaylang=en ".iso 文件")

2 - 通过任何可以打开 .iso 的程序打开它 3 - 转到“Program Files\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies\” 4 - 将名称以“Microsoft.TeamFoundation.WorkItemTracking”开头的所有程序集复制到“ C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies\"

我通过这种方式解决了这个问题。希望它可以帮助你。谢谢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T06:34:14.607

重新安装 vs2008 sp1 为我解决了这个问题

# c++ - 网页抓取选项 - 仅限 C++ 版本

> ID：834768
> 
> 赞同：44
> 
> 时间：2009-05-07T13:52:50.857
> 
> 标签：c++, screen-scraping

我正在寻找一个用于网络抓取的优秀 C++ 库。
它**必须**是 C/C++，**没有**别的，所以请不要将我引导到[HTML 抓取选项](https://stackoverflow.com/questions/2861/options-for-html-scraping)或其他甚至没有提到 C++ 的 SO 问题/答案。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-07T14:12:41.260

*   **[libcurl](http://curl.haxx.se)**下载 html 文件
*   **[libtidy](http://www.html-tidy.org/)**转换为有效的 xml
*   **[libxml](http://www.xmlsoft.org/)**解析/导航 xml

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-09-08T12:30:29.323

[在此处](https://github.com/lexborisov/myhtml)使用 myhtml C/C++ 解析器；死的简单，*非常*快。除 C99 外没有依赖项。并且内置了 CSS 选择器（例如[这里](https://github.com/lexborisov/mycss/blob/master/examples/selectors_low_level.c)）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-05-31T08:38:03.267

我推荐 Qt5.6.2，这个强大的库为我们提供

1.  高级、直观、异步的网络 API，如 QNetworkAccessManager、QNetworkReply、QNetworkProxy 等
2.  强大的正则表达式类，如 QRegularExpression
3.  体面的网络引擎，如 QtWebEngine
4.  像 QWidgets 一样强大、成熟的 gui
5.  大部分 Qt5 api 都经过精心设计，signal 和 slot 也让编写异步代码变得更加容易
6.  出色的 Unicode 支持
7.  功能丰富的文件系统库。无论是创建、删除、重命名还是查找保存文件的标准路径在 Qt5 中都是小菜一碟
8.  QNetworkAccessManager 的异步 api 可以很容易地一次产生许多下载请求
9.  跨主要桌面平台、windows、mac os 和 linux，一次编译，随处编写，一个代码库。
10.  易于在 windows 和 mac 上部署（linux？也许 linuxdeployqt 可以为我们省去很多麻烦）
11.  易于安装在 windows、mac 和 linux 上
12.  等等

我已经用 Qt5 写了一个图像抓取应用程序，这个应用程序可以抓取几乎所有被谷歌、必应和雅虎搜索到的图像。

要了解更多细节，请访问[我的 github 项目](https://github.com/stereomatchingkiss/QImageScraper/blob/master/README.md)。我在我的博客上写下了关于如何通过 Qt5 抓取数据的高级概述（在堆栈溢出时发布太长）。

*   [通过 Qt5 下载 Bing 图像](http://qtandopencv.blogspot.my/2017/05/scrape-bing-images-by-qwebengine.html)

*   [通过 Qt5 创建更好的图像下载器（Google、Bing 和 Yahoo）](http://qtandopencv.blogspot.my/2017/05/create-better-images-downloadergoogle.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-17T16:12:18.707

```
// download winhttpclient.h
// --------------------------------
#include <winhttp\WinHttpClient.h>
using namespace std;
typedef unsigned char byte;
#define foreach         BOOST_FOREACH
#define reverse_foreach BOOST_REVERSE_FOREACH

bool substrexvealue(const std::wstring& html,const std::string& tg1,const std::string& tg2,std::string& value, long& next) {
    long p1,p2;
    std::wstring wtmp;
    std::wstring wtg1(tg1.begin(),tg1.end());
    std::wstring wtg2(tg2.begin(),tg2.end());

    p1=html.find(wtg1,next);
    if(p1!=std::wstring::npos) {
        p2=html.find(wtg2,next);
        if(p2!=std::wstring::npos) {
            p1+=wtg1.size();
            wtmp=html.substr(p1,p2-p1-1);
            value=std::string(wtmp.begin(),wtmp.end());
            boost::trim(value);
            next=p1+1;
        }
    }
    return p1!=std::wstring::npos;
}
bool extractvalue(const std::wstring& html,const std::string& tag,std::string& value, long& next) {
    long p1,p2,p3;
    std::wstring wtmp;
    std::wstring wtag(tag.begin(),tag.end());

    p1=html.find(wtag,next);
    if(p1!=std::wstring::npos) {
        p2=html.find(L">",p1+wtag.size()-1);
        p3=html.find(L"<",p2+1);
        wtmp=html.substr(p2+1,p3-p2-1);
        value=std::string(wtmp.begin(),wtmp.end());
        boost::trim(value);
        next=p1+1;
    }
    return p1!=std::wstring::npos;
}
bool GetHTML(const std::string& url,std::wstring& header,std::wstring& hmtl) {
    std::wstring wurl = std::wstring(url.begin(),url.end());
    bool ret=false;
    try {
        WinHttpClient client(wurl.c_str());
        std::string url_protocol=url.substr(0,5);
        std::transform(url_protocol.begin(), url_protocol.end(), url_protocol.begin(), (int (*)(int))std::toupper);
        if(url_protocol=="HTTPS")    client.SetRequireValidSslCertificates(false);
        client.SetUserAgent(L"User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0");
        if(client.SendHttpRequest()) {
            header = client.GetResponseHeader();
            hmtl = client.GetResponseContent();
            ret=true;
        }
    }catch(...) {
        header=L"Error";
        hmtl=L"";
    }
    return ret;
}
int main() {
    std::string url = "http://www.google.fr";
    std::wstring header,html;
    GetHTML(url,header,html));
} 
```

# asp.net - 帮助！ScriptResource.axd 每天大约有 500 个错误

> ID：834769
> 
> 赞同：0
> 
> 时间：2009-05-07T13:52:53.243
> 
> 标签：asp.net, ajax, updatepanel

我每天从 ScriptResource.axd（ASP.NET 网站）获得 500 多个异常。它似乎来自 Ajax 更新面板，但我不确定。无论如何，是否有可能修复这些异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T14:04:12.420

有一种简单的方法，这可能意味着相当多的工作，具体取决于您在开发过程中已经走了多远，但无论如何都会给您带来足够的好处，值得付出努力：**不要使用 ASP。网络更新面板**。

相反，看看[jQuery](http://www.jquery.com/)及其广泛的[ajax 支持](http://docs.jquery.com/ajax)。它将帮助您增加对您所做工作的控制，它将帮助您加快您的网站速度（很多），它将帮助您在客户端脚本方面变得更好。

# java - Java/SWT：如何从嵌入式窗口接收鼠标事件

> ID：834771
> 
> 赞同：1
> 
> 时间：2009-05-07T13:53:12.477
> 
> 标签：java, swt, hook, reparenting

我正在使用“reparenting”将 Windows 应用程序嵌入到我的 SWT 应用程序中。那部分工作正常。我现在想将我的 SWT 应用程序挂接到消息队列中，以便嵌入式应用程序接收鼠标移动事件。

我看到 SWT 中的 OS 类有许多有趣的方法来添加钩子，但我还没有弄清楚如何使用它们。

任何人都可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T03:42:54.410

这应该可行，但它依赖于使用反射来调用非 API，因此使用它需要您自担风险。

使用反射使 Display.addControl() 和 Display.removeControl() 可访问。然后，使用它将 Windows 应用程序的 HWND 和拥有控件添加到 Display 对象。现在，当鼠标移动事件被发送到嵌入式应用程序时，相应的控件应该得到一个鼠标移动事件。

为了更好地衡量，您应该在拥有的控件上添加一个 DisposeListener 并调用 removeControl()，这样事件就不会被发送到死 HWND。

# ruby - 有没有更简单的方法来刷新rails中的页面

> ID：834774
> 
> 赞同：1
> 
> 时间：2009-05-07T13:53:45.003
> 
> 标签：ruby

伙计们，我试图用一个按钮刷新我的页面.. `<input type="reset" value="Refresh" />` 但它不刷新，而不是刷新文本框 jst 来刷新整个页面。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T13:55:37.213

试试这个：

```
<INPUT TYPE="button" VALUE="Reload Page" onClick="history.go(0)"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-06T14:56:44.207

我知道这篇文章已经有四年了，但我想发布我使用 Rails 格式使用的片段。

```
<%= button_to "Refresh", "", { :onclick => "history.go(0)" } %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-29T10:30:46.563

就我而言，这非常有效：

```
= link_to "close", "", :onclick => '$("#ajax_form").hide(); history.go(0); return false;', :style => "color:white" 
```

# sql - 构建内部邮件系统

> ID：834781
> 
> 赞同：0
> 
> 时间：2009-05-07T13:55:24.657
> 
> 标签：sql, email, system, internal

我的数据库中有两个表：

*   公司表（ID、CompanyName、CompanyUsername、CompanyPassword）
*   员工表（ID、CompanyID、姓名、用户名、密码）

现在，我正在设计一个内部邮件系统，员工可以通过该系统互相写信，也可以直接写信到公司帐户。

我的内部邮件表有以下字段：

*   ID
*   发件人ID
*   ToID
*   信息
*   ...

现在我的问题出现了，当我用 ID（From/To）填充消息表时，我不知道消息是来自公司还是来自员工，因为两个表中都可能存在 ID。

我的解决方案是什么？

**更新**

上面的例子是为了简化我的问题。

员工和公司表不包含用户名或密码，而是对 ASP.NET`uniqueidentifier`用于管理登录的成员资格的引用。正如下面建议的使用 UI 来控制来自和接收者，我使用来自 ASP.NET 成员资格控制器的 UI。谢谢。:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T14:00:00.790

您可以使用两个外键，一个用于公司，一个用于员工，并确保只设置一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T14:13:44.050

在 Company 和 Employee 表中为 id 使用 uniqueidentifier，并使用 newid() 作为默认值。

或者，合并表并添加一个字段以显示记录是公司还是员工。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T14:13:53.770

所以 email.ToID 可以引用 employee.ID 或 company.ID，对吗？您不能以声明方式限制 email.ToID 必须至少存在于（employee.ID 或 company.ID）之一中。几个解决方案：

1.  在电子邮件表中具有 ID（ToEmployeeId、ToCompanyId）和一个检查约束，该约束限制只能在给定电子邮件上指定一个。
2.  在同一个 id 空间中拥有 Employee 和 Company Id，例如，他们的 Id 掌握在某种 Contact 表中，然后 company.Id 和 employee.Id 都有一个引用 Contact.Id 的 FK。我认为这个解决方案不是很好，因为 Contact 是这些其他表的一个非常蹩脚的超级类型。
3.  有一个像 (ContactId, EmployeeId, CompanyId) 这样的联系人表。当邮件转为 EmployeeId=X 时，您会查找 EmployeeId=X 的 Contact 行。如果不存在，则创建它并使用新的 ContactId。Companyid 也是如此。这确实允许您在将来扩展以使用其他 ID 集

# c++ - 使用 wxNotebook 创建选项卡闪烁效果（如 IM 程序）

> ID：834782
> 
> 赞同：4
> 
> 时间：2009-05-07T13:55:34.407
> 
> 标签：c++, wxwidgets, effects, wxnotebook

如何使用 wxNotebook 创建像 IM 程序一样的 Tab 闪烁效果？

一个很好的例子是任何选项卡式 IM 程序，它会闪烁以向用户显示他们收到了新的 IM。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T14:25:30.997

您可以给每个选项卡一个图标（`SetPageImage`如果我没记错就使用）。我过去这样做是为了显示一些进度条。每次您的计时器触发并更新该图像时，您都可以使用它来绘制位图（wxMemoryDC）。

您也可以使用`wxAuiNotebook`. 它不使用本机小部件，但它是 AUI 框架的一部分（在 wx2.8 中采用），它允许现代事物，例如标签的拖放。当然它也有`SetPageBitmap`方法。

您可以渲染一个小的 LED 闪烁，或者您可以在彩色背景上绘制联系人的姓名（其颜色会在每个闪烁间隔发生变化）并将其本身用作图标，而不是在图标旁边绘制联系人姓名。后一种方法只有`wxAuiNotebook`在我没记错的情况下才有效。

我已经有一段时间没有这样做了，但效果非常好。

# sql-server - 在 SQL Server 上使用 varchar(MAX) 与 TEXT

> ID：834788
> 
> 赞同：206
> 
> 时间：2009-05-07T13:56:35.277
> 
> 标签：sql-server, performance, text, varchar, sql-types

我刚刚读到该`VARCHAR(MAX)`数据类型（可以存储接近 2GB 的 char 数据）是`TEXT`SQL Server 2005 和 Next SQL SERVER 版本中数据类型的推荐替代品。

如果我想在列中搜索任何字符串，哪个操作更快？

1.  对列使用`LIKE`子句`VARCHAR(MAX)`？

    `WHERE COL1 LIKE '%search string%'`

2.  使用该`TEXT`列并在该列上放置一个*全文索引*/*目录*，然后使用该`CONTAINS`子句进行搜索？

    `WHERE CONTAINS (Col1, 'MyToken')`

* * *

## 回答 #1

> 赞同：335
> 
> 时间：2009-05-07T14:10:28.130

该`VARCHAR(MAX)`类型是`TEXT`. 基本区别在于，一个`TEXT`类型将始终将数据存储在 blob 中，而该`VARCHAR(MAX)`类型将尝试将数据直接存储在行中，除非它超过 8k 限制并且此时它将其存储在 blob 中。

在两种数据类型之间使用 LIKE 语句是相同的。为您提供的附加功能`VARCHAR(MAX)`是它也可以与`=`任何`GROUP BY`其他`VARCHAR`列一起使用。但是，如果您确实有大量数据，则使用这些方法将遇到巨大的性能问题。

关于是否应该使用`LIKE`搜索，或者是否应该使用*全文索引*和`CONTAINS`. 无论`VARCHAR(MAX)`or ，这个问题都是一样的`TEXT`。

如果您正在搜索大量文本并且性能是关键，那么您应该使用*全文索引*。

`LIKE`实现起来更简单，通常适用于少量数据，但由于无法使用索引，因此在处理大数据时性能极差。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-07T13:58:06.320

对于大文本，*全文索引*要*快得多*。但是你也可以*全文索引* `varchar(max)`。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-07T14:00:06.877

如果不将文本字段从文本转换为 varchar，则无法搜索文本字段。

```
DECLARE @table TABLE (a text)
INSERT INTO @table VALUES ('a')
INSERT INTO @table VALUES ('a')
INSERT INTO @table VALUES ('b')
INSERT INTO @table VALUES ('c')
INSERT INTO @table VALUES ('d')

SELECT *
FROM @table
WHERE a = 'a' 
```

这会给你错误：

> 数据类型`text`和`varchar`在等于运算符中不兼容。

而这不是：

```
DECLARE @table TABLE (a varchar(max)) 
```

有趣的是，`LIKE`仍然有效，即

```
WHERE a LIKE '%a%' 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-08-12T09:25:39.497

*   **基本定义**

`TEXT`并且`VarChar(MAX)`是非Unicode大变长字符数据类型，最多可存储2,147,483,647个非Unicode字符（即最大存储容量为：2GB）。

*   **使用哪一个？**

根据[MSDN](https://msdn.microsoft.com/en-IN/library/ms187993.aspx)，Microsoft 建议避免使用该`TEXT`数据类型，它将在 SQL Server 的未来版本中删除。`VarChar(MAX)`是存储大字符串值而不是数据类型的建议数据`TEXT`类型。

*   **行内或行外存储**

类型列的数据以`TEXT`行外方式存储在单独的 LOB 数据页中。表数据页中的行将只有一个 16 字节指针，指向实际数据所在的 LOB 数据页。如果类型列的数据`VarChar(MAX)`小于或等于 8000 字节，则将其存储在行内。如果`VarChar(MAX)`列的值大于 8000 字节，则`VarChar(MAX)`列值存储在单独的 LOB 数据页中，并且行将只有一个 16 字节指针，指向实际数据所在的 LOB 数据页。所以“行内”`VarChar(MAX)`有利于搜索和检索。

*   **支持/不支持的功能**

某些字符串函数、运算符和构造不适用于`TEXT`类型列，但它们确实适用于`VarChar(MAX)`类型列。

1.  `=`等于`VarChar(MAX)`类型列上的运算符
2.  `GROUP BY``VarChar(MAX)`类型列上的子句

*   **系统 IO 注意事项**

众所周知，`VarChar(MAX)`类型列的值只有在值的长度大于 8000 字节或者行中没有足够的空间时才会被存储在行外，否则会被存储在行内。因此，如果存储在`VarChar(MAX)`列中的大多数值都很大并且存储在行外，则数据检索行为将几乎类似于`TEXT`类型列。

如果存储在类型列中的大多数值`VarChar(MAX)`都足够小以存储在行内，则检索不包含 LOB 列的数据需要读取更多数据页，因为 LOB 列值存储在同一数据中的行内存储非 LOB 列值的页面。但是，如果查询包含 LOB 列，则与类型列`SELECT`相比，它需要为数据检索读取的页面更少。`TEXT`

**结论**

使用`VarChar(MAX)`数据类型而不是`TEXT`获得更好的性能。

[来源](http://sqlhints.com/2016/05/11/differences-between-sql-server-text-and-varcharmax-data-type/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-09-16T20:45:04.087

如果使用*MS Access*（尤其是 2003 等旧版本），您将被迫`TEXT`在 SQL Server 上使用数据类型，因为 MS Access 不能识别`nvarchar(MAX)`为 Access 中的备注字段，而`TEXT`被识别为备注字段。

# apache - 通过 DOD PKI CAC 进行 Apache 身份验证

> ID：834805
> 
> 赞同：6
> 
> 时间：2009-05-07T13:58:52.650
> 
> 标签：apache, pki, cac

如何使用国防部 CAC 卡实现 Apache（在 Linux 中）身份验证？我听说可以做到，但没有遇到任何细节。目前我们使用 Windows Active Directory 进行 Apache 身份验证，但仅使用登录名/密码。很快要求将仅使用 CAC 卡。任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T14:18:47.300

**为 2-way SSL 配置 Apache Tomcat（版本 6.0.18）**

1.  在文本编辑器中打开 server.xml；位于您的tomcat目录中`<TOMCAT_HOME>\conf\server.xml`
2.  查找此文本块并取消注释：

> ```
> <Connector port="8443" maxHttpHeaderSize="8192"
>                maxThreads="150" minSpareThreads="25"
>                maxSpareThreads="75"
>                enableLookups="false"
>                disableUploadTimeout="true"
>                acceptCount="100" scheme="https" secure="true"
>                clientAuth="false" sslProtocol="TLS" /> 
> ```
> 
> 3\. 将此文本块修改如下：

```
 <Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
                 maxThreads="150" scheme="https" secure="true"
                 clientAuth="true" sslProtocol="TLS"
                 keystoreFile="<CERTIFICATES_DIR>\localhost.jks"
                 keystorePass="password"
                 truststoreFile="<CERTIFICATES_DIR>\localhost.jks"
                 trustStorePass="password"/> 
```

4.  启动 Tomcat 并使用您喜欢的浏览器导航到[https://localhost:8443/ 。](https://localhost:8443/)
5.  浏览器会提示您输入客户端证书（注意：如果没有提示您输入证书，您可以尝试在 IE 中使用工具 > 互联网选项 > 证书 > 导入将其导入）。选择正确的客户端证书。
6.  如果您看到一个网站，则说明 Tomcat 已安装并且运行正常。如果您看到找不到页面或其他错误，则说明 Tomcat 安装或配置不正确。
7.  为客户端 SSL 支持设置 Tomcat。您还必须为 tomcat 提供信任库的运行时位置和密码。您可以通过命令行或在 ide 中运行 tomcat 来启用它： -Djavax.net.ssl.trustStore=C:{somedir}\localhost.jks -Djavax.net.ssl.trustStorePassword=password

**将公钥/私钥证书安装到浏览器**

1.  您的浏览器必须设置为将您的证书识别为来自受信任的证书颁发机构，并知道如何使用私钥识别您的身份。

火狐使用说明：

1.  在 Firefox 的菜单中，导航到工具 > 选项
2.  单击高级 > 加密选项卡 > 查看证书按钮
3.  单击权限选项卡
4.  单击导入按钮
5.  找到并选择您希望浏览器识别为合法 CA 的 CA 证书，然后单击打开
6.  单击使用此证书签名时要信任的所有目的。选项是网站、电子邮件和软件开发人员。
7.  点击确定

Firefox 现在将信任使用您刚刚安装的证书签名的内容。

IE 使用说明：

1.  导航到工具 > Internet 选项
2.  选择内容选项卡
3.  单击标有证书的按钮
4.  单击标记为受信任的根证书颁发机构的选项卡
5.  点击导入
6.  向导启动。单击下一步，然后选择您希望作为 CA 信任的证书文件
7.  选择证书存储。点击完成
8.  您将看到一个弹出窗口以确认安装。单击是

Internet Explorer 现在将信任使用您刚刚安装的 CA 颁发的证书签名的内容。

**使用 PKI 加密，您的浏览器需要知道如何使用私钥向服务器识别您的身份。** 为此，您必须手动安装证书。本例中导入的证书后缀为 .p12 Firefox 使用说明：

1.  在 Firefox 的菜单中，导航到工具 > 选项
2.  单击高级 > 加密选项卡 > 查看证书按钮
3.  单击标有“您的证书”的选项卡
4.  点击导入
5.  导航到并选择您希望选择用来标识自己的证书。点击打开
6.  输入与此证书一起使用的密码，然后单击确定

您的证书现已安装，可用于向使用 PKI 加密的服务器识别您的身份。如果您希望在不同的时间使用不同的身份来识别自己，则可以重复上述步骤以安装额外的证书。IE 使用说明：

1.  导航到工具 > Internet 选项
2.  选择内容选项卡
3.  单击标有证书的按钮
4.  选择个人选项卡
5.  点击导入
6.  向导启动。单击下一步...，然后选择您希望用于标识自己的 pki 文件。点击下一步
7.  键入证书的密码和所需的任何选项
8.  选择存储证书的位置，然后单击下一步 > 完成

您的个人证书现在已安装，您可以使用它向使用 PKI 加密的网站表明自己的身份。

# .net - Antialiased SmoothingMode 扭曲虚线笔

> ID：834814
> 
> 赞同：1
> 
> 时间：2009-05-07T13:59:49.577
> 
> 标签：.net, winforms, gdi+, paint

为什么打开抗锯齿会干扰我的虚线笔？

[![替代文字](https://i.stack.imgur.com/xjNYK.png)](https://i.stack.imgur.com/xjNYK.png)
[（来源：[googlepages.com](http://agnel.kurian.googlepages.com/antialiased_dashes.PNG)）]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T14:36:00.860

我相信这是创建宽度为 0 的笔然后缩放的问题。在我看来，有两种方法可以解决这个问题：

1.  创建宽度较大的笔。我发现在 0.38f 处，抗锯齿线中的虚线开始正确缩放。
2.  手动转换 Pen 的 DashPattern 属性中的值。

您可以使用一些 C# 3.0 代码来完成后一种解决方法：

```
protected override void OnPaint(PaintEventArgs e)
{
    Graphics g = e.Graphics;
    using (Pen p = new Pen(Color.Black, 0.0f))
    {
        p.DashStyle = DashStyle.Dash;

        g.ScaleTransform(4.0f, 4.0f);

        g.DrawLine(p, 5.0f, 5.0f, 55.0f, 5.0f);

        g.SmoothingMode = SmoothingMode.AntiAlias;
        p.DashPattern = Array.ConvertAll(p.DashPattern, d => d * 4.0f);
        g.DrawLine(p, 5.0f, 10.0f, 55.0f, 10.0f);
    }

    base.OnPaint(e);
} 
```

# ruby-on-rails - 中间三元关系模型的好的设计是什么？

> ID：834829
> 
> 赞同：0
> 
> 时间：2009-05-07T14:02:43.873
> 
> 标签：ruby-on-rails, database-design, data-modeling, modeling

我是 Rails 的新手，还没有掌握关联的所有可能性。这是我的问题：

我有几个模型，比如苹果和柠檬。然后是包含三元关系的模型“关系”：

主题 | 关系 | 目的

苹果| 高分辨率照片| CLIPARTO 比| 更甜 柠檬

“关系”的迁移是这样的：

> ```
> create_table :relations do |t|
>   t.references :subject,  :polymorphic => true
>   t.string     :relation
>   t.references :object,   :polymorphic => true
>   t.timestamps    
> end 
> ```

这应该存储关系

主题 ID = 1

主题类型 = 苹果

关系 = 比

object_id = 2

object_type = 柠檬

实际上，我有不止 2 个模型，所以我认为我需要通过使用多态选项使主题和对象列模型不可知。

你将如何设置苹果、柠檬和关系模型类中的关联？这样的关系表设计好不好？

非常感谢你的帮助！！

-亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:20:34.203

给出您描述的 db 模式，看起来应该相当简单：

```
class Relation < ActiveRecord::Base
  belongs_to :object, :polymorphic => true
  belongs_to :subject, :polymorphic => true
end 
```

你的其他课程看起来像这样

```
class Apple < ActiveRecord::Base
  has_many :object_relations, :class_name => 'Relation', :as => :object
  has_many :subject_relations, :class_name => 'Relation', :as => :subject
end

class Orange < ActiveRecord::Base
  has_many :object_relations, :class_name => 'Relation', :as => :object
  has_many :subject_relations, :class_name => 'Relation', :as => :subject
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T09:10:25.300

多态是痛苦：

除非您非常需要它，否则请使用 SingleTableInheritance 之类的东西：

```
class Fruit < ActiveRecord::Base
   has_many :relations
   has_many :related_objects, :through => :relation, :class_name => 'Fruit'
   has_many :relating_subjects, :through => :relation, :class_name => 'Relation'
end
class Relation < ActiveRecord::Base
   belongs_to :object, :class => 'Fruit'
   belongs_to :subject, , :class => 'Fruit'
   validate_presence_of :object_id
   validate_presence_of :subject_id
   validate_presence_of :relation
end 
```

然后像：

```
class Apple < Fruit
   ...
end 
```

我希望有帮助，（我没有测试过这段代码）

# iphone - iPhone 3G：如何显示固定点周围的位置？

> ID：834831
> 
> 赞同：0
> 
> 时间：2009-05-07T14:03:04.793
> 
> 标签：iphone, cocoa-touch, geolocation, gps, core-location

我通过 CoreLocation 修复了当前位置。现在我想获取那些位置（从现有数据库中），它们在它附近（大约 100 英尺）。

我该如何开始？

* * *

更新：这是 Haversine 公式的实现：[http](http://www.jaimerios.com/?p=39) ://www.jaimerios.com/?p=39 （非常有用）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T14:36:48.673

`CLLocation`为此提供了一种方法：

`- (CLLocationDistance)getDistanceFrom:(const CLLocation *)location`

您需要知道每条记录的纬度和经度，然后按此方法返回的距离进行排序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-07T14:49:45.710

高中几何FTW：

```
dist = sqrt(pow((x2-x1), 2) + pow((y2-y1), 2)) 
```

为了使 SQL 查询更容易，您可以做的一件事是将地图拆分为“图块”，即 2 公里 x 2 公里的区域，以便您可以查询到图块，然后使用此公式循环遍历结果.

# python - Python的FTPLib太慢了？

> ID：834840
> 
> 赞同：4
> 
> 时间：2009-05-07T14:05:11.840
> 
> 标签：python, ftp, performance, dos

我一直在玩 Python 的 FTP 库，并且开始认为它与在 DOS 中使用脚本文件相比太慢了？我运行会话，下载数千个数据文件（我想我现在有超过 800 万个）。我的观察是，与在 DOS shell 中使用 ftp 命令相比，在 Python 中下载过程所需的时间似乎是它的五到十倍。

因为我不希望任何人修复我的代码，所以我没有包含任何内容。我更感兴趣的是了解我的观察是否有效，或者我是否需要对这些论点进行更多修改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T15:51:09.933

速度问题可能在您的代码中。FTPlib 不是慢 10 倍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-11T11:23:22.000

定义块大小以及 ftp 连接的 storbinary，因此您将获得比 FTP Filezilla 快 1.5-3.0 倍的连接:)

```
from ftplib import FTP

USER = "Your_user_id"
PASS = "Your_password"
PORT = 21
SERVER = 'ftp.billionuploads.com' #use FTP server name here

ftp = FTP()
ftp.connect(SERVER, PORT)
ftp.login(USER, PASS)

try:
    file = open(r'C:\Python27\1.jpg','rb')
    ftp.storbinary('STOR ' + '1.jpg', file,102400) #here we store file in 100kb blocksize
    ftp.quit()
    file.close()
    print "File transfered"
except:
    print "Error in File transfering" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T14:20:38.137

FTPlib 可能不是最干净的 Python API，我认为它的运行速度比 DOS shell 脚本慢十倍。

除非您不提供任何代码进行比较，例如您使用 shell 和 python 片段来批处理 dl 5000 个文件，否则我看不出我们可以如何帮助您。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T14:35:34.950

FTPLib 是用 Python 实现的，而您的“DOS 脚本”实际上是一个调用已编译命令的脚本。执行此命令可能比解释 Python 代码更快。如果它对你来说太慢，我建议使用[subprocess 模块](http://docs.python.org/library/subprocess.html)从 Python 调用 DOS 命令。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-11-12T09:25:07.767

更大的块大小并不总是最佳的。例如，通过有线网络将相同的 167 MB 文件上传到同一个 FTP 服务器，对于各种块大小，我得到了以下时间（以秒为单位）：

```
Blocksize  Time
102400       40
 51200       30
 25600       28
 32768       30
 24576       31
 19200       34
 16384       61
 12800      144 
```

在此配置中，最佳值约为 32768 (4x8192)。

但如果我改用无线，我得到了这些时间：

```
Blocksize  Time
204800       78
102400       76
 51200       79
 25600       76
 32768       89
 24576       86
 19200       75
 16384      166
 12800      178
default     223 
```

在这种情况下，有几个最佳块大小值，都不同于 32768。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-02-09T05:22:27.670

```
import ftplib
import time
ftp = ftplib.FTP("localhost", "mph")
t0 = time.time()
with open('big.gz.sav', 'wb') as f:
    ftp.retrbinary('RETR ' + '/Temp/big.gz', f.write)
t1 = time.time()
ftp.close()
ftp = ftplib.FTP("localhost", "mph")
t2 = time.time()
ftp.retrbinary('RETR ' + '/Temp/big.gz', lambda x: x)
t3 = time.time()
print "saving file: %f to %f: %f delta" % (t0, t1, t1 - t0)
print "not saving file: %f to %f: %f delta" % (t2, t3, t3 - t2) 
```

所以，也许不是 10 倍。但是我在运行 Windows 7 的核心 1.8Ghz 核心 i7 和 8GB 内存（应该是矫枉过正）的笔记本电脑上运行这个保存文件的速度都在 160 秒以上。本机客户端以 100 秒的速度运行。如果没有文件保存，我还不到 70 岁。

我来这个问题是因为我看到在 mac 上使用 ftplib 的性能很慢（一旦我再次访问那台机器，我将再次重新运行这个测试）。虽然在这种情况下与写入异步可能是一个好主意，但在真实的网络上，我怀疑这会少得多。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-05-21T08:09:38.730

禁用 ftplib 并通过 Msdos 执行 ftp

```
os.system('FTP -v -i -s:C:\\ndfd\\wgrib2\\ftpscript.txt') 
```

在 ftpscript.txt 里面

```
open example.com
username
password
!:--- FTP commands below here ---
lcd c:\MyLocalDirectory
cd  public_html/MyRemoteDirectory
binary
mput "*.*"
disconnect
bye 
```

# sql-server - 如何在 sql server 的列上禁用全文搜索？

> ID：834841
> 
> 赞同：2
> 
> 时间：2009-05-07T14:05:18.983
> 
> 标签：sql-server, full-text-search, alter

我正在尝试将列从 ntext 转换为 nvarchar(MAX)，但似乎启用了全文搜索。

```
Alter table <table> alter column <column> nvarchar 
```

然后我要强制文本成行

```
update <table> set <column> = <column> +'' where <column> is not null 
```

最后，我需要再次启用全文搜索。

我如何在 SQL 中执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T16:53:35.243

```
DROP FULLTEXT INDEX ON mytable.mycolumn;
go
Alter table ... nvarchar(value);
go
ADD FULLTEXT INDEX ON mytable add (mycolumn) 
```

( [http://msdn.microsoft.com/en-us/library/ms188359.aspx](http://msdn.microsoft.com/en-us/library/ms188359.aspx) )

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-03-04T08:23:51.977

这是针对 SQL Server 2005 的。

### 删除全文索引的语法：

ALTER FULLTEXT INDEX ON **[TABLENAME]** DROP **(COLUMNNAME)**

-- 更改列或更多声明 --

### 读取全文索引的语法：

ALTER FULLTEXT INDEX ON **[TABLENAME]** add **(COLUMNNAME)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-17T14:07:56.230

```
ALTER FULLTEXT INDEX ON TableName drop (ColumnName)
ALTER TABLE TableName ALTER COLUMN ColumnName nvarchar(MAX)
ALTER FULLTEXT INDEX ON TableName add (ColumnName) 
```

这将从索引中删除该列，然后更改它，然后将其重新添加到索引中。

# c# - ASP.Net MVC ModelState / Html.TextBox 回发问题

> ID：834842
> 
> 赞同：5
> 
> 时间：2009-05-07T14:05:48.920
> 
> 标签：c#, asp.net-mvc, html-helper

我在尝试发布的表单中出现问题。在表单无法验证的情况下，我采用标准的调用方式，`ModelState.AddModelError()`然后返回 View 结果。

问题是，HTML.* 助手应该在渲染时获取发布的值，我注意到我的文本字段只有在我将它们包含在回发操作的参数列表中时才会这样做，这不应该是必需的看到某些表单有太多字段，不想将它们全部列为参数。

我的操作代码大致是：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult EditDataDefinition(long? id, string name)
{
    var dataDefinition = ...

    // do some validation stuff
    if (!ModelState.IsValid)
    {
        // manually set checkbox fields via ViewData seeing as this STILL doesn't work in MC 1.0 :P
        // ...
        return View(dataDefinition);
    }

} 
```

现在，dataDefinition（它是一个 LINQ to SQL 实体）有一个字段*MinVolume*，在视图中由以下行处理：

```
Minimum: <%= Html.TextBox("MinVolume", null, new { size = 5 })%> 
```

然而，当 ModelState 验证失败后呈现视图时，在我们发布的原始页面上键入的值不会保留，除非我将其作为参数包含在回发方法中。从字面上看，我可以通过这样做“解决问题”：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult EditDataDefinition(long? id, string name, string minVolume) 
```

出于某种原因，这将强制保留字段值。这对我来说似乎很愚蠢，因为我的表单具有比这更多的值，而且我不应该只为该字段添加参数。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T19:22:33.177

哦，伙计，我刚刚改进了我的应用程序设计。出现问题是因为您有自定义验证（我也有）。您必须在之后添加

```
ModelState.AddModelError() 
```

这

```
ModelState.SetModelValue("MinVolume", ValueProvider["MinVolume"]); 
```

鉴于它必须是

```
Mimum:<%=Html.Textbox("MinVolume")%> 
```

仍然不确定它为什么有效，但它对我有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T08:31:34.410

难道是你的代码：

```
<%= Html.TextBox("MinVolume", null, new { size = 5 })%> 
```

..有`null`默认值参数吗？也许如果您将其更改`null`为`Model.MinVolume`它将保留该值。像这样：

```
<%= Html.TextBox("MinVolume", Model.MinVolume, new { size = 5 })%> 
```

我不确定您的操作是否会返回`MinVolume`模型中的值。如果是这样，上述应该工作。否则，您可能需要稍微重构操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T14:47:51.317

当您在 ModelState 中设置错误值时，您使用的是什么键？为 TextBox 设置 value 参数的代码如下所示：

[下载框架代码](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)的相关部分。

```
string attemptedValue = (string)htmlHelper.GetModelStateValue(name, typeof(string));
tagBuilder.MergeAttribute("value", attemptedValue ?? ((useViewData) ? htmlHelper.EvalString(name) : valueParameter), isExplicitValue); 
```

如您所见，如果尝试值存在，它将使用它——但前提是相同的密钥可用。

我知道这是可行的，因为我有一个不带参数并直接从 ValueProvider 获取值的操作，它使用 AddModelError 来指示验证错误。我确信我的 TextBoxes 中的值被保留。

**编辑**：为了保留这些值，它们需要以某种方式与模型相关联。一种方法是将它们添加到参数列表中。另一种方法是使用 UpdateModel（参数名称在白名单中或没有白名单）。第三种方法是将参数显式添加到模型中，如@Jenea 的回答。由于助手只从模型状态中提取，它们必须在那里才能保留值。它不查看请求的 Form 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T08:51:50.340

据我了解，解决方案是：

```
[Transaction]
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult EditDataDefinition(int id, FormCollection form)
{
    T itemToUpdate = repository.Get(id);
    UpdateModel(itemToUpdate, form.ToValueProvider());

    if (itemToUpdate.IsValid())
    {
        repository.SaveOrUpdate(itemToUpdate);
        return Json(ValidationResultToJson(itemToUpdate.ValidationResults()));
    }

    repository.DbContext.RollbackTransaction();
    return Json(ValidationResultToJson(itemToUpdate.ValidationResults()));
} 
```

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T19:38:23.217

另一种解决方案是，如果您在视图中键入：

```
<%var minVolume=Request["MinVolume"]??"";%>
<%=Html.Textbox("MinVolume",minVolume,new {size=5})%> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-06T21:56:35.893

请参阅本文以了解在 ASP.NET MVC 中处理回发的不同方法

[链接文本](http://www.altafkhatri.com/Altaf/ASP_NET_MVC_Postback/Dropdownlist_Example/PostBack)

# java - Java EE 并发和锁定

> ID：834843
> 
> 赞同：4
> 
> 时间：2009-05-07T14:05:51.353
> 
> 标签：java, jakarta-ee, concurrency, locking

我有一个 MDB（消息驱动 bean），它接收带有表示单词的字符串的消息。我也在数据库中有一个表。MDB 应该在表中存储单词和每个单词被接收的次数（计数器）。

问题是，为了获得更好的性能，MDB 在许多实例中启动，当不同实例接收到相同的新词时，它们都会创建计数为 1 的同一行。

为了解决这个问题，我应该使单词字段唯一，然后第二个实例将在提交时失败，重新传输消息，这将起作用，但可能会出现问题。这是一个好习惯吗？

另一种解决方案是在对计数器求和之后合并这些行。但是如果另一个实例会在更新过程中增加计数器呢？

如果两个实例试图增加计数器怎么办？`@Version`应该够了吧？

我不确定这里的正确解决方案是什么。您将如何处理此类案件？

您还可以推荐一些关于并发实践的书籍（而不是关于`synchronized`我需要支持 Java EE 并且可能运行应用程序服务器集群的使用）？

* * *

**更新：** 在阅读了有关 EJB 和 JPA 的更多信息后，我想我想要一个锁定实体之类的东西。例如，我可以创建一个只有 id 和 key 列和数据的新表，如下所示：

```
ID | KEY
1  | WORDS_CREATE_LOCK 
```

因此，当我需要处理一个新单词时，我会做这样的事情（不是确切的代码，甚至不确定它是否会编译）：

```
// MAIN FUNCTION
public void handleWord(String wordStr) {
  Word w = getWord(wordStr);

  if (w == null)
    w = getNewOrSychronizedWord(wordStr);

  em.lock(w);
  w.setCounter(w.getCounter() + 1);
  em.unlock(w);
}

// Returns Word instance or null if not found
private Word getWord(String wordStr) {
  Word w = null;

  Query query = em.createQuery("select w from words as w where w.string = :wordStr order by w.id asc");
  query.setParameter("wordStr", wordStr);
  List<Word> words = query.getResultList();

  if (words.getSize() > 0)
    w = words.get(0);

  return w;
}

// Handles locking to prevent duplicate word creation
private Word getNewOrSynchronizedWord(String wordStr) {
  Word w = null;
  Locks l = em.find(WORDS_CREATE_LOCK_ID, Locks.class);
  em.lock(l);

  Word w = getWord(wordStr);

  if (w == null) {
    w = new Word(wordStr);
    em.persist(w);
  }

  em.unlock(l);
  return w;
} 
```

**所以问题是它会那样工作吗？我可以在不维护带有锁定行的数据库表的情况下做同样的事情吗？可能是一些 Java EE 容器锁定机制？**

如果有帮助，我正在使用 JBoss 4.2。

* * *

我对此有一个新想法。我可以创建两个 MDB：

允许许多实例的第一个 MDB，它将处理所有消息，如果找不到该单词，则将该单词发送到第二个 MDB

仅允许一个实例的第二个 MDB，将串行处理消息并允许创建新单词

最好的部分：没有整个表/方法/进程锁定，只有计数器更新时的行锁定

那有多好？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T21:45:07.193

如果您正在寻找性能，没有锁定等。我建议您有另一个表：（单词，时间戳）。您的 MDB 将只插入单词和时间戳。另一个进程将计算并使用总数更新表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:20:43.190

这听起来需要在数据库中通过选择正确的[事务隔离](http://en.wikipedia.org/wiki/Isolation_(database_systems))级别来解决——可重复读取就足够了。

你需要的是一本关于数据库的书，专注于事务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T15:24:47.280

您的意思是多个实例正在处理相同的消息，还是在不同的消息中使用相同的词？如果是同一条消息，那么您应该使用队列而不是主题。这当然不能解决多条消息中同一个词的问题。对于这种情况，您可以遵循@Michael Borgwardt 和@Vitaly Polonetsky 的建议。

在数据库之外，另一种选择是让不同的 MDB 实例处理以一组字母开头的单词。这可以通过选择器轻松完成。然后将只有一个 MDB 处理任何特定的单词，但处理仍然在多个实例之间拆分以提高性能。我并不是说这是一个更好的选择，而只是另一种支持非常简单的基于队列的处理。

# c++ - 可用的 Visual Studio 2008 c++ 项目平台的优缺点？

> ID：834844
> 
> 赞同：0
> 
> 时间：2009-05-07T14:05:52.587
> 
> 标签：c++, winforms, winapi, mfc, atl

如果选择：

*   ATL
*   Windows 窗体
*   MFC
*   Win32

具体而言，该应用程序将是：

*   完全在内部使用。
*   大多数用户缺乏基本的 Windows/PC 知识。（考虑简单的用户界面）
*   用于自动化测试，这需要：
    - 从外部设备引入大量数据（可以选择 VXI、USB 或以太网）
    - 非常依赖图形 - 可能是 directX
*   应用程序的生命周期将超过 10 年（考虑未来的 Windows 平台等）
*   用户在测试时将处于非常偏远的位置并离线，但可以每晚在线同步报告（现在用于数据库同步的单独应用程序） - 考虑程序更新挑战？
*   程序速度增加了价值——这意味着我们获取和显示数据的速度越快，可以完成的测试就越多。除了程序之外，没有其他瓶颈，只是速度快一点=效率高一点。

同样，特别是 C++ - 而不是 C#。

谢谢，杰夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T14:22:36.197

如果您不介意将自己绑定到 VC++，我会选择 ATL+WTL。它非常轻量级，并且仍然为原始 Win32 添加了一些抽象。MFC 也可以，我想，虽然我不是很喜欢它，但它比 WTL 有更好的文档记录。

至于 Windows 窗体，我会远离它，特别是如果你知道你将使用 C++。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T14:23:08.880

远离 MFC。诚然，它被大量使用，但它是非惯用 C++ 使用的一个很好的例子。值得注意的是，它实现了自己的 RTTI 系统并重新实现了 STL 的部分内容。

ATL 的功能不是很丰富，但是有一个很好的扩展名为[WTL](http://sourceforge.net/projects/wtl)。它也不是很好的 C++，但比 MFC 好得多。如果您对 GTK、Qt 等不感兴趣（大概是因为您希望框架变薄以便与 DirectX 等轻松集成），WTL 可能是您的最佳选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T17:04:04.437

我在 WTL 和 MFC 方面都有丰富的经验，并且不会再选择 WTL 而不是 MFC。MFC 并没有那么糟糕，一旦你了解了要忽略哪些部分（文档/视图、CArchive、容器……）可用于 MFC 的帮助。使用 WTL，您几乎可以靠自己（除了 WTL 邮件列表和 viksoe.dk 上的示例代码）。

话虽如此，如果您无论如何都要在 DirectX 中进行繁重的工作，那么 UI 工具包就没有那么重要了。MFC 和 WTL 都可以处理一些表单和对话框；win32 工作量太大，对 MFC 或 WTL 没有附加价值，而来自 C++ 的 Windows 窗体是皮塔饼，而且速度很慢。再加上 Windows 窗体已经是老派了，至少 MFC 不会再有太大变化了 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T14:29:14.403

我不认为 C++ Windows Forms 是一个有效的组合。至少它不在我安装的 VS 2008 中。

所以剩下的就是 ATL、MFC 和 Win32。都是旧的，但 Win32 是最旧的，所以我会删除它。

MFC 有很多外部支持（CodeProject.com 等），它有很好的文档记录，并且有很多人有 MFC 经验。查看此网站上 ATL 与 MFC 的主题数量。MFC 的帖子数量要多一个数量级。

MFC 似乎比 ATL 更常见。IMO，MFC 将是要走的路（鉴于选择有限）。

# sql-server - 当我（错误）使用索引数据库表作为全文搜索索引时会出现性能问题吗？

> ID：834845
> 
> 赞同：0
> 
> 时间：2009-05-07T14:06:06.363
> 
> 标签：sql-server, full-text-search

在工作中，我们讨论了在我们的产品中添加全文搜索引擎。一个建议是使用 MSSQL 数据库表作为全文搜索索引，如下所示：

```
Keyword  Document
------------------
This     Doc1
Is       Doc1
A        Doc1
Test     Doc1
And      Doc2
This     Doc2
Too      Doc2 
```

搜索将获取包含按文档分组的单词的所有行。

**编辑：**此表将包含 > 50 Mio。行。

澄清一下：我们不想使用 MSSQL 的全文功能。

坦率地说：我不喜欢这样，我宁愿使用 Lucene，但由于我们的产品是用 VB6 编写的，因此需要一些工作。所以目前我们*将*按照我的描述去做，除非我提出一些确凿的事实来反对它。或者也许你可以让我相信这毕竟不是一个坏主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T14:18:45.333

如果您使用的是 VB6，并且想要使用 Lucene，请自己获取[clucene](http://sourceforge.net/projects/clucene/)，将其构建为 dll（可能使用 C 包装器来公开 AddDocument 和 SearchFiles 函数）并从您的 VB6 代码中调用它们。（或创建一个简单的 COM 对象来做同样的事情并调用它）

然后可以像您的数据库“hack”一样轻松地解析数据并将其呈现给您的用户，并且会少很多麻烦，尤其是在使您的数据库表保持最新并添加新内容时。

你会怎么处理重复的单词？用每个文档中的每个单词更新数据库会非常慢（如果您期望有 5000 万个唯一性！），以及您将如何处理添加新文件，而不是简单地尝试添加每个单词（除非您会对文档进行比较，只更新添加的单词，或者删除删除的 - 多么令人讨厌！）

你不妨花一天左右的时间让 clucene 运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:42:29.567

您所描述的实际上是许多论坛的工作方式（例如[phpBB](http://www.phpbb.com/)）。所以是的，这是一种已被其他人采用的方法，并且效果很好。缺点：

*   你不能做“word NEAR word”之类的事情，只能做“word AND/OR word”
*   表格往往会快速增长。全文搜索引擎通过剥离复数、折叠常用前缀等方式压缩单词，以缩小搜索空间。
*   对这些东西进行拒绝服务攻击相对简单，因为搜索会提取大量数据（至少，对于许多论坛来说，这是一个大问题）。

一个小的优化：创建一个包含单词的表，并为每个单词分配一个 ID（32 位 int；英语只有大约 200 万个单词，包括名称等）。然后创建一个 M:N 映射“word-id”到“doc-id”。这将大大减少数据库大小。

# load-balancing - 网络负载平衡服务器

> ID：834846
> 
> 赞同：0
> 
> 时间：2009-05-07T14:06:30.293
> 
> 标签：load-balancing

我想创建 NLB（网络负载平衡）服务器，我需要任何特定的软件或硬件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T14:14:48.197

网络负载平衡有许多不同的硬件解决方案（F5、Foundry、Cisco 等）以及基于软件的解决方案，它甚至包含在 Linux 内核 (LVS) 中。

如果不了解更多关于您要尝试负载平衡的内容、流量级别和所需的可靠性，就很难提出建议。

# c++ - Problem with desktops

> ID：834848
> 
> 赞同：2
> 
> 时间：2009-05-07T14:07:21.727
> 
> 标签：c++, windows-vista, desktop

I have this code:

```
#define _WIN32_WINNT 0x0500
#include <cstdlib>
#include <iostream>
#include <windows.h>

using namespace std;

int main(int argc, char *argv[])
{
    Sleep(500);
    HDESK hOriginalThread;
    HDESK hOriginalInput;
    hOriginalThread = GetThreadDesktop(GetCurrentThreadId());
    hOriginalInput = OpenInputDesktop(0, FALSE, DESKTOP_SWITCHDESKTOP);

    HDESK hNewDesktop=CreateDesktop("Test",NULL,NULL,0,DELETE|READ_CONTROL|WRITE_DAC|WRITE_OWNER|GENERIC_ALL,NULL);

    cout<<SetThreadDesktop(hNewDesktop);
    Sleep(575);
    SwitchDesktop(hNewDesktop);
    system("cmd");
    Sleep(1000);
    SwitchDesktop(hOriginalInput);
    SetThreadDesktop(hOriginalThread);
    CloseDesktop(hNewDesktop);
    CloseDesktop(hOriginalInput);
    Sleep(1000);
    return 0;
} 
```

When I run this, it creates new desktop, switch to it, but command prompt not appeared. I must manualy terminate process "cmd" and my program then continue. Is there a way to show window of any application on other desktop? And how I can change background of desktop I created? Please help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T14:19:46.250

Are you just trying to run "cmd" in non-blocking mode? I believe you can do that in Windows with:

```
system(1, "cmd"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T14:36:31.220

You can pick which desktop to start an application in when the application starts.

```
STARTUPINFO si = {0};
si.cb = sizeof(STARTUPINFO);
si.lpDesktop = L"winsta0\\Default"; 
```

Then pass this struct into [CreateProcess](http://msdn.microsoft.com/en-us/library/ms682425.aspx) or [CreateProcessAsUser](http://msdn.microsoft.com/en-us/library/ms682425.aspx).

* * *

You can also pick which session to start the application in (Enable the session ID column in task manager to see which one you want)

You can create a process in another session by using: [SetTokenInformation](http://SetTokenInformation)

on the token that you use in CreateProcessAsUser passing in a TokenSessionId

You can't change the session of an already running process.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T14:53:46.123

Don't use *Desktop functions, I promise they don't do what you think they do, they're a holdover from NT4 - you're really trying to create a new Session, and the OS owns creating sessions. Just don't do it.

-guy who works in Windows org

# wpf - 鼠标滚轮增量值始终为 120

> ID：834852
> 
> 赞同：11
> 
> 时间：2009-05-07T14:08:33.750
> 
> 标签：wpf, mouse, mousewheel

我正在 WPF 中创建一个使用鼠标滚轮放大/缩小图像的应用程序。缩放量取决于鼠标滚轮的转动量。

问题是 Delta 值始终为 120，如 MSDN 中所述。所以，即使我将车轮转动 1 个或 5 个槽位，它也始终是 120。你知道解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T14:48:12.533

您应该能够处理[PreviewMouseWheel](http://msdn.microsoft.com/en-us/library/system.windows.uielement.previewmousewheel.aspx)事件。每个事件的增量将是 +/-120，但您将获得一个针对轮子的每个“缺口”的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-16T01:43:31.567

John Myczek 给出了基本正确的答案。我应该补充一点，如果你转动车轮足够快，你会注意到增量大于 120 或小于 -120。它将是 +/-120 的倍数。所以你最好在PreviewMouseWheel事件的句柄上做一些划分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-27T06:46:41.043

上述关于***值始终为 +/-120***的陈述并不总是正确的。

如果你**慢慢**转动轮子，这个值确实是 +/-120，但是，如果你**快速**转动轮子，这个值会变成 +/-240。

我猜可能还有*其他值*（还没有测试过）......

# c# - 简单的 C# 正则表达式

> ID：834853
> 
> 赞同：0
> 
> 时间：2009-05-07T14:08:35.873
> 
> 标签：c#, regex

我正在尝试从 Web 服务响应中正则表达式输出字符串中给出的哈希值。给出的响应格式为：

```
写下这段代码，这是你用于以下任务的 id：P+3zLI8x1AokfbZ1jXat9g==

您需要在以下每个步骤中输入代码。

下一个任务稍微简单一些，并演示验证数据输入到服务的过程。

接下来为大家揭晓的方法是一种叫做‘girls’的方法。  
此方法有五个参数，其中前四个是 Girls Aloud 成员的名字，按字母顺序排列（在 wikipedia 上快速搜索会有所帮助），第五个参数是您的唯一 id 代码。  

创建一个 Windows 应用程序以发送正确的数据，响应将是一个包含下一组指令的字符串。`

```

我感兴趣的哈希是“id”，id est `"P+3zLI8x1AokfbZ1jXat9g=="`，。我尝试使用正则表达式，`"^:\\w*=$"`但它不匹配它......

任何人都可以在这里帮我一把吗？

（而且，对于那些感兴趣的人，它来自一个非 cs 课程的简单网络服务示例；我试图通过正则表达式提取哈希，而不是仅仅写下来。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T14:10:34.370

> [A-Za-z+0-9]{22}==

应该可以工作，因为哈希始终是特定长度并使用有限的字符集（无标点符号）。

您发布的正则表达式的最大问题是您试图将其锚定到行的开头和结尾，这样如果哈希是该行上*唯一*的内容，则表达式将匹配。你真的不需要这样做。如果你真的想，你可以把这个表达式锚定到行*尾*，但没有必要得到你的匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:11:55.507

也许尝试阅读此文本的第一行，然后像这样拆分它

```
string hash = stream.ReadLine().Split(":")[1]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:12:43.913

```
tasks:\s(.+)\W 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T14:24:37.863

\S*==

这匹配一行末尾的所有完整单词，以'=='结尾。

[RegexStudio](http://www.regexstudio.com/)是你的朋友 ;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T14:15:27.820

```
string resultString = null;
try {
    resultString = Regex.Match(subjectString, "^Write this code down, this is your id for the following tasks: (?<ID>.+)$", RegexOptions.Multiline).Groups["ID"].Value;
} catch (ArgumentException ex) {
    // Syntax error in the regular expression
} 
```

# user-interface - 在文本编辑器和 IDE 中寻找查找和替换用户界面的好例子

> ID：834855
> 
> 赞同：3
> 
> 时间：2009-05-07T14:09:10.503
> 
> 标签：user-interface, editor, find, replace

我正在开发一个带有集成文本编辑器的 Windows 应用程序，比如 IDE。当前的查找和替换功能使用标准的 Windows 对话框，这些对话框显示了它们的年龄并且不是很强大。

您知道文本编辑器或 IDE 中的查找和替换功能有哪些很好的示例？我正在寻找外观和感觉、易用性、强大功能以及整个作品的灵感。谢谢！

注意：我当然对超级强大的edit-your-whole-workspace-at-once IDE 功能感兴趣，但我也对简单而优雅的 UI 感兴趣，比如 Firefox 的查找栏或 Chrome 的查找选项卡。

**编辑：**我接受了 Richard 的帖子，因为它谈到了几种不同类型的查找和替换 UI，但所有答案都非常有帮助 - 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T14:34:37.870

我用过的最好的一个是实用程序灵活重命名器。它使用简单，支持正则表达式并在您提交之前准确预览它将更改的内容。

另一个运行良好的是 Ultra Edit。我喜欢您可以查看所有打开的文件或路径中的所有文件，屏蔽文件名以搜索并在查找字符串和替换字符串上使用正则表达式。按下对话框中的帮助按钮，您将直接进入使用正则表达式语法的页面。

我经常使用 UltraEdit 对 .Net 项目进行更改，因为它比 VS 更易于使用且更可靠。我讨厌在 Visual Studio 中使用查找/替换。我也喜欢你可以将搜索定向到一个编辑窗口，它会在其中附加每个新搜索，这样你就可以看到所有以前的搜索。

[http://flexible-renamer.en.softonic.com/](http://flexible-renamer.en.softonic.com/)

[http://www.ultraedit.com/](http://www.ultraedit.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:12:03.743

看看一个日食。它可以在整个工作空间中交互地查找和替换

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:14:25.313

Netbeans 有一个很棒的项目/多个项目，它在很多场合都救了我。

[http://www.netbeans.org/](http://www.netbeans.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T14:28:23.033

Visual Studio 中的查找包括许多选项：

*   从工具栏（或 control-D）快速查找。
*   增量搜索
*   可停靠对话框，带有在当前文件、所有打开的文件、当前项目或整个工作区中查找的选项。
*   纯文本、整个单词和正则表达式支持
*   在具有命名（用户可定义）文件夹集的文件中查找。

用户文档在[这里](http://msdn.microsoft.com/en-gb/library/9wdd0wk1.aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T14:34:03.190

查找和替换的重要一点是能够在一个视图中看到，*在*实际更改任何文件之前（甚至在更改之后，允许撤消），将替换哪些*源*文本以及将是什么*结果。*我不知道任何编辑器是否正确，但要了解我在说什么，看看 IntelliJ IDEA 的 Find Usages (Alt+F7) 是如何工作的（它显示了它找到的代码片段，并显示它们都在一页上）并将其与 IDEA 的版本控制历史记录如何显示每行更改的内容（突出显示添加/更改/删除的确切单词，而不是整行）。

 *PS 不要创建与 IDEA 现在相同的 firefox 风格的查找栏，除非您了解所涉及的所有问题。当前的查找栏是在 IDEA 7 中添加的，它存在一些与键盘控制相关的可用性问题。包括我在内的很多人都希望从 IDEA 6 中找回旧的发现：http: [//www.jetbrains.net/devnet/thread/269343](http://www.jetbrains.net/devnet/thread/269343) [http://www.jetbrains.net/jira/browse/IDEADEV-22804](http://www.jetbrains.net/jira/browse/IDEADEV-22804)

（也许有一天我会创建自己的 IDE，我可以为此设计“完美”的用户界面。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T13:58:53.953

[Coda](http://www.panic.com/coda/)有一个非常棒的“革命性”查找和替换引擎，它：

> 革命性的查找/替换。当然，我们有普通的 ol' Grep。但我们也提供了一个简单的拖放封装的 Grep——首先是 Coda。想要交换宽度和高度标签？就像搜索 width=“x” height=“y” 并将其替换为 width=“y” height=“x” 一样简单。就是这样：Coda 完成了剩下的工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-01T04:11:58.817

我用过的最好的“查找和替换”来自 FrontPage 2003 和 SharePoint Designer 2007。实现简单，我喜欢我经常使​​用的“替换操作”和“HTML 规则...”。也支持正则表达式，但我很少使用。

# c++ - 在 C++ 中使用非虚拟公共接口和作用域锁避免死锁

> ID：834865
> 
> 赞同：3
> 
> 时间：2009-05-07T14:10:35.853
> 
> 标签：c++, multithreading, synchronization, abstract-class

我遇到了一个对我来说似乎很困扰的问题。似乎我发现了一种很容易解决的情况，但是如果 a) 我在编程时注意力不集中，或者 b) 其他人开始实现我的接口并且不知道如何处理，这可能会导致问题这个情况。

这是我的基本设置：

我有一个抽象类，用作几种数据类型的通用接口。我采用了非虚拟公共接口范例（Sutter，2001）以及范围锁定来提供一些线程安全性。一个示例接口类看起来像这样（我省略了有关范围锁定和互斥锁实现的细节，因为我认为它们不相关）：

```
class Foo
{
public:
    A( )
    {
        ScopedLock lock( mutex );
        aImp( );
    }
    B( )
    {
        ScopedLock lock( mutex );
        bImp( );
    }
protected:
    aImp( ) = 0;
    bImp( ) = 0;
} 
```

然后由用户来实现 aImp 和 bImp，这就是问题所在。如果 aImp 执行一些使用 bImp 的操作，那么执行此操作非常容易（并且在某种意义上几乎是合乎逻辑的）：

```
class Bar
{
protected:
    aImp( )
    {
        ...
        B( );
        ...
    }
    bImp( )
    {
        ...
    }
} 
```

僵局。当然，解决这个问题的简单方法是始终调用受保护的虚函数而不是它们的公共变体（在上面的代码片段中将 B( ) 替换为 bImp( )）。但是，如果我犯了一个错误，或者更糟的是让别人上吊自己，似乎仍然很容易上吊。

有没有人有办法阻止抽象类的实现者在编译时调用这些公共函数，或者帮助避免死锁解决方案？

只是为了踢，一些互斥锁允许操作，这将避免死锁问题。例如，如果我使用 Windows 函数 EnterCriticalSection 和 LeaveCriticalSection 来实现这一点，则没有问题。但我宁愿避免特定于平台的功能。我目前在我的作用域锁实现中使用 boost::mutex 和 boost::shared_mutex ，据我所知，它并没有试图避免死锁（我认为我几乎更喜欢）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T14:19:40.323

使用私有继承可能会解决您的问题：

```
class Foo
{
public:
  void A( )
    {
      ScopedLock lock( mutex );
      aImp( );
    }
  void B( )
    {
      ScopedLock lock( mutex );
      bImp( );
    }

protected:
  virtual void aImp( ) = 0;
  virtual void bImp( ) = 0;
};

class FooMiddle : private Foo
{
public:
  using Foo::aImp;
  using Foo::bImp;
};

class Bar : public FooMiddle
{
  virtual void aImpl ()
  {
    bImp ();
    B ();                   // Compile error - B is private
  }
}; 
```

从 Foo 私下派生，然后使用 FooMiddle 确保 Bar 无法访问 A 或 B。但是，bar 仍然能够覆盖 aImp 和 bImp，并且 FooMiddle 中的 using 声明意味着仍然可以从 Bar 调用它们。

或者，一个*有助于*但不能解决问题的选项是使用 Pimpl 模式。你最终会得到如下结果：

```
class FooImpl
{
public:
  virtual void aImp( ) = 0;
  virtual void bImp( ) = 0;
};

class Foo
{
public:
  void A( )
    {
      ScopedLock lock( mutex );
      m_impl->aImp( );
    }
  void B( )
    {
      ScopedLock lock( mutex );
      m_impl->bImp( );
    }

private:
  FooImpl * m_impl;
} 
```

好处是，在派生自 FooImpl 的类中，它们不再具有“Foo”对象，因此不能轻易调用“A”或“B”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-07T14:18:45.863

您的互斥锁不能是递归互斥锁。如果它不是递归互斥锁，则第二次尝试将互斥锁锁定在同一线程中将导致该线程阻塞。由于该线程锁定了互斥锁，但在该互斥锁上被阻塞，因此您遇到了死锁。

你可能想看看：

```
boost::recursive_mutex 
```

[http://www.boost.org/doc/libs/1_32_0/doc/html/recursive_mutex.html](http://www.boost.org/doc/libs/1_32_0/doc/html/recursive_mutex.html)

它应该实现跨平台的递归互斥行为。注意 Win32 CRITICAL_SECTION（通过 Enter/LeaveCriticalSection 使用）是递归的，这将创建您描述的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:53:49.210

虽然递归锁可以解决您的问题，但我一直认为，虽然有时是必要的，但在许多情况下，递归锁被用作一种简单的出路，锁定方式太多了。

您发布的代码显然是出于演示目的而简化的，所以我不确定它是否适用。

例如，假设使用资源 X 不是线程安全的。你有类似的东西。

```
A() {
   ScopedLock
   use(x)
   aImp()
   use(x)
}

aImp() {
   ScopedLock
   use(x)
} 
```

显然，这会导致死锁。

然而，使用更窄的锁可以消除这个问题。在尽可能小的范围内使用锁总是一个好主意，无论是出于性能原因还是避免死锁。

```
A() {
   {
      ScopedLock
      use(x)
   }
   aImp()
   {
      ScopedLock
      use(x)
   }
} 
```

你明白了。

我知道这并不总是可能的（或者会导致代码效率极低），不知道更多细节我不知道它是否适用于您的问题。但认为无论如何都值得发布。

# php - 从 SimpleXMLObject 到 Array 的递归转换

> ID：834875
> 
> 赞同：26
> 
> 时间：2009-05-07T14:12:11.027
> 
> 标签：php, casting, simplexml

我需要递归地将 PHP SimpleXMLObject 转换为数组。问题是每个子元素也是一个 PHP SimpleXMLElement。

这可能吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-12-18T23:11:46.263

```
json_decode(json_encode((array) simplexml_load_string($obj)), 1); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-07T14:19:39.200

没有测试这个，但这似乎可以完成：

```
function convertXmlObjToArr($obj, &$arr) 
{ 
    $children = $obj->children(); 
    foreach ($children as $elementName => $node) 
    { 
        $nextIdx = count($arr); 
        $arr[$nextIdx] = array(); 
        $arr[$nextIdx]['@name'] = strtolower((string)$elementName); 
        $arr[$nextIdx]['@attributes'] = array(); 
        $attributes = $node->attributes(); 
        foreach ($attributes as $attributeName => $attributeValue) 
        { 
            $attribName = strtolower(trim((string)$attributeName)); 
            $attribVal = trim((string)$attributeValue); 
            $arr[$nextIdx]['@attributes'][$attribName] = $attribVal; 
        } 
        $text = (string)$node; 
        $text = trim($text); 
        if (strlen($text) > 0) 
        { 
            $arr[$nextIdx]['@text'] = $text; 
        } 
        $arr[$nextIdx]['@children'] = array(); 
        convertXmlObjToArr($node, $arr[$nextIdx]['@children']); 
    } 
    return; 
} 
```

取自[http://www.codingforums.com/showthread.php?t=87283](http://www.codingforums.com/showthread.php?t=87283)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T14:23:20.127

有可能的。这是一个递归函数，它打印出父元素的标签以及没有更多子元素的标签+内容。你可以改变它来构建一个数组：

```
foreach( $simpleXmlObject as $element )
{
    recurse( $element );
}

function recurse( $parent )
{
    echo '<' . $parent->getName() . '>' . "\n";    

    foreach( $parent->children() as $child )
    {
        if( count( $child->children() ) > 0 )
        {
            recurse( $child );
        }
        else
        {
           echo'<' . $child->getName() . '>';
           echo  iconv( 'UTF-8', 'ISO-8859-1', $child );
           echo '</' . $child->getName() . '>' . "\n";
        }
    }

   echo'</' . $parent->getName() . '>' . "\n";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T14:24:23.417

我不明白这一点，因为 SimpleXMLObject 可以像数组一样受到威胁......

但是，如果您真的需要，只需查看 chassagnette 在[此线程](http://theserverpages.com/php/manual/en/ref.simplexml.php)中的答案或论坛中的[此帖子](http://www.codingforums.com/showthread.php?t=87283)即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-27T18:04:25.177

取决于 CDATA、数组等的一些问题（参见：[SimpleXMLElement to PHP Array](https://stackoverflow.com/questions/2726487/simplexmlelement-to-php-array)）

我认为，这将是最好的解决方案：

```
public function simpleXml2ArrayWithCDATASupport($xml)
{
    $array = (array)$xml;

    if (count($array) === 0) {
        return (string)$xml;
    }

    foreach ($array as $key => $value) {
        if (is_object($value) && strpos(get_class($value), 'SimpleXML') > -1) {
            $array[$key] = $this->simpleXml2ArrayWithCDATASupport($value);
        } else if (is_array($value)) {
            $array[$key] = $this->simpleXml2ArrayWithCDATASupport($value);
        } else {
            continue;
        }
    }

    return $array;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-04T11:32:18.703

在这里，我的**迭代**（即使我认为您不会通过使用递归解析数据来获得堆栈爆炸）实现递归转换为数组。这是一种比通过 json_**decode 函数更直接的方式：

```
function xml2Array(SimpleXMLElement $el): stdClass {
    $ret = $el;
    $stack = [&$ret];
    while (count($stack) > 0) {
        $cur = &$stack[count($stack) - 1];
        array_splice($stack, -1);
        $cur = (object) (array) $cur;
        foreach ($cur as $key => $child) {
            $childRef = &$cur->{$key};
            if ($child instanceof SimpleXMLElement)
                $stack[count($stack) - 1] = &$childRef;
            elseif(is_array($child))
                foreach ($childRef as $ckey => $cell) {
                    if ($cell instanceof SimpleXMLElement)
                        $stack[count($stack) - 1] = &$childRef[$ckey];
                }
        }
    }
    return $ret;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-17T09:26:57.613

对于那些对 CDATA 案有疑虑的人，

将@ajayi-oluwaseun-emmanuel 的答案与[这个答案](https://stackoverflow.com/a/21549956/3721429)结合起来对我有用：

```
$xml = simplexml_load_string($xml_str, 'SimpleXMLElement', LIBXML_NOCDATA);
$json = json_encode($xml);
$arr = json_decode($json,TRUE); 
```

# .net - linq 查询连接两个表并从一个表中获取计数

> ID：834880
> 
> 赞同：7
> 
> 时间：2009-05-07T14:12:43.117
> 
> 标签：.net, sql, linq, .net-3.5, lambda

我有两张表客户，订单

**客户** CustomerID FName LName

**订单** OrderId CustomerID OrderDate

我想做一个 linq 语句，可以连接这两个表并获取
每个客户的 FName、LName、Count of orders

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T14:20:32.177

```
from c in Customers
join o in Orders on c.CustomerID equals o.CustomerID into g
select new { c.FName, c.LName, Count=g.Count() } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T14:41:51.330

```
from c in db.Customers
let theCount = c.Orders.Count()
select new {c.FName, c.LName, theCount} 
```

[http://msdn.microsoft.com/en-us/library/bb425822.aspx#linqtosql_topic11](http://msdn.microsoft.com/en-us/library/bb425822.aspx#linqtosql_topic11)

> **这些访问操作转换为等效 SQL**中更复杂的连接或相关子查询，允许您在查询期间遍历对象图。

# batch-file - 从 Windows 批处理文件中的无效 GOTO 命令中恢复

> ID：834882
> 
> 赞同：5
> 
> 时间：2009-05-07T14:12:50.947
> 
> 标签：batch-file

在 Windows 批处理文件中，我采用了一个可选参数，允许调用者跳转到批处理文件的中间并从那里恢复。

例如：

```
if [%1] neq [] (
echo Starting from step %1
goto %1
if %errorlevel% neq 0 goto error
)

:step1

:step2

...

goto end
:error
echo Error handler
...

:end 
```

如果提供的参数不是有效的标签，批处理文件将立即退出，并出现错误*系统找不到指定的批处理标签*。

有什么方法可以让我处理这个错误并执行我的错误处理程序块，或者恢复整个批处理文件的执行，就好像没有提供参数一样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T14:26:51.273

您可以尝试在定位 goto 目标的批处理上使用 findstr：

```
findstr /r /i /c:"^:%1" %0>nul
if errorlevel 1 goto error 
```

这有点骇人听闻，但应该可以。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T14:19:51.913

`call :label` ~~吐出错误~~不会在重定向 stderr 时吐出错误（感谢 Johannes），并且似乎不会更改错误级别，但会继续处理批处理文件。您可以在标签后设置一个变量以指示执行是否达到了那么远。

```
@echo off
call :foo 2>nul
echo %errorlevel%
:bar
echo bar 
```

产量

```
C:\>test.cmd
系统找不到指定的批次标签 - foo
1
酒吧
C:\>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:35:15.403

我可能会这样做。

```
ECHO Starting from %1
IF "%1" == "step1" GOTO :step1 
IF "%1" == "step2" GOTO :step2
IF "%1" == "step3" GOTO :step3
IF "%1" == "step4" GOTO :step4
ECHO %1 is not valid label name 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-04T07:49:14.397

```
goto :label || (
  echo my error handler
) 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-07T14:21:29.367

我不认为 Windows 批处理文件支持任何错误处理（除了`if errorlevel...`）。您需要在`goto`.

如果可能的话，我建议使用 PowerShell，它是一种更丰富的语言，并且包括基于异常的错误处理。

# c# - 使用附件 ASP.NET 向多个收件人发送邮件

> ID：834890
> 
> 赞同：0
> 
> 时间：2009-05-07T14:14:13.550
> 
> 标签：c#, asp.net-3.5, system.web.mail

我正在构建一个简单的电子邮件应用程序，用于向带有附件的人员列表发送电子邮件。

为了能够添加附件（根据我的发现），我需要使用 System.Web.Mail。

我一次可以发送多少个电子邮件地址有限制吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T14:17:29.347

电子邮件协议不应固有地限制发送的电子邮件数量。您将遇到的任何限制很可能是由您的服务器或 ISP 施加的。

# .net - 托管 C++ 中的数组初始化

> ID：834903
> 
> 赞同：7
> 
> 时间：2009-05-07T14:17:14.713
> 
> 标签：.net, c++-cli, managed-c++

我希望声明和初始化一维托管项目数组。

如果是 C# 代码，我会这样写：

```
VdbMethodInfo[] methods = new VdbMethodInfo[] {
    new VdbMethodInfo("Method1"),
    new VdbMethodInfo("Method2")
}; 
```

我正在尝试在托管 C++ 中编写（好吧，实际上，我正在编写程序生成）相同的东西......

到目前为止，我有：

```
typedef array<VdbMethodInfo^, 1> MethodArray;
// How do I avoid pre-declaring the size of the array up front?
MethodArray^ methods = gcnew MethodArray(2);
methods[0] = gcnew VdbMethodInfo("Method1");
methods[1] = gcnew VdbMethodInfo("Method2"); 
```

这有两个问题：

1.  它更冗长
2.  它需要我预先声明数组的大小，这对我的代码生成器来说很不方便

托管 C++ 中的 GC 数组是否有“数组初始化”语法？什么是正确的语法？这个问题和其他类似问题是否有很好的网络链接？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-07T14:25:35.567

C++/CLI 数组声明和初始化语法与 C# 中的语法没有什么不同。这是一个例子......

```
array<String^>^ myArray = gcnew array<String^> {"first",  "second"}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T14:26:19.107

有关托管数组语法的 MSDN 页面：http: [//msdn.microsoft.com/en-us/library/ts4c4dw6 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ts4c4dw6(VS.80).aspx)

# c# - 在 C# 中单击以打开托盘图标的菜单

> ID：834907
> 
> 赞同：8
> 
> 时间：2009-05-07T14:18:41.183
> 
> 标签：c#, winforms, contextmenu

如何在单击而不是右键单击时强制显示托盘图标的上下文菜单。

我尝试使用 MouseClick 事件，但 eventargs 的鼠标位置位于 x0y0。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-07T14:57:48.343

这应该为你做：

```
private void notifyIcon1_Click(object sender, EventArgs e)
        {
            contextMenuStrip1.Show(Cursor.Position.X, Cursor.Position.Y);
        } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-08-06T20:54:12.797

我发现另一种方法效果更好：

```
private void notifyIcon1_MouseUp(object sender, MouseEventArgs e)
    {
        if (e.Button == MouseButtons.Left)
        {
            System.Reflection.MethodInfo mi = typeof(NotifyIcon).GetMethod("ShowContextMenu", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic);
            mi.Invoke(notifyIcon1, null);
        }
    } 
```

# javascript - 如何设置 .click jquery 变量以在页面重新加载时使用？

> ID：834911
> 
> 赞同：0
> 
> 时间：2009-05-07T14:18:55.880
> 
> 标签：javascript, jquery

在页面的过程中，我选择了一个相框来构图带有消光的图像 - 这部分有效。我想要做什么：说如果我决定要 2 个垫子，则垫子设置为 1 个垫子，并且框架设置为 Frame8，当页面重新加载时，我将如何加载 frame8。现在它恢复到默认帧。页面中使用了jquery和php。

在标题中：

```
 $('#mattes-radio-0').click(function() {
    window.location = 'index-custom.php?mattes=0'; 
   });  
   $('#mattes-radio-1').click(function() {
    window.location = 'index-custom.php?mattes=1';
   });  
   $('#mattes-radio-2').click(function() {
    window.location = 'index-custom.php?mattes=2';
   });  
   $('#mattes-radio-3').click(function() {
    window.location = 'index-custom.php?mattes=3';
   }); 
```

在正文中：
此处设置了我单击的框架的 Javascript var -

```
$('#frame$frame_id[$i]').click(function() {  
    $('#top-left-frame').html('<img src=\"$upper_left[$i]\" alt=\"\" />');  
    $('#top-mid-frame').css('background-image','url($upper_middle[$i])');   
    $('#top-right-frame').html('<img src=\"$upper_right[$i]\" alt=\"\" />');  
    $('#mid-left-frame').css('background-image','url($middle_left[$i])');   
    $('#mid-right-frame').css('background-image','url($middle_right[$i])');   
    $('#bottom-left-frame').html('<img src=\"$bottom_left[$i]\" alt=\"\" />');  
    $('#bottom-mid-frame').css('background-image','url($bottom_middle[$i])');   
    $('#bottom-right-frame').html('<img src=\"$bottom_right[$i]\" alt=\"\"   />');
    $('#frame-select').html('$prod_id');
    $('#pid-form').val('$frame_id[$i]');
    $('#oa_id-form').val('$prod_id');
    var frameState = $(this).attr('id');
    alert(frameState + ' was clicked.');

});  

<tr>
         <td>
No Mats:  <input type="radio" name="mattes-radio" align="middle"<?php if($_GET['mattes'] == 0){ echo 'checked="checked"';} ?> id="mattes-radio-0"> 
         </td>
         </tr>        
            <tr>
         <td>
            Single Mat: <input type="radio" name="mattes-radio" <?php if($_GET['mattes'] == 1){ echo 'checked="checked"';} ?> id="mattes-radio-1"> 
         </td>
          </tr>  
         <tr>
<td>
            Double Mat: <input type="radio" name="mattes-radio" <?php if($_GET['mattes'] == 2){ echo 'checked="checked"';} ?> id="mattes-radio-2"> 
         </td>
          </tr>  
 <tr>
         <td>
            Triple Mat: <input type="radio" name="mattes-radio" <?php if($_GET['mattes'] == 3){ echo 'checked="checked"';} ?> id="mattes-radio-3"> 
         </td>

         </tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T14:23:50.970

设置 cookie 并在页面加载时读取它可能是最简单的选择。

# sql - SQL：在数据库的每个 varchar 列中搜索字符串

> ID：834912
> 
> 赞同：20
> 
> 时间：2009-05-07T14:19:09.403
> 
> 标签：sql, sql-server, string, search

我有一个数据库，其中拼写错误的字符串出现在不同表的不同位置。是否有一个 SQL 查询可用于在数据库中每个可能的 varchar/text 列中搜索此字符串？

我正在考虑尝试以某种方式使用 information_schema 视图来创建动态查询，但我不确定这是否可行，或者是否有更好的方法。

如果有帮助，我正在使用 MS SQL Server。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-07T14:40:47.947

使用[此处](https://stackoverflow.com/questions/755146/find-all-tables-with-a-field-containing-xml-string-values)找到的技术，以下脚本为给定数据库中的所有 ((n)var)char 列生成 SELECT。复制/粘贴输出，删除最后一个“联合”并执行。您需要用您要查找的字符串替换 MISSPELLING HERE。

```
select 
'select distinct ''' + tab.name + '.' + col.name 
+ '''  from [' + tab.name 
+ '] where [' + col.name + '] like ''%MISSPELLING HERE%'' union ' 
from sys.tables tab 
join sys.columns col on (tab.object_id = col.object_id)
join sys.types types on (col.system_type_id = types.system_type_id) 
where tab.type_desc ='USER_TABLE' 
and types.name IN ('CHAR', 'NCHAR', 'VARCHAR', 'NVARCHAR'); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-09T16:16:42.830

为此使用查询将使这比实际需要的更复杂。为什么不考虑一些现有的免费 SQL 搜索工具。ApexSQL 有[ApexSQL Search](http://www.apexsql.com/sql_tools_search.aspx)，还有来自 Red-Gate 的[SQL Search 。](http://www.red-gate.com/products/sql-development/sql-search/)这两种方法都可以轻松完成工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-07T14:27:15.657

您可以使用游标和 sys.tables/sys.columns 视图来浏览它们。给我一分钟，我给你密码。

更新：你在这里：

```
declare @col_name nvarchar(50)
declare @sql nvarchar(max)
declare @tbl_name nvarchar(50)
declare @old_str nvarchar(50)
declare @new_str nvarchar(50)

set @old_str = 'stakoverflow'
set @new_str = 'StackOverflow'

declare fetch_name cursor for
select 
    c.name,
    t.name
from 
    sys.columns c
    inner join sys.tables t on c.object_id = t.object_id
    inner join sys.types y on c.system_type_id = y.system_type_id
where
    y.name like '%varchar'
    or y.name like '%text'

open fetch_name

fetch next from fetch_name into @col_name, @tbl_name

while @@fetch_status = 0
begin
    set @sql = 'UPDATE ' + @tbl_name + ' SET ' + 
        @col_name + ' = replace(' + 
            @col_name + ',''' + 
            @old_str + ''',''' + 
            @new_str + ''')'

    exec sp_executesql @sql

    fetch next from fetch_name into @col_name
end

close fetch_name
deallocate fetch_name 
```

这将为您提供所需的一切。它从数据库中获取 varchar、nvarchar、text 和 ntext 列，循环遍历这些列并更新每一列。

当然，您也可以这样做来创建串联的 SQL 语句并在最后进行一次大更新，但是，嘿，这是您的偏好。

作为记录，我不喜欢游标，但由于我们处理的是几列而不是数百万行，所以我可以接受这个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-13T19:29:52.590

上述脚本的 SQL Server 2000 版本（来自 edosoft）：

```
select  
'select distinct ''[' + tab.name + ']'' as TableName, ''[' + col.name + ']'' as ColumnName'
+ ' from [' + users.name + '].[' + tab.name  
+ '] where UPPER([' + col.name + ']) like ''%MISSPELLING HERE%'' union '  
from sysobjects tab  
join syscolumns col on (tab.id = col.id) 
join systypes types on (col.xtype = types.xtype)  
join sysusers users on (tab.uid = users.uid)
where tab.xtype ='U'  
and types.name IN ('char', 'nchar', 'varchar', 'nvarchar'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-08T10:43:35.070

如果有人对 Sybase 需要这样的东西，以下内容可能会有所帮助。

我创建了以下脚本，其中代码打印出所有包含搜索字符串的 TableNames、ColumnNames。

未优化性能，使用游标遍历数据库列，因此在大数据库上运行它可能需要一段时间（取决于大小、表/列数等）

但是，我认为在数据库中搜索字符串是一个不错的实用程序。

```
-----------------------------------------------------------------------------------------------------
-- SYBASE - SCRIPT TO FIND STRING IN ANY COLUMN IN TABLE AND PRINT TableName/ColumnName TO RESULTS --
-----------------------------------------------------------------------------------------------------

-- tested on Sybase ASE 15.7

set nocount off

-- CREATE OBJECTS REQUIRED FOR SCRIPT
create table #SearchString (SearchString varchar(100))
go

-- SET SEARCH STRING
declare @search_string  varchar(100)
set @search_string = 'SEARCH_STRING'

-- WRITE SEARCH STRING TO TEMP TABLE TO STORE IT AWAY AND BE ABLE TO READ IT IN NEXT BATCH
insert into #SearchString (SearchString)
    values (@search_string)

-- GET ALL RELEVANT TABLES AND COLUMNS
insert #TabCol
    select object_name(o.id) as TableName, c.name as ColumnName
        from sysobjects o, syscolumns c 
    where o.type = 'U' -- ONLY USER TABLES
          and c.usertype in (1,2,18,19,24,25,42) -- ONLY LOOK FOR CHAR, VARCHAR, ETC.
          and c.id = o.id
          and c.name is not null
          and c.length >= datalength(@search_string)
go

-- GET TOTAL NUMBER OF RELEVANT COLUMNS
select count(*) as RelevantColumns from #TabCol
go

-- CREATE CURSOR TO LOOP THROUGH TABLES AND COLUMNS TO FIND COLUMNS CONTAINING THE SEARCH STRING
declare cur cursor for 
select TableName, ColumnName from #TabCol order by TableName, ColumnName
for read only
go

-- VARIABLE DEFINITION
declare
    @table_name     SYSNAME,
    @table_id       int,
    @column_name    SYSNAME,
    @sql_string     varchar(2000),
    @search_string  varchar(100)

-- GET SEARCH STRING FROM TABLE
select @search_string = SearchString from #SearchString

-- CURSOR INIT
open cur

fetch cur into @table_name, @column_name

-- LOOP THROUGH TABLES AND COLUMNS SEARCHING FOR SEARCH STRING AND PRINT IF FOUND
while (@@sqlstatus != 2)
begin
    set @sql_string = 'if exists (select * from ' + @table_name + ' where [' + @column_name + '] like ''%' + @search_string + '%'') print ''' + @table_name + ', ' + @column_name + ''''
    execute(@sql_string)
    fetch cur into @table_name, @column_name
end
go

-- CLEAN-UP
close cur
deallocate cur

drop table #SearchString
drop table #TabCol
go 
```

干杯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-04T20:16:56.950

我将架构包含在 edosoft 的版本中。

```
select 
'select distinct ''[' +  SCHEMA_NAME(tab.schema_id) + '].[' + tab.name + '].[' + col.name + ']'
+ '''  from [' +  SCHEMA_NAME(tab.schema_id) + '].[' + tab.name 
+ '] where [' + col.name + '] like ''%hsapp%'' union ' 
from sys.tables tab 
join sys.columns col on (tab.object_id = col.object_id)
join sys.types types on (col.system_type_id = types.system_type_id) 
where tab.type_desc ='USER_TABLE' 
and types.name IN ('CHAR', 'NCHAR', 'VARCHAR', 'NVARCHAR'); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-02-09T13:13:08.933

```
select column_name from information_schema.columns 
    where table_name ='magazines' and DATA_TYPE IN ('CHAR', 'NCHAR', 'VARCHAR', 'NVARCHAR'); 
```

希望能帮助到你

# security - 一个只说“Mozilla/4.0”的用户代理是一个机器人，对吧？

> ID：834918
> 
> 赞同：16
> 
> 时间：2009-05-07T14:19:48.747
> 
> 标签：security, user-agent, bots

我在 Web 应用程序中收到了几个请求，这些请求在我的代码不应该生成的方式上基本上是错误的……主要是对 .ashx 的请求，没有指定任何 GET 参数。

用户代理是“Mozilla/4.0”（仅此而已） IP 每天都在变化。

这是一个机器人，对吧？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-09T14:58:48.620

很抱歉碰到老问题，但我认为这是中国防火墙使用的机器人。他们抓取网页内容，并进行审查。

检查您的日志，看看是否有类似“GET /cert/bazs.cert”的内容。

100％确定是否找到。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-07T14:26:03.663

这对我来说似乎很奇怪。任何合法的机器人都会以您可以识别的方式识别自己。任何恶意机器人都能够做得更好，使用户代理看起来像一个普通的浏览器。这是在中间的某个地方。再加上糟糕的要求，让我相信你正在处理陈旧的无能。

无论哪种方式，您都可能希望对这些请求进行 404 处理，而不是返回黄屏错误。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-07T14:33:13.193

根据[http://www.user-agents.org](http://www.user-agents.org)的“雅虎思维：意图驱动搜索”机器人报告了这一点。

但是，是的，它不会是浏览器报告的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T08:11:42.347

我已经在几个网站上实现了 asp.net 端请求跟踪，通过查看记录我可以说只有用户代理“Mozilla/4.0”可以由以下任何原因产生：

*   无能
*   搜索机器人
*   攻击机器人

有趣的是，我的第一个Android被识别为“Safari 3.0”，最新的Android被识别为“Mozilla 0”！因此，很难将无能指向特定的软件生成。

对每个此类请求返回 404 可能不是搜索机器人的最佳方法，特别是如果这是内容频繁更改的公共网站。

另一方面，您应该知道，`WebResource.axd`目的地无效的请求指向跨站点脚本攻击。在这种情况下，建议使用 SanitizerProvider。[您可以在Cross-site_scripting](http://en.wikipedia.org/wiki/Cross-site_scripting)上阅读有关此类攻击的更多信息。

识别攻击的另一个好处是查看 IIS 日志文件，这些文件通常位于 [系统根目录]:\inetpub\logs\LogFiles\W3SVC1。这是我用于解析 IIS 日志文件的工具的片段：

![在此处输入图像描述](https://i.stack.imgur.com/6wDIH.png)

在这种情况下，用户代理不是问题，通过从 2 个不同的 IP 请求“/dbadmin/index.php”来识别机器人攻击。攻击机器人正在寻找几个文件/页面。

希望这有助于并为这个问题提供额外的价值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T14:33:22.723

这些请求是对您自己编写的现有页面的请求，还是得到 404？

在后一种情况下，它可能是某种扫描攻击，试图在利用漏洞攻击它们之前检测易受攻击的应用程序实例。

# silverlight - Silverlight：如何接收继承的 DependencyProperty 更改的通知

> ID：834929
> 
> 赞同：12
> 
> 时间：2009-05-07T14:21:08.853
> 
> 标签：silverlight, dependency-properties

我有一个继承自（你猜对了）Control 的控件。`FontSize`我想在or`Style`属性更改时收到通知。在 WPF 中，我会通过调用`DependencyProperty.OverrideMetadata()`. 当然，像这样有用的东西在 Silverlight 中没有位置。那么，一个人怎么会收到这些通知呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-12-02T19:00:13.517

我认为这是一个更好的方法。还是需要看利弊。

```
 /// Listen for change of the dependency property
    public void RegisterForNotification(string propertyName, FrameworkElement element, PropertyChangedCallback callback)
    {

        //Bind to a depedency property
        Binding b = new Binding(propertyName) { Source = element };
        var prop = System.Windows.DependencyProperty.RegisterAttached(
            "ListenAttached"+propertyName,
            typeof(object),
            typeof(UserControl),
            new System.Windows.PropertyMetadata(callback));

        element.SetBinding(prop, b);
    } 
```

现在，您可以调用 RegisterForNotification 来注册元素属性的更改通知，例如 .

```
RegisterForNotification("Text", this.txtMain,(d,e)=>MessageBox.Show("Text changed"));
RegisterForNotification("Value", this.sliderMain, (d, e) => MessageBox.Show("Value changed")); 
```

在同一[http://amazedsaint.blogspot.com/2009/12/silverlight-listening-to-dependency.html上查看我的帖子](http://amazedsaint.blogspot.com/2009/12/silverlight-listening-to-dependency.html)

使用 Silverlight 4.0 测试版。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-08T23:28:55.183

这是一个相当恶心的 hack，但您可以使用双向绑定来模拟这一点。

即有类似的东西：

```
public class FontSizeListener {
    public double FontSize {
        get { return fontSize; }
        set { fontSize = value; OnFontSizeChanged (this, EventArgs.Empty); }
    }

    public event EventHandler FontSizeChanged;

    void OnFontSizeChanged (object sender, EventArgs e) {
      if (FontSizeChanged != null) FontSizeChanged (sender, e);
    }
} 
```

然后创建绑定，如：

```
<Canvas>
  <Canvas.Resources>
     <FontSizeListener x:Key="listener" />
  </Canvas.Resources>

  <MyControlSubclass FontSize="{Binding Mode=TwoWay, Source={StaticResource listener}, Path=FontSize}" />
</Canvas> 
```

然后在您的控件子类中连接到侦听器的事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T23:21:29.287

您不能从外部收听依赖属性更改通知。

您可以使用以下代码行访问依赖属性元数据：

```
PropertyMetadata metaData = Control.ActualHeightProperty.GetMetadata(typeof(Control)); 
```

但是，唯一公开的公共成员是“DefaultValue”。

在 WPF 中有多种方法可以做到这一点。但 Silverlight 2 或 3 目前不支持它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T03:04:44.010

我看到的唯一解决方案是听 LayoutUpdated 事件 - 是的，我知道它被调用了很多。但是请注意，在某些情况下，即使 FontSize 或 Style 已更改，它也不会被调用。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-05-07T14:46:04.720

这是我一直使用的（虽然没有在 SL 上测试过，只是在 WPF 上测试过）：

```
 /// <summary>
    /// This method registers a callback on a dependency object to be called
    /// when the value of the DP changes.
    /// </summary>
    /// <param name="owner">The owning object.</param>
    /// <param name="property">The DependencyProperty to watch.</param>
    /// <param name="handler">The action to call out when the DP changes.</param>
    public static void RegisterDepPropCallback(object owner, DependencyProperty property, EventHandler handler)
    {
        // FIXME: We could implement this as an extension, but let's not get
        // too Ruby-like
        var dpd = DependencyPropertyDescriptor.FromProperty(property, owner.GetType());
        dpd.AddValueChanged(owner, handler);
    } 
```

# java - 身份验证方法

> ID：834932
> 
> 赞同：0
> 
> 时间：2009-05-07T14:22:25.840
> 
> 标签：java, python, authentication, encryption, hash

我正在编写一个服务器客户端应用程序来接收用户消息并发布它。

考虑认证方法。

1.  非对称加密，可能是 RSA。
2.  哈希（盐+密码+'msg'+'userid'），SHA256
3.  HMAC，SHA256。似乎比方法 2 更安全。还涉及对密码和 msg 数据进行哈希处理。
4.  使用两侧存储的静态密码对“msg”进行对称加密，可能是 AES。

无需加密，因为无论如何都会在线发布味精。所以我更倾向于 HMAC 或 PKI 方法。

我正在使用 java 发送请求（包括要实现的任何身份验证方法） www.mysite.com/foo?userid=12345&msg=hello&token=abc1234

服务器端的 python 接收请求并确保请求来自有效用户。

问题在于集成并确保双方都了解彼此的身份验证令牌。这对我来说是一个很大的因素。并且还考虑了两种语言可用的库的可用性。

或者我可以选择将服务器端改写成java。（为什么不是python？客户端应用程序需要在java中）

你怎么看？

* * *

编辑：我不会将其视为 Web 应用程序。该应用程序不提供任何网页。大多数操作与网络无关。只是客户端-服务器通信通过互联网。我认为通过 HTTP 发送 POST/GET 是一种更简单但不安全的方式。随时向我建议任何其他选择。

SSL 是一种安全的加密方式。但它并不能阻止攻击者以用户身份向服务器发送消息。任何人都可以发起 HTTPS 连接。并且通信的内容不需要加密。无论如何，它将由服务器在线发布。我需要的是一种对消息和发件人进行身份验证的方法。

现在我倾向于 HMAC 算法。RSA 会更安全，但它也伴随着更多的开发人员努力。会看看情况如何。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T17:44:14.107

您不能只使用标准 SSL 套接字来保护连接，使用密码验证用户，然后发送要发布的消息吗？如果客户端不多，您甚至可以使用自签名证书并将其放在客户端应用程序的 KeyStore 中，这样您就不需要从 Verisign 或其他任何人那里购买证书。

如果您将用户的密码哈希存储在服务器上（我认为您应该否则您将如何验证用户的密码），那么您可以首先在客户端重现该哈希（假设您哈希用户+密码）和然后将其附加到消息并散列结果。您将用户 ID、哈希和消息发送到服务器。

在服务器端，您收到一个带有用户 ID 的请求，您检索用户的密码（服务器只存储了 user+pass 的哈希值），将其附加到消息并再次对其进行哈希处理，并将其与中的哈希值进行比较请求。如果匹配，用户可以发布消息。

哦，您应该使用 HTTP POST，而不是在 URL 上发送数据。服务器不应接受发布请求的 URL 上的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T16:52:37.910

让我在您的提案中添加一些随机的想法/评论。

1.  RSA：由于您主要对身份验证感兴趣，我假设您希望使用 RSA 签名。这意味着每个用户都需要自己的私钥。对我来说，这听起来有点矫枉过正，尤其是当用户和服务器已经共享共同的秘密（即密码）时。
2.  使用 SHA256 是一个很好的方法。我有一些问题要理解为什么要包含盐，因为通常使用盐来避免攻击者预先计算字典的哈希值。需要明确的是：字典攻击在这里是一个问题。攻击者可以尝试使用字典中的所有密码对消息进行哈希处理。只是他必须为每个用户重复这种攻击，并且不能重用预先计算的值。使这种攻击更加困难的一种方法称为密钥强化，例如通过重复对结果进行 n 次散列，从而迫使攻击者在字典攻击期间执行更多工作。
3.  我完全同意 HMAC 比 SHA-256 更好。毕竟 HMAC 是为身份验证而设计的。我不确定为什么要在计算 HMAC 之前对消息进行哈希处理。HMAC 为您做到这一点。
4.  加密并不总是提供身份验证。这尤其适用于攻击者学习明文的情况，就像他在您的情况下所做的那样。他也许能够利用加密模式的特性来操纵密文，并确切地知道得到的明文将是什么样子（例如，CBC 模式允许这种操纵）。您之前的提案（HMAC）更可取。

最后，如果您可以像其他人建议的那样在用户和服务器之间建立 SSL 连接：这将是一个更安全的解决方案，因为即使是上面提到的字典攻击也不可能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T14:53:48.183

好的，首先，要考虑的一个选项是走“企业解决方案”路线并购买标准 PKI 市场：为自己购买 Veri$ign 等的证书并使用无聊的旧 HTTPS（或至少 TLS，底层协议） . 然后从客户端发送数据（或多或少）是一件轻而易举的事，并且在您选择的任何语言中都会有一个标准库来解释另一端的事情。实际上，我认为 HTTPS/TLS 和整个证书基础设施对于您知道正在与哪个服务器通信并且您知道要使用什么加密系统的应用程序来说是一种复杂的空间浪费。但是“开箱即用”的库的可用性意味着它*可以*让您快速启动并运行，因此绝对值得考虑一种或另一种方式。

原则上，您不需要 PKI 颁发的证书即可使用 HTTPS/TLS。但在实践中，花几美元可能比尝试说服标准库接受自发证书更容易。（一般来说，使用 HTTPS 库可能只是意味着您最终将 2 天的“编程我的加密系统”问题变成了 2 天的“为什么这个黑匣子不接受我的证书”问题——这也取决于你想解决什么问题......）

即使您不使用 HTTPS/TLS，您也可能需要通读该规范，以了解它如何克服某些安全威胁（以及这些威胁是什么）。

好的，那么就拿你的观点：

*   需要明确的是，您不需要证书或 PKI 即可使用 RSA 或其他非对称加密。PKI（尝试）解决了客户端需要与“神秘”服务器对话的问题，当该服务器说“这是我的公钥”时，它无法信任该服务器。如果您正在编写一个专用客户端并且您事先知道您正在与哪个服务器通信，那么您可以将公钥分发给您的客户端。客户端知道它正在与正确的服务器交谈，因为如果不是，该服务器将无法理解它使用该公钥加密的内容。
*   使用“原始”哈希时需要注意的主要事情是它们容易受到扩展攻击。因此，如果您发送“a|b|c”加上该数据的哈希码，攻击者可以计算出“a|b|c|d”的哈希码（因此在您的示例（2）中，他们可以替换为“ userid" 为 "useridX" 并根据你为 "a|b|c" 提供的散列码计算出一个新的散列码）。HMAC 方案解决了这个问题。
*   无论如何，如果您使用“原始”加密工具，仍然使用标准库，因为他们会考虑一些安全问题。例如，对于 RSA，您必须小心使用填充（请参阅我[在 Java 中编写的有关 RSA 加密的](http://www.javamex.com/tutorials/cryptography/rsa_encryption.shtml)一些信息 以及它所在的密码学部分——这对您来说可能很有趣）。并且在生成任何加密密钥时，您需要注意“随机数据的来源”。
*   您不必将 AES 加密密钥基于密码（如果您这样做，请阅读基于密码的加密方案：密码通常几乎没有熵，因此您需要采取额外措施来尝试防止这种情况发生）。但我会采用更标准的方法来使用密码对连接进行*身份验证*，并且作为身份验证的一部分，协商一个随机 AES 密钥。
*   确保您正在解决方案中的**重放攻击**问题（通常，客户端和服务器应该在通信开始时相互发送一个随机“nonce”，并且通过该连接的身份验证和未来通信将取决于随机数）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T23:20:15.093

RSA 协议通常用于设置密钥交换以实现更快的加密方式。这就是 SSL 的工作原理。

如果您的应用程序的安全要求如此敏感以至于您需要 PKI，那么应该说（无意苛刻）如果您需要在 SO 上询问它，那么它可能是您不应该尝试做的事情（鉴于对安全通道的成功攻击通常会攻击实施的弱点）。

正如 Chochos 所建议的那样，简单地使用 Java 中现有的 SSL 基础设施和您的服务器来建立一个安全的 https 连接，然后简单地将用户密码从客户端传递到服务器有什么问题？

# jboss - 如何获得无状态 EJBs JNDI 路径？

> ID：834933
> 
> 赞同：2
> 
> 时间：2009-05-07T14:22:27.617
> 
> 标签：jboss, ejb-3.0, jndi

有没有办法让我的无状态 EJBs JNDI 路径？假设我写了一个这样的 EJB：

```
@Stateless
public class BookBean implements IBookBeanLocal {

 @Resource SessionContext sctx;

 ....

 @PostConstruct
 public void afterInit(){
    // sctx??
 }

} 
```

有没有办法在初始化期间发现 BookBeans JNDI 路径？我需要这个在初始化期间将某些 bean 自动订阅到全局注册表。还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-17T10:00:50.983

在 Java EE 6 中，JNDI 路径被标准化并记录在[https://docs.oracle.com/javaee/6/tutorial/doc/gipjf.html](https://docs.oracle.com/javaee/6/tutorial/doc/gipjf.html)

因此，假设您只在一只耳朵内进行 JNDI 调用：

```
@Stateless
public class BookBean implements IBookBeanLocal {

    @Resource(lookup = "java:module/ModuleName")
    private String moduleName;

    @PostConstruct
    public void afterInit() {
        String jndi = "java:app/" + moduleName + "/" + getClass().getSimpleName();
    }
} 
```

或通过以下方式获取模块名称`lookup`：

```
@Stateless
public class BookBean implements IBookBeanLocal {
    @PostConstruct
    public void afterInit() {
        Context ctx = new InitialContext();
        String jndi = "java:app/" + ctx.lookup("java:module/ModuleName") + "/" + getClass().getSimpleName();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T19:05:16.967

您可以在 @Stateless 注释或 xml ejb 配置中编写所需的 jndi 路径，并在运行时读取它。

找出自动生成的 jndi 路径很麻烦。

# windows - 如何在 Windows 中管理 PATH 变量？

> ID：834944
> 
> 赞同：15
> 
> 时间：2009-05-07T14:25:02.760
> 
> 标签：windows, system, classpath

每次我尝试一种新的语言、编译器、解释器、工具或其他任何东西，并且我想从命令行运行它时，我都必须转到 System 并更改我的 PATH 变量。但是，放置怪物字符串的框仅包含 1 行文本框。我经常发现自己不得不将 PATH 字符串复制/粘贴到记事本中才能对其进行编辑——它已经超过半页了。现在我已经计算了大约 30 个不同的路径 URL。

有没有比将所有路径压缩成一个字符串更好的方法来管理路径？我正在考虑使用 SUSE 进行开发，因为我的 PATH 太混乱了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-12T05:10:48.480

有一个非常好的免费软件环境编辑器，叫做[RapidEE](http://www.rapidee.com/en/about)

**快速环境编辑器**

Rapid Environment Editor (RapidEE) 是一个环境变量编辑器。

它包括一个易于使用的 GUI，并取代了小而不方便的 Windows 编辑框。

RapidEE 8.x 支持 Windows XP、2003、Vista、2008、Windows 7、Windows 8 和 Windows 10（包括 64 位版本）。

如果您仍然使用 Windows NT 或 2000，请使用 6.1 版。对于 Windows 9x 或 ME，请使用 2.1 版。

特征

*   **可编辑树**：将环境变量和值显示为可编辑树。
*   **便携模式**：RapidEE 不需要安装，可以作为“便携应用程序”运行。
*   **错误检查**：自动检查无效的路径名和文件名
*   **多语言界面**：RapidEE 被翻译成多种语言（英语、俄语、日语、法语、波兰语、德语、意大利语、拉脱维亚语、斯洛伐克语、希腊语、西班牙语、中文、荷兰语、瑞典语、韩语、克罗地亚语、丹麦语、巴西葡萄牙语、芬兰语、挪威语、印度尼西亚语、罗马尼亚语、匈牙利语、土耳其语、阿布哈兹语、乌克兰语、捷克语、阿拉伯语），并且可以随时更改语言。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-07T14:30:25.697

如果您总是从一个或几个快捷方式启动命令行，您可以在启动时运行一个批处理文件。例如：

```
cmd /k autoexec_console.cmd 
```

批处理文件可能在哪里

```
set path=c:\foo;%path% 
```

或其他任何东西，这只会持续存在于该 cmd.exe 实例。

* * *

XP 的[Service Pack 2 支持工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=49AE8576-9BB9-4126-9761-BA8011FABF38&displaylang=en)（看起来好像有[一个用于 SP3](http://www.microsoft.com/downloads/details.aspx?FamilyID=673a1019-8e3e-4be0-ac31-70dd21b5afa7&DisplayLang=en)的，但它没有说明里面有什么）附带一个`setx.exe`像永久`set`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-07T14:43:44.587

为了在默认 Windows 界面中更好地管理非常长的 PATH，您可以将变量评估为变量：

```
SDKPATH -> some_sdk_path; some_more_sdk_paths; some_more_sdk_paths;
DEVPATH -> some_dev_path; some_more_dev_paths; %SDKPATH%
PATH    -> some_common_path; some_mode_paths; %DEVPATH% 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T14:33:19.230

当您只是在尝试使用一次性语言时，您可以创建一个小的启动批处理文件来操作路径：

```
set PATH=C:\My\New\Language\bin;%PATH% 
```

并通过创建快捷方式来创建一个小型测试环境

```
cmd /k mybatch.cmd 
```

路径将根据您的喜好设置。否则，您可以在注册表中编辑长字符串，这可能比 200 像素宽的文本框略好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-07T14:35:00.520

使用批处理 (.BAT) 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-08T08:13:25.917

我建议尝试[环境变量编辑器](http://eveditor.com)（Eveditor）。它易于使用且完全免费。

环境变量编辑器可帮助您组织和简化系统变量（包括系统路径）的使用并优化您的工作环境，而不会丢失有价值的配置设置，当您在机器上安装新软件时，可能会无意中发生这种情况并造成破坏性影响。

# web-services - 抓取股价信息有多安全

> ID：834951
> 
> 赞同：7
> 
> 时间：2009-05-07T14:25:49.793
> 
> 标签：web-services, finance, stockquotes

据我所知，没有针对股票价格信息的开发人员 API 服务，其规定如下：

*   免费或低月费（
*   能够将使用该服务的代码发送给多方（例如 iPhone 应用程序）
*   没有每笔交易/查找成本
*   查找或交易的数量没有限制

所以我发现我不得不看刮。似乎最容易“抓取”的是 Yahoo 的 CSV 服务，该服务链接到 StackOverflow 上的其他地方：

例如： http: [//finance.yahoo.com/d/quotes.csv?s =msft&f=price](http://finance.yahoo.com/d/quotes.csv?s=msft&f=price)

这实际上很容易解析。但是我想知道这是多么脆弱，很明显如果雅虎删除了这项服务，或者改变了一些东西，或者严格限制了查找的数量，那么我建立的客户端可能会受到影响。

其他人将如何解决这个问题，或者仅仅是数据太有价值并且无法以我的价格获得的情况？我已经搜索了一个相当可靠的、延迟 20 分钟的服务，但根本找不到一个看起来在 6 个月内仍然存在的服务。

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-07T14:39:25.410

你看过谷歌的市场数据 API 吗？

2013 年 4 月更新 -[市场数据 API 不再可用](http://developers.google.com/finance/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-07T14:26:52.600

“数据太有价值了，我的价格买不到？”

正确的。

想想看。财富是通过这些信息创造（和失去）的。您正在与大型银行和股票经纪服务竞争。这些公司 (a) 拥有大量资金来购买、出售和保护此类信息，以及 (b) 有动力将这些信息尽可能保密，以加强对股票交易的严格控制。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-22T12:15:22.170

有很多低成本的服务。我喜欢 csidata.com。

但是（这是一个很大的问题）.....如果您计划*重新分发*数据（将其发布在网站上，从 iPhone 应用程序访问它，除了在那台机器上使用它之外的几乎任何东西），您将去支付大笔（如，比你想象的更大）的钱。

交易所通过出售这些数据来赚钱。

如果您打算开展业务，请*不要*计划能够抓取雅虎或其他地方并重新分配它。一旦他们发现你，你将被关闭。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-07T14:28:44.297

你需要小心。除了对网站 ui 的正常依赖外，我还收到了来自网站的警告。他们有一个反对屏幕抓取的网站政策，我突然同意使用该网站，他们看到了我对该网站的定期点击。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-07T15:06:47.700

我推荐 IQFeed（付费）、esignal（付费）或 eoddate.com（免费选项）。我的公司使用 IDC，但我似乎无法找到有关他们提供的子服务的任何信息。

虽然我的印象是你试图避免为商业提要付费，但你需要小心，你得到了你所支付的。

# iphone - 如何解决 Objective-C 类中的双向依赖问题？

> ID：834955
> 
> 赞同：4
> 
> 时间：2009-05-07T14:26:05.440
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, uikit

好的，这可能是一个非常愚蠢的初学者问题，但是：

我有一个 ClassA，它将从 ClassB 创建一个子对象并将其分配给一个实例变量。详细说明：ClassA 将在指定的初始化程序中分配和初始化 ClassB，并将其分配给 childObject 实例变量。它的标题如下所示：

```
#import <Foundation/Foundation.h>
#import "ClassB.h"

@interface ClassA : NSObject {
    ClassB *childObject;
}

@end 
```

然后是ClassB的头部。ClassB 必须引用 ClassA。

```
#import <Foundation/Foundation.h>
#import "ClassA.h"

@interface ClassB : NSObject {
    ClassA *parentObject;
}

- (id)initWithClassA:(ClassA*)newParentObject;

@end 
```

当 ClassA 对象从 ClassB 创建一个子对象时，ClassA 对象将调用 ClassB 对象的指定初始化器，它必须在其中传递自己（self）。

我觉得有什么问题，但现在我不知道它到底是什么。我认为我知道这是行不通的。他们不能互相导入。编译器只是告诉我：“错误：'ClassA'之前的语法错误”。当我删除用于导入 ClassA 的 import 语句时，删除 ClassA *parentObject 实例变量并删除指定初始化程序（它采用 ClassA 引用），然后它就可以工作了。

现在，这是我想要实现的（如果这很重要）：我需要在 UIScrollView 中进行一些非常特殊和复杂的行为。所以我决定对它进行子类化。因为主要部分将在委托方法中完成，所以我决定为我的 UIScrollView 子类创建一个“通用”委托对象。然后，我的 UIScrollView 子类会自动创建该特殊委托对象并将其分配给其委托属性。委托对象本身需要引用它的父对象，即定制的 UIScrollView，以便它可以访问该滚动视图的子视图。但无论如何，即使有更好的方法来解决这个问题，我仍然想知道如何使用两个需要彼此的“相互依赖”的对象来做到这一点。

欢迎任何建议！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-07T14:33:21.100

您不需要在头文件中导入这些类。在头文件中使用`@class`，然后仅在 .m 文件中使用 #import：

```
// ClassA.h:
@class ClassB;
@interface ClassA : NSObject
{
    ClassB *childObject;
}
@end 
```

```
// ClassA.m:
#import "ClassA.h"
#import "ClassB.h"
@implementation ClassA
//..
@end 
```

```
// ClassB.h
@class ClassA;
@interface ClassB : NSObject
{
    ClassA *parentObject;
}
- (id)initWithClassA:(ClassA*)newParentObject;
@end 
```

```
// ClassB.m:
#import "ClassB.h"
#import "ClassA.h"
@implementation ClassB
//..
@end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-07T14:32:03.773

使用`@class A;`and`@class B;`而不是`#import`s 来告诉编译器不要担心类定义，继续前进，因为稍后会遇到它们。

基本上，替换`#import "A.h"`为`@class A;`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-07T14:34:31.740

您需要做的是“前向声明”您的类，而不是导入完整的定义。例如：

```
#import <Foundation/Foundation.h>

@class ClassB; // Tell the compiler that ClassB exists

@interface ClassA : NSObject {
    ClassB *childObject;
}

@end 
```

你对 ClassB 头文件做类似的事情。

# visual-studio - 如何确定 Visual Studio 正在运行哪个服务包？

> ID：834956
> 
> 赞同：14
> 
> 时间：2009-05-07T14:26:08.840
> 
> 标签：visual-studio, visual-studio-2008, servicepacks

如何确定 Visual Studio 正在运行哪个服务包（如果有）？现在我正在尝试确定一台机器是在运行 VS2008 还是 VS2008 SP1。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-07T14:27:18.433

找到了。这不是我最初预期的版本号。

转到帮助 > 关于 Microsoft Visual Studio，它位于已安装产品下：

> Microsoft Visual Studio 2008 专业版-ENU Service Pack 1 (KB945140)

我不得不滚动列表才能找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:28:26.200

帮助 -> 关于 Microsoft Visual Studio

# language-agnostic - CPU 是否浪费在等待键盘输入上？（通用的）

> ID：834961
> 
> 赞同：0
> 
> 时间：2009-05-07T14:26:29.823
> 
> 标签：language-agnostic, input, operating-system, generics

如果有一种方式，操作系统不需要循环无限等待来自键盘（或其他输入设备）的输入，并且是否有任何操作系统使用它，我正在徘徊。我不敢相信我们确实需要浪费循环来等待输入，为什么输入一旦按下就不能做某事，而不是让机器等待动作。

长话短说：

当前如何处理键盘输入 - 轮询或中断？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T14:35:57.243

正如您所描述的，大多数现代程序都不会在循环中获得输入。您可以使用[事件处理](http://www.javaworld.com/javaworld/jw-08-1996/jw-08-event.html)或中断来避免浪费周期。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-07T14:49:49.627

所有基于 Linux 的操作系统上所有设备的所有设备输入都是中断驱动的。不使用忙于等待（主动轮询）的数据。

Windows 也可能都是中断驱动的。（Windows 中隐藏着 DOS 遗留问题——轮询可能仍然在其中发生。）

所有 Linux 的工作方式都相同。内核等待中断，将中断排队并检查调度程序以处理下一个优先级最高的中断。进程调度的优先级总是低于中断调度。

键盘中断由缓冲信息的驱动程序处理。窗口管理器（例如 Gnome）从缓冲区中获取内容以创建键盘中断流。

您可以购买许多关于操作系统设计的非常好的书籍，这些书籍涵盖了设备驱动程序和内核之间的关系。[从http://lwn.net/Kernel/LDD3/](http://lwn.net/Kernel/LDD3/)开始

顺便说一句，时钟中断是进程调度发生的方式。如果没有任何设备活动，时钟将定期中断，迫使内核查看时间表，可能会更改正在执行的进程。使用大量 CPU 的进程的优先级降低。执行大量 I/O 的进程大部分时间都在等待 I/O 完成，因此提高了它的优先级。

* * *

**编辑**

此外，有时 DMA 设备会绕过内核中断处理以进行字节块传输。中断启动传输，但设备位于总线上并访问内存目录。视频显示器、磁盘（以及过去的网络设备）可能是 DMA。然而，键盘的体积如此之小，以至于 DMA 并不是一个有用的优化。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-07T14:52:58.120

通常它是这样的：

*   一个进程（一个应用程序）执行一个（阻塞）系统调用，意思是“给我一个按键”
*   操作系统将进程置于“等待 IO”状态，将其从 CPU 中踢出
*   ...时间流逝，其他进程愉快地运行，磁盘旋转，灯闪烁...
*   用户按键，产生中断
*   操作系统获取中断，读取按键，检查是否有任何进程在等待此特定设备（键盘）输入
*   找到等待进程，将其移至“可运行”状态
*   只要有空闲的 CPU，进程就会得到它并在系统调用后恢复执行

因此，在任何阶段都没有轮询（主动等待）。

编辑：据我所知，Linux 内核有时会切换到轮询设备，否则这些设备会被中断淹没（想想快速网卡接收大量数据包）。在这些情况下，它节省了 CPU 时间而不是浪费它 - 操作系统通过一次轮询获得大量数据，而不是通过许多中断获得许多小块。当轮询不再获取任何数据时，操作系统切换回等待中断模式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T14:32:09.543

您可以使用非阻塞函数检查键盘输入，如果没有任何内容，则使用 sleep(1) 或类似结构协同屈服。

您**无需**浪费已安排的 CPU。

阻塞键盘功能完全有可能自行产生，操作系统只会在输入后恢复线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T15:41:00.550

USB 设备不能产生中断，因此每秒会被操作系统多次轮询。游戏玩家有时喜欢增加此轮询频率以获得更灵敏的鼠标。

游戏经常使用轮询来处理输入，但其他应用程序更有可能在操作系统向它们发送输入之前休眠。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T14:41:06.200

我唯一一次看到轮询是在处理原始 DirectX 输入设备时（因为它们超出了典型 H/W 架构的范围）。您必须轮询这些设备（可能是鼠标、键盘、操纵杆、游戏手柄等）以获取它们的当前状态。正如其他人所说，典型的键盘是通过中断处理的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-21T15:44:58.317

不，它没有，键盘输入由 DMA 处理，这是处理器不知道的真正后台任务。

# sql - 使用 IN (...) 是随机访问 MySQL 表的最有效方法吗？

> ID：834962
> 
> 赞同：1
> 
> 时间：2009-05-07T14:26:36.907
> 
> 标签：sql, mysql

我有一个有 240 万行以上的表，没有索引。我 100% 确定所有行都有一列（我们称之为`id`），它是唯一的，它是 type `VARCHAR(255)`。

我现在有一个大约 10,000 的文件，`id`需要为每个文件提取整行。

正在使用`IN(...)`我的最佳选择吗？我应该添加索引吗？

我正在考虑一些这样的想法：

```
SELECT * FROM archive_table WHERE id IN('id1', 'id2', ... 'idn'); 
```

这是有效的存档数据，我每隔几周才访问一次。

* * *

系统：MySQL 5.0.45 表：MyISAM

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T15:08:06.120

由于您有所需的 id 文件，因此我建议将其导入工作表，然后将该表连接到您的生产表以获得所需的结果。当然，在你做任何事情之前，你需要实现一个索引策略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T14:50:53.807

在 ID 列上添加索引并（可选）将其定义为 UNIQUE。这将帮助 MySQL 快速定位您想要的行，因为索引包含排序顺序的 ID。即使您的表也已排序，例如因为您以递增的 ID 顺序插入，MySQL 不知道这一点，并且总是会进行全表扫描以查找匹配的查询记录。

另一方面，有了索引，服务器的搜索变得非常容易。仅当您一次请求非常非常多的行（非常长的 IN() 子句）时，优化器可能会决定您需要超过大约 30% 的数据 - 在这种情况下，它将再次回退到线性扫描以防止过多的磁盘查找。

然而，有几百万行，这将是一个漫长的条件:)

我还建议重新考虑该列是否真的必须是 255 个字符长 - 即使 VARCHAR 在您不需要时不会使用那么多空间，这听起来像是一个有问题的设计。它是否应该是数字字段可能取决于您的需要，但通常建议使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T14:35:47.837

地狱是的，你应该添加一个索引。但如果 id 是“主键”，那么它已经是一个索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T16:26:00.410

根据我们的 DBA 过去对我的理解，“IN”子句对可以在括号内指定的显式 ID 的数量有限制。我被告知如果您可以使用 SELECT 来提供 IN 列表，则这不适用。

HLGEM 关于导入和使用表连接的建议可能是最简单的方法。而且，如前所述，索引将提高性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T20:20:58.690

是的，在两个表（240 万和 10,000）上添加索引。

假设 transaction_table 是 10,000 行，archive_table 是 240 万行，并且您已经构建了一个索引 overr archive_table，您可以编写代码：

```
SELECT id
  FROM transaction_table a
 WHERE EXISTS( SELECT *
                 FROM archive_table b
                WHERE a.id = b.id ) 
```

在 JOIN 上使用 EXISTS 子句更具可读性，并且与连接具有相同的性能。

# sql - 使用 DateDiff 时的 SQL 动态 DatePart

> ID：834971
> 
> 赞同：25
> 
> 时间：2009-05-07T14:27:44.047
> 
> 标签：sql, sql-server, sql-server-2005, tsql, datetime

有没有办法将 DateDiff 的 DatePart 参数作为变量传递？这样我就可以编写与此类似的代码？

```
DECLARE @datePart VARCHAR(2)
DECLARE @dateParameter INT

SELECT @datePart = 'dd'
SELECT @dateParameter = 28

SELECT
    *
FROM
    MyTable
WHERE
    DATEDIFF(@datePart, MyTable.MyDate, GETDATE()) < @dateParameter 
```

我能想到的唯一方法是使用 CASE 语句检查参数的值，或者将 SQL 构建为字符串并在 EXEC 中运行。

有没有人有任何“更好”的建议？平台是 MS SQL Server 2005

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-07T14:31:52.430

根据SQL Server 2005的[DATEDIFF](http://msdn.microsoft.com/en-us/library/ms189794(SQL.90).aspx)（*参数部分）上的 BOL 条目，*

> 这些日期部分和缩写不能作为用户声明的变量提供。

因此，您可能会被动态 SQL 或使用 CASE 语句所困扰。但我会选择 CASE 版本而不是动态 SQL。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-07-11T06:29:31.993

旧的但不幸的是仍然有效。

我这样做了，只是想分享代码，这样你就不必做我必须做的所有烦人的打字。涵盖所有可能的日期部分。只需替换函数名称和日期函数即可为其他 T-SQL 日期函数实现。

***复制和粘贴部分***

```
-- SELECT dbo.fn_DateAddFromStringPart('year', 1, GETDATE())
CREATE FUNCTION fn_DateAddFromStringPart
(
    @Interval VARCHAR(11),
    @Increment INT,
    @Date SMALLDATETIME
)
RETURNS DATETIME
AS
BEGIN
    -- Declare the return variable here
    DECLARE @NewDate DATETIME

    -- Add the T-SQL statements to compute the return value here
    SELECT @NewDate = CASE
        WHEN @Interval IN ('year', 'yy', 'yyyy') THEN DATEADD(YEAR, @Increment, @Date)
        WHEN @Interval IN ('quarter', 'qq', 'q') THEN DATEADD(QUARTER, @Increment, @Date)
        WHEN @Interval IN ('month', 'mm', 'm') THEN DATEADD(MONTH, @Increment, @Date)
        WHEN @Interval IN ('dayofyear', 'dy', '') THEN DATEADD(DAYOFYEAR, @Increment, @Date)
        WHEN @Interval IN ('day', 'dd', 'd') THEN DATEADD(DAY, @Increment, @Date)
        WHEN @Interval IN ('week', 'wk', 'ww') THEN DATEADD(WEEK, @Increment, @Date)
        WHEN @Interval IN ('weekday', 'dw', 'w') THEN DATEADD(WEEKDAY, @Increment, @Date)
        WHEN @Interval IN ('hour', 'hh') THEN DATEADD(HOUR, @Increment, @Date)
        WHEN @Interval IN ('minute', 'mi', 'n') THEN DATEADD(MINUTE, @Increment, @Date)
        WHEN @Interval IN ('second', 'ss', 's') THEN DATEADD(SECOND, @Increment, @Date)
        WHEN @Interval IN ('millisecond', 'ms') THEN DATEADD(MILLISECOND, @Increment, @Date)
        WHEN @Interval IN ('microsecond', 'mcs') THEN DATEADD(MICROSECOND, @Increment, @Date)
        WHEN @Interval IN ('nanosecond', 'ns') THEN DATEADD(NANOSECOND, @Increment, @Date)
    END

    -- Return the result of the function
    RETURN @NewDate

END
GO 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T14:47:25.763

除了建议的动态 sql 或 case 语句之外，您真正可以做的唯一一件事是始终在粒度 DatePart 处执行 datediff，然后进行上转换。虽然这不是万无一失的，但如果您尝试使用 datediff 来细化一个过大跨度的部分，例如 datediff(second, 0, getdate())，您将在函数中得到溢出。但是，如果您只需要诸如微小部分之类的东西，那应该没问题（仔细检查您关心的最大日期值）。

所以例如

```
select datediff(minute, 0, getdate()) 
```

如果我想将其转换为小时、天等，我可以将结果除以适当的数量。它不会考虑闰年等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-25T16:11:05.870

绝对使用像下面这样的动态查询效果很好，我假设您打算只使用@datePart 的缩写。我建议对 datepart 至少使用 VARCHAR(4)，这将处理 yyyy 和 mcs 之类的缩写。快乐编码：

```
DECLARE @datePart VARCHAR(2)
DECLARE @dateParameter INT
DECLARE @SQLTemp varchar(MAX)

SELECT @datePart = 'dd'
SELECT @dateParameter = 28

set  @SQLTemp ='SELECT * FROM MyTable
    WHERE DATEDIFF('+@datePart+', '+MyTable.MyDate+', GETDATE()) < '+@dateParameter

exec (@SQLTemp) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T14:31:59.077

我认为没有比你描述的更好的方法了。Sql Server 可能会将 DATEDIFF 查询编译为一组依赖于 datepart 参数的操作。因此，您需要一个 CASE 或动态查询。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-13T15:14:37.950

我创建了一个标量值函数来执行此操作。它基于上面提到的解决方案，但更容易在您的代码中实现

```
CREATE FUNCTION [dbo].[dynamic_dateadd] 
(
@unit varchar(5),
@number int,
@dt datetime
)
RETURNS datetime
AS
BEGIN
    declare @result datetime
    if (@unit='M') BEGIN SET @result=(select DATEADD(M,@number,@dt)) END
    if (@unit='WW') BEGIN SET @result=(select DATEADD(WW,@number,@dt)) END
    if (@unit='D') BEGIN SET @result=(select DATEADD(D,@number,@dt)) END
    if (@unit='H') BEGIN SET @result=(select DATEADD(HH,@number,@dt)) END
    return(@result)
END 
```

在查询中，您可以像这样使用此函数：

```
select startdate, validity_unit, validity_number,
dbo.dynamic_dateadd(valididy_unit,validity_number,startdate) as enddate
from SALES_subscription 
```

# wamp - 安装 Skype 后 Wampserver 无法正常工作

> ID：834978
> 
> 赞同：2
> 
> 时间：2009-05-07T14:29:02.437
> 
> 标签：wamp, wampserver, skype

最近我安装了Skype，并且知道Skype端口冲突错误。我已经从选项中删除了“使用端口 80 和 443 作为传入连接的替代方案”，但仍然没有运气。

我还卸载了Skype，重新安装并重新启动了我的机器几次都无济于事。另外，我刚刚尝试运行我的 torrent 客户端，但我第一次遇到错误。

`http://localhost/`现在不会加载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-12T17:02:33.497

我遇到了同样的问题。我通过单击 wamp 图标测试端口 80，转到 Apache，然后服务，然后测试端口 80。它说端口 80 当前正在被 Microsoft-HTTPAIP/2.0 使用。经过一番研究，我发现这是 Microsoft Reporting Services 的一个过程（安装 SQL Server 2008 的结果）。我从服务控制台中停止了服务，瞧！它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-05T09:35:43.013

我遇到了同样的问题，我没有 Skype 或任何其他可能使用端口 80 的应用程序。

我终于发现这是我的虚拟主机之一导致问题，也许尝试删除所有虚拟主机或只是取消注释：包括 conf/extra/httpd-vhosts.conf

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-20T13:12:18.917

在 Apache 下打开 httpd.conf 并更改行

```
#Listen 12.34.56.78:80
Listen 80 
```

至

```
#Listen 12.34.56.78:80
Listen **8080** 
```

保存文件并选择“重新启动所有服务”，就完成了。

# visual-studio - Visual Studio 2008 SP1 可再发行组件

> ID：834979
> 
> 赞同：3
> 
> 时间：2009-05-07T14:29:05.900
> 
> 标签：visual-studio, visual-studio-2008, download, servicepacks

有谁知道在哪里下载 Visual Studio 2008 SP1 Redistributable？

我当然想拥有它，这样我就不必为每次安装下载服务包。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T14:38:57.767

[这个](http://www.microsoft.com/downloads/details.aspx?FamilyID=27673c47-b3b5-4c67-bd99-84e525b5ce61&displaylang=en)怎么样- Microsoft Visual Studio 2008 Service Pack 1 (iso)？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T14:40:20.477

您可以在此处获取 Visual Studio 2008 SP1 ISO - [http://www.microsoft.com/downloads/details.aspx?FamilyID=27673c47-b3b5-4c67-bd99-84e525b5ce61&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=27673c47-b3b5-4c67-bd99-84e525b5ce61&displaylang=en)

它是 831.3 MB

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-01T10:54:17.187

[http://www.microsoft.com/downloads/en/details.aspx?FamilyID=9b2da534-3e03-4391-8a4d-074b9f2bc1bf&displaylang=en](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=9b2da534-3e03-4391-8a4d-074b9f2bc1bf&displaylang=en)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-07T14:30:13.870

试过[MSDN](http://www.microsoft.com/downloads/details.aspx?familyid=A5C84275-3B97-4AB7-A40D-3802B2AF5FC2&displaylang=en)吗？

# sql - 替换功能问题

> ID：834982
> 
> 赞同：0
> 
> 时间：2009-05-07T14:29:41.970
> 
> 标签：sql, replace, db2

在我的一个结果集中，我有一列带有 char - 数据。我想创建另一列，其中包含来自第一列的更改数据。在那里我想用oe交换所有'ö'。

我试过这样：

```
Select NAME1,
    case when POSSTR(NAME1, 'ö') is not null then REPLACE(NAME1, 'ö', 'oe')
    end As __NAME1
from xyz; 
```

它失败了。我没有收到错误，但 ö 没有被替换。

我犯了错误还是根本无法执行此操作？

谢谢！帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T07:33:34.190

您希望第二列列出所有行，包括更改和未更改的行，您可以简单地使用：

```
Select 
    NAME1,
    REPLACE(NAME1, 'ö', 'oe') As __NAME1
from xyz; 
```

你也可以测试这个：

```
Select 
    NAME1,
    REPLACE(NAME1, 'ö', 'oe') As __NAME1
from 
    xyz
where
    POSSTR(NAME1, 'ö') <> 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:50:15.523

根据 DB2 文档，如果未找到字符串，则 POSSTR 返回 0（非 NULL）。

# asp.net - 这里的 window.open 出了什么问题？

> ID：834988
> 
> 赞同：2
> 
> 时间：2009-05-07T14:30:36.130
> 
> 标签：asp.net, javascript, window.open

我正在对 url 中的参数进行编码，并将 a 标签的 href 设置如下：

```
href="javascript:var win=window.open('LayerPreview.aspx?tLNUMCswKSXpnGpQy1rWev26c5euEUa97eqiZYdDpMvDcKNbi6Z05Q3WC5DhG%2b8HJFGHAo%2fHiSFrtEEsHiConkpaT2aJ2WV0Hxxqo2l1bmkNdAotVVvI%2fT4JtE%2fc3dJ8MEAhM3NJZ15qk3fkW87q9A%3d%3d','','width=800,height=600,resizable=no','true');" 
```

但是点击链接的时候，在LayerPreview.aspx的Page_Load中，查询字符串已经被修改了，即原来的：

```
tLNUMCswKSXpnGpQy1rWev26c5euEUa97eqiZYdDpMvDcKNbi6Z05Q3WC5DhG%2b8HJFGHAo%2fHiSFrtEEsHiConkpaT2aJ2WV0Hxxqo2l1bmkNdAotVVvI%2fT4JtE%2fc3dJ8MEAhM3NJZ15qk3fkW87q9A%3d%3d' 
```

变成：

```
tLNUMCswKSXpnGpQy1rWev26c5euEUa97eqiZYdDpMvDcKNbi6Z05Q3WC5DhG+8HJFGHAo%2fHiSFrtEEsHiConkpaT2aJ2WV0Hxxqo2l1bmkNdAotVVvI%2fT4JtE%2fc3dJ8MEAhM3NJZ15qk3fkW87q9A=%3d 
```

显然，这搞砸了我的解码。

有任何想法吗？

谢谢，

卡尔。

**编辑**：我已经在使用 System.Web.HttpUtility.UrlEncode 和 System.Web.HttpUtility.Decode。

这是操作：

1.  生成纯文本查询字符串。
2.  加密查询字符串。
3.  通过 System.Web.HttpUtility.UrlEncode 运行它。

在读取查询字符串时，我只是做相反的事情：

1.  通过 System.Web.HttpUtility.UrlDecode 运行它。
2.  解密查询字符串。
3.  读取查询字符串。

这在我的网络应用程序中的其他任何地方都有效，但在为 window.open url 或任何其他 javascript 方法分配链接时无效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T15:22:40.343

使用**Uri.EscapeDataString**和**Uri.UnescapeDataString**而不是 Uri.EscapeUriString（URLEscape 与 EscapeUriString 相同）。

urlencode 和 urldecode 用于 url。urlencode 将空格转换为 + 并单独留下“/”，因为它假定这些是 url 中的有效字符（它们是）。urldecode 则相反，将 + 转换为空格。urldecode 不希望看到 + 被转换。我想它也不希望有效的 URL 中包含“==”。通常是一堆用“&”分隔的“x=y”。“=”连续两次没有意义，所以它只转换了一次。

但是您不希望 + 转换为空格并返回，您想要 %2b 或其他什么。您不是在转义 URL，而是在转义将在 url 中的数据字符串。在 .NET 中使用 Uri.EscapeDataString 和 Uri.UnescapeDataString。

（你的“加密”输出的是 0-9 az AZ + /，一共 64 个不同的字符，末尾有 ==。所以我们不要像 base64 那样称它为“加密”。原始数据是一些二进制的，所以我猜测那是加密数据。）

[http://codeidol.com/csharp/csharpckbk2/Web/Escaping-and-Unescaping-Data-for-the-Web/](http://codeidol.com/csharp/csharpckbk2/Web/Escaping-and-Unescaping-Data-for-the-Web/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T14:35:27.197

您的字符串包含一些将被转义的字符，我相信这就是发生在您身上的事情。我认为您可能需要使用`URLEncode`and `URLDecode`。您可以在 javascript 或服务器端执行此操作，具体取决于您如何获得该长字符串（加密文本？）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-18T17:15:07.720

我面临同样的问题。当我们使用`window.open`in`href`属性打开窗口时会出现此问题。

`window.open`如果您尝试从 javascript调用相同的问题，则不会发生相同的问题。

解决此问题的方法是在使用 in`window.open`函数之前将您的 url 解码两次 href `attribute`。

所以请按照以下步骤

*   生成纯文本查询字符串。

*   加密查询字符串。

*   运行它`System.Web.HttpUtility.UrlEncode`。

*   再次运行它`System.Web.HttpUtility.UrlEncode`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T14:35:53.357

您的原始查询参数包含许多百分比符号。我的猜测是这些再次被解释（连同以下 2 或 3 个字符，在谷歌搜索 URL 编码）。如果确实如此，请查看您是否可以以某种方式转义 % 符号，或“编码”它们。

# .net - 对数组进行标注时，为每个元素分配多少内存？

> ID：834989
> 
> 赞同：2
> 
> 时间：2009-05-07T14:30:55.943
> 
> 标签：.net, vb.net, arrays, memory-management

例如，在 VB.NET 中：

```
 Dim strArray(5) As String 
```

据我了解，因为这是一个数组，所以计算机将为 5 个元素中的每一个分配连续的内存位置。但是为这五个元素中的每一个分配了多少空间呢？如果我决定将 5MB 的文本块放在数组的位置 2 会怎样？

值类型（例如，Int32 数组）是否不同？我认为，如果它必须为单个元素调整内存块的大小，则必须创建一个全新的数组来保留连续内存功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T14:33:43.753

如果你制作一个引用类型的数组，我认为只有*引用*保存在变量中。那是：

```
Dim strArray(5) As String 
```

实际上只有 6 个*引用*大，每个引用 4 个字节（不确定）。

实际数据将（可能）存储在堆上。

但是，这并不意味着更改字符串的长度是微不足道的——它们仍然必须在每次更改时重新分配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T14:48:18.257

在 .NET 中：

*   数组通常存储在堆上（除非你使用类似`stackalloc`C# 的东西）
*   如果您创建一个引用类型值（例如字符串）数组，则该数组*仅*包含引用
*   运行 32 位 CLR 时引用为 4 个字节，运行 64 位 CLR 时为 8 个字节
*   尽管数组本身在内存中是连续的，但没有什么可以说字符串本身是连续的

所以在你的情况下，数组对象本身将是

```
normal object overhead 
+ 4 bytes for the length (IIRC) 
+ (4 or 8 bytes per element) * 6 elements 
```

数组中的引用可以引用内存中任何位置的任何字符串，或者`Nothing`.

对于值类型，数组直接保存值 - 因此 s 的数组`Int32`将占用：

```
normal object overhead
+ 4 bytes for the length
+ 4 bytes per element 
```

一个`Int64`s 数组将采用：

```
normal object overhead
+ 4 bytes for the length
+ 8 bytes per element 
```

（ETC）。布尔值每个元素占用一个字节，尽管逻辑上只是一个位。

# apache-flex - AIR 应用程序，在表单中设置光标位置

> ID：834990
> 
> 赞同：2
> 
> 时间：2009-05-07T14:31:11.730
> 
> 标签：apache-flex, actionscript-3, air, cursor

我有一个带有登录表单的 AIR 应用程序。我想要做的是在第一个文本输入框中设置光标。我只设法将焦点设置在框上，而不是光标上。

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T18:19:06.783

要将*文本*光标移动到 TextField，您只需将[舞台的 focus 属性](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/Stage.html#focus)设置为该字段。

`stage.focus = myTextField;`

要将光标移动到该 TextField 中的特定索引，请使用[setSelection()](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/text/TextField.html#setSelection())：

```
myTextField.setSelection(54, 70); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:46:03.380

据我所知，没有办法在动作脚本（flash）中控制鼠标，mouseX / mouseY 属性是只读的。

但是，您可以创建一个可以在 AIR 应用程序中移动的“假鼠标”，但我怀疑这是您想要做的事情，例如： [http ://www.senocular.com/demo/VirtualMouse/VirtualMouse.html](http://www.senocular.com/demo/VirtualMouse/VirtualMouse.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-21T12:41:24.550

我可以建议在将焦点设置为文本输入之前设置**活动本机窗口。**像这样的东西：

```
private function creationCompleteHandler(event:FlexEvent):void {
    stage.nativeWindow.activate();
    loginName.setFocus();
    loginName.selectAll();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-01T23:28:46.157

您需要等待 flex 容器在显示列表中注册，然后才能访问舞台。

从您的 creationComplete 处理程序中调用 init：

```
<mx:Script>
    <![CDATA[
        import flash.events.Event;

        private function init():void 
        {
            addEventListener(Event.ADDED_TO_STAGE, initScreen, false);

        }

        private function initScreen(e:Event):void 
        {
            removeEventListener(Event.ADDED_TO_STAGE, initScreen);
            stage.focus = userName;
        }

    ]]>
</mx:Script>

<mx:Form defaultButton="{enterBtn}">

    <mx:FormHeading label="Form" />
    <mx:FormItem label="Username" tabIndex="1">
        <mx:TextInput id="userName" text="" selectionBeginIndex="0" />
    </mx:FormItem>
    <mx:FormItem label="Password" tabIndex="2">
        <mx:TextInput displayAsPassword="true" id="password"/>
    </mx:FormItem>

</mx:Form> 
```

# dos - DOS：不包括文件类型的目录列表？

> ID：834991
> 
> 赞同：6
> 
> 时间：2009-05-07T14:31:39.577
> 
> 标签：dos

在 MS-DOS 中，如果我输入`dir *.pdf`，我会得到一个目录中的所有 PDF 文件。有没有办法获取*除*PDF 文件之外的所有内容？像`dir !*.pdf`什么？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-07T14:38:53.430

我认为 findstr 有一个 /v 选项，它等效于 grep -v （包括所有*不*包含文本的行。所以我会看：

```
dir | findstr /vi ".pdf" 
```

语法可能略有不同，我没有太多需要使用它，而且我不在当前位置运行 Windows。

使用 findstr /? 从命令提示符获取详细信息。

或者，如果你安装了 CygWin（我为这类东西选择的工具），你可以只使用 grep 本身：

```
ls -al | grep -vi '\.pdf$' 
```

**附录：**

我实际上没有意识到这一点，但显然 findstr 也支持正则表达式，因此您可以使用：

```
dir | findstr /vi "\.pdf$" 
```

和 grep 一样（我没有测试过，我只是在[TechNet](http://technet.microsoft.com/en-us/library/bb490907.aspx)上找到的，所以你需要自己测试一下）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T14:39:30.353

您可以将 dir 与 findstr 结合起来，几乎可以做您想做的事情：

```
dir * | findstr /vi .pdf 
```

但请注意，如果文件名为 my.pdf.converted.txt，则会在此处错误地丢弃。

如果您真的想花哨，这里有一个完全正确的版本，更适合批处理脚本：

```
for /f %a in ('dir /b *') do @if "%~xa" neq ".txt" echo %a 
```

无论您尝试什么，祝您好运 :) DOS 很“有趣”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T15:01:59.300

我知道它已经为您工作了，但是您可以像这样使用大多数版本的 DOS（至少我记得的那些）来做到这一点。

属性 *.bad +H
dir /oE
属性 *.bad -H

这会影响隐藏您不想显示的内容，执行目录然后取消隐藏它们。我必须承认它有点讨厌，但它似乎确实起到了作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T17:31:25.143

在 MS-DOS 或 CMD 中，您只需键入以避免 pdf 文件：

```
dir | find/V ".pdf" 
```

但请记住，输出底部的文件数将包括 pdf 文件。

此外，您还可以将此命令用于其他扩展名，方法是将“.pdf”替换为“.xxx”，其中 xxx 是任何扩展名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-17T07:53:29.470

这是一种不使用 findstr/find 或管道到另一个命令的简单方法：

```
for %%a in (*) do (
    if not exist %%~Na.pdf   echo %%a
) 
```

基本上 for 循环将遍历所有文件。“如果不存在”将确保不打印 *.pdf 文件

%%~Na 表示使用不带扩展名的 %%a 变量的文件名。

# jquery - 使用 jQuery 绑定动态添加的表单以提交事件

> ID：834998
> 
> 赞同：0
> 
> 时间：2009-05-07T14:32:43.897
> 
> 标签：jquery, binding, form-submit

当您在 jQuery 中使用相同的表单 ID 动态创建多个表单时，处理提交事件的最佳方法是什么？

到目前为止，这一行使 jQuery 只处理第一个表单。

```
$("form#noteform").submit(function(){
  // do stuff
}); 
```

有点令人困惑，因为我确实需要捕获特定表单的提交才能获得正确的帖子值，因此表单的选择器必须是唯一的。

如何让它监听所有提交，然后确定它是否是启动提交的正确表单 ID？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T14:40:05.530

使用 ID 没有最好的方法来做到这一点，因为具有相同 ID 的多个元素是无效的 HTML。

我建议您的表单具有唯一 ID，但共享一个类名。如果您随后需要获取第一个，则可以直接使用 ID 或使用类和 jquery :first 选择器。

```
$('form.className:first').submit(function(){
  stuff();
}); 
```

-edit- 试图实际解决识别已提交哪个表单的问题。同样，此解决方案依赖于唯一表单 ID

```
$('form.className').submit(function(){
  switch( $(this).attr('id') ){
    case 'form1id':
      submitForm1();
      break;
    case 'form2id':
      submitForm2();
      break;
    default:
      stuff()
      break;
  }      
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T18:14:02.693

如果你使用动态添加的表单，你应该使用`live`jQuery 中的函数：

```
 $('.submit').live('click', function(e) { 
```

代替

```
 $('.submit').click(function(e) { 
```

`submit`即使动态添加新按钮，这也会将单击回调绑定到具有该类的按钮。

PS 很抱歉打扰您，但是您在自己的问题的新答案中添加的说明应该附加到原始问题中，而不是作为答案添加。从技术上讲，它们*不是*答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T17:55:34.923

我已经完全修改了我的答案......它更干净，更简单，并且它也适用于动态添加的表单！;-P

```
<script language="javascript">
$(function() {
    $('form').live('specialSubmit',function() {
        // do stuff... the form = $(this)
        alert($(this).serialize()); // to prove it's working...
    });
    bind_same_id_forms('noteform');
});
function bind_same_id_forms(id) {
    $('form').die().live('keypress',function(ev) { 
        if(ev.keyCode == 13 && $(this).attr('id') == id) {
            $(this).trigger('specialSubmit');
            return false;
        }
    }).children(':submit,:image').die().live('click',function(ev) {
        if($(this).attr('id') == id) {
            $(this).trigger('specialSubmit'); 
            return false;
        }
    });
}
</script> 
```

**示例 HTML：**

```
<form id="noteform" action="question/save/1234" method="post">
   <input type="text" name="question" />
   <input type="text" name="answer" />
   <input type="submit"value="Save" />
</form>
<!-- more forms -->
<form id="noteform" action="question/save/4321" method="post">
   <input type="text" name="question" />
   <input type="text" name="answer" />
   <input type="submit" value="Save" />
</form> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T15:15:25.557

我实际上正在考虑的最后一个选项，因为我已经在其他地方使用过该代码

如果这真的有效，那就太好了

也检查表格是否有效，我可以改用 off

```
if (!isValid(form))  

if form.id="tbnoteform" then
submit the form 
```

我仍然试图摆脱这个问题

每次使用选择器语句创建对象实例后，您可以使用关键字 this 吗？所以表单现在是表单之外的对象实例？

理查德

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T14:56:07.897

我看到了这个`submit`事件的一些问题。我建议将您的事件附加到表单的按钮单击事件中。如果可能，我还必须建议您不要在 html 中使用相同的 id。这通常是不好的做法。

例如：

使用以下html：

```
<form id="questionForm" action="question/save/1234" method="post">>
   <input type="text" id="question1" />
   <input type="text" id="answer1" />
   <input type="submit" id="saveQuestion1" class="submit" value="Save" />
</form>
<!-- more forms -->
<form id="questionForm" action="question/save/4321" method="post">
   <input type="text" id="question2" />
   <input type="text" id="answer2" />
   <input type="submit" id="saveQuestion2" class="submit" value="Save" />
</form> 
```

你可以改用这个：

```
$(document).ready(function() {
  $('.submit').click(function(e) {
    // load the form with closest (jQuery v1.3+)
    var form = $(this).closest('form');
    // check form
    if (!isValid(form))
    {
      e.preventDefault();
    }
    // or if you make the buttons of type button and not submit
    if (isValid(form))
    {
      form.submit();
    }
  });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T16:32:51.690

我想我遇到了一些语法问题

我在这里有完整的代码

按钮是图像类型

```
$(document).ready(function(){
    timestamp = 0;
    $('.delete').click(function(e) {   
          // load the form with closest (jQuery v1.3+)    
         var form = $(this).closest('form');    // check form   
         if (!form.attr('id')="noteform")    {     
             e.preventDefault();    
         }    

          // or if you make the buttons of type button and not submit    
         if (form.attr('id')="noteform")   {     
        form.submit(function(){ 

        $(this).parents(".pane").animate({ opacity: 'hide' }, "slow");
        $.post("tbnotes.php",{
             noteid: $("#frmnoteid").val(),
             action: "delete",
             time: timestamp

        }, function(xml) {
            addMessages(xml);
            });
        return false;
              });                  

        } // end off IF(form.attr('id')="noteform") 
```

}); //结束 $('.delete).click(function(e) {

```
 //select all the a tag with name equal to modal   
    $('a[name=modal]').click(function(e) {   
        //Cancel the link behavior   
        e.preventDefault(); 
        // make a new note  
        newnote(); 

    }); 
```

}); //结束文档准备

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T17:57:45.667

我修改了创建新笔记的代码示例

这也将提交事件附加到加载事件的回调函数中新添加的表单。

这是向前迈出的一步，因为出于某种原因，其他示例没有完成这项工作。

我不知道这样做有什么缺点，但是！我愿意就这个问题发表任何评论如果你想看[例子](http://www.woonbel.nl/testpagina2.php)

目的&注释： newnote 函数有两个参数

-: 索引 = 页面上已经存在的音符数量

-: tbnoteid = 来自数据库的 noteid

该索引也应该像显示消息的计数器一样。

例如，如果计数器超过 10，则应该从页面和数据库中删除标准上的消息，因为最后一个是第一个输出（具有最旧时间戳的消息）（逻辑也稍后添加）

允许表单执行的唯一操作是从数据库中删除消息并从页面中删除自身（容器 div）。出于静态目的，它首先淡出。

该函数可以接受更多参数，例如消息本身。当用户进入页面时，应该从另一个函数调用 newnote 函数，该函数从数据库中提取消息（如果有的话）。

该链接也生成一个新的注释将被其他形式的操作取代，例如[这个例子](http://www.queness.com/resources/html/modal/jquery-modal-window.html)

```
$(document).ready(function(){
 $('a[name=modal]').click(function(e) {  //the selector is for testing purpose 
        //Cancel the link behavior   
        e.preventDefault();   
       var $aantal = $("div.pane").size()
    newnote($number+1,1); // second argument is supposed too come from the database

    }); 

    function newnote(index,tbnoteid) {

    $("div.wrapper:last").after('<div class="wrapper"></div>'); 
    $('.wrapper:last').load('tbnote.html .pane', function() { 
    $(".pane:last").prepend("testmessage");  //testpurpose
    $('.pane:last #frmnoteid').val(tbnoteid);

    $(this,".frm" ).attr('id' , index);
    var $id = $(this).attr('id'); ");  //testpurpose
    $('.frm:last').submit(function(){ 
        $.post("tbnotes.php",{
        noteid: $("#frmnoteid").val(),
        actie: "verwijder",
        tijd: timestamp}, function(xml) {
        addMessages(xml);
        });

     alert("Hello mijn id = " + $id );"); //testpurpose 
    $(this).parents(".pane").animate({ opacity: 'hide' }, "slow");
    $(this).parents(".wrapper").remove();
    return false;

            });
        });

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T13:30:18.833

> 当您在 jQuery 中使用相同的表单 ID 动态创建多个表单时，处理提交事件的最佳方法是什么？

如果 id 是 'noteform'，则选择具有该 id 的所有表单：

```
jQuery('form[id="noteform"]') 
```

**注意**：让多个 HTML 元素（包括表单）具有非唯一 id 可能不是最好的主意。

> 你怎么能让它听所有的提交？

您可以在其事件上绑定事件：

```
jQuery('form[id="noteform"]').submit(function(e){}); 
```

> 然后确定，如果是正确的表单 id 启动了提交？

虽然通过使用选择器，可以保证（在我看来）具有正确 id 的表单，但您可以使用**此**对象在提交事件中检查表单的 id，例如：

```
jQuery('form[id="noteform"]').submit(function(e){
  if(this.id=='noteform') {/* do interesting stuffs */}

  // use .index function to determine the form index from the jQuery array.
  alert('index='+jQuery('form[id="noteform"]').index(this));
}); 
```

如果您对我用来测试它们的 POC 代码片段（解决方案）感兴趣，这里是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled 1</title>

<script type="text/javascript" src="jquery-1.3.2.js"></script>

</head>

<body>

<form id="noteform"><div>
<input type="submit" value="submit" />
</div></form>

<form id="noteform"><div>
<input type="submit" value="submit" />
</div></form>

<form id="noteform"><div>
<input type="submit" value="submit" />
</div></form>

<script type="text/javascript">
/* <![CDATA[ */

// test for selection
jQuery('form[id="noteform"]').each(function(i){
  alert('noteform #' + i); //
});

// test for submission
jQuery('form[id="noteform"]').submit(function(e){
  if(this.id=='noteform'){
    alert('index='+jQuery('form[id="noteform"]').index(this));
    return false; // cancel submission
  }
});

/* ]]> */
</script>

</body>

</html> 
```

谢谢。

# flash - YouTube api 音频不会停止播放

> ID：834999
> 
> 赞同：0
> 
> 时间：2009-05-07T14:32:55.097
> 
> 标签：flash, audio, actionscript-2, youtube-api

好的，我已经构建了一个使用 youtube API 的应用程序。当用户单击按钮时，它将视频加载到应用程序中。如果用户单击另一个按钮，则会在其位置加载一个新视频。你可以在这里看到它：http: [//www.grantanderson.net/blogFiles/honours/youtube.html](http://www.grantanderson.net/blogFiles/honours/youtube.html)

一切正常，除了上一个视频中的音频没有停止。

我用

```
ytplayer.stopVideo();

ytplayer.clearVideo(); 
```

我尝试在此结束时添加

```
ytplayer.destroy(); 
```

但它并没有解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T17:32:00.593

使用 AS2，您经常会遇到内存问题。不幸的是，这通常是不可避免的。好消息是有办法解决这个问题。

```
ytplayer.swapDepths( 1000 );
delete ytplayer;

createEmptyMovieClip( "whoCares", 1000 );
delete whoCares; 
```

这有点……矫枉过正，但这会完全破坏任何显示对象。******************