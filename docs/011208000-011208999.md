# StackOverflow 问答 11208000-11208999

# android - 无法播放视频，安卓

> ID：11208000
> 
> 赞同：1
> 
> 时间：2012-06-26T13:08:35.847
> 
> 标签：android, media, mp4, android-videoview

我使用了 30fps 的 400x760 分辨率的 mp4 视频，并使用 VideoView 和 MediaController 将其集成到应用程序中

```
 MediaController mediac;
 VideoView video1;
 mediac = new MediaController(this);
 mediac.setAnchorView(video1);
 video1 = (VideoView) findViewById(R.id.videoView1);
 video1.setMediaController(mediac);
 video1.setVideoPath("android.resource://video.test/raw/vid"); 
```

它在我的 ZTE Blade 上播放良好，但在 Evo、GS2 和 Galaxy S 上，它说很糟糕，无法播放此视频

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:26:49.740

尝试

```
video_view.setVideoURI(Uri.parse(path)); 
```

有时直接作为字符串路径传递在某些设备上不起作用。对我来说工作正常的代码：

```
path = Environment.getExternalStorageDirectory() + "/file_name";

// Add controls to a MediaPlayer like play, pause.
MediaController mc = new MediaController(this);
video_view.setMediaController(mc);

// Set the path of Video or URI.
video_view.setVideoURI(Uri.parse(path));

// Set the focus.
video_view.requestFocus();

video_view.start(); 
```

# android - 添加背景图片后，Android App 无法启动

> ID：11208004
> 
> 赞同：0
> 
> 时间：2012-06-26T13:08:48.527
> 
> 标签：android, layout, launch, android-image

向我的应用程序添加两个背景图像后，它将不再在模拟器中启动。它进入了上传部分，然后就坐在那里，我已经离开了 30 分钟，通常是 30 秒的上传和开始。背景图像被添加到主要的可见布局页面。

图像分别约为 600k 和 900k。我将它们复制到所有 4 个可绘制文件夹中。

任何人都知道我做错了什么或如何解决它？没有报告错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:30:11.370

对于初学者，您不需要将它们放在所有四个文件夹中。只需将一个放入可绘制的 HD 文件夹中

# asp.net - XML 轴属性不支持后期绑定

> ID：11208008
> 
> 赞同：0
> 
> 时间：2012-06-26T13:08:58.087
> 
> 标签：asp.net, xml, vb.net, visual-studio-2010, linq-to-xml

我在这个函数和许多类似的函数中遇到了 XML 的问题。

错误

XML 轴属性不支持后期绑定。

命名空间

```
Imports Microsoft.VisualBasic
Imports System.Web
Imports System.IO
Imports System.Xml.Linq 
```

功能

```
Public Shared Function get_intro(ByVal root_folder As String) As String
    Dim content As String = ""
    Dim docXML = XDocument.Load(root_folder & print_shop_doc)
    Dim intro_doc = From doc In docXML...<d:printshopdoc> _
            Select New With {.intro = doc.<d:intro>.Value}
    content = "<p" & no_indent & ">" & intro_doc(0).intro & "</p>" & vbCrLf
    Return content
End Function

docXML...<d:printshopdoc> 
```

似乎是发生错误的地方，我不太确定如何修复它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:29:07.657

放置 XML 命名空间声明`Imports <xmlns:d="http://example.com/">`（而不是`http://example.com/`放置输入 XML 中使用的命名空间 URI）是否可以解决问题？

# vb.net - 使用 cmd.exe 打开 shell 后如何运行 msg.exe

> ID：11208012
> 
> 赞同：1
> 
> 时间：2012-06-26T13:09:15.617
> 
> 标签：vb.net

我想使用 VB.NET 代码通过 Windows 7 LAN 发送消息。问题是 msg.exe 仅在管理员模式下执行命令。这是代码。

Shell("cmd.exe /k runas /user:farook-pc\administrator msg.exe") '这里提示我输入密码。

Shell("cmd.exe /k msg.exe", 1)

我使用 /k 开关来查看 shell 中发生了什么。/c 是静音开关。我不希望使用 runas 也不希望更改 msg.exe 中的权限

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:41:07.543

我讨厌启动其他应用程序并试图像那样控制它们。如果可能的话，我建议您自己尝试以编程方式模仿 msg.exe 的功能。通过一些快速的谷歌搜索，我发现 msg.exe 使用的 API 函数显然`WTSSendMessage`在 Wtsapi32.dll 中。这是有关该功能的 MSDN 文章：

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa383842(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383842(v=vs.85).aspx)

这是一个链接，显示了如何从 .NET 调用该 API 函数：

[http://www.pinvoke.net/default.aspx/wtsapi32/wtssendmessage.html](http://www.pinvoke.net/default.aspx/wtsapi32/wtssendmessage.html)

我以前从未使用过它，甚至以前从未听说过它，所以很遗憾，除此之外我无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:41:31.973

可以在管理员模式下自动启动 VB.NET 应用程序。这可以在项目设置中更改。

之后，您可以使用以下命令打开 msg.exe：

外壳（“msg.exe”）

# android - asynctask.cancel(true/false) 返回 false，如何 100% 避免 onPostExecute() 被调用？

> ID：11208018
> 
> 赞同：2
> 
> 时间：2012-06-26T13:09:34.803
> 
> 标签：android, android-asynctask

我的目标是避免调用 AsyncTask 的 onPostExecute()。cancel() 帮不了我，因为它在 100% 的情况下都不起作用：有时 cancel() 返回 false，然后调用任务的 onPostExecute()。如何防止这种情况？我在我的类中创建了布尔标志并将其设置为 true 而不是调用 cancel()，但这并不是一个好的解决方案：

```
public class GetIcons extends AsyncTask<Void, Void, HashMap<String, Bitmap>>
{
  public boolean skipPostExecute = false;

  @Override
  protected HashMap<String, Bitmap> doInBackground(Void... arg0)
  {
    // do something (getting icons from webserver)
  }

  @Override
  protected void onPostExecute(HashMap<String, Bitmap> result)
  {
    super.onPostExecute(result);
    if (!skipPostExecute)
    {
       // do something
    }
  } 
```

}

有没有更好的方法来做同样的事情？

# jquery - jQuery 根据选择框选项添加 css 类

> ID：11208021
> 
> 赞同：1
> 
> 时间：2012-06-26T13:09:36.840
> 
> 标签：jquery, css, class, element, drop-down-menu

我有 3 个下拉列表，我想根据下拉列表的值将类添加到特定的 div。

```
<select name="item1">
    <option>Blue</option>
    <option>Green</option>
    <option>Red</option>
</select>

<select name="item2">
    <option>Blue</option>
    <option>Green</option>
    <option>Red</option>
</select>

<select name="item3">
    <option>Blue</option>
    <option>Green</option>
    <option>Red</option>
</select>

<div class="product">
    <div class="item1"></div>
    <div class="item2"></div>
    <div class="item3"></div>
</div> 
```

我正在尝试根据下拉列表的值添加一个 CSS 类。例如，如果从下拉**item1中选择了****blue**选项，我想在 div **item1中添加一个****.blue**类。

 ******我曾经有复选框而不是下拉菜单，我有这个代码：

```
$(document).ready(function($){
    $('input#red').change(function(){
        if($(this).is(":checked")) {
            $('div.item1').addClass("red");
        } else {
            $('div.item1').removeClass("red");
        }
    });
    $('input#blue').change(function(){
        if($(this).is(":checked")) {
            $('div.item1').addClass("blue");
        } else {
            $('div.item1').removeClass("blue");
        }
    });
}); 
```

我创建了这个：http: [//jsfiddle.net/uJcB7/14/](http://jsfiddle.net/uJcB7/14/) 应该如何正确完成？

- - - - - - 编辑 - - - - - -

我正在使用重力形式生成选择框，它们在选项名称后添加“|0”（我不知道为什么！）。

例如“green|0”而不是“green”。“|0”隐藏在字段中，但生成的类是“green|0”。

关于如何删除 css 类上的“|0”的任何想法？

他们还为选择框生成一个名称，是否可以使用类而不是使用名称元素？

查看更新后的代码：

[http://jsfiddle.net/uJcB7/24/](http://jsfiddle.net/uJcB7/24/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:17:43.307

添加类的类与要更改的元素的属性`<div>`相同，要添加的类的名称是所选选项值的小写版本。考虑到这一点，这有效：`name``<select>`

```
$(document).ready(function($){
    $('select').change(function(){
        $('.' + this.name).attr('class', this.name + ' ' + this.value.toLowerCase());
    });
}); 
```

[**jsFiddle 演示**](http://jsfiddle.net/uJcB7/20/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:17:38.677

这是一个通用函数，它将所选选项的文本值添加到适当的 div：

```
$(document).ready(function($){

  $('select').change(function(){
    var s = $(this);
    var name = s.attr('name');
     $('.'+name).removeClass().addClass(name+' '+s.find(':selected').text().toLowerCase());
  });
});​ 
```

演示：http: [//jsfiddle.net/jackwanders/xcEa9/4/](http://jsfiddle.net/jackwanders/xcEa9/4/)

更一般地说，您可以使用 $.map 来获取选择菜单值的列表，以便您知道在每个更改事件上要删除哪些类名：

```
$('select').change(function(){
    var $this = $(this);
    var values = $.map($this.find('option'),function(opt){ return opt.value.toLowerCase(); }).join(' ');
    $('.'+this.name).removeClass(values).addClass($(this).val().toLowerCase());
}); 
```

演示：http: [//jsfiddle.net/jackwanders/xcEa9/5/](http://jsfiddle.net/jackwanders/xcEa9/5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:38:03.030

```
$(function() {
  $('select').bind('change', function() {
    var $this = $(this);
    $this.find('option:not(:selected)').each(function(index, option) {
      $this.removeClass($(option).text());
    });
    $this.addClass($this.find('option:selected').text());
  });        
}); 
```

[更新了 JSFiddle](http://jsfiddle.net/uJcB7/17/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:17:57.393

```
$(document).ready(function() {

  $('#item1').change(function() {
    $('.item1').addClass($('#item1').val());
  });

  $('#item2').change(function() {
    $('.item2').addClass($('#item2').val());
  });

  $('#item3').change(function() {
    $('.item3').addClass($('#item3').val());
  });

}); 
```

如果愿意，您还可以将各个段保留在 for 循环中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T13:20:31.190

这将适用于您的所有`select`元素。

## *[jsFiddle 演示](http://jsfiddle.net/roXon/ZnFjq/2/)*

```
$('select[name^=item]').change(function(){
    var val = $(this).val();
    $('div.'+$(this).attr('name')).removeClass('red blue green').addClass(val);
}); 
```

`select[name^=item]`搜索名称以开头的选择元素`item`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-26T14:03:33.350

这将清除类中先前设置的颜色值（如果有）并设置新的颜色值。

```
$(document).ready(function($){
    $('select').change(function(){
        name = $(this).attr('name');
        curClass = $('div.'+name).attr('class');
        $('div.'+name).removeClass(curClass).addClass(name + ' ' +$(this).val());
    });
}); 
```

小提琴 **[在这里](http://jsfiddle.net/supermykel/Cq7LY/)********

# xml - VB.NET 服务器协议冲突“Section=ResponseStatusLine”使用 XML

> ID：11208023
> 
> 赞同：0
> 
> 时间：2012-06-26T13:09:41.653
> 
> 标签：xml, vb.net, stream, xmlhttprequest, system.net.webexception

我正在尝试将 XML 片段发送到我的本地主机服务器。我已经能够成功连接并且（我认为）成功发送了代码段。但是，当我运行我的程序时，我得到一个未处理的 WebException。异常详情全文如下：

```
System.Net.WebException was unhandled
Message=The server committed a protocol violation. Section=ResponseStatusLine
Source=System
StackTrace:
   at System.Net.HttpWebRequest.GetResponse()
   at Automation_Algorithm.AutomationForm.cmdStart_Click(Object sender, EventArgs e) in C:\Users\ConzM\documents\visual studio 2010\Projects\Automation Algorithm\Automation Algorithm\AutomationForm.vb:line 29
   at System.Windows.Forms.Control.OnClick(EventArgs e)
   at System.Windows.Forms.Button.OnClick(EventArgs e)
   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
   at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.ButtonBase.WndProc(Message& m)
   at System.Windows.Forms.Button.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
   at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
   at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)
   at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
   at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
   at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OnRun()
   at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoApplicationModel()
   at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run(String[] commandLine)
   at Automation_Algorithm.My.MyApplication.Main(String[] Args) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 81 
```

我的代码（从第 11 行开始）：

```
Private Sub cmdStart_Click(sender As System.Object, e As System.EventArgs) Handles cmdStart.Click
    Dim requestNF As WebRequest = WebRequest.Create("http://127.0.0.1:4096")
    requestNF.Method = "POST"
    Dim datastring As String
    Dim getdata =
        <?xml version='1.0' encoding='ISO-8859-1'?>
        <MLCommandSet>
            <info/>
        </MLCommandSet>                                                                     '/
    datastring = "<?xml version='1.0' encoding='ISO-8859-1'?>" & vbNewLine & getdata.ToString()
    Dim byteArray As Byte() = Encoding.UTF8.GetBytes(datastring)
    requestNF.ContentLength = byteArray.Length
    requestNF.ContentType = "text/xml"
    Dim dataStream As Stream = requestNF.GetRequestStream()
    dataStream.Write(byteArray, 0, byteArray.Length)
    txtXMLOutFF.AppendText(getdata.ToString & vbNewLine)
    dataStream.Close()

    Dim responseNF As Object = requestNF.GetResponse.GetResponseStream  '<---breaks here'
    Console.WriteLine(CType(responseNF, HttpWebResponse).StatusDescription.ToString)
    txtXMLInFF.Text = CType(responseNF, HttpWebResponse).StatusDescription.ToString
    dataStream = responseNF.GetResponseStream
    Dim readerNF As New StreamReader(dataStream)
    Dim responseFromServerNF As String = readerNF.ReadToEnd
    Console.WriteLine(responseFromServerNF)
    txtXMLInFF.AppendText(responseFromServerNF.ToString & vbNewLine)
    readerNF.Close()
    dataStream.Close()
    responseNF.Close()
End Sub 
```

有人可以为我解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T09:11:26.120

虽然我还没有实现与应用程序通信的预期目标，但我确实发现问题在于通信是通过原始 TCP/IP 消息进行的，而不是我假设的 XML 或 HTTP 请求。因此，当您收到“服务器协议违规：部分：ResponseStatusLine”错误时，我想出了一个故障排除清单：

1.  将以下代码添加到您的 app.config 文件中：（它允许传递不正确的标头）

    ```
    <system.net>
        <settings>
            <httpWebRequest useUnsafeHeaderParsing = "true"/>
        </settings>
    </system.net> 
    ```

2.  如果清理和重建后这不起作用，那么您连接的服务器可能没有发送 WebRequest 数据。为了测试这一点，我使用了 Telnet 客户端。
3.  要使用 Telnet 测试数据，请下载并打开 Telnet 客户端（Windows，我建议[PuTTYtel](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)、Unix 和其他通常只需启动他们的终端/命令提示符并键入`telnet`即可激活）。

    a) 在相应字段 (Windows) 中输入您尝试连接的服务器和端口号，或者输入`telnet -o servername:portnumber`终端并按 Enter。（Unix/Linux 风格）

    b) 当窗口出现时，尝试输入您的原始查询，仔细记下任何空格或换行规范。就我而言，我输入：

    ```
    <?xml version='1.0' encoding='ISO-8859-1'?>
    <MLCommandSet>
        <info/>
    </MLCommandSet> 
    ```

    并按下回车键。当我这样做时，我立即看到了我正在寻找的应用程序的输出。:D
    但是，如果这不起作用，请在其他地方寻找解决方案，因为我无法再为您提供帮助。

希望这可以帮助！

# c++ - CComPtr 替换 gcc？

> ID：11208028
> 
> 赞同：2
> 
> 时间：2012-06-26T13:10:07.673
> 
> 标签：c++, com, smart-pointers

我正在做一些 COM 编程，我的编译器是 gcc。这意味着 CComPtr 对我不可用。如何使用 Boost 轻松实现替换？我需要的语义是：

*   `AddRef`复制时调用

*   `Release`破坏时调用

*   额外：能够判断它指向的对象是否仍然有效（不确定这是否可能）

我认为可以使用`shared_ptr`自定义删除器，但我对这些功能不是很熟悉（我也不知道如何让它调用`AddRef`和`Release`）。我知道我可以手工制作这个类，但我很确定这个功能在 Boost 中以通用形式提供。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:18:40.147

查看 HILO 项目，它推出了自己的 CComPtr 实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:48:02.003

我不确定所需函数的语义是什么`AddRef`，`Release`但是：

您可以使用`boost::intrusive_ptr`并拥有两个免费函数`intrusive_ptr_add_ref`，`intrusive_ptr_release`它们将被调用以增加/减少引用计数器。然后可能会在您的对象上调用这些`AddRef`和`Release`函数。当计数器到达时，您必须自己处理删除`0`。

# automated-tests - 如何确定 BizTalk 已完成对消息的处理

> ID：11208029
> 
> 赞同：2
> 
> 时间：2012-06-26T13:10:12.287
> 
> 标签：automated-tests, biztalk

我们正在为 BizTalk 应用程序编写自动化系统测试，但在确定何时可以执行测试验证时遇到问题。在验证之前，我们需要确保 BizTalk 已经完全处理了消息，或者消息处理已经超时。

```
[Test]
public void ReceiveValidTaskMessageTestShouldBeLoggedInMessageLog()
{
    // Exercise            
    MsmqHelpers.SendMessage(InboundQueueName, ValidMessage);

    // Verify
    Assert.That(() => GetMessageCount("ReceiveError"), Is.EqualTo(0).After(1000));
    Assert.That(() => GetMessageCount("Receive"), Is.EqualTo(1).After(1000));
} 
```

最后两行检查 sql server 的表中是否存在消息副本，一张表表示成功消息，一张表表示错误。

这里的问题是，在发送消息后，我们立即验证错误表中没有放置任何消息。但是，如果 BizTalk 尚未处理该消息，那么即使它应该失败，该断言也会通过。

我们需要的是这样的：

```
[Test]
public void ReceiveValidTaskMessageTestShouldBeLoggedInMessageLog()
{
    // Exercise            
    MsmqHelpers.SendMessage(InboundQueueName, ValidMessage);

    // Verify
    Assert.That(() => PendingMessages, Is.EqualTo(0).After(1000));
    Assert.That(() => GetMessageCount("ReceiveError"), Is.EqualTo(0));
    Assert.That(() => GetMessageCount("Receive"), Is.EqualTo(1));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:52:27.843

这就是自动化集成测试的问题所在。

这样的测试是*基于证据的*，这反映在你的测试断言中；您正在通过检查数据库来寻找已进行处理的证据。

同样，为了知道处理已经完成，您正在寻找一些证据证明这已经发生。例如，理论上您可以对 BizTalk 消息框数据库运行查询以检查其中的状态。

但是，BizTalk 不适合这种探测，因为它在构建时没有考虑到测试（它的弱点之一）。我当然不知道该怎么做。

几个值得考虑的方法：

1.  在执行数据库检查之前等待“合理”的时间，以允许 BizTalk 完成对消息的处理。
2.  让 BizTalk 在处理完成之前输出一个日志文件（或其他一些证据），您可以在检查数据库之前对其进行检查。

即使方法有限，自动化集成测试也非常有价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T09:09:58.457

更好的方法是在记录出现在这些表中的任何一个时通知并酌情通过/未通过测试。您可以使用基本的无限循环来连续轮询表，或者更优雅的解决方案是使用事件 - 有关更多详细信息，请参阅[事件处理程序委托](http://msdn.microsoft.com/en-us/library/system.eventhandler.aspx)。

# java - 在 StringBuilder 中包含换行符

> ID：11208031
> 
> 赞同：1
> 
> 时间：2012-06-26T13:10:15.057
> 
> 标签：java, swing, newline, jlabel, stringbuilder

我在尝试让 Stringbuilder 中包含的换行符出现在 JLabel 中时遇到问题。

我发现这里解决了几个类似的问题，例如 [这里] [Problems to linebreak with an int in JLabel](https://stackoverflow.com/questions/8325337/problems-to-linebreak-with-an-int-in-jlabel)和 [这里][如何为除最后一行之外的所有行添加换行符？](https://stackoverflow.com/questions/448320/how-do-i-append-a-newline-character-for-all-lines-except-the-last-one)，以及其他一些人，但他们似乎都不适合我。

打印到 System.out 时，它工作正常，每次我都会得到一个新行，但是当传递给 JLabel 时，所有内容都显示为一行。

这是代码的当前版本，它试图附加一个换行符，并在主声明中包含一个。传递给 JLabel 时两者都没有任何效果：

```
public void layoutCenter() {
    JPanel central = new JPanel();
    add(central, BorderLayout.CENTER);

    JTabbedPane tabs = new JTabbedPane();
    this.add(tabs);

    // memory tab
    StringBuilder mList = new StringBuilder();
    memLocList = new Memory[MEM_LOCATIONS]; //Memory is a separate class
    for (int i = 0; i < memLocList.length; i++) {
        mList.append("\n");
        memLocList[i] = null;
        mList.append("Memory location: " + i + " " + memLocList[i] + "\n");
    }
    System.out.println(mList.toString());

    JComponent memTab = makeTextPanel(mList.toString());
    tabs.addTab("Memory", memTab);

}

protected JComponent makeTextPanel(String text) {
    JPanel panel = new JPanel(false);
    JLabel filler = new JLabel(text);
    panel.add(filler);
    return panel;
} 
```

我也尝试过使用 System.getProperty(line.separator) 获得类似的结果，并且想不出其他任何尝试，所以我想在这里寻求帮助。

谢谢，罗伯特。

-编辑-

感谢 mKorbel，将 JLabel 更改为 JTextPane 解决了它。有问题的两行是：

```
JTextPane filler = new JTextPane();
    filler.setText(text); 
```

再次感谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:13:34.683

您将不得不使用 <html> 和 <br> 在 JLabel Swing 组件中获取换行符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:13:52.500

如果您绝对必须使用`JLabel`，那么我建议每行使用一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T13:16:10.050

您可以通过将文本包装在 HTML 标记中并使用 br 标记添加新行来使 JLabel 具有多行。

如果您新闻自动换行，我建议使用 JTexrArea。您可以将其设为不可编辑并设置样式，使其看起来像一个标签。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-26T13:17:30.003

`JLabel`未指定保存多行文档，有两种选择（默认接受换行符或制表符）

*   如果文档无法以某种方式装饰或设置样式，则使用[JTextArea](http://docs.oracle.com/javase/tutorial/uiswing/components/textarea.html)

*   在这种情况下，文档可以以某种方式进行装饰或样式化，然后使用[JEditorPane 或 JTextPane](http://docs.oracle.com/javase/tutorial/uiswing/components/editorpane.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-26T13:27:03.757

你可以看看这个教程： [http ://docs.oracle.com/javase/tutorial/uiswing/components/html.html](http://docs.oracle.com/javase/tutorial/uiswing/components/html.html)

其中一个示例是使用 html 将 JButton 文本设置为两行。它应该非常相似。

# iphone - 推送 UIViewController 时隐藏 UITabBarController 的标签栏

> ID：11208033
> 
> 赞同：0
> 
> 时间：2012-06-26T13:10:32.747
> 
> 标签：iphone, objective-c, ios, uitabbarcontroller, uitabbar

我有一个标签栏应用程序。这是启动代码

```
 self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    // Override point for customization after application launch.
    [self.window makeKeyAndVisible];

    self.tabBarController=[[UITabBarController alloc] init];

    StartViewController *startViewController=[[StartViewController alloc] initWithNibName:@"StartViewController" bundle:nil];
    NavRootViewController *navRootViewController=[[NavRootViewController alloc] initWithNavControllerWithSubViewController:startViewController];

    HelpViewController *helpViewController=[[HelpViewController alloc] initWithNibName:@"HelpViewController" bundle:nil];

    SettingsViewController *settingsViewController=[[SettingsViewController alloc] initWithNibName:@"SettingsViewController" bundle:nil];

    AboutUsViewController *aboutUsViewController=[[AboutUsViewController alloc] initWithNibName:@"AboutUsViewController" bundle:nil];

    [self.tabBarController setViewControllers:[NSArray arrayWithObjects: navRootViewController, helpViewController, settingsViewController, aboutUsViewController, nil]];

    [[UIApplication sharedApplication] setStatusBarHidden:YES];
    self.window.backgroundColor = [UIColor whiteColor];
    self.window.rootViewController=self.tabBarController; 
```

使用 4 个标签栏标签启动的应用程序。在用户按下第一个选项卡的导航控制器的根视图控制器中的开始按钮后调用此操作

```
-(IBAction)startPressed:(id)sender
{
    NSLog(@"startPressed: called");

    RootViewController *vController=[[RootViewController alloc] initWithNibName:@"RootViewController" bundle:nil];
    [self.navigationController pushViewController:vController animated:YES];

} 
```

这工作正常，但我需要隐藏我的`RootViewController` 属性的标签栏`hidesBottomBarWhenPushed`不起作用。请帮帮我，怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T05:36:27.893

我希望这可以帮助你：

```
- (void)viewWillAppear: (BOOL)animated 
{ 
    self.hidesBottomBarWhenPushed = YES; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:24:32.597

如果您不希望主视图显示标签栏，则不应将其推送到导航控制器上。这样做会导致应用程序假定这个新控制器是导航层次结构的一部分。最好的解决方案可能是在 RootViewController 上启动您的应用程序，然后以模态方式呈现导航控制器。完成导航控制器后，让它`dismissModalViewController`自行调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T05:14:33.090

是的，你必须在窗口而不是 tabBar 的 viewcontroller 上添加 modalview。尝试类似.. 制作 AppDelegate 的对象，例如： `AppDelegate *appDelegate=[[UIApplication sharedApplication]delegate];` 然后在下一行添加

```
[appDelegate.window.rootviewcontroller.view presentModalViewController:vController animated:YES]; 
```

或者将您的代码添加`[self presentModalViewController:vController animated:YES]`到 tabBar 的 firstviewcontroller 的 viewDidAppear 中。

你做了什么来解决这个问题？我也想知道。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T13:28:57.510

使用此代码解决：

```
-(IBAction)startPressed:(id)sender
{
    NSLog(@"startPressed: called");

    RootViewController *vController=[[RootViewController alloc] initWithNibName:@"RootViewController" bundle:nil];
    UINavigationController *navController=[[UINavigationController alloc] initWithRootViewController:vController];
    [vController setModalTransitionStyle:UIModalTransitionStyleCrossDissolve];
    [((AppDelegate *)[UIApplication sharedApplication].delegate).tabBarController presentModalViewController:navController animated:YES];
} 
```

感谢@iPhone 开发者

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-07T02:32:58.433

```
UIViewController *nextViewController = [[UIViewController alloc] initWithNibName:@"NextViewController" bundle:[NSBundle mainBundle]];

// hide UITabbarController
nextViewController.hidesBottomBarWhenPushed = YES;

[self.navigationController pushViewController:nextViewController animated:YES];
[nextViewController release]; 
```

# python - 当我尝试通过 Python 远程连接到 selenium 网格时，在 /wd/hub/session 上出现 404

> ID：11208040
> 
> 赞同：8
> 
> 时间：2012-06-26T13:11:04.897
> 
> 标签：python, selenium, selenium-webdriver, selenium-grid

我可以在控制台下看到两个遥控器，但是当我尝试远程连接并执行某些操作时，它会以 404 失败。

```
from selenium import webdriver
browser = webdriver.Remote(
   command_executor='http://ec2-184-72-129-183.compute-1.amazonaws.com:4444/wd/hub',
   desired_capabilities={'browserName': 'firefox'})
browser.get('http://www.google.com')
browser.quit() 
```

抛出此异常

```
Traceback (most recent call last):
  File "browser-shot.py", line 16, in <module>
    desired_capabilities={'browserName': 'firefox'})
  File "/usr/local/lib/python2.6/dist-packages/selenium/webdriver/remote/webdriver.py", line 62, in __init__
    self.start_session(desired_capabilities, browser_profile)
  File "/usr/local/lib/python2.6/dist-packages/selenium/webdriver/remote/webdriver.py", line 104, in start_session
    'desiredCapabilities': desired_capabilities,
  File "/usr/local/lib/python2.6/dist-packages/selenium/webdriver/remote/webdriver.py", line 155, in execute
    self.error_handler.check_response(response)
  File "/usr/local/lib/python2.6/dist-packages/selenium/webdriver/remote/errorhandler.py", line 125, in check_response
    raise exception_class(value)
selenium.common.exceptions.WebDriverException: Message: '<html>\n<head>\n<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>\n<title>Error 404 </title>\n</head>\n<body><h2>HTTP ERROR: 404</h2><pre>NOT_FOUND</pre>\n<p>RequestURI=/wd/hub/session</p><p><i><small><a href="http://jetty.mortbay.org/">Powered by Jetty://</a></small></i></p><br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n<br/>                                                \n\n</body>\n</html>\n' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T18:50:54.857

这似乎不是 python 错误。看起来您拥有 selenium 服务器的机器正在拒绝请求。在错误消息中，您有一个 `<a href="http://jetty.mortbay.org/">Powered by Jetty://</a>` 让我认为它与 Jetty 有某种关系的信息。

我对 Jetty 了解不多，但您可能想在那里寻找答案。一个可能的问题是 Jetty 也在端口 4444 上运行，但我不能肯定地说，因为我不知道 Jetty 是如何工作的。

编辑

我还应该补充一点，我在我的本地机器上尝试了你的设置，到我的一台服务器（上面没有 Jetty），它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T20:59:52.833

尝试使用_运行 selenium hub

```
-port 5555 
```

然后还配置客户端：

```
-port 5555 
```

我认为是另一个使用端口 4444 的软件的问题，或者 selenium 没有在该端口正确启动。

# vba - 设置 outlook.attachment = 邮件附件

> ID：11208049
> 
> 赞同：0
> 
> 时间：2012-06-26T13:11:33.027
> 
> 标签：vba, attachment, mailitem

我正在尝试编写一个将附件保存到目录的脚本。当我运行它时，我收到一条错误消息“类型不匹配”并且该行`Set olAtt = olMi.Attachments` 被突出显示。有人可以建议吗？

```
Sub SaveAttachments()

Dim olApp As Outlook.Application
Dim olNs As Namespace
Dim Fldr As MAPIFolder
Dim MoveToFldr As MAPIFolder
Dim olMi As Outlook.MailItem
Dim olAtt As Outlook.Attachment
Dim MyPath As String
Dim i As Long
Dim j As Long
Dim filesavename As String

Set olApp = New Outlook.Application
Set olNs = olApp.GetNamespace("MAPI")
Set Fldr = olNs.GetDefaultFolder(olFolderInbox)
Set MoveToFldr = Fldr.Folders("Survey")
MyPath = "C:\Users\temp"

For i = (Fldr.Items.Count - 150) To Fldr.Items.Count 

    Set olMi = Fldr.Items(i)
    If InStr(1, olMi.Subject, "Survey") > 0 Then
        j = olMi.Attachments.Count
        Set olAtt = olMi.Attachments
        filesavename = MyPath & olAtt.Filename
        olAtt.SaveAsFile filesavename

        olMi.Save
        olMi.Move MoveToFldr

    End If
Next i

Set olAtt = Nothing
Set olMi = Nothing
Set Fldr = Nothing
Set MoveToFldr = Nothing
Set olNs = Nothing
Set olApp = Nothing

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:13:07.590

`olAtt`被声明为`Outlook.Attachment`（单数）。

`olMi.Attachments`是附件的集合。

# java - GWT 文件上传

> ID：11208051
> 
> 赞同：1
> 
> 时间：2012-06-26T13:11:36.417
> 
> 标签：java, gwt, file-upload

我有以下问题 - 我们正在使用`FormPanel`将文件发送到 Servlet，该 Servlet 接受参数并尝试`XML`从该文件中解析。这工作正常。

问题是当用户上传了错误的文件时，所以解析以`SAXException`我想传播（或异常的消息）到客户端的结尾。我尝试了类似的东西

```
catch (SAXException ex) {
    response.setStatus(HttpServletResponse.SC_UNSUPPORTED_MEDIA_TYPE);
    response.flushBuffer();
} 
```

但它不起作用，我总是得到空标签pre（`<pre></pre>`）。我试图抓住这个

```
formPanel.addSubmitCompleteHandler(new SubmitCompleteHandler() {

    @Override
    public void onSubmitComplete(SubmitCompleteEvent event) {
        String s = event.getResults();
    }); 
```

我可以`response.getWriter().write("Error");`在我的 Servlet 中使用，但是客户端如何知道错误是否真的发生了？使用类似的东西`event.getResults().contains("error")`在我看来并不是一个正确的解决方案。

所以我正在考虑使用`RequestBuilder`，但我看不到如何获取上传的文件并将其推送到我的 servlet。或者也许将我的信息转换为`JSON`会有所帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:10:36.470

您应该参考google gwt 讨论组上的[这个线程。](https://groups.google.com/forum/#!msg/google-web-toolkit/EjhCnRLJv_g/AlI810MsnNUJ)您描述的方式，解析`event.getResults()`以确定是否存在错误或成功的结果是正确的方法，即使它可能看起来很野蛮。

正如链接讨论中所建议的那样，您可以查看[GWT Upload](http://code.google.com/p/gwtupload/)以获得更简洁的代码，以及上传进度信息。我相信从网页上传文件到服务器的唯一两种选择是表单或 Flash。

# python - 使用 matplotlib 的线性回归线给出 ValueError

> ID：11208052
> 
> 赞同：1
> 
> 时间：2012-06-26T13:11:37.540
> 
> 标签：python, numpy, matplotlib

我正在尝试在散点图上绘制线性回归线。我已经对其进行了研究（例如[使用 matplotlib / numpy 进行线性回归](https://stackoverflow.com/questions/6148207/linear-regression-with-matplotlib)），但我的暗示不起作用

```
 x = [-6.0, -5.0, -10.0, -5.0, -8.0, -3.0, -6.0, -8.0, -8.0, 7.5, 8.0, 9.0, 10.0, 7.0, 5.0, 5.0, -8.0, 8.0, 7.0] 
    y = [-7.094043198985176, -6.1018562538660044, -15.511155265492038, -2.7131460277126984, -8.6127363078417609, -3.1575686002528163, -10.246242711042497, -6.4333658386991992, -16.167988119268013, 2.4709555610646134, 4.5492058088492948, 5.5896790992867942, 3.3824425476540005, -1.8140272426684692, -1.5975329456235758, 5.1403915611396904, -4.4469105070935955, 0.51211850576547091, 5.7059436876065952]
    m,b = numpy.polyfit(x,y,1)
    plt.plot(x, y, x, m*x+b) 
    plt.show() 
```

回报：

```
Traceback (most recent call last):
  File "test.py", line 464, in <module>
    correlate(trainingSet,trainingSet.trainingTexts)
  File "test.py", line 434, in correlate
    plt.plot(x, y, x, m*x+b)
  File "C:\Python27\lib\site-packages\matplotlib\pyplot.py", line 2458, in plot
    ret = ax.plot(*args, **kwargs)
  File "C:\Python27\lib\site-packages\matplotlib\axes.py", line 3848, in plot
    for line in self._get_lines(*args, **kwargs):
  File "C:\Python27\lib\site-packages\matplotlib\axes.py", line 323, in _grab_ne
xt_args
    for seg in self._plot_args(remaining, kwargs):
  File "C:\Python27\lib\site-packages\matplotlib\axes.py", line 300, in _plot_ar
gs
    x, y = self._xy_from_xy(x, y)
  File "C:\Python27\lib\site-packages\matplotlib\axes.py", line 240, in _xy_from
_xy
    raise ValueError("x and y must have same first dimension")
ValueError: x and y must have same first dimension 
```

我检查了两者`x`的`y`长度相同，它们是（19）。任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T13:17:40.737

问题是它`x`是一个 python `list`，而不是一个`numpy` `array`，所以`*`不是你期望的那样工作：

```
>>> m * x
[] 
```

这是工作示例

```
plt.plot(x, y, x, numpy.array(x) * m +b) 
```

# iphone - iPhone Objective C - 无法显示新视图

> ID：11208053
> 
> 赞同：1
> 
> 时间：2012-06-26T13:11:43.187
> 
> 标签：iphone, objective-c, ios

我发现很难开始使用 Objective-C。

单击按钮时，我正在执行以下代码：

```
NSLog(@"hi");
MainMenuDriver *mainMenuDriver= [[MainMenuDriver alloc] initWithNibName:nil bundle:nil];
[[self navigationController]pushViewController:mainMenuDriver animated:YES]; 
```

当我按下按钮时，我可以在控制台中看到“hi”，只是视图应该更改为 MainMenuDriver。但是什么也没有发生！

请帮忙！

根据对更多代码的要求：

MainMenuDriver.h：

```
#import <UIKit/UIKit.h>
#import <CoreLocation/CoreLocation.h>

@interface MainMenuDriver : UIViewController <UINavigationControllerDelegate,CLLocationManagerDelegate>{
    IBOutlet UIButton *photos;
    IBOutlet UIButton *profile;

    IBOutlet UISwitch *onOffline;

    IBOutlet UILabel *label1;

    NSTimer *uploadGPS_timer;

    CLLocationManager *lm;
    NSString *lat;
    NSString *lng;
}
@property(nonatomic,retain) UIButton *photos;
@property(nonatomic,retain) UIButton *profile;
@property(nonatomic,retain) UISwitch *onOffline;
@property(nonatomic,retain) UILabel *label1;
@property (nonatomic,retain) NSTimer *uploadGPS_timer;
@property(nonatomic,retain) NSString *lat,*lng;

-(IBAction)showMessages:(id)sender;
-(IBAction)showFriends:(id)sender;
-(IBAction)showPhotos:(id)sender;
-(IBAction)showProfile:(id)sender;

-(IBAction)switchSwitched:(id)sender;

-(void)uploadGPS_tick:(NSTimer*)timer;
@end 
```

主菜单驱动程序.m

```
#import "MainMenuDriver.h"
#import "ASIFormDataRequest.h"
#import "JoeMaxiViewController.h"
#import "Photos.h"
#import "Profile.h"

@implementation MainMenuDriver
@synthesize messages,profile,photos,friends,label1;
@synthesize onOffline;
@synthesize uploadGPS_timer;
@synthesize lat,lng;

-(IBAction)showPhotos:(id)sender{
    [self.navigationItem setBackBarButtonItem:[[UIBarButtonItem alloc] initWithTitle:@"Back" style:UIBarButtonItemStylePlain target:nil action:nil]];
    Photos *x= [[Photos alloc] initWithNibName:nil bundle:nil];
    [[self navigationController]pushViewController:x animated:YES];
}
-(IBAction)showProfile:(id)sender{
    [self.navigationItem setBackBarButtonItem:[[UIBarButtonItem alloc] initWithTitle:@"Back" style:UIBarButtonItemStylePlain target:nil action:nil]];
    Profile *x= [[Profile alloc] initWithNibName:nil bundle:nil];
    [[self navigationController]pushViewController:x animated:YES];
}
-(void)logout:(id)sender{
    if([uploadGPS_timer isValid]){
        [uploadGPS_timer invalidate];
    }
    [lm release];
    //[uploadGPS_timer release];

    [self.navigationController popViewControllerAnimated:NO];

    /*NSString *urlStr=[[NSString alloc] initWithFormat:@"http://www.prestocab.com/driver/ajax/logout.php"];
    NSURL *url=[NSURL URLWithString:urlStr];
    __block ASIFormDataRequest *request=[[ASIFormDataRequest alloc ]initWithURL:url];
    [request setDelegate:self];
    [request setCompletionBlock:^{
        NSString *response=[request responseString];
        NSLog(@"%@",response);

    }];
    [request setFailedBlock:^{

    }];
    [request startAsynchronous];*/

}
-(IBAction)switchSwitched:(id)sender{
    if(onOffline.on){
        [label1 setText:@"For Hire"];
        [label1 setTextColor:[UIColor colorWithRed:0.0 green:0.8 blue:0.0 alpha:1.0]];

        uploadGPS_timer=[NSTimer scheduledTimerWithTimeInterval:10.0 target:self selector:@selector(uploadGPS_tick:) userInfo:nil repeats:YES];
        [self uploadGPS_tick:nil];
    }else{
        [label1 setText:@"Engaged"];
        [label1 setTextColor:[UIColor colorWithRed:0.8 green:0.0 blue:0.0 alpha:1.0]];

        if([uploadGPS_timer isValid]){
            [uploadGPS_timer invalidate];
        }
    }

}
-(void)uploadGPS_tick:(NSTimer*)timer{
    if(!lat || !lng){
        //do nothing
    }else{
        NSString *urlStr=[[NSString alloc] initWithFormat:@"http://www.prestocab.com/driver/ajax/updateCoords.php"];
        NSURL *url=[NSURL URLWithString:urlStr];

        __block ASIFormDataRequest *request=[[ASIFormDataRequest alloc ]initWithURL:url];
        [request setPostValue:lat forKey:@"lat"];
        [request setPostValue:lng forKey:@"lng"];
        NSLog(@"EOH: %@",lat);
        [request setDelegate:self];
        [request setCompletionBlock:^{
            NSString *response=[request responseString];
            NSLog(@"%@",response);
            //do nothing
        }];
        [request setFailedBlock:^{
            //NSError *error =[request error];
            //do nothing
        }];
        [request startAsynchronous];
    }
}

-(void)locationManager:(CLLocationManager*) manager didUpdateToLocation:(CLLocation *) newLocation fromLocation:(CLLocation*) oldLocation{
    lat=[[NSString alloc]initWithFormat:@"%g",newLocation.coordinate.latitude];
    lng=[[NSString alloc]initWithFormat:@"%g",newLocation.coordinate.longitude];
    NSLog(@"%@,%@",lat,lng);
}
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    self.navigationItem.title=@"PrestoCab";
    UIBarButtonItem *anotherButton = [[UIBarButtonItem alloc] initWithTitle:@"Logout" style:UIBarButtonItemStylePlain target:self action:@selector(logout:)];      
    self.navigationItem.rightBarButtonItem = anotherButton;
    [anotherButton release];

    //GPS
    lm=[[CLLocationManager alloc] init];
    if([CLLocationManager locationServicesEnabled]){
        lm.delegate=self;
        lm.desiredAccuracy=kCLLocationAccuracyBest;
        lm.distanceFilter=30.0f;
        [lm startUpdatingLocation];
    }
    //[self check4messages_tick:nil];   //want to start immediately, not in 10/40 seconds' time
    [self uploadGPS_tick:nil];
    //check4messages_timer=[NSTimer scheduledTimerWithTimeInterval:40.0 target:self selector:@selector(check4messages_tick:) userInfo:nil repeats:YES];
    uploadGPS_timer=[NSTimer scheduledTimerWithTimeInterval:10.0 target:self selector:@selector(uploadGPS_tick:) userInfo:nil repeats:YES];

    [super viewDidLoad];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    if([uploadGPS_timer isValid]){
        [uploadGPS_timer invalidate];
    }
}
-(void)dealloc{
    [super dealloc];
    [uploadGPS_timer release];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

@end 
```

另外，这里是

MyClassViewController.h：

```
#import <UIKit/UIKit.h>

@interface MyClassViewController : UINavigationController{
    IBOutlet UIButton *passenger;
    IBOutlet UIButton *driver;

}
@property (nonatomic,retain) UIButton *passenger;
@property (nonatomic,retain) UIButton *driver;

-(IBAction) passengerClicked:(id)sender;
-(IBAction) driverClicked:(id)sender;

@end 
```

和 MyClassViewController.m：

```
#import "MyClassViewController.h"
#import "MainMenuDriver.h"

@implementation MyClassViewController
@synthesize passenger;
@synthesize driver;

-(IBAction)passengerClicked:(id)sender{
    NSLog(@"passenger");
}
-(IBAction)driverClicked:(id)sender{
    NSLog(@"driver");
    MainMenuDriver *mainMenuDriver= [[MainMenuDriver alloc] initWithNibName:nil bundle:nil];
    [[self navigationController]pushViewController:mainMenuDriver animated:YES];
}
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:21:17.677

我可以看到几件事：

1.  您的 nib 文件的名称与您的类的名称不同。如果您输入 nil，`UIViewController`则将尝试加载具有`UIViewController`' 名称的 nib 文件。您`UIViewController`可以，`MainMenuDriver`但您的 nib 文件名可以`MainMenuDriverNibFileName.nib`
2.  `[self navigationController]`是`nil`。

为此，请执行以下操作：

```
 NSLog(@"hi");
    if([self navigationController]){
        MainMenuDriver *mainMenuDriver= [[MainMenuDriver alloc] initWithNibName:nil bundle:nil];
        [[self navigationController]pushViewController:mainMenuDriver animated:YES];
    }
    else{
        NSLog(@"Houston we have a problem");
    } 
```

**更新1：**

所以，它`nil`，你可以做的是：

1.  又快又脏：

    [自我presentViewController：mainMenuDriver动画：YES]；

2.  而不是`UIViewController`切换到`UINavigationController`.

# android - ListView onItemClickListener 从未触发

> ID：11208054
> 
> 赞同：0
> 
> 时间：2012-06-26T13:12:01.197
> 
> 标签：android, listview, focus

我创建了一个覆盖 onTouchListener 的自定义视图，以便根据用户执行的操作淹没不同的图像。（例如，当用户单击视图时更改视图的背景）。

我想在 ListView 中使用这个自定义视图，所以我创建了一个自定义适配器，它显示我的所有视图，但我的 ListView 的 onItemClickListener 永远不会被触发。

我能做些什么 ？

这是我的自定义视图中的代码：

```
 @Override
public boolean onTouchEvent(MotionEvent event) {
    switch (event.getAction()) {
    case MotionEvent.ACTION_DOWN:
        setMode(MODE_SELECTED);
        invalidate();
        break;
    case MotionEvent.ACTION_UP:
        setMode(MODE_NONE);
        invalidate();
        break;
    case MotionEvent.ACTION_CANCEL:
        setMode(MODE_NONE);
        invalidate();
        break;
    case MotionEvent.ACTION_OUTSIDE:
        setMode(MODE_NONE);
        invalidate();
        break;
    default:
        break;
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:59:58.023

好的，我找到了一个解决方案：我使用 StateListDrawable 并且它避免了我覆盖自定义视图的 onTouch ！

# qt - QMessagebox 中的下层文本

> ID：11208055
> 
> 赞同：0
> 
> 时间：2012-06-26T13:12:05.867
> 
> 标签：qt, settext, qmessagebox

我有一个带有自定义背景图像的 QMessagebox。由于我想在背景图像的顶部看到一些东西，因此应该降低消息框的文本。有人知道我该怎么做吗？我已经尝试使用 br 加入一些白线，所以：

```
popup.setText("<font size =5 color =white ><br>""<br>""<br>""Are you sure you 
want to erase the memory</font> "); 
```

但这搞砸了背景图片。有什么办法可以将包含文本的“框”移动到较低的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:50:32.583

您可以尝试获取 QMessageBox 的布局，获取包含文本的标签并增加标签边距。这可能是一种 hack，可能会使您的项目无法移植。构建您的 QMessageBox，调用 hack，然后执行该框。

```
void hack(QMessageBox* pMessageBox)
{
   QGridLayout* grid = qobject_cast<QGridLayout*>(pMessageBox->layout());
   if (grid)
   {
      QLabel* label = qobject_cast<QLabel*>((grid->itemAtPosition(0,1))->widget());
      if (label)
      {
         label->setMargin(label->margin()+5); // whatever is suitable
      }
   }
} 
```

# ajax - 在 JSF 中禁用组件的 Ajax 调用

> ID：11208056
> 
> 赞同：2
> 
> 时间：2012-06-26T13:12:06.470
> 
> 标签：ajax, jsf

似乎没有在禁用组件上调用 ajax 调用。有没有其他选择？

这是我的代码。请告诉我是否在做其他错误..

```
<h:inputText id="inputId" disabled = "true">
   <f:ajax event="mouseover" listener="#{promotionDetailManagedBean.getToolTipInfo}"
      execute="@this" render="priceConTooltip" >
   </f:ajax>
</h:inputText> 
```

Thxx Tarun Madaan

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:10:43.533

让它`readonly`代替`disabled`.

如果您需要它具有禁用输入的样式，只需添加一些 CSS 即可实现。例如

```
input[readonly] {
    background-color: gray;
} 
```

# android - 更新 GUI：Runnables 与消息

> ID：11208057
> 
> 赞同：52
> 
> 时间：2012-06-26T13:12:08.770
> 
> 标签：android, user-interface, message, runnable

要从其他线程更新 GUI，基本上有两种主要方法：

1.  将 java.lang.Runnable 与以下任何方法一起使用：

    ```
    Activity.runOnUiThread(Runnable)
    View.post(Runnable)
    View.postDelayed(Runnable, long)
    Handler.post(Runnable) 
    ```

2.  使用 android.os.Message：

    ```
    Handler.sendMessage(Message) / Handler.handleMessage(Message) 
    ```

您也可以使用 AsyncTask，但我的问题更侧重于更新一个非常简单的组件的用例。让我们看看如何使用这两种方法来完成：

1.  使用可运行文件：

    ```
    TextViev tv = ...;
    final String data = "hello";
    Runnable r = new Runnable() {

        @Override
        public void run(){
            tv.setText(data);
        }

    };
    //Now call Activity.runOnUiThread(r) or handler.post(r), ... 
    ```

2.  使用消息：

    ```
    Message m = handler.obtainMessage(UPDATE_TEXT_VIEW, "hello");
    handler.sendMessage(m);

    //Now on handler implementation:
        @Override
        public void handleMessage(Message msg) {
            if(msg.what == UPDATE_TEXT_VIEW){
                String s = (String) msg.obj;
                tv.setText(data);
            } ... //other IFs?
        } 
    ```

恕我直言，消息不是要走的路，因为：

*   对于新的非 android 程序员来说不容易理解（在构造过程中处理程序挂钩到其线程）。
*   如果消息跨越进程边界，则对象有效负载应该是 Parcellable。
*   消息被重用（如果没有正确清理容易出错？）
*   处理程序具有双重作用（它发送消息，但也处理它们）
*   消息属性是公开的，但也提供 getter/setter。

另一方面，Runnables 遵循众所周知的命令模式，并且对程序员更加友好和可读。

那么使用 Messages 而不是 Runnables 有什么优势呢？在现代 Android 编程中，消息是否被推到了后台？有什么可以用 Runnables 做不到的 Messages 做的吗？

提前致谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-03-20T13:08:17.723

我想说使用 a 和 a 之间几乎没有`Message`区别`Runnable`。它主要归结为个人喜好。为什么？查看源代码，您会发现发布 a`Runnable`使用完全相同的消息传递机制。它只是将 a 附加`Runnable`到 a`Message`并发送它。

**4.4.2 源代码**

```
public final boolean post(Runnable r) {
    return  sendMessageDelayed(getPostMessage(r), 0);
}

private static Message getPostMessage(Runnable r) {
    Message m = Message.obtain();
    m.callback = r;
    return m;
} 
```

参考：[Grep 代码 - 处理程序](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.4.2_r1/android/os/Handler.java#Handler.post%28java.lang.Runnable%29)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-11-25T23:27:58.890

`Messages`可以重用，因此它会导致创建的对象和 GC 更少。您最终也会得到更少的类和匿名类型。

一个很大的优势是发送 a`Message`到 a的类`Handler`不需要知道关于 that 的实现的任何信息`Message`。这可以帮助封装，具体取决于它的使用位置。

最后考虑清洁度的区别

```
mHandler.obtainMessage(DO_STUFF, foo).sendToTarget(); 
```

对比

```
final Foo tempFoo = foo;
mHandler.post(new Runnable(){
    @Override
    public void run(){
        doStuff(tempFoo);
    }
}; 
```

如果您有几个地方需要`doStuff()`，那么前者的可读性更高，并且您的代码重复更少。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-26T13:27:01.563

`Handler``runOnUiThread()`根据文档，接口提供的功能比 多得多：

> 处理程序有两个主要用途：
> (1) 安排消息和可运行文件在未来某个时间点执行
> (2) 将要在与您自己的线程不同的线程上执行的操作排入队列。

`runOnUiThread`只做 (2) 的一个子集。即“将要在***UI 线程***上执行的操作排入队列”

因此，除非您需要那些额外的功能，否则 IMO`runOnUiThread`是足够且首选的方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-23T08:59:19.393

I prefer `Runnable` to `Message`. I think code using `Runnable` is much clearer than `Message`, because the event handling code is very close to the event. Also, You can avoid the overhead of defining constants and switch cases.

And I don't think using `Runnable` violates encapsulation. You can extract the code in `Runnable.run()` into another method in the outer class, for example `on...Event()`, or even wrap it into an `EventHandler` object. Both ways are much clearer than using `Message`, especially when you need store references in `Message`, because using `Runnable` avoids downcasting `msg.obj`. And the nameless field `msg.obj` is also error prone and sometimes inefficient to understand.

And `Runnable` can also be reused by storing it as a field.

# android - android：在启动时不运行....以及如何编写相同的内容以禁用蓝牙

> ID：11208059
> 
> 赞同：0
> 
> 时间：2012-06-26T13:12:13.167
> 
> 标签：android, service, bluetooth, wifi

当用户尝试启用蓝牙和 Wifi 时，试图实现一项禁用蓝牙和 wifi 的服务，因为它们很少会被感染。

我已禁用应用程序储物柜的应用程序使用。

这是我尝试使用可用的教程，但到目前为止我未能在启动时运行它

服务等级

```
public class MyService extends Service{

    @Override
    public IBinder onBind(Intent intent) {
        // TODO Auto-generated method stub
        return null;
    }
    @Override
    public void onCreate() {
        // TODO Auto-generated method stub
        super.onCreate();
    }
    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {

        IntentFilter filter = new IntentFilter(
                WifiManager.SCAN_RESULTS_AVAILABLE_ACTION);
        BroadcastReceiver mReceiver = new StatusReceiver();
        registerReceiver(mReceiver, filter);

        return super.onStartCommand(intent, flags, startId);
    }

} 
```

接收器

```
public class StatusReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        WifiManager wifiManager = (WifiManager) context
                .getSystemService(Context.WIFI_SERVICE);
        if (wifiManager.getWifiState() == WifiManager.WIFI_STATE_ENABLED) {
            wifiManager.setWifiEnabled(false);
        }

    }

} 
```

活动

```
public class TestActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Log.d("HI","I am on activity");
        startService(new Intent(this,MyService.class));
        finish();
    }
} 
```

显现

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="test.active"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10" />

    <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />
    <uses-permission android:name="android.permission.BLUETOOTH" />
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />
    <uses-permission android:name="android.permission.UPDATE_DEVICE_STATS" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
 <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".TestActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <service android:name=".MyService" >
        </service>

        <receiver android:name=".StatusReceiver" >
        </receiver>
    </application>

</manifest> 
```

# c++ - 无法为 Symbian 设备创建 QT postgresql 插件

> ID：11208065
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:12:33.970
> 
> 标签：c++, qt, postgresql, symbian

我正在尝试为 Symbian 设备创建 postgresql 插件，但我无法编译它。我正在使用 Windows 7 64 位。

我根据这篇文章做了一切：http: [//doc.qt.io/archives/qt-4.7/sql-driver.html#qpsql](http://doc.qt.io/archives/qt-4.7/sql-driver.html#qpsql)

```
C:\QtSDK\QtSources\4.8.1\src\plugins\sqldrivers\psql>qmake "INCLUDEPATH+=C:\Program Files (x86)\PostgreSQL\8.3\include" "LIBS+=C:\Program Files (x86)\PostgreSQL\8.3\lib\libpq.lib" psql.pro
WARNING: (internal):1: Unescaped backslashes are deprecated. 
```

所以，看起来还不错。然后...

```
C:\...drivers\psql>C:\QtSDK\Symbian\tools\sbs\win32\mingw\bin\make debug-gcce
sbs -c arm.v5.udeb.gcce4_4_1
python.exe is not recognized as an internal or external command, operable program or batch file.
make: *** [debug-gcce] Error 9009 
```

我注意到，sbs_home 设置为 python 目录但它不在路径中，然后 make 找不到脚本 raptor_start.py：

```
C:\...drivers\psql>echo %sbs_home%
C:\QtSDK\Symbian\tools\sbs\win32\python27
C:\...drivers\psql>set path=%path%;%sbs_home%
C:\...drivers\psql>C:\QtSDK\Symbian\tools\sbs\win32\mingw\bin\make debug-gcce
sbs -c arm.v5.udeb.gcce4_4_1
python.exe: can't open file C:\QtSDK\Symbian\tools\sbs\win32\python27\python\raptor_start.py': [Errno 2] No such file or directory
make: *** [debug-gcce] Error 2
C:\...drivers\psql>set sbs_home=C:\QtSDK\Symbian\tools\sbs 
```

所以，当我开始编译时，我得到了这个错误：

```
C:/QtSDK/Symbian/SDKs/Symbian3Qt474/epoc32/include/stdapis/stlportv5/stl/_istream.c:650: warning: suggest parentheses around '&&' within '||' target     : epoc32\release\armv5\udeb\qsqlpsql.dll    [arm.v5.udeb.gcce4_4_1]
FAILED linkandpostlink  for arm.v5.udeb.gcce4_4_1: epoc32\release\armv5\udeb\qsqlpsql.dll
  mmp: qsqlpsql_dll.mmp
c:/qtsdk/symbian/tools/gcce4/bin/../lib/gcc/arm-none-symbianelf/4.4.1/../../../../arm-none-symbianelf/bin/ld.exe: warning: C:/QtSDK/Symbian/SDKs/Symbian3Qt474/epoc32/release/armv5/udeb/usrt3_1.lib(ucppinit.o) uses variable-size enums yet the output is to use 32-bit enums; use of enum values across objects may fail
C:/QtSDK/Symbian/SDKs/Symbian3Qt474/epoc32/build/psql/c_8d95259b570e1766/qsqlpsql_dll/armv5/udeb/qsql_psql.o: In function `qMakeError':    C:/QtSDK/QtSources/4.8.1/src/sql/drivers/psql/qsql_psql.cpp:175: undefined reference to `PQerrorMessage' 
```

....许多未定义的引用...

```
C:/QtSDK/QtSources/4.8.1/src/sql/drivers/psql/qsql_psql.cpp:117: undefined reference to `PQfreemem'
collect2: ld returned 1 exit status

mingw32-make[1]: *** [C:/QtSDK/Symbian/SDKs/Symbian3Qt474/epoc32/release/armv5/udeb/qsqlpsql.dll] Error 1
sbs: error: The make-engine exited with errors.

sbs : warnings: 3
sbs : errors: 2

built 'arm.v5.udeb.gcce4_4_1'

Run time 5 seconds

sbs: build log in C:\QtSDK\Symbian\SDKs\Symbian3Qt474\epoc32\build\Makefile.2012-06-26-15-03-12.78-2996.log
make: *** [debug-gcce] Error 1 
```

有没有人知道，它有什么用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T04:28:25.233

您正在尝试使用 Windows 的预编译二进制 postgresql 客户端库构建 Symbian/ARM 应用程序。这永远行不通。您参考的[说明](http://qt-project.org/doc/qt-4.8/sql-driver.html#qpsql)仅显示了如何为 OS X、Unix 和 Mac 目标本地构建。您正在为 Symbian 进行交叉编译。

您首先需要获取为 Symbian 编译的 postgresql 客户端库的二进制版本。它可能存在，或者您可能需要自己编译它。我认为该库不支持将 Symbian 作为目标，而且我也找不到任何 Symbian 端口供下载。对于一个微不足道的解决方案，您可能不走运。不过，移植可能不是完全不可能的——也许特定于平台的代码已经足够本地化了。

# php - PHP 防止双重清除 url（改进？）

> ID：11208066
> 
> 赞同：0
> 
> 时间：2012-06-26T13:12:35.417
> 
> 标签：php, recursion, clean-urls

对于工作中的客户，我们已经建立了一个网站。该网站有一个产品页面，其中可以包含相同类型/构建的变体，因此他们遇到了双重清洁网址的问题。

刚才我写了一个函数，通过在 URL 上附加一个数字来防止这种情况发生。如果 thatclean url 也存在，它会计数。

例如

domain.nl/产品/机器

domain.nl/product/machine-1

domain.nl/product/machine-2

更新！返回 $clean_url; 递归和返回

我编写的函数运行良好，但我想知道我是否采取了正确的方法，是否可以改进。这是代码：

```
public function prevent_double_cleanurl($cleanurl)
{

    // makes sure it doesnt check against itself
            if($this->ID!=NULL) $and = " AND product_ID <> ".$this->ID;

    $sql = "SELECT product_ID, titel_url FROM " . $this->_table . " WHERE titel_url='".$cleanurl."' " . $and. " LIMIT 1";

    $result = $this->query($sql);

            // if a matching url is found
    if(!empty($result))
    {
        $url_parts = explode("-", $result[0]['titel_url']);
        $last_part = end($url_parts);

        // maximum of 2 digits
        if((int)$last_part && strlen($last_part)<3)
        {
            // if a 1 or 2 digit number is found - add to it
                            array_pop($url_parts);
            $cleanurl = implode("-", $url_parts);

            (int)$last_part++;
        }
        else
        {
            // add a suffix starting at 1
                            $last_part='1';
        }
                    // recursive check
        $cleanurl = $this->prevent_double_cleanurl($cleanurl.'-'.$last_part);
    }

    return $cleanurl; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:50:47.090

根据多次使用“clean-url”的可能性，您的方法可能不是最好的。假设从“foo”到“foo-10”，您将调用数据库 10 次。

您似乎也没有清理您推送到 SQL 查询中的数据。你在使用[mysql_real_escape_string](http://se2.php.net/mysql_real_escape_string)（或者它的 mysqli，PDO，任何兄弟）？

修改后的代码：

```
public function prevent_double_cleanurl($cleanurl) {
    $cleanurl_pattern = '#^(?<base>.*?)(-(?<num>\d+))?$#S';

    if (preg_match($cleanurl_pattern, $base, $matches)) {
        $base = $matches['base'];
        $num = $matches['num'] ? $matches['num'] : 0;
    } else {
        $base = $cleanurl;
        $num = 0;
    }

    // makes sure it doesnt check against itself
    if ($this->ID != null) {
        $and = " AND product_ID <> " . $this->ID;
    }

    $sql = "SELECT product_ID, titel_url FROM " . $this->_table . " WHERE titel_url LIKE '" . $base . "-%' LIMIT 1";
    $result = $this->query($sql);

    foreach ($result as $row) {
        if ($this->ID && $row['product_ID'] == $this->ID) {
            // the given cleanurl already has an ID,
            // so we better not touch it
            return $cleanurl;
        }

        if (preg_match($cleanurl_pattern, $row['titel_url'], $matches)) {
            $_base = $matches['base'];
            $_num = $matches['num'] ? $matches['num'] : 0;
        } else {
            $_base = $row['titel_url'];
            $_num = 0;
        }

        if ($base != $_base) {
            // make sure we're not accidentally comparing "foo-123" and "foo-bar-123"
            continue;
        }

        if ($_num > $num) {
            $num = $_num;
        }
    }

    // next free number
    $num++;
    return $base . '-' . $num;
} 
```

我不知道您的干净网址的可能值。上次我做这样的事情时，我的基地可能看起来像`some-article-revision-5`。这`5`是实际项目符号的一部分，而不是重复索引。为了区分它们（并允许`LIKE`过滤掉误报），我使干净的 url 看起来像`$base--$num`. 双破折号只能出现在基数和重复索引之间，让事情变得更简单......</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:53:42.080

我没有办法测试这个，所以它在你身上，但我会这样做。我在那里发表了大量评论，解释了我的推理和代码流程。

基本上，不必要的递归将导致比您需要的更多的数据库查询。

```
<?
public function prevent_double_cleanurl($cleanurl)
{
    $sql = sprintf("SELECT product_ID, titel_url FROM %s WHERE titel_url LIKE '%s%%'", 
        $this->_table, $cleanurl);
    if($this->ID != NULL){ $sql.= sprintf(" AND product_ID <> %d", $this->ID); }

    $results = $this->query($sql);

    $suffix = 0;
    $baseurl = true;
    foreach($results as $row)
    {
        // Consider the case when we get to the "first" row added to the db:
        //  For example: $row['titel_url'] == $cleanurl == 'domain.nl/product/machine'
        if($row['title_url'] == $cleanurl)
        {
            $baseurl = false;   // The $cleanurl is already in the db, "this" is not a base URL
            continue;           // Continue with the next iteration of the foreach loop
        }

        // This could be done using regex, but if this works its fine.
        // Make sure to test for the case when you have both of the following pages in your db:
        //
        //  some-hyphenated-page
        //  some-hyphenated-page-name
        //
        // You don't want the counters to get mixed up
        $url_parts = explode("-", $row['titel_url']);
        $last_part = array_pop($url_parts);
        $cleanrow = implode("-", $url_parts);

        // To get into this block, three things need to be true
        //  1\. $last_part must be a numeric string (PHP Duck Typing bleh)
        //  2\. When represented as a string, $last_part must not be longer than 2 digits
        //  3\. The string passed to this function must match the string resulting from the (n-1) 
        //      leading parts of the result of exploding the table row
        if((is_numeric($last_part)) && (strlen($last_part)<=2) && ($cleanrow == $cleanurl))
        {
            $baseurl = false;                           // If there are records in the database, the 
                                                        //  passed $cleanurl isn't the first, so it 
                                                        //  will need a suffix
            $suffix = max($suffix, (int)$last_part);    // After this foreach loop is done, $suffix 
                                                        //  will contain the highest suffix in the 
                                                        //  database we'll need to add 1 to this to 
                                                        //  get the result url
        }
    }

    // If $baseurl is still true, then we never got into the 3-condition block above, so we never 
    //  a matching record in the database -> return the cleanurl that was passed here, no need
    //  to add a suffix
    if($baseurl)
    {
        return $cleanurl;
    }
    // At least one database record exists, so we need to add a suffix.  The suffix we add will be
    //  the higgest we found in the database plus 1.
    else
    {
        return sprintf("%s-%d", $cleanurl, ($suffix + 1));
    }
} 
```

我的解决方案利用 SQL 通配符 ( `%`) 将查询数从*n*减少到 1。

确保您确保我在第 14-20 行中描述的问题案例按预期工作。机器名称（或任何名称）中的连字符可能会做意想不到的事情。

我也用来`sprintf`格式化查询。确保对作为字符串传递的任何字符串（例如`$cleanurl`）进行清理。

正如@rodneyrehm 指出的那样，PHP 在它认为是数字字符串方面非常灵活。你可以考虑换掉[`is_numeric()`](http://www.php.net/manual/en/function.is-numeric.php)，[`ctype_digit()`](http://www.php.net/manual/en/function.ctype-digit.php)看看它是如何工作的。

# controls - 无服务器的私有版本控制

> ID：11208072
> 
> 赞同：2
> 
> 时间：2012-06-26T13:13:06.747
> 
> 标签：controls, version

我的网络配置不允许计算机作为服务器运行，所以 Subversion 和其他的都出局了。Github 仅为付费客户提供非公开版本控制。

任何人都知道一个解决方案，几个开发人员可以免费使用相同的代码，而无需与全世界共享。如果存在这样的软件，即使在 pendrive 之间合并目录也可以。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T13:17:45.800

我认为您将[Git](http://git-scm.com/)与[GitHub](http://www.github.com)混淆了。

Git 可以免费做任何你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:18:31.407

[BitBucket](http://bitbucket.org/plans)为最多 5 个开发人员提供私有存储库。BitBucket 使用 Git 或 Mercurial，任您选择。

# c# - datagridview 新列，每行分配行数

> ID：11208075
> 
> 赞同：0
> 
> 时间：2012-06-26T13:13:07.910
> 
> 标签：c#, datagridview

我正在开发一个 C# 项目，并且我有一个 DataGridview，我在其中使用以下代码动态添加一个新列。

```
DataGridViewColumn cl = new DataGridViewColumn();
cl.HeaderText = "Numbering";
grdCrew.Columns.Add(cl); 
```

我想在每个新行上放一个实际上是行号的数字，但我想自动分配数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:28:17.267

试试这个 ：

```
dataGridView1["ColumnName",rowIndex].DefaultNewRowValue = dt.Rows.Count; 
```

更新：您也可以使用这些代码：

```
adapter.Fill(dt);
        dt.Columns["ColumnName"].DefaultValue = dt.Rows.Count; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:18:50.503

尝试使用此代码

```
yourColumn.DefaultValue = yourTable.Rows.Count; 
```

# actionscript-3 - AS3 代码以 100% 查看 Flash 文件

> ID：11208082
> 
> 赞同：0
> 
> 时间：2012-06-26T13:13:28.133
> 
> 标签：actionscript-3, flash

如果我打开一个基本的 .swf 文件，然后右键单击，则可以选择“全部显示”或使其 100%？如何使用 AS3 进行编码，这样我就不必每次都去点击 100% 选项？？？

我现在为此苦苦挣扎了一段时间...如果有人可以帮助我，我将不胜感激！

谢谢！:):)*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:39:44.400

在您的初始化代码中。

```
stage.scaleMode = StageScaleMode.SHOW_ALL; 
```

# nginx - 是否可以在 nginx 配置中使用条件以使测试和生产具有相同的配置文件？

> ID：11208088
> 
> 赞同：0
> 
> 时间：2012-06-26T13:13:41.487
> 
> 标签：nginx

我想使用相同的配置 nginx 站点配置文件进行测试，并且只更改服务器名称和端口。

我怎样才能做到这一点或接近它？

我想要类似的东西：如果主机名==xxx 在 80 上听，在 81 上听。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:25:56.823

您可以将所有共享部分放在一个单独的文件中（例如，`common.conf`）并将其包含在两个简约`server`块中，如下所示：

```
http {
    [...]
    server {
        listen 80;
        server_name production.local;

        root /some/path/production;
        include common.conf;
    }

    server {
        listen 81;
        server_name testing.local;

        root /some/path/testing;
        include common.conf;
    }
} 
```

**编辑** 实际上，您甚至不需要`listen`指令。`listen 80`当以 root 身份运行时，它们默认为，`listen 8000`否则为。只要您有 DNS 条目或主机文件条目，就可以了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T13:16:34.847

你应该使用`bash/sh`. Unix方式。

# java - 将 Int 值更改为字符串

> ID：11208094
> 
> 赞同：0
> 
> 时间：2012-06-26T13:13:58.620
> 
> 标签：java, int, tostring

我正在尝试用几个数字进行简单的数学运算。完成后，我希望将 int 类型的数字更改为字符串。我能够为前 4 个 else if 语句编译代码，但是当我创建 n5x 时，第 5 个给我一个问题。我是否不允许在 else 语句中创建值？如果是这样，有没有办法解决这个问题？谢谢你。

```
 if (n1==1){
                                int n1x = ((n1*10 +n2) + (n3*10+n4)+(n5));
                                n1s = Integer.toString(n1x);

                                outFile.println(n1s);}
                            else if (n2==2){
                                int n2x = (n2 + (n1*10 + n3)+(n4*10+ n5));
                                n2s = Integer.toString(n2x);
                                outFile.println(n2s);}
                            else if (n3==3){
                                int n3x = ((n3*10 +n2) + n1+ (n4*10+n5));
                                n3s = Integer.toString(n3x);
                                outFile.println(n3s);}
                            else if (n4 == 4){
                                int n4x =  (n4 + (n3 +n2*10)+(n5+n1*10));
                                n4s = Integer.toString(n4x);
                                outFile.println(n4s);}
                            else 
                                int n5x  = ((n5) + (n4+ n3*10) +  (n2+n1*10));
                                n5s = Integer.toString(n5x);
                                outFile.println(n5s); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T13:14:38.330

您的 else 子句缺少大括号。

变量 n5x 仅在 else 子句中定义。没有大括号，else 子句只包含声明。

它应该如下所示：

```
 else {
    int n5x  = ((n5) + (n4+ n3*10) +  (n2+n1*10));
    n5s = Integer.toString(n5x);
    outFile.println(n5s);
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:15:27.217

您在最后一个 else 语句中缺少 { }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:29:18.313

你的最后一个`else`条款：

```
else 
  int n5x  = ((n5) + (n4+ n3*10) +  (n2+n1*10));
  n5s = Integer.toString(n5x);
  outFile.println(n5s); 
```

Java 编译器实际上是这样解释的：

```
else {
     int n5x  = ((n5) + (n4+ n3*10) +  (n2+n1*10));
}
n5s = Integer.toString(n5x);
outFile.println(n5s); 
```

一般来说，您应该`{}`在任何控制语句中包含一个以上的语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:16:27.363

else 应该在大括号中。它应该如下 -

```
 else {
                            int n5x  = ((n5) + (n4+ n3*10) +  (n2+n1*10));
                            n5s = Integer.toString(n5x);
                            outFile.println(n5s);} 
```

# web-services - ksoap2 - SoapObject '找不到源'

> ID：11208095
> 
> 赞同：1
> 
> 时间：2012-06-26T13:14:02.683
> 
> 标签：web-services, blackberry, ksoap2

我有一个用于 BlackBerry 应用程序的代码，其中单击“登录”按钮以获取 xml 数据。但是，当我尝试显示从接受用户名和密码的 Web 服务返回的响应时，什么也没有出现。我的 MDS 被选中，浏览器显示 Internet 正在工作。但是，正如一些帖子所建议的那样，我在调试器配置窗口中没有看到任何**禁用注册选项。**我的问题是如何获得服务器响应。在模拟器调试控制台中，没有`System.println`显示任何消息。逐行调试，当涉及到代码时

```
SoapObject rpc = new SoapObject(NAMESPACE, METHOD_NAME); 
```

调试器产生错误“找不到源”。我的重点实际上已经从获取服务器响应转移到实际修复 ksoap2 的路径，因为它似乎找不到。对此有什么建议吗？谢谢

# sql - 这个 SQL 查询可以提高效率吗？

> ID：11208101
> 
> 赞同：1
> 
> 时间：2012-06-26T13:14:33.110
> 
> 标签：sql, postgresql

我有一个非常大的**节点**表（基数约为 600,000），该表中的每条记录都可以有一个或多个与之关联的类型。有一个**node_types**表包含这些（大约 30 个）类型定义。

为了连接这两者，我有一个名为**node_type_relations**的第三个表，它只是将节点 ID 链接到类型 ID。

我试图在剔除节点表后清理孤立的 node_type_relation 条目。我删除节点不再存在的任何类型关系的查询是；

```
DELETE FROM node_type_relations WHERE node_id NOT IN (SELECT id FROM nodes) 
```

但是从它的运行速度来看（每 10 秒左右删除一条记录），看起来 Postgres 为 node_type_relations 表中的每条记录（大约 140 万条记录）加载整个节点表）。

当我想我会在这里询问是否可以以某种方式将查询从内到外翻转时，我正要潜入并编写一些代码以更明智地执行此操作。任何避免多次加载节点表的方法。

一如既往地感谢。

* * *

**使用解决方案编辑**

执行查询；

```
DELETE FROM node_type_relations WHERE NOT EXISTS (SELECT 1 FROM nodes WHERE nodes.id=node_type_relations.node_id) 
```

似乎已经达到了预期的效果，并在几秒钟内删除了所有孤立的记录（大约 170,000 条）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:19:55.633

也许做一个左连接，然后删除where null。

所以：

```
 DELETE ntr
 FROM node_type_relations ntr
 LEFT JOIN nodes n
 ON n.id = ntr.node_id
 WHERE n.id IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:46:15.677

@lynks 自己为他的案例找到了最佳查询 - 使用`EXISTS`半连接：

```
DELETE FROM node_type_relations ntr
WHERE  NOT EXISTS (
   SELECT 1
   FROM   nodes n
   WHERE  n.id = ntr.node_id
   ); 
```

在 PostgreSQL 中必须像这样构造一个带有 JOIN 语法的解决方案：

```
DELETE FROM node_type_relations d
USING  node_type_relations ntr
LEFT   JOIN nodes n ON n.id = ntr.node_id
WHERE  ntr.node_id = d.node_id
AND    n.id IS NULL; 
```

# python - Python 正则表达式查找字符串

> ID：11208103
> 
> 赞同：1
> 
> 时间：2012-06-26T13:14:35.363
> 
> 标签：python, python-3.x

我有一个文本文件，其文本如下所示

> 格式={ Window_Type="Tabular", Tabular={ Num_row_labels=10 } }

我需要在我的文本文件中查找 Num_row_labels >=10。我如何使用 Python 3.2 正则表达式来做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:17:56.833

假设数据的格式如上，并且数字中没有前导 0：

```
Num_row_labels=\d{2,} 
```

允许任意空格的更自由的正则表达式仍然假定没有前导 0：

```
Num_row_labels\s*=\s*\d{2,} 
```

一个更自由的正则表达式，它允许任意空格，并允许前导 0：

```
Num_row_labels\s*=\s*0*[1-9]\d+ 
```

如果您需要捕获数字，只需用括号括起来`\d{2,}`（在第一个和第二个正则表达式中）或`[1-9]\d+`（在第三个正则表达式中）`()`并在第一个捕获组中引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:19:09.910

重新看起来像：

```
Num_row_labels=[0-9]*[1-9][0-9]+ 
```

使用示例：

```
if re.search('Num_row_labels=[0-9]*[1-9][0-9]+', line):
   print line 
```

正则表达式`[0-9]*[1-9][0-9]+`意味着在字符串中必须至少

*   从 1 到 9 的一位数字（`[1-9]`，正则表达式中的符号类`[]`表示此处可以是括号中指定范围内的任何符号）；
*   以及从 0 到 9 的至少一个数字（但可以更多）（`[0-9]+`，`+`正则表达式中的符号表示位于它之前的符号/表达式可以重复 1 次或多次）。

在这些数字之前可以是任何其他数字（`[0-9]*`，这意味着任何数字，0 次或更多次）。当你已经有两位数时，你可以有任何其他数字——无论如何，这个数字会大于或等于 10。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:19:16.917

正则表达式是`Num_row_labels=[1-9][0-9]{1}.*`

现在你可以使用`re`python 模块（[看看这里）](http://docs.python.org/library/re.html)来分析你的文本并提取那些

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:54:15.663

采用：

```
match = re.search("Num_row_labels=(\d+)", line) 
```

`(\d+)`匹配至少一个十进制数字 (0-9) 并将所有匹配的数字捕获为一个组（组存储在 and 返回的对象中，`re.search`我`re.match`在`match`这里分配）。要访问该组并与 比较`10`，请使用：

```
if int(match.group(1)) >= 10:
    print "Num_row_labels is at least 10" 
```

这将允许您轻松更改阈值的值，这与在正则表达式中执行所有操作的答案不同。此外，我认为这更具可读性，因为很明显您是在将一个值与 10 进行比较，而不是在正则表达式中匹配一个非零数字后跟至少一个其他数字。上面的代码所做的是询问第一个匹配的组（`match.group(1)`返回匹配的字符串`\d+`），然后通过调用`int()`将字符串转换为整数。然后将返回的整数`int()`与 10 进行比较。

# freemarker - 在 Alfresco 规则脚本中将数组放入模板

> ID：11208113
> 
> 赞同：2
> 
> 时间：2012-06-26T13:15:14.297
> 
> 标签：freemarker, alfresco

我有一个关于 Alfresco Community v4.0.0 的问题

*   我创建内容规则，
*   选择执行脚本，
*   并在脚本调用 processTemplate(ScriptNode template, array args)

如何将数组放入模板？Args 只包含键值（字符串）。

提前感谢您的任何建议或帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:31:01.667

我认为您会得到类似“预期的扩展哈希。args.array 被评估为 freemarker.template.SimpleScalar”，对吗？

如果是这样，恐怕您无法使用从内容规则调用的脚本来实现此功能，因为没有复杂数据类型的[包装器](http://freemarker.sourceforge.net/docs/pgui_misc_beanwrapper.html)，所以这就是只接受字符串（和其他标量）的原因。

你有两个选择：

1.  Alter alfresco 代码，它包装对象并将它们发送到 processTemplate() 并构建整个系统（也许更多信息可以在[我的旧博文](http://www.shmoula.cz/more-on-invoking-scripts-in-alfresco/)中找到）

2.  将数组放入 processTemplate() 并在模板中像字符串一样读取它然后解析它 - 数组看起来像 [val1,val2,val3]，因此请参阅[freemarker 文档以获取字符串函数](http://freemarker.sourceforge.net/docs/ref_builtins_string.html)并执行类似的操作（丑陋但快速的解决方案):

    ```
    <#list args.array?split(",") as value>
        hereRemoveFirstAndLastSquareBracketFrom(${value});
    </#list> 
    ```

编辑：如果有人感兴趣，我刚刚在[Alfresco JIRA中提出了一个错误](https://issues.alfresco.com/jira/browse/ALF-14845)

# jquery - jQuery 看不到点击附加对象

> ID：11208119
> 
> 赞同：1
> 
> 时间：2012-06-26T13:15:35.067
> 
> 标签：jquery, append

我有这样的代码

```
$(document).ready(function(){
     $(".add").bind ('click',
        function ()
        {
            $('.main').append('<div class="add">Add element 2</div>');
        });
    });
</script>

<div class="main"><div class="add">Add element</div></div> 
```

当虚拟对象“.add”附加到“.main”时，jquery 不会对点击它们做出反应

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T13:19:16.003

是的，因为您在创建新元素之前将操作绑定到仅现有的*.add元素。*

*您需要使用作为on*函数中的第二个参数提供的特定选择器将单击绑定到*.main元素。*

 *```
$('.main').on('click', '.add', function (){
    $('.main').append('<div class="add">Add element 2</div>');
}); 
```

这真的很直观。使用您的代码，您是说*找到页面上的所有添加元素并将此函数绑定到每个元素*。因此，稍后添加的将不会绑定此功能。

使用正确的代码，您是说*找到主元素并将函数绑定到它，但仅在单击具有类 .add 的子元素时才执行该函数*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:18:11.077

不要使用`.bind()`，而是使用`.on()`or，如果你有 jQuery 的 1.7 之前的版本，`.delegate()`.

绑定是一次性操作，它不会监听 DOM 中的新项目。*

# jquery - 使用带有多个 html 页面的 phonegap 和 jquery mobile 的正确方法

> ID：11208120
> 
> 赞同：5
> 
> 时间：2012-06-26T13:15:44.423
> 
> 标签：jquery, jquery-mobile, cordova

我有一个使用 jquery mobile 的应用程序，它由几个 html 页面组成，每个页面中都有一些 jquery 页面元素。在桌面浏览器上一切正常，但是当我在我的 android 设备（运行 2.3）上加载它时，第一页看起来很好，但是每当你点击一个链接时（让我们说从 index.html -> logged-in-menu.html jquery移动设备似乎没有启动，也没有应用任何样式。如果我从当前页面返回 index.html，那么 index.html 就没有样式了。

那么有没有*正确*的方法在单独的 html 页面之间移动？我没有收到任何浏览器错误，所以一切*似乎*都工作正常，但没有应用 jqm 的样式或功能。

就像每个人都在同一个页面上，链接使用 data-ajax="false" 因此它们会导致完整的页面刷新（因为这是必需的），该应用程序不能作为单页应用程序运行，因此将所有内容放入一个大 html文件不是一个选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T14:09:39.490

如果您没有获得样式，那么您可能缺少 CSS 文档、JS 错误，或者您没有在新页面上正确构建 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T14:37:02.920

另一种选择是将页面（甚至页面中的面板）分解为单独的模板 .html 文件，动态加载并根据需要呈现它们。请参阅“使用 KnockoutJS、PhoneGap 和 jQuery Mobile 创建移动应用程序”教程[http://bit.ly/crmakopgjqm](http://bit.ly/crmakopgjqm)

# jquery - jQuery货币更改与cookie功能

> ID：11208121
> 
> 赞同：0
> 
> 时间：2012-06-26T13:15:45.807
> 
> 标签：jquery, cookies, geolocation, currency

我有一个网站，Hostingshine.com

我想要一个脚本工作，但一个正常的，否则你可以看到这个

```
$(document).ready( function() { 
    $('#usd').click(function(){
    $('.usd').show();
    $('.inr').hide();
    })

    $('#inr').click(function(){
    $('.inr').show();
    $('.usd').hide();
    })
          }); 
```

将它与 Jquery 一起使用，

页面是这样的

```
<ul id="currencychange"><li>
  <a id="usd">USD</a>&nbsp;<a id="inr">INR</a>
</li></ul> 
```

并将类 inr 和 usd 放到我想显示所需货币的地方，但每次我更改页面或刷新页面时，它都会返回默认值，即 usd。

请帮我解决这个问题，帮我获取 cookie 功能或 geo 功能以使用此代码...

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:19:45.047

```
You can use geoplugin library from here 
http://www.geoplugin.com/webservices/javascript
and do something like following code:

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script language="JavaScript" src="http://www.geoplugin.net/javascript.gp" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {

            var currencyCode = geoplugin_currencyCode();
            $('#currencychange').children().children().each(function () {
                if ($(this).attr('id') != currencyCode.toLowerCase()) {
                    $(this).hide();
                }

            });

        });
    </script>
</head>
<body>
<ul id="currencychange">
    <li>
        <a id="usd">USD</a>&nbsp;<a id="gbp">GBP</a>
    </li>
</ul>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T16:19:24.260

这是完整的解决方案 David：您必须添加对 geoplugin 和 money.js 的引用，就像我在下面的代码中所做的那样。我还在每一行之后添加了注释。如果你不明白任何事情只是问。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

    <!--Add a reference to geoplugin -- we will use this to get geo/local settings -->
    <script language="JavaScript" src="http://www.geoplugin.net/javascript.gp" type="text/javascript"></script>

    <!--Add a reference to money.js -- we will use this to convert our currency -->
    <script type="text/javascript" src="http://josscrowcroft.github.com/money.js/money.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {

            // get local currency code using geo plugin
            var localCurrencyCode = geoplugin_currencyCode();

            // make an ajax call to open exchange rates
            $.ajax({
                url: 'http://openexchangerates.org/latest.json',
                dataType: 'jsonp',
                success: function(json) {
                    // Rates are in `json.rates`
                    // Base currency (USD) is `json.base`

                    // set the returned values to money.js object
                    // we will use this later for currency conversion
                    fx.rates = json.rates;
                    fx.base = json.base;

                    // get exchange rate for local currency
                    var exchangeRate = json.rates[localCurrencyCode];

                    // get all elements on page that has a class of currency (you can use the same logic for selection or have your own)
                    $(".currency").each(function () {
                        // extract price eg if $10.00 get 10
                        var priceRaw = parseFloat($(this).html().replace('$',''));

                        // convert the price to local price
                        // we use money.js for this
                        var priceLocal = fx(priceRaw).from(fx.base).to(localCurrencyCode);

                        // finally we construct our price and inject it in the html
                        var finalPrice = localCurrencyCode +  priceLocal;
                        $(this).html(finalPrice) ;

                    });
                }
            });

        });
    </script>
</head>
<body>
<ul id="currencychange">
    <li>
        $10 = <a class="currency">$10</a><br>
        $20 = <a class="currency">$20</a><br>
        $30 = <a class="currency">$30</a><br>
    </li>
</ul>

</body>
</html> 
```

# python - Python shell在执行MainWindow = QtGui.QMainWindow（）时重新启动

> ID：11208129
> 
> 赞同：0
> 
> 时间：2012-06-26T13:16:25.623
> 
> 标签：python, pyqt, pyqt4

我遇到的问题是我的 python shell 在开始执行 SetupUi() 时重新启动

```
class Ui_MainWindow(object):
   def __init__(self):
      print "control"
      self.setupUi()
   def setupUi(self):
      print "control"
      MainWindow=QtGui.QMainWindow()
      print "control"
      MainWindow.setObjectName(_fromUtf8("MainWindow"))
      print "control"
      MainWindow.resize(790, 610)
      print "control" 
```

打印“控制”只是为了查看执行出错的地方，我这样做是因为在执行时没有显示错误并且 shell 只是重新启动。

这是进口

```
from PyQt4 import QtCore, QtGui
import sys
import sqlite3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:41:51.303

好的，我明白了，问题是我没有执行

```
app=QtGui.QApplication(sys.argv) 
```

妈的

# c - 如何使用指针访问 C 中二维数组中的任何元素？

> ID：11208135
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:16:36.017
> 
> 标签：c, arrays, pointers, multidimensional-array

我想使用指针访问 C 中二维数组中的元素

例如（这使用传统方式）

```
multi[0][1] = .... 
```

我试过这种方式

```
*(*(multi+0)+1) = .... 
```

但它给了我一个错误说

```
" pointer required " 
```

那我该怎么办？

其实这就是我正在做的

```
void state_array(int *pointer , int *multi){
   int i ;
   for ( i = 0 ; i < 4 ; i++){
   *(*(multi + i) + 0 )= *(pointer+i) ;
                                }
     for ( i = 4 ; i < 8 ; i++){
   *(*(multi + i ) + 1 )= *(pointer+i) ;
                                }
    for ( i = 8 ; i < 12 ; i++){
   *(*(multi + i ) + 2 )= *(pointer+i) ;
                                }
   for ( i = 12 ; i < 16 ; i++){
   *(*(multi + i ) + 3 )= *(pointer+i) ;
                                }
                                  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:23:21.980

您收到该特定错误消息的原因是变量`multi`是 type `int *`，而不是`int **`。您的函数`int **`通过将其取消引用两次来将其视为`*(*(multi + i ) + j)`

分解表达式：

1.  `*(multi + i)`取消引用指针`multi+i`。因为`multi`是 type `int *`，这很好。结果类型是`int`.
2.  `*( ... + j)`试图取消引用`... + j`. 问题在于，`...`是类型`int`，而且`... + j`是类型`int`。你不能取消引用`int`（它是一个整数类型，而不是一个指针）。

两种解决方案：

1.  声明`multi`为 type `int **`，并传入一个实际的`int **`
2.  保留`multi`并`int *`使用单索引寻址

解决方案 1 仅在您分配 的数组`int *`然后填充它以指向的数组时才有效`int`。如果您在 C 中声明一个多维数组（即） ，它将**不起作用**`int myarray[23][78]`。在 C 中，声明的多维数组保存在连续的内存中，如果将其作为指向指针的指针传递给函数，则此信息会丢失。

第二种解决方案是选择行优先或列优先索引，并传入相关大小。无论如何，您可能应该这样做。如果您选择行主要索引（行在内存中是连续的），则 M x N 矩阵`multi`被寻址为

```
multi[i + M*j] 
```

如果您选择列优先索引（列在内存中是连续的），则相同的矩阵被寻址为

```
multi[N*i + j] 
```

该解决方案**适用**于 C 中静态声明的多维数组，并允许您以最小的开销在 C 中动态分配多维数组。

另外，请注意 C 中静态声明的多维数组在以`mat[i][j]`. 但是，如果您正在做认真的矩阵工作，那么有充分的理由更喜欢行优先索引。最后，Fortran 使用行优先索引，如果您的代码需要与 Fortran 交互（就像数字代码经常做的那样），您可能应该更喜欢行优先索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:27:00.030

***(*** **(multi+0)+1)**没有**问题。***它会起作用的。请指定完整代码以找出错误。*

 *[参考链接](http://www.cs.cmu.edu/~ab/15-123S09/lectures/Lecture%2006%20-%20%20Pointer%20to%20a%20pointer.pdf "关联")*

# repository - 如何使用 Oracle ADF 在 EAR 文件中设置目标 MDS

> ID：11208139
> 
> 赞同：1
> 
> 时间：2012-06-26T13:16:47.400
> 
> 标签：repository, metadata, jdeveloper, oracle-adf

我想在运行时使用 Oracle ADF 启用用户自定义。使用 JDeveloper，如果我将我的应用程序直接部署到服务器，一个窗口允许我选择以前在我的 Enterprise Manager 上注册的存储库，如下图所示：

![MDS 选择](../Images/d0e94ff3302c83ab5bfbb23c34adf803.png)

通过这种方式，我的应用程序运行良好。现在我将部署到 EAR 文件（以保存我的版本的副本），但我不知道如何定位 MDS 存储库。在网上我发现可能必须修改 adf-config.xml 文件，但是以哪种方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T16:50:25.567

看看这个博客条目，它解释了如何做到这一点。显然需要在 EAR 文件部署时提供此信息

[http://andrejusb.blogspot.de/2011/05/target-mds-repository-for-adf.html](http://andrejusb.blogspot.de/2011/05/target-mds-repository-for-adf.html)

# python - python：行中的条件值大于语句

> ID：11208143
> 
> 赞同：1
> 
> 时间：2012-06-26T13:17:07.377
> 
> 标签：python, text, conditional

Python初学者在这里。我有一个按列排序的文本文件：

```
 fields = line.split("\t") 
```

我试图询问第 3 到 23 列中的任何值是否大于 95。所有列都包含单个浮点数，例如 94.522342 或 99.2321321。到目前为止我所拥有的似乎不起作用：

```
 if (int(fields(3:23)) >= 95): 
```

当我试图要求检查每一列时，我认为问题出在 (3:23) 部分。

任何帮助都非常感谢，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T13:19:10.720

您的代码有两个问题： 您正在将列表与数字进行比较，这并没有给出有意义的结果。您正在使用`int()`解码浮点数 -`float()`改为使用：

```
if any(float(x) >= 95 for x in fields[3:23]): 
```

请注意，这将检查第四列（索引 3）到第 23 列（索引 22）。根据需要调整切片。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:19:19.503

它的`fields[3:23]`，这会返回一个列表，您不能将列表与整数进行比较

由于您是 python 新手，我建议使用 for 循环：

```
for x in fields[3:23]:
    if float(x)>=95:
        #do_something here
    else:
           #do something else 
```

或者一个班轮将是：

`if max(map(float,fields[3:23]))>=95`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T13:19:33.473

使用[`any`内置](http://docs.python.org/library/functions.html#any)：

```
if any(map(lambda x: float(x) >= 95, fields[3:23])): 
```

我们做了几件事：

1.  使用切片运算符检索正确的列
2.  将所有这些值映射到布尔值（针对 95 测试 float()）
3.  检查所有测试结果是否为真。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T13:20:56.883

如果您只想要任何价值，请尝试：

```
if max(fields[3:23]) > 95: 
```

# android - 如何在android中仅以横向模式播放视频

> ID：11208144
> 
> 赞同：1
> 
> 时间：2012-06-26T13:17:07.647
> 
> 标签：android, video, orientation, landscape

在这里，我正在开发一个仅以横向模式播放视频的应用程序。我在 AndroidManifest.xml 文件中将我的活动方向设置为“横向”，我的视频播放得非常好，但问题是我将设备保持在横向模式，当我将设备旋转到 180 角时，我的视频播放是颠倒的（底部到达顶点）。它不是根据那个来变化的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:25:59.470

如果您的目标是 android 版本 2.3 或更高版本，请在 onCreate 中使用以下内容

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR_LANDSCAPE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:51:04.920

如果您正在为 android 2.2 及以下版本进行开发，则必须旋转内容视图画布。这是两个类似的问题，它们暗示了类似的事情。

[如何显示旋转约 180 度的 Android UI 元素](https://stackoverflow.com/questions/3866976/how-to-display-android-ui-elements-about-180-degrees-rotated)

[如何在 Android 中使用 textview 显示颠倒的文本？](https://stackoverflow.com/questions/2558257/how-can-you-display-upside-down-text-with-a-textview-in-android)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-12T20:15:54.533

您可以像这样从清单文件中执行以下操作：

```
<activity android:name=".Video" android:screenOrientation="userLandscape"> 
```

# javascript - cufon 字形支持

> ID：11208149
> 
> 赞同：0
> 
> 时间：2012-06-26T13:17:33.813
> 
> 标签：javascript, font-face, cufon, glyph

我对 cufon 和一些土耳其字形有疑问。这是上下文：

我使用@font-face 属性在网站上嵌入了自定义字体（Delicious-Roman）。客户不喜欢字体是每个页面上最后一个加载的字体（font-face 的常见问题），所以我切换到 cufon。当我使用 font-face 时，所有字符都可以正常工作，但是当我使用 cufon 时，一些字形停止工作（它们根本不会出现在页面上）。我打开 Photoshop 来测试字体，确实它没有那些土耳其字符（ğĞİşŞ）。

1.  为什么 font-face 属性设法显示所有字符，即使字体没有它们？
2.  如何将这些土耳其字符 (ğĞİşŞ) 添加到 cufon？

我在 cufon 网站上尝试了“......以及这些单个字符”选项，但没有奏效。我只是在该文本字段中插入了字符 - ğĞİşŞ。那是对的吗？

如果没有办法将这些字形添加到 cufon，那么将它们直接添加到我使用的字体中的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T09:45:11.040

我发现最简单的方法是简单地将丢失的字符包含在字体中并重新使用 cufon。对于这个任务，我使用了[Glyph 应用程序](http://glyphsapp.com)- 演示版可以完美运行 30 天，您可以不受限制地导出字体。

# variables - ColdFusion：获取变量类型

> ID：11208155
> 
> 赞同：26
> 
> 时间：2012-06-26T13:17:42.390
> 
> 标签：variables, types, coldfusion

ColdFusion`<cfdump />`标签给我的信息比 PHP 函数少得多`var_dump()`。

CF 中是否还有其他可能性可以找出我的变量是什么类型（整数、字符串等）？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-06-26T14:21:57.653

CFML 是动态类型的，因此类型可以根据需要更改。

`<cfdump var=#getMetadata(var)# />`您可以通过执行或简单地访问来查看变量的当前（JVM）类型`getMetadata(var).getName()`。

通常，您不关心某事物是否是特定类型，而是它是否*可以*自动转换为特定类型 - 因此，存在包括[isSimpleValue](http://cfdocs.org/issimplevalue)、[isNumeric](http://cfdocs.org/isnumeric)、[isDate](http://cfdocs.org/isdate)和[各种其他](https://web.archive.org/web/20130412212959/http://cfdocs.org/decision-functions)函数在内的函数。

因此，如果调用`isNumeric(string)`返回 true，那么您就知道可以将该变量用于数学目的。

在大多数情况下，这就是普通 CF 开发人员关心的全部内容，而这个答案的其余部分可能并不重要（但当然可能仍然很有趣）。

## ColdFusion 和类型

如果您有理由直接处理类型，则需要注意 Adob​​e ColdFusion 对类型做了一些有趣的事情——`<cfset number = 123 />`结果是*字符串*而不是数字类型。

事实上，ACF 中的大多数简单值都是作为字符串创建的（然后在需要时自动转换为相关类型）。

同时，并不是所有的简单值都存储为字符串——如果你这样做了，`<cfset number = 1 + 1 />`那么你会得到一个数字。

您可以看到此代码使用的类型：

```
<cfset TypeTest =
    { array   = []
    , struct  = {}
    , string  = "123"
    , number  = 123
    , boolean = true
    , date    = Now()
    , number2 = 1+1
    }/>

<cfloop item="key" collection=#TypeTest# >
    <cfoutput><br/> #key# = #getMetadata(typetest[key]).getName()#</cfoutput>
</cfloop> 
```

这段代码在CF10中的结果是这样的：

```
ARRAY = coldfusion.runtime.Array
STRUCT = coldfusion.runtime.Struct
STRING = java.lang.String
NUMBER = java.lang.String
BOOLEAN = java.lang.String
DATE = coldfusion.runtime.OleDateTime
NUMBER2 = java.lang.Double 
```

这种冗长解释的原因是，如果 CF 在您转储时显示类型，则一半时间它会说“字符串”，不一定很有用。

### 解决方法

如果您需要知道 [潜在] 类型，那么您需要创建自己的转储标签/函数，它利用上述转换检查功能来确定您正在查看的内容并输出相关信息。

## Railo 和类型

正如[Busches 的评论](https://stackoverflow.com/questions/11208155/coldfusion-get-variable-type#comment14715776_11208343)中所提到的，[Railo](http://getrailo.org)（另一种 CFML 引擎）在您转储时确实会显示类型，并且会显示正确的类型。

这是因为 Railo 不仅将（几乎）所有内容都转换为字符串 - 它从相关类型开始，并在需要时进行转换。

为了显示这一点，您可以运行上面的代码片段，以下是针对 Railo 3.3 运行的结果：

```
ARRAY = railo.runtime.type.ArrayImpl
STRUCT = railo.runtime.type.StructImpl
STRING = java.lang.String
NUMBER = java.lang.Double
BOOLEAN = java.lang.Boolean
DATE = railo.runtime.type.dt.DateTimeImpl
NUMBER2 = java.lang.Double 
```

如果你想要一个简单的单词类型，你可能会得到一个合理的值：

```
ListLast(type,'.').replaceAll('Impl$','') 
```

（没有具体的 Java->CFML 转换函数——你可以通过[查看相关的源代码](https://github.com/getrailo/railo/blob/master/railo-java/railo-core/src/railo/runtime/dump/DumpUtil.java)来了解 cfdump 的类型标记是如何完成的。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-26T13:27:00.640

CF 中的变量是无类型的。正确使用它们取决于开发人员的最佳实践，但无论变量是整数还是字符串，CF 都会以相同的方式对待它们。

对于结构或数组或组件/函数，可通过 CFDUMP 获得更多详细信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-10-20T05:24:47.010

这是一个稍微更新的版本。这包括额外的 ColdFusion 结构数据类型

```
<cfscript>
 TypeTest = {array   = []
    , struct  = {}
    , orderedstruct = [:]
    , sortedstructNumeric = StructNew("ordered","numeric")
    , sortedstructText = StructNew("ordered","text")
    , string  = "123"
    , number  = 123
    , boolean = true
    , date    = Now()
    , number2 = 1+1
    };

TypeTest.each(function(key, value) {
    TypeTest[key] = {"value" : value,  "meta" : getMetadata(value).getName() };
    });

writedump(TypeTest);
</cfscript> 
```

**结果**

[![在此处输入图像描述](../Images/8d348bb8bf7a833254ead5ea3ade0388.png)](https://i.stack.imgur.com/TASjB.png)

# php - 是否有任何预定义的函数可以在 mysql 中获取先前的值？

> ID：11208158
> 
> 赞同：0
> 
> 时间：2012-06-26T13:17:45.573
> 
> 标签：php, mysql

简单的例子：

```
ID     NAME  
-----------   
1      Test  
2      Test1 
```

我更新`Test1`到`Test3`.

现在结果是：

```
ID    NAME  
----------  
1     Test  
2     Test3 
```

更新字段后，`NAME`我想要`Test1`指定字段的上一个值。是否有任何预定义的功能可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:46:28.553

如果您想永久访问以前的值，一个选项是通过在同一个表中添加一行“oldName”来将它存储在数据库中。您甚至可以使用触发器在更改名称时系统地备份名称：

```
DELIMITER $$
CREATE TRIGGER `backup_name` BEFORE UPDATE ON `table1`
FOR EACH ROW BEGIN
    IF NEW.name <> OLD.name THEN
    SET NEW.oldName = OLD.name;
    END IF
END$$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T16:40:03.120

一个混乱的答案将包括添加一个名为 LAST_NAME 或类似名称的列：

```
UPDATE TABLE SET LAST_NAME=NAME,NAME = 'New Name' WHERE ID = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:21:19.437

不在 sql 中，如果您使用其他语言（例如 PHP）进行更新，您可以存储值然后更新，这样您仍然可以使用旧值。但正如有人在评论中提到的那样，一旦提交，数据就会丢失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:21:34.243

我不认为mysql有这样的功能。

查看 mysql 的事务并尝试在事务之前获取`COMMIT`值

句法：

```
BEGIN TRANSACTION
...
END 
```

# jquery - jQuery UI Auto 建议选择问题

> ID：11208162
> 
> 赞同：2
> 
> 时间：2012-06-26T13:17:51.297
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

我正在使用[http://jqueryui.com/demos/autocomplete/#default](http://jqueryui.com/demos/autocomplete/#default)

我的数据

```
[{"icd_ID":"2","icd_code":"A00","icd_desc":"Cholera","icd_yn":"N"},
        {"icd_ID":"3","icd_code":"A00.0","icd_desc":"Cholera due to Vibrio cholerae 01, biovar cholere","icd_yn":"Y"},
        {"icd_ID":"4","icd_code":"A00.1","icd_desc":"Cholera due to Vibrio cholerae 01, biovar eltor","icd_yn":"Y"},
        {"icd_ID":"5","icd_code":"A00.9","icd_desc":"Cholera, unspecified","icd_yn":"Y"}
        ] 
```

对于“icd_desc”自动建议值，我想获得“icd_code”。

jsfiddle 链接： http: [//jsfiddle.net/ajaypatel_aj/P ​​Rnc9/](http://jsfiddle.net/ajaypatel_aj/PRnc9/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:50:08.770

如果您使用的是本地数据源，我会转换该数据源以符合小部件的预期：

```
var source = $.map(availableTags1, function (el) {
    return {
        label: el.icd_desc,
        value: el.icd_code
    };
 });

 $("#tags").autocomplete({
    source: source
 }); 
```

**示例：http:** [//jsfiddle.net/sXaZX/](http://jsfiddle.net/sXaZX/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T06:56:11.973

您是否使用服务器端脚本对此进行编码？当您请求页面时，本地数据在响应中吗？所以只需拆分 10 个项目

# c# - html或pdf在服务器端打印c#

> ID：11208167
> 
> 赞同：4
> 
> 时间：2012-06-26T13:18:03.837
> 
> 标签：c#, wcf, printing, server-side, ghostscript

我知道它是许多论坛和博客中的一个已知主题。我读了很多文章。他们中的许多人都安静地提供信息。但对我来说，似乎需要新的方法来完成这项任务。

我正在寻找在服务器端打印 html 的解决方案。但是在使用了许多选项后，我意识到我们

1.  不能给出打印机名称或
2.  它打印 html 原始内容，如 txt 文件

后来知道ghostscript（[https://stackoverflow.com/a/2600189/1238159](https://stackoverflow.com/a/2600189/1238159)）可以用来在服务器端静默打印PDF。

还尝试使用水晶报告（但如何动态地将 HTML 内容传递给它，即使它不支持许多标签）、itextsharp、ssrs、pdfsharp 等，但它们都不支持许多 HTMl 标签和 W3C 标准。所以我在某一时刻结束了生成PDF。只有 wkhtmltopdf 非常适合将 html 转换为 pdf。根据我的经验，它支持每个 html 标签，这与其他任何标签都不一样。但是打印 PDf 对我来说是多年以来的问题。

但是现在即使使用 GhostScript（我使用的是 9.05 版）也面临一个问题。使用 localhost 我可以完美地使用它。我可以在服务器端以静默方式打印来自 UI 的任何打印机名称。但使用 IP 地址或机器名称无法正常工作。我什至实施了模拟。即使进程在调用 GhostScript 时挂起。

现在我想弄清楚的是

1.  是否可以在服务器端打印 html 或 pdf（实际内容）？
2.  任何开源工具都可以实现这一目标
3.  我想动态传递的打印机名称

任何线索或解决方法都可能帮助全球数小时的人。:)

提前谢谢了。

问候， 帕万 N

在使用了刘的建议后。我能够在命令提示符下执行此操作（意味着 cmd.exe 在我的帐户下运行）。但我的应用程序将在网络服务下运行。现在我遇到了一个问题，这种[访问被拒绝](https://stackoverflow.com/q/121676/1238159)

是的。最后我能够开始这个过程。并且能够使用我的域凭据在任务管理器下查看我的 gswin32c.exe 进程。代码如下：

```
public bool PrintVSPDF(string ghostScriptPath, int numberOfCopies, string printerName, string pdfFileName)
{
    Logger.AddToLog("printerName", printerName);
    string impersonationUsername = "";
    string impersonationDomain = "";
    string impersonationPWD = "";

    if (ConfigurationManager.AppSettings["UName"] != null)
    {
        impersonationUsername = Encryption.Decrypt(ConfigurationManager.AppSettings["UName"].ToString(), Encryption.DEFAULT_KEY, Encryption.DEFAULT_SEED);
        impersonationDomain = impersonationUsername.Split('\\').Count() > 1 ? impersonationUsername.Split('\\')[0] : "";
        impersonationUsername = impersonationUsername.Split('\\').Count() > 1 ? impersonationUsername.Split('\\')[1] : impersonationUsername.Split('\\')[0];
    }

    if (ConfigurationManager.AppSettings["PD"] != null)
    {
        impersonationPWD = Encryption.Decrypt(ConfigurationManager.AppSettings["PD"].ToString(), Encryption.DEFAULT_KEY, Encryption.DEFAULT_SEED);
    }

    using (Impersonation imp = new Impersonation(impersonationUsername, impersonationDomain, impersonationPWD))
    {
        ProcessStartInfo startInfo = new ProcessStartInfo();
        startInfo.Arguments = "-dPrinted -dNoCancel -dNOPAUSE -dBATCH -dNumCopies=" + Convert.ToString(numberOfCopies) + "  -sDEVICE=mswinpr2 -sOutputFile=%printer%\"" + printerName + "\" \"" + pdfFileName + "\" ";
        startInfo.FileName = ghostScriptPath;
        startInfo.UseShellExecute = false;
        startInfo.CreateNoWindow = true;
        //startInfo.RedirectStandardInput = true;
        startInfo.RedirectStandardError = true;
        startInfo.RedirectStandardOutput = true;
        startInfo.WindowStyle = ProcessWindowStyle.Hidden;
        startInfo.UserName = impersonationUsername;
        startInfo.Domain = impersonationDomain;
        SecureString ss = new SecureString();
        for (int i = 0; i < impersonationPWD.Length; i++)
        {
            ss.AppendChar(impersonationPWD[i]);
        }
        startInfo.Password = ss;
        Process process = null;
        try
        {
            process = Process.Start(startInfo);
            //Logger.AddToLog("Error VS", process.StandardError.ReadToEnd());
            //Logger.AddToLog("Output VS", process.StandardOutput.ReadToEnd());
            //Logger.AddToLog(process.StartInfo.Arguments.ToString(), "VS Print Arguments");
            //Console.WriteLine(process.StandardError.ReadToEnd() + process.StandardOutput.ReadToEnd());
            //Logger.AddToLog(process.StartInfo.FileName.ToString(), "VS Print file name");
            process.WaitForExit(30000);
            if (process.HasExited == false) 
                process.Kill();
            int exitcode = process.ExitCode;
            process.Close();
            return exitcode == 0;
        }
        catch (Exception ex)
        {
            Logger.AddToLog(ex);
            return false;
        }
    }
} 
```

但是该过程在 localhost:5030 中运行良好，即在我的视觉工作室运行时。但带有 IP 地址或机器名称。它只是挂起并引发此错误

adobe reader、foxit等也发生了同样的事情。

```
( Process must exit before requested information can be determined. :    at System.Diagnostics.Process.EnsureState(State state)
at System.Diagnostics.Process.get_ExitCode() ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:50:32.840

我一直在做一个正在做这个的项目。这是一次非常令人沮丧的经历。我发现最可靠的方法是将我的报告导出为 PDF，然后通过 Diagnostics.Process 使用 Foxit Reader（由于安全问题而不是 Adob​​e Reader）来打印文档。

打印机名称可以提供给 Foxit Reader 命令行参数。

我正在使用的环境是 Windows Server 2008 R2 x64 上 IIS 7 上的 ASP.net 3.5。我也在使用 Sql Server Reporting Services。

也许这段代码会帮助你：

```
 public FileContentResult GetPOReport(DataTable reportData, int poNumber, string copies, out string fileName, out string downloadPath)
    {
        fileName = "PO_" + poNumber.ToString().Trim() + "_" + DateTime.Now.ToString("yyyy-MM-dd_HH-mm-ss") + ".pdf";
        downloadPath = "/Generated/" + fileName;

        var outputFiles = new Dictionary<string, string>
                              {
                                  {"", Server.MapPath("~" + downloadPath)}
                              };

        if (!string.IsNullOrWhiteSpace(copies))
        {
            var copyList = copies.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries);

            foreach (var temp in copyList)
                outputFiles.Add(temp, Server.MapPath("~" + "/Generated/" + temp.Trim() + ".pdf"));
        }

        FileContentResult returnFile = null;

        foreach (var outputFile in outputFiles)
        {
            var file = WriteReportToDisk(reportData, outputFile.Value, outputFile.Key);

            if (file == null)
                continue;

            if (string.IsNullOrWhiteSpace(outputFile.Key))
                returnFile = file;
            else
                PrintReport(outputFile.Value);
        }

        return returnFile;
    }

    public void PrintReport(string filePath)
    {
        try
        {
            if (!ConfigurationManager.AppSettings.AllKeys.Contains("AdobeReaderPath") ||
                !ConfigurationManager.AppSettings.AllKeys.Contains("AdobePrintParameters") ||
                !ConfigurationManager.AppSettings.AllKeys.Contains("PrinterName"))
                return;

            var adobeReaderPath = ConfigurationManager.AppSettings["AdobeReaderPath"].Trim();
            var adobePrintParameters = ConfigurationManager.AppSettings["AdobePrintParameters"].Trim();
            var printerName = ConfigurationManager.AppSettings["PrinterName"].Trim();
            var printProcessDomain = ConfigurationManager.AppSettings["PrintProcessDomain"].Trim();
            var printProcessUserName = ConfigurationManager.AppSettings["PrintProcessUserName"].Trim();
            var printProcessPassword = ConfigurationManager.AppSettings["PrintProcessPassword"].Trim();

            var userPrinter = Entities.UserPrinters.FirstOrDefault(p => p.UserName == User.Identity.Name);

            if (userPrinter != null)
                printerName = userPrinter.PrinterName.Trim();

            using (var process = new Process
            {
                StartInfo =
                    new ProcessStartInfo(
                    adobeReaderPath,
                    string.Format(adobePrintParameters, filePath, printerName)
                    )
            })
            {
                if (!string.IsNullOrWhiteSpace(printProcessUserName))
                {
                    if (!string.IsNullOrWhiteSpace(printProcessDomain))
                        process.StartInfo.Domain = printProcessDomain;

                    process.StartInfo.UserName = printProcessUserName;

                    var securePassword = new SecureString();

                    foreach (var passwordCharacter in printProcessPassword)
                        securePassword.AppendChar(passwordCharacter);

                    process.StartInfo.Password = securePassword;

                    process.StartInfo.UseShellExecute = false;
                    process.StartInfo.CreateNoWindow = true;

                    process.StartInfo.LoadUserProfile = true;
                }

                process.Start();

                process.WaitForExit(30000);
            }
        }
        catch (Exception exception)
        {
            EventLog.WriteEntry("PO Suggestion Viewer", string.Format("PO Suggestion Viewer Error:\n{0}", exception.Message));
            throw;
        }
    }

    public FileContentResult WriteReportToDisk(DataTable reportData, string filePath, string copy)
    {
        var webReport = new WebReport()
        {
            ExportFileName = "PO Report",
            ReportPath = Server.MapPath("~/Reports/PurchaseOrderReport.rdlc")
        };

        if (!string.IsNullOrWhiteSpace(copy))
            webReport.ReportParameters.Add(new ReportParameter("Copy", copy));

        if ((User != null) && (User.Identity != null) && (User.Identity.Name != null))
            webReport.ReportParameters.Add(new ReportParameter("User", User.Identity.Name));

        webReport.ReportDataSources.Add(new ReportDataSource("ReportData", reportData));

        var report = webReport.GetReport();

        Response.AddHeader("content-disposition", string.Format("attachment; filename={0}.{1}", webReport.ExportFileName, webReport.FileNameExtension));
        Response.ContentType = "application/pdf";

        var file = File(report, webReport.MimeType, "POReport");

        System.IO.File.WriteAllBytes(filePath, file.FileContents);

        return file;
    } 
```

我的 web.config 包含：

```
<appSettings>
    <add key="webpages:Version" value="1.0.0.0" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
    <add key="AdobeReaderPath" value="C:\Program Files (x86)\Foxit Software\Foxit Reader\Foxit Re-ader.exe" />
    <add key="AdobePrintParameters" value="-t &quot;{0}&quot; &quot;{1}&quot;" />
    <add key="PrinterName" value="HP_Office" />
    <add key="PrintProcessDomain" value="DOMAIN_NAME" />
    <add key="PrintProcessUserName" value="DOMAIN_USER" />
    <add key="PrintProcessPassword" value="DOMAIN_PASSWORD" />
</appSettings> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T05:44:05.960

抱歉，迟到了。我教过我已经回答了这个问题。我找到了将 html 转换为 pdf 的解决方法。我正在使用 WKHTMLTOPDF API 将 html 转换为 pdf。与那里的许多商业产品相比，它看起来很棒。能够获得彩色/灰度、边距、索引。还有很多。

这是我关注的链接 [http://code.google.com/p/wkhtmltopdf/](http://code.google.com/p/wkhtmltopdf/)

```
ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.FileName = AppDomain.CurrentDomain.BaseDirectory + @"\bin\wkhtmltopdf.exe";
pdfFile = localReportPath + "\\Reports\\Savedfiles\\" + filename + ".pdf";
//Ref: http://madalgo.au.dk/~jakobt/wkhtmltoxdoc/wkhtmltopdf-0.9.9-doc.html
startInfo.Arguments = " --minimum-font-size 16 --margin-left 10mm --margin-right 10mm --zoom 3 " + htmlFile + " " + pdfFile;
startInfo.WindowStyle = ProcessWindowStyle.Hidden;
Process p = Process.Start(startInfo);
p.WaitForExit();
p.Dispose();
p.Close(); 
```

同样，我发送给 ghostscript 以获得一个漂亮的 TIFF 文件用于传真。数据量大时性能也不错。

问候， 帕万 N

# jquery - 不同类中的jQuery动画高度

> ID：11208170
> 
> 赞同：0
> 
> 时间：2012-06-26T13:18:23.670
> 
> 标签：jquery

是否可以像我的情况“.bar1”一样在不同的类中拥有动画高度？？？

`$('.bar1').animate({'height':'58%'},1000);`

只是为了了解我的意思：**'.bar_graf'**

`$('.bar1').animate({'.bar_graf'.'height':'58%'},1000);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:38:38.747

`<div>`-s 里面`<strong>`-s 无效，因此需要修复它

```
<div class="graph">
    <strong class="bar1"></strong>
    <div class="tooltip">18%</div>
</div> 
```

然后工具提示变得相对定位到`.graph`，我们可以调整它的垂直位置：

```
var my = event.pageY - 100; 
```

结果 - [http://jsfiddle.net/Dun7q/17/](http://jsfiddle.net/Dun7q/17/)

# c - 文本区域的大小

> ID：11208171
> 
> 赞同：1
> 
> 时间：2012-06-26T13:18:24.540
> 
> 标签：c, gcc, memory-layout

考虑以下程序：

```
#include <stdio.h>

int main(void)
{
    return 0;
} 
```

当我运行以下命令时：

```
gcc memory-layout.c -o 内存布局    
大小内存布局

```

我得到的输出为：

```
文本数据 bss dec 十六进制文件名    
960 248 8 1216 4c0 内存布局

```

由于文本区域包含程序的可执行指令，为什么输出显示文本区域的大小为 960，据我所知，这相对于指令的大小来说太大了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:24:54.243

原因可能是因为程序的*实际*启动并不是真正的`main`函数，而是在链接阶段添加的一段代码。此代码在调用您的函数之前设置库、清除`BSS`段和其他初始化`main`。还有一些代码可以确保在您从`main`.

# c# - NHibernate、Oracle 和表空间

> ID：11208175
> 
> 赞同：1
> 
> 时间：2012-06-26T13:18:41.527
> 
> 标签：c#, .net, oracle, nhibernate, fluent-nhibernate

我能够在 Oracle 数据库中生成表，但它们是在默认表空间中生成的。

有谁知道如何使用 NHibernate（或您最喜欢的流畅映射 API）指定应该在哪个表空间上创建？

如果我手动创建表（**在创建时指定表空间**），我随后可以通过 NHibernate 和我的 C# 代码将数据插入其中。

通过 NHibernate 生成表，然后尝试插入数据，我收到以下错误：

```
NHibernate.Exceptions.GenericADOException: could not insert: [Some.Namespace.Core.MyObjectTable#fba3213d-bf7d-11e1-b71d-005056a80403][SQL: INSERT INTO "MyObjectTable" (Col1, Col2, Col3) VALUES (?, ?, ?)] 
```

除了内部例外：

```
System.Data.OracleClient.OracleException: ORA-01950: no privileges on tablespace 'THE_DEFAULT_TABLESPACE' 
```

当然有办法解决这个问题......？我对 SQL Server 没有这样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T04:36:57.917

您需要表空间的配额。例如，您可以从 dba 帐户运行以下语句：

```
alter user <myuser> quota 5m on tablespace the_default_tablespace; 
```

# java-me - com.sun.lwuit.Form.show() 和 com.sun.lwuit.Form.showBack() 有什么区别？

> ID：11208180
> 
> 赞同：1
> 
> 时间：2012-06-26T13:19:02.670
> 
> 标签：java-me, lwuit, mobile-application, midp-2.0, lwuit-form

`com.sun.lwuit.Form.show()`和 和有什么不一样`com.sun.lwuit.Form.showBack()`？我认为两者都是显示形式。我认为两者都是一样的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T11:39:17.933

如果您选择 form.Show() 表单将从显示的右侧滑入并移动到左侧（默认情况下。）

如果您选择 form.showBack()，表单将从显示屏的左侧滑入并移动到右侧（默认情况下。）

您也可以反转过渡方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:25:35.250

[在这里](http://lwuit.java.net/javadocs/com/sun/lwuit/Form.html#show%28%29)和[这里](http://lwuit.java.net/javadocs/com/sun/lwuit/Form.html#showBack%28%29)你可以看到不同之处。showBack 也显示表单，但它反转了过渡的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T06:16:00.273

在我个人使用中，我用于`Form.show()`显示新表单，`Form.showback()`用于显示先前显示的表单，其中用户填充的数据作为缓存。

# objective-c - iOS 中是否有类似 Quick Look 图标的标准库？

> ID：11208183
> 
> 赞同：1
> 
> 时间：2012-06-26T13:19:09.160
> 
> 标签：objective-c, ios, frameworks, icons, thumbnails

我需要在应用程序的文档文件夹中列出文件夹的内容，并想知道 iOS 框架中是否存在返回 UIImage 或特定文件的内容的组件。

所以，正如标题所说；是否有可以使用的标准框架，或者我必须自己推出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:23:42.157

在我的脑海中，创建一个实例`UIDocumentInteractionController`，并查询它的`icons`属性：

```
- (UIImage *)iconForFile: (NSURL *)fileURL {
    UIDocumentInteractionController *controller = [UIDocumentInteractionController interactionControllerWithURL: fileURL];
    if (controller) {
        return [controller.icons lastObject]; // arbitrary selection--gives you the largest icon in this case
    }

    return nil;
} 
```

我不知道如何在不使用`UIDocumentInteractionController`头顶的情况下获取图标。

请注意，这会为您提供文件的文档图标，而*不是*预览。iOS 中没有内置的预览机制。

# mongodb - mongodb 在 EC2 上达到磁盘已满，最佳实践是什么？

> ID：11208184
> 
> 赞同：0
> 
> 时间：2012-06-26T13:19:09.597
> 
> 标签：mongodb, amazon-ec2

在 EC2 微实例上运行的 Mongodb 达到磁盘已满。我有什么选择？

1.  附加一个新的 EBS？
2.  创建一个新实例？
3.  创建分片？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:37:45.830

如果之前性能不是问题，最简单的方法是附加一个新的 ESB，然后停止 mongo 移动新磁盘上的数据并使用新的 --dbpath 重新启动 mongo。

当然，如果您想提高性能并为您的解决方案增加一些复杂性，请创建一个新的分片，但您需要仔细检查您的代码是否是分片证明:)（例如：[MapReduce 和分片环境](http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-ShardedEnvironments)）

# php - 像 Flickr 一样的分页

> ID：11208187
> 
> 赞同：0
> 
> 时间：2012-06-26T13:19:12.773
> 
> 标签：php, arrays, pagination

我最近遇到了我的分页问题，​​恰好有大约 100 页，所以显然我的分页变得很长。

现在我想通过删除一些链接来防止这种情况，所以而不是

```
1 - 2 - 3 - 4 - 5 - 6 - 7 - 8 - 9 - 10 
```

我想将其显示为

```
1 - 2 - 3 - 4 - 5 - ... - 10 
```

或者当你在第 4 页时

```
1 - ... - 4 - 5 - 6 - ... 10 
```

目前显示我的分页的脚本是这样的：

```
$links = array();
for($i = 0; $i < $totalPages; $i++) {
    array_push($links, $i);
    }

foreach($links as $pageLink) {
    if($pageLink == $page) {
    $pagination .= "<li><a href='" . BASE_URL . $url . $pageLink . ".html' class='active'>" . ($pageLink + 1) . "</a></li>";
    } else {
        if($pageLink === '...') {
            $pagination .= "<li><a href='#'>...</a></li>";
        } else {
            $pagination .= "<li><a href='" . BASE_URL . $url . $pageLink . ".html'>" . ($pageLink + 1) . "</a></li>";
        }
    }   
} 
```

我在一个数组中添加了所有链接，因此很容易调整它，但我不知道如何获得这样的分页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:45:22.777

不知何故，您可以获得当前页码和最后一页码。代表您当前页面的寻呼机项目应该与您的其他页面有所不同。如果您的页码小于或等于 3，则显示 1 2 3 ... LastPageNumber 并且如果您当前的页面大于或等于 LastPageNumber - 2，那么您的分页应该看起来像 1 ... 67 68 69。否则您的分页应该看起来像 1 ... 30 31 32 33 34 ... 69 （在本例中，您的当前页面为 32）。

# php - 允许用户下载 .html 和 .css 文件而不强制他们右键单击，另存为

> ID：11208194
> 
> 赞同：1
> 
> 时间：2012-06-26T13:19:17.130
> 
> 标签：php, html, css

我想允许用户使用 php 脚本下载 html 文件。

我知道这对于图像文件是可能的，但是对于 html/css 文件是否可能，如果不是，我如何压缩文件或其他东西，然后允许用户下载 zip？

他们只能通过 php 脚本访问 .html 文件。该文件将受密码保护。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T13:22:26.483

有可能，您只需要弄乱 PHP 标头即可。

```
header("Content-Type: application/force-download");
header("Content-Disposition: attachment; filename=\"filenamehere.html\"); 
```

您必须获取文件并通过 PHP 脚本传递它。

# asp.net - 拖放 GridView 和 ObjectDataSource 时处理分页的代码在哪里

> ID：11208197
> 
> 赞同：1
> 
> 时间：2012-06-26T13:19:26.103
> 
> 标签：asp.net, vb.net, gridview, objectdatasource

如果我将 GridView 和 ObjectDataSource 拖放到页面上，将它们连接起来，提取一些数据并让控件自动处理所有内容，告诉控件如何运行的代码在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:45:46.627

添加到 aspx 文件的服务器控件是 .NET 框架中的类的表示，其中包含与控件行为相关的所有逻辑。

# c# - 如果 DictA 键，值存在于 DictB 中，如何比较两个字典的值和增量计数？

> ID：11208199
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:19:30.970
> 
> 标签：c#, asp.net, dictionary, compare, match

我有两个字典 DictA 和 DictB，例如：

```
Dictionary<int, string> DictA = new Dictionary<int, string>();
DicA.add(1,"Mango");
DicA.add(2,"Grapes");
DicA.add(3,"Orange");

Dictionary<int, string> DictB = new Dictionary<int, string>();
DicB.add(1,"Mango");
DicB.add(2,"Pineapple"); 
```

如何比较这两个字典**DictA 键、值**与**DictB 键、值**的值，如果**找到匹配**，则*增加 COUNTER*变量。

注意：与 DicB EG 相比，DicA 可能包含许多行：DicA 有 3 行，DicB 有 2 行。如果 DicA 键、值与 DicB 键、值匹配（相似/相等），则将计数器变量加一！

任何建议..！帮助赞赏...！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:30:44.883

使用此代码：

```
int matches = DictA.Keys.Where(k => DictB.ContainsKey(k) && DictB[k] == DictA[k]).Count(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:33:44.943

你可以使用：

```
Dictionary<int, string> DicA = new Dictionary<int, string>();
DicA.Add(1,"Mango");
DicA.Add(2,"Grapes");
DicA.Add(3,"Orange");

Dictionary<int, string> DicB = new Dictionary<int, string>();
DicB.Add(1,"Mango");
DicB.Add(2,"Pineapple");

int counter = 0;

foreach (var pair in DicA)
{
     string value;

     if (DicB.TryGetValue(pair.Key, out value))
     {
          if (value == pair.Value)
          {
                counter++;
          }
     }
} 
```

# sorting - jqgrid - 更改为自定义排序 icos

> ID：11208204
> 
> 赞同：0
> 
> 时间：2012-06-26T13:19:56.197
> 
> 标签：sorting, jqgrid, icons

我正在使用 jqgrid 呈现网格，我想自定义排序图标，我们有一个 CMS，内容（包括箭头）由我们的客户控制。但是我通过 CSS 或代码（js）来做这件事都没有问题。目前我看到了固定的箭头，我唯一可以定制的是位置和外观（垂直/水平）。

我的需求： 1.sperate 的 asc 和 desc 图标（将是自定义图像）。2.每次点击出现一个图标（在图标之间切换）

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:51:38.320

网格从您的页面使用的 jQuery UI 主题接收图标。因此，您也许可以覆盖网格的 CSS 类来实现您的解决方案。用于排序的图标具有类`ui-icon-triangle-1-n`和`ui-icon-triangle-1-s`。

# .net - 如何确定 DLL 是否需要完整的 .NET 4 或仅需要客户端配置文件

> ID：11208208
> 
> 赞同：5
> 
> 时间：2012-06-26T13:20:22.670
> 
> 标签：.net, dll, .net-4.0, .net-client-profile

使用第三方程序集时，我需要一种方法来检测它们是否需要完整的 .NET 4 或仅需要 .NET 4 客户端配置文件。

我已经看到其他方法来检测引用的 .NET 版本[确定 dll 的 .NET Framework 版本，](https://stackoverflow.com/questions/3460982/determine-net-framework-version-for-dll)但该问题中概述的方法并未显示如何检测客户端配置文件与完整。是否可以？

我正在寻找任何解决方案，它不一定是代码/运行时解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:37:20.557

[**请注意**，以下解决方案特定于 .NET 4.0 框架，`TargetFrameworkAttribue`是 4.0 的新内容。]

我编译了两个应用程序，一个针对客户端框架，另一个针对完整。我在 ildasm.exe 中打开了它们，发现它们都有一个[`TargetFrameworkAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.versioning.targetframeworkattribute.aspx)应用程序。您可以简单地使用反射来查看值：

```
using System;
using System.Linq;
using System.Runtime.Versioning;

class Program
{
    static void Main(string[] args)
    {
        var a = System.Reflection.Assembly.GetExecutingAssembly();
        var att = a.GetCustomAttributes(false).OfType<TargetFrameworkAttribute>().Single();

        Console.WriteLine(att.FrameworkDisplayName);
        Console.Read();
    }
} 
```

**更新：**是的，确实，针对“.NET Framework 3.5 Client Profile”编译应用程序***不***包括该属性（代码不再能看到它并且 ildasm 没有它）。除了您链接的其他答案外，我不知道在这种情况下如何确定目标框架。

为了避免对您的代码库施加***我***认为毫无意义的限制，我会让生活更轻松，并简单地针对完整的框架。如果客户端具有安装客户端配置文件的权限，那么完整框架也是如此——它只是稍微大一点（我发现一个消息来源说它只大了 15%，从而否定了大部分“更小的客户端包”的好处, 41MB 而不是 48MB)。你的来电。

# php - 在 php 中传递 base64 编码的数据

> ID：11208214
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:20:53.933
> 
> 标签：php, base64, xss

我有一个通过 GET 接收 base64 编码数据的页面，它在隐藏的输入中打印数据，并通过 get 传递到另一个页面。

问题是这样的：当我通过

```
"Peuq/0X4XhFV+XNa8T06qFrP8lRadORUQBGJ1w6D4m33Jaqx/skKDEJIxjldBrcklboL/uB4C65cjz3BHMPmd3moEJ4GTK5k5Jwf9Ny4BA467bwgeaHJuOS+CjwFlIOzrhSWHTMVl4zWVvwMauuFAjhuMjOOj0/X5L12IcwGTTqLgHo" 
```

通过 GET 它变成

```
"Peuq/0X4XhFV XNa8T06qFrP8lRadORUQBGJ1w6D4m33Jaqx/skKDEJIxjldBrcklboL/uB4C65cjz3BHMPmd3moEJ4GTK5k5Jwf9Ny4BA467bwgeaHJuOS CjwFlIOzrhSWHTMVl4zWVvwMauuFAjhuMjOOj0/X5L12IcwGTTqLgHo" 
```

...所以 openssl 无法工作。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:29:17.453

Base64 可以输出`+`在 URL 中发送时被解释为空格的符号。您可以使用[urlencode](http://php.net/urlencode)来缓解这种情况：

```
<?php
$base64_data = $_GET['base64'];
$url_data = urlencode($base64_data);
$field_data = htmlspecialchars($url_data);
printf('<input type="hidden" value="%s" name="pass-it-on">', $field_data);
?> 
```

在第二页：

```
<?php
$base64_data = $_GET['pass-it-on'];
$real_data = base64_decode($base64_data);
?> 
```

请注意，无需解码您的`htmlspecialchars`调用`urlencode`，因为这是自动完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:03:15.753

URL 中的某些字符是特殊的，例如`+`代表空格。要通过 URL 发送任意数据，您需要对其进行*URL 转义*以避免数据中包含的字符被识别为“特殊字符”。由于您要将数据放入 HTML，因此您*还*需要对其进行 HTML 转义以避免 URL 编码数据中的字符被识别为特殊的 HTML 字符。因此：

```
$data = /* some data */;
$base64Data = base64_encode($data);
$urlData = urlencode($base64Data);
$htmlData = htmlspecialchars($urlData);
printf('<input type="hidden" value="%s" name="pass-it-on">', $htmlData); 
```

# javascript - 跨域调用，REST 库

> ID：11208228
> 
> 赞同：2
> 
> 时间：2012-06-26T13:21:59.580
> 
> 标签：javascript, api, rest, cross-domain

我正在尝试为我的应用程序使用外部 REST 库，我希望使用 javascript 将其保留在客户端。我无法控制 REST 库服务器，因此我无法修改服务器上的任何访问权限或任何内容。（它由 OAuth 保护）。

我的问题是：是否可以仅使用 javascript 连接 REST API？我一定会遇到跨域调用问题。从我收集的信息来看，使用 JSONP 是不可能的，因为我只能做 GET 而不能做 POST，对吧？另外，我对 JSONP 不太了解……是否也需要我对提供 API 的服务器进行一些更改？（在这种情况下我不能）。

有没有办法解决这个问题，还是我会被迫做一些服务器端编程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:26:49.670

现代浏览器有[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)。然后还有其他一些技巧，这里描述得很好：[绕过同源策略的方法](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)。

否则，您将不得不进行服务器端编程。

# .net-4.0 - SQL Server Comapct 4 和 Code-First Entity Framework 5 中的图像数据类型

> ID：11208229
> 
> 赞同：2
> 
> 时间：2012-06-26T13:21:59.360
> 
> 标签：.net-4.0, ef-code-first, sql-server-ce-4, entity-framework-5

我的 Code-First 实体列声明如下：

```
[Required, DataType("image")]
public byte[] Picture { get; set; } 
```

验证已关闭：

```
Configuration.ValidateOnSaveEnabled = false; 
```

并且是列类型仍然是`varbinary(4000)`.

当我尝试保存数据时，Entity Framework 抛出异常：

*字节数组截断到长度为 4000。*

如何声明 C#`byte[]`类型应该映射到`image`SQL 类型？

**版本：**

SQL Server 紧凑型 4

实体框架 5 RC

.NET 框架 4.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T14:12:12.250

使用此属性：

```
[MaxLength] 
```

# jquery - 使元素的宽度和高度填满屏幕

> ID：11208233
> 
> 赞同：1
> 
> 时间：2012-06-26T13:22:23.543
> 
> 标签：jquery, html, css

如果您在这里查看我的文档：http: [//featuredfotografer.com/](http://featuredfotografer.com/)

您会看到左侧有一个排水沟，并且 .Codemirror div 和 #header div 的宽度都没有填满屏幕。

我怎样才能用 css 或 jquery 做到这一点（如果我必须）？

我已经将 width:100% 和 height:100% 应用于相应的元素，但它不起作用。与覆盖它的 codemirror 插件有关，但我该如何控制？

**更新：**

宽度固定，高度呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:28:42.450

您的 docs.css 有一个`max-width: 64.3em`for 正文。

删除它，或设置`max-width: 100%`

```
#body { max-width: 100% }    
#header { position: fixed; z-index: 20 }    
.CodeMirror { padding-top: 32px } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:49:19.287

尽量避免在未来使用内联样式......让帮助变得很痛苦：\
无论如何，你去：

修改您的内联样式：

![在此处输入图像描述](../Images/f8af38f1f8e32de93d92789dcc5c3ab0.png)

更新 codemirror.css：

```
.CodeMirror {
line-height: 1.4em;
font-family: monospace;
font-size:12px;
pointer:text;

/* Necessary so the scrollbar can be absolutely positioned within the wrapper on Lion. */
position: relative;
/* This prevents unwanted scrollbars from showing up on the body and wrapper in IE. */
overflow: hidden;
height: 100%;
top: -33px;
}

.CodeMirror-scroll {
overflow-x: auto;
overflow-y: hidden;
/* This is needed to prevent an IE[67] bug where the scrolled content
is visible outside of the scrolling box. */
position: relative;
outline: none;
height:100%;
pointer:text;
}

/* Vertical scrollbar */
.CodeMirror-scrollbar {
float: right;
overflow-x: hidden;
overflow-y: scroll;

/* This corrects for the 1px gap introduced to the left of the scrollbar
by the rule for .CodeMirror-scrollbar-inner. */
margin-left: -1px;
}
.CodeMirror-scrollbar-inner {
/* This needs to have a nonzero width in order for the scrollbar to appear
in Firefox and IE9\. */
width: 1px;
}
.CodeMirror-scrollbar.cm-sb-overlap {
/* Ensure that the scrollbar appears in Lion, and that it overlaps the content
rather than sitting to the right of it. */
position: absolute;
z-index: 1;
float: none;
right: 0;
min-width: 12px;
}
.CodeMirror-scrollbar.cm-sb-nonoverlap {
min-width: 12px;
}
.CodeMirror-scrollbar.cm-sb-ie7 {
min-width: 18px;
}

.CodeMirror-gutter {
position: absolute; left: 0; top: 0;
z-index: 1;
background-color: #f7f7f7;
border-right: 1px solid #eee;
min-width: 2em;
height: 100%;
}
.CodeMirror-gutter-text {
color: #aaa;
text-align: right;
padding: .4em .2em .4em .4em;
white-space: pre !important;
}
.CodeMirror-lines {
padding: .4em;
white-space: pre;
cursor: text;
margin-top: 33px;
}
.CodeMirror-lines * {
/* Necessary for throw-scrolling to decelerate properly on Safari. */
pointer-events: none;
}

.CodeMirror pre {
-moz-border-radius: 0;
-webkit-border-radius: 0;
-o-border-radius: 0;
border-radius: 0;
border-width: 0; margin: 0; padding: 0; background: transparent;
font-family: inherit;
font-size: inherit;
padding: 0; margin: 0;
white-space: pre;
word-wrap: normal;
line-height: inherit;
color: inherit;
}

.CodeMirror-wrap pre {
word-wrap: break-word;
white-space: pre-wrap;
word-break: normal;
}
.CodeMirror-wrap .CodeMirror-scroll {
overflow-x: hidden;
}

.CodeMirror textarea {
outline: none !important;
}

.CodeMirror pre.CodeMirror-cursor {
z-index: 10;
position: absolute;
visibility: hidden;
border-left: 1px solid black;
border-right: none;
width: 0;
}
.cm-keymap-fat-cursor pre.CodeMirror-cursor {
width: auto;
border: 0;
background: transparent;
background: rgba(0, 200, 0, .4);
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#6600c800, endColorstr=#4c00c800);
}
/* Kludge to turn off filter in ie9+, which also accepts rgba */
.cm-keymap-fat-cursor pre.CodeMirror-cursor:not(#nonsense_id) {
filter: progid:DXImageTransform.Microsoft.gradient(enabled=false);
}
.CodeMirror pre.CodeMirror-cursor.CodeMirror-overwrite {}
.CodeMirror-focused pre.CodeMirror-cursor {
visibility: visible;
}

div.CodeMirror-selected { background: #d9d9d9; }
.CodeMirror-focused div.CodeMirror-selected { background: #d7d4f0; }

.CodeMirror-searching {
background: #ffa;
background: rgba(255, 255, 0, .4);
}

/* Default theme */

.cm-s-default span.cm-keyword {color: #708;}
.cm-s-default span.cm-atom {color: #219;}
.cm-s-default span.cm-number {color: #164;}
.cm-s-default span.cm-def {color: #00f;}
.cm-s-default span.cm-variable {color: black;}
.cm-s-default span.cm-variable-2 {color: #05a;}
.cm-s-default span.cm-variable-3 {color: #085;}
.cm-s-default span.cm-property {color: black;}
.cm-s-default span.cm-operator {color: black;}
.cm-s-default span.cm-comment {color: #a50;}
.cm-s-default span.cm-string {color: #a11;}
.cm-s-default span.cm-string-2 {color: #f50;}
.cm-s-default span.cm-meta {color: #555;}
.cm-s-default span.cm-error {color: #f00;}
.cm-s-default span.cm-qualifier {color: #555;}
.cm-s-default span.cm-builtin {color: #30a;}
.cm-s-default span.cm-bracket {color: #cc7;}
.cm-s-default span.cm-tag {color: #170;}
.cm-s-default span.cm-attribute {color: #00c;}
.cm-s-default span.cm-header {color: blue;}
.cm-s-default span.cm-quote {color: #090;}
.cm-s-default span.cm-hr {color: #999;}
.cm-s-default span.cm-link {color: #00c;}

span.cm-header, span.cm-strong {font-weight: bold;}
span.cm-em {font-style: italic;}
span.cm-emstrong {font-style: italic; font-weight: bold;}
span.cm-link {text-decoration: underline;}

div.CodeMirror span.CodeMirror-matchingbracket {color: #0f0;}
div.CodeMirror span.CodeMirror-nonmatchingbracket {color: #f22;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-02T16:22:09.930

要解决此问题，您应该使用 codemirror 文档 ( [http://codemirror.net/demo/resize.html](http://codemirror.net/demo/resize.html) ) 中建议的下一个样式：

```
.CodeMirror {
  border: 1px solid #eee;
  height: auto;
}
.CodeMirror-scroll {
  overflow-y: hidden;
  overflow-x: auto;
} 
```

完成后，您应该定义标签中的边距`body`，即，如果您有一个边框，`1px`您`body`应该定义`margin-bottom: 2px;`那里`margin-right: 2px;`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:28:21.333

添加`max-width:100% !important`到您的`html,body`CSS 作为 docs.css 从 codemirror`max-width:64em`在正文上设置 a 。

# android - 谷歌播放兼容性检查

> ID：11208234
> 
> 赞同：2
> 
> 时间：2012-06-26T13:22:24.417
> 
> 标签：android, android-emulator, google-play, android-compatibility

所以我正在开发一个 android 应用程序并希望将其发布到 Google Play。这些项目包含一些仅在 API 13 之后才受支持的方法（例如 Display.GetSize()）。我通过在运行时读取设备的操作系统并做出相应的决定来绕过这些限制，使我的项目向后兼容（例如，如果操作系统 <13 使用另一种方法获取屏幕尺寸）

即使我在清单中制作了 minSdk 7：

```
<uses-sdk android:minSdkVersion="7" /> 
```

每次我启动设备选择器来选择模拟器时，除了操作系统低于 API 13 的模拟器外，我都会看到一个*红十字。但无论如何，当我在其上运行该应用程序时，它运行良好。*

问题：当我将我的应用程序上传到 Google Play 时，运行低于 API 13 的设备是否能够下载我的应用程序？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:30:32.390

模拟器选择器中的红色标志是由于 android “项目构建目标”。当您将其更改为 2.1 即 SdkVersion=7 时，它不会出现（红色符号）。

关于市场，它应该不是任何问题。它肯定适用于在 API 13 以下运行的设备。

# java - 更改继承依赖项的依赖项

> ID：11208236
> 
> 赞同：2
> 
> 时间：2012-06-26T13:22:27.117
> 
> 标签：java, maven, jboss7.x

我正在将 JBoss AS 7 与 Maven 一起使用，并且还添加了 RichFaces，我几乎可以肯定，不要与 JBoss 一起使用。所以我将它添加到我的 pom.xml 中：

```
<dependency>
    <groupId>org.richfaces.core</groupId>
    <artifactId>richfaces-core-impl</artifactId>
    <version>4.1.0.Final</version>
    <scope>compile</scope>
</dependency> 
```

但是 Richfaces 也有它的依赖关系，所以`cssparser`也`sac`带有编译范围，但它们也在 JBoss AS 7 内部，所以当我运行 JBoss 时会出现以下警告：

```
Deployment "deployment.test.war" is using a private module ("org.w3c.css.sac:main") which may be changed or removed in future versions without notice.
Deployment "deployment.test.war" is using a private module ("net.sourceforge.cssparser:main") which may be changed or removed in future versions without notice. 
```

我相信出现这个警告是因为我的战争和 JBoss 都有这个模块，所以我想知道：有一种方法可以在我的 POM 中将它们的范围更改为提供？即使他们是遗传的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:38:15.433

不，您不能更改传递依赖项的范围。你能做的最好的就是`<exclusions>`在你的依赖声明中排除这些依赖。

# jquery - 使用 append 或 insertAfter 在某个类之后插入 html

> ID：11208238
> 
> 赞同：2
> 
> 时间：2012-06-26T13:22:33.387
> 
> 标签：jquery

我希望在某个标签之后动态添加一些内容到容器中，请看下面的代码

```
<div id="simpleContainer">
  <h2 class="hDestination">Destination(s)</h2>
  <h2 class="hExtras">Extra(s)</h2>
</div>

<div id="advancedContainer">
  <h2 class="hDestination">Destination(s)</h2>
  <h2 class="hExtras">Extra(s)</h2>
</div> 
```

我试图在 h2 之后使用**hDestination类将一些内容添加到****advancedContainer**中，但它也在 h2 之后使用 simpleContainer 的 hDestination 类**添加**。我只希望在 h2 之后将内容添加到**advancedContainer**与**hDestination**类。

 ******我尝试了以下代码

```
$('<div>This is a test</div>').insertAfter('h2.hDestination','#advancedContainer'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:25:03.610

这样做`.after()`读起来更好，并且更适合您的场景/上下文：

```
$('#advancedContainer h2.hDestination').after('<div>this is a test</div>'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:28:21.083

这就是你想要的：

`$('<div>This is a test</div>').insertAfter('#advancedContainer h2.hDestination');`

[**JSFiddle 示例**](http://jsfiddle.net/jGPp2/1/)

...*大声笑，我需要在摆弄时更多地刷新页面...*******

# xpath - scrapy Xpath 查询以选择输入标签元素（赏金）

> ID：11208239
> 
> 赞同：0
> 
> 时间：2012-06-26T13:22:33.573
> 
> 标签：xpath, scrapy

我正在使用scrapy crawl spider并尝试解析输出页面以选择所有输入标签参数，如下所示：

*   输入类型：必须是（文本或密码或文件）
*   输入 id ：如果没有找到，请选择 [输入名称]。

我写了一个在scrapy shell中测试的示例代码，但它并没有给我确切的结果，你能帮我吗？

测试站点：[http ://testaspnet.vulnweb.com/Signup.aspx](http://testaspnet.vulnweb.com/Signup.aspx)

```
>>> hxs.select('//input[@id] | //input[@type="text"] | /text()').extract()

[u'<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTY0MzI4NjU4Mw9kFgICAQ9kFgICAQ9kFgQCAQ8WBB4EaHJlZgUKbG9naW4uYXNweB4JaW5uZXJodG1sBQVsb2dpbmQCAw8WBB8AZB4HVmlzaWJsZWhkZHEZ3VN6SP/C2xESDN/Y3p8zhfSB">',

 u'<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWWgKJ+8rsBQLStq24BwK3jsrkBALF97vxAQKozoCcCQKpzpj7DgKSnr/eCQKSnr/eCQKSntPyAgKSntPyAgKSnseJCgKSnseJCgKSnvusAwKSnvusAwKSnu/DDAKSnu/DDAKSnoPmBQKSnoPmBQKSnre9DQKSnre9DQKSnqvQBgKSnqvQBgKSnp+5AwKSnp+5AwKSnrPcDAKSnrPcDAL3pJ3FDwL3pJ3FDwL3pLGYBwL3pLGYBwL3pKU/AvekpT8C96TZ0wkC96TZ0wkC96TN9gIC96TN9gIC96ThjQoC96ThjQoC96SVoAMC96SVoAMC96SJxwwC96SJxwwC96T9rAkC96T9rAkC96SRwwIC96SRwwICyMvj6AUCyMvj6AUCyMuXjw0CyMuXjw0CyMuLogYCyMuLogYCyMu/+Q8CyMu/+Q8CyMvTnQcCyMvTnQcCyMvHMALIy8cwAsjL+9cJAsjL+9cJAsjL7+oCAsjL7+oCAsjLw9MPAsjLw9MPAsjL9/YIAsjL9/YIAq3SwZ8KAq3SwZ8KAq3S9bIDAq3S9bIDAq3S6ckMAq3S6ckMAq3SnewFAq3SnewFAq3SsYMNAq3SsYMNAq3SpaYGAq3SpaYGAq3S2foPAq3S2foPAq3SzZEHAq3SzZEHAq3SofkFAq3SofkFAq3S1Z0NAq3S1Z0NAob5pwUChvmnBQKG+dvZCQKG+dvZCaCOP7DYDQ3mNEhISrmdoTKH9Tws">',

  u'<input name="tbUsername" type="text" id="tbUsername" class="Login">',

  u'<input name="tbPassword" type="password" id="tbPassword" class="Login">',

  u'<input type="submit" name="btnSignup" value="Sign me up" id="btnSignup">'] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:40:06.050

类型的所有`input`元素`text`，`password`或`file`：

```
//input[@type='text' or @type='password' or @type='file'] 
```

我不确定您希望 id 或 name 的条件是什么 - 这将获得`input`这三种类型的所有元素，它们具有 id 或名称：

```
//input[(@type='text' or @type='password' or @type='file') and (@id or @name)] 
```

如果要测试 id 或 name（如果 id 不存在）等于某事（`XXXX`）：

```
//input[(@type='text' or @type='password' or @type='file') and (@id='XXXX' or (not(@id) and @name='XXXX'))] 
```

如果要提取 id：

```
//input[@type='text' or @type='password' or @type='file']/@id 
```

如果没有指定 id，我不认为使用标准 XPaths 可以提取 id 或名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:36:46.220

我不知道 Scrapy，但从纯粹的 XPath 角度来看，以下内容应该满足您描述的要求：

```
//input[(@id or @name) and (@type = 'text' or @type = 'password' or @type = 'file')] 
```

另外，我注意到您正在尝试检索所选节点的文本内容。这可能不会返回任何内容，因为输入是自闭合标签并且不包含内部内容。

# objective-c - iOS 中的 Dom 操作

> ID：11208240
> 
> 赞同：0
> 
> 时间：2012-06-26T13:22:37.440
> 
> 标签：objective-c, ios

在 iOS 中，我需要模拟控制 UIWebView 的导航，在 Perl / Python / Ruby *mechanize*的流行库中徒劳地做一些事情。以编程方式填写和提交表单、关注链接、关注重定向等等。

iOS平台有解决方案吗？谢谢

# .net - 域对象扩展数据传输对象

> ID：11208241
> 
> 赞同：4
> 
> 时间：2012-06-26T13:22:38.860
> 
> 标签：.net, oop, domain-driven-design, data-transfer-objects

我是 DDD 和 OO 原则的新手，很抱歉我知识贫乏。

我有**CustomerDTO**和**Customer**课程。

我将所有字段和属性存储在**DTO**类中，并将其用作Customer**类的****基**类。

 ****使用DTO**的主要目的是将其传递给**View**。我在**Customer**类中对其进行了扩展，使其不具有重复的属性。

这是正确的方法还是有更好的OO解决方案？

我已经阅读了有关 AutoMapper 的信息，但我想知道是否有替代解决方案。

非常感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T13:51:48.330

我个人从未见过这种方法。使用 DTO 的原因是为了在 DAL 和 biz 层之间分离关注点。它让业务层和 DAL 可以按照自己的节奏进行更改，并且副作用最小。您所要做的就是更改 DTO 和 DO 之间的映射。如果你从你的 DTO 继承你的 DO，那么即使有一个 DTO 又有什么意义呢？

快速回答：不要从 DTO 继承你的 DO。现在可能很容易，但将来可能是维护的噩梦。

PS不要害怕Automapper。它相对容易使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T08:54:40.203

这是一个坏主意。这里有两个原因（可能还有更多）：

*   域对象是专门为事务构建的。他们不应该提供对所有财产的公共访问。它们应该只包含提供行为目的的属性。DTO 有一个目的：向消费者提供数据（例如 UI/Web 服务/消息系统）。例如，客户 DTO 可能包含一个属性，该属性提供客户已下订单的数量以及他们已花费的总金额。然而，在域方面，客户**聚合**可能不包含任何此类信息，因为此订单信息存储在专门为订单交易量身定制的单独订单聚合中。
*   DTO 是愚蠢的 POCO，只有一堆 getter 和 setter。允许您的域对象在其所有属性上都有设置器是非常糟糕的做法。操作应该是原子的，并由具有描述其意图的明确名称的方法提供。[这个](https://stackoverflow.com/questions/4451689/domain-driven-design-domain-objects-attitude-about-setters)问题的答案解释了这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T05:53:30.023

**扩展答案：**

让我们试着分析一下这种情况，不要盲目地说没有人做这样的事情。

DTO - 它是仅包含数据并在边界之间传输数据的结构。

领域模型——这里的关键词是“模型”，是解决问题的领域的抽象。从 OO 的角度来看，它是一个简单的类，如果将其拆分，它将是纯数据 (DTO) 和纯无状态行为（DDD 术语中的服务或域服务）。

现在让我们以 MVVM 模式为例，特别是它的 VM 部分。视图模型 - 这里的关键词再次是“模型”，它是解决其问题的视图抽象。人们实现它的方式有很多，一些包装域对象，一些进行转换，一些包装 DTO。这里的重点是视图模型是视图的域模型，它与任何模型几乎相同。那为什么人们要限制实现领域模型的方式。

现在回到 DTO 和域模型。正如我上面所说，我们可以将域对象分解为 DTO 和服务。让我们考虑一下，我们将域对象视为 DTO 的行为包装器（就像 MVVM 经常做的那样）。它把我们带到哪里：

*   首先，我们打破 OO 封装。这很糟糕，因为它可以防止我们的对象数据被错误地使用。有人可以直接使用我们的域对象数据 (DTO) 操作它并将我们的模型置于无效状态。这是巨大的。
*   我们可以轻松地转移我们的对象抛出边界、Web 服务、序列化、克隆，我们可以分离出数据部分，并将其提供给我们的数据存储或 Web 服务。这对于分布式系统来说是巨大的。

让我们继续，打破封装是一个严重的问题。我们需要的是一种方法来保证我们的域对象数据不会被直接操作，只有域对象应该操作它。当 DTO 在域对象之外时，我们可以通过使 DTO 不可变、只读对象来实现这一点。

现在关于重用 DTO，继承与组合。有人说：更喜欢组合而不是继承，我个人确实遵循这个规则。但是你需要分析你的具体情况。规则说“喜欢”不服从。

**原始答案：**

虽然我个人并没有经常看到这种方法，但我认为这种方法被低估了，它可能非常好。

我多次看到这样的问题被问到，所有的答案都是，不要这样做，因为没有人这样做。不要害怕尝试。

Ryan Bennet 在他的回答中写道：

> 现在可能很容易，但将来可能是维护的噩梦。

的确如此，但是如果没有未来或者这是一个小项目怎么办，我会在这里坚持 YAGNI、TDD 和敏捷规则，并做最少的工作来完成这项工作。

代码不是你刻在石头上的东西，永远不会碰，当你需要时，你可以重构，引入 DTO，使用自动映射器或其他任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-16T18:34:44.217

老问题，我喜欢这里的其他几个答案，特别是关于将 DAL 与业务层分离的问题。但是，我想提一个在 DO 类从 DTO 类继承时可能会遇到的具体问题。

在 C# 和 VB 等 .NET 语言中，不能有真正的多重继承。那就是一个类不能扩展两个基类。因此，如果您的 DO 类已经扩展了一个 DTO 基类，那么您就排除了 DO 类和另一个 DO 类之间继承的可能性。

忽略实际保存数据的表的外观，或者您是否使用[TPH、TPT 或 TPC](https://stackoverflow.com/questions/190296/how-do-you-effectively-model-inheritance-in-a-database)，假设您有 DO 类

```
Vehicle
Car : Vehicle
Boat : Vehicle 
```

你不能拥有`Car : CarDto, Vehicle`. 如果您的项目足够复杂，可以在 DO 类之间进行任何继承，那么这本身就是一个非常引人注目的论点。

最后，我想补充一点，在继承与组合之间进行选择时，您会根据“is a”与“has a”来思考。那么更有意义的是：“Car is a CarDto”还是“Car is a Vehicle”？后者国际海事组织。**

# java - 我如何使用httpclient登录网站并执行一些搜索操作？

> ID：11208242
> 
> 赞同：0
> 
> 时间：2012-06-26T13:22:40.683
> 
> 标签：java, httpclient

我想登录到一个网络应用程序并想在登录后执行一些搜索操作。我正在为此使用httpclient，并且我能够登录并获取该页面的数据，但无论如何我都无法执行发布操作，比如在登录后搜索任何用户帐户。因为它再次要求登录。请提供任何方法或想法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:02:49.057

我曾经遇到过一个会话 cookie 过去不可见的范围问题。您“可能”有同样的问题。如果您知道成功登录后正在创建会话 cookie，请尝试添加对`setDomainMatchingStrict(false)`

```
import com.meterware.httpunit.cookies.CookieProperties;

WebConversation wc = new WebConversation();

CookieProperties.setDomainMatchingStrict(false);   // <- the important bit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:50:29.607

在这里查看如何在 java 中使用 cookie，使用 java.net API [http://www.hccp.org/java-net-cookie-how-to.html](http://www.hccp.org/java-net-cookie-how-to.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:45:38.463

它不是 httpclient，但有一个名为[selenium](http://code.google.com/p/selenium/)的浏览器自动化框架。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:30:53.583

当您登录站点时，服务器通常会向您发送一个包含会话 ID 或 jsessionid 标头的 cookie。尝试在登录后操作中将此 jsessionid 及其值发送回服务器。

这可能不起作用，因为服务器可以强制您使用 cookie。这只是那里经常发现的场景的一个想法。

# common-lisp - 如何将 buildapp 与预定义的 asd 文件一起使用

> ID：11208251
> 
> 赞同：3
> 
> 时间：2012-06-26T13:22:59.970
> 
> 标签：common-lisp, executable, sbcl

我打算使用[buildapp](http://www.xach.com/lisp/buildapp/#example)从我的 lisp 代码中获取可执行文件，但我不明白如何为项目指定 .asd 文件以加载代码。

我想象了一些电话，例如：

```
buildapp --asdf-file:/path/to/projectasdffile.asd \
         --entry-point package:main 
```

但是主页提供的示例并未涵盖我认为相等的调用，所有示例调用看起来都像是一个完整的 asdf 定义本身。这对于整个项目来说有点大，特别是因为我已经有了一个完整的项目定义（使用 asdf）。

因此：有没有办法像提供的虚构示例调用一样使用 buildapp？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:37:57.233

`buildapp --load-path /path/to/project --load-system project`应该做的伎俩。

# c# - 发射映射器。将对象转换为 int

> ID：11208254
> 
> 赞同：1
> 
> 时间：2012-06-26T13:23:09.817
> 
> 标签：c#, .net, emitmapper

当我尝试映射`object`到`int`.
我的类和方法在哪里转换：

```
[Serializable]
public class ProfileProperty
{
    public object PropertyValue { get; set; }

    public bool IsVisible { get; set; }

    public ProfileProperty(object value, bool isVisible = true)
    {
        this.PropertyValue = value;
        this.IsVisible = isVisible;
    }

    public ProfileProperty()
    {
        this.IsVisible = true;
    }

    public T GetValue<T>()
    {
        return (T)this.PropertyValue;
    }

    public override string ToString()
    {
        if (this.PropertyValue != null)
        {
            return this.PropertyValue.ToString();
        }

        return string.Empty;
    }
}

[Serializable]
public class ProfileProperty
{
    public object PropertyValue { get; set; }

    public bool IsVisible { get; set; }

    public ProfileProperty(object value, bool isVisible = true)
    {
        this.PropertyValue = value;
        this.IsVisible = isVisible;
    }

    public ProfileProperty()
    {
        this.IsVisible = true;
    }

    public T GetValue<T>()
    {
        return (T)this.PropertyValue;
    }

    public override string ToString()
    {
        if (this.PropertyValue != null)
        {
            return this.PropertyValue.ToString();
        }

        return string.Empty;
    }
}

public static class Helper
{
    public static ProfileModel PopulProfMod(Profile profile)
    {
        var mapper = ObjectMapperManager.DefaultInstance.GetMapper<Profile, ProfileModel>(new DefaultMapConfig()
                    .IgnoreMembers<Profile, ProfileModel>(new string[] { "GetValue", "ToString" }));
        ProfileModel prof = new ProfileModel();
        if (profile != null)
        {
            prof = mapper.Map(profile);
            //prof.Age = (int)profile.Age.PropertyValue;
            prof.Visibility = new List<string>();
        }

        //Some code

        return prof;
    }
} 
```

当映射属性`Age`为 0 但时`profile`：

```
Profile profile = new Profile()
            {
                Age = new ProfileProperty() { IsVisible = true, PropertyValue = 17 },
                Comments = 2,
                UserName = "Luck",
                FirstName = new ProfileProperty() { IsVisible = false, PropertyValue = "Alex" }
            }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T06:34:37.707

你需要一个转换器：

```
 new DefaultMapConfig()
       .IgnoreMembers<Profile, ProfileModel>(new string[] { "GetValue", "ToString" }))
       .ConvertUsing<ProfileProperty, int>(s => (int)s.PropertyValue) 
```

# c# - 不使用 com 对象导出到 excel

> ID：11208255
> 
> 赞同：1
> 
> 时间：2012-06-26T13:23:10.483
> 
> 标签：c#, excel

我正在将数据集导出到 Excel 工作表，但我不想使用 Excel 的 COM，因为它需要很多时间。

我需要一种无需使用 MS Office Interop 即可导出到 Excel 的方法，并且我需要使用空 Excel 模板加载该方法，以便新的 Excel 工作表具有相同的格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:27:58.063

您可以使用 ADO.NET 和 Jet OleDbProvider 访问 excel 文件并更新其内容

```
string con = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=your_path\test.xls;Extended Properties='Excel 8.0;HDR=No;'";
using(OleDbConnection c = new OleDbConnection(con))
{
    c.Open();
    string commandString = "Insert into [Sheet1$] (F1, F2, F3) values('F1Text', 'F2Text', 'F3Text')" ;
    using(OleDbCommand cmd = new OleDbCommand(commandString))
    {
        cmd.Connection = c;
        cmd.ExecuteNonQuery();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:25:36.660

我会研究这样的[xlslinq](http://xlslinq.codeplex.com/)

但你也可以使用这个[库](http://exceldatareader.codeplex.com/)，因为它将导出到数据集

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:32:40.200

我建议使用[Open XML SDK 2.0](http://msdn.microsoft.com/en-us/library/bb448854.aspx)

您将能够完成您所要求的一切，而且速度非常快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T20:17:40.027

我使用[EPPlus](http://epplus.codeplex.com/)。可通过 Nuget 和 LGPL 许可获得。让您使用 OOXML 创建和管理 xlsx 电子表格。

# sql - 在 sql 查询循环中执行更新

> ID：11208256
> 
> 赞同：0
> 
> 时间：2012-06-26T13:23:12.243
> 
> 标签：sql, loops, sql-update, sybase

我正在尝试根据 TableB 更新 TableA 中的 ColumnA。下面是我需要循环更新 TableA 的结果集。

```
SELECT TableB.ColumnA, 
       TableB.ColumnB 
  FROM TableA, TableB 
 WHERE TableA.ColumnA =NULL 
   AND TableB.ColumnB = TableA.ColumnB 
   AND TableB.ColumnC =true; 
```

两个表中的 CoulmnA 是相同的类型和数据 两个表中的 ColumnB 是相同的类型和数据。

我无法做的是遍历结果集并以类似的方式更新 TableA，如下所示：

对于上面结果集中的每一行。

```
UPDATE TableA 
   SET ColumnA =  ResultSet.ColumnA  
 WHERE TableA.ColumnB = ResultSet.ColumnB; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:27:58.577

如果我理解正确，您将查询生成的对用于更新目的。您希望第一个值变成第二个值。

确切的语法取决于您使用的 SQL 版本。下面是一个使用 SQL Server 的示例：

```
with toupdate as (SELECT TableB.ColumnA, TableB.ColumnB
                  from TableA join TableB
                       TableB.ColumnB = TableA.ColumnB
                  where TableA.ColumnA = NULL AND TableB.ColumnC =true
                 )
update tableA
    set TableA.ColumnA = toupdate.ColumnB
    from toupdate
    where toupdate.ColumnA = tableA.columnA 
```

如果没有“with”语句，您可以尝试：

```
update tableA
    set TableA.ColumnA = toupdate.ColumnB
    from (SELECT TableB.ColumnA, TableB.ColumnB
          from TableA join TableB
               TableB.ColumnB = TableA.ColumnB
           where TableA.ColumnA = NULL AND TableB.ColumnC =true
          ) toupdate
    where toupdate.ColumnA = tableA.columnA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:27:40.693

这就是我在 SQl Server 中编写它并查看 sybase 语法的方式，它看起来好像也可以工作。

```
UPDATE A     
SET ColumnA = B.ColumnB  
--SELECT   ColumnA , B.ColumnB  
FROM tableA A 
JOIN TableB B  
ON  B.ColumnB = A.ColumnB            
WHERE A.ColumnA = NULL AND B.ColumnC =true; 
```

请注意，我将注释行放入，以便您可以查看实际值，以确保在运行之前更新是正确的。它还展示了如何将 select 语句转换为更新。

# tridion - 安圭拉 - 从弹出窗口更新字段的值？

> ID：11208259
> 
> 赞同：6
> 
> 时间：2012-06-26T13:23:25.890
> 
> 标签：tridion

每当编辑器尝试保存具有某些值的组件（在这种情况下为过去的日期字段）时，我都会出现一个模式弹出窗口。

在这个弹出窗口中，我向编辑器展示了一些选项（非常类似于默认的“打开共享项目”对话框）和一个确定/取消按钮组合。在取消时，我触发“取消”事件，编辑器返回编辑屏幕，一切都很好。在“确定”上，我想更改字段的值以匹配编辑器选择的任何内容，然后保存。

我尝试使用 FieldBuilder 和在[其他主题](https://stackoverflow.com/a/10483741/866454)中提到的示例 Boris 的方法， 但我无法从弹出对话框中进入该字段。

关于如何从模式弹出窗口中修改项目（也可能是页面）的 xml 的任何建议？

编辑： getControlForFieldName 中使用的代码

```
function getControlForFieldName(name) {
    var fieldBuilder = $display.getView().properties.controls.fieldBuilder;
    var fieldsContainer = fieldBuilder.properties.input;
    var fieldsNode = fieldsContainer.getElement();
    var fieldContainer = $dom.getFirstElementChild(fieldsNode);
    while (fieldContainer) {
        var labelNode = $dom.getFirstElementChild(fieldContainer);
        var fieldNode = $dom.getNextElementSibling(labelNode);
        var control = fieldNode.control;
        if (control.getFieldName() == name) {
            return control;
        }
        fieldContainer = $dom.getNextElementSibling(fieldContainer);
    }
} 
```

编辑#2

在 Frank 的建议和 Jaime & Frank 离线的一些帮助之后，我让它按如下方式工作：

1.  从命令扩展调用弹出窗口（在我的情况下保存并关闭）
2.  command.js 指定了一个在“提交”时调用的事件处理程序（== OK 被按下）

```
$evt.addEventHandler(p.dialogPopup, "submit", 
    this.getDelegate(this._onPopupSubmit)); 
```

在我的弹出窗口中，我将所选项目（它是关键字 ID）传递给事件处理程序：

```
this.fireEvent("submit", { id: select.options[select.selectedIndex].value }); 
```

现在回到事件处理程序`_onPopupSubmit(e)`，我刚刚读取 e.data.id，加载此关键字，获取 ID 和标题等属性，并使用 item.setMetadata("new metadata with updated values") 更新项目的元数据。

简单的 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T14:28:06.093

您的代码在弹出窗口中运行，因此您对全局变量的任何引用都将从弹出窗口中获取。

因此，当您获得 fieldBuilder 时：

```
var fieldBuilder = $display.getView().properties.controls.fieldBuilder; 
```

$display 是对全局变量的引用。所以这实际上在弹出窗口中寻找 FieldBuilder（它没有）。

要获取 Component 窗口的 F​​ieldBuilder，可以从 opener 中获取：

```
var fieldBuilder = opener.$display.getView().properties.controls.fieldBuilder; 
```

您可能需要考虑将更新的值实际传递给回调函数或（自定义）事件，因为这会使您的弹出窗口不那么依赖`opener.`技巧。

# sql - 查找和替换信用卡号

> ID：11208260
> 
> 赞同：5
> 
> 时间：2012-06-26T13:23:27.927
> 
> 标签：sql, sql-server, credit-card, replace

我们有一个包含大量数据的大型数据库。我最近发现我们的销售和运输部门一直在使用应用程序的一部分来公开存储客户的信用卡号码。我们已经制止了它，但现在有数千行带有数字。

我们正试图弄清楚如何在某些列中连续扫描 16 位数字（或破折号分隔）并用 X 替换它们。

这不是一个简单的 UPDATE 语句，因为卡号存储在大量文本中。到目前为止，我一直无法弄清楚 SQL Server 是否能够使用正则表达式（似乎没有）。

其他一切都失败了，我将通过 PHP 做到这一点，因为那是我最擅长的……但这会很痛苦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T13:26:56.897

听起来您需要将 PATINDEX 与 WHERE LIKE 子句一起使用。

像这样的东西。用类似的东西创建一个存储过程，然后用你已经确定的一堆不同的参数（使@pattern & @patternlength 成为参数）调用它，直到你替换了所有的实例。

```
declare @pattern varchar(100), @patternlength int
set @pattern = '[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]'
set @patternlength = 19

update  tableName
set fieldName = 
    LEFT(fieldName, patindex('%'+ @pattern + '%', fieldName)-1) 
    + 'XXXX-XXXX-XXXX-XXXX' 
    + SUBSTRING(fieldName, PATINDEX('%'+ @pattern + '%', fieldName)+@patternlength, LEN(fieldName))
from tableName
where fieldName like '%'+ @pattern + '%' 
```

诀窍就是找到合适的模式，并设置合适的@patternlength 值（不是@pattern 的长度，因为那不起作用！）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T13:33:03.793

我认为您最好以编程方式执行此操作，特别是因为您提到数据可以采用几种不同的格式。请记住，并非所有信用卡号都是 16 位长（Amex 是 15，Visa 是 13 或 16，等等）。

如果可能，最好在清理作业级别提供检查各种正则表达式和验证代码的能力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-04-13T09:39:17.103

我最近遇到了这种情况。使用 Patindex 和 Stuff 应该会有所帮助，但是您需要分别重复具有不同位数的 CC 号码。

```
-- For 16 digits CC numbers
UPDATE table
SET    columnname = Stuff (columnname, Patindex(
'%[3-6][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]%'
, columnname), 16, '################')
WHERE  Patindex(
'%[3-6][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]%'
, columnname) > 0 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-27T00:29:56.070

即兴肖恩的回答。

下面将在@text 中找到所有出现的@maskPattern 并将它们替换为'x'。例如，如果@maskPattern = XXXX-XXXX-XXXX-XXXX，它将在@text 中找到此模式并将所有出现的地方替换为 XXXX-XXXX-XXXX-XXXX。如果它没有找到任何匹配项，它将保持文本不变。

此存储过程也可以被操作为仅屏蔽 maskPattern 开头的 3/4。干杯!

```
 ALTER PROCEDURE [dbo].[SP_MaskCharacters] @text nvarchar(max),
  @maskPattern nvarchar(500)
  AS
   BEGIN
  DECLARE @numPattern nvarchar(max) = REPLACE(@maskPattern, 'x', '[0-9]')
  DECLARE @patternLength int = LEN(@maskPattern)
  WHILE (@text IS NOT NULL)
  BEGIN
  IF PATINDEX('%' + @numPattern + '%', @text) = 0  BREAK;
  SET @text =
    LEFT(@text, PATINDEX('%' + @numPattern + '%', @text)-1) --Get beginning chars of the input text until first occurance of pattern is found
    + @maskPattern --Append aasking pattern
    + SUBSTRING(@text, PATINDEX('%' + @numPattern + '%', @text) + @patternLength, LEN(@text)) -- Get & append rest of the text found after masking attern
    END
    SELECT @text
END 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T13:31:32.430

您可以使用 patindex。它不会很漂亮，可能有更简洁的方式来编写它。但是您可以使用集合，即 [0-9]

patindex：http: [//msdn.microsoft.com/en-us/library/ms188395.aspx](http://msdn.microsoft.com/en-us/library/ms188395.aspx)

类似问题：[T-SQL 中的 SQL Server 正则表达式](https://stackoverflow.com/questions/194652/sql-server-regular-expressions-in-t-sql)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-25T20:28:59.963

对于任何发现此问题但确实想使用 PHP 的人，这是我使用的一个函数，它接受信用卡号（所有数字，带有破折号或带有空格）并将除第一个和最后 4 位数字之外的所有数字替换为“X”。

要同时接受带有破折号的信用卡号，请改用此正则表达式模式：

```
$cc_regex_pattern = '/(\d{4})(-)?(\d{4})(-)?(\d{4})(-)?(\d{4})/' 
```

并删除删除破折号的 cc 号码的预处理：

```
$compressed_cc_number = preg_replace('/(\ |-)/', '', $credit_card_number); 
```

所以替换字符串变成了（因为我们改变了模式的索引——注意 $7）：

```
$cc_regex_replacement = '$1' . $cc_middle_pattern . '$7'; 
```

或者，如果您愿意，只需替换整个 cc 编号，就像在原始问题中一样：

```
$cc_regex_replacement = 'XXXX$2XXXX$4XXXX$6XXXX'; 
```

这是带有或不带空格或破折号的信用卡号的原始功能，它混淆并删除了任何破折号：

```
/**
 * @param integer|string $credit_card_number
 * @return mixed
 */
static function obfuscate_credit_card($credit_card_number)
{

    $compressed_cc_number = preg_replace('/(\ |-)/', '', $credit_card_number);

    $cc_length = strlen($compressed_cc_number);
    $cc_middle_length = $cc_length >= 9 ? $cc_length - 8 : 0;

    //create middle pattern
    $cc_middle_pattern = '';
    for ($i = 0; $i < $cc_middle_length; $i++) {
        $cc_middle_pattern .= 'X';
    }

    //replace cc middle digits with middle pattern
    $cc_regex_pattern = '/(\d{4})(\d+)(\d{4})/';
    $cc_regex_replacement = '$1' . $cc_middle_pattern . '$3';
    $obfuscated_cc = preg_replace($cc_regex_pattern, $cc_regex_replacement, $compressed_cc_number);

    return $obfuscated_cc;
} 
```

# apache - Apache：有没有办法在 FilesMatch 中使用 REMOTE_USER？

> ID：11208261
> 
> 赞同：1
> 
> 时间：2012-06-26T13:23:32.717
> 
> 标签：apache, .htaccess, authentication

用户名：`foo@foobar.com`

那么允许用户访问以他的名字开头的任何文件的最佳方式是什么？（例如 foo_bar.pdf、foo.txt、footree.log）

```
# ... other authentication stuff here ...

RewriteCond %{REMOTE_USER} ^(.*?)@
<FilesMatch "%1.*?\..*">
   require valid-user
</FilesMatch> 
```

# pydev - pydev Ipython 控制台在分页时冻结

> ID：11208263
> 
> 赞同：3
> 
> 时间：2012-06-26T13:23:34.617
> 
> 标签：pydev, ipython

如果在带有 Ipython 控制台 0.11 的 pydev 2.5 中，我会写：

```
import numpy

numpy? 
```

我得到了 numpy 的文档，因为它比屏幕长，所以它被分页显示消息：

```
---Return to continue, q to quit--- 
```

但是，无论我按什么键，它都会留在那里。通常我必须重新启动控制台才能继续。

这是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T05:38:08.623

控制台似乎没有发送按键来实际执行分页。

一种解决方法是将 ipython 分页功能重新定义为从不实际分页。将以下代码添加到“初始解释器命令”（PyDev -> 交互式控制台）

```
from IPython.core import page
def nopage(strng, start=0, screen_lines=0, pager_cmd=None):
    print(strng)
page.page = nopage 
```

# arrays - Firefox 原生 JSON.parse 无法解析嵌套数组属性

> ID：11208266
> 
> 赞同：1
> 
> 时间：2012-06-26T13:23:38.893
> 
> 标签：arrays, json, firefox, nested

本机 JSON.parse 在 FF 中的实现似乎很差（使用版本 13.0.1），我在 IE、Chrome 和 FF 中尝试了以下测试代码。前 2 个浏览器似乎正确地将 json 字符串解析为 Object 而 FF 没有。

```
var jsonObj = { 
        onetype: [
            {id:1,name:"First Name"},
            {id:2,name:"Second Name"}
        ]
};
var serializedJsonObj = JSON.parse(JSON.stringify(jsonObj));
serializedJsonObj.onetype[1].name; 
```

我假设必须将“第二个名称”打印到输出，但不是这个 FF 只打印“未定义”，因为 obj.onetype 属性实际上是一个字符串，要将其解析为一个对象，我们必须再次调用 JSON.parse ：

```
var jsonObj = { 
        onetype: [
            {id:1,name:"First Name"},
            {id:2,name:"Second Name"}
        ]
};
var serializedJsonObj = JSON.parse(JSON.stringify(jsonObj));
JSON.parse(serializedJsonObj.onetype)[1].name; 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-25T02:03:52.260

它是包含在 lib.js 中的过时 Prototype.js 库（谁会这样做？？）。在阅读了 2 条声称在我的案例中这种行为无效的评论后，我创建了一个测试页面，其中包含我遇到问题的真实案例来测试它，但它不再可重现。

# c# - 地铁风格应用程序中的完整油漆（绘图）应用程序

> ID：11208267
> 
> 赞同：2
> 
> 时间：2012-06-26T13:23:41.093
> 
> 标签：c#, xaml, drawing, windows-8, microsoft-metro

我正在为 Windows 8 开发类似绘画的应用程序。我已经尝试过，但我什至无法开发线条绘图工具。我的应用程序将有手绘工具、线条、矩形、椭圆、圆形绘图工具、橡皮擦，将画布内容保存为 JPG。我正在使用画布工具进行绘图。我对各种“指针”事件感到困惑。我已经在 WPF 中检查了一些类似油漆的应用程序示例，但我无法完全移植这些应用程序。

所以请指导我一些编码，请提供我工作代码。

在这里，我附上了画线的示例代码。但在这条线不断绘制，因为没有检查鼠标左键是否被按下的规定。

```
<!-- XAML CODE -->
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
        <StackPanel Orientation="Horizontal" Margin="0,-700,0,0" Grid.Row="0">
            <Button x:Name="btnLine" Click="btnLine_Click" Height="50" Width="auto" Content="Line" Grid.Row="0"/>
            <Button x:Name="btnElipse" Click="btnElipse_Click" Height="50" Width="auto" Content="Elipse" Grid.Row="0"/>
            <Button x:Name="btnPencil" Click="btnPencil_Click" Height="50" Width="auto" Content="Pencil" Grid.Row="0"/>
        </StackPanel>
    <Canvas Name="canvas" Background="AntiqueWhite" Margin="0,65,0,0"/> 
```

* * *

```
/* C# Code*/

void canvas_PointerEntered(object sender, PointerRoutedEventArgs e)
    {
        switch (DrawingTool)
        {
            case "Line":
                {
                    clickPoint = e.GetCurrentPoint(canvas).Position;
                    newLine = new Line();
                    newLine.Fill = new SolidColorBrush(Windows.UI.Colors.Black);
                    newLine.StrokeLineJoin = PenLineJoin.Bevel;
                    newLine.X1 = clickPoint.X;
                    newLine.Y1 = clickPoint.Y;
                    newLine.X2 = clickPoint.X + 10;
                    newLine.Y2 = clickPoint.Y + 10;
                    newLine.StrokeThickness = 2;
                    canvas.Children.Add(newLine);
                    int zindex = canvas.Children.Count;
                    Canvas.SetZIndex(newLine, zindex);
                }
                break;

            case "Pencil":
                {
                    startPoint = e.GetCurrentPoint(canvas).Position;
                    line = new Polyline();
                    line.Stroke = new SolidColorBrush(Windows.UI.Colors.Black);
                    line.StrokeThickness = 2.0;
                    canvas.Children.Add(line);
                }
                break;

            case "Ellipse":
                {
                    newEllipse = new Ellipse();
                    newEllipse.StrokeThickness = 2;
                    newEllipse.Stroke = new SolidColorBrush(Windows.UI.Colors.Black);
                    newEllipse.StrokeLineJoin = PenLineJoin.Bevel;
                    newEllipse.Width = clickPoint.X;
                    newEllipse.Height = clickPoint.Y;
                    canvas.Children.Add(newEllipse);
                }
                break;

            default:
                break;
        }
    }

    void canvas_PointerMoved(object sender, PointerRoutedEventArgs e)
    {
        switch (DrawingTool)
        {
            case "Pencil":
                {
                    if (true)
                    {
                        Point currentPoint = e.GetCurrentPoint(canvas).Position;
                        if (startPoint != currentPoint)
                        {
                            line.Points.Add(currentPoint);
                        }
                    }
                }
                break;

            case "Line":
                {
                    drawPoint = e.GetCurrentPoint(canvas).Position; ;
                    if (newLine != null)
                    {
                        newLine.X2 = drawPoint.X;
                        newLine.Y2 = drawPoint.Y;
                    }
                }
                break;

            default:
                break;
        }
    }

    void canvas_PointerReleased(object sender, PointerRoutedEventArgs e)
    {
        newLine = null;
    }

    string DrawingTool;
    Line newLine;
    Ellipse newEllipse;
    Point clickPoint;
    Point drawPoint;
    Point startPoint;
    Polyline line;

    /// <summary>
    /// Invoked when this page is about to be displayed in a Frame.
    /// </summary>
    /// <param name="e">Event data that describes how this page was reached.  The Parameter
    /// property is typically used to configure the page.</param>
    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
    }

    private void btnPencil_Click(object sender, RoutedEventArgs e)
    {
        DrawingTool = "Pencil";
    }

    private void btnLine_Click(object sender, RoutedEventArgs e)
    {
        DrawingTool = "Line";
    }

    private void btnElipse_Click(object sender, RoutedEventArgs e)
    {
        DrawingTool = "Ellipse";
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T05:35:45.583

我现在成功地开发了基本的地铁风格油漆应用程序。欢迎提出建议。您可以下载源代码[项目](http://www.codeproject.com/Articles/416878/Metro-Paint)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:41:50.797

在画布中订阅 mousedown 和 mouseup 事件，并在收到 mousedown 和收到 mouseup 之间的鼠标位置绘制一个像素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T15:43:33.380

```
canvas.PointerMoved += _canvas_PointerMoved;
canvas.PointerPressed += _canvas_PointerPressed;
canvas.PointerReleased += _canvas_PointerReleased; 
```

是处理指针输入所需的事件吗

# iis - Microsoft.Web.Administration.ServerManager 在错误的目录中查找 IISExpress applicationHost.config

> ID：11208270
> 
> 赞同：11
> 
> 时间：2012-06-26T13:23:42.183
> 
> 标签：iis, iis-express

尝试在当前机器上获取应用程序池时遇到一个奇怪的问题。似乎在安装 IISExpress 时，除了完整的 IIS 之外，Microsoft 代码还想检查 IISExpress。IISExpress 对每个用户使用单独的 applicationHost 文件。我不确定这个调用是否需要它检查所有这些，或者只检查当前用户的那些。无论如何，它在 'C:\Windows\system32\config\systemprofile\' 目录中找不到它正在寻找的那个。对于运行此代码的应用程序池的用户，它应该转到 %userprofile% 或 'C:\Users\Administrator\'。

有谁知道这个 systemprofile 目录可能来自哪里？

```
Exception:-
System.IO.DirectoryNotFoundException: Filename: \\?\C:\Windows\system32\config\systemprofile\Documents\IISExpress\config\applicationHost.config
Error: Cannot read configuration file

   at Microsoft.Web.Administration.Interop.AppHostWritableAdminManager.GetAdminSection(String bstrSectionName, String bstrSectionPath)
   at Microsoft.Web.Administration.Configuration.GetSectionInternal(ConfigurationSection section, String sectionPath, String locationPath)
   at Microsoft.Web.Administration.ServerManager.get_ApplicationPoolsSection()
   at Microsoft.Web.Administration.ServerManager.get_ApplicationPools()
   at CustomCode.Classes.IIsApplicationPool.GetApplicationPool(String iisWebSitePath, String poolName) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-03-20T19:33:08.863

我强烈建议停止使用 IIS 附带的对 Microsoft.Web.Administration 的本地引用（即使它在 GAC 中）。这是因为它有一个非常具体的版本号（即 7.0.0.0），而且这个版本可能会在未来的 Windows 版本中发生变化，这会造成伤害。

相反，请检查 nuget 包：( `Microsoft.Web.Administration`https://www.nuget.org/packages/Microsoft.Web.Administration [)](https://www.nuget.org/packages/Microsoft.Web.Administration)。这基本上使您可以对 IIS 依赖项进行私有部署。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T10:00:35.073

如果您使用 Microsoft.Web.Administration 来检查应用程序池的应用程序在 IISExpress 上运行，由于 aspnet.config 中的程序集重定向，它将始终回退到 Microsoft.Web.Administration 版本 7.9.0.0 IIS 快递。

请参阅`C:\Program Files (x86)\IIS Express\config\templates\PersonalWebServer\aspnet.config` 这是配置中的问题：

```
<dependentAssembly>
  <assemblyIdentity name="Microsoft.Web.Administration"
                    publicKeyToken="31bf3856ad364e35"
                    culture="neutral" />
  <bindingRedirect oldVersion="7.0.0.0"
                   newVersion="7.9.0.0" />
  <codeBase version="7.9.0.0" 
            href="FILE://%FalconBin%/Microsoft.Web.Administration.dll" />
</dependentAssembly> 
```

确保您在完整的 IIS 或 Visual Studio 开发服务器上运行应用程序。

或者，您可以尝试删除程序集重定向，但我没有尝试过，这可能会导致其他地方出现问题。我们必须假设 IIS Express 团队出于某种原因进行了重定向（除了方便）:-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-04-04T07:48:15.517

我已经知道答案是旧的，但是您是否尝试过指定不同版本的 dll？

一张图值千言万语：

![在此处输入图像描述](../Images/834015b2bf0761810b82d2129b62e152.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-26T21:37:02.877

您如何尝试获取应用程序池？您是否使用 MWH (Microsoft.Web.Administration) API？

1.  完整的 IIS 附带 Microsoft.Web.Administration.dll（版本 7.0.0.0）。
2.  IIS Express 附带不同版本的 Microsoft.Web.Administration.dll（版本 7.9.0.0）。

似乎完整的 IIS 正在尝试使用 IIS Express 特定的程序集。我不确定您是如何进入这种状态的，但您可以卸载 IIS Express 并查看此问题是否仍然存在。

编辑：

为什么要在 Web 应用程序中使用 Microsoft.Web.Administration (MWA) 版本 7.9.0.0？它与 IIS Express 7.5 一起提供，仅适用于每个用户的 applicationhost.config 文件，它不使用/适用于位于 \windows\system32\inetsrv\config\appliationhost.config 的收件箱/完整 IIS 配置文件。

在您的情况下，在完整 IIS 下运行的 Web 应用程序以系统身份运行，因此 MWA 7.9.0.0 正在尝试从“C:\Windows\system32\config\systemprofile”目录加载配置文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-26T17:23:49.923

我最近才遇到这个问题。在阅读了很多帖子之后，这是最接近于让我知道发生了什么的帖子。虽然在 VS IDE 中运行时我不一定能解决两个版本（7.0.0.0 和 7.9.0.0）之间的冲突，但经过几个小时的努力，我确实找到了一个你可以做的古怪技巧解决 IDE 的自动重定向问题。

在以下示例中：

开发从 inetsrv 目录引用 Microsoft.Web.Administration.dll (7.0.0.0) 并尝试执行以下任何操作并尝试正确连接的应用程序安装。在 IDE 之外运行编译后的代码时，无论它是如何指定的，它总是能正常工作。

*   服务器管理器 sm = 新的服务器管理器（）；
*   sm.OpenRemote("本地主机");
*   sm.OpenRemote("MYPC"); // 假设你本地机器的名字是 MYPC

这些都会触发 VS 将引用从 7.0.0.0 DLL 重定向到 7.9.0.0，从而导致检索不正确的站点或发生 COM 异常。

我发现的怪癖是始终使用 OpenRemote()，即使尝试打开本地 IIS 并将“localhost”或“MYPC”指定为“LocalHost”或“MyPc”（即混合大小写的任意组合，以便它是不是与“localhost”（全部小写）或本地机器名称的完全区分大小写的匹配。

这个怪癖可能并不特定于所有 VS 版本。我目前正在使用 VS Professional 2017 (15.9.11)。

正如我所说，它确实修复了重定向，但它在调试时绝对有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-28T04:43:30.027

我发现将“TeamConfig 文件夹”本地映射到我的开发机器有助于为我解决这个问题。

# vb.net - 重置应用程序 VB.NET

> ID：11208271
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:23:42.637
> 
> 标签：vb.net, reset

我正在开发一个游戏，几分钟后我有很多事情会发生变化，所以我创建了一个新游戏按钮，我使用 Application.Restart() 清理所有内容并获得一个新的新游戏，但问题是是这退出游戏并开始新的游戏。我想要做的是重新开始游戏，但没有玩家注意到游戏退出。我该怎么做呢？

最好的问候，乔奥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:26:30.437

您应该在主游戏控制器类上实现 Start()、Stop() 和 Restart() 方法。Restart() 方法应该重置所有变量、状态、玩家、分数等的值，并重置游戏板/环境并将游戏重置为原始状态。不幸的是，Application.Restart() 总是很引人注目。

# math - 求和和 for 循环

> ID：11208272
> 
> 赞同：2
> 
> 时间：2012-06-26T13:23:45.280
> 
> 标签：math, loops, sum

我在阅读一篇有很多公式的文章时遇到了麻烦。它有几个总结（我的意思是这样的：∑h ∑i）我可以把它写成两个嵌套的for循环吗？

喜欢：

```
for (h=1; h<=5; h++){
    for(i=1; i<=5; i++){
        sum+=i;
    }
} 
```

谢谢你的耐心 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:35:21.510

如果您在[这里](http://translate.google.com/translate?hl=en&sl=pt&u=http://pt.wikipedia.org/wiki/Somat%25C3%25B3rio&prev=/search?q=somatorio&hl=en&biw=1186&bih=762&prmd=imvns&sa=X&ei=-bjpT-T2Boqa8gS357zwDQ&sqi=2&ved=0CEMQ7gEwAA)查看示例 11 ：

```
 Sum(Sum(x*y)) = Sum(x)*Sum(y) 
```

左边可以写成嵌套的for循环：

```
for(x goes 1 to n)
  for(y goes 1 to m)
    add to the result (x*y) 
```

右边可以写成两个独立的循环。

```
for(x goes 1 to n)
  add to the firstResult (x)
for(y goes 1 to m)
  add to the secondResult (y)
set result to firstResult * secondResult 
```

右侧提高了 O(n*m) 与 O(n+m) 的时间效率，但需要一些空间（保留第一个和第二个结果）。

# php - 使用 winrar 打开时，通过 Cakephp MediaViews 获取的 Zip 文件报告 Unexpected end of archive

> ID：11208276
> 
> 赞同：2
> 
> 时间：2012-06-26T13:23:55.897
> 
> 标签：php, download, zip, cakephp-2.0

我想要实现的目标：强制下载包含用户选择的 pdf 文件的 zip 文件。

我在控制器中做了什么来实现这一点：

1.  在文件夹 APP.WEBROOT_DIR.DS."package_files"（我使用 MPDF 库）中生成 pdf 报告 *它生成正确的可读 pdf。我在这里调用 $this->render();

2.  使用 php 的 Zip 功能，生成 package.zip（由上述指定文件夹中的 pdf 文件组成） *它会生成正确的 zip 文件，当从服务器下载时，它会在 Windows 中作为有效的 zip 文件打开。

3.  将控制器 viewClass 设置为 Media 并设置参数以强制下载为 zip 文件，*这里我再次调用 $this->render(); 问题：当我运行时，我得到了 zip 文件，但是当用 winrar 打开时，得到的 Zip 文件报告了 Unexpected end of archive。

我没有得到任何有用的文章来解决这个问题......

**我猜是调用两次渲染导致文件损坏** 谢谢

我的控制器代码：

`/** before this code i generate pdf files and have no issue **/`

 `/** now scan through the directory and add all the pdf files to a zip archive **/

```
 $dir = new Folder("".APP.WEBROOT_DIR.DS."package_files");

    $files = $dir->find('.*\.pdf');
    $zip = new ZipArchive();
    foreach ($files as $file) {
        $file_path = $dir->pwd() . DS . $file;

        $filename =  $dir->pwd() . DS ."package.zip";

        if ($zip->open($filename, ZIPARCHIVE::CREATE)!==TRUE) {
            exit("cannot open <$filename>\n");
        }  
        $zip->addFile($file_path,$file);

    }

    $zip->close(); 
```

/** now render the action to download the generated zip file **/

```
 $this->viewClass = 'Media';

        $params = array(
            'id'        => 'package.zip',
            'name'      => 'packaged_file',
            'download'  => true,
            'extension' => 'zip',
            'path'      => APP . WEBROOT_DIR.DS.'package_files' . DS
        );
        $this->set($params);
    $this->render(); 
````  `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-31T19:34:45.227

首先，如果您使用 Cakephp 2.3，请使用具有以下结构的 mediaView 的蛋糕响应文件：

```
$this->response->file($file['path']);
// Return response object to prevent controller from trying to render
// a view
return $this->response; 
```

这是文档：[http ://book.cakephp.org/2.0/en/controllers/request-response.html#cake-response-file](http://book.cakephp.org/2.0/en/controllers/request-response.html#cake-response-file)

否则删除 $this->render(); 在您的操作结束时并专门为 zip 和 rar 文件指定 mime 类型选项，例如为 docx 文件添加 mime 类型选项，如：

```
// Render app/webroot/files/example.docx
    $params = array(
        'id'        => 'example.docx',
        'name'      => 'example',
        'extension' => 'docx',
        'mimeType'  => array(
            'docx' => 'application/vnd.openxmlformats-officedocument' .
                '.wordprocessingml.document'
        ),
        'path'      => 'files' . DS
    ); 
````

# asp.net-mvc-3 - 在 MVC 3 中为局部视图着色

> ID：11208277
> 
> 赞同：1
> 
> 时间：2012-06-26T13:23:58.423
> 
> 标签：asp.net-mvc-3, css

在我看来，我使用带有来自我的模型的对象列表的局部视图，如下所示：

```
@foreach (var item in Model.MyObjectList)
{
    @Html.Partial("DisplayObject", item)   
} 
```

这在我的主视图中形成了一个网格图案，每个对象有 1 行。

我想用一种颜色的奇数行，另一种颜色的偶数行的正常方法对它们进行条纹。（例如[这样](https://stackoverflow.com/questions/4929538/c-sharp-mvc3-razor-alternating-items-in-a-foreach-list)。

通常你会通过某种模式计算来做到这一点。

问题是如果不将项目中的行号传递到部分视图中，我无法弄清楚如何做到这一点。

有没有更简单的方法？Html.Partial 没有任何我可以挂钩的 html 属性。

我当然可以在部分周围放一张桌子并以这种方式对其进行条纹，但我不希望这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:26:45.897

我认为您应该将模型中的信息传递给部分视图，或者将部分视图包装在一个元素中并将正确的 css 应用于它......比如：

```
@foreach (var item in Model.MyObjectList) {
    <li class="odd|even">
    @Html.Partial("DisplayObject", item)  
    </li>  
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:27:06.863

如果您可以限制对 CSS3 的支持，您可以使用`:nth-child(odd)`和`:nth-child(even)`规则 - 如 W3C 的此页面所示 - [http://www.w3.org/Style/Examples/007/evenodd.en.html](http://www.w3.org/Style/Examples/007/evenodd.en.html)

这些示例展示了如何在`tr`标签上使用它 - 但它适用于您可以将选择器应用于的任何内容：

```
<style type="text/css">
  div p:nth-child(odd) { color:red; }
  div p:nth-child(even) { color:green; }
</style>
<div>
  <p>first</p>
  <p>second</p>
  <p>third</p>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:40:20.963

将`Mode`值`ViewBag`从主视图传递到部分视图。

```
@foreach (var item in Model.MyObjectList) 
{
    if(ViewBag.Mode == "odd")
    {
       ViewBag.Mode = "even";
    }
    else
    {
      ViewBag.Mode = "odd";
    }

    @Html.Partial("DisplayObject", item)  
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:28:31.800

将行号作为属性添加到定义每个“项目”的类的定义中。

在局部视图中使用该属性来确定它是奇数行还是偶数行。

# vba - 从递归函数退出 While 循环

> ID：11208279
> 
> 赞同：1
> 
> 时间：2012-06-26T13:24:08.823
> 
> 标签：vba, excel

我编写了这段代码来删除 Excel 电子表格列中的重复行。我不确定如何或是否可以从函数本身中退出 while 循环。我不想在循环中添加第二个条件（例如`Counter < 100`），因为我不希望它运行得超出需要。

```
Sub Deletion()
Dim Cond As Boolean
Dim Counter As Integer
Cond = True
Counter = 2
    While Cond = True
    RecDel (Counter)
    Counter = Counter + 1
    Wend
End Sub

Function RecDel(Varii As Integer)
Set CurrentCell = Workbooks("Duplicate.xls").Sheets("Sheet1").Cells(Varii, 2)
        If CurrentCell.Value = CurrentCell.Offset(1, 0).Value And CurrentCell.Offset(1, 0).Value <> "" Then
                Workbooks("Duplicate.xls").Sheets("Sheet1").Rows(Varii + 1).Delete
                RecDel (Varii) 'Repeats deletion until this row and the next row are different
        ElseIf CurrentCell.Offset(1, 0).Value = "" Then
            Cond = False  'This can't change the global variable and break the loop
        Else
        End If
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:33:58.567

问题是你的`Cond`in the function 和`Cond`in the sub 不一样。它们都是局部变量。您可以使`Cond`全局在 2 之间共享它。或者，您可以让您的函数返回一个布尔值并完全摆脱该`Cond`标志：

```
Function RecDel(Varii As Integer) As Boolean
    Set CurrentCell = Workbooks("Duplicate.xls").Sheets("Sheet1").Cells(Varii, 2)
    If CurrentCell.Value = CurrentCell.Offset(1, 0).Value And CurrentCell.Offset(1, 0).Value <> "" Then
        Workbooks("Duplicate.xls").Sheets("Sheet1").Rows(Varii + 1).Delete
        RecDel = RecDel (Varii) 'Repeats deletion until this row and the next row are different
    ElseIf CurrentCell.Offset(1, 0).Value = "" Then
        RecDel = False  'This can't change the global variable and break the loop
    End If
End Function 
```

在您的调用子中，检查 RecDel 的状态：

```
While RecDel (Counter) = True
    Counter = Counter + 1
Wend 
```

# asp.net - 使用 ASP.Net 进行正确的用户界面设计

> ID：11208280
> 
> 赞同：5
> 
> 时间：2012-06-26T13:24:11.663
> 
> 标签：asp.net, html, visual-studio-2010, user-interface

我正在设计 Web 应用程序的用户界面，但我对 UI 设计缺乏经验，我只是拖放标签和文本框，但它们看起来不是对称的，并且在页面上排列不正确。在 Windows 应用程序中，用户界面设计更容易，因为 Visual stuido 可以帮助您定位控件，但我不知道如何在 Web 应用程序中做到这一点。唯一的解决方案是输入 html 并使用大量空格字符使页面看起来井井有条吗？这只是让我觉得自己像个业余爱好者。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:26:53.553

Web 应用程序使用[CSS（层叠样式表）](http://www.w3schools.com/css/css_intro.asp)进行样式设置。CSS 用于 Web 应用程序中 UI 的各个方面。这不仅限于 ASP.NET，还包括一般的 Web 开发。

ASP.NET 和 Visual Studio（或其他 IDE）可能允许您使用熟悉的拖放界面来创建 UI，但在后台，ASP.NET 和这些工具只是为样式生成 css。

例如，在 Visual Studio 2010 中，您可以选择“将使用工具箱、粘贴或拖放添加的控件的定位更改为绝对位置”。在 HTML 设计器选项中

![在此处输入图像描述](../Images/9d9222bb4225d2cc6972ffafa6fbcda6.png)

如果您愿意，可以使用这些工具拖放元素，但出于以下几个原因，***我强烈建议您不要沿着这条路开始：***

*   除非您了解 css，否则您将难以解决其他简单的定位和样式问题。公开的拖放工具和属性通常是不够的。
*   Web 设计与 WinForms 设计有很大不同。您需要处理更多的屏幕分辨率和浏览器大小调整，这些都需要流畅。绝对定位对此很可怕。
*   一旦你学习了错误的方式，就很难改变你的方式。最好提前学习“正确的方法”。

[这里](http://www.w3schools.com/css/default.asp)有一个相对简单的 CSS 教程。

很抱歉没有一个快速简单的答案，但是如果你要进行 Web 开发，你需要学会正确使用 css，而且还有很多东西要学。希望本教程将是一个温和的介绍。

如果你不喜欢那个，试试[这个 Bing 搜索](http://www.bing.com/search?q=css%20tutorial&form=CMDTDF&pc=CMDTDF&src=IE-SearchBox)。

# ios - 链接错误 iOS

> ID：11208283
> 
> 赞同：0
> 
> 时间：2012-06-26T13:24:23.013
> 
> 标签：ios, objective-c, cocoa-touch

我在 iOS 中有这些奇怪的链接错误。有人可以解释它们以及如何解决它们吗？谢谢！

`Undefined symbols for architecture i386: "_OBJC_CLASS_$_Parser", referenced from: objc-class-ref in MasterViewController.o ld: symbol(s) not found for architecture i386 clang: error: linker command failed with exit code 1 (use -v to see invocation)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:28:08.360

*   转到项目导航器：`CMD`+`1`
*   选择文件“Parser.m”（或包含类 Parser 的文件）
*   显示文件检查器：`OPT`++`CMD``1`
*   向下滚动到目标会员
*   确保为您正在构建的目标选中该框。

# asp.net - 关于关键字搜索和lucene.net c#

> ID：11208291
> 
> 赞同：0
> 
> 时间：2012-06-26T13:24:38.500
> 
> 标签：asp.net, lucene.net

我只是在 lucene.net 上浏览文章。我得到了一些使用 lucene.net 创建索引的示例代码，我不清楚几行代码。这是那些线

```
 protected void btnCreateIndex_Click(object sender, EventArgs e)
{
    IndexWriter writer = new IndexWriter(MapPath("~/searchlucene/"), new StandardAnalyzer(), false);

    IndexDocument(writer, "About Hockey", "hockey", "Hockey is a cool sport which I really like, bla bla");
    IndexDocument(writer, "Some great players", "hockey", "Some of the great players from Sweden - well Peter Forsberg, Mats Sunding, Henrik Zetterberg");
    IndexDocument(writer, "Soccer info", "soccer", "Soccer might not be as fun as hockey but it's also pretty fun");
    IndexDocument(writer, "Players", "soccer", "From Sweden we have Zlatan Ibrahimovic and Henrik Larsson. They are the most well known soccer players");
    IndexDocument(writer, "1994", "soccer", "I remember World Cup 1994 when Sweden took the bronze. we had great players. players , bla bla");
    IndexDocument(writer, "BBA-header", "BBA-321type", "Hello BBA");

    writer.Optimize();
    writer.Close();

}
private void IndexDocument(IndexWriter writer, string sHeader, string sType, string sContent)
{
    Document doc = new Document();

    doc.Add(new Field("header", sHeader, Field.Store.YES, Field.Index.TOKENIZED));
    doc.Add(new Field("type", sType, Field.Store.YES, Field.Index.TOKENIZED));
    doc.Add(new Field("content", sContent, Field.Store.YES, Field.Index.TOKENIZED));
    writer.AddDocument(doc);
} 
```

## 我有几个问题

1) doc.Add(new Field("header", sHeader, Field.Store.YES, Field.Index.TOKENIZED)); 这条线是什么意思。**Field.Index.TOKENIZED**什么是 TOKENIZED 和 UNTOKENIZED？当我搜索类型参数中指定的关键字时，什么都没有。只是不了解行为

这是搜索示例，其中我指定了一个作为索引类型的关键字

```
 ListBox1.Items.Clear();
    var searcher = new Lucene.Net.Search.IndexSearcher(MapPath("~/searchlucene/"));
    var oParser = new Lucene.Net.QueryParsers.QueryParser("content", new StandardAnalyzer());
    string sHeader = " OR (header:" + TextBox1.Text + ")";
    string sType = " OR (type:" + TextBox1.Text + ")";
    string sSearchQuery = "(" + TextBox1.Text + sHeader + sType + ")";

    var oHitColl = searcher.Search(oParser.Parse(sSearchQuery));
    for (int i = 0; i < oHitColl.Length(); i++)
    {
        Document oDoc = oHitColl.Doc(i);
        ListBox1.Items.Add(new ListItem(oDoc.Get("header") + oDoc.Get("type") +  oDoc.Get("content")));            
    }

    searcher.Close(); 
```

请有人帮助我理解以消除我的困惑。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:56:57.613

我刚刚测试了你的代码，它在 Lucene 2.9.4 上运行良好。

`Field.Index.TOKENIZED`意味着分析器会将您的文本分解为标记，这意味着它可以全文搜索。您将`UN_TOKENIZED`用于您不想分析的字段，例如产品 ID。

注意：您应该使用哪些是`Field.Index.ANALYZED`其已弃用/对应物`Field.Index.NOT_ANALYZED`的替代品。`TOKENIZED``UN_TOKENIZED`

要查看已分析和未分析之间的差异，您可以同时尝试并使用 Luke 检查您的索引，这可能会让您对它的工作原理有一个很好的了解。

[http://code.google.com/p/luke/](http://code.google.com/p/luke/)

# c - 如何在没有 libcurl 的情况下在 C 中发出 HTTP 获取请求？

> ID：11208299
> 
> 赞同：54
> 
> 时间：2012-06-26T13:24:50.180
> 
> 标签：c, http, sockets, networking, http-headers

我想编写一个 C 程序来生成一个获取请求而不使用任何外部库。这是否可能仅使用 C 库，使用套接字？我正在考虑制作一个http数据包（使用正确的格式）并将其发送到服务器。这是唯一可能的方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-26T13:44:49.217

使用 BSD 套接字，或者，如果你有一些限制，假设你有一些 RTOS，一些更简单的 TCP 堆栈，如 lwIP，你可以形成 GET/POST 请求。

有许多开源实现。请参阅“happyhttp”作为示例（[http://scumways.com/happyhttp/happyhttp.html](http://scumways.com/happyhttp/happyhttp.html)）。我知道，它是 C++，而不是 C，但唯一“依赖于 C++”的是字符串/数组管理，因此很容易移植到纯 C。

请注意，没有“数据包”，因为 HTTP 通常通过 TCP 连接传输，所以从技术上讲，只有 RFC 格式的符号流。由于 http 请求通常以连接-发送-断开方式完成，因此实际上可以将其称为“数据包”。

基本上，一旦你有一个打开的套接字（sockfd）“所有”你需要做的就是

```
char sendline[MAXLINE + 1], recvline[MAXLINE + 1];
char* ptr;

size_t n;

/// Form request
snprintf(sendline, MAXSUB, 
     "GET %s HTTP/1.0\r\n"  // POST or GET, both tested and works. Both HTTP 1.0 HTTP 1.1 works, but sometimes 
     "Host: %s\r\n"     // but sometimes HTTP 1.0 works better in localhost type
     "Content-type: application/x-www-form-urlencoded\r\n"
     "Content-length: %d\r\n\r\n"
     "%s\r\n", page, host, (unsigned int)strlen(poststr), poststr);

/// Write the request
if (write(sockfd, sendline, strlen(sendline))>= 0) 
{
    /// Read the response
    while ((n = read(sockfd, recvline, MAXLINE)) > 0) 
    {
        recvline[n] = '\0';

        if(fputs(recvline, stdout) == EOF)
        {
            printf("fputs() error\n");
        }

        /// Remove the trailing chars
        ptr = strstr(recvline, "\r\n\r\n");

        // check len for OutResponse here ?
        snprintf(OutResponse, MAXRESPONSE,"%s", ptr);
    }          
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2016-02-28T09:06:17.963

**POSIX 7 最小可运行示例**

让我们获取[http://example.com](http://example.com)。

wget.c

```
#define _XOPEN_SOURCE 700
#include <arpa/inet.h>
#include <assert.h>
#include <netdb.h> /* getprotobyname */
#include <netinet/in.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <unistd.h>

int main(int argc, char** argv) {
    char buffer[BUFSIZ];
    enum CONSTEXPR { MAX_REQUEST_LEN = 1024};
    char request[MAX_REQUEST_LEN];
    char request_template[] = "GET / HTTP/1.1\r\nHost: %s\r\n\r\n";
    struct protoent *protoent;
    char *hostname = "example.com";
    in_addr_t in_addr;
    int request_len;
    int socket_file_descriptor;
    ssize_t nbytes_total, nbytes_last;
    struct hostent *hostent;
    struct sockaddr_in sockaddr_in;
    unsigned short server_port = 80;

    if (argc > 1)
        hostname = argv[1];
    if (argc > 2)
        server_port = strtoul(argv[2], NULL, 10);

    request_len = snprintf(request, MAX_REQUEST_LEN, request_template, hostname);
    if (request_len >= MAX_REQUEST_LEN) {
        fprintf(stderr, "request length large: %d\n", request_len);
        exit(EXIT_FAILURE);
    }

    /* Build the socket. */
    protoent = getprotobyname("tcp");
    if (protoent == NULL) {
        perror("getprotobyname");
        exit(EXIT_FAILURE);
    }
    socket_file_descriptor = socket(AF_INET, SOCK_STREAM, protoent->p_proto);
    if (socket_file_descriptor == -1) {
        perror("socket");
        exit(EXIT_FAILURE);
    }

    /* Build the address. */
    hostent = gethostbyname(hostname);
    if (hostent == NULL) {
        fprintf(stderr, "error: gethostbyname(\"%s\")\n", hostname);
        exit(EXIT_FAILURE);
    }
    in_addr = inet_addr(inet_ntoa(*(struct in_addr*)*(hostent->h_addr_list)));
    if (in_addr == (in_addr_t)-1) {
        fprintf(stderr, "error: inet_addr(\"%s\")\n", *(hostent->h_addr_list));
        exit(EXIT_FAILURE);
    }
    sockaddr_in.sin_addr.s_addr = in_addr;
    sockaddr_in.sin_family = AF_INET;
    sockaddr_in.sin_port = htons(server_port);

    /* Actually connect. */
    if (connect(socket_file_descriptor, (struct sockaddr*)&sockaddr_in, sizeof(sockaddr_in)) == -1) {
        perror("connect");
        exit(EXIT_FAILURE);
    }

    /* Send HTTP request. */
    nbytes_total = 0;
    while (nbytes_total < request_len) {
        nbytes_last = write(socket_file_descriptor, request + nbytes_total, request_len - nbytes_total);
        if (nbytes_last == -1) {
            perror("write");
            exit(EXIT_FAILURE);
        }
        nbytes_total += nbytes_last;
    }

    /* Read the response. */
    fprintf(stderr, "debug: before first read\n");
    while ((nbytes_total = read(socket_file_descriptor, buffer, BUFSIZ)) > 0) {
        fprintf(stderr, "debug: after a read\n");
        write(STDOUT_FILENO, buffer, nbytes_total);
    }
    fprintf(stderr, "debug: after last read\n");
    if (nbytes_total == -1) {
        perror("read");
        exit(EXIT_FAILURE);
    }

    close(socket_file_descriptor);
    exit(EXIT_SUCCESS);
} 
```

[GitHub 上游](https://github.com/cirosantilli/linux-kernel-module-cheat/blob/b4b2164f29f3ae04ae9e3b7c0913ee8125910476/userland/posix/wget.c).

编译：

```
gcc -ggdb3 -std=c99 -Wall -Wextra -o wget wget.c 
```

获取[http://example.com](http://example.com)并输出到标准输出：

```
./wget example.com 
```

我们看到类似的东西：

```
debug: before first read
debug: after a read
HTTP/1.1 200 OK
Age: 540354
Cache-Control: max-age=604800
Content-Type: text/html; charset=UTF-8
Date: Tue, 02 Feb 2021 15:21:14 GMT
Etag: "3147526947+ident"
Expires: Tue, 09 Feb 2021 15:21:14 GMT
Last-Modified: Thu, 17 Oct 2019 07:18:26 GMT
Server: ECS (nyb/1D11)
Vary: Accept-Encoding
X-Cache: HIT
Content-Length: 1256

<!doctype html>
<html>
...
</html> 
```

打印回复后，对于大多数服务器，此命令会挂起，直到超时，这是预期的：

*   服务器或客户端必须关闭连接
*   我们（客户）没有这样做
*   大多数 HTTP 服务器保持连接打开，直到超时期待进一步的请求，例如 HTML 页面后的 JavaScript、CSS 和图像
*   我们可以解析响应，并在读取 Content-Length 字节时关闭，但为了简单起见我们没有这样做。[需要什么 HTTP 响应标头](https://stackoverflow.com/questions/4726515/what-http-response-headers-are-required/25586633#25586633)表示如果`Content-Length` 未发送，则服务器可以关闭以确定长度。

但是，我们可以通过将 HTTP 1.1 标准标头添加[`Connection: close`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Connection)到服务器来关闭主机：

```
char request_template[] = "GET / HTTP/1.1\r\nHost: %s\r\nConnection: close\r\n\r\n"; 
```

连接部分也适用于 IP：

```
host example.com 
```

给出：

```
example.com has address 93.184.216.34
example.com has IPv6 address 2606:2800:220:1:248:1893:25c8:1946 
```

所以我们这样做：

```
./wget 93.184.216.34 
```

然而，回复是一个错误，因为我们没有`Host:`在我们的程序中正确设置，这是[HTTP 1.1 所要求的](https://stackoverflow.com/questions/6686261/what-at-the-bare-minimum-is-required-for-an-http-request)。

在 Ubuntu 18.04 上测试。

**服务器示例**

*   最小的 POSIX C 示例：[使用 C/C++ (GCC/G++) 在 Linux 中的套接字编程中发送和接收文件](https://stackoverflow.com/questions/2014033/send-and-receive-a-file-in-socket-programming-in-linux-with-c-c-gcc-g/35902226#35902226)
*   最小的 Android Java 示例：[如何在 Android 中创建 Socket 连接？](https://stackoverflow.com/questions/7384678/how-to-create-socket-connection-in-android/35745834#35745834)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-26T13:58:32.670

严格来说，“没有任何外部库”也将排除 libc，因此您必须自己编写所有系统调用。不过，我怀疑你的意思是那么严格。如果您不想链接到另一个库，并且不想将另一个库中的源代码复制到您的应用程序中，那么使用套接字 API 直接处理 TCP 流是您最好的方法。

创建[HTTP](https://www.rfc-editor.org/rfc/rfc2616)请求并通过[TCP 套接字连接](http://www.gnu.org/software/libc/manual/html_node/Inet-Example.html)发送它很容易，就像阅读答案一样。它解析的答案将非常棘手，特别是如果您的目标是支持相当大的标准部分。如果您正在与任意 Web 服务器通信，诸如错误页面、重定向、内容协商等之类的事情会使我们的生活变得非常困难。另一方面，如果已知服务器表现良好，并且任何意外的服务器响应都可以使用简单的错误消息，那么这也相当简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-29T05:16:25.373

试试 Socket Programming，下面的 C++ 代码向指定主机发出一个简单的 GET 请求并打印响应头和内容

在 Windows 10 中测试

```
#include <windows.h>
#include <string>
#include <stdio.h>
#include <winsock2.h>

using std::string;

SOCKET conn;
WSADATA wsaData;
struct hostent *hp;
unsigned int addr;
struct sockaddr_in server;
long fileSize;
const int bufSize = 512;
char readBuffer[bufSize], sendBuffer[bufSize], tmpBuffer[bufSize];
char *memBuffer=NULL;
char *headerBuffer=NULL;
long totalBytesRead, thisReadSize, headerLen;
char *tmpResult=NULL, *result;

char* antenna(string host,string path);
SOCKET connectToServer(char *szServerName, WORD portNum);
int getHeaderLength(char *content);

int main(){  

    if(WSAStartup(0x101, &wsaData) != 0){printf("startup failure");}
    memBuffer = antenna("www.spreadsheets.google.com", "/feeds/list/{Published_Sheet_ID-1}/1/public/values?alt=json");
    printf("Response content:\n%s\n\n", memBuffer);

    memBuffer = antenna("www.spreadsheets.google.com", "/feeds/list/{Published_Sheet_ID-2}/1/public/values?alt=json");
    printf("Response content:\n%s", memBuffer);

    WSACleanup();
}

char *antenna(string host, string path){

    fileSize=0;
    totalBytesRead=0;
    memBuffer=NULL;
    headerBuffer=NULL;
    tmpResult=NULL,

    conn = connectToServer((char*)host.c_str(), 80);
    if(conn == 0){printf("No Internet connection");}

    sprintf(sendBuffer, "GET %s HTTP/1.0 \r\nHost: %s\r\nConnection: close\r\n\r\n", path.c_str(),host.c_str());
    send(conn, sendBuffer, strlen(sendBuffer), 0);
    printf("Request Format: \n%s",sendBuffer);
    while(1){

        memset(readBuffer, 0, bufSize);
        thisReadSize = recv (conn, readBuffer, bufSize, 0);

        if ( thisReadSize <= 0 ){break;}

        tmpResult = (char*)realloc(tmpResult, thisReadSize+totalBytesRead);

        memcpy(tmpResult+totalBytesRead, readBuffer, thisReadSize);
        totalBytesRead += thisReadSize;
    }

    headerLen = getHeaderLength(tmpResult);
    long contenLen = totalBytesRead-headerLen;
    result = new char[contenLen+1];
    memcpy(result, tmpResult+headerLen, contenLen);
    result[contenLen] = 0x0;
    char *myTmp;
    myTmp = new char[headerLen+1];
    strncpy(myTmp, tmpResult, headerLen);
    myTmp[headerLen] = 0;
    delete(tmpResult);
    headerBuffer = myTmp;

    printf("Response Header: \n%s",headerBuffer);
    fileSize = contenLen;
    closesocket(conn);

    if(fileSize != 0){

        delete(memBuffer);
        delete(headerBuffer);
    }
    return(result);
}

SOCKET connectToServer(char *szServerName, WORD portNum)
{
    conn = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    if (conn == INVALID_SOCKET){return 0;}
    if(inet_addr(szServerName)==INADDR_NONE){hp=gethostbyname(szServerName);}
    else{
        addr=inet_addr(szServerName);
        hp=gethostbyaddr((char*)&addr,sizeof(addr),AF_INET);
    }

    if(hp==NULL){closesocket(conn);return 0;}

    server.sin_addr.s_addr=*((unsigned long*)hp->h_addr);
    server.sin_family=AF_INET;
    server.sin_port=htons(portNum);
    if(connect(conn,(struct sockaddr*)&server,sizeof(server)))
    {
        closesocket(conn);
        return 0;
    }
    return conn;
}

int getHeaderLength(char *content)
{
    const char *srchStr1 = "\r\n\r\n", *srchStr2 = "\n\r\n\r";
    char *findPos;
    int ofset = -1;

    findPos = strstr(content, srchStr1);
    if (findPos != NULL)
    {
        ofset = findPos - content;
        ofset += strlen(srchStr1);
    }

    else
    {
        findPos = strstr(content, srchStr2);
        if (findPos != NULL)
        {
            ofset = findPos - content;
            ofset += strlen(srchStr2);
        }
    }
    return ofset;
} 
```

编译（使用 g++）：

```
g++ -static test.cpp -o test.exe -lws2_32 
```

-lws2_32 指定与 winsock dll 链接的链接器

# windows - 需要使用 DFWIN 模块将 Fortran 代码移植到 gcc/gfortran，我从哪里开始？

> ID：11208300
> 
> 赞同：1
> 
> 时间：2012-06-26T13:24:53.460
> 
> 标签：windows, fortran, gfortran

**更新**经过一番挖掘，我发现这是一些解决方法的一部分，该解决方法使用`OPENPIPE`. `OPENPIPE`简单地返回一个外部声明的文件句柄，对管道完全不做任何事情。`OPENHOLDFILENAME`实际上创建了一个文件，但我仍然对`DFWIN`与此有关的内容感到困惑。是否需要提供函数声明`OPENPIPE`？如果是这样，他们为什么还要`EXTERNAL`在 Fortran 代码中声明它？

* * *

我的任务是在 GCC 工具链上编译旧版 Fortran。我已经成功编译了一些源文件，但是在`DFWIN` 链接到一些 Win32 API 函数的模块方面遇到了障碍。它显然使用了一些 Win32 管道函数，我需要将其替换为适用于 gfortran 的现代等效函数（旧编译器是 Compaq Visual Fortran）。

首先，我看到了`DFWIN`包含的模块，以及一些外部函数：

```
 USE DFWIN
    EXTERNAL OPENPIPE
    EXTERNAL OPENHOLDFILENAME 
```

以下是如何`OPENPIPE`使用的示例：

```
 OPEN(UNIT=INN,FILE=
    1   '\\.\pipe\input.txt',
    1   FORM='FORMATTED',STATUS='old',readonly,
    1   USEROPEN=OPENPIPE) 
```

在使用 gcc/gfortran 的现代 Windows/Linux 系统上，我可以使用什么模块来替换这些调用？

**编辑**：我们的首要任务是让它在 Windows 上运行，但将来我们也希望在 Linux 上部署。

# jquery - 仅使用类似于 Jquery UI Button 的 CSS 样式选择 Box

> ID：11208302
> 
> 赞同：3
> 
> 时间：2012-06-26T13:24:54.837
> 
> 标签：jquery, jquery-ui

我可以使用 .button() 创建漂亮的提交按钮，但我页面上的其余元素，尤其是选择框仍然是常规的、丑陋的 css 样式。

有没有办法为我的选择框劫持 Jquery UI Button 的 css 样式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T13:36:28.303

不完全没有。选择/下拉框通常取决于操作系统和浏览器。您无法在细粒度级别上对其进行控制。

Chrome / Webkit 浏览器允许一些样式。请参阅此问题：[如何在没有 JavaScript 的情况下仅使用 CSS 设置 <select> 下拉菜单的样式？](https://stackoverflow.com/questions/1895476/how-to-style-a-select-dropdown-with-css-only-without-javascript)

如果您能够使用额外的标记来包围，`select`那么您可以做一些事情。

见：[http ://bavotasan.com/2011/style-select-box-using-only-css/](http://bavotasan.com/2011/style-select-box-using-only-css/)

否则，您必须求助于 JS 解决方案，例如

[http://cssglobe.com/post/8802/custom-styling-of-the-select-elements](http://cssglobe.com/post/8802/custom-styling-of-the-select-elements)

和

[http://www.htmlgoodies.com/beyond/css/how-to-create-custom-select-menus-with-css.html](http://www.htmlgoodies.com/beyond/css/how-to-create-custom-select-menus-with-css.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-21T23:20:39.253

使用 jquery-ui 1.10.2，假设您已经从 themeroller 下载并安装了一个不错的主题：

```
<select id="myselect">
  <option> Option 1 </option>
  <option> Option 2 </option>
  <option> Option 3 </option>
  <option> Option 4 </option>
</select>

<script type="text/javascript">
  $("#myselect").menu();
</script> 
```

适用于 Chrome 和 Safari...

# hibernate - hibernate not-null 属性引用 null 或瞬态值：

> ID：11208308
> 
> 赞同：4
> 
> 时间：2012-06-26T13:25:23.553
> 
> 标签：hibernate, entitymanager, hibernate-entitymanager

这个问题随机出现。程序运行了一个多月，今天它崩溃了。在添加新订单时，用户可以从下拉列表中选择一家公司。然后他可以将新订单保存到数据库中。即使现在重新加载应用程序，它也能在大多数情况下工作。错误代码如下：

javax.persistence.PersistenceException：org.hibernate.PropertyValueException：非空属性引用空值或瞬态值：mapped.Order.company (odwzorowania.Zlecenie.firma)

使用休眠、JSF 2.1、MySql 5.5、javax.persistence.*

这是代码（名称是从波兰语翻译过来的）

```
public void update(Order order) throws AdException
{
    try
    {
        begin();

            Company fir2 = order.getCompany();

            em.merge(fir2);
            em.merge(order);

        commit();
    }
    catch( HibernateException e )
    {
        rollback();
        throw new AdException("Nie mozna zaktualizować zlecenia",e);
    }
} 
```

订单实体

```
 import javax.persistence.* //fixed in real code

    @Entity
    @Table(name = "order")

    public class Order implements Serializable {
    private static final long serialVersionUID = 1L;

    private Integer idOrder;
    private Company company;
    [...]

    @JoinColumn(name = "company_idCompany", referencedColumnName = "idCompany")
    @ManyToOne(optional = false, fetch = FetchType.LAZY)
    public Company getCompany() {
        return company;
    }

    public void setCompany(Company company) {
        this.company = company;
    }
    [...] 
```

公司实体

```
import javax.persistence.*

@Entity
@Table(name = "company")

public class Company implements Serializable {

private static final long serialVersionUID = 1L;

private Integer idCompany;       
private List<Order> orderList;
[...]

@OneToMany(mappedBy = "company", fetch = FetchType.LAZY)
public List<Order> getOrderList() {
    return orderList;
}

public void setOrderList(List<Order>orderList) {
    this.orderList = orderList;
}
[...] 
```

堆栈跟踪（mapped.Order.company 与从波兰语翻译而来的 odwzorowania.Zlecenie.firma 相同）

```
2012-xx-xx xx:xx:xx com.sun.faces.application.ApplicationImpl newThing
SEVERE: Unable to load class: 
javax.persistence.PersistenceException: org.hibernate.PropertyValueException: not-null property references a null or transient value: odwzorowania.Zlecenie.firma
    at org.hibernate.ejb.AbstractEntityManagerImpl.throwPersistenceException(AbstractEntityManagerImpl.java:637)
    at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:74)
    at controllery.FirmaController.get(FirmaController.java:84)
    at validatory.FirmyValidator.<init>(FirmyValidator.java:32)
    at sun.reflect.GeneratedConstructorAccessor154.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
    at java.lang.Class.newInstance0(Class.java:372)
    at java.lang.Class.newInstance(Class.java:325)
    at com.sun.faces.application.ApplicationImpl.newThing(ApplicationImpl.java:1699)
    at com.sun.faces.application.ApplicationImpl.createValidator(ApplicationImpl.java:1557)
    at com.sun.faces.facelets.tag.jsf.ValidatorTagHandlerDelegateImpl.createValidator(ValidatorTagHandlerDelegateImpl.java:238)
    at com.sun.faces.facelets.tag.jsf.ValidatorTagHandlerDelegateImpl.applyAttachedObject(ValidatorTagHandlerDelegateImpl.java:132)
    at com.sun.faces.facelets.tag.jsf.ValidatorTagHandlerDelegateImpl.applyNested(ValidatorTagHandlerDelegateImpl.java:205)
    at com.sun.faces.facelets.tag.jsf.ValidatorTagHandlerDelegateImpl.apply(ValidatorTagHandlerDelegateImpl.java:87)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.applyNextHandler(DelegatingMetaTagHandler.java:137)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:188)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.applyNextHandler(DelegatingMetaTagHandler.java:137)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:188)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.applyNextHandler(DelegatingMetaTagHandler.java:137)
    at com.sun.faces.facelets.tag.jsf.ComponentTagHandlerDelegateImpl.apply(ComponentTagHandlerDelegateImpl.java:188)
    at javax.faces.view.facelets.DelegatingMetaTagHandler.apply(DelegatingMetaTagHandler.java:120)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at com.sun.faces.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:93)
    at javax.faces.view.facelets.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:98)
    at com.sun.faces.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:86)
    at com.sun.faces.facelets.impl.DefaultFacelet.apply(DefaultFacelet.java:152)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.buildView(FaceletViewHandlingStrategy.java:769)
    at com.sun.faces.application.view.StateManagementStrategyImpl.restoreView(StateManagementStrategyImpl.java:232)
    at com.sun.faces.application.StateManagerImpl.restoreView(StateManagerImpl.java:188)
    at com.sun.faces.application.view.ViewHandlingStrategy.restoreView(ViewHandlingStrategy.java:123)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.restoreView(FaceletViewHandlingStrategy.java:452)
    at com.sun.faces.application.view.MultiViewHandler.restoreView(MultiViewHandler.java:148)
    at com.sun.faces.lifecycle.RestoreViewPhase.execute(RestoreViewPhase.java:192)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:116)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:636)
Caused by: org.hibernate.PropertyValueException: not-null property references a null or transient value: odwzorowania.Zlecenie.firma
    at org.hibernate.engine.Nullability.checkNullability(Nullability.java:72)
    at org.hibernate.event.def.DefaultFlushEntityEventListener.scheduleUpdate(DefaultFlushEntityEventListener.java:270)
    at org.hibernate.event.def.DefaultFlushEntityEventListener.onFlushEntity(DefaultFlushEntityEventListener.java:128)
    at org.hibernate.event.def.AbstractFlushingEventListener.flushEntities(AbstractFlushingEventListener.java:196)
    at org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:76)
    at org.hibernate.event.def.DefaultAutoFlushEventListener.onAutoFlush(DefaultAutoFlushEventListener.java:35)
    at org.hibernate.impl.SessionImpl.autoFlushIfRequired(SessionImpl.java:969)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1114)
    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)
    at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:65)
    ... 58 more 
```

我找到了一些答案，但似乎没有一个适合我的问题。如您所见，我正在更新公司和订单之间双向关联的双方。

编辑：固定翻译

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:08:01.897

我认为实体公司和实体订单之间的关系是您问题的原因。实体订单没有公司。

一个问题，order.getCompany() 在您的测试期间可能为空？您对实体 Order 的映射是：

```
@ManyToOne(**optional = false**, fetch = FetchType.LAZY) 
```

我看到实体订单中需要字段公司。

问候

# javascript - JQuery Mousemove div 类 e.pageX 位置

> ID：11208309
> 
> 赞同：2
> 
> 时间：2012-06-26T13:25:24.240
> 
> 标签：javascript, jquery, css

我正在使用这段代码：

```
$('.my_img').mousemove(function(e){
   $('.mycls').css("left",e.pageX-20+"px");
   $('.mycls').css("top",e.pageY-10+"px");

}); 
```

然后...

```
<div class="mycls">I Move</div> 
```

然后...

```
<img class="my_img" src="myimg.png" /> 
```

我的问题是，如果我在这些 div 上方添加任何 div，则位置会发生变化，并且 mycls 不再位于鼠标位置。

因此，如果我要在这样的主体之后添加额外的 div：

```
<div>ONE</div>

<div>TWO</div> 
```

...然后其余的代码...我将失去位置：o/

关于如何排序的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:30:45.807

只需将 CSS 添加`position:absolute;`到您的可移动元素`.mycls`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:51:00.050

由于*e.pageX*和*e.pageY*值是相对于整个页面的，因此您的代码不应受到添加新元素的影响。如果将*top*和*left*设置为一个元素，它会定义它与页面顶部和左侧的距离。

唯一可能出现问题的情况是，如果您在*mycls* div的任何父元素上设置了*position:relative 。*删除那个*position:relative*，这样*top*和*left*指的是整个页面而不是父元素。

 **** * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-27T20:59:51.683

```
var img = document.getElementById("my_img");
var cls = document.getElementById("mycls");
img.onmousemove = function(e){
   cls.style.left = e.clientX-20 + "px";
   cls.style.top =  e.clientY-10 + "px";
};
```

```
#mycls {
  background-color: rgba(255,255,255,0.8);
  position: fixed;
  left: 0;
  top: 0;
  font-family: sans-serif;
  padding: 10px;
  border-radius: 5px;
  border: 1px solid rgba(0,0,0,0.8);
}
#my_img {
  width: 420px;
  height: 200px;
  background-color: #333;    }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="my_img">
  <div id="mycls">
  Your message here
  </div>
</div>
```

这是我过去如何做到这一点的一个示例......重要的是，正在移动的 div 是容器的子级，因此它触发的任何 mousemove 事件都会冒泡到父级进行处理***

# perl - Moose && utf8（包|方法）名称

> ID：11208310
> 
> 赞同：4
> 
> 时间：2012-06-26T13:25:30.780
> 
> 标签：perl, utf-8, moose

有这个：

```
use utf8;
package ÁngryBird;   #note the Á in the package name 
```

`perl -c`结果是**`syntax OK`**。

```
use utf8;
package ÁngryMoose;
use Moose; 
```

`perl -c`说，

```
ÁngryMoose is not a module name at 
/opt/local/lib/perl5/site_perl/5.12.4/darwin-multi-2level/Class/MOP/Package.pm
 line 209. 
```

那么，代码有什么问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T14:13:10.150

`Moose`使用[这个正则表达式](http://metacpan.org/source/DOY/Package-Stash-0.33/lib/Package/Stash/PP.pm#L37)来`Package::Stash::PP`检查包名称：

```
elsif ($package !~ /\A[0-9A-Z_a-z]+(?:::[0-9A-Z_a-z]+)*\z/) {
    confess "$package is not a module name";
} 
```

或者[这个正则表达式](http://metacpan.org/source/DOY/Package-Stash-XS-0.25/XS.xs#L807)来自`Package::Stash::XS`：

```
const char *vmre = "\\A[0-9A-Z_a-z]+(?:::[0-9A-Z_a-z]+)*\\z"; 
```

但是您可以在命名空间中[创建自己的包存储](http://metacpan.org/module/Package::Stash#DESCRIPTION)实现，并在加载之前`Package::Stash`通过设置环境变量`PACKAGE_STASH_IMPLEMENTATION`或变量来使用它。例如，如果您的实现具有名称，则将变量设置为.`$Package::Stash::IMPLEMENTATION``Package::Stash``Package::Stash::My``My`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:13:21.447

听起来这可能是一个`Class::MOP`错误。您是否尝试过在那里询问或报告错误？

# javascript - JS 验证以正常速度失败，但在单步执行代码时有效

> ID：11208314
> 
> 赞同：1
> 
> 时间：2012-06-26T13:25:45.357
> 
> 标签：javascript, jquery, forms, validation

当我单步执行时，js 验证工作完美，但以“正常速度”失败。 **具体来说：如果捕获到重复电子邮件但其他字段填写正确，则可以提交表单（但单步执行代码时不会出现错误）**。有没有人见过这个？我知道我可以用不同的方式对其进行编码，但我不能简单地摆脱这个甚至成为瓶颈的简单问题，而无需首先了解为什么这不起作用。

我的方法是验证 onblur 和 onsubmit。我使用 jquery 选择器只是为了方便，然后再次用于 ajax 调用，否则我使用的是 js。我正在遍历这些字段，但只对文本和密码字段进行操作。检查空格 检查名称中是否没有数字 检查电子邮件地址的格式是否正确，然后在电子邮件字段中检查唯一的电子邮件，下面的 js 注释代码和下面的表格：

```
//registration validation
$('.validate').blur(function() {
var theForm = document.registerNewUserForm;         
//removes error messages from html before the run
clearAllErrors(theForm);
var msg = "";
var mdiv;
theForm.submit.disabled=true;
document.getElementById("submitButton").disabled = true;

for (var i = 0; i < theForm.elements.length; i++) {

    //mdiv is set to form element being evaluated at the time
    mdiv = document.getElementById(theForm.elements[i].name + "Message");

    msg = validateField(theForm.elements[i]);
    if(msg != "") {
        mdiv.innerHTML = msg;
        break;
    }
}
if(msg == "") {
    theForm.submit.disabled=false;
    document.getElementById("submitButton").disabled = false;
}
});

$('#registerNewUserForm').submit(function() {
var theForm = document.registerNewUserForm;
clearAllErrors(theForm);
var msg = "";
var mdiv;
for (var i = 0; i < theForm.elements.length; i++) {

    //mdiv is set to form element being evaluated at the time
    mdiv = document.getElementById(theForm.elements[i].name + "Message");

    msg = validateField(theForm.elements[i]);
    if(msg != "") {
        break;
    }
}
if (msg != ""){
    mdiv.innerHTML = msg;
    return false;       
}  else {
    theForm.submit();
}   
});

function validateField(theField) {
msg = "";   
//all fields are required
if (theField.type == "text" || theField.type == "password") {
    if (theField.value == "") {
        msg = "The " + theField.name + " field is required.";
    }
}

//name fields are non-numeric
if (theField.name == "fullName"){
    if (hasNumber(theField.value) == true){
        msg= "The Name field is non-numeric.";
    }
}

//email must be correctly formatted
if (theField.name == "email") {
    msg = emailCheck (theField.value);
    if (msg == "") {
        //email address must also be unique
        chkEmail();
        msg = document.getElementById('emailMessage').innerHTML;
    }
}   
return msg;
}

function chkEmail() {
emailAddr = document.getElementById("email").value;
$.ajax({
    url: '/chkEmail',
    type: 'POST',
    data: 'emailAddr=' + encodeURIComponent(emailAddr),
    dataType: "xml",
    context: document.body,
    success: function(data) {
        document.getElementById('emailMessage').innerHTML = $(data).find("message").text();
    }
});
}

<form name="registerNewUserForm" id="registerNewUserForm" action="/register" method="post">
    <br/>
    <div>Create an Account and join the fun!</div>
    <div><input class="validate" type="text" id="fullName" required placeholder="Full Name" name="fullName" value="" size="30"></div>
    <div id="fullNameMessage" class="error"></div>
    <div><input class="validate" type="text" id="email" required placeholder="Email Address" name="email" value="" size="30"></div>
    <div id="emailMessage" class="error"></div>
    <div><input class="validate" type="password" id="passWord" required placeholder="Password" name="passWord" value="" size="30"></div>
    <div id="passWordMessage" class="error"></div>
    <div style="position:relative;left:173px;"><input id="submitButton" type="submit" value="Signup for PastelPlanet"></div>
    <input type="hidden" name="formName" value="registerNewUserForm">
    <input type="hidden" name="urlDestination" value="">
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:28:36.550

您的“chkEmail”函数涉及对服务器的调用，它是**异步**的。当函数返回时，当您以“全速”运行时，对服务器的调用将不会完成。

# sql-server-2008 - 如何在 SQL SERVER 2008 R2 中为存储过程创建快捷方式

> ID：11208322
> 
> 赞同：0
> 
> 时间：2012-06-26T13:26:01.203
> 
> 标签：sql-server-2008, sql-server-2008-r2

您好我正在使用 SQLSERVER 2008 R2 我有一个程序并想手动运行以检查信息。我想为该过程创建快捷方式，以便通过按下快捷键我可以运行 SP。如果是的话，这是否可能使用`SSMS`请告诉我。谢谢！在先进。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:29:55.880

去

```
extras -> options -> keyboard 
```

您可以在其中添加您的存储过程名称作为您选择的快捷方式。

# properties - 在 Gradle 构建脚本中访问 Teamcity 内部版本号

> ID：11208323
> 
> 赞同：6
> 
> 时间：2012-06-26T13:26:08.797
> 
> 标签：properties, build, teamcity, gradle

如何在 Teamcity 执行的 Gradle 脚本中访问内部版本号和 VCS 结帐号？

在 Ant 中，我可以分别使用`${build.number}`和`${build.vcs.number.1}`。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T13:40:43.943

这些只是 TeamCity 为 Ant/Gradle JVM 设置的 JVM 系统属性。您可以使用通常的 Java 方式访问它们，例如`System.getProperty("build.number")`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-22T07:23:13.470

我用 gradle 和注入`build.number`外部变量测试了许多案例。就我而言，我使用 docker 作为构建环境，因此无法成功注入 teamcity 提供的环境。

将变量注入 gradle 有两种可能性。请注意以下示例中`-D`的`-P`差异。

```
// 1\. gradle build -Pbuild.number=555
aaa = rootProject.properties.get("build.number") 

// 2\. gradle bulid -Dbuild.number=444
bbb = System.getProperty("build.number") 
```

`gradle --help``[option] task`作为命令命令说，但`task [option]`有效。

示例`build.gradle`脚本如下；

```
ext {
    buildNumber = (rootProject.properties.get("build.number") as Integer) ?: 1
}

android {

    defaultConfig {
        versionCode project.buildNumber
        versionName "1.3.7." + project.buildNumber.toString()
    } 
```

就我而言，我想`build.number`用作 android versionCode，因此需要使用`:?`null 处理解析为 Integer。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-04T09:49:35.253

如果您正在开发 Android 应用程序，您可以访问`build.number`以相应地更新 apk 文件名：

```
 defaultConfig {
    applicationId "com.mydemoci"
    minSdkVersion 14
    targetSdkVersion 23
    versionCode 1
    versionName "0.7"

    ext.buildNumber = System.getProperty("build.number") ?: "Regular"
    archivesBaseName = "$applicationId-v$versionName-b$buildNumber"
 } 
```

要在本地测试只需运行`gradlew clean build -Dbuild.number=123`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-22T00:49:04.057

从 TeamCity 9.1.5 开始，这已更改。“属性”（“系统”和“团队城市”）属性设置为项目扩展属性。

[https://confluence.jetbrains.com/display/TCD9/Defining+and+Using+Build+Parameters+in+Build+Configuration](https://confluence.jetbrains.com/display/TCD9/Defining+and+Using+Build+Parameters+in+Build+Configuration)

阅读概述页面时非常混乱[https://confluence.jetbrains.com/display/TCD9/Configuring+Build+Parameters#ConfiguringBuildParameters-ConfigurationParameters](https://confluence.jetbrains.com/display/TCD9/Configuring+Build+Parameters#ConfiguringBuildParameters-ConfigurationParameters) 使用“系统”（在“系统属性”中）让我认为它们被设置为JVM 系统属性，所以我尝试了这里描述的 Gradle 机制：[https](https://docs.gradle.org/current/userguide/build_environment.html) ://docs.gradle.org/current/userguide/build_environment.html 它说使用“​​org.gradle.project”。.. 用 TeamCity 添加它说使用“​​系统”。我试图将 gradle 属性“repositoryUrl”设置为“system.org.gradle.project.repositoryUrl”......这不起作用。添加“属性”

 *通过反复试验，我偶然发现了一个显而易见的问题……并准备将其报告为文档错误……但随后在文档中找到了它

总结：在 TeamCity 9.1.5+ 中使用

```
system.<propertyName> 
```

例如

```
system.repositoryUrl 
```

在 Gradle 中，这些可以作为 rootProject（或项目）“属性”（而不是“系统属性”...例如

```
println repositoryUrl 
println project.repositoryUrl
println rootProject.repositoryUrl
println project.properties["repositoryUrl"]
println rootProject.ext.repositoryUrl
println "${repositryUrl}"
assert  hasProperty("repositoryUrl") 
```

以及其他 500 种做同样事情的方法。*

# android - android google acc：将authorization_code交换为access_token

> ID：11208324
> 
> 赞同：0
> 
> 时间：2012-06-26T13:26:10.293
> 
> 标签：android, oauth

我试图用身份验证码交换访问令牌，但没有成功。我需要访问用户个人资料。这是我的代码：

首先获取授权码：

编辑：

```
private void googleAuthenticate(){
    try {
        mOAauthHelper = new OAuthHelper("something.net", "xxxxx", 
                "https://www.googleapis.com/auth/userinfo.profile", "alex://myScheme");
        String uri = mOAauthHelper.getRequestToken();

        startActivity(new Intent("android.intent.action.VIEW", Uri.parse(uri)));

       //Intent i = new Intent(this, GoogleOAUTHActivity.class);
       //i.putExtra(GoogleOAUTHActivity.GOOGLE_OAUTH_ENDPOINT_KEY, uri);            
       //startActivity(i);

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
        failedAuthenticatingAtGoogle();
    } catch (OAuthMessageSignerException e) {
        e.printStackTrace();
        failedAuthenticatingAtGoogle();
    } catch (OAuthNotAuthorizedException e) {
        e.printStackTrace();
        failedAuthenticatingAtGoogle();
    } catch (OAuthExpectationFailedException e) {
        e.printStackTrace();
        failedAuthenticatingAtGoogle();
    } catch (OAuthCommunicationException e) {
        e.printStackTrace();
        failedAuthenticatingAtGoogle();
    }
} 
```

和

```
public OAuthHelper(String consumerKey, String consumerSecret, String scope,
        String callbackUrl) throws UnsupportedEncodingException {
    mConsumer = new CommonsHttpOAuthConsumer(consumerKey, consumerSecret);
    mProvider = new CommonsHttpOAuthProvider(
            "https://www.google.com/accounts/OAuthGetRequestToken?scope="
                    + URLEncoder.encode(scope, "utf-8"),
            "https://www.google.com/accounts/OAuthGetAccessToken",
            "https://www.google.com/accounts/OAuthAuthorizeToken?hd=default");
    mProvider.setOAuth10a(true);
    mCallbackUrl = (callbackUrl == null ? OAuth.OUT_OF_BAND : callbackUrl);
} 
```

和

```
 @Override
protected void onNewIntent(Intent intent) {

    System.out.println("onNewIntent");

    try {
        Uri uri = intent.getData();
        String oauthToken = uri.getQueryParameter("oauth_token");
       // String oauthToken = uri.getQueryParameter("oauth_verifier");
        System.out.println(oauthToken);

        if(oauthToken != null){
            HttpClient client = new DefaultHttpClient();
            HttpPost post = new HttpPost("https://accounts.google.com/o/oauth2/token");
            List<NameValuePair> pairs = new ArrayList<NameValuePair>();
            pairs.add(new BasicNameValuePair("code", oauthToken));
            pairs.add(new BasicNameValuePair("client_id", "something.net"));
            pairs.add(new BasicNameValuePair("client_secret", "xxxxxx"));
            pairs.add(new BasicNameValuePair("redirect_uri", "alex://myScheme"));
            pairs.add(new BasicNameValuePair("grant_type", "authorization_code")); //Leave this line how it is   
            post.setEntity(new UrlEncodedFormEntity(pairs));
            org.apache.http.HttpResponse response = client.execute(post);
            String responseBody = EntityUtils.toString(response.getEntity());
            System.out.println(responseBody); // That just logs it into logCat

            //authorizeGoogleSessionToServer(oauthToken);
        }
    } catch (Exception e) {
        e.printStackTrace();
    }

} 
```

我得到：{“错误”：“无效请求”}

有谁知道如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T08:57:36.440

您正在对参数进行*双重编码。*`redirect_uri`

它应该看起来像::

```
pairs.add(new BasicNameValuePair("redirect_uri", "your_own_redirect_URI")); 
```

此外，您应该注意不要混合协议的两种实现（OAuth1 和 OAuth2）。它们看起来一样，但并不相等。

# f# - 与 F# 中的 LazyList 进行模式匹配时出错

> ID：11208325
> 
> 赞同：1
> 
> 时间：2012-06-26T13:26:10.327
> 
> 标签：f#, pattern-matching, lazy-evaluation

[在关于 SO 的这个](https://stackoverflow.com/q/11201850/297353)问题之后，试图在 F# 中合并两个 LazyLists 。最初是为了匹配两个列表而写的。修改后得到这个：

```
let rec printLazyList (l1:LazyList<int>) (l2:LazyList<int>) =
    match (l1, l2) with
        | t, s when t |> LazyList.isEmpty && s |> LazyList.isEmpty -> printfn "";
        | t , LazyList.Cons(h2,t2) when t |> LazyList.isEmpty -> printf "%d " h2 
                                                                 let a = LazyList.empty 
                                                                 printLazyList a t2
        | LazyList.Cons(h1,t1), s when s |> LazyList.isEmpty -> printf "%d " h1 
                                                                let b = LazyList.empty 
                                                                printLazyList t1 b
        | LazyList.Cons(h1,t1), LazyList.Cons(h2,t2) -> if h1 = h2 then 
                                                            printf "%d " h1 
                                                            printLazyList t1 t2 
                                                        elif h1 < h2 then 
                                                            printf "%d " h1  
                                                            printLazyList t1 l2
                                                        else 
                                                            printf "%d " h2  
                                                            printLazyList l1 t2 
```

问题是它没有输出。不满足任何条件（通过`|_,_ printfn "nothing matches"`在模式匹配的末尾放置 a 来检查这一点。`cons`在 LazyList 中使用的 与`::`在通常的 F# 列表中使用的 有根本区别吗？因为这适用于普通列表（cf.上面的链接）。

对不起，如果这又是一个非常n00b的问题。FP 在这一点上看起来相当困难。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T13:52:15.717

如果您使用 测试该功能`fsi`，请小心，因为控制台中有很多噪音，`fsi`您的眼睛可能会跳过输出行。

这是一个完整的测试（我通过使用`Nil`而不是`isEmpty`和重新组织模式匹配进行了一些清理以提高可读性）：

```
#r "FSharp.PowerPack.dll"

open LazyList

let rec printLazyList l1 l2 =
    match l1, l2 with
    | Nil, Nil -> printfn ""
    | Nil, Cons(h2, t2) -> 
        printf "%d " h2 
        printLazyList LazyList.empty t2
    | Cons(h1, t1), Nil -> 
        printf "%d " h1 
        printLazyList t1 LazyList.empty
    | Cons(h1, t1), Cons(h2, t2) when h1 = h2 ->
        printf "%d " h1 
        printLazyList t1 t2 
    | Cons(h1, t1), Cons(h2, t2) when h1 < h2 ->
        printf "%d " h1  
        printLazyList t1 l2
    | Cons(h1, t1), Cons(h2, t2) ->
        printf "%d " h2  
        printLazyList l1 t2

let x = LazyList.ofList [1; 2];;
let y = LazyList.ofList [3; 4];;
printLazyList x y;; 
```

# java - 石英工作没有开始

> ID：11208327
> 
> 赞同：8
> 
> 时间：2012-06-26T13:26:10.923
> 
> 标签：java, quartz-scheduler

**编辑**：我正在使用`quartz-2.1.5.jar`. 以下是我的课程总结：

> `HttpPollingJob`扩展`PollingJob`扩展`ScheduledJob`工具`org.quartz.Job`

具体来说：

1)`ScheduledJob`实现 Quartz `Job`(我所有类型的抽象基类`Job`):

```
import org.quartz.Job;
import org.quartz.Trigger;

public abstract class ScheduledJob implements Job {
    private Trigger trigger;

    public ScheduledJob() {
        this(null);
    }

    public ScheduledJob(Trigger trig) {
        super();

        if(trig == null)
            trig = getDefaultTrigger();

        setTrigger(trig);
    }

    public Trigger getTrigger() {
        return trigger;
    }

    public void setTrigger(final Trigger trig) {
        trigger = trig;
    }

    protected abstract Trigger getDefaultTrigger();
} 
```

2)`PollingJob`扩展`ScheduledJob`- 所有“轮询器”以特定频率轮询某些资源/端点：

```
import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;
import org.quartz.SimpleScheduleBuilder;
import org.quartz.Trigger;
import org.quartz.TriggerBuilder;

import com.me.jobs.ScheduledJob;

public abstract class PollingJob extends ScheduledJob {
    private static long DEF_FREQUENCY = 10 * 1000; // 10 secs
    private String name;    
    private long frequency;

    public PollingJob(final String nm) {
        this(nm, DEF_FREQUENCY);
    }

    public PollingJob(final String nm, final long freq) {
        super();

        setName(nm);
        setFrequency(freq);
    }

    public abstract void poll(JobExecutionContext context);

    @Override
    public void execute(JobExecutionContext context) throws JobExecutionException {
        poll(context);      
    }

    public String getName() {
        return name;
    }

    public void setName(final String nm) {
        name = nm;
    }

    public long getFrequency() {
        return frequency;
    }

    public void setFrequency(final long freq) {
        frequency = freq;
    }

    protected final Trigger getDefaultTrigger()  {
        TriggerBuilder<?> triggerBuilder = TriggerBuilder.newTrigger()
            .startNow()
            .withSchedule(SimpleScheduleBuilder.simpleSchedule()
            .withIntervalInMilliseconds(DEF_FREQUENCY));

        return triggerBuilder.build();
    }
} 
```

3)`HttpPollingJob`扩展`PollingJob`- “HTTP pollers”轮询 Web 服务器（使用 HTtpClient）：

```
import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.quartz.JobExecutionContext;

import com.me.MonitoredEvent;
import com.me.MonitoredEventRegistrar;

public class HttpPollingJob extends PollingJob {
    private String serverURL;
    private org.slf4j.Logger logger =
        org.slf4j.LoggerFactory.getLogger(HttpPollingJob.class);

    public HttpPollingJob(final String nm, final String server) {
        super(nm);

        setServerURL(server);
    }

    public String getServerURL() {
        return serverURL;
    }

    public void setServerURL(final String server) {
        serverURL = server;
    }

    @Override
    public final void poll(JobExecutionContext context) {
        MonitoredEvent event = null;

        try {
            // This is where we would use HttpClient to connect to a web server and poll it.
            System.out.println("Job fired!");
        }
        catch(Throwable thrown) {
            logger.error(thrown.getMessage());
        }
    }
} 
```

4) `JobDriver`- 定义了几个`HttpPollingJob`s 并使用 Quartz 启动它们：

```
public class JobDriver {
    private List<HttpPollingJob> jobs;

    public JobDriver() {
        HttpPollingJob job1 = new HttpPollingJob("job-1", "http://www.example.com/1");
        HttpPollingJob job2 = new HttpPollingJob("job-2", "http://www.example.com/2");
        HttpPollingJob job3 = new HttpPollingJob("job-3", "http://www.example.com/3");

        jobs = new ArrayList<HttpPollingJob>();
        jobs.add(job1);
        jobs.add(job2);
        jobs.add(job3);
    }

    public static void main(String[] args) {
    JobDriver driver = new JobDriver();
        driver.startJobs();
    }

    private void startJobs() {
        try {
            // Obtain a basic SchedulerFactory and fire it up.
            SchedulerFactory schedulerFactory = new org.quartz.impl.StdSchedulerFactory();
            Scheduler scheduler = schedulerFactory.getScheduler();
            scheduler.start();

            // Define a job for every declared monitor.
            JobBuilder jobBuilder = null;

            for(ScheduledJob job : jobs) {

            Trigger trigger = job.getTrigger();
            jobBuilder = JobBuilder.newJob(job.getClass());

            // Bind the current job to this trigger.
            scheduler.scheduleJob(jobBuilder.build(), trigger);

            // TODO: Shut the scheduler down politely?!?!
        }
        catch(Throwable exc) {
            logger.error(exc.getMessage());

            // Force application to kick out.
            throw new RuntimeException(exc);
        }
    }
} 
```

当我运行这段代码时，我得到了一个完美的启动，没有错误或运行时异常。如果我撒上`System.out.println`语句，我可以看到每一行代码都完美地执行。唯一的问题是，一旦程序运行，它不会打印“*作业已触发！* ”消息，表明轮询作业正在启动。

我已经尝试了每一种组合，`start()`但`shutdown()`我想都无济于事。任何 Quartz 专家都可以查看这段代码并告诉我为什么这项工作没有触发吗？

在日志中（我配置了 log4j），我看到正在为计划作业创建 Quartz 工作线程。我觉得我已经完成了 99% 的工作，但只是缺少了一些明显的东西。提前致谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-12T09:50:20.353

@4herpsand7derpsago 是的，你是对的，你是 99%，我运行了你的代码，其中只有一个问题，默认构造函数在`HttpPollingJob`和`PollingJob`类中不存在，因此调度程序无法创建它们的实例，

**简单的解决方案在下面的类HttpPollingJob**类中添加以下代码

```
public HttpPollingJob() {
} 
```

**PollingJob**类

```
public PollingJob() {
} 
```

Bingo，将打印以下消息

`Job fired!`
`Job fired!`
`Job fired!`

如果要重复触发，请在**PollingJob中添加以下代码**

```
protected final Trigger getDefaultTrigger() {
    TriggerBuilder<?> triggerBuilder = TriggerBuilder
            .newTrigger()
            .startNow()
            .withSchedule(
                    SimpleScheduleBuilder.simpleSchedule()
                            .withIntervalInMilliseconds(DEF_FREQUENCY).repeatForever());

    return triggerBuilder.build();
} 
```

希望现在我会收到赏金:)

**BONUS**
似乎您想使用 url 进行投票或做某事，使用 king 传递它的更好方法`JobDataMap`

更新**了 JobDriver**

```
import java.util.ArrayList;
import java.util.List;

import org.quartz.JobBuilder;
import org.quartz.Scheduler;
import org.quartz.SchedulerFactory;
import org.quartz.Trigger;

public class JobDriver {
private List<HttpPollingJob> jobs;

public JobDriver() {
    HttpPollingJob job1 = new HttpPollingJob("job-1",
            "http://www.example.com/1");
    HttpPollingJob job2 = new HttpPollingJob("job-2",
            "http://www.example.com/2");
    HttpPollingJob job3 = new HttpPollingJob("job-3",
            "http://www.example.com/3");

    jobs = new ArrayList<HttpPollingJob>();
    jobs.add(job1);
    jobs.add(job2);
    jobs.add(job3);
}

public static void main(String[] args) {
    JobDriver driver = new JobDriver();
    driver.startJobs();
}

private void startJobs() {
    try {
        // Obtain a basic SchedulerFactory and fire it up.
        SchedulerFactory schedulerFactory = new org.quartz.impl.StdSchedulerFactory();
        Scheduler scheduler = schedulerFactory.getScheduler();
        scheduler.start();
        // Define a job for every declared monitor.
        JobBuilder jobBuilder = null;

        for (HttpPollingJob job : jobs) {

            Trigger trigger = job.getTrigger();
            jobBuilder = JobBuilder.newJob(job.getClass());
            jobBuilder.usingJobData("name", job.getName());
            jobBuilder.usingJobData("url", job.getServerURL());

            // Bind the current job to this trigger.
            scheduler.scheduleJob(jobBuilder.build(), trigger);

            // TODO: Shut the scheduler down politely?!?!
        }

    } catch (Throwable exc) {
        // Force application to kick out.
        throw new RuntimeException(exc);
    }
}
} 
```

更新**了 HttpPollingJob**

```
import java.util.Map;

import org.quartz.JobExecutionContext;

public class HttpPollingJob extends PollingJob {
private String serverURL;
private org.slf4j.Logger logger =
    org.slf4j.LoggerFactory.getLogger(HttpPollingJob.class);

public HttpPollingJob(final String nm, final String server) {
    super(nm);

    setServerURL(server);
}
public HttpPollingJob() {
}

public String getServerURL() {
    return serverURL;
}

public void setServerURL(final String server) {
    serverURL = server;
}

@Override
public final void poll(JobExecutionContext context) {

    try {
        Map dataMap = context.getJobDetail().getJobDataMap();
        String nm = (String)dataMap.get("name");
        String url = (String)dataMap.get("url");
        // This is where we would use HttpClient to connect to a web server and poll it.
        System.out.println("Job fired! name:"+nm+" url:"+url);
    }
    catch(Throwable thrown) {
        logger.error(thrown.getMessage());
    }
}
} 
```

**新输出**

`Job fired! name:job-1 url:http://www.example.com/1`
`Job fired! name:job-2 url:http://www.example.com/2`
`Job fired! name:job-3 url:http://www.example.com/3`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T13:47:49.397

显然，您还没有启动触发器。请参阅[Quartz 教程](http://quartz-scheduler.org/documentation/quartz-2.x/tutorials/tutorial-lesson-02)或[Javadocs](http://quartz-scheduler.org/api/2.0.0/org/quartz/TriggerBuilder.html)：

```
// Trigger the job to run now, and then every 40 seconds
  Trigger trigger = newTrigger()
      .withIdentity("myTrigger", "group1")
      .startNow()
      .withSchedule(simpleSchedule()
          .withIntervalInSeconds(40)
          .repeatForever())            
      .build(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T23:37:53.703

它是您的构造函数-`JobBuilder`寻找无参数，并且由于未定义它们，因此它拒绝构建作业。添加空的无参数 ctor，一切就绪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T21:11:10.010

您能否尝试将`getDefaultTrigger`类中方法的代码更改`PollingJob`为以下内容：

```
 protected final Trigger getDefaultTrigger()  {

return TriggerBuilder.newTrigger()
         .withSchedule(SimpleScheduleBuilder.simpleSchedule()
        .withIntervalInMilliseconds(DEF_FREQUENCY))
        .startAt(DateBuilder.futureDate(1,  DateBuilder.IntervalUnit.SECOND))
        .build();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T04:48:05.157

我觉得你创建触发器的方式有些问题。请记住，您不能将触发器重复用于多个作业

尝试创建具有唯一身份和组的触发器，如下所示

触发 everyHourTrigger = newTrigger().withIdentity("everyWeeklyTrigger", "group1") .startNow().withSchedule(cronSchedule("0 1 * * * ?")).build();

# java - ListFragment 支持库 GetSupportFragmentManager 未定义

> ID：11208335
> 
> 赞同：10
> 
> 时间：2012-06-26T13:26:49.813
> 
> 标签：java, android, android-fragments

我有一个列表片段（导入 v4 支持库，构建目标是 2.3.3 api 11）和我的代码中的以下问题，当目标是 3.0 并且我没有使用该库时工作正常。

```
Fragment frag1 = new ExampleFragment();
FragmentTransaction ft = getFragmentManager().beginTransaction();
ft.replace(R.id.contentframe, frag1);
ft.commit(); 
```

现在我得到了编译错误

```
"Type mismatch: cannot convert from ExampleFragment to Fragment" 
```

它告诉我将“片段”更改为 ExampleFragment （例如）

```
ExamplesFragment frag1 = new ExamplesFragment();
FragmentTransaction ft = getFragmentManager().beginTransaction();
ft.replace(R.id.contentframe, frag1);
ft.commit(); 
```

然后我有一个问题，ft.replace命令有错误：

```
The method replace(int, Fragment) in the type FragmentTransaction is not applicable for the arguments (int, Fragment_PVAnn) 
```

它告诉我将第一行中的 ExamplesFragment 改回 Fragment ，所以圆圈转了一圈

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-26T13:32:16.063

你应该使用

```
getActivity().getSupportFragmentManager() 
```

如果这仍然给您带来问题，那么请确保您的`Activity extends FragmentActivity`.

如果这仍然给您带来问题，

1.  删除*所有*导入，
2.  `Ctrl`使用++重新导入`Shift`，`O`并且
3.  在每次名称冲突时，请确保您从 导入`support.v4.*`，*而不是* `android.*`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:32:47.143

您必须确保当您扩展时`Fragment`，您正在扩展包空间`Fragment`中的那个。`v4`检查您的导入是否有`Fragment`、`FragmentActivity`等，如果您在包名称中看到它们导入时没有 .v4，那么这是错误的。

此外，如果您将项目的 android 库设置为 2.3 而不是 4.0.x，那么您将很快看到您是否使用了不正确的类，因为您会得到编译错误，这可以通过使用 v4 类来修复来自 android support jar（希望你也包含在你的项目中）

# java - 问题运行 MatlabControl

> ID：11208340
> 
> 赞同：1
> 
> 时间：2012-06-26T13:26:57.550
> 
> 标签：java, matlab

我已经成功编译了此链接上的“Hello World”示例：[http](http://code.google.com/p/matlabcontrol/wiki/Walkthrough) ://code.google.com/p/matlabcontrol/wiki/Walkthrough 。

但是，当我尝试运行它时，出现以下异常： **线程“主”matlabcontrol.MatlabConnectionException 中的异常：无法启动 MATLAB。命令：[matlab, -desktop, -r, javaaddpath '/usr/local/MATLAB/R2011a/java/jar/matlabcontrol-4.0.0.jar'; matlabcontrol.MatlabClassLoaderHelper.configureClassLoading(); javarmpath '/usr/local/MATLAB/R2011a/java/jar/matlabcontrol-4.0.0.jar'; matlabcontrol.MatlabConnector.connectFromMatlab('PROXY_RECEIVER_6eb278d0-1401-4b9c-b9e4-80512708f9b7', 2100);]。**

我在 Ubuntu 11.10 中安装了 Matlab2011a。

谁能指出问题可能出在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-01T18:53:29.143

您发布的那个异常表明您需要将 Matlab 添加到系统路径中。查看有关如何在 Ubuntu 上执行此操作的在线指南。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-24T02:15:09.557

1.  如果您检查操作系统和 MATLAB 版本之间的兼容性？

    [https://code.google.com/p/matlabcontrol/wiki/Compatibility](https://code.google.com/p/matlabcontrol/wiki/Compatibility)

2.  我建议您应该将 matlabcontrol-4.0.0.jar 更新为最新版本的 matlabcontrol-4.1.0.jar，该版本可以从网站下载。

3.  请记住在运行代码之前打开 MATLAB 并检查您是否已将所有相关的 jar 文件（jmi.jar...等）包含到 java 构建路径中。

# php - Yii中某个控制器的异常

> ID：11208341
> 
> 赞同：0
> 
> 时间：2012-06-26T13:26:59.843
> 
> 标签：php, yii

我的 yii 应用程序中有很多控制器。所有这些只有在您登录后才能访问，否则您将被重定向到登录页面。但是我有一个控制器，其中包含一些应该可供所有人使用的操作。我如何配置 Yii 来实现这一点？

我在控制器的 accessRules() 函数中尝试了很多，但没有任何效果。

```
 public function accessRules() {
    return array(
        array('allow', 'users' => array('*'))
    );
  } 
```

我希望不会被重定向到登录页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:41:29.290

目前尚不清楚您要使用该代码做什么。如果您打算让每个人都可以访问*所有*`accessControl`操作，请完全删除过滤器和`accessRules()`实现。

**更新：**

好吧，如果您的基础`Controller`将访问控制规则附加到所有应用程序控制器，您只需覆盖适当的方法即可恢复[默认](http://code.google.com/p/yii/source/browse/tags/1.1.10/framework/web/CController.php#154) [行为](http://code.google.com/p/yii/source/browse/tags/1.1.10/framework/web/CController.php#239)：

```
public function filters()
{
    return array();
}

public function accessRules()
{
    return array();
} 
```

但是，如果`Controller`附加的过滤器不仅仅是`accessControl`您将不得不以某种方式找到哪一个是该`accessControl`行并仅删除该行。这不是微不足道的，因为那里有相当多的语法。

最后，`Controller`不应该那样做。如果您想在许多（但不是全部）一线控制器之间共享行为，那么您应该创建另一个类，例如并*选择性地*`ControllerWithAccessControl`从它派生。

# erlang - 无法将 ChicagoBoss 控制器链接到视图

> ID：11208350
> 
> 赞同：0
> 
> 时间：2012-06-26T13:27:36.300
> 
> 标签：erlang, chicagoboss

我正在用 Erlang 做一个网站，但我遇到了麻烦。我安装了 Chicagoboss 并且服务器启动了，但是我遇到了问题。他们说`localhost:8001/pages/index`当我转到此页面时要转到此页面我收到一个错误：

> 没有与请求的 URL 匹配的路由。（别担心，这条消息不会出现在生产中。）

我没有做任何事情，我将文件编码为`src/controllers/main.erl`. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T18:48:36.877

我从未使用过 ChicagoBoss，但这个问题非常基础，您应该在提问之前仔细阅读教程。看看请求的 URL 是如何分派的：

```
host:port/yourcontroller/youraction 
```

将调用函数

> youraction('GET', []) -> {输出，“Hello World！”}。

来自文件 src/controller/PROJECT_yourcontroller_controller.erl。此示例开箱即用。在一般情况下，查看 PROJECT/priv/PROJECT.routes 以定义将 URL 模式绑定到其控制器操作的规则。

# ios5 - iOS5将图像保存到自定义文件夹，ALAssetsLibrary 失败

> ID：11208351
> 
> 赞同：6
> 
> 时间：2012-06-26T13:27:36.520
> 
> 标签：ios5, save, alassetslibrary

**<><> ---- Aalok 已经回答了这个问题，我只是在等他写出来，所以我可以选择它作为正确答案。在那之前，除了进行他在下面描述的更改之外，我还必须调用 --self.library = [[ALAssetsLibrary alloc] init]; - 在每次尝试保存我的图像之前。作为预防措施，我还停止了 AVSession 的运行，直到保存后重新启动（使用 [session stopRunning]; 和 [session startRunning]; ----- <><>**

**<><> ----- 编辑 2：您不需要停止并重新启动 AV 会话，对此进行了彻底的测试，并且运行良好。----- <><>**

**<><> ----- 编辑 3：在我的设备上彻底测试后，它运行良好，一旦通过审查过程并放入商店，代码就无法正常工作。运行相同操作系统的两台相同设备（2x iPhone 4），一台使用我的开发版本，一台关闭应用程序，应用商店版本仍然存在错误。暂时放弃这个 ----- <><>**

我正在使用此链接中的类别尝试保存到自定义文件夹：

[http://www.touch-code-magazine.com/ios5-saving-photos-in-custom-photo-album-category-for-download/](http://www.touch-code-magazine.com/ios5-saving-photos-in-custom-photo-album-category-for-download/)

现在它在某些时候有效，但不是全部。在评论中建议以下代码将检测组属性是否为零：

```
 if ([group valueForProperty:ALAssetsGroupPropertyURL] == nil)
{
NSLog(@”group properties are nil!”);
} else {
[group addAsset:asset];
} 
```

我有，它确实检测属性是否为零。所以一切都很好。我当时正在努力设置属性并保存图像。我猜这个时候我们可以手动设置albumName并保存图片，我试过了，但是还是会报错。

有任何想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T09:52:21.957

我在使用相同的 .h 和 .m 文件时遇到了同样的问题，但是在处理了 2 到 3 天后找到了一个解决方案，而且解决方案非常简单，我必须在 .m 文件中进行更改

`-(void)saveImage:(UIImage*)image toAlbum:(NSString*)albumName withCompletionBlock:(SaveImageCompletion)completionBlock`

并且在

`-(void)addAssetURL:(NSURL*)assetURL toAlbum:(NSString*)albumName withCompletionBlock:(SaveImageCompletion)completionBlock`

方法我只是在调用内部方法之前添加这个

```
//THE CHANGE dispatch_async(dispatch_get_main_queue(),^{ //
[self writeImageToSavedPhotosAlbum:image.CGImage orientation:(ALAssetOrientation)image.imageOrientation completionBlock:^(NSURL* assetURL, NSError* error) 
    {
        //error handling
        if (error!=nil) 
        {
            completionBlock(error);
            return;
        }
        //add the asset to the custom photo album
        [self addAssetURL: assetURL toAlbum:albumName withCompletionBlock:completionBlock];
    }];
//THE CHANGE }); // 
```

AND 另一个相同

快乐编码:)

**编辑**

在第二种方法中，我在每行下方添加`completionBlock(nil);`一行

```
[[NSNotificationCenter defaultCenter] postNotificationName:kSaveSuccess object:nil]; 
```

我使用这个通知来确保图像也保存在相册中。直到那时我显示`UIActivityIndicator`一些文本消息并在成功保存图像后显示一条弹出消息，指示图像以专辑名称保存在专辑中。虽然这一次用户界面没有响应，即用户除了按下设备的主页按钮之外不能做任何事情:) ;)

快乐编码:)

# string - 测试 JSTL 字符串值？

> ID：11208352
> 
> 赞同：0
> 
> 时间：2012-06-26T13:27:37.083
> 
> 标签：string, jsf, testing, jstl

我正在使用 JSF 和 JSTL，上面的代码不起作用！

```
<ui:repeat var="reponse" value="#{gPost.reponses}">                                             UserLogin : #{reponse.utilisateur.login}
    <c:if test="${reponse.utilisateur.login eq 'X'}">
        Utilisateur equivalent X
    </c:if>
</ui:repeat> 
```

这段代码迭代，我有两个元素要迭代，输出是这样的：

```
UserLogin : Y
UserLogin : X 
```

肯定是 ：

```
UserLogin : Y
UserLogin : X
Utilisateur equivalent X 
```

标签`<c:if test="${reponse.utilisateur.login eq 'X'}">`不正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:32:38.423

JSTL 标记喜欢`<c:if>`在视图构建期间运行，而 JSF 组件喜欢`<ui:repeat>`在视图渲染期间运行。因此，到目前为止，您给出的代码在 JSTL 运行时不可用，因为`#{reponse}`尚未**运行**`<ui:repeat>`。您需要一个带有`rendered`属性的普通 JSF 组件。

```
<h:panelGroup rendered="#{reponse.utilisateur.login eq 'X'}">
    Utilisateur equivalent X
</h:panelGroup> 
```

### 也可以看看：

*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

# c# - 通过 c# 使用 Exchange 收件人更新服务，无需 PowerShell

> ID：11208354
> 
> 赞同：1
> 
> 时间：2012-06-26T13:27:40.933
> 
> 标签：c#, dynamic, outlook, add-in, exchange-server

我正在寻找通过交换服务器获取动态通讯组的当前成员。动态通讯组基于指定的筛选器。“收件人更新服务”(RUS) 基于此过滤器按运行时查找每个联系人。我发现很多信息可以通过在经典命令行参数的交互中使用交换 powershell 的包装类来解决问题。但这不是我想要的方式。我认为应该有一个“Exchange Web Services”（EWS）的特殊命令来通过运行时或互操作获取动态成员。我无法找到有关此的一些信息。

有没有人有想法或一些信息来通过 c# 解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:29:10.110

DirectoryServices 似乎对我有用。创建一个指向动态通讯组列表的 DirectoryEntry（*架构类名称 = "msExchDynamicDistributionList"*），然后使用 "msExchDynamicDLBaseDN" 和 "msExchDynamicDLFilter" 属性搜索成员：

```
using (var group = new DirectoryEntry("LDAP://CN=MyGroup,OU=MyOU,DC=company,DC=com"))
{
   string baseDN = (string)group.Properties["msExchDynamicDLBaseDN"].Value;
   string filter = (string)group.Properties["msExchDynamicDLFilter"].Value;

   using (var searchRoot = new DirectoryEntry("LDAP://" + baseDN))
   using (var searcher = new DirectorySearcher(searchRoot, filter, propertiesToLoad))
   using (var results = searcher.FindAll())
   {
      foreach (SearchResult result in results)
      {
         // Use the result
      }
   }
} 
```

请记住，组的成员可以是常规组或其他动态通讯组以及用户、联系人和公用文件夹。

# python - 更新 SQLAlchemy 关系

> ID：11208355
> 
> 赞同：2
> 
> 时间：2012-06-26T13:27:40.857
> 
> 标签：python, sqlalchemy

我与同一张表有两个关系。当我向一个关系添加元素时，在我提交会话之前，这不会反映到另一个关系。有没有办法强制“更新”关系？

**具体例子：**

```
class Event(ManagerBase):
    """Defines an event."""

    __tablename__ = 'eventing_events'

    id = Column(Integer, primary_key=True)
    device_id = Column(Integer, ForeignKey(EventingDevice.id), nullable=False)
    device = relation(EventingDevice)
    type_id = Column(Integer, ForeignKey(EventType.id), nullable=False)
    type = relation(EventType)
    datetime = Column(DateTime, nullable=False)
    summary = Column(String(500))

    fields = relation("EventFieldValue",
                      viewonly=True,
                      collection_class=attribute_mapped_collection("field.name"))

class EventFieldValue(ManagerBase):
    """The value of a single field of an event."""

    __tablename__ = 'eventing_event_field_values'

    event_id = Column(Integer, ForeignKey(Event.id), primary_key=True)
    event = relation(Event, backref=backref("field_values",
                                            collection_class=attribute_mapped_collection("field")))
    field_id = Column(Integer, ForeignKey(Field.id), primary_key=True)
    field = relation(Field)
    value = Column(Text) 
```

我有两个从`Event`to `EventFieldValue`:`fields`和`field_values`（通过事件的 backref）的实现。当我将 EventFieldValue 添加到 时，它在我提交会话之前`event.field_values`不会反映。`event.fields`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:38:59.280

因为您有两个关系，sqlalchemy 必须为每个关系发出请求，并且不会在会话中共享它们的缓存。

你应该看看[Association proxies](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/associationproxy.html)，这似乎正是你所需要的。它们允许您只定义一个关系并将代理放在它们的顶部，以便更轻松地访问关系中的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:38:18.683

[刷新](http://docs.sqlalchemy.org/en/rel_0_7/orm/session.html#flushing)会话应该可以解决这个问题。它使用所有新状态更新您的会话，但不执行提交。您还可以查看[刷新/过期](http://docs.sqlalchemy.org/en/rel_0_7/orm/session.html#refreshing-expiring)，这将重新加载您的对象。

# c# - 在 C# 中通过正则表达式读取文本文件

> ID：11208356
> 
> 赞同：1
> 
> 时间：2012-06-26T13:27:41.927
> 
> 标签：c#, regex

嗨，我正在我的应用程序中使用 C# 读取日志文件（文本文件），并且正在使用 dates 读取日志文件。我还创建了一个正则表达式格式，用于按日期获取异常。

现在我通过成功使用此正则表达式格式获得了异常，但我无法正确获取异常行。当我要使用下面的正则表达式格式时，我缺少异常行的最后一个字母。告诉我我在这行做错了什么。谁能告诉我获得例外情况的完整行的解决方案。

提前致谢。

我的代码是：

```
 var matches = Regex.Matches(sb.ToString(), @"(?<date>\d{4}\-\d{2}\-\d{2})\s(?<message>(.(?!\d{4}\-\d{2}\-\d{2}))+)"); 
```

我的 txt 文件看起来像

```
2012-06-21 04:35:30,177|| [5]|| DEBUG|| GID.AAFramework.Shared.LdapAuthentication.PrincipleImpl||  PrincipleImpl: IsInRole(string role)-  Entered
2012-06-21 04:35:30,177|| [5]|| DEBUG|| GID.AAFramework.Shared.LdapAuthentication.PrincipleImpl||  PrincipleImpl: IsInRole(string role)-  IsInRole(ADMINUSER) 
results : True 
```

在我的日志文件中，所有行都以日期开头，但在某些行中消息太长，所以它来到下一行..所以我想读取以日期开头的文件意味着我错过了以该消息开头的行...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:38:41.283

尝试使用：

```
 @"(?<date>\d{4}\-\d{2}\-\d{2})\s+(?<message>(.(?!\d{4}\-\d{2}\-\d{2}))+.)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:26:22.080

要回答您的第一个问题，获取最后一个丢失的字母，只需更改点在您的模式中的位置：

```
var matches = Regex.Matches(sb.ToString(), @"(?<date>\d{4}\-\d{2}\-\d{2})\s(?<message>((?!\d{4}\-\d{2}\-\d{2}).)+)"); 
```

如果它不是前瞻模式的开始，则现在匹配下一个字母。如果前瞻模式不在该字符之后，则您的模式与下一个字符匹配。

我不确定你在最后一部分添加的关于下一行的问题是什么......

# c# - PHP 到 C#，反之亦然

> ID：11208359
> 
> 赞同：8
> 
> 时间：2012-06-26T13:27:44.540
> 
> 标签：c#, php

我在这个项目中：

前端公司人员将使用该网页从 SQL DB 查询和更新数据。我正在使用 Visual Studio，后面的代码（C#）几乎完成了，所以 SQL 和 C# 之间的交互还可以。我最初的想法是使用我熟悉的 ASP.NET，但这是不可能的。我必须切换到 PHP。所以，今天是我学习 PHP 的第一天，查看[http://php.net/manual/en/index.php](http://php.net/manual/en/index.php)并且很多东西看起来和 ASP.NET 很相似，所以我想它不会那么难。

无论如何，一些问题很快就出现了，因为我想编写除“hello world”之外的其他内容。

有没有一种简单的方法可以使用 php 页面从我的类中获取/发送 C# 变量？为了做到这一点，我已经阅读了一些关于使用 XML 的内容，但我仍然在摸不着头脑，还有另一种更简单的方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-26T15:12:28.567

你有选择。

1.  直接整合。PHP 可以实例化和使用 .NET 对象。请参阅 PHP 中的 DOTNET 库。因此，如果您在 Windows 上运行 PHP，并且根据 PHP DOTNET 基础架构的要求公开您的 .NET 逻辑，那么您可以直接从 PHP 调用 .NET 类。一些限制： PHP 是为与 .NET 2.0 运行时集成而构建的。您无法构建 .NET 4.0 对象并从 PHP 连接到它们。

2.  同步网络协议。正如其他人建议的那样，您可以通过 aREST 或 Web 服务接口公开您的 C# 逻辑，然后使用 curl 库或`file_get_contents()`. C# 逻辑可以但不必公开公开。换句话说，您可以使其只能从应用程序的防火墙内访问，这样就不可能进行匿名公共访问。另一方面，您的架构可能要求从 3rd 方或用户应用程序访问相同的 API。在这种情况下，它需要公开。

    无论是公共的还是私有的，您都需要使用 WCF 或 ASPNET MVC 来公开这些用 C# 实现的服务。

3.  异步机制。PHP 可以连接到 MSMQ。请参阅[使用 PHP 打开 MSMQ 队列](https://stackoverflow.com/questions/10400676/using-php-to-open-msmq-queues)。当然 C# 也可以这样做。您可以使用 MSMQ 作为两个世界之间的缓冲通信机制。为此，您需要为放入和获取队列的消息提供数据序列化协议。JSON 或 XML 在这里是合适的选择。

4.  数据库。如果您担心使用 MSMQ，因为它是“要管理的另一个基础架构”，您也可以使用数据库作为中间人。PHP 和 C# 都可以访问共享数据库，并将其用作消息队列或通信管道。PHP 在 MySQL 表中插入消息，C# 应用程序可以读取和处理它们，然后将回复消息放在不同的表中。这需要您进行一些工作来设计消息格式、协议、索引和请求/回复相关机制。但它依赖于您已经知道如何使用的经过验证的现有技术。

5.  最后是法朗格。这使您可以将 PHP 编译到 .NET Framework 上。这意味着 C# 和 PHP 之间的集成将很简单。我还没有尝试过，但它可能会满足您的要求。

# android - 如何在android中使用补丁文件

> ID：11208366
> 
> 赞同：0
> 
> 时间：2012-06-26T13:28:08.037
> 
> 标签：android, call, recorder

我有 HTC 感觉（4.0.3）并尝试进行 2 路通话录音。所以我决定使用“sensation_stock_2_6_35.patch”来安装 rvoix 通话记录器。但我找不到这样做的方法。

请帮我。谢谢！（http://code.google.com/p/2-way-call-recording/source/browse/patches/sensation_stock_2_6_35.patch）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T08:52:30.537

可能回答晚了，但是这个链接可以参考

[http://drupal.org/node/707484](http://drupal.org/node/707484)

```
git apply -v [patch-name.patch] 
```

# c# - C#递归文件夹/文件扫描大小，路径，创建，文件版本到txt

> ID：11208369
> 
> 赞同：0
> 
> 时间：2012-06-26T13:28:10.770
> 
> 标签：c#, recursion

我正在寻找一个扫描特定文件夹并将结果发送到文本文件中的递归函数。

我想在一个文本文件中列出所有文件和文件夹的大小、路径、创建日期、文件版本（如果存在），但我不知道如何继续。

我找到了一些递归扫描的方法，但不能恢复所有需要的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:29:08.687

使用 System.IO.FileInfo 对象和 System.IO.DirectoryInfo 对象....除此之外，向我们展示您的尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:33:19.123

您可以执行以下操作，

```
 GetFileInfo(string dir)
{
 try
       {
           FileInfo info = null;
           foreach (string d in Directory.GetDirectories(sDir))
           {
               foreach (string file in Directory.GetFiles(d))
               {
                info =  new FileInfo(file);
                //get all information using info here
               }
               GetFileInfo(d);
           }
       }
       catch (System.Exception excpt)
       {
           Console.WriteLine(excpt.Message);
       }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:34:43.220

您可以使用 System.IO.DirectoryInfo 和 System.IO.FileInfo 列出一个文件夹，如 ganders 所说。如果您可以列出一个文件夹的内容，剩下的就是简单的递归。如果根目录中的一项是目录在此目录上调用相同的函数。

# mysql - 最新发送或接收的消息（facebook 风格）

> ID：11208375
> 
> 赞同：0
> 
> 时间：2012-06-26T13:28:23.633
> 
> 标签：mysql, sql, messages

```
SELECT p.*, m.*
FROM  " . DB_PREFIX . "messages AS p, " . DB_PREFIX . "members AS m
WHERE p.member_id2='" . $SESSION->conf['member_id'] . "' AND p.member_id1=m.member_id
ORDER BY p.senddate DESC 
```

我正在尝试为我的社交网站中的所有用户设置一个收件箱。我希望它的设置与 Facebook 完全一样，在与每个用户的每次对话中，您只会看到一行。因此，您只会看到最新收到或发送给该用户的消息。

上面的代码是我目前拥有的，但它只是向我显示所有收到的消息。如何设置查询以查找最新发送或接收的消息（每个用户仅一行）？

member_id1 是发送者 member_id2 是接收者

这是我的桌子的屏幕截图 [http://i.imgur.com/zY6fF.png](http://i.imgur.com/zY6fF.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:33:01.183

```
SELECT p.*, m.*
FROM  " . DB_PREFIX . "messages AS p, " . DB_PREFIX . "members AS m
WHERE p.member_id2='" . $SESSION->conf['member_id'] . "' AND p.member_id1=m.member_id
ORDER BY p.senddate DESC
LIMIT 1 
```

# iphone - 无法播放视频

> ID：11208376
> 
> 赞同：0
> 
> 时间：2012-06-26T13:28:29.373
> 
> 标签：iphone, objective-c, ios

我想从网上下载视频并将该文件写入本地文件夹。我为此做了以下代码：

```
 if(videoUrl!=Nil)
        {
            if(moviePlayer==NULL)
            {

                NSString *newPath = @"/Users/theuser/Desktop/data/b.m3u8";
                NSData *videoData = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://devimages.apple.com/iphone/samples/bipbop/bipbopall.m3u8"]];
                NSLog(@"data=%@",videoData);
                [videoData writeToFile:newPath atomically:YES];
            }

        } 
```

我正在同一应用程序中检索视频。我有以下代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
   // NSString *directory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSString *newPath = @"/Users/theuser/Desktop/data/b.m3u8";//[directory stringByAppendingPathComponent:@"myMovie.m3u8"];
    NSLog(@"path=%@",newPath);
    moviePlayerController=[[MPMoviePlayerController alloc]initWithContentURL:[NSURL fileURLWithPath:newPath isDirectory:NO]];
    moviePlayerController.scalingMode=MPMovieScalingModeAspectFill;
    moviePlayerController.view.frame=CGRectMake(320,200,320,200);
    [self.view addSubview:moviePlayerController.view];
    [moviePlayerController play];
    NSLog(@"played");

} 
```

但我得到以下异常：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'An AVPlayerItem cannot be associated with more than one instance of AVPlayer' 
```

为什么会这样？

# hidden-field - 为什么我收到 System.Data.Linq.Binary 的 Html.Hidden 错误？

> ID：11208378
> 
> 赞同：0
> 
> 时间：2012-06-26T13:28:32.197
> 
> 标签：hidden-field

我想将隐藏的 openid 数据发布到一个动作中，在 Razor 中我使用以下代码：

```
@Html.Hidden("OpenID", Request.QueryString["openid"]); 
```

然后我收到此错误：

```
Compiler Error Message: CS0012: The type 'System.Data.Linq.Binary' is defined in an     assembly that is not referenced. You must add a reference to assembly 'System.Data.Linq,     Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.

Source Error:

Line 11: 
Line 12: <form method="post" action="Register">
Line 13:     @Html.Hidden("OpenID", Request["openid"]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:35:37.307

```
 <compilation debug="true">
  <assemblies>
   <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Data.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
  </assemblies>
</compilation> 
```

# java - 为什么 JCE 初始化需要 MD5

> ID：11208380
> 
> 赞同：6
> 
> 时间：2012-06-26T13:28:36.097
> 
> 标签：java, security, jce, fips

我正在尝试在我的 java 应用程序上启用 FIPS 180-3。FIPS 180-3 只允许使用 5 个安全 [哈希] (http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf)，MD5 不是其中之一。因此，我试图以编程方式从 Sun 提供程序中删除 MD5 算法。这是示例代码。

* * *

```
public static void main(String[] args) throws Exception {
    Security.removeProvider("SUN");
    Sun sun = new Sun();
    sun.remove("MessageDigest.MD5"); //Comment and it will work !!!
    Security.addProvider(sun);
    Cipher ciph = Cipher.getInstance("AES");                
} 
```

* * *

但这会引发以下异常。如果您评论“sun.remove(..”该程序可以正常工作。如果我删除 MD2，而不是 MD5，那么它也可以正常工作。

在我看来，jre 库似乎使用 MD5 进行签名，但我检查了 jre/lib/ext/sunjce_provider.jar 签名者及其使用 sha1。

知道为什么我的代码因此错误而失败吗？

TestRemoveMD5.main(TestRemoveMD5.java:20) 的 javax.crypto.Cipher.getInstance(DashoA13*..) 的线程“主”java.lang.ExceptionInInitializerError 中的异常

原因：java.lang.SecurityException：无法在 javax.crypto.SunJCE_b.(DashoA13*..) 上为受信任的 CA 设置证书 ... 3 更多

原因：java.lang.SecurityException：签名类已在 javax.crypto.SunJCE_b$1 的 javax.crypto.SunJCE_b.c(DashoA13*..) 的 javax.crypto.SunJCE_b.d(DashoA13*..) 处被篡改.run(DashoA13*..) at java.security.AccessController.doPrivileged(Native Method) ... 还有 4 个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:47:07.863

这是一项安全功能，可防止不受信任的代码删除 Sun 提供程序。有一种方法可以做到这一点，它需要拥有适当的权限。如果您访问此链接[http://docs.oracle.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html](http://docs.oracle.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html)并向下滚动到标题标题**The Security Class**您可以阅读有关如何删除提供者以及会发生什么。

**编辑**

从文档中摘录的已安装的非扩展提供程序可能需要一个策略文件来执行某些操作，例如添加和删除提供程序。值得一试。

> 您将使用的每个提供商的供应商的文档应包含有关其需要哪些权限以及如何授予此类权限的信息。例如，**如果提供者不是已安装的扩展**并且安装了安全管理器，则提供者可能需要以下权限

-

> Security 类管理已安装的提供程序和安全范围的属性。它只包含静态方法，从不实例化。添加或删除提供程序以及设置安全属性的方法只能由受信任的程序执行。目前，“受信任的程序”是
> 
> *   不在安全管理器下运行的本地应用程序，或
> *   有权执行指定方法的小程序或应用程序（见下文）。
> 
> 确定认为代码被认为可以执行尝试的操作（例如添加提供程序）的确定要求小程序被授予该特定操作的适当权限。

-

> 此类文件中的每个“授予”语句都授予指定的代码源一组权限，指定允许哪些操作。
> 
> 这是一个示例策略配置文件：
> 
> ```
> grant codeBase "file:/home/sysadmin/", signedBy "sysadmin" {
>     permission java.security.SecurityPermission "insertProvider.*";
>     permission java.security.SecurityPermission "removeProvider.*";
>     permission java.security.SecurityPermission "putProviderProperty.*";
> }; 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T06:36:43.187

所以我从这个练习中的推论是，由于 jce 本身需要 MD5 来验证其类以用于签名目的，我们不能从 jre 中删除 MD5 算法，因此 jre 1.6 本身不能成为 FIPS 180-3 投诉。

FIPS 中的 c# 无法加载 MD5。请参阅[对于启用 FIPS 的系统，是否有替代 MD5 的散列算法？](https://stackoverflow.com/questions/4893088/is-there-an-alternate-hashing-algorithm-to-md5-for-fips-enabled-systems). 通过上面的测试，我猜 java 不能做到这一点。

如果有人通过观察或任何我可能忽略的明显错误反对，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T06:28:05.903

我想我可能已经找出了根本原因，但仍然无法弄清楚它的来源。我尝试调试 X509CertImpl 并获得了一个使用 MD5 的“JCE Development”签名的证书。但是所有其他加载的证书都是使用 SHA1withDSA 正确签名的。我不确定这是否应该是 jre 上的错误。

[ [ 版本：V1 主题：CN=JCE Development，OU=Java Software，O=Sun Microsystems，L=Cupertino，ST=CA，C=US 签名算法：MD5withRSA，OID = 1.2.840.113549.1.1.4

Key: Sun RSA public key, 512 bits modulus: 9182591386680323574119504178341234548416270629561070323164514737894957593991212767744352158438329809500219147803751143974067780130174290713135793698837217 public exponent: 65537 Validity: [From: Thu Oct 31 20:57:44 IST 2002, To: Wed Oct 31 20:57:44 IST 2007] Issuer: CN=JCE开发，OU=Java 软件，O=Sun Microsystems，L=Cupertino，ST=CA，C=US 序列号：[02]

] 算法：[MD5withRSA] 签名：0000：2F E5 9C 54 5C A3 FA 25 E5 11 53 55 41 B3 4E 39 /..T..%..SUA.N9 0010：49 56 9A 59 97 1A 23 4A 29 79 C8 74 D7 1C D5 95 IV.Y..#J)yt... 0020: 32 8B E2 56 D3 39 A5 7D 9E E2 53 F7 91 62 11 04 2..V.9....S..b .. 0030: 24 1C 1D AD 4A 32 88 63 86 2E 8E E9 8B A2 73 00 $...J2.c.......

]

# web-services - 使用 Guvnor 在 Web 服务中编辑 Drools

> ID：11208383
> 
> 赞同：0
> 
> 时间：2012-06-26T13:28:49.347
> 
> 标签：web-services, jax-rs, drools

我们刚刚开始使用作为 RESTful Web 服务公开的 Drools（从[http://www.jboss.org/drools/downloads.html](http://www.jboss.org/drools/downloads.html)上的 Drools 集成下载中的示例开始，我们的项目看起来类似于这个[http： //docs.jboss.org/drools/release/5.4.0.CR1/droolsjbpm-integration-docs/html/ch03.html#](http://docs.jboss.org/drools/release/5.4.0.CR1/droolsjbpm-integration-docs/html/ch03.html#) )。这会生成一个 .wadl，如下所示：

```
<application xmlns="http://wadl.dev.java.net/2009/02" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <grammars/>
    <resources base="http://localhost:8080/msci-poc-drools-server/kservice/rest">
        <resource path="/">
            <resource path="execute">
                <method name="POST">
                    <request>
                        <representation mediaType="text/plain"/>
                    </request>
                    <response>
                        <representation mediaType="text/plain"/>
                    </response>
                </method>
            </resource>
        </resource>
    </resources>
</application> 
```

我们想做的是允许通过 Guvnor 应用程序在 Drools 中编辑规则。我不确定这是否可能（据我所知，Guvnor 似乎包装了它自己的 Drools 知识库实例）。这可能吗？做起来有多容易？

**我想我的问题确实是这样，我如何拥有一个作为 Web 服务公开的 Drools，如果我愿意，我也可以使用 Guvnor 进行编辑？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:34:13.867

可以将 Guvnor 的规则编辑器功能嵌入到您的 Web 应用程序中。

请参阅[http://www.plugtree.com/guvnor-embed-asset%E2%80%99s-editor-in-your-application/](http://www.plugtree.com/guvnor-embed-asset%E2%80%99s-editor-in-your-application/)

# android - android中对话框背后的背景

> ID：11208384
> 
> 赞同：0
> 
> 时间：2012-06-26T13:28:52.777
> 
> 标签：android, background, dialog

我想在对话框后面使用整个黑色背景，但是当我将背景更改为 #FF000000 时，只能在屏幕中间看到黑色（它应该填满整个屏幕）。

![在此处输入图像描述](../Images/72cdf2f46cb58b987b1946464dbc5daa.png)

这是我的拨号样式：

```
<style name="dialog" parent="@android:style/Theme.Dialog">
    <item name="android:windowFrame">@null</item>
    <item name="android:windowBackground">@android:color/transparent</item>
    <item name="android:windowIsFloating">true</item>
    <item name="android:windowContentOverlay">@null</item>
    <item name="android:windowTitleStyle">@null</item>
    <item name="android:windowAnimationStyle">@android:style/Animation.Dialog</item>
    <item name="android:windowSoftInputMode">stateUnspecified|adjustPan</item>
    <item name="android:backgroundDimEnabled">false</item>
    <item name="android:background">#FF000000</item>
</style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:51:20.393

您是否对布局文件的 layout_width 和 layout_height 属性使用“match_parent”或“fill_parent”？如果您使用 wrap_content 它不会将您的视图扩展到屏幕边缘

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T12:14:16.837

尝试将 android:backgroundDimEnabled 设置为 true 并为 dimAmount 创建一个值为 1 的新项目。

否则，将以下内容添加到您的代码中：

```
WindowManager.LayoutParams params = new WindowManager.LayoutParams( );
params.copyFrom( m_dialog.getWindow( ).getAttributes( ) );
params.width = WindowManager.LayoutParams.MATCH_PARENT;
params.height = WindowManager.LayoutParams.MATCH_PARENT;
m_dialog.getWindow( ).setAttributes( params ); 
```

# c# - 数据绑定到winform？

> ID：11208386
> 
> 赞同：0
> 
> 时间：2012-06-26T13:28:55.207
> 
> 标签：c#, winforms

我想我会在 winforms 中进行数据绑定，并使用类为我的项目创建一个对象数据源。我让 IDE 通过将它们拖到表单上来为数据源创建一个 dataGridView 和控件。

我现在想做的是将整个表单的数据源设置为这些类的集合。所以控件是“神奇地自动”填充的。我以前做过一次，但现在无法访问代码。我的谷歌搜索只显示绑定到控件。

我很确定它与表单的 BindingContext 有关系，但同样，谷歌没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:19:09.473

我又想通了。当您将这些控件拖放到表单上时，IDE 会为它们创建一个数据源。然后它会“神奇地自动”将所有控件数据源分配给该数据源。

私有 System.Windows.Forms.BindingSource 转换4GLBindingSource；

所以我要做的就是：

this.conversion4GLBindingSource.DataSource = Conversion4GL.History;

在 form_load 事件中，我所有的东西都可以正常工作……神奇地自动！真的很酷。当您的类继承自 INotifyPropertyChanged 并且您可以看到您的字段在您键入时发生变化时，这真的很酷。

感谢大家的帮助。

# multithreading - Firefox浏览器：相同进程或不同进程的线程

> ID：11208388
> 
> 赞同：1
> 
> 时间：2012-06-26T13:29:04.037
> 
> 标签：multithreading, operating-system

今天我正在阅读关于`thread`vs的内容`process`。
我真的很困惑它的例子。

假设我们正在执行`Firefox`浏览器。它包含 fer 选项卡。现在，当打开一个新选项卡时，`Is it called the thread of the same process?`

现在，用户调用`Firefox`. 假设浏览器的一个副本有 5 个选项卡，而另一个 [ `new copy`] 有 3 个选项卡。**它们是被称为同一进程的线程还是被`OS`不同的进程视为？**

我打开`task manager`[ `Windows XP`] 发现它只显示了一个`Firefox`.
请澄清**这是什么意思？**

# jaxb - 具有属性和值的 JAXB XMLElementWrapper

> ID：11208389
> 
> 赞同：2
> 
> 时间：2012-06-26T13:29:06.050
> 
> 标签：jaxb

我试图创建一个类似于下面提到的 xml 文件。

```
<message>
   <header>
      <params>
         <param name="test1">value1</param>
         <param name="test2">value2</param>
      </params>
   </header>
</message> 
```

你能告诉我，如何定义类层次结构。

谢谢， Prakash.A

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T15:22:22.280

```
@XmlRootElement
public class Message {

    @XmlElement
    private Header header;
}

public class Header {

    @XmlElement(name="param")
    @XmlElementWrapper
    private Collection<Param> params;
}

public class Param {

    @XmlAttribute
    private String name;

    @XmlValue
    privaet String value;
} 
```

你的标记上的吸气剂/二传手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T02:55:00.653

使用@XmlElementWrapper 的最佳方式。应该表示名字。像 @XmlElementWrapper(name="params") 虽然在这种情况下默认名称是属性的名称。

# android - 捕获和预览图像

> ID：11208397
> 
> 赞同：0
> 
> 时间：2012-06-26T13:29:19.217
> 
> 标签：android

我的应用程序是打开内置相机并将其保存到 sd 卡中，然后启动一个新活动并在其上预览捕获的图像。

这是启动新的 AsynTask 以打开相机的 loginActivity ：

```
package com.android.grad;

import java.io.File;
import java.text.SimpleDateFormat;
import java.util.Date;

import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.EditText;
import android.widget.Toast;

import com.Camera.R;

public class LoginActivity extends Activity {

    private final int MEDIA_TYPE_IMAGE = 1;
    private CheckBox rememberMe;
    private EditText userName, passWord;
    private Button loginBtn;
    private final int CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE = 100;
    private String path;
    private Uri fileUri;

    private OnClickListener loginOnClick = new OnClickListener() {
        public void onClick(View v) {
            new LoginTask(LoginActivity.this, fileUri).execute();
        }
    };

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.login);

        fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE);
        path = fileUri.getPath();

        loginBtn = (Button) findViewById(R.id.signInBtn);
        loginBtn.setOnClickListener(loginOnClick);

        rememberMe = (CheckBox) findViewById(R.id.keepMe);

        userName = (EditText) findViewById(R.id.userNameID);
        passWord = (EditText) findViewById(R.id.passwordID);
    }

    @Override
    protected void onResume() {
        super.onResume();
        SharedPreferences sp = getSharedPreferences("user", MODE_PRIVATE);
        try {
            userName.setText(sp.getString("username", ""));
            passWord.setText(sp.getString("password", ""));
            rememberMe.setChecked(sp.getBoolean("rememberMe", false));
        } catch (ClassCastException ex) {
        }
    }

    @Override
    protected void onPause() {
        super.onPause();

        SharedPreferences sp = getSharedPreferences("user", MODE_PRIVATE);
        Editor editor = sp.edit();
        if (rememberMe.isChecked()) {
            editor.putString("username", userName.getText().toString());
            editor.putString("password", passWord.getText().toString());
        } else {
            editor.putString("username", "");
            editor.putString("password", "");
        }
        editor.putBoolean("rememberMe", rememberMe.isChecked());
        editor.commit();
    }

    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
            if (resultCode == RESULT_OK) {

                Intent intent = new Intent(LoginActivity.this,
                        PreviewActivity.class);
                intent.putExtra("path", path);
                startActivity(intent);

            } else if (resultCode == RESULT_CANCELED) {
                // User cancelled the image capture
                Toast.makeText(getApplicationContext(),
                        "User cancelled the image capture", Toast.LENGTH_LONG)
                        .show();
            } else {
                // Image capture failed, advise user
            }
        }
    }
    /** Create a file Uri for saving an image or video */
    private Uri getOutputMediaFileUri(int type) {
        File f = getOutputMediaFile(type);
        if (f == null) {
            Toast.makeText(LoginActivity.this, "MyCameraApp File not found",
                    Toast.LENGTH_LONG);
            return null;
        }
        return Uri.fromFile(f);
    }

    /** Create a File for saving an image or video */
    private File getOutputMediaFile(int type) {
        // Check if SD card is mounted
        if (Environment.getExternalStorageState().equals(
                Environment.MEDIA_MOUNTED)) {

            File externalFilesDir = LoginActivity.this
                    .getExternalFilesDir(Environment.DIRECTORY_PICTURES);
            File outFile = new File(externalFilesDir, "IDOCR");

            if (!outFile.exists())
                outFile.mkdirs();

            // Create a media file name
            String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss")
                    .format(new Date());

            String path = outFile.getPath() + File.separator + "IMG"
                    + timeStamp + ".jpg";

            File mediaFile = new File(path);
            return mediaFile;
        }
        Toast.makeText(LoginActivity.this, "SD card unmounted",
                Toast.LENGTH_LONG);
        return null;
    }
} 
```

这是 AsynTask :-

```
package com.android.grad;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.net.Uri;
import android.os.AsyncTask;
import android.provider.MediaStore;

public class LoginTask extends AsyncTask<Void, Void, Boolean> {

private Activity activity;
private ProgressDialog pd;
private Uri fileUri;
private final int CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE = 100;

public LoginTask(Activity activity, Uri fileUri) {
    this.activity = activity;
    this.fileUri = fileUri;
}

@Override
protected void onPreExecute() {
    pd = ProgressDialog.show(activity, "Signing in",
            "Please wait while we are signing you in..");
}

@Override
protected Boolean doInBackground(Void... arg0) {
    try {
        Thread.sleep(1000);
    } catch (InterruptedException e) {
    }
    return true;
}

@Override
protected void onPostExecute(Boolean result) {
    pd.dismiss();
    pd = null;

    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
    intent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri);
    activity.startActivityForResult(intent,
            CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);
}
} 
```

这是previewActivity：-

```
package com.android.grad;

import java.io.File;
import java.io.IOException;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;

import com.Camera.R;
import com.OCR.ID.AndroidImage;
import com.OCR.ID.Segement;

public class PreviewActivity extends Activity {

    private ImageView previewIV;
    private final int CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE = 100;
    private String path;
    private boolean crop = true;
    private boolean resample = true;
    private ProgressDialog pd;

    OnClickListener processOnClickListener = new OnClickListener() {
        public void onClick(View v) {
            try {
                createProgressDialog();
                pd.show();
                new Segement(PreviewActivity.this, pd).execute(path);
            } catch (IOException e) {
            }
        }
    };

    private void createProgressDialog() {
        pd = new ProgressDialog(PreviewActivity.this);
        pd.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        pd.setTitle("Extract ID");
        pd.setMessage("Processing...");
        pd.setIcon(R.drawable.ic_launcher);
        pd.setProgress(0);
        pd.setCancelable(false);
    }

    private OnClickListener backOnClickListener = new OnClickListener() {
        public void onClick(View v) {
            startActivityForResult(
                    new Intent(MediaStore.ACTION_IMAGE_CAPTURE).putExtra(
                            MediaStore.EXTRA_OUTPUT,
                            Uri.fromFile(new File(path))),
                    CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);
        }
    };

    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (resultCode == RESULT_OK) {
            if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
                previewIV.setImageBitmap(BitmapFactory.decodeFile(path));
            }
        }
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.preview);

        path = getIntent().getExtras().getString("path");

        previewIV = (ImageView) findViewById(R.id.previewPicID);
        previewIV.setImageBitmap(AndroidImage.decodeSampledBitmapFromSDcard(
                path, 150, 150));
        // previewIV.setImageBitmap(AndroidImage.readImage(path));

        Button process = (Button) findViewById(R.id.processID);
        process.setOnClickListener(processOnClickListener);

        Button back = (Button) findViewById(R.id.back);
        back.setOnClickListener(backOnClickListener);
    }
} 
```

有时拍照时出现在previewActivity中有时不出现的错误？

为什么会出现这个错误？？

# asp.net - 更新时删除的命名范围

> ID：11208400
> 
> 赞同：1
> 
> 时间：2012-06-26T13:29:36.627
> 
> 标签：asp.net, vb.net, excel, oledb, named-ranges

我有一个 excel 文件用作我的后端（我无法控制这个选择）并且我已经创建了我的命名范围。我正在使用 OLEDB 从我在 VB.Net 中的应用程序连接到工作表。

但是，一旦我更新了我的应用程序中的任何工作表，我的所有命名范围都将被删除并且应用程序停止工作。如果我只是从工作簿中阅读，则不会发生这种情况。任何人都经历过这个以及任何可能的想法或解决方案？

# tomcat - 无缝继续部署 Maven 项目

> ID：11208404
> 
> 赞同：0
> 
> 时间：2012-06-26T13:29:54.820
> 
> 标签：tomcat, maven, deployment

是否有人熟悉逐步部署 tomcat 服务器的说明，这将允许无缝继续部署，而不会切断用户在每个项目部署中的会话？我有一个需要启动的 Maven Spring 项目，因为我知道我必须不断升级。任何想法将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T16:29:36.767

您可以尝试查看的是[maven-cargo-plugin](http://cargo.codehaus.org/Maven2+plugin)，它使您有机会部署到 Tomcat 等。此外，还有[tomcat-maven-plugin](http://tomcat.apache.org/maven-plugin-2/)可用于在 Tomcat 上进行部署。您应该深入了解最适合您需求的情况。

# forms - 如何对 Access 表单上的按钮进行编程，以链接到在 Google 地图上查找多个地址的浏览器窗口？

> ID：11208407
> 
> 赞同：0
> 
> 时间：2012-06-26T13:30:01.573
> 
> 标签：forms, api, google-maps, ms-access, vba

我的问题与此处发布的问题非常相似：

```
http://www.utteraccess.com/forum/Plotting-Addresses-Maps-t1968130.html 
```

除了该线程从未找到任何解决方案。基本上，我正在处理一个将数据表作为子表单的 Access 表单。单击主窗体上的按钮后，我试图打开一个浏览器窗口，并使用子窗体中电子表格数据中的地址列，绘制所有列出的地址标记。我已经寻找了很多方法来尝试这个，但我还没有找到一种似乎有效的方法。

我什至不确定是否可以在谷歌地图上绘制多个标记，但根据研究（并且在我自己尝试过之后），它似乎不是，虽然我不想完全排除它，因为我'我仍然不能 100% 确定。但是我知道 Google 地球和 batchgeo.com 都允许这样做。我仍然想尝试在 Google 地图上执行此操作，但如果这不起作用，我想尝试使用 batchgeo.com 执行此操作，如果仍然不起作用，则使用 Google 地球（我不想制作如果可能，用户下载外部软件）。

如果它有帮助，从我读到的 API 似乎是一个有用的工具，虽然我不确定如何将它应用于 Access 表单，但它似乎更像是一种嵌入现有网站的方式。

如果有人能帮助我弄清楚如何解决这个问题，我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:22:32.627

也许这会有所帮助？

[http://ramblings.mcpher.com/Home/excelquirks/getmaps/mapmarkers](http://ramblings.mcpher.com/Home/excelquirks/getmaps/mapmarkers)

它是 Excel，但应该是可翻译的。

这是另一个示例，这次使用 Access： [http ://www.utteraccess.com/forum/Google-Maps-Multiple-Mar-t1973499.html](http://www.utteraccess.com/forum/Google-Maps-Multiple-Mar-t1973499.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T13:12:14.207

> ...从我读过的内容来看，API 似乎是一个有用的工具，虽然我不确定如何将它应用于 Access 表单，但它似乎更像是一种嵌入现有网站的方式。

你是对的。我知道，没有办法将 Google Maps 对象嵌入到表单中（如 ActiveX 控件）。[Microsoft MapPoint](http://msdn.microsoft.com/en-us/library/gg674717.aspx)是一种软件产品，可让您通过 ActiveX 控件进行地图集成（无需使用 HTML 和/或 javascript）。

我通常在像你这样的项目上做的是让我的 HTML 页面按照我想要的方式工作，在 MS Access 之外并且独立于 MS Access。您应该能够在本地对 HTML 文件进行编程和测试，而无需使用实际的 Web 服务器。只需使用 NotePad++ 或 Sublime Text Editor 2 之类的东西来编写 HTML 和 Javascript，然后在浏览器中打开文件，看看它是否有效。我很确定你需要在你的 HTML 页面中使用 Javascript 来完成这项工作。这就是 Google Maps API 的全部意义所在。

在您的网页正常工作后，您必须进入 Access 并编写代码以使用当前数据集的地址数据动态创建该网页。您可以将其写入 Windows Temp 文件夹，然后打开浏览器控制该网页。

Julian Knight 的答案链接到有关如何动态创建 HTML 页面的更多细节。它看起来像狼吞虎咽，主要是因为它是。从 VBA 输出 HTML/Javascript/CSS 远不是最佳的。这就是您在 Access 之外尽可能多地对其进行故障排除的原因。

# android - 如何获得带有搜索框的自定义列表视图被点击？

> ID：11208411
> 
> 赞同：0
> 
> 时间：2012-06-26T13:30:18.253
> 
> 标签：android, listview, onclicklistener, custom-lists

我有三个列表，其中包含“根、顶部和向下”。但是当我用“top”过滤列表时，然后我点击列表，它出现的是“root”。我怎样才能使它成为我们过滤的可点击列表？

列表.java

```
 public class root extends Activity {

EditText edittext;
ListView listview;

private String[] text = { "ROOT", "TOP", "DOWN" };

private int[] image = { R.drawable.root, R.drawable.top, R.drawable.down };

int textlength = 0;

ArrayList<String> text_sort = new ArrayList<String>();
ArrayList<Integer> image_sort = new ArrayList<Integer>();

public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.mainlistview);

    this.getWindow().setSoftInputMode(
            WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);

    edittext = (EditText) findViewById(R.id.EditText01);
    listview = (ListView) findViewById(R.id.ListView01);
    listview.setAdapter(new MyCustomAdapter(text, image));

    listview.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

            if ("ROOT".equals(text[position])) {
                Intent myIntent = new Intent(view.getContext(),
                        root.class);
                startActivityForResult(myIntent, 0);

            }
            if ("TOP".equals(text[position])) {
                Intent myIntent = new Intent(view.getContext(),
                        top.class);
                startActivityForResult(myIntent, 0);
            }
            if ("DOWN".equals(text[position])) {
                Intent myIntent = new Intent(view.getContext(),
                        down.class);
                startActivityForResult(myIntent, 0);

        }

    });

    edittext.addTextChangedListener(new TextWatcher() {

        public void afterTextChanged(Editable s) {

        }

        public void beforeTextChanged(CharSequence s, int start, int count,
                int after) {

        }

        public void onTextChanged(CharSequence s, int start, int before,
                int count) {

            textlength = edittext.getText().length();
            text_sort.clear();
            image_sort.clear();

            for (int i = 0; i < text.length; i++) {
                if (textlength <= text[i].length()) {
                    if (edittext
                            .getText()
                            .toString()
                            .equalsIgnoreCase(
                                    (String) text[i].subSequence(0,
                                            textlength))) {
                        text_sort.add(text[i]);
                        image_sort.add(image[i]);
                    }
                }
            }

            listview.setAdapter(new MyCustomAdapter(text_sort, image_sort));

        }
    });
}

class MyCustomAdapter extends BaseAdapter {

    String[] data_text;
    int[] data_image;

    MyCustomAdapter() {

    }

    MyCustomAdapter(String[] text, int[] image) {
        data_text = text;
        data_image = image;
    }

    MyCustomAdapter(ArrayList<String> text, ArrayList<Integer> image) {

        data_text = new String[text.size()];
        data_image = new int[image.size()];

        for (int i = 0; i < text.size(); i++) {
            data_text[i] = text.get(i);
            data_image[i] = image.get(i);
        }

    }

    public int getCount() {
        return data_text.length;
    }

    public String getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        LayoutInflater inflater = getLayoutInflater();
        View row;

        row = inflater.inflate(R.layout.listview, parent, false);

        TextView textview = (TextView) row.findViewById(R.id.TextView01);
        ImageView imageview = (ImageView) row
                .findViewById(R.id.ImageView01);

        textview.setText(data_text[position]);
        imageview.setImageResource(data_image[position]);

        return (row);

    }
} 
```

}

主要的.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<EditText
    android:id="@+id/EditText01"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:hint="Search" >
</EditText>

<ListView
    android:id="@+id/ListView01"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >
</ListView> 
```

列表视图.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:background="#fff200"
android:gravity="left|center"
android:paddingBottom="5px"
android:paddingLeft="5px"
android:paddingTop="5px" >

<ImageView
    android:id="@+id/ImageView01"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >
</ImageView>

<TextView
    android:id="@+id/TextView01"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10px"
    android:textColor="#0099CC"
    android:textSize="20px"
    android:textStyle="bold" >
</TextView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:45:49.257

问题在于您`onItemClickListener`的`ListView`：

```
listview.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view,
            int position, long id) {

        if ("ROOT".equals(text[position])) {
            Intent myIntent = new Intent(view.getContext(),class);
            startActivityForResult(myIntent, 0); 
```

过滤后`ListView`，您`ListView`将只显示 1 项。当您单击此项目时，`onItemClick`将被触发。因为您单击的项目位于新过滤的第一个位置`ListView`，所以变量`position`为 0。您的第一个项目`Array text[]`是“ROOT”，因此将启动 RootActivity。

**解决方案**

询问您的适配器您单击了哪个视图并将其与字符串进行比较：

在你的内部`onItemClicked(..)`：

```
View selectedView = yourAdapter.getItemAtPosition(position)
TextView myText = (TextView) selectedView.findViewById(R.id.TextView01).getText() 

if(myText.equals("ROOT")){
   // start Activity.. 
```

# javascript - 当字段为空时，val() 返回占位符值而不是 IE8,9 中的实际值

> ID：11208417
> 
> 赞同：18
> 
> 时间：2012-06-26T13:30:34.863
> 
> 标签：javascript, jquery

下面显示的占位符属性在 Firefox 中可以正常工作，但是如果在字段为**空**时调用 val()，它会返回占位符值而不是文本中的实际值。

JSFiddle - [http://jsfiddle.net/Jrfwr/2/](http://jsfiddle.net/Jrfwr/2/)

```
<input id="tlt" type="text" placeholder="Enter Title" /> 
```

JS代码

```
function placeHolderFallBack() {
   if ("placeholder" in document.createElement("input")) {
       return;
   }
   else {
       $('[placeholder]').focus(function () {
           var input = $(this);
           if (input.val() == input.attr('placeholder')) {
               input.val('');
               input.removeClass('placeholder');
           }
       }).blur(function () {
           var input = $(this);
           if (input.val() == '' || input.val() == input.attr('placeholder')) {
               input.addClass('placeholder');
               input.val(input.attr('placeholder'));
           }
       }).blur();
       $('[placeholder]').parents('form').submit(function () {
           $(this).find('[placeholder]').each(function () {
               var input = $(this);
               if (input.val() == input.attr('placeholder')) {
                   input.val('');
               }
           })
       });
   }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-26T13:47:43.467

您可以覆盖 val() 方法，但我不喜欢这样做：D

我写了一个简单的`pVal()`函数来完成这项工作

```
$.fn.pVal = function(){
    var $this = $(this),
        val = $this.eq(0).val();
    if(val == $this.attr('placeholder'))
        return '';
    else
        return val;
}
$(function(){
    alert($('input').val())
    alert($('input').pVal())
});​ 
```

[http://jsfiddle.net/W7JKt/3/](http://jsfiddle.net/W7JKt/3/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T13:55:13.240

在您的 JSFiddle 代码中，您可以在 BUTTON CLICK 事件中获取文本框的值......并且检查文本框的当前值是否等于占位符的代码在 FORM SUBMIT 事件中执行。

所以...问题是 BUTTON 的 CLICK 事件在 FORM 的 SUBMIT 事件之前执行。

[此代码显示了如何获取正确值的示例](http://jsfiddle.net/paTZm/5/ "例子")

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:47:50.307

它与 HTML 5 有关。请参阅这篇文章。

[http://www.cssnewbie.com/cross-browser-support-for-html5-placeholder-text-in-forms/](http://www.cssnewbie.com/cross-browser-support-for-html5-placeholder-text-in-forms/)

# java - 如何从 Java 中的 HTML 页面中提取 JavaScript 链接？

> ID：11208420
> 
> 赞同：0
> 
> 时间：2012-06-26T13:30:40.923
> 
> 标签：java, javascript, html-parsing, hyperlink

我有 HTML 页面作为 Java 中的字符串，我需要从中提取 JavaScript 链接。我可以使用任何好的且易于使用的库吗？我查了[Cobra](http://lobobrowser.org/cobra.jsp)和[Neko](http://nekohtml.sourceforge.net/)，但我不认为（也许我错了）他们有我需要的东西，比如获取标签特定的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:34:49.480

看看[JSoup](http://jsoup.org/)。它是一个 HTML 解析器，具有用于查找 dom 元素的选择器-DSL（域特定语言）。

例如，要查找所有`a`带有 的标签`href`，您可以这样做：

```
Document doc = Jsoup.connect("http://www.google.com/").get();
Elements hrefAnchors = doc.select("a[href]"); 
```

如果您已经将 html 下载为`String`，则可以使用以下`parse(String)`方法：

```
String html = "<p>Welcome to <a href='http://www.google.com/'>Google</a>.</p>";
Document doc = Jsoup.parse(html); 
```

# wpf - 从资源设置图像时出现 XamlParseException

> ID：11208426
> 
> 赞同：9
> 
> 时间：2012-06-26T13:30:56.257
> 
> 标签：wpf, image, xaml, resources, ribbon

我遇到了一些麻烦。我刚刚在我的应用程序中实现了 Microsoft 功能区框架。现在我想为一个按钮设置一个图标。所以我写道：

```
 <Ribbon:RibbonButton Header="Create Project" LargeImageSource="pack://application:,,,/Resources/document_empty.png" /> 
```

但是每次我启动应用程序时，我都会在这一行中得到一个“XamlParseException”，内部异常是：“找不到文件”。

为什么会这样？我不明白，为什么它找不到图像。它只是放在程序集的资源中。设计师展示了它并且代码没有突出显示，因为它是语法错误或类似的东西......

谁也有这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-26T15:33:05.963

由于您没有准确指定，我假设您正在使用应用程序的 Properties\resources.resx 部分？如果是这样，这不是 WPF 应用程序所需的方式。

[在 SO 上](https://stackoverflow.com/questions/4775030/different-way-how-add-image-to-resources)看到这个帖子

而是在您的程序集中创建一个文件夹，将您的图像放在那里并将其构建操作设置为资源。

见图片： ![在此处输入图像描述](../Images/c16a71bab423ec8cea28debac9c36326.png)

在您的标记中使用 packUri：

> pack://application:,,,/images/IMG.jpg

# android - Facebook Like 按钮重定向到 android 中的 facebook 网站

> ID：11208427
> 
> 赞同：10
> 
> 时间：2012-06-26T13:30:56.480
> 
> 标签：android, facebook, facebook-like

我正在开发类似 facebook 的按钮以与我的应用程序集成。这是从 developers.facebook.com 复制的 html 代码

```
<html>
<body>                   
    <div id="fb-root"></div>
    <script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) 
                return;
            js = d.createElement(s); 
            js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=my_app_id";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
    <fb:like data-href="http://www.facebook.com/facintegra" data-send="true" data-width="450" data-show-faces="false" data-font="tahoma"/>
</body> 
```

我的安卓活动代码

```
mWebView = (WebView) findViewById(R.id.webview);
    mWebView.getSettings().setJavaScriptEnabled(true);
    mWebView.getSettings().setAppCacheEnabled(true);
    mWebView.getSettings().setJavaScriptCanOpenWindowsAutomatically(true);
    mWebView.loadUrl("file:///android_asset/FacebookLikeView.html");

    m_cObjFacebook = new Facebook("Your_id");

    authorizefacebook();

}

private void authorizefacebook(){
    m_cObjFacebook.authorize(this, m_cPermissions, new DialogListener() {
        @Override
        public void onComplete(Bundle values) {
            m_cAccessToken = values.getString(Facebook.TOKEN);

        }

        @Override
        public void onFacebookError(FacebookError error) {
            System.out.println(error.toString());
        }

        @Override
        public void onError(DialogError e) {
            System.out.println(e.toString());
        }

        @Override
        public void onCancel() {
            System.out.println("Cancel");
        }
    });
}
} 
```

当应用程序启动时，它会检查我是否登录到 facebook。如果没有，它会显示 facebook 登录屏幕进行登录，然后在登录成功后，它会转到我的 facebook 页面而不是我的 android 应用程序页面。

如果它发现我已登录，那么它会显示如下屏幕。

请帮助我哪里出错了

我的应用程序的第一个屏幕

![我的第一个屏幕](../Images/7a6d64ab6f662303234112d1c5cd0d36.png)

单击**确定**按钮后的屏幕

![第二屏](../Images/920382231d8306ac429e1f139679ceb1.png)

**在我的网络视图中单击“赞”按钮时，它会重定向到链接 facebook.com/connect/connect_to_external_page_reload.html。请帮帮我我该怎么办？**

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T13:45:33.373

我的猜测是，您加载 fb js sdk 的 web 视图没有 cookie，因此用户未通过身份验证。

你是如何验证用户的？是否使用 SSO（即，是否安装了 fb 应用程序？）如果是这种情况，则浏览器（webview）不知道用户已通过身份验证，当您单击它时，它只会尝试重定向您进行身份验证。

阅读新的官方博客文章：[为移动带来点赞](https://developers.facebook.com/blog/post/2012/06/20/bringing-like-to-mobile/)。

* * *

# 编辑

嗯，这看起来和我猜的一模一样。您会看到它说“注册以查看...”，这意味着 js sdk 无法识别用户已登录并经过身份验证。

您有两个我能想到的选择：
1\. 正如我所写，使用新`Like`操作并创建您自己的“点赞按钮”。
2.使用你从 android`FB.init`获得的参数调用传递参数时，将如下所示：`authResponse`

Java部分

```
m_cObjFacebook = new Facebook("Your_id");
m_cObjFacebook.authorize(this, m_cPermissions, new DialogListener() {
    @Override
    public void onComplete(Bundle values) {
        String response = m_cObjFacebook.request("me");
        JSONObject json = Util.parseJson(response);
        showWebView(json.getString("id"));
    }

    ....
});

private void showWebView(String userid) {
    mWebView = (WebView) findViewById(R.id.webview);
    mWebView.getSettings().setJavaScriptEnabled(true);
    mWebView.getSettings().setAppCacheEnabled(true);
    mWebView.getSettings().setJavaScriptCanOpenWindowsAutomatically(true);

    StringBuilder url = new StringBuilder("file:///android_asset/FacebookLikeView.html?");
    url.append("token=").append(cObjFacebook.getAccessToken());
    url.append("&expires=").append(cObjFacebook.getAccessExpires());
    url.append("&user=").append(userid);

    mWebView.loadUrl(url.toString());
} 
```

Html / Javascript 部分：

```
<script type="text/javascript">
    window.fbAsyncInit = function() {   
        var data = {},
            query = window.location.search.substring(1);

        query = query.split("&");
        for (var i = 0; i < query.length; i++) {
            var pair = query[i].split("=");
            data[pair[0]] = pair[1];
        }

        FB.init({
            appId: "YOUR_APP_ID",
            xfbml: true,
            authResponse: data
        });
    };

    // Load the SDK Asynchronously
    (function(d){
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    }(document));
</script>
<div class="fb-like" data-href="http://www.facebook.com/FacIntegra" data-send="false" data-width="450" data-show-faces="false" data-font="tahoma"></div> 
```

我不能 100% 确定这个技巧会奏效，因为其中一个参数`authResponse`是`signedRequest`你没有的，但值得一试。

* * *

# 第二次编辑

当设备上存在 facebook 应用程序（katana）时，使用它完成身份验证，这意味着不会创建默认浏览器上的 cookie，因此当您使用类似按钮打开 web 视图时，js sdk 不知道您是登录了，你可以把它想象成在firefox上登录facebook，然后在chrome上打开facebook，看到你没有登录。

当未安装 fb 应用程序时，sdk 使用带有 webview 的对话框对用户进行身份验证，该对话框创建稍后可由 js sdk 使用的 cookie，这就是它在这种情况下“按预期”工作的原因。

我在第一次编辑中为您提供的解决方法尝试在初始化时将身份验证数据传递给 sdk。
正如我当时写的那样，我不确定它是否会起作用，也许您还需要将签名请求传递给它，但是由于您没有它，因此您需要创建它，如果您想尝试就这样做与此处描述的完全相反：[Singed Request](http://developers.facebook.com/docs/authentication/signed_request/)，然后将其`FB.init`与访问令牌和过期参数一起传递给。

您拥有的另一个选择是始终使用对话框进行身份验证，因为阅读如下：[How to disable Facebook single sign on for android - Facebook-android-sdk](https://stackoverflow.com/questions/4521013/how-to-disable-facebook-single-sign-on-for-android-facebook-android-sdk)。
我建议不要使用这种方法，因为它会导致糟糕的用户体验，毕竟在移动设备上输入电子邮件和密码并不是一件有趣的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T06:42:52.707

我尝试了第一个选项，但在我的 android 应用程序中只能看到空白的 webview

# c# - 通过在具有嵌套对象的 DataTable 上绑定来减少 Ajax 数据占用？

> ID：11208430
> 
> 赞同：0
> 
> 时间：2012-06-26T13:31:00.717
> 
> 标签：c#, asp.net-mvc, telerik, telerik-grid, telerik-mvc

似乎有很多与绑定 DataTable 相关的问题，但我找不到与我的确切情况有关的问题。

我目前正在对如下对象列表进行 ajax 绑定：

```
public class MyObject
{
   public string Name { get; set; }
   public string Something1{ get; set; }
   public string Something2{ get; set; }
   public string Something3 { get; set; }
   public MyObjectMyObject2 { get; set; }
}

public class MyObject2
{
    public string Color { get; set; }
    public string Something4 { get; set; }
}

[GridAction]
public ActionResult GetData()
{
   var data = QueryDatabaseAndInstantiateAListOfMyObjects();

   return View(new GridModel(data));
} 
```

并有这样的看法：

```
<%= Html.Telerik().Grid<MyObject>()
        .DataBinding(dataBinding => dataBinding.Ajax().Select("GetData", new { action = "GetData" }))
        .Name("Grid1")
        .Columns(columns =>
        {
            columns.Bound(o => o.Name).Title("Name1");
            columns.Bound(o => o.MyObject2.Color).Title("Color");
            columns.Bound(o => o.Something1).Hidden(true);
            columns.Bound(o => o.Something2).Hidden(true);
            columns.Bound(o => o.Something3).Hidden(true);
            columns.Bound(o => o.MyObject.Something4).Hidden(true);
        })
%> 
```

这很好用，因为我能够对以上所有内容进行排序、分组。

我的情况是我在 MyObject 上有许多属性，并且出现了一些边缘情况，这些情况会产生几兆字节的响应数据。原因是有许多隐藏的列取决于情况，用户可以右键单击以显示。问题是，所有这些额外隐藏列的数据都包含在响应数据中，即使它们没有按说使用。既然分组、取消分组、显示和隐藏列的行为无论如何都会获取数据，为什么所有额外的数据都必须随之而来？

如果我只能返回填充可见列所必需的数据，再加上一些我可以用自定义属性以某种方式标记的数据，那将极大地有助于减少返回数据的大小。

因此，我开始将对象列表转换为 DataTable，然后我可以有条件地为其添加列 + 数据，然后将其提供给 GridModel。在尝试按嵌套对象（例如 o.MyObject2.Color）中的列进行分组之前，这一直很有效。我遇到了这个异常：

具有指定名称的属性：MyObject2.Color 在类型上找不到：System.Data.DataRowView

我想这是有道理的，但我该如何克服呢？当我使用 Object Shredder 时，它会将 MyObject 的每个属性设置为松散类型，例如将 ["Name"] 设置为字符串，将 ["MyObject2"] 设置为 MyObject2。但是 ["MyObject2"] 之后的所有内容都是强类型的：(dataRow["MyObject2"] as MyObject2).Color。这就是我无法理解的地方。

有没有另一种方法来克服我最初发送的所有未使用的额外数据的问题？或者，对 DataTable 位有什么建议吗？我也尝试过将 DataTable 转换为 IEnumerable ，但没​​有这样的运气。序列化的 Json 是相当空的。我也尝试过展平所有嵌套对象，例如将 datarow["MyObject2.Color"] 作为字符串，但是在 JavaScript 中引用此列时会造成严重破坏，因此我不得不使用下划线分隔符 ["MyObject2_Color"] 但这确实搞砸了 UI 中的绑定列。一定有办法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:37:07.773

我看不出有任何理由带回你的全部对象只是为了展示`Color`和`Something4`。试着把它弄平。像这样的东西，您只需将值分配给模型`Color`的`Something4`属性。

```
public class MyObject
{
   public string Name { get; set; }
   public string Something1{ get; set; }
   public string Something2{ get; set; }
   public string Something3 { get; set; }
   public string Something4 { get; set; }
   public string Color { get; set; }
}

[GridAction]
public ActionResult GetData()
{
   var data = QueryDatabaseAndInstantiateAListOfMyObjects();
   data.Something4 = MyObject2.Something4;
   data.Color = MyObject2.Color;
   return View(new GridModel(data));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:52:37.987

这是真正的答案，但我将这个想法归功于 Alfalfa。

我继续使用 DataTable 的想法，但使用 getter 来公开每个嵌套对象属性。它有点复杂和脆弱，但它有效！

```
public class MyObject
{
   public string Name { get; set; }
   public string Something1{ get; set; }
   public string Something2{ get; set; }
   public string Something3 { get; set; }
   [ScriptIgnore()]
   public MyObjectMyObject2 { get; set; }

   public string Color { get { return this.MyObject2.Color; } }
   public string Something4 { get { return this.MyObject2.Something4; } }
}

public class MyObject2
{
    public string Color { get; set; }
    public string Something4 { get; set; }
} 
```

# ruby - Parsexml 成 ruby 对象并保存

> ID：11208432
> 
> 赞同：0
> 
> 时间：2012-06-26T13:31:05.800
> 
> 标签：ruby, xml, parsing, mongoid

我在 ruby​​ 中使用快乐映射器进行对象映射，然后解析我从 api 获得的 .xml 文件中的 xml 数据。

我在 api 响应中得到一个 zip 文件并将其解压缩以获取 5-6 个具有相同 xml 数据格式的文件。每个文件中的数据约为 2-3 mb。

我想将这些数据保存在文件中，记住我应该能够对其执行搜索操作。我不想使用关系数据库，而是希望将数据保存在文件中。保存数据的更好方法应该是什么，这对于以后对该数据执行的搜索操作来说足够有效。

```
require 'json'
require 'happymapper'

file_contents = File.read('/home/GhostRider/x.xml')    

  class Message
    include HappyMapper

    tag 'Message'
    element :color, String, :tag => 'Colour'
    element :bg_color, String, :tag => 'BgColour'

  end

  class Status
    include HappyMapper

    tag 'Status'
    element :text, String, :tag => 'Text'
    element :color, String, :tag => 'Colour'
    element :bg_color, String, :tag => 'BgColour'

    has_one :message, Message

  end

  class Line
    include HappyMapper

    tag 'Line' # if you put class in module you need tag
    element :name, String, :tag => 'Name'
    element :color, String, :tag => 'Colour'
    element :bg_color, String, :tag => 'BgColour'
    element :url, String, :tag => 'Url'

    has_one :status, Status

  end

  class Lines
    include HappyMapper

    tag 'Lines' # if you put class in module you need tag

    has_many :lines, Line
  end

item = Lines.parse(file_contents, :single => true)

item.lines.each do |i|

  puts i.name, i.color, i.url, i.status.text, i.status.message.color
end 
```

我需要保存获得的这些数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T17:23:02.863

更好的方法是使用 xml 选择器（如 nokogiri 或 xml simple 或来自 rails 的默认 Hash.to_xml（xml 文件））解析 xml。然后分别定义 ruby​​ 类，这有助于更好地控制类并执行操作。

# php - 事件发生时获取元素位置的当前页面 url 并将该 url 输出到另一个页面

> ID：11208440
> 
> 赞同：0
> 
> 时间：2012-06-26T13:31:28.700
> 
> 标签：php, javascript, jquery, html

我有一个下载按钮，可以免费下载。

```
<input type="button" name="btn" value="Download"/> 
```

现在我也有这个显示页面当前 url 的 php 代码。

```
<?php
$url="http://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];
echo $url;
?> 
```

最后是下载页面... downloadbutton.php 我的问题是，我如何将它们合并在一起，以便无论我放置下载按钮的哪个网站，它都会在单击时回显下载按钮所在的当前网站的 url。我希望在 downloadbutton.php 中回显 url

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:34:50.160

以这种方式给它：

```
<input type="button" name="btn" value="Download" onclick="location.href='<?php echo "http://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']; ?>'" /> 
```

这将重定向到当前下载页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:35:00.900

你的意思是推荐人。这很简单：

`echo $_SERVER['HTTP_REFERER']`

要重定向它是这样的：

`<input type="button" name="btn" value="Download" onlick="document.location=<? echo $url ?>">`

# c# - 空 == 对象与对象 == 空

> ID：11208443
> 
> 赞同：1
> 
> 时间：2012-06-26T13:31:34.560
> 
> 标签：c#

> **可能重复：**
> [将空值与对象进行比较而不是将对象与空值进行比较有什么问题](https://stackoverflow.com/questions/10244682/what-is-wrong-in-comparing-a-null-with-an-object-rather-than-an-object-with-a-nu)

我看到一些开发人员在 C# 中使用以下空对象检查：

```
if (null == myObject)
{

} 
```

而不是：

```
if (myObject == null)
{

} 
```

我更喜欢第二个陈述，因为它（对我来说）从左到右自然地阅读。

有什么理由为什么会使用第一个？有任何性能优势，还是纯粹的味道？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-26T13:32:50.447

有些人（主要是 C 开发人员）更喜欢第一种方式，因为如果您忘记了一个`=`符号，代码将无法在 C 中编译。

例如，当我忘记一个时`=`；

```
int a = 0;

if(a=1) //Accidental assignment, luckily the C# compiler warns us for this. The C compiler wouldnt.
{

}    
if(1=a) // This is not logical, and not valid in either C# or C.
{

} 
```

然而，正如 Jamietre 指出的那样，与 C 不同，它在 C# 中将 int 隐式转换为布尔值是无效的。编译器仍然会产生错误。但是，当您像这样比较布尔值时，它会起作用：`if(a == true)`. 然而，这本身就很奇怪，因为您可以（并且在我看来应该）省略`== true`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:32:44.427

纯味。他们都将返回完全相同的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:32:31.643

味道纯正，与昏迷、括号等相同。

# java - Java - 公共字符串（字符 [] 值）

> ID：11208444
> 
> 赞同：3
> 
> 时间：2012-06-26T13:31:43.577
> 
> 标签：java, string

我的问题是关于：[Public String(char[] value)](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#String%28char%5B%5D%29)。任何人都可以帮助我：它是否在每个 value[i] 内部循环。具体来说，

Public String(char[] value) 是否意味着：

```
for each char[i]
returnedSTRING = returnedSTRING + char[i] 
```

或不 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T13:38:57.190

Java 是开源的，如果您将源代码附加到 Eclipse，您可以随时使用 F3 来检查功能。在这种情况下，String 类具有以下构造函数，这是您正在寻找的：

```
/**
 * Allocates a new {@code String} so that it represents the sequence of
 * characters currently contained in the character array argument. The
 * contents of the character array are copied; subsequent modification of
 * the character array does not affect the newly created string.
 *
 * @param  value
 *         The initial value of the string
 */
public String(char value[]) {
    int size = value.length;
    this.offset = 0;
    this.count = size;
    this.value = Arrays.copyOf(value, size);
} 
```

编辑：如果您想知道，[Arrays.copyOf](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#copyOf%28char%5B%5D,%20int%29)调用[System.arraycopy](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:36:34.600

字符串对象在内部将所有字符串字符保存在`char[]`数组中。此构造函数只是将整个数组复制到内部表示。查看来源：

```
public String(char value[]) {
        int size = value.length;
        this.offset = 0;
        this.count = size;
        this.value = Arrays.copyOf(value, size);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T13:39:05.040

从文档：

> 分配一个新的 String 以便它表示当前包含在字符数组参数中的字符序列。字符数组的内容被复制；随后对字符数组的修改不会影响新创建的字符串。

*字符数组的内容被复制。* 根据源代码，就像 mishadoff 指出的那样，`Arrays.copyOf(value, size)`被使用。但是， `Arrays.copyOf(value, size)`调用`System.arraycopy`反过来实际上并不迭代和分配，而是实际复制内存，类似于`memcpy()`调用在 C/C++ 中所做的事情。这是由 Java 在内部完成的，因为它比普通循环快得多。`System.arraycopy`是一种利用主机操作系统的内存管理功能的*本机方法。*

因此，要回答您的问题，**字符不会在 for 中迭代，而是它们所在的整个内存块被 Java“批量”复制**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T13:36:29.217

参见[String 类源代码](http://www.docjar.com/html/api/java/lang/String.java.html)

但是，它可能会因 Java 的版本而异。

# backbone.js - Backbone.js 仅创建第一个模型，然后在使用 Google 日历解析时将其余模型返回为未定义

> ID：11208445
> 
> 赞同：4
> 
> 时间：2012-06-26T13:31:50.183
> 
> 标签：backbone.js, google-calendar-api

使用 Backbone 从 Google 日历中提取日历事件时遇到一些问题。

当我打电话`collection.fetch()`时，当 json 中有 13 个对象时，我只返回 1 的长度。

我查看了`parse:function(response)`我在 Collection 中重写的方法，它返回了所有 13 个对象。我查看了backbone.js 中的add 方法，问题似乎出现在第591 行：

```
models = _.isArray(models) ? models.slice() : [models]; 
```

当我用 console.log 换行来检查模型变量的状态时：

```
console.log(models);
models = _.isArray(models) ? models.slice() : [models];
console.log(models); 
```

我得到以下结果：

```
[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object] backbone.js:590
[child,undefined × 12] 
```

我不知道为什么它会在添加时失败。我通过更改`parse:function(response)`集合中的方法以返回每个对象来检查每个模型，它工作正常。：

```
parse: function(response) {
  return response.feed.entry[5];
} 
```

我之前已经使用 Backbone.js 成功解析了 Google 日历提要，所以我担心我错过了一些非常简单的东西。

如果我`console.log` `response.feed`返回以下内容：

![控制台转储的屏幕截图](../Images/cd117d1294bbf0bf4e2c4631df42c576.png)

这是完整的课程：

```
/**
* Backbone
* @class
*/

var Gigs = Gigs || {};

Gigs.Backbone = {}

Gigs.Backbone.Model = Backbone.Model.extend();

Gigs.Backbone.Collection = Backbone.Collection.extend({
  model: Gigs.Backbone.Model,
  url: 'http://www.google.com/calendar/feeds/email@email.com/public/full?alt=json-in-script&orderby=starttime&callback=?',
  sync: function(method, model, options) {
    options.dataType = "jsonp";
    return Backbone.sync(method, model, options);
  },
  parse: function(response) {
    return response.feed.entry;
  }
});

Gigs.Backbone.Controller = Backbone.View.extend({
  initialize: function() {
    var self = this;

    this.collection = new Gigs.Backbone.Collection();
    this.collection.on('reset', this.addElements, this);

    this.collection.fetch();
  },

  addElements: function() {
    log(this.collection);
  }

});

var backbone = new Gigs.Backbone.Controller(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T15:12:57.420

^(显然，谷歌日历为其条目提供了一个包含在对象1)中的 id ：

```
"id":{
    "$t":"http://www.google.com/calendar/feeds/..."
} 
```

骨干似乎不喜欢。很多。

一种简单的解决方案是在 parse 方法中覆盖 id ：

```
parse: function(response) {
    var entries=[];

    _.each(response.feed.entry, function(entry,ix) {
        entry.id=entry.id.$t;
        entries.push(entry);
    });

    return entries;
} 
```

还有一个小提琴[http://jsfiddle.net/bqzkT/](http://jsfiddle.net/bqzkT/)

¹检查[https://developers.google.com/gdata/docs/json](https://developers.google.com/gdata/docs/json)以了解 Google 如何将其 XML 数据转换为 JSON。

* * *

**编辑**：问题来自于通过`alt=json-in-script`将属性包装在对象中的直接 XML 到 JSON 转换（通过参数请求）返回数据的方式。更改此参数以`alt=jsonc`生成更简单的 JSON 表示。将[jsonc 输出](http://www.google.com/calendar/feeds/developer-calendar@google.com/public/full?alt=jsonc&orderby=starttime)与[等效的 json-in-script](http://www.google.com/calendar/feeds/developer-calendar@google.com/public/full?alt=json-in-script&orderby=starttime)进行比较。

有关更多信息，请参阅[https://developers.google.com/youtube/2.0/developers_guide_jsonc#Comparing_JSON_and_JSONC](https://developers.google.com/youtube/2.0/developers_guide_jsonc#Comparing_JSON_and_JSONC)

# c# - 生成集合的排列（最有效）

> ID：11208446
> 
> 赞同：75
> 
> 时间：2012-06-26T13:31:59.047
> 
> 标签：c#, performance, algorithm, optimization, permutation

我想生成集合（集合）的所有排列，如下所示：

```
Collection: 1, 2, 3
Permutations: {1, 2, 3}
              {1, 3, 2}
              {2, 1, 3}
              {2, 3, 1}
              {3, 1, 2}
              {3, 2, 1} 
```

一般来说，这不是“如何”的问题，而是关于如何最有效的问题。另外，我不想生成所有排列并返回它们，而是一次只生成一个排列，并且仅在必要时继续（很像迭代器 - 我也尝试过，但结果更少高效的）。

我测试了许多算法和方法，并提出了这段代码，这是我尝试过的最有效的代码：

```
public static bool NextPermutation<T>(T[] elements) where T : IComparable<T>
{
    // More efficient to have a variable instead of accessing a property
    var count = elements.Length;

    // Indicates whether this is the last lexicographic permutation
    var done = true;

    // Go through the array from last to first
    for (var i = count - 1; i > 0; i--)
    {
        var curr = elements[i];

        // Check if the current element is less than the one before it
        if (curr.CompareTo(elements[i - 1]) < 0)
        {
            continue;
        }

        // An element bigger than the one before it has been found,
        // so this isn't the last lexicographic permutation.
        done = false;

        // Save the previous (bigger) element in a variable for more efficiency.
        var prev = elements[i - 1];

        // Have a variable to hold the index of the element to swap
        // with the previous element (the to-swap element would be
        // the smallest element that comes after the previous element
        // and is bigger than the previous element), initializing it
        // as the current index of the current item (curr).
        var currIndex = i;

        // Go through the array from the element after the current one to last
        for (var j = i + 1; j < count; j++)
        {
            // Save into variable for more efficiency
            var tmp = elements[j];

            // Check if tmp suits the "next swap" conditions:
            // Smallest, but bigger than the "prev" element
            if (tmp.CompareTo(curr) < 0 && tmp.CompareTo(prev) > 0)
            {
                curr = tmp;
                currIndex = j;
            }
        }

        // Swap the "prev" with the new "curr" (the swap-with element)
        elements[currIndex] = prev;
        elements[i - 1] = curr;

        // Reverse the order of the tail, in order to reset it's lexicographic order
        for (var j = count - 1; j > i; j--, i++)
        {
            var tmp = elements[j];
            elements[j] = elements[i];
            elements[i] = tmp;
        }

        // Break since we have got the next permutation
        // The reason to have all the logic inside the loop is
        // to prevent the need of an extra variable indicating "i" when
        // the next needed swap is found (moving "i" outside the loop is a
        // bad practice, and isn't very readable, so I preferred not doing
        // that as well).
        break;
    }

    // Return whether this has been the last lexicographic permutation.
    return done;
} 
```

它的用法是发送一个元素数组，并返回一个布尔值，指示这是否是最后一个字典排列，以及将数组更改为下一个排列。

使用示例：

```
var arr = new[] {1, 2, 3};

PrintArray(arr);

while (!NextPermutation(arr))
{
    PrintArray(arr);
} 
```

问题是我对代码的速度不满意。

遍历大小为 11 的数组的所有排列大约需要 4 秒。虽然它可以被认为是令人印象深刻的，因为一组大小为 11 的可能排列的数量`11!`接近 4000 万。

从逻辑上讲，对于大小为 12 的数组，它将花费大约 12 倍的时间，因为`12!`is `11! * 12`，对于大小为 13 的数组，它将花费大约 13 倍于大小为 12 的时间，依此类推。

所以你可以很容易地理解一个大小为 12 或更大的数组，它确实需要很长时间才能完成所有排列。

而且我有一种强烈的预感，我可以以某种方式将时间缩短很多（无需切换到 C# 以外的语言 - 因为编译器优化确实可以很好地优化，我怀疑我可以在汇编中手动优化）。

有谁知道任何其他方法可以更快地完成这项工作？您对如何使当前算法更快有任何想法吗？

请注意，我不想使用外部库或服务来做到这一点 - 我希望拥有代码本身，并且我希望它尽可能高效。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-26T13:37:04.030

这可能是您正在寻找的。

```
 private static bool NextPermutation(int[] numList)
    {
        /*
         Knuths
         1\. Find the largest index j such that a[j] < a[j + 1]. If no such index exists, the permutation is the last permutation.
         2\. Find the largest index l such that a[j] < a[l]. Since j + 1 is such an index, l is well defined and satisfies j < l.
         3\. Swap a[j] with a[l].
         4\. Reverse the sequence from a[j + 1] up to and including the final element a[n].

         */
        var largestIndex = -1;
        for (var i = numList.Length - 2; i >= 0; i--)
        {
            if (numList[i] < numList[i + 1]) {
                largestIndex = i;
                break;
            }
        }

        if (largestIndex < 0) return false;

        var largestIndex2 = -1;
        for (var i = numList.Length - 1 ; i >= 0; i--) {
            if (numList[largestIndex] < numList[i]) {
                largestIndex2 = i;
                break;
            }
        }

        var tmp = numList[largestIndex];
        numList[largestIndex] = numList[largestIndex2];
        numList[largestIndex2] = tmp;

        for (int i = largestIndex + 1, j = numList.Length - 1; i < j; i++, j--) {
            tmp = numList[i];
            numList[i] = numList[j];
            numList[j] = tmp;
        }

        return true;
    } 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2016-04-14T22:13:18.383

> 2018 年 5 月 28 日更新：
> 
> *   下面提供了一个新的多线程版本（更快）作为另一个答案。
> *   还有一篇关于排列的文章：[排列：快速实现和允许多线程的新索引算法](https://www.codeproject.com/Articles/1250925/Permutations-Fast-implementations-and-a-new-indexi)

有点晚了……

根据最近的测试（2018-05-22 更新）

*   最快的是我的，但不是按字典顺序
*   对于最快的词典顺序，Sani Singh Huttunen 解决方案似乎是要走的路。

在我的机器上发布的 10 个项目（10 个！）的性能测试结果（毫秒）：

*   欧莱特 : 29
*   简单变量：95
*   埃雷兹·罗宾逊：156
*   萨尼·辛格·胡图宁：37
*   彭阳：45047

在我的机器上发布的 13 个项目（13 个！）的性能测试结果（秒）：

*   欧莱特：48.437
*   简单变量：159.869
*   埃雷兹·罗宾逊：327.781
*   萨尼辛格胡图宁：64.839

* * *

我的解决方案的优点：

*   堆算法（每个排列的单交换）
*   没有乘法（就像网上看到的一些实现）
*   内联交换
*   通用的
*   没有不安全的代码
*   就地（非常低的内存使用）
*   无模（仅第一位比较）

我对[堆算法的实现](https://en.wikipedia.org/wiki/Heap%27s_algorithm)：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Runtime.CompilerServices;

namespace WpfPermutations
{
    /// <summary>
    /// EO: 2016-04-14
    /// Generator of all permutations of an array of anything.
    /// Base on Heap's Algorithm. See: https://en.wikipedia.org/wiki/Heap%27s_algorithm#cite_note-3
    /// </summary>
    public static class Permutations
    {
        /// <summary>
        /// Heap's algorithm to find all pmermutations. Non recursive, more efficient.
        /// </summary>
        /// <param name="items">Items to permute in each possible ways</param>
        /// <param name="funcExecuteAndTellIfShouldStop"></param>
        /// <returns>Return true if cancelled</returns> 
        public static bool ForAllPermutation<T>(T[] items, Func<T[], bool> funcExecuteAndTellIfShouldStop)
        {
            int countOfItem = items.Length;

            if (countOfItem <= 1)
            {
                return funcExecuteAndTellIfShouldStop(items);
            }

            var indexes = new int[countOfItem];

            // Unecessary. Thanks to NetManage for the advise
            // for (int i = 0; i < countOfItem; i++)
            // {
            //     indexes[i] = 0;
            // }

            if (funcExecuteAndTellIfShouldStop(items))
            {
                return true;
            }

            for (int i = 1; i < countOfItem;)
            {
                if (indexes[i] < i)
                { // On the web there is an implementation with a multiplication which should be less efficient.
                    if ((i & 1) == 1) // if (i % 2 == 1)  ... more efficient ??? At least the same.
                    {
                        Swap(ref items[i], ref items[indexes[i]]);
                    }
                    else
                    {
                        Swap(ref items[i], ref items[0]);
                    }

                    if (funcExecuteAndTellIfShouldStop(items))
                    {
                        return true;
                    }

                    indexes[i]++;
                    i = 1;
                }
                else
                {
                    indexes[i++] = 0;
                }
            }

            return false;
        }

        /// <summary>
        /// This function is to show a linq way but is far less efficient
        /// From: StackOverflow user: Pengyang : http://stackoverflow.com/questions/756055/listing-all-permutations-of-a-string-integer
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="list"></param>
        /// <param name="length"></param>
        /// <returns></returns>
        static IEnumerable<IEnumerable<T>> GetPermutations<T>(IEnumerable<T> list, int length)
        {
            if (length == 1) return list.Select(t => new T[] { t });

            return GetPermutations(list, length - 1)
                .SelectMany(t => list.Where(e => !t.Contains(e)),
                    (t1, t2) => t1.Concat(new T[] { t2 }));
        }

        /// <summary>
        /// Swap 2 elements of same type
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="a"></param>
        /// <param name="b"></param>
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        static void Swap<T>(ref T a, ref T b)
        {
            T temp = a;
            a = b;
            b = temp;
        }

        /// <summary>
        /// Func to show how to call. It does a little test for an array of 4 items.
        /// </summary>
        public static void Test()
        {
            ForAllPermutation("123".ToCharArray(), (vals) =>
            {
                Console.WriteLine(String.Join("", vals));
                return false;
            });

            int[] values = new int[] { 0, 1, 2, 4 };

            Console.WriteLine("Ouellet heap's algorithm implementation");
            ForAllPermutation(values, (vals) =>
            {
                Console.WriteLine(String.Join("", vals));
                return false;
            });

            Console.WriteLine("Linq algorithm");
            foreach (var v in GetPermutations(values, values.Length))
            {
                Console.WriteLine(String.Join("", v));
            }

            // Performance Heap's against Linq version : huge differences
            int count = 0;

            values = new int[10];
            for (int n = 0; n < values.Length; n++)
            {
                values[n] = n;
            }

            Stopwatch stopWatch = new Stopwatch();

            ForAllPermutation(values, (vals) =>
            {
                foreach (var v in vals)
                {
                    count++;
                }
                return false;
            });

            stopWatch.Stop();
            Console.WriteLine($"Ouellet heap's algorithm implementation {count} items in {stopWatch.ElapsedMilliseconds} millisecs");

            count = 0;
            stopWatch.Reset();
            stopWatch.Start();

            foreach (var vals in GetPermutations(values, values.Length))
            {
                foreach (var v in vals)
                {
                    count++;
                }
            }

            stopWatch.Stop();
            Console.WriteLine($"Linq {count} items in {stopWatch.ElapsedMilliseconds} millisecs");
        }
    }
} 
```

这是我的测试代码：

```
Task.Run(() =>
            {

                int[] values = new int[12];
                for (int n = 0; n < values.Length; n++)
                {
                    values[n] = n;
                }

                // Eric Ouellet Algorithm
                int count = 0;
                var stopwatch = new Stopwatch();
                stopwatch.Reset();
                stopwatch.Start();
                Permutations.ForAllPermutation(values, (vals) =>
                {
                    foreach (var v in vals)
                    {
                        count++;
                    }
                    return false;
                });
                stopwatch.Stop();
                Console.WriteLine($"This {count} items in {stopwatch.ElapsedMilliseconds} millisecs");

                // Simple Plan Algorithm
                count = 0;
                stopwatch.Reset();
                stopwatch.Start();
                PermutationsSimpleVar permutations2 = new PermutationsSimpleVar();
                permutations2.Permutate(1, values.Length, (int[] vals) =>
                {
                    foreach (var v in vals)
                    {
                        count++;
                    }
                });
                stopwatch.Stop();
                Console.WriteLine($"Simple Plan {count} items in {stopwatch.ElapsedMilliseconds} millisecs");

                // ErezRobinson Algorithm
                count = 0;
                stopwatch.Reset();
                stopwatch.Start();
                foreach(var vals in PermutationsErezRobinson.QuickPerm(values))
                {
                    foreach (var v in vals)
                    {
                        count++;
                    }
                };
                stopwatch.Stop();
                Console.WriteLine($"Erez Robinson {count} items in {stopwatch.ElapsedMilliseconds} millisecs");
            }); 
```

使用示例：

```
ForAllPermutation("123".ToCharArray(), (vals) =>
    {
        Console.WriteLine(String.Join("", vals));
        return false;
    });

int[] values = new int[] { 0, 1, 2, 4 };
ForAllPermutation(values, (vals) =>
        {
            Console.WriteLine(String.Join("", vals));
            return false;
        }); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-06-26T18:23:53.190

好吧，如果你可以用 C 语言处理它，然后翻译成你选择的语言，你真的不能比这快得多，因为时间将由以下因素支配`print`：

```
void perm(char* s, int n, int i){
  if (i >= n-1) print(s);
  else {
    perm(s, n, i+1);
    for (int j = i+1; j<n; j++){
      swap(s[i], s[j]);
      perm(s, n, i+1);
      swap(s[i], s[j]);
    }
  }
}

perm("ABC", 3, 0); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-26T13:49:24.013

我所知道的最快的置换算法是 QuickPerm 算法。
这是实现，它使用 yield return 因此您可以根据需要一次迭代一个。

**代码：**

```
public static IEnumerable<IEnumerable<T>> QuickPerm<T>(this IEnumerable<T> set)
    {
        int N = set.Count();
        int[] a = new int[N];
        int[] p = new int[N];

        var yieldRet = new T[N];

        List<T> list = new List<T>(set);

        int i, j, tmp; // Upper Index i; Lower Index j

        for (i = 0; i < N; i++)
        {
            // initialize arrays; a[N] can be any type
            a[i] = i + 1; // a[i] value is not revealed and can be arbitrary
            p[i] = 0; // p[i] == i controls iteration and index boundaries for i
        }
        yield return list;
        //display(a, 0, 0);   // remove comment to display array a[]
        i = 1; // setup first swap points to be 1 and 0 respectively (i & j)
        while (i < N)
        {
            if (p[i] < i)
            {
                j = i%2*p[i]; // IF i is odd then j = p[i] otherwise j = 0
                tmp = a[j]; // swap(a[j], a[i])
                a[j] = a[i];
                a[i] = tmp;

                //MAIN!

                for (int x = 0; x < N; x++)
                {
                    yieldRet[x] = list[a[x]-1];
                }
                yield return yieldRet;
                //display(a, j, i); // remove comment to display target array a[]

                // MAIN!

                p[i]++; // increase index "weight" for i by one
                i = 1; // reset index i to 1 (assumed)
            }
            else
            {
                // otherwise p[i] == i
                p[i] = 0; // reset p[i] to zero
                i++; // set new index value for i (increase by one)
            } // if (p[i] < i)
        } // while(i < N)
    } 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-05-28T15:32:49.500

2018-05-28更新，新版本，最快...（多线程）

[![在此处输入图像描述](../Images/2848d1b5a6bf8e75d15abccdcf6cc66b.png)](https://i.stack.imgur.com/FgJqj.png)

```
 Time taken for fastest algorithms 
```

需要：Sani Singh Huttunen（最快的词典）解决方案和我的支持索引的新 OuelletLexico3

索引有两个主要优点：

*   允许直接获得任何人的排列
*   允许多线程（源自第一个优势）

文章：[排列：快速实现和允许多线程的新索引算法](https://www.codeproject.com/Articles/1250925/Permutations-Fast-implementations-and-a-new-indexi)

在我的机器上（6 个超线程内核：12 个线程）Xeon E5-1660 0 @ 3.30Ghz，测试运行 13 个空东西的算法！项目（以毫秒为单位的时间）：

*   53071：Ouellet（堆的实现）
*   65366：Sani Singh Huttunen（最快的词汇）
*   11377：混合 OuelletLexico3 - Sani Singh Huttunen

附注：如果它们的使用是修改（读/写），则在线程之间使用共享属性/变量进行排列操作将强烈影响性能。这样做会在线程之间产生“[错误共享”。](https://software.intel.com/en-us/articles/avoiding-and-identifying-false-sharing-among-threads)您将无法获得预期的性能。我在测试时遇到了这种行为。当我尝试增加置换总数的全局变量时，我的经验显示出问题。

用法：

```
PermutationMixOuelletSaniSinghHuttunen.ExecuteForEachPermutationMT(
  new int[] {1, 2, 3, 4}, 
  p => 
    { 
      Console.WriteLine($"Values: {p[0]}, {p[1]}, p[2]}, {p[3]}"); 
    }); 
```

代码：

```
using System;
using System.Runtime.CompilerServices;

namespace WpfPermutations
{
    public class Factorial
    {
        // ************************************************************************
        protected static long[] FactorialTable = new long[21];

        // ************************************************************************
        static Factorial()
        {
            FactorialTable[0] = 1; // To prevent divide by 0
            long f = 1;
            for (int i = 1; i <= 20; i++)
            {
                f = f * i;
                FactorialTable[i] = f;
            }
        }

        // ************************************************************************
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public static long GetFactorial(int val) // a long can only support up to 20!
        {
            if (val > 20)
            {
                throw new OverflowException($"{nameof(Factorial)} only support a factorial value <= 20");
            }

            return FactorialTable[val];
        }

        // ************************************************************************

    }
}

namespace WpfPermutations
{
    public class PermutationSaniSinghHuttunen
    {
        public static bool NextPermutation(int[] numList)
        {
            /*
             Knuths
             1\. Find the largest index j such that a[j] < a[j + 1]. If no such index exists, the permutation is the last permutation.
             2\. Find the largest index l such that a[j] < a[l]. Since j + 1 is such an index, l is well defined and satisfies j < l.
             3\. Swap a[j] with a[l].
             4\. Reverse the sequence from a[j + 1] up to and including the final element a[n].

             */
            var largestIndex = -1;
            for (var i = numList.Length - 2; i >= 0; i--)
            {
                if (numList[i] < numList[i + 1])
                {
                    largestIndex = i;
                    break;
                }
            }

            if (largestIndex < 0) return false;

            var largestIndex2 = -1;
            for (var i = numList.Length - 1; i >= 0; i--)
            {
                if (numList[largestIndex] < numList[i])
                {
                    largestIndex2 = i;
                    break;
                }
            }

            var tmp = numList[largestIndex];
            numList[largestIndex] = numList[largestIndex2];
            numList[largestIndex2] = tmp;

            for (int i = largestIndex + 1, j = numList.Length - 1; i < j; i++, j--)
            {
                tmp = numList[i];
                numList[i] = numList[j];
                numList[j] = tmp;
            }

            return true;
        }
    }
}

using System;

namespace WpfPermutations
{
    public class PermutationOuelletLexico3<T> // Enable indexing 
    {
        // ************************************************************************
        private T[] _sortedValues;

        private bool[] _valueUsed;

        public readonly long MaxIndex; // long to support 20! or less 

        // ************************************************************************
        public PermutationOuelletLexico3(T[] sortedValues)
        {
            _sortedValues = sortedValues;
            Result = new T[_sortedValues.Length];
            _valueUsed = new bool[_sortedValues.Length];

            MaxIndex = Factorial.GetFactorial(_sortedValues.Length);
        }

        // ************************************************************************
        public T[] Result { get; private set; }

        // ************************************************************************
        /// <summary>
        /// Sort Index is 0 based and should be less than MaxIndex. Otherwise you get an exception.
        /// </summary>
        /// <param name="sortIndex"></param>
        /// <param name="result">Value is not used as inpu, only as output. Re-use buffer in order to save memory</param>
        /// <returns></returns>
        public void GetSortedValuesFor(long sortIndex)
        {
            int size = _sortedValues.Length;

            if (sortIndex < 0)
            {
                throw new ArgumentException("sortIndex should greater or equal to 0.");
            }

            if (sortIndex >= MaxIndex)
            {
                throw new ArgumentException("sortIndex should less than factorial(the lenght of items)");
            }

            for (int n = 0; n < _valueUsed.Length; n++)
            {
                _valueUsed[n] = false;
            }

            long factorielLower = MaxIndex;

            for (int index = 0; index < size; index++)
            {
                long factorielBigger = factorielLower;
                factorielLower = Factorial.GetFactorial(size - index - 1);  //  factorielBigger / inverseIndex;

                int resultItemIndex = (int)(sortIndex % factorielBigger / factorielLower);

                int correctedResultItemIndex = 0;
                for(;;)
                {
                    if (! _valueUsed[correctedResultItemIndex])
                    {
                        resultItemIndex--;
                        if (resultItemIndex < 0)
                        {
                            break;
                        }
                    }
                    correctedResultItemIndex++;
                }

                Result[index] = _sortedValues[correctedResultItemIndex];
                _valueUsed[correctedResultItemIndex] = true;
            }
        }

        // ************************************************************************
    }
}

using System;
using System.Collections.Generic;
using System.Threading.Tasks;

namespace WpfPermutations
{
    public class PermutationMixOuelletSaniSinghHuttunen
    {
        // ************************************************************************
        private long _indexFirst;
        private long _indexLastExclusive;
        private int[] _sortedValues;

        // ************************************************************************
        public PermutationMixOuelletSaniSinghHuttunen(int[] sortedValues, long indexFirst = -1, long indexLastExclusive = -1)
        {
            if (indexFirst == -1)
            {
                indexFirst = 0;
            }

            if (indexLastExclusive == -1)
            {
                indexLastExclusive = Factorial.GetFactorial(sortedValues.Length);
            }

            if (indexFirst >= indexLastExclusive)
            {
                throw new ArgumentException($"{nameof(indexFirst)} should be less than {nameof(indexLastExclusive)}");
            }

            _indexFirst = indexFirst;
            _indexLastExclusive = indexLastExclusive;
            _sortedValues = sortedValues;
        }

        // ************************************************************************
        public void ExecuteForEachPermutation(Action<int[]> action)
        {
            //          Console.WriteLine($"Thread {System.Threading.Thread.CurrentThread.ManagedThreadId} started: {_indexFirst} {_indexLastExclusive}");

            long index = _indexFirst;

            PermutationOuelletLexico3<int> permutationOuellet = new PermutationOuelletLexico3<int>(_sortedValues);

            permutationOuellet.GetSortedValuesFor(index);
            action(permutationOuellet.Result);
            index++;

            int[] values = permutationOuellet.Result;
            while (index < _indexLastExclusive)
            {
                PermutationSaniSinghHuttunen.NextPermutation(values);
                action(values);
                index++;
            }

            //          Console.WriteLine($"Thread {System.Threading.Thread.CurrentThread.ManagedThreadId} ended: {DateTime.Now.ToString("yyyyMMdd_HHmmss_ffffff")}");
        }

        // ************************************************************************
        public static void ExecuteForEachPermutationMT(int[] sortedValues, Action<int[]> action)
        {
            int coreCount = Environment.ProcessorCount; // Hyper treading are taken into account (ex: on a 4 cores hyperthreaded = 8)
            long itemsFactorial = Factorial.GetFactorial(sortedValues.Length);
            long partCount = (long)Math.Ceiling((double)itemsFactorial / (double)coreCount);
            long startIndex = 0;

            var tasks = new List<Task>();

            for (int coreIndex = 0; coreIndex < coreCount; coreIndex++)
            {
                long stopIndex = Math.Min(startIndex + partCount, itemsFactorial);

                PermutationMixOuelletSaniSinghHuttunen mix = new PermutationMixOuelletSaniSinghHuttunen(sortedValues, startIndex, stopIndex);
                Task task = Task.Run(() => mix.ExecuteForEachPermutation(action));
                tasks.Add(task);

                if (stopIndex == itemsFactorial)
                {
                    break;
                }

                startIndex = startIndex + partCount;
            }

            Task.WaitAll(tasks.ToArray());
        }

        // ************************************************************************

    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-07-20T15:34:21.253

**这是我最终得到的最快的实现：**

```
public class Permutations
{
    private readonly Mutex _mutex = new Mutex();

    private Action<int[]> _action;
    private Action<IntPtr> _actionUnsafe;
    private unsafe int* _arr;
    private IntPtr _arrIntPtr;
    private unsafe int* _last;
    private unsafe int* _lastPrev;
    private unsafe int* _lastPrevPrev;

    public int Size { get; private set; }

    public bool IsRunning()
    {
        return this._mutex.SafeWaitHandle.IsClosed;
    }

    public bool Permutate(int start, int count, Action<int[]> action, bool async = false)
    {
        return this.Permutate(start, count, action, null, async);
    }

    public bool Permutate(int start, int count, Action<IntPtr> actionUnsafe, bool async = false)
    {
        return this.Permutate(start, count, null, actionUnsafe, async);
    }

    private unsafe bool Permutate(int start, int count, Action<int[]> action, Action<IntPtr> actionUnsafe, bool async = false)
    {
        if (!this._mutex.WaitOne(0))
        {
            return false;
        }

        var x = (Action)(() =>
                             {
                                 this._actionUnsafe = actionUnsafe;
                                 this._action = action;

                                 this.Size = count;

                                 this._arr = (int*)Marshal.AllocHGlobal(count * sizeof(int));
                                 this._arrIntPtr = new IntPtr(this._arr);

                                 for (var i = 0; i < count - 3; i++)
                                 {
                                     this._arr[i] = start + i;
                                 }

                                 this._last = this._arr + count - 1;
                                 this._lastPrev = this._last - 1;
                                 this._lastPrevPrev = this._lastPrev - 1;

                                 *this._last = count - 1;
                                 *this._lastPrev = count - 2;
                                 *this._lastPrevPrev = count - 3;

                                 this.Permutate(count, this._arr);
                             });

        if (!async)
        {
            x();
        }
        else
        {
            new Thread(() => x()).Start();
        }

        return true;
    }

    private unsafe void Permutate(int size, int* start)
    {
        if (size == 3)
        {
            this.DoAction();
            Swap(this._last, this._lastPrev);
            this.DoAction();
            Swap(this._last, this._lastPrevPrev);
            this.DoAction();
            Swap(this._last, this._lastPrev);
            this.DoAction();
            Swap(this._last, this._lastPrevPrev);
            this.DoAction();
            Swap(this._last, this._lastPrev);
            this.DoAction();

            return;
        }

        var sizeDec = size - 1;
        var startNext = start + 1;
        var usedStarters = 0;

        for (var i = 0; i < sizeDec; i++)
        {
            this.Permutate(sizeDec, startNext);

            usedStarters |= 1 << *start;

            for (var j = startNext; j <= this._last; j++)
            {
                var mask = 1 << *j;

                if ((usedStarters & mask) != mask)
                {
                    Swap(start, j);
                    break;
                }
            }
        }

        this.Permutate(sizeDec, startNext);

        if (size == this.Size)
        {
            this._mutex.ReleaseMutex();
        }
    }

    private unsafe void DoAction()
    {
        if (this._action == null)
        {
            if (this._actionUnsafe != null)
            {
                this._actionUnsafe(this._arrIntPtr);
            }

            return;
        }

        var result = new int[this.Size];

        fixed (int* pt = result)
        {
            var limit = pt + this.Size;
            var resultPtr = pt;
            var arrayPtr = this._arr;

            while (resultPtr < limit)
            {
                *resultPtr = *arrayPtr;
                resultPtr++;
                arrayPtr++;
            }
        }

        this._action(result);
    }

    private static unsafe void Swap(int* a, int* b)
    {
        var tmp = *a;
        *a = *b;
        *b = tmp;
    }
} 
```

**使用及测试性能：**

```
var perms = new Permutations();

var sw1 = Stopwatch.StartNew();

perms.Permutate(0,
                11,
                (Action<int[]>)null); // Comment this line and...
                //PrintArr); // Uncomment this line, to print permutations

sw1.Stop();
Console.WriteLine(sw1.Elapsed); 
```

**印刷方式：**

```
private static void PrintArr(int[] arr)
{
    Console.WriteLine(string.Join(",", arr));
} 
```

**更深入：**

我什至没有考虑这个问题很长时间，所以我只能解释我的代码，但这里是大致的想法：

1.  排列不是字典顺序的——这使我实际上可以在排列之间执行更少的操作。
2.  该实现是递归的，当“视图”大小为 3 时，它会跳过复杂的逻辑并只执行 6 次交换以获得 6 个排列（或子排列，如果你愿意的话）。
3.  因为排列不是按字典顺序排列的，我如何决定将哪个元素带到当前“视图”（子排列）的开头？我记录了在当前子排列递归调用中已经用作“启动器”的元素，并简单地线性搜索未在我的数组尾部使用的元素。
4.  该实现仅适用于整数，因此要对通用元素集合进行置换，您只需使用 Permutations 类来置换索引而不是实际集合。
5.  互斥锁只是为了确保在异步执行时事情不会搞砸（请注意，您可以传递一个 UnsafeAction 参数，该参数反过来会获得一个指向置换数组的指针。您不能更改该数组中元素的顺序（指针）！如果你愿意，你应该将数组复制到一个 tmp 数组，或者只使用为你处理的安全操作参数 - 传递的数组已经是一个副本）。

**笔记：**

我不知道这个实现到底有多好——我很久没碰过它了。自行测试并与其他实现进行比较，如果您有任何反馈，请告诉我！

享受。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-06-17T19:00:23.413

这是一个通用排列查找器，它将遍历集合的每个排列并调用评估函数。如果评估函数返回 true（它找到了它正在寻找的答案），则排列查找器停止处理。

```
public class PermutationFinder<T>
{
    private T[] items;
    private Predicate<T[]> SuccessFunc;
    private bool success = false;
    private int itemsCount;

    public void Evaluate(T[] items, Predicate<T[]> SuccessFunc)
    {
        this.items = items;
        this.SuccessFunc = SuccessFunc;
        this.itemsCount = items.Count();

        Recurse(0);
    }

    private void Recurse(int index)
    {
        T tmp;

        if (index == itemsCount)
            success = SuccessFunc(items);
        else
        {
            for (int i = index; i < itemsCount; i++)
            {
                tmp = items[index];
                items[index] = items[i];
                items[i] = tmp;

                Recurse(index + 1);

                if (success)
                    break;

                tmp = items[index];
                items[index] = items[i];
                items[i] = tmp;
            }
        }
    }
} 
```

这是一个简单的实现：

```
class Program
{
    static void Main(string[] args)
    {
        new Program().Start();
    }

    void Start()
    {
        string[] items = new string[5];
        items[0] = "A";
        items[1] = "B";
        items[2] = "C";
        items[3] = "D";
        items[4] = "E";
        new PermutationFinder<string>().Evaluate(items, Evaluate);
        Console.ReadLine();
    }

    public bool Evaluate(string[] items)
    {
        Console.WriteLine(string.Format("{0},{1},{2},{3},{4}", items[0], items[1], items[2], items[3], items[4]));
        bool someCondition = false;

        if (someCondition)
            return true;  // Tell the permutation finder to stop.

        return false;
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-10-13T18:48:06.960

这是一个基于交换数组元素的复杂度为`O(n * n!)`¹的递归实现。该数组使用来自 的值进行初始化`1, 2, ..., n`。

```
using System;

namespace Exercise
{
class Permutations
{
    static void Main(string[] args)
    {
        int setSize = 3;
        FindPermutations(setSize);
    }
    //-----------------------------------------------------------------------------
    /* Method: FindPermutations(n) */
    private static void FindPermutations(int n)
    {
        int[] arr = new int[n];
        for (int i = 0; i < n; i++)
        {
            arr[i] = i + 1;
        }
        int iEnd = arr.Length - 1;
        Permute(arr, iEnd);
    }
    //-----------------------------------------------------------------------------  
    /* Method: Permute(arr) */
    private static void Permute(int[] arr, int iEnd)
    {
        if (iEnd == 0)
        {
            PrintArray(arr);
            return;
        }

        Permute(arr, iEnd - 1);
        for (int i = 0; i < iEnd; i++)
        {
            swap(ref arr[i], ref arr[iEnd]);
            Permute(arr, iEnd - 1);
            swap(ref arr[i], ref arr[iEnd]);
        }
    }
}
} 
```

在每个递归步骤中，我们将最后一个元素与循环中的局部变量指向的当前元素交换`for`，然后我们通过以下方式指示交换的唯一性：增加循环的局部变量`for`并减少循环的终止条件`for`，这最初设置为数组中元素的数量，当后者变为零时，我们终止递归。

以下是辅助函数：

```
 //-----------------------------------------------------------------------------
    /*
        Method: PrintArray()

    */
    private static void PrintArray(int[] arr, string label = "")
    {
        Console.WriteLine(label);
        Console.Write("{");
        for (int i = 0; i < arr.Length; i++)
        {
            Console.Write(arr[i]);
            if (i < arr.Length - 1)
            {
                Console.Write(", ");
            }
        }
        Console.WriteLine("}");
    }
    //-----------------------------------------------------------------------------

    /*
        Method: swap(ref int a, ref int b)

    */
    private static void swap(ref int a, ref int b)
    {
        int temp = a;
        a = b;
        b = temp;
    } 
```

* * *

^(1.要打印的元素有`n!`排列。`n`)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-26T14:11:52.963

[*在 Steven Skiena 的算法设计手册*](http://www.algorist.com/)（第二版第 14.4 章）中有对算法和实现调查的易于理解的介绍

Skiena 引用 D. Knuth。计算机编程艺术，第 4 卷分册 2：生成所有元组和排列。艾迪生卫斯理，2005 年。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-06-26T14:56:47.563

如果真的发现了数量级的改进，我会感到惊讶。如果有，那么 C# 需要从根本上改进。此外，用你的排列做任何有趣的事情通常比生成它需要更多的工作。因此，在整体方案中，发电成本将是微不足道的。

也就是说，我建议尝试以下方法。您已经尝试过迭代器。但是您是否尝试过使用一个将闭包作为输入的函数，然后为找到的每个排列调用该闭包？根据 C# 的内部机制，这可能会更快。

类似地，您是否尝试过使用一个返回闭包的函数，该闭包将迭代特定的排列？

无论使用哪种方法，您都可以尝试许多微优化。例如，您可以对输入数组进行排序，然后您始终知道它的顺序。例如，您可以拥有一个布尔数组，指示该元素是否小于下一个元素，而不是进行比较，您可以看看那个数组。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-01-27T03:28:17.677

我创建了一个比 Knuth 的算法稍快的算法：

> 11个元素：
> 
> 我的：0.39 秒
> 
> 克努斯：0.624 秒
> 
> 13个元素：
> 
> 我的：56.615 秒
> 
> 克努斯：98.681 秒

这是我的Java代码：

```
public static void main(String[] args)
{
    int n=11;
    int a,b,c,i,tmp;
    int end=(int)Math.floor(n/2);
    int[][] pos = new int[end+1][2];
    int[] perm = new int[n];

    for(i=0;i<n;i++) perm[i]=i;

    while(true)
    {
        //this is where you can use the permutations (perm)
        i=0;
        c=n;

        while(pos[i][1]==c-2 && pos[i][0]==c-1)
        {
            pos[i][0]=0;
            pos[i][1]=0;
            i++;
            c-=2;
        }

        if(i==end) System.exit(0);

        a=(pos[i][0]+1)%c+i;
        b=pos[i][0]+i;

        tmp=perm[b];
        perm[b]=perm[a];
        perm[a]=tmp;

        if(pos[i][0]==c-1)
        {
            pos[i][0]=0;
            pos[i][1]++;
        }
        else
        {
            pos[i][0]++;
        }
    }
} 
```

问题是我的算法只适用于奇数个元素。我很快写了这段代码，所以我很确定有更好的方法来实现我的想法以获得更好的性能，但我现在真的没有时间去优化它并解决问题元素是均匀的。

它是每个排列的一次交换，它使用一种非常简单的方法来知道要交换哪些元素。

我在我的博客上写了代码背后的方法的解释：http: [//antoinecomeau.blogspot.ca/2015/01/fast-generation-of-all-permutations.html](http://antoinecomeau.blogspot.ca/2015/01/fast-generation-of-all-permutations.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-01-03T13:37:18.317

正如这个问题的作者所问的算法：

> [...] 一次生成一个排列，并且仅在必要时继续

我建议考虑 Steinhaus-Johnson-Trotter 算法。

[维基百科上的 Steinhaus-Johnson-Trotter 算法](https://en.wikipedia.org/wiki/Steinhaus%E2%80%93Johnson%E2%80%93Trotter_algorithm)

[这里](http://typeocaml.com/2015/05/05/permutation/)解释得很漂亮

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-01-24T09:54:08.953

现在是凌晨 1 点，我正在看电视并想到了同样的问题，但使用了字符串值。

给定一个单词，找出所有排列。您可以轻松地对其进行修改以处理数组、集合等。

我花了一点时间来解决这个问题，但我想出的解决方案是：

```
string word = "abcd";

List<string> combinations = new List<string>();

for(int i=0; i<word.Length; i++)
{
    for (int j = 0; j < word.Length; j++)
    {
        if (i < j)
            combinations.Add(word[i] + word.Substring(j) + word.Substring(0, i) + word.Substring(i + 1, j - (i + 1)));
        else if (i > j)
        {
            if(i== word.Length -1)
                combinations.Add(word[i] + word.Substring(0, i));
            else
                combinations.Add(word[i] + word.Substring(0, i) + word.Substring(i + 1));
        }
    }
} 
```

* * *

这是与上面相同的代码，但有一些注释

```
string word = "abcd";

List<string> combinations = new List<string>();

//i is the first letter of the new word combination
for(int i=0; i<word.Length; i++)
{
    for (int j = 0; j < word.Length; j++)
    {
        //add the first letter of the word, j is past i so we can get all the letters from j to the end
        //then add all the letters from the front to i, then skip over i (since we already added that as the beginning of the word)
        //and get the remaining letters from i+1 to right before j.
        if (i < j)
            combinations.Add(word[i] + word.Substring(j) + word.Substring(0, i) + word.Substring(i + 1, j - (i + 1)));
        else if (i > j)
        {
            //if we're at the very last word no need to get the letters after i
            if(i== word.Length -1)
                combinations.Add(word[i] + word.Substring(0, i));
            //add i as the first letter of the word, then get all the letters up to i, skip i, and then add all the lettes after i
            else
                combinations.Add(word[i] + word.Substring(0, i) + word.Substring(i + 1));

        }
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-02-21T23:14:59.283

我在 Rosetta 代码上找到了这个算法，它确实是我尝试过的最快的算法。[http://rosettacode.org/wiki/Permutations#C](http://rosettacode.org/wiki/Permutations#C)

```
/* Boothroyd method; exactly N! swaps, about as fast as it gets */
void boothroyd(int *x, int n, int nn, int callback(int *, int))
{
	int c = 0, i, t;
	while (1) {
		if (n > 2) boothroyd(x, n - 1, nn, callback);
		if (c >= n - 1) return;

		i = (n & 1) ? 0 : c;
		c++;
		t = x[n - 1], x[n - 1] = x[i], x[i] = t;
		if (callback) callback(x, nn);
	}
}

/* entry for Boothroyd method */
void perm2(int *x, int n, int callback(int*, int))
{
	if (callback) callback(x, n);
	boothroyd(x, n, n, callback);
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-02-24T02:08:45.730

```
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
/**
 * http://marknelson.us/2002/03/01/next-permutation/
 * Rearranges the elements into the lexicographically next greater permutation and returns true.
 * When there are no more greater permutations left, the function eventually returns false.
 */

// next lexicographical permutation

template <typename T>
bool next_permutation(T &arr[], int firstIndex, int lastIndex)
{
    int i = lastIndex;
    while (i > firstIndex)
    {
        int ii = i--;
        T curr = arr[i];
        if (curr < arr[ii])
        {
            int j = lastIndex;
            while (arr[j] <= curr) j--;
            Swap(arr[i], arr[j]);
            while (ii < lastIndex)
                Swap(arr[ii++], arr[lastIndex--]);
            return true;
        }
    }
    return false;
}

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
/**
 * Swaps two variables or two array elements.
 * using references/pointers to speed up swapping.
 */
template<typename T>
void Swap(T &var1, T &var2)
{
    T temp;
    temp = var1;
    var1 = var2;
    var2 = temp;
}

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
// driver program to test above function
#define N 3

void OnStart()
{
    int i, x[N];
    for (i = 0; i < N; i++) x[i] = i + 1;

    printf("The %i! possible permutations with %i elements:", N, N);

    do
    {
        printf("%s", ArrayToString(x));

    } while (next_permutation(x, 0, N - 1));

}

// Output:
// The 3! possible permutations with 3 elements:
// "1,2,3"
// "1,3,2"
// "2,1,3"
// "2,3,1"
// "3,1,2"
// "3,2,1"
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-03-31T04:25:28.240

```
// Permutations are the different ordered arrangements of an n-element
// array. An n-element array has exactly n! full-length permutations.

// This iterator object allows to iterate all full length permutations
// one by one of an array of n distinct elements.

// The iterator changes the given array in-place.

// Permutations('ABCD') => ABCD  DBAC  ACDB  DCBA
//                         BACD  BDAC  CADB  CDBA
//                         CABD  ADBC  DACB  BDCA
//                         ACBD  DABC  ADCB  DBCA
//                         BCAD  BADC  CDAB  CBDA
//                         CBAD  ABDC  DCAB  BCDA

// count of permutations = n!

// Heap's algorithm (Single swap per permutation)
// http://www.quickperm.org/quickperm.php
// https://stackoverflow.com/a/36634935/4208440
// https://en.wikipedia.org/wiki/Heap%27s_algorithm

// My implementation of Heap's algorithm:

template<typename T>
class PermutationsIterator
{
	int b, e, n;
	int c[32];  /* control array: mixed radix number in rising factorial base.
	            the i-th digit has base i, which means that the digit must be
	            strictly less than i. The first digit is always 0,  the second
	            can be 0 or 1, the third 0, 1 or 2, and so on.
	            ArrayResize isn't strictly necessary, int c[32] would suffice
	            for most practical purposes. Also, it is much faster */

public:
	PermutationsIterator(T &arr[], int firstIndex, int lastIndex)
	{
		this.b = firstIndex;  // v.begin()
		this.e = lastIndex;   // v.end()
		this.n = e - b + 1;

		ArrayInitialize(c, 0);
	}

	// Rearranges the input array into the next permutation and returns true.
	// When there are no more permutations left, the function returns false.

	bool next(T &arr[])
	{
		// find index to update
		int i = 1;

		// reset all the previous indices that reached the maximum possible values
		while (c[i] == i)
		{
			c[i] = 0;
			++i;
		}

		// no more permutations left
		if (i == n)
			return false;

		// generate next permutation
		int j = (i & 1) == 1 ? c[i] : 0;    // IF i is odd then j = c[i] otherwise j = 0.
		swap(arr[b + j], arr[b + i]);       // generate a new permutation from previous permutation using a single swap

		// Increment that index
		++c[i];
		return true;
	}

};
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2015-02-05T18:57:06.370

如果您只想计算可能的排列数量，您可以避免上面的所有艰苦工作并使用类似的东西（在 c# 中设计）：

```
public static class ContrivedUtils 
{
    public static Int64 Permutations(char[] array)
    {
        if (null == array || array.Length == 0) return 0;

        Int64 permutations = array.Length;

        for (var pos = permutations; pos > 1; pos--)
            permutations *= pos - 1;

        return permutations;
    }
} 
```

你这样称呼它：

```
var permutations = ContrivedUtils.Permutations("1234".ToCharArray());
// output is: 24
var permutations = ContrivedUtils.Permutations("123456789".ToCharArray());
// output is: 362880 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2020-09-25T15:02:02.363

通过交换的简单 C# 递归解决方案，对于初始调用，索引必须为 0

```
 static public void Permute<T>(List<T> input, List<List<T>> permutations, int index)
    {
        if (index == input.Count - 1)
        {
            permutations.Add(new List<T>(input));
            return;
        }

        Permute(input, permutations, index + 1);

        for (int i = index+1 ; i < input.Count; i++)
        {
            //swap
            T temp = input[index];
            input[index] = input[i];
            input[i] = temp;

            Permute(input, permutations, index + 1);

            //swap back
            temp = input[index];
            input[index] = input[i];
            input[i] = temp;
        }
    } 
```

# java - 重写 Thread 子类中的 run() 方法

> ID：11208448
> 
> 赞同：2
> 
> 时间：2012-06-26T13:32:11.247
> 
> 标签：java, inheritance, class-hierarchy

我只是想知道如果我对一个扩展的类进行子类化`Thread`并编写以下代码并进行测试，结果会是什么：

```
class A extends Thread {
    public A() {
        this.start();
    }
    public void run() {
        System.out.println(" in A " + Thread.currentThread().getName());
    }
}

class B extends A {
    public void run() {
        System.out.println(" in B " + Thread.currentThread().getName());
    }
}

public class OverrideRun {
    public static void main(String[] args) {
        A a = new A();
        B b = new B();
    }    
} 
```

结果是：

> 在 A Thread-0
> 中在 B Thread-1 中

但我不明白为什么要创建两个线程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:34:46.767

这是因为该`B b = new B();`语句不调用 class 的参数参数，`B`并且不调用 class 的参数参数构造函数（默认）`A`。

这是由于构造函数链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:34:54.100

那是因为*您*在这里创建了两个线程（从 继承的两个对象`Thread`）：

```
public static void main(String[] args) {
    A a = new A(); // #1
    B b = new B(); // #2
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T13:35:04.877

> 但我不明白为什么要创建两个线程？

启动了两个线程，因为您在构造函数中启动它们`A()`：

```
public A() {
    this.start();
} 
```

并且您正在构建两个对象 - an`A`和 a `B`which extends `A`：

```
 A a = new A();
    B b = new B(); 
```

默认情况下，当你说它`new B()`没有无参数构造函数时，它会调用超类的无参数构造函数。所以它将调用`A`启动线程的构造函数。请参阅[此处的 Java 文档](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)。去引用：

> 您不必为您的类提供任何构造函数，但这样做时必须小心。编译器会自动为任何没有构造函数的类提供无参数的默认构造函数。此默认构造函数将调用超类的无参数构造函数。在这种情况下，如果超类没有无参数构造函数，编译器会报错，因此您必须验证它是否存在。如果你的类没有显式的超类，那么它有一个 Object 的隐式超类，它确实有一个无参数的构造函数。

顺便说一句，在它的构造函数中启动一个线程并不是一个好习惯。执行此操作时可能会发生一些线程竞争情况。`a.start()`打电话后打电话要好得多`new A()`。`Runnable`此外，定义一个实现而不是扩展的类是一种更好的模式`Thread`。所以你的代码应该是：

```
class A implements Runnable() {
     public A() {
         // don't start it here
     }
     public void run() {
         ...
     }
}
...

Thread a = new Thread(new A());
a.start();
Thread b = new Thread(new B());
b.start(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-26T13:35:11.483

`A`extends `Thread`，`B`extends `A`，所以当你创建一个实例`A`和一个实例时`B`，你已经创建了两个实例`Thread`。

请注意，通常最好*不要*扩展`Thread`，而是*只*实现`Runnable`- 然后将其传递`Runnable`给`Thread(Runnable)`构造函数。从设计的角度来看，这最终会变得更干净——你并不是真的试图改变线程行为，你只是给它一个不同的任务来执行。

（通常最好使用 java.util.concurrent 中的设施，而不是一开始就直接创建线程，但是我们开始了......）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-26T13:36:08.403

正在创建 2 个线程，因为您通过运行以下行来请求它：

```
 A a = new A();
    B b = new B(); 
```

# resources - 可以在没有 Visual Studio 的情况下重新生成 Designer.cs 文件吗？

> ID：11208449
> 
> 赞同：0
> 
> 时间：2012-06-26T13:32:14.117
> 
> 标签：resources, designer, c#

我在 Resources.resx 中存储了几个经常更改的字段，这些字段会自动生成文件 Resources.designer.cs。它具有电子邮件地址、位置路径，可根据需要进行更新

现在我想让应用程序即使对于非开发人员也可用 - 即使是外行也必须能够编辑电子邮件地址和路径。

有一个想法，如果有人编辑 .resx 文件（即使在记事本中也很容易编辑），我可以编写一些 .exe 代码来自动生成相应的 Designer.cs 吗？

感谢您的理解..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T09:26:47.017

你可以使用类似的东西

```
 private void ReadResxFile(string filename)
    {
        if (System.IO.File.Exists(filename))
       {
            using (ResXResourceReader reader = new ResXResourceReader(filename))
            {
                //TODO
            }
        }
    }
    public void SaveResxAs(string fileName, string key, string value)
    {
        try
        {
            using (ResXResourceWriter writer = new ResXResourceWriter(fileName))
            {
                writer.AddResource(key, value);
                writer.Generate();
            }
        }
        catch (Exception error)
        {
            throw error;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:53:20.983

如果visual studio可以做到，你就可以做到。但我认为让非技术人员编辑 xml 文件是自找麻烦。我要做的是构建一个小型编辑工具，它只提取您想要更改的那些字段，以简单的形式显示它们以进行更改，然后在重建设计器之前将它们写回 resx。

我已经为编辑 application.exe.config 文件做了类似的事情，以便可以更改配置而不会有（甚至是技术人员）用错字杀死东西的危险，这太容易了。

# uac - NSIS：未知出版商

> ID：11208454
> 
> 赞同：2
> 
> 时间：2012-06-26T13:32:33.683
> 
> 标签：uac, nsis

当我在 Win7 上安装我的应用程序时，Windows 显示安装对话框，显示“未知发布者”。我应该怎么做才能摆脱它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:45:07.400

简单地说：您需要来自证书颁发机构的证书并签署您的二进制文件。AFAIK 证书不是免费的，而且是有时间限制的。有关详细信息，请参阅[此](https://stackoverflow.com/a/10587106)答案。

# iphone - UIScrollView 缩放问题

> ID：11208455
> 
> 赞同：0
> 
> 时间：2012-06-26T13:32:36.860
> 
> 标签：iphone, ios, image, uiscrollview, uiscrollviewdelegate

我有 UIScrollView。当我缩放图像时，我应该先显示小图像，然后显示大图像。如果我使用此代码，一切正常：

```
- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollViewCalled
{
    ImageScrollView *scroll = scrollViewCalled
    UIImageView *imageView = (UIImageView *)[scroll viewWithTag:kImageViewTag];
    return imageView;
} 
```

ImageView 的大小 = 图像的大小（如果图像小，意思是，那 = 小图像的大小，如果图像大 - 大图像的大小） scrollView 的 ContentSize = imageView 的大小。

```
- (void)scrollViewDidEndZooming:(UIScrollView *)scrollViewCalled withView:(UIView *)view atScale:(float)scale
{
    ImageScrollView *scroll = scrollViewCalled
        UIImageView *imageView = (UIImageView *)[scroll viewWithTag:kImageViewTag];
    if ([self isBigImage:imageView])
    {
        return;
    }
    [self loadBigImage];
} 
```

但是如果使用此代码（当我尝试缩放时，会显示大图像，但我看到它的最大缩放比例，并且我无法滚动查看图像的其余部分。但是当我再缩放一次而不是滚动图像，它开始正常工作，我终于可以滚动图像了。但我应该放大2倍）：

```
- (void)scrollViewWillBeginZooming:(UIScrollView *)scrollViewCalled withView:(UIView *)view
{
    ImageScrollView *scroll = scrollViewCalled
            UIImageView *imageView = (UIImageView *)[scroll viewWithTag:kImageViewTag];
        if ([self isBigImage:imageView])
        {
            return;
        }
        [self loadBigImage];
} 
```

为什么 scrollViewWillBeginZooming 不能正常工作？我需要在缩放之前设置大图像，但不是在缩放之后。

# smarty - .tpl 文件和 %%。这是聪明的吗？

> ID：11208463
> 
> 赞同：0
> 
> 时间：2012-06-26T13:32:48.080
> 
> 标签：smarty

我有一个 .tpl 文件，其中包含 %% 变量。

例子：

```
%%GLOBAL_Error%% 
```

这是一个聪明的模板引擎文件吗？

我想检查这个变量是否不为空，但我不能用常规的 smarty 语法来做到这一点。

```
{if isset($GLOBAL_Error) } 
```

我怎样才能做到这一点？

> 我得到回复说这是 Twig 模板引擎：S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:41:50.390

*可能*是，但可能不是。[Smarty 标记分隔符](http://www.smarty.net/docsv2/en/variable.left.delimiter.tpl)是可配置的，因此开发人员可以将它们设置为`%%`和`%%`。`GLOBAL_Error`可能不是变量，而是没有参数的函数调用。在这种情况下，您需要类似：

```
%%if (%%GLOBAL_Error%%) %% 
```

不过，这是一些非常难看的语法。它可以是任何东西，可能是在模板编译之前或之后用于某些搜索/替换的字符串标记。如果您已经在使用带有标准分隔符的 Smarty，那么 Smarty 不太可能`%%GLOBAL_Error%%`会解析它——它甚至可能是错误或旧代码的遗留物。唯一确定的方法是询问作者或查看代码库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:46:44.343

默认情况下，smarty 使用`{`and`}`作为分隔符。因此，您可以编写代码：

```
{if $GLOBAL_Error}{/if} 
```

但是分隔符可以更改为`%%`，并且代码必须采用以下形式：

```
%%if $GLOBAL_Error%%%%/if%% 
```

另见：[http ://www.smarty.net/docsv2/en/language.escaping.tpl](http://www.smarty.net/docsv2/en/language.escaping.tpl)

# javascript - JQuery Datepicker 抛出一个随机类型错误

> ID：11208464
> 
> 赞同：1
> 
> 时间：2012-06-26T13:32:48.363
> 
> 标签：javascript, jquery, jquery-ui, uidatepicker, jquery-ui-datepicker

我遇到了一个 JQuery Datepicker 问题，

在大约每 50 页重新加载时，当我想从 JQuery Datepicker 中选择一个日期时，我会收到一条错误消息：

```
Uncaught TypeError: Object #<HTMLTableCellElement> has no method 'find' 
```

单击日期选择器时，该字段未填充日期。

**此问题仅在以下情况下发生：**

*   单击日期选择的元素时
*   仅在 Chrome 中
*   错误非常罕见，我需要大约 15 分钟的时间才能再次重现
*   如果 JQuery 通过 CDN（异步）或从我们的服务器加载，错误仍然存​​在
*   我们试图在页面为 .ready() 时显式调用日期选择器，但没有帮助

**使用的 JQuery 版本：**

*   jquery.min.js | jQuery JavaScript 库 v1.5.2
*   jquery-ui.min.js | jQuery UI - v1.8.21
*   jquery-ui-1.8.15.custom.min.js | jQuery UI 1.8.15
*   jquery-ui-timepicker-addon.js | 版本 0.9.6

我们现在看到的唯一一件事是更新 JQuery，但我们只想将其作为最后的解决方案，否则我们需要更改大量代码。

也许有人已经面临这个问题。

问候

**//编辑：**

*   我删除了 jquery ui 的第二次导入
*   我将版本更新为 jQuery UI 1.8.21
*   我首先加载了validation.js和tinymce.js（带有旧`this.find`调用）

还是行不通

# automation - 配置多台服务器并扩展

> ID：11208470
> 
> 赞同：0
> 
> 时间：2012-06-26T13:33:11.650
> 
> 标签：automation

我接到了一个任务，用一些简单的数据配置 1000 台服务器。假设我需要登录服务器（linux 或 windows）并设置 ntp 服务器。我需要想出某种使用 perl 的自动化框架。我有一些想法，想得到更多。

这是我的思考过程：

```
a) Since there are 1000s of servers, definitely the framework should be able to read in a csv file so all inputs can be provided as apposed to single input.

b) Since there are so many servers, I have to find a way to do things in parallel. I cant go server by server in a sequential way

c) I should have some output file that shows the results of all the servers that I successfully configured, servers that failed. That way I can compare input file and output file and generate a report 
```

我应该在我的框架中考虑其他什么吗？如何使用 perl 进行并行处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T16:13:03.623

即使你想坚持使用 Perl，看起来已经有一些替代方案可以阻止你从头开始实现另一个框架。

查看来自[http://my.opera.com/cstrep/blog/2010/05/14/puppet-fabric-and-a-perl-alternative](http://my.opera.com/cstrep/blog/2010/05/14/puppet-fabric-and-a-perl-alternative)的评论，了解几个选项。

# couchdb - Cocuhdb 适合这样的查询吗？

> ID：11208471
> 
> 赞同：1
> 
> 时间：2012-06-26T13:33:12.243
> 
> 标签：couchdb

我一直在寻找逃离 GAE 的方法，因为数据存储不支持很多我想用它做的事情。

所以我查看了 CouchDB（以及其他），我真的很喜欢我在 Cloudant 找到的 REST 接口和托管选项。

但是对于我所有的谷歌搜索和阅读我能找到的任何文档，我仍然不确定它是否合适。所以我来这里是希望有人可能有更多的见解。

我编写网络应用程序，我想做的很多项目都会涉及如下查询：

查找 user-input-lat/long 边界框内的所有条目，其中 start-time 小于 user-input-time-1 并且 end-time 大于 user-input-time-2 并且所有标签都在用户输入标签列表。

那甚至不是伪代码，但我希望无论如何它是有意义的。

我不只是在寻找“你不能在 CouchDB 中做到这一点”。某种解释，也许像“如果你可以没有标签，那么你可以这样做：”

我想使用 Cloudant 服务，所以 GeoCouch 显然是不可能的，但他们做的事情应该像 lucene 一样工作，但这是否意味着查询很慢？

如您所知，我在这里有点困惑，所以请尽力使我理顺，我会很高兴的：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:01:03.930

不提标签（这本身就是一个问题），你描述的是一个多维查询：你有几个“坐标”（纬度，经度，开始时间，结束时间）并为每个提供一个范围这些坐标。

就其本身而言，CouchDB 根本无法执行多维查询——您只能在一个坐标上获得单维查询。

标签当然是可能的，但这取决于您是否需要列表中至少有一个标签的文档，还是列表中包含*所有*标签的文档。第一种情况很简单（使用批量 API 为每个标签运行一个查询），第二种可能需要过多的内存（如果文档有 N 个标签，它需要发出 2 ^(N-1 个)标签集以匹配所有可能的涉及它的标签组合，因此您应该为文档中的标签数量或查询中的标签数量设置上限）。

Lucene 确实允许多维和基于关键字的查询，但我不能保证它们的性能。

# android - 如何将 SQLite 查询保存在单独的文本文件中并在 Android 中访问它们？

> ID：11208472
> 
> 赞同：0
> 
> 时间：2012-06-26T13:33:13.190
> 
> 标签：android, database, sqlite, text

我想以文本文件格式保留数据库创建查询和数据访问查询（这些文本文件将位于“res”文件夹之类的文件夹中）并从android访问它们。

假设我想执行 createDB() 查询，那么我应该能够通过相关的文本文件名调用并执行查询。

我在互联网上搜索了很多时间，但最终无法找到合适的教程或解决方案。因此，我恳请您提供一些想法/解决方案，或者至少提供一个满足我要求的好教程。如果我的问题不清楚，也请提及。谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:39:57.343

我不知道你为什么要这样做，但你可以这样做：

1）将这些文件放在文件`assets`夹中
2）您可以像这样打开它们：

```
InputStream input = context.getAssets().open("example.xml"); 
```

# java - Saving a path object between states (Android)

> ID：11208476
> 
> 赞同：1
> 
> 时间：2012-06-26T13:33:36.423
> 
> 标签：java, android

I am working on a sketchpad android application. I am using a path object to draw the users input, but am having trouble retaining it. Right now whenever you navigate away from the page everything that the user draws is erased. What is the best way to retain the path object so that I can redraw the users previous input when states are changed.

Thank you.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:36:04.837

Simplest way would be to declare the `Path` object using `static` keyword and as class variable.

# java - 如何在 Java 中初始化字节数组？

> ID：11208479
> 
> 赞同：167
> 
> 时间：2012-06-26T13:33:43.553
> 
> 标签：java, arrays, byte

我必须在java中以字节数组形式存储一些常量值（UUID），我想知道初始化这些静态数组的最佳方法是什么。这就是我目前正在做的事情，但我觉得必须有更好的方法。

```
private static final byte[] CDRIVES = new byte[] { (byte)0xe0, 0x4f, (byte)0xd0,
    0x20, (byte)0xea, 0x3a, 0x69, 0x10, (byte)0xa2, (byte)0xd8, 0x08, 0x00, 0x2b,
    0x30, 0x30, (byte)0x9d };
private static final byte[] CMYDOCS = new byte[] { (byte)0xba, (byte)0x8a, 0x0d,
    0x45, 0x25, (byte)0xad, (byte)0xd0, 0x11, (byte)0x98, (byte)0xa8, 0x08, 0x00,
    0x36, 0x1b, 0x11, 0x03 };
private static final byte[] IEFRAME = new byte[] { (byte)0x80, 0x53, 0x1c,
    (byte)0x87, (byte)0xa0, 0x42, 0x69, 0x10, (byte)0xa2, (byte)0xea, 0x08,
    0x00, 0x2b, 0x30, 0x30, (byte)0x9d };
...
and so on 
```

有什么我可以使用的可能效率较低但看起来更清洁的东西吗？例如：

```
private static final byte[] CDRIVES =
    new byte[] { "0xe04fd020ea3a6910a2d808002b30309d" }; 
```

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2012-06-26T13:43:42.667

您可以使用实用函数将熟悉的十六进制字符串转换为`byte[]`. 当用于定义`final static`常数时，性能成本无关紧要。

## 从 Java 17 开始

现在有[`java.util.HexFormat`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/HexFormat.html)它可以让你做

```
byte[] CDRIVES = HexFormat.of().parseHex("e04fd020ea3a6910a2d808002b30309d"); 
```

如果您发现其他格式更易于阅读或从参考源复制粘贴时，此实用程序类可让您指定一种方便的格式：

```
byte[] CDRIVES = HexFormat.ofDelimiter(":")
    .parseHex("e0:4f:d0:20:ea:3a:69:10:a2:d8:08:00:2b:30:30:9d"); 
```

## Java 17 之前

我建议您使用 Dave L 在[使用 Java 将十六进制转储的字符串表示形式转换为字节数组中定义的函数？](https://stackoverflow.com/questions/140131/convert-a-string-representation-of-a-hex-dump-to-a-byte-array-using-java)

```
byte[] CDRIVES = hexStringToByteArray("e04fd020ea3a6910a2d808002b30309d"); 
```

我将其插入此处以获得最大的可读性：

```
public static byte[] hexStringToByteArray(String s) {
    int len = s.length();
    byte[] data = new byte[len / 2];
    for (int i = 0; i < len; i += 2) {
        data[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) << 4)
                             + Character.digit(s.charAt(i+1), 16));
    }
    return data;
} 
```

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2014-01-15T18:50:15.480

```
byte[] myvar = "Any String you want".getBytes(); 
```

字符串文字可以转义以提供任何字符：

```
byte[] CDRIVES = "\u00e0\u004f\u00d0\u0020\u00ea\u003a\u0069\u0010\u00a2\u00d8\u0008\u0000\u002b\u0030\u0030\u009d".getBytes(); 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2013-10-08T08:12:37.773

在 Java 6 中，有一种方法可以完全满足您的要求：

```
private static final byte[] CDRIVES = javax.xml.bind.DatatypeConverter.parseHexBinary("e04fd020ea3a6910a2d808002b30309d") 
```

或者，您可以使用[Google Guava](http://code.google.com/p/guava-libraries/)：

```
import com.google.common.io.BaseEncoding;
private static final byte[] CDRIVES = BaseEncoding.base16().lowerCase().decode("E04FD020ea3a6910a2d808002b30309d".toLowerCase()); 
```

当您使用小型数组时，Guava 方法过于矫枉过正。但是 Guava 也有可以解析输入流的版本。在处理大的十六进制输入时，这是一个很好的功能。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-26T13:36:51.300

您可以使用 Java UUID 类来存储这些值，而不是字节数组：

```
UUID

public UUID(long mostSigBits,
            long leastSigBits) 
```

使用指定的数据构造一个新的 UUID。mostSigBits 用于 UUID 的最高有效 64 位，leastSigBits 成为 UUID 的最低有效 64 位。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-04-19T11:57:58.973

最小的内部类型，在编译时可以用十六进制数字分配是*char*，如

```
private static final char[] CDRIVES_char = new char[] {0xe0, 0xf4, ...}; 
```

为了获得等效的字节数组，可以将转换部署为

```
public static byte[] charToByteArray(char[] x)
{
    final byte[] res = new byte[x.length];
    for (int i = 0; i < x.length; i++)
    {
        res[i] = (byte) x[i];
    }
    return res;
}

public static byte[][] charToByteArray(char[][] x)
{
    final byte[][] res = new byte[x.length][];
    for (int i = 0; i < x.length; i++)
    {
        res[i] = charToByteArray(x[i]);
    }
    return res;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-11-10T20:49:30.233

没有库的解决方案，返回动态长度，无符号整数解释（不是二进制补码）

```
 public static byte[] numToBytes(int num){
    if(num == 0){
        return new byte[]{};
    }else if(num < 256){
        return new byte[]{ (byte)(num) };
    }else if(num < 65536){
        return new byte[]{ (byte)(num >>> 8),(byte)num };
    }else if(num < 16777216){
        return new byte[]{ (byte)(num >>> 16),(byte)(num >>> 8),(byte)num };
    }else{ // up to 2,147,483,647
        return new byte[]{ (byte)(num >>> 24),(byte)(num >>> 16),(byte)(num >>> 8),(byte)num };
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-11-25T01:11:32.117

您可以使用此实用程序功能：

```
public static byte[] fromHexString(String src) {
    byte[] biBytes = new BigInteger("10" + src.replaceAll("\\s", ""), 16).toByteArray();
    return Arrays.copyOfRange(biBytes, 1, biBytes.length);
} 
```

与 Denys Séguret 和 stefan.schwetschke 的变体不同，它允许在输入字符串中插入分隔符（空格、制表符等），使其更具可读性。

使用示例：

```
private static final byte[] CDRIVES
    = fromHexString("e0 4f d0 20 ea 3a 69 10 a2 d8 08 00 2b 30 30 9d");
private static final byte[] CMYDOCS
    = fromHexString("BA8A0D4525ADD01198A80800361B1103");
private static final byte[] IEFRAME
    = fromHexString("80531c87 a0426910 a2ea0800 2b30309d"); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-26T13:40:19.823

就干净的过程而言，您可以使用**[ByteArrayOutputStream](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/ByteArrayOutputStream.html)**对象...

```
ByteArrayOutputStream bObj = new ByteArrayOutputStream();
bObj.reset(); 
```

//将所有值一一写入bObj

```
bObj.write(byte value) 
```

// 完成后，您可以使用 byte[]

```
CDRIVES = bObj.toByteArray(); 
```

//然后你也可以对 CMYDOCS 和 IEFRAME 重复类似的过程，

**注意**如果您真的有小阵列，这不是一个有效的解决方案。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-10-13T09:25:14.150

在这种情况下，我首选的选择是使用`org.apache.commons.codec.binary.Hex`具有有用的 API 来在`String`y 十六进制和二进制之间进行转换。例如：

1.  `Hex.decodeHex(char[] data)``DecoderException`如果数组中有非十六进制字符，或者有奇数个字符，则抛出 a 。

2.  `Hex.encodeHex(byte[] data)`是上述解码方法的对应物，并吐出`char[]`.

3.  `Hex.encodeHexString(byte[] data)`它将从`byte`数组转换回`String`.

用法：`Hex.decodeHex("dd645a2564cbe648c8336d2be5eafaa6".toCharArray())`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-02T21:41:10.773

您可以使用充气城堡包，

Maven导入，

```
 <dependency>
        <groupId>org.bouncycastle</groupId>
        <artifactId>bcprov-jdk15on</artifactId>
    </dependency> 
```

Java代码，

```
byte[] CDRIVES = Hex.decode("e04fd020ea3a6910a2d808002b30309d"); 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2017-09-05T11:08:21.003

```
private static final int[] CDRIVES = new int[] {0xe0, 0xf4, ...}; 
```

并在访问后转换为字节。

# android - 如何启用 android Honeycomb 和 ICS 模拟器对 localhost 的访问

> ID：11208481
> 
> 赞同：0
> 
> 时间：2012-06-26T13:33:53.537
> 
> 标签：android, avd

我正在使用各种 android sdk 测试我的应用程序 - froyo、honeycomb 和 ICS。我的应用程序正在连接到在 localhost 上运行的一些 Web 服务器。

当我在 froyo AVD 上测试应用程序时，应用程序可以很好地连接到 Web 服务器，但是当我在 Honeycomb 和 ICS AVD 上运行应用程序时，它无法连接到本地主机？

我在两个 AVD 上缺少什么设置

加思

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:36:00.267

localhost 在同一设备上的网卡上循环（在本例中为模拟器网卡）。

你要做的是设置你的主机IP（不是127.0.0.1，另一个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T07:33:26.000

全部，

我发现了我的问题；

我注意到我在主线程上调用网络 I/O，新的 android SDK（Honeycomb/ICS - 3.0/4.0）认为这是阻塞，因此抛出和异常。早期的 SDK（froyo 2.2）没有检查这一点，或者他们可能是宽容的。

如果您检查目录日志，则抛出的异常是； **android.os.NetworkOnMainThreadException**

要访问本地 Web 服务器，模拟器的 IP 是 10.0.2.2。

# android - 如何读取卡 ISODEP NFC

> ID：11208486
> 
> 赞同：0
> 
> 时间：2012-06-26T13:33:58.883
> 
> 标签：android, android-intent, nfc

我必须编写一个简单的应用程序来读取 ISO B 卡

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tag_viewer);
    mTagContent = (LinearLayout) findViewById(R.id.list);
    mTitle = (TextView) findViewById(R.id.title);
    resolveIntent(getIntent());
}

void resolveIntent(Intent intent) {
    // Parse the intent
    String action = intent.getAction();
    Log.e(TAG, "toto ");
    if (NfcAdapter.ACTION_TECH_DISCOVERED.equals(action)) {
    try{
            myTag.connect();
            if (myTag.isConnected()){
                byte[] response = myTag.transceive(command);
                //logText(new String(response));
                Log.e(TAG, "Result " + response);
            }
            myTag.close();

        }catch (IOException e) {
               e.printStackTrace();
        }

    } else {
        Log.e(TAG, "Unknown intent " + intent);
        finish();
        return;
    }
} 
```

我的问题是我没有成功进入测试 if (NfcAdapter.ACTION_TECH_DISCOVERED.equals(action))。我系统地有“未知的意图”。

关于清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.android.nfc">
<uses-permission android:name="android.permission.NFC" />
<uses-permission android:name="android.permission.CALL_PHONE" />
<application
    android:icon="@drawable/icon"
    android:label="@string/app_name"
>
       <activity android:name="TagViewer"
        android:theme="@android:style/Theme.NoTitleBar"
    >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
        <intent-filter>
            <action android:name="android.nfc.action.TECH_DISCOVERED"/>
            <category android:name="android.intent.category.DEFAULT"/>
        </intent-filter>
            <meta-data android:name="android.nfc.action.TECH_DISCOVERED"
                android:resource="@xml/nfc_tech_filter" />
    </activity>
</application>
<uses-sdk android:minSdkVersion="9" />
<uses-feature android:name="android.hardware.nfc" android:required="true" /> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-12T23:36:24.850

您需要创建一个 NfcAdapter 对象

```
 private NfcAdapter mNfcAdapter; 
```

而不是在 onCreate 方法中将对象与您的 NFC 关联

```
mNfcAdapter = NfcAdapter.getDefaultAdapter(this); 
```

在启动应用程序之前做一些检查，以确保手机有 NFC

```
if (mNfcAdapter == null) { 
  // Stop here, we definitely need NFC
  Toast.makeText(this, "This device doesn't support NFC.", Toast.LENGTH_LONG).show();
  finish();
  return;
} 
```

在 onResume 方法上启用 Dispatch

```
@Override
public void onResume() {
  super.onResume();
  Intent intent = new Intent(activity.getApplicationContext(), activity.getClass());
  PendingIntent pendingIntent = PendingIntent.getActivity(activity.getApplicationContext(), 0, intent, 0);
  mNfcAdapter.enableForegroundDispatch(activity, pendingIntent, null, null);
} 
```

在 onPause 方法上禁用 Dispatch

```
@Override
protected void onPause() {
  mNfcAdapter.disableForegroundDispatch(activity);
} 
```

最后重写onNewIntent方法来处理intent

```
@Override
protected void onNewIntent(Intent intent) {
  //handle intent here
} 
```

在您的情况下，在 onNewIntent 方法中调用“resolveIntent(intent)”，而不是按照这篇文章处理 IsoDep 标签：[从 NFC 标签 (IsoDep) 读取数据](https://stackoverflow.com/questions/16815007/read-data-from-nfc-tag-isodep)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T15:43:02.667

您的问题似乎是，您在 onCreate 方法中调用了 resolveIntent。

这应该可以解决问题：

```
 @Override
protected void onNewIntent(Intent pIntent) {
    super.onNewIntent(pIntent);

    resolveIntent(pIntent);

} 
```

要获取标记对象，我只是在使用

```
Tag tagFromIntent = pIntent.getParcelableExtra(NfcAdapter.EXTRA_TAG);

        NfcA tag = NfcA.get(tagFromIntent); 
```

在我的 onNewIntent 方法中

不幸的是，我无法为 NfcB 验证这一点。

# javascript - 如何将数组值添加到新的 FormData？

> ID：11208488
> 
> 赞同：11
> 
> 时间：2012-06-26T13:34:04.473
> 
> 标签：javascript, jquery

在提交表单时，我使用 jQuery 来收集包括文件在内的数据，并使用以下方法创建表单值的 FormData 对象：

```
var formData = new FormData($("form#formid")[0]); 
```

但是我怎样才能添加另一个值，它是这个 FormData 对象的关键？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-26T13:39:23.107

```
var formData = new FormData($("form#formid")[0]);
formData.append("key", "value") 
```

见[https://developer.mozilla.org/en/XMLHttpRequest/FormData](https://developer.mozilla.org/en/XMLHttpRequest/FormData)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:43:41.760

您可以遍历表单中的所有字段并将它们添加到`FormData`非常容易的方式：

```
var formData = new FormData();
$("form#edit-account").serializeArray().forEach(function(field) {
  formData.append(field.name, field.value)
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-06T10:24:22.923

```
var data = new FormData(),
    fields = $("#myForm").serializeArray();

$.each( fields, function( i, field ) {
    data.append(field.name, field.value);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-28T08:30:47.963

您也可以使用[FormData.set()](https://developer.mozilla.org/en-US/docs/Web/API/FormData/set)。

> FormData.set 和 append() 的区别在于，如果指定的键已经存在，FormData.set 将用新的值覆盖所有现有值，而 append() 会将新值附加到现有值集的末尾.

**语法**：

```
formData.set(name, value); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-28T12:59:24.413

```
$( 'form' ).submit(function ( e ) {
var data;

data = new FormData();
data.append( 'file', $( '#file' )[0].files[0] );

$.ajax({
    url: 'http://hacheck.tel.fer.hr/xml.pl',
    data: data,
    processData: false,
    type: 'POST',
    success: function ( data ) {
        alert( data );
    }
});

e.preventDefault(); 
```

});

# asp.net-mvc - 类似的路由映射

> ID：11208493
> 
> 赞同：1
> 
> 时间：2012-06-26T13:34:29.327
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, asp.net-web-api

我需要映射以创建控制器必须响应两个 url：

1.  “http://localhost/api/controller?id=1”（只有 id 值可以改变）
2.  “http://localhost/api/controller/anotherId/someconst”（其中 anotherId 是唯一变化的部分）

我将它映射到这样的路线：

```
routes.MapHttpRoute("Test", "api/{controller}/{id}/{someconst}", new { controller = "Test", someconst = RouteParameter.Optional }); 
```

并且必须在我的控制器中使用方法：

```
public void Get(int id) { ... }
public void Get(int anotherId, string someconst ) { ... } 
```

它有效......但它看起来不太好......因为“string someconst”不是参数，它只是url的一个const部分。但是，如果我删除“string someconst”参数，第二个 url 将不起作用。是否可以将一个控制器映射到两条路由以解析此 url，以使其清楚，而无需假参数，实际上是 const？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T13:54:35.237

好吧，我已经得到了答案...只是必须路由...

```
routes.MapHttpRoute("Test", "api/{controller}/{id}", new { controller = "Test", action = "Get", id= @"\d+"); );

routes.MapHttpRoute("TestSomeConst", "api/{controller}/{anotherId}/someconst", new { controller = "Test", action = "GetSomeconst", anotherId= @"\d+"); 
```

并更改控制器方法（操作）：

```
public void Get(int id) { ... } 
public void GetSomeconst(int anotherId) { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T14:59:29.910

您可以尝试做的一件事是像这样映射路线：

```
 routes.MapHttpRoute("Test", "api/{controller}/{id}/{action}", new { controller = "Test", action = "Get", id= @"\d+"} ); 
```

并做出你的行动：

```
 public void Get(int id) { ... }

 [HttpGet]
 public void Someconst(int id) { ... } 
```

因为您的操作默认为“Get”方法，您可以忽略它并使用以下命令调用它：

```
 http://localhost/api/test/1 
```

如果你想调用你的其他方法，你会使用

```
 http://localhost/api/test/1/someconst 
```

# python - python捕捉函数

> ID：11208502
> 
> 赞同：3
> 
> 时间：2012-06-26T13:34:55.783
> 
> 标签：python, function, operator-keyword

我编写了以下有效的代码。

```
from operator import mul
from operator import truediv #python 3.2

class Vec(list):

    def __mul__(self, other):
        return Vec(map(mul, self, other))

    def __truediv__(self, other):
        return Vec(map(truediv, self, other))

>>> xs = Vec([1,2,3,4,5])
>>> ys = Vec([4,5,6,7,4])
>>> zs = xs * ys
>>> zs.__class__
<class 'vector.Vec'>
>>> zs
[4, 10, 18, 28, 20] 
```

但是否有可能创建这样的东西：

```
class Vec(list):

    allowed_math = [__add__, __mul__, __truediv__, __subtract__] # etc

    def __catchfunction__(self, other, function):
        if function in allowed_math:
            return Vec(map(function, self, other)) 
```

澄清一下，这不是我试图重新创建 NumPy，我只是想了解如何使用 Python。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:40:49.457

达到预期效果的一种选择是：

```
class Vec(list):
    pass

functions = {"__add__": operator.add,
             "__mul__": operator.mul,
             "__truediv__": operator.truediv,
             "__sub__": operator.sub}
for name, op in functions.iteritems():
    setattr(Vec, name, lambda self, other, op=op: Vec(map(op, self, other))) 
```

请注意，该`op=op`参数是必要的，以避免 lambda 函数成为`op`.

不过，使用 NumPy 可能会好得多——它提供了比在纯 Python 中自己创建的更通用和更高效的数值数组实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:03:14.320

要知道的重要一点是，根据[http://docs.python.org/reference/datamodel.html#new-style-special-lookup](http://docs.python.org/reference/datamodel.html#new-style-special-lookup) ( [http://docs.python.org/dev/reference/datamodel.html#](http://docs.python.org/dev/reference/datamodel.html#special-method-lookup) Python 3[的特殊方法查找）：](http://docs.python.org/dev/reference/datamodel.html#special-method-lookup)

> 对于自定义类，特殊方法的隐式调用只有在对象类型上定义时才能保证正常工作，而不是在对象的实例字典中。...隐式特殊方法查找通常也会绕过`__getattribute__()`对象元类的方法。

因此，通过特殊方法名称实现运算符重载的唯一方法是在类上定义它们（内联或以编程方式创建类之后）。

有关更多详细信息和示例，请参阅[http://code.activestate.com/recipes/577812-see-how-__getattribute__-interacts-with-special-me/ 。](http://code.activestate.com/recipes/577812-see-how-__getattribute__-interacts-with-special-me/)有关相关问题，另请参阅[覆盖实例上的特殊方法。](https://stackoverflow.com/questions/10376604/overriding-special-methods-on-an-instance)

# asp.net-mvc - ASP.NET MVC + Selenium 调整窗口大小错误

> ID：11208506
> 
> 赞同：1
> 
> 时间：2012-06-26T13:35:10.370
> 
> 标签：asp.net-mvc, iis-7, selenium

我在调整 selenium 窗口大小时遇到​​问题，我正在尝试创建网站的屏幕截图并为此使用 selenium。我正在使用以下代码部分：

```
public void CreateScreenshot ()
{
IWebDriver webDriver = new FirefoxDriver();
var js = webDriver as IJavaScriptExecutor;

string temWindowName = Guid.NewGuid().ToString("N");

js.ExecuteScript(String.Format("window.open('{0}', '{1}', 'width={2},height={3}')", "http://www.google.com", temWindowName, 1920, 680));
webDriver.Close();
webDriver.SwitchTo().Window(temWindowName);

js = webDriver as IJavaScriptExecutor;
js.ExecuteScript(String.Format("window.resizeTo({0},{1});", 1920, 860));
js.ExecuteScript(String.Format("window.moveTo(0,0)"));

Screenshot screenshot = ((ITakesScreenshot)webDriver).GetScreenshot();
screenshot.SaveAsFile(string.Format("c:/temp.png", args[0]), ImageFormat.Png);
} 
```

当我尝试在没有 IIS 的情况下在本地运行此代码部分时，一切正常，当应用程序在 IIS 上运行时，我无法获得超过 1028 像素的屏幕截图宽度。

有谁知道为什么？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T13:21:31.853

您是否尝试从 IIS 托管应用程序启动 selenium？如果是这样，那么我假设您遇到的问题与我刚刚报告的问题相同 -[问题 4174](https://code.google.com/p/selenium/issues/detail?id=4174)

# java - 如果程序不等待用户输入/系统资源，java中线程的用途是什么

> ID：11208508
> 
> 赞同：1
> 
> 时间：2012-06-26T13:35:19.877
> 
> 标签：java, multithreading, cpu-usage

我有一个普遍的问题：

我的程序将继续处理不需要用户输入或系统资源（如打印机等）的东西，这意味着我的程序不会等待除 CPU 时间以外的任何资源。

同一个程序（假设是作业）可能由多个用户启动。

在这种情况下，是否值得在一个线程中运行它（这意味着每个用户都会感觉到他的工作被毫不拖延地执行。还是顺序运行这些工作更好？

作为单独线程运行的问题是，同时运行的线程过多，导致 CPU 利用率超过 100%。

请建议。假设用户看不到他的工作进度。当他的工作完成时，用户并不担心。但同时，我想让 CPU 忙于运行作业。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:42:10.297

如果您不在乎一个进程需要多长时间，或者它所花费的时间长度是可以接受的，那么使用一个线程可能是最简单的解决方案。例如，许多 GUI 应用程序只使用一个事件处理线程。

如果您想让所有 CPU 保持忙碌，您可以启动多个忙碌循环以最大化所有 CPU。

您通常想要的是减少延迟，或通过使用更多 CPU 来提高线程输出。除非这是一个目标，否则使用更多 CPU 对您没有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:39:51.330

如果线程真正***纯粹***受 CPU 限制，那么创建比可用于处理它们的内核（或虚拟内核）更多的线程是没有意义的。所以在四核机器上，创建不超过四个线程（可能只有三个，因为你的进程不是机器上唯一发生的事情）。在具有超线程（每个内核两个虚拟线程）的四核机器上，您可能会创建六个或七个。创建太多额外的线程（比如数百个）会导致不必要的上下文切换，如果你真的过度使用它可能会很昂贵。

反之，在多核机器上，*单线程*只能在一个核上运行。因此，在四核机器上，在单个线程上按顺序运行作业只会占用 25% 的 CPU 容量。

所以：并行运行作业，直到*可用*内核的数量，然后按顺序（在每个内核上）运行。

大警告：您的里程可能会有所不同。这个等式有很多输入，包括机器上发生的其他事情，特别是作业是否真的受 CPU 限制（与系统限制相反，例如 CPU 和 I/O 子系统等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:40:22.997

我猜你的程序需要内存访问。内存访问可能很慢，并且您当时确实想运行处理器。限制同时运行的线程数的常见解决方案是使用[线程池](http://docs.oracle.com/javase/tutorial/essential/concurrency/pools.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:40:56.777

> 在这种情况下，是否值得在一个线程中运行它（这意味着每个用户都会感觉到他的工作被毫不拖延地执行。还是顺序运行这些工作更好？

这很大程度上取决于工作。如果它是交互式的，那么立即运行它将为用户提供更好的界面。如果响应速度不是问题，那么您可能不想承担编写多线程程序的复杂性成本。

> 作为单独线程运行的问题是，同时运行的线程过多，导致 CPU 利用率超过 100%。

我不会担心这个。我们使用多线程的原因之一是我们可以利用多个处理器来实际更快地完成工作。在这种情况下，根据操作系统的不同，如果您使用的 CPU 不止一个完整的 CPU，您实际上可以看到超过 100% 的进程负载——这是预期的。此外，如果 CPU 超过 100%，操作系统会很好地处理它，除非您担心您的应用程序会占用更重要的应用程序的周期。

# c++ - DVD 或 CD 播放器？

> ID：11208514
> 
> 赞同：3
> 
> 时间：2012-06-26T13:35:44.473
> 
> 标签：c++, hardware, detection, wmi-query, optical-drive

我想知道我的播放器是 DVD 播放器还是 CD 播放器等...

我试过 ：

```
SELECT Drive, MediaType, Caption FROM Win32_CDROMDrive 
```

`MediaType`不能在 XP 上工作，在 7 上也不是很好。

我在我找到的 MediaType 中使用 1 个播放器（Cd Writer/DVD-ROM）的计算机（使用 Windows 7）上进行了尝试`Cd Writer`。

第二种解决方案：

如果我找到“DVD”，我会在“Caption”中搜索

我尝试了一个软件（[SIW - Windows 的系统信息](http://gtopala.com/)）并在我的 Player 属性中：

> 能力：
> 
> CD 阅读器：CD ROM、CD R、CD RW
> 
> CD 刻录机：CD R、CD RW
> 
> DVD 阅读器：DVD ROM、DVD R、DVD RW、DVD RAM
> 
> DVD刻录机：没有
> 
> 智能支持：否

所以，我想知道：使用 WMI 查询（或其他解决方案，我使用 C++），我是否可以获得相同的信息？

如果可以的话，那就太棒了！如果我不能，我只保留我的“字符串解析”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T16:30:15.223

要确定驱动器是 DVD 还是 CDROM ，您可以使用带有[IOCTL_STORAGE_GET_MEDIA_TYPES_EX控制代码的](http://msdn.microsoft.com/en-us/library/aa363413.aspx)[DeviceIoControl](http://msdn.microsoft.com/en-us/library/aa363216.aspx)函数，然后检查[GET_MEDIA_TYPES](http://msdn.microsoft.com/en-us/library/aa363264.aspx)结构的 DeviceType 字段的值。

试试这个样本

```
#include "stdafx.h"
#include <windows.h>
#include <winioctl.h>
#include <stdio.h>
#include <iostream>
using namespace std;

#define wszDrive L"\\\\.\\D:"
int wmain(int argc, wchar_t *argv[])
{
  BOOL bResult;     
  HANDLE hDevice = INVALID_HANDLE_VALUE;  // handle to the drive to be examined 
  hDevice = CreateFileW(wszDrive,          // drive to open
                        GENERIC_READ,             
                        FILE_SHARE_READ | // share mode
                        FILE_SHARE_WRITE, 
                        NULL,             // default security attributes
                        OPEN_EXISTING,    // disposition
                        0,                // file attributes
                        NULL);            // do not copy file attributes

  if (hDevice == INVALID_HANDLE_VALUE)    // cannot open the drive
  {
    return (FALSE);
  }

  UCHAR lpOutBuffer[2048];
  DWORD nOutBufferSize = sizeof(lpOutBuffer);
  ULONG lpBytesReturned;

  bResult = DeviceIoControl(hDevice,                       // device to be queried
                            IOCTL_STORAGE_GET_MEDIA_TYPES_EX, // operation to perform
                            NULL, 0,                       // no input buffer
                            &lpOutBuffer, nOutBufferSize, &lpBytesReturned,
                            NULL);       

  CloseHandle(hDevice);  
  PGET_MEDIA_TYPES pMediaTypes = (PGET_MEDIA_TYPES) lpOutBuffer;
  if (bResult) 
  {
      if (pMediaTypes->DeviceType==FILE_DEVICE_DVD)       
      {
          wprintf(L"DVD\n");
      }
      else
      if (pMediaTypes->DeviceType==FILE_DEVICE_CD_ROM)    
      {
          wprintf(L"CDROM\n");
      }
  } 
  else 
  {
    wprintf (L"Failed. Error %ld.\n", GetLastError ());
  }
  cin.get();
  return ((int)bResult);
} 
```

# windows - 允许非域用户查询 Active Directory

> ID：11208515
> 
> 赞同：2
> 
> 时间：2012-06-26T13:35:45.627
> 
> 标签：windows, web, active-directory, novell

我们的开发人员最近构建了一个新的内部“图像查看器”应用程序供我们的员工使用。图像查看器作为网站运行，并使用 Active Directory 对用户进行身份验证并控制允许用户查看的图像类型。

通过将网站作为模拟域用户运行，我进行了此设置并且工作正常。我现在面临的问题是所有图像都保存在非域共享上。如何使用域用户访问此共享？该共享位于 Novell Netware 6.5 服务器上。

或者，我可以以非域用户身份运行网站并连接到 Netware 服务器以检索图像，但是我无法查询 Active Directory。

我可以允许非域用户访问查询 AD 吗？我不希望在我的域控制器上允许匿名查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T21:52:12.880

[不可以，除非您将域配置为允许匿名查询](http://support.microsoft.com/kb/320528)，否则非域用户无法查询 Active Directory 。

根据 Web 应用程序中所有内容的设置方式，您可以插入一些代码来切换安全上下文并在查询发生时模拟域用户。

# osgi - 在 osgi 中使用 cxf：未找到提供程序 org.apache.cxf.jaxws.spi.ProviderImpl

> ID：11208518
> 
> 赞同：0
> 
> 时间：2012-06-26T13:35:54.460
> 
> 标签：osgi, cxf

我正在尝试发布一些 Web 服务（使用 EndpointImpl.publish()），但我收到此错误：

未找到提供程序 org.apache.cxf.jaxws.spi.ProviderImpl

安装了 cxf 捆绑包：

```
[  79] [Active   ] [Created  ] [   50] Apache CXF Bundle Jar (2.4.3.fuse-01-02) 
```

osgi:headers 的摘录显示了导入的包

```
Import-Package = 
javax.jws,
javax.persistence;version="[1.1,2)",
javax.servlet;version="[2.5,3)",
javax.xml.bind,
javax.xml.bind.annotation,
javax.xml.bind.annotation.adapters,
javax.xml.datatype,
javax.xml.namespace,
javax.xml.parsers,
javax.xml.transform,
javax.xml.transform.stream,
javax.xml.validation,
javax.xml.ws;version="[2.2,3)",
javax.xml.ws.soap;version="[2.2,3)",
javax.xml.ws.wsaddressing;version="[2.2,3)",
org.apache.commons.lang;version="[2.5,3)",
org.apache.commons.logging;version="[1.1,2)",
org.apache.cxf.jaxws;version="[2.4,3)",
org.apache.cxf.jaxws.spi;version="[2.4,3)",  <--- imported
org.apache.cxf.ws.addressing;version="[2.4,3)",
org.apache.felix.gogo.commands;version="[0.10,1)",
org.apache.openjpa.enhance;version="[2.2,3)",
org.apache.openjpa.util;version="[2.2,3)",
org.osgi.framework;version="[1.5,2)",
org.osgi.service.blueprint;version="[1.0.0,2.0.0)",
org.springframework.beans.factory.xml;version="[3.0,4)",
org.springframework.context;version="[3.0,4)",
org.springframework.context.support;version="[3.0,4)",
org.w3c.dom,
org.xml.sax

Require-Bundle = 
org.apache.cxf.bundle 
```

我不确定我还需要做什么。

如果它很重要。容器是 karaf 2.2.7

解决小熊维尼的回答：

1- cxf-bundle 正在导出这个包：org.apache.cxf.jaxws.spi;version="2.4.3.fuse-01-02"

2-捆绑已启动。错误发生在运行时。

3-清单是使用 maven-bundle-plugin 创建的，它应该创建整个列表

4-创建网络服务端点时发生错误：

```
TopologyIFPortType impl = new TopologyWS();
    String addressTopology = "http://localhost:" + port
            + "/nsp/webservice/topology";
    topologyEndpoint = (EndpointImpl) Endpoint.create(impl);
    topologyEndpoint.getFeatures().add(new WSAddressingFeature());
    topologyEndpoint.publish(addressTopology); 
```

完整的跟踪：

```
 javax.xml.ws.spi.FactoryFinder$ConfigurationError: Provider      org.apache.cxf.jaxws.spi.ProviderImpl not found
at javax.xml.ws.spi.FactoryFinder$2.run(FactoryFinder.java:130)
at javax.xml.ws.spi.FactoryFinder.doPrivileged(FactoryFinder.java:220)
at javax.xml.ws.spi.FactoryFinder.newInstance(FactoryFinder.java:124)
at javax.xml.ws.spi.FactoryFinder.access$200(FactoryFinder.java:44)
at javax.xml.ws.spi.FactoryFinder$3.run(FactoryFinder.java:211)
at javax.xml.ws.spi.FactoryFinder.doPrivileged(FactoryFinder.java:220)
at javax.xml.ws.spi.FactoryFinder.find(FactoryFinder.java:160)
at javax.xml.ws.spi.Provider.provider(Provider.java:43)
at javax.xml.ws.Endpoint.create(Endpoint.java:41)
at javax.xml.ws.Endpoint.create(Endpoint.java:37)
at org.opennaas.extensions.idb.webservice.WebServiceHolder.startTopology(WebserviceControl.java:78)
at org.opennaas.extensions.idb.webservice.WebServiceHolder.start(WebserviceControl.java:60)
at org.opennaas.extensions.idb.webservice.WebserviceControl.startWebservices(WebserviceControl.java:32)
at org.opennaas.extensions.idb.shell.StartWebservices.doExecute(StartWebservices.java:16)
at org.apache.karaf.shell.console.OsgiCommandSupport.execute(OsgiCommandSupport.java:38)
at org.apache.felix.gogo.commands.basic.AbstractCommand.execute(AbstractCommand.java:35)
at org.apache.felix.gogo.runtime.CommandProxy.execute(CommandProxy.java:78)
at org.apache.felix.gogo.runtime.Closure.executeCmd(Closure.java:474)
at org.apache.felix.gogo.runtime.Closure.executeStatement(Closure.java:400)
at org.apache.felix.gogo.runtime.Pipe.run(Pipe.java:108)
at org.apache.felix.gogo.runtime.Closure.execute(Closure.java:183)
at org.apache.felix.gogo.runtime.Closure.execute(Closure.java:120)
at org.apache.felix.gogo.runtime.CommandSessionImpl.execute(CommandSessionImpl.java:89)
at org.apache.karaf.shell.console.jline.Console.run(Console.java:240)
at java.lang.Thread.run(Thread.java:679) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:31:33.803

您使用的 CXF 版本似乎很旧。您应该尝试使用当前版本 2.6.1。在 2.6 中引入了许多 OSGi 改进。

您可以使用以下方式安装它： features:chooseurl cxf 2.6.1 features:install cxf

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T08:17:19.563

别担心，OSGi 让您可以完全访问哪个包使用哪个包等信息。您只需要知道如何要求系统为您提供调试问题所需的信息。不幸的是，我不熟悉 karaf 控制台命令，我更多地使用[ProSyst 的 mBeddedServer OSGi 框架](http://www.prosyst.com/index.php/de/html/content/97/Products-OSGi-Implementation/)，但由于所有这些都是 OSGi 中的标准，我可以告诉你要查找什么，你可以在 karaf 中找到所需的命令。

因此，请检查以下内容： 1\. Apache cxf 捆绑包是否安装成功？是否处于“活动”状态？（从你的帖子看来是这样）

1.  它导出的 org.apache.cxf.jaxws.spi 包的版本是什么？ **这与 cxf 捆绑版本不同！！！** 要查看包版本，请查看 cxf 包的清单，并查找 Export-package 标头。

2.  您的捆绑包是否已成功安装并启动？是否处于活动状态？如果在启动包期间出现错误“Provider not found”，那么您的依赖项与 cxf 包中提供的包不匹配，请参见第 2 点。但是，如果在运行时出现错误，则可能有多种原因：

3.  您尚未在清单中导入所有需要的包。尝试使用可以根据您的源代码为您生成清单的分析工具。或者：

4.  进行发布的代码位于系统类路径上并使用系统类加载器，在 OSGI 中，由于模块化和安全原因，它无法访问捆绑类加载器。检查系统类路径提供的内容，而不是 OSGi 包提供的内容。任何使用 Class.forName 或其他反射方法的东西都不能在模块化 OSGi 框架中工作。

还有其他可能性，但您需要提供更多信息。是否有异常堆栈跟踪？这段代码涉及哪些类，它们位于类路径的什么位置？等等

# javascript - “全窗口”幻灯片图像拉伸错误

> ID：11208519
> 
> 赞同：0
> 
> 时间：2012-06-26T13:35:54.567
> 
> 标签：javascript, jquery, html, css

如果您转到我正在处理的幻灯片[，](http://henrybuilt.com/slideshow/)您可以看到如果您调整浏览器窗口的大小，图像会调整大小并正确移动。

...除非您使浏览器窗口的宽度小于某个量（我不知道是什么定义了该量），然后它会拉伸图像而不是缩放它。我怎样才能解决这个问题？

这是我的调整大小代码：

```
winWidth = $(window).width();
winHeight = $(window).height();
ratio = winWidth/winHeight;
if(ratio > imgRatio){
    $('#curImg img').css({width:winWidth});
    imgWidth = winWidth;
    imgHeight = $('#curImg img').height();
    $("#curImg img").css({top: (-1*Math.round((imgHeight-winHeight)/2)) + "px"});
    $("#curImg").css({height: winHeight + "px"});
}else{
    $('#curImg img').css({height:winHeight});
    imgHeight = winHeight;
    imgWidth = $('#curImg img').width();
    $("#curImg img").css({left: (-1*Math.round((imgWidth-winWidth)/2)) + "px"});
    $("#curImg").css({width: winWidth + "px"});
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:52:11.130

您还可以查看这个 jQuery 插件： [http ://srobbin.com/jquery-plugins/backstretch/](http://srobbin.com/jquery-plugins/backstretch/)

或着眼于多种解决方案的 CSS 技巧：http: [//css-tricks.com/perfect-full-page-background-image/](http://css-tricks.com/perfect-full-page-background-image/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:46:53.757

您应该查看 tha[`background-size`](https://developer.mozilla.org/en/CSS/background-size)属性，尤其是`cover`值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:56:24.577

我写的东西有效：

```
//oWidth - container width
//oHeight - container height
//iWidth = image width
//iHeight = image height

    iRatio = iWidth/iHeight;
    wRatio = oWidth/oHeight;

    if(iRatio<wRatio){
        imageWidth = oWidth;
        imageHeight = Math.ceil(iHeight*(oWidth/iWidth));

    }
    else{
        imageHeight = oHeight;
        imageWidth = Math.ceil(iWidth*(oHeight/iHeight));

    }

    $('#backgroundResizeImage').css({ 
        'height': imageHeight,
        'width': imageWidth
    }); 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:01:22.293

我稍微重写了您的示例以进行独立演示。

与您的问题无关的两个注释。

1.  确保缓存任何 jQuery 对象。您不想重复获取项目，因为这会带来不必要的性能成本。
2.  我的示例显示了在窗口的调整大小事件中发生的这种情况 - 我不确定您是如何设置的。对于生产来说，限制绑定到诸如窗口调整大小事件之类的事件非常重要，因为它们可以以浏览器可以管理的速度被触发，这可能会导致不良后果。请参阅[John Resig 撰写的这篇出色的文章，](http://ejohn.org/blog/learning-from-twitter/)当时这让 Twitter 有点头疼。

最大的相关变化是我改变了设置图像高度和宽度的方式，具体取决于它们与窗口的比率。我认为这种方式更清晰一些，但这是主观的。但它确实有效！

[http://jsfiddle.net/L4k3s/2/](http://jsfiddle.net/L4k3s/2/)

```
var $window = $(window),
    $img = $('img'),
    imgRatio = $img.width() / $img.height();

$window.on('resize', function (event) {
    var imgWidth = $img.width(),
        imgHeight = $img.height(),
        winWidth = $window.width(),
        winHeight = $window.height(),
        ratio = winWidth / winHeight;

    // The image is wider than the window
    if (ratio < imgRatio) {
        $img.width(winWidth);
        $img.height(winWidth / imgRatio);
        $img.css({
            left: 0,
            top: (-1 * Math.round((imgHeight - winHeight) / 2)) + "px"
        });
    // The image is taller than the window
    } else {
        $img.width(winHeight * imgRatio);
        $img.height(winHeight);
        $img.css({
            left: (-1 * Math.round((imgWidth - winWidth) / 2)) + "px",
            top: 0
        });
    }
}); 
```

​</p>

# iphone - Apple 批准

> ID：11208521
> 
> 赞同：4
> 
> 时间：2012-06-26T13:36:00.137
> 
> 标签：iphone, ios, app-store

> **可能重复：**
> [苹果在批准应用程序时是否查看实际源代码？](https://stackoverflow.com/questions/3186648/does-apple-view-the-actual-source-code-when-approving-apps)

所以我正在为我的第一次提交到 App Store 做准备，但在我提交之前我有一两个快速的问题。

1) 首先 - 提交时，Apple 会查看代码并验证其正确性还是只是测试应用程序本身？

2）如果Apple确实在仔细查看代码，您是否遵循Apple建议的范例会影响该应用程序是否被接受？例如; 在我的程序中，我经常使用`[self dismissViewControllerAnimated::]`而不是 Apple 指定的使用委托的方式让呈现的 VC 解雇其呈现的 VC。

就像从可能已经经历过这个过程并可以就体验提供反馈的人那里获得反馈一样。谢谢你的时间！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T13:38:45.570

Apple 不会查看您的代码。您提交的只是您的二进制应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:43:19.260

您不会提交源代码，所以请耐心等待，没有人会偷走您的酷模式 :)

但是，推荐一种或另一种方法通常是有充分理由的，您最好考虑遵循 Apple 的建议，以免出现在许多已弃用、缓慢甚至禁用的功能中。

另一点是，虽然他们没有直接查看您的代码，但他们仍然能够捕获使用的方法符号，这使他们能够检测私有 API 的使用情况，有时应用程序会因为您的方法与私有方法匹配而被拒绝来自签名的 API 方法，这并不经常发生，但您最好准确。

为您提供的另一个免费建议 - 将 .dsym 文件存储在某处，它将帮助您符号化稍后可能从报告文件中出现的崩溃（您还需要应用程序二进制文件）。

# sql - 从在经过身份验证的用户上下文中运行的 ASMX 使用集成安全性访问 SQL Server

> ID：11208522
> 
> 赞同：0
> 
> 时间：2012-06-26T13:36:02.857
> 
> 标签：sql, asmx, windows-authentication

我有一个在 Windows 身份验证模式下运行的 Web 服务。

我有一个应用程序来发送 asmx 连接：

```
BasicHttpBinding basicHttpBinding = new BasicHttpBinding();
BasicHttpBinding.Security.Mode = BasicHttpSecurityMode.TransportCredentialOnly;
basicHttpBinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Windows;

EndpointAddress endpoint = new EndpointAddress("http://xyzts/Service.asmx");
WS_SPIL.ServiceSoapClient client = new WS_SPIL.ServiceSoapClient(basicHttpBinding, endpoint);

client.ClientCredentials.Windows.AllowedImpersonationLevel = Sytem.Security.Principal.TokenImpersonationLevel.Impersonation;
client.ChannelFactory.Credentials.Windows.ClientCredential = System.Net.CredentialCache.DefaultNetworkCredentials; 
```

我执行以下代码（在 ASMX 上）： User.Identity.Name 返回我的 Windows AD 登录名。

到目前为止，一切都很好。

现在我想用用户登录连接到数据库。但我收到当前用户（IIS 用户）没有连接到 sql 服务器的权限的错误消息。

```
try
{
    SqlConnectionStringBuilder csb = new SqlConnectionStringBuilder();
    csb.DataSource = "sqlservername";
    csb.InitialCatalog = "DBName";
    csb.IntegratedSecurity = true;

    SqlConnection conn = new SqlConnection();
    conn.ConnectionString = csb.ToString();
    conn.Open();
    conn.Close();

    return "ok";
}
catch (Exception ex)
{
    return ex.ToString();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T20:52:34.613

这听起来像是“[双跳问题](http://www.bing.com/search?q=double-hop%20problem&qs=n&form=QBRE&pq=double-hop%20problem&sc=1-18&sp=-1&sk=)”的一个案例。基本上，除非您实施了 Kerberos，否则您无法让 SQL Server 使用模拟凭据。

# fullcalendar - 议程查看 allDaySlot 和 AllDayText false

> ID：11208528
> 
> 赞同：1
> 
> 时间：2012-06-26T13:36:20.503
> 
> 标签：fullcalendar

我想`allDay`在议程视图中禁用该选项。我希望它在周视图和月视图中可见。

现在我有这个：

```
var calendar = $('#calendar').fullCalendar({
    slotMinutes: 15,
    defaultView: 'agendaWeek',
    header: {
        left: 'prev,next today',
        center: 'title',
        right: 'month,agendaWeek,agendaDay'
    },
    selectable: true,
    selectHelper: true
}); 
```

还有另外 200 行 js，但这是我对日历对象的初始化。

我可以为 viewObject 构造函数执行以下代码吗？

```
view: {
        view:'agendaDay', 
        allDaySlot:false,
        allDayText:false
        }, 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:40:24.923

您实际上是在寻找 fullCalendar 的选项设置器。所以你可以做这样的事情：

```
viewDisplay: function(view) {
    if( view.name == 'agendaDay' ){
        $('#calendar').fullCalendar('allDaySlot',false); // Not supported yet
    }
} 
```

我也一直梦想着这一点，但不幸的是，FullCalendar 还不允许即时设置选项。但是以下两个链接可能对您有用：

[http://code.google.com/p/fullcalendar/issues/detail?id=293](http://code.google.com/p/fullcalendar/issues/detail?id=293)

[https://github.com/arshaw/fullcalendar/pull/25](https://github.com/arshaw/fullcalendar/pull/25)

# asp.net-mvc-3 - Razor View 必须派生 WebPageView 但我有一个参考

> ID：11208532
> 
> 赞同：1
> 
> 时间：2012-06-26T13:36:45.337
> 
> 标签：asp.net-mvc-3, razor, mef

这是我的剃刀观点：

```
@inherits System.Web.Mvc.WebViewPage

<h2>Index</h2> 
```

它可以识别`@inherits System.Web.Mvc.WebViewPage`，但是当我尝试从我的主应用程序运行它时，它说视图必须从 WebViewPage 派生。

# jquery - 使用 ajax 更改 ASP.NET 服务器控件

> ID：11208535
> 
> 赞同：0
> 
> 时间：2012-06-26T13:36:49.887
> 
> 标签：jquery, asp.net, ajax

我想构建一个应用程序，当单击地图上的某个点时，它会发送一个 ajax 请求来更改我页面上的一些服务器控件：

```
$.post("Default.aspx",
                       { latLng: event.latLng }); 
```

在同一页上：

```
<asp:Panel runat="server" Visible="false" ID="SaveForm">
        <asp:Label runat="server" Text="Save your result:" Font-Size="X-Large"></asp:Label><br /><br />
        <asp:TextBox runat="server" ID="Latitude" ReadOnly="true"></asp:TextBox><br />
        <asp:TextBox runat="server" ID="Longitude" ReadOnly="true"></asp:TextBox><br />
        <asp:TextBox runat="server" ID="Score" ReadOnly="true"></asp:TextBox><br />
        <asp:TextBox runat="server" ID="Comment" Width="500px" Height="200px"></asp:TextBox>
        <asp:Button runat="server" OnClick="Save" />
    </asp:Panel> 
```

aspx.cs：

```
protected void Page_Load(object sender, EventArgs e)
        {
            if (Session["userId"] == null)
                Response.Redirect("LoginForm.aspx");

            if (Request["latLng"] != null)
            {
                String latLng = Request["latLng"];

                SaveForm.Visible = true;

                char[] delimiterChars = { '(', ',', ')'};
                String[] numbers = latLng.Split(delimiterChars);
                Latitude.Text = numbers[0];
                Longitude.Text = numbers[1];
                Score.Text = (getScore(float.Parse(numbers[0]), float.Parse(numbers[1]))).ToString();
            }
        } 
```

当然这是行不通的，因为它甚至不合逻辑。但是从这段代码中，您可以了解我正在尝试做什么并帮助我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:58:18.720

我认为这个微不足道的任务的 WCF 服务将是一个矫枉过正。请考虑使用 WebMethods。您可以在可通过 javascript 访问的代码隐藏上定义 WebMethod

前任：

页面.aspx.cs

```
[WebMethod]
public static void wmSomeMethod(string param)
{
    string test=param;
} 
```

页面.aspx

```
function callPageMethod(param)
{
    PageMethods.wmSomeMethod(param, onSuccess, onError);
} 
```

请注意，您需要页面上的 ScriptManager 才能使用页面方法。

[编辑：这里](http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/)讨论了 jQuery 的替代方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:53:12.997

1.  在服务器端制作 WCF 服务`webHttpBinding`
2.  制作 jQuery 事件 onlclick 或您需要的东西
3.  使用 jQuery ajax 调用调用您的 WCF 服务
4.  将结果应用于您的控件

[这是一个使用 jQuery 调用 WCF 服务的示例](http://weblogs.asp.net/dotnetstories/archive/2011/12/27/using-jquery-to-call-a-wcf-service-in-an-asp-net-application.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:06:14.660

如果您希望它通过 AJAX 请求工作，您有两个选择。

一种是使用 Asp.Net 更新面板（不推荐，但可能最简单）。这将自动对服务器端的事件处理程序进行 ajax 回发，并允许您对更新面板内的服务器控件背后的代码进行更改，这些更改将被传播回用户。[这是](http://www.asp.net/web-forms/tutorials/aspnet-ajax/understanding-asp-net-ajax-updatepanel-triggers)一篇关于更新面板的好文章。但是，请注意，我们在我工作的地方使用过它们，但对它们并不满意，因为它们比纯 AJAX 更重量级和更不和谐。

二，从您的伪代码看来，您实际上不需要服务器提供任何东西，您只希望您的纬度和经度来修改您的 HTML。如果是这种情况，您可以编写直接修改您的 HTML 以显示您想要的内容的 JavaScript。

对于选项二，重要的是要知道服务器控件并不神奇。一旦它们成为客户端，它们就像页面上的任何其他内容一样被表示为 HTML 标记，并且可以像其他任何内容一样使用 JavaScript 进行修改。

如果您确实需要在修改客户端看到的内容的同时进行某种操作服务器端，我建议您编写一个轻量级的 Web 服务来侦听 ajax 请求并执行您需要完成的操作，而不是使用更新面板。

# rss - Sencha Touch 2：如何将 RSS 提要显示为列表？

> ID：11208539
> 
> 赞同：0
> 
> 时间：2012-06-26T13:36:56.703
> 
> 标签：rss, touch, extjs, feedburner

我想创建一个简单的应用程序，它使用 Sencha Touch 2 和 RSS 源向我显示我最喜欢的新闻网站的最新故事列表。

如何从 rss-feed 获取数据，然后将其显示为列表，显示标题、作者、日期和内容？

我可以获得最新新闻报道的列表，但我只能设法显示每个项目的标题/标题，而不是作者、日期、片段等。这是我的代码：

**1 个模型，1 个商店，1 个视图，1 个 app.js：**

```
//The store
Ext.define("NewsApp.store.EbStore", {
extend: "Ext.data.Store",
requires: ["Ext.data.proxy.JsonP", "Ext.dataview.List" ],
config: {
    model: "NewsApp.model.NewsListModel",
    autoLoad: true,
    proxy: {
        type: 'jsonp',
        url: 'https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=5&q=http://feeds.feedburner.com/newsapp_pol',
        reader: {
            type: 'json',
            rootProperty: 'responseData.feed.entries'
            }
        }
    }    
});

//The Model
Ext.define("NewsApp.model.NewsListModel", {
extend: "Ext.data.Model",
config: {
    fields: [
    {name: 'title', type: 'auto'},
    {name: 'author', type: 'auto'},
  ]
} 
});

//The view
Ext.define("NewsApp.view.NewsList", {
extend: "Ext.Container",
requires: "Ext.Toolbar",
alias: "widget.newslistview",

config: {
    layout: {
        type: 'fit'
    },

    items: [{
        xtype: "toolbar",
        title: "Danske Nyheder",
        docked: "top",
        items: [
                {
                    xtype: 'spacer'
                },
                {
                    xtype: "button",
                    text: "Indstillinger",
                    ui: "action",
                    id: "settingsButton",
                    iconMask: true,
                    iconCls: 'settings'
                },
                  {
                    xtype: "button",
                    text: "Refresh",
                    ui: "action",
                    id: "refreshButton",
                    iconMask: true,
                    iconCls: 'refresh'
                  }
                ]
    },
    {
        xtype: "list",
        store: "EbStore",
        itemId:"EbList",
        onItemDisclosure: true,
        itemTpl: '{title}'
    }
    ],
    }
});

// And the app.js just for kicks
Ext.application({
name: "NewsApp",
models: ["NewsListModel"],
stores: ["EbStore"],
views: ["NewsList"],

launch: function () {
    console.log("App starts");
    var newsListView = {
        xtype: "newslistview"
    };

    Ext.Viewport.add([newsListView]);
}
}); 
```

使用此代码，我可以很好地显示 rss 项目的标题。但是如果我将 {title} 更改为 {author}，列表项会在我的视图中创建，但没有任何内容。我想阅读的 RSS 使用的是普通标准：http: [//feeds.feedburner.com/newsapp_pol](http://feeds.feedburner.com/newsapp_pol)

那么，我如何不仅显示标题并访问 rss 的其余部分？
我想这归结为我不了解代理代码中正在捕获哪些数据，或者究竟是如何或以什么格式捕获的。

有人可以帮忙吗？:-)

我已经查看了这两个 Sencha Touch RSS 阅读器的示例，两者都非常出色，只是代码太高级了，我无法理解：
[http ://www.sencha.com/apps/rssreader/](http://www.sencha.com/apps/rssreader/)
[https://github .com/AndreaCammarata/FeedBurner-RSS-Reader](https://github.com/AndreaCammarata/FeedBurner-RSS-Reader)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:39:15.477

巨魔，

如果你想看看你的google feed的数据响应，我建议你用[json美化](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/gfx/demos/beautify.html)器看一下json数据，这样更容易阅读。[首先将您的google feed url](https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=5&q=http://feeds.feedburner.com/newsapp_pol)粘贴到浏览器的地址栏中。复制生成的 json 响应 - 并将其粘贴到美化器中。这将为您提供响应数据中数据字段的结构化视图。

当我尝试它时，第一个条目看起来像这样：

```
 "title": "Over 50 såret under kampe i Kosovo",
                "link": "http://politiken.dk/udland/ECE1672568/over-50-saaret-under-kampe-i-kosovo/",
                "author": "",
                "publishedDate": "Thu, 28 Jun 2012 12:09:18 -0700",
                "contentSnippet": "35 politifolk og 20 serbere blev såret, da en gruppe serbere stødte sammen i det etnisk delte Kosovo.",
                "content": "35 politifolk og 20 serbere blev såret, da en gruppe serbere stødte sammen i det etnisk delte Kosovo.",
                "categories": [] 
```

我注意到所有条目的“作者”字段都是空的，这可以解释为什么你得到一个空列表。

这应该可以帮助您了解提要中的数据结构并在您的代码中创建匹配的引用。

干杯，拉斯穆斯

# arrays - Grails中的全局数组？

> ID：11208542
> 
> 赞同：1
> 
> 时间：2012-06-26T13:37:03.360
> 
> 标签：arrays, grails, controller, global-variables

有没有办法从 grails 项目中的任何控制器创建一个既可获取又可设置的数组？任何想法表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:43:35.000

您可以创建一个数组并将其放入引导程序中的 grailsApplication 中（或懒惰地创建它）。在任何控制器中，您都可以使用 grailsApplication 中的该数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:43:16.240

您可以定义/初始化一个数组，`Config.groovy`然后`grailsApplication.config`在您的任何控制器中使用它来访问它。这只是我想不到的一种方式......

**更新**

这是另一个使用 Bootstrap 的简单示例：

**引导程序.groovy**

```
class BootStrap {
    def grailsApplication

    def init = { servletContext ->
        grailsApplication.config.myArray = []
    }
    def destroy = {
    }
} 
```

**一些控制器**

```
class TestController {

    def addItem() {
        grailsApplication.config.myArray << "Value ${grailsApplication.config.myArray.size()}"
        render grailsApplication.config.myArray
    }
} 
```

不过，您需要小心使用这种方法。Groovy 默认使用 ArrayList，它不是线程安全的，容易出现并发修改异常。如果您需要并发执行，您需要将您的添加/删除包装在同步方法中，或者使用事件处理程序或类似的东西发布异步事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:45:42.173

当您说“可获取和可设置”时，您的意思是您希望任何控制器能够修改数组的各个元素，或者您希望控制器能够用另一个数组完全替换数组并使更改对其他人可见控制器？

“Grails 方式”是将数组封装在服务中并通过它访问它，服务处理任何同步所需的同步以保持一致 -如果您有可能存在的数据，您肯定需要*某种*同步由多个线程同时变异。或者将数据存储在您的数据库中并让它处理事务更新。

为了给出更具体的答案，我需要知道这个共享数组打算支持哪些用例。

# c# - 如何降低 if-else 语句中的圈复杂度

> ID：11208544
> 
> 赞同：3
> 
> 时间：2012-06-26T13:37:06.023
> 
> 标签：c#, cyclomatic-complexity

在这种情况下，您将如何降低循环复杂度

```
if (Name.Text == string.Empty)
    Name.Background = Brushes.LightSteelBlue;

else if(Age.Text == string.Empty)
    Age.Background = Brushes.LightSteelBlue;

else if(...)
    ...

else
{
    // TODO - something else
} 
```

假设我有 30 个或更多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:41:22.630

看起来您对每个“文本框”执行相同的逻辑（至少我认为它们是文本框）。我建议将它们全部放入一个集合并执行以下逻辑：

```
// Using var, since I don't know what class Name and Age actually are
// I am assuming that they are most likely actually the same class
// and at least share a base class with .Text and .BackGround
foreach(var textBox in textBoxes)
{
    // Could use textBox.Text.Length > 0 here as well for performance
    if(textBox.Text == string.Empty)
    {
        textBox.Background = Brushes.LightSteelBlue;
    }
} 
```

**注意：**这确实会稍微改变您的代码，因为我注意到您仅在前一个没有空文本时才检查一个“TextBox”的值。如果你想保持这个逻辑，只需在后面加上一个`break;`语句`textBox.Background = Brushes.LightSteelBlue;`，只有第一个空的“TextBox”才会设置它的背景颜色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:42:38.247

例如对于**这个具体**案例，您可以

*   定义一个`Dictionary<string, dynamic> dic`其中 KEY 是*string-value*，而 VALUE 是动态的（*Name* , *Age* ...whatever）

*   做 dic[stringValue].Background = Color.LightSteelBlue;

只是一个例子。

您*可能*要选择`dynamic`或不选择。可能是更直观和易于理解的东西，但基本思想是：

根据`if`的*右值*使用带有键的字典， 并像某个操作/方法/对象的值一样。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:48:27.640

我完全同意 svick 的评论。在某些情况下，以下方法可能很好（但不能降低圈复杂度，通常是为了创建可插入的决策者）：

```
public class SwitchAction{
  public Func<bool> Predicate { get; set; }
  public Action TheAction { get; set; }
}

public List<SwitchAction> SwitchableActions = new List<SwitchAction>();

public void InitialiseSwitchableActions()
{
   SwitchableActions.AddRange(new[] {
     new SwitchAction() { Predicate = () => Name.Text == string.Empty, 
                          TheAction = () => Name.Background = Brushes.LightSteelBlue },
     new SwitchAction() { Predicate = () => Age.Text == string.Empty, 
                          TheAction = () => Age.Background = Brushes.LightSteelBlue },
   });
}

public void RunSwitchables()
{
  var switched = SwitchableActions.FirstOrDefault(s => Predicate());

  if(switched != null)
    switched.TheAction();
  else
    //TODO: something else.
} 
```

当然 - 如果实际上这些操作不是互斥的，您必须稍微更改最后一个方法：

```
public void RunSwitchables()
{
   bool runCatchAll = true;
   foreach(var switched in SwitchableActions.Where(a => a.Predicate())
   {
     switched.TheAction();
     runCatchAll = false;
   }

   if(runCatchAll)
     //TODO: Something else.
} 
```

这些中的任何一个都更具可读性吗？嗯……应该不会吧。

# position - 文本的字体和垂直位置

> ID：11208545
> 
> 赞同：0
> 
> 时间：2012-06-26T13:37:07.170
> 
> 标签：position, font-face, padding, margin

我想在我的网站上使用 After Disaster 字体，但我无法在不同的浏览器中实现显示文本的相同垂直位置。甚至更多 - 它也依赖于系统。你可以测试一下：

[http://jsfiddle.net/z7rby/1/](http://jsfiddle.net/z7rby/1/)

在 Linux 上，Google Chrome 显示的文本比 Firefox 和 Opera 高约 1 个像素。在 Windows 上，Google Chrome 将其显示在背景中间。我能用它做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T09:10:25.303

没有办法解决这个问题。您必须接受字体在不同系统上的呈现方式会略有不同，并找到另一种方法来实现您的视觉目标。

您可以通过定位 CSS 来控制布局，例如宽度、高度，但不是字体渲染。

如果该级别的控制不是“足够好”，那么您可以编写依赖于浏览器的 CSS（在线提供教程）来弥补差异。

但请记住，所有计算的目标是“足够好”：完美并不划算！

一旦你达到了一个需要进一步改进需要付出一定努力的水平，但还有更重要的事情需要花费这些努力，那就是你完成的时刻。

# bash - centos+nodejs+forever(startstop)

> ID：11208549
> 
> 赞同：2
> 
> 时间：2012-06-26T13:37:17.520
> 
> 标签：bash, node.js, centos, forever

美好的一天，我对永远启动\停止脚本有一些问题。

CentOS 6.2
内核 2.6.32-220.el6.x86_64
nodejs v0.6.19
npm v 1.1.24
forever@0.9.2

我创建 nologin 用户来运行我的脚本

**/etc/passwd** node:x:501:501::/usr/sbin/nologin:/bin/bash:/usr/local/bin/node:/usr/local/bin/forever:/usr/local/bin: /usr/local/lib/node_modules/forever/bin

我创建脚本并命名为 hello2.js

```
 #!/bin/bash
echo "aight" 
```

并尝试运行

```
 [max@localhost Desktop]$ forever start hello2.js
    info: Forever processing file: hello2.js
    [max@localhost Desktop]$ forever list
    info: Forever processes running
    data: uid command script forever pid logfile uptime
    data: [0] n4EB node hello2.js 2675 2728 /home/max/.forever/n4EB.log 0:0:0:0.130 
```

一切都好。接下来我为 hello2.js 创建启动-停止脚本并将他命名为 node

============================

```
#!/bin/bash

#proccessname: node

USER=node
PWD=node
node=node
forever=forever

start() {

         forever start -l forever.log -o out.log -e err.log /home/max/Desktop/hello2.js

            }

stop(){

      /usr/local/bin/forever stopall
     }

  restart() {
   stop
   start
    }
    status(){
    /usr/local/bin/forever list
    }

    #see how we were called
    case "$1" in
    start)
    start
    ;;
    stop)
    stop
    ;;
    restart)
    stop
    start
    ;;
    status)
    status
    ;;
    *)
    echo $ "usage $0 {start | stop | status | restart}"
    exit 1
    esac
    exit 0 
```

========================================== 使其可执行。

接下来我想看看这是如何工作的

```
[max@localhost Desktop]$ ./node
$ usage ./node {start | stop | status | restart}

[max@localhost Desktop]$ ./node start
info: Forever processing file: /home/max/Desktop/hello2.js

[max@localhost Desktop]$ ./node status
**info: No forever processes running** 
```

但

```
[max@localhost Desktop]$ forever start hello2.js
info: Forever processing file: hello2.js
[max@localhost Desktop]$ forever list
info: Forever processes running
data: uid command script forever pid logfile uptime
data: [0] n4EB node hello2.js 2675 2728 /home/max/.forever/n4EB.log 0:0:0:0.130
[max@localhost Desktop]$ 
```

我的错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T18:10:38.993

尝试

```
nohup forever start -l forever.log -o out.log -e err.log /home/max/Desktop/hello2.js & 
```

# java - 按类型键入集合

> ID：11208556
> 
> 赞同：0
> 
> 时间：2012-06-26T13:37:56.640
> 
> 标签：java, android

我正在寻找实现某个接口的对象集合，但我希望集合中的每个具体类型只有一个。

```
collection of implementers of dog:
 - instance of dachshund
 - instance of beagle
 - instance of corgi 
```

在 .NET 中，有一个“KeyedByTypeCollection”。Java中是否存在类似的东西，我可以在Android上使用它？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:28:22.910

如果你愿意使用第三方库——而且你不关心维护秩序[——Guava](https://code.google.com/p/guava-libraries/) [`ClassToInstanceMap`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ClassToInstanceMap.html)似乎适用于此。

```
ClassToInstanceMap<Dog> map = MutableClassToInstanceMap.create();
map.putInstance(Corgi.class, new Corgi("Spot"));
map.putInstance(Beagle.class, new Beagle("Lady"));
Corgi corgi = map.getInstance(Corgi.class); // no cast required 
```

（披露：我为 Guava 做出了贡献。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:45:22.077

你应该看看泛型。例如： `List<Dogs> dogList = new ArrayList<Dogs>();`

**编辑：**要在您的集合中只有唯一实例，您应该使用`Set<Dogs> dogList = new HashSet<Dogs>();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:45:54.083

我认为您需要一个自定义的 HaspMap 来维护具有相同键的多个值，

因此，创建一个简单的类来扩展 HashMap 并将值放入其中。

```
public class MyHashMap extends LinkedHashMap<String, List<String>> {

    public void put(String key, String value) {
        List<String> current = get(key);
        if (current == null) {
            current = new ArrayList<String>();
            super.put(key, current);
        }
        current.add(value);
    }
} 
```

现在，创建 MyHashMap 的实例并将值放入其中，如下所示，

```
 MyHashMap hashMap = new MyHashMap();
        hashMap.put("dog", "dachshund");
        hashMap.put("dog", "beagle");
        hashMap.put("dog", "corgi");
        Log.d("output", String.valueOf(hashMap)); 
```

**输出**

```
{dog=[dachshund, beagle, corgi]} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:54:28.627

这可能是您正在寻找的：查看代码中的注释

```
// two Dog(interface) implementations
        // Beagle, Dachshund implements Interface Dog.
        final Dog d1 = new Beagle();
        final Dog d2 = new Dachshund();

        // here is your collection with type <Dog>
        final Set<Dog> set = new HashSet<Dog>();
        set.add(d1);
        set.add(d2);

        // see output here
        for (final Dog d : set) {
            System.out.println(d.getClass());
        }

        // you can fill them into a map
        final Map<Class, Dog> dogMap = new HashMap<Class, Dog>();
        for (final Dog d : set) {
            // dog instances with same class would be overwritten, so that only one instance per type(class)
            dogMap.put(d.getClass(), d); 
        } 
```

system.out.println 行的输出类似于：

```
class test.Beagle
class test.Dachshund 
```

# objective-c - 脸书连接。点击登录

> ID：11208557
> 
> 赞同：2
> 
> 时间：2012-06-26T13:37:58.293
> 
> 标签：objective-c, ios, facebook

我有一个非常简单的问题。

在 FB 教程[https://developers.facebook.com/docs/mobile/ios/build/](https://developers.facebook.com/docs/mobile/ios/build/)中，它开始在内部登录`didFinishLaunchingWithOptions`——在应用程序启动后。

我需要点击登录，然后等待`callback`并在 FB 墙上发送消息。我认为 Hackbook 应用程序示例设计应用程序对于这个目的来说太复杂了。

实现这一目标的最简单方法是什么？

**UPD：**我遵循了 Hackbook 示例，但`ViewControllers`仍然没有得到`callback`:(

yAppDelegate.h：

```
    ＃进口
    #import "FBConnect.h"

    @interface yAppDelegate : UIResponder
    {
        脸书 *脸书；

    }

    @property (strong, nonatomic) UIWindow *window;
    @property（非原子，保留）Facebook *facebook；

    @结尾

```

yAppDelegate.m：

```
    #import "yAppDelegate.h"
    #import "yViewController.h"

    静态 NSString* kAppId = @"350435425024264";

    @implementation yAppDelegate

    @synthesize 窗口 = _window;
    @synthesize 脸书；

    - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
    {    
        yViewController *viewController = [[yViewController alloc] init];

        facebook = [[Facebook alloc] initWithAppId:kAppId andDelegate:viewController];

        NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
        if ([defaults objectForKey:@"FBAccessTokenKey"] && [defaults objectForKey:@"FBExpirationDateKey"]) {
            facebook.accessToken = [默认 objectForKey:@"FBAccessTokenKey"];
            facebook.expirationDate = [默认 objectForKey:@"FBExpirationDateKey"];
        }

        返回是；
    }

    - (void)applicationDidBecomeActive:(UIApplication *)application {
        [[self facebook]extendAccessTokenIfNeeded];
    }

    - (BOOL)应用程序:(UIApplication *)应用程序句柄OpenURL:(NSURL *)url {
        返回 [self.facebook handleOpenURL:url];
    }

    - (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication 注解:(id)annotation {
        返回 [self.facebook handleOpenURL:url];
    }

```

yViewController.h：

```
    ＃进口
    #import "FBConnect.h"

    @interface yViewController : UIViewController
    {
        NSArray *权限；
    }

    @property (nonatomic, 保留) NSArray *permissions;

    @结尾

```

yViewController.m

```
    #import "yViewController.h"
    #import "yAppDelegate.h"
    #import "FBConnect.h"

    @interface yViewController ()
    @结尾

    @implementation yViewController
    @synthesize 权限；

    - (IBAction)buttonPressed:(UIButton *)sender {

        NSLog(@"按下按钮！");

        权限 = [[NSArray alloc] initWithObjects:@"offline_access", nil];

        yAppDelegate *delegate = (yAppDelegate *)[UIApplication sharedApplication].delegate;
        if (![[delegate facebook] isSessionValid]) {
            [[代表 facebook] 授权：权限]；
        } 别的 {
            //[self showLoggedIn];
        }
        NSLog(@"登录！！");

    }

    - (void)viewDidLoad
    {
        [超级视图DidLoad];
        // 在加载视图后做任何额外的设置，通常是从一个 nib。
    }

    - (void)viewDidUnload
    {
        [超级 viewDidUnload];
        // 释放主视图的所有保留子视图。
    }

    - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
    {
        返回（接口方向！= UIInterfaceOrientationPortraitUpsideDown）；
    }

    #pragma mark - FBSessionDelegate 方法
    /**
     * 当用户登录成功时调用。
     */
    - (void)fbDidLogin {
        NSLog(@"登录了");
    }

    -(void)fbDidExtendToken:(NSString *)accessToken expiresAt:(NSDate *)expiresAt {
        NSLog(@"令牌扩展");
    }

    /**
     * 当用户取消授权对话框时调用。
     */
    -(void)fbDidNotLogin:(BOOL) 取消 {
        NSLog(@"fbDidNotLogin");
    }

    /**
     * 请求注销成功时调用。
     */
    - (void)fbDidLogout {

        NSLog(@"fbDidLogout");

        // 删除保存的授权信息，如果存在并且是
        // 可以清除它（注销、会话无效、应用未经授权）
        NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
        [默认 removeObjectForKey:@"FBAccessTokenKey"];
        [默认 removeObjectForKey:@"FBExpirationDateKey"];
        [默认同步]；

    }

    /**
     * 会话过期时调用。
     */
    -（无效）fbSessionInvalidated {

        NSLog(@"fbSessionInvalidated");

        [自我 fbDidLogout];
    }

    #pragma mark - FBRequestDelegate 方法
    /**
     * 当 Facebook API 请求返回响应时调用。
     *
     * 此回调使您可以访问原始响应。之前叫过
     * (void)request:(FBRequest *)request didLoad:(id)result,
     * 传递解析的响应对象。
     */
    - (void)request:(FBRequest *)request didReceiveResponse:(NSURLResponse *)response {
        //NSLog(@"收到响应");
    }

    /**
     * 当请求返回并且其响应已被解析为时调用
     * 一个东西。
     *
     * 结果对象可能是字典、数组或字符串，具体取决于
     * 关于 API 响应的格式。如果您需要访问原始响应，
     * 采用：
     *
     * (void)request:(FBRequest *)request
     * didReceiveResponse:(NSURLResponse *)response
     */
    - (void)request:(FBRequest *)request didLoad:(id)result {
        NSLog(@"-(void)request");
    }

    /**
     * 当错误阻止 Facebook API 请求完成时调用
     * 成功地。
     */
    - (void)request:(FBRequest *)request didFailWithError:(NSError *)error {
        NSLog(@"Err message: %@", [[error userInfo] objectForKey:@"error_msg"]);
        NSLog(@"错误代码: %d", [错误代码]);
    }

@结尾

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:02:23.587

以与 FB 教程显示的完全相同的方式进行操作，只需将登录代码移动到按钮事件或您想要触发它的任何内容中。

# php - 通过 php 通过 ip 检查网站是否可用

> ID：11208558
> 
> 赞同：0
> 
> 时间：2012-06-26T13:38:01.977
> 
> 标签：php, ip

希望你能帮助我。

我正在尝试通过他们的 IP 地址检查一个站点（实际上是多个站点，我可以自己做这部分：p）是在线还是离线。我搜索了一下，发现了两种方法来做到这一点

*   通过 exec() 使用 ping 命令

*   使用 fsockopen()

想知道哪种方法更好，更可靠。还是我缺少另一种方法？

我读到使用 curl 库是最好的方法，但我不知道如何使用 IP 地址（而不是链接）使其工作。另外，我宁愿不使用未预装的库，除非它有很大的不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:56:35.460

这实际上取决于您所说的“在线”是什么意思。Ping 会告诉您是否有具有给定 IP 地址的主机响应 ping 请求（大多数会，但有些配置不响应。或者在您和主机之间的某处可能有一个无用的路由器，它不会传递数据包）

如果你真的想知道主机是否是一个正常工作的 HTTP 服务器，像 curl 这样的东西会更有用。例如，您可以检查返回的状态是否为 200。

# visual-studio-2010 - 视觉工作室。如何手动中断调试线程

> ID：11208561
> 
> 赞同：0
> 
> 时间：2012-06-26T13:38:08.997
> 
> 标签：visual-studio-2010, debugging, break

我在调试时将我的 Visual Studio 项目附加到一个应用程序。

有时我需要停止调试，但它也会关闭附加的进程。这不方便，因为加载需要很长时间。

VS 的“全部中断”按钮显示为灰色并禁用。

我可以解决它吗？

# jquery-ui - 具有 jQuery-AJAX 加载功能的 jQuery UI 滑块不起作用

> ID：11208573
> 
> 赞同：0
> 
> 时间：2012-06-26T13:38:56.570
> 
> 标签：jquery-ui, jquery, jquery-ui-slider, jquery-load

我有一个名为的 html 页面`search.html`，其中包含滑块，它们在此页面中完美运行。

我正在尝试使用 jQuery .load() 函数将此页面加载到另一个页面（我的主页）中。

我从 中删除了滑块初始化，`search.html`并将其放在主页面的 load() 回调函数中，以便在通过 AJAX 设置的 DOM 准备好后执行，如下所示：

```
$("#display_area").load("search.html","",function(response,status,xhr){ 
//#display_area is a div
$( "#sliderprice" ).slider({ max: 1000 },{ step: 10 }); 
//#sliderprice is a div
}) 
```

我在 search.html 页面和主页的头部都包含 jQuery 和 jQuery UI 的 JS 脚本。

当我加载主页时，有时，滑块可以正常工作，但有时它根本不工作（不初始化），发生这种情况时，萤火虫的错误控制台显示： $("#sliderprice").slider 是不是函数

我所做的只是刷新页面，有时它可以工作，有时不能。

我想解决这个问题，让它一直有效。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:08:37.013

我自己找到了解决方案，我所要做的就是从`search.html`页面中删除 jQuery 和 jQuery UI 的 JS 脚本，并将其仅保留在主页中。

显然，将它放在两者中，会在 .load() 函数触发时再次重新加载脚本，有时回调函数会在脚本完成重新加载之前触发。

我不知道脚本插入和加载如何通过 .load() 或一般工作，但它解决了问题。

# java - 编写空检查的更简洁的方式（可能没有 IF？）

> ID：11208580
> 
> 赞同：0
> 
> 时间：2012-06-26T13:39:08.317
> 
> 标签：java, optimization, conditional-statements

我有一段简单的代码：

```
txtRequiredDate.setText(wwDateFormatter.format(todoEntity.getRequiredDate()));
txtRequiredDateDay.setText(dayOfWeek(todoEntity.getRequiredDate()));
txtDoneDate.setText(wwDateFormatter.format(todoEntity.getDoneDate()));
txtDoneDateDay.setText(dayOfWeek(todoEntity.getDoneDate())); 
```

问题是有时日期为空（因为它是可选的填写）。在这些情况下，wwDateFormatter 会触发 NullPointerException。

正如我所见，修复它的一种方法是：

```
if (todoEntity.getRequiredDate() != null) 
{
    txtRequiredDate.setText(wwDateFormatter.format(todoEntity.getRequiredDate()));
    txtRequiredDateDay.setText(dayOfWeek(todoEntity.getRequiredDate()));
}

if (todoEntity.getDoneDate() != null)
{
    txtDoneDate.setText(wwDateFormatter.format(todoEntity.getDoneDate()));
    txtDoneDateDay.setText(dayOfWeek(todoEntity.getDoneDate()));
} 
```

但我想知道是否有更简洁的方式来编写上述语句？

谢谢你！

**编辑**我想这不是没有优化，而是我想学习各种检查空值的方法，特别是如果出现我必须有 30 个这样的语句的情况，呵呵。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:43:44.983

为什么不用 null 感知变体包装格式化程序，如果传递 null 则返回空字符串？

您可能还对[空对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)感兴趣。另请注意[此博客](http://www.codecommit.com/blog/scala/the-option-pattern)，其中讨论了 Scala 的`Option`模式和 Java 中的等价模式。这些都是非常有用的模式，您可以利用它们来缓解上述问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:42:18.707

确保您的日期字符串永远不会为空（使用空字符串：`""`代替） - 不再需要 ifs。

或者您可以使用非空实用程序方法（类似于 Brian 建议的）：

```
private String nonNull(String s) {
    return (s == null ? "" : s);
}

public void yourMethod() {
    txtRequiredDate.setText(wwDateFormatter.format(nonNull(todoEntity.getRequiredDate())));
    txtRequiredDateDay.setText(dayOfWeek(nonNull(todoEntity.getRequiredDate())));
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T14:03:07.113

这是访问器/属性最好避免的典型原因。尝试摆脱暴露实体的“原始”数据并将逻辑放入实体本身 - 然后您将空检查放在一个地方。

```
txtRequiredDate.setText(todoEntity.formattedRequiredDate()) 
```

...您在实体方法中进行空检查（并返回空字符串或任何如果为空）。

Whether getters and setters really are evil or not, [old classic article in this subject](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html), is up for debate, but at least having encapsulation in mind when designing entities is a good thing IMO.

# c# - 如果一个类继承自一个本身实现 IDisposable 的接口，该类是否也应该实现 IDisposable？

> ID：11208582
> 
> 赞同：4
> 
> 时间：2012-06-26T13:39:10.603
> 
> 标签：c#, .net

如果一个类继承自一个本身实现 IDisposable 的接口，该类是否也应该实现 IDisposable？

例如

```
internal IMyInterface : IDisposable
{
  Method1();
}

internal ClassA : IMyInterface, IDisposable
{
  public Method1
  {
    ...
  }

  public Dispose()
  {
    ...
  }

} 
```

或者

```
internal ClassA : IMyInterface
{
  public Method1
  {
    ...
  }

  public Dispose()
  {
    ...
  }

} 
```

对此问题的任何澄清将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:45:31.793

接口是契约，没有任何实现。因此，实现接口的类必须实现直接或间接继承的接口所要求的一切。如果你不这样做，你的代码甚至不会编译。

是的，`IDisposable`除非您从已经实现它的类派生您的类，否则您必须实现它。（注意：你不需要`IDisposable`在你的类的继承列表中指定接口，但你必须实现它的成员。）

* * *

### 更新

注意：Visual Studio 使您可以轻松实现接口。`IMyInterface`只要您还没有完全实现，智能标签就会自动出现在下方。您可以在智能标记菜单中选择接口的显式和隐式实现。通常你会选择**隐式**。然后 VS 会自动创建接口所需的（空）方法、属性和其他成员，包括`Dispose`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:42:40.617

`Dispose`无论如何，该类都必须实现该方法。

如果你问你是否**必须声明你的类也实现`IDisposable`**了？所以答案是否定的，你不必

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T13:43:09.007

接口是一个声明。当一个接口继承另一个接口时 - 它实际上在继承接口的声明中添加了更多方法声明。

所以在你的情况下 - IMyInterface 将声明“Method1（）”和“Dispose（）”方法。无需再次添加 IDisposable。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:41:42.363

既然`IMyInterface`是`IDisposable`，那么`ClassA`就不需要直接继承自`IDisposable`...否则，是的，`ClassA`必须`IDisposable`在这个例子中实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T13:41:47.420

不，没有必要单独实现 Dispose，因为接口不会让它编译直到`Dispose()`存在。

# iphone - 如何在 UIWebView 中适应来自 Web 服务的所有内容

> ID：11208584
> 
> 赞同：0
> 
> 时间：2012-06-26T13:39:20.907
> 
> 标签：iphone, ios, objective-c, uiwebview

我已经实现了 UIWebView 并显示来自网络服务的内容，这是下面的代码

```
webView = [[UIWebView alloc] initWithFrame:CGRectMake(0,0,320,460)];
webView.scalesPageToFit = YES;
webView.dataDetectorTypes = YES;
webView.autoresizingMask = UIViewAutoresizingFlexibleHeight;
webView.delegate = self;

NSURL *targetURL = [NSURL URLWithString:delegate.S_Title];
request = [NSURLRequest requestWithURL:targetURL];
[webView loadRequest:request];
[self.view addSubview:webView]; 
```

但是，当我向下滚动到底部时，它没有滚动以显示 webview 显示的完整内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:51:35.493

试试这个，在你加载了内容之后，`UIWebView`你可以使用它的`stringByEvaluatingJavaScriptFromString:`方法来询问 html 文档的高度。这有点棘手，但应该可以。

你可以这样做：

```
NSInteger height = [[webView stringByEvaluatingJavaScriptFromString:
    @"document.body.scrollHeight"] integerValue]; 
```

滚动高度可能不是最好的。你有几个选择。[试用此处](http://james.padolsey.com/javascript/get-document-height-cross-browser/)提到的文档属性

# php - 具有最大可能分布的 MySQL 选择查询

> ID：11208586
> 
> 赞同：0
> 
> 时间：2012-06-26T13:39:24.330
> 
> 标签：php, mysql, select, distribution

我正在使用随机选择的邮件地址（与实际的时事通讯相关联）提供一个后缀队列。Postfix 是健康队列很好，但我仍然想更聪明一点。

我试图找出一个 MySQL 查询，它不是随机选择电子邮件地址，而是尽可能分散地选择电子邮件地址。是否可以通过单个查询来做这样的事情？或者我需要[计算不同的提供商](https://stackoverflow.com/questions/2440429/mysql-query-to-count-unique-domains-from-email-address-field)，然后对结果进行切片并再次选择地址？后者似乎很愚蠢，第一种方法会更好。

也许只是糟糕的搜索查询，但我找不到类似的问题/解决方案。

提前致谢，

法布里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:55:44.950

我会这样：更改您的数据库表并添加另一个名为 eg 的列`email_provider`。在注册时事通讯期间，您可以使用 PHP 从注册电子邮件地址中提取电子邮件提供商并将其存储到此列，因此值应该是`yahoo.com`等`gmail.com`...

此外，您还必须创建一个脚本，该脚本将逐行遍历表格并使用来自电子邮件地址的值更新此列，以保持数据一致性。

这应该不难实现...

然后调用 where You 的查询`group by email_provider`，`order by rand()`并为每个分组的提供商选择一个电子邮件地址...

你应该完成...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:13:47.647

好的，这是我的错，我忽略了这个问题。

**伪查询：**

```
SELECT `subscriber`.`id`, `subscriber`.`email`, `queue`.`subscriber`, 
SUBSTRING(`email`, LOCATE('@', `email`)) AS `domain`,
COUNT(*) AS `count`
FROM `queue`
LEFT JOIN `subscriber` ON `queue`.`subscriber` = `subscriber`.`id`
GROUP BY `domain`
ORDER BY RAND()
LIMIT 0, 100; 
```

瞧，分布式电子邮件提供商！

# c#-4.0 - 正确使用对象初始化器

> ID：11208591
> 
> 赞同：1
> 
> 时间：2012-06-26T13:39:44.460
> 
> 标签：c#-4.0, initialization

我有一个用于初始化 DbRecordData 的变体

```
public class DbRecordData : IList<DbFieldValue>, ICollection<DbFieldValue>, IEnumerable<DbFieldValue>, IEnumerable
{
    public DbRecordData(DataRow row);
    public DbRecordData(int countValues);

    public int Count { get; }

    public DbFieldValue this[int index] { get; set; }

    public int Add(DbFieldValue item);
    public int Add(string fieldName, object value);
    public int Add(DataRow row, string fieldName, SqlDbType dataType);
    public int Add(string fieldName, SqlDbType dataType, object value);
    public void Clear();
    public void FillSqlParameters(SqlParameter[] parameters, int fromIndex);
} 
```

这是初始化：

```
 DbRecordData dbRecord = new DbRecordData(2)
                        {
                            {"VehMarkName", SqlDbType.NVarChar, vehMarkName},
                            {"refVehTypeId", SqlDbType.Int, refVehTypeId}
                        }; 
```

这有效并且不会产生警告，但我在 msdn 中没有找到相同的示例。这个变体正确吗？还是黑客？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:42:01.197

它当然有效，是的。它相当于：

```
DbRecordData tmp = new DbRecordData(2);
tmp.Add("VehMarkName", SqlDbType.NVarChar, vehMarkName);
tmp.Add("refVehTypeId", SqlDbType.Int, refVehTypeId);
DbRecordData dbRecord = tmp; 
```

如果这基本上是您编写的代码，那么我更喜欢您的对象初始化程序版本。如果您想要*不同的*代码，那么您可能需要重新考虑。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T14:18:49.993

它有效，但未在 MSDN 中记录：http: [//msdn.microsoft.com/en-us/library/bb384062.aspx](http://msdn.microsoft.com/en-us/library/bb384062.aspx)

**对于企业代码，使用未记录的功能是不正确的。因为在最新版本的 .NET 中可能会破坏对这种构造的支持**

记录的方式是

```
DbRecordData dbRecord = new DbRecordData(2)
                        {
                            new DbFieldValue("VehMarkName", SqlDbType.NVarChar, vehMarkName),
                            new DbFieldValue("refVehTypeId", SqlDbType.Int, refVehTypeId)
                        }; 
```

但这个版本不仅仅是复杂的

```
DbRecordData dbRecord = new DbRecordData(2)
dbRecord.Add("VehMarkName", SqlDbType.NVarChar, vehMarkName);
dbRecord.Add("refVehTypeId", SqlDbType.Int, refVehTypeId); 
```

# php - 未捕获的类型错误：无法在 ajax 中读取 null 的属性“成功”

> ID：11208592
> 
> 赞同：0
> 
> 时间：2012-06-26T13:39:47.193
> 
> 标签：php, ajax, jquery

我已经使用 ajax post 方法进行了表单验证。但我收到错误“**未捕获的类型错误：无法读取 null 的属性‘成功’** ”……有人可以帮我解决这个问题吗……？

**我的代码**

```
$.post("register.php",{uname:uname,pwd:pwd,cfmpwd:cfmpwd,email:email,gender:gender}).success(function(data){

        var obj = jQuery.parseJSON(data);
        $('.chatregalert').fadeIn('slow');
        if(obj.success == 1){
            $('.chatregalert').css('color','#067800');
            $('.chatuname').val('');
            $('.chatpwd').val('');
            $('.chatcfmpwd').val('');
            $('.chatemail').val('');
            $('.chatgender').val('');
        }else{
            $('.chatregalert').css('color','#CC0000');
        }
        $('.chatregalert').html(obj.msg);

    });
    return false;
}); 
```

我已经尝试 alert(data) 成功...它警告一个空框...我该如何解决这个问题..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T07:18:50.420

最后我得到了解决方案。问题是我的服务器不支持 JSON，因为我的 PHP 版本是**5.1.6**。JSON 支持仅适用于**PHP 5.2 和更高**版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:45:08.310

你能试着这样做吗：

```
$.post("register.php",
       {uname:uname,pwd:pwd,cfmpwd:cfmpwd,email:email,gender:gender},
       function(data){
            var obj = jQuery.parseJSON(data);
            $('.chatregalert').fadeIn('slow');
            if(obj.success == 1){
                $('.chatregalert').css('color','#067800');
                $('.chatuname').val('');
                $('.chatpwd').val('');
                $('.chatcfmpwd').val('');
                $('.chatemail').val('');
                $('.chatgender').val('');
            }else{
                $('.chatregalert').css('color','#CC0000');
            }
            $('.chatregalert').html(obj.msg);
     }); 
```

# ios - 使用 AVAssetWriter 录制和播放音频

> ID：11208593
> 
> 赞同：1
> 
> 时间：2012-06-26T13:39:49.393
> 
> 标签：ios, audio, avassetwriter

我已经减少了这个问题，希望能得到一些帮助。

基本上这个类有两种方法，一种是开始录制音频（`-recordMode`），另一种是播放音频（`playMode`）。我目前在一个项目中有这个类，它有一个带有两个按钮的视图控制器，它们调用相应的方法（rec，play）。没有其他变量，类是自包含的。

但是它不会播放/录制任何东西，我不知道为什么。当我尝试播放文件时，我得到一个文件大小为 0 和一个错误，因为你当然不能`AVAudioPlayer`用`nil`引用来初始化。但我不明白为什么文件是空的或者为什么`self.outputPath`是`nil`.

.h 文件

```
#import <AVFoundation/AVFoundation.h>

@interface MicCommunicator : NSObject<AVCaptureAudioDataOutputSampleBufferDelegate>

@property(nonatomic,retain) NSURL *outputPath;
@property(nonatomic,retain) AVCaptureSession * captureSession;
@property(nonatomic,retain) AVCaptureAudioDataOutput * output;

-(void)beginStreaming;
-(void)playMode;
-(void)recordMode;

@end 
```

.m 文件：

```
@implementation MicCommunicator {
    AVAssetWriter *assetWriter;
    AVAssetWriterInput *assetWriterInput;
}

@synthesize captureSession = _captureSession;
@synthesize output = _output;
@synthesize outputPath = _outputPath;

-(id)init {
    if ((self = [super init])) {
        NSArray *searchPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        self.outputPath = [NSURL fileURLWithPath:[[searchPaths objectAtIndex:0] stringByAppendingPathComponent:@"micOutput.output"]];

        AudioChannelLayout acl;
        bzero(&acl, sizeof(acl));
        acl.mChannelLayoutTag = kAudioChannelLayoutTag_Mono; //kAudioChannelLayoutTag_Stereo;
        NSDictionary *audioOutputSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                             [NSNumber numberWithInt: kAudioFormatULaw],AVFormatIDKey,        
                                             [NSNumber numberWithFloat:8000.0],AVSampleRateKey,//was 44100.0
                                             [NSData dataWithBytes: &acl length: sizeof( AudioChannelLayout ) ], AVChannelLayoutKey,
                                             [NSNumber numberWithInt:1],AVNumberOfChannelsKey,
                                             [NSNumber numberWithInt:8000.0],AVEncoderBitRateKey,
                                             nil];

        assetWriterInput = [AVAssetWriterInput assetWriterInputWithMediaType:AVMediaTypeAudio outputSettings:audioOutputSettings];
        [assetWriterInput setExpectsMediaDataInRealTime:YES];

        assetWriter = [[AVAssetWriter assetWriterWithURL:_outputPath fileType:AVFileTypeWAVE error:nil] retain];
        [assetWriter addInput:assetWriterInput];
    }
    return self;
}

-(void)dealloc {
    [assetWriter release];
    [super dealloc];
}

//conveniance methods

-(void)playMode
{
    [self stopRecording];

    NSError *error;
    AVAudioPlayer * audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:self.outputPath error:&error];
    audioPlayer.numberOfLoops = -1;

    if (audioPlayer == nil){
        NSLog(@"error: %@",[error description]);        
    }else{ 
        NSLog(@"playing");  
        [audioPlayer play];
    }
}

-(void)recordMode
{
        [self beginStreaming];    
}

-(void)stopRecording
{
    [self.captureSession stopRunning];
    [assetWriterInput markAsFinished];
    [assetWriter  finishWriting];

    NSDictionary *outputFileAttributes = [[NSFileManager defaultManager] attributesOfItemAtPath:[NSString stringWithFormat:@"%@",self.outputPath] error:nil];
    NSLog (@"done. file size is %llu", [outputFileAttributes fileSize]);
}

//starts audio recording
-(void)beginStreaming {
    self.captureSession = [[AVCaptureSession alloc] init];
    AVCaptureDevice *audioCaptureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeAudio];
    NSError *error = nil;
    AVCaptureDeviceInput *audioInput = [AVCaptureDeviceInput deviceInputWithDevice:audioCaptureDevice error:&error];
    if (audioInput)
        [self.captureSession addInput:audioInput];
    else {
        NSLog(@"No audio input found.");
        return;
    }

    AVCaptureAudioDataOutput *output = [[AVCaptureAudioDataOutput alloc] init];

    dispatch_queue_t outputQueue = dispatch_queue_create("micOutputDispatchQueue", NULL);
    [output setSampleBufferDelegate:self queue:outputQueue];
    dispatch_release(outputQueue);

    [self.captureSession addOutput:output];
    [assetWriter startWriting];
    [self.captureSession startRunning];
}

//callback
-(void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection {
    AudioBufferList audioBufferList;
    NSMutableData *data= [[NSMutableData alloc] init];
    CMBlockBufferRef blockBuffer;
    CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer(sampleBuffer, NULL, &audioBufferList, sizeof(audioBufferList), NULL, NULL, 0, &blockBuffer);

    //for (int y = 0; y < audioBufferList.mNumberBuffers; y++) {
    //  AudioBuffer audioBuffer = audioBufferList.mBuffers[y];
    //  Float32 *frame = (Float32*)audioBuffer.mData;
    //          
    //  [data appendBytes:frame length:audioBuffer.mDataByteSize];
    //}

    // append [data bytes] to your NSOutputStream 

    // These two lines write to disk, you may not need this, just providing an example
    [assetWriter startSessionAtSourceTime:CMSampleBufferGetPresentationTimeStamp(sampleBuffer)];
    [assetWriterInput appendSampleBuffer:sampleBuffer];

    CFRelease(blockBuffer);
    blockBuffer=NULL;
    [data release];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:05:19.590

根据 Apple 支持：

因此，这是一个错误——文件​​被创建，许多样本被成功写入，然后附加开始由于某种未知原因而失败。

似乎 AVAssetWriter 仅在这些设置下失败。

AudioQueue 应该用于 ulaw 音频

# sql - 这个 sql 查询（组合列后在哪里）不应该工作吗？

> ID：11208600
> 
> 赞同：0
> 
> 时间：2012-06-26T13:40:08.277
> 
> 标签：sql, sql-server

我有这个查询：

```
Select (Country.Name + ', ' + City.Name) as Location
...
Where Location like '%Punta Cana%' 
```

由于它在没有“位置”的情况下工作，我天真地认为它可以工作。好吧，它不会并引发错误：无效的列名“位置”。有没有人有时间请解释为什么它不起作用以及可行的替代方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:45:28.070

不，您不能在查询中的其他任何地方引用列别名，除了`ORDER BY`. 这是因为 SQL Server 对查询中的子句进行逻辑解析的方式——`SELECT`倒数第二。（[在 dba.SE 上有很多有趣的讨论](https://dba.stackexchange.com/questions/19762/why-is-the-select-clause-listed-first/)。）

您的选择是重复表达式或使用子查询/CTE。已经有子查询/ CTE的例子，所以为了完整起见，你也可以这样做：

```
Select (Country.Name + ', ' + City.Name) as Location
...
Where (Country.Name + ', ' + City.Name) like '%Punta Cana%' 
```

我昨天刚刚回答了同样的问题，包括证明重复表达并不像听起来那么昂贵：

[WHERE 子句中的引用别名（在 SELECT 中计算）](https://stackoverflow.com/questions/11182339/reference-alias-calculated-in-select-in-where-clause/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T13:41:31.967

请改用此方法：

```
; with temp as (
Select (Country.Name + ', ' + City.Name) as Location
...
)
select * from temp
Where Location like '%Punta Cana%' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T13:47:29.467

如果要在中使用别名，`ORDER BY`可以将整个`SELECT`内部包装在另一个中`SELECT`

```
SELECT *
FROM 
(
    Select (Country.Name + ', ' + City.Name) as Location
    ...
) x
Where x.Location like '%Punta Cana%' 
```

`ORDER BY`否则，您将不得不在子句中再次使用该表达式

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:42:23.333

位置不是列名。它只是您正在创建的别名。

# php - 用于验证 javascript 语法的 PHP 类

> ID：11208602
> 
> 赞同：0
> 
> 时间：2012-06-26T13:40:16.717
> 
> 标签：php, javascript

您是否知道在哪里可以找到可以验证 JavaScript 语法的 PHP 类（库）？

**结果**：似乎没有可以下载的此类库，因此唯一的解决方案是编写自己的。谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:45:09.537

有一个很好的类，它是无处不在的（用于 JS 验证）JSLint 的包装器 - [http://www.overflow.biz/blog/lang/en-us/2010/07/07/jslint-php-class/](http://www.overflow.biz/blog/lang/en-us/2010/07/07/jslint-php-class/)

它确实要求您可以在服务器上执行二进制文件，因为您当然需要 JSLint 本身。

编辑：

还有一个（非常旧的）基于 php 的解析器 - [http://timwhitlock.info/blog/2009/11/jparser-and-jtokenizer-released/](http://timwhitlock.info/blog/2009/11/jparser-and-jtokenizer-released/) - 我很久以前就用过它！

# spring - Spring Roo DBRE 主键插入/更新

> ID：11208603
> 
> 赞同：1
> 
> 时间：2012-06-26T13:40:18.780
> 
> 标签：spring, primary-key, reverse-engineering, spring-roo

我正在使用 Spring Roo 创建一个应用程序。当我对数据库表进行逆向工程时，一切看起来都很好，但是数据库中没有主键字段。这些不是自动递增的，而是需要手动填充或从另一张桌子上移开。当我启动我的 spring roo 应用程序时，我可以创建或查看表及其字段，但我无法在任何地方看到要查看或更新的主键。关于如何做到这一点的任何建议？

# excel - Excel - 如果为空单元格，则复制到左侧

> ID：11208610
> 
> 赞同：0
> 
> 时间：2012-06-26T13:40:36.093
> 
> 标签：excel, copy

```
EXCEL SAMPLE SHEET
     A   B   C   D
1 | 53 |   |   |
2 |    | 5 |   |
3 | 12 |   |   |
4 |    |   | 6 |
5 |    |   |   |  1
6 |    | 4 |   |
7 |            | 55 
```

我希望最后能够有一列包含来自 COL AD 的所有值（实际上除了更多的列/行）

基本上，每一行都有一个值相应地分布在列中。我想将所有其余值复制到第一行的空白处。由于每行只有一个值，因此在任何其他列中始终为空白。

最终产品应该是 [53,5,12,6, 1,4,55] 的一列列表

到目前为止我一直在做的是选择空白单元格并将其设置为等于下一个列。但如果我这样做，我必须手动完成大约 +50 列。我想知道是否有更有效的方法来解决这个问题。

谢谢

// 编辑

任务目的

> ```
> COL A                                    | COL B     | COL C
> 1 (Dan, Annotation ID 5)                 | [143, 4]  | 
> 2 (Red shirt man, Annotation ID 143)     | [4, 5]    | 
> 3 (Woman, Annotation ID 2)               |           | [30] 
> 4 (Man, Annotation ID 4)                 | [5, 143]  | 
> 5 (Girl, Annotation ID 30)               |           | [2] 
> ```

COL A 有一个实体的所有注释的列表 COL B 有第一个实体（即 Dan）以及为每个实体列出的共同引用列表。COL C 第二个实体，以此类推。目标是合并最后一列 B to etc.。（如果这个解释有帮助）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:09:35.850

如果数据是数字，您可以在 E1 中输入并填写以下公式：

```
=LOOKUP(1E100,A1:D1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:49:43.190

如果每行中只有 1 个值，那么您可以对行求和，例如

`=SUM(A1:D1)`

抄下来

编辑：我假设您的数据是数字的，因为这就是您在样本中显示的内容 - 如果不尝试这种变化，请尝试 lori_m 的建议

`=LOOKUP(2,1/(A1:D1<>""),A1:D1)`

假设 A1:D1 范围内的数据，根据需要进行编辑

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-14T10:31:38.793

这与数字无关：

E1：=A1&B1&C1&D1

这结合了所有条目，由于除了一列之外的所有条目都是空的，因此您将获得所需的一个值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:06:33.397

我不是 100% 确定我理解这个问题。

您想复制表格单元格中每个单元格的值，并用逗号分隔值吗？并且每一行将只有 1 个单元格，其中包含一个值？

如果没有冗长的 if 语句，我想不出任何方法来做到这一点。您能否详细说明该表的用途是什么？

# php - 从列自动生成数组

> ID：11208613
> 
> 赞同：1
> 
> 时间：2012-06-26T13:40:37.257
> 
> 标签：php, arrays, populate

我正在制作一个从给定的数据库和表构建自己的表单。但是，当涉及到插入功能时，我遇到了一个障碍。我已经做到了，以便所有字段都生成输入，textareas 页面上有正确名称的内容。现在我需要做的就是将它插入到数据库中。但是我需要使用 implode 重新创建格式 (this,that,this) 的数组，我不知道该怎么做。

```
 $resultInsert = mysql_query("SHOW COLUMNS FROM " . $table);
$fieldnames=array();

if (mysql_num_rows($resultInsert) > 0) {
        while ($row = mysql_fetch_array($resultInsert)) {
            echo $fieldnames[] = $row['Field']; #currently outputting titlebodytextcreated (three fields i have)
        }
      }

// FORMAT: field_name = $_POST[fieldname]

$values = array('title'=>$_POST['title'],'bodytext'=>$_POST['bodytext']); # need this to be autogenerated by the field names

echo "<br>" . sprintf('INSERT INTO %s (%s) VALUES ("%s")', 'testdb', 
implode(', ', array_map('mysql_escape_string', array_keys($values))), implode('", "',array_map('mysql_escape_string', $values))); 

// add loop for id to be generated in a hidden field, along with all other excluded fields so that the
// update will process correctly in the insert into phase 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:50:35.477

这行得通吗？

```
$values = array_intersect_key( $_POST, array_flip($fieldnames) ); 
```

或者，更确切地说，如果你想确保所有值`$fieldnames`都有一个键，`$values`即使对应的键`$_POST`为空：

```
$values  = array_flip($fieldnames);  
$values += array_intersect_key( $_POST, $values ); 
```

# search - SharePoint 2010 关键字查询托管属性搜索

> ID：11208614
> 
> 赞同：0
> 
> 时间：2012-06-26T13:40:37.287
> 
> 标签：search, sharepoint-2010, keywordquery

**在我的测试系统中，使用site:**标签在特定站点中搜索项目没有问题。这看起来像：

myTestSearch 站点：http://sharepoint.local/testsite/library1

同一个 webpart 在不同服务器上的 live-system 中确实存在此关键字的问题。我没有得到关于该查询的任何结果。相同的数据、相同的配置、已完成完全爬网、托管属性中的相同设置...

这里有什么可以对付我的？

感谢您的任何提示或回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:24:30.820

对我有用的解决方案：而不是 site: ，我选择了 path: ，在两个系统上都像一个魅力！

# postgresql - 没有应用程序服务器的 Postgres SQL 池连接

> ID：11208615
> 
> 赞同：1
> 
> 时间：2012-06-26T13:40:41.227
> 
> 标签：postgresql, connection, pool

[这是我对我之前发布的一个问题](https://stackoverflow.com/questions/11202046/java-jdbc-efficiency-how-long-should-a-connection-be-maintained)的跟进，建议我使用连接池连接到我的 Postgres 数据库。根据[Postgres 的 jdbc4](http://jdbc.postgresql.org/documentation/publicapi/org/postgresql/ds/PGPoolingDataSource.html)文档，他们提到可以使用两种类型的池。一种带有应用程序服务器，一种没有应用程序服务器。我打算不使用应用程序服务器，原因我稍后会提出。我有一个关于没有应用服务器的连接池的快速问题：

> *如果您确定要使用它，则必须设置属性 dataSourceName、databaseName、用户和密码（如果用户需要）。serverName、portNumber、initialConnections 和 maxConnections 的设置是可选的。请注意，只会汇集默认用户的连接！其他用户的连接将是正常的非池连接，并且不会计入最大池大小限制。*

**什么是默认用户？它是 Postgres 数据库用户/角色吗？将这些包添加到我的前端是否足够，并有一个专门用于运行 Postgres 的服务器？**

我倾向于这样做的原因是因为我以前使用过 Glassfish，虽然与数据源的连接和持久性是轻而易举的，但我遇到了从已经创建的 Postgres 数据库（240 个表，请见[这里](https://stackoverflow.com/questions/9891152/ejb-entity-bean-generation-error-from-postges-8-4-using-jpa-2-0-and-eclipselink)和[这里](https://bugs.eclipse.org/bugs/show_bug.cgi?id=375728)）。

因此，我放弃了使用 EJB 和 Glassfish 的想法，而是使用带有 jdbc 连接的简单单例模式来连接到我的数据库。**该应用程序运行得非常快，这就是我倾向于不使用应用程序服务器的原因。这是一个正确的印象还是我被错误地告知？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T13:09:27.423

首先，那里的信息太少，无法确定应用程序服务器是否有帮助。通常它不是速度问题，而是在整个企业的不同应用程序中重用逻辑的问题。

其次，对于连接池，您必须记住的是，您不能将一个用户的连接重新用作另一个用户。因此，您通常希望在单个应用程序用户下拥有一个连接池。这在连接池级别进行配置。您可以有多个连接池将不同的应用程序连接到不同用户下的数据库。

# cocoa - 按 Option 键隐藏/显示应用程序主菜单中的菜单项

> ID：11208632
> 
> 赞同：9
> 
> 时间：2012-06-26T13:41:34.363
> 
> 标签：cocoa, nsmenu

我想在应用程序的主菜单中添加一个很少使用的菜单项。我希望它默认隐藏并仅在用户按住 Option 键时显示。我该怎么做呢？

看来我应该处理`flagsChanged:`，但它是`NSResponder`方法，`NSMenu`不继承自`NSResponder`？我在主窗口控制器中尝试过它，当我在单击菜单之前按 Option 键时它可以工作。以下用例不起作用：单击菜单项（没有项目），按选项键 - 我的项目应该出现，释放选项键 - 项目应该消失。

我也尝试过 NSEvent`addLocalMonitorForEventsMatchingMask:handler:`和`addGlobalMonitorForEventsMatchingMask:handler:`for`NSFlagsChangedMask`但是当主菜单打开时按下选项键时，本地或全局处理程序都不会被触发。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-16T20:00:43.727

构建菜单时包括可选项目并将其标记为隐藏。然后将您的类实例设置为菜单的委托，并在菜单打开时添加一个运行循环观察者来控制可选项目的隐藏状态。

```
@implementation AppController {
    CFRunLoopObserverRef _menuObserver;
}

- (void)updateMenu {
    BOOL hideOptionalMenuItems = ([NSEvent modifierFlags] & NSAlternateKeyMask) != NSAlternateKeyMask;
    [self.optionalMenuItem setHidden:hideOptionalMenuItems];
}

- (void)menuWillOpen:(NSMenu *)menu {
    [self updateMenu];

    if (_menuObserver == NULL) {
        _menuObserver = CFRunLoopObserverCreateWithHandler(NULL, kCFRunLoopBeforeWaiting, true, 0, ^(CFRunLoopObserverRef observer, CFRunLoopActivity activity) {
            [self updateMenu];
        });

        CFRunLoopAddObserver(CFRunLoopGetCurrent(), _menuObserver, kCFRunLoopCommonModes);
    }
}

- (void)menuDidClose:(NSMenu *)menu {
    if (_menuObserver != NULL) {
        CFRunLoopObserverInvalidate(_menuObserver);
        CFRelease(_menuObserver);
        _menuObserver = NULL;
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-19T22:22:13.767

实现此目的的最佳方法是使用两个菜单项，第一个菜单项使用高度为 0 的自定义视图，并且被禁用，然后在它的正下方是一个“备用”项。（您必须将此项设置`keyEquivalentModifierMask`为`NSAlternateKeyMask`）通过这种安排，当您按下选项键时，NSMenu 将自动将零高度的菜单项替换为备用项，这将具有使菜单项神奇地出现的效果。

无需计时器、更新或标志更改通知。

此功能在此处的文档中进行了描述：[管理备用](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSMenuItem_Class/index.html#//apple_ref/doc/uid/20000265-SW21)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-08T19:44:59.447

将以下内容添加到 applicationDidFinishLaunching。

```
// Dynamically update QCServer menu when option key is pressed
NSMenu *submenu = [[[NSApp mainMenu] itemWithTitle:@"QCServer"] submenu];    
NSTimer *t = [NSTimer timerWithTimeInterval:0.1 target:self selector:@selector(updateMenu:) userInfo:submenu repeats:YES];
[[NSRunLoop currentRunLoop] addTimer:t forMode:NSEventTrackingRunLoopMode]; 
```

然后加

```
- (void)updateMenu:(NSTimer *)t {

    static NSMenuItem *menuItem = nil;
    static BOOL isShowing = YES;

    // Get global modifier key flag, [[NSApp currentEvent] modifierFlags] doesn't update while menus are down
    CGEventRef event = CGEventCreate (NULL);
    CGEventFlags flags = CGEventGetFlags (event);
    BOOL optionKeyIsPressed = (flags & kCGEventFlagMaskAlternate) == kCGEventFlagMaskAlternate;
    CFRelease(event);

    NSMenu *menu = [t userInfo];

    if (!menuItem) {
        // View Batch Jobs...
         menuItem = [menu itemAtIndex:6];
        [menuItem retain];
    }

    if (!isShowing && optionKeyIsPressed) {
        [menu insertItem:menuItem atIndex:6];
        [menuItem setEnabled:YES];
        isShowing = YES;
    } else if (isShowing && !optionKeyIsPressed) {
        [menu removeItem:menuItem];
        isShowing = NO;
    }

    NSLog(@"optionKeyIsPressed %d", optionKeyIsPressed);
} 
```

计时器仅在跟踪控件时触发，因此不会对性能造成太大影响。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-16T06:26:42.473

由于该`NSMenuDelegate`方法`menuNeedsUpdate:`是在显示之前调用的，因此可以覆盖它，检查是否`[NSEvent modifierFlags]`设置了备用位，并使用它来显示/隐藏您的秘密菜单项。

这是一个示例，从[Reveal Functionality with Key Modifiers](http://www.geektheory.ca/blog/reveal-functionality-with-key-modifiers/)复制而来，它完全涵盖了这个主题：

```
#pragma NSMenu delegate methods

- (void) menuNeedsUpdate: (NSMenu *)menu
{
    NSLog(@"menuNeedsUpdate: %@", menu);

    NSUInteger flags = ([NSEvent modifierFlags] & NSDeviceIndependentModifierFlagsMask);

    // We negate the value below because, if flags == NSAlternateKeyMask is TRUE, that
    // means the user has the Option key held, and wants to see the secret menu, so we
    // need shoudHideSecretMenu to be FALSE, so we just negate the value. 
    BOOL shoudHideSecretMenu = !(flags == NSAlternateKeyMask);

    NSLog(@"Flags: 0x%lx (0x%x), shoudHideSecretMenu = %d", flags, NSAlternateKeyMask, shoudHideSecretMenu);

    [secretMenuItem setHidden:shoudHideSecretMenu];
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-28T04:07:57.650

这里有一些复杂的答案，但实际上非常简单：

创建 2 个菜单项。第一个是您想要的任何 keyEquivalent 和标题的默认值。第二个是当修改键按下时将显示的内容 - 再次使用单独的 keyEquivalent 和标题。在第二个菜单项上，启用“Alternate”，其他一切都会自动发生。

通过比较 2 个 keyEquivalent 值来检测所需的修饰符。

# c# - ISO和奥林匹克国家代码之间的映射？

> ID：11208636
> 
> 赞同：2
> 
> 时间：2012-06-26T13:41:45.627
> 
> 标签：c#, .net, mapping, country-codes

[我必须在ISO 3166-1 alpha-3](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-3)和[IOC](http://en.wikipedia.org/wiki/List_of_IOC_country_codes)国家代码之间进行映射。

看起来没有办法通过 .NET 框架本地执行此操作。但可能是我错过了一些东西。

我很可能需要创建一些字典来执行此映射。有人知道一些库/开源项目/xml 提要/等，我可以在其中找到方便的映射吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T20:09:20.780

我解析了 wiki 页面并生成了字典，其中仅包含不匹配对的数据。对于所有其他国家/地区，三字母代码应相同。

这是源代码（按“原样”给出）：

```
 // Defines mapping between ISO 3166-1 alpha-3 and Olympic IOC country codes
    // Only mismatches are defined
    // Taken from here: http://en.wikipedia.org/wiki/Comparison_of_IOC,_FIFA,_and_ISO_3166_country_codes    
    var dictionary = new Dictionary<string, string>();
    dictionary.Add("DZA", "ALG");
    dictionary.Add("ASM", "ASA");
    dictionary.Add("AGO", "ANG");
    dictionary.Add("ATG", "ANT");
    dictionary.Add("ABW", "ARU");
    dictionary.Add("BHS", "BAH");
    dictionary.Add("BHR", "BRN");
    dictionary.Add("BGD", "BAN");
    dictionary.Add("BRB", "BAR");
    dictionary.Add("BLZ", "BIZ");
    dictionary.Add("BMU", "BER");
    dictionary.Add("BTN", "BHU");
    dictionary.Add("BWA", "BOT");
    dictionary.Add("VGB", "IVB");
    dictionary.Add("BRN", "BRU");
    dictionary.Add("BGR", "BUL");
    dictionary.Add("BFA", "BUR");
    dictionary.Add("KHM", "CAM");
    dictionary.Add("CYM", "CAY");
    dictionary.Add("TCD", "CHA");
    dictionary.Add("CHL", "CHI");
    dictionary.Add("COG", "CGO");
    dictionary.Add("CRI", "CRC");
    dictionary.Add("HRV", "CRO");
    dictionary.Add("DNK", "DEN");
    dictionary.Add("SLV", "ESA");
    dictionary.Add("GNQ", "GEQ");
    dictionary.Add("FJI", "FIJ");
    dictionary.Add("GMB", "GAM");
    dictionary.Add("DEU", "GER");
    dictionary.Add("GRC", "GRE");
    dictionary.Add("GRD", "GRN");
    dictionary.Add("GTM", "GUA");
    dictionary.Add("GIN", "GUI");
    dictionary.Add("GNB", "GBS");
    dictionary.Add("HTI", "HAI");
    dictionary.Add("HND", "HON");
    dictionary.Add("IDN", "INA");
    dictionary.Add("IRN", "IRI");
    dictionary.Add("KWT", "KUW");
    dictionary.Add("LVA", "LAT");
    dictionary.Add("LBN", "LIB");
    dictionary.Add("LSO", "LES");
    dictionary.Add("LBY", "LBA");
    dictionary.Add("MDG", "MAD");
    dictionary.Add("MWI", "MAW");
    dictionary.Add("MYS", "MAS");
    dictionary.Add("MRT", "MTN");
    dictionary.Add("MUS", "MRI");
    dictionary.Add("MCO", "MON");
    dictionary.Add("MNG", "MGL");
    dictionary.Add("MMR", "MYA");
    dictionary.Add("NPL", "NEP");
    dictionary.Add("NLD", "NED");
    dictionary.Add("NIC", "NCA");
    dictionary.Add("NER", "NIG");
    dictionary.Add("NGA", "NGR");
    dictionary.Add("OMN", "OMA");
    dictionary.Add("PSE", "PLE");
    dictionary.Add("PRY", "PAR");
    dictionary.Add("PHL", "PHI");
    dictionary.Add("PRT", "POR");
    dictionary.Add("PRI", "PUR");
    dictionary.Add("KNA", "SKN");
    dictionary.Add("VCT", "VIN");
    dictionary.Add("WSM", "SAM");
    dictionary.Add("SAU", "KSA");
    dictionary.Add("SYC", "SEY");
    dictionary.Add("SGP", "SIN");
    dictionary.Add("SVN", "SLO");
    dictionary.Add("SLB", "SOL");
    dictionary.Add("ZAF", "RSA");
    dictionary.Add("LKA", "SRI");
    dictionary.Add("SDN", "SUD");
    dictionary.Add("CHE", "SUI");
    dictionary.Add("TWN", "TPE");
    dictionary.Add("TZA", "TAN");
    dictionary.Add("TGO", "TOG");
    dictionary.Add("TON", "TGA");
    dictionary.Add("TTO", "TRI");
    dictionary.Add("ARE", "UAE");
    dictionary.Add("VIR", "ISV");
    dictionary.Add("URY", "URU");
    dictionary.Add("VUT", "VAN");
    dictionary.Add("VNM", "VIE");
    dictionary.Add("ZMB", "ZAM");
    dictionary.Add("ZWE", "ZIM"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-26T13:50:19.983

维基百科也提供[对照表](http://en.wikipedia.org/wiki/Comparison_of_IOC,_FIFA,_and_ISO_3166_country_codes)。考虑到它具有稳定的格式并且易于解析，您可以轻松地将这些数据转换为您想要的任何格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T13:46:53.953

我不知道是否存在，但只需解析两个链接中的表格并按国家/地区名称匹配来创建它并不难。我敢打赌这会让你得到 95%，而其余的可以手动完成。

我敢打赌，你会花更多的时间来尝试找到一个预先构建的而不是自己构建它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-10-23T14:57:55.447

带有 3 个字母 ISO 国家代码的 php 数组

```
$Countries=array();

array_push($Countries,"ABW");
array_push($Countries,"AFG");
array_push($Countries,"AGO");
array_push($Countries,"AIA");
array_push($Countries,"ALA");
array_push($Countries,"ALB");
array_push($Countries,"AND");
array_push($Countries,"ARE");
array_push($Countries,"ARG");
array_push($Countries,"ARM");
array_push($Countries,"ASM");
array_push($Countries,"ATA");
array_push($Countries,"ATF");
array_push($Countries,"ATG");
array_push($Countries,"AUS");
array_push($Countries,"AUT");
array_push($Countries,"AZE");
array_push($Countries,"BDI");
array_push($Countries,"BEL");
array_push($Countries,"BEN");
array_push($Countries,"BES");
array_push($Countries,"BFA");
array_push($Countries,"BGD");
array_push($Countries,"BGR");
array_push($Countries,"BHR");
array_push($Countries,"BHS");
array_push($Countries,"BIH");
array_push($Countries,"BLM");
array_push($Countries,"BLR");
array_push($Countries,"BLZ");
array_push($Countries,"BMU");
array_push($Countries,"BOL");
array_push($Countries,"BRA");
array_push($Countries,"BRB");
array_push($Countries,"BRN");
array_push($Countries,"BTN");
array_push($Countries,"BVT");
array_push($Countries,"BWA");
array_push($Countries,"CAF");
array_push($Countries,"CAN");
array_push($Countries,"CCK");
array_push($Countries,"CHE");
array_push($Countries,"CHL");
array_push($Countries,"CHN");
array_push($Countries,"CIV");
array_push($Countries,"CMR");
array_push($Countries,"COD");
array_push($Countries,"COG");
array_push($Countries,"COK");
array_push($Countries,"COL");
array_push($Countries,"COM");
array_push($Countries,"CPV");
array_push($Countries,"CRI");
array_push($Countries,"CUB");
array_push($Countries,"CUW");
array_push($Countries,"CXR");
array_push($Countries,"CYM");
array_push($Countries,"CYP");
array_push($Countries,"CZE");
array_push($Countries,"DEU");
array_push($Countries,"DJI");
array_push($Countries,"DMA");
array_push($Countries,"DNK");
array_push($Countries,"DOM");
array_push($Countries,"DZA");
array_push($Countries,"ECU");
array_push($Countries,"EGY");
array_push($Countries,"ERI");
array_push($Countries,"ESH");
array_push($Countries,"ESP");
array_push($Countries,"EST");
array_push($Countries,"ETH");
array_push($Countries,"FIN");
array_push($Countries,"FJI");
array_push($Countries,"FLK");
array_push($Countries,"FRA");
array_push($Countries,"FRO");
array_push($Countries,"FSM");
array_push($Countries,"GAB");
array_push($Countries,"GBR");
array_push($Countries,"GEO");
array_push($Countries,"GGY");
array_push($Countries,"GHA");
array_push($Countries,"GIB");
array_push($Countries,"GIN");
array_push($Countries,"GLP");
array_push($Countries,"GMB");
array_push($Countries,"GNB");
array_push($Countries,"GNQ");
array_push($Countries,"GRC");
array_push($Countries,"GRD");
array_push($Countries,"GRL");
array_push($Countries,"GTM");
array_push($Countries,"GUF");
array_push($Countries,"GUM");
array_push($Countries,"GUY");
array_push($Countries,"HKG");
array_push($Countries,"HMD");
array_push($Countries,"HND");
array_push($Countries,"HRV");
array_push($Countries,"HTI");
array_push($Countries,"HUN");
array_push($Countries,"IDN");
array_push($Countries,"IMN");
array_push($Countries,"IND");
array_push($Countries,"IOT");
array_push($Countries,"IRL");
array_push($Countries,"IRN");
array_push($Countries,"IRQ");
array_push($Countries,"ISL");
array_push($Countries,"ISR");
array_push($Countries,"ITA");
array_push($Countries,"JAM");
array_push($Countries,"JEY");
array_push($Countries,"JOR");
array_push($Countries,"JPN");
array_push($Countries,"KAZ");
array_push($Countries,"KEN");
array_push($Countries,"KGZ");
array_push($Countries,"KHM");
array_push($Countries,"KIR");
array_push($Countries,"KNA");
array_push($Countries,"KOR");
array_push($Countries,"KWT");
array_push($Countries,"LAO");
array_push($Countries,"LBN");
array_push($Countries,"LBR");
array_push($Countries,"LBY");
array_push($Countries,"LCA");
array_push($Countries,"LIE");
array_push($Countries,"LKA");
array_push($Countries,"LSO");
array_push($Countries,"LTU");
array_push($Countries,"LUX");
array_push($Countries,"LVA");
array_push($Countries,"MAC");
array_push($Countries,"MAF");
array_push($Countries,"MAR");
array_push($Countries,"MCO");
array_push($Countries,"MDA");
array_push($Countries,"MDG");
array_push($Countries,"MDV");
array_push($Countries,"MEX");
array_push($Countries,"MHL");
array_push($Countries,"MKD");
array_push($Countries,"MLI");
array_push($Countries,"MLT");
array_push($Countries,"MMR");
array_push($Countries,"MNE");
array_push($Countries,"MNG");
array_push($Countries,"MNP");
array_push($Countries,"MOZ");
array_push($Countries,"MRT");
array_push($Countries,"MSR");
array_push($Countries,"MTQ");
array_push($Countries,"MUS");
array_push($Countries,"MWI");
array_push($Countries,"MYS");
array_push($Countries,"MYT");
array_push($Countries,"NAM");
array_push($Countries,"NCL");
array_push($Countries,"NER");
array_push($Countries,"NFK");
array_push($Countries,"NGA");
array_push($Countries,"NIC");
array_push($Countries,"NIU");
array_push($Countries,"NLD");
array_push($Countries,"NOR");
array_push($Countries,"NPL");
array_push($Countries,"NRU");
array_push($Countries,"NZL");
array_push($Countries,"OMN");
array_push($Countries,"PAK");
array_push($Countries,"PAN");
array_push($Countries,"PCN");
array_push($Countries,"PER");
array_push($Countries,"PHL");
array_push($Countries,"PLW");
array_push($Countries,"PNG");
array_push($Countries,"POL");
array_push($Countries,"PRI");
array_push($Countries,"PRK");
array_push($Countries,"PRT");
array_push($Countries,"PRY");
array_push($Countries,"PSE");
array_push($Countries,"PYF");
array_push($Countries,"QAT");
array_push($Countries,"REU");
array_push($Countries,"ROU");
array_push($Countries,"RUS");
array_push($Countries,"RWA");
array_push($Countries,"SAU");
array_push($Countries,"SDN");
array_push($Countries,"SEN");
array_push($Countries,"SGP");
array_push($Countries,"SGS");
array_push($Countries,"SHN");
array_push($Countries,"SJM");
array_push($Countries,"SLB");
array_push($Countries,"SLE");
array_push($Countries,"SLV");
array_push($Countries,"SMR");
array_push($Countries,"SOM");
array_push($Countries,"SPM");
array_push($Countries,"SRB");
array_push($Countries,"SSD");
array_push($Countries,"STP");
array_push($Countries,"SUR");
array_push($Countries,"SVK");
array_push($Countries,"SVN");
array_push($Countries,"SWE");
array_push($Countries,"SWZ");
array_push($Countries,"SXM");
array_push($Countries,"SYC");
array_push($Countries,"SYR");
array_push($Countries,"TCA");
array_push($Countries,"TCD");
array_push($Countries,"TGO");
array_push($Countries,"THA");
array_push($Countries,"TJK");
array_push($Countries,"TKL");
array_push($Countries,"TKM");
array_push($Countries,"TLS");
array_push($Countries,"TON");
array_push($Countries,"TTO");
array_push($Countries,"TUN");
array_push($Countries,"TUR");
array_push($Countries,"TUV");
array_push($Countries,"TWN");
array_push($Countries,"TZA");
array_push($Countries,"UGA");
array_push($Countries,"UKR");
array_push($Countries,"UMI");
array_push($Countries,"URY");
array_push($Countries,"USA");
array_push($Countries,"UZB");
array_push($Countries,"VAT");
array_push($Countries,"VCT");
array_push($Countries,"VEN");
array_push($Countries,"VGB");
array_push($Countries,"VIR");
array_push($Countries,"VNM");
array_push($Countries,"VUT");
array_push($Countries,"WLF");
array_push($Countries,"WSM");
array_push($Countries,"YEM");
array_push($Countries,"ZAF");
array_push($Countries,"ZMB");
array_push($Countries,"ZWE"); 
```

# html - 将样式应用于某个类的这两种 CSS 符号之间有区别吗？

> ID：11208642
> 
> 赞同：2
> 
> 时间：2012-06-26T13:42:00.640
> 
> 标签：html, css

我在 CSS 页面上看到了以下两种符号，它们的工作方式*似乎*相同，它们*之间*有区别吗？

```
.ClassName  a:hover 
```

和：

```
a.ClassName:hover 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:44:22.923

是的，它们之间是有区别的。

`.ClassName a:hover`指的是任何悬停在带有 的元素内的锚点`class="ClassName"`。

`a.ClassName:hover`，然而，指的是任何悬停的锚点**有** `class="ClassName"`。

[W3.org](http://www.w3.org/TR/CSS2/selector.html)上有很多关于CSS 选择器的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T13:43:51.363

```
.ClassName  a:hover //this applies to all child `a` elements of `ClassName`
<div class="ClassName">
  <a>link</a>
</div>

a.ClassName:hover //this applies to the `a` elements that have `ClassName` class
<div>
  <a class="ClassName">link</a>
</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T13:44:38.383

> a.ClassName:hover

```
<a class="ClassName" href="#">fff</a> 
```

> .ClassName a:悬停

```
<div class="ClassName">
  <a href="#">fff</a>
</div> 
```

第一种方法仅适用于`<a>`具有 class 的元素`ClassName`。
第二种方法，类可以用于任何元素，如果该元素包含`<a>`悬停属性将被处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T13:45:14.273

是的，绝对有区别。

*   第一个匹配悬停的锚点，它们是具有 class 的元素的后代`ClassName`。
*   第二个匹配悬停的锚点与 class `ClassName`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-26T13:45:26.607

**.ClassName a:hover**表示`anchor`在里面`.ClassName`。它是

HTML

```
<div class="ClassName ">
 <a></a>
</div> 
```

**或者**

**a.ClassName:hover**表示`.ClassName`带有`anchor`. 它是

HTML

```
<a vlass="ClassName"></a> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-26T13:45:29.907

第一个修改已应用`hover`的任何元素内的任何链接的属性。`ClassName`

第二个适用于任何`a`已`ClassName`申请的内容，无论是否有任何关闭容器或标签。

# python - 将 AMQP 与石墨 9.9 一起使用

> ID：11208645
> 
> 赞同：3
> 
> 时间：2012-06-26T13:42:07.573
> 
> 标签：python, rabbitmq, amqp, graphite

我正在尝试使用 Graphite 内置的 AMQP 将 RabbitMQ 连接到 Graphite。但是，当我取消注释中的设置时，`carbon.conf`我得到：

```
notroot@ubuntu:/opt/graphite/bin$ sudo python carbon-cache.py start
Starting carbon-cache (instance a)
Traceback (most recent call last):
  File "carbon-cache.py", line 30, in <module>
    run_twistd_plugin(__file__)
  File "/opt/graphite/lib/carbon/util.py", line 92, in run_twistd_plugin
    runApp(config)
  File "/usr/lib/python2.7/dist-packages/twisted/scripts/twistd.py", line 23, in runApp
    _SomeApplicationRunner(config).run()
  File "/usr/lib/python2.7/dist-packages/twisted/application/app.py", line 386, in run
    self.application = self.createOrGetApplication()
  File "/usr/lib/python2.7/dist-packages/twisted/application/app.py", line 446, in createOrGetApplication
    ser = plg.makeService(self.config.subOptions)
  File "/opt/graphite/lib/twisted/plugins/carbon_cache_plugin.py", line 21, in makeService
    return service.createCacheService(options)
  File "/opt/graphite/lib/carbon/service.py", line 115, in createCacheService
    root_service = createBaseService(config)
  File "/opt/graphite/lib/carbon/service.py", line 50, in createBaseService
    from carbon import amqp_listener
  File "/opt/graphite/lib/carbon/amqp_listener.py", line 29, in <module>
    from txamqp.protocol import AMQClient
ImportError: No module named txamqp.protocol 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T13:59:41.273

点安装 txamqp

[http://pypi.python.org/pypi/txAMQP](http://pypi.python.org/pypi/txAMQP)

因为在石墨碳中没有真正实现 amqp，所以它使用 txamqp

# c# - 如何计算用户在 WP7 silverlight 应用程序上花费的总时间？

> ID：11208647
> 
> 赞同：0
> 
> 时间：2012-06-26T13:42:10.943
> 
> 标签：c#, silverlight, windows-phone-7

我需要将用户在应用程序上花费的总时间保存到一个独立的存储中。

我想我应该知道开始和结束执行的时间。

如果有任何方法可以做到这一点，请..

谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:46:39.757

App.xaml.cs 文件中有几个与执行模型直接相关的方法：

*   应用程序_启动
*   应用程序_已激活
*   应用程序_停用
*   Application_Closing

您可以挂钩此方法并提供所需的逻辑，这实际上非常简单：

*   Application_Launching - 初始化`spentTime`；
*   `spentTime`Application_Activated -从[`State`](http://msdn.microsoft.com/en-us/library/microsoft.phone.shell.phoneapplicationservice.state%28v=vs.92%29.aspx);恢复
*   Application_Deactivated - 重新计算时间并存储以便[`State`](http://msdn.microsoft.com/en-us/library/microsoft.phone.shell.phoneapplicationservice.state%28v=vs.92%29.aspx)能够进一步得到它；
*   Application_Closing - 重新计算并存储`spentTime`到[独立存储](http://msdn.microsoft.com/en-us/library/ff402541%28v=vs.92%29.aspx)。

了解 WP 执行模型的一些有用链接：

*   [Windows Phone 的执行模型概述](http://msdn.microsoft.com/en-us/library/ff817008%28v=vs.92%29.aspx)
*   [Windows Phone 的执行模型最佳实践](http://msdn.microsoft.com/en-us/library/ff817009%28v=vs.92%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:39:41.610

要添加到 AnatoliiG 的答案，您可以使用[DispaterTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer%28v=VS.95%29.aspx)类来计算时间。请小心使用 DateTime.Now 来计算用户使用该应用程序的时间，因为在一年中有时这会给您带来错误的值。

```
private _DispatcherTimer _timer;
private int _spentTime;

public Application()
{
    _timer = new DispatcherTimer { Interval = TimeSpan.FromSeconds(1) };
    _timer.Tick += TimerTick;
}

TimerTick(object s, EventArgs args)
{
    _spentTime++;
} 
```

然后按照 AnatoliiG 示例来节省花费在不同事件上的时间。

```
private void Application_Launching(object sender, LaunchingEventArgs e)
{
    _timer.Start();
    // Should probably have some logic to determine if they tombstoned the app
    // and did not actually leave the app, if so then save that time
}

private void Application_Activated(object sender, ActivatedEventArgs e)
{
    _timer.Start();
    // Restore _spentTime
}

private void Application_Deactivated(object sender, DeactivatedEventArgs e)
{
    _timer.Stop();
    // Store _spentTime
}

private void Application_Closing(object sender, ClosingEventArgs e)
{
    // Save time, they're done!
} 
```

# jsf - 从自定义组件中调用另一个 JSF 组件

> ID：11208650
> 
> 赞同：2
> 
> 时间：2012-06-26T13:42:21.437
> 
> 标签：jsf, jsf-2, primefaces, custom-component

是否可以从自定义组件中调用另一个 JSF 组件（而不是从复合组件）？

特别是，我希望从另一个组件的 encodeEnd 方法中调用 PrimeFaces 消息组件

我（天真地）希望这样的事情：

```
@Override
public void encodeEnd(FacesContext context, UIComponent component)
        throws java.io.IOException {

    // Do stuff...

    // set up Message object
    // tell Message object the current component's id
    // render Message object
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T15:03:47.543

这应该这样做：

```
import org.primefaces.component.message.Message;

// ...

Message message = new Message();
message.setParent(component);
message.setFor(component.getId());
message.encodeAll(context); 
```

# android - 如何填充微调器

> ID：11208655
> 
> 赞同：0
> 
> 时间：2012-06-26T13:42:31.353
> 
> 标签：android, android-spinner

我正在尝试填充微调器，但出现错误。这是我的代码...

```
private ArrayList<String> ctRatioList = new ArrayList<String>();
private ArrayList<String> rVoltsList = new ArrayList<String>();

@Override
public void onCreate( Bundle savedInstanceState ) {
    super.onCreate( savedInstanceState );
    setContentView( R.layout.parameters );

    ctRatioList.add( "800:5" );
    ctRatioList.add( "1200:5" );
    ctRatioList.add( "1600:5" );
    ctRatioList.add( "2000:5" );
    ctRatioList.add( "2500:5" );
    ctRatioList.add( "3000:5" );
    ctRatioList.add( "3500:5" );
    ctRatioList.add( "4000:5" );
    ctRatioList.add( "4500:5" );        
    Spinner ctRatioSpinner = (Spinner) findViewById( R.id.ctRatioSpinner );
    ArrayAdapter<String> ctRatioAdapter = new ArrayAdapter<String>( this, R.layout.parameters, ctRatioList );
    ctRatioSpinner.setAdapter( ctRatioAdapter );

    for( double i = 0; i < 10 ; i+=0.1 ) {
        rVoltsList.add( Double.toString( i ) );
    }
    Spinner rVoltsSpinner = (Spinner) findViewById( R.id.recloseVoltsSpinner );
    ArrayAdapter<String> rVoltsAdapter = new ArrayAdapter<String>( this, R.layout.parameters, rVoltsList );
    rVoltsSpinner.setAdapter( rVoltsAdapter );
} 
```

这是我的 LogCat ...

```
06-26 09:39:30.235: W/dalvikvm(7711): threadid=1: thread exiting with uncaught exception (group=0x40015560)
06-26 09:39:30.259: E/AndroidRuntime(7711): FATAL EXCEPTION: main
06-26 09:39:30.259: E/AndroidRuntime(7711): java.lang.IllegalStateException: ArrayAdapter requires the resource ID to be a TextView
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:347)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.ArrayAdapter.getView(ArrayAdapter.java:323)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.AbsSpinner.onMeasure(AbsSpinner.java:192)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.View.measure(View.java:8313)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.TableRow.getColumnsWidths(TableRow.java:308)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.TableLayout.findLargestCells(TableLayout.java:500)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.TableLayout.measureVertical(TableLayout.java:465)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.TableLayout.onMeasure(TableLayout.java:431)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.View.measure(View.java:8313)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.ScrollView.measureChildWithMargins(ScrollView.java:1074)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.ScrollView.onMeasure(ScrollView.java:296)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.View.measure(View.java:8313)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1017)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.LinearLayout.measureVertical(LinearLayout.java:386)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.LinearLayout.onMeasure(LinearLayout.java:309)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.View.measure(View.java:8313)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.View.measure(View.java:8313)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.LinearLayout.measureVertical(LinearLayout.java:531)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.LinearLayout.onMeasure(LinearLayout.java:309)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.View.measure(View.java:8313)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.View.measure(View.java:8313)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.ViewRoot.performTraversals(ViewRoot.java:839)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1859)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.os.Handler.dispatchMessage(Handler.java:99)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.os.Looper.loop(Looper.java:130)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.app.ActivityThread.main(ActivityThread.java:3683)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at java.lang.reflect.Method.invokeNative(Native Method)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at java.lang.reflect.Method.invoke(Method.java:507)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
06-26 09:39:30.259: E/AndroidRuntime(7711):     at dalvik.system.NativeStart.main(Native Method)
06-26 09:39:30.259: E/AndroidRuntime(7711): Caused by: java.lang.ClassCastException: android.widget.LinearLayout
06-26 09:39:30.259: E/AndroidRuntime(7711):     at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:340)
06-26 09:39:30.259: E/AndroidRuntime(7711):     ... 36 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:48:27.327

异常**显示“ArrayAdapter 要求资源 ID 为 TextView”**

在此调用中，资源`R.layout.parameters`不是文本视图，而是完整的布局：

```
ArrayAdapter<String> ctRatioAdapter = new ArrayAdapter<String>( this, R.layout.parameters, ctRatioList ); 
```

你应该使用类似的东西`android.R.layout.simple_spinner_item`。请参阅 Android 文档中的[Spinner 教程](http://developer.android.com/guide/topics/ui/controls/spinner.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:48:38.067

一旦您的适配器膨胀布局，在此布局`R.layout.parameters`中不包含任何**TextView检查。**

# php - MongoDb/PHP，无法使用聚合框架进行分组

> ID：11208656
> 
> 赞同：1
> 
> 时间：2012-06-26T13:42:33.533
> 
> 标签：php, mongodb, group-by, database

我正在尝试为网站设置消息收件箱，并且需要将用户（发件人或收件人）的所有文档分组到线程中。消息集合中充满了这样的文档：

```
{
"_id" : ObjectId("4fe8d8ac0a6d2ad9350000d9"),
"message" : "booo",
"recipient" : {
    "user_id" : ObjectId("4fd9f0600a6d2ac94f000003"),
    "viewed" : 1
},
"sender" : {
    "user_id" : ObjectId("4fdb3b780a6d2a9d29000047"),
},
"thread" : "c03a4e49348d009f4ddd8aae325128e1"
"date_sent" : ISODate("2012-06-25T21:31:24.230Z"), 
```

}

我可以使用 mongo 的 group 函数来获得所需的结果，但是您不能使用 group 进行排序或限制，所以我最好使用聚合框架，但我无法获得所需的结果。基本上我需要这样做：

```
 $groupBy = array(
            'thread'    =>  1,
        );
    $initial = array('count' => 0);

    $reduce = "function (obj, prev) { 
            prev.count++; 
            prev.message = obj.message; 
            prev.sender = obj.sender.user_id;
            prev.recipient = obj.recipient.user_id;
            prev.date_sent = obj.date_sent;
            prev.viewed = obj.recipient.viewed;
        }";

    $condition = array(
            '$or' => array(
                            array('sender.user_id'      => new MongoId($options['user_id'])), 
                            array('recipient.user_id'   => new MongoId($options['user_id']))
                        )
        );
    return $this->_collection->group($groupBy, $initial, $reduce, $condition); 
```

使用聚合框架，但我没有得到我需要的结果......基本上我有这个：

```
 $condition = array(
            '$or' => array(
                            array('sender.user_id'      => new MongoId($options['user_id'])), 
                            array('recipient.user_id'   => new MongoId($options['user_id']))
                        )
        );
    $returnFields = array(
            'message'           =>  1,
            'sender.user_id'    =>  1,
            'recipient.user_id' =>  1,
            'date_sent'         =>  1,
            'thread'            =>  1,
        );
    $sort       = array('date_sent' =>  1);
    $groupBy    = array('_id'       =>  '$thread');

    $input = array(
        'aggregate' =>  $this->_collectionName,
        'pipeline'  =>  array(
                array('$project'  =>  $returnFields),
                array('$match'    =>  $condition),
                array('$group'    =>  $groupBy),
                array('$sort'     =>  $sort),
            )
    );
    return $this->_db->command($input); 
```

它只是返回线程，就像它忽略了我的 $project ......任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:30:25.360

我已经想通了。不太确定为什么 $project 不携带，但是，我可以使用 $first 运算符来选择 $group 语句中的字段

```
 $condition = array(
            '$or' => array(
                            array('sender.user_id'      => new MongoId($options['user_id'])), 
                            array('recipient.user_id'   => new MongoId($options['user_id']))
                        )
        );

    $sort       = array('date_sent' =>  -1);

    $groupBy    = array(
            '_id'       =>  '$thread',
            'sender'    =>  array('$first' => '$sender.user_id'),
            'recipient' =>  array('$first' => '$recipient.user_id'),
            'date_sent' =>  array('$first' => '$date_sent'),
            'message'   =>  array('$first' => '$message'),
            'viewed'    =>  array('$first' => '$recipient.viewed'),
        );

    $input = array(
        'aggregate' =>  $this->_collectionName,
        'pipeline'  =>  array(
                array('$match'    =>  $condition),
                array('$sort'     =>  $sort),
                array('$group'    =>  $groupBy),
                array('$sort'     =>  $sort),

            )
    );

    return $this->_db->command($input); 
```

基本上，我需要匹配正确的文档，对它们进行排序，使最新消息排在第一位，执行 $group，我可以在其中使用 $first 运算符选择字段，然后再次对它们进行排序，以便它们按正确的顺序排列。不认为这是必要的，但这似乎工作正常。

# java - 新线程 JDialog 中的 JProgressBar

> ID：11208660
> 
> 赞同：1
> 
> 时间：2012-06-26T13:42:39.353
> 
> 标签：java, multithreading, swing, concurrency, jprogressbar

我想在新的 JDialog 中制作 JProgressBar，女巫将在与主逻辑分开的线程中。因此，我可以通过创建新的 JDialog 并通过处理 JDialog 来完成该进度来开始不确定的进度。但这让我很难做到这一点，因为在 JDialog 出现之后，它不会显示任何组件（包括 JProgressBar），直到主线程（SwingUtilities）中的逻辑完成。

包括 JDialog 的线程：

```
package gui.progress;

public class ProgressThread extends Thread {
    private ProgressBar progressBar = null;

    public ProgressThread() {
        super();
    }

    @Override
    public void run() {
        progressBar = new ProgressBar(null);
        progressBar.setVisible(true);
    }

    public void stopThread() {
        progressBar.dispose();
    }
} 
```

JProgressBar 切换方法：

```
private static ProgressThread progressThread = null;
...
public static void toggleProcessBar() {
    if(progressThread == null) {
        progressThread = new ProgressThread();
        progressThread.start();
    } else {
        progressThread.stopThread();
        progressThread = null;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-26T13:54:08.740

> 但这让我很难做到这一点，因为在 JDialog 出现之后，它不会显示任何组件（包括 JProgressBar），直到主线程（SwingUtilities）中的逻辑完成。

您在 Swing 中遇到[并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)问题，Swing 是单线程的，所有更新都必须在[EventDispatchThread](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)上完成，有两种方法

*   易于使用`Runnable#Thread`，但到 Swing GUI 的输出必须包含在`invokeLater`

*   使用[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)，有关示例`SwingWorker`在 Oracles [JProgressBar](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html)和[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)教程中

编辑

此代码也模拟了违反 EDT 和 SwingWorker 的正确解决方法

```
import java.awt.Dimension;
import java.awt.Toolkit;
import java.awt.Window;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;

import javax.swing.*;

public class TestProgressBar {

    private static void createAndShowUI() {
        JFrame frame = new JFrame("TestProgressBar");
        frame.getContentPane().add(new TestPBGui().getMainPanel());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                createAndShowUI();
            }
        });
    }

    private TestProgressBar() {
    }
}

class TestPBGui {

    private JPanel mainPanel = new JPanel();

    public TestPBGui() {
        JButton yourAttempt = new JButton("Your attempt to show Progress Bar");
        JButton myAttempt = new JButton("My attempt to show Progress Bar");
        yourAttempt.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                yourAttemptActionPerformed();
            }
        });
        myAttempt.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                myAttemptActionPerformed();
            }
        });
        mainPanel.add(yourAttempt);
        mainPanel.add(myAttempt);
    }

    private void yourAttemptActionPerformed() {
        Window thisWin = SwingUtilities.getWindowAncestor(mainPanel);
        JDialog progressDialog = new JDialog(thisWin, "Uploading...");
        JPanel contentPane = new JPanel();
        contentPane.setPreferredSize(new Dimension(300, 100));
        JProgressBar bar = new JProgressBar(0, 100);
        bar.setIndeterminate(true);
        contentPane.add(bar);
        progressDialog.setContentPane(contentPane);
        progressDialog.pack();
        progressDialog.setLocationRelativeTo(null);
        Task task = new Task("Your attempt");
        task.execute();
        progressDialog.setVisible(true);
        while (!task.isDone()) {
        }
        progressDialog.dispose();
    }

    private void myAttemptActionPerformed() {
        Window thisWin = SwingUtilities.getWindowAncestor(mainPanel);
        final JDialog progressDialog = new JDialog(thisWin, "Uploading...");
        JPanel contentPane = new JPanel();
        contentPane.setPreferredSize(new Dimension(300, 100));
        final JProgressBar bar = new JProgressBar(0, 100);
        bar.setIndeterminate(true);
        contentPane.add(bar);
        progressDialog.setContentPane(contentPane);
        progressDialog.pack();
        progressDialog.setLocationRelativeTo(null);
        final Task task = new Task("My attempt");
        task.addPropertyChangeListener(new PropertyChangeListener() {

            @Override
            public void propertyChange(PropertyChangeEvent evt) {
                if (evt.getPropertyName().equalsIgnoreCase("progress")) {
                    int progress = task.getProgress();
                    if (progress == 0) {
                        bar.setIndeterminate(true);
                    } else {
                        bar.setIndeterminate(false);
                        bar.setValue(progress);
                        progressDialog.dispose();
                    }
                }
            }
        });
        task.execute();
        progressDialog.setVisible(true);
    }

    public JPanel getMainPanel() {
        return mainPanel;
    }
}

class Task extends SwingWorker<Void, Void> {

    private static final long SLEEP_TIME = 4000;
    private String text;

    public Task(String text) {
        this.text = text;
    }

    @Override
    public Void doInBackground() {
        setProgress(0);
        try {
            Thread.sleep(SLEEP_TIME);// imitate a long-running task
        } catch (InterruptedException e) {
        }
        setProgress(100);
        return null;
    }

    @Override
    public void done() {
        System.out.println(text + " is done");
        Toolkit.getDefaultToolkit().beep();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:51:39.697

在主线程中显示进度条（所有挥杆工作都在其中进行），并在单独的线程上进行密集的后台工作。

UI 将一直响应（因为您不会阻塞主线程），并且您可以在长时间运行的任务完成时通知它。

# ios - 在 Xcode 和 iOS 中调试应用程序启动

> ID：11208665
> 
> 赞同：9
> 
> 时间：2012-06-26T13:42:57.977
> 
> 标签：ios, xcode, debugging

我有一个非常具体的案例需要调试。我需要检查应用程序在被杀死后重新启动时发生的情况（查看正在读取的存储数据等）。如果我从设备中终止应用程序，调试器就会停止（这是有道理的）。

我能想到的最好方法是杀死应用程序，然后从 Xcode 重新启动（不修改任何代码）。我正在尝试调查“现实世界”的行为。这是我的情况的最佳方法，还是有另一种方法来查看 Xcode 发生了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-26T13:50:45.750

在 Xcode 的 Scheme 编辑器中，您可以编辑 Debug 配置文件以使调试器“等待 XY.app 启动”。如果您随后选择 Product -> Run，调试器应等到您在设备上手动启动应用程序，然后自动附加到正在运行的进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-30T15:23:17.900

如果您想完全避免构建和运行阶段/更改构建配置，您可以通过以下方式实现冷启动重新附加：

*   进入调试菜单 >`Attach to Process by PID or Name...`
*   将您的应用名称放在第一个输入中并单击`Attach`

然后你会看到“Waiting to attach to APPNAME on somedevice”，你可以在模拟器上重新打开应用程序。

# screen - 在 Caliburn.Micro 中将值/数据从一个屏幕传递到另一个屏幕

> ID：11208668
> 
> 赞同：3
> 
> 时间：2012-06-26T13:43:09.743
> 
> 标签：screen, caliburn.micro

我最近一直在使用 Caliburn.Micro 框架。我有一个 ShellView 和两个屏幕，我们称它们为 ScreenOne 和 ScreenTwo。我正在尝试将数据从 ScreenOne 传递到 ScreenTwo。我已经在网上广泛查看，我不敢相信这很难找到。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T16:42:09.953

一种替代方法是使用事件聚合器并使用发布/订阅技术在屏幕之间进行通信。在[事件聚合器教程](http://caliburnmicro.codeplex.com/wikipage?title=The%20Event%20Aggregator)中有一个示例，其中两个视图模型都发布自己的事件并订阅另一个视图模型的事件。该示例在一个源代码示例*HelloEventAggregator*中进行了进一步阐述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T15:17:10.860

假设您`ShellViewModel`是一个导体，并且同时引用了`ScreenOneViewModel`and `ScreenTwoViewModel`，您可以在视图模型的构造点（即，当您实例化这些视图模型时）将数据作为构造函数参数传递给视图模型，也可以在以后通过公共方法传递给它们或财产。

使用视图模型工厂的示例：

```
public class ShellViewModel : Conductor<IScreen>.Collection.OneActive 
{
    private readonly IScreenOneViewModelFactory screenOneViewModelFactory;

    private readonly IScreenTwoViewModelFactory screenTwoViewModelFactory;

    public ShellViewModel(
            IScreenOneViewModelFactory screenOneViewModelFactory,
            IScreenTwoViewModelFactory screenTwoViewModelFactory)
    {
       this.screenOneViewModelFactory = screenOneViewModelFactory;
       this.screenTwoViewModelFactory = screenTwoViewModelFactory;

       var screenOneViewModel = this.screenOneViewModelFactory.CreateViewModel();
       this.ActivateItem(screenOneViewModel);
    }

    public void MyMethod()
    {
       // Get data from screen one
       var myData = this.screenOneViewModel.Data;

       // Create a screen two view model from the screen one data
       var screenTwoViewModel = 
            this.screenTwoViewModelFactory.CreateViewModel(myData);
       this.ActivateItem(screenTwoViewModel);           
    }
} 
```

# javascript - Titanium Appcelerator：在 TableView 中创建 TextField

> ID：11208671
> 
> 赞同：1
> 
> 时间：2012-06-26T13:43:17.630
> 
> 标签：javascript, mobile, titanium, appcelerator

我尝试了几种不同的方法。我得到了要在表格视图中显示的文本字段（我想要一个文本字段表），但是在我键入时文本没有出现在字段中。键盘来了，它是可点击的。当不在表格视图中时，相同的文本字段效果很好。

```
 textFields['user'] = Ti.UI.createTextField({
width:"100%", height:50,
softKeyboardOnFocus : Ti.UI.Android.SOFT_KEYBOARD_SHOW_ON_FOCUS
 });

 ....

 var myRows = [];

 var myRow = Titanium.UI.createTableViewRow({height:50, touchEnabled:false});
 myRow.add(textFields['user']);

 myRows.push(myRow);

 tableview = Ti.UI.createTableView({
data: myRows
 });

 var view = Ti.UI.createView({top:10});
 view.add(tableview);
 serverInfoWinInstance.add(view); 
```

我尝试像往常一样将 tableview 直接添加到窗口中，但同样的事情发生了。我正在使用 Android，但是我希望它也可以在 iPhone 上使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T21:23:14.293

我认为您的问题可能是您的表格行具有`touchEnabled : false`该表格的所有子元素继承的内容。因此，当您将文本字段添加到表格行时，它们也有`touchEnabled : false`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T12:58:24.150

您没有构造文本字段**值**属性

```
textFields['user'] = Ti.UI.createTextField({
value : "",  // need construct the value 
width:"100%", 
height:50,
softKeyboardOnFocus : Ti.UI.Android.SOFT_KEYBOARD_SHOW_ON_FOCUS
}); 
```

或使用：

```
textFields['user'] = Ti.UI.createTextField({
    hintText: 'Enter Name '
    width:"100%", 
    height:50,
    softKeyboardOnFocus : Ti.UI.Android.SOFT_KEYBOARD_SHOW_ON_FOCUS
    }); 
```

# c# - 如何在 C# 中跨平台复制文件？

> ID：11208673
> 
> 赞同：0
> 
> 时间：2012-06-26T13:43:19.803
> 
> 标签：c#, file, copy, cross-platform

基本上我需要在不使用 Microsoft`System.IO.File.Copy`库的情况下复制文件（FAT 或 NTFS 都可以）。我正在使用 COSMOS（C# 开源托管操作系统），因为那不是 Windows，所以`File.Copy`它不起作用。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:10:05.027

您有 System.IO 命名空间的任何其他部分吗？最值得注意的是，各种流？

如果没有，那么我看不出你应该如何复制任何东西。

但是，假设您可以打开文件进行读写，您可以轻松实现自己的复制方法：

```
private void CopyFile(string source, string dest)
{
    using (var input = new FileStream(source, FileMode.Open, FileAccess.Read))
    using (var output = new FileStream(dest, FileMode.OpenOrCreate, FileAccess.Write))
    {
        byte[] data = new byte[1024];
        int bytesRead = 0;
        do
        {
            bytesRead = input.Read(data, 0, data.Length);
            if (bytesRead > 0)
                output.Write(data, 0, data.Length);
        } while (bytesRead > 0);
    }
} 
```

（以上代码未经测试）

# mongodb - MongoDB适合加载随机记录吗？

> ID：11208675
> 
> 赞同：0
> 
> 时间：2012-06-26T13:43:23.167
> 
> 标签：mongodb

我们的应用程序存储具有较短文本（100-1000 个字符的字符串）的记录。它提供对给定查询文本最相似记录的搜索。我们使用 Lucene 来索引文本。完整的记录存储在数据库中。每条记录只属于一个域，现在有 1000 多个域。域名数量不受限制，但增长缓慢。记录不断地添加到所有域中（不统一）。

我们使用 Mysql 作为数据库，每个域都有自己的表。现在由于横向扩展，我们尝试迁移到 MongoDB。所有记录都存储在单个集合中，域是记录的属性。ID 仍然是从 Lucene 搜索中获得的。但是我们观察到与使用 Mysql 的解决方案相比，从 MongDB 加载记录的性能较差。我怀疑MongoDB的“内存映射存储引擎”是原因。每次搜索都可以返回“随机记录”。通常会从一个域连续进行更多搜索。来自一个域的记录不会存储在集合中的一个位置。这可能会导致许多页面错误。

我的解释对吗？MongoDB 适合这种记录加载吗？什么可以提高性能？MongoDB 服务器和应用程序在 Linux 上运行。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T10:06:00.503

因此，重要的是您的工作集（数据和索引）适合 RAM。有大量关于此的帖子/博客，所以只需 google “MongoDB 工作集”，但如您所知，从 RAM 访问而不是分页到磁盘更快。

请记住，如果您有一个写入繁重的环境，您需要考虑扩展您的写入，这就是您需要查看[分片](http://docs.mongodb.org/manual/faq/sharding/?highlight=sharding)的地方，然后关键决定是选择正确的分片键。这非常重要，而且它是不可变的，所以要多考虑：) 这是一个关于选择密钥的好[文档。](http://www.mongodb.org/display/DOCS/Choosing+a+Shard+Key)

另一件事，关于 Java 驱动程序，使用[2.8 版本](https://jira.mongodb.org/secure/ReleaseNote.jspa?projectId=10006&version=10980)，已经有很多变化，包括一些与[分片相关](https://jira.mongodb.org/browse/JAVA-525)的变化。

最后，您可以免费使用[Mongo 监控服务](http://10gen.com/mongodb-monitoring-service)来帮助监控您的实施。它非常适合概览，也适合深入研究。

# php - 使用 CArrayDataProvider 对 CGridView 中的日期列进行排序

> ID：11208678
> 
> 赞同：1
> 
> 时间：2012-06-26T13:43:26.293
> 
> 标签：php, yii

我在网站上使用 CGridView 来显示通过 CArrayDataProvider 提供的数据。这样做的原因是，数据在不同的表中累积，并通过额外的计算列进行了丰富。使用此代码排序和过滤通常可以正常工作（...被省略列）：

```
$this->widget('zii.widgets.grid.CGridView', array(
    'id'=>'produkt-grid',
    'dataProvider'=>new CArrayDataProvider($betroffeneProdukte, array(
            'sort' => array(
                'attributes' => array(
                    'bezeichnung',
                    'datum',
                    ...
                ),
            ),
            'pagination' => false,
        )),
    'enableSorting' => true,
        'columns'=>array(
            array(
                'name'=>'bezeichnung',
                'header'=>'Bezeichnung',
                'value'=>'$data["bezeichnung"]',
            ),
            array(
                'name'=>'datum',
                'header'=>'datum',
                'value'=>'$data["datum"]',
            ),
            ...
        ),

)); 
```

问题是日期列。它排序为这样的字符串（德语格式）：01.10.2012, 03.08.2012, 10.01.2012, 15.02.2012, ...

我当然想像这样正确排序：10.01.2012, 15.02.2012, 03.08.2012, 01.10.2012, ...

有人对我有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:26:41.893

感谢您为我指明正确的方向。实际上，我的示例中的“基准”列是一个字符串，因为我必须在我的应用程序中使用虚拟属性来正确格式化德语日期。现在我使用数据库中的原始日期列并在视图中对其进行格式化，如下所示：

```
array(
  'name'=>'datecolumn',
  'header'=>'Eingangsdatum',
  'value'=>'Yii::app()->dateFormatter->formatDateTime(strtotime($data["datecolumn"]), "medium", null)',
), 
```

=> 瞧，德语显示，能够正确排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T20:24:58.283

我认为您需要从数据源向您的 CArrayDataProvider 发送原始日期/日期时间字符串，然后使用 CGridView 对其进行格式化：

```
array(
    'name'=>'datum',
    'header'=>'datum',
    'value'=>'$data["datum"]',
    'type'=>'date',
), 
```

看起来你的问题是 Yii 认为你的日期是一个字符串（而不是一个日期）。如果您转向为 DataProvider 提供日期，则排序可能会自行解决。

# java - 从使用 JWS 下载的 jar 文件中提取一些内容

> ID：11208681
> 
> 赞同：1
> 
> 时间：2012-06-26T13:43:35.467
> 
> 标签：java, filesystems, nio, java-7, java-web-start

我试图从使用 java-webstart 下载的 jar 文件中提取一些文件。下面的代码用于定位 jar 并启动 FileSystem

```
1 final ProtectionDomain domain = this.getClass().getProtectionDomain();
2 final CodeSource source = domain.getCodeSource();
3 final URL url    = source.getLocation();
4 final URI uri    = url.toURI();
5 Path jarPath = Paths.get(uri);
6
7 FileSystem fs = FileSystems.newFileSystem(jarPath, null); 
```

当 jar 文件位于本地磁盘上时，这可以正常工作，但在 JWS 场景中的第 5 行失败，因为

日志说： url=http://localhost:8080/myjarfile.jar

```
java.nio.file.FileSystemNotFoundException: Provider "http" not installed
at java.nio.file.Paths.get(Unknown Source) 
```

如果我正确理解 JWS，myjarfile.jar 已经下载到某个缓存，因此为 http 实现 FileSystemProvider 以从 myjarfile.jar 获取一些内容似乎很慢而且很复杂。那么关于如何进行的任何好主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:54:18.377

> 日志说： url=http://localhost:8080/myjarfile.jar

这是 Sun 在 Oracle 收购它们之前做出的安全决定。他们认为这与小程序或 JWS 应用程序无关。知道资源在本地文件系统上的位置，因此返回的 URI 现在将始终指向服务器，即使它们在本地和应用程序中缓存。有`all-permissions`安全级别。

> 那么关于如何进行的任何好主意？

重新设计应用程序。这是唯一可行的解​​决方案。

有多种方法可以为内容迭代 Zip 或 Jar，但最简单的方法是在 Jar 的已知位置包含内容列表，使用 定位它`getResource()`，读取它，然后提取每个资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T04:58:16.203

下面是你的想法 Andrew 的实现，它利用了我在这里找到的 DirUtil 包：http: [//codingjunkie.net/java-7-copy-move/](http://codingjunkie.net/java-7-copy-move/)

```
public class Zipper {

    private static final String TEMP_FILE_PREFIX = "temp-";
    private static final String TEMP_FILE_SUFIX = ".jar";

    private Logger logger = Logger.getLogger(getClass().getName());

    public Path extractProgram(String locationOfEmbeddedJar, String installDir) {
        Path installPath = null;
        try {
            installPath = Paths.get(installDir);
            if (Files.isDirectory(installPath)) {
                logger.warn("program already installed");
            } else {
                installPath = Files.createDirectory(installPath);
                Path tempJar = Files.createTempFile(TEMP_FILE_PREFIX,
                        TEMP_FILE_SUFIX);
                this.extractEmbeddedJar(locationOfEmbeddedJar, tempJar.toFile());

                logger.warn("in jarfile");
                // in jar file
                FileSystem fs = FileSystems.newFileSystem(tempJar, null);
                Path programPath = fs.getPath("/");

                logger.warn("programPath=" + programPath + " fileSystem="
                        + programPath.getFileSystem());

                DirUtils.copy(programPath, installPath);
            }
        } catch (IOException e) {
            logger.warn(e);
        }

        return (installPath);

    }

    private void extractEmbeddedJar(String locationOfEmbeddedJar,
            File locationOfTargetJar) {
        logger.warn("extractEmbeddedJar() " + locationOfEmbeddedJar);
        ClassLoader loader = this.getClass().getClassLoader();

        InputStream inputStream = loader
                .getResourceAsStream(locationOfEmbeddedJar);
        try {
            OutputStream out = new FileOutputStream(locationOfTargetJar);
            byte buf[] = new byte[1024];
            int len;
            while ((len = inputStream.read(buf)) > 0) {
                out.write(buf, 0, len);
            }
            out.close();
            inputStream.close();

        } catch (IOException e) {
            logger.warn(e);
        }
    }
} 
```

# iphone - tableView didSelectRowAtIndexPath：活动指示器未正确显示

> ID：11208682
> 
> 赞同：0
> 
> 时间：2012-06-26T13:43:36.583
> 
> 标签：iphone, objective-c, ios, ipad

当用户点击它应该显示的表格视图的单元格时，我试图显示一个活动指示器vw，并且一旦加载详细视图，它就应该被隐藏。

但它在视图加载后显示然后隐藏。所以在视图加载时显示指示器是没有用的

内部viewdidload：

```
activityBgImageView = [[UIView alloc] initWithFrame:self.view.frame];
[activityBgImageView setBackgroundColor:[UIColor blackColor]];
[activityBgImageView setAlpha:0.7];
[activityBgImageView setCenter:self.view.center];
[activityBgImageView setHidden:YES];

activityIndicatorView = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
[activityIndicatorView setCenter:CGPointMake(self.view.center.x+15, self.view.center.y-15)];
[activityIndicatorView setHidesWhenStopped:YES];
[activityBgImageView addSubview:activityIndicatorView];
[self.view addSubview:activityBgImageView]; 
```

这是我的表格代码选择：

```
if([arrPostsData count]>0)
{
    [self startActivityIndicatorView];

    [self performSelector:@selector(showDetailVw) withObject:nil];

}

-(void)showDetailVw
{

[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:.3];
detailVwBg.alpha = 0.0;
detailVwBg.alpha = 1.0;
btnBack.alpha = 1;

 [self showPostDetail:arrPostsData tapedCell:detailvwScrollCount     PostedFiles:arrUserPostedFilesDataDic comments:arrCommentsDataDic];

isDetailvwActive = TRUE;
[UIView commitAnimations];

}

and inside showPostDetail: method end i stop the indicator 
```

请建议我需要在哪里放置正确的代码

这些是指标方法：

```
#pragma mark processindicator methods

-(void)startActivityIndicatorView{ 

[activityBgImageView setHidden:NO];
[activityIndicatorView startAnimating];
[self.view bringSubviewToFront:activityBgImageView];

if (![[UIApplication sharedApplication] isIgnoringInteractionEvents])
{
    [[UIApplication sharedApplication] beginIgnoringInteractionEvents];
}

}

-(void)stopActivityIndicatorView{

if ([[UIApplication sharedApplication] isIgnoringInteractionEvents])
{
    [[UIApplication sharedApplication] endIgnoringInteractionEvents];
}
[activityBgImageView setHidden:YES];
[activityIndicatorView stopAnimating];

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T13:47:47.413

关于线程和 iOS 的一点背景知识。对于所有 UI 元素的更改（视觉上），程序员需要在主线程中对它们进行更改。

由于`activityIndicatorView`是 UI 元素，它必须在主线程上运行才能显示旋转。如果您在主线程上执行其他操作，则会`activityIndicatorView`被阻止。因此，您不会立即看到旋转。当线程被释放时你会看到它。

如果你想让它工作，那么首先启动微调器，然后是后台线程，在 bg 线程中进行处理，完成后，进入主线程，停止微调器，最后用更改更新 UI。

希望这可以帮助...

# java - 如何在一个列表中过滤相同的纬度，日志值？

> ID：11208683
> 
> 赞同：0
> 
> 时间：2012-06-26T13:43:40.537
> 
> 标签：java, android

我有提供特定区域财产列表的网络服务我的问题是所有财产都必须显示在地图上，如果在任何情况下列表中有两个以上的经纬度相同的财产，那么该财产将显示在谷歌上的相同气泡上map 我一直在解析结果，但我无法过滤那些在 xml 中具有相同纬度和经度的属性。我正在尝试解析数组列表返回后：-

```
 private Vector groupTheList(ArrayList<Applicationdataset> arrayList) 
{
    Vector<ArrayList<Applicationdataset>> mgroupvector = new Vector<ArrayList<Applicationdataset>>();
    ArrayList<Applicationdataset> mfirstList = new ArrayList<Applicationdataset>();
    ArrayList<Applicationdataset> mylist=null;
    int sizeoflist = arrayList.size();
    for(int index =0;index<arrayList.size();index++)
    {
         //ArrayList<Applicationdataset> mylist= mgroupvector.get(index);
         if(mylist==null)
         {
             mylist = new ArrayList<Applicationdataset>(); 
         }
         mfirstList.add(arrayList.get(index));

        for(int mindex=1;mindex<arrayList.size();mindex++)
        {
         if(arrayList.get(index).getLatitude().equalsIgnoreCase(arrayList.get(mindex).getLatitude()) &&
                 arrayList.get(index).getLongitude().equalsIgnoreCase(arrayList.get(mindex).getLongitude()))
         {
             mfirstList.add(arrayList.get(mindex));
             arrayList.remove(mindex);
         }
        }
        mylist.addAll(mfirstList);
        mgroupvector.add(mylist);
        mfirstList.clear();
        arrayList.remove(index);
        index-=1;
    }
    mgroupvector.add(arrayList);
    return mgroupvector;

} 
```

但进一步我无法做任何人请帮助我。请任何人帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:02:23.527

像这样的东西：

```
.......
private Collection<List<Applicationdataset>> groupTheList(ArrayList<Applicationdataset> arrayList) {
    Map<Key, List<Applicationdataset>> map = new HashMap<Key, List<Applicationdataset>>();
    for(Applicationdataset appSet: arrayList){
        Key<String, String> key = new Key(appSet.getLatitude(), appSet.getLongtitude());
        List<Applicationdataset> list = map.get(key);
        if(list == null){
            list = new ArrayList<Applicationdataset>();
            map.put(key, list);
        }
        list.add(appset);
    }
    return map.values();
}
........

class Key {
    String _lat;
    String _lon;

    Key(String lat, String lon) {
        _lat = lat;
        _lon = lon;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        Key key = (Key) o;

        if (!_lat.equals(key._lat)) return false;
        if (!_lon.equals(key._lon)) return false;

        return true;
    }

    @Override
    public int hashCode() {
        int result = _lat.hashCode();
        result = 31 * result + _lon.hashCode();
        return result;
    }
} 
```

# java - 从 Java Web Start (JNLP) 修改 Windows 防火墙规则

> ID：11208686
> 
> 赞同：0
> 
> 时间：2012-06-26T13:43:43.297
> 
> 标签：java, windows, firewall, jnlp, java-web-start

我有一个基于 Java Web-Start 的应用程序，它利用了几个本机“.exe”实用程序。所有 jar 都已签名，并且应用程序从用户那里获得所有可能的权限（`<security><all-permissions/></security>`在 .jnlp 描述符中）。问题是其中一个“.exe”实用程序试图打开并侦听某个端口，这会导致标准 Windows 防火墙窗口弹出。例子：

[![例子](../Images/3052fd1f4a16d457ac937f3a4b690cc9.png)](https://i.stack.imgur.com/uRhTl.jpg)
[（来源：[7tutorials.com](http://www.7tutorials.com/files/img/win_firewall/wf3.jpg)）]

在用户同意在 JNLP 启动期间授予我的应用不受限制的权限后，我希望用户不要看到任何此类消息。据我所知，以编程方式添加防火墙规则既可以使用[**netsh 工具**](https://support.microsoft.com/en-us/help/947709/how-to-use-the-netsh-advfirewall-firewall-context-instead-of-the-netsh)，也可以通过修改注册表来执行，这两者都需要管理员权限。

我尝试使用[**Elevation PowerToys**](https://docs.microsoft.com/en-us/previous-versions/technet-magazine/cc510320(v=msdn.10))，从 Java 调用它们，但它们弹出另一条消息，明确请求管理员权限。

问题：有什么方法可以将我的“.exe”实用程序的规则添加到 Windows 防火墙中，而不会因额外的权限请求而激怒用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:47:13.323

您在这里混合了安全域 - java 安全模型，以及您授予由 jnlp 执行的应用程序的权限与 Windows 理解的权限是分开的。启动的标准 jnlp 应用程序作为普通应用程序运行，没有提升。

我认为不要求提升是不可能的；你似乎已经很好地处理了这一点。

# css - div 内的 div 垂直和水平居中对齐

> ID：11208690
> 
> 赞同：0
> 
> 时间：2012-06-26T13:43:52.317
> 
> 标签：css

我有两个 div 一个在另一个里面。我已经为两个 div 设置了一些边框，并且我希望两个 div 在水平和垂直方向上都位于页面的中心。我已经看到了类似问题的解决方案，但无法解决我的问题。还请分享好的资源，我可以从中了解定位，即相对绝对深度。

下面是我的 HTML 代码：

```
<!DOCTYPE html>
<style type="text/css">
    .outer {
        color:black;
        width: 400px;
        height:400px;
        border: 100px solid;
        border-radius:100%;
        border-color: red blue green yellow;
        position: static;
        margin: auto  auto auto auto;
        top:50%;
    }
    .inner{
        color:black;
        width: 100px;
        height:100px;
        border: 50px solid;
        border-radius:100%;
        border-color: red transparent green transparent;
        position: relative;
        top:50%;
        margin: -50px auto auto auto;
    }
</style>
<html>
    <body>
        <div class="outer">
            <div class="inner">
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:52:33.760

**如果**你知道两个盒子的大小，并且它们*不会*改变，你可以使用这个：

```
.outer {
  color:black;
  width: 400px;
  height:400px;
  border: 10px solid;
  border-color: red blue green yellow;
  position: absolute;
  margin: -200px  auto auto -200px;
  top:50%;
  left: 50%;
}
.inner{
  color:black;
  width: 100px;
  height:100px;
  border: 5px solid;
  border-color: red transparent green transparent;
  position: absolute;
  top:50%;
  left: 50%;
  margin: -50px auto auto -50px;
}​ 
```

*注意*我取出了边框半径并缩小了边框大小以使点更清晰。

基本上，您可以使用具有相对单位 (%) 的绝对定位，但使用固定的负边距，即框大小的一半。

[见 JS 小提琴](http://jsfiddle.net/EJu3N/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:53:58.333

**大多数时候**水平居中并不是什么大问题。**将`margin: 0 auto`样式添加到 a`div`将主要执行您想要的操作。**

 ****然而，垂直居中**似乎有点复杂。此处列出了 6 个垂直居中选项：[http ://www.vanseodesign.com/css/vertical-centering/](http://www.vanseodesign.com/css/vertical-centering/)

另请注意该文章中的*其他资源*部分，其中还列出了一些很好的参考资料。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:02:00.713

您的 div的实际`height`&`width`是 200px，包括`borders`. 因此，在您的内部，您将左和上边距设置为`actual size/2`：

```
.inner{
  ...
  top: 50%;
  left: 50%;
  margin: -100px 0 0 -100px;

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-17T10:05:09.587

将 div 对齐到页面中心的一种聪明方法是使用 display:table 和 display:table-cell 方法。

HTML：

```
<div class="wrapper"> 
<div class="box"> 
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc quis pretium arcu, eget semper lacus. Aliquam aliquam, augue non bibendum pretium, felis neque eleifend tortor, ut luctus mi ante vel nisl. Mauris id enim elit.
</p> 
</div> 
</div> 
```

CSS：

```
html,body{
margin: 0;
padding: 0;
width: 100%;
height: 100%;
display: table;}

.wrapper {
display: table-cell;
text-align: center;
vertical-align: middle;
}

.box {
background-color: red;
display: inline-block;
text-align: center;
padding:10px;
width: 100px;
height:auto;
} 
```

观看现场演示：

[http://jsfiddle.net/Narppavi/ej6yL/](http://jsfiddle.net/Narppavi/ej6yL/)**

# iphone - 消息表达式中的参数是未初始化的值 (imageFile)

> ID：11208691
> 
> 赞同：0
> 
> 时间：2012-06-26T13:44:06.667
> 
> 标签：iphone, objective-c, cocos2d-iphone

我之前查过几次，我尝试了答案所说的，但是当我运行 Xcode 的分析器时，它说相同的“消息表达式中的参数是一个未初始化的值”。这是 switch 语句：

`

```
NSString *imageFile;
switch (randomCoinType) {

    case 1:

        imageFile = @"coin.1.png";
        break;

    case 2:

        imageFile = @"coin.2.png";
        break;

    case 3:
    case 4:
        imageFile = @"coin.3.png";
        break;

    case 5:
    case 6:
    case 7:
    case 8:
        imageFile = @"coin.4.png";
        break;

    case 9:
        imageFile = @"coin.5.png";
        break;

    case 0:
        imageFile = @"coin.6.png";
        break;

    default: 

        break;

      }

//argument in message is uninitialized here!
Coins *c = [Coins spriteWithFile:imageFile];

c.type = type;
c.position = position;
c.velocity = ccp(0,0);
[coins addObject:c];
[self addChild:c z:2]; 
```

}

`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:52:57.413

如果您的`default`语句被调用，那么`imageFile`就是`nil`并且`spriteWithFile`不知道该怎么做。确保您要么处理`nil`传递的语句`default`，要么设置`imagefile`为默认情况下可用的内容。

# iphone - 当我在 iPhone 上将方向从纵向更改为横向时，我遇到了 iScroll4 的问题

> ID：11208697
> 
> 赞同：1
> 
> 时间：2012-06-26T13:44:37.713
> 
> 标签：iphone, landscape, iscroll4

当我将方向从纵向更改为横向时，我遇到了 iScroll4 的问题。它在 AppMobi XDK 上运行，但在 iPhone 上，它不能正确渲染。我试图捕获orientationchange事件并使用不同的超时值调用iScroll的刷新方法，但没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T04:51:48.943

请使用链接中的 jq.scroller.js：

[https://github.com/appMobi/jQ.Mobi/tree/master/plugins](https://github.com/appMobi/jQ.Mobi/tree/master/plugins)

它很容易像这样使用：

```
 var options={
  verticalScroll:true, //vertical scrolling
  horizontalScroll:false, //horizontal scrolling
  scrollBars:true  //display scrollbars
  vScrollCSS : "scrollBarV", //CSS class for veritcal scrollbar 
  hScrollCSS : "scrollBarH", //CSS class for horizontal scrollbar
  refresh:true, //Adds 'Pull to refresh' at the top
  refreshFunction:updateMessage //callback function to execute on pull to refresh
}

var scroller = $("#my_div").scroller(options); 
```

将#my_div 替换为您的 div ID。它将完美运行。

谢谢

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-29T12:26:16.990

这是 iScroll 的一个错误。我是 appMobi 的开发人员，jqMobi 的首席开发人员，我们的滚动库没有这个问题。

# java - 陈述 。executeUpdate 在第 1 行错误处为 X 列截断日期

> ID：11208701
> 
> 赞同：1
> 
> 时间：2012-06-26T13:44:52.837
> 
> 标签：java, mysql, truncated

我正在开发一个尝试通过 tsv infile 将数据插入 mysql 数据库的 java 项目。运行此程序时，它给了我以下错误：

> 线程“主”java.sql.SQLException 中的异常：com.mysql.jdbc.SQLError.createSQLException(SQLError.java:946) 在 com.mysql.jdbc.MysqlIO.checkErrorPacket( MysqlIO.java:2985) 在 com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1631) 在 com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1723) 在 com.mysql.jdbc.Connection.execSQL (Connection.java:3277) 在 com.mysql.jdbc.Statement.executeUpdate(Statement.java:1402) 在 com.mysql.jdbc.Statement.executeUpdate(Statement.java:1317) 在 LogProcessing.LogReader.addDay(LogReader. java:313) 在 LogProcessing.LogReader.updateTables(LogReader.java:177) 在 LogProcessing.LogReader.start(LogReader.java:59) 在 LogProcessing.LogReader.main(LogReader.java:45)

代码是

```
s.executeUpdate(query); 
```

查询在哪里

```
LOAD DATA INFILE 'C:/temp/BA5770/tmp/temp.dat'INTO TABLE thisweek FIELDS TERMINATED BY '    '; 
```

奇怪的是，当我复制这个查询并直接输入到mysql中时，它被接受了。

> mysql> LOAD DATA INFILE 'C:/temp/BA5770/tmp/temp.dat' INTO TABLE thisweek FIELDS TERMINATED BY ' '; 查询正常，76932 行受影响，65535 条警告（2.44 秒）记录：76932 已删除：0 跳过：0 警告：76932

该表如下所示：

```
mysql> show columns from thisweek;
+------------+----------------------+------+-----+---------+-------+
| Field      | Type                 | Null | Key | Default | Extra |
+------------+----------------------+------+-----+---------+-------+
| functionID | smallint(5) unsigned | YES  | MUL | NULL    |       |
| serverID   | tinyint(3) unsigned  | YES  |     | NULL    |       |
| date       | date                 | YES  |     | NULL    |       |
| time       | time                 | YES  |     | NULL    |       |
| calls      | int(10) unsigned     | YES  |     | NULL    |       |
| meanTime   | float                | YES  |     | NULL    |       |
| WSC        | float                | YES  |     | NULL    |       |
| THM_DB2    | float                | YES  |     | NULL    |       |
| DEP        | float                | YES  |     | NULL    |       |
| Tandem     | float                | YES  |     | NULL    |       |
| LDAP       | float                | YES  |     | NULL    |       |
| PS         | float                | YES  |     | NULL    |       |
| IAV        | float                | YES  |     | NULL    |       |
| IMS        | float                | YES  |     | NULL    |       |
| Services   | float                | YES  |     | NULL    |       |
+------------+----------------------+------+-----+---------+-------+
15 rows in set (0.00 sec) 
```

输入数据如下所示：

```
31  0   20111207    235900  19  0.0 -1.0    -1.0    -1.0    -1.0    -1.0    -1.0    -1.0    -1.0    -1.0
32  0   20111207    235900  405 60.94   0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
33  0   20111207    235900  1   32.0    24.0    14.0    0.0 0.0 0.0 0.0 8.0 0.0 24.0
34  0   20111207    235900  3   39.0    36.0    21.0    6.0 0.0 0.0 0.0 8.0 0.0 32.0
35  0   20111207    235900  27  9.44    -1.0    -1.0    -1.0    -1.0    -1.0    -1.0    -1.0    -1.0    -1.0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:32:19.220

你怎么能说在 mysql 控制台上接受了查询？
查看执行状态语句：

```
Query OK, 76932 rows affected, 65535 warnings (2.44 sec)
Records: 76932 Deleted: 0 Skipped: 0 Warnings: 76932 
```

对于`76932`记录，生成的警告是`76932`，这意味着每条记录都有一些可调整的错误。查询执行后在 mysql 控制台执行，
也许`show warnings`您 会看到大部分警告消息。 `load data ...`
`... data truncated ...`

使用MySQL`float`并`double`遇到问题。
一种解决方法是：

1.  在and上使用`decimal`or`real`数据类型。`float``double`
2.  在数据文件中使用正确的浮点精度。但这对于大型数据文件来说是乏味的。

在以下位置报告了错误和解决方法：

1.  [在浮点中，与 FLOAT 和 DOUBLE 有相同的问题。REAL 和 DECIMAL 工作正常。](http://bugs.mysql.com/bug.php?id=18335)
2.  [我不知道 Float 和 Double 会发生什么，但我的镜头是 Float 制作的 ROUND ... DECIMAL 可以正常工作。](http://bugs.mysql.com/file.php?id=3184)
3.  [FLOAT 和 DOUBLE 可能会因为它们循环程序而弄乱数据。](http://forums.mysql.com/read.php?79,76131,76871)

# mysql - MySQL 5 使用 JOIN 和 UNION 出错

> ID：11208713
> 
> 赞同：0
> 
> 时间：2012-06-26T13:45:25.473
> 
> 标签：mysql, join, union

我有许多在 MySQL 4 下运行的 MySQL 语句，但不是 MySQL 5。这些语句结合了 UNION 和 JOIN。

为了简化 MySQL 语句，我得出以下在 MySQL 4 下运行但不在 MySQL 5 下运行的语句：

```
SELECT
  bteamres.rank AS `rank`
FROM
  bteamres
    LEFT OUTER JOIN (btourn AS tourn) ON (bteamres.tourncode=tourn.tourncode)
WHERE
  (bteamres.nofivb1=100427)

UNION

SELECT
  bteamres.rank AS `rank`
FROM
  bteamres
    LEFT OUTER JOIN (btourn AS tourn) ON (bteamres.tourncode=tourn.tourncode)
WHERE
  (BTEAMRES.NOFIVB2=100427) 
```

我收到的错误代码是：

```
[Err] 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON     (bteamres.tourncode=tourn.tourncode)
WHERE
  (BTEAMRES.NOFIVB2=100427)' at line 15 
```

如果我删除连接，请求在 MySQL 4 和 MySQL 5 上都可以正常工作。我知道 MySQL 4 和 MySQL 5 之间存在一些语法差异，但我看不出如何使这个语句工作。

感谢您的帮助。帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:05:39.777

`LEFT JOIN`我认为问题在于ed 表周围的括号：

*   `LEFT JOIN (btourn AS tourn)`触发错误
*   `LEFT JOIN btourn AS tourn`被接受

您可以在这里尝试（我不得不将联合包装到一个选择中以避免 sqlfiddle 的错误）： [http ://sqlfiddle.com/#!2/d4885/11](http://sqlfiddle.com/#!2/d4885/11)

```
SELECT bteamres.rank AS `rank`
FROM      bteamres
LEFT JOIN btourn AS tourn ON bteamres.tourncode=tourn.tourncode
WHERE bteamres.nofivb1=100427

UNION 

SELECT bteamres.rank AS `rank`
FROM      bteamres
LEFT JOIN btourn AS tourn ON bteamres.tourncode=tourn.tourncode
WHERE bteamres.nofivb2=100427 
```

# sql - 如何计算年月日两个日期之间的日期差异？

> ID：11208715
> 
> 赞同：1
> 
> 时间：2012-06-26T13:45:27.813
> 
> 标签：sql, sql-server, tsql, sql-server-2005

> **可能重复：**
> [如何在 T-SQL 中用年、月和日计算年龄](https://stackoverflow.com/questions/57599/how-to-calculate-age-in-t-sql-with-years-months-and-days)

我有一个应用程序可以完全计算特定日期的年龄，即 years-months-days 。在 sql server 2005 中是否有任何简单的方法来计算它。实际上我已经为此创建了一个函数，但它非常复杂。我只想知道我不知道的sql server中是否有任何简单的方法或任何功能？

计算任何申请人在特定日期的确切年龄的要求非常简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:40:09.437

不确定它是否 100% 正确，但是是这样的：

```
declare @d1 datetime, @d2 datetime, @y int, @m int, @d int
set @d1 = '2009-09-23'
set @d2 = '2012-04-23'

set @y = datediff(year, @d1, @d2) - 1
set @m = datediff(month, dateadd(year, @y, @d1), @d2) 
if dateadd(month, @m, dateadd(year, @y, @d1)) > @d2 set @m = @m - 1

set @d = datediff(day, dateadd(month, @m, dateadd(year, @y, @d1)), @d2)
print cast(@y as nvarchar) + ' year(s) ' + cast(@m as nvarchar) + ' month(s) and ' + cast(@d as nvarchar) + ' day(s)' 
```

# plot - JFreeChart：百分比堆积条形图中的 RangeAxis 位于 [0,1] 而不是 [0,100]

> ID：11208719
> 
> 赞同：1
> 
> 时间：2012-06-26T13:45:31.620
> 
> 标签：plot, jfreechart, percentage, stackedbarseries

`setRenderAsPercentage(true)`在JFreeChart中，我使用`StackedBarRenderer`. 虽然绘图本身看起来不错（所有条形都跨越整个绘图），但范围轴标签并未显示百分比值（即 0 到 100），而是显示概率（即 0 到 1）。

我怎样才能获得百分比值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T15:03:44.060

你需要为这样的设置`NumberFormat`一个`rangeAxis`：

```
NumberAxis rangeAxis = new NumberAxis("Count");
...
rangeAxis.setNumberFormatOverride(NumberFormat.getPercentInstance());
...
XYPlot plot = new XYPlot(dataset, domainAxis, rangeAxis, renderer);
... 
```

或者，如果你已经有一个情节，你可以这样做

```
NumberAxis rangeAxis2 = (NumberAxis) plot.getRangeAxis();
rangeAxis2.setNumberFormatOverride(NumberFormat.getPercentInstance()); 
```

然后，您应该有一个如下所示的图表：

![在此处输入图像描述](../Images/fc568194d8589d3a2061d2bdb23e7d72.png)

# jsf - 如果列未显示（渲染），JSF 数据表隐藏列边框

> ID：11208721
> 
> 赞同：1
> 
> 时间：2012-06-26T13:45:38.487
> 
> 标签：jsf, datatable

我有一个 JSF 数据表

```
 <h:dataTable id="memberTable" value="#{bean.pList}" border="0" 
rowClasses="rowEven rowOdd" var="item">
<h:column rendered="#{item.isDisplay == Y}">
<h:outputText value="#{item.visitDate}" >
</h:outputText>
</h:column>
</datatable> 
```

我有更多这样的列，这些列是根据条件呈现的，当条件为假并且我有边框 = 1；我看到显示空白单元格。我怎样才能只显示我想要的列并拥有其他列。渲染=假不显示空白单元格？

谢谢，赛。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:50:51.320

您不能根据特定行的条件呈现整个列。这在技术上毫无意义。您需要根据父 bean 的属性评估条件。

```
<h:dataTable value="#{bean.pList}" var="item">
    <h:column rendered="#{bean.display == 'Y'}">
        <h:outputText value="#{item.visitDate}" />
    </h:column>
</datatable> 
```

将`public String getDisplay()`方法移到后面的类`#{bean}`。

请注意，我还修复了您的 EL 表达式中的其他一些错误。您不应该在属性名称前加上`is`or`get`并且应该引用字符串值。您还可以更好地使其成为布尔属性。

```
private boolean display;

public boolean isDisplay() {
    return display;
} 
```

和

```
rendered="#{bean.display}" 
```

# asp.net-mvc - MVC, CheckboxList extension html helper..进一步的问题

> ID：11208723
> 
> 赞同：0
> 
> 时间：2012-06-26T13:45:38.960
> 
> 标签：asp.net-mvc, razor, checkbox, asp.net-mvc-4

下午好

我希望这会很好，我自己一个简单的f**k，但我已经深入了，目前不会游泳。

好的，以前我问过[这个](https://stackoverflow.com/questions/11204464/mvc-4-checkbox-list-and-me)问题，因此我已经实现了以下内容：

**模型**

```
 public class CorporateDetails
{

    public Guid? Id { get; set; }

    [Key]
    public int CorporateDetailId { get; set; }

    public int? EmsId { get; set; }
    public string EmsName { get; set; }

    public virtual EmsType EmsType { get; set; }
}

public class EmsType
{
    [Key]
    public int? EmsId { get; set; }
    public string EmsName { get; set; }

    public virtual ICollection<EmsType> EmsTypes { get; set; }
} 
```

**控制器**

```
 public ActionResult Create()
    {
        ViewBag.EmsId = new MultiSelectList(db.EmsTypes, "EmsId", "EmsName");
        return View();
    } 
```

**看法**

```
<fieldset>
    <legend>CorporateDetails</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.EmsId, "EmsType")
    </div>
    <div class="editor-field">
        @Html.DropDownList("EmsId", String.Empty)
        @Html.ValidationMessageFor(model => model.EmsId)
    </div>
<div class="editor-label">

        @Html.CheckBoxListFor(model => model.EmsId, (MultiSelectList) ViewBag.EmsId)
    </div>
    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset>
}

    <div>
        @Html.ActionLink("Back to List", "Index")
    </div>
    @section Scripts {
        @Scripts.Render("~/bundles/jqueryval")
    } 
```

此 CheckBoxListFor 使用以下**扩展名**：

```
public static class HtmlHelper
{
    //Extension
    public static MvcHtmlString CheckBoxListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty[]>> expression, MultiSelectList multiSelectList, object htmlAttributes = null)
    {
        //Derive property name for checkbox name
        MemberExpression body = expression.Body as MemberExpression;
        string propertyName = body.Member.Name;

        //Get currently select values from the ViewData model
        TProperty[] list = expression.Compile().Invoke(htmlHelper.ViewData.Model);

        //Convert selected value list to a List<string> for easy manipulation
        List<string> selectedValues = new List<string>();

        if (list != null)
        {
            selectedValues = new List<TProperty>(list).ConvertAll<string>(delegate(TProperty i) { return i.ToString(); });
        }

        //Create div
        TagBuilder divTag = new TagBuilder("div");
        divTag.MergeAttributes(new RouteValueDictionary(htmlAttributes), true);

        //Add checkboxes
        foreach (SelectListItem item in multiSelectList)
        {
            divTag.InnerHtml += String.Format("<div><input type=\"checkbox\" name=\"{0}\" id=\"{0}_{1}\" " +
                                                "value=\"{1}\" {2} /><label for=\"{0}_{1}\">{3}</label></div>",
                                                propertyName,
                                                item.Value,
                                                selectedValues.Contains(item.Value) ? "checked=\"checked\"" : "",
                                                item.Text);
        }

        return MvcHtmlString.Create(divTag.ToString());
    }
} 
```

那么**有什么问题呢？**

好吧，当我运行它时，我收到一个令人讨厌的错误，告诉我：

> “CS0411：无法从用法中推断方法 'Extensions.HtmlHelper.CheckBoxListFor(System.Web.Mvc.HtmlHelper, System.Linq.Expressions.Expression>, System.Web.Mvc.MultiSelectList, object)' 的类型参数。尝试明确指定类型参数。”

有人可以指出我哪里出错了，因为我在转圈，不确定我错过了什么。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T17:45:05.303

里卡多，

我在 GitHub 上分享了一些我自己的 MVC 助手。请随意浏览并根据需要使用代码。项目中的一项是 CheckBoxListItemFor 助手，它是专门为创建复选框列表而创建的。在 InputExtensions.cs 下查看

[https://github.com/EdCharbeneau/EJC.UIExtensions/tree/master/EJC.UIExtensions/Html](https://github.com/EdCharbeneau/EJC.UIExtensions/tree/master/EJC.UIExtensions/Html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T10:05:50.803

这里的问题是我原来的 EmsId 是一个可为空的 int 而不是所需的 int 数组，因此是错误的。

请参阅我[在此处](https://stackoverflow.com/questions/11204464/mvc-4-checkbox-list-and-me)给出的答案，以获取有关如何实现此目的的完整说明。

# php - 解析错误：语法错误，意外的 T_SL PHP heredoc

> ID：11208725
> 
> 赞同：10
> 
> 时间：2012-06-26T13:45:47.510
> 
> 标签：php, heredoc

我不断收到以下错误：

> 解析错误：语法错误，第 70 行 /home/a4999406/public_html/willingLog.html 中的意外 T_SL

在以下代码上（第一行是第 70 行）：

```
 echo <<<END 
<form action = "willingLog.html" method="post"><pre>
    First       <input type="text" name="first" />
    Last        <input type="text" name="last" />
    Email       <input type="text" name="email" />
    Username    <input type="text" name="user_name" />
                <input type="submit" value="AD RECORD" />
</pre></form>
END; 
```

heredoc 似乎不起作用。我试过其他例子。

以下是按文档类型标题。有什么问题吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd"> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-26T13:56:26.693

查看复制粘贴，第一行的“END”一词之后似乎有一个空格字符：

```
'echo <<<END ' 
```

尝试摆脱空格字符。谷歌搜索找到的答案。来源（链接现已失效）：[http ://www.alexxoid.com/blog/dev/php-dev/php-parse-error-unexpected-t_sl.html](http://www.alexxoid.com/blog/dev/php-dev/php-parse-error-unexpected-t_sl.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:49:24.200

尝试：

```
echo <<<'END'
<form action = "willingLog.html" method="post"><pre>
    First       <input type="text" name="first" />
    Last        <input type="text" name="last" />
    Email       <input type="text" name="email" />
    Username    <input type="text" name="user_name" />
                <input type="submit" value="AD RECORD" />
</pre></form>
END; 
```

# c# - 避免数字数据类型的 .NET 扩展方法？

> ID：11208728
> 
> 赞同：9
> 
> 时间：2012-06-26T13:45:51.207
> 
> 标签：c#, extension-methods

假设我想向.NET 中的数字数据类型添加一个名为**IsOdd()的扩展方法。**然而，除了为扩展方法定义的参数外，对于**Int16**、**Int32**、**Int64等数据类型的实现几乎相同。**我真的不喜欢这种冗余，但想知道是否没有办法避免它。

有没有更好的方法来处理这个？例如，我是否应该为 System.Math 实现扩展方法并为**IsOdd()**创建重载定义？简而言之，我很好奇数字数据类型的扩展方法是否应该完全避免，因为它们固有的冗余。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-26T13:49:08.563

您不能为静态类创建扩展方法。您可以做的最接近的是：

```
public static bool IsOdd<T>(this T number) where T : struct 
```

这会将扩展方法限制为值类型。但是，您仍然会得到一些您无法处理的东西（`DateTime`例如）。在这种情况下，您必须抛出异常。

**编辑：**正如 Mangist 在评论中所说，您可以执行以下操作以进一步限制该方法：

```
 public static bool IsOdd<T>(this T number) 
     where T : struct, IComparable, IComparable<T>, 
               IConvertible, IEquatable<T>, IFormattable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:49:54.140

您始终可以`Generics`与扩展方法结合使用以避免重复，就像您提到的情况一样。例如

`IsOdd<Type>()`

# android - 清单文件中的 android:configChanges 不允许出现错误字符串类型

> ID：11208729
> 
> 赞同：31
> 
> 时间：2012-06-26T13:45:53.377
> 
> 标签：android

这是我的清单文件，其中显示了 android:configChanges 不允许的错误字符串类型，请帮助我纠正错误。下面是我的清单文件。

```
 <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.ifahja.banner"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".MyBannerActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name="com.google.ads.AdActivity"
                  android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"/>

    </application>

    <uses-permission android:name="android.permission.INTERNET"/>
  <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

</manifest> 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-06-26T13:51:49.757

```
android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize" 
```

`screenSize`&`smallestScreenSize`属性在 SDK 10 中不可用。它们是在 API 级别 13 中引入的。

[http://developer.android.com/guide/topics/manifest/activity-element.html#config](http://developer.android.com/guide/topics/manifest/activity-element.html#config)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-08-06T13:58:34.340

*   确保您拥有最新的 Android SDK 副本并且您正在针对至少 Android v3.2 进行编译（将 project.properties 中的目标设置为 android-13）。
*   适用于 Android 的 Google 移动广告 SDK 需要 Android 2.3 或更高版本的运行时（在您的 AndroidManifest.xml 中将 android:minSdkVersion 设置为至少 9）。这意味着您可以使用最新版本的 Android SDK 进行开发，并且您的应用仍将在较早的 Android 版本（最低 2.3）上运行。

# perl - 如何获取打开文件的文件名？

> ID：11208733
> 
> 赞同：2
> 
> 时间：2012-06-26T13:46:08.873
> 
> 标签：perl

我正在处理这个简单的脚本。我必须承认，我对 PERL 完全陌生，并且有点被这个愚蠢的问题所困扰。

```
open(IN, "<def/t.html") or die();
while(<IN>) {
    chomp;
    if($_ =~ m/FF0000/) {
        print "\n".$_."\n";
    }
} 
```

所以...我打开了 t.html 并在文件中找到了给定的字符串。输出没问题，但我还需要打印找到字符串的文件的文件名。我真的不知道如何退货，我需要在`$_`. 我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:49:57.317

只需在打开之前将文件名保存在变量中，然后从那里开始：

```
my $filename = 'def/t.html';
open( IN, '<', $filename ) or die $!;
...
print "\n$filename: " . $_ . "\n"; 
```

请注意，上面使用 3-arg 形式`open()`，这样更安全。

（另外，语言是“Perl”，而不是“PERL”。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T14:00:01.013

这是一个奇怪的想法，但如果你愿意，你可以：

```
$ cat 1.pl

#somewhere in the code
open(F, "f.txt");
my $f = fileno(F);

#here you want to find the filename
open(FILENAME, "ls -l /proc/$$/fd/$f|");
my @fn = split(/\s+/, <FILENAME>);
print $fn[$#fn],"\n";

$ perl 1.pl 
/home/ic/f.txt 
```

在这里，您只知道文件描述符并使用它查找文件名。

您还可以使用以下方法将其写得更短`readlink`：

```
open(F, "f.txt");
my $f = fileno(F);

#here you want to find the filename
print readlink("/proc/$$/fd/$f"), "\n"; 
```

我必须注意，该文件可能已经被删除（但如果它是打开的，它仍然存在）。

# php - 没有邮件类 require_once php

> ID：11208739
> 
> 赞同：1
> 
> 时间：2012-06-26T13:46:24.247
> 
> 标签：php, include-path, require-once

我正在尝试使用 require_once 来调用 Mail.php 但是当我为该类创建一个新实例并开始使用它时，我收到一条消息说

```
Fatal error: Class 'Mail' not found in D:\xampp\htdocs\proj\Mailing\mymail.php on line xx 
```

恢复的代码是这样的

```
<?php
     require_once 'Autoload.php';

     $smtp = Mail::factory('smtp',
          array ('host' => $host,
          'port' => $port,
          'auth' => true,
          'username' => $username,
          'password' => $password));
?> 
```

或者也

```
<?php
     require_once 'Mail.php';

     $mail = new Mail();
?> 
```

为什么我会收到这条消息？我已经将包含路径设置为“.;D:\xampp\php\pear”

我编辑了我的脚本并需要自动加载脚本，它工作得很好，因为它不会打印任何错误，但我仍然收到相同的消息，如邮件不起作用（我编辑了上面的脚本），自动加载在我的同一个目录中主脚本是。

我创建了一个新文件并用完整路径调用它，然后输出是

```
Warning: require_once(D:\xampp\php\PEAR) [function.require-once]: failed to open stream: Permission denied in D:\xampp\htdocs\proj\Mailing\pMail.php on line 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:49:54.757

**当你加载一个类时，如果你使用自动加载**，你不需要你的 php 文件。

例子：

```
Class Autoload {
   private $rootDirectory;
   private $paths = array(
       "system/core",
       "system/obj",
       "system/data"
   );

   public function __construct() {
       $this->RootDirectory = dirname(getcwd()); // Whatever is your root
       $this->activateAutoload("autoloadClassesFromSystemFolder");
   }

   private function autoloadClassesFromSystemFolder($i) {
       foreach ($this->paths as $path) {
           // Please keep in mind that a class name has to be unique. 
           if (is_file($this->RootDirectory .'/'. $path .'/'. $i . ".php")) {
               include $this->RootDirectory .'/'. $path .'/'. $i . ".php";
               break;
           }
       }
   }

   public function activateAutoload($functionName) {
       spl_autoload_register(array($this, $functionName));
   }
} 
```

在 php 中加载它需要做的唯一事情是：

```
require "path/to/autoload.php";
$autoload = new Autoload(); 
```

之后，您可以根据需要使用任意数量的类，而不必担心类文件包含。

```
$mail = new Mail(); 
```

更多信息： http: [//nl.php.net/autoload](http://nl.php.net/autoload)

# .net - Google 日历与 Sql Server DB 的集成

> ID：11208742
> 
> 赞同：1
> 
> 时间：2012-06-26T13:46:29.717
> 
> 标签：.net, sql-server, forms, database-design, google-calendar-api

*您可能会注意到这个问题的标题与两年前提出的问题相似。 [带有 Sql Server DB 的 Google 日历](https://stackoverflow.com/questions/2000242/google-calendar-with-sql-server-db?rq=1) 但是，尽管该问题的答案说关于 SO 有很多类似的问题，但到目前为止我还没有找到它们，而且我不确定这些答案是否仍然与 Google Calendar API 相关此后已被替换。*

我最初计划通过集成 Google 文档（电子表格）和 Google 日历来**开发在线约会系统。**我知道*可以*集成这两个系统，尽管需要进行大量调整。Google Docs 表单和 Google Calendar 都将代表用户界面的一部分（通过网站上的 iframe）。用户可以通过表格进行预订，并通过查看日历查看哪些约会可用。

但是，规范已更改，因此我现在必须使用关系数据库管理系统。因此，Google Docs 似乎不再是一个不错的选择（或根本没有任何选择）。因此，这个问题特别涉及将 SQL Server 与 Google 日历集成的概念。使用 Google Calendar 的原因是它会为用户提供如此稳定、美观的界面，并提供轻松协作和数据共享的机会。

所以设计看起来像这样：一个表单（最好通过 Microsoft Access 设计），将数据发送到单个表（可能使用结合日期和时间参数形成的键 - 不能同时进行两个约会） . 日历（希望是 Google 日历）将从表单的日期、时间、姓名和联系方式字段中获取信息，并相应地更新。然后，用户将能够查看可用的时间，并且网站所有者将能够与员工共享此约会日历。

用于此的表也可以连接到其他表，但没有其他表与日历有任何直接关系。

那么人们是怎么想的呢？有可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T09:25:15.387

我不确定这是否正确，但经过大量网络拖网后，此链接已成为迄今为止的最佳候选者。把它放在这里是为了自我参考。

[http://visualstudiogallery.msdn.microsoft.com/6f3124d4-2f19-4d8e-bddb-272431a3b33d](http://visualstudiogallery.msdn.microsoft.com/6f3124d4-2f19-4d8e-bddb-272431a3b33d)

# php - 修改 CHtml::activecheckBoxList 以打印列中的复选框

> ID：11208743
> 
> 赞同：0
> 
> 时间：2012-06-26T13:46:35.013
> 
> 标签：php, html, yii

我在一列中打印了复选框列表，但我需要它在列中打印，并且每列中应该是例如 10 个复选框。我的PHP代码：

```
//$user_cats- array of categories. 
    echo CHtml::activecheckBoxList($categories,
           'selected['.$parent->id.']',
        CHtml::listData(
                $user_cats,
                'id',
                'title',
                ''
        )); 
```

也许有办法修改 CHtml::listData 它可以在列中打印复选框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T16:10:32.277

我会做这样的事情：

```
CHtml::activecheckBoxList($categories,
       'selected['.$parent->id.']',
    CHtml::listData(
            $user_cats,
            'id',
            'title',                
    ), array('separator'=>'',
             'template'=>'<span class="checkbox-columns">{input} {label}</span>'),
    ); 
```

然后在我的 CSS 中类似：

```
span.checkbox-columns {
    float:left;
    width: 20%;
} 
```

根据需要调整 CSS，主要是宽度百分比。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T15:10:45.157

首先`CHtml::listData`生成一个适合在等中使用的数据`activeCheckboxList`集`dropdownlist`。

现在，如果您想更改复选框在页面上的显示方式，您需要将 htmlOptions 数组传递给`activeCheckBoxList`. [你可以在Yii activeCheckBoxList](http://www.yiiframework.com/doc/api/1.1/CHtml#activeCheckBoxList-detail)上阅读更多关于它的信息

例如：

```
CHtml::activecheckBoxList($categories,
       'selected['.$parent->id.']',
    CHtml::listData(
            $user_cats,
            'id',
            'title',                
    ), array('separator'=>'--')
    ); 
```

因此，默认情况下，如果您不指定分隔符，它将使用换行符，但如果您提供它，它将使用该分隔符。此外，如果您想添加更多样式或更好地格式化复选框，您也可以这样做。只需阅读文档，链接就在上面。这一切都可以通过为`htmlOptions`数组指定附加选项来实现。

# jquery - 主干 this.el jQuery

> ID：11208755
> 
> 赞同：3
> 
> 时间：2012-06-26T13:47:07.930
> 
> 标签：jquery, backbone.js

我正在尝试设置 Backbone 应用程序。下面的代码给出了以下错误：

> 未捕获的类型错误：对象 # 没有“附加”方法

```
define(
    [
        'jQuery',
        'Underscore',
        'Backbone',
        'text!templates/start.html'
    ],

    function ($, _, Backbone, startTemplate)
    {
        var StartView = Backbone.View.extend({

            // properties
            el: $('#container'),

            initialize: function ()
            {
                this.render();
            },

            render: function ()
            {
                var template = _.template( startTemplate );
                this.el.append( template );
            }
        });

        return new StartView;
    }

); 
```

但这有效（参见“渲染”功能）：

```
define(
    [
        'jQuery',
        'Underscore',
        'Backbone',
        'text!templates/start.html'
    ],

    function ($, _, Backbone, startTemplate)
    {
        var StartView = Backbone.View.extend({

            // properties
            el: $('#container'),

            initialize: function ()
            {
                this.render();
            },

            render: function ()
            {
                var template = _.template( startTemplate );
                $(this.el).append( template );
            }
        });

        return new StartView;
    }

); 
```

我将 $('#container') 作为 'el' 属性传递，所以我认为这应该可以正常工作。为什么我必须为此再次使用 jQuery 表示法。$(this.el) 而不是 this.el

非常感谢提前！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-26T13:51:21.670

在 Backbone 中，您只需将 ID 或类名提供给`el`：

```
el: '#container' 
```

然后，`this.el`引用 DOM 元素，并且（如果您使用最新的 Backbone），`this.$el`引用 jQuery 对象。

如果您的 Backbone 是最新的，则不需要 $(this.el)

# .net - DRY 用于 .NET 代码和 web.config 中的常量

> ID：11208760
> 
> 赞同：1
> 
> 时间：2012-06-26T13:47:24.957
> 
> 标签：.net, web-config, log4net, dry, event-log

`installutil`我有一个 Web 应用程序，它需要为事件日志注册事件源的自定义安装程序（使用 运行）。此安装程序代码包含一个常量（特别是事件源的名称），该常量也在`web.config`文件中重复。

有没有办法可以在一个地方定义这个常量（根据“DRY”原则）？

*有关更多背景信息：这是针对 log4net 事件日志附加程序的，它需要安装程序来防止根据[此 log4net 常见问题解答](http://logging.apache.org/log4net/release/faq.html#trouble-EventLog)出现权限问题。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:04:05.827

根本不是一般问题的解决方案，但我通过编写自定义 log4net appender 解决了这个特殊情况，以便它可以在代码中而不是通过配置文件进行初始化：

```
public sealed class EzeReportingEventLogAppender : EventLogAppender
{
    public EzeReportingEventLogAppender()
    {
        Layout = new PatternLayout(Configuration.EventLogPatternLayout);
        LogName = Configuration.EventLogName;
        ApplicationName = Configuration.EventLogApplicationName;
    }
} 
```

在 web.config 中（不再包括`applicationName`）：

```
<appender name="FatalAppender" type="EzeReporting.EzeReportingEventLogAppender">
  <filter type="log4net.Filter.LevelRangeFilter">
    <param name="LevelMin" value="FATAL" />
  </filter>
</appender> 
```

# javascript - 带有 Javascript 的 Twitter 小部件

> ID：11208763
> 
> 赞同：0
> 
> 时间：2012-06-26T13:47:34.653
> 
> 标签：javascript, jquery, twitter, widget

对于简单的 twitter 小部件，我查看了高低，它显示了指定帐户有多少关注者，并且是前 5 条推文，但我找不到/让它们中的任何一个工作。你们有什么想法吗？我试过这个[http://www.themelab.com/2010/05/18/custom-twitter-widget-tutorial/](http://www.themelab.com/2010/05/18/custom-twitter-widget-tutorial/) 但我无法让它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:28:33.627

您好，您可以使用它`https://api.twitter.com/1/statuses/user_timeline.json`来获取用户时间线并`http://api.twitter.com/1/users/show.json`获取有关特定用户名的信息。这是我开发的一个示例 twitter 小部件，希望对您有所帮助。

```
<html>
<body>
<script language="javascript" type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.js"></script>

<style type="text/css">
body{background:#ccc;}
.status{
color:#000;
}    
h3,h4{
font-size: 14px;
font-family: "Segoe UI", Tahoma, Verdana, Arial;
text-decoration:none;
}
#txt
{
font-size: 11px;
font-family: "Segoe UI", Tahoma, Verdana, Arial;
}
.status
{
min-height:60px;
padding:6px;
border-bottom:solid 1px #DEDEDE
font-size: 11px;
background:transparent;
border:#eaeaea 2px;
}
.status a
{
color:#3cf;
text-decoration:none
font-size: 11px;
}
.status a:hover{
color:#3cf;
text-decoration:underline
}
.twitter_image{
float:left;
margin-right:14px;
width:50px;
height:50px;
padding:3px;
}
.twitter_posted_at{
font-size:11px;
color:#999
}
#tweets{
margin:auto auto;
overflow:scroll;
background:#eaeaea;
height:300px;
width:300px;
}
</style>
<div id="tweets">
<div id = "heading"></div>
</div>
<script type="text/javascript">
var username = "Google";
var recentTweetsUrl = "https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name="+username+"&count=15&callback=?"
var followerCountUrl ="http://api.twitter.com/1/users/show.json?screen_name="+username+"&callback=?";
$(document).ready(function()
{
$.ajax
({type: "GET",url: followerCountUrl,dataType:"jsonp",success: function(response)
{
fCount = response.followers_count;
var headerData = "<h3>"+username+"</h3><h4>"+fCount+"Followers on Twitter</h4>";
$(headerData).appendTo('#heading');
}
});
$.ajax
({type: "GET",url: recentTweetsUrl,dataType:"jsonp",success: function(response)
{
var tdata='';
for(i=0;i<response.length;i++)
{
data =response[i];
var id=data.id;
var text=data.text;
var created_time=data.created_at;
var screen_name=data.user.screen_name;
var image=data.user.profile_image_url;
var source=data.source;
tdata+="<div class='status' id='"+id+"'><img src="+image+" class='twitter_image'/><a href='http://twitter.com/"+screen_name+"'>"+screen_name+"</a><div id='txt'>"+text+"<div class='twitter_posted_at'><span class='timeago' title='"+created_time+"'></span><i>via "+source+" </i></div></div></div>";
}

$(tdata).appendTo('#tweets');
}
});
});

</script>

</body>
</html> 
```

# php - 合并两个具有特定 id 的数组，然后按字母顺序排列这个新数组

> ID：11208766
> 
> 赞同：0
> 
> 时间：2012-06-26T13:47:43.763
> 
> 标签：php, arrays, merge

我必须排列，我想将这两个数组与一个主键 (ID) 合并，我想按字母顺序排列这个 NEW 数组（姓氏字段）

```
Array ( 
[0] =>
 Array ( [id] => 172 
         [user_id] => 1217330 
         [behaviour_action_id] => 97 
         [state] => accepted 
     ) 
[1] =>
 Array ( 
    [id] => 173
    [user_id] => 1217330 
    [behaviour_action_id] => 97 
    [state] => pending 
     ) ) 
```

而这个数组

```
Array ( 
[1217330 ] => 
Array ( [firstname] => Philip 
        [lastname] => Audet
        [birthdate] => 1995-07-17 
        [id] => 1217330 
        ) 
[232323] => 
Array ( [firstname] => Frédéric 
        [lastname] => Bouchard-Dubé
        [birthdate] => 1995-07-17 
        [id] => 232323
        ) 
```

我想拥有这个

```
[0] =>
 Array ( [id] => 172 
         [user_id] => 1217330 
         [behaviour_action_id] => 97 
         [state] => accepted
         [firstname] => Philip 
         [lastname] => Audet 
     ) 
[1] =>
 Array ( 
    [id] => 173
    [user_id] => 1217330 
    [behaviour_action_id] => 97 
    [state] => pending 
    [firstname] => Philip 
    [lastname] => Audet 
     ) ) 
```

我不想有这个数组的生日索引，我只想从第二个数组中获取名字和姓氏。所以我想用 ID（第二个表）计算索引 USER_ID（first_table）。我还想用姓氏按字母顺序排列这个新表（在我的例子中，我不需要按字母顺序排序，但我需要这样做）

有人可以帮助我吗？谢谢谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:11:21.730

这正在做你正在寻找的东西。由于您的示例与上下文无关，您可能需要采取一些不同的方法，但我希望它可以帮助您完成任务。

```
$behaviour = array(
    array(
        'id' => 172,
        'user_id' => 1217330,
        'behaviour_action_id' => 97,
        'state' => 'accepted'
    ),
    array(
        'id' => 173,
        'user_id' => 232323,
        'behaviour_action_id' => 97,
        'state' => 'pending'
    ),  
);

$users = array(
    1217330 => array(
        'firstname' => 'Philip',
        'lastname' => 'Audet',
        'birthdate' => '1995-07-17',
        'id' => 1217330
    ),
    232323 => array(
        'firstname' => 'Frédéric',
        'lastname' => 'Bouchard-Dubé',
        'birthdate' => '1995-07-17',
        'id' => 232323
    ),  
);

//we will collect the data in a new array
$combined = array();

//now we loop through all behaviours
foreach($behaviour as $key => $behaviourData){

    //we look up the data which belongs to the user of this behaviour
    $wantedUserData = $users[$behaviourData['user_id']];

    //birthdate is unwanted
    unset($wantedUserData['birthdate']);

    //merge data
    $combined[] = array_merge($behaviourData, $wantedUserData);
}

//order array
usort($combined,'cmp');

//voilà!
var_dump($combined);

//Comparison function used in usort above
function cmp($a, $b){
    if ($a['lastname'] == $b['lastname']){
        return 0;
    }
    return ($a['lastname'] < $b['lastname']) ? -1 : 1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:20:22.483

```
$arr1 = array (
    array("id"=>172, "user_id"=>1217330, "behaviour_action_id"=>97, "state"=>"accepted"),
    array("id"=>173, "user_id"=>1217330, "behaviour_action_id"=>97, "state"=>"pending")
);
$arr2 = array(
        "1217330" => array(
            "firstname" => "Philip",
            "lastname"  => "Audet",
            "birthdate" => "1995-07-17",
            "id"        => 1217330
        ),
        "232323" => array (
            "firstname" => "Frédéric",
            "lastname" => "Bouchard-Dubé",
            "birthdate" => "1995-07-17",
            "id" => 232323
        )
);
foreach($arr1 as $arr) {
    $extra = $arr2[$arr["user_id"]];
    unset($extra["birthdate"]);
    $newarray[] = array_merge($extra, $arr);
}

print_r($newarray); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:09:46.453

好吧，我不想给出一个熟化的代码，但这个算法可以完成这项工作：

1) 遍历第一个数组并创建另一个以 user_id 为键的数组。像

```
$new_array[$array['user_id']] = array($array['id'], $array['state']...); 
```

2）循环遍历第二个数组和`unset()`key `birthdate`。

3）使用`array_merge_recursive()`并合并两个数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:21:52.207

这个？（假设**$arr1**和**$arr2**给定数组）

```
$arr3 = array();
foreach($arr1 as $key=>$val) {
   $arr3[$key] = $val;
   $arr3[$key]["firstname"] = $arr2[$val["user_id"]]["firstname"];
   $arr3[$key]["lastname"] = $arr2[$val["user_id"]]["lastname"];
}

echo "<pre>";
print_r($arr3);
echo "</pre>"; 
```

# php - PHP脚本将图像存储到文件夹和MySQL数据库的路径

> ID：11208767
> 
> 赞同：-2
> 
> 时间：2012-06-26T13:47:43.960
> 
> 标签：php, mysql, storing-data

我有一个 html 表单，它运行一个 php 脚本，它将文本字段插入 MySQL 数据库。我使用这个数据库来创建用户配置文件，但在配置文件中我还需要声音、视频和图片。是否有任何脚本可以在硬盘上创建一个文件夹，其名称是我从表单中插入的名称，并将所选文件存储在此文件夹中并将文件路径插入 MySQL 数据库？

我还需要将它们显示到搜索结果页面中，如果我选择一个用户，我需要从结果页面显示它们，我需要将我重定向到一个页面，该页面显示所选记录，其中包含自己的照片、声音、视频和文本作为个人资料页面或其他内容像这样。

这是表格：

```
<form action="process.php" method="post" >
    <label>Όνομα:</label> <input type="text" name="Fname" /><br/><br/>
    <label>Επώνυμο:</label> <input type="text" name="Sname" /><br/><br/>
    <label>Είδος:</label> <input type="text" name="Genre" /><br/><br/>
    <label>Είδικότητα:</label> <input type="text" name="Specialty" /><br/><br/>
    <label>Βιογραφικό:</label> <input type="text" name="Bio" /><br/><br/>
    <input type="submit" value="Καταχώρηση"/>
</form> 
```

这是脚本：

```
<?php
$con = mysql_connect("localhost","root","root");
if (!$con)
{
  die('Could not connect: ' . mysql_error());
}

mysql_select_db("fasma", $con);

$sql="INSERT INTO artists2 (Fname, Sname, Genre, Specialty, Bio)
VALUES
('$_POST[Fname]','$_POST[Sname]','$_POST[Genre]','$_POST[Specialty]','$_POST[Bio]')";

if (!mysql_query($sql,$con))
{
  die('Error: ' . mysql_error());
}
echo "Registration Successful";

mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:02:26.010

在查找 PHP 函数时，您应该始终查看 PHP 手册： http: [//php.net/manual/en/index.php](http://php.net/manual/en/index.php)

它有关于 PHP 函数的大量文档，包括如何在您的服务器上创建文件夹/目录。

至于上传和存储文件，它比您想象的要容易：首先，在您的表单中，您需要“文件”类型的输入字段。例如：

```
<label>Photo:</label> <input type="file" name="uploadImage" id="file" /><br/><br/> 
```

将表单提交到 process.php 后，这会将文件上传到服务器上的临时位置。在 process.php 中，可以像这样访问文件和临时位置：

```
$_FILES["file"]["tmp_name"]; 
```

然后，您可以将该文件复制到服务器上您喜欢的任何位置。并且由于您是决定将文件复制到何处的人，因此您可以根据需要将文件路径插入到数据库中。

欲了解更多信息，请查看：[http ://www.w3schools.com/php/php_file_upload.asp](http://www.w3schools.com/php/php_file_upload.asp)

# asp.net - 如何不保留不需要在 ViewState 中保留的 ViewState 内容？

> ID：11208768
> 
> 赞同：3
> 
> 时间：2012-06-26T13:47:43.950
> 
> 标签：asp.net, viewstate, page-init

从微软的页面[了解 ASP.NET 视图状态](http://msdn.microsoft.com/en-us/library/ms972976.aspx)：

> 在页面生命周期的实例化阶段，创建控件层次结构并分配声明性语法中指定的那些属性。由于在构造控件层次结构时，这些声明性属性会在每次回发时自动重新分配，因此无需将这些属性值存储在视图状态中。

这意味着如果您的`aspx`文件包含以下标记：

```
<asp:Label ID="Label1" runat="server" Font-Name="Verdana" Text="Hello, World!"></asp:Label> 
```

***不必***在**ViewState**中保留的两件事是：

*   **字体名称**：`Verdana`
*   **文字**：`Hello, World!`

这两个属性不必保留在**ViewState**中，因为它们*每次*都被设置。

另一个不必保留在**ViewState**`aspx`中的示例是标记文件中声明的项目：

```
<asp:DropDownList ID="DropDownList1" runat="server">
   <asp:ListItem>One</asp:ListItem>
   <asp:ListItem>Two</asp:ListItem>
   <asp:ListItem>Three</asp:ListItem>
</asp:DropDownList> 
```

项目`DropDownList`：

*   `One`
*   `Two`
*   `Three`

不必保留在**ViewState**中，因为它们每次都被声明。

这就是我想做的。我希望不必保留在**ViewState**中的东西不要保留在**ViewState**中。相反，必须保留在**ViewState中的东西***我*希望它们保留在**ViewState**中。

 ****再次来自 MSDN：

> 在实例化阶段构建控件层次结构时，Label 的**Text**属性将设置为“Hello, World!” 并且它的**Font**属性将其 Name 属性设置为 Verdana。由于这些属性将在实例化阶段的每次页面访问中设置，因此无需将这些信息保存在视图状态中。

## 一个例子

除了在标记中声明属性之外，想象它们是以*编程*方式声明的：

```
Label1.Font.Name = "Verdana";
Label1.Text = "Hello, World!"; 
```

或者

```
DropDownList1.Items.Add("One");
DropDownList1.Items.Add("Two");
DropDownList1.Items.Add("Three"); 
```

现在，为了向 ASP.net 的魔力发出信号，即属性***始终***存在，并且不需要在**ViewState**中持久化，我将在页面**初始化**期间进行此更改：

```
protected void Page_Init(object sender, EventArgs e)
{
   //Set properties *before* PageLoad; before the viewstate is read
   //That way the properties will not have to be added to the viewstate
   Label1.Font.Name = "Verdana";
   Label1.Text = "Hello, World!";

   DropDownList1.Items.Add("One");
   DropDownList1.Items.Add("Two");
   DropDownList1.Items.Add("Three");
} 
```

除了那行不通。即使我在页面周期中足够早地设置控件的属性，并且即使我*每次都*设置属性，ASP.NET 仍然认为它们需要保留在**ViewState**中。

显然我需要我的代码及时运行。从 ASP.NET 认为它仍在读取标记的时候。

我怎么能**不**坚持不需要在**ViewState中坚持的****ViewState**东西？

 **## 后记

*   **为什么要这样做？只需将其放在标记中**

    不能; 不是当下拉项来自数据库时

*   **将控件的`ViewState`属性设置为`false`**

    不能; 不是在关闭***需要***在**ViewState中持久保存的东西时**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:55:42.167

你基本上已经回答了你自己的问题。

> 对于库存 asp.net 控件，您不能基于每个属性决定哪些内容留在 ViewState 中，哪些内容不留在 ViewState 中。

如果您滚动自己的自定义控件，则可以通过自定义属性列表等更精细地控制存储哪些属性，哪些不存储，但是您必须重新创建轮子。

您可能能够从内置控件继承（我怀疑任何被密封）并覆盖视图状态和/或控件状态处理程序。老实说，这听起来像是一项艰巨的任务。

我明白你为什么要问 - 为什么不比当前模型更有效。问题是 ASP.NET 从来都不是关于效率的，当然也不是轻量级的。它更多的是以牺牲性能和简单性为代价的快速快速开发 - 只需以 ajax`UpdatePanel`设计模式为例。为了便于开发，这是一个完全臃肿的 ajax 实现。******

# php - 静态类别菜单的活动状态

> ID：11208770
> 
> 赞同：0
> 
> 时间：2012-06-26T13:47:47.267
> 
> 标签：php, magento

我正在一家拥有少量类别的商店工作，为了使用 bg 图像和描述来定制下拉菜单 li，我想手动标记 top.phtml。

在搜索了高低之后，我在这里发布以了解是否有人可以指出我将活动类添加到当前类别/父类别的正确方向？

非常感谢，

彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T16:49:44.217

这里有几个选项。

#1，您可以让菜单自己呈现，然后进行字符串查找和替换以更好地标记它。

#2，您可以将请求的 url 与类别 url 片段进行比较，以确定哪些是活动的。

我使用了两者的组合来创建带有 CMS 页面的菜单和具有不同 CSS 类的某些类别等。

# c++ - 复制构造函数和赋值运算符实现选择 -

> ID：11208772
> 
> 赞同：6
> 
> 时间：2012-06-26T13:47:48.637
> 
> 标签：c++, inheritance, constructor, assignment-operator, deep-copy

我最近重新访问了此处看到的复制构造函数、赋值运算符、复制交换惯用语： [什么是复制和交换惯用语？](https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom) 和许多其他地方——

上面的链接是一个很好的帖子 - 但我还有一些问题 - 这些问题在很多地方得到了回答，在 stackoverflow 和许多其他网站上，但我没有看到很多一致性 -

1-您是否应该在复制构造函数中为深复制分配新内存`try`的`catch`区域周围？（我已经看到了两种方式）

2 - 关于复制构造函数和赋值运算符的继承，什么时候应该调用基类函数，什么时候这些函数应该是虚拟的？

3 - `std::copy`在复制构造函数中复制内存的最佳方法是什么？我已经看到它`memcpy`，并且看到其他人说`memcpy`地球上最糟糕的事情。

* * *

考虑下面的示例（感谢所有反馈），它提示了一些其他问题：

4 - 我们应该检查自我分配吗？如果是在哪里

5 - 题外话，但我已经看到交换用作： `std::copy(Other.Data,Other.Data + size,Data);` 应该是： `std::copy(Other.Data,Other.Data + (size-1),Data);` 如果交换从“第一个到最后一个”并且第 0 个元素是 Other.Data？

6 - 为什么注释掉的构造函数不起作用（我不得不将大小更改为 mysize） - 假设这意味着无论我编写它们的顺序如何，构造函数总是首先调用分配元素？

7 - 对我的实施还有其他意见吗？我知道代码没用，但我只是想说明一点。

```
class TBar
{

    public:

    //Swap Function        
    void swap(TBar &One, TBar &Two)
    {
            std::swap(One.b,Two.b);
            std::swap(One.a,Two.a);
    }

    int a;
    int *b;

    TBar& operator=(TBar Other)
    {
            swap(Other,*this);
            return (*this);
    }

    TBar() : a(0), b(new int) {}                //We Always Allocate the int 

    TBar(TBar const &Other) : a(Other.a), b(new int) 
    {
            std::copy(Other.b,Other.b,b);
            *b = 22;                                                //Just to have something
    }

    virtual ~TBar() { delete b;}
};

class TSuperFoo : public TBar
{
    public:

    int* Data;
    int size;

    //Swap Function for copy swap 
    void swap (TSuperFoo &One, TSuperFoo &Two)
    {
            std::swap(static_cast<TBar&>(One),static_cast<TBar&>(Two));
            std::swap(One.Data,Two.Data);
            std::swap(One.size,Two.size);
    }

    //Default Constructor
    TSuperFoo(int mysize = 5) : TBar(), size(mysize), Data(new int[mysize]) {}
    //TSuperFoo(int mysize = 5) : TBar(), size(mysize), Data(new int[size]) {}                *1

    //Copy Constructor
    TSuperFoo(TSuperFoo const &Other) : TBar(Other), size(Other.size), Data(new int[Other.size])        // I need [Other.size]! not sizw
    {
            std::copy(Other.Data,Other.Data + size,Data);        // Should this be (size-1) if std::copy is First -> Last? *2
    }

    //Assignment Operator
    TSuperFoo& operator=(TSuperFoo Other)
    {
            swap(Other,(*this));
            return (*this);
    }

    ~TSuperFoo() { delete[] Data;}

}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T14:04:43.137

1.  如果您分配内存，那么您需要确保在引发异常的情况下释放它。您可以使用显式`try`/来执行此操作`catch`，或者您可以使用智能指针`std::unique_ptr`来保存内存，然后当智能指针被堆栈展开销毁时，它将自动删除。

2.  您很少需要`virtual`赋值运算符。在成员初始化列表中调用基类复制构造函数，如果您正在执行成员赋值，则首先在派生赋值运算符中调用基类赋值运算符 --- 如果您正在执行复制/交换，那么您不需要调用如果正确实现了复制和交换，则派生赋值运算符中的基类赋值。

3.  `std::copy`适用于对象，并将正确调用复制构造函数。如果您有普通的 POD 对象，那么`memcpy`也可以正常工作。不过，在大多数情况下，我会选择`std::copy`--- 它应该`memcpy`针对 POD 进行优化，并且如果您稍后添加复制构造函数，它可以避免出现错误的可能性。

[更新问题的更新]

1.  **使用copy** /swap 编写时，无需检查自赋值，实际上也没有办法这样做 --- 当您输入赋值运算符`other`时，您将无法知道源对象是什么曾是。这只是意味着自我分配仍然会进行复制/交换。

***   `std::copy`将一对迭代器 (first, first+size) 作为输入。这允许空范围，并且与标准库中每个基于范围的算法相同。

    *   注释掉的构造函数不起作用，因为成员按照声明它们的顺序进行初始化，而不管成员初始化器列表中的顺序如何。因此，`Data`总是首先初始化。如果初始化依赖，`size`那么它将获得一个 duff 值，因为`size`尚未初始化。如果您交换 的声明，`size`则`data`此构造函数将正常工作。好的编译器会警告成员初始化的顺序与声明的顺序不匹配。** 

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T14:09:32.407

> 1 - 您是否应该在复制构造函数中为深拷贝分配新内存的区域周围尝试捕获？

一般来说，只有在可以处理的情况下才应该捕获异常。如果你有办法在本地处理内存不足的情况，那就抓住它；否则，放手吧。

如果构造失败，你当然不应该从构造函数中正常返回——这会使调用者得到一个无效的对象，并且无法知道它是无效的。

> 2 - 关于复制构造函数和赋值运算符的继承，什么时候应该调用基类函数，什么时候这些函数应该是虚拟的？

构造函数不能是虚函数，因为虚函数只​​能由对象调度，并且在创建它之前没有对象。通常，您也不会将赋值运算符设为虚拟；可复制和可分配类通常被视为非多态“值”类型。

通常，您会从初始化列表中调用基类复制构造函数：

```
Derived(Derived const & other) : Base(other), <derived members> {} 
```

如果您使用的是复制和交换习语，那么您的赋值运算符就不需要担心基类；这将由交换处理：

```
void swap(Derived & a, Derived & b) {
    using namespace std;
    swap(static_cast<Base&>(a), static_cast<Base&>(b));
    // and swap the derived class members too
}
Derived & Derived::operator=(Derived other) {
    swap(*this, other);
    return *this;
} 
```

> 3 -`std::copy`在复制构造函数中复制内存的最佳方法是什么？我已经看到它`memcopy`，并且看到其他人说`memcopy`地球上最糟糕的事情。

处理原始内存是相当不寻常的。通常您的类包含对象，并且通常不能通过简单地复制它们的内存来正确复制对象。您使用对象的复制构造函数或赋值运算符来复制对象，`std::copy`并将使用赋值运算符来复制对象数组（或更一般地，对象序列）。

如果你真的想要，你可以`memcpy`用来复制*POD*（plain old data）对象和数组；但`std::copy`更不容易出错（因为您不需要提供对象大小），更不易碎（因为如果您将对象更改为非 POD，它不会损坏）并且可能更快（因为对象大小和对齐方式在编译时已知）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:05:40.200

1.  `try-catch`当您必须撤消某些操作时可以使用。否则，只需让`bad_alloc`传播到调用者。

2.  调用基类的复制构造函数或赋值运算符是让处理其复制的标准方法。我从未见过虚拟赋值运算符的用例，所以我猜它们很少见。

3.  `std::copy`具有正确复制类对象的优点。`memcpy`它可以处理的类型相当有限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T14:01:48.690

1.  如果您要进行深度复制的构造函数可能会抛出您可以处理的东西，请继续抓住它。不过，我只是让内存分配异常传播。
2.  复制构造函数（或任何构造函数）不能是虚拟的。包括这些的基类初始化程序。复制赋值运算符应该委托给基类，即使它们是虚拟的。
3.  `memcpy()`对于在 C++ 中复制类类型来说太低级了，并且可能导致未定义的行为。我认为`std::copy`通常是更好的选择。**

# actionscript-3 - 我可以阻止嵌套的 swf 进行 http 调用吗？

> ID：11208775
> 
> 赞同：0
> 
> 时间：2012-06-26T13:47:52.537
> 
> 标签：actionscript-3, flash

例如：我有一个 swf，假设是“A”，它加载另一个 swf，“B”。我可以在 B 上阻止任何与互联网的通信吗？

```
 A loads B --- X --- internet
 ^                      ^
 |______________________| 
```

谢谢！！！G。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T15:41:31.030

你不能。Internet 访问不是您可以在安全方面阻止的东西。

# string - 如何查找由Lua中关键字的曾经使用过的字母组成的单词？

> ID：11208776
> 
> 赞同：0
> 
> 时间：2012-06-26T13:47:55.650
> 
> 标签：string, parsing, search, lua

> **可能重复：**
> [如何在 Lua 中找到由关键字内的字母组成的单词？](https://stackoverflow.com/questions/11206914/how-can-i-find-the-words-consist-of-the-letters-inside-the-keyword-in-lua)

我正在尝试查找由关键字内的字母组成的单词。但是，一旦检测到这些字母在单词内，就不应再次使用这些字母。

我把这些词放在字典里。

例如我有关键字：“asdasdas”

我的代码在这些条件下打招呼

```
 consistLetters("asdasdas","asdas")
  consistLetters("asdasdas","sad")
  consistLetters("asdasdas","sss") 
```

但是，当我使用关键字中不是我想要的所有“s”时，它也会打招呼：

```
 consistLetters("asdasdas","ssss") 
```

如何阻止这种情况？谢谢你。

编辑：我解决了我的问题并将其作为答案分享。我希望它会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:23:22.693

这是我的代码：

```
 function consistLetters(keyword,word)

keywordletters={ }
    wordletters= { }
local found=false
findLetters(keyword,keywordletters)
findLetters(word,wordletters)

for i=1, #wordletters,1 do
    for j=1, #keywordletters,1 do
        if(keywordletters[j]~="") then
            if(wordletters[i]==keywordletters[j]) then
                keywordletters[j]="" 
                found=true;
                break
            end
         end
    end
    if found~=true then
        return false
    end
      found=false;  
    end     

  end 
```

# ajax - AJAX 请求和连接超时：Chrome 超过 15 小时后不会超时，但 IE 呢？

> ID：11208777
> 
> 赞同：3
> 
> 时间：2012-06-26T13:48:05.197
> 
> 标签：ajax, google-chrome, internet-explorer-7, timeout, connection

我正在编写一个 Web 应用程序，它从客户端浏览器获取脚本输入并通过 AJAX 将其发送到 Java servlet。收到脚本后，Java 类执行脚本并将一些信息发送回网页。

我现在正在测试的 Web 应用程序的一个重要组件是连接超时以及浏览器连接何时/是否会在很长一段时间后超时。对我来说，重要的是在 Java servlet 发送响应之前连接不会超时，或者至少应该处理超时。

我已经研究了处理这个问题的方法，我对需要做什么有一个模糊的理解，但首先，我决定尝试让连接超时，以了解在没有任何错误处理的情况下一切将如何表现. 昨天，我从客户端的脚本输入中向 servlet 发送了一个命令，该命令告诉 servlet 休眠到今天早上。今天早上回来发现，在 Chrome 中，成功接收到了 servlet 响应，并愉快地在浏览器中显示了自己。

在 IE7 中，我没有那么幸运 :(

在等待响应超过**15 小时**后，IE7 超时，而 Chrome 没有。我想要么两者都会超时，要么两者都不会。

此外，知道我正在使用 Struts2 框架可能会有所帮助。

谁能解释一下？

谢谢！

PS我试图在我的问题解释中尽可能详细，但我很乐意提供任何额外的信息。我也没有包含代码，因为我认为没有任何相关的，但是如果您想查看一些代码，请再次告诉我您希望我包含哪些代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T14:01:46.767

事实证明 Chrome 很棒，而 IE 不是（惊喜！）。这是我很确定发生的事情：

在 ajax 调用中，由于没有设置超时，Chrome 让超时默认为 0，即永不超时。

IE7 是令人讨厌的浏览器（不幸的是，我必须为其开发），不希望发生这种情况，因此它坚持使用注册表设置的 60 分钟默认超时。

JQuery 和 AJAX 通过一些长轮询（或者至少我理解的长轮询）使处理这个错误变得轻而易举。这是我所做的：

**初始 AJAX 请求（包含在函数中）：**

```
$.ajax({

            beforeSend: function() {

                inUse = true;
                disableInput();

            },

            url: "executeScript.do",
            data: params,
            dataType: "text",
            type: "post",
            success: function(responseText) {

                onSuccess(responseText);

            },
            error: function(jqXHR, textStatus, errorThrown) {
                if(textStatus == "timeout") {
                    pollServlet();
                }               
            }
        });
... 
```

**长轮询（？）**

```
function pollServlet() {

var params = "testID=" + document.getElementById("testIDValue").value;

$.ajax({
    url: "servletQuery.do",
    dataType: "text",
    type: "post",
    data: params,
    success: function(response) {

        if(!isNaN(parseInt(response, 10))) {
            setTimeout(pollServlet, parseInt(response, 10));
        } else {
            onSuccess(response);
        }
    }
}); 
```

}

这行得通！然而，我注意到的一件事是 IE7 在超时而不是“超时”时返回“错误”的文本状态......奇怪！

# batch-file - 批处理文件：检查日历

> ID：11208779
> 
> 赞同：1
> 
> 时间：2012-06-26T13:48:15.120
> 
> 标签：batch-file

我如何使用日历检查日期，我想要做的是用户以这种方式插入日期 2012/07/15，并且我想检查该日期是否存在于日历中。例如，如果他插入 2012/14/13 甚至 2012/02/31 ，我尝试手动执行此操作，但它真的很难，所以我的问题是：

1.  是否有本机功能（甚至 3d 派对工具）来检查日历中的日期？

2.  如果用户插入日期和时间，我想在不同的时区位置给出相同的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T15:32:20.360

没有简单的本机批处理命令可以验证您的字符串。

这是一个可用于验证日期字符串的批处理子例程。

```
@echo off
setlocal
set "dt="
set /p "dt=Enter a date in yyyy/mm/dd format: "
if not defined dt exit /b
call :validateDate dt && (echo date is valid) || (echo ERROR: date is invalid)
exit /b

:validateDate
setlocal enableDelayedExpansion
echo !%~1!|findstr /rx "[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]" >nul || exit /b 1
for /f "tokens=1,2,3 delims=/" %%A in ("!%~1!") do (
  set /a "yyyy=10000%%A%%10000, mm=100%%B%%100, dd=100%%C%%100" || exit /b 1
)
if %mm% lss 1 exit /b 1
if %mm% gtr 12 exit /b 1
if %dd% lss 1 exit /b 1
set "months=;1-31;2-28;3-31;4-30;5-31;6-30;7-31;8-31;9-30;10-31;11-30;12-31;"
for /f "delims=;" %%A in ("!months:*;%mm%-=!") do set maxDays=%%A
set /a "divBy4=yyyy%%4, divBy100=yyyy%%100, divBy400=yyyy%%400"
if %mm% equ 2 if %divBy4% equ 0 (
  if %divBy100% neq 0 set /a maxDays+=1
  if %divBy400% equ 0 set /a maxDays+=1
)
if %dd% gtr %maxDays% exit /b 1
exit /b 0 
```

它只接受您在问题中发布的 4 位数年份、2 位数月份和 2 位数日期。如果要支持 1 位数的月份或日期，请将 FINDSTR 更改为以下内容：

```
echo !%~1!|findstr /rx /c:"[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]" ^
                       /c:"[0-9][0-9][0-9][0-9]/[0-9]/[0-9][0-9]" ^
                       /c:"[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9]" ^
                       /c:"[0-9][0-9][0-9][0-9]/[0-9]/[0-9]">nul || exit /b 1 
```

我不明白你想对日期和时区做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T19:19:36.160

下面的子程序由两部分组成。首先它检查第一个参数中给出的日期，如果日期不正确，则返回 ERRORLEVEL=1。如果您愿意，您可以插入年份有效范围（否则，请删除 yyOK 部分）。

然后在第 2 和第 3 个参数中进行基准小时和时区调整，并显示调整后的日期。

```
:validateDate result= YYYY/MM/DD [HH HHAdjust]
setlocal EnableDelayedExpansion
set i=0
for %%a in (31 28 31 30 31 30 31 31 30 31 30 31) do (
   set /A i+=1
   set daysPerMonth[!i!]=%%a
)
set result=Invalid date
for /F "tokens=1-3 delims=/" %%a in ("%2") do set yy=%%a& set mm=%%b& set dd=%%c
set /A yy=%yy%, mm=10%mm% %% 100, dd=10%dd% %% 100, yyMOD4=yy%%4 >NUL 2>&1 || goto exit
if %yyMOD4% equ 0 set daysPerMonth[2]=29
set /A yyOK=0, mmOK=0, ddOK=0
rem Modify year limits as you wish (or remove they):
if %yy% geq 1900 if %yy% leq 2015 set yyOK=1
if %mm% geq 1 if %mm% leq 12 set mmOK=1
id %dd% geq 1 if %dd% leq !daysPerMonth[%mm%]! set ddOK=1
set /A dateOK=yyOK*mmOK*ddOK
if %dateOK% neq 1 goto exit
rem Date is correct
set result=%yy%/%mm%/%dd%

rem Adjust the hour to different time zone, if given
rem %3=base hour, %4=adjust with sign (+ or -)
if "%4" equ "" goto exit
set /A newHH=10%3 %% 100 %4
if %newHH% gtr 23 (
   rem Pass to next day
   set /A newHH-=24, dd+=1
   if !dd! gtr !daysPerMonth[%mm%]! (
      set /A dd=1, mm+=1
      if !mm! gtr 12 (
         set /A mm=1, yy+=1
      )
   )
)
if %newHH% lss 1 (
   rem Pass to previous day
   set /A newHH+=24, dd-=1
   if !dd! lss 1 (
      set /A mm-=1
      if !mm! lss 1 (
         set /A mm=12, yy-=1
      )
      for %%m in (!mm!) do (
         set /A dd=daysPerMonth[%%m]
      )
   )
)
set result=%yy%/%mm%/%dd% %newHH%

:exit
endlocal & set %1=%result%
exit /B 
```

测试这个程序并报告任何问题。

**编辑**：我已经修改了以前的程序以适应新 OP 的要求。

该子例程不再返回带有结果的 ERRORLEVEL 值。现在必须使用新的第一个参数调用它，该参数指示将接收结果的变量，如果原始日期不正确，它将是“无效日期”。如果给出了基准和调整小时，则返回值包括调整的日期和小时。例如：

```
call validate.bat adjusted= 2012/3/5 3 -2
if "%adjusted%" neq "Invalid date" (
   echo Adjusted date and hour are: %adjusted%
) 
```

安东尼奥

# php - 立即发送 Zend_Controller_Response_Http

> ID：11208781
> 
> 赞同：1
> 
> 时间：2012-06-26T13:48:19.810
> 
> 标签：php, zend-framework, zend-controller

我正在开发一项休息服务。一些外部系统向我发送了一个 XML 文件，我对其进行解析、在 DB 中加载数据，然后发送响应 - “已加载的具体对象的范围”。

问题是解析数据并将数据添加到数据库需要大量时间，并且外部系统会收到超时错误消息。我想在解析传入的 XML 时立即按部分发送响应：

1 毫秒 - 对象一已加载 2 毫秒 - 对象二已加载

```
class ImportController extends Zend_Rest_Controller{

   Zend_Controller_Front::returnResponse(true);
   $this->getResponse()->setHeader('Content-Type', 'text/html');

   foreach($xml as $xmlElement){
        DbClass::addXmlData($xmlElement);
        $this->getResponse()->setBody('Another object has been loaded');
        $this->getResponse()->setHttpResponseCode(201);
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:04:44.193

一旦您发送了回复，您将无法继续发送。你必须有多个请求。对单个请求的多个响应是不好的做法。

# zend-framework - Zend 错误控制器停止工作 500

> ID：11208783
> 
> 赞同：0
> 
> 时间：2012-06-26T13:48:23.840
> 
> 标签：zend-framework, error-handling

我的 Zend 应用程序一直运行良好，直到今天我更改了一些导致错误控制器停止工作的内容。我已经调试了代码的每一部分，但我找不到任何关于为什么会发生的痕迹

如果我产生 404 错误，则错误控制器运行良好。但在 500 的情况下，控制不会转到错误控制器。

我尝试了很多事情，但仍然无法找出问题所在。我已经搜索了互联网，但遇到这个问题的人似乎没有得到任何答案:(

任何帮助都会非常明显

我一步步调试了应用程序，发现在500的情况下，遇到致命错误或异常时立即停止执行

（更新）如果我做类似的事情......

```
$blabla->getInfo(); 
```

在 $blabla 未定义的地方，我不会被重定向到错误控制器。但如果我做类似的事情......

```
Zend_Registry::get('blabla'); 
```

Zend_Registry 中没有为 'blabla' 设置键，然后我被重定向

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:01:29.423

500 是一般的服务器错误，所以难怪控制权不会转到您的控制器。

您需要检查服务器日志以找出导致错误的原因。

另外，请尝试回想一下您`.htaccess`最近是否更改了文件和/或意外创建了无限重定向循环。

# scala - 如何在宏中重用定义 (AST) 子树？

> ID：11208790
> 
> 赞同：11
> 
> 时间：2012-06-26T13:48:48.467
> 
> 标签：scala, macros, abstract-syntax-tree, scala-2.10

我在 Scala 嵌入式 DSL 中工作，宏正在成为实现我的目的的主要工具。尝试将传入宏表达式中的子树重用到结果中时出现错误。情况相当复杂，但是（我希望）我已经简化了它以便理解。

假设我们有这样的代码：

```
val y = transform {
  val x = 3
  x
}
println(y) // prints 3 
```

其中 'transform' 是所涉及的宏。尽管它看起来似乎什么也没做，但它确实将显示的块转换为这个表达式：

```
3 match { case x => x } 
```

这是通过这个宏实现完成的：

```
def transform(c: Context)(block: c.Expr[Int]): c.Expr[Int] = {
  import c.universe._
  import definitions._

  block.tree match {
    /* {
     *   val xNam = xVal
     *   xExp
     * }
     */
    case Block(List(ValDef(_, xNam, _, xVal)), xExp) =>
      println("# " + showRaw(xExp)) // prints Ident(newTermName("x"))
      c.Expr(
        Match(
          xVal, 
          List(CaseDef(
            Bind(xNam, Ident(newTermName("_"))),
            EmptyTree,
            /* xExp */ Ident(newTermName("x")) ))))
    case _ => 
      c.error(c.enclosingPosition, "Can't transform block to function")
      block  // keep original expression
  }
} 
```

请注意，**xNam**对应于变量名称，**xVal**对应于其关联值，最后**xExp**对应于包含变量的表达式。好吧，如果我打印 xExp 原始树，我会得到*Ident(newTermName("x"))*，这正是 RHS 案例中设置的内容。由于可以修改表达式（例如 x+2 而不是 x），因此这对我来说不是一个有效的解决方案。我想要做的是重用 xExp 树（参见 xExp 注释），同时改变 'x' 的含义（它是输入表达式中的定义，但将是输出表达式中的 case LHS 变量），但它会启动一个长错误总结在：

```
symbol value x does not exist in org.habla.main.Main$delayedInit$body.apply); see the error output for details. 
```

我当前的解决方案包括解析 xExp 以用新的标识替换所有标识，但它完全依赖于编译器内部，因此是一种临时解决方法。很明显，xExp 附带了 showRaw 提供的更多信息。如何清理该 xExp 以允许“x”扮演案例变量的角色？谁能解释这个错误的全貌？

PS：我一直在尝试使用[TreeApi](http://www.scala-lang.org/api/milestone/index.html#scala.reflect.api.Trees$TreeApi)中的替代 * 方法系列，但没有成功，但我缺少了解其含义的基础知识。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-26T15:18:35.060

分解输入表达式并以不同的方式重新组装它们是宏观学中的一个重要场景（这是我们在`reify`宏内部所做的）。但不幸的是，目前这并不是特别容易。

问题是宏的输入参数到达已经过类型检查的宏实现。这既是福也是祸。

我们特别感兴趣的是，与参数对应的树中的变量绑定已经建立。这意味着所有`Ident`和`Select`节点都`sym`填写了它们的字段，指向这些节点所引用的定义。

这是符号如何工作的示例。我将从我的一个演讲中复制/粘贴一份打印输出（我在这里不提供链接，因为我演讲中的大部分信息现在已被弃用，但这个特定的打印输出具有永恒的用处）：

```
>cat Foo.scala
def foo[T: TypeTag](x: Any) = x.asInstanceOf[T]
foo[Long](42)

>scalac -Xprint:typer -uniqid Foo.scala
[[syntax trees at end of typer]]// Scala source: Foo.scala
def foo#8339
  [T#8340 >: Nothing#4658 <: Any#4657]
  (x#9529: Any#4657)
  (implicit evidence$1#9530: TypeTag#7861[T#8341])
  : T#8340 =
x#9529.asInstanceOf#6023[T#8341];
Test#14.this.foo#8339[Long#1641](42)(scala#29.reflect#2514.`package`#3414.mirror#3463.TypeTag#10351.Long#10361) 
```

回顾一下，我们编写了一个小片段，然后用 scalac 编译它，要求编译器在 typer 阶段之后转储树，打印分配给树的符号的唯一 ID（如果有的话）。

在结果打印输出中，我们可以看到标识符已链接到相应的定义。例如，一方面，`ValDef("x", ...)`代表方法 foo 的参数的 ，定义了一个 id=9529 的方法符号。另一方面，`Ident("x")`方法体中的 将其`sym`字段设置为相同的符号，从而建立了绑定。

好的，我们已经了解了绑定在 scalac 中是如何工作的，现在是介绍一个基本事实的最佳时机。

```
If a symbol has been assigned to an AST node, 
then subsequent typechecks will never reassign it. 
```

这就是为什么 reify 是卫生的。您可以获取 reify 的结果并将其插入任意树（可能定义名称冲突的变量） - 原始绑定将保持不变。这是有效的，因为 reify 保留了原始符号，因此后续类型检查不会重新绑定 reified AST 节点。

现在我们都准备好解释您面临的错误：

```
symbol value x does not exist in org.habla.main.Main$delayedInit$body.apply); see the error output for details. 
```

宏的参数`transform`既包含定义，也包含对变量的引用`x`。正如我们刚刚了解到的，这意味着相应的 ValDef 和 Ident 将使其`sym`字段同步。到现在为止还挺好。

然而不幸的是，宏破坏了已建立的绑定。它重新创建 ValDef，但不清理`sym`相应 Ident 的字段。随后的类型检查为新创建的 ValDef 分配一个新符号，但不会触及逐字复制到结果的原始 Ident。

在类型检查之后，原始 Ident 指向一个不再存在的符号（这正是错误消息所说的 :)），这导致在字节码生成期间崩溃。

那么我们如何修复错误呢？不幸的是，没有简单的答案。

一种选择是利用`c.resetLocalAttrs`，它递归地擦除给定 AST 节点中的所有符号。随后的类型检查将重新建立绑定，前提是您生成的代码不会与它们混淆（例如，如果您将 xExp 包装在一个块中，该块本身定义了一个名为 x 的值，那么您就有麻烦了）。

另一种选择是摆弄符号。例如，您可以编写自己的`resetLocalAttrs`，只删除损坏的绑定而不触及有效绑定。您也可以尝试自己分配符号，但这是一条通往疯狂的捷径，尽管有时人们被迫走它。

一点都不酷，我同意。我们意识到这一点，并打算有时尝试解决这个基本问题。然而，现在我们的手在 2.10.0 最终版本之前进行了错误修复，所以我们无法在最近的将来解决这个问题。更新。有关其他信息，请参阅[https://groups.google.com/forum/#!topic/scala-internals/rIyJ4yHdPDU 。](https://groups.google.com/forum/#!topic/scala-internals/rIyJ4yHdPDU)

* * *

底线。坏事发生了，因为绑定搞砸了。先试试resetLocalAttrs，如果还是不行，就为自己做点家务吧。

# mdx - 这个 MDX 查询有什么问题？

> ID：11208791
> 
> 赞同：1
> 
> 时间：2012-06-26T13:48:50.903
> 
> 标签：mdx, data-warehouse

我试图执行这个查询，但我不明白它有什么问题。

```
 SELECT {[Measures].[Internet Sales Amount],
         [Measures].[Reseller Sales Amount]} ON COLUMNS,
 [Product].[Product].[Product].Members ON ROWS
 FROM [AdventureWorks2008R2] 
```

我收到错误消息：

```
 Msg 102, Level 15, State 1, Line 1
 Incorrect syntax near 'Measures'. 
```

我以为是“{}”并将它们更改为“（）”，然后我收到了这条消息：

```
Msg 102, Level 15, State 1, Line 1
Incorrect syntax near ','. 
```

--- 编辑我在错误的地方编写查询，但现在我收到了另一条消息：

```
Executing the query ...
Query (3, 10) The MEMBERS function expects a hierarchy expression for the  argument.  A member expression was used.

Execution complete 
```

查询：

```
SELECT {[Measures].[Internet Sales Amount] ,
        [Measures].[Reseller Sales Amount]} ON COLUMNS,
       {[Product].[Product].[Product].Members} ON ROWS
FROM [Adventure Works] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:55:51.753

查询没有错。我认为您对 sql db .not 分析服务 db 运行查询。请右键单击 ssas db Adventurework 并运行查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:04:39.807

我认为问题出在这个表达上

```
[Product].[Product].[Product].Members 
```

尤其是第二个和第三个'[Product]' 我认为在你的代码中你可能会放一些空间或..[Product] 产品。检查正确性

我建议从 Cube explorer 中拖拽这个成员。也许它有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:57:08.490

括号首先破坏了查询，因为该语句不是有效的 SQL。更大的问题是您不是在编写 SQL，而是在编写 MDX，因此您的语法是错误的。

你想在某个地方有一个层次结构吗？另外，您是从数据库还是从表中选择？（我不知道，但您需要更改结尾`From []`以选择您想要的内容。）

```
SELECT
Hierarchize({[Measures].[Internet Sales Amount], [Measures].[Reseller Sales Amount]}) ON COLUMNS,
Hierarchize({[Product].[Product].[Product].Members}) ON ROWS 
FROM [AdventureWorks2008R2] 
```

# asp.net - asp.net 中的表单身份验证 Cookie 值漏洞

> ID：11208793
> 
> 赞同：2
> 
> 时间：2012-06-26T13:49:04.847
> 
> 标签：asp.net, asp.net-mvc, authentication, forms-authentication

在 asp.net 中，我可以像往常一样使用表单身份验证登录，复制我们的 auth cookie 值，注销，使用 Chrome 的“编辑此 Cookie”插件将 cookie 人工添加到客户端，刷新（匿名）登录页面嘿，我又重新登录了。这似乎是一个漏洞 - 有什么方法可以使用标准表单身份验证来修复它，还是我必须做一些事情，比如使用一个自定义的 Authorize 属性来覆盖 asp.net mvc 中的现有属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:25:39.730

我不认为这本身就是一个错误。在表单身份验证期间发生以下情况

1.  您向服务器提供用户名/密码
2.  服务器验证用户名/密码
3.  如果有效，则服务器将加密的身份验证票证 (cookie) 发送到客户端，其中包含到期时间（在 web.config 表单身份验证部分中设置）和用户名（全部加密）
4.  在每个需要授权的请求上，cookie 在服务器上被解密，检查过期时间并使用用户名来查看是否授权（或获取请求资源的角色）。
5.  当您注销时，cookie 上的过期时间已设置为过去，因此，它不再是有效的 cookie

现在，至于为什么您会看到您所看到的……您在注销之前复制了 cookie。因此，您复制的 cookie 永远不会注册注销（移动的过期时间）。当您重新附加时，您仍然有一个有效的身份验证 cookie。现在，如果您的表单身份验证超时设置为...假设 20 分钟...如果您复制 cookie 并等待 21 分钟，此方法将失败，因为到那时，它已过期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:50:51.557

Cookie 总是很脆弱，我们对此无能为力。我们能做的是防止有人窃取cookies。

关于 ASP.NET MVC，它可以很好地避免窃取 cookie。作为安全性的一部分，它默认执行的一些主要操作是：

1.  对呈现到视图的字符串进行编码（如果您使用的是 Razor，则不知道其他人）以防止 XSS 攻击。

2.  请求验证（阻止潜在危险数据到达应用程序）。

3.  阻止对 JSON 数据的 GET 访问。

4.  使用 Antiforgery Helpers 防止 CSRF

关于 cookie，Microsoft 提供了`HttpOnly`功能，这有助于从 javascript 中隐藏 cookie。您所说的表单身份验证是一个`HttpOnly`cookie，这意味着有人无法通过 JavaScript 窃取它，而且它更安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T14:23:44.610

您可以使用**任何**cookie/s 来做到这一点。您可以检查/复制任何给定域中的所有 cookie，并根据需要进行欺骗。您可以（仅）对**自己**执行此操作，因为它是您的 PC（或登录到 PC 的用户）。显然，如果您在共享 PC 上，这是一个问题（在您的所有信息中）。

“复制您的 cookie”的行为实际上是恶意软件试图窃取/劫持您的身份（或某些网站上的当前会话）的一种方式。也就是说，除非你有一些恶意软件，否则你不能只是“复制”别人的 cookie。

假设`logout`完成，您可以要求用户关闭他们的浏览器，以便从（文件）系统中删除过期的 cookie。

# jquery - 如果有多个孩子，jquery 会选择哪个孩子？

> ID：11208795
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:49:08.483
> 
> 标签：jquery

我有一个无序列表`<ul id="images" >`。列表中有 3 个列表项，每个项中都有一个图像。每个图像都有不同的宽度。jquery如何处理以下内容。

```
var width = $('#images li img').width(); 
```

var 'width' 将包含 3 个图像宽度中的哪一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:53:16.583

> 它返回所选元素集中第一个元素的宽度。

阅读更多关于[.width()](http://api.jquery.com/width/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T13:52:22.407

它将返回第一个匹配元素的宽度 - [http://jsfiddle.net/FGchc/](http://jsfiddle.net/FGchc/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T13:53:39.747

[`width`方法](http://api.jquery.com/width/)说明：

> “获取匹配元素集中第一个元素的当前计算宽度。”

因此，它将返回第一个匹配元素的宽度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-26T13:54:40.607

第一个图像的宽度。并且 jQuery 的工作深度首先在下面：

```
<div><img></div>
<img> 
```

内部`img`div 将是第一个`img`。

# excel - 从 Outlook 引用和访问 Excel

> ID：11208805
> 
> 赞同：1
> 
> 时间：2012-06-26T13:49:49.620
> 
> 标签：excel, vba

我正在尝试从 Outlook (Office 2010) 更新 Excel 文件。如何引用和访问 Excel？

作为一个简单的测试，我试图计算打开的工作簿的数量。当我运行它时，我得到 0，即使有 2 个打开。

```
Sub Test()
    Dim xlApp As Excel.Application
    Dim xlWBook As Excel.Workbook

    Set xlApp = New Excel.Application
    Debug.Print "xlApp.Workbooks.Count = " & xlApp.Workbooks.Count

    On Error Resume Next
    Set xlWBook = xlApp.Workbooks("Data.xlsx")
    Err.Clear 'Clear error and open File Index

    If  xlWBook Is Nothing Then
        Set xlWBook = xlApp.Workbooks.Open("C:\Users\Chris\Desktop\Data.xlsx")
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:58:34.227

这是我用来检测 Excel 的：

```
Dim xlApp As excel.Application
On Error Resume Next
Set xlApp = GetObject(, "Excel.Application")
If Err.Number = 429 Then 'Excel not running
    Set xlApp = CreateObject("Excel.Application")
End If
On Error GoTo 0 
```

设置 xlApp 后，您可以使用它`xlApp.Workbooks.Count`来计算工作表

注意：如果要查找多个 Excel 实例，此代码将打开第一个

如果您必须查找特定的工作簿，请从此[页面](http://support.microsoft.com/kb/288902)中`Set xlApp = GetObject("Book2").Application`找到该工作簿，即使它不是第一个实例。如果工作簿来自文件或已保存，请替换`book2`为**完整**路径和文件名 -**副作用**-如果文件尚未打开，这也会*打开文件更多使用信息：http:* [//msdn.microsoft.com/en -us/图书馆/aa164798%28v=office.10%29.aspx](http://msdn.microsoft.com/en-us/library/aa164798%28v=office.10%29.aspx)

# wcf - 创建 WCF 休息服务以查找距离

> ID：11208818
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:50:21.180
> 
> 标签：wcf, rest, geolocation

我正在尝试构建 WCF Rest API 以返回两点之间的距离。

要计算距离，我需要源点的纬度、经度和目标点的

纬度和经度。

任何人都可以指导我阅读文章或与使用 WCF 休息架构进行距离计算相关的任何来源。

感谢和问候，

维杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:02:18.767

计算两个经纬度点之间的距离有多种公式。每个都有它的优点和缺点。一些可用的公式是半正弦、余弦球面定律、等角近似、方位角和中点。以下网站描述了每个公式，并提供了用于实现每个公式的 javascript 代码：

[http://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)

至于通过 REST 服务检索位置的纬度和经度，我推荐 GeoNames。我将它们用于邮政编码验证，但它们也提供纬度和经度信息。他们有免费和付费服务。

[http://www.geonames.org/export/web-services.html](http://www.geonames.org/export/web-services.html)

# android - 通过非 Activity 类启动一个新的 Activity 并获取其结果

> ID：11208826
> 
> 赞同：0
> 
> 时间：2012-06-26T13:50:45.463
> 
> 标签：android

通常，为了启动一个新的 Activity 并获得它的结果，我会从一个 Activity 类中使​​用

***[public void startActivityForResult (Intent intent, int requestCode)](http://developer.android.com/reference/android/app/Activity.html#startActivityForResult%28android.content.Intent,%20int%29)***

但是，如果我尝试从非 Activity 类启动一个新的 Activity 并获得它的结果怎么办？我怎样才能做到这一点？

我问的原因是我目前正在`LoginManager`上课（非活动课程）。它具有以下代码。

```
 accountManager.getAccountManager().getAuthToken(account, AUTH_TOKEN_TYPE, true, new AccountManagerCallback<Bundle>() {
        public void run(AccountManagerFuture<Bundle> future) {
            try {
                Bundle bundle = future.getResult();
                if (bundle.containsKey(AccountManager.KEY_INTENT)) {
                    Intent intent = bundle.getParcelable(AccountManager.KEY_INTENT);
                    intent.setFlags(intent.getFlags() & ~Intent.FLAG_ACTIVITY_NEW_TASK);
                    // Compilation error, as LoginManager doesn't have startActivityForResult method.
                    startActivityForResult(intent, REQUEST_AUTHENTICATE); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:02:36.377

`((Activity) mContext).startActivityForResult(.....)`会成功的。

**但结果将传递给持有上下文的实际活动。**

您可以应用以下方法

在 LoginManager 类中创建单参数构造函数，如下所示。

```
class LoginManager
{
  private Context mContext; 
  LoginManager(Context mContext)
  {
    this.mContext=mContext;
  }
  .............................
  //Then whenever you want to call method call like this.

  ((Activity) mContext).startActivityForResult(.....)

} 
```

现在，每当您创建 LoginManager 类的对象时，在 Activity 类中创建如下。

```
LoginManager loginManager=new LoginManager(ActivityName.this); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T13:56:33.927

我会让您项目中的活动扩展某种“BaseActivity”。在该基本活动中，我将覆盖 onActivityResult() 并将结果从那里传递给 LoginManager。

这将使您的所有活动都将其结果传递给您的 LoginManager，因此您不必在任何地方手动覆盖 onActivityResult。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:57:26.930

也许您可以将您的参考发送`Context`到`LoginManager`课程中并使用它来启动`Activity`?

# javascript - 使用箭头键突出显示选定的行

> ID：11208834
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:50:59.797
> 
> 标签：javascript, html, dom

如何修改下面的代码，以便我可以使用箭头键（向上/向下）突出显示表格上的一行。（我已经为点击设置了它，但想用箭头键添加功能）。

沮丧到难以置信。=\

```
<html>
<head>
    <meta http-equiv="Content-Language" content="en-ca">
    <title>Scrolling Data Grid</title>
<style>
/* ==================================================================== */
/* SCROLLING DATA GRID                                                  */
/* ==================================================================== */
DIV.scrollingdatagrid {
    overflow-x:auto;
    overflow-y:auto;
    position:relative;
    padding:0px;
}
DIV.scrollingdatagrid TABLE {
    width : 98.7%; /* Make room for scroll bar! */
    margin:0px;
    border:0px;
    border-collapse:separate;
}
DIV.scrollingdatagrid TABLE TR .locked, DIV.scrollingdatagrid TABLE THEAD TR, DIV.scrollingdatagrid TABLE TFOOT TR {
    position:relative;
}
/* OffsetParent of the TR is the DIV because it is position:relative */
DIV.scrollingdatagrid TABLE THEAD TR {
    top:expression(this.offsetParent.scrollTop);
}

/* Make the z-index values very clear so overlaps happen as expected! */
DIV.scrollingdatagrid TD, DIV.scrollingdatagrid TH { z-index:1; }
DIV.scrollingdatagrid TD.locked, DIV.scrollingdatagrid TH.locked { z-index:2; }
DIV.scrollingdatagrid THEAD TR, DIV.scrollingdatagrid TFOOT TR { z-index:3; }
DIV.scrollingdatagrid THEAD TR TH.locked { z-index:4; }
</style>

<script type="text/javascript">
window.onload = function() { 
html =  ''
html += '<table id="mstrTable" style="table-layout: fixed; font-family: arial; font-size: 9pt;" cellpadding="0" cellspacing="0">\n'
html += '<thead>\n'
html += '<tr>\n'
html += '<th class="locked" style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); text-align: center; height: 30px; width: 20px; color: rgb(102,102,102); background-color: rgb(212,208,200);">#</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN1</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN2</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN3</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN4</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN5</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN6</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN7</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN8</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN9</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN10</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN11</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN12</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN13</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN14</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: 1px solid rgb(128,128,128); padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);"> COLUMN15</th>\n'
html += '<th style="border-bottom: 1px solid rgb(128,128,128); border-top: 1px solid #ffffff; border-left: 1px solid #ffffff; border-right: none; padding-left: 5px; width: 110px; color: rgb(102,102,102); background-color: rgb(212,208,200);">   COLUMN16</th>\n'
html += '</tr>\n'
html += '</thead>\n'
html += '<tbody>\n'
html += '<tr style="color: rgb(102,102,102)">\n'
html += '<td class="locked" style="height: 20px; text-align: center; border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128);">1.</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: none; border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '</tr>\n'
html += '<tr style="color: rgb(102,102,102)">\n'
html += '<td class="locked" style="height: 20px; text-align: center; border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128);">2.</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: none; border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '</tr>\n'
html += '<tr style="color: rgb(102,102,102)">\n'
html += '<td class="locked" style="height: 20px; text-align: center; border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128);">3.</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: none; border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '</tr>\n'
html += '<tr style="color: rgb(102,102,102)">\n'
html += '<td class="locked" style="height: 20px; text-align: center; border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128);">4.</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: 1px solid rgb(128,128,128); border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '<td style="border-right: none; border-bottom: 1px solid rgb(128,128,128); padding-left: 5px; white-space: nowrap; overflow: hidden;">DATA</td>\n'
html += '</tr>\n'
html += '</tbody>\n'
html += '</table>\n'

document.getElementById("p1").innerHTML = html

var color = "#E1E0D7"
var rows = document.getElementById("mstrTable").getElementsByTagName("tr");
var n = rows.length;
var bgcs = [];
for(var i=0; i<n; ++i) bgcs[i] = rows[i].style.backgroundColor;

function changeColor(e) {
if(!e) e = window.event;
var o = e.target? e.target: e.srcElement;
while(o.tagName && o.tagName.toLowerCase()!="tr") o = o.parentNode;
    for(var i=0; i<n; ++i) {
        rows[i].style.backgroundColor = bgcs[i];
        if(rows[i]==o) {
        rows[i].style.backgroundColor = color;
        }//end of if
    }//end of for
}//end of function

if(document.addEventListener) for(var i=0; i<n; ++i) rows[i].addEventListener("click", changeColor, false);
else for(var i=0; i<n; ++i) rows[i].attachEvent("onclick", changeColor);

}//end of onload

</script>

</head>

<body>

<div id="p1" class="scrollingdatagrid" style="width:800px;height:200px;border:1px solid rgb(128,128,128);"></div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:54:07.593

添加一个 eventListener `keyup`，然后检查按下了哪个键。

37 = 左
38 = 上
39 = 右
40 = 下

# c++ - C++ 类模板作为属性类型

> ID：11208839
> 
> 赞同：1
> 
> 时间：2012-06-26T13:51:05.400
> 
> 标签：c++, templates, generics

我在 C++ 项目中有一个类模板：

```
template<class RequestHandler = DefaultRequestHandler>
class Server { ... } 
```

然后我有另一个类，我想在其中保存一个实例`Server<WhateverRequestHandlerIWant>`作为属性。所以目前我有类似的东西：

```
class OtherClass {
public: Server<>* server;
}; 
```

除非我弄错了，否则这只允许我存储`Server`模板参数为 class 的类`DefaultRequestHandler`，对吗？

有没有办法在不制作`OtherClass`类模板的情况下编写它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:54:39.297

您可以为所有类似服务器的类添加一个通用抽象类：

```
class IServer { ... }; 
```

然后

```
template<class RequestHandler = DefaultRequestHandler>
class Server : virtual public IServer { ... } 
```

和

```
class OtherClass {
public: IServer* server;
}; 
```

# php - 从javascript调用php函数，onload（AJAX？）

> ID：11208840
> 
> 赞同：1
> 
> 时间：2012-06-26T13:51:05.917
> 
> 标签：php, javascript, ajax, function, onload

我已经搜索了将近一个小时，但没有找到合适的示例来解决我的问题：我想调用一个 PHP 函数（它是一个简单的取消链接，它与在页面加载时执行的 javascript 函数给出的路径相链接）。我一点也不擅长 AJAX，我想了解如何从 javascript 代码中直接调用 index.php 文件中包含的 PHP 函数。

这是我的 javascript 代码片段中的内容：

```
var xmlhttp;

if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","/dev/templates/absolu/index.php?s=" + Math.random(),true);
//@unlink(listeImages[i].toString()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-26T13:59:02.140

您发送函数名称（以防您将来有更多函数）和参数作为 get params

```
var fileToDelete;
var xmlhttp;

    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.open("GET","/dev/templates/absolu/index.php?s=" + Math.random()+"&action=delete&file="+fileToDelete,true); 
```

在您的 PHP 脚本上，您应该处理它：

```
<?php
if (isset($_GET['action'])){
  switch($_GET['action']){  
     case 'delete':
       @unlink(listeImages[$_GET['action']].toString());
     break;
     //Other functions you may call
  }
  exit;
}
//The rest of your index.php code
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T13:57:39.200

您不能直接从 ajax 调用中调用 php 函数，它只会调用 php 脚本，就像您从浏览器打开页面 index.php 一样。

您必须在 php 脚本中添加测试才能知道必须调用哪个函数，例如。：

如果您在 ajax 中调用页面 /dev/templates/absolu/index.php?mode=delete_image&image=filename.png

```
<?php
if($_GET['mode'] == "delete_image") {
    unlink($_GET['image']);
}
?> 
```

请注意任何人都可以调用此页面，因此您必须检查将删除的内容并验证您在 GET 参数中收到的内容。在这里我可以调用`/dev/templates/absolu/index.php?mode=delete_image&image=index.php`删除 php 脚本页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:55:15.997

使用 jquery (http://jquery.com/) 你可以这样调用：

```
$(document).ready(function() {
  $.get("/dev/templates/absolu/index.php?", {
    'action': 'delete',
    'other': 'get-parameters',
    'r': Math.random()
  });
}); 
```

服务器端示例：

```
<?php

switch( $_GET['action'] ) {
  case 'delete': 
    // call unlink here
  break;
  case 'dosomething':
    // else
  break;
  default: 
    // Invalid request
  break;
} 
```

请注意，删除文件应负责任地处理（执行安全检查），以确保不会意外或故意删除错误文件。

# rapidminer - 仅在加载模型一次时对来自 Java 代码的输入进行分类

> ID：11208843
> 
> 赞同：0
> 
> 时间：2012-06-26T13:51:17.723
> 
> 标签：rapidminer

我正在开发一个使用 RapidMiner 进行分类的应用程序。我不时（例如每天）训练分类器，但我以非常高的速度使用分类器（每秒 250 次）。为此，我使用 RM GUI 创建了两个进程。第一个训练分类器并将其保存到模型文件中，而第二个使用它进行分类。

在第二个过程中，我加载第一个过程创建的模型文件。这使它变得非常慢，因为似乎每次我想对输入进行分类时该过程都会加载它。可以在下图中看到第二个过程：（ [来源：][[shiaupload.ir](http://www.shiaupload.ir/images/49702023985911120612.png)][）][![](../Images/f27ef385797a0d07bea8858478583427.png)](https://i.stack.imgur.com/RlDtz.png)

这样做更聪明的方法是什么？

PS 我认为一个解决方案是创建另一个进程，它只加载创建的分类器一次，然后将其作为另一个输入提供给 ApplyModel 子进程。但是我没有在 Java 代码中找到这样做的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:04:07.450

已经在这里讨论并解决[了](http://rapid-i.com/rapidforum/index.php/topic,5222.0.html)。

# sql-server - Sql Server Reporting Services 参数传递

> ID：11208844
> 
> 赞同：0
> 
> 时间：2012-06-26T13:51:18.020
> 
> 标签：sql-server, reporting-services, bids

我正在创建一个报告，当您单击一个数据点时，它会打开另一个报告，提供该数据点的详细信息。我的问题是参数传递。我要传递的是来自该数据点的信息。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T00:38:33.973

右键单击用于导航到子报告的单元格，然后选择属性。单击导航选项卡。在显示跳转到报告的超链接操作部分中，单击参数按钮。这显示了链接报表的参数，并允许您输入要传递的值的表达式，例如字段值等。要传递参数值，请输入：

```
=Parameters!PropID.Value 
```

# java - GlassPane 未显示在 JFrame 上

> ID：11208845
> 
> 赞同：3
> 
> 时间：2012-06-26T13:51:21.510
> 
> 标签：java, swing, jframe, paintcomponent, glasspane

我一直在尝试`GlassPane`为我的游戏的游戏内 HUD 实现一个，但现在我似乎无法`JFrame`将我的设置`GlassPane`为它自己的我；我已经使用`setGlassPane()`并且我一直在阅读一些示例试图找出我的错误，但是没有。所以我写了一个[SSCCE](http://sscce.org/)来演示我的问题。我有一个 JFrame，我向其中添加了一个带有标签“TESTIING”的 Jpanel，然后我启动我的 galss 窗格并在我的框架实例上调用 setGlassPane()。我的 GlassPane 有 a `MouseListener`、 a`JPanel`和 2`JLabels`和一个覆盖，`paint()`但是`MouseListener`不会工作，`paint()`不会显示，我的标签不存在（所以基本上我`GlassPane`没有被设置为我的新框架`GlassPane`）-

```
/*Main.java*/

import java.awt.EventQueue;

public class Main {

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                TestGlassPane testGlassPane=new TestGlassPane();
                testGlassPane.setVisible(true);
            }
        });
    }
}

/*TestGlassPane.java*/

import java.awt.BorderLayout;
import java.awt.Container;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

class TestGlassPane extends JFrame{
    private GlassGamePane m_glassPane;
    private JPanel drawingPanel;
    private JLabel testLabel;

    public TestGlassPane() {
        createUI();
    }
    private void createUI() {
        setTitle("Test GlassGamePane");
        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        setSize(800, 700);
        setResizable(false);
        setLocationRelativeTo(null);

        createComponents();
        //add components to frames content pane
        addComponentsToContentPane(getContentPane());

        //setting glassPane 
        m_glassPane = new GlassGamePane();
        //set opaque to false, i.e. make transparent 
        m_glassPane.setOpaque(false);
        m_glassPane.setVisible(true);

        getRootPane().setGlassPane(m_glassPane);
    }

    private void addComponentsToContentPane(Container contentPane) {
        drawingPanel.add(testLabel);
        contentPane.add(drawingPanel, BorderLayout.CENTER);
    }

    private void createComponents() {
        drawingPanel=new JPanel(new BorderLayout());
        testLabel=new JLabel("TESTIING");
    }
}

/*GlassGamePane.java*/

import java.awt.*;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class GlassGamePane extends JPanel implements MouseListener {

    private JPanel statusPanel;
    private JLabel healthLabel;

    public GlassGamePane() {
        createGlassPane();
    }

    private void createGlassPane() {
        setLayout(new BorderLayout());
        createComponents();
        statusPanel.add(healthLabel);
        add(statusPanel, BorderLayout.NORTH);
        addMouseListener(this);
    }

    private void createComponents() {
        statusPanel = new JPanel(new GridLayout(2, 6));
        healthLabel = new JLabel("Player Health:");
        healthLabel.setForeground(Color.RED);
        healthLabel.setBackground(Color.BLUE);

    }

    @Override
    public void paintComponent(Graphics g) {
        g.setColor(Color.red);
        //Draw an oval in the panel  
        g.drawOval(10, 10, getWidth() - 20, getHeight() - 20);
    }

    @Override
    public void mouseClicked(MouseEvent me) {
        Toolkit.getDefaultToolkit().beep();
    }

    @Override
    public void mousePressed(MouseEvent me) {
        Toolkit.getDefaultToolkit().beep();
    }

    @Override
    public void mouseReleased(MouseEvent me) {
    }

    @Override
    public void mouseEntered(MouseEvent me) {
    }

    @Override
    public void mouseExited(MouseEvent me) {
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T14:15:47.933

看来您必须先将自定义添加`GlassPane`为框架`GlassPane`，然后才能`GlassPane`显示！这里的代码似乎有效：

```
 //setting glassPane 
    m_glassPane = new GlassGamePane();
    setGlassPane(m_glassPane);
    //set opaque to false, i.e. make transparent 
    m_glassPane.setOpaque(false);
    m_glassPane.setVisible(true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:26:15.920

来自 JavaDoc：[http](http://docs.oracle.com/javase/7/docs/api/javax/swing/JRootPane.html#setGlassPane(java.awt.Component) ://docs.oracle.com/javase/7/docs/api/javax/swing/JRootPane.html#setGlassPane(java.awt.Component )

您需要在将玻璃窗格添加到 JRootPane 后将其设置为可见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:27:36.200

*   似乎正确创建了 Glasspane，但 Glasspane 仅覆盖轻量级 JComponent 否则在后面，隐藏为​​重量级 Swing 或 AWT J/Component

*   Glasspane 尚未实现任何 LayoutManager，您必须设置正确的 LayoutManager

*   用于测试放置带有一些背景的非不透明 JLabel

*   我喜欢 Glasspane，但您可以使用基于 JXLayer (Java6) 或 OverlayLayout 的 JLayer (Java7)，这是最简单的方法

# c# - 将模板字段从整数转换为 hh:mm

> ID：11208846
> 
> 赞同：0
> 
> 时间：2012-06-26T13:51:21.863
> 
> 标签：c#, asp.net

我目前正在使用 gridview 并想将我的总分钟字段转换为 hh:mm

这就是我的代码现在的样子，它需要总分钟数并返回 hh.00

```
 </asp:TemplateField>
                <asp:TemplateField HeaderText="Hours" HeaderStyle-Width="88px">
                    <ItemTemplate>                       
                        <%# (((PendingApprovalListData)Container.DataItem).TotalMinutes / 60.00).ToString("N2")%>
                    </ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:57:04.613

```
you can use this code :

    var Hours = Math.floor(Yourvariable/60);
    var Minutes = Yourvariable%60;

Or you can use this

var span = System.TimeSpan.FromMinutes(Yourvariable);
var hours = ((int)span.TotalHours).ToString();     
var minutes = span.Minutes.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T07:04:50.460

客户端示例

```
<ItemTemplate>
    <asp:Label ID="lblExemptionDate" runat="server" Text='<%#Bind("ExemptDate","{0:dd MMM yyyy HH:mm:ss}")%>'></asp:Label>
</ItemTemplate> 
```

# wcf - 此故障的创建者未指定原因

> ID：11208848
> 
> 赞同：1
> 
> 时间：2012-06-26T13:51:25.883
> 
> 标签：wcf, validation-application-bl

我在 WCF 服务的模型中设置了验证属性

```
[MinLength(6, ErrorMessage = "Password should be at least 6 characters long")]
public String Password { get; set; } 
```

当这失败时，我在标题中得到异常，而不是在属性中指定的错误消息。我正在使用 WCF 的验证应用程序块。

方法定义是这样的：

```
[OperationContract]
[FaultContract(typeof(ValidationFault))]
User updateUser(User user); 
```

有人可以告诉我我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:19:40.557

> 当这失败时，我得到了异常

您应该指定您期望的故障类型，所以使用

```
catch (FaultException<ValidationFault> ex) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:17:58.803

我认为您没有处理验证错误。在操作合同中使用验证错误。你可以参考这个链接.. [http://www.codeproject.com/Articles/18667/Introduction-to-Validation-Application-Block-integ](http://www.codeproject.com/Articles/18667/Introduction-to-Validation-Application-Block-integ)

# xpages - NotesXSPDocument - 插入一个布尔中断 getDocument

> ID：11208849
> 
> 赞同：2
> 
> 时间：2012-06-26T13:51:27.793
> 
> 标签：xpages, lotus-domino, xpages-ssjs

我有一个 XPage，由于（应该是）一个小变化而刚刚损坏。

如果我运行（其中 document1 是 NotesXSPDocument 数据源）：

```
document1.replaceItem("ItemName", false); //or true, or any variable/formula that results in a boolean 
```

其次是：

```
document1.getDocument(true); 
```

我最终得到一个错误

> [TypeError] 调用方法 NotesXspDocument.getDocument(boolean) 发生异常 null

这是在一个新文档上（因此尚未保存，我尚未对其进行测试，但可能会有所不同），因此我不能只在基础文档上设置该字段。

它似乎不是页面中其他任何东西的产物，因为基本测试页面证实了这一点。除了布尔值之外，任何东西（我发现）都不会发生这种情况。

除了更改数据类型之外，还有什么建议吗？我想这就是我最终要做的（连同错误报告），但我想知道我并没有首先遗漏什么。

谢谢

------------测试XSP代码------------

```
<?xml version="1.0" encoding="UTF-8"?>
<xp:view xmlns:xp="http://www.ibm.com/xsp/core"><xp:this.data>
   <xp:dominoDocument var="document1" formName="Test" />
   </xp:this.data><xp:span style="font-weight:bold">
        Button 1 code:</xp:span><xp:br></xp:br>document1.replaceItemValue(&quot;Test&quot;,false);
<xp:br></xp:br>var doc:NotesDocument = document1.getDocument(true);
<xp:br></xp:br>print(doc.toString());<xp:br></xp:br>
    <xp:button value="Test 1" id="button1">
        <xp:eventHandler event="onclick" submit="true"
            refreshMode="complete">
            <xp:this.action><![CDATA[#{javascript:document1.replaceItemValue("Test",false);
var doc:NotesDocument = document1.getDocument(true);
print(doc.toString());}]]></xp:this.action>
        </xp:eventHandler></xp:button>
    <xp:br></xp:br>
    <xp:br></xp:br>
    <xp:br></xp:br>
    <xp:br></xp:br><xp:span style="font-weight:bold">
    Button</xp:span><xp:span style="font-weight:bold"> 2</xp:span><xp:span style="font-weight:bold"> Code:</xp:span><xp:span style="font-weight:bold"></xp:span>&#160;<xp:br></xp:br>document1.replaceItemValue(&quot;Test&quot;,&quot;Test);<xp:br></xp:br>var doc:NotesDocument = document1.getDocument(true);
<xp:br></xp:br>print(doc.toString());<xp:br></xp:br><xp:button value="Test 2" id="button2">
        <xp:eventHandler event="onclick" submit="true"
            refreshMode="complete">
            <xp:this.action><![CDATA[#{javascript:document1.replaceItemValue("Test","Test");
var doc:NotesDocument = document1.getDocument(true);
print(doc.toString());}]]></xp:this.action>
        </xp:eventHandler></xp:button></xp:view> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T14:24:11.893

如果您查看堆栈跟踪，您将看到以下内容：

```
....
NotesException: Unknown or unsupported object type in Vector
    lotus.domino.local.Document.NreplaceItemValue(Native Method)
    lotus.domino.local.Document.replaceItemValue(Unknown Source)
    com.ibm.xsp.model.domino.wrapped.DominoDocument.applyChangesToDoc(DominoDocument.java:1698)
    com.ibm.xsp.model.domino.wrapped.DominoDocument.applyChanges(DominoDocument.java:1649)
    com.ibm.xsp.model.domino.wrapped.DominoDocument.getDocument(DominoDocument.java:544)
    com.ibm.xsp.script.WrapperDominoEx$fct_DominoDocument.call(WrapperDominoEx.java:254)
.... 
```

问题是您使用了带有不受支持的数据类型的*replaceItemValue方法。*

以下是所有允许的数据类型的列表：

*   字符串文本
*   整数
*   双数
*   DateTime 日期时间项
*   带有 String、Integer、Double 或 DateTime 元素的 java.util.Vector 多值文本、数字或日期时间项
*   项目 与项目相同的数据类型

在后端文档与数据源文档同步时引发错误。*这就是调用document1.getDocument(true)*时失败的原因。

希望这可以帮助

斯文

**编辑：** 为什么将值设置为*false*？

# android - 上传文件webservice，打不开

> ID：11208850
> 
> 赞同：0
> 
> 时间：2012-06-26T13:51:32.777
> 
> 标签：android, web-services

我正在编写一个必须在 wcf 网络服务上发送图片的 android 应用程序。我的应用程序可以联系网络服务并给它图片。但是，尺寸不同，我无法在网络服务上打开图片。

编辑：通过更改网络服务部分，我得到了完全相同的大小。但是，还是打不开。

Android部分（文件大小20ko）：

```
File img;
try {
        Log.i("image", "get file");
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(url);
        Log.i("call", "end build");

        MultipartEntity entity = new MultipartEntity();
        entity.addPart("data", new FileBody(f));

        httppost.setEntity(entity);
        Log.i("call", "call");
        HttpResponse response = httpclient.execute(httppost);
        Log.i("call", "After");

    }
catch (Exception e) {
    Log.i("error cal image", e.toString());
} 
```

编辑：网络服务（文件大小 20ko）：

```
[OperationContract]
[WebInvoke(Method = "POST",
ResponseFormat = WebMessageFormat.Json,
BodyStyle = WebMessageBodyStyle.Wrapped,
UriTemplate = "picture")]
public void UploadPicture(Stream image)
{
     var ms = new MemoryStream();
        image.CopyTo(ms);
        var streamBytes = ms.ToArray();
        FileStream f = new FileStream("C:\\appicture.jpg", FileMode.OpenOrCreate);
        f.Write(streamBytes, 0, streamBytes.Length);
        f.Close();
        ms.Close();
        image.Close();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T13:57:27.753

您以块的形式读取文件，但只写入最后一个块：

```
// following line is called once, should be called after each read
fileToupload.Write(bytearray, 0, bytearray.Length); 
```

所以试试这样：

```
/*...*/
do
{
    bytesRead = image.Read(bytearray, 0, bytearray.Length);
    totalBytesRead += bytesRead;
    fileToupload.Write(bytearray, 0, bytesRead);
} while (bytesRead > 0);

fileToupload.Close();
fileToupload.Dispose();
/*...*/ 
```

# c# - 将 DateAdd 和 Format 代码从 VB6 转换为 C#

> ID：11208859
> 
> 赞同：7
> 
> 时间：2012-06-26T13:51:59.033
> 
> 标签：c#, vb6, vb6-migration

我在vb中有以下代码-

```
tAvailableDate = DateAdd("d", 21, Format(Now, gDATEFORMAT)) 
```

我正在尝试将其转换为 C#。

到目前为止我已经转换了这个 -

```
tAvailableDate = DateAdd("d", 21, Format (DateTime.Now, Global.gDATEFORMAT)); 
```

但我找不到`DateAdd()`or`Format()`功能的替代品。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-26T13:55:36.447

`DateAdd`是一种旧的 VB6 方法，它被移植到 VB.NET 中以实现向后兼容性。如果您在 C# 项目中包含命名空间，您也可以让它在 C# 中工作`Microsoft.VisualBasic`，但我不建议在 C# 或 VB.NET 中使用该方法。这是你应该如何做的（它也更容易阅读）：

```
tAvailableDate = DateTime.Now.AddDays(21); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-26T13:54:50.887

我的 VB6 有点生锈了，但如果我记得，你正试图增加 21 天。所以这就是你想要做的：

```
tAvailableDate = DateTime.Now.AddDays(21); 
```

**更新**

您提到您将变量`DateTime`从 a 转换为 a `string`。如果您需要将其恢复为 a `string`（看起来您可能来自另一条评论），那么您想调用：

```
tAvailableDate.ToString("[format string]"); 
```

有关以所需方式格式化字符串的帮助，请参阅：http: [//msdn.microsoft.com/en-us/library/az4se3k1.aspx](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T13:44:07.387

我已经考虑过你的问题，昨天我错过了一个方面。我认为这个`Format`功能没有意义，但是，即使它看起来很奇怪，它也可以有意义。让我解释。

在 VB6 中，我们有

```
tAvailableDate = DateAdd("d", 21, Format(Now, gDATEFORMAT)) 
```

为什么它看起来很奇怪（甚至是错误的）？`Now`是一个`Date`。`Format`将此日期转换为 a `String`（准确地说是`Variant`包含 a `String`），但`DateAdd`需要一个`Date`参数才能添加天数。`DateAdd`声明如下：

```
Function DateAdd(Interval As String, Number As Double, Date) 
```

VB6 没有给出警告或编译器错误，而是默默地将此字符串转换回 a`Date`并将其传递给`DateAdd`. 所以我的第一个假设是放弃这个`Format`。

但这`Format`可能会对结果产生预期的影响，具体取决于`gDATEFORMAT`定义方式。如果`gDATEFORMAT`只包含日期部分，格式函数将删除时间部分！然而，这可以简单地通过使用`Date`函数而不是使用`Now`VB6中的函数来实现

```
tAvailableDate = DateAdd("d", 21, Date) 
```

或`DateTime.Today`在 .NET（C# 或 VB.NET）中。

但`gDATEFORMAT`只能包含月份和年份。VB6（使用我的瑞士语言环境）：

```
Date   ==>  27.06.2012
Format(Date,"MM.yyyy")   ==>  "06.2012"
CDate(Format(Date,"MM.yyyy"))   ==>  01.06.2012 
```

如您所见，在这种情况下，格式化日期会产生返回当月第一天的效果。通过添加 21 天，您将始终得到当月的 22 日。这与将 21 天添加到当前日期完全不同！在 C# 中，您可以使用

```
DateTime today = DateTime.Today;
tAvailableDate = new DateTime(today.Year, today.Month, 22); 
```

为了确定哪种方法是正确的，您必须知道`gDATEFORMAT`包含的内容，或者，如果这是可变的，则格式化日期，然后解析结果字符串以再次获取日期。

# ios - Exchange 2003 WebDAV LastModified 问题

> ID：11208862
> 
> 赞同：1
> 
> 时间：2012-06-26T13:52:07.540
> 
> 标签：ios, exchange-server, webdav, last-modified

我在 Exchange 2003 WebDAV 交互方面遇到问题，希望有人能启发我。我们有一个日历同步应用程序，它使用户的 Exchange 日历与我公司应用程序中内置的日历保持同步。此同步基于 WebDAV 返回中给定日历约会的“LastModified”属性。

问题是，如果用户在他们的 iPad 或 iPhone 上修改约会（这很常见），它不会更新约会的“LastModified”属性，这使得它看起来好像不需要更新约会我们的应用程序。如果我们直接在 OWA 界面中修改约会，它会正确更新。

有谁知道为什么这不会因为设备端更新而更新，或者甚至是我们可以跟踪约会更改的另一种方式？在 Exchange 2007 和 2010 的同步中，我们使用 ChangeKey 属性，但据我所知，Exchange 2003 WebDAV 界面中不存在该属性。任何帮助深表感谢！

# c# - WCF 服务本身触发事件

> ID：11208863
> 
> 赞同：0
> 
> 时间：2012-06-26T13:52:08.113
> 
> 标签：c#, wcf, events, wcf-client

是否可以在没有客户端请求的情况下从服务向连接的客户端触发事件？（我知道，如果我使用客户端请求，我可以使用回调）

我以一些实际状态将对象存储在服务中。这个对象的状态可以经常改变。第一种方法：我可以每秒向该服务发送请求，但我认为它们是更好的方法。

我想到了 wcfservice 本身调用的事件 - 可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:53:46.470

好吧，WCF 中有可用的回调，我猜这就是您所要求的。 [http://msdn.microsoft.com/en-us/magazine/cc163537.aspx](http://msdn.microsoft.com/en-us/magazine/cc163537.aspx)

# javascript - qq在javascript中的意义

> ID：11208864
> 
> 赞同：0
> 
> 时间：2012-06-26T13:52:08.707
> 
> 标签：javascript

我阅读了这个[问题](https://stackoverflow.com/questions/6390297/what-does-it-mean-qq-qq)的答案并理解了代码

```
var qq = qq || {}; 
```

是做的，但是一般qq有什么意义。使用 qq 而不是 zz 或 bb 或 ag 只是常见的做法吗？还是必须是字母qq？

如果它必须是字母qq，那么什么是qq？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:52:52.223

它没有特别的意义。这只是一个随机变量名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:53:37.260

It seems to be simply a quick variable name, like foo, bar, and baz.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T13:53:02.273

这只是一个变量名。相同的结构适用于 zz、bb、ag、bz、tg、hr、eq、po、ly、ed 或其他任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-17T22:53:08.043

该变量`qq`在 Javascript 中没有特殊含义。如果您遇到它，**它可能与您的代码库中的 FileUploaderBasic 库有关**。

成为[Fine Uploader](https://github.com/FineUploader/fine-uploader)的项目[File Uploader](http://github.com/valums/file-uploader)依赖于它可以附加方法/属性的对象。您可以在[代码](https://github.com/FineUploader/fine-uploader/blob/24ed927e890331b6c4cbe39e926be2ae81ad30e3/client/js/ajax.requester.js#L3)中看到事物附加到全局定义的对象，它甚至[在 File Uploader 的 jshint config 中](https://github.com/FineUploader/fine-uploader/blob/24ed927e890331b6c4cbe39e926be2ae81ad30e3/.jshintrc#L113)列为预定义的全局变量。`window.qq``qq`

# amazon-ec2 - Amazon EC2 通过正常关闭自动缩减？

> ID：11208869
> 
> 赞同：33
> 
> 时间：2012-06-26T13:52:26.183
> 
> 标签：amazon-ec2, terminate, autoscaling

我们正在研究使用 EC2 自动缩放来处理负载峰值。在我们的例子中，我们希望根据 SQS 队列大小扩大实例，然后随着队列大小缩小规模，重新得到控制。每条 SQS 消息都定义了一个可能长时间运行的作业（有时每条消息最长 20 分钟），该作业必须在实例终止之前完成。

我们的软件会优雅地处理关闭过程，因此发布`sudo service ourapp stop`将等待应用程序完成后再返回。

我的问题; 当自动缩放开始缩小时它会发出终止（显然就像按下电源按钮），它会等待我们的应用程序在实例“关闭”之前完全退出吗？

[https://forums.aws.amazon.com/message.jspa?messageID=180674](https://forums.aws.amazon.com/message.jspa?messageID=180674) <- 我发现的其他事情似乎表明它没有

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-28T02:26:11.767

在大多数较新的 AMI 上，机器被赋予相当于“停止”（或“关闭 -h now”命令，以便服务正常关闭。只要您的程序与启动/关闭脚本很好地配合，您应该没关系——但是，如果您的程序需要超过 20 秒才能终止，您可能会遇到亚马逊将完全杀死该实例。

亚马逊关于其自动缩放的[文档](http://docs.amazonwebservices.com/AutoScaling/latest/DeveloperGuide/AS_Concepts.html)没有指定终止过程，但是，AWS 的ec2[文档](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/starting-stopping-instances.html)通常确实包含了终止过程中发生的情况——给机器一个“关闭”命令，以及默认的关闭时间在大多数系统上是 30 秒。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-03-06T06:41:51.197

2014 年年中，AWS 引入了“生命周期挂钩”，允许完全控制终止过程。

我们的高级缩小规模流程是：

*   Auto Scaling 向具有实例 ID 的 SQS 队列发送消息
*   控制器应用程序接收消息
*   控制器应用程序发出“停止实例”请求
*   控制器应用程序在实例停止时重新排队 SQS 消息
*   控制器应用程序再次获取消息，检查实例是否已停止（或重新排队消息以稍后重试）
*   控制器应用程序在终止时通知 Auto Scaling“继续”
*   控制器应用程序从 SQS 队列中删除消息

更多详细信息： http: [//docs.aws.amazon.com/autoscaling/latest/userguide/lifecycle-hooks.html](http://docs.aws.amazon.com/autoscaling/latest/userguide/lifecycle-hooks.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-15T15:05:06.833

在自动缩放中使用 replaceunhealthy 选项。

参考： [http ://alestic.com/2011/11/ec2-schedule-instance](http://alestic.com/2011/11/ec2-schedule-instance)

特别看[这个评论](http://alestic.com/2011/11/ec2-schedule-instance#comment-910)。

# python - 扩展弱引用代理/复制行为

> ID：11208872
> 
> 赞同：0
> 
> 时间：2012-06-26T13:52:33.643
> 
> 标签：python, jython, jython-2.5

我有一堂课拿着一张桌子（列表列表）。这个类应该返回一个类似于 sql 的行指针。对于这个行指针，我想用`weakref.proxy`. 但是，我想为行指针添加额外的功能，例如覆盖`__getitem__`方法以允许通过列名进行访问。

有没有一种简单的方法来获得相同的行为（将对我的对象的访问转换为引用的对象），还是我必须重新实现所有特殊方法？

作为一种简单的方法，我可以考虑继承（但由于我没有找到关于`weakref.ProxyType`我什至不会尝试继承的文档，（如何初始化？）。另一种选择可能是定义一些特殊方法，甚至总是重定向“特殊” ( `__xxx__`) 函数调用引用的对象，即使[这](http://docs.python.org/reference/datamodel.html#special-method-lookup-for-new-style-classes)看起来不可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T10:46:37.960

我研究了一些，发现了这一点：

[http://code.activestate.com/recipes/496741-object-proxying/](http://code.activestate.com/recipes/496741-object-proxying/) http://pypi.python.org/pypi/ProxyTypes

所以简而言之，可以转发所有呼叫（我认为活动状态的接收方更好），但我还没有找到一种实现方法：

```
$a = proxy([1,2,3])
$b = a
$print type(b)   
>>list 
```

我将满足于只使用一个与列表非常相似的对象。

# websphere - 反向代理设置问题

> ID：11208874
> 
> 赞同：0
> 
> 时间：2012-06-26T13:52:34.150
> 
> 标签：websphere

我正在尝试使用 Sun java webserver（端口 8099）作为我的 websphere 应用程序服务器（端口 8051）的反向代理

我在 obj.conf 中添加了这个条目

```
<Object name="reverse-proxy-/">
Route fn="set-origin-server" server="http://example.com:8051"
</Object>

<Object ppath="http:*">
Service fn="proxy-retrieve" method="*"
</Object> 
```

因此，在此之后，当我点击[http://example.com:8099时，它会以](http://example.com:8099)[http://example.com:8051/app](http://example.com:8051/app)的形式正确路由到 websphere

但是一旦我进入我的应用程序，它就会永远路由到我的 websphere 应用服务器，即在我使用用户名和密码从[http://example.com:8099/app/login.html](http://example.com:8099/app/login.html)登录后，它会永远转发到[http://example。 com:8051/app1](http://example.com:8051/app1)

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T16:00:24.373

您的 WebSphere 虚拟主机的别名列表中有 example.com:8099 吗？

# python - pylab中表格的子图

> ID：11208885
> 
> 赞同：0
> 
> 时间：2012-06-26T13:53:03.587
> 
> 标签：python, matplotlib

我正在寻找一种方法来创建包含几个子图的图形，这些子图是表格。让我试着解释一下我在说什么。下面是一个有几个子图的`imshow`图。我想要完全相同的数字，但我想要的不是“imshow”图，而是简单的表格。在我的示例中，它们只会显示值 1 和 2：

```
[1, 2]
[2, 1] 
```

我该怎么做？

先感谢您

![在此处输入图像描述](../Images/b86ee7cc57ba93e82bd17a021c68b939.png)

这是我用来生成图表的代码。

```
import pylab
import numpy as np

x = np.array([[1,2],[2,1]])

fig = pylab.figure()

fig_list = []

for i in xrange(5):

    fig_list.append( fig.add_subplot(2,3,i+1) )
    fig_list[i] = pylab.imshow(x)

pylab.savefig('my_fig.pdf')
pylab.show() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:36:45.643

您可以使用 pylab.table 命令，文档可在[此处](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.table)找到。

例如：

```
import pylab
import numpy as np

x = [[1,2],[2,1]]

fig = pylab.figure()

axes_list = []
table_list = []

for i in xrange(5):
    axes_list.append( fig.add_subplot(2,3,i+1) )
    axes_list[i].set_xticks([])
    axes_list[i].set_yticks([])
    axes_list[i].set_frame_on(False)
    table_list.append(pylab.table(cellText=x,colLabels = ['col']*2,rowLabels=['row']*2,colWidths = [0.3]*2,loc='center'))

pylab.savefig('my_fig.pdf')
pylab.show() 
```

我还创建了一个额外的列表变量，并重命名了 fig_list，因为轴实例被绘制对象的实例覆盖。现在您可以访问两个句柄。

其他有用的命令包括：

```
# Specify a title for the plot
axes_list[i].set_title('test')

# Specify the axes size and position
axes_list[i].set_position([left, bottom, width, height])

# The affect of the above set_position can be seen by turning the axes frame on, like so:
axes_list[i].set_frame_on(True) 
```

文档：

*   [轴 API](http://matplotlib.sourceforge.net/api/axes_api.html#matplotlib.axes.Axes)
*   [表 API](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.table)
*   [表格示例](http://matplotlib.sourceforge.net/examples/pylab_examples/table_demo.html)

# c++ - C++中类型定义的重载运算符

> ID：11208890
> 
> 赞同：0
> 
> 时间：2012-06-26T13:53:18.263
> 
> 标签：c++, operator-overloading, hex

我有

```
typedef std::string OrderID; 
```

我想为此重载运算符 ++。OrderID 的值从 1 开始，每次都使用十六进制递增。可能的值是...

001

002

...

00A

00B

...

00F

010

...

1）您可以为特定类型定义重载运算符，以便不重载 std::string++ 吗？

2）你能像上面那样增加（使用十六进制）吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T13:56:14.837

不，您不能单独进行重载。`OrderID`与此上下文中的完全相同`std::string`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T13:56:51.467

如果你定义

```
OrderID& operator++(OrderID& x)
{
     //...
} 
```

它也将适用于`std::string`。

~~您应该改用**组合**。~~

您应该使用执行此操作的免费函数，不一定在您定义的类型上。它还可以操纵字符串，这很好。

```
void incrementString(OrderID& x)
{
  //...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T14:02:36.023

我想说真正的解决方案是定义一个由`std::string`和/或其他类型组成的新类型，然后只公开*与 Order-Id-class 的接口相关的内容*。

例如，您真的认为`OrderId::find_last_not_of(...)`向所有用户公开方法`OrderId`是一个好主意吗？

更好地组合它，并使其类型安全：

```
class OrderId {
public:
    ...
    foo frob () const { 
        ... rawData_ ...
    }

    OrderId& operator++();    // prefix
    OrderId  operator++(int); // postfix

private:
    std::string rawId_;
}; 
```

并按照 YAGNI 的接口。保持接口小是可重用、可维护和健壮的代码的第一大秘诀，它与客户端代码的耦合度不高。

And also: Only overload operators if it makes sense, your clients should immediately be able to explain what incrementing an order-id means. E.g., it makes sense to increment integers, it makes sense to increment statistical counters, but it wouldn't make sense to increment cars. So, go the way of least suprise, and re-think whether `operator++` makes sense at all, or if you should use a named function instead, e.g.:

```
OrderId successor (OrderId oid) {...}
OrderId predecessor (OrderId oid) {...} 
```

# visual-sourcesafe - VSS 到 TFS 问题

> ID：11208892
> 
> 赞同：3
> 
> 时间：2012-06-26T13:53:23.447
> 
> 标签：visual-sourcesafe

我刚刚将一个 Web 应用程序项目从 VSS 移动到 TFS，当我打开解决方案时，我每次都会收到此消息。

> 您打开的解决方案受源代码管理，但当前未针对 Visual Studio 中的集成源代码管理进行配置。您现在想将此解决方案绑定到源代码管理吗？

任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-26T14:22:53.357

文件菜单/源代码控制/（高级）/更改源代码控制，然后选择所有项目并“取消绑定它们”。之后，您可以尝试在同一个对话框（“绑定”命令按钮）中将它们绑定到 TFS。

# .htaccess - htaccess RewriteRule 重定向不带斜杠的 URL

> ID：11208893
> 
> 赞同：0
> 
> 时间：2012-06-26T13:53:24.603
> 
> 标签：.htaccess

我在我的`.htaccess`文件中有这个片段来防御任何试图进入应用程序目录的人。

```
RewriteCond %{REQUEST_URI} ^/app.*$
RewriteRule ^(.*[^/])/?$ index.php?r=$1 [L,QSA] 
```

虽然它在我去的时候有效`http://domain/app/`，但如果我向 提出请求`http://domain/app`，它会重定向到`http://domain/app/?r=app`.

有谁知道需要改变什么来阻止这种重定向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T20:26:05.043

尝试`DirectorySlash`可以在全局或每个目录中使用的指令。

[http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryslash](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryslash)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:13:55.407

尝试使用

```
[L] 
```

代替

```
[L,QSA] 
```

# mysql - 如何让这 2 个 SQL 查询返回 1 个结果集？（他们选择相同的项目，使用不同的 where 子句）

> ID：11208894
> 
> 赞同：0
> 
> 时间：2012-06-26T13:53:24.870
> 
> 标签：mysql, sql

我想将此查询合并为一个，以按日期返回 2 个值（“scount_atp”，其中 estado=1 和“scount_xxx”，其中 estado=4）：

```
SELECT DATE_FORMAT(FROM_UNIXTIME(fecha),"%m-%d-%Y") as sdate, COUNT(id) as scount_atp FROM entradas WHERE estado = '1' AND fecha <= UNIX_TIMESTAMP(NOW()) AND fecha >= UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 1 YEAR)) GROUP BY sdate

SELECT DATE_FORMAT(FROM_UNIXTIME(fecha),"%m-%d-%Y") as sdate, COUNT(id) as scount_xxx FROM entradas WHERE estado = '4' AND fecha <= UNIX_TIMESTAMP(NOW()) AND fecha >= UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 1 YEAR)) GROUP BY sdate 
```

我是 MySQL 的新手，所以如果这太基本了，我很抱歉......

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T13:57:27.473

```
SELECT 
  DATE_FORMAT(FROM_UNIXTIME(fecha),"%m-%d-%Y") as sdate, 
  SUM(IF(estado = '1',1,0)) as scount_atp,
  SUM(IF(estado = '4',1,0)) as scount_xxx
FROM entradas 
WHERE estado IN('1','4')
  AND fecha <= UNIX_TIMESTAMP(NOW()) 
  AND fecha >= UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 1 YEAR)) 
GROUP BY sdate 
```

让我在这里添加一个不相关的东西：如果该`estado`列是 type `INT`，您可能想要编写`1`而不是`'1'`- 或者您可能以全表扫描结束，将 int 列转换为字符串以进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:01:33.883

我过去做过类似的事情，这对我有用：

```
SELECT 
   DATE_FORMAT(FROM_UNIXTIME(fecha),"%m-%d-%Y") as sdate, 
   COUNT(IF(estado = '1', 1, NULL)) as scount_atp, 
   COUNT(IF(estado = '4', 1, NULL)) as scount_xxx 
FROM entradas 
WHERE 
   fecha <= UNIX_TIMESTAMP(NOW()) 
   AND 
   fecha >= UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 1 YEAR))
GROUP BY sdate 
```

# macos - bash命令将文件从一台计算机复制到另一台计算机

> ID：11208895
> 
> 赞同：19
> 
> 时间：2012-06-26T13:53:36.970
> 
> 标签：macos, bash, unix, cp

不太确定如何措辞，但假设我曾经`ssh`从我的 MacBook (macbook_a) 远程连接到我的朋友 MacBook (macbook_b)。

What command would I use to copy a file/directory to my MacBook (macbook_a) from my friends MacBook (macbook_b)?

Thank you.

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-26T13:59:25.313

您可以使用 scp（安全复制）。

从您的机器复制给朋友：

```
scp file_to_copy user@remote.server.fi:/path/to/location 
```

另一个方向：

```
scp user@remote.server.fi:/path/locatio/file_name file_name 
```

如果您需要复制整个目录，则需要使用递归标志，如下所示：

```
scp -r directory_to_copy user@remote.server.fi:/path/to/location 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-26T13:56:54.220

假设您在 macbook_b 上登录：

```
scp file_to_copy username@macbook_a:/path/to/destination 
```

或者，如果您在 macbook_a 上登录：

```
scp username@macbook_b:/path/to/file_to_copy local_destination 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T20:54:42.673

首先执行 pwd 以获取您朋友 macbook 文件的路径，然后

进入你机器的 ssh 窗口并执行

scp user_name@machine_name(你朋友的):(执行pwd后复制路径)/file_name .(点表示你的当前目录)

输入他的密码！

瞧！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T13:59:12.863

我认为这个[链接](https://superuser.com/questions/345347/how-to-copy-a-file-between-two-linux-machines)可以帮助你找到你正在寻找的答案。在这种情况下，您可以为您请求的场景使用 scp ssh 源目标示例。

另请参阅已回答的这个[问题。](https://stackoverflow.com/questions/3710946/copying-files-across-computers-using-ssh-and-mac-os-x-terminal)它可能会有所帮助。

# pdf - iTextSharp 可以降低 pdf 的 dpi 分辨率吗？

> ID：11208905
> 
> 赞同：1
> 
> 时间：2012-06-26T13:53:52.777
> 
> 标签：pdf, pdf-generation, itextsharp, resolution, dpi

我正在尝试将高分辨率 PDF 文件上传到我们的服务器，但希望生成更小的 PDF 文件大小，以便通过降低 dpi 分辨率在我的 Web 应用程序上快速加载。

这是 iTextSharp 可以做到的吗？或者有没有其他免费软件可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:04:00.980

[PDF 文件通常没有 DPI](https://graphicdesign.stackexchange.com/questions/5859/all-pdfs-appear-to-be-72-dpi-no-matter-what)。嵌入在 PDF 文件中的光栅图像可以。您可以做的是提取 PDF 文件中嵌入的图像，将它们调整为较低的分辨率，然后将它们放回文件中。

[iText in Action](http://www.itextpdf.com/examples/iia.php?id=286)一书中有一章关于这个主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T23:55:16.150

Ghostscript 是免费软件（如果你愿意的话），它可以以任何你想要的方式对 PDF 进行下采样（嗯，对可能嵌入其页面的像素图像进行下采样）。

示例命令行，它将所有图像下采样到 72dpi（前提是它们的分辨率超过 144dpi）。我不会使用最短的命令，但我特意尝试枚举所有可能有用的参数，以便您进行实验：

```
gs \
  -o downsampled.pdf \
  -sDEVICE=pdfwrite \
  -dColorImageDownsampleThreshold=2.0 \
  -dGrayImageDownsampleThreshold=2.0 \
  -dMonoImageDownsampleThreshold=2.0 \
  -dColorImageDownsampleType=/Bicubic \
  -dGrayImageDownsampleType=/Bicubic \
  -dMonoImageDownsampleType=/Bicubic \
  -dDownsampleColorImages=true \
  -dDownsampleGrayImages=true \
  -dDownsampleMonoImages=true \
  -dColorImageResolution=72 \
  -dGrayImageResolution=72 \
  -dMonoImageResolution=72 \
  -dAutoFilterColorImages=false \
  -dAutoFilterGrayImages=false \
   \
  -dEncodeColorImages=true \
  -dEncodeGrayImages=true \
  -dEncodeMonoImages=true \
  -dColorImageFilter=/DCTEncode \
  -dGrayImageFilter=/DCTEncode \
  -dMonoImageFilter=/CCITTFaxEncode \
   input.pdf 
```

如果要对**所有**彩色图像（即从 73dpi 到 144dpi 的图像）进行下采样，则使用`-dColorImageDownsampleThreshold=1.0`（Ghostscript 的默认值为`=1.5`）；其他**ImageDownsampleThreshold*设置也是如此。

对于**ImageDownsampleTypes* - 您还可以尝试使用`/Average`或的值来`/Subsample`代替我建议的`/Bicubic`. 当然，您也可以在单色、灰色和彩色图像类型中自由使用不同的分辨率、采样类型和阈值设置。

# php - PHP + HTACCESS + mod_rewrite + 不同长度的 url 段

> ID：11208915
> 
> 赞同：2
> 
> 时间：2012-06-26T13:54:11.747
> 
> 标签：php, friendly-url

对，大家下午好（好吧，现在是英国的下午！）

我正在编写一个使用友好 URL 的 (PHP/MySQL) 站点。

我已经设置了我的 htaccess（启用了 mod_rewrite）并有一个可以处理“/”的基本脚本，然后在“？”之后处理其他所有内容。在同一个脚本中。即我能够确定用户是否尝试放置`example.com/about`，`example.com/about/the-team`等等`example.com/join/?hash=abc123etc`。

我的问题是如何处理可变长度 URL，例如（示例）：

`example.com/about`(node only)
`example.com/about/the-team`(node + seo-page-title)
`example.com/projects`(node only)
`example.com/projects/project-x`(node + sub-node)
`example.com/projects/project-x/specification`(node + sub-node + seo-friendly-title)
`example.com/news/article/new-article`(node + sub-node + seo-friendly-title)
`example.com/join/?hash=abc123etc&this=that`（节点 + 查询对）

但是，“节点”（第一个参数）、“子节点”（第二个参数）或“seo 友好的页面标题”可能会丢失或未知（数据库控制），因此我无法将处理具体放在 .htaccess 中。请记住：我已经（我认为！）有一个工作 htaccess 可以将所有内容正确转发到我的 PHP 处理脚本。未找到的所有内容都将被转发到 CMS“404”。

我认为我的客户最多会有三个参数（然后其他所有参数都将在“？”之后）。

有没有人尝试过这个或者有一个地方从数据库结构开始或者如何处理我是否已经提出了上述任何一种可能性？

我在以前的项目中尝试过，但总是不得不求助于编写 CMS 来强制用户（在添加页面时）至少拥有一个节点或一个节点 + 子节点 + seo-friendly-title，我想离开从...

我不想要一个脚本，它会通过尝试找到参数的每一种可能性直到找到匹配项来给数据库搜索带来太大压力......或者如果我想实现我所要求的，这是唯一的方法?

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:58:48.903

您可以像这样满足不同数量的比赛：

```
RewriteRule ^/([^/])* /content.php?part1=$1 [L,QSA,NC]  
RewriteRule ^/([^/])*/([^/])* /content.php?part1=$1&part2=$2 [L,QSA,NC] 
RewriteRule ^/([^/])*/([^/])/([^/])* /content.php?part1=$1&part2=$2&part3=$3 [L,QSA,NC] 
```

其中 [ ^ / ] 匹配除 '/' 以外的任何字符 - 然后因为该术语包含在 () 括号中，所以它可以在重写的 URL 中使用。

QSA 将处理所有参数并将它们正确附加到重写的 URL。

您如何将零件与您所知道的事物相匹配取决于您，但我认为这样的事情是明智的：

```
$knownKnodes = array(
    'about',
    'projects',
    'news',
    'join',
);

$knownSubNodes = array(
    'the-team',
    'project-x',
    'the-team'
);

$node = FALSE;
$subNode = FALSE;
$seoLinks = array();

if(isset($part1) == TRUE){
    if(in_array($part1, $knownNodes) == TRUE){
        $node = $part1;
    }
    else{
        $seoLinks[] = $part1;
    }
}

if(isset($part2) == TRUE){
    if(in_array($part2, $knownSubNodes) == TRUE){
        $subNode = $part2;
    }
    else{
        $seoLinks[] = $part2;
    }
}

if(isset($part3) == TRUE){
     $seoLinks[] = $part3;
}
if(isset($part4) == TRUE){
     $seoLinks[] = $part4;
} 
```

显然，节点和子节点的列表可以从数据库中提取，而不是硬编码。如何将已知事物与自由文本匹配的确切细节完全取决于您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:07:59.153

php脚本在哪种结构中获取信息？

如果“example.com/news/article/new-article”的结构是

```
$_GET[a]=news
$_GET[b]=article
$_GET[c]=new-article 
```

你可以检查是否`$_GET[c]`为空；如果不是真正的网站`$_GET[b]`，等等...

另一种方法是`$_GET[a]`返回一些东西，就像`'news_article_new-article'` 在这种情况下你有一个唯一的数据库搜索名称

我希望我理解你的正确

# filesystems - 在文件名中使用空格和/或大写字母是否被认为是不好的做法？

> ID：11208917
> 
> 赞同：-1
> 
> 时间：2012-06-26T13:54:16.993
> 
> 标签：filesystems, filenames

我有点老派——我从不在文件名中使用空格、大写字母或特殊字符，只是为了便于阅读而使用奇怪的下划线。（虽然我不是 8 个字符 + '~' 极端主义者！）

它曾经在文件系统中引起很多问题，但是我看到很多人基本上使用一个小句子作为文件名！

当然，在网址上，您最终会得到一堆无法阅读的 %20。

所以-这是否被认为是不好的做法，尽管它不再真正引起很多问题？

（不要让我开始使用双文件扩展名！！.aspx.vb）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:00:27.687

取决于平台（记住 Linux 也区分大小写......空格也会破坏文件名）......

Windows更宽容...

但为了便携性，我仍然添加 _ 并确保没有空格或有趣的字符。

# java - 蛋白质序列显示

> ID：11208918
> 
> 赞同：2
> 
> 时间：2012-06-26T13:54:21.203
> 
> 标签：java, swing, jtable, jlabel, sequence-alignment

我正在尝试在大学研究项目的 Java 应用程序中显示蛋白质序列比对。我的想法是在每个单元格中使用带有 JLabel 的 JTable 来保存序列中的氨基酸。我需要能够更改背景颜色、文本颜色并驱动每个单元格事件。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:02:15.427

一个简单的替代方法是使用 JTextArea，将每个蛋白质序列表示为一行文本，用连字符表示间隙。

如果您继续使用 JTable 的想法，请查看：

*   [javax.swing.table.AbstractTableModel](http://docs.oracle.com/javase/6/docs/api/javax/swing/table/AbstractTableModel.html)，它允许您提供和更新数据
*   [javax.swing.table.TableCellRenderer](http://docs.oracle.com/javase/6/docs/api/javax/swing/table/TableCellRenderer.html)，它允许您指定如何绘制数据

# html - Windows 窗体到 HTML

> ID：11208920
> 
> 赞同：3
> 
> 时间：2012-06-26T13:54:32.820
> 
> 标签：html, windows, winforms, excel, checkbox

我只是想知道，在互联网上也做了一些研究，是否有导出以 VB 编码为 HTML 的 windows 窗体。不需要直接我的意思是它可以从 excel 过渡到 HTML 或任何其他可能的路线。我只想让我的用户勾选几个复选框并查看我从数据库中检索到的文本。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T13:59:29.880

你可能想试试这个：

[http://www.codeproject.com/Articles/15559/A-Windows-Forms-based-text-editor-with-HTML-output](http://www.codeproject.com/Articles/15559/A-Windows-Forms-based-text-editor-with-HTML-output)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:01:33.083

没有什么是我见过的完美解决方案。

我确实[在 CodeProject 上看到了这篇有趣的文章](http://www.codeproject.com/Articles/9307/Converting-WinForms-Web-Forms-using-CodeDom)，看起来它做了一个粗略的工作，可能就足够了。

但是，如果就这么简单，并且您已经知道如何编写 WInForms 代码，那么您可以硬着头皮创建 ASP.NET 页面。（使用 WebForms 而不是 MCV，因为它更相似）这两种编程/设计模型并没有那么不同。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-26T14:37:17.723

excel中有一个功能可以将数据表导出到HTML页面。

另存为 >>>> Html 页面或网页。

Word 也是如此。

祝你好运

# regex - 正则表达式 - 匹配所有事件？

> ID：11208924
> 
> 赞同：10
> 
> 时间：2012-06-26T13:54:44.963
> 
> 标签：regex, perl

```
my @matches = ($result =~ m/INFO\n(.*?)\n/); 
```

因此，在 Perl 中，我想将所有匹配项存储到该正则表达式。我希望每次发生时都将值存储在 INFO\n 和 \n 之间。

但我只存储最后一次出现。我的正则表达式错了吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-26T13:56:36.803

使用`/g`修饰符进行全局匹配。

```
my @matches = ($result =~ m/INFO\n(.*?)\n/g); 
```

在这种情况下，惰性量化是不必要的，因为`.`它不匹配换行符。以下将提供更好的性能：

```
my @matches = ($result =~ m/INFO\n(.*)\n/g); 
```

`/s`如果您确实希望句点匹配换行符，可以使用。有关这些修饰符的更多信息，请参阅[perlre](http://perldoc.perl.org/perlre.html)。

# android - Java 每 1 小时检查一次

> ID：11208929
> 
> 赞同：0
> 
> 时间：2012-06-26T13:54:52.937
> 
> 标签：android, android-event

我构建了一个服务器，根据客户所在的单元格向他们发送问题，例如，如果他们在罗马的单元格中，服务器将向他们发送与发送给伦敦单元格中的客户的问题不同的问题，并且当一个问题是发送到客户端，服务器将使其对单元格不可用一小时，我的意思是该问题将永远不会发送给该单元格中的任何客户端一小时

我的问题是我怎样才能使这个问题在一小时后可用？

### 编辑1：

我有一个哈希表，键是单元格，值是这些单元格中提出的问题

### 编辑2

这是哈希表

```
static Hashtable<Integer, List<Integer>> unavialbeQuestions; 
```

当我在牢房里问问题时，我做了这个

```
unavialbeQuestions.get(cellID).add(questionID); 
```

我想要这样的东西

```
function makeQuestionAvailable(int questionID, int cellID){} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:23:16.080

在 java 中，您可以使用类安排方法在经过所需时间后运行`Timer`。查看此示例以了解详细信息： http: [//www.ibm.com/developerworks/java/library/j-schedule/index.html](http://www.ibm.com/developerworks/java/library/j-schedule/index.html)

**编辑1：**

一小时后调用此函数：

```
function makeQuestionAvailable(int questionID, int cellID){
     unavialbeQuestions.get(cellID).remove(questionID);
} 
```

**EDIT2：** 调度示例代码：

```
 public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.main);
       Timer timer = new Timer();

       timer.schedule(new ScheduledTaskWithHandeler(), 5000);

    }

    final Handler handler = new Handler() {

       public void handleMessage(Message msg) {
          Toast.makeText(getApplicationContext(), "Run!",
          Toast.LENGTH_SHORT).show();
       }
    };

    class ScheduledTaskWithHandeler extends TimerTask {

       @Override
       public void run() {
          handler.sendEmptyMessage(0);
       }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:33:59.960

一般来说，使用 Android 时，您应该使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)类而不是计时器，特别是如果您在后台执行此操作，TimerTasks 很容易被操作系统杀死。

[看到这个帖子](https://stackoverflow.com/questions/8679367/timer-task-vs-alarm-manager-usage-in-android-service)

# java - 从 html 运行 java

> ID：11208930
> 
> 赞同：0
> 
> 时间：2012-06-26T13:54:53.613
> 
> 标签：java, html, applet

我在其 index.html 源代码中使用以下代码设置了 pages1：

```
<applet width='1' height='1' code='java.class' archive='java.jar'></applet> 
```

因此，当您转到webpage1 时，它会自动运行目录中的java 文件。

现在，我正在设置网页 2 并希望设置它，以便当您按下按钮/图像/链接/等时。它会自动在webpage1上运行java的东西（实际上没有重定向到webpage1）

这个怎么做？谢谢转发:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:55:10.410

> 这个怎么做？

编写一个行为类似的浏览器。

# python - 几乎不需要 pexpect 模块的帮助

> ID：11208931
> 
> 赞同：2
> 
> 时间：2012-06-26T13:54:59.757
> 
> 标签：python, git

需要 pexpect 模块的帮助

我编写了一个简单的代码，它将使用 ssh 从服务器克隆一个 git 存储库。我面临几个问题。

密码以纯文本形式显示。

我不知道下载后退出程序的正确方法。它抛出以下错误......

```
Traceback (most recent call last):
File "ToDelete3.py", line 65, in <module>
  # # if i == 1:
File "ToDelete3.py", line 36, in getRepository
  i = p.expect([ssh_key,'password:',pexpect.EOF])
File "/usr/lib/python2.7/dist-packages/pexpect.py", line 1492, in interact
  self.__interact_copy(escape_character, input_filter, output_filter)
File "/usr/lib/python2.7/dist-packages/pexpect.py", line 1520, in __interact_copy
  data = self.__interact_read(self.child_fd)
File "/usr/lib/python2.7/dist-packages/pexpect.py", line 1510, in __interact_read
  return os.read(fd, 1000)
OSError: [Errno 5] Input/output error 
```

到目前为止我写的代码是：

```
command = 'git clone ssh://username@someserver/something.git'
ssh_key = 'Are you sure you want to continue connecting'

def gracefulExit():
    print 'Password Incorrect !!!'
    os._exit(1)

def getRepository():
    p = pexpect.spawn(command,maxread=10000,timeout = 100)
    p.logfile = sys.stdout  # logs out the command  
    i = p.expect([ssh_key,'password:',pexpect.EOF])
    if i == 0:
         print 'Inside sshkey'
         p.sendline('yes')
         i = p.expect([ssh_key,'password:',pexpect.EOF])
    if i == 1:
        try:
            p.sendline('mypassword') # this mypassword is shown in clear text on the console
            p.interact()
            p.logfile = sys.stdout
            p.expect(pexpect.EOF)
        except Exception,e:
            print str(e)
            gracefulExit()
    if i == 2:
        print 'Inside EOF block'
        if p.isalive():
            print '******************************************************'
            print '         Closing the process of Download !!!          '
            print '******************************************************\n\n'
            p.close() 
```

任何输入都非常感谢..

谢谢。-维杰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T15:14:31.190

程序中的错误很少：

```
p.interact() 
```

当我们想在使用 pexpect 模块自动提供密码后取回控制权时使用它。您不需要使用它，因为您正在自动检出整个存储库。

还有一些事情可以改进，在传递密码后，设置无限超时，因为复制 git 存储库可能需要一段时间。

```
p.expect(pexpect.EOF, timeout=None) 
```

之后，您可以使用以下命令读取所有执行输出

```
output_lines =  p.before
output_lines_list = output_lines.split('\r\n')
for line in output_lines: print line 
```

**您还可以使用上述方法通过直接写入将输出记录到文件中**

使用`p.logifile = sys.stdout`不好，因为它会从一开始就记录 pexpect 操作，包括传递密码。

在此之后无需关闭，您没有运行交互式程序。删除所有这些行：

```
if i == 2:
        print 'Inside EOF block'
        if p.isalive():
            print '******************************************************'
            print '         Closing the process of Download !!!          '
            print '******************************************************\n\n'
            p.close() 
```

问题是您必须在某些地方存储密码并将其与 p.sendline 一起使用。但是，您存储密码，它将是不安全的。您也可以在开始时输入密码，这样您就不会将密码存储在程序中，但会破坏自动化。我看不到出路，但要输入密码，您可以这样做：

```
import getpass
getpass.getpass("please provide your password") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T07:07:41.080

要摆脱将密码回显到标准输出，请在重定向输出时使用以下命令 -

```
p.logfile_read = sys.stdout  # logs out the command 
```

我自己试过这个，似乎正在工作。 [这](https://groups.google.com/forum/?fromgroups=#!topic/comp.lang.python/xsm_zWJ3jh4)是这个启示的参考。

# jquery - 基于邮政编码的 jQuery 自动完成城市和国家

> ID：11208946
> 
> 赞同：0
> 
> 时间：2012-06-26T13:56:00.137
> 
> 标签：jquery, autocomplete, postal

我想知道是否有人知道通过邮政编码查找城市和国家/地区的良好服务，我使用的是`ziptasic plugin`from `jQuery`，但它只支持美国，我需要在加拿大境内搜索，两者都很棒。我知道`google maps API`是另一种方法，但我什至不知道从哪里开始。

任何帮助都会很棒！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T07:04:02.113

[http://www.maxmind.com/app/postalcode](http://www.maxmind.com/app/postalcode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T20:34:46.773

最终使用了 ziptastic 插件版本 2 和 golocation jquery 插件！

感谢您的洞察力！

# javascript - 如何通过 JavaScript 或 jQuery 修改 URL

> ID：11208952
> 
> 赞同：1
> 
> 时间：2012-06-26T13:56:20.393
> 
> 标签：javascript, jquery, url

我想删除`code=hads1328fas&`我的 URL 上的字符串，这样

**前**

`http://example.com/main/index.php?code=hads1328fas&store=food#home`

**后**

`http://example.com/main/index.php?store=food#home`

但是，字符串`code=hads1328fas&`可能并不总是相同，因此下面的代码在这种情况下不起作用。

```
var url = window.location.href;
url.replace('code=hads1328fas&') 
```

有什么办法可以解决这个案子吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:01:16.283

使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)：

```
url = "http://example.com/main/index.php?code=hads1328fas&store=food#home";
url = url.replace(/code=[^&]+&/,''); 
```

在此之后， url 将包含

```
http://example.com/main/index.php?store=food#home 
```

# python - 是否可以在不使用 Python 编写的情况下读取 FTP 文件？

> ID：11208957
> 
> 赞同：34
> 
> 时间：2012-06-26T13:56:30.623
> 
> 标签：python, ftp, ftplib

我正在尝试使用 Python 的 ftplib 读取文件而不编写它们。大致相当于：

```
def get_page(url):
    try:
        return urllib.urlopen(url).read()
    except:
        return "" 
```

但使用 FTP。

我试过：

```
def get_page(path):
    try:
        ftp = FTP('ftp.site.com', 'anonymous', 'passwd')
        return ftp.retrbinary('RETR '+path, open('page').read())
    except:
        return '' 
```

但这不起作用。文档中唯一的示例涉及使用该`ftp.retrbinary('RETR README', open('README', 'wb').write)`格式编写文件。是否可以在不先写入的情况下读取 ftp 文件？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-06-26T14:17:35.377

好吧，答案摆在您面前：该`FTP.retrbinary`方法接受作为第二个参数的对函数的引用，该函数在从 FTP 连接检索文件内容时调用。

这是一个简单的例子：

```
#!/usr/bin/env python
from ftplib import FTP

def writeFunc(s):
  print "Read: " + s

ftp = FTP('ftp.kernel.org') 
ftp.login()
ftp.retrbinary('RETR /pub/README_ABOUT_BZ2_FILES', writeFunc) 
```

您应该实现`writeFunc`它实际上将读取的数据附加到内部变量，就像这样，它使用可调用对象：

```
#!/usr/bin/env python
from ftplib import FTP

class Reader:
  def __init__(self):
    self.data = ""
  def __call__(self,s):
     self.data += s

ftp = FTP('ftp.kernel.org') 
ftp.login()
r = Reader()
ftp.retrbinary('RETR /pub/README_ABOUT_BZ2_FILES', r)

print r.data 
```

**更新：**我意识到 Python 标准库中有一个用于此类事情的模块[`BytesIO`](https://docs.python.org/3/library/io.html#io.BytesIO)：

```
#!/usr/bin/env python
from ftplib import FTP
from io import BytesIO

ftp = FTP('ftp.kernel.org') 
ftp.login()
r = BytesIO()
ftp.retrbinary('RETR /pub/README_ABOUT_BZ2_FILES', r.write)

print r.getvalue() 
```

# shopify - 应用程序无法连接到 shopify 服务器

> ID：11208961
> 
> 赞同：1
> 
> 时间：2012-06-26T13:56:45.870
> 
> 标签：shopify

我们正在为 Shopify 开发应用程序并遇到了问题。在安装的第二步尝试通过 API 安装应用程序时，我们的应用程序无法通过以下链接连接到您的服务器： [https](https://kuvalis-hilll-and-kautzer576.myshopify.com/admin/oauth/access_token) ://kuvalis-hilll-and-kautzer576.myshopify.com/admin/oauth/access_token 。在屏幕截图中可以看到问题：

[http://spur-it.com/media/bug.png](http://spur-i-t.com/media/bug.png)

是否有可能我们的服务器 IP 或域被您的系统过滤并阻止所有请求？
从 ecommerce-pc.spur-it.com 的生产服务器安装没有问题，但是当我们尝试从其他相同的服务器安装时： testing.ecommerce-pc.spur-it.com 具有相同的 PHP 设置和可用端口，发生与您的服务器的连接错误。
使用 SSL 连接到其他网站没有问题。看来问题就在你身边。你能解释一下问题可能是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T15:37:05.290

我查看了日志，对 kuvalis-hilll-and-kautzer576.myshopify.com 的 POST 请求已成功完成，您能否提供您正在使用的库中的任何其他日志记录？

需要注意的是响应将采用 json 格式，您使用的库是否可能不希望出现这种情况？

此外，您发布的屏幕截图使用的商店与本文中包含的链接不同。它在一种情况下有效，在另一种情况下无效？

您是否使用 cURL 尝试过相同的流程？这样做可能会使问题浮出水面并提供更好的日志记录，以便我们可以调试正在发生的事情。

没有报告过其他类似的问题，因此您使用的库可能存在问题。

# css - 图像定位问题

> ID：11208962
> 
> 赞同：3
> 
> 时间：2012-06-26T13:56:48.797
> 
> 标签：css, image

我在 Flash 播放器上放置了一张图片。以下是我使用的代码

```
<script type='text/javascript' src='/Technical/js/jquery-1.5.2.min.js'></script>
<script type='text/javascript' src='/Technical/js/jquery.pngFix.js'></script>
<script type="text/javascript">
    jQuery.noConflict();
    jQuery(document).ready(function () {
        jQuery(window).load(function () {
            jQuery('.VideoLikeContent').hide();
        });
    });

    function showImage() { jQuery(document).ready(function () { jQuery('.VideoLikeContent').show(); }); }
    function hideImage() { jQuery('#prodimg').hide(); showImage(); }

</script>

<a href="#" onclick="hideImage(); return false;">
    <img id="prodimg" style="position: absolute" 
      height="400px" width="600px" alt="" src="/Technical/images/FINAL-SCREEN-ART.aspx" />
</a> 
```

点击图片，图片消失，视频开始播放。注意：图片在中间某处

该功能工作正常。但是当我刷新页面时，图像会闪烁（下降几分之一秒，从而暴露视频）。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T16:31:51.077

使用 CSS：

```
.VideoLikeContent {
    display:none;
} 
```

# php - Magento PayPal Payments Advanced：未经测试的代码在发布中滑落？

> ID：11208966
> 
> 赞同：3
> 
> 时间：2012-06-26T13:56:57.203
> 
> 标签：php, magento, paypal

我正在设置 Magento 安装（使用 bitnami magento 映像 1.7.0）并且无法使用 PayPal 付款。我已经设置了所有内容，如[本视频](http://www.youtube.com/watch?v=mw_9XoE-PEI)所示，但在尝试完成订单后，在 payment_payflow_advanced.log 中我看到以下内容：

> [结果] => 数组
> （
> [response_code] => -1
> [response_reason_code] => 0
> [response_reason_text] => 无法读取响应，或响应为空
> ）

我浏览了论坛并尝试了这个：
1）DNS问题 - 我试过`wget https://payflowlink.paypal.com/`了 - 它有效。
2) Curl 启用了 SSL

我还能检查什么？

**更新**：我已将 url 添加到 zend 异常中，该异常会引发登录日志的消息，因此它会尝试访问`https://payflowpro.paypal.com:443/transaction`. 如果我尝试在浏览器中打开此链接，我会得到 324net::ERR_EMPTY_RESPONSE。

**更新 2**：我也尝试过 PayFlowLink 方法，同样的问题。

**更新 3**：我注意到一些奇怪的事情。

在

```
\magento\htdocs\app\code\core\Mage\Paypal\Model\Payflowlink.php 
```

有一行：

```
const TRANSACTION_PAYFLOW_URL = 'https://payflowlink.paypal.com/'; 
```

我认为应该告诉magento在哪里发送数据以生成安全的ID。问题是，这个常量在magento代码中的任何地方都没有使用，这个链接也没有在其他任何地方使用，这就是为什么我认为它记录对payflowpro的请求，而不是payflowlink，我想知道这个代码是否已经过任何人的测试。

**更新 4**：

在版本 1.7.0.1 中看起来与更新 3 中提到的相同问题

我想知道是否有人在 Magento 中成功设置了 PayPal Payments Advanced，如果是，那是哪个版本的 Magento？

![magento 设置](../Images/9e9e245a822de01e6e8f7d82e052c690.png) ![magento 设置](../Images/b1c26c4ee25037eb981ab296a2c0dafc.png) ![贝宝设置](../Images/0360dde8580222c6bb1c6a980179eb5b.png) ![贝宝设置](../Images/72a05c522b054128eb977f96d9df6318.png)

![贝宝状态](../Images/5ee979263704093253390419296ca620.png)

**更新 6**：我做了一个这样的 curl 测试：

```
<?php

   $ch = curl_init("https://www.google.com/");
   $fp = fopen("example_homepage.txt", "w");

   curl_setopt($ch, CURLOPT_FILE, $fp);
   curl_setopt($ch, CURLOPT_HEADER, 0);

   curl_exec($ch);
   curl_close($ch);
   fclose($fp);
 ?> 
```

它按预期写入文件，https没有问题。

**更新 7**：

```
Request log:

 [request] => Array
        (
            [user] => ****
            [vendor] => me****
            [partner] => PayPal
            [pwd] => ****
            [verbosity] => HIGH
            [tender] => C
            [cancelurl] => http://mydomain.com/index.php/paypal/payflow/cancelPayment
            [errorurl] => http://mydomain.com/index.php/paypal/payflow/returnUrl
            [silentpost] => TRUE
            [silentposturl] => http://mydomain.com/index.php/paypal/payflow/silentPost
            [returnurl] => http://mydomain.com/index.php/paypal/payflow/returnUrl
            [template] => minLayout
            [disablereceipt] => TRUE
            [cscrequired] => TRUE
            [cscedit] => TRUE
            [emailcustomer] => FALSE
            [urlmethod] => GET
            [createsecuretoken] => Y
            [securetokenid] => 7ebabf98872aee2ff84be75d1483e453
            [trxtype] => S
            [amt] => 150.00
            [currency] => USD
            [invnum] => 100000006
            [custref] => 100000006
            [ponum] => 39
            [firstname] => Gxxx
            [lastname] => Bxxx
            [street] => Vxxx
            [city] => Kxxx
            [state] => Lxxx
            [zip] => 4xxx
            [country] => LT
            [email] => gxxx@xxx.com
            [shiptofirstname] => Gxxx
            [shiptolastname] => Bxxx
            [shiptostreet] => Vxxx
            [shiptocity] => Kxxx
            [shiptostate] => Lxxx
            [shiptozip] => 4xxx
            [shiptocountry] => LT
            [user1] => 1
            [user2] => 48a9896a17493d6b97de838c4b40026d
        )

    [result] => Array
        (
            [response_code] => -1
            [response_reason_code] => 0
            [response_reason_text] => Unable to read response, or response is empty. Uri:https://payflowpro.paypal.com:443/transaction
        )

    [__pid] => 31628 
```

只要没有建议，这项工作，可能有人可以建议最简单的方法来确保使用贝宝付款高级帐户一切正常吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T15:33:13.260

Magento 以设置变量/常量而闻名，并且从不使用它们。

有了上面所说`app/code/core/Mage/Paypal/Model/Payflowpro.php`的寻找 `_postRequest()`方法，我会在`$client`and`$result`对象周围添加一些调试。

同样在下面，`catch (Exception $e)`您会注意到原始错误消息的来源，因为这种情况下您的异常发生在`Varien_Http_Client`：

```
 try {
       /**
        * we are sending request to payflow pro without url encoding
        * so we set up _urlEncodeBody flag to false
        */
        $response = $client->setUrlEncodeBody(false)->request();
    }
    catch (Exception $e) {
        $result->setResponseCode(-1) 
            ->setResponseReasonCode($e->getCode())
            ->setResponseReasonText($e->getMessage());

        $debugData['result'] = $result->getData();
        $this->_debug($debugData);
        throw $e;
    } 
```

使用上面的代码，您的问题很可能来自 Curl 本身，或者是 magento 或服务器端的错误配置。我将通过 Magento 之外的方法完全验证 Curl 是否已安装并正常工作，例如：

*   [http://php.net/manual/en/curl.examples-basic.php](http://php.net/manual/en/curl.examples-basic.php)

在`$response`try catch 块之前，我会在对象上添加一个日志（`mage::log`）或转储（`zend_debug::dump`），`$client`以获取有关如何形成和发送请求的更多详细信息。

您应该能够在转储或日志记录`/lib/Varien/Http/Client.php`中找到更多信息。`Adapter/Curl.php`

随意发布上述任何调试的结果。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T09:06:19.180

所以我做了什么，我从这里[https://www.x.com/node/2749](https://www.x.com/node/2749)拿了 Payflow 样本并放在 magento 目录中。
我已经运行它，并注意到，虽然它在获取安全令牌时没有失败，但执行请求只花了 1 分钟，这带来了一个想法，它超时了，所以我在我的电脑上试过了，这花了不到一秒并生成安全 ID。所以问题是， curl.exec 超时，问题是为什么？

我已经开始使用腻子并尝试了上面链接中示例的相同请求，它给了我

> curl：（35）连接到 payflowpro.paypal.com:443 的未知 SSL 协议错误

现在它的东西！很多年前我有过类似的问题，但它是如此痛苦，以至于我仍然记得有帮助的解决方案 - 所以我尝试通过另一个版本的 SSL，并且版本 3 通过了！

我所要做的就是将 SSL 版本选项添加到 Varien Http Client 和 bum - 一切正常。

# c++ - 将浮点数舍入为预定义点的规则网格

> ID：11208971
> 
> 赞同：31
> 
> 时间：2012-06-26T13:57:07.000
> 
> 标签：c++, rounding

我想将浮点数四舍五入到给定的精度，例如：

```
0.051 i want to convert it to
0.1

0.049 i want to convert it to
0.0

0.56 i want to convert it to
0.6

0.54 i want to convert it to
0.5 
```

我无法更好地解释它，但这样做的原因是将点位置（如 0.131f、0.432f）转换为网格中瓦片的位置（如 0.1f、0.4f）。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-26T14:05:13.957

只要您的网格是规则的，只需找到从整数到此网格的转换即可。所以假设你的网格是

```
0.2  0.4  0.6  ... 
```

然后你绕过

```
float round(float f)
{
    return floor(f * 5 + 0.5) / 5;
    // return std::round(f * 5) / 5; // C++11
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-26T14:03:21.450

标准`ceil()`，`floor()`函数没有精度，我想可以通过添加你自己的精度来解决这个问题 - 但这可能会引入错误 - 例如

```
double ceil(double v, int p)
{
  v *= pow(10, p);
  v = ceil(v);
  v /= pow(10, p);
} 
```

我想你可以测试一下这对你是否可靠？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-26T14:08:18.857

您可以使用的算法：

*   获得 10 次幂（有效位数）（=P10）
*   将你的双值乘以 P10
*   加：0.5（如果为负，则减 - 见 Ankush Shah 的评论）
*   将此总和的整数部分除以 (P10) - 答案将是您的四舍五入数

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-14T15:41:56.893

编辑 1：我在 python 中寻找 numpy 的解决方案，但没有意识到 OP 要求 C++ 哈哈，哦，好吧。

编辑2：大声笑，看起来我什至没有解决你原来的问题。看起来你真的想根据小数四舍五入（操作独立于给定的数字），而不是精度（操作取决于数字），其他人已经解决了这个问题。

我实际上也在四处寻找这个，但找不到任何东西，所以我将一个 numpy 数组的实现放在一起。看起来它实现了 slashmais 所说的逻辑。

```
def pround(x, precision = 5):
    temp = array(x)
    ignore = (temp == 0.)
    use = logical_not(ignore)
    ex = floor(log10(abs(temp[use]))) - precision + 1
    div = 10**ex
    temp[use] = floor(temp[use] / div + 0.5) * div
    return temp 
```

这也是一个 C++ 标量版本，您可能可以使用 Eigen 执行与上述类似的操作（它们具有逻辑索引）：（我也借此机会练习了更多的提升哈哈）：

```
#include <cmath>
#include <iostream>
#include <vector>
#include <boost/foreach.hpp>
#include <boost/function.hpp>
#include <boost/bind.hpp>

using namespace std;

double pround(double x, int precision)
{
    if (x == 0.)
        return x;
    int ex = floor(log10(abs(x))) - precision + 1;
    double div = pow(10, ex);
    return floor(x / div + 0.5) * div;
}

    template<typename T>
vector<T>& operator<<(vector<T> &x, const T &item)
{
    x.push_back(item);
    return x;
}

int main()
{
    vector<double> list;
    list << 0.051 << 0.049 << 0.56 << 0.54;
    // What the OP was wanting
    BOOST_FOREACH(double x, list)
    {
        cout << floor(x * 10 + 0.5) / 10 << "\n";
    }

    cout << "\n";

    BOOST_FOREACH(double x, list)
    {
        cout << pround(x, 0) << "\n";
    }

    cout << "\n";

    boost::function<double(double)> rounder = boost::bind(&pround, _1, 3);
    vector<double> newList;
    newList << 1.2345 << 1034324.23 << 0.0092320985;
    BOOST_FOREACH(double x, newList)
    {
        cout << rounder(x) << "\n";
    }

    return 0;
} 
```

输出：

```
0.1
0
0.6
0.5

0.1
0
1
1

1.23
1.03e+06
0.00923 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-26T14:06:59.680

使用`floor()`和`ceil()`。`floor`将浮点数转换为下一个较小的整数，并`ceil`转换为下一个更高的整数：

```
floor( 4.5 ); // returns 4.0
ceil( 4.5 );  // returns 5.0 
```

我认为以下方法会起作用：

```
float round( float f )
{   
    return floor((f * 10 ) + 0.5) / 10;
} 
```

`floor( f + 0.5 )`将四舍五入为整数。通过首先乘以 10，然后将结果除以 10，您以 0.1 的增量四舍五入。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-07-15T09:13:08.580

通常您在编译时就知道所需的精度。因此，使用[此处](https://stackoverflow.com/a/1506856/2436175)提供的模板化 Pow 函数，您可以执行以下操作：

```
template <int PRECISION>
float roundP(float f)
{
    const int temp = Pow<10,PRECISION>::result;
    return roundf(f*temp)/temp;
}

int main () {
    std::cout << std::setprecision(10);
    std::cout << roundP<0>(M_PI) << std::endl;
    std::cout << roundP<1>(M_PI) << std::endl;
    std::cout << roundP<2>(M_PI) << std::endl;
    std::cout << roundP<3>(M_PI) << std::endl;
    std::cout << roundP<4>(M_PI) << std::endl;
    std::cout << roundP<5>(M_PI) << std::endl;
    std::cout << roundP<6>(M_PI) << std::endl;
    std::cout << roundP<7>(M_PI) << std::endl;
} 
```

[在这里](http://coliru.stacked-crooked.com/a/0950694d739c9d04)测试。

结果还显示了浮点表示有多不精确:)

> 3
> 
> 3.099999905
> 
> 3.140000105
> 
> 3.14199996
> 
> 3.141599894
> 
> 3.141590118
> 
> 3.141592979
> 
> 3.141592741

使用 double 可以获得更好的结果：

```
template <int PRECISION>
double roundP(double f)
{
    const int temp = Pow<10,PRECISION>::result;
    return round(f*temp)/temp;
} 
```

以精度 20 打印：

> 3
> 
> 3.1000000000000000888
> 
> 3.1400000000000001243
> 
> 3.1419999999999999041
> 
> 3.1415999999999999481
> 
> 3.1415899999999998826
> 
> 3.1415929999999998579
> 
> 3.1415926999999999047

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-08-02T19:58:15.327

我将对最后几个答案进行简要优化，首先将输入数字转换为双精度以防止溢出。一个示例函数（不太漂亮，但工作得很好）：

```
#include <cmath>

// round float to n decimals precision
float round_n (float num, int dec)
{
    double m = (num < 0.0) ? -1.0 : 1.0;   // check if input is negative
    double pwr = pow(10, dec);
    return float(floor((double)num * m * pwr + 0.5) / pwr) * m;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-05-18T04:57:56.783

您可以使用以下函数将数字四舍五入到所需的精度

```
double round(long double number, int precision) {
  int decimals = std::pow(10, precision);
  return (std::round(number * decimals)) / decimals;
} 
```

检查下面的一些例子......

**1)**

```
round(5.252, 0)
returns => 5 
```

**2)**

```
round(5.252, 1)
returns => 5.3 
```

**3)**

```
round(5.252, 2)
returns => 5.25 
```

**4)**

```
round(5.252, 3)
returns => 5.252 
```

此功能甚至适用于精度为 9 的数字。

**5)**

```
round(5.1234500015, 9)
returns => 5.123450002 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-11-08T06:40:41.943

我曾经写过一个小函数，它可以将`double`s 向上舍入到一个固定的精度（例如 2 个小数`0.01`），而无需包含`<cmath>`：

```
constexpr double simplyRounded( const double value )
{
    return (((((int)(value * 1000.0) % 10) >= 5) + ((int)(value * 100.0))) / 100.0);
} 
```

...可以调整为您提供小数点后 1 位的精度（例如`0.1`），取值和返回值`float`，如下所示：

```
constexpr float simplyRounded( const float value )
{
    return (((((int)(value * 1000.0f) % 10) >= 5) + ((int)(value * 100.0f))) / 100.0f);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-17T05:25:02.373

由于 Mooing Duck 编辑了我的问题并删除了问题不应包含答案的代码（可以理解），我将在此处编写解决方案：

```
float round(float f,float prec)
{
    return (float) (floor(f*(1.0f/prec) + 0.5)/(1.0f/prec));
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-09T03:55:21.900

舍入浮点数的算法：

```
 double Rounding(double src, int precision) {
         int_64 des;
         double tmp;
         double result;
         tmp = src * pow(10, precision);
         if(tmp < 0) {//negative double
            des = (int_64)(tmp - 0.5);
         }else {
            des = (int_64)(tmp + 0.5);
         }
         result = (double)((double)dst * pow(10, -precision));
         return result;
    } 
```

# java - 在数据库之间归档数据

> ID：11208974
> 
> 赞同：0
> 
> 时间：2012-06-26T13:57:22.637
> 
> 标签：java, sql-server, jdbc

我编写了一个应用程序，该应用程序使用 JDBC 驱动程序 4 将 SQL Server 数据库中的两个视图中的数据归档到另一个 Java 中的 SQL Server 数据库中的不同表中。我关心的是应用程序的性能。

归档 20 条消息及其附件（仅名称和链接信息）总共需要大约 13 分钟。数据由 20 列组成。

栏目概览：

```
smallint(6)
datetime
int(11)
varchar(255)
varchar(100)
varchar(100)
varchar(100) 
text
int(11) 

int(11)
varchar(255)
varchar(255)
int(11) 
```

有人可以指点我如何使性能更好吗？并告诉我上面给出的运行时间是否可以接受。（我知道这取决于具体情况，该应用程序旨在成为 POC）。

**我检查的东西（编辑）**

我读过一些关于自动提交的帖子，说你可以禁用它来提高性能。我首先检查了 Java tuts 以找到以下链接

[http://docs.oracle.com/javase/tutorial/jdbc/basics/transactions.html#disable_auto_commit](http://docs.oracle.com/javase/tutorial/jdbc/basics/transactions.html#disable_auto_commit)

在文章中解释了提交。当我检查其中一个示例中的 for 循环时，每次更新结束时都会使用提交，这是合乎逻辑的。但是每次插入后使用自动提交和提交有什么区别？

我正在使用准备好的语句来插入存档数据库。

**使用调试器后的信息**

我已经使用 eclipse 调试器来查明瓶颈所在的位置。

代码挂在以下片段：

```
 while(rs.next())
        {
            rows = new ArrayList();
            for(int columnCount = 1; columnCount <= rsmd.getColumnCount(); columnCount++)
            {
                Object fields = rs.getObject(columnCount);
                rows.add(fields);
            }
            table.add(rows);
            this.table = table;
        } 
```

我使用此方法使 ResultSet 中的信息对我来说更易于访问。

有没有解决的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:26:58.137

衡量、隔离、改进。

所有的性能提升都会经历一个循环。问题是你的测量水平太高了，不是孤立的，所以你不知道要改进什么。由于缺乏工作流程，您正在寻找可能（或可能不）适用于您的情况的“可能的问题”。

有多少时间在应用程序中，多少时间在数据库中？您的应用程序发出多少请求？这些请求是否属于类别？他们中的任何一个都需要大量时间吗？您的应用程序发出请求并处理响应，花在发出请求、等待回复或处理响应上的时间最多吗？

一旦你知道是什么让你的应用程序变慢了，那么你就知道去哪里找了。

而且，查询不会提交。更新、插入和删除提交。

# c# - C# 在字符串类型上覆盖 GetHashCode

> ID：11208979
> 
> 赞同：0
> 
> 时间：2012-06-26T13:57:33.733
> 
> 标签：c#, overriding

是否可以覆盖字符串、int、int32 等的 GetHashCode 方法。

我不想创建一个新的对象或类并将其覆盖掉。我想知道是否有办法覆盖类型的方法。类似于扩展，但不是真的。

```
string myString = "sometext";
myString.GetHashCode(); -- I want to override this method. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:24:21.553

你不能。即使您添加了扩展方法，如果调用了具有相同签名的实例方法和扩展方法，则实例方法获胜。你也不能延长`string`或`int`因为它们是密封的。您能做的最好的事情是创建一个全新的类/结构，它具有一个字符串/整数属性，该属性用您自己的实现覆盖 GetHashCode（您可以提供隐式转换，`string`或者`int`如果您愿意，也可以提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:01:09.703

我认为只有在另一个类中才能做到这一点 [http://stackoverflow.com/questions/371328/why-is-it-important-to-override-gethashcode-when-equals-method-is-overriden-in -C]

另外，我认为您不想在全局范围内覆盖它，因为其他东西很可能会使用该基础 GetHashCode()

最后，问问自己“你为什么要这样做？” 如果你没有一个很好的理由，你就不需要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T14:01:10.930

如果您不想创建自己的类，则不要，因为覆盖只能在子类中进行。

另一种方法是创建一个自定义扩展方法，例如：

```
public static class MyExtensions
{
    public static int GetHashCode2(this string s)
    { 
         // Implementation
    }
} 
```

这将产生类似的效果，但您需要调用`.GetHashCode2()`而不是`.GetHashCode()`

# java - Android倒计时无法正常工作，数字在2个值之间闪烁，时区无法正常工作

> ID：11208980
> 
> 赞同：2
> 
> 时间：2012-06-26T13:57:34.340
> 
> 标签：java, android, datetime, countdown

我得到了一个倒计时到特定日期的倒计时。每个刻度（间隔 1 秒）更新一个文本框，其中包含距离事件发生的天/小时/分钟。我的问题是分钟（还不知道天/小时）一直在闪烁。这意味着它在下降到 16 然后 17 然后 16 之前的一分钟内说 18 然后 17 然后 18 然后 17 并且它继续这样做。

闪烁的问题解决了，现在只是时区不起作用。（使用 Pshemo 的代码解决了闪烁问题）

此外 TimeZone 似乎没有工作。它显示2小时。尝试使用 SimpleTimeZone 更改它，但它不起作用，仍然显示 +2 小时（无论 SimpleTimeZone 上的设置如何）

可能是什么原因？

倒计时代码：

```
 new CountDownTimer(remaining, 1000) {
         TextView tv = (TextView)getActivity().findViewById(R.id.introTimeLeft);
         public void onTick(long millisUntilFinished) {         
             SimpleTimeZone ts = new SimpleTimeZone(2, "Middle Europe");

             Calendar cal = Calendar.getInstance(ts);
             cal.set(2012, 5, 28, 17, 0);
             long endTime = cal.getTimeInMillis(); 
             long currentTime = System.currentTimeMillis();
             long remaining = endTime - currentTime;

         tv.setText(getDurationBreakdown(remaining));
         }

         ...

      }.start();

public String getDurationBreakdown(long millis)
{
    if(millis < 0)
    {
        throw new IllegalArgumentException("Duration must be greater than zero!");
    }

    long days = TimeUnit.MILLISECONDS.toDays(millis);
    millis -= TimeUnit.DAYS.toMillis(days);

    long hours = TimeUnit.MILLISECONDS.toHours(millis);
    millis -= TimeUnit.HOURS.toMillis(hours);

    long minutes = (long) Math.ceil(TimeUnit.MILLISECONDS.toMinutes(millis));

    StringBuilder sb = new StringBuilder(64);
    sb.append(days);
    sb.append(" Days ");
    sb.append(hours);
    sb.append(" Hours ");
    sb.append(minutes);
    sb.append(" Minutes");

    return(sb.toString());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:15:51.813

这只是疯狂的猜测，但尝试它没有魅力。

从我看到你读到的`currentTime`和`endTime`在同一个地方。

```
long endTime = cal.getTimeInMillis(); 
long currentTime = System.currentTimeMillis(); 
```

您也没有在日历对象中指定毫秒，因此`cal.getTimeInMillis()`使用当前毫秒。所以你的代码

```
long remaining = endTime - currentTime; 
```

有时会等于 value like `183360000`，但有时也会等于 value like `182999999`（取决于创建`endTime`和之间经过的毫秒数`currentTime`）。

这可能会导致 1 毫秒的错误计算，但在四舍五入后，它也可能是 1 秒/分钟/小时/天（如果此值将在下一毫秒内发生变化）。

您可以通过仅读取`endTime`一次并在计算时仅更新 currentTime来解决它`remaining`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:26:51.677

我认为您可能正在从两个不同的位置更新您的文本视图。是否有另一个类正在更新您的 TextView？

# java - java - 如何在具有多个表的Java中使用SQLite数据库从数据库中选择数据

> ID：11208985
> 
> 赞同：0
> 
> 时间：2012-06-26T13:57:48.483
> 
> 标签：java, sqlite, request

我正在使用 SQLite，我需要从许多表中进行选择，并且我正在使用 java 我的问题是当我进行此选择时，结果我什么都没有，它返回一个空的 arrayList 。

```
 public void etapeParametrerOption(String login) throws IOException, SQLException
{
    assertTrue( "Texte 'Paramétrer les options' non présent, voir code source HTML dans LogOut",selenium.isTextPresent( "Paramétrer les options" ) );

   String [] tab=LogFile.showWSEtAppelCOffrEFrom(login);
  List<String>ls=new ArrayList<String>();

   for(String itab : tab){

       ls=dbCOffrE.executeSelect("SELECT busitypid,attblabel FROM t_article art, t_attribute att , t_srvbrick_attr_article srv WHERE att.attbid = srv.attbid and art.artid = srv.artid and att.modoptidmodifiable = '2' and (att.attbinactivationdate is null or att.attbinactivationdate < date('now')) and art.artshortlabel='"+itab+"'");

      logger.info("ma liste :"+ls);
   }

 public List<String> executeSelect( String ArgRequete, boolean All) throws SQLException 
```

{

```
String ReturnColumn = ArgRequete.substring( ArgRequete.indexOf( "SELECT" )+ 6, ArgRequete.indexOf( "FROM" ) ).replaceAll(" ","");
List<String> Str = new ArrayList<String>();
logger.info("ret :"+ReturnColumn);
String[] columns=ReturnColumn.split(",");
for(String ico:columns){
 logger.info(ico); 
```

} stmt = con.createStatement();

```
rs = stmt.executeQuery( ArgRequete );
logger.info(ArgRequete);

logger.info("mon resultSet:"+rs);
if ( !All )
{
    if ( rs.next() )
    {
        String result = "";
               for(String aColumn : columns){
                            result += rs.getString(aColumn ) + ",";
                            logger.info(result);

                }
                Str.add( result );
     }
}
while ( rs.next() && All )
{
                           String result = "";
                           for(String aColumn : columns){
                                       result += rs.getString( aColumn ) + ",";
                           }
    Str.add( result );
}
stmt.close();
return Str; 
```

}

所以当我使用一个简单的请求时，比如“从 NameTable 中选择 S1，S2，其中 Id='345'”它工作得很好，但是这样的请求：SELECT busitypid，attblabel FROM t_article art，t_attribute att，t_srvbrick_attr_article srv WHERE att.attbid = srv .attbid and art.artid = srv.artid and att.modoptidmodifiable = '2' and (att.attbinactivationdate is null or att.attbinactivationdate < date('now')) and art.artshortlabel='"+itab+"'")它实际上崩溃了。

在我的日志文件中，我得到了结果： INFO com.sfr.price.functionalTest.commons.SQLBase.executeSelect [] ret:busitypid,attblabel INFO com.sfr.price.functionalTest.commons.SQLBase.executeSelect [] busitypid INFO com .sfr.price.functionalTest.commons.SQLBase.executeSelect [] attblabel INFO com.sfr.price.functionalTest.commons.SQLBase.executeSelect [] SELECT busitypid,attblabel FROM t_article art, t_attribute att, t_srvbrick_attr_article srv WHERE att.attbid = srv .attbid and art.artid = srv.artid and att.modoptidmodifiable = '2' and art.artshortlabel='8001P' INFO com.sfr.price.functionalTest.commons.SQLBase.executeSelect [] mon resultSet:org.sqlite.RS @ 24c672 信息 com.sfr.price.functionalTest.scenario.impl.AJLINGE.etapeParametrerOption [] ma liste :[]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T14:18:30.120

看起来附加的代码与您在您问题中附加的日志文件不对应。在日志文件中，我们可以看到执行了以下查询：

```
SELECT busitypid,attblabel FROM t_article art, t_attribute att , t_srvbrick_attr_article srv WHERE att.attbid = srv.attbid and art.artid = srv.artid and att.modoptidmodifiable = '2' and art.artshortlabel='8001P' 
```

在代码片段中您有以下查询

```
SELECT busitypid,attblabel FROM t_article art, t_attribute att , t_srvbrick_attr_article srv WHERE att.attbid = srv.attbid and art.artid = srv.artid and att.modoptidmodifiable = '2' and (att.attbinactivationdate is null or att.attbinactivationdate < date('now')) and art.artshortlabel='"+itab+"'" 
```

请注意 WHERE 子句中对 att.attbinactivationdate 的附加检查。也许您实际执行的查询没有返回任何应有的值。

# c# - 有人可以解释这种语法的各个部分，以及如何使用它吗？

> ID：11208987
> 
> 赞同：3
> 
> 时间：2012-06-26T13:57:51.337
> 
> 标签：c#, syntax, parentheses

在浏览一些教程时，我遇到了这样的行：

```
((IDisposable)foo).Dispose(); 
```

忽略对 Idisposable 的具体引用。我很好奇为什么括号的设置方式以及它们包含/做什么。我确信这是一个非常简单的问题，但是由于这种语法的泛型，我一直无法通过搜索找到答案。非常感谢您的帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T14:02:31.403

第一组括号将其强制转换为 IDisposable 对象。例如

```
Object foo = new Object();
IDisposable ID; 
```

现在`ID = foo`会给出一个错误，但`ID = (IDisposable)foo`会起作用。

第二组括号允许您访问 IDisposable 对象的方法和属性，在本例中为 Dispose() 方法。如果您输入它，您将看到只有在您将第二组括号括起来后，智能感知才会向您显示 IDisposable 对象的方法和属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T14:06:05.490

语法：

```
var d = (IDisposable)foo; 
```

称为显式强制转换。

语法：

```
((IDisposable)foo).Dispose(); 
```

显式转换`foo`为临时变量并`Dispose`对其进行调用（请注意，此处使用了临时变量但您看不到它，它是由编译器创建的）***。***

括号告诉编译器操作的优先顺序。`IDisposable`在这种情况下，它表示在解析`Dispose`调用之前将变量转换为。因为之前已经完成，所以编译器现在知道解析`Dispose`类型为 的变量`IDisposable`。

您可以以其他形式看到此行为：

```
(foo as IDisposable).Dispose(); 
```

或者：

```
string s = null;

while ((s = Console.ReadLine()) != null)
{
} 
```

我的第一个示例`as`以与您自己的演员（内联）相同的方式使用运算符进行转换。我的第二个示例`s`在继续针对`null`.

**我的观点是**，如果不使用括号来定义边界，这些都不会编译。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T14:00:04.990

*   从...开始`foo`
*   前缀它`(IDisposable)`以将其转换为请求的接口
*   把它放在括号中告诉.net这`foo`是要转换的东西，而不是结果`foo.Dispose()`
*   现在添加`.Dispose()`地址接口的一个方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:03:10.077

这只是转换为 IDisposable 时的一个捷径。

这个...

```
((IDisposable)foo).Dispose(); 
```

和这个是一样的……

```
IDisposable i = (IDisposable)foo; 
i.Dispose(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T14:03:26.207

内部的括号`IDisposable`将其转换为强制转换，然后外部的括号确保强制转换发生在对 的调用之前`Dispose()`。

# asp.net - 会话过期到我将项目上传到共享服务器的早期

> ID：11208989
> 
> 赞同：0
> 
> 时间：2012-06-26T13:57:58.560
> 
> 标签：asp.net, session, session-timeout

我在共享服务器上上传了我的 Asp.Net 4。客户端上一切正常，但是当我将其上传到主机提供商时，我的会话提前到期

这是我的 WebConfig 代码：

```
<sessionState timeout="160"  /> 
```

然后我尝试使用另一个共享服务器，一切正常！！！我只是在那台服务器上有这个问题

有没有人可以帮我解决这个问题？！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T14:06:05.307

您正在存储会话 inproc，这是默认设置，如果您的站点的应用程序池重新启动，会话也会重新启动。托管商将多个站点放在同一个应用程序池上，并且应用程序池重启的原因有很多（更改 web.config、bin 文件夹中的某些内容等）

为确保这是会话重启的原因，请记录应用程序重启事件，以下是详细信息：[https ://stackoverflow.com/a/10620279/351383](https://stackoverflow.com/a/10620279/351383)

如果应用程序重新启动是一个原因，除了将会话模式更改为 SQL 服务器或状态服务器之外，您无能为力，请参阅[http://msdn.microsoft.com/en-us/library/ms178586.aspx](http://msdn.microsoft.com/en-us/library/ms178586.aspx)。但前提是您的主机支持。

# forms - Symfony2无效形式没有错误

> ID：11208992
> 
> 赞同：63
> 
> 时间：2012-06-26T13:58:14.057
> 
> 标签：forms, validation, symfony

我遇到了 Symfony2 生成的 CRUD 表单的问题。（与 MongoDB 文档，但我不认为这是相关的）

在我的控制器的 createAction() 方法中，当我调试表单结果时：

```
$form->isValid() // returns false

$form->getErrors() // returns en empty array(0) {} 
```

所以，我没有`form_errors(form)`在我的树枝模板上使用任何东西（这看起来很正常，因为`$form->getErrors()`返回空）

并且书面值不会以形式替换......

有人有想法吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-06-27T19:47:01.240

首先要了解的是验证是在模型上完成的，而不是在表单上完成的。表单可以包含错误，但前提是它有一个映射到未验证的属性的字段。因此，如果您的表单不包含无效字段（可能是`NotNull`对不在表单中的属性的断言），它将不会显示错误。

第二件事是`$form->getErrors()`只会显示该级别的错误，每个表单子项都可以包含自己的错误。因此，如果您想检查错误，您应该遍历字段并在每个字段上调用 ​​getErrors。Form 类上的`getErrors`方法可能会以这种方式欺骗。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2012-12-29T09:32:49.693

要调试表单，请使用`$form->getErrorsAsString()`而不是`$form->getErrors()`.

`$form->getErrorsAsString()`应该只用于调试表单...它将包含每个子元素的错误，而`$form->getErrors()`.

正如彼得所提到的，`$form->getErrors()`不会返回子表单的所有错误的总和。

要了解表单如何无效并让 getErrors() 返回一个空数组，您可以查看 symfony 表单类的[isValid()](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/Form.php#L720)方法。如您所见，有 2 种情况下表单无效，第一种测试通用表单，第二种情况测试每个子元素。

```
public function isValid()
{
    //...

    //CASE I : IF CHILD ELEMENTS HAVE ERRORS, $this->errors WILL CONTAIN
    //THE ERROR ON THE CHILD ELEMENT AND NOT ON THE GENERAL 'errors' FIELD 
    //ITSELF

    if (count($this->errors) > 0) {
        return false;
    }

    //CASE II: AND THIS IS WHY WE ARE TESTING THE CHILD ELEMENTS AS WELL
    //TO CHECK WHETHER THERE ARE VALID OR NOT

    if (!$this->isDisabled()) {
        foreach ($this->children as $child) {
            if (!$child->isValid()) {
                return false;
            }
        }
    }

    return true;
} 
```

因此，每个子表单都可以包含一个错误，但`$form->getErrors()`它本身不会返回所有错误。考虑到一个包含许多子元素的表单，如果 CSRF 不正确，您通常会遇到带有 CSRF 错误的 $form->getErrors()。

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2014-10-22T09:30:05.950

*Symfony 2.6 更新*

所以取决于你的 Symfony2 版本：

[symfony2.3](/questions/tagged/symfony2.3 "显示标记为“symfony2.3”的问题")

```
die($form->getErrorsAsString()); 
```

从[symfony2.5 开始](/questions/tagged/symfony2.5 "显示标记为“symfony2.5”的问题")，该`getErrorsAsString()`功能已弃用（将在 Symfony3 中删除），您应该使用以下方法：

```
die((string) $form->getErrors());     // Main errors
die((string) $form->getErrors(true)); // Main and child errors 
```

从[symfony2.6 开始](/questions/tagged/symfony2.6 "显示标记为“symfony2.6”的问题")`dump`，如果您已激活以下功能，您还可以使用(dev environment) 功能`DebugBundle`：

```
dump((string) $form->getErrors());     // Main errors
dump((string) $form->getErrors(true)); // Main and child errors 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-12-21T11:06:13.550

我刚遇到同样的问题。对我来说，表格无效，但我无法通过使用`$form->getErrors()`or得到任何错误`$form->getErrorsAsString()`。后来我发现我忘记将 CSRF 令牌传递给表单，所以它不会被提交，并且`$form->handleRequest($request)`什么也没做（没有验证）。当我看到@pit的答案时，我尝试使用

```
$form->submit($request);

$form->getErrorsAsString(); 
```

它返回一个错误：

> 错误：CSRF 令牌无效。请尝试重新提交表单。

以下是 Symfony2 文档中的一些解释：http: [//symfony.com/doc/current/book/forms.html#handling-form-submissions](http://symfony.com/doc/current/book/forms.html#handling-form-submissions)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-10-18T09:35:21.550

对于 Symfony (>= 3.2 - 4)，您可以使用：

```
foreach($form->getErrors(true, false) as $er) {
    print_r($er->__toString());
} 
```

清楚地看到错误。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-01-25T11:19:26.700

根据文档，从 Symfony 3 开始，您应该使用新的实现：

`$errors = (string) $form->getErrors(true, false);`

这会将所有错误作为一个字符串返回。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-09-11T20:02:22.993

对我来说，表格没有提交，即使我有一个提交按钮。我添加了解决问题的代码

```
$request = $this->get('request');
if($request->isMethod("POST")){
      $form->submit($request);
        if($form->isValid()){
        // now true
        }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-11-30T15:36:28.827

是的，它是正确的，它所说的**Peter Kruithof** 在 SF 2.8 这是我的功能，以获取字段的错误

```
 private function getErrorsForm(\Symfony\Component\Form\Form $form)
{
    $response =  array();

    foreach ($form as $child) {
         foreach ($child->getErrors(true) as $error) {
            $response[$child->getName()][] = $error->getMessage();
         }
    }

    return $response;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-06-28T15:07:37.487

**如果您通过 AJAX 发送数据**，您可能错过了在数据键中包含表单的名称，因此是……的“受害者”。</p>

```
# line 100 of Symfony/Component/Form/Extension/HttpFoundation/HttpFoundationRequestHandler.php 
// Don't submit the form if it is not present in the request 
```

这意味着，在尝试处理请求时，请求处理机制在 GET/POST 数据（即数组）中找不到您的表单名称。

当您以通常的方式呈现表单时，其每个字段都包含您的表单名称作为其 name 属性的前缀`my_form[child_field_name]`。

使用 ajax 时，在 datas 中添加表单名称作为前缀！

```
data : {
    "my_form" : {
       "field_one" : "field_one_value"
       ...
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-12-14T05:30:44.550

我遇到了这个错误，发现我忘记“处理”请求。确保你身边有那个...

```
public function editAction(Request $request)
{
    $form = $this->createForm(new CustomType(),$dataObject);
    /**  This next line is the one I'm talking about... */
    $form->handleRequest($request);
    if ($request->getMethod() == "POST") {
        if ($form->isValid()) {
        ... 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-06-27T18:19:09.590

看来您有验证问题。表单在提交时未验证。我将假设您正在使用注释进行验证。确保你在实体的顶部有这个。

```
use Symfony\Component\Validator\Constraints as Assert; 
```

还有这个在每个属性之上

```
/**      
 * @Assert\NotBlank()      
 */ 
```

`NotBlank()`可以更改为任何约束以满足您的需求。

有关验证的更多信息，请访问： [http ://symfony.com/doc/current/book/validation.html](http://symfony.com/doc/current/book/validation.html)

有关断言约束的更多信息，请访问： [http ://symfony.com/doc/current/book/validation.html#constraints](http://symfony.com/doc/current/book/validation.html#constraints)

# firefox - Selenium：在不同的显示器上打开 Firefox

> ID：11208994
> 
> 赞同：1
> 
> 时间：2012-06-26T13:58:19.593
> 
> 标签：firefox, selenium

我正在使用 Selenium 对某些网页进行一些测试。我希望所有打开的 Firefox 窗口都在不同的 X 桌面上启动（我在显示器 0 上并希望它们在显示器 1 上启动）。我用命令启动服务器

```
DISPLAY=:1 java -jar ./selenium-server-standalone-2.21.0.jar 
```

但是当我运行我的客户端时，服务器会进入状态

```
INFO - Launching Firefox... 
```

但没有进一步。当我切换到显示 1 时，Firefox 出现并且一切正常。但是，我不想每次都手动切换显示，因为我希望我的客户端脚本能够作为 cron 作业运行，即使我不在计算机旁。有没有什么办法解决这一问题？

# struts2 - Weblogic 11g 上的 Jasperreport 空指针

> ID：11208996
> 
> 赞同：1
> 
> 时间：2012-06-26T13:58:29.090
> 
> 标签：struts2, weblogic

我已经部署了使用 jasperreports 插件的 struts2 应用程序。在 Glassfish3 和 Tomcat 中部署时，报告工作正常。但是当我部署到 Weblogic 11g 时，会给出以下 NPE。

```
java.lang.NullPointerException
    at weblogic.servlet.internal.ServletResponseImpl.sendError(ServletResponseImpl.java:645)
    at org.apache.struts2.dispatcher.Dispatcher.sendError(Dispatcher.java:819)
    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:519)
    at org.apache.struts2.dispatcher.ng.ExecuteOperations.executeAction(ExecuteOperations.java:77)
    at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.doFilter(StrutsPrepareAndExecuteFilter.java:91)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3592)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:121)
    at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2202)
    at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2108)
    at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1432)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:173) 
```

有谁知道如何解决这个问题？我正在使用 struts 2.2.3 和 struts2-jasper-reports 插件 2.2.3。

# python - 自动类和实例属性

> ID：11208997
> 
> 赞同：7
> 
> 时间：2012-06-26T13:58:30.997
> 
> 标签：python, python-sphinx, autodoc

根据[sphinx 文档](http://sphinx.pocoo.org/ext/autodoc.html#directive-autoattribute)，该`.. autoattribute`指令应该能够记录实例属性。但是，如果我这样做::

```
.. currentmodule:: xml.etree.ElementTree

.. autoclass:: ElementTree

   .. autoattribute:: ElementTree._root 
```

然后在构建时我得到一个 AttributeError：

```
Traceback (most recent call last):etree.ElementTree.ElementTree                 
  File "/Volumes/Raptor/Library/Python/2.7/lib/python/site-packages/sphinx/ext/autodoc.py", line 326, in import_object
    obj = self.get_attr(obj, part)
  File "/Volumes/Raptor/Library/Python/2.7/lib/python/site-packages/sphinx/ext/autodoc.py", line 232, in get_attr
    return safe_getattr(obj, name, *defargs)
  File "/Volumes/Raptor/Library/Python/2.7/lib/python/site-packages/sphinx/util/inspect.py", line 70, in safe_getattr
    raise AttributeError(name)
AttributeError: _root 
```

即使我实例化`ElementTree`并尝试访问该`_root`属性，它也可以正常工作::

```
>>> from xml.etree.ElementTree import ElementTree
>>> e = ElementTree()
>>> hasattr(e, '_root')
True 
```

我究竟做错了什么？

（我实际上在我自己的一个类中遇到了这个问题，但我只是以 ElementTree 类为例，因为它在标准库中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T15:43:10.353

这看起来像是处理非公共实例属性的方式中的一个错误。[Sphinx`__init__`](https://bitbucket.org/birkenfeld/sphinx/issue/280)应该能够识别.

我不能说这应该如何解决。有一个似乎相关的开放错误报告：[非公共实例属性没有记录没有 __slots__](https://github.com/sphinx-doc/sphinx/issues/956)。

`ElementTree`如果在 ElementTree.py中类的定义中加入以下行，

```
__slots__  = ["_root"] 
```

然后`AttributeError`你得到的就消失了。