# StackOverflow 问答 10903000-10903999

# javascript - 缩短显示的 URL 并保留开头和结尾（Firebug 'Net' 面板样式）

> ID：10903002
> 
> 赞同：2
> 
> 时间：2012-06-05T18:43:22.863
> 
> 标签：javascript, url, truncate

我想在表格中显示一个 URL，同时将其限制为特定长度。作为一个 URL，最好保留最有意义的部分，这些部分往往是开头和结尾。在 Firebug 'Net' 面板中查看长 URL 时可以看到此功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:43:24.657

这是一个快速而肮脏的解决方案，但到目前为止它对我来说效果很好，并且可以轻松更新为任何个人偏好。为了可读性和重用性，它分为两个功能。

该函数使用`shortString`如下所示的函数。它将 URL 缩短为小于或等于指定长度 (l)，同时保留 URL 的开头和结尾并截断首选字符（''、'/'、'&'）。

```
function shortUrl(url, l){
    var l = typeof(l) != "undefined" ? l : 50;
    var chunk_l = (l/2);
    var url = url.replace("http://","").replace("https://","");

    if(url.length <= l){ return url; }

    var start_chunk = shortString(url, chunk_l, false);
    var end_chunk = shortString(url, chunk_l, true);
    return start_chunk + ".." + end_chunk;
} 
```

此函数从字符串的开头（或结尾，如果 reverse=true）开始，一旦达到可接受的长度，就会开始寻找要截断的首选停止字符。如果在达到指定长度 (l) 之前没有找到停止字符，则返回的字符串被截断为最大长度。

```
function shortString(s, l, reverse){
    var stop_chars = [' ','/', '&'];
    var acceptable_shortness = l * 0.80; // When to start looking for stop characters
    var reverse = typeof(reverse) != "undefined" ? reverse : false;
    var s = reverse ? s.split("").reverse().join("") : s;
    var short_s = "";

    for(var i=0; i < l-1; i++){
        short_s += s[i];
        if(i >= acceptable_shortness && stop_chars.indexOf(s[i]) >= 0){
            break;
        }
    }
    if(reverse){ return short_s.split("").reverse().join(""); }
    return short_s;
} 
```

例子

```
>>> var url = "http://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/"
>>> shortUrl(url)
"blog.stackoverflow.com/..swer-your-own-questions/" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-01T02:05:36.683

我有一个非常简单的解决方案。我对仪表板页面有类似的要求：

“我们需要一个 URL 缩短器函数，它返回一个 50 个字符的字符串，开头没有 http 或 https，包含 32 个字符，然后是省略号，最后是 15 个字符。”

因此，shortUrl 函数需要获取长 URL，获取最后 15 个字符 - 从长 url 的长度（与最后一个字符相同）减去 15 以获取切片的开头到结尾。剪掉 http/https 开始 - 我使用了 replace()，获取接下来的 32 个字符 - substr()，然后返回新的开始 + 省略号 (...) + 结束：

```
 var shortUrl = function(u) {
       uend = u.slice(u.length - 15);
       ustart = u.replace('http://', '').replace('https://', '').substr(0, 32);
       var shorter = ustart + '...' + uend;
       alert(shorter);
       return shorter;
     }

     var longUrl = 'http://www.somekoolsite.com/subsite/subsubsite/morefolders/andetc/page.php';

     shortUrl(longUrl);

     // Result: "www.somekoolsite.com/subsite/sub...andetc/page.php"
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-16T13:09:58.487

我已经创建了一种方法来处理 url 和 url 编码的本地文件路径。

```
function pathShorten (str, maxLength, removeFilename) {
    var splitter = str.indexOf('/')>-1 ? '/' : "\\",
        tokens = str.split(splitter), 
        removeFilename = !!removeFilename,
        maxLength = maxLength || 25,
        drive = str.indexOf(':')>-1 ? tokens[0] : "",  
        fileName = tokens[tokens.length - 1],
        len = removeFilename ? drive.length  : drive.length + fileName.length,    
        remLen = maxLength - len - 5, // remove the current lenth and also space for 3 dots and 2 slashes
        path, lenA, lenB, pathA, pathB;    
    //remove first and last elements from the array
    tokens.splice(0, 1);
    tokens.splice(tokens.length - 1, 1);
    //recreate our path
    path = tokens.join(splitter);
    //handle the case of an odd length
    lenA = Math.ceil(remLen / 2);
    lenB = Math.floor(remLen / 2);
    //rebuild the path from beginning and end
    pathA = path.substring(0, lenA);
    pathB = path.substring(path.length - lenB);
    path = drive + splitter + pathA + "..." + pathB + splitter ;
    path = path + (removeFilename ? "" : fileName); 
    // console.log(tokens, maxLength, drive, fileName, len, remLen, pathA, pathB);
    return path;
} 
```

一些例子：

```
pathShorten("http://ok.some-bookshop.co.uk/books/horror/find.php?q=urge",35,false)
"http://ok.s...orror/find.php?q=urge"

pathShorten("http://ok.some-bookshop.co.uk/books/horror/find.php?q=urge",35,true)
"http://ok.some-book...books/horror/"

pathShorten("file:///C:/Users/johpan/OneDrive/Shared%20favorites/show must go on.mp3",55,false)
"file:///C:/Users/jo...d%20favorites/show must go on.mp3"

pathShorten("file:///C:/Users/johpan/OneDrive/Shared%20favorites/show must go on.mp3",55,true)
"file:///C:/Users/johpan/OneDr...ive/Shared%20favorites/" 
```

# ruby-on-rails - use of partial in ruby on rails

> ID：10903004
> 
> 赞同：0
> 
> 时间：2012-06-05T18:43:27.123
> 
> 标签：ruby-on-rails, ruby, partial

I wanted to manage the root page through application.html.erb to insert a partial _header.html.erb for the header bar and a partial _footer.html.erb for the footer bar and in the other pages I would like to enter another partial _sidebar.html.erb for the sidebar...how can i do? Sidebar must not be present in the homepage (root). I have to handle this problem for layout in the application.html.erb page?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:48:57.597

是的，您必须使用布局来处理这个问题。默认值为 application.html.erb。

这是您的问题的一个示例：

```
<!DOCTYPE html>
<html>
  <%= render :partial => 'layouts/common_header' %>
  <body>
    <%=  render :partial => 'layouts/top_menu' %>
    <div id='container-fluid'>
      <div id='sidebar'>
        <%= render :partial => 'layouts/sidebar' %>
      </div>
      <div id='content'>
        <%= yield %>
      </div>
    </div>
  </body>
</html> 
```

我有一个使用部分作为标题、导航栏和侧边栏的布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:57:04.333

为此，我在 LayoutsHelper 中创建了一个辅助方法，如下所示：

```
def sidebar(state)
    @sidebar = state
end 
```

您可以在不希望侧边栏显示的页面上的视图中调用该方法`<% sidebar false %>`

然后在你的`application.html.erb`, 你可以`unless`用来显示侧边栏，除非 @sidebar 变量设置为 false：

```
<% unless @sidebar == false %>
    <div class="sidebar">some stuff</div>
<% end %> 
```

我确信有更好的方法可以做到这一点，但这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:57:04.930

为避免在您的主页中出现侧边栏，请发出：

```
render :layout => false 
```

在控制器中并将页眉和页脚部分添加到您的`index.html.erb`文件中。

# c# - Proper Json.net System.Object Round-trip?

> ID：10903005
> 
> 赞同：2
> 
> 时间：2012-06-05T18:43:28.277
> 
> 标签：c#, .net, json.net

Using the Newtonsoft.Json library, imagine I have got

```
public class Test
{
   public Object Obj { get; set; }
} 
```

Now, attempting to serialize this like so

```
var json = JsonConvert.SerializeObject(new Test(){ Obj = new Uri(@"http://www.google.com") }); 
```

...will give me the following JSON

```
{
    "Obj": "http://www.google.com"
} 
```

Which is clearly not enough information to deserialize this back into a Uri object, and in fact, attempting to deserialize it will give me a String object instead.

Is there any existing way to correctly serialize and deserialize the type information here so that the object will be read back in as a Uri instead of a String? In this particular case, I am only attempting to interop with a .NET application and it is extremely important that the exact types are deserialized.

Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:51:09.700

如果要将字符串转换回 Uri，可以使用自定义转换器属性

转换器

```
public class UriConverter : JsonConverter
{
    public override bool CanConvert(Type objectType)
    {
        return true;
    }

    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        if (reader.TokenType == JsonToken.String)
        {
            //try to create uri out of the string
            Uri uri;
            if(Uri.TryCreate(reader.Value.ToString(), UriKind.Absolute, out uri))
            {
                return uri;
            }
            //just a string -> return string value
            return reader.Value;
        }

        if (reader.TokenType == JsonToken.Null)
        {
            return null;
        }

        throw new InvalidOperationException("Unable to process JSON");
    }

    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        if (null == value)
        {
            writer.WriteNull();
            return;
        }

        if (value is Uri)
        {
            writer.WriteValue(((Uri)value).OriginalString);
            return;
        }

        throw new InvalidOperationException("Unable to process JSON");
    }
} 
```

以及使用属性

```
 [JsonConverter(typeof(UriConverter))]
 public object Obj {get;set;} 
```

然后，您应该能够确定底层对象是否像 Uri

```
 var data = JsonConvert.DeserializeObject<YourObject>(yourJSONString);
  if (data.Obj is Uri)
  {
       ... add logic here
  }
  else
  {
       ... not Uri different logic
  } 
```

您还可以查看这篇文章以获取更多信息[Json.NET Uri（反）序列化错误](https://stackoverflow.com/questions/7792382/json-net-uri-deserialization-errors)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:46:22.763

JSON 只知道 JavaScript 数据类型：字符串、数字和布尔值。URL 不在列表中。

事实上，JSON 的全部要点是允许松散类型的传输。如果您想要强类型传输，请查看更强大的传输协议，例如 WCF 二进制序列化。

# c# - 从数据库c#下载照片

> ID：10903006
> 
> 赞同：1
> 
> 时间：2012-06-05T18:43:39.333
> 
> 标签：c#, asp.net, sql

我尝试从数据库中下载照片。在数据库中，字段类型是图像。ID 是 UniqueIdentifier 类型。我的代码

```
public void ProcessRequest (HttpContext context) {
    ConnectTodatabase conection = new ConnectTodatabase();
    conection.makeConnection();

    // Create SQL Command 
    SqlCommand cmd = new SqlCommand("Select ID,photo from profile where ID=@ID", conection.Connection);
    SqlParameter ImageID = new SqlParameter("@ID", System.Data.SqlDbType.UniqueIdentifier);
    ImageID.Value = context.Request.QueryString["ID"];
    cmd.Parameters.Add(ImageID);

    SqlDataReader dReader = cmd.ExecuteReader();
    dReader.Read();
    context.Response.BinaryWrite((byte[])dReader["photo"]);
    dReader.Close();

    context.Response.ContentType = "text/plain";
    context.Response.Write("test 123456");
} 
```

异常是 InvalidCastException。“无法将参数值从字符串转换为 Guid。” 如何将 ImageID 传递给正确的类型？谢谢！！！

呼叫处理程序

```
foreach (DataRow theRow in thisDataSet.Tables["Profile"].Rows)
        {
            resultCounter++; 
            double x, y;
            x = Convert.ToDouble(theRow["lat"]);
            y = Convert.ToDouble(theRow["lng"]);
            string id = Convert.ToString(theRow["ID"]);
            GLatLng latlng = new GLatLng(x, y);//sintetagmenes shmeiou
            //dimiourgia ton 2 ipomenou gia kathe shmeio
            GInfoWindowTabs iwTabs = new GInfoWindowTabs();
            iwTabs.point = latlng;

            System.Collections.Generic.List<GInfoWindowTab> tabs = new System.Collections.Generic.List<GInfoWindowTab>();

            tabs.Add(new GInfoWindowTab("Profile Info:", "<table> <tr> <td><b>Name: </b> </td><td>" + theRow["fname"] + "</td></tr><tr><td><b>Lastname: </b></td><td>" + theRow["lname"] + "</td></tr><tr><td><b>Affiliation: </b></td><td>" + theRow["affiliation"] + "</td></tr><tr><td><b>Address: </b></td><td>" + theRow["address"] + "</td></tr><tr><td><b>Country: </b></td><td>" + theRow["country"] + "</td></tr><tr><td><b>Email: </b></td><td>" + theRow["email"] + "</td></tr><tr><td><b>Role: </b></td><td>" + theRow["role"]));

            tabs.Add(new GInfoWindowTab("Profile Photo:", "<img src=Handler.ashx?ID=" + theRow["ID"] + "border=1>")); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:47:38.220

试试这个，看看它是否有效：

```
SqlParameter ImageID = new SqlParameter("@ID", System.Data.SqlDbType.UniqueIdentifier);
ImageID.Value = System.Data.SqlTypes.SqlGuid.Parse(context.Request.QueryString["ID"]); 
```

这里的关键是将字符串转换为 GUID。

***编辑***

我注意到您所做的编辑包括您的呼叫处理程序。我在您的呼叫处理程序中看到的两个明显问题是您创建了一个 id 变量来保存转换后的 GUID，但您并没有真正使用它。此外，您没有使用＆符号正确分隔边框查询参数：`&`

改变这个：

```
tabs.Add(new GInfoWindowTab("Profile Photo:", "<img src=Handler.ashx?ID=" + theRow["ID"] + "border=1>")); 
```

对此：

```
tabs.Add(new GInfoWindowTab("Profile Photo:", "<img src=Handler.ashx?ID=" + id + "&border=1>")); 
```

因此，本质上，您将其作为您的 ID 发送：`5a6b4047-e2dc-40d8-9c58-8609278154f4border=1`这不是有效的 GUID。

只是作为一个提示，我会这样做，这可能会让你更容易发现你的 Type-O：

```
tabs.Add(new GInfoWindowTab("Profile Photo:", string.Format("<img src=Handler.ashx?ID={0}&border=1>", id))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:50:51.170

```
Guid ImageGUID = new Guid(context.Request.QueryString["ID"]);

ImageID.Value = ImageGUID; 
```

# objective-c - sizeWithFont 返回宽度 0

> ID：10903010
> 
> 赞同：0
> 
> 时间：2012-06-05T18:44:01.317
> 
> 标签：objective-c, nsstring, core-graphics, sizewithfont

我的最终目标是改变字体大小，以便不同的单词适合同一个矩形区域。我认为 sizeWithFont 会是一个很好的使用方法，但我一直得到 0 的宽度，我很困惑。

```
NSString *name = @"Test Word";
CGFloat fontSize = 32.0;
UIFont *font = [UIFont fontWithName:@"TimeNewRomanPSMT" size: fontSize]; 
CGSize sWidth = [name sizeWithFont:font 
             constrainedToSize:CGSizeMake(fontSize, CGFLOAT_MAX)
          lineBreakMode:UILineBreakModeWordWrap];
NSLog(@"sWidth =  %3.1f; rec.width n= %3.1f ", sWidth.width, rec.width); 
```

我的计划是遍历字体大小，直到宽度适合但 sWidth.width 一直返回 0。

克里斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T18:46:12.867

字体名称是 TimesNewRomanPSMT，没有 TimeNewRomanPSMT。

注意 Times 之后的 s，这是一个常见错误！

该网站对于验证字体名称以及列出并提供 iOS 中所有可用字体的示例非常有帮助：

[http://iosfonts.com/](http://iosfonts.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:47:15.187

在这种情况下，您应该建议并检查的第一件事 - 您的字体不是`nil`. 如果您输入的字体名称不正确，可能会发生这种情况

# xslt - 使用子节点子字符串创建新节点

> ID：10903013
> 
> 赞同：0
> 
> 时间：2012-06-05T18:44:09.893
> 
> 标签：xslt, xslt-1.0

我有一个看起来像这样的 xml 文档：

```
<oldEle userlabel="label1">
  <ele1>%02d.jpeg</ele1>
</oldEle>

<oldEle userlabel="label2">
  <ele1>%02d.tiff</ele1>
</oldEle> 
```

我希望它是这样的：

```
<JPEG userlabel="label1">
  <ele1>%02d.jpeg</ele1>
</JPEG>

<TIFF userlabel="label2">
  <ele1>%02d.tiff</ele1>
</TIFF> 
```

我试过这个。

```
<xsl:template match="//xmlns:oldNode[contains(//xmlsns:oldNode/root:ele1, '.')]">
  <xsl:element name="{translate(substring-after(//xmlns:ele1, '.'),
               'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ')}">
      <xsl:apply-templates select="@*|node()"/>
  </xsl:element>
</xsl:template> 
```

但只获取文件 ext 的第一个。例如，如果 jpeg 是第一个，我会得到两个节点。有人可以就为什么这不起作用提供专业建议。

顺便说一句，我也试过这个，但同样的事情发生了：

```
<xsl:template match="//xmlns:oldNode[contains(//root:ele1, '.jpeg')]">
  <xsl:element name="JPEG">
      <xsl:apply-templates select="@*|node()"/>
  </xsl:element>
</xsl:template>

<xsl:template match="//xmlns:oldNode[contains(//root:ele1, '.tiff')]">
  <xsl:element name="TIFF">
      <xsl:apply-templates select="@*|node()"/>
  </xsl:element>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:50:00.673

第一个问题是您的匹配模板

```
 <xsl:template match="//xmlns:oldNode[contains(//xmlsns:oldNode/root:ele1, '.')]"> 
```

特别是，对于**contains**元素，您可能不希望`//oldNode`在最前面，因为这将开始寻找相对于根元素的第一个**oldNode 。**您真正想要的是查找相对于您当前匹配的元素的**ele1**元素

```
<xsl:template match="//oldNode[contains(ele1, '.')]"> 
```

（顺便说一下，我不确定您是指**oldNode**还是**oldEle**。我也不确定您的命名空间适合哪里，所以我没有在这里展示它们）。

第二个问题是**xsl:element**，因为你在这里做类似的事情

```
<xsl:element name="{translate(substring-after(//xmlns:ele1, '.'),         
    'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ')}"> 
```

由于`//`在**substring-after**中，它将获取相对于 XML 根元素的第一个**ele1**，而不是相对于当前元素的那个。你可能需要这样做

```
<xsl:element name="{translate(substring-after(ele1, '.'),         
    'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ')}"> 
```

试试这个模板

```
<xsl:template match="//oldNode[contains(ele1, '.')]">            
    <xsl:element name="{translate(substring-after(//ele1, '.'),            
           'abcdefghijklmnopqrstuvwxyz', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ')}">            
       <xsl:apply-templates select="@*|node()"/>            
    </xsl:element>            
</xsl:template> 
```

同样，对于你的第二组模板，你应该做这样的事情

```
<xsl:template match="//oldNode[contains(ele1, '.jpeg')]"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:53:44.167

```
<xsl:template match="oldNode">
    <xsl:choose>
        <xsl:when test="contains(ele1,'.jpeg')">
            <xsl:element name="JPEG">
                <xsl:apply-templates select="@*|node()"/>
            </xsl:element>
        </xsl:when>
        <xsl:when test="contains(ele1,'.tiff')">
            <xsl:element name="TIFF">
                <xsl:apply-templates select="@*|node()"/>
            </xsl:element>
        </xsl:when>
    </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T12:59:08.990

**这是与您之前的问题相同的答案 - 这完全解决了旧问题和当前问题，并且不使用递归**：

```
<xsl:stylesheet version="1.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
     xmlns:my="my:my">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>

     <my:suffixes>
      <s>jpeg</s><s>JPEG</s>
      <s>tiff</s><s>TIFF</s>
      <s>giv</s><s>GIV</s>
      <s>png</s><s>PNG</s>
     </my:suffixes>

     <xsl:variable name="vSufs" select="document('')/*/my:suffixes/s"/>

     <xsl:template match="node()|@*" name="identity">
         <xsl:copy>
           <xsl:apply-templates select="node()|@*"/>
         </xsl:copy>
     </xsl:template>

     <xsl:template match="*">
       <xsl:variable name="vSufFound" select=
        "$vSufs[position() mod 2 = 1]
             [substring(translate(current()/ele1, ., ''),
                        string-length(translate(current()/ele1, ., ''))
                        )
             =
              '.'
             ]"/>
       <xsl:choose>
         <xsl:when test="not($vSufFound)">
          <xsl:call-template name="identity"/>
         </xsl:when>
         <xsl:otherwise>
           <xsl:element name="{$vSufFound/following-sibling::s[1]}">
             <xsl:apply-templates select="node()|@*"/>
           </xsl:element>
         </xsl:otherwise>
       </xsl:choose>
     </xsl:template>
</xsl:stylesheet> 
```

**当对提供的 XML 文档应用此转换时，会产生所需的正确结果：**

```
<t>
    <JPEG userlabel="label1">
        <ele1>%02d.jpeg</ele1>
    </JPEG>
    <TIFF userlabel="label2">
        <ele1>%02d.tiff</ele1>
    </TIFF>
</t> 
```

**说明**：

在此转换中，我们使用以下 XPath 1.0 表达式来实现标准 XPath 2.0`ends-with($t, $suf)`函数：

```
$suf = substring($t, string-length($t) - string-length($suf) +1) 
```

# c# - 有任何方法可以匹配 Visual Fox Pro 和 C# 的方法 RAND(INT)。网

> ID：10903014
> 
> 赞同：2
> 
> 时间：2012-06-05T18:44:11.037
> 
> 标签：c#, methods, random, foxpro

我正在将 Visual Fox Pro 代码迁移到 C#。网

**是什么让 Visual Fox Pro**：根据文本字符串（在文本框中捕获）生成一个 5 位数字的字符串（“48963”），如果您始终输入相同的文本字符串，则该字符串始终为 5 位数字（不反向），我在 C# 中的代码。NET 应该生成相同的字符串。

有一些代码我不能在 dot.net Rand (int) 中播放

在 VisualFoxPro 中：

```
rand(intValue) 
```

在 C# 中。网：

```
Random r = new Random ();
return r.Next(intValue); 
```

在 C# 中，我无法基于相同的 intValue 生成单个值，我知道它们是非常不同的库（VFP 和 C#），但如果有任何方法可以匹配 Visual Fox Pro 和 C# 的方法，则不会。网

我想迁移以下代码（Visual Fox Pro 6 到 C#）

```
gnLower = 1000
gnUpper = 100000
vcad = 1
For y=gnLower to gnUpper step 52
    genClave = **Rand(vcad)** * y
    vRound = allt(str(int(genclave)))
    IF Len(vRound) = 3
            vDec = Right(allt(str(genClave,10,2)), 2)
            finClave = vRound+vDec
            Thisform.txtPass.value = Rand(971);
    Exit
    Endif
Next y 
```

输出：

```
vcad = 1 return: 99905 vcad = 2 return: 10077 vcad = thanks return: 17200 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:08:19.013

.NET 中的 Rand 不能保证在主要修订号之间相同，因此2.0 中`Rand()`种子的a 可能与 4.0 中具有完全相同种子的 a 不同。`1234``Rand()`

如果您必须匹配旧的暗示，您将需要了解 Visual Fox Pro 是如何完成其​​ Rand 函数的。但是，如果您想要相同的行为，但不是相同的数字，您可以对字符串进行哈希处理，然后将其输出。

```
Random r = new Random (myTextBox.Text.GetHashCode()); 
return r.Next(); 
```

现在这不是加密安全的，并且不能保证在不同的计算机上生成相同的数字（它返回 32 和 64 位之间的不同数字，以及基于 .Net 运行时的不同版本（这实际上适用于两者`GetHashCode`和`Random`它本身！） )，所以不要将它存储在数据库中！

* * *

如果您每次都需要从同一个字符串中输出相同的数字，无论它在哪台计算机上，只需在命名空间中使用[RNGCryptoServiceProvider 即可](http://msdn.microsoft.com/en-us/library/5f45t420)`System.Security.Cryptography`。

```
//Returns the same number between 0 and 255 every time.
using(var myRng = new RNGCryptoServiceProvider(myTextBox.Text))
{
    var ret = new byte[1];
    myRng.GetBytes(ret);
    return ret[0];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T18:51:55.773

```
Random r = new Random (intValue); 
return r.Next(); 
```

请参阅Random()的[构造函数：](http://msdn.microsoft.com/en-us/library/ctssatww.aspx)

> 为不同的 Random 对象提供相同的种子值会导致每个实例产生相同的随机数序列

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T18:58:03.380

在 Visual FoxPro 中，您可以通过使用种子值调用 RAND() 一次重复生成相同的随机数序列，然后在后续调用中省略种子：

```
RAND(mySeed)
RAND()
RAND() 
```

在 C# 中，您可以通过将种子值指定为`Random`构造函数的参数来执行类似的操作：

```
Random r = new Random (mySeed);  
r.Next(intValue); 
r.Next(intValue); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T18:57:26.670

我使用`GetHashCode`字符串值上的方法来播种`Random`：

```
var s = "abcdefg";
var random = new Random(s.GetHashCode());
var hash = random.Next(10000, 99999)); 
```

以下是我通过几个测试用例得到的结果：

```
"abcdefg" => 43065
"abcdefg" => 43065
"defghij" => 62962
"qwerty"  => 72764
"defghij" => 62962
"qwerty"  => 72764
"abcdefg" => 43065 
```

# html - Chrome中多行文本的省略号

> ID：10903015
> 
> 赞同：5
> 
> 时间：2012-06-05T18:44:14.040
> 
> 标签：html, css, ellipsis

`-o-ellipsis-lastline`谷歌浏览器有什么类似的吗？

我正在构建一个 Chrome 扩展程序，并希望使用 CSS 来省略多行文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:36:08.090

由于[text-overflow 的 W3 规范，](http://www.w3.org/TR/2002/WD-css3-text-20021024/#text-overflow-ellipsis)不可能创建省略号纯 CSS 。

但是，如果您正在开发 Chrome 扩展程序，您已经在使用 JavaScript，那么这里有一些演示和插件可以解决您的问题：

*   [http://www.codeitbetter.co.uk/widgets/ellipsis/](http://www.codeitbetter.co.uk/widgets/ellipsis/)
*   [http://jsfiddle.net/danesparza/TF6Rb/1/](http://jsfiddle.net/danesparza/TF6Rb/1/)
*   [http://jsfiddle.net/MPkSF/](http://jsfiddle.net/MPkSF/)
*   [http://jsfiddle.net/VpmbL/](http://jsfiddle.net/VpmbL/)
*   [https://github.com/pvdspek/jquery.autoellipsis](https://github.com/pvdspek/jquery.autoellipsis)

我在自己的项目中使用了最后一个插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:01:14.383

目前多行文本没有省略号...但是您可以使用简单的条件对多行进行省略号效果。这是一个例子......

假设你有一个这样的 html...

```
<div class="class_name"><%=message%></div> 
```

你在运行时呈现你的文本......你的文本将被呈现并放置在 div 标签而不是消息模板中。所以你能做的就是...

```
<% if(message.length < 100) { %>
  <div class="class_name"><%=message%></div>
<% } else { %>
  <div class="class_name"><%=message.slice(0,80)%>...</div>
<% } %> 
```

如果您的文本超过 100 个字符，它将显示省略号效果（在 80 个字符的末尾）

注意：值 100 和 80 是可选的。你可以根据你的需要改变...

希望能帮助到你 ：）...

# jsf - 登录后重定向错误（Java EE w/JSF）

> ID：10903023
> 
> 赞同：7
> 
> 时间：2012-06-05T18:44:38.377
> 
> 标签：jsf, jakarta-ee, login, prettyfaces

使用 JSF 在 Java EE 中开发 Web 应用程序。所有页面都通过带有操作“j_security_check”并输入“j_username”和“j_password”的身份验证表单进行保护，以免被查看。

但是，成功登录后，我被重定向到我想访问的页面而不是这个 URL

```
/faces/javax.faces.resource/jsf.js?ln=javax.faces&stage=Development 
```

所以我正在查看包含所有 JS 代码的脚本文件 jsf.js，而不是我想要查看的页面。如果我访问 Web 根目录或任何其他页面都没有关系，我每次都会被重定向到这个 URL。然后我将 URL 更改为任何页面，它可以正常加载并且我已登录。

我不得不说我已经遇到了这个问题，它神奇地消失了，所以它正确地重定向了我。几周后它又坏了，但我不知道这是我的错，如果是我不知道原因。我根本没有搞乱重定向或导航规则。

值得一提的是，我也在使用 PrettyFaces。

编辑：

```
<security-constraint>
    <display-name>secured</display-name>
    <web-resource-collection>
        <web-resource-name>all</web-resource-name>
        <description/>
        <url-pattern>/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <description/>
        <role-name>admin</role-name>
        <role-name>teacher</role-name>
    </auth-constraint>
</security-constraint>
<security-constraint>
    <display-name>secured for admins</display-name>
    <web-resource-collection>
        <web-resource-name>admin pages</web-resource-name>
        <description/>
        <url-pattern>/admin/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <description/>
        <role-name>admin</role-name>
    </auth-constraint>
</security-constraint>
<security-constraint>
    <display-name>unsecured</display-name>
    <web-resource-collection>
        <web-resource-name>css</web-resource-name>
        <description/>
        <url-pattern>/css/*</url-pattern>
    </web-resource-collection>
    <web-resource-collection>
        <web-resource-name>js</web-resource-name>
        <description/>
        <url-pattern>/js/*</url-pattern>
    </web-resource-collection>
    <web-resource-collection>
        <web-resource-name>img</web-resource-name>
        <description/>
        <url-pattern>/img/*</url-pattern>
    </web-resource-collection>
</security-constraint>
<login-config>
    <auth-method>FORM</auth-method>
    <realm-name>wetk-security</realm-name>
    <form-login-config>
        <form-login-page>/faces/login.xhtml</form-login-page>
        <form-error-page>/faces/login.xhtml</form-error-page>
    </form-login-config>
</login-config> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T18:51:26.063

容器管理的安全性将重定向到触发身份验证检查的最后一个 HTTP 请求。在您的情况下，它显然是自动包含的 JSF ajax API JavaScript 文件。如果浏览器从浏览器缓存中完全加载了待认证页面，而浏览器已经从服务器端完全加载了 JS 文件，或者通过条件 GET 请求测试了 JavaScript 文件的缓存有效性，则可能会发生这种情况.

您想从身份验证检查中排除JSF资源 (`<h:outputScript>`和`<h:outputStylesheet>``<h:graphicImage>``/javax.faces.resource/*``/faces``*.xhtml`

您还需要指示浏览器*不要*缓存受限页面，以防止浏览器从缓存中加载它（例如，在注销后按返回按钮）。将以下过滤器映射到与您的`<security-constraint>`.

```
@WebFilter("/secured/*") // Use the same URL pattern as <security-constraint>
public class NoCacheFilter implements Filter {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletRequest httpReq = (HttpServletRequest) request;
        HttpServletResponse httpRes = (HttpServletResponse) response;

        if (!httpReq.getRequestURI().startsWith(httpReq.getContextPath() + ResourceHandler.RESOURCE_IDENTIFIER)) { // Skip JSF resources (CSS/JS/Images/etc)
            httpRes.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1.
            httpRes.setHeader("Pragma", "no-cache"); // HTTP 1.0.
            httpRes.setDateHeader("Expires", 0); // Proxies.
        }

        chain.doFilter(request, response);
    }

    // ...
} 
```

# ruby-on-rails - 寻找 IDE RoR 和 Yaml

> ID：10903025
> 
> 赞同：-3
> 
> 时间：2012-06-05T18:44:43.617
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个带有 Yaml 的 RoR 项目，但我使用 TextMate，但我不喜欢它。

在 Rails 上使用 Yaml 和 Ruby 的最佳 IDE 是什么。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:45:59.203

我对[IntelliJ](http://www.jetbrains.com/idea/)及其对[Ruby 和 Rails 的支持](http://www.jetbrains.com/idea/features/ruby_rails.html)非常满意。

对于更多文本编辑的东西，[Sublime Text 2](http://www.sublimetext.com/)是一个很好的跨平台选择。

Emacs 是我的季军，主要是因为在过去的 5 到 10 年里我没有足够的使用它来像以前那样流畅地使用它，但它是有史以来最好的文本编辑器。[让 Emacs/Vi 大战开始吧！]

# c# - 单元测试数据生成的最佳实践

> ID：10903026
> 
> 赞同：3
> 
> 时间：2012-06-05T18:44:49.047
> 
> 标签：c#, unit-testing

我有一个单元测试，其中包含需要与实际自定义对象进行比较的大量数据。所以我必须创建一个预期的自定义对象并用大量数据填充它，现在我正在用代码对预期的自定义对象进行硬编码。有一种情况，我使用不同的数据集作为我正在测试的方法的输入进行测试。根据数据集，我必须获得相对输出，这将是实际响应（大量数据）。除了在代码中硬编码预期值之外，对于上述场景是否有任何最佳实践？（像 XML 或 CSV 之类的东西）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:53:29.110

您可以创建将使用`XmlSerializer`.

您需要在应用程序运行时调用该代码并且内存中有正确的对象。

将 XML 保存到文件中，并从 XML 构造测试对象。

您可能有几个 XML 文件可以涵盖不同的场景。

在我的应用程序中，我有从外部 Web 服务导入数据的代码。我为服务响应对象（它们很大）生成了一些 XML，并使用它们来测试我的解析逻辑。

**更新：**该技巧仅适用于实体对象。您不能序列化/反序列化与文件或数据库一起使用的类。

在这里您可以找到示例代码。 [http://www.jonasjohn.de/snippets/csharp/xmlserializer-example.htm](http://www.jonasjohn.de/snippets/csharp/xmlserializer-example.htm)

# ios - IOS：区别NSDate

> ID：10903027
> 
> 赞同：0
> 
> 时间：2012-06-05T18:45:00.280
> 
> 标签：ios, xcode, nsdate

我有两个 nsdate，这个时刻日期和一个我知道的 nsdate；我想要区别，我想要结果秒......

实际上，NSDate 这不是问题，但如果我想要 2012 年 9 月 13 日 12:30 的 NSDate？

你能帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:49:42.607

只需将字符串解析为 NSDate 对象...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:34:05.787

NSDateFormatter 是你的朋友。

# android - 代码在 mNotificationManager.notify( , ) 处停止执行

> ID：10903029
> 
> 赞同：0
> 
> 时间：2012-06-05T18:45:07.810
> 
> 标签：android, notificationmanager

尽管所有 sendXXXXX 布尔值都是 true，但代码在第一次 notify() 处停止执行。如果我手动将第一个设置为 false，则代码将在第二个 if 语句中停止执行。

当 .notify() 被调用时，它就像一个返回语句。它退出函数但不抛出任何错误/异常。

```
if (sendAC) {
    mNotificationManager.notify(XMPP_ID, notificationHouse);
}
if (sendRefridgerator) {
    mNotificationManager.notify(XMPP_IDRefridgerator, notificationRefridgerator);
}
if (sendWater) {
    mNotificationManager.notify(XMPP_IDWater, notificationWater);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:26:00.017

好吧，几个小时后就明白了。这是一个无声的异常（它没有出现在 Logcat 中）。我在调试器中一步一步地检查了线程，它显示了一个安全异常。所以我在它周围添加了一个 try catch 来找出错误是什么。我只是在清单中没有振动权限，所以我得到了一个 SecurityException，但是没有捕获它就没有显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:34:31.537

清理您的项目，然后重新安装它。我猜调试器没有转到下一个 if 语句的原因是因为下面的代码没有加载到设备上。

要么，要么你在某处弄乱了你的 if 语句的括号

# ruby-on-rails - 安装 Rails 3 引擎时看不到路线

> ID：10903036
> 
> 赞同：0
> 
> 时间：2012-06-05T18:45:29.187
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, ruby-on-rails-3.2, rails-engines

我创建了一个 Rails 引擎（根据[Rails Guides](http://edgeguides.rubyonrails.org/engines.html)），使用：

```
rails plugin new address_book --full --mountable 
```

我继续为引擎创建一个控制器，`pages`使用单个操作（称为`temp`）调用来显示单个视图，即`app/views/address_book/pages/temp.html.erb`

引擎的 config/routes.rb 是：

```
AddressBook::Engine.routes.draw do
  match :temp, to: "pages#temp" 
end 
```

在父应用程序中，我在 routes.rb 文件中添加了以下内容：

```
mount AddressBook::Engine => "/address_book", as: "address_book" 
```

在父应用程序控制器之一的操作中，我对属于引擎的视图进行了以下调用：

```
redirect_to address_book.temp_path 
```

现在，即使`rake routes`显示引擎的路径，当我尝试从浏览器执行操作时，我仍然收到错误消息：

```
undefined local variable or method `address_book' 
```

为线`redirect_to address_book.temp_path`

rake 路由的结果包含以下内容：

```
address_book        /address_book         AddressBook::Engine

Routes for AddressBook::Engine:
temp  /temp(.:format) address_book/pages#temp 
```

我似乎无法理解我所缺少的，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T09:26:54.527

经过长时间的反复试验（并关闭PC一夜），我意识到我需要做的就是**重新启动服务器**

希望这篇文章能帮助其他遇到同样绊脚石的人。

# haskell - 理解一个 monad 实例

> ID：10903038
> 
> 赞同：4
> 
> 时间：2012-06-05T18:45:40.320
> 
> 标签：haskell, monads

我有这个 Haskell 代码部分：

```
newtype State st a = State (st -> (st, a))

instance Monad (State state) where
    return x = let f t = (t,x) in State f

    State f >>= g = State (\oldstate ->
                let {(newstate, val) = f oldstate;
                  State f'= g val}
                in f' newstate) 
```

我是 monad 的新手，但我想我知道在一般情况下是如何工作的`return`。`bind`

但在上面的例子中我有很多问题：

1.  在`Monad (State state)`状态是单子的名字吗？它与 有什么关系`newtype State ...`？
2.  `return x = let f t = (t,x) in State f`从哪里来`t`？_

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T22:22:35.030

所以到目前为止，您肯定已经听说过*柯里*化或*部分应用*：如果您有`f :: a -> b -> c`and `x :: a`，那么`f x :: b -> c`. 即，If`f`是一个双参数函数并且`x`具有 的`f`第一个参数的类型，那么`f x`是一个接受第二个参数并“完成”应用程序的函数。

好吧，在 Haskell 中，同样的事情也适用于类型构造函数，例如`State`. 类型和类型构造函数具有*kind*，类似于值如何具有类型。`Integer`像有 kind的非参数类型`*`；像`Maybe`有 kind的单参数类型`* -> *`；`State`有种`* -> * -> *`。

然后，`State state`是`State`类型构造函数的部分应用，并且有 kind `* -> *`。 `Monad`是适用于 kind 的类`* -> *`。因此，应用于我们的示例：

1.  `instance Monad (Integer) where ...`被禁止是因为`Integer`有善良`*`。
2.  `instance Monad (Maybe) where ...`被允许是因为`Maybe`有种`* -> *`。
3.  `instance Monad (State) where ...`被禁止是因为`State`有善良`* -> * -> *`。
4.  `instance Monad (State st) where ...`被允许是因为`State st`有种`* -> *`。

我们怎么知道它`Monad`适用于 kind 类型`* -> *`？我们可以从类声明中推断出来：

```
class Monad m where
    return :: a -> m a
    (>>=) :: m a -> (a -> m b) -> m b
    -- ... 
```

看看在`m`这个类声明中是如何使用的：作为 and 的一部分`m a`，`m b`即作为一个参数。因此，Haskell 推断这`m`是 kind 的类型变量`* -> *`。

与此相比：

```
class Num a where
    (+) :: a -> a -> a
    (-) :: a -> a -> a
    -- ... 
```

这里类型变量`a`不应用于其他类型变量——因此它必须是 kind `*`。

所以严格来说，`State`不是monad；它是一个两位类型的构造函数，当部分应用于仅一种类型时，它会为您提供一个 monad。monad 也是如此`State state`，就像`State Integer`,`State [a]`等一样。尽管人们确实经常谈论和谈论`State`类似 monad 的东西，但是你应该理解它是一个*参数化*的 monad——它是一个具有内部类型参数的 monad，因此有许多变体该参数的类型不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:50:38.843

1.  `State`是 monad 的类型，`instance Monad (State state)`正在声明`State state`（其中`state`是可以设置为任何其他类型*的类型变量）是`Monad`. `newtype State`是`State`类型的定义。
2.  `let f t = (t, x)`正在定义一个*函数*，其参数名为`t`.

* 从技术上讲，`state`是 kind 的类型变量`*`，但不用担心。

# ios - 自定义 MAM 应用程序

> ID：10903040
> 
> 赞同：0
> 
> 时间：2012-06-05T18:45:48.360
> 
> 标签：ios, mdm

我想知道是否可以为 iOS 平台编写自己的 MAM 服务器或应用程序。也许有人可以为我指出正确的方向，但我正在寻找一种静默推出应用程序的方法，无论是通过 App Store 还是从服务器上推出。当前的问题是，我尝试过的解决方案要求您继续为要安装的每个应用程序重新输入密码，如果用户想要更新应用程序，因为他们不知道帐户/密码，这会很痛苦。任何帮助将非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-21T02:54:05.513

从 iOS 7 开始，您可以将应用程序静默推送到受监督设备。

您可以观看 WWDC 2013 视频以了解更多信息。

此外，您可以使用 Apple 配置器对设备进行监督。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:44:38.197

如前所述，在堆栈溢出时有很多次 - 您不能在 iOS 上静默推出应用程序，因为 Apple 不提供对此的支持。每个应用程序安装都必须得到用户的批准。

# php - 如何自动将标题放入url

> ID：10903041
> 
> 赞同：1
> 
> 时间：2012-06-05T18:45:52.203
> 
> 标签：php, mod-rewrite

SO这样的网站如何将问题的标题动态放入url栏中。

这是通过 rewritemapping 和 mod rewrite 实现的吗？我怎样才能在普通的网络主机上做到这一点。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:48:44.890

在这个网址中：

```
https://stackoverflow.com/questions/10903041/how-to-automatically-put-title-in-url 
```

唯一重要的部分是问题 ID `10903041`，. 所以只需设置一个重定向规则，忽略 URL 末尾的任何内容，就像这样：

```
RewriteRule /questions/(\d+) question.php?id=$1 
```

如果标题尚未提供或不正确，PHP 脚本可以重定向到正确的标题；很像您访问[https://stackoverflow.com/questions/10903041/why-is-this-question-title-so-wrong 时会发生什么？](https://stackoverflow.com/questions/10903041/why-is-this-question-title-so-wrong).

# css - 麻烦造型p类

> ID：10903051
> 
> 赞同：0
> 
> 时间：2012-06-05T18:46:28.530
> 
> 标签：css

我在造型上遇到了麻烦`<p class="wp-caption-text">`。

我试过`.detail p.wp-caption-text`, `.detail .wp-caption-text`, `.wp-caption-text`, 等等。似乎没有任何效果。我错过了什么？

索引.php

```
<?php get_header(); ?>
<!-- #content -->
<div id="content">
    <!-- start of .post -->
    <?php if (have_posts()) : while (have_posts()) : the_post(); ?>
    <div class="post<?php if(!has_post_thumbnail()) echo " no-featured"; ?>">
        <?php if(has_post_thumbnail()): ?>
        <div class="featured">
            <a href="<?php the_permalink(); ?>"><?php the_post_thumbnail(array(700,9999)); ?></a>

        <div class="credit"></div>
        </div>
        <?php endif; ?>
        <div class="detail">
            <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
            <?php if (the_post_thumbnail_caption()) { echo '<p class="wp-caption-text">' . the_post_thumbnail_caption() . '<p>'; }?>
            <div class="meta">
                <div class="top"></div>
                <p><?php _e('by'); ?> <strong><?php the_author(); ?></strong></p>
                <p><?php _e('posted'); ?>  <strong><?php echo get_the_date(); ?></strong></p>
                <p><?php _e('category'); ?>  <?php the_category(', '); ?></p>
                <div class="bottom"></div>
            </div>
            <div class="excerpt">
                <?php the_excerpt(); ?>
            </div>

            <?php 
                $args = array(
                    'post_type' => 'attachment',
                    'numberposts' => -1,
                    'post_status' => null,
                    'post_parent' => $post->ID
                    ); 
                $attachments = get_posts($args);
                if(count($attachments) > 1): 
            ?>
            <div class="pic-excerpt">
                <div class="top"></div>
                <div class="outer">
                    <h3><?php _e('Pictures In This Set'); ?></h3>
                    <div class="pic">
                        <?php the_image_excerpt(wpop_get_option('pic_excerpt')); ?>
                    </div>
                </div>
                <div class="bottom"></div>
            </div> <!-- pic-excerpt -->
            <?php endif; ?>

        </div>
    </div>

    <?php endwhile;?>
    <div class="paging">
        <div class="alignleft"><?php next_posts_link('&laquo; Older Entries', 0); ?></div>
        <div class="alignright"><?php previous_posts_link('Newer Entries &raquo;', 0); ?></div>
        <div class="clear"></div>
    </div>
    <?php endif;?>
    <!-- end of .post --> 
```

[现场直播。](http://dapculture.com)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T18:49:09.567

你没有在这一行关闭你的段落标签-

```
 <?php if (the_post_thumbnail_caption()) { echo '<p class="wp-caption-text">' . the_post_thumbnail_caption() . '<p>'; }? 
```

这是一个修复

```
 <?php if (the_post_thumbnail_caption()) { echo '<p class="wp-caption-text">' . the_post_thumbnail_caption() . '</p>'; }? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:22:14.753

我把php包裹在里面

并将 css 更改为 .detail p ，这使它一切正常。谢谢你的帮助。

# c# - 文件上传不触发处理程序？

> ID：10903057
> 
> 赞同：0
> 
> 时间：2012-06-05T18:46:51.593
> 
> 标签：c#, asp.net, silverlight, httphandler

我不知道为什么，但我的处理程序没有被触发。（顺便说一下，我对 Silverlight 还是很陌生。）我正在关注[这里](http://www.silverlight.net/archives/videos/openfiledialog-and-file-upload)的教程。我不确定我做错了什么......谢谢。[使用 Silverlight 3.0，VS2008]

主页.xaml

```
<UserControl x:Class="MultiSelectFileUploader.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    mc:Ignorable="d" d:DesignWidth="640" d:DesignHeight="480">
<Grid x:Name="LayoutRoot">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <TextBox x:Name="tbUL" Grid.Row="0" Width="150" Margin="0 0 250 0"></TextBox>
    <Button x:Name="btnUL" Grid.Row="0" Width="100" Click="btnUL_Click"></Button>

    <ListBox Grid.Row="1" Width="200" Height="25" Margin="0 0 200 0"></ListBox>
    <Button Grid.Row="1" Width="50" Margin="50 0 0 0"></Button>

    <TextBox Grid.Row="2" Width="125" Margin="0 0 275 0"></TextBox>
    <TextBox Grid.Row="2" Width="125" Margin="0 0 25 0"></TextBox>
</Grid>
</UserControl> 
```

MainPage.xaml.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using System.IO;

namespace MultiSelectFileUploader
{
    public partial class MainPage : UserControl
    {
        public MainPage()
        {
            InitializeComponent();
            btnUL.Content = "Upload";
        }

        protected void btnUL_Click(object sender, EventArgs e)
        {
            OpenFileDialog ofd = new OpenFileDialog() { Multiselect = false };

            if ((bool)ofd.ShowDialog()) // If a file is selected
            {
                UploadFile(ofd.File.Name, ofd.File.OpenRead());
            }
        }

        private void UploadFile(string FileName, Stream Data)
        {
            UriBuilder ub = new UriBuilder("http://localhost:64168/Receiver.ashx");
            ub.Query = string.Format("filename={0}", FileName);

            WebClient wc = new WebClient();
            wc.OpenReadCompleted += (sender, e) =>
            {
                PushData(Data, e.Result);
                e.Result.Close();
                Data.Close();
            };
            wc.OpenWriteAsync(ub.Uri);
        }

        private void PushData(Stream Input, Stream Output)
        {
            byte[] buffer = new byte[4096];
            int bytesRead;

            while((bytesRead = Input.Read(buffer, 0, buffer.Length)) != 0)
                Output.Write(buffer, 0, bytesRead);
        }
    }
} 
```

接收器.ashx

```
<%@ WebHandler Language="C#" CodeBehind="Receiver.ashx.cs" Class="MultiSelectFileUploader.Web.Receiver" %>

using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.IO;

public class Receiver : IHttpHandler
{

    public void ProcessRequest(HttpContext context)
    {
        string filename = context.Request.QueryString["filename"].ToString();

        using (FileStream fs = File.Create(context.Server.MapPath("~/Temp/" + filename)))
        {
            SaveFile(context.Request.InputStream, fs);
        }
    }

    private void SaveFile(Stream Stream, FileStream FS)
    {
        byte[] buffer = new byte[4096];
        int bytesRead;
        while ((bytesRead = Stream.Read(buffer, 0, buffer.Length)) != 0)
            FS.Write(buffer, 0, bytesRead);
    }

    public bool IsReusable
    {
        get { return false; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:35:47.547

我很笨...

该行... wc.OpenReadCompleted += (sender, e) =>

应该是... wc.OpenWriteCompleted += (sender, e) =>

# regex - IP 地址的正则表达式

> ID：10903059
> 
> 赞同：0
> 
> 时间：2012-06-05T18:47:04.320
> 
> 标签：regex, perl, pattern-matching, ex

我需要能够搜索日志并获取记录的 IP 地址。示例日志行如下所示：

> [2012-06-05 11:59:52] 通知 [14369] chan_sip.c: 'yy.yy.yy.yyy' 的注册失败 - 找不到匹配的对等体

我需要获取该`yy.yy.yy.yyy`位置中列出的 IP 地址。对于其他日志文件，它们`yy.yy.yy.yyy`将处于不同的位置。

我正在考虑读取每一行，拆分`' '`然后循环通过拆分临时数组 for: `'yy.yy.yy.yyy'`。我只是不知道如何`'yy.yy.yy.yyy'`使用包含的单引号进行模式匹配或正则表达式。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:56:13.307

此正则表达式将匹配您包含在 ' 中的 IP 地址

```
'(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})' 
```

要遍历 perl 中的所有匹配项：

```
while ($subject =~ m/'(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})'/g) {
    # matched text = $&
} 
```

比赛的第 1 组将仅包含 IP，因此没有 '

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:50:15.440

```
while (<>) {
    my ($ip) = $line =~ /for '((?:[0-9]+\.){3}[0-9]+)'/
       or next;

    ... do something with $ip ...
} 
```

# iphone - 3G 连接的 iPhone 是否“可连接”？使用套接字时 3g/wifi 是否透明？

> ID：10903060
> 
> 赞同：0
> 
> 时间：2012-06-05T18:47:08.943
> 
> 标签：iphone, ios, sockets, networking, nat

我想知道您是否可以使用 TCP 套接字通过 3G 连接直接连接到 iPhone，或者是否会出现 NAT 问题。

此外，作为程序员，无论用户使用的是 wifi 还是 3g，通过套接字发送数据对我来说是透明的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:50:18.877

是的，除非您明确检查，否则您永远不会知道其中的区别。但是，如果在蜂窝网络上警告用户或使用较少的数据，显然是一种好习惯，因为您不想吃掉他们的所有数据。

# iphone - 在 CIFilter 中使用 CIColor 中的 CIImage：获取空图像

> ID：10903066
> 
> 赞同：5
> 
> 时间：2012-06-05T18:47:18.720
> 
> 标签：iphone, objective-c, ios, core-image

我正在尝试使用混合模式（如叠加或乘法）创建一个 CIFilter。相关代码：

```
// Let's try a filter here
// Get the data
NSData *imageData = UIImageJPEGRepresentation(image, 0.85);
// Create a CI Image
CIImage *beginImage = [CIImage imageWithData:imageData];
CIImage *overlay = [CIImage imageWithColor:[CIColor colorWithRed:0.7 green:0.75 blue:0.9 alpha:0.75]];
// Create a context
CIContext *context = [CIContext contextWithOptions:nil];
// Create filter
CIFilter *filter = [CIFilter filterWithName:@"CIOverlayBlendMode" 
                                  keysAndValues:@"inputImage", beginImage,
                                                @"inputBackgroundImage", overlay,
                                                nil]; 
```

其他过滤器工作正常（如棕褐色调），但使用需要“inputBackgroundImage”键的过滤器，我得到一个空白/空结果......所以我的背景图像似乎有问题。

如何通过在图像上放置纯色来使用混合模式滤镜？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-14T19:19:36.833

在主题启动器的代码中没问题，应该只有一个修复。

```
NSData *imageData = UIImageJPEGRepresentation(image, 0.85);
// Create a CI Image
CIImage *beginImage = [CIImage imageWithData:imageData];
CIImage *overlay = [CIImage imageWithColor:[CIColor colorWithRed:0.7 green:0.75 blue:0.9 alpha:0.75]];

//You should crop the generated image to beginImage size because generated image's size is infinite. I don't know why, but CIOverlayBlendMode isn't tolerant to infinite size
    overlay = [overlay imageByCroppingToRect:CGRectMake(beginImage.extent.origin.x, beginImage.extent.origin.y, beginImage.extent.size.width, beginImage.extent.size.height)];

// Create a context
CIContext *context = [CIContext contextWithOptions:nil];
// Create filter
CIFilter *filter = [CIFilter filterWithName:@"CIOverlayBlendMode" 
                                      keysAndValues:@"inputImage", beginImage,
                                                    @"inputBackgroundImage", overlay,
                                                    nil]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T16:03:13.410

这有效：

```
//assume beginImage is CIImage you want to tint            
CIImage* outputImage = nil;

//create some blue
CIFilter* blueGenerator = [CIFilter filterWithName:@"CIConstantColorGenerator"];
CIColor* blue = [CIColor colorWithString:@"0.1 0.5 0.8 1.0"];
[blueGenerator setValue:blue forKey:@"inputColor"];
CIImage* blueImage = [blueGenerator valueForKey:@"outputImage"];

//apply a multiply filter
CIFilter* filterm = [CIFilter filterWithName:@"CIMultiplyCompositing"];
[filterm setValue:blueImage forKey:@"inputImage"];
[filterm setValue:beginImage forKey:@"inputBackgroundImage"];
outputImage = [filterm valueForKey:@"outputImage"]; 
```

# ios - Xcode 滑动和删除

> ID：10903070
> 
> 赞同：2
> 
> 时间：2012-06-05T18:47:33.917
> 
> 标签：ios, iphone, xcode

这是我的任务记录器代码。它工作正常，我只想在我的单元格中使用滑动和删除功能。就像您可以在音乐或电子邮件应用程序中执行的操作一样。如何编辑我当前的代码，以便可以滑动添加的每个单元格，然后弹出删除按钮。我已经看过代码示例，但我不明白如何将它集成到我的代码中。

我的.h：

```
#import <UIKit/UIKit.h>

NSString *docPath(void); 

@interface BNRAppDelegate : UIResponder 
<UIApplicationDelegate, UITableViewDataSource>
{

    UITableView *taskTable;
    UITextField *taskField;
    UIButton *insertButton;
    UIButton *clearButton;

    NSMutableArray *tasks;
}

- (void)addTask:(id)sender;
- (void)takeTask:(id)sender;

@property (strong, nonatomic) UIWindow *window;

@end 
```

这是我的.m

```
#import "BNRAppDelegate.h"

NSString *docPath()
{
    NSArray *pathList = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
                                                            NSUserDomainMask,
                                                            YES);
    return [[pathList objectAtIndex:0] stringByAppendingPathComponent:@"data.td" ];
}    

@implementation BNRAppDelegate

@synthesize window = _window;

#pragma mark - Application delegate callbacks

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:                 (NSDictionary *)launchOptions
{
    NSArray *plist = [NSArray arrayWithContentsOfFile:docPath()];
    if (plist)
    {
        tasks = [plist mutableCopy];
    }
    else
    {
        tasks = [[NSMutableArray alloc] init];
    }

    CGRect windowFrame = [[UIScreen mainScreen] bounds];
    UIWindow *theWindow = [[UIWindow alloc] initWithFrame:windowFrame];
    [self setWindow:theWindow];

    CGRect tableFrame = CGRectMake(0, 80, 320, 380);
    CGRect fieldFrame = CGRectMake(5, 40, 180, 31);
    CGRect buttonFrame = CGRectMake(190, 40, 60, 31);
    CGRect clearFrame = CGRectMake(255, 40 , 60, 30); 

    taskTable = [[UITableView alloc] initWithFrame:tableFrame style:UITableViewStylePlain];
    [taskTable setSeparatorStyle:UITableViewCellSeparatorStyleNone];
    [taskTable setDataSource:self];

    taskField = [[UITextField alloc] initWithFrame:fieldFrame];
    [taskField setBorderStyle:UITextBorderStyleRoundedRect];
    [taskField setPlaceholder:@"Type a task, tap Insert"];

    insertButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [insertButton setFrame:buttonFrame];
    [insertButton addTarget:self action:@selector(addTask:) forControlEvents:UIControlEventTouchUpInside];
    [insertButton addTarget:self action:@selector(addButton:) forControlEvents:UIControlEventTouchUpInside];
    [insertButton setTitle:@"Insert" forState:UIControlStateNormal];

    clearButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [clearButton setFrame:clearFrame];
    [clearButton addTarget:self action:@selector(takeTask:)     forControlEvents:UIControlEventTouchUpInside];
    [clearButton setTitle:@"Clear" forState:UIControlStateNormal];

     //For Clear make simular to ^^^ then add void. In Void use the variable t.               

    [[self window] addSubview:taskTable];
    [[self window] addSubview:taskField];
    [[self window] addSubview:insertButton];
    [[self window] addSubview:clearButton];

    [[self window] setBackgroundColor:[UIColor whiteColor]];
    [[self window] makeKeyAndVisible];

    return YES;
}
- (void)addTask:(id)sender
{
    NSString *t=[taskField text];

    if ([t isEqualToString:@""]) {
        return;
    }

    [tasks addObject:t];
    [taskTable reloadData];
    [taskField setText:@""];
    [taskField resignFirstResponder];
} 

- (void)takeTask:(id)sender
{
    //LEARN ABOUT NSMUTABLEARRAYS AND HOW TO TAKE DADA FROM THEM
    [tasks removeAllObjects];
    [taskTable reloadData];
    [tasks writeToFile:docPath()
            atomically:YES];
}

#pragma mark - Table View management

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [tasks count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:    (NSIndexPath *)indexPath

{
    UITableViewCell *c= [taskTable dequeueReusableCellWithIdentifier:@"Cell"];

    if (!c) {
        c= [[ UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"Cell"];
    }

    NSString *item = [tasks objectAtIndex:[indexPath row]];
    [[c textLabel] setText:item];

    return c;
} 

- (void)applicationDidEnterBackground:(UIApplication *)application
{
    [tasks writeToFile:docPath()
            atomically:YES];
}

- (void)applicationWillTerminate:(UIApplication *)application
{
    [tasks writeToFile:docPath()
            atomically:YES];
}

@end 
```

这是我正在尝试的，但它不起作用：

```
-(void)tableView:(UITableView *)table commitEditingStyle:       (UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:  (NSIndexPath *)indexPath 
{    
    if (editingStyle == UITableViewCellEditingStyleDelete) 
    {
          [tasks removeObjectAtIndex:indexPath.row];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:11:30.880

在您的代码中，添加以下函数

```
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath 
{
    return YES;
} 
```

和

```
- (void)tableView:(UITableView *)table commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath 
{    
    if (editingStyle == UITableViewCellEditingStyleDelete) 
    {
         //Go ahead and delete the row data now
    }
} 
```

在函数 commitEditingStyle 中，您现在必须删除实际的单元格数据 例如，如果您有一个包含单元格数据的 NSMutableArray 您现在必须从中删除实际的对象，如下所示 [arr removeObjectAtIndex:indexPath.row];

# java - RESTful Webservice 无法正确处理请求方法

> ID：10903073
> 
> 赞同：2
> 
> 时间：2012-06-05T18:47:38.727
> 
> 标签：java, rest, request, jax-rs

我正在从多个 RESTful Web 服务方法中检索值。在这种情况下，由于请求方法的问题，两种方法相互干扰。

```
@GET
@Path("/person/{name}")
@Produces("application/xml")
public Person getPerson(@PathParam("name") String name) {
    System.out.println("@GET /person/" + name);
    return people.byName(name);
}

@POST
@Path("/person")
@Consumes("application/xml")
public void createPerson(Person person) {
    System.out.println("@POST /person");
    System.out.println(person.getId() + ": " + person.getName());
    people.add(person);
} 
```

当我尝试使用以下代码调用 createPerson() 方法时，我的 Glassfish 服务器将导致“@GET /person/ **the name I'm trying to create a person on** ”。这意味着调用了 @GET 方法，即使我没有发送 {name} 参数（如您在代码中所见）。

```
URL url = new URL("http://localhost:8080/RESTfulService/service/person");
HttpURLConnection connection = (HttpURLConnection) url.openConnection();
connection.setRequestMethod("POST");
connection.setRequestProperty("Accept", "application/xml");
connection.setDoOutput(true);
marshaller.marshal(person, connection.getOutputStream()); 
```

我知道这要求对我的代码进行大量挖掘，但在这种情况下我做错了什么？

**更新**

因为createPerson 是一个void，所以我不处理connection.getInputStream()。这实际上似乎导致我的服务未处理该请求。

但是实际的请求是在 connection.getOutputStream() 上发送的，对吧？

**更新 2**

RequestMethod 确实有效，只要我处理带有返回值的方法，因此使用 connection.getOutputStream()。当我尝试调用 void 并因此不处理 connection.getOutputStream() 时，服务将不会收到任何请求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T01:17:08.790

您应该设置“Content-Type”而不是“Accept”标头。Content-Type 指定发送给接收者的媒体类型，而 Accept 是关于客户端接受的媒体类型。有关标头的更多详细信息，请参见[此处](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)。

这是Java客户端：

```
public static void main(String[] args) throws Exception {
    String data = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><person><name>1234567</name></person>";
    URL url = new URL("http://localhost:8080/RESTfulService/service/person");
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();
    connection.setRequestMethod("POST");
    connection.setRequestProperty("Content-Type", "application/xml");

    connection.setDoOutput(true);
    connection.setDoInput(true);        

    OutputStreamWriter wr = new OutputStreamWriter(connection.getOutputStream());
    wr.write(data);
    wr.flush();

    // Get the response
    BufferedReader rd = new BufferedReader(new InputStreamReader(connection.getInputStream()));
    wr.close();
    rd.close();

    connection.disconnect();
} 
```

使用 curl 也是如此：

```
curl -X POST -d @person --header "Content-Type:application/xml" http://localhost:8080/RESTfulService/service/person 
```

，其中“人”是包含 xml 的文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><person><name>1234567</name></person> 
```

# php - 在 MD 数组中用 php 解析复杂的 xml

> ID：10903074
> 
> 赞同：0
> 
> 时间：2012-06-05T18:47:39.500
> 
> 标签：php, xml, arrays, parsing

我一直在寻找这个，但似乎无法找到答案。我有一个相当复杂的 XML 文档，需要用 PHP 进行解析。XML 的结构如下所示：

```
<root>

<main id="1"> *some data*

<sub id="1"> *some data*
    <sub id="2"> *some data*
        <sub id="3"> *some data*
            <sub id="4"> *some data* </sub>
            <sub id="5"> *some data* </sub>
        </sub>
    </sub>
</sub>

</main>

</root> 
```

将此文档解析为具有相同结构的多维数组非常重要。

然而，有一个问题。没有办法知道第一个标签内有多少子级别，如果有的话。*这个文档是由另一个系统动态创建的，每个主*标签的子结构都不一样。
我尝试使用SimpleXMLElement，但它只解析第一级，即*主*标签和第一*个子*标签之间的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:51:42.077

尝试[`simplexml_load_string()`](http://php.net/simplexml_load_string)：

```
<?php
$string = <<<XML
<?xml version='1.0'?> 
<document>
 <title>Forty What?</title>
 <from>Joe</from>
 <to>Jane</to>
 <body>
  I know that's the answer -- but what's the question?
 </body>
</document>
XML;

$xml = simplexml_load_string($string);

print_r($xml); 
```

不管你有多少级别或结构是什么......只要它有效，你就会得到一个可以使用的对象。

# android - 从父 Activity 调用 Fragment 方法

> ID：10903077
> 
> 赞同：133
> 
> 时间：2012-06-05T18:47:52.370
> 
> 标签：android, android-fragments

我在[Android Fragments Dev Guide](http://developer.android.com/guide/topics/fundamentals/fragments.html)`findFragmentById()`中看到“活动可以通过从 FragmentManager 获取对 Fragment 的引用，使用or来调用片段中的方法`findFragmentByTag()`。”

下面的示例展示了如何获取片段引用，但不展示如何调用片段中的特定方法。

谁能举例说明如何做到这一点？我想从父 Activity 调用 Fragment 中的特定方法。谢谢。

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2012-06-05T18:51:48.673

没有得到这个问题，因为它太简单了：

```
ExampleFragment fragment = (ExampleFragment) getFragmentManager().findFragmentById(R.id.example_fragment);
fragment.<specific_function_name>(); 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2014-08-20T23:51:16.877

如果你使用“import android.app.Fragment;” 然后使用：

1)

```
ExampleFragment fragment = (ExampleFragment) getFragmentManager().findFragmentById(R.id.example_fragment); 
fragment.specific_function_name(); 
```

其中 R.id.example_fragment 很可能是 xml 布局中的 FrameLayout id。或者

2)

```
ExampleFragment fragment = (ExampleFragment) getFragmentManager().findFragmentByTag(“FragTagName”); 
fragment.specific_function_name(); 
```

其中 FragTagName 是您指定的名称：

```
TabHost mTabHost.newTabSpec(“FragTagName”) 
```

* * *

如果您使用“import android.support.v4.app.Fragment;” 然后使用：

1)

```
ExampleFragment fragment = (ExampleFragment) getSupportFragmentManager().findFragmentById(R.id.example_fragment); 
fragment.specific_function_name(); 
```

或者

2)

```
ExampleFragment fragment = (ExampleFragment) getSupportFragmentManager().findFragmentByTag(“FragTagName”); 
fragment.specific_function_name(); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-06-11T23:26:54.590

如果您使用的是支持库，则需要执行以下操作：

```
FragmentManager manager = getSupportFragmentManager();
Fragment fragment = manager.findFragmentById(R.id.my_fragment);
fragment.myMethod(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-12-14T07:22:51.693

1.  如果您没有使用支持库 Fragment，请执行以下操作：

`((FragmentName) getFragmentManager().findFragmentById(R.id.fragment_id)).methodName();`

2\. 如果您使用的是支持库 Fragment，请执行以下操作：

`((FragmentName) getSupportFragmentManager().findFragmentById(R.id.fragment_id)).methodName();`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-09-08T06:26:47.190

**从片段到活动：**

```
((YourActivityClassName)getActivity()).yourPublicMethod(); 
```

**从活动到片段：**

FragmentManager fm = getSupportFragmentManager();

```
//if you added fragment via layout xml
YourFragmentClass fragment = 
(YourFragmentClass)fm.findFragmentById(R.id.your_fragment_id);
fragment.yourPublicMethod(); 
```

如果您通过代码添加片段并在添加片段时使用了**标签**字符串，请改用**findFragmentByTag**：

```
YourFragmentClass fragment = (YourFragmentClass)fm.findFragmentByTag("yourTag"); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-03-06T00:32:08.883

我认为最好是在调用片段中的方法之前检查是否添加了片段。做这样的事情来避免空异常。

```
ExampleFragment fragment = (ExampleFragment) getFragmentManager().findFragmentById(R.id.example_fragment);
if(fragment.isAdded()){
  fragment.<specific_function_name>(); 
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-09-16T13:13:33.947

您还可以使用类似的接口调用片段方法

首先你创建界面

```
public interface InterfaceName {
    void methodName();
} 
```

创建接口后，您在片段中实现接口

```
MyFragment extends Fragment implements InterfaceName {
    @overide
    void methodName() {

    }
} 
```

并且您在活动中创建接口的引用

```
class Activityname extends AppCompatActivity {
    Button click;
    MyFragment fragment;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity);

        click = findViewById(R.id.button);

        fragment = new MyFragment();

        click.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
               fragment.methodName();
            }
        });
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2021-09-30T20:34:53.383

这个问题太迟了，但这是获取片段实例和调用片段中的方法的简单方法；您必须获取片段的实例，然后调用您的公共方法：

在您的片段中：

```
 private static yourFragment instance; 
```

然后在`onCreateView`你的片段中：

```
 @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, 
   Bundle savedInstanceState) {

        instance= this;

        View v = inflater.inflate(R.layout.fragment_tools, container, false);
        binding = FragmentToolsBinding.inflate(inflater, container, false);

        return v;
    } 
```

而且在你的片段中，你必须有一个返回实例的静态方法：

```
public static yourFragment GetInstance()
{
    return instance;
} 
```

那么你的片段中有一个公共方法，你想这样调用它：

```
public  void  theMethod()
{
    Toast.makeText(getActivity(), "Test", Toast.LENGTH_SHORT).show();
} 
```

然后您可以获取片段实例并像这样调用您的非静态公共方法：

```
 yourFragment frag = yourFragment.GetInstance();
   frag.theMethod(); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-09-16T11:10:37.317

首先你创建你`fragment`喜欢的方法

```
public void name()
{

} 
```

在你的`activity`你添加这个

添加`onCreate()`方法

```
myfragment fragment=new myfragment() 
```

最后调用你想调用的方法添加这个

```
fragment.method_name(); 
```

试试这个代码

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-09-20T11:07:32.173

```
FragmentManager fm = getFragmentManager(); 
MainFragment frag = (MainFragment)fm.findFragmentById(R.id.main_fragment); 
frag.<specific_function_name>(); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-03-05T14:07:46.683

我不知道`Java`，但在`C#`(Xamarin.Android) 中，每次需要调用该方法时都无需查找片段，见下文：

```
public class BrandActivity : Activity
{
    MyFragment myFragment;

    protected override void OnCreate(Bundle bundle)
    {       
        // ...
        myFragment = new MyFragment();      
        // ...
    }

    void someMethod()
    {
        myFragment.MyPublicMethod();
    }
}

public class MyFragment : Android.Support.V4.App.Fragment
{
    public override void OnCreate(Bundle bundle)
    {
        // ...
    }

    public override View OnCreateView(LayoutInflater inflater, ViewGroup container, Bundle bundle)
    {
        // ...
    }

    public void MyPublicMethod()
    {
        // ...
    }   
} 
```

我认为`Java`你也可以这样做。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-11T07:51:24.717

```
((HomesFragment)getSupportFragmentManager().findFragmentById(R.id.fragment_container)).filterValidation(); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-09-18T22:03:23.657

这个问题为时已晚，但无论如何都会为任何仍然需要它的人发布我的答案。我找到了一种更简单的方法来实现这一点，而无需使用片段 ID 或片段标签，因为这正是我所寻求的。

首先，我在 ParentActivity 类中声明了我的 Fragment：

```
MyFragment myFragment; 
```

像往常一样初始化我的 viewPager，使用我已经在上面的类中添加的片段。然后，在 myFragment 中创建了一个名为**scrollToTop**的公共方法，该方法执行我想要从 ParentActivity 执行的操作，假设将我的 recyclerview 滚动到顶部。

```
public void scrollToTop(){
    mMainRecyclerView.smoothScrollToPosition(0);
} 
```

现在，在 ParentActivity 我调用了如下方法：

```
try{
   myFragment.scrollToTop();
}catch (Exception e){
   e.printStackTrace();
} 
```

# javascript - Jquery 可以将音频播客提要解析为 HTML5 吗？

> ID：10903079
> 
> 赞同：3
> 
> 时间：2012-06-05T18:48:03.043
> 
> 标签：javascript, jquery, html, audio, rss

我发现了几种使用 jQuery 提取博客提要的方法，但它们适用于文本博客而不是音频播客。我在学习 jQuery（自学）方面真的很挣扎。我还找到了解析为 XML 的方法，但我还没有找到解析 HTML5 的基于非 Flash 的播客播放器。将 mp3 添加到网页本身是多余的，超出了客户的技术专长。

它需要随着新播客的添加而动态更新，并且需要访问已在此提要上发布的每个播客。

请帮我。执行此操作的代码会是什么样子。或者是否有任何教程可以教我如何创建它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:57:03.830

你实际上并不需要 jQuery，但它使用它的内置 XML 解析器确实可以加快速度。

[`<audio>`](http://html5doctor.com/native-audio-in-the-browser/)标记使用几种不同的格式，具体取决于浏览器。为了实现交叉兼容性，您需要拥有所有 3 种格式才能使标签工作，但至少，您只需要 ogg 和 mp3。

对于播放列表，您可以为音频源提供一组 url。为此，您需要一个 3d 结构。

例如，一个 3d 数组对象结构：

```
var sources = [
    { //audio 1
        'mp3':...,
        'ogg':...,
        'wav':...
    },
    { //audio 2
        'mp3':...,
        'ogg':...,
        'wav':...
    },
    ...
]; 
```

由于 sources 是一个数组，您可以使用它`array.push()`来追加一个新项目，或添加`array.unshift()`一个项目：

```
//add to the end of the array
sources.push({ 
    'mp3':...,
    'ogg':...,
    'wav':...
});

//add to beginning of array
sources.unshift({ 
    'mp3':...,
    'ogg':...,
    'wav':...
}); 
```

# visual-c++ - c++和cplex之间的连接

> ID：10903080
> 
> 赞同：1
> 
> 时间：2012-06-05T18:48:05.833
> 
> 标签：visual-c++

我或多或少是编程的初学者。我需要在 c++ 和 CPLEX 之间建立连接。我不知道我该怎么做。如果大家能帮助我或介绍一些链接，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:10:01.607

Concert 是一组 C++、Java 和 .NET 库，可让您顺利连接到 cplex。不太了解 C++ API，但我已经广泛使用 Java API，而且它非常简单。

查看 API 和本[教程](http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r2/index.jsp?topic=/ilog.odms.cplex.help/Content/Optimization/Documentation/CPLEX/_pubskel/CPLEX86.html)。如果您有任何具体问题，请告诉我们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:30:28.443

基本上你有两种选择：

**1) 使用音乐会技术**

Concert Technology 是一组复杂的类，使您能够以一种独特的方式编写模型。它适用于 C++，非常方便。尽管使用 Java 或 C# 可能更容易处理。

[IBM 的 Concert 技术教程](http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r2/index.jsp?topic=/ilog.odms.cplex.help/Content/Optimization/Documentation/CPLEX/_pubskel/CPLEX86.html)

**2）使用可调用库**

可调用库不是面向对象的，但你可以用它做任何事情。它拥有大量用于构建、修改和求解模型的功能。您只需要 cplex.dll 和一些用于类型和函数声明的头文件。它不如 Concert 方便，您必须“手动”做更多的事情，但您可以完全控制自己在做什么。可调用库也适用于 C。

[IBM 的可调用库教程](http://pic.dhe.ibm.com/infocenter/cosinfoc/v12r2/index.jsp?topic=/ilog.odms.cplex.help/Content/Optimization/Documentation/CPLEX/_pubskel/CPLEX86.html)

# php - 比较php中的两个字符串并显示字符差异

> ID：10903082
> 
> 赞同：8
> 
> 时间：2012-06-05T18:48:15.340
> 
> 标签：php, string, compare, character, match

嗨，我正在努力做到这一点：

我想比较两个字符串并在 php 中计算它们的分数。

这意味着我有两个字符串：

$string1="example1"; $string2="exumple22";

现在我想比较字符串是否相等 - 在这种情况下它们不是。

但另外我想看看匹配的字符。至少数一数。

在这种情况下，这将是：6；

我已经尝试过了，但我被困住了，她就是我的例子：

```
enter code here
<?  
include("connect.php");
$query="SELECT * FROM data where ID = '1'";
$result = mysql_query($query) or die(mysql_error());

while($row = mysql_fetch_array($result))
{
    //echo "Score :{$row['scoreA']} <br>" ;
    $scoretemp=$row['scoreA'];
    $string1=$row['textA1'];
    $string2=$row['textA2'];

} 
mysql_close();

if (strcmp($string1, $string2) != 0){
    echo "not equal in a case-sensitive string comparison <br>";
$j = strlen($string1);
    for ($i = 0; $i < $j; $i++) {
    $stringtemp1++;
    echo $string1[$i].', ';
    echo $stringtemp1;
    }    

    $u = strlen($string2);
    for ($t = 0; $t < $u; $t++) {
    $stringtemp2++;
    echo $string2[$t].', ';
    echo $stringtemp2;
    }$scoreA=($stringtemp1 - $stringtemp2);    
    $stringtemp1=0;$stringtemp2=0;
}
else{
    echo "Stringmatch! <br>";
        $e = strlen($string1);
        for ($r = 0; $r < $e; $r++) {
        $stringtemp1++;
        echo $string1[$r].', ';
        echo $stringtemp1;
}$scoreA=$stringtemp1;
$stringtemp1=0;
}
 ?> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-05T18:57:02.753

使用方法见[http://www.php.net/manual/en/function.similar-text.php](http://www.php.net/manual/en/function.similar-text.php)`similar_text($str1, $str2)`

这将为您提供两个字符串中匹配字符的数量。

```
<?php
    echo similar_text("Hello World","Hello Peter");
?> 
```

会给你 7（共同的字符数）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-09-21T07:47:56.470

尝试这个

```
<?php

$string1 = 'example1';
$string2 = 'exumple22';

$matchingcharacters = [];
$mismatchingcharacters = [];

$len1 = strlen($string1);
$len2 = strlen($string2);

$similarity = $i = $j = $dissimilarity = 0;

while (($i < $len1) && isset($string2[$j])) {
    if ($string1[$i] == $string2[$j]) {
        $similarity++;
        $matchingcharacters[] = '['.$string1[$i].']';
    } else {
        $dissimilarity++;
        $mismatchingcharacters[] = '['.$string1[$i] . " & " . $string2[$j].']';
    }
    $i++;
    $j++;
}
echo 'First string : '.$string1.'<br>';
echo 'Second string : '.$string2.'<br>';
echo 'Similarity : ' . $similarity . '<br>';
echo 'Dissimilarity : ' . $dissimilarity . '<br>';
echo 'Matching characters : ' . implode(",", $matchingcharacters) . '<br>';
echo 'Mismatching characters : ' . implode(",", $mismatchingcharacters); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T18:52:49.997

您可以计算 2 个字符串之间的[levenshtein](http://php.net/manual/en/function.levenshtein.php)距离：

> 在其最简单的形式中，该函数将仅将两个字符串作为参数，并将仅计算将 str1 转换为 str2 所需的插入、替换和删除操作的数量。

# c# - c# winforms如何重复字符串数组成员？

> ID：10903083
> 
> 赞同：0
> 
> 时间：2012-06-05T18:48:16.770
> 
> 标签：c#, winforms, datagridview, arrays

首先，我需要从`DataGridView.SelectedCells.Values`. 然后我需要将该字符串附加到自身，直到`member.count`达到限制。例如，如果

```
string [] = {"a", "b", "c"};  // Where abc are selectedCells.Values. 
```

新的字符串 [] 应该是：

`{"a", "b", "c", "a", "b", "c", "a", "b"}`

*   例如，如果限制为 8。

请问我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:04:38.227

您可以`%`在 for 循环中使用 (Modulus)。

```
string[] oldArr = new string[3] {"a","b","c"};
string[] newArr = new string[8];
int limit = 8;
for ( int i = 0 ; i < limit ; i++ )
{
    newArr[i] = oldArr[i%oldArr.Length];
} 
```

就是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T18:53:03.287

只需为原始数组索引保留一个单独的计数器。就像是：

```
string[] strings = new string[] { "a", "b", "c" };
string[] final = new string[8];

int index = 0;
for(int i = 0;i < 8;++i)
{
    final[i] = strings[index];
    index = (index + 1) % strings.Length;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:01:31.857

您可以尝试使用类似的东西

```
int yourLimit = 8;
int yourIndexer = 0;
string[] strArr = new string[3] { "a", "b", "c" };
List<string> list = new List<string>();
foreach (DataGridViewCell cell in dataGridView1.SelectedCells)
{
    if (strArr.Contains(cell.Value.ToString()) && yourIndexer < yourLimit)
        list.Add(cell.Value.ToString());
    yourIndexer++;
}
string[] strNewArr = list.ToArray<string>(); 
```

我希望这有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T19:22:06.133

此版本用于`Array.Copy`复制。

```
 {
        int N=10;
        string[] strings=new string[] { "a", "b", "c" };
        int L=strings.Length;

        int R = (int) Math.Ceiling(N/(1.0*L));
        string[] result=new string[N];
        for(int index=0; index<R; index++)
        {
            int offset = index*L;
            Array.Copy(strings, 0, result, offset, Math.Min(L, N-offset));
        }
    } 
```

# javascript - 溢出-x：可见；不适用于溢出-y：自动；任何解决方法？

> ID：10903084
> 
> 赞同：39
> 
> 时间：2012-06-05T18:48:21.130
> 
> 标签：javascript, css, overflow

我在尝试

```
.item {
   width: 100px;
   overflow-x: visible;
   overflow-y: auto;
} 
```

但是垂直溢出：自动似乎覆盖了水平的

小提琴：http: [//jsfiddle.net/xcUTV/](http://jsfiddle.net/xcUTV/)

有什么解决方法吗？即使有一点 javascript

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-06T05:04:02.543

你不能，这是写在规范中的。

看看这里：[https ://stackoverflow.com/a/6433475/1343096](https://stackoverflow.com/a/6433475/1343096)

由于它是写在规范中的，我有 99% 的把握这是不可能的。

# android - OSGi - Activator 无法访问 Bundle 的内部包

> ID：10903087
> 
> 赞同：0
> 
> 时间：2012-06-05T18:48:31.950
> 
> 标签：android, eclipse, osgi, noclassdeffounderror, emf

我正在尝试在 Apache Felix 上运行一个基于 EMF 的小型应用程序。Felix 在 Android 设备上运行。我正在使用 Eclipse，但没有 bnd 和 maven。

我有一个 EMF Bundle，它可以导出以下软件包：

```
org.eclipse.emf.common_droid-2.7.0.v20120127-1122.jar
org.eclipse.emf.ecore_droid-2.7.0.v20120127-1122.jar
org.eclipse.emf.ecore.xmi_droid-2.7.0.v20120127-1122.jar 
```

我的插件项目的结构：

```
[+] src
---> com.androidosgi.notifier
---> com.androidosgi.notifier.notification
---> com.androidosgi.notifier.notification.impl
---> com.androidosgi.notifier.notification.util
[+] META-INF
---> MANIFEST.MF
Notification-1.0.ecore
Notification-1.0.ecorediag
Notification-1.0.ecorert
NotificationComponent.xmi 
```

激活器位于 com.androidosgi.notifier 中。

清单.MF：

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Bundle-Name: Notification Testing
Bundle-SymbolicName: com.androidosgi.notifier
Bundle-Version: 12.6.5
Bundle-Activator: com.androidosgi.notifier.Activator
Bundle-Vendor: Homer Simpson
Import-Package: 
 com.androidosgi.notifier.notification,
 com.androidosgi.notifier.notification.impl,
 com.androidosgi.notifier.notification.util,
 org.eclipse.emf.common,
 org.eclipse.emf.common.archive,
 org.eclipse.emf.common.command,
 org.eclipse.emf.common.notify,
 org.eclipse.emf.common.notify.impl,
 org.eclipse.emf.common.util,
 org.eclipse.emf.ecore,
 org.eclipse.emf.ecore.impl,
 org.eclipse.emf.ecore.plugin,
 org.eclipse.emf.ecore.resource,
 org.eclipse.emf.ecore.resource.impl,
 org.eclipse.emf.ecore.util,
 org.eclipse.emf.ecore.xmi,
 org.eclipse.emf.ecore.xmi.impl,
 org.eclipse.emf.ecore.xmi.util,
 org.eclipse.emf.ecore.xml.namespace,
 org.eclipse.emf.ecore.xml.namespace.impl,
 org.eclipse.emf.ecore.xml.namespace.util,
 org.eclipse.emf.ecore.xml.type,
 org.eclipse.emf.ecore.xml.type.impl,
 org.eclipse.emf.ecore.xml.type.internal,
 org.eclipse.emf.ecore.xml.type.util,
 org.osgi.framework;version="1.3.0"
Bundle-ClassPath: .
Export-Package: com.androidosgi.notifier;x-internal:=true,
 com.androidosgi.notifier.notification;x-internal:=true,
 com.androidosgi.notifier.notification.impl;x-internal:=true,
 com.androidosgi.notifier.notification.util;x-internal:=true 
```

在我在 OSGi 上安装包之前，我对其进行了“索引化”并将 classes.dex 添加到包中。

如果我尝试开始，我会得到：NoClassDefFoundError ![在此处输入图像描述](../Images/c442ef1614583ac2464f8a0d33870ef0.png)

任何想法或解决方案？：） 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T10:21:38.473

好的 50% 完成了 ;-) 它正在计算机上运行（Java 1.6）（但仍然不在 Android 上）！在我的情况下，由于缺少版本控制内容而导致 NoClassDefFoundError 错误。我在导出的 EMF-Bundle(b1) 中的每个包中添加了版本。我还在导入的 Notifier-Bundle(b2) 中添加了每个包的版本范围。**看起来这对设置版本非常重要。** 我还删除了：

> com.androidosgi.notifier.notification，com.androidosgi.notifier.notification.impl，com.androidosgi.notifier.notification.util，

从 Bundle(b2) 的导入和所有从 (b2) 的导出。它现在在 Apache Felix 上运行。

呃，我也加了

> 导入包：org.xml.sax.helpers;version="[0.0.0.1_006_JavaSE,3.0.0)"

到 Bundle (b1) 的清单，EMF-Bundle。

我的下一个问题是，android 中标准 systembundle 的导出似乎与普通计算机上的不同（使用命令“headers”来查找）。我将为此开始一个新问题，并在此处发布链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:01:22.940

EMF 不会在 Felix 或除 Equinox 之外的任何 OSGi 框架上运行。请参阅我很久以前提出的以下错误：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=328227](https://bugs.eclipse.org/bugs/show_bug.cgi?id=328227)

您必须使用正确执行 OSGi 声明的 EMF 重新打包。我在 GitHub 上有这个，但它现在有点陈旧，即它打包了旧版本的 EMF。见：[https ://github.com/njbartlett/emf-osgi](https://github.com/njbartlett/emf-osgi)

**更新**：我太仓促了，这可能不是正确的答案。看起来你已经重新打包了 EMF。

我怀疑答案是你正在导入包`com.androidosgi.notifier.notification`及其子包，但这些可能是你的包中的包。你不应该导入实际上是你的包的一部分的包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T07:39:45.263

我想您已经检查了明显的事情： * 捆绑包中存在类 NotificationFactory * 名称和路径中没有拼写错误 * 该类不在内部 jar 或类似的东西中 * 激活器已成功找到系统？* 你试过删除导入吗？

我可以建议检查的唯一更奇怪的事情是问题是否不在于 NotificationFactory 本身，而在于它使用的某些类。我在其他设置中遇到过这样的情况，其中 ClassNotFound 实际上是针对报告类中的另一个类。

例如，尝试在 com.androidosgi.notifier.notification 包中移动激活器 - 就像检查它是否会被找到。通过这种方式，您将知道问题出在包还是类本身。

# ios - Any techniques / tools for simulating server and/or network unresponsiveness and network timeouts etc.?

> ID：10903094
> 
> 赞同：3
> 
> 时间：2012-06-05T18:49:01.173
> 
> 标签：ios, xcode

I have network handling code in my app (using NSURLConnection/NSURLRequest) and I would like to test how its behaving when the timeout for the connection expires before its received a response.

Any there any techniques/tools for simulating this on the simulator and device?

(NSURLRequest apparently does not allow a very short time out to be set, i.e. one second, but I have yet to check if this is indeed the case)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:57:32.900

I would recommend using Charles Proxy. This application is a swiss-army knife tool set for any application that uses HTTP communication. You can adjust throttling speed (potentially long enough to trigger tour timeout) as well as mapping remote hosts to a local server (and vice-versa). There are a ton of options and tools - and I find it very useful.

[http://www.charlesproxy.com/](http://www.charlesproxy.com/)

# jquery - 使用jquery验证的远程功能

> ID：10903100
> 
> 赞同：12
> 
> 时间：2012-06-05T18:49:26.447
> 
> 标签：jquery, jquery-validate

我想弄清楚我怎么能把它变成这样：

```
$('#username').blur(function(){
    $.post('register/isUsernameAvailable', 
           {"username":$('#username').val()}, 
           function(data){
               if(data.username == "found"){
                   alert('username already in use');
               }
           }, 'json');
}); 
```

接近这个：

```
rules: {
        username: {
            minlength: 6,
            maxlength: 12,
            remote: {
                url: 'register/isUsernameAvailable',
                type: 'post',
                data: {
                    'username': $('#username').val()
                } 

            }
        } 
```

但是我很难完成它。我想要的是让它显示错误消息而不是警报，但我可以在实际的 jquery 验证消息中设置消息。

[http://docs.jquery.com/Plugins/Validation/Methods/remote#options](http://docs.jquery.com/Plugins/Validation/Methods/remote#options)

**更新：**

出于某种原因，它没有将其作为 POST 执行，而是将其作为 GET 请求执行，但不知道为什么。这是更新的代码：

```
rules: {
        username: {
            minlength: 6,
            maxlength: 12,
            remote: {
                url: 'register/isUsernameAvailable',
                dataType: 'post',
                data: {
                    'username': $('#username').val()
                },
                success: function(data) {
                    if (data.username == 'found')
                    {
                        message: {
                            username: 'The username is already in use!'
                        }
                    }
                }

            }
        }, 
```

**更新 2：**

现在我已经到了某个地方，我又回到了获取 POST 请求的地方。我还有两个问题。其中之一是要完成另一个 POST 请求，用户必须刷新表单。最后一个问题是，如果找到返回的用户名，它不会显示错误消息。

```
rules: {
        username: {
            minlength: 6,
            maxlength: 12,
            remote: {
                type: 'post',
                url: 'register/isUsernameAvailable',
                data: {
                    'username': $('#username').val()
                },
                dataType: 'json',
                success: function(data) {
                    if (data.username == 'found')
                    {
                        message: {
                            username: 'The username is already in use!'
                        }
                    }
                }

            }
        }, 
```

**更新：**

```
public function isUsernameAvailable()
{
    if ($this->usersmodel->isUsernameAvailable($this->input->post('username')))
    {
        return false;
    }
    else
    {
        return true;
    }        
} 
```

**更新 4：**

控制器：

```
public function isUsernameAvailable()
{
    if ($this->usersmodel->isUsernameAvailable($this->input->post('username')))
    {
        return false;
    }
    else
    {
        return true;
    }        
}

public function isEmailAvailable()
{
    if ($this->usersmodel->isEmailAvailable($this->input->post('emailAddress')))
    {
        return false;
    }
    else
    {
        return true;
    }        
} 
```

模型：

```
/**
 * Check if username available for registering
 *
 * @param   string
 * @return  bool
 */
function isUsernameAvailable($username)
{
    $this->db->select('username');
    $this->db->where('LOWER(username)=', strtolower($username));
    $query = $this->db->get($this->usersTable);
    if ($query->num_rows() == 0)
    {
        return true;
    }
    else
    {
        return false;
    }
}

/**
 * Check if email available for registering
 *
 * @param   string
 * @return  bool
 */
function isEmailAvailable($email)
{
    $this->db->select('email');
    $this->db->where('LOWER(email)=', strtolower($email));
    $query = $this->db->get($this->usersTable);
    if($query->num_rows() == 0)
    {
        return true;
    }
    else
    {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-05T21:21:18.003

完成此操作的最简单方法是简单地将`true`错误消息作为字符串返回，或者`false`从您的服务器端资源返回。根据[远程的jQuery验证文档](http://docs.jquery.com/Plugins/Validation/Methods/remote)：

> 响应被评估为 JSON 并且对于有效元素必须为 true，并且对于无效元素可以是任何 false、未定义或 null，使用默认消息；或字符串，例如。“该名称已被占用，请尝试 peter123”以显示为错误消息。

这意味着如果您可以更改服务器端代码以`true`在验证成功时返回或在验证不成功时更改错误消息（“用户名已在使用”），您只需编写以下远程规则：

```
remote: {
    type: 'post',
    url: 'register/isUsernameAvailable',
    data: {
        'username': function () { return $('#username').val(); }
    },
    dataType: 'json'
} 
```

您也可以简单地从服务器端资源返回`true`或返回并在客户端上定义错误消息。`false`在这种情况下，您将拥有上述规则，然后是`messages`对象中的一个属性：

```
messages: {
    username: {
        remote: "username already in use"
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-09-09T17:00:59.033

我知道为时已晚，但这可以帮助其他人。

远程方法旨在接收 Json 字符串，因此您的服务器端应该向该方法返回类似的内容...

```
echo(json_encode(true)); // if there's nothing matching
echo(json_encode(false)); 
```

这是我在尝试验证用户昵称时编写的 JS 代码示例。

```
$(document).ready(function(){
            $('#form').validate({
            rules: {
                user_nickname: {
                    remote: {
                        url: "available.php",
                        type: "post",
                        data: {
                          user_nickname: function() {
                            return $( "#user_nickname" ).val();
                          }
                        }
                      }               
                }
            },
            messages:{
                user_nickname: {
                    remote: "Username already taken"
                }
            }
        });}); 
```

希望它可以帮助某人，它帮助了我。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-03-18T19:40:15.833

我意识到这已经过时了，但我很难让它也能正常工作，并想分享对我有用的东西。

客户端表单验证代码：

```
$('#frmAddNew').validate({
onkeyup: false,
rules: {
    ADID: {
        required: true,
        alphanumeric: true,
        maxlength: 10,
        remote: {
            url: "ADIDValidation.cshtml",
            type: "post",
            dataType: "json",
            dataFilter: function (data) {
                if (data) {
                    var json = $.parseJSON(data);
                    if (json[0]) {
                        return JSON.stringify(json[0].valid) /* will be "true" or whatever the error message is */
                    }
                }
            },
            complete: function (data) {
               /* Additional code to run if the element passes validation */
                if (data) {
                    var json = $.parseJSON(data.responseText);
                    if (json[0]) {
                        if (json[0].valid === "true") {
                            $('#FirstName').val(json[0].FirstName);
                            $('#LastName').val(json[0].LastName);
                        }
                    }
                }
            }
        }
    }
},
messages: {
    ADID: {
        required: "Please Enter an ADID of the Employee",
        alphanumeric: "The ADID Can Only Contain Letters and Numbers",
        maxlength: "ADID For User's Current Permissions Must Be 10 Characters or Less"
    }
},
submitHandler: function (form) {
    form.submit();
},
errorContainer: $('section.errorCon'),
errorLabelContainer: $('ol', 'section.errorCon'),
wrapper: 'li',
showErrors: function (errors) {
    var error = this.numberOfInvalids();
    var message = error == 1
        ? 'You missed 1 field:'
        : 'You missed ' + error + ' fields:';
    $('section.errorCon h3').html(message);
    this.defaultShowErrors();
}
}); 
```

ADIDValidation.cshtml 的服务器端代码（我正在使用 Razor 网页）：

```
@{

Layout = null;

if(IsPost)
{
    var db = Database.Open("<enter connection name>");
    var sql = "<enter sql or stored procedure>";
    var strADID = Request["ADID"];

    var result = db.Query(sql, strADID);
    IEnumerable<dynamic> response;

    if(result.Any()) 
    {
        @* "true" indicates the element passes validation. Additional data can be passed to a callback function *@
        response = result.Select(x => new
        {
            valid = "true",
            FirstName = x.FirstName,
            LastName = x.LastName
        });
    }

    else
    {
        @* The element did not pass validation, the message below will be used as the error message *@
        response = new[] {
            new {valid = "The Employee's ADID '" + strADID.ToString() + "' Is Not Valid. Please Correct and Resubmit"}
        };
    }

    Json.Write(response, Response.Output);
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-15T13:27:43.377

我最近需要在 Rails 项目中进行远程验证，如果输入无效，我很难从服务器端发送正确的响应。最后，解决方案非常简单。

如果服务器端检查返回 true，您可以发送 true 或“true”，否则您可以返回任何字符串，例如“电子邮件已存在”或“电子邮件没有有效的 MX 记录”。此字符串将显示为表单上的验证消息。唯一的问题是从服务器端返回的消息字符串应该是有效的 JSON，并且应该是这种格式 - [“电子邮件已经存在”]。

关于我如何调试并找到解决方案的一些解释：请参阅下面的 jquery.validate.js 中的远程方法。我在 ajax 调用中添加了日志语句和错误函数以进行调试。当我从服务器端返回一个普通字符串时，抛出了一个 jQuery.parseJson 错误。

```
// http://jqueryvalidation.org/remote-method/

remote: function( value, element, param ) {
    if ( this.optional( element ) ) {
        return "dependency-mismatch";
    }

    var previous = this.previousValue( element ),
        validator, data;

    if (!this.settings.messages[ element.name ] ) {
        this.settings.messages[ element.name ] = {};
    }
    previous.originalMessage = this.settings.messages[ element.name ].remote;
    this.settings.messages[ element.name ].remote = previous.message;

    param = typeof param === "string" && { url: param } || param;

    if ( previous.old === value ) {
        return previous.valid;
    }

    previous.old = value;
    validator = this;
    this.startRequest( element );
    data = {};
    data[ element.name ] = value;

    $.ajax( $.extend( true, {
        url: param,
        mode: "abort",
        port: "validate" + element.name,
        dataType: "json",
        data: data,
        context: validator.currentForm,
        success: function( response ) {
            console.log("response is "+response);
            var valid = response === true || response === "true",
                errors, message, submitted;
            console.log("valid is "+valid);
            validator.settings.messages[ element.name ].remote = previous.originalMessage;
            if ( valid ) {
                submitted = validator.formSubmitted;
                validator.prepareElement( element );
                validator.formSubmitted = submitted;
                validator.successList.push( element );
                delete validator.invalid[ element.name ];
                validator.showErrors();
            } else {
                errors = {};
                message = response || validator.defaultMessage( element, "remote" );
                console.log("else message is "+message);
                errors[ element.name ] = previous.message = $.isFunction( message ) ? message( value ) : message;
                validator.invalid[ element.name ] = true;
                console.log("else errors[ element.name ] "+errors[ element.name ]);
                validator.showErrors( errors );
            }
            previous.valid = valid;
            validator.stopRequest( element, valid );
        },
        error: function (xhr, ajaxOptions, thrownError) {
            console.log(xhr.status);
            console.log(thrownError);
        }
    }, param ) );
    return "pending";
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-23T14:12:05.730

```
rules: {
        username: {
            minlength: 6,
            maxlength: 12,
            remote: 'register/isUsernameAvailable',
         }
        } 
```

您需要传递用户名

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-21T16:53:04.617

我想我来不及回复了。但是我们的代码对所有人来说都很容易

验证码

```
rules: {
            session: {
               required: true,
                remote: {
                    url: "<?php echo base_url('setting/session_setting/checkSession'); ?>",
                    type: "post",
                    data: {
                      session: function() {
                        return $( "#sessionInput" ).val();
                      }
                    }
                  }
            },
        }, 
```

控制器代码

```
public function checkSession()
    {
        $response = array();
        $session = $this->input->post('session');

        $check = $this->dm->checkData('session','session',array('session'=>$session));

        if($check)
        {
            echo(json_encode("Session Already Exist")); 
        }
        else
        {
            echo(json_encode(true)); 
        }
    } 
```

型号代码

```
public function checkData($data,$tablename,$where)
    {
        $query = $this->db->select($data)
                 ->from($tablename)
                 ->where($where)
                 ->get();
        if($query->num_rows() > 0)
        {
            return true;
        }
        else
        {
            return false;
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-29T08:24:31.837

```
Jquery Code: 
 rules: {
        email: {
                required: true,
                maxlength: 50,
                email: true,
                 remote: {
        url: "<?php echo base_url('user/email_check') ?>",
        type: "post",
        data: {
          email: function() {
            return $( "#email" ).val();
          }
        }
      }
            },     
    },
     messages: {
      email: {
          required: "E-mailadres",
          email: "Please enter valid email",
          maxlength: "The email name should less than or equal to 50 characters",
          remote: jQuery.validator.format("{0} is already taken.")
        },
    },

PHP Code:
  if($results->num_rows == 0)
    {
        echo "true";  //good to register
    }
    else
    {
        echo "false"; //already registered
    } 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-06-05T19:05:10.980

好吧，我不知道你的插件概念，但我想你希望它检查用户名是否大于 6 或小于 12。从没有插件的 jQuery 核心示例中，它就像添加一样简单一点点 if-else 的概念。

```
$('#username').blur(function(){
    if($('#username').val().length < 6 || $('#username').val().length > 12)
    {
        alert('Username must be between 6 and 12 characters');
    }
    else
    {
       $.post('register/isUsernameAvailable', 
              {"username":$('#username').val()}, 
              function(data){
                  if(data.username == "found"){
                      alert('username already in use');
                  }
              }, 'json');
    }
}); 
```

# python - 通过 GenericSetup 创建的 ATDocument 的自定义视图

> ID：10903101
> 
> 赞同：0
> 
> 时间：2012-06-05T18:49:28.493
> 
> 标签：python, plone, zope, genericsetup

我通过通用设置创建了一个文件夹 ATDocument 类，通用设置 xml 配置文件定义了以下视图变量：

```
<property name="immediate_view">TemplateFileName</property>
<property name="default_view">TemplateFileName_view</property>
<property name="view_methods">
    <element value="TemplateFileName_view"/>
</property> 
```

是否可以用调度程序替换该视图，即 __call__ 上的 BrowserView 类将调度实际的 ViewPagetTemplateFile() 实例？

我尝试用该类的方法名称替换模板文件名，但这似乎不起作用。此外，我通过 ATCTContent 到 BaseContent 遵循了 ATDocument 的继承树，但我没有找到任何视图定义，所以我猜测视图是通过继承的混合组件之一处理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T08:53:00.580

GenericSetup xml 文件中的名称要么是视图名称要么是皮肤项；使用与在 URL 中直接命名视图时相同的遍历机制来查找视图名称。

因此，您可以通过 URL 访问的*任何内容*都可以用作查看方法。这包括在方法中分派给其他视图的视图`__call__`：

```
from zope.publisher.browser import BrowserView
from zope.component import getMultiAdapter

class DispatchingView(BrowserView):
    def __call__(self):
        if somecondition:
            newviewname = 'foo'
        else:
            newviewname = 'bar'

        return getMultiAdapter((self.context, self.request), name=newviewname)() 
```

此示例视图按名称查找其他视图，并将它们呈现在适当的位置以作为调度程序本身的结果返回。

请注意，通常，我确保如果正在使用视图，我会确保在其`@@`名称前面包含视图命名空间，以防止意外使用具有相同名称的皮肤项。

# java - Windows\System32\lpsolve55j.dll：找不到依赖库

> ID：10903103
> 
> 赞同：6
> 
> 时间：2012-06-05T18:49:41.513
> 
> 标签：java, maven, lpsolve

当我尝试使用 LPSolve for Java（mavenized 版本，[http://code.google.com/p/lpsolve-java/source/checkout](http://code.google.com/p/lpsolve-java/source/checkout)）时，出现以下错误：

```
java.lang.UnsatisfiedLinkError: C:\Windows\System32\lpsolve55j.dll: Can't find dependent libraries
     at java.lang.ClassLoader$NativeLibrary.load(Native Method)
     at java.lang.ClassLoader.loadLibrary0(Unknown Source)
     at java.lang.ClassLoader.loadLibrary(Unknown Source)
     at java.lang.Runtime.loadLibrary0(Unknown Source)
     at java.lang.System.loadLibrary(Unknown Source)
     at lpsolve.LpSolve.<clinit>(LpSolve.java:274) 
```

一世

*   将 lpsolve55j.dll 放入 Windows\System32 和
*   将目录 C:\Program Files\LPSolve IDE 添加到 PATH 环境变量中。

该错误发生在eclipse（测试用例）以及“mvn test”执行期间。

这些都没有帮助。

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:19:24.717

我做了以下事情，它似乎工作：

1.  下载了适合我的处理器的开发包（64位）
2.  将存档解压缩到文件夹中
3.  将 lpsolve55j.jar 和 lpsolve55j.dll 复制到步骤 2 的目录中
4.  将步骤 2 中的目录添加到 PATH
5.  将步骤 2 中目录中的 lpsolve55j.jar 包含到我的 java 项目中（作为外部目录）。

现在它起作用了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-02T09:40:39.750

我做了以下事情，它100％有效：

```
Downloaded these two files "lpsolve55.dll" & "lpsolve55j.dll"
Copy these files and paste inside these folders "C:\Program Files\Java\jdk1.6.0_25\bin" and "C:\Program Files\Java\jre6\bin"
Put these two files "lpsolve55.dll" & "lpsolve55j.dll" in your project Folder also. 
```

现在它起作用了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-21T02:54:09.607

对于我的 Windows 64bit maven，我刚刚下载了 lp_solve_5.5.2.5_dev_win64.zip 和 lp_solve_5.5.2.5_java.zip，解压缩它们执行以下两件事：

```
1) add lpsolve55j.jar to maven dependency, in my case it is as follows:
          <dependency>
            <groupId>lpsolver55j</groupId>
            <artifactId>lpsolve55j</artifactId>
            <scope>system</scope>
            <systemPath>${basedir}/lib/lpsolve55j.jar</systemPath>
            <version>55</version>
        </dependency>   
2) put lpsolve55.dll, lpsolve55j.dll into C:\Windows\System32\. Be sure these two dlls are both 64 bit. 
```

然后它工作。解压缩的 lp_solve_5.5.2.5_java 目录的自述文件安装部分中也提到了这些步骤

```
lp_solve_5.5_java/README.html 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-05T12:38:09.190

LPsolve 的设置

1.转到[https://sourceforge.net/projects/lpsolve/files/](https://sourceforge.net/projects/lpsolve/files/) -> 点击 LpSolve 你会看到不同版本的 LPSolve。下载 lp_solve_5.5.2.5_dev_win64.zip (根据处理器类型) lp_solve_5.5.2.5_java.zip (for java)

2.提取两个文件（ lp_solve_5.5.2.5_dev_win64 和 lp_solve_5.5.2.5_java 文件夹）

3.使用eclipse创建一个maven项目。（Demo项目）

4.转到 lp_solve_5.5.2.5_java 文件夹并复制 lib 文件夹并将其粘贴到项目目录的根目录中。（lib 文件夹包含处理器类型的支持文件（win64、win32 等）和 LPSolve 的 jar 文件，即“lpsolve55j.jar”）。

5.右击Demo Project->Build Path->Configure Build Path->Libraries->Add External jars->导航到你的项目目录->lib ->选择“lpsolve55j.jar”->open->apply-> '申请并关闭。

6.转到 lp_solve_5.5.2.5_dev_win64 文件夹复制“lpsolve55.dll”并将其粘贴到 C:\Windows 文件夹中。

7.转到 lib->win64->复制“lpsolve55j.dll”并将其粘贴到 C:\Windows 文件夹中。

8.新建一个类Demo

9\. [http://lpsolve.sourceforge.net/5.5/](http://lpsolve.sourceforge.net/5.5/) 将此作为参考指南。

10.复制并粘贴简单示例并运行应用程序。

```
import lpsolve.*;
public class Demo {

  public static void main(String[] args) {
    try {
      // Create a problem with 4 variables and 0 constraints
      LpSolve solver = LpSolve.makeLp(0, 4);

      // add constraints
      solver.strAddConstraint("3 2 2 1", LpSolve.LE, 4);
      solver.strAddConstraint("0 4 3 1", LpSolve.GE, 3);

      // set objective function
      solver.strSetObjFn("2 3 -2 3");

      // solve the problem
      solver.solve();

      // print solution
      System.out.println("Value of objective function: " + solver.getObjective());
      double[] var = solver.getPtrVariables();
      for (int i = 0; i < var.length; i++) {
        System.out.println("Value of var[" + i + "] = " + var[i]);
      }

      // delete the problem and free memory
      solver.deleteLp();
    }
    catch (LpSolveException e) {
       e.printStackTrace();
    }
  }
} 
```

如果您收到此错误：java.lang.unsatisfiedlinkerror no lpsolve55j in java.library.path

设置 java.library 路径。使用 Eclipse

1.在包资源管理器区域中选择您的项目，然后右键单击它。

2.选择构建路径→配置构建路径...选项。

3.在出现的窗口中，选择库选项卡。

4.然后，展开 JRE System library 选项并选择 Native library location。

5.单击右侧面板上的编辑...按钮。

6.找到所需的库，然后单击确定。

7.关闭窗口。

# database - 与 Wordpress 共享主“非 WP”网站数据库中的用户？

> ID：10903112
> 
> 赞同：0
> 
> 时间：2012-06-05T18:50:22.590
> 
> 标签：database, wordpress, authentication, external

我一直在使用 WP，但始终作为“独立”网站，现在我希望将博客作为我主要网站的*一部分*，并一直在寻找消除注册/登录冗余的最佳方法理想情况下，使用我的主网站数据库中的用户数据以最简单、最安全的方式安装 WP。WP 博客位于同一台服务器上/位于主站点的子文件夹中。

在发布此之前，我已经四处寻找解决方案，但似乎围绕这个主题的大多数讨论都涉及在多个 WP 站点之间共享用户，而不是与非 WP 主网站共享用户。

我发现了一些可能的选项，但不确定是否可行，如下所示：

1) 一个插件（外部数据库身份验证），似乎是票，但显然有一段时间没有更新，并显示版本 2.9.2 作为最后一个兼容版本。是否有其他/更好/维护的插件替代品？我找不到任何其他看起来像这个一样准确的东西。我确实试图让它工作，但无法登录 WP 安装：

我在我的主网站数据库中创建并添加了一个新用户，检查的唯一权限是“选择”，并使用了表单上的所有主网站数据库信息：

名称：myws_mysitedb | 用户：myws_newwpuser | 密码：新用户的密码 | 用户表：sitetable_logins

用户名：用户名 | 密码：密码 | 加密类型：其他 | 哈希：正是我主站点上使用的软件制造商所说的使用

我还通过主站点注册系统创建了一个用户，其用户名和密码与 WP 安装上的管理员名称/密码完全相同，因为它必须针对主外部数据库对管理员用户进行身份验证。

看到我可能做错了什么吗？我还尝试使用具有所有权限但没有效果的新用户。

2）我已经阅读了关于添加`define('CUSTOM_USER_TABLE', $table_prefix.'my_users'); define('CUSTOM_USER_META_TABLE', $table_prefix.'my_usermeta');` 但不明白这是否会解决WP端的注册/登录问题，我不确定我是否必须/不应该使用“meta_table”如果主数据库中当前没有这样的表，并且不确定我应该如何指定要使用的另一个表在哪里...我已经读到 $table_prefix 再次参考多个 WP 实例时在同一个数据库（或类似的东西）上，所以我认为我不需要那个。我测试了一些东西，将其更改为：`define('CUSTOM_USER_TABLE', custom_databasename.'custom_tablename');`

`define('CUSTOM_USER_TABLE', 'custom_databasename.custom_tablename');`

很简单：`define('CUSTOM_USER_TABLE', 'custom_user_table');`但两者都不允许我从我的主站点与当前用户一起登录。

我希望这个问题/请求不会令人讨厌，并且没有我应该已经找到自己的明显解决方案，但我很惊讶我无法轻易找到一个简单的分步过程来共享我的用户现有的网站/不同的数据库与一个 Wordpress 博客....

我提前感谢您的任何提示和帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:54:09.407

一种（有点笨拙）的方法可能是在您的主站点用户表上定义插入/更新触发器。

每当插入或更新用户时，在 wordpress 用户数据库中创建或更新相应的记录。如果您想要双向集成，您也可以在 Wordpress 用户表上创建类似的触发器。

# php - Symfony FOSUserBundle - 在布局模板中包含登录表单

> ID：10903114
> 
> 赞同：10
> 
> 时间：2012-06-05T18:50:24.620
> 
> 标签：php, symfony1, twig

我们已经成功配置了 FOSUserBundle；登录，注册，重置密码等，都工作得很好。

现在我们想将登录表单合并到我们的一般站点布局中，特别是将表单放入布局标题的右上角。如果我们只处理用户名和密码字段，这样做会很容易。然而，我们似乎无法弄清楚如何获得由 FOSUserBundle 服务生成的 CSRF 令牌：

```
$this->container->get('form.csrf_provider')->generateCsrfToken('authenticate'); 
```

我尝试在 Twig 扩展中调用上述内容，否则可以正常工作，但显然扩展无法正确引用容器。

肯定有一些简单的方法可以在全球范围内获取 FOSUserBundle CSRF 令牌吗？

谢谢！杰森

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-06-21T11:18:05.453

**Symfony 2.3：**

一种可能的解决方案是将 csrf 提供程序定义为 Twig 全局变量，如下所示：

```
twig:
    globals:
        fos_csrf_provider: "@form.csrf_provider" 
```

然后在你的布局中这样称呼它：

```
<input type="hidden" name="_csrf_token" value="{{ fos_csrf_provider.generateCsrfToken('authenticate') }}" /> 
```

所以你不需要调用任何控制器。

**Symfony 2.4 及更高版本：**

```
twig:
    globals:
        fos_csrf_provider: "@security.csrf.token_manager" 
```

和：

```
<input type="hidden" name="_csrf_token" value="{{ fos_csrf_provider.refreshToken('authenticate') }}" /> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-06T06:47:47.940

您可以在其中一个控制器中定义这样的函数

```
public function getTokenAction()
{
    return new Response($this->container->get('form.csrf_provider')
                            ->generateCsrfToken('authenticate'));
} 
```

然后将其嵌入到您的表单中

```
<input type="hidden" name="_csrf_token" value="{% render('YourBundle:YourController:getToken') %}" /> 
```

您还需要在控制器顶部包含以下内容：

```
use Symfony\Component\HttpFoundation\Response; 
```

# java - 如何使用 Java 加载插件类？

> ID：10903119
> 
> 赞同：0
> 
> 时间：2012-06-05T18:50:52.150
> 
> 标签：java, plugins, casting, classloader

我制作了一个小型应用程序，它从文件夹加载类，将它们显示在列表中，当您单击一个时，它会在其中显示`JPanel`。

所以我做了一个 API 类 ( `BaseApp`) 扩展`JPanel`。我还制作了一个测试类`extends BaseApp`并使用其中的 API。

现在，我的问题是每次我点击时`TestApp`，它都会给我这个`Exception`......

```
Exception in thread "AWT-EventQueue-0" java.lang.ClassCastException: java.lang.Class     cannot be cast to me.Delocaz.SuperApp.BaseApp
at me.Delocaz.SuperApp.AppSelect$2.mouseClicked(AppSelect.java:76)
at java.awt.AWTEventMulticaster.mouseClicked(Unknown Source)
at java.awt.Component.processMouseEvent(Unknown Source)
at javax.swing.JComponent.processMouseEvent(Unknown Source)
at java.awt.Component.processEvent(Unknown Source)
at java.awt.Container.processEvent(Unknown Source)
at java.awt.Component.dispatchEventImpl(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Window.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$000(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue$4.run(Unknown Source)
at java.awt.EventQueue$4.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue.dispatchEvent(Unknown Source)
at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.run(Unknown Source) 
```

我试图将`Class`我从类加载器中获得的内容转换为`BaseApp`. 我该怎么做才不会崩溃？

如果你需要它，这是我的`FileClassLoader`：

```
package me.Delocaz.SuperApp;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
public class FileClassLoader extends ClassLoader {
    public Class<?> findClass(File f) {
        byte[] b = loadClassData(f);
        try {
        return defineClass(null, b, 0, b.length);
        } catch (ClassFormatError ex) {
        return null;
        }
    }
    private byte[] loadClassData(File f) {
        FileInputStream fin;
        byte fileContent[] = new byte[(int)f.length()];
        try {
            fin = new FileInputStream(f);
            fin.read(fileContent);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return fileContent;
    }
} 
```

此外，这也是强制转换发生的地方：

```
Object c = cl.findClass(new File(***CLASS FILE LOCATION***));
System.out.println(c);
switchApp((BaseApp) c); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:54:26.570

type`Class`的实例不是type 的实例`BaseApp`，因此转换失败。您需要实例化该类以获取 type 的实例`BaseClass`，然后您可以对其进行强制转换

尝试调用`newInstance()`类实例以获取已加载类的新实例（基于其默认构造函数）

# .net - FileInfo.OpenText() 无法读取特殊字符 EG üò°

> ID：10903120
> 
> 赞同：4
> 
> 时间：2012-06-05T18:50:52.480
> 
> 标签：.net, wpf, utf-8, fileinfo, opentext

有一些文本文件在 TextBox 和 TextBlock 中显示许多字符为 �。

如何在 .NET WPF 中正确读取和显示这些文件？

文件读取，其中 fi 是 FileInfo。

```
fileText = fi.OpenText().ReadToEnd(); 
```

在 WPF 中，我得到了 ü ò ° 和其他特殊字符的 � 字符。

尝试了多种字体。

文化是en-EN。

如果我将文件作为流读取，我会得到特殊字符

```
System.IO.Stream fsIn = fi.OpenRead();
if (fsIn.Length == 0) return;
int curInt = -1;
StringBuilder sb = new StringBuilder();
while ((curInt = fsIn.ReadByte()) >= 0)
{
    sb.Append((char)curInt);
} 
```

OpenText() 似乎正在将所有特殊字符读取为字节 253

我想我学到的是文本不是 UTF8 编码的。UTF8 使用 128-255 进行控制。OpenText() 用于 UTF8 编码。 [维基UFT8](http://en.wikipedia.org/wiki/UTF-8)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:08:06.487

`fi.OpenText``StreamReader`用 UTF8 编码打开一个。如果您需要不同的编码，请改用：

```
using (var reader = new StreamReader(fi.FullName, Encoding.Unicode))
    fileText = reader.ReadToEnd(); 
```

当然，您实际上根本不需要该`FileInfo`对象，因为上述调用只使用了路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:58:19.770

你基本上已经回答了你自己的问题。您的文本文件不是 Unicode 格式 - 它可能是某些特定代码页中的 ANSI。[要读取此类文件，您可以使用传入编码的 StreamReader。这里](http://msdn.microsoft.com/en-us/library/x8xxf0x5.aspx)有一些示例。

# c# - 使用基于条件的 linq 语法调用方法

> ID：10903122
> 
> 赞同：2
> 
> 时间：2012-06-05T18:51:04.120
> 
> 标签：c#, .net, linq, c#-4.0

如何循环遍历通用列表并根据几个条件调用方法？我想使用 linq 语法。以下当然行不通。有任何想法吗？

```
somelist.ForEach(i => i.DeptType == 1 && i != null () {MyMethod(someInt)}); 
```

如果这不可能，那么使用简洁语法的下一个最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T18:54:35.227

尝试使用 Where 指定要选择的记录并使用 ForEach 来执行您的方法：

```
somelist.Where(i => i.DeptType == 1 && i != null)
           .ToList()
           .ForEach( i=> MyMethod(i.someInt)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T19:05:26.743

```
//standard style ... since Linq is Functional/side-effects-free
foreach(var x in somelist.Where(i => i != null && i.DeptType == 1))
{
  SomeMethod(x);
}

//anon method style ... for those that must use ForEach
somelist.ForEach(i => {if (i != null && i.DeptType == 1) {MyMethod(someInt);}}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:04:00.170

尽管单行 LINQ 查询可能很吸引人，但它们通常与没有任何副作用的操作相关联（例如查询投影、过滤等）。在您的情况下，使用传统`foreach`循环可能会更好地为您服务：

```
foreach (var i in somelist)
    if (i != null && i.DeptType == 1)
        MyMethod(someInt); 
```

PS 您的原始状态 ,`i.DeptType == 1 && i != null`订购不正确。代码仍然会产生一个`NullReferenceException`因为在被空检查*之前*`i.DeptType`执行。 *`i`*

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T19:00:01.463

我会使用：

```
 somelist.Where(q => q !=null)
    .Where(q => q.DeptType == 1)
    .Select(q => MyMethod(q)); 
```

结果集合将包含原始值/方法调用的返回值列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:02:42.237

需要记住的一件事是，您应该确保在访问对象的字段之前进行空值检查，如下所示：

```
somelist.Where(i => i != null && i.DeptType == 1).ToList().ForEach( i=> MyMethod(i.someInt)); 
```

正如上面有人指出的那样，您不能对从 Where() 调用返回的通用 IEnumerable 对象调用 ForEach() 。您必须首先调用 ToList() 以将结果保存到通用列表。我已经更新了上面的代码以包含该更改。*

# c++ - 在 if 语句中 && 的后半部分进行无效操作是否安全？

> ID：10903128
> 
> 赞同：4
> 
> 时间：2012-06-05T18:51:17.350
> 
> 标签：c++

这安全吗：

```
if(sprite->numberOfSides !=0 && sprite->value%sprite->numberOfSides!=0) 
```

如果 sprite->numberOfSides 可以 == 0？

我问的原因是，如果我像这样构建 if 语句：

```
if(sprite->value%sprite->numberOfSides!=0 && sprite->numberOfSides !=0) 
```

我得到一个例外（因为你不能 n%0）。将其反转为前一个语句可以正常工作，但我不希望在为不同设备编译时遇到麻烦。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T18:53:01.483

是的，它是安全的。**标准保证短路**。

这意味着如果 and ( `&&`) 表达式的第一部分计算结果为`false`，则保证不会计算第二部分。

从 C++03 - **5.14/1**

> `&&`运算符从左到右分组。[...] 如果第一个操作数是 ，则不计算第二个操作数`false`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T18:57:01.403

只要您在谈论内置`&&`运算符，它就是安全的。正如其他答案已经指出的那样，内置运算符的评估是短路的：总是首先评估左操作数，如果评估为`false`，则甚至不会触及右操作数。

However, when you are dealing with overloaded operator `&&`, it behaves as any other overloaded binary operator, meaning that both operands are evaluated.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T18:54:00.523

是的，对于内置类型（如布尔值）。这种行为称为短路。发生这种情况是因为 && 实际上是与表达式中的第一条语句相关联的函数，尽管它的特殊语法也是由于其作为运算符的状态。在这个函数内部，通常会检查是否为空以及表达式是否为假。在 && 运算符的情况下，如果布尔值为 false，则足以停止对逻辑表达式的求值，并将节省求值时间。

# java - 将几个字符而不是一个字符插入字符串

> ID：10903129
> 
> 赞同：1
> 
> 时间：2012-06-05T18:51:21.383
> 
> 标签：java

我有一个带表达式的字符串。例如，字符串是“a + b”。我需要插入浮点变量而不是那个字符。“a” = 2.4494 和“b” = 5.545466。我将变量转换为字符串，然后使用表达式和值 char 数组从字符串中生成。

```
expr = expressions.get(i)[0]; // string with expression
        for (int j = 0; j < valsListArray.length; j++) {//find characters and values
                                                        //they should have      
            String selection = (String) valsListArray[j].getSelectedItem(); //get 
                                                               //chosen character
            Float valueFloat = segmentAreas.get(j);          //get value
            String valueString = "" + valueFloat;
            char[] charexpr = expr.toCharArray();                           //
            char[] valueChar = valueString.toCharArray();
            char[] ch = selection.toCharArray();
            for (int jj = 0; jj < charexpr.length; jj++) {
                if (charexpr[jj] == ch[0]) {  
                    charexpr[jj] = valueChar[0];    //here is the problem
                }
            }
            String s =new String(charexpr);
            expr = s; 
```

但我不明白如何插入整个 charArray 而不是一个字符...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:54:10.070

要一次在数组中插入多个字符，请考虑使用 a[`StringBuilder`](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html)代替。下面是你如何使用它：

```
StringBuilder sb = new StringBuilder("initial string");
sb.append("another string");
sb.append(new char[] {'c', 'h', 'a', 'r', 's'});
sb.append(1.0f);
String str = sb.toString(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:58:36.070

字符串是不可变的。因此，尝试对其进行变异是不好的做法。

使用[StrigBuilder](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)对象来操作字符串，它有一个 insert() 方法，可以让你做你所要求的。

# opengl - Haskell 错误：不在范围内：`GLFW.windowIsOpen'

> ID：10903131
> 
> 赞同：1
> 
> 时间：2012-06-05T18:51:26.147
> 
> 标签：opengl, haskell, glfw

我可以在[文档](http://hackage.haskell.org/packages/archive/GLFW-b/latest/doc/html/Graphics-UI-GLFW.html#v%3awindowIsOpen)中找到它。

但是，每当我编译时，都会出现范围错误。

这是我的代码：

```
import Graphics.Rendering.OpenGL as GL
import Graphics.UI.GLFW as GLFW
import Graphics.Rendering.OpenGL (($=))
import System.Environment (getArgs, getProgName)

import Control.Monad

main = do
  GLFW.initialize
  GLFW.openWindow (GL.Size 400 400) [GLFW.DisplayAlphaBits 8] GLFW.Window
  GLFW.windowTitle $= "openGL Test"

  render <- initialize'
  loop render

  GLFW.closeWindow
  GLFW.terminate

loop render = do
  render
  p <- GLFW.getKey GLFW.ESC
  unless (p == GLFW.Press) $ do
    isOpen <- GLFW.windowIsOpen
    when isOpen $ loop render

initialize' = do
  return $ do
    GL.clear [GL.ColorBuffer] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:45:04.870

您引用的文档似乎很旧。有[最新版本的新文档](http://hackage.haskell.org/packages/archive/GLFW/0.5.0.1/doc/html/Graphics-UI-GLFW.html)。

`windowIsOpen`已经不存在了，好像已经被`getParam Opened`.

# delphi - 一次只检查一个复选框

> ID：10903132
> 
> 赞同：1
> 
> 时间：2012-06-05T18:51:29.457
> 
> 标签：delphi, delphi-xe2, vcl

[编译器：德尔福 XE2]

昨天我花了一整天的时间尝试各种方法来完成这个特定的任务，但它们都以相同的结果结束。

使用 TRZCheckGroup 和此示例查看已检查的内容等。

```
procedure TFrmMain.cbOptionsChange(Sender: TObject; Index: Integer; NewState: TCheckBoxState);
var
  ItmIndex0, ItmIndex1: Integer;
begin
  { Initialize ItemIndex's }
  ItmIndex0 := -1;
  ItmIndex1 := -1;

  { Return the position Index of the string's(0 and 1) }
  ItmIndex0 := cbOptions.Items.IndexOf('One');
  ItmIndex1 := cbOptions.Items.IndexOf('Two');

  { Which CheckBox has been Checked } 
  cbOptions.ItemChecked[ItmIndex0] := True;
  cbOptions.ItemChecked[ItmIndex1] := False;
end; 
```

注意：^这不是我的最终代码，只是我如何处理复选框的示例。

像 -

```
if cbOptions.ItemChecked[ItmIndex0] then
  cbOptions.ItemChecked[ItmIndex1] := False
else cbOptions.ItemChecked[ItmIndex1] := True; 
```

他们第一次工作，然后它总是评估为真，我明白为什么。只有当我取消选中第一个 CheckBox 时，else 位才会起作用，这显然不是我想要的结果。

似乎事件停止工作，并且在我的一些尝试中由于某种原因它已经触发了两次。

cbListOptionsChange 上的 NewState 参数，这是什么，无论如何它可以帮助我吗？

对此的任何帮助将不胜感激。

谢谢。

```
if cbOptions.ItemChecked[ItmIndex0] then
  cbOptions.ItemChecked[ItmIndex1] := False
else if cbOptions.ItemChecked[ItmIndex1] then
  cbOptions.ItemChecked[ItmIndex0] := False; 
```

如果选中第二个 CheckBox，请查看类似内容，然后我检查第一个它是否按要求工作，但显然之后您无法再检查第二个 CheckBox。

* * *

Ken White - 片段（工作）。将组件的名称替换为默认，因为人们可能会感到困惑，有时有助于默认命名以节省未来的问题。

```
procedure TForm1.RzCheckGroup1Change(Sender: TObject; Index: Integer; NewState: TCheckBoxState);
var
  i: Integer;
begin
  // Keep this event from being fired again while we're here.
  // Your code isn't clear about what the actual name of the
  // component or this event, (the event is named `cbListOptionsChange`,
  // but your code references `cbOptions` - I don't know which is
  // correct, so change it if needed in the next line and
  // the one in the `finally` block below. I'm using `cbListOptions`
  // here.
  RzCheckGroup1.OnChange := nil;

  try
    // If we're getting notified of a new item being checked...
    if NewState = cbChecked then
    begin
      // Iterate through the items, unchecking all that aren't
      // at the index that just became checked.
      // I wouldn't use `for..in`, because the ordering works better here
      for i := 0 to RzCheckGroup1.Items.Count - 1 do
        if i <> Index then
          RzCheckGroup1.ItemChecked[i] := False; // Ryan - Just changed to this from this cbListOptions.Items[i].Checked := False;
    end;

    // Ryan - Uncomment these two lines if you want one of them to be Checked at all times, this will set the CheckBox you are trying to Uncheck to Checked. 
    //if not RzCheckGroup1.ItemChecked[Index] then
    //  RzCheckGroup1.ItemChecked[Index] := True;

  finally
    // Reconnect the event
    RzCheckGroup1.OnChange := RzCheckGroup1Change;
  end;
end; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T19:22:33.887

我不熟悉`TRZCheckGroup`，但您当前的代码将始终检查项目`ItmIndex0`并取消选中其他项目。

`TCheckBoxState`在 Delphi 文档中定义为

```
TCheckBoxState = (
  cbUnchecked,
  cbChecked,
  cbGrayed
); 
```

所以`NewState`似乎告诉你新设置的状态`CheckBox`，并`Index`告诉你哪个复选框正在改变。大多数时候，`cbGrayed`不使用，因为它表示该值从未设置过；它通常仅在您读取数据库中的 BOOLEAN（或位）列并且它为 NULL 时才有用。

这个事件并不是真的要交替两个复选框的状态，它会出现；它旨在让您在单个项目（在项目组中）更改其状态时做出反应：

```
procedure TFrmMain.cbListOptionsChange(Sender: TObject; Index: Integer; 
  NewState: TCheckBoxState);
begin
  case NewState of
    cbUnchecked: // Do whatever when cbOptions.Items[Index] is unchecked
    cbChecked:   // Do whatever when cbOptions.Items[Index] is checked
    cbGrayed:    // Usually ignored unless NULL in db column is indicated
  end;
end; 
```

要反转两个复选框的状态（将一个更改为备用状态，另一个更改为相反状态），您可以使用类似这样的内容（使用两个标准`TCheckBox`控件，为它们的两个事件定义相同的`OnClick`事件）：

```
procedure TFrmMain.CheckBoxClick(Sender: Object);
var
  ChkBox: TCheckBox;
  BoxToToggle: TCheckBox;
begin
  // If you're sure the event is only for TCheckBox
  ChangingBox := TCheckBox(Sender);
  // If there's a chance it's used for something else
  // if (Sender is TCheckBox) then
  // begin
  //   ChangingBox := TCheckBox(Sender); 
  //   
  // or
  //   ChangingBox := Sender as TCheckBox

  if ChangingBox = CheckBox1 then
    BoxToToggle := CheckBox2
  else
    BoxToToggle := CheckBox1;

  // Disable this event for both checkboxes, so it doesn't
  // fire recursively
  ChangingBox.OnClick := nil;
  BoxToToggle.OnClick := nil;
  try
    BoxToToggle.Checked := not ChangingBox.Checked;
  finally
    // Reconnect event handlers
    ChangingBox.OnClick := CheckBoxClick;
    BoxToToggle.OnClick := CheckBoxClick; 
  end; 
```

但是，如果您只是处理一个项目列表，其中一个应该被选中，而其他所有项目都未选中，那么您应该使用 a`TRadioGroup`来代替。它会自动为您提供此行为。使用复选框违反了正常的 Windows GUI 行为，并且会使您的用户感到困惑。

话虽如此（并且我**强烈**反对这样做！），并且因为我没有你正在使用的组件而未经测试，你可以试试这个（这违背了我的更好判断甚至写！）：

```
procedure TFrmMain.cbListOptionsChange(Sender: TObject; Index: Integer; 
  NewState: TCheckBoxState);
var
  i: Integer;
begin
  // Keep this event from being fired again while we're here.
  // Your code isn't clear about what the actual name of the
  // component or this event, (the event is named `cbListOptionsChange`,
  // but your code references `cbOptions` - I don't know which is
  // correct, so change it if needed in the next line and
  // the one in the `finally` block below. I'm using `cbListOptions`
  // here.
  cbListOptions.OnChange := nil;

  try
    // If we're getting notified of a new item being checked...
    if NewState = cbChecked then
    begin
      // Iterate through the items, unchecking all that aren't
      // at the index that just became checked.
      // I wouldn't use `for..in`, because the ordering works better here
      for i := 0 to cbListOptions.Items.Count - 1 do
        if i <> Index then
          cbListOptions.Items[i].Checked := False;
    end;        
  finally
    // Reconnect the event
    cbListOptions.OnChange := cbListOptionsChange;
  end;
end; 
```

为了确保清楚，我认为这是一个**非常糟糕的主意**，如果你为我工作，我不会允许的。当有适当的选项可用时，做一些与预期的 Windows 行为相反的事情是完全**错误的，IMO。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T00:15:01.063

此示例使用三个 TCheckbox 控件。

将三个 TCheckbox 控件拖放到窗体上。对于这个例子，我给它们命名

**cbOpenorders**、**cbClos​​edorders**和**cbAllorders**

**向对象检查器中的cbOpenorders.Onclick**属性添加一个事件。

然后，将 cbClos​​edorders 和 cbAllorders 的 OnClick 事件属性设置为此 cbOpenorders 事件。所有三个框都将调用相同的事件处理程序，从而减少所需的代码量。

```
procedure TFrmPreorderViewDialog.cbOpenOrdersClick(Sender: TObject);
begin
  if TCheckbox(Sender).Checked then
  begin
    cbOpenorders.Checked   := (TCheckbox(Sender) = cbOpenorders);
    cbClosedorders.checked := (TCheckbox(Sender) = cbClosedorders);
    cbAllorders.checked    := (TCheckbox(Sender) = cbAllorders);
  End;
end; 
```

在此示例中，用户只能选择一个框或没有框。

# javascript - 使用 Sinatra 串流，逐渐更新目的地

> ID：10903134
> 
> 赞同：4
> 
> 时间：2012-06-05T18:51:33.180
> 
> 标签：javascript, sinatra

我有一个 Sinatra 网络应用程序，我非常想通过流式更新来增强某些功能。不过，现在，我只是想了解如何使用流数据，这是我以前从未做过的。我有以下简单的测试代码：

在西纳特拉：

```
get '/foo' do
  stream do |out|
    10.times do
      out.puts "foo"
      out.flush
      sleep 1
    end
  end
end

get '/bar' do
  erb :bar
end 
```

在`bar.erb`：

```
<body>
  <div class="stream">
    nothing.
  </div>
</body>

<script type="text/javascript" charset="utf-8">
  $(document).ready( function() {
    $.get('/foo', function(html) {
      $(".stream").html(html);
    });
  });
</script> 
```

我并不感到惊讶，这并没有达到我想要的效果，即在编写每个 'foo' 并动态更新页面时获取它。相反，大约 10 秒内什么都没有发生，然后我得到`foo foo foo foo foo foo foo foo foo foo foo`.

我的问题是，**如何在 ERB 模板（使用 Ruby、jQuery 或其他方式）中提取提供的流数据，而不是阻塞直到它全部收集并一次全部吐出？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T19:06:28.680

Sinatra 动作包装了整个 HTTP 响应周期——这意味着它会等到动作完成后再关闭请求，此时浏览器认为数据“完整”且“良好”可以使用。您在上面的代码中创建的只是一个非常非常慢的 Sinatra 操作。

您正在寻找的技术是 Websockets，大多数现代浏览器都支持它，并在每个客户端和服务器之间提供双向通信通道。websocket 通道是通过“升级”常规 HTTP 请求来创建的。在客户端不支持 Web 套接字的情况下，可以使用 HTTP 长轮询等技术来模拟它们（其中请求保持打开状态，没有响应，直到有可用数据 - 那时数据被分流到响应通道，响应通道已关闭，预计客户端将打开一个新请求以获取任何进一步的数据）。

[您可以使用 EventMachine 和EM-Websocket](https://github.com/igrigorik/em-websocket)在您的 Ruby 应用程序中进行此设置。另一种方法是[Socky](https://github.com/socky/socky-server-ruby)，我相信它提供了 javascript 客户端和 Ruby 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-08T14:26:25.497

如果您在 Sinatra 中使用流，则会跳过普通模板，您会得到一个只有您正在流式传输的 html 的空白页面。您可以通过手动创建布局并将其与文本一起流式传输来规避此问题。这里举个例子。

```
require 'sinatra'
require "sinatra/streaming"
set server: 'thin', connections: []

get '/' do
  stream do |out|
    settings.connections << out
    @out = out
    erb :stream
    out.callback { settings.connections.delete(out) }
  end
end
__END__
@@pre
  <!DOCTYPE html>
  <html>
  <head>
    <title>test</title>
  </head>
  <body>
   <h1>This is the body</h1>

@@after
  </body>
  </html>

@@stream
  <%
    @out.puts erb(:pre)
    @out.puts "<h2>test</h2>"
    (1..10).each do |i|
        @out.puts "#{i}<br>"
        sleep 2
      end
    @out.puts erb(:after)
    @out.flush
  %> 
```

# jsf - 从 JSF 托管 bean 访问具有多个引用的 OSGi 服务

> ID：10903135
> 
> 赞同：2
> 
> 时间：2012-06-05T18:51:36.943
> 
> 标签：jsf, osgi, cdi

我试图弄清楚如何在 JSF 托管 bean 中有多个实现（引用）的情况下获取所有 OSGi 服务。

目前我正在使用 CDI 注释来访问服务，但这似乎不支持多个服务引用或者我不知道如何。

例如，我可以使用以下内容访问一项服务，但一次只能获取一项。

```
import javax.inject.Inject;
import org.glassfish.osgicdi.OSGiService;

@ManagedBean
@ApplicationScoped
public class ConnectionMgr 
{
    @Inject @OSGiService
    private ComponentFactory m_Factory;
} 
```

以前，我使用过 OSGi 声明式服务来绑定多个服务，如下所示：

```
@aQute.bnd.annotation.component.Reference(multiple = true, dynamic = true)
public void setService(SomeService service)
{
    m_ServiceList.add(service);
} 
```

但据我所知，我不能将声明性服务与 JSF 托管 bean 一起使用。

# vba - Excel 2007 VBA 不会更改图表名称

> ID：10903138
> 
> 赞同：0
> 
> 时间：2012-06-05T18:51:47.773
> 
> 标签：vba, excel, charts

我有以下代码

```
Sub Foo()
    Dim Graph As Chart
    Set Graph = AddGraph()
    Graph.name = "XXXX"
End Sub

Function AddGraph() As Chart
    Dim Graph As Chart
    '
    '
    '
    Graph.name = "XXXX"
    Set AddGraph = Graph
End Function 
```

（请注意，小写“名称”的是 VBE。）

在 AddGraph 中，Graph 是用`Name="ChartXX"`. 赋值语句不会更改名称。

在 Foo 中，当执行名称赋值语句时，控制权一直被踢到调用堆栈的顶部。（对 Graph 的其他操作不会导致问题。）

所以我有两个问题：

**1** ) 为什么名称更改在 AddGraph 中不起作用？和

**2** ) 为什么名称更改后来在 Foo 中崩溃？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T11:32:46.193

你忽略了告诉我们 AddGraph() 如何添加图表，或者什么样的图表。餐饮主管假定您添加了图表，在这种情况下，Graph.Name 是一个有效属性。但是，如果您已将图表添加为嵌入式图表，则 Graph.Name 毫无意义。相反，您必须设置 Graph 父级 ChartObject 的名称：

Graph.Parent.Name = "XXXX"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:54:35.000

看起来问题源于 Graph 没有正确设置为您正在创建的图表对象。

尝试这个：

```
Option Explicit

Sub Foo()
    Dim Graph As Chart
    Set Graph = AddGraph()
    Graph.Name = "MMMMMMM"
End Sub

Function AddGraph() As Chart
    Charts.Add
    With ActiveChart
        .ChartType = xlXYScatterLines
        .SetSourceData Source:=Sheets("Sheet1").Range("A1:B5")
        .Name = "XXXX"
    End With
    Set AddGraph = ActiveChart
End Function 
```

单步执行它，您将看到您的图表在函数中被命名为“XXXX”，并在返回子程序后重命名为“MMMMMM”。

# php - 下载超过 63MB 的文件时出现 500 错误

> ID：10903139
> 
> 赞同：1
> 
> 时间：2012-06-05T18:51:47.790
> 
> 标签：php, apache

我不确定这是 PHP 问题、服务器配置问题还是硬件问题，但我想我会从 PHP 开始，看看是否有任何建议。这段代码直到最近都运行良好，我不知道任何可能导致这种情况的配置更改。我们最近确实从 Debian Lenny 升级到了 Squeeze（从 PHP 5.2 升级到 5.3），但是代码在另一个 Squeeze 服务器上运行良好。

我有一些 PHP 代码，它获取作为 GET 变量传递的文件的路径（通过 mod_rewrite 从对 http://site.com/request/for/file.pdf 的请求[重写](http://site.com/downloader.php?path=/path/to/file.pdf)到[http://site.com](http://site.com/request/for/file.pdf) [/downloader.php?path=/path/to/file.pdf](http://site.com/downloader.php?path=/path/to/file.pdf)）。这样做的原因与统计跟踪有关。

该文件被传递给这个位代码（为便于阅读而简化）。

```
 if(is_readable($theFile)) {

       //$fh= fopen($theFile, "r");
       header("Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0");
       header("Pragma: no-cache");
       header("Content-Type: application/pdf");
       header("Content-Disposition: attachment; filename=\"".basename($theFile)."\"");
       header("Content-Length:".(string)(filesize($theFile)));
       sleep(1);
       //fpassthru($fh);
       readfile($theFile);
 } 
```

正如你所看到的，代码只有在文件可读的情况下才会被执行（即路径都是正确的）。对于大约 63MB 以下的文件，一切正常。对于超过 63MB 的任何内容，服务器都会返回 500 错误。（当我猜它应该是“内部服务器错误”时，这在 Firefox/Chrome 中被报告为“找不到文件”，但我猜这是另一个故事）。Apache 错误日志中没有任何内容。

谁能想到会导致这种情况发生的任何 PHP 或 Apache 服务器配置？据我所知，PHP 内存限制不应受到 readfile 或 fpassthru 的影响。我确实注意到我的 PHP 内存限制是 64MB，但是，关闭 mod_rewrite 重定向到 PHP 并不能解决问题。文件仍然无法下载。

非常感谢您的任何建议。

更新* ***** ** *** ** *** ** *****

好的，所以我将 PHP 内存限制从 64MB 增加到 200MB。这允许下载高达 200MB 的文件。然而，问题仍然存在。鉴于 readfile 和 fpassthru 不应受到内存限制的影响，并且我检查了输出缓冲已关闭，为什么大文件会导致这个（新）问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:50:23.673

解决方案很简单（下班后）。

```
php_value output_buffering 0 
```

添加到 Apache 虚拟主机配置。

似乎无论 ob_get_level() 说什么，输出缓冲都在发生。换句话说，仅使用输出缓冲的选项就足以影响 PHP 内存使用。

# objective-c - 将 UIImage 设置为背景 - 不平铺

> ID：10903142
> 
> 赞同：0
> 
> 时间：2012-06-05T18:51:58.270
> 
> 标签：objective-c, ios, uiimage, core-graphics, uicolor

我有一个背景图像选择器，可让用户从相册中的库存图像中进行选择。要设置图像，我有以下代码：

```
-(void)setBackgroundImage:(UIImage *)newImage {    
    [backgroundImage release];
    backgroundImage = newImage;
    [backgroundImage retain];
    [editorContentView setBackgroundColor:[UIColor colorWithPatternImage:newImage]];
} 
```

虽然图像总是从右上角开始平铺。这对我的 32x32 模式非常有用，但如果用户想在 2048x2048 画布上使用 1024x768 图像并且不希望它平铺，我该如何防止平铺？

我唯一的想法是将较小的图像转换为画布大小的图像，然后将其设置为该大小。

还有其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:57:46.087

将背景设置为透明并创建一个单独的`UIImageView`，然后您可以将其放在下面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:54:02.903

你总是可以继承 UIView 并使用 CoreGraphics 在 -drawRect 中绘制图像：

# php - Ubuntu PHP 和 sqlsrv_connect()

> ID：10903148
> 
> 赞同：2
> 
> 时间：2012-06-05T18:52:38.783
> 
> 标签：php, sql-server, ubuntu

我正在使用一个`sqlsrv_connect()`在 PHP 中使用的类来连接到 MSSQL 数据库服务器，但我总是收到此错误：

```
Fatal error: Call to undefined function sqlsrv_connect() 
```

我已经完成了多种安装方法，例如：

```
sudo apt-get install -y freetds-bin freetds-common tdsodbc odbcinst unixodbc php5-sybase 
```

重新启动 apache，但似乎都没有解决添加库的问题。可以帮忙给一些关于问题的指导吗？

我正在使用：

```
PHP 5.3.10-1ubuntu3.1 with Suhosin-Patch (cli) (built: May  4 2012 02:20:36) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T22:42:56.820

基于 Linux 的 PHP 不支持这些`sqlsrv_*`功能。这些仅由 Windows 驱动程序提供。FreeTDS 将为您提供对旧`mssql_*`功能的访问。

# arrays - 如何计算 3D 坐标的线性索引，反之亦然？

> ID：10903149
> 
> 赞同：10
> 
> 时间：2012-06-05T18:52:44.783
> 
> 标签：arrays, math, multidimensional-array, matrix, coordinate-transformation

如果我有一个点 (x, yz)，我如何找到该点的线性索引 i？我的编号方案是 (0,0,0) is 0, (1, 0, 0) is 1, . . ., (0, 1, 0) 是最大 x 维度, .... 另外，如果我有一个线性坐标 i，我如何找到 (x, y, z)？我似乎在谷歌上找不到这个，所有的结果都充满了其他不相关的东西。谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-05T20:18:41.513

有几种方法可以将 3d 坐标映射到单个数字。这是一种方法。

一些函数 f(x,y,z) 给出坐标 (x,y,z) 的线性索引。它有一些我们想要导出的常数 a,b,c,d，因此我们可以编写一个有用的转换函数。

```
f(x,y,z) = a*x + b*y + c*z + d 
```

您已指定 (0,0,0) 映射到 0。所以：

```
f(0,0,0) = a*0 + b*0 + c*0 + d = 0
d = 0
f(x,y,z) = a*x + b*y + c*z 
```

这样就解决了。您已指定 (1,0,0) 映射到 1。所以：

```
f(1,0,0) = a*1 + b*0 + c*0 = 1
a = 1
f(x,y,z) = x + b*y + c*z 
```

这算是解决了。让我们任意决定 (MAX_X, 0, 0) 之后的下一个最大数是 (0,1,0)。

```
f(MAX_X, 0, 0) = MAX_X
f(0, 1, 0) = 0 + b*1 + c*0 = MAX_X + 1
b = MAX_X + 1
f(x,y,z) = x + (MAX_X + 1)*y + c*z 
```

这b解决了。让我们任意决定 (MAX_X, MAX_Y, 0) 之后的下一个最大数是 (0,0,1)。

```
f(MAX_X, MAX_Y, 0) = MAX_X + MAX_Y * (MAX_X + 1)
f(0,0,1) = 0 + (MAX_X + 1) * 0  + c*1 = MAX_X + MAX_Y * (MAX_X + 1) + 1
c = MAX_X + MAX_Y * (MAX_X + 1) + 1
c = (MAX_X + 1) + MAX_Y * (MAX_X + 1)
c = (MAX_X + 1) * (MAX_Y + 1) 
```

现在我们知道了 a、b、c 和 d，我们可以编写如下函数：

```
function linearIndexFromCoordinate(x,y,z, max_x, max_y){
    a = 1
    b = max_x + 1
    c = (max_x + 1) * (max_y + 1)
    d = 0
    return a*x + b*y + c*z + d
} 
```

您可以通过类似的逻辑从线性索引中获取坐标。我有一个非常棒的演示，这个页面太小而无法包含。所以我会跳过数学课，只给你最后的方法。

```
function coordinateFromLinearIndex(idx, max_x, max_y){
    x =  idx % (max_x+1)
    idx /= (max_x+1)
    y = idx % (max_y+1)
    idx /= (max_y+1)
    z = idx
    return (x,y,z)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T01:27:29.830

如果坐标没有上限，可以从 origo 往外编号。一层一层。

```
(0,0,0) -> 0
(0,0,1) -> 1
(0,1,0) -> 2
(1,0,0) -> 3
(0,0,2) -> 4
   :       :
(a,b,c) -> (a+b+c)·(a+b+c+1)·(a+b+c+2)/6 + (a+b)·(a+b+1)/2 + a 
```

倒数更难，因为您必须求解 3 次多项式。

```
m1 = InverseTetrahedralNumber(n)
m2 = InverseTriangularNumber(n - Tetra(m1))
a = n - Tetra(m1) - Tri(m2)
b = m2 - a
c = m1 - m2 
```

在哪里

```
InverseTetrahedralNumber(n) = { x ∈ ℕ | Tetra(n) ≤ x < Tetra(n+1) } 
Tetra(n) = n·(n+1)·(n+2)/6 
InverseTriangularNumber(n) = { x ∈ ℕ | Tri(n) ≤ x < Tri(n+1) } 
Tri(n) = n·(n+1)/2 
```

`InverseTetrahedralNumber(n)`可以 从[大 解析 解](http://en.wikipedia.org/wiki/Cubic_equation#Roots_of_a_cubic_function)中 计算 , 也可以 用[一些 数值 方法](http://en.wikipedia.org/wiki/Newton's_method)搜索.

* * *

这是我对代数解决方案（javascript）的尝试。我正在使用替换`p = a+b+c`, `q = a+b`,`r = a`来简化方程。

```
function index(a,b,c) {
    var r = a;
    var q = r + b;
    var p = q + c;
    return (p*(p+1)*(p+2) + 3*q*(q+1) + 6*r)/6;
}

function solve(n) {
    if (n <= 0) {
        return [0,0,0];
    }

    var sqrt = Math.sqrt;
    var cbrt = function (x) { return Math.pow(x,1.0/3); };

    var X = sqrt(729*n*n - 3);
    var Y = cbrt(81*n + 3*X);
    var p = Math.floor((Y*(Y-3)+3)/(Y*3));
    if ((p+1)*(p+2)*(p+3) <= n*6) p++;
    var pp = p*(p+1)*(p+2);

    var Z = sqrt(72*n+9-12*pp);
    var q = Math.floor((Z-3)/6);
    if (pp + (q+1)*(q+2)*3 <= n*6) q++;
    var qq = q*(q+1);

    var r = Math.floor((6*n-pp-3*qq)/6);
    if (pp + qq*3 + r*6 < n*6) r++;

    return [r, q - r, p - q];
} 
```

# python - 继承+外键

> ID：10903154
> 
> 赞同：5
> 
> 时间：2012-06-05T18:53:03.230
> 
> 标签：python, sql, sqlalchemy, flask, flask-sqlalchemy

我一直在为此绞尽脑汁，似乎无法弄清楚如何解决这个问题。请注意，我已经从我的模型中删除了很多不相关的字段

我正在编写我的 SQL-Alchemy 模型，遇到了以下问题：

由于多个计费系统，每个都具有完全不同的属性，并且由于订阅属性的类型不同（即用户名、节点位置等），我不得不走多态继承之路。

```
class Subscription(Base):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(255))
    secret = db.Column(postgresql.BYTEA)
    type = db.Column(SubscriptionType.db_type())
    status = db.Column(StatusType.db_type())
    subscription_id = db.Column(db.Integer)

    __tablename__ = 'subscription'
    __table_args__ = {'schema':'public'}

    __mapper_args__ = {'polymorphic_on' : type}

    def __repr__(self):
        return '<Subscription: %r>' % self.id

class Product1(Subscription):
    __mapper_args__ = {'polymorphic_identity' : SubscriptionType.product1}    
    id = db.Column(db.Integer, db.ForeignKey('public.subscription.id'), 
        primary_key = True)
    billing_system = db.Column(
        db.Integer, 
        db.ForeignKey('public.billing_system.id')
    )

class BillingSystem(Base):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(255))
    type = db.Column(BillingSystemType.db_type())

    __tablename__ = 'billing_system'
    __table_args__ = {'schema':'public'}

    __mapper_args__ = {'polymorphic_on' : type}

    def __repr__(self):
        return '<Subscription: %r>' % self.id

class BillingSystem1(BillingSystem):
    __mapper_args__ = {'polymorphic_identity' : BillingSystemType.billingsystem1}    
    id = db.Column(db.Integer, db.ForeignKey('public.billing_system.id'), 
        primary_key = True)
    billing_system = db.Column(
        db.Integer, 
        db.ForeignKey('public.billing_system.id')
    )
    foo = db.Column(db.Integer)
    bar = db.Column(db.Integer)

 class BillingSystem2(BillingSystem):
    __mapper_args__ = {'polymorphic_identity' : BillingSystemType.billingsystem2}    
    id = db.Column(db.Integer, db.ForeignKey('public.billing_system.id'), 
        primary_key = True)
    billing_system = db.Column(
        db.Integer, 
        db.ForeignKey('public.billing_system.id')
    )
    bing = db.Column(db.Integer)
    boo = db.Column(db.Integer)

    __tablename__ = 'billing_system_product2'
    __table_args__ = {'schema':'public'} 
```

一切正常，除了一件事。

假设我运行以下命令：

```
>>> a = Product1()
>>> b = BillingSystem.objects.get(1)
>>> a.billing_system = b
>>> session.add(a)
>>> session.commit() 
```

我将收到以下错误。

```
sqlalchemy.exc.ProgrammingError: (ProgrammingError) can't adapt type 'BillingSystem1' 'INSERT INTO 
```

我明白它在说什么，我尝试了以下方法。

```
>>> a.billing_system = b.id 
```

这仅存储 ID，当我尝试检索关联的对象时，我会收到一个整数。这涉及到我必须做一个额外的查询。我希望这不是要走的路。

我还尝试将所有计费系统 ID 的外键添加到 Product1 模型

```
class BillingSystem1(BillingSystem):
    __mapper_args__ = {'polymorphic_identity' : BillingSystemType.billingsystem1}    
    id = db.Column(db.Integer, db.ForeignKey('public.billing_system.id'), 
        primary_key = True)
    billing_system = db.Column(
        db.Integer, 
        db.ForeignKey('public.billing_system.id'),
        db.ForeignKey('public.billing_system1.id'),
        db.ForeignKey('public.billing_system2.id'),
    )
    foo = db.Column(db.Integer)
    bar = db.Column(db.Integer) 
```

这也根本不起作用，我收到了相同的 ProgrammingError 异常，指出该类型无法适应。

我已经浏览了手册，但找不到如何操作，但我需要某种形式的神奇选项来允许这种情况发生：

```
>>> a = BillingSystem.query.get(1)
>>> type(a)
BillingSystem 
```

代替：

```
>>> a = BillingSystem.query.get(1)
>>> type(a)
BillingSystem1 
```

有没有人能够阐明我如何查询我的多态模型集以获取 ID，并且只获取基本模型的类？

我觉得这会解决我的问题，我只是不知道如何解决。

感谢您花时间阅读本文，我真的很想找出我哪里出错了（我也醒得太久了，所以这无济于事）。

干杯，里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T02:58:55.340

```
class Subscription(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(255))
    secret = db.Column(postgresql.BYTEA)
    type = db.Column(SubscriptionType.db_type())
    status = db.Column(StatusType.db_type())
    subscription_id = db.Column(db.Integer)

    billing_system_id = db.Column(
        db.Integer, 
        db.ForeignKey('public.billing_system.id')
    )
    billing_system = db.relationship('BillingSystem', backref='subscriptions') 
```

所以我所做的是：

1 ) 将 Subscription.billing_system_id 外键移至基本订阅模型 2 ) 在 Subscription.billing_system 关系中添加

所以现在我正在这样做：

```
>>> o = BillingSystem.query.get(1)
>>> a = Product1()
>>> a.billing_system_id = o.id 
```

结果是：

```
>>> a.billing_system.subscriptions
[<cPanel Hosting Reseller: 2>]
>>> a.billing_system_id
2 
```

因此，除非我在这里做错了什么，否则它似乎有效。我只是无法传递实际的 BillingSystem 对象，我实际上必须设置 ID。虽然保存模型时它仍然是参考强制执行的，所以我没有看到太多问题。

谢谢你的帮助 ：）

# ruby - 如何在Ruby中超时子进程

> ID：10903160
> 
> 赞同：4
> 
> 时间：2012-06-05T18:53:22.933
> 
> 标签：ruby, timeout

我想测试一个进程是否正常工作，所以我运行：

```
cmd = "my unix command"
results = `#{cmd}` 
```

如何向命令添加超时，以便如果它花费超过 x 秒，我可以假设它不起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T19:00:15.357

Ruby 附带[Timeout 模块](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/timeout/rdoc/Timeout.html)。

```
require 'timeout'
res = ""
status = Timeout::timeout(5) {res = `#{cmd}`} rescue Timeout::Error

# a bit of experimenting:

res = nil
status = Timeout::timeout(1) {res = `sleep 2`} rescue Timeout::Error 
p res    # nil
p status # Timeout::Error

res = nil
status = Timeout::timeout(3) {res = `sleep 2`} rescue Timeout::Error 
p res    # ""
p status # "" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:54:45.993

把它放在一个线程中，让另一个线程休眠 x 秒，如果它还没有完成，则杀死第一个线程。

```
process_thread = Thread.new do
  `sleep 6` # the command you want to run
end

timeout_thread = Thread.new do
  sleep 4   # the timeout
  if process_thread.alive?
    process_thread.kill
    $stderr.puts "Timeout"
  end
end

process_thread.join
timeout_thread.kill 
```

不过 steenslag 的更好 :) 这是低科技路线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-14T13:25:04.700

线程更简单的方法：

```
p = Thread.new{ 
   #exec here
}
if p.join( period_in_seconds ).nil? then
   #here thread p is still working
   p.kill
else
   #here thread p completed before 'period_in_seconds' 
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-29T14:16:41.890

对先前答案的一个警告，如果子进程正在使用`sudo`，那么你不能杀死孩子，你将创建僵尸进程。

您将需要定期运行`Process::waitpid(-1, Process::WNOHANG)`以收集孩子的退出状态并清理进程表（从而清理僵尸）。

# java - 代码中的性能改进

> ID：10903163
> 
> 赞同：1
> 
> 时间：2012-06-05T18:53:36.553
> 
> 标签：java

问题陈述是-

在这种情况下包含为空，并且排除有一些值，所以我需要检查 temp 是否存在于排除中，如果 temp 存在于排除中，则不要做任何事情，或者你可以退出循环，但假设 temp不存在排除然后调用一些方法。我在下面实现了相同的功能，不确定我们是否可以进一步改进。在我看来，我们可以在不使用任何布尔值的情况下进行更多改进。因为 main 中的东西需要在一个方法中，并且会被调用很多次

```
public static void main(String[] args) {

    String temp = "77"; // It can also be 0
    String inclusion = null;
    String exclusion = "100;77;71";
    boolean bb = false;

    if(inclusion !=null) {
        System.out.println("Site Inclusion is not null");
    } else {
        for (String exc: exclusion.split(";")) {
            if(exc.equals(temp)) {
                bb =true;
                break;
            }
        }
        if(!bb) {
            // Call some method
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:22:46.577

```
 exclusion = ";"+exclusion+";";
    temp = ";"+temp+";";

    bb = exclusion.indexOf(temp) >= 0;
    if(!bb) {
        // Call some method
    } 
```

仅当您无法控制传入的排除格式和临时文件时才需要前两行。对问题中的代码进行多次迭代的快速测试需要 1.74 秒，如果使用上述代码进行相同测试则需要 0.38 秒exclude 和 temp 的前导和尾随分号与时序循环的每次迭代连接。如果它们已经有前导分号和尾随分号，则时间会减少到 0.07 秒。作为比较，matches (regex) 需要 1.18 秒，而 StringTokenizer 解决方案需要 0.50 秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:01:41.907

我建议使用[`StringTokenizer`](http://docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html)而不是`String.split()`. [正如在这个线程](https://stackoverflow.com/questions/691184/scanner-vs-stringtokenizer-vs-string-split)中所讨论的，它要快得多。

```
public static void main(String[] args) {

    String temp = "77"; // It can also be 0
    String inclusion = null;
    String exclusion = "100;77;71";
    boolean bb = false;

    if(inclusion !=null) {
        System.out.println("Site Inclusion is not null");
    } else {
        StringTokenizer st = new StringTokenizer(exclusion, ";");
        while (st.hasMoreTokens()) {
            if (temp.equals(st.nextToken())) {
                bb = true;
                break;
            }
        }
        if(!bb) {
            // Call some method
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:03:59.007

我能想到的最有效的实现是

```
for(int i = exclusion.indexOf(temp);
    i != -1;
    i = exclusion.indexOf(temp, i + 1)) {
  // check if it's bracketed by ; or by the end of the string
  boolean goodStart = i == 0 || exclusion.charAt(i - 1) == ';';
  boolean goodEnd = i + temp.length() == exclusion.length()
    || exclusion.charAt(i + temp.length()) == ';';
  if (goodStart && goodEnd) {
    bb = true;
    break;
  }
} 
```

这避免了正则表达式的开销，使用内置的`String.indexOf`，并且只使用常量额外变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T01:41:09.660

通过任何方式搜索字符串都是 O(N)。搜索 a`HashSet`是 O(1)。

用一个`HashSet.`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:12:51.007

```
bExists = Arrays.asList(exclusion.split(";")).contains(temp) 
```

# python - 当我的代码对输入进行排序时，为什么它在某些情况下不起作用？

> ID：10903164
> 
> 赞同：3
> 
> 时间：2012-06-05T18:53:37.863
> 
> 标签：python, sorting, input

我是 Python 新手。首先，代码应该接受一个输入（以“x/y/z”的形式，其中 x、y 和 z 是任何正整数）并将其拆分为三个不同的变量。

```
input = raw_input()
a, b, c = input.split("/", 2) 
```

我希望我的代码的第二部分采用这三个变量并根据它们的数值对它们进行排序。

```
order = [a, b, c]
print order
order.sort()
print order 
```

虽然这对于大多数输入都非常有效，但我发现对于输入“23/9/2”和“43/8/2”，输出尚未排序，因此未按正确顺序返回。关于什么可能导致诸如此类的输入不起作用的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-05T18:55:17.177

问题是您正在对字符串进行排序，并期望它们像整数一样排序。如果您想要数字排序，首先将您的字符串列表转换为整数列表。

```
>>> sorted(['23', '9', '2'])
['2', '23', '9']
>>> sorted(map(int, ['23', '9', '2']))
[2, 9, 23] 
```

以下是重写代码的方法：

```
input = raw_input()
a, b, c = map(int, input.split("/", 2))
order = [a, b, c]
print order
order.sort()
print order 
```

如果您需要将它们转换回字符串，只需使用`map(str, order)`. 请注意，在 Python 2.x 上`map()`返回一个列表，而在 3.x 上它将返回一个生成器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:55:35.323

您正在对字符串进行排序，但您应该对整数进行排序。因此，您必须使用以下命令将每个字符串转换为整数`int`：

```
order = [int(a), int(b), int(c)] 
```

# php - 与 Apache 的 worker MPM 和 mod_php 的连接未关闭

> ID：10903168
> 
> 赞同：0
> 
> 时间：2012-06-05T18:53:56.650
> 
> 标签：php, apache, worker

首先，我知道这是一个有问题的设置，但是 fastcgi 或 fcgid 的性能迫使我试一试。问题是由于连接未关闭，我的负载测试从未完成。当我推送到只有 40 个并发连接时，事情就变糟了——连接处于建立状态几分钟：

```
netstat -an|awk '/tcp/ {print $6}'|sort|uniq -c
      1 CLOSE_WAIT
     72 ESTABLISHED
      8 LISTEN 
```

然后几分钟后，它们分裂成 CLOSE_WAIT 和 ESTABLISHED 的混合体：

```
netstat -an|awk '/tcp/ {print $6}'|sort|uniq -c
     41 CLOSE_WAIT
     32 ESTABLISHED
      8 LISTEN 
```

又过了 10 分钟，这并没有改变。这些是客户端到 Web 服务器和 Web 服务器到 mysql 服务器的组合。如果我针对没有建立 mysql 连接的 php 页面进行测试，则一切正常。

我自定义编译了 PHP（配置如下），并通过 apt-get（Ubuntu 10.04）安装了 apache-mpm-worker。我尝试使用 msyql_config 和 mysqlnd 为 mysql、mysqli 和 pdo 模块编译 PHP。这可能只是一个非线程安全的库，它长着丑陋的脑袋吗？

`./configure --prefix=/usr/local --with-apxs2=/usr/bin/apxs2 --disable-cgi --with-layout=GNU --with-config-file-path=/etc/php5/apache2 --with-config-file-scan-dir=/etc/php5/apache2/conf.d --disable-ipv6 --without-kerberos --with-pcre-regex=/usr --with-zlib --with-zlib-dir=/usr --enable-bcmath --with-bz2 --enable-calendar --enable-ctype --with-curl=shared,/usr --without-qdbm --without-gdbm --with-db4 --with-libxml-dir=/usr --enable-exif --disable-ftp --with-gd=shared,/usr --enable-gd-native-ttf --with-gmp=shared,/usr --with-jpeg-dir=shared,/usr --with-xpm-dir=shared,/usr/X11R6 --with-png-dir=shared,/usr --with-freetype-dir=shared,/usr --with-gettext --with-mhash=shared,/usr --with-ldap=shared,/usr --with-ldap-sasl=/usr --with-mcrypt=shared,/usr --enable-mbstring --without-msql --without-mssql --with-pspell=shared,/usr --without-mm --disable-shmop --enable-soap --enable-sockets --with-regex=php --disable-sysvshm --disable-wddx --with-xmlrpc=shared --with-iconv --with-xsl=shared,/usr --enable-zip --with-pear=/usr/share/php --with-tsrm-pthreads --enable-maintainer-zts --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=myslqnd --with-libdir=lib64`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:15:43.467

对我有用的一种解决方案是将以下标志添加到 apache 设置中（我不使用 repo）：

```
export CFLAGS=-DNO_LINGCLOSE
./configure ... 
```

然后，当从 Peer 接收到 FIN 数据包时，这会迫使 apache 关闭套接字。

默认情况下，Apache 会在对等端发送 FIN 后将套接字放入 close_wait。此时，套接字被视为半关闭，等待本地对等方的 FIN，通常通过结束应用程序来完成。默认情况下，Apache 允许超时，通常为 2-5 分钟，具体取决于设置。

# c# - 在序列化/反序列化往返之后 DataServiceContext 不可用

> ID：10903170
> 
> 赞同：0
> 
> 时间：2012-06-05T18:54:02.100
> 
> 标签：c#, windows-phone-7, serialization, odata, tombstoning

我正在为我的 WP 7.1 应用程序中的墓碑支持而苦苦挣扎。我有一个长期存在的 DataServiceContext 实例，我使用 DataServiceState 助手对其进行序列化和反序列化。反序列化后，我可以使用 URI 作为查找键从上下文中成功检索我的 User 类的实例。例如，

```
var context= ... a deserialized DataServiceContext ...
var userIdentity = ... a URI that identifies a User instance ...
User user = null;
context.TryGetEntity(userIdentity.ToString(), out user); 
```

但是，如果我尝试在 User 实例上加载一个属性（我*刚刚从上下文中提取*），如下所示：

```
context.BeginLoadProperty(user, "Foo", MyCallback, null); 
```

上下文抛出 InvalidOperationException 消息“上下文当前未跟踪实体。” 反序列化似乎并不能保持上下文的引用完整性。

我创建了一个简单的应用程序来演示这个问题。从 Skydrive 下载：[http ://sdrv.ms/MhctLA](http://sdrv.ms/MhctLA)

[该应用程序使用http://services.odata.org/OData/OData.svc](http://services.odata.org/OData/OData.svc)上的示例数据服务。我手动运行 dataSvcUtil 在 ODataDemo.cs 中创建代理。请注意，我必须在生成的代码中为类 DemoService 添加 DataContract 属性，但没有进行其他更改。

应用程序运行后，点击“数据服务上下文”按钮。以下页面将从数据服务加载所有产品，从上下文中随机选择一个进行检索，缓存该产品的标识 URI，然后加载该产品的 Category 属性。

接下来，点击“序列化”按钮。应用使用 DataServiceState 序列化上下文。

最后，点击“反序列化”按钮。应用程序反序列化上下文，然后针对复活的上下文尝试以下操作：

1.  使用 DataServiceContext.TryGetEntity 和缓存的 URI 获取产品。
2.  使用 DataServiceContext.TryGetUri 获取同一产品的 URI。
3.  加载产品的 Category 属性。

第 1 步成功，第 2 步和第 3 步失败。TryGetUri 找不到我刚刚从上下文中检索到的实体的描述符这一事实表明反序列化的上下文有问题。

我做错了什么可怕的事情吗？或者这是一个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:53:03.090

我会看看这个并尽快回复你。感谢您分享您的复制项目，它将很有用。

编辑：看起来这是一个错误。一种解决方法是丢弃上下文实例并将实例附加到新上下文。

# python - 如何在python中打印板？

> ID：10903176
> 
> 赞同：2
> 
> 时间：2012-06-05T18:54:28.063
> 
> 标签：python

我正在尝试在 Python 上编写名为三元组的游戏，但我的棋盘输出有问题，每个方格都必须是这样，每个数字代表一个基点，有 9 个方格，每个方格三个线。

```
| 1 | 1 | 9 |

|2@3|1*6|7*2|

| 4 | 1 | 2 | 
```

我想为每一行做一个列表，并以每个基点的数字开始棋盘，例如，如果它是北方或类似的东西，则为“0”，所以当我必须用卡片的数字替换时，我完全知道每个要点放在哪里，有什么建议吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:59:25.180

你可以用三个列表来表示这个板：

```
["1", "1", "9"]
["2@3", "1*6", "7*2"]
["4", "1", "2"] 
```

或者一起放在一个列表中：

```
board = [["1", "1", "9"], ["2@3", "1*6", "7*2"], ["4", "1", "2"]] 
```

您现在需要编写两个函数：

*   一个函数，它获取这个列表并`|`在中间打印你的板。
*   计算上述列表并确定板上每个单元格的正确值的函数。

你不需要处理数字或其他任何事情，这都是做这两件事的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:12:42.657

这是获取所需格式的简单方法：

```
def format_row(row):
    return '|' + '|'.join('{0:^3s}'.format(x) for x in row) + '|'

def format_board(board):
    # for a single list with 9 elements uncomment the following line:
    # return '\n\n'.join(format_row(row) for row in zip(*[iter(board)]*3))
    # for a 3x3 list:
    return '\n\n'.join(format_row(row) for row in board) 
```

例子：

```
>>> print format_board([['1', '1', '9'], ['2@3', '1*6', '7*2'], ['4', '1', '2']])
| 1 | 1 | 9 |

|2@3|1*6|7*2|

| 4 | 1 | 2 | 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:26:36.903

我查看了 Triple Triad 的牌（我现在记得那个游戏，有趣的东西），我不明白你板上的 @ 或 * 是什么意思。如果您尝试表示它，那么这里有一些将显示数字的代码：

```
def cardString(card):
    if (card):
        return '{west},{north},{south},{east}'.format(**card)
    else:
        return '-,-,-,-'

def printBoard(board):
    for row in board:
        print('{}|{}|{}'.format(cardString(row[0]), cardString(row[1]), cardString(row[2])))

cardMoogle = {'north':9, 'east':3, 'west':2, 'south':9}
cardNull = {'north':'-', 'east':'-', 'west':'-', 'south':'-'}
# I'm sure there's a better way to do this list, but I'm new to Python.
board = [cardNull]*3
board = [list(board), list(board), list(board)]
board[0][0] = cardMoogle

printBoard(board) 
```

这有用吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T13:19:58.633

这可能有点矫枉过正，但以下 Matrix 类可以自动创建自身的表示：

```
class Matrix:

    def __init__(self, rows, columns):
        self.__data = tuple([None] * columns for row in range(rows))
        self.__rows, self.__columns = rows, columns

    def __repr__(self):
        table = Matrix(self.rows, self.columns)
        rows, columns = [0] * self.rows, [0] * self.columns
        for (row, column), value in self:
            lines = tuple(repr(value).replace('\r\n', '\n')
                          .replace('\r', '\n').split('\n'))
            table[row, column] = self.__yield(lines)
            rows[row] = max(rows[row], len(lines))
            columns[column] = max(columns[column], max(map(len, lines)))
        return ('\n' + '+'.join('-' * column for column in columns) + '\n') \
               .join('\n'.join('|'.join(next(table[row, column])
               .ljust(columns[column]) for column in range(table.columns))
               for line in range(rows[row])) for row in range(table.rows))

    def __len__(self):
        return self.rows * self.columns

    def __getitem__(self, key):
        row, column = key
        return self.__data[row][column]

    def __setitem__(self, key, value):
        row, column = key
        self.__data[row][column] = value

    def __delitem__(self, key):
        self[key] = None

    def __iter__(self):
        for row in range(self.rows):
            for column in range(self.columns):
                key = row, column
                yield key, self[key]

    def __reversed__(self):
        for row in range(self.rows - 1, -1, -1):
            for column in range(self.columns - 1, -1, -1):
                key = row, column
                yield key, self[key]

    def __contains__(self, item):
        for row in self.__data:
            if item in row:
                return True
        return False

    def freeze(self):
        self.__data = tuple(map(tuple, self.__data))

    def thaw(self):
        self.__data = tuple(map(list, self.__data))

    @property
    def rows(self):
        return self.__rows

    @property
    def columns(self):
        return self.__columns

    @staticmethod
    def __yield(lines):
        for line in lines:
            yield line
        while True:
            yield '' 
```

如果您需要一种设置、相加或相乘矩阵的方法，这些函数可作为您的操作补充：

```
def set_matrix(matrix, array):
    for y, row in enumerate(array):
        for x, item in enumerate(row):
            matrix[y, x] = item

def add_matrix(a, b):
    assert a.rows == b.rows and a.columns == b.columns
    c = Matrix(a.rows, a.columns)
    for key, _ in c:
        c[key] = a[key] + b[key]
    return c

def mul_matrix(a, b):
    assert a.columns == b.rows
    c = Matrix(a.rows, b.columns)
    for key, _ in c:
        row, column = key
        c[key] = sum(j * k for j, k in
                     zip((a[row, i] for i in range(a.columns)),
                         (b[i, column] for i in range(b.rows))))
    return c 
```

# c++ - 从 std::string 复制到 char 数组并以空值结尾的结果

> ID：10903181
> 
> 赞同：6
> 
> 时间：2012-06-05T18:54:50.903
> 
> 标签：c++, string

我有一个 Visual Studio 2008 C++03 应用程序，我想在其中从 std::string 复制到 char 数组，但我需要 char 数组以空终止，即使它必须截断字符串才能这样做。

例如，这可以按需要工作：

```
inline void CopyAndNullTerminate( const std::string& source, 
                                  char* dest, 
                                  size_t dest_size )
{
    source.copy( dest, dest_size );
    using std::min;
    char* end = dest + min( dest_size - 1, source.size() );
    *end = '\0';
}

int main()
{
    enum{ MAX_STRING_SIZE = 15 };
    char dest[ MAX_STRING_SIZE ];
    std::string test = "This is a test";

    CopyAndNullTerminate( test, dest, MAX_STRING_SIZE );

    assert( strcmp( test.c_str(), dest ) == 0 );
    return 0;
} 
```

示例：http: [//ideone.com/0EBYb](http://ideone.com/0EBYb)

有没有更短、更有效的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-05T18:58:37.507

是的，使用[`strncpy`](http://www.cplusplus.com/reference/clibrary/cstring/strncpy/)，定义在`cstring`：

```
void copyString(const std::string& input, char *dst, size_t dst_size)
{
    strncpy(dst, input.c_str(), dst_size - 1);
    dst[dst_size - 1] = '\0';
} 
```

请注意，对于`std::string`（如@K-ballo 所指出的）的某些实现，这可能更短，但效率较低。这是因为`std::string`不能保证使用 C 样式字符串来实现，尽管在大多数情况下可能是这种情况。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-05T20:10:30.003

假设`dest_size`保证至少为 1 （这对我来说似乎是合理的，因为否则不可能将任何内容复制和 null 终止到缓冲区中）：

```
inline void CopyAndNullTerminate( const std::string& source, 
                                  char* dest, 
                                  size_t dest_size )
{
    dest[source.copy(dest, dest_size-1)] = 0;
} 
```

在 C++11 和所有积极维护的 C++03 实现（包括 Visual Studio）中，`std::string`具有连续存储，就像`std::vector`. 因此，您可以使用`memcpy`代替`std::string::copy`并比较性能。

同样，您可以比较`strncpy`、`std::copy`、`std::copy_n`、`strcpy_s`以及可能我忘记的其他内容，看看哪个是最佳优化的。在每种情况下，您都可以将要复制的字节数计算为`std::min(source.size(), dest_size-1)`. 这也避免了最低效的情况`strncpy`（将小字符串复制到大缓冲区中）。

在执行所有这些操作时，您可以依赖这样一个事实：即使是空字符串，调用*也是有效的。*`source[0]``source`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-05T19:09:28.353

如果您首先初始化您的目标字符串（为 null），那么如果您不覆盖数组中的最后一个元素，您可以得到它将以 null 终止。

```
enum{ MAX_STRING_SIZE = 15 };

char dest[ MAX_STRING_SIZE ] = {0}; // all elements are initialized to 0
std::string test = "This is a test";

// determine the length to copy, it will be the min of MAX_STRING_SIZE-1 
// or test.size.  This will ensure that even if the string it shorter than
// the MAX_STRING_SIZE, that it will copy properly -- without reading past the
// array bounds of the string.
auto copy_len = std::min(test.size(), MAX_STRING_SIZE - 1);

std::copy(
   test.begin(),
   test.begin() + copy_len,
   dest); 
```

*这将最多*复制14 个字符到您的`dest`对象。如果测试字符串少于 14 个字符，它只会复制测试字符串的长度。所有未复制的元素将保持其初始化值（null）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-05T20:26:05.400

这里有一对更短的：

```
inline void CopyAndNullTerminate( const std::string& source, 
                                  char* dest, 
                                  size_t dest_size )
{
    *dest = '\0'; // assumes `dest_size > 0`
    strncat(dest, source, dest_size);
}

void CopyAndNullTerminate(std::string const &source,
                          char *dest,
                          size_t dest_size) { 
    sprintf(dest, "%*s", dest_size, source.c_str());
} 
```

效率可能会引发更多问题，但我认为没有任何理由相信两者都会特别慢。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T19:01:24.093

好的 ole' C strcpy_s 怎么样？

```
strcpy_s(dest, MAX_STRING_SIZE, test.c_str()); 
```

我更喜欢这个`strncpy`。（`strcpy_s`和它的老表亲`strlcpy`）复制循环将在复制 '\0' 后终止，但`strncpy`总是会写出指定的字节数（如果源字符串较短，则用 '\0' 填充）。

# mercurial - hg grep --排除模式

> ID：10903182
> 
> 赞同：5
> 
> 时间：2012-06-05T18:54:54.210
> 
> 标签：mercurial, grep

使用时如何指定`--exclude`/`-X`参数`hg grep`？

我已经尝试过我遇到的所有类型的裸语法和模式语法（包括我知道的一些正则表达式方言），但我什至无法让它与最简单的示例一起使用。

我最感兴趣的是`*.min.js`从搜索中过滤掉一些二进制文件和缩小的 JavaScript 文件 ( )。

如果合适的话，我在 Windows 上。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T19:12:32.707

见[`hg help patterns`](http://www.selenic.com/hg/help/patterns)。默认情况下，该模式被视为 shell glob。

如果你想使用正则表达式，你可以尝试这样的事情：

```
hg grep -X "re:.*\.min\.js$" <search term> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-10-23T22:17:23.947

`hg help patterns`解释说，`Globs are rooted at the current directory; a glob such as "*.c" will only match files in the current directory ending with ".c".` 所以要使用 glob 匹配任何带有扩展名的文件，`.min.js`您需要一个前导通配符，例如`--exclude '**/*.min.js'`

# jquery - Safari 不发送跨子域 Cookie

> ID：10903185
> 
> 赞同：1
> 
> 时间：2012-06-05T18:55:11.240
> 
> 标签：jquery, ajax, cookies, safari, cross-domain

我们有网站 > **main.example.com**

我们有一个移动网站 > **mobile.example.com**

我们的 cookie 域是 > **.example.com**

我们的移动网站是一个客户端（骨干）繁重的应用程序，它只为我们的主网站制作 $.ajax。

现在 Safari 和 Chrome 都不会将 cookie 与 ajax 请求一起发送。我可以看到 cookie 使用开发人员工具存储在存储中，但浏览器无法识别并且没有将它们包含在请求中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:54:03.170

几个月前我在开发使用backbone.js 并通过cors 使用restful api 的网站时遇到了这个麻烦。我了解到 cors 请求默认情况下不发送 cookie，您还必须告诉 javascript 在请求中发送它。

您所要做的就是将带有选项的 xhrfields 传递给 $.ajax 请求

```
 xhrFields: {withCredentials: true} 
```

# c# - 将一个 MVVM 应用程序解耦为 web 服务和客户端的最佳方法是什么

> ID：10903188
> 
> 赞同：1
> 
> 时间：2012-06-05T18:55:28.207
> 
> 标签：c#, wpf, wcf

将一个 MVVM 应用程序解耦为 web 服务和客户端的最佳方法是什么。

该应用程序还处于早期阶段，正在使用 MVVM Light 进行开发。最近产生了对 Web 服务的业务逻辑的需求，以便它可用于移动客户端（Android、BB）。

有一些“如何”或指南，我可以指导我正确地做到这一点

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:32:42.697

MVVM 模式是一种在客户端使用的表示模式。它不应该影响您的系统架构。通常，视图模型负责处理视图的行为。您希望在视图模型中与您的服务进行交互。

我建议您提取您的业务逻辑并将它们作为多个客户端可以使用的服务，包括您的 WPF 客户端。

# sharepoint - 尝试将列表从 Sharepoint 导入 Excel

> ID：10903190
> 
> 赞同：0
> 
> 时间：2012-06-05T18:55:36.457
> 
> 标签：sharepoint, vba, sharepoint-2010, excel

我正在尝试将 Sharepoint 列表导入 Excel 2010 工作表。下面的代码在 2003 年有效，但在 Excel 2010 中无效。

```
Set TempSheet = ThisWorkbook.Sheets.Add
TempSheet.Name = ("TEMP")
Set TempSheet2 = Sheets("TEMP")
TempSheet2.Activate    

------ the code below is the issue ----------------

Dim src(2) As Variant
src(0) = "https://REDACTED/exceptions/_vti_bin/"
src(1) = "{72B6638E-0E7B-4B37-A6A5-3142033E4E02}"
src(2) = "{163702D0-A380-467F-B883-1195F4F40616}"

TempSheet2.ListObjects.Add xlSrcExternal, src, True, xlYes, TempSheet2.Range("A2") 
```

我收到运行时错误消息 1004。数据源初始化失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:23:52.470

I haven't run into this myself, but OfficeWriter has a sharepoint plugin that exports data from lists into excel workbooks. See [http://www.officewriter.com/sharepoint](http://www.officewriter.com/sharepoint). Disclaimer: I didn't work on this plugin, but I did work on the last version of OfficeWriter.

# version-control - 如何设置 Jenkins 来构建我的项目的所有版本？

> ID：10903192
> 
> 赞同：3
> 
> 时间：2012-06-05T18:55:38.847
> 
> 标签：version-control, continuous-integration, hudson, jenkins

我正在通过颠覆学习整个版本控制，并为项目的所有不同工作/版本使用主干、分支、标签等。我也在尝试使用与 Jenkins 的持续集成来加快速度（尝试了 ccnet，设置真是一场噩梦！）。

所以我的问题是，如果我的项目 SVN 中有以下区域：

```
file:///E:/Data/SVN/MyProject/trunk
file:///E:/Data/SVN/MyProject/tags/version_1.0
file:///E:/Data/SVN/MyProject/branch/version_1.1 
```

.. 在 Jenkins 中设置此构建项目的最佳实践是什么，以便持续监控我的 SVN 中的所有不同区域并构建任何更改？

我是否会设置一个项目，其中包含多个源代码存储库，每个版本/主干等一个？或者我会设置多个构建项目吗？我该怎么做？

**编辑：**我应该为此使用矩阵项目（构建多配置项目）吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T19:42:08.380

对于夜间构建（那些运行相对不频繁且需要较长时间的构建，通常是由于在其中完成了更多的自动化测试），矩阵项目非常适合。它的主要优点是“一点变化”——您不必编辑多个作业即可将相同的更改引入您的构建中。当然，这只适用于作业在分支之间几乎没有变化的情况（顺便说一下，这种变化通常可以由[Run Condition Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Run+Condition+Plugin)巧妙地处理）。

在这种情况下，多配置项目可能不是最适合交付构建（交付构建在开发人员提交到存储库以检查他/她的更改是否集成良好时运行）。原因是，如果您致力于主干，您只想构建主干，但矩阵构建将构建所有内容（消耗计算资源和时间）。

对于交付构建，我将使用参数化构建，其中主要参数是要构建的分支。该构建可以由 SVN 挂钩触发（请参阅[此文档](http://jenkins-ci.org/node/212)）。或者，您可以为每个将轮询分支（通过[Subversion 插件）的分支关联一个触发器构建，并通过](https://wiki.jenkins-ci.org/display/JENKINS/Subversion+Plugin)[Parameterized Trigger plugin](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin)使用适当的参数触发您的主构建。

顺便说一句，我实际上使用了所有上述方法（除了 SVN 钩子，我不再这样做，不完全是技术原因）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T19:32:59.977

设置多个作业，一个用于您要构建的每个分支/标签。一旦你得到一个工作正常，你可以复制它来创建其余的，只更改 SVN URL。

当您停止维护这些标签/分支时，您还应该摆脱旧工作，以免您的 Jenkins 配置失控。

# crystal-reports - 删除水晶报表 2008 中子报表中的重复项

> ID：10903202
> 
> 赞同：0
> 
> 时间：2012-06-05T18:56:34.627
> 
> 标签：crystal-reports, report

我有一份包含 3 个子报告的报告。子报告提出了我需要抑制的重复数据。

[http://i.imgur.com/7wmZf](http://i.imgur.com/7wmZf)

（对不起，我无法发布图片；网站上的新手）

包含的列是需要抑制的子报表。

如果重复并且没有运气，我已经尝试使用抑制和抑制。任何帮助表示赞赏！

谢谢， CR新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:06:15.817

编辑每个子报表的查询，使它们具有“SELECT DISTINCT ...”而不仅仅是“SELECT ...”

那应该消除你的欺骗。

# birt - Birt - 如何显示数据行元素的默认值

> ID：10903205
> 
> 赞同：0
> 
> 时间：2012-06-05T18:56:45.443
> 
> 标签：birt

因此，我希望表中的一个字段显示数据中的值（如果它不为空白），否则显示一些文本。

我试着用这个作为我的表达方式：

```
dataSetRow["date_billed"] || "Not Yet Billed" 
```

但它似乎没有用。

有没有我错过的技巧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T11:19:38.937

尝试使用包含以下表达式的动态文本报告项替换现有数据字段：

```
{row["date_billed"]>"" ? row["date_billed"] : "Not Yet Billed"} 
```

# mysql - 使用 JDBC 启用 MySQL 通用查询日志

> ID：10903206
> 
> 赞同：18
> 
> 时间：2012-06-05T18:56:53.430
> 
> 标签：mysql, logging, jdbc

有没有办法通过 JDBC 启用 MySQL 通用查询日志记录？我通过搜索找到的最接近的东西是能够通过 JDBC 记录慢速查询 (http://dev.mysql.com/doc/refman/5.5/en/connector-j-reference-configuration-properties.html)。也许我应该这样做并将慢查询阈值设置为 0 毫秒？

我想通过 MySQL 以人类可读的格式记录所有查询，并想指定应该写入日志文件的位置。我知道我的性能会受到影响，但我的应用程序只有一个用户，而且非常简单，如果性能受到明显影响，我会感到惊讶。无论如何我都想试试看。

我相信我的另一个选择是打开二进制日志并使用 mysqlbinlog 将二进制日志转换为人类可读的格式，但听起来一般查询日志会提供一种更简单的方法来获得我想要的东西。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-23T07:30:54.683

您可以像这样在 JDBC URL 中启用日志记录：

```
jdbc:mysql://host/db?logger=com.mysql.jdbc.log.Log4JLogger&profileSQL=true 
```

其他日志后端可用（CommonsLogger、Slf4jLogger、JDK14Logger）。我相信由于许可问题，直接 Log4J 日志记录在某些时候被丢弃，因此它可能不适用于您的 JDBC 驱动程序版本。

自然，您需要在类路径中包含相关日志库的 JAR，以及一个配置文件 (log4j.properties)。我会首先将根级别设置为 TRACE 以查看正在发生的事情，并在您看到正在记录的内容后按日志级别和类别将其收紧。

进一步阅读：

*   [https://dev.mysql.com/doc/connector-j/en/connector-j-reference-configuration-properties.html](https://dev.mysql.com/doc/connector-j/en/connector-j-reference-configuration-properties.html)
*   [http://docs.oracle.com/cd/E17952_01/mysql-monitor-2.3-en/mem-qanal-using-cj.html](http://docs.oracle.com/cd/E17952_01/mysql-monitor-2.3-en/mem-qanal-using-cj.html)

高温高压

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-01-14T02:19:08.400

将“logger”和“profileSQL”添加到 jdbc url：

```
&logger=com.mysql.jdbc.log.Slf4JLogger&profileSQL=true 
```

然后你会得到下面的 SQL 语句：

```
2016-01-14 10:09:43  INFO MySQL - FETCH created: Thu Jan 14 10:09:43 CST 2016 duration: 1 connection: 19130945 statement: 999 resultset: 0
2016-01-14 10:09:43  INFO MySQL - QUERY created: Thu Jan 14 10:09:43 CST 2016 duration: 1 connection: 19130945 statement: 999 resultset: 0 message: SET sql_mode='NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES'
2016-01-14 10:09:43  INFO MySQL - FETCH created: Thu Jan 14 10:09:43 CST 2016 duration: 1 connection: 19130945 statement: 999 resultset: 0
2016-01-14 10:09:43  INFO MySQL - QUERY created: Thu Jan 14 10:09:43 CST 2016 duration: 2 connection: 19130945 statement: 13 resultset: 17 message: select 1
2016-01-14 10:09:43  INFO MySQL - FETCH created: Thu Jan 14 10:09:43 CST 2016 duration: 0 connection: 19130945 statement: 13 resultset: 17
2016-01-14 10:09:43  INFO MySQL - QUERY created: Thu Jan 14 10:09:43 CST 2016 duration: 1 connection: 19130945 statement: 15 resultset: 18 message: select @@session.tx_read_only
2016-01-14 10:09:43  INFO MySQL - FETCH created: Thu Jan 14 10:09:43 CST 2016 duration: 0 connection: 19130945 statement: 15 resultset: 18
2016-01-14 10:09:43  INFO MySQL - QUERY created: Thu Jan 14 10:09:43 CST 2016 duration: 2 connection: 19130945 statement: 14 resultset: 0 message: update sequence set seq=seq+incr where name='demo' and seq=4602
2016-01-14 10:09:43  INFO MySQL - FETCH created: Thu Jan 14 10:09:43 CST 2016 duration: 0 connection: 19130945 statement: 14 resultset: 0 
```

默认记录器是：

```
com.mysql.jdbc.log.StandardLogger 
```

Mysql jdbc 属性列表：[https ://dev.mysql.com/doc/connector-j/en/connector-j-reference-configuration-properties.html](https://dev.mysql.com/doc/connector-j/en/connector-j-reference-configuration-properties.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T19:07:58.213

如果您正在使用 Hibernate，并通过它执行所有数据访问，则可以通过将属性设置为 true 来打开日志记录`hibernate.show_sql`。不过，这将编写参数化语句（例如`SELECT foo.id FROM foo WHERE foo.bar = ?`）。如果您需要参数值，或者不使用 Hibernate 之类的工具，您可能需要让 MySQL 写入此日志。[请参阅一般查询日志](http://dev.mysql.com/doc/refman/5.5/en/query-log.html)上的 MySQL 文档。

FWIW，MySQL 二进制日志是达到不同目的的一种手段；它记录对数据的更改，并用于增量备份和/或复制。 `SELECT`语句不会记录在二进制日志中。

**编辑：** 我能够通过将以下两行添加到 my.cnf （在确认两个变量都没有设置之后）并重新启动 MySQL 来让 MySQL 写入常规日志：

```
 general_log = 1
general_log_file=/tmp/mysql-general.log 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-24T22:52:49.917

我最终找到了解决方法。我通过在运行时使用以下 SQL 查询修改 MySQL 全局系统变量，通过 Java 启用 MySQL 常规查询日志记录。

```
SET GLOBAL log_output="FILE"
SET GLOBAL general_log_file="Path/File"
SET GLOBAL general_log='ON' 
```

我建议在 general_log_file 路径中使用正斜杠。即使在 Windows 环境中，我也无法使用反斜杠。

我使用以下 SQL 查询在运行时禁用常规查询日志记录。

```
SET GLOBAL general_log='OFF' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-30T19:40:34.877

将 MySQL 与*mysql-connector-java-8.0.13.jar*一起使用，我将其添加`profileSQL=true`到我的 JDBC 连接 URL。例如：

```
jdbc:mysql://${HOST}:${PORT}/${SCHEMA}?autoReconnect=true&profileSQL=true 
```

您也可以添加`&logger=com.mysql.cj.log.StandardLogger`到 URL，但不是必需的，因为它是文档中指示的默认值。

文档参考：

> [https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-configuration-properties.html](https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-configuration-properties.html)

日志输出读起来很烦人，因为它包含一个堆栈跟踪，指示查询在代码中的确切位置运行。如果有人想出排除堆栈跟踪的方法，请告诉我。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-27T13:52:30.167

对于 Spring Boot 的最新 MySQL 驱动程序版本，添加到 JDBC 连接 URL：

```
spring.datasource.url: jdbc:mysql://localhost:49172/INTEGRATION_DB?logger=com.mysql.cj.log.Slf4JLogger&profileSQL=true 
```

它将使用 Slf4J 记录器。如果没有这样的记录器，可以使用标准记录器：`logger=com.mysql.cj.log.StandardLogger`

也可以使用自定义记录器，只需实现接口`com.mysql.cj.log.Log`并在连接 URL 中指定一个新的记录器。

# ember.js - Ember.Object.create 从我的原始对象中删除函数

> ID：10903218
> 
> 赞同：1
> 
> 时间：2012-06-05T18:57:37.793
> 
> 标签：ember.js

我正在使用复杂的 javascript 对象，我想将其包装到 Ember.Object.create 中，这样我就可以从属性绑定中受益。然而，当我创建我的 ember 对象时，我失去了我在初始对象中的所有功能，但所有属性都被转移了。

这是一个例子：

[http://jsfiddle.net/kcjzw/88/](http://jsfiddle.net/kcjzw/88/)

在 Ember.Object.create 之后，作为原始对象一部分的引入函数会丢失。有没有办法在保持 Ember.Object.create 的好处的同时保持原型功能。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T04:33:46.583

您可以在不使用 Ember 对象系统的情况下使用 Ember 的绑定。

这是一个`Ember.bind()`用于设置与其他对象的绑定的示例。`Ember.run.sync()`在绑定设置和属性更改后，调用是同步绑定所必需的。

[http://jsfiddle.net/kcjzw/95/](http://jsfiddle.net/kcjzw/95/)

# php - 在 ajax 响应文本中发送 json 字符串和 html 数据 - 如何？

> ID：10903225
> 
> 赞同：0
> 
> 时间：2012-06-05T18:58:07.627
> 
> 标签：php, javascript, html, ajax, json

对于少量文本信息（控制消息），我会在 ajax 调用期间发送我所谓的项目符号（与 HTML 注释相同的语法）以及我的页面。例如

```
<!--Control Message--><html> all my page here</html> 
```

然后我在渲染页面之前解析出“子弹”......即使我真的不需要。

对于更多数据，比如 5 个变量，我计划对它进行 json_encoding ......并将其与页面一起发送。

其他人如何从 html 中划分和提取结构化数据/json 字符串。我可以把它放在像下面这样的“子弹”中并将其提取出来......但我的猜测是有一种更“正确”的方式来做到这一点。

```
<!--json string here--><html> all my page here</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T19:01:38.087

如果您通过 AJAX 传递它，只需将 HTML 嵌入 JSON 并将该 JSON 解析为一个整体：

```
{
    "html":"<html>...</html>",
    "other_data":...,
    "some_more_data":...
}

//access it later:
data.html
data.other_data
data.some_more_data 
```

如果此数据与页面一起加载，请将数据存储在变量中：

```
<html>
    <head>
        <script>
            var data = <?= json_encode($data) ?>; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:10:57.630

如果数据与 HTML 相关，那么将它们作为 HTML 中的数据标签发送会更好吗？

```
<html data-value="{name:value}">
    <body>
        <div data-div="{name:value}">
    </body>
</html> 
```

# sql-server-2008 - 触发ddl触发器时如何获取存储过程的脚本？

> ID：10903227
> 
> 赞同：0
> 
> 时间：2012-06-05T18:58:13.070
> 
> 标签：sql-server-2008, stored-procedures, ddl

我正在为创建和更改存储过程编写 ddl 触发器。

对于创建存储过程触发器，我想获取创建语句的脚本。对于更改存储过程触发器，我想获得新的“创建存储过程”语句而不是更改语句。

有什么办法吗？对于第一个，我知道 eventdata() 可以做到。但对于第二个，我不确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:07:52.797

在 DDL 触发器中，您可以使用以下方法获取过程的“之后”图像：

```
DECLARE @EventData XML = EVENTDATA();

SELECT OBJECT_DEFINITION(OBJECT_ID(
   @EventData.value('(/EVENT_INSTANCE/SchemaName)[1]', 'NVARCHAR(255)')
   + '.' + 
   @EventData.value('(/EVENT_INSTANCE/ObjectName)[1]', 'NVARCHAR(255)')
)); 
```

因此，您可以将该输出分配给一个变量并使其成为插入的一部分（我假设您将其记录到某种 DDL 审计表中）。正如我在评论中建议的那样，您还可以执行以下操作：

```
DECLARE @EventData XML = EVENTDATA();

SELECT STUFF(@EventData.value('(/EVENT_INSTANCE/TSQLCommand)[1]', 'NVARCHAR(MAX)'), 
  1, 5, 'CREATE'); 
```

（这些都假设您的 DDL 触发器仅限于 ALTER_PROCEDURE - 否则您需要在执行这些操作之前检查事件类型。）

# jquery - jquery .html 在 Firefox 中不起作用

> ID：10903231
> 
> 赞同：0
> 
> 时间：2012-06-05T18:58:31.627
> 
> 标签：jquery, html, firefox

所以我有一个页面，我有一个客户的报价请求表。

文档类型是

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US"> 
```

我正在做的是，通过 jquery 生成表单提交按钮，因此如果客户端浏览器禁用了 js，则不会出现提交按钮。

HTML如下。

```
 <div id="buttonscript">

    </div> 
```

jQuery

```
<script type="text/javascript" >
   $(document).ready(function(){
   $("#buttonscript").html('<input type=\"image\" name=\"Submit\" src=\"<?=$img_dir?>/button-submit_off.png\" alt=\"Submit\" class=\"nostyle\" style=\"margin-left:-4px;\" />');
});
</script> 
```

它在所有浏览器中都可以正常工作，但似乎是 FF。

我`$(document).ready(function() {`在页面上有另一个这会导致冲突吗？

第二个是在表单上调用 jquery.validate 插件。

**更新**

尝试在“。没有工作之前删除所有转义符。据我所知，控制台中没有错误。在任何地方都可以正常工作，但 FF。

**更新** **我是菜鸟**

无论如何，大声笑，我意识到必须有一些时髦的事情发生，考虑到我知道即将出现的错误表明 jquery 未定义....然后我记得一个 .htaccess 指令允许脚本只能从同一个域运行，我以前一直在托管我的 jquery 库，但决定让谷歌为我做这件事....换句话说，我的任何代码都没有错误...这是服务器配置..终于弄明白了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:42:52.597

如果您将文档类型更改为 ，它会起作用`<!DOCTYPE html>`吗？

如果发生冲突，请尝试像这样包装您的代码：

```
(function($){
    // safely use $ as an alias for jQuery in here
}(jQuery)); 
```

如果您在控制台中查看 DOM，是否插入了任何内容？换句话说，问题是没有插入任何内容，还是插入的内容不正确？

无论如何，我认为对于您正在尝试做的事情有一个更好的解决方案：在您的`html`标签上添加一个`no-js`类：

```
<html class="no-js"> 
```

然后通过 jQuery 删除类：

```
jQuery(function($){
    $('html').removeClass('no-js').addClass('js');
}); 
```

然后你可以硬编码`input`但在没有 JavaScript 时隐藏它。在 CSS 中，你可以这样写：

```
.no-js #buttonscript{ display:none; } 
```

然后你完全不用担心插入它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:03:36.400

想知道为什么在您开始使用单个配额时在双配额中添加斜杠

```
'<input type=\" 
```

尝试删除斜线

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:27:13.173

这一切都归结为服务器配置。意识到 jquery 库现在是在外部托管的。我有一个 .htaccess 指令阻止外部脚本。愚蠢的我，我忘了我很久以前就做过了！

# linux - slim 的自动登录问题

> ID：10903235
> 
> 赞同：0
> 
> 时间：2012-06-05T18:58:45.583
> 
> 标签：linux, arm, xterm, raspberry-pi

我已经安装了 Arch，但在 slim.conf 中的自动登录选项有问题。我已经安装了以下 X 包：

xorg-server,
xorg-xinit
xorg-twm, xterm
和图形：xf86-video-fbdev

我还添加了用户和密码，并更改了 sudoers 文件以适应。我更改了以下几行：

# default_user simone
# auto_login no

至：

default_user jon
auto_login 是

我已经设法通过编辑 /etc/inittab 让苗条的登录提示出现在启动时，但是为绕过它所做的更改并没有那么成功。

有人知道我错过了什么吗？也许与将用户添加到某个组有关？！

干杯J

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T09:37:53.273

看来这是Arch的ARM版本的问题，并且是树莓派的事情。我的一个朋友遇到了同样的问题，但发现最新版本包含各种修复。似乎可以解决问题。

# msbuild - MSDeploy 任务和预同步

> ID：10903248
> 
> 赞同：0
> 
> 时间：2012-06-05T19:00:20.463
> 
> 标签：msbuild, msdeploy, web-deployment, msbuild-task

是否可以通过 MSDeploy 任务指定 preSync/postSync 命令？如果没有，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:36:03.147

您使用的是哪种 MSDeploy 任务？如果它是通过 msdeploy.exe 的 Exec，那么是的，当然，如果它是某种不直接支持它们的包装器，那么您可以通过使用 run-command 提供程序再次调用同步来模拟它们，因为 pre/post-sync 只是在 try/catch/finally 结构中再次调用同步，无论如何都包含主同步。

```
private int ExecuteWorker()
{
    ...
    if (!this.HandleAuxillarySync("-preSync", this._commandLine._preSyncParameters, retbaseOptions2))
        return -1;
    DeploymentChangeSummary deploymentChangeSummary;
    try
    {
        deploymentChangeSummary = @object.SyncTo(retproviderOptions2, retbaseOptions2, syncOptions);
    }
    ...
    finally
    {
        this.HandleAuxillarySync("-postSync", this._commandLine._postSyncParameters, retbaseOptions2);
    }
    this.HandleAuxillarySync("-postSyncOnSuccess", this._commandLine._postSyncOnSuccessParameters, retbaseOptions2);
    ...

private bool HandleAuxillarySync(string syncType, Dictionary<string, string> sourceParameters, DeploymentBaseOptions destBaseOptions)
{
    ...
    try
    {
        using (DeploymentObject @object = DeploymentManager.CreateObject(retproviderOptions, retbaseOptions))
        @object.SyncTo(destBaseOptions, syncOptions);
            flag = true;
    } 
```

# sql - 我不确定在 SQL 中声明这些变量时出了什么问题

> ID：10903256
> 
> 赞同：9
> 
> 时间：2012-06-05T19:01:11.157
> 
> 标签：sql, sql-server-2008

我有以下代码：

```
USE pricingdb
go

CREATE TABLE dbo.Events_060107_2012
(
    Date_Time varchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    Event_Type TEXT,
    Month_of_Year TEXT,
    Survey DOUBLE,
    Actual DOUBLE,
    Prior_Data DOUBLE,
    Revised DOUBLE,
    Relevance FLOAT,
    Ticker TEXT
); 
```

去

我得到一个错误：

```
"Incorrect syntax near ','.  Level 15, State 1, Line 6" 
```

我知道这应该是一个很容易解决的问题，但无论出于何种原因，我在理解如何解决这个问题时遇到了很多麻烦。我对 SQL 的了解充其量只是初学者，所以我读过的大多数其他线程都在我头上。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-05T19:03:51.240

DOUBLE 不是 sql server 中的有效数据类型

使用 float、numeric、... 或任何其他受支持的类型。

更多信息请访问[http://msdn.microsoft.com/en-us/library/ms187752.aspx](http://msdn.microsoft.com/en-us/library/ms187752.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:12:07.733

两个问题。首先是没有双精度数据类型。第二个是 float 需要一个大小来表示精度的差异。与上述等效的创建查询是：

```
CREATE TABLE dbo.Events_060107_2012
(
    Date_Time varchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    Event_Type TEXT,
    Month_of_Year TEXT,
    Survey FLOAT(53),
    Actual FLOAT(53),
    Prior_Data FLOAT(53),
    Revised FLOAT(53),
    Relevance FLOAT(24),
    Ticker TEXT
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:07:30.553

使用浮点数而不是双精度数（或十进制数）

```
USE pricingdb
go

CREATE TABLE dbo.Events_060107_2012
(
Date_Time varchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
Event_Type TEXT,
Month_of_Year TEXT,
Survey FLOAT,
Actual FLOAT,
Prior_Data FLOAT,
Revised FLOAT,
Relevance FLOAT,
Ticker TEXT
); 
```

# java - 如何为委托模型设计构建端到端测试？

> ID：10903264
> 
> 赞同：1
> 
> 时间：2012-06-05T19:01:32.257
> 
> 标签：java, model-view-controller, testing, delegates

我刚刚遇到了 Delegate-Model 设计（相对于 MVC）并想尝试一下，最近也一直在学习 GOOS 风格的 TDD 开发。所以我希望我的步行骨架测试看起来像这样：（我正在使用 JUnit）

```
@Test
public void userGeneratesEvent_DNotifiesM_MNotifiesDOfUpdatedData_DGetsNewDataFromM() {
    Model model = new Model();
    Delegate delegate = new Delegate(model);
    model.addListener(delegate);
    // Not sure how to "generate the user event" here
    assert( ... );
} 
```

正如上面的评论，我的问题是我不确定如何从委托中正确生成用户事件。也许我对设计模式如何工作的理解不正确，但委托应该封装视图和控制器——我必须让视图从委托内部向控制器触发一个事件，但这种交互应该是“秘密的” “？

任何意见或建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:51:59.497

您的步行骨架测试应尽可能接近端到端。如果可以的话，您的测试应该从 GUI 一直到 Web 服务或数据库层。这验证了一切都可以正确连接，并且您可以自动部署并在生产中运行。

但是，使用实际 Web 服务和数据库进行的测试可能太慢或太脆弱而无法自动化。在这种情况下，您使用依赖注入在这些层之下进行测试。

对于测试 GUI，您可以使用 GUI 测试框架通过 GUI 本身进行测试（这是他们在 GOOS 中所做的）。如果您使用 Swing，我推荐[FEST](http://code.google.com/p/fest/)。另一种更可靠且允许快速验收测试的方法是在 GUI 层下方进行测试。但为此，您应该使用 MVP 或 MVVM 而不是 Delegate-Model

> 我仍然坚持如何正确地以编程方式引发用户事件。例如，用户通过 UI 在表中添加一行，我在最后断言模型中的行数等于 1。我是否必须打破 Delegate 的封装才能做到这一点？

您要么必须：打破封装，使用诸如 MVP/MVVM 之类的模式，让您可以在视图下进行测试，或者使用 FEST 通过 GUI 进行测试。我建议使用 FEST 通过自动单击组件来引发事件并验证 JTable 是否具有给定的行数。FEST 测试相当可靠，尽管速度很慢，所以你不应该用它来编写单元测试。

如果您的应用程序增长到合适的大小（> 3000 LOC），您可以考虑重构为 MVP/MVVM，因为您将从代码重用和更快/可靠的端到端测试中获得足够的好处，以证明复杂性是合理的。您的 FEST 测试和单元测试（在模型上）不应在此重构期间中断，并将帮助您安全地重构。当您的演示者/视图模型是一个单独的类时，您可以直接在它们上调用用户事件并验证（使用模拟）/断言添加了额外的表行。

# python - Django“额外”查询

> ID：10903265
> 
> 赞同：1
> 
> 时间：2012-06-05T19:01:36.523
> 
> 标签：python, sql, django

我的 models.py 中有以下模型结构，包含项目和优惠：

```
class Item(models.Model):

    STATUS_CHOICES = (
        ('A', 'Active'),
        ('C', 'Cancelled'),
    ) 

    status = models.CharField(max_length=11, choices=STATUS_CHOICES)
    target_amount = models.PositiveIntegerField()
    ...

class Offer(models.Model)

    STATUS_CHOICES = (
        ('A', 'Active'),
        ('C', 'Cancelled'),
    ) 

    status = models.CharField(max_length=11, choices=STATUS_CHOICES)
    amount = models.PositiveIntegerField()
    item = models.ForeignKey(Item)
    ... 
```

我想在我的views.py 中编写一个查询来为每个项目获取以下信息：

1.  此项目的当前（有效）报价总数
2.  此项目的报价已达到目标的百分比（即[来自 (1) 的总数]/target_amount * 100）

我一直在尝试通过“额外”来实现这一点，如下所示（使用 postgres）：

```
items = Item.objects.filter(status='A').extra(
    select={
        'total_amount' : 'select coalesce(sum(amount),0) from myapp_offer where myapp_offer.item_id = myapp_item.id and myapp_offer.status = \'A\'',
        'percentage_met' : '(((select coalesce(sum(amount),0) from myapp_offer where myapp_offer.item_id = myapp_item.id and myapp_offer.status = \'A\') / target_amount) * 100)'
    }
) 
```

现在第一个 select ( `total_amount`) 工作正常并返回我所期望的，但`percentage_met`始终为 0。谁能帮我解释为什么？

编辑：应该提到我希望能够 order_by the percent_met

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:37:04.023

你不需要`extra`这个。只需使用[聚合](https://docs.djangoproject.com/en/dev/topics/db/aggregation/)：

```
from django.db.models import Sum

items = Item.objects.filter(status='A').annotate(total_amount=Sum('offer__amount')) 
```

`percentage_met`无论如何，是每个对象，所以它可以只是你模型上的一个方法：

```
class Item(models.Model):
    ...
    @property
    def percentage_met(self):
        if hasattr(self, 'total_amount'):
            return (self.total_amount / float(self.target_amount)) * 100
        return None 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:38:18.637

我不认为上面的代码是获得你想要的值的最干净的方法，但是，假设它是——我怀疑你看到的问题实际上是 SQL 中的除法问题——一个 int /int 被设置为最近的 int，在这种情况下为零。Sum 肯定是一个 int；什么是 target_amount，它来自哪里？它是一个整数吗？

在 Postgres 中：

```
select 2/100; 
?column? 
----------
        0
(1 row) 
```

如果是这样，请转换以下值之一：

```
select 2::numeric/100;
?column?        
------------------------
 0.02000000000000000000
(1 row) 
```

# hardware - 数字逻辑 - 状态机？

> ID：10903277
> 
> 赞同：3
> 
> 时间：2012-06-05T19:02:34.600
> 
> 标签：hardware, state-machine, circuit, digital-logic

我了解 Mealy 状态机的工作方式 - 输出逻辑现在不仅是当前状态的函数，而且也是直接输入的函数。

但这比摩尔机器有什么优势呢？人们通常使用 Mealy FSM 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T19:56:48.123

Moore 机通常更容易理解，但 Moore 机的状态至少与相应的 Mealy 机一样多。（想想如何把 Mealy 变成 Moore：对于每个转换，都有额外的状态用于输入的选择）

因此，Mealy 通常更高效，因为您可以拥有更少的状态，从而更少的内存组件。另一方面，因为它绑定到输入，所以它不绑定到时钟。因此，在输出时序很重要的情况下，Moore 可为您提供更多控制。

# java - glassfish v3“无法找到请求目标的有效认证路径”

> ID：10903279
> 
> 赞同：0
> 
> 时间：2012-06-05T19:02:58.383
> 
> 标签：java, glassfish, ssl-certificate, keytool, solaris-10

我意识到这个问题可能看起来是重复的，但我浏览过的线程似乎都没有解决或帮助我的情况。

几天来，我一直在尝试创建自签名 SSL 证书。需要该证书才能访问必须通过 HTTPS 提供 WSDL 文件的 glassfish 域。我在 Solaris 10 上使用 Glassfish 3.1.1，它不使用默认的 SSL 端口 (443)。目前，它正在使用 8181。

SSL 证书对用于访问它们的主机名非常特别。证书需要跨多个网络区域有效；因此 glassfish 域具有多个与之关联的不同 IP。据我所知，主机名（我们称之为 foobar）在服务器本身之外是不可访问的。

经过大量研究后，我决定我需要生成一个自签名证书，其中包含指示这些 IP 的主题备用名称。以下是我采取的步骤。

1.  使用 SAN 生成证书的最简单方法是下载 Java 7，其中包括具有此功能的 keytool 实用程序。从 Oracle 网站下载 JDK 1.7.0_04 并安装在 foobar 中。

2.  导航到 glassfish domain1 配置目录，例如 /opt/glassfish3/glassfish/domains/domain1/config

（以下内容根据 Oracle Glassfish 3.1 文档修改： http: [//docs.oracle.com/cd/E18930_01/html/821-2435/ablqz.html](http://docs.oracle.com/cd/E18930_01/html/821-2435/ablqz.html)）

1.  在密钥库中生成证书。注意：每个 glassfish 域都有自己的密钥库；下面的证书是为 domain1 生成的，它与 HTTPS 端口 8181 相关联。

    `keytool -genkey -alias foobar -keyalg RSA -dname "CN=foobar, OU=xxxxxxx xxxx, O=xxxxxxxxxx, L=xxxxx xxx, S=xx, C=xx" -ext "SAN=IP:12.34.56.78,IP:99.88.77.66" -keypass changeit -storepass changeit -validity 3650 -keystore keystore.jks`

2.  将生成的证书导出到文件（在本例中为 foobar.cer）

    `keytool -export -alias foobar -storepass changeit -file foobar.cer -keystore keystore.jks`

3.  将证书作为可信证书导入 cacerts。执行此操作两次，一次用于 Glassfish cacerts 文件，一次用于 foobar 上的 Java JRE cacerts 文件。

    `keytool -import -v -trustcacerts -alias foobar -file foobar.cer -keypass changeit -storepass changeit -keystore cacerts.jks`

    在 /usr/java/jre/lib/security 中： `keytool -import -v -trustcacerts -alias foobar -file foobar.cer -keypass changeit -storepass changeit -keystore cacerts`

4.  以防万一，我还下载了证书并将其导入到将访问 HTTPS 的 Windows 工作站上的 Java JRE cacerts 文件中（可能没有必要）。

    在 C:\Program Files\Java\jre\lib\security 中： `keytool -import -v -trustcacerts -alias foobar -file foobar.cer -keypass changeit -storepass changeit -keystore cacerts`

5.  重新启动 glassfish domain1。

    `asadmin restart-domain domain1`

6.  重启完成后，测试连接。在我的情况下，我去我的 Windows 工作站，在那里我在 Netbeans 中加载了 Java 应用程序。我通过 HTTPS 在需要 WSDL 的地方运行测试，并`https://12.34.56.78:8181`作为源输入。

这给了我以下错误：

```
2012-06-05 10:25:32,132  WARN utilities.ConnectionManager - Could not connect to url https://12.34.56.78:8181/foobar/WebService?wsdl: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target 
```

如果我改为使用域 1 的默认 Glassfish SSL 证书，则会收到一个错误，指示不存在主题备用名称。这就是为什么我首先遇到了重新生成证书的麻烦。

据我所知，将证书导入为受信任的 CA 证书应该可以解决此“无法找到有效的证书路径”错误。我承认我不是网络专家，但到目前为止我的所有研究都表明情况确实如此。我不确定这里的问题是否是因为我使用的是非标准 SSL 端口（必须添加 :8181 可能会导致与 SAN IP 不匹配）。我还没有尝试过。但是有没有办法在 CN 或 SAN 中为 IP:Port 组合生成自签名证书？

谢谢...帮助将不胜感激！

PS 如果需要，我可以提供应用程序代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:44:22.243

自从我遇到这个问题以来已经有一段时间了。

我无法如上所述解决它，所以我最终从公共 CA 订购了 SSL 证书。

关于 Glassfish (3.1.1) 和 SSL，我确实遇到了一个值得注意的怪癖。无论出于何种原因，每个域至少需要存在一个未启用 SSL 的网络侦听器，否则在访问启用 SSL 的 Web 服务 URL 时会出现证书错误。

所以说我在 8080 和 8181 上有一个监听器。如果两者都启用了 SSL，那么证书将不起作用。如果从 8080 中删除 SSL，则附加到侦听器 8181 的证书将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:06:32.130

我认为问题在于 cacerts 的证书必须有一个非常具体的别名（在 3.1.1.2 中它是 glassfish-instance）

# asp.net-mvc-3 - 未找到 MVC3 配置文件设置属性

> ID：10903286
> 
> 赞同：0
> 
> 时间：2012-06-05T19:03:08.153
> 
> 标签：asp.net-mvc-3, asp.net-profiles

在此处输入代码我已经阅读了一些其他类似我的帖子，但仍然没有可用的答案。

我有一个编辑器用于我的个人资料信息，它可以为所选用户获取数据，但是一旦我尝试保存它，我就会收到以下错误。

未找到设置属性“FirstName”。

事情是为了 POST，我什至还没有做任何事情。我认为它试图加载或获取配置文件对象以在发布后填充模型。从我可以看到的调用堆栈中没有任何内容可以找到发生这种情况的位置。

网络配置：

```
 <profile inherits="MyWeb.BusinessLayer.Models.Account.Profile" enabled="true" defaultProvider="AspNetSqlProfileProvider">
  <providers>
    <clear/>
    <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="My Website"/>
  </providers>
</profile> 
```

配置文件类

```
public class Profile : ProfileBase
{
    [Display(Name = "First Name")]
    [Required(ErrorMessageResourceName = "err_req_field", ErrorMessageResourceType = typeof(Resources))]
    [StringLength(50, MinimumLength = 3, ErrorMessageResourceName = "err_len_field", ErrorMessageResourceType = typeof(Resources))]
    public virtual string FirstName
    {
        get
        {
            return (this.GetPropertyValue("FirstName").ToString());
        }
        set
        {
            this.SetPropertyValue("FirstName", value);
        }
    } ... abreviated 
```

控制器动作

```
 public ViewResult EditProfile(Guid id)
    {
        var user = _userService.Get(id);

        Profile _profile = Profile.GetProfile(user.UserName);

        return View(_profile);
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public RedirectToRouteResult EditProfile(Profile profile)
    {
        return RedirectToAction("Index" , "UserAdministration" );
    } 
```

显示编辑器工作正常，我得到了数据，就在我尝试发布时，我得到了这个。还有其他想法吗？我唯一的其他想法可能是做一个 Ajax Post，将参数拆分而不是 Profile 模型，然后读取并设置。/.. 想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T13:16:54.637

在您使用 Profile 类发布表单后，模型绑定器会尝试绑定模型，因此它需要所有属性（“FirstName”等）。

问题是表单中的模型不完整（而且不可能），因此配置文件的行为是未经授权且不为人知的。

当您在 FirstName 属性的 getter 之前设置断点时，您可以看到它。断点命中后，查看 Locals 窗口并找到“this”。展开它的“base”属性，您将看到 IsAnonymous 属性设置为 true。

来自 POST 表单后，活页夹无法识别配置文件。解决方案是这样编码：

```
[AcceptVerbs(HttpVerbs.Post)]
public RedirectToRouteResult EditProfile(ProfileModel profileModel)
{
    // get the current user profile
    Profile profile = Profile.GetUserProfile();
    profile.FirstName = profileModel.FirstName;

    // save the profile
    profile.save();

    return RedirectToAction("Index" , "UserAdministration" );
} 
```

因此，您根据当前登录的用户创建用户配置文件，然后更新一些属性。

# c# - 处理日期时间的空值

> ID：10903290
> 
> 赞同：0
> 
> 时间：2012-06-05T19:03:22.407
> 
> 标签：c#, asp.net, linq

我有一个 Linq 查询，它由我从数据库中提取的这个日期时间字段组成

```
 TerminationDate = base.ConvertFromUtcToCentral(r.TerminationDate.ToString()) 
```

使用的功能是这样设计的

```
 public DateTime ConvertFromUtcToCentral(string UtcTime)
    {

        if (UtcTime != "")
        {
            DateTime?  retValue = TimeZoneInfo.ConvertTimeFromUtc(Convert.ToDateTime
                                                       (UtcTime), USTimeZones.Central);

            return Convert.ToDateTime(retValue);
        }
        else
            return Convert.ToDateTime(null);

    } 
```

但是，每当我返回 null 时，它都会在网格中显示我将此查询分配给的最小日期。但是，当它为 null 时，它应该只显示 null 而不是 min date。你能告诉我如何处理这个问题吗？如果使用三元运算符是一个更好的主意，请告诉我。

限制：无法更改函数重运行类型，因为它在多个地方使用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:06:54.280

由于您要返回值类型 DateTime，因此不能返回 null。您可以更改函数以返回可为空的 DateTime (DateTime?)、引发异常或返回 DateTime 的默认值 default(DateTime)。恕我直言，我会抛出 System.ArgumentException，因为要转换的空字符串显然不会产生输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:07:39.790

也许你可以尝试返回`null`。让你的函数返回`DateTime?`，所以`return Convert.ToDateTime(null);`你可以做`return null`

对不起英语不好！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:38:12.823

由于您不能更改函数的限制，那么您可以在以下位置抛出一个 terinery 运算符：

```
TerminationDate = ( base.ConvertFromUtcToCentral(r.TerminationDate.ToString()) == default(DateTime) ? (DateTime?) null : (DateTime ?) base.ConvertFromUtcToCentral(r.TerminationDate.ToString()) ); 
```

我不喜欢这样，因为它两次调用该函数。我可能会写一个包装器方法来做这样的事情

```
public static DateTime? WrapperConvertFromUtcToCentral(string UtcTime)
{
    DateTime value = ConvertFromUtcToCentral(string UtcTime);

    if (value == default(DateTime))
         return (DateTime?)null;
    else
         return (DateTime?)value;
}

TerminationDate = WrapperConvertFromUtcToCentral(r.TerminationDate.ToString()) 
```

这样，您只调用一次原始函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T20:05:06.700

最近的编辑和评论表明`TerminationDate`可能是`DateTime?`. 也许添加一个新的重载来显式处理`DateTime`和`DateTime`值并正确返回`DateTime`或`DateTime?`代替？我看到您无法轻松更改此方法的返回类型，因此添加这些新的重载并在您的应用程序中逐渐使用它们可能是使用更好的数据类型的好方法。

```
public DateTime ConvertFromUtcToCentral(string UtcTime)
{
    return !string.IsNullOrEmpty(UtcTime)
        ? this.ConvertFromUtcToCentral(Convert.ToDateTime(UtcTime))
        : default(DateTime);
}

public DateTime? ConvertFromUtcToCentral(DateTime? UtcTime)
{
    return UtcTime.HasValue
        ? this.ConvertFromUtcToCentral(UtcTime.Value)
        : (DateTime?)null;
}

public DateTime ConvertFromUtcToCentral(DateTime UtcTime)
{
    return TimeZoneInfo.ConvertTimeFromUtc(UtcTime, USTimeZones.Central);
} 
```

如果您不更改返回类型，您将始终需要`DateTime`从方法中获取非空值，除非 - 正如 user957902 建议的那样 - 您开始抛出`Exception`s。:) 如果您不能使用它，您也可以修改消费应用程序以处理`DateTime.MinValue`类似`null`并且不显示任何内容。

是否使用三元运算符可能是个人喜好问题——在像这样的简单情况下，我确实喜欢使用它（我的示例中的换行符纯粹是为了在 SO 上更容易阅读），因为它很容易阅读并且只有两条路径可以走峡谷路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T07:23:51.077

无法为 DateTime 分配空值，因为它不是可空类型尝试分配 DBNull.Value 而不是 null，同时将其发布回数据库

# android - 设置状态栏通知的具体日期

> ID：10903291
> 
> 赞同：2
> 
> 时间：2012-06-05T19:03:27.273
> 
> 标签：android, date, notifications, statusbar

我只是希望用户使用 EditText 字段（或者可能是 Datepicker）选择一个日期，然后应用程序将其存储在 SQLite 数据库中。（我只存储一个月中的哪一天，所以每个月的特定日期——1 日、10 日、22 日等——它都会弹出。）通知系统会出现并检查该日期并显示“提醒”状态栏中的通知将它们直接带到应用程序以在按下时更新某些信息。

根据[此处](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)的简单教程（在“基础知识”部分中），“何时”变量决定“何时”弹出通知？如果是这样，我可以使用从数据库动态生成的日期变量来填充它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:11:10.663

> 通知系统出现并检查该日期并在状态栏中显示“提醒”通知，将它们直接带到应用程序以在按下时更新某些信息。

如果“通知系统”是指“我编写的应用程序”，那么这是可能的。用于`AlarmManager`在您指定的时间安排警报，将控制路由到`BroadcastReceiver`可以创建和显示您的`Notification`.

> 根据此处的简单教程（在“基础知识”部分），“何时”变量决定“何时”弹出通知？

不。它是与`Notification`用于显示目的相关联的时间戳（例如，可能出现在通知抽屉中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:05:54.670

是的 Date 有一个方法可以将它的值作为一个长值返回给你

```
long when = mDate.getTime(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:09:49.990

不，我认为“何时”应该表明事件发生的时间。请参阅[此文档](http://developer.android.com/reference/android/app/Notification.Builder.html)，搜索`setWhen(long when)`.

如果您不希望立即显示通知，则需要在长期运行的服务中设置自己的计时器或其他东西。如果您可以保持服务运行，请查看[Handler](http://developer.android.com/reference/android/os/Handler.html)类，尤其是`postAtTime()`方法。

# php - PHP MYSQL 搜索最佳结果

> ID：10903292
> 
> 赞同：1
> 
> 时间：2012-06-05T19:03:35.730
> 
> 标签：php, mysql, database, full-text-search

我需要使用 PHP 和 MYSQL 代码搜索我的数据库，我现在所做的是

```
$mysearch = $_GET['search'];//the search query , for ex - best potato
$recepiesuisine_quer = mysql_query("SELECT * FROM addrecepie WHERE  MATCH (name,method,contributedby,ingredients,healthytip,cuisine) AGAINST ('".$mysearch."' IN BOOLEAN MODE) ");
// Here the MATCH contain all the columns of my table
             while($row = mysql_fetch_assoc($recepiesuisine_quer)) {
             echo" 
                <a href='recepie_detail.php?id=".$row['id']."&cuisine=".$row['cuisine']."' id='foodie1_title' class='span-7'>
                <div class='span-1'><img src='".$row['image']."' width='80'></div>
                <div class='span-5'>
                    ".$row['name']." ,<br /> ".$row['contributedby'].",<br /> ".$row['cuisine']." <br />
                </div>
                </a>
             ";
             } 
```

我的搜索对单个字符运行良好，但好像我想搜索 2 个字符，例如：- 最佳土豆它会给我的结果

1.  表行中的所有**Potato**。

2.  表行中的所有**最佳位置。**

3.  表行中的所有**最佳土豆。**

我希望我的第 3 个条件首先显示，然后在它可能显示第一个和第二个结果之后。我需要先显示最相关的项目。通过上述查询，我​​无法这样做。请帮助我应该使用什么查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T05:17:35.187

始终绑定您的变量，否则如果它们是搜索参数值中的单引号，mysql 查询将失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:09:47.200

您可以使用此查询 -

```
SELECT * 
FROM addrecepie 
WHERE  MATCH (name,method,contributedby,ingredients,healthytip,cuisine) 
       AGAINST ('".$mysearch."' IN BOOLEAN MODE) 
OR MATCH (name,method,contributedby,ingredients,healthytip,cuisine) 
       AGAINST (SUBSTRING_INDEX('".$mysearch."', ' ', 1) IN BOOLEAN MODE)
OR MATCH (name,method,contributedby,ingredients,healthytip,cuisine) 
       AGAINST (SUBSTRING_INDEX('".$mysearch."', ' ', -1) IN BOOLEAN MODE) 
```

该`SUBSTRING_INDEX()`函数将用空格分隔单词。这是 2 个单词和 1 个空格。您可能还必须使用该`TRIM()`功能。

# html - CSS3：防止块跨越列

> ID：10903294
> 
> 赞同：2
> 
> 时间：2012-06-05T19:03:42.000
> 
> 标签：html, css

[示例 jsFiddle](http://jsfiddle.net/slolife/cHcfQ/4/)，但请确保您使用支持以下其中一种查看的新浏览器：

```
-moz-column-count: 3;
-webkit-columns: 3;
-o-columns: 3;
columns: 3; 
```

使用新的 CSS3 列属性，我想看看是否有办法防止文本块跨列。我所拥有的是一个 div 内的三列布局，其中使用 columns:3 和 dt/dd 标签和文本。所以浏览器会自动为我创建列。但我不希望 dt 和相关的 dd 标签跨越两列。有没有办法将 dt 和 dd 标签包装在一起，以便浏览器向下增长列，而不是拆分内容？

与段落标签相同：我可以告诉浏览器不要跨越一个段落，而是让列更高吗？

# java - 多个 jar 版本和从特定 jar 读取类

> ID：10903302
> 
> 赞同：0
> 
> 时间：2012-06-05T19:04:21.220
> 
> 标签：java, jar

有一个当前应用程序可以读取非常旧的 Apache common io 版本 1.2 版本。很长一段时间后，我们使用最新的 2.3 发布了一些新更新，我们希望仅使用最新的 commons IO jar 文件运行新代码。我如何处理这个问题，以便新代码只能从最新的通用 IO jar 和旧版本中读取。（简而言之，不要触摸任何正在运行的东西）

在线搜索我意识到我需要加载类，但有点困惑我应该做 UrlClassLoader 还是 ClassLoader，如果类加载是正确的路径，那么我如何读取所有类，因为里面的类相互依赖，所以如果我调用主类来运行它执行的代码，而不用担心依赖或调用每个类

请建议？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:08:30.707

类加载器绝对是解决方案的一部分，但自己实现它非常棘手。尝试使用 OSGi，如果您正确配置它，它将为您执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T08:00:54.240

您可以使用 OSGi 框架并同时运行两个 Apache 通用 io 库。然后，您可以通过导出和分别导入具有特定版本的包来控制哪个包使用哪个 apache 库包。

您将在 lib 包中拥有： Export-Package: com.acme.foo;version="1.24"

并在使用它的捆绑包中：

导入包：com.acme.foo;version="[1.23, 2.0)"

由于在 OSGi 中每个包都有自己独立的类加载器，所有正确子包和类的加载将自动处理，不会有冲突。

例如，您可以查看[这些关于编写 OSGi 包的说明和演示](http://dz.prosyst.com/pdoc/mBS_SDK/um/runtime/osgi/docs/index.html)- 使用[mBedded Server](http://www.prosyst.com/index.php/de/html/content/97/Products-OSGi-Implementation/)运行它们。

# html - 表格中的随机间距，里面有 div

> ID：10903306
> 
> 赞同：-1
> 
> 时间：2012-06-05T19:04:38.633
> 
> 标签：html, css, html-table, mybb

这是问题所在： [http ://www.welivetech.net/showthread.php?tid=46](http://www.welivetech.net/showthread.php?tid=46)

如您所见，文本全部位于右侧的随机位置。它与用户名的长度无关，因为“动态”发布了所有帖子。

有谁知道这个问题的任何解决方案？从昨天开始就一直让我发疯。。

PHP 没有把它搞砸，它在 HTML 中的某个地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:08:50.473

您需要指定第一个`<td>`（带有用户图片的那个）的宽度。否则，两个单元格的大小都会动态调整，具体取决于每个单元格内容的宽度比例。加上`width: 160px`它，中提琴就像小提琴一样，但更大。

# jquery - 使用 jQuery 获取选定元素的层次结构位置/编号？

> ID：10903308
> 
> 赞同：1
> 
> 时间：2012-06-05T19:05:16.060
> 
> 标签：jquery, dom, hierarchy

请多多包涵。我正在尽力解释我需要什么，但我可能需要对我的 OP 进行一些更新。

我想获取所选元素在层次结构中的位置。例如，如果我在整个 html 文档中总共有 4 个超链接，并且我将鼠标悬停在第三个链接上，我想要“html > body > a:eq(2)” - 2 表示第三个超链接元素。

不，`index()`不成功。

我已经通过一些调整尝试[了这段代码](http://jquery4u.com/dom-modification/jquery-hierarchy-path-element/#.T85Jj7BSQXg)并得到了这个：“html > body > a”，但找不到返回位置的函数。

如何在相似元素的层次结构中获取所选元素的位置？（我什至不知道这是否是正确的术语。）如果 x==y 有点事情，我是否需要遍历 DOM 并执行手动匹配

```
<a href=#">link1</a> 
<a href=#">link2</a> 
<a href=#">link3</a> 
<a href=#">link4</a> 
```

我将把这段代码用于各种 HTML 元素，而不仅仅是超链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:13:51.787

如果您有一个给定的元素并且想知道它在文档中的第 n 个链接，您可以这样做：

```
function whichLink(el) {
    return $("a").index(el);
} 
```

这种形式`.index(el)`返回 jQuery 对象中的哪个项目与传入的元素匹配。它搜索 jQuery 对象以找到匹配的元素。由于 jQuery 对象按文档顺序对元素进行排序，这将为您提供给定链接在文档中的位置。

如果您尝试做一些不同的事情，请进一步澄清您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:25:13.567

Since you want an action on hover I would suggest a slightly different approach. Instead of finding all the elements to get the index on every hover (which could happen quite often) event I would set the index when the document first loads so you can easily retrieve it when the event fires.

Something like:

```
$('a').each(function(i, el){            
    $(this).data('index', i); 
    $(this).hover(function(){
        var hoveredIndex = $(this).data('index');
        // Do you action with the index
    });
}); 
```

If you don't have much mark up or hovering doesn't happen often this might be overkill. Also if you have a container around the elements the selector/events could be revised.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:09:58.803

通常，您可以在每个循环中执行此操作：

```
$('a').each(function(i) {
  // i has the index so we can do something with it
  var index = i;
  $(this).click(function() {
     $(this).attr('href', index);  // make the href = i for instance
  });
}); 
```

# jquery - jQuery UI 悬停重复

> ID：10903309
> 
> 赞同：3
> 
> 时间：2012-06-05T19:05:25.403
> 
> 标签：jquery, jquery-ui

我有这个 HTML：

```
<div>

    <div id="wrap">
        <div id="pop">Hello</div>
        Here is some content
        <br />
        It is several lines long.
        <br />
        This is the end of it.
    </div>

</div> 
```

和这个JavaScript：

```
$(function() {
    $('#wrap').hover(function() {
        $('#pop', $(this)).show('blind');

    }, function() {
        $('#pop', $(this)).hide('blind');
    });
}); 
```

[JsFiddle 链接](http://jsfiddle.net/Md5t5/)

使用 jQuery UI。

如果您将鼠标移到#wrap div 上，#pop 会向下滑动并在鼠标移出时再次滑开。但是，如果您在动画完成之前将鼠标从上方移动到#wrap 或从#wrap 移动到#pop，它会永远循环（如果您等到动画完成，您可以在#wrap 和#pop 之间自由移动并且没有任何动画，这是我想要的）。

在每次调用/之前，我尝试了`mouseover`、`mouseenter`/ `mouseleave`、过滤`.not(':animated')`、调用的组合，所有这些都给出了相同的结果，这让我相信我错过了一些基本的东西。`.stop()``show``hide`

有人可以指出我在这里失踪的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:27:38.060

悬停回调不能很好地与`show('blind')`and一起使用`hide('blind')`，但它们应该可以与`slideUp()/slideDown()`.

```
$(function() {
    $('#wrap').hover(function() {
        console.log('over');
        $('#pop').slideDown();

    }, function() {
        console.log('out');
        $('#pop').slideUp();
    });
});​ 
```

* * *

另外，我没有看到无限循环，但动画确实会排队。如果您将鼠标指针快速移入和移出#wrap，您将生成一长串动画。

### 编辑：

我能够在FF中获得无限循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:43:19.597

只需发布我的版本并修复`show('blind')`.

```
$(function() {
    var isAnimating = false;
    $('#wrap').hover(function() {
        if (!isAnimating) {
            isAnimating = true;
            $('#pop').show('blind', function () {
                setTimeout(function () { isAnimating = false; }, 100);
            });
        }
    }, function() {
        $('#pop').hide('blind');
    });
}); 
```

[**演示**](http://jsfiddle.net/Md5t5/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:07:11.660

尝试这个：

```
$(function() {

    $('#wrap').hover(function() {
        $('#pop', this).stop().show('blind');

    }, function() {
        $('#pop', this).stop().hide('blind');
    });
}); 
```

[http://jsfiddle.net/lucuma/Md5t5/1/](http://jsfiddle.net/lucuma/Md5t5/1/) ​</p>

# grails - Grails - 带有附加参数的 remoteField（3 个参数，没有 id 解决方法）

> ID：10903312
> 
> 赞同：0
> 
> 时间：2012-06-05T19:05:32.290
> 
> 标签：grails

在我过去使用的解决方法中，我使用了 id 字段来传递我需要的附加参数。但是我需要通过 remoteField 传递三个参数，现在我需要找到一种方法来传递这些参数：

```
<g:remoteField action="updateFields" update="theDiv" id-"${personInstance.id}" paramName="search" name="updateFields" value="" /> 
```

需要：搜索字段（search），人员id（id），现在我需要人员工作的公司（c_id）。

我可以做这样的事情：

```
<g:remoteField action="updateFields" update="theDiv" id-"${personInstance.id}" paramName="search" name="updateFields" value="" params="${[c_id:c_id, search:/'+this.value+/']}"/> 
```

如果我尝试使用参数获取搜索值，则搜索字段现在是“+this.value+”。我可以通过引用 this.value 将对象搜索字段作为地图中的附加参数（如上）传递吗？如果是这样，我做错了什么，因为我的 gsp 没有加载。

**编辑**

我目前的工作是将两个 ID 绑定在一个 ID 字段中，由分隔符分割，然后在到达控制器后分解为一个数组（显然不理想！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T12:55:39.643

虽然我不使用remoteField，但我确实经常使用remoteFunction，并且发现我可以直接通过'params' 参数使用多个基于javascript 的变量。例如

```
<script>
  function someJSFunction(id1,id2,id3) {
     <g:remoteFunction action="ajax_function" params="{id1:id1,id2:id2,id3:id3}" update="someDiv"/>
  }
</script> 
```

希望有帮助。

# android - 在 lib ant build.xml 中添加 .so 文件 armeabi

> ID：10903314
> 
> 赞同：2
> 
> 时间：2012-06-05T19:05:45.313
> 
> 标签：android, ant, android-build

我放置了一个 .so 文件 libs/armeabi/my_so.so

**如何将此文件包含在 ant build.xml 文件中？**我可以对我的 libs 目录中的 jar 文件执行此操作。任何代码片段将不胜感激。

谢谢。

# javascript - JSON对象在浏览器中为null但不是firebug

> ID：10903315
> 
> 赞同：2
> 
> 时间：2012-06-05T19:05:53.623
> 
> 标签：javascript, jquery, ajax, json

当我在 firebug 中逐步执行此 javascript 代码 (scoreboard.js) 时，它可以很好地处理警报。当我没有在 firebug 中放置换行符并正常运行它时，我收到一条“favs is null”消息（没有警报）。

```
var favs = $.getJSON("favs.json");
favs = $.parseJSON(favs.responseText);
favs = favs.myTeams;

for (i=0; i<favs.length; i++){
    alert(favs[i].text);
} 
```

JSON (favs.json)

```
{"myTeams":[{"sport":10,"id":10,"abbrev":"NYY","isFav":false,"text":"New York  Yankees","sw_abbrev":"nyy"},{"sport":28,"id":19,"abbrev":"nyg","isFav":false,"text":"New York Giants","sw_abbrev":"nyg"},{"sport":46,"id":18,"abbrev":"NY","isFav":false,"text":"New York Knicks","sw_abbrev":"nyk"},{"sport":90,"id":11,"abbrev":"NJ","isFav":false,"text":"New Jersey Devils","sw_abbrev":"njd"},{"sport":41,"id":2507,"abbrev":"PROV","isFav":false,"text":"Providence Friars"},{"sport":46,"id":17,"abbrev":"NJ","isFav":false,"text":"New Jersey Nets","sw_abbrev":"njn"},{"sport":600,"id":363,"abbrev":"Blues","isFav":false,"text":"Chelsea","sw_abbrev":"ENG.CHELSEA","isNational":false}]} 
```

的HTML

```
<html>
<head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="scoreboard.js"></script>        
</head>

<body>
    Test
</body> 
```

知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:07:45.670

你不需要

```
favs = $.parseJSON(favs.responseText); 
```

而且我很确定`$.getJSON()`不会返回 json，而是返回[jqXHR](http://api.jquery.com/jQuery.get/#jqxhr-object)。

查看[parseJSON()](http://api.jquery.com/jQuery.getJSON/)的文档，您可能应该这样做：

> jQuery.getJSON( url [, data] [, success(data, textStatus, jqXHR)] )

```
$.getJSON("favs.json",
          function(json)
{
  var favs = json.myTeams;  

  for (i=0; i<favs.length; i++){  
    alert(favs[i].text);  
  }  
}); 
```

`$.getJSON()`- 成功回调（在我的示例中是匿名函数）传递返回的数据，该数据通常是由 JSON 结构定义并使用 $.parseJSON() 方法解析的 JavaScript 对象或数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:15:40.920

$.getJSON 期望成功回调。这应该有效：

```
$.getJSON('favs.json', function (data) {
    favs = data.myTeams;

    for (i=0; i<favs.length; i++){
        alert(favs[i].text);
    }
}); 
```

您在单步执行代码时看到它工作正常的原因可能是因为您给了异步调用时间来完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:12:08.643

`$.getJSON`是异步的。这意味着它在后台运行，因此在`$.getJSON`检索 JSON 之前调用后面的行。

您应该将所有处理 JSON 的代码放在回调中。

`$.parseJSON`（不需要 PS 。`$.getJSON`为你做）。

```
$.getJSON("favs.json", function(favs){
    favs = favs.myTeams;

    for (i=0; i<favs.length; i++){
        alert(favs[i].text);
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T19:12:21.847

问题出在第一行：

```
var favs = $.getJSON("favs.json"); 
```

getJSON() 方法是异步的。即从服务器返回响应需要时间，并且在运行其余代码之前，javascript 不会坐下来等待。

您需要使用回调函数，该函数在响应返回后执行：

```
var favs = null;
$.getJSON("favs.json", function(data) {
    // data is what the server returned
    // now you can do stuff with it
    favs = data.myTeams;

    // the rest of your code goes here
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:10:04.203

对我来说，这似乎是一种竞争条件。getJson 函数采用 onSuccess 参数，该参数将在加载数据时调用。如果您将其他行移到该功能中，您应该会很好。

下面的文档链接中有一些很好的例子。我在此处发布的代码是基于您提供的此信息的更多示例显示。

[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

类似于以下内容：

```
var favs = $.getJSON("favs.json", function(data) {
    favs = $.parseJSON(data.responseText);
    favs = favs.myTeams;

    for (i=0; i<favs.length; i++){
        alert(favs[i].text);
    }
} ); 
```

# java - 将 JTextField 添加到 JToolBar

> ID：10903323
> 
> 赞同：0
> 
> 时间：2012-06-05T19:06:14.047
> 
> 标签：java, swing, user-interface, jtextfield, jtoolbar

我正在尝试添加`JTextField`它`JToolBar`并且它可以工作，但是它太长了。我需要它只取 3 个字母。

这是它现在的屏幕截图...... ![截屏](../Images/1ca7148fbfee26894293a92e133cb52e.png)

我尝试了以下方法，

```
JTextField field = new JextField(3); // thought this limits to three characters. 
```

我试过了，

```
field.setColumns(3); // this didn't work either. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:39:53.607

工具栏的默认布局遵循为文本字段设置的最大大小。

![工具栏中的文本字段](../Images/6ef49dae83881b5402324c2e2369195b.png)

```
import java.awt.*;
import javax.swing.*;

public class TextFieldInToolBar {

    TextFieldInToolBar() {
        JPanel p = new JPanel(new BorderLayout());

        JToolBar tb = new JToolBar();
        p.add(tb, BorderLayout.PAGE_START);

        Icon disk = (Icon)UIManager.get("FileView.floppyDriveIcon"); 
        Icon pc = (Icon)UIManager.get("FileView.computerIcon"); 
        tb.add(new JButton(disk));
        JTextField tf = new JTextField(3);
        tf.setMaximumSize(tf.getPreferredSize());
        tb.add(tf);
        tb.addSeparator();
        tb.add(new JButton(pc));

        p.setPreferredSize(new Dimension(250,50));

        JOptionPane.showMessageDialog(null, p);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new TextFieldInToolBar();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:11:57.320

*   [JToolBar](http://docs.oracle.com/javase/tutorial/uiswing/components/toolbar.html)是[JFrame、JDialog 或 JWindow](http://docs.oracle.com/javase/tutorial/uiswing/components/toplevel.html)的容器，您可以使用适当的[LayoutManager放置此容器](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)

*   [通过使用JMenuBar 作为 JComponents 的容器，](https://stackoverflow.com/a/8127463/714968)这个问题应该是相同的（替代）

# c# - 连接字符串隐藏在某处？

> ID：10903325
> 
> 赞同：1
> 
> 时间：2012-06-05T19:06:18.977
> 
> 标签：c#, .net, entity-framework

我在一台机器上有两个数据库，它还有两个在 IIS 上运行的不同站点。我们称它们为 Site1 & Site2 和 DB1 & DB2。第二个站点和 BD 是第一个站点的副本。Site2 连接到 DB2，一切似乎都运行良好，但是当我们**将 DB1 脱机时**时，它停止工作，这很奇怪，因为使用 site2 创建的所有数据都在 DB2 中。事实上，除了一种方法外，大多数网站都可以工作

我们使用实体框架来访问数据库，当我们跟踪代码时，一切看起来都很好，但不知何故它不起作用。

在我们通过实体框架自动生成的代码中，我们跟踪了 connectiong 字符串，结果是正确的

```
Initial Catalog=DB2; 
```

但在下一行我们有这段代码

```
return ((IObjectContextAdapter) this).ObjectContext.ExecuteFunction<T_REFERENCE_DATA>(
                "GetReferenceData", groupNameParameter); 
```

我们得到一个内部异常，它说：

```
Database 'DB1' cannot be opened because it is offline. 
```

除此之外，所有其他方法似乎都使用正确的数据库。我们无法弄清楚 DB1 是在哪里配置或硬编码的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T10:17:14.020

这个问题（像往常一样）愚蠢得要命。有些人在存储过程上定义了数据库。当我们更改数据库并复制存储过程时，他们一直使用旧数据库。现在已修复。

谢谢你的帮助

# c# - 二进制格式化程序到字符串

> ID：10903327
> 
> 赞同：6
> 
> 时间：2012-06-05T19:06:22.607
> 
> 标签：c#

```
 BinaryFormatter formatter = new BinaryFormatter();

    using (MemoryStream m = new MemoryStream())
    {
        formatter.Serialize(m, list);
        StreamReader sr = new StreamReader(m);
        HiddenField1.Value = sr.ReadToEnd();
    } 
```

我得到 HiddenField1.Value 的空白值。不确定我在做什么是可能的？列表肯定已填充`(is a List<T>)`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T19:10:56.057

取决于您想要实现的目标......一种选择是将二进制流的内容显示为 Base64 字符串：

```
var memoryStream = new MemoryStream();
using(memoryStream)
{
    formatter.Serialize(memoryStream, list);
}
HiddenField1.Value = Convert.ToBase64String(memoryStream.ToArray()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T19:09:00.833

将其更改为：

```
BinaryFormatter formatter = new BinaryFormatter();

using (MemoryStream m = new MemoryStream())
{
    formatter.Serialize(m, list);
    m.Position = 0;
    StreamReader sr = new StreamReader(m);
    HiddenField1.Value = sr.ReadToEnd();
} 
```

在阅读之前，您需要将流的位置重置回开头。此外，您不应该使用 StreamReader 将这样的二进制流转换为文本，因为它会以意想不到的方式中断。如果您希望结果采用类似文本的格式，请使用`Convert.ToBase64String`@Alexei 的答案。

# javascript - 无法理解 Node.js 回调

> ID：10903330
> 
> 赞同：0
> 
> 时间：2012-06-05T19:06:30.037
> 
> 标签：javascript, node.js, callback, mocha.js

今天是我第一次涉足 nodejs，我特别难以理解以下逻辑的流动方式。逻辑如下：

```
request({ uri: db.createDbQuery('identifier:abcd1234') },
                    function(err, response, body) {
                        response.should.have.status(200);
                        var search = JSON.parse(body);
                        search.response.numFound.should.equal(1);
                        done();
                    });
        }); 
```

在更高的层次上，我确实理解的是，正在发出一个 http 请求，并且正在某个时刻调用该函数，该函数正在获取响应并对其执行某些操作。我想了解的是调用的正确顺序以及变量的绑定如何在上述给定的逻辑中发生。编译器如何知道如何将请求的返回值绑定到匿名函数？基本上，我想了解这个片段的幕后工作原理。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:13:13.677

您的问题不是特定于 node.js，这基本上是 javascript 的一个功能。

基本上你正在调用`request()`它定义为`function request(obj, callback)`

在内部，正在调用 http 请求，一旦完成，它就会调用`callback`它实际上是一个函数指针。

```
function request(obj, callback){
    //http request logic...
    var err = request_logic_internal_function();
    var response = ...
    var body = ...

    callback(err, response, body)
} 
```

您的代码实际上可以重组为：

```
var options = { uri: db.createDbQuery('identifier:abcd1234') };
var request_callback = function(err, response, body) {
                        response.should.have.status(200);
                        var search = JSON.parse(body);
                        search.response.numFound.should.equal(1);
                        done();
                    };
request(options, request_callback); 
```

您基本上所做的是将函数指针作为变量发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:16:49.797

我不知道您正在使用什么库，而且看起来您可能通过将方法分配到代码的全局范围（如`request`、`done`和`db`.

我*能*说的是：

1.  这种缩进很可怕，最初误导了我它在做什么，请`gg=G`（vim 语法）你的代码，以便它正确缩进。
2.  `request`接受两个参数，一个配置对象和一个回调。
3.  `db.createDbQuery` *必须*是阻塞方法，否则您创建的匿名对象将没有正确的值。
4.  `request`使用该配置值，发出某种非阻塞 I/O 请求，*稍后*将调用您提供的回调函数。这意味着该`request`调用之后的代码将在您提供的回调执行*之前执行。*
5.  一段时间后，请求数据会返回，Node.js 的事件循环会将数据提供给库的已注册事件处理程序（这可能是也可能不是您的直接回调——它可以对其执行某些操作，然后调用您的事件处理程序，你不知道也不在乎）。
6.  Then the function does some checks that will throw errors if they fail, and finally calls a `done` function in its scope (defined somewhere else) that will execute and continue the *logical* stream of execution.

# javascript - 基于组件的大型 Web 项目的 Backbone-RequireJs 样板

> ID：10903334
> 
> 赞同：3
> 
> 时间：2012-06-05T19:06:48.257
> 
> 标签：javascript, backbone.js, requirejs, boilerplate

我们有一个大型 Web 项目，我们需要可以相互通信的组件，这些组件可以放在不同项目的组件中央存储库中。使用 reuirejs 和 Backbone 进行模块化开发。浏览了可用于骨干网和 requirejs 的不同样板，但没有一个符合我的要求。所以我创建了以下目录结构。可以解释如下。

```
---resources
 |---custom-components
   |---mycomponent
     |---js
       |---views
       |---models
       |---collections
     |---css
     |---templates
     |---mycomponent.js
   |---mycomponent2
     |---js
       |---views
       |---models
       |---collections
     |---css
     |---templates
     |---mycomponent2.js
 |---libraries
   |---backbone
   |---underscore
   |---jquery
   |---jquery-ui
 |---jqueryplugins
   |---jcarouselite
 |---thirdpartyplugins
 |---page-js
   |---mypage.js
   |---mypage2.js 
```

1.  resources 目录将包含所有资源。在此之下，我们将有 4 个如上所述的目录。
2.  library、jqueryplugins 和thirdpartyplugins 显然是他们所说的名称的目录。
3.  page-js 目录将包含实际的 main-js，它将在我们的 html 文件中用作 requirejs data-main 属性。
4.  自定义组件是我们创建的所有小部件所在的位置，您可以看到它有一个与组件同名的 js 文件，这将是该小部件的入口点。该目录还包含 js、css 和模板的目录。CSS 和模板将分别由文本插件和[CSS](https://github.com/VIISON/RequireCSS)插件加载。Js 目录将包含使这个小部件工作的所有主干代码。

驻留在 page-js 中的 main-js 将询问自定义组件。

来到我需要的地方。
1\. 我希望专家从大型 Web 项目的角度来审查此目录结构，您需要与其他团队共享您的小部件。欢迎提出建议。
2.我的每个自定义组件都会定义一个模块，该模块将在包结构内和包结构外具有依赖关系。我想知道，是否有任何方法可以使用 r.js 仅优化我在包结构中的自定义小部件依赖项，并让插件和库分别优化。
3\. 我正在开发单页 ajax 应用程序，所以我会按需询问模块，所以我需要在不需要时清理模块和小部件，有什么方法可以清理我应该注意的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T19:01:31.677

***关于目录结构***

作为一种目录结构模式，我强烈推荐使用 cakePHP 的目录结构。它真的像文字一样强大！我正在运行多个应用程序（其中一个和 Groupon 一样大），它就像一个魅力。
您可能需要对其稍作调整，因为您知道，cake 是一个 PHP 框架，而您的是一个 javascript 框架。

这是蛋糕的真棒MVC目录结构：

![在此处输入图像描述](../Images/4fce5816fe4841d744be242a7ccbf73a.png)

请注意，您可以在一个蛋糕安装中托管数千个应用程序。所以如果你有兴趣，你还在等什么？[访问他们的网站](http://cakephp.org/)并阅读他们的文档。

* * *

***关于清理技巧***

好吧，这是我不喜欢的 Javascript 的缺点之一。没有像 Java 或 C++ 那样销毁 OO 模块的真正方法。在这里，我们没有 C++ 的`~`析构函数之类的东西。

多年来，程序员使用`module = null`从未使用的代码中释放内存。

看看这些：

*   [可以卸载动态加载的 JavaScript 吗？](https://stackoverflow.com/questions/1346897/can-dynamically-loaded-javascript-be-unloaded)
*   [动态加载/卸载Javascript](https://stackoverflow.com/questions/6693395/loading-unloading-javascript-dynamically)
*   [如何从 html 中卸载 javascript？](https://stackoverflow.com/questions/4365062/how-to-unload-a-javascript-from-an-html)

希望它对设计您的应用程序有所帮​​助并祝您好运；D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T08:51:09.600

可能我回答这个问题迟了，但无论如何让我在这里分享我的观点，以防其他人发现它有用。

1.  您的目录结构看起来不错。将业务组件自包含在特定目录中始终是一种更好的设计。我不会推荐打破 Open Close 原则的 Cake MVC 结构。还可以查看[http://boilerplatejs.org](http://boilerplatejs.org)推荐的目录结构，它是大规模 JavaScript 开发的参考架构。

2.  我不太清楚这个问题。当 r.js 运行时，它将优化它在目录中找到的所有 JS 文件（可能排除），然后通过依赖树创建单个脚本。在生产中，您只需要那个脚本（如果使用 i18n 插件，还需要加上语言环境文件）

3.  阅读下面我的博客文章。它可能会给你一些提示：[http ://blog.hasith.net/2012/11/how-much-multi-page-single-page.html](http://blog.hasith.net/2012/11/how-much-multi-page-single-page.html)

# uri - #! 是什么意思？在 URI 中是什么意思？

> ID：10903338
> 
> 赞同：0
> 
> 时间：2012-06-05T19:07:22.843
> 
> 标签：uri

我见过 ＃！在几个 URI 中，最著名的是 Twitter。我很好奇这意味着什么以及它来自哪里。任何人都可以告诉我或指出一个好的方向吗？谷歌不想玩。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:10:05.790

Google 用它来进行 ajax 抓取！

资源：

[https://developers.google.com/webmasters/ajax-crawling/docs/specification](https://developers.google.com/webmasters/ajax-crawling/docs/specification)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:10:43.160

它们被称为 hash-bang URI。

[https://developers.google.com/webmasters/ajax-crawling/docs/getting-started](https://developers.google.com/webmasters/ajax-crawling/docs/getting-started)

# c++ - 在同一个类的每个对象上调用方法

> ID：10903343
> 
> 赞同：1
> 
> 时间：2012-06-05T19:07:41.783
> 
> 标签：c++, oop, object, arduino

我正在做一个 arduino 项目。

对于那些不知道 arduino 是什么的人：

arduino 是一个小电子板，带有一个可以用 C++ 编程的微控制器

由于 arduino 是一个小微控制器，它是单核 16MHz 多处理非常困难。

我已经创建了一个类，在构造函数中，它定义了一个引脚作为 pwm 输出，设置了最小衰减、最大衰减、衰减时间等。

我有方法开始衰落和停止衰落改变设定点，速度......

对于多重渐变，我做了一个更新方法。

因此，当我调用 light1.update() 时，它会检查是否需要更改 pwm 输出。

**现在的问题是：**

我有更多的灯，所以这将是：

```
light1.update();
light2.update();
light3.update();
and so on 
```

有没有办法只写一行来在淡入淡出类的每个对象上调用 update() ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T19:10:03.170

看起来您正在寻找**观察者模式**与**实例管理器**模式的组合。

每当您创建 的新实例时`Light`，将其添加到管理器中。当您希望触发事件时，遍历管理器中的实例并调用`update`.

就像是：

```
class LightManager
{
    static std::vector<Light> lights;
    static void notify()
    {
       for ( size_t i = 0 ; i < lights.size() ; i++ )
           lights[i].update();
    }
    static void add(const light& l)
    {
       lights.push_back(l);
    }
};

class Light
{
    Light()
    {
       LightManager::add(*this);
    }
}; 
```

然后你更新所有的灯：

```
LightManager::notify(); 
```

# c++ - MPI_ERR_BUFFER：无效的缓冲区指针

> ID：10903344
> 
> 赞同：6
> 
> 时间：2012-06-05T19:07:45.543
> 
> 标签：c++, parallel-processing, mpi

此错误的最常见原因是什么

```
 MPI_ERR_BUFFER: invalid buffer pointer 
```

MPI_Bsend() 和 MPI_Rcev() 调用的结果是什么？当并行进程数很少（<14）时，该程序运行良好，但是当我增加进程数时，我得到了这个错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T12:37:31.763

扩展我之前的评论：

MPI 中的缓冲可以在各种情况下发生。消息可以由 MPI 库在内部缓冲，以隐藏网络延迟（通常只对达到与实现相关的大小的小消息进行），或者用户可以通过使用任何缓冲的发送操作`MPI_Bsend()`和`MPI_Ibsend()`. 用户缓冲与内部缓冲不同：

*   `MPI_Bsend()`首先，由或 by发送的消息`MPI_Ibsend()`总是被缓冲的，而内部缓冲的消息则不是这样。后者可以被缓冲或不被缓冲，这取决于它们的大小和内部缓冲空间的可用性；
*   其次，由于“始终缓冲”方面，如果用户附加缓冲区中没有可用的缓冲区空间，`MPI_ERR_BUFFER`则会发生错误。

发送的消息使用缓冲区空间，直到它们被目标进程确定接收。由于 MPI 不提供任何内置机制来确认消息的接收，因此必须设计另一种方法来完成它，例如通过将确认消息从目标进程发送回源进程。

出于这个原因，必须考虑所有未明确确认为正在传输的消息，并且必须在缓冲区中分配足够的内存。通常这意味着缓冲区应该至少与您愿意传输的数据总量加上等于 的消息信封开销一样大`number_of_sends * MPI_BSEND_OVERHEAD`。这会给大型 MPI 作业带来很大的内存压力。必须牢记这一点，并在进程数量发生变化时相应地调整缓冲区空间。

请注意，提供缓冲发送只是为了方便。它可以很容易地实现为内存复制和非阻塞发送操作的组合，例如缓冲发送使您免于编写如下代码：

```
int data[];
int *shadow_data;
MPI_Request req;

...
<populate data>
...
shadow_data = (int *)malloc(sizeof(data));
memcpy(shadow_data, data, sizeof(data));
MPI_Isend(shadow_data, count, MPI_INT, destination, tag, MPI_COMM_WORLD, &req);
...
<reuse data as it is not used by MPI>
...
MPI_Wait(&req);
free(shadow_data); 
```

如果内存不足，那么您应该只使用非阻塞发送。

# css - 无法从drupal的侧边栏中删除列表样式类型

> ID：10903346
> 
> 赞同：0
> 
> 时间：2012-06-05T19:07:52.003
> 
> 标签：css, drupal

嘿，我觉得我对 CSS 很熟悉，但我想不通。

侧边栏中有一个列表样式，我无法在我的网站上删除： [comptegrity](https://www.comptegrity.com/civicrm/event/info?reset=1&id=53)

特别是我试图从中删除的即将发生的事件部分

我尝试在 ul 和 li 中添加 !important。我试过添加： `body #doc_width #content_width ul (and li), ul, li{list-style:none !important}`

我也通过设置内容完成了所有这些：无。

我想不通这个！？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:27:02.210

它的图像....设置背景图像：无

# entity-framework - 实体框架存储库设计，多级循环中的多个 IUnitOfWork 实例

> ID：10903354
> 
> 赞同：1
> 
> 时间：2012-06-05T19:08:21.173
> 
> 标签：entity-framework, design-patterns, entity-framework-4, repository, unit-of-work

我正在使用具有工作单元设计模式的实体框架和存储库。

有时，在我的工作单元中，我会向不同的服务发出其他调用。

该服务反过来创建自己的工作单元实例，例如：

```
ISettingsService settingsService = UnityContainer.Resolve<ISettingService>();
using (IUnitOfWork unitOfWork = UnitOfWorkFactory.CreateUnitOfWork())
{
    List<Company> companies = unitOfWork.CompaniesRepository.GetAll();
    foreach(Company company in companies)
    {
        settingsService.SaveSettings(company, "value to set");
        company.Processed = DateTime.UtcNow();
    }
    unitOfWork.Save();
}

// ISettingsService.SaveSettings code in another module...
ISettingsService.SaveSettings(Company company, string value)
{
    using (IUnitOfWork unitOfWork = UnitOfWorkFactory.CreateUnitOfWork())
    {
        Setting setting = new Setting();
        setting.CompanyID = company.CompanyID;
        setting.SettingValue = value;
        unitOfWork.Insert(setting);
        unitOfWork.Save();
    }
} 
```

上面的代码确实有效，但我必须明确引用 ID 而不是附加公司对象（它会引发错误，因为它已经被其他服务中的其他工作单元跟踪）。

据我所知，我看到了 3 种发生这种情况的方式：

1）按原样使用代码，服务层创建自己的工作单元实例，对其他实体的任何其他引用都是在主键基础上完成的（设置值的过程应该由主键对象值传递，即 int客户ID）。

不利的一面是对数据库的潜在影响更大，如果实体主键类型发生更改，我将需要更改 ID 字段的所有服务层引用。__

2) 让服务层接受实体对象作为参考。这会很好，因为我可以传递对象。

不利的一面是实体不得从任何其他上下文中引用，并且必须附加到将要使用它的上下文中。在一个循环中，实体很可能已经被附加。__

3) 将工作单元实例化传递给其他服务层，以便他们可以使用现有的工作单元而不是实例化自己的工作单元。

除了必须传递工作单元引用之外，不确定这是否有不利之处，好处是能够引用对象而无需附加它们或担心它们是否已经附加。__

总之，我需要对一种访问设计进行标准化，并希望就我应该选择哪种访问设计提出建议。

此外，还有什么我需要关注的事务，或者是具有工作单元设计模式的 EntityFramework 隐式地实现了一种事务处理形式，因为更改仅在 context.Save() 上提交，还是我弄错了？

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:26:23.613

您有几个选择：

1.  让不同的服务传递分离的实体（它的实体），甚至可能是不是实体的 DTO，然后让每个服务将它们转换为它的实体（或使用主键）。

    每个服务都可以创建自己的内容并使用自己的 EDMX 或共享的 EMDX（甚至多个 EDMX）。

2.  如果服务使用相同的 EDMX，则将相同的上下文注入它们（您可以将其包装在后面并进行接口，以便它们不会暴露 EF）。

3.  如果服务不使用相同的 EDMX，则：

    3.1。选择选项 1，为不同的服务（或 DTO）使用不同的实体。

    您可以使用不同实体在 EDMX 之间“共享”表，或使用视图“来自外部域的表”以将只读版本的表反映到其他域。

    3.2\. 通过将 EDMX 合并为一个大的来创建主 EDMX（有关详细信息，请参阅[此问题](https://stackoverflow.com/questions/6115043/ef-cross-edmx-same-db-linq-to-entites-query)）

更改仅在调用 context.AcceptChanges() 时应用，因此您可以将更改保存到多个上下文，然后在所有保存完成后接受每个上下文中的更改。

# c++ - boost::asio 在 HTTP Server 3 示例中跨线程共享套接字

> ID：10903358
> 
> 赞同：1
> 
> 时间：2012-06-05T19:08:38.153
> 
> 标签：c++, concurrency, boost-asio

我参考了 boost::asio HTTP Server 3 示例的 Connection 类中的代码[http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/example/http/server3/connection.cpp](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/example/http/server3/connection.cpp)

可以看出，每个异步操作都是在 boost::asio::io_service::strand 上调用的。这确保不会同时调用完成处理程序。但是，示例服务器可以使用多个调用 io_service::run 的线程运行，这意味着这些线程中的任何一个都可以用于调用处理程序。此示例中的所有处理程序都调用 boost::asio::ip::tcp::socket 对象上的方法。对我来说，这是在线程之间共享套接字对象（尽管不是同时调用它的方法）。

我看不到围绕套接字调用的同步，所以我的问题是有什么机制可以确保每个线程对套接字对象的状态具有相同的视图？文档明确指出共享 boost::asio::ip::tcp::socket 的实例是不安全的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:25:06.963

The documentation states that tcp::socket is not *thread safe* as a shared object.

I use the widely accepted [SGI STL](http://www.sgi.com/tech/stl/thread_safety.html) definition of thread safety, which is:

> The SGI implementation of STL is thread-safe only in the sense that simultaneous accesses to distinct containers are safe, and simultaneous read accesses to shared containers are safe. If multiple threads access a single container, and at least one thread may potentially write, then the user is responsible for ensuring mutual exclusion between the threads during the container accesses.

The key word being *simultaneous*. So, using multiple threads to access a shared object is fine as long as that access is not concurrent. As an aside, this only matters if one or more of the threads is writing to the shared object.

The state of the socket object is in the process' memory space, which is shared between threads and therefore cannot be inconsistent.

Hope this answers your question!

# ios - InApp 购买说明

> ID：10903359
> 
> 赞同：0
> 
> 时间：2012-06-05T19:08:41.723
> 
> 标签：ios, in-app-purchase

我有一个应用程序，我想知道我是否必须使用 InApp 购买来为该应用程序添加附加组件？我希望我的用户能够下载不同的角色，有些是免费的，有些是付费的。所以这是我的问题：

1）我看不到任何使用 InApp 购买免费提供东西的方法，所以我假设我需要使用 InApp for Pay 角色并自己为免费角色做。那是对的吗？

2）由于我负责下载我的角色，有没有批准的方法，我可以只使用 dataWithContentsFromURL 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:14:25.513

> 1）我看不到任何使用 InApp 购买免费提供东西的方法，所以我假设我需要使用 InApp for Pay 角色并自己为免费角色做。那是对的吗？

是的

> 2）无论我怎么做，InApp购买验证后我自己负责下载内容（角色），还是自由选择？

是的，您必须提供一些下载机制

> 3) 如果我负责下载我的角色，是否有经过批准的方法？它只是使用 dataWithContentsFromURL 吗？

是的，或者您可以使用一些帮助类，例如[http://allseeing-i.com/ASIHTTPRequest/](http://allseeing-i.com/ASIHTTPRequest/) 他们有一个很好的类来下载具有下载恢复功能的东西，例如[http://allseeing-i.com/ASIHTTPRequest/使用方法#using_a_download_cache](http://allseeing-i.com/ASIHTTPRequest/How-to-use#using_a_download_cache)

在所有方面，您都必须提供服务器端 api，以及用于实现下载过程的 url

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:17:05.640

这主要取决于您是否真的需要从外部（您的）服务器下载字符，或者您可以将它们保留在最终应用程序中。

您必须提供一种通用的方式来下载角色，并注意仅将 InApp 购买用于付费角色。当您要使用时，`StoreKit`您将有一些方法可以调用，这将导致从 Apple 事务管理器调用的回调，该回调将能够通知购买是否顺利结束或其他。

然后，这取决于您是要使应用内购买可从服务器下载还是仅可解锁：

*   对于内置内容，您只需启用它
*   对于可下载的内容，您将收到交易收据，该收据将发送到您的服务器以检查交易的有效性

两种模型都在[这里](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/APIOverview/OverviewoftheStoreKitAPI.html#//apple_ref/doc/uid/TP40008267-CH100-SW1)详细描述。

# google-places-api - Google Places API：搜索包含空格的名称

> ID：10903363
> 
> 赞同：1
> 
> 时间：2012-06-05T19:09:03.423
> 
> 标签：google-places-api

是否可以搜索包含空格的名称？

```
name: ['Burger&nbsp;King|Subway']  //fails
name: ['McDonald|Subway|Chipotle'] // works 
```

[https://maps.googleapis.com/maps/api/place/search/json?location=33.4,-112.0&radius=5000&name=McDonald|Subway|Chipotle&sensor=false&key=yourkeyhere](https://maps.googleapis.com/maps/api/place/search/json?location=33.4,-112.0&radius=5000&name=McDonald|Subway|Chipotle&sensor=false&key=yourkeyhere)

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T14:01:41.533

正如 SKAR 所说，当你有空格时添加 %22 。您的搜索词，而不是汉堡王，变成了“汉堡王”。

SKAR 建议的 URL：

[https://maps.googleapis.com/maps/api/place/nearbysearch/xml?location=-41.21545,174.89416&radius=10000&name=%22strike%20entertainment%20centre%22&sensor=true&key=[YourKey]](https://maps.googleapis.com/maps/api/place/nearbysearch/xml?location=-41.21545,174.89416&radius=10000&name=%22strike%20entertainment%20centre%22&sensor=true&key=[YourKey])

不要用 %22**替换**您的 %20（空格），而是在您的搜索词之前和之后**添加它们。**

干杯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T17:42:02.107

如果名称之间有空格，请使用“+” -

```
https://maps.googleapis.com/maps/api/place/search/json?location=33.4,-112.0&radius=5000&name=Burger+King&sensor=false&key=YourKey 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-22T12:16:33.687

有空格时添加**%22 （引号）**

例如 https://maps.googleapis.com/maps/api/place/nearbysearch/xml?location=-41.21545,174.89416&radius=10000&name=strike%22entertainment%22centre&sensor=true&key=[YourKey]

谢谢，斯卡尔

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T00:27:10.180

Places API 不正式支持使用多个关键字或名称执行地点搜索请求，因此不能保证返回准确的结果。

如果您认为支持多个关键字或名称将是一项有用的功能，请[在此处](http://code.google.com/p/gmaps-api-issues/issues/entry?template=Places%20API%20-%20Feature%20Request)提交“Places API - 功能请求” 。

# android - 如何为 ListView 中的单个元素设置动画

> ID：10903364
> 
> 赞同：2
> 
> 时间：2012-06-05T19:09:08.117
> 
> 标签：android, listview, animation

我正在做一个基于 ListView 的小型 Android 应用程序。当用户在列表中选择一个或多个元素并随后从 ActionBar 中选择一个菜单项时，我想对列表中的选定元素做一个小动画，这就是问题所在。

没有任何东西有生气——也没有任何东西失败。以下代码片段是我正在做的事情的简化版本：

```
private void animateListViewItem()
{
    TranslateAnimation anim = new TranslateAnimation(Animation.RELATIVE_TO_SELF, 0.0f,Animation.RELATIVE_TO_SELF, 0.0f,
            Animation.RELATIVE_TO_SELF, -1.0f,Animation.RELATIVE_TO_SELF, 0.0f);
    anim.setDuration(2000);
    View v = fragment.getListAdapter().getView(fragment.getListView().getFirstVisiblePosition(), null, null);
    v.startAnimation(anim);
} 
```

当我弄乱它，试图找出问题所在时，我曾一度用整个 ListView 替换该项目，以排除动画是问题的根源——就像这样。

```
private void animateListViewItem()
{
    TranslateAnimation anim = new TranslateAnimation(Animation.RELATIVE_TO_SELF, 0.0f,Animation.RELATIVE_TO_SELF, 0.0f,
            Animation.RELATIVE_TO_SELF, -1.0f,Animation.RELATIVE_TO_SELF, 0.0f);
    anim.setDuration(2000);
    fragment.getListView().startAnimation(anim);
} 
```

令我惊讶的是，这很完美！

所以我的问题是 - 为什么我不能为 ListView 中的各个元素设置动画？还是我做错了什么？

谢谢！

PS 作为记录，ListView 填充了自定义视图（LinearLayouts），并且我在制作动画之前检查了我是否获得了正确的项目。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T06:29:23.153

我发现了问题所在：

```
View v = fragment.getListAdapter().getView(fragment.getListView().getFirstVisiblePosition(), null, null); 
```

这条线是问题所在。它返回一个*new* `View`以显示列表中指定位置的基础数据，而不是*现有的* `View`. 所以返回`View`的与列表无关。

而是这样做：

```
View v = fragment.getListView().getChildAt(fragment.getListView().getFirstVisiblePosition()); 
```

让我`View`知道列表正在使用并且动画按预期工作。

# makefile - 虚拟内存耗尽错误

> ID：10903367
> 
> 赞同：-1
> 
> 时间：2012-06-05T19:09:19.423
> 
> 标签：makefile

我正在使用 gnu make 3.80，但出现以下错误。我有 4 GB 的 RAM 和大约 5.6 GB 的交换空间。

```
make[1]: *** virtual memory exhausted.  Stop. 
```

我必须在 make 3.80 上工作。安装 3.81 对我来说不是一个选项。有什么技巧可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-28T14:59:09.293

您是否包括从另一个版本的 make 生成的依赖文件？

* * *

刚刚经历了这个错误，并试图为一些遗留代码支持旧版本的 make (3.80)。我的 make 系统以如下方式包含依赖文件：

```
-include $(myDependencies) 
```

问题是，当我使用 make 4.0 构建程序时，我的依赖文件已经生成。通过再次执行清理和重建，我能够成功构建。我假设新的 make 版本增加了旧版本的 make 无法很好处理的依赖文件的复杂性。

# c++ - 如何插入自定义类项以映射 C++

> ID：10903370
> 
> 赞同：-2
> 
> 时间：2012-06-05T19:09:28.130
> 
> 标签：c++, map, iterator

我有一个类，如何将这个类的一个对象添加到映射中，并通过 id 找到它？

**班级代码：**

```
class Client {
    int FileDescriptor, Id, cryptcode;
    unsigned char CustomData[256];

    void PrepareClient()
    {
        // init code
    }
  public:
    AnticheatClient (int fd, int id, int crypt_code)
    {
        FileDescriptor = fd;
        Id = id;
        cryptcode = crypt_code;
        PrepareCrypt();
    }

    void OwnCryptEncrypt(unsigned char* data, int len)
    {
 //...
    }

    void OwnCryptDecrypt(unsigned char* data, int len)
    {
 //...
    }
};

std::map<int, Client> ClientTable;

int main()
{
 int id = 1;
 Client c(1, id, 1);
 // how can i add this client to map and how can i find it by id?
} 
```

我尝试了很多示例代码，但没有使用自定义类，所以它们不起作用。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:13:36.177

`Client`使用 key=10添加一个：

```
ClientTable[10] = Client(1, id, 1); 
```

要查找 key=10 的元素：

```
std::map<int, Client>::iterator it = ClientTable.find(10);
if (it != ClientTable.end()) {
    int key = it->first;
    Client c = it->second;
} 
```

您还可以使用：

```
Client c = ClientTable[10]; 
```

但调用`operator[]`不是`const`。所以，如果你只想找到一个元素，那很可能不是你想要使用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:11:53.357

1）“*我怎样才能将这个类的一个对象添加到映射中？* ”

```
ClientTable[id] = c; 
```

好吧，从技术上讲，它会将对象的**副本**添加到地图中。

2）“*并通过 id 找到它？* ”

```
Client lookerUpper = ClientTable[id]; 
```

# asp-classic - 带有 ADODB 的 Asp Classic 需要迁移到 Medium Trust

> ID：10903372
> 
> 赞同：0
> 
> 时间：2012-06-05T19:09:28.873
> 
> 标签：asp-classic, adodb, medium-trust

我有一个**非常**大的项目，主要是用 ASP 经典编写的。它在数千个文件中使用 ADODB（主要是记录集）。将项目移至中等信任是强制性的，尽管可以自定义。尝试在中等信任下加载 ADODB.dll 会导致：

> System.Security.SecurityException：该程序集不允许部分受信任的调用者。

1.  我找不到从 CustomMedium Trust 级别禁用该控件的方法。有这样的事吗？

2.  有没有其他方法可以在 Medium Trust 下加载旧的 ADODB？我不知道如何为 ADODB 命名，因为它不是开源的。

3.  是否有其他与 ADODB 足够相似的库可以替代它，也许是一个可以强命名的开源库？

4.  任何其他不涉及将数千页迁移到 ASP.NET/ADO.NET 的想法？

中断应用程序的特定调用是

```
using ADODB;
...
namespace appLib
{
    public Recordset recordset;
    private void init()
    {
        ...
        this.recordset = new RecordsetClass();  //This throws SecurityException 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T13:58:14.757

TRUST 的概念是特定于 .NET 而不是经典 ASP。除非您使用 TRUST 的 .NET 处理程序概念运行经典的 .asp 代码，否则不相关。

# cakephp - CakePHP：beforeSave 不能与 saveMany 一起使用？

> ID：10903375
> 
> 赞同：1
> 
> 时间：2012-06-05T19:09:33.497
> 
> 标签：cakephp, save

因此，出于某种原因，我在 beforeSave 回调中对数据所做的任何事情，虽然它适用于单个记录，但在使用 saveMany 时不起作用。

是什么赋予了？如果我执行以下操作：

```
public function beforeSave() {
    $this->data['foo'] = 'bar'
    die($this->data);
} 
```

我可以看到实际上 $this->data 确实发生了变化，但 saveMany 只是忽略它并保存原始数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:57:33.743

确保在操作 $this->data 时包含模型名称，例如 $this->data['Event']['foo'] = bar. 确保该方法也返回 true，否则保存将失败。

* * *

**编辑**

我做了一个简单的例子，它似乎对我有用，请参见下面的代码。我的怀疑是，也许您错误地调用了 saveMany 并将整个 $this->request->data 对象传递给它，但是如果没有看到您的调用也很难猜测。

**看法**

```
<?php echo $this->Form->create('ParentTable'); ?>
    Record 1: <br />
    <?php echo $this->Form->input('ParentTable.0.name'); ?>

    Record 2: <br />
    <?php echo $this->Form->input('ParentTable.1.name'); ?>
<?php echo $this->Form->end('Submit'); ?> 
```

**控制器**

```
public function index() {
    if ($this->request->data) {
        $this->ParentTable->saveMany($this->request->data['ParentTable']);
    }
} 
```

**模型**

```
public function beforeSave() {
    $this->data['ParentTable']['name'] .= ' modified';
    return true;
} 
```

# symfony - symfony2 中的助手 format_number_choice

> ID：10903376
> 
> 赞同：0
> 
> 时间：2012-06-05T19:09:38.100
> 
> 标签：symfony

symfony2 中是否有类似的**format_number_choice**助手？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:48:25.563

你`transchoice`在树枝上有过滤器。
请参阅[此处](http://symfony.com/doc/current/book/translation.html#twig-templates)了解更多信息。

# git - 克隆本地 git 存储库

> ID：10903383
> 
> 赞同：0
> 
> 时间：2012-06-05T19:10:00.070
> 
> 标签：git, clone

尝试在构建服务器上克隆本地存储库时遇到一个奇怪的问题。

我的存储库可以说是`/opt/git/repos/my_repo.git`

做一个`git clone /opt/git/repos/my_repo.git`非常快

但是，如果我编辑我的`.gitconfig`

添加以下内容：

```
[url "/opt/git/repos/"]
    insteadOf = "gitserver:" 
```

然后尝试：

`git clone gitserver:my_repo.git`这很慢

更新：

标志 --local 或 -l 无效。Git 似乎默认为远程存储库。

事实上，它将 gitserver: 别名视为远程 git 服务器。有没有解决这个问题的方法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:42:06.100

只是猜测，它可能试图在 DNS 中查找“/opt/git/repos”。也许试试`[url file:///opt/git/repos/]`。如果它实际上是在尝试查找 gitserver ，仍然可能无法正常工作。您可能还想使用 --local 标志。

# json - Grails：使用 executeQuery 呈现 JSON

> ID：10903388
> 
> 赞同：1
> 
> 时间：2012-06-05T19:10:21.017
> 
> 标签：json, grails, groovy

我正在测试一个控制器，只是想检索 JSON。但是，我注意到控制器返回数据，但它没有正确返回带有键/值对的 JSON。它实际上只返回数据。但是我注意到，如果我使用 Incident.getAll()，它会正确返回 JSON。例如，它将返回 [INCIDENTID: "Value"]，而不是使用只返回数据的 executreQuery。

我的代码：

```
def incident = Incident.executeQuery("select a.INCIDENTID from Incident a")
render incident as JSON 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:34:02.840

结果`executeQuery`是您指定的属性列表，而不是实际的域对象。例如：

```
TestDomain.executeQuery("select t.id from TestDomain") as JSON
===> [1, 2, 3] 
```

如果你想要域对象，你可以使用`findAll`。尝试这样的事情：

```
TestDomain.findAll("from TestDomain") as JSON
===>[{"class":"TestDomain","id":1,"name":"one"},
  {"class":"TestDomain","id":2,"name":"two"},
  {"class":"TestDomain","id":3,"name":"three"}] 
```

# javascript - 在javascript中使用变量作为数组的索引

> ID：10903392
> 
> 赞同：0
> 
> 时间：2012-06-05T19:10:31.390
> 
> 标签：javascript, indexing

这是我的代码：

```
var span = getSpanWithClass("galleria-current");
var slideNumber = span.innerHTML
var imageIDDivs = document.getElementsByClassName("slideshowImage");
var singleimageidDiv = imageIDDivs[slideNumber] 
```

如果我用这个，`sigleImageidDiv`里面什么都没有。如果我像这样输入 0 或 1：

```
var singleimageidDiv = imageIDDivs[1] 
```

它工作正常。`slideNumber`是`1`，在我的测试用例中。

我也试过这些：

```
var singleimageidDiv = imageIDDivs[Number(slideNumber)]

var singleimageidDiv = imageIDDivs[parseInt(slideNumber)] 
```

使用变量作为数组索引的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:12:21.840

使用基数解析为 int。

这是正确的做法：

```
imageIDDivs[parseInt(slideNumber, 10)]; 
```

[**现场演示**](http://jsfiddle.net/h86gn/) 如果它不起作用，那么您的问题出在其他地方。

* * *

BTW 索引也适用于字符串。 [**演示**](http://jsfiddle.net/h86gn/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:13:40.477

`innerHTML`返回元素内的字符串，因此即使您的元素内有一个数字，它也会作为字符串返回，这就是为什么当您将该变量用作数组的索引时，您不会得到结果。使用 parseInt 是一个可接受的解决方案，您也可以执行类似的操作`span.innerHTML * 1`，这将强制 JS 将字符串视为整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:13:47.183

我认为，您的`getSpanWithClass`功能有误。

# regex - 如何使用正则表达式模式提取括号中的子字符串

> ID：10903394
> 
> 赞同：14
> 
> 时间：2012-06-05T19:10:43.110
> 
> 标签：regex, vba, substring

这可能是一个简单的问题，但不幸的是我无法得到我想要的结果......

说，我有以下行：

```
"Wouldn't It Be Nice" (B. Wilson/Asher/Love) 
```

我将不得不寻找这种模式：

```
" (<any string>) 
```

为了检索：

```
B. Wilson/Asher/Love 
```

我尝试了类似的东西，`"" (([^))]*))`但它似乎不起作用。另外，我想使用`Match.Submatches(0)`这样可能会使事情变得有点复杂，因为它依赖于括号......

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-05T20:17:59.793

**编辑**：检查您的文档后，问题是括号前有不间断的空格，而不是常规空格。所以这个正则表达式应该可以工作：`""[ \xA0]*\(([^)]+)\)`

```
""       'quote (twice to escape)
[ \xA0]* 'zero or more non-breaking (\xA0) or a regular spaces
\(       'left parenthesis
(        'open capturing group
[^)]+    'anything not a right parenthesis
)        'close capturing group
\)       'right parenthesis 
```

在一个函数中：

```
Public Function GetStringInParens(search_str As String)
Dim regEx As New VBScript_RegExp_55.RegExp
Dim matches
    GetStringInParens = ""
    regEx.Pattern = """[ \xA0]*\(([^)]+)\)"
    regEx.Global = True
    If regEx.test(search_str) Then
        Set matches = regEx.Execute(search_str)
        GetStringInParens = matches(0).SubMatches(0)
    End If
End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-06T07:17:22.617

严格来说，不是对您的问题的回答，但有时，对于某些事情，这个简单、好的 ol' 字符串函数比正则表达式更容易混淆和简洁。

```
Function BetweenParentheses(s As String) As String
    BetweenParentheses = Mid(s, InStr(s, "(") + 1, _
        InStr(s, ")") - InStr(s, "(") - 1)
End Function 
```

用法：

```
Debug.Print BetweenParentheses("""Wouldn't It Be Nice"" (B. Wilson/Asher/Love)")
'B. Wilson/Asher/Love 
```

**编辑**@alan 指出这将错误地匹配歌曲标题中括号的内容。稍加修改就可以轻松解决这个问题：

```
Function BetweenParentheses(s As String) As String
    Dim iEndQuote As Long
    Dim iLeftParenthesis As Long
    Dim iRightParenthesis As Long

    iEndQuote = InStrRev(s, """")
    iLeftParenthesis = InStr(iEndQuote, s, "(")
    iRightParenthesis = InStr(iEndQuote, s, ")")

    If iLeftParenthesis <> 0 And iRightParenthesis <> 0 Then
        BetweenParentheses = Mid(s, iLeftParenthesis + 1, _
            iRightParenthesis - iLeftParenthesis - 1)
    End If
End Function 
```

用法：

```
Debug.Print BetweenParentheses("""Wouldn't It Be Nice"" (B. Wilson/Asher/Love)")
'B. Wilson/Asher/Love
Debug.Print BetweenParentheses("""Don't talk (yell)""")
' returns empty string 
```

当然，这比以前不那么简洁了！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T19:13:02.747

这是一个不错的正则表达式

```
".*\(([^)]*) 
```

在 VBA/VBScript 中：

```
Dim myRegExp, ResultString, myMatches, myMatch As Match
Dim myRegExp As RegExp
Set myRegExp = New RegExp
myRegExp.Pattern = """.*\(([^)]*)"
Set myMatches = myRegExp.Execute(SubjectString)
If myMatches.Count >= 1 Then
    Set myMatch = myMatches(0)
    If myMatch.SubMatches.Count >= 3 Then
        ResultString = myMatch.SubMatches(3-1)
    Else
        ResultString = ""
    End If
Else
    ResultString = ""
End If 
```

这匹配

```
Put Your Head on My Shoulder 
```

在

```
"Don't Talk (Put Your Head on My Shoulder)" 
```

**更新 1**

我让正则表达式在您的 doc 文件上松散，它按要求匹配。很确定正则表达式没问题。我对 VBA/VBScript 不流利，但我猜这就是它出错的地方

如果您想进一步讨论正则表达式，我可以。我并不急于开始深入研究这个看起来很神秘的 VBscript API。

给定新的输入，正则表达式被调整为

```
".*".*\(([^)]*) 
```

这样它就不会错误地匹配出现在引号内的 (Put Your Head on My Shoulder)。

![在此处输入图像描述](../Images/3e5d8f34a39d5fdf2ec4f180836e2084.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T13:12:37.250

此函数适用于您的示例字符串：

```
Function GetArtist(songMeta As String) As String
  Dim artist As String
  ' split string by ")" and take last portion
  artist = Split(songMeta, "(")(UBound(Split(songMeta, "(")))
  ' remove closing parenthesis
  artist = Replace(artist, ")", "")
End Function 
```

前任：

```
Sub Test()

  Dim songMeta As String

  songMeta = """Wouldn't It Be Nice"" (B. Wilson/Asher/Love)"

  Debug.Print GetArtist(songMeta)

End Sub 
```

将“B. Wilson/Asher/Love”打印到即时窗口。

它也解决了艾伦[提到](https://stackoverflow.com/questions/10903394/vba-regex-pattern#comment14228960_10909762)的问题。前任：

```
Sub Test()

  Dim songMeta As String

  songMeta = """Wouldn't (It Be) Nice"" (B. Wilson/Asher/Love)"

  Debug.Print GetArtist(songMeta)

End Sub 
```

还将“B. Wilson/Asher/Love”打印到即时窗口。当然，除非艺术家姓名还包括括号。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-18T09:39:49.873

这是另一个用 vbscript `(?:\()(.*)(?:\))` [Demo 测试的正则表达式 Here](https://regex101.com/r/Vc99YE/1)

* * *

```
Data = """Wouldn't It Be Nice"" (B. Wilson/Asher/Love)"
wscript.echo Extract(Data)
'---------------------------------------------------------------
Function Extract(Data)
Dim strPattern,oRegExp,Matches
strPattern = "(?:\()(.*)(?:\))"
Set oRegExp = New RegExp
oRegExp.IgnoreCase = True 
oRegExp.Pattern = strPattern
set Matches = oRegExp.Execute(Data) 
If Matches.Count > 0 Then Extract = Matches(0).SubMatches(0)
End Function
'--------------------------------------------------------------- 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-09T10:32:20.187

我认为您需要一个更好的数据文件；）您可能需要考虑将文件预处理为临时文件以进行修改，以便将不符合您的模式的异常值修改为符合您的模式的位置。这样做有点费时，但是当数据文件缺乏一致性时总是很困难。

# jquery - 带有下一个/上一个按钮的引导模式表单

> ID：10903395
> 
> 赞同：1
> 
> 时间：2012-06-05T19:10:43.407
> 
> 标签：jquery, twitter-bootstrap

我是 bootstrap 的新手，来自 jQueryUI 我想知道是否有人做过下一个/上一个表单界面来解决整个滚动视口的想法。

在过去，我曾与以下工作：

[http://css-tricks.com/jquery-ui-tabs-with-nextprevious/](http://css-tricks.com/jquery-ui-tabs-with-nextprevious/)

因此，在我开始之前，我想问一下——也想注意验证等方面的任何问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:19:06.160

它未经测试，但一个基本的想法是在您的模态正文中包含一个可选项卡导航，并为每个选项卡内容添加一个上一个/下一个按钮，如下所示：

```
<form action="">
     <div class="tabbable">
        <ul class="nav nav-tabs">
          <li class="active"><a href="#tab1" data-toggle="tab">Section 1</a></li>
          <li class=""><a href="#tab2" data-toggle="tab">Section 2</a></li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane" id="tab1">
            <p>Form for section one</p>
            <a href="#tab2" data-toggle="tab" class="btn pull-right">Next</a>
          </div>
          <div class="tab-pane" id="tab2">
            <p>Next form part</p>
            <a href="#tab2" data-toggle="tab" class="btn pull-left">Prev</a>
          </div>
        </div>
      </div>
</form> 
```

另一种选择是隐藏`<ul>`-Tag 并将您的上一个/下一个按钮放入模态页脚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T08:59:06.013

```
<div class="tab-pane" id="tab1"> 
```

应该

```
<div class="tab-pane active" id="tab1"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-10T20:26:17.903

我有一个教程，使用 Bootstrap [http://fearlessflyer.com/next-and-previous-buttons-bootstrap-photo-gallery/将上一个/下一个按钮添加到照片库](http://fearlessflyer.com/next-and-previous-buttons-bootstrap-photo-gallery/)

也许您可以使用相同的技术 - 使用 $(this).index()。

# javascript - 使 div 可点击和 javascript 运行一些不同的链接

> ID：10903399
> 
> 赞同：1
> 
> 时间：2012-06-05T19:11:10.063
> 
> 标签：javascript, css, html

我在页面上的菜单有以下代码

```
<td width="200" valign="top" align="left" bgcolor="#ffffff">
    <div id="stemenu">
        <div id="mbuttonon">
            <a class="mwink" href="index.html">Home</a>
        </div>
        <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr>
                <td width="100%" height="6"></td>
            </tr>
        </table>
        <div id="mbutton">
            <a class="mwink" href="index.html">About us</a>
        </div>
        <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr>
                <td width="100%" height="6"></td>
            </tr>
        </table>
        <div id="mbutton">
            <a class="mwink" href="index.html">FAQs</a>
        </div>
        <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr>
                <td width="100%" height="6"></td>
            </tr>
        </table>
        <div id="mbutton">
            <div id="plus">
                <a href="javascript:animatedcollapse.toggle('aa')"><img src="images/plus.gif"></a>
            </div>
            <a class="mwink" href="index.html">Conditions we treat</a>
        </div>
        <div id="aa" style="width: 160px; display:none;">
            <ul>
                <li>
                    <a class="mlink" href="#">MSK</a>
                    <li>
                        <a class="mlink" href="#">Neurological</a>
                        <li>
                            <a class="mlink" href="#">Paediatrics</a>
                            <li>
                                <a class="mlink" href="#">Surgery</a>
            </ul>
        </div>
        <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr>
                <td width="100%" height="6"></td>
            </tr>
        </table>
        <div id="mbutton">
            <a class="mwink" href="index.html">Our clinics</a>
        </div>
        <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr>
                <td width="100%" height="6"></td>
            </tr>
        </table>
        <div id="mbutton">
            <div id="plus">
                <a href="javascript:animatedcollapse.toggle('ab')"><img src="images/plus.gif"></a>
            </div>
            <a class="mwink" href="index.html">Services</a>
        </div>
        <div id="ab" style="width: 160px; display:none;">
            <ul>
                <li>
                    <a class="mlink" href="#">Clinic Appointments</a>
                    <li>
                        <a class="mlink" href="#">Gym rehabilitation</a>
                        <li>
                            <a class="mlink" href="#">Home visits</a>
                            <li>
                                <a class="mlink" href="#">Hydrotherapy</a>
                                <li>
                                    <a class="mlink" href="#">Musculoskeletal physiotherapy</a>
                                    <li>
                                        <a class="mlink" href="#">Neurological physiotherapy</a>
                                        <li>
                                            <a class="mlink" href="#">Paediatric physiotherapy</a>
            </ul>
        </div>
        <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr>
                <td width="100%" height="6"></td>
            </tr>
        </table>
        <div id="mbutton">
            <div id="plus">
                <a href="javascript:animatedcollapse.toggle('ac')"><img src="images/plus.gif"></a>
            </div>
            <a class="mwink" href="index.html">Treatments</a>
        </div>
        <div id="ac" style="width: 160px; display:none;">
            <ul>
                <li>
                    <a class="mlink" href="#">Acupuncture</a>
                    <li>
                        <a class="mlink" href="#">Electrotherapy</a>
                        <li>
                            <a class="mlink" href="#">Gait Ax</a>
                            <li>
                                <a class="mlink" href="#">Hydrotherapy</a>
                                <li>
                                    <a class="mlink" href="#">Manipulation</a>
                                    <li>
                                        <a class="mlink" href="#">Massage</a>
                                        <li>
                                            <a class="mlink" href="#">Neurological rehabilitation</a>
                                            <li>
                                                <a class="mlink" href="#">Orthotics</a>
                                                <li>
                                                    <a class="mlink" href="#">Paediatric physio</a>
                                                    <li>
                                                        <a class="mlink" href="#">Pain management</a>
                                                        <li>
                                                            <a class="mlink" href="#">Physiotherapy</a>
                                                            <li>
                                                                <a class="mlink" href="#">Respiratory treatment</a>
            </ul>
        </div>
        <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr>
                <td width="100%" height="6"></td>
            </tr>
        </table>
        <div id="mbutton">
            <a class="mwink" href="index.html">Contact us</a>
        </div>
        <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr>
                <td width="100%" height="0"></td>
            </tr>
        </table>
    </div>
    <br>
    <br>
</td> 
```

点击加号按钮打开子菜单，

我的问题是，如何使完整的 div 成为锚链接（单击 mbutton div 的任何部分，它应该跟随链接）在单击加号按钮时，它应该打开子菜单..

基本上，我想让所有部分都可点击，不仅仅是文本（例如主页，关于我们），而加号按钮也应该打开子菜单......

有人可以指导我吗？目前，要么我只能使锚文本可点击，要么我失去了 javascript 子菜单的打开......

我可以用 CSS 做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:14:19.190

`display:block`就是这样。

```
#plus a { display:block } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:34:30.420

首先，您为多个元素放置了相同的 id，这是错误的。为每个元素分配 uniqpe Id 名称。
试试这个 ：

```
<td width="200" valign="top" align="left" bgcolor="#ffffff">
 <div id="stemenu">
 <div id="mbuttonon"><a class="mwink" href="index.html">Home</a></div>

<table cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td width="100%" height="6"></td></tr></table>
<div id="mbutton"><a class="mwink" href="index.html">About us</a></div>
<table cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td width="100%" height="6"></td></tr></table>
<div id="mbutton"><a class="mwink" href="index.html">FAQs</a></div>
<table cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td width="100%" height="6"></td></tr></table>
<div id="mbutton"><div id="plus"  class='plus'><a href="#"><img src="images/plus.gif">   </a></div> <a class="mwink" href="index.html">Conditions we treat</a></div> 
<div id="aa" style="width: 160px; display:none;">
<ul><li><a class="mlink" href="#">MSK</a>
<li><a class="mlink" href="#">Neurological</a>
<li><a class="mlink" href="#">Paediatrics</a>
<li><a class="mlink" href="#">Surgery</a>
</ul></div>

<table cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td width="100%" height="6"></td></tr></table>
<div id="mbutton"><a class="mwink" href="index.html">Our clinics</a></div>
<table cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td width="100%" height="6"></td></tr></table>
<div id="mbutton"><div id="plus" class='plus'><a href="#"><img src="images/plus.gif">    </a></div> <a class="mwink" href="index.html">Services</a></div> 
<div id="ab" style="width: 160px; display:none;">
<ul>
 <li><a class="mlink" href="#">Clinic Appointments</a>
 <li><a class="mlink" href="#">Gym rehabilitation</a>
 <li><a class="mlink" href="#">Home visits</a>
 <li><a class="mlink" href="#">Hydrotherapy</a>
 <li><a class="mlink" href="#">Musculoskeletal physiotherapy</a>
 <li><a class="mlink" href="#">Neurological physiotherapy</a>
 <li><a class="mlink" href="#">Paediatric physiotherapy</a>
 </ul></div>

 <table cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td  width="100%" height="6"></td></tr></table>

 <div id="mbutton"><div id="plus"  class='plus'><a href="#"><img src="images/plus.gif"></a></div> <a class="mwink" href="index.html">Treatments</a></div> 
 <div id="ac" style="width: 160px; display:none;">
 <ul>
 <li><a class="mlink" href="#">Acupuncture</a>
 <li><a class="mlink" href="#">Electrotherapy</a>
 <li><a class="mlink" href="#">Gait Ax</a>
 <li><a class="mlink" href="#">Hydrotherapy</a>
 <li><a class="mlink" href="#">Manipulation</a>
 <li><a class="mlink" href="#">Massage</a>
 <li><a class="mlink" href="#">Neurological rehabilitation</a>
 <li><a class="mlink" href="#">Orthotics</a>
 <li><a class="mlink" href="#">Paediatric physio</a>
 <li><a class="mlink" href="#">Pain management</a>
 <li><a class="mlink" href="#">Physiotherapy</a>
 <li><a class="mlink" href="#">Respiratory treatment</a>
 </ul></div>

 <table cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td width="100%" height="6"></td></tr></table>

 <div id="mbutton"><a class="mwink" href="index.html">Contact us</a></div>
 <table cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td width="100%" height="0"></td></tr></table>

 </div>

 <br><br>

 </td>​ 
```

Javascript：

```
 jQuery(".plus").click(function(){
      jQuery(this).parent('div').next('div').slideToggle();
 });​ 
```

我已经为所有包含 plus 图像的 div 分配了一个通用类 'plus'，这样您就不需要为每个菜单编写代码。

这是[演示](http://jsfiddle.net/M6Xhz/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:19:48.470

对于这种行为，您需要使用 JavaScript。您可能更愿意使用 javascript 点击事件或使用像[jQuery这样的轻松生活库](http://jquery.com/)

从`user 999`你那里可以：

```
var something = document.getElementById('something');

something.style.cursor = 'pointer';
something.onclick = function() {
    // do something...
}; 
```

使用 jQuery：

```
<div id="target">
  Click here
</div>

<script>
$(function(){

   $("#target").click(function() {
     alert("Handler for .click() called.");
   });
 });
</script> 
```

**更新** 使用您的代码示例，并使用 jQuery，我们可以执行类似的操作

```
 <!-- import jQuery library -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" ></script>

    <!-- JavaScript code for clicking the menu -->
    <script>
    $(function(){

       $("#mbutton").click(function() {
         window.location="http://google.com";
       });
    });
    </script>
    <div id="mbutton" style="cursor:pointer">
        <a class="mwink" href="index.html">About us</a>
    </div> 
```

希望你能更好地理解它。

# asp.net-mvc - 在 IIS 上托管 ASP.NET MVC 4 Web api - 无法加载资源

> ID：10903401
> 
> 赞同：2
> 
> 时间：2012-06-05T19:11:21.833
> 
> 标签：asp.net-mvc, api, iis, asp.net-mvc-4

我正在尝试设置一个 API 并对其进行测试，（但我对 ASP.NET MVC 和 IIS 的了解有限）。我正在使用[http://www.asp.net/web-api/overview/creating-web-apis](http://www.asp.net/web-api/overview/creating-web-apis)提供的示例代码（示例：联系人管理器）。

我从 ContactManager 文件夹（App_Data、Content 等）上传了所有提供的文件，然后在 IIS 中使用 IP 142.70.43.211 和指向包含文件的本地目录的主目录建立了一个新网站。

Default.htm 文件加载正常，但 Jquery ajax 调用返回错误“加载资源失败：服务器响应状态为 404（未找到）”。

起初，我认为 jquery get() 调用只是请求“联系人”而不是完整的 url，但 Chrome 的控制台显示它正在尝试加载“142.70.43.211/contacts”并失败......

编辑：我忘记上传提供的“包”文件夹......这样做之后，控制台给我错误：“GET 142.70.43.211/contacts 404（未找到）”......没有太大不同......

我错过了设置的步骤吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T14:58:49.810

WebApiConfig.cs文件显示定义如下的路由[：](http://code.msdn.microsoft.com/Contact-Manager-Web-API-0e8e373d/sourcecode?fileId=60331&pathId=1438156725)

```
config.Routes.MapHttpRoute( 
    name: "DefaultApi", 
    routeTemplate: "api/{controller}/{id}", 
    defaults: new { id = RouteParameter.Optional } 
); 
```

这意味着它期待/142.70.43.211/ **api** /contacts。检查 Views\Home\Index.html 是否引用了路径“api/contacts”而不仅仅是“contacts”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T04:14:37.993

在我转到站点的 IIS 管理器 -> 基本设置并将应用程序池更改为“ASP.NET v4.0”之前，我遇到了 404 错误。

# ruby-on-rails - Mongoid 中的非持久字段

> ID：10903408
> 
> 赞同：0
> 
> 时间：2012-06-05T19:12:05.153
> 
> 标签：ruby-on-rails, mongoid

我可以在 mongoid 中定义一个字段，但不能持久化吗？我需要 to_json 来包含该字段，并且使用 attr_accessor 和 after_initialize 来计算该值不会将其包含在 to_json 结果中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T09:13:33.573

通过操作 JSON 数组本身解决了这个问题，保留了 to_json 的大部分功能。

```
raw((c.to_json).insert(-2, ",\"url\":#{c.image_url.to_json}")) 
```

# ruby-on-rails - 无法将代码推送到 github

> ID：10903412
> 
> 赞同：1
> 
> 时间：2012-06-05T19:12:17.043
> 
> 标签：ruby-on-rails, ruby-on-rails-3, git, github

我尝试使用以下命令将我的代码推送到 github：

```
git remote add https://github.com/user/sample_app.git

git push origin master 
```

并得到以下错误：

```
error: failed to push some refs to 'https://github.com/user/sample_app.git'
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes before pushing again.  See the 'non-fast forward'
section of 'git push --help' for details. 
```

要查看错误是否在我输入的遥控器上：

```
git pull 
```

并得到以下错误：

```
error: SSL certificate problem, verify that the CA cert is OK. Details:
error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed while accessing https://github.com/sub1010/sample_app.git/info/refs
fatal: HTTP request failed 
```

为什么我不能将我的代码推送到 github？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:38:14.867

尝试添加 ssh repo 而不是 http repo

```
git remote rm sample_app
git remote add git@github.com/user/sample_app.git 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:29:30.537

Github 有关于设置存储库并确保您可以连接它的**详细说明。**链接：[Github Setup](https://help.github.com/articles/set-up-git)和[Github Create A Repo](https://help.github.com/articles/create-a-repo)

# algorithm - Edmonds Karp 算法和 0 1 容量

> ID：10903419
> 
> 赞同：0
> 
> 时间：2012-06-05T19:12:44.727
> 
> 标签：algorithm, edmonds-karp

当唯一可用容量为 0 和 1 时，Edmonds Karp (BFS) 上限是多少？

*我不明白容量只有 0 和 1 时的区别，我知道如果容量为 0 和 1，福特 Fulkerson 发现流量值为 0 或 1。这对我有帮助吗？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:30:28.417

在 Edmonds-karp 算法中，在每次运行中，一条边都会饱和，因此 0 1 或随机容量边之间没有区别。意味着两个运行时间相同，算法也正常工作。

# matlab - matlab - 从矩阵中获取向量（quiverplot）

> ID：10903422
> 
> 赞同：0
> 
> 时间：2012-06-05T19:12:58.790
> 
> 标签：matlab

我正在读取图像并将其存储到二维矩阵中。在对其进行一些计算后，如下所示：

```
im = rgb2gray(imread('ellipse.png'));
im = im(:,:,1);
w = size(im,1);                   
h = size(im,2);                               
[dx,dy] = gradient(double(im));                
[x y] = meshgrid(1:h,1:w);                    
a = zeros(temp);
lambda = 1;
Ox =-1.^lambda.* -x;
Oy =-1.^lambda.* y;
hold on                                   
quiver(x,y,Ox,Oy) 
```

我从 quiverplot 得到以下图像：

[https://docs.google.com/file/d/0B0iDswLYaZ0zR2lUQ2NkZnd1QXM/edit?pli=1](https://docs.google.com/file/d/0B0iDswLYaZ0zR2lUQ2NkZnd1QXM/edit?pli=1)

我的问题是，如何从 quiverplot 访问这些向量（箭头）？稍后我需要在叉积中使用这些向量。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:03:29.973

一种简单的方法是将矩阵堆叠到一个大的 NxMx3 块中，然后像这样对它调用 cross：

```
myVectors = cat(3, Ox, Oy, zeros(size(Ox)));
someOtherVectors = myVectors+1;
result = cross(myVectors,someOtherVectors ); 
```

另一种方法是编写自己的交叉函数，如下所示：

```
function result = cross2d(Ax, Ay, Bx, By)
      result = Ax.*By - Ay.*Bx;
end 
```

并在您的代码中这样称呼它：

```
Mx = Ox + 1;
My = Oy + 1;

result2 = cross2d(Ox, Oy, Mx, My) 
```

（请注意，我刚刚制作了一组新的向量来通过添加一个来获取叉积......你会使用你自己的）

# java - 使用 Gson 序列化 Java 对象的字段对象

> ID：10903426
> 
> 赞同：2
> 
> 时间：2012-06-05T19:13:09.790
> 
> 标签：java, gson

我正在编写一个使用 Gson 将 Java 对象序列化为 Json 的函数。

我遇到的问题是它只序列化我的类的原始字段而不是对象字段。例如。我有两个类，例如：

```
class TestClass {
    public int i = 10;
    public TestClass2 tc2;
}

class TestClass2 {
    public int j = 20;
} 
```

我的测试是：

```
@Test
public void shouldSerializeSimpleObjectIntoJson() {
    TestClass tc = new TestClass();

    String json = new Gson().toJson(tc);
    System.out.println(json);
} 
```

Json 输出为：

```
{"i":10} 
```

它不包含 tc2 的字段。

如何配置 Gson 以递归方式将对象编码为 Json？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:17:03.983

该字段被忽略，因为它是`null`. 从[文档](https://sites.google.com/site/gson/gson-user-guide#TOC-Null-Object-Support)中：

> **Gson 中实现的默认行为是忽略空对象字段。** 这允许更紧凑的输出格式；但是，客户端必须为这些字段定义一个默认值，因为 JSON 格式会被转换回其 Java。
> 
> 以下是配置 Gson 实例以输出 null 的方法：
> 
> ```
> Gson gson = new GsonBuilder().serializeNulls().create(); 
> ```

如果您设置`tc.tc2`为 以外的值`null`，您应该在输出文件中看到它的字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:21:56.327

使用您的具体示例，添加一个构造函数，该构造函数将创建一个新的 tc2 实例：

```
public TestClass()
{
   tc2 = new TestClass2();
} 
```

看看它是否有帮助。如果在您的真实代码中，类似于 TestClass2 的类也有引用类，请创建它们的新实例

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T19:46:31.113

在 Java 中，默认情况下不初始化对象字段，这意味着 tc2 字段将为空，除非您将其设置为某个值。Gson 默认忽略空字段，因此它不会对其进行序列化。

您可以在构造函数中初始化该字段，就像另一个答案正确说的那样。或者您也可以通过以下方式对其进行初始化：

```
class TestClass {
    public int i = 10;
    public TestClass2 tc2 = new TestClass2();
} 
```

# php - 我如何阻止这个贪婪

> ID：10903429
> 
> 赞同：2
> 
> 时间：2012-06-05T19:13:21.190
> 
> 标签：php, regex, preg-match

我有以下正则表达式：

```
#^/workorder/(.*)/# 
```

提供了以下 URI：

```
/workorder/archive/2/ 
```

preg_match() 中的 $matches 变量正在返回`archive/2/`

为什么`/`正则表达式中的最后一个不能阻止`(.*)`贪婪？当找到分隔符时，我应该添加什么来使正则表达式停止`/`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:14:36.940

替换`(.*)`为`(.*?)`使其不贪婪。

这是一个很好的解释：[贪婪和非贪婪匹配](http://docstore.mik.ua/orelly/perl/cookbook/ch06_16.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T19:15:56.367

这会做到的。

```
^/workorder/([^/]*)/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T19:18:16.190

为了使它不贪婪（懒惰）使用

```
^/workorder/(.*?)/ 
```

但这将使用不利于性能的回溯。采用

```
^/workorder/([^/]*)/ 
```

有你的蛋糕，吃得快

# jquery - iOS5 + jquery-mobile 过渡闪烁

> ID：10903433
> 
> 赞同：5
> 
> 时间：2012-06-05T19:13:40.757
> 
> 标签：jquery, ios, html, jquery-mobile

我试图消除在 i​​OS 5 上运行时对 jqmobile 转换的恼人闪烁效果。我尝试了其他帖子（如 -webkit-backface）中的几种方法，并做了一些其他工作，但没有达到完整的解决方案。我观察到在转换之前，由于导航栏从顶部移动一个像素（可能是 2）而重新定位页面时会发生 flickr。问题开始于初始化或重新渲染页面时设备旋转之后，然后我们得到两个可能的工作结果，

1.  在每次转换时都没有闪烁和预期的工作。
2.  落在每个出现描述闪烁的过渡上。

当然，问题是您在新页面呈现时随机获得 1 或 2。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T15:27:10.070

如果你有`data-position="fixed"`那么一个解决方案是使用：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-16T18:33:08.533

*来源：[https ://github.com/jquery/jquery-mobile/issues/4024#issuecomment-5124172](https://github.com/jquery/jquery-mobile/issues/4024#issuecomment-5124172)*

> 而不是 data-position:fixed 到页眉/页脚 - 我将以下 CSS 样式应用于页眉、内容和页脚：

```
.header {
    position : fixed;
    z-index  : 10;
    top      : 0;
    width    : 100%
}
.content {
    padding : 45px 15px
}
.footer {
    position : fixed;
    z-index  : 10;
    bottom   : 0;
    width    : 100%
} 
```

论坛上的几个人在上述链接中表示，这有助于在带有`data-position:fixed`页眉/页脚的页面之间转换时出现闪烁。

Tod Parker（jQuery Mobile 的创建者）的另一个建议是：

```
.ui-mobile-viewport-transitioning .ui-header-fixed,
.ui-mobile-viewport-transitioning .ui-footer-fixed { visibility: hidden; } 
```

在从一页转换到另一页时隐藏固定的页眉/页脚。

*来源：[https ://github.com/jquery/jquery-mobile/issues/4024#issuecomment-5250856](https://github.com/jquery/jquery-mobile/issues/4024#issuecomment-5250856)*

另一个 jQuery Mobile 团队成员也做出了一个提交，应该会在下一个版本中出现。这是帖子：[https](https://github.com/jquery/jquery-mobile/issues/4024#issuecomment-5250856) ://github.com/jquery/jquery-mobile/issues/4024#issuecomment-5250856 （代码有点复杂，在这里发布）

最近，由于此提交，该问题已关闭：[https](https://github.com/Diveboard/jquery-mobile/commit/ff125b65e682ecd33888a6db1221ac441d258994) ://github.com/Diveboard/jquery-mobile/commit/ff125b65e682ecd33888a6db1221ac441d258994 。此修复是在滚动之前`z-index`将传入页面设置为，然后在之后重置。`-10``z-index`

我自己没有尝试过任何这些修复，但它们似乎很有希望。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-16T14:05:24.220

[这里](https://github.com/jquery/jquery-mobile/issues/4024)的方法组合应该可以解决问题......

对于其他有此问题的人，OP 说

> 主要是数据位置、webkit 背面和其他没有提供完整的解决方案，我设置了一个来自 jqmobile 1.0 的自定义 css，发布在你建议的 github 链接上，最后可以工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T12:08:18.163

尝试按照此处指定的方式添加数据转换：[当我们在 Firefox 中从一个 jquery 移动页面更改为另一个页面时显示问题](https://stackoverflow.com/questions/10868493/display-issues-when-we-change-from-one-jquery-mobile-page-to-another-in-firefox)

这是上面答案中的示例：

```
<a href="#page1" data-transition="fade">I am good transition</a>
<a href="#page1">And I am bad</a> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-16T22:27:35.177

对我来说，安装面板中的幻灯片时，我会闪烁和闪烁。即使面板被隐藏，闪烁也很有趣，对我来说发生在可折叠元素上。

我的“解决方案”是将其添加到我的 css 文件中：（根据[http://api.jquerymobile.com/panel/](http://api.jquerymobile.com/panel/)的建议）使用 JQuery Mobile 1.3.1：

```
div {
   -webkit-transform: translate3d(0,0,0);
 } 
```

这听起来很疯狂——但“为我工作”。（是的所有div）

似乎还没有看到副作用。

我已经用 OpenGL 编写了程序，但不知道 -webkit-transform: translate3d(0,0,0); 是什么 会做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-20T06:34:04.757

据我使用 Cordova 2.9 发现的 Android 4.0+ 上的常见问题。和 JQM 1.3： - 即使指定了“无”转换，页面转换也会出现白色闪烁 - 需要双击才能进行导航

在 SGII、摩托罗拉 MC40、TC55 上测试，在所有平台上都有相同的问题。

对页眉、页脚、内容使用自定义样式，删除 data-position="fixed"

使用 JQM 的初始化（注意，将 JS 放在JQM 包含**之前）**

```
.header {
    position : fixed !important;
    z-index  : 10 !important;
    top      : 0 !important;
    width    : 100% !important;
}
.content {
    padding : 55px 15px !important;
}
.footer {
    position : fixed !important;
    z-index  : 10 !important;
    bottom   : 0 !important;
    width    : 100% !important;
}

//use this init

$(document).bind("mobileinit", function()
{
    $.mobile.defaultPageTransition = "fade"; //default, see styles
    $.mobile.transitionFallbacks='none';
    $.mobile.useFastClick = false; //300ms or double tap needed
}); 
```

# regex - 使用 bash 正则表达式将文件的内容插入到另一个文件中

> ID：10903437
> 
> 赞同：1
> 
> 时间：2012-06-05T19:13:50.133
> 
> 标签：regex, bash, shell, command-line, terminal

我有一个带有 jquery 函数调用的 javascript 文件：

```
$.getScript('/scripts/files/file.js'); 
```

我想用该路径上的文件内容替换该行。这是我到目前为止的 bash 脚本：

```
cat public/scripts/old.js | sed -e "s/$\.getScript\('(.)+'\);/$(cat \1)/g"  > public/scripts/new.js 
```

但是，我的正则表达式和记住路径似乎无法正常工作。我得到`cat: 1: No such file or directory` 的好像`cat`是在数字 1 上被调用（这应该是正则表达式的记忆部分）。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:28:09.933

因为您`$()`在双引号内使用，shell 正在解析`cat \1`，剥离反斜杠并尝试运行`cat 1`以将其输出作为参数的一部分传递给 sed。sed 有一个命令 ( `r`) 用于读取文件，但文件名必须是字面的，并且不能是先前 sed 命令的结果（至少在标准 sed 中，也许某些实现提供了这种能力）。 `sed`确实是错误的工具。你可以做一个 awk 解决方案，但它会很脆弱。

这是一个可能的 perl 解决方案（警告：脆弱）：

```
perl -ne 'if( $_ =~ /\$\.getScript\('"'(.*)'"'\)/ ) 
   { system( "cat $1" ) } else {print}' public/scripts/old.js 
```

# list - 如何将列表转换为 Erlang 中的函数参数？

> ID：10903440
> 
> 赞同：4
> 
> 时间：2012-06-05T19:13:55.937
> 
> 标签：list, function, erlang

假设我有一个特定的功能。我想用相应的数字列表来喂它。

显然，如果我有 F/2 函数并列出 L = [1,2]，我就可以这样做：

```
F(hd(L), hd(tl(L))). 
```

但是我怎样才能让它通用呢？我认为，应该有某种从列表到参数的简单转换，但我还不知道。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-05T19:17:02.830

看[`apply/2`](http://www.erlang.org/doc/man/erlang.html)功能。它做你想做的事。

```
> apply( fun (X,Y) -> X+Y end, [1,2]).
3 
```

还有一个`apply/3`也包含该功能的模块：

```
> apply( io, format , [ "~p, ~p", [1,2]]).        
1, 2 
```

# javascript - x ms 后 jQuery 隐藏通知

> ID：10903441
> 
> 赞同：1
> 
> 时间：2012-06-05T19:14:11.913
> 
> 标签：javascript, jquery, settimeout

我在这里找到了警告消息的脚本：[http ://www.red-team-design.com/cool-notification-messages-with-css3-jquery](http://www.red-team-design.com/cool-notification-messages-with-css3-jquery)

在脚本中，它设置为在单击功能后隐藏警告消息

```
 $('.message').click(function(){              
              $(this).animate({top: -$(this).outerHeight()}, 500);
     }); 
```

所以我添加了超时功能，希望在 x 毫秒后关闭它，但是可以说“计时器”在页面加载后立即开始运行。

```
 setTimeout(function(){hideAllMessages()},5000); 
```

我希望每次提交表单并且丢弃消息可见时超时功能都可以工作（我使用隐藏的 iframe 提交表单并且它是用于库存的，因此重复提交将在同一页面上完成）。

我在这里设置了一个**[演示](http://jsfiddle.net/asVAq/9/)** *jsfiddle*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:17:28.547

你想像这样将它添加到你的`showMessage`函数中：

```
function showMessage(type)
{
    $('.'+ type +'-trigger').click(function(){
          hideAllMessages();                  
          $('.'+type).animate({top:"0"}, 500);
          setTimeout(hideAllMessages,3000);     
    });
} 
```

[jsFiddle 演示](http://jsfiddle.net/asVAq/20/)

**编辑：**正如 James Montagne 在评论中所建议的，[`clearTimeout()`](https://developer.mozilla.org/en/DOM/window.clearTimeout)如果用户快速点击，您可以使用它来防止库存超时。

像这样的东西（快速示例，可能尚未准备好生产）：

```
var timeout = null;
function showMessage(type)
{
    $('.'+ type +'-trigger').click(function(){
          hideAllMessages();                  
          $('.'+type).animate({top:"0"}, 500);
          if (timeout) clearTimeout(timeout);
          timeout = setTimeout(hideAllMessages,3000);     
    });
} 
```

[jsFiddle 演示](http://jsfiddle.net/asVAq/23/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:17:05.203

尝试在动画完成后设置超时！

```
 $('.message').click(function(){              
          $(this).animate({top: -$(this).outerHeight()}, 500, function(){
               setTimeout(function(){hideAllMessages()},5000);  
          });
 }); 
```

# java - 将数据按行读取到字符串数组中？

> ID：10903444
> 
> 赞同：0
> 
> 时间：2012-06-05T19:14:18.650
> 
> 标签：java, arrays, string

我需要用户输入 3 个用空格分隔的名称，例如：

```
Please enter 3 names: name1 name2 name3 
```

然后我想将它存储到具有 3 个字符串元素作为这 3 个名称的数组中，如何做到这一点，请**建议我在 java 中使用 STRING 的一些方法，**因为我经常使用 C++，**我不要求代码**，谢谢！

```
String array[] = new String[3];
System.out.print("Please enter 3 names: ");
Scanner in = new Scanner(System.in);
String input = in.nextLine();
//do domething 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:18:24.417

`Scanner`有一个名为的方法`next`，可以为您提供下一个单词* 而不是下一行。这应该是一个足够的提示。

[* 不完全正确。默认分隔符是空格。如果您更改它，您将获得由该特定分隔符分隔的标记。]

* * *

另一种方法：只需通过提供用于拆分的字符来拆分字符串。

```
"hello j and k".split(" ") => { "hello", "j", "and", "k" } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T19:18:49.187

这是一个完美的地方

[`String.split()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-05T19:19:54.773

```
 String array[] = new String[3];
    Scanner in = new Scanner(System.in);
    for (int i = 0; i < 3; i++)
    {
        String input = in.nextLine();
        array[i] = input;
    } 
```

# finder - 在插入 USB 时打开自定义 Finder 窗口

> ID：10903445
> 
> 赞同：1
> 
> 时间：2012-06-05T19:14:18.633
> 
> 标签：finder

我想在插入 USB 驱动器时打开一个自定义查找器窗口，而不激活 Mac 上的任何 AppleScript。我确信这是可能的，因为我有一个来自 VMWare（VMware fusion 应用程序）的 USB，它可以做同样的事情。只要我插入 Fusion 应用程序 USB，它就会打开一个自定义查找器窗口。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T15:37:45.517

你看过这个吗？ [http://jordan.broughs.net/archives/2008/03/creating-cross-platform-windows-and-mac-installer-cds](http://jordan.broughs.net/archives/2008/03/creating-cross-platform-windows-and-mac-installer-cds)

它四舍五入创建自定义 .dmg，然后使用以下命令将其刻录到 USB 密钥，`sudo dd if=~/path/to/image.dmg of=/dev/rdisk{N} bs=1m` 其中 {N} 应替换为您可以查找的正确磁盘号：`diskutil list`

这里的所有都是它的。

# cakephp - CakePHP：afterFind 与关联很奇怪

> ID：10903449
> 
> 赞同：3
> 
> 时间：2012-06-05T19:14:27.033
> 
> 标签：cakephp, associations

所以当我在相应的模型/控制器中时，afterFind 工作得很好。但是，在调用关联模型时，发送到 afterFind 回调的数据格式不同。这会导致 afterFind 出错，因为它无法找到与在原始模型/控制器中工作时相同的数组索引。

任何人都知道为什么，或者修复可能是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T00:08:05.110

`$primary`可能不是很有帮助；我发现它总是`false`在使用 ContainableBehaviour 超出第一个深度时：

```
$this->Model->find('first', array(
  'contain' => array(
    'SecondaryModel' => array(
      'TertiaryModel',
    ),
  ),
)); 
```

如果您要根据相关模型设置值，则可以检查其是否存在以处理如下任一结构：

```
function afterFind($results, $primary) {
  if (isset($results['TertiaryModel'])) {
    $results['secondary_model_field'] = 'value';
  }
  else {
    foreach ($results as &$result) {
      if (is_array($result) && isset($result['TertiaryModel'])) {
        $result[$this->alias]['secondary_model_field'] = 'value';
      }
    } unset($result);
  }

  return $results;
} 
```

或者，您可以只检查模型本身上字段的位置。如果顶层不存在该字段，则需要遍历结果集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:30:59.110

这就是`afterFind`回调的第二个参数的用途。

`$primary`告诉您 find 是直接从此模型调用的（*true*），还是由关联模型调用的（*false*）。

书中的注释：

> $primary 参数指示当前模型是否是发起查询的模型，或者此模型是否作为关联进行查询。如果将模型作为关联进行查询，则 $results 的格式可能会有所不同；
> 
> 如果使用递归查找，则期望 $primary 为 true 的代码可能会从 PHP 中得到“不能将字符串偏移量用作数组”的致命错误。

因此，您可能需要不同的处理逻辑，具体取决于`$primary`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-26T12:49:07.403

Cake 2.6 似乎对此[进行了修复](https://github.com/cakephp/cakephp/pull/4223)，以确保所有`$results`数组的格式一致。我对 RC 版本进行了一些测试，它似乎确实有效，数组都以 format 传递`{n}.ModelName.data`。

默认情况下启用该修复，但如果需要，您也可以恢复到旧行为。只需将以下内容添加到您的模型（或 AppModel）定义中：

```
public $useConsistentAfterFind = false; 
```

# php - Zend Framework 2 如何在模块内渲染部分内容？

> ID：10903451
> 
> 赞同：11
> 
> 时间：2012-06-05T19:14:33.503
> 
> 标签：php, zend-framework2

对于模块内的目录结构，我有类似的东西：

```
Api
├── Module.php
├── config
│   └── module.config.php
├── src
│   └── ( ..etc ..)
└── view
    ├── api
    │   └── api
    │       └── index.phtml
    └── partial
            └── test.phtml 
```

然后，我这样做：

```
<?= $this->partial('partial/test.pthml', array()); ?> 
```

但是，我得到：

> 2012 年 6 月 5 日 14:56:58] PHP 致命错误：未捕获的异常 'Zend\View\Exception\RuntimeException' 带有消息 'Zend\View\Renderer\PhpRenderer::render: Unable to render template "partial/test.pthml "; 解析器无法解析到 /Users/jeff/web/n/vendor/zendframework/zendframework/library/Zend/View/Renderer/PhpRenderer.php:463 中的文件

*我的部分应该*去哪里？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-29T14:44:46.993

这可以通过

```
 echo $this->partial('layout/header', array('vr' => 'zf2')); 
```

您可以使用访问视图中的变量

```
echo $this->vr; 
```

不要忘记在 module.config.php 文件的 view_manager 中添加以下行。

```
'layout/header'           => __DIR__ . '/../view/layout/header.phtml', 
```

添加后看起来像这样

```
return array(  

'view_manager' => array(
        'template_path_stack' => array(
            'user' => __DIR__ . '/../view' ,
        ),
        'display_not_found_reason' => true,
        'display_exceptions'       => true,
        'doctype'                  => 'HTML5',
        'not_found_template'       => 'error/404',
        'exception_template'       => 'error/index',
        'template_map' => array(
            'layout/layout'           => __DIR__ . '/../view/layout/layout.phtml',

            'layout/header'           => __DIR__ . '/../view/layout/header.phtml',            

            'error/404'               => __DIR__ . '/../view/error/404.phtml',
            'error/index'             => __DIR__ . '/../view/error/index.phtml',
        ),

    ),    

); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-05T22:21:55.130

您是否尝试在调用 View Helper partial() 时包含您的模块名称？

[http://packages.zendframework.com/docs/latest/manual/en/zend.view.helpers.html#zend.view.helpers.initial.partial.modules](http://packages.zendframework.com/docs/latest/manual/en/zend.view.helpers.html#zend.view.helpers.initial.partial.modules)

```
<?php echo $this->partial('pager.phtml', 'list', $pagerData) ?> 
```

# c# - C#将类类型作为参数传递

> ID：10903452
> 
> 赞同：5
> 
> 时间：2012-06-05T19:14:33.923
> 
> 标签：c#, oop, interface

这适用于 C#？ [传递类类型作为参数](https://stackoverflow.com/q/8265241/684646)

我有一个实现接口的类适配器。我想用 MyFooClass 实例填充数组结构，我想从外部接收 MyFooClass 的名称或引用。我将在我的适配器代码中实例化它们。

例如：

```
 public void FillWsvcStructs(DataSet ds, ClassType Baz)
    {
        IFoo.Request = ds.DataTable[0].Request;
        IFoo.Modulebq = string.Empty;
        IFoo.Clasific = string.Empty;
        IFoo.Asignadoa = ds.DataTable[0].Referer;
        IFoo.Solicita = "Jean Paul Goitier";

        // Go with sub-Elems (Also "Interfaceated")
        foreach (DataSet.DataTableRow ar in ds.DataTable[1])
        {
            if ((int) ar.StatusOT != (int)Props.StatusOT.NotOT)
            {
                ///From HERE!
                IElemRequest req = new (Baz)(); // I don't know how to do it here
                ///To HERE!

                req.Id = string.Empty;
                req.Type = string.Empty;
                req.Num = string.Empty;
                req.Message = string.Empty;
                req.Trkorr = ar[1];
                TRequest.Add(req);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T19:19:20.653

[我相信泛型](http://msdn.microsoft.com/en-US/library/ms379564.aspx)及其[约束](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)应该做你想做的事：

```
public void FillWsvcStructs<ClassType>(DataSet ds) where ClassType : IElemRequest, new()
{
    IFoo.Request = ds.DataTable[0].Request;
    IFoo.Modulebq = string.Empty;
    IFoo.Clasific = string.Empty;
    IFoo.Asignadoa = ds.DataTable[0].Referer;
    IFoo.Solicita = "Jean Paul Goitier";

    // Go with sub-Elems (Also "Interfaceated")
    foreach (DataSet.DataTableRow ar in ds.DataTable[1])
    {
        if ((int) ar.StatusOT != (int)Props.StatusOT.NotOT)
        {
            IElemRequest req = new ClassType();

            req.Id = string.Empty;
            req.Type = string.Empty;
            req.Num = string.Empty;
            req.Message = string.Empty;
            req.Trkorr = ar[1];
            TRequest.Add(req);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T19:17:51.693

这可能最好通过使用泛型来解决：

```
public void FillWsvcStructs<T>(DataSet ds) where T : IElemRequest, new()
{
   //..
   //new() constraint enables using default constructor     
   IElemRequest req = new T(); 
   //IElemRequest constraint enables using interface properties
   req.Id = string.Empty;
   //..
 } 
```

如果您有多种类型需要能够访问/实例化，则声明遵循相同的规则（可以从 msdn 轻松收集）：

```
public void FillWsvcStructs<T, U, V>() where T : IElemRequest, new() 
                                       where U : IFoo, new()
                                       where V : IBar, new()
{

    //..
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-05T19:18:28.267

我想你想要[泛型](http://msdn.microsoft.com/en-US/library/ms379564%28v=VS.80%29.aspx)。

像这样声明你的方法：

```
public void FillWsvcStructs<T>(DataSet ds)
    where T : IElemRequest, new()
{
    //You can then do
    IElemRequest req = new T();

} 
```

[`new()`](http://msdn.microsoft.com/en-us/library/sd2w2ew5.aspx)约束需要`T`有一个公共的无参数构造函数，并且约束`IElemRequest`确保它实现`IElemRequest`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-05T19:18:02.353

你需要一个[通用](http://msdn.microsoft.com/en-us/library/512aeb7t%28v=vs.100%29.aspx)的：

```
public void FillWsvcStructs<TBaz>(DataSet ds) where TBaz : IElementRequest, new()
{
    // ...
    IElementRequest req = new TBaz();
    // ...
} 
```

泛型约束 (" `where...`") 强制您传入的类型实现`IElementRequest`接口并且它具有无参数构造函数。

假设你有一个`Baz`类似于这样的类：

```
public class Baz : IElementRequest
{
    public Baz()
    {
    }
} 
```

你可以像这样调用这个方法：

```
DataSet ds = new DataSet();
FillWsvcStructs<Baz>(ds); 
```

* * *

### 附录

多个不同的泛型类型参数每个都可以有自己的类型约束：

```
public void FillWsvcStructs<TFoo, TBar, TBaz>(DataSet ds) 
    where TFoo : IFoo, new()
    where TBar : IBar, new()
    where TBaz : IElementRequest, new()
{
    // ...
    IFoo foo = new TFoo();
    IBar bar = new TBar();
    IElementRequest req = new TBaz();
    // ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:20:25.880

您可能想使用[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/wccyzw83.aspx)。

`IElemRequest req = (IElemRequest) Activator.CreateInstance(Baz);`

如果`Baz`表示的类型有一个带参数的构造函数，那么它的复杂性将会增加（因为您必须使用反射或动态调用才能使其工作）。如果`Baz`不代表继承自的类型`IElemRequest`，您将得到一个丑陋的运行时错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T19:21:09.433

方法：

```
public void FillWsvcStructs<T>(DataSet ds) where T : IElemRequest, new() {
    ...
    IElemRequest req = new T();
    ...
} 
```

调用方法：

```
FillWsvcStructs<Bez>(ds); 
```

# macos - 使用 MacRuby 设置通讯簿图像

> ID：10903453
> 
> 赞同：0
> 
> 时间：2012-06-05T19:14:35.903
> 
> 标签：macos, image, addressbook, macruby

我正在尝试使用 MacRuby 设置用户的通讯簿图像。这是我到目前为止所拥有的：

```
framework 'ScriptingBridge'
framework 'AppKit'

download = "/path.png"
data   = NSData.dataWithContentsOfFile(download)
bitmap = NSBitmapImageRep.imageRepWithData(data)
final  = bitmap.representationUsingType(NSTIFFFileType, properties: nil)

book = SBApplication.applicationWithBundleIdentifier("com.apple.addressbook")
book.myCard.setImage(final) 
```

顺便说一句，我也试过`book.myCard.setImage(final.base64Encoding)`了。

我需要做什么才能完成这项工作？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:44:55.890

你必须有一个**NSImage**

```
myImage = NSImage.alloc.initWithContentsOfFile(download)
book = SBApplication.applicationWithBundleIdentifier("com.apple.addressbook")
book.myCard.setImage(myImage) 
```

# php - 注意（8）：未定义索引：id

> ID：10903456
> 
> 赞同：0
> 
> 时间：2012-06-05T19:15:01.053
> 
> 标签：php, html, arrays, indexing, echo

我正在尝试使视图正常工作。我的模型是：

```
class LocalClock extends AppModel 
{
    public $useDbConfig = 'default';
    public $useTable = 'local_clocks';
    //public $useTable = false;
public function setStatType( $type )
{
    //$this->table = 'local_clocks';
    $this->_schema = array(
        'col1' => array('type' => 'int')
        ,'col2' => array('type' => 'string')
        ,'col3' => array('type' => 'string')
        ,'col4' => array('type' => 'string')
        ,'col5' => array('type' => 'string')
        ,'col6' => array('type' => 'string')
        ,'col7' => array('type' => 'string')
        ,'col8' => array('type' => 'string')
        ,'col9' => array('type' => 'string')
        ,'col10' => array('type' => 'string')
        ,'col11' => array('type' => 'string')
        ,'col12' => array('type' => 'string')
        ,'col13' => array('type' => 'string')
        ,'col14' => array('type' => 'string')
    );   
} 
```

}

控制器是这样的：

```
class LocalClocksController extends AppController 
{
    public $scaffold = 'admin';     // allow basic view/edit for administrators
    public $components = array('RequestHandler');   // enable checking for incoming request attributes

   public $helpers = array('Html', 'Form');
public function index() 
{
if ($this->RequestHandler->accepts('xml'))
{
    $this->LocalClock->table = 'local_clocks';
    $this->LocalClock->getDataSource()->tableFields['local_clocks'] = array( "id", "name", "auto_offset", "utc_offset_sec", "in_month", "in_week", "in_day", "in_hour", "out_month", "out_week", "out_day", "out_hour", "offset_sec");
        // xml handler
    $this->set('localClocks', $this->LocalClock->find('all'));
    $this->set('_serialize', array('local_clocks'));
    }
    elseif ($this->RequestHandler->accepts('json'))
    {
    $this->LocalClock->getDataSource()->tableFields['local_clocks'] = array( "id", "name", "auto_offset", "utc_offset_sec", "in_month", "in_week", "in_day", "in_hour", "out_month", "out_week", "out_day", "out_hour", "offset_sec");
        $this->set('localClocks', $this->LocalClock->find('all'));
        $this->set('_serialize', array('local_clocks'));
    }
elseif( $this->RequestHandler->accepts('html'))
{
    $this->LocalClock->table = 'local_clocks';
    $this->LocalClock->getDataSource()->tableFields['local_clocks'] = array( "id", "name", "auto_offset", "utc_offset_sec", "in_month", "in_week", "in_day", "in_hour", "out_month", "out_week", "out_day", "out_hour", "offset_sec");
        $this->set('localClocks', $this->LocalClock->find('all'));
}       
} 
```

}

这是观点：

```
<p><marquee><u>Local Clocks</u></marquee></p>

<table>
<thead><tr>
<th>Id</th>
<th>Name</th>
<th>Auto Offset</th>
<th>UTC Offset Sec</th>
<th>In Month</th>
<th>In Week</th>
<th>In Day</th>
<th>In Hour</th>
<th>Out Month</th>
<th>Out Week</th>
<th>Out Day</th>
<th>Out Hour</th>
<th>Offset Sec</th>
<th>Actions</th>
</tr></thead>
<tbody>

<?php 
foreach($localClocks as $LocalClock) { ?>

<tr>
<td><?php echo $LocalClock['id']; ?></td>

<td><input type="button" value="View"/><input type="button" value="Edit"/><input type="button" value="Delete"/></td>
</tr>

<?php } ?>

</tbody>
</table>
<?php debug($LocalClock); ?> 
```

我收到“通知 (8): Undefined index: id [APP/View/LocalClocks/index.ctp, line 37]”错误

这是 debug($LocalClock) 的输出（视图文件中 foreach 循环的 LocalClock

```
array(
    'LocalClock' => array(
        'id' => '4',
        'name' => 'New Test Clock',
        'auto_offset' => false,
        'utc_offset_sec' => '9',
        'in_month' => '8',
        'in_week' => '7',
        'in_day' => '6',
        'in_hour' => '5',
        'out_month' => '4',
        'out_week' => '3',
        'out_day' => '2',
        'out_hour' => '1',
        'offset_sec' => '0'
    )
) 
```

有关如何正确显示 id 的任何帮助都会很棒。我还尝试显示其他属性，如自动偏移、utc_offset_sec、in_month 等，但为简单起见，我将这些属性排除在视图文件之外。

另外，在顶部的模型文件中，我真的需要函数 setStateType($type) 吗？如果我确实需要这个函数，那么 $this->_schema = array() 代码呢，我是否也需要它。

我正在使用 cakephp，我对此并不陌生。此外，我拥有的代码来自我正在从事的同一个大项目的不同部分。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:16:02.283

像这样：

```
$LocalClock['LocalClock']['id']; 
```

IIRC，cakephp 将模型名称作为数组中的第一个元素，因此您需要先访问`LocalClock`。

您的调试显示了这一点：

```
array(
    'LocalClock' => array(
//This One ^
        'id' => '4',
        'name' => 'New Test Clock',
        'auto_offset' => false,
        'utc_offset_sec' => '9',
        'in_month' => '8',
        'in_week' => '7',
        'in_day' => '6',
        'in_hour' => '5',
        'out_month' => '4',
        'out_week' => '3',
        'out_day' => '2',
        'out_hour' => '1',
        'offset_sec' => '0'
    )
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:18:57.880

您可以将视图更改为：

```
<p><marquee><u>Local Clocks</u></marquee></p>

<table>
<thead><tr>
<th>Id</th>
<th>Name</th>
<th>Auto Offset</th>
<th>UTC Offset Sec</th>
<th>In Month</th>
<th>In Week</th>
<th>In Day</th>
<th>In Hour</th>
<th>Out Month</th>
<th>Out Week</th>
<th>Out Day</th>
<th>Out Hour</th>
<th>Offset Sec</th>
<th>Actions</th>
</tr></thead>
<tbody>

<?php 
foreach($localClocks as $LocalClock) { 
extract($LocalClock);
?>

<tr>
    <td><?php echo $LocalClock['id']; ?></td>

    <td><input type="button" value="View"/><input type="button" value="Edit"/><input type="button" value="Delete"/></td>
</tr>

<?php } ?>

</tbody>
</table>
<?php debug($LocalClock); ?> 
```

此方法使用提取，它从数组键/值中分配变量。这不是最理想的，但会起作用。

# php - 如何扩展 PHP

> ID：10903458
> 
> 赞同：10
> 
> 时间：2012-06-05T19:15:16.490
> 
> 标签：php, scalability

我正在用 PHP 创建一个新的 Web 应用程序，我想以一种随着时间的推移可以很好地扩展的方式来创建它。

我应该或不应该做什么？我知道我应该缓存，但我应该缓存什么以及如何缓存？我还能做些什么来让网站保持快速加载？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-05T19:15:17.347

*注意：这不是我写的，而是[YC 新闻的 Snorkel写的](http://news.ycombinator.com/item?id=4070126)*

这是一个简短的列表：

1.  **在边缘**缓存输出**`Varnish`：使用或其他反向代理缓存。**
***   **缓存字节码**：使用`APC`或`XCache`PHP 操作码缓存。*   **缓存和最小化数据库 I/O**`memcached` ：使用、`redis`、 文件缓存和应用程序级缓存（即全局变量）减少数据库接触*   **在本地文件中记录事件**，而不是在数据库中：使所有写入操作尽可能简单和快速，任何实时不需要的数据都可以写入普通的旧文件并稍后处理。*   **使用 CDN**，尤其是用于交付静态资产*   **服务器调优**: `Apache`, `MySQL`, 并且`Linux`有很多影响性能的设置，尤其是超时设置应该被调低。*   **识别瓶颈**：在系统级别使用工具，如，，，，`strace`和查询日志来查看哪个层使用最多的时间和资源`top``iostat``vmstat`*   **负载测试**：DoS 自己。对您的堆栈进行压力测试以发现瓶颈并将其排除在外*   **删除未使用的模块**：对于堆栈中的每个组件，卸载不需要提供服务的任何默认模块。*   **不要使用 ORM**和其他虚拟抽象：放下训练轮并编写自己的查询。*   **使入口页面快速**、简单且可缓存。没有人在阅读您首页底部角落的那个愚蠢的新闻提要，它正在扼杀您的数据库，所以把它拿出来。**

 **大多数情况下，PHP 速度变慢是因为每个 PHP 进程都被阻止等待来自其他层的 I/O，无论是慢速磁盘，还是过载的数据库，或者挂起的 memcached 进程，或者对 3rd 方服务的缓慢 REST API 调用...... . 通常只是 strace'ing 一个实时的 PHP 进程会告诉你它在等待什么......简而言之，阻塞 I/O 会减慢一切。跑得更快的关键是：

### - 把事情简单化

### - 尽可能多地缓存在本地内存中

### - 每个请求尽可能少地执行阻塞 I/O 操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T20:10:12.120

扩展到多个前端还需要复制您网站的根目录及其动态内容。

GlusterFS 是一个不错的补充，但我不清楚它的扩展能力如何。另一种选择是 Lsyncd。其他替代方案可能包括用于代码的 GIT 和用于动态内容的 CDN。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:45:41.923

您应该添加：使用 gzip 压缩输出。**

# android - layout-land 中定义的 xml 布局不会出现在 android 应用程序中

> ID：10903460
> 
> 赞同：8
> 
> 时间：2012-06-05T19:15:20.180
> 
> 标签：android, android-layout

我正在根据[这个例子](http://www.androidhive.info/2012/05/android-rss-reader-application-using-sqlite-part-1/)开发一个应用程序。我在 layout-land 文件夹中为 header.xml 定义了横向布局，但是当我将方向更改为横向时，定义的布局不会出现在屏幕中。

知道为什么吗？

谢谢

更新 ：

活动代码：

```
public class ACENewsFeedActivity extends ListActivity {

    // Progress Dialog
    private ProgressDialog pDialog;

    // Array list for list view
    ArrayList<HashMap<String, String>> rssItemList = new ArrayList<HashMap<String,String>>();

    RSSParser rssParser = new RSSParser();

    List<RSSItem> rssItems = new ArrayList<RSSItem>();

    RssFeed rssFeed;

    private static String TAG_TITLE = "title";
    private static String TAG_LINK = "link";
    private static String TAG_DESRIPTION = "description";
    private static String TAG_PUB_DATE = "pubDate";
    //private static String TAG_GUID = "guid"; // not used

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.rss_item_list);

        /**
         * Calling a backgroung thread will loads recent articles of a website
         * @param rss url of website
         * */
        new loadRSSFeedItems().execute();
       }

       ....
} 
```

横向模式下的 XML 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layoutHeader"
    android:layout_width="fill_parent"
    android:layout_height="50dip"
    android:layout_alignParentTop="true"
    android:background="@layout/header_gradient"
    android:orientation="horizontal">

    <!-- Logo -->

    <!-- Refresh -->

    <!-- Plus Button -->

    <ImageButton
        android:id="@+id/btnAddSite"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_marginRight="5dip"
        android:background="@null"
        android:src="@drawable/plus"
        android:layout_centerVertical="true" />

    <ImageView
        android:id="@+id/logo"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:src="@drawable/logo" />

    <ImageView
        android:id="@+id/refreshList"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:src="@drawable/refresh" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-05T19:41:04.440

Android 允许您提供不同版本的资源文件以支持特定的设备配置，包括屏幕尺寸/分辨率和（如您所愿）设备方向。当 android 加载布局文件时，它会首先在`res/layout-port`文件夹中查找（如果它是纵向的）或`res/layout-land`文件夹中（如果它是横向的）。如果找不到该文件，它将在常规`res/layout`文件夹中查找。

此外，正如[这里](http://developer.android.com/guide/topics/resources/runtime-changes.html)所指出的，当某些设备配置在运行时发生变化（如设备方向）时，android 将通过保存状态、销毁它，然后使用保存的状态信息启动它来重新启动当前正在运行的任何进程。这允许它再次加载布局文件，当它尝试加载它们时，它将查找新方向的文件夹。

因此，如果您以纵向方式启动应用程序，它会将文件加载到`res/layout-port`或`res/layout`. 如果您随后将设备旋转到横向，它将破坏您的进程并重新启动。但是，这一次它将是横向的，因此它将检查`res/layout-land`布局文件。

如果您以这种方式设置文件，但它没有按您认为的那样运行，我首先通过将两个不同的`header.xml`文件放在`layout-land`和`layout-port`文件夹中来验证它肯定没有使用正确的文件，也许一个带有红色背景和一个绿色背景。确保仔细检查文件引用，并可能使用 Toast 在屏幕上发布一些调试信息，以确保它正确地膨胀布局。

默认行为是让 android 处理方向更改（这涉及破坏您的活动并创建它的新实例，该实例将重新加载所有布局文件）。除非清单文件中的活动标签包含属性 android:configChanges="orientation"，否则此默认行为将始终发生。（此标签可以接受除方向以外的参数 - android 将处理所有事件的配置更改，除了您作为参数传递给此标签的事件。）

如果您包含`android:configChanges="orientation"`标签，则告诉 android 不要破坏您的活动，并且不要在设备方向更改时重新加载布局文件。而不是它的默认行为，它将调用一个方法（您定义），以允许您进行任何您希望自己处理方向更改的更改，而不是让 android 自动处理它。这样做的目的是，如果销毁您的活动会带来很大的不便，则不必自动销毁它。

编辑：从评论讨论中添加了一些东西

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-25T14:53:18.240

您应该`android:configChanges="orientation"`在该活动的`manifest`文件中定义并覆盖其中的`onConfigChanged()`方法`setContentView()`

像这样：

```
@Override    
public void onConfigurationChanged(Configuration newConfig) {
    setContentView(R.layout.your_xml);

    super.onConfigurationChanged(newConfig);
} 
```

# symfony - symfony2 表单错误

> ID：10903461
> 
> 赞同：3
> 
> 时间：2012-06-05T19:15:20.373
> 
> 标签：symfony, symfony-forms

```
The form's view data is expected to be of type scalar, array or an instance of \ArrayAccess, 
but is an instance of class Ecs\CrmBundle\Entity\Customer. 
```

我在浏览器中遇到的错误..

表格代码：

```
<?php

namespace Ecs\CrmBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;

class CustomerDefaultConfigType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('name')
            ->add('customerStatus')
            ->add('tags', null, array('multiple' => true, 'property' => 'tag_name'))
        ;
    }

    public function getName()
    {
        return 'ecs_crmbundle_customerdefaultconfigtype';
    }
} 
```

和控制器动作：

```
<?php

namespace Ecs\CrmBundle\Controller;

use Ecs\CrmBundle\Entity\CustomerDefaultConfig;
use Ecs\CrmBundle\Form\CustomerDefaultConfigType;
    public function newAction()
        {
            $entity = new CustomerDefaultConfig();
            $form   = $this->createForm(new CustomerDefaultConfigType(), $entity);

            return $this->render('EcsCrmBundle:CustomerDefaultConfig:new.html.twig', array(
                'entity' => $entity,
                'form'   => $form->createView()
            ));
        } 
```

这是使用 symfony2.1 和作曲家......关于如何让它工作的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T19:36:15.613

自上次表单重构以来，您必须在类型`data_class`的`setDefaultOptions`方法中指定。

请参见[此处](https://github.com/symfony/symfony/blob/master/UPGRADE-2.1.md)（搜索`data_class`）。

编辑：正确的链接

# php - SimpleXMLElement 对象返回 XML

> ID：10903463
> 
> 赞同：4
> 
> 时间：2012-06-05T19:15:27.510
> 
> 标签：php, xml, simplexml

假设您从 API 调用中获得以下响应：

```
[OrderArray] => SimpleXMLElement Object
    (
        [Order] => Array
            (
                [0] => SimpleXMLElement Object
                    (
                        [OrderID] => etc...etc..<br> 
```

如何将其转换回格式良好的 XML，以便我可以将每个订单数组保存到它们自己的单独文件中？（请不要问我为什么要执行这个看似徒劳的任务。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:22:23.017

$sxml 是一个简单的XMLElement

```
$doc = new DOMDocument();
$doc->formatOutput = TRUE;
$doc->loadXML($sxml->asXML());
$xml = $doc->saveXML(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:18:33.237

如果你有一个 SimpleXMLElement 对象，你可以使用 asXML 方法来获取一个 XML 字符串： [http ://us2.php.net/manual/en/simplexmlelement.asxml.php](http://us2.php.net/manual/en/simplexmlelement.asxml.php)

# arrays - 向 CSV 文件添加新行时可以使用数组元素吗？

> ID：10903472
> 
> 赞同：3
> 
> 时间：2012-06-05T19:16:00.157
> 
> 标签：arrays, perl, csv

我正在编写一个 Perl 脚本并使用[Class::CSV](http://search.cpan.org/~djr/Class-CSV-1.02/CSV.pm)模块。我有一个数字数组，5个元素长

```
$values[0] - $values[4] 
```

我正在尝试向 CSV 文件添加新行并使用数组中的值填充新行。但是，当我尝试运行脚本时，我不断收到此错误：

```
 Failed to create CSV line from line:
 10252205 
 at /usr/lib/perl5/site_perl/5.8.8/Class/CSV.pm line 257
    Class::CSV::Line::string('Class::CSV::Line=HASH(0x1f2d0f20)') called at /usr/lib/perl5/site_perl/5.8.8/Class/CSV.pm line 435
    Class::CSV::string('Class::CSV=HASH(0x1f2c1c00)') called at catchmailstats.pl line 116 
```

这是 CSV 构造的代码：

```
# Create csv file from the current data
  my $csv = Class::CSV->new(
  fields  => [qw/Month NotSpam Probable Quarantine Spam Total/],
  );

# Creates the first row (Headers)
$csv->add_line({
  Month   => 'Month',
  NotSpam => 'NotSpam',
  Probable => 'Probable',
  Quarantine => 'Quarantine',
  Spam => 'Spam',
  Total => 'Total'
});

# Creates the second row (values)
$csv->add_line([$values[0], $values[1],$values[2],$values[3],$values[4], $total]); 
```

我也尝试过使用其他符号样式：

```
# Creates the second row (values)
$csv->add_line({
  Month   => $values[0],
  NotSpam => $values[1],
  Probable => $values[2],
  Quarantine => $values[3],
  Spam => $values[4],
  Total => $total
}); 
```

两种风格都没有奏效。不过，这是我注意到的一些事情。最后一个变量 $total 是 $values[1] 到 $values[4] 的总和。这个变量可以正常工作。

所以我真正的问题是：为什么对我的数组中的元素的引用不起作用，而是来自同一个数组的元素的总和，编译没有问题？我怎样才能让 add_line 函数接受我的数组元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:21:43.187

我认为在您的价值观列表中，有一个`HASH REF`需要取消引用。

`Data::Dumper`在您的代码中使用：

```
use Data::Dumper;
print Dumper @values; 
```

并发布输出，我们将看到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-31T07:59:36.097

我有这个错误只是因为我在 add_line 中的一个值中有一个换行符。

以下是如何处理值中的换行符[http://search.cpan.org/~hmbrand/Text-CSV_XS-1.18/CSV_XS.pm#Embedded_newlines](http://search.cpan.org/~hmbrand/Text-CSV_XS-1.18/CSV_XS.pm#Embedded_newlines)

# java - java.lang.ClassNotFoundException：org.postgresql.Driver，Android

> ID：10903481
> 
> 赞同：21
> 
> 时间：2012-06-05T19:16:39.867
> 
> 标签：java, android, postgresql, classnotfoundexception

我在 Windows 上运行 Eclipse。

按照[本教程](http://www.slideshare.net/markwkm/andoird-postgresql)，我下载了 JDBC4，使用 Project>Properties>add External JAR 将其添加到我的构建路径中，浏览了文件，它工作（`.classpath`文件显示了正确的 lib 路径）。

该包出现在我的 Referenced Libraries 文件夹中，因此我继续本教程。

```
 import java.sql.Connection;
    import java.sql.DriverManager;
    import java.sql.PreparedStatement;
    import java.sql.SQLException;

    ....

    public void open ()
        {
    try {
        Class.forName("org.postgresql.Driver");
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }

    try {
        conn = DriverManager.getConnection(url, username, password);
    } catch (SQLException e) {
        e.printStackTrace();
    }
} 
```

我认为它会像那样简单，但是我被这个长长的堆栈跟踪击中了

```
 java.lang.ClassNotFoundException: org.postgresql.Driver 
```

（如果需要我可以提供更多）

我试过`include org.postgresql.*;`了，但这也没有帮助。我也尝试过 JDBC3，但也没有运气。

我查看了[带有 Android 的 Driver JDBC PostgreSQL，](https://stackoverflow.com/questions/10435609/driver-jdbc-postgresql-with-android)它提供了一个模糊的答案，说我最好只使用 HTTP+JSON。我从未使用过。

我对 Android、postgresql、Web 开发是全新的，所以一个简单的答案将不胜感激。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-06-08T20:43:30.323

您需要在项目中添加 PostgreSQL JDBC 驱动程序，如[search.maven.org](https://search.maven.org/artifact/org.postgresql/postgresql)中所述。

**摇篮**：

```
implementation 'org.postgresql:postgresql:42.2.10' 
```

**马文**：

```
<dependency>
  <groupId>org.postgresql</groupId>
  <artifactId>postgresql</artifactId>
  <version>42.2.10</version>
</dependency> 
```

您还可以[下载](https://jdbc.postgresql.org/download.html)**JAR**并手动导入到您的项目中。

注意：不推荐使用此答案中使用的编译。替换为按照[3](https://developer.android.com/studio/build/dependencies?utm_source=android-studio#dependency_configurations)的实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-17T09:44:46.883

将jar包放入lib文件夹（WebContent-WEB-INF-lib），右键jar包-构建路径-添加构建路径

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:23:31.413

It's a CLASSPATH issue; the PostgreSQL JDBC driver isn't available when the class loader tries to load it. You need to add it to your CLASSPATH correctly.

If it works in Eclipse, it's because adding a JAR to the build path *is* adding it to the CLASSPATH. You have to understand how CLASSPATH works without the Eclipse training wheels to help you.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-14T14:32:29.673

下载 JDBC JAR 文件并将其添加到您正在使用的工具的构建路径中可能是一个临时解决方案，因为在我的情况下，上述解决方案都没有解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-10T12:38:15.293

在我对项目进行一些开发之前，我的 postgresql 驱动程序运行良好：添加了一些新文件，包括映射器文件，因为我使用了 Spring 和 MyBatis。突然，当我尝试在服务器--tomcat 上运行它时--我得到了无法加载org.postgresql.Driver 的错误。

我的情况的解决方案：重新启动 Eclipse。也许在某些方面，Eclipse 与驱动程序失去了联系。所以需要通过重启来刷新它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-13T12:02:30.673

我遇到了同样的问题；但我犯的错误是我只在插件部分添加了 postgre 依赖项；将 postgre 依赖项（以下）添加到项目依赖项部分后，它就可以工作了。

```
<dependency>
<groupId>postgresql</groupId>
<artifactId>postgresql</artifactId>
<version>9.1-901-1.jdbc4</version>    
</dependency> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-14T19:14:00.707

我为gradel尝试了一百万件事，我只需要将这一行添加到build.gradel文件中。

```
dependencies {
    compile group: 'org.postgresql', name: 'postgresql', version: '42.2.1'
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2014-02-16T15:03:13.513

假设您的依赖项已正确配置（请参阅[`libs`Android SDK 版本 17 或更高版本中的目录](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)，如评论中所指出的），您应该能够通过在驱动程序管理器中显式注册 9.2 驱动程序来使其工作。

代替：

```
Class.forName("org.postgresql.Driver"); 
```

利用：

```
DriverManager.register(new org.postgresql.Driver()); 
```

（我也尝试过使用 9.3-1100-jdbc41 jar，但这不起作用。）

请注意，正如[Craig Ringer 在对重复问题的回答中](https://stackoverflow.com/a/10441565/372643)所解释的那样，在Android 中使用 JDBC 并不是一个好主意，因为 JDBC 连接不太适合 Android 设备通常使用的网络使用模式。

# android - android - 如何在android中获取网页的html代码？

> ID：10903482
> 
> 赞同：3
> 
> 时间：2012-06-05T19:16:44.960
> 
> 标签：android

我想在android中获取网页的html代码。网页 url 将在编辑文本框中给出，然后当用户单击按钮时，文本视图将显示该网页的代码。请解释并给出代码！

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:33:35.490

```
HttpClient client = new DefaultHttpClient();
HttpGet request = new HttpGet(url);
HttpResponse response = client.execute(request);

String html = "";
InputStream in = response.getEntity().getContent();
BufferedReader reader = new BufferedReader(new InputStreamReader(in));
StringBuilder str = new StringBuilder();
String line = null;
while((line = reader.readLine()) != null)
{
    str.append(line);
}
in.close();
html = str.toString(); 
```

不要忘记在 AndroidManifest 中添加互联网权限：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

您可以参考这些链接以获得更多帮助：

[http://lexandera.com/2009/01/extracting-html-from-a-webview/](http://lexandera.com/2009/01/extracting-html-from-a-webview/)

[是否可以从 WebView 获取 HTML 代码](https://stackoverflow.com/questions/3479833/is-it-possible-to-get-the-html-code-from-webview)

[如何从android中的html链接获取页面的html源？](https://stackoverflow.com/questions/2423498/how-to-get-the-html-source-of-a-page-from-a-html-link-in-android)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:36:13.493

你需要一个`HttpClient`来执行一个`HttpGet`请求。然后您可以阅读该请求的内容。

这个片段给你一个`InputStream`：

```
 public static InputStream getInputStreamFromUrl(String url) {
  InputStream content = null;
  try {
    HttpClient httpclient = new DefaultHttpClient();
    HttpResponse response = httpclient.execute(new HttpGet(url));
    content = response.getEntity().getContent();
  } catch (Exception e) {
    Log.e("[GET REQUEST]", "Network exception", e);
  }
    return content;
} 
```

这个方法返回`String`：

```
// Fast Implementation
private StringBuilder inputStreamToString(InputStream is) {
    String line = "";
    StringBuilder total = new StringBuilder();

    // Wrap a BufferedReader around the InputStream
    BufferedReader rd = new BufferedReader(new InputStreamReader(is));

    // Read response until the end
    while ((line = rd.readLine()) != null) { 
        total.append(line); 
    }

    // Return full string
    return total;
} 
```

来源：[http](http://www.androidsnippets.com/executing-a-http-get-request-with-httpclient) ://www.androidsnippets.com/executing-a-http-get-request-with-httpclient和[http://www.androidsnippets.com/get-the-content-from-a-httpresponse-or-任何输入流作为字符串](http://www.androidsnippets.com/get-the-content-from-a-httpresponse-or-any-inputstream-as-a-string)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-05T19:59:47.837

使用上面的代码，并将其设置为这样的文本视图：

```
InputStream is =InputStream getInputStreamFromUrl("http://google.com");
String htmlText = inputStreamToString(is);

mTextView.setText(Html.fromHtml(htmlText)); 
```

但在单独的线程/异步任务中执行网络请求:)

# c++ - 自由函数的c++源代码组织

> ID：10903486
> 
> 赞同：5
> 
> 时间：2012-06-05T19:16:55.300
> 
> 标签：c++

我想开始更喜欢免费（非成员）函数而不是成员函数 - 遵循这篇文章[http://www.drdobbs.com/184401197](http://www.drdobbs.com/184401197)

我习惯于以这种方式组织我的 C++ 类，我有`ClassName.h`声明和`ClassName.C`实现。

```
ClassName.h :

struct ClassName { 
    ClassName();
    void setData( unsigned data );
}; 
```

然后实现

```
ClassName.C :

#include "ClassName.h"

ClassName::ClassName() { dosomething(); };
void setData( unsigned data ) { dootherthings(); }; 
```

那么当我想要一个免费的功能时如何组织我的代码`adjustClassData()`呢？我也想把这个函数放到命名空间中。

假设`ClassName`是 in `namespace foo`，那么我也会将 free 函数放入`namespace foo`：

```
namespace foo {
    void adjustClassData( ClassName & inObj );
} 
```

我正在寻找`namespace`文件名的方面和建议。

我正在寻找一些最佳实践——因为在规定文件组织的标准中没有 C++ 规则。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T19:21:43.750

如果没有太多，您可以将处理特定类的自由函数放在类头和实现文件中。

否则，提出一个命名约定并将它们放在一个单独的头文件和实现文件中（例如 ClassNameFunctions.h/.cpp）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:24:07.650

如果您想用自由函数替换成员函数，我假设这些自由函数与相关类密切相关。在这种情况下，它们不应该公开。我会使用匿名内部命名空间：

```
//myclass.h
namespace myNamespace
{
   class MyClass
   { 
      void foo();
   };
}

//myclass.cpp
#include "myclass.h"
namespace myNamespace
{
   namespace
   {
      void helper() {};
   }
   void MyClass::foo()
   {
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-30T10:14:43.380

我建议将自由函数的声明放在单独的标题中，因为它们不是类本身的一部分，但是我会将所有函数放在同一个命名空间中。

```
//Bar.h
namespace foo{
class Bar{}
} 
```

在声明自由函数的标题中，我将对类本身使用前向声明。

```
//BarHelper.hpp
namespace foo{
class Bar;
void somefunc(&Bar);
} 
```

像往常一样在单独的文件中实施。

现在我正在浏览大量的头文件，其中通常混合了几个类和自由函数的声明和定义。这是一个真正的痛苦。

所以亲吻；）

# git - 如何使用不同的 pathdef 同时运行两个 MATLAB 实例？

> ID：10903487
> 
> 赞同：3
> 
> 时间：2012-06-05T19:16:58.163
> 
> 标签：git, path, git-clone, matlab

我正在开发自己的在 MATLAB 和 SPM8 下运行的大脑成像工具箱，同时我有一个`git clone`用于运行分析的我自己的工具箱代码目录（本地 git 存储库）的 d 版本，此设置是根据 Kevin Reid 的回答[如何使用 git 同时处理多个不同版本的文件？](https://stackoverflow.com/questions/10665752/how-to-work-simultaneously-on-several-different-versions-of-files-with-git)，它解决了部分问题（如何同时`.m`访问同一文件的不同版本，并且仍然可以使用`git fetch`or进行同步`git pull`）。

但是，我的 MATLAB 安装不在这两个 git 目录中；它正常安装在`/usr/local/MATLAB/R2012a/`. MATLAB 根据 查找函数，该函数作为常规函数`pathdef.m`存储在`which pathdef`( ) 中。`/usr/local/MATLAB/R2012a/toolbox/local/pathdef.m`所以我不能同时运行两个 MATLAB 实例，这样它们就有不同`pathdef`的 's，至少不是通过修改`pathdef.m`file.

当然，MATLAB 必须事先知道在哪里寻找`pathdef.m`来定义路径。有没有办法改变`pathdef.m`查找路径，例如。通过一些 MATLAB 命令行参数或从 MATLAB 控制台？或者通过其他方式，这样我就可以让两个 MATLAB 实例同时运行不同`pathdef`的 's？还是应该将 MATLAB 安装在两个不同的目录中？我对这个问题的各种解决方案感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T20:08:47.987

让我提供一种替代方法。它涉及在 MATLAB IDE 中创建[快捷方式。](http://www.mathworks.com/help/matlab/matlab_env/create-matlab-shortcuts-to-rerun-commands.html)

只需创建两个快捷方式，每个快捷方式都包括以下内容：

```
addpath(genpath('/path/to/project_branch'))   %// add branch (and subfolders) to MATLAB path
cd('/path/to/project_branch')                 %// navigate to directory 
```

*（说明：调用[`addpath`](http://www.mathworks.com/help/matlab/ref/addpath.html)不会在系统范围内保存更改，但只会在当前会话中持续存在，除非您调用[`savepath`](http://www.mathworks.com/help/matlab/ref/savepath.html)）*

现在，每当您开始一个新的 MATLAB 会话并决定在一个或另一个分支上工作时，只需单击相应的快捷方式并开始破解...

更好的是，如果您认为一个分支是*稳定*的，另一个是*dev*，您可以将稳定的分支永久添加到路径中，并`addpath('...','-begin')`使用快捷方式有选择地在路径顶部添加开发版本，从而为另一个分支遮蔽仅限当前会话。

![截屏](../Images/7713194c7f19491896716bf584fec60a.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T19:21:35.807

就在这里。在启动 matlab 之前设置环境变量 MATLABPATH（从终端）

```
export MATLABPATH=/yourdir 
```

# .net - Google 是否有可以添加到 Visual Studio 中的程序集引用或 dll？

> ID：10903494
> 
> 赞同：0
> 
> 时间：2012-06-05T19:17:26.990
> 
> 标签：.net, google-chrome, .net-assembly

我搜索并搜索了一下，但似乎无法找到这个......有谁知道谷歌是否有这个可供下载用于 c# 开发？我不想使用 Visual Studio 附带的库存 webbrowser 组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:43:56.570

WebKit .Net 提供了一个用 C# 编写的 WebKit 库。Chrome 使用 WebKit。 [http://sourceforge.net/projects/webkitdotnet/](http://sourceforge.net/projects/webkitdotnet/)

这是一个相关的 Stack Overflow 线程 - [Google chrome control for .net](https://stackoverflow.com/questions/1534843/google-chrome-control-for-net)

# c - 从文本中获取数据到数组中

> ID：10903496
> 
> 赞同：0
> 
> 时间：2012-06-05T19:17:30.647
> 
> 标签：c, scanf

我有作业，从文本文件中获取电话号码，并将其放入数组中......这是我写的，虽然它没有放在上面......只要有文本在循环就是.txt 文件，将其读入数组...

```
void get_phones(int *phones)
{
    FILE *fp;
    fp = fopen("phones.txt", "rt");
    if (fp == NULL)
    {
        printf ("Error\n");
    }
    else
    {
        while (fscanf(fp, "%d\n", &phones) > 0)
        {
            fscanf(fp, "%d\n", &phones);
        }
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:35:24.583

只是为了添加其他答案，您应该使用`long unsigned`而不是`int`（我假设电话号码类似于 5195551234 - 这对于 来说太大了`int`）。

如果您知道文件中电话号码的最大数量，则可以为数组预先分配空间，如下所示：

```
long unsigned phones[1024]; 
```

在这种情况下，我假设最大数量为 1024。`malloc`如果您不知道最大数量，您也可以使用动态分配内存（有关详细信息，请参阅手册页）。

您的函数`get_phones`可能还应该返回您读取的电话号码的数量（这与您的 while 循环的逻辑不正确这一事实有关）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:55:15.410

**最新更新：** 为了测试：
请将以下代码放入您的文件中`main()`，并将数字 10 更改为文件中的行数。要自动计算上限，您可以尝试更改 to 的返回类型`get_phones`并`int`在 while 循环中放置一个计数器。

```
int i=0;
for(i=0;i<10;i++){
   printf("%lld\n",*(phones+i));
} 
```

**您需要尊重一个指针才能打印实际值。否则，您将打印存储在指针中的地址。**并且`phones`，除了是数组的名称外，它本质上还是**指向数组中第一个元素的指针。**有关指针和数组的更多信息，请参阅[本教程](http://pw1.netcom.com/~tjensen/ptr/ch2x.htm)。

**假设您使用的是 32 位机器**
我在文本文件中输入的电话号码如下：
22121222345
678139199
111111111

*请注意，22,121,222,345>=2,147,483,647，*这是一个 int 可以表示的最大数。（因为`unsigned int` 它是 2^32-1）。现在，如果我们尝试运行以下代码：

```
void get_phones(int *phones){
    FILE *fp;
    fp = fopen("phones.txt", "rt");

    if (fp == NULL)
        printf ("Error\n");
    else
        while (fscanf(fp, "%d\n", phones++) !=EOF){}

} 
```

终端打印的号码列表为：
646385865
678139199
111111111

数组中保存的第一个号码是完全随机的！为什么？因为它对于整数来说太大并且溢出。

现在，如果我们尝试以下版本：

```
void get_phones(long long* phones){
    FILE *fp;
    fp = fopen("phones.txt", "rt");
        if (fp == NULL)
            printf ("Error\n");
        else
            while (fscanf(fp, "%lld\n", phones++) !=EOF){}

} 
```

终端上打印的号码列表为：
22121222345
678139199
111111111

为什么有效？因为该类型`long long`最多可以存储 2^63-1 = 9,223,372,036,854,775,807

测试工作版本。`long long`如果需要，将数据类型更改为。

！！您的代码的问题是您将错误的内容传递给`fscanf`. `phones`已经是一个指针——它指向数组的起点。当您写入时`phone++`，它会将当前指针传递给 fscanf，并将指针加一，这会将指针移动到整数数组中的下一个槽。

此外，虽然`fscanf`会返回它扫描的项目数，但在您的 while 循环条件下，扫描已经执行。所以你不需要在 while 循环体中第二次调用它

不幸的是， 5195551234 这个数字仍然太大了`unsigned long`。因为对于 32 位机器，两者`int`都有`unsigned long`最大值 $2^{32}-1$。如果您需要有关此的更多信息，请查看[维基百科。](http://en.wikipedia.org/wiki/Integer_%28computer_science%29)相反，`long long`如果您在 32 位机器上运行代码，则需要，否则它将溢出并存储不正确的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:24:07.810

1.  您应该具有`main()`运行 make 程序的功能（请参阅文档）
2.  `int *phones`应该指向分配的内存。
3.  `fscanf(fp, "%d\n", &phones);`-- 每次调用此函数都会重写之前读取的数字，例如，读取后的每个数字都放在与前一个相同的内存地址。
4.  在循环迭代中调用 fscanf 两次是不正确的行为逻辑。检查第一个 fscanf() 的结果，但不检查第二个的结果。

# python - Python MySQLdb WHERE SQL LIKE

> ID：10903497
> 
> 赞同：10
> 
> 时间：2012-06-05T19:17:36.987
> 
> 标签：python, mysql, mysql-python

我最近开始为网络目的学习 Python 和 MySQL，但遇到了以下问题：

我想从 mysql 数据库中提取一条记录，其中包含我在 param 部分输入的任何文本，但是在进行查询时我遇到了以下问题：

```
traceback (most recent call last):
  File "/Users/Strielok/Desktop/test.py", line 13, in <module>
    c.execute("SELECT * FROM data WHERE params LIKE ('%s%') LIMIT 1"  % (param))
TypeError: not enough arguments for format string 
```

这是我的代码：

```
import MySQLdb

db = MySQLdb.connect (host = "localhost",
                          user = "root",
                          passwd = "root",
                          db = "test")
param = "Test"

par = param

c = db.cursor()

c.execute("SELECT * FROM data WHERE params LIKE ('%s%') LIMIT 1"  % (param))

data = c.fetchall()
print data

c.close() 
```

提前致谢。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-05T19:24:02.597

直接将数据插入到 SQL 字符串中并不是最好的方法，因为它容易发生[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。你应该把它改成这样：

`c.execute("SELECT * FROM data WHERE params LIKE %s LIMIT 1", ("%" + param + "%",))`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-05T14:54:43.223

一种更好的方法（并且更安全），而不是使用字符串来`"%" + param + "%"`将`%`模板字符串中的 char 与另一个`%`(so, `%%`) 一起转义，所以它将是：

`c.execute("SELECT * FROM data WHERE params LIKE '%%%s%%' LIMIT 1", (param,))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:22:58.627

您没有使用正确的参数。Python 期望在该区域`('%s%___')`中使用另一个限定符来进行字符串替换。这也是易受攻击的代码。执行此操作的正确方法看起来更像：

`c.execute("SELECT * FROM data WHERE params LIKE '%%s%' LIMIT 1",(param,))`

# jquery - 此代码不起作用。为什么？

> ID：10903498
> 
> 赞同：-2
> 
> 时间：2012-06-05T19:17:39.973
> 
> 标签：jquery, ajax, json

puts.php (JSON)

```
 {
    "image":[
       {
          "name":'<div id="yes">Hi!</div>'
       }
    ]
 } 
```

进程.php

```
<HTML>
    <HEAD>
        <TITLE>Process</TITLE>
        <script type="text/javascript" src="http://ajax.microsoft.com/ajax/jQuery/jquery-1.3.2.min.js"></script>
        <script>
            function loadPage() {

                $(document).ready(function () {

                    $.getJSON('puts.php', function (JSON) {
                        $('#result').empty();

                        $.each(JSON.image, function (i, img) {
                            $('#result').append(img.name)
                        });
                    });
                });
            }

            function loadEfect() {

                $(document).ready(function () {

                    $('#yes').fadeOut();
                    $('#yes').fadeIn();
                });
            }

            function start() {

                loadPage();
                loadEfect();
            }
        </script>
    </HEAD>

    <BODY onLoad="start()">
        <div id="result"></div>
    </BODY>

</HTML> 
```

`process.php`函数中的代码`loadEfect()`不起作用。( `fadeIn`, `fadeOut`not working) 页面加载`loadPage()`功能可以工作，但是`loadEfect()`功能不工作。为什么是这样？我在哪里可以犯错误？请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:24:59.757

`loadEfect` isn't working because there's no element with the ID `yes`.

Also, don't use both `onload` and `$(document).ready(`. Only use one method.

```
function loadPage() {
    $.getJSON('puts.php', function (JSON) {
        $('#result').empty();
        $.each(JSON.image, function (i, img) {
            $('#result').append(img.name)
        });
    });
}

function loadEfect() {
    $('#yes').fadeOut();
    $('#yes').fadeIn();
}

$(document).ready(function(){
    loadPage();
    loadEfect();
} 
```

Then remove `onLoad="start()"` from your `<body>` tag.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:22:24.937

它不起作用，因为`onload`发生在`onready`. 尝试这样的事情：

```
$(function(){
    $.getJSON('puts.php' function(json){
        $.each(json.image, function(i, img){
            $('#result').append(img.name)
        };
    });

    $('#yes').fadeOut();
    $('#yes').fadeIn(); 
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:23:27.797

Only use double-quoted stings in your JSON:

```
{
    "image": [
        {
            "name": "<div id='yes'>Hi!</div>"
        }
    ]
} 
```

Single-quoted strings are not allowed. See [JSONLint](http://jsonlint.com/).

# java - JTextArea 文档侦听器更新文本

> ID：10903499
> 
> 赞同：0
> 
> 时间：2012-06-05T19:17:43.307
> 
> 标签：java, swing, jtextarea, insert-update, documentlistener

我有一个 JTextArea，当用户在 JtextArea 中粘贴文本时，我想听听。具体来说，我想做以下事情：

获取他们粘贴的文本，删除空格，并将 JTextArea 文本替换为没有空格的已编辑文本（而不是用户粘贴的原始文本）。

我如何使用 DocumentListener 来做到这一点，并避免`java.lang.UnsupportedOperationException: Not supported yet.`，这是以下代码的结果：

```
public void insertUpdate(DocumentEvent de) {

        final String replace = jTextArea1.getText().replaceAll("\\s","");

        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
            jTextArea1.setText(replace);
            }
         });

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:23:43.523

我对方法没有任何问题`insertUpdate(DocumentEvent documentEvent)`，确保 JTextArea 只能接受字符输入，如果使用 JEditorPane 有问题，您也可以导入另一个 Java AWT 和 Swing 对象

代码示例

```
private DocumentListener docListener = new DocumentListener() {

    @Override
    public void changedUpdate(DocumentEvent documentEvent) {
        printIt(documentEvent);
    }

    @Override
    public void insertUpdate(DocumentEvent documentEvent) {
        printIt(documentEvent);
    }

    @Override
    public void removeUpdate(DocumentEvent documentEvent) {
        printIt(documentEvent);
    }

    private void printIt(DocumentEvent documentEvent) {
        DocumentEvent.EventType type = documentEvent.getType();
        //your code
    }
}; 
```

要替换插入的字符，您必须添加[DocumentFilter](https://stackoverflow.com/questions/9429459/get-a-key-from-jtextarea/9430683#9430683)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:29:18.830

如果您想删除正则`\S or \s`表达式中的白色字符。如果你想只删除空格，你可以用同样的方式来做。阅读有关正则表达式的更多信息：http: [//docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html)

# android - View 中的 findViewById 用法

> ID：10903520
> 
> 赞同：1
> 
> 时间：2012-06-05T19:19:20.603
> 
> 标签：android

我已经在一个问题上苦苦挣扎了几天，到目前为止找不到我的问题的解决方案。我有两个类： - StartActivity 扩展 Activity - TimeGraphView 扩展 SurfaceView

我想要实现的是将 TimeGraphView 中的动态按钮添加到另一个视图（LinearLayout）。为此，我想使用 findViewById() 在 TimeGraphView 中获取 LinearLayout，但它返回 null，这应该是因为我在 TimeGraphView 中调用它，而不是在使用 setContentView() 的根元素中调用它；

所以我的问题是如何将按钮从自定义视图级别动态添加到另一个视图。

我的代码：

```
public class StartActivity extends Activity {

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.time_graph);

        LinearLayout layout = (LinearLayout) this.findViewById(R.id.TimeGraphLayout);
        //here I can add button but it's not what I want
    }
} 
```

和 ...

```
public class TimeGraphView extends SurfaceView implements SurfaceHolder.Callback, Runnable {

    public TimeGraphView(Context context) {
        super(context);
    }

    public TimeGraphView(Context context, AttributeSet set) {
        super(context, set);
    }

    public TimeGraphView(Context context, AttributeSet set, int arg) {
        super(context, set, arg);
    }

    public void run() {
        while (run) {
            if (something) {
                LinearLayout layout = (LinearLayout) findViewById(R.id.TimeGraphLayout);
                if (layout != null) {
                    Button button = new Button(context);
                    button.setText(text);
                    layout.addView(button);
                } else {
                    Log.e("TimeGraphView", "TimeGraphLayout is null");
                    //and "layout" is always null and that's the problem ;(
                }
            }
        }
    }
} 
```

...和我的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/TimeGraphRootLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <HorizontalScrollViewa
        android:id="@+id/TimeGraphPanel"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <LinearLayout
            android:id="@+id/TimeGraphLayout"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal" />
    </HorizontalScrollView>

    <my.package.TimeGraphView
        android:id="@+id/TimeGraphChart"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-04T10:29:52.590

你不能以这种方式使用它。如果您添加根元素 Linearlayout 并另外引用它，它可能会起作用。如果你想获得 TimeGraphLayout 类：

```
 TimeGraphView layout = (TimeGraphView) findViewById(R.id.TimeGraphLayout);
 setContentView(layout); 
```

你原来的做法是行不通的，因为 TimeGraphView 不是 LinearLayout

# ruby-on-rails - 如何在 HABTM 多对多关系中的记录之间添加数据关联？

> ID：10903525
> 
> 赞同：1
> 
> 时间：2012-06-05T19:19:32.873
> 
> 标签：ruby-on-rails, activerecord

我已经在两个表之间建立了一个 HABTM 关系，在项目和类别之间创建了多对多关系。我想通过添加项目表单添加与一个或多个类别相关的项目。当我提交表单时，我收到错误“无法批量分配受保护的属性：类别”。

这是我的模型：

```
class Item < ActiveRecord::Base
  attr_accessible :description, :image, :name

  has_attached_file :image, :styles => { :medium => "300x300>", :thumb => "100x100>" }

  belongs_to :user
  has_and_belongs_to_many :categories

  validates :name, presence: true, length: {maximum: 50}
  accepts_nested_attributes_for :categories
end

class Category < ActiveRecord::Base
  attr_accessible :description, :name
  has_and_belongs_to_many :items

  validates :name, presence: true, length: {maximum: 50}
end 
```

还有我的迁移：

```
class CreateItems < ActiveRecord::Migration
  def change
    create_table :items do |t|
      t.string :name
      t.text :description
      t.has_attached_file :image

      t.timestamps
    end
  end
end

class CreateCategories < ActiveRecord::Migration
  def change
    create_table :categories do |t|
      t.string :name
      t.string :description

      t.timestamps
    end
  end
end

class CreateCategoriesItems < ActiveRecord::Migration
  def up
    create_table :categories_items, :id => false do |t|
      t.integer :category_id
      t.integer :item_id
    end
  end

  def down
    drop_table :categories_items
  end
end 
```

我的表格如下所示：

```
<%= form_for(@item, :html => { :multipart => true }) do |f| %>
  <%= render 'shared/error_messages', object: f.object %>

  <%= f.label :name %>
  <%= f.text_field :name %>

  <%= f.label :description %>
  <%= f.text_field :description %>
  <%= f.file_field :image %>
  <%= f.collection_select(:categories, @categories,:id,:name)%>
  <%= f.submit "Add Item", :class => "btn btn-large btn-primary" %>
<% end %> 
```

这是我的项目控制器：

```
class ItemsController < ApplicationController

  def new
    @item = Item.new
    @categories = Category.all
  end

  def create
    @item = Item.new(params[:item])
    if @item.save
      #sign_in @user
      flash[:success] = "You've created an item!"
      redirect_to root_path
    else
      render 'new'
    end
  end

  def show
  end

  def index
    @items = Item.paginate(page: params[:page], per_page: 3)
  end

end 
```

感谢您所有的帮助 ：）

-丽贝卡

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T20:22:32.820

批量分配通常意味着将属性传递到创建对象的调用中，作为属性散列的一部分。

试试这个：

```
@item = Item.new(name: 'item1', description: 'description1')
@item.save
@category = Category.find_by_name('category1')
@item.categories << @category 
```

另见：

[http://guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association](http://guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association) http://api.rubyonrails.org/classes/ActiveModel/MassAssignmentSecurity/ClassMethods.html

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T23:03:27.307

IAmNaN 发布了上面的评论，这是我的代码中缺少的链接正常工作。此后，我写了[一篇博](http://azimuthonline.com/blog/rails-active-record-many-to-many-relationship-using-habtm)文，详细介绍了设置 HABTM 的过程。感谢 IAmNaN！

# jquery - 如何通过单击按钮打开和关闭引导警报？

> ID：10903526
> 
> 赞同：38
> 
> 时间：2012-06-05T19:19:33.640
> 
> 标签：jquery, jquery-ui, twitter-bootstrap

我想通过按钮单击事件多次显示警报框，而无需刷新页面，但警报框只显示一次。如果我想再次显示警报框，我必须刷新页面。

目前，如果您在页面上呈现引导警报，当您关闭它时，警报的 div 容器将从页面中消失。因此，当您再次单击该按钮时，它不再显示。我一直在关闭按钮上执行以下操作以使其隐藏而不是删除警报的 div 容器。

```
<button class="close" onclick="$('#alertBox').hide();; return false;">×</button> 
```

我想知道在引导程序中使用 data-toggle 或 data-dismiss 是否可以使这种切换效果起作用，而无需通过我自己的自定义 Javascript 处理程序。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-06-14T08:45:50.510

我遇到了同样的问题：只是不要使用`data-dismiss`关闭按钮并使用 JQuery`show()`和`hide()`：

```
$('.close').click(function() {
   $('.alert').hide();
}) 
```

现在，您可以使用以下代码在单击按钮时显示警报：

```
$('.alert').show() 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-04-18T08:30:58.963

实际上你应该考虑使用这样的东西：

```
$('#the-thing-that-opens-your-alert').click(function () {
  $('#le-alert').addClass('in'); // shows alert with Bootstrap CSS3 implem
});

$('.close').click(function () {
  $(this).parent().removeClass('in'); // hides alert with Bootstrap CSS3 implem
}); 
```

由于引导淡入/淡入使用 CSS3 而不是 Jquery 在完整的 Javascript 中隐藏/显示。我的观点是，在移动设备上，CSS3 比 Js 更快。

您的 HTML 应如下所示：

```
<a id="the-thing-that-opens-your-alert" href="#">Open my alert</a>

<div id="le-alert" class="alert alert-warn alert-block fade">
  <button href="#" type="button" class="close">&times;</button>
  <h4>Alert title</h4>
  <p>Roses are red, violets are blue...</p>
</div> 
```

这很酷！检查它在[jsFiddle](http://jsfiddle.net/Rytj9/) =)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-19T07:27:35.157

我只是使用模型变量来显示/隐藏对话框并删除了 data-dismiss="alert"

例如

```
<div data-ng-show="vm.result == 'error'" class="alert alert-danger alert-dismissable">
    <button type="button" class="close" data-ng-click="vm.result = null" aria- hidden="true">&times;</button>
    <strong>Error  !  </strong>{{vm.exception}}
</div> 
```

为我工作，不再需要外出 jquery

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-11T03:32:16.217

您不需要使用 jquery 来完成此操作，这是一个仅引导程序的解决方案。

开/关按钮：

```
<button type="button" class="btn" data-toggle="collapse" href="#my-alert-box">
   <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
</button> 
```

带有隐藏警报的关闭按钮的警报（与单击显示/隐藏按钮相同）：

```
<div id="my-alert-box" class="alert alert-info collapse" role="alert">
   <button type="button" class="close" data-toggle="collapse" href="#my-alert-box">
      <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
   </button>
   <p>Look, here's a show/hide alert box without jquery...</p>
</div> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-17T10:26:20.137

您可以向警报添加`.hidden`类，然后对其进行调整。请参阅：[JSFiddle](http://jsfiddle.net/Rytj9/150/)

**HTML**

```
<a id="show-my-alert" href="#">Show Alert</a>

<div id="my-alert" class="alert alert-warning hidden" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">    
        <span aria-hidden="true">&times;</span>
    </button> 
    <strong>Warning!</strong> Better check yourself, you're not looking too good.
</div> 
```

**JavaScript**

```
$("#show-my-alert, .close").click(function() {
    $("#my-alert").toggleClass("hidden");
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-13T14:58:21.600

你也可以试试这个：

```
$("#MyBtn").click(function() {

    if($("#MyAlrt").is(":visible")){
        $("#MyAlrt").hide();
    }else{
        $("#MyAlrt").show();
    }

}); 
```

它对我来说非常好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-03T23:41:47.897

```
$(document).on('click', '.close', function() {

   $('.alert').hide();

});
```

它适用于所有元素，包括新元素

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-01T17:54:44.477

要显示/隐藏，您可以在接受的答案中执行此操作：

> 我遇到了同样的问题：只是不要使用`data-dismiss`关闭按钮并使用 JQuery`show()`和`hide()`：
> 
> ```
> $('.close').click(function() {
> $('.alert').hide();
>   }) 
> ```
> 
> 现在，您可以使用以下代码在单击按钮时显示警报：
> 
> ```
> $('.alert').show() 
> ```
> 
> 希望这可以帮助！

或者尝试做的是制作一个可折叠的警报，该警报将折叠警报并仍然显示例如标题。我这样做是为了制作它`position:fixed;`，然后显示其他内容。然而这很难做到，所以我创造了一个解决方法。当您单击关闭按钮时，它会设置弹出窗口`display:none;`，然后首先当它位于顶部时，您可能需要阻止它最初覆盖内容，因此我添加了将根据警报显示显示/隐藏的换行符。所以 2 当您单击关闭时会发出警报，`display:none;`然后显示另一个只有一行内容的弹出窗口。单击此弹出窗口时，它会将主要警报设置`display:block;`为以及换行符。这是代码，现在已经完成了：

```
function ShowALERT() { 
  document.getElementById('ALERT').style.display = "block";
	document.getElementById('ShowALERT').style.display = "none";
	document.getElementById('breakShowALERT').style.display = "none";
	document.getElementById('breakALERT').style.display = "block";

}
function closeALERT() { 
   document.getElementById('ALERT').style.display = "none";
document.getElementById('breakShowALERT').style.display = "block";
  document.getElementById('ShowALERT').style.display = "block";
document.getElementById('breakALERT').style.display = "none";

}
```

```
#ALERT {
	position:fixed;
	display:block;
	width:100%;
	z-index:1;
	left:0px;
	top:0px;

	}
  #ShowALERT {
position: fixed;
display:none;
z-index:1;
top:0px;
left:0px;
width: 100%;
}
#breakShowALERT {
display:none;
}
	#breakALERT {
display:block;
}
```

```
<link href="https://antimalwareprogram.co/sb/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<div class="container">
    <button id="ShowALERT"  onclick="ShowALERT()" class="bg-primary"> 

	  <h5> <b>Important Alert</b></h5>
</button>
</div>
<div class=container>
   <div id="ALERT" class="alert bg-primary alert-dismissable">
 <a href="#" class="close" onclick="closeALERT()" aria-label="close">Dismiss</a>
 <h5><b>Note:</b> Alert Content here......................</h5>
</div>
 </div>
 <body>
 <div id='breakALERT'><br><br><br><br><br></div>
					<div id='breakShowALERT'><br><br></div>
 <p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p><p>content</p>
 </body>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-15T17:14:33.937

我基于 Leiko 的解决方案使用了以下工作方法。

```
$(document).ready(function(){
    $("#btnFV").click(function()
    {
        $("#alertFV").addClass("in");
    });

    $("#alertFV").on("close.bs.alert", function ()
    {
        $("#alertFV").removeClass("in");
        return false;
    });
}); 
```

Html 正文包含以下警报

```
<button id="btnFV" class="form-control">Button To Show/Hide Alert</button>

<div id="alertFV"  class="alert alert-danger alert-dismissable fade show">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
      </button>
      <strong>Danger!</strong> 
    </div> 
```

# iphone - Xcode 应用程序在 Iphone 上运行但在 Ipad 上崩溃

> ID：10903530
> 
> 赞同：0
> 
> 时间：2012-06-05T19:19:52.747
> 
> 标签：iphone, xcode, ipad, memory-leaks, ios-universal-app

我制作了一个通用应用程序，其中包含 ipad 和 iphone UI 的 NIB 文件。在我的视图控制器 initWithNibName 方法中，我调用`UIUserInterfaceIdiomPad == UI_USER_INTERFACE_IDIOM()`以检测控制器是在 iphone 还是 ipad 上运行。

然后我启动他们各自的 nib 文件。当我在 iphone 上运行该应用程序时，它可以正常工作，但是当我在 ipad 上运行它时，它最终会因`EXC_BAD_ACCESS`错误而崩溃。当我使用视图控制器启动另一个视图控制器，然后在导航堆栈中启动另一个视图控制器时，会发生此错误。当我单击属于堆栈的第三个控制器的视图时，就会发生此错误。

我无法区分`NIB`会导致崩溃的文件之间的差异。我一直在不知疲倦地想弄清楚为什么会这样，但我无法修复这个错误。有没有人对可能发生的事情有任何见解？

任何有关如何解决此问题的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T20:03:09.883

您应该做的第一件事是启用“所有异常”断点。这通常会准确地告诉您发生 EXC_BAD_ACCESS 的代码行。

![在此处输入图像描述](../Images/52acf365cc08ec875172a18c4fd59fbc.png)

接下来，我将打开僵尸并查看过度释放发生在哪里。为此，在 Xcode 中，按住 option 键的同时单击 Product | 运行.... 在随后的窗口中，将 NSZombieEnabled 添加到环境变量列表中。

![在此处输入图像描述](../Images/4b85ac86970e641114b3157636c5ce5c.png)

然后运行。做正常的事情来导致崩溃并查看调试器的位置。运气好的话，它会在问题实际发生的地方停止。

当您获得 EXC_BAD_ACCESS 时，这意味着您正在尝试访问/发布已发布的内容。如果您处于非 ARC 情况，这通常意味着您无意中释放了某些内容，因此只需检查 alloc/init 和释放平衡。但是，如果您处于 ARC 情况，我敢打赌这与释放视图控制器时不取消委托有关。

例如，如果您有一个 MKMapView 并将其委托设置为您的视图控制器，则当您的视图被卸载或解除分配时，您应该将其委托为零。否则，消息将继续设置为它。或者，另一种可能性是您已将视图控制器添加为 NSNotificationCenter 观察者，并且在视图控制器被卸载或解除分配时没有将其作为观察者移除。

另一种可能性是您在通用应用程序的两个版本之间重复使用视图控制器。如果您通过 iPad 笔尖中不存在的标识符访问任何内容，则会导致崩溃——尽管如果您使用笔尖而不是情节提要，这可能不是问题。

这就是我现在能想到的。如果您仍然无法弄清楚，请尝试将其发生的位置归零并在此处发布代码。

最好的祝福。

# objective-c - 用 int 设置方法

> ID：10903533
> 
> 赞同：-3
> 
> 时间：2012-06-05T19:20:08.310
> 
> 标签：objective-c, xcode, methods, int

我有一个方法，当我想设置一个参数（类型是`int`）时，我收到一条错误消息。我的代码：

```
@implementation PlayerInfo

@synthesize playerName;
@synthesize playerScore;

-(id) initPlayerInfo:(NSString*) name playerScore:(int) score
{
    self = [super init];

    if(self)
    {
        self.playerName = name;
        self.playerScore = score;
    }

    return self;
} 
```

我在这一行得到一个错误：

```
self.playerScore = score; 
```

问题是什么？？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:50:18.427

您将该属性声明为指向 int（即`int *`）而不是 int（即 ）的指针`int`。尽管两者都包含关键字`int`，但它们是非常不同的东西。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-05T19:27:23.600

playerScore 必须是（非原子的，分配的）检查。或者当你初始化 PlayerInfo 实例时，你应该给 score 一个值

# php - PHP 中是否应该使用数组或类来保存多个变量？

> ID：10903534
> 
> 赞同：2
> 
> 时间：2012-06-05T19:20:09.647
> 
> 标签：php, arrays, class

目前，我正在创建一个脚本，该脚本将从传递给它的某种类型的报告中解析信息。脚本的一部分将从报告中提取学生信息并将其保存以供以后处理。

最好以类的形式保存，还是以数组变量的形式保存？我认为有 3 种方法可以使用。

**编辑：**真的，问题归结为任何一种方式是否具有任何性能优势？因为否则，每种方法实际上都与上一种方法相同。

作为一个可以直接访问变量的类：

```
class StudentInformation {

    public $studentID;
    public $firstName;
    public $lastName;
    public $middleName;
    public $programYear;
    public $timeGenerated;

    function StudentInformation(){} 
} 
```

作为具有功能的类：

```
class StudentInformation {

    private $studentID;
    private $firstName;
    private $lastName;
    private $middleName;
    private $programYear;
    private $timeGenerated;

    function StudentInformation(){}

    public function setStudentID($id)
    {
        $this->studentID = $id;
    }

    public function getStudentID()
    {
        return $this->studentID;
    }

    public function setFirstName($fn)
    {
        $this->firstName = $fn;
    }

    /* etc, etc, etc */
} 
```

或者作为一个以字符串为键的数组：

```
$studentInfo = array();
$studentInfo["idnumber"] = $whatever;
$studentInfo["firstname"] = $whatever;
$studentInfo["lastname"] = $whatever;
/* etc, etc, etc */ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:27:00.730

您可以为单个学生创建一个班级，对单个学生进行适当的操作，例如更新成绩或获取全名（具有访问功能的私有数据成员）。然后为多个学生创建另一个包含单个学生数组的班级。您可以创建对学生集进行操作的函数，根据需要测试和调用单个学生函数。

高级别的答案是您可以按照您建议的任何方式执行此操作，但我们大多数人会推荐 OOP 解决方案。如果您的需求非常简单，一个简单的数组可能就足够了。如果您的需求发生变化，您可能不得不为对象重新编写整个代码。类也可以保持简单，所以我建议你从类开始，并根据需要增加复杂性。我相信从长远来看，它将通过类更好地维护和扩展。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T19:51:20.460

1.  尝试优化数组与简单值对象的使用可能是不必要的微优化。对于最简单的情况，数组更快，因为您没有构造`new`对象的开销。

2.  记住这一点很重要：*数组不是唯一存在的数据结构。*如果您不需要散列功能，那么一旦您克服了对象创建的初始开销，一个简单的[`SplFixedArray`^(*文档*)](http://us3.php.net/manual/en/class.splfixedarray.php)将导致更低的内存开销和更快的迭代。如果您要存储大量数据，则上述固定数组或其他[SPL 数据结构](http://us3.php.net/manual/en/spl.datastructures.php)之一可能是更好的选择。

3.  **最后：**值对象应该是不可变的，所以在你的情况下，我强烈推荐对象提供的封装，而不是随意分配哈希映射值的能力。如果您想要使用数组表示法的简单性，请让您的班级实现[`ArrayAccess`^(*文档*)](http://php.net/manual/en/class.arrayaccess.php)并获得两全其美的效果。`__get`有些人会建议使用和的魔术 getter 和 setter `__set`。我不会，因为魔法通常会不必要地混淆你的代码。如果你真的需要魔法，你可能会重新考虑你的设计。

OOP 范式被认为是我们提出的最好的编程范式是有原因的——因为它是我们提出的最好的范式。你应该使用它。避免落入许多/大多数 PHP 开发人员的陷阱，他们对所有事情都使用数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:31:31.160

关于您的性能问题，类可能比数组快，因为不同的实例是独立存储的。通过将所有东西放在一个巨大的哈希映射（关联数组）中，您还可以获得数组的一些限制/属性。例如，订购。你不需要那个。此外，如果 PHP 解释器不聪明，它会在您每次查找时散列您的查找字符串。使用不必要的类和静态类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T19:31:40.890

这 3 个选项是有效的，但对外界的封装/保护程度不同。

从最低保护到最高：

1.  大批
2.  直接访问公共属性的对象
3.  带有 getter/setter 的对象

选择很大程度上取决于您的项目环境（2 小时？明天发送到垃圾箱？）

选择 2 似乎很务实。

考虑到根据您的数据库包装器，可以将数据提取到数组或对象中。如果它是作为数组获取的，您可能必须将它们映射到对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:22:30.013

这是一个没有明确答案的主观问题，但我会推荐 OOP 方式。您可以创建一个`Parser`包含`StudentInformation`.

它更加舒适，如果您需要一些额外的处理，您可以添加更多方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T19:27:50.510

如果您只编写一个没有很多功能的小项目，则数组会更好。但是，类有其优势。例如，您愿意键入

```
$class->db_update("string", $database); 
```

或者

```
$query = "SELECT * FROM `table` WHERE foo='".$array['bar'].'";
mysql_connect("...
mysql_query($query... 
```

基本上，每一方都有自己的优势。我会推荐 OOP 方式，就像这里的大多数其他人应该并且愿意一样。

编辑：另外，[看看这个。](https://stackoverflow.com/questions/24130/classes-vs-2d-arrays)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-05T19:31:31.187

我会去上课，属性是私有的。

任何与学生信息有关的操作都可以/应该在该类中创建。

如果这是一次性的事情，我会选择数组，但实际上，我知道拥有只使用一次的东西意味着什么，然后发现我需要对数据执行 n 个操作，并且最终不得不去上课。

# entity-framework - 如何检查 IQueryable 在尝试 Skip() 和 Take() 之前应用了 OrderBy

> ID：10903538
> 
> 赞同：3
> 
> 时间：2012-06-05T19:20:20.050
> 
> 标签：entity-framework, linq-to-entities, iqueryable, skip-take

我正在尝试构建一个将对查询进行分页的扩展方法。但为了避免异常：System.NotSupportedException 未被用户代码处理 Message=方法“Skip”仅支持 LINQ to Entities 中的排序输入。必须在方法“Skip”之前调用方法“OrderBy”。

我想检查 OrderBy 是否被应用，如果不只是返回查询......像这样的东西：

```
public static IQueryable<T> Paginate<T>(this IQueryable<T> query, int page, int pageSize = 50, int total = -1)
{
    // check if OrderBy was applied

    // THIS DOES NOT WORK!!!
    //try
    //{
    //    var orderedQueryable = query as IOrderedQueryable<T>;
    //}
    //catch (Exception)
    //{
    //    // if the cast throws OrderBy was not applied <-- DOES NOT WORK!!!
    //    return query;
    //}
    page = (page < 1) ? 1 : page;
    var limit = (pageSize <= 0 || (total >= 0 && pageSize > total)) ? 50 : pageSize;
    var skip = (page - 1)*limit;

    return query.Skip(skip).Take(limit);
} 
```

为了让事情更*有趣*，我使用 Mycrosoft 的[动态表达式 API](https://nuget.org/packages/System.Linq.Dynamic)（又名动态 LINQ），所以我的调用代码看起来像

```
return query
         .OrderBy("Customer.LastName DESC, Customer.FirstName")
         .Paginate(1,25, 2345)
         .ToArray(); 
```

或者我可以使用像这样的强类型表达式来调用它

```
return query
        .OrderByDescending(c=>c.LastName)
        .ThenBy(c=>c.FirstName)
        .Paginate(1,25,2345)
        .ToArray(); 
```

这种检查可以吗？我厌倦了使用in 方法签名，但是当您使用 OrderBy(string expression) 时`IOrderableQueryable<T>`Dynamic Linq 不会返回，因此扩展将不适用...`IOrderableQueryable`

## 更新

使用建议（@GertArnold 指出）唯一可行的解​​决方案是检查表达式树。但是，我没有使用整个解决方案，而是`ExpressionVisitor`通过要求必须在`OrderBy`or之后调用 Paginate 方法来简化我的解决方案`OrderByDescending`。这允许我只检查表达式树中的当前节点，而不是搜索整个树。所以这就是我所做的：

```
// snip....class level 
private static readonly string[] PaginationPrerequisiteMehods = new[] { "OrderBy", "OrderByDescending" };

// snip Paginate method
public static IQueryable<T> Paginate<T>(this IQueryable<T> query, int page, int pageSize = 50, int total = -1)
    {
        // require that either OrderBy or OrderByDescending was applied just before calling Paginate....
        if (query.Expression.NodeType != ExpressionType.Call)
        {
            //TODO: logging -> "You have to apply OrderBy() or OrderByDescending() just before calling Paginate()"
            return query;
        }
        var methodName = ((MethodCallExpression) query.Expression).Method.Name;
        if (!Array.Exists(PaginationPrerequisiteMehods, s => s.Equals(methodName, StringComparison.InvariantCulture)))
        {
            //TODO: logging -> "You have to apply OrderBy() or OrderByDescending() just before calling Paginate()"
            return query;
        }

        page = (page < 1) ? 1 : page;
        var limit = (pageSize <= 0 || (total >= 0 && pageSize > total)) ? 50 : pageSize;
        var skip = (page - 1)*limit;

        return query.Skip(skip).Take(limit);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T20:39:34.710

您可以检查表达式本身，如此[处](https://stackoverflow.com/questions/9025137/when-is-objectquery-really-an-iorderedqueryable)所述，或检查编译时类型，如此[处](https://stackoverflow.com/questions/9063131/how-to-tell-which-interface-is-returned-by-a-method)所述。我认为前者应该适合你，因为动态 linq 也会在表达式中添加`OrderBy`(or )。`OrderByDescending`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T20:43:52.160

不知何故，您似乎正在尝试解决一些没有意义的问题。

您不想在使用您的方法时出现运行时异常。好的！但在这种情况下，不要使用 Dynamic Linq，因为这正是导致运行时异常并`IOrderedQueryable`用于您的`Paginate`方法的东西。

您想使用动态 Linq。好的！但是在这种情况下，您需要一些测试（我的意思是集成测试），它们将在运行时测试您的代码，并且您的`Paginate`方法应该以相同的方式进行测试。

在运行时探索表达式树仍然与运行时异常相同——它没有通知程序员对无序数据使用 Paginate 方法。

# iphone - 一起使用 AVCaptureSession 和 AVAudioPlayer

> ID：10903542
> 
> 赞同：10
> 
> 时间：2012-06-05T19:20:54.873
> 
> 标签：iphone, ios, ipad, avfoundation

我能够录制视频并将电影正确输出到文件。但是，在尝试使用 AVAudioPlayer 播放一些音频时，我遇到了视频录制问题（无视频输出）。这是否意味着我不能同时使用 AVCaptureSession 和 AVAudioPlayer？这是我创建捕获会话和播放音频的代码。首先开始视频捕获，然后在捕获过程中，我想播放一些音频。非常感谢您的帮助。

创建捕获会话以录制视频（带音频）的代码 - 输出到 .mov 文件：

```
- (void)addVideoInput
    AVCaptureDevice *audioDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeAudio];
    //... also some code for setting up videoDevice/frontCamera
    NSError *error;
    AVCaptureDeviceInput *videoIn = [AVCaptureDeviceInput 
    deviceInputWithDevice:frontCamera error:&error];
    AVCaptureDeviceInput *audioIn = [AVCaptureDeviceInput 
    deviceInputWithDevice:audioDevice error:&error];
    if (!error) {
         if ([captureSession canAddInput:audioIn])
              [captureSession addInput:audioIn];
         else
              NSLog(@"Couldn't add audio input.");  
         if ([captureSession canAddInput:videoIn])
              [captureSession addInput:videoIn];
         else
              NSLog(@"Couldn't add video input.");
}
- (void)addVideoOutput
{
     AVCaptureMovieFileOutput *m_captureFileOutput = [[AVCaptureMovieFileOutput alloc] init];
     [captureSession addOutput:m_captureFileOutput];

     [captureSession startRunning];

     NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
     NSMutableString *filePath = [NSMutableString stringWithString:@"Movie.mov"];
     NSString* fileRoot = [docDir stringByAppendingPathComponent:filePath];
     NSURL *fileURL = [NSURL fileURLWithPath:fileRoot];

     AVCaptureConnection *videoConnection = NULL;

     for ( AVCaptureConnection *connection in [m_captureFileOutput connections] ) 
     {
         for ( AVCaptureInputPort *port in [connection inputPorts] ) 
         {
             if ( [[port mediaType] isEqual:AVMediaTypeVideo] ) 
             {
                 videoConnection = connection;

             }
         }
     }

     [videoConnection setVideoOrientation:AVCaptureVideoOrientationLandscapeRight]; 

     [m_captureFileOutput startRecordingToOutputFileURL:fileURL recordingDelegate:self];
     [m_captureFileOutput release];
} 
```

播放音频的代码，此函数在视频捕获会话期间调用。如果我不调用这个函数，视频就会被录制下来，我可以保存到 .mov 文件中。但是，如果我调用此函数，则没有输出 .mov 文件。

```
- (void)playAudio
{
     NSString *soundFilePath = [[NSBundle mainBundle] pathForResource:@"AudioFile" ofType:@"mp3"];
     NSURL *fileURL = [[NSURL alloc] initFileURLWithPath:soundFilePath];
     AVAudioPlayer *newPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:fileURL error:nil];
     [fileURL release];
     self.audioPlayer = newPlayer;
     [newPlayer release];
     [audioPlayer setDelegate:self];
     [audioPlayer prepareToPlay];
     [audioPlayer play];
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-14T21:23:09.083

我通过设置音频会话解决了这个问题。在创建音频播放器对象来播放音频之前，我调用了以下函数。这样，我就能够同时录制视频（带音频）和播放音频。

```
- (void)setupAudioSession {

        static BOOL audioSessionSetup = NO;
        if (audioSessionSetup) {
                return;   
        }
        [[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryPlayback error: nil];
        UInt32 doSetProperty = 1;

        AudioSessionSetProperty (kAudioSessionProperty_OverrideCategoryMixWithOthers, sizeof(doSetProperty), &doSetProperty);

        [[AVAudioSession sharedInstance] setActive: YES error: nil];

         audioSessionSetup = YES;

}

- (void)playAudio
{
         [self setupAudioSession];
         NSString *soundFilePath = [[NSBundle mainBundle] pathForResource:@"AudioFile" ofType:@"mp3"];
         NSURL *fileURL = [[NSURL alloc] initFileURLWithPath:soundFilePath];
         AVAudioPlayer *newPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:fileURL error:nil];
         [fileURL release];
         self.audioPlayer = newPlayer;
         [newPlayer release];
         [audioPlayer setDelegate:self];
         [audioPlayer prepareToPlay];
         [audioPlayer play];
    } 
```

# jquery - jQuery使用类替换多个元素

> ID：10903544
> 
> 赞同：3
> 
> 时间：2012-06-05T19:21:19.667
> 
> 标签：jquery

我想`spans`用`div`. 当我运行此代码时，只有一个元素被替换。如何更改此代码以使脚本影响所有`spans`？

*我曾尝试使用 clone()，但它没有用。*

```
$flexBox = $("<div></div>");
$(".overlayBox").replaceWith($flexBox);

<span class="overlayBox"></span>
<span class="overlayBox"></span>
<span class="overlayBox"></span> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T19:22:32.857

您可以使用[`replaceAll()`](http://api.jquery.com/replaceAll/)方法：

```
$flexBox.replaceAll(".overlayBox");​ 
```

**演示：http:** [//jsfiddle.net/4VHVC/](http://jsfiddle.net/4VHVC/)

# .htaccess - .htaccess 和 SEO URL - 为什么这是一个无限循环？

> ID：10903550
> 
> 赞同：2
> 
> 时间：2012-06-05T19:21:46.297
> 
> 标签：.htaccess, mod-rewrite, seo

我有一个像这样的脏网址：http: [//www.netairspace.com/photos/photo.php](http://www.netairspace.com/photos/photo.php?photo=3392) ?photo=3392 。我想做一些类似[http://www.netairspace.com/photos/OH-LTU/Finnair_Airbus_330-202X/OUL_EFOU_Oulu/photo_3392/](http://www.netairspace.com/photos/OH-LTU/Finnair_Airbus_330-202X/OUL_EFOU_Oulu/photo_3392/)的事情（后来支持像[http://www.netairspace.com/pic/3392这样的短网址/](http://www.netairspace.com/pic/3392/)但我会忽略它）。

所以我有一个脚本 photo_seo_url.php，它获取照片 ID，构建 SEO URL，并进行重定向（302 用于测试，301 表示满意）。然后我计划添加 .htaccess mod_rewrite 规则，以便在调用旧 URL 时：

*   旧 URL 将在内部重写为 photo_seo_url.php
*   photo_seo_url.php 将 301/302 重定向到 SEO URL
*   SEO URL 将在内部重写为原始 photo.php

这样，理论上，我会在获得 SEO URL 的好处的同时能够在闲暇时让旧的 URL 退休。

这些是我使用的规则：

```
RewriteEngine on
RewriteRule ^photos/.*/photo_([0-9]+)/?$ photos/photo.php?photo=$1 [NC,L]
RewriteCond %{QUERY_STRING} photo=([0-9]+)
RewriteRule ^photos/photo\.php$ photos/photo_seo_url.php?photo=%1 [NC,L] 
```

但这会进入无限重定向循环。为什么，如果这两个正在进行内部重写而不是外部重定向 - 或者这就是我所缺少的？

我已经解决了添加新文件 showphoto.php 的问题，该文件只包含原始 photo.php，并更改第 2 行：

```
RewriteEngine on
RewriteRule ^photos/.*/photo_([0-9]+)/?$ photos/showphoto.php?photo=$1 [NC,L]
RewriteCond %{QUERY_STRING} photo=([0-9]+)
RewriteRule ^photos/photo\.php$ photos/photo_seo_url.php?photo=%1 [NC,L] 
```

但我仍然想了解为什么原始版本会陷入无限循环。我错过或误解了一些东西。我的方法合理吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T15:28:19.757

要回答您的问题，为什么会发生此循环？这就是 SEO URI 所发生的事情`GET /photos/OH-LTU/Finnair_Airbus_330-202X/OUL_EFOU_Oulu/photo_3392/`，例如。

*   规则 1 将其转换为`GET /photos/photo.php?photo=3392`触发内部重定向的触发内部重定向，然后重新启动`.htaccess`文件扫描。

*   然后规则 2 触发将其转换为`GET photos/photo_seo_url.php?photo=339`触发内部重定向的内部重定向，该重定向再次重新启动`.htaccess`文件扫描。

*   没有进一步的匹配发生，因此这被传递给脚本`photos/photo_seo_url.php`，然后执行 302 到`/photos/OH-LTU/Finnair_Airbus_330-202X/OUL_EFOU_Oulu/photo_3392/`并且浏览器检测到重定向循环。

您需要发生的是规则 1 触发以防止规则 2 触发，即使在内部重定向之后也是如此。一种方法是设置一个环境变量，比如 END（在下一次传递中转换为 REDIRECT_END），如果设置了则跳过规则：

```
RewriteEngine on
RewriteBase   /

RewriteRule   ^photos/.*/photo_([0-9]+)/?$ photos/photo.php?photo=$1 [NC,E=END:1,L]

RewriteCond   %{ENV:REDIRECT_END}:%{QUERY_STRING}   ^:photo=([0-9]+)$
RewriteRule   ^photos/photo\.php$          photos/photo_seo_url.php?photo=%1 [NC,L] 
```

另一种方法是向`noredir`重写的 URI 添加一个虚拟参数并添加：

```
RewriteCond   %{QUERY_STRING}   !\bnoredir 
```

到原来的第二条规则。但是，`photo.php`需要忽略这一点。希望这可以帮助 ：-）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T10:02:05.687

```
RewriteEngine on
RewriteRule ^photos/.*/photo_([0-9]+)/?$ photos/photo.php?photo=$1&rewritten [NC,L]

RewriteCond %{QUERY_STRING} !rewritten
RewriteCond %{QUERY_STRING} photo=([0-9]+)
RewriteRule ^photos/photo\.php$ photos/photo_seo_url.php?photo=%1 [NC,L] 
```

# dynamic - 将查询透视为列组合

> ID：10903551
> 
> 赞同：0
> 
> 时间：2012-06-05T19:21:47.950
> 
> 标签：dynamic, sql-server-2008-r2, pivot

在 Sql Server 2008 中，我该如何从这里开始：

```
Owner  Animal   Age  Height   Weight  
-----  ------   ---  ------   ------ 
Steve  Dog        8     22      60 
Steve  Cat        5     11      14 
Steve  Gerbil     2     1.5     0.3 
```

到这里：

```
Owner  Dog_Age  Dog_Height  Dog_Weight  Cat_Age  Cat_Height  ...
-----  -------  ----------  ----------  -------  ----------  ...
Steve       8           22          60        5          11  ... 
```

所以我正在旋转 Animal 列，但想为动物和某些列的所有可能组合生成列。实际上没有执行聚合函数。由于对于我的表，可能的组合总数将相当大，我想要一个解决方案，避免我必须明确输入每个结果列名，但如果我必须这样做，我会这样做。

我查看了 PIVOT 命令的几个示例，但我没有遇到任何从上述组合创建列的示例，所以我不确定这是否可行。SQL Server 不是我的专业领域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:38:40.380

如果您不关心最终输出中的列顺序：

```
DECLARE @sql NVARCHAR(MAX);

SELECT @sql = N'';

SELECT 
    @sql = @sql + ',' + Animal + '_$c$ = MAX(CASE WHEN Animal = ''' 
          + Animal + ''' THEN $c$ END)'
FROM dbo.PetStuff
GROUP BY Animal;

SELECT @sql = 'SELECT Owner '
 + REPLACE(@sql, '$c$', 'Age')
 + REPLACE(@sql, '$c$', 'Height')
 + REPLACE(@sql, '$c$', 'Weight')
 + ' FROM dbo.PetStuff
 GROUP BY Owner;';

PRINT @sql;
-- EXEC sp_executesql @sql; 
```

如果列顺序很重要（按动物名称排序，然后按字母顺序年龄/身高/体重），那么您可以将列放在一个表中，并生成 SQL 并稍微多做一些工作：

```
DECLARE @cols TABLE(col SYSNAME);
INSERT @cols SELECT 'Age' UNION ALL SELECT 'Weight' UNION ALL SELECT 'Height';

DECLARE @sql NVARCHAR(MAX);

SELECT @sql = N'';

SELECT @sql = @sql + ',' + p.Animal + '_' + col 
  + ' = MAX(CASE WHEN Animal = ''' 
  + p.Animal + ''' THEN ' + c.col + ' END)'
FROM dbo.PetStuff AS p
CROSS APPLY @cols AS c
GROUP BY p.Animal, c.col
ORDER BY p.Animal, c.col;

SELECT @sql = 'SELECT Owner ' + @sql
 + ' FROM dbo.PetStuff
 GROUP BY Owner;';

PRINT @sql;
-- EXEC sp_executesql @sql; 
```

如果没有动态 SQL，真的想不出任何方法来做到这一点。

# tfs - 让统计数据显示在 TC 中

> ID：10903552
> 
> 赞同：0
> 
> 时间：2012-06-05T19:21:51.120
> 
> 标签：tfs, continuous-integration, teamcity, code-coverage, ncover

我已经使用我的 sln 文件设置了 teamcity，并让单元测试与 teamcity 拥有的[CppUnit 插件](http://confluence.jetbrains.net/display/TW/Cpp+Unit+Test+Reporting)一起显示。我在 TeamCity UI 中获得了测试结果。

现在我正在尝试获取趋势报告以显示我的单元测试和代码覆盖率。

就代码覆盖而言，我们使用的是生成 XML 文件的 vsinstr.exe 和 vsperfmon.exe。

我不太确定应该采取哪些步骤来显示趋势报告和代码覆盖率（不那么重要）。

我已经看过[这篇文章](http://pwigle.wordpress.com/2009/12/11/code-metrics-statistics-with-team-city/)，但答案似乎需要编辑构建脚本，我认为这不适用于我的情况，因为我是通过 MSBuild 和 .sln 文件构建的，并且正在运行测试那个构建。

所以基本上我试图让统计选项卡出现，我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T13:17:22.040

只需将简单的 Powershell 步骤添加到您的构建配置中。像这样的东西：

```
function TeamCity-SetBuildStatistic([string]$key, [string]$value) {
    Write-Output "##teamcity[buildStatisticValue key='$key' value='$value']"
}

$outputFile = 'MetricsResults.xml'

$xml = [xml] (Get-Content $outputFile)

$metrics = $xml.CodeMetricsReport.Targets.Target[0].Modules.Module.Metrics
$metrics.Metric 
  | foreach { TeamCity-SetBuildStatistic "$($_.Name)" $_.Value.Replace(',', '') } 
```

它使用来自 FxCop Metrics 的 XML 输出。您必须为您的实际架构更新脚本。

# matplotlib - matplotlib 更改 PatchCollection 中的补丁

> ID：10903554
> 
> 赞同：3
> 
> 时间：2012-06-05T19:21:55.217
> 
> 标签：matplotlib

`PatchCollection`接受`Patch`es 列表并允许我一次将它们转换/添加到画布中。但是构造对象`Patch`后对es之一的更改并没有体现出来`PatchCollection`

例如：

```
import matplotlib.pyplot as plt
import matplotlib as mpl

rect = mpl.patches.Rectangle((0,0),1,1)

rect.set_xy((1,1))
collection = mpl.collections.PatchCollection([rect])
rect.set_xy((2,2))

ax = plt.figure(None).gca()
ax.set_xlim(0,5)
ax.set_ylim(0,5)
ax.add_artist(collection)
plt.show()  #shows a rectangle at (1,1), not (2,2) 
```

我正在寻找一个 matplotlib 集合，它将对补丁进行分组，以便我可以将它们一起转换，但我也希望能够更改单个补丁。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T21:12:23.727

我不知道有一个集合可以满足您的需求，但是您可以很容易地为自己编写一个：

```
import matplotlib.collections as mcollections

import matplotlib.pyplot as plt
import matplotlib as mpl

class UpdatablePatchCollection(mcollections.PatchCollection):
    def __init__(self, patches, *args, **kwargs):
        self.patches = patches
        mcollections.PatchCollection.__init__(self, patches, *args, **kwargs)

    def get_paths(self):
        self.set_paths(self.patches)
        return self._paths

rect = mpl.patches.Rectangle((0,0),1,1)

rect.set_xy((1,1))
collection = UpdatablePatchCollection([rect])
rect.set_xy((2,2))

ax = plt.figure(None).gca()
ax.set_xlim(0,5)
ax.set_ylim(0,5)
ax.add_artist(collection)
plt.show()  # now shows a rectangle at (2,2) 
```

# php - PHP 发送 7 封电子邮件以结束并击中 1 个移动短信运营商

> ID：10903555
> 
> 赞同：-1
> 
> 时间：2012-06-05T19:21:56.090
> 
> 标签：php, email, sms

这是一个新问题，我认为应该有一个新问题。

我有一个 php 用于向 mobileNumber@carrier.com 发送短信

这是有效的。

我必须要求用户输入他的号码并选择他的提供商，我想知道，因为在我所在的纽约地区，我们只有大约 7 家流行的移动提供商。

我可以跳过询问用户是哪个移动提供商的第二个问题吗？

然后只需使用 php 将所有 7 封电子邮件连同号码一起发送出去，并且每个移动运营商的电子邮件扩展名最终都会击中其中一个？

例如，而不是发送

`mail(1231233321@txt.att.net, $subject, $message )`;

我可以一次发送所有 7 个吗？知道6行不通。。

```
mail(1231231233@txt.att.net, 1231231233@tmobile.net, etc....., $subject, $message ); 
```

如果是这样，我将如何使用此附加代码编写它？

```
<?php
if (!isset($_POST['submit'])){error("Must use form to get here!");}
$ph = preg_replace('/[^[:digit:]]/', '', $_POST['10digit']);
$carrier = $_POST['carrier'];
switch ($carrier){
    case 'att':
        $to = $ph . '@txt.att.net';
        break;
    case 'metropcs':
        $to = $ph . '@mymetropcs.com';
        break;
    case 'nextel':
        $to = $ph . '@messaging.nextel.com';
        break;
    case 'sprint':
        $to = $ph . '@messaging.sprintpcs.com';
        break;
    case 'tmobile':
        $to = $ph . '@tmomail.net';
        break;
    case 'verizon':
        $to = $ph . '@vtext.com';
        break;
    case 'virgin':
        $to = $ph . '@vmobl.com';
        break;      
    default:
        error("No carrier selected, message not sent!");
}

$subject = "Buseto's Pizzeria";
$message = "1851 Sunrise Highway, Bay Shore, NY 11706 (631) 665-4939 http://www.busetopizza.com";

mail($to, $subject, $message);
    echo "Your message has been sent!";
    exit();
function error($msg){
    echo "An error has occurred: ".$msg;
    exit();
}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:24:34.040

垃圾邮件是互联网速度不如预期的主要原因。你真的想贡献 6 倍于你*应该*发送的电子邮件数量，以消除对一个小下拉菜单的需要吗？

为了回答这个问题，可以通过正确分隔多个收件人来指定多个收件人，如果没有记错的话，这是用分号完成的。所以你的`to`参数看起来像`"test@example.com;other@example2.com"`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:35:02.223

运营商电子邮件 -> 短信桥并不是特别健壮。如果发送 SMS 对您的业务很重要，那么使用[Twilio 的 SMS API 之](http://www.twilio.com/api/sms)类的东西可能是个好主意。（如果您的企业确实是一家比萨店，那么他们的电话 API 可能也很有趣！）

# jquery - 图像滑块在 ajax 加载的内容中不起作用

> ID：10903559
> 
> 赞同：2
> 
> 时间：2012-06-05T19:22:14.060
> 
> 标签：jquery, ajax, wordpress

```
jQuery(document).ready(function($) {
var $mainContent = $("#main_class"),
    siteUrl = "http://" + top.location.host.toString(),
    url = ''; 
$(document).delegate("a[href*='/classes/']:not([href*=/wp-admin/]):not([href*=/wp-login.php]):not([href$=/feed/]):not([href$=/event-registration/])", "click", function() {
    location.hash = this.pathname;
    return false;
}); 

$(window).bind('hashchange', function(){
    url = window.location.hash.substring(1); 
    if (!url) {
        return;
    } 
    url = url + " #main"; 
    $mainContent.animate({opacity: "0.1"}).html('Please wait...').load(url, function() {
        $mainContent.animate({opacity: "1"});
    });
});
$(window).trigger('hashchange');
$('#slider').royalSlider({            
           imageAlignCenter:true,
           imageScaleMode: "fill",
}); 
```

});

ajax 内容工作完美，但是当我将内容加载到 ajax div 时，滑块（皇家滑块）不起作用。如何修改代码以实现皇家滑块。我使用 wordpress 和定制设计的主题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T03:13:08.230

如果没有一些上下文和一些 HTML 代码，我无法确定，但我认为您需要`$('#slider').royalSlider(...);`在加载新内容后再次调用。

当你第一次调用这个函数时，你的目标是`#slider`当前在 DOM 中。当您使用 ajax 调用加载新内容时，您删除了此元素并将其替换为新元素。我相信你只需要再次初始化你的滑块。

# php - 将 base64 编码图像存储在数据库中是否明智？

> ID：10903567
> 
> 赞同：4
> 
> 时间：2012-06-05T19:22:38.670
> 
> 标签：php, android, image, base64

我正在制作一个 android 应用程序，它拍摄照片并将图像（作为 base64 编码字符串）推送到 PHP 脚本，从这里我将在 MySQL 数据库中存储有关图像的数据。

将图像存储在数据库中是否明智（因为它是作为 base64 字符串传递的），将其转换回图像并将其存储在文件系统中会更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:25:09.417

A base64 encoded image takes too much place (about 33% more than the binary equivalent).

MySQL offers binary formats (BLOB, MEDIUM_BLOB), use them.

Alternatively, most people prefer to store in the DB only a key to a file that the filesystem will store more efficiently, especially if it's a big image. That's the solution I prefer for the long term. I usually use a SHA1 hash of the file content to form the path to the file, so that I have no double storage and that it's easy to retrieve the record from the file if I want to (I use a three level file tree, first two levels being made respectively from the first two characters and the characters 3 and 4 of the hash so that I don't have too many direct child of a directory). Note that this is for example the logic of the git storage.

The advantage of storing them in the DB is that you'll manage more easily the backups, especially as long as your project is small. The database will offer you a cache, but your server and the client too, it's hard to decide a priori which will be fastest and the difference won't be big (I suppose you don't make too many concurrent write).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:32:05.973

我已经完成了这两种方式，每次我回到将二进制数据存储在 MySQL 表中的代码时，我总是使用 MySQL 表中的指针将其切换到文件系统。

在性能方面，使用 FS 会好得多，因为从 MySQL 服务器中提取多个大型 BLOB 会很快使其管道饱和。通常它是您不想堵塞的管道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T19:45:40.953

您始终可以将其保存`base64_encode($image)`在文件中，仅将文件路径存储在数据库中，然后用于`fopen()`获取编码图像。

如果我没有正确理解这个问题，我深表歉意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T19:27:09.673

我认为“明智”是相当主观的。我认为从“阻止人们直接链接到我的图像”的角度来看这是明智的。此外，如果您决定需要更改目录结构等，它可能会有所帮助。它*可能*会让您更轻松（但这实际上取决于您如何编写脚本开始......）但除此之外......我真的想不出这样做有什么好处。

# ios - iOS 每天运行一次代码

> ID：10903568
> 
> 赞同：27
> 
> 时间：2012-06-05T19:22:41.287
> 
> 标签：ios, timer, background

这个应用程序背后的想法很简单：下载一个文件。但是，此应用程序适用于并不总是在互联网访问范围内的人，因此我需要它知道在上午 9:00 时将文件下载到硬盘驱动器。应用程序中也会有一个按钮可以手动完成，但我已经开始工作了。

据我了解，即使有可能，这也将很困难。我知道 iOS 不喜欢多任务处理，但我也知道它确实允许后台计时器功能。我愿意接受任何人可能必须完成此任务的任何建议，即使这意味着编写一个单独的应用程序。谢谢。

编辑：我看到有可能使用通知，甚至可能是日历。该类别的想法也受到欢迎。

编辑 2：我还阅读了一些关于启动应用程序的外部服务器的内容，但没有给出描述。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-05T20:07:41.947

这是与应用程序安排某些活动定期发生有关的后台执行以及通知和计时器等的情况。

1.  应用程序无法在后台执行，除非：

    1.  它要求操作系统提供额外的时间来执行此操作。这是使用`beginBackgroundTaskWithExpirationHandler`. Apple 没有（有意）指定这个额外的时间有多长，但实际上它大约是 10 分钟。

    2.  一个应用程序有一个后台模式，模式是：voip、音频、位置、报摊。即使它具有其中一种类型，应用程序也无法在没有某些限制的情况下执行。本讨论的其余部分假设应用程序没有后台模式。

2.  当一个应用程序被暂停时，它不能做任何事情来直接唤醒自己。它以前不能安排一个 NSTimer，它不能使用像 performSelector:afterDelay 这样的东西。等等

    应用程序可以再次激活的唯一方法是用户执行某些操作使其激活。用户可以通过以下方式执行此操作：

    1.  直接从其图标启动应用程序

    2.  启动应用程序以响应应用程序先前在其处于活动状态时安排的本地通知。

    3.  启动应用程序以响应服务器发送的远程通知。

    4.  其他一些：例如，如果应用程序注册为处理通过 url 启动，则 URL 启动；或者如果它注册为能够处理某种类型的内容。

如果本地/远程通知触发时应用程序处于前台，则应用程序直接接收它。

如果在本地/远程通知触发时应用程序当前不在前台，则应用程序不会收到它。通知触发时没有执行任何代码！

只有当用户选择通知时，应用才会激活并且可以执行。

请注意，用户可以为整个设备或仅针对特定应用程序禁用通知，在这种情况下，用户将永远看不到它们。如果在通知即将触发时关闭设备，则它会丢失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:49:35.017

您可以使用本地通知。当用户打开显示的通知时，它们会执行代码。您可以将本地通知设置为以指定的时间间隔（例如每天、每小时、每周等）重复。这仍然需要用户打开应用程序才能开始该过程。

[UILocalNotification 类参考](http://developer.apple.com/library/ios/#documentation/iphone/Reference/UILocalNotification_Class/Reference/Reference.html)

一旦委托方法触发，您只有几秒钟的时间来执行代码。注册一个长时间运行的后台任务，然后下载你需要做的任何事情。如果它不能在你为任务获得的 10 分钟内完成下载，那么你需要重新考虑你的下载策略。

[Apple 多任务处理和后台处理](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)

我们在我工作的 iOS 应用程序上使用了相同的概念，因此如果您设置正确，这将起作用。

**更新**

对于那些好奇这将如何工作的人，您只需要实现 UILocalNotification 委托方法。它们继承自应该已经存在的 UIApplicationDelegate。

```
-(void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification {
// start your long running bg task here and update your file

} 
```

** 更新 2 **

Martin H 的回答是迄今为止最正确的。但这引出了一个问题，如果用户从不打开应用程序，那么下载他们永远不会看到的数据有什么意义呢？提醒他们打开应用程序和更新的重复本地通知可能是最好的方式，但如果用户希望它保持最新和最新，仍然需要用户与您的应用程序进行交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:31:50.037

后台应用程序有一个固定的时间限制（我相信 10 分钟，但不要引用我的话，它可能会更少）来完成他们正在处理的任何事情。您将无法使用后台任务来做您想做的事。

您可以做的是使用上次下载的日期设置 NSUserDefault。在启动时检查保存的日期，如果日期不是当前日期，并且是在上午 9:00 之后，则以编程方式启动下载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T19:36:39.800

我很确定这是不可能的，您最多可以做的是向用户发送推送通知，以便他们在需要时手动更新。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-12-30T10:37:06.687

您是否尝试过以下操作？

```
if ([[[UIDevice currentDevice] systemVersion] floatValue] >=7.0)
    [[UIApplication sharedApplication] setMinimumBackgroundFetchInterval:600];

- (void)application:(UIApplication *)application performFetchWithCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler {
    completionHandler(UIBackgroundFetchResultNewData);
} 
```

# objective-c - 如何将 CGContext 状态存储在 NSMutableArray 中？

> ID：10903571
> 
> 赞同：0
> 
> 时间：2012-06-05T19:22:46.670
> 
> 标签：objective-c, ios, nsmutablearray, cgcontext, cgcontextref

我是 CGContext 世界的新手。我需要在 NSMutableArray 中创建一堆 CGContext(s)。

1.  我有一个使用 UIGraphicsBeginPDFContextToData 创建的有效 PDFContext

2.  我将此上下文作为参数传递给方法

    `-(void) drawTo:(CGContextRef) context{}`

3.  首先，我通过以下方式确定当前上下文：

    `CGContextRef curCon = context;`

4.  NSLog 值：

    `context:<CGContext 0x6b79d60>`

5.  然后我尝试复制当前上下文：

    `CGContextRef conCopy = UIGraphicsGetCurrentContext();`

6.  然后我将它添加到我的 NSMutableArray 中：

    `[myMutableArray* addObject:(id)conCopy];`

7.  然后我列出了 NSMutableArray 的内容：

    `after an object added:<__NSArrayM 0x6b7e850>(<CGContext 0x6b79d60>)`

而且我看到添加的值与最初作为参数而不是副本发送到此方法的上下文相同。

我在这里想念什么？或者可能无法将当前上下文的状态存储在 NSMutableArray 中？我知道路径不会被保存，这很好。我需要保存有关可以保存的当前上下文的所有内容。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:26:11.997

你不能直接这样做。但你要解决的真正问题是什么？`CGContextSaveGState()`做你所要求的，但只在当前上下文的范围内。`CGLayer`可以有效地创建您可以随身携带的上下文（尽管您仍然无法序列化它们）。

如果您的真正目标是以可复制的形式保存非路径状态，那么您可以通过调用所有`CGContextGet...`方法并存储它们的结果来创建可复制对象。然后你可以调用`CGContextSet...`他们来创建一个新的上下文。这很乏味，但应该不难。（虽然它确实提出了为什么的问题。这感觉像是一件很奇怪的事情。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:26:53.123

`UIGraphicsGetCurrentContext`不创建副本。返回的上下文是您使用创建的`UIGraphicsBeginPDFContextToData`。

# html - 如何右对齐li？

> ID：10903574
> 
> 赞同：2
> 
> 时间：2012-06-05T19:23:05.873
> 
> 标签：html, css, drop-down-menu

我正在尝试在我的网站上制作一个下拉菜单。我希望能够单击向下箭头并在其下方弹出一个菜单。现在菜单只显示在屏幕上的一部分。

这是一张图片来显示现在发生的事情：

![在此处输入图像描述](../Images/182194755762bb0a5ece774c3ddbc15d.png)

我希望菜单项的右侧与向下箭头对齐，而不是像左侧那样。

这是我现在正在使用的 CSS。

```
* {
margin: 0;
padding: 0;
border: 0;
}

body {
    background-image: url(bg.jpg);
    background-position: center;
    background-repeat: repeat;  

}

#top {
    background-color: #333;
    height: 30px;
    margin-bottom: 10px;
}
#menu {
    color: #CCC;
    height: 30px;
    font-family: Arial, Helvetica, sans-serif;
    font-weight: bold;
    font-size: 12px;
    position: absolute;
}
#top_right {
    height: 30px;
    width: auto;
    text-align: left;
    float: right;
    margin-right: 5px;
    color: #CCC;
    font-family: Arial, Helvetica, sans-serif;
    font-weight: bold;
    font-size: 12px;
}

.menu {
    padding-left: 10px;
}
a.mlink:hover {
    color: #FFF;
    text-decoration: none;
}
a.mlink:link {
    color: #CCC;
    text-decoration: none;
}
a.mlink:visited {
    color: #CCC;
    text-decoration: none;
}
a.mlink:hover {
    color: #FFF;
    text-decoration: none;
}
a.mlink:active {
    color: #CCC;
    text-decoration: none;
}
#selected {
    color: #6C0;
}
#content {
    background-color: #CCC;
}

/*
START OF MENU TEST
*/
#esempio{

margin:0;

padding:0;

}

#esempio ul{

padding:0;

margin:0;

}

#esempio li{

position: relative;

float: left;

list-style: none;

margin: 0;

padding:0;

}

#esempio li a{

width:auto;

height: 30px;

display: block;

text-decoration:none;

text-align: center;

line-height: 30px;

background-color: black;

color: white;

}

#esempio li a:hover{

background-color: #666;

}

#esempio ul ul{

position: absolute;

top: 30px;

width: 100px;

visibility: hidden;

}

#esempio ul li:hover ul{

visibility:visible;

}

/*
END OF MENU TEST
*/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:27:24.020

包含元素需要定位：

```
li {
    position: relative;
} 
```

然后可以将您的下拉元素定位为与其容器的右侧齐平：

```
li .submenu {
    position: absolute;
    right: 0;
} 
```

如果没有看到标记或您的页面如何运行的示例，我不能更具体。

小提琴：http: [//jsfiddle.net/jonathansampson/CXbTX/](http://jsfiddle.net/jonathansampson/CXbTX/)

### 边注

顺便说一句，我会避免这样做：

```
* { margin: 0; padding: 0; border: 0 } 
```

这会让你有些沮丧，尤其是在设计表单元素等方面。我会鼓励你改用可以以更直观的方式规范化 CSS 的东西，比如[Meyer's Reset](http://meyerweb.com/eric/tools/css/reset/)。

# objective-c - Can I release an object created outside a block that uses it before the block is run?

> ID：10903577
> 
> 赞同：2
> 
> 时间：2012-06-05T19:23:14.410
> 
> 标签：objective-c, memory-management, objective-c-blocks

Can `myArray` be safely released before the block?

```
NSMutableArray *myArray = [[NSMutableArray alloc] init];
[myArray addObject:@"a"];
[myArray addObject:@"b"];

// releasing here causes an invalid object to be used inside the block?
[myArray release];

CCCallBlock *block = [CCCallBlock actionWithBlock:^{
    // print myArray contents to console
}];

[myNode runAction:block]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:28:20.673

不，您不能在块之前释放数组，因为数组内部的对象和数组本身在释放调用之后将不可用，在您的块有机会保留它之前。

您可以使您的数组自动释放，在这种情况下，释放将在函数退出后发生。

```
NSMutableArray *myArray = [NSMutableArray array];
[myArray addObject:@"a"];
[myArray addObject:@"b"];

CCCallBlock *block = [CCCallBlock actionWithBlock:^{
    // print myArray contents to console
}];

[myNode runAction:block]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-06T02:45:37.983

为了补充其他人所说的，没有`autorelease`，您可以在创建块后释放该数组，如果您之后不再使用该数组。

```
NSMutableArray *myArray = [[NSMutableArray alloc] init];
[myArray addObject:@"a"];
[myArray addObject:@"b"];

CCCallBlock *block = [CCCallBlock actionWithBlock:^{
    // print myArray contents to console
}];
[myArray release];

[myNode runAction:block]; 
```

该块在创建时保留捕获的对象（数组）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T19:28:02.047

不，您将在块中保留一个悬空指针。

# android - I can´t see returned image - PhoneGap

> ID：10903578
> 
> 赞同：0
> 
> 时间：2012-06-05T19:23:16.847
> 
> 标签：android, image, cordova, camera

Where I make mistakes? I would like to see image after save button click. I see only white screen without returned image. I am using Android and Galaxy S device.

```
$(function(){       

    document.addEventListener("deviceready", phonegapLoaded, false);

    function phonegapLoaded(){

    }

    $("#vyfotit").click(function(){

            navigator.camera.getPicture(onSuccess, onError, {quality: 70, destinationType: Camera.DestinationType.FILE_URI});                       

        });

    function onSuccess(imageURI){

        var image = document.getElementById("image");

        image.src = imageURI;

        image.style.display = block;

        }

    function onError(message){

        navigator.notification.alert("Failed because: " + message);

    }    
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:58:06.657

在 AndroidManifest.xml 中包含访问相机的权限

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T03:59:41.473

是否有带有 id 图像的元素？我看到这不起作用的唯一原因是该元素在 DOM 中不存在。

# java - “IllegalFormatConversionException：d！= java.lang.String”用0填充数字时？

> ID：10903579
> 
> 赞同：19
> 
> 时间：2012-06-05T19:23:17.467
> 
> 标签：java, regex, string-formatting

昨天我有一个完美的工作代码，确切的形式是：

```
int lastRecord = 1;
String key = String.format("%08d", Integer.toString(lastRecord)); 
```

这会将它很好地填充到 00000001。

现在我通过 twoKeyChar 从表中获取字符串和 lastRecord 从表中获取 int 将其提升了一个档次。

正如你所看到的，这个概念本质上是相同的——我将一个 int 转换为一个字符串并尝试用 0 填充它；但是，这次我收到以下错误：

```
java.util.IllegalFormatConversionException: d != java.lang.String 
```

代码如下：

```
String newPK = null;
String twoCharKey = getTwoCharKey(tablename);
if (twoCharKey != null) {
     int lastRecord = getLastRecord(tablename);
     lastRecord++;
     //The println below outputs the correct values: "RU" and 11\. 
     System.out.println("twocharkey:"+twoCharKey+"record:"+lastRecord+"<");
     //Now just to make it RU00000011
     newPK = String.format("%08d", Integer.toString(lastRecord));
     newPK = twoCharKey.concat(newPK);
} 
```

我觉得我一定是输入了错误的东西，因为自从它上次工作以来没有理由让它崩溃。任何帮助/提示表示赞赏！谢谢你！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-05T19:24:44.587

你不需要`Integer.toString()`：

```
 newPK = String.format("%08d", lastRecord); 
```

`String.format()`将进行转换和填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-30T11:46:35.653

聚会很晚。

`String.format();`如果即使在实施接受的答案后您仍然面临代码问题。

这对我不起作用：

```
String.format("%08d", stringvariable); 
```

因为两个原因：

1.  `d`对于小数点而不是字符串，它不会像预期的那样工作。
2.  如果我使用它，使用`%8d`而不是`%08d`作为格式化程序对我不起作用`%08d`

如果您将基于字符串的变量与字符串数据一起使用。用这个。

```
String.format("%8s", stringvariable); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-02-09T07:46:31.827

它对我有用，这里应该是整数 12 应该是整数。

```
String.format("%04d", Integer.parseInt("12")); 
```

输出 - 0012

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-23T13:26:49.113

在 Android 中，您应该替换`%1$s ... %d ... %.2f`为`%1$s ... %2$d ... %3$.2f`.

这样你就可以避免`java.util.IllegalFormatConversionException: d != java.lang.String`和`f != java.lang.String`异常。

# ruby-on-rails - 有没有办法将设计用户从一个应用程序迁移到另一个应用程序（仍在使用设计？）

> ID：10903583
> 
> 赞同：0
> 
> 时间：2012-06-05T19:23:43.317
> 
> 标签：ruby-on-rails, ruby, devise

我有一个使用 devise 的旧版 Rails 应用程序，有数百名用户。我需要将这些用户迁移到一个全新的应用程序，运行 devise 和 rails 3.2。有什么好的方法可以做到这一点？如何处理加密的密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:35:20.933

查看设备升级说明 [https://github.com/plataformatec/devise/wiki/How-To:-Upgrade-to-Devise-2.0](https://github.com/plataformatec/devise/wiki/How-To:-Upgrade-to-Devise-2.0)

# git - Clear git log file

> ID：10903584
> 
> 赞同：12
> 
> 时间：2012-06-05T19:23:52.693
> 
> 标签：git, logging, delete-file

I want to clear the git log files so that the command `git log` returns nothing. Is this possible? Is this recommended?

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-05T19:41:50.377

```
 ______________________________    . \  | / .
     /                            / \     \ \ / /
    |                            | ==========  - -    WARNING!
     \____________________________\_/     / / \ \
  ______________________________      \  | / | \      THIS WILL DESTROY
 /                            / \     \ \ / /.   .    YOUR REPOSITORY!
|                            | ==========  - -
 \____________________________\_/     / / \ \    /
      ______________________________   / |\  | /  .
     /                            / \     \ \ / /
    |                            | ==========  -  - -
     \____________________________\_/     / / \ \
                                        .  / | \  . 
```

`git log`显示项目的更改历史。如果您真的想丢弃所有这些历史，您可以...

```
rm -rf .git
git init 
```

...但在少数情况下，这确实是有意义的。

git 没有使用任何“git 日志文件”来生成此输出；它正在遍历构成项目历史的对象数据库。如果您`.git`像这样删除目录，则无法返回：

*   您将无法从存储库中检索以前版本的文件；
*   您将无法看到文件随时间的变化；
*   您将无法恢复意外删除的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-27T20:36:22.630

基本上你想要做的是删除包含日志的文件，即你的“.git”文件。

1.  rm -rf .git // 这表示递归地删除 git 文件。
2.  git init // 这使文件夹再次成为 git repo。

# sql - 将多个 CASE 语句连接成一个别名

> ID：10903588
> 
> 赞同：0
> 
> 时间：2012-06-05T19:24:04.270
> 
> 标签：sql, tsql, sql-server-2005

在一些关于如何解决我在使用一些遗留代码时遇到的问题的先前帮助之后，似乎解决我的问题的最佳方法是连接 case 语句以返回一个我可以在 PHP 中解析出的值。

我正在尝试做这样的事情，但它返回了很多行，并最终得到了这个错误：

> 超出最大存储过程、函数、触发器或视图嵌套级别（限制 32）。

```
SELECT org.org_id,
       org.org_name_1,
       Datename(YEAR, member.enroll_date) AS enroll_year,
       Max(CASE
             WHEN board.member_from IS NULL THEN 0
             ELSE 1
           END)                           AS board_member,
       CASE
         WHEN ( org.delete_reason = 'OUT'
                AND org.org_delete_flag = 'Y'
                AND org.org_status_flag = 'C' ) THEN 'out_of_business|'
         ELSE ''
       END + CASE
               WHEN ( stat.carrier = 'BS'
                      AND stat.status_id IS NOT NULL
                      AND stat.termination_date IS NULL
                      AND stat.flat_dues > 0 ) THEN 'insurance_member|'
               ELSE ''
             END + CASE
                     WHEN ( stat.carrier = 'BS'
                            AND stat.status_id IS NOT NULL
                            AND stat.termination_date IS NULL
                            AND stat.flat_dues = 0
                            AND member.status_flag IN( 'C', 'P' ) ) THEN 'insurance_product|'
                     ELSE ''
                   END + CASE
                           WHEN ( member.enroll_date IS NOT NULL
                                  AND member.status_flag NOT IN( 'C', 'P' ) ) THEN 'member_since|'
                           ELSE ''
                         END + CASE
                                 WHEN ( org.org_relationship_parent = 'Y'
                                        AND org.dues_category = 'MBR'
                                        AND org.org_status_flag = 'R' ) THEN 'subsidiary_member|'
                                 ELSE ''
                               END + CASE
                                       WHEN ( org.org_misc_data_9 = 'PAC' ) THEN 'pac|'
                                       ELSE ''
                                     END + CASE
                                             WHEN ( org.dues_category = 'PART' ) THEN 'partner_member|'
                                             ELSE ''
                                           END + CASE
                                                   WHEN ( org.dues_category = 'FREE'
                                                          AND org.org_status_flag = 'P' ) THEN 'associate_member|'
                                                   ELSE ''
                                                 END
                                          --ELSE 'non_member'
                                          --END 
                                          AS org_status,
       60                                 AS expires_in,
       CASE
         WHEN stat.dues_type = 'M' THEN
           CASE
             WHEN ( stat.termination_date IS NULL ) THEN ( stat.flat_dues )
             ELSE 0
           END
         ELSE
           CASE
             WHEN ( member.payments = 0 ) THEN member.dues_billed_annual
             ELSE member.payments
           END
       END                                AS dues_level,
       CASE
         WHEN ( org.affiliate_code = 'PCCE'
                AND org.dues_category = 'MBR'
                AND org.org_status_flag = 'R' ) THEN 1
         ELSE 0
       END                                AS pcce_membr,
       --          '$'+CONVERT(VARCHAR,@dues) AS dues_level,
       Ltrim(@product_level)              AS product_level,
       Ltrim(@involve_level)              AS involvement_level
FROM   organiz AS org
       LEFT JOIN affilbil AS member
         ON member.status_id = org.org_id
            AND member.dues_category = 'MBR'
       LEFT JOIN individu AS ind
         ON ind.org_id = org.org_id
       LEFT JOIN commembr AS board
         ON board.status_id = ind.ind_id
            AND board.committee_code = '5'
            AND board.member_to IS NULL
       LEFT JOIN statinsmorn AS stat
         ON stat.status_id = org.org_id
            AND stat.carrier = 'BS'
            AND stat.planz = 'PCI'
WHERE  org.org_id = @org_id
GROUP  BY org.org_id,
          org.org_name_1,
          member.enroll_date,
          org.delete_reason,
          org.org_status_flag,
          org.org_delete_flag,
          stat.status_id,
          stat.flat_dues,
          stat.dues_type,
          stat.termination_date,
          org.org_misc_data_9,
          org_relationship_parent,
          org.dues_category,
          member.status_flag,
          member.dues_billed_annual,
          member.payments,
          stat.carrier,
          org.Affiliate_Code 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T12:44:23.023

嗯，这很尴尬。

当我对存储过程进行更改时，我无意中在底部调用了相同的过程。所以我一遍又一遍地递归调用相同的过程。卫生部。

# sed - 如何匹配日期 mm/dd/yyyy

> ID：10903595
> 
> 赞同：0
> 
> 时间：2012-06-05T19:24:35.210
> 
> 标签：sed

给定以下输入

```
506028500,1820196768,43,0,84552257, ,1,-71.16,42.42,04/26/2012, 
```

我想过滤行尾的日期，所以我可以将它的 mm/dd/yyyy 格式更改为 MySQL 日期格式 yyyy-mm-dd：

我试图匹配行末尾的日期，首先删除了尾随的“，”（逗号）。

```
{
    s/,$//g
    /\([0-9][0-9]\)\/\([0-9][0-9]\)\/\([0-9][0-9][0-9][0-9]\)$/=
} 
```

我得到 12847，但我期待 04262012。

我做错了什么，我什至无法匹配那里的日期？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T20:30:50.030

这可能对您有用：

```
echo "506028500,1820196768,43,0,84552257, ,1,-71.16,42.42,04/26/2012," | 
sed 's|,\(..\)/\(..\)/\(....\),$|,\3-\2-\1,|'
506028500,1820196768,43,0,84552257, ,1,-71.16,42.42,2012-26-04, 
```

如果你只想要日期：

```
echo "506028500,1820196768,43,0,84552257, ,1,-71.16,42.42,04/26/2012," | 
sed 's|.*,\(..\)/\(..\)/\(....\),$|\3-\2-\1|'
2012-26-04 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:34:41.770

这对我有用：

```
sed "s/\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\)$/\3-\1-\2/g" someFile.txt 
```

至少它将日期字符串替换为所需格式之一。

要仅在最后打印日期，以下对我有用：

```
sed "s/.*\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\)$/\3-\1-\2/g" someFile.txt 
```

# c++ - 为什么 virtual 关键字会增加派生类的大小？

> ID：10903596
> 
> 赞同：4
> 
> 时间：2012-06-05T19:24:39.730
> 
> 标签：c++, virtual-functions, virtual-inheritance, memory-layout

我有两个类 - 一个基类和一个派生自它：

```
class base {

 int i ;

  public :
  virtual ~ base () { }
};

class derived :  virtual public base { int j ; };

main()

{ cout << sizeof ( derived ) ; } 
```

这里的答案是 16。但是如果我改为使用非虚拟公共继承或使基类非多态，那么我得到的答案是 12，即如果我这样做：

```
class base {

 int i ;

 public :
virtual ~ base () { }
};

class derived :  public base { int j ; };

main()

{ cout << sizeof ( derived ) ; } 
```

或者

```
class base {

int i ;

public :
~ base () { }
};

class derived :  virtual public base { int j ; };

main()

{ cout << sizeof ( derived ) ; } 
```

在这两种情况下，答案都是 12。

有人可以解释为什么派生类的大小在第一种和其他两种情况下有所不同吗？

（我在 code::blocks 10.05 工作，如果有人真的需要这个）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:17:56.733

这里有两件事会导致额外的开销。

首先，在基类中拥有虚函数会增加一个指针大小（在这种情况下为 4 个字节），因为它需要存储指向虚方法表的指针：

```
normal inheritance with virtual functions:

0        4       8       12
|      base      |
| vfptr  |  i    |   j   | 
```

其次，在虚拟继承中需要额外的信息`derived`才能定位`base`。在正常继承中，`derived`和之间的偏移量`base`是编译时间常数（0 表示单继承）。在虚拟继承中，偏移量可以取决于对象的运行时类型和实际类型层次结构。实现可能会有所不同，但例如 Visual C++ 会这样做：

```
virtual inheritance with virtual functions:

0        4         8        12        16
                   |      base        |
|  xxx   |   j     |  vfptr |    i    | 
```

Where`xxx`是指向某些类型信息记录的指针，它允许确定到`base`.

当然，也可以在没有虚函数的情况下进行虚继承：

```
virtual inheritance without virtual functions:

0        4         8        12
                   |  base  |
|  xxx   |   j     |   i    | 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T07:36:06.503

如果一个类有任何虚函数，那么这个类的对象需要有一个vptr，它是一个指向vtable的指针，也就是可以从中找到正确虚函数地址的虚表。调用的函数取决于对象的**动态类型**，它是该对象作为基子对象的最派生类。

因为派生类实际上继承自基类，所以基类相对于派生类的位置不是固定的，它也取决于对象的动态类型。使用 gcc，具有虚拟基类的类需要一个 vptr 来定位基类（即使没有虚拟函数）。

此外，基类包含一个数据成员，它位于基类 vptr 之后。基类内存布局为：{ vptr, `int`}

如果基类需要 vptr，则从它派生的类也需要 vptr，但通常会重用基类子对象的“第一个”vptr（这个具有重用 vptr 的基类称为主基类）。但是在这种情况下这是不可能的，因为派生类需要一个 vptr 不仅要确定如何调用虚函数，还要确定虚基在哪里。派生类在不使用 vptr 的情况下无法定位其虚拟基类；如果将虚拟基类用作主基类，*则派生类将需要定位其主基类以读取 vptr，并且需要读取 vptr 以定位其主基类*。

所以**派生不能有一个主要的基础，它引入了自己的 vptr**。

因此，类型的**基类子对象**的布局`derived`是： { vptr, `int`} 其中 vptr 指向**一个用于派生的 vtable**，不仅包含虚函数的地址，还包含其所有虚基类的相对位置（这里只是`base`） ，表示为偏移量。

**一个完整**的类型对象的布局`derived`是：{ 类型的基类子对象`derived`，`base`}

所以最小**可能的**大小`derived`是 (2 `int`+ 2 vptr) 或常见 ptr = `int`= 字架构上的 4 个字，或在这种情况下为 16 个字节。（而且 Visual C++ 会生成更大的对象（当涉及到虚拟基类时），我相信 a`derived`会有更多的指针。）

所以是的，**虚函数是有代价的，而虚拟继承是有代价的。在这种情况下，虚拟继承的内存成本是每个对象多一个指针。**

在具有许多虚拟基类的设计中，每个对象的内存成本可能与虚拟基类的数量成正比，或者不成正比；我们需要讨论特定的类层次结构来估算成本。

在没有多重继承或虚拟基类（甚至虚拟函数）的设计中，您可能必须模拟编译器为您自动完成的许多事情，使用一堆指针，可能是指向函数的指针，可能是偏移量......这可能会得到令人困惑和容易出错。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T19:34:45.217

发生的事情是用于将类标记为具有虚拟成员或涉及虚拟继承的额外开销。多少额外取决于编译器。

一个警告：让一个类从析构函数不是虚拟的类派生通常是自找麻烦。大麻烦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-05T19:47:29.517

在运行时可能需要额外的 4 个字节来标记类类型。例如：

```
class A {
 virtual int f() { return 2; }
}

class B : virtual public A {
 virtual int f() { return 3; }
}

int call_function( A *a) {
   // here we don't know what a really is (A or B)
   // because of this to call correct method
   // we need some runtime knowledge of type and storage space to put it in (extra 4 bytes).
   return a->f();
}

int main() {
   B b;
   A *a = (A*)&b;

   cout << call_function(a);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-05T21:29:43.343

虚拟继承的重点是允许共享基类。这是问题所在：

```
struct base { int member; virtual void method() {} };
struct derived0 : base { int d0; };
struct derived1 : base { int d1; };
struct join : derived0, derived1 {};
join j;
j.method();
j.member;
(base *)j;
dynamic_cast<base *>(j); 
```

最后4行都是模棱两可的。您必须明确是要在 derived0 中使用 base，还是在 derived1 中使用 base。

如果您按如下方式更改第二行和第三行，问题就会消失：

```
struct derived0 : virtual base { int d0; };
struct derived1 : virtual base { int d1; }; 
```

您的 j 对象现在只有一个 base 副本，而不是两个副本，因此最后 4 行不再模棱两可。

但请考虑如何实施。通常，在derived0 中，d0 在m 之后，而在derived1 中，d1 在m 之后。但是对于虚拟继承，它们都共享相同的 m，所以你不能让 d0 和 d1 都紧随其后。所以你需要某种形式的额外间接。这就是额外指针的来源。

如果您想确切地知道布局是什么，这取决于您的目标平台和编译器。仅仅“gcc”是不够的。但是对于许多现代非 Windows 目标，答案是由 Itanium C++ ABI 定义的，它记录在[http://mentorembedded.github.com/cxx-abi/abi.html#vtable](http://mentorembedded.github.com/cxx-abi/abi.html#vtable)中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T20:17:17.910

额外的大小是由于 vtable/vtable 指针“不可见地”添加到您的类中，以便为此类的特定对象或其后代/祖先保存成员函数指针。

如果不清楚，您需要阅读更多有关 C++ 中虚拟继承的内容。

# javascript - Dealing with date in different language using datapicker and moments

> ID：10903599
> 
> 赞同：8
> 
> 时间：2012-06-05T19:24:45.987
> 
> 标签：javascript, datepicker, jquery-ui-datepicker, momentjs

I have a web site which, depending on the location, allows to set the date in different language:

Example:

```
Mercredi, Juin 06, 2012 // french
Wednesday, Jun 06, 2012 // english 
```

Then these dates needs to be saved on the server using momentjs

```
moment('Tuesday, Jun 05, 2012').format(); // 2012-06-05T00:00:00+02:00
moment('Mercredi, Juin 06, 2012').format(); // NaN-NaN-NaNTNaN:NaN:NaN+00:00 
```

How can I fix this issue when the user is using a different language from the english?

P.S.:
Not sure if it can helps...
with momentsjs is possible to set the lang in this way, but the problem persists:

```
moment.lang('fr');
moment('Mercredi, Juin 06, 2012').format(); // NaN-NaN-NaNTNaN:NaN:NaN+00:00 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T20:38:05.910

缺少两件事：

1.  加载适当的[语言文件](https://github.com/timrwood/moment/tree/master/lang)。

2.  引用文档：“您可以从可由 Date.parse 解析的字符串创建时刻”[moment(String)] 或“如果您知道输入字符串的格式，则可以使用它来解析时刻" [时刻（字符串，字符串）]。因此，如果 Date.parse 不理解，则需要将日期格式作为第二个参数。

这应该可以工作：

```
moment.lang("fr");
moment('Mercredi, Juin 06, 2012', "dddd, MMMM DD, YYYY").format(); 
```

也看到这个[jsFiddle](http://jsfiddle.net/nNwfW/2/)

# kml - Google Earth will not open links in KML that have spaces

> ID：10903600
> 
> 赞同：3
> 
> 时间：2012-06-05T19:24:47.930
> 
> 标签：kml, google-earth

I am creating KML files from an ArcMap layer that uses XSLT to generate an HTML popup with custom links to file folders. Some of these links have embedded spaces. When I try to open these links in Google Earth, it does nothing. I have tried encoding spaces as %20 and still GE will not open them. It opens links without spaces just fine.

Here is a link from my KML that works fine:

```
<a target="_blank" href="file:///C:/Land/ce">Central Wildlife District</a> 
```

Here are a couple that don't:

```
<a target="_blank" href="file:///C:/Land/ce/Sites/AIKENS%20CR">AIKENS CR</a>
<a target="_blank" href="file:///C:/Land/ce/Sites/AIKENS CR">AIKENS CR</a> 
```

I found a 6-year old problem report on Google Groups (https://groups.google.com/forum/?fromgroups#!topic/kml-support-getting-started/8PfajmyJbiY) that claimed this would be fixed soon. Is it really still a problem?

Has anyone managed to figure out a way to make links with spaces work in Google Earth KML?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:08:12.560

过去，文件名和文件夹中的空格和特殊字符在 GE 中产生了问题：

*   错误 #990：[当图像文件夹名称包含空格时，气球图像查看器将无法打开](https://code.google.com/p/earth-issues/issues/detail?id=990)

*   错误 #1014：[如果 KMZ 的路径包含空格，则不会显示 KMZ 文件中的嵌入图像](https://code.google.com/p/earth-issues/issues/detail?id=1016)

*   错误 #1126：[GE6 可以保存但无法加载文件名或路径中带有“#”的文件名](https://code.google.com/p/earth-issues/issues/detail?id=1126)

唯一真正的解决方案是简单地避免这种 KML，或者从文件名和路径中删除所有空格，或者用 _ 替换空格字符。

当然，使用 KML 生成时，手动执行此操作通常很痛苦，但如果您希望 KML 在所有平台（Windows、Mac、Linux、Mobile 等）上正确查看，则必须消除文件名和文件夹中的任何“特殊”字符KML 文件引用的内容包括 KMZ 文件中的内容。

这在与KMZ 文件中的文件中的空白相关的[问题中进行了讨论。](http://kml4earth.appspot.com/kmlErrata.html#kmzUrls)

# gcc - GCC and NASM link to external library

> ID：10903603
> 
> 赞同：1
> 
> 时间：2012-06-05T19:25:06.787
> 
> 标签：gcc, command-line, nasm, undefined-reference

I want to create a simple application in Assembly (with NASM) that will get the command line arguments. For now I use `extern _GetCommandLineA` and `call _GetCommandLineA` to call the function. I compile the code and get the object file from NASM. Now I wanna use GCC to link and create the EXE. I don't want to use the standard libraries, so I use this command to build the executable:

```
gcc test.obj -s -nostartfiles -nostdlib -nodefaultlibs -o test.exe 
```

It gets me an `Undefined reference to GetCommandLineA` error and, as a beginner in ASM, I don't know why? Some help would really be appreciated. Thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:36:59.527

`GetCommandLineA`并`GetCommandLineW`在`kernel32.dll`其中定义，与大多数 Windows API 一样，使用[WINAPI (stdcall) 调用约定](http://msdn.microsoft.com/en-us/library/zxk0tw93(v=vs.71).aspx)。

为了从程序集中调用此函数，您需要指定完全“装饰”的符号名称，在这种情况下`_GetCommandLineA@0`

**`_GetCommandLineA`在您的程序集文件中替换为`_GetCommandLineA@0`**

# asp.net - 使用 SqlDataSource 删除时出现空字典错误 - ASP.net ListView

> ID：10903606
> 
> 赞同：4
> 
> 时间：2012-06-05T19:25:11.790
> 
> 标签：asp.net, tsql, listview, concurrency, optimistic-concurrency

我正在尝试制作一个具有乐观并发的简单 ListView。它使用 VS 自动生成的 Delete、Insert、Update 语句（除了 1 处更改为插入：见代码）。插入和编辑工作正常并提交到数据库。尝试删除时，出现此错误：

### *您已指定您的删除命令比较 SqlDataSource 'MySourceHere' 上的所有值，但传入值的字典为空。传入有效字典以删除或将模式更改为 OverwriteChanges。*

我尝试将“CompareAllValues”更改为“OverwriteChanges”以推迟并发工作，但这会“中断”更新和删除命令，这似乎只是用旧值刷新 ListView。我能找到解决此问题的唯一线程涉及更改为“OverwriteChanges”，或者是没有声明“DataKeyNames”的人。相关标记如下（我希望）。

有什么想法吗？

```
<asp:SqlDataSource ID="ManageUsersSource" runat="server" 
    ConflictDetection="CompareAllValues" 
    ConnectionString="<%$ ConnectionStrings:ConnectionString %>" 
        DeleteCommand="DELETE FROM [DUSER] WHERE [userid] = ? AND (([username] = ?) OR ([username] IS NULL AND ? IS NULL)) AND (([userpass] = ?) OR ([userpass] IS NULL AND ? IS NULL))" 
    InsertCommand="INSERT INTO [DUSER] ([username], [userpass]) VALUES (?, ?)" 
    OldValuesParameterFormatString="original_{0}" 
    ProviderName="<%$ ConnectionStrings:ConnectionString.ProviderName %>" 
    SelectCommand="SELECT * FROM [DUSER] ORDER BY [userid] ASC" 
    UpdateCommand="UPDATE [DUSER] SET [username] = ?, [userpass] = ? WHERE [userid] = ? AND (([username] = ?) OR ([username] IS NULL AND ? IS NULL)) AND (([userpass] = ?) OR ([userpass] IS NULL AND ? IS NULL))">
    <DeleteParameters>
        <asp:Parameter Name="original_userid" Type="Int16" />
        <asp:Parameter Name="original_username" Type="String" />
        <asp:Parameter Name="original_username" Type="String" />
        <asp:Parameter Name="original_userpass" Type="String" />
        <asp:Parameter Name="original_userpass" Type="String" />
    </DeleteParameters>
    <InsertParameters>
    <%--This is removed since [userid] is an automatically generated index.--%>
        <%--<asp:Parameter Name="userid" Type="Int16" />--%>
        <asp:Parameter Name="username" Type="String" />
        <asp:Parameter Name="userpass" Type="String" />
    </InsertParameters>
    <UpdateParameters>
        <asp:Parameter Name="username" Type="String" />
        <asp:Parameter Name="userpass" Type="String" />
        <asp:Parameter Name="original_userid" Type="Int16" />
        <asp:Parameter Name="original_username" Type="String" />
        <asp:Parameter Name="original_username" Type="String" />
        <asp:Parameter Name="original_userpass" Type="String" />
        <asp:Parameter Name="original_userpass" Type="String" />
    </UpdateParameters>
</asp:SqlDataSource>
<asp:ListView ID="ListView1" runat="server" DataKeyNames="userid" 
    DataSourceID="ManageUsersSource" InsertItemPosition="LastItem">
    <AlternatingItemTemplate>
        <tr style="background-color:#FFF8DC;">
            <td>
                <asp:Button ID="DeleteButton" runat="server" CommandName="Delete" 
                    Text="Delete" />
                <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
            </td>
            <td>
                <asp:Label ID="useridLabel" runat="server" Text='<%# Eval("userid") %>' />
            </td>
            <td>
                <asp:Label ID="usernameLabel" runat="server" Text='<%# Eval("username") %>' />
            </td>
            <td>
                <asp:Label ID="userpassLabel" runat="server" Text='<%# Eval("userpass") %>' />
            </td>
        </tr>
    </AlternatingItemTemplate>
    <EditItemTemplate>
        <tr style="background-color:#008A8C;color: #FFFFFF;">
            <td>
                <asp:Button ID="UpdateButton" runat="server" CommandName="Update" 
                    Text="Update" />
                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                    Text="Cancel" />
            </td>
            <td>
                <asp:Label ID="useridLabel1" runat="server" Text='<%# Eval("userid") %>' />
            </td>
            <td>
                <asp:TextBox ID="usernameTextBox" runat="server" 
                    Text='<%# Bind("username") %>' />
            </td>
            <td>
                <asp:TextBox ID="userpassTextBox" runat="server" 
                    Text='<%# Bind("userpass") %>' />
            </td>
        </tr>
    </EditItemTemplate>
    <EmptyDataTemplate>
        <table runat="server" 
            style="background-color: #FFFFFF;border-collapse: collapse;border-color: #999999;border-style:none;border-width:1px;">
            <tr>
                <td>
                    No data was returned.</td>
            </tr>
        </table>
    </EmptyDataTemplate>
    <InsertItemTemplate>
        <tr style="">
            <td>
                <asp:Button ID="InsertButton" runat="server" CommandName="Insert" 
                    Text="Insert" />
                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                    Text="Clear" />
            </td>
            <td>
                &nbsp;</td>
            <td>
                <asp:TextBox ID="usernameTextBox" runat="server" 
                    Text='<%# Bind("username") %>' />
            </td>
            <td>
                <asp:TextBox ID="userpassTextBox" runat="server" 
                    Text='<%# Bind("userpass") %>' />
            </td>
        </tr>
    </InsertItemTemplate>
    <ItemTemplate>
        <tr style="background-color:#DCDCDC;color: #000000;">
            <td>
                <asp:Button ID="DeleteButton" runat="server" CommandName="Delete" 
                    Text="Delete" />
                <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
            </td>
            <td>
                <asp:Label ID="useridLabel" runat="server" Text='<%# Eval("userid") %>' />
            </td>
            <td>
                <asp:Label ID="usernameLabel" runat="server" Text='<%# Eval("username") %>' />
            </td>
            <td>
                <asp:Label ID="userpassLabel" runat="server" Text='<%# Eval("userpass") %>' />
            </td>
        </tr>
    </ItemTemplate>
    <LayoutTemplate>
        <table runat="server">
            <tr runat="server">
                <td runat="server">
                    <table ID="itemPlaceholderContainer" runat="server" border="1" 
                        style="background-color: #FFFFFF;border-collapse: collapse;border-color: #999999;border-style:none;border-width:1px;font-family: Verdana, Arial, Helvetica, sans-serif;">
                        <tr runat="server" style="background-color:#DCDCDC;color: #000000;">
                            <th runat="server">
                            </th>
                            <th runat="server">
                                userid</th>
                            <th runat="server">
                                username</th>
                            <th runat="server">
                                userpass</th>
                        </tr>
                        <tr ID="itemPlaceholder" runat="server">
                        </tr>
                    </table>
                </td>
            </tr>
            <tr runat="server">
                <td runat="server" 
                    style="text-align: center;background-color: #CCCCCC;font-family: Verdana, Arial, Helvetica, sans-serif;color: #000000;">
                    <asp:DataPager ID="DataPager1" runat="server">
                        <Fields>
                            <asp:NextPreviousPagerField ButtonType="Button" ShowFirstPageButton="True" 
                                ShowLastPageButton="True" />
                        </Fields>
                    </asp:DataPager>
                </td>
            </tr>
        </table>
    </LayoutTemplate>
    <SelectedItemTemplate>
        <tr style="background-color:#008A8C;font-weight: bold;color: #FFFFFF;">
            <td>
                <asp:Button ID="DeleteButton" runat="server" CommandName="Delete" 
                    Text="Delete" />
                <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
            </td>
            <td>
                <asp:Label ID="useridLabel" runat="server" Text='<%# Eval("userid") %>' />
            </td>
            <td>
                <asp:Label ID="usernameLabel" runat="server" Text='<%# Eval("username") %>' />
            </td>
            <td>
                <asp:Label ID="userpassLabel" runat="server" Text='<%# Eval("userpass") %>' />
            </td>
        </tr>
    </SelectedItemTemplate>
</asp:ListView> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T15:56:22.587

在我的 ItemTemplate/AlternatingItemTemplate（就像编辑模板）中更改非主键字段以使用“ **Bind** ”而不是“ **Eval ”显然需要正确传递旧值。**

这是在没有完全理解的情况下使用自动生成的标记的情况（我仍然没有，真的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:26:37.643

您可以尝试简化更新和删除命令。由于 userid（您的 DataKeyName）是自动生成的，因此是唯一的，因此您不需要额外的参数。

因此，您的 UpdateCommand 将是

```
"UPDATE [DUSER] SET [username] = ?, [userpass] = ? WHERE [userid] = ?" 
```

具有以下参数：-

```
<UpdateParameters>
    <asp:Parameter Name="userid" Type="Int16" />
    <asp:Parameter Name="username" Type="String" />
    <asp:Parameter Name="userpass" Type="String" />
</UpdateParameters> 
```

您的 DeleteCommand 将是

```
"DELETE FROM [DUSER] WHERE [userid] = ?" 
```

具有以下参数：-

```
<DeleteParameters>
    <asp:Parameter Name="userid" Type="Int16" />
</DeleteParameters> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:06:05.743

抱歉，我忘了更改 ?s 并且您想要乐观并发。

```
"UPDATE [DUSER] SET [username] = @username, [userpass] = @userpass WHERE [userid] = @userid And [username] = @original_username And [userpass] = @original_userpass"

"DELETE FROM [DUSER] WHERE [userid] = @userid And [username] = @original_username And [userpass] = @original_userpass" 
```

当然，您需要检查该行是否已更新/删除。

您的 InserCommand 也应该是：-

```
"INSERT INTO [DUSER] ([username], [userpass]) VALUES (@username, @userpass)" 
```

假设用户名和用户密码设置为不允许空值，在这种情况下它们应该是空值，那么如果任一参数为空，命令将失败。

为避免这种情况，`<asp:RequiredFieldValidator>`请向每个 usernameTextBox 和 userpassTextBox 控件添加一个以提供客户端验证。

您还应该更改 TextBox 控件的 ID 以匹配参数名称。

如果您不得不处理空值，那么您将需要生成的查询的其他部分开始使用空比较，将 ?s 替换为适当的参数。

# java - Multithread security with synchronized in Java

> ID：10903609
> 
> 赞同：1
> 
> 时间：2012-06-05T19:25:28.687
> 
> 标签：java, multithreading, thread-safety, synchronized

I'm implementing a program that calculates a Julia set. It will use multiple threads, depending on how many processors are available. Each thread calculates a line, but only when that line is not being calculated by another thread. This part WORKS pretty well.

But sometimes when I test it with bigger images (more lines to calculate, for example instead of `getHeight() = 1200`, I set it to `3000`, there are some lines which are skipped). I want to make it more secure, so that no line will be calculated twice, and no lines will be skipped. Here is the code of the `run()` method:

```
 public void run() {
     while (counter < getHeight()-1) {  
         synchronized(this) {
             if (counter >= getHeight() -1) { //so that the last line will not be calculated >2 times.
                 return;
             }
             counter++;
             image.setRGB(0, counter, getWidth(), 1, renderLine(counter), 0, 0);
         }
     }
  } 
```

I want it to work like that: if the current line is being calculated, the thread goes to the next line.. without that it get confused, so that lines get skipped..

I'm trying this actually:

```
 public void run() {
     while (counter < getHeight()-1 && !working) {  
         synchronized(this) {
             working = true;
             if (counter >= getHeight() -1) { //so that the last line will not be calculated >2 times.
                 return;
             }
             counter++;
             image.setRGB(0, counter, getWidth(), 1, renderLine(counter), 0, 0);
             working = false;
         }
     }
  } 
```

but I don't know if it will prevent access to another thread, while a thread is already working, and it will change the value of "counter", meaning that lines can be skipped!

Do I need a boolean variable to notify that a thread is actually working on a line? Any advice?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T19:30:41.570

几乎可以肯定，您自己的线程管理做了太多事情。使用 an`ExecutorService`在多个线程之间分配工作而不会重复。

```
 ExecutorService service = Executors.newFixedThreadPool(
   Runtime.getRuntime().availableProcessors());
 for (int row = minRow; row <= maxRow; row++) {
   service.submit(new FillThisRowRunnable(row));
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T20:13:16.057

您确实需要为所有线程提供一个共享对象。该对象将告诉其他线程要处理哪一行。

我无法确定你现在拥有什么，但似乎每个人`synchronized`都在不同的情况下，你失去了所有的相互排斥。请记住，当同步发生在共享对象上时，同步仅适用于多个线程，否则每个线程将在没有实现任何目标的线程本地对象上同步。

这是一个例子

```
public class SharedLineCounter{
   private final int maxNumberOfLines;
   private int currentLineNumber =0;
   public SharedLineCounter(int maxNumberOfLines){
      this.maxNumberOfLines = maxNumberOfLines;
   } 
   public synchronized int getNextLine(){
      if(++currentLineNumber > maxNumberOfLines)
         return -1; //end case
      return currentLineNumber ;
   }
}

public class WorkerThread extends Thread{
    private final SharedLineCounter counter;
    public WorkerThread(SharedLineCounter counter){
       this.counter = counter;
    }
    public void run(){
      int next = -1;
      while((next = counter.getNextLine()) >= 0){
        image.setRGB(0, next , getWidth(), 1, renderLine(next ), 0, 0);
      }
    }
  }
} 
```

在这里，每个线程都将共享这个线程安全行计数器，因此每个线程应该始终获得一个唯一且连续的行号。

编辑以回答您的问题：

您可以通过共享全局实例使线程匿名

```
public static void main(String args[]){
    final SharedCounter counter = new SharedCounter();

    Thread worker1 = new Thread(new Runnable(){
       public void run(){
            counter.getNextLine(); //etc
       }
    });
    Thread worker2 = new Thread(new Runnable(){
       public void run(){
            counter.getNextLine(); //etc
       }
    });

} 
```

根据您的评论提出一个警告。您应该传入并创建一个匿名可运行文件，子类化和覆盖的方法是`new Runnable`不好的做法`run``Thread`

# android - Android error: java.lang.NoClassDefFoundError: [generic]

> ID：10903610
> 
> 赞同：2
> 
> 时间：2012-06-05T19:25:35.960
> 
> 标签：android, eclipse

I have got this error report from one user of my Android app:

```
java.lang.NoClassDefFoundError: [generic]
at dalvik.system.NativeStart.main(Native Method) 
```

That's the whole stack trace. O_o

Not very informative...

The only external jar I use is GoogleAdMobAdsSdk-6.0.1.jar for AdMob, and it is on the libs directory and added to the project through Eclipse's Android Interface (you know: Properties / Java Build Path / Libraries / Add External JARs)

So I have not a clue about what's wrong.

Any hints?

I compile using Eclipse v3.7.0 Build id I20110613-1736 on Ubuntu 11.04 with ADT 18.0.0.v20120330

I forgot to mention that my app has been installed by thousands of users and I only get one report on this issue til today.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:51:57.973

确保他们与`CLASSPATH`其他人一样启动。（这可能是由于命令行被截断。）

这应该出现在您的`javac`命令行中：`-classpath=libs/*.jar`

这应该出现在您的`apkbuilder`命令行中：`-rj libs`

# android - Dismissing splash screen using Robotium

> ID：10903611
> 
> 赞同：0
> 
> 时间：2012-06-05T19:25:39.783
> 
> 标签：android, splash-screen, robotium

I am using Robotium to automate Android UI. The app I am testing has a splash screen when it is launched and the screen is shown for x seconds. On tapping the screen before x seconds, the splash screen has to be dismissed.

I have tried `solo.clickOnScreen(100, 100)` , `solo.sendKey(66)` , where 66 corresponds to RETURN key. But the splash screen is not dismissed.

How do I simulate the user's action of tapping the screen to dismiss the splash screen?

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T16:48:24.480

您可以在启动画面中识别一个视图，然后单击它。类似于： View v = solo.getView(R.id.something) solo.clickOnView(v)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T08:23:04.357

您可以将其用作

```
Activity activity = solo.getCurrentActivity();
View view = activity.getCurrentFocus(); 
solo.clickOnView(view); 
```

# c# - 使用时钟滴答作为随机数种子

> ID：10903613
> 
> 赞同：7
> 
> 时间：2012-06-05T19:26:14.793
> 
> 标签：c#, sql-server, random

我正在使用当前时钟滴答作为随机数生成的种子。随机数用于伪 GUID，检查我的数据库将确保它在返回之前不存在。平均而言，在进程的生命周期中，此方法将被连续调用大约 10k 次。

我担心的是，可能会背靠背生成相同的数字，从而导致对我的数据库进行多次不必要的递归调用，以检查相同的 ID。如果可能的话，我想避免这种情况。测试这种情况的最佳方法是什么？

如果重要的话，应用程序是 .NET 4，数据库是 SQL Server 2008。

```
private static string GenerateUniqueDelId()
{
    // Generate a random integer using the current number of clock ticks as seed.
    // Then prefix number with "DEL" and date, finally padding random integer with leading zeros for a fixed 25-character total length.
    int seed = (int)DateTime.Now.Ticks;
    Random number = new Random(seed);
    string id = string.Format("DEL{0}{1}", DateTime.Today.ToString("yyyyMMdd"), number.Next().ToString("D14"));

    // Lookup record with generated ID in Sesame. If one exists, call method recursively.
    string query = "SELECT * FROM Lead WHERE Esm_Id = @Esm_Id";
    SqlParameter[] parameters = { new SqlParameter("@Esm_Id", id) };
    if (DataManager.GetRow(query, parameters, DelConnection.Sesame) != null) return GenerateUniqueDelId();

    // Otherwise, return ID.
    return id;
}   //// End GenerateUniqueDelId() 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T19:28:02.367

您的担心是对的：您应该将`Random`实例的创建移出方法主体 - 否则您将多次使用相同的值重新播种，从而导致相同的数字序列。

此外，您有点重新发明轮子：该类的默认构造函数`Random`已经使用当前时钟时间作为默认种子。

问题是您为什么不避免所有这些，而只在数据库端使用自动生成的 Guid？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-05T19:32:40.473

引用乔恩·斯基特的话

> 当您在 Stack Overflow 上的问题标题中看到“随机”一词时，您几乎可以保证这将是与无数类似问题相同的基本问题。本文着眼于为什么随机性会导致如此多的问题，以及如何解决这些问题。

查看他关于随机数生成器的文章

[http://cshapindepth.com/Articles/Chapter12/Random.aspx](http://csharpindepth.com/Articles/Chapter12/Random.aspx)

基本上他的解决方案看起来像：

```
using System;
using System.Threading;

public static class RandomProvider
{    
    private static int seed = Environment.TickCount;

    private static ThreadLocal<Random> randomWrapper = new ThreadLocal<Random>(() =>
        new Random(Interlocked.Increment(ref seed))
    );

    public static Random GetThreadRandom()
    {
        return randomWrapper.Value;
    }
} 
```

# javascript - Create a hyperlink (or button) that executes a python script and then redirects when script completes

> ID：10903615
> 
> 赞同：10
> 
> 时间：2012-06-05T19:26:27.530
> 
> 标签：javascript, python, html

Alright, I managed to get it working how I want (although some/most might disagree with the method). I used Flask as recommended below. The part that might be considered "wrong" is the 404 check loop. It isn't proper design and results in a "stuck script" error in some browsers if it goes on for too long. However, the script I want to run doesn't last long enough for that to be a problem.

Thanks for the help and please let me know if you have any other suggestions.

Flask App:

```
import threading
import subprocess
import os
import sys
from flask import Flask
from flask import render_template, abort
app = Flask(__name__)
app.debug = True

def run_script():
    theproc = subprocess.Popen([sys.executable, "run_me.py"])
    theproc.communicate()

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/generate')
def generate():
    threading.Thread(target=lambda: run_script()).start()
    return render_template('processing.html')

@app.route('/is_done')
def is_done():
    hfile = "templates\\itworked.html"
    if os.path.isfile(hfile):
        return render_template('itworked.html')
    else:
        abort(404)

if __name__ == "__main__":
    app.run() 
```

processing.html:

```
<!DOCTYPE html>
<html>
<head>
    <script src="/static/jquery.min.js"></script>
</head>

<body>
<p>Processing...</p>
<script>
    setInterval(function()
    {
        var http = new XMLHttpRequest();
        http.open('HEAD', "is_done", false);
        http.send();
        if (http.status==200)
            window.location.replace("is_done");
    },2000);
</script>
</body>
</html> 
```

Original question:

*I am a beginner/intermediate Python programmer and a beginning web developer so please be gentle. What I want: A user clicks a hyperlink and is taken to an intermediate web page that says something like "Processing...". In the background (on the server) this link triggers a python script that processes a file and creates a new web page. On completion of the script, the user is redirected to the newly created page. What I have: I have a script that does the processing and spits out a new page. What I haven't figured out is how to trigger the python script and then trigger the redirect on script completion. I've looked at web frameworks like django, and cgi scripting. But I haven't found anything I feel fits the bill. It's very possible I'm just missing something completely obvious so I'd really appreciate any help. Thanks.*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T21:14:25.397

解决这个问题的一个简单方法是使用像 Flask 这样的简单 Web 框架来构建系统的 Web 部件。在魔术链接的请求处理程序中，您需要生成脚本并跟踪它。查看脚本是否完成并将其转发给用户的一种简单方法是定期发送 ajax 请求以检查是否完成。

例如，Flask 网站可能如下所示：

```
import threading
import subprocess
import uuid
from flask import Flask
from flask import render_template, url_for, abort, jsonify, request
app = Flask(__name__)

background_scripts = {}

def run_script(id):
    subprocess.call(["/path/to/yourscript.py", "argument1", "argument2"])
    background_scripts[id] = True

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/generate')
def generate():
    id = str(uuid.uuid4())
    background_scripts[id] = False
    threading.Thread(target=lambda: run_script(id)).start()
    return render_template('processing.html', id=id)

@app.route('/is_done')
def is_done():
    id = request.args.get('id', None)
    if id not in background_scripts:
        abort(404)
    return jsonify(done=background_scripts[id]) 
```

和`index.html`：

```
<a href="{{ url_for('generate') }}">click me</a> 
```

并且`processing.html`：

```
<html>
<head>
<script src="/static/jquery.js"></script>
<script>
    function ajaxCallback(data) {
        if (data.done)
            window.location.replace("http://YOUR_GENERATED_PAGE_URL");
        else
            window.setTimeout(function() {
                $.getJSON('{{ url_for('is_done') }}', {id: {{ id }} }, ajaxCallback);
            }, 3000);
    }
    $(document).ready(function(){
        ajaxCallback({done=false});
    });
</script>
</head>
<body>
    Processing...
</body></html> 
```

目前这都是未经测试的代码，但我希望你对如何解决这个问题有所了解。另外请记住，这仅在您从一个进程提供页面时才有效，因此如果您设置 Apache 和 mod_wsgi，请确保进程组中只有一个进程。

如果您需要更复杂的解决方案，您可能需要查看消息队列等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T15:49:41.357

这对您来说可能是一个过于繁重的解决方案，但假设您无法取消“在服务器上创建文件”部分，这被认为是 Web 开发中的“最佳实践”解决方案：

使用 Flask 或 Django 之类的 Web 框架来提供页面。当用户请求通过请求（最好是 POST 请求，因为 GET 请求不会引起明显的副作用）启动作业时，框架会向 Celery 等延迟任务系统发送消息。然后向用户显示一个页面，说明作业已提交。

此时，您可以使用 ajax 轮询服务器并查看作业何时完成，但通常您不希望这是查看作业是否完成的唯一方法。如果连接因任何原因而中断，例如，如果用户错误地关闭了浏览器或选项卡（非常常见），那么努力将被浪费，用户将不得不重新开始该过程。如果可能的话，你应该有一种与用户交流的备用方式；这可能是出现在网站其他地方的快速消息、自动“工作完成”电子邮件、主页中显示最近完成的工作的框等。这有多实用和重要取决于用户是否登录以及如何登录工作需要多长时间/除了创建文件之外是否有副作用。

最后，您可以允许用户通过对该用户的工作结果唯一的 url 访问该页面。如果该 url 不会无限期地有效，请务必通知用户，例如，如果文件将在计时器上被删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:54:25.643

你想要什么是可能的，但这实际上是关于 3 个问题。

第一个问题是，如何从 PHP 创建一个新文件。我真的无法回答这个问题。您需要做什么，可能取决于您要创建的文件类型以及原因。

第二个问题是，如何让用户知道正在发生这种情况，第三个问题是如何重定向到新页面。

就个人而言，我认为通往胜利的最短途径可能是让您的客户端 javascript 向创建新内容的服务器页面或 CGI 模块发出 AJAX 请求。

1.  单击按钮时，向生成新内容页面的 PHP 页面发出 ajax 请求。
2.  展示您的忙碌指示器。
3.  让请求的页面返回新页面的 URL 作为其内容。
4.  当请求完成时，通过 javascript 重定向到返回的 URL。

作为 Web 开发的新手，最容易做的事情可能是研究 jQuery 和它的 AJAX 功能。那里的包装器使上述操作变得非常容易。当然，您也可以对任何其他主要的 javascript 框架或直接 javascript 执行相同的操作。

以供参考：

*   [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)
*   [http://www.tizag.com/phpT/filecreate.php](http://www.tizag.com/phpT/filecreate.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T19:48:17.207

两种简单的方法来做到这一点：

1）使用ajax轮询服务器。每 10 秒或您认为合适的任何间隔检查一次是否完成。例如，当脚本正在处理时，它会写入文件或数据库，无论它可能是指示完成百分比以及以某种方式识别进程（如果您有多个脚本同时运行，您会想知道哪个是Bob 的，哪一个是 Suzy 的）。

2）禁用输出缓冲并将输出流式传输到客户端。这比第一个选项简单。基本上，运行脚本并在处理过程中您可以输出 javascript 代码来更新进度指示器。您需要禁用输出缓冲，或手动刷新缓冲区，否则您的客户端可能不会立即收到输出（指标更新可能仅在达到 100% 时对客户端可见）。谷歌如何在您运行的任何设置（例如 PHP、Django）上执行此操作。

# visual-studio-2010 - 你可以在 .config 文件中使用 VS 宏吗？

> ID：10903621
> 
> 赞同：1
> 
> 时间：2012-06-05T19:27:04.043
> 
> 标签：visual-studio-2010

是否可以在 .config 文件中使用 Visual Studio 宏？比如可以像这样创建一个appSetting，其中$(ProjectDir)映射到我的.csproj文件所在的目录？

```
<appSettings>
  <add key="myDirectory" value="$(ProjectDir)\App_Data\myDirectory"/>
</appSettings> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:22:18.017

在四处搜索之后，这个问题的简短答案是“不”。

在 .config 文件中包含宏意味着 web.config 文件在部署到调试环境以外的地方时将无法正确解释。

# math - 如何将 1d 线性数组复制到 3d 数组中而不发生冲突？(CUDA)

> ID：10903630
> 
> 赞同：1
> 
> 时间：2012-06-05T19:27:46.063
> 
> 标签：math, memory, multidimensional-array, cuda

这不一定是 CUDA 特定的。

基本上，在 GPU 上我有一个 1D 数组，但在 C 代码中，我有一个 3d 数组。我需要来回复制这个数组，并且我需要能够正确地线性化索引。这意味着我选择了正确的编号方案，如 (1, 0, 0) 线性化为 1，或者是 (0, 1, 0) 或 (0, 0, 1)，形式为（x，y，z）？

3d 数组被声明为 array[X][Y][Z]。当我将该 3D 数组复制到相同大小的 1d 数组中时，计算机将如何自然地对其进行编号？但是计算机崩溃了 3d 数组，当我尝试在两者之间进行转换时，我需要做同样的事情。我希望我能说清楚我想说的话，但是如果您有任何问题，请提出。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T00:22:48.627

C 中的数组以行优先顺序保存，有关详细信息，请参阅[this 。](http://en.wikipedia.org/wiki/Row-major_order)

所以第一个元素是`array[0][0][0]`，第二个是`array[0][0][1]`，等等。

# c# - windows 7 c#中的音量控制

> ID：10903632
> 
> 赞同：2
> 
> 时间：2012-06-05T19:27:55.783
> 
> 标签：c#, windows-7, sdk, volume

我知道这个话题之前已经在这里讨论过，但我仍然无法让它发挥作用。我只需要使用 win 7 SDK 获取我机器中的当前音量（我将从那里开始，我想扩展我的项目的功能会更容易），而不使用像[这样](http://www.codeproject.com/Articles/18520/Vista-Core-Audio-API-Master-Volume-Control)的已发布项目的代码。我应该为我的项目添加一个特定的引用吗？使用dllimport？任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:32:25.850

也许这样： http: [//msdn.microsoft.com/en-us/library/ms679138%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms679138%28VS.85%29.aspx)（ISimpleAudioVolume 接口）

- 编辑 -

该项目似乎包含您正在搜索的内容。

[http://hintdesk.com/Web/Source/Adjust%20System%20Volume.zip](http://hintdesk.com/Web/Source/Adjust%20System%20Volume.zip)

如果没有，你可以看这里：[Get Master Sound Volume in c#](https://stackoverflow.com/questions/2534595/get-master-sound-volume-in-c-sharp)

或在这里：[http ://social.msdn.microsoft.com/Forums/en-US/isvvba/thread/05dc2d35-1d45-4837-8e16-562ee919da85](http://social.msdn.microsoft.com/Forums/en-US/isvvba/thread/05dc2d35-1d45-4837-8e16-562ee919da85)

但是我发现的最好的代码总是返回到你在问题中给出的链接。祝你好运！

--编辑2--

或者您可以在此帮助下使用 FMOD (c++)：[Using FMOD for C#?](https://stackoverflow.com/questions/6020196/using-fmod-for-c)
这：http: [//sourceforge.net/projects/fmodnet/](http://sourceforge.net/projects/fmodnet/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-26T19:43:07.217

使用核心音频 API，以下类将允许您获取和设置默认音频端点的音量以进行播放。

```
using CoreAudioApi;

public class SystemVolumeConfigurator
{
        private readonly MMDeviceEnumerator _deviceEnumerator = new MMDeviceEnumerator();
        private readonly MMDevice _playbackDevice;

        public SystemVolumeConfigurator()
        {
            _playbackDevice = _deviceEnumerator.GetDefaultAudioEndpoint(EDataFlow.eRender, ERole.eMultimedia);
        }

        public int GetVolume()
        {
            return (int)(_playbackDevice.AudioEndpointVolume.MasterVolumeLevelScalar * 100);
        }

        public void SetVolume(int volumeLevel)
        {
            if (volumeLevel < 0 || volumeLevel > 100)
                throw new ArgumentException("Volume must be between 0 and 100!");

            _playbackDevice.AudioEndpointVolume.MasterVolumeLevelScalar = volumeLevel / 100.0f;
        }
} 
```

# rest - REST 数字或字符串资源标识符？

> ID：10903636
> 
> 赞同：6
> 
> 时间：2012-06-05T19:28:05.740
> 
> 标签：rest, identifier, resource-id

我正在做一些研究来帮助我开发一个 REST API，这是我在任何地方都没有深入讨论过的一个话题。

如果我在系统中有用户，使用数字标识符识别用户是否更好

> /用户/1

还是使用字符串标识符？

> /用户/RSmith

我可以看到每种方法的假设潜在优缺点，字符串标识符更易于阅读，不易被发现（无法增加以查找有效用户），并且不需要在数据库中存储另一个数字 id（我不会想要通过 API 公开数据库 ID）。数字标识符没有内在含义，因此可以保证是不可变的，而对于字符串 id，用户可能想要重命名资源，从而更改资源 URI。

这里是否有 REST 最佳实践，或者最佳方法是否因系统而异？如果是后者，是否有与每种方法相关的其他优点和缺点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:47:39.290

如您所知，严格来说，两种方法之间没有优势。是的，字符串标识可能更容易让人们记住，但除此之外，REST 不强制执行“漂亮”的 URL（或 ID），因为大多数时候 URL 是由超链接后面的程序访问的。

因此，人类友好的 URL 应该只用于引导人类可能记住的资源。此外，ID 猜测应该不是问题，因为：

1.  您必须根据任何身份验证方法限制对 URL 的访问，或者：
2.  您必须使用非“公开”的随机/不可猜测的 URL。

那么使用哪一个呢？大多数时候，这并不重要，因为 ID 不是直接访问的。如果您必须确保人们出于某种原因记住他们的 URL，请尝试使它们人性化，但尽量避免更改资源名称并应用其他一些身份验证方式，以便即使猜测的 URL 也无法访问未经授权的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:44:52.607

这样做的唯一优点：/users/RSmith 是它更人性化。从 RESTfull 的角度来看，这并不重要，因为两者都是有效的资源标识符。其他一切都取决于您的系统要求。

# events - Backbone.js：动态添加不触发的事件

> ID：10903639
> 
> 赞同：1
> 
> 时间：2012-06-05T19:28:08.300
> 
> 标签：events, backbone.js

我正在尝试使用 Backbone.js 并且到目前为止相处得很好，但是我遇到了一个问题。

假设我有一个根元素和一个子元素。

当文档加载时，我创建了 3 个“根”实例。根实例附加一个标签。每个根实例创建一个子实例，该子实例创建一个

*   ul 标签中的标签。

    现在我希望子实例将 onclick 事件附加到

    *   标签。不幸的是，它不起作用。

    我创建了一个小提琴：

    [http://jsfiddle.net/Fluxo/sEjE5/17/](http://jsfiddle.net/Fluxo/sEjE5/17/)

    ```
    var child = Backbone.View.extend({
        template: _.template('<li>Item '+count+'</li>'),
        events: {
            'click li': function() {
             alert('listitem Click Child Element');   
            }
        },
        initialize: function() {
          _.bindAll('render');  
         this.render();   
        }, render: function() {
            this.$el.html(this.template())
        }
    });

    var root = Backbone.View.extend({
        template: _.template('<div><h3>List</h3><p /><ul></ul><hr />'),
        events: {
            'click li': function() {
             alert('listitem Click - Root Element');   
            }
        },
        initialize: function() {
            _.bindAll('render');
            this.render();
        },
        render: function() {
            this.$el.html(this.template());
            $('body').append(this.el);
            var item = new child();
            this.$el.find('ul').append(item.$el.html());

        }
    }); 
    ```

    在根元素中创建的事件将触发，但不会触发子元素中的事件。

    我做错什么了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T20:09:45.897

你做错了两件事。

首先，你`child`是一个`<li>`，它不包含一个`<li>`：

```
template: _.template('<li>Item '+count+'</li>'),
events: {
    'click li': ...
}, 
```

所以你的`click li`活动不会做任何事情。事件绑定到[视图的`el`using`delegate`](http://documentcloud.github.com/backbone/#View-delegateEvents)：

> **委托事件** `delegateEvents([events])`
> 
> 使用 jQuery 的`delegate`函数为视图中的 DOM 事件提供声明性回调。[...] 省略`selector`导致事件绑定到视图的根元素 ( `this.el`) 的原因。

因此，如果您想将单击处理程序直接绑定到视图`el`而不是其子视图之一，则需要省略选择器：

```
events: {
    'click': ...
} 
```

下一个问题是您实际上并没有将`child`元素插入到 DOM 中，而是在复制 HTML：

```
this.$el.find('ul').append(item.$el.html()); 
```

通过附加`item.$el.html()`而不是`item.el`，您将获取正确的 HTML 作为字符串并插入该 HTML，但您会丢失该过程中的事件；事件绑定到 DOM 对象，`item.el`而不是 HTML 字符串。您可以通过附加以下内容来解决此问题`item.el`：

```
this.$el.find('ul').append(item.el);
// Or you could say, the two approaches are the same
this.$('ul').append(item.el); 
```

演示： http: [//jsfiddle.net/ambiguous/K76JM/](http://jsfiddle.net/ambiguous/K76JM/)（或[http://jsfiddle.net/ambiguous/kFxHQ/](http://jsfiddle.net/ambiguous/kFxHQ/)）

# asp.net-mvc-3 - 使用 MVVM 开发 ASP.NET MVC 应用程序的时间

> ID：10903642
> 
> 赞同：-1
> 
> 时间：2012-06-05T19:28:16.280
> 
> 标签：asp.net-mvc-3, mvvm, knockout.js, estimation

我们正在与团队讨论使用 ASP.NET MVC 构建 Web 应用程序的不同选项。一种选择是在渲染视图的任何地方都使用 MVVM（例如，knockoutjs）。方法看起来非常强大，但是需要考虑开发工作。

我希望其他人根据他们的经验（或指向一些资源）提供一些粗略的“行业标准”开发时间比较。例如，“对于一个普通的 ASP.NET Web 应用程序，使用 MVVM 平均需要 N 倍更多/更少的努力”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:08:25.157

我发现 knockoutjs 的开发速度非常快。但是，我发现有几件事可以使它更快。

首先，是使用coffeescript 而不是javascript。（使用 web 工作台，如果您最终使用，也切换到使用 SASS for css）。但是，没有智能感知或任何东西......虽然我个人认为这不是一个问题。然而，coffeescript 比 javascript 简洁很多，并且与淘汰赛结合得非常好。

接下来是数据从 C# 到 json 到淘汰赛的转换。

通常在这里，在您的控制器中，您从数据库中获取数据（使用您最喜欢的 ORM），将其投影到 C# 视图模型，并将其传递给视图（ Razor ），然后使用它并将其转换为 json 映射到淘汰视图模型。

如果您将所有这些都移到 Razor 视图中（基本上您的控制器将参数传递给视图）。然后查询数据库并在 Razor 视图中创建 C# 视图模型。然后这使开发速度更快，因为您基本上可以只编辑视图、刷新网页、编辑、刷新（无编译步骤）。

虽然写下来这听起来有点令人困惑，但实际上这样做非常简单，并且只需少量代码，您就可以非常快速地构建一些功能丰富的页面。

根据你在做什么，我会说基于淘汰赛的解决方案往往快 1->10 倍。但是，在个别情况下，asp.net 中的特定控件会使某些事情稍微容易一些，但是，在淘汰赛中复制该行为通常并没有那么多工作，更重要的是，将事情自定义为您所需要的更容易想。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T20:15:55.843

我们组终于决定`knockout.js`在这个时候放弃了。

的问题`knockout.js`是写代码的时候不会有好的智能感知。与 MVC 中的 ViewModel 相比，这使得开发容易出错且耗时。

特别是当需要在线提交表单时，我们仍然喜欢利用`DataAnnotation`可以在视图模型上设置的属性。这种做法仍然为我们节省了大量的服务器端和客户端验证时间。

但我想说`knockout.js`有它的好处，因为更多的客户端编程确实改善了用户体验。如果更少的回发意味着很多，请考虑`knockout`。特别是当一页上的客户端有很多东西要更改时。否则，我会简单地使用 ajax 调用并使用子句更新页面`jQuery`内容`success:`。

至少有一个未来的项目我想用广泛的`knockout`. 毕竟这将是必要的知识。这不是很困难。只需按照网站上的好例子。

# vb.net - Telerik RadDropDownList 在通过按标签快捷方式的键搜索项目时失去焦点

> ID：10903645
> 
> 赞同：1
> 
> 时间：2012-06-05T19:28:39.030
> 
> 标签：vb.net, telerik

我在面板中有很多控件。一个是 System.Windows.Forms。**标签**旁边有一个文本框，另一个控件是 Telerik.WinControls.UI。**辐射下拉列表**。

下拉列表有两个项目：True 和 False。
该标签的文本值为“%Type”（因此有一个快捷方式）。

当下拉列表聚焦并按 F 时，会选择 False 项目，这很好。但是，如果您按 T，而没有按下 ALT 键，则焦点会因为标签快捷方式而跳转，并且文本框会获得焦点。

有没有人经历过这种行为或对如何解决这个问题有任何想法？

我注意到按下 T 时触发了下拉列表的 KeyDown 事件，而不是 KeyUp 或 KeyPress 事件。此外，一旦我从标签文本中删除 & ，一切正常。

谢谢！

# android - 为所有 EditText 设置一致的样式（例如）

> ID：10903647
> 
> 赞同：86
> 
> 时间：2012-06-05T19:28:47.287
> 
> 标签：android

我试图让`EditText`我的应用程序中的 all 具有一致的外观。我知道我可以做这样的事情：

```
<style name="App_EditTextStyle">
    <item name="android:background">@drawable/filled_roundededges_box_dark</item>
    <item name="android:textColor">#808080</item>
    <item name="android:layout_height">45dip</item>
</style> 
```

然后我可以通过这样做使一个特定的`EditText`具有这种风格：

```
<EditText ...
    style="@style/App_EditTextStyle
    ...> 
```

但是这样我必须记住为我的应用程序中的每一个单独设置样式，`EditText`这很乏味，如果不是容易出错的话。

有什么方法可以让它成为主题的一部分吗？这样我就不必将这种风格与每个`EditText`. 像这个虚构的代码块：

```
<style name="App_Theme" parent="@android:style/Theme.Holo">
   ... 
   <item name="android:EditTextSyle">@style/App_EditTextStyle</item>
   ...
<style> 
```

然后在我的`AndroidManifest.xml`我有类似的东西：

```
<application
    ....
    android:theme="@style/App_Theme"> 
```

瞧！我所有的`EditText`'s 都具有一致的样式，而无需我为每个实例指定样式。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2012-06-05T20:09:27.773

在您的自定义主题中覆盖指向`EditText`style(named `editTextStyle`:) ) 的属性：

```
<style name="App_Theme" parent="@android:style/Theme.Holo">
   <item name="android:editTextStyle">@style/App_EditTextStyle</item>
</style> 
```

并使您的自定义样式扩展`Widget.EditText`：

```
<style name="App_EditTextStyle" parent="@android:style/Widget.EditText">
    <item name="android:background">@drawable/filled_roundededges_box_dark</item>
    <item name="android:textColor">#808080</item>
    <item name="android:layout_height">45dip</item>
</style> 
```

编辑：

如果您使用的是更新的 AppCompat 相关主题，请使用不带 android 前缀的 editTextStyle 属性：

```
<style name="App_Theme" parent="Theme.AppCompat.Light.DarkActionBar">
        <item name="editTextStyle">@style/App_EditTextStyle</item>
</style> 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2015-12-23T05:03:09.677

@Luksprog 答案是正确的，但对我不起作用。经过一些实验，我发现从 editTextStyle 中删除 android 命名空间使它对我有用。

```
<style name="App_Theme" parent="@android:style/Theme.Holo">
   <item name="editTextStyle">@style/App_EditTextStyle</item>
</style> 
```

并使您的自定义样式扩展`Widget.EditText`或使用 AppCompat 主题`Widget.AppCompat.EditText`：

```
<style name="App_EditTextStyle" parent="@android:style/Widget.EditText">
    <item name="android:background">@drawable/filled_roundededges_box_dark</item>
    <item name="android:textColor">#808080</item>
    <item name="android:layout_height">45dip</item>
</style> 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-04-15T18:42:06.113

首先，为您的 EditText 定义样式。确保父样式是`android:Widget.EditText`

```
<style name="CustomEditTextStyle" parent="android:Widget.EditText">

    <item name="android:textColor">#0F0F0F</item>
    <!-- ... More items here if needed ... -->
</style> 
```

之后，覆盖`android:editTextStyle`自定义主题中的属性。请注意，如果您使用的是支持库，您还需要覆盖该属性`editTextStyle`（没有 android 命名空间）。

```
<style name="App_Theme" parent="...">
   <item name="android:editTextStyle">@style/CustomEditTextStyle</item>
   <item name="editTextStyle">@style/CustomEditTextStyle</item> <!-- For compatibility with the support library -->
</style> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-23T20:58:11.487

如果您只需要设置一些简单的参数，例如文本颜色，Android 命名空间有一些参数可以做到这一点，而无需为编辑文本声明单独的样式。例如

```
<style name="MyStyle" parent="android:Theme.Material.NoActionBar">
    <item name="colorPrimary">@color/black</item>
    <item name="colorPrimaryDark">@color/white</item>
    <item name="colorAccent">@color/white</item>
    <item name="android:textColor">@color/black</item>
    <item name="android:editTextColor">@color/black</item>
    <item name="android:editTextBackground">@color/black</item>
    ....
</style> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-09-16T09:40:35.950

```
<style name="App_Theme" parent="@android:style/Theme.Holo">    
    <item name="android:editTextBackground">@drawable/filled_roundededges_box_dark</item>
</style> 
```

# c - XCode 4.3 - 从 XCode 4.2 升级后 perl 找不到 C 编译器

> ID：10903649
> 
> 赞同：2
> 
> 时间：2012-06-05T19:29:06.190
> 
> 标签：c, perl, compiler-construction, osx-lion, xcode4.3

我最近升级到 Lion 和 XCode 4.3，现在我对 perl 所做的任何需要 C 编译器的操作都无法构建：

```
root# perl Makefile.PL 
Couldn't find your C compiler
Compilation failed in require at Makefile.PL line 5.
BEGIN failed--compilation aborted at Makefile.PL line 5. 
```

我的 c 编译器设置为：

```
root# perl -V:cc
cc='llvm-gcc-4.2'; 
```

XCode 4.3 有什么改变吗？我现在如何为 perl 设置 C 编译器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T19:50:34.397

新版本的 Xcode 不会安装可以在`$PATH`. 您需要转到 XCode 首选项的“下载”部分并选择安装命令行工具。

[来自 Apple](https://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/WhatsNewXcode/Articles/xcode_4_3.html)的更多信息（查找“命令行工具是可选的”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:21:43.677

如果您认为它们兼容，您可以创建符号链接或编辑 Config.pm (path = `perl -MConfig -E'say $INC{"Config.pm"}'`)。

# php - 升级 WordPress 时出错 - 致命错误：内存不足

> ID：10903650
> 
> 赞同：0
> 
> 时间：2012-06-05T19:29:07.013
> 
> 标签：php, wordpress, fatal-error

当我尝试将 WordPress（当前版本 3.1）升级到 WordPress 3.2.2 时，出现此阶段错误：

> 致命错误：第 1420 行 /homepages/32/d108770064/htdocs/Wordpress/wp-includes/class-http.php 中的内存不足（分配 29360128）（试图分配 3155893 字节）

如何解决这个问题并更新 WordPress？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:37:02.413

如果您可以访问您的 PHP 配置，请尝试增加`memory_limit`或`32M`重新`64M`启动 Web 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:49:17.130

如果您希望我们提供帮助，您需要发布更多信息，例如服务器负载、服务器规格等。但 @Giggsey 所说的大部分是正确的；你会想要下载一个新的 Wordpress 副本，看看它是否有效。但是，请确保备份您的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:43:01.530

您唯一能做的就是尝试卸载旧的 WordPress 3.1。然后，从网站下载 WordPress 3.2.2 并安装新版本。

# iphone - iOS - 如果用户是否允许使用他当前的位置

> ID：10903653
> 
> 赞同：0
> 
> 时间：2012-06-05T19:29:29.373
> 
> 标签：iphone, ios, ios5, mapkit, cllocationmanager

在我的地图视图中的应用程序中，我想显示用户当前位置最近的 10 家商店

但首先我必须先获取当前位置，然后我才能根据用户的位置显示商店

在应用程序的第一次启动中，应用程序询问用户他是否允许获取当前位置，所以我必须执行类似的操作

如果用户在地图上允许列表商店，则返回主页

现在我正在使用下面的代码：

```
 mtMap.showsUserLocation=YES;
mymanager=[[CLLocationManager alloc] init];
mymanager.delegate=self;
CLLocation *location = [mymanager location];
CLLocationCoordinate2D coordinate2 = [location coordinate];

NSString *latitude1 = [NSString stringWithFormat:@"%f", coordinate2.latitude]; 
NSString *longitude1 = [NSString stringWithFormat:@"%f", coordinate2.longitude];

NSString *myURL = [[NSString alloc] initWithFormat:@"http://www.xxxx.com/xxxx/aaaaa.ashx?term=%@,%@",latitude1,longitude1];
NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:myURL]];
NSInputStream *dataStream=[[NSInputStream alloc]initWithData:data];

[dataStream open];
if(dataStream)
{

    NSError *err=nil;
    id jsonobject=[NSJSONSerialization JSONObjectWithStream:dataStream options:NSJSONReadingAllowFragments error:&err];
    if([jsonobject respondsToSelector:@selector(objectForKey:)])
    {
        //fill arr
    }
} 
```

但是当用户第一次打开应用程序时它不起作用，因为延迟允许或获取当前位置很晚我无法到达他所在的位置，所以我无法显示最近的地方

我的逻辑可能有问题。我的意思是我不应该在 viewDidload 中完成所有工作

那么任何人都可以帮助我如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T03:00:22.577

与其在 viewDidLoad 部分下做，不如在这个方法中插入代码呢？

```
// Delegate method from the CLLocationManagerDelegate protocol. 
- (void)locationManager:(CLLocationManager *)manager 
didUpdateToLocation:(CLLocation *)newLocation 
fromLocation:(CLLocation *)oldLocation 
{ 
CLLocation *location = newLocation;
... 
```

这将使代码在用户位置更新后运行。您还可以在方法中添加一个 if 语句来检查它是否是第一次运行代码，如果不是返回。

# php - php中的echo和return的区别？

> ID：10903659
> 
> 赞同：3
> 
> 时间：2012-06-05T19:30:12.177
> 
> 标签：php

这让我很困惑，函数中的回声和返回有什么区别

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-05T19:31:36.107

`echo`将内容输出到控制台或 Web 浏览器。

**例子：**

```
echo "Hey, this is now showing up on your screen!"; 
```

* * *

`return`在函数或方法的末尾返回一个值。

**例子：**

```
function my_function()
{
    return "Always returns this";
}

echo my_function(); // displays "Always returns this" 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-05T19:35:17.550

**echo** - 输出一个或多个字符串

**return** - 如果从函数内部调用，return 语句会立即结束当前函数的执行，并将其参数作为函数调用的值返回。return 还将结束 eval() 语句或脚本文件的执行。

花点时间阅读[php手册](http://www.php.net/manual/en/index.php)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-05T19:33:15.593

啊...

有很大的不同。

基本情况：

*   `return $a`从函数返回一个值或结束函数
*   `echo $a`输出一个值

    ```
    function foo() {
        return 5;
    }

    $x = foo(); // $x holds the value 5

    echo $x; // outputs "5" 
    ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-05T19:31:05.507

Echo 将字符串打印到屏幕或浏览器。Return 结束函数，可选择将值从函数发送回调用该函数的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:33:05.007

Echo 允许您向浏览器发送一个值，以显示给用户。

Return 允许您结束一个函数，以及将一个值传递给另一个函数或变量。

查看此链接，该链接更详细：

[http://blog.bluefur.com/2009/01/20/php-echo-r​​eturn/](http://blog.bluefur.com/2009/01/20/php-echo-return/)

# perl - 如何在 perl 中读取我自己的配置文件

> ID：10903660
> 
> 赞同：0
> 
> 时间：2012-06-05T19:30:23.617
> 
> 标签：perl

如何读取我自己的扩展名为 .pl 的配置文件？我已经使用 require 在我的脚本中读取该文件。但我不确定这是正确的方法吗？你能建议我怎么做吗？

而且，当我在脚本中使用 require 读取配置文件时，我会收到诸如 Global symbol requires explicit package name 之类的错误。如何解决这个问题？

这是示例：

这是我的配置文件：

```
$USERNAME="sach";
$PASSWORD="sach123";
$DBNAME="personal";
$HOST="localhost";
$LIST_OLD_FILES_FILE="old_files.txt";
$remove_files=1;
$File_path="/sach/"; 
```

这是我在脚本中的调用方式：

```
require "config.pl" ;
$dbh = DBI->connect("DBI:mysql:$DBNAME:$HOST",$USERNAME,$PASSWORD) or 
     die "$dbh->errstr\n"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:52:04.887

您可以使用该[`do`](http://perldoc.perl.org/functions/do.html)命令读取包含 perl 代码的配置文件。

```
do 'config.pl'; 
```

# html - Div 网格单元格类型对齐

> ID：10903664
> 
> 赞同：0
> 
> 时间：2012-06-05T19:30:33.477
> 
> 标签：html, css

我的目标是类似这样的设置：

![在此处输入图像描述](../Images/6c2b63582b7585ba5093d33b23c1d15d.png)

不幸的是，我最终得到了这个：

![在此处输入图像描述](../Images/f41a92d4111c190e489a89cb279dac62.png)

这是我的规格：

我试图让带有图像的 div 设置为无边框，并让带有文本的 div 具有 1 px 的边框。

这是我设置的div：

```
<section id="row2">

    <div id="textBox1" class="column left">
        <p> TEXT BOX 1 </p> 
    </div> <!--#textBox1 .column.left-->

    <div class="column right">
                <img src="assets/top-right-image.png"/>
            </div>

</section> <!--#row2-->

<section id="row3">

    <div class="column left"><img src="assets/bottom-left-image.png"/></div>

    <div id="textBox2" class="column right">
        <p> TEXT BOX 2 </p>
    </div>

</section> <!--#row3--> 
```

如您所见，我设置了 id 为“textBox1”和“textBox2”的文本 div。不幸的是，这会炸毁它们并使#row3 中的 div.column.left 与右侧对齐。

这是CSS：

```
.column {
     float: left;
     position: relative;
     margin: 20px 11px;
}

.left {
     width: 408px;
}

.right {
     width: 449px;
}

#bannerPic {
     padding: 0px 15px;
}

#row2 div {
     height: 352px;
}

#row3 div {
     height: 598px;
}

#textBox1 {
    border: 1px solid #BCBCBC;
    margin-bottom: 20px;
}

#textBox2 {
    border: 1px solid #BCBCBC;
} 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:33:19.170

很可能前两个项目的高度不完全相同，所以第三个项目，较高的照片，是“悬挂”在第一个项目上。发生这种情况是因为浮动行为的工作方式。确保每一行的部分（div）被渲染到完全相同的高度，包括所有的边框、边距、填充等。

另一个选项是“清除”部分标签。由于您的部分内容是文本，这可能会容易得多。无论如何，这可能更容易。:)

```
section { clear: both } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:35:01.987

尝试添加样式级联：

```
section {
  clear: both;
} 
```

清除浮动并将每一行重置为边距。

# sparql - 在 Virtuoso 中使用超过 1 个输入推理

> ID：10903665
> 
> 赞同：0
> 
> 时间：2012-06-05T19:30:33.917
> 
> 标签：sparql, inference, virtuoso

我`input inference`在 Virtuoso Open Source 中有一个，它是从[goodrelations](http://www.heppnetz.de/projects/goodrelations/)网站定义的——

```
rdfs_rule_set('http://purl.org/goodrelations/v1', 'http://purl.org/goodrelations/v1'); 
```

-- 我在查询中使用的 --

```
define input:inference <http://purl.org/goodrelations/v1> . 
```

现在我想整合所有具有相同名称的品牌，`owl:sameAs`对其进行推断，并插入到规则集中——

```
rdfs_rule_set('samebrands', 'samebrands'); 
```

但是，当我添加更多推理时，Virtuoso 告诉我我不能向查询添加超过 1 个推理。

我该怎么做？谢谢 ：）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T05:35:24.723

你必须使用另一个编译指示：

```
DEFINE input:same-as "yes" 
```

[请参阅文档](http://docs.openlinksw.com/virtuoso/rdfsparqlrule.html)。

另一种方法是定义一个包含两个图（GR 和samebrands）的推理规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T11:58:18.350

您可能需要创建一个单独的本体，其中包含要用于推理的术语。如果它是来自另一个本体的所有术语，则使用`owl:imports`

# c# - 同时显示多个工具提示 (DevExpress)

> ID：10903668
> 
> 赞同：0
> 
> 时间：2012-06-05T19:30:44.487
> 
> 标签：c#, winforms, devexpress, tooltip

我正在使用 Visual Studio 2008 中的 C# WinForm 应用程序并使用 DevExpress。

我添加了一些按钮（DevExpress SimpleButton）的快捷方式，触发按钮点击（CTRL + R，CTRL B等等......）。当用户按住 CTRL 键时，我想在每个按钮旁边的工具提示中显示快捷方式文本。

我曾尝试使用 DevExpress 控件“ToolTipController”，如果我只有一个工具提示，它就可以正常工作。但我想一次显示多个工具提示。似乎只显示了添加的最后一个工具提示。

是否可以一次显示多个工具提示？或者有人对如何解决这个问题有任何其他建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:30:21.277

我通过创建一个看起来类似于标准工具提示（带有标签的小框）的 WPF 控件解决了这个问题。然后，我对表单上的 ProcessCmdKey 和 OnKeyUp 进行了覆盖，以收听 CTRL 键的按下和按下。

当用户按住 CTRL 键时，我会遍历所有具有快捷方式的控件，并在该控件之上创建一个 WPF 控件。对于每个 WPF 控件，我设置了相应的快捷方式文本。释放 CTRL 键后，我删除了 OnKeyUp 中的所有 WPF 控件。

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
    { if ((msg.Msg == WM_KEYDOWN) && ModifierKeys == Keys.Control && !_isKeyDown)
        {
            _isKeyDown = true;
            ShowShortCutToolTips();
            this.Focus();
            return true;
        }
        return base.ProcessCmdKey(ref msg, keyData);
    }

   protected override void OnKeyUp(KeyEventArgs e)
    {
        base.OnKeyUp(e);
        if(e.KeyValue == 17 || e.Control) // 17 = Control Key
        {
            _isKeyDown = false;
            HideShortCutToolTips();
        }
    } 
```

# windows-8 - 在 WinRT 中选择 XAML 的 ListView 和 GridView

> ID：10903669
> 
> 赞同：23
> 
> 时间：2012-06-05T19:30:47.200
> 
> 标签：windows-8, windows-runtime, windows-store-apps, winrt-xaml

XAML 中的 GridView 和 ListView 似乎是同一个控件。

**开发人员如何在两者之间进行选择？**

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-06-05T19:30:48.887

GridView 控件通常水平滚动。此外，您会看到项目之间的一些原生间距大于 ListView 中的间距。之所以存在此间距，是因为这些控件将如何在 Windows 应用商店应用程序中使用。（继续阅读）

*   与 ListView 一样，它继承自 ItemsControl。
*   就像使用 GroupStyle 的 ListView 组一样。
*   与 ListView 一样，它支持两种新的虚拟化策略。
*   与 ListView 一样，它支持不同的选择模式。

示例语法：

```
<GridView>
    <x:String>Item 1</x:String>
    <x:String>Item 2</x:String>
</GridView> 
```

ListView 控件通常垂直滚动。

示例语法：

```
<ListView>
    <x:String>Item 1</x:String>
    <x:String>Item 2</x:String>
</ListView> 
```

**这就是答案**

两者之间的一般区别在于它们在视图中的出现。GridView 往往出现在 FullView、FillView 和 Portait 中。ListView，由于其垂直方向，往往会出现在 SnapView 中。任一控件都可以出现在任一视图中，但这是两个控件的本地转移。

![在此处输入图像描述](../Images/385f79caa09ee353aad4715e4062e8a6.png)

> [MSDN](http://msdn.microsoft.com/en-US/library/windows/apps/xaml/Hh780650)：ListView 和 GridView 控件都用于显示应用程序中的数据集合。它们具有相似的功能，但显示数据的方式不同。它们都派生自 ItemsControl 类。当我们谈论 ItemsControl 时，该信息适用于 ListView 和 GridView 控件。
> 
> ListView 显示垂直堆叠的数据。它通常用于显示有序的项目列表，例如电子邮件列表或搜索结果。它在主从场景中也很有用，其中列表项仅包含少量信息，并且所选项目的详细信息单独显示。
> 
> GridView 显示水平堆叠的数据。当您需要为每个占用更多空间的项目（例如照片库）显示丰富的可视化时，通常会使用它。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-14T20:55:01.467

用户会注意到的唯一区别是触摸选择手势。对于 GridView，选择手势是向上->向下滑动。对于 ListView，它是向左->向右滑动。我认为这是为了让列表可以区分选择滑动和滚动尝试。

在 Xaml 中，您还会注意到默认的 ItemsPanel 是不同的。GridView 的 ItemsWrapGrid 和 ListView 的 ItemsStackPanel（从 Win8.1 虚拟化面板开始；在 8.0 中是 WrapGrid 和 StackPanel）。这可能会影响您可以在 Xaml 中自定义哪些属性。

# vb.net - 如何正确注册 VB.NET COM+ 组件的类型库？

> ID：10903671
> 
> 赞同：0
> 
> 时间：2012-06-05T19:30:49.563
> 
> 标签：vb.net, vb6, com+

我希望将旧版 VB6 COM+ 组件升级为 VB.NET 组件。我似乎已经升级了一个，叫做 EventPackage，它有一个类，IEventListener。另一个，TradeOrders `Implements EventPackage.IEventListener`，。尝试构建 TradeOrders 时，我收到以下错误/警告；

1.  无法加载类型库以供参考“EventPackage”。图书馆未注册。（来自 HRESULT 的异常：0x8002801D (TYPE_E_LIBNOTREGISTERED)）
2.  找不到引用的组件“EventPackage”。
3.  未定义类型“EventPackage.IEventListener”。

在 .vbproj 中，我注意到这个参考

```
<COMReference Include="EventPackage">
  <Guid>{0D76C094-21A6-4E04-802B-6E539F7102D7}</Guid>
  <Lcid>0</Lcid>
  <VersionMajor>2</VersionMajor>
  <VersionMinor>0</VersionMinor>
  <WrapperTool>tlbimp</WrapperTool>
</COMReference> 
```

当我在注册表中搜索此 Guid 时，我什么也没找到。当为类似的 COM+ 对象使用 GUID 时，我发现它们位于`HKEY_CLASSES_ROOT\CLSID\{...}\TypeLib`（“...”是另一个组件的 GUID）。当我去EventPackage.IEventListener对应的注册表键名时，发现没有`\TypeLib`子键。您可能会怀疑，在 reg 中搜索“0D76C094-21A6-4E04-802B-6E539F7102D7”不会产生任何结果。

所以我知道这一定是一个注册表问题，但我似乎已经尝试了我找到的每一个谷歌结果。我尝试过 Regasm 和 regsvcs .exe 无济于事。许多页面只是告诉我，将 dll 拖到 COM+ 管理器应该会自动注册组件。

那么如何注册类型库呢？

## 关于我如何制作 EventPackage COM+ 组件的详细信息

1.  运行 VB6->VB.NET 向导

然后我在 assemblyinfo.vb 文件中添加了一些行

1.  添加`Imports System.EnterpriseServices`
2.  添加`Imports System.EnterpriseServices`
3.  `Imports System.Data.SqlClient`
4.  `<Assembly: CLSCompliant(True)>`
5.  `<Assembly: AssemblyKeyFileAttribute("...")>`为了一个强大的名字
6.  `<Assembly: Guid("...")>`（其中“...”是旧组件的 COM+ CLSID）

我将以下内容添加到类文件 IEventListener.VB

1.  `Imports System.EnterpriseServices`
2.  `<ComClass("...")> _`（其中 ... 是正确的 COM+ CLSID，这是唯一的参数）
3.  `Inherits ServicedComponent`
4.  将转换向导生成的 ID 更改为正确的值（`<System.Runtime.InteropServices.ProgId("IEventListener_NET.IEventListener)>`从`<System.Runtime.InteropServices.ProgId("EventPackage.IEventListener")> _`

然后我将 DLL 拖到适当的 COM+ 应用程序中的 COM+ 管理器中（尽管没有指定“路径”，只是说`mscoree.dll`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T09:13:52.707

I think that the problem here is that you haven't generated a type library for your .NET component. I know you said you used regasm - but did you use the right command line?

*   **Start Menu** => **Programs** => **Microsoft .NET Framework SDK vX.Y** => **SDK Command Prompt**.
*   In this command line line, type: **regasm /tlb:Mydll.dll**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T04:19:20.907

控制台命令“regsvr32 mydll.dll”将注册您的 COM 组件。然后，您应该能够在 HKEY_CLASSES_ROOT\CLASSID 下找到 guid，InprocServer32 文件夹将包含您的 dll 的路径。这就是 COM 查找 dll 的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T00:22:22.060

我昨天遇到了大坝错误（0x8002801D（TYPE_E_LIBNOTREGISTERED）），它让我发疯：[VSTO 加载项、COMAddIns 和 RequestComAddInAutomationService](https://stackoverflow.com/questions/10875278/vsto-add-ins-comaddins-and-requestcomaddinautomationservice)

这可能是一个红鲱鱼，但我的答案有类似的细节关于不存在的注册密钥等：

**右键单击 Visual Studio (2010) > 以管理员身份运行 > 打开项目 > 编译！**

# django - 在谷歌应用引擎上运行演示 django 应用程序（DJANGO_SETTINGS_MODULE 未定义。）

> ID：10903676
> 
> 赞同：0
> 
> 时间：2012-06-05T19:31:05.610
> 
> 标签：django, google-app-engine

我正在尝试在 googleappenginelauncher 版本 1.6.6 中运行名为 Polls 的 django 1.3 测试应用程序，但出现以下错误。谁能告诉我如何做到这一点，好吗？

```
ImportError: Settings cannot be imported, because environment variable DJANGO_SETTINGS_MODULE is undefined.
INFO     2012-06-05 19:08:30,766 dev_appserver.py:2904] "GET /polls/1/ HTTP/1.1" 500 - 
```

我已经将我的 app.yaml 放在了 app 目录中，而不是项目目录中，这可能是个问题，但这是我当前的 app.yaml。另外，我已经将我的 views.py 声明为我的主脚本，这也是一个猜测。

```
application: ctst
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /_ah/queue/deferred
  script: djangoappengine.deferred.handler.application
  login: admin
- url: /.*
  script: views.app

libraries:
- name: django
  version: "1.3" 
```

我的 mysite 和民意调查目录如下。

```
server:mysite brian$ ls -l
total 352
-rw-r--r--   1 brian  staff       0 Jun  4 10:22 __init__.py
-rw-r--r--   1 brian  staff     155 Jun  4 13:56 __init__.pyc
-rw-r--r--   1 brian  staff     503 Jun  4 10:22 manage.py
drwxr-xr-x  20 brian  staff     680 Jun  5 14:54 polls
-rw-r--r--   1 brian  staff    5273 Jun  5 15:00 settings.py
-rw-r--r--   1 brian  staff    2955 Jun  5 15:00 settings.pyc
drwxr-xr-x   2 brian  staff      68 Jun  4 14:04 sqlite3.db
-rw-r--r--   1 brian  staff  147456 Jun  5 11:42 sqlite3.dp
-rw-r--r--   1 brian  staff    1048 Jun  5 10:16 urls.py
-rw-r--r--   1 brian  staff     464 Jun  5 10:18 urls.pyc
server:mysite brian$ ls -l polls/
total 104
-rw-r--r--  1 brian  staff     0 Jun  4 14:23 __init__.py
-rw-r--r--  1 brian  staff   151 Jun  4 14:33 __init__.pyc
-rw-r--r--  1 brian  staff   505 Jun  4 16:33 admin.py
-rw-r--r--  1 brian  staff  1123 Jun  4 16:33 admin.pyc
-rw-r--r--  1 brian  staff   263 Jun  5 14:54 app.yaml
-rw-r--r--  1 brian  staff   524 Jun  4 14:50 models.py
-rw-r--r--  1 brian  staff  1484 Jun  4 14:50 models.pyc
-rw-r--r--  1 brian  staff   383 Jun  4 14:23 tests.py
-rw-r--r--  1 brian  staff   708 Jun  5 11:26 urls.py
-rw-r--r--  1 brian  staff   902 Jun  5 11:42 urls.pyc
-rw-r--r--  1 brian  staff  1154 Jun  5 11:41 views.py
-rw-r--r--  1 brian  staff  1231 Jun  5 11:42 views.pyc
server:mysite brian$ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:55:03.530

尝试添加

```
import os
os.environ['DJANGO_SETTINGS_MODULE'] = 'settings' 
```

在您知道的某个地方，每个请求都会调用它。请注意，os.environ 是 python27 的 threadlocal，因此在初始导入时设置可能还不够。

# wpf - 嵌套 ListView 的绑定不起作用

> ID：10903677
> 
> 赞同：0
> 
> 时间：2012-06-05T19:31:07.590
> 
> 标签：wpf, xaml, listview

我有一个嵌套的 ListView，但 ItemSource 绑定永远不会触发。我在这里错过了什么吗？在这里你可以看到我的父列表视图，它绑定得很好。但是嵌套的没有。

```
<ListView ItemsSource="{Binding Items}">
        <ListView.View>
            <GridView>
                <GridViewColumn>
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Horizontal" Grid.Row="0">
                                    <CheckBox IsChecked="True" Margin="0,0,5,0"></CheckBox>
                                    <TextBlock Text="{Binding Name}" Margin="0,0,15,0"/>
                                    <TextBlock Text="Task Set Loop: "/>
                                    <TextBox Text="{Binding Scenarios}"/>
                                </StackPanel>
                                <ListView Grid.Row="1" ItemsSource="{Binding ChildItems, Converter={StaticResource DebugBindingConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" Grid.Row="0">
                                                <CheckBox IsChecked="True" Margin="0,0,5,0"></CheckBox>
                                                <TextBlock Text="{Binding Name}" Margin="0,0,15,0"/>
                                                <ComboBox SelectedItem="{Binding DependentTaskName}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Grid>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T11:49:18.727

我对 ChildItems 的绑定处于错误的级别。将该行更改为：

```
<ListView Grid.Row="1" ItemsSource="{Binding Path=DataContext.ChildItems, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-12T12:34:43.173

对于 UWP 我们可以这样得到

```
<GridView x:Name="abc" ItemsSource="{Binding Path=DataContext.Companies,RelativeSource={RelativeSource Mode=TemplatedParent}}"></GridView> 
```

# php - 使用 PHP、Zend 和 openssl 对 PDF 进行数字签名

> ID：10903682
> 
> 赞同：12
> 
> 时间：2012-06-05T19:31:28.983
> 
> 标签：php, zend-framework, pdf, openssl, sign

我正在尝试使用 PHP、openssl 和 Zend 框架（用于 pdf 重新处理/处理）构建一个简单的 PDF 文档签名例程。

我找到[了这个](http://framework.zend.com/issues/browse/ZF-10950)，但它根本不起作用，Zend 无法打开任何 pdf，甚至 Zend 自己的测试 pdf 也无法打开，Zend 不会报告原因，只是它“不能”。

我很确定我将能够有效地创建密钥/证书，因为这是有据可查的，但是是否有可靠的方法将生成的证书附加到 PDF，就像上面的 Zend 扩展所暗示的那样？

```
function DigiSignPDF ($pdf_sign_request) {
    if (get_magic_quotes_gpc()) {
        $new_pdf = stripslashes($pdf_sign_request['raw_pdf']);
    } else {
        $new_pdf = $pdf_sign_request['raw_pdf'];
    }
    $test_pdf = stripslashes(file_get_contents('path/Some.pdf'));
    $test_pdf2 = ('path/Some.pdf');
    $pdf = Zend_Pdf::load($new_pdf2);
    //below is the signing code, from another library, it works as long as Zend_Pdf works
    $certificate = file_get_contents('path/certificate.p12');
    $certificatePassword = 'test123';

    if (empty($certificate)) {
        throw new Zend_Pdf_Exception('Cannot retrieve/generate the certificate.');
    }
    $pdf->attachDigitalCertificate($certificate,$certificatePassword);
    $eSig_pdf = $pdf->render();
    file_put_contents('path/signed_pdf.pdf', $eSig_pdf);
} 
```

编辑，添加代码：以上仅在我使用“test_pdf2”作为 Zend_Pdf 的输入时才有效。它可以毫无问题地将证书识别为二进制文件，但我需要能够在不将其写入磁盘的情况下传递 PDF。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-05T19:47:45.430

[TCPDF](http://www.tcpdf.org/)支持对 pdf 文件进行[签名](http://www.tcpdf.org/examples/example_052.phps)。也许您在源代码中发现了一些有用的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T20:11:57.093

根据 halfer 的建议，添加我的解决方案作为答案：解决了这个问题，因为我将内容作为字符串传递给 Zend_Pdf，我应该一直使用 Zend_Pdf::parse($new_pdf);，正如手册中很可能所说的那样。（哎呀）

更远; 正如这里的几篇文章所建议的那样，通过迁移到 TCPDF，我解决了几乎所有关于对各种版本的 PDF 和表格组成部分进行数字签名的问题。但是，在使用字符串时，TCPDF 遇到了类似的警告，请确保您使用的是 TCPDF 的“writeHTMLCell”而不是“writeHTML”。并注意 PHP 的“magic_quotes”、错误的空格、编码和妖精。

# c# - 不使用 LDAP 搜索 Active Directory

> ID：10903683
> 
> 赞同：0
> 
> 时间：2012-06-05T19:31:30.103
> 
> 标签：c#, active-directory

我在 WinXP/Win7/WinServer2003 环境中的 VS2008 中使用 C#。

有没有办法在不涉及 LDAP 的情况下搜索活动目录？

我在 Active Directory 中创建了用户，但是当我使用它进行搜索时

```
 DirectorySearcher dirSearcher = new DirectorySearcher(
            new DirectoryEntry("LDAP://DC=kmmnet,DC=com"),
            "(objectClass=user)",
            new string[] { "sAMAccountName", "displayname", "givenname", "sn" });
        foreach (SearchResult s in dirSearcher.FindAll())
        {
            System.DirectoryServices.PropertyCollection p = s.GetDirectoryEntry().Properties;
        } 
```

它无法找到某些用户。

谢谢肖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:47:37.227

尝试将 PageSize 属性从其默认值 0 提高：

```
dirSearcher.PageSize = 9000; 
```

PageSize 的任何非零值都将导致分页发生，因此您将收到所有结果（批量等于 PageSize）。

您还可以尝试更多地过滤搜索（例如，排除非活动用户等）。

并且，目录服务器响应 LDAP 查询[返回的结果数量有上限。](https://stackoverflow.com/questions/1508150/is-the-directorysearcher-object-capped-at-5000-even-if-pagesize-is-set-to-greate)此限制由域上的管理员控制和设置。我相信默认值是 1000。

# javascript - 用于递归随机数的 JavaScript

> ID：10903687
> 
> 赞同：0
> 
> 时间：2012-06-05T19:31:32.770
> 
> 标签：javascript, math, random, for-loop

我正在尝试创建一个接受 2 个参数`min`并`max`在两个整数之间生成随机数的 javascript 函数。那部分很容易。

事情变得粗糙的地方是我需要创建一个条件来说明

```
function generateNum (min, max) {
  var randNumber = Math.ceil(Math.random()*(max - min)+min);

  if (randNumber === max) {
    // store the result (probably in an array) and generate a new 
    // number with the same behavior as randNumber (e.g. it is also
    // stores it's total in the array and recursively "re-generates 
    // a new number until max is not hit)
  }
} 
```

想法是对其进行递归处理，以便存储、组合并返回最大命中数的总和。

例如：脚本接收 5/10 的 min / max 参数`generateNum(5,10){}`。如果由 生成的值`randNumber`是 5、6、7、8 或 9，那么将没有递归，函数将返回该值。如果由 is 生成的值`randNumber`，`10`则该值`10`存储在一个数组中，并且该函数现在递归地“重试”（意味着生成了 10 次，然后该值作为附加对象存储在数组中，并且功能重试）。当过程停止时（可能是无限的，但每次递归重复的概率呈抛物线递减）。最终数字 (5, 6, 7, 8, 9) 将添加到生成`max`值的总数中并返回结果。

相当不寻常的数学场景，如果这没有意义，请告诉我如何澄清。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:43:38.520

> 那部分很容易。

没有你想的那么简单……你的算法坏了；它几乎永远不会给你最小值。改用该`Math.floor`方法，并在范围内添加一个：

```
var randNumber = Math.floor(Math.random() * (max - min + 1)) + min; 
```

递归地执行此操作很简单，只需从自身调用该方法：

```
function generateNum (min, max) {
  var randNumber = Math.floor(Math.random()*(max - min + 1)) + min;
  if (randNumber == max) {
    randNumber += generateNum(min, max);
  }
  return randNumber;
} 
```

您也可以在不递归的情况下解决此问题：

```
function generateNum (min, max) {
  var randNumber = 0;
  do {
    var num = Math.floor(Math.random()*(max - min + 1)) + min;
    randNumber += num;
  } while (num == max);
  return randNumber;
} 
```

在这两种情况下都不需要使用数组，因为你最终不需要单独的值，你只需要值的总和。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:36:33.077

我假设您实际上并不需要递归解决方案，因为您标记了 this `for-loop`。这将返回选择最大数量的次数：

```
function generateNum (min, max) {
    var diff = max - min;
    if(diff <= 0)
        return;

    for(var i = 0; diff == Math.floor(Math.random()*(diff + 1)); i++);

    return i;
} 
```

示例输出：

```
generateNum(1,2)  // 3
generateNum(1,2)  // 1
generateNum(1,2)  // 0
generateNum(5,10) // 0
generateNum(5,10) // 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:36:59.563

递归方法：

```
function generateNum (min, max) {
  var res = Math.floor(Math.random() * (max - min + 1)) + min;

  return (res === max) ? [res].concat(generateNum(min, max)) : res;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T19:38:50.487

两件事情：

1) 滚 10 次的概率保持不变（理论上每次滚都相同（重试）），低概率是连续击中 n 次 10

2）我不明白为什么需要递归，while循环呢？

```
 var randNumber;
 var arr = [];
 while ((randNumber = Math.ceil(Math.random()*(max - min)+min)) === max) {
   arr.push(
 } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T20:22:12.760

我会考虑一个想法，即您不仅不需要使用递归和数组，甚至不需要使用 for 循环。我认为您需要一个像这样的简单表达式（为清楚起见，分为三个）：

```
function generateNum (min, max)
{
    var randTail = Math.floor(Math.random()*(max - min)+min);
    var randRepeatMax = Math.floor(Math.log(Math.random()) / Math.log(1/(max-min+1)));
    return randRepeatMax*max + randTail;
} 
```

假设一个随机数与另一个随机数一样好，这应该为您提供与直接循环相同的值分布。

# sql-server - 为 Sql Server 安装全文功能（兼容性问题）

> ID：10903688
> 
> 赞同：0
> 
> 时间：2012-06-05T19:31:32.760
> 
> 标签：sql-server

我目前安装了 Ms Sql Server Express 2005。我需要安装来自 Microsoft 的“具有高级服务的 SQL Server Express”，可在此处找到（以启用全文搜索功能）：

[http://www.microsoft.com/betaexperience/pd/SQLEXPCTAV2/enus/default.aspx](http://www.microsoft.com/betaexperience/pd/SQLEXPCTAV2/enus/default.aspx)

**问题是：“Express with advanced services”组件来自 2012 年，而我的 Ms Sql Server 来自 2005 年。它们兼容吗？如果我运行此服务，是否会冒着弄乱 Sql Server 安装的风险？** 我的时间很短，我不想弄乱我的安装并不得不重新安装。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:56:54.787

使用高级服务安装 Express 将安装 SQL Server 的新实例。兼容性无关紧要，因为只有新的 Express 实例具有全文功能，而您现有的 SQL Server 2005 实例将无法使用它。您可能想要为已安装的实例安装全文 - 您可以通过现有 SQL Server 2005 实例的“添加/删除程序”来执行此操作（假设您仍有 SQL Server 2005 的安装介质），其中将调用安装中心，您可以在其中选择向现有实例添加功能。

# objective-c - Thread1：程序接收信号“SIGBRT”

> ID：10903690
> 
> 赞同：0
> 
> 时间：2012-06-05T19:31:38.650
> 
> 标签：objective-c, ios5, sqlite, xcode4.2

我正在使用 ios 5 上的 sqlite 数据库。我的应用程序所做的是它在文本字段中获取字符串并将其保存到数据库中。当我运行该应用程序时，它会崩溃并给出以下警告：

> Thread1：程序接收信号“SIGBRT”

它在 main.m 和这一行中给出了这个：

```
return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class])); 
```

有人可以帮我吗？将不胜感激！:( 我使用的是 xcode 4.2。

这是编译器说发生断言失败的方法。

```
- (void) addstrings{    
    if(addStmt == nil) {
    const char *sql = "insert into strings(strings) Values(?)";
    if(sqlite3_prepare_v2(database, sql, -1, &addStmt, NULL) != SQLITE_OK)
        NSAssert1(0, @"Error while creating add statement. '%s'", sqlite3_errmsg(database));
    }

    sqlite3_bind_text(addStmt, 1, [strings UTF8String], -1, SQLITE_TRANSIENT);

    if(SQLITE_DONE != sqlite3_step(addStmt))
        NSAssert1(0, @"Error while inserting data. '%s'", sqlite3_errmsg(database));
    else
        //SQLite provides a method to get the last primary key inserted by using sqlite3_last_insert_rowid
        strID = sqlite3_last_insert_rowid(database);

    //Reset the add statement.
    sqlite3_reset(addStmt);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:34:02.300

如果没有更多信息，就不可能准确地知道程序中发生了什么，但调用 abort() 的最常见原因是：

1.  您向不支持/实现该消息的 Objective-C 对象发送消息。这会导致可怕的“无法识别的选择器发送到实例”错误。
2.  你在某处有一个失败的断言。在定义宏 NDEBUG 的非调试版本中，标准库宏 assert(3) 在断言失败时调用 abort()。
3.  您有一些内存踩踏/分配错误。当 malloc/free 检测到损坏的堆时，可能会调用 abort()。这意味着：您正在释放已经完成的内存，可能是通过向对象发送太多释放消息。另一件事是您可能无法将对象连接到 nib 中的 IBOutlet。我真的不能说，因为除了报告的错误之外，您没有提供任何其他信息。

4.  您正在抛出未捕获的异常（C++ 异常或 Objective-C 异常）。

在几乎所有情况下，调试控制台都会为您提供有关导致 abort() 被调用的原因的更多信息，因此请务必查看那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T09:20:06.847

此`SIGABRT`错误可能在各种情况下发生，

就像你试图在`DB`没有打开的情况下关闭，或者试图在没有打开的情况下`DB`写入一些值。`DB``DB`

或者可能是几个原因，所以在这里发布一些代码。

# sql-server - 在 wamp 服务器中使用 sqlsrv 驱动程序与 mssql 的 codeigniter 连接

> ID：10903696
> 
> 赞同：2
> 
> 时间：2012-06-05T19:31:53.487
> 
> 标签：sql-server, codeigniter, wamp

我无法将 mssql 与 wamp 服务器中的 codeigniter 连接起来

我收到以下错误

发生数据库错误 无法使用提供的设置连接到您的数据库服务器。

文件名：C:\wamp\www\secure.leaftrack.com\system\database\DB_driver.php

行号：124

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T18:08:23.507

经过几天的问题，我的公司能够解决这个问题。

我们从 PHP 5.2.11 版开始使用 mssql 的 dll。一旦我们更新到 5.2.17，它就被修复了！

# iphone - UIScrollView 在页面中间？

> ID：10903700
> 
> 赞同：0
> 
> 时间：2012-06-05T19:32:15.693
> 
> 标签：iphone, objective-c, ios, uiview

我正在为我的应用程序开发 UI，并且需要`UIScrollView`在页面中间添加一些内容。我`UIView`在主视图中有一个 (a) 集。像这样的东西

![在此处输入图像描述](../Images/716e51888868727e6a75241558a258ea.png)

我在同一个xib中有另一个UIView，在那个UIView（b）中有uiscrollview，例如：

![在此处输入图像描述](../Images/88f685287b875479ad7ff921653b82d1.png)

现在，当我设置以下内容时：

```
[a addSubview:b]; 
```

`UIView`a 做了类似的事情：

![在此处输入图像描述](../Images/2666d27b951efacc159d79009048b806.png)

这个你能帮我吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:26:49.590

如果您希望它滚动到您的第二个按钮，您需要在代码中设置滚动视图的 contentSize。看看这个问题的答案：[我如何自动调整 UIScrollView 的大小以适应内容](https://stackoverflow.com/questions/2944294/how-i-auto-size-a-uiscrollview-to-fit-the-content)

# python - 我需要将字典附加到字典字典中

> ID：10903702
> 
> 赞同：0
> 
> 时间：2012-06-05T19:32:30.157
> 
> 标签：python, dictionary

好的，我有一本字典，叫做食物。食物有两个元素，它们本身就是字典，蔬菜和奶制品。蔬菜有两个元素根：萝卜，茎：芦笋。乳制品有奶酪：切达干酪和酸奶：草莓。我还有一本新的字典水果，有红色：樱桃和黄色：香蕉。

```
food['veg']['root'] == 'Turnip'
food['dairy']['cheese'] == 'Cheddar' 
```

等和

```
fruit['red'] == 'Cherry' 
```

现在我想将“fruit”字典完整地添加到“food”字典中，这样我将拥有：

```
food['fruit']['red'] == 'Cherry' 
```

我知道我可以做这样的事情：

```
food['fruit'] = fruit 
```

但这似乎很笨拙。我想做类似的事情

```
food.Append(fruit) 
```

但这并不能满足我的需要。

（编辑删除了变量名的首字母大写，因为这似乎引起了分心。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T19:34:54.347

`Food['Fruit'] = Fruit`是正确的方式*（除了大写的名字）*。

正如@kindall 在评论中明智地指出的那样，可以有多个名称引用同一个字典，这就是为什么不能构建一个将对象映射到其名称并将其用作`food`字典中的新键的函数的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T19:53:54.327

我知道你想做什么。您正试图避免在 python 中使用[DRY 。](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)可悲的是，python 和许多其他语言在这方面非常糟糕。

但主要问题是**您将变量的名称与程序中的值混合在一起。这是许多编程语言中常见的错误。**

如果你真的想这样做，你绑定到`fruit=...`变量的东西需要知道它的名字。

*   你想说的是，在 python 中“将这个 dict 移植到另一个 dict 上”。
*   Python 要求你说它就像“将这个 dict 移植到另一个 dict 上，将它附加在`"Fruit"`”
*   解决这个问题的唯一方法是“水果”这个名字已经存在于某个地方。但它没有：它只存在于一个变量名中，而不是在你的程序中。

有两种解决方案：

*   您可以避免创建`fruit=...`变量，而是直接只移植`"Fruit"`名称。因此，您只需键入一次“Fruit”，而不是不键入`somedict["Fruit"]`您想要的，我们避免键入变量名称。这是通过以匿名方式编程来完成的：

    ```
    somedict["Fruit"] = {'red':'apple', 'yellow':'banana'} 
    ```

可悲的是，如果您的构造需要语句，python 不会让您这样做；如果你只有一个文字，你只能逃脱这个。另一个解决方案是：

*   您可以创建一个为您执行此操作的函数：

    ```
    graft(somedict, "Fruit", {'red':'apple', 'yellow':'banana'}) 
    ```

遗憾的是，如果您的构造需要任何类型的声明，这也将不起作用。您可以创建一个变量`x={'red':...}`或其他东西，但这违背了整个目的。第三种方式，您不应该使用，是`locals()`，但这仍然需要您参考名称。

总之，如果您需要大量的 for 循环和函数以及 if 语句，那么您尝试做的事情在 python 中是不可能的，除非您更改构建`fruit=...`字典的整个方式。多行 lambda、字典推导 ( `dict((k,v) for k,v in ...)`)、内联`IFTRUE if EXPR else IFFALSE`等的组合是可能的。这种风格的危险在于它很快就会变得难以阅读。

如果您能够将您的字典表示为文字字典、字典理解或您已经编写的函数的输出，则这是可能的。事实上，这很容易（见其他答案）。不幸的是，最初的问题并没有说明您是如何构建这些词典的。

假设这些答案不能回答您的问题（也就是说，您正在以非常复杂的方式构建这些），您可以编写“元”代码：为您制作字典的代码，并滥用反射。然而，python 中最好的解决方案是尝试通过迭代来制作你的字典。例如：

```
foods = {
    "Fruit": {...},
    "Meats": makeMeats(),
}
for name,data in ...:
    foods[name] = someProcessing(data)
foods.update(dataFromSomeFile)  #almost same as last two lines 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T19:39:52.113

你有什么理由使用方括号吗？因为你可以用嵌套的文字字典来表示这个数据结构：

```
food = {
    'veg': {
        'red': 'tomato',
        'green': 'lettuce',
    },

    'fruit': {
        'red': 'cherry',
        'green': 'grape',
    },
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T19:35:57.503

您不能追加，因为字典不是列表：它没有顺序。您要做的是使用新的键/值对更新字典。你需要使用：

```
Food['Fruit'] = Fruit 
```

或者，或者：

```
Food.update({'Fruit': Fruit}) 
```

不相关的说明：用大写字母编写变量不是 Python 编码风格。`Fruit`将被写为`fruit`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T21:35:13.683

您遇到的基本问题是您的字典不知道自己的名称。这是正常的；通常，可以将任意数量的名称绑定到 Python 对象，并且没有任何一个名称以任何方式优于其他任何名称。换句话说， in `a = {}; b = a`、`a`和`b`都是同一个字典的名称，并且`a`不是字典的“真实”名称，因为它是首先分配的。事实上，字典甚至无法知道变量左侧的名称是什么。

因此，一种替代方法是让字典包含其自己的名称作为键。例如：

```
fruit = {"_name": "fruit"}
fruit["red"] = "cherry"

food[fruit["_name"]] = fruit 
```

好吧，这并没有多大帮助，不是吗？它在某种程度上做到了，因为`fruit`现在不再是`food`字典附件中的字符串，所以如果你输入错误，至少 Python 会给你一个错误消息。但实际上，您输入“fruit”的次数比以前更多：您现在必须在创建词典时输入它，以及将它附加到另一个词典时输入它。一般来说，打字要多一些。

此外，将名称作为字典中的项目*有点*不方便。当您遍历字典时，您必须编写代码来跳过它。

你可以编写一个函数来为你做附件：

```
def attach(main, other):
    main[other["_name"]] = other 
```

然后，当您将子词典附加到主词典时，您不必重复自己：

```
fruit = {"_name": "fruit"}
fruit["red"] = "cherry"

attach(food, fruit) 
```

当然，现在您实际上可以创建一个知道自己名称的字典*子类，并且可以附加一个命名的子字典。*作为奖励，我们可以将名称作为字典的*属性*，而不是将其存储*在*字典中，这将使实际字典更整洁。

```
class NamedDict(dict):

    def __init__(self, name="", seq=(), **kwargs):
        dict.__init__(self, seq, **kwargs)
        self.__name__ = name

    def attach(self, other):
        self[other.__name__] = other

food  = NamedDict("food")

fruit = NamedDict("fruit")
fruit["red"] = "cherry"

food.attach(fruit) 
```

但是我们仍然有一个重复，当`NamedDict`最初定义时：`food = NamedDict("food")`例如。我们如何免除它？

这*是*可能的，虽然很笨拙，而且可能不值得麻烦。Python 有两种具有“固有”名称的对象：类和函数。换句话说：

```
class Foo:
    pass 
```

上面不仅创建了一个`Foo`在当前命名空间中命名的变量，类名也方便的存储在类的`__name__`属性中。（函数做类似的事情。）通过滥用类和元类，我们可以利用底层机制来*完全*避免重复自己——有一个*小*缺点，就是必须把我们的字典当作类来编写！

```
class NamedDict(dict):

    class __metaclass__(type):

        def __new__(meta, name, bases, attrs):
            if "NamedDict" not in globals():   # we're defining the base class
                return type.__new__(meta, name, bases, attrs)
            else:
                attrs.pop("__module__", None)  # Python adds this; do not want!
                return meta.NamedDict(name, **attrs)

        class NamedDict(dict):
            def __init__(self, name, seq=(), **kwargs):
                dict.__init__(self, seq, **kwargs)
                self.__name__ = name

            def attach(self, other):
                self[other.__name__] = other

        __call__ = NamedDict 
```

现在，我们不再以通常的方式定义我们的字典，而是将它们声明为`NamedDict`. 由于元类，子类化外部`NamedDict`类实际上创建了内部类的*实例*`NamedDict`（与以前相同）。我们定义的子类的属性（如果有的话）成为字典中的项目，例如`dict()`.

```
class food(NamedDict): pass

class fruit(NamedDict): red = "cherry"

# or, defining each item separately:

class fruit(NamedDict): pass
fruit["red"] = "cherry"

food.attach(fruit) 
```

作为奖励，您仍然可以`NamedDict`通过将其实例化为类来定义“常规”方式：

```
fruit = NamedDict("fruit", red="cherry") 
```

但是请注意：“真正是字典的类”对于 Python 来说是一个非常不标准的习语，我建议你不要真正这样做，因为其他程序员根本不会发现它很清楚。尽管如此，这仍然是在 Python 中完成的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T19:40:43.187

您可能正在寻找 defaultdict。每当您要求新的第一级类型时，它都会通过添加一个新的空字典来工作。示例如下所示：

```
from collections import defaultdict

basic_foods = {'Veg' : {'Root' : 'Turnip'}, 'Dairy' : {'Cheese' : 'Cheddar'}}

foods = defaultdict(dict, basic_foods)
foods['Fruit']['Red'] = "Cherry"
print foods['Fruit'] 
```

# validation - CakePHP - 如何检查哪个验证规则失败？

> ID：10903703
> 
> 赞同：0
> 
> 时间：2012-06-05T19:32:30.293
> 
> 标签：validation, cakephp

如何在我的控制器中检查哪个验证规则失败？我想知道'rule2'是否失败，基于验证规则键。

```
public $validate = array(
    'email' => array(
        'rule1' => array(
            'rule' => array('email', true),
            'message' => 'Please enter a valid email address'
        ),
        'rule2' => array(
            'rule' => 'isUnique',
            'message' => 'Email address already registered'
        )
    ),
); 
```

我知道我可以做到`debug($this->User->validationErrors)`，但显示的只是消息，我不想检查消息，因为我将来可能会更改它。

`'email.rule2'`有没有办法根据验证规则键看到失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:55:18.923

对我来说，last 的默认参数是 false 从来没有意义

IMO正确的方法是：

```
public $validate = array(
    'email' => array(
        'rule1' => array(
            'rule' => array('email', true),
            'message' => 'Please enter a valid email address',
            'last' => true
        ),
        'rule2' => array(
            'rule' => 'isUnique',
            'message' => 'Email address already registered'
        )
    ),
); 
```

仅在电子邮件首先有效时才检查唯一性。

不，消息是唯一返回的东西。为什么失败很重要？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:20:08.277

我不确定它是否完全符合您的需要，但试试这个：

```
$errors = $this->ModelName->invalidFields(); 
```

# c++ - 每个进程消耗的内存

> ID：10903708
> 
> 赞同：1
> 
> 时间：2012-06-05T19:32:42.900
> 
> 标签：c++, c, linux, gcc

到目前为止，我如何获得当前分配的总内存（在 Linux 进程中`C/C++ (gcc)`）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:37:11.167

尝试解析[`/proc/self/maps`或`/proc/$PID/maps`](http://lxr.linux.no/linux+v3.4.1/Documentation/filesystems/proc.txt#L315). 查找标记为 的行`[heap]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:47:05.460

我喜欢 Rob 的回答，但这里有一个可能的选择。如果你能负担得起运行时的成本，你可以使用 valgrind 和[massif](http://valgrind.org/docs/manual/ms-manual.html)工具。

# iphone - 绘制渐变方向

> ID：10903709
> 
> 赞同：0
> 
> 时间：2012-06-05T19:32:56.160
> 
> 标签：iphone, objective-c, ipad, core-graphics

所以我有以下代码：

-

```
 (void) drawLinearGradient:(CGRect) rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGFloat locations[] = { 0.0, 0.3, 1.0 };

    CGColorRef grayColor = [UIColor colorWithRed:37/255.f green:37/255.f 
                                            blue:37/255.f alpha:1.0].CGColor; 
    CGColorRef blueColor = [UIColor colorWithRed:23.0/255.0 green:171.0/255.0 
                                            blue:219.0/255.0 alpha:1.0].CGColor;

    NSArray *colors = [NSArray arrayWithObjects: (id) grayColor, (id) grayColor, (id) blueColor, nil];

    CGGradientRef gradient = CGGradientCreateWithColors(colorSpace, 
                                                        (CFArrayRef) colors, locations);

    CGPoint startPoint = CGPointMake(CGRectGetMidX(rect), CGRectGetMinY(rect));
    CGPoint endPoint = CGPointMake(CGRectGetMidX(rect), CGRectGetMaxY(rect));

    CGContextSaveGState(context);
    CGContextAddRect(context, rect);
    CGContextClip(context);
    CGContextDrawLinearGradient(context, gradient, startPoint, endPoint, 0);
    CGContextRestoreGState(context);

    CGGradientRelease(gradient);
    CGColorSpaceRelease(colorSpace);
} 
```

它的作用是从上到下绘制渐变，我怎样才能让它从左到右绘制呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T19:36:16.110

更改这两行：

```
CGPoint startPoint = CGPointMake(CGRectGetMidX(rect), CGRectGetMinY(rect));
CGPoint endPoint = CGPointMake(CGRectGetMidX(rect), CGRectGetMaxY(rect)); 
```

到：

```
CGPoint startPoint = CGPointMake(CGRectGetMinX(rect), CGRectGetMidY(rect));
CGPoint endPoint = CGPointMake(CGRectGetMaxX(rect), CGRectGetMidY(rect)); 
```

# facebook - 在单个 API 调用中获取friend_likes

> ID：10903713
> 
> 赞同：0
> 
> 时间：2012-06-05T19:33:06.747
> 
> 标签：facebook, api, facebook-graph-api

对于我的应用程序的单个用户，我想找到他/她所有朋友的喜欢。假设我的应用程序需要用户批准应用程序访问 friends_likes[权限](https://developers.facebook.com/docs/authentication/permissions/)，是否可以通过一个（或几个）API 调用获得他/她所有朋友的喜欢？[这篇文章](https://developers.facebook.com/blog/post/2011/03/18/how-to--use-the-graph-api-to-pull-the-movies-friends-like/)建议我必须为我的用户的每个朋友打一个电话；如果可能的话，我想避免这种情况，因为一个用户可能有超过 1000 个朋友。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:53:08.507

是的。您可以在一个[FQL 查询](https://developers.facebook.com/tools/explorer?method=GET&path=fql%3Fq%3DSELECT%20name%2C%20page_id%20FROM%20page%20WHERE%20page_id%20IN%20%28SELECT%20page_id%20FROM%20page_fan%20WHERE%20uid%20IN%20%28SELECT%20uid2%20FROM%20friend%20WHERE%20uid1%20%3D%20me%28%29%29%29)中做到这一点：

```
SELECT name, page_id 
 FROM page 
 WHERE page_id IN 
  (SELECT page_id 
   FROM page_fan 
   WHERE uid IN 
     (SELECT uid2 FROM 
      friend 
      WHERE uid1 = me()
   )
 ) 
```

# android - Android - 提供什么尺寸的图像？

> ID：10903721
> 
> 赞同：2
> 
> 时间：2012-06-05T19:33:32.760
> 
> 标签：android, image, scale, image-resizing, dpi

我有一个由 API 支持的 Android 应用程序。用户可以向此 API 上传照片。然后需要根据几个类别将这些照片缩放到几个不同的密度。

有没有推荐尺寸的地方或以前解决过这个问题的人？

我想我需要填写这个网格，以知道将图像调整（缩小）到什么尺寸（假设用户上传了一个 4000x4000px 的图像，或者其他什么）：

```
Role / Screen | LDPI | MDPI | HDPI | XHDPI |
--------------------------------------------
Icon          |   ?  |   ?  |   ?  |   ?   |
--------------------------------------------
Thumbnail     |   ?  |   ?  |   ?  |   ?   |
--------------------------------------------
Full          |   ?  |   ?  |   ?  |   ?   | 
```

然后 API 将返回一个 JSON 响应，如下所示：

```
{
  resources: {
    icon: {
      ldpi:  "path",
      mdpi:  "path",
      hdpi:  "path",
      xhdpi: "path",
      raw: "path"
    },
    thumbnail: { ... },
    full: { ... }
  }
} 
```

然后，客户端设备可以检查自身的密度，并使用适当的密钥路径来渲染图像。

我知道据此[，](http://developer.android.com/guide/practices/screens_support.html) “你应该遵循 3:4:6:8 的缩放比例”，但是你怎么知道应该使用什么尺寸的图像来缩放其他图像？

**编辑：**如果我的问题过于笼统，这里是精简版：我应该将用户上传的原始图像缩小到什么尺寸，以便它们在各种 Android 设备屏幕上看起来最好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T08:47:47.140

如果我正确理解您的要求，那么事情比您做的要容易。您已经了解 3:4:6:8 的比例，所以这只是您或您的“权力”决定您希望“图标”、“缩略图”和“完整”中的每一个有多大的问题现实生活，然后做数学。

换句话说，缩略图没有“正确”的大小，只有正确的比例才能使它们在不同设备上看起来一致。*您*希望缩略图有多大？

对于初学者，您可以对“图标”使用与 Android 启动器图标相同的尺寸，将“缩略图”的每个尺寸加倍，并为“全屏”使用平均全屏：

```
Role / Screen |  LDPI  |  MDPI  |  HDPI  |  XHDPI  |
----------------------------------------------------
Icon          |  36x36 |  48x48 |  72x72 |  96x96  |
----------------------------------------------------
Thumbnail     |  72x72 |  96x96 | 144x144| 192x192 |
----------------------------------------------------
Full          | 240x320|320x480 | 480x800| 720x1280| 
```

如果您已经知道其中一个与您想要的不同，只需一次更改整行，保持 3:4:6:8 的比例。如果这看起来是一个好的开始，那么做一个模型，看看它的样子。如果模型显示缩略图应该大一点，则将它们全部向上推，保持比例。

基本上可以归结为：

1.  选择一个测试设备并进行实验。
2.  当你有你喜欢的尺寸时，使用 3:4:6:8 的比例来确保你的身材看起来不错，并且在“各种各样的 Android 设备屏幕”上工作得很好。
3.  在具有不同密度和屏幕尺寸的其他设备上进行测试，以确保您选择的尺寸和您设计的布局能够适应您仍然会遇到的微小差异，即使在使用正确的比例后，并在必要时进行调整。

最后，我同意@Devunwired 的观点，即您最好不要只看屏幕密度限定符，还要看屏幕尺寸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:50:57.283

使用每个存储桶的平均设备分辨率来帮助指导您的扩展工作：

*   LDPI 通常在 QVGA (240x320) 左右
*   MDPI 通常在 HVGA (320x480) 附近
*   HDPI 通常在 WVGA (480x800) 左右
*   XHDPI 通常约为 720p (720x1280)

唯一需要注意的是平板电脑。这些数字代表平均手机分辨率。例如，7" 或 10" 平板电脑通常也归类为 MDPI，但分辨率为 1024x600 或 1280x800。

因此，如果您希望通过使用资源限定符对图像进行分类以直接在 JSON 中抓取，您可能还需要添加物理尺寸项目（即`normal`, `large`）`xlarge`来解决这个问题，或者对键使用更通用的命名方案.

高温高压

# ruby - ruby eventmachine：在 Net::telnet 实例上执行 EM.watch 时出现问题

> ID：10903734
> 
> 赞同：1
> 
> 时间：2012-06-05T19:34:42.470
> 
> 标签：ruby, websocket, eventmachine

我正在尝试使用带有 ruby​​ eventmachine 的 HTML5 websocket 编写一个 web telnet 客户端。但是当 EM.watch 尝试监视新创建的 Net::Telnet 实例时它失败了。以下是服务器端和客户端代码：

服务器端：

```
require 'em-websocket'
require "debugger"
require 'net/telnet'

class Foo < EM::Connection
  def initialize(websocket)
    @websocket = websocket
    @alltext = ""
  end

  def notify_readable
        header= @io.recvfrom(2000)[0].chomp
        header2 = header.to_s.encode("UTF-8", :invalid => :replace, :undef => :replace, :replace => "s")
        if header2.length ==1 
             @alltext = @alltext + header2
        else 
            @alltext.each_line do |x| 
                 $stdout.puts x
                 @websocket.send x
            end

           @alltext = ""
           header2.to_s.each_line do |y|
                $stdout.puts y
                @websocket.send  y
            end
        end

        if header == "\r\n"
           fd = detach
        end
        rescue EOFError
              detach
  end

def unbind
    EM.next_tick do

    end
    puts "close the socket:" + @io.to_s
end
end

EventMachine::WebSocket.start(:host => "0.0.0.0", :port => 8090) do |ws|
      ws.onopen    { 
                puts "Web socket is opened"
                ws.send "terminal to the node"
                          nodeSocket = Net::Telnet::new("Host" => "10.4.0.50","Timeout" => 10,"Prompt" => /login/ )
                          puts nodeSocket
                nodeSocket.cmd("username") { |c| print c}
                nodeSocket.cmd("password") { |c| print c}

                           EM.run{
                          $conn = EM.watch nodeSocket,Foo,ws
                           $conn.notify_readable = true
                 }

      }

      ws.onmessage { |msg| 
                puts msg
                ws.send msg
      }

      ws.onclose   { 
            puts "WebSocket closed" 
      }
end 
```

克林特方面：

```
require 'eventmachine'
require 'em-http-request'

EventMachine.run {
  http = EventMachine::HttpRequest.new("ws://localhost:8090").get :timeout => 0
  http.errback { puts "oops" }
  http.callback {
  puts "WebSocket connected!"
  http.send("Hello client")
 }

http.stream { |msg|
   puts "Recieved: #{msg}"

 }
} 
```

服务器端日志

```
C:\Ruby193\bin>ruby websocketserver12.rb
Web socket is opened
#<Net::Telnet:0xf976e0>
------------------Welcome to syseng1--------------------
This machine is the Server
--------------------------------------------------------
Ubuntu 8.04.3 LTS
syseng1 login: username
Password:
Last login: Tue Jun  5 15:05:00 EDT 2012 from 358.ystems.com on pts/0
Linux syseng1 2.6.24-24-generic #1 SMP Fri Jul 24 22:46:06 UTC 2009 i686

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/
You have mail.
←[01;32musername@syseng1 ←[01;34m~ $ ←[00mWebSocket closed
C:/Ruby193/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.0.beta.4.1-x86-    mingw32/lib/eventmachine.rb:735:in `attach_fd': can't convert Net::Telnet into Integer (TypeError)
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.0.beta.4.1-x86-mingw32/lib/eventmachine.rb:735:in `attach_io'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.0.beta.4.1-x86-mingw32/lib/eventmachine.rb:708:in `watch'
    from websocketserver12.rb:57:in `block (3 levels) in <main>'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.0.beta.4.1-x86-mingw32/lib/eventmachine.rb:163:in `call'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.0.beta.4.1-x86-mingw32/lib/eventmachine.rb:163:in `run'
    from websocketserver12.rb:56:in `block (2 levels) in <main>'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/em-websocket-0.3.6/lib/em-websocket/connection.rb:20:in `call'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/em-websocket-0.3.6/lib/em-websocket/connection.rb:20:in `trigger_on_open'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/em-websocket-0.3.6/lib/em-websocket/handler.rb:18:in `run'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/em-websocket-0.3.6/lib/em-websocket/connection.rb:114:in `dispatch'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/em-websocket-0.3.6/lib/em-websocket/connection.rb:71:in `receive_data'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.0.beta.4.1-x86-mingw32/lib/eventmachine.rb:179:in `run_machine'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.0.beta.4.1-x86-mingw32/lib/eventmachine.rb:179:in `run'
    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/em-websocket-0.3.6/lib/em-websocket/websocket.rb:9:in `start'
    from websocketserver12.rb:47:in `<main>' 
```

看起来 EM.watch 无法观看 Net::Telnet::new 实例，因为它无法将文件句柄转换为 lib 中某处的 Integer。我用 EM.watch 尝试了同样的事情来观察 TCPSocket，这个事件机器工作得很好。以前有人有同样的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-23T20:38:05.170

引发错误`in `attach_fd': can't convert Net::Telnet into Integer (TypeError)`是因为 Eventmachine.watch() “[使用 eventloop 注册给定的文件描述符或 IO 对象](http://www.rubydoc.info/github/eventmachine/eventmachine/EventMachine.watch)”，而 Net::Telnet 实例不是这些。

根据 Net::Telnet[文档](http://docs.ruby-lang.org/en/2.0.0/Net/Telnet.html#attribute-i-sock)，Net::Telnet 实例的 sock 属性是指实例使用的套接字。所以你可以将它传递给 EventMachine.watch() 方法。

# malloc - jemalloc 和并发哈希映射

> ID：10903738
> 
> 赞同：1
> 
> 时间：2012-06-05T19:35:01.007
> 
> 标签：malloc

我有巨大的`concurrent hash map ( ACE )`，当我说巨大的时候，我正在做很多很多的`put`操作`get`。这是在`windows`平台上。最近我在阅读`jemalloc`，

对于上述场景，如果我使用`jemalloc`，它会帮助我提高性能并避免内存碎片。

# mysql - 用于编辑 MySQL 表权限的工具？

> ID：10903746
> 
> 赞同：0
> 
> 时间：2012-06-05T19:35:37.313
> 
> 标签：mysql, security, database-permissions

有没有一种工具可以使在 MySQL 数据库上编辑用户权限的任务变得更容易？我有近 100 个表可供 4 个用户使用，每个用户都有不同的每表授权，这通过 phpMyAdmin 变得乏味。当我稍后对数据库结构和用户列表进行更改时，它会变得更加烦人。我也看不到在 MySQL Workbench 中执行此操作的方法。

是否有任何权限管理工具可以更轻松地管理表权限？

**更新：**为了澄清，我需要一个可以为用户管理每个模式和每个表权限的工具。稍后我将更改权限，因此它需要能够完全管理现有权限以及授予新权限。MySQL Workbench 允许管理每个模式的权限，但不能管理每个表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:43:46.850

mysql gui 工具。请参阅此处[http://dev.mysql.com/downloads/gui-tools/5.0.html](http://dev.mysql.com/downloads/gui-tools/5.0.html) MySQL Administrator 允许您完成所有这些工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-04T15:10:10.920

我意识到这个问题已经存在几年了，但是我在寻找解决方案时遇到了它，所以我想其他人也可能会这样做。

我遇到了 SQL Yog，发现它能够做我想做的所有事情。我使用社区版本，因此可以免费下载，并且它的用户管理器能够在模式和表级别设置权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T12:03:01.963

试用[dbForge Studio for MySQL中的安全管理](http://www.devart.com/dbforge/mysql/studio/)[器](http://www.devart.com/dbforge/mysql/studio/database-administration.html)工具（*安全管理器在免费的 Express Edition 中可用*）。

 *新版本支持多用户编辑；您可以选择一些用户并授予或撤销全局和对象（数据库、表、字段等）权限，然后应用更改或在 SQL 脚本中查看它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T19:40:34.613

您可能想查看[www.securich.com](http://www.securich.com) - 它是 MySQL 的开源用户管理工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:41:41.613

Workbench 应该让您管理用户和授予权限 - 请参见[此处](http://www.mysql.com/products/workbench/admin/)。你也可以使用[Navicat](http://www.navicat.com/)（不是免费的），或者如果你在 Mac 上，可以使用免费的[Sequel Pro](http://www.sequelpro.com/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T19:43:03.297

MySQL Workbench 提供了这个功能。

1.  通过“服务器管理”打开连接
2.  点击“用户和权限”
3.  选择“架构特权”选项卡
4.  根据您的需要，为您正在处理的架构创建条目。

更多信息[在这里](http://www.mysql.com/products/workbench/admin/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-05T22:31:30.670

刚刚在这里查看了我安装的 Squirrel-SQL。我在这个副本中只有 Oracle 数据库，但我在家里将它用于 MySQL。无论如何，对于 Oracle，对于表，它有两个选项卡：Privileges 和 Column Privileges。它可能会也可能不会为 MySQL 提供类似的功能。不妨看看。（我喜欢它用于其他数据库工作。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-07T14:32:27.587

phpMyAdmin 允许表级权限。[例如，可以在此处](http://wiki.phpmyadmin.net/pma/user_management)和[此处](http://www.westworld.be/phpmyadmin-table-specific-privileges/)找到更多详细信息 。*

# python - 在 numexpr 中限制子表达式

> ID：10903748
> 
> 赞同：4
> 
> 时间：2012-06-05T19:35:46.330
> 
> 标签：python, numpy, pytables, numexpr

我如何有效地表达以下使用[`numexpr`](http://code.google.com/p/numexpr/)？

```
z = min(x-y, 1.0) / (x+y) 
```

这里是一些相同形状的大型 NumPy 数组`x`。`y`

换句话说，我试图`x-y`在`1.0`除以之前限制`x+y`。

我想使用单个`numexpr`表达式来做到这一点（`x`并且`y`很大，我不想多次迭代它们）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T20:18:01.343

也许这样的事情会起作用？

```
In [11]: import numpy as np
In [12]: import numexpr as ne    
In [13]:     
In [13]: x = np.linspace(0.02, 5.0, 1e7)
In [14]: y = np.sin(x)
In [15]:     
In [15]: timeit z0 = ((x-y) - ((x-y) > 1) * (x-y - 1))/(x+y)
1 loops, best of 3: 1.02 s per loop
In [16]: timeit z1 = ne.evaluate("((x-y) - ((x-y) > 1.) * ((x-y) - 1.))/(x+y)")
10 loops, best of 3: 120 ms per loop    
In [17]: timeit z2 = ne.evaluate("((x-y)/(x+y))")
10 loops, best of 3: 103 ms per loop 
```

超过该部门的上限会受到处罚，但这并不算太糟糕。不幸的是，当我为一些更大的数组尝试它时，它出现了段错误。：-/

更新：这更漂亮，也更快一点：

```
In [40]: timeit w0 = ne.evaluate("where(x-y>1,1,x-y)/(x+y)")
10 loops, best of 3: 114 ms per loop 
```

# c# - 从 C# 访问 JavaScript 数组元素（通过 WebBrowser）？

> ID：10903750
> 
> 赞同：9
> 
> 时间：2012-06-05T19:35:50.210
> 
> 标签：c#, javascript, com, browser

在窗体上使用 WebBrowser 并使用 window.external 从 Javascript 调用 C#。在函数中传入一个 Javascript 类数组：

```
var x = [];
x.push(classa);
x.push(classa);

window.external.CSharpFunction(x); 
```

我可以通过以下方式在 C# 中成功获取 x.length：

```
int length=(int)x.GetType().InvokeMember("length", BindingFlags.GetProperty, null, x, null); 
```

我的问题是如何获得 x[0] 和 x[1]？我试过了

```
x.GetType().InvokeMember(string.Empty, BindingFlags.GetProperty, null, x, new object[1]{1}); 
```

和

```
x.GetType().InvokeMember(string.Empty, BindingFlags.InvokeMethod | BindingFlags.Default, null, x, new object[1]{0}); 
```

两者都会触发 WebBrowser 控件中的错误。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T13:15:54.420

请看这个 SO 问题：

[在 C# 4 中使用动态类型访问 javascript 对象的属性](https://stackoverflow.com/questions/5278275/accessing-properties-of-javascript-objects-using-type-dynamic-in-c-sharp-4)

我还尝试从数组中对象的属性中检索值，但没有成功。检索数组中的简单值（例如字符串和整数）很容易，但对于复杂对象就没有运气了。

您最好的选择（IMO）是实施与上述 SO 问题中的解决方案类似的解决方案。与其直接传递数组，不如构建一个可以从 C# 调用的 Javascript 方法，该方法将返回数组中指定索引处的对象。像这样：

**C＃**

```
public void CSharpFunction(dynamic length)
{
    for (int i = 0; i < length; i++)
    {
        dynamic obj = webBrowser1.Document.InvokeScript("getObj", new object[] { i });

        string val = obj.MyClassValue;
    }
} 
```

**HTML / JavaScript**

```
<script type="text/javascript">

var x = [];
x.push({MyClassValue: "Hello"});
x.push({MyClassValue: "People"});

function test() {
  window.external.CSharpFunction(x.length);
}

function getObj(i) {
  return x[i];
}

</script>
<button onclick="test();" /> 
```

# android - 输入文本对话框 Android

> ID：10903754
> 
> 赞同：334
> 
> 时间：2012-06-05T19:36:04.560
> 
> 标签：android, text, input

当用户`Button`在我的应用程序中单击 a （打印在 a 中`SurfaceView`）时，我希望`Dialog`出现一个文本，并且我希望将结果存储在 a 中`String`。我希望文本`Dialog`覆盖当前屏幕。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：642
> 
> 时间：2012-06-05T20:45:40.660

[听起来像是使用AlertDialog](http://developer.android.com/reference/android/app/AlertDialog.html)的好机会。

看起来很基本，Android 没有内置对话框来执行此操作（据我所知）。幸运的是，这只是在创建标准 AlertDialog 之上的一点额外工作。您只需创建一个 EditText 供用户输入数据，并将其设置为 AlertDialog 的视图。如果需要，您可以使用[setInputType](http://developer.android.com/reference/android/widget/TextView.html#setInputType%28int%29)自定义允许的输入类型。

如果您能够使用成员变量，您可以简单地将变量设置为 EditText 的值，并且在对话框关闭后它将保持不变。如果不能使用成员变量，则可能需要使用侦听器将字符串值发送到正确的位置。（如果这是您需要的，我可以编辑和详细说明）。

在你的班级内：

```
private String m_Text = ""; 
```

在按钮的 OnClickListener 中（或从那里调用的函数中）：

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setTitle("Title");

// Set up the input
final EditText input = new EditText(this);
// Specify the type of input expected; this, for example, sets the input as a password, and will mask the text
input.setInputType(InputType.TYPE_CLASS_TEXT | InputType.TYPE_TEXT_VARIATION_PASSWORD);
builder.setView(input);

// Set up the buttons
builder.setPositiveButton("OK", new DialogInterface.OnClickListener() { 
    @Override
    public void onClick(DialogInterface dialog, int which) {
        m_Text = input.getText().toString();
    }
});
builder.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
    @Override
    public void onClick(DialogInterface dialog, int which) {
        dialog.cancel();
    }
});

builder.show(); 
```

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2016-02-13T17:39:06.780

我将通过一种方法添加到[@Aaron 的答案](https://stackoverflow.com/a/10904665/3357935)中，让您有机会以更好的方式设置对话框的样式。这是一个调整后的例子：

```
AlertDialog.Builder builder = new AlertDialog.Builder(getContext());
builder.setTitle("Title");
// I'm using fragment here so I'm using getView() to provide ViewGroup
// but you can provide here any other instance of ViewGroup from your Fragment / Activity
View viewInflated = LayoutInflater.from(getContext()).inflate(R.layout.text_inpu_password, (ViewGroup) getView(), false);
// Set up the input
final EditText input = (EditText) viewInflated.findViewById(R.id.input);
// Specify the type of input expected; this, for example, sets the input as a password, and will mask the text
builder.setView(viewInflated);

// Set up the buttons
builder.setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {
    @Override
    public void onClick(DialogInterface dialog, int which) {
        dialog.dismiss();
        m_Text = input.getText().toString();
    }   
}); 
builder.setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {
    @Override
    public void onClick(DialogInterface dialog, int which) {
        dialog.cancel();
    }   
}); 

builder.show(); 
```

这是用于创建 EditText 对话框的示例布局：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="@dimen/content_padding_normal">

    <android.support.design.widget.TextInputLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content">

        <AutoCompleteTextView
            android:id="@+id/input"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:hint="@string/hint_password"
            android:imeOptions="actionDone"
            android:inputType="textPassword" />

    </android.support.design.widget.TextInputLayout>
</FrameLayout> 
```

最终结果：

[![EditText 对话框示例](../Images/4a63dcbb3c4e422e4b947078f430a1ac.png)](https://i.stack.imgur.com/03TwW.png)

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2012-06-05T20:25:20.900

这个[示例](http://twigstechtips.blogspot.com/2011/10/android-allow-user-to-editinput-text.html)怎么样？这似乎很简单。

```
final EditText txtUrl = new EditText(this);

// Set the default text to a link of the Queen
txtUrl.setHint("http://www.librarising.com/astrology/celebs/images2/QR/queenelizabethii.jpg");

new AlertDialog.Builder(this)
  .setTitle("Moustachify Link")
  .setMessage("Paste in the link of an image to moustachify!")
  .setView(txtUrl)
  .setPositiveButton("Moustachify", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
      String url = txtUrl.getText().toString();
      moustachify(null, url);
    }
  })
  .setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
    }
  })
  .show(); 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2019-01-11T03:02:13.147

如果您想要一些空间`left`和视野`right`，`input`您可以添加一些填充，例如

```
private fun showAlertWithTextInputLayout(context: Context) {
    val textInputLayout = TextInputLayout(context)
    textInputLayout.setPadding(
        resources.getDimensionPixelOffset(R.dimen.dp_19), // if you look at android alert_dialog.xml, you will see the message textview have margin 14dp and padding 5dp. This is the reason why I use 19 here
        0,
        resources.getDimensionPixelOffset(R.dimen.dp_19),
        0
    )
    val input = EditText(context)
    textInputLayout.hint = "Email"
    textInputLayout.addView(input)

    val alert = AlertDialog.Builder(context)
        .setTitle("Reset Password")
        .setView(textInputLayout)
        .setMessage("Please enter your email address")
        .setPositiveButton("Submit") { dialog, _ ->
            // do some thing with input.text
            dialog.cancel()
        }
        .setNegativeButton("Cancel") { dialog, _ ->
            dialog.cancel()
        }.create()

    alert.show()
} 
```

**尺寸.xml**

```
<dimen name="dp_19">19dp</dimen> 
```

![](../Images/e7dffac5c5fa575c36d74d743d9dbefe.png)

希望有帮助

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2019-12-05T17:33:08.660

这对我有用

```
private void showForgotDialog(Context c) {
        final EditText taskEditText = new EditText(c);
        AlertDialog dialog = new AlertDialog.Builder(c)
                .setTitle("Forgot Password")
                .setMessage("Enter your mobile number?")
                .setView(taskEditText)
                .setPositiveButton("Reset", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        String task = String.valueOf(taskEditText.getText());
                    }
                })
                .setNegativeButton("Cancel", null)
                .create();
        dialog.show();
    } 
```

**怎么打电话？（当前活动名称）**

showForgotDialog(current_activity_name.this);

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-10-02T20:27:25.460

`AlertDialog.Builder`我发现扩展以创建自定义对话框类更简洁、更可重用。这是一个要求用户输入电话号码的对话框。预置电话号码也可以通过在呼叫`setNumber()`前呼叫来提供`show()`。

*InputSenderDialog.java*

```
public class InputSenderDialog extends AlertDialog.Builder {

    public interface InputSenderDialogListener{
        public abstract void onOK(String number);
        public abstract void onCancel(String number);
    }

    private EditText mNumberEdit;

    public InputSenderDialog(Activity activity, final InputSenderDialogListener listener) {
        super( new ContextThemeWrapper(activity, R.style.AppTheme) );

        @SuppressLint("InflateParams") // It's OK to use NULL in an AlertDialog it seems...
        View dialogLayout = LayoutInflater.from(activity).inflate(R.layout.dialog_input_sender_number, null);
        setView(dialogLayout);

        mNumberEdit = dialogLayout.findViewById(R.id.numberEdit);

        setPositiveButton("OK", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int id) {
                if( listener != null )
                    listener.onOK(String.valueOf(mNumberEdit.getText()));

            }
        });

        setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int id) {
                if( listener != null )
                    listener.onCancel(String.valueOf(mNumberEdit.getText()));
            }
        });
    }

    public InputSenderDialog setNumber(String number){
        mNumberEdit.setText( number );
        return this;
    }

    @Override
    public AlertDialog show() {
        AlertDialog dialog = super.show();
        Window window = dialog.getWindow();
        if( window != null )
            window.setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_VISIBLE);
        return dialog;
    }
} 
```

*dialog_input_sender_number.xml*

```
<?xml version="1.0" encoding="utf-8"?>
<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:padding="10dp">

    <TextView
        android:id="@+id/title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        app:layout_constraintTop_toTopOf="parent"
        app:layout_constraintLeft_toLeftOf="parent"
        android:paddingBottom="20dp"
        android:text="Input phone number"
        android:textAppearance="@style/TextAppearance.AppCompat.Large" />

    <TextView
        android:id="@+id/numberLabel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        app:layout_constraintTop_toBottomOf="@+id/title"
        app:layout_constraintLeft_toLeftOf="parent"
        android:text="Phone number" />

    <EditText
        android:id="@+id/numberEdit"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        app:layout_constraintTop_toBottomOf="@+id/numberLabel"
        app:layout_constraintLeft_toLeftOf="parent"
        android:inputType="phone" >
        <requestFocus />
    </EditText>

</android.support.constraint.ConstraintLayout> 
```

***用法：***

```
new InputSenderDialog(getActivity(), new InputSenderDialog.InputSenderDialogListener() {
    @Override
    public void onOK(final String number) {
        Log.d(TAG, "The user tapped OK, number is "+number);
    }

    @Override
    public void onCancel(String number) {
        Log.d(TAG, "The user tapped Cancel, number is "+number);
    }
}).setNumber(someNumberVariable).show(); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-01-19T18:53:48.953

@LukeTaylor：我目前手头有相同的任务（创建一个包含 EditText 的弹出窗口/对话框）。
就我个人而言，我发现完全动态的路线在创造力方面有些限制。

**完全自定义对话框布局：您可以完全自定义对话框，**

**而不是*完全*依赖代码来创建对话框：**

**1) -**创建一个新`Layout Resource`文件.. 这将作为您的对话框，允许完全的创作自由！
注意：请参阅材料设计指南，以帮助保持清洁和准确。

**2) -**为所有`View`元素提供 ID。在下面的示例代码中，我有 1`EditText`和 2 `Buttons`。

**3) -**`Activity`用 a创建一个`Button`，用于测试目的.. 我们将让它膨胀并启动您的对话框！

```
public void buttonClick_DialogTest(View view) {

    AlertDialog.Builder mBuilder = new AlertDialog.Builder(MainActivity.this);

    //  Inflate the Layout Resource file you created in Step 1
    View mView = getLayoutInflater().inflate(R.layout.timer_dialog_layout, null);

    //  Get View elements from Layout file. Be sure to include inflated view name (mView)
    final EditText mTimerMinutes = (EditText) mView.findViewById(R.id.etTimerValue);
    Button mTimerOk = (Button) mView.findViewById(R.id.btnTimerOk);
    Button mTimerCancel = (Button) mView.findViewById(R.id.btnTimerCancel);

    //  Create the AlertDialog using everything we needed from above
    mBuilder.setView(mView);
    final AlertDialog timerDialog = mBuilder.create();

    //  Set Listener for the OK Button
    mTimerOk.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick (View view) {
            if (!mTimerMinutes.getText().toString().isEmpty()) {
                Toast.makeText(MainActivity.this, "You entered a Value!,", Toast.LENGTH_LONG).show();
            } else {
                Toast.makeText(MainActivity.this, "Please enter a Value!", Toast.LENGTH_LONG).show();
            }
        }
    });

    //  Set Listener for the CANCEL Button
    mTimerCancel.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick (View view) {
            timerDialog.dismiss();
        }
    });

    //  Finally, SHOW your Dialog!
    timerDialog.show();

    //  END OF buttonClick_DialogTest
} 
```

小菜一碟！充分的创作自由！请务必遵循材料指南；）

**我希望这对某人有所帮助！**让我知道你们的想法！

# java - 如何将字符串转换为 Json

> ID：10903758
> 
> 赞同：1
> 
> 时间：2012-06-05T19:36:27.763
> 
> 标签：java, json, servlets

我有一个 Java servlet，我想知道如何执行以下操作。

我有一个带有名称值的 String 变量，并且想要创建一个 Json，其变量类似于`{"name": "David"}`.

我该怎么做呢？

我有以下代码，但出现错误：

```
 Serious: Servlet.service () for servlet threw 
   exception servlet.UsuarioServlet java.lang.NullPointerException 
               at servlet.UsuarioServlet.doPost (UsuarioServlet.java: 166): 
```

在线

```
String myString = new JSONObject().put("name", "Hello, World!").toString(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:43:19.453

Chandra 描述了您的确切问题。您可以根据他的建议使用 JSONObject。正如你现在看到的，它的设计者并没有考虑到其他语言或库取得成功的属性，比如链接。

我建议您使用非常好的[Google Gson](http://code.google.com/p/google-gson/)之一。它使解码和编码都非常容易：

这个想法是你可以定义你的类，例如：

```
public class MyClass {
   public String name = "Hello, World!";
}

private Gson gson = new GsonBuilder().create();
PrintWriter writer = httpServletResponse.getWriter();
writer.write( gson.toJson(yourObject)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T00:30:36.497

基于 Map 的 json 库。所以，`put`基本上返回与这个键关联的前一个值，为空，所以空指针异常。（[http://docs.oracle.com/javase/1.4.2/docs/api/java/util/HashMap.html#把%28java.lang.Object,%20java.lang.Object%29](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/HashMap.html#put%28java.lang.Object,%20java.lang.Object%29) )

您可以按如下方式重写代码来解决问题。

```
JSONObject jsonObject1 = new JSONObject();
jsonObject1.put("name", "Hello, World");
String myString = jsonObject1.toString(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-06T11:45:54.360

我尝试使用[GSON](https://sourceforge.net/projects/gson23/files/gson-2.3.jar/download)，GSON 直接将您的 JSONString 转换为 java 类对象。

例子：

```
String jsonString = {"phoneNumber": "8888888888"} 
```

创建一个新类：

```
class Phone {

@SerializedName("phoneNumber")
private String phoneNumebr;

public void setPhoneNumber(String phoneNumebr) {
this.phoneNumebr = phoneNumebr;
}

public String getPhoneNumebr(){
return phoneNumber;
}

} 
```

// 在java中

```
Gson gson = new Gson();
Phone phone = gson.fromJson(jsonString, Phone.class);

System.out.println(" Phone number is "+phone.getPhoneNumebr()); 
```

# asp.net-mvc - asp.net mvc 错误处理

> ID：10903762
> 
> 赞同：0
> 
> 时间：2012-06-05T19:36:44.897
> 
> 标签：asp.net-mvc

我是一个新手 .net mvc 开发人员，我想知道，是否可以在不使用著名的 try/catch 语句的情况下开发自己的错误处理程序。我正在使用 XML 文件在视图中呈现组件，例如，我想获取一条错误消息，以便我知道我违反了基于 xml 文件的约束

> （例如，如果我添加另一个没有 >'type' 属性的标签，这可以在运行时为我生成一条消息）。我希望我提前说清楚谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:26:39.080

在 Global.asax 中可以捕获异常，global.asax 在您的应用程序上有许多事件处理程序，例如 Application_start 或您需要 Application_Error

```
void Application_Error(){

     Exception exception = Server.GetLastError();
     //do what you need with the exception...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:49:40.900

实际上，我更喜欢使用 ActionFilter 类来覆盖 OnActionExecuting、OnActionExecuted、OnResultExecuting 和 OnResultExecuted 方法。而且我认为xml属性的控制不能从c sharp完成，我将使用if条件。不管怎么说，还是要谢谢你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T12:19:18.070

我相信处理异常的最佳位置是 global.asax.cs。

```
protected void Application_Error(object sender, System.EventArgs e)
{
    // custom logger
    IErrorLogger errorLogger = new CustomLogger();

    // config of error handler
    MvcExceptionHandlerConfig config = new MvcExceptionHandlerConfig("Error", "Error", 404, 500);

    // init and handle
    new MvcExceptionHandler.MvcExceptionHandler(this, errorLogger, config).Handle();
} 
```

此处提供演示：[https ://github.com/mholec/mvcexceptionhandler](https://github.com/mholec/mvcexceptionhandler)

当然，这取决于您要处理什么样的异常。Application_Error 是处理错误 400、404、5xx 等的好地方，另一方面，它不适用于身份验证错误（您需要创建特殊过滤器）。

# iphone - 全屏 UIScrollView 无法正常工作

> ID：10903769
> 
> 赞同：5
> 
> 时间：2012-06-05T19:37:13.147
> 
> 标签：iphone, ios, cocoa-touch, uiscrollview

我有一个像照片应用程序这样的应用程序，其中主视图`UIScrollView`占据了整个屏幕的大小。此外，与照片应用程序一样，当用户点击屏幕时，会出现半透明的导航、状态和工具栏，它们会重新出现/消失。

我在将`UIViewControllers`主视图设置为 a`UIScrollView`并让它占据屏幕的整个长度时遇到问题。问题是，当显示导航栏和状态栏时，导航栏和状态栏`UIScrollView`的高度会被向下推（它不会像想象的那样在它们下方）。当用户点击屏幕并且导航/状态栏消失时，它会自行重置以占据屏幕的整个长度，就像它假设的那样。

将主视图设置为 a 并在其顶部`UIView`附加 a的简单解决方法是可行的。`UIScrollView`但是，我想尝试在没有任何变通方法（即调整`UIScrollViews contentInset`等）的情况下让它工作，因为理论上它应该工作。

下面是我正在实现的代码：

```
- (void)loadView
{

    self.wantsFullScreenLayout = YES;

    UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame: CGRectMake(0,0,320,480)];
    scrollView.contentSize = CGSizeMake(320, 480);
    scrollView.scrollEnabled = NO;
    scrollView.contentOffset = CGPointZero;
    scrollView.bounces = NO;
    self.view = scrollView;
    [scrollView release];

}

- (void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    self.navigationController.navigationBar.translucent = YES;
    [[UIApplication sharedApplication] setStatusBarStyle: UIStatusBarStyleBlackTranslucent animated: NO];
    self.navigationController.toolbarHidden = NO;
    self.navigationController.toolbar.barStyle = UIBarStyleBlack;
    self.navigationController.toolbar.translucent = YES;

    [self startTimer];
}

- (void) viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];

    self.navigationController.navigationBar.translucent = NO;
    [[UIApplication sharedApplication] setStatusBarStyle: UIStatusBarStyleDefault animated: NO];

    [self cancelTimer];
} 
```

更新：我注意到它正在发生变化，`contentOffset`而`contentInset`不是`scrollViews`框架。当条形消失并且`UIScrollView`是屏幕的完整尺寸（应该是）时，`contentOffset`和`contentInset`如下：

```
Content Offset: {0, -20}
Content Inset: {20, 0, 44, 0} 
```

当条形可见且`UIScrollView`被按下时，`contentOffset`和`contentInset`如下：

```
Content Offset: {0, -64}
Content Inset: {64, 0, 44, 0} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-30T11:34:29.447

阅读 Apple 的 UI 过渡指南后，我在 iOS7 上解决了类似问题： [https ://developer.apple.com/library/ios/documentation/userexperience/conceptual/TransitionGuide/AppearanceCustomization.html](https://developer.apple.com/library/ios/documentation/userexperience/conceptual/TransitionGuide/AppearanceCustomization.html)

事实证明`UIViewController`有一个`automaticallyAdjustsScrollViewInsets`布尔属性。默认值为 true，禁用它会使我`UIScrollView`填满整个窗口，而不是被推下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T22:07:19.160

我就此与 DTS 进行了交谈，他们说这是设计行为并建议将其附加`UIScrollView`到 parent `UIView`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-05T19:57:36.540

尝试设置：

```
self.view.frame = CGRectMake(0.f, -44.f, 320.f 480.f); 
```

它可能不是你想要的大小，但你可以调整它......

# c++ - 导出符号是什么意思？

> ID：10903770
> 
> 赞同：15
> 
> 时间：2012-06-05T19:37:28.977
> 
> 标签：c++, c, export

我一直在寻找“导出符号”这个术语。导出符号在 C/C++ 中或相对于库（共享/静态）意味着什么？我们从哪里导出符号，为什么？导出符号与编译器名称修饰的关系是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-05T19:38:35.953

导出符号意味着“宣传”它在您的目标文件/库中的存在以及它的位置，以便它可以被其他模块导入（=链接到）。

链接可以静态或动态完成，但无论哪种方式，链接器都必须知道符号是什么以及它在哪里，并且导出的符号和导入的符号必须匹配才能发生。名称修饰与此相关（C++ 名称修饰在符号名称中包含符号的类型定义，并且导出和导入符号的修饰必须匹配，链接器才能正确链接导入导出）。

* * *

例子：

假设您有一个库“STANDARDC”（随机名称）和您的程序 SOMEPROG。程序 SOMEPROG 需要打印到控制台，所以它会调用`printf`. 但是您实际上并没有`printf`在您的程序 SOMEPROG 中实现，您只是使用它（=导入它），而实现在其他地方。

库 STANDARDC 有一个它导出的符号列表，其中包括在该库中实现并且可以从外部调用的所有函数（=导出的函数）。`printf`是这样的功能之一，所以它会出现在导出的列表中。

编译器通过您的 SOMEPROG.C 并看到您引用`printf`，但没有实现它。编译器将 添加`printf`到生成的 SOMEPROG.obj 的导入符号列表中，以便链接器将实际实现链接到其中。

链接器获取您的 SOMEPROG.obj 文件和 STANDARDC .lib 文件，并查看 SOMEPROG.obj 中使用了哪些函数。链接器发现它`printf`没有实现，它被导入，所以链接器查看它拥有的所有 .lib 文件，并`printf`在 STANDARDC 的导出列表中找到匹配项。它采用`printf`from STANDARDC 的实现并将其链接到您引用导入符号的任何地方的程序中`printf`。

# eclipse - 如何将 Eclipse 控制面板移动到 ubuntu 顶部面板？

> ID：10903771
> 
> 赞同：0
> 
> 时间：2012-06-05T19:37:46.880
> 
> 标签：eclipse, ubuntu, compiz

在 ubuntu 12.04 中使用 compiz 工具（更改了 ubuntu 顶部面板的不透明度）后，我的 eclipse indigo 出现了问题。它不会在 ubuntu 顶部面板中显示控制面板（Windows 控件的默认位置），而是在 ubuntu 面板下占据整个下一行。所有其他应用程序都没有改变行为。有谁知道如何回滚？

# c# - 复制“将表单字段写入数据库”过程的简单方法是什么？

> ID：10903773
> 
> 赞同：0
> 
> 时间：2012-06-05T19:37:51.840
> 
> 标签：c#, asp.net, mysql, sql

我有一个正在开发的 ASP.net (C#) 应用程序。在应用程序中，需要填写和提交多页表单字段。最后一页的底部是一个提交按钮，它将所有内容写入数据库。将这些字段从表单写入数据库的代码非常复杂，因为调用了大约 30 个不同的存储过程。当用户单击一个名为“复制”的新按钮时，我试图创建一个副本，该按钮应该在数据库中存储一个副本。我尝试从“提交”按钮复制粘贴代码以写入数据库，但我遇到了很多问题。我尝试了很多不同的方法，例如将提交按钮的代码粘贴到新方法中，并从“复制”按钮调用该方法，但这种方法不起作用。所以，我对是否有更简单的方法来复制存储在数据库中的提交副本感到困惑。通常几个 SQL 语句可以工作，但在这种情况下，大约有 35 个存储过程、70 个 SQL 表和 425 个列，这是一个问题。

所以基本上问题的总结是：

我有一个表单，在提交时，将填写的字段写入数据库中的各个位置，具体取决于字段是什么。

我想创建一个“复制”按钮，复制表单的数据库存储字段，创建一个副本。

问题：正如我所说，大约有 215 个表单域和 70 个 SQL 表，每个表单域进入表中的某个列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T10:35:07.940

我将通过创建一个直接在数据库中进行复制的存储过程来解决这个问题。然后你可以让你的“复制”按钮调用新的存储过程，它创建副本并返回一些句柄（为副本创建的一些基本 id 值）并使用句柄将复制的版本加载到应用程序中。确保在事务中运行复制，这样您要么获得完整的副本以提交，要么在发生错误时回滚。

# c - 创建链表时出现神秘的分段错误（添加功能）

> ID：10903776
> 
> 赞同：0
> 
> 时间：2012-06-05T19:38:01.117
> 
> 标签：c, linked-list, segmentation-fault

我试图在 C 中创建一个链接列表，但由于一些神秘的错误，程序崩溃了。

首先我尝试了这个：

```
typedef struct product_data product_data;

struct product_data {
 int product_code;
 int product_size;
 product_data *next;
};

product_data *products_head = NULL;
product_data *products_tail = NULL;

int main() {
    int newcode = 5;
    int newsize = 5;
    products_head->product_code = newcode;
    products_head->product_size = newsize;
    products_head->next = NULL;

    return 0;
} 
```

不幸的是，程序在没有任何错误消息的情况下崩溃。

然后我改变了一些部分：

```
typedef struct product_data product_data;

struct product_data {
 int product_code;
 int product_size;
 product_data *next;
};

product_data *products_head = NULL;
product_data *products_tail = NULL;

int main() {
    product_data *newproduct;
    int newcode = 5;
    int newsize = 5;
    newproduct->product_code = newcode;
    newproduct->product_size = newsize;
    newproduct->next = NULL;

    products_head = newproduct;

    return 0;
} 
```

这次没有崩溃，它似乎工作。我不知道为什么。

有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:42:27.110

它真的不起作用。您仍在取消引用无效指针：

```
product_data *newproduct;
int newcode = 5;
int newsize = 5;
newproduct->product_code = newcode;
newproduct->product_size = newsize;
newproduct->next = NULL; 
```

但是，虽然在第一个版本中您要取消引用显式设置为 的指针`NULL`，但它会因应有的​​分段错误而崩溃。在这里，您正在取消引用一个包含堆栈上任何数据的指针，不幸的是它不会崩溃。这是未定义的行为，因此不一定会崩溃。

你必须让你的指针指向有效的内存，

```
newproduct = malloc(sizeof product_data); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:42:08.613

您需要为 products_head 分配内存。现在，您只需将其设置为 NULL。要么不让它成为指针，要么使用 malloc。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:42:41.707

在您的第一个示例中，您正在写入 NULL 指针。您需要`products_head`在取消引用之前为其分配空间。就像是

```
products_head = malloc(sizeof(product_data)); 
```

我不知道为什么你的第二个例子有效。它不应该。 `newproduct`是一个未初始化的变量，它可以指向任何地方。也许你只是走运了，它指向了一块未使用的有效内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T19:45:37.803

这将起作用，直到它不起作用。您仍然没有为您的结构分配任何内存。但是由于一些运气，newproduct 指向了一些有效的内存位置。您面临的问题是 product_head 被手动设置为 null （即使这不是必需的，因为所有全局变量总是被初始化）。然而堆栈变量并没有被初始化，你很幸运（或者不幸的是它会导致你错过一个明显的编程错误）它恰好指向你地址空间中的某个有效位置。

您可以使用 printf("%p", newproduct); 打印 newproduct 的内容以查看它指向的位置；不幸的是，插入这一行可能会改变程序的行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:53:40.247

“->”意在访问动态分配的结构中的元素，“.” 用于访问静态分配的结构中的元素。

这是一个例子：

```
typedef struct product_data product_data;

struct product_data {
    int product_code;
    int product_size;
    product_data *next;
};

product_data *products_head = NULL;
product_data *products_tail = NULL;

int main() {
    /* Allocate memory */
    product_data *newproduct = malloc(sizeof(product_data));
    int newcode = 5;
    int newsize = 5;

    products_head = newproduct;
    newproduct->product_size = newsize;
    newproduct->next = NULL;

    /* free memory */
    free(product_data);

    return 0;
} 
```

但是请记住，对于您在链表中创建的所有新节点，您必须分配内存并释放该内存。用于检查您分配的所有内存是否已释放的好程序是 valgrind。如果你在尝试让链表首先手动绘制它时遇到逻辑错误，如下所示：

```
 [head]   [tail]
        |        |
        V        V
      [ a ] -> [ b ] -> null 
```

请记住，head 和 tail 都是指针（因此它们不需要分配内存，它们只需要指向您想要的节点。

如果您仍然遇到问题，因为您的逻辑变得非常复杂，我建议您尝试学习 GDB（它是一个命令行调试器），它将帮助您逐步完成代码，以便您可以逐步了解正在发生的事情。这就是我第一次学习创建数据结构的方式。

祝你好运！

# objective-c - 为什么这个 GCD 示例代码似乎不正确地释放了一个对象？

> ID：10903777
> 
> 赞同：0
> 
> 时间：2012-06-05T19:38:03.140
> 
> 标签：objective-c, multithreading, memory-management, grand-central-dispatch

在[wikipedia example](http://en.wikipedia.org/wiki/Grand_Central_Dispatch#Examples) author has `release`d object `stats`，当它没有被分配、复制或保留时。这是一个错误还是我不明白的东西？

```
- (IBAction)analyzeDocument:(NSButton *)sender
{
  dispatch_async(dispatch_get_global_queue(0, 0), ^{
    NSDictionary *stats = [myDoc analyze];
    dispatch_async(dispatch_get_main_queue(), ^{
      [myModel setDict:stats];
      [myStatsView setNeedsDisplay:YES];
      [stats release];
    });
  });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:49:57.940

`analyze`将对象的所有权返回给调用者要么是错误，要么已被正确记录。如果不是`stats`发布的错误，则该代码示例使用的约定违反了[Apple 的](https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/MemoryManagement.html)所有权内存管理规则。

> 内存管理规则，有时也称为所有权策略，可帮助您在 Objective-C 代码中显式管理内存。
> 
> 您通过为它分配内存或复制它来拥有您创建的任何对象。
> *相关方法：alloc、allocWithZone:、copy、copyWithZone:、mutableCopy、mutableCopyWithZone:*

另一个应该返回所有权的前缀是类方法`+new`。例如`[MyDocClass newAnalysis];`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:51:03.617

这只是[John Siracusa 编写](http://arstechnica.com/apple/2009/08/mac-os-x-10-6/13/)的一个示例，用于演示 GCD 如何轻松地将长时间运行的任务置于后台，但是，是的，它有两个问题之一，一个是 ingored 约定，另一个是实际错误。

虚构的`analyze`方法可能会返回一个拥有引用。这违反了 Cocoa 约定，即未命名的方法`new`, `alloc`,`release`或`copy...`通常*不*返回此类引用，但如果文档明确说明它确实如此，并且真的没有办法绕过它，那可能没问题。在这种情况下，必须发送`release`到`stats`以避免内存泄漏。（如果这是真实的代码，重命名该方法将是一个好主意，也许`create`在 CoreFoundation 中使用 which 来表示拥有引用的返回。）

但是，如果`analyze`遵循约定并返回非拥有的引用，那么您是对的，发送`release`到`stats`是不正确的，最终会导致崩溃。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:52:11.433

很可能`analyze`是返回一个保留计数为 1 的字典，这`release`就是需要它的原因。

# python - Django-avatar ordinal not in range(128)

> ID：10903783
> 
> 赞同：1
> 
> 时间：2012-06-05T19:38:19.907
> 
> 标签：python, django, unicode

I am using django-avatar in my website (Django 1.4). However, today I got this error:

`UnicodeEncodeError: 'ascii' codec can't encode characters in position 94-100: ordinal not in range(128)`

Here is the full error log: [http://dpaste.com/755691/](http://dpaste.com/755691/)

Any ideas what might that be, and how to solve it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:42:41.523

It seems it encounters a character problem when looking up the avatar file. So you may have a user which has a profile image with a "weird" character in its filename. Have you checked the value of the variable `path` ? You may need to convert the filename so it does not contain characters from foreign languages.

# r - 使用 %dopar% 时如何打印

> ID：10903787
> 
> 赞同：77
> 
> 时间：2012-06-05T19:38:38.593
> 
> 标签：r, foreach, parallel-processing

我有一个`foreach`使用`%dopar%`with`doSNOW`作为后端的循环。我怎样才能让循环在每次迭代时打印出一些东西？

我下面的代码是我目前正在使用的，但它没有打印任何东西。

```
foreach(ntree=rep(25,2),.combine=combine,.packages='randomForest',
    .inorder=FALSE) %dopar% {
        print("RANDOM FOREST")
        randomForest(classForm,data=data,na.action=na.action,do.trace=do.trace,ntree=ntree,mtry=mtry)
    } 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-02-25T23:28:46.837

默认情况下，雪工产生的输出会被丢弃，但您可以使用 makeCluster “outfile” 选项来更改它。将 outfile 设置为空字符串 ("") 将防止 snow 重定向输出，这通常会导致打印消息的输出显示在主进程的终端上。

只需使用以下内容创建并注册您的集群：

```
library(doSNOW)
cl <- makeCluster(4, outfile="")
registerDoSNOW(cl) 
```

您的 foreach 循环根本不需要更改。

这适用于我的 SOCK 集群和 MPI 集群，使用 Rmpi​​ 构建 Open MPI。在 Windows 上，如果您使用 Rgui，您将看不到任何输出。如果你改用 Rterm.exe，你会的。

请注意，除了您自己的输出之外，您还会看到由 snow 生成的消息，这些消息也很有用。

* * *

要使用进度条，doSNOW 1.0.14 版有一个`progress`选项。这是一个完整的例子：

```
library(doSNOW)
library(tcltk)
library(randomForest)
cl <- makeSOCKcluster(3)
registerDoSNOW(cl)

ntasks <- 100
pb <- tkProgressBar(max=ntasks)
progress <- function(n) setTkProgressBar(pb, n)
opts <- list(progress=progress)

x <- matrix(runif(500), 100)
y <- gl(2, 50)

rf <- foreach(ntree=rep(25, ntasks), .combine=combine,
        .multicombine=TRUE, .packages='randomForest',
        .options.snow=opts) %dopar% {
  randomForest(x, y, ntree=ntree)
} 
```

该`progress`选项相当通用，因此您可以使用以下函数简单地打印一条消息：

```
progress <- function(n) cat(sprintf("task %d is complete\n", n)) 
```

该函数可以采用 0、1 或 2 个参数。第一个提供的参数是已完成任务的总数，第二个是刚刚完成的任务的任务号。

最简单的示例只是`.`在任务完成时打印 a：

```
progress <- function() cat('.') 
```

此示例显示两个参数，可用于演示任务并不总是按顺序完成：

```
progress <- function(nfin, tag) {
  cat(sprintf('tasks completed: %d; tag: %d\n', nfin, tag))
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-06-25T12:18:11.050

这里发布了许多好的解决方案，但我发现最简单的方法是登录到套接字并使用单独的进程在控制台中输出日志调用。

我使用以下功能：

```
log.socket <- make.socket(port=4000)

Log <- function(text, ...) {
  msg <- sprintf(paste0(as.character(Sys.time()), ": ", text, "\n"), ...)
  cat(msg)
  write.socket(log.socket, msg)
} 
```

然后，您可以在代码中放置日志语句，例如：

```
Log("Processing block %d of %d", i, n.blocks) 
```

可以使用任何简单的套接字侦听工具实时查看日志输出。例如，在 Linux 上使用 netcat：

```
nc -l 4000 
```

上面的日志语句将在 netcat 终端中显示为：

```
2014-06-25 12:30:45: Processing block 2 of 13 
```

此方法具有远程工作的优势，并提供您希望记录的详细输出。

**ps**对于 Windows 上的用户，请参阅[Jon Craton 的 netcat 端口](http://joncraton.org/blog/46/netcat-for-windows/)。

**pps**我猜`write.socket`R 函数可能不是线程安全的，但除非您以高频率登录，否则您不太可能遇到任何问题。不过有一点需要注意。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-06-06T14:31:31.897

我在长时间操作期间跟踪节点进度的一种方法是使用包创建进度`tkProgressBar`条`tcltk`。这不是您所要求的，但它应该让您从节点中看到一些东西。至少当集群是在本地主机（这是一台 Windows 机器）上运行的套接字集群时是这样。潜在的问题是进度条要么保留并弄乱你的显示器，要么它得到`close`d 并且打印的信息消失了。不过，对我来说，这不是问题，因为我只是想知道当前的状态。

```
library(parallel)
library(doSNOW)
cl<-makeCluster(detectCores(),type="SOCK")
registerDoSNOW(cl) 
```

使用您的代码，

```
foreach(ntree=rep(25,2),.combine=combine,.packages=c('randomForest','tcltk'),
    .inorder=FALSE) %dopar% {
        mypb <- tkProgressBar(title = "R progress bar", label = "",
          min = 0, max = 1, initial = 0, width = 300)
        setTkProgressBar(mypb, 1, title = "RANDOM FOREST", label = NULL)
    ans <- randomForest(classForm,data=data,na.action=na.action,do.trace=do.trace,ntree=ntree,mtry=mtry)
    close(mypb)
    ans
    } 
```

**这是一个更通用的使用示例：**

```
jSeq <- seq_len(30)

foreach(i = seq_len(2), .packages = c('tcltk', 'foreach')) %dopar% {
    mypb <- tkProgressBar(title = "R progress bar", label = "",
        min = 0, max = max(jSeq), initial = 0, width = 300)
    foreach(j = jSeq) %do% {
        Sys.sleep(.1)
        setTkProgressBar(mypb, j, title = "RANDOM FOREST", label = NULL)
    }
    NULL
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-07-07T18:26:37.010

我也有同样的问题。我正在使用 foreach 包调整随机森林的参数，并希望在每次迭代后打印一个“结果”行，但如果不显示进度条等就无法弄清楚。

这是我所做的，在我的函数中，我添加了这一行

```
write.table(result, file=paste("RF_ntree_",ntree,"_dims_",dims,".txt", sep=""),
  sep="\t", row.names=F) 
```

因此，在每次迭代之后，结果都会写入一个名称为 RF_ntree_250_dims_100.txt 的文本文件。

因此，如果我想跟踪进度，我只需刷新要写入文本文件的文件夹。

PS：结果也在数据框中累积。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-02-09T02:38:29.773

`cat("blah-blah-blah\n", file=stdout())`倾向于为我工作（linux/emacs/ess）。我想它也适用于其他一些平台。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-26T18:57:15.753

另一种方法是使用文件日志记录（例如，log4r 包）并在屏幕上单独打印输出（例如，通过'tail -f'）。

如果您仍然考虑创建日志，这将非常有效，并且您可以使用现有的包和所有相关的花里胡哨。

# javascript - 选项卡（或浏览器）关闭时的 Chrome onbeforeunload 事件

> ID：10903796
> 
> 赞同：9
> 
> 时间：2012-06-05T19:39:22.147
> 
> 标签：javascript, google-chrome, onbeforeunload

当用户离开（关闭）浏览器或页面时，我正在尝试运行一个函数，并且我已经让它在除 Chrome 之外的所有浏览器中运行。

如果我离开页面，Chrome 会成功运行该功能，但如果我关闭选项卡或完全关闭浏览器，则不会运行它。

最后运行的函数会创建一个图像并将一些数据发送到我的服务器（类似于任何分析报告）示例：img.src="url?data=yyy"。这个图片是用js动态创建的。

有人可以阐明问题可能是什么吗？我把它缩小到几个原因：

1）标签关闭时我没有使用正确的事件（即不是 beforeunload）

2) Chrome 实际运行该功能，但由于浏览器/页面关闭，图像未发送。

任何帮助表示赞赏。谢谢。

这是示例代码：

```
if(window.addEventListener){
   window.addEventListener("beforeunload", page_unload, false);         
}
function page_unload(){
    var img     = new Image();
    var img_src = "http://www.myurl.com?data=yyy"
    img.src = img_src;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-25T07:01:26.533

我有一个与 Chrome 相关的问题，并使用 jQuery 解决了它：

```
$(window).unload( function() {
   //Call your function
   page_unload();
}); 
```

出于某种原因，在 JavaScript beforeunload 无法正常工作的某些情况下，jQuery 卸载事件在 Chrome 中效果更好。

# delphi - 在 Delphi 中使用泛型的属性

> ID：10903797
> 
> 赞同：8
> 
> 时间：2012-06-05T19:39:23.050
> 
> 标签：delphi, generics, properties

我正在尝试编写一个使用泛型的属性：

```
type TMyClass = class
  protected
    function GetCountBy<T: Class>: Integer;
  public
    property CountBy<T: Class>: Integer read GetCountBy<T>;
  end; 
```

但是在属性声明中编译失败，并显示消息“Property CountBy 在基类中不存在”，并且属性名称的开头 < 上出现红色波浪线。

有什么办法可以做到这一点？

编辑：这是我的另一个用例，它更复杂但更真实：

```
property ItemsBy<T: Class>[Index: Integer]: T read GetItemsBy<T> write SetItemsBy<T>; 
```

该函数过滤列表的内容以返回指定类的第 Index 项。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-05T22:15:38.690

Delphi 不支持通用属性。只有泛型类或泛型方法。

我在文档中找不到任何明确说明该限制的内容。另一方面，文档仅描述了泛型类和泛型方法。[支持泛型](https://web.archive.org/web/20110210122056/http://docwiki.embarcadero.com/RADStudio/en/Changes_in_Standard_Functions_and_Grammar)的新语言语法也没有提及属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T20:05:37.750

我没有跟上泛型的速度，但声明不应该更像这样

```
 type TMyClass<T: class> = class
  protected
    function GetCountBy<T>: Integer;
  public
    property CountBy<T>: Integer read GetCountBy<T>;
  end; 
```

# c# - 没有证书的 wcf 服务器身份验证

> ID：10903800
> 
> 赞同：2
> 
> 时间：2012-06-05T19:39:34.773
> 
> 标签：c#, .net, wcf, wcf-binding, wcf-security

我有一个带有 netTcpBinding 绑定的自托管 WCF 服务。我的服务器和客户端都在同一个域中，所以我想使用 Windows 身份验证，但我也希望客户端验证服务器凭据（以避免内部中间人/dns 篡改攻击）。我读过这样做的方法是使用 SPN，但我似乎无法让它发挥作用；无论 spn 设置为客户端工作（即服务器和客户端不匹配，但客户端仍然连接）。显然我有某种配置错误，但我不确定在哪里。这是服务器的服务配置：

```
<system.serviceModel>
<services>
  <service name="AaaAuthService.AaaAuthService" behaviorConfiguration="AaaAuthServiceBehavior">
    <endpoint address="" binding="netTcpBinding" bindingConfiguration="NetTcpBinding_IAaaAuth" contract="AAA.IAaaAuthService">
      <!--
      <identity>            
        <servicePrincipalName value="AaaShlkjhlkjjjjhhhhjjpn/justink-pc.sgasdf1.allamericanasphaltasdf.casdfom"/>
      </identity>
      -->
    </endpoint>
    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:9000/IAaaAuthService"/>
      </baseAddresses>
    </host>
    </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior name="AaaAuthServiceBehavior">
      <serviceThrottling maxConcurrentCalls="2147483647" maxConcurrentInstances="2147483647" maxConcurrentSessions="2147483647"/>
      <serviceDebug includeExceptionDetailInFaults="true"/>
    </behavior>
  </serviceBehaviors>
</behaviors>
<bindings>
  <netTcpBinding>
    <binding name="NetTcpBinding_IAaaAuth" closeTimeout="00:00:20" openTimeout="00:00:10" receiveTimeout="00:00:10" sendTimeout="00:00:10" hostNameComparisonMode="StrongWildcard" maxConnections="2147483647">
      <security mode="Transport">
        <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign"/>
        <message clientCredentialType="Windows"/>
      </security>
    </binding>
  </netTcpBinding>
</bindings> 
```

Windows 凭据似乎确实传入了 - OperationContext.Current.ServerSecurityContext.WindowsIdentity 填充了帐户信息。

我在这里想念什么？

# dulwich - 使用 dulwich 以编程方式执行“git status”

> ID：10903803
> 
> 赞同：3
> 
> 时间：2012-06-05T19:39:49.283
> 
> 标签：dulwich

我想知道我如何才能达到`git status`与德威相当的水平？

# 我试过这个：

在添加/更改/重命名一些文件并将它们暂存以进行提交之后，这就是我尝试做的事情：

```
from dulwich.repo  import Repo
from dulwich.index import changes_from_tree
r = Repo('my-git-repo')
index = r.open_index()
changes = index.changes_from_tree(r.object_store, r['HEAD'].tree) 
```

输出以下内容：

```
>>> list(changes)
(('Makefile', None), (33188, None), ('9b20...', None))
(('test/README.txt', 'test/README.txt'), (33188, 33188), ('484b...', '4f89...'))
((None, 'Makefile.mk'), (None, 33188), (None, '9b20...'))
((None, 'TEST.txt'), (None, 33188), (None, '2a02...')) 
```

但是这个输出需要我进一步处理它来检测：

1.  我修改了`README.txt`.
2.  我重命名`Makefile`为`Makefile.mk`.
3.  我添加`TEST.txt`到存储库。

中的函数`dulwich.diff_tree`为树更改提供了一个更好的界面......在实际提交之前这是不可能的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T11:27:37.100

你应该可以[`dulwich.diff_tree.tree_changes`](https://github.com/jelmer/dulwich/blob/8c359048216e79753165acff338bb73d727cee1e/dulwich/diff_tree.py#L162)用来检测两棵树之间的变化。

对此的要求之一是您将相关的树对象添加到对象存储中 - 您可以使用`dulwich.index.commit_index`它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-19T07:46:55.170

为了完整起见，一个工作示例：

```
from dulwich.repo import Repo
from dulwich.diff_tree import tree_changes

repo = Repo("./") 

index = repo.open_index()

try:
    head_tree = repo.head().tree
except KeyError: # in case of empty tree
    head_tree = dulwich.objects.Tree()

changes = list(tree_changes(repo, head_tree, index.commit(repo.object_store)))

for change in changes:
    print "%s: %s"%(change.type,change.new.path) 
```

# python - Python文件写入权限与用户windows 7不同

> ID：10903804
> 
> 赞同：3
> 
> 时间：2012-06-05T19:39:49.787
> 
> 标签：python, shell, permissions, copy

我正在尝试使用 python 脚本通过本地网络将文件复制到共享文件夹，但我一直遇到权限问题。我已经尝试过shutil、os.system 和subprocess.POpen，结果相似。我的盒子和服务器都在运行 Windows 7。

在cmd提示符下，我可以成功

```
copy a.file \\server\destination.file 
```

但是，从我运行的同一个命令提示符

```
python moveFile.py 
```

它具有以下代码

```
import os,subprocess,string

file = "a.file"
destination = "\\\\server\\destination.file"
command = "copy " + file " " + destination
if os.path.exists(destination):
   print("Destination access:" + str(os.access(destination,os.W_OK)))
   subprocess.Popen(command,shell=True) 
```

输出是

```
"Destination access: False"
" Access is denied.
    0 file(s) copied." 
```

这使我相信 python 脚本具有与我的用户不同的权限。有谁知道如何解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:26:31.080

您是否检查了 python 可执行文件的权限？它位于`c:\python27\`什么地方。在我的盒子上，普通用户只有读取和执行权限，这*应该*足够了。但我以管理员身份运行，所以我可以完全控制。尝试调整它。

# django - django 1.4 将 GET 缓存到 /login/

> ID：10903809
> 
> 赞同：0
> 
> 时间：2012-06-05T19:40:34.110
> 
> 标签：django

我最近将我的 django 框架从 1.3 升级到了 1.4。今天我在登录页面上进行了一些测试。我有一个开关，用于确定是否应在登录屏幕上显示“重置密码”链接。该测试在 1.3 下运行良好，但在 1.4 下运行良好。

我为登录页面设置了自己的视图和模板，如下所示：

```
urlpatterns = patterns('framework.views',
    url(r'^$', 'index'),
    url(r'^login/$', 'login_view'),
    url(r'^logout/$', 'logout_view'),
... 
```

经过进一步调查，我注意到如果我第一次浏览到登录页面，它就可以工作。如果我随后从我的 urls.py 文件中删除条目（即 /login/ 条目），我仍然可以浏览到 /login/ 页面。即使我重新启动 django 测试服务器，该 url 条目仍然有效。即使删除 urls.pyc 文件也不会给我 404。只有当我尝试发布时，我才会得到 404。顺便说一下，我的其他一些 url 不会发生这种现象。

我有一种感觉，我的测试失败的原因是 django 以某种神秘的方式缓存了 /login/ 请求，因此我在屏幕上运行的每个测试都不会刷新登录页面。有谁知道如何克服这个问题，也许还有为什么这个特定的功能已经改变了。它与新实现的[模板响应有什么关系吗？](https://docs.djangoproject.com/en/dev/ref/template-response/)?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T02:47:58.107

你用火狐吗？尝试删除 Firefox 缓存或您正在使用的任何浏览器缓存...

我昨天遇到了同样的问题。我环顾四周，发现很多人都有这个问题。看看[这个](https://stackoverflow.com/questions/6980192/firefox-5-caching-301-redirects)...

不要像我一开始那样责怪 django ;) （我后来责怪我，在知道真正的问题之前）......

让我们责怪协议：P

希望这能解决您的问题！

**编辑：** 在这里，您有一些可能的解决方案（如果您使用 firefox）：

1) [http://support.mozilla.org/es/questions/848678](http://support.mozilla.org/es/questions/848678)

2) [https://superuser.com/questions/23134/how-to-turn-off-firefox-cache](https://superuser.com/questions/23134/how-to-turn-off-firefox-cache)

# mysql - 将 SQL-Server 中的动态语句转换为 Mysql

> ID：10903813
> 
> 赞同：0
> 
> 时间：2012-06-05T19:40:43.230
> 
> 标签：mysql, sql-server

任何人都可以帮我找到以下 MS SQL 语法的 mysql corespondent 吗？

```
CREATE PROCEDURE testsp @COLUMN_NAME VARCHAR(20), @COLUMN_VALUE VARCHAR(20)
AS

DECLARE @SQL VARCHAR(40)  
SET @SQL = 'UPDATE TableX set ''+@COLUMN_NAME+ ''=''+@COLUMN_VALUE+'' '
PRINT (@SQL)
EXEC (@SQL) 
```

是否可以将此代码翻译成Mysql？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T20:01:49.280

```
CREATE PROCEDURE testsp (COLUMN_NAME VARCHAR(20), COLUMN_VALUE VARCHAR(20))
BEGIN
    SET @SQL_COMMAND = CONCAT('UPDATE TableX SET ', COLUMN_NAME, ' = ?');
    SELECT @SQL_COMMAND; /* prints the command */
    PREPARE SQL_STMT FROM @SQL_COMMAND;
    EXECUTE SQL_STMT USING COLUMN_VALUE;
    DEALLOCATE SQL_STMT;
END 
```

# java - Hibernate 无法在具有多个数据源的 Spring 项目中实例化 id 生成器

> ID：10903814
> 
> 赞同：3
> 
> 时间：2012-06-05T19:40:44.887
> 
> 标签：java, sql-server, spring, hibernate, db2

我有一个使用 Hibernate 和两个数据源（db2 和 sql-server）的 Spring 项目。

我一添加

`@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "SOME_SEQ")`

到我的实体类中的列字段，我`BeanCreationException`在创建 sql-server 时得到一个，`EntityManagerFactory`因为`org.hibernate.dialect.SQLServerDialect`不支持序列。不过，唯一使用此实体的地方是在`EntityManagerFactory`使用适当方言的 db2 的 DAO 中。

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T08:40:18.520

尝试使用`GenerationType=AUTO`而不是`GenerationType=SEQUENCE`.

```
@GeneratedValue(strategy = GenerationType.AUTO, generator = "SOME_SEQ") 
```

使用 AUTO hibernate 使用最佳拟合生成策略，对于某些数据库是序列，对于其他数据库是自动增量。

（注意：我从不使用注释，但我使用映射文件。`<generator class="native">`适用于不同的数据库类型。`GenerationType=AUTO`注释应该相同。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T21:06:18.223

即使我也遇到了同样的问题，并通过在 JPA 持久性单元配置中添加以下选项来解决它

```
 <exclude-unlisted-classes>true</exclude-unlisted-classes> 
```

此选项强制 JPA 提供程序仅扫描列出的类而不是整个周围的 jar 等。

所以它现在看起来像 -

```
<persistence-unit name="MSSQLBackedPersistenceUnit" transaction-type="JTA">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>java:/jdbc/MSSQLServerDS</jta-data-source>

    <class>com.example.app.domain.MyEntity</class>
    <exclude-unlisted-classes>true</exclude-unlisted-classes>

    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.SQLServer2008Dialect" />
        <property name="hibernate.show_sql" value="true" />
    </properties>
</persistence-unit> 
```

# android - NetworkOnMainThreadException，即使服务内部有后台线程

> ID：10903815
> 
> 赞同：0
> 
> 时间：2012-06-05T19:40:45.243
> 
> 标签：android, android-4.0-ice-cream-sandwich

我正在开发一个 UDP 聊天应用程序。所有网络处理都在服务的线程内。对于 3.1 和 4.0 操作系统，我仍然收到此错误消息。对于 2.3 及以下版本，它工作正常。问题：我是否应该创建两个应用程序，一个用于 2.3 及以下版本，另一个用于 3.0 及更高版本？**根据 LogCat 调用write(byte[] out)**方法时会发生错误。

如果我为 ICS 禁用 StrictMode，则应用程序运行正常。

```
public class ChatService extends Service { 
    private Binder binder;
    private ComThread comThread;

    public IBinder onBind(Intent intent) {
        return binder;
    }

    public void onCreate() {
    }

    public int onStartCommand(Intent intent, int flags, int startId) {
        binder = new ChatServiceBinder();
        start();
        return super.onStartCommand(intent, flags, startId);
    }

    public synchronized void start() {
        comThread = new ComThread();
        comThread.start();
    }

    public void onDestroy() {
        stop();
    }

    public void write(byte[] out) {
        comThread.write(out);
    }

    public synchronized void stop() {
        if (comThread != null) {
            comThread.cancel();
            comThread = null;
        }
    }

    private class ComThread extends Thread {
        private static final int BCAST_PORT = 2562;
    DatagramSocket mSocket;
    InetAddress myBcastIP, myLocalIP;

    public ComThread() {

        try {
            myBcastIP = getBroadcastAddress();
            if (D)
                Log.d(TAG, "my bcast ip : " + myBcastIP);

            myLocalIP = getLocalAddress();
            if (D)
                Log.d(TAG, "my local ip : " + myLocalIP);

            mSocket = new DatagramSocket(BCAST_PORT);
            mSocket.setBroadcast(true);

        } catch (IOException e) {
            Log.e(TAG, "Could not make socket", e);
        }
    }

    public void run() {

        try {

            byte[] buf = new byte[1024];
            if (D)
                Log.d(TAG, "run(), com thread startet");
            // Listen on socket to receive messages
            while (true) {
                DatagramPacket packet = new DatagramPacket(buf, buf.length);
                mSocket.receive(packet);

                InetAddress remoteIP = packet.getAddress();
                if (remoteIP.equals(myLocalIP))
                    continue;

                String s = new String(packet.getData(), 0,
                        packet.getLength());
                if (D)
                    Log.d(TAG, "run(), " + s);

                Message msg = new Message();
                msg.obj = s;
                msg.arg1 = MessageHandler.MSG_IN;
                state.getHandler().sendMessage(msg);

            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    /**
     * Write broadcast packet.
     */
    public void write(byte[] buffer) {
        try {
            String data = new String(buffer);
            DatagramPacket packet = new DatagramPacket(data.getBytes(),
                    data.length(), myBcastIP, BCAST_PORT);
            mSocket.send(packet);
        } catch (Exception e) {
            Log.e(TAG, "write(), Exception during write", e);
        }
    }

    /**
     * Calculate the broadcast IP we need to send the packet along.
     */
    private InetAddress getBroadcastAddress() throws IOException {
        WifiManager mWifi = (WifiManager) state
                .getSystemService(Context.WIFI_SERVICE);

        WifiInfo info = mWifi.getConnectionInfo();
        if (D)
            Log.d(TAG, "\nWiFi Status: " + info.toString());

        // DhcpInfo is a simple object for retrieving the results of a DHCP
        // request
        DhcpInfo dhcp = mWifi.getDhcpInfo();
        if (dhcp == null) {
            Log.d(TAG, "Could not get dhcp info");
            return null;
        }

        int broadcast = (dhcp.ipAddress & dhcp.netmask) | ~dhcp.netmask;
        byte[] quads = new byte[4];
        for (int k = 0; k < 4; k++)
            quads[k] = (byte) ((broadcast >> k * 8) & 0xFF);

        // Returns the InetAddress corresponding to the array of bytes.
        return InetAddress.getByAddress(quads); // The high order byte is
                                                // quads[0].
    }

    private InetAddress getLocalAddress() throws IOException {

        try {
            for (Enumeration<NetworkInterface> en = NetworkInterface
                    .getNetworkInterfaces(); en.hasMoreElements();) {
                NetworkInterface intf = en.nextElement();
                for (Enumeration<InetAddress> enumIpAddr = intf
                        .getInetAddresses(); enumIpAddr.hasMoreElements();) {
                    InetAddress inetAddress = enumIpAddr.nextElement();
                    if (!inetAddress.isLoopbackAddress()) {
                        return inetAddress;
                    }
                }
            }
        } catch (SocketException ex) {
            Log.e(TAG, ex.toString());
        }
        return null;
    }

    public void cancel() {
        try {
            mSocket.close();
        } catch (Exception e) {
            Log.e(TAG, "close() of connect socket failed", e);
        }
    }
}

public class ChatServiceBinder extends Binder {
    private ChatService service = ChatService.this;

    public ChatService getService() {
        return service;
    }
} 
```

}

}

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T23:01:29.170

有点晚了，而且不是一个很好的答案，但是在 Android 3+ Runnable 上不会被解释为允许的，除非它在服务内部（不是你拥有的子类）。我知道这是一个限制检查，因为您可以自由地创建几乎任何您想要的任何东西，但是再一次，UDP 多播并不是所有 Android 开发人员都搞砸的事情。希望这可以帮助。

# linux - 分段寄存器使用

> ID：10903816
> 
> 赞同：6
> 
> 时间：2012-06-05T19:40:45.337
> 
> 标签：linux, memory, x86, memory-segmentation

我试图了解内存管理是如何在低级别进行的，并且有几个问题。

1) Kip R. Irvine 的一本关于汇编语言的书说，在实模式下，程序启动时，前三个段寄存器加载了代码、数据和堆栈段的基地址。这对我来说有点模棱两可。这些值是手动指定的，还是汇编器生成指令将值写入寄存器？如果它自动发生，它如何找出这些段的大小？

2）我知道Linux使用扁平线性模型，即以非常有限的方式使用分段。此外，根据 Daniel P. Bovet 和 Marco Cesati 的“Understanding the Linux Kernel”，GDT 中有四个主要部分：用户数据、用户代码、内核数据和内核代码。所有四个段都具有相同的大小和基地址。如果它们仅在类型和访问权限上有所不同（它们都产生相同的线性地址，对吗？），我不明白为什么需要其中四个。为什么不只使用其中一个并将其描述符写入所有段寄存器？

3）不使用分段的操作系统如何将程序划分为逻辑段？例如，它们如何区分堆栈和没有段描述符的代码。我读到分页可用于处理此类事情，但不明白如何。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T21:15:40.243

1.  您一定读过一些很老的书，因为没有人再为*实模式*编程了；-) 在*实模式*中，您可以使用 获取内存访问的物理地址`phyical address = segment register * 0x10 + offset`，偏移量是一个通用寄存器中的值。因为这些寄存器是 16 位宽的，一个段将是 64kb 长，而且你对它的大小无能为力，只是因为没有属性！通过`* 0x10`乘法，可以使用 1mb 的内存，但是根据您在*段寄存器*和*地址寄存器*中放入的内容，会有重叠的组合。我还没有为*real-mode*编译任何代码，但我认为由操作系统来设置*段寄存器*在二进制文件加载期间，就像加载程序在加载 ELF 二进制文件时分配一些页面一样。但是我确实编译了裸机内核代码，我必须自己设置这些寄存器。

2.  由于架构限制，平面模型中必须有四个段。在*保护模式下*，*段寄存器*不再包含段基地址，而是一个*段选择器*，它基本上是 GDT 的偏移量。根据*段选择器*的值，CPU 将处于给定的特权级别，这就是 CPL（当前特权级别）。*段选择器*指向一个*段描述符*，它有一个 DPL（描述符特权级别），如果*段寄存器*被这个选择器填充（至少对于代码段选择器是正确的），它最终是 CPL 。因此，您至少需要一对*段选择器*将内核与用户区区分开来。此外，段要么是代码段，要么是数据段，所以你最终会在 GDT 中得到四个*段描述符。*

3.  我没有任何使用分段的严重操作系统的例子，只是因为分段仍然存在以实现向后兼容。使用平面模型方法只不过是摆脱它的一种手段。无论如何，你是对的，分页更加高效和通用，并且几乎适用于所有架构（至少是概念）。我无法在此处解释分页内部原理，但您需要了解的所有信息都在优秀的英特尔人员内部：[英特尔® 64 和 IA-32 架构软件开发人员手册第 3A 卷：系统编程指南，第 1 部分](http://download.intel.com/products/processor/manual/253668.pdf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T08:22:59.040

扩展[Benoit 对问题 3 的回答](https://stackoverflow.com/a/10940003/968261)......

将程序划分为代码、常量数据、可修改数据和堆栈等逻辑部分是由不同的代理在不同的时间点完成的。

首先，您的编译器（和链接器）创建指定此划分的可执行文件。如果您查看许多可执行文件格式（PE、ELF 等），您会发现它们支持某种节或段或任何您想要调用的格式。除了文件中的地址、大小和位置之外，这些部分还具有告诉操作系统这些部分的用途的属性，例如，此部分包含代码（这里是入口点），this - 已初始化的常量数据，that - 未初始化的数据（通常不占用文件中的空间），这里有一些关于堆栈的内容，还有依赖项列表（例如 DLL）等。

接下来，当操作系统开始执行程序时，它会解析文件以查看程序需要多少内存，每个部分需要在哪里以及需要什么内存保护。后者通常通过页表完成。代码页被标记为可执行和只读，常量数据页被标记为不可执行和只读，其他数据页（包括堆栈的数据页）被标记为不可执行和读写。正常情况下应该是这样。

通常，程序需要读写，同时需要动态生成代码的可执行区域，或者只是为了能够修改现有代码。组合的 RWX 访问可以在可执行文件中指定，也可以在运行时请求。

可以有其他特殊页面，例如用于动态堆栈扩展的保护页面，它们被放置在堆栈页面旁边。例如，您的程序从为 64KB 堆栈分配的足够页面开始，然后当程序尝试访问超出该点时，操作系统会拦截对这些保护页面的访问，为堆栈分配更多页面（直到支持的最大大小）和进一步移动保护页。这些页面不需要在可执行文件中指定，操作系统可以自己处理它们。该文件应仅指定堆栈大小以及可能的位置。

如果操作系统中没有硬件或代码来区分代码内存和数据内存或强制执行内存访问权限，则划分非常正式。16 位实模式 DOS 程序（COM 和 EXE）没有以某种特殊方式标记代码、数据和堆栈段。COM 程序将所有内容放在一个共同的 64KB 段中，它们以 IP=0x100 和 SP=0xFFxx 开头，内部代码和数据的顺序可以是任意的，它们几乎可以自由地交织在一起。DOS EXE 文件只指定了起始 CS:IP 和 SS:SP 位置，除此之外，代码、数据和堆栈段与 DOS 无法区分。它所需要做的就是加载文件，执行重定位（仅适用于 EXE），设置 PSP（程序段前缀，包含命令行参数和一些其他控制信息），加载 SS:SP 和 CS:IP。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-05T20:32:54.350

在这种情况下，维基百科是你的朋友。[http://en.wikipedia.org/wiki/Memory_segmentation](http://en.wikipedia.org/wiki/Memory_segmentation)和[http://en.wikipedia.org/wiki/X86_memory_segmentation](http://en.wikipedia.org/wiki/X86_memory_segmentation)应该是很好的起点。

不过，我相信这里还有其他人可以亲自提供深入的解释。

# ios - heightForRowAtIndexPath 加载时偶尔会崩溃，NSCoding - iOS

> ID：10903817
> 
> 赞同：1
> 
> 时间：2012-06-05T19:40:48.917
> 
> 标签：ios, cocoa, nscoding, heightforrowatindexpath

关于我保存数据的方式的一些信息：我有一组由用户添加和删除的视图控制器（这基本上是一个笔记应用程序，视图控制器是文件夹）。视图控制器具有应用程序需要保存的几个动态属性以及其中的注释数组，然后注释对象本身有一些需要保存的属性。视图控制器和注释当然都有适当的 NSCoding 东西，这是视图控制器上的一个，例如：

```
- (void) encodeWithCoder:(NSCoder *)encoder {
    [encoder encodeObject:self.folderName forKey:@"lvcTitle"];
    [encoder encodeObject:[NSNumber numberWithInt:self.myPosition] forKey:@"myPosition"];
    [encoder encodeObject:self.notes forKey:@"notes"];
}

- (id)initWithCoder:(NSCoder *)decoder {
    self.folderName = [decoder decodeObjectForKey:@"lvcTitle"];
    NSNumber *gottenPosition = [decoder decodeObjectForKey:@"myPosition"];
    int gottenPositionInt = [gottenPosition intValue];
    self.myPosition = gottenPositionInt;
    self.notes = [decoder decodeObjectForKey:@"notes"];
    return self; } 
```

Controllers 数组属于 Singleton 类。NSCoding 让我很困惑，即使它被认为是简单的东西，但到目前为止，我只告诉 Singleton 保存 Controllers 数组就成功了——然后（成功地）保存了 View Controllers 的所有包含属性，它们的属性以及所有 Notes 的属性。这是单例中的代码：

```
- (void) saveDataToDisk:(id)object key:(NSString *)key {
    NSString *path = [self pathForDataFile];

    NSMutableDictionary *rootObject;
    rootObject = [NSMutableDictionary dictionary];

    [rootObject setValue:object forKey:key];
    [NSKeyedArchiver archiveRootObject:rootObject toFile:path]; } 

- (void) loadDataFromDisk {
    NSString *path = [self pathForDataFile];
    NSDictionary *rootObject;

    rootObject = [NSKeyedUnarchiver unarchiveObjectWithFile:path];    

    if ([rootObject valueForKey:@"controllers"] != nil) {
        self.controllers = [NSMutableArray arrayWithArray:[rootObject valueForKey:@"controllers"]];
        firstRun = false;

        LabeledViewController *lastOneThere = [self.controllers objectAtIndex:self.controllers.count-1];
        lastOneThere.isFolderAddView = TRUE;

    }else{
        firstRun = true;
    } 
} 
```

然后我在文件夹视图控制器中多次调用 save 方法：

```
[singleton saveDataToDisk]; 
```

这将运行好几次，直到我在应用程序加载时随机崩溃。罪魁祸首是 heightForRowAtIndexPath：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {

Note *currentNote = [self.notes objectAtIndex:indexPath.row];
if (currentNote.associatedCellIsSelected) {
    return currentNote.myHeight + NOTE_BUTTON_VIEW_HEIGHT;
}

return NORMAL_CELL_FINISHING_HEIGHT;  } 
```

我收到以下错误：

```
2012-06-07 08:28:33.694 ViewTry[1415:207] -[__NSCFString associatedCellIsSelected]: unrecognized selector sent to instance 0x8904710
2012-06-07 08:28:33.696 ViewTry[1415:207] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString associatedCellIsSelected]: unrecognized selector sent to instance 0x8904710'
*** First throw call stack: 
```

我知道“__NSCFString”和“发送到实例的无法识别的选择器”意味着在不应该存在的地方有一个字符串，因为 associatedCellIsSelected 是一个布尔值。但是，如果我只在 heightForRow 中返回“currentNote.myHeight”，我也会得到与 myHeight 相同的 __NSCF 错误，这是一个浮点数。如果我一起取出 heightForRow ，除了适当的高度定义外，一切正常。

顺便说一句，heightForRowAtIndexPath 引用的表视图是在创建并填充注释数组之后在 loadView 中创建的。我只是不明白为什么这个错误只会偶尔弹出一次（比如 5-10 次打开、保存、关闭和重新打开应用程序），看似随机 - 我找不到导致这种行为的模式。任何指针？

对不起，我是iOS编程的新手，我确定我在这里做错了很多事情。

编辑 - 此外，一旦应用程序崩溃，每次我重新打开它时它都会崩溃（除非我禁用 heightForRow），直到我卸载并重新安装它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:48:27.910

当您看到“无法识别的选择器”错误并且接收器类型不是您编码的对象类型（在本例中`__NSCFString`不是`Note`）时，您可能遇到问题，即您打算使用的对象已过早释放并且它的地址空间被重用于分配新对象。

修复取决于追踪额外发布发生的位置（或保留没有发生）。如果您可以显示@property 声明，`notes`它可能会更清楚地说明这种情况。

一件快速的事情是从菜单中选择 Product->Analyze 并修复它标记的任何内容。它不会捕获所有内容，但它是一个很好的开始检查。

# ios - 音频会话中断后停止调用音频图渲染回调

> ID：10903821
> 
> 赞同：4
> 
> 时间：2012-06-05T19:41:40.093
> 
> 标签：ios, core-audio, audiounit, audiosession

我在 iOS 上使用音频单元处理图服务来创建一个小的音频单元图来输出音频。我设置了一个渲染回调，并在调用回调时将音频数据馈送到图表中。

这工作正常，直到我的音频会话被中断（例如通过电话或警报）；那时回调停止，并且不再被调用，即使在中断完成之后也是如此。

我尝试在图表上再次调用 AUGraphStart() ，但这似乎没有帮助。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T20:12:44.977

事实证明，您需要在中断回调中使用 AUGraphStop() 显式停止图形；否则对 AUGraphStart() 的调用将没有任何效果。

# java - 在方括号中查找文本，但不在括号中

> ID：10903823
> 
> 赞同：1
> 
> 时间：2012-06-05T19:41:48.047
> 
> 标签：java, regex, wikipedia, parentheses, square-bracket

如果我有一个需要用 Java 解析的字符串（来自 Wiki 标记）：

```
this link (is [[ inParen ]] and) (this) one is [[ notInParen ]] 
```

我想使用正则表达式来提取 [[ ]] 内的文本，但如果它们在括号内则不行。例如，在上面的示例中，它应该返回：

```
notInParen 
```

但忽略：

```
inParen and this 
```

...因为它们在括号内。我可以分别找到括号和括号没问题：

```
.*\(.*?\).* and .*?\[\[(.*?\]\].* 
```

...但不知道如何找到 [[ ]]，四处寻找括号，然后忽略。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:45:12.413

需要一次性完成吗？你可以做：

*   解析字符串并删除括号中包含的所有子字符串。
*   `[[`再次解析结果并使用和获取所有所需的 Wikipedia 链接`]]`。

这解决了问题，使问题更容易解决。

在第 1 步之后，您有：`this link one is [[ notInParen ]]`.

在第 2 步之后，您有：`notInParen`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:57:51.630

这是一个很好的正则表达式

```
\(.*?\)|\[\[(.*?)]] 
```

您想要的比赛将在第 1 组

仅供参考，为了使其性能更好，您可以通过用否定字符类替换惰性匹配来最小化回溯。

在 Java 中，这变成

```
String ResultString = null;
try {
    Pattern regex = Pattern.compile("\\(.*?\\)|\\[\\[(.*?)\\]\\]", Pattern.DOTALL | Pattern.MULTILINE);
    Matcher regexMatcher = regex.matcher(subjectString);
    if (regexMatcher.find()) {
        ResultString = regexMatcher.group(1);
    } 
} catch (PatternSyntaxException ex) {
    // Syntax error in the regular expression
} 
```

请注意，对于交替的第一部分确实匹配的情况，组 1 将为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T20:07:25.837

你也可以这样做

```
String data = "this link (is [[ inParen ]] and) (this) one is [[ notInParen ]]" +
        " this link (is [[ inParen ]] and) (this) one is [[ notInParen ]]";

boolean insideParentheses = false;
int start = 0, end = 0;
for (int i = 0; i < data.length() - 1; i++) {
    if (data.charAt(i) == '(')
        insideParentheses = true;
    if (data.charAt(i) == ')')
        insideParentheses = false;
    // -> [[ and ]] inside Parentheses are not important
    if (!insideParentheses && 
            data.charAt(i) == '[' && data.charAt(i + 1) == '[') {
        start = i;
    }
    if (!insideParentheses && 
            data.charAt(i) == ']' && data.charAt(i + 1) == ']') {
        end = i;
        System.out.println(data.substring(start, end + 2));
    }
} 
```

输出

```
[[ notInParen ]]
[[ notInParen ]] 
```

# c# - IEnumerable .Value() 扩展方法在 VB.Net 中可用，但在 C# 中不可用？

> ID：10903830
> 
> 赞同：4
> 
> 时间：2012-06-05T19:42:10.433
> 
> 标签：c#, vb.net, extension-methods, ienumerable, xelement

在 VB.Net 中，您可以轻松获取 XElement 的第一个子元素的文本值，如下所示：

```
Dim sChildValue = xeParent.<MyChild>.Value() 
```

当然，C# 不支持该语法，但它产生与 Elements() 方法相同的 IEnumerable(Of XElement) 结果。所以我们可以像这样重写上面的代码：

```
Dim sChildValue = xeParent.Elements("MyChild").Value() 
```

这个 Value() 扩展方法很方便，因为您经常使用小型 XML 文档，并且只需要第一个匹配的节点。（这个方法让我烦恼的一件事是，如果 IEnumerable 列表由于未找到指定的元素而为空，它似乎返回 Nothing/null。为了解决这个问题，我创建了自己的返回空的 ValueOrBlank() 方法而是在那种情况下使用字符串。）

我的问题是我不能在 C# 中做同样的事情：

```
var sChildValue = xeParent.Elements("MyChild").Value(); // won't compile, can't find Value() method 
```

我检查了我的引用/导入，它们与相同调用工作的 VB.Net 项目相匹配。幸运的是，我能够使用我的自定义 ValueOrBlank() 扩展方法来完成同样的事情。但我很好奇我的 C# 项目中缺少什么。我尝试在 Visual Studio 中右键单击 Value() 方法调用并单击“转到定义”以查看对象浏览器是否可以告诉我扩展方法的保存位置，但它只显示 System.String 类。这是否意味着这是编译器本身支持的那些鬼鬼祟祟的仅 VB.Net 功能之一，例如 XML Axis < MyChild > 语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T20:05:59.257

`.Value()` described in link you gave is not an extension method, it's a property and it's specific to VB.net (like any other axis properties: ., ..., @Attribute, (indexer))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:43:30.987

你需要得到一个*元素*：

```
var value = parent.Element("MyChild").Value; 
```

# ruby-on-rails - 设置用于资产的 url

> ID：10903832
> 
> 赞同：0
> 
> 时间：2012-06-05T19:42:17.607
> 
> 标签：ruby-on-rails, ruby

我有一个 Rails 应用程序

```
salmonfishing.com 
```

它有一个数据库。我有另一个应用程序

```
salmonfishing-test.com 
```

如何为根 url 设置别名，以便当用户访问

```
http://salmonfishing-test.com 
```

资产和数据来自

```
http://salmonfishing.com database 
```

将会被使用。

我的 database.yml 指向“salmonfishing”数据库，但生成的图像 url 是

```
http://salmonfishing-test/bigfish.png 
```

这是预期的，但是在内部我希望它被别名为

```
http://salmonfishing.com/bigfish.png 
```

...基本上所有资产和数据都来自“鲑鱼捕捞”数据库，并保存到其中。遇到各种设置子路径的方式，但不是资产和数据的根。

干杯，

```
 Jet 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:03:46.163

如果您唯一的问题是资产 URL 中的域名错误，您可以在环境配置文件中更改它`config/environments/[whatever].rb`：

```
config.action_controller.asset_host = "http://salmonfishing.com" 
```

此行已存在于 中`production.rb`，但已被注释掉。

# c# - 如何从gridview模板字段中获取标签控件值

> ID：10903833
> 
> 赞同：1
> 
> 时间：2012-06-05T19:42:21.623
> 
> 标签：c#, asp.net

我有一个gridview 和sqldatasource。

我有一个 templatefield 列，在编辑项模板的文本框下方有一个简单的 label 。

有没有办法在 ROW UPDATING 事件中获取标签值？

我试过了：`String llbl = ((Label)row.Cells[6].FindControl("label1")).Text;` 嗯，我想不应该，`cells[6]`因为我想得到标签。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:49:09.393

我认为这就是你要找的：

```
DataRow row = ((DataRowView)e.Row.DataItem).Row;

Label Mylabel = (Label)e.Row.FindControl("lblName"); 
```

编辑：

好的，那么试试这个：

```
GridViewRow row = MyGrid.Rows[e.RowIndex];
Label MyLabel = (Label)row.FindControl("MyLabel"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:07:19.930

您可以使用 DataGridItemEventArgs 来查找标签。以下是 UpdateCommand 的代码：

```
 private void grid_UpdateCommand(object source, System.Web.UI.WebControls.DataGridCommandEventArgs e)
    {
          Label label1 = (Label) e.Item.FindControl("label1");
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-22T13:48:41.120

这在 RowEditing 中对我有用：

```
Label label1 = (Label)GridViewID.Rows[e.NewEditIndex].FindControl("label1");
string label1val = label1.Text; 
```

我相信这就是您想要的 RowUpdating：

```
Label label1 = (Label)GridViewID.Rows[e.RowIndex].FindControl("label1");
string label1val = label1.Text; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-30T09:29:20.393

试试这个它总是对我有用

```
string lbl =((Label)gvEmployee.Rows[rowNo].Cells[0].FindControl("lblEmpid")).Text; 
```

# performance - 在大多数现代 64 位处理器上，“mulq”的速度是否取决于操作数？

> ID：10903836
> 
> 赞同：5
> 
> 时间：2012-06-05T19:42:32.140
> 
> 标签：performance, assembly, x86-64, cpu, intel

在大多数现代 64 位处理器（例如 Intel Core 2 Duo 或 Intel i7 系列）上，x86_64 命令`mulq`及其变体的速度是否取决于操作数？例如，乘法`11 * 13`会比`11111111 * 13131313`? 还是总是需要最坏情况的时间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T19:49:38.117

**TL; DR：不。恒定长度整数数学运算（除法，它是非线性的）消耗恒定数量的周期，无论操作数的数值如何。**

`mulq`接受两个 QWORD 参数。

这些值以 little-endian 二进制格式（由 x86 架构使用）表示，如下所示：

```
1011000000000000000000000000000000000000000000000000000000000000 =       13
1000110001111010000100110000000000000000000000000000000000000000 = 13131313 
```

处理器将这两者视为相同的“大小”，因为它们都是 64 位值。

因此，无论操作数的实际数值如何，循环计数都应该始终相同。

**更多信息：**

有超前*零预期*和超前*零检测*^([ [1](http://www.fdi.ucm.es/profesor/mozos/AEC/lza.pdf) ][ [2](http://www.research.ibm.com/arl/publications/papers/arithlza.PDF) ]) (LZA/LZD) 的概念可用于加速浮点运算。

然而，据我所知，没有主流处理器采用这两种方法中的任何一种来进行整数运算。这很可能是由于大多数整数算术（在这种情况下为乘法）的简单性。LZA/LZD 的开销可能根本不值得，因为简单的整数数学电路无论如何都可以在更短的时间内完成完全乘法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:47:19.627

我没有任何关于手的参考，但我会把钱放在延迟/吞吐量上，因为它不会改变操作数的值。否则，安排将是一场噩梦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-11T04:23:37.830

几十年来，Agner Fog 一直在发布[指令时序表](https://www.agner.org/optimize/instruction_tables.pdf)。他 2019 年 8 月的表格证实了我的预期：现代笔记本电脑和台式电脑中的 CPU 芯片的整数乘法单元具有不变的时序。这些速度非常快，而且相当耗电。

CPU 的设计空间对于智能手机等电池受限的设备有很大的不同。在这样的设备上，整数乘法可以在具有可变时序的微编码循环中实现。

在（大约）2016 年，Thomas Pornin 谈到了可变延迟乘法指令对他的 SSL/TLS 库的设计带来的“问题”：

“...... CPU 中的整数乘法操作码可能会或可能不会在恒定时间内执行；如果不这样做，使用此类操作的实现可能会表现出取决于所涉及数据的执行时间变化，从而可能泄露秘密信息......当一个CPU 具有非恒定时间乘法操作码，执行时间取决于一个或两个操作数的大小（以整数形式）。例如，在 ARM Cortex-M3 上，umull 操作码需要 3 到 5 个周期才能完成，仅当两个操作数的数值都小于 65536 时才采用“短”计数（3 或 4）...一般而言，英特尔 x86 CPU 自第一个奔腾时代以来都提供恒定时间乘法。这不一定成立对于其他供应商，尤其是早期的威盛 Nano。” [2](https://www.bearssl.org/ctmul.html)

# java - 在 Eclipse 上设置 EMF 比较并编译

> ID：10903837
> 
> 赞同：1
> 
> 时间：2012-06-05T19:42:34.793
> 
> 标签：java, eclipse, eclipse-emf, emf, emf-compare

如何在 Eclipse 上结帐和设置 EMF 比较？我找到了 EMF 比较的网站贡献者指南： [http ://wiki.eclipse.org/EMF_Compare/Contributor_Guide](http://wiki.eclipse.org/EMF_Compare/Contributor_Guide)

但他们没有足够的指示。我检查了 master 分支 git 存储库中不包含大量其他依赖项。如番石榴、纸莎草和uml2。

**将插件**导入包含实际产品的工作区的描述。但是当我这样做时，他们的**插件**目录缺少大部分代码。

在签出 1.3 或 1.2 等标签时，我遇到了类似的问题。

我正在寻找对 EMF 比较进行调整我需要在 Eclipse 上进行设置，以便我可以运行和测试我的更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T07:35:35.417

贡献者指南仅指出检索 EMF 比较源的方法。我们必须做到这一点，以便我们告诉人们如何检索我们的依赖关系。（我是该项目的提交者之一。）

EMF Compare 目前正在进行大修：master 分支是未来的“2.0”版本。它确实可以编译，但它提供的代码还没有完全发挥作用。然而，1.3 分支只能在“Juno”（eclipse 3.8/4.2）平台上编译：我们的纸莎草支持不能再在劣质目标上编译。是的，这会造成很大的混乱。

您想为哪个版本的 EMF 比较做出贡献/更改？我会在 Indigo (Eclipse 3.7) 或更小的平台上打赌它反对 1.3？在这种情况下，您将不得不忽略某些插件。

EMF Compare 的核心，也是您在工作区中编译功能模型比较支持真正需要的唯一东西，是 1.3 分支的以下插件集（oeec 代表“org.eclipse.emf.compare”） ：

```
o.e.e.c
o.e.e.c.diff
o.e.e.c.diff.edit
o.e.e.c.logical
o.e.e.c.logical.ui
o.e.e.c.match
o.e.e.c.ui 
```

单元测试也可以毫无问题地导入：

```
o.e.e.c.tests
o.e.e.c.logical.tests 
```

如果您需要图表比较支持，您可以导入：

```
o.e.e.c.diagram
o.e.e.c.diagram.ecoretools
o.e.e.c.diagram.edit
o.e.e.c.diagram.ui 
```

UML 支持不再在 Indigo 或更低版本上编译，因为 UML2 项目切换到版本 4.0，我们对此更改和隐含的 API 中断做出了反应。Papyrus 支持也无法在 Indigo 和 lesser 上编译，因为它们也破坏了 API。SYSML 由 papyrus 提供，因此也不再编译。Epatch 已被弃用，但如果您有勇气检索所有 oeecmpatch 插件的所有依赖项，则可以导入和编译所有插件。

至于我们的依赖，如果你只拿 EMF Compare 的核心，你只需要[EMF](http://www.eclipse.org/modeling/emf/)。他们的 git 可以使用 URI 克隆：git://git.eclipse.org/gitroot/emf/org.eclipse.emf.git

如果您想要的不仅仅是核心，我真的建议您安装[Eclipse 建模包](http://www.eclipse.org/downloads/packages/eclipse-modeling-tools/indigosr2)并从那里开始：它已经包含了我们所有的依赖项。当然，您也可以检索它们的源... [GMF-runtime](http://wiki.eclipse.org/Graphical_Modeling_Framework/Contributors_Area#GMF_Runtime)在 CVS 上，EcoreTools 可以从 git://git.eclipse.org/gitroot/ecoretools/org.eclipse.ecoretools.git 克隆，UML2 可以克隆来自 git://git.eclipse.org/gitroot/uml2/org.eclipse.uml2.git 。

# c - 通过管道发送结构数组：win32，C

> ID：10903838
> 
> 赞同：0
> 
> 时间：2012-06-05T19:42:37.040
> 
> 标签：c, windows, pipe, named-pipes

我正在尝试使用 win32 中的管道从一个应用程序到另一个应用程序发送一个 *var，这实际上是一个 4 插槽数组。我怎样才能正确地做到这一点？

据我所知，我做得正确：

```
 //sending like this:
    if (!WriteFile(hPipeWriteGhosts[i],Ghosts, (DWORD) sizeof(map)*4, &n, NULL)) 
                {  
                    printf("[ERROR] Writing in the pipe... (WriteFile)\n");
                    exit(1);
                }

    //receiving like this
    ret = ReadFile(HReadSPipe, Ghosts, sizeof(map)*4, &n, NULL);   // Lê até ao numero de bytes for zero (pipe fechado) pk o cliente escreveu fim e n escreveu mais nada
        if (!ret || !n)
            MessageBox(hDlgGlobal, str, "Error", MB_YESNO | MB_ICONINFORMATION);  // But in fact it shows me this all the time. 
```

我怎样才能正确地做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:55:34.637

好的，您的问题是您正在跨进程边界移动句柄和指针。你的`map`包含一个`char *`和一个`HBITMAP`。您转移`char *`价值，但不转移它指向的数据。您传输位图的句柄，而不是实际的位图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T06:23:09.913

您需要传输结构映射中包含的物理数据。

通常，我使用字节数组通过管道传输数据。对于结构或对象之类的数据项，最好将结构或对象的各个数据成员复制到字节数组中，如果您有嵌套结构或包含字符串或任何其他数据类型的数组，则可能也是递归的。固定大小。然后在管道的另一端根据字节数组中接收到的数据重建结构或对象。对于任何没有固定大小（例如 int）的数据，我将该项目的大小写入字节数组，然后是数据本身。

此外，如果它在服务器端似乎无法正确读取，或者在客户端可能无法正确写入，请将发生的任何运行时错误（如果有）发送给我们，并向我们展示您是如何声明和构建的你的缓冲区变量，幽灵。例如，您确定不是无意中转移了结束缓冲区位置而不是开始位置吗？

# jquery - Jquery Treeview Expand and Collapse node on text click with persist cookie option

> ID：10903842
> 
> 赞同：0
> 
> 时间：2012-06-05T19:42:47.680
> 
> 标签：jquery, treeview

当我单击 +/- 符号以及单击每个符号旁边的文本（超链接）时，我想展开和折叠节点。我想折叠前一个节点并展开我单击的节点。我正在使用以下方法。

```
$(document).ready(function(){

    // first example
    $("#navigation").treeview({
        persist: "cookie", //I want to store the state and come back to the state when i reload the page.
        collapsed: true, //I want to collapse all the nodes when i load.
        unique:true //I want to open only one node at a time
    });
}); 
```

我尝试了很多选择，但没有一个有效。请帮我。

我的 HTML 是：

```
 <ul id="navigation" class="treeview">
            <li>
                <div>
                    <a href="#">Marketing</a>
                </div>
                <ul>
                    <li>
                        <div>
                            <a href="#">Joysticks</a>
                        </div>
                        <ul>
                            <li>
                                <div>
                                    <a href="#">Intel</a>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <a href="#">Microsoft</a>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <a href="#">Sony</a>
                                </div>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <div>
                            <a href="#">Laptops</a>
                        </div>
                        <ul>
                            <li>
                                <div>
                                    <a href="#">Apple</a>
                                </div>
                                <ul>
                                    <li>
                                        <div>
                                            <a href="#">iMac</a>
                                        </div>
                                    </li>
                                    <li>
                                        <div>
                                            <a href="#">MacBook Air</a>
                                        </div>
                                    </li>
                                    <li>
                                        <div>
                                            <a href="#">MacBook Pro</a>
                                        </div>
                                    </li>
                                    <li>
                                        <div>
                                            <a href="#">Accessories</a>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <div>
                                    <a href="#">Dell</a>
                                </div>
                                <ul>
                                    <li>
                                        <div>
                                            <a href="#">Inspiron</a>
                                        </div>
                                    </li>
                                    <li>
                                        <div>
                                            <a href="#">XPS</a>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <div>
                                    <a href="#">Sony</a>
                                </div>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <div>
                            <a href="#">Phones</a>
                        </div>
                        <ul>
                            <li>
                                <div>
                                    <a href="#">LG</a>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <a href="#">Motorola</a>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <a href="#">Samsung</a>
                                </div>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:18:52.000

您是 generate 背后的代码`<div><a href="#">Marketing</a></div>`。显然，有两个级别的标签是有问题的。将结构更改为just `<span>Marketing</span>`，它将起作用。我的猜测是你可以使用`<a>`或者`<div>`如果你愿意的话。

我在这里进行了这些更改并且它有效：http: [//jsfiddle.net/lbstr/V7A6A/2/](http://jsfiddle.net/lbstr/V7A6A/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T19:32:11.193

当我展开每个节点时，jQuery 树视图示例正在设置 cookie。我在每个站点/页面后面的代码中构建了相同的逻辑（当我们单击每个节点时它是如何生成 id 的），然后在生成标签时将此 id 分配给 a 标签。然后在 document.ready 函数中，我编写了以下逻辑来设置每次点击时的 cookie id。

```
 jQuery.fn.alertElementUrl = function()
            {
                return this.each(function()
                {
                    if(this.id == "")
                    {
                        $.cookie("treeview", $.cookie("treeview"),{path: '/'} );
                        window.location = this.href;
                    }
                    else
                    {
                        $.cookie("treeview", this.id.substring(this.id.lastIndexOf('_')+1),{path: '/'} );
                        window.location = this.href;
                    }
                });     
            };

            $("a").click(function ()
            {
                $(this).alertElementUrl();      

            }); 
```

# facebook - 带有 facebook 的 Ubuntu 桌面应用程序

> ID：10903845
> 
> 赞同：1
> 
> 时间：2012-06-05T19:42:56.153
> 
> 标签：facebook, ubuntu, monodevelop, gtk#

我正在为 ubuntu 桌面开发一个 GTK# 应用程序。主要功能包括在认证后获取 Facebook 直播和通知等。我已经在developers.facebook上注册了该应用程序，获得了应用程序ID，但我找不到任何用于桌面应用程序开发的资源，这就是我卡住的地方。

我刚刚开始进行 Ubuntu 开发，所以请不要介意这个问题的模糊概念。这里的 Ubuntu 开发人员请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:25:22.347

我建议使用像 Glade 这样的 GUI 设计器：

> Glade 可以与 Glade# 绑定一起使用，以轻松设计 GUI 应用程序。一个名为[Stetic](http://en.wikipedia.org/wiki/Stetic)的 GUI 设计器与 [MonoDevelop](http://en.wikipedia.org/wiki/MonoDevelop) IDE 集成在一起。

# jquery - 在 DOM 可能发生更改后，是否可以“刷新”或“重新运行”jQuery 选择器？

> ID：10903846
> 
> 赞同：4
> 
> 时间：2012-06-05T19:42:59.033
> 
> 标签：jquery

我有一个加载一组复杂表单的页面。在这组表单中，有密码字段。这些密码字段具有显示/隐藏切换开关，当其中任何一个被单击时，所有密码字段都将替换为 DOM 中它们自身的等价物，其类型在“文本”和“密码”之间切换，以促进显示/隐藏效果. 需要明确的是，原始输入是 replaceWith()'ed 一个全新的输入，具有相同的属性，包括 ID，但具有不同的类型属性。

问题是当切换发生时，我之前在 jQuery 选择器中创建的全局句柄（例如 $('#password_field_id')）不再映射到密码字段。

是否有可以在选择器上运行的 jQuery 函数，该选择器将从当前 DOM 中重新选择其原始 CSS 选择器？

替换输入的函数如下：

```
function TogglePasswordHide()
{
    var show = false;
    if ($('#basic_pass_24').attr('type') == 'password')
    {
        show = true;
    }

    $('input.password_input').each(function()
    {
        var sDisabled = '';
        if ($(this).is(':disabled'))
        {
            sDisabled = 'disabled="disabled"';
        }

        if ( show ) // show the password
        {
            $(this).replaceWith('<input type="text" '+sDisabled+' class="password_input" id="'+$(this).attr('id')+'" value="'+$(this).val()+'">');
            show_password.text('hide');
        }
        else // hide the password
        {
            $(this).replaceWith('<input type="password" '+sDisabled+' class="password_input" id="'+$(this).attr('id')+'" value="'+$(this).val()+'">');
            show_password.text('show');
        }
    });
} 
```

...我可以在 .each 期间进行调用以在替换完成后“重新加载”jquery 对象，以便我对这些相同相关输入的全局句柄将简单地更新自己，而不必重新声明新的 jQuery 对象每个元素使用相同的选择器并覆盖原始句柄？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:46:59.987

使用事件委托，并监听父表单上的事件：

```
$("form").on("click", ".password_input", function(event) {
    /* What to do when password input is clicked */
}); 
```

由于此事件绑定到表单元素，因此您可以根据需要添加和删除输入，而不必担心丢失事件。

当您在其中一个密码输入上单击或执行某些其他操作时，此事件会冒泡到随后对其进行评估的表单。如果`.target`匹配您的选择器（在本例中为`.password_input`），将调用回调函数，您可以对发生的事件做出反应。

# reload - solrj 重载请求

> ID：10903853
> 
> 赞同：0
> 
> 时间：2012-06-05T19:43:12.487
> 
> 标签：reload, solrj

你能帮我解决这个问题吗：

如何使用 SolrJ 重新加载更新的 schema.xml？

[这](http://wiki.apache.org/solr/CoreAdmin#RELOAD)是表示可能的链接。但是如何发送这个请求呢？

提前致谢。

问候， 萨加尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T11:13:00.983

看看这个[答案](https://stackoverflow.com/a/10698335/633239)。这应该是您要查找的代码：

```
CoreAdminRequest adminRequest = new CoreAdminRequest();
adminRequest.setAction(CoreAdminAction.RELOAD);
CoreAdminResponse adminResponse = adminRequest.process(new CommonsHttpSolrServer(solrUrl));
NamedList<NamedList<Object>> coreStatus = adminResponse.getCoreStatus(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T08:17:48.047

您是否尝试过使用

```
org.apache.solr.core.CoreContainer.reload(String coreName) 
```

`coreName`要重新加载的 SolrCore 的名称在哪里。

# jquery - Jquery 或 Ajax 下拉 div

> ID：10903859
> 
> 赞同：0
> 
> 时间：2012-06-05T19:43:40.963
> 
> 标签：jquery, css, ajax, xhtml

我从某个网站上提取了一个（工作）jquery 下拉列表，但我真的不明白为什么它不适用于我的页面，这是我的代码：

```
Head

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
jQuery(document).ready(function() {
  jQuery(".hidden").hide();
  //toggle the componenet with class msg_body
  jQuery(".row").click(function()
  {
    jQuery(this).next(".hidden").slideToggle(500);
  });
});
</script>

Body:
    <div id="likelyToBeWarned">
    <div id="likelyOddHeader" class="row">
        <div id="likelyOddA" class="left">Test</div>
        <div id="LikelyOddB" class="middle"><img class="middle" src="image002.png"/></div>
        <div id="timeZone" class="right">West</div>
        <div id ="rows" class="hidden">
            <div id="weights" class="left">Weights:</div>
            <div id="values" class="middle">ValueA:1234  ValueB:12345 ValueC:123456 ValueD:7654321</div>
            <div id="dbWeights" class="right">dbWeightA: 1234 dbWeightB:12345 dbWeightC:123456 dbWeightD:7654321</div>
        </div>

style/css

.hidden{
 position:relative;
 display: table-row;
 height:45px;
 margin-left:auto;
 margin-right:auto;
}

.left{
    display: table-cell;
}

.right{
display: table-cell;
}

.middle{
display: table-cell;
cursor:pointer;
}
.row{
 display: table-row;
 height:45px;
 margin-left:auto;
 margin-right:auto;
} 
```

编辑：想法是将“隐藏” div 显示为“likelyOddHeader” div 的下拉列表。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:53:37.757

您的 HTML 代码中缺少一个结束 div

```
<div id="likelyOddHeader" class="row">
    <div id="likelyOddA" class="left">Test</div>
    <div id="LikelyOddB" class="middle">blablah</div>
    <div id="timeZone" class="right">West</div>
</div> <---------------------------HERE 
<div id ="rows" class="hidden">
        <div id="weights" class="left">Weights:</div>
        <div id="values" class="middle">ValueA:1234  ValueB:12345 ValueC:123456 ValueD:7654321</div>
        <div id="dbWeights" class="right">dbWeightA: 1234 dbWeightB:12345 dbWeightC:123456 dbWeightD:7654321</div>
</div>​ 
```

我在小提琴中添加了那个div，它工作正常[http://jsfiddle.net/CZjZs/1/](http://jsfiddle.net/CZjZs/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:48:31.793

此行`jQuery(this).next(".hidden")`返回空集作为`this`元素`.row`，并且`.hidden`他的孩子不是兄弟姐妹。

采用

```
jQuery(this).children(".hidden") 
```

或者

```
jQuery(this).find(".hidden") 
```

或将`.hidden`元素移动为的兄弟`.row`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T20:20:59.763

你的jQuery：

> jQuery(".row").click(function() { jQuery(this).next(".hidden").slideToggle(500); });

.row 是指一个类。您的 html 显示一个 id.. 所以它应该是：

```
$('#row').click(function(){
  $(this).slideToggle(500);
}); 
```

#row (this) 与 html 中的 .hidden 位于同一行。您要么专注于 id (#row) 或类 (.hidden)，然后在其上进行 slideToggle。

```
jQuery(this).next(".hidden").slideToggle(500); 
```

# c# - 将查询值添加到 asp 链接按钮

> ID：10903869
> 
> 赞同：0
> 
> 时间：2012-06-05T19:44:51.577
> 
> 标签：c#, asp.net, linkbutton

我这里有这个链接按钮。

```
<li><asp:LinkButton ID="MyPDF" OnClick="Download_Click" runat="server" Text="My PDF" NavigateUrl='<%# "./DownloadableProducts.aspx?filename=MyPDF" %>'></asp:LinkButton></li> 
```

它不起作用，它说“找不到文件”。我知道这是查询字符串，因为当我手动输入文件的路径时，它就像一个魅力。

我也试过这个：

```
<li><asp:LinkButton ID="MyPDF" OnClick="Download_Click" runat="server" Text="My PDF" NavigateUrl='<%# "./DownloadableProducts.aspx?filename=" + Eval("ID") %>'></asp:LinkButton></li> 
```

它没有用:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:48:28.573

```
<li>
  <asp:LinkButton ID="MyPDF" OnClick="Download_Click"
    runat="server" Text="My PDF"    
    NavigateUrl="~/DownloadableProducts.aspx?filename=MyPDF">
  </asp:LinkButton>
</li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:20:45.823

尝试这个

```
<li><asp:LinkButton ID="MyPDF" OnClick="Download_Click" runat="server" Text="My PDF" NavigateUrl="./DownloadableProducts.aspx?filename="+'<%# Eval("ID") %>'></asp:LinkButton></li> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T08:52:13.757

```
<li><asp:LinkButton ID="MyPDF" runat="server" Text="My PDF" NavigateUrl='<%# GetUrl(Eval("Id")) %>'></asp:LinkButton></li> 
```

然后添加到代码隐藏中，如下所示：

```
protected string GetUrl(string id) { return ResolveUrl(string.Format("~/DownloadableProducts.aspx?filename={0}", id)); } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T20:12:03.383

将其更改为：

```
<asp:HyperLink ... NavigateUrl='<%# "DownloadableProducts.aspx?filename=" +  Eval("ID") %>' /> 
```

LinkBut​​ton 控件没有属性“NavigateUrl”。如果您需要直接链接到另一个位置，请使用 HyperLink 代替此控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-12T20:52:39.390

使用 LinkBut​​ton 中的 CommandArgument 属性

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-10-15T17:52:45.987

```
<li>
  <asp:LinkButton ID="MyPDF" OnClick="Download_Click" runat="server"
    Text="My PDF" NavigateUrl="DownloadableProducts.aspx?filename=<%#Eval("ID") %>" >   
  </asp:LinkButton>
</li> 
```

这会起作用

# database - 拆分数据库上的网络缓存

> ID：10903871
> 
> 赞同：0
> 
> 时间：2012-06-05T19:44:58.947
> 
> 标签：database, caching, ms-access, split

我们目前正在开发一个调查数据库。这项调查将在许多不同的地点进行，大多数地点没有 wifi 或手机服务。我们正在使用 Windows 7 平板电脑进行调查，并使用桌面编写代码等。

我想知道 MS-Access 在将后端（表等）放置在网络驱动器上并在平板电脑并不总是具有网络连接时将前端放在本地是否有任何限制。

我确定有办法将后端缓存到平板电脑，这不是问题；当**缓存的副本随平板电脑返回网络时，Ms-Access 是否会接受更改。**我一直找不到这方面的任何文献，即使有可能。我可能对缓存的工作方式有误。

输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:51:21.130

您肯定会遇到问题 - 想想用户在打开应用程序的情况下离开 WiFi 覆盖范围。去过那里，做到了，再也不会这样做了。

使用简单、经典的“最后更改时间戳/用户/客户端”同步模式 - 不性感，但它有效。

# c# - 将代码作为参数传递给方法

> ID：10903874
> 
> 赞同：3
> 
> 时间：2012-06-05T19:45:11.407
> 
> 标签：c#, .net, parameters, delegates, action

我有一个方法列表，它们几乎做同样的事情，除了一些区别：

```
void DoWork(string parameter1, string parameter2)

{

//Common code
...

//Custom code
...

//Common code
...

} 
```

我想通过从另一种方法传递自定义代码来重用公共代码来简化解决方案。

我假设我必须使用带参数的操作来完成此操作，但不知道如何操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:58:49.977

你可以试试[**模板方法模式**](http://www.dofactory.com/Patterns/PatternTemplate.aspx)

基本上是这样的

```
abstract class Parent
{
   public virtual void DoWork(...common arguments...)
   {
      // ...common flow
      this.CustomWork();
      // ...more common flow
   }

   // the Customwork method must be overridden
   protected abstract void CustomWork();
} 
```

在一个儿童班

```
class Child : Parent
{
   protected override void CustomWork()
   {
      // do you specialized work
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:47:57.947

您将使用[委托](http://msdn.microsoft.com/en-us/library/ms173171%28v=vs.100%29.aspx)来处理此问题。它可能看起来像：

```
void DoWork(string parameter1, string parameter2, Action<string,string> customCode)
{
    // ... Common code
    customCode(parameter1, parameter2);
    // ... Common code
    customCode(parameter1, parameter2);
    // ... Common code
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T19:48:07.450

如果自定义代码不必与通用代码交互，那很简单：

```
void DoWork(..., Action custom)
{
    ... Common Code ...
    custom();
    ... Common Code ...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T19:57:32.720

假设您需要在自定义代码中使用两个字符串参数，以下应该可以完成工作。如果您实际上并不关心自定义代码的结果，则可以替换`Func<string, string, TResult>`为`Action<string, string>`. 此外，如果您的自定义代码需要处理其上面的公共代码的结果，您可以调整您的 Func<>（或 Action<>）接受的参数类型，然后传入适当的值。

```
void DoWork(string parameter1, string parameter2, Func<string, string, TResult> customCode) {
    //Common code 
    var customResult = customCode(parameter1, parameter2);
    //Common code 
} 
```

使用`Func<T, TResult>`：http: [//msdn.microsoft.com/en-us/library/bb534960](http://msdn.microsoft.com/en-us/library/bb534960)

使用`Action<T>`：http: [//msdn.microsoft.com/en-us/library/018hxwa8](http://msdn.microsoft.com/en-us/library/018hxwa8)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T20:00:31.940

The other answers are great, but you may need to return something from the custom code, so you would need to use Func instead.

```
void Something(int p1, int p2, Func<string, int> fn)
{
   var num = p1 + p2 + fn("whatever");
   // . . .
} 
```

Call it like this:

```
Something(1,2, x => { ...; return 1; }); 
```

Or:

```
int MyFunc(string x)
{
    return 1;
}

Something(1,2 MyFunc); 
```

# html - 用阴影堆叠两个边框？

> ID：10903876
> 
> 赞同：0
> 
> 时间：2012-06-05T19:45:14.683
> 
> 标签：html, css, web, dropshadow

我怎么能在另一个边框周围环绕一个边框并让它们都使用嵌入的阴影（比如相框中的双重抠图）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:54:51.570

[这是我关于这个话题的小提琴](http://jsfiddle.net/rockinthesixstring/3rRWq/)

* * *

## 选项1）

您可以使用伪类来完成此操作

### html

```
<span class="doubleMatt">
    <img src="http://lorempixel.com/400/200/" />
</span> 
```

### CSS

```
span,img{padding:0;margin:0;border:0;}
.doubleMatt{
    position:relative;
    display:inline-block;
    font-size:0;
    line-height:0;
}

.doubleMatt:after{
    position:absolute;
    top:1px;
    left:1px;
    bottom:1px;
    right:1px;
    border:4px solid rgba(255,255,255,0.5);
    outline:1px solid rgba(0,0,0,0.2);
    content:" ";
}​ 
```

* * *

## 选项 2)

您可以使用一些基本的（一维）优点

### CSS

```
.basicMatt {
    background:#222;
    padding:3px;
    border:3px solid #666;
} 
```

### HTML

```
<img class="basicMatt" src="http://www.lorempixel.com/400/200/" /> 
```

* * *

## 选项 3)

你可以使用大纲

### CSS

```
.outlinedMatt{
    background:#fff;
    padding:8px;
    border:3px solid #222;
    outline:3px solid #666;
    margin:3px;
} 
```

### HTML

```
<img class="outlinedMatt" src="http://www.lorempixel.com/400/200" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:59:43.030

您可以嵌套 div，如 - [http://jsfiddle.net/nG4Td/2/](http://jsfiddle.net/nG4Td/2/)

```
<div class="border">
  <div class="border2">
    <p>hello world</p>
  </div>
</div> 
```

css

```
.border{
  border: 5px inset black;
  background:#ccc;
  width:200px;
  height:200px;
  padding:20px;    
}
.border2{
  border: 5px inset black;
  background:#eee;
  width:150px;
  height:150px;
  padding:20px;    
 }` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T20:09:18.430

您可以使用[`:before`和`:after`伪元素](http://www.w3.org/TR/CSS2/selector.html#before-and-after)来完成此操作。请参阅答案末尾的 jsFiddle 演示。

## HTML

```
<div class="frame"><img src="../img/logo.png"></div> 
```

## CSS

```
.frame {
    display:inline-block;
    position:relative;
    margin:20px;
    z-index:5;
    padding:10px;
    background:#376b90;
}
.frame:before {
    position:absolute;
    content:".";
    display:block;
    font-size:0;
    color:transparent;
    /* Change left, right, top, bottom, and box-shadow to position */
    left:0;
    top:0;
    right:0;
    bottom:0;
    box-shadow:inset 0 0 3px 2px black;
}
.frame:after {
    position:absolute;
    content:".";
    display:block;
    font-size:0;
    color:transparent;
    /* Change left, right, top, bottom, and box-shadow to position */
    left:5px;
    top:5px;
    right:5px;
    bottom:5px;
    box-shadow:inset 0 0 3px 2px black;
} 
```

## 示例用法

*   [*外面的*两个影子](http://jsfiddle.net/ZuNZE/)
**   [*内*一影*外一影*](http://jsfiddle.net/ZuNZE/1/)*   [*里面的*两个影子](http://jsfiddle.net/ZuNZE/2/)**   [两个嵌入阴影、一个初始阴影和自定义背景](http://jsfiddle.net/ZuNZE/7/)-*由 OP 请求**   [插入边框](http://jsfiddle.net/ZuNZE/4/)-*复制[https://stackoverflow.com/a/10904061/526741](https://stackoverflow.com/a/10904061/526741)**   [可变长度内容](http://jsfiddle.net/ZuNZE/8/)**

# codeigniter - codeigniter 和选项卡内容

> ID：10903878
> 
> 赞同：0
> 
> 时间：2012-06-05T19:45:26.957
> 
> 标签：codeigniter, tabs

我有一些**标签**，其内容是我网站的全部功能部分。

例如，在我的管理区域，我有标签 [添加/删除相册][添加照片][删除照片]。我在技术上通过选项卡划分管理区域。

我正在使用 ajax 将内容加载到这些选项卡中。选项卡内容区域是一个 div。

**选项卡内容区域内**的视图也使用 ajax 来加载内容。这些是在选项卡内容区域内运行的 ajax 调用。

只要选项卡内容区域内的视图保持不变或仅部分更改，一切正常。But when certain interactions inside tab content area return a whole new view, tab content area would not show them.

我知道会发生什么，返回的这个新视图没有传递到选项卡内容区域 div 中。

在 firebug 中，我可以看到 ajax 成功函数响应显示了返回的新视图。但我不知道如何将该新视图传递给选项卡内容区域。

如果有人能帮助我解释如何解决这个问题或如何在 CI 中管理选项卡内的内容，我将不胜感激。

```
adminTabsview.php

<ul id="adminTabs"> 
    <li ><?php echo anchor('#album_addDelete', 'Album Add/Delete'); ?></li>     
</ul>   
<div id="adminTabsContent"></div>

$(document).ready(function(){   
$('#adminTabs a').on({      
    click: function (evt){          
        evt.preventDefault();           
        var page = this.hash.substr(1);          
         adminTabsAjaxCall(page);           
    }   
});
});

function adminTabsAjaxCall ($data){

$.ajax({
    type: "POST",
    url: "index.php/adminsite_controller/"+ $data + "/",
    dataType: "html",
    data: $data,
    statusCode: {removed}
            },
    success: adminTabContent        

});

function adminTabContent (data){            
    $('#adminTabsContent').html(data);
} 
```

* * *

```
albumsEditDeleteView.php
(this is a view that gets loaded into the tab contentarea div)

<div id="adminTabsContent">
<div id="albumList">
<ul>
<li>
 <a href="#">Asdf</a>
 <a class="add" href="http://localhost/myPHP/photoalbums/index.php/Albums_Controller/add_album/301/Asdf/1/28/0">[ add ]</a>
 <a class="delete" href="http://localhost/myPHP/photoalbums/index.php/Albums_Controller/delete_album/301/Asdf/1/28/0">[ delete ]</a>
</li>
</ul>
</div>
</div>

$(document).ready(function(){   
$('#albumList').on({        
    click: function (evt){          
        evt.preventDefault();   
var $clickedElement = evt.target.tagName;
if ($clickedElement == 'A' ){                
    var urlarray = url.split('/');      
    $chosen.albumid     = urlarray[8];
    $chosen.albumname   = urlarray[9];
    $chosen.lft     = urlarray[10];
    $chosen.rgt     = urlarray[11];
    $chosen.nodeDepth   = urlarray[12]; 
           if ($class == 'add'){                  
     albumajaxcall($chosen);
       }
          if ($class == 'delete'){            
    deleteajaxcall($chosen);
       }            
    }               
}   
});
});

function albumajaxcall($data){
$.ajax({
    type: "POST",
    url: "index.php/Adminsite_Controller/add_album/",
    dataType: "json",
    data: $data,
    statusCode: {removed}
            },
    success: adminTabContent
}); 
}

function adminTabContent(data){         
$('#adminTabsContent').html(data);
} 
```

* * *

```
//heres the view file that has to replace the original view inside 
//tabcontent area
//addnode_view.php
    <?php echo form_open('Albums_Controller/update_albumSet');?>                                
        <input type="text" name="newAlbum" id="newAlbum" value=""/>             
        <input type="submit" name="submit" value="Submit" />        
    <?php echo form_close();?>
    <?php 

//heres the controller function
function add_album(){           
    $levelData ['albumid']      = $this->input->post('albumid');
    <!-- removed-->

    $levelData ['main_content'] = 'addnode_view';   
    $this->load->view('includes/template', $levelData);
}

 //And heres the controller method that loads 
 //the original page (albumsEditDeleteView.php) - this is the original view 
 //that gets loaded into the tab- I get stuck when this view 
 //has to be **totally** replaced through links in the view)

function album_addDelete(){
    $allNodes ['myAlbumList'] = $this->Albums_Model->get_albumList();
    echo $this->load->view('albumsEditDelete_view', $allNodes); 
} 
```

提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:10:19.937

基本上，您需要做的是加载您将在处理您的 ajax 的控制器功能（adminsite_controller/whatever 功能）的选项卡中放入的任何新视图。

这基本上会回显视图文件，该文件将被视为 ajax 函数的成功变量。

所以你有这样的东西然后你的ajax的成功部分

```
success:function(msg){adminTabContent(msg);} 
```

在codeigniter的控制器中，您将以标准方式加载视图，但由于这将只加载页面的一部分，您可能需要创建一个新的视图文件，该文件就是那里的div。如果不是 ajax，您将按照相同的方式收集所有数据。

```
$data['some_data'] = $this->some_model->some_function();
$this->load->view('someview', $data); 
```

# r - 从 R 中的绘图密度函数（核密度估计）中找到最大值

> ID：10903880
> 
> 赞同：0
> 
> 时间：2012-06-05T19:45:37.073
> 
> 标签：r, pdf, max, kde, kernel-density

我有一些我假设来自分布的数据，我正在尝试估计该分布。现在我正在使用 R 中的包**KernSmooth**和高斯内核，并且正在使用包的`dpik()`功能来自动选择我的带宽。（我假设它使用 AMISE 或排序，如果有更好的自动带宽选择过程，请告诉我）不过，我感兴趣的是找到与分布中最高峰对应的 x 值。 ..这对我来说似乎是一件非常简单的事情，而且我早些时候把它视为微不足道的事情，但令我沮丧的是，我遇到了一些障碍。这`bkde()`KernSmooth 中的函数传回一组 (x,y) 坐标，这些坐标映射出算法估计的分布。我知道我可以简单地对数据进行线性搜索以找到最大 y 值，并且可以简单地获取相应的 x 值，但是，当我正在编写一个可能在自动化过程中经常调用的函数时，我觉得它是效率低下。特别是效率低下，因为`bkde()`回馈了很多价值。

我的另一个想法是尝试对其拟合曲线并取导数并将其设置为零，但这听起来也可能效率低下。也许`density()`在这里使用会更好？

请让我知道是否有任何有效的方法......我实际上计划对我找到的分布做一些推断。比如找到截断点，把两边的尾巴砍掉一定比例（即置信区间），求出期望值。我现在的模糊计划是使用一些蒙特卡罗技术或尝试从分布中汲取灵感，以了解具有自举技术的领域。对任何方法的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T20:00:12.270

使用：

```
> require(KernSmooth)
Loading required package: KernSmooth
KernSmooth 2.23 loaded
Copyright M. P. Wand 1997-2009
> mod <- bkde(faithful$waiting)
> str(mod)
List of 2
 $ x: num [1:401] 22.7 23 23.2 23.4 23.7 ...
 $ y: num [1:401] 3.46e-08 1.17e-07 1.40e-07 1.68e-07 2.00e-07 ... 
```

这还不够高效吗？

```
> which(mod$y == max(mod$y))
[1] 245 
```

`density()`做了类似的事情，但它返回 512 个密度值，以 512 个固定间隔为`x`.

在这两个函数中，返回的点数都是可以控制的。请参阅`gridsize`in`bkde()`和`n`in 中的参数`density()`。当然，该方法的精度确实取决于估计 KDE 的点的密度，因此您不会想将其设置得太低。

我的直觉告诉我，与仅使用上述简单解决方案相比，您可能会花费更多时间来思考和实施更有效的方法。

# android - 如何构建 Android SDK 源以获取 Android.jar

> ID：10903892
> 
> 赞同：4
> 
> 时间：2012-06-05T19:47:00.103
> 
> 标签：android, android-source

我不是 Android 专家，但我需要 Android-SDK 字节码来进行一些实验。

我编译了 Androids 源代码，但令人惊讶的是它输出了相同的 SDK，其中基本上包含抛出异常的蹩脚存根。

您可能知道开发人员包中包含的 android.jar 包含存根，所有类中的所有方法都只是 throw new RuntimeException("stub"); 此 SDK 的目的只是允许开发人员在 Eclipse 中针对 android.jar 进行构建，并在实际 SDK 所在的设备/模拟器上执行他们的程序。

我已经将 Java 文件从 Android 的 SDK 源中分离出来，但我没有成功编译它们。我想知道是否有办法这样做或从设备中提取它们。我的最终目标是在常规 JVM 上运行 Android 应用程序，而不是在模拟器或 Dalvik 上运行它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T09:01:44.323

android.jar 只适用于 Eclipse。如果我们在 Framework 中进行一些更改并尝试使用相同的构建 android.jar 文件，它将编译得很好。但它会出现运行时错误，因为您需要更新具有所有运行时 lib 和 jar 文件的 system.img。请从您的服装版本中替换 system.img。它会起作用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:00:51.310

你不能在 JVM 上运行 android.jar 代码。就像您在问题中所说的那样，如果这样做，您将获得运行时异常。这是设计使然，您可以从流行的 java IDE（如 eclipse）获得所有语法和重构工具支持。

# android - getPackageInfo() 在设备启动时调用时抛出异常，但不是稍后？

> ID：10903893
> 
> 赞同：2
> 
> 时间：2012-06-05T19:47:05.033
> 
> 标签：android, widget, package

我发现 PackageManager 类的 getPackageInfo() 方法有一些奇怪的行为。

我有一个应用小部件，它依赖于要安装的特定包。所以，在 onUpdate() 方法中，我测试是否安装了这个包：

```
public boolean isAppInstalled(String uri) {
    PackageManager pm = context.getPackageManager();
    boolean installed = false;
    int flags = PackageManager.GET_ACTIVITIES;
    try {
        pm.getPackageInfo(uri, flags);
        installed = true;
    } catch (PackageManager.NameNotFoundException e) {
        installed = false;
    }
    return installed;
} 
```

因此，当调用 onUpdate() 方法时，这在大多数情况下都可以正常工作。但是，我发现在 Android 4.03 中，它会在设备重新启动时错误地抛出 NameNotFoundException，也就是说，在启动时，显然小部件 onUpdate() 方法被调用为“早期”。当再次调用小部件的 onUpdate 方法时（半小时后），它会正确抛出或不抛出异常，具体取决于是否安装了包。这只发生在 Android 4.03（没有测试 Honeycomb）上，但 2.2 和 2.3 工作正常。

有什么建议么？任何解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T10:02:56.173

已安装应用程序列表仅在 PackageManager 完成扫描后才有效。内部安装的应用程序出现得很快（可能在您有时间了解差异之前），但外部安装的应用程序依赖于安装的 SD 卡，这在某些平台上可能需要很长时间。

不幸的是，PackageManger 似乎没有任何有用的事件或属性可以告诉您何时完成，因此您只能依赖代理，例如安装 SD 卡或媒体扫描仪服务何时完成。这仅比启动后的任意延迟稍微好一点，但这是我迄今为止找到的最佳答案。

# javascript - 向网页添加未预定义数量的输入框（并将其与 Google App Engine 一起使用）

> ID：10903899
> 
> 赞同：0
> 
> 时间：2012-06-05T19:47:21.173
> 
> 标签：javascript, python, html, google-app-engine

在 GAE 中，很容易设置一个带有 1 个（或任何其他预定义数量）文本输入字段的 HTML 页面，然后处理您获得的数据。我的问题是用户如何从 1 个文本框开始，然后使用按钮（如“添加更多”）添加他想要的任意数量的附加框。

我不确定这个的 HTML 实现（我认为它需要 JS，但我对这些东西几乎是菜鸟）和这个的 GAE 实现（如何编写可以接受任意数量的输入？）

非常欢迎任何一个答案；也许GAE问题甚至不是问题。一旦我正确理解了 html/js 部分，我会更容易思考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:24:47.613

答案取决于您期望的信息量。一种选择是[Expando 类](https://developers.google.com/appengine/docs/python/datastore/expandoclass)，您可以在其中根据需要添加。

或者如果您的输入足够小，则更容易实现，您可能可以使用[db.StringListProperty](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#StringListProperty)并用于`object.append(var)`在帖子中添加更多字段。

您当然需要使用 JavaScript 来创建额外的文本框。然后遍历帖子中的提交以将数据添加到任一选项。

# jquery - zClip jQuery插件在点击时复制self属性

> ID：10903905
> 
> 赞同：0
> 
> 时间：2012-06-05T19:47:59.707
> 
> 标签：jquery, zclip

我正在尝试使用 zClip jQuery 插件 (http://www.steamdev.com/zclip/#features) 并且想要复制正在单击的链接的属性。

本质上，我需要在单击时将 URL 复制到剪贴板，但它不起作用。

```
$('a.activation_copy_link').zclip({
  path: "<%= asset_path('ZeroClipboard.swf') %>",
  copy: $(this).data('link')
}); 
```

HTML 标记：

```
<a href="#" class="activation_copy_link" data-link="activation_url_here">Click to copy link</a> 
```

我知道这`$(this)`将引用 zclip 对象而不是 jQuery 对象，但我已经尝试了我能想到的一切，但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:57:59.553

```
$('a.activation_copy_link').each(function() {
  var $this = $(this);
  $(this).zclip({
  path: "<%= asset_path('ZeroClipboard.swf') %>",
  copy: $this.data('link')
});

}); 
```

# c# - 网格视图按钮

> ID：10903915
> 
> 赞同：0
> 
> 时间：2012-06-05T19:48:31.233
> 
> 标签：c#, asp.net, gridview

如果这是一个真正简单的问题，我深表歉意，但我找不到其他人可以问。我有一个带有按钮列的gridview。我正在尝试使用按钮列将文件名发送到另一个页面。我在这里从另一个解决方案中提取了此代码，但我收到一个错误：“不包含'Item'的定义”在这一行：ListViewDataItem item = (ListViewDataItem)e。**项目**；而且我不知道要使用哪个 Using-namespace （这就是它们的名字吗？）。

```
protected void gvFiles_RowCommand(object sender, System.Web.UI.WebControls.GridViewCommandEventArgs e)
{

    if (e.CommandName == "edit")
    {
        ListViewDataItem item = (ListViewDataItem)e.Item;

        int index = item.DataItemIndex;
        string fileID = ((ListView)sender).DataKeys[index]["fileID"].ToString();

        Response.Redirect("irMain.aspx?@filename=" + fileID);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:53:28.927

我想你正在处理一个gridView而不是一个ListView，那么代码应该是

```
protected void gvFiles_RowCommand(object sender, System.Web.UI.WebControls.GridViewCommandEventArgs e) 
{ 

    if (e.CommandName == "edit") 
    { 
        int index = Convert.ToInt32(e.CommandArgument);
        string fileID = ((GridView)sender).DataKeys[index]["fileID"].ToString(); 
        Response.Redirect("irMain.aspx?@filename=" + fileID); 
    } 
} 
```

# android - Android图片资源缩水

> ID：10903916
> 
> 赞同：0
> 
> 时间：2012-06-05T19:48:31.613
> 
> 标签：android, android-image

我第一次玩android sdk，试图从spritesheet（.png）中渲染一些精灵，但是当我将它导入项目时图像正在缩小 - 我正在使用的图像是 1330px 宽，但是当我运行应用程序并输出 getWidth() 它显示为 998px

这会导致错误，因为我正在尝试裁剪图像的特定区域并且它不断崩溃并出现异常`java.lang.IllegalArgumentException: x + width must be <= bitmap.width()`

谁能建议我如何处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:01:34.180

如果您将图像放在资源文件夹中，当您使用它时，它将被缩放以适应屏幕。

为避免这种情况，请将图像放在资产文件夹中并将其加载为位图，这样它就不会被缩放。

# java - 获取数字的字符代码

> ID：10903918
> 
> 赞同：1
> 
> 时间：2012-06-05T19:48:35.890
> 
> 标签：java, casting, char, int

如何获得 0 - 9 范围内整数的 char 表示？
鉴于 digit1 是该范围内的整数，
我尝试过

```
char1 = (char) digit1;
System.out.printf("%s", Character.toString(char1)); 
```

并且

```
char1 = 'digit1';  
System.out.printf("%s", Character.toString(char1)); 
```

但每次它打印一个“奇怪”的字符，而我期待相应的一位整数。

我在印刷或其他地方做错了什么吗？
提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:50:42.937

您将值`0`与 ASCII 字符混淆了`'0'`。

以下任何一项都可以：

```
System.out.printf("%d", digit);
System.out.printf("%c", digit + '0');
System.out.printf("%s", Character.toString((char)(digit + '0'))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:53:00.917

尝试：

```
 char1 = digit1 + '0'; 
```

`char1`然后包含一个表示`digit1`.

# ruby-on-rails - Rails 控制器中的循环内循环

> ID：10903919
> 
> 赞同：0
> 
> 时间：2012-06-05T19:48:37.613
> 
> 标签：ruby-on-rails, ruby

我正在尝试从我的数据库中检索所有帖子，并根据它们的创建日期按 DESC 顺序列出它们。到目前为止，我已经设法测试了属于一个类别的所有帖子，但我想显示所有帖子，无论它们属于哪个类别。我知道我必须遍历每个类别，并从每个类别中获取帖子，但我不知道如何去做。这是我的代码：

编辑：

```
 def index
    @institution = Institution.find(current_user.institution.id)
    @categories = Category.all
    @categories.each do |category|
      @posts = Post.where("category_id = ? and institution_id = ?", category, @institution).order("created_at DESC")
    end
    authorize! :read, @post
    respond_with(@posts)
  end 
```

有人可以指出我正确的方向吗？

编辑 2：我的观点（index.html.haml）

```
%h1 Listing posts

%table
  %tr
    %th Title
    %th Description
    %th User
    %th Category
    %th Type
    %th Class
    %th Institution

  - @posts.each do |post|
    %tr
      %td= post.title
      %td= post.description
      %td= post.user_id
      %td= post.category_id
      %td= post.institution_id 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T20:00:08.153

每次迭代都会覆盖 @posts。试试这个：

```
def index
    @institution = Institution.find(current_user.institution.id)
    @categories = Category.all
    @posts = []
    @categories.each do |category|
      tposts = Post.where("category_id = ? and institution_id = ?", category, @institution).order("created_at DESC")
      @posts += tposts if tposts
    end
    authorize! :read, @post
    respond_with(@posts)
end 
```

要检索具有非空 category_id 的所有帖子，请尝试以下操作：

```
def index
    @institution = Institution.find(current_user.institution.id)
    @categories = Category.all
    @posts = Post.where("category_id is not null and institution_id = ?", @institution).order("created_at DESC")
    authorize! :read, @post
    respond_with(@posts)
end 
```

更改`is not null`为`> 0`整数 category_id 或者`!= ''`如果您的表包含 '' 而不是空值。

祝你好运。

# c# - 在 C# 中生成数百页的 Word/PDF 太慢了

> ID：10903925
> 
> 赞同：2
> 
> 时间：2012-06-05T19:49:17.053
> 
> 标签：c#, pdf, ms-word

我在 C# 中生成文档时遇到速度问题。

我基本上是在尝试创建超过 600 页的文档。但是我使用的工具处理这个非常慢。

我第一次尝试使用[Novacode](http://docx.codeplex.com/)的 DocX。创建此包含 600 多页的文档最多需要 3 分钟。我了解到函数“InsertDocument”可能存在问题，因此我试图找到不同的解决方案。

我开始研究将 HTML 文档打开到 word 中。虽然这是一个快速的解决方案，但图像不会嵌入到文档中。MS Word 不支持 HTML 语法 (src="data:image/png;base64,xxxx")。

我可以使用图像的 URL，但是如果 Internet 连接断开，图像将不会显示。

然后我开始研究 HTML->PDF 解决方案。[iTextSharp](http://sourceforge.net/projects/itextsharp/)比 DocX 解决方案快一点，但仍然需要 1-2 分钟才能生成此文档。

我只是没有想法。我不确定商业产品会更好，而且我不想花那么多钱来解决同样的速度问题。

有没有人有使用 C# 创建 600 多页的 Word/PDF 文档的经验，这相当快（1-5 秒）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-12-31T06:14:35.690

您应该能够在该时间范围内创建包含 600 多页的格式丰富的 DOCX 文件，但对于 PDF 文件，我不确定……这可能取决于您的文档内容。

无论如何，我可以在几秒钟（0-4 秒）内使用[GemBox.Document](https://www.gemboxsoftware.com/document/examples/c-sharp-vb-net-word-pdf-library/801)创建一个相当大的 DOCX 文件，以及 PDF 文件，但它确实比 DOCX 输出需要更多时间。

您还可以非常快速地将[HTML 转换为 DOCX](https://www.gemboxsoftware.com/document/examples/c-sharp-convert-word-to-from-html/105)或[HTML 转换为 PDF](https://www.gemboxsoftware.com/document/examples/c-sharp-convert-word-html-to-pdf/304) ，但这可能取决于 HTML 内容本身。

如果可能的话，您应该更喜欢编写良好的 HTML 内容，即“打印机友好”、没有太多嵌套级别、优化图像、具有单个 CSS 文件等。此外，如果您提供 URL 作为输入path 那么我认为最好先嵌入 base64 图像然后链接，以避免发出额外的 Web 请求。

最后，我认为 Flat OPC XML 与 DOCX 没有太大区别。基本上它们都生成相同的内容，只是 DOCX 文件被额外压缩，这是一个可忽略的性能损失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T14:22:37.293

如果您尝试从 Web 服务器执行此操作，则应注意此过程的资源消耗，因为您可能很容易耗尽内存。

如果在某个时候你决定考虑商业图书馆，也许你可以[试试 Amyuni PDF Creator .Net](http://www.amyuni.com/en/developer/pdfcreator/features)。Amyuni PDF Creator .Net 提供“逐页”模式，在处理超长 PDF 文档时可以节省资源。这个想法是在每个页面生成后立即将其保存到输出文件中，也许在内存中保留几页以防需要修改。

查看这些链接以获取更多详细信息：

*   [保存方法](http://www.amyuni.com/WebHelp/Amyuni_PDF_Creator_for_NET/Reading_Writing_PDF_Files/Methods/IacDocument.StartSave_Method.htm)
*   [结束保存方法](http://www.amyuni.com/WebHelp/Amyuni_PDF_Creator_for_NET/Reading_Writing_PDF_Files/Methods/IacDocument.StartSave_Method.htm)
*   [处理大型 PDF 文件](http://www.amyuni.com/WebHelp/Amyuni_PDF_Creator_for_ACTIVE_X/Processing_Large_PDF_Documents/Overview.htm)

*通常的免责声明适用*

# java - Netty - 分隔 ZLib 编码数据

> ID：10903931
> 
> 赞同：1
> 
> 时间：2012-06-05T19:49:39.837
> 
> 标签：java, netty, zlib

是否有必要使用分隔符，例如`LengthFieldBasedFrameDecoder`Netty 的 ZlibDecoders？我遇到了一个问题，即解码器有时会因“未知压缩方法”而出错，当我修改管道以分隔数据时，这种情况就消失了。Zlib 编码器/解码器的 javadocs 没有按要求提及这一点，尽管它们的超类确实如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T19:26:43.400

它取决于传输协议以及如何将压缩应用于消息/帧，

*   如果仅对内容部分应用压缩，如下所示（如 http），则不需要 LengthFieldBasedFrameDecoder，因为您的解码器/编码器必须在内部使用带有 ZlibDecoder/ZlibEncoder 的 DecoderEmbedder/EncoderEmbedder。

    ```
     +-----+---------------+
      |     |               |
      | HDR |  Content      |
      |     |               |
      +-----+---------------+ 
    ```

*   如果压缩应用于整个帧并且传输协议是 TCP，则压缩帧应具有标头参数来标识消息长度以完全读取它。因此，您将需要管道中的 LengthFieldBasedFrameDecoder 和 LengthFieldPrepender

    ```
     +---------------------+       +------+-------------+
      |                     |       |      |             |
      |      Frame          | <=>   |Length| Zipped Frame|
      |                     |       |      |             |
      +---------------------+       +------+-------------+ 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T05:35:21.810

不，您不应该需要它。事实上，ZlibDecoder/ZlibEncoder 通常放置在此类处理程序的“前面”。

# c# - MVVM light Silverlight 多选列表框初始选择页面加载

> ID：10903936
> 
> 赞同：1
> 
> 时间：2012-06-05T19:50:11.920
> 
> 标签：c#, silverlight, list, mvvm-light

我正在使用 MVVM 灯，并且有一个带有多项选择的列表框。在我的 Mainpage.xaml 我有

```
<ListBox Name="ListBox1" ItemsSource="{Binding Items}" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent"  Margin="15,15,18,0" SelectionMode="Multiple" Height="100" /> 
```

在 MainPage.xaml.cs 我有（出于某种原因我不想使用依赖属性）。

```
MainPage()
{
    ListBox1.SelectionChanged = new SelectionChangedEventHandler(ListBox1_SelectionChanged);
}

void ListBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
 var listBox = sender as ListBox;
 var viewModel = listBox.DataContext as MainViewModel;
 viewModel.SelectedItems.Clear();
 foreach (string item in listBox.SelectedItems)
     viewModel.SelectedItems.Add(item);
} 
```

这可以正常工作并绑定到我的 MainViewModel。但是当页面加载时，我希望默认选择集合项目的第一项。请让我知道如何实施

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:10:52.297

我建议使用 ListBox 的`Loaded`事件，然后绑定到集合中的第一项：

```
MainPage()
{
    ListBox1.Loaded += new RoutedEventHandler( OnListBox1Loaded );
    ListBox1.SelectionChanged += new SelectionChangedEventHandler(ListBox1_SelectionChanged);
}

private void OnListBox1Loaded( object sender, RoutedEventArgs e )
{
    // make sure the selection changed event doesn't fire
    // when the selection changes
    ListBox1.SelectionChanged -= MyList_SelectionChanged;

    ListBox1.SelectedIndex = 0;
    e.Handled = true;

    // re-hook up the selection changed event.
    ListBox1.SelectionChanged += MyList_SelectionChanged;
} 
```

**编辑**

如果您不能使用该`Loaded`事件，那么您需要在模型中创建另一个属性来保存您想要选择的项目，然后将该属性分配`SelectedItem`给`ListBox`.

```
public class MyModel : INotifyPropertyChanged
{

  private ObservableCollection<SomeObject> _items;
  public ObservableCollection<SomeObject> Items
  {
    get { return _items; }
    set
    {
        _items = value;
        NotifyPropertyChanged( "Items" );
    }
  }

  private SomeObject _selected;
  public SomeObject  Selected
  {
    get { return _selected; }
    set
    {
        _selected = value;
        NotifyPropertyChanged( "Selected" );
    }
  }

  public void SomeMethodThatPopulatesItems()
  {
    // create/populate the Items collection

    Selected = Items[0];
  }

  // Implementation of INotifyPropertyChanged excluded for brevity

} 
```

**XAML**

```
<ListBox ItemsSource="{Binding Path=Items}" 
         SelectedItem="{Binding Path=Selected}"/> 
```

通过拥有另一个包含当前选定项目的属性，您还可以在模型中访问该项目，以及每当用户更改选定项目时。

# facebook - 如何使用 Facebook jsdk？

> ID：10903939
> 
> 赞同：0
> 
> 时间：2012-06-05T19:50:20.183
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我想知道在我的数据库中保存有关用户的一些信息的最佳方法是什么。

使用此代码，我得到了这些信息：

```
 FB.api({
     method: 'fql.query',
     query: 'select first_name, last_name, sex, pic from user where uid=me()'
 }, function (response) {
    // save informations
 }); 
```

但是现在，我怎样才能将这些信息放入我的数据库中？

ajax 是最好的方法吗？

或者在这种情况下我必须使用 PHP sdk 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:35:49.513

> 但是现在，我怎样才能将这些信息放入我的数据库中？

在注释“保存信息”的行中，只需将数据 AJAX 到您的网络服务器。

> ajax 是最好的方法吗？

是的，AJAX 是在 FB.api 调用完成后立即将数据返回到服务器的最佳方式。

> 或者在这种情况下我必须使用 PHP sdk 吗？

不，在这种情况下，您的代码正在客户端运行。为什么还要在服务器端复制它？没必要。请记住，您的服务器必须做的事情越少（因为您将大部分内容卸载到客户端），您的服务器性能就越好，维护服务器的成本就越低。

# c - Haskell FFI - 如何处理接受或返回结构而不是指向结构的指针的 C 函数？

> ID：10903940
> 
> 赞同：11
> 
> 时间：2012-06-05T19:50:21.833
> 
> 标签：c, haskell, ffi

当然，答案是以某种方式传递/获取一个连续的内存块，所以问题更多是关于如何做到这一点。现在我仍然可以通过在 C 端编写包装函数来避免这个问题，但这并不是一个永久的解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-05T20:24:51.900

FFI 不支持任意按值传递 Haskell 可存储类型。

您只能传递类型的值（其中一些是指针）：

```
Int#, Word#,
Char#,
Float#, Double#,
Addr#,
StablePtr# a, MutableByteArray#, ForeignObj#, and ByteArray#. 
```

因此，要传递一个结构，您必须通过 C 包装器包装调用；它接受一个指针并将其值传递给您希望实际调用的 C 函数。

最近的 GHC 扩展允许“primop”导入——它绕过 FFI 机制并支持任意调用约定和通过未装箱的元组传递结构。例如

```
foreign import prim "ITCHv41_run"
  parseITCHv41# :: Addr# -> Word#
                -> (# Int#, Word#, Word#, Word#, Word#, Word# #) 
```

你可以使用这些来做像这样[棘手的低级事情](http://breaks.for.alienz.org/blog/2012/02/09/parsing-market-data-feeds-with-ragel/)。

# sql - 修改从 READS SQL DATA 过程内部调用的 SQL DATA 过程

> ID：10903941
> 
> 赞同：0
> 
> 时间：2012-06-05T19:50:27.367
> 
> 标签：sql, inheritance, stored-procedures, db2-400

我正在尝试定义一个通用的 SQL 错误例程，该例程基本上会将所有信息转储`GET DIAGNOSTICS`到文件中。

我创建了一个获取所有这些信息的过程，当从另一个`MODIFIES SQL`. 我在获取数据的过程中也需要它。这些过程是用定义的`READS SQL DATA`，当它调用错误例程时，它会失败，因为它继承了调用者的`READ`.

我怎样才能避免这个问题。我不希望全部更改`READS SQL DATA`为，`MODIFIES SQL DATA`因为它可以打开数据进行修改，我们不希望这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T11:35:09.447

为什么不使用 RPG 或 COBOL 中的本机 I/O 将诊断数据写入文件？

# java - 使用 jdk xpath 解析带有命名空间的 xml

> ID：10903942
> 
> 赞同：1
> 
> 时间：2012-06-05T19:50:31.347
> 
> 标签：java, xml, xpath, namespaces

我在尝试使用 Xpath 解析 XML 内容时遇到了困难。XML 包含命名空间信息。我试图创建一个 NameSpaceContextImp（jdk 中 NameSpaceContext 接口的 apache WS commons 实现）来将 namaspace 前缀映射到 URI，但是无法成功查询 xml 文档。[当我在http://chris.photobooks.com/xml/default.htm](http://chris.photobooks.com/xml/default.htm)使用在线 xpath 测试工具时，我使用的 xpath 查询带有我预期的节点/元素。所以我想弄清楚我做错了什么。我正在提供 xml 文档和示例代码片段。我将不胜感激任何反馈。需要注意的是，我尝试过使用和不使用命名空间前缀的 xpath 查询。

```
NamespaceContextImpl namespaceContext = new NamespaceContextImpl();
namespaceContext.startPrefixMapping("wsp", "http://schemas.xmlsoap.org/ws/2002/12/policy");
namespaceContext.startPrefixMapping("L7p", "http://www.layer7tech.com/ws/policy");
String policyXml = "xml content that is pasted below"
InputSource inputSource = new InputSource(new StringReader(policyXml));
XPathFactory xpathFactory = XPathFactory.newInstance();
XPath xPath = xpathFactory.newXPath();
xPath.setNamespaceContext(namespaceContext);
XPathExpression xpathExpression = xPath.compile("/wsp:Policy/wsp:All");
String evaluation = xpathExpression.evaluate(inputSource);
if (evaluation.trim().length() > 0) {
    System.out.println(evaluation);
}

    <?xml version="1.0" encoding="UTF-8"?>
<wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <wsp:All wsp:Usage="Required">
        <L7p:SetVariable>
            <L7p:AssertionComment assertionComment="included">
                <L7p:Properties mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="RIGHT.COMMENT"/>
                        <L7p:value stringValue="Used to enable message logging, Null (allow MSGDEBUG Header to set level), 0 - default,1 - Medium,2 - Full"/>
                    </L7p:entry>
                </L7p:Properties>
            </L7p:AssertionComment>
            <L7p:Base64Expression stringValue=""/>
            <L7p:VariableToSet stringValue="LOCAL_POLICY_DEBUG_LEVEL"/>
        </L7p:SetVariable>
        <L7p:Include>
            <L7p:PolicyGuid stringValue="ec1f4166-4299-4e44-bf9d-c5c2a9f0c894"/>
        </L7p:Include>
        <L7p:SslAssertion>
            <L7p:Option optionValue="Optional"/>
        </L7p:SslAssertion>
        <wsp:OneOrMore L7p:Enabled="false" wsp:Usage="Required">
            <L7p:SpecificUser>
                <L7p:Enabled booleanValue="false"/>
                <L7p:IdentityProviderOid longValue="-2"/>
                <L7p:UserLogin stringValue="test"/>
                <L7p:UserName stringValue="test"/>
                <L7p:UserUid stringValue="58916874"/>
            </L7p:SpecificUser>
            <L7p:SpecificUser>
                <L7p:Enabled booleanValue="false"/>
                <L7p:IdentityProviderOid longValue="-2"/>
                <L7p:UserLogin stringValue="test"/>
                <L7p:UserName stringValue="test"/>
                <L7p:UserUid stringValue="58916873"/>
            </L7p:SpecificUser>
            <L7p:SpecificUser>
                <L7p:Enabled booleanValue="false"/>
                <L7p:IdentityProviderOid longValue="-2"/>
                <L7p:UserLogin stringValue="test"/>
                <L7p:UserName stringValue="test"/>
                <L7p:UserUid stringValue="58916876"/>
            </L7p:SpecificUser>
            <L7p:SpecificUser>
                <L7p:Enabled booleanValue="false"/>
                <L7p:IdentityProviderOid longValue="-2"/>
                <L7p:UserLogin stringValue="test"/>
                <L7p:UserName stringValue="test"/>
                <L7p:UserUid stringValue="58916875"/>
            </L7p:SpecificUser>
            <L7p:SpecificUser>
                <L7p:Enabled booleanValue="false"/>
                <L7p:IdentityProviderOid longValue="-2"/>
                <L7p:UserLogin stringValue="testengineering-user"/>
                <L7p:UserName stringValue="testengineering-user"/>
                <L7p:UserUid stringValue="48201728"/>
            </L7p:SpecificUser>
        </wsp:OneOrMore>
        <wsp:OneOrMore wsp:Usage="Required">
            <L7p:HttpRoutingAssertion>
                <L7p:ProtectedServiceUrl stringValue="http://localhost:13000/Services/Finance/v1"/>
                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                    <L7p:Rules httpPassthroughRules="included">
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="Cookie"/>
                        </L7p:item>
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="SOAPAction"/>
                        </L7p:item>
                    </L7p:Rules>
                </L7p:RequestHeaderRules>
                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                    <L7p:ForwardAll booleanValue="true"/>
                    <L7p:Rules httpPassthroughRules="included"/>
                </L7p:RequestParamRules>
                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                    <L7p:Rules httpPassthroughRules="included">
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="Set-Cookie"/>
                        </L7p:item>
                    </L7p:Rules>
                </L7p:ResponseHeaderRules>
            </L7p:HttpRoutingAssertion>
            <L7p:Include>
                <L7p:PolicyGuid stringValue="b438384e-eeb0-45c5-8a7e-d30da78f07ee"/>
            </L7p:Include>
        </wsp:OneOrMore>
    </wsp:All>
</wsp:Policy> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:41:47.043

元素下唯一的 CDATA`All`是空白，您可以对其进行修剪。如果要获取 DOM 元素，请使用[NODE](http://docs.oracle.com/javase/7/docs/api/javax/xml/xpath/XPathConstants.html#NODE)或[NODESET](http://docs.oracle.com/javase/7/docs/api/javax/xml/xpath/XPathConstants.html#NODESET) ( `NodeList`) 选项。

```
String xml = "<foo><bar baz='hello' /></foo>";
InputSource src = new InputSource(new StringReader(xml));
XPathExpression expr = XPathFactory.newInstance().newXPath()
    .compile("/foo/bar");
Node node = (Node) expr.evaluate(src, XPathConstants.NODE);

Transformer trans = TransformerFactory.newInstance().newTransformer();
trans.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
trans.transform(new DOMSource(node), new StreamResult(System.out)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:33:47.107

使用一个参数调用 evaluate() 请求将结果转换为字符串，这相当于获取请求节点的字符串值：即所选元素的文本节点后代的串联。由于所有后代文本节点都是空白，因此您将一无所获。

这一次，命名空间不是问题。

# iphone - 通过“substringToIndex”在 UserDefaults 中查找特殊键

> ID：10903945
> 
> 赞同：3
> 
> 时间：2012-06-05T19:50:36.427
> 
> 标签：iphone, objective-c, ios, xcode, nsuserdefaults

我正在按特定前缀对我的 UserDefault 键进行分组。

例如

```
[NSUserDefaults standardUserDefaults] setInteger: 1 forKey: @"prefix1_someText_Key"]
[NSUserDefaults standardUserDefaults] setInteger: 2 forKey: @"prefix2_someText_Key"]
[NSUserDefaults standardUserDefaults] setInteger: 3 forKey: @"prefix4_someText_Key"]
//..... 
```

现在，我想找到所有以“前缀”开头的键，并将它们加载到一个数组中。有没有办法做到这一点（以编程方式）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:56:58.297

您可以使用底层的 NSDictionary 来找到合适的键：

```
NSString *myPrefix = @"prefix";
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSDictionary *dict = [defaults dictionaryRepresentation];
NSMutableArray *keysWithPrefix = [NSMutableArray array]
for (NSString *key in dict.keyEnumerator) {
  if ([key hasPrefix: myPrefix]) {
    [keysWithPrefix addObject: key];
  }
}
// now keysWithPrefix contains all matching keys 
```

**更新** 出于调试原因，您可以添加日志以查看删除了哪些密钥：

```
for (NSString *key in dict.keyEnumerator) {
  if ([key hasPrefix: myPrefix]) {
    [keysWithPrefix addObject: key];
  } else {
    NSLog(@"Dropping key %@", key);
  }
} 
```

# eclipse - 如何使 #ifdef 中的颜色主题在 Eclipse 中更具可读性？

> ID：10903951
> 
> 赞同：32
> 
> 时间：2012-06-05T19:51:11.797
> 
> 标签：eclipse, color-scheme

我喜欢颜色主题（谢谢！），但一个严重困扰的问题是#ifdef'd 的代码无法阅读（并且令人讨厌的明亮）。如果我突出显示这些行，我可以阅读它，但我真的真的宁愿根本看不到它。似乎与工具提示的问题类似，但我希望在某处有一个设置可以关闭非活动代码的语法突出显示。我看过并没有找到它，但这并不一定意味着它不存在。我是一个乐观主义者（无论如何在这方面）。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-08-02T19:23:10.657

您可以通过以下方式完全禁用#ifdef 突出显示：

> 窗口 -> 首选项 -> C/C++ -> 编辑器并取消选中“突出显示非活动代码”框。

此外，您可以通过转到同一屏幕并将“非活动代码突出显示”颜色（在“外观颜色选项”标题下）更改为更适合您的颜色来更改 #ifdef 突出显示颜色。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-09-24T11:10:30.317

Window -> Preferences -> C/C++ -> Editor -> Appearance code options -> Inactive code highlight 选择另一种颜色。我更喜欢灰色。

我还建议更改出现背景：General -> Editors-> Text Editors -> Annotations -> C/C++ Occurrences

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-14T21:27:15.537

我发现了这个：[https ://github.com/eclipse-color-theme/eclipse-color-theme/issues/35](https://github.com/eclipse-color-theme/eclipse-color-theme/issues/35)

“首选项 -> C/C++ -> 编辑器，选中“突出显示非活动代码”，外观颜色选项：非活动代码突出显示。”

这将关闭代码非活动部分的突出显示，使它们再次可读。我还没有找到改变突出显示颜色的方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-05T20:08:31.897

好吧，我找到了部分答案：

首选项 -> C/C++ -> 编辑器 -> 语法高亮 -> 预处理器 -> 指令将前景色更改为黑色。

首选项 -> C/C++ -> 编辑器 -> 语法高亮 -> 预处理器 -> 其他将前景色更改为黑色

首选项 -> C/C++ -> 编辑器 -> 语法高亮 -> 代码 -> 其他将前景色更改为黑色。

至少现在我可以看到它。任何人都知道如何/在哪里更改这些块的背景颜色？

谢谢！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-01-03T11:46:22.090

我也在寻找写事件的背景。我建议大家在以下位置也将*“测试为”*更改为*“虚线框”*：首选项 -> 常规 -> 编辑器 -> 文本编辑器 -> 注释 -> C/C+ 写入事件

# c++ - 如何将对象*作为 void*& 传递？

> ID：10903952
> 
> 赞同：0
> 
> 时间：2012-06-05T19:51:16.143
> 
> 标签：c++, void, void-pointers

我有以下代码：

```
void testCopy(){
   Balloon* b1=new Balloon(1,5,6,3);
   Balloon* b2=new Ballon(2,4,4,2);
   cpyBallon(b1,b2);
   assert(b1->getCenterx()==5);
   cout<<" cpyBalloon() OK!\n";
} 
```

cpyBalloon() 的代码是

```
void cpyBalloon(TCE& dest,TCE src){
    Balloon* b=(Balloon*) src;
    Balloon* d=new Balloon();
    *d=*b;
    dest=d;
} 
```

其中 TCE if 类型为 void*。问题是我不知道如何将Balloon* 类型的对象b2 作为void*& 传递。我不断收到以下错误：

```
 ..\src\/Domain/BalloonTest.h:68:18: error: invalid initialization of reference of type 'void*& {aka void*&}' from expression of type 'domain::Balloon*'
    ..\src\/Domain/Balloon.h:102:10: error: in passing argument 1 of 'void domain::delBalloon(void*&)' 
```

我知道 b2 是我遇到问题的论点，但我不知道该怎么做才能使它起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:45:19.847

正如您的代码所述，您有一个 Balloon 类。您已经为两个 Balloon 实例动态分配了内存并调用了它们的构造函数，用各自的数据填充它们。然后，您将每个对象的地址存储到适当的原始指针中。

这种类型定义：

```
typedef void* TCE; // why? 
```

是没有意义的。`void*`对( )的引用`void*&`也是没有意义的。为什么？因为`void*`只保存一个值 - 字节流的第一个字节（当您将任何内容解释为 时`void*`，它们的计数会丢失，这是因为计数与类型相关）。所以，它已经是一个指针。您没有传递整个字节流，只是第一个字节的地址。然后您可以根据需要在函数中进一步解释它。

但在这种情况下，没有必要这样解释。当从非常低的级别分析时，引用只是变相的指针，使我们能够安全地获得指针的好处（无需过多考虑）。还有更多，但就目前而言，这很重要。

您可以：

1.  在堆栈上（本地）创建实例并将其作为引用传递。
2.  在堆上创建实例并获取内存地址，将它们传入并进一步处理。
3.  或者...您可以采取行动 2 并将它们转换为`void*`，然后撤消函数中的转换（无论这样做有什么好处）。

先观察：

```
 Balloon b1(1,5,6,3);
    Balloon b2(2,4,4,2);

    cpyBalloon(b1, b2);

    void cpyBalloon(Balloon& dest, const Balloon& src) 
    {
        dest = src; // invokes the assignment copy operator (imp. generated)
    } 
```

观察二：

```
 Balloon* b1 = new Balloon(1,5,6,3);
    Balloon* b2 = new Balloon(2,4,4,2);

    cpyBalloon(b1, b2);

    void cpyBalloon(Balloon* dest, const Balloon* src) 
    {
        *dest = *src; // invokes the assignment copy operator (imp. generated)
    } 
```

观察第三个（亲爱的主……）：

```
 Balloon* b1 = new Balloon(1,5,6,3);
    Balloon* b2 = new Balloon(2,4,4,2);

    cpyBalloon((void*)b1, (void*)b2);

    void cpyBalloon(void* dest, const Balloon* src) 
    {
        *(Balloon*)dest = *(const Balloon*)src; // oh god...
    } 
```

您还可以 reinterpet_cast 绕过所有编译器对类型检查的帮助，这是非常危险的，如果您必须使用它，那么您要么非常错误，要么遇到了一个非常讨厌的问题（这可能源于您的方法*非常错误*）。请注意`const`源周围的情况，当您想要复制和完好无损的东西时，这是一种很好的做法。

另请注意，在这些情况下会出现很多内存管理，这只是一个简单的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:23:04.247

您不能将 type 的左值`T*`（其中`T`is not `void`）作为 type 的参数传递`void *&`。这是语言不允许的。仅仅因为任何数据指针类型都可以转换为`void *`并不意味着任何数据指针类型都可以转换为`void *&`。这些是完全不同的东西。

如果你真的想这样做，你必须`void *&`通过使用强制转换为`reinterpret_cast`. 但是，您似乎试图执行的操作并没有多大意义。即使您的代码可能*被迫*通过使用“工作” `reinterpret_cast`，它仍然是一个黑客。

# objective-c - 滚动视图和访问其子视图的问题

> ID：10903955
> 
> 赞同：0
> 
> 时间：2012-06-05T19:51:21.300
> 
> 标签：objective-c, ios5

我有一个滚动视图，其中包含大小为 68x78 的图像视图：

![在此处输入图像描述](../Images/9a796607dcbe8aa885bb3be8b8912d16.png)

如您所见，除了居中的图像之外，所有图像都有阴影。当用户滚动时它会改变，中心图像总是清晰的。它非常完美，直到左边缘图像：

![在此处输入图像描述](../Images/1c9d571d9502e462656b3989be73bd3e.png)

这是代码：

```
-(void) buildSlideView{

    fotosJugadores = [[NSArray alloc] initWithObjects:@"cara5.png", @"cara7.png", @"cara8.png", @"cara9.png", @"cara11.png", @"cara13.png", @"cara14.png", @"cara15.png", @"cara18.png",@"cara19.png", @"cara20.png", @"cara32.png",@"cara44.png",@"cara51.png", @"cara100.png", @"cara101.png", @"cara102.png",@"cara103.png", @"cara104.png", @"cara105.png",@"cara106.png",@"cara107.png", nil];

    numberOfViews = [fotosJugadores count];

    for (int i = 0; i <    [fotosJugadores count]; i++) {

        UIImage *myImage = [UIImage imageNamed:[fotosJugadores objectAtIndex:i]];
        CGFloat yOrigin = i * (myImage.size.width+3) + 120;
        UIImageView *awesomeView = [[UIImageView alloc] initWithFrame:CGRectMake(yOrigin, 0, myImage.size.width, myImage.size.height)];
        awesomeView.tag = i;
        awesomeView.image = myImage;
        awesomeView.alpha = 0.5f;
        awesomeView.backgroundColor = [UIColor blackColor];
        [self.jugadorSlide addSubview:awesomeView];
        awesomeView=nil;

    }

    [jugadorSlide setBackgroundColor:[UIColor blackColor]];
    jugadorSlide.contentSize = CGSizeMake(68 * numberOfViews+240,78);
    jugadorSlide.layer.cornerRadius = 11;
    jugadorSlide.layer.masksToBounds = YES;
    [jugadorSlide setContentOffset:CGPointMake(((68 * numberOfViews)/2), 0)];
    //jugadorSlide.decelerationRate = UIScrollViewDecelerationRateNormal;
    [self scrollViewDidEndDragging:jugadorSlide willDecelerate:NO];

}

- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate {
    currentIndex = roundf(scrollView.contentOffset.x / 68);
    NSLog(@"current end %d", currentIndex);
    UIImageView *currentImage = [scrollView viewWithTag:currentIndex];
    if (currentIndex>0&&currentIndex<=21){
         if (currentIndex==currentImage.tag){
            currentImage.alpha=1.0f;
            [self changePerfilImage:currentImage.tag];}
             CGPoint pointZero= CGPointMake(scrollView.contentOffset.x, currentImage.frame.origin.y);
            [jugadorSlide setContentOffset:pointZero animated:YES];

    }else {
            UIImageView *currentImage = [scrollView viewWithTag:0];
            NSLog(@"end dragging image tag %d", currentImage.tag);
            currentImage.alpha=1.0f;
            [self changePerfilImage:currentImage.tag];}
            CGPoint pointZero= CGPointMake(currentImage.frame.origin.x+15, 0);
            //[jugadorSlide setContentOffset:pointZero animated:YES];

} 
```

如您所见，在 scrollViewDidEndDragging: "else" 中，我强制将标签作为绝望的解决方案，但图像并不清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:22:47.430

您正在将标签增加两次...

```
awesomeView.tag = i++; 
```

应该只是：

```
awesomeView.tag = i+1; 
```

我使用 i+1 是因为我从不使用标记 0，因为任何未分配标记的子视图都将具有标记 0。

```
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate {
    NSInteger currentIndex = roundf(scrollView.contentOffset.x / 68.0) + 1;
    UIImageView *currentImage = [scrollView viewWithTag:currentIndex];
    ...
} 
```

如果这不起作用，您应该在每次登陆新图像时 NSLog currentIndex 并查看当您登陆第一个图像时发生了什么。

# eclipse - Eclipse 不会识别和验证 JSP 标记目录属性

> ID：10903956
> 
> 赞同：2
> 
> 时间：2012-06-05T19:51:24.937
> 
> 标签：eclipse, jsp, taglib

我目前正在使用 Spring Source Tools 2.9.1 - 但我在使用标准 Eclipse J2EE 发行版时遇到了同样的问题。

我正在用 jsp 视图编写 java web 应用程序。

为了更好地重用代码，我创建了一些标签 -`*.tag`文件`WEB-INF\tags`夹中的文件

文件示例`enum.tag`：

```
<jsp:root version="2.0" 
    xmlns:form="http://www.springframework.org/tags/form" 
    xmlns:jsp="http://java.sun.com/JSP/Page"
    xmlns:spring="http://www.springframework.org/tags"
    xmlns:tags="urn:jsptagdir:/WEB-INF/tags"
    xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
    xmlns:c="http://java.sun.com/jsp/jstl/core">

    <jsp:directive.tag pageEncoding="UTF-8" />

    <jsp:directive.attribute name="value" required="true" rtexprvalue="true" type="Object" />
    <jsp:directive.attribute name="cssClass" required="false" rtexprvalue="true" />

    <span class="enum ${value.cssClass} ${cssClass}"> 
        <span class="message"> 
            <spring:message code="${value.name}" />
        </span>
    </span>

</jsp:root> 
```

如果我在我的 jsp 中使用此标签，则该标签会被验证器识别，但标签属性不会。

所以我收到这行jsp的警告

```
<tags:enum value="${t.state}" /> 
```

警告：

```
Undefined attribute name "value" 
```

标签 nemaspace 初始化为：

```
xmlns:tags="urn:jsptagdir:/WEB-INF/tags 
```

如何设置 Eclipse 以正确验证 tagdir 的标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:19:35.657

我使用 jsps 的 XML 版本（和标签）——所有的文件都是有效的 XML 文档，它使用类似的语法

```
<jsp:directive.tag pageEncoding="UTF-8" body-content="scriptless" />

<jsp:directive.attribute name="caption" required="false" rtexprvalue="true" />
<jsp:directive.attribute name="labelInfix" required="false" rtexprvalue="true" /> 
```

我现在意识到并检查了我需要使用 tagx 扩展（与 jspx 一起）。通过此更改，Eclispe 验证运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-13T00:00:18.280

是的，在撰写本文时，使用 Eclipse Luna，Eclipse 对 JAR 中的自定义标签（Oracle 称为“打包标签文件”）的 JSP 标签验证仍然很糟糕。我有两个 Java 项目，一个包含有我的 .tags 和 TLD（TLD 有元素）的 JAR。我设法让 JSP 标记验证`<t:customTag />`工作，但 Eclipse 仍然将黄色的所有属性标记为“未定义的属性名称”。

我能够通过以下方式在我的依赖项目中进行标签验证：

1.  将标签项目添加到构建路径->项目->“构建路径上的所需项目”
2.  在我的 JAR/tag 项目本身中，在 Java build path->Order and export 下，我将 JAR 文件本身标记为已导出。

# ios - 从 URL iOS 获取文件列表

> ID：10903957
> 
> 赞同：0
> 
> 时间：2012-06-05T19:51:33.637
> 
> 标签：ios, file, url

我正在开发一个应用程序，该应用程序现在必须在线访问 URL 并读取文件夹中的所有文件名并将它们放入应用程序进行解析。如何在 iOS 中实现这一点？我查看了 NSURLConnection 并没有找到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T22:26:18.993

这样做的唯一方法是服务器端脚本！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:47:09.890

您在寻找的 NSURLConnection 中没有找到什么？

这将是使用 HTTP 下载文件的一种标准方式。

你*可以*这样做，但它是同步的。

```
NSData *urlData = [NSData dataWithContentsOfURL:url]; 
```

# iphone - 使用 DYRateView 的多个评分栏

> ID：10903958
> 
> 赞同：2
> 
> 时间：2012-06-05T19:51:37.973
> 
> 标签：iphone, ios

我有一个视图，上面有 3 个评级栏。

如何在代码中区分它们？现在，如果我更改最上面的一个，它会很好看，但是如果我随后更改其中一个或另外两个，它就无法将它们彼此分开。

代码来自 git [https://github.com/dyang/DYRateView](https://github.com/dyang/DYRateView)

```
- (void)changedToNewRate:(NSNumber *)rate {
    NSString *rating = [NSString stringWithFormat:@"Rate: %d", rate.intValue];
    NSLog(@"rating: %@",rating);
} 
```

这是看到变化的地方。

这是 .m 文件

```
#import "Survey.h"

@implementation Survey

@synthesize btnSubmit;

- (void)setUpEditableRateView {
    DYRateView *rateService = [[DYRateView alloc] initWithFrame:CGRectMake(0, 55, self.view.bounds.size.width, 40) fullStar:[UIImage imageNamed:@"StarFullLarge@2x.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge@2x.png"]];
    rateService.padding = 20;
    rateService.alignment = RateViewAlignmentCenter;
    rateService.editable = YES;
    rateService.delegate =self;
    [scroller addSubview:rateService];
    [rateService release];

    DYRateView *rateFood = [[DYRateView alloc] initWithFrame:CGRectMake(0, 130, self.view.bounds.size.width, 40) fullStar:[UIImage imageNamed:@"StarFullLarge@2x.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge@2x.png"]];
    rateFood.padding = 20;
    rateFood.alignment = RateViewAlignmentCenter;
    rateFood.editable = YES;
    rateFood.delegate = self;
   [scroller addSubview:rateFood];
   [rateFood release];

  DYRateView *rateCleanliness = [[DYRateView alloc] initWithFrame:CGRectMake(0, 200, self.view.bounds.size.width, 40) fullStar:[UIImage imageNamed:@"StarFullLarge@2x.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge@2x.png"]];
   rateCleanliness.padding = 20;
   rateCleanliness.alignment = RateViewAlignmentCenter;
   rateCleanliness.editable = YES;
   rateCleanliness.delegate = self;
   [scroller addSubview:rateCleanliness];
   [rateCleanliness release];
}

- (BOOL)textFieldShouldReturn:(UITextField *)textField
{

   [textField resignFirstResponder];
   return YES;
}

- (void)changedToNewRate:(NSNumber *)rate {
    NSString *rating = [NSString stringWithFormat:@"Rate: %d", rate.intValue];
    NSLog(@"rating: %@",rating);
}

- (IBAction)btnSubmit:(id)sender{

}

-(IBAction)mainMenu{

[self dismissModalViewControllerAnimated:YES];   
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    [scroller setScrollEnabled:YES];
    [scroller setContentSize:CGSizeMake(320, 600)];
    scroller.BackgroundColor = [UIColor clearColor];

    [self setUpEditableRateView];

    [btnSubmit useGreenConfirmStyle];
 }

 - (void)viewDidUnload
 {
    [super viewDidUnload];
     // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
 }

 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
 {
     // Return YES for supported orientations
     return (interfaceOrientation == UIInterfaceOrientationPortrait);
 }

 @end 
```

**更新**

好的新代码我添加了一个 if 语句

```
- (void)rateView:(DYRateView *)rateView changedToNewRate:(NSNumber *)rate {
    NSString *barName = [NSString stringWithFormat:@"%@", rateView];
    if (barName == @"rateView1") {
        NSString *bar1 = [NSString stringWithFormat:@"Rate: %d", rate.intValue];
        NSLog(@"bar 1: %@",bar1);
    }else if(barName == @"rateView2"){
        NSString *bar2 = [NSString stringWithFormat:@"Rate: %d", rate.intValue];
        NSLog(@"bar 2: %@",bar2);
    }else{
       NSLog(@"NO BAR: %@",barName);
    } 
  self.rateLabel.text = [NSString stringWithFormat:@"Rate: %d", rate.intValue];

  } 
```

但是它可以工作而不是返回“rateView1”或2或3。我回来了

```
 NO BAR: <DYRateView: 0x78229b0; frame = (0 40; 320 20); opaque = NO; layer =
 <CALayer:0x7824900>> 
```

这本质上是正确的，但我希望使用 rateView 的名称，例如“rateView1”

**解决方案：**

在 .h 文件中@property 你的 2 或 3 条

```
@property(nonatomic, retain) DYRateView *rateView1,*rateView2; 
```

在 .m @synthesize 他们

```
@synthesize rateView1;
@synthesize rateView2; 
```

然后

```
(void)setUpEditableRateView {
    rateView1 = [[DYRateView alloc] initWithFrame:CGRectMake(0, 40, self.view.bounds.size.width, 20) fullStar:[UIImage imageNamed:@"StarFullLarge.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge.png"]];
    rateView1.padding = 20;
    rateView1.alignment = RateViewAlignmentCenter;
    rateView1.editable = YES;
    rateView1.delegate = self;
    [self.view addSubview:rateView1];
    [rateView1 release];

    rateView2 = [[DYRateView alloc] initWithFrame:CGRectMake(0, 100, self.view.bounds.size.width, 20) fullStar:[UIImage imageNamed:@"StarFullLarge.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge.png"]];
    rateView2.padding = 20;
    rateView2.alignment = RateViewAlignmentCenter;
    rateView2.editable = YES;
    rateView2.delegate = self;
    [self.view addSubview:rateView2];
    [rateView2 release];

    // Set up a label view to display rate
    self.rateLabel = [[[UILabel alloc] initWithFrame:CGRectMake(0, 80, self.view.bounds.size.width, 20)] autorelease];
    self.rateLabel.textAlignment = UITextAlignmentCenter;
    self.rateLabel.text = @"Tap above to rate";
    [self.view addSubview:self.rateLabel];
} 
```

然后最后

```
- (void)rateView:(DYRateView *)rateView changedToNewRate:(NSNumber *)rate {

    if (rateView == rateView1) {
        NSString *bar1 = [NSString stringWithFormat:@"Rate: %d", rate.intValue];
        NSLog(@"bar 1: %@",bar1);
    }else if(rateView == rateView2){
        NSString *bar2 = [NSString stringWithFormat:@"Rate: %d", rate.intValue];
        NSLog(@"bar 2: %@",bar2);
    }else{
        NSLog(@"NO BAR: %@",rateView);
    }     
    self.rateLabel.text = [NSString stringWithFormat:@"Rate: %d", rate.intValue];   
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T21:35:32.763

感谢您使用 DYRateView！

当前版本的 DYRateView 不支持同时监听多个实例，但这并不意味着我们不能这样做。:)

如果您不介意更新源代码，您可以`notifyDelegate`在 DYRateView.m 中找到一个名为的方法，并将其更改`[self.delegate performSelector:@selector(changedToNewRate:) withObject:[NSNumber numberWithFloat:self.rate]]`为`[self.delegate performSelector:@selector(rateView:changedToNewRate:) withObject:self withObject:[NSNumber numberWithFloat:self.rate]]`. 通过这种方式，您可以将 rateView 本身作为参数传递给它的侦听器。

我还没有尝试过上面的代码，因为此时我无法访问我的 Mac，但我认为这应该让您了解如何实现您的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T20:54:28.200

我只是为每个评分视图设置标签以区分它们，因此在您的示例中，我为每个评分添加一个标签：

```
#define serviceTag 1
#define foodTag 2
#define cleanlinessTag 3

- (void)setUpEditableRateView {
       DYRateView *rateService = [[DYRateView alloc] initWithFrame:CGRectMake(0, 55, self.view.bounds.size.width, 40) fullStar:[UIImage imageNamed:@"StarFullLarge@2x.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge@2x.png"]];
       rateService.padding = 20;
       rateService.alignment = RateViewAlignmentCenter;
       rateService.editable = YES;
       rateService.tag = serviceTag;
       rateService.delegate =self;
       [scroller addSubview:rateService];
       [rateService release];

       DYRateView *rateFood = [[DYRateView alloc] initWithFrame:CGRectMake(0, 130, self.view.bounds.size.width, 40) fullStar:[UIImage imageNamed:@"StarFullLarge@2x.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge@2x.png"]];
       rateFood.padding = 20;
       rateFood.alignment = RateViewAlignmentCenter;
       rateFood.editable = YES;
       rateFood.tag = foodTag;
       rateFood.delegate = self;
       [scroller addSubview:rateFood];
       [rateFood release];

       DYRateView *rateCleanliness = [[DYRateView alloc] initWithFrame:CGRectMake(0, 200, self.view.bounds.size.width, 40) fullStar:[UIImage imageNamed:@"StarFullLarge@2x.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge@2x.png"]];
       rateCleanliness.padding = 20;
       rateCleanliness.alignment = RateViewAlignmentCenter;
       rateCleanliness.editable = YES;
       rateCleanliness.delegate = self;
       rateCleanliness.tag = cleanlinessTag;
       [scroller addSubview:rateCleanliness];
       [rateCleanliness release];
    } 
```

然后，在委托方法中，您可以只检查标签：

```
- (void)rateView:(DYRateView *)rateView changedToNewRate:(NSNumber *)rate {
    switch (rateView.tag) {
        case foodTag:
           // Do something for food
           break;
        case serviceTag:
           // Do something for service
           break;
        case cleanlinessTag:
           // Do something for cleanliness
           break;
        default:
           break;
    }

  } 
```

# database - 双向关系是否适用于引用表？

> ID：10903961
> 
> 赞同：0
> 
> 时间：2012-06-05T19:51:58.753
> 
> 标签：database, database-design, relationship

如果这是一个愚蠢的问题，请原谅，但我是关系数据库的新手，似乎找不到答案（可能是因为其他人都已经知道答案）。

我存储的测试数据可能包括各种格式的时间，这些格式略有不同（TAI、UTC、GPS 等）。我不确定我是否想在输入之前强制将时间转换为任意一致的格式（或者这可能是最好的方法？），但假设我可以保持灵活性，我计划使用参考表（查找表) 的时间类型如下：

```
ref_time_types
--------------
id (PK)
desc (UTC, GPS, TAI, etc) 
```

我还会有一个表格来存储实际时间：

```
tbl_time
-------------
id (PK)
ref_time_types.id (FK)
seconds
year
.
.
. 
```

我的问题是我确定非常基本。我应该在这些之间建立双向关系，还是从 tbl_time 到 ref_time_types 建立单向多对一关系？例如，我想不出任何理由想要找到所有 UTC 时间。这是是否建立双向关系的指导原则吗？在引用表的关系方面是否有任何最佳实践？

如果这有什么不同，我正在使用 python、sqlalchemy 和 sqlite。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:30:49.023

你真的需要*保留*格式吗？

1.  如果不是，则不要将其存储在数据库中。数据库用于存储数据，它不应该关心数据在 UI 中的表示方式。所以，我建议你在 UI 中处理你想要的输入（如果这意味着多种格式，那就这样吧），但在将其存储到数据库之前将其转换为一致的格式并完全摆脱它`ref_time_types`。
2.  如果是，那么继续存储格式，但我仍然会使用日期/时间本身的一致表示，因为它在查询时需要更少的转换（您只需要转换查询的输入条件，而不是与所需格式不匹配的所有行）。

此外，请使用 DBMS 支持的日期/时间类型 - 我没有看到将各种日期/时间组件拆分为单独字段的特殊原因，*除非*您真的想查询这些单独的组件（并希望对它们进行索引）。

> 我应该在这些之间建立双向关系，还是从 tbl_time 到 ref_time_types 建立单向多对一关系？

如上所述，在第一种情况下您不需要任何关系（因为只有一个表）。在第二种情况下，关系将是多对一的。

# google-apps-script - 使用 radioButton() 时的奇怪行为

> ID：10903963
> 
> 赞同：0
> 
> 时间：2012-06-05T19:52:00.857
> 
> 标签：google-apps-script

下面的代码让我有些头疼。这是一个非常简单的应用程序，有 2 个单选按钮和一个按钮。这个应用程序的想法是在电子表格中记录所选单选按钮的值。现在，如果我选择第一个单选按钮（“one”），然后更改为第二个单选按钮（“two”），然后返回“one”并单击“录制”按钮，应用程序将在电子表格。它有点累积选择。

不知道我是否说清楚了，但这里是模拟问题的步骤：

1-运行下面的应用程序；2-选择单选按钮“一”，然后再次选择“二”和“一”，然后按“记录”按钮；3- 检查电子表格中的重复值。

您单击单选按钮的次数越多，将记录的重复值越多。

知道为什么会发生这种情况，我该如何克服这个问题？

```
function myAppFunction() {
var mydoc = SpreadsheetApp.getActiveSpreadsheet();
var app = UiApp.createApplication().setTitle('Here is the title bar'); 
var panel = app.createVerticalPanel().setId('panel');

//using setName will give you the ability to get the value  
var myRadio1 = app.createRadioButton("group","one").setName('myRadio1').setId('myRadio1');
var myRadio2 = app.createRadioButton("group","two").setName('myRadio2').setId('myRadio2');
var button = app.createButton("Gravar").setId("record_");
//A label will be used to give feedback on the value of the checkBox 
var infoLabel = app.createLabel('Check the box and click submit').setId('infoLabel');

//handlers 
var handler = app.createServerChangeHandler('radio1');
handler.addCallbackElement(panel);  
myRadio1.addClickHandler(handler);

var handler2 = app.createServerChangeHandler('radio2');
handler2.addCallbackElement(panel);  
myRadio2.addClickHandler(handler2);

//put everything in the UI 
panel.add(myRadio1);      
panel.add(myRadio2); 
panel.add(button);
panel.add(infoLabel);

app.add(panel);  
mydoc.show(app);  
}
function radio1(e){
var app = UiApp.getActiveApplication(); 
app.getElementById('myRadio2').setValue(false);
app.getElementById('infoLabel').setText('one is: ' + e.parameter.myRadio1);
var panel = app.getElementById("panel");
var button = app.getElementById("gravar");
var handler = app.createServerClickHandler("record_");
handler.addCallbackElement(panel);
button.addClickHandler(handler);
return app;
}

function radio2(e){
var app = UiApp.getActiveApplication(); 
app.getElementById('myRadio1').setValue(false);
app.getElementById('infoLabel').setText('two is: ' + e.parameter.myRadio2); 
var button = app.getElementById("gravar");
var handler = app.createServerClickHandler("gravar_");
handler.addCallbackElement(app.getElementById("panel"));
button.addClickHandler(handler);

return app;
}
function record_(e) {
var ss = SpreadsheetApp.getActiveSpreadsheet();
var sheet = ss.getSheetByName("Sheet1");
var lastRow = sheet.getLastRow();
var freeCell = sheet.getRange("A1").offset(lastRow, 0);
freeCell.setValue(e.parameter.myRadio1);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T09:09:21.950

我不了解您的代码的行为，但我认为它不合适且过于复杂。

首先，您创建两个单选按钮，将它们的名称设置为“组”，这是正确的，但在创建后立即分别用“myRadio1”和“myRadio1”覆盖它们的名称，这不是错误但没有用，因为它迫使你将服务器更改处理程序添加到每个单选按钮。

如果您将两个单选按钮保留为相同名称“组”，则当您单击它们时，它们将自动切换到彼此。因此，您不需要向它们添加点击处理程序。

因为它们共享相同的名称：“group”，您将能够使用“e.parameter.group”参数访问它们的状态（如果选择了第一个单选按钮，则为“false”，如果选择了第二个单选按钮，则为“true”）验证按钮的点击处理程序的回调函数。

这是您的代码简化和固定：

```
function myAppFunction() {
  var mydoc = SpreadsheetApp.getActiveSpreadsheet();
  var app = UiApp.createApplication().setTitle('Here is the title bar'); 
  var panel = app.createVerticalPanel().setId('panel');

  // Create the radio buttons and add it to the panel
  var myRadio1 = app.createRadioButton("group","one");
  var myRadio2 = app.createRadioButton("group","two");
  panel.add(myRadio1);      
  panel.add(myRadio2); 

  // Create the apply button, add click handler and add it to the panel
  var button = app.createButton("Gravar").addClickHandler(app.createServerHandler("record_").addCallbackElement(panel));
  panel.add(button);

  // Create the label and add it to panel
  var infoLabel = app.createLabel('Check the box and click submit');
  panel.add(infoLabel);

  // Add the panel in the GUI
  app.add(panel);

  // Show the GUI in the spreadsheet
  mydoc.show(app);
}

function record_(e) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName("Sheet1");
  var lastRow = sheet.getLastRow();
  var freeCell = sheet.getRange("A1").offset(lastRow, 0);
  freeCell.setValue(e.parameter.group);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:04:08.733

单选按钮必须具有相同的名称才能在正常的异或模式下工作，如果您参考[文档](https://developers.google.com/apps-script/class_radiobutton)，您会注意到在标准面板中使用时这是必需的。这是一个简单的例子：

```
function radiotest() {
  var app = UiApp.createApplication();
  var panel = app.createVerticalPanel();
  var radioValue = app.createTextBox();
      radioValue.setId("radioValue").setName("radioValue").setVisible(false);
  for(var i = 1; i < 10; i++){
    var name = 'choice '+i;
    var handler = app.createClientHandler().forTargets(radioValue).setText(name);
    panel.add(app.createRadioButton('radio',name).addValueChangeHandler(handler));
  }
  panel.add(radioValue);
  var getit=app.createButton("Valide").setId("val");
  panel.add(getit)                   
  var handler = app.createServerHandler("valide")
  handler.addCallbackElement(panel)
  getit.addClickHandler(handler);
  app.add(panel);
SpreadsheetApp.getActiveSpreadsheet().show(app);// show app 
}
//
function valide(e){ ;// This function is called when key "validate" is pressed 
  var sh = SpreadsheetApp.getActiveSheet();
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var RadioButton = e.parameter.radioValue;               
  sh.getRange('A1').setValue(RadioButton);
  var app = UiApp.getActiveApplication();
  return app;
}​ 
```

# c - C To MIPS - 翻译一个简单的代码

> ID：10903965
> 
> 赞同：0
> 
> 时间：2012-06-05T19:52:10.857
> 
> 标签：c, mips

```
int i;
void set_array(int num) {
    for (i=0; i<10;i++) {
        A[i] = compare(num,i);
    }
}

int compare (int a, int b) {
    if ((a-b) >= 0)
        return 1;
    else return 0
} 
```

在这里遇到一些问题。

我的主要问题是：如何将 compare(num,i) 插入 A[i]？

顺便说一句，我在这方面完全是初学者，很抱歉，如果这似乎太容易被问到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T05:34:21.980

这是一个多步骤的过程。第一部分是将参数传递给比较并调用它。比较完成后，它将返回一个值。您将存储在 A[i] 中的正是这个返回值。

你可以把它想象成：

```
int temp = compare(num,i);
A[i] = temp; 
```

其中 temp 只不过是 $v0 （返回值）。

A[i] 的内存位置是 A 的地址 + i * A 的元素的大小。对于这个答案，由于您没有真正指定 A 的类型，我假设它是一个 int 数组。此外，我还假设您的 MIPS 机器上的 int 是 4 字节（或一个字）。

考虑到这一点，A[0] 是 A + 0 的地址。A[1] 是 A + 4 的地址。A[2] 是 A + 8 的地址。等等。

粗略的大纲是：

```
set_array:
    # save $ra to stack
    la      $s1, A         # assuming $s1 isn't used for anything
    # loop code starts here
                           # A[i] = compare(num,i);
    move    $a0, $a0       # num (Here for completeness, it does nothing)
    move    $a1, $s0       # I am just assuming variable 'i' is in $s0
    jal     compare        # call compare
    sw      $v0, 0($s1)    # store the return value in A+4*i
    addiu   $s1, $s1, 4    # inc it by 4, for the next element
    # i = i + 1
    # jump back up
    # restore $ra
    jr      $ra

# ...

compare:
    # code to compare and
    # return 1 or 0 in $v0
    jr      $ra 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T20:05:01.600

在 C 中，您不能“插入”值。首先，您必须使用任一声明 [global] 表 A

```
int A[10]; 
```

假设 10 是大小，基于`for`循环限制，或

```
int *A; 
```

然后在代码中的其他地方：

```
A = malloc (10 * sizeof *A); 
```

所以你将有一个空间分配给 10 个元素。然后你可以设置每个元素的 wa 值（就像你做`compare()`赋值一样）。

# php - 将简单循环的迭代次数增加 1 会显着增加执行时间

> ID：10903970
> 
> 赞同：4
> 
> 时间：2012-06-05T19:52:29.763
> 
> 标签：php, apache, microtime

我需要一些帮助来弄清楚网络服务器关于执行时间的情况。当服务器返回的字符数超过 ~41000 - 大约 40KB 时，我注意到了一个问题。

所以我做了一个脚本：

```
<?php
    $php_start_time = MICROTIME(TRUE);
    echo $_GET['i'].':';
    for($i=0;$i<=$_GET['i'];$i++) { echo 'a'; }
    echo '<br>runtime: '.(MICROTIME(TRUE) - $php_start_time);
?> 
```

我尝试了，每个浏览器超过 10 次，多个浏览器：

当 $_GET['i']=40952 我得到大约**0.013...ms**

当 $_GET['i']=40953 我得到大约**0.679...ms**

仅一个字符的差异为 0.666？

在尝试从不同位置（在线代理）获取页面结果时，我看到运行时有很大不同。

所以我想这与距离有关。我在欧盟，服务器在美国。

在我找到解决此问题的方法之前，该脚本可在以下位置获得：[http ://selfreveal.com/speed_test_1.php?i=40953](http://selfreveal.com/speed_test_1.php?i=40953)

还有一个 phpinfo()：[http ://selfreveal.com/phpinfo.php](http://selfreveal.com/phpinfo.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:22:11.003

您可以尝试在重新测试`flush();`后立即添加吗？您也可以尝试使用并确保它不是一些内部缓冲区（取决于操作系统）或任何东西`echo 'a';`
`ob_start()``ob_flush()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:57:53.510

我的第一个猜测是您遇到了内存限制并且垃圾收集器正在启动。尝试增加内存限制：

```
ini_set('memory_limit'. '128M'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:58:36.513

时间并不总是相同的，您的计算机/服务器可能正在处理另一个进程，这可能会减慢您当前正在运行的其他进程。

尝试运行它 100 倍或 1000 倍，然后得到一个平均值。你会发现差异几乎消失了。

# jquery - 为什么 ClientID 不显示？怎么修

> ID：10903973
> 
> 赞同：1
> 
> 时间：2012-06-05T19:52:40.717
> 
> 标签：jquery, asp.net

我在 ASP 中有一个 jQuery 函数，我试图获取它的客户端 ID。当它呈现 HTML 时，我得到了这个结果。

[HTML 渲染]

```
$("")//ctl00_Content_gvProgramList
                    .tablesorter({ widthFixed: true, widgets: ['zebra'],
                        widgetOptions: {
                            zebra: ["even", "odd"]
                        }
                    })
                    .tablesorterFilter({ filterContainer: $("#filter-box"),
                        filterClearContainer: $("#filter-clear-button"),
                        filterColumns: [0, 1, 2, 3],
                        filterCaseSensitive: false
                    })
                    .tablesorterPager({ container: $("#pager") }); 
```

[代码背后]

```
 $("<%# gvProgramList.ClientID %>")//ctl00_Content_gvProgramList
                .tablesorter({ widthFixed: true, widgets: ['zebra'],
                    widgetOptions: {
                        zebra: ["even", "odd"]
                    }
                })
                .tablesorterFilter({ filterContainer: $("#filter-box"),
                    filterClearContainer: $("#filter-clear-button"),
                    filterColumns: [0, 1, 2, 3],
                    filterCaseSensitive: false
                })
                .tablesorterPager({ container: $("#pager") }); 
```

如果我使用`ct100_Content_gvProgramList`所有的 javascript 作品，那么请不要发布任何与此相关的答案。我想要一个关于如何`ClientID`正确显示的答案。

* * *

## 更新

我想使用 `$('#<%= gvProgramList.ClientID %>')`，但出现错误。

```
The Controls collection cannot be modified because the control contains code blocks (i.e. <% ... %>). 

Line 16:         Head.Controls.Add(Header())
Line 17:         Head.Controls.Add(Menu())
Line 18:         Foot.Controls.Add(Footer()) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:54:17.273

采用：

```
<%= ... %> 
```

代替：

```
<%# ... %> 
```

所以：

```
$('#<%= gvProgramList.ClientID %>') ... 
```

* * *

**更新后**

由于您正在构建/修改*代码隐藏*aspnet 中的控件集合，因此当您尝试`Response.Write()`( `<%= ... %>`) 时会遇到麻烦。尝试使用类名而不是控件的`id`.

或者：

把`<script> ... </script>`里面包起来`<asp:placeholder>`。这将使脚本成为占位符的子代，而不是导致错误的服务器端控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:23:45.190

另一种选择是用您在代码隐藏中填充的占位符控件替换绑定。因此，在 .aspx/.ascx 文件中，您将替换它：

```
$('#<%= gvProgramList.ClientID %>') 
```

有了这个：

```
<asp:PlaceHolder id="phProgramListClientId" runat="server"></asp:PlaceHolder> 
```

然后在你的代码隐藏中，你可以这样做：

```
phProgramListClientId.Controls.Add( new LiteralControl( 
    String.Format( "$('#{0}')", gvProgramList.ClientID ) ) ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T20:31:20.763

```
<%# ... %> 
```

用于数据绑定，因此您可以执行此操作

```
Page.DataBind(); 
```

# javascript - 浏览器检测

> ID：10903974
> 
> 赞同：1
> 
> 时间：2012-06-05T19:52:40.673
> 
> 标签：javascript, browser

我需要模仿浏览器的行为。假设我需要访问网页的 DOM 属性（例如 Document.cookie 或 window.onblur 等），而无需在实际浏览器中加载网页，也无需在浏览器。

事实上，我正在尝试做一些我有一个想象中的浏览器对象浏览器的事情。所以，我可以这样做：

```
BROWSER g = BROWSER.load('google.com');
g.document.cookie();
g.window.onblur(); 
```

我想这被称为“浏览器检测”。我该怎么做 ？有任何想法吗.. ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:24:08.950

您最好的选择可能是 Selenium (http://seleniumhq.org/)。尽管它确实使用了真实的浏览器（如果您想在真实的浏览器环境中进行测试，这是必要的），但它可以让您完全自动化/控制该浏览器以使其为所欲为。使用它，您可以编写如下代码：

```
# Pseudo-code to search for Selenium on Google
browser.open('www.google.com')
browser.findElementByCSS('#search').value('Selenium')
browser.findElementByCSS('#submitButton').click() 
```

这听起来像你正在尝试做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T21:29:13.647

这是你要找的东西吗？它被称为[PhantomJS](http://phantomjs.org/)

从网站：

> 完整的网络堆栈，无需浏览器
> 
> PhantomJS 是一个带有 JavaScript API 的无头 WebKit。它具有对各种 Web 标准的快速和原生支持：DOM 处理、CSS 选择器、JSON、Canvas 和 SVG。
> 
> 使用 Jasmine、QUnit 或 CasperJS 等框架运行功能测试。

# excel-2007 - Excel中有没有办法引用一个单元格范围减去某个单元格？（作为函数参数）

> ID：10903978
> 
> 赞同：2
> 
> 时间：2012-06-05T19:53:01.623
> 
> 标签：excel-2007

假设我有一个 Excel 2007 单元格区域`B3:B50`。有没有办法指定`B3:B17+B19:B50`，或者也许`B3:B50-B18`？

一些消息来源说这`B3:B17,B19:B50`应该有效，但它不能作为函数参数（对于类似的东西`CORREL`），因为逗号被解释为分隔参数。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-06T20:23:40.910

我尝试使用命名范围（定义中可以有多个点）并`CORREL`返回`#Value!`，但`SUM`按预期工作。 ![命名范围](../Images/34f207dd9bb68e7a4f0ed06243bd434a.png)

您可能需要测试以查看哪些功能可以使用

# java - Java 7 JVM 比 JRockit 6 慢？

> ID：10903981
> 
> 赞同：4
> 
> 时间：2012-06-05T19:53:34.503
> 
> 标签：java, performance, jrockit

我对升级到 Java 7 非常感兴趣（出于我自己的编码原因）。但是，我们的用户对延迟非常敏感（一切都需要亚毫秒）。我在 3 个不同的 JVM 之间做了一个简单的性能比较测试，发现 Java 7 的速度要慢得多。测试通过我们的应用程序推送了一些简单的消息。此测试是低负载、负载量测试，每隔几秒推送一条消息。结果是（以微秒为单位）：

```
 - Hotspot 6 (build 24): msgs= 23 avg= 902 
 - JRockit 6 (R28 b 29): msgs= 23 avg= 481 
 - Hotspot 7 (build 04): msgs= 34 avg=1130 
```

Oracle 的策略是从 Java 7 开始合并 JRockit 和 Hotspot（所以 JRockit 6 是最后一个可用的）。有谁知道为什么性能差这么多？（需要注意的一点是，代码是在 Java 1.6 下编译的。不确定这是否能解释它......）

更新：我投票结束我自己的问题，因为我可以从评论中看到，我真的无法传达足够的信息来使这个问题成为一个建设性的问题。感谢所有评论的人。

更新：经过更多反馈后，我想我会提供更多信息。测试总是在重新开始之后。*每个测试的所有因素都相同。唯一改变的是 JVM*。多次重复测试给出一致的结果。在任何测试迭代中都没有发生 GC。

下面是其中一个测试运行的图形值。对于 JRockit 和 Hotspot 7，第一个延迟值被丢弃了。JRockit 具有巨大的初始价值，但随后很快优化并趋于均值。Hotspot 7 需要更长的时间来优化，并且永远不会下降到像 JRockit 这样低的平均值。每个数据点代表从 TCP/IP 套接字读取消息、运行业务逻辑以及在另一个套接字上写入消息的微秒。每条消息都是相同的，并且没有为任何消息输入新的代码路径。

![JRockit 6 与热点 7](../Images/1880080f015b86145e29c0d9a48e053b.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T13:14:45.663

JRockit 是它自己的（纯 C）代码库，不同于 OpenJDK。它包含不同的垃圾收集器和完全不同的 JIT 编译器。BEA 拥有时的一大盈利点是低延迟 GC，它非常先进，即使在非商业变体中也是如此。JRockit 作为一个洁净室虚拟机实现已经花费了大量时间。正如评论中所说，合并不如在 HotSpot 代码库中重新实现内容那么重要。这远不是一个快速的过程，而且有些东西根本不会到达那里，至少在它们的 JRockit 形式中不会。可以这么说，如果没有在边缘放置一些文件，拼图就不容易安装。JDK7 Hotspot，将擅长其他事情，或类似系统的不同版本，但这可能会弥补您损失的一些性能。

如果您有兴趣了解有关 JRockit（或任何 JVM）内部的更多信息，强烈推荐阅读“Oracle JRockit 权威指南”一书。完全披露，我可能每本获得约 2 美元的税前版税，并将用它来购买浓缩咖啡。:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-07T20:20:21.753

这个问题的主旨是，在*所有其他条件相同*（包括 JVM 参数）的情况下，为什么相同的 Java 代码 JAR 使用 Hotspot 7 JVM 比使用 JRockit 6 和 Hotspot 6 运行得慢得多。

这引起了一些关注时间是否正确完成的回应（显然是由于人们怀疑JVM之间*真的*会产生如此不同的结果）。基于大量测试，我认为测量结果是正确的，这是毫无疑问的。

我认为可能的潜在答案是：

*   Java 7 JVM 运行在 Java 6 下编译的代码的速度不如在 Java 7 下编译的相同代码快
*   Java 7 需要新的 JVM 参数才能以最优化的模式运行
*   其他人已经将 Java 7 与 JRockit 6 进行了基准测试，并看到了与我相同的结果

所以事实是，新的 Java 7 JVM 行为与我们的应用程序非常不同，*所有其他条件都相同*。唯一的解决办法是针对 Java 7 VM 分析代码，以发现代码中的慢点在哪里。（也许到那时，Java 6 JVM 和 Java 7 JVM 之间的实际区别是什么/现在就很清楚了）。

感谢大家的评论，并很抱歉我无法提供足够的细节来进行清晰的分析/解决。

# ruby - 如何将二维数组直接转储到 CSV 文件中？

> ID：10903985
> 
> 赞同：8
> 
> 时间：2012-06-05T19:53:45.980
> 
> 标签：ruby, csv

我有这个二维数组：

```
arr = [[1,2],[3,4]] 
```

我通常这样做：

```
CSV.open(file) do |csv| 
  arr.each do |row| 
    csv << row
  end
end 
```

除了逐行添加之外，还有其他更简单或直接的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-05T19:55:32.070

假设您的数组只是数字（没有可能包含逗号的字符串），那么：

```
File.open(file,'w'){ |f| f << arr.map{ |row| row.join(',') }.join('\n') } 
```

一个巨大的字符串被写入磁盘，不涉及 CSV 库。

或者，使用 CSV 库[正确转义每一行](http://ruby-doc.org/stdlib-1.9.3/)：

```
require 'csv'
# #to_csv automatically appends '\n', so we don't need it in #join
File.open(file,'w'){ |f| f << arr.map(&:to_csv).join } 
```

如果您必须经常这样做并且代码困扰您，您可以将其修改为：

```
class CSV
  def self.dump_array(array,path,mode="rb",opts={})
    open(path,mode,opts){ |csv| array.each{ |row| csv << row } }
  end
end
CSV.dump_array(arr,file) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-30T20:54:26.593

通过@Phrogz 扩展上面的答案，同时使用 csv 库并需要更改默认分隔符：

```
File.open(file,'w'){ |f| f << arr.map{|x| x.to_csv(col_sep: '|')}.join } 
```

# c# - 派生 WinForm 中的奇怪可空成员

> ID：10903986
> 
> 赞同：0
> 
> 时间：2012-06-05T19:53:48.670
> 
> 标签：c#, winforms

我有以下 Winforms 层次结构。

```
Form ==> AForm ==> BForm 
```

`int? X;`并且在 中定义了一个可以为空的成员`AForm`。在 中`BForm`，有以下代码。

```
public partial class BForm : AForm, IBview
{
    ......
    public int Y
    {
        get
        {
            int z = X ?? 0;
            System.Diagnostics.Debug.WriteLine("X: " + X.ToString() + " z: " + z.ToString());
            return z;
        }
    } 
```

`X`不应该为空。我正在尝试关闭并打开表单`BForm`。它通常有效，偶尔`z`为零（可能每 10 次一次）。我有一个`z==0`在线的有条件休息`return z`。

当击中断点时。调试写入

```
 X:  z: 0 
```

但是，当我在中断点被击中后将`X`鼠标光标悬停在 Visual Studio 中时，值既不是 null 也不是 0 。`X`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:43:06.867

检查 BForm 本身的初始化。仅仅因为 BForm 继承了 AForm 的值，这并不意味着这些值具有来自其他 AForm 对象实例的物理值，*除非您自己设置这些值*。

它与 BForm 实例的创建方式有关。像这样的东西：

```
AForm A = new Aform(someValueForX);
BForm B = A; 
```

或者

```
BForm B = new AForm(someValueForX); 
```

在这些情况下，BX 将具有与 AX 相同的值，并且应允许使用继承规则进行分配。但是，如果 X 没有在声明中的某处初始化，那么 X 对于您正在查看的 BForm 的特定实例将没有任何值，即使它可能在 AForm 的某个其他实例中具有值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:00:44.607

如果`X`可以为空 - 即`int? X`- 那么，它的值是通过`X.Value`. 您还可以检查：

```
int z = X.HasValue ? X.Value : 0; 
```

或者，您可以强制转换`X`- `(int)X`- 但您需要先检查是否`X.HasValue`。否则，如果 X 尚未初始化，我相信你会得到一个空异常。

# excel - 当有两个变量发生变化时如何在查找表中查找某些内容

> ID：10903987
> 
> 赞同：1
> 
> 时间：2012-06-05T19:53:52.290
> 
> 标签：excel, excel-formula, vlookup

![在此处输入图像描述](../Images/3e10df6e85d88501339ead30d0cfd0a7.png)

快速提问——

我知道这可能真的很容易，但我的 excel 技能有点生疏了。您可以从下面的图片中看到我的情况。我有一张表作为参考，根据它的重要性和需要多少工作来显示某事的优先级。我将有数百个东西需要与这张表进行比较。如何快速轻松地填写橙色优先标签下的问号？我可以做一个 IF 语句，但那将是 300 行长。我知道 VLOOKUP 行不通，因为变量太多。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:58:32.037

```
=INDEX($the_data_part_of_the_reference_table,
       MATCH(current_importance_value, $importance_column_header_in_the_table, 0),
       MATCH(current_AoW_value,        $AoW_header_row_in_the_table,           0)
 ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:59:47.307

CONCAT 引用表中的标识符并在目标表中使用 VLOOKUP - 搜索标识符。

# javascript - 由于错误 80020101 无法完成操作。IE

> ID：10903989
> 
> 赞同：36
> 
> 时间：2012-06-05T19:53:58.583
> 
> 标签：javascript, internet-explorer

> **可能重复：**
> [Ajax 请求问题：错误 80020101](https://stackoverflow.com/questions/4918969/ajax-request-problem-error-80020101)

我正在使用 JQuery-1.64，这是我重置计时器的代码

```
var message="Logged in";
var myTimeout = setTimeout("timerDone()",1000 * 1440);
function timerDone()
{
    message="Logged out";   
}
function timerReset()
{

    clearTimeout(myTimeout);
    myTimeout = setTimeout("timerDone()", 1000 * 1440);
} 
```

但是，当我尝试执行 clearTimeout 时，它只会在 IE 中给我一个错误。任何想法？？？？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-09T17:11:27.573

我不知道为什么，但它对我有用。如果你有类似的评论

```
//Comment 
```

然后它给出了这个错误。要解决这个问题

```
/*Comment*/ 
```

没有意义，但它对我有用。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-08-05T19:54:03.010

所有错误 80020101 意味着在评估 JavaScript 时出现了某种错误。如果您通过 Ajax 加载该 JavaScript，则评估过程特别严格。

有时删除*//*会解决问题，但反之则不然……问题并不总是由*//*引起的。

查看 Ajax 调用返回的确切 JavaScript 并查找该脚本中的任何问题。有关更多详细信息，请参阅此处的精彩文章

[http://mattwhite.me/blog/2010/4/21/tracking-down-error-80020101-in-internet-exploder.html](http://mattwhite.me/blog/2010/4/21/tracking-down-error-80020101-in-internet-exploder.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-07T14:22:45.073

将您的整个代码块包装在此：

```
//<![CDATA[

//code here

//]]> 
```

还要确保将脚本类型指定为 text/javascript

试试看，让我知道结果如何

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T13:05:55.467

如果您使用 IE9，请关闭兼容性视图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T19:57:05.840

你什么时候调用 timerReset()？在 setTimeout() 已经完成它的事情之后尝试调用它时，也许你会得到那个错误？

把它包起来

```
if (window.myTimeout) { 
  clearTimeout(myTimeout);
  myTimeout = setTimeout("timerDone()", 1000 * 1440);
} 
```

编辑：实际上，经过进一步思考，因为您确实提到了 jQuery（但这里没有任何实际的 jQuery 代码......我想知道您是否将它嵌套在一些 jQuery 中（比如在 a 中`$(document).ready(..`，这是一个变量范围的问题. 如果是这样，试试这个：

```
window.message="Logged in";
window.myTimeout = setTimeout("timerDone()",1000 * 1440);
function timerDone()
{
    window.message="Logged out";   
}
function timerReset()
{

    clearTimeout(window.myTimeout);
    window.myTimeout = setTimeout("timerDone()", 1000 * 1440);
} 
```

# facebook - Facebook PHP SDK：现在已弃用“offline_access”，因此获取“长期”访问令牌

> ID：10903991
> 
> 赞同：15
> 
> 时间：2012-06-05T19:54:10.160
> 
> 标签：facebook, facebook-graph-api

**基本问题：**即使用户不在，我希望我的应用程序能够调用有关授权用户的 Facebook 图形 api。

例如，我希望用户 (A) 授权该应用程序，然后我希望用户 (B) 能够使用该应用程序查看有关用户 (A) 的朋友的信息。具体来说：“工作”领域。是的，我正在请求那些扩展权限（`user_work_history`、`friends_work_history`等）。目前我的应用程序可以访问登录用户的朋友工作历史记录，但不能访问该应用程序*其他*用户的任何朋友工作历史记录。

**这是我已经知道的：**

*   添加`offline_access`到范围参数是旧方法，它不再有效。
*   新方法是使用“长期”访问令牌，描述这里。这些持续60天。
*   我需要交换一个普通的访问令牌来获取新的扩展令牌。FB 文档说：

    [https://graph.facebook.com/oauth/access_token](https://graph.facebook.com/oauth/access_token)？
    client_id=APP_ID&client_secret=APP_SECRET&grant_type=fb_exchange_token&fb_exchange_token=EXISTING_ACCESS_TOKEN

**以下是我不知道的（希望您能告诉我）：** 如何使用 Facebook PHP SDK 获取扩展（又名“长期”）访问令牌？目前，我的代码如下所示：

```
$facebook->getAccessToken(); 
```

有没有这样的事情：

```
$facebook->getExtendedAccessToken(); 
```

如果不是，这是我应该做的吗？

```
$accessToken = $facebook->getAccessToken();
$extendedAccessToken = file_get_contents("https://graph.facebook.com/oauth/access_token?             
    client_id={$appId}&
    client_secret={$secret}&
    grant_type=fb_exchange_token&
    fb_exchange_token={$accessToken}"
    ); 
```

我已经尝试过了，但它不起作用。我收到此错误：

```
Warning: file_get_contents(https://graph.facebook.com/oauth/access_token? client_id=#######& client_secret=#########& grant_type=fb_exchange_token& fb_exchange_token=##########) [function.file-get-contents]: failed to open stream: HTTP request failed! HTTP/1.0 400 Bad Request in /... 
```

如果我切换到 FQL 而不是图形 api，它的工作方式会有什么不同吗？我已经多次阅读 Facebook 文档，但是 PHP sdk 没有完整的文档记录，我找不到任何关于它应该如何工作的示例。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-06T20:22:39.333

我终于自己弄清楚了。答案是相当反高潮的。似乎新创建的应用程序会自动获得 60 天的访问令牌。我不确定这是否取决于在应用程序设置的“迁移”部分中启用“depricate offline_access”设置。让它保持安全。

因此，在撰写本文时，您可以按如下方式使用 PHP SDK：`$facebook->getAccessToken();`

（我的应用程序没有按预期工作的原因与访问令牌的到期无关。）

还有一件事，要使用 PHP SDK 获得长期访问令牌，您应该`$facebook->setExtendedAccessToken();`在之前调用`$facebook->getAccessToken();`

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-08-20T19:24:48.273

在上一个 Facebook PHP SDK 3.2.0 中，您有一个`setExtendedAccessToken()` 必须在之前调用的新函数`getAccessToken();`

像这样：

```
$user = $facebook->getUser(); 
$facebook->setExtendedAccessToken(); //long-live access_token 60 days
$access_token = $facebook->getAccessToken(); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-10-29T01:00:14.830

实际上，如果您使用服务器端调用，新创建的应用程序只会自动获得 60 天的访问令牌。如果您使用上面问题中所示的客户端端点，即使是新应用程序最初仍会收到一个短期令牌。见：[https ://developers.facebook.com/docs/roadmap/completed-changes/offline-access-removal/](https://developers.facebook.com/docs/roadmap/completed-changes/offline-access-removal/)

我在使用 New Endpoint 时遇到了相同的 HTTP/1.1 400 Bad Request 错误，问题是如果你复制 Facebook 给你的代码并将其粘贴到你的应用程序中，参数之间实际上有空格，这意味着有url 中不必要的空格，并且在传递给 file_get_contents() 时它不会被正确调用，即使它在粘贴到浏览器中时可以正常工作。这花了我太长时间才弄清楚。希望这对某人有帮助！这是我从新端点中获取扩展访问令牌的完整工作代码（将 x 替换为您的值）：

```
$extend_url = "https://graph.facebook.com/oauth/access_token?client_id=xxxxxxxxxxxx&client_secret=xxxxxxxxxxxxxxxxxxxxxx&grant_type=fb_exchange_token&fb_exchange_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";

$resp = file_get_contents($extend_url);

parse_str($resp,$output);

$extended_token = $output['access_token'];

echo $extended_token; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-30T21:43:13.190

所选答案现已过时。以下是 Facebook 将短期令牌（在前端提供）换成长期令牌（仅限服务器）的说明：

[https://developers.facebook.com/docs/facebook-login/access-tokens/refreshing/](https://developers.facebook.com/docs/facebook-login/access-tokens/refreshing/)

```
Generate a Long-lived User or Page Access Token
You will need the following:

A valid User or Page Access Token
Your App ID
Your App Secret
Query the GET oath/access_token endpoint.

curl -i -X GET "https://graph.facebook.com/{graph-api-version}/oauth/access_token?  
    grant_type=fb_exchange_token           
    client_id={app-id}&
    client_secret={app-secret}&
    fb_exchange_token={your-access-token}" 

Sample Response
{
  "access_token":"{long-lived-access-token}",
  "token_type": "bearer",
  "expires_in": 5183944            //The number of seconds until the token expires
} 
```