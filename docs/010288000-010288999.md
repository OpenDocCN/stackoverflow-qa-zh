# StackOverflow 问答 10288000-10288999

# ruby-on-rails - 创建复杂用户结构的 rails 方式

> ID：10288002
> 
> 赞同：1
> 
> 时间：2012-04-23T20:44:08.110
> 
> 标签：ruby-on-rails, database, authentication

我是 Rails 的新手，我想知道我应该如何做这样的事情：

我正在创建一个包含两个主要用户组的应用程序，我们称他们为客户和供应商。

我应该如何实现这一点，记住这些相似点和不同点：

差异：

*   从业务角度来看，这两个群体是分开的，一般客户都是从厂商那里购买的。
*   它们主要与不同的模型相关联，供应商 90% 的时间使用应用程序的后端，而客户仅使用前端。
*   用户帐户管理完全不同

相似之处：

*   对于两者，我都想使用一些基于角色的授权解决方案（例如[声明性授权](https://github.com/stffn/declarative_authorization)）
*   他们都登录
*   在极少数情况下，两者都通过相同的控制器/视图与相同的模型进行交互

同时保持简单和清洁的最佳解决方案是什么？一种与客户和供应商模型相关的胖用户模型？具有重复登录逻辑的单独模型（它如何与声明性授权一起使用）？单表继承（声明式授权又如何）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T20:49:54.953

我将创建一个`User`类来处理诸如授权之类的事情以及您系统的所有用户都拥有的任何其他基本功能。然后创建独立的`Customer`和`Vendor`继承自`User`并拥有自己的业务逻辑的类。Rails 中的 STI 让它变得非常简单——创建一个`type`列，它会自动填充类名。

您可以使用像[CanCan](https://github.com/ryanb/cancan)这样的 gem来隔离每种类型的权限`User`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:24:47.440

好的，我在工作中休息了 StackOverflow，然后工作把我叫走了，所以我很快回复了。您必须决定是否要使用 STI，

```
class CreateUsers < ActiveRecord::Migration
  def change
    create_table :users do |table|
      table.string   "type"
... 
```

并将您的供应商和客户对象实例存储在您的用户表中，或使用多表继承，您只需简单地拥有

```
class Vendor < ActiveRecord::Base
  belongs_to :user
...
class Customer < ActiveRecord::Base
  belongs_to :user
... 
```

如果您曾经拥有特定于您的供应商和/或客户对象的状态数据，例如供应商的销售代表或客户的购买历史，您将需要 MTI。好的，购买历史很可能是与属于_to :customer 的其他表的连接，但是当用户可以是供应商时，让连接的记录belongs_to :user 看起来很尴尬。

现在，为了配合访问控制，......我已经实现了一个 access_control_items 表，

```
class CreateAccessControlItems < ActiveRecord::Migration
  def change
    create_table "access_control_items", :force => true do |table|
      table.timestamps
      table.string   "controller"
      table.string   "action"
      table.string   "group_type", :null => false
      table.integer  "group_id",   :null => false
    end
  end
end 
```

关键是我将角色的成员资格与访问控制分离，并使其具有多态性，因此它可以是任何具有 include?(user) 方法的对象的成员资格。我的应用程序控制器之前的方法将当前登录的用户发送到包含？与控制器和操作匹配的任何 access_control_items 引用的组的方法。

因此，该组可以指向某个 ActiveRecord 类的实例，如果用户是供应商（在 STI 中具有 type = "Vendor" 或 has_one :vendor not nil，则该类可能是响应 true 以包含？（用户）的类在 MTI 中）。

在实践中，继续使用 gem，如果你愿意，可以使用 cancan。但是请考虑为您自己的应用程序逻辑解耦设计的示例。

# python - Python 中 unicode() 和 encode() 函数的使用

> ID：10288016
> 
> 赞同：84
> 
> 时间：2012-04-23T20:45:11.967
> 
> 标签：python, string, sqlite, unicode, encoding

我在编码*路径*变量并将其插入*SQLite*数据库时遇到问题。我尝试使用无帮助的*encode("utf-8")*函数来解决它。然后我使用了*unicode()*函数，它给了我类型*unicode*。

```
print type(path)                  # <type 'unicode'>
path = path.replace("one", "two") # <type 'str'>
path = path.encode("utf-8")       # <type 'str'> strange
path = unicode(path)              # <type 'unicode'> 
```

最后我获得了*unicode*类型，但是当*路径*变量的类型为*str时，我仍然遇到相同的错误*

> sqlite3.ProgrammingError：除非您使用可以解释 8 位字节串的 text_factory（如 text_factory = str），否则不得使用 8 位字节串。强烈建议您将应用程序切换为 Unicode 字符串。

你能帮我解决这个错误并解释一下`encode("utf-8")`和`unicode()`函数的正确用法吗？我经常和它打架。

编辑：

此*execute()*语句引发了错误：

```
cur.execute("update docs set path = :fullFilePath where path = :path", locals()) 
```

我忘记更改遇到同样问题的*fullFilePath*变量的编码，但我现在很困惑。我应该只使用*unicode()*还是*encode("utf-8")*或两者都使用？

我无法使用

```
fullFilePath = unicode(fullFilePath.encode("utf-8")) 
```

因为它引发了这个错误：

> UnicodeDecodeError：“ascii”编解码器无法解码位置 32 中的字节 0xc5：序数不在范围内（128）

*Python*版本为*2.7.2*

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-04-23T21:08:53.367

`str`是以字节为单位`unicode`的文本表示，是以字符为单位的文本表示。

您将文本从字节解码为 un​​icode，并将 unicode 编码为具有某种编码的字节。

那是：

```
>>> 'abc'.decode('utf-8')  # str to unicode
u'abc'
>>> u'abc'.encode('utf-8') # unicode to str
'abc' 
```

*UPD Sep 2020*：答案是在 Python 2 主要使用时编写的。在 Python 3 中，`str`重命名为`bytes`，`unicode`并重命名为`str`.

```
>>> b'abc'.decode('utf-8') # bytes to str
'abc'
>>> 'abc'.encode('utf-8'). # str to bytes
b'abc' 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2012-04-23T21:15:32.850

您使用`encode("utf-8")`不正确。Python 字节字符串（`str`类型）有编码，Unicode 没有。您可以使用 将 Unicode 字符串转换为 Python 字节字符串`uni.encode(encoding)`，也可以使用`s.decode(encoding)`（或等效地，`unicode(s, encoding)`）将字节字符串转换为 Unicode 字符串。

如果`fullFilePath`和`path`当前是一种`str`类型，您应该弄清楚它们是如何编码的。例如，如果当前编码是 utf-8，您将使用：

```
path = path.decode('utf-8')
fullFilePath = fullFilePath.decode('utf-8') 
```

如果这不能解决它，实际问题可能是您在`execute()`调用中没有使用 Unicode 字符串，请尝试将其更改为以下内容：

```
cur.execute(u"update docs set path = :fullFilePath where path = :path", locals()) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-26T11:56:15.530

确保您在从 shell 运行脚本之前设置了您的语言环境设置，例如

```
$ locale -a | grep "^en_.\+UTF-8"
en_GB.UTF-8
en_US.UTF-8
$ export LC_ALL=en_GB.UTF-8
$ export LANG=en_GB.UTF-8 
```

文档：`man locale`，，`man setlocale`。

# email - MIME - gmail“通过”标签 - 这对应于什么标题？

> ID：10288018
> 
> 赞同：-1
> 
> 时间：2012-04-23T20:45:28.120
> 
> 标签：email, mime

我的业务问题是按发件人对电子邮件进行分组，我们需要确定“发件人”的含义。我注意到 gmail 的“via”标签通常会告诉我我的意思 - 例如，它很好地将所有各种 meetup.com 电子邮件组合在一起，即使 meetup 发送了来自@personaldomain.com、@gmail.com 等人的许多电子邮件。我不知道不知道这对应于 MIME 中的哪个标头字段。一般来说，我不了解 MIME 标头，并且没有找到介于 RFC 文档和维基百科概述之间的资源。

那么 - 1）gmail对“via”使用什么？2）对于这个业务目标，什么是有用的标题字段？我不知道接收者、发送者、来自等的实际“含义”-对我来说听起来都一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T08:02:49.237

[http://support.google.com/mail/bin/answer.py?hl=en&answer=1311182](http://support.google.com/mail/bin/answer.py?hl=en&answer=1311182)说

> Gmail 检测到该电子邮件是通过其他邮件服务发送的。这意味着发件人可能正在使用第三方电子邮件服务来生成此消息。例如，消息可能是通过提供电子邮件服务的社交网站发送的，或者是通过您订阅的邮件列表发送的。
> 
> Gmail 显示此信息是因为许多代表他人发送电子邮件的服务不会验证发件人提供的名称是否与该电子邮件地址匹配。我们希望保护您免受伪装成您认识的人的误导性信息。

他们没有确切说明他们如何决定显示什么，但他们继续说，如果您使用 SPF 授权发送 IP 并使用 DKIM 对邮件进行签名，他们将不会显示“通过”标签。

# trigger.io - 原生 Trigger.io 功能的截屏视频？

> ID：10288021
> 
> 赞同：2
> 
> 时间：2012-04-23T20:45:33.510
> 
> 标签：trigger.io

我需要为客户构建一个移动应用程序。我一直在寻找像 Trigger.io 这样的解决方案来简化我的任务。我已通读文档，但没有找到任何有关本机功能的*示例*？

我主要担心的是像 Trigger.io 这样的解决方案将在 chrome/UI 上拥有自己的品牌，而不是使用手机的原生 chrome/UI。我需要向我的客户提供零第三方品牌和风格的产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:46:12.667

我刚刚[在我们的博客上发布了一个截屏演示，](http://trigger.io/cross-platform-application-development-blog/2012/04/23/screencast-showing-trigger-io-forge-in-action/)其中也讨论了但没有明确显示本机功能。

它介绍了该框架，我将在下周发布另一个专注于本机功能的截屏视频。您可以使用本机 UI 组件来控制样式，如此处记录的顶部栏，例如，您可以在其中设置按钮图像和背景色调： [http ://docs.trigger.io/en/v1.3/modules/顶栏.html](http://docs.trigger.io/en/v1.3/modules/topbar.html)

# css - 带有 JQuery Mobile 的导航栏谷歌风格

> ID：10288026
> 
> 赞同：0
> 
> 时间：2012-04-23T20:45:51.493
> 
> 标签：css, jquery-mobile

我有一个 JQuery Mobile Navbar，我想用 css 来设置样式，就像谷歌上最上面的导航菜单一样。

有人可以帮我看看款式吗？

或者至少告诉我需要覆盖哪些样式以及如何实现？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:21:41.333

刚刚创建了一些你可以使用的东西。它并不完美，但它看起来非常像谷歌。（现场示例：http: [//jsfiddle.net/dAUbu/](http://jsfiddle.net/dAUbu/)）

**HTML：**

```
<div data-role="page"> 
    <div data-role="header" class="header-google">
        <div data-role="navbar">
            <ul>
                <li><a href="#">Search</a></li>
                <li><a href="#" class="ui-btn-active">Images</a></li>
                <li><a href="#">Maps</a></li>
                <li><a href="#">Play</a></li>
                <li><a href="#">YouTube</a></li>
            </ul>
        </div>
    </div>

    <div data-role="content">
        <p>Yay!</p>
    </div>
</div>​ 
```

**CSS：**

```
.header-google {
    border: none;
    border-bottom: 1px solid #000;
    background: #2D2D2D;
}

.header-google a.ui-btn {
    border: none;
    background: inherit;
    text-shadow: none;
    color: #BBB;
    font-family: Arial, sans-serif;
    font-size: 13px;
}

.header-google .ui-btn-inner {
    padding: 0 !important;
    height: 29px;
    line-height: 29px;
}

.header-google a.ui-btn.ui-btn-active,
.header-google a.ui-btn:hover{
    color: #FFF;
} 
```

# linux - 在 linux 中获取最后出现的带有 2 个特定单词的行

> ID：10288027
> 
> 赞同：4
> 
> 时间：2012-04-23T20:45:56.950
> 
> 标签：linux, bash

我在 linux 中有一个文本文件（基本上是一个日志文件），我有 2 个单词（alpha，beta）。

现在我尝试在一行中搜索这两个单词，然后在临时文件中打印该行和接下来的 15 行。会有很多行带有 alpha 和 beta 但我只需要最后一次出现“alpha”和“beta”以及接下来的 15 行。

如果您还告诉我命令以防单词数量增加，例如在同一行上搜索 3 或 4 个单词，alpha，beta，gamma，我将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T20:51:34.407

您的措辞有点模棱两可，您是否想要一条同时包含 alpha AND beta 或 alpha OR beta 的行。如果是第一个：

```
grep -EA15 'alpha.*beta|beta.*alpha' | tail -16 
```

如果是第二个：

```
grep -wA15 'alpha|beta' | tail -16 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:09:40.833

只要您坚持每行 2 个单词，OmnipotentEntity 绝对是最佳选择。然而，由于正则表达式中的组合爆炸，它并没有真正超出这个范围。如果您需要在一行中匹配 4 或 5 个单词，我认为类似下面的内容无需调整即可工作（我只对此进行了部分测试）：

```
 #!/bin/bash 

context=15
file=$1
shift

cmd="cat -n $file"
for s in $@
do
   cmd="$cmd | grep $s"
done

begin=$(eval $cmd | tail -1 | cut -f1)
(( end=$begin + $context ))

sed -n $begin,${end}p $file 
```

这个想法是我们将行号附加到输入文件，然后构建一系列 grep 过滤器。我们提取通过所有过滤器的最后一行的行号，并使用 sed 打印出所需的范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T22:39:40.970

这可能对您有用（GNU sed）：

```
sed '/alpha.*beta\|beta.*alpha/,+15{//{h;d};H};$!d;g;/^$/d' file 
```

或者这个（所有 sed 的）：

```
sed '/alpha.*beta\|beta.*alpha/{:a;$bb;N;s/\n/&/15;tb;ba;:b;$q;x};$!d;g;/^$/d' file 
```

使用两个词，正则表达式`/alpha.*beta\|beta.*alpha/`是可以接受的，但是从那里开始记住所有不同的组合变得更加棘手。如果该行不包含当前的正则表达式，更好的方法是在任何时候将单词列为单独的正则表达式：

```
sed '/alpha/!bc;/beta/!bc;/gamma/!bc;/delta/!bc;:a;$bb;N;s/\n/&/15;tb;ba;:b;$q;x;d;:c;$!d;g;/^$/d' file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T21:14:18.267

请参阅以下代码：

```
awk '
    {
        file[NR]=$0
    }
    END{
        for (i=NR; i>0; i--) {
            if (file[i] ~ /^alpha, beta/)  {
                for (j=i; j<=i+15; j++) {
                    print file[j]
                }
                exit
            }
        }
    }
' FILE 
```

算法是：

*   对于文件的每一行，我们以当前行号作为键输入和数组
*   在文件末尾，我们以**相反的顺序搜索“alpha, beta”的第一次出现**
*   当行匹配时，我们打印它并按 ASC 顺序打印每个值，而数组键可以递增 15 次

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T22:25:19.097

您也可以使用 sed：

```
sed -n '/alpha.*beta|beta.*alpha/,+15p' file | tail -n 16 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-04-23T20:50:54.510

获取特定单词的最后一次出现：“tail”

```
grep myword myfile.txt| tail -1 
```

对于多个单词，

```
grep -w 'word1|word2' myfile.txt| tail -1 
```

对于任一单词的最后 15 个实例，

```
grep -w 'word1|word2' myfile.txt| tail -15 
```

对于更复杂的场景：“sed”或“awk”。

# java - CORBA 中的身份验证/访问控制

> ID：10288030
> 
> 赞同：2
> 
> 时间：2012-04-23T20:46:05.203
> 
> 标签：java, authentication, interceptor, corba

我正在编写一个应用程序，可以使用各种设备访问一些虚构的实验室。我将 Java 与 CORBA 一起使用。问题是许多用户可以同时尝试访问这些设备。只有一个人应该得到它并积极使用，而其他用户只能被通知设备状态的变化。如果只有我有办法识别谁调用了设备上的方法，这将很容易实现。如果是之前拿到那个设备的来电者，他会为所欲为。如果是其他用户，那么我会在非法方法调用上抛出一个适当的异常。

如何获取来电者身份？如何实现身份验证逻辑，使其独立于业务（实验室：P）逻辑？CORBA 是否有类似“拦截器”或类似的东西？

我真的指望你们StackOverflowers :) 我很短的时间来实现它..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T09:45:30.447

是的。CORBA 有拦截器，是的，你可以使用它们。它们并不是真正独立于您的业务逻辑，但业务逻辑不依赖于身份验证和授权。

坏消息是没有简单的方法来实现这一点。

拦截器逻辑取决于您对 CORBA 的实现。你写了，你已经用 Java 实现了它，但是你使用了哪个 CORBA 实现。这可能是 SUN/Oracle-with-Java-shipped-ORB、JacORB、Bea Weblogic 等。

CORBA Security 的一般介绍可以在以下位置找到：

*   [CORBA 安全性介绍](http://www.ciaranmchale.com/corba-explained-simply/security.html)
*   [CORBASEC 常见问题](http://cadse.cs.fiu.edu/corba/corbasec/faq/single-page/CORBASEC-FAQ.html)

如果您提供有关您的 ORB 的更多信息，则可以提供更多帮助...

# php - 带有外部页面的 javascript 或 jquery 窗口弹出窗口

> ID：10288033
> 
> 赞同：1
> 
> 时间：2012-04-23T20:46:25.793
> 
> 标签：php, javascript, jquery, jquery-ui

任何人都可以为我提供一些关于如何在漂亮的弹出窗口中打开外部页面的指导吗？

我在页面上有很多动态内容，在下面的代码中，我想打开一个带有链接的弹出窗口。出于某种原因，我完全坚持这一点。

```
 function showCourse(code)
{

    $.ajax({
        async:false,
        type: "POST",
        url: 'formPostsUser.php?reqtype=getCourseDetails',
        data:'coursecode='+ code,
        success: function(data) 
        {
             $('body').add('div#lightbox')
             .append(data)
             .animate({width: "350px", height:"250px"}, 1500);

        }
    });
} 
```

此功能需要编辑才能打开一个弹出窗口。出于某种原因，目前，如果用户按下调用此函数的链接，它会将我的页面移动到屏幕左侧，并将我的内容显示在页面顶部，而不是在弹出窗口中。

任何提示将不胜感激亲切的问候亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:49:01.087

[看看 HighSlideJS](http://highslide.com/)它可以将图像、iframe、dom 内容、视频等嵌入到弹出框中。

# java - “多个标记”是什么意思？

> ID：10288036
> 
> 赞同：-2
> 
> 时间：2012-04-23T20:46:34.320
> 
> 标签：java, hibernate

我正在尝试通过以下方式使用：

```
@Override
public User getModel() {
    return user;
} 
```

我收到 Eclipse 生成的以下错误消息：

此行有多个标记

*   UserAction 类型的方法 getModel() 必须覆盖超类方法
*   实现 com.opensymphony.xwork2.ModelDriven.getModel

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:25:20.993

这意味着该行存在多个问题。其中之一是`@Override`如果超类中不存在具有相同签名的方法，则无法使用。

# wpf-controls - 如何在 XamDataGrid 中显示行号？

> ID：10288038
> 
> 赞同：1
> 
> 时间：2012-04-23T20:46:47.753
> 
> 标签：wpf-controls, infragistics, xamdatagrid

有人可以告诉我是否有一种简单的方法（例如设置布尔属性）来让 Infragistics WPF XamDataGrid 显示行号？

我在功能浏览器中找到了一些东西，但这似乎是针对 XamGrid 的。我们使用 WPFv3 11.2 库。

一些快速的谷歌搜索似乎表明该功能不受支持，但最新的帖子似乎是在 2011 年。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T07:36:18.183

在当前版本的 NetAdvantage Suite (2011 vol. 2) 中，没有可用于满足您要求的属性。
存在一种解决方案，它创建一个实现 IMultiValueConverter 接口的特定类，如Infragistic 支持论坛上的[此线程中所述。](http://community.infragistics.com/forums/p/52722/278616.aspx)[您可以使用该页面上的功能请求链接](http://devcenter.infragistics.com/Support/KnowledgeBase.Aspx)
将您的要求提交给 Infragistics 开发团队，正如其他审阅者已经完成的那样。

*（感谢@alhalama）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T20:58:31.397

我知道这有点晚了，但是以防万一，您仍然没有找到解决方案：

*   在形成绑定列表内对象的基类中，为将显示行号的列创建一个属性
*   在视图模型中创建另一个 Visibility 类型的属性，用于显示/隐藏行号列
*   为视图中的视图模型创建静态资源
*   将行号列的可见性属性绑定到在 vm 文件中创建的可见性属性

你应该被设置。

# jquery - jQuery easypaginate 淡入淡出不起作用

> ID：10288040
> 
> 赞同：0
> 
> 时间：2012-04-23T20:46:49.960
> 
> 标签：jquery, jquery-plugins

我使用easypaginate插件 [http://cssglobe.com/post/9801/easy-paginate-jquery-plugin-for-pagination](http://cssglobe.com/post/9801/easy-paginate-jquery-plugin-for-pagination)

这是代码：http: [//jsfiddle.net/qTwa8/1/](http://jsfiddle.net/qTwa8/1/)

基本上这个分页显示每个列表项都带有淡入/淡出，即：

```
jQuery(function($){
    $('ul#items').easyPaginate({
        step:12
    });
}); 
```

但是当这样设置时：

```
jQuery(function($){
    $('ul#items').easyPaginate({
        step:20
    });
}); 
```

淡化效果不显示？如何显示淡入淡出效果？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:09:40.663

这就是这个插件应该如何工作的。查看它的代码，您会在那里看到这样的情况：

```
 if(count>step){ // You should remove this condition to have effects in your case.

   var pages = Math.floor(count/step);
   .......rest of code......
  }; 
```

删除此条件，效果将起作用。

# jquery - jQuery 谷歌地图

> ID：10288041
> 
> 赞同：0
> 
> 时间：2012-04-23T20:46:50.750
> 
> 标签：jquery, google-maps

如何`GLatLng()`用表单控件值替换纬度和经度？

例子：

```
$(document).ready(function(){
    var map = new GMap2($("#map").get(0));
    var burnsvilleMN = new GLatLng(18.502401,-68.391953);
    map.setCenter(burnsvilleMN, 10); 
```

像这样的东西，但它不工作：

```
$(document).ready(function(){
    var map = new GMap2($("#map").get(0));
    var burnsvilleMN = new GLatLng(DOCUMENT.FORM.CONTROL.VALUE);
    map.setCenter(burnsvilleMN, 10); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T20:52:08.273

You can use jQuery to retrieve just about any value in the document, but you have to know how to select it. If your form field has an ID attribute, say `id="gmap-lat"`, just select that ID and use [`val()`](http://api.jquery.com/val/) like this: `$('#gmap-lat').val();`

Note that you'll need use two values, and convert them into numbers using [`parseFloat()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseFloat).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T20:56:01.580

从 Blaze 借一点（我忘了你需要为你的函数 GLatLng 解析字符串）

```
$(document).ready(function(){
  var map = new GMap2($("#map").get(0));
  var longitude = parseFloat($("#longitudeHiddenControl").val());
  var latitude = parseFloat($("#latitudeHiddenControl").val());
  var burnsvilleMN = new GLatLng(longitude, latitude);
  map.setCenter(burnsvilleMN, 10);
}); 
```

# windows - Windows 批处理文件：使用 UnixUtils find 命令将超过 X 分钟的文件移动到不同的目录

> ID：10288043
> 
> 赞同：0
> 
> 时间：2012-04-23T20:47:20.913
> 
> 标签：windows, unix

我找到了适用于 Windows 的 unixutils，并尝试使用 find 命令将超过 30 分钟的文件移动到不同的目录。

我已经尝试了以下所有方法（也在 SourceDir 和/或 TargetDir 的末尾使用 \），但得到了各种错误，我很确定这是由于 unix 使用 / 来分隔目录和 Windows 使用 \ 来分隔目录：

```
find C:\SourceDir -name * -mmin +30 -type f -exec "move {} C:\TargetDir" ;
find C:\SourceDir -name * -mmin +30 -type f -exec "move {} C:\TargetDir" +
find C:\SourceDir -name * -mmin +30 -type f -execdir "move {} C:\TargetDir" ;
find C:\SourceDir -name * -mmin +30 -type f -execdir "move {} C:\TargetDir" + 
```

有没有人让这个工作？

我也不喜欢使用这个实用程序——它看起来很容易做到。不过，作为计划工作的一部分，我确实必须通过命令行来完成，并且非常希望不必安装任何软件。不过，复制独立的单个文件实用程序是可以接受的。

我相信我也可以使用 Windows Powershell。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:57:44.347

我找到了帮助我使用 Windows Powershell 的人。我想我会在这里提供更新，以防以后对其他人有所帮助。

以下 Powershell 命令执行相同的操作：

```
get-childitem -Path "C:\SourceDir" -recurse | where-object {$_.LastWriteTime -le (get-date).AddMinutes(-30)} | move-item -destination "C:\TargetDir" -force 
```

# java - Bin 包装扭曲？

> ID：10288048
> 
> 赞同：1
> 
> 时间：2012-04-23T20:47:47.097
> 
> 标签：java, algorithm

我一直在尝试寻找某种可以解决我遇到的问题的算法。我遇到的最接近的是装箱算法，但我不认为它是我正在寻找的安静。

本文档是我的问题和预期输出的图形表示： [http ://www.scribd.com/doc/90871434/Rectangles](http://www.scribd.com/doc/90871434/Rectangles)

我的想法是在哪里找到最低（高度）的矩形并创建一个适合剩余矩形宽度的矩形，然后通过一些递归找出其余的。

我基本上想做的是在给定 N 个水平放置的矩形的情况下找到最少数量的垂直堆叠矩形。

在Java中这样做我有一个带有输入矩形的HashMap。

任何想法，代码，链接？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T20:54:06.637

找到最小的矩形。

从中创建您的第一个结果矩形。

确定剩余的矩形。

将算法应用于所有连续的剩余矩形组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:22:28.327

我认为你应该使用*分而治之*。

当您找到最低的矩形时，您还拆分了数据集。接下来的矩形要么完全位于左侧或右侧。这是递归的。

# linux - 在 Ubuntu 8.10 中安装 Mono 2.10+

> ID：10288052
> 
> 赞同：0
> 
> 时间：2012-04-23T20:47:57.120
> 
> 标签：linux, ubuntu, mono

首先，我意识到 8.10 是一个不受支持的 Ubuntu 旧版本，但它位于 Intranet 上，我无法更新它......但我有 2 个问题

1.  我想在上面安装mindtouch一个开源wiki引擎，但它需要mono 2.10.2+才能工作，所以我想知道是否可以在Ubuntu 8.10服务器版上安装那个版本的mono

2.  如果可能的话，谁能告诉我怎么做。不幸的是，我已经坚持了几天

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T17:59:22.160

IMO 最简单的解决方案是从源代码编译和安装它，没有太多依赖项，您应该能够轻松满足它们。因此，在下载并解压[最新的稳定源](http://download.mono-project.com/sources/mono/mono-2.10.8.tar.bz2)后，只需在其目录中执行以下操作：

```
./configure --prefix=/usr
make
sudo make install 
```

这是 ubuntu 的通常工作设置。接着

```
mono --version 
```

确认它确实有效。

# asp.net - .NET 使用 VB6 COM 组件

> ID：10288053
> 
> 赞同：0
> 
> 时间：2012-04-23T20:47:59.717
> 
> 标签：asp.net, vb6

我有一个 ASP.NET 应用程序，我想使用一个 VB6 组件。我知道我必须使用 ASPCOMPAT 标签。是否需要对 VB6 代码执行任何操作以使其线程安全？

我已经运行了一些测试，它似乎工作得很好，但是我在这里阅读了关于遇到问题的开发人员的评论，但没有详细说明这些评论。是否需要对 VB6 代码执行任何操作以确保它是线程安全的？这似乎太简单了。此外，我只将 ASPCONFIG 标记放在一个页面上 - 使用 COM 组件的页面。

我已经使用 tlbimport 工具在 Visual Studio 中导入了组件，该工具在 COM 对象周围放置了一个 .NETwrapper。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:43:37.040

VB6 代码的线程安全很大程度上取决于它是如何编写的。COM 的一个特殊“子集”被编写来隐藏 VB6 时代基于 COM 的开发所涉及的大部分硬管道，其中隐藏的部分是线程管理（多线程单元、单线程单元等）和VB6 运行时在后台处理线程。结果，如果您遵守规则，线程安全或多或少会为您处理好。

在大多数情况下，如果您试图深入研究独立的线程管理，例如调用 Windows API 函数在 VB6/COM“沙箱”之外创建线程，那么您就是在玩火，而且 .NET 方面的任何保护都不会它“线程安全”。这样做破坏了 VB6 故意试图隐藏的所有内部线程管理/编组/等代码。这几乎就是非托管（VB6/COM）和托管代码（.NET）世界之间区别的本质。

希望有帮助。

# objective-c - 导致错误的对象的内存地址，查找哪个对象

> ID：10288056
> 
> 赞同：0
> 
> 时间：2012-04-23T20:48:05.650
> 
> 标签：objective-c, ios

我的应用程序中出现 _WebThreadLockFromAnyThread 错误。它不会使我的应用程序崩溃（像这样的所有其他错误都会使我的应用程序崩溃）。

我无法追踪有问题的代码行在哪里。

我知道这个错误是当我尝试在辅助线程上更新 UI 时。我只使用 1 个线程，然后是主线程用于 KVO'ing。我用我所有的方法调用

```
[self foo] 
```

错误是：

```
void _WebThreadLockFromAnyThread(bool), 0xb29ca60: Obtaining the web lock from a thread other than the main thread or the web thread. UIKit should not be called from a secondary thread. 
```

每次执行时，错误都会出现在我的日志中，它会在这两个日志条目之间打印：

```
-(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    NSLog(@"observeValueForKeyPath thread%@", [NSThread currentThread]);

    if ([keyPath isEqualToString:MAXY])
    {
        NSLog(@"current tabDictionary:%@", self.tabDictionary); 
```

但应该与我的 if stmt 更改 UI 无关，所以我假设它发生在我程序的其他地方。

我可以使用它的内存地址来确定它是哪个对象吗？或者它正在尝试从哪个线程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T20:54:09.427

我猜它`tabDictionary`包含 UIViewController 的实例，并且您对 NSLog 的调用会导致访问视图控制器的属性以生成被记录的字符串。那是您在辅助线程上的 UIKit 访问。

当`observeValueForKeyPath:`被调用时，您无法保证您在哪个线程上。如果它很重要，你应该检查你是否在主线程上，如果不是，使用`performSelector:onMainThread:`or`dispatch_async`来确保你在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T20:53:46.850

> 我知道这个错误是当我尝试在辅助线程上更新 UI 时。

UI 更新不是线程安全的。每当您需要更新 UI 时，您都需要回调主线程以进行更改。如果您的方法有 0 或 1 个参数`GCD`，则有几个选项。`[[NSThread mainThread] performSelector:onThread:withObject:waitUntilDone:];`

# opencv - 使用 OpenCV haarcascade xml 的 Viola-Jones 检测算法

> ID：10288058
> 
> 赞同：2
> 
> 时间：2012-04-23T20:48:21.280
> 
> 标签：opencv, face-detection, viola-jones

我正在尝试实现 Viola Jones 检测器。因为我没有足够的图像或时间来训练分类器，所以我决定使用这些 OpenCV。

到目前为止，我能够将整体加载`haarcascade_frontface_alt.xml`到内存中的结构中，为快速面积求和创建积分图像并为检测器创建基本算法。但它根本没有按预期工作。

所以，如果有人知道 Viola Jones 检测器是如何工作的，并且知道 OpenCV 如何使用它的结构，请确认或否认我的假设：

1，积分图像以浮点值计算，范围从 0->1 表示白色
2，对于每个特征，您在其矩形内取面积，乘以权重并与所有矩形求和
3，如果总和 > 阈值，则将 left_val 求和此外，如果不使用 right_val
4，则阶段中所有分类器的总和大于 stage_threshold，它可能是人脸，因此继续下一个阶段，如果不是，则中断
5，对所有阶段、检测窗口和尺度重复...

到目前为止，我得到了各种检测到的区域，除了那些包含人脸的区域......

请，如果我对 openCV 级联使用的假设是错误的，请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T04:29:14.763

1.  是否使用 float 或 int 作为整数图像的数据类型并不重要，只要它允许您存储足够大的值以防止算术溢出。这些值不必标准化。归一化稍后在评估分类器期间完成（参见 3）。

2.  是的

3.  如果 sum * inverse_area < threshold * standard_deviation，left_val 被进一步求和，...（见下文）。

4.  是的

5.  是的

我建议您查看高级 OpenCV 端口，例如用 Java 编写的[JViolaJones](http://code.google.com/p/jviolajones/)或用于基于树桩的级联的[js-objectdetect](https://github.com/mtschirs/js-objectdetect/blob/master/js/objectdetect.js)，尤其是用于非树桩级联的 Haar.js，它们都是用 JavaScript 编写的，以便`computeSat()`更好[地](https://github.com/foo123/HAAR.js/blob/master/src/haar-detector.js)`detectSingleScale()`理解算法。优化的 OpenCV C/C++ 代码有点难以阅读。

# javascript - Sencha Touch 2.0 动态改变数据存储 extraParams

> ID：10288061
> 
> 赞同：0
> 
> 时间：2012-04-23T20:48:31.703
> 
> 标签：javascript, extjs, sencha-touch

我有 2 个带有选项的选择字段，这些选项通过 JSONP 代理从数据存储连接。我需要根据在第一个选择字段中选择的值更改第二个选择字段中的值。为此，我认为我应该根据在选择字段中选择的值更改代理 extraParams 中的参数。

我已经尝试了这篇文章中的 .getProxy() 方法[How can I change/add params on a store](https://stackoverflow.com/questions/6120713/how-can-i-change-add-params-on-a-store)但它不起作用。我在控制台中有一个错误：

```
Uncaught TypeError: Object function () {
                    return this.constructor.apply(this, arguments);
                } has no method 'getProxy' 
```

请参阅下面的代码和解释。任何想法如何做到这一点？

模型：

```
Ext.define('Providers.model.Provider', {    
extend: 'Ext.data.Model',    
config: {       
   fields: [
        {
            name: 'id',
            type: 'int'
        }, 
        {
            name: 'name',
            type: 'string'
        }
    ]
}
}); 
```

第一店：

```
Ext.define('Providers.store.ProvidersType', {    
extend: 'Ext.data.Store',
config: {
    model: 'Providers.model.Provider',
    proxy: {
        type: 'scripttag',
        url : 'http://example.com/providers/service.php',
        extraParams: {
            action: 'provider_types',
            username: 'test2',
            callback: '?',                      
            format: 'json'          
        },          
        reader: {
            type: 'json',
            rootProperty: 'providers'
        }
    },      
    autoLoad: true
}
}); 
```

2号店：

```
Ext.define('Providers.store.Countries', {    
extend: 'Ext.data.Store',
config: {
    model: 'Providers.model.Provider',
    proxy: {
        type: 'scripttag',
        url : 'http://example.com/providers/service.php',
        extraParams: {
            action: 'countries',
            username: 'test2',
            provider_type: 14, //<--- here should be value from first selectfield
            callback: '?',                      
            format: 'json'          
        },          
        reader: {
            type: 'json',
            rootProperty: 'countries'
        },          
    },
    autoLoad: true      
}
}); 
```

布局：

```
xtype: 'fieldset',
layout: 'vbox',                     
items: [                        
    {
        xtype: 'selectfield',
        id: 'selectType',           
        cls: 'combobox',
        store: 'ProvidersType',
        displayField: 'name',
        valueField: 'id',                           
        listeners: {
            change: function(field, value) {                                    
                if (value instanceof Ext.data.Model) {
                    value = value.get(field.getValueField());
                }
                console.log(value); //<-- get value works fine, how insert it in proxy param? 
                //Providers.store.Countries.getProxy().extraParams.provider_type = 10; <-- Do not work

            }
        }                           
    },                          
    {
        xtype: 'selectfield',   
        id: 'selectCountry',
        placeHolder: 'Country',
        cls: 'combobox',                        
        store: 'Countries',
        displayField: 'name',
        valueField: 'id'                            
    }

] 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T22:30:39.603

您可以创建一个新的存储实例并设置其代理，然后重置选择字段的存储。您可以将此代码添加到侦听器函数中：

```
newstore = Ext.create('Providers.store.Countries', {});
newstore.setProxy(
    {
        type: 'scripttag',
        url : 'http://example.com/providers/service.php',
        extraParams: {
            action: 'countries',
            username: 'test2',
            provider_type: value,
            callback: '?',                      
            format: 'json'          
        },          
        reader: {
            type: 'json',
            rootProperty: 'countries'
        },          
    }
);
newstore.load();

countrySelection = Ext.getCmp('selectCountry');
countrySelection.setStore(newstore); 
//OR: countrySelection.store = newstore; 
```

# pdf - 将 PDF 转换为干净的 SVG？

> ID：10288065
> 
> 赞同：121
> 
> 时间：2012-04-23T20:48:37.057
> 
> 标签：pdf, svg

我正在尝试将 PDF 转换为 SVG。但是，我目前使用的那个为每段文本中的每个字母映射一个路径，这意味着如果我更改其源文件中的文本，它看起来很难看。

我想知道最干净的 PDF 到 SVG 转换器是什么，希望它没有路径，它的文本区域根本不需要。众所周知，PDF 和 SVG 非常相似，所以我认为那里有一些不错的转换器。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-04-24T00:04:01.587

您只能在命令行上使用 Inkscape，而无需打开 GUI。试试这个：

```
inkscape \
  --without-gui \
  --file=input.pdf \
  --export-plain-svg=output.svg 
```

有关所有命令行选项的完整列表，请运行`inkscape --help`.

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2012-04-23T20:53:12.483

Wikipedia 上的许多人使用 Inkscape 将 PDF 转换为 SVG。

[http://inkscape.org/](http://inkscape.org/)

他们甚至有一个方便的指南，告诉你如何做到这一点！

[http://en.wikipedia.org/wiki/Wikipedia:Graphic_Lab/Resources/PDF_conversion_to_SVG#Conversion_with_Inkscape](http://en.wikipedia.org/wiki/Wikipedia:Graphic_Lab/Resources/PDF_conversion_to_SVG#Conversion_with_Inkscape)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-04-27T21:31:28.350

我目前正在使用[PDFBox](http://pdfbox.apache.org/)，它对图形输出有很好的支持。对提取矢量笔画和管理字体有很好的支持。有一些很好的工具可以试用（例如 PDFReader 将显示为 Java Graphics2D）。~~您可以使用像 Batik 这样的 SVG 工具截取图形工具（我这样做，它可以很好地捕捉）。~~

没有简单的方法将所有 PDF 转换为 SVG - 这取决于用于创建 PDF 的策略和工具。一些文本被转换为矢量，无法轻松重建 - 您必须安装矢量字体并查找它们。

更新：我现在已经将它开发成一个不再使用 Batik的[包 PDF2SVG ：](http://bitbucket.org/petermr/pdf2svg)

已经在一系列 PDF 上进行了测试。它产生 SVG 输出，包括

*   `<svg:text>`每个字符一个字符
*   路径为`<svg:path>`
*   图像为`<svg:image>`

~~以后的包将（希望）将字符转换为运行文本，并将路径转换为更高级别的图形对象~~

更新：我们现在可以从 SVG 字符重新创建运行文本。我们还将图表转换为特定领域的 XML（例如化学光谱）。请参阅[https://bitbucket.org/petermr/svg2xml-dev](https://bitbucket.org/petermr/svg2xml-dev)。它仍处于 Alpha 状态，但正在以有用的速度移动。任何人都可以加入！

更新。（@Tim Kelty）我们将继续研究 PDF2SVG 以及执行（有限）Java OCR 和创建更高级别图形基元（箭头、框等）的下游工具。请参阅[https://bitbucket.org/petermr/图像分析](https://bitbucket.org/petermr/imageanalysis) [https://bitbucket.org/petermr/diagramanalyzer](https://bitbucket.org/petermr/diagramanalyzer) [https://bitbucket.org/petermr/norma](https://bitbucket.org/petermr/norma)和[https://bitbucket.org/petermr/ami-core](https://bitbucket.org/petermr/ami-core)。这是一个资助项目，旨在从科学文献 (contentmine.org) 中获取 1 亿个事实，其中大部分是 PDF。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2015-02-05T22:41:13.680

这个话题很老了，但这是我发现的一个方便的解决方案：

[http://www.cityinthesky.co.uk/opensource/pdf2svg/](http://www.cityinthesky.co.uk/opensource/pdf2svg/)

它提供了一个工具，pdf2png，一旦安装，它就可以在命令行中完成工作。到目前为止，我已经以无可挑剔的结果对其进行了测试，包括位图。

编辑：我的错误，这个工具也将字母转换为路径，所以它没有解决最初的问题。但是无论如何它做得很好，并且对于不打算修改 svg 文件中的代码的任何人都可能有用，所以我将离开这个帖子。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-05-29T20:18:04.840

这是我最终使用的过程。我使用的主要工具是 Inkscape，它能够很好地转换文本。

*   使用带有 JavaScript 的 Adob​​e Acrobat Pro 操作来拆分 PDF 表
*   从 Windows Cmd 运行 Inkscape Portable 0.48.5 以转换为 SVG
*   通过使用 Windows Cmd 和 Windows PowerShell 对我遇到问题的特定 SVG XML 属性进行了一些手动编辑

# 单独的页面：带有 JavaScript 的 Adob​​e Acrobat Pro

使用 Adob​​e Acrobat Pro 操作（以前称为批处理）创建自定义操作以将 PDF 页面分隔为单独的文件。或者，您可以使用 GhostScript 拆分 PDF

### 用于拆分页面的 Acrobat JavaScript 操作

```
/* Extract Pages to Folder */

var re = /.*\/|\.pdf$/ig;
var filename = this.path.replace(re,"");

{
    for ( var i = 0;  i < this.numPages; i++ )
    this.extractPages
     ({
        nStart: i,
        nEnd: i,
        cPath : filename + "_s" + ("000000" + (i+1)).slice (-3) + ".pdf"
    });
}; 
```

# PDF 到 SVG 转换：Inkscape 与 Windows CMD 批处理文件

使用 Windows Cmd 创建的批处理文件循环浏览文件夹中的所有 PDF 文件并将它们转换为 SVG

### 在当前文件夹中将 PDF 转换为 SVG 的批处理文件

```
:: ===== SETUP =====
@echo off
CLS
echo Starting SVG conversion...
echo.

:: setup working directory (if different)
REM set "_work_dir=%~dp0"
set "_work_dir=%CD%"

:: setup counter
set "count=1"

:: setup file search and save string
set "_work_x1=pdf"
set "_work_x2=svg"
set "_work_file_str=*.%_work_x1%"

:: setup inkscape commands
set "_inkscape_path=D:\InkscapePortable\App\Inkscape\"
set "_inkscape_cmd=%_inkscape_path%inkscape.exe"

:: ===== FIND FILES IN WORKING DIRECTORY =====
:: Output from DIR last element is single  carriage return character. 
:: Carriage return characters are directly removed after percent expansion, 
:: but not with delayed expansion.

pushd "%_work_dir%"
FOR /f "tokens=*" %%A IN ('DIR /A:-D /O:N /B %_work_file_str%') DO (
    CALL :subroutine "%%A"
)
popd

:: ===== CONVERT PDF TO SVG WITH INKSCAPE =====

:subroutine
echo.
IF NOT [%1]==[] (

    echo %count%:%1
    set /A count+=1

    start "" /D "%_work_dir%" /W "%_inkscape_cmd%" --without-gui --file="%~n1.%_work_x1%" --export-dpi=300 --export-plain-svg="%~n1.%_work_x2%"

) ELSE (
    echo End of output
)
echo.

GOTO :eof

:: ===== INKSCAPE REFERENCE =====

:: print inkscape help
REM "%_inkscape_cmd%" --help > "%~dp0\inkscape_help.txt"
REM "%_inkscape_cmd%" --verb-list > "%~dp0\inkscape_verb_list.txt" 
```

# 清理属性：Windows Cmd 和 PowerShell

我意识到由于潜在的变化，手动蛮力编辑 SVG 或 XML 标签或属性并不是最佳实践，应该使用 XML 解析器。但是我遇到了一个简单的问题，其中一张图的笔画宽度非常小，而另一张图的字体系列被错误识别，所以我基本上修改了以前的 Windows Cmd 批处理脚本来进行简单的查找和替换。唯一的更改是搜索字符串定义和更改为调用 PowerShell 命令。PowerShell 命令将执行查找和替换，并使用添加的后缀保存修改后的文件。如果需要执行一些其他小的清理，我确实找到了一些其他参考资料，这些参考资料可以更好地用于解析或修改生成的 SVG 文件。

### 手动查找和替换 SVG XML 数据的修改

```
:: setup file search and save string
set "_work_x1=svg"
set "_work_x2=svg"
set "_work_s2=_mod"
set "_work_file_str=*.%_work_x1%" 
```

`powershell -Command "(Get-Content '%~n1.%_work_x1%') | ForEach-Object {$_ -replace 'stroke-width:0.06', 'stroke-width:1'} | ForEach-Object {$_ -replace 'font-family:Times Roman','font-family:Times New Roman'} | Set-Content '%~n1%_work_s2%.%_work_x2%'"`

希望这可以帮助某人

# 参考

### Adobe Acrobat Pro 操作和 JavaScript 对单独页面的引用

*   [如何自动从 PDF 中提取页面...](https://stackoverflow.com/a/30513739/4459336)
*   [适用于 Acrobat API 的 JavaScript 参考 - extractPages](http://help.adobe.com/livedocs/acrobat_sdk/9.1/Acrobat9_1_HTMLHelp/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Acrobat9_HTMLHelp&file=JS_API_AcroJS.88.465.html)
*   [提取页面以分隔pdf（循环有问题吗？）](https://forums.adobe.com/thread/969135?tstart=0)
*   [如何使用 JavaScript 创建 Zerofilled 值？](https://stackoverflow.com/questions/1267283/how-can-i-create-a-zerofilled-value-using-javascript)
*   [如何在 JavaScript 中输出带有前导零的整数](https://stackoverflow.com/questions/2998784/how-to-output-integers-with-leading-zeros-in-javascript)

### GhostScript 对单独页面的引用

*   [GhostScript noob 帮助 - 破坏多页 PDF 文件...](https://superuser.com/questions/225907/ghostscript-noob-help-breaking-a-multipage-pdf-file-into-many-single-page-ps-o)
*   [如何转换多页PDF文件...](https://superuser.com/questions/243461/how-to-convert-a-multi-page-pdf-file-to-png-files-with-one-png-file-per-page-of)
*   [使用 Ghostscript 分割 PDF](https://stackoverflow.com/questions/10228592/splitting-a-pdf-with-ghostscript)

### PDF 到 SVG 转换的 Inkscape 命令行参考

*   [将pdf转换为svg](https://stackoverflow.com/questions/4120567/convert-pdf-to-svg)
*   [将 PDF 转换为干净的 SVG？](https://stackoverflow.com/questions/10288065/convert-pdf-to-clean-svg)

### Windows Cmd 批处理文件脚本参考

*   [Windows批处理文件的隐藏功能](https://stackoverflow.com/questions/245395/hidden-features-of-windows-batch-files)
*   [SS64.com - Windows CMD 命令行的索引](http://ss64.com/nt/)
*   [为什么这个批处理脚本中的 FOR /f 循环评估一个空行？](https://stackoverflow.com/questions/8015489/why-is-the-for-f-loop-in-this-batch-script-evaluating-a-blank-line)

### XML标签/属性替换研究

*   [如何使用 Windows 命令行环境查找和替换文件中的文本？](https://stackoverflow.com/a/20999154/4459336)
*   [使用 Windows 批处理文件更改 XML 文件中的标记数据](https://stackoverflow.com/questions/17054275/changing-tag-data-in-an-xml-file-using-windows-batch-file)
*   [从命令行更新 XML [windows]](https://serverfault.com/questions/26976/update-xml-from-the-command-line-windows)
*   [如何使用 PowerShell 在 XML 文件中修改/创建值？](https://superuser.com/questions/560329/how-to-modify-create-values-in-xml-files-using-powershell)
*   [使用 Powershell 编辑 XML 属性](https://stackoverflow.com/questions/24866339/editing-xml-attributes-using-powershell)
*   [powershell 更改 XML Element 属性的值](https://stackoverflow.com/questions/24679454/powershell-change-the-value-of-xml-element-attribute)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-06-03T08:42:45.977

如果 DVI 到 SVG 是一个选项，您还可以使用[dvisvgm](http://dvisvgm.sourceforge.net/)将 DVI 文件转换为 SVG 文件。例如，这对于 LaTeX 公式（带有选项`--no-fonts`）非常有效：

```
dvisvgm --no-fonts input.dvi -o output.svg 
```

还有[pdf2svg](http://www.cityinthesky.co.uk/opensource/pdf2svg)使用 poppler 和 Cairo 将 pdf 转换为 SVG。当我尝试这个时，SVG 完美呈现在`inkscape`.

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-12-06T16:02:33.557

用于将 PDF 的每一页转换为自己的 SVG 文件的 Bash 脚本。

```
#!/bin/bash
#
#  Make one PDF per page using PDF toolkit.
#  Convert this PDF to SVG using inkscape
#

inputPdf=$1

pageCnt=$(pdftk $inputPdf dump_data | grep NumberOfPages | cut -d " " -f 2)

for i in $(seq 1 $pageCnt); do
    echo "converting page $i..."
    pdftk ${inputPdf} cat $i output ${inputPdf%%.*}_${i}.pdf
    inkscape --without-gui "--file=${inputPdf%%.*}_${i}.pdf" "--export-plain-svg=${inputPdf%%.*}_${i}.svg"
done 
```

要在 png 中生成，请使用`--export-png`等...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-03-14T14:20:29.530

我发现它`xfig`做得很好：

```
pstoedit -f fig foo.pdf foo.fig
xfig foo.fig

export to svg 
```

它比inkscape做得更好。实际上可能是 pdtoedit 做到了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-03T08:22:36.290

这是两个 PDF 渲染脚本的 NodeJS REST api。 [https://github.com/pumppi/pdf2images](https://github.com/pumppi/pdf2images)

脚本是：pdf2svg 和 Imagemagicks 转换

# ruby-on-rails-3 - Rails 3 ActiveRecord 类方法

> ID：10288067
> 
> 赞同：0
> 
> 时间：2012-04-23T20:48:51.240
> 
> 标签：ruby-on-rails-3, activerecord

在我编写更好的模型方法的微弱尝试中，我失败了。这反过来又让我在这里问我的问题。

这是我的模型：

```
class Group < ActiveRecord::Base
  # Because of inheritance issues with ActiveRecord
  # We tell this Relation to use a "false" column to persuade
  # The relation to push forward without worrying about Inheritance
  self.inheritance_column = :_type_disabled

  scope :expired?, where('expiration_date > ?', Time.now)
end 
```

这就是我试图用我的`scope`

```
g = Group.find(91)
g.expired? 
```

所以，基本上看看我是否可以判断该组是否已过期。现在，我知道我可以在我的控制器中的 activerecord where 语句中写这个，但我试图更好地理解处理模型中的数据`Rails`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:10:01.403

据我所知，您`g.expired?`正在寻找*实例方法*，因此您可以使用[scope](http://guides.rubyonrails.org/active_record_querying.html#scopes)。它有不同的用途。所以，如果你真的想要一个实例方法，你应该这样做：

```
class Group < ActiveRecord::Base

  def expired?
    self.expiration_date > Time.now
  end
end 
```

顺便说一句，如果你想要所有过期的组，那么你就在正确的路径上。但请注意，您需要一个 lambda 来正确评估查询：

```
scope :expired, lambda { where('expiration_date > ?', Time.now) } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T21:10:47.377

那不是作用域的用途；)

要做你想做的，只需添加一个实例方法：

```
def expired?
    expiration_date > Time.now
end 
```

范围将`expired`用于选择过期组：

```
scope :expired, lambda { where('expiration_date > ?', Time.now) } 
```

你会这样使用它：

```
Group.expired
# or
user.groups.expired
#etc 
```

# c# - 在 WPF 中居中新对话框窗口

> ID：10288071
> 
> 赞同：0
> 
> 时间：2012-04-23T20:49:01.083
> 
> 标签：c#, wpf, dialog, window

所以我在一个窗口中有一个用户控件，当单击一个按钮时，它会创建一个新的对话框窗口。我希望窗口出现在调用它的窗口的顶部。我试着这样做...

```
 NewDialog dlg = new NewDialog();
        dlg.WindowStartupLocation = WindowStartupLocation.CenterOwner;
        dlg.ShowDialog(); 
```

问题是所有者似乎不是调用窗口（可能是因为用户控件正在调用而不是实际窗口？）。所以我尝试添加这个......

```
 dlg.Owner = Application.Current.Windows[0]; 
```

这主要是可行的，但它不是一个通用的解决方案，因为有时我的新窗口必须调用一个新窗口，我希望它们以调用窗口为中心，而不是主窗口。有没有更好的方法将所有者正确设置为用户控件所属的窗口？我尝试了许多变体，这些变体似乎都有一些怪癖，即窗口出现在完全不同的位置，或者某些东西评估不正确并引发错误。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:04:25.790

如果`this`不是类型，则`Window`使用静态[Window.GetWindow 方法](http://msdn.microsoft.com/en-us/library/system.windows.window.getwindow.aspx)获取宿主窗口。

```
dlg.Owner = Window.GetWindow(this); 
```

# assembly - 8086 程序集 (TASM)：将 ASCII 字符值显示为 HEX

> ID：10288073
> 
> 赞同：1
> 
> 时间：2012-04-23T20:49:01.130
> 
> 标签：assembly, hex, x86-16, tasm

** 为澄清和“更清洁”的代码而编辑。

我正在尝试从键盘接受一个字符（任何字符）并将其 ASCII 值转换为十六进制，然后显示它。

我知道如何从基数 10 转换为十六进制，但只是为了确保我没有使用不正确的术语：

如果我输入“c”作为我的 ASCII 值，它的十进制值为 63。63 除以 16（十六进制为 16 进制）= 3.9375。保存 3 的商以备后用。余数 * 基数 (.9375 * 16) = 15。15 是十六进制字符“F”。

商除以基数 (3 / 16) = 0.1875。商为零，所以这是转换的最后一步。余数 * 基数 (.1875 * 16) = 3

从后到前读取它们（“先进后出”，如果考虑堆栈），我得到“3F”作为十进制数“63”的十六进制值（这是“c”的ASCII）

这是正确的，是吗？

我希望它读起来很简单。我只是从键盘（AL）中获取字符，将 BX 设置为除数（以 16 为基数），然后将 AL 除以 BX，将余数存储在堆栈中，然后循环遍历堆栈并尝试显示它.. .

我认为我的问题是我的乘法和我的 INT 21H/02H 有问题。我不确定是否需要添加 30h 才能显示字符...

最重要的是，我什至不确定我是否需要在那一点（显示），因为我还没有弄清楚如何将 10-15 转换为十六进制的 AF。

我试着和我的老师说话，在等了 30 分钟让他完成和我班上另一群学生的谈话之后（关于他的另一个班的东西，而不是这个……这让我很恼火），我得到的最多的是“重新开始”。

当被问及“使用 SHR 和 SHL 怎么样？” 正如有人向我指出的那样，但有人告诉我，没有它也可以完成，而且我不能使用这些命令（课堂上没有介绍它们）。

关于我做错了什么的任何意见？谢谢！

```
 CHAR2HEX PROC                   ; Accept a character, print it's ascii value in hex.

        MOV DX, OFFSET AskChar      ; Display prompt
        MOV AH, 09H
        INT 21H

        MOV AX, 0                   ; Clear AX

        MOV AH, 07H                 ; Get keyboard input w/ no echo (AL)
        INT 21H

        MOV BX, 16                  ; Set up the divisor (base 16)
        MOV CX, 0                   ; Initialize the counter
        MOV DX, 0                   ; Clear DX

        Divide:                         
                                    ; Dividend (what's being divided) in DX/AX pair, Quotient in AX, Remainder in DX.
            DIV BX                  ; Divide (will be word sized).
            PUSH AX                 ; Save DX (the remainder) to stack.

            ADD CX, 1               ; Add one to counter

            MOV DX, 0               ; Clear Remainder (DX)
            CMP AX, 0               ; Compare Quotient (AX) to zero
            JNE Divide              ; If AX not 0, go to "Divide:"

        Multiply:
                                    ; Multiply remainder (from stack) by 16 to get hex value.               
            MOV DX, 0               ; Clear DX           
            POP AX                  ; Get remainder from stack into AX.

            MUL BX                  ; Multiply AX * BX.  (DX= high order bits, AX = low order bits)
            MOV DX, AX

            SUB DL, 30h             ; ADD 30h to DL 
            MOV AH, 02h             ; 02h to display AH (DL)
            INT 21H                 ; Send to DOS

            LOOP Multiply           ; If more to do, Multiply again
                                    ; LOOP subtracts 1 from CX. If non-zero, loop.
            RET
    CHAR2HEX ENDP
END START 
```

****已编辑******

 **我终于明白了！我能够让程序返回在键盘上按下的 ascii 字符的十六进制值，但它仅在每个余数为 0 到 9 时才有效。它不会显示 A 到 F，而是使用冒号，分号等...

我在网上查看了一个 Ascii/Deicmal/Hex 图表，注意到字符 0 到 9 是 30h 到 39h。但是字符 A（十六进制 10）直到 40 小时才开始。所以我改变了程序，如果该值大于 39h，它将 7h 添加到 DL 并显示它。

```
 CHAR2HEX PROC                   ; Accept a character, print it's ascii value in hex.

        MOV DX, OFFSET AskChar      ; Display prompt
        MOV AH, 09H
        INT 21H

        MOV AH, 07H                 ; Get keyboard input w/ no echo (AL)
        INT 21H

        MOV CL, AL                  ; Copy user input (AL) to CL
        MOV AX, 0                   ; Clear AX (get rid of HO bits)
        MOV AL, CL                  ; Copy user input back into AL

        MOV BX, 16                  ; Set up the divisor (base 16)
        MOV CX, 0                   ; Initialize the counter
        MOV DX, 0                   ; Clear DX

        Div2:                         
                                    ; Dividend (what's being divided) in DX/AX pair, Quotient in AX, Remainder in DX.
            DIV BX                  ; Divide (will be word sized).
            PUSH DX                 ; Save DX (the remainder) to stack.

            ADD CX, 1               ; Add one to counter
            MOV DX, 0               ; Clear Remainder (DX)
            CMP AX, 0               ; Compare Quotient (AX) to zero
            JNE Div2              ; If AX not 0, go to "Div2:"

        getHex2:
            MOV DX, 0               ; Clear DX.
            POP DX                  ; Put top of stack into DX.
            ADD DL, 30h             ; Conv to character.

            CMP DL, 39h
            JG MoreHex2

        HexRet2:        

            MOV AH, 02h             ; 02h to display AH (DL)
            INT 21H                 ; Send to DOS

            LOOP getHex2            ; If more to do, getHex2 again
                                    ; LOOP subtracts 1 from CX. If non-zero, loop.
            JMP Skip2
        MoreHex2:
            ADD DL, 7h
            JMP HexRet2             ; Return to where it left off before adding 7h.
        Skip2:
            RET
    CHAR2HEX ENDP 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:20:31.453

首先用 C 或其他语言编写程序。不要使用语言库，例如不要使用 printf("%x\n",number) 来显示十六进制，而是按照您的建议将数字重复除以 10，将它们保存在某处。现在记住除以十的余数（模数）介于 0-9 之间，以便在 ascii 中的某处显示，您需要添加 0x30，如您所提到的。123变成12余数3，然后12变成1余数2，1变成0余数1，1+0x30 = 0x31显示那个2+0x30变成0x32显示那个，3+0x30变成0x33显示那个。

十六进制也不例外，基数是 16 而不是 10。正如 vhallac 所提到的，尽管您可以屏蔽和移位而不是使用除法运算符。

一旦你让“程序”在 C 或其他语言中工作，在低级别使用基本操作（加、减、除、移位和或等），然后用汇编语言重新编写该代码。

最终你可能会达到不需要用其他语言证明你的程序并从 asm 开始的地步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:00:04.340

您的以 10 为底的转换逻辑看起来不错：除以 10 的每个余数都会给您一个数字，并且它们将从最低有效位到最高有效位排序，因此您需要在打印之前反转获得的数字。将它们推入堆栈并在完成后弹出它们将以一种很好且紧凑的方式进行反转。

转换为十六进制，操作相同：除以 16，取余数，反转，打印。但是，有几点需要注意：除以 16 是右移 4 位。余数是`value AND 0fH`，因此您实际上不需要任何算术运算。位移和`AND`操作就足够了。此外，您甚至不需要涉及堆栈。您可以从最重要的半字节（四位）到最不重要的半字节执行此操作，并在计算时打印。您似乎正在努力解决的第二件事是将半字节转换为十六进制数字。仅仅添加`30h`是不够的。对于小数来说已经足够了，但对于十六进制值，你也可以得到 10 到 15 的数字。这些需要添加到`41h`（ASCII 中的“A”）减去 10。或者，您可以将数字 '0' 到 '9' 和 'A' 到 'F' 放在一个表中，并按要打印的半字节的值对它们进行索引。

您可能还想编写一个从输入中读取数字的例程。读取每个数字，直到您读取换行符，将字符转换为十进制值，并更新将保留您已读取的数字的累加器。您需要将它用于十六进制和十进制输出函数。**

# php - 用python从字符串中删除php标签

> ID：10288074
> 
> 赞同：1
> 
> 时间：2012-04-23T20:49:02.303
> 
> 标签：php, python

我想从字符串中删除 php 标签

```
content = re.sub('<\?php(.*)\?>', '', content) 
```

似乎在单行 php 标签上工作正常，但是当 php 标签在 之后关闭一些行时，它无法捕获它。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:54:44.873

你不能用正则表达式解决这个问题。从字符串中解析 PHP 需要一个真正的解析器，该解析器至少懂一点 PHP。

**但是，如果您有可用的 PHP，您可以很容易地解决这个问题。**最后的PHP解决方案。

这里展示了你的正则表达式方法有多少种方法会出错：

```
import re

testcases = {
    'easy':("""show this<?php echo 'NOT THIS'?>""",'show this'),
    'multiple tags':("""<?php echo 'NOT THIS';?>show this, even though it's conditional<?php echo 'NOT THIS'?>""","show this, even though it's conditional"),
    'omitted ?>':("""show this <?php echo 'NOT THIS';""", 'show this '),
    'nested string':("""show this <?php echo '<?php echo "NOT THIS" ?>'?> show this""",'show this  show this'),
    'shorttags':("""show this <? echo 'NOT THIS SHORTTAG!'?> show this""",'show this  show this'),
    'echotags':("""<?php $TEST = "NOT THIS"?>show this <?=$TEST?> show this""",'show this  show this'),
}

testfailstr = """
FAILED: %s
IN:     %s
EXPECT: %s
GOT:    %s
"""

removephp = re.compile(r'(?s)<\?php.*\?>')

for testname, (in_, expect) in testcases.items():
    got = removephp.sub('',in_)
    if expect!=got:
        print testfailstr % tuple(map(repr, (testname, in_, expect, got))) 
```

请注意，要让正则表达式通过所有测试用例，即使不是不可能，也是极其困难的。

**如果您有可用的 PHP，您可以使用 PHP 的标记器来去除 PHP。** 以下代码应该从字符串中删除*所有**PHP*代码，并且应该涵盖所有奇怪的极端情况。

 *```
// one-character token, always code
define('T_ONECHAR_TOKEN', 'T_ONECHAR_TOKEN');

function strip_php($input) {
    $tokens = token_get_all($input);

    $output = '';
    $inphp = False;
    foreach ($tokens as $token) {
        if (is_string($token)) {
            $token = array(T_ONECHAR_TOKEN, $token);
        }
        list($id, $str) = $token;
        if (!$inphp) {
            if ($id===T_OPEN_TAG or $id==T_OPEN_TAG_WITH_ECHO) {
                $inphp = True;
            } else {
                $output .= $str;
            }
        } else {
            if ($id===T_CLOSE_TAG) {
                $inphp = False;
            }
        }
    }

    return $output;
}

$test = 'a <?php //NOT THIS?>show this<?php //NOT THIS';

echo strip_php($test); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:13:51.963

如果你只想处理简单的情况，一个简单的正则表达式就可以了。`*?`Python 正则表达式中的运算符给出了最小匹配。

```
import re

_PHP_TAG = re.compile(r'<\?php.*?\?>', re.DOTALL)
def strip_php(content):
    return _PHP_TAG.sub('', content)

INPUT = """
Simple: <?php echo $a ?>.
Two on one line: <?php echo $a ?>, <?php echo $b ?>.
Multiline: <?php 
    if ($a) {
        echo $b;
    }
?>.
"""

print strip_php(INPUT) 
```

输出：

```
简单的： 。
二合一：（保留这个）。
多行：.

```

**我希望您没有使用它来清理输入，**因为这不足以达到此目的。（这是黑名单，不是白名单，黑名单永远不够。）

如果要处理复杂的情况，例如：

```
<?php echo '?>' ?> 
```

您仍然可以使用正则表达式来做到这一点，但您可能希望重新考虑您使用的工具，因为正则表达式可能太复杂而无法阅读。以下正则表达式将处理 Francis Avila 的所有测试用例：

```
dstr = r'"(?:[^"\\]|\\.)*"'
sstr = r"'(?:[^'\\]|\\.)*'"
_PHP_TAG = re.compile(
    r'''<\?[^"']*?(?:(?:%s|%s)[^"']*?)*(?:\?>|$)''' % (dstr, sstr)
)
def strip_php(content):
    return _PHP_TAG.sub('', content) 
```

**正则表达式**几乎足以解决这个问题。我们之所以知道这是因为 PHP 使用正则表达式来标记 PHP 源代码。您可以阅读 PHP 在`Zend/zend_language_scanner.l`. 它是为 Lex 编写的，这是一个从正则表达式创建标记器的常用工具。

我说“几乎”的原因是因为我们实际上是在使用扩展的正则表达式。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-23T21:12:07.797

您可以通过以下方式做到这一点：

```
content = re.sub('\n','', content)
content = re.sub('<\?php(.*)\?>', '', content) 
```

**OP评论后更新的答案：**

```
content = re.sub('\n',' {NEWLINE} ', content)
content = re.sub('<\?php(.*)\?>', '', content)
content = re.sub(' {NEWLINE} ','\n', content) 
```

例如`ipython`：

```
In [81]: content
Out[81]: ' 11111  <?php 222\n\n?> \n22222\nasd  <?php asd\nasdasd\n?>\n3333\n'

In [82]: content = re.sub('\n',' {NEWLINE} ', content)
In [83]: content
Out[83]: ' 11111  <?php 222 {NEWLINE}  {NEWLINE} ?>  {NEWLINE} 22222 {NEWLINE} asd  <?php asd {NEWLINE} asdasd {NEWLINE} ?> {NEWLINE} 3333 {NEWLINE} '

In [84]: content = re.sub('<\?php(.*)\?>', '', content)
In [85]: content
Out[85]: ' 11111   {NEWLINE} 3333 {NEWLINE} '

In [88]: content = re.sub(' {NEWLINE} ','\n', content)
In [89]: content
Out[89]: ' 11111  \n3333\n' 
```*

# c# - 快速计算输入数字的最小值、最大值和平均值

> ID：10288076
> 
> 赞同：36
> 
> 时间：2012-04-23T20:49:07.820
> 
> 标签：c#, performance, algorithm

程序每秒接收大约 50,000 个号码。

在任何给定时刻，我都需要计算在最后一秒（关于给定时刻）到达的值（数字）的最小值、最大值和平均值。

有没有办法在不使用数组或列表（缓冲区）存储到达的数字和计算结果的情况下做到这一点？

如果我需要使用缓冲区，那么实现这一目标的有效方法是什么？

（请注意，缓冲区中的数字也必须不时有效地删除）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-23T20:57:21.600

这是一种算法，在某些情况下可以提高效率：

1.  当事件进入时，将它们完全缓冲，并计算一个运行的`sum`, `count`, `min`, `max`（微不足道的）。

2.  当请求`average`,`min`或`max`时，从缓冲区的后面循环并开始删除早于一秒的值。减去`sum`和`count`当你去。

    *   如果这些值都在上面，`min`你可以保留你的`min`. 如果值低于`max`，您可以保留您的`max`. 在这种情况下，您已经有效地更新了`average`、`min`和。`max`

    *   如果值低于`min`或高于`max`，您将需要遍历数组的其余部分并重新计算它。

3.  每秒执行一次第二步左右，这样缓冲区就不会太满。该代码也可以在每个缓冲区插入上执行，或者在任何有意义的地方执行。

这种工作的最佳结构是循环缓冲区，以避免内存分配和 GC 妨碍。它应该足够大以涵盖每秒消息大小的最坏情况。

**更新**

根据使用场景，另一件事是运行上面的算法，但以 10 x 100ms 块而不是 1 x 1000ms 块运行。也就是说，在这 10 个块上保持运行的 min、max、sum 和 count。然后，当您遇到“无效”情况时，您通常只需要查看最新的 100ms 数据或快速浏览其他 9 个块的最小值和最大值。

* * *

@ja72 提供了一个好主意，如果它们无效，可以节省查找最小值和最大值：

x_max 不是保留最小值/最大值 x_min，而是使用 i_min 和 i_max 保留它们在 x[i] 数组中的位置索引。然后找到它们有时可能是微不足道的，但是当考虑的最后一个值包含最小值和最大值时，需要扫描整个列表以建立新的限制。

* * *

Sam Holder 在评论中有另一个好主意 - 保持一个始终排序的并行数组，这让您可以将数字从顶部或底部剔除，以便更轻松地找到新的最小值和最大值。但是，此处的插入速度会受到一点影响（需要保持有序）。

* * *

**最终**，正确的选择将取决于程序的使用特性。读取值的频率与插入的频率？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-23T20:58:14.583

使用具有时间戳和数据的每个元素的循环缓冲区，每秒元素的最大数量作为循环缓冲区的大小。

当每个元素都插入缓冲区头时，检查缓冲区另一侧的过期时间，删除该元素。

如果删除的元素是最小值或最大值，则必须计算新的最小值/最大值。如果不是，您将根据新来者更新最小/最大值。

对于平均值，保留总数，保留计数，然后除法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T20:53:52.030

您不能将您的号码及其到达时间以及队列中当前的最大值和最小值（可能需要将值的数量保持在相同的最小值/最大值）和所有的总值保持一个队列队列中的数字和元素计数。

然后当一个数字到达时将其添加到队列中并调整最小/最大值/值和计数。然后查看队列的另一端，将最后一个数字到达后1秒内没有的元素全部移除，再次调整max/min/count/total值。

然后你不需要立即计算任何东西，只需返回预先计算的东西（即读取最小/最大值或总计/计数的当前值）

正如@yaman 指出的那样，您不能只保留最小值和最大值，因为当一个被删除时，您可能不知道新的。在这种情况下，我可能只保留列表中所有数字的第二份副本，而不是按到达时间排序，而是按值排序。然后，您也只需从该列表中添加和删除每个数字，因此您将始终知道最大值和最小值。这使您不必扫描缓冲区中的所有元素以找到新的最大值/最小值，但代价是保留 2 个副本，但此列表的更新应该很便宜，因为它已经订购了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-23T21:02:28.520

如果最后一个值的`N`平均值`x[0]`..`x[N-1]`是`m_1`（`x[0]`是最新值，并且`x[N-1]`是考虑的最后一个值），那么`m_2`将所有值推回一个索引并添加该值的值的平均值`x`是

```
 m_2 = m_1+(x-x[N-1])/N;
 for(i=N-1;i>0;i--) { x[i]=x[i-1]; }
 x[0] = x; 
```

与其保持最小值/最大值`x_min`，不如使用和`x_max`保持它们在`x[i]`数组中的位置索引。然后找到它们有时可能是微不足道的，但是当考虑的最后一个值包含最小值和最大值时，需要扫描整个列表以建立新的限制。`i_min``i_max`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-24T00:22:25.977

有一种有效的方法可以跟踪给定时间窗口内的最小值（或最大值），而*通常*不必存储在该窗口内到达的所有数字。（但是，最坏的情况仍然需要存储所有数字，因此您需要为所有数字保留空间，或者接受您有时可能会得到不正确的结果。）

诀窍是只存储以下值：

1.  已在时间窗口内到达，并且
2.  小于（或大于）任何以后的值。

实现这一点的合适数据结构是一个简单的循环缓冲区，用于存储值及其到达时间。您需要在缓冲区中维护两个索引。以下是该算法的简单英文描述：

*启动时：*

*   分配一个*N*元素的值缓冲区`val`和一个对应的*N*元素的时间戳缓冲区`time`。
*   让`imax`= 0（或 0 和*N* -1 之间的任何其他值）并且让`inext`= `imax`。这表明缓冲区当前是空的。

*在 time 收到新值* `new` *时* `t`*：*

*   当`imax`≠`inext`和`time[imax]`在区间外时，加`imax`一（模*N*）。
*   当`imax`≠`inext`和`val[inext-1]`≥`new`时，减`inext`一（模*N*）。
*   让`val[inext]`=`new`和`time[inext]`= `t`。
*   如果`inext`≠ `imax-1`，则加`inext`一（模*N*）；否则适当地处理“缓冲区已满”的情况（例如分配一个更大的缓冲区，抛出一个异常，或者只是忽略它并接受最后一个值没有正确记录）。

*当请求最小值时：*

*   当`imax`≠`inext`和`time[imax]`在区间外时，加`imax`一（模*N*）。
*   如果`imax`≠ `inext`，则返回`val[imax]`；否则返回一个错误，表明在时间间隔内没有收到任何值。

如果接收到的值是独立且同分布的（并且作为泊松过程到达），我相信可以证明在任何给定时间存储在列表中的值的平均数是 ln( *n* +1)，其中*n*是在时间间隔内接收到的值的平均数。对于*n* = 50,000，ln( *n* +1) ≈ 10.82。但是，应该记住，这只是平均值，有时可能需要多几倍的空间。

* * *

对于平均而言，不幸的是，同样的技巧不起作用。如果可能的话，您可以切换到[指数移动平均线](http://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average)，它可以使用非常小的空间轻松跟踪（平均只有一个数字和一个指示上次更新时间的时间戳）。

如果这是不可能的，但您愿意接受平均值的少量平滑，您可以计算一个平均值，例如，每毫秒。这样，每当请求最后一秒的平均值时，您可以取最后 1001 毫秒平均值的平均值，根据间隔内的毫秒数来衡量最旧和最新的平均值：

*启动时：*

*   让*interval*是要平均的时间间隔的长度，让*n*是子间隔的数量。
*   令*dt* =*区间*/ *n*。
*   分配一个*n* +1 元素`sum`的值缓冲区和一个*n* +1 元素`cnt`的非负整数缓冲区，并用零填充两者。
*   让`prev`有任何价值。（这并不重要。）

*在 time 收到新值* `new` *时* `t`*：*

*   让`i`= floor( `t`/ *dt* ) mod ( *n* +1)。
*   如果`i`≠ `prev`：
    *   `sum[i]`从`total`和`cnt[i]`中减去`count`。
    *   让`sum[i]`= 0, `cnt[i]`= 0 和让`prev`= `i`。
*   加`new`一并`sum[i]`递增`cnt[i]`。
*   加`new`一并`total`递增`count`。

*当在 time 请求平均值时* `t`*：*

*   让`i`= floor( `t`/ *dt* ) mod ( *n* +1)。
*   如果`i`≠ `prev`：
    *   `sum[i]`从`total`和`cnt[i]`中减去`count`。
    *   让`sum[i]`= 0、`cnt[i]`= 0 和让`prev`= `i`。
*   令`j`= ( `i`- *n* ) mod ( *n* +1) = ( `i`+1) mod ( *n* +1)。
*   让`w`= frac( `t`/ *dt* ) = ( `t`/ *dt* ) − floor( `t`/ *dt* )。
*   返回 ( `total`- `w`× `sum[j]`) / ( `count`- `w`× `cnt[j]`)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-23T20:57:03.420

@DanRedux 是正确的；您每次都需要计算它们，因为您的输入正在改变。现在，您可能更喜欢按需或预先（即，当您获得新批次时）计算这些数字，具体取决于需要结果的频率。

例如，如果您的平均用例每约 30 秒轮询一次这些统计信息，那么我可能会按需计算它们并缓存结果，直到有新批次进来。不过，这实际上取决于您的使用场景。

至于如何存储它们，你真的没有选择，是吗？您需要内存中所有 50,000 个数字的空间。所以......你需要一块足够大的内存来容纳它们。为了避免每次有新序列进入时不断分配 2KB，您最好声明一个足够大的数组以容纳可能的最大数据集并重用它。同样，这取决于您的要求，即，您知道您的最大可能数据集是多少吗？随着时间的推移，每秒钟分配一块新的内存是否会导致应用程序出现问题？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-23T21:01:11.607

> 有没有办法在不使用数组或列表（缓冲区）存储到达的数字和计算结果的情况下做到这一点？

不，正如您所说，如果不存储信息，这可能是不可能的。不过，您可以稍微调整要求以摆脱对缓冲区的需求。

> 如果我需要使用缓冲区，那么实现这一目标的有效方法是什么？

您需要为此使用队列。

添加项目时，如果它是新的最大值或最小值，则相应地调整这些变量。[您可以通过此处](http://jvminside.blogspot.com/2010/01/incremental-average-calculation.html)的公式逐步调整平均值。只需将新值减去平均值除以集合中的新项目数（即队列大小加一），然后将其添加到旧平均值。

然后你或多或少会有这样的东西：

```
while(queue.Peek < oneSecondAgo)
{
  oldItem = queue.Peek
  queue.Dequeue();
  if(oldItem == min) //recalculate min
  if(oldItem == max) //recalculate max
  mean += SubtractValueFromMean(oldItem.Value, queue.Count);
} 
```

要从平均值中删除值，您应该能够使用相同的公式进行添加，但使用值的负数而不是正数......我认为。一个更好的数学家可能需要在这里帮助你。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-23T21:02:34.343

如果数字一个接一个地出现，则使用秒表和 while 循环在一秒钟内一个接一个地获取每个数字，并计算最小值、最大值和平均值。

```
double min = double.MaxValue;
double max = double.MinValue;
double sum = 0;
int count = 0;
double avg;
StopWatch sw = new StopWatch();
sw.Start();
while(sw.Elapsed.TotalSeconds <= 1)
{
   // Get the next number in the stream of numbers
   double d = GetNextNumber();

   // Calculate min
   if(d < min) min = d;
   // Calculate max
   if(d > max) max = d;

   // Calculate avg = sum/ count
   sum += d;
   count++;
}

avg = sum/count; 
```

然后返回最小值、最大值和平均值。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-23T20:51:45.057

Sadly, there isn't. The reason why it's not possible is because you need to only account for them that are a second old, which means you have to re-calculate the result every time, which means HUGE loops.

If you wanted to calculate the last 40,000 numbers, or all of them, it would be easier, but because it's time-based, you have to loop through the entire list every time.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-23T21:14:10.427

不保留缓冲区或队列中的数字是不可能的。

原因很简单：当最大值过期（超出 1 秒窗口）时，新的最大值是在最后一秒内到达的其他数字，因此您需要记录可能成为新的最大值。

需要平均值意味着所有值在它们过期时都会产生影响，并且在它一秒钟之前不会丢弃任何东西。

Sam Holder 关于使用队列的建议是一个很好的建议，尽管您可能需要一个专门的队列来同时将您的列表保持在两个顺序中：接收数字的顺序（到达时间），并从最大到最小排序.

使用带有两个下一个和两个前一个指针的单个节点对象（一对是临时的，另一对是大小的）可以同时从两个列表中删除元素，当一个元素从临时列表中过期时，您可以访问大小列表的指针，因为它们在同一个节点对象中。

可以通过保持运行总数和运行计数来保持平均值，在删除元素时减去元素，并在创建元素时添加它们，因此不必每次都遍历整个列表来计算平均值。

正如 btilly 在他们对 Sam Holder 帖子的评论中所建议的那样，使用最大堆和最小堆比使用列表更有效，我们将再次需要使用单个节点，同时为堆和列表使用指针，所以我们不必搜索元素来删除它们，并且可能需要花一些时间考虑如何正确删除不在堆顶部的元素，同时保持 O(log n) 插入和删除的保证。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-25T16:31:06.800

平均而言，需要考虑 3 种情况：

1.  你的数字是整数。保持一个运行的总数和计数，将新值添加到总数中，从总数中减去旧值，并根据需要除以计数。这很简单，因为您不必担心精度损失。
2.  您的数字是浮点数，您需要 0 的精度损失：您必须遍历整个一秒列表来计算平均值
3.  您的数字是浮点数，您可以忍受一些精度损失：按整数平均值操作，每 1000 个值左右进行一次完整的重新计算。

对于最小值和最大值（仅与上述 #1 和 #3 相关）：

*   将值保存在按值索引的陷阱中。
*   还要将值保存在按时间排序的双向链表中。保存列表的开头和结尾。
*   从列表的开头删除，并添加到列表的末尾。
*   对于每个新值：将其添加到时间链表的开头。根据需要从时间链表的末尾删除值。

当您在链表中添加和删除值时，对 treap 执行相应的操作。要从 treap 中获取最小值和最大值，只需在 log(n) 时间内执行 find_minimum 和 find_maximum 操作。当您在恒定时间内从链表的右端删除东西时，也要在 log(n) 时间内从treap 中删除它们。

Treaps 可以在 log(n) 时间内找到它们的最小值，在 log(n) 时间内找到它们的最大值，并在 log(n) 时间内找到任意值。一般来说，访问数据所需的不同方式越多，像treap 这样全面的数据结构就越好。

# python - 带有 PIL 和裁剪和粘贴图片的特殊 Heisenbug

> ID：10288077
> 
> 赞同：0
> 
> 时间：2012-04-23T20:49:11.483
> 
> 标签：python, image-processing, python-imaging-library

这实际上有效：

```
def tileshift(original, size, iterations):
    im = Image.open(original)
    format = im.format

    x, y = [float(v) for v in im.size]
    xr, yr = [float(v) for v in size]
    r = max(xr / x, yr / y)
    im = im.resize((int(round(x * r)), int(round(y * r))),
               resample=Image.ANTIALIAS)

    corners = _corners(im.size)
    lu = im.crop(corners[0])
    ru = im.crop(corners[1])
    ll = im.crop(corners[2])
    rl = im.crop(corners[3])

    # debugging each tile
    lu.save('tileshifted/lu.jpg')
    ru.save('tileshifted/ru.jpg')
    ll.save('tileshifted/ll.jpg')
    rl.save('tileshifted/rl.jpg')

    im.paste(lu, corners[1])
    im.paste(ru, corners[3])
    im.paste(ll, corners[0])
    im.paste(rl, corners[2])
    return (im, format)

def _corners(size):
    w, h = size
    return (
      (0, 0, w / 2, h / 2),
      (w / 2, 0, w, h / 2),
      (0, h / 2, w / 2, h),
      (w / 2, h / 2, w, h)
     ) 
```

现在，**这确实有效**。我保存输出的图片并查看它。生成的图片是每个象限顺时针移动一格的图片。

为了让我的问题更清楚，我在这里上传了所有图片： [http ://www.peterbe.com/stackoverflowquestion/index.html](http://www.peterbe.com/stackoverflowquestion/index.html)

**但！**当我停止每个角落的调试时。IE。我注释掉所有中间保存，所以它不是这样的：

```
 ...
    # debugging each tile
    #lu.save('tileshifted/lu.jpg')
    #ru.save('tileshifted/ru.jpg')
    #ll.save('tileshifted/ll.jpg')
    #rl.save('tileshifted/rl.jpg')
    ... 
```

现在它停止工作了！您会得到一张合成图片，其中左上角的图块似乎已重复了 3 次。

显然我不需要调试，但显然这些调用`instance.save()`做了一些重要的事情。

**更新**

看来我可能已经找到了解决方案。如果在创建实例`lu.load()`后立即运行，那么它可以工作！`lu`从中获得灵感：[https ://stackoverflow.com/a/3838495/205832](https://stackoverflow.com/a/3838495/205832)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T20:54:15.627

根据以下文档`crop`：“这是一个惰性操作。对源图像的更改可能会或可能不会反映在裁剪后的图像中。要获得单独的副本，请在裁剪后的副本上调用 load 方法。”

因此，没有 , 的每个角落裁剪`save`都是对原始图像的一部分的引用，而不是副本，因此您将 LU 粘贴到 RU，然后尝试从 RU 粘贴到 RL 但再次获得 LU，依此类推。显然，这`save`迫使 PIL 从农作物中复制出来。

（此外，您实际上并没有提出问题。您的问题是含蓄的，但如果您真的一路提出一个*清晰简洁*的问题，那么您通常会意识到答案，或者意识到您需要提供更多可能引导您找到答案的信息。）

# asana - Is there a way to invite a user to Asana through their API

> ID：10288078
> 
> 赞同：3
> 
> 时间：2012-04-23T20:49:19.377
> 
> 标签：asana

I was wondering if there's an exposed API to invite a user to a workspace/project/task, thereby adding the user to the workspace.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:58:11.347

不是在这个时候，我已经阅读了截至 2012 年 4 月 23 日的完整文档，并且该功能还没有（据我所知）。

# ios - Intercepting PDF Link Clicks using Quicklook Framework (QLPreviewController)

> ID：10288082
> 
> 赞同：4
> 
> 时间：2012-04-23T20:49:34.207
> 
> 标签：ios, xcode, quicklook, qlpreviewcontroller

Is PDF Link handling available in Quicklook?

I created a prototype, and the QLPreviewControllerDelegate method -(BOOL)previewController:(QLPreviewController *)controller shouldOpenURL:(NSURL *)url forPreviewItem:(id)item never gets called.

When I use a .docx file with links in it, the delegate method does get fired.

Also, when I open up the PDF using safari, or a UIWebView, link handling works fine.

I tested with a few different PDFs, and link interception never worked.

I made sure that My interface implements the following protocols: QLPreviewControllerDataSource, QLPreviewControllerDelegate

I also made sure that the class that has the shouldOpenUrl method is assigned as the delegate to my QlPreviewController instance.

I am guessing the issue is not with my code, since the .docx link interception works fine.

Any thoughts on what I might be doing wrong?

Is PDF Link interception even supported by Quicklook?

I also noticed that when I open up a PDF in iOS mail, it uses Quicklook, and PDf links don't work there either.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T05:50:47.603

为那些在这里寻找相同答案的人回答我自己的问题。Quicklook 不支持链接处理。如果您需要处理 PDF 文档中的链接，则必须使用 CATiledLayer 来呈现 PDF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T01:15:18.647

您可以通过以下方式检测何时单击文档中的链接`QLPreviewControllerDelegate`

```
/*
 * @abstract Invoked by the preview controller before trying to open an URL tapped in the preview.
 * @result Returns NO to prevent the preview controller from calling -[UIApplication openURL:] on url.
 * @discussion If not implemented, defaults is YES.
 */
- (BOOL)previewController:(QLPreviewController *)controller shouldOpenURL:(NSURL *)url forPreviewItem:(id <QLPreviewItem>)item; 
```

返回`YES`将打开该文档，如果它是外部 URL，它将自动启动 Safari。

请注意，您可能希望显示 UIAlertView 以询问用户是否要退出应用程序以打开 Safari。

# html - Using Google Chrome Web Inspector changes page layout

> ID：10288092
> 
> 赞同：2
> 
> 时间：2012-04-23T20:49:58.113
> 
> 标签：html, css, google-chrome, google-chrome-devtools

I've seen this consistently now when using display: inline-block in Google Chrome. If I right-click and "Inspect Element", it will change the layout of the page, or the width of that element. It's as if it changes the element properties simply by inspecting them. It's frustrating to debug because I'm currently getting rendering bugs with inline-block elements, but, of course, I can't inspect them and tweak their properties, because they magically "fix" themselves if they're inspected.

Anyone had this happen or know of a workaround? Couldn't find anything on the web that described this.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T10:11:42.547

我在[https://bugs.webkit.org/show_bug.cgi?id=84666](https://bugs.webkit.org/show_bug.cgi?id=84666)添加了对这个问题的引用，它报告了一个类似的问题。请提供在 WebKit 错误中或至少在此处重现问题的最小可能示例。

# database - 如何为依赖动态数据的函数编写单元测试？

> ID：10288096
> 
> 赞同：11
> 
> 时间：2012-04-23T20:50:24.447
> 
> 标签：database, unit-testing, dynamic-data

假设您有一个网站，它使用一个函数从数据库中检索数据并返回要显示/解析/等的结果......

由于从数据库中检索到的数据是动态的，并且可能在一天中的每一秒都发生变化，那么如何正确地为这个函数编写单元测试呢？

假设该函数应该返回一个结果数组。显然，单元测试可以测试是否返回数组。但是，当由于 MySQL 查询编写错误导致数组本身的内容不正确时会发生什么？数组的大小可能为零，或者数组的内容可能不正确。由于它依赖于不断变化的数据，单元测试如何知道什么是正确的，什么不是？是否有必要从单元测试本身调用数据库，所以有什么可以比较的吗？

您如何为依赖动态数据的函数正确编写单元测试？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-23T20:56:29.230

理想形式的单元测试应该只测试一件事。在这种情况下，您正在测试两件事：

1.  你的函数的逻辑
2.  数据库检索

所以我建议进行以下重构：

1.  将数据库检索逻辑移动到单独的函数中
2.  让您要测试的功能调用其他功能
3.  模拟返回数据的函数，以便您可以对应用程序的逻辑进行单元测试
4.  如果有意义（如果您只是依赖另一个库来执行此操作，那么希望该库已经有测试），为动态检索功能编写一个单元测试，您无法测试细节，但可以测试返回数据的结构和合理性（例如，它已设置所有字段，并且是现在 5 秒内的时间）。

此外，通常最好在测试环境中运行单元测试，您可以完全控制数据库中存储的内容。您不想针对生产数据运行这些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T21:15:43.087

如果您的函数除了从数据库中提取数据之外还做了一些有趣的事情，您应该将检索提取到不同的函数中并模拟它，以便您可以测试其余部分。

这仍然让您完成测试数据库访问的任务。您不能真正为此进行单元测试，因为根据定义，它不会访问任何数据库，您可以只测试它是否发送您认为应该发送的 sql 语句，但不能测试 sql 语句是否真的有效。

**所以你需要一个数据库**

您有多种选择：

1）为此类测试创建一个不会被测试更改的固定数据库。

优点：概念上简单缺点：难以维护。测试变得相互依赖，因为它们依赖于相同的数据。无法测试更新、插入或删除的东西（更不用说 DDL）

2）在测试期间创建一个数据库。现在你有两个问题：为测试设置数据库并用数据填充它。

配置：

1）运行一个数据库服务器，为需要运行测试的每个人（至少 devs + ci-server）提供一个用户/模式/数据库。可以使用 hibernate 之类的东西或用于部署的脚本来创建模式。

效果很好，但会让老式的 DBA 发疯。应用程序不得依赖于模式名称。当应用程序使用多个模式时，您也会遇到问题。这个设置相当慢。它可以帮助放入快速光盘。像 RAM 盘

2）有一个内存数据库。从代码开始很容易，而且速度很快。但在大多数情况下，它的行为与您的生产数据库相同。如果你使用一些试图隐藏差异的东西，这就不那么重要了。我经常在第一个构建阶段使用内存数据库，在第二个阶段使用真实数据库。

加载测试数据

1) 人们告诉我使用 dbunit。我不相信当列或约束发生变化时，它似乎有很多 XML 并且难以维护。

2）我更喜欢普通的应用程序代码。（Java + Hibernate）在我的情况下，但是在生产中将数据写入数据库的代码在许多情况下应该适合为您的测试编写测试数据。它有助于有一个特殊的 API 隐藏满足所有外键和东西的细节：http: [//blog.schauderhaft.de/2011/03/13/testing-databases-with-junit-and-hibernate-part -1-one-to-rule-them/](http://blog.schauderhaft.de/2011/03/13/testing-databases-with-junit-and-hibernate-part-1-one-to-rule-them/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T20:55:35.897

你不能，真的。您需要有保证的静态数据集来创建可靠的单元测试。也许数据库快照对您有用。

动态数据在其他方面也很有用，例如执行回归测试......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T20:56:11.007

大多数测试侧重于获取数据等涉及的逻辑路径。不是数据本身的有效性。数据的有效性只有在您的应用程序以某种方式计算或聚合数据或其他情况下才有意义，在这种情况下，您应该能够控制输入并验证结果是否正确。

也就是说，有时您确实希望访问您的应用程序用来验证退货的同一数据库。例如，如果您正在测试一个返回过滤数据集的函数，您的单元测试可以执行相同的查询，然后对每个记录的主键进行逐行比较，并验证您的函数是否返回您期望的同一组数据。

我不知道这是否是您的具体问题，但相反，在单元测试中访问数据库以执行断言并没有错。至少我一直这样做，没有人试图让我被捕:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-23T21:01:27.380

忽略您正在谈论数据库的事实，我认为您可能正在寻找您的单元测试来涵盖所有可能导致收益递减的情况。如果我是你，我会介绍一条标准路径，然后介绍几个边缘情况。事实是你不能务实地测试一切。

这里有一些进一步的阅读

[http://37signals.com/svn/posts/3159-testing-like-the-tsa](http://37signals.com/svn/posts/3159-testing-like-the-tsa)
[你的单元测试有多深？](https://stackoverflow.com/questions/153234/how-deep-are-your-unit-tests)
[http://johnnosnose.blogspot.co.uk/2012/04/re-over-testing.html](http://johnnosnose.blogspot.co.uk/2012/04/re-over-testing.html)
[http://martinfowler.com/bliki/TestCoverage.html](http://martinfowler.com/bliki/TestCoverage.html)

查看您的特定数据库相关问题，要测试此功能，您可能需要创建一个[接缝](http://www.informit.com/articles/article.aspx?p=359417&seqNum=3)来预先填充数据，以便您可以涵盖这些情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-24T05:01:26.567

我会在测试本身中构建数据。这样，您甚至可以针对不断变化的数据测试复杂的场景。关键是您可以通过拥有专用的测试数据库来控制测试中的数据更改，

第 1 步：将您需要的数据插入仅供测试使用的数据库 第 2 步：数据库现在处于稳定的可预测状态，因此您可以运行查询并测试输出

# magento - Magento: Product inventory reduction after order code?

> ID：10288097
> 
> 赞同：0
> 
> 时间：2012-04-23T20:50:34.503
> 
> 标签：magento

Does anyone know where the code that reduces the inventory by one on products ordered after an order is completed is located? Ive combed through the checkout folders and cant seem to locate it.

Im assuming its something like:

1.  Order is placed
2.  Array of products ordered
3.  Deducts "1" from each inventory number

Any help is appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:57:31.513

我想你会在 Mage\CatalogInventory\Model\Stock\Status.php 中找到你想要的东西

您可以从那里利用各种事件。另请注意，对库存的任何更改都通过此处进行管理。因此，不仅是在下订单时，还包括手动更改库存等。

# html - 将标题放在前面，以便链接工作

> ID：10288106
> 
> 赞同：0
> 
> 时间：2012-04-23T20:51:14.240
> 
> 标签：html

[我刚刚从FortySeven Media](http://fortysevenmedia.com/blog/archives/making_your_footer_stay_put_with_css/)网站向我的网站添加了一项功能。它基本上使您的页脚粘在浏览器的底部。

但是，现在我的 Header 位于其他所有内容的后面，并且 Header 内的链接不再可点击。有谁知道我怎样才能把我的 Header 带回前面。

这是我现在正在处理的页面，[404 - Skiroid](http://www.skiroid.com/error/404/)。在修复所有其他页面之前，我正在尝试让该页面正常工作。

我花了一个小时弄乱它试图让标题回到前面。我尝试过的一切似乎都不起作用。

任何帮助都是极好的！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:57:02.563

要使 z-index 起作用，您需要给元素一个固定的、绝对的或相对的位置。

您的标头没有这些，但您声明了一个 z-index。给出你的标题`positon:relative`，它应该可以工作；

# c++ - 在 C++ 中对字节进行签名短

> ID：10288109
> 
> 赞同：0
> 
> 时间：2012-04-23T20:51:20.883
> 
> 标签：c++, byte, short

我正在尝试使用 C++ 将 HEX 数字转换为短（2 字节）数字，除了一件事之外一切都很好......从短到字节的签名转换（最后测试）

我发现了这个问题，并不能真正从中受益：[便携式有符号/无符号字节转换，C++](https://stackoverflow.com/questions/1862453/portable-signed-unsigned-byte-cast-c)

**这是我的测试：**

```
// test 1 - positive B2Short (success)
byte *b = new byte[2];
b[0] = 0x10; //low byte
b[1] = 0x00; //heigh byte

signed short test = 0;
test = ByteToShort(b);
cout << test << endl;

// test 2 - negative B2Short (success)
b[0] = 0xF0; //low byte
b[1] = 0xFF; //heigh byte

test = 0;
test = ByteToShort(b);
cout << test << endl;

// test 3 - positive Short2B (success)
signed short n = 11;
ShortToByte(n, b);
test = ByteToShort(b);  // for display to see if it worked
cout << test << endl;

// test 4 - negative Short2B (FAIL!)
n = -11;
ShortToByte(n, b);
test = ByteToShort(b);  // for display to see if it worked
cout << test << endl; 
```

**使用的功能：**

```
signed short ByteToShort(byte* bytes){

    signed short result = 0;
    result = (result<<8) + bytes[1]; // heigh byte
    result = (result<<8) + bytes[0]; // low byte
    return result;
}

void ShortToByte(signed short num, byte* bytes){

    bytes[1] = num & 0xFF00; // heigh byte
    bytes[0] = num & 0x00FF; // low byte
} 
```

**输出：**

```
16
-16
11
245 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-23T21:00:28.063

来自`ShortToByte`：

```
bytes[1] = num & 0xFF00; // high byte 
```

您必须将其向右移动 8 位，以使结果适合一个字节。否则你只会从低部分得到零。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-23T21:07:09.193

我会说使用联合会更容易：

```
union ShortByteUnion {
    signed  short asShort;
    unsigned char asBytes[2];
}; 
```

它会为您处理转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:42:04.627

只需将 short 转换为字节数组。

```
signed short test = 1234;
byte* b;

b = (byte*) &test;

b[0];//one byte
b[1];//another byte 
```

在不止一种类型的机器上执行此操作很危险，因为字节序可能会有所不同。

我不喜欢单行，但他们来了：

```
((byte*)&test)[0];
((byte*)&test)[1]; 
```

# ms-access - java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Too few parameters. Expected 1

> ID：10288112
> 
> 赞同：1
> 
> 时间：2012-04-23T20:51:33.870
> 
> 标签：ms-access, search, jdbc, parameters

i have one parameter that i am passing from a JSP using Ajax which is:

```
keyword_name; 
```

i have tested to see if their was something in the parameter, their was:

```
apple 
```

the code below is my ResultSet:

```
ResultSet rs = stmt.executeQuery("Select keyword_name from keywords                   where keyword_name="+keyword_name+""); 
```

and the below is the printing of the result set:

```
while(rs.next()){
buffer=buffer+"<tr><td>"+rs.getString("keyword_name")+"</td></tr>";  
} 
```

Full ERROR code:

```
java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Too few parameters. Expected 1\. 
```

Any ideas!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T20:58:10.980

那不应该是

```
<..> where keyword_name='"+keyword_name+"'" 
```

# android - 我无法设置闹钟日历

> ID：10288119
> 
> 赞同：1
> 
> 时间：2012-04-23T20:52:12.903
> 
> 标签：android, calendar, set, alarmmanager, alarm

我正在尝试为我的课程设置警报。我需要在他们开始前一小时拉响警报。所以我只想

*   获得一年中的一周
*   浏览数周（循环 ...51,52）
    *   浏览类（循环...n）
        *   设置该课程的星期几
        *   在上课前一小时设置一天中的时间
        *   将分钟设置为 00
        *   使用此日历实例设置闹钟
    *   循环结束（类）
    *   将周设置为从当前周开始的一周

```
Calendar cal = Calendar.getInstance();
cal.setTimeInMillis(System.currentTimeMillis());
for (int i = cal.get(Calendar.WEEK_OF_YEAR); i <= 52; i++) {
    for (Dersler d : dersProgrami) {
        alarm = new DersAlarmi(String.valueOf(d.getBaslangicS()) + "00", d.getDersAdi(), d.getDerslik());
        cal.set(Calendar.DAY_OF_WEEK, d.getDayOfClass()+1);
        cal.set(Calendar.MINUTE, 00);
        cal.set(Calendar.HOUR_OF_DAY, d.getStartHour());
        cal.add(Calendar.HOUR_OF_DAY, -1);
        Log.i("ALARM KURULDU",
            String.valueOf(i) + String.valueOf(cal.get(Calendar.DAY_OF_MONTH))+"."+String.valueOf(cal.get(Calendar.MONTH))+"."+String.valueOf(cal.get(Calendar.YEAR))+" "+String.valueOf(cal.get(Calendar.HOUR_OF_DAY))+":"+String.valueOf(cal.get(Calendar.MINUTE))+" Ders:" + d.getDersAdi()
                + " Hafta:"
                + cal.get(Calendar.WEEK_OF_YEAR) + " Gün:"
                + cal.get(Calendar.DAY_OF_WEEK) + " Saat:"
                + cal.get(Calendar.HOUR_OF_DAY));
            alarmManager.set(AlarmManager.RTC_WAKEUP,
                cal.getTimeInMillis(), pendingIntent);
        dersAlarmlari.add(alarm);
    }
    cal.set(Calendar.WEEK_OF_YEAR, cal.get(Calendar.WEEK_OF_YEAR)+1);
} 
```

当前日期时间为：23.04.2012 23:37

Logcat 是：

```
04-23 23:23:10.835: I/ALARM KURULDU(16380): 17 25.3.2012 14:0 Ders:DATA MINING Hafta:17 Gün:4 Saat:14

04-23 23:23:10.835: I/ALARM KURULDU(16380): 17 23.3.2012 8:0 Ders:Database Management and SQL Hafta:17 Gün:2 Saat:8

04-23 23:23:10.855: I/ALARM KURULDU(16380): 17 25.3.2012 12:0 Ders:ENTREPRENEURSHIP Hafta:17 Gün:4 Saat:12

04-23 23:23:10.865: I/ALARM KURULDU(16380): 1723.3.2012 11:0 Ders:GRADUATION PROJECT Hafta:17 Gün:2 Saat:11

04-23 23:23:10.865: I/ALARM KURULDU(16380): 18 25.3.2012 14:0 Ders:DATA MINING Hafta:17 Gün:4 Saat:14

04-23 23:23:10.885: I/ALARM KURULDU(16380): 18 23.3.2012 8:0 Ders:Database Management and SQL Hafta:17 Gün:2 Saat:8

04-23 23:23:10.885: I/ALARM KURULDU(16380): 18 25.3.2012 12:0 Ders:ENTREPRENEURSHIP Hafta:17 Gün:4 Saat:12

04-23 23:23:10.895: I/ALARM KURULDU(16380): 18 23.3.2012 11:0 Ders:GRADUATION PROJECT Hafta:17 Gün:2 Saat:11

04-23 23:23:10.905: I/ALARM KURULDU(16380): 19 25.3.2012 14:0 Ders:DATA MINING Hafta:17 Gün:4 Saat:14 
```

...

那么为什么它在 logcat 中显示它的 23\. **03** .2012 或 25\. **03** .2012 而不是今天的日期 23\. **04** .2012？我一直在为此浪费时间，有人可以告诉我设置闹钟的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:06:08.213

您正在使用它来打印月份：`cal.get(Calendar.MONTH))`

然而，返回的月份看起来是零索引的。

根据日历手册页， 的值为`JANUARY`0，而 的值为`APRIL`3。因此，如果您想像通常打印的那样打印月份（April = 4），那么只需在打印前将月份加一即可。

# html - Centering a div with expandable background image(s) on each side

> ID：10288123
> 
> 赞同：0
> 
> 时间：2012-04-23T20:52:28.773
> 
> 标签：html, css, background, center, centering

Is there a way to have two different background images, one attached to each side of a div element, that do not insist on statically appearing when the window is resized smaller? In other words, if the div element is 900px wide and viewed on a small laptop, it will remain centered but only enough of the left and right backgrounds appear as required by the viewport size.

I think I've exhausted my limited CSS knowledge on this one.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:05:54.683

我认为你必须重新考虑这个问题。**只能有 1 个**背景。但是，如果需要，您仍然可以通过在**居中**div 的每一侧使用**具有不同背景的相同尺寸的 div 来**获得相同的效果，方法是一个向右浮动，另一个向左浮动。并且您可能需要考虑查看**Jquery Accordion** for Vertical Accordions 以提供该效果。

# c# - C# VS2008 显示编辑器在设计时选择现有控件的集合

> ID：10288128
> 
> 赞同：1
> 
> 时间：2012-04-23T20:53:02.913
> 
> 标签：c#, user-controls, design-time, collectioneditor, uitypeeditor

我的用户控件上有下一个属性：

```
[
    Browsable(true),
    Category("Data"),
    Description("Listado de controles que proporcionan los parámetros para generar el reporte."),
    DesignerSerializationVisibility(DesignerSerializationVisibility.Content)
]
public List<Control> ControlesParametros { set; get; } 
```

我想让 Visual Studio 向我展示一个编辑器，我可以在其中选择一些现有的控件实例，以放置我的用户控件。目前，Visual Studio 向我展示了一个编辑器，我可以在其中添加新控件，但不能选择现有控件。

我找到了一个类似的问题和答案，但解决方案是使用 .NET Framework 4.0 设计的自定义编辑器，我目前有 3.5: [Design-time editor support for controls collection](https://stackoverflow.com/questions/1372691/design-time-editor-support-for-controls-collection)

是否有本地编辑器，或者我应该构建一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-01T14:38:01.077

对于初学者，我会使用`Collection<Control>`而不是`List<T>`. 列表通常会起作用，但它确实会以您可能不想要的方式公开您的收藏。

要获取现有控件，您需要深入`context.Container.Components`研究`LoadValues`覆盖。它将包含*所有内容*，包括主机表单本身和组件，因此您可能必须过滤它们。可以确定的一件事是删除组件（如`DataGridViewColumns`和`TabPages`），因为它们不会进入控件列表或集合；其他东西，比如 TableLayoutPanels，你也经常想要删除。

此版本为默认下拉列表过滤掉一些组件和控件：

```
protected override void LoadValues(System.ComponentModel.ITypeDescriptorContext context, System.IServiceProvider provider, object value)
{

    bool bAdd = true;
    Control thisCtl = null;

    Collection<Control> tCollection = (Collection<Control>)value;

    foreach (object obj in context.Container.Components) {
        //Cycle through the components owned by the form in the designer
        bAdd = true;

        // exclude other components - this weeds out DataGridViewColumns which
        // can only be used by a DataGridView
        if (obj is Control) {
            thisCtl = (Control)obj;

            if (ExcludeForm) {
                bAdd = !(thisCtl is Form);
            }

            // custom exclude list 
            if ((typeExclude != null) && (typeExclude.Count > 0)) {
                if (typeExclude.Contains(thisCtl.GetType)) {
                    bAdd = false;
                }
            }

            bool bCheck = false;
            int ndx = 0;
            if (bAdd) {
                bCheck = tCollection.Contains(thisCtl);

                ndx = myCtl.Items.Add(new ListItem(thisCtl));
                myCtl.SetItemChecked(ndx, bCheck);
            }
        }

    }

} 
```

![在此处输入图像描述](../Images/34d9abc2e285528ce36726a329f2a3e0.png)

如果您愿意，可以显示符合条件的控件对话框样式并使用 CheckedListBox 供用户选择控件。有一篇关于 CodeProject [Selecting Form's Controls at Design Time](http://www.codeproject.com/Articles/687430/Selecting-Forms-Controls-at-Design-Time)的文章进行了更详细的介绍。

它在 VB 中，但可以让您轻松实现这样的野兽（我写了它，所以我可能有偏见）：

```
ExampleDropDownControlCollectionUIEditor : ControlCollectionDropDownUIEditor
{
    public ExampleDropDownControlCollectionUIEditor() : base()
    {
        base.ExcludeForm = true;

        base.CheckControlWidth = 200;

        base.typeExclude.Add(typeof(RadioButton));
        base.typeExclude.Add(typeof(Label));
    }
} 
```

对话框形式很简单，只是使用了不同的基类，`ControlCollectionDialogUIEditor`

# php - PHP Curl 跟随重定向

> ID：10288130
> 
> 赞同：10
> 
> 时间：2012-04-23T20:53:07.473
> 
> 标签：php, curl, scrape

我试图变得有点狡猾，作为学习过程的一部分，尝试提高我的页面抓取技能。

我遇到的一件我还没有解决的问题是某些网站将使用内部链接，然后重定向到外部链接。

我想要做的是修改一些 curl 代码以跟随重定向，直到它们停止，然后获得最终的休息地点 URL。

有人为我推荐一些代码吗？

我现在有这个，但它目前没有正确遵循重定向。

```
 $opts = array(CURLOPT_URL => $url,
                      CURLOPT_RETURNTRANSFER => true,
                      CURLOPT_HEADER => true,
                      CURLOPT_FOLLOWLOCATION => true);      

        $curl = curl_init(); 
        curl_setopt_array($curl, $opts);  
        $str = curl_exec($curl);  
        curl_close($curl); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-23T20:59:54.117

http.//php.net/manual/en/ref.curl.php

```
 function get_final_url( $url, $timeout = 5 )
 {
    $url = str_replace( "&amp;", "&", urldecode(trim($url)) );

   $cookie = tempnam ("/tmp", "CURLCOOKIE");
$ch = curl_init();
curl_setopt( $ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; rv:1.7.3) Gecko/20041001 Firefox/0.10.1" );
curl_setopt( $ch, CURLOPT_URL, $url );
curl_setopt( $ch, CURLOPT_COOKIEJAR, $cookie );
curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, true );
curl_setopt( $ch, CURLOPT_ENCODING, "" );
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );
curl_setopt( $ch, CURLOPT_AUTOREFERER, true );
curl_setopt( $ch, CURLOPT_CONNECTTIMEOUT, $timeout );
curl_setopt( $ch, CURLOPT_TIMEOUT, $timeout );
curl_setopt( $ch, CURLOPT_MAXREDIRS, 10 );
$content = curl_exec( $ch );
$response = curl_getinfo( $ch );
curl_close ( $ch );

if ($response['http_code'] == 301 || $response['http_code'] == 302)
{
    ini_set("user_agent", "Mozilla/5.0 (Windows; U; Windows NT 5.1; rv:1.7.3) Gecko/20041001 Firefox/0.10.1");
    $headers = get_headers($response['url']);

    $location = "";
    foreach( $headers as $value )
    {
        if ( substr( strtolower($value), 0, 9 ) == "location:" )
            return get_final_url( trim( substr( $value, 9, strlen($value) ) ) );
    }
}

if (    preg_match("/window\.location\.replace\('(.*)'\)/i", $content, $value) ||
        preg_match("/window\.location\=\"(.*)\"/i", $content, $value)
)
{
    return get_final_url ( $value[1] );
}
else
{
    return $response['url'];
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T20:56:58.260

如果你不能使用`CURLOPT_FOLLOWLOCATION`，我建议你使用这样的递归方法：

```
function getUrl($url, $count) {

    // max number of redirects
    if ($count > 5) {
        return false;
    }

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    $data = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);

    curl_close($ch);

    if (!$data) {
        return false;
    }

    $dataArray = explode("\r\n\r\n", $data, 2);

    if (count($dataArray) != 2) {
        return false;
    }

    list($header, $body) = $dataArray;
    if ($httpCode == 301 || $httpCode == 302) {
        $matches = array();
        preg_match('/Location:(.*?)\n/', $header, $matches);

        if (isset($matches[1])) {
            return getUrl(trim($matches[1]), $count + 1);
        }
    } else {
        return $body;
    }
} 
```

# compiler-errors - 为什么在编译时而不是在运行时发现错误更好？

> ID：10288131
> 
> 赞同：0
> 
> 时间：2012-04-23T20:53:12.210
> 
> 标签：compiler-errors

为什么在编译时而不是在运行时发现错误更好？我在这里和其他地方搜索了相同的主题，但没有找到一个像样的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T20:55:42.683

一般来说，在软件开发过程中越早发现错误，修复它们就越快/更容易/更便宜。通常，编译器错误或警告会准确指出代码中问题所在的行，而在运行时定位错误通常是一个更加漫长和费力的过程。此外，该错误也可能在一段时间内没有出现（“潜在”错误），因此您可能需要在将来的某个时候花费额外的精力来提供客户支持、随错误修复，处理由此造成的声誉损失等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T20:57:59.733

基本上，由于每次编译时编译器都会检查所有代码，因此它可以检测到的任何错误都会在每次编译时自动发现。

查找错误运行时意味着您必须运行所有代码来检测错误，这可能很棘手，尤其是对于具有许多条件执行分支的代码。此外，查明错误的确切位置可能非常棘手。

最后归结为尽快找到错误，以便您可以在代码记忆犹新时修复它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:00:09.957

此外，除了@Paul R 所说的之外，编译错误“更容易”注意到（您只需编译代码并瞧瞧），而运行时错误可能特定于用例场景，这可能会使您的系统崩溃被部署。想想影响...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T21:14:26.543

有两种类型的错误，编译时和运行时。最好，您希望您的错误发生在编译时，因为这些错误更容易诊断和纠正。

基本上编译时错误意味着编写的代码无法构建，因为存在语法错误（错字）或类型错误（以错误的方式调用或使用变量类型）等，编译器无法继续。尽管如今的编译器尽最大努力识别所有类型的错误，甚至是潜在的运行时错误，因为与在调试过程中相比，在编写代码时纠正这些问题要便宜得多且耗时更少。通常在可以进行基本“运行时”分析的编译器中，您会收到警告，这是编译器告诉您它认为您的代码被抬高的方式。它仍然建立在警告场景中，但警告始终是您应该注意的。

发生运行时错误是因为尽管代码可能正确，但逻辑不正确，或者编译器在构建期间无法知道进入代码的参数（想想用户输入）。运行时错误的示例包括无限循环、越界错误、类型错误（认为用户在要求输入数字时输入了字符串）和许多其他错误。

最重要的是，任何时候我们都可以知道错误的生成，而不是在我们完成之后，我们可以保持我们的代码更清洁和更有效。我希望这有帮助。:)

# ios - iOS：由于网络连接速度慢，应用程序获得 SIGKILL？

> ID：10288133
> 
> 赞同：0
> 
> 时间：2012-04-23T20:53:17.413
> 
> 标签：ios, http, networking, sigkill

当我在酒店时，他们的 Wifi 显然是通过非常慢的互联网连接连接到互联网的。事实上，它可能是基于调制解调器的。

结果是我的应用程序的 HTTP GET 请求似乎导致 iOS 向我的应用程序发送 SIGKILL（如 Xcode 所示）。

为什么？怎么修？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:20:04.580

您需要将 HTTP 请求放在后台线程中。如果您的主线程长时间无响应，您的应用程序将被终止。

通常，Web 服务的 API 提供异步获取。你应该使用那个。

如果您的 API 不提供此类...请使用不同的 API。除此之外，你自己把它放在后台。就像是

```
- (void)issuePotentiallyLongRequest
{
    dispatch_queue_t q = dispatch_queue_create("my background q", 0);
    dispatch_async(q, ^{
        // The call to dispatch_async returns immediately to the calling thread.
        // The code in this block right here will run in a different thread.
        // Do whatever stuff you need to do that takes a long time...
        // Issue your http get request or whatever.
        [self.httpClient goFetchStuffFromTheInternet];

        // Now, that code has run, and is done.  You need to do something with the
        // results, probably on the main thread
        dispatch_async(dispatch_get_main_queue(), ^{
            // Do whatever you want with the result.  This block is
            // now running in the main thread - you have access to all
            // the UI elements...
            // Do whatever you want with the results of the fetch.
            [self.myView showTheCoolStuffIDownloadedFromTheInternet];
        });
    });
    dispatch_release(q);
} 
```

# vim - 用于重复多个元素的 Sparkup 语法？

> ID：10288135
> 
> 赞同：0
> 
> 时间：2012-04-23T20:53:20.150
> 
> 标签：vim, sparkup

说我有这个：

```
...
    <li class='tab'><a href="#tabs2-7">7</a></li>
    <li class="tab"><a href="#tab2-8">8</a></li>
... 
```

...我想在我的[编辑器中使用](http://scribes.sourceforge.net)[Sparkup](https://github.com/rstacruz/sparkup)来添加另一个说 6 个选项卡...所以我运行 sparkup 命令：

```
li.tab > a[href=#tab2-$]{$}*6 
```

但结果全错了，

```
 <li class="tab"><a href="#tab2-8">8</a></li>
    <li class="tab">
       <a href="#tab2-1">1</a>
       <a href="#tab2-2">2</a>
       <a href="#tab2-3">3</a>
       ...
    </li> 
```

我的第一个想法是我的语法应该是：

```
(li.tab > a[href=#tab2-$]{$})*6 
```

但这几乎做了同样的事情......除了这次它没有插入第二个数字：

```
 <li class="tab"><a href="#tab2-8">8</a></li>
    <li class="tab">
       <a href="#tab2-1">$</a>
       <a href="#tab2-2">$</a>
       <a href="#tab2-3">$</a>
       ...
    </li> 
```

现在范围问题（从 9 开始而不是 1）只是一个小麻烦，但是如果我希望它重复标记`li`以及`a`标记怎么办？

是的，在你开始之前，我确实知道我可以只使用一个简单的 for 循环来创建所有这些东西；但这不是问题的一部分，是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:03:08.943

你快到了：

```
li.tab*6 > a[href=#tab2-$]{$} 
```

你想创建 6`<li>`所以你应该放你的乘数。

没必要防守。

# backup - 使用 rsync 而不复制正在使用的文件

> ID：10288137
> 
> 赞同：-1
> 
> 时间：2012-04-23T20:53:32.670
> 
> 标签：backup, rsync

我有一台服务器（机器 A）全天接收来自其他机器的上传。我有一个脚本在另一个内部服务器上运行（作为 cron - 机器 B 运行），它使用 rsync 将这些文件拉到自身并删除机器 A 上的原始文件。其中一些上传持续一个小时或更长时间。

如何使用 rsync 使其不会尝试复制当前上传（正在写入）的文件？我不希望它提取部分上传，然后尝试处理它们。

我在机器 A 和 B 上都使用 Ubuntu 10.04 64 位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:18:52.057

为了在 中进行增量 baclups `rsync`，您应该输入`--update`or`-u`选项。接收器中存在的文件将被更新的唯一情况是存档存在并且两端具有相同的时间戳但大小不同。

关于部分更新，所有的临时上传都存储在一个临时存档中，然后`dest`在上传时移动到目录中。`--partial`如果出现 网络问题，您可以使用`rsync`，这将在您下次再次执行同步时恢复部分更新。

[您可以从此手册页](http://linux.die.net/man/1/rsync)检查整个选项。

# php - 处理来自查询的数据

> ID：10288139
> 
> 赞同：0
> 
> 时间：2012-04-23T20:53:49.110
> 
> 标签：php, codeigniter, activerecord, data-manipulation

我在 codeigniter 的模型类中编写了一个“get”函数，但是我需要处理一些返回的数据，理想情况下没有一大堆开销。

```
function get_answers($p)
{
    $result = $this->db->get_where('answer', array('a_upid_fk' => $p))->result();

    // foreach ($result->answer as $ans) {  
    //  $result->answers = explode( '|', $ans, -1 );
    // }

    return $result;
} 
```

结果如下所示：

```
array (
  0 => 
  stdClass::__set_state(array(
     'aid' => '742',
     'a_upid_fk' => '231',
     'answer' => '4555|||',
     'a_qid_fk' => '70',
     'created' => '2012-04-20 15:35:38',
     'last_modified' => '2012-04-20 15:36:11',
     'revision' => '1',
  )),
  1 => 
  stdClass::__set_state(array(
     'aid' => '743',
     'a_upid_fk' => '231',
     'answer' => NULL,
     'a_qid_fk' => '71',
     'created' => '2012-04-20 15:35:38',
     'last_modified' => '2012-04-20 15:35:38',
     'revision' => '1',
  )) ... 
```

问题是答案存储为以管道分隔的答案列表，但我希望函数将其作为分解数组返回。我不确定语法以及如何创建和替换数组或将数组附加到我上面粘贴的对象数组中。

你可以看到一些我一直在尝试的代码被注释掉了。

理想情况下，`'answer' => '4555|||',` 我不想拥有

```
'answer' => array (
      0 => '4555', 
      1=> '', 
      2=> '') 
```

我在使用数组时没有问题，`explode`但我不确定如何修改原始的 codeigniter 活动记录结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:57:48.260

循环通过您的子阵列：

```
$answer_array = explode('|', $answer);
foreach ($aswer_array as $instance)
{
  $result[] = $instance;
} 
```

定义`__set_state())`，使用 - 调用它`$subarray = $result[0][$object->answer]`。

# .htaccess - 如何将任何请求重定向到目录并使用 .htaccess 去除 args

> ID：10288142
> 
> 赞同：1
> 
> 时间：2012-04-23T20:53:54.080
> 
> 标签：.htaccess, redirect

我正在尝试将所有请求重定向到某个目录，即使请求包含参数。例如，我看到 Google 将旧博客中的几个旧链接列为 404，但链接看起来像：example.com/stuff/?args .. 所以我觉得我需要重定向任何去往 / 的请求stuff/ 并剥离 args，因为如果它们被保留，它们将产生自己的 404。

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T20:57:08.497

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^stuff/?$ new-dir? [L,R,NC] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T20:58:03.657

或使用 mod_alias：

```
RedirectMatch ^/stuff/?.* /new/? 
```

# c++ - C ++对象数组中的奇怪数字

> ID：10288155
> 
> 赞同：0
> 
> 时间：2012-04-23T20:54:27.550
> 
> 标签：c++, arrays, memory-management

我一直在尝试使用动态创建的对象数组创建一个类。我重载了运算符 + 以向一组对象（类到类）添加（暂时仅此）一个新对象。问题是当我读取数组中的数据时，我得到了各种各样的大数字。这是代码：

```
#include<iostream.h>

class Figura {
    public: 
        int x, y, poz;
        int tip; //1 = punct ; 2 = dreapta; 3 = dreptunghi
        Figura() { };
        Figura(const Figura&) { };
};

class Grup {
    private:
        int nr_elemente;
        Figura *figuri;
    public:
        int i;
        Grup(int nr_el) {
            nr_elemente = nr_el;
            figuri = new Figura[nr_elemente];
            i = 1;
        }
        ~Grup() {};
        Grup(const Grup&) {};
        int _nr_elemente() {
            return i;
        }

        void adauga_element(Figura fig) {
            if( i <= nr_elemente)
                figuri[i++] = fig;
            else
                cout<<"Grupul a atins numarul maxim de figuri.";
        }

        void afiseaza_elemente() {
            for(int j = 1; j <= i; j++)
                cout<<"Figura nr : "<<j<<"tip: "<<figuri[j].tip<<figuri[j].x<<" "<<figuri[j].y<<" "<<figuri[j].poz;
        }
    friend Grup operator+(const Figura& fig1, const Figura& fig2) {
        return fig1.poz + fig2.poz;
    };
    friend Grup operator+(const Grup& gr1, const Grup& gr2) {};
    void operator+(const Figura& fig);
    friend Grup operator*(const Grup& fig) {};

};

void Grup::operator+(const Figura& fig) {
    Grup::adauga_element(fig);
}

class Punct : public Figura
{
    public: 
        Punct(int poz) {
            Punct::tip = 1;
            Punct::poz = poz;
        }
};

class Segment : public Figura
{
    public:
        Segment(int poz, int x) {
            Segment::tip = 2;
            Segment::poz = poz;
            Segment::x = x;
        }
};

class Dreptunghi : public Figura
{
    public:
        Dreptunghi(int poz, int x, int y) {
            Dreptunghi::tip = 3;
            Dreptunghi::poz = poz;
            Dreptunghi::x = x;
            Dreptunghi::y = y;
        }
};

void main(void) {

    Grup gr(1);
    Punct pct(1);
    Segment sgm(3, 5);

    gr + pct;
    gr + sgm;
    //cout<<gr.i;
    cout<<sgm.x;
    gr.afiseaza_elemente();

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:02:25.987

数组索引从`0`到`N - 1`，当`N`是数组大小。以下代码将导致越界数组访问：

```
void adauga_element(Figura fig) {
    if( i <= nr_elemente)
        figuri[i++] = fig;
    else
        cout<<"Grupul a atins numarul maxim de figuri.";
} 
```

改成：

```
 if( i < nr_elemente) 
```

中的同样问题`afiseaza_elemente()`。

由于您有动态分配的成员，因此必须正确实现析构函数`delete[]`，动态分配的数组和复制构造函数和赋值运算符需要正确实现，或声明`private`以防止复制。由于这是 C++，请考虑使用`std::vector<Figura>`而不是数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:02:34.317

一个更简单的例子可以提高理解。

无论如何，您的问题被称为对象切片。

简而言之，您不能将派生对象放入基础对象数组中。

要解决此问题，您可以将 figuri 数据成员更改为指向 Figura 的指针数组：

```
Figura ** figuri;
// ...
figuri = new Figura*[nr_elemente]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:00:00.213

您没有初始化任何成员。您应该在构造函数中执行此操作。

例如：

```
Punct pct(1); 
```

仅初始化成员`tip`and `pos`，但`x`and`y`将包含垃圾值，您可能最终会看到这些值。

您也不应该使用动态分配的数组作为成员 -`Figura *figuri;`而是使用`std::vector`. 这也将使您免于添加新图形时遇到的未定义行为。

另外，请注意您的析构函数和复制构造函数没有实现，这是错误的来源。

```
void adauga_element(Figura fig) 
```

传递对象`fig`是按值传递的，所以应该实现一个拷贝构造函数。

# mysql - SQL 语法错误

> ID：10288157
> 
> 赞同：1
> 
> 时间：2012-04-23T20:54:48.627
> 
> 标签：mysql, sql

我正在运行我的第一个 SQL 查询，但不确定我的错误在哪里。第一行（日期）似乎运行正确。其他行似乎都没有工作 IE 它返回的结果评分低于 3.5。运行查询时没有收到错误消息，它运行成功。如果可能的话，解释一下我所缺少的“概念”。

看起来这应该是一个简单的查询，它从一个表“应用程序”中提取。'rating' 'downloads' 和 'lastUpdate' 都是列。

```
SELECT * FROM app
WHERE lastUpdate >= '2011-08-01' AND 
rating >= '3.5' AND 
downloads = '1 - 5' OR '10 - 50' OR '50 - 100' OR '100 - 500' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T20:57:19.623

试试这个

```
SELECT * FROM app
WHERE lastUpdate >= '2011-08-01' AND 
rating >= '3.5' AND 
(downloads IN ('1 - 5','10 - 50','50 - 100','100 - 500')) 
```

我不确定您的语法对于字符串或值是否正确，如果需要括号，或者任何这些或条件将在整个查询中返回 true。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T20:57:21.077

你不能像那样把 OR 串起来。试试这个替代版本：

```
SELECT * FROM app
WHERE lastUpdate >= '2011-08-01' AND 
rating >= '3.5' AND 

(downloads = '1 - 5' OR 
 downloads ='10 - 50' OR
 downloads ='50 - 100' OR 
 downloads ='100 - 500') 
```

您可以使用 IN 子句稍微缩短此语法，如下所示。

```
 downloads IN('1-5','10-50','90-100','100-500') 
```

这假定下载是一个 varchar 或文本类型，其中包含诸如“1-5”之类的值，并且它不是数字，并且您期望它返回 1、2、3、4、5。

如果你的意思是后者，你需要像这样指定这些参数

```
(downloads between 1 and 5 OR 
 downloads between 10 and 50 OR
 downloads between 50 and 100 OR 
 downloads between 100 and 500) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T20:58:27.900

```
SELECT * FROM app
WHERE lastUpdate >= '2011-08-01' AND 
rating >= '3.5' AND 
(downloads between 1 AND 5 OR downloads between 10 AND 50 OR downloads between 50 AND 100 OR downloads between 100 AND 500) 
```

# c++ - libudev 如何使用带有文件描述符的 poll

> ID：10288158
> 
> 赞同：2
> 
> 时间：2012-04-23T20:54:49.713
> 
> 标签：c++, linux

所以，我有一个应用程序，我想在 linux 上收到关于 hotplug 事件的通知。自然，我查看了 libudev 及其[API](https://www.kernel.org/pub/linux/utils/kernel/hotplug/libudev/api-index-full.html)。我还找到了有关如何将 select() 与 libudev 一起使用的有用[教程。](http://www.signal11.us/oss/udev/)按照教程并浏览 API，我想出了这个示例程序，它等待热插拔事件，然后输出有关刚刚添加或删除的设备的一些基本信息。

```
#include <poll.h>
#include <libudev.h>
#include <stdexcept>
#include <iostream>

udev* hotplug;
udev_monitor* hotplug_monitor;

void init()
{
  // create the udev object
  hotplug = udev_new();
  if(!this->hotplug)
  {
    throw std::runtime_error("cannot create udev object");
  }

  // create the udev monitor
  hotplug_monitor = udev_monitor_new_from_netlink(hotplug, "udev");

  // start receiving hotplug events
  udev_monitor_enable_receiving(hotplug_monitor);
}

void deinit()
{
  // destroy the udev monitor
  udev_monitor_unref(hotplug_monitor);

  // destroy the udev object
  udev_unref(hotplug);
}

void run()
{
  // create the poll item
  pollfd items[1];
  items[0].fd = udev_monitor_get_fd(hotplug_monitor);
  items[0].events = POLLIN;
  items[0].revents = 0;

  // while there are hotplug events to process
  while(poll(items, 1, 50) > 0)
  {
    // XXX
    std::cout << "hotplug[ " << items[0].revents << " ]" << std::endl;

    // receive the relevant device
    udev_device* dev = udev_monitor_receive_device(hotplug_monitor);
    if(!dev)
    {
      // error receiving device, skip it
      continue;
    }

    // XXX
    std::cout << "hotplug[" << udev_device_get_action(dev) << "] ";
    std::cout << udev_device_get_devnode(dev) << ",";
    std::cout << udev_device_get_subsystem(dev) << ",";
    std::cout << udev_device_get_devtype(dev) << std::endl;

    // destroy the relevant device
    udev_device_unref(dev);

    // XXX
    std::cout << "done" << std::endl;

    // clear the revents
    items[0].revents = 0;
  }
}

int main(int args, char* argv[])
{
  init();

  while(true)
  {
    run();
  }

  deinit();
} 
```

好吧，它不起作用。这是我插入 USB 鼠标时得到的输出。

```
hotplug[ 1 ]
hotplug[add] /dev/bus/usb/008/002,usb,usb_device
done
hotplug[ 1 ]
hotplug[add] 
```

此时程序冻结，我必须用 Ctrl-C 停止它。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:27:42.437

The program doesn't actually stop; it continues running, but std::cout gets messed up when you try to print a NULL string (not all events have all properties). A fix is to make the three prints (devnode, subsystem, devtype) conditional.

# php - 使用 Curl 从 html 表中获取信息

> ID：10288167
> 
> 赞同：0
> 
> 时间：2012-04-23T20:55:24.700
> 
> 标签：php, curl, simple-html-dom

我需要获取一些关于一些植物的信息并将其放入 mysql 表中。我对 Curl 和 DOM 的了解很少，但我已经做到了：

```
 set_time_limit(0);
include('simple_html_dom.php');

$ch = curl_init ("http://davesgarden.com/guides/pf/go/1501/"); 

curl_setopt($ch, CURLOPT_USERAGENT,"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;     rv:1.9.0.1) Gecko/2008070208 Firefox/3.0.1");
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Accept-Language: es-es,en"));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_BINARYTRANSFER,1);
curl_setopt($ch, CURLOPT_TIMEOUT,0); 
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
$data = curl_exec ($ch); 
curl_close ($ch); 

$html= str_get_html($data);

$e = $html->find("table", 8);

 echo $e->innertext; 
```

现在，我真的不知道如何从这一点搬进来，你能指导我吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:44:01.203

您最好的选择是将其包装在 php 中；）

是的，对于丑陋的 html 代码来说，这是一个丑陋的 hack。

```
<?php
ob_start();
system("
    /usr/bin/env links -dump 'http://davesgarden.com/guides/pf/go/1501/' |
    /usr/bin/env perl -lne 'm/((Family|Genus|Species):\s+\w+\s+\([\w-]+\))/ && \
        print $1'
");
$out = ob_get_contents();
ob_end_clean();
print $out;
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:08:10.690

这是一团糟。

但至少这是一个（有点）一致的混乱。

如果这是一次性提取而不是滚动项目，我个人会在此使用快速而肮脏的正则表达式，而不是 simple_html_dom。否则，您将整天在那里摆弄标签。

例如，这个正则表达式提取了大部分标题/数据对：

```
$pattern = "/<b>(.*?)</b>\s*<br>(.*?)</?(td|p)>/si"; 
```

不过，您需要先进行一些前后清洁，然后才能将它们全部清除。

我不羡慕你有这个任务...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:42:30.980

使用[Simple Html Dom](http://simplehtmldom.sourceforge.net/)，您将能够访问您希望的任何元素/元素的内容。他们的 api 非常简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-03T08:41:34.180

你可以试试这样的东西。

```
<?php 
$ch = curl_init ("http://www.digionline.ir/Allprovince/CategoryProducts/cat=10301");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$page = curl_exec($ch);

$dom = new DOMDocument();
libxml_use_internal_errors(true);
$dom->loadHTML($page);
libxml_clear_errors();
$xpath = new DOMXpath($dom);

$data = array();
// get all table rows and rows which are not headers
$table_rows = $xpath->query('//table[@id="tbl-all-product-view"]/tr[@class!="rowH"]');
foreach($table_rows as $row => $tr) {
    foreach($tr->childNodes as $td) {
        $data[$row][] = preg_replace('~[\r\n]+~', '', trim($td->nodeValue));
    }
    $data[$row] = array_values(array_filter($data[$row]));
}

echo '<pre>';
print_r($data);
?> 
```

# antlr - ANTLR：SQL 引擎 - AST 之外的细节

> ID：10288171
> 
> 赞同：1
> 
> 时间：2012-04-23T20:55:27.867
> 
> 标签：antlr, abstract-syntax-tree

一直想掌握一点编译器和 DSL，并且一直在尝试使用专门用于日志文件的类似 SQL 的引擎。

.. 我意识到已经有很多这样的东西了，但请记住，excersize 的一部分（嗯，大部分）是作为学习这些东西的借口。

我觉得我遇到了一个心理障碍，希望人们能帮助我通过它..

我读过的很多文章都集中在语法构建上，这很好——但我对从拥有/构建 AST 到真正让它做一些有用的事情感到困惑。

我一直在阅读[这本书](http://pragprog.com/book/tpdsl/language-implementation-patterns)中关于解释语言的章节——关于“馅饼”语言的章节——因为这似乎对构建语言的这个特定部分有最重要的意义。

如果我必须编写类似的代码

```
select x,y from "c:\temp\foo.txt" where x=1 delimited by {Commas} 
```

假设我已将文件的内容加载到 ArrayList 以使事情变得简单，那么我将构建一个外部树遍历器来遍历我的 AST 并将元素洗牌到中间存储中（如果它们匹配`x=1`） - 最后打印出最后一个缓冲区成为结果集。

期待提供任何指导。

干杯，王牌

# ruby-on-rails - SyntaxError: (irb):26: 块 arg 和实际块都给出

> ID：10288180
> 
> 赞同：3
> 
> 时间：2012-04-23T20:56:09.183
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord

我有这个查询

```
= f.select(:city, Country.where(:country_code => "es").collect(&:cities) {|p| [ p.city, p.id ] }, {:include_blank => 'Choose your city'}) 
```

问题是我收到以下错误

```
SyntaxError: (irb):26: both block arg and actual block given 
```

`collect(&:cities)`从我看到的情况来看，我通过包含然后声明块做错了。有没有办法可以用相同的查询来完成这两者？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-23T21:07:52.163

```
Country.where(:country_code => "es").collect(&:cities) 
```

完全一样

```
Country.where(:country_code => "es").collect {|country| country.cities} 
```

这就是您收到错误的原因：您将两个块传递给该`collect`方法。你实际上的意思可能是这样的：

```
Country.where(:country_code => "es").collect(&:cities).flatten.collect {|p| [ p.city, p.id ] } 
```

这将检索国家，获取每个国家/地区的城市列表，将数组展平为您只有一个一维数组，然后返回您的数组以供选择。

由于每个国家代码可能只有一个国家，您也可以这样写：

```
Country.where(:country_code => "es").first.cities.collect {|p| [ p.city, p.id ] } 
```

# java - clojure：使用变量 args 调用 java 类的静态方法

> ID：10288187
> 
> 赞同：1
> 
> 时间：2012-04-23T20:56:54.897
> 
> 标签：java, image, clojure

我正在尝试使用来自 clojure 的[Scalr](http://www.thebuzzmedia.com/software/imgscalr-java-image-scaling-library/) java 图像大小调整库：

```
[org.imgscalr/imgscalr-lib "4.2"] 
```

当我导入它并尝试使用它时，它会失败，因为每个方法采用的参数数量可变：

```
(import 'org.imgscalr.Scalr)
(def image (*acquire BufferedImage instance*))
(Scalr/resize image 200) 
```

这给了我这个错误：

```
No matching method: resize 
```

这是因为（正如我所知道的）resize 将可变数量的 BufferedImageOps 作为其最后一个参数。所以，我尝试为这些传递一个java数组：

```
(import 'java.awt.image.BufferedImageOp)
(Scalr/resize image 200 (into-array BufferedImageOp [])) 
```

但这失败了

```
No message.
[Thrown class java.lang.ClassCastException] 
```

我在这里做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:13:17.827

可能您没有按预期获取图像。例如，这对我有用....

```
*clojure-version*
{:major 1, :minor 3, :incremental 0, :qualifier nil}
user> (import 'java.awt.image.BufferedImageOp)
java.awt.image.BufferedImageOp
user> (import 'java.awt.image.BufferedImage)
java.awt.image.BufferedImage
user> (Scalr/resize (BufferedImage. 10 10 BufferedImage/TYPE_INT_ARGB) 200 (into-array BufferedImageOp []))
#<BufferedImage BufferedImage@ccfe446: type = 2 DirectColorModel: rmask=ff0000 gmask=ff00 bmask=ff amask=ff000000 IntegerInterleavedRaster: width = 200 height = 200 #Bands = 4 xOff = 0 yOff = 0 dataOffset[0] 0>
user> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:10:00.820

`into-array`调用看起来不错，但[**这里**](http://www.thebuzzmedia.com/downloads/software/imgscalr/javadoc/org/imgscalr/Scalr.html#resize%28java.awt.image.BufferedImage,%20int,%20java.awt.image.BufferedImageOp...%29)找到的方法签名采用 java.lang.Integer，在 Clojure`200`中，默认情况下您将是 java.lang.Long。

如何转换为 int：

```
(Scalr/resize image (int 200) (into-array BufferedImageOp [])) 
```

# php - 简单搜索小网站

> ID：10288190
> 
> 赞同：0
> 
> 时间：2012-04-23T20:57:00.633
> 
> 标签：php, mysql, search

我有大约 100 篇文章的网站，这些文章存储在 MySQL 数据库中。所有与数据库的连接都是使用 PDO 建立的。文章平均大小为 8kB（最小为 2kB，最大为 12kB）。文章数量每周增加约 2 篇。

我的服务器配置是：PHP 5.1.6，MySQL5.0.27，MySQL 引擎：InnoDB。不幸的是，我对更改任何服务器参数没有任何影响。

我想在我的网站上添加一个简单的搜索表单。用户可以键入，例如，3 到 40 个字符，并且应该搜索文章内容。我绝对不应该使用`LIKE`，这对于像我这样的初学者来说显然是最容易编码的。我已经阅读了一些关于全文搜索的内容，但我担心我将无法在我的服务器上使用它。

你会建议我为我的网站实施简单的搜索器吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:30:59.057

如果你想写点什么，我认为你应该深入研究全文搜索。正如@Dr.biziclop 注意到的那样 - 您想先将您的数据库引擎转换为 MyISAM。

[http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

# javascript - 将硬拷贝表格转换为电子表格或数据库

> ID：10288192
> 
> 赞同：0
> 
> 时间：2012-04-23T20:57:02.683
> 
> 标签：javascript, database, ms-access

我有大约 5,000 份纸质表格，需要将它们转换为电子表格或创建到诸如 microsoft access 之类的数据库中。

目标是避免尝试手动输入 5,000 个表格中的每一个。这将太乏味并且需要太多时间。

我一直在头脑风暴，只是想出了扫描它们。这也很乏味，需要一段时间。似乎没有办法解决这个问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:16:20.233

只需使用带有[文档进纸器](http://en.wikipedia.org/wiki/Automatic_document_feeder)的扫描仪。您可以一次插入一叠纸，它会单独拉动每一页。

像 Acrobat 这样的东西可以处理扫描/保存，甚至可以进行 OCR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T12:58:41.617

使用表单处理软件（google：form ocr）。如果你不想扫描它们，我相信你当地的复印店会为你做的。在谷歌中，您还可以找到完成整个工作的承包商。

您的选择取决于您面对这个问题的次数以及您愿意为自己支付/做多少

# css - div 背景未设置

> ID：10288194
> 
> 赞同：0
> 
> 时间：2012-04-23T20:57:04.943
> 
> 标签：css, html

```
#contentwrapper {
   background: #111;
   background: url('~/img/bg-black.png');
   width: 100%;
}
#content {
   width: 340px;
   height: 165px;
   margin: 240px auto;
   text-align: center;
} 
```

这是HTML：

```
<div id="content-wrapper">
<div id="content">
<h1 style="text-align: center">Test</h1>
<div style="clear:both"></div>
</div>
</div> 
```

我的问题是我试图将 contentwrapper 的背景图像设置为给定的链接，但是当我运行它时，它没有显示出来。我尝试重写、重新加载、读取等。没有任何效果

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T21:00:22.170

**拼写错误**
id contentwrapper

```
<div id="content-wrapper"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:01:28.947

尝试删除波浪号 ( `~`) 字符，并将其从站点的根目录映射。您也可以尝试删除引号或使用双引号，但它应该可以工作：

```
background: url(/images/dialog-gradient-beige.png); 
```

如果您无法从站点的根目录映射它，请尝试退出到 images 目录：

```
background: url("../images/bg-black.png"); 
```

# command-line - 当机器无法启动时，EC2 命令行会说什么？

> ID：10288206
> 
> 赞同：1
> 
> 时间：2012-04-23T20:57:43.010
> 
> 标签：command-line, amazon-ec2

在 Amazon EC2 上启动实例时，我将如何检测故障，例如，如果没有可用的机器来满足我的请求？我正在使用一种不太常见的机器类型，并且担心它不会启动，但在找出要查找的消息来检测这一点时遇到了麻烦。

我正在使用 EC2 命令行工具来执行此操作。我知道当我执行 ec2-describe-instance 以查看机器是否已启动时，我可以查找“正在运行”，但不知道要查找什么以查看启动是否失败。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:22:50.260

的输出`ec2-start-instances`仅返回 you `stopped pending`，正如您所说，您需要使用它[`ec2-describe-instances`](http://docs.amazonwebservices.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-DescribeInstances.html)来检索状态。

为此，您有几个选择；您可以使用循环来检查`instance-state-name`，寻找`running`or的结果`stopped`；或者，您可以查看`reason`or`state-reason-code`字段；不幸的是，您需要触发您担心的失败，以获得指示失败的值。

我用来等待启动成功的批处理文件（下划线填写）：

```
@echo off
set EC2_HOME=C:\tools\ec2-api-tools
set EC2_PRIVATE_KEY=C:\_\pk-_.pem
set EC2_CERT=C:\_\cert-_.pem
set JAVA_HOME=C:\Program Files (x86)\Java\jre6
%EC2_HOME%\bin\ec2-start-instances i-_
:docheck
%EC2_HOME%\bin\ec2-describe-instances | C:\tools\gnuwin32\bin\grep.exe -c stopped > %EC2_HOME%\temp.txt
findstr /m "1" %EC2_HOME%\temp.txt > nul
if %errorlevel%==0 (c:\tools\gnuwin32\bin\echo -n "."
goto docheck)
del temp.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T03:13:27.383

ec2-start-instances 将返回您之前的状态（在最后一个命令到实例之后）和当前状态（在您的命令之后）。ec2-stop 实例做同样的事情。问题是，如果您正在编写脚本并且在“停止”实例上使用*-start--或者*-您使用*-stop-**在“待定”实例上。这些将导致命令行工具出现异常，并且 NASTILY 将脚本一直退出到原始控制台（非常糟糕的行为，亚马逊）。所以你必须一路解析 ec2-describe-instances [instance-id] 结果。但是，这仍然使您容易受到从您的实例获取状态和应用命令之间的那一点点时间的影响。如果其他人或亚马逊将您置于挂起或停止状态，然后您分别执行“停止”或“启动”，您的脚本将中断。我真的不知道如何用脚本捕捉这样的异常。糟糕的亚马逊 AWS，糟糕的狗！*

# web-services - CXF 和 JAX-WS 标准之间的优势

> ID：10288211
> 
> 赞同：2
> 
> 时间：2012-04-23T20:58:00.113
> 
> 标签：web-services, cxf

我是 Web 服务编程的新手，当我在我的 Web 服务中使用简单的 JAX-WS 时，我偶然发现了 CXF。关键是我不确切知道 CXF（或其他 WS 框架，但特别是 CXF）添加到我的项目中......有人可以向我解释一下吗？

非常感谢你，尤里。

# c# - 在 C# 中获取动态创建按钮的文本？

> ID：10288214
> 
> 赞同：1
> 
> 时间：2012-04-23T20:58:09.973
> 
> 标签：c#

我正在使用此逻辑在 C# 中动态创建按钮

```
for (int i = 1; i <= vap; ++i)
{
    newButtons[i] = new Button();
    newButtons[i].BackColor = Color.Gray;
    newButtons[i].Name = "Button4" + i.ToString();
    newButtons[i].Click += new EventHandler(NewButtons_Click);

    newButtons[i].Location = new System.Drawing.Point(width,height);
    newButtons[i].Size = new System.Drawing.Size(76, 38);

    tabPage5.Controls.Add(newButtons[i]);
} 
```

这是创建一个按钮，点击事件也在工作，但我的问题是我不知道如何获取新创建按钮的文本。在表单加载时，我正在从数据库中放入按钮的文本，这也正确发生，但我想知道如何获取动态创建的按钮的文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:04:12.470

在从数据库中填充文本之前，您将无法获取文本（注意不要过早尝试获取文本）。

但这应该有效：

```
string buttonText = FindControl("Button41").Text; 
```

**更新**

由于您需要单击事件中的按钮文本，因此可以访问 sender 对象：

```
Button button = sender as Button;
string buttonText = button.Text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:03:22.330

您只需`Text`在添加按钮时设置按钮的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:06:31.643

使用类似于...的东西

字符串 BtnTxt = FindControl("ExampleButton1").Text;

应该可以正常工作。

但是，如果您尝试以随机顺序提取按钮的文本内容，这可能会在以后引起问题。

# vb.net - 过滤字典以返回列表

> ID：10288218
> 
> 赞同：0
> 
> 时间：2012-04-23T20:58:11.880
> 
> 标签：vb.net

我知道我可以用 for 循环来做到这一点，因为我现在就是这样做的。我希望有一种更有效的方式来完成这项任务。

我有一个字典（整数，布尔值）或字符串，布尔值。我想从字典中获取一个列表（整数）或字符串，其中所有值都为真（或假，取决于我当时需要什么）

并概括它或“黑匣子”它，它可以是任何字典（无论是什么，什么）并返回一个列表（无论什么），其中值=我当时正在寻找的任何东西。

字符串，字符串 where value = "Closed"

简而言之：我想要所有键值的所有列表 = 一些标准

我当前的代码：

```
 Public Function FindInDict(Of tx, ty)(thedict As Dictionary(Of tx, ty), criteria As ty) As List(Of tx)
    Dim tmpList As New List(Of tx)

    For xloop As Integer = 0 To thedict.Count - 1
        If CType(thedict(thedict.Keys(xloop)), ty).Equals(criteria) Then
            tmpList.Add(thedict.Keys(xloop))
        End If
    Next
    Return tmpList
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T01:51:55.937

您可以使用 Linq 轻松做到这一点：

```
Public Function FindInDict(Of tx, ty)(thedict As Dictionary(Of tx, ty), criteria As ty) As List(Of tx)
    Return (From kvp In thedict
            Where kvp.Value.Equals(criteria)
            Select kvp.key).ToList()
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:14:18.313

使用 LINQ，如下所示：

```
Dim tStorage As Dictionary(Of String, String) = New Dictionary(Of String, String)
Dim tKeys As List(Of String) = New List(Of String)
Dim tCriteria As List(Of String) = New List(Of String)

tStorage.Add("One", "Uno")
tStorage.Add("Two", "Dos")
tStorage.Add("Three", "Tres")
tStorage.Add("Four", "Quatro")

tCriteria.Add("Dos")
tCriteria.Add("Quatro")

tKeys = (From k In tStorage.Keys Where tCriteria.Contains(tStorage(k)) Select k).ToList

For Each tKey As String In tKeys
    Console.WriteLine(tKey)
Next

Console.ReadKey() 
```

# c# - 绝对路径和相对路径有什么区别？

> ID：10288223
> 
> 赞同：13
> 
> 时间：2012-04-23T20:58:31.620
> 
> 标签：c#, path, relative-path, absolute-path

我问是因为我正在为学校做一个项目。是的，这是家庭作业。但是，虽然，我试图了解更多一点。

这是所问内容的一个例子。

> • 当用户单击“保存”按钮时，将所选记录写入txtFilePath 中指定的文件（绝对路径不是相对路径），而不截断当前其中的值。

这就是我所拥有的，

```
private void button2_Click(object sender, EventArgs e)
{
    if (saveFileDialog1.ShowDialog() == DialogResult.OK)
    {
        StreamWriter myWriter = new StreamWriter(saveFileDialog1.FileName);
        myWriter.Write(txtFilePath.Text);
        myWriter.Close();
    }
} 
```

现在，我不明白我这样做是否正确。我知道当我将它保存到我的桌面并从我的列表框中删除它时，当我再次尝试重新加载它时，什么也没有出现。这就是我的表格，

```
private void button1_Click(object sender, EventArgs e)
{
    if (openFileDialog1.ShowDialog() == DialogResult.OK)
    {
        StreamReader myReader = new StreamReader(openFileDialog1.FileName);
        txtFilePath.Text = openFileDialog1.FileName;
        txtFilePath.Text = myReader.ReadToEnd();
        myReader.Close();
    }
} 
```

这就是负载，

```
private void Form1_Load(object sender, EventArgs e)
{
    string[] myFiles = Directory.GetFiles("C:\\");
    foreach (string filename in myFiles)
    {
        FileInfo file = new FileInfo(filename);
        employeeList.Items.Add(file.Name);
    }

    //... 
```

有人可以帮我理解这一点吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-23T21:01:39.960

假设您正在为某个地点指路。您有两种方法可以描述到达该位置：

*   相对于你所处的位置，
*   相对于地标。

两者都可以将您带到同一个位置，但前者并不*总是*有效（“向左走，然后向右走，穿过两个灯，然后再向右走”不一定从下一个城镇工作，而是从哪里工作你站着）。这就是本质上的区别。

如果你有`C:\Windows\System32`，那是一个绝对路径。如果你有`Windows\System32`，它只会在你*从*`C:\`. 如果你从那里开始，`C:\Program Files`你需要一个`..\`才能正确到达那里。

但是，无论您在硬盘驱动器上的哪个位置，都是`C:\Windows\System32\`访问该文件夹的明确方式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-23T21:04:11.607

这实际上是一个简单的区别。*相对*文件路径将是一个基于根节点的结构；并且*绝对*路径将是基于非模棱两可位置的结构。这听起来有点不可思议，但实际上非常简单。

这里有些例子：

**绝对路径**

```
 C:\inetpub\yourapplication\default.aspx
 http://www.yourapplication.com/default.aspx 
```

这些路径是绝对的，因为它们是明确的。示例 1 显示了绝对文件路径，示例 2 显示了绝对 URL。

**相对路径**

```
./../script/something.js
~/default.aspx 
```

相对路径基于某个已知的前方参考点指定位置。所以在示例 1 中，您知道要上一个目录，然后下到一个名为 的目录`script`，然后再到一个 javascript 文件。在示例 2 中，您指定了应用程序根目录中包含的 aspx 页面。

因此，与您的具体问题密切相关，您希望将文件写入特定的*绝对*路径，这意味着它需要是一个明确的位置。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-23T21:03:10.677

绝对路径是访问文件系统中的位置所需的完整路径名。
例如： `C:\Program Files\Internet Explorer\iexplorer.exe`

相对路径与某些地标有关，通常是您的主要可执行文件位置或打开程序时设置的“开始”位置。

例如，如果您的主要可执行文件位于 is`C:\Program Files\`的相对路径`iexplorer.exe`中`Internet Explorer\iexplorer.exe`。

这通常是在您不总是知道文件绝对在哪里时完成的，例如它将安装在哪个驱动器号或它将在哪个文件夹下。

但是，举个很好的例子，如果您的文件随您的程序一起提供并且您知道程序的安装结构，那么无论您的程序安装在哪里，您都可以使用相对路径来查找所有文件，而不是使用绝对路径来查找您的程序需要的位置每次都安装在完全相同的位置。

# sql - 包含字段中值的连接、分组和计数的 SQL 视图

> ID：10288226
> 
> 赞同：1
> 
> 时间：2012-04-23T20:59:20.097
> 
> 标签：sql, postgresql, window-functions

我们的目标是最终获得一个视图，显示每种类型和专业组合的 50 个最常见的程序代码。（特殊代码可以在不同类型中重复）

我有两张桌子：

表`providers`包含：
provider_type
provider_specialty
provider_id
（以及一些与此问题无关的数据）

表`services`包含：
provider_id
procedure_code
（和其他一些数据点 - 不相关）

最终结果将类似于：

```
Provider Type  |  Provider Specialty |  Procedure Code  |  Count
---------------+---------------------+------------------+-------
00             |  01                 | 97012            |  500 
00             |  01                 | 97013            |  450
00             |  02                 | 97012            |  270
00             |  02                 | 97013            |  900
01             |  01                 | 97012            |  845
01             |  01                 | 97013            |  1200 
```

有任何想法吗？我知道这是一个超级复杂的查询，我考虑过构建一个脚本来执行更新周期，但我宁愿拥有更多的实时数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:32:34.213

> 每种类型和专业组合的 50 个最常见的程序代码

应该像这样工作：

```
WITH x AS (
    SELECT p.provider_type, p.provider_specialty, s.procedure_code
          ,count(*) AS ct
          ,row_number() OVER (PARTITION BY p.provider_type, p.provider_specialty
                              ORDER BY count(*) DESC) AS r
    FROM   providers p
    JOIN   services s USING (provider_id)
    GROUP  BY 1,2,3
    )
SELECT x.provider_type, x.provider_specialty, x.procedure_code, x.ct
FROM   x
WHERE  x.r <= 50
ORDER  BY 1,2,4,3; 
```

### 要点

*   我使用 CTE（PostgreSQL 8.4 或更高版本），您可以对子查询执行相同操作。

*   我使用[窗口函数`row_number()`](http://www.postgresql.org/docs/current/interactive/functions-window.html#FUNCTIONS-WINDOW-TABLE)（同样是 PostgreSQL 8.4 或更高版本）来限定`procedure_code`.

*   请注意，您可以`ORDER BY count(*)`在`OVER`子句内。也就是说，在窗口函数中使用聚合函数的结果，因为**窗口函数是在聚合函数之后应用的**。

*   您不能*对*做同样的事情`ORDER BY ct`，因为窗口函数不知道别名。

*   决赛`SELECT`很容易，只需返回每组的前 50 名。

# c++ - 在嵌入式系统的设计和架构中考虑混沌猴子

> ID：10288227
> 
> 赞同：0
> 
> 时间：2012-04-23T20:59:25.660
> 
> 标签：c++, c, embedded, ada

我在内存和吞吐量有限的嵌入式系统上工作。使系统更健壮需要更多的内存和处理器上的时间。我喜欢[Chaos Monkey](http://www.codinghorror.com/blog/2011/04/working-with-the-chaos-monkey.html)的想法，以确定您的系统是否具有容错能力，但是在资源有限的情况下，我不确定继续向其添加代码是否可行。无论是在架构中还是在其他方面，是否有某些设计考虑可以提高故障处理能力，而不必向系统添加“更多代码”？

我见过的一种方法有助于防止在 c（或 c++）中编写 if then 语句来分配而不是比较静态值，建议将其写在比较的左侧，如果您尝试分配您的变量说数字 5，事情会抱怨，你可能会马上发现任何问题。

是否有可以及早做出的架构或设计决策，以类似的方式防止可能的冗余/可靠性问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:19:07.487

是的，可以使用许多其他技术。您最好购买并阅读“代码完成”。

[亚马逊上的代码完成](https://rads.stackoverflow.com/amzn/click/com/0735619670)

# ruby-on-rails - 当我不希望发送设计确认电子邮件时

> ID：10288228
> 
> 赞同：2
> 
> 时间：2012-04-23T20:59:30.330
> 
> 标签：ruby-on-rails, devise, devise-confirmable

所以这是棘手的事情。

当用户尝试在网站上更改或更新他的电子邮件地址时，我确实希望发送一封电子邮件。但是，我不希望在用户首次注册时发送电子邮件。这真的很难实现，因为有了可确认的模块，我似乎不能没有另一个。

有关解决此问题的最佳方法的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T01:18:08.643

您可以覆盖registrationscontroller。

在创建动作中调用resource.skip_confirmation！在调用 resource.save 之前。

# r - 适用于 sarlm 类

> ID：10288235
> 
> 赞同：1
> 
> 时间：2012-04-23T21:00:20.960
> 
> 标签：r, latex, xtable

我喜欢`apsrtable()`，并且发现扩展到其他类有点简单（特别是，我已经为`mlogit`对象进行了调整。但由于某种原因，该`apsrtableSummary.sarlm()`函数不像我编写的其他 hack 那样工作。

通常，我们需要重新定义系数矩阵，以便`apsrtable()`知道在哪里可以找到它。代码是

```
"apsrtableSummary.sarlm" <- function (x){
  s <- summary(x)
  s$coefficients <- s$Coef
  return(s)
} 
```

我们还需要`modelInfo`为新类重新定义 ，如下所示：

```
setMethod("modelInfo", "summary.sarlm", function(x){
  env <- sys.parent()
  digits <- evalq(digits, envir=env)
  model.info <- list(
    "$\\rho$" = formatC(x$rho, format="f", digits=digits),
    "$p(\\rho)$" = formatC(x$LR1$p.value, format="f", digits=digits),
    "$N$" = length(x$fitted.values),
    "AIC" = formatC(AIC(x), format="f", digits=digits),
    "\\mathcal{L}" = formatC(x$LL, format="f", digits=digits)
  )
  class(model.info) <- "model.info"
  return(model.info)
}) 
```

然而，在定义这两个函数之后，调用`apsrtable()`不会打印系数（MWE 使用包中的示例`lagsarlm`）`spdep`。

```
library(spdep)
library(apsrtable)
data(oldcol)
COL.lag.eig <- lagsarlm(CRIME ~ INC + HOVAL, data=COL.OLD,
                         nb2listw(COL.nb, style="W"), method="eigen")
summary(COL.lag.eig)
# Load functions above
apsrtable(COL.lag.eig)

## OUTPUT ##
\begin{table}[!ht]
\caption{}
\label{} 
\begin{tabular}{ l D{.}{.}{2} } 
\hline 
  & \multicolumn{ 1 }{ c }{ Model 1 } \\ \hline
 %                           & Model 1 \\
 $\rho$.rho                 & 0.43   \\ 
$p(\rho)$.Likelihood ratio & 0.00   \\ 
$N$                         & 49     \\ 
AIC                         & 374.78 \\ 
\mathcal{L}                & -182.39 \\ \hline
 \multicolumn{2}{l}{\footnotesize{Standard errors in parentheses}}\\
\multicolumn{2}{l}{\footnotesize{$^*$ indicates significance at $p< 0.05 $}} 
\end{tabular} 
 \end{table} 
```

如您所见，除了系数和标准误差不存在之外，一切都很好。很明显，摘要重新定义有效，因为

```
apsrtableSummary(COL.lag.eig)$coefficients
              Estimate Std. Error   z value     Pr(>|z|)
(Intercept) 45.0792505 7.17734654  6.280768 3.369041e-10
INC         -1.0316157 0.30514297 -3.380762 7.228517e-04
HOVAL       -0.2659263 0.08849862 -3.004863 2.657002e-03 
```

几天来，我一直在拔头发，试图找到摆脱这种情况的方法。有小费吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T02:22:12.523

好吧，我想我可能是地球上唯一同时使用这两个软件包的人，但我想出了解决这个问题的方法。

事实证明，错误的根源在于类对象的`coef`方法。`summary.sarlm`通常，此方法返回一个带有系数表的矩阵，但对于此类，它只返回系数。下面的代码解决了这个问题。

```
setMethod("coef", "apsrtableSummary.sarlm", function(object) object$coefficients) 
```

`rho`我还发现将术语作为模型系数包含在内很有用（方法在这方面并不一致）。

```
apsrtableSummary.sarlm <- function (x){
  s <- summary(x)
  s$rholine<- c(unname(s$rho), s$rho.se, unname(s$rho/s$rho.se),
                unname(2 * (1 - pnorm(abs(s$rho/s$rho.se)))))
  s$Coef <- rbind(s$rholine, s$Coef)
  rownames(s$Coef)[1] <- "$\\rho$"
  s$coefficients <- s$Coef
  return(s)
} 
```

# oracle - 查询以检查记录是否存在和列是否为空

> ID：10288239
> 
> 赞同：0
> 
> 时间：2012-04-23T21:00:35.620
> 
> 标签：oracle

我有一个表，我必须检查一个特定的列是否为空或有值。
假设列名是`order_price`.

如果我只是检查`where order_price is null`，那么这也包括不在表中的记录。
例如，我`order_id = 1`的 order_price 为空，而我`order_id = 2`的订单表中不存在。因此，我不想使用 where 条件来检查 order_price 是否为空，而是想知道该列是否为空或记录不存在。

我在这个表上做外连接，所以我不能映射另一个表的主键。我正在使用甲骨文。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:10:32.347

您可以使用“EXISTS / NOT EXISTS”关键字和子查询来代替 Join 。

例如

```
SELECT parent.* 
FROM parent 
WHERE EXISTS (SELECT 1 
              FROM child 
              WHERE child.id_parent = parent.id AND child.somecolumn IS NULL) 
```

您可以根据您是否希望谓词匹配来使用“存在/不存在”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T10:51:36.060

```
SELECT  o.*,
        od.order_price,
        CASE
        WHEN od.order_id IS NULL THEN
                'Not exists'
        WHEN od.order_price IS NULL THEN
                'Exists, IS NULL'
        ELSE
                'Exists, IS NOT NULL'
        END AS nullness
FROM    orders o
LEFT JOIN
        order_data od
ON      od.order_id = o.id 
```

# php - Apache 2 和 .htaccess 正在下载而不是运行 PHP 文件

> ID：10288240
> 
> 赞同：1
> 
> 时间：2012-04-23T21:00:55.440
> 
> 标签：php, apache2

我正在尝试在 OS X（Snow Leopard，10.6.8）上将 .htaccess 文件与 PHP 一起使用，但是当我转到 localhost/ 时，浏览器只会下载重写规则导致的任何文件（而不是获取PHP 的服务器端执行）。

我已经确认 PHP 在其他更简单的安装上与 Apache 一起运行。对于调试，我的目标是 check.php 脚本，这样应该很好。

网络上充满了寻找并用 AllowOverride All 替换所有 AllowOverride None 语句的指导，但我的 apache 配置与基本 OS X 安装不同，并且不包括任何具有 AllowOverride None 指令的各种文件。我已经设置了我的配置所涉及的所有内容。

当它们被 URL 命中时，相同的配置会很好地运行 php 脚本。

我已经确认 mod_rewrite.so 可用并已加载。

我很感激帮助诊断/调试这个。

编辑：另外，当我从 Firefox 中点击页面时，我得到一个对话框，上面写着“您已选择打开 [空白，用于索引 url]，它是：application/x-httpd-php5”并选择保存或运行. x-httpd-php5 值是我在 .htaccess 文件的 AddType 指令中使用的字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:02:58.570

确保在首选项中打开了 Web 共享。

# php - PHP Web 套接字 - 无法绑定到主机

> ID：10288244
> 
> 赞同：2
> 
> 时间：2012-04-23T21:01:12.453
> 
> 标签：php, sockets

我正在尝试遵循本教程：

[http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/](http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/)

但是，为了爱和金钱，我无法从控制台中得到回应。

我手动加载了 startDeamon，发现它无法绑定到我的（本地）主机。

```
Warning: socket_bind() [function.socket-bind]: Host lookup failed [-10001]: Unknown host 
```

我的本地服务器在[http://localhost:33](http://localhost:33)上运行。我已经将我的主机指定为 localhost 和 127.0.0.1，有和没有 http，有和没有指定端口，但没有任何乐趣。

谁能帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:23:53.500

尝试使用端口 12345 而不是 33。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T10:38:05.953

删除 http:// 部分，然后尝试以本地主机身份访问它

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-12-11T15:19:06.173

处理套接字时不能使用 localhost 或 127.0.0.1，而是需要使用域/主机名或主机 IP 地址。它在 PHP5 手册部分中被解释为用户体验

# c# - 计算时间戳列表<>中的时间跨度

> ID：10288245
> 
> 赞同：0
> 
> 时间：2012-04-23T21:01:14.590
> 
> 标签：c#, list, timespan

我有一个清单：

```
List<DateTime> timeStamp; 
```

假设该列表包含以下日期时间：

```
2006-09-07 11:46:09
2006-09-07 11:46:19
2006-09-07 11:46:20
2006-09-07 11:46:36

2006-09-07 11:47:49
2006-09-07 11:47:53
2006-09-07 11:48:02
2006-09-07 11:48:15
2006-09-07 11:48:29
2006-09-07 11:48:34

2006-09-07 11:54:29
2006-09-07 11:54:39
2006-09-07 11:54:49
2006-09-07 11:54:59

2006-09-07 11:56:19
2006-09-07 11:56:29
2006-09-07 11:56:39 

2006-09-07 11:58:29
2006-09-07 11:58:34
2006-09-07 11:58:45
2006-09-07 11:58:53

2006-09-07 12:00:29
2006-09-07 12:00:39
2006-09-07 12:00:45
2006-09-07 12:00:54
2006-09-07 12:01:03 
```

现在，我想计算总累积时间。所有这些时间都在同一个列表中，间隔代表一个停止/开始部分。我也无法控制时间戳的间隔。可能是 10 秒，也可能是 1 分钟。感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:03:12.173

如果您可以定义间隙的长度，这是一个新的答案：

```
var length = timestamps
           .Zip(timestamps.Skip(1), (a, b) => b - a)      // pairwise entries and timespan
           .Where(gap => gap < TimeSpan.FromSeconds(180)) // ignore large gaps
           .Sum(x => x.TotalMilliseconds);                // total span in ms 
```

这通过将列表压缩到自身来工作，以便彼此相邻的条目可供选择（即，列表被“成对”选择）。时间跨度是从这些计算出来的，并且大的时间跨度（即您想要忽略的时间间隔）被过滤掉。

# javascript - getElementsByName 返回未定义

> ID：10288247
> 
> 赞同：0
> 
> 时间：2012-04-23T21:01:18.310
> 
> 标签：javascript, html

这是我的 JavaScript：

```
<script type="text/javascript">
    var crct_answrs = new Array(<?php echo implode(',', $crct_ans); ?>);
    var answrs = new Array();

    function check_ans(){
        for(var i = 1; i < 11; i++){
            var tst = "ques"+i;
            var radio = document.getElementsByName(tst);
            for (var x = 0; x < radio.length; x ++) {
                if (radio[x].checked) {
                    answrs = radio.value;
                }   
            }
        }       
    }   
</script> 
```

这是 HTML 的一部分：

```
<form>
            <div id="quest1" class="question">
                <div class="prblm">
                    <?php echo $questions[1]; ?></div>
                <table class="answrs">
                    <tr>
                        <td><?php echo $answrs[1][1]; ?></td>
                        <td><input name="ques1" type="radio" value="1"></td>
                    </tr>
                    <tr>
                        <td><?php echo $answrs[1][2]; ?></td>
                        <td><input name="ques1" type="radio" value="2"></td>
                    </tr>
                    <tr>
                        <td><?php echo $answrs[1][3]; ?></td>
                        <td><input name="ques1" type="radio" value="3"></td>
                    </tr>
                    <tr>
                        <td><?php echo $answrs[1][4]; ?></td>
                        <td><input name="ques1" type="radio" value="4"></td>
                    </tr>
                </table>
            </div> 
```

我有 10 个`div`与表格相同的模式标签，`input`名称也相应更改。 `check_ans()`上运行`onclick`。但`getElementsByName`总是返回未定义。为什么会发生这种情况。请帮我。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:18:09.023

你的错误在于：

```
if (radio[x].checked) {
    answrs = radio.value;
} 
```

`answrs`是一个数组，需要将值设置为其所在的相应迭代器的索引。 `radio.value`正在尝试从`radio`数组中访问值，但也忽略了它的索引。在下面查看我的解决方案以进行修复：

* * *

我有一个[jsFiddle](http://jsfiddle.net/9YprE/)工作。

**JavaScript：**

```
var answrs = [];

function check_ans() {
    for (var i = 1; i <= 10; i++) {
        var radio = document.getElementsByName("ques" + i);
        for (var x = 0; x < radio.length; x++) {
            if (radio[x].checked) {
                answrs[i-1] = radio[x].value;
            }
        }
    }
    console.log(answrs);
}​ 
```

**输出：**

为问题 1-10 选择答案 1、2、3、4、3、2、1、2、3、4 时，数组为：

```
["1", "2", "3", "4", "3", "2", "1", "2", "3", "4"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:19:37.607

嗯。这对我有用（我删除了一些 PHP 代码）

```
<html>
<head>
<script type="text/javascript">
    var crct_answrs = new Array();
    var answrs = new Array();

    function check_ans(){

        for(var i = 1; i < 11; i++){
            var tst = "ques"+i;

            var radio = document.getElementsByName(tst);
            alert(radio);
            for (var x = 0; x < radio.length; x ++) {
                if (radio[x].checked) {
                    answrs = radio.value;
                }   
            }
        }       
    }   
</script>
</head>
<body>
<button type="button" onclick="check_ans();">test</button>
            <div id="quest1" class="question">
                <div class="prblm">
                    <?php echo $questions[1]; ?></div>
                <table class="answrs">
                    <tr>
                        <td><?php echo $answrs[1][1]; ?></td>
                        <td><input name="ques1" type="radio" value="1"></td>
                    </tr>
                    <tr>
                        <td><?php echo $answrs[1][2]; ?></td>
                        <td><input name="ques1" type="radio" value="2"></td>
                    </tr>
                    <tr>
                        <td><?php echo $answrs[1][3]; ?></td>
                        <td><input name="ques1" type="radio" value="3"></td>
                    </tr>
                    <tr>
                        <td><?php echo $answrs[1][4]; ?></td>
                        <td><input name="ques1" type="radio" value="4"></td>
                    </tr>
                </table>
            </div>

<body/>
</html> 
```

与您的代码有什么不同吗？警报调用显示值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-20T20:50:28.047

我有时会得到一个未定义的 var 分配给`document.getElementsByName(name)`.

所以我会尝试看看网络上的任何答案是否会有所帮助。唉，没有任何效果。

所以我继续测试了我认为应该得到的阵列。元素就在那里。因此，只需忽略“未定义”并继续使用 var。

# php - 合计一列的总和并保存为变量

> ID：10288248
> 
> 赞同：0
> 
> 时间：2012-04-23T21:01:20.260
> 
> 标签：php, mysql, variables, sum

尝试对列的总数求和并保存为变量。该查询有效，因为我已经使用 PHPMyAdmin 对其进行了测试。只是努力将从查询中收到的数字保存到变量中。

```
 $con = mysql_connect(DB_HOST, DB_USER, DB_PASS);
 if (!$con)
   {
   die('Could not connect: ' . mysql_error());
   }

 mysql_select_db(DB_NAME, $con);

 $result = mysql_query("SELECT SUM(column_name) FROM tablename");

  mysql_close($con); 
```

任何帮助将非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:05:25.023

尝试这个：

```
$result = mysql_query("SELECT SUM(column_name) as soma FROM tablename");

$row= mysql_fetch_array($result);

$sum= $row['soma']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:05:07.277

我相信这样的事情会奏效：

```
$result = mysql_query("SELECT SUM(column_name) as thesum FROM tablename");
$sum = mysql_result( $result, 0, "thesum"); 
```

甚至这应该工作：

```
$sum = mysql_result( $result, 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:06:19.070

```
$sql = "Select SUM(ver) AS ver from tablename";
$sum = mysql_query($sql);
$result= mysql_fetch_object($sum);
echo $result->ver; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T21:06:23.147

像这样的东西？

```
$result = mysql_query("SELECT SUM(column_name) FROM tablename");
$row = mysql_fetch_assoc($result);
$sum = $result[0]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T21:07:51.467

测试 $result 是否存在也是一个好习惯：

```
if (!$result) {
    die('Invalid query: ' . mysql_error());
} 
```

# html - 在 HTML5 小部件上启动时未触发播放事件

> ID：10288253
> 
> 赞同：1
> 
> 时间：2012-04-23T21:01:40.607
> 
> 标签：html, soundcloud

当 SoundCloud HTML5 Player Widget 加载`autoplay`选项时，`play`在曲目开始时不会触发事件。但是，在加载小部件（或将其他 URL 加载到小部件中）和轨道开始时之间存在超时，因此调用事件是一个不错的小部件。

这是设计使然还是需要解决的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T01:40:58.613

当使用 auto_play 选项时，HTML5 Player 小部件应触发 SC.Widget.Events.PLAY 事件。这是我用来验证的代码片段：

HTML：

```
<!doctype html>
<html>
  <head>
    <title>Widget Demo</title>
    <style type="text/css">
    iframe {
      display:block;
      border:0;
      margin-bottom: 20px;
      height: 365px;
    }
    </style>
  </head>
  <body>
    <iframe id="widget" width="100%"></iframe>
  </body>
  <script src="http://w.soundcloud.com/player/api.js"></script>
  <script src="script.js"></script>
</html> 
```

JavaScript（script.js 的内容）：

```
(function() {
    var iframe = document.querySelector('#widget');
    iframe.src = 'http://w.soundcloud.com/player/?url=http://api.soundcloud.com/tracks/43315398&auto_play=true';

    var widget = SC.Widget(iframe);

    widget.bind(SC.Widget.Events.PLAY, function(eventData) {
        alert('Playing...');
    });
}()); 
```

[您可以在 jsfiddle 上](http://jsfiddle.net/5XnSq/ "JSFiddle 示例")查看一个工作示例。

# javascript - 如何将特定列表元素传递给 Javascript 函数

> ID：10288254
> 
> 赞同：2
> 
> 时间：2012-04-23T21:01:44.903
> 
> 标签：javascript, jquery, html

在我的网页上，我有一个图像列表。目前，当用户将鼠标悬停在任何图像上 3 秒时，`showUpdateImageDialog()`会执行一个方法，该方法会弹出一个 jQuery 对话框。如果用户在 3 秒内的任何时候将鼠标从图像上移开，则计时器将重置并且 jQuery 对话框永远不会显示：

HTML：

```
<ul class="imageGroup">
    <li class="imageLi">
        <img class="image" src="fizz/buzz/blah.jpg"/>
    </li>
    <li class="imageLi">
        <img class="image" src="fizz/buzz/example.jpg"/>
    </li>
    ...
</ul>

<div id="edit-image-description-frame" title="Update Image Description">
    <div id="thumbnail-dialog-image-container">

        <!-- How do I get the 'src' attribute to be the correct image file? -->
        <img src="???"/>
    </div>

</div> 
```

JS：

```
$(".imageLi").live({
    mouseenter:
        function()
        {
            window.myTimeout = setTimeout(showUpdateImageDialog,3000);
        },
    mouseleave:
        function()
        {
            clearTimeout(window.myTimeout);
        }
});

function showUpdateImageDialog()
{
    $('#edit-image-description-frame').dialog({
        modal:true,
        minHeight:500,
        minWidhth:500
    });
} 
```

不幸的是，**无论**用户将鼠标悬停在列表中的哪个图像上，此代码的行为都是相同的。我需要一种方法让 jQuery 对话框显示用户悬停的特定图像：

**如何将图像的源传递给 jQuery，以便让对话框将此图像呈现给用户？**这可能看起来很奇怪，但该对话框将允许用户编辑有关图像的元数据并更新该元数据。由于其他限制，我需要使用图像的`src`属性来查找元数据。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:07:25.420

```
$(".imageLi").live({
    mouseenter: function()
    {
        var src = $(this).children('img')[0].src;
        window.myTimeout = setTimeout(function ()
        {
            showUpdateImageDialog(src);
        },3000);
    },
    mouseleave: function()
    {
        clearTimeout(window.myTimeout);
    }
});

function showUpdateImageDialog(src)
{
    $('#thumbnail-dialog-image-container').children('img')[0].src = src;

    $('#edit-image-description-frame').dialog({
        modal:true,
        minHeight:500,
        minWidth:500
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:08:45.330

将其作为参数传递给您的函数

```
$(".imageLi").live({
    mouseenter:
        function()
        {
            var element = $(this).find('img');
            window.myTimeout = setTimeout(function(){showUpdateImageDialog(element);},3000);
        },
    mouseleave:
        function()
        {
            clearTimeout(window.myTimeout);
        }
});

function showUpdateImageDialog(image)
{
   // do what you want with image variable
   // it refers to the img element inside the li that was hovered
    $('#edit-image-description-frame').dialog({
        modal:true,
        minHeight:500,
        minWidhth:500
    });
} 
```

# delphi - 使用 SSL 的 Delphi 和 Indy

> ID：10288260
> 
> 赞同：5
> 
> 时间：2012-04-23T21:02:27.743
> 
> 标签：delphi, ssl, indy

带有 Indy 10.5.8.0 的 Delphi 7。

如果这是重复以前提出的问题，我深表歉意，但我无法解决这个问题。

我正在使用 Indy TidMessageBuilderHTML 发送带有嵌入图像的 HTML 电子邮件来构建我的 html 电子邮件。这非常酷，到目前为止效果很好。

我现在的问题是迎合需要 SSL/TLS 身份验证的 SMTP 服务器。我对 OPENSSL DLL 文件有很多问题，现在看来 32 位版本不能在 64 位等上运行。我想要一个避免使用 DLL 文件的解决方法。（最好我需要将其保留为单个 exe。应用程序）。

那么我的问题是：我想按原样使用 Indy V10，而不必发送 OPENSSL dll。有没有办法做到这一点？是否没有支持 Indy ssl (TIdSSLIOHandlerSocketOpenSSL) 的可用 delphi SSL 库？

此外，我愿意接受其他建议，这些建议将有助于我的嵌入图像的 html 电子邮件。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T17:56:47.343

您询问了支持 TIdSSLIOHandlerSocketOpenSSL 类的库，但这正是在其 TIdSSLIOHandlerSocketOpenSSL.StartSSL 方法中需要外部 DLL 的类。

最简单的解决方案是提供 DLL（32 位或 64 位版本），并在运行时检查 DLL 的存在，然后再尝试调用“SendMail”函数，这样您就可以向用户呈现更易于理解的错误消息，准确指出哪些文件预计会被您的应用程序找到。

# java - 在数组中搜索一个元素并返回它

> ID：10288277
> 
> 赞同：0
> 
> 时间：2012-04-23T21:03:16.470
> 
> 标签：java, arrays, search, return

简而言之，这是我的两难境地：我导入了一个文件，其中包含给定年份的前 2000 个名称，格式如下：

```
Mary, F, 2038 
Anna, F, 4230 
```

（姓名，性别，在这一特定年份有多少人被命名）。

我已经用这些数据创建了一个数组（类型字符串）。现在，我必须做的是让用户搜索一个名字，并返回他们最好的年份。例如：搜索“山姆”

输出应该是：

```
"isamar 1990"
"rosamond 1910"
"sam 1900"
"samantha 1990"
"samara 2000" 
```

程序远不止这些，但我只需要知道如何在数组中搜索，返回我在数组中找到的内容，就完成了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T21:11:20.090

搜索数组可以像迭代它并将每个元素与所需术语进行比较一样简单。例如，假设您有以下模型：

```
public class CommonName {
  public final String name;
  public final int year;
  public final CommonName(String name, int year) {
    this.name = name;
    this.year = year;
  }
} 
```

假设您已经将文件作为这些对象的数组加载，那么您可以使用以下[方法](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#indexOf(java.lang.String))`loadedNames`搜索它们：[`String#indexOf(String)`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#indexOf(java.lang.String))

```
public static CommonName[] loadedNames = /* ... */;
public static Collection<CommonName> search(String searchTerm) {
  Collection<CommonName> matches = new ArrayList<CommonName>();
  for (CommonName cn : loadedNames) {
    if (cn.name.indexOf(searchTerm) >= 0) { matches.add(cn); }
  }
  return matches;
} 
```

当然，`O(n)`您可能需要解决其他问题，例如区分大小写和性能（数组搜索是）。

# css - 谷歌字体不起作用时如何定义字体

> ID：10288280
> 
> 赞同：1
> 
> 时间：2012-04-23T21:03:28.857
> 
> 标签：css, fonts, safari

我需要一个解决方案.. 我在我的网站上使用 google 字体，但它在 safari 中不起作用，我如何告诉浏览器在字体不起作用时使用不同的样式？这是我的CSS代码：

```
@import url(http://fonts.googleapis.com/css?family=Pontano+Sans); 
    h2{ 
    font-family: 'Pontano Sans', sans-serif; 
    font-size: 15px; 
    text-transform: uppercase; 
    } 
```

我只想有另一个像这样的 css 规则，但没有它覆盖上述规则：

```
h2{        
font-family: Arial, Helvetica, sans-serif; 
    color: #666; 
    font-size: 12px; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:12:11.750

您应该使用 web-fonts 加载器功能来处理未加载字体的情况。这样，您可以根据加载状态（活动/非活动/加载）指定不同的样式。

请参阅[有关加载状态](https://developers.google.com/webfonts/docs/webfont_loader#Styles)（和[github](https://github.com/typekit/webfontloader)）的 web-fonts 加载器参考。

# ubuntu - 无法从 OS X 对 Arduino 进行编程

> ID：10288281
> 
> 赞同：1
> 
> 时间：2012-04-23T21:03:30.160
> 
> 标签：ubuntu, osx-lion, arduino

我正在尝试从 OS X Lion 编写一个 Arduino。它绝对行不通，我没有其他机器可以解决这个问题。

这是我尝试上传时遇到的错误：

```
Binary sketch size: 1260 bytes (of a 32256 byte maximum)
avrdude: stk500_recv(): programmer is not responding 
```

我尝试擦除并重新安装 arduino 开发工具包，但我得到了同样糟糕的结果。

我还尝试在运行 ubuntu 的 VMWare Fusion 上对此进行编程。我也一样`programmer not responding error`。`/var/log/syslog`在此过程中 我也观察了我的，并看到以下错误：`io/hpmud/pp.c 627: unable to read device-id ret=-1` 我不知道该怎么做。

我不认为它是一个糟糕的董事会。我对 2 个 arduino 有同样的问题：一个全新的 arduino 开箱即用，另一个 3 周大。这曾经有效，但突然失败了。

我可以测试和验证我正在使用的 USB 端口是否有任何低级 CLI 工具？

我怎样才能让这个 arduino 接受我的程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:16:13.967

我也有一个 MAC，类似的事情发生在我身上......我通过创建文件夹 /var/tmp 解决了它

您可以在终端输入中执行此操作：

`sudo mkdir /var/tmp`

也许你需要给它完全烫发。

`sudo chmod 777 /var/tmp`

但我不担心这一步。

它对我有用，因为 arduino 程序尝试将临时文件写入此文件夹，如果该文件夹不存在，则程序假定程序员发生了一些问题。

也许它对你有用，也许不是……我们拭目以待！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-29T19:29:03.143

同样的问题......我启用了详细模式并得到了类似的东西：

```
Using Port                    : /dev/cu.usbserial-A6013O93
         Using Programmer              : arduino
         Overriding Baud Rate          : 115200    
/Applications/Arduino.app/Contents/Resources/Java/hardware/tools/avr/bin/avrdude -C/Applications/Arduino.app/Contents/Resources/Java/hardware/tools/avr/etc/avrdude.conf -v -v -v -v -patmega328p -carduino -P/dev/cu.usbserial-A6013O93 -b115200 -D -Uflash:w:/var/folders/d6/nx58qfsj6zbbw65bcsrnxc4r0000gn/T/build6866034938793144439.tmp/Blink.cpp.hex:i 
```

将波特率更改为 57600（**-b11520**至**-b57600**）：

```
/Applications/Arduino.app/Contents/Resources/Java/hardware/tools/avr/bin/avrdude -C/Applications/Arduino.app/Contents/Resources/Java/hardware/tools/avr/etc/avrdude.conf -v -v -v -v -patmega328p -carduino -P/dev/cu.usbserial-A6013O93 -b57600 -D -Uflash:w:/var/folders/d6/nx58qfsj6zbbw65bcsrnxc4r0000gn/T/build6866034938793144439.tmp/Blink.cpp.hex:i 
```

它奏效了。程序已上传。希望能帮助到你。

# asp.net - ASP.Net MVC 3 应用程序自动安装程序

> ID：10288282
> 
> 赞同：2
> 
> 时间：2012-04-23T21:04:05.150
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

我想知道是否可以自动部署 ASP.Net MVC 应用程序。该应用程序旨在在主机 PC 上本地运行，我想做的是创建一个安装程序，以使最终用户可以轻松快速地进行设置。我从来没有为 Web 应用程序尝试过这种方法，我想看看我的选择是什么。

我正在考虑使用像[Cassini](http://ultidev.com/products/UWS-Cassini-Pro/)或[aspNETserve](http://code.google.com/p/aspnetserve/)之类的东西，并以某种方式自动化安装程序以即时设置所有内容。任何见解表示赞赏，如果有任何问题或需要更多详细信息，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-18T18:55:31.447

我会使用 WebPlatform 安装程序来设置所有依赖项设置。您可以编写该工具的脚本并让它为您运行所有先决条件。（[http://msdn.microsoft.com/en-us/library/windowsazure/gg433092.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg433092.aspx)）

另外，我会使用 IIS Express 来托管。它还通过脚本设置来设置您的应用程序根目录、路径、权限等。 ( [http://learn.iis.net/page.aspx/870/running-iis-express-from-the-command-line/](http://learn.iis.net/page.aspx/870/running-iis-express-from-the-command-line/) )

所以理论上一个简单的脚本或安装程序可以为您部署所有这些并运行上述两个以及部署您的应用程序。

# mysql - 避免 MySQL1044 错误

> ID：10288286
> 
> 赞同：0
> 
> 时间：2012-04-23T21:04:22.920
> 
> 标签：mysql, mysql-error-1044

我正在尝试学习 PHP 和 MySQL，当我读到 MySQL 的一章时，我被要求使用以下命令创建一个数据库：

```
CREATE DATABASE publications; 
```

在 mysql 控制台中输入后，出现此错误：

> 错误 1044（42000）：用户“@localhost”拒绝访问数据库“root”

我已经登录到我的管理员帐户，所以我认为权限应该不是问题。我已经安装了 XAMPP 包。

如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T03:11:12.800

您可能升级了 EasyPHP 的版本，或者您做了一些事情来禁用 root 密码。如果是这种情况，您应该尝试为 root 重新建立密码。有同样的问题，这就是我解决它的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:18:51.010

转到[http://localhost/xampp/](http://localhost/xampp/)并设置适当的密码（在安全选项卡中）。如果您使用`mysql`客户端程序，请确保使用适当的凭据调用它：`mysql -u <username> -p <password>`. 用户名主要是`root` 在您创建一些新帐户之前。

然后我建议你使用 phpMyAdmin 来试验 MySQL（它应该在[http://localhost/phpmyadmin/](http://localhost/phpmyadmin/)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:14:44.717

这有点令人困惑 - 让我试着回答这个问题。

Mysqladmin 是一个命令行客户端，用于管理你的 mysql 数据库系统——一旦你有 mysql 工作，你通常不需要运行它。mysql 服务器的 shell 命令行界面是`mysql`. （如果您不知道如何运行 shell 命令行，那就是另一个问题。另外，如果您使用的是 Windows，请这样说，因为这有其自身的挑战。）参数是：

```
mysql -u username -ppassword databasename 
```

如果您在与 mysql 相同的服务器上运行此命令。请注意 -p - 之后缺少空格，这很重要。

因此，键入上面的行来调用 mysql 的命令行界面。然后你可以输入你的mysql命令。`show tables`,等之类的东西`desc tablename`会起作用。也就是说，除非您遇到身份验证问题，否则它们将起作用。但是您会知道您遇到了身份验证问题，因为当您尝试`mysql`按上述方式运行时，它将失败并出现一些错误，例如“用户'abc'@'localhost'的访问被拒绝（使用密码：YES）”。这是一个很好的描述性错误消息，可以准确地指出问题所在。

这有帮助吗？

一旦通过检查命令行确定您知道正确的参数，您就可以返回使用 xampp 或其他任何东西。（当出现异常时，请务必使用命令行进行检查——这比尝试通过其他接口进行调试要容易得多。）

# cocoa - 通过文本字段检查用户输入

> ID：10288288
> 
> 赞同：0
> 
> 时间：2012-04-23T21:04:32.230
> 
> 标签：cocoa, fast-enumeration

我已经为此苦苦挣扎了好几天了；我的应用程序有一个带有 uitextfields 的图表来表示图片的标签。我想根据字典检查用户输入（以获得答案），如果它是正确的，则将分数增加 1。我通过“硬编码”每个 textfield.text 查询来工作，每个查询都有自己的 if 语句，但如果可能的话，我想要一种更好、更可重用的方法？到目前为止，我已经尝试过：

```
- (IBAction)checkAnswers:(UITextField *)textField
{
// array for each textfield
allTextfields = [[NSArray alloc] initWithObjects:eyepiece, objectiveLenses, focussingKnobs, stage, mirror, nil];
// array for each UIImageView
allTicks = [[NSArray alloc] initWithObjects:eyepieceTick, objectiveTick, focussingTick, stageTick, mirrorTick, nil];
UIImage *image = [UIImage imageNamed:@"Tick.png"];

for (textField in allTextfields) {

    if ([textField.text isEqualToString:[[microscopeBrain.microscopeDictionary valueForKey:theTextfieldTag] valueForKey:@"Answer"]]) {
        [[allTicks objectAtIndex:textField.tag] setImage:image];
        x++;
      textField.enabled = NO;
       NSLog(@"%@", microscopeBrain.microscopeDictionary);
    //    NSLog(@"%@", [[microscopeBrain.microscopeDictionary valueForKey:theTextfieldTag] valueForKey:@"Answer"]);
    }

    finalMicroscopeScore = [[NSString alloc] initWithFormat:@"%i", x];
    microscopeScoreLabel.text = [[NSString alloc] initWithFormat:@"%i", x];

    }
    } 
```

问题是即使答案在错误的文本字段中，只要一个是正确的，它们都会显示为正确的，这有点尴尬！任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:29:14.077

尝试将 valueForKey:theTextFieldTag 更改为 valueForKey:textField.tag 看看是否有帮助。您没有显示如何获得 theTextFieldTag 的值，所以我不确定这是否是问题所在。

# asset-pipeline - 开发中的“config.assets.compress = true”是否应该创建错误的 CSS 链接？

> ID：10288289
> 
> 赞同：0
> 
> 时间：2012-04-23T21:04:39.543
> 
> 标签：asset-pipeline

在 Rails 3.2.3 中，html 头标签包含指向 app/assets/stylesheets 中所有样式表的链接，即使只有 stylesheet_link_tag 仅引用了“应用程序”并且所有链接都已损坏。这里有什么问题：

当 config/environments/development.rb 有

> config.assets.compress = true

并且 app/assets/stylesheets/application.rb 包含

```
 *= require_tree . 
```

head 标签中的 app/views/layouts/application.rb 样式表部分仅包含

```
<%= stylesheet_link_tag( 'application' ) %> 
```

那么 app/assets/stylesheets 中的每个 css 文件都有一个链接标签。除了 application.css 之外，每个链接都是 404，并且该链接具有应位于每个相应链接的所有内容。

这是 Rails 的错误吗？想在 dev 中测试压缩是错误的吗？难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T09:10:47.290

不确定这是否有帮助，但在我的 development.rb 中我有这个：

```
config.assets.compress = false
config.assets.debug = false
config.assets.compile = true 
```

当我在开发中预编译时，这些设置似乎对我有用。同样在 application.rb 中，我需要我的所有资产，因为其中一些资产不适用于仅拥有 *= require_tree。

**我的应用程序.css**

```
*= require_self
*= require 'blueprint/screen'
*= require jquery.jgrowl
*= require jquery-ui-1.8.18.custom.css
*= require 'custom' 
```

我不得不省略 *= require_tree 位，因为它会导致意外问题。重启服务器。希望这能提供一些方向

# java - JNI 参数是本地或全局引用

> ID：10288290
> 
> 赞同：1
> 
> 时间：2012-04-23T21:04:43.190
> 
> 标签：java, android, android-ndk, java-native-interface

我已经阅读了一些关于 JNI 中本地和全局引用的参考资料。但是我找不到明确的答案，作为参数传递给 JNI 函数的 Java 对象是本地引用还是全局引用。我认为它应该是全球性的，但是有一个问题：

首先，我得到 Java 对象指针并保存它。然后本机回调函数调用该对象的方法。回调函数是从一个单独的线程调用的。该线程是使用 AttachCurrentThread() 创建的，因此 JVM 知道它。JNIEnv* 变量也是有效的，并且该对象没有被垃圾调用，但是我收到警告然后崩溃。

> JNI 警告：0x4108edb8 不是 Lcom/my/company/MyClass;.load:(Ljava/lang/String;)V (GetObjectClass) 中的有效 JNI 引用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T04:06:57.897

1.  这是本地参考。[“对象作为本地引用传递给本地方法”](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/spec/design.html#wp1242)

2.  JNIEnv* 指针在 JNI 方法调用边界上无效，更不用说线程边界了。

3.  在您的情况下，您必须将本地引用转换为全局引用以供回调方法使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:12:23.993

从理论上讲，如果没有从 Java 代码调用该函数（我有时直接从其他 JNI 方法调用我的 JNI 方法而不要求 JVM 这样做），则理论上您可以获得全局引用，但您应该始终假设它们是本地的并像那样对待它们. 如果您想存储它们以供以后使用，您应该创建一个新的全局引用。实际上，即使您可以获得全局 ref，您应该如何对待它们也没有区别。在任何情况下您都不必删除它们，即使您碰巧获得了全局引用（我认为上述方法是唯一的方法），在没有首先对其进行新引用的情况下存储它也是错误的。如果给你的人删除了 ref，它将变为无效。

**编辑：**以上是经过编辑的版本，我希望能更满足@EJP。同样的信息，只是更清晰。他确实有一点，对于几乎所有情况，JNI 规范都是最重要的，即使它在这种情况下没有任何区别 :-)

# css - CSS - 如何避免元素内容显示在 2 行

> ID：10288291
> 
> 赞同：0
> 
> 时间：2012-04-23T21:04:46.937
> 
> 标签：css

我有很多内联显示的跨度。我的跨度包含一些文本。我的问题是，当跨度到达浏览器的右边框时，跨度被“剪切”。切割我的意思是一半在一行上，其余的在下一行。我想避免这种情况。如果没有足够的空间在同一行显示所有跨度内容，我希望该跨度内容显示在下一行。希望我清楚。预先感谢您的回复。干杯。马克

[http://jsfiddle.net/EaW5t/](http://jsfiddle.net/EaW5t/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:06:51.930

使用 CSS：

```
 span { white-space:nowrap; } 
```

从[文档](http://www.w3.org/TR/CSS21/text.html#white-space-prop)：

> nowrap - 此值折叠空白作为“正常”，但抑制文本中的换行符。

干杯

# jquery-plugins - jQuery Mobile SimpleDialog：“未捕获的语法错误：意外的标记 }”

> ID：10288292
> 
> 赞同：0
> 
> 时间：2012-04-23T21:04:57.417
> 
> 标签：jquery-plugins, jquery-mobile

我目前正在为 jQuery Mobile 实现一个空白内容 SimpleDialog。这是html：

```
<li>
   <a href="#page1" id="searchdialog" data-theme="" data-icon="search">Search Routes
   </a>
</li> 
```

这是jQuery：

```
<script type="text/javascript">
        $(document).delegate('#searchdialog', 'click', function() {
          $('<div>').simpledialog2({
            mode: 'blank',
            headerText: 'Route Search',
            headerClose: true,
            blankContent : 
            '<div id="content" data-role="content"><label>Enter Your Search:</label><div data-role="fieldcontain"><fieldset data-role="controlgroup">' +
            '<label for="textinput7">Start</label><input id="start" placeholder="" value="" type="text"/></fieldset></div>'+
            '<div data-role="fieldcontain"><fieldset data-role="controlgroup"><label for="textinput9">End</label>'+
            '<input id="end" placeholder="" value="" type="text" /></fieldset></div>'+
            '<a data-role="button" data-transition="fade" data-theme="b" href="#page6" data-icon="search" data-iconpos="left" onclick="alert($("#start").val(),$("#end").val())">Search</a>'
          })
        });
    </script> 
```

我一生都无法弄清楚导致此错误的原因：

> Uncaught SyntaxError: Unexpected token }

该错误仅在单击 Search Routes 链接时发生，这使我相信这是 jquery 中的错误。有趣的是，如果我成功了

> onclick="警报()"

代替

> onclick="alert($("#start").val(),$("#end").val())"

然后它可以工作，但我需要有一个其他的变体：

> onclick="location.href = "/search/?start=" + $("#start").val() + "&end=" + $("#end").val()"

关于如何实现这一点的想法？任何快速而肮脏的解决方案都会奏效。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:11:55.937

你的线：

`'onclick="alert($("#start").val(),$("#end").val())"'`

导致错误。您的 onclick 属性中有冲突的引号（以及非字符串逗号！）

您最好创建一个 hidden / display:none 元素，其中包含此硬编码信息，然后简单地引用它。

或在创建 html 的时间分配处理程序（类似于您已经委托的处理程序）

编辑：基本上采取这个：

`'<a data-role="button" data-transition="fade" data-theme="b" href="#page6" data-icon="search" data-iconpos="left" onclick="alert($("#start").val(),$("#end").val())">Search</a>'`

而是这样做：

`'<a class="some-wonky-alert" data-role="button" data-transition="fade" data-theme="b" href="#page6" data-icon="search" data-iconpos="left" >Search</a>'`

```
$('a .some-wonky-alert').on('click', function()
{
alert($("#start").val() + $("#end").val());
}); 
```

在您方便时按委托进行季节

编辑2：或者当然你可以尝试转义引号 - 但虽然这可能有效 - 它不会解决正在从事的不良做法:)

# python - Python。指定一些参数的传递函数

> ID：10288294
> 
> 赞同：0
> 
> 时间：2012-04-23T21:05:05.877
> 
> 标签：python

我需要将函数传递给另一个指定了一些参数的函数。所以在传递函数之前我需要分配的一半参数和其他参数将在另一个函数中给出。怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T21:07:24.260

这正是这样[`functools.partial`](http://docs.python.org/library/functools.html#functools.partial)做的。例如：

```
other_function(callback=functools.partial(the_other_function, param1='foo', param2='bar')) 
```

# ruby-on-rails - 对多个表使用单个模型

> ID：10288296
> 
> 赞同：1
> 
> 时间：2012-04-23T21:05:16.110
> 
> 标签：ruby-on-rails, design-patterns, single-table-inheritance, sti

我想知道是否可以组合来自不同表的列并将其用作 Rails 中的一个模型。我在下面有两个表，一个包含通用列和其他专门列。

```
posts
--------------
id
title
description
created_at
updated_at

jobs
--------------
post_id
category_id
job_type
duration
salary 
```

在 Rails 模型中，

```
class Job < ActiveRecord::Base
#
end 
```

在保存作业模型时，应将列保存在相应的表中。我考虑过使用单表继承 (STI)，但看起来我无法使用这种方法拆分多个表中的列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:16:17.673

您好，您只需要使用[accept_nested_attributes_for](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html) ，然后您可以使用密钥填写`post`保存时的列。`jobs``posts_attributes`

**将帖子添加到工作**

`job[posts_attributes] = [{ :title => "test", :description => "Lorem ipsum"}]`

**从工作中删除帖子**

`job[posts_attributes = [{ :id:20, :_destroy => true}]`

希望对您有所帮助；）

# android - createOrUpdate() 总是使用 ORMLite 在数据库中创建一个新条目

> ID：10288297
> 
> 赞同：14
> 
> 时间：2012-04-23T21:05:24.473
> 
> 标签：android, ormlite

在我的 Android 项目中，ORMLite 用作缓存。我正在从 Web 服务器下载数据并将其放入数据库中。我正在调用`createOrUpdate`我的对象，但数据库中出现了重复项。除了主键（它只是一个自动递增的整数）之外，数据库条目是相同的。我认为由于我的第二个对象还没有主键，ORMLite 认为这两者是不同的，即使其他所有字段都是相同的。

有没有人知道这是不是真的？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-23T21:07:21.840

`createOrUpdate`除非您的对象*已经*设置了 id 字段，否则您不应调用。`ORMLite`确定它是否存在于数据库中的方法是对其进行查询。代码可以：

```
ID id = extractId(data);
// assume we need to create it if there is no id  <<<<<<<<<<<<<<<<<<<<<<<
if (id == null || !idExists(id)) {
    int numRows = create(data);
    return new CreateOrUpdateStatus(true, false, numRows);
} else {
    int numRows = update(data);
    return new CreateOrUpdateStatus(false, true, numRows);
} 
```

我将扩展 javadocs 以更好地解释这一点。他们在那里*非常*虚弱。对不起。我已将它们更新为：

> 如果项目不存在，这是在数据库中创建项目的便捷方法。id 是从 data 参数中提取的，并在数据库上进行查询。如果数据库中存在具有相同 id 的行，则数据库中的所有列都将从 data 参数中的字段更新。如果 id 为 null（或 0 或其他默认值）或数据库中不存在，则将在数据库中创建对象。这也意味着您的数据项必须定义一个 id 字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T11:16:07.420

似乎您需要`update`根据您的实际唯一标识符手动提取现有条目的 id，然后提取数据库。具有唯一 URL 的示例：

```
CacheItem newEntry = fetchEntry("..."); // fetch it here
List<CacheItem> existing = mDao.queryForEq("url", newEntry.getUrl());
if (existing.size() > 0) {
    int id = existing.get(0).getId();
    newEntry.setId(id);
    mDao.update(newEntry);
} else mDao.create(newEntry); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-15T09:00:41.830

设置您的主键以使其正常工作。

@DatabaseField(columnName = "id",uniqueIndex = true) private int id;

为我工作。在后台抛出异常，但它可以工作：D

# .net - 命令 Test.DebugTestsInCurrentContext 似乎已弃用

> ID：10288299
> 
> 赞同：1
> 
> 时间：2012-04-23T21:05:34.530
> 
> 标签：.net, visual-studio, unit-testing

### TL;DR 我还能在 VS11 的当前上下文中调试测试吗？

在 Visual Studio 中使用 mstest 进行单元测试（显然已在 2010 和 11 甚至[2008 年](https://stackoverflow.com/questions/266716/execute-only-one-unit-test-while-debugging-in-visual-studio-2008)得到验证）有一个名为`Test.DebugTestInCurrentContext`. 它在调试模式下运行单个测试。

要使用此命令，请将光标放在方法中的任何位置（有问题的单元测试），然后

1 使用（默认）键盘快捷键`Ctrl+R, Ctrl+T`

或者

2 使用菜单选项Test=>Debug=>Tests in Current Context。（2010，不知道2008）

我现在正在使用 VS 11 Beta，发现点击 ^R,^T 什么也没做（不是命令）。我检查了键绑定并找到了 command `Test.DebugTestInCurrentContext`，按照我们的预期将其映射到 ^R,^T ，然后再次尝试。这次状态栏报告：

`The key combination (Ctrl+R, Ctrl+T) is bound to (DebugTestsInCurrentContext) which is not currently available.`

Visual Studio 11 有一个新的单元测试资源管理器。运行一次所有测试后，它会填充解决方案单元测试。此时我可以滚动...和 ​​scoll（我有几个测试），找到我感兴趣的一个测试，并选择它（突出显示它）。此时我可以右键单击 =>“Debug Selected Tests”，或者导航菜单，Unit Tests=>Debug Unit Tests=>Selected Tests。

因此，我发现我可以通过以下方式在 VS11 中调试单个单元测试

1 运行所有测试后，在单元测试资源管理器中找到单元测试

2 选择它

3 执行“调试选定的测试”

有没有更简单的方法？我不能使用旧命令在当前上下文中调试测试吗？该命令已过时吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:04:17.727

我决定在 msdn 论坛上提问。简而言之，我得到了回复：“该功能在测试版中已损坏，将在 rtm 中恢复”

[在此处](http://social.msdn.microsoft.com/Forums/en-US/vstest/thread/25dfe15d-d9a6-4e02-9962-c50faecaecd5/#25dfe15d-d9a6-4e02-9962-c50faecaecd5)阅读完整答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-12T19:21:32.330

在较新版本的 Visual Studio 中使用以下命令作为键盘快捷键

*   TestExplorer.DebugAllTestsInContext
*   TestExplorer.RunAllTestsInContext

以下不再起作用

*   DebugTestInCurrentContext
*   RunTestInCurrentContext

[微软网站上的问题](https://connect.microsoft.com/VisualStudio/feedback/details/745762/cant-run-or-debug-tests-in-current-context)

# javascript - Facebook 插件 Facepile 问题

> ID：10288304
> 
> 赞同：1
> 
> 时间：2012-04-23T21:05:56.603
> 
> 标签：javascript, facebook, api, facebook-social-plugins, facepile

我无法理解 Facebook 开发人员的 Facepile 插件的基础知识。我已成功启动并运行 Facepile，并显示“喜欢”该页面的人的照片，只要他们是朋友。

这都很好。但是 Facepile 的另一个功能是我无法使用的。这只是为了显示有多少人喜欢该页面。在 Facepile 开发者页面上，它说：

*如果一些用户喜欢你的页面，但没有一个查看用户的朋友喜欢它，插件将显示喜欢你页面的用户总数。*

然而，这根本就没有出现在我身上。有什么我可能会丢失的吗？这是我的代码：

```
<div id="fb-root"></div>

  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=00000000";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>

  <script src="http://connect.facebook.net/en_US/all.js
  #appId=0000000000000&amp;xfbml=1"></script>

  <div class="fb-like" data-href="http://myurl" data-send="false" data-width="450" data-show-faces="true"></div>

  <div class="fb-facepile" data-href="http://myurl" data-action="watch" data-max-rows="1" data-width="300"></div> 
```

请记住，我用假人替换了 App ID 和 URL。您可能拥有的见解将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T07:41:11.067

**更新：仔细阅读您的问题后，我建议您尝试一次 IFRAME 版本，看看是否适合您。**

```
<iframe src="http://www.facebook.com/plugins/facepile.php?href={SITE_URL}&amp;size=small&amp;width=292&amp;max_rows=1" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:292px;"></iframe> 
```

**老答案：**

假设“喜欢计数”是您唯一需要的东西，您不需要 facepile。只需使用 Open Graph 即可。

**打开图表：**

```
https://graph.facebook.com/{PAGE_ID} 
```

例如。[https://graph.facebook.com/314467614927](https://graph.facebook.com/314467614927)

**回报：**

```
{
   "id": "314467614927",
   "name": "Angry Birds",
   "picture": "http://profile.ak.fbcdn.net/hprofile-ak-snc4/276791_314467614927_795266395_s.jpg",
   "link": "http://www.facebook.com/angrybirds",
   "likes": 20292918,
    ...
} 
```

现在从 JSON 中检索点赞数，并使用 JS 将其填充到您希望显示的任何位置。

# java - 如何使用调度方法

> ID：10288312
> 
> 赞同：-4
> 
> 时间：2012-04-23T21:06:28.727
> 
> 标签：java

我该如何使用Timer类调度方法？我的要求是我将在调度方法中编写的任务每天运行一次。有人可以为该方法写下所需的签名吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:15:52.340

一天24小时，一小时60分钟，一分钟60秒，一秒1000毫秒

`scheduleAtFixedRate(yourTask, initialDelay, 24 * 60 * 60 * 1000);`

# python - 使用pyqt4从相机流式传输视频

> ID：10288316
> 
> 赞同：4
> 
> 时间：2012-04-23T21:06:35.260
> 
> 标签：python, qt4, video-streaming, pyqt4

我正在使用第三方库，该库利用循环缓冲区来存储图像数据和视频。它有一种获取最后一张图像或弹出它的方法。我想知道为此在 pyqt 中实现视频功能的最佳方法是什么。是否有一些我可以使用的带有回调函数的视频小部件？还是我必须以某种方式自行实现并行处理？与此同时，如果您不知道如何在 pyqt 中实现它，关于如何在 qt 中实现它的建议也将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T20:31:37.003

我会弹出最后一张图片（来自循环缓冲区）并将其加载到[`QPixmap`](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qpixmap.html). 这允许您将图像放入 pyqt4 gui 能够加载的形式。

根据您的库图像格式（直接 bmp？jpg？png？原始像素？），您可以通过以下两种方式之一将数据加载到 QPixmap 中。

第一：逐像素进行（设置图像的宽度和高度，并将每个像素值逐个复制）。这种方法很慢，我只会在必要时使用它。

[第二：如果图像以通用格式存储（此处](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qpixmap.html#reading-and-writing-image-files)列出了“支持”的格式），这将变得微不足道。

然后在 QPixmap 中加载图像后，我将使用它[`QLabel.setPixmap()`](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qlabel.html#setPixmap)来显示图像。

以一定的速率使用 QTimer 插槽执行此操作，您将能够在 pyqt4 gui 中显示图像。

# ruby-on-rails - Ruby on Rails 3.1，Ckeditor 自定义工具栏。在哪里放置定义

> ID：10288317
> 
> 赞同：7
> 
> 时间：2012-04-23T21:06:41.817
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ckeditor

我使用 gem 来安装 ckeditor。因此，项目中没有 config.js（在我不想修改的实际 gem 文件夹中）。安装确实在 config/initializers 文件夹中创建了一个 ckeditor.js，这似乎是放置工具栏定义的正确位置。但是我试图让它工作的一切都会引发各种语法或方法未找到错误。有没有人在这方面取得成功？如果是这样，一个简单的例子将非常有帮助。

我当前的 ckeditor.js 是：

```
# Use this hook to configure ckeditor
if Object.const_defined?("Ckeditor")
  Ckeditor.setup do |config|

  # ==> ORM configuration
  # Load and configure the ORM. Supports :active_record (default), :mongo_mapper and
  # :mongoid (bson_ext recommended) by default. Other ORMs may be
  # available as additional gems.
  require "ckeditor/orm/active_record"

  # Allowed image file types for upload.
  # Set to nil or [] (empty array) for all file types
  # config.image_file_types = ["jpg", "jpeg", "png", "gif", "tiff"]

  # Allowed attachment file types for upload.
  # Set to nil or [] (empty array) for all file types
  # config.attachment_file_types = ["doc", "docx", "xls", "odt", "ods", "pdf", "rar", "zip", "tar", "swf"]
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-13T02:32:43.317

1.在application.js中添加以下内容

```
//= require ckeditor/ckeditor
//= require_tree ./ckeditor 
```

2.在app/assets/javascript/ckeditor 中添加一个config.js 示例config.js

```
if(typeof(CKEDITOR) != 'undefined')
{
 CKEDITOR.editorConfig = function(config) {
   config.uiColor = "#AADC6E";
   config.toolbar = [
    [ 'Bold', 'Italic', 'Underline', 'Strike' ],
    [ 'NumberedList', 'BulletedList', 'HorizontalRule' ],
    [ 'Blockquote' ],
    [ 'Undo', 'Redo' ],
    [ 'insertResolved' ],
    [ 'Source' ]
 ];
}
} else{
  console.log("ckeditor not loaded")
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T09:38:02.467

我和你有同样的问题。起初，我[使用资产管道遵循 Config rails，](https://stackoverflow.com/questions/9142293/how-to-configure-ckeditor-in-rails-3-1-gem-asset-pipeline)但它对我不起作用。然后我意识到该链接的作者只创建了一种新样式的工具栏。您还需要在视图中调用它。这意味着您需要添加此行

```
input_html => {:toolbar => 'MyToolbar'} 
```

让它工作。

为了测试 config.js 是否正常工作，您可以检查网页的来源，看看是否添加了 assets/javascripts/ckeditor/config.js。另一种检查方法是通过取消注释此行来编辑编辑器颜色：`config.uiColor = '#AADC6E'`. 如果编辑器的颜色发生变化，那么它就可以工作。

我还犯了一个愚蠢的错误，我两次包含 ckeditor js 文件：一次在 application.js 中，一次在 layouts/application.html.haml 文件中。不知道这是否是问题的根源。你可以试试。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T08:54:15.270

这对我有用： [How to configure CKEditor in Rails 3.1 (gem + Asset Pipeline)](https://stackoverflow.com/questions/9142293/how-to-configure-ckeditor-in-rails-3-1-gem-asset-pipeline) 只需将答案中给出的片段保存在 config.js 文件中

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-26T01:20:20.060

可能是我对 github 的评论会帮助你[https://github.com/galetahub/ckeditor/issues/136#issuecomment-8870692](https://github.com/galetahub/ckeditor/issues/136#issuecomment-8870692)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-08T08:35:26.143

这是使用**ckeditor 4.1.0**自定义配置 ckeditor 工具栏的**Rails 4.1的****更新**答案。

 ****在您看来，使用 simple_form，您需要像以下示例一样配置输入：

## _FORM.HTML.ERB

```
<%= simple_form_for(@foo) do |f| %>
  <%= f.input :bar, as: :ckeditor %>
  <%= f.button :submit %>
<% end %> 
```

在您的 Javascript 资产中，您需要创建一个名为“ckeditor”的文件夹，并在其中创建一个名为“config.js”的文件

## ../JAVASCRIPTS/CKEDITOR/CONFIG.JS

```
CKEDITOR.editorConfig = function(config) {
  //config.language = 'es'; //this could be any language
  config.width = '725';
  config.height = '600';

  // Filebrowser routes
  // The location of an external file browser, that should be launched when "Browse Server" button is pressed.
  config.filebrowserBrowseUrl = "/ckeditor/attachment_files";
  // The location of an external file browser, that should be launched when "Browse Server" button is pressed in the Flash dialog.
  config.filebrowserFlashBrowseUrl = "/ckeditor/attachment_files";
  // The location of a script that handles file uploads in the Flash dialog.
  config.filebrowserFlashUploadUrl = "/ckeditor/attachment_files";
  // The location of an external file browser, that should be launched when "Browse Server" button is pressed in the Link tab of Image dialog.
  config.filebrowserImageBrowseLinkUrl = "/ckeditor/pictures";
  // The location of an external file browser, that should be launched when "Browse Server" button is pressed in the Image dialog.
  config.filebrowserImageBrowseUrl = "/ckeditor/pictures";
  // The location of a script that handles file uploads in the Image dialog.
  config.filebrowserImageUploadUrl = "/ckeditor/pictures";
  // The location of a script that handles file uploads.
  config.filebrowserUploadUrl = "/ckeditor/attachment_files";

// You could delete or reorder any of this elements as you wish
  config.toolbar_Menu = [
    { name: 'document', items: ['Source', '-', 'Save', 'NewPage', 'DocProps', 'Preview', 'Print', '-', 'Templates'] }, 
    { name: 'clipboard', items: ['Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo'] }, 
    { name: 'editing', items: ['Find', 'Replace', '-', 'SelectAll', '-', 'SpellChecker', 'Scayt'] }, 
    { name: 'tools', items: ['Maximize', 'ShowBlocks', '-', 'About'] }, '/', 
    { name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike', 'Subscript', 'Superscript', '-', 'RemoveFormat'] }, 
    { name: 'paragraph', items: ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'Blockquote', 'CreateDiv', '-', 'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock', '-', 'BidiLtr', 'BidiRtl'] }, 
    { name: 'links', items: ['Link', 'Unlink', 'Anchor'] }, '/', 
    { name: 'styles', items: ['Styles', 'Format', 'Font', 'FontSize'] }, 
    { name: 'colors', items: ['TextColor', 'BGColor'] }, 
    { name: 'insert', items: ['Image', 'Flash', 'Table', 'HorizontalRule', 'Smiley', 'SpecialChar', 'PageBreak'] }
  ];
  config.toolbar = 'Menu';
  return true;
}; 
```

application.js 的配置是这样的，注意 ckeditor 和 require_tree 的顺序很**重要**

## 应用程序.JS

```
//= require jquery
//= require jquery_ujs
//= require ckeditor/init
//= require_tree . 
```

现在在您的 ckeditor.rb 中，您应该取消注释“config.asset_path”这一行并将路径添加到您之前创建的 config.js 文件中，即“/assets/ckeditor/”

## ../CONFIG/INITIALIZERS/CKEDITOR.RB

```
# Use this hook to configure ckeditor
Ckeditor.setup do |config|
  # ==> ORM configuration
  # Load and configure the ORM. Supports :active_record (default), :mongo_mapper and
  # :mongoid (bson_ext recommended) by default. Other ORMs may be
  # available as additional gems.
  require "ckeditor/orm/active_record"

  # Customize ckeditor assets path
  # By default: nil
  config.asset_path = "/assets/ckeditor/"
end 
```

我希望它有所帮助：D！****

# javascript - 使用 jQuery 选择第一个元素

> ID：10288318
> 
> 赞同：2
> 
> 时间：2012-04-23T21:06:45.080
> 
> 标签：javascript, jquery

我有以下 HTML：

```
<input id="1" type="checkbox"/>
<label for="1">bla bla</label>
<br/>
<input id="2" type="checkbox"/>
<label for="2">hello hello</label>
<br/>
.
.
.
etc... 
```

有没有办法在一次调用中选择前几个输入？换句话说，我不想全选它们并循环遍历每一个。只需选择 1 条语句，例如前 3 条。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:09:59.587

只需选择所有并根据需要切片结果，

```
$('input').slice(0, 3) //will return first 3 input. 
```

[**演示**](http://jsfiddle.net/skram/RhWDY/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:09:22.167

你的意思是这样吗？

```
var firstThree = $('#1, #2, #3') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:09:40.590

这应该这样做

```
$("input:lt(3)") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-23T21:12:40.087

jQuery 函数[slice](http://api.jquery.com/slice/)允许您仅指定结果的子集：

```
$('input').slice(0, 3) 
```

Where 0 is the first index and 3 is the *first index not included*, so 2 is the last index and you get the three items.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T21:09:12.977

干得好：

```
 $('input').filter(function(index) {
       return index < 3;        
    }); 
```

您可以将其更改为`3`您想要的任意数量的项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-23T21:09:33.087

您可以使用 jQuery`:gt`和`:lt`选择器：

```
$('input:lt(3)').css('blah, 'blah'); 
```

这应该选择页面上的前三个输入标签。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-23T21:09:46.573

您可以使用`:lt`选择器。

[http://api.jquery.com/lt-selector/](http://api.jquery.com/lt-selector/)

# c# - 将 SharePoint SPListItem 转换为下拉 ListItem

> ID：10288321
> 
> 赞同：0
> 
> 时间：2012-04-23T21:07:00.423
> 
> 标签：c#, asp.net, sharepoint-2007, sharepoint-list

我正在尝试将 SharePoint`SPListItem`转换`ListItem`为放入下拉列表中。我的问题是 SharePoint 列表中的数据是这样存储的：

> ;#日光;#
> 
> ;#设计;#员工敬业度;#

但显然这对我不起作用。我需要删除 ;# 符号，它应该很简单，`String.Replace`但是我遇到一些问题的地方是我应该为包含多个选择的列表项做什么（我上面的第二个示例）。此处的最终目标是生成 SharePoint 列表中所有项目的下拉列表（不包含重复项）。有任何想法吗？

```
 using (SPSite site = new SPSite(SPContext.Current.Web.Url.ToString()))
        using (SPWeb oWebsiteRoot = site.OpenWeb())
        {
            SPList oList = oWebsiteRoot.Lists["WplData"];
            SPListItemCollection items = null;
            SPQuery query = new SPQuery();
            query.Query = "<Where><IsNotNull><FieldRef Name='Topic' /></IsNotNull>" +
                "</Where><OrderBy><FieldRef Name='Topic' Ascending='True' /></OrderBy>";
            items = oList.GetItems(query);
            DataTable tmpTable = new System.Data.DataTable();
            tmpTable = items.GetDataTable();
            DataView view = new DataView(tmpTable);
            String[] columns = { "Topic" };
            DataTable table = view.ToTable(true, columns);
            foreach (DataRow row in table.Rows)
            {
                foreach (var item in row.ItemArray)
                {
                    ListItem listItem = new ListItem();
                    listItem.Value = item.ToString();
                    listItem.Text = item.ToString();
                    TopicDropDownList.Items.Add(listItem);
                }
            }
       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:25:34.363

而不是 DataTable，请尝试[SPFieldLookupValueCollection](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldlookupvaluecollection%28v=office.12%29.aspx)：

```
SPList oList = oWebsiteRoot.Lists["WplData"];
SPListItemCollection items = null;
SPQuery query = new SPQuery();
query.Query = "<Where><IsNotNull><FieldRef Name='Topic' /></IsNotNull>" +
    "</Where><OrderBy><FieldRef Name='Topic' Ascending='True' /></OrderBy>";
items = oList.GetItems(query);
foreach (SPListItem item in items)
{
    SPFieldLookupValueCollection values = 
        new SPFieldLookupValueCollection(item["Topic"].ToString());
    foreach (SPFieldLookupValue value in values)
    {
        ListItem listItem = new ListItem();
        listItem.Value = value.LookupId.ToString();
        listItem.Text = value.LookupValue;
        TopicDropDownList.Items.Add(listItem);
    }
} 
```

请注意，由于您指定了 SharePoint 2007，因此我避免使用 LINQ，因为这需要 .NET Framework 3.5。此外，只要每个列表项包含一组不同的主题，就可以了。但是，如果主题可以在列表项之间重复，您将需要修改此代码以`TopicDropDownList`包含一组不同的主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:06:19.213

LINQ 它，类似于（伪代码）

```
...
var ddlItems = (from i in items
             select i["Topic"]).Distinct();
TopicDropDownList.Items.AddRange(ddlItems);
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T09:05:13.533

如果*主题*是一个多选字段，您可以按以下方式拆分字段值`;#`：

```
var listItems = items.Cast<SPListItem>()
  .SelectMany(i => Convert.ToString(i["Topic"]).Split(";#", StringSplitOptions.RemoveEmptyEntries))
  .Distinct();

TopicDropDownList.Items.AddRange(listItems); 
```

可以直接对`SPListItemCollection`返回的 by进行操作`oList.GetItems(query)`。您无需将其转换为`DataTable`.

您可能会考虑在查询中包含*主题*字段`ViewField`。

如果您不想手动拆分字段值，可以使用[SPFieldMultiChoiceValue 类](http://msdn.microsoft.com/en-us/library/ms415672.aspx)。不幸的是，没有方便的方法来访问此类中的选项。只有一个计数和一个索引器，因此您必须使用 for 循环。

# wpf - 通过 XAML 触发器单击 DataGrid 中的 EditMode

> ID：10288323
> 
> 赞同：1
> 
> 时间：2012-04-23T21:07:02.163
> 
> 标签：wpf, xaml, wpfdatagrid

我有DataGrid，如果我想在单元格中编辑值，我必须双击它并且光标出现在这里（单击它只需选择适当的单元格）..！

我可以通过单击单元格（通过 Xaml 触发器）使它们不仅被选中，而且立即进入 EditMode，当我在带有箭头的单元格之间切换时，它们也进入 EditMode？

这是我当前修改后的代码

```
 <Page.Resources>
    <grd:LenghthToVisibility x:Key="LenghthToVisibility"/>
    <grd:StringToSystemIconConverter x:Key="StringToSystemIconConverter"/>
    <grd:booleanConverter x:Key="booleanConverter"/>
    <DataGrid.CellStyle>
        <Style TargetType="{x:Type DataGridCell}">
            <Setter Property="IsTabStop" Value="False" />
            <Setter Property="Focusable" Value="False" />
        </Style>
      <Style x:Key="RightCellStyle" TargetType="DataGridCell">
        <Setter Property="HorizontalAlignment" Value="Right" />
    </Style>
    <Style x:Key="RightAlignedCell" TargetType="{x:Type DataGridCell}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type DataGridCell}">
                    <Grid Background="{TemplateBinding Background}">
                        <ContentPresenter HorizontalAlignment="Right" VerticalAlignment="Center"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="DataGridCell.IsSelected" Value="True">
                <Setter Property="IsEditing" Value="True" />
                <Setter Property="Background" Value="#356815" />
                <Setter Property="Foreground" Value="#e2fce2" />
            </Trigger>
           </Style.Triggers>
    </Style>
        </DataGrid.CellStyle>
    </Page.Resources> 
```

谢谢。

我有 2 个奇怪的错误并刷新我上面的代码：1）“错误 5 在类型 'DataGrid' 中找不到可附加属性 'CellStyle'。2）“错误 2 XML 命名空间中不存在标签 'DataGrid.CellStyle' schemas.microsoft.com/winfx/2006/xaml/presentation'。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:45:08.117

要忽略`DataGridCell`（关注内容）使用：

```
<DataGrid.CellStyle>
    <Style TargetType="{x:Type DataGridCell}">
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="Focusable" Value="False" />
    </Style>
</DataGrid.CellStyle> 
```

[要在ElementStyle](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridboundcolumn.elementstyle.aspx) / [EditingElementStyle](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridboundcolumn.editingelementstyle.aspx)或[CellTemplate](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridtemplatecolumn.celltemplate%28v=vs.100%29.aspx) / [CellEditingTemplate](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridtemplatecolumn.celleditingtemplate.aspx)环境中输入 EditMode，请将[DataGridCell.IsEditing 属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridcell.isediting.aspx)设置为 true（如果选择）：

```
<Style x:Key="RightAlignedCell" TargetType="{x:Type DataGridCell}">
    ...
    <Style.Triggers>
        <Trigger Property="IsSelected" Value="True">
            <Setter Property="IsEditing" Value="True" />
            ...
        </Trigger>
    </Style.Triggers>
</Style> 
```

# ruby-on-rails - Spree - 禁用结帐的国家选择并修改结帐

> ID：10288327
> 
> 赞同：1
> 
> 时间：2012-04-23T21:07:18.243
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, spree

我需要创建一个在线商店来销售一些电子学习服务，主要是在线课程。

我正在考虑从 Spree 开始，所以我已经安装了它并开始使用配置，我也从 Ruby 和 RoR 开始，我计划在这个我非常喜欢的平台上进行我接下来的所有工作.

我只是想知道从像 Spree 这样的完整解决方案开始销售这种产品是否是个好主意。我需要更改一些结帐步骤，例如不需要交付东西，因为它们是服务（在线课程）。然后我想禁用国家选择，因为电子商务只会在我们的国家销售，允许这个选择是没有用的。

我该怎么做？

然后我想让用户在一次性付款和定期计费解决方案之间进行选择。

你能帮我理解我需要做什么吗？

乍一看，它似乎需要做很多工作（除了我对框架和语言——来自 python、php、c++ 的新手）。

我正在使用他们的 git repo 中最新版本的 spree 和 rails 3.2.3（RVM 下的 ruby​​ 1.9.3）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T07:17:15.983

是的，您可以修改结帐步骤，请查看[http://guides.spreecommerce.com/checkout.html#checkout-customization](http://guides.spreecommerce.com/checkout.html#checkout-customization)以了解如何执行此操作。

在付款方面祝你好运！我已经为此苦苦挣扎了一段时间，而且那里似乎没有太多东西。如果我能找到任何可靠的东西，我会更新这个。

如果您是 ruby​​ on rails 的新手，我建议您先花点时间熟悉一下 ruby​​ on rails，然后再投入大礼包，因为从长远来看，这将为您节省大量时间。

如果您运行的是 spree(edge) 的最新版本，而不是最新发布的版本，请小心。

谢谢

灰

# ios5 - AFNetworking + 当前可达接口

> ID：10288339
> 
> 赞同：0
> 
> 时间：2012-04-23T21:08:13.970
> 
> 标签：ios5, reachability, afnetworking

我有一个`UITableView`显示在我自己的服务器上的下载列表。每行都有自己的下载按钮。由于其中一些的大小超过 50Mb，我想禁用他们的下载按钮，以**在他们仅在 3G (WWAN) 下时**节省用户资金和体验。我已经在使用**AFNetowrking**并且我知道他们计划[在 github 上的一些实验分支](https://github.com/AFNetworking/AFNetworking/tree/experimental-expanded-network-reachability)中支持当前可访问接口的标志，但我更喜欢仅在它成为稳定的生产/就绪代码时才使用该代码。我需要类似 3 种状态的东西：

*   不能达到
*   可通过 WWAN 访问
*   可通过 WiFi 访问

**我如何仅使用 AFNetworking**来实现我的目标？我必须添加另一个库吗？

**注意：**我已经在这个应用程序中部署了很多工作代码，其中大部分依赖于**AFNetworking**，因此无法替换这个库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T04:22:38.217

再坚持几天。我会在本周末推出它：）

编辑：1.0RC1 现在合并到 master 中。享受！

# javascript - 我可以在我的 .load 方法中将变量附加到 url 并加载到文档的特定部分吗？

> ID：10288342
> 
> 赞同：0
> 
> 时间：2012-04-23T21:08:37.433
> 
> 标签：javascript, jquery, ajax

我正在尝试执行以下操作：

`instance.selectors.banner.load('http://localhost/wcd/html/'+url '#inner');`

它附加单击链接的 href 并加载到所选文档的 #inner 中。我在控制台中收到一个错误，虽然说有一个意外的令牌）。我正在做的事情是可能的还是我可以做些什么来实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:10:33.263

你忘了一个`+`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:41:25.023

您缺少 + 运算符。

这是更正后的代码：

```
instance.selectors.banner.load('http://localhost/wcd/html/' + url + '#inner'); 
```

# html - 全局搜索替换引用的图片路径？

> ID：10288348
> 
> 赞同：0
> 
> 时间：2012-04-23T21:09:02.570
> 
> 标签：html, regex, replace, grep

我有各种这样引用的图像：

```
src="http://myblog.files.example.com/2011/08/image-1.jpg"
src="http://myblog.files.example.com/2010/05/image-2.jpg"
src="http://myblog.files.example.com/2012/01/image-3.jpg" 
```

如您所见，图像路径中唯一发生变化的是末尾的数字（日期）。我想做的只是将所有图像的路径更改为：

```
/sites/default/files/blog-images/ 
```

...所以他们都会像：

```
 src="/sites/default/files/blog-images/image-1.jpg"
 src="/sites/default/files/blog-images/image-2.jpg"
 src="/sites/default/files/blog-images/image-3.jpg" 
```

我想知道是否有办法使用正则表达式或其他方法来做到这一点？路径中有数百张具有不同编号的图像，因此手动执行此操作并不理想。

完整的示例代码行：

```
<a href="http://myblog.files.example.com/2011/07/myimage-1.jpg">
<img class="alignright size-medium wp-image-423" title="the title" src="http://myblog.files.example.com/2011/07/myimage-1.jpg" alt="the alt" width="300" height="199" />
</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:50:30.003

```
src="http:\/\/myblog.files.example.com/\d{4}/\d{2}/([^\s]+)" 
```

搜索并捕获`$1`. 现在你可以用`/sites/default/files/blog-images/$1`

如果您的编辑器不支持范围，那么您需要重复`\d`.

```
src="http:\/\/myblog.files.example.com/\d\d\d\d/\d\d/([^\s]+)" 
```

[http://regexr.com?30o8e](http://regexr.com?30o8e)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:52:39.107

一个简单的 sed one 班轮可以解决问题：

这个要测试：

```
sed -r 's@http://myblog.files.example.com/[0-9]{4}/[0-9]{2}/@/sites/default/files/blog-images/@g' FILE 
```

这个改文件

```
sed -ri 's@http://myblog.files.example.com/[0-9]{4}/[0-9]{2}/@/sites/default/files/blog-images/@g' FILE 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:59:04.670

有很多方法可以做你想做的事情。由于您在这篇文章中标记了“grep”并且没有指定任何特定的编程语言，我将假设您想使用 UNIX。

首先，测试这个命令：

```
find . -type f | sed 's/\.\/\([0-9]\{4\}\/[0-9]\{2\}\/\)\(.*\)/mv & sites\/default\/files\/blog-images\/\2/' 
```

它将打印出将要执行的“mv”命令列表，如果它按照您的意愿工作，您可以`sh`像这样通过管道输入：

```
find . -type f | sed 's/\.\/\([0-9]\{4\}\/[0-9]\{2\}\/\)\(.*\)/mv & sites\/default\/files\/blog-images\/\2/' | sh 
```

# android - Sqlite 中的用户登录？

> ID：10288353
> 
> 赞同：0
> 
> 时间：2012-04-23T21:09:18.800
> 
> 标签：android, database

我想在 Android 中使用只有用户名的登录系统。下面的代码仅适用于第一行（例如，我的数据库有名称：1- Joseph 2 - Najib，如果我输入 Joseph 它工作正常，但如果我输入 Najib 或我的数据库中不存在的其他值程序显然一直在循环并且没有响应..如何更正此代码以相应地返回消息（数据库中的用户名或无效的用户名）？我在 while 语句中有错误吗？

```
public void checklogin() {

    DatabaseHelper dbh = new DatabaseHelper(LoginActivity.this);
    DatabaseAdapter dba = new DatabaseAdapter(LoginActivity.this);
    db = dbh.getWritableDatabase();
    TextView usernametry = (TextView) findViewById(R.id.usernametry);
    String usertry = usernametry.getText().toString();

    String[] allColumnsofuserstable = { dba.COLUMN_ID, dba.COLUMN_NAME,
            dba.COLUMN_AGE, dba.COLUMN_GENDER, dba.COLUMN_WEIGHT,
            dba.COLUMN_HEIGHT, dba.COLUMN_CALORIES };

    Log.d("TAG", usertry);

    Cursor mCursor = db.query(dba.TABLE_USERS,
            new String[] { dba.COLUMN_NAME }, null, null, null, null, null,

    mCursor.moveToNext();
    while (!mCursor.isAfterLast()) {
        String k = mCursor.getString(0);
        if (k.equalsIgnoreCase(usertry)) {
            Toast.makeText(LoginActivity.this,
                    "Logged in as " + mCursor.getString(0).toString(),
                    Toast.LENGTH_LONG).show();
            mCursor.moveToNext();
        } else
            Toast.makeText(LoginActivity.this, "invalid username",
                    Toast.LENGTH_LONG).show();
    }

    mCursor.close();
    dbh.close();
    return;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:17:04.690

最好的办法是修改您的查询以查找字符串，而不是获取所有结果并循环进行查找。

```
Cursor mCursor = db.query(dba.TABLE_USERS,
new String[] { dba.COLUMN_NAME }, dba.COLUMN_NAME + "=?", new String[]{usertry},
null, null, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:51:27.457

`mCursor.moveToNext();`您的循环已中断，因为您仅在在数据库中找到用户名的情况下移动光标 ( ) 中的指针。光标在最后一项之后不能移动并且`while (!mCursor.isAfterLast())`永远不会停止。

您需要确保始终移动光标。比如像这样：

```
Cursor mCursor = db.query(dba.TABLE_USERS,
        new String[] { dba.COLUMN_NAME }, null, null, null, null, null,

boolean loggedIn = false;
while (mCursor.moveToNext()) {
    String k = mCursor.getString(0);
    if (k.equalsIgnoreCase(usertry)) {
        Toast.makeText(LoginActivity.this,
                "Logged in as " + mCursor.getString(0).toString(),
                Toast.LENGTH_LONG).show();
        loggedIn = true;
        break;
    }
}
if (!loggedIn)
        Toast.makeText(LoginActivity.this, "invalid username",
                Toast.LENGTH_LONG).show(); 
```

或者您更改查询（请参阅@Waqas）为您完成工作（`LIKE ?`= `equalsIgnoreCase`，`= ?`= `equals`）

```
Cursor mCursor = db.query(dba.TABLE_USERS,
    new String[] { dba.COLUMN_NAME }, dba.COLUMN_NAME + " LIKE ?", new String[]{usertry},
    null, null, null);

if (mCursor.moveToFirst()) {
    String k = mCursor.getString(0);
    Toast.makeText(LoginActivity.this,
            "Logged in as " + mCursor.getString(0).toString(),
            Toast.LENGTH_LONG).show();
} else {
        Toast.makeText(LoginActivity.this, "invalid username",
                Toast.LENGTH_LONG).show();
} 
```

# wso2 - WSO2 Data Services Server on Linux 64-bit?

> ID：10288362
> 
> 赞同：2
> 
> 时间：2012-04-23T21:09:49.603
> 
> 标签：wso2, wso2dss

I'm trying to get WSO2 DSS installed on a 64-bit server and am getting the following error:

> /opt/wso2dss/bin/daemon.sh: /opt/wso2dss/./bin/native/wrapper-linux-x86-32: /lib/ld-linux.so.2: bad ELF interpreter: No such file or directory

Any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:10:25.017

I ended up changing:

```
$DSS_HOME/bin/native/wrapper-linux-x86-32 
```

to:

```
$DSS_HOME/bin/native/wrapper-linux-x86-32.bak 
```

Then I was able to start it up using the daemon as normal. It looks like it was defaulting to the wrapper-linux-x86-32 for some reason even though I'm on x64.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T09:09:54.940

What is the operating system that you are using. Looks like some thing related to wrapper. In case you are on linux env, you may use nohup instead of the wrapper.

nohup wso2server.sh start &

# mysql - MySQL跨两行查找全名

> ID：10288364
> 
> 赞同：1
> 
> 时间：2012-04-23T21:10:00.727
> 
> 标签：mysql

我有一个 MySQL 表，我试图用他的全名找到一个人。问题是名字和姓氏存储在表中的两个单独的行中，如下所示：

```
+-----------------+-------------+-------------+--------------+
| submit_time     | form_name   | field_name  | field_value  |
+-----------------+-------------+-------------+--------------+
| 1323463601.0947 | Online Form | firstname   | Paulo        |
| 1323463601.0947 | Online Form | lastname    | Hill         |
+-----------------+-------------+-------------+--------------+ 
```

如何构建一个通过搜索 Paulo Hill 获得单个结果（如果可能）的查询？

此外，submit_time 列的两行应该具有相同的值——这将是表中唯一的一列值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:14:01.543

您可以使用自联接：

```
SELECT t1.submit_time, t1.field_value, t2.field_value
FROM your_table t1
INNER JOIN your_table t2 ON t2.submit_time = t1.submit_time
WHERE t1.field_name = 'firstname'
AND t1.field_value = 'Paulo'
AND t2.field_name = 'lastname'
AND t2.field_value = 'Hill' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T21:12:51.043

假设`'paulo hill'`是一个单一的搜索查询：

```
 SELECT t1.*,
           t2.field_value
      FROM tbl t1
INNER JOIN tbl t2 ON t1.submit_time = t2.submit_time
       AND t2.field_name = 'lastname'
     WHERE t1.field_name = 'firstname'
       AND t1.field_value || ' ' || t2.field_value = 'paulo hill' 
```

注意：此解决方案对搜索查询中名字和姓氏之间的空格量很敏感

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:16:52.603

试试这个：

```
SELECT * FROM (
  SELECT submit_time, group_concat(field_value SEPARATOR  ' ')  AS fullname
  FROM TABLE_NAME
  GROUP BY `submit_time`
) AS innertable
WHERE fullname='Paulo Hill' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T21:26:52.543

如果您知道顺序，另一种方法是使用[GROUP_CONCAT ：](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

```
SELECT GROUP_CONCAT(field_value SEPARATOR ' ') 
FROM tab
GROUP BY submit_time
HAVING GROUP_CONCAT(field_value ORDER BY field_id ASC) LIKE '%Paulo,Hill%' 
```

# iphone - 初始化使指针从整数而不进行强制转换

> ID：10288370
> 
> 赞同：0
> 
> 时间：2012-04-23T21:10:18.587
> 
> 标签：iphone, ios, nsuinteger

当我尝试在索引处获取字符时收到此警告

初始化使指针从整数而不进行强制转换

这是代码：

```
int random(arch4random()%(string.length));
NSString * char =[string charachterAtIndex:random]; 
```

我只想谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:16:39.890

来自[NSString](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

```
- (unichar)characterAtIndex:(NSUInteger)index 
```

是方法。它返回一个 unichar，而不是 NSString。您正在声明您的变量是一个 NSString 指针，但一个 unichar 在幕后存储为一个整数。

你的线应该是

```
unichar character = [string charachterAtIndex:random]; 
```

作为旁注，您不能将变量 char 称为 C 中的保留关键字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:15:45.240

[NSString characterAtIndex] 返回一个字符，而不是一个字符串对象。所以你不能将它分配给一个名为 char 的 NSString （或命名其他任何东西）。你可以说：

```
unichar ch = [string characterAtIndex:random]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:25:18.430

本质上，编译器警告说，通过编写

```
NSString * name = [string characterAtIndex:random]; 
```

您将指向 NSString * 的指针存储到返回的字符所引用的地址（无符号长整数）。如果您需要将结果字符作为 NSString，您应该使用类似的方法

```
[NSString substringWithRange: NSRangeFromString([NSString stringWithFormat: @"%d-%d", random, 1])]; 
```

它返回一个指向 NSString 对象的指针。

# jquery - jquery.ajax html 响应链接未运行

> ID：10288374
> 
> 赞同：2
> 
> 时间：2012-04-23T21:10:51.313
> 
> 标签：jquery

我正在制作一个脚本，当我想通过由此生成的链接再次调用 ajax 函数时发现错误。

这是html

```
<tr>
  <td>1</td>
  <td>2012-04-11 00:00:00</td>
  <td>2012-04-23 00:00:00</td>
  <td></td>
  <td></td>
  <td></td>
  <td>
  <div id="op_33"><a id='33' name="33" class="elimina" >delete</a></div>
  </td>
</tr> 
```

和几个相似的行，不同的 id。

这是我的 ajax 函数。

```
jQuery('.elimina').click( function(event) {
    if (confirm("Pulse aceptar si desea eliminar dicha linea"))
        {         
        event.preventDefault()
        var id = $(this).attr('name');
        jQuery.ajax({
          type: "POST",
          dataType: 'html',
          url: 'process/functions_seguimientos.inc.php',
          data: 'action='+$(this).attr('name'),
          success: function(data) {
            jQuery('#lista_genera').html(data);

          }

        });
}
    }); 
```

脚本 php 按 id 从 sql 数据库中删除元素，并生成具有相同删除选项的列表。

第一次使用ajax功能没有任何问题，但是当结果列表我尝试单击链接删除另一条记录时，该链接不再有效。

提前感谢您的及时帮助

埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:20:05.520

不确定，但请检查您的数据：

```
data: "{'action':" + $(this).attr('name') + "}", 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:18:20.483

不确定尝试：

```
jQuery('.elimina').live("click",function(event) { 
```

或者 ：

```
jQuery('div').on("click",".elimina",function(event) { 
```

或者如果你使用的是旧的 jQuery 版本：

```
jQuery('.elimina').bind("click",function(event) { 
```

# ios - 呈现的视图控制器也可以是呈现的视图控制器吗？

> ID：10288378
> 
> 赞同：10
> 
> 时间：2012-04-23T21:11:03.443
> 
> 标签：ios, cocoa-touch, uikit

在现有视图之上，我想：a）向用户显示一个屏幕 b）然后发送 SMS c）向用户显示另一个屏幕。

对于 a) 我正在这样做：

```
[[UIApplication sharedApplication].delegate.window.rootViewController presentViewController: firstController animated: NO completion:nil]; 
```

对于 b) 我正在做同样的事情，除了这当然是呈现一个不同的 vc，一个 MFMessageComposeViewController。

但是，为了使 b) 出现，我首先必须使用以下方法关闭第一个视图控制器：

```
 [[UIApplication sharedApplication].delegate.window.rootViewController dismissViewControllerAnimated:NO completion: nil]; 
```

到目前为止，我可以看到第一个视图出现，然后看到 SMS 撰写视图出现。发送短信时，我这样做是为了关闭短信撰写视图

```
 [[UIApplication sharedApplication].delegate.window.rootViewController dismissViewControllerAnimated:NO completion: nil]; 
```

但是，当我尝试使用 presentViewController 向用户展示另一个屏幕时，什么也没有发生。我看不出这应该是什么原因，有什么我不知道的吗？

实际上 SMS 视图之前和之后的屏幕是相同的，只是它们有不同的文本，所以最简单的步骤顺序是：

a) 显示带有文本“abc”的视图控制器 b) 显示 SMS 控制器 c) 发送 SMS 时关闭 SMS 控制器 d) 使用 IBOutlet 更新第一个视图控制器中的文本 e) 关闭第一个视图控制器。

但是如前所述，如果我不关闭第一个视图控制器，SMS 控制器将不会出现。所以我的主要问题是如何在第一个视图控制器之上呈现 SMS 控制器？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-12T15:50:29.623

您可以在另一个关闭后呈现一个：

```
UIViewController *rvc = [UIApplication sharedApplication].delegate.window.rootViewController;
[rvc dismissViewControllerAnimated:NO completion:^{
    [rvc presentViewController: secondController animated: NO completion:nil];
}]; 
```

或者在顶部展示另一个：

```
UIViewController *rvc = [UIApplication sharedApplication].delegate.window.rootViewController;
UIViewController *pvc = rvc.presentedViewController;  // you may need to loop through presentedViewControllers if you have more than one
[pvc presentViewController: secondController animated: NO completion:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2022-02-02T02:14:51.983

我刚刚在iOS15上试过。是的，一个展示的 VC 可以展示另一个 VC。

所以假设你有：

```
VC1 --> present--> VC2 
```

你可以很容易地调用`present(VC3(), animated: true, completion: nil)`VC2 并且一切正常。你可以愉快地结束：

```
VC1 --> present--> VC2 --present--> VC3 
```

FWIW 当你关闭 VC3 时，它只会回到 VC2。它不会回到VC1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:12:37.847

iOS 不允许您同时打开两个模态视图。模态视图被设计为最顶层的视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-23T05:54:32.627

就我而言，我可以直接访问呈现的视图控制器，因此在这种情况下：

```
self.present(viewControllerToPresent, animated: true) {
    //It's presented.
} 
```

# macos - Mac OS X 上的异步应用程序间通信

> ID：10288379
> 
> 赞同：0
> 
> 时间：2012-04-23T21:11:07.583
> 
> 标签：macos, cocoa, ipc

在 Mac OS X 上，我有一个生成 JSON 对象的进程，以及另一个应该使用它们的间歇性进程。*生产者*和*消费者*进程是相互独立的。对象的生成频率不会超过每 5 秒一次，通常是几百字节，但有时可能会达到兆字节。对象应该是先进先出的。当生产者正在生产时，消费者可能会或可能不会运行，并且可能会或可能不会立即读取对象。

我愚蠢的解决方案是

*   创建一个目录。
*   Producer 将每个 JSON 对象写入一个文本文件，并用序列号命名。
*   当 Consumer 启动时，它会按序列号顺序读取并删除文件，并且在运行时使用 FSEvents 来监视该目录是否有新文件到达。

有没有更简单或更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T04:43:40.273

像 Lion 一样，现代的方法是使用 XPC。不幸的是，没有很好的文档。守护进程和服务指南中有[一个广泛的概述](http://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingXPCServices.html#//apple_ref/doc/uid/10000172i-SW6-SW1)和[一个原始的 HeaderDoc 生成的参考](http://developer.apple.com/library/mac/documentation/System/Reference/XPCServicesFW/_index.html)，但是了解它的最好方法是观看[去年的 WWDC 会议上关于它的会议](https://developer.apple.com/videos/wwdc/2011/)。

使用 XPC，您不必担心保持序列号的连续性、不必争夺旋转磁盘或是否有足够的磁盘空间。事实上，您甚至根本不需要生成和解析 JSON 数据，因为 XPC 的通信机制是围绕 JSON-esque/plist-esque 容器和值对象构建的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:34:11.953

假设您希望消费者看到旧文件，这是从一开始就采用的方式 - 尽管它可能令人讨厌。

有很多高科技的东西看起来更干净——但老实说，它们只是倾向于增加复杂性和/或增加麻烦的部署基础设施。您的建议有效，而且效果很好，并且易于编写和维护。您可能需要某种哨兵文件来跟踪您为崩溃恢复所做的工作，但这可能就是这样。

见鬼，大多数人只会用 sleep 5 进行投票。至少你们都在 fsevent 中。

现在，如果在侦听器不在时丢失生成的事件是可以接受的；性能是最重要的——它可能会变得更有趣。:)

# magento - 将php代码添加到静态块

> ID：10288383
> 
> 赞同：12
> 
> 时间：2012-04-23T21:11:26.837
> 
> 标签：magento

我正在寻找一种将 php 添加到 Magento 中的静态块的方法。我尝试了很多方法，但是编辑器改变了

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T21:48:12.820

静态块中对短标签的支持非常有限，但您最好调用模板文件。如果您愿意，可以在静态块中执行此操作：

```
{{block type="cms/block" block_id="your_block_identifier" template="your_path/template.phtml"}} 
```

然后制作一个新的模板文件，您可以在其中运行您的 php 文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-21T13:04:36.247

这是一种工作方式，消除了不必要的代码

```
{{block type="core/template" template="page/urfile.phtml"}} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T06:15:12.137

您不能直接在静态块上添加 php 代码。您可以按照 pspahn 的说明调用 phtm 文件。您还可以将 magento 小部件添加到也运行 php.ini 的静态块中。在静态块上，您可以使用 html 代码，也可以在静态块上使用 magento api，例如皮肤 url 等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-14T10:37:23.323

**您不能将 PHP 代码添加到静态块中**

但是您可以将指向您的 phtml 文件的链接添加到静态块中

*   创建您的 sample.phtml 文件
*   在 sample.phtml 中编写代码

然后将此文件添加到静态文件中

```
{{block type="core/template" template="catalog/category/sample.phtml"}} 
```

# asp.net-mvc-3 - MVC3 子动作打破了我的日期时间编辑器模板

> ID：10288384
> 
> 赞同：2
> 
> 时间：2012-04-23T21:11:28.300
> 
> 标签：asp.net-mvc-3

我有一个通用的 DateTime 编辑器模板，它应该使用所需的格式（“dd/MM/yyyy”）格式化我的所有 DateTime 属性：

```
@Html.TextBox(string.Empty, Model.ToString("dd/MM/yyyy"), new { @class = "datepicker" }) 
```

但由于某种原因，该格式不适用于我的孩子行为。

* * *

**如果我在MainPage** .cshtml中执行 @Html.EditorFor(x => x.MyDate)我会得到预期结果：“23/04/2012”

**如果我在ChildAction** .cshtml中执行 @Html.EditorFor(x => x.MyDate)我会得到以下意外结果：“2012-04-24”

* * *

我可以确认正在使用编辑器模板，因为如果我像这样更改它（注意开头的 WTF 字符串）：

```
WTF @Html.TextBox(string.Empty, Model.ToString("dd/MM/yyyy"), new { @class = "datepicker" }) 
```

然后，如果我在 ChildAction.cshtml 中执行 @Html.EditorFor(x => x.MyDate)

我得到：“WTF 2012-04-24”

有任何想法吗？

**更新**

为了在 MVC 示例应用程序中重现此错误，我发现还需要另外两件事：

```
public class DateTimeModelBinder : DefaultModelBinder
{
    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        var value = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);
        DateTime date;

        if (DateTime.TryParseExact(value.AttemptedValue, "dd/MM/yyyy", DateTimeFormatInfo.CurrentInfo, DateTimeStyles.AssumeLocal, out date))
        {
            return date;
        }

        return base.BindModel(controllerContext, bindingContext);
    }
} 
```

我假设每个人都知道如何连接它。同样在 MainPage.cshtml 中，您必须将模型作为第二个参数传递给 RenderAction

```
@{Html.RenderAction("Child", Model);} 
```

当传递模型作为第二个参数时，MVC 使用模型绑定器来调用子操作（为什么？）。但是，日期的格式是 MM/dd/yyyy，所以它不适用于我的模型活页夹，它假设我所有的日期都是 dd/MM/yyyy 格式。这就是为什么这不起作用。

但是我该如何解决呢？日期与我的默认格式 dd/MM/yyyy 不匹配的唯一地方是呈现子操作时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-02T21:10:33.990

**问题**

如果可能，MVC 使用模型状态值，但父操作与子操作的模型状态中的值不同：

*   在父操作中，模型状态包含提交给操作的日期**字符串（valueproviderresult 中的 RawValue）或默认值。**

*   当父操作将信息传递给子操作（渲染操作
    ）时，它会传递模型状态中的**dateTime**
    （valueproviderresult 中的 RawValue ）。

所以在父动作中，如果没有提交值，则正确使用 Textbox(...) 中提供的值。如果客户端以相同的格式提交了一个有效值，它似乎也可以，因为它采用模型状态的字符串，该字符串与显示模板中生成的字符串相同。

但在子操作中，它使用包含日期时间而不是提交的字符串的模型状态，**然后 MVC 使用不变文化将该日期时间转换为字符串，**因此它将显示 MM/dd/yyyy（我是 3 年后，所以值可能有由于您拥有 yyyy-MM-dd，因此在框架中进行了更改）

**解决方案**

您需要将模型状态中的值替换为您想要的值，或者将其删除以获取受影响的值。

```
public static void Fix(ModelStateDictionary dic, string key)
{
    ModelState modelState = dic[key];

    if (!modelState.Errors.Any() && modelState.Value.RawValue != null 
      && (modelState.Value.RawValue is DateTime || modelState.Value.RawValue is DateTime?))
    {
        var sValue = ((DateTime)modelState.Value.RawValue).ToString("dd/MM/yyyy");
        var value = new ValueProviderResult(sValue, sValue, CultureInfo.InvariantCulture);
        dic.SetModelValue(key, value);

        //or

        //dic.Remove(key);
    }
} 
```

然后在您的子操作中调用该方法：

```
Fix(ModelState, nameof(viewModel.DateMax)); 
```

# android - Android - 图像选择器，错误的图像

> ID：10288385
> 
> 赞同：16
> 
> 时间：2012-04-23T21:11:34.450
> 
> 标签：android, android-intent, action, media

我开始请求图像选择：

```
Intent intent = new Intent();
intent.setType( "image/*" );
intent.setAction( Intent.ACTION_GET_CONTENT );
startActivityForResult( Intent.createChooser( intent, "Choose"), PHOTO_GALLERY ); 
```

并将数据取回`onActivityResult`：

```
if( resultCode == Activity.RESULT_OK && requestCode == PHOTO_GALLERY )
{
  U.log( data.getData() );
  Bitmap bm = ... // built from the getData() Uri
  this.postImagePreview.setImageBitmap( bm );
} 
```

当我启动 Intent 时，我会看到一些文件夹，例如`sdcard`、`Drop Box`、`MyCameraApp`等。

如果我从 中选择图片`sdcard`，当我加载预览时，它是完全错误的图像。其他文件夹似乎没有给我这个问题。

有谁知道为什么它会让我选择一个图像，然后给我另一个 Uri？

**编辑：**以下是一些示例记录`getData()`：

好的：

`content://com.google.android.gallery3d.provider/picasa/item/5668377679792530210`

坏的：

`content://media/external/images/media/28`

**编辑：**从画廊的 sdcard 文件夹中选择时，我仍然遇到问题。

这是我在 onActivityResult 中所做的更多扩展：

```
// cursor
Uri selectedImage = data.getData();

String[] filePathColumn = { MediaStore.Images.Media.DATA };

Cursor cursor = mContext.getContentResolver().query( selectedImage, filePathColumn, null, null, null );
cursor.moveToFirst();

int columnIndex = cursor.getColumnIndex( filePathColumn[0] );
String filePath = cursor.getString( columnIndex );
cursor.close();

// Cursor: /mnt/sdcard/Pic.jpg : /mnt/sdcard/Pic.jpg
U.log( "Cursor: " + filePath + " : " + Uri.parse( filePath ) );

// "regular" 

// Regular: content://media/external/images/media/28 : content://media/external/images/media/28
U.log( "Regular: " + data.getDataString() + " : " + Uri.parse( data.getDataString() ) );

// Regular 2: content://media/external/images/media/28 : content://media/external/images/media/28
U.log( "Regular 2: " + data.getData() + " : " + data.getData() );

mPostImagePreview.setImageBitmap( BitmapFactory.decodeFile( filePath ) );
mPostImagePreview.setVisibility( View.VISIBLE ); 
```

他们仍然设置了错误的图像。如果我进入画廊，长按图像，查看我得到的详细信息：

```
TItle: Pic
Time: May 2, 2012
Width: 720
Height: 1280
Orientation: 0
File size: 757KB
Maker: Abso Camera
Model: Inspire 4G
Path: /mnt/sdcard/Pic.jpg 
```

所以，Gallery 告诉我路径与选择动作相同，Gallery 正在正确渲染它。那么，如果我从 onActivityResult 设置它，为什么它不渲染呢？

此外，这是我现在用来触发 Intent 的代码：

```
private void selectPhoto()
{
  Intent intent = new Intent( Intent.ACTION_GET_CONTENT );
  intent.setType( "image/*" );
  ( ( Activity )mContext ).startActivityForResult( Intent.createChooser( intent, "Select Picture" ), PHOTO_GALLERY );
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-12T05:22:24.323

这是打开画廊的代码。但是，这与您所做的相同。另请参阅`onActivityResult`我用来检索所选图像的代码。

```
Intent intent = new Intent();
intent.setType("image/*");
intent.setAction(Intent.ACTION_GET_CONTENT);
startActivityForResult(Intent.createChooser(intent, "Select Picture"),  
                       PHOTO_GALLERY);

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
switch (requestCode) {
    case PHOTO_GALLERY:
        if (resultCode == RESULT_OK) {
            Uri selectedImageUri = Uri.parse(data.getDataString());
            try {
                Bitmap bitmap = MediaStore.Images.Media.getBitmap(  
                                   getApplicationContext().getContentResolver(),   
                                   selectedImageUri);

                this.postImagePreview.setImageBitmap( bitmap);
            } catch (FileNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T22:12:19.513

有时，图库应用程序中的缩略图可能会过时并显示不同图像的缩略图。当图像 id 被重复使用时，可能会发生这种情况，例如，当图像被删除并使用相同的 id 添加新图像时。

管理应用程序 > 图库 > 清除数据可以解决这个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-17T18:43:35.277

`private static int RESULT_LOAD_IMAGE = 1;`

```
Intent i = new Intent(Intent.ACTION_PICK,android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
    startActivityForResult(i, RESULT_LOAD_IMAGE); 
```

活动结果

```
 @Override
        protected void onActivityResult(int requestCode, int resultCode, Intent data) {
            super.onActivityResult(requestCode, resultCode, data);
            if (requestCode == RESULT_LOAD_IMAGE && resultCode == RESULT_OK && null != data) {
                Uri selectedImage = data.getData();
                String[] filePathColumn = { MediaStore.Images.Media.DATA };
                Cursor cursor = getContentResolver().query(selectedImage,filePathColumn, null, null, null);
                cursor.moveToFirst();
                int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
                String picturePath = cursor.getString(columnIndex);
                cursor.close();
                ImageView imageView = (ImageView) findViewById(R.id.imgView);
                imageView.setImageBitmap(BitmapFactory.decodeFile(picturePath));
            }
        } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-18T06:03:02.503

试试这个

```
 //Put this code on some event 

   Intent intent = new Intent(Intent.ACTION_PICK,android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);

 startActivityForResult(intent, REQUEST_CODE);

           // When above event fire then its comes to this 
        @Override
        protected void onActivityResult(int requestCode, int resultCode, Intent data) {
            super.onActivityResult(requestCode, resultCode, data);
              if (resultCode==RESULT_OK && requestCode==1){

                  Uri selectedImage = data.getData();
                    String[] filePathColumn = { MediaStore.Images.Media.DATA };

                    Cursor cursor = getContentResolver().query(selectedImage,
                            filePathColumn, null, null, null);
                    cursor.moveToFirst();
                    int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
                    filePath = cursor.getString(columnIndex);
                    cursor.close();

                            // Use it as per recruitment 
                    actualBitmap =BitmapFactory.decodeFile(filePath);

              }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T07:01:49.567

试试这个，

```
public class SelectPhotoActivity extends Activity {

private static final int SELECT_PICTURE = 1;
private String selectedImagePath="";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Intent intent = new Intent();
    intent.setType("image/*");
    intent.setAction(Intent.ACTION_GET_CONTENT);
    intent.addCategory(Intent.CATEGORY_OPENABLE);
    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    startActivityForResult(intent, SELECT_PICTURE); 
}

public String getPath(Uri uri) {
    String[] projection = { MediaStore.Images.Media.DATA };
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    int column_index = cursor
            .getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data)
{
    if (resultCode == RESULT_OK) {
        if (requestCode == SELECT_PICTURE)
        {
            Uri selectedImageUri = data.getData();
            selectedImagePath = getPath(selectedImageUri);
           // here you can set the image
            }
    }
}

} 
```

# php - 简单的“facebook.php”不起作用

> ID：10288392
> 
> 赞同：2
> 
> 时间：2012-04-23T21:12:04.157
> 
> 标签：php, facebook, html, facebook-php-sdk

我对 PHP 世界和 facebook 集成相当陌生。我正在尝试将我的网站连接到我的 facebook 页面以获取内容，但一个简单的程序似乎无法正常工作。我确保在 github 上获得了最新版本的 facebook 代码。这是我在“test.php”中的内容：

```
<!DOCTYPE html>
   <html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>My Pictures</title>
    </head>
   <body>
   <a> hello 1 </a>
   <?php
   echo '<a> hello 2 </a>';
   include_once 'src/facebook.php';
   echo '<a> hello 3 </a>';
   include_once 'src/config.php';
   echo '<a> hello 4 </a>';
   $facebook = new Facebook(array(
       'appId'  => FACEBOOK_APP_ID,
       'secret' => FACEBOOK_SECRET_KEY,
       'cookie' => true,
       'domain' => 'uuu.com'
   ));
   echo '<a> hello 5 </a>';
   ?>

   </body> 
```

只是一些注释，我知道 facebook 的路径是正确的，我尝试放置其他文件，它运行良好，但是我只看到“Hello 1 Hello 2”，所以看起来 facebook.php 在某些事情上失败了，但我不知道，也不知道如何检查它是什么。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:20:47.873

```
 $facebook = new Facebook(array(
       'appId'  => FACEBOOK_APP_ID,
       'secret' => FACEBOOK_SECRET_KEY,
       'cookie' => true,
       'domain' => 'uuu.com'
   )); 
```

您是否已在获取 id 和密钥时注册了您的 facebook 应用程序？

另请注意，facebook 通信可能无法通过 localhost 进行。但为确保起见，请尝试通过以下代码行在您的网页上强制执行错误输出，以便您能够更详细地确定它为什么不起作用（然后在此处发布输出作为跟进，以获得更好的支持解决方案）：

```
ini_set('display_errors', '1');
error_reporting(E_ALL); 
```

# android - android上的用户凭据

> ID：10288393
> 
> 赞同：3
> 
> 时间：2012-04-23T21:12:04.813
> 
> 标签：android, mobile

> **可能重复：**
> [在 Android 应用程序中存储用户设置的最合适方式是什么](https://stackoverflow.com/questions/785973/what-is-the-most-appropriate-way-to-store-user-settings-in-android-application)

对于需要登录信息 (usr/pwd) 的应用程序，用户通常必须输入一次信息。那么应用程序在哪里存储敏感的凭证信息，以及使用了什么加密？

# vba - 尝试在所有 Excel 工作表上运行代码

> ID：10288400
> 
> 赞同：2
> 
> 时间：2012-04-23T21:12:34.433
> 
> 标签：vba, excel, excel-2007

我正在尝试在一个 Excel 文件中的所有工作表上运行此代码，但这不起作用。它只合并第一张纸上的单元格。这是我的代码：

```
Sub MergeColumns()
    Dim ws As Worksheet
    For Each ws In ActiveWorkbook.Worksheets
    Select Case ws.Name
    Case "Sheet1", "Sheet2", "Sheet3", "Sheet4"
   ws.Range("H1:S1").Select
            Case Else
    Selection.Merge
        With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
    End With
    End Select
    Next ws
End Sub 
```

我会很感激你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:15:38.280

这是你正在尝试的吗？

```
Option Explicit

Sub MergeColumns()
    Dim ws As Worksheet

    For Each ws In ActiveWorkbook.Worksheets
        Select Case ws.Name
        Case "Sheet1", "Sheet2", "Sheet3", "Sheet4"
            With ws.Range("H1:S1")
                .Merge
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlBottom
            End With
        End Select
    Next ws
End Sub 
```

或者如果你想忽略 Sheet1 到 Sheet4 然后试试这个

```
Option Explicit

Sub MergeColumns()
    Dim ws As Worksheet

    For Each ws In ActiveWorkbook.Worksheets
        Select Case ws.Name
        Case "Sheet1", "Sheet2", "Sheet3", "Sheet4"
        Case Else
            With ws.Range("H1:S1")
                .Merge
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlBottom
            End With
        End Select
    Next ws
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T05:00:54.507

如果您想对所有工作表运行相同的操作（根据我的理解，这是正确的），那么，为什么需要 switch case？

你可以写：

```
Option Explicit
Sub MergeColumns()
    Dim ws As Worksheet
    For Each ws In ActiveWorkbook.Worksheets
            With ws.Range("H1:S1")
                .Merge
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlBottom
            End With
    Next ws
End Sub 
```

# javascript - 动态地使子容器在可变宽度父容器内采用可用宽度

> ID：10288401
> 
> 赞同：0
> 
> 时间：2012-04-23T21:12:35.157
> 
> 标签：javascript, css, dynamic, truncate

我有一个围绕三个浮动容器包装的容器，包装容器的宽度可变，`left most inner container`宽度为 100 像素，宽度为 500 像素`right most inner container`。没有设定宽度，`center container`但应尽可能多地占用剩余空间。

```
<style type="text/css">
    #outerContainer div:nth-child(1) {float: left; width: 100px}
    #outerContainer div:nth-child(2) {float: left}
    #outerContainer div:nth-child(3) {float: right; width: 500px}
</style>

<div id="outerContainer">
    <div>left most inner container</div>
    <div>center container</div>
    <div>right most inner container</div>
</div> 
```

动态中心容器应用了一些样式，使其成为`overflow: hidden`用于演示目的的内容和省略号。

```
<style type="text/css">
#outerContainer div:nth-child(1) {
    overflow:hidden;
    text-overflow:ellipsis;
    white-space:nowrap;
}
</style> 
```

我不确定解决方案是仅使用 css 动态缩放此内部元素的宽度。这是我的 JavaScript 解决方案，它有效，但我想把它删掉，因为它看起来过分了。

```
NS.textWidth = function(sourceSel){
    var sourceSel = sourceSel,
        html_org = $(sourceSel).html(),
        html_calc = '<span>' + html_org + '</span>';

    //Wrap contents with a span.
    $(sourceSel).html(html_calc).css({width:'100%'});
    //Find width of contents within span.
    var width = $(sourceSel).find('span:first').width();

    //Replace with original contents.
    $(sourceSel).html(html_org);

    return width;
};

adjustContainerWidth();

$(window).bind('resize', function(e){
    clearTimeout(c.resize_timeout);

    c.resize_timeout = setTimeout(function() {
        adjustContainerWidth();
    }, 200);
});

function adjustContainerWidth() {
    var winW = parseInt($(window).width());
    var firstContainer = parseInt($('#outerContainer div:nth-child(1)').width());
    var lastContainer = parseInt($('#outerContainer div:nth-child(3)').width());
    var availW = winW - firstContainer - lastContainer;
    var textW = NS.textWidth('#outerContainer div:nth-child(2)');

    if (availW > 40 && availW < textW) {
        $('#outerContainer div:nth-child(1)').css({ width : availW + 'px' });
    } else {
        $('#outerContainer div:nth-child(1)').css({ width : textW + 'px' });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:19:33.060

目前，这是未经测试的，但我认为以下应该可行。有效地找到父级的宽度，兄弟级的宽度，然后从另一个中减去：

```
var that = $(this),
    parentWidth = that.parent().width(),
    siblingsWidth = 0;

that.siblings().each(
    function(){
        siblingsWidth += $(this).outerWidth();
    });

that.width(parentWidth - siblingsWidth); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/rYkQw/1/)。

我将`#outerContainer`元素设置为 1000 像素宽，只是为了确保所有元素都有空间以在演示中并排放置。

我还稍微修正了你的 CSS；CSS 是从 1 开始的，而不是像编程语言那样从 0 开始的。所以`#outerContainer div:nth-child(0)`没有匹配或样式化任何元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:28:42.933

纯 CSS [http://jsfiddle.net/Za8RF/](http://jsfiddle.net/Za8RF/)

# c++ - 从 C++ 代码将对象传递给回调函数

> ID：10288403
> 
> 赞同：1
> 
> 时间：2012-04-23T21:12:39.710
> 
> 标签：c++, node.js, callback

我正在为 Node.js 编写 Agueas [1] 插件

现在我有同步代码，C++ 类看起来像这样：

```
class LibAugeas : public node::ObjectWrap {
public:
    static void Init(Handle<Object> target);

protected:
    augeas * m_aug;
    LibAugeas();
    ~LibAugeas();

    static Handle<Value> New(const Arguments& args);

    static Handle<Value> get        (const Arguments& args);
    static Handle<Value> set        (const Arguments& args);
    static Handle<Value> setm       (const Arguments& args);
    // other methods
}; 
```

这个类在 JS 中的用法：

```
var lib = require('...');
var aug = new lib.Augeas(...);
aug.set(...);
aug.get(...);
// etc 
```

我要实现异步代码。

瓶颈是在加载和解析所有或部分镜头和文件时创建 augeas 对象 (aug_init)。所以想法是异步创建augeas对象，然后在回调函数中传递创建的JS对象：

1.  纯C线程：调用aug_init()、aug_load()获取augeas句柄。
2.  准备好后，使用 augeas 句柄创建 JS 对象（参见第一个片段）
3.  将创建的 JS 对象传递给回调函数。

用法可能是这样的：

```
lib.heracles(function(aug) {
        if (!aug.error()) {
            console.log('Hello!');

            // async save:
            aug.save(function(err, msg) {
                console.log(msg);
                });
        } else {
            console.log('Sad, but true :-(');
        }
    }
); 
```

**最后，我的问题：**我不知道如何在 C++ 中创建 JS 对象 :-)

构造函数`static Handle<Value> New(const Arguments& args);`返回`args.This()`，但是当我在 C++ 代码中时，我没有`args`也不能包装对象。

那么，如何在 C++ 中创建 JS 对象呢？请不要让我伤心地说这是不可能的:-)

[1] [http://augeas.net](http://augeas.net)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T17:38:59.147

好的，谢谢大家:-) 我找到了正确的方法。这是一个静态方法，它创建一个包装给定 augeas 句柄的 JS 对象。然后我可以将此对象从 C++ 代码传递给回调函数。

```
Local<Object> LibAugeas::New(augeas *aug)
{
    LibAugeas *obj = new LibAugeas();
    obj->m_aug = aug;

    Handle<ObjectTemplate> tpl = ObjectTemplate::New();
    tpl->SetInternalFieldCount(1); // one field for LibAugeas* pointer (via obj->Wrap())

#define _OBJ_NEW_METHOD(m) NODE_SET_METHOD(tpl, #m, m)
    _OBJ_NEW_METHOD(get);
    _OBJ_NEW_METHOD(set);
    _OBJ_NEW_METHOD(setm);
    _OBJ_NEW_METHOD(rm);
    _OBJ_NEW_METHOD(mv);
    _OBJ_NEW_METHOD(save);
    _OBJ_NEW_METHOD(nmatch);
    _OBJ_NEW_METHOD(insert);
    _OBJ_NEW_METHOD(error);

    Local<Object> O = tpl->NewInstance();
    obj->Wrap(O);
    return O;
} 
```

# jquery-mobile - 自定义 jQuery Mobile 选择菜单中的图标

> ID：10288409
> 
> 赞同：3
> 
> 时间：2012-04-23T21:12:58.717
> 
> 标签：jquery-mobile

我正在使用来自 jQuery Mobile 的自定义选择菜单，我想将图标放入自定义弹出菜单中以伴随每个`option`. 我将`data-icon`属性应用于 each `option`，如下所示：

```
<select name='mySelect' id='mySelect' data-icon='gear'>
    <option value='0' data-icon='star'>Option 0</option>
    <option value='1' data-icon='star'>Option 1</option>
    <option value='2' data-icon='star' selected="selected">Option 2</option>
</select> 
```

FWIW，我已经验证了我的自定义图标可以在选择按钮本身中使用。我期望图标出现在自定义菜单中是完全错误的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:40:35.883

默认情况下不支持此功能，但这里有一段快速代码可以使其成为可能：

```
//wait for the correct page to initialize
$(document).delegate('#home', 'pageinit', function () {

    //loop through each of the SELECT elements in this page
    $.each($(this).find('select'), function () {

        //get the ID of this select because it's menu's ID is based off of it
        var currentID = this.id;

        //iterate through each of the OPTION elements for this SELECT element
        $.each($(this).find('option'), function (index, element) {

            //if the OPTION element has the `data-icon` attribute
            if ($(element).attr('data-icon') != undefined) {

                //update the menu for this SELECT by adding an icon SPAN element
                //to each of the OPTION elements that has a `data-icon` attribute
                $('#' + currentID + '-menu').children().eq(index).find('.ui-btn-inner').append('<span class="ui-icon ui-icon-' + $(element).attr('data-icon') + ' ui-icon-shadow" />');
            }
        });
    });
});​​ 
```

这是一个演示：http: [//jsfiddle.net/NHQGD/](http://jsfiddle.net/NHQGD/)

# c# - 随机不明飞行物，飞出屏幕，永远不会回来

> ID：10288410
> 
> 赞同：0
> 
> 时间：2012-04-23T21:13:11.850
> 
> 标签：c#, xna

我实现了检查 ufo 的 X 位置是否大于游戏屏幕宽度的代码。如果是的话，飞碟已经死了。

我还实现了在 ufo 死亡时生成新数字的代码，在这种情况下，当生成正确的数字时，碟子应该飞过屏幕。

我不知道为什么它不这样做。碟子只随机飞过一次。

碟子的代码如下：

```
if (ufo.alive == true)
            {
                // also, we need to make it move
                ufo.Xpos = ufo.Xpos + 1;

                if (MissileFired != null)
                {
                    // if you miss, and the ufo carries on, it will go forever.
                    //so 
                    if (ufo.Xpos > 1000)
                    {
                     // kill the ufo if it goes off the screen.....   
                        ufo.alive = false;
                    } 
```

生成随机数的代码是：

```
if (ufo.alive == false)
            {
                Random random = new Random();
                int randomNumber = random.Next(0, 100);

                {
                    if (randomNumber == 1)
                        ufo.alive = true;
                } 
```

如您所见，我不知道为什么它在飞过并离开屏幕后不再生成不明飞行物。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:20:39.070

不要在每个周期创建一个新的随机数。

取出您的 Update 方法并将其声明为：

```
 class Game1: Game {
    public static readonly Random random = new Random(DateTime.Now.Millisecs);
    ....
 }

 ....

 if (ufo.alive == false) {
    int randomNumber = Game1.random.Next(0, 100);
    if (randomNumber == 1)
    {
      ufo.alive = true;
      ufo.Xpos = 0;
    }
} 
```

# sql - 在 BODI 中查找重复记录

> ID：10288414
> 
> 赞同：0
> 
> 时间：2012-04-23T21:13:24.027
> 
> 标签：sql, unique

我正在使用 BODI（业务对象数据集成器）将文件数据加载到表中。不幸的是，输入文件有一个重复的记录，在插入表时会给出唯一约束错误。有没有办法找到那个重复的记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:23:02.613

导入禁用或​​删除约束的表或具有类似结构但没有约束的表并执行查询

```
select uniquefield(s) from tablename group by uniquefield(s) having count(*) > 1 
```

有时错误消息也会显示重复的密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T10:06:33.743

您可以使用表格比较转换并设置字段“输入包含重复键”。即使源字段有重复记录，这也只会加载一次记录。

# gsm - 为什么GSM使用全双工，而手机只有一根天线？

> ID：10288416
> 
> 赞同：2
> 
> 时间：2012-04-23T21:13:43.757
> 
> 标签：gsm, duplex

根据[这个网站](http://gsmfordummies.com/intro/intro.shtml#fdma)：

> 尽管 GSM 以双工方式运行（发送和接收的频率不同），但移动台不会同时发送和接收。开关用于在发射器和接收器之间切换天线。

那么，使用单独的通道进行双向通信的优势是什么？沟通永远不能同时进行；为什么要分开（除了广播频道）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T20:40:58.927

一个原因是有助于无线电规划 - 如果强大的蜂窝天线（即基站天线）以与它们接收的相同频率广播，那么他们将很难“听到”来自手机的相对较弱的广播，而不是相对较弱的广播。来自相邻小区天线的强信号。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-10-31T23:09:31.100

“...GSM 以双工方式运行（发送和接收的频率不同），*移动台不会同时发送和接收*。”

这称为半双工。这样做是为了节省带宽和电池电量，并使手机通话更加困难。

# sql-server-2008 - 有什么方法可以知道哪些存储过程通过我的代码运行？

> ID：10288426
> 
> 赞同：0
> 
> 时间：2012-04-23T21:14:33.610
> 
> 标签：sql-server-2008, stored-procedures

SQL Server 2008

我们有很多sprocs，只是不知道哪些被调用了，有没有办法找出来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:19:40.430

SQL Server Profiler，位于开始 > Microsoft SQL Server 2008 > 性能工具下

# php - 当我知道格式时，php从字符串中获取时间戳

> ID：10288428
> 
> 赞同：6
> 
> 时间：2012-04-23T21:14:39.233
> 
> 标签：php, date, timestamp, date-format

是否有执行此操作的 php 函数：

```
$timestamp = get_timestamp_from_str('d/m/Y H:i', '10/10/2012 10:10'); 
```

strtotime() 将使用美国版本的“10/10/2012”，即 m/d/Y，但我有第一天。

对于特定情况，我可以制作自己的解析器，但日期格式可能会根据访问者的本地设置而改变。但是，我将永远知道当前的格式。

我必须插入最后一段，这样这个问题就足够长并且对于这个门户问题质量过滤器来说已经足够好了

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-23T21:17:24.830

是的，它叫[`DateTime::createFromFormat()`](http://us3.php.net/manual/en/datetime.createfromformat.php).

您可以将其用作：

```
$datetime = DateTime::createFromFormat( 'd/m/Y H:i', '10/10/2012 10:10', new DateTimeZone('Something'));
$timestamp = $datetime->getTimestamp(); 
```

只需确保您的时区字符串在[支持的时区列表中](http://us3.php.net/manual/en/timezones.php)。

# javascript - jQuery 等待异步 ajax 调用完成

> ID：10288429
> 
> 赞同：14
> 
> 时间：2012-04-23T21:14:46.780
> 
> 标签：javascript, jquery, ajax, asynchronous, wait

嗨，我的脚本中有 2 个 ajax 调用，我需要它们运行 asnyc 来腾出时间，但我需要第二个调用，直到第一个调用完成。

```
$.ajax({
    type: "POST",
    url: "getText.asmx/ws_getText",
    data: parO1,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (msg) {
        alert(msg.d.data);
    }, 
    error: function () {
        chyba("chyba v požadavku", "df");
    }
});

if (parO2.length > 0) {
    $.ajax({
        type: "POST",
        url: "getText.asmx/ws_getText",
        data: parO2,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            /*WAIT UNTIL THE FIRST CALL IS FINISHED AND THAN DO SOMETHING*/
        },
        error: function () {
            chyba("chyba v požadavku", "df");
        }
    });
} 
```

那么有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-23T21:19:59.630

如果使用 jQuery 1.5+，您可以使用[`jQuery.when()`](http://api.jquery.com/jQuery.when/)来完成此操作。类似的东西（为了简洁而缩短了 ajax 调用，只需像上面那样传递对象）

```
$.when($.ajax("getText.asmx/ws_getText"), 
       $.ajax("getText.asmx/ws_getText")).done(function(a1,  a2){

   // a1 and a2 are arguments resolved for the 
   // first and second ajax requests, respectively
   var jqXHR = a1[2]; // arguments are [ "success", statusText, jqXHR ]
}); 
```

您不知道它们将按什么顺序返回，因此如果您手动滚动，则需要检查另一个请求的状态并等待它返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:17:49.917

您需要连接第二个调用以包含在您的第一个 ajax 调用的回调中。像这样：

```
success: function(msg)
{
    alert(msg.d.data);

    if(par02.length > 0)
    {
        // Your 2nd ajax call
    }
}, 
```

由于 JavaScript 不会在客户端的多个线程中运行，因此在满足某些条件之前，您不能阻塞线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-08T15:34:56.293

使用 jQuery

```
$.ajax({
        type: "POST",
        async:false, // ** CHANGED **
        url: "getText.asmx/ws_getText",
        data: parO1,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            alert(msg.d.data);
        }
        , error: function () {
            chyba("chyba v požadavku", "df");
        }
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T21:25:25.363

这是运行双 ajax 请求的另一个答案。像 Tejs 一样，用户在成功方法中进行 ajax 调用......

海报说你最好让成功方法启动一个新的ajax请求..”

[在一个脚本中有两个 $.ajax() 调用](https://stackoverflow.com/questions/2645680/having-two-ajax-calls-in-one-script)

# jsf - s：字符串列表上的selectItems？

> ID：10288430
> 
> 赞同：1
> 
> 时间：2012-04-23T21:14:48.983
> 
> 标签：jsf, seam, seam2

我在 JBoss AS 5 上使用 seam 2.2.2.Final。我正在开发一个多页向导。在我的第一页上，用户将能够在 textarea 上输入几个用新行分隔的公司名称。

```
<s:decorate id="businessNameTextAreaField" template="layout/edit.xhtml">

                    <ui:define name="label">Business Names</ui:define>

                    <h:inputTextarea id="businessNameTextArea"

                                   cols="80"

                                   rows="3"

                               required="true"

                                  value="#{businessNameHome.instance.businessNameTextArea}"/>

            </s:decorate> 
```

提交页面后，系统解析输入的值并将其拆分为字符串列表

```
 public String checkBusinessNames(){

            String businessNameTextArea = this.getInstance().getbusinessNameTextArea();

            String[] businessNameTextAreaArray = businessNameTextArea.split("\\n");

            List<SelectItem> businessNameChoices = new ArrayList<SelectItem>();

            for(String businessNameText: businessNameTextAreaArray){           

                businessNameChoices.add(new SelectItem(businessNameText));

            }

            this.getInstance().setBusinessNameChoices(businessNameChoices);

            return "valid";

      } 
```

然后要求用户从有效企业名称列表中进行选择以进行注册

```
<s:decorate id="businessNameRegisterListField" template="layout/edit.xhtml">

 <ui:define name="label">Business Name</ui:define>

 <h:selectManyCheckbox  value="#{businessNameHome.instance.selectedbusinessName}" layout="pageDirection" immediate="true" >

 <s:selectItems value="#{businessNameHome.instance.businessNameChoices}" var="bn" label="#{bn.label}" />                                                                                      </h:selectManyCheckbox>                            

  </s:decorate> 
```

selectedbusinessName 是 String 类型，而 businessNameChoices 是 List

提交页面后，作为企业名称提交的内容如下所示：

```
javax.faces.model.SelectItem@135aa7c 
```

我尝试将 itemValue 放在 s:selectItems 上，但出现另一个错误，即“值无效”

尝试使用`<s:convertEntity>`但得到 NumberFormatException

我也尝试过创建自己的转换器

公共类 BusinessNameBeanConverter 实现 javax.faces.convert.Converter {

```
 @Override

        public Object getAsObject(FacesContext context, UIComponent cmp, String value)      {

            // TODO Auto-generated method stub

            System.out.println("getAsObject "+value);

            return value;

        }

        @Override

        public String getAsString(FacesContext context, UIComponent cmp, Object value) {

            // TODO Auto-generated method stub

            System.out.println("getAsString "+((SelectItem)value).getValue());

            return ((SelectItem)value).getValue();

        }

    } 
```

但我仍然收到相同的“值无效”错误。

我不知道该怎么办了。请帮忙。

谢谢，

尼古拉斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:20:21.553

改变

```
<s:selectItems value="#{businessNameHome.instance.businessNameChoices}" var="bn" label="#{bn.label}" /> 
```

至

```
<f:selectItems value="#{businessNameHome.instance.businessNameChoices}" /> 
```

您已经是 a ，而`List<SelectItem>`不是 a有用的。`List<SomeObject>``<s:selectItems>`

不要忘记删除转换器，这没有任何意义。

# c# - 将日期类型的命名参数插入 HQL 插入

> ID：10288432
> 
> 赞同：1
> 
> 时间：2012-04-23T21:15:10.243
> 
> 标签：c#, nhibernate, hql

我正在尝试执行 HQL 插入语句以将一些参数插入到我已映射到实体的表中。

这是我目前正在处理的（引发异常）：

```
Insert Into Entity1
(ForeignKey1, ForeignKey2, Date1, Date2)

SELECT this_.ForeignKey1, 
       cast(:param1 as int) as ForeignKeyValue2, 
       cast(:param2 as DateTime) as DateValue1, 
       cast(:param3 as DateTime) as DateValue2
FROM OtherEntity this_
WHERE ... 
```

如果我遗漏了 2 个日期字段，则插入有效，所以我知道我很接近。我只需要弄清楚如何让 nhibernate 将我的日期视为日期。

例外：

```
insertion type [NHibernate.Type.Int32Type] and selection type  
[NHibernate.Dialect.Function.CastFunction+LazyType] at position 1 are not compatible
[Insert Into Entity1
(ForeignKey1, ForeignKey2, Date1, Date2)

SELECT this_.ForeignKey1, 
       cast(:param1 as int) as ForeignKeyValue2, 
       cast(:param2 as DateTime) as DateValue1, 
       cast(:param3 as DateTime) as DateValue2
FROM OtherEntity this_
WHERE ... 
```

如果有人有做这种事情的经验，请随时提供帮助。此外，如果您知道如何在 DateTimes 上使用 HQL 转换，那也会有所帮助。DBMS 是 MS SQL 2008。：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T07:58:06.597

您永远不需要强制转换，只需将参数设置为正确的类型，例如

```
var hql = "insert into Entity1 (fkid, mydate) 
  select fkid, :date from OtherEntity";

session.CreateQuery(hql)
  .setDateTime("date", DateTime.Now)
  .ExecuteUpdate(); 
```

# mysql - GROUPED结果Mysql上的一个字段中的多行

> ID：10288436
> 
> 赞同：1
> 
> 时间：2012-04-23T21:15:25.630
> 
> 标签：mysql, group-by

我有这样的查询结果。

```
 status      count
    -----------------
    OTHER       5
    ATTENDED    74 
```

我想要这样的结果：

```
 OTHERS        ATTENDED
     5                74 
```

请注意，这已经是一个分组结果。所以我在想， Group_Concat 可能不起作用。

询问：

```
 SELECT CASE Rstat WHEN 1 THEN 'ATTENDED' 
                            WHEN 2 THEN 'TENTATIVE' 
                            WHEN 3 THEN 'REJECTED' 
                            WHEN 4 THEN 'OUTSTANDING' 
                            WHEN 6 THEN 'ACCEPTED' ELSE 'OTHER' END AS 'status',      
                            COUNT(Rstat) AS 'count' 
       FROM  `eStatus` 
       GROUP BY RSTAT 
```

还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:17:58.323

```
SELECT SUM(CASE WHEN Rstat = 1 THEN 1 ELSE 0 END) AS ATTENDED,
       SUM(CASE WHEN Rstat = 2 THEN 1 ELSE 0 END) AS TENTATIVE,
       SUM(CASE WHEN Rstat = 3 THEN 1 ELSE 0 END) AS REJECTED,
       SUM(CASE WHEN Rstat = 4 THEN 1 ELSE 0 END) AS OUTSTANDING,
       SUM(CASE WHEN Rstat = 6 THEN 1 ELSE 0 END) AS ACCEPTED,
       SUM(CASE WHEN Rstat NOT IN (1,2,3,4,6) THEN 1 ELSE 0 END) AS OTHER
    FROM eStatus 
```

# wcf - 在 WCF 3 层设计中 - DAL 究竟包括什么？

> ID：10288440
> 
> 赞同：0
> 
> 时间：2012-04-23T21:15:38.847
> 
> 标签：wcf, data-access-layer

我正在设计一个具有多种功能的 WCF 服务：

```
1\.  ProductDTO         GetProduct ( Guid productId )
2\.  void               SetProduct ( ProductDTO product )
3\.  List<ProductDTO>   GetAllProducts()
4\.  void               SetAllProductValues ( int newValue ) 
```

这些是服务将支持的操作。我将有一个业务层 (BL) 和一个数据访问层 (DAL)。

我将使用 LINQ-TO-EF 作为我的 ORM 来连接到 SQL 服务器表。

我的问题是 - DAL 究竟应该包含什么？

我问这个问题是因为我读过两本不同的书，说的是不同的东西：

**第一种方法：** DAL 仅包含数据访问层所需的类（如果有的话）。它包括为此的特殊实体或功能。LINQ-TO-EF 的 EDMX 和模型文件位于单独的程序集中（由 BL 和服务层引用）。在这种方法中 - BL 包含执行 LINQ 查询的实际函数。例如：“GetProduct”将执行 LINQ 查询以从数据库中提取数据。那么 - 在这种方法中 - DAL 中究竟应该包含什么？是空的吗？

**第二种方法：** DAL 包含用于在 DB 上执行 CRUD 操作的函数，这意味着 - 任何 LINQ-TO-EF 查询都将在 DAL 中完成。那么——在这种方法中——除了一些验证之外，BL 究竟做了什么？

哪种方法是正确的，这如何回答我对这种方法的担忧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T13:37:05.307

来自[MSDN：](http://msdn.microsoft.com/en-us/library/aa581778.aspx#aspnet_tutorial01_dataaccesslayer_vb_topic3)

"**所有特定于底层数据源的代码——例如创建到数据库的连接、发出 SELECT、INSERT、UPDATE 和 DELETE 命令等等——都应该位于 DAL 中。**表示层不应包含任何引用此类数据访问代码，但应改为对任何和所有数据请求调用 DAL。数据访问层通常包含用于访问基础数据库数据的方法。例如，Northwind 数据库具有产品和类别表，用于记录待售产品及其所属类别。在我们的 DAL 中，我们将使用以下方法：

GetCategories()，它将返回有关所有类别的信息

GetProducts()，它将返回有关所有产品的信息

GetProductsByCategoryID(categoryID)，将返回属于指定类别的所有产品

GetProductByProductID(productID)，它将返回有关特定产品的信息”

当然，您始终可以自由选择自己的设计，但我喜欢坚持普遍接受的做法，因此我的代码可能在任何商店都可以接受，并且对于以后必须维护它的任何人来说都是可以理解的......

# jquery - 客户端模板是否适合产品？

> ID：10288441
> 
> 赞同：0
> 
> 时间：2012-04-23T21:15:39.810
> 
> 标签：jquery, jquery-templates, jsrender

客户端模板是否适合开发产品？这不会向客户暴露大量的逻辑吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:19:38.037

客户端脚本确实是开放的，用户可以查看。然而，.NET 语言也确实可以被有效地反编译。

但是，这并不意味着两者都不能用来“开发产品”。

“产品”可以是开源的，除非它们有一些特定的东西使这令人望而却步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:26:51.653

这取决于您的 Web 应用程序的要求。以下是一些注意事项：

如果您有一个非常传统的页面加载模型，其中页面的内容是已知的并且在页面加载后不会更改，那么在服务器端构建 HTML 是理想的。

如果您对内容进行了 AJAX 更新，您仍然可以构建 HTML 服务器端并发送 HTML 字符串以插入 DOM。

现在，也许您有一个需要动态构建新 HTML 内容的丰富 UI，而模板化似乎很合适。例如，也许您单击添加行项目，并且需要使用输入框构建和添加行。现在使用模板可能更快。您可以避免对 HTML 服务器的服务调用，而是在客户端构建它。

即使仍然需要服务调用，您也可能有理由使用模板。这实际上取决于内容以及与您的应用相关的任何模型表示的其他情况。

这些天我不会担心发送某些逻辑客户端。您的模板代码不太可能具有任何 IP 敏感性质。在性能方面，如果您在 JavaScript 可以更快地处理所有事情时不等待服务器响应，那么您最终可能会获得更具响应性的用户体验。

# python - Django 对象日志错误：未定义名称“注册”

> ID：10288444
> 
> 赞同：1
> 
> 时间：2012-04-23T21:15:46.240
> 
> 标签：python, django

我有一个 Django 应用程序，我正在向它添加 Django 日志对象，我遵循此文档[https://code.osuosl.org/projects/django-object-log/wiki/Usage#Registering-Action-Types](https://code.osuosl.org/projects/django-object-log/wiki/Usage#Registering-Action-Types)

我在文档中的（自动缓存数据）部分，这是如何添加构建缓存和注册的示例：

```
def build_cache(user, obj1, obj2, obj3, data):
     return {'foo':obj.foo}

 register('MY_EVENT', 'template.html', build_cache)

 def my_view(request, pk):
     """ example view that retrieves an object by its pk """ 
     obj = SomeModel.objects.get(pk=pk)
     log('MY_EVENT', request.user, obj) 
```

现在我的代码在添加上述部分时如下所示：

```
from models import *
from django.template import Context, loader, RequestContext
from django.shortcuts import render_to_response , get_object_or_404
from django.http import HttpResponseRedirect, HttpResponse, Http404
from django.core.urlresolvers import reverse
from django.shortcuts import redirect
from django.views.decorators.csrf import csrf_protect
from django.core.mail import EmailMessage
#from django.contrib.formtools.tests.wizard.forms import request

from object_log.models import LogAction
from object_log.models import LogItem

register('MY_EVENT', 'template.html', build_cache)  

def build_cache(user, obj1, obj2, obj3, data):
     return {'foo':obj.foo}

LogAction.objects.register('MY_EVENT','path/to/my/template.html')
LogAction.objects.register('MY_EVENT','path/to/my/template.html')

 # store log_action for faster access
log = LogItem.objects.log_action

def create_task(request):
    #Employer.objects.filter(pk=request.session[user_id])
    employer_id = request.user.id #Take the employer in the current session

    getcategory = request.POST['cat_dd']
    getsubcategory = request.POST['subcat_dd']
    getname = request.POST['task_name']
    getdesc = request.POST['task_desc']
    getcountry = request.POST['country_dd']
    getcity = request.POST['task_city']
    getaddress = request.POST['task_address']
    getstatus = request.POST['status_dd']
    if (employer_id == NULL or getcategory == "Please select a category" or getsubcategory == "Please select a subcategory" or getname == "" or getdesc == "Write a short description about your task.." or getcountry == "(please select a country)" or getcity == "" or getaddress == "" or getstatus == ""):
        return render_to_response('createTask.html',RequestContext(request))
    else:
        t = Task.objects.create(employer = employer_id, category = getcategory, subcategory = getsubcategory, name = getname, description = getdesc, country = getcountry, city = getcity, address = getaddress, status = getstatus, contractor = NULL)
        t.save()
        return render_to_response('task.html',RequestContext(request))

def edit_task(request, task_id):
    t = get_object_or_404(Task, pk=task_id)
    t.category = request.POST['cat_dd']
    t.subcategory = request.POST['subcat_dd']
    t.name = request.POST['task_name']
    t.description = request.POST['task_desc']
    t.country = request.POST['country_dd']
    t.city = request.POST['task_city']
    t.address = request.POST['task_address']
    t.status = request.POST['status_dd']

    log('MY_EVENT', request.user, t,data={'foo':obj.foo})

    if (employer_id == NULL or getcategory == "Please select a category" or getsubcategory == "Please select a subcategory" or getname == "" or getdesc == "Write a short description about your task.." or getcountry == "(please select a country)" or getcity == "" or getaddress == "" or getstatus == ""):
        return render_to_response('editTask.html',RequestContext(request))
    else:
        t = Task.objects.create(employer = employer_id, category = getcategory, subcategory = getsubcategory, name = getname, description = getdesc, country = getcountry, city = getcity, address = getaddress, status = getstatus, contractor = NULL)
        t.save()
        #log('MY_EVENT', request.user, obj, data={'foo':obj.foo}) 
        return render_to_response('task.html',RequestContext(request)) 
```

但我得到了一个错误名称`'register' is not defined`

错误有什么解决办法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:22:25.610

尝试：

```
LogAction.objects.register('MY_EVENT', 'template.html', build_cache) 
```

代替：

```
register('MY_EVENT', 'template.html', build_cache) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-24T06:15:46.007

如果我们使用 `LogAction.objects.register('MY_EVENT', 'template.html', build_cache)` 错误将变为 `NameError: name 'LogAction' is not defined`

# javascript - 如何从JS中的字符串中获取十六进制整数？

> ID：10288445
> 
> 赞同：27
> 
> 时间：2012-04-23T21:15:48.403
> 
> 标签：javascript, hex

我想将 this: 转换`"#FFFFFF"`为 this: `0xFFFFFF`。不使用 eval 怎么可能？

提前致谢，

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-04-23T21:17:19.243

去掉“#”并使用`parseInt()`.

```
var hex = parseInt(str.replace(/^#/, ''), 16); 
```

然后，如果您想以十六进制*查看*它，您可以使用`.toString()`：

```
console.log(hex.toString(16)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-10T02:57:14.597

使用此代码：

```
var resultP = document.getElementById('result');
var btn = document.querySelector('button');
var input = document.querySelector('input');
function convert(hex) {
  return Number(`0x${hex.substr(1)}`);
}
btn.addEventListener('click', () => {
  resultP.innerHTML = convert(input.value);
})
```

```
* {
  font-family: Arial;
}
```

```
<!DOCTYPE html>
<html>
  <head>
    <title>Hex code to hex integer</title>
    <meta charset="UTF-8" />
  </head>
  <body>
    <input type="text" maxlength="7" />
    <button>Done</button>
    <br />
    Result:
    <p id="result"></p>
  </body>
</html>
```

# wordpress - custom_wp_pagenavi 在除 Safari 之外的所有浏览器中都能完美运行

> ID：10288449
> 
> 赞同：0
> 
> 时间：2012-04-23T21:16:14.173
> 
> 标签：wordpress

我在我的 WP 主题 functions.php 页面中使用以下代码，它在所有浏览器中都能完美运行，但并不总是出现在 Safari 中，因为它是断断续续的。

当它没有显示在页面上时，它在代码中，如果我查看源代码。

```
function custom_wp_pagenavi($before = '', $after = '', $prelabel = '', $nxtlabel = '', $pages_to_show = 5, $always_show = false) {
    global $request, $posts_per_page, $wpdb, $paged;
    if(empty($prelabel)) {
        $prelabel  = '<strong>&laquo;</strong>';
    }
    if(empty($nxtlabel)) {
        $nxtlabel = '<strong>&raquo;</strong>';
    }
    $half_pages_to_show = round($pages_to_show/2);
    if (!is_single()) {
        if(!is_category()) {
            preg_match('#FROM\s(.*)\sORDER BY#siU', $request, $matches);
        } else {
            preg_match('#FROM\s(.*)\sGROUP BY#siU', $request, $matches);
        }
        $fromwhere = $matches[1];
        $numposts = $wpdb->get_var("SELECT COUNT(DISTINCT ID) FROM $fromwhere");
        $max_page = ceil($numposts /$posts_per_page);
        if(empty($paged)) {
            $paged = 1;
        }
        if($max_page > 1 || $always_show) {
            echo "$before <div class=\"wp-pagenavi\"><span class=\"pages\">Page $paged of $max_page:</span>";
            if ($paged >= ($pages_to_show-1)) {
                echo '<a href="'.get_pagenum_link().'">&laquo; First</a>';
            }
            previous_posts_link($prelabel);
            for($i = $paged - $half_pages_to_show; $i  <= $paged + $half_pages_to_show; $i++) {
                if ($i >= 1 && $i <= $max_page) {
                    if($i == $paged) {
                        echo "<strong class='current'>$i</strong>";
                    } else {
                        echo ' <a href="'.get_pagenum_link($i).'">'.$i.'</a> ';
                    }
                }
            }
            next_posts_link($nxtlabel, $max_page);
            if (($paged+$half_pages_to_show) < ($max_page)) {
                echo '<a href="'.get_pagenum_link($max_page).'">Last &raquo;</a>';
            }
            echo "</div> $after";
        }
    }
}

<?php if (function_exists('custom_wp_pagenavi')) : ?>
<?php custom_wp_pagenavi(); ?> 
```

任何建议将不胜感激。

# vb.net - 为什么以编程方式解压缩 exe 文件有时会失败？

> ID：10288454
> 
> 赞同：0
> 
> 时间：2012-04-23T21:16:22.867
> 
> 标签：vb.net

我们以 zip 文件的形式提供升级。

Zip 文件中包含的文件之一是 TeamViewerQS_en.exe，它是我们作为购买的品牌组件提供的，位于我们应用程序的 Programs 文件夹中。

解压缩是通过从 VB.NET 类中以编程方式调用 PKZIPC.exe 来完成的，该类将 PKZIPC.exe 作为具有合适参数的新进程启动。

在我们大约 25 个客户中的一小部分，除了 TeamViewer 组件的副本之外，升级工作完美 - 应用程序的 EXE 及其所有 DLL 被正确替换，但 TeamViewer 可执行文件丢失。我能看到的唯一区别是应用程序 EXE 和 DLL 是原始 .MSI 安装的一部分。

它在大多数环境中都可以正常工作，因此我们不会无意中从 ZIP 中省略了该组件（我已经检查了几次！）

是否有某个 Windows 设置会以某种方式阻止 TeamViewer 可执行文件被复制？

如果登录用户是本地管理员，也会发生故障。

# ios - 从 iOS 使用 afconvert

> ID：10288457
> 
> 赞同：1
> 
> 时间：2012-04-23T21:16:32.977
> 
> 标签：ios, audio, file-sharing, afconvert

有谁知道是否可以从应用程序内转换 Documents 目录中的声音文件？我有一个录制的声音文件，它可以在我需要转换的 iTunes 文件共享中使用。afconvert 在 iOS 中可用吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:58:26.350

我不确定要从什么格式转换成什么格式，但是在运行时转换音频并不像命令行 afconvert 工具那么简单。

查看 Apple 的示例项目[iPhoneACFileConvertTest](http://developer.apple.com/library/ios/#samplecode/iPhoneACFileConvertTest/Introduction/Intro.html)或[ConvertFile](https://developer.apple.com/library/mac/#samplecode/ConvertFile/Introduction/Intro.html)。如果您想在应用程序中转换音频，我认为这些将是很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T19:28:16.467

对于它的价值，afconvert 只是 ExtAudioFile API 功能的便捷命令行界面，您可以在 - 使用此 API 将任何支持的文件格式/音频格式组合转换为任何支持的文件格式/音频格式组合。

# php - 使用正则表达式提取第一个“]”和最后一个“[”之间的内容？

> ID：10288461
> 
> 赞同：0
> 
> 时间：2012-04-23T21:16:54.337
> 
> 标签：php, regex

是否有可能有一个 PHP 正则表达式来提取从第一个 ] 到最后一个 [ 的内容？

例如，如果我有以下字符串：

```
$string = [shortcode]You write a shortcode by using ([])[/shortcode] 
```

我想提取：

```
You write a shortcode by using brackets ([]) 
```

并将其存储在变量中。要提取的内容可以是任何东西。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:20:07.110

您应该使用捕获组来确保匹配结束标记。

```
\[(\w+)\].*?\[/\1\] 
```

这将匹配内部的一个单词`[]`并继续运行，直到在内部找到相同的单词`[/...]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:19:06.033

正则表达式默认是贪婪的，所以这可以很好地完成工作：

```
/\](.*)\[/ 
```

为了让它在 PHP 中正常工作，你可以这样做：

```
preg_match('/\](.*)\[/', $text, $matches);

$result = $matches[1]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:25:46.880

这可以做，你需要什么

```
[^\]]\](.*)\[[^\[] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T21:31:00.107

这有效：

```
preg_match( '@\](.*)\[@', $string, $matches);
print_r($matches); 
```

# iphone - 标题和栏按钮未显示在导航栏中

> ID：10288476
> 
> 赞同：2
> 
> 时间：2012-04-23T21:18:04.347
> 
> 标签：iphone, ios, uitableview, uinavigationbar, title

我在设置标题和向导航栏中添加栏按钮时遇到了一些奇怪的困难。

我的应用程序是一个选项卡式应用程序。问题出在我的第一个标签中。第一个选项卡包含一个 UINavigationController，其中包含一个 UITableViewController。来自我的 AppDelegate：

```
UIViewController *firstViewController = [[MyTableViewController alloc] init];
UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:firstViewController];

_tabBarController = [[TFTabBarController alloc] init];
_tabBarController.delegate = self;
_tabBarController.viewControllers = [NSArray arrayWithObjects:navigationController, nil]; 
```

在 firstViewController 中选择一行时，我将 UIWebViewController 推送到导航堆栈上：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    UIViewController *secondViewController = [[MyWebViewController alloc] init];
    [self.navigationController pushViewController:secondViewController animated:YES];
} 
```

在拦截 WebView 中超链接的 onclick 时，我将另一个 UITableView 推送到导航堆栈上：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    NSURL *url = [request URL];
    if (navigationType == UIWebViewNavigationTypeLinkClicked)
    {
        UIViewController *thirdViewController = [[MyTableViewController alloc] init];
        [self.navigationController pushViewController:thirdViewController animated:YES];

        return NO;
    }
    return YES;
} 
```

当thirdViewController 打开时，它的导航栏只包含带有前一个视图标题的后退按钮，用于向后导航。它的标题和右栏按钮未显示...

这就是我尝试显示它们的方式：

```
self.title = @"My Title";

self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Push me" style:UIBarButtonItemStylePlain target:self action:@selector(push)]; 
```

我也尝试通过navigationController设置按钮，但仍然没有运气：

```
self.navigationController.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Push me" style:UIBarButtonItemStylePlain target:self action:@selector(push)]; 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:35:32.400

检查它`self.navigationItem`并且在访问时`self.navigationController`不存在。`nil`

从文档中：

> 第一次访问该属性时，会创建 UINavigationItem 对象。因此，如果您不使用导航控制器来显示视图控制器，则不应访问此属性。

访问这些成员的好地方是`-viewDidLoad`在初始化时而不是初始化时。

# php - 在多个 Web 应用程序之间共享 PHP 会话

> ID：10288479
> 
> 赞同：3
> 
> 时间：2012-04-23T21:18:11.727
> 
> 标签：php, session

我在同一个域上有两个 Web 应用程序（一个 CMS 和一个电子商务平台），我想在它们之间共享会话数据。我可以轻松设置它，以便它们都使用相同的会话，但 $_SESSION 变量中变量名冲突的可能性太大。我以为我可以使用命名会话，但我也无法让它工作：

```
session_name("WEB_APP_ONE");
session_start();
$webAppOneData = $_SESSION;
session_write_close();

//var_dump($_SESSION) = all of the session data for web app one is still contained in $_SESSION even though I closed the session with session_write_close()

session_name("WEB_APP_TWO");
session_start();
$_SESSION['WEB_APP_ONE'] = $webAppOneData;

//var_dump($_SESSION) = all of the session data for web app one is still here 
```

我不确定这是否可能，但我想知道是否可以！

注意：我得到的实际用例是能够显示 CMS 中访问者的购物车中有多少产品。购物车数据存储在电子商务平台的会话中，但我需要从 CMS 的标题中显示。我希望 CMS 和购物车之间能够无缝集成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:47:59.390

我建议只使用嵌套数组命名会话：

```
$_SESSION['app1']['app1var'] = 'value';
$_SESSION['app2']['app2var'] = 'value'; 
```

您也可以考虑从数据库中存储和检索会话信息，仅使用会话来存储用户身份验证信息，该信息告诉您要访问哪些数据库行。

# php - jos_users 与 joomla 数据库上的 jos_core_acl_aro 不同步

> ID：10288481
> 
> 赞同：1
> 
> 时间：2012-04-23T21:18:27.533
> 
> 标签：php, sql, joomla

这真是让我头疼的事情。去年我在我的 joomla 网站上遇到了这个问题，但我设法使用我不再拥有的 sql 查询来同步这些表。

我真的认为这已经得到了很好的解决，但昨天我只是注意到这个表不再同步了。jos_users 表有 4967 个用户，而 jos_core_acl_aro 有 5135 个用户，差别很大。

我正在使用 joomla 1.5.22 和我使用 2 个组件，我怀疑这与此问题有关： Rereminder（通知非活动用户并在特定时间删除非活动帐户）取消注册（让用户永久删除他们自己的帐户）

现在我想知道在 phpmyadmin 中运行的查询，这样我就可以看到 jos_users 中缺少哪些数据，因为 jos_core_acl_aro 有更多数据。比较这两个表并检查丢失的数据之类的东西。我一直在谷歌上搜索这个，但也许我不是我的幸运日..

此致 Daniel Q.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:51:41.150

不知道表格也不知道Joomla，所以你必须填补空白。

```
select a, b, c from jos_core_acl_aro
minus
select a, b, c from jos_users 
```

a、b 和 c 是您要查看的列，它们必须在两个表中（尽管它们可以有不同的名称）。同样，它们在每个表中应该是唯一的。

# version-control - “向后移植”的工作流程更改为不同的 Mercurial (Hg) 分支？

> ID：10288482
> 
> 赞同：11
> 
> 时间：2012-04-23T21:18:41.100
> 
> 标签：version-control, mercurial, branch, cherry-pick

我们有两个头。一个是我们的主要开发负责人，另一个是我直到今天才忘记的那个。我们发现了一个错误并在我们的主要开发分支中修复了它，我刚刚意识到它也应该在旧分支中修复。

我认为在旧分支上进行更改并将其与最新分支合并会更好，但我们没有这样做。水银能处理这个吗？我们还没有尝试过这样的事情，我也无法真正理解它是如何完成的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T07:22:09.040

是的，您有两个不错的选择：

# 嫁接：Mercurial 2.0 中的新功能

该版本引入了[graft 命令](http://www.selenic.com/mercurial/hg.1.html#graft)，可以智能地反向移植更改。“智能”是它将在内部使用合并，这意味着你得到

*   **支持重命名：**假设您修复`foo.c`了开发分支上文件中的错误。在较旧的维护分支`foo.c`中被调用`bar.c`。使用`hg graft`，更改`foo.c`可以正确合并到旧`bar.c`。

*   **三向合并：**嫁接涉及[扭曲图形](https://stackoverflow.com/a/9605306/110204)并在该临时图形中合并。三向合并的优点是您可以使用普通的图形合并工具来解决冲突。

要将提示复制`default`到`old-branch`您身上，只需运行

```
$ hg update old-branch
$ hg graft default 
```

# 移植：旧版本

在我们有移植命令之前，[移植扩展](http://mercurial.aragost.com/kick-start/en/tasks/#transplanting-changes)是要走的路。这个简单的扩展会将变更集导出为补丁，并尝试将补丁应用到其他版本。

因为我们正在处理“哑”补丁，所以不会考虑重命名之类的事情，并且您将不会获得对您的合并工具的支持，因为没有三向合并。尽管如此，我发现移植在实践中效果很好。

使用移植很简单：

```
$ hg update old-branch
$ hg transplant default 
```

这非常接近运行

```
$ hg update old-branch
$ hg export default | hg import - 
```

除了移植还在移植的变更集中添加了一条记录原始变更集的元数据。这可以用来跳过未来的移植。

# jquery - 如何让 jquery-mobile 和依赖插件与 require.js 一起工作？

> ID：10288483
> 
> 赞同：2
> 
> 时间：2012-04-23T21:18:43.910
> 
> 标签：jquery, jquery-mobile, asynchronous, requirejs

我正在第一次尝试实现 Require.js，虽然我正在尝试遵循这两个教程（[这里](http://backbonetutorials.com/organizing-backbone-using-modules/#idc-cover)和[这里](https://stackoverflow.com/questions/4535926/requirejs-and-jquery)），但我并没有完全让它发挥作用。这是我到目前为止所拥有的：

在我的**索引文件中**：

```
<script type="text/javascript" data-main="../js/main" src="../js/libs/require/require.js"></script> 
```

**main.js**内部

 **```
require.config({ baseUrl: "../js/",
  paths: {       
   "jq-loader":    "libs/jquery/jquery",
   "jqm-loader":   "libs/jquery-mobile/jquery-mobile",
   "someplug":     "libs/someplug/somplug",
   }
 });
// define app and dependencies??? - not sure what goes here? All plugins I'm using?
require(['app','order!libs/jquery/jquery', 'order!libs/jquery-mobile/jquery-mobile'], 

function(App){
    App.start();
    }); 
```

**jquery.js**内部

 **```
 define([ 'order!libs/jquery/jquery.min' ], function(){ return $; }); 
```

在**jquery.js**内部（取决于 Jquery）

```
 // ERROR here in "mobile" being undefined
 define(['order!libs/jquery-mobile/jquery-mobile.min'], function(){ return mobile; }); 
```

和**app.js**

```
define([ 'jq-loader', 'jqm-loader'], function($, mobile){
    var start = function() {
    $(document).ready(function() {
        alert("Hello world!");
        })
      }
     return {"start":start};
   }); 
```

到目前为止，我很高兴我做到了，但我真的很想看到一切都在点击。现在，我收到一个错误**mobile is not defined**在我的 jquery-mobile.js 文件中。我猜是因为 Jquery-Mobile 并不真正属于它所在的地方......

有人可以阐明一下吗？非常感谢！

**编辑：**
这是我的[示例设置的链接](http://www.franckreich.de/jqm/members/index.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T22:00:07.340

在我看来，那一刻 jqm 对 jquery 一无所知。所以你得到一个错误。如果要使用这样的加载器，可能需要在一个 require 块中加载 jquery。比在回调加载 jqm 中使用多一个要求。但是你不需要这些 wrappers-loaders 来用 jqm 加载 jquery。

在主js中首先加载jquery，而不是jqm。那就足够了。此外，您不必在 app.js 中定义它们。

Main.js 应该类似于：

```
require.config({ baseUrl: "../js/",
  paths: {  
   "app": "path to app",
   "jquery":    "path to jquery",
   "jqm":   "path to jqueryMobile",
   "someplug":     "libs/someplug/somplug",
   }
});
require(['order!jquery', 'order!jqm', 'app'], 

function(jquery, jqm, App){
    App.start();
    }); 
```

还有你的 app.js：

```
define([], function(){
  var start = function() {
  $(document).ready(function() {
    alert("Hello world!");
  })
  }
  return {"start":start};
  }); 
```

请让我知道它是否无济于事，并将您的资源上传到某处。问候。****

# java - 多语言IDE

> ID：10288488
> 
> 赞同：3
> 
> 时间：2012-04-23T21:18:53.100
> 
> 标签：java, c++, python, eclipse, visual-studio

我有一个使用多种语言的软件，它们都可以作为 eclipse 插件（java、c++、python）使用。前任互相打电话。我想知道是否有一种方法可以使用 eclipse 调试所有这些语言。我有所有它们的源代码，它们都是 eclipse 中的项目，但到目前为止它们独立工作，我想知道是否，例如，如果我在 C++ 代码中添加了一个断点并调用了一个 java 程序调用 C++ 代码，执行将在到达 C++ 断点时暂停。我认为这在某种程度上类似于 Visual Studio 中的“附加到进程”，尽管我不确定 Visual Studio 是否也提供此功能。eclipse 或 Visual Studio 可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:24:54.890

据我所知，Eclipse 不支持多调试器调试。但是，可以同时在多个 Eclipse 实例中调试同一个工作区。只需按照您所说的附加到它们上，分别启动每种语言的调试器。

# iphone - 如何使用 HTTP 和 JSON 将我的 sqlite 数据库中的数据发送到服务器

> ID：10288489
> 
> 赞同：0
> 
> 时间：2012-04-23T21:19:05.907
> 
> 标签：iphone, objective-c, cocoa-touch, sqlite, http

我在 sqlite 中存储 id、lat、lng 和时间戳，现在需要将其以 JSON 对象的形式发送到服务器。

这是我插入数据的地方。

```
NSString *insertStatement = [NSString stringWithFormat:@"INSERT INTO location (latitude, longitude, timeStamp) VALUES (%g, %g, %@)",newLocation.coordinate.latitude, newLocation.coordinate.longitude, newLocation.timestamp];    
char *error;   
if ( sqlite3_exec(databasehandle, [insertStatement UTF8String], NULL, NULL, &error) == SQLITE_OK)
{
    NSLog(@"Location inserted. %@", newLocation.timestamp);
}    

else NSLog(@"Error: %s", error); 
```

这是我现在正在处理的代码。我不知道从这里去哪里：

```
 NSString *queryStatement = [NSString stringWithFormat:@"SELECT ID, latitude, longitude, timeStamp FROM LOCATION"];

// Prepare the query for execution
sqlite3_stmt *statement;

if (sqlite3_prepare_v2(databasehandle, [queryStatement UTF8String], -1, &statement, NULL) == SQLITE_OK)
{
    // Iterate over all returned rows
    while (sqlite3_step(statement) == SQLITE_ROW) { 
```

这是我想用来发送数据的 JSON/HTTP 代码

```
responseData = [NSMutableData data];

//whatever your server address is
NSURL *url = [NSURL URLWithString:@"http://www.resturl.com/whatever"];

NSError *jsonError;
//NSJSONSerialization is Apple's new json serialization class so we can use it to convert to and from json and foundation objects
NSData *requestdata = [NSJSONSerialization dataWithJSONObject:returnArray options:0 error:&jsonError];

NSMutableURLRequest *request;
 request = [NSMutableURLRequest requestWithURL:url];
[request setHTTPMethod:@"POST"];
[request setValue:[NSString stringWithFormat:@"%d", [requestdata length]] forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:requestdata]; 

//this kicks off the request asynchronously
NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T04:10:55.023

我正在使用相同的代码，但没有使用 web 服务在数据库中发布数据。

```
NSURL *url = [NSURL URLWithString:@"someurl/try_ws_iphone/insertRecords.php"];
NSArray *res=[[NSArray alloc] initWithObjects:txtname.text, nil];
NSError *jsonError;
//NSJSONSerialization is Apple's new json serialization class so we can use it to convert to and from json and foundation objects
NSData *requestdata = [NSJSONSerialization dataWithJSONObject:res options:0 error:&jsonError];

NSMutableURLRequest *request;
request = [NSMutableURLRequest requestWithURL:url];
[request setHTTPMethod:@"POST"];
[request setValue:[NSString stringWithFormat:@"%d", [requestdata length]] forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:requestdata];

//this kicks off the request asynchronously
NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

# oracle - 适合开发人员个人使用的 Oracle 角色？

> ID：10288493
> 
> 赞同：3
> 
> 时间：2012-04-23T21:19:17.307
> 
> 标签：oracle, roles

我们正在人们的桌面上安装一些 Oracle XE 服务器（免费的）以供开发使用。

分配给这些开发人员的好的默认角色是什么？由于这些实例仅包含临时数据，因此数据安全性不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:19:04.163

如果您希望开发人员能够做任何事情，请授予开发数据库上的 DBA。当然，这样做是有风险的；如果他们自己开发和运行代码，他们将无法满足应用程序的安全需求。

如果您希望开发人员使用应用程序的安全上下文，请授予他们与应用程序在 Prod 中相同的角色。

所以; 如果您希望他们能够在 Dev 实例上做任何事情，但仍然在与 Prod 上相同的安全上下文中编码，请为他们创建 2 个用户。第一个是具有与在 Prod 中执行的代码相同权限的普通用户，第二个是具有 DBA 角色的 DBA 用户。

对于一些习惯于 Windows 方法（域管理员用户使用域管理员权限阅读电子邮件、浏览网页等）的人来说，这很奇怪，但对于将电子邮件作为低级别用户重做但可以 SUDO 的 Unix 用户来说非常熟悉需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T05:11:08.173

作为开发人员，我在开发数据库上所要求的只是系统密码，以及某些表空间中的足够空间来创建我的对象。这给了我足够的动力——我可以创建我的用户，授予他们所需的访问权限，然后开始开发。

# c++ - 2D 向量/动态数组

> ID：10288504
> 
> 赞同：1
> 
> 时间：2012-04-23T21:20:06.853
> 
> 标签：c++, arrays, pointers, vector

我正在尝试使用 2D 数组来跟踪以网格方式布置的一些对象。我希望 2d 数组的每个元素都包含一个`Object*`. `Object`作为我定义的类。然而，使用这些东西并不容易。

这是我用`Object`指针填充二维数组的方法：

```
int xDim; 
//how far to go in the x direction
//x's Dimension that is

Object *** test; //the highest level pointer used

test = new  Object ** [xDim];
//add horizontal array of Object **

for(int fillPos=0; fillPos < xDim; fillPos++){
    //point each Object ** to  a new Object * array 
    //add column arrays
    test[fillPos] = new Object*[zDim];
} 
```

我的意图是使用这个数组的`Object`指针指向 的子类`Object`，比如说`childObj`。我的意图是以这种方式使用它们。

```
for (int xPos=0; xPos < xDim; xPos++){
    for(int zPos=0; zPos < zDim; zPos++){
        //pointing each Object * in the 2D array to
        //a new childObj
        test[xPos] [zPos] = new childObj;
    }
} 
```

我意识到这在记忆方面可能是一个真正的麻烦。我在问这是否是处理这种情况的好方法。也许像这样 的东西`vector< <vector<Object*> >`可以更好地工作？向量会很好地管理删除以避免内存泄漏吗？或者也许我只需要遍历向量并在摆脱向量之前调用`delete`每个向量？`Object*`

那么，我应该使用现有的数组还是向量？每种方法可能存在哪些问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T21:54:56.987

使用`Object ***`要求您按顺序依次删除 each `Object Pointer`、 each `Array of Object Pointers`，然后最后删除最外层`Array of Object**`的 。在我看来，这为粗心和错误留下了很大的空间。

```
for (int xPos=0; xPos < xDim; xPos++) {
    for (int zPos=0; zPos < zDim; zPos++) {
        delete test[xPos][yPos];  // delete the object ptr
    }
    delete[] test[xPos];          // delete each array of object ptr
}
delete[] test;                    // delete the array of array of object ptrs 
```

我更喜欢向量方法，因为向量是局部范围的。动态分配可能相当昂贵，应尽可能避免。

因此，对于矢量方法，您只需要删除 Object ptrs。（一个好的经验法则是每次调用 new 都需要调用相应的 delete）。

```
vector<vector<Object*>> matrix;

... // some code here

for each (vector<Object*> vec in matrix)
    for each (Object* oPtr in vec)
        delete oPtr; 
```

如果您在编译时知道二维数组的大小，则可以达到相同的效果，即避免二维数组的内存管理，而只需管理对象指针。

```
Object * matrix[xDim][yDim];  // xDim and yDim are compile-time constants 
```

但是我仍然喜欢向量，因为它们具有与数组不同的是能够动态调整自身大小的额外好处，因此您不必担心预先知道大小。

# sql - 将 SQL 表导出为固定长度格式

> ID：10288516
> 
> 赞同：2
> 
> 时间：2012-04-23T21:21:06.953
> 
> 标签：sql, sql-server, sql-server-2008, concatenation

我目前的表格中有数据，其格式如下：

```
County     Office     First Name     Last Name
01         01         John           Smith
99         01         Jane           Cole 
```

我需要使用 SQL 将其导出到固定长度的文本文件中。输出应如下所示：

```
0101JohnSmith
9901JaneCole 
```

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T22:15:08.450

假设所有列都是`NOT NULL`：

```
SELECT [County]         -- already matches length of 2?
     + [Office]         -- ... ditto
     + right('                    ' + [First Name], 20)
     + right('                    ' + [Last Name], 20)
FROM   tbl 
```

是的，那是一串 20 个空格。因此`[First Name]`，`[Last Name]`名称将在*左侧*填充空白，并且*始终*为 20 个字符长。

或者，如果您希望将字符串填充到*右侧*：

```
left([First Name] + '                    ', 20) 
```

# matlab - 在 Matlab 中从二进制文件中读取 64 位整数不会给出正确的结果

> ID：10288517
> 
> 赞同：2
> 
> 时间：2012-04-23T21:21:12.583
> 
> 标签：matlab

编辑：问题是即使指定输入 matlab 的精度仍然会将它们转换为双精度，除非您另有指定。我的错。

将一个简单的 64 位整数读入 matlab 似乎给出的值与我在 python 或 windows 计算器中进行转换时给出的值不同。

我有一个 8 字节长的小文件，其内容是

```
0x99, 0x1e, 0x6b, 0x40, 0x27, 0xe3, 0x01, 0x56 
```

我在matlab中使用以下内容：

```
fid = fopen('test.data')
input = fread(fid, 1, 'int64') 
```

我明白了

```
input = 6197484319962505200 
```

但是，使用 python 或 windows 计算器，我得到了不同的十进制表示`0x5601e327406b1e99`。两者都预测我应该得到 `input = 6197484319962504857`（与 343 不同）。它显然不是一个字节顺序问题，因为那样它就会消失。

我最初被引导对此进行测试，因为从大型二进制文件中读取双精度会给出奇怪的结果。然后我尝试将它们作为整数读取并手动比较。

我的问题是，我做错了什么，有什么我忽略了，还是 matlab 在这里出错了？我正在使用win64 matlab R2010a。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T21:52:26.720

问题似乎`fread`是实际上将其读为双精度：

```
>> class(input)

ans =

  double 
```

因为这个数字太大了，所以这可能是最接近的双精度值。

如果我手动指定 matlab 变量应该是`int64`，它对我有用，除了在源文件中指定类型（请参阅[文档`fread`](http://www.mathworks.com/help/techdoc/ref/fread.html)）：

```
>> input = fread(fid, 1, '*int64')

input =

  6197484319962504857 
```

# c - 小c程序中的奇怪括号

> ID：10288518
> 
> 赞同：-2
> 
> 时间：2012-04-23T21:21:15.487
> 
> 标签：c

我正在用 C 编写一个简单的程序：

```
int main(int argc, char** argv) {
    unsigned char* line = (unsigned char* ) malloc(0xFFFF);
    while (gets(line) > 0) {
        if (line[0] == 'l') {
            if (line[2]=='.' && line[3] == '.') {
                printf("forbidden path");
            } 
            unsigned char* res = (unsigned char* ) malloc(0xFFFF);
            unsigned char* cmd = (unsigned char* ) malloc(strlen(line) +
            1 + strlen(" | grep -v xml") + strlen("/home/files/"));
            strcpy(cmd, "ls ");
            strcpy(cmd + 3, "/home/boris/0servfiles/");
            strcpy(cmd + 3 + strlen("/home/files/"), line + 2);
            strcpy(cmd + 3 + strlen("/home/files/") + strlen(line + 2), " | grep -v xml");
            execwthr(cmd, res);
            printf("%s\n%s", cmd, res);
            free(cmd);
            free(res);
        } else if (line[0] == 'm') {
            if (line[2]=='.' && line[3] == '.') {
                printf("forbidden path");
            } 
            unsigned char res = (unsigned char* ) malloc(0xFFFF);
            unsigned char* cmd = (unsigned char* ) malloc(strlen(line) +
                1 + strlen("/home/files/"));
            strcpy(cmd, "mkdir ");
            strcpy(cmd + 6, "/home/files/");
            strcpy(cmd + 6 + strlen("/home/files/"), line + 2);
            execwthr(cmd, res);
            printf("%s\n%s", cmd, res);
            free(cmd);
            free(res);
        }
    }
    return (EXIT_SUCCESS);
} 
```

有一个小问题。当我尝试创建一个名为“h”的文件夹时，我得到以下信息：

```
m l
mkdir /home/files)l 
```

怎么了？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:24:07.380

您似乎不知道该`strcat()`功能。使用它将大大简化您的代码。

此外，您为什么要编写 C 代码来完成可以使用简单的 shell（或 Perl）脚本更容易完成的工作？例如，我相信你的脚本在 Perl 中看起来像这样：

```
#!/usr/bin/perl
use strict;
while (my $line = <STDIN>) {
    chomp $line;
    my $cmd;
    if (my ($arg) = $line =~ m{^l (.*)$}) {
        $cmd = "ls /home/files/$arg | grep -v xml";
    } elsif (my ($arg) = $line =~ m{^m (.*)$}) {
        $cmd = "mkdir /home/files/$arg";
    }
    my $res = `$cmd`;
    print "$cmd\n$res\n";
} 
```

请注意，此代码未经测试，并且（仍然）不安全。但是，它比您的代码更短且更易于阅读。这表明 C 语言不适合这项任务。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T21:50:35.380

这里有很多问题。我将列出一些，解决它们可能会使其他人更明显。

当输入出现意外路径时，您会打印出“禁止路径”。但是，您使用该无效路径继续执行该函数。发生这种情况时，您可能希望完全退出程序。

该`malloc()`功能可能会失败。当它执行时，它返回一个 NULL 指针。您从不检查返回的值`malloc`，这意味着您的字符串操作代码可能使用了无效指针。

你不应该使用类似的函数`strcpy()`，因为它们不能为你提供防止缓冲区溢出的保护。改用“安全”版本（如`strncpy`）。

该功能`gets()`非常不安全，已被弃用。请改用其他标准库 I/O 函数。

这段代码：

```
strcpy(cmd, "ls ");
strcpy(cmd + 3, "/home/boris/0servfiles/");
strcpy(cmd + 3 + strlen("/home/files/"), line + 2); 
```

可能没有做你想做的事。第二行将一个长字符串添加到缓冲区，但第三行仅向前跳到足以容纳更短的字符串。这意味着您的第三个`strcpy`将部分覆盖第二个写入的字符串`strcpy`。

像这样的代码：

```
strcpy(cmd, "mkdir ");
strcpy(cmd + 6, "/home/files/");
strcpy(cmd + 6 + strlen("/home/files/"), line + 2); 
```

容易出错并且充满了幻数。如果我正确地解释了您所做的事情，您可以将其组合成一个更有意义的调用：`sprintf(cmd, "mkdir /home/files/%s", line + 2);`.

正如其他人所提到的，您似乎正在重新实现标准`strncat()`功能。您最好使用标准版本。如果您正在处理这样的硬编码字符串，我什至建议使用`snprintf()`.

以下行是错误的：

```
unsigned char res = (unsigned char* ) malloc(0xFFFF); 
```

您正在分配一个指向 a 的指针`char`，这几乎肯定不是您想要的。

您为 动态分配内存`line`，但从不释放它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:24:39.267

这段代码很糟糕。请参考[strcat()](http://www.cplusplus.com/reference/clibrary/cstring/strcat/)函数。

我还看到了许多其他问题。例如，如果代码确定输入了“禁止路径”，那么它将继续执行任务！

您将受益于学习如何使用调试器来单步执行此代码并查看它的实际作用。这也将使您也能够回答您的原始问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T23:33:06.593

Basically all of your ugly code could be replaced by a single call to `snprintf` with the right arguments. Don't bother learning `strcat`; while, as others have said, it will be easier than what you're doing, it also makes it easy to write vulnerable code. Just use `snprintf` for all your string-producing needs and your code will be clean, simple, and even has a decent chance of being bug-free.

# api - 使用“Near”而不是“LL”的地点搜索 API 不准确

> ID：10288519
> 
> 赞同：1
> 
> 时间：2012-04-23T21:21:25.160
> 
> 标签：api, search, foursquare

当我通过 API 搜索场所时，我得到的结果与foursquare 网站不同。例如，我正在“加利福尼亚州旧金山”附近寻找一个名为“Nopalito”的场所。我的印象是这应该返回相关匹配：

[https://api.foursquare.com/v2/venues/search?query=Nopalito&intent=match&near=San%20Francisco%2C%20CA](https://api.foursquare.com/v2/venues/search?query=Nopalito&intent=match&near=San%20Francisco%2C%20CA)

我只收到一个名为“Invocation”的场所的结果。但是，当我通过foursquare.com 网站运行类似的查询时，我得到了我所期望的：

[https://foursquare.com/search?tab=venueResults&q=Nopalito&lat=&lng=&near=San+Francisco%2Cca&source=q](https://foursquare.com/search?tab=venueResults&q=Nopalito&lat=&lng=&near=San+Francisco%2Cca&source=q)

网站搜索在加利福尼亚州旧金山产生了两个名为 Nopalito 的场所。

似乎是一个非常基本的查询，潜在结果数量有限。这是怎么回事？我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:42:03.507

乍一看，我建议删除 intent=match，intent=match 会进行非常严格的查询。intent=match （来自[https://developer.foursquare.com/docs/venues/search](https://developer.foursquare.com/docs/venues/search)）的目的是

> “查找与给定查询和 ll 几乎完全匹配的场所。这在尝试将现有场所数据库与foursquare 相关联时很有帮助。它对提供的位置高度敏感。结果将首先排序最佳匹配，取考虑到距离和拼写错误/变化。”

对于这种类型的查询，我建议使用 intent=browse。

# oracle - Oracle：将角色从一个数据库复制到另一个？

> ID：10288520
> 
> 赞同：2
> 
> 时间：2012-04-23T21:21:25.603
> 
> 标签：oracle, roles, sqlplus

我想将一些角色从生产数据库复制到测试数据库。

如何以编程方式生成基于文本的 SQLPLUS 脚本来执行此操作？因为我只对角色感兴趣，所以我不想使用 EXP/IMP。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T21:25:13.270

DBMS_METADATA 可能会有所帮助：[http ://www.orafaq.com/wiki/DBMS_METADATA](http://www.orafaq.com/wiki/DBMS_METADATA)

```
SELECT dbms_metadata.get_ddl('ROLE', role) FROM dba_roles;
SELECT dbms_metadata.get_granted_ddl('ROLE_GRANT',  '&&your_role_name') FROM dual;
SELECT dbms_metadata.get_granted_ddl('SYSTEM_GRANT','&&your_role_name') FROM dual;
SELECT dbms_metadata.get_granted_ddl('OBJECT_GRANT','&&your_role_name') FROM dual; 
```

# java - 使用公钥/私钥签名进行身份验证：什么是好消息（摘要）？

> ID：10288521
> 
> 赞同：3
> 
> 时间：2012-04-23T21:21:29.697
> 
> 标签：java, security, authentication, digital-signature, public-key-encryption

我正在构建一个具有客户端/服务器基础架构的应用程序，并希望使用公钥/私钥方法实现身份验证机制。

假设客户端拥有私钥，而服务器只有公钥。在身份验证期间，客户端使用私钥对消息进行签名，然后将其发送到使用公钥对其进行验证的服务器。如果验证成功，则客户端通过身份验证。

这是一些 JUnit 测试代码，我在其中熟悉了这些概念：

```
@Test
public void testSignature() throws Exception {
    final String message = "Hello world is a stupid message to be signed";

    final KeyPair keyPair = KeyPairGenerator.getInstance("RSA").generateKeyPair();

    final Signature privSig = Signature.getInstance("SHA1withRSA");

    privSig.initSign(keyPair.getPrivate());
    privSig.update(message.getBytes());

    byte[] signature = privSig.sign();

    final Signature pubSig = Signature.getInstance("SHA1withRSA");

    pubSig.initVerify(keyPair.getPublic());
    pubSig.update(message.getBytes());

    assertTrue(pubSig.verify(signature));
} 
```

当然，为了使其工作，服务器和客户端都必须拥有纯消息（摘要）。

现在我的问题是：用于签名的好消息（摘要）是什么？例如，这可以是一个静态的、硬编码的字符串（用于**所有**客户端）还是会给这个概念带来某种安全问题？如果静态字符串不好，在身份验证之前协商一些随机字符串是个好主意吗？例如，这个随机字符串可以用作“会话”密钥，并在一段时间后失效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:50:47.487

静态字符串会很糟糕，因为它容易受到重复攻击（签名字符串每次都相同）。

虽然，您似乎正在重新发明以前所做的事情。使用证书是值得信赖的方式。有关详细信息，请参阅此示例：[Java HTTPS 客户端证书身份验证](https://stackoverflow.com/questions/1666052/java-https-client-certificate-authentication)

如果您想自己实现它，您可能需要阅读 SSL 的工作原理并模仿它。任何其他解决方案都可能存在一些缺陷，除非它是非常定制的（例如，您的客户端将保留 1000 个共享静态字符串的列表，它从未重用过，并且服务器具有相同的列表并跟踪已使用过。或者，按照以下评论中的建议，跟踪递增的共享数字。）

# php - Wordpress .htaccess 修改

> ID：10288524
> 
> 赞同：-2
> 
> 时间：2012-04-23T21:21:46.167
> 
> 标签：php, wordpress, .htaccess

我有一个具有这种结构的网站：

首页 关于我们 产品 产品 服务 联系方式

如果我打开 mysite.com/products 读取 page-products.php 和

mysite.com/product 读取 page-product.php

我需要使用 page-product.php 作为通用页面。例如... mysite.com/product/The-Best-Product/32 阅读 page-product.php?name=The-Best-Product&id=32)

怎么样

mysite.com/john/ 并读取 page-user.php?username=john

有可能做出这样的事情吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:41:09.440

考虑使用 Apache Web 服务器的[mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)，这是一个非常强大的工具，可以满足您的需要。如果您使用的是 Apache，这只会对您有所帮助。此外，如果您不是网站管理员，则必须启用 mod_rewrite 才能在 .htaccess 文件中使用。

我链接的页面底部有一些关于如何使用它的示例。此外，还有很多教程。

# javascript - 使用带有选择框的 jQuery 的 insertAfter() 是否存在已知的性能问题？

> ID：10288525
> 
> 赞同：2
> 
> 时间：2012-04-23T21:21:53.130
> 
> 标签：javascript, jquery, dom

我有两个“页面”（基本上是两个 div 标签；一次只显示一个）。根据用户所在的“页面”，选择框将出现在第 1 页的 jQuery UI 对话框中（作为滑块），或者作为普通选择框出现在第 2 页上。我的问题是，我可以使用 insertAfter() 将选择框从一个页面/div 移动到另一个页面/div 吗？或者，更具体地说，有什么理由我不应该这样做？我避开了 clone() 函数，因为它会创建重复的 ID，并且基本上复制每个选择框并尝试同步它们的值似乎有点过头了，除非有充分的理由不使用 insertAfter()。

这是代码的模型，以防我的解释不够清晰：

HTML：

```
 <div id="page1">
         <select id="tango">
            <option>Jester</option>
         </select>
    </div>

<div id="page2">
   <div id="dialog">
       <!-- Select Menu would be inserted/moved here -->
   </div>
</div> 
```

JavaScript：

```
$('select#tango').insertAfter('#dialog'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:30:42.427

使用`$('select#tango').insertAfter('#dialog');`脚本实际上会导致：

```
<div id="page2">
   <div id="dialog">

   </div>
   <!-- Select Menu would be inserted/moved here -->
</div> 
```

我认为您真正希望将其放置在您希望的位置：

```
$('select#tango').appendTo('#dialog'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:27:35.640

> 我的问题是，我可以使用 insertAfter() 将选择框从一个页面/div 移动到另一个页面/div 吗？或者，更具体地说，有什么理由我不应该这样做？

不，你没有理由不能或不应该这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:39:14.397

它没有任何问题。这是一个工作演示[http://jsfiddle.net/pomeh/FA23E/](http://jsfiddle.net/pomeh/FA23E/)

HTML 代码

```
<div id="page1">
     <select>
        <option>A</option>
        <option>B</option>
        <option>C</option>
     </select>
</div>

<div id="page2">
   <div id="dialog">
       <!-- Select Menu would be inserted/moved here -->
   </div>
</div>

<input type="button" value="Dance for me !" /> 
```

Javascript代码

```
var clicks = 0,
    $select = $("select"),
    $targets = [ $("#dialog"), $("#page1") ];

$("input").on("click", function() {
    var $target = $targets[ clicks++ % 2 ];

    $select.appendTo( $target  );
}); 
```

# ios - EASession 泄漏

> ID：10288528
> 
> 赞同：6
> 
> 时间：2012-04-23T21:22:48.727
> 
> 标签：ios, memory-leaks, external-accessory, eaaccessory

我有一个连接到附件的应用程序，当您断开附件时，我创建的用于与附件通信的 EASession 泄漏。

当配件连接时，我会收到通知并检查 EAAccessoryManager 的配件集合，以查找具有特定名称且使用特定协议的配件。当我找到这个时，我使用代码为该附件创建一个 EASession 对象：

```
-(void) openSession
{
   ...  // finds accessory object

   if (accessory)
   {
      [self closeSession];
      session = [EASession alloc];
      NSLog(@"alloc :: session retainCount: %i", session.retainCount);
      [session initWithAccessory:accessory forProtocol:SmokeSignalsProtocolName]; 
      NSLog(@"init  :: session retainCount: %i", session.retainCount);

      [[session inputStream] open]; 
      [[session outputStream] open]; 

      ... // other logic (pump run loop, etc..)
   }
}

-(void) closeSession
{
    if (session)
    {
       [[session inputStream] close]; 
       [[session outputStream] close]; 
       [session release], session = nil;
    }
} 
```

通常我将 alloc 和 init 放在一行上，但我发现（像这样将它分开）是 alloc 提供 +1 保留计数（如您所料）**但是**当`iniWithAccessory:forProtocol:`我给它 +3 保留计数只会期望 init 方法中的 +2 retainCount。

泄漏工具似乎也支持这一点：

![在此处输入图像描述](../Images/ec8250c1a7ebb2c764a87e74ea7ebdaa.png)

一步一步看泄漏仪器：

1.  +1 保留计数 :: `[???Accessory openSession]`- 这是我分配新 EASession 的地方。
2.  +1 保留计数 ::`[EAInputStream iniWithAccessory:forSession:]`输入流保留对拥有会话的引用。
3.  +1 保留计数 ::`[EAOutputStream initWithAccessory:forSession:]`输出流保留对拥有会话的引用。
4.  +1 保留计数 ::`[EASession iniWithAccessory:forProtocol:]` 我不知道为什么这会增加 EASession 的保留计数。我相信这是造成我无法解释的额外保留计数的原因......不确定这应该如何平衡。这是Apple的错误吗？我需要`release`额外的时间来平衡事情……非常非常奇怪。
5.  -1 保留计数 ::`[EAInputStream close]` 清理上面的步骤 #2
6.  -1 保留计数 ::`[EAOutputStream close]` 清理上面的第 3 步
7.  -1 保留计数 ::`???Accessory closeSession]`清理上面的步骤 #11

那么...为什么我要泄漏 EASession 对象？使用 EASession 对象不泄漏的正确方法是什么？

* * *

## 编辑 - EADemo 不会泄漏，但...

[EADemo](http://developer.apple.com/library/ios/#samplecode/EADemo/Introduction/Intro.html)连接到配件，但不会泄漏。出于好奇，我添加了一个额外`[_session retain]`的内容以使其泄漏，以便我可以在仪器中跟踪它的 malloc 历史。有趣的是，我的应用程序的 malloc 历史记录中没有调用一些内部调用。

![在此处输入图像描述](../Images/cfb63c5e50296c29dead7fc4adc7fb2b.png)

你可以看到这已经`[EAAccessoryInternal removeSession:]`调用了 3 次。这在我的应用程序的 malloc 历史中从未被调用过。我认为这是为什么我的 EASession 没有被释放的关键......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-14T09:58:03.627

虽然演示以相反的方式进行，但我设法通过在将输入和输出关闭方法从运行循环中删除并将它们的委托设置为 nil**后调用来修复此泄漏。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-16T12:18:31.957

我知道这个讨论现在已经很老了，但我最近使用 ARC 等时遇到了完全相同的问题，我发现解决它的一种方法是不关闭输入或输出流。只需有一个处理所有输入等的类，并根据请求将数据转发到应用程序的其他部分。您可以重新分配初始化 EASession 对象，而不会收到 XCode 的投诉，因此我假设旧的 EASession 已被释放，因为我的 APP 不再引用它。但是，我还没有检查泄漏。

# c - 构造和解析网络数据包

> ID：10288534
> 
> 赞同：2
> 
> 时间：2012-04-23T21:23:11.133
> 
> 标签：c, sockets, network-programming

我有以下数据包格式：

```
 1B       4B      1B    1B    string   2 bytes    1B      string  
+------+----------+---+--------+---~~--+---------+--------+---~~---+
| type | lifetime | 2 | length | Name  | Counter | length |  Data  |
+------+----------+---+--------+---~~--+---------+--------+---~~---+

typedef struct pkt_data {
    u_char pkt_type;
    u_int lifetime;
    u_char type;
    u_char len_name;
    u_char name[100];
    u_short counter;
    u_char len_data;
    u_char data[200];
}__attribute__((__packed__)) Data; 
```

下面是构造和解析数据包的代码：

```
int buildDataPacket(u_int _lifetime, u_char* _name, u_short _counter, u_char* _data, u_char* _dataPacket) {
    Data *ndata=NULL;
    u_char *ptr;

    memset(_dataPacket, 0, 512);

    ndata = (Data *) _dataPacket;
    ndata->pkt_type = 2;
    ndata->lifetime = htonl(_lifetime);
    ndata->type = 2;
    ndata->len_name = strlen(_name);

    ptr = (u_char *)ndata + (3 * sizeof(u_char)) + sizeof(u_int);
    strncpy((char *)ptr, (char *)_name, strlen(_name));

    u_short counter = htons(_counter);
    u_char datalen = strlen(_data);

    ptr = ptr + strlen(_name);
    memcpy(ptr, &counter, sizeof(u_short));
    ptr = ptr + sizeof(u_short);
    memcpy(ptr, &datalen, sizeof(u_char));
    ptr = ptr + sizeof(u_char);
    strncpy((char *)ptr, (char *)_data, strlen(_data));
    ptr = ptr + strlen(_data);

    return (ptr - (u_char *)_dataPacket);
}

int processDataPacket(u_char* _dataPacket, u_short _pktLen)
{
    if (!_dataPacket || !_pktLen) {
            return -1;
    }

    Data *dataPkt;
    dataPkt = (Data *)_dataPacket;

    printf("Lifetime: %d\n", ntohl(dataPkt->lifetime));
    printf("Name: %s\n", dataPkt->name);
    printf("Counter: %d\n", dataPkt->counter);
    printf("Data: %s\n", dataPkt->data);

    return 0;
} 
```

当我在wireshark中嗅探数据包时，发现数据包的构造是按照格式来的。但是“counter”和“len_data”的值是零，即使我相应地设置了它们。此外，当我收到数据包时，完整的数据包不会存储在缓冲区中。

```
rval=recvfrom(inet_sock, buf, BUFLEN-1, MSG_DONTWAIT, (struct sockaddr *) &dest_sin, &socklen);

buf[rval]=0;
fprintf(stderr, "Received: %d (%d) bytes containing %s", rval, strlen(buf), buf); 
```

“rval”返回正确的总字节数，但“buf”在“name”之后终止。strlen(buf) 仅返回数据包的长度，直到名称为止。所以“数据”在 processDataPacket 中是空的。请指导我如何构造和解析这个数据包。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:27:50.900

> ```
> ptr = ptr + strlen(_name);
> memcpy(ptr, &counter, sizeof(u_short)); 
> ```

这是错误的。`strlen(_name)`当您应该精确推进指针位置时，您只会推进指针位置`100`，因为`_name`is `u_char name[100]`。

边注：

*   `u_int lifetime;`不保证是 4 个字节。为此使用`uint32_t`。同样适用于`u_short`（使用`uint16_t`）

> strlen(buf) 返回数据包的长度

由于数据包不仅仅是一个大字符串（它还包含非文本数据，例如`u_int lifetime`），因此无法使用`strlen`它将在第一个`0`字节处停止。

# junit - 什么构成了“标准 jmock 库”？

> ID：10288535
> 
> 赞同：0
> 
> 时间：2012-04-23T21:23:16.360
> 
> 标签：junit, jmock

我正在关注本指南[http://javaeenotes.blogspot.com/2011/06/short-introduction-to-jmock.html](http://javaeenotes.blogspot.com/2011/06/short-introduction-to-jmock.html)

我收到了错误

```
java.lang.SecurityException: class "org.hamcrest.TypeSafeMatcher"'s signer information does not match signer information of other classes in the same package. 
```

作者在指南中说：

> 解决方案是确保 jMock 库包含在构建路径中的标准 jUnit 库之前。

“标准 jmock 库”和“junit 库”由什么组成？Junit 只有一个罐子，所以这很容易，但 jmock 有超过 10 个不同的罐子。

我一直在使用：j-unit4.10、jmock-2.5、hamrest-core 和 hamcrest-library

hamcrest 核心和库类有什么用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T09:21:17.493

我是这两个库的提交者。JMock 依靠 hamcrest 来帮助它决定是否需要调用一个对象。我建议只使用 hamcrest-all jar。hamcrest 核心和库之间的分离是将匹配和报告差异的基本行为与最常见情况的方便实现分开。

最后，如果您使用的是 hamcrest，我建议您使用 junit-dep jar 以避免与 junit.jar 中包含的 hamcrest 的某些功能发生冲突

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T08:39:57.790

JUnit 用于进行单元测试以测试您的方法。JMock 用于在上下文中测试您的程序，您必须知道您期望发送到上下文 (ENV) 的内容以及回答上下文的内容。

JMock 使用 JUnit，这就是为什么为了避免依赖冲突，需要在 JUnit 之前包含它。

如果您需要使用 JMock 脚本或 JMock 核心中不可用的任何其他功能，则 JMock 的 10 个库是一种附加组件。

您无需了解 Hamcrest 核心库即可使用 JMock。只需按照网站上的指南（不要使用 JMock 版本 1）并以正确的顺序组织您的库（JUnit 应该放在最后以避免您的错误）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:08:17.617

模拟框架 licke jmock 在幕后做了一些黑魔法（包括但不限于运行时字节码操作）以提供模拟方法类等。为此，需要对基本的 junit 类进行一些调整，唯一的方法是在加载 JU 类之前将自己注册为 java 代理。

此外，将您的模拟框架放在类路径中的 junit 之前

# php - php 重定向不适用于 wordpress，但适用于静态页面...？

> ID：10288537
> 
> 赞同：-2
> 
> 时间：2012-04-23T21:23:24.673
> 
> 标签：php, wordpress, redirect

当我在静态网页上包含此代码时，它可以正常工作，但是当放入 wordpress 博客的标题时，它只显示一个空白页面？

是否有人能够识别以下代码的任何问题，这些问题会导致它显示这些错误？

```
<?php
/**
 * Redirect script.
 * ----------------
 * 
 * How it works:
 * 
 * 1\. You MUST include this before ANYTHING on your page. E.g:
 * <?php
 *      include 'redirect.php';
 * ?>
 * <html>
 * ...
 * 
 * 2\. This script will redirect to an advertise url depending on which id specified. E.g:
 * http://yoursite.com?id=192
 * ... will find ad with id "192" and then redirect to this page.
 * 
 * It will only redirect if ?id= is specified as parameter, otherwise everything works like usual.
 */ 
if(isset($_POST['jviahfwagjfbvjahuiaf']))
{
    echo '<html><head><META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW"></head><body><form action="http://'.htmlspecialchars($_SERVER['SERVER_NAME']).'" method="post" id="formy">
<input type="hidden"  name="rfjafwofa" value="'.htmlspecialchars($_POST['jviahfwagjfbvjahuiaf']).'" /></form>
<script language="JavaScript"> 
document.getElementById(\'formy\').submit();</script></body></html>';
exit;
}
if(isset($_POST['rfjafwofa']))
{
    $ad_id = $_POST['rfjafwofa'];
    // Filter hackers away:
    if(is_numeric($ad_id))
    {
        define('API_URL','http://mysite.com/api.php');
        // First retrive advertisement:
        $response = '';

        // Use cUrl if it exists...
        if(function_exists('curl_init'))
        {
            $ch = curl_init();
         curl_setopt($ch, CURLOPT_URL, API_URL.'?ads_id='.$ad_id);
         curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
         curl_setopt($ch, CURLOPT_HEADER, false);
         curl_setopt($ch, CURLOPT_TIMEOUT, 10);
         curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
         $response = curl_exec($ch);
         curl_close($ch);
        }
        else
        // Otherwise just use this...
        {
            $response = @file_get_contents(API_URL);
        }

        // If advertisement was found:
        if($response != '')
        {
            // Redirect:
            header('Location: '.$response);exit;
        }        
    }
}

if(isset($_GET['id']))
{
echo '<html><head><META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW"></head><body><form action="http://'.htmlspecialchars($_SERVER['SERVER_NAME']).'" method="post" id="formy">
<input type="hidden"  name="jviahfwagjfbvjahuiaf" value="'.htmlspecialchars($_GET['id']).'" /></form>
<script language="JavaScript"> 
document.getElementById(\'formy\').submit();</script></body></html>';
exit;
}
?> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:29:53.727

重定向不起作用，因为您在 header("Location,..") 调用之前输出了一些内容。如果您已将代码添加到标题中，您可能会在脚本之前输出一些内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:37:55.120

如果您的标头已发送，则无法再次发送。你可以试试。

```
ob_start();
header('Location: '.$response);exit;
ob_end_flush(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:57:33.187

根据上面的评论，听起来您将代码示例`<head></head>`放在`header.php`. 如果是这样，请`<head></head>`从上面的代码中删除标签，然后重试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-21T15:27:28.563

使用标题和位置的标准 php 代码在 word 中不起作用 按安装

```
header("Refresh: 1; URL=".$redirect); 
```

您必须使用 word press 功能，或者这是另一个对我有用的解决方案

```
 echo "<meta http-equiv=\"refresh\" content=\"10;url=$redirect\" />"; 
```

我希望这有帮助

# objective-c - 来自 AudioUnitRender 的错误 -50

> ID：10288541
> 
> 赞同：7
> 
> 时间：2012-04-23T21:23:38.243
> 
> 标签：objective-c, ios, audio, core-audio, audiounit

在以下上下文中，我从 AudioUnitRender 收到错误 -50（无效参数）。我使用这个[Pitch Detector](http://demetrimiller.com/2011/01/25/pitch-detection-in-ios-4-x/ "音高检测器")示例应用程序作为我的起点，它运行良好。我的项目中唯一的主要区别是我还使用远程 I/O 单元进行音频输出。音频输出工作正常。这是我的输入回调和初始化代码（为简洁起见，删除了错误检查）。我知道这很多，但错误 -50 确实给我很少的关于问题可能出在哪里的信息。

输入回调：

```
OSStatus inputCallback( void* inRefCon, 
                            AudioUnitRenderActionFlags  *ioActionFlags, 
                            const AudioTimeStamp        *inTimeStamp, 
                            UInt32                      inBusNumber, 
                            UInt32                      inNumberFrames, 
                            AudioBufferList             *ioData) {

    WBAudio* audioObject= (WBAudio*)inRefCon;

    AudioUnit rioUnit = audioObject->m_audioUnit;
    OSStatus renderErr;
    UInt32 bus1 = 1;

    renderErr = AudioUnitRender(rioUnit, ioActionFlags, 
                                inTimeStamp, bus1, inNumberFrames, audioObject->m_inBufferList );
    if (renderErr < 0) {
        return renderErr; // breaks here
    }

    return noErr;
} // end inputCallback() 
```

初始化：

```
- (id) init {

    self= [super init];
    if( !self ) return nil;

    OSStatus result;

    //! Initialize a buffer list for rendering input
    size_t bytesPerSample;
    bytesPerSample = sizeof(SInt16);
    m_inBufferList = (AudioBufferList *)malloc(sizeof(AudioBuffer));
    m_inBufferList->mNumberBuffers = 1;
    m_inBufferList->mBuffers[0].mNumberChannels = 1;
    m_inBufferList->mBuffers[0].mDataByteSize = 512*bytesPerSample;
    m_inBufferList->mBuffers[0].mData = calloc(512, bytesPerSample);

    //! Initialize an audio session to get buffer size
    result = AudioSessionInitialize(NULL, NULL, NULL, NULL);

    UInt32 audioCategory = kAudioSessionCategory_PlayAndRecord;
    result = AudioSessionSetProperty(kAudioSessionProperty_AudioCategory, sizeof(audioCategory), &audioCategory);

    // Set preferred buffer size
    Float32 preferredBufferSize = static_cast<float>(m_pBoard->m_uBufferSize) / m_pBoard->m_fSampleRate;
    result = AudioSessionSetProperty(kAudioSessionProperty_PreferredHardwareIOBufferDuration, sizeof(preferredBufferSize), &preferredBufferSize);

    // Get actual buffer size
    Float32 audioBufferSize;
    UInt32 size = sizeof (audioBufferSize);
    result = AudioSessionGetProperty(kAudioSessionProperty_CurrentHardwareIOBufferDuration, &size, &audioBufferSize);

    result = AudioSessionSetActive(true);

    //! Create our Remote I/O component description
    AudioComponentDescription desc;
    desc.componentType= kAudioUnitType_Output;
    desc.componentSubType= kAudioUnitSubType_RemoteIO;
    desc.componentFlags= 0;
    desc.componentFlagsMask= 0;
    desc.componentManufacturer= kAudioUnitManufacturer_Apple;

    //! Find the corresponding component
    AudioComponent outputComponent = AudioComponentFindNext(NULL, &desc);

    //! Create the component instance
    result = AudioComponentInstanceNew(outputComponent, &m_audioUnit);

    //! Enable audio output
    UInt32 flag = 1;
    result = AudioUnitSetProperty( m_audioUnit, kAudioOutputUnitProperty_EnableIO, kAudioUnitScope_Output, kOutputBus, &flag, sizeof(flag));

    //! Enable audio input
    result= AudioUnitSetProperty( m_audioUnit, kAudioOutputUnitProperty_EnableIO, kAudioUnitScope_Input, kInputBus, &flag, sizeof(flag));

    //! Create our audio stream description
    m_audioFormat.mSampleRate= m_pBoard->m_fSampleRate;
    m_audioFormat.mFormatID= kAudioFormatLinearPCM;
    m_audioFormat.mFormatFlags= kAudioFormatFlagIsSignedInteger | kAudioFormatFlagIsPacked;
    m_audioFormat.mFramesPerPacket= 1;
    m_audioFormat.mChannelsPerFrame= 1;
    m_audioFormat.mBitsPerChannel= 16;
    m_audioFormat.mBytesPerPacket= 2;
    m_audioFormat.mBytesPerFrame= 2;

    //! Set the stream format
    result = AudioUnitSetProperty( m_audioUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Input, kOutputBus, &m_audioFormat, sizeof(m_audioFormat));

    result = AudioUnitSetProperty(m_audioUnit, kAudioUnitProperty_StreamFormat, 
                               kAudioUnitScope_Output, 
                               kInputBus, &m_audioFormat, sizeof(m_audioFormat));

    //! Set the render callback
    AURenderCallbackStruct renderCallbackStruct= {0};
    renderCallbackStruct.inputProc= renderCallback;
    renderCallbackStruct.inputProcRefCon= m_pBoard;
    result = AudioUnitSetProperty(m_audioUnit, kAudioUnitProperty_SetRenderCallback, kAudioUnitScope_Global, kOutputBus, &renderCallbackStruct, sizeof(renderCallbackStruct));

    //! Set the input callback
    AURenderCallbackStruct inputCallbackStruct = {0};
    inputCallbackStruct.inputProc= inputCallback;
    inputCallbackStruct.inputProcRefCon= self;
    result= AudioUnitSetProperty( m_audioUnit, kAudioOutputUnitProperty_SetInputCallback, kAudioUnitScope_Input, kOutputBus, &inputCallbackStruct, sizeof( inputCallbackStruct ) );

    //! Initialize the unit
    result = AudioUnitInitialize( m_audioUnit );

    return self;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T11:24:10.427

您将 m_inBufferList 分配为：

```
m_inBufferList = (AudioBufferList *)malloc(sizeof(AudioBuffer)); 
```

这应该是：

```
m_inBufferList = (AudioBufferList *)malloc(sizeof(AudioBufferList) + sizeof(AudioBuffer) * numberOfBuffers);   //numberOfBuffers in your case is 1 
```

也许这可以解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-01T11:45:02.147

开发文档中的错误-50表示参数错误，请确保您在AudioUnitRender中传递了正确的参数。检查流格式和您的单元

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-30T23:20:43.773

我同意 Kurt Pattyn 的说法，即分配`m_inBufferList`不正确，并且可能是 -50 bad param 错误的原因。

除了我认为对于单个缓冲区它应该是

```
(AudioBufferList *)malloc(sizeof(AudioBufferList) 
```

我的证据是以下尺寸和来自 Adamson & Avila 的代码。

(lldb) sizeof(AudioBufferList) 24

(lldb) po sizeof(AudioBuffer) 16

(lldb) po offsetof(AudioBufferList, mBuffers[0]) 8

根据 Chris Adamson 和 Kevin Avila 在[Learning Core Audio](https://rads.stackoverflow.com/amzn/click/com/B007R3U9W2)中的说法：

```
 // Allocate an AudioBufferList plus enough space for 
    // array of AudioBuffers
    UInt32 propsize = offsetof(AudioBufferList, mBuffers[0]) + 
        (sizeof(AudioBuffer) * player->streamFormat.mChannelsPerFrame);

    // malloc buffer lists
    player->inputBuffer = (AudioBufferList *)malloc(propsize); 
    player->inputBuffer->mNumberBuffers = player->streamFormat.mChannelsPerFrame;

    // Pre-malloc buffers for AudioBufferLists
    for(UInt32 i =0; i< player->inputBuffer->mNumberBuffers ; i++) {
        player->inputBuffer->mBuffers[i].mNumberChannels = 1;
        player->inputBuffer->mBuffers[i].mDataByteSize = bufferSizeBytes; 
        player->inputBuffer->mBuffers[i].mData = malloc(bufferSizeBytes);
    } 
```

最后但并非最不重要的一点是，我刚刚偶然发现了这段代码，并附有以下评论：）

```
//credit to TheAmazingAudioEngine for an illustration of proper audiobufferlist allocation. 
// Google leads to some really really bad allocation code...
[other code]
sampleABL = malloc(sizeof(AudioBufferList) + (bufferCnt-1)*sizeof(AudioBuffer)); 
```

[https://github.com/zakk4223/CocoaSplit/blob/master/CocoaSplit/CAMultiAudio/CAMultiAudioPCMPlayer.m#L203](https://github.com/zakk4223/CocoaSplit/blob/master/CocoaSplit/CAMultiAudio/CAMultiAudioPCMPlayer.m#L203)

# php - 递归函数 - 树视图 - ... （卡住）

> ID：10288543
> 
> 赞同：1
> 
> 时间：2012-04-23T21:23:53.513
> 
> 标签：php, list, recursion, html-lists

看来我被我的递归函数困住了。我在关闭未命名列表 ( `</ul>`) 和列表项 ( `</li>`)时遇到问题

*我得到的是*

```
 -aaa
 -bbb
     -b11
     -b22
     -b33
 -ccc
     -c11
     -c22
     -c33
 -ddd
     -d11
     -d22
     -d33
 -eee
 -fff 
```

*我想要的是：*

```
 -aaa
 -bbb
     -b11
     -b22
         -b2a
         -b2c
         -b2b
     -b33
 -ccc
     -c11
     -c22
     -c33
         -c2a
         -c2c
             -c2c1
             -c2c2
         -c2b
 -ddd
     -d11
     -d22
     -d33
 -eee
 -fff 
```

***这是我正在使用的代码***

```
$html .= '<ul>';   
$i = 0;     
foreach ($result as $item) 
{
    $html .= "<li>$item->id";

    $html .= getSubjects($item->id, NULL, "",$i);    <--- start

    $html .= "</li>";   
 }   
 $html .= '</ul>'; 
```

**和功能**

```
function getSubjects($chapter_id = NULL, $subject_id = NULL, $string = '', $i = 0 ) {
    $i++;
    // getting the information out of the database
    // Depending of his parent was a chapter or a subject
    $query = db_select('course_subject', 'su');
    //JOIN node with users
    $query->join('course_general_info', 'g', 'su.general_info_id = g.id');
    // If his parent was a chapter - get all the values where chapter id = ...
    if ($chapter_id != NULL) {
        $query
            ->fields('g', array('short_title', 'general_id'))
            ->fields('su', array('id'))
            ->condition('su.chapter_id', $chapter_id, '=');
        $result = $query->execute();
    }
    // if the parent is a subject - 
    // get value all the values where subject id = ...
    else {
        $query
        ->fields('g', array('short_title', 'general_id'))
        ->fields('su', array('id'))
        ->condition('su.subject_id', $subject_id, '=');
        $result = $query->execute();
    }
    // Because count doesn't work (drupal)
    $int = 0;
    foreach ($result as $t) {
        $int++;
    }
    //  if there no values in result - than return the string
    if ($int == 0) {
        return $string;
    }
    else {
        // Creating a new <ul>
        $string .= "<ul>";
        foreach ($result as $item) {
            // change the id's
            $subject_id = $item->id;
            $chapter_id = NULL;
            // and set the string --> with the function to his own function
            $string .= "<li>$item->short_title - id - $item->id ";
            getSubjects(NULL, $subject_id, $string, $i);
            $string .="</li>";
        }
        $string .= "</ul>";
    }
    // I thougt that this return wasn't necessary
    return $string;
} 
```

有人对这种事情有更多的经验吗？欢迎所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:23:29.753

我不确定您要做什么，但这里有一些您可以测试的代码，看看它是否有助于解决您的问题：

### 这部分只是为了测试，它制作了一个三维数组进行测试：

```
for ($x = 0; $x < 2; $x++) {
    $result["c$x"] = "ROOT-{$x}";
    for ($y = 0; $y < 3; $y++) {
        $result[$x]["c$y"] = "SECOND-{$x}-{$y}";
        $rnd_count1 = rand(0,3);
        for ($z = 0; $z < $rnd_count1; $z++) {
            $result[$x][$y]["c$z"] = "RND-{$x}-{$y}-{$z}";
            $rnd_count2 = rand(0,4);
            for ($c = 0; $c < $rnd_count2; $c++) {
                $result[$x][$y][$z][$c] = "LAST-{$x}-{$y}-{$z}-{$c}";
            }
        }
    }
}
// $result is now four dimensional array with some values
// Last two levels gets random count starting from 0 items. 
```

### 更新：

添加了一些随机性和第四级来测试数组。

## 这是将数组排序为无序列表的函数：

```
function recursive(array $array, $list_open = false){
    foreach ($array as $item) {
        if (is_array($item)) {
            $html .= "<ul>\n";
            $html .= recursive($item, true);
            $html .= "</ul>\n";
            $list_open = false;
        } else {
            if (!$list_open) {
                $html .= "<ul>\n";
                $list_open = true;
            }
            $html .= "\t<li>$item</li>\n";
        }
    }
    if ($list_open) $html .= "</ul>\n";
    return $html;
}

// Then test run, output results to page:
echo recursive($result); 
```

### 更新：

现在它应该`<ul>`正确地打开和关闭标签。

# python - 如何在 Python 中获取 va_list 的内容？

> ID：10288544
> 
> 赞同：2
> 
> 时间：2012-04-23T21:24:00.103
> 
> 标签：python, list, variables, arguments, variadic-functions

（我在 Windows 上。）

我在 Python 中有一个从 DLL 调用的回调函数（我使用[ctypes](http://docs.python.org/library/ctypes.html)模块）。一个参数的类型为[`va_list`](http://www.cplusplus.com/reference/clibrary/cstdarg/va_list/)。有没有办法得到这个的内容？我不知道如何读取正确的内存位置（[这里](http://www.x86-64.org/documentation/abi.pdf)有描述）。

最好的是，如果有`va_list`Python 的解析器。或者一个 DLL，其中包含用于获取`va_list`.

有谁知道解决方案？

## 我找到了一个解决方案：

您可以使用 ctypes 调用标准 C 函数，例如接受 va_list 参数的 vsprintf。（格式化打印是我想要做的）。

这是我调用它的代码：

```
bufferString = ctypes.create_string_buffer(4096)
ctypes.cdll.msvcrt.vsprintf(bufferString, fmt.raw, ctypes.cast(ap, ctypes.c_void_p))
print ctypes.cast(bufferString, ctypes.c_char_p) 
```

`fmt.raw`指向格式字符串，`ap`是`va_list`.

# asp.net - 从 IE 中的 Telerik RadTextBox 中删除水平滚动条

> ID：10288546
> 
> 赞同：1
> 
> 时间：2012-04-23T21:24:08.840
> 
> 标签：asp.net, css, telerik

有没有办法（最好没有 javascript）来防止 TextBox 控件溢出并显示水平滚动条（我只想要垂直滚动）？我试过 Wrap="true" 和许多其他的东西

```
<telerik:RadTextBox ID="tx_Subj" Runat="server" TextMode="MultiLine"  
    CssClass="SubjTextBox" width="100%" style="position:relative;"  Skin="Metro">
</telerik:RadTextBox>

.SubjTextBox 
{ 
    height:63px; 
    width: 100% !important; 
    padding: 0px 0px 0px 0px; 
    overflow:hidden; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:30:04.190

你试过`overflow-x`和`overflow-y`设置吗？

```
.SubjTextBox  {
      height:63px;
      width: 100% !important;
      padding: 0px 0px 0px 0px;
      overflow-x: hidden;  
} 
```

此外，请确保您的 CSS 实际应用于对象。有时 Rad 控件生成的标记比您想象的要多。

# windows-7 - 将时间戳添加到重定向到文本文件的命令输出

> ID：10288547
> 
> 赞同：0
> 
> 时间：2012-04-23T21:24:20.050
> 
> 标签：windows-7, command-line, adb

我正在将 adb logcat 命令输出写入文本文件：

```
adb [-s device_id] logcat > logfile.txt 
```

不幸的是，在这种情况下，日志没有时间戳。有没有办法在重定向命令输出的每一行的开头插入时间戳（或任何文本）？

**更新**：我发现只需使用`logcat -v threadtime`（[示例](http://www.herongyang.com/Android/Debug-adb-logcat-Command-Log-Format-Control.html)）就足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:38:23.317

我假设您实际上是在某个版本的 Windows 上，而不是真正使用 MS-DOS。

如果是这样，那么一点 VBScript 应该可以工作。

时间戳日志.vbs：

```
Dim str
Do While Not WScript.StdIn.AtEndOfStream
  str = WScript.StdIn.ReadLine
  WScript.StdOut.WriteLine now & " - " & str
Loop 
```

用法：

```
adb [-s device_id] logcat | cscript //nologo timestampLog.vbs >logfile.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T20:33:36.060

决定在这里留下我自己的答案，因为我不再使用上述建议。更简单的方法是使用`logcat -v threadtime`，它确保日志具有我需要的所有时间戳。

[[示例](http://www.herongyang.com/Android/Debug-adb-logcat-Command-Log-Format-Control.html)]

# css - 在没有负载效应的情况下使用自定义字体系列的最佳方法？

> ID：10288548
> 
> 赞同：0
> 
> 时间：2012-04-23T21:24:27.553
> 
> 标签：css, font-face

我添加了自己的自定义字体并使用下面的代码来显示自定义字体系列，但是，似乎存在一个问题，当页面加载时，字体开始作为网络标准字体然后快速更新为我添加的自定义字体。

```
<style type="text/css">
@font-face{
font-family:linto;
src:url(achafsex/Achafexp.eot);
}
@font-face{
font-family:linto;
src:url(achafsex/Achafexp.ttf);
}
div{
font-family:linto;
font-size:100px;
width:500px;
}
</style> 
```

是否有更好的代码来执行此操作，以便自定义字体与页面立即加载并且没有明显的变化效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:46:00.447

尝试。

```
@font-face {
font-family: 'linto';
src: url('linto.eot'); /* IE9 Compat Modes */
src: url('linto.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
     url('linto.woff') format('woff'), /* Modern Browsers */
     url('linto.ttf')  format('truetype'), /* Safari, Android, iOS */
     url('linto.svg#svgFontName') format('svg'); /* Legacy iOS */
} 
```

然后，当您指定它时，请尝试使用：

```
 div {
 font-family: 'linto', Fallback, sans-serif;
 } 
```

我看到的唯一问题是它首先从`body`字体加载，然后再加载你的字体。

尝试使用: `body { font-family: 'linto', Fallback, sans-serif; }`，首先看看这是否解决了您的加载问题，我不同意在一张纸上使用多种样式。

[http://css-tricks.com/snippets/css/using-font-face/](http://css-tricks.com/snippets/css/using-font-face/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:26:49.933

在这样的场景中 - 我通常会使用一个“封面” div，它是@最高 Z-index，然后一旦页面完成加载，我将删除它，显示页面。诀窍是找出一种轮询最终用户以完成组件下载的好方法。祝你好运！

# entity-framework - 实体框架延迟加载和 ICollection

> ID：10288552
> 
> 赞同：2
> 
> 时间：2012-04-23T21:24:35.970
> 
> 标签：entity-framework

假设我有一个名为 Stock 的类，它有一个虚拟的 ICollection 价格，它是一组历史价格。

如果您获取股票并在股票具体化后查询价格，但应用 mystock.Prices.OrderByDescending(px => px.Date).First() 之类的过滤器，EF 在内部加载所有价格，然后应用过滤器使用，因为价格可能是一个很大的集合，我真的很想看到 EF 只加载符合我的 where 标准的价格。基本上在服务器端而不是客户端应用过滤。

是否有可能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:21:46.490

这是可能的，但这种方式只有在你可以假设`Prices`是真的是一个`EntityCollection`而不是其他一些也碰巧实现的类时才有效`ICollection`。我不确定这是否在所有受支持的 EF 场景中都是正确的。要使用的函数是`EntityCollection`'s[`CreateSourceQuery`](http://msdn.microsoft.com/en-us/library/bb896438.aspx)函数。

```
((EntityCollection<Price>)stock.Prices).CreateSourceQuery().OrderByDescending(price => price.Date).First(); 
```

如果这对您不起作用，另一种可能性可能是返回上下文，并从那里查询：

```
(from price in context.Prices
 where price.StockId == stockId
 orderby price.Date descending
 select price).First(); 
```

# python - 查找 tkinter.Text 小部件的当前大小

> ID：10288554
> 
> 赞同：1
> 
> 时间：2012-04-23T21:24:47.660
> 
> 标签：python, python-3.x, tkinter

我正在尝试使用 Text 小部件创建一个 roguelike。

我已经弄清楚了一些事情，即我可以使用宽度和高度选项设置小部件的大小，并且我可以找到所述小部件的像素高度或宽度。但是，我想要做的是让小部件可调整大小（pack(expand="yes", fill="both")），但能够在调整大小时刷新显示的文本。有没有办法在小部件运行时获取字符尺寸，而无需使用 winfo_width() 和基于字符像素尺寸的数学？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:57:26.820

我已经遇到过同样的问题几次jaccarmac，据我所知，没有办法找到字符串的宽度。真正唯一的方法是使用 winfo_ 命令：宽度、高度、几何形状。但是，听起来您只是想确保在更改标签并添加更多文本时显示所有文本。如果是这种情况，您不必担心。这一切都应该由小部件本身来处理。如果您没有看到它们展开以显示您的所有标签，这通常意味着包含该标签的小部件之一未设置为展开（使用 expand=YES 和 .pack 或 columnconfigure(i, weight=1) for 。网格）。

最后的想法；在包参数中确保它是`YES`，而不是`"yes"`。那个大写的 YES 不是字符串，而是 Tkinter 定义的变量名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:10:44.627

没有办法自动获取字符的宽度，但很容易计算，假设您使用的是固定宽度的字体。一种方法是使用`font_measure`字体对象的方法。用于`font_measure`获取“0”的宽度（或任何其他字符；我认为 tk 用户在内部为零，与固定宽度字体无关），然后在计算中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-12T02:34:41.873

这是一个老问题，但在做了一些研究之后，我发现实际上有一种方法可以直接获取高度/宽度信息，而无需数学或使用`Text`小部件的`cget()`方法来处理字体宽度：

```
text_widget = tk.Text()
width_in_char = text_widget.cget('width')
height_in_char = text_wdiget.cget('height') 
```

由于`Text`小部件将其高度和宽度配置存储在字符中，因此只需查询这些参数即可为您提供所需的内容。

# .htaccess - 来自 html5boilerplates .htaccess 的 500 内部服务器错误

> ID：10288557
> 
> 赞同：0
> 
> 时间：2012-04-23T21:24:59.620
> 
> 标签：.htaccess, html5boilerplate

我刚刚将一个 html5boilerplate 项目上传到我的 apache 服务器，但出现 500 内部服务器错误。如果我删除 .htaccess 文件，它就可以工作。我还没有碰过 .htaccess 文件，怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:34:33.587

根据样板的官方项目页面上的文档，您应该根据一些[指南](http://html5boilerplate.com/docs/htaccess/)编辑您的 .htaccess 文件。然后运行`sudo apachectl restart`，你就完成了。

# jquery - 使用 jquery 的包装集向某些 div 添加值

> ID：10288558
> 
> 赞同：-1
> 
> 时间：2012-04-23T21:25:09.277
> 
> 标签：jquery

我对 jquery 很不好，我应该请求原谅:)

我有一个与此类似的 div 元素：

```
<div id="MyDiv"><span id="Title"></span><div id="Text"></div></div> 
```

我用正确的选择器找到它：

```
var myDiv = $("#MyDiv") 
```

现在我有了这个包装集，我想找到“标题”跨度和“文本”div，在每个中放置一些文本，而不修改页面中的“MyDiv”div，这样我就可以执行以下操作：

```
CallMyFunction(myDiv); 
```

我怎么做？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:28:36.540

由于您使用的是 ID，因此您可以直接访问它们：

```
$("#Title").text("My title text");
$("#Text").text("My text"); 
```

并获取 html：

```
var myHTML = $("#MyDiv").html(); 
```

如果您有多个 ID 为`Title`or的元素`Text`，则您的**HTML 无效**。

如果是这样，您需要将它们更改为类，那么您将使用`.find()`：

```
$("#MyDiv").find(".Title").text("My title text");
$("#MyDiv").find(".Text").text("My text"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:29:22.463

要将一些文本添加到 span `#Title`，

```
 $('#Title').text('Some Text'); 
 //Use .html inplace of .text incase if you are adding html content 
```

同样在 div 内部`#Text`，

```
 $('#Text').text('Some More Text'); 
 //Use .html inplace of .text incase if you are adding html content 
```

现在发送整个内容使用`.html()`功能，如下所示，

```
var myDivContent = $("#MyDiv").html(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:58:52.490

好的，听起来你想要做的是，在你的函数调用中，将你想要的 div 的克隆分配给一个变量，编辑它，然后获取它的 html 并用它调用另一个函数，比如

```
function dosomething(myDiv){
    var texttodosomethingwith = getmodifiedhtml(myDiv);
    //do something with texttodosomethingwith
}

function getmodifiedhtml(element){
    var cloneddiv = element.clone();
    var innerspan = cloneddiv.children('span')[0];
    $(innerspan).text(sometext);
    var innerdiv = cloneddiv.children('div')[0];
    $(innerdiv).text(someothertext);
    return cloneddiv.html();
} 
```

这听起来像你想要的吗？克隆将复制 div 而不将其附加到页面，因此您在保持页面完整的同时获得相同的结构和 id。

请注意，您需要使用元素的 jquery 选择来调用 dosomething，例如 dosomething($("#mydiv"));

# objective-c - 如何动态地将字段添加到类似于 iCal 新任务弹出窗口的 NSView？

> ID：10288562
> 
> 赞同：0
> 
> 时间：2012-04-23T21:25:15.703
> 
> 标签：objective-c, macos, cocoa, xcode4, osx-lion

我正在尝试实现一个 NSView，它将承载一个“选择文件”附件按钮。如果用户选择添加一个文件，用户将可以选择添加另一个文件（并且从“新的下拉列表”中，用户基本上可以选择他们要附加的文件类型）。

与此功能最匹配的是 iCal 的新任务编辑器，您可以在其中选择一个警报，然后您可以选择在下方添加另一个警报。

这样做的正确方法是什么（我是 Mac OS X 开发的新手）？我最初以为我会创建一个包含所有“文件选项”的自定义 NSView，然后如果用户要附加一个文件，我会在它的正下方动态添加另一个 NSView（在 NSScrollView 中）。然而，如此多的应用程序做了类似的事情，我几乎觉得在我应该使用的控件集中还有其他东西。

请问有人可以指导我正确的方向吗？'NSForm' 或 NSPredicateEditor 是否用于这类东西？这就是我的意思：

![在此处输入图像描述](../Images/c7f8a4f5b029aabd8e6a588192cdb3b0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T03:38:00.697

NSForm 和 NSPredicateEditor 对于您想要做的事情都没有用。我认为您对如何通过在原始视图下方添加自定义视图来执行此操作的想法是正确的方法。您不必在滚动视图中执行此操作，您可以像 iCal 那样扩展窗口的大小。

# session - 在 Express.js 中使用 Session MemoryStore 没有定义 req.session

> ID：10288564
> 
> 赞同：6
> 
> 时间：2012-04-23T21:25:19.153
> 
> 标签：session, node.js, express

我已经使用 Express.js 设置了一个 Node.js 测试服务器，如下所示：

```
var express     = require('express');
var MemoryStore = express.session.MemoryStore;
var app         = express.createServer();

app.configure(function() {
    app.use(express.bodyParser());
    app.use(express.cookieParser());
    app.use(app.router);
    app.use(express.session({
        store: new MemoryStore(),
        secret: 'secret',
        key: 'bla'
    }));
});

app.get('/', function(req, res){
    console.log(req.session);
    res.end("html");
});

app.listen(3000); 
```

为什么`console.log(req.session)`打印出未定义？我没有正确使用它吗？为了将变量保存到用户的会话中，我需要做什么？

客户端收到一个存储为他的 cookie 的 SID，但我无法将任何属性分配给`req.session`，因为它没有定义。感谢您提供解决此问题的任何提示！:-)

这是我正在使用的版本：

```
├─┬ express@2.5.9
│ ├─┬ connect@1.8.7
│ │ └── formidable@1.0.9
│ ├── mime@1.2.4
│ ├── mkdirp@0.3.0
│ └── qs@0.4.2 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-23T22:16:52.463

这是您的问题：`app.use(app.router)`将您的路由安装在调用链中的那个位置。*你在会话中间件之前*有它，所以还没有`req.session`。当您忽略它时，您的路线将在您第一次`app.get`（或`app.post`依此类推）时定位。如果您仍然希望控制路由的位置，您可以移动`app.use(app.router)`到会话中间件下方。

请参阅 Express 的[配置](http://expressjs.com/guide.html#configuration)和[中间件](http://expressjs.com/guide.html#middleware)文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T21:50:17.710

我不知道是什么`app.router`，但它似乎是问题的原因。删除那条线使它对我有用。

# php - filter_var 在不同的服务器上表现不同

> ID：10288566
> 
> 赞同：1
> 
> 时间：2012-04-23T21:25:22.923
> 
> 标签：php, filtering

我认为 filter_var 在我的不同服务器上的工作方式不同，这是我正在运行的代码：

```
$url = "http://www.my-domain.com";
$urlOriginal  = "http://www.my-domain.com";
$url = filter_var($url, FILTER_VALIDATE_URL, FILTER_FLAG_SCHEME_REQUIRED | FILTER_FLAG_HOST_REQUIRED);
echo $url;
echo "<br/>Php version: " .  phpversion();

echo "<br/><h1>";
if ($url == $urlOriginal){
    echo "it worked because $url == $urlOriginal";
} else {
    echo "it didn't work, because $url != $urlOriginal";
}
echo "</h1>"; 
```

一台服务器上的输出是

```
http://www.my-domain.com
Php version: 5.2.13
it worked because http://www.my-domain.com == http://www.my-domain.com 
```

另一方面是

```
Php version: 5.2.13
it didn't work, because != http://www.my-domain.com 
```

由于他们都使用相同版本的 PHP，我认为这可能与配置方式有关，知道那是什么吗？

我还发现这可能是相关的： [https ://bugs.php.net/bug.php?id=51305&edit=1](https://bugs.php.net/bug.php?id=51305&edit=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T20:54:47.347

对于包含连字符的域，PHP 5.2.13 中有一个错误¹。PHP 5.3.2 出现了相同的错误，因为它们同时被破坏/修复。PHP 5.2.14 和 5.3.3 及以后的版本可以正常工作，5.2.12/5.3.1 及以下版本也可以解决这个特定的错误。

至于为什么一台服务器工作而另一台服务器不工作，不同的操作系统提供不同的 PHP 安装，并应用（或不应用）各种补丁，这使得它们通常与从源代码安装 PHP 不同。代码工作的服务器在其 PHP 5.2.13 版本中应用了补丁，而另一台服务器没有。

¹ [https://bugs.php.net/51192](https://bugs.php.net/51192)

# jquery - 使用 JQuery 对带有 HTML 内容的 HTML 列表进行排序

> ID：10288576
> 
> 赞同：2
> 
> 时间：2012-04-23T21:26:01.303
> 
> 标签：jquery

是否可以将下面的列表从较小的数字排序到较大的数字，保持每个 li 的内容？

```
<ul>
    <li>
        39
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="39" value="39" name="array_variacao[]">
    </li>
    <li>
        34
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="34" value="34" name="array_variacao[]">
    </li>
    <li>
        38
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="38" value="38" name="array_variacao[]">
    </li>
    <li>
        35
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="35" value="35" name="array_variacao[]">
    </li>
    <li>
        33
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="33" value="33" name="array_variacao[]">
    </li>
</ul> 
```

我需要它像下面这样自动排序，因为列表将被动态创建。

```
<ul>
    <li>
        33
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="33" value="33" name="array_variacao[]">
    </li>
    <li>
        34
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="34" value="34" name="array_variacao[]">
    </li>
    <li>
        35
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="35" value="35" name="array_variacao[]">
    </li>
    <li>
        38
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="38" value="38" name="array_variacao[]">
    </li>
    <li>
        39
        <img class="botao-remover-tamanho" title="Remover cor" alt="" src="/admin/imagens/botao-excluir-cor.png">
        <input type="hidden" title="39" value="39" name="array_variacao[]">
    </li>
</ul> 
```

谢谢你的帮助！

**编辑：**

通过评论中的@Blender 建议，我在下面的帖子中使用了代码，它对我来说很好用。

[在 jQuery 中订购 <UL>/<OL> 的最简单方法是什么？](https://stackoverflow.com/questions/304396/what-is-the-easiest-way-to-order-a-ul-ol-in-jquery)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:42:09.183

试试下面的代码，

```
$(function() {
    $('button').click(function() {
        var liContents = [];
        $('ul li').each(function() {
            liContents.push($(this).html());
        });
        liContents.sort(liSorter);
        $('ul li').each(function() {
            $(this).html(liContents.pop());
        });
    });
});

/*
  Below function is kind of a workaround for the listed HTMl
  you need to update it if you have proper HTML.
*/
function liSorter(a, b) {
    return (parseInt(b) - parseInt(a));
} 
```

[**演示**](http://jsfiddle.net/skram/9xwSV/6/)

**编辑：**稍微更新了您的标记以获得更好的代码，

1.  `span`用标签包裹这些数字`<span class="num">39</span>`
2.  更新了排序功能如下，

**代码：**

```
function numOrdDesc(a, b) {
    var aTxt = parseInt($(a).find('.num').text(), 10);
    var bTxt = parseInt($(b).find('.num').text(), 10);
    return (bTxt - aTxt);
} 
```

[**演示**](http://jsfiddle.net/skram/9xwSV/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-13T16:24:41.853

你的功能应该是这样的。

```
function numOrdDesc(a, b) {
    var aTxt = parseInt($(a)[0].innerText, 10);
    var bTxt = parseInt($(b)[0].innerText, 10);
    return (bTxt - aTxt);
} 
```

[演示](http://jsfiddle.net/9xwSV/486/)

# kinect - 是否有让 kinect 传感器识别滑动的简单方法

> ID：10288578
> 
> 赞同：1
> 
> 时间：2012-04-23T21:26:27.010
> 
> 标签：kinect, gestures

我不是最好的程序员，我正在尝试调整第[9 频道](http://channel9.msdn.com/Series/KinectQuickstart/Skeletal-Tracking-Fundamentals)提供的骨骼跟踪项目，但我不知道该怎么做。我也看过 kinect 工具箱，但它似乎过于复杂。我正在尝试创建一个允许用户向左滑动的应用程序，并在检测到它时使用定义的键绑定，例如 ctrl+b。

任何人都可以提供帮助或有任何建议吗？

亲切的问候，

艾斯林

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T06:49:46.893

你可以创建一个简单的算法。

滑动是从 A 点到 B 点的移动。您只需要知道手何时位于 A 点。如果在那里，则开始跟踪移动历史并与 samo 模式进行比较。例如，模式可以是从 A 到 B 的水平移动，其中手不应该只向上或向下移动到一边。因此，请检查每一帧中是否直接向侧面移动。如果它上升或下降很多，你取消移动并且什么都不做。

与模式相比是简单的数学。您只需检查位置 X 和 Y：X 表示向侧面移动，Y 表示向上和向下移动。

希望能帮助到你 ：）

# javascript - 当我尝试将点击事件添加到跨度时出现 Javascript 错误

> ID：10288584
> 
> 赞同：-1
> 
> 时间：2012-04-23T21:27:25.040
> 
> 标签：javascript, jquery, html

有谁知道我在这里做错了什么？

```
var spanclickhandler = $('.officeapprovalspan').click(function () {
    // do some stuff
}); 
```

基本上，我有这个`spanclickhandler`。加载页面时具有类的任何内容`officeapprovalspan`都将其分配给其单击事件。那里没有问题。

在另一个地方我有代码：

```
$(this).replaceWith('<span class="officeapprovalspan">wero<span>');
$(document).on('click', '.officeapprovalspan', spanclickhandler); 
```

所以我用这个类的新跨度替换了一些 HTML。我使用 on 将 click 事件添加到 class 的 span 中`officeapprovalspan`。我收集我必须这样做，因为新跨度不会附加点击处理程序。

没关系，但是当我单击新跨度时，出现此错误：

![在此处输入图像描述](../Images/c8658b0327db2d73b2c25eaf67fe6a3b.png)

任何人都知道我做错了什么以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:33:22.250

你想做的是：

```
var spanclickhandler = function () {
        ...

        do some stuff

        ...
};

$(this).replaceWith('<span class="officeapprovalspan">wero<span>');
$('.officeapprovalspan').on('click', spanclickhandler); 
```

**或更好**

```
$(document).on('click', '.officeapprovalspan' function () {
        ...

        do some stuff

        ...
});
// Because 'on' will attach event on DOM element even if they are not created yet, if you define a selector descendant inside. You can replace `document` by the nearest top parent of all your `.officeapprovalspan` and it will improve performance. `document` is not really optimal here
$(this).replaceWith('<span class="officeapprovalspan">wero<span>'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:30:45.823

该`click`方法不返回事件处理程序，而是返回 jQuery 对象。先定义事件处理器，在click方法中使用：

```
var spanclickhandler = function () {
    ...

    do some stuff

    ...
};

$('.officeapprovalspan').click(spanclickhandler); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:30:53.703

这段代码没有做你认为它做的事情（我很确定没有返回处理函数）：

```
var spanclickhandler = $('.officeapprovalspan').click(function () {
    ...

    do some stuff

    ...
}); 
```

我建议你这样编码，它应该可以工作：

```
var spanclickhandler = function () {
    ...

    do some stuff

    ...
}

$('.officeapprovalspan').click(spanclickhandler); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T21:35:40.557

你能不能这样做：

```
$(this).replaceWith('<span class="officeapprovalspan">wero<span>').click(spanclickhandler); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T21:31:26.223

`spanclickhandler``$('.officeapprovalspan')`在这种情况下，返回一个 jQuery 对象。您需要创建一个单独的函数或使用事件名称。

# php - codeigniter 电子邮件怪异

> ID：10288590
> 
> 赞同：0
> 
> 时间：2012-04-23T21:27:42.160
> 
> 标签：php, email, codeigniter

我正在尝试通过 2 种不同方式通过 codeigniter 框架发送电子邮件，其中一种方式我的电子邮件进入垃圾文件夹，但它真的很奇怪......

所以我的第一次尝试是创建一个控制器并在索引函数中放入以下代码：

```
 $this->load->library('email');
    $this->email->from('no-reply@domain.example.com', 'Your Name');
    $this->email->to('email@example.com');
    $this->email->subject('Email Test');
    $this->email->message('Testing the email class.');
    $this->email->send();
    echo $this->email->print_debugger(); 
```

这样电子邮件就可以正常到达，而不是垃圾邮件...

当我创建一个模型以便以后可以将其用于其他功能以发送电子邮件时，我将上面的代码替换为以下代码：

```
 $this->load->library('email');
    $this->load->model("email_model");
    $this->email_model->sendEmail(null, 'email@gmail.com', 'title', 'message'); 
```

并且 email_model 模型包含以下代码：

```
<?php
class email_model extends CI_Model {

    function __construct()
    {
        // Call the Model constructor
        parent::__construct();
    }

   public function sendEmail($from = null, $to = null, $subject = null, $message = null){
        $this->email->from('no-reply@domain.com', 'from user');
        $this->email->to($to);
        $this->email->subject($subject);
        $this->email->message($message);
        $this->email->send();
   }
} 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T01:19:36.493

检查您的 spf 记录和 RDNS 记录

## 防晒指数

这里有一篇文章@mediatemple kb：[http ://kb.mediatemple.net/questions/658/How+can+I+create+an+SPF+record+for+my+domain%3F#gs](http://kb.mediatemple.net/questions/658/How+can+I+create+an+SPF+record+for+my+domain%3F#gs)

## RDNS

这是一篇关于 RDNS 的文章： [http ://www.crucialp.com/resources/tutorials/web-hosting/how-reverse-dns-works-rdns.php](http://www.crucialp.com/resources/tutorials/web-hosting/how-reverse-dns-works-rdns.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T05:16:29.153

似乎内容是第二次尝试的原因......添加更多文字解决了这个问题......

# ruby-on-rails - Rails 3项目中嵌套路由导致的路由错误

> ID：10288593
> 
> 赞同：1
> 
> 时间：2012-04-23T21:27:49.257
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing

**这是我的问题：**

*   我有一个网络应用程序，用户可以在其中创建帖子。

*   用户和帖子是同时创建的——我从帖子中提取用户的电子邮件以创建他的用户条目。（无需密码/登录/注册等）

*   在我的 routes.rb 文件中，我有与用户嵌套的帖子（见附件）

**现在，这是我的问题：**

`posts#new`创作形式应该在哪里？目前我在 /posts/new 有它，但这显然是错误的，我遇到了路由错误。

感谢任何反馈。

**路线.rb**

```
Mysalary::Application.routes.draw do

resources :users do
   resources :posts
   end

resources :profiles
resources :pages

get "pages/home"
get "pages/about"
get "pages/legal"
get "pages/feedback"

root :to => 'posts#new'

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:38:40.923

你`posts`只有一个嵌套资源，所以你会在`/users/:user_id/posts/new`

如果你想到达它`/posts/new`，只需 un-nest `resources :posts`。你也可以让它嵌套并在嵌套之外重复它，那么它就可以双向访问。

记得`rake routes`在控制台中运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:41:55.290

我会自己添加帖子，所以要有两个你会拥有：

路线.rb

```
resources :users do
  resources :posts
end

resources :posts 
```

# ruby-on-rails - 如何将现有源代码推送到 github 中的存储库？

> ID：10288595
> 
> 赞同：4
> 
> 时间：2012-04-23T21:28:18.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3, git, heroku, github

我有一个托管在heroku上的rails应用程序，我想将代码推送到github（已经在那里创建了一个repo）。我尝试按照这个[问题](https://stackoverflow.com/questions/4658606/import-existing-source-code-to-github)中的步骤进行操作。因为我已经有一个本地存储库并且目前可以推送和拉取heroku 我跳过了第 2 步和第 3 步。但是当我执行第 4 步时

```
git remote add origin git@github.com:sparkz19/stark-journey-1727.git 
```

它说

```
fatal: remote origin already exists. 
```

当我这样做的时候`git remote -v` 它说

```
 origin  git@heroku.com:stark-journey-1727.git (fetch)

    origin  git@heroku.com:stark-journey-1727.git (push) 
```

我需要在这里做什么？提前谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:31:51.723

只需给您的新遥控器起一个不同的名称`origin`，就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T21:40:29.517

Git 抱怨，因为 origin 已经定义。如果您仍想保留 heroku 远程，您可以使用 git remote rename 将其保存为另一个远程：

```
git remote rename origin heroku 
```

使用 git remote set-url 重置 url：

```
git remote set-url origin git@github.com:sparkz19/stark-journey-1727.git 
```

现在您可以推拉到任何您喜欢的位置：

```
git pull heroku master
git push origin master 
```

# php - html块内的PHP错误

> ID：10288608
> 
> 赞同：-1
> 
> 时间：2012-04-23T21:29:22.743
> 
> 标签：php

这有两个问题包含在 1 中。

1）如果我的 php 脚本有一个错误`<div style="<?php echo $1; ?>"`，我怎样才能让 php 错误处理程序关闭这个引用？我已经自定义了错误处理程序，但不幸的是，所有内容都出现在`<div style="...`

2) 我在注册关闭函数中有一个 php 致命错误处理程序，是否可以从页面中清除缓冲区的其余部分（即仅显示错误消息）？

谢谢，

以利亚

更新：

这些答案都与我的问题无关，所以显然我一直不清楚。

以以下代码示例为例（每行一个）

```
<div><?php count('abc'); ?>
<div style="<?php echo count('abc'); 
```

在第一种情况下，错误消息将正常打印。在第二种情况下，错误消息将开始出现在 div 中。如果错误消息 html 中有一个“（来自自定义处理程序），那么标签将在这样的地方关闭（但它会在新的”关闭时再次打开）：

```
<div style="<div style="asasdf">errortext</div> 
```

有没有办法强制浏览器关闭这些在正常情况下也可以工作的标签？我不认为有，但有时在这种情况下有些事情是可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:33:57.250

重要的经验法则：**不要将应用程序逻辑与表示层混合。**

因此：首先进行错误检查，然后渲染页面输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:34:04.910

如果我了解您想要什么，请处理块之前的值，例如：

```
if($1 == 'Somevalue')
$myStyle = 'font-size:18px'; else
$myStyle = 'anotherStyle'; 
```

然后在你的块中使用`$myStyle`

`<div style="$myStyle"></div>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T21:56:58.463

这里的问题可能只是您的变量名称以“1”（数字字符）开头。`$1`不是合法的变量名。

尝试使用类似`$var1`.

# c# - 如何正确覆盖平等？

> ID：10288613
> 
> 赞同：7
> 
> 时间：2012-04-23T21:29:44.543
> 
> 标签：c#, binary, overloading, operator-keyword

我对重载运算符仍然很陌生。在遇到这个问题之前，我认为我做得很好。在 != 运算符上引发 NullReferenceException。我假设它在 CompareTo 方法中使用它，但我不完全确定。如果有人能指出我正确的方向，我将不胜感激。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication2
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            List<Task> tasks = new List<Task>();
            tasks.Add(new Task( "first",  DateTime.Now.AddHours(2)));
            tasks.Add(new Task( "second", DateTime.Now.AddHours(4)));
            tasks.TrimExcess();
            tasks.Sort();
        }
    }
    public class Task : IComparable
    {
        public Task()
        {
        }
        public Task(string nameIn, DateTime dueIn)
        {
            nameOfTask = nameIn;
            dateDue = dueIn;
        }
        DateTime dateDue;
        string nameOfTask;

        public static bool operator <(Task t1, Task t2)
        {
            return (t1.dateDue < t2.dateDue);
        }
        public static bool operator >(Task t1, Task t2)
        {
            return (t1.dateDue > t2.dateDue);
        }
        public static bool operator ==(Task t1, Task t2)
        {
            return (t1.dateDue == t2.dateDue);
        }
        public static bool operator !=(Task t1, Task t2)
        {
                return (t1.dateDue != t2.dateDue);

        }
        public override int GetHashCode()
        {
            return Int32.Parse(this.dateDue.ToString("yyyymmddhhmmss"));
        }
        public override bool Equals(System.Object obj)
        {
            if (obj == null) return false;    

            Task t = obj as Task;
            if ((System.Object)t == null) return false;
            return (this.dateDue == t.dateDue);
        }
        int IComparable.CompareTo(object obj)
        {
            if (obj == null) return 1;

            Task t = obj as Task;
            if (t != null)
            {
                return this.dateDue.CompareTo(t.dateDue);
            }
            else
                throw new ArgumentException("Object is not a Task");
        }
    }
} 
```

当我注释掉二元运算符时，程序按预期运行。我的问题是如何保护我的二元运算符免受空引用的影响，以便我可以保留它们以进行手动比较？感谢您的时间。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-23T22:20:45.083

到目前为止给出的两个答案都是错误的。接受的答案是错误的，因为它意外地递归。另一个答案是错误的，因为它说 null 不等于 null。

您对运算符的实现都是错误的；**他们需要正确处理空输入。**

您的 GetHashCode 实现被严重破坏；您试图将一个十四位数字转换成可以接受九位数字的格式。只需在日期调用 GetHashCode；没有必要把它变成一个字符串，然后把它变成一个数字！

编写代码的正确方法是使用`object.ReferenceEquals`进行引用比较，而不是使用`==`and`!=`运算符；意外递归太容易了。

典型的模式是这样的：

```
public static bool operator ==(Task t1, Task t2)         
{
    if (object.ReferenceEquals(t1, t2)) return true;
    // All right. We know that they are (1) not the same object, and
    // (2) not both null. Maybe one of them is null.
    if (object.ReferenceEquals(t1, null)) return false;
    if (object.ReferenceEquals(t2, null)) return false;
    // They are not the same object and both are not null.
    return t1.dateDue == t2.dateDue;
}

public static bool operator !=(Task t1, Task t2)         
{
    // Simply call the == operator and invert it.
    return !(t1 == t2);
}

public override bool Equals(object t)
{
    return (t as Task) == this;   
}

public override int GetHashCode()
{
    return this.dateDue.GetHashCode();
} 
```

其他比较运算符留作练习。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T21:35:05.400

看起来`Task`您要与之比较的对象之一`!=`设置为`null`。内置运算符`!=`比较引用并且不会中断，但您的运算符会尝试取消对任务的引用并中断。

```
public static bool operator !=(Task t1, Task t2) {
    if (ReferenceEquals(t1, null)) {
        return !ReferenceEquals(t2, null); // return true only if t2 is *not* null
    }
    if (ReferenceEquals(t2, null)) {
        return true; // we know that t1 is not null
    }
    return (t1.dateDue != t2.dateDue);
} 
```

`false`当两个任务都是 时，此实现返回`null`。您应该在运算符中实施对称空值检查`==`。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-04-23T21:34:50.470

```
 public static bool operator !=(Task t1, Task t2) 
        { 
              if (null == t1 || null == t2) { return false;}
                return (t1.dateDue != t2.dateDue); 

        } 
```

# ios - 滑动以删除已处于编辑模式的表格

> ID：10288615
> 
> 赞同：2
> 
> 时间：2012-04-23T21:29:52.453
> 
> 标签：ios, cocoa-touch, uitableview

我有一个使用 isEditing = YES 加载的表格视图。这有点小技巧（但我认为这是合理的），因为我希望我的一个单元格始终显示“添加”图标。我不希望其他单元格包含“删除”图标，因此我为这些单元格返回 UITableViewCellEditingStyleNone。

但是，我仍然想在这些单元格上提供滑动删除功能。由于 tableview 已经处于编辑模式，这可能吗？

如果没有，我可能会使用单元格 imageView 实现“添加”图标，但这似乎也很hacky。

编辑：在此处找到类似问题： [已处于编辑模式时滑动以删除](https://stackoverflow.com/questions/1371185/swipe-to-delete-when-already-in-edit-mode)

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-04-24T10:00:19.290

```
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath{

    return YES;
}

- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath{

    if (editingStyle == UITableViewCellEditingStyleDelete) {
       [myArray removeObjectFromindex];
      }
    [mytableview reloadData];
} 
```

# c++ - Open_GL 中的多边形材质

> ID：10288621
> 
> 赞同：1
> 
> 时间：2012-04-23T21:30:35.023
> 
> 标签：c++, opengl, glut

我试图改变多边形的材质但它不起作用，我不知道为什么，

多边形不受 GL_AMBIENT、GL_DIFFUSE、GL_SPECULAR 和 GL_SHININESS 的影响。

```
GLfloat mat_ambient[] = { 1, 0.5, 0, 1.0 };
GLfloat mat_diffuse[] = { 0.4, 0.2, 0, 1.0 };
GLfloat mat_specular[] = { 0.774597, 0.774597, 0.774597, 1.0 };
GLfloat mat_shine = 0.6;

glMaterialfv (GL_FRONT, GL_AMBIENT, mat_ambient);
glMaterialfv (GL_FRONT, GL_DIFFUSE, mat_diffuse);
glMaterialfv (GL_FRONT, GL_SPECULAR, mat_specular);
glMaterialf (GL_FRONT, GL_SHININESS, mat_shine * 128);

glPushMatrix();
glTranslatef(axeX, axeY, 0);
glRotatef(angle, 0, 0, 1);

glBegin(GL_POLYGON);

    glNormal3f(0,0,1);
    glVertex3f (-0.25, 0.5, 1.0);

    glVertex3f (-0.5, 0.25, 1.0);

    glVertex3f (-0.5, -0.25, 1.0);

    glVertex3f (-0.25, -0.5, 1.0);

    glVertex3f (0.25, -0.5, 1.0);

    glVertex3f (0.5, -0.25, 1.0);

    glVertex3f (0.5, 0.25, 1.0);

    glVertex3f (0.25, 0.5, 1.0);

glEnd();
glPopMatrix(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:43:10.513

确保您`glEnable(GL_COLOR_MATERIAL)`和 ananthanonline 建议的那样，确保设置了照明。

编辑：

对不起，你可能需要， `glDisable(GL_COLOR_MATERIAL)`

由于启用它指定了每个顶点的颜色。尽管考虑了一下，但它可能没有任何效果，因为您没有指定顶点颜色。

你能展示一下灯光的设置方式吗？您为镜面反射/漫反射等指定了哪些颜色？

# jquery - 我想使用 jQuery 在一个输入字段中复制文件路径并在第二个字段中显示它

> ID：10288622
> 
> 赞同：0
> 
> 时间：2012-04-23T21:30:35.773
> 
> 标签：jquery

我正在使用类似的东西，但它不适合我。

```
$(document).ready(function () {
    var content = $("#file_field").val();
    $("input.browser_hidden").val( content );
}); 
```

有什么建议么？即使在第二个字段中硬编码一个值也没有显示出来。

这是我正在使用的html：

```
 <div class="file_wrapper"> 
       <input type="file" name="file_field" id="file_field">
       <div class="file_wrapper_inner"> 
          <input class="browser_hidden" value="something in here" type="text" />
          <a class="button_browse" href="#">Browse</a>
       </div> 
    </div> 
```

基本上我要做的是使文件输入隐藏（100％透明），当单击输入时，文件路径镜像在 .browser_hidden 输入字段中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T21:33:15.363

您不能`<input type="file" />`使用 javascript 设置值。出于安全原因。

如果您的第二个字段不是文件输入，则上面的代码仍然无法工作，原因有一个 - 您只执行一次，当文档加载时。在那一刻，文件输入没有价值。您应该将`onchange`侦听器附加到文件输入，然后传输该值。

但我不确定这样做是否是个好主意。文件输入的值可能在浏览器中不一致。例如，在 Firefox 中它包含完整路径，而在 Chrome 中它似乎只包含文件名（没有检查是否是 js 访问的情况）。但无论如何，提交表单时文件名对服务器端可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:45:01.857

好吧，在输入文件上使用更改就可以了（而不是在文档准备好时只调用一次）。

```
$(function(){
    $('#file_field').change(function(){
        var elem = $(this);
        $('.browser_hidden').val('Selected: ' + elem.val() );
    }); 
});​ 
```

[这是一个工作示例](http://jsfiddle.net/8uKvk/3/)。

# asp.net-web-api - 获取 HttpActionExecutedContext 结果值

> ID：10288623
> 
> 赞同：13
> 
> 时间：2012-04-23T21:30:36.003
> 
> 标签：asp.net-web-api, action-filter

我创建了一个过滤器，它继承了 asp.net web api 中的 System.Web.Http.Filters.ActionFilterAttribute，并希望访问 HttpActionExecutedContext 结果对象中的一些数据。

这个对象在什么阶段/什么时候被填充？正如我在重写 OnActionExecuted 方法时所看到的那样，它始终为空？

有任何想法吗？

编辑：

例如在我的自定义过滤器中：

```
public override OnActionExecuted(HttpActionExecutedContext context)
{
    //context.Result.Content is always null

    base.OnActionExecuted(context);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-09-08T07:23:59.803

使用此函数在 web api 中获取请求正文

```
private string GetBodyFromRequest(HttpActionExecutedContext context)
{
    string data;
    using (var stream = context.Request.Content.ReadAsStreamAsync().Result)
    {
        if (stream.CanSeek)
        {
            stream.Position = 0;
        }
        data = context.Request.Content.ReadAsStringAsync().Result;
    }
    return data;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-15T19:59:30.437

最终在内容结果上使用了 ReadAsStringAsync。我试图在实际请求完成之前访问该属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-27T21:59:15.213

虽然授予的答案提到了 ReadAsStringAsync，但答案没有示例。我遵循了 gdp 的建议，并得出了一个可行的示例...

我创建了一个名为 MessageInterceptor 的类。我只是从 ActionFilterAttribute 派生，它立即开始在控制器获取它之前和控制器完成之后拦截 webAPI 方法调用。这是我的最后一节课。此示例使用 XML 序列化器将请求和响应都获取到 XML 字符串中。这个例子发现请求和响应是填充对象，这意味着反序列化已经发生。从填充模型收集数据并序列化为 XML 字符串是请求和响应的表示，而不是 IIS 发回的实际发布请求和响应。

**代码示例 - MessageInterceptor**

```
using System.IO;
using System.Linq;
using System.Web.Http.Controllers;
using System.Web.Http.Filters;
using System.Xml.Serialization;

namespace webapi_test
{
    public class MessageInterceptor : ActionFilterAttribute
    {
        public override void OnActionExecuting(HttpActionContext actionContext)
        {
            base.OnActionExecuting(actionContext);
            var headers = actionContext.Request.Content.Headers.ToString();
            var request = actionContext.ActionArguments.FirstOrDefault().Value;
            var xml = SerializeXMLSerializer(request, "");
        }

        public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)
        {
            base.OnActionExecuted(actionExecutedContext);
            var headers = actionExecutedContext.Response.Content.Headers.ToString();
            var response = actionExecutedContext.Response.Content.ReadAsStringAsync().Result;
            var xml = SerializeXMLSerializer(response, "");
        }

        public static string SerializeXMLSerializer(object o, string nameSpace)
        {
            string serializedValue;
            var writer = new StringWriter();
            XmlSerializer serializer = new XmlSerializer(o.GetType(), nameSpace);
            serializer.Serialize(writer, o);
            serializedValue = writer.ToString();
            return serializedValue;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-18T12:43:37.420

使用下面读取响应字符串：

```
 public static string GetResponseContent(HttpResponseMessage Response)
    {
        string rawResponse = string.Empty;
        try
        {
            using (var stream = new StreamReader(Response.Content.ReadAsStreamAsync().Result))
            {
                stream.BaseStream.Position = 0;
                rawResponse = stream.ReadToEnd();
            }
        }
        catch (Exception ex) { throw; }
        return rawResponse;
    } 
```

# ember.js - Ember.js - CollectionView，给子视图的 div 包装器添加一个属性

> ID：10288626
> 
> 赞同：1
> 
> 时间：2012-04-23T21:30:44.773
> 
> 标签：ember.js

我正在尝试结合两个 ebmer.js 示例：[Integrating with jQuery UI](http://www.lukemelia.com/blog/archives/2012/03/10/using-ember-js-with-jquery-ui/)和[emberjs.com 的 todos 示例](http://emberjs.com/examples/)。我想要一个可排序的待办事项列表。

一切都很顺利，直到我想对可排序对象进行序列化。为此，我需要能够为可排序项目添加一个属性。这是模板：

```
{{#collection Todos.TodosListView}}
    {{#view Todos.TodoView contentBinding="content" checkedBinding="content.isDone"}}
        <label>{{content.title}}</label>
    {{/view}}
{{/collection}} 
```

`Todos.TodosListView`是一个 CollectionView，类似于 jQuery UI 示例中的菜单。`Todos.TodoView`是一个复选框。这会生成以下 html：

```
<div class="ember-view todo-list ui-sortable" id="ember267">
    <div class="ember-view" id="ember284">
        <input type="checkbox" class="ember-view ember-checkbox todo" id="ember297">
            <label>
            <script type="text/x-placeholder" id="metamorph-1-start"></script>
            something to do
            <script type="text/x-placeholder" id="metamorph-1-end"></script>
            </label>
    </div>
</div> 
```

我需要能够做的是编辑`<div>`包装`<input>`. 假设 todo 的 id 是 1，我想添加`serial=todos_1`. 我尝试向父视图添加`didInsertElement`和`TodoView`添加属性，但我无权访问视图的内容（待办事项本身）。

这可能吗？

谢谢你的帮助。

**编辑：**
我找到了一种解决方法 - 将 ID 作为隐藏元素添加到 DOM。更新的模板：

```
{{#collection Todos.TodosListView}}
    {{#view Todos.TodoView contentBinding="content" checkedBinding="content.isDone" serial="content.serial"}}
        <label>{{content.title}}</label>
        <span style="display: none;" class="todo-id">{{content.id}}</span>
    {{/view}}
{{/collection}} 
```

Todos.TodoView.didInsertElement：

```
didInsertElement: function() {
    var $div = this.get('parentView').$();
    var id = $div.children('.todo-id').text();
    $div.attr('serial', 'todos_' + id);
} 
```

生成的html：

```
<div class="ember-view todo-list ui-sortable" id="ember267">
    <div class="ember-view" id="ember284" serial="todos_100">
        <input type="checkbox" class="ember-view ember-checkbox todo" id="ember297">
            <label>
                <script type="text/x-placeholder" id="metamorph-1-start"></script>
                something to do
                <script type="text/x-placeholder" id="metamorph-1-end"></script>
            </label>
            <span class="todo-id" style="display: none;">
                <script type="text/x-placeholder" id="metamorph-2-start"></script>
                100
                <script type="text/x-placeholder" id="metamorph-2-end"></script>
            </span>
    </div>
</div> 
```

我仍然想知道是否有更优雅的方式来实现这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T11:55:38.073

您可以创建一个计算属性`serial`并将此属性添加到您的`attributeBindings`（[此处](http://emberjs.com/#toc_attribute-bindings-on-a-view)记录）中`itemViewClass`，`Todos.TodosListView`请参阅[http://jsfiddle.net/pangratz666/6X4QU/](http://jsfiddle.net/pangratz666/6X4QU/)：

```
Todos.TodosListView = Ember.CollectionView.extend({
    itemViewClass: Ember.View.extend({
        attributeBindings: ['serial'],

        serial: function() {
            return 'todos_' + Ember.getPath(this, 'content.id');
        }.property('content.id').cacheable()
    })
}); 
```

# javascript - 使用 rails 3 资产管道命名第 3 方 js 库

> ID：10288635
> 
> 赞同：0
> 
> 时间：2012-04-23T21:31:40.080
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, asset-pipeline

我正在为 js 使用 Rails3 资产管道。我想将一些第三方库包装在一个 namspace 中，但我无法让它工作。例如，这个

```
var myns= function() {
//= require swfobject
}; 
```

从字面上产生：

```
var myns= function() {
//= require swfobject
}; 
```

也就是说，`require`没有调用。资产管道语法这么脆弱吗？此限制记录在哪里？有解决方法或更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:40:58.343

我第一次看到资产管道的这个用例。无论如何，您应该检查 sprockets 文档[https://github.com/sstephenson/sprockets](https://github.com/sstephenson/sprockets)（指令处理器）

> Sprockets 在每个 CSS 和 JavaScript 源文件上运行指令处理器。**指令处理器在文件顶部的**注释块中扫描以 = 开头的注释行

# apache - Apache：如何在没有符号链接的情况下提供来自不同目录的路径？

> ID：10288637
> 
> 赞同：6
> 
> 时间：2012-04-23T21:32:08.360
> 
> 标签：apache

我在特定子域下的 Apache 中托管了一个项目：

```
<VirtualHost *:80>
    ServerName dev.example.com
    DocumentRoot /web/vhosts/dev.example.com
    <Directory />
        Allow from all
    </Directory>
</VirtualHost> 
```

我想在此域的子目录下为另一个项目提供服务：

```
dev.example.com/special-project 
```

住在哪个`/web/vhosts/special-project`。由于原始项目的结构方式，我也不能简单地创建指向该目录的符号链接。它只能使用 Apache 进行配置。

如何配置 Apache 才能做到这一点？此外，这种类型的配置可以在单独的文件中指定，还是必须是原始`VirtualHost`定义的一部分？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-23T21:43:07.870

使用[别名](http://httpd.apache.org/docs/2.0/mod/mod_alias.html#alias)。

```
Alias /special-project/ /web/vhosts/special-project/ 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-23T21:41:07.677

只需添加另一个虚拟主机，例如：

```
<VirtualHost *:80>
    ServerName special-project.example.com
    DocumentRoot /web/vhosts/special-project
    <Directory />
        Allow from all
    </Directory>
</VirtualHost> 
```

# javascript - Javascript - 如何在 IE9 中启用/禁用文本输入

> ID：10288638
> 
> 赞同：0
> 
> 时间：2012-04-23T21:32:10.303
> 
> 标签：javascript, internet-explorer-9

以下脚本在 IE8 中有效，但在 IE9 中无效：

```
function toggleSelect(fieldName)
{
    var idx = fieldName.lastIndexOf("_");
    var sub = fieldName.substring(19,idx);
    if (document.findForm["cb_Row_PageAutoDelete_" + sub].checked) {
          document.findForm["SHIP_QTY_" + sub].disabled=false ;
    } else {
        document.findForm["SHIP_QTY_" + sub].disabled=true ;
    }
    return true;
} 
```

我可以显示 SHIP_QTY 字段的值，所以我知道它在页面上，但禁用功能不起作用。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:38:41.423

如果`findForm`是表单的名称，您想要`window.findForm`而不是`document.findForm`. 您也可以直接使用其他字段`checked`属性的结果，而不是使用`if/else`. 因此，您的代码更改为：

```
function toggleSelect(fieldName)
{
    var idx = fieldName.lastIndexOf("_");
    var sub = fieldName.substring(19,idx);
    window.findForm["SHIP_QTY_" + sub].disabled = window.findForm["cb_Row_PageAutoDelete_" + sub].checked;
    return true;
} 
```

# android - 加载状态或异步任务

> ID：10288639
> 
> 赞同：0
> 
> 时间：2012-04-23T21:32:15.333
> 
> 标签：android, loading, task

我有一个加载 xml 文件的活动，但是当应用程序在 1 或 2 秒内被调用而没有回复时，我想知道是否可以进行某种加载以不显示应用程序崩溃，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:48:11.200

经验法则是，如果您做**任何事情**，请使用`AsyncTask`，否则您的应用程序最终会因长时间的网络延迟或大文件而崩溃。

```
private class doSomethingTask extends AsyncTask<SomeData,Integer,SomeData[]> {

    private ProgressDialog dialog;

    protected SomeData[] doInBackground(SomeData... values) {
        int count = values.length;
        for( int i=0; i<count; i++) {
            publishProgress(count,i+1);

            // do something here
            ....
            //

            if( isCancelled() ) return null;
        }
        return values;
    }

    protected void onPreExecute()
    {
        // show progress bar or something
        dialog = new ProgressDialog(context);
        dialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        dialog.setMessage(context.getString(R.string.downloading));
        dialog.show();
    }

    protected void onProgressUpdate(Integer... values)  {
        super.onProgressUpdate(values);
        dialog.setMax(values[0]);
        dialog.setProgress(values[1]);
    }

    protected void onPostExecute(SomeData[] result) {
        // kill progress bar here
        if( this.dialog.isShowing()) {
            this.dialog.dismiss();
        }
    }
} 
```

# html - 向查看网站的每个人显示通知

> ID：10288643
> 
> 赞同：0
> 
> 时间：2012-04-23T21:32:45.833
> 
> 标签：html, notifications

我需要学习什么语言才能更新页面并让查看它的每个人都知道？例如，如果我有一个使用 ajax 更新页面的表单，它会自动为该用户更新。我想要的是一个数字或角落里的东西，让其他人在查看页面时知道已经完成了某些事情。我不知道如何做到这一点，并想知道是否有人有这样做的经验。不知道该叫什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:41:37.287

取决于你需要它有多“即时”。如果您想要一个简单的解决方案，您可以每隔一段时间（可能每分钟或更频繁）发送一个 AJAX 请求。

如果您希望它是即时的，您可以使用实时工作的 Comet 或 WebSockets。

# macros - 检查 typedef 别名的值

> ID：10288644
> 
> 赞同：1
> 
> 时间：2012-04-23T21:32:58.067
> 
> 标签：macros, switch-statement, signal-processing, typedef, numeric

我正在尝试编写一些需要在浮点和定点环境中运行的 DSP 代码（数字类型将在编译时确定）。我想使用宏或 typedef 为特定的数字类型起别名。乘法、除法和其他数学函数在实现中会因数字类型而有很大差异，因此我需要某种开关来确定是否包含某些标头，并可能根据数字类型更改实现。

我将举一个简短的代码片段作为示例...

```
typedef samp_t float;
// or #define samp_t float (bad naming practice?)

// An alternative in fixed point
samp_t multiply_samp_t(samp_t a, samp_t b){
   return a*b;
}

/* typedef samp_t int;
#define RADIX 24
samp_t multiply_samp_t(samp_t a, samp_t b){
   return (samp_t) ((long) a)*((long) b) >> RADIX);
}
*/

void main(void){
  samp_t a,b,c;
   a = 15;
   b = 27;
   c = multiply_samp_t(a,b);
} 
```

那么，如何根据 samp_t 的类型在两种不同的乘法函数之间切换呢？欢迎任何建议或建议。谢谢！-布兰特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:48:13.497

下面是一个在编译时选择与数据类型对应的函数的例子：

```
#define SYSTEM_FLOAT 0
#define SYSTEM_INT 1

// main selection
#define TYPE_SYSTEM FLOAT

#if TYPE_SYSTEM == SYSTEM_FLOAT
  #define SAMP_T float
  #define mult_samp_t   mult_samp_t_float
#elif TYPE_SYSTEM == SYSTEM_INT
  #define SAMP_T int
  #define mult_samp_t   mult_samp_t_int
#elif ...
#endif

void main(void){
  SAMP_T a,b,c;
   a = 15;
   b = 27;
   c = mult_samp_t(a,b);
} 
```

您必须在代码中的某处定义：

```
float mult_samp_t_float(float a, float b)
{ 
  ...
  return a float;
}

float mult_samp_t_int(int a, int b)
{ 
  ...
  return an int;
} 
```

也就是说，您选择的类型系统将设置您要使用的整个功能集。不过，我仍然建议仅在无法处理运行时选择和功能时才使用此方案，因为我在这里介绍的方式使代码更难调试（尽管我过去从未遇到过问题）。

（我在专业操作系统的代码中遇到了更糟糕的事情:-)）

# jquery - Jquery提及输入：输出数据问题

> ID：10288649
> 
> 赞同：1
> 
> 时间：2012-04-23T21:33:18.087
> 
> 标签：jquery, comments, return, underscore.js

我正在为我的网站开发我的评论系统，但我无法检索整个字段的值。

我正在使用这个脚本[https://github.com/podio/jquery-mentions-input](https://github.com/podio/jquery-mentions-input)

```
return {
  init : function (options) {
    settings = options;

    initTextarea();
    initAutocomplete();
    initMentionsOverlay();
  },

  val : function (callback) {
    if (!_.isFunction(callback)) {
      return;
    }

    var value = mentionsCollection.length ? elmInputBox.data('messageText') : getInputBoxValue();
    callback.call(this, value);
  }
} 
```

函数 val 是返回值的函数！

这是我用来获取价值的代码。（它不起作用）

```
 $('#commentInput').mentionsInput('val', function(comment){ var test = comment; });
     alert( test ); 
```

我想找到一种方法从这个函数中提取值注释/测试，然后可以将它发送到我的数据库。

如果我使用下一个代码，警报框会显示好信息。

```
('#commentInput').mentionsInput('val', function(comment) { alert(comment); }); 
```

我尝试了一些其他操作来尝试使其正常工作，但我总是遇到诸如 [object Object] 或 [ HTMLDivElement] 之类的错误

我很确定这很容易，但我无法弄清楚。

希望有人可以帮助我

祝你有美好的一天

乔里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:55:13.147

乔里斯，

`('#commentInput').mentionsInput('val', function(comment) { alert(comment); });`是正确的表述。你只需要更进一步，如下：

```
('#commentInput').mentionsInput('val', function(comment) {
    sendToDatabase(comment);
}); 
```

where`sendToDatabase`是一个函数，它接受注释作为其参数并将其（通过 ajax 和服务器脚本）上传到您的数据库......像这样：

```
function sendToDatabase(comment){
    $ajax({
        url: 'path/to/server/script',
        type: "GET", //or "POST"
        data: { "comment": comment },
        success: function(){
            //here display something to confirm that the upload was successful
        },
        error: function(){
            //here display something to indicate that the upload was not successful
        },
    });
} 
```

# php - 使用 PHP 强制下载未知文件类型的文件

> ID：10288651
> 
> 赞同：8
> 
> 时间：2012-04-23T21:33:26.300
> 
> 标签：php

我希望使用 PHP 标头强制从外部源下载文件。但是，文件类型可以是**ANYTHING**。**如何强制下载所有文件类型**？

我希望你能理解我的问题以及我想要描述的内容。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T21:36:34.253

您的意思是 HTTP 标头，并且您正在寻找 RFC 2616，[http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html) “内容处置”。

发送以下标头以强制下载所有文件和类型：

```
header('Content-Disposition: attachment; filename="name.ext"');
header('Content-Type: application/octet-stream'); // or application/force-download

echo $the_file_content;
exit; 
```

# c# - 如何遍历列表视图列

> ID：10288654
> 
> 赞同：0
> 
> 时间：2012-04-23T21:33:41.300
> 
> 标签：c#

如何遍历列表视图列，以便我们可以检查列表视图列中的项目是否已存在，如果存在则更改项目。

例如，我有一个包含（数量和项目）的列表视图，我想检查新添加的项目是否已经存在于列表视图中，然后只需将数量更改为数量 ++，而不是添加新项目。

```
string[] saLvwItem = new string[4];
saLvwItem[0] = a.ToString();
saLvwItem[1] = r["ItemNumber"].ToString();
saLvwItem[2] = r["ItemName"].ToString();
saLvwItem[3] = r["Price"].ToString();

ListViewItem lvi = new ListViewItem(saLvwItem);
listView1.Items.Add(lvi); 
```

所有的值都来自数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:40:21.417

使用以下代码，

```
if(!lvi.ContainsKey(saLvwItem[1]))
{
   ListViewItem lvi = new ListViewItem(saLvwItem[2]); //Or whatever value you want to show as name
   listView1.Items.Add(lvi);

} 
```

Listview 对每个项目都有一个键值设置，所以你不能设置四个属性。您的密钥应该是唯一的，并且您的名称应该正是您想要显示的内容，您可以通过连接 2 个或更多值来命名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:12:12.147

如果您尝试匹配 ItemName (columnIndex=2) 并增加 ItemNumber (columnIndex=1)，那么这可能有效：

```
 private void InsertOrUpdateItem(ListView listView, string[] saLvwItem)
    {
        if (saLvwItem == null || saLvwItem.Length < 4)
        {
            return;
        }

        bool bFound = false;
        foreach (ListViewItem lvi in listView.Items)
        {
            if (lvi.SubItems[2].Text == saLvwItem[2])
            {
                // item already in list
                // increase the ItemNumber
                lvi.SubItems[1].Text = (Convert.ToInt32(lvi.SubItems[1].Text) + Convert.ToInt32(saLvwItem[1])).ToString();
                bFound = true;
                break;
            }                
        }

        if (!bFound)
        {
            // item not found
            // create new item
            ListViewItem newItem = new ListViewItem(saLvwItem);
            listView.Items.Add(newItem);
        }

    } 
```

# c# - 在 C# 中启动应用程序的 linux 服务，该应用程序从 tcp 端口读取并启动 GTK 窗口

> ID：10288656
> 
> 赞同：1
> 
> 时间：2012-04-23T21:33:47.963
> 
> 标签：c#, linux, sockets, shell, mono

我正在使用 C# 和单声道为 linux (ubuntu 11.04) 编写应用程序。这个应用程序是一个服务器，它从我制作的客户端发送的 tcp 端口（9898）读取消息（url）。服务器收到 URL 并弹出一个窗口（gtk 窗口），我在其中使用 WebKit 从 URL 嵌入 HTML 代码。当我执行程序时一切正常，但我需要在启动时运行这个应用程序，所以我制作了一个在计算机启动时运行的 shell 脚本。该脚本执行这一行“mono NetworkServer.exe &”。当我打开计算机时，进程处于活动状态并且 NetworkServer.exe 正在运行，但是如果我尝试连接客户端，则程序在尝试创建窗口时会崩溃。如果我手动启动|重新启动脚本，一切正常，所以问题是在系统启动时启动应用程序。

这是脚本（我删除了一些功能以使其更简单）：

```
#! /bin/sh

### BEGIN INIT INFO
# Provides:             visitord
# Required-Start:       $local_fs $remote_fs $network
# Required-Stop:        $local_fs $remote_fs $network
# Default-Start:        2 3 4 5
# Default-Stop:         0 1 6
# Short-Description:    Create a deamon that initializes the NetworkServer.exe
### END INIT INFO

#GLOBAL VARIABLES
ROOT_ID=0                                   # Root ID
USER_ID=$(id -u)                            # User ID of the user who is running the script
PATH=/sbin:/usr/sbin:/bin:/usr/bin          # 
APP_PATH=/usr/bin/NetworkServer.exe         # The path where the Visitor APP is located
RETURN_VALUE=0                              # The return value
APP_PID=`ps -ef | grep $APP_PATH | grep -v grep | awk '{print$2}'`      # The Visitor APP PID 

. /lib/lsb/init-functions

do_start (){
# if it is running do nothing
if [ -n "$APP_PID" ]; then
    echo "The visitord service is already running (pid $APP_PID)"
    RETURN_VALUE=1
else
    if [ -f $APP_PATH ]; then
        mono $APP_PATH &
        APP_PID=$!
        echo "The visitord service is running (pid $APP_PID)"
        RETURN_VALUE=0
    else
        echo "The VisitorApp doesn't exist, or its location has been changed"
        RETURN_VALUE=1
    fi
fi

}

case "$1" in
  start)
    do_start
    exit $RETURN_VALUE
    ;;
  *)
    echo "Usage: visitord start|stop|restart|status" >&2
    exit 3
    ;;
esac 
```

这是 NetworkServer.cs 代码：

```
using System;
using System.IO;
using System.Net.Sockets;
using System.Threading;

namespace VisitorApp{

public class NetworkServer{

    private int port;
    private TcpListener tcpListener;

    public NetworkServer(int port){
        this.port = port;
    }

    public  void Start(){

        TextWriter tw = File.AppendText("/var/www/Visitor/log.log");

        try{
            this.tcpListener = new TcpListener(this.port);
            this.tcpListener.Start();
            tw.WriteLine(DateTime.Now+" >> Server started");
        }catch{
            tw.WriteLine(DateTime.Now+" >> The port "+this.port+" is already in use");
            return;
        }finally{
            tw.Close(); 
        }

        int clientNo=0;

        while(true){

            System.Net.Sockets.Socket socketForClient = tcpListener.AcceptSocket();
            clientNo++;

            if (socketForClient.Connected){
                tw = File.AppendText("/var/www/Visitor/log.log");
                tw.WriteLine(DateTime.Now+" >> Client["+clientNo+"] is connected");
                NetworkStream networkStream = new NetworkStream(socketForClient);
                StreamReader streamReader = new StreamReader(networkStream);

                string url;
                try{

                    url = streamReader.ReadLine();
                    tw.WriteLine(DateTime.Now+" >> URL from the Client: "+url);
        //The execution stops here!!!!!!
                    new VisitorWindow("Visitor App",url);
                    tw.WriteLine(DateTime.Now+" >> An open window has been closed");
                }catch{
                    tw.WriteLine(DateTime.Now+" The Client didn't send a URL");

                }finally{
                    tw.Close();
                    socketForClient.Close();
                    networkStream.Close();
                    streamReader.Close();
                }

            }
        }
    }

    public static void Main(){

        new Thread(new ThreadStart(
            delegate {
                new NetworkServer(9898).Start();
            })).Start();
    }
}
} 
```

这是 Client.cs 代码：

```
using System;
using System.IO;
using System.Net.Sockets;

namespace Client{

public class Client{

    private TcpClient clientSocket;
    private string server;
    private int port;
    private string url;

    public Client(string server, int port, string url){
        this.clientSocket = new TcpClient();
        this.server = server;
        this.port = port;
        this.url = url;
    }

    public void Connect(){

        try{
            this.clientSocket.Connect(this.server,this.port);
        }catch{
            Console.WriteLine("Unable to connect to server: "+this.server+" port: "+this.port);
            return;
        }
        NetworkStream serverStream = this.clientSocket.GetStream();
        StreamWriter streamWriter = new System.IO.StreamWriter(serverStream);

        try{

            streamWriter.WriteLine(url);
            streamWriter.Flush();
        }catch{

            Console.WriteLine("Exception writing to the Server");

        }finally{
            this.clientSocket.Close();
            serverStream.Close();
            streamWriter.Close();
        }

    }

    public static void Main(){
        Client c = new Client("localhost",9898,"http://www.stackoverflow.com");
        c.Connect();
    }
}
} 
```

访问者窗口.cs 代码：

```
using System;
using System.IO;
using Gtk;
using WebKit;

namespace VisitorApp{

public class VisitorWindow {

    private string windowName;
    private string url;
    private Gtk.Window window;
    public TextWriter tw;

    public VisitorWindow(string windowName, string url){
        this.windowName = windowName;
        this.url = url;

        try{
            this.CreateWindow();
        }catch(Exception exc){
            this.tw.WriteLine(DateTime.Now+" >> "+exc.ToString());
        }finally{
            this.tw.Close();    
        }
    }

    public void CreateWindow(){
        this.tw = File.AppendText("/var/www/Visitor/log.log");
        this.tw.WriteLine(DateTime.Now+" >> Before Application.Init");
        Application.Init ();
        this.tw.WriteLine(DateTime.Now+" >> After Application.Init");

        //Set the graphical properties of the window
        this.window = new Gtk.Window (this.windowName);
        this.tw.WriteLine(DateTime.Now+" >> After Gtk.Window (this.windowName)");
        window.SetDefaultSize(1000,800);
        this.tw.WriteLine(DateTime.Now+" >> After window.SetDefaultSize(1000,800)");
        //window.FullScreen();

        //Adding events for actions
        window.DeleteEvent += new DeleteEventHandler (OnWindowDelete);
        this.tw.WriteLine(DateTime.Now+" >> After DeleteEventHandler (OnWindowDelete)");
        //Create the embed content
        ScrolledWindow scroll = new ScrolledWindow ();
        this.tw.WriteLine(DateTime.Now+" >> After new scroll");

        WebView webView = new WebView();
        this.tw.WriteLine(DateTime.Now+" >> After new WebView();");

        webView.Open (this.url);
        this.tw.WriteLine(DateTime.Now+" >>  webView.Open (this.url);");
        scroll.Add (webView);  
        this.tw.WriteLine(DateTime.Now+" >>  scroll.Add (webView);");
        window.Add (scroll);
        this.tw.WriteLine(DateTime.Now+" >>  window.Add (scroll);");

        window.ShowAll();
        this.tw.WriteLine(DateTime.Now+" >>  window.ShowAll()");
        Application.Run ();
        this.tw.WriteLine(DateTime.Now+" >>  Application.Run ");
    }
    void OnWindowDelete (object obj, DeleteEventArgs args){
        Application.Quit();
    }
}
} 
```

日志文件：

```
04/24/2012 08:23:27 >> Server started
04/24/2012 08:24:56 >> Client[1] is connected
04/24/2012 08:24:56 >> URL from the Client: http://www.stackoverflow.com 
```

日志文件中没有错误，抛出任何异常，只是它崩溃了......任何帮助都会非常有用！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:48:18.460

可能有帮助的一件事是，当您尝试连接客户端时，程序崩溃了。错误信息是什么？

我想补充的另一件事是您的 Client.cs 对我来说感觉不对。可能只是我很挑剔，但 Client 类的 Main 方法创建了它自己的一个实例。你如何创建一个客户端对象？你说 NetworkServer.exe 在你的 Linux 机器启动时正在运行，它只会在你创建客户端时崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:20:30.757

您无法从服务器打开 X Window - 您怎么知道要连接到哪个显示器？

您将需要另一个在 X 中运行的客户端程序，它连接到您的服务器并接收事件，并且该客户端 GUI 程序可以在 Linux 桌面上执行操作。

考虑这样一台机器[——](http://linuxgazette.net/124/smith.html)一个六用户多头系统——你的程序怎么知道要连接到哪个显示器？没有由 init 启动的守护进程——来自 SysV 目录或新贵，可以知道要使用哪个显示器。因此，您需要在您机器的一个用户桌面上启动一个程序，正如您可能建议使用`xinit`. 这可以是您的整个程序，也可以只是您的守护程序的客户端，两者都应该是可能的。

# c# - MonoDevelop 上的命名空间错误

> ID：10288662
> 
> 赞同：1
> 
> 时间：2012-04-23T21:34:24.137
> 
> 标签：c#, namespaces, compiler-errors, monodevelop, xamarin.android

我一直收到以下错误。1：名称空间“System”中不存在类型或名称空间名称“CountDownTime”（您是否缺少程序集引用） 2：名称空间 Andriod.OS 中不存在类型或名称空间名称“Runtime”（您是否缺少装配参考）

我希望代码生成 10 个减法问题，给出答案，然后给出测试所花费的时间。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.CountDownTimer;

using Android.App;
using Android.Content;
using Android.OS.Runtime;
using Android.Runtime;
using Android.Util;
using Android.Views;
using Android.Widget;
using Android;

namespace Jagtutor
{
    public class Subtraction : View
    {
        public Subtraction (Context context, IAttributeSet attrs) :
            base (context, attrs)
        {
            Initialize ();
        }

        public Subtraction (Context context, IAttributeSet attrs, int defStyle) :
            base (context, attrs, defStyle)
        {
            Initialize ();
        }

        private void Initialize ()
        {
            int correctCount;
            int count = 0;
            long startTime = CountDownTimer(0);

            while (count < 10)
            {
                // Generate two random single-digit numbers
                srand(CountDownTimer(0));
                int number1 = Random() % 10;
                int number2 = Random() % 10;

                // if number1 < number, swap number1 with number2
                if (number1 < number2)
                {
                    int temp = number1;
                    number1 = number2;
                    number2 = temp; 

                    // PROMPT THE STUDENT TO ANSWER " WHAT IS NUMBERE1 - NUMBER2?"
                    Console.WriteLine("WHAT IS ")(number1);" - "(number2)("?");

                    // Grade the answer and display the result
                    if (number1 - number2 == answer){
                        Console.Write("You are correct!");
                        correctCount++;
                    }
                    else
                        Console.WriteLine("Your answer is wrong");
                    Console.WriteLine(number1);"-"(number2); " should be" (number1 - number2);

                    // increase the count 
                    count++;
                }
                long endTime = CountDownTimer(0);
                long testTime = endTime - startTime; 

                Console.Write(" Correct count is ")(correctCount);" Test time is" (testTime)("seconds");
                return 0;
            }

        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:44:12.870

C# [using 指令](http://msdn.microsoft.com/en-us/library/sf0df423.aspx)用于*命名空间*，而不是*类型*。没有`System.CountDownTimer`命名空间，因此出现错误。

就此而言，也没有`System.CountDownTimer`类型。它是[Android.OS.CountDownTimer](http://androidapi.xamarin.com/?link=T:Android.OS.CountDownTimer)，所以你需要：

```
using Android.OS; 
```

同样，没有`Android.OS.Runtime`命名空间，所以`using Android.OS.Runtime;`也会产生编译时错误；去掉它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:47:02.467

与其他人一起，添加：

`using Android.OS;`

# rhino - 从 Java 访问 Rhino 的原生 JSON.Stringify

> ID：10288669
> 
> 赞同：8
> 
> 时间：2012-04-23T21:35:18.473
> 
> 标签：rhino

有没有比使用以下 kludge 更简洁的方法来获取 Javascript 对象的 JSON 表示？

```
System.out.println(((ScriptableObject) scope).callMethod(
    cx, (Scriptable) scope.get("JSON", scope), 
    "stringify", new Object[]{jsObject})); 
```

其中 jsObject 是我要字符串化的 ScriptableObject。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T16:13:24.907

请注意，Hannes现在已经在 Rhino 中[解决了这个问题。](https://github.com/mozilla/rhino/commit/9c3127985f32f19947c6430af046ec0865751e1a)所以用法简化为：

```
import org.mozilla.javascript.NativeJSON;
// ...

Object json = NativeJSON.stringify(cx, scope, jsObject, null, null); 
```

org.mozilla.javascript.NativeJSON 类在 Rhino 1.7R4 版本中应该是公开的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-27T22:52:22.147

我能够使用 NativeJSON 类在 Apache Ant 目标中实现此功能。

```
importPackage(org.mozilla.javascript);

var context = Context.enter();
var json = '{}';
// The call to parse required a reviver function that should return the
// state of a key/value pair.
var reviver = function(key, value) { return value; };
var scope = context.initStandardObjects();
var object = NativeJSON.parse(context, scope, json, reviver);

// The call to stringify does not require the replacer or space parameters.
// The replacer is a function that takes a key/value pair and returns the
// new value or an array of keys from the input JSON to stringify. The space
// parameter is the indentation characters or length.
json = NativeJSON.stringify(context, scope, config, null, 4); 
```

[http://mozilla.github.io/rhino/javadoc/org/mozilla/javascript/NativeJSON.html](http://mozilla.github.io/rhino/javadoc/org/mozilla/javascript/NativeJSON.html) [https://github.com/mozilla/rhino/blob/master/src/org/mozilla/javascript/NativeJSON.java](https://github.com/mozilla/rhino/blob/master/src/org/mozilla/javascript/NativeJSON.java)

# wpf - TextBox 到 TextBox 的动态数据绑定

> ID：10288670
> 
> 赞同：0
> 
> 时间：2012-04-23T21:35:19.003
> 
> 标签：wpf, data-binding, textbox

WPF 页面上有两个 TextBox。当用户在第一个 TextBox 中键入时，第二个 TextBox 必须显示来自第一个 TextBox 的修改后的文本。因此，这两个值都必须绑定到视图模型。

可以通过数据绑定完成吗？

我能够从在我的视图模型上实现 DependencyProperty 的第一个文本框获得第二个文本框显示文本。但我一点也不知道如何即时应用转换。

也许有一种简单的方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:40:49.820

只需使用将[UpdateSourceTrigger](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.updatesourcetrigger.aspx)设置为的数据绑定`PropertyChanged`：

```
<TextBox x:Name='txt1' Text="{Binding MyText, UpdateSourceTrigger=PropertyChanged}" />
<TextBox x:Name='txt2' Text="{Binding MyText, UpdateSourceTrigger=PropertyChanged}" /> 
```

在这种情况下，它将即时更新 ViewModel 的属性，而不是等待`FocusLost`.

# asp.net-mvc-3 - 自己创建新对象时的 EF4.3 依赖注入

> ID：10288673
> 
> 赞同：0
> 
> 时间：2012-04-23T21:35:58.643
> 
> 标签：asp.net-mvc-3, entity-framework, dependency-injection, ninject, dbcontext

我正在使用实体框架构建一个 MVC3 应用程序。在应用程序中，我的控制器与服务层通信。其中一个控制器是`TournamentController`使用`TournamentService`. `CreateTournament`该服务有一些标准方法，例如`UpdateTournament`等。

当我想插入一个新的锦标赛时，我希望视图有一个可以组织锦标赛的可能运动的下拉列表。因此，在`TournamentController's` `Create`方法中，我填写了`ViewBag.Sports`一份可能的运动列表。现在获取我使用的运动列表`_tournamentService.GetAllSports()`。在这种`GetAllSports()`方法中，`TournamentService`我想创建一个实例，`SportService`以便我可以将问题“转发”到正确的服务。

所有服务都在构造函数中使用依赖注入来注入自己的存储库，如下所示：

```
private ITournamentRepository _repo;

public TournamentService(ITournamentRepository repo) {
    _repo = repo;
} 
```

我的`GetAllSports()`方法是`TournamentService`这样的：

```
public IEnumerable<Sport> GetAllSports() {
    ISportService sportService = new SportService();
    return sportService.GetSports();
} 
```

问题是，通过调用它，`new SportService()`它希望我`ISportRepository`在`TournamentService`ninject 创建`TournamentRepository`. 现在我可以执行以下操作：

```
public IEnumerable<Sport> GetAllSports() {
    ISportService sportService = new SportService(new SportRepository());
    return sportService.GetSports();
} 
```

但问题是每个存储库都需要一个 IContext，它通常也由 ninject 处理。此外，我不希望实例化两个单独的上下文。

我发现自己的一个可能的解决方案是这样做：

```
private ITournamentRepository _repo;
private ISportService _sportService;

public TournamentService(ITournamentRepository repo, ISportService sportService) {
    _repo = repo;
    _sportService = sportService
} 
```

但是我的`TournamentService`类中只有一种方法会实际使用，`_sportService`所以我认为将其作为类属性有点过分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:48:06.330

您的最后一个解决方案有效。注入必要的服务作为构造函数的一部分。

如果你担心多个上下文，那么不要让两个单独的上下文被创建。

在您的 Ninject 绑定中：

```
Bind<ITournamentRepository>().To<TournamentRepository>().InRequestScope(); 
```

见[https://github.com/ninject/Ninject.Web.Common/wiki/InRequestScope](https://github.com/ninject/Ninject.Web.Common/wiki/InRequestScope)

最后一块是重要的部分。它只会为当前请求创建一个 TournamentRepository 实例。TournamentRepository 的任何其他请求者都将获得此实例。

如果您已经这样做了，那么您已经设置好了，否则，只需添加 InRequestScope 即可。（请记住，您需要参考 Ninject.Web.Common）

希望有帮助。

编辑：

Remo 是正确的，我也不会从服务中调用它。只需从控制器调用您的查找数据并填充您的视图模型。InRequestScope 建议仍然有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:04:15.853

保持简单，注入`ISportService`您的控制器并`sportService.GetSports()`直接从控制器调用！

# php - preg_match 错误未知修饰符'{'

> ID：10288674
> 
> 赞同：0
> 
> 时间：2012-04-23T21:36:09.563
> 
> 标签：php, regex

这有什么问题？

```
if((preg_match('[a-zA-Z]{1,7}+',$_POST['naam'])) and (preg_match('[^\@\#\<\>\&\*\/]+[a-zA-Z0-9]+!',$_POST['password']))) 
```

第一个正则表达式我想要一个 1-7 长的字符串，只包含字母。

第二个正则表达式我想要一个包含字母和数字的字符串！在末尾。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-23T21:38:12.157

您在正则表达式周围缺少分隔符：

```
if((preg_match('/[a-zA-Z]{1,7}+/',$_POST['naam'])) and (preg_match('/[^\@\#\<\>\&\*\/]+[a-zA-Z0-9]+!/',$_POST['password']))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T21:40:18.147

`{1,7}`- 这意味着 1 到 7

`{1,7}+`- 这很尴尬，因为 + 表示前面的 char 应该至少有一次。通常用作`[a-z]+`<-- 需要 az

`{1,7}+`是错的。

# java - 我不明白 Image 类！我在这里做错了什么？

> ID：10288676
> 
> 赞同：3
> 
> 时间：2012-04-23T21:36:14.503
> 
> 标签：java, image

这里是一个新手，但这是一个解释我的问题的小测试代码。打印的值为 -1。我对如何返回图像的像素宽度一无所知，我在这里遗漏了一些非常明显的东西吗？这整个 ImageObserver 东西毫无意义！！！

```
 import java.awt.*;
    import javax.swing.*;
    import java.awt.event.*;

    class imagetest2 extends JPanel {
        Image i =Toolkit.getDefaultToolkit().getImage(/*image*/);

        public int test(){
            int x = i.getWidth(null);
            return x;
        }

    }

    class imagetest {
        public static void main(String args[]){
            imagetest2 tesst = new imagetest2();
            System.out.print(tesst.test());
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T21:39:24.317

`Toolkit.getDefaultToolkit().getImage()`可能会异步加载几乎永远不是您想要的图像。

使用`ImageIO`and a`BufferedImage`代替，它也有`getWidth()`和`getHeight()`没有`ImageObserver`参数（尽管如果你通过其他参数也可以工作`null`）：

```
BufferedImage image = ImageIO.read("/*image*/");
int width = image.getWidth(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:06:22.457

您只是使用了错误的类。有一种更简单的方法可以实现您想要的，这将做到：

```
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.io.File;
import javax.imageio.ImageIO;

class ImageTest 
{
    BufferedImage img;

    public static int getWidthFromImage(String filename)
    {
        BufferedImage image;
        int width;
        try
        {
            image = ImageIO.read(new File(filename));
            return image.getWidth();
        }
        catch(IOException e)
        {
            System.out.println("Something terrible happened! " + e.getMessage());
            e.printStackTrace();
        }
        return -1;
    }
    public static void main(String args[])
    {
        System.out.print("The width of the image in pixels is: " + getWidthFromImage(args[0]));
    }
} 
```

# jsf - index.xhtml 可以存储在外部 JAR 文件中吗？它的 URL 是什么？

> ID：10288679
> 
> 赞同：2
> 
> 时间：2012-04-23T21:36:36.190
> 
> 标签：jsf, jsf-2, jar, facelets

我想将所有 facelets 和托管 bean 放入一个外部 jar 中，但如果我将 de index.xhtml 放在那里，我不知道如何引用它。

如果jar结构是：

```
 IndexManagedBean.class
 META-INF/
    resources/
       pages/
          index.xhtml 
```

它的网址是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:58:06.497

假设 JAR 放置在 webapp 的`/WEB-INF/lib`文件夹中，并且您使用的是 JSF 2.x，并且 webapp 的上下文路径是`/contextpath`，并且`FacesServlet`映射到 URL 模式，`*.xhtml`那么您可以通过以下 URL 引用它：

> [http://example.com/contextpath/pages/index.xhtml](http://example.com/contextpath/pages/index.xhtml)

### 也可以看看

*   [具有共享代码的多个 JSF 项目的结构](https://stackoverflow.com/questions/8320486/structure-for-multiple-jsf-projects-with-shared-code)

# javascript - 追加到 div，而不是正文

> ID：10288680
> 
> 赞同：0
> 
> 时间：2012-04-23T21:36:36.587
> 
> 标签：javascript, dom

> **可能重复：**
> [插入元素](https://stackoverflow.com/questions/1559621/inserting-an-element)
> [如何在不使用库的情况下在 JavaScript 中插入 After()？](https://stackoverflow.com/questions/4793604/how-to-do-insert-after-in-javascript-without-using-a-library)

我在一个项目中有一点点javascript，它在页面主体之后添加了一个聊天窗口，我想更改它，以便在我指定的div“myPublisherDiv”之后添加聊天窗口。我认为这很简单，有什么想法吗？提前致谢！

```
var div = document.createElement('div');
    div.setAttribute('id', 'stream' + streams[i].streamId);
    document.body.appendChild(div); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:42:37.030

这有点棘手。[insertBefore](https://developer.mozilla.org/en/DOM/Node.insertBefore)很简单，为了在节点之后插入，我编写了一个小辅助函数：

```
function insertAfter(newElement, referenceElement) {
    referenceElement.parentNode.insertBefore(newElement, referenceElement.nextSibling);
}

var div = document.createElement('div');
...
insertAfter(document.getElementById("myPublisherDiv"), div); 
```

但另请参阅[https://stackoverflow.com/a/1559632/1048572](https://stackoverflow.com/a/1559632/1048572)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T21:43:16.590

这个应该做。。

```
var div = document.createElement('div');
div.setAttribute('id', 'stream' + streams[i].streamId);

var target = document.getElementById('myPublisherDiv');

target.parentNode.insertBefore(div, target.nextSibling); 
```

摘自[How to do insert After() in JavaScript without using a library？](https://stackoverflow.com/questions/4793604/how-to-do-insert-after-in-javascript-without-using-a-library)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:39:40.830

将 id 放入您的 div

```
<div id="myDiv">..</div> 
```

然后使用[appendChild](https://developer.mozilla.org/en/DOM/element.appendChild)将内容附加到它：

```
document.getElementById("myDiv").appendChild(div); 
```

# java - 是否可以序列化hibernate EntityManagerFactory？

> ID：10288684
> 
> 赞同：0
> 
> 时间：2012-04-23T21:36:56.740
> 
> 标签：java, hibernate, jpa

我有一个使用休眠的项目，启动时间很长，我想知道是否可以序列化 EntitiyManagerFactory，因此只有第一次启动会很慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:44:22.497

它*可以*在 hibernate 中序列化（在其他 JPA 实现中不一定是这种情况），因为 hibernate 内部接口扩展了`Serializable`. 但这是供内部使用的，可能由应用程序服务器能够以某种方式钝化它。

您的问题出在其他地方，不应通过序列化实体管理器工厂来解决。通常在启动时它会创建一个连接池并用新的数据库连接填充它。而且你不能序列化这些连接，所以如果你这样做，就会出现一大堆新问题。

相反，请确保数据库及时响应（如果没有 - 它正在减慢池的填充速度），以及您的启动是否*真的*那么慢。30 秒*并不*慢，5 分钟可能会很慢，具体取决于应用程序的大小。

# java - 表示层次关系

> ID：10288685
> 
> 赞同：0
> 
> 时间：2012-04-23T21:37:18.817
> 
> 标签：java

你能建议我“如何通过java类表示层次关系？” 欢迎您提出其他技术。

例如，用户指定

```
 "Room" belongs-to "Floor" and  "Floor" belongs-to "Center" 
```

我想将这种关系表示为 Java 类，以后想检索这种关系。

-潘克什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T21:46:54.763

你在说的是标准的[对象组合](http://en.wikipedia.org/wiki/Object_composition)

这里的“属于”和“包含”非常相似。例如：

```
public class Center
{
   private List<Floor> floors;
   ...
   public List<Floor> getFloors()
   {

      return this.floors;
   }
}

public class Floor
{
   private List<Room> rooms
   ...
}

public class Room
{
   private String roomNumber;
   ...
} 
```

# javascript - netbeans 没有在错误行中标记 TODO

> ID：10288686
> 
> 赞同：3
> 
> 时间：2012-04-23T21:37:20.640
> 
> 标签：javascript, eclipse, netbeans, syntax-highlighting

我正在从带有 Aptana 插件的 eclipse 切换到 netbeans 7.1。是否可以像在 Eclipse 中那样在右侧的错误行中用蓝点标记 TODO？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T08:35:00.683

在 Netbean 中，您不能再这样做了，检索任务的唯一方法是使用**Tasks Window**。也许您可以寻找一个插件来在左右边距中添加标记。

如果您找到了最新的，请告诉我，我进行了一些搜索，但一无所获。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-03T08:06:09.973

你可以，但它在实现上与 Eclipse 有点不同。（在 Netbeans 8 中测试）单击`Window > Action Items`，应该会出现一个日志控制台，然后转到`Tools > Options > Teams > ToDo patterns`，并添加或更改您的 TODO 标记模式。完成后，您可以在 Action Items 控制台上查看 TODO（或您标记的任何其他内容）。

# android - Android：如何在 Android 中加密自己的数据库

> ID：10288688
> 
> 赞同：0
> 
> 时间：2012-04-23T21:37:26.517
> 
> 标签：android

我正在尝试构建一个使用已经创建的数据库的应用程序......我已经找到了一个关于

如何将它复制到正确的位置，以便 ContentProvider 可以使用它。但是问题

是我还需要保护这些数据...我已经找到了应该的 SQLCipher

保护了数据库……但我发现的所有样本都没有提到如何复制你自己的。一世

不断出现错误，找不到 ContentProvider .. 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:26:10.770

好的，我找到了解决方案，我设法使用 sqlCipher 工具或将数据库导出为 SQLite 命令，然后使用 SQLCipher 库创建新的密码数据库......并且 getReadableDatabse 和 getWritableDatabase 对我不起作用我不得不使用 openDatabase 并通过 RWR FLAG SQLCipher 实现它们很奇怪，因为我无法让它们工作......不知道我是否足够清楚......如果其他人有这个问题，他可以让我知道。

# ruby-on-rails - 基本的 ruby on rails 身份验证问题

> ID：10288693
> 
> 赞同：2
> 
> 时间：2012-04-23T21:37:55.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在为 Rails 应用程序开发基本身份验证系统。身份验证使用 net-ldap 类验证来自 Active Directory 的帐户信息（这部分工作正常）。

然而，我的 session_helper 似乎有问题。即使 ActiveDirectoryUser.authenticate 成功，signed_in 帮助程序总是返回 false。登录后，脚本重定向到 root_path（default_controller 的主目录），然后立即再次重定向回 signin_path——因为 signed_in 助手返回 false。

请参阅下面的代码。我错过了什么？

谢谢

**application_controller.rb**

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  include SessionsHelper
end 
```

**default_controller.rb**

```
class DefaultController < ApplicationController
  before_filter :signed_in_user

  def home
  end

  private
    def signed_in_user
      redirect_to signin_path, notice: "Please sign in." unless signed_in?
    end
end 
```

**session_helper.rb**

```
module SessionsHelper
  def sign_in(user)
    @current_user = user
  end

  def current_user
    @current_user ||= nil
  end

  def signed_in?
    !@current_user.nil?
  end

  def sign_out
    @current_user = nil
  end
end 
```

**session_controller.rb**

```
class SessionsController < ApplicationController
  def new
  end

  def create    
    user = ActiveDirectoryUser.authenticate(params[:session][:username],params[:session][:password])

    if user.nil?
      # authentication failed
      flash.now[:error] = 'Invalid email/password combination'
      render 'new'
    else
      # authentication succeeded
      sign_in @user
      flash[:error] = 'Great success'
      redirect_to root_path
    end
  end

  def destroy
    sign_out
    redirect_to root_path
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:20:06.870

您应该使用 session for 来持久化这种数据（每个请求都可以评估），它是用户数据。但我强烈建议您使用**devise** gem 之类的东西，它可以为您完成所有身份验证以及更多工作。为什么要重新发明轮毂？

我相信这对你有用。

```
module SessionsHelper
  def sign_in(user)
    session[:user_id] = user.id
  end

  def current_user
    ActiveDirectoryUser.find(session[:user_id]) ||= nil
  end

  def signed_in?
    !session[:user_id].nil?
  end

  def sign_out
    session[:user_id] = nil
  end
end 
```

# asp.net-mvc - 如何使用存储库模式查询交叉表？

> ID：10288695
> 
> 赞同：9
> 
> 时间：2012-04-23T21:37:57.653
> 
> 标签：asp.net-mvc, join, repository-pattern

在我的 asp.net mvc 3 应用程序中，我使用的是存储库模式。我有 3 个实体，公司、国家、城市。他们每个人都有自己的存储库。公司实体有FfoundedCountry 和FfoundedCity 外键。现在在视图中，我想显示公司详细信息。在这个视图中，我想查看公司详细信息以及FundedCountry 名称和FfoundedCity 名称。在我看来，我必须使用一种 JOIN 查询来处理这个问题。但我被困在如何在存储库模式中实现这一点。如何在存储库模式中处理此 JOIN？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T10:06:48.370

存储库应具有基于任务的界面。这意味着 ORM、连接等都在存储库中。该应用程序只看到一个接口，该接口返回一个它可以使用的对象。

这意味着您不会围绕表创建存储库（它几乎没有达到目的）。在您的场景中，我建议您（至少）有 2 个存储库：一个将处理与更新模型相关的所有内容，另一个将仅提供读取（查询）。

这意味着查询存储库将只返回您想要的数据（它基本上返回视图模型位）。当然，实际的表和连接是存储库的实现细节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T22:32:36.907

不要以阻止连接的方式构建您的存储库模式！这通常意味着对与当前 HTTP 请求关联的所有实例使用相同的 ORM 上下文（DataContext/ObjectContext）。

我认为拥有一个通用的 IRepository 是一种反模式，因为数据库访问很少同时受限于单一类型的实体。

您可以认为 DataContext/ObjectContext 本身就是一个存储库。

最后一条建议：如果您不知道存储库抽象有什么好处 - 不要使用它。

# matplotlib - Matplotlib：如何在字典中设置破折号？

> ID：10288696
> 
> 赞同：0
> 
> 时间：2012-04-23T21:38:00.583
> 
> 标签：matplotlib

谁能告诉我如何在字典中使用自定义破折号序列。我无法让它运行，我唯一不能使用的东西（不是程序员）是文档 =-(

```
def lineCycler(): #must be invoked for every plot again to get the same results in every plot
    #hasy="#7b9aae"
    _styles = [{'color':'#b21a6a', 'ls':'-'},
               {'color':'#65a4cb', 'ls':'[5,2,10,5]'},# this shoul be some custom dash sequnece
               {'color':'#22b27c', 'ls':'-.'},
               {'color':'k', 'ls':'--'}
            ]

    _linecycler=cycle(_styles)
    return _linecycler 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:43:30.333

为此使用`dashes`关键字（并且您需要一个列表，而不是字符串）：

```
def lineCycler(): 
    _styles = [{'color':'#b21a6a', 'ls':'-'},
               {'color':'#65a4cb', 'dashes':[5,2,10,5]},
               {'color':'#22b27c', 'ls':'-.'},
               {'color':'k', 'ls':'--'}
            ]

    _linecycler=cycle(_styles)
    return _linecycler 
```

# java - Spring MVC Bean 验证

> ID：10288698
> 
> 赞同：0
> 
> 时间：2012-04-23T21:38:10.807
> 
> 标签：java, validation, spring-mvc, bean-validation

我必须为使用 Spring MVC 3 的 Web 应用程序实现验证。问题是 bean 类具有 getProperty("name") 和 setProperty("name",valueObj) 之类的方法。必须对通过将不同值传递给 getProperty("name") 返回的数据进行验证，例如： getProperty("age") 应该大于 16 并且 getProperty("state") 应该是必需的。

我想知道是否支持验证这种 Bean，如果没有，可以解决什么问题。

谢谢， 阿提夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:48:07.740

我不这么认为。Bean 验证在 ja​​vabean 上执行，即具有 getter 和 setter 的类字段。即使您可以注册自定义验证器并进行验证，绑定也不起作用。您还需要注册一个填充您的对象的自定义活页夹。它变得相当复杂。所以坚持javabeans约定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T21:51:01.407

听起来您想要一个实现`org.springframework.validation.Validator`.

```
@Component
public class MyValidator implements Validator {

    @Override
    public boolean supports(Class<?> clazz) {
        return MyBean.class.isAssignableFrom(clazz);
    }

    @Override
    public void validate(Object target, Errors errors) {
        MyBean myBean = (MyBean) target;

        if (StringUtils.isBlank(myBean.getProperty("state"))) {
            errors.rejectValue("state", "blank");
        }
    }

} 
```

在您的控制器中，您将执行如下手动验证：

```
@Autowired
private MyValidator myValidator;

@RequestMapping(value = "save", method = RequestMethod.POST)
public String save(@ModelAttribute("myBean") MyBean myBean, BindingResult result) {

    myValidator.validate(myBean, result);
    if (result.hasErrors()) {
        ...
    }

    ...

} 
```

# android - Android - 如何从另一个活动中设置首选项

> ID：10288709
> 
> 赞同：0
> 
> 时间：2012-04-23T21:39:21.273
> 
> 标签：android, sharedpreferences, preferenceactivity

我有一个 PreferenceActivity 类来处理我的应用程序中首选项的获取和设置。但是我有一个“主”Activity 类，它在启动时调用 Web 服务，并且基于 Web 服务的返回值，需要更新其中一个首选项。

如果不抛出 NullPointerException 错误，我似乎无法让它工作。

以下是主要活动的代码：

```
protected void onPostCreate(Bundle savedInstanceState)
{

    if(getWebServiceResult.equals("FALSE"))
    {
      //do stuff
    }
    else
    {
       myPreferences prefs = new myPreferences();               
       prefs.updateMyChoice("TRUE");
    }
} 
```

这是引发错误的 PreferenceActivity 类中的代码：

```
public void updateMyChoice(String newText)
{
    if(subscriber_opt_in == null) //this is coming up null
    {
       subscriber_opt_in = (EditTextPreference) findPreference("opt_in"); //error here
    }
   subscriber_opt_in.setText(newText);
   subscriber_opt_in.setSummary(newText);
} 
```

我需要知道如何正确更新此首选项。如果有办法在主 Activity 类中做到这一点，那就更好了，但如果我必须通过 PreferenceActivity 类做到这一点，我只需要了解如何做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:44:12.017

您应该使用 SharedPreference 类：http: [//developer.android.com/reference/android/content/Context.html#getSharedPreferences%28java.lang.String,%20int%29](http://developer.android.com/reference/android/content/Context.html#getSharedPreferences%28java.lang.String,%20int%29)

代码示例和在这里使用：http: [//developer.android.com/guide/topics/data/data-storage.html#pref](http://developer.android.com/guide/topics/data/data-storage.html#pref)

# pointers - 全局 void*，使其指向结构指针

> ID：10288712
> 
> 赞同：2
> 
> 时间：2012-04-23T21:39:29.760
> 
> 标签：pointers, void

我有类似的东西：

```
struct list{
   struct list **next, **prev;
} 
```

全局声明：

```
struct list *threads = &((struct list){&threads, &threads});
void* vp_threads;      /Error here:  previous declaration of 'vp_threads' was here
vp_threads = threads;  //Error here: conflicting types for vp_threads 
```

我尝试的第二种方式：

```
void* vp_threads = threads; //Error: initializer element is not constant 
```

我必须这样做，因为......（见下文！）

```
void some_func()
{
   add_head(vp_threads, ...)
...
}

void add_head(void* x, ...)
{ ... } 
```

（PS：并且没有 main() 或初始化函数，这是 core.c 文件类型，实现了 .h 中的所有函数）

为什么这不起作用，我只是想让 void* 指向我的结构。这有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:42:36.537

尝试做

```
vp_threads = threads; 
```

在 main （或初始化函数）

你不能在全局范围内声明。你的陈述`vp_threads = threads;` 必须存在于某处的函数中

# jquery - 醉意工具提示 jquery 插件中的 html

> ID：10288713
> 
> 赞同：1
> 
> 时间：2012-04-23T21:39:35.823
> 
> 标签：jquery, tooltip, tipsy

[Tipsy](http://onehackoranother.com/projects/jquery/tipsy/)是使用 jquery 的 facebook 样式工具提示的插件。我希望能够在工具提示中显示 HTML。`class='test'`例如：当鼠标悬停在图像中时，我有任何图像，我看到带有文本（html）的工具提示`<div></div>`。

前任 ：

```
<img class="test" src="test.jpg"> 
<div id="testtext"> bla bla bla ....</div> 
```

现场演示：请将鼠标悬停在 stackoverflow 答案中的标签上。您会看到标签的统计信息。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-23T21:41:44.563

来自醉酒文档[http://onehackoranother.com/projects/jquery/tipsy/](http://onehackoranother.com/projects/jquery/tipsy/)：

```
$('#example-html').tipsy({html: true }); 
```

# mysql - 在 MySQL Workbench 中导出超过 1000 条记录的查询结果

> ID：10288716
> 
> 赞同：52
> 
> 时间：2012-04-23T21:39:42.910
> 
> 标签：mysql, mysql-workbench

我试图在 MySQL Workbench 中保存大约 1,000,000 条记录的查询结果。

当我运行 SELECT 时，只显示 1000 条记录（MySQL Workbench 的默认限制）。我知道我可以更改限制或删除限制，但我不希望将 1,000,000 条记录加载到结果面板中（这可能会使我的计算机崩溃？），但我确实想将结果保存到文件中。

MySQL Workbench 是否允许您将查询结果直接保存到文件中？或者保存整个结果集而不是 1,000？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-10-13T10:52:22.283

可以更改查询结果行限制，或完全删除限制。

1.  转到**编辑 → 首选项 → SQL 编辑器（选项卡）**。如果找不到**Query Results**，请转至**SQL Queries(tab)**。

2.  找到**查询结果**部分并取消选中**限制行**复选框

3.  单击**确定**。

4.  重新运行您的查询。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-04-07T12:00:04.920

`LOAD DATA INFILE`有一个名为[SELECT ... INTO OUTFILE](http://dev.mysql.com/doc/refman/5.1/en/select-into.html)的兄弟姐妹。你可以像这样使用它：

```
SELECT * FROM mytable
INTO OUTFILE '/tmp/mytable.csv'
FIELDS TERMINATED BY ','
    OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'; 
```

此方法不会使用 UI 中不必要的资源。

正如[@florian](https://stackoverflow.com/users/2132691/florian)指出的那样：但是，它将在数据库服务器上创建输出文件，而不是在客户端机器上。

另请注意，**SELinux**或**AppArmor**等安全框架可能会阻止 MySQL 将文件写入标准*数据库*文件夹之外。如果您遇到*权限被拒绝*错误，即使该目录是`mysql`用户可写的，它也可能是其中之一。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-04-28T09:32:37.730

只需添加 'limit $number' 附加 SQL 子句。如果不加限制，默认返回1000行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-03-02T06:30:29.647

MySql 中有一个选项可以导出所有记录。命名查询结果操作。

[![在此处输入图像描述](../Images/68320ff8ff57b5d733c6011b119d7709.png)](https://i.stack.imgur.com/y6PTC.png)

# r - 从两个表的组合中找到最大值（for循环太慢）

> ID：10288722
> 
> 赞同：3
> 
> 时间：2012-04-23T21:40:14.337
> 
> 标签：r, plyr, data.table, reshape2

我有一个数据表“the.data”，其中第一列表示测量仪器，其余不同的测量数据。

```
instrument <- c(1,2,3,4,5,1,2,3,4,5)
hour <- c(1,1,1,1,1,2,2,2,2,2)
da <- c(12,14,11,14,10,19,15,16,13,11)
db <- c(21,23,22,29,28,26,24,27,26,22)
the.data <- data.frame(instrument,hour,da,db) 
```

我还定义了仪器组，例如，组 1 (g1) 指的是仪器 1 和 2。

```
g1 <- c(1,2)
g2 <- c(4,3,1)
g3 <- c(1,5,2)
g4 <- c(2,4)
g5 <- c(5,3,1,2,6)
groups <- c("g1","g2","g3","g4","g5") 
```

我需要找出每个组的总和在哪个小时具有每种数据类型的最大值，以及它的总和。

g1 小时 1：sum(da)=12+14=26 g1 小时 2：sum(da)=19+15=34

因此，对于 g1 和 da，答案是 2 小时和 34 小时。

我在 for 循环中使用 for 循环来执行此操作，但这需要很长时间（几个小时后我中断了）。问题是.data 大约有 100.000 行长，并且大约有 5.000 个组，每个组有 2-50 个仪器。

有什么好的方法可以做到这一点？

衷心感谢 Stack-overflow 的所有贡献者。

更新：现在示例中只有五个组。

/克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T22:06:20.413

循环将`group`不得不保留，或者充其量被类似`lapply()`. `hour`但是，可以通过重新格式化为矩阵然后只进行向量化代数来完全替换循环`instrument x hour`。例如：

```
library(reshape2)

groups = list(g1, g3)

the.data.a = dcast(the.data[,1:3], instrument ~ hour)

> sapply(groups, function(x) data.frame(max = max(colSums(the.data.a[x, -1])),
                                        ind = which.max(colSums(the.data.a[x, -1]))))
    [,1] [,2]
max 34   45  
ind 2    2 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T23:21:00.187

[这是John Colby 的回答](https://stackoverflow.com/a/10288990/271616)稍作修改的版本，带有一些示例数据。

```
set.seed(21)
instrument <- sample(100, 1e5, TRUE)
hour <- sample(24, 1e5, TRUE)
da <- trunc(runif(1e5)*10)
db <- trunc(runif(1e5)*10)
the.data <- data.frame(instrument,hour,da,db)
groups <- replicate(5000, sample(100, sample(50,1)))
names(groups) <- paste("g",1:length(groups),sep="")

library(reshape2)
system.time({    
the.data.a <- dcast(the.data[,1:3], instrument ~ hour, sum)
out <- t(sapply(groups, function(i) {
  byHour <- colSums(the.data.a[i,-1])
  c(max(byHour), which.max(byHour))
}))
colnames(out) <- c("max.hour","max.sum")
})
# Using da as value column: use value.var to override.
#    user  system elapsed 
#    3.80    0.00    3.81 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-23T22:19:49.647

这是使用`plyr`和`reshape2`来自 Hadley 的一种方法。首先，我们将`the.data`根据仪器是否在该组中添加一些布尔值。然后我们将其融合为长格式，将不需要的行子集化，然后使用`ddply`or进行分组操作`data.table`。

```
#add boolean columns
the.data <- transform(the.data, 
                      g1 = instrument %in% g1,
                      g2 = instrument %in% g2,
                      g3 = instrument %in% g3,
                      g4 = instrument %in% g4,
                      g5 = instrument %in% g5
                      )

#load library
library(reshape2)
#melt into long format
the.data.m <- melt(the.data, id.vars = 1:4)
#subset out data that that has FALSE for the groupings
the.data.m <- subset(the.data.m, value == TRUE)

#load plyr and data.table
library(plyr)
library(data.table)

#plyr way
ddply(the.data.m, c("variable", "hour"), summarize, out = sum(da))
#data.table way
dt <- data.table(the.data.m)
dt[, list(out = sum(da)), by = "variable, hour"] 
```

做一些基准测试，看看哪个更快：

```
library(rbenchmark)   
f1 <- function() ddply(the.data.m, c("variable", "hour"), summarize, out = sum(da))
f2 <- function() dt[, list(out = sum(da)), by = "variable, hour"]

> benchmark(f1(), f2(), replications=1000, order="elapsed", columns = c("test", "elapsed", "relative"))
  test elapsed relative
2 f2()    3.44 1.000000
1 f1()    6.82 1.982558 
```

因此，对于此示例，data.table 的速度大约快了 2 倍。您的里程可能会有所不同。

只是为了表明它给出了正确的值：

```
> dt[, list(out = sum(da)), by = "variable, hour"]
      variable hour out
 [1,]       g1    1  26
 [2,]       g1    2  34
 [3,]       g2    1  25
 [4,]       g2    2  29

... 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-23T22:20:48.047

您没有提供代码（或生成组的编程方式，组数为 5000 时似乎需要），但这*可能*是对 R 的更有效使用：

```
groups <- list(g1,g2,g3,g4,g5)
gmax <- list()
# The "da" results
for( gitem in seq_along(groups) ) { 
       gmax[[gitem]] <- with( subset(the.data , instrument %in% groups[[gitem]]),  
                               tapply(da , hour, sum) ) }
damat <- matrix(c(sapply(gmax, which.max), 
                  sapply(gmax, max)) , ncol=2)

# The "db" results
for( gitem in seq_along(groups) ) { 
       gmax[[gitem]] <- with( subset(the.data , instrument %in% groups[[gitem]]),  
                               tapply(db , hour, sum) ) }
dbmat <- matrix(c(sapply(gmax, which.max), 
                  sapply(gmax, max)) , ncol=2)

#--------
> damat
     [,1] [,2]
[1,]    2   34
[2,]    2   29
[3,]    2   45
[4,]    1   14
[5,]    2   42
> dbmat
     [,1] [,2]
[1,]    2   50
[2,]    2   53
[3,]    1   72
[4,]    1   29
[5,]    1   73 
```

# wcf - WCF，Linq 错误：无法将类型 System.linq.iorderedQueryable<> 隐式转换为 System.Collection.Generic.List<>

> ID：10288736
> 
> 赞同：0
> 
> 时间：2012-04-23T21:41:11.530
> 
> 标签：wcf, linq, entity-framework

我收到一个错误：我正在使用实体框架 wcf。

```
Error:cannot implicitly convert type System.linq.iorderedQueryable<xDataModel.Info> to System.Collection.Generic.List<xServiceLibrary.Info> 
```

以下是我的代码：

* * *

WCF 服务：

```
namespace xServiceLibrary
{
    public List<Info> GetScenario()
            {
                xEntities db = new xEntities();
                 var query = from qinfo in db.Infoes
                                select qinfo;

                  //return query.Cast<Info>().ToList(); (not working)
                  //return query.toList(); (not working)
                    return query;
       }
} 
```

界面：

```
namespace xServiceLibrary
{
     [OperationContract]
            List<Info> GetScenario();
} 
```

班级：

```
namespace xServiceLibrary
{
       [DataContract]
        public class Info
        {
            [DataMember]
            public int Scenario_Id;

            [DataMember]
            public string Scenario_Name { get; set; } 

            [DataMember]
            public string Company_Name { get; set; } 
        }
} 
```

**更新：（2）** 我有两个类库文件。一个是 xDataModel 命名空间，我在其中创建了 xmodel.edmx 文件。第二个是 xServiceLibrary 命名空间，我在其中实现 Wcf 服务。我在我的 xServiceLibrary 中附加了 xDataModel.dll 文件，以便我可以查询我的 EF 模型。

我无法理解这个概念。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:47:10.830

问题是您有两种不同的类型，分别命名为`Info`: `DataModel.Info`和`ServiceLibrary.Info`- 因为它们是不同的类型，所以您不能将一种类型转换为另一种类型。

如果两者都在那里没有充分的理由，我会消除其中一个。否则，作为一种解决方法，您可以通过一一复制相关属性`DataModel.Info`来投影：`ServiceLibrary.Info`

```
var results = (from qinfo in db.Infoes
               select new ServiceLibrary.Info()
               {
                    Scenario_Id = qinfo.Scenario_Id,
                    //and so on
               }).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:50:41.580

问题是您有两个不同的类，都称为`Info`，在您运行查询时都在范围内。这是一件**非常非常糟糕的事情**，尤其是如果您认为他们是同一个班级。

如果`DataModel.Info`和`ServiceLibrary.Info`是同一个类，您需要弄清楚为什么它们同时在范围内并修复它。

如果它们是不同的类，您需要明确说明您要返回哪个类。假设您的 EF 模型包含一组`DataModel.Info`对象，您的选项有：

1.  返回一个`List<DataModel.Info>`你可以通过调用得到的`query.ToList()`
2.  返回 a `List<ServiceLibrary.Info>`，您可以通过从 `DataModel.Info`对象中复制字段来获得：

    ```
    var query = from qinfo in db.Info
            select new ServiceLibrary.Info
            {
              Scenario_Id = q.Scenario_Id,
              Scenario_Name = q.Scenario_Name
              Company_Name = q.Company_Name
            }; 
    ```

3.  返回其他内容，例如您的自定义 DTO 对象，类似于 #2，但仅包含您需要的特定字段（例如，如果`ServiceLibrary.Info`是您不想传递的重对象。

但是，总的来说，您的问题集中在编译器解释`List<Info>`为`List<ServiceLibrary.Info>`并且您可能不希望它解释的事实。

# c++ - 从 auto_ptr 转换为普通指针

> ID：10288738
> 
> 赞同：3
> 
> 时间：2012-04-23T21:41:34.477
> 
> 标签：c++, stl, auto-ptr

我有一些第三方库会生成并返回 auto_ptr。但是，我真的很想使用一些 STL 容器。

所以我猜一种方法是转换

```
auto_ptr <int> ptr = some_library_call (); 
```

成一个常规的 c++ 指针。下面的工作吗？

```
int* myptr = ptr; 
```

如果不是，那么将 STL 与 auto_ptr 一起使用的最佳方法是什么（是的，我知道它不能直接工作……我知道 stl 和 auto_ptr 不能混合在一起）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-23T21:45:36.957

`ptr.get()`如果您想获取指针并且仍然让 `auto_ptr`之后删除它，您可以使用，或者使用`ptr.release()`获取指针并`auto_ptr`忘记它（您必须在之后删除它。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T21:44:35.237

在 auto_ptr 上调用[release()](http://www.cplusplus.com/reference/std/memory/auto_ptr/release/)，然后您可以将值存储在不同的智能指针或原始指针中，并将其与 STL 容器一起使用。

# jquery - colorbox 和 Jquery appendTo 函数的问题

> ID：10288746
> 
> 赞同：1
> 
> 时间：2012-04-23T21:42:11.913
> 
> 标签：jquery, colorbox

基本上我使用的是 JQuery 和 colorbox。我正在使用 iframe 类的彩盒。

所以基本上开始

```
$(".iframe44").colorbox({iframe:true, width:"80%", height:"80%"}); 
```

然后我在一个元素上使用它作为

```
<div class="class1">
<a class="iframe44" href=xyz.php> Add New</a>
<ul>
</ul>
</div> 
```

这段代码很好，iframe pop 出来了。该类还按预期转换为 class=iframe44 cboxElement。

所以不是我正在运行 AJAX 调用来获取一些值（作为 JSON），然后使用`appendTo()`将内容添加到`<ul>`元素中。像这样

```
$(document).ready(function () {
    $.ajax({
        type : "GET",
        url : "values.php?type=init",
        dataType : "json",
        success : function (data) {
            //alert("success");
            var ul_data = '';
            var counter = 0;
            for (var val in data) {
                if (data.hasOwnProperty(val)) {
                    console.log(data[counter].variable1 + data[counter].variable2);
                    ul_data = ul_data + "<li><a class=\"iframe44\" href=value_edit.php?variable2=" + data[counter].variable2 + ">" + data[counter].variable1 + "</li>";
                }
                counter++;
            }
            $(ul_data).appendTo('#class1 ul');
        }
    });
}); 
```

现在我面临的问题是，新添加的 ul_data`<div>`与 class=iframe44 cboxElement 的特征不同……而是 class=iframe44，因此弹出窗口不会出现。

让我知道我是否做错了什么？为什么附加数据的类别不正确。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:51:39.653

添加

```
$(".iframe44").colorbox({iframe:true, width:"80%", height:"80%"}); 
```

后

```
$(ul_data).appendTo('.class1 ul'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:51:14.590

`id`我认为这可能是问题，因为没有`"Class1"`

```
 $(ul_data).appendTo('#class1 ul');//Wrong

 $(ul_data).appendTo('.class1 ul');//Right 
```

# iphone - 轮询 iPhone 摄像头以处理图像

> ID：10288749
> 
> 赞同：0
> 
> 时间：2012-04-23T21:42:38.643
> 
> 标签：iphone, ios, xcode, ipad, uiimageview

场景是我希望我的应用程序（如果可能在后台）处理 iphone 相机看到的图像。

例如，应用程序正在运行，用户将手机放在一块红色纸板上，而不是想要显示一个警报视图，上面写着“手机放在红色表面上”（这是我想要做的简化版本，但只是为了让问题保持直接）。

希望这是有道理的。我知道这里有两个单独的问题。

1.  如何在应用程序的后台处理来自相机的图像（如果我们不能这样做，我们可以在需要时通过单击按钮来启动该过程）。
2.  处理图像以说明它所在的纯色。

任何帮助/指导将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T11:39:17.690

您的两个问题的通用答案：

1.  图像的后台处理可以作为定时器事件触发。例如，每 30 秒捕获屏幕上的图像并进行后面的处理。如果处理不是计算/时间密集型的，这应该有效
2.  在技​​术上可以通过编程方式知道一个像素的颜色。如果您确定整个图像只是一种颜色，您可以尝试这种方法。获取几个随机点并获取图像中像素的颜色。但是，如果图像（在您的示例中，红板）由一个图像或多种颜色组成，那么这将需要详细的图像处理技术。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:30:38.043

**1) 图像捕捉**

有两种应用程序会不断地从相机中获取图像：媒体捕捉（例如相机、iMovie）或*增强现实*应用程序。

这是用于媒体捕获的 iPhone SDK 教程：

[https://developer.apple.com/library/ios/documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html#//apple_ref/doc/uid/TP40010188-CH5-SW3](https://developer.apple.com/library/ios/documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html#//apple_ref/doc/uid/TP40010188-CH5-SW3)

[使用 iPhone SDK 访问相机](https://stackoverflow.com/questions/74113/access-the-camera-with-iphone-sdk)

增强现实应用程序从相机中连续拍摄照片以进行处理/叠加。我建议您查看一些可用的 AR 套件，看看它们如何从相机中获取连续流，并分析像素。

[启动增强现实 (AR) 应用程序，例如 Panasonic VIERA AR Setup Simulator](https://stackoverflow.com/questions/6260448/starting-a-augmented-reality-ar-app-like-panasonic-viera-ar-setup-simulator)

[http://blog.bordertownlabs.com/post/157320598/customizing-the-iphone-camera-view-with](http://blog.bordertownlabs.com/post/157320598/customizing-the-iphone-camera-view-with)

**2) 图像处理**

图像处理是一个非常大的话题，已经在其他多个地方讨论过：

[https://photo.stackexchange.com/questions/tagged/image-processing](https://photo.stackexchange.com/questions/tagged/image-processing)

[https://dsp.stackexchange.com/questions/tagged/image-processing](https://dsp.stackexchange.com/questions/tagged/image-processing)

[https://mathematica.stackexchange.com/questions/tagged/image-processing](https://mathematica.stackexchange.com/questions/tagged/image-processing)

..但对于初学者，您需要使用一些启发式分析来确定您要查找的内容。在一堆地方（例如角落+中间）对捕获的像素进行采样可能会有所帮助，就像生成颜色强度的直方图一样 - 如果有很多红色但很少或没有蓝色和绿色，那就是一张红牌。

# c - 尝试在 strcpy 之前将空字符添加到 char 数组的末尾

> ID：10288751
> 
> 赞同：1
> 
> 时间：2012-04-23T21:42:45.217
> 
> 标签：c, pointers, struct

解决一个问题，我必须使用 .

该文件被组织成有一个名称、几行以# 结尾的ASCII 艺术和一个等级。这是一个例子

```
Sample Name
( S )
( S )
# 5 
```

我的结构设置如下：

```
typedef struct
 {
   char* name;
   char* art;
   int rating;
 }CASE; 
```

当我编译我的源代码时，我不断收到以下警告：

```
multiple-character character constant
overflow in implicit constant conversion 
```

在这一行`buffer[artCount] = '/0';`上，artCount 是缓冲区本身的 strlen。

我只是在字符数组的末尾添加一个空字符来准备 strcpy。我这里的逻辑有问题吗？

功能：

```
/*CASE* all is an empty array of CASE structs*/
void readFile(FILE* FPin, CASE* all)
{
  CASE* walker = all;
  int count = 0;
  int artCount;
  char buffer[160];

  if((FPin = fopen("art.txt", "r")) == NULL)
  {
    printf("Error opening file.");
    exit(100);  
  }

 walker->name = (char*)malloc(sizeof(char)*100);

 /*Reads in the name*/
 while(fgets(walker->name, 100, FPin) != NULL)
  {

 /*Reads in the art*/
   while(fscanf(FPin, "%c", buffer) != '#');

   artCount = strlen(buffer);
   buffer[artCount] = '/0';
   walker->art = (char*)malloc(sizeof(char)*160);
   strcpy(walker->art, buffer);

/*Reads in the rating*/

     fscanf(FPin, "%d", &walker->rating);

   count++;
   walker++;
 } 

  fclose(FPin);
  return;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-23T21:46:05.210

常量应该是`'\0'`（带有反斜杠），而不是`'/0'`（带有正斜杠）。

# python - 使用 python 读取包含 json 数据的文件会引发我无法识别的错误

> ID：10288752
> 
> 赞同：4
> 
> 时间：2012-04-23T21:42:45.727
> 
> 标签：python, json

我有以下名为 json.txt 的 json 文件，其中包含以下数据，

```
{"id":99903727,"nickname":"TEST_MLA_OFF","registration_date":"2010-12-03T14:19:33.000-04:00","country_id":"AR","user_type":"normal","logo":null,"points":0,"site_id":"MLA","permalink":"http://perfil.mercadolibre.com.ar/TEST_MLA_OFF","seller_reputation":{"level_id":null,"power_seller_status":null,"transactions":{"period":"12 months","total":25,"completed":25,"canceled":0,"ratings":{"positive":0,"negative":0,"neutral":1}}},"status":{"site_status":"deactive"}} 
```

我使用 wget 获得了它。我尝试使用以下 python 代码用 python 加载该 json 数据，

```
json_data = json.load('json.txt')
data = json.load(json_data)
json_data.close()

print data 
```

但这会引发以下错误，

```
Traceback (most recent call last):
  File "json-example.py", line 28, in <module>
    main()
  File "json-example.py", line 21, in main
    json_data = json.load('json.txt')
  File "/opt/sage-4.6.2-linux-64bit-ubuntu_8.04.4_lts-x86_64-Linux/local/lib/python/json/__init__.py", line 264, in load
    return loads(fp.read(),
AttributeError: 'str' object has no attribute 'read' 
```

我找不到谷歌搜索错误的原因是什么。

最好的祝福。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-23T23:33:39.440

更好的做法是使用`with`语句。

```
with open('json.txt', 'r') as json_file:
    data = json.load(json_file) 
```

这可确保文件正确关闭，而无需您担心。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-23T21:45:34.037

您需要提供`json.load`一个文件流对象：

```
json_file = open('json.txt')
data = json.load(json_file)
json_file.close()

print data 
```

# asp.net-mvc-3 - MVC3 - 客户端验证

> ID：10288753
> 
> 赞同：0
> 
> 时间：2012-04-23T21:43:02.997
> 
> 标签：asp.net-mvc-3, validation, jquery-validate

即使文本区域为空白，我的表单也会发布到操作。在发布操作中，我将其设为空。

另外，我有一个 DI、存储库和服务架构。

我遵循了以下内容，但仍然没有运气。

[MVC3 客户端验证不起作用](https://stackoverflow.com/questions/4803108/mvc3-client-validation-not-working)

这是我到目前为止所拥有的：

**商业实体**

```
namespace Intranet.BusinessEntities
{
    public partial class AnnualReportMessage
    {
        public string Message { get; set; }   
        public int AnnualReportYear { get; set; }
        public string Fice { get; set; }
    }
}

**Following is in Validations Folder**

using System.ComponentModel.DataAnnotations;

namespace Intranet.BusinessEntities
{
    [MetadataType(typeof(AnnualReportMessageMetaData))]
    public partial class AnnualReportMessage
    {
        private class AnnualReportMessageMetaData
        {
            [Required]
            public string Message { get; set; }
        }
    }
} 
```

**布局中引用了以下2个**

```
<script type="text/javascript" src="@Url.Script("jqueryMain/jquery.validate.js")"></script>
<script type="text/javascript" src="@Url.Script("jqueryMain/jquery.validate.unobtrusive.min.js")"></script> 
```

**Wen.config（在全球范围内，不是特定区域）**

```
<add key="ClientValidationEnabled" value="true"/>
        <add key="UnobtrusiveJavaScriptEnabled" value="true"/> 
```

**页面上的 HTML，我只需要“消息”，为什么我看到其他字段的验证？**

```
<form action="/Sales/AnnualReportNote" id="AnnualReportMessage" method="post">
    <input name="__RequestVerificationToken" type="hidden" value="Q65zfJU+oSODE+qLj0Q0UpfaTId+ENEr+jucyhjWLbk1gnxY0QuTpu7R/lYOGtSxOYJwQkiPryCzgiTekyGikT/YrLQjF6hZXBhKkSF+UVzeAX2PuDrRoJR0pmWf5thL05LlAidHJtRcC3SHHGbxce5dqHSd1zIFpdQfQ3HPu10eUh55jMD4bn0cZeLReJ4P" />
    <input id="Fice" name="Fice" type="hidden" value="XXXXXX" />
    <input data-val="true" data-val-number="The field SetupYear must be a number." data-val-required="The SetupYear field is required." id="SetupYear" name="SetupYear" type="hidden" value="2012" />
    <input data-val="true" data-val-number="The field AnnualReportYear must be a number." data-val-required="The AnnualReportYear field is required." id="Message_AnnualReportYear" name="Message.AnnualReportYear" type="hidden" value="2012" />
    <input id="Message_Fice" name="Message.Fice" type="hidden" value="XXXXXX" />

    <textarea cols="70" data-val="true" data-val-required="The Message field is required." id="Message_Message" name="Message.Message" rows="12">
    </textarea>    

    <div class="distanceBottom"><span class="field-validation-valid" data-valmsg-for="Message.Message" data-valmsg-replace="true"></span></div>

    <input type="image" src="/App_Themes/Main/Images/ResponseAction/Buttons/btn_submit.gif" class="distanceTop" alt="Submit" id="SubmitButton" />
</form> 
```

**JavaScript**

```
formSubmit: function ($form, currentForm) {
        if ($form.validate().form()) {
            var $button = $("#" + AnnualReportSpecialEcMessage.enums.submitButtonId);

            jMessage("Processing request...", $button, true, false);
            $.ajax({
                cache: false,
                url: currentForm.action,
                type: currentForm.method,
                data: $form.serialize(),
                error: function (xhr, ajaxOptions, thrownError) {
                    jMessageError(xhr.responseText, $button, false, true);
                },
                success: function (result) {
                    if (result.IsError) {
                        jMessageError(result.Message, $button, false, true);
                    }
                    else {
                        jMessageOK(result.Message, $button, false, false);
                        jMessageHideInterval(3000); //hide after 3 seconds
                    }
                }
            });
        }
    } 
```

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:58:53.153

我认为你需要这样做：

```
[MetadataType(typeof(AnnualReportMessage.AnnualReportMessageMetaData))] 
```

您是否有不同的 AnnualReportMessageMetaData 类？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T07:44:42.463

用这个。它将删除 mvc 3 razor 中的默认验证方法。

```
 $(document).ready(function () {
   var form = $('#formId').get(0);
   $.removeData(form, 'validator');
 }); 
```

然后你的 jquery 验证代码就可以工作了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T18:56:59.823

是 jquery.validate.js 有问题。要么获取最新的，要么

代替

```
return $([]).add(this.currentForm.elements)
.filter(":input") 
```

和

```
return $(':input', this.currentForm) 
```

完整的工作件

```
elements: function() {
            var validator = this,
                rulesCache = {};

            // select all valid inputs inside the form (no submit or reset buttons)
            // workaround $Query([]).add until http://dev.jquery.com/ticket/2114 is solved
            //return $([]).add(this.currentForm.elements)
            //.filter(":input")
            return $(':input', this.currentForm)
            .not(":submit, :reset, :image, [disabled]")
            .not( this.settings.ignore )
            .filter(function() {
                !this.name && validator.settings.debug && window.console && console.error( "%o has no name assigned", this);

                // select only the first element for each name, and only those with rules specified
                if ( this.name in rulesCache || !validator.objectLength($(this).rules()) )
                    return false;

                rulesCache[this.name] = true;
                return true;
            });
        }, 
```

# python - 删除 numpy 数组末尾的 dtype

> ID：10288757
> 
> 赞同：14
> 
> 时间：2012-04-23T21:43:20.640
> 
> 标签：python, arrays, numpy

我正在编写一种从数据文件创建数组的方法。该方法如下所示：

```
import numpy
def readDataFile(fileName):
    try:
        with open(fileName, 'r') as inputs:
            data = None
            for line in inputs:
                line = line.strip()
                items = line.split('\t')
                if data == None:
                    data = numpy.array(items[0:len(items)]) 
                else:
                    data = numpy.vstack((data, items[0:len(items)]))
                return numpy.array(data)
    except IOError as ioerr:
        print 'IOError: ', ioerr
        return None 
```

我的数据文件包含多行数字，每行由制表符隔开，例如：

```
1 2 3
4 5 6
7 8 9 
```

我希望收到一个数组，如下所示：

```
array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]]) 
```

但是，结果包含`dtype`在它的末尾：

```
array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]], dtype='|S9') 
```

因此，我无法对结果执行某些操作，例如，如果我尝试使用 找到每行的最大值`result.max(0)`，我将收到错误消息：

> TypeError：无法使用灵活类型执行归约。

那么，谁能告诉我我的代码有什么问题以及如何修复它？非常感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T02:33:01.660

最简单的解决方法是使用 numpy 的 loadtxt：

```
data = numpy.loadtxt(fileName, dtype='float') 
```

仅供参考，`numpy.vstack`在循环内使用是个坏主意。如果您决定不使用`loadtxt`，您可以用以下内容替换您的循环以修复 dtype 问题并消除`numpy.vstack`.

```
data = [row.split('\t') for row in inputs]
data = np.array(data, dtype='float') 
```

更新

每次调用 vstack 时，它都会创建一个新数组，并将旧数组的内容复制到新数组中。这个副本大约是 O(n)，其中 n 是数组的大小，如果你的循环运行 n 次，整个事情就会变成 O(n**2)，换句话说很慢。如果提前知道数组的最终大小，最好在循环外创建数组并填充现有数组。如果您不知道数组的最终大小，可以在循环内使用列表并在最后调用 vstack。例如：

```
import numpy as np
myArray = np.zeros((10,3))
for i in xrange(len(myArray)):
    myArray[i] = [i, i+1, i+2]

# or:
myArray = []
for i in xrange(10):
    myArray.append(np.array([i, i+1, i+2]))
myArray = np.vstack(myArray) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-08-26T16:39:39.073

Numpy 数组包含一个方法来完成这项工作：

```
import numpy as np
a = np.array(['A', 'B'])
a
# Returns: array(['A', 'B'],  dtype='|S1')

a.tolist()
# Returns ['A', 'B'] 
```

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.tolist.html#numpy.ndarray.tolist](http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.tolist.html#numpy.ndarray.tolist)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-23T21:55:05.497

以下是在 numpy 中更改数据类型的方法：

```
>>> x
array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]])
>>> x.astype('|S9')
array([['1', '2', '3'],
       ['4', '5', '6'],
       ['7', '8', '9']], 
      dtype='|S9')
>>> x.astype('Float64')
array([[ 1.,  2.,  3.],
       [ 4.,  5.,  6.],
       [ 7.,  8.,  9.]])
>>> x.astype('int')
array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]]) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-23T21:48:17.960

...您是否尝试先将它们变成数字？

```
items = [int(x) for x in line.split('\t')] 
```

# php - 如何使 apache 与 Outlook 一起工作？

> ID：10288760
> 
> 赞同：0
> 
> 时间：2012-04-23T21:43:51.413
> 
> 标签：php, outlook

我有一个使用 com 连接到 Outlook 的小型控制台应用程序。

我的控制台应用程序旨在从 php 代码调用。当我在我的本地开发盒上尝试时它工作正常，当我从命令行尝试在服务器上它工作得很好但是当我尝试从 php 代码调用它时它无法工作。

这是我到目前为止所做的吗？

我是软件开发的新手，从我能想到的来看，我查看了配置文件，没有什么特别突出的，而且 httpd.exe 在开发盒和产品中作为系统用户运行，所以很好。

我是否遗漏了任何事情，任何指向正确方向的工作都是有帮助的，非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:53:45.797

如果它适用于您的开发服务器，但不适用于您的生产服务器，这听起来像是 Apache 用户无权在命令行执行的权限问题。这也可能是由于您的生产服务器上的 php 配置（请参阅您的 php.ini 文件）。

# ms-access - MSaccess 如何导出链接表 ODBC 连接构建以进行源代码控制，（包括表关系）

> ID：10288761
> 
> 赞同：4
> 
> 时间：2012-04-23T21:43:55.773
> 
> 标签：ms-access, version-control, development-environment

我想将我的 Microsoft Access 数据库前端移动到源代码控制中，以便于保存和部署以及对更改进行一些控制。我正在使用这个问题的代码来导出查询、表单、宏、报告，但不是表格。

必须有一种通过 vbscripts 的方法，我可以导出链接表构建过程并将其放回原处。

有没有人知道任何可以轻松让我导出链接表的内容。

（如果我可以构建链接到文本文件的表并从那里操作连接字符串，那么将链接表更改为链接到开发服务器会更容易。）

[如何在 Access 开发中使用版本控制？](https://stackoverflow.com/questions/187506/how-do-you-use-version-control-with-access-development)

或者问题也可能是，如何在不弄乱计算机的 odbc dns 连接的情况下轻松更改链接表连接源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:07:38.967

您没有指定是否使用`.mdb`或`.accdb`文件。
我从来没用过`.accdb`，所以我只能告诉你`.mdb`：

每个`.mdb`文件都有一个名为`MSysObjects`.
它包含**所有**对象，包括表单和报告等，但您可以过滤`Type`列以仅获取表格：

*   类型 = 1 --> 本地表
*   类型 = 4 --> ODBC 链接表
*   Type = 6 --> 来自其他 Access 数据库的链接表

有四列`MSysObjects`包含您需要的所有内容：

*   `Connect`--> ODBC 连接字符串（如果通过 ODBC 连接）
*   `Database`--> 源 Access 数据库的路径（如果链接到另一个 Access 数据库）
    *（你可能不需要这个，因为你说你正在使用 ODBC——为了完整起见，我还是把它包括在内）*
*   `Foreign name`--> 源数据库中表的原始名称
*   `Name`--> 此数据库中链接表的名称

这就是重新链接表格所需的所有信息。
您不需要为此弄乱计算机的 ODBC DSN……事实上，您根本不需要计算机上的 DSN。

这是一个如何执行此操作的快速示例：
[VBA Code to Add Linked Table with Primary Key](https://stackoverflow.com/questions/9602687/vba-code-to-add-linked-table-with-primary-key/9649566#9649566)

# java - ICEfaces - 如何重新定义组件的样式？

> ID：10288768
> 
> 赞同：0
> 
> 时间：2012-04-23T21:44:23.160
> 
> 标签：java, css, icefaces

有没有办法重新定义 ICEfaces 组件的样式？例如，如果我想拥有

```
<ace:panel> 
```

蓝色背景，蓝色标签

```
<ace:submenu...> 
```

ETC。？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T09:11:59.197

您可以使用 style/styleClass 参数设置 <ace:panel> 样式：<ace:panel style="background-color:blue">

如果你想设置像 <ace:submenu> 这样的元素的样式，你应该查看（例如在 firebug 中）该组件中使用了哪些 css 类（例如 ui-widget-header 类）并在你的 css 文件中覆盖它。

# jquery - 具有客户端模板的理想解决方案结构

> ID：10288777
> 
> 赞同：0
> 
> 时间：2012-04-23T21:45:04.460
> 
> 标签：jquery, asp.net-mvc, jquery-templates

使用 ASP.NET MVC 的客户端模板的理想解决方案结构是什么？

客户端模板定义代码会位于 View 文件夹下吗？如果是这样，这些文件应该是 ascx 还是 cshtml ？两者有什么区别 ？

如果我想在 View 之间使用 JSONResult ，我还应该使用 View Model 吗？我可以只创建匿名类型并转换为 JSON 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:47:14.273

每当我使用客户端模板时，我总是使用以 JSON 形式返回的匿名类型。我也使用直接的 html 文件，因为不需要 Razor 或 ASP.Net，我将它们放在 /Content/ 某处的子文件夹中。

# objective-c - 单击时显示来自 NSTokenField 令牌的 NSPopover

> ID：10288781
> 
> 赞同：0
> 
> 时间：2012-04-23T21:45:23.607
> 
> 标签：objective-c, macos, cocoa, nstokenfield, nspopover

单击令牌时，我试图`NSPopover`从令牌中显示一个。`NSTokenField`

这些令牌具有显示菜单的内置方式，因此从设计的角度来看，它与该操作没有什么不同。

但是，单击令牌时似乎没有任何（好的）方法来执行任意代码。

我*已经*设法将一些代码滑入`- tokenField:menuForRepresentedObject:`，但它远非优雅。

假设这`- tokenField:menuForRepresentedObject:`是单击标记时执行代码的唯一方法，我还有另一个问题：获取`NSRect`表示标记的 ，以便`NSPopover`可以与所述标记保持视觉关系。我试图做一些字符串杂耍，弄清楚令牌是如何出现的，等等，但它远非可靠，甚至需要一个未记录的方法。

**底线：**如何在 中显示`NSPopover`来自所选标记的`NSTokenField`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T00:20:02.977

我认为这是不可能的（请参阅我的努力[）](https://stackoverflow.com/questions/8618345/nstokenfield-and-deleting-tokens/8626374#8626374)。问题是单个令牌没有以您可以引用其边界以便将其与弹出框挂钩的方式公开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T00:37:43.990

这就是我最终做的。`NSTokenField`我正在开发一种内置此功能的开源替代方案。

```
// in an NSWindowController
- (NSMenu *)tokenField:(NSTokenField *)tokenField menuForRepresentedObject:(id)representedObject
{
    NSRect displayRect = NSMakeRect(([NSEvent mouseLocation].x - 2.5),
                                    ([NSEvent mouseLocation].y - 2.5),
                                    5, 5);
    displayRect = [self.window convertRectFromScreen: displayRect];

    // establish popover from displayRect ...
} 
```

它*看起来*非常棒，尽管感觉很受黑客攻击（并且偶尔会被 1px 关闭）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-06T06:04:48.040

另一种选择是使用 NSMenuItem 的能力来支持任意视图：

```
- (NSMenu *)tokenField:(NSTokenField *)tokenField menuForRepresentedObject:(id)representedObject {
    NSMenu *menu = [[NSMenu alloc] init];
    NSMenuItem *item = [NSMenuItem alloc] init];
    [item setRepresentedObject: representedObject];

    NSNib *nib = [[NSNib alloc] initWithNibNamed: @"token" bundle: nil];
    [nib instantiateWithOwner: item topLevelObjects: nil];

    [menu addItem: item];
    return menu;
} 
```

然后，您可以创建一个用户界面，其中文件所有者是一个 NSMenuItem，并且它连接到一个自定义视图，其中包含您在 Popover 中想要的所有内容。您可以使用代表对象绑定到笔尖中的值。

我正处于这样做的早期阶段。我还没有将我的 NSManagedObjects 连接到令牌字段，而且我只是使用字符串数组进行测试，但是这样做确实会得到类似 Popover 的效果，除了小角指针。似乎比我在研究这个时看到的许多其他黑客更好和更简单。

# java - Java/Swing - 如何减小 JDialog 构造函数的大小？

> ID：10288784
> 
> 赞同：1
> 
> 时间：2012-04-23T21:45:39.960
> 
> 标签：java, swing, user-interface, constructor

我正在用 Java 构建一个图形用户界面，我想知道是否有人可以给我一些指导。具体来说，当单击此 GUI 中的按钮时，会打开一个大 JDialog（它是一个扩展 JDialog 的类），供用户输入一些信息、查看一些信息、单击一些东西等。

此类中有多个 JLabel 和其他组件。我的问题是如何创建这样一个实例？现在我在构造函数中拥有一切，使它成为一个 500(!) 行的构造函数。必须有替代方案！构造函数包含大约 300 行组件放置和设置的代码，另外还有 200 行用于监听器给予或接受的代码。

另一个想到的问题是，现在我通过调用从另一个班级打开这个窗口

MyClassExtendsJDIalog temp = new MyClassExtendsJDIalog();

但我在创建它的类中根本不使用这个“temp”变量，因为“temp”的构造函数做了一切。似乎我再次以错误的方式做事。

感谢您阅读本文。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T21:54:34.747

如果您想拆分代码以使其更具可读性和可管理性，您可以始终将字段分组到 JPanel 的子类中，即 Panel1、Panel2 等，然后只需将它们添加到 JDialog 子类构造函数中。但是在 Swing 中设置 GUI 需要很多行，是的......

至于没有使用的临时变量，我猜你在构造函数中调用了 show() ？通常我不会这样做，而是在创建对话框的代码中调用它，即。

```
MyDialog dialog = new MyDialog();
dialog.setVisible(true); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-23T22:05:27.190

如果没有看到您的代码，就很难为您提供有关如何改进代码和设计的具体提示。

我同意，你的构造函数中大约 500 行直观地感觉像是一个问题。至少，您可能希望将其中的一些工作推迟到创建实例之后。将其转化为一种`init()`方法（或一系列方法）是一种方法。

您可能还需要考虑设计您的类，使其包含一个 JDialog 而不是扩展一个（有关此主题的讨论，请参阅[Composition over继承](http://en.wikipedia.org/wiki/Composition_over_inheritance)）我怀疑否则您会将多个类的关注点混为一谈。

最后，您可能想查看[Java Swing 教程](http://docs.oracle.com/javase/tutorial/uiswing/)，了解创建基于 Swing 的用户界面的一般提示和技术。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-23T22:16:05.943

是的，你做错了什么，但你在好（或坏）的公司。

您应该将良好的 OO 设计规则和干净的代码应用于您的 Swing 类，就像其他任何东西一样。

如果不查看 300 多行代码（我真的不想看到 ;-)，就很难知道你到底能做什么，但这里有一些可能适用的东西。

我的主要设计规则是单一职责原则。根据您的描述（和我的猜测），您在构造函数中执行以下操作：

```
* creating (including configuring) components

* placing them in some kind of layout

* registering Listeners

* implementing Listners 
```

这是 4 个完全不同的问题。

经过大量重构后，您可能会得到如下结果：

您可能希望有一个工厂来创建您的组件。

您可能有一个 Layouter 类，它接受一个组件或一组组件（如标签加上匹配的文本框）并将它们放置在面板上。

您可能有一个类接收组件（可能还有模型或其他）并使用侦听器将它们连接在一起。

一个通过所有这些的类以合适的方式使用它，并吐出一个带有面板的 JDialog，所有组件都打开。

注意：理想情况下，不再扩展 JDialog。如果您打算构建一个新的 Swing 组件，您应该只扩展 Janything。

这个例子使用的是 Scala，但它仍然应该提供一些灵感：http: [//blog.schauderhaft.de/2011/06/26/clean-code-with-swing-and-scala/](http://blog.schauderhaft.de/2011/06/26/clean-code-with-swing-and-scala/)

# ruby-on-rails - 使用 rspec-mode 从 emacs 运行时，rspec 请求规范失败

> ID：10288785
> 
> 赞同：1
> 
> 时间：2012-04-23T21:45:44.007
> 
> 标签：ruby-on-rails, emacs, rspec

当我使用 rspec-mode 从 emacs 运行某些 rspec 请求规范时，我收到以下错误：

dyld：惰性符号绑定失败：找不到符号：_system_free 引用自：/Users//.rvm/gems/ree-1.8.7-2011.03@/gems/nokogiri-1.5.2/lib/nokogiri/nokogiri.bundle 预期在: 平面命名空间

当我从命令行运行相同的规范时，它运行得很好。想知道是否有人知道在通过 emacs 运行 rspec 请求规范时为什么会出现错误消息的原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T20:02:44.470

按照 rspec-mode 项目主页上的建议，我可以通过强制 emacs 使用 bash shell 而不是 zsh 来解决这个问题。我在这里复制该信息：

如果您使用 ZSH 和 RVM，您可能会遇到运行规范的问题。可能是因为使用了比您在 .rvmrc 中指定的旧版本的 Ruby。这是因为 ZSH 每次创建 shell 时都会运行一个小脚本，该脚本会修改 $PATH。问题是它预先添加了一些默认路径，例如 /usr/bin，其中包含另一个 ruby​​ 二进制文件。

你可以做些什么来解决这个问题是使用 BASH 来运行规范。这段代码完成了这项工作：

```
(defadvice rspec-compile (around rspec-compile-around)
  "Use BASH shell for running the specs because of ZSH issues."
  (let ((shell-file-name "/bin/bash"))
    ad-do-it))
(ad-activate 'rspec-compile) 
```

# scala - 如何使用 traverse TypeClass 根据元素累积状态，然后映射到状态和元素？

> ID：10288786
> 
> 赞同：3
> 
> 时间：2012-04-23T21:45:56.683
> 
> 标签：scala, functional-programming, iterator

我应该传递给“遍历”的函数是什么（从迭代器模式的本质出发），这样我就可以根据每个原始元素累积状态，然后根据原始元素和迄今为止的状态进行映射。

在“收集”和“分散”中，只有映射取决于状态或状态取决于元素，但不能同时取决于两者。

[http://etorreborre.blogspot.co.uk/2011/06/essence-of-iterator-pattern.html](http://etorreborre.blogspot.co.uk/2011/06/essence-of-iterator-pattern.html)上的表格似乎说我应该使用“遍历”，但遍历是实现所有其他函数的函数，所以我有点失落。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T23:35:13.367

当您将该`traverse`方法与返回 a 的函数一起使用时`State`，您将得到您想要的：

```
 // a function using the current element and the previous state
   def function[S, T](s: S, t: T): R = // combine T and S

   // return a State instance to use as an Applicative with traverse
   def myState[T, S](t: T) = State[S, R]((s: S) => function(s, t))

   // a sequence to traverse
   val sequence: Seq[T] = ...

   // use the traverse method
   sequence.traverse(t => myState(t)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T09:30:52.557

我想做的一个例子：

```
main = putStrLn $ show $ runState s 0
    where 
        s = traverse f [1,2,3,4,5]
        f = \x -> state( \y -> (x*20+y, y+x) ) 
```

结果是`([20,41,63,86,110],15)`

# asp.net-mvc-3 - 使用 MVC3，如何让浏览器将传输的脚本显式解释为 HTML？

> ID：10288789
> 
> 赞同：0
> 
> 时间：2012-04-23T21:46:09.523
> 
> 标签：asp.net-mvc-3, c#-4.0, html-parsing, response.contenttype

在我的 MVC 应用程序中，我返回了一些 Javascript。但是，我在视图上使用了防伪令牌，因此渲染结果将是

```
<input name="__RequestVerificationToken" type="hidden" value="E8as+4Ff1u/c/+kuFcNXXCREB5pz5GAfH2krN5RvzURJaHZSApuRc4czZqmoITaKdy0XhN5sFfRzl4ne+wB3PkWOscBWzoIxUk3hGaFwDxRXSbMs8K9IwojEAtV5u57MR7hiSujr6MOTpjjbf5FPaYgO4gmH6lSR9mbSyO2IedI=" />

<script type="text/javascript">
   // Here, we ensure that jQuery is loaded then load up the rest of our JS in in order.
   ord = Math.random() * 10000000000000000;
   ... 
```

所以有一些HTML要添加到页面然后是JS。

问题是我在 Chrome 中收到以下通知：

> 资源解释为脚本，但以 MIME 类型传输

我需要浏览器将其解释为 HTML，以便使用防伪令牌。

我试过把它放在视图上：

```
<%@Page Title="" Language="C#" ContentType="text/xml" %> 
```

呈现：

```
<%System.Web.WebPages.DynamicPageDataDictionary`1[System.Object] Title="" Language="C#" ContentType="text/xml" %>

<input name="__RequestVerificationToken" type="hidden" 
... 
```

...但同样的信息仍然存在。

在我的控制器中，我也尝试过：

```
 System.Text.ASCIIEncoding encoding = new System.Text.ASCIIEncoding();
        Byte[] bytes = encoding.GetBytes(page.clientScript);

        return new ContentResult
        {
            ContentType = "text/xml", // also tried text/html
            Content = Encoding.UTF8.GetString(bytes),
            ContentEncoding = System.Text.Encoding.UTF8
        }; 
```

同样的问题。

**- 更新 -**

这就是我调用 MVC 应用程序以返回文本的方式：

```
 // used to load scripts on to the client script using a non-blocking asynch request
  (function() {
  function async_load(){
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = 'http://myserver/MyAppPath/someids';
  var x = document.getElementsByTagName('script')[0];
  x.parentNode.insertBefore(s, x);
  }
  if (window.attachEvent)
  window.attachEvent('onload', async_load);
  else
  window.addEventListener('load', async_load, false);
  })(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:45:38.473

如果我理解正确，您需要一个 MVC 操作，它返回 html 和可以通过`<script...`包含注入页面的脚本标记。您还想通过 MVC 视图呈现它。

您错过的最大问题是，为了将此内容放入调用页面，您需要`document.write`从脚本执行 - 您不能只发回 HTML 和脚本以响应脚本包含 - 浏览器不会理解它，它只需要javascript。

有几种方法可以做到这一点 - 我已经编写了一整套MVC 控制器方法，具有与将视图结果作为字符串返回到控制器操作`ViewContent`相同的重载。`View`然后我可以将它作为字符串文字（对生成 html 电子邮件很有用）传回，也可以传回 javascript 编码器。

在这种情况下，您不需要如此通才。我们可以利用 Darin Dimitrov 对此 SO 的回答：[将 MVC 部分视图嵌入到 document.write JS 调用中](https://stackoverflow.com/questions/8422339/embed-mvc-partial-view-into-a-document-write-js-call)，并将您的视图拆分为视图和部分视图。视图写`document.write()`骨架，局部视图渲染你想要注入页面的动态html。不清楚您是在主视图中使用将调用脚本的 Anti Forgery 令牌（在这种情况下，它应该作为它返回的视图的一部分呈现），或者您是否实际上在脚本中对其进行硬编码. 第二个绝对不应该使用，但我写这个答案好像是这样，因为这似乎是你想要的。

一、你的局部视图（姑且称之为`Fragment.cshtml`，放入`~/Views/Shared`）

```
<input name="__RequestVerificationToken" 
type="hidden"value="[ommitted]" /> 

<script type="text/javascript"> 
// Here, we ensure that jQuery is loaded then load up the rest of our JS in in order. 
ord = Math.random() * 10000000000000000; 
... 
```

二、主机视图，调用`SomeIds.cshtml`

```
 @{ Response.ContentType = "text/javascript"; }
 document.write('@Html.Raw(HttpUtility.JavaScriptStringEncode(Html.Partial("~/Views/Shared/Fragment").ToHtmlString()))') 
```

现在，此视图返回一个`document.write`调用，该调用将返回的 HTML 注入`Fragment.cshtml`到包含该脚本的页面中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:47:28.067

您是否返回一个已呈现所有标记的 PartialView？

使用您的（包括表单和脚本）和您的控制器创建一个 PartialView：

```
 public ActionResult Index(Models.MyModel model) 
    {
        // validate the model if needed
        return PartialView("[My PartialView Name]", model);
    } 
```

您可以将脚本放在单独的文件中，并在 PartialView 中添加 [script src] 标签。

# python - Jinja2 块标签可以使用可选参数吗？

> ID：10288791
> 
> 赞同：1
> 
> 时间：2012-04-23T21:46:17.187
> 
> 标签：python, jinja2

我可以编写一个可能带或不带单个参数的 Jinaj2 块标签吗？

例如，这两个调用都是有效的：

```
{% some_tag "one arg" %} 
```

和

```
{% some_tag %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T02:13:03.367

我不明白你试图完成什么，但你可以使用默认值：

```
{% ....... |default('no_argument') %} 
```

# api - ModelState.AddModelError

> ID：10288793
> 
> 赞同：0
> 
> 时间：2012-04-23T21:46:34.083
> 
> 标签：api, web, asp.net-mvc-4

我错过了什么吗？我正在尝试从我的 web api 更新方法中返回模型验证错误，如下所示

```
public void Update  public void UpdateModel(Models.Model entity) {
        ModelState.AddModelError("name","error");
        return; 
```

但是返回的 JSON 没有验证错误

例如在本文中[输入链接描述here](http://blog.duc.as/tag/asp-net-web-api/)

当我尝试在此链接上的上一篇文章中使用验证过滤器时，我收到错误 Action xxxxx has an or more filters applied 不是从 AuthorizationFilterAttribute 派生的。DataController 插入/更新/删除操作仅支持授权过滤器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:49:23.003

`ModelState`除非您专门将其序列化，否则无法从您的 JSON 访问。它更多地用于`HtmlHelper`幕后的扩展。如果您尝试更新 UI，就好像模型状态被标记为这样，那您就大错特错了。您可以：

1.  向服务器发送完整的帖子并让它呈现适当的响应
2.  获取您返回的 json，然后根据该响应设置字段的样式。

# c# - 在实体框架中，您将如何对连接表执行“IN”查询？

> ID：10288794
> 
> 赞同：0
> 
> 时间：2012-04-23T21:46:45.057
> 
> 标签：c#, sql, linq, entity-framework

我是一个 SQL 迷，EF 的语法对我来说并不直观。

我有一张餐厅桌和一张食物桌。我想要那些食物的类型包含在字符串列表类别中的餐馆和食物。这是一些大致代表我想要的SQL。

```
SELECT r.*, f.*
FROM Restaurant R
  JOIN food f on f.RestaurantID = r.RestaurantID
WHERE f.Type IN ("Awesome", "Good", "Burrito") 
```

这是我想转换成该 SQL 的代码。

```
List<string> types = new List<string>() { "Awesome", "Good", "Burrito"};
var dbrestaurants = from d in db.Restaurants
                    .Include("Food")
                    //where Food.Categories.Contains(types)//what to put here?
                    select d; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:00:36.327

尝试

```
var restaurants = db.Restaurants.Where(r => types.Contains(r.Food.Type)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:48:31.750

```
where Food.Categories.Any(c => types.Contains(c.Name)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T14:08:30.833

尝试这个：

```
var dbRestaurants = 
from r in db.Restaurants
join f in db.Foods on r.RestaurantId equals f.RestaurantId
where types.Any(foodType => foodType == f.Type)
select r; 
```

# c# - ASP.NET 中的 GridView 不显示有或没有数据

> ID：10288800
> 
> 赞同：8
> 
> 时间：2012-04-23T21:47:28.207
> 
> 标签：c#, asp.net, gridview

我正在添加一个 GridView，然后从 SQL Server 数据库中显示其中的数据。问题是 GridView 没有在浏览器中显示有或没有数据。

这是我的代码：

```
<asp:GridView ID="GridAllStore"  runat="server" AutoGenerateColumns="False" Width="100%"  ViewStateMode="Enabled"> 
```

```
public partial class AdminPanel : System.Web.UI.Page
{
    storelocatorDataSetTableAdapters.storedbTableAdapter tastore = new storelocatorDataSetTableAdapters.storedbTableAdapter();
    storelocatorDataSetTableAdapters.View_1TableAdapter taview = new storelocatorDataSetTableAdapters.View_1TableAdapter();

    List<storelocatorDataSet.storedbRow> lststore = new List<storelocatorDataSet.storedbRow>();
    List<storelocatorDataSet.View_1Row> lstview = new List<storelocatorDataSet.View_1Row>();
    protected void Page_Load(object sender, EventArgs e)
    {
        lstview = taview.GetData().ToList();
        GridAllStore.DataSource = lstview; 
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-23T22:04:17.777

我认为问题在于您尚未定义要显示的任何列。当您设置`AutoGenerateColumns`为 false 时，您必须明确定义列。

为了确保基础工作设置`AutoGenerateColumns`为 true：

```
<asp:GridView ID="GridAllStore"  runat="server" AutoGenerateColumns="true" Width="100%"  ViewStateMode="Enabled"> 
```

设置为 true ，`AutoGenerateColumns`分配并`DataBind()`调用数据源，您应该开始看到一些数据。开始查看数据后，您可以定义要显示的特定列。

由于您只需要在第一个页面加载时绑定网格，因此利用以下`!Page.IsPostBack`条件：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        GridAllStore.DataSource = lstview;
        GridAllStore.DataBind();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T22:03:33.593

将您的代码更改为：

```
protected void Page_Load(object sender, EventArgs e)
{
    lstview = taview.GetData().ToList();
    GridAllStore.DataSource = lstview; 
    GridAllStore.DataBind();
} 
```

并将您的 GridView 标记更改为：

```
<asp:GridView ID="GridAllStore"  runat="server" AutoGenerateColumns="True" Width="100%"  ViewStateMode="Enabled" /> 
```

注意到现在是这样，`AutoGenerateColumns="True"`因为这将显示数据并生成列。您可能需要自定义显示的内容。要做到这一点，由于您现在并不真正知道自己在做什么，因此切换到设计视图，您可以编辑 gridview 模板。

查看这篇文章以获取有关自定义输出的列和数据的一些帮助。[http://msdn.microsoft.com/en-us/library/bb288032.aspx](http://msdn.microsoft.com/en-us/library/bb288032.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-23T21:50:22.660

您是否尝试在设置 Datasource 后立即添加以下行？

```
GridAllStore.DataBind(); 
```

# android - Sencha 2 无法将 html 文件加载到 Android 4.0 上的面板中

> ID：10288817
> 
> 赞同：0
> 
> 时间：2012-04-23T21:48:24.413
> 
> 标签：android, cordova, sencha-touch-2

ajax 加载程序有一个 Sencha 2 错误。

```
onActivate : function(result, container) {
            Ext.Ajax.request({
                        url : this.getUrl(),
                        method : 'GET',
                        success : function(response, request) {
                            result.setHtml(response.responseText);
                        },
                        failure : function(response, request) {
                            console.log("Failed: " + response);
                        }
                    });
        } 
```

在 Android 2.2、2.3、IOS 上我没有问题。Android 4.0 有一些问题将其加载到面板中。

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:00:20.060

好的，自己解决了。

Ext.Ajax.request 中存在异步问题：

```
onActivate : function(result, container) {
            $.get("resources/web/about.html", function(data) {
                result.setHtml(data);
            });
        } 
```

希望它可以帮助那些因同样问题而烦恼的人。

# node.js - node.js tcp 套接字断开处理

> ID：10288818
> 
> 赞同：2
> 
> 时间：2012-04-23T21:48:24.950
> 
> 标签：node.js

我正在建立一个到 XMPP 服务器的 TCP 客户端套接字连接，并且需要一种可靠的方法来检测连接中断（例如服务器崩溃、重新启动等）。我在结尾、错误和关闭事件上附加了侦听器，但是当我在活动连接期间切断互联网连接时，它们不会可靠地触发。我的客户端如何检测到连接何时断开？我宁愿不诉诸ping/超时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T22:28:29.837

我绝不是 TCP 或套接字编程方面的专家，但我很确定不存在“检测连接中断的可靠方法”。参见例如[这个 Unix.com 线程](http://www.unix.com/programming/78097-can-not-detect-tcp-disconnects-well.html)。

在节点中，您的选项似乎是[socket.setTimeout](http://nodejs.org/api/net.html#net_socket_settimeout_timeout_callback) / [socket.on('timeout', callback)](http://nodejs.org/api/net.html#net_event_timeout)和/或[socket.setKeepAlive](http://nodejs.org/api/net.html#net_socket_setkeepalive_enable_initialdelay)。

**编辑：**这是关于[TCP keepalive](http://tldp.org/HOWTO/TCP-Keepalive-HOWTO/overview.html)的指南。

# python - 使用文件系统编码对 unicode 路径进行编码会破坏它

> ID：10288821
> 
> 赞同：2
> 
> 时间：2012-04-23T21:48:36.820
> 
> 标签：python, unicode, mbcs

我在内存中确实有以下路径：

```
video_path = u'C:\\Documents and Settings\\user\\My Documents\\Downloads\\\xf5iv - Neon Phoenix [Free DL].mp3' 
```

我正在尝试将其用作 cmd 中的参数，因此我必须对其进行编码。

```
video_path = video_path.encode(sys.getfilesystemencoding())
cmd = 'ffmpeg -y -i "%s" -vn -ac 2 -f mp3 audio.mp3' % video_path
subprocess.Popen(cmd) 
```

但是，字符串没有以正确的方式编码 - 它转换为`\xf5`to`?`而不是`õ`. 因此找不到该文件。

这怎么可能发生？我正在使用默认的文件系统编码（即 mbcs）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T05:18:54.317

[从这里](https://stackoverflow.com/questions/1910275/unicode-filenames-on-windows-with-python-subprocess-popen)的答案：

> 在 Py3K 中 - 至少来自“Python” 3.2 - subprocess.Popen 和 sys.argv 与 Windows 上的（默认 unicode）str 一致。显然使用了 CreateProcessW 和 GetCommandLineW。
> 
> 在 Python 中 - 至少到 v2.7.2 - subprocess.Popen 带有 unicode 参数。它坚持 CreateProcessA （而 os.* 与 unicode 一致）。并且 shlex.split 会产生额外的废话。Pywin32的win32process.CreateProcess也不会自动切换到W版本，也没有win32process.CreateProcessW。与 GetCommandLine 相同。因此需要使用 ctypes.windll.kernel32.CreateProcessW...。subprocess 模块可能应该解决这个问题。

因此，`subprocess.Popen`无法在 Python 2.x 版本中处理 unicode。

我的解决方案是将输入文件重命名为随机文件（使用`os.rename`，支持 unicode），使用`ffmpeg`我启动的文件进行转换`subprocess.Popen`，然后将其重命名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T21:53:11.897

尝试使用 UTF-8 进行编码：

```
video_path = video_path.encode("utf-8") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T03:44:42.083

除非我完全弄错了，否则中的双反斜杠

```
video_path = u'C:...\\xf5iv...' 
```

导致问题。应该只有一个：

```
video_path = u'C:...\xf5iv...' 
```

否则，反斜杠将保留为反斜杠并留给`os.system()`，而不是`.encode()`，来处理。

# python - PyCUDA 安装时出错

> ID：10288823
> 
> 赞同：1
> 
> 时间：2012-04-23T21:48:44.020
> 
> 标签：python, pycuda

我尝试使用以下说明安装 PyCUDA：[http](http://wiki.tiker.net/PyCuda/Installation/Linux) ://wiki.tiker.net/PyCuda/Installation/Linux ，在第 3 点我正在编译：

```
su -c "make install" 
```

从控制台获得以下输出：

```
running install
running bdist_egg
running egg_info
writing requirements to pycuda.egg-info/requires.txt
writing pycuda.egg-info/PKG-INFO
writing top-level names to pycuda.egg-info/top_level.txt
writing dependency_links to pycuda.egg-info/dependency_links.txt
reading manifest file 'pycuda.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
writing manifest file 'pycuda.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
running build_ext
building '_driver' extension
gcc -pthread -DDYNAMIC_ANNOTATIONS_ENABLED=1 -fwrapv -Wall -g -fPIC -DPYGPU_PACKAGE=pycuda -DHAVE_CURAND=1 -DBOOST_PYTHON_SOURCE=1 -DPYGPU_PYCUDA=1 -DBOOST_MULTI_INDEX_DISABLE_SERIALIZATION=1 -Dboost=pycudaboost -Isrc/cpp -Ibpl-subset/bpl_subset -I/usr/local/cuda/include -I/usr/lib/python3.2/site-packages/numpy/core/include -I/usr/lib/python3.2/site-packages/numpy/core/include -I/usr/include/python3.2mu -c src/cpp/cuda.cpp -o build/temp.linux-x86_64-3.2/src/cpp/cuda.o
Inf ile included from src/cpp/cuda.cpp:1:0:
src/cpp/cuda.hpp:12:18: fatal error: cuda.h: No such file or directory
compilation terminated.
error: command 'gcc' failed with exit status 1 
```

我应该怎么办？

编辑：我的操作系统是：Arch Linux 3.3.2.1。显卡：英伟达 GF 9600M GS

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T21:50:50.060

而不是`su -c "make install"`尝试`sudo su -`（成为root），然后以root身份：（`make install`导航到正确的目录后）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-12-12T18:10:11.567

这个完整的命令对我有用：

```
sudo pip3 install --global-option=build_ext --global-option="-I/usr/local/cuda/include" --global-option="-L/usr/local/cuda/lib64" pycuda 
```

# gwt - 检测 GWT 应用程序是否过时并自动刷新浏览器的优雅方法？

> ID：10288824
> 
> 赞同：9
> 
> 时间：2012-04-23T21:48:46.470
> 
> 标签：gwt, gwt-rpc

在许多支持案例之后，我们意识到我们基于 GWT 的应用程序的最大问题是用户一次将其打开数周。这意味着当我们每周或每周进行一次修补程序时，RPC 存根不同步并导致引发静默异常，从而使站点看起来“损坏”。有人知道自动检测和避免这个问题的方法吗？我的一些想法是......

1.  在捕获 RPC 不匹配异常时刷新浏览器。
2.  当加载主机页面时，在源代码控制中注入版本号，构建来自，有一个状态检查器/计时器来检查数字没有改变。当它重新加载时。
3.  在任意计时器上重新加载（可能每天两次）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T18:43:28.397

我想提出第四个选项。

创建一个 RPC 代理和 UI 对象代理，所有 UI 请求和 RPC 请求都通过该代理进行路由。这样，只要此代理检测到某些内容已过时，它就可以动态加载小部件或更改其预期的 RPC 模型。

这就是 Vaadin 做事的方式，而且效果很好。Vaadin 是一个基于 GWT 构建的 UI 工具包，以防您不知道。在过去的几年里，我们有几个长期运行的生产应用程序使用它，我们对它们的 UI Def 语言 (UIDL) 进行了一些调整以添加版本不匹配。

该图很好地代表了他们的工作，如果您不想自己构建类似的东西，我当然建议您迁移到 Vaadin。

![Vaadin 客户端架构](../Images/594dd7fbb1bb26e5c1a41a13b3fa4c0e.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-22T19:04:28.083

实施在空闲时间一小时后将用户注销的安全性。假设您的发布是在夜间或周末发布的，那么用户会在发布后登录。无需刷新应用程序。这是可行的，特别是如果您的网站最终需要用户登录。

# mysql - MySQL：如何原子地修改存储过程？

> ID：10288826
> 
> 赞同：6
> 
> 时间：2012-04-23T21:48:49.323
> 
> 标签：mysql, stored-procedures, distributed-system

我在互联网上进行了搜索，了解到更改存储过程主体的唯一方法是删除并再次创建它。该机制似乎没有任何问题，但如果我有一个客户端应用程序（或数千个分布式客户端）不断调用存储过程以更新服务器数据库上的某些数据，则删除该过程将导致数据丢失和/或损坏。

我在想是否有像“CREATE PROCEDURE IF EXIST ...”这样的语法或类似的功能，这样更新操作就会顺利进行。然而，我没有发现 MySQL 中提供了这样的东西。

那么大家觉得这个问题怎么解决呢？很棒的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T21:59:44.500

您不能修改 MySQL 中的存储过程（尽管您可以更改其特征）。从[`ALTER PROCEDURE`](http://dev.mysql.com/doc/refman/5.6/en/alter-procedure.html)页面。

> 此语句可用于更改存储过程的特性。在 ALTER PROCEDURE 语句中可以指定多个更改。但是，您不能使用此语句更改存储过程的参数或主体；要进行此类更改，您必须使用 DROP PROCEDURE 和 CREATE PROCEDURE 删除并重新创建过程。

虽然执行此更新时可能会丢失数据（尽管它应该是一个相对较小的窗口），但您的数据不太可能损坏。如果您的系统需要防止数据库停机导致数据丢失，我会看看消息队列技术。

# .net - 如何从 System.Windows.Forms.Keys 代码中获取快捷方式文本

> ID：10288829
> 
> 赞同：1
> 
> 时间：2012-04-23T21:49:17.733
> 
> 标签：.net, shortcut, keycode

使用 .net 2.0 是否可以从 System.Windows.Forms.Keys 代码中获取要显示的文本，例如作为菜单快捷方式？按键可以由用户设置，因此可以是任意组合键。这需要使用当地语言（不仅仅是英语）。

我已经尝试过 KeysConverter.ConvertToString，但结果似乎毫无用处。例如，它给出“OemMinus”（用于主键盘 -）或“Subtract”（用于 NumPad -）。在 F1-F12 和 AZ 之外，我们的用户很少能理解这些内容。因为该应用程序是专门为难以访问计算机的人设计的，所以它使用很多组合键作为一种访问模式，我需要能够描述键盘上的任何键。

有没有办法获得对最终用户真正有意义的键名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T00:27:00.757

此类型转换器旨在供您使用，而不是您的用户。当您为菜单项使用 ShortcutKeys 属性的下拉菜单时，您将看到它的实际作用。因此，它包含的键名可能会让程序员满意，但肯定不会让用户满意。这就是为什么同一个控件还具有 ShortcutKeyDisplayString 属性，即用户实际看到的文本。

你必须自己做。

# jquery - 如何使用此 JQuery 验证代码添加回调以在表单提交时隐藏和显示 div

> ID：10288830
> 
> 赞同：0
> 
> 时间：2012-04-23T21:49:19.663
> 
> 标签：jquery, forms, validation, event-handling

我正在尝试从 Joren Rapini 的博客中为这段代码添加更多功能，它是一个简单的表单验证器。由于项目的性质，我没有太多的权限来测试任何真正的 AJAX 提交或刷新页面功能。所以我正在尝试使用验证代码，但此外，一旦填写了所有必填字段，并且提交按钮通过其返回设置为 true 变为“活动”，我想 a) 隐藏表单容器 div 和 b ) 显示以前隐藏的 div。

所以我们有这个：

```
$(document).ready(function(){
// Place ID's of all required fields here.
required = ["first_name", "last_name", "email", "street_address"];
// If using an ID other than #email or #error then replace it here
email = $("#email");
errornotice = $("#error");
// The text to show up within a field when it is incorrect
emptyerror = "Please fill out this field.";
emailerror = "Please enter a valid e-mail.";

$("#unique-form").submit(function(){    
    //Validate required fields
    for (i=0;i<required.length;i++) {
        var input = $('#'+required[i]);
        if ((input.val() == "") || (input.val() == emptyerror)) {
            input.addClass("needsfilled");
            input.val(emptyerror);
            errornotice.fadeIn(750);
        } else {
            input.removeClass("needsfilled");
        }
    }
    // Validate the e-mail.
    if (!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(email.val())) {
        email.addClass("needsfilled");
        email.val(emailerror);
    }

    //if any inputs on the page have the class 'needsfilled' the form will not submit
    if ($(":input").hasClass("needsfilled")) {
        return false;
    } else {
        errornotice.hide();
        return true;
    $("#placeHolder #myForm").hide();
    $("#placeHolder #stuff").show();
    }
});

// Clears any fields in the form when the user clicks on them
$(":input").focus(function(){       
   if ($(this).hasClass("needsfilled") ) {
        $(this).val("");
        $(this).removeClass("needsfilled");
   }
}); }); 
```

我的代码是这样的：

```
$("#placeHolder #myForm").hide();
    $("#placeHolder #stuff").show(); 
```

这行不通。我试图在#stuff div 中隐藏感谢消息和一些社交媒体链接，以在提交表单时复制感谢页面的 AJAX 加载。但是我受限于客户端，我没有能力对服务器进行大量的来回测试，我正在尝试为此安装一个非常简单的前端解决方案。验证部分似乎可以根据需要工作，并且我在代码中的所有 div id 都是正确的，所以我知道这是我还没有得到的事件处理结构中的一些概念，而且我有一个截止日期接近所以如果有人有任何想法，我会寻求帮助。

我知道我在结构或语法中遗漏了一些东西，但不确定它是什么。我需要编写一个单独的函数然后调用它吗？提前致谢。

**更新：** 为了清楚起见，我正在重新发布我正在使用的代码的精简版本。我试图隐藏表单的包含元素（我用于包含元素的 id 实际上是“#form-holder”，最初隐藏的 div 是“#thank-you”。我的问题不在于选择器，它在 javascript/jQuery 逻辑中（嗯，这是我不理解的逻辑:) - 或者它也可能是由于单击表单提交按钮的继承逻辑。正如我在评论中所说，我看到隐藏的 div最简短的时刻，然后它恢复为无显示。现在这是希腊文本，只是为了让它工作，最终将是带有 Twitter 链接等的“谢谢”文本消息 - 但我只需要了解逻辑正确并首先发挥作用。

```
 $(document).ready(function(){
// Place ID's of all required fields here.
required = ["email"];
// If using an ID other than #email or #error then replace it here
email = $("#email");
errornotice = $("#error");
formholder = $('#form-holder');
thankyou = $("#thank-you");
// The text to show up within a field when it is incorrect
emptyerror = "Please fill out this field.";
emailerror = "Please enter a valid e-mail.";

$("#myForm").submit(function(){ 
    //Validate required fields
    for (i=0;i<required.length;i++) {
        var input = $('#'+required[i]);
        if ((input.val() == "") || (input.val() == emptyerror)) {
            input.addClass("needsfilled");
            input.val(emptyerror);
            errornotice.fadeIn(750);
        } else {
            input.removeClass("needsfilled");
        }
    }
    // Validate the e-mail.
    if (!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(email.val())) {
        email.addClass("needsfilled");
        email.val(emailerror);
    }

    //if any inputs on the page have the class 'needsfilled' the form will not submit
    if ($(":input").hasClass("needsfilled")) {
        return false;
    } else {
        errornotice.hide();
        formholder.hide();
        thankyou.show();
        return true;
    }
});

// Clears any fields in the form when the user clicks on them
$(":input").focus(function(){       
   if ($(this).hasClass("needsfilled") ) {
        $(this).val("");
        $(this).removeClass("needsfilled");
   }
});});</script> 
```

你可以看到我在代码顶部附近添加了我的表单持有者和谢谢你作为变量。下面是 HTML 的一个版本。

```
 <div id="form-holder">
<form id="myForm" class="form">
<p class="names form-paragraph clearfix">
<span class="first_name">
<label for="name">First Name</label>
<input type="text" required="required" name="first_name" id="first_name" /></span>
<span class="last_name">
<label for="name">Last Name</label>
<input type="text" required="required" name="last_name" id="last_name" /></span>
</p>
<p class="email form-paragraph">
<label for="email">Email*</label>
<input type="text" required="required" name="email" id="email" />
</p><p id="error">There were errors on the form, please make sure all fields are fill out correctly.</p>
<p class="small-text">* Required Field</p>
<p class="submit"><span><input type="submit" value="SUBMIT" id="formSubmit" /></span>
<span><button type="reset" value="RESET">RESET</button></span></p></form>
<div id="thank-you"><p>At vero eos et accusamus et iusto odio dignissimos ducimus qui    blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio.</p></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:26:50.840

没有仔细查看该代码，但是您在 return true 语句之后添加了两行代码，因此该函数将在您的代码运行之前终止并返回 true，因此您编写的内容并不重要，它永远不会被执行。

你需要在 return 语句之前将你的代码提升一个档次，然后它可能会起作用，如果代码是正确的，这是不可能的，因为我们不知道标记，也不能说太多您选择的选择器。

```
if ($(":input").hasClass("needsfilled")) {
    return false;
} else {
    errornotice.hide();
    //the below seems like strange selectors, they could be valid, 
    //but just using the latter would suffice as they are ID's
    $("#placeHolder #myForm").hide(); 
    $("#placeHolder #stuff").show();
    return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T01:03:36.473

根据大家的评论，以及来自 Adeneo 的最终评论，我开始意识到，按照最初计划的方式实现我想要做的事情是不可能的。所以我目前正在尝试一个非常简单的 AJAX 验证/提交，基于 Nettuts+ 上的教程，在这里（并保持我的手指交叉）： http: [//net.tutsplus.com/tutorials/javascript-ajax/submit-a-form -无页面刷新使用 jquery/](http://net.tutsplus.com/tutorials/javascript-ajax/submit-a-form-without-page-refresh-using-jquery/)

来自阿德尼奥：

*不，它不会在使用 preventDefault() 时使用默认操作提交表单，为此您必须使用 Ajax 提交，否则提交表单时站点将始终刷新，所以是的，只有停止的解决方案从刷新页面是使用ajax。*

感谢大家的帮助。

# java - Android中ImageView的相对坐标

> ID：10288832
> 
> 赞同：1
> 
> 时间：2012-04-23T21:49:23.583
> 
> 标签：java, android, imageview, coordinates, android-relativelayout

我在右对齐的 FrameLayout 中包含的 ImageView 中有一个方形图像（横向布局）。FrameLayout 设置为 FillParent 宽度和高度，ImageView 设置为 Adjust View Bounds 以便生成的 ImageView 是一个完美的正方形，每一边都是横向布局的高度长度，右对齐。但是，原始图像比这大。我需要获取相对于自身单击 ImageView 的坐标（即 ImageView 的左上角是 0,0，右下角是显示的宽度和高度坐标），以便我可以计算出是否单击的点超过了 ImageView 的中点。我最初使用以下方法获取 ImageView 的大小：

```
int myImageViewWidth = imageView.getWidth();
int myImageViewHeight = imageView.getHeight(); 
```

我创建了一个 OnTouchListener 并在其中使用 event.getX() 和 event.getY()，但这似乎返回相对于图像原始大小的坐标，而不是显示的大小。我还尝试了以下方法：

```
Matrix m = imageView.getImageMatrix();
float[] values = new float[9];
m.getValues(values);
float relativeX = (event.getX() - values[2]) / values[0];
float relativeY = (event.getY() - values[5]) / values[4]; 
```

但这似乎又返回了不准确的坐标。有人可以帮忙吗？

# coldfusion - 包含在 wddxpacket 中的 cfc 远程方法结果

> ID：10288834
> 
> 赞同：5
> 
> 时间：2012-04-23T21:49:41.967
> 
> 标签：coldfusion, coldfusion-9, coldfusion-8, cfc, wddx

当我从 cfc 的远程方法返回一个字符串时。返回的字符串被包裹在一个奇怪的 wddxpacket 中：

![wddx包](../Images/f8135d54bb63b4beafdf51289ac5c00e.png)

我试图像这样关闭调试输出：

```
<cfsetting showDebugOutput="no"> 
```

但它没有用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-23T22:06:42.730

设置`returnformat`为`plain`或`json`在遥控器中`<cffunction>`

请参阅：[http ://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f5c.html](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f5c.html)

# jquery - 需要用新添加的行重新加载表

> ID：10288836
> 
> 赞同：-1
> 
> 时间：2012-04-23T21:49:54.980
> 
> 标签：jquery, ajax

所以我有一个使用 php do while 循环动态创建的表。查询与 do while 循环在同一个 php 页面上......就像这样：

```
$id = $someID['some_id'];
$query = "SELECT * FROM itable WHERE some_id = '$id'";
$result = @mysqli_query($connect, $query);
$info = mysqli_fetch_assoc($result);

print"
<div id='divID'>
  <table>
    <tr>
      <th>h1</th>
      <th>h2</th>
    </tr>
";   
    do{print"
     <tr>
       <td>" . $info['column1'] . "</td>
       <td>" . $info['column2'] . "</td>
     </tr>
    ";}
    while($info = mysqli_fetch_assoc($result));
    print"
  </table>
</div>
"; 
```

工作正常...然后我使用 jquery post 方法向表中添加一行...并且记录在数据库中正确更新。我的问题是如何让表格刷新新添加的行？我知道我可以使用 $('#divID').load$('page.php'); 但是，填充表格的查询与表格本身在同一页面上，所以我不确定在这里做什么。任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T21:52:59.883

您确实需要使用加载功能，但无需加载整个页面，只需再次加载表格即可。你会做类似以下的事情，

点击按钮：

a) 将记录添加到数据库

b) 触发 JQuery 加载请求以再次加载表。表格将在一个 div 中，您需要做的就是将新收到的数据附加到 div 中。

# collections - 如何在 Symfony2 表单类型的集合中动态添加集合

> ID：10288845
> 
> 赞同：8
> 
> 时间：2012-04-23T21:50:54.220
> 
> 标签：collections, symfony

我在 symfony2 中有 3 种表单类型

FaultType 是所有下一个集合的父级

```
<?php

namespace My\FaultBundle\Form;

use Symfony\Component\Form\AbstractType; 
use Symfony\Component\Form\FormBuilder;

class FaultType extends AbstractType
{

    public function buildForm(FormBuilder $builder, array $options)
    { 
        $builder
                ->add('title')
                ->add('steps', 'collection', array(
                    'type' => new StepType(),
                    'allow_add' => true,
                    'prototype' => true,
                    'by_reference' => false,
                ))
                ->add('created')
                ->add('updated')
        ;
    }

    public function getDefaultOptions()
    {
        return array(
            'data_class' => 'My\FaultBundle\Entity\Fault'
        );
    }

    public function getName()
    {
        return 'my_fault_fault';
    }

} 
```

步骤类型：

```
<?php

namespace My\FaultBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class StepType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('body')
            ->add('photos', 'collection', array(
                'type' => new PhotoType(),
                'allow_add' => true,
                'allow_delete' => true,
                'prototype' => true,
                'by_reference' => false,
            ))
        ;
    }

    public function getDefaultOptions()
    {
        return array(
            'data_class' => 'My\FaultBundle\Entity\Step'
        );
    }

    public function getName()
    {
        return 'my_fault_step';
    }
} 
```

和最后一个 PhotoType：

```
<?php

namespace My\FaultBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class PhotoType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('name')
            ->add('description')
            ->add('filename')
        ;
    }

    public function getDefaultOptions()
    {
        return array(
            'data_class' => 'My\FaultBundle\Entity\Photo'
        );
    }

    public function getName()
    {
        return 'my_fault_photo';
    }
} 
```

我发现关于原型的优秀文章[链接](http://toni.uebernickel.info/2012/03/15/an-example-of-symfony2-collectiontype-form-field-prototype.html)，并且使用一个嵌套表单类型非常好，但是当我想让它与第三个嵌套意味着 PhotoType 一起工作时我遇到了问题......照片在步骤的集合中，这是集合错误...，如何通过此示例为步骤动态添加/删除照片...？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-11T16:57:25.580

我制作了一个 JS 片段，可以在这里提供帮助。您只需添加两个按钮 [添加新的，删除最后一个]。 [https://gist.github.com/juanmf/10483041](https://gist.github.com/juanmf/10483041)

它可以处理递归/嵌套原型。它与允许您将生成的控件绑定到事件的中介（与 Symfony 事件调度程序相同）相结合。如果您不需要调解器，请删除这些行：

```
docdigital.mediatorInstance.send(
    docdigital.constants.mediator.messages.clonePrototype_prototypeAdded,
    $clone
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T11:06:31.453

您必须制作自己的原型。

有2个解决方案：

1.  用正则表达式查找 a 的所有数字段`property_path`，并用占位符替换它们

    ```
    $segments_found = preg_match('/\[(\d+)\]/', $prototype, $matches); 
    ```

2.  使用递归查找顶级集合父级并从那里手动构建路径。

您是否尝试重新订购商品？这是一场彻头彻尾的灾难；）

# c++ - LNK 2019 在 MFC 中使用自定义类时出错

> ID：10288848
> 
> 赞同：0
> 
> 时间：2012-04-23T21:51:09.203
> 
> 标签：c++, class, mfc, lnk2019

我开发了两个类用于在控制台应用程序中运行相机图像采集卡（一个用于抓取图像，一个用于处理图像），现在想将这些类实现到 MFC 项目中。该类在控制台应用程序中运行良好。当我尝试在 MFC 应用程序中使用它们时，我收到 LNK2019 错误。这是一些代码片段，图像显示类的编写方式非常相似：

IMAQ 类（用于抓取图像）：IMAQ.h：

```
#pragma once
#include <queue>
#include <fstream>
#include "CircularInterface.h"
...  // some more includes

class IMAQ
{
public:
explicit    IMAQ();
virtual     ~IMAQ();

int SetupAcq(pRTCaptureStruc pRTCaptStruc);
... // some more functions

// The image acquisition thread
UINT    ImgAcqThread(LPVOID lpdwParam);

private:
BFU32   BdNum,
    BdInitOptns,
    NumBuffers,
    CircInitOptions;

// image acquisition parameters
BFU32   ImageSize,
    BitDepth,
    Xsize,
    Ysize,
    NumPixels,
    BytesPerPix;
bool    GetFrame;

    ... // some more private members

};  // class IMAQ 
```

IMAQ.cpp：

```
#include "..\\Include\\IMAQClass.h"

IMAQ::IMAQ()
{
BdNum = 0;
BdInitOptns = CiSysInitialize;
CircInitOptions = BiAqEngJ;
NumBuffers = 4;
FilePath = NULL;
_isClean = true;
}  

IMAQ::~IMAQ()
{
// Empty destructor
}

int IMAQ::SetupAcq(pRTCaptureStruc pRTCaptStruc)
{
...// left out code for brevity
}

... // some more functions, all functions declared in header file are defined. 
```

uOCT MFC AppDlg.h：

```
#pragma once

#include "ImgDspClass.h"
#include "IMAQClass.h"
#include "afxwin.h"

// CuOCTMFCAppDlg dialog
class CuOCTMFCAppDlg : public CDialogEx
{

public:
HBITMAP hBmpWellA6;
BITMAP  BmpWellA6;
UINT8   *pBitsWellA6;

BITMAPINFOHEADER    bmpInfo;

IMAQ                ImgAcq;
ImgDspClass         ImgDsp;

char    *LUTpath;
char    FileName[FILENAME_MAX];

  ... // more members
}; 
```

uOCT MFC AppDlg.cpp：

```
#include "stdafx.h"
#include "uOCT MFC App.h"
#include "uOCT MFC AppDlg.h"
#include "afxdialogex.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

// CAboutDlg dialog used for App About

class CAboutDlg : public CDialogEx
{
public:
    CAboutDlg();

// Dialog Data
    enum { IDD = IDD_ABOUTBOX };

    protected:
    virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support

// Implementation
protected:
    DECLARE_MESSAGE_MAP()
};

BOOL CuOCTMFCAppDlg::OnInitDialog()
{
CDialogEx::OnInitDialog();

// Add "About..." menu item to system menu.

// IDM_ABOUTBOX must be in the system command range.
ASSERT((IDM_ABOUTBOX & 0xFFF0) == IDM_ABOUTBOX);
ASSERT(IDM_ABOUTBOX < 0xF000);

CMenu* pSysMenu = GetSystemMenu(FALSE);
if (pSysMenu != NULL)
{
    BOOL bNameValid;
    CString strAboutMenu;
    bNameValid = strAboutMenu.LoadString(IDS_ABOUTBOX);
    ASSERT(bNameValid);
    if (!strAboutMenu.IsEmpty())
    {
        pSysMenu->AppendMenu(MF_SEPARATOR);
        pSysMenu->AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);
    }
}

// Set the icon for this dialog.  The framework does this automatically
//  when the application's main window is not a dialog
SetIcon(m_hIcon, TRUE);         // Set big icon
SetIcon(m_hIcon, FALSE);        // Set small icon

// Change the file path here to change save location
ImgAcq.SetFilePath("C:\\Users\\uOCT clone\\Documents\\temporary\\test.dat");
ImgDsp.SetReferencePath("C:\\Users\\uOCT clone\\Documents\\temporary\\ref.dat");

return TRUE;  // return TRUE  unless you set the focus to a control
} 
```

在我的 MFC 对话框头文件中，我包含 IMAQClass.h 头文件，它足以让控制台应用程序正常工作，但是，正如我上面所说，MFC 应用程序返回未解决的外部符号错误。MFC 项目`additional include directories`设置包括包含 IMAQ 头文件的目录。

为什么我会收到未解决的外部问题？谢谢

请求的错误消息：

```
 1>uOCT MFC App.obj : error LNK2019: unresolved external symbol "public: virtual __thiscall IMAQ::~IMAQ(void)" (??1IMAQ@@UAE@XZ) referenced in function "public: virtual __thiscall CuOCTMFCAppDlg::~CuOCTMFCAppDlg(void)" (??1CuOCTMFCAppDlg@@UAE@XZ)
 1>uOCT MFC AppDlg.obj : error LNK2001: unresolved external symbol "public: virtual __thiscall IMAQ::~IMAQ(void)" (??1IMAQ@@UAE@XZ)
 1>uOCT MFC App.obj : error LNK2019: unresolved external symbol "public: virtual __thiscall ImgDspClass::~ImgDspClass(void)" (??1ImgDspClass@@UAE@XZ) referenced in function "public: virtual __thiscall CuOCTMFCAppDlg::~CuOCTMFCAppDlg(void)" (??1CuOCTMFCAppDlg@@UAE@XZ)
 1>uOCT MFC AppDlg.obj : error LNK2001: unresolved external symbol "public: virtual __thiscall ImgDspClass::~ImgDspClass(void)" (??1ImgDspClass@@UAE@XZ)
 1>uOCT MFC AppDlg.obj : error LNK2019: unresolved external symbol "public: __thiscall ImgDspClass::ImgDspClass(void)" (??0ImgDspClass@@QAE@XZ) referenced in function "public: __thiscall CuOCTMFCAppDlg::CuOCTMFCAppDlg(class CWnd *)" (??0CuOCTMFCAppDlg@@QAE@PAVCWnd@@@Z)
 1>uOCT MFC AppDlg.obj : error LNK2019: unresolved external symbol "public: __thiscall IMAQ::IMAQ(void)" (??0IMAQ@@QAE@XZ) referenced in function "public: __thiscall CuOCTMFCAppDlg::CuOCTMFCAppDlg(class CWnd *)" (??0CuOCTMFCAppDlg@@QAE@PAVCWnd@@@Z)
 1>uOCT MFC AppDlg.obj : error LNK2019: unresolved external symbol "public: int __thiscall ImgDspClass::SetReferencePath(char * const)" (?SetReferencePath@ImgDspClass@@QAEHQAD@Z) referenced in function "protected: virtual int __thiscall CuOCTMFCAppDlg::OnInitDialog(void)" (?OnInitDialog@CuOCTMFCAppDlg@@MAEHXZ)
 1>uOCT MFC AppDlg.obj : error LNK2019: unresolved external symbol "public: int __thiscall IMAQ::SetFilePath(char * const)" (?SetFilePath@IMAQ@@QAEHQAD@Z) referenced in function "protected: virtual int __thiscall CuOCTMFCAppDlg::OnInitDialog(void)" (?OnInitDialog@CuOCTMFCAppDlg@@MAEHXZ) 
```

编辑：问题解决了，但我想我真的不明白为什么。

所以发布的评论说我需要链接到库文件。我遇到问题的两个类既不生成 .dll 也不生成 .lib 文件，只生成 .obj。但是一时兴起，我回去并将 .obj 文件包含到链接依赖项中。

所以现在我的问题是：如果 .obj 文件没有与可执行文件一起生成，它们是否需要像库一样链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:06:30.553

你没有给我们足够的细节来帮助你。您已经告诉我们您遇到了链接器错误，但您需要告诉我们确切的错误信息，即哪些符号未定义？

这是我的猜测；你已经包含了一个额外的头文件。此头文件是库的一部分，但您没有在库本身中链接，仅包含头文件。所以你的第一部分是对的，现在你需要打开你的链接器设置页面，添加额外的库目录（即，.lib、.obj、.whatever 实现文件所在的位置），然后添加库的名称到“其他依赖项”部分。

# android - 在这种情况下我需要共享偏好吗？

> ID：10288851
> 
> 赞同：0
> 
> 时间：2012-04-23T21:51:19.340
> 
> 标签：android, login

我正在制作一个 android 应用程序，用户在其中创建他的个人资料，其中包含一些稍后将使用的属性；第一次使用应用程序时，它需要提供“注册”活动，但后来，我希望用户直接访问应用程序，而无需登录或查看注册页面。在这种情况下我必须使用共享偏好吗？以及如何在创建配置文件后隐藏第一页以供进一步使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:37:28.083

这个程序有一些互联网组件吗？注册后，将用户信息存储在私有 SharedPreference 中。当您尝试从 SharedPreference 检索信息时，您将知道用户是否已注册。

```
SharedPreferences pref = getDefaultSharedPreferences();
String login = pref.getString("login", ""); // "" is default value
if(login.equals("")){
    //startActivityForResults
    //get results, store them in sharedpreferences, then COMMIT!
    //if results are invalid(user has hit back button)
    //close to home screen
else{ //user has registered
    //do what you need to show login activity/layout.
} 
```

编辑：将键值存储在 strings.xml 或静态的某个地方也是一种很好的做法，这样您就没有魔术字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:24:46.007

> 在这种情况下我必须使用共享偏好吗？

不，但它们让您在这里的生活更轻松。存储该数据的其他选项更为复杂。

> 以及如何在创建配置文件后隐藏第一页以供进一步使用？

应用程序通常有另一个起始页，它们可以从该起始页开始登录或直接进入主要部分。如果您检测到您拥有所需的数据，您也可以`startActivity`直接进入`onCreate`您的开始屏幕（因此您不会真正看到该活动）

# ios - iOS UITextField 将键盘保持在屏幕上

> ID：10288853
> 
> 赞同：0
> 
> 时间：2012-04-23T21:51:24.613
> 
> 标签：ios, keyboard, uitextview

我没有调用“[sender resignFirstResponder]”方法，但是当按下完成按钮时我的键盘仍然关闭。我需要它保持打开状态，即使我点击完成。我该怎么做呢？

这是我控制键盘的操作：

```
- (IBAction)returnKeyButton:(id)sender {

BOOL guessCorrect = [gameModel checkGuess:guessTextField.text];

guessTextField.text = @"";

if (guessCorrect) {
    CFBundleRef mainBundle = CFBundleGetMainBundle();
    CFURLRef soundFileURLRef;
    soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"rightAnswer", CFSTR ("mp3"), NULL);

    UInt32 soundID;
    AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
    AudioServicesPlaySystemSound(soundID);
    if (gameModel.score == 10) {
        CFBundleRef mainBundle = CFBundleGetMainBundle();
        CFURLRef soundFileURLRef;
        soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"win", CFSTR ("mp3"), NULL);

        UInt32 soundID;
        AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
        AudioServicesPlaySystemSound(soundID);

        [self endGameWithMessage:@"You win!"];
    } else {
        scrambledWord.text = [gameModel getScrambledWord];
    }

}
remainingTime.text = [NSString stringWithFormat:@"%i", gameModel.time];
playerScore.text = [NSString stringWithFormat:@"%i", gameModel.score];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:23:31.100

首先...说实话，我从来没有遇到过你遇到的问题。我总是不得不使用 resign 调用来关闭键盘，否则它会保持打开状态......但是，这就是我为你使用的：

1）把它放在.h文件中：

```
-(IBAction) textFieldDoneEditing : (id) sender; 
```

2）把它放在 .m 文件中：

```
-(IBAction) textFieldDoneEditing : (id) sender{
    [sender resignFirstResponder];
    [sender becomeFirstResponder];
} 
```

3) 右键单击​​情节提要中的 UITextField 并将 Sent 事件“Editing Did End”设置为视图控制器中的 textFieldDoneEditing 方法。

现在，只要用户按下“返回”或“完成”，键盘就会立即打开和关闭。希望能帮助到你！:)

如果它不起作用，请查看我的 Xcode 项目（确实有效）...[在此处下载](http://www.sendspace.com/file/5um45o)

# c++ - 取函数模板重载地址

> ID：10288855
> 
> 赞同：2
> 
> 时间：2012-04-23T21:51:38.750
> 
> 标签：c++, templates, c++11, overloading, function-pointers

我有这个依赖于 SFINAE 和默认模板参数的代码。它按预期工作，除了最后两行注释：

```
#include <tuple>
#include <iostream>
using namespace std;

template<typename T> void push(T val){
    cout<<val<<endl;
}

template<typename T> T to(){
    T dummy;
    cin>>dummy;
    return dummy;
}

template<typename T, T> class function_proxy{
    static_assert(sizeof(T)!=sizeof(T), "Error: function_proxy works with functions (duh)");
};

template<typename Return, typename... Args, Return(*func)(Args...)> class function_proxy<Return(*)(Args...), func>{
    static Return call(Args... args){
        return func(args...);
    }
    template<typename... retrieved> static Return call(retrieved... read){
        return call(read..., to<typename tuple_element<sizeof...(read), tuple<Args...> >::type >());
    }
public:
    template<typename Ret=Return, typename enable_if<!is_void<Ret>::value, int>::type=0>
    static int wrapper(){
        push(call());
        return 1;
    }

    template<typename Ret=Return, typename enable_if<is_void<Ret>::value, int>::type=0>
    static int wrapper(){
        call();
        return 0;
    }
};

int f(int arg){ return arg*3; }
void g(){ cout<<"g does nothing"<<endl; }

int main(){
    //SFINAE works nicely
    function_proxy<decltype(&f), &f>::wrapper();
    function_proxy<decltype(&g), &g>::wrapper();
    //Here it doesn't, even though there should be no ambiguity:
    //function_proxy<decltype(&f), &f>::wrapper;
    //function_proxy<decltype(&g), &g>::wrapper;
} 
```

您可以看到，当我调用模板函数时，SFINAE 完成了它的工作。但是当我尝试获取唯一不会格式错误的函数的地址时，g++ 抱怨它无法解析重载函数的地址。

有没有办法在不明确告诉这些重载函数的第一个模板参数的情况下解决这个问题？理论上，这是多余的。此外，我使用这个帮助类的代码是非常通用的，所以这里的返回类型是`f`并且`g`可能不是那么容易获取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:03:58.137

SFINAE 仅在重载决议期间适用，如果没有函数调用，则没有重载决议。

# php - 在抓取页面时捕获动态生成的图像

> ID：10288860
> 
> 赞同：0
> 
> 时间：2012-04-23T21:52:07.877
> 
> 标签：php, ruby, web-scraping

我正在尝试从旧数据库中捕获一些图像。

在编写爬虫时，我使用 ruby​​（但对 php 也很熟悉）直接 open() 一个网站并读取其内容。我有时也使用脚本来调用相应的`curl ...`命令。

但是，我正在从中刮取一些片段的数据库返回一个页面，然后使用服务器端脚本假设的一系列随机数嵌入带有图像名称的目标图像。例如：

`<img ... show_image.jsp?343523.jpg`

但是，我不能直接调用这个 show_image 脚本（被拒绝），它只在嵌入整个网站时才有效。

我可以使用 curl，或者在 ruby​​ 或 php 中下载整个页面，例如，`1929.2.14.aspx`它包含由生成的嵌入图像`show_image.jsp?343523.jpg`吗？

如果我只是直接卷曲 aspx 文件，我自然会得到 html - 如何以基于浏览器的“Web 存档”功能手动工作的方式通过脚本保存 html 和嵌入的图像？

任何提示，教程链接等都表示赞赏......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:04:18.600

如果脚本（例如 show_image.jsp）正在做一个简单的引荐来源检查，您可以通过编写您的 PHP（或 Ruby）刮板来解决它，以便在进行 GET 之前设置引荐来源：

```
curl --referer http://www.example.com http://www.example.com/show_image.jsp?bar.jpg 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:50:21.697

您可能应该使用 mechanize 在 ruby​​ 中抓取网站。当您这样做时，它会为您设置 cookie 和引用，因此获取图像将非常简单：

```
agent.get(image_url).save_as 'local_filename.jpg' 
```

# matlab - 在 MATLAB 中创建七边形

> ID：10288861
> 
> 赞同：0
> 
> 时间：2012-04-23T21:52:21.293
> 
> 标签：matlab, loops, geometry, polygon

我需要创建一个七边形。我想通过创建一个三角形来做到这一点，然后在我旋转它之后再次循环绘制它。

```
x1 = [ 0.5, 0.48, 0.55 ];
y1 = [ 0.5, 0.578, 0.558 ];
fill( x1, y1, 'w') 
```

这给了我第一个三角形，但是我试图找出一种方法来循环遍历它并每次旋转它（我假设七边形为 51.43 度）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:12:48.550

你想要一个[旋转矩阵](http://en.wikipedia.org/wiki/Rotation_matrix)。我试过这个：

```
t = pi / 3.5;
R = [cos(t) sin(t); -sin(t) cos(t)];
c = [0 1 cos(t); 0 0 sin(t)];
hold on;
for i=1:7
  fill(c(1, :), c(2, :), 'w');
  c = R * c;
end 
```

R 围绕原点旋转 - 所以如果你想以 (0.5, 0.5) 为中心，那么你需要在绘制之前将 c 平移那个量。我更改了您的起始坐标，使它们成为一个三角形，从 (0, 0) 开始，一条边沿 x 轴。

# android - 来自 XML 的多个片段实例作为 ViewPager 中的页面 - 如何添加子片段？

> ID：10288866
> 
> 赞同：0
> 
> 时间：2012-04-23T21:53:05.280
> 
> 标签：android, android-fragments, android-viewpager

我有多个从 xml 文件膨胀的片段实例，并在此处分配了一个我希望用作容器根的 id。如果我想将子片段附加到这些片段之一作为我的容器，我如何知道使用了哪个片段，或者更好的是如何选择特定的容器片段？具体来说，我希望能够将片段附加到 ViewPager 中的一组页面中的一个，每个页面都是公共片段定义的实例。这些页面中的任何一个都可以作为子片段的根。但是，它们最终都会得到相同的 id，因为它是在 XML 中指定的，并且您不能使用片段标记名称调用 FragmentTransaction#add ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:30:48.097

> 如果我想将子片段附加到这些片段之一作为我的容器，我如何知道使用了哪个片段，或者更好的是如何选择特定的容器片段？

Android 不支持嵌套片段，因此您根本不这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T09:33:58.713

现在您可以使用嵌套片段 - 也包含在支持库中，这是我的解决方案 [ViewPager 和片段 - 设计嵌套片段或..？](https://stackoverflow.com/questions/7954492/viewpager-and-fragments-design-nested-fragments-or/13413710#13413710)

# django - django 自定义模板标签未在上下文中获取请求

> ID：10288868
> 
> 赞同：3
> 
> 时间：2012-04-23T21:53:22.853
> 
> 标签：django, django-templates

我正在使用 django 1.4 并尝试将[本文](http://dashdrum.com/blog/2010/03/full-url-in-django/)末尾描述的代码转换为 customtag。这意味着我需要访问请求中的 is_secure 和 site_name 值。这是我在 settings.py 中的 CONTEXT_PROCESSORS：

```
CONTEXT_PROCESSORS = (
    'django.core.context_processors.request',
    'django.contrib.auth.context_processors.auth',
) 
```

这是我的模板标签代码：

```
from django import template
register = template.Library()

@register.simple_tag(takes_context=True)
def full_static_url(context, url):
    request = context['request']
    scheme = 'http'
    if request.is_secure:
        scheme += 's'
    return scheme + '://' + request.site_name + context['STATIC_URL'] + url 
```

在我的视图代码中，我正在使用新的渲染快捷方式，如下所示：

```
return render(request, 'myapp/mytemplate.html', {'foo':bar}) 
```

我在模板中这样称呼它：

```
{% full_static_url "images/logo.gif" %} 
```

问题是，当它到达行**request = context['request']**时，它会抛出一个 KeyError ，因为 'request' 不在上下文中。

我在这里做错了什么？

完整的追溯是：

```
File "C:\Python27\lib\site-packages\django\core\handlers\base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "C:\Projects\blah\blah\myapp\views\myview.py" in manifestcosts
  44\.     return render(request, 'myapp/mytemplate.html', {'foo':bar})
File "C:\Python27\lib\site-packages\django\shortcuts\__init__.py" in render
  44\.     return HttpResponse(loader.render_to_string(*args, **kwargs),
File "C:\Python27\lib\site-packages\django\template\loader.py" in render_to_string
  176\.         return t.render(context_instance)
File "C:\Python27\lib\site-packages\django\template\base.py" in render
  140\.             return self._render(context)
File "C:\Python27\lib\site-packages\django\template\base.py" in _render
  134\.         return self.nodelist.render(context)
File "C:\Python27\lib\site-packages\django\template\base.py" in render
  823\.                 bit = self.render_node(node, context)
File "C:\Python27\lib\site-packages\django\template\debug.py" in render_node
  74\.             return node.render(context)
File "C:\Python27\lib\site-packages\django\template\defaulttags.py" in render
  185\.                         nodelist.append(node.render(context))
File "C:\Python27\lib\site-packages\django\template\base.py" in render
  1107\.                     return func(*resolved_args, **resolved_kwargs)
File "C:\Projects\blah\blah\myapp\templatetags\mytags.py" in full_static_url
  25\.     request = context['request']        #TODO this fails with an KeyError, don't know why
File "C:\Python27\lib\site-packages\django\template\context.py" in __getitem__
  54\.         raise KeyError(key)

Exception Type: KeyError at /myapp/myurl/110505081136179000/
Exception Value: 'request' 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-06-10T14:05:20.483

解决此问题的正确方法是添加`TEMPLATE_CONTEXT_PROCESSORS += ("django.core.context_processors.request",)`您的 settings.py 文件。

确保先导入`TEMPLATE_CONTEXT_PROCESSORS`，`from django.conf.global_settings import TEMPLATE_CONTEXT_PROCESSORS`否则将无法正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:16:33.537

最有可能的问题是您正在使用常规上下文呈现模板，就像这样：

```
return render_to_response("myapp/template.html", {"some_var": a_value}) 
```

请记住，上下文处理器仅适用于`RequestContext`实例。这意味着您必须`RequestContext`在`render_to_response`调用中显式创建 a ：

```
return render_to_response("myapp/template.html", {"some_var": a_value},
                          context_instance=RequestContext(request)) 
```

甚至更好的是，使用新的`render`快捷方式：

```
return render(request, "myapp/template.html", {"some_var": a_value}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T08:44:56.607

我通过改变解决了

```
return render(request, 'myapp/mytemplate.html', {'foo':bar}) 
```

到

```
return render( RequestContext(request), 'myapp/mytemplate.html', {'foo':bar}) 
```

我希望这对其他人有所帮助，我浪费了大约 8 个小时：p

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T05:45:48.760

我在 render() 中的 template.Node 对象中发生了这种情况。事实证明，有时上下文中有“请求”，有时则没有。

就像其他人建议的那样，`RequestContext(request)`是关键。我的猜测是，有时在没有像这样初始化请求的情况下调用上下文。

我改变了我的功能

```
 def render(self, context):
      request = context['request']  # Failing here 
```

到

```
 def render(self, context):
      request = RequestContext(context)['request']['request'] 
```

一切顺利。

如果上下文对象未正确初始化，这将强制请求对象。出于某种原因，我不得不添加 ['request'] 两次，但它似乎工作正常

* * *

**编辑**：我说得太早了，似乎无法修复空白上下文。相反，您可以尝试一种解决方法：

```
request = context.get('request')
if request is None:
    return '' 
```

我的页面似乎仍然可以正常工作，所以我不确定这些不好的上下文是从哪里来的。

# heroku - 部署到 Heroku 时忽略 Playframework 2 消息文件

> ID：10288869
> 
> 赞同：0
> 
> 时间：2012-04-23T21:53:32.973
> 
> 标签：heroku, playframework-2.0

我正在尝试部署一个基于 playframework 的应用程序（play 2）。当我在本地运行它时，一切都很好。当我部署到 heroku 时，应用程序不会从消息文件中读取消息，而是吐出消息名称。例如：这段代码：

```
@Message("app.title") 
```

结果是

```
app.title 
```

而不是`conf/messages`文件中的值。在本地，它工作正常。

请注意，我没有将我的网站国际化，只是使用默认消息文件来将文本与代码分开（也许有一天会国际化：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:40:47.173

问题是我将文件命名为“Messages”，这在 Mac OS X 上很好（保留大小写但不区分大小写的文件系统），但在 Heroku 上不行。我很快意识到这一点并修复了它，但不幸的是，git 没有看到修复。我不得不删除、提交、重新添加和重新提交。我怀疑更改名称（不仅仅是更改大小写）也足够了。

感谢 James Ward（他真正回答了这个问题）的建议。

# c# - 从 WPF DataGrid 中的特定列中删除焦点

> ID：10288872
> 
> 赞同：0
> 
> 时间：2012-04-23T21:53:37.803
> 
> 标签：c#, wpf, datagrid

我有一个 WPF 数据网格。

当用户按下 Tab 键时，我不想关注第一列和第三列，所以当我到达一行时，我应该在第二列，当我再次按下 Tab 键并到达第 3 列时，它应该移动到第 4 列.

我如何在 WPF DataGrid 中执行此操作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T02:32:48.633

TabStopIndex 值指示按下 Tab 键时下一个应获得焦点的字段。此外，您可以通过[KeyboardNavigation](http://msdn.microsoft.com/en-us/library/system.windows.input.keyboardnavigation.aspx)设置来完全禁用控件的 TabStop 。[IsTabStop](http://msdn.microsoft.com/en-us/library/system.windows.input.keyboardnavigation.istabstop.aspx)附加属性。

XAML：

```
<DataGrid ItemsSource="{Binding}" AutoGenerateColumns="False">
        <DataGrid.Resources>
            <Style x:Key="NoTabStopStyle" TargetType="{x:Type DataGridCell}">
                <Setter Property="KeyboardNavigation.IsTabStop" Value="False"/>
            </Style>
        </DataGrid.Resources>
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding Path=FirstColumn}" CellStyle="{StaticResource NoTabStopStyle}"/>
            <DataGridTextColumn Binding="{Binding Path=SecondColumn}"/>
            <DataGridTextColumn Binding="{Binding Path=ThirdColumn}" CellStyle="{StaticResource NoTabStopStyle}"/>
        </DataGrid.Columns>
    </DataGrid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T01:10:21.027

您可以禁用这些列：

```
<Window.Resources>
    <Style x:Key="NotSelectableColumStyle" TargetType="{x:Type DataGridCell}">
        <Setter Property="IsEnabled" Value="False"/>
    </Style>
</Window.Resources>

<Grid Name="LayoutRoot">
     <DataGrid ItemsSource="{Binding}" AutoGenerateColumns="False">
        <DataGrid.Columns>
            <DataGridTextColumn   Binding="{Binding Path=Age}" />
            <!--<Disable this column>-->    
            <DataGridTextColumn   CellStyle="{StaticResource NotSelectableColumStyle}" Binding="{Binding Path=Name}" />
            <DataGridTextColumn  Binding="{Binding Path=Address}" />
        </DataGrid.Columns>
    </DataGrid>
 </Grid> 
```

# mysql - MySQL - 删除字符串的一部分

> ID：10288875
> 
> 赞同：3
> 
> 时间：2012-04-23T21:54:25.037
> 
> 标签：mysql

我需要从连接的字符串中删除`http://www.`, `http://`, `https://www.`, and `https://`，并且想知道是否有比使用 REPLACE 函数更好的方法。我猜是RegEx，但我无法让它工作。

```
`out`= CONCAT(REPLACE( REPLACE( `PROGRAMNAME`, 'http://', '' ),'www.',''),'-', `NAME` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:40:12.090

创建了一个 UDF 包，用于使用 MySQL 执行该类型的操作。

[https://launchpad.net/mysql-udf-regexp](https://launchpad.net/mysql-udf-regexp)

**当我发布我的答案时没有看到评论，对不起。

# jsoup - 如何设置 jsoup

> ID：10288880
> 
> 赞同：-3
> 
> 时间：2012-04-23T21:54:54.207
> 
> 标签：jsoup

这对我来说很尴尬，但是我该如何设置 jsoup。我使用dreamweaver，但可以弄清楚如何让jsoup 工作。我需要另一个程序来配合它吗？我很沮丧，请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T12:47:28.000

它就像任何其他 Java 库一样。它需要在您的类路径上，然后开始使用它！

```
Document doc = Jsoup.parse(html); 
```

或者

```
Document doc = Jsoup.connect("http://www.example.com").get(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-01T20:54:54.987

您可以在 2 个主要平台上使用 Java，即 Eclipse 和 Netbeans。我个人更喜欢 Netbeans，因为 UX 和在线代码的可用性，但 Eclipse 也有助于更轻松地在不同组件之间进行转换。语言。

不管怎样，一旦你有了 Netbeans 或 Eclipse，就下载 java jdk。您可以从 Youtube 教程中找到有关如何安装这些平台的更多信息。

然后，如果您想要 jSoup，您必须从他们的网站下载它（相当简单，对吗？），并且在您的平台（Netbeans/Eclipse）选项中，您将导航到库并将下载的 .JAR 文件链接到您的工作室。而已。然后你就可以开始使用jSoup了。有关每个步骤的更多详细信息，请使用 google。我不提供链接，因为这很简单，我想你需要的指导比步骤更多。

再见

# python - 在我的批处理文件重命名和移动脚本中遇到 Python os.rename() 问题

> ID：10288883
> 
> 赞同：2
> 
> 时间：2012-04-23T21:55:06.377
> 
> 标签：python, file-io, for-loop, operating-system

到目前为止，这是我的批处理文件重命名和移动脚本

```
import os, re, shutil, random

mainpath = 'C:\\Users\\s3z\\Desktop\\pytest'
dirs = [d for d in os.listdir('.') if os.path.isdir(d)]

for index, name in enumerate(dirs):
    subpath = name
    os.chdir(name)
    images = [i for i in os.listdir('.') if i[-4:] in ('.png', '.jpg', 'jpeg')]
    basename = re.sub(r'\W+', '', name[0:10])
    randid = str(random.uniform(0,1))[-4:] 
    for index, f in enumerate(images):
        path = os.path.join(mainpath, subpath)
        if f[-4:] == 'jpeg':
            ext = '.jpeg'
        else:
            ext = f[-4:]
        os.rename(os.path.join(path, f), os.path.join(path, basename + '_' + randid + '_' + str(index) + ext) 
        shutil.move(f, '..\..\COMMON')
    os.chdir(os.pardir) 
```

我的`os.rename()`功能有问题。当我运行脚本时，我得到

```
 File "bulk_image_organizer.py", line 19
    shutil.move(f, '..\..\COMMON')
         ^
SyntaxError: invalid syntax 
```

当我拿出第 19 行

`shutil.move(f, '..\..\COMMON')`

并尝试再次运行它，错误更改为

```
 File "bulk_image_organizer.py", line 19
    os.chdir(os.pardir)
     ^
SyntaxError: invalid syntax 
```

但是当我删除该`os.rename()`行时，脚本可以正常工作。此外，当我`os.rename()`在 Python 解释器中的 for 循环中运行该行时，如下所示

```
>>> for index, f in enumerate(images):
...     os.rename(os.path.join(path, f), os.path.join(path, "new" + st
r(index) + ".jpg"))
... 
```

它工作正常。那么我的剧本出了什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-23T21:58:26.870

`os.rename`问题与or无关`os.chdir`。您在之前的行中缺少右括号：

```
os.rename(os.path.join(path, f),
          os.path.join(path, basename + '_' + randid + '_' + str(index) + ext) 
#                                                                             ^ 
```

# java - GAE 404 NOT_FOUND 错误

> ID：10288885
> 
> 赞同：0
> 
> 时间：2012-04-23T21:55:18.467
> 
> 标签：java, google-app-engine

我正在尝试将我的应用程序部署到 GAE，但我总是**在所有**页面（jsp）上得到 404 not found 错误，**除了默认值**。RESTful web 服务工作没有问题。我正在使用 netbeans 7.1.1 和 gae 1.6.4.1

当我在本地测试它时，一切正常，没有任何问题。但是当我上传它时，总是只有默认页面可用。我几乎尝试了所有东西。

我尝试使用 appcfg.cmd 检查文件是否在 GAE 上。我从 GAE 下载了我的文件，发现没有人丢失，所以更新过程可能是成功的。

我尝试使用 appcfg 脚本而不是 netbeans 插件上传它，但该过程失败，因为：

> *com.google.appengine.tools.admin.JspCompilationException：无法编译 jsp 文件。*

我不能简单地使用 appcfg 脚本让它工作，几乎一整天都在搜索互联网，但没有找到可能的解决方案。使用 netbeans 插件上传没有问题。

那么总是在 gae 上抛出 404 的原因是什么？请帮忙。

非常感谢。如果您需要任何其他信息，我很乐意在这里发布。

好的，这是我的 web.xml

```
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
<servlet>
    <servlet-name>facebookLogin</servlet-name>
    <servlet-class>Login.FacebookLogin</servlet-class>
</servlet>
<servlet>
    <servlet-name>PlanProcess</servlet-name>
    <servlet-class>Input.PlanProcess</servlet-class>
</servlet>
<welcome-file-list>
    <welcome-file>login.jsp</welcome-file>
</welcome-file-list>
<servlet-mapping>
    <servlet-name>facebookLogin</servlet-name>
    <url-pattern>/facebooklogin</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>private</servlet-name>
    <jsp-file>private.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>private</servlet-name>
    <url-pattern>/private</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>editPlan</servlet-name>
    <jsp-file>editTrainingPlan.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>editPlan</servlet-name>
    <url-pattern>/private/trainingplan/*</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>listplans</servlet-name>
    <jsp-file>listTrainingPlans.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>listplans</servlet-name>
    <url-pattern>/private/listplans</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>visualize</servlet-name>
    <jsp-file>visualize.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>visualize</servlet-name>
    <url-pattern>/private/visualize</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>graph</servlet-name>
    <jsp-file>graph.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>graph</servlet-name>
    <url-pattern>/graph/*</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>created</servlet-name>
    <jsp-file>created.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>created</servlet-name>
    <url-pattern>/created</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>login</servlet-name>
    <jsp-file>login.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>login</servlet-name>
    <url-pattern>/login</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>newRecord</servlet-name>
    <jsp-file>newRecord.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>newRecord</servlet-name>
    <url-pattern>/private/newrecord</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>newPlan</servlet-name>
    <jsp-file>newPlan.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>newPlan</servlet-name>
    <url-pattern>/private/newplan</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>newExcercise</servlet-name>
    <jsp-file>newExcercise.jsp</jsp-file>
</servlet>
<servlet-mapping>
    <servlet-name>newExcercise</servlet-name>
    <url-pattern>/private/newexcercise</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>Jersey Web Application</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>Webservice</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>Jersey Web Application</servlet-name>
    <url-pattern>/api/*</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>test</servlet-name>
    <servlet-class>test.InsertToDb</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>test</servlet-name>
    <url-pattern>/testinsert</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>recordProcess</servlet-name>
    <servlet-class>Input.RecordProcess</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>recordProcess</servlet-name>
    <url-pattern>/record_process</url-pattern>
</servlet-mapping>
<servlet>
    <servlet-name>excerciseProcess</servlet-name>
    <servlet-class>Input.ExcerciseProcess</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>excerciseProcess</servlet-name>
    <url-pattern>/excercise_process</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>PlanProcess</servlet-name>
    <url-pattern>/plan_process</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:45:51.537

我从未将 JSP 映射到`web.xml`. 你为什么这样做？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:41:16.977

经过数小时的调试和搜索，我发现，如果你想映射 jsp 文件

你必须使用

```
<servlet>
    <servlet-name>editPlan</servlet-name>
    <jsp-file>**/**xxx.jsp</jsp-file>
</servlet> 
```

代替

```
<servlet>
    <servlet-name>editPlan</servlet-name>
    <jsp-file>xxx.jsp</jsp-file>
</servlet> 
```

路径中的“/”是必不可少的，它可以在 loaclhost 上工作，但不能在 gae 上部署。什么狗屎...

# javascript - Node.js -- 强大的 HTML 解析 + 访问 HTML 中的 javascript 函数

> ID：10288886
> 
> 赞同：1
> 
> 时间：2012-04-23T21:55:20.183
> 
> 标签：javascript, parsing, node.js, jsdom

我是节点新手，希望从以下示例页面中提取 javascript 信息：

做作的.html：

```
<html>
    <head>
        <title>
            This is a contrived example          
        </title>
        <script type="text/javascript">
    var filenames = new Array()
    filenames[filenames.length] = "http://domainwhatever.s3.amazonaws.com/780BONNYVILLECOLDLAKECHRYSLER/4431716.jpg";
    filenames[filenames.length] = "http://domainwhatever.s3.amazonaws.com/780BONNYVILLECOLDLAKECHRYSLER/4431716_1.jpg";
    filenames[filenames.length] = "http://domainwhatever.s3.amazonaws.com/780BONNYVILLECOLDLAKECHRYSLER/4431716_2.jpg";
    filenames[filenames.length] = "http://domainwhatever.s3.amazonaws.com/780BONNYVILLECOLDLAKECHRYSLER/4431716_3.jpg";
    filenames[filenames.length] = "http://domainwhatever.s3.amazonaws.com/780BONNYVILLECOLDLAKECHRYSLER/4431716_4.jpg";

      function pixplosion_Content()
      {
        var eElement = document.getElementById('idLoading');
        if( eElement ) eElement.style.display = 'none';

        return "<pixplosion test=\"test\" flashGasket=\"http://www.realelivepeople.com/pixplosion/assets/flashGasket.swf?contentPath=\" ytBridge=\"/images/image.php?pixplosion=ytbridge\"><tab test=\"test\" label=\"Photos (%1)\" icon=\"Image\" autoIterate=\"false\"   ><tab test=\"test\" label=\"Vehicle Photos (%1)\" icon=\"\" autoIterate=\"true\" startFocused=\"true\"  >
    <image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025.jpg</image>
    <image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102537.jpg</image>
    <image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102538.jpg</image>
    <image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102539.jpg</image>
    <image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102540.jpg</image>
    <image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102541.jpg</image>
    <image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102542.jpg</image>
    <image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102543.jpg</image><image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102544.jpg</image><image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102545.jpg</image><image>http://s3.domainwhatever_2.com/vehicles/photos/3726/1300025/35102546.jpg</image></tab></tab></pixplosion>";
      }

        </script>

    </head>
    <body>
    </body>
</html> 
```

Jsdom 使用它的默认解析器阻塞了这个 HTML，所以我使用了来自 github 的 aredridel/html5 解析器。它似乎适用于通过 jQuery 读取 HTML，但我无法访问函数定义，就像我使用 jsdom 及其默认解析器所做的那样。

例如，以下内容：

```
console.log(window.filenames); 
```

使用默认解析器给我一个数组。

使用 HTML5 解析器，它给了我：

```
undefined 
```

这是我的代码：

```
var jsdom = require("jsdom"),
    fs = require('fs'),
    HTML5 = require('html5');

fs.readFile('contrived.html', 'utf-8', function(err, data) {
  if (err) {
    throw err;
  }
  var document = jsdom.jsdom(data, null, {parser: HTML5});

  // HTML data should be in document creation call
  var script = document.createElement("script");
  // HTML data SHOULD NOT be in window creation call
  var window = document.createWindow();
  var parser = new HTML5.Parser({document: window.document});
  parser.parse(data);

  script.src = 'http://code.jquery.com/jquery-1.4.2.js';
  script.onload = function(window) {
                      console.log('this is a test');
                      console.log(window.filenames);
                      console.log(window.pixplosion_Content);
  }
  document.head.appendChild(script);
}); 
```

我错过了什么，还是这个功能不可用？

非常感谢。

# ios - 使用故事板进行单元测试

> ID：10288887
> 
> 赞同：4
> 
> 时间：2012-04-23T21:55:20.463
> 
> 标签：ios, xcode, unit-testing, storyboard

有没有办法从模拟器中的故事板运行特定场景以进行测试？必须在您的应用程序中点击多个页面才能到达您想要测试的正确页面，这很不方便。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-21T12:05:53.030

应该可以做到：

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil];
UITableViewController *tableVC = [storyboard instantiateViewControllerWithIdentifier:@"MyTable"]; 
```

如果您想模拟视图控制器出现而不实际将其放在屏幕上：

```
[tableVC loadView];
[tableVC viewWillAppear:YES];
[tableVC viewDidAppear:YES]; 
```

这样做是否真的是一个好主意是另一回事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:29:40.140

单元测试非常不适合任何 UI。您应该尝试直接减少对模型和业务逻辑的单元测试。

要测试 UI，也就是集成测试，您可能需要查看[UIAutomation](http://developer.apple.com/library/ios/#documentation/DeveloperTools/Reference/UIAutomationRef/_index.html)和/或[KIF](http://corner.squareup.com/2011/07/ios-integration-testing.html)。

# javascript - 高效的 jQuery 或 HTML5 图像滑块

> ID：10288892
> 
> 赞同：0
> 
> 时间：2012-04-23T21:55:43.897
> 
> 标签：javascript, jquery, html

我有一个朋友正在制作投资组合网站。他有一些他想显示的高分辨率图像。一页上会有多个项目，每个项目有几个图像。因此，他希望尽可能减少加载时间，同时也节省系统内存使用量。话虽如此，他担心如果在同一页面上多次调用传统的 jQuery 滑块会占用太多内存。此外，在初始化时加载所有图像也不是一种选择，因为这会产生很长的加载时间。有谁知道任何图像滑块，无论是 jQuery 还是 HTML5，或者两者都可以帮助解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T23:30:39.383

在花时间寻找一个[好的 jQuery](http://www.pixedelic.com/plugins/camera/)滑块之前...

...从基础开始：

1.  [开始遵循像theese](http://developer.yahoo.com/performance/rules.html)这样的一般网页设计最佳实践
2.  将您的网页保持在 100 KB 以下并[快速加载](http://tools.pingdom.com/fpt/)？（越少越好）
3.  使用[CDN](http://www.coralcdn.org/)（内容分发网络）存储高清图像。
4.  仅按需加载高清图像，不要预加载它们。
5.  使用[压缩](http://pmt.sourceforge.net/pngcrush/)、[转换](http://www.irfanview.net/)（避免使用 png）和调整大小的图像以适应滑块容器。
6.  不要使用 CSS 或内联 CSS 缩放图像。（既不是服务器端）
7.  利用[延迟加载](http://en.wikipedia.org/wiki/Lazy_loading)设计模式。（如果你说有很多图片，页面会很长）

# php - Internet Explorer 中的 Codeigniter 会话问题

> ID：10288895
> 
> 赞同：1
> 
> 时间：2012-04-23T21:56:20.893
> 
> 标签：php, internet-explorer, codeigniter, session

我有一个使用 CI 会话类的 CI 应用程序。这是我遇到问题的过程：

1.  用户加载页面
2.  Ajax 请求从数据库中获取记录
3.  使用该记录的 ID 设置 userdata 变量并执行各种数据库操作
4.  用户刷新页面
5.  Ajax请求根据上一条记录的会话变量从DB获取记录（同一条记录不能连续传回两次）
6.  将 userdata 变量重新设置为新记录的 ID

等等等等

这在 chrome 和 FF 中完美运行。但很明显，当我在 IE 中进行测试时 - 不起作用。

执行 ajax 请求并检索第一条记录。此时会话变量已设置。用户刷新但仍保留相同的记录。

此时，如果我清除会话 cookie 并刷新新记录，则会检索到。

我试过改变：

```
$config['sess_cookie_name']     = 'ci_session'; 
```

至

```
$config['sess_cookie_name']     = 'cisession'; 
```

就像我在另一篇文章中看到的那样，但没有运气。还尝试使用数据库进行会话存储，但仍然没有运气。

这是问题页面： http: [//givestream.co.uk/stream](http://givestream.co.uk/stream)

在 chrome 或 FF 中加载它，然后刷新或点击“下一步”按钮，您会看到它检索了一个新的慈善机构。在 IE 中尝试此操作，除非您清除会话 cookie，否则它不起作用。

获取记录的JS函数：

```
function get_matches(){
    var charity;
    var user_total;
    jQuery.get("/stream/get_charity/", function(data){

        charity = data.charity;
        user_total = charity.user_totals;

        /** CHANGE URL **/

        if (history.pushState) {
            window.history.pushState("object or string", "Title", "/stream/"+charity.slug);
        }

        /*****************/

        // can user accept?
        if(charity.can_donate == 0){
            // No
            jQuery('.alert-message').show();
        } else{
            jQuery('.alert-message').hide();
        }

        // Charity Binding
        jQuery('p#char_modal_description').html(charity.description);
        jQuery('.char_more_link').attr('id', charity.id);
        jQuery('h1#char_name').html(charity.char_name);
        jQuery('h2#char_modal_header').html(charity.char_name);
        jQuery('p#char_desc').html(charity.description);
        jQuery('#website').html('<label>Website</label><a href="'+charity.website+'" style="color:#08C;" target="_blank">'+charity.website+'</a>');
        jQuery('#char_total').text('\u00A3'+charity.total);
        jQuery('#donors').html(charity.recent_donors);
        jQuery('#fans').html(charity.recent_fans);

        if (typeof user_total !== 'undefined') {
            jQuery('#total_char_month').text('\u00A3'+user_total.total_char_month);
            jQuery('#total_char_alltime').text('\u00A3'+user_total.total_char_alltime);
            var has_user_seen_stream_notice = user_total.has_user_seen_stream_notice;

            if(has_user_seen_stream_notice == false){
                jQuery('#stream_help').show();
            } 
        } else{
            jQuery('#total_char_month').text('\u00A3'+0);
            jQuery('#total_char_alltime').text('\u00A3'+0);
        }

        /** TWITTER SHARE BUTTON CHANGE URL **/

        var twitter = '<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://givestream.co.uk/stream/'+charity.slug+'" data-via="givestreamuk" data-hashtags="socialgiving">Tweet</a>';
        jQuery('#twitter_share').html(twitter);

        var jstext = '!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");';

        var script   = document.createElement("script");
        script.type  = "text/javascript";
        script.text  = jstext;
        jQuery('#twitter_share').append(script);

        // *************************************//

        /** FACEBOOK SHARE WIDGET **/

            var fb = '<iframe src="//www.facebook.com/plugins/like.php?href=http://givestream.co.uk/stream/'+charity.slug+'&amp;send=false&amp;layout=standard&amp;width=280&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=35&amp;appId=119083868224729" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:280px; height:35px;" allowTransparency="true"></iframe>';
            jQuery('#fb_share').html(fb);

        // ***********************//

        jQuery('#char_website').html(charity.website);

        jQuery('#sectors').html('<label>Tags</label>'+charity.sectors);
        jQuery('#permalink').val('http://givestre.am/stream/'+charity.slug);

        jQuery('#refresh').activity(false);

        get_charity_gallery();
        get_charity_shouts();

    }, 'json');

    return;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T13:33:14.937

固定的！

这似乎不是 ci_session 问题。

我挖得更深一点并补充说

```
log_message('info', 'queried!-'.$_SERVER['HTTP_USER_AGENT']); 
```

进入执行 json 响应的控制器，以查看 ajax 请求是否实际到达控制器，结果发现没有任何 IE ajax get 请求实际上到达控制器。

事实证明，即使 IE 网络检查器确认了 get 请求，它实际上是在使用缓存的 ajax 响应。

我添加了

```
jQuery.ajaxSetup ({
    // Disable caching of AJAX responses
    cache: false
}); 
```

到顶部的 js 脚本和繁荣。排序。

不过感谢@Laurencei 的帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T01:24:45.583

通过设置 sess_expire_on_close = true 试试这个。我在配置中使用此设置解决了我的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:57:15.120

尝试设置 $config['sess_match_useragent'] = FALSE;

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T05:21:33.750

忽略上面的评论 - 这是一个 CI 问题，而不是 JS 问题。

首先，如果“cookie_domain”设置不正确，IE 会话也可能会失败——尤其是留空时。所有其他浏览器将继续工作，但不是 IE。

其次 - 试试这个解决方案： [http ://codeigniter.com/forums/viewthread/203821/](http://codeigniter.com/forums/viewthread/203821/)

第三 - 使用这个解决方案（我使用 - 工作得很好）： [http](http://codeigniter.com/forums/viewthread/170123/) : //codeigniter.com/forums/viewthread/170123/ （大约一半 - WanWizard 发布的 MY_Session 文件

# mysql - yii CDbCriteria Join Column not found

> ID：10288896
> 
> 赞同：0
> 
> 时间：2012-04-23T21:56:39.923
> 
> 标签：mysql, yii

我一直在努力将以下 SQL 转换为 CDBCriteria 以与 CActiveDataProvider 一起使用：“SELECT PresetDeviceLink. *, Device.* FROM PresetDeviceLink INNER JOIN Device ON Device.id = PresetDeviceLink.deviceId WHERE Device.roomId = 1”

表结构如下：

```
mysql> describe PresetDeviceLink;
+----------+---------+------+-----+---------+----------------+
| Field    | Type    | Null | Key | Default | Extra          |
+----------+---------+------+-----+---------+----------------+
| id       | int(11) | NO   | PRI | NULL    | auto_increment |
| presetId | int(11) | NO   |     | NULL    |                |
| deviceId | int(11) | NO   |     | NULL    |                |
| state    | int(11) | NO   |     | 0       |                |
| value    | int(11) | NO   |     | 32      |                |
+----------+---------+------+-----+---------+----------------+

mysql> describe Device;
+-------------+--------------+------+-----+---------+----------------+
| Field       | Type         | Null | Key | Default | Extra          |
+-------------+--------------+------+-----+---------+----------------+
| id          | int(11)      | NO   | PRI | NULL    | auto_increment |
| ref         | int(11)      | NO   |     | NULL    |                |
| roomId      | int(11)      | NO   |     | NULL    |                |
| typeId      | int(11)      | NO   |     | NULL    |                |
| paired      | tinyint(1)   | NO   |     | 0       |                |
| name        | varchar(255) | YES  |     | NULL    |                |
| description | text         | YES  |     | NULL    |                |
| dimmerPos   | int(11)      | NO   |     | 0       |                |
+-------------+--------------+------+-----+---------+----------------+ 
```

我的控制器中的代码如下：

```
$criteria = new CDbCriteria;
$criteria->select = 'PresetDeviceLink.*, Device.*';
$criteria->join = 'INNER JOIN Device ON Device.id = PresetDeviceLink.deviceId';
$criteria->condition = 'Device.roomId = 1';

$presetDeviceLink=new CActiveDataProvider('PresetDeviceLink', array(
    'criteria' => $criteria,
)); 
```

运行时出现以下错误：

```
CDbCommand failed to execute the SQL statement: SQLSTATE[42S22]: <b>Column not
found</b>: 1054 Unknown column 'PresetDeviceLink.deviceId' in 'on clause'. The SQL
statement executed was: SELECT COUNT(*) FROM `PresetDeviceLink` `t` INNER JOIN
Device ON Device.id = PresetDeviceLink.deviceId WHERE Device.roomId = 1 
```

奇怪的是，如果我使用“设备”作为 CActiveDataProvider 源并将连接语句更改为“PresetDeviceLink”，它会抱怨找不到 Device.roomId 列。

我只是不明白 CActiveDataProvider 是如何工作的吗？在我看来，我只能使用传递给 CActiveDataProvider 的表中字段的条件（在联接或 where 子句中）。有什么建议吗？

PS - SQL 查询在 MySQL 控制台中运行良好。

在此先感谢，本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T05:35:49.273

正如在“执行的 SQL 语句是：”行中可见的，第一个表的别名为`t`. 这是 Yii 的标准行为。

因此，您应该使用该别名来引用该表，而不是`PresetDeviceLink`. 或者您可以`$criteria->alias = 'PresetDeviceLink';`在 中使用它之前尝试设置`CActiveDataProvider`，虽然我没有亲自尝试过该选项，但它应该可以工作。

# iphone - 在 iOS 中使用 searchDisplay 控制器搜索单词或字符的任意组合

> ID：10288897
> 
> 赞同：3
> 
> 时间：2012-04-23T21:56:41.913
> 
> 标签：iphone, ios, uitableview, uisearchbar, uisearchdisplaycontroller

嗨，我有一个填充 tableview 的主数组，并且我有一个用于搜索结果的过滤数组。使用以下方法，这两个都可以正常工作。除了此代码块下的以下问题外，我的 tableview 和搜索显示数组运行良好。

```
- (void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope 
```

{

```
[self.filteredListContent removeAllObjects]; // First clear the filtered array.

for (product *new in parserData)
{

    //Description scope
   if ([scope isEqualToString:@"Description"]) 

    {
        NSRange result = [new.description rangeOfString:searchText options:(NSCaseInsensitiveSearch|NSDiacriticInsensitiveSearch)];

        if (result.location != NSNotFound)
        {
            [self.filteredListContent addObject:new];
        }
    }

    //Product scope
    if ([scope isEqualToString:@"Product"])

    {
        NSRange result = [new.item rangeOfString:searchText options:(NSCaseInsensitiveSearch|NSDiacriticInsensitiveSearch)];

        if (result.location != NSNotFound)
        {
            [self.filteredListContent addObject:new];
        }
    }
} 
```

}

我想要达到的就是这个。我在主阵列中有一个名为**LMD-2451 TD Professional 3D LCD Monitor**的项目。我可以搜索**TD Professional**、**TD Pro**、**TD**并使用任何情况返回上述正确的项目。但是，如果我搜索**Pro TD**，它不会显示任何结果。我面临的问题是用户可能不知道产品标题或描述的顺序？所以我需要实现一些可以在逻辑上做到这一点的东西。我真的不知道该怎么做。

以供参考

NSMutableArray *parserData; // 完成主完整数组 NSMutableArray *filteredListContent; // 搜索结果数组

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:02:36.400

如何`componentsSeperatedByString:@" "`在您的搜索字符串上使用将其拆分为（在您的示例中）一个由 2 个字符串组成的数组，`@"Pro"`以及`@"TD"`. 然后使用`rangeOfString:`检查数组中的所有组件是否在`new.item`.

```
//Product scope
if ([scope isEqualToString:@"Product"])
{
    // Split into search text into separate "words"
    NSArray * searchComponents = [searchText componentsSeparatedByString: @" "];
    BOOL foundSearchText = YES;

    // Check each word to see if it was found
    for (NSString * searchComponent in searchComponents) {
        NSRange result = [new.item rangeOfString:searchText options:(NSCaseInsensitiveSearch|NSDiacriticInsensitiveSearch)];
        foundSearchText &= (result.location != NSNotFound);
    }

    // If all search words found, add to the array
    if (foundSearchText)
    {
        [self.filteredListContent addObject: new];
    }
} 
```

# javascript - 已绘制元素的 html5 动画画布

> ID：10288901
> 
> 赞同：0
> 
> 时间：2012-04-23T21:57:11.320
> 
> 标签：javascript, html, canvas

我可以在画布上获得动画元素的帮助吗？我想获取已经在画布上绘制的元素并将它们“移出”画布并显示新元素。我的函数在 javascript 中并且运行良好。我只想添加动画。TIA。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T22:07:28.067

只需让事件处理程序控制该`left`画布 id 的样式，然后指定一个循环以使其根据时间更改或向左/向右移动。

```
(function() {
var speed = 10,
movePic = function(moveBy) {
    var el = document.getElementById("animationStyle"),
        left = el.offsetLeft

    if ((moveBy > 0 && left > 399) || (moveBy < 0 && left < 51)) {
        clearTimeout(timer);
        timer = setInterval(function () {
            movePic(moveBy * -1);
        }, speed);
    } 
    el.style.left = left + moveBy + "px";
};
var timer = setInterval(function () {
movePic(3)
}, speed);
}()); 
```

这会来回移动它，这是一个可以帮助您入门的示例。

# tsql - 如何在单行列中显示一次，但在同一结果集中的多行列中继续显示信息？

> ID：10288902
> 
> 赞同：0
> 
> 时间：2012-04-23T21:57:13.813
> 
> 标签：tsql, sql-server-2005

我正在对我公司的台式机和当前安装的软件程序进行报告。

例如，假设我们有三列保证每台机器只返回一行：`Location, Last_logged-on_User, Machine_Name`和一列将返回一或多行：`Software`。我希望第一行显示所有单行列以及软件列的第一行以及仅显示软件行的其余行，并用空白填充单行列。

```
Location Last_logged-on_User Machine_Name Software_name
Venus    James.Jiao          McKain       Internet Explorer
                                          Firefox
                                          Antivirus X
                                          Office Suite
Mars     Veronica.Mars       Obama        Internet Explorer
                                          Google Chrome
                                          Adobe Acrobat
Jupiter  Taylor.Swift        Bachmann     Opera
                                          Speech Helper
                                          Dictionary for Kids 
```

我正在寻找这个查询，但我不太确定如何开始，因为我想不出有条件地将某些行中的单行列清空的方法。

如果需要，这是表结构

```
Create table Machine
(
  machine_id int not null,
  machine_name varchar(25) not null,
  last_logged-on_user varchar(25) not null,
  location varchar(25) not null
)

Create table SoftwareList
( 
  machine_id int not null,
  software_name varchar(25) not null
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-23T22:11:06.300

您可以使用`Row_Number() Over (Partition by`确定它是否是子查询中的第一次出现，然后使用 case 语句仅在行号为 1 时返回位置。

```
SELECT 
    CASE WHEN RowNo = 1 OR RowNo IS NULL THEN location ELSE '' END as Location,
    Software_name

FROM (
  SELECT 
        sl.Software_name ,
        m.location,
        ROW_NUMBER() OVER(Partition by location ORDER by location) as rowNo
  FROM Machine m
  LEFT JOIN Softwarelist sl
  ON sl.Machine_id = m.machine_id

  ) d 
```

[在此处](http://sqlfiddle.com/#!3/ecef5/6)查看 SQL Fiddle

希望有帮助

# iphone - 将子视图添加到单元格内容视图

> ID：10288907
> 
> 赞同：0
> 
> 时间：2012-04-23T21:57:48.743
> 
> 标签：iphone, objective-c, ios, ipad, uitableview

所以我有以下代码：

```
static NSString *CellIdentifier = @"RecommendationCell";

    UITableViewCell *cell = [self.tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"TableViewCell"] autorelease];
    }

    UIActivityIndicatorView *indicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
    [indicator setCenter:CGPointMake(0, 15)];
    [indicator startAnimating];
    [indicator hidesWhenStopped];

    UILabel *someLabel......... 

    UIView *containerView = [[UIView alloc] initWithFrame:CGRectZero];
    [containerView setAutoresizingMask:UIViewAutoresizingFlexibleWidth];
    [containerView setAutoresizesSubviews:YES];
    [containerView setBackgroundColor:[UIColor clearColor]];
    [containerView addSubview:indicator];
    [containerView addSubview:someLabel];
    [containerView setFrameSize:CGSizeMake(indicator.frameWidth+self.loadingGeniusLabel_.frameWidth, 30)];
    [containerView setCenter:CGPointMake(cell.contentView.center.x, 15)];

    [cell.contentView addSubview:containerView];

    [indicator release];
    [containerView release];

    return cell; 
```

我的问题是，上面的代码是否高效/干净？我问的原因是因为如果我们得到的单元格来自可重复使用的平台，那么它会有 UIActivityIndi​​cator 和必要的视图，对吗？我是否只需要在分配新单元格时才添加子视图（即：当单元格 == nil 时）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:03:53.410

> 上面的代码高效/干净吗？

不

> 如果我们得到的单元格来自可重复使用的卡片组，那么它将具有 UIActivityIndi​​cator 和正确的必要视图

是的，但是由于您使用的是通用 UITableViewCell，因此添加一次后，您将无法访问 UIActivityIndi​​cator。您需要创建 UITableViewCell 的子类才能有效地执行此操作。

> 我是否只需要在分配新单元格时才添加子视图（即：当单元格 == nil 时）？

是的

如果您绝对需要，仅在 if (cell == nil) 块之外调用 addSubview ，这是一个昂贵的方法调用，并且会在滚动表格时严重影响您的每秒帧数。

你最好的选择是继承 UITableViewCell。这样，您需要控制不同单元格的值/行为的任何对象/UIView（或 UIView 子类）都更适合作为 UITableViewCell 子类的属性。通过这样做，您可以在 xib 文件或单元设置中（在 if 语句中）实例化它们，然后只需更改每个单元的值（而不是每次都创建新对象）。

Apple's Table View Programming guide discusses this in depth: [http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/AboutTableViewsiPhone/AboutTableViewsiPhone.html#//apple_ref/doc/uid/TP40007451](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/AboutTableViewsiPhone/AboutTableViewsiPhone.html#//apple_ref/doc/uid/TP40007451)

Apple's sample project shows a couple different ways for managing table cells efficiently: [https://developer.apple.com/library/ios/#samplecode/TableViewSuite/Introduction/Intro.html](https://developer.apple.com/library/ios/#samplecode/TableViewSuite/Introduction/Intro.html)

# windows - Wireshark 过滤器语法

> ID：10288908
> 
> 赞同：2
> 
> 时间：2012-04-23T21:57:56.047
> 
> 标签：windows, networking, wireshark

我正在尝试为基于命令行的 Wireshark 为 TShark 编写过滤器。我想将这些选项添加到命令中：

```
-i 2 (interface with index n°2)
-a duration:60 (the "scan" should last 60 seconds)
-v (print the result and exit)
-x (print an ASCII dump in the file) 
```

和一个仅捕获具有这些特殊性的数据包的过滤器：

```
"ip" (only IP packets)
"ip.src == 192.168.0.1" (source IP adress should be 192.168.0.1)
"ip.dst == 111.222.111.222" (destination IP adress should be 111.222.111.222)
"port == 80 or port == 443" (port should be http or https)
"http.request.method == 'GET'" (it should be a GET request) 
```

然后我希望将结果保存在文件“test.txt”中。所以最终的命令应该是这样的：

```
tshark -i 2 -a duration:60 -vx -f "ip" && "ip.src == 192.168.0.1" && "ip.dst == 111.222.111.222" && "port == 80 or port == 443" && "http.request.method == 'GET'" > test.txt 
```

但我不断收到来自 Windows 的错误消息，说这`'"ip.src == 192.168.0.1"`不是可识别的内部或外部命令。我尝试使用空格，没有空格......等等，但无法找到完成这项工作的方法。

问题可能来自我“链接”条件的方式。

*   还想问是否有某种“停止执行”命令可以停止当前捕获但仍将结果保存在 .txt 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-06T18:24:08.567

> 以及仅捕获具有这些特殊性的数据包的过滤器

...

> “http.request.method == 'GET'”（应该是 GET 请求）

最后一部分***很难***用捕获过滤器完成。如果你能避免这种情况，*剩下*的就用一个捕获过滤器相对容易地完成：

```
"ip src 192.168.0.1 && ip dst 111.222.111.222 && (tcp port 80 or tcp port == 443)" 
```

您*也许*可以将整个 *shark 过滤器用作*读取*过滤器：

```
-r "ip && ip.src == 192.168.0.1 && ip.dst == 111.222.111.222 && (tcp.port == 80 or tcp.port == 443) && http.request.method == 'GET'" 
```

（请注意，它是`tcp.port`，而不仅仅是`port`）。

*但是*，请注意，对于 HTTP-over-SSL/TLS，如果请求是加密的，您必须安排解密这些请求`http.request.method == 'GET'`才能正常工作。

（“或”子句周围的括号可能不是必需的，但我更喜欢它们，只是为了使表达式的含义更明显。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:22:19.377

tshark`-f`选项采用[捕获过滤器](http://wiki.wireshark.org/CaptureFilters)，而不是wireshark 显示过滤器。这与[libpcap](http://www.manpagez.com/man/7/pcap-filter/)语法相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T13:20:37.720

您必须删除`"`过滤器部分之间的字符。尝试：

```
"ip && ip.src == 192.168.0.1 && ip.dst == 111.222.111.222 &&
 port == 80 or port == 443 && http.request.method == 'GET'" 
```

# ios - 在 UITableView 中显示文件的 NSArray - iOS 5

> ID：10288912
> 
> 赞同：1
> 
> 时间：2012-04-23T21:58:18.040
> 
> 标签：ios, objective-c, uitableview, directory, nsarray

我有一个允许用户保存和打开文本文件的应用程序。保存和打开文件相当简单明了，但我必须为用户提供一种简单的方法来选择要打开的文件。我决定用**UITableView**来做这件事。

当 TableView 在我的视图控制器中加载时，我的目标是使用 Documents 文件夹（iOS 应用沙箱的一部分）中的所有用户文本文件的名称填充 TableView。

我对如何做到这一点有一个大致的了解：

1.  获取 Documents 文件夹的内容并将其放入数组中

    ```
    NSString *pathString = [[NSBundle mainBundle] pathForResource:@"Documents" ofType:@"txt"];
    NSArray *fileList = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:pathString error:nil];
    NSLog(@"Contents of directory: %@", fileList); 
    ```

    但这总是返回：`(null)`在输出窗口中。**我的应用程序文档文件夹的路径是什么？**

2.  将数组放在 UITableView 中

    我想我会用这个`numberOfRowsInSection`方法来做到这一点。**这是执行此类操作的正确位置吗？**我应该使用不同的方法吗？

3.  最后，应用程序将获取所选单元格的值并使用该值打开文件。

* * *

我的主要问题是：**如何将项目（尤其是目录的内容）放入 NSArray，然后在 UITableView 中显示该数组？**

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T22:17:56.940

您可以使用以下方式获取路径：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0]; 
```

您可以使用以下命令获取目录的内容：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSArray *fileList = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:documentsDirectory error:nil]; 
```

至于在 UITableView 中显示 NSArray，您应该查看 Apple 关于 UITableView 数据源协议的文档：

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html)

您使用 cellForRowAtIndexPath 方法来实际填充表格，这样的事情会起作用：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MyIdentifier"];

    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"MyIdentifier"] autorelease];
    }

    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    cell.textLabel.text = [fileList objectAtIndex:indexPath.row]

    return cell;
} 
```

# c# - 使用 DateTime 计算前几天会导致 UTC 格式出现问题

> ID：10288915
> 
> 赞同：1
> 
> 时间：2012-04-23T21:58:31.493
> 
> 标签：c#

我有一个 Windows 服务，每天晚上 3 点到 5 点之间运行。当作业运行时，会发生以下情况：

```
var endDate = DateTime.Today.ToUniversalTime(); // Set to midnight
var startDate = endDate.AddDays(-1); 
```

夜间运行的查询类似于（所有日期当前存储为 UTC）：

```
SELECT * FROM Table WHERE CreatedAt BETWEEN startDate AND endDate 
```

这很好用，它基本上会在作业运行时抓取前一天的所有数据。我现在正在为此开发一个 UI 部分，用户单击一个按钮以查看将在晚上处理的数据计数。

我遇到的问题是当用户在正常工作时间内工作并单击该按钮时，计数将关闭 1 天。仅当本地时间在美国东部标准时间晚上 8 点之后（服务器位于东海岸）时，计数才会正确显示，因为那将是 UTC 时间午夜之后。

我试图用类似的方法解决这个问题：

```
var now = DateTime.Now;
var midnight = DateTime.Today.ToUniversalTime();

var endDate = (now.Day == midnight.Day) ? midnight.AddDays(1) : midnight;
var startDate = endDate.AddDays(-1); 
```

但这是不正确的，因为它只会在一天中的某些时候起作用。如果在当地时间午夜之后单击该按钮，它将再次关闭一天。

有没有什么巧妙的方法可以使用 DateTime 对象来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:15:45.813

您可以在 UI 中将本地时间转换为 UTC；或者只是使用`DateTime.UtcNow`. 您必须小心，`ToUniversalTime`因为它仅在`DateTime`您调用它时才有效`Kind==DateTimeKind.Local`：

```
var localTimeUtc = TimeZoneInfo.ConvertTimeToUtc(
  DateTime.SpecifyKind(DateTime.Now, DateTimeKind.Local));

//or (much easier)
var localTimeUtc = DateTime.UtcNow; 
```

接着：

```
var utcMidnight = localTimeUtc.Date;
var yesterdayUtcMidnight = midnight.AddDays(-1); 
```

现在`utcMidnight`并将`yesterdayUtcMidnight`涵盖 UTC 时间的所有“昨天”。

第二个注意事项 - 您的 Windows 服务是要处理昨天 UTC 或昨天本地的数据吗？如果数据库中的时间是 UTC，那么您的服务代码应该可以工作 - 但如果它们已作为本地时间输入（可能是默认时间`GetDate()`？），那么您的处理代码将无法工作。

# clojure - 如何创建记录的新实例？

> ID：10288916
> 
> 赞同：1
> 
> 时间：2012-04-23T21:58:32.373
> 
> 标签：clojure

鉴于我定义了两个对象（在本例中为记录）：

```
(defrecord rec1 [one two])
(defrecord rec2 [one two]) 
```

我在列表中有这两条记录（未实例化）：

```
(def recs [rec1 rec2]) 
```

如何在列表中实例化这两条记录的最佳方法是什么？

下面给出一个例外

```
(map (fn [rec] (rec. 1 2)) recs) 
```

因为 new 和点构造函数需要一个类名符号。那么解决这个问题的最佳方法是什么？到目前为止，反射似乎是唯一的方法：

```
(map #(clojure.lang.Reflector/invokeConstructor % (to-array [1 2 3])) recs) 
```

这似乎是一种过于丑陋（且缓慢）的方式来执行看似简单的任务，即在对象上调用构造函数。那么正确（或惯用）的方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:14:26.567

你的问题我不清楚，但这里有一些观察：

*   rec1 和 rec2 不是同一类型的不同 ctor，而是不同的类型，每个类型都有 1 个 ctor（巧合的是，两个 ctor 具有相同的数量/签名）
*   您的“未列出的列表”没有意义。
*   defrecord 为这个用途生成了一些辅助函数......

我不确定您到底要做什么，这里有一些示例可能会阐明您的要求...

```
(def r1 (->rec1 1 2))
;=> #user.rec1{:one 1, :two 2}

(def c1 (rec1\. 1 2))
;=> #user.rec1{:one 1, :two 2}

(def m1 (map->rec1 {:one 1 :two 2}))
;=> #user.rec1{:one 1, :two 2}

(def r2 (->rec2 1 2))
;=> #user.rec2{:one 1, :two 2}

(def c2 (rec2\. 1 2))
;=> #user.rec2{:one 1, :two 2}

(def recs [(rec1\. 1 2) (->rec1 1 2)])

(for [[n m] (partition 2 (range 4))] (->rec1 n m))
;=> (#user.rec1{:one 0, :two 1} #user.rec1{:one 2, :two 3}) 
```

# python - 使用模拟对象的困境

> ID：10288918
> 
> 赞同：4
> 
> 时间：2012-04-23T21:58:41.923
> 
> 标签：python, unit-testing, mocking

假设我想断言它`result`采用特定格式，我可能会将返回值设置为`(True, 'Success')`

```
def batch_move(self, *args, **kwargs):
  ''' 
  Move a batch of files to its respective destinations.
  Return type: tuple (boolean, message)
                      T/F    , 'string' / str(exception)
  '''

  srcs= kwargs.get('srcs', None)
  dests = kwargs.get('dests', None)

  try:
    if srcs and dests:
       # map srcs and dests into dictionary (srcs --> keys, dests --> values)
       src_dest= dict(zip(srcs, dests))     

       for src, dest in src_dest:
         if os.path.exists(src):
           if os.path.exists(dest):
              shutil.rmtree(dest)
           shutil.move(src, dest)   # either way we will proceed to move
         else:
           return (False, '%s does not exist!' % src)
       return (True, 'Success!')

    else:
       return (False, 'Something gone wrong with those kwargs...')
  except Exception as e:
    return (False, e) 
```

为了到达`return (True, 'Success!')`

1.  补丁作为`os.path.exists`返回`True`值。但是在一个单元测试中我想跳过这个，我该如何修补`os.path.exists`呢？

> ```
>  if os.path.exists(dest):  # I want to skip this
>          shutil.rmtree(dest) 
> ```

1.  我该如何修补`shutil.move(src, dest)`？我只是给`True`它不产生错误吗？如果我想要它失败并捕获异常的情况怎么办？我该如何模拟呢？（我并不总是知道要捕获哪个异常，这是使用的主要原因`Exception as e`）。

2.  如果我真的通过了这个函数，这是否真的意味着没有捕获到异常并且它通过了每一行？还是因为我设置了 `mock_object.return_value = (True, 'Success!')？

3.  我只使用了两个依赖项，我是否需要将所有外部依赖项（例如（os、sys、math、datetime））全部修补？或者，如果我的函数正在使用其他函数（已重构）

> ```
>  def f1(*args, **kwargs):
>     f2(..)   # use math, plot, datetime
>     f3(..)   # use math and datetime
>     f4(..)   # use datetime
> 
>     .... 
> ```

谢谢。对不起，很长的问题。我真的很想擅长编写单元测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T00:23:45.173

我必须说，在这个特定的用例中，我认为修补/模拟不是最好的选择......

对于这个单元测试，我将在文件系统中创建一个结构，在磁盘中的该结构上运行算法并检查不同的结果（所有这些都没有模拟 os 或 shutil）。

通常我倾向于在外部设置困难或缓慢时（即：可能必须设置一些外部数据库）或它会停止测试（即：打开一些对话框）或当我想做一些困难的事情时使用补丁检查其他情况（例如计算是否实际访问了某些缓存）。

除此之外，修补/模拟太多给我的印象是你的设计有问题（这不是在考虑单元测试的情况下完成的），所以，把它分成更小的块来测试可能会有所帮助......

# git - 在不同 git repos 之间合并/修补更改的最佳方法

> ID：10288921
> 
> 赞同：2
> 
> 时间：2012-04-23T21:59:02.847
> 
> 标签：git, github, git-svn

我一直无法找到解决此问题的适当方法，因此将不胜感激。这是设置：

1.  我们有一个 SVN 存储库。该 repo 也镜像到 git repo `git_svn_mirror`。
2.  `svn_branch`在 SVN 存储库中创建了一个分支。
3.  工作已完成`svn_branch`，包括多次从主干合并。
4.  一个新的 git repo`git_from_svn_branch`是从`svn_branch`.
5.  工作在`git_from_svn_branch`.
6.  我们现在需要将 HEAD 合并`svn_trunk`到`git_from_svn_branch`.

图表：

```
[git_svn_mirror] [SVN]                [git_from_svn_branch]
      |  <-mirror  |
      |  <-mirror  |
      |  <-mirror  |-\                        \
      |  <-mirror  | |                        |
      |  <-mirror  |-|                        |
      |  <-mirror  | |  --> (move to git) --> | (kept branch history only)
      |  <-mirror  |                          |
      |  <-mirror  |                          |
      |  <-mirror  |                          |
      |  <-mirror  |                        HEAD    <----
      |  <-mirror  |                                    |
    HEAD         HEAD                                   |
                                                        |
     ^            ^                                     |
     |____________|__ how do we get one of these, into  |__ this (or vice-versa) 
```

忽略导致我们遇到这种情况的问题（“为什么要创建第二个 git repo”等）什么是问题的最佳解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:19:22.097

```
git remote add git-from-svn-mirror its://repo/url
git fetch git-from-svn-mirror

git merge git-from-svn-mirror/master 
```

应该这样做。

# c# - 管理两个组合框，其中只有一个必须有值

> ID：10288923
> 
> 赞同：1
> 
> 时间：2012-04-23T21:59:18.103
> 
> 标签：c#, combobox

我的 DevExpress LookUp 控件中有这个简单的代码（应该与普通的组合框相同）

```
private void lookUpUsers_EditValueChanged(object sender, EventArgs e)
{
    lookUpRolesPréÉdit.EditValue = null;
}

private void lookUpRolesPréÉdit_EditValueChanged(object sender, EventArgs e)
{
    lookUpUsers.EditValue = null;
} 
```

问题是，当我在 中选择一个值时`lookUpUsers`，会重置另一个查找，然后再重置`lookUpUsers`。因此，当我选择一个值时，两个组合框都变为空。我想要的是，当您在组合框 1 中选择一个值时，组合框 2 会重置其值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:06:40.813

可能有比这更简单的方法，因为我对 C# 的了解有限（尤其是他们的库，比如你在这里使用它们）。然而，这是一个不使用库提供的魔法的答案：

```
private bool localEdit = false;

private void lookUpUsers_EditValueChanged(object sender, EventArgs e)
{
    if (!localEdit)
     {
        localEdit = true;
        lookUpRolesPréÉdit.EditValue = null;
        localEdit = false;
    }
}

private void lookUpRolesPréÉdit_EditValueChanged(object sender, EventArgs e)
{
    if (!localEdit)
    {
        localEdit = true;
        lookUpUsers.EditValue = null;
        localEdit = false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:37:10.533

这个怎么样：

```
private void lookUpUsers_EditValueChanged(object sender, EventArgs e)
{
    if(lookUpUsers.EditValue != null)
        lookUpRolesPréÉdit.EditValue = null;
}

private void lookUpRolesPréÉdit_EditValueChanged(object sender, EventArgs e)
{
    if(lookUpRolesPréÉdit.EditValue != null)
        lookUpUsers.EditValue = null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-23T23:06:50.650

这是我想出的解决方案

```
private void lookUpUsers_EditValueChanged(object sender, EventArgs e)
{
    if (!isEditFinished)
    {
        isEditFinished = true;
        lookUpRolesPréÉdit.EditValue = null;
    }

    isEditFinished = false;
}

private void lookUpRolesPréÉdit_EditValueChanged(object sender, EventArgs e)
{
    if (!isEditFinished)
    {
        isEditFinished = true;
        lookUpUsers.EditValue = null;
    }

    isEditFinished = false;
} 
```

# facebook - 可以在单个页面上将多个操作共享到时间轴吗？

> ID：10288924
> 
> 赞同：0
> 
> 时间：2012-04-23T21:59:19.023
> 
> 标签：facebook, facebook-graph-api, facebook-timeline

是否可以在单个页面上将多个（唯一）操作发布到 Facebook 的时间轴？

例如，假设我有一个像 reddit 这样的聚合器，我想在用户对故事进行投票时发布。我希望每个支持都作为一个单独的事件发布（“用户 x 在 my_app_name 上支持故事 y”）。

本[教程](https://developers.facebook.com/docs/opengraph/tutorial/)描述了 facebook 如何使用自定义“元”标签来检索有关操作的信息。我还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T22:09:47.223

没有元标记的发布是不可能的。为什么不创建一个通过 $_GET 获取元信息的自定义站点并共享此 URL？

# c# - 如何在更新数据库时更新数据集

> ID：10288926
> 
> 赞同：0
> 
> 时间：2012-04-23T21:59:31.460
> 
> 标签：c#, .net, dataset

我有一个集中式数据库和 2 个（或超过 2 个）可以访问它的用户同时工作。当 USER1 登录时，数据库中的所有数据都输入数据集，用户使用该数据集获取数据。现在位置表有 5 个条目/位置名称。同时 USER2 将位置（芝加哥）添加到数据库。现在我想访问 USER1 系统中的新位置（芝加哥）。

我需要为此使用触发器吗？还是我应该尝试线程？

如果这不是操作应用程序的可行方式，请告诉我。欢迎任何其他和相关信息。

我没有足够的知识来理解这一切，我只是在学习所有这些技术、技术和概念。对不起，如果这是一个愚蠢的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T18:30:42.413

定义客户端之间基于数据库的依赖关系，客户端可以订阅数据库，以便在数据更改时通知其所有依赖项。它被称为 sqldependency 通知，它使用服务代理。检查链接。

[http://www.codeproject.com/Articles/144344/Query-Notification-using-SqlDependency-and-SqlCach](http://www.codeproject.com/Articles/144344/Query-Notification-using-SqlDependency-and-SqlCach)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T11:41:23.777

您可以在 sql server 中注册 Sqldependency。

请参阅[Sql Server 2008 的更改通知](https://stackoverflow.com/questions/877273/change-notification-with-sql-server-2008)

[http://www.codeproject.com/Articles/12335/Using-SqlDependency-for-data-change-events](http://www.codeproject.com/Articles/12335/Using-SqlDependency-for-data-change-events)

# asp.net - 如果已将父对象分配给我的 asp.net MVc Web 应用程序中的子对象，我如何防止编辑父对象

> ID：10288933
> 
> 赞同：0
> 
> 时间：2012-04-23T22:00:09.080
> 
> 标签：asp.net, asp.net-mvc-3, entity-framework-4

我有两个对象：-

```
LabTest
LabTestDetails 
```

一个`LabTest`对象可以有零个或多个`LabTestDetails`对象。我需要实现以下业务规则：-

*如果已将 LabTest 对象分配给一个或多个 LabTestDetails 对象，则用户应该无法编辑它。*

目前我已经实现了一个名为`IsAlreadyAssigned`LabTest 对象的辅助方法（检查 LabTest 对象是否已分配给任何 LabTestDetails 对象）：-

```
public partial class LabTest 
    {    
public bool IsAlreadyAssigned(int id)
            {

                return (LabTestDetailss.Any(r2 => r2.LabTestID == id));

            }} 
```

然后我在`Get & Post`编辑操作方法上添加了以下检查：-

```
 public ActionResult Edit(int id)
    {

        LabTest c = repository.GetLabTest (id);

        if ((c == null) ||  (c.IsAlreadyAssigned (id)))
        {
            return View("Error");
        }

        return View(c);
    }

    [HttpPost]
    public ActionResult Edit(int id, FormCollection colletion)
    {

       LabTest c = repository.GetLabTest (id);
       if ((c == null) ||  (c.IsAlreadyAssigned (id))) // *******
        {
            return View("Error");
       }
        try
        {
            if (TryUpdateModel(c))
            {

                elearningrepository.Save();
                return RedirectToAction("Details", new { id = c.LabTestID });
            }
        } 
```

以上可能在大多数情况下都可以正常工作，但是如果在检查 post 操作方法`LabTest`后，对象刚刚被另一个用户分配给 labTestDetails 对象，`if ((c == null) || (c.IsAlreadyAssigned (id)))`我在上面的代码中将其标记为（*******），那么我的业务逻辑将被打破。

**那么有没有一种方法可以实现我的操作方法，这样如果它已分配给 LabTestdetail 对象，它将始终阻止编辑 LabTest 对象。**

BR

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T20:56:05.123

您可以按照评论中的建议使用存储过程，但您也可以创建一个服务方法来检查是否`LabTest`分配了 a ，例如

```
public bool LabTestIsAssigned(int labTestId)
{
    using (var context = new YourContext())
    {
        return context.LabTestDetails.Any(d => d.LabTestID == id);
    }
} 
```

使用这种方法而不是使用导航属性的优点是可以保证反映数据库的当前状态。

请注意，您还必须在保存更改之前进行此检查！即便如此，在评估检查之后和保存更改之前可能会立即发生插入。

# css - 谷歌网络字体在 Chrome/Mac 上以某些像素大小显示奇怪

> ID：10288934
> 
> 赞同：1
> 
> 时间：2012-04-23T22:00:19.460
> 
> 标签：css, google-chrome, webfonts, google-webfonts

我正在使用 Google Web 字体“Buenard”，但很难让它在 Chrome 上显示。我知道各种浏览器的字体渲染和提示存在问题，但这完全是另一回事。Chrome 在我的系统上显示了其他一些 dingbat 字体，而不是预期的字体。它在 Safari 中看起来很棒。

我无法共享链接，因为有问题的网站位于受保护的登录名后面。但是，请查看此屏幕截图以了解我正在查看的内容：http: [//bit.ly/ImiiDM](http://bit.ly/ImiiDM)

在 CSS 中，我使用的是“Buenard”、Georgia、“Times New Roman”、serif 的字体堆栈；我也尝试使用'"Buenard", serif;' 没有效果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T02:30:30.383

不要使用样式表来附加字体，只需在网络上搜索您想要的字体并下载并附加它，如下所示：

```
@font-face {
font-family: buenard;
src: url('buenard.ttf');
} 
```

之后，您可以像使用普通 CSS 声明一样使用它：

```
p.custom_font{
font-family: buenard; /* no .ttf */
} 
```

# c# - 如何确定是否在 KeyPress 事件中按下了 Backspace？

> ID：10288939
> 
> 赞同：10
> 
> 时间：2012-04-23T22:01:01.347
> 
> 标签：c#, winforms, keypress, keycode

这：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keypress.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keypress.aspx)

...表示我应该可以在 KeyPress 事件中访问 e.KeyCode，但我似乎没有。我试图只允许 1、2、3 和退格：

```
private void textBoxQH1_KeyPress(object sender, KeyPressEventArgs e) {
  if ((e.KeyChar != '1') &&
      (e.KeyChar != '2') &&
      (e.KeyChar != '3') &&
      (e.KeyChar != (Keys.Back))) {
    e.Handled = true; 
  }
} 
```

...但是“e”。没有像示例所示那样显示“KeyCode”值，并且尝试使用 KeyChar 和 Keys.Back 责骂我，“运算符'！='不能应用于'char'和'System.Windows.Forms.Keys'类型的操作数"

那么我怎样才能做到这一点呢？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-23T22:07:49.200

尝试比较`e.KeyChar != (char)Keys.Back`，你应该把它转换为 char 因为 Keys 是一个枚举

看到这个：[KeyPressEventArgs.KeyChar](http://msdn.microsoft.com/es-es/library/system.windows.forms.keypresseventargs.keychar%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T22:06:13.860

我很确定我只是通过使用`KeyDown`事件来解决这个问题；它有不同的事件参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-22T05:07:17.377

尝试提出这样的条件：

**代码 ：**

```
 if (e.KeyCode == (Keys.Back))
 {
        if(textBox1.Text.Length >=3)
        {
             if (textBox1.Text.Contains("-"))
             {
                 textBox1.Text.Replace("-", "");
             }
        }
 } 
```

# android - 将 PayPal 与 Android 应用程序集成，无需用户拥有 PayPal 帐户

> ID：10288940
> 
> 赞同：2
> 
> 时间：2012-04-23T22:01:02.300
> 
> 标签：android, paypal

我正在开发一个 Android 应用程序，用户可以在其中输入并（安全地）保存他们的信用卡信息。然后，我希望用户可以选择通过 PayPal 付款。如果用户有一个 PayPal 账户，看起来很简单，但有些用户不会。是否可以使用存储的信用卡信息而不是让用户登录 PayPal 进行 PayPal 付款？

谢谢，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:10:00.573

根据 PayPal 的网站，[“您的买家不需要 PayPal 帐户”](https://www.paypal.com/webapps/mpp/compare-business-products)。具体来说，您可以使用[Direct Payment API](https://www.paypal.com/cgi-bin/webscr?cmd=xpt/Merchant/merchant/DCCIntro-outside)。

# java - App Engine 的 URLFetch：http GET 在本地工作，但在特定 URL 上部署到 GAE 时不起作用

> ID：10288942
> 
> 赞同：4
> 
> 时间：2012-04-23T22:01:07.260
> 
> 标签：java, http, google-app-engine, get

**问题：**

在本地，我的应用程序运行良好。我的 HTTP GET 返回代码 200 和最终 URL：[http://vow.mlspin.com/clients/index.aspx](http://vow.mlspin.com/clients/index.aspx)？

我的应用程序的其余部分也很好用。

当我将代码部署到 GAE 服务器（我使用 Eclipse 插件进行部署）时，我的应用程序停止工作，因为返回了错误的 html 页面！返回码仍然是 200，但 URL 现在是（最终 URL）：http: [//vow.mlspin.com/clients/signin.aspx ?id=](http://vow.mlspin.com/clients/signin.aspx?id=)

**我的问题是：**重定向有问题吗？谷歌应用引擎服务器是否以某种方式被列入黑名单？我在这里做错了什么？有没有人遇到过这个？

我发现的最接近的问题是这个：[来自 GAE Java 的 Http GET](https://stackoverflow.com/questions/8412685/http-get-from-gae-java)我已经实现了这个建议，但到目前为止它对我没有用。

谢谢大家！

Additional Info -> 下面是来自相同 GET 请求的 HTTPResponse 标头，一个来自本地部署，另一个来自 GAE 部署。

**本地 HTTP 响应标头**

```
Date :: Tue, 24 Apr 2012 04:12:32 GMT
Server :: Microsoft-IIS/6.0
X-Powered-By :: ASP.NET
X-AspNet-Version :: 2.0.50727
P3P :: CP="NOI DSP COR NID ADMa OPTa OUR NOR"
Cache-Control :: no-cache
Pragma :: no-cache
Expires :: -1
Content-Type :: text/html; charset=utf-8
Content-Length :: 133704 
```

**部署的 HTTP 响应标头**

```
date :: Tue, 24 Apr 2012 04:11:19 GMT
server :: Microsoft-IIS/6.0
x-powered-by :: ASP.NET
x-aspnet-version :: 2.0.50727
p3p :: CP="NOI DSP COR NID ADMa OPTa OUR NOR"
cache-control :: private
content-type :: text/html; charset=utf-8
content-length :: 4991
x-google-cache-control :: remote-fetch
via :: HTTP/1.1 GWA 
```

**我如何制定我的要求：**

首先我尝试了简单的方法

```
Document doc = Jsoup.connect(baseMLSURL).get(); 
```

然后我试着去低级，只使用 java.net

```
private String getHttpFromServer(String url) throws IOException
    log.severe("getting http from: "+ url);
    StringBuilder sb = new StringBuilder();
    URL yahoo = new URL(url);
    URLConnection yc = yahoo.openConnection();
    yc.setRequestProperty("Host", "vow.mlspin.com");
    yc.setRequestProperty("User-Agent", "Mozilla/5.0 (X11; Linux i686; rv:7.0.1) Gecko/20100101 Firefox/7.0.1");
    BufferedReader in = new BufferedReader(
                            new InputStreamReader(
                            yc.getInputStream()));
    String inputLine;

    while ((inputLine = in.readLine()) != null) {
        sb.append(inputLine.replaceAll("&nbsp", " ")+"\r\n");
    }
    in.close();

    return sb.toString();
} 
```

最后我也尝试使用谷歌的 URLFetcher

```
private String getHttpUsingFetchService(String url) throws MalformedURLException, IOException {
    URLFetchService fetchService = URLFetchServiceFactory.getURLFetchService();
    HTTPResponse targetResponse = fetchService.fetch(new URL(url)); // Error
    log.severe("Code returned from request: "+targetResponse.getResponseCode());
    log.severe("final URL: "+targetResponse.getFinalUrl());
    String result = new String(targetResponse.getContent());
    return result.replaceAll("&nbsp;", " ");
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T05:15:40.783

几个月前我们在这里也遇到过类似的事情。最后，谜团在于该网站重定向到自己并期望看到它设置的一些cookie。但是 urlfetch 重定向处理不会发送它收到的任何 cookie。本地运行时的 urlfetch 仿真可能与 cookie 不同。

如果你不能让它工作，你可能想在 urlfetch 中关闭重定向跟踪并自己管理重定向和 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T00:38:20.403

您尝试访问的服务需要身份验证。尝试访问您在新浏览器或隐身窗口中发布的第一个 URL - 您将被重定向到第二个 URL。您需要使用您的应用程序执行登录步骤，然后获取您发出的 cookie 并在所有后续请求中发送它们。

# php - 从 musicbrainz xml 获取艺术家国家（使用 php）

> ID：10288944
> 
> 赞同：1
> 
> 时间：2012-04-23T22:01:21.287
> 
> 标签：php, xml

所以这是 musicbrainz 返回的示例 xml（用于艺术家“Absynthe Minded”和歌曲“Moodswing Baby”）：

```
<metadata xmlns="http://musicbrainz.org/ns/mmd-2.0#" xmlns:ext="http://musicbrainz.org/ns/ext#-2.0">
   <recording-list offset="0" count="3">
      <recording ext:score="100" id="580d3e6f-6b2a-4f2c-bb06-a73486de50b8">
         <title>Moodswing Baby</title>
         <length>230706</length>
         <artist-credit>...</artist-credit>
         <release-list>
            <release id="f183e8a3-5326-44c9-8ab3-00a2dbb74caf">
               <title>Absynthe Minded</title>
               <status>Official</status>
               <release-group type="Album"/>
               <date>2009</date>
               <country>BE</country>
               <medium-list>...</medium-list>
            </release>
            <release id="fccd0f03-30e5-44ac-8825-a61ad8b25442">...</release>
            <release id="b3873ea0-0ed3-48f1-9703-4f5302460d0e">...</release>
            <release id="b68fb38c-5a5a-4d24-bd41-2c50945cef39">...</release>
         </release-list>
         <puid-list>...</puid-list>
         <isrc-list>...</isrc-list>
      </recording>
      <recording ext:score="100" id="359c27e3-5153-445e-aa66-71d8152d19e4">...</recording>
      <recording ext:score="31" id="e9e4628a-61ff-4dd7-8fbb-a8d655d29a5a">...</recording>
   </recording-list>
</metadata> 
```

我正在尝试在我的网站上的艺术家姓名旁边打印那个国家“BE”：

```
<?php
   $xml = simplexml_load_file("http://www.musicbrainz.org/ws/2/recording?query=moodswing%20baby%20AND%20artist:absynthe%20minded");
   $info = $xml->recording-list->recording[1]->release-list->release[1]->country;
   echo $info;
?> 
```

我使用相同的方法从 last.fm 的数据库（也是 xml）中检索歌曲和艺术家信息，但它似乎不适用于此（T_OBJECT_OPERATOR，期待'（'错误）。我试图删除 [1]但没有结果。

有什么想法可以检索和打印该国家/地区吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:13:30.860

包含 PHP 变量名中不允许的字符的 XML 元素名必须用大括号括起来或放在变量的前面，例如`$recordingList = 'recording-list'; $xml->$recordingList;`. 此外，数组是从零开始的：

```
$xml->{'recording-list'}->recording[0]->{'release-list'}->release[0]->country; 
```

[http://codepad.org/Yhz3V3wE](http://codepad.org/Yhz3V3wE)

# flash - highscore-api vs 赞助

> ID：10288945
> 
> 赞同：1
> 
> 时间：2012-04-23T22:01:22.907
> 
> 标签：flash, api

我的 Flash 游戏快完成了，但有一个（大？）问题：

在当前状态下，我的游戏使用 mochileaderboards（mochi 的评分系统）来显示高分列表。我还没有上传游戏，所以高分列表只是显示垃圾，因为我只是想测试它是否适用于我的代码。到目前为止，一切都很好。

现在我读到，当我想将它上传给赞助商时，我必须删除任何 mochi-api 或其他类似的东西，因为赞助商不想看到任何不同的徽标，除了他们的。

但是当我删除评分系统时，我是否也应该删除适当的评分界面（评分、提交等）？我只是问，因为没有评分系统恕我直言，游戏的界面看起来有点无聊。

是否有任何其他可用的评分 api 可供我使用，即使我将其提交给赞助商，这样他们在我的游戏中看到它时就不会遇到任何危机？你怎么处理这个？我希望你知道我的意思……</p>

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T10:34:26.227

首先（在回答之前）我曾在某个时间点（2006 年）以及其他几家赞助商密切隶属于 Armor Games。从那以后，我只处理过这种向朋友提供建议的问题，但没有直接参与其中。

大多数赞助商都有自己的记分牌，这是一个很容易添加的功能。

事实上，有了对 PHP 和 SQL 的基本了解，它非常容易构建，并且可以证明你的记分板作弊（谷歌充满了教程，我会把你链接到我写的一个但我不知道你使用的是哪个版本的 AS ）。

其他几个站点提供记分牌、新场地、盔甲游戏等。

但是，我会在赞助之后执行此操作，因为它是一个非常容易实现的功能。我现在只是编写模拟方法（如添加到记分牌、加载记分牌、更新记分牌）调用它们，但在您选择赞助商之前将它们留空。

一个mock方法：一个你还没有真正写过，什么也不做的方法，用来填充后面的代码。您最好的猜测是在分发包中告诉赞助商，一旦您获得赞助本身，就会集成评分系统。祝你好运。

# java - phpbb3中获取form_token和time_creation

> ID：10288946
> 
> 赞同：1
> 
> 时间：2012-04-23T22:01:34.697
> 
> 标签：java, testing, automated-tests, htmlunit, phpbb3

我正在用 htmlunit 测试论坛 phpbb3。我在论坛 phpbb 主题中自动添加消息时遇到问题。我需要发布隐藏输入：form_token 和 creation_time。我怎样才能得到它？

```
final WebClient webClient = new WebClient(BrowserVersion.INTERNET_EXPLORER_7);

HtmlPage page = webClient.getPage(URL);

// get input "username" 
final HtmlElement user_name = page.getElementsByName("username").get(0);
//enter of  value               
user_name.type(par[0]);

//get input "password"

final HtmlElement password = page.getElementsByName("password").get(0);
//enter of value                
password.type(par[1]);

// get button 'login' and click

final HtmlSubmitInput submit_button = page.getElementByName("login");
page = submit_button.click();
//Go to the page of adding message              
page=page.getAnchorByText("Your first forum").click();

page=page.getAnchorByText("Welcome to phpBB3").click();

page=page.getAnchorByHref("./posting.php?mode=reply&f=2&t=1").click();
//get textarea

final HtmlTextArea myMessage=page.getElementByName("message");

/* HtmlInput form_token=page.getElementByName("form_token");

form_token.setAttribute("value", "0");

HtmlInput creation_time=page.getElementByName("creation_time");

creation_time.setAttribute("value", "0");
*/

//enter the valye               

myMessage.type("myText");

//get the button 'Submit' and click             
final HtmlElement submit_post = page.getElementByName("post");

page=submit_post.click();
//Check that my text is on the page

if (page.asText().contains("myText") {
                    System.out.println("Yes");
                }
                else System.out.println("No"); 
```

但是在此操作之后，页面上没有新消息。据我所知，服务器检查隐藏字段 form_token 和 creation_time。如何获得正确的字段值？或者你知道解决问题的其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T04:05:56.860

安东，尝试做这样的事情：

```
HtmlForm form = page.getFormByName("a_form");

HtmlHiddenInput formToken = form.getInputByName("form_token");
formToken.setValueAttribute("form_token_value");

/* Or without the variable: */
form.getInputByName("creation_time").setValueAttribute("creation_time_value");

HtmlSubmitInput submitInput = form.getInputByName("post");
submitInput.click(); 
```

# c# - 在 C# 中使用 selenium webdriver 截屏时出现空白的白色屏幕截图

> ID：10288947
> 
> 赞同：3
> 
> 时间：2012-04-23T22:01:36.600
> 
> 标签：c#, selenium, webdriver

在这篇[SO 帖子之后](https://stackoverflow.com/questions/3346017/best-way-to-take-screenshots-of-tests-in-selenium-2)，我能够截取屏幕截图，但结果却是白色的。我尝试了几种解决方法均无济于事

1.  尝试使用一台显示器而不是通常的两台显示器
2.  使用不同的图像格式
3.  包括 System.Drawing 参考，即使我没有编译器错误。

代码

> 截图 ss=((ITakesScreenshot)driver).GetScreenshot();
> ss.SaveAsFile("test.png", System.Drawing.Imaging.ImageFormat.Png);

我的下一步应该是什么。我正在使用 C# 4.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T21:25:47.480

我的错误，我没有正确使用 selenium API。我怀疑有人会再次犯同样的错误，但这是解决方法。我打了第一个电话

> 截图 ss=((ITakesScreenshot)driver).GetScreenshot();

在我要创建屏幕截图的地方的构造函数和第二个保存文件中

> ss.SaveAsFile("test.png", System.Drawing.Imaging.ImageFormat.Png);

它们都应该结合在一个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:34:21.987

也许您正在截取 WebGL 对象的屏幕截图？在这种情况下，传统的屏幕截图可能不起作用。

# jsf-2 - Servlet 过滤不适用于 JSF 导航规则

> ID：10288951
> 
> 赞同：0
> 
> 时间：2012-04-23T22:02:34.683
> 
> 标签：jsf-2, richfaces, servlet-filters

我们有 servlet 过滤器，它在 JSF 视图显示之前验证几个会话变量。当使用 handleNavigation(...) 方法在 bean 中调用导航规则时，过滤器不会被调用。我错过了什么吗？任何帮助，将不胜感激。

这是 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>

<web-app xmlns="http://java.sun.com/xml/ns/j2ee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_5.xsd"
         version="2.5">

    <display-name>JSF</display-name>
    <description>
        JSF
    </description>
    <filter>
        <filter-name>myFilter</filter-name>
        <filter-class>myFilterClassPath</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>myFilter</filter-name>
        <servlet-name>Faces Servlet</servlet-name>
        <dispatcher>FORWARD</dispatcher>
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>INCLUDE</dispatcher>
        <dispatcher>ERROR</dispatcher>
    </filter-mapping>

    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>pathtoAppServletClass</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
            <servlet-name>Faces Servlet</servlet-name>
            <url-pattern>*.jsf</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>

    <!-- Welcome File List -->
    <welcome-file-list>
        <welcome-file>welcome.xhtml</welcome-file>
    </welcome-file-list>
</web-app> 
```

导航规则是 faces-config.xml：

```
<navigation-rule>
        <navigation-case>
            <from-outcome>nextPage</from-outcome>
            <to-view-id>/nextPage.xhtml</to-view-id>
        </navigation-case>
    </navigation-rule> 
```

这是代码bean调用：

```
FacesContext context = FacesContext.getCurrentInstance();
      context.getApplication().getNavigationHandler().handleNavigation(context, null, "nextPage"); 
```

感谢您的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:27:38.407

你的意思是你希望过滤器也被调用`nextPage.xhtml`？JSF 导航不执行请求、转发或包含。它只是在同一个请求中创建一个新视图，然后将其呈现。

如果您需要创建一个全新的请求，请致电[`ExternalContext#redirect()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#redirect%28java.lang.String%29)。

```
externalContext.redirect(externalContext.getRequestContextPath() + "/nextPage.xhtml"); 
```

或者，如果您实际上在操作方法中，请使用以下命令返回导航结果`?faces-redirect=true`：

```
public String submit() {
    // ...

    return "/nextPage.xhtml?faces-redirect=true";
} 
```

或者作为替代方案，根据具体的功能要求，使用 a[`ViewHandler`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ViewHandler.html)而不是 a`Filter`以便您可以使用[`createView()`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ViewHandler.html#createView%28javax.faces.context.FacesContext,%20java.lang.String%29).

# wcf - WCF 服务，请求或增加 Binding 上的 SendTimeout 值

> ID：10288954
> 
> 赞同：3
> 
> 时间：2012-04-23T22:02:52.800
> 
> 标签：wcf, wcf-data-services, wcf-binding, wcf-client

我随机遇到这个问题，我能够使用 WCFServiceClient 添加/删除/更新，然后我得到错误并且它随机发生......

下面是我正在使用的客户端代码...

```
using(WCFServiceClient client = new WCFServiceClient ()) 
{ 
     //More codes here 
     Employee emp = new Employee()
     emp = client.GetEmployeeDataById(123); //<<<ERROR    
} 
```

我将超时时间增加到两分钟，但仍然相同：

```
<binding name="WSHttpBinding_IEmployeeService" maxReceivedMessageSize="200000" sendTimeout="00:02:00" > 
```

//错误：

*请求通道在 00:00:59.9990000 之后等待回复时超时。增加传递给 Request 调用的超时值或增加 Binding 上的 SendTimeout 值。分配给此操作的时间可能是较长超时的一部分。*

有什么帮助吗？我看过很多帖子，但似乎没有任何修复或指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:33:26.147

阅读此链接后能够解决我的问题。

避免使用语句出现问题 [http://msdn.microsoft.com/en-us/library/aa355056.aspx](http://msdn.microsoft.com/en-us/library/aa355056.aspx)

C#“使用”语句导致调用 Dispose()。这和Close()一样，发生网络错误时可能会抛出异常。因为对 Dispose() 的调用隐式发生在“using”块的右大括号处，所以编写代码和阅读代码的人都可能不会注意到这个异常源。这代表了应用程序错误的潜在来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T23:40:19.493

您可以尝试显式绑定选择以消除您可能会选择默认（简化配置）绑定的情况

```
new WCFServiceClient ("WSHttpBinding_IEmployeeService") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T15:42:41.020

我不知道您到达那里的数据有多大，但是receiveTimeout 呢？

# javascript - CakePHP SSE 或挂起获取

> ID：10288955
> 
> 赞同：2
> 
> 时间：2012-04-23T22:03:17.410
> 
> 标签：javascript, cakephp, push-notification, long-polling

在新 Web 应用程序试运行期间，服务器请求反馈，同时它正在执行某些任务，例如文档上的新协作者和注销等。

所以我实现了 SSE（服务器发送事件），它运行良好，我们能够在应用程序消息“*咆哮式*”中获得正确的反馈和良好的反馈。

我的问题是：我真的应该使用**SSE**进行推送还是只是使用旧的**Hanging Get**。

从 IT 的角度来看，SSE 似乎很好，但在**某些任务**期间，应用程序设置了 rerty 字段`retry: 500`，因此这增加了对服务器的调用次数。

当我使用 Facebook 之类的推送通知（Hanging Get）时，我只会在不检查的情况下得到反馈。

## -

## *无关细节*

*我们目前不想使用网络套接字。我已经实现了这一点，但该应用程序不需要经常这样做。

随时使用 SSE 或 Polling 对我来说并不难，因为我有一个接口，我实现了一个名为 PushService() 的抽象类；所以我可以随时在 SSEService 和 PollService 之间交换 *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:15:58.777

好吧，事实是：

*   SSE 和长轮询（“Hanging Get”）完成同样的事情——当服务器准备好时，将数据从服务器推送到客户端。

*   长轮询[需要 hack](https://stackoverflow.com/questions/333664/simple-long-polling-example-code)来实现。上证所没有。

*   长轮询适用于所有现代网络浏览器。SSE 适用于大多数现代浏览器的较新版本，但[不适用于任何版本的 Internet Explorer](http://en.wikipedia.org/wiki/Server-sent_events#Web_browsers)（在撰写本文时最高为 IE9）。

鉴于这些事实，这两者之间的决定似乎很明确。如果您需要支持 Internet Explorer 或更早版本的其他浏览器（例如，大多数面向公众的应用程序），请使用长轮询。如果您知道您永远不需要支持这些浏览器（例如，某些内部应用程序，如公司管理界面），请使用 SSE。

由于您的案例是新 Web 应用程序的试点，您可能希望支持尽可能多的浏览器，因此请使用 Long Polling。您还在问题中提到，长轮询无论如何都会减少服务器上的负载，所以这是一个额外的好处。

# android - 在哪里获得适用于 Android/Air/iOS 应用程序的 SSL 证书并输入

> ID：10288956
> 
> 赞同：0
> 
> 时间：2012-04-23T22:03:29.960
> 
> 标签：android, ios, air, ssl-certificate

我正在发布我的第一个应用程序，并且一直在使用自签名证书。随着大规模发布，我想我应该从威瑞信等那里获得一个。我看到了网站的证书，但我不确定这是否适用于应用程序。能够使用相同的 SSL 签署我的 iOS、adobe air 和 android 应用程序会很棒。或者你只能自签名，因为你需要公钥和私钥。当谈到 SSL 证书时，我几乎是个小问题，所以如果需要，请鞭打我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T03:16:59.257

签署 Android 应用程序需要一个有效期至少为 25 (IIRC) 年或更长时间的证书。几乎没有任何 CA 会发布一个，因为它们自己的有效性通常低于此值。所以你几乎需要为 Android 使用一个自签名的。还要确保备份您的密钥库，因为如果丢失它，您将需要重新发布您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:11:55.407

iOS 应用程序使用完全独立的信任链（由 Apple 运行）下的证书进行签名。虽然您也许可以使用与您网站的 SSL 密钥相同的私钥，但这样做没有任何好处，而且这样做也存在一些重大的安全缺陷。

我不确定 Air 和 Android 的立场，但我怀疑它们通常是相似的。

# bash - 如何在 Bash 中做复杂的条件（'and' &&、'or' || ...的混合）

> ID：10288959
> 
> 赞同：21
> 
> 时间：2012-04-23T22:03:38.150
> 
> 标签：bash, syntax, conditional-statements

如何在 Bash 中完成类似以下的操作？

```
if ("$a" == "something" || ($n == 2 && "$b" == "something_else")); then
  ...
fi 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-23T22:07:28.520

你几乎明白了：

```
if [[ "$a" == "something" || ($n == 2 && "$b" == "something_else") ]]; then 
```

实际上，由于运算符优先级，括号可以省略，因此也可以写为

```
if [[ "$a" == "something" || $n == 2 && "$b" == "something_else" ]]; then 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T22:04:39.507

```
if [[ "$a" == "something" ]] || [[ $n == 2 && "$b" == "something_else" ]]; then
  ...
fi 
```

# java - 如何在 Java HttpServer 中处理失败的身份验证

> ID：10288960
> 
> 赞同：0
> 
> 时间：2012-04-23T22:03:42.033
> 
> 标签：java, http, authentication, com.sun.net.httpserver

我在基于 com.sun.net.httpserver.HttpServer 的 Java 程序中实现了一个小型 HTTP 服务器，它也使用基本身份验证。这一切都很好，但是，我想处理任何失败的身份验证请求。

默认情况下，当用户身份验证失败时（当她点击浏览器登录弹出窗口上的取消按钮时），会向客户端发送一个空白页面；未调用 HttpHandler 的 handle() 方法。

有什么想法可以在我的程序中捕获这些失败的身份验证尝试吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:37:23.493

看了一下文档...我认为您可以通过从您的身份验证器返回 Authenticator.Retry Result 并在其中指定一个新标题“位置：[http://mysite/loginpage](http://mysite/loginpage) ”或您想要的任何内容来做到这一点重定向到（请记住，您需要指定绝对 URL，以 http:// 开头，而不是相对 url /loginpage）

编辑：如果您使用的是 BasicAuthenticator 的子类，您还需要覆盖 authenticate 方法，您需要查看原始源代码（请参阅[http://xantorohara.blogspot.com/2008/07/sources-of -comsunnethttpserverhttpserve.html](http://xantorohara.blogspot.com/2008/07/sources-of-comsunnethttpserverhttpserve.html)）查看原始身份验证方法的作用...或者您可以在您的 authenticate() 方法中进行试验以查看 super.authenticate() 返回的内容，如果是失败，则改为发送带有位置的重试: 标题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T22:25:40.223

我不知道是否在 Authenticator 之前调用了过滤器（您可以通过将 som 调试信息打印到过滤器中的控制台并查看它是否在 Authenticator “踢你”之前写入控制台。如果是这样，您可能会这样做这是通过创建在身份验证之前运行的过滤器并将用户重定向到错误页面

# android - 在非地图活动上使用 Mylocation.getMyLocation() 从 gps 获取坐标

> ID：10288961
> 
> 赞同：0
> 
> 时间：2012-04-23T22:03:42.080
> 
> 标签：android, gps, mapactivity, mylocationoverlay

我变得疯狂，因为我必须从 gps 获得我的位置，通过`mMyLocationOverlay.getMyLocation()`从 a `ListActivity`AND NOT获得`MapActivity`。`GetMyLocation`想要我没有的上下文和地图视图。我试图采取 a但我在构造函数`mapActivity`上运行时出错。我发布了错误的代码：`" Caused by: java.lang.IllegalArgumentException: mapView == null "``MyLocationOverlay()`

```
public class ListDeals extends ListActivity
{   

private Events[] events;  
private MyLocationOverlay mMyLocationOverlay;//Riferimento al MyLocationOverlay
private GeoPoint myPoint = null;

@Override
public void onCreate(Bundle savedInstanceState) 
{
  super.onCreate(savedInstanceState);
  String type = this.getIntent().getStringExtra("type"); //legge cosa c'era scritto nell'intent per avere il dato necessario per fare la query al db

  setContentView(R.layout.list_view_x_deals);
  MapView mMapView = (MapView) findViewById(R.id.mapview);
  mMyLocationOverlay = new MyLocationOverlay(this, MyMapView.mapView);
  myPoint = mMyLocationOverlay.getMyLocation(); 
```

MyMapView.mapView 是在我的 MapActivity 中创建的“最终 MapView”。

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:11:25.643

如果你`MapView`没有`MapView`. 使用[常规 GPS api](http://hejp.co.uk/android/android-gps-example/)获取 a`Location`并将其转换为 a`GeoPoint`如果您希望它采用该格式。

# r - 查找匹配项并附加到 data.frame 的更快方法？

> ID：10288964
> 
> 赞同：2
> 
> 时间：2012-04-23T22:03:52.393
> 
> 标签：r

我有有效的代码。但它很慢，我希望加快速度，这样我就可以扩大到包含 00,000 个观测值的数据集。

我有两个数据框，其中一个我使用 data.table 包转换为 data.table 以进行快速查找和连接。当 3 个字段与第二个数据集中的记录匹配时，我想记录一个数据集中的记录。

Original.df (data frame) 和 LookHereForMatches.dt (data.table with key on a1, a2, a3)。Original.df 将有 100,000 到 300,000 个观测值，而 LookHereForMatches.dt 可能是 2 倍。

我遍历 Original.df 中的每个观察结果，并在 LookHereForMatches.dt 中查找符合某些标准的观察结果。我想要 LookHereForMatches.dt 中的几个字段和 Original.df 中的几个字段。我使用子集（）来获取我想要的列。

也许有人可以告诉我代码的哪一部分是最差/最慢的。我必须相信这是 rbind(cbind()) 部分。似乎这不是正确的方法。

```
matched_data.df <- data.frame()
for( i in 1:nrow(Original.df)){
  a1 <- Original.df$col1
  a2 <- Original.df$col2
  a3 <- Original.df$col3
  # Use data.table library "join" functionality to get matches (will find at least 1 and up to 4 matches, usually only 1 or 2)
  match.df <- data.frame(LookHereForMatches.dt[J(a1, a2, a3)], stringsAsFactors=FALSE)

  # combine matches with original data and add to data.frame to create big list of data with matches
  matched_data.df <- rbind(cbind(match.df, Original.df[i,], stringsAsFactors=FALSE), matched_data.df)
} 
```

更新

数据大致如下。（显然是 R 和 StackExchange 的新手。~~我会弄清楚如何使表格更漂亮并回来修复它。~~感谢@joran 修复我的表格。）这些表格是非常基本的东西。我只想从第一个表中找到每一行，并将其与第二个表中 a1、a2 和 a3 上的所有适当行匹配。在示例中，Original.df 的第一行应与 LookHereForMatches.dt 表中的第 1、2 和 3 行配对，返回 3 行。

```
Original.df <- read.table(textConnection('
a1  a2  a3  text.field  numeric.field
123 abc 2011-12-01  "some text"    1.0 
124 abc 2011-11-12  "some other text"  0.1 
125 bcd 2011-12-01  "more text"   1.2
'), header=TRUE)

LookHereForMatches.df <- read.table(textConnection('
a1  a2  a3  text.field  numeric.field   Status_Ind   
123 abc 2011-12-01  "some text"    10.5   0
123 abc 2011-12-01  "different text"   0.1    1
123 abc 2011-12-01  "more text"    0.1    1
125 bcd 2011-12-01  "other text"   4.3    0
125 bcd 2011-12-01  "text"     2.2    0
'), header=TRUE)

LookHereForMatches.dt <- data.table(LookHereForMatches.df, key=c("a1","a2","a3")) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T01:44:03.847

听起来`merge`会做你想要的；详情见`?merge`。

```
> merge(Original.df, LookHereForMatches.df, by=c("a1","a2","a3"))
   a1  a2         a3 text.field.x numeric.field.x   text.field.y
1 123 abc 2011-12-01    some text             1.0      some text
2 123 abc 2011-12-01    some text             1.0 different text
3 123 abc 2011-12-01    some text             1.0      more text
4 125 bcd 2011-12-01    more text             1.2     other text
5 125 bcd 2011-12-01    more text             1.2           text
  numeric.field.y Status_Ind
1            10.5          0
2             0.1          1
3             0.1          1
4             4.3          0
5             2.2          0 
```

如果您想要更多控制，它`match`在幕后使用，如下所示：

```
a <- with(Original.df, paste(a1, a2, a3, sep="\b"))
b <- with(LookHereForMatches.df, paste(a1, a2, a3, sep="\b"))
m <- match(b, a)
cbind(Original.df[m,], LookHereForMatches.df) 
```

还要查找`all`选项以控制当两个数据集中都没有出现事物时它会做什么。

```
merge(Original.df, LookHereForMatches.df, by=c("a1","a2","a3"), all=TRUE) 
```

至于大型数据集的速度，您可以通过使用`data.table`但每行有 1e5 和 3e5 行（如下）来获得一些加速，在我的系统上，合并只需要 2.6 秒，匹配和 cbind 只需要 1.5 秒。

```
set.seed(5)
N <- 1e5
Original.df <- data.frame(a1=1:N, a2=1, a3=1, text1=paste("hi",1:N))
LookHereForMatches.df <- data.frame(a1=sample(1:N, 3*N, replace=TRUE), 
                                    a2=1, a3=1, text2=paste("hi", 1:(3*N))) 
```

# python - 有没有办法使用 Python workerpool 模块创建一个池池？

> ID：10288966
> 
> 赞同：1
> 
> 时间：2012-04-23T22:03:54.297
> 
> 标签：python, multithreading, threadpool, pool

我正在使用 workerpool 模块创建一些线程来对服务器执行 HTTP GETS。到目前为止，我喜欢这个概念。我为 url 列表设置了一个下载作业，然后将工作分配给一个线程池。到目前为止，一切都很好...

```
import urllib3
import workerpool
from urllib3 import HTTPConnectionPool

headers = { }
headers['user-agent'] = 'Python-httplib2/0.7.4 (gzip)'
headers['accept-encoding'] = 'gzip, deflate'

class Download_Dashlet_Job(workerpool.Job):
  "This is a download dashlet Job object for downloading a given URL."
  def __init__(self, url):
    self.url = url
  def run(self):
    request = tcp_pool.request('GET', self.url, headers=headers)

#Create a pool of TCP connections for communication to the server (this is using urllib3)
tcp_pool = HTTPConnectionPool('M_Server3', port=8080, timeout=None, maxsize=3, block=True)

# Initialize a pool of three dashlet worker threads to be used for downloading from a page
dashlet_thread_worker_pool = workerpool.WorkerPool(size=3)

# urls.txt is just a text file with 5 urls in it
for url in open("urls.txt"):
  job = Download_Dashlet_Job(url.strip())
  dashlet_thread_worker_pool.put(job)

# Send shutdown jobs to all dashlet worker threads
dashlet_thread_worker_pool.shutdown()
dashlet_thread_worker_pool.wait() 
```

上面的代码运行良好，但它只有一个线程池。所以，案件是......

单用户打开 Firefox 到 yahoo，浏览器启动多个线程从 yahoo 页面下载组件。

我现在想做的是这个……

十个用户向雅虎打开他们的浏览器，每个用户都有自己的一组（即池）要从雅虎页面下载。

我被困在这一点上。我是否需要为用户创建一个类对象，然后该对象调用对象 Download_Dashlet_Job ？

我试图这样做，但我完全搞砸了。使用 workerpool 应该不会很难，对吗？

# text - asp net imagebutton 替代文本多行

> ID：10288969
> 
> 赞同：0
> 
> 时间：2012-04-23T22:04:08.137
> 
> 标签：text, asp-classic, imagebutton, .net, alternate

我想知道是否可以制作多行而不是单行的交替文本？谢谢，橡树。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:26:56.087

另一种可能

```
<img id="img1" width=50 src="foo.jpg" alt="come here" 
  onmouseover="this.style.display='block';this.alt='looo oooooooo oooooooooo oooooooooo oooooong'"
  onmouseout="this.style.display='inline';this.alt='come here'"
/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:06:40.697

好吧，在某些浏览器上，您可以像这样控制属性，但它也会影响图像本身的样式。

```
<style>
img[alt] { border: 1px solid #000;display: block;  }
</style> 
```

在我的 FF 上，这显示了所有包装的文本

# c# - 我应该将所有 WCF 服务代码包装在 try catch 块中吗？

> ID：10288976
> 
> 赞同：6
> 
> 时间：2012-04-23T22:04:43.997
> 
> 标签：c#, .net, wcf, try-catch

```
try
{
    ///// here is the code that might throw erros. If I discover the user is unauthorized I throw a WebFaultException myself to alert the client
}      
catch (WebFaultException ex)
{
    throw ex; //but if I wrap all code in try-catch, I have to rethrow the exception o the status code reaches the client
}
catch (Exception ex)
{
    throw new WebFaultException(ex.Message, HttpStatusCode.InternalServerError);
} 
```

我应该把所有东西都包装在一个 try-catch 中，还是你有什么建议？我将 WCF 与完整的 JSON 服务一起使用

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-23T22:08:19.547

您可以这样做，但最好实现 [IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)并将[其作为行为添加](http://steverb.com/post/2008/11/24/Useful-WCF-Behaviors-IErrorHandler.aspx)到您的服务中，这将允许您在一个地方处理未处理的异常，因此您将能够在那里创建一个错误异常将详细信息返回给用户。

```
ErrorHandler : IErrorHandler
{
... just implement the handling of errors here, however you want to handle them
} 
```

然后创建一个使用它的行为：

```
/// <summary>
///   Custom WCF Behaviour for Service Level Exception handling.
/// </summary>
public class ErrorHandlerBehavior : IServiceBehavior
    {
    #region Implementation of IServiceBehavior

    public void Validate (ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
        {
        }

    public void AddBindingParameters (ServiceDescription serviceDescription, ServiceHostBase serviceHostBase,
                                      Collection<ServiceEndpoint> endpoints, BindingParameterCollection bindingParameters)
        {
        }

    public void ApplyDispatchBehavior (ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
        {
        IErrorHandler errorHandler = new ErrorHandler ();

        foreach (ChannelDispatcherBase channelDispatcherBase in serviceHostBase.ChannelDispatchers)
            {
            var channelDispatcher = channelDispatcherBase as ChannelDispatcher;

            if (channelDispatcher != null)
                {
                channelDispatcher.ErrorHandlers.Add (errorHandler);
                }
            }
        }

    #endregion
    } 
```

然后，如果您是自托管，您可以通过编程方式添加行为：

```
 myServiceHost.Description.Behaviors.Add (new ErrorHandlerBehavior ()); 
```

如果您想通过配置添加它，那么您需要以下之一：

```
public class ErrorHandlerElement : BehaviorExtensionElement
    {
    public override Type BehaviorType
        {
        get { return typeof (ErrorHandlerBehavior); }
        }

    protected override object CreateBehavior ()
        {
        return new ErrorHandlerBehavior ();
        }
    }
} 
```

然后是配置：

```
<system.serviceModel>
<extensions>
  <behaviorExtensions>
    <add name="ErrorLogging" type="ErrorHandlerBehavior, ErrorHandling, Version=1.0.0.0, Culture=neutral, PublicKeyToken=<whatever>" />
  </behaviorExtensions>
</extensions>
<bindings>
  <basicHttpBinding>
    <binding name="basicBinding">
    </binding>
  </basicHttpBinding>
</bindings>
<services>
  <service behaviorConfiguration="Service1Behavior" name="Service">
    <endpoint address="" binding="basicHttpBinding"  bindingConfiguration="basicBinding" contract="Service" />
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior name="Service1Behavior">
      <serviceMetadata httpGetUrl="" httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
      <ErrorLogging />  <--this adds the behaviour to the service behaviours -->
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

# ios - NSUserDefaults 保存基本的玩家统计数据

> ID：10288985
> 
> 赞同：0
> 
> 时间：2012-04-23T22:05:26.747
> 
> 标签：ios, xcode, nsuserdefaults

我打算用

```
 NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
 // to store
 [defaults setObject:[NSNumber numberWithInt:level] forKey:@"level"];
 [defaults setObject:[NSNumber numberWithInt:gamesplayed] forKey:@"games"];
 [defaults synchronize]; 
```

存储游戏的游戏数/关卡数。我想知道如果我最终在某个时候对应用程序进行更新，这些是否会丢失？哪里会被迫重新开始使用？

基本上这是我应该如何存储这些数据？还是有其他方法？我希望能够调用本地存储的有关用户的数据。我知道我可以通过 mysql/webservices 等，但我认为我不需要为此经历所有这些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:15:52.337

> 我想知道如果我最终在某个时候对应用程序进行更新，这些是否会丢失？

不可以，但是如果用户删除应用程序然后重新安装它，它们将会丢失，并且它们的进度将不会在他们的任何其他设备上可用。

> 基本上这是我应该如何存储这些数据？

对于游戏，我建议使用 Game Center。对于其他类型的应用程序，我建议使用 iCloud。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:13:25.323

升级应用程序不会删除`NSUserDefaults`以前版本中的集合。它们保存在应用程序的**Library/Preferences**文件夹下，升级期间不会删除。

# cakephp - 何时在 CakePhp 中使用组件或模型

> ID：10288988
> 
> 赞同：0
> 
> 时间：2012-04-23T22:06:10.580
> 
> 标签：cakephp, cakephp-2.0

有时我很难在组件控制器中添加一段代码还是在 CakePhp 框架中添加模型之间做出选择。该代码块不处理数据库中的条目，但它仍然与某个模型相关。这里的最佳做法是什么？

## 谢谢

叶希亚·萨拉姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T23:22:54.973

好吧，我给你举几个例子

*   任何数据处理都应该在模型中进行。（获取数据、计算、转换、保存……）
*   处理请求和响应的东西通常进入一个组件（如 auth）
*   与数据一起使用的可重用代码应该成为一种行为（如 slug 或标签，请参阅 cakedc 插件）
*   在输出上执行重复任务的代码将进入帮助程序（recaptcha 帮助程序）

如果你开始阅读[这本书](https://book.cakephp.org/2/en/index.html)，第一页已经开始描述控制器、模型和视图之间的基本区别：

*   控制器处理请求，并帮助协调和准备客户端的响应。阅读有关控制器的更多信息

*   视图是 CakePHP 中的表示层。他们将从模型中获取的数据转换为客户端请求的输出格式。阅读更多关于视图

*   模型是应用程序的核心，它们处理数据的验证、存储和检索。阅读更多关于模型

理解[MVC 模式](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)也有帮助。

有关涉及组件、行为和帮助程序的示例，请查看 CakeDC [recaptcha 插件](https://github.com/CakeDC/recaptcha/tree/2.0)。

# python - 如何使用 pika 发送 utf-8 数据？

> ID：10288994
> 
> 赞同：1
> 
> 时间：2012-04-23T22:06:41.177
> 
> 标签：python, unicode, amqp, pika

我正在尝试在 pika 上发布一个 unicode 字符串。当我发送它时，我收到以下消息：

```
UnicodeEncodeError: 'ascii' codec can't encode characters in position 6-20: ordinal not in range(128)
    self.write(data)
  File "/usr/lib/python2.7/site-packages/pika/simplebuffer.py", line 62, in write
    self.buf.write(data) 
```

环顾四周，似乎我必须使用 pika.BasicProperties 将字符集或内容类型设置为 UTF-8，但我找不到该类的文档。

我应该设置什么来发布 unicode 数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-06-14T11:32:37.573

```
 properties = BasicProperties(
        app_id=self.app_id,
        content_type='application/json',
        content_encoding='utf-8',
        delivery_mode=2,
    )
channel.basic_publish(exchange=exchange,
                          routing_key=routing_key,
                          body=message_body,
                          properties=properties) 
```

# python - 根据最接近数字 python 的实例对对象列表进行排序

> ID：10288998
> 
> 赞同：0
> 
> 时间：2012-04-23T22:07:12.397
> 
> 标签：python

我有一个对象列表，我想对其进行排序，但有一个警告。

所以让我们说列表有一个对象，它有一个名为 norm 的实例

```
and norms are like [0.1,0.2,0.3.....0.9] 
```

所以如果我做类似的事情：

```
 potential_list.sort(key = lambda x:x._norm, reverse = True) 
```

然后它会以类似的方式对其进行排序

```
 [0.9, 0.8... 0.1] 
```

但我想把它排序成一个数字，这样

```
 number = 0.3

  then sorted list is [0.4,0.6,0.3,0.7 and so on] because

       0.4-0.3 = 0.1
       abs|0.4-0.5| = 0.1
       0.4 - 0.2 = 0.2
        abs|0.4 - 0.6| = 0.2

  So the sort is because of that difference. 
```

我该怎么做呢。并不是说这些 [0.4,0.6....] 是任何对象的实例

因此，它混合了[根据列表 python 中最接近的数字对列表](https://stackoverflow.com/questions/10286638/sorting-a-list-with-respect-to-the-closest-number-in-the-list-python)进行排序 以及[如何根据对象的属性对对象列表进行排序？](https://stackoverflow.com/questions/403421/how-to-sort-a-list-of-objects-in-python-based-on-an-attribute-of-the-objects)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T22:13:39.620

和你描述的一样。

```
key=lambda x: abs(x._norm - number) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T22:13:49.853

好吧，只需将它们组合起来：

```
>>> class X(object):
...     def __init__(self, n): self._norm = n
...     def __repr__(self): return str(self._norm)
... 
>>> lst = [X(0.1),X(0.2), X(0.3), X(0.4), X(0.5), X(0.6), X(0.7), X(0.8), X(0.9)]
>>> lst.sort(key=lambda x: abs(x._norm - 0.5))
>>> lst
[0.5, 0.4, 0.6, 0.7, 0.3, 0.2, 0.8, 0.1, 0.9] 
```